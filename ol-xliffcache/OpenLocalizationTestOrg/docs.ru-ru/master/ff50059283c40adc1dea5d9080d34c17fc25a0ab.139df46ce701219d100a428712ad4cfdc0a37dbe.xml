{"content":"---\ntitle: \"LoadTypeLibWithResolver Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"LoadTypeLibWithResolver\"\napi_location: \n  - \"TlbRef.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"LoadTypeLibWithResolver\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"LoadTypeLibWithResolver function [.NET Framework]\"\nms.assetid: 7123a89b-eb9b-463a-a552-a081e33b0a3a\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 14\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# LoadTypeLibWithResolver Function\nLoads a type library and uses the supplied [ITypeLibResolver interface](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md) to resolve any internally referenced type libraries.  \n  \n## Syntax  \n  \n```  \nHRESULT LoadTypeLibWithResolver(  \n    [in]  LPCOLESTR           szFile,  \n    [in]  REGKIND             regkind,  \n    [in]  ITypeLibResolver   *pTlbResolver,  \n    [out] ITypeLib          **pptlib);  \n```  \n  \n#### Parameters  \n `szFile`  \n [in] The file path of the type library.  \n  \n `regkind`  \n [in] A [REGKIND enumeration](https://msdn.microsoft.com/library/windows/desktop/ms221159.aspx) flag that controls how the type library is registered. Its possible values are:  \n  \n-   `REGKIND_DEFAULT`: Use default registration behavior.  \n  \n-   `REGKIND_REGISTER`: Register this type library.  \n  \n-   `REGKIND_NONE`: Do not register this type library.  \n  \n `pTlbResolver`  \n [in] A pointer to the implementation of the [ITypeLibResolver interface](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md).  \n  \n `pptlib`  \n [out] A reference to the type library that is being loaded.  \n  \n## Return Value  \n One of the HRESULT values listed in the following table.  \n  \n|Return value|Meaning|  \n|------------------|-------------|  \n|`S_OK`|Success.|  \n|`E_OUTOFMEMORY`|Out of memory.|  \n|`E_POINTER`|One or more of the pointers are invalid.|  \n|`E_INVALIDARG`|One or more of the arguments are invalid.|  \n|`TYPE_E_IOERROR`|The function could not write to the file.|  \n|`TYPE_E_REGISTRYACCESS`|The system registration database could not be opened.|  \n|`TYPE_E_INVALIDSTATE`|The type library could not be opened.|  \n|`TYPE_E_CANTLOADLIBRARY`|The type library or DLL could not be loaded.|  \n  \n## Remarks  \n The [Tlbexp.exe (Type Library Exporter)](../../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md) calls the `LoadTypeLibWithResolver` function during the assembly-to-type-library conversion process.  \n  \n This function loads the specified type library with minimal access to the registry. The function then examines the type library for internally referenced type libraries, each of which must be loaded and added to the parent type library.  \n  \n Before a referenced type library can be loaded, its reference file path must be resolved to a full file path. This is accomplished through the [ResolveTypeLib method](../../../../docs/framework/unmanaged-api/tlbexp/resolvetypelib-method.md) that is provided by the [ITypeLibResolver interface](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md), which is passed in the `pTlbResolver` parameter.  \n  \n When the full file path of the referenced type library is known, the `LoadTypeLibWithResolver` function loads and adds the referenced type library to the parent type library, creating a combined master type library.  \n  \n After the function resolves and loads all internally referenced type libraries, it returns a reference to the master resolved type library in the `pptlib` parameter.  \n  \n The `LoadTypeLibWithResolver` function is generally called by the [Tlbexp.exe (Type Library Exporter)](../../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md), which supplies its own internal [ITypeLibResolver interface](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md) implementation in the `pTlbResolver` parameter.  \n  \n If you call `LoadTypeLibWithResolver` directly, you must supply your own [ITypeLibResolver interface](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md) implementation.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** TlbRef.h  \n  \n **Library:** TlbRef.lib  \n  \n **.NET Framework Version:** 3.5, 3.0, 2.0  \n  \n## See Also  \n [Tlbexp Helper Functions](../../../../docs/framework/unmanaged-api/tlbexp/index.md)   \n [LoadTypeLibEx Function](https://msdn.microsoft.com/library/windows/desktop/ms221249\\(v=vs.85\\).aspx)","nodes":[{"pos":[4,630],"nodes":[{"content":"LoadTypeLibWithResolver Function | Microsoft Docs","nodes":[{"pos":[0,49],"content":"LoadTypeLibWithResolver Function | Microsoft Docs","nodes":[{"content":"LoadTypeLibWithResolver Function | Microsoft Docs","pos":[0,49]}]}],"pos":[6,58],"yaml":true}],"content":"title: \"LoadTypeLibWithResolver Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"LoadTypeLibWithResolver\"\napi_location: \n  - \"TlbRef.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"LoadTypeLibWithResolver\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"LoadTypeLibWithResolver function [.NET Framework]\"\nms.assetid: 7123a89b-eb9b-463a-a552-a081e33b0a3a\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 14\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[637,669],"content":"LoadTypeLibWithResolver Function","linkify":"LoadTypeLibWithResolver Function","nodes":[{"content":"LoadTypeLibWithResolver Function","pos":[0,32]}]},{"pos":[670,873],"content":"Loads a type library and uses the supplied <bpt id=\"p1\">[</bpt>ITypeLibResolver interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md)</ept> to resolve any internally referenced type libraries.","source":"Loads a type library and uses the supplied [ITypeLibResolver interface](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md) to resolve any internally referenced type libraries."},{"pos":[882,888],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1117,1127],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The file path of the type library.","pos":[1143,1182]},{"content":"[in] A <bpt id=\"p1\">[</bpt>REGKIND enumeration<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/ms221159.aspx)</ept> flag that controls how the type library is registered.","pos":[1202,1351],"source":"[in] A [REGKIND enumeration](https://msdn.microsoft.com/library/windows/desktop/ms221159.aspx) flag that controls how the type library is registered."},{"content":"Its possible values are:","pos":[1352,1376]},{"pos":[1386,1439],"content":"<ph id=\"ph1\">`REGKIND_DEFAULT`</ph>: Use default registration behavior.","source":"`REGKIND_DEFAULT`: Use default registration behavior."},{"pos":[1449,1496],"content":"<ph id=\"ph1\">`REGKIND_REGISTER`</ph>: Register this type library.","source":"`REGKIND_REGISTER`: Register this type library."},{"pos":[1506,1556],"content":"<ph id=\"ph1\">`REGKIND_NONE`</ph>: Do not register this type library.","source":"`REGKIND_NONE`: Do not register this type library."},{"pos":[1563,1733],"content":"`pTlbResolver`  \n[in] A pointer to the implementation of the [ITypeLibResolver interface](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md).","leadings":[""," "],"nodes":[{"content":"[in] A pointer to the implementation of the <bpt id=\"p1\">[</bpt>ITypeLibResolver interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md)</ept>.","pos":[17,169],"source":"[in] A pointer to the implementation of the [ITypeLibResolver interface](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md)."}]},{"pos":[1740,1811],"content":"`pptlib`  \n[out] A reference to the type library that is being loaded.","leadings":[""," "],"nodes":[{"content":"[out] A reference to the type library that is being loaded.","pos":[11,70]}]},{"pos":[1820,1832],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"One of the HRESULT values listed in the following table.","pos":[1836,1892]},{"content":"Return value","pos":[1899,1911]},{"content":"Meaning","pos":[1912,1919]},{"content":"Success.","pos":[1968,1976]},{"content":"Out of memory.","pos":[1997,2011]},{"content":"One or more of the pointers are invalid.","pos":[2028,2068]},{"content":"One or more of the arguments are invalid.","pos":[2088,2129]},{"content":"The function could not write to the file.","pos":[2151,2192]},{"content":"The system registration database could not be opened.","pos":[2221,2274]},{"content":"The type library could not be opened.","pos":[2301,2338]},{"content":"The type library or DLL could not be loaded.","pos":[2368,2412]},{"pos":[2422,2429],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2433,2644],"content":"The <bpt id=\"p1\">[</bpt>Tlbexp.exe (Type Library Exporter)<ept id=\"p1\">](../../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md)</ept> calls the <ph id=\"ph1\">`LoadTypeLibWithResolver`</ph> function during the assembly-to-type-library conversion process.","source":"The [Tlbexp.exe (Type Library Exporter)](../../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md) calls the `LoadTypeLibWithResolver` function during the assembly-to-type-library conversion process."},{"content":"This function loads the specified type library with minimal access to the registry.","pos":[2651,2734]},{"content":"The function then examines the type library for internally referenced type libraries, each of which must be loaded and added to the parent type library.","pos":[2735,2887]},{"content":"Before a referenced type library can be loaded, its reference file path must be resolved to a full file path.","pos":[2894,3003]},{"content":"This is accomplished through the <bpt id=\"p1\">[</bpt>ResolveTypeLib method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/tlbexp/resolvetypelib-method.md)</ept> that is provided by the <bpt id=\"p2\">[</bpt>ITypeLibResolver interface<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md)</ept>, which is passed in the <ph id=\"ph1\">`pTlbResolver`</ph> parameter.","pos":[3004,3316],"source":" This is accomplished through the [ResolveTypeLib method](../../../../docs/framework/unmanaged-api/tlbexp/resolvetypelib-method.md) that is provided by the [ITypeLibResolver interface](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md), which is passed in the `pTlbResolver` parameter."},{"pos":[3323,3538],"content":"When the full file path of the referenced type library is known, the <ph id=\"ph1\">`LoadTypeLibWithResolver`</ph> function loads and adds the referenced type library to the parent type library, creating a combined master type library.","source":"When the full file path of the referenced type library is known, the `LoadTypeLibWithResolver` function loads and adds the referenced type library to the parent type library, creating a combined master type library."},{"pos":[3545,3710],"content":"After the function resolves and loads all internally referenced type libraries, it returns a reference to the master resolved type library in the <ph id=\"ph1\">`pptlib`</ph> parameter.","source":"After the function resolves and loads all internally referenced type libraries, it returns a reference to the master resolved type library in the `pptlib` parameter."},{"pos":[3717,4078],"content":"The <ph id=\"ph1\">`LoadTypeLibWithResolver`</ph> function is generally called by the <bpt id=\"p1\">[</bpt>Tlbexp.exe (Type Library Exporter)<ept id=\"p1\">](../../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md)</ept>, which supplies its own internal <bpt id=\"p2\">[</bpt>ITypeLibResolver interface<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md)</ept> implementation in the <ph id=\"ph2\">`pTlbResolver`</ph> parameter.","source":"The `LoadTypeLibWithResolver` function is generally called by the [Tlbexp.exe (Type Library Exporter)](../../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md), which supplies its own internal [ITypeLibResolver interface](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md) implementation in the `pTlbResolver` parameter."},{"pos":[4085,4281],"content":"If you call <ph id=\"ph1\">`LoadTypeLibWithResolver`</ph> directly, you must supply your own <bpt id=\"p1\">[</bpt>ITypeLibResolver interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md)</ept> implementation.","source":"If you call `LoadTypeLibWithResolver` directly, you must supply your own [ITypeLibResolver interface](../../../../docs/framework/unmanaged-api/tlbexp/itypelibresolver-interface.md) implementation."},{"pos":[4290,4302],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4306,4410],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[4417,4437],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> TlbRef.h","source":"**Header:** TlbRef.h"},{"pos":[4444,4467],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> TlbRef.lib","source":"**Library:** TlbRef.lib"},{"pos":[4474,4515],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Version:<ept id=\"p1\">**</ept> 3.5, 3.0, 2.0","source":"**.NET Framework Version:** 3.5, 3.0, 2.0"},{"pos":[4524,4532],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Tlbexp Helper Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/tlbexp/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[4536,4620],"source":"[Tlbexp Helper Functions](../../../../docs/framework/unmanaged-api/tlbexp/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>LoadTypeLibEx Function<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/ms221249\\(v=vs.85\\).aspx)</ept>","pos":[4624,4725],"source":"[LoadTypeLibEx Function](https://msdn.microsoft.com/library/windows/desktop/ms221249\\(v=vs.85\\).aspx)"}]}