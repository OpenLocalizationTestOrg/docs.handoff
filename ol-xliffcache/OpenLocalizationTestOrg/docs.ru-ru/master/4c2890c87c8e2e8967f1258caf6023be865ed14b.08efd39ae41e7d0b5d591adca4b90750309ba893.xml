{"content":"---\ntitle: \"Service Application Programming Architecture | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"ServiceController components, programming architecture\"\n  - \"ServiceBase class, service states\"\n  - \"Windows Service applications, code model\"\n  - \"services, programming architecture\"\n  - \"ServiceController class\"\n  - \"services, states\"\n  - \"ServiceProcessInstaller class, service application code model\"\n  - \"Windows Service applications, states\"\nms.assetid: 83230026-d068-4174-97ff-e264c896eb2f\ncaps.latest.revision: 15\nauthor: \"ghogen\"\nms.author: \"ghogen\"\nmanager: \"douge\"\n---\n# Service Application Programming Architecture\nWindows Service applications are based on a class that inherits from the <xref:System.ServiceProcess.ServiceBase?displayProperty=fullName> class. You override methods from this class and define functionality for them to determine how your service behaves.  \n  \n The main classes involved in service creation are:  \n  \n-   <xref:System.ServiceProcess.ServiceBase?displayProperty=fullName> — You override methods from the <xref:System.ServiceProcess.ServiceBase> class when creating a service and define the code to determine how your service functions in this inherited class.  \n  \n-   <xref:System.ServiceProcess.ServiceProcessInstaller?displayProperty=fullName> and <xref:System.ServiceProcess.ServiceInstaller?displayProperty=fullName> —You use these classes to install and uninstall your service.  \n  \n In addition, a class named <xref:System.ServiceProcess.ServiceController> can be used to manipulate the service itself. This class is not involved in the creation of a service, but can be used to start and stop the service, pass commands to it, and return a series of enumerations.  \n  \n## Defining Your Service's Behavior  \n In your service class, you override base class functions that determine what happens when the state of your service is changed in the Services Control Manager. The <xref:System.ServiceProcess.ServiceBase> class exposes the following methods, which you can override to add custom behavior.  \n  \n|Method|Override to|  \n|------------|-----------------|  \n|<xref:System.ServiceProcess.ServiceBase.OnStart%2A>|Indicate what actions should be taken when your service starts running. You must write code in this procedure for your service to perform useful work.|  \n|<xref:System.ServiceProcess.ServiceBase.OnPause%2A>|Indicate what should happen when your service is paused.|  \n|<xref:System.ServiceProcess.ServiceBase.OnStop%2A>|Indicate what should happen when your service stops running.|  \n|<xref:System.ServiceProcess.ServiceBase.OnContinue%2A>|Indicate what should happen when your service resumes normal functioning after being paused.|  \n|<xref:System.ServiceProcess.ServiceBase.OnShutdown%2A>|Indicate what should happen just prior to your system shutting down, if your service is running at that time.|  \n|<xref:System.ServiceProcess.ServiceBase.OnCustomCommand%2A>|Indicate what should happen when your service receives a custom command. For more information on custom commands, see MSDN online.|  \n|<xref:System.ServiceProcess.ServiceBase.OnPowerEvent%2A>|Indicate how the service should respond when a power management event is received, such as a low battery or suspended operation.|  \n  \n> [!NOTE]\n>  These methods represent states that the service moves through in its lifetime; the service transitions from one state to the next. For example, you will never get the service to respond to an <xref:System.ServiceProcess.ServiceBase.OnContinue%2A> command before <xref:System.ServiceProcess.ServiceBase.OnStart%2A> has been called.  \n  \n There are several other properties and methods that are of interest. These include:  \n  \n-   The <xref:System.ServiceProcess.ServiceBase.Run%2A> method on the <xref:System.ServiceProcess.ServiceBase> class. This is the main entry point for the service. When you create a service using the Windows Service template, code is inserted in your application's `Main` method to run the service. This code looks like this:  \n  \n     [!code-csharp[VbRadconService#6](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#6)]\n     [!code-vb[VbRadconService#6](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#6)]  \n  \n    > [!NOTE]\n    >  These examples use an array of type <xref:System.ServiceProcess.ServiceBase>, into which each service your application contains can be added, and then all of the services can be run together. If you are only creating a single service, however, you might choose not to use the array and simply declare a new object inheriting from <xref:System.ServiceProcess.ServiceBase> and then run it. For an example, see [How to: Write Services Programmatically](../../../docs/framework/windows-services/how-to-write-services-programmatically.md).  \n  \n-   A series of properties on the <xref:System.ServiceProcess.ServiceBase> class. These determine what methods can be called on your service. For example, when the <xref:System.ServiceProcess.ServiceBase.CanStop%2A> property is set to `true`, the <xref:System.ServiceProcess.ServiceBase.OnStop%2A> method on your service can be called. When the <xref:System.ServiceProcess.ServiceBase.CanPauseAndContinue%2A> property is set to `true`, the <xref:System.ServiceProcess.ServiceBase.OnPause%2A> and <xref:System.ServiceProcess.ServiceBase.OnContinue%2A> methods can be called. When you set one of these properties to `true`, you should then override and define processing for the associated methods.  \n  \n    > [!NOTE]\n    >  Your service must override at least <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> to be useful.  \n  \n You can also use a component called the <xref:System.ServiceProcess.ServiceController> to communicate with and control the behavior of an existing service.  \n  \n## See Also  \n [Introduction to Windows Service Applications](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)   \n [How to: Create Windows Services](../../../docs/framework/windows-services/how-to-create-windows-services.md)","nodes":[{"pos":[4,739],"embed":true,"restype":"x-metadata","content":"title: \"Service Application Programming Architecture | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"ServiceController components, programming architecture\"\n  - \"ServiceBase class, service states\"\n  - \"Windows Service applications, code model\"\n  - \"services, programming architecture\"\n  - \"ServiceController class\"\n  - \"services, states\"\n  - \"ServiceProcessInstaller class, service application code model\"\n  - \"Windows Service applications, states\"\nms.assetid: 83230026-d068-4174-97ff-e264c896eb2f\ncaps.latest.revision: 15\nauthor: \"ghogen\"\nms.author: \"ghogen\"\nmanager: \"douge\"","nodes":[{"content":"Service Application Programming Architecture | Microsoft Docs","nodes":[{"pos":[0,61],"content":"Service Application Programming Architecture | Microsoft Docs","nodes":[{"content":"Service Application Programming Architecture | Microsoft Docs","pos":[0,61]}]}],"path":["title"]}],"yml":true},{"pos":[746,790],"content":"Service Application Programming Architecture","linkify":"Service Application Programming Architecture","nodes":[{"content":"Service Application Programming Architecture","pos":[0,44]}]},{"content":"Windows Service applications are based on a class that inherits from the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase?displayProperty=fullName&gt;</ph> class.","pos":[791,936],"source":"Windows Service applications are based on a class that inherits from the <xref:System.ServiceProcess.ServiceBase?displayProperty=fullName> class."},{"content":"You override methods from this class and define functionality for them to determine how your service behaves.","pos":[937,1046]},{"content":"The main classes involved in service creation are:","pos":[1053,1103]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase?displayProperty=fullName&gt;</ph> — You override methods from the <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase&gt;</ph> class when creating a service and define the code to determine how your service functions in this inherited class.","pos":[1113,1366],"source":"<xref:System.ServiceProcess.ServiceBase?displayProperty=fullName> — You override methods from the <xref:System.ServiceProcess.ServiceBase> class when creating a service and define the code to determine how your service functions in this inherited class."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceProcessInstaller?displayProperty=fullName&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceInstaller?displayProperty=fullName&gt;</ph> —You use these classes to install and uninstall your service.","pos":[1376,1590],"source":"<xref:System.ServiceProcess.ServiceProcessInstaller?displayProperty=fullName> and <xref:System.ServiceProcess.ServiceInstaller?displayProperty=fullName> —You use these classes to install and uninstall your service."},{"content":"In addition, a class named <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceController&gt;</ph> can be used to manipulate the service itself.","pos":[1597,1716],"source":"In addition, a class named <xref:System.ServiceProcess.ServiceController> can be used to manipulate the service itself."},{"content":"This class is not involved in the creation of a service, but can be used to start and stop the service, pass commands to it, and return a series of enumerations.","pos":[1717,1878]},{"pos":[1887,1919],"content":"Defining Your Service's Behavior","linkify":"Defining Your Service's Behavior","nodes":[{"content":"Defining Your Service's Behavior","pos":[0,32]}]},{"content":"In your service class, you override base class functions that determine what happens when the state of your service is changed in the Services Control Manager.","pos":[1923,2082]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase&gt;</ph> class exposes the following methods, which you can override to add custom behavior.","pos":[2083,2211],"source":" The <xref:System.ServiceProcess.ServiceBase> class exposes the following methods, which you can override to add custom behavior."},{"content":"Method","pos":[2218,2224]},{"content":"Override to","pos":[2225,2236]},{"content":"Indicate what actions should be taken when your service starts running.","pos":[2328,2399]},{"content":"You must write code in this procedure for your service to perform useful work.","pos":[2400,2478]},{"content":"Indicate what should happen when your service is paused.","pos":[2535,2591]},{"content":"Indicate what should happen when your service stops running.","pos":[2647,2707]},{"content":"Indicate what should happen when your service resumes normal functioning after being paused.","pos":[2767,2859]},{"content":"Indicate what should happen just prior to your system shutting down, if your service is running at that time.","pos":[2919,3028]},{"content":"Indicate what should happen when your service receives a custom command.","pos":[3093,3165]},{"content":"For more information on custom commands, see MSDN online.","pos":[3166,3223]},{"content":"Indicate how the service should respond when a power management event is received, such as a low battery or suspended operation.","pos":[3285,3413]},{"pos":[3422,3763],"content":"[!NOTE]\n These methods represent states that the service moves through in its lifetime; the service transitions from one state to the next. For example, you will never get the service to respond to an <xref:System.ServiceProcess.ServiceBase.OnContinue%2A> command before <xref:System.ServiceProcess.ServiceBase.OnStart%2A> has been called.","leadings":["","> "],"nodes":[{"content":"These methods represent states that the service moves through in its lifetime; the service transitions from one state to the next. For example, you will never get the service to respond to an <xref:System.ServiceProcess.ServiceBase.OnContinue%2A> command before <xref:System.ServiceProcess.ServiceBase.OnStart%2A> has been called.","pos":[9,339],"nodes":[{"content":"These methods represent states that the service moves through in its lifetime; the service transitions from one state to the next.","pos":[0,130]},{"content":"For example, you will never get the service to respond to an <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnContinue%2A&gt;</ph> command before <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> has been called.","pos":[131,330],"source":" For example, you will never get the service to respond to an <xref:System.ServiceProcess.ServiceBase.OnContinue%2A> command before <xref:System.ServiceProcess.ServiceBase.OnStart%2A> has been called."}]}]},{"content":"There are several other properties and methods that are of interest.","pos":[3770,3838]},{"content":"These include:","pos":[3839,3853]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.Run%2A&gt;</ph> method on the <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase&gt;</ph> class.","pos":[3863,3976],"source":"The <xref:System.ServiceProcess.ServiceBase.Run%2A> method on the <xref:System.ServiceProcess.ServiceBase> class."},{"content":"This is the main entry point for the service.","pos":[3977,4022]},{"content":"When you create a service using the Windows Service template, code is inserted in your application's <ph id=\"ph1\">`Main`</ph> method to run the service.","pos":[4023,4157],"source":" When you create a service using the Windows Service template, code is inserted in your application's `Main` method to run the service."},{"content":"This code looks like this:","pos":[4158,4184]},{"pos":[4195,4452],"content":"[!code-csharp[VbRadconService#6](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#6)]\n [!code-vb[VbRadconService#6](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#6)]","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>VbRadconService#6<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#6)</ept><ept id=\"p1\">]</ept>","pos":[0,125],"source":"[!code-csharp[VbRadconService#6](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#6)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbRadconService#6<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#6)</ept><ept id=\"p1\">]</ept>","pos":[127,253],"source":"[!code-vb[VbRadconService#6](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#6)]"}]},{"pos":[4464,5013],"content":"[!NOTE]\nThese examples use an array of type <xref:System.ServiceProcess.ServiceBase>, into which each service your application contains can be added, and then all of the services can be run together. If you are only creating a single service, however, you might choose not to use the array and simply declare a new object inheriting from <xref:System.ServiceProcess.ServiceBase> and then run it. For an example, see [How to: Write Services Programmatically](../../../docs/framework/windows-services/how-to-write-services-programmatically.md).","leadings":["","    >  "],"nodes":[{"content":"These examples use an array of type <xref:System.ServiceProcess.ServiceBase>, into which each service your application contains can be added, and then all of the services can be run together. If you are only creating a single service, however, you might choose not to use the array and simply declare a new object inheriting from <xref:System.ServiceProcess.ServiceBase> and then run it. For an example, see [How to: Write Services Programmatically](../../../docs/framework/windows-services/how-to-write-services-programmatically.md).","pos":[8,542],"nodes":[{"content":"These examples use an array of type <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase&gt;</ph>, into which each service your application contains can be added, and then all of the services can be run together.","pos":[0,191],"source":"These examples use an array of type <xref:System.ServiceProcess.ServiceBase>, into which each service your application contains can be added, and then all of the services can be run together."},{"content":"If you are only creating a single service, however, you might choose not to use the array and simply declare a new object inheriting from <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase&gt;</ph> and then run it.","pos":[192,387],"source":" If you are only creating a single service, however, you might choose not to use the array and simply declare a new object inheriting from <xref:System.ServiceProcess.ServiceBase> and then run it."},{"content":"For an example, see <bpt id=\"p1\">[</bpt>How to: Write Services Programmatically<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-write-services-programmatically.md)</ept>.","pos":[388,534],"source":" For an example, see [How to: Write Services Programmatically](../../../docs/framework/windows-services/how-to-write-services-programmatically.md)."}]}]},{"content":"A series of properties on the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase&gt;</ph> class.","pos":[5023,5100],"source":"A series of properties on the <xref:System.ServiceProcess.ServiceBase> class."},{"content":"These determine what methods can be called on your service.","pos":[5101,5160]},{"content":"For example, when the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.CanStop%2A&gt;</ph> property is set to <ph id=\"ph2\">`true`</ph>, the <ph id=\"ph3\">&lt;xref:System.ServiceProcess.ServiceBase.OnStop%2A&gt;</ph> method on your service can be called.","pos":[5161,5354],"source":" For example, when the <xref:System.ServiceProcess.ServiceBase.CanStop%2A> property is set to `true`, the <xref:System.ServiceProcess.ServiceBase.OnStop%2A> method on your service can be called."},{"content":"When the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.CanPauseAndContinue%2A&gt;</ph> property is set to <ph id=\"ph2\">`true`</ph>, the <ph id=\"ph3\">&lt;xref:System.ServiceProcess.ServiceBase.OnPause%2A&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.ServiceProcess.ServiceBase.OnContinue%2A&gt;</ph> methods can be called.","pos":[5355,5592],"source":" When the <xref:System.ServiceProcess.ServiceBase.CanPauseAndContinue%2A> property is set to `true`, the <xref:System.ServiceProcess.ServiceBase.OnPause%2A> and <xref:System.ServiceProcess.ServiceBase.OnContinue%2A> methods can be called."},{"content":"When you set one of these properties to <ph id=\"ph1\">`true`</ph>, you should then override and define processing for the associated methods.","pos":[5593,5715],"source":" When you set one of these properties to `true`, you should then override and define processing for the associated methods."},{"pos":[5727,5898],"content":"[!NOTE]\nYour service must override at least <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> to be useful.","leadings":["","    >  "],"nodes":[{"content":"Your service must override at least <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase.OnStop%2A&gt;</ph> to be useful.","pos":[8,164],"source":"Your service must override at least <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> to be useful."}]},{"content":"You can also use a component called the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceController&gt;</ph> to communicate with and control the behavior of an existing service.","pos":[5905,6060],"source":"You can also use a component called the <xref:System.ServiceProcess.ServiceController> to communicate with and control the behavior of an existing service."},{"pos":[6069,6077],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Introduction to Windows Service Applications<ept id=\"p1\">](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)</ept><ph id=\"ph1\"> </ph>","pos":[6081,6218],"source":"[Introduction to Windows Service Applications](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Create Windows Services<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-create-windows-services.md)</ept>","pos":[6222,6331],"source":"[How to: Create Windows Services](../../../docs/framework/windows-services/how-to-create-windows-services.md)"}]}