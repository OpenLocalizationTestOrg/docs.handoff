{"content":"---\ntitle: \"How to: Send Data to the Active MDI Child\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"child forms\"\n  - \"MDI [Windows Forms], sending data to forms\"\n  - \"Clipboard [Windows Forms], pasting\"\n  - \"Clipboard [Windows Forms], getting data from\"\nms.assetid: 1047d2fe-1235-46db-aad9-563aea1d743b\n---\n# How to: Send Data to the Active MDI Child\nOften, within the context of [Multiple-Document Interface (MDI) Applications](multiple-document-interface-mdi-applications.md), you will need to send data to the active child window, such as when the user pastes data from the Clipboard into an MDI application.  \n  \n> [!NOTE]\n>  For information about verifying which child window has focus and sending its contents to the Clipboard, see [Determining the Active MDI Child](how-to-determine-the-active-mdi-child.md).  \n  \n### To send data to the active MDI child window from the Clipboard  \n  \n1.  Within a method, copy the text on the Clipboard to the active control of the active child form.  \n  \n    > [!NOTE]\n    >  This example assumes there is an MDI parent form (`Form1`) that has one or more MDI child windows containing a <xref:System.Windows.Forms.RichTextBox> control. For more information, see [Creating MDI Parent Forms](how-to-create-mdi-parent-forms.md).  \n  \n    ```vb  \n    Public Sub mniPaste_Click(ByVal sender As Object, _  \n       ByVal e As System.EventArgs) Handles mniPaste.Click  \n  \n       ' Determine the active child form.  \n       Dim activeChild As Form = Me.ParentForm.ActiveMDIChild  \n  \n       ' If there is an active child form, find the active control, which  \n       ' in this example should be a RichTextBox.  \n       If (Not activeChild Is Nothing) Then  \n          Try  \n             Dim theBox As RichTextBox = Ctype(activeChild.ActiveControl, RichTextBox)  \n             If (Not theBox Is Nothing) Then  \n                ' Create a new instance of the DataObject interface.  \n                Dim data As IDataObject = Clipboard.GetDataObject()  \n                ' If the data is text, then set the text of the   \n                ' RichTextBox to the text in the clipboard.  \n                If (data.GetDataPresent(DataFormats.Text)) Then  \n                   theBox.SelectedText = data.GetData(DataFormats.Text).ToString()  \n                End If  \n             End If  \n          Catch  \n             MessageBox.Show(\"You need to select a RichTextBox.\")  \n          End Try  \n       End If  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    protected void mniPaste_Click (object sender, System.EventArgs e)  \n    {  \n      // Determine the active child form.  \n       Form activeChild = this.ParentForm.ActiveMdiChild;  \n  \n       // If there is an active child form, find the active control, which  \n       // in this example should be a RichTextBox.  \n       if (activeChild != null)  \n       {  \n          try   \n          {  \n             RichTextBox theBox = (RichTextBox)activeChild.ActiveControl;  \n             if (theBox != null)  \n             {  \n                // Create a new instance of the DataObject interface.  \n                IDataObject data = Clipboard.GetDataObject();  \n                // If the data is text, then set the text of the   \n                // RichTextBox to the text in the clipboard.  \n                if (data.GetDataPresent(DataFormats.Text))  \n                {  \n                   theBox.SelectedText = data.GetData(DataFormats.Text).ToString();                 \n                }  \n             }  \n          }  \n          catch   \n          {  \n             MessageBox.Show(\"You need to select a RichTextBox.\");  \n          }  \n       }  \n    }  \n    ```  \n  \n## See also\n\n- [Multiple-Document Interface (MDI) Applications](multiple-document-interface-mdi-applications.md)\n- [How to: Create MDI Parent Forms](how-to-create-mdi-parent-forms.md)\n- [How to: Create MDI Child Forms](how-to-create-mdi-child-forms.md)\n- [How to: Determine the Active MDI Child](how-to-determine-the-active-mdi-child.md)\n- [How to: Arrange MDI Child Forms](how-to-arrange-mdi-child-forms.md)\n","nodes":[{"pos":[4,340],"embed":true,"restype":"x-metadata","content":"title: \"How to: Send Data to the Active MDI Child\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"child forms\"\n  - \"MDI [Windows Forms], sending data to forms\"\n  - \"Clipboard [Windows Forms], pasting\"\n  - \"Clipboard [Windows Forms], getting data from\"\nms.assetid: 1047d2fe-1235-46db-aad9-563aea1d743b","nodes":[{"content":"How to: Send Data to the Active MDI Child","nodes":[{"pos":[0,41],"content":"How to: Send Data to the Active MDI Child","nodes":[{"content":"How to: Send Data to the Active MDI Child","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[347,388],"content":"How to: Send Data to the Active MDI Child","linkify":"How to: Send Data to the Active MDI Child","nodes":[{"content":"How to: Send Data to the Active MDI Child","pos":[0,41]}]},{"pos":[389,649],"content":"Often, within the context of <bpt id=\"p1\">[</bpt>Multiple-Document Interface (MDI) Applications<ept id=\"p1\">](multiple-document-interface-mdi-applications.md)</ept>, you will need to send data to the active child window, such as when the user pastes data from the Clipboard into an MDI application.","source":"Often, within the context of [Multiple-Document Interface (MDI) Applications](multiple-document-interface-mdi-applications.md), you will need to send data to the active child window, such as when the user pastes data from the Clipboard into an MDI application."},{"pos":[657,853],"content":"[!NOTE]\n For information about verifying which child window has focus and sending its contents to the Clipboard, see [Determining the Active MDI Child](how-to-determine-the-active-mdi-child.md).","leadings":["","> "],"nodes":[{"content":"For information about verifying which child window has focus and sending its contents to the Clipboard, see <bpt id=\"p1\">[</bpt>Determining the Active MDI Child<ept id=\"p1\">](how-to-determine-the-active-mdi-child.md)</ept>.","pos":[9,194],"source":"For information about verifying which child window has focus and sending its contents to the Clipboard, see [Determining the Active MDI Child](how-to-determine-the-active-mdi-child.md)."}]},{"pos":[863,925],"content":"To send data to the active MDI child window from the Clipboard","linkify":"To send data to the active MDI child window from the Clipboard","nodes":[{"content":"To send data to the active MDI child window from the Clipboard","pos":[0,62]}]},{"content":"Within a method, copy the text on the Clipboard to the active control of the active child form.","pos":[935,1030]},{"pos":[1042,1306],"content":"[!NOTE]\nThis example assumes there is an MDI parent form (`Form1`) that has one or more MDI child windows containing a <xref:System.Windows.Forms.RichTextBox> control. For more information, see [Creating MDI Parent Forms](how-to-create-mdi-parent-forms.md).","leadings":["","    >  "],"nodes":[{"content":"This example assumes there is an MDI parent form (`Form1`) that has one or more MDI child windows containing a <xref:System.Windows.Forms.RichTextBox> control. For more information, see [Creating MDI Parent Forms](how-to-create-mdi-parent-forms.md).","pos":[8,257],"nodes":[{"content":"This example assumes there is an MDI parent form (<ph id=\"ph1\">`Form1`</ph>) that has one or more MDI child windows containing a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control.","pos":[0,159],"source":"This example assumes there is an MDI parent form (`Form1`) that has one or more MDI child windows containing a <xref:System.Windows.Forms.RichTextBox> control."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Creating MDI Parent Forms<ept id=\"p1\">](how-to-create-mdi-parent-forms.md)</ept>.","pos":[160,249],"source":" For more information, see [Creating MDI Parent Forms](how-to-create-mdi-parent-forms.md)."}]}]},{"pos":[3688,3696],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3700,3797],"content":"<bpt id=\"p1\">[</bpt>Multiple-Document Interface (MDI) Applications<ept id=\"p1\">](multiple-document-interface-mdi-applications.md)</ept>","source":"[Multiple-Document Interface (MDI) Applications](multiple-document-interface-mdi-applications.md)"},{"pos":[3800,3868],"content":"<bpt id=\"p1\">[</bpt>How to: Create MDI Parent Forms<ept id=\"p1\">](how-to-create-mdi-parent-forms.md)</ept>","source":"[How to: Create MDI Parent Forms](how-to-create-mdi-parent-forms.md)"},{"pos":[3871,3937],"content":"<bpt id=\"p1\">[</bpt>How to: Create MDI Child Forms<ept id=\"p1\">](how-to-create-mdi-child-forms.md)</ept>","source":"[How to: Create MDI Child Forms](how-to-create-mdi-child-forms.md)"},{"pos":[3940,4022],"content":"<bpt id=\"p1\">[</bpt>How to: Determine the Active MDI Child<ept id=\"p1\">](how-to-determine-the-active-mdi-child.md)</ept>","source":"[How to: Determine the Active MDI Child](how-to-determine-the-active-mdi-child.md)"},{"pos":[4025,4093],"content":"<bpt id=\"p1\">[</bpt>How to: Arrange MDI Child Forms<ept id=\"p1\">](how-to-arrange-mdi-child-forms.md)</ept>","source":"[How to: Arrange MDI Child Forms](how-to-arrange-mdi-child-forms.md)"}]}