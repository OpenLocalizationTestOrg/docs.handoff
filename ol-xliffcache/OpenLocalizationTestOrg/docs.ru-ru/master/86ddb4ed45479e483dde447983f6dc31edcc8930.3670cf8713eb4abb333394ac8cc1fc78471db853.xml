{"content":"---\ntitle: \"Performing Culture-Insensitive String Operations in Collections\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"CaseInsensitiveComparer class, using\"\n  - \"CollectionsUtil.CreateCaseInsensitiveHashtable method\"\n  - \"culture-insensitive string operations, collections\"\n  - \"collections [.NET Framework], culture-insensitive string operations\"\n  - \"CaseInsensitiveHashCodeProvider class, using\"\n  - \"ArrayList.Sort method\"\n  - \"SortedList class, culture-insensitive string operations\"\n  - \"culture parameter\"\nms.assetid: 5cdc9396-a64b-4615-a1cd-b605db4c5983\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# Performing Culture-Insensitive String Operations in Collections\nThere are classes and members in the <xref:System.Collections> namespace that provide culture-sensitive behavior by default. The default constructors for the <xref:System.Collections.CaseInsensitiveComparer> and <xref:System.Collections.CaseInsensitiveHashCodeProvider> classes initialize a new instance using the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> property. All overloads of the <xref:System.Collections.Specialized.CollectionsUtil.CreateCaseInsensitiveHashtable%2A?displayProperty=nameWithType> method create a new instance of the <xref:System.Collections.Hashtable> class using the `Thread.CurrentCulture` property by default. Overloads of the <xref:System.Collections.ArrayList.Sort%2A?displayProperty=nameWithType> method perform culture-sensitive sorts by default using `Thread.CurrentCulture`. Sorting and lookup in a <xref:System.Collections.SortedList> can be affected by `Thread.CurrentCulture` when strings are used as the keys. Follow the usage recommendations provided in this section to obtain culture-insensitive results from these classes and methods in the `Collections` namespace.  \n  \n **Note** Passing <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> to a comparison method does perform a culture-insensitive comparison. However, it does not cause a non-linguistic comparison, for example, for file paths, registry keys, and environment variables. Neither does it support security decisions based on the comparison result. For a non-linguistic comparison or support for result-based security decisions, the application should use a comparison method that accepts a <xref:System.StringComparison> value. The application should then pass <xref:System.StringComparison>.  \n  \n## Using the CaseInsensitiveComparer and CaseInsensitiveHashCodeProvider Classes  \n The default constructors for `CaseInsensitiveHashCodeProvider` and `CaseInsensitiveComparer` initialize a new instance of the class using the `Thread.CurrentCulture`, resulting in culture-sensitive behavior. The following code example demonstrates the constructor for a `Hashtable` that is culture-sensitive because it uses the default constructors for `CaseInsensitiveHashCodeProvider` and `CaseInsensitiveComparer`.  \n  \n```vb  \ninternalHashtable = New Hashtable(CaseInsensitiveHashCodeProvider.Default, CaseInsensitiveComparer.Default)  \n```  \n  \n```csharp  \ninternalHashtable = new Hashtable(CaseInsensitiveHashCodeProvider.Default, CaseInsensitiveComparer.Default);  \n```  \n  \n If you want to create a culture-insensitive `Hashtable` using the `CaseInsensitiveComparer` and `CaseInsensitiveHashCodeProvider` classes, initialize new instances of these classes using the constructors that accept a `culture` parameter. For the `culture` parameter, specify <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType>. The following code example demonstrates the constructor for a culture-insensitive `Hashtable`.  \n  \n```vb  \ninternalHashtable = New Hashtable(New  \n    CaseInsensitiveHashCodeProvider(CultureInfo.InvariantCulture),  \n    New CaseInsensitiveComparer(CultureInfo.InvariantCulture))  \n```  \n  \n```csharp  \ninternalHashtable = new Hashtable(new CaseInsensitiveHashCodeProvider  \n    (CultureInfo.InvariantCulture),   \n    new CaseInsensitiveComparer(CultureInfo.InvariantCulture));  \n```  \n  \n## Using the CollectionsUtil.CreateCaseInsensitiveHashTable Method  \n The `CollectionsUtil.CreateCaseInsensitiveHashTable` method is a useful shortcut for creating a new instance of the `Hashtable` class that ignores the case of strings. However, all overloads of the `CollectionsUtil.CreateCaseInsensitiveHashTable` method are culture-sensitive because they use the `Thread.CurrentCulture` property. You cannot create a culture-insensitive `Hashtable` using this method. To create a culture-insensitive `Hashtable`, use the `Hashtable` constructor that accepts a `culture` parameter. For the `culture` parameter, specify `CultureInfo.InvariantCulture`. The following code example demonstrates the constructor for a culture-insensitive `Hashtable`.  \n  \n```vb  \ninternalHashtable = New Hashtable(New  \n    CaseInsensitiveHashCodeProvider(CultureInfo.InvariantCulture),  \n    New CaseInsensitiveComparer(CultureInfo.InvariantCulture))  \n```  \n  \n```csharp  \ninternalHashtable = new Hashtable(new CaseInsensitiveHashCodeProvider  \n    (CultureInfo.InvariantCulture),   \n    new CaseInsensitiveComparer(CultureInfo.InvariantCulture));  \n```  \n  \n<a name=\"cpconperformingculture-insensitivestringoperationsincollectionsanchor1\"></a>   \n## Using the SortedList Class  \n A `SortedList` represents a collection of key-and-value pairs that are sorted by the keys and are accessible by key and by index. When you use a `SortedList` where strings are the keys, the sorting and lookup can be affected by the `Thread.CurrentCulture` property. To obtain culture-insensitive behavior from a `SortedList`, create a `SortedList` using one of the constructors that accepts a `comparer` parameter. The `comparer` parameter specifies the <xref:System.Collections.IComparer> implementation to use when comparing keys. For the parameter, specify a custom comparer class that uses `CultureInfo.InvariantCulture` to compare keys. The following example illustrates a custom culture-insensitive comparer class that you can specify as the `comparer` parameter to a `SortedList` constructor.  \n  \n```vb  \nImports System  \nImports System.Collections  \nImports System.Globalization  \n  \nFriend Class InvariantComparer  \n    Implements IComparer   \n    Private m_compareInfo As CompareInfo  \n    Friend Shared [Default] As New InvariantComparer()  \n  \n    Friend Sub New()  \n        m_compareInfo = CultureInfo.InvariantCulture.CompareInfo  \n    End Sub     \n  \n    Public Function Compare(a As Object, b As Object) As Integer _  \n            Implements IComparer.Compare  \n        Dim sa As String = CType(a, String)  \n        Dim sb As String = CType(b, String)  \n        If Not (sa Is Nothing) And Not (sb Is Nothing) Then  \n            Return m_compareInfo.Compare(sa, sb)  \n        Else  \n            Return Comparer.Default.Compare(a, b)  \n        End If  \n    End Function  \nEnd Class  \n```  \n  \n```csharp  \nusing System;  \nusing System.Collections;  \nusing System.Globalization;  \n  \ninternal class InvariantComparer : IComparer   \n{  \n    private CompareInfo m_compareInfo;  \n    internal static readonly InvariantComparer Default = new  \n        InvariantComparer();  \n  \n    internal InvariantComparer()   \n    {  \n        m_compareInfo = CultureInfo.InvariantCulture.CompareInfo;  \n    }  \n  \n    public int Compare(Object a, Object b)  \n    {  \n        String sa = a as String;  \n        String sb = b as String;  \n        if (sa != null && sb != null)  \n            return m_compareInfo.Compare(sa, sb);  \n        else  \n            return Comparer.Default.Compare(a,b);  \n    }  \n}  \n```  \n  \n In general, if you use a `SortedList` on strings without specifying a custom invariant comparer, a change to `Thread.CurrentCulture` after the list has been populated can invalidate the list.  \n  \n## Using the ArrayList.Sort Method  \n Overloads of the `ArrayList.Sort` method perform culture-sensitive sorts by default using the `Thread.CurrentCulture` property. Results can vary by culture due to different sort orders. To eliminate culture-sensitive behavior, use the overloads of this method that accept an `IComparer` implementation. For the `comparer` parameter, specify a custom invariant comparer class that uses `CultureInfo.InvariantCulture`. An example of a custom invariant comparer class is provided in the [Using the SortedList Class](#cpconperformingculture-insensitivestringoperationsincollectionsanchor1) topic.  \n  \n## See also\n\n- <xref:System.Collections.CaseInsensitiveComparer>\n- <xref:System.Collections.CaseInsensitiveHashCodeProvider>\n- <xref:System.Collections.ArrayList.Sort%2A?displayProperty=nameWithType>\n- <xref:System.Collections.SortedList>\n- <xref:System.Collections.Hashtable>\n- <xref:System.Collections.IComparer>\n- [Performing Culture-Insensitive String Operations](../../../docs/standard/globalization-localization/performing-culture-insensitive-string-operations.md)\n- <xref:System.Collections.Specialized.CollectionsUtil.CreateCaseInsensitiveHashtable%2A?displayProperty=nameWithType>\n","nodes":[{"pos":[4,673],"embed":true,"restype":"x-metadata","content":"title: \"Performing Culture-Insensitive String Operations in Collections\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"CaseInsensitiveComparer class, using\"\n  - \"CollectionsUtil.CreateCaseInsensitiveHashtable method\"\n  - \"culture-insensitive string operations, collections\"\n  - \"collections [.NET Framework], culture-insensitive string operations\"\n  - \"CaseInsensitiveHashCodeProvider class, using\"\n  - \"ArrayList.Sort method\"\n  - \"SortedList class, culture-insensitive string operations\"\n  - \"culture parameter\"\nms.assetid: 5cdc9396-a64b-4615-a1cd-b605db4c5983\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"Performing Culture-Insensitive String Operations in Collections","nodes":[{"pos":[0,63],"content":"Performing Culture-Insensitive String Operations in Collections","nodes":[{"content":"Performing Culture-Insensitive String Operations in Collections","pos":[0,63]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[680,743],"content":"Performing Culture-Insensitive String Operations in Collections","linkify":"Performing Culture-Insensitive String Operations in Collections","nodes":[{"content":"Performing Culture-Insensitive String Operations in Collections","pos":[0,63]}]},{"content":"There are classes and members in the <ph id=\"ph1\">&lt;xref:System.Collections&gt;</ph> namespace that provide culture-sensitive behavior by default.","pos":[744,868],"source":"There are classes and members in the <xref:System.Collections> namespace that provide culture-sensitive behavior by default."},{"content":"The default constructors for the <ph id=\"ph1\">&lt;xref:System.Collections.CaseInsensitiveComparer&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Collections.CaseInsensitiveHashCodeProvider&gt;</ph> classes initialize a new instance using the <ph id=\"ph3\">&lt;xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType&gt;</ph> property.","pos":[869,1145],"source":" The default constructors for the <xref:System.Collections.CaseInsensitiveComparer> and <xref:System.Collections.CaseInsensitiveHashCodeProvider> classes initialize a new instance using the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> property."},{"content":"All overloads of the <ph id=\"ph1\">&lt;xref:System.Collections.Specialized.CollectionsUtil.CreateCaseInsensitiveHashtable%2A?displayProperty=nameWithType&gt;</ph> method create a new instance of the <ph id=\"ph2\">&lt;xref:System.Collections.Hashtable&gt;</ph> class using the <ph id=\"ph3\">`Thread.CurrentCulture`</ph> property by default.","pos":[1146,1416],"source":" All overloads of the <xref:System.Collections.Specialized.CollectionsUtil.CreateCaseInsensitiveHashtable%2A?displayProperty=nameWithType> method create a new instance of the <xref:System.Collections.Hashtable> class using the `Thread.CurrentCulture` property by default."},{"content":"Overloads of the <ph id=\"ph1\">&lt;xref:System.Collections.ArrayList.Sort%2A?displayProperty=nameWithType&gt;</ph> method perform culture-sensitive sorts by default using <ph id=\"ph2\">`Thread.CurrentCulture`</ph>.","pos":[1417,1587],"source":" Overloads of the <xref:System.Collections.ArrayList.Sort%2A?displayProperty=nameWithType> method perform culture-sensitive sorts by default using `Thread.CurrentCulture`."},{"content":"Sorting and lookup in a <ph id=\"ph1\">&lt;xref:System.Collections.SortedList&gt;</ph> can be affected by <ph id=\"ph2\">`Thread.CurrentCulture`</ph> when strings are used as the keys.","pos":[1588,1726],"source":" Sorting and lookup in a <xref:System.Collections.SortedList> can be affected by `Thread.CurrentCulture` when strings are used as the keys."},{"content":"Follow the usage recommendations provided in this section to obtain culture-insensitive results from these classes and methods in the <ph id=\"ph1\">`Collections`</ph> namespace.","pos":[1727,1885],"source":" Follow the usage recommendations provided in this section to obtain culture-insensitive results from these classes and methods in the `Collections` namespace."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> Passing <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType&gt;</ph> to a comparison method does perform a culture-insensitive comparison.","pos":[1892,2067],"source":"**Note** Passing <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> to a comparison method does perform a culture-insensitive comparison."},{"content":"However, it does not cause a non-linguistic comparison, for example, for file paths, registry keys, and environment variables.","pos":[2068,2194]},{"content":"Neither does it support security decisions based on the comparison result.","pos":[2195,2269]},{"content":"For a non-linguistic comparison or support for result-based security decisions, the application should use a comparison method that accepts a <ph id=\"ph1\">&lt;xref:System.StringComparison&gt;</ph> value.","pos":[2270,2449],"source":" For a non-linguistic comparison or support for result-based security decisions, the application should use a comparison method that accepts a <xref:System.StringComparison> value."},{"content":"The application should then pass <ph id=\"ph1\">&lt;xref:System.StringComparison&gt;</ph>.","pos":[2450,2514],"source":" The application should then pass <xref:System.StringComparison>."},{"pos":[2523,2600],"content":"Using the CaseInsensitiveComparer and CaseInsensitiveHashCodeProvider Classes","linkify":"Using the CaseInsensitiveComparer and CaseInsensitiveHashCodeProvider Classes","nodes":[{"content":"Using the CaseInsensitiveComparer and CaseInsensitiveHashCodeProvider Classes","pos":[0,77]}]},{"content":"The default constructors for <ph id=\"ph1\">`CaseInsensitiveHashCodeProvider`</ph> and <ph id=\"ph2\">`CaseInsensitiveComparer`</ph> initialize a new instance of the class using the <ph id=\"ph3\">`Thread.CurrentCulture`</ph>, resulting in culture-sensitive behavior.","pos":[2604,2811],"source":"The default constructors for `CaseInsensitiveHashCodeProvider` and `CaseInsensitiveComparer` initialize a new instance of the class using the `Thread.CurrentCulture`, resulting in culture-sensitive behavior."},{"content":"The following code example demonstrates the constructor for a <ph id=\"ph1\">`Hashtable`</ph> that is culture-sensitive because it uses the default constructors for <ph id=\"ph2\">`CaseInsensitiveHashCodeProvider`</ph> and <ph id=\"ph3\">`CaseInsensitiveComparer`</ph>.","pos":[2812,3021],"source":" The following code example demonstrates the constructor for a `Hashtable` that is culture-sensitive because it uses the default constructors for `CaseInsensitiveHashCodeProvider` and `CaseInsensitiveComparer`."},{"content":"If you want to create a culture-insensitive <ph id=\"ph1\">`Hashtable`</ph> using the <ph id=\"ph2\">`CaseInsensitiveComparer`</ph> and <ph id=\"ph3\">`CaseInsensitiveHashCodeProvider`</ph> classes, initialize new instances of these classes using the constructors that accept a <ph id=\"ph4\">`culture`</ph> parameter.","pos":[3287,3525],"source":"If you want to create a culture-insensitive `Hashtable` using the `CaseInsensitiveComparer` and `CaseInsensitiveHashCodeProvider` classes, initialize new instances of these classes using the constructors that accept a `culture` parameter."},{"content":"For the <ph id=\"ph1\">`culture`</ph> parameter, specify <ph id=\"ph2\">&lt;xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType&gt;</ph>.","pos":[3526,3652],"source":" For the `culture` parameter, specify <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType>."},{"content":"The following code example demonstrates the constructor for a culture-insensitive <ph id=\"ph1\">`Hashtable`</ph>.","pos":[3653,3747],"source":" The following code example demonstrates the constructor for a culture-insensitive `Hashtable`."},{"pos":[4145,4208],"content":"Using the CollectionsUtil.CreateCaseInsensitiveHashTable Method","linkify":"Using the CollectionsUtil.CreateCaseInsensitiveHashTable Method","nodes":[{"content":"Using the CollectionsUtil.CreateCaseInsensitiveHashTable Method","pos":[0,63]}]},{"content":"The <ph id=\"ph1\">`CollectionsUtil.CreateCaseInsensitiveHashTable`</ph> method is a useful shortcut for creating a new instance of the <ph id=\"ph2\">`Hashtable`</ph> class that ignores the case of strings.","pos":[4212,4379],"source":"The `CollectionsUtil.CreateCaseInsensitiveHashTable` method is a useful shortcut for creating a new instance of the `Hashtable` class that ignores the case of strings."},{"content":"However, all overloads of the <ph id=\"ph1\">`CollectionsUtil.CreateCaseInsensitiveHashTable`</ph> method are culture-sensitive because they use the <ph id=\"ph2\">`Thread.CurrentCulture`</ph> property.","pos":[4380,4542],"source":" However, all overloads of the `CollectionsUtil.CreateCaseInsensitiveHashTable` method are culture-sensitive because they use the `Thread.CurrentCulture` property."},{"content":"You cannot create a culture-insensitive <ph id=\"ph1\">`Hashtable`</ph> using this method.","pos":[4543,4613],"source":" You cannot create a culture-insensitive `Hashtable` using this method."},{"content":"To create a culture-insensitive <ph id=\"ph1\">`Hashtable`</ph>, use the <ph id=\"ph2\">`Hashtable`</ph> constructor that accepts a <ph id=\"ph3\">`culture`</ph> parameter.","pos":[4614,4726],"source":" To create a culture-insensitive `Hashtable`, use the `Hashtable` constructor that accepts a `culture` parameter."},{"content":"For the <ph id=\"ph1\">`culture`</ph> parameter, specify <ph id=\"ph2\">`CultureInfo.InvariantCulture`</ph>.","pos":[4727,4795],"source":" For the `culture` parameter, specify `CultureInfo.InvariantCulture`."},{"content":"The following code example demonstrates the constructor for a culture-insensitive <ph id=\"ph1\">`Hashtable`</ph>.","pos":[4796,4890],"source":" The following code example demonstrates the constructor for a culture-insensitive `Hashtable`."},{"pos":[5377,5403],"content":"Using the SortedList Class","linkify":"Using the SortedList Class","nodes":[{"content":"Using the SortedList Class","pos":[0,26]}]},{"content":"A <ph id=\"ph1\">`SortedList`</ph> represents a collection of key-and-value pairs that are sorted by the keys and are accessible by key and by index.","pos":[5407,5536],"source":"A `SortedList` represents a collection of key-and-value pairs that are sorted by the keys and are accessible by key and by index."},{"content":"When you use a <ph id=\"ph1\">`SortedList`</ph> where strings are the keys, the sorting and lookup can be affected by the <ph id=\"ph2\">`Thread.CurrentCulture`</ph> property.","pos":[5537,5672],"source":" When you use a `SortedList` where strings are the keys, the sorting and lookup can be affected by the `Thread.CurrentCulture` property."},{"content":"To obtain culture-insensitive behavior from a <ph id=\"ph1\">`SortedList`</ph>, create a <ph id=\"ph2\">`SortedList`</ph> using one of the constructors that accepts a <ph id=\"ph3\">`comparer`</ph> parameter.","pos":[5673,5821],"source":" To obtain culture-insensitive behavior from a `SortedList`, create a `SortedList` using one of the constructors that accepts a `comparer` parameter."},{"content":"The <ph id=\"ph1\">`comparer`</ph> parameter specifies the <ph id=\"ph2\">&lt;xref:System.Collections.IComparer&gt;</ph> implementation to use when comparing keys.","pos":[5822,5939],"source":" The `comparer` parameter specifies the <xref:System.Collections.IComparer> implementation to use when comparing keys."},{"content":"For the parameter, specify a custom comparer class that uses <ph id=\"ph1\">`CultureInfo.InvariantCulture`</ph> to compare keys.","pos":[5940,6048],"source":" For the parameter, specify a custom comparer class that uses `CultureInfo.InvariantCulture` to compare keys."},{"content":"The following example illustrates a custom culture-insensitive comparer class that you can specify as the <ph id=\"ph1\">`comparer`</ph> parameter to a <ph id=\"ph2\">`SortedList`</ph> constructor.","pos":[6049,6206],"source":" The following example illustrates a custom culture-insensitive comparer class that you can specify as the `comparer` parameter to a `SortedList` constructor."},{"pos":[7721,7912],"content":"In general, if you use a <ph id=\"ph1\">`SortedList`</ph> on strings without specifying a custom invariant comparer, a change to <ph id=\"ph2\">`Thread.CurrentCulture`</ph> after the list has been populated can invalidate the list.","source":"In general, if you use a `SortedList` on strings without specifying a custom invariant comparer, a change to `Thread.CurrentCulture` after the list has been populated can invalidate the list."},{"pos":[7921,7952],"content":"Using the ArrayList.Sort Method","linkify":"Using the ArrayList.Sort Method","nodes":[{"content":"Using the ArrayList.Sort Method","pos":[0,31]}]},{"content":"Overloads of the <ph id=\"ph1\">`ArrayList.Sort`</ph> method perform culture-sensitive sorts by default using the <ph id=\"ph2\">`Thread.CurrentCulture`</ph> property.","pos":[7956,8083],"source":"Overloads of the `ArrayList.Sort` method perform culture-sensitive sorts by default using the `Thread.CurrentCulture` property."},{"content":"Results can vary by culture due to different sort orders.","pos":[8084,8141]},{"content":"To eliminate culture-sensitive behavior, use the overloads of this method that accept an <ph id=\"ph1\">`IComparer`</ph> implementation.","pos":[8142,8258],"source":" To eliminate culture-sensitive behavior, use the overloads of this method that accept an `IComparer` implementation."},{"content":"For the <ph id=\"ph1\">`comparer`</ph> parameter, specify a custom invariant comparer class that uses <ph id=\"ph2\">`CultureInfo.InvariantCulture`</ph>.","pos":[8259,8372],"source":" For the `comparer` parameter, specify a custom invariant comparer class that uses `CultureInfo.InvariantCulture`."},{"content":"An example of a custom invariant comparer class is provided in the <bpt id=\"p1\">[</bpt>Using the SortedList Class<ept id=\"p1\">](#cpconperformingculture-insensitivestringoperationsincollectionsanchor1)</ept> topic.","pos":[8373,8548],"source":" An example of a custom invariant comparer class is provided in the [Using the SortedList Class](#cpconperformingculture-insensitivestringoperationsincollectionsanchor1) topic."},{"pos":[8557,8565],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8871,9024],"content":"<bpt id=\"p1\">[</bpt>Performing Culture-Insensitive String Operations<ept id=\"p1\">](../../../docs/standard/globalization-localization/performing-culture-insensitive-string-operations.md)</ept>","source":"[Performing Culture-Insensitive String Operations](../../../docs/standard/globalization-localization/performing-culture-insensitive-string-operations.md)"}]}