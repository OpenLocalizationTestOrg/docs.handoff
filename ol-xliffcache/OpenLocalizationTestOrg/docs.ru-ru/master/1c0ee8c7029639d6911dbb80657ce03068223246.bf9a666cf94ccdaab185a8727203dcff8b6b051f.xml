{"content":"---\ntitle: \"How to: Insert a MenuStrip into an MDI Drop-Down Menu (Windows Forms)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"MenuStrip control [Windows Forms], inserting\"\n  - \"MenuStrip control [Windows Forms], merging\"\n  - \"MDI [Windows Forms], merging menu items\"\nms.assetid: 0fad444e-26d9-49af-8860-044d9c10d608\n---\n# How to: Insert a MenuStrip into an MDI Drop-Down Menu (Windows Forms)\nIn some applications, the kind of a multiple-document interface (MDI) child window can be different from the MDI parent window. For example, the MDI parent might be a spreadsheet, and the MDI child might be a chart. In that case, you want to update the contents of the MDI parent's menu with the contents of the MDI child's menu as MDI child windows of different kinds are activated.  \n  \n The following procedure uses the <xref:System.Windows.Forms.Form.IsMdiContainer%2A>, <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A>, <xref:System.Windows.Forms.MergeAction>, and <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> properties to insert a group of menu items from the MDI child menu into the drop-down part of the MDI parent menu. Closing the MDI child window removes the inserted menu items from the MDI parent.  \n  \n### To insert a MenuStrip into an MDI drop-down menu  \n  \n1.  Create a form and set its <xref:System.Windows.Forms.Form.IsMdiContainer%2A> property to `true`.  \n  \n2.  Add a <xref:System.Windows.Forms.MenuStrip> to `Form1` and set the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property of the <xref:System.Windows.Forms.MenuStrip> to `true`.  \n  \n3.  Add a top-level menu item to the `Form1`<xref:System.Windows.Forms.MenuStrip> and set its <xref:System.Windows.Forms.Control.Text%2A> property to `&File`.  \n  \n4.  Add three submenu items to the `&File` menu item and set their <xref:System.Windows.Forms.ToolStripItem.Text%2A> properties to `&Open`, `&Import from`, and `E&xit`.  \n  \n5.  Add two submenu items to the `&Import from` submenu item and set their <xref:System.Windows.Forms.ToolStripItem.Text%2A> properties to `&Word` and `&Excel`.  \n  \n6.  Add a form to the project, add a <xref:System.Windows.Forms.MenuStrip> to the form, and set the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property of the `Form2`<xref:System.Windows.Forms.MenuStrip> to `true`.  \n  \n7.  Add a top-level menu item to the `Form2`<xref:System.Windows.Forms.MenuStrip> and set its <xref:System.Windows.Forms.ToolStripItem.Text%2A> property to `&File`.  \n  \n8.  Add submenu items to the `&File` menu of `Form2` in the following order: a <xref:System.Windows.Forms.ToolStripSeparator>, `&Save`, `Save and &Close`, and another <xref:System.Windows.Forms.ToolStripSeparator>.  \n  \n9. Set the <xref:System.Windows.Forms.MergeAction> and <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> properties of the `Form2` menu items as shown in the following table.  \n  \n    |Form2 menu item|MergeAction value|MergeIndex value|  \n    |---------------------|-----------------------|----------------------|  \n    |File|MatchOnly|-1|  \n    |Separator|Insert|2|  \n    |Save|Insert|3|  \n    |Save and Close|Insert|4|  \n    |Separator|Insert|5|  \n  \n10. Create an event handler for the <xref:System.Windows.Forms.Control.Click> event of the `&Open`<xref:System.Windows.Forms.ToolStripMenuItem>.  \n  \n11. Within the event handler, insert code similar to the following code example to create and display new instances of `Form2` as MDI children of `Form1`.  \n  \n    ```vb  \n    Private Sub openToolStripMenuItem_Click(ByVal sender As System.Object, _  \n    ByVal e As System.EventArgs) Handles openToolStripMenuItem.Click  \n        Dim NewMDIChild As New Form2()  \n        'Set the parent form of the child window.  \n            NewMDIChild.MdiParent = Me  \n        'Display the new form.  \n            NewMDIChild.Show()  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    private void openToolStripMenuItem_Click(object sender, EventArgs e)  \n    {  \n        Form2 newMDIChild = new Form2();  \n        // Set the parent form of the child window.  \n            newMDIChild.MdiParent = this;  \n        // Display the new form.  \n            newMDIChild.Show();  \n    }  \n    ```  \n  \n12. Place code similar to the following code example in the `&Open`<xref:System.Windows.Forms.ToolStripMenuItem> to register the event handler.  \n  \n    ```vb  \n    Private Sub openToolStripMenuItem_Click(sender As Object, e As _  \n    EventArgs) Handles openToolStripMenuItem.Click  \n    ```  \n  \n    ```csharp  \n    this.openToolStripMenuItem.Click += new System.EventHandler(this.openToolStripMenuItem_Click);  \n    ```  \n  \n## Compiling the Code  \n This example requires:  \n  \n-   Two <xref:System.Windows.Forms.Form> controls named `Form1` and `Form2`.  \n  \n-   A <xref:System.Windows.Forms.MenuStrip> control on `Form1` named `menuStrip1`, and a <xref:System.Windows.Forms.MenuStrip> control on `Form2` named `menuStrip2`.  \n  \n-   References to the <xref:System?displayProperty=nameWithType> and <xref:System.Windows.Forms?displayProperty=nameWithType> assemblies.  \n  \n## See also\n\n- [How to: Create MDI Parent Forms](../advanced/how-to-create-mdi-parent-forms.md)\n- [How to: Create MDI Child Forms](../advanced/how-to-create-mdi-child-forms.md)\n- [MenuStrip Control Overview](menustrip-control-overview-windows-forms.md)\n","nodes":[{"pos":[4,355],"embed":true,"restype":"x-metadata","content":"title: \"How to: Insert a MenuStrip into an MDI Drop-Down Menu (Windows Forms)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"MenuStrip control [Windows Forms], inserting\"\n  - \"MenuStrip control [Windows Forms], merging\"\n  - \"MDI [Windows Forms], merging menu items\"\nms.assetid: 0fad444e-26d9-49af-8860-044d9c10d608","nodes":[{"content":"How to: Insert a MenuStrip into an MDI Drop-Down Menu (Windows Forms)","nodes":[{"pos":[0,69],"content":"How to: Insert a MenuStrip into an MDI Drop-Down Menu (Windows Forms)","nodes":[{"content":"How to: Insert a MenuStrip into an MDI Drop-Down Menu (Windows Forms)","pos":[0,69]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[362,431],"content":"How to: Insert a MenuStrip into an MDI Drop-Down Menu (Windows Forms)","linkify":"How to: Insert a MenuStrip into an MDI Drop-Down Menu (Windows Forms)","nodes":[{"content":"How to: Insert a MenuStrip into an MDI Drop-Down Menu (Windows Forms)","pos":[0,69]}]},{"content":"In some applications, the kind of a multiple-document interface (MDI) child window can be different from the MDI parent window.","pos":[432,559]},{"content":"For example, the MDI parent might be a spreadsheet, and the MDI child might be a chart.","pos":[560,647]},{"content":"In that case, you want to update the contents of the MDI parent's menu with the contents of the MDI child's menu as MDI child windows of different kinds are activated.","pos":[648,815]},{"content":"The following procedure uses the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.IsMdiContainer%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStrip.AllowMerge%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Forms.MergeAction&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A&gt;</ph> properties to insert a group of menu items from the MDI child menu into the drop-down part of the MDI parent menu.","pos":[822,1175],"source":"The following procedure uses the <xref:System.Windows.Forms.Form.IsMdiContainer%2A>, <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A>, <xref:System.Windows.Forms.MergeAction>, and <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> properties to insert a group of menu items from the MDI child menu into the drop-down part of the MDI parent menu."},{"content":"Closing the MDI child window removes the inserted menu items from the MDI parent.","pos":[1176,1257]},{"pos":[1267,1315],"content":"To insert a MenuStrip into an MDI drop-down menu","linkify":"To insert a MenuStrip into an MDI drop-down menu","nodes":[{"content":"To insert a MenuStrip into an MDI drop-down menu","pos":[0,48]}]},{"pos":[1325,1421],"content":"Create a form and set its <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.IsMdiContainer%2A&gt;</ph> property to <ph id=\"ph2\">`true`</ph>.","source":"Create a form and set its <xref:System.Windows.Forms.Form.IsMdiContainer%2A> property to `true`."},{"pos":[1431,1614],"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> to <ph id=\"ph2\">`Form1`</ph> and set the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ToolStrip.AllowMerge%2A&gt;</ph> property of the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> to <ph id=\"ph5\">`true`</ph>.","source":"Add a <xref:System.Windows.Forms.MenuStrip> to `Form1` and set the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property of the <xref:System.Windows.Forms.MenuStrip> to `true`."},{"pos":[1624,1778],"content":"Add a top-level menu item to the <ph id=\"ph1\">`Form1`</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> and set its <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Control.Text%2A&gt;</ph> property to <ph id=\"ph4\">`&amp;File`</ph>.","source":"Add a top-level menu item to the `Form1`<xref:System.Windows.Forms.MenuStrip> and set its <xref:System.Windows.Forms.Control.Text%2A> property to `&File`."},{"pos":[1788,1952],"content":"Add three submenu items to the <ph id=\"ph1\">`&amp;File`</ph> menu item and set their <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripItem.Text%2A&gt;</ph> properties to <ph id=\"ph3\">`&amp;Open`</ph>, <ph id=\"ph4\">`&amp;Import from`</ph>, and <ph id=\"ph5\">`E&amp;xit`</ph>.","source":"Add three submenu items to the `&File` menu item and set their <xref:System.Windows.Forms.ToolStripItem.Text%2A> properties to `&Open`, `&Import from`, and `E&xit`."},{"pos":[1962,2118],"content":"Add two submenu items to the <ph id=\"ph1\">`&amp;Import from`</ph> submenu item and set their <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripItem.Text%2A&gt;</ph> properties to <ph id=\"ph3\">`&amp;Word`</ph> and <ph id=\"ph4\">`&amp;Excel`</ph>.","source":"Add two submenu items to the `&Import from` submenu item and set their <xref:System.Windows.Forms.ToolStripItem.Text%2A> properties to `&Word` and `&Excel`."},{"pos":[2128,2347],"content":"Add a form to the project, add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> to the form, and set the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStrip.AllowMerge%2A&gt;</ph> property of the <ph id=\"ph3\">`Form2`</ph><ph id=\"ph4\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> to <ph id=\"ph5\">`true`</ph>.","source":"Add a form to the project, add a <xref:System.Windows.Forms.MenuStrip> to the form, and set the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property of the `Form2`<xref:System.Windows.Forms.MenuStrip> to `true`."},{"pos":[2357,2517],"content":"Add a top-level menu item to the <ph id=\"ph1\">`Form2`</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> and set its <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ToolStripItem.Text%2A&gt;</ph> property to <ph id=\"ph4\">`&amp;File`</ph>.","source":"Add a top-level menu item to the `Form2`<xref:System.Windows.Forms.MenuStrip> and set its <xref:System.Windows.Forms.ToolStripItem.Text%2A> property to `&File`."},{"pos":[2527,2737],"content":"Add submenu items to the <ph id=\"ph1\">`&amp;File`</ph> menu of <ph id=\"ph2\">`Form2`</ph> in the following order: a <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ToolStripSeparator&gt;</ph>, <ph id=\"ph4\">`&amp;Save`</ph>, <ph id=\"ph5\">`Save and &amp;Close`</ph>, and another <ph id=\"ph6\">&lt;xref:System.Windows.Forms.ToolStripSeparator&gt;</ph>.","source":"Add submenu items to the `&File` menu of `Form2` in the following order: a <xref:System.Windows.Forms.ToolStripSeparator>, `&Save`, `Save and &Close`, and another <xref:System.Windows.Forms.ToolStripSeparator>."},{"pos":[2746,2923],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MergeAction&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A&gt;</ph> properties of the <ph id=\"ph3\">`Form2`</ph> menu items as shown in the following table.","source":"Set the <xref:System.Windows.Forms.MergeAction> and <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> properties of the `Form2` menu items as shown in the following table."},{"content":"Form2 menu item","pos":[2934,2949]},{"content":"MergeAction value","pos":[2950,2967]},{"content":"MergeIndex value","pos":[2968,2984]},{"content":"File","pos":[3070,3074]},{"content":"MatchOnly","pos":[3075,3084]},{"content":"-1","pos":[3085,3087]},{"content":"Separator","pos":[3096,3105]},{"content":"Insert","pos":[3106,3112]},{"content":"2","pos":[3113,3114]},{"content":"Save","pos":[3123,3127]},{"content":"Insert","pos":[3128,3134]},{"content":"3","pos":[3135,3136]},{"content":"Save and Close","pos":[3145,3159]},{"content":"Insert","pos":[3160,3166]},{"content":"4","pos":[3167,3168]},{"content":"Separator","pos":[3177,3186]},{"content":"Insert","pos":[3187,3193]},{"content":"5","pos":[3194,3195]},{"pos":[3206,3346],"content":"Create an event handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event of the <ph id=\"ph2\">`&amp;Open`</ph><ph id=\"ph3\">&lt;xref:System.Windows.Forms.ToolStripMenuItem&gt;</ph>.","source":"Create an event handler for the <xref:System.Windows.Forms.Control.Click> event of the `&Open`<xref:System.Windows.Forms.ToolStripMenuItem>."},{"pos":[3356,3506],"content":"Within the event handler, insert code similar to the following code example to create and display new instances of <ph id=\"ph1\">`Form2`</ph> as MDI children of <ph id=\"ph2\">`Form1`</ph>.","source":"Within the event handler, insert code similar to the following code example to create and display new instances of `Form2` as MDI children of `Form1`."},{"pos":[4235,4374],"content":"Place code similar to the following code example in the <ph id=\"ph1\">`&amp;Open`</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripMenuItem&gt;</ph> to register the event handler.","source":"Place code similar to the following code example in the `&Open`<xref:System.Windows.Forms.ToolStripMenuItem> to register the event handler."},{"pos":[4662,4680],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"This example requires:","pos":[4684,4706]},{"pos":[4716,4788],"content":"Two <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form&gt;</ph> controls named <ph id=\"ph2\">`Form1`</ph> and <ph id=\"ph3\">`Form2`</ph>.","source":"Two <xref:System.Windows.Forms.Form> controls named `Form1` and `Form2`."},{"pos":[4798,4959],"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> control on <ph id=\"ph2\">`Form1`</ph> named <ph id=\"ph3\">`menuStrip1`</ph>, and a <ph id=\"ph4\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> control on <ph id=\"ph5\">`Form2`</ph> named <ph id=\"ph6\">`menuStrip2`</ph>.","source":"A <xref:System.Windows.Forms.MenuStrip> control on `Form1` named `menuStrip1`, and a <xref:System.Windows.Forms.MenuStrip> control on `Form2` named `menuStrip2`."},{"pos":[4969,5102],"content":"References to the <ph id=\"ph1\">&lt;xref:System?displayProperty=nameWithType&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms?displayProperty=nameWithType&gt;</ph> assemblies.","source":"References to the <xref:System?displayProperty=nameWithType> and <xref:System.Windows.Forms?displayProperty=nameWithType> assemblies."},{"pos":[5111,5119],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5123,5203],"content":"<bpt id=\"p1\">[</bpt>How to: Create MDI Parent Forms<ept id=\"p1\">](../advanced/how-to-create-mdi-parent-forms.md)</ept>","source":"[How to: Create MDI Parent Forms](../advanced/how-to-create-mdi-parent-forms.md)"},{"pos":[5206,5284],"content":"<bpt id=\"p1\">[</bpt>How to: Create MDI Child Forms<ept id=\"p1\">](../advanced/how-to-create-mdi-child-forms.md)</ept>","source":"[How to: Create MDI Child Forms](../advanced/how-to-create-mdi-child-forms.md)"},{"pos":[5287,5360],"content":"<bpt id=\"p1\">[</bpt>MenuStrip Control Overview<ept id=\"p1\">](menustrip-control-overview-windows-forms.md)</ept>","source":"[MenuStrip Control Overview](menustrip-control-overview-windows-forms.md)"}]}