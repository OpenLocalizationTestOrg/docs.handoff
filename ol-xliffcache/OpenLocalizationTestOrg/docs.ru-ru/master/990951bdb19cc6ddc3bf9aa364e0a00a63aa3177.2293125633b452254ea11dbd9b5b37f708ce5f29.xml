{"content":"---\ntitle: \"Cancel Remaining Async Tasks after One Is Complete (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: c928b5a1-622f-4441-8baf-adca1dde197f\ncaps.latest.revision: 3\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Cancel Remaining Async Tasks after One Is Complete (Visual Basic)\nBy using the <xref:System.Threading.Tasks.Task.WhenAny%2A?displayProperty=fullName> method together with a <xref:System.Threading.CancellationToken>, you can cancel all remaining tasks when one task is complete. The `WhenAny` method takes an argument that’s a collection of tasks. The method starts all the tasks and returns a single task. The single task is complete when any task in the collection is complete.  \n  \n This example demonstrates how to use a cancellation token in conjunction with `WhenAny` to hold onto the first task to finish from the collection of tasks and to cancel the remaining tasks. Each task downloads the contents of a website. The example displays the length of the contents of the first download to complete and cancels the other downloads.  \n  \n> [!NOTE]\n>  To run the examples, you must have Visual Studio 2012 or newer and the .NET Framework 4.5 or newer installed on your computer.  \n  \n## Downloading the Example  \n You can download the complete Windows Presentation Foundation (WPF) project from [Async Sample: Fine Tuning Your Application](http://go.microsoft.com/fwlink/?LinkId=255046) and then follow these steps.  \n  \n1.  Decompress the file that you downloaded, and then start Visual Studio.  \n  \n2.  On the menu bar, choose **File**, **Open**, **Project/Solution**.  \n  \n3.  In the **Open Project** dialog box, open the folder that holds the sample code that you decompressed, and then open the solution (.sln) file for AsyncFineTuningVB.  \n  \n4.  In **Solution Explorer**, open the shortcut menu for the **CancelAfterOneTask** project, and then choose **Set as StartUp Project**.  \n  \n5.  Choose the F5 key to run the project.  \n  \n     Choose the Ctrl+F5 keys to run the project without debugging it.  \n  \n6.  Run the program several times to verify that different downloads finish first.  \n  \n If you don't want to download the project, you can review the MainWindow.xaml.vb file at the end of this topic.  \n  \n## Building the Example  \n The example in this topic adds to the project that's developed in [Cancel an Async Task or a List of Tasks](http://msdn.microsoft.com/library/d6e4e801-df64-4705-98fc-df725a577fb0) to cancel a list of tasks. The example uses the same UI, although the **Cancel** button isn’t used explicitly.  \n  \n To build the example yourself, step by step, follow the instructions in the \"Downloading the Example\" section, but choose **CancelAListOfTasks** as the **StartUp Project**. Add the changes in this topic to that project.  \n  \n In the MainWindow.xaml.vb file of the **CancelAListOfTasks** project, start the transition by moving the processing steps for each website from the loop in `AccessTheWebAsync` to the following async method.  \n  \n```vb  \n' ***Bundle the processing steps for a website into one async method.  \nAsync Function ProcessURLAsync(url As String, client As HttpClient, ct As CancellationToken) As Task(Of Integer)  \n  \n    ' GetAsync returns a Task(Of HttpResponseMessage).   \n    Dim response As HttpResponseMessage = Await client.GetAsync(url, ct)  \n  \n    ' Retrieve the website contents from the HttpResponseMessage.  \n    Dim urlContents As Byte() = Await response.Content.ReadAsByteArrayAsync()  \n  \n    Return urlContents.Length  \nEnd Function  \n```  \n  \n In `AccessTheWebAsync`, this example uses a query, the  <xref:System.Linq.Enumerable.ToArray%2A> method, and the `WhenAny` method to create and start an array of tasks. The application of `WhenAny` to the array returns a single task that, when awaited, evaluates to the first task to reach completion in the array of tasks.  \n  \n Make the following changes in `AccessTheWebAsync`. Asterisks mark the changes in the code file.  \n  \n1.  Comment out or delete the loop.  \n  \n2.  Create a query that, when executed, produces a collection of generic tasks. Each call to `ProcessURLAsync` returns a <xref:System.Threading.Tasks.Task%601> where `TResult` is an integer.  \n  \n    ```vb  \n    ' ***Create a query that, when executed, returns a collection of tasks.  \n    Dim downloadTasksQuery As IEnumerable(Of Task(Of Integer)) =  \n        From url In urlList Select ProcessURLAsync(url, client, ct)  \n    ```  \n  \n3.  Call `ToArray` to execute the query and start the tasks. The application of the `WhenAny` method in the next step would execute the query and start the tasks without using `ToArray`, but other methods might not. The safest practice is to force execution of the query explicitly.  \n  \n    ```vb  \n    ' ***Use ToArray to execute the query and start the download tasks.   \n    Dim downloadTasks As Task(Of Integer)() = downloadTasksQuery.ToArray()  \n    ```  \n  \n4.  Call `WhenAny` on the collection of tasks. `WhenAny` returns a `Task(Of Task(Of Integer))` or `Task<Task<int>>`.  That is, `WhenAny` returns a task that evaluates to a single `Task(Of Integer)` or `Task<int>` when it’s awaited. That single task is the first task in the collection to finish. The task that finished first is assigned to `firstFinishedTask`. The type of `firstFinishedTask` is <xref:System.Threading.Tasks.Task%601> where `TResult` is an integer because that's the return type of `ProcessURLAsync`.  \n  \n```vb  \n' ***Call WhenAny and then await the result. The task that finishes   \n' first is assigned to firstFinishedTask.  \nDim firstFinishedTask As Task(Of Integer) = Await Task.WhenAny(downloadTasks)  \n```  \n  \n5.  In this example, you’re interested only in the task that finishes first. Therefore, use <xref:System.Threading.CancellationTokenSource.Cancel%2A?displayProperty=fullName> to cancel the remaining tasks.  \n  \n```vb  \n' ***Cancel the rest of the downloads. You just want the first one.  \ncts.Cancel()  \n```  \n  \n6.  Finally, await `firstFinishedTask` to retrieve the length of the downloaded content.  \n  \n```vb  \nDim length = Await firstFinishedTask  \nresultsTextBox.Text &= String.Format(vbCrLf & \"Length of the downloaded website:  {0}\" & vbCrLf, length)  \n```  \n  \n Run the program several times to verify that different downloads finish first.  \n  \n## Complete Example  \n The following code is the complete MainWindow.xaml.vb or MainWindow.xaml.cs file for the example. Asterisks mark the elements that were added for this example.  \n  \n Notice that you must add a reference for <xref:System.Net.Http>.  \n  \n You can download the project from [Async Sample: Fine Tuning Your Application](http://go.microsoft.com/fwlink/?LinkId=255046).  \n  \n```vb  \n' Add an Imports directive and a reference for System.Net.Http.  \nImports System.Net.Http  \n  \n' Add the following Imports directive for System.Threading.  \nImports System.Threading  \n  \nClass MainWindow  \n  \n    ' Declare a System.Threading.CancellationTokenSource.  \n    Dim cts As CancellationTokenSource  \n  \n    Private Async Sub startButton_Click(sender As Object, e As RoutedEventArgs)  \n  \n        ' Instantiate the CancellationTokenSource.  \n        cts = New CancellationTokenSource()  \n  \n        resultsTextBox.Clear()  \n  \n        Try  \n            Await AccessTheWebAsync(cts.Token)  \n            resultsTextBox.Text &= vbCrLf & \"Download complete.\"  \n  \n        Catch ex As OperationCanceledException  \n            resultsTextBox.Text &= vbCrLf & \"Download canceled.\" & vbCrLf  \n  \n        Catch ex As Exception  \n            resultsTextBox.Text &= vbCrLf & \"Download failed.\" & vbCrLf  \n        End Try  \n  \n        ' Set the CancellationTokenSource to Nothing when the download is complete.  \n        cts = Nothing  \n    End Sub  \n  \n    ' You can still include a Cancel button if you want to.  \n    Private Sub cancelButton_Click(sender As Object, e As RoutedEventArgs)  \n  \n        If cts IsNot Nothing Then  \n            cts.Cancel()  \n        End If  \n    End Sub  \n  \n    ' Provide a parameter for the CancellationToken.  \n    ' Change the return type to Task because the method has no return statement.  \n    Async Function AccessTheWebAsync(ct As CancellationToken) As Task  \n  \n        Dim client As HttpClient = New HttpClient()  \n  \n        ' Call SetUpURLList to make a list of web addresses.  \n        Dim urlList As List(Of String) = SetUpURLList()  \n  \n        '' Comment out or delete the loop.  \n        ''For Each url In urlList  \n        ''    ' GetAsync returns a Task(Of HttpResponseMessage).   \n        ''    ' Argument ct carries the message if the Cancel button is chosen.   \n        ''    ' Note that the Cancel button can cancel all remaining downloads.  \n        ''    Dim response As HttpResponseMessage = Await client.GetAsync(url, ct)  \n  \n        ''    ' Retrieve the website contents from the HttpResponseMessage.  \n        ''    Dim urlContents As Byte() = Await response.Content.ReadAsByteArrayAsync()  \n  \n        ''    resultsTextBox.Text &=  \n        ''        String.Format(vbCrLf & \"Length of the downloaded string: {0}.\" & vbCrLf, urlContents.Length)  \n        ''Next  \n  \n        ' ***Create a query that, when executed, returns a collection of tasks.  \n        Dim downloadTasksQuery As IEnumerable(Of Task(Of Integer)) =  \n            From url In urlList Select ProcessURLAsync(url, client, ct)  \n  \n        ' ***Use ToArray to execute the query and start the download tasks.   \n        Dim downloadTasks As Task(Of Integer)() = downloadTasksQuery.ToArray()  \n  \n        ' ***Call WhenAny and then await the result. The task that finishes   \n        ' first is assigned to firstFinishedTask.  \n        Dim firstFinishedTask As Task(Of Integer) = Await Task.WhenAny(downloadTasks)  \n  \n        ' ***Cancel the rest of the downloads. You just want the first one.  \n        cts.Cancel()  \n  \n        ' ***Await the first completed task and display the results  \n        ' Run the program several times to demonstrate that different  \n        ' websites can finish first.  \n        Dim length = Await firstFinishedTask  \n        resultsTextBox.Text &= String.Format(vbCrLf & \"Length of the downloaded website:  {0}\" & vbCrLf, length)  \n    End Function  \n  \n    ' ***Bundle the processing steps for a website into one async method.  \n    Async Function ProcessURLAsync(url As String, client As HttpClient, ct As CancellationToken) As Task(Of Integer)  \n  \n        ' GetAsync returns a Task(Of HttpResponseMessage).   \n        Dim response As HttpResponseMessage = Await client.GetAsync(url, ct)  \n  \n        ' Retrieve the website contents from the HttpResponseMessage.  \n        Dim urlContents As Byte() = Await response.Content.ReadAsByteArrayAsync()  \n  \n        Return urlContents.Length  \n    End Function  \n  \n    ' Add a method that creates a list of web addresses.  \n    Private Function SetUpURLList() As List(Of String)  \n  \n        Dim urls = New List(Of String) From  \n            {  \n                \"http://msdn.microsoft.com\",  \n                \"http://msdn.microsoft.com/library/hh290138.aspx\",  \n                \"http://msdn.microsoft.com/library/hh290140.aspx\",  \n                \"http://msdn.microsoft.com/library/dd470362.aspx\",  \n                \"http://msdn.microsoft.com/library/aa578028.aspx\",  \n                \"http://msdn.microsoft.com/library/ms404677.aspx\",  \n                \"http://msdn.microsoft.com/library/ff730837.aspx\"  \n            }  \n        Return urls  \n    End Function  \n  \nEnd Class  \n  \n' Sample output:  \n  \n' Length of the downloaded website:  158856  \n  \n' Download complete.  \n```  \n  \n## See Also  \n <xref:System.Threading.Tasks.Task.WhenAny%2A>   \n [Fine-Tuning Your Async Application (Visual Basic)](../../../../visual-basic/programming-guide/concepts/async/fine-tuning-your-async-application.md)   \n [Asynchronous Programming with Async and Await (Visual Basic)](../../../../visual-basic/programming-guide/concepts/async/index.md)   \n [Async Sample: Fine Tuning Your Application](http://go.microsoft.com/fwlink/?LinkId=255046)","nodes":[{"pos":[4,468],"embed":true,"restype":"x-metadata","content":"title: \"Cancel Remaining Async Tasks after One Is Complete (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: c928b5a1-622f-4441-8baf-adca1dde197f\ncaps.latest.revision: 3\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"","nodes":[{"content":"Cancel Remaining Async Tasks after One Is Complete (Visual Basic) | Microsoft Docs","nodes":[{"pos":[0,82],"content":"Cancel Remaining Async Tasks after One Is Complete (Visual Basic) | Microsoft Docs","nodes":[{"content":"Cancel Remaining Async Tasks after One Is Complete (Visual Basic) | Microsoft Docs","pos":[0,82]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[475,540],"content":"Cancel Remaining Async Tasks after One Is Complete (Visual Basic)","linkify":"Cancel Remaining Async Tasks after One Is Complete (Visual Basic)","nodes":[{"content":"Cancel Remaining Async Tasks after One Is Complete (Visual Basic)","pos":[0,65]}]},{"content":"By using the <ph id=\"ph1\">&lt;xref:System.Threading.Tasks.Task.WhenAny%2A?displayProperty=fullName&gt;</ph> method together with a <ph id=\"ph2\">&lt;xref:System.Threading.CancellationToken&gt;</ph>, you can cancel all remaining tasks when one task is complete.","pos":[541,752],"source":"By using the <xref:System.Threading.Tasks.Task.WhenAny%2A?displayProperty=fullName> method together with a <xref:System.Threading.CancellationToken>, you can cancel all remaining tasks when one task is complete."},{"content":"The <ph id=\"ph1\">`WhenAny`</ph> method takes an argument that’s a collection of tasks.","pos":[753,821],"source":" The `WhenAny` method takes an argument that’s a collection of tasks."},{"content":"The method starts all the tasks and returns a single task.","pos":[822,880]},{"content":"The single task is complete when any task in the collection is complete.","pos":[881,953]},{"content":"This example demonstrates how to use a cancellation token in conjunction with <ph id=\"ph1\">`WhenAny`</ph> to hold onto the first task to finish from the collection of tasks and to cancel the remaining tasks.","pos":[960,1149],"source":"This example demonstrates how to use a cancellation token in conjunction with `WhenAny` to hold onto the first task to finish from the collection of tasks and to cancel the remaining tasks."},{"content":"Each task downloads the contents of a website.","pos":[1150,1196]},{"content":"The example displays the length of the contents of the first download to complete and cancels the other downloads.","pos":[1197,1311]},{"pos":[1319,1456],"content":"[!NOTE]\n To run the examples, you must have Visual Studio 2012 or newer and the .NET Framework 4.5 or newer installed on your computer.","leadings":["","> "],"nodes":[{"content":"To run the examples, you must have Visual Studio 2012 or newer and the .NET Framework 4.5 or newer installed on your computer.","pos":[9,135]}]},{"pos":[1465,1488],"content":"Downloading the Example","linkify":"Downloading the Example","nodes":[{"content":"Downloading the Example","pos":[0,23]}]},{"pos":[1492,1693],"content":"You can download the complete Windows Presentation Foundation (WPF) project from <bpt id=\"p1\">[</bpt>Async Sample: Fine Tuning Your Application<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=255046)</ept> and then follow these steps.","source":"You can download the complete Windows Presentation Foundation (WPF) project from [Async Sample: Fine Tuning Your Application](http://go.microsoft.com/fwlink/?LinkId=255046) and then follow these steps."},{"content":"Decompress the file that you downloaded, and then start Visual Studio.","pos":[1703,1773]},{"pos":[1783,1848],"content":"On the menu bar, choose <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Project/Solution<ept id=\"p3\">**</ept>.","source":"On the menu bar, choose **File**, **Open**, **Project/Solution**."},{"pos":[1858,2021],"content":"In the <bpt id=\"p1\">**</bpt>Open Project<ept id=\"p1\">**</ept> dialog box, open the folder that holds the sample code that you decompressed, and then open the solution (.sln) file for AsyncFineTuningVB.","source":"In the **Open Project** dialog box, open the folder that holds the sample code that you decompressed, and then open the solution (.sln) file for AsyncFineTuningVB."},{"pos":[2031,2163],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, open the shortcut menu for the <bpt id=\"p2\">**</bpt>CancelAfterOneTask<ept id=\"p2\">**</ept> project, and then choose <bpt id=\"p3\">**</bpt>Set as StartUp Project<ept id=\"p3\">**</ept>.","source":"In **Solution Explorer**, open the shortcut menu for the **CancelAfterOneTask** project, and then choose **Set as StartUp Project**."},{"content":"Choose the F5 key to run the project.","pos":[2173,2210]},{"content":"Choose the Ctrl+F5 keys to run the project without debugging it.","pos":[2221,2285]},{"content":"Run the program several times to verify that different downloads finish first.","pos":[2295,2373]},{"content":"If you don't want to download the project, you can review the MainWindow.xaml.vb file at the end of this topic.","pos":[2380,2491]},{"pos":[2500,2520],"content":"Building the Example","linkify":"Building the Example","nodes":[{"content":"Building the Example","pos":[0,20]}]},{"content":"The example in this topic adds to the project that's developed in <bpt id=\"p1\">[</bpt>Cancel an Async Task or a List of Tasks<ept id=\"p1\">](http://msdn.microsoft.com/library/d6e4e801-df64-4705-98fc-df725a577fb0)</ept> to cancel a list of tasks.","pos":[2524,2730],"source":"The example in this topic adds to the project that's developed in [Cancel an Async Task or a List of Tasks](http://msdn.microsoft.com/library/d6e4e801-df64-4705-98fc-df725a577fb0) to cancel a list of tasks."},{"content":"The example uses the same UI, although the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button isn’t used explicitly.","pos":[2731,2814],"source":" The example uses the same UI, although the **Cancel** button isn’t used explicitly."},{"content":"To build the example yourself, step by step, follow the instructions in the \"Downloading the Example\" section, but choose <bpt id=\"p1\">**</bpt>CancelAListOfTasks<ept id=\"p1\">**</ept> as the <bpt id=\"p2\">**</bpt>StartUp Project<ept id=\"p2\">**</ept>.","pos":[2821,2993],"source":"To build the example yourself, step by step, follow the instructions in the \"Downloading the Example\" section, but choose **CancelAListOfTasks** as the **StartUp Project**."},{"content":"Add the changes in this topic to that project.","pos":[2994,3040]},{"pos":[3047,3253],"content":"In the MainWindow.xaml.vb file of the <bpt id=\"p1\">**</bpt>CancelAListOfTasks<ept id=\"p1\">**</ept> project, start the transition by moving the processing steps for each website from the loop in <ph id=\"ph1\">`AccessTheWebAsync`</ph> to the following async method.","source":"In the MainWindow.xaml.vb file of the **CancelAListOfTasks** project, start the transition by moving the processing steps for each website from the loop in `AccessTheWebAsync` to the following async method."},{"content":"In <ph id=\"ph1\">`AccessTheWebAsync`</ph>, this example uses a query, the  <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.ToArray%2A&gt;</ph> method, and the <ph id=\"ph3\">`WhenAny`</ph> method to create and start an array of tasks.","pos":[3801,3969],"source":"In `AccessTheWebAsync`, this example uses a query, the  <xref:System.Linq.Enumerable.ToArray%2A> method, and the `WhenAny` method to create and start an array of tasks."},{"content":"The application of <ph id=\"ph1\">`WhenAny`</ph> to the array returns a single task that, when awaited, evaluates to the first task to reach completion in the array of tasks.","pos":[3970,4124],"source":" The application of `WhenAny` to the array returns a single task that, when awaited, evaluates to the first task to reach completion in the array of tasks."},{"content":"Make the following changes in <ph id=\"ph1\">`AccessTheWebAsync`</ph>.","pos":[4131,4181],"source":"Make the following changes in `AccessTheWebAsync`."},{"content":"Asterisks mark the changes in the code file.","pos":[4182,4226]},{"content":"Comment out or delete the loop.","pos":[4236,4267]},{"content":"Create a query that, when executed, produces a collection of generic tasks.","pos":[4277,4352]},{"content":"Each call to <ph id=\"ph1\">`ProcessURLAsync`</ph> returns a <ph id=\"ph2\">&lt;xref:System.Threading.Tasks.Task%601&gt;</ph> where <ph id=\"ph3\">`TResult`</ph> is an integer.","pos":[4353,4463],"source":" Each call to `ProcessURLAsync` returns a <xref:System.Threading.Tasks.Task%601> where `TResult` is an integer."},{"content":"Call <ph id=\"ph1\">`ToArray`</ph> to execute the query and start the tasks.","pos":[4713,4769],"source":"Call `ToArray` to execute the query and start the tasks."},{"content":"The application of the <ph id=\"ph1\">`WhenAny`</ph> method in the next step would execute the query and start the tasks without using <ph id=\"ph2\">`ToArray`</ph>, but other methods might not.","pos":[4770,4924],"source":" The application of the `WhenAny` method in the next step would execute the query and start the tasks without using `ToArray`, but other methods might not."},{"content":"The safest practice is to force execution of the query explicitly.","pos":[4925,4991]},{"content":"Call <ph id=\"ph1\">`WhenAny`</ph> on the collection of tasks.","pos":[5178,5220],"source":"Call `WhenAny` on the collection of tasks."},{"content":"<ph id=\"ph1\">`WhenAny`</ph> returns a <ph id=\"ph2\">`Task(Of Task(Of Integer))`</ph> or <ph id=\"ph3\">`Task&lt;Task&lt;int&gt;&gt;`</ph>.","pos":[5221,5290],"source":"`WhenAny` returns a `Task(Of Task(Of Integer))` or `Task<Task<int>>`."},{"content":"That is, <ph id=\"ph1\">`WhenAny`</ph> returns a task that evaluates to a single <ph id=\"ph2\">`Task(Of Integer)`</ph> or <ph id=\"ph3\">`Task&lt;int&gt;`</ph> when it’s awaited.","pos":[5292,5405],"source":"  That is, `WhenAny` returns a task that evaluates to a single `Task(Of Integer)` or `Task<int>` when it’s awaited."},{"content":"That single task is the first task in the collection to finish.","pos":[5406,5469]},{"content":"The task that finished first is assigned to <ph id=\"ph1\">`firstFinishedTask`</ph>.","pos":[5470,5534],"source":" The task that finished first is assigned to `firstFinishedTask`."},{"content":"The type of <ph id=\"ph1\">`firstFinishedTask`</ph> is <ph id=\"ph2\">&lt;xref:System.Threading.Tasks.Task%601&gt;</ph> where <ph id=\"ph3\">`TResult`</ph> is an integer because that's the return type of <ph id=\"ph4\">`ProcessURLAsync`</ph>.","pos":[5535,5691],"source":" The type of `firstFinishedTask` is <xref:System.Threading.Tasks.Task%601> where `TResult` is an integer because that's the return type of `ProcessURLAsync`."},{"content":"In this example, you’re interested only in the task that finishes first.","pos":[5913,5985]},{"content":"Therefore, use <ph id=\"ph1\">&lt;xref:System.Threading.CancellationTokenSource.Cancel%2A?displayProperty=fullName&gt;</ph> to cancel the remaining tasks.","pos":[5986,6114],"source":" Therefore, use <xref:System.Threading.CancellationTokenSource.Cancel%2A?displayProperty=fullName> to cancel the remaining tasks."},{"pos":[6226,6310],"content":"Finally, await <ph id=\"ph1\">`firstFinishedTask`</ph> to retrieve the length of the downloaded content.","source":"Finally, await `firstFinishedTask` to retrieve the length of the downloaded content."},{"content":"Run the program several times to verify that different downloads finish first.","pos":[6480,6558]},{"pos":[6567,6583],"content":"Complete Example","linkify":"Complete Example","nodes":[{"content":"Complete Example","pos":[0,16]}]},{"content":"The following code is the complete MainWindow.xaml.vb or MainWindow.xaml.cs file for the example.","pos":[6587,6684]},{"content":"Asterisks mark the elements that were added for this example.","pos":[6685,6746]},{"pos":[6753,6817],"content":"Notice that you must add a reference for <ph id=\"ph1\">&lt;xref:System.Net.Http&gt;</ph>.","source":"Notice that you must add a reference for <xref:System.Net.Http>."},{"pos":[6824,6950],"content":"You can download the project from <bpt id=\"p1\">[</bpt>Async Sample: Fine Tuning Your Application<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=255046)</ept>.","source":"You can download the project from [Async Sample: Fine Tuning Your Application](http://go.microsoft.com/fwlink/?LinkId=255046)."},{"pos":[11858,11866],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Fine-Tuning Your Async Application (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/async/fine-tuning-your-async-application.md)</ept><ph id=\"ph1\"> </ph>","pos":[11920,12069],"source":"[Fine-Tuning Your Async Application (Visual Basic)](../../../../visual-basic/programming-guide/concepts/async/fine-tuning-your-async-application.md) "},{"content":"<bpt id=\"p1\">[</bpt>Asynchronous Programming with Async and Await (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/async/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[12073,12204],"source":"[Asynchronous Programming with Async and Await (Visual Basic)](../../../../visual-basic/programming-guide/concepts/async/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>Async Sample: Fine Tuning Your Application<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=255046)</ept>","pos":[12208,12299],"source":"[Async Sample: Fine Tuning Your Application](http://go.microsoft.com/fwlink/?LinkId=255046)"}]}