{"content":"---\ntitle: \"How to: Generate Primary Interop Assemblies Using Tlbimp.exe\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"primary interop assemblies, generating\"\n  - \"Tlbimp.exe\"\n  - \"Type Library Importer\"\nms.assetid: 5419011c-6e57-40f6-8c65-386db8f7a651\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# How to: Generate Primary Interop Assemblies Using Tlbimp.exe\nThere are two ways to generate a primary interop assembly:  \n  \n-   Using the [Type Library Importer (Tlbimp.exe)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md) provided by the [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)].  \n  \n     The most straightforward way to produce primary interop assemblies is to use the [Tlbimp.exe (Type Library Importer)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md). Tlbimp.exe provides the following safeguards:  \n  \n    -   Checks for other registered primary interop assemblies before creating new interop assemblies for any nested type library references.  \n  \n    -   Fails to emit the primary interop assembly if you do not specify either the container or file name to give the primary interop assembly a strong name.  \n  \n    -   Fails to emit a primary interop assembly if you omit references to dependent assemblies.  \n  \n    -   Fails to emit a primary interop assembly if you add references to dependent assemblies that are not primary interop assemblies.  \n  \n-   Creating primary interop assemblies manually in source code by using a language that is compliant with the Common Language Specification (CLS), such as C#. This approach is useful when a type library is unavailable.  \n  \n You must have a cryptographic key pair to sign the assembly with a strong name. For details, see [Creating A Key Pair](../../../docs/framework/app-domains/how-to-create-a-public-private-key-pair.md).  \n  \n### To generate a primary interop assembly using Tlbimp.exe  \n  \n1.  At the command prompt, type:  \n  \n     **tlbimp** *tlbfile*  **/primary /keyfile:** *filename* **/out:** *assemblyname*  \n  \n     In this command, *tlbfile* is the file containing the COM type library, *filename* is the name of the container or file that contains the key pair, and *assemblyname* is the name of the assembly to sign with a strong name.  \n  \n Primary interop assemblies can reference only other primary interop assemblies. If your assembly references types from a third-party COM type library, you must obtain a primary interop assembly from the publisher before you can generate your primary interop assembly. If you are the publisher, you must generate a primary interop assembly for the dependent type library before generating the referencing primary interop assembly.  \n  \n A dependent primary interop assembly with a version number that differs from that of the original type library is not discoverable when installed in the current directory. You must either register the dependent primary interop assembly in the Windows registry or use the **/reference** option to be sure that Tlbimp.exe finds the dependent DLL.  \n  \n You can also wrap multiple versions of a type library. For instructions, see [How to: Wrap Multiple Versions of Type Libraries](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1565h6hc(v=vs.100)).  \n  \n## Example  \n The following example imports the COM type library `LibUtil.tlb` and signs the assembly `LibUtil.dll` with a strong name using the key file `CompanyA.snk`. By omitting a specific namespace name, this example produces the default namespace, `LibUtil`.  \n  \n```  \ntlbimp LibUtil.tlb /primary /keyfile:CompanyA.snk /out:LibUtil.dll  \n```  \n  \n For a more descriptive name (using the *VendorName*.*LibraryName* naming guideline), the following example overrides the default assembly file name and namespace name.  \n  \n```  \ntlbimp LibUtil.tlb /primary /keyfile:CompanyA.snk /namespace:CompanyA.LibUtil /out:CompanyA.LibUtil.dll  \n```  \n  \n The following example imports `MyLib.tlb`, which references `CompanyA.LibUtil.dll`, and signs the assembly `CompanyB.MyLib.dll` with a strong name using the key file `CompanyB.snk`. The namespace, `CompanyB.MyLib`, overrides the default namespace name.  \n  \n```  \ntlbimp MyLib.tlb /primary /keyfile:CompanyB.snk /namespace:CompanyB.MyLib /reference:CompanyA.LibUtil.dll /out:CompanyB.MyLib.dll  \n```  \n  \n## See also\n\n- [How to: Register Primary Interop Assemblies](../../../docs/framework/interop/how-to-register-primary-interop-assemblies.md)\n","nodes":[{"pos":[4,296],"embed":true,"restype":"x-metadata","content":"title: \"How to: Generate Primary Interop Assemblies Using Tlbimp.exe\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"primary interop assemblies, generating\"\n  - \"Tlbimp.exe\"\n  - \"Type Library Importer\"\nms.assetid: 5419011c-6e57-40f6-8c65-386db8f7a651\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"How to: Generate Primary Interop Assemblies Using Tlbimp.exe","nodes":[{"pos":[0,60],"content":"How to: Generate Primary Interop Assemblies Using Tlbimp.exe","nodes":[{"content":"How to: Generate Primary Interop Assemblies Using Tlbimp.exe","pos":[0,60]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[303,363],"content":"How to: Generate Primary Interop Assemblies Using Tlbimp.exe","linkify":"How to: Generate Primary Interop Assemblies Using Tlbimp.exe","nodes":[{"content":"How to: Generate Primary Interop Assemblies Using Tlbimp.exe","pos":[0,60]}]},{"content":"There are two ways to generate a primary interop assembly:","pos":[364,422]},{"pos":[432,621],"content":"Using the <bpt id=\"p1\">[</bpt>Type Library Importer (Tlbimp.exe)<ept id=\"p1\">](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)</ept> provided by the <ph id=\"ph1\">[!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)]</ph>.","source":"Using the [Type Library Importer (Tlbimp.exe)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md) provided by the [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)]."},{"content":"The most straightforward way to produce primary interop assemblies is to use the <bpt id=\"p1\">[</bpt>Tlbimp.exe (Type Library Importer)<ept id=\"p1\">](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)</ept>.","pos":[632,817],"source":"The most straightforward way to produce primary interop assemblies is to use the [Tlbimp.exe (Type Library Importer)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)."},{"content":"Tlbimp.exe provides the following safeguards:","pos":[818,863]},{"content":"Checks for other registered primary interop assemblies before creating new interop assemblies for any nested type library references.","pos":[877,1010]},{"content":"Fails to emit the primary interop assembly if you do not specify either the container or file name to give the primary interop assembly a strong name.","pos":[1024,1174]},{"content":"Fails to emit a primary interop assembly if you omit references to dependent assemblies.","pos":[1188,1276]},{"content":"Fails to emit a primary interop assembly if you add references to dependent assemblies that are not primary interop assemblies.","pos":[1290,1417]},{"content":"Creating primary interop assemblies manually in source code by using a language that is compliant with the Common Language Specification (CLS), such as C#.","pos":[1427,1582]},{"content":"This approach is useful when a type library is unavailable.","pos":[1583,1642]},{"content":"You must have a cryptographic key pair to sign the assembly with a strong name.","pos":[1649,1728]},{"content":"For details, see <bpt id=\"p1\">[</bpt>Creating A Key Pair<ept id=\"p1\">](../../../docs/framework/app-domains/how-to-create-a-public-private-key-pair.md)</ept>.","pos":[1729,1848],"source":" For details, see [Creating A Key Pair](../../../docs/framework/app-domains/how-to-create-a-public-private-key-pair.md)."},{"pos":[1858,1913],"content":"To generate a primary interop assembly using Tlbimp.exe","linkify":"To generate a primary interop assembly using Tlbimp.exe","nodes":[{"content":"To generate a primary interop assembly using Tlbimp.exe","pos":[0,55]}]},{"content":"At the command prompt, type:","pos":[1923,1951]},{"pos":[1962,2042],"content":"<bpt id=\"p1\">**</bpt>tlbimp<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>tlbfile<ept id=\"p2\">*</ept>  <bpt id=\"p3\">**</bpt>/primary /keyfile:<ept id=\"p3\">**</ept> <bpt id=\"p4\">*</bpt>filename<ept id=\"p4\">*</ept> <bpt id=\"p5\">**</bpt>/out:<ept id=\"p5\">**</ept> <bpt id=\"p6\">*</bpt>assemblyname<ept id=\"p6\">*</ept>","source":"**tlbimp** *tlbfile*  **/primary /keyfile:** *filename* **/out:** *assemblyname*"},{"pos":[2053,2275],"content":"In this command, <bpt id=\"p1\">*</bpt>tlbfile<ept id=\"p1\">*</ept> is the file containing the COM type library, <bpt id=\"p2\">*</bpt>filename<ept id=\"p2\">*</ept> is the name of the container or file that contains the key pair, and <bpt id=\"p3\">*</bpt>assemblyname<ept id=\"p3\">*</ept> is the name of the assembly to sign with a strong name.","source":"In this command, *tlbfile* is the file containing the COM type library, *filename* is the name of the container or file that contains the key pair, and *assemblyname* is the name of the assembly to sign with a strong name."},{"content":"Primary interop assemblies can reference only other primary interop assemblies.","pos":[2282,2361]},{"content":"If your assembly references types from a third-party COM type library, you must obtain a primary interop assembly from the publisher before you can generate your primary interop assembly.","pos":[2362,2549]},{"content":"If you are the publisher, you must generate a primary interop assembly for the dependent type library before generating the referencing primary interop assembly.","pos":[2550,2711]},{"content":"A dependent primary interop assembly with a version number that differs from that of the original type library is not discoverable when installed in the current directory.","pos":[2718,2889]},{"content":"You must either register the dependent primary interop assembly in the Windows registry or use the <bpt id=\"p1\">**</bpt>/reference<ept id=\"p1\">**</ept> option to be sure that Tlbimp.exe finds the dependent DLL.","pos":[2890,3062],"source":" You must either register the dependent primary interop assembly in the Windows registry or use the **/reference** option to be sure that Tlbimp.exe finds the dependent DLL."},{"content":"You can also wrap multiple versions of a type library.","pos":[3069,3123]},{"content":"For instructions, see <bpt id=\"p1\">[</bpt>How to: Wrap Multiple Versions of Type Libraries<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1565h6hc(v=vs.100))</ept>.","pos":[3124,3286],"source":" For instructions, see [How to: Wrap Multiple Versions of Type Libraries](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1565h6hc(v=vs.100))."},{"pos":[3295,3302],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example imports the COM type library <ph id=\"ph1\">`LibUtil.tlb`</ph> and signs the assembly <ph id=\"ph2\">`LibUtil.dll`</ph> with a strong name using the key file <ph id=\"ph3\">`CompanyA.snk`</ph>.","pos":[3306,3461],"source":"The following example imports the COM type library `LibUtil.tlb` and signs the assembly `LibUtil.dll` with a strong name using the key file `CompanyA.snk`."},{"content":"By omitting a specific namespace name, this example produces the default namespace, <ph id=\"ph1\">`LibUtil`</ph>.","pos":[3462,3556],"source":" By omitting a specific namespace name, this example produces the default namespace, `LibUtil`."},{"pos":[3647,3814],"content":"For a more descriptive name (using the <bpt id=\"p1\">*</bpt>VendorName<ept id=\"p1\">*</ept>.<bpt id=\"p2\">*</bpt>LibraryName<ept id=\"p2\">*</ept> naming guideline), the following example overrides the default assembly file name and namespace name.","source":"For a more descriptive name (using the *VendorName*.*LibraryName* naming guideline), the following example overrides the default assembly file name and namespace name."},{"content":"The following example imports <ph id=\"ph1\">`MyLib.tlb`</ph>, which references <ph id=\"ph2\">`CompanyA.LibUtil.dll`</ph>, and signs the assembly <ph id=\"ph3\">`CompanyB.MyLib.dll`</ph> with a strong name using the key file <ph id=\"ph4\">`CompanyB.snk`</ph>.","pos":[3942,4123],"source":"The following example imports `MyLib.tlb`, which references `CompanyA.LibUtil.dll`, and signs the assembly `CompanyB.MyLib.dll` with a strong name using the key file `CompanyB.snk`."},{"content":"The namespace, <ph id=\"ph1\">`CompanyB.MyLib`</ph>, overrides the default namespace name.","pos":[4124,4194],"source":" The namespace, `CompanyB.MyLib`, overrides the default namespace name."},{"pos":[4350,4358],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4362,4486],"content":"<bpt id=\"p1\">[</bpt>How to: Register Primary Interop Assemblies<ept id=\"p1\">](../../../docs/framework/interop/how-to-register-primary-interop-assemblies.md)</ept>","source":"[How to: Register Primary Interop Assemblies](../../../docs/framework/interop/how-to-register-primary-interop-assemblies.md)"}]}