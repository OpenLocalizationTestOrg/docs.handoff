{"content":"---\ntitle: \"Interop with 3.5 Rule Set | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 969f3295-d874-428c-a9c6-623e3d578e51\ncaps.latest.revision: 7\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Interop with 3.5 Rule Set\nThis sample demonstrates the use of the <xref:System.Activities.Statements.Interop> activity to integrate with a custom activity in [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)] using <!--zz <xref:System.Workflow.Activities.Policy> --> `System.Workflow.Activities.Policy` and rules. It passes data to the custom activity by binding [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] variables to the dependency properties exposed by the custom activity.  \n  \n## Requirements  \n  \n1.  [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)]  \n  \n2.  [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)]  \n  \n3.  [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)]  \n  \n## Demonstrates  \n <xref:System.Activities.Statements.Interop> activity, <!--zz <xref:System.Workflow.Activities.Policy> --> `System.Workflow.Activities.Policy` activity in [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)] with dependency properties  \n  \n## Discussion  \n The sample demonstrates one of the integration scenarios for integrating with a [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)] activity. This sample includes a [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)] custom activity that invokes a <!--zz <xref:System.Workflow.Activities.Policy> --> `System.Workflow.Activities.Policy` activity.  \n  \n## TravelRuleLibrary  \n Opening TravelRuleSet.cs in the designer shows a custom sequential activity that contains a Policy activity as follows  \n  \n ![Interop Activity](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulespolicy.jpg \"InteropRulesPolicy\")  \n  \n Double-click the **DiscountPolicy** policy activity to examine the rules. The Rules editor appears to show the rules.  \n  \n ![Rule Set Editor](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulesruleseteditor.jpg \"InteropRulesRuleSetEditor\")  \n  \n Right-click the **DiscountPolicy** activity and select the **View Code** option to examine the code-beside C# code that goes with this activity. Observe the dependency property setting for `DiscountLevel`. This is equivalent to an <xref:System.Activities.Argument> in [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)].  \n  \n```  \npublic static DependencyProperty DiscountLevelProperty = DependencyProperty.Register(\"DiscountLevel\", typeof(int), typeof(TravelRuleSet));  \n  \n[DescriptionAttribute(\"DiscountLevel\")]  \n[CategoryAttribute(\"DiscountLevel Category\")]  \n[BrowsableAttribute(true)]  \n[DesignerSerializationVisibilityAttribute(DesignerSerializationVisibility.Visible)]  \npublic int DiscountLevel  \n{  \n   get  \n   {  \nreturn ((int)base.GetValue(TravelRuleSet.DiscountLevelProperty)));  \n   }  \n   set  \n   {  \nbase.SetValue(TravelRuleSet.DiscountLevelProperty, value);  \n   }  \n}  \n```  \n  \n## InteropWith35RuleSet  \n This is a [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)] sequential workflow project that uses the <xref:System.Activities.Statements.Interop> activity to integrate with the custom rule set created in the TravelRuleLibrary project. Variables are created on the top-level <xref:System.Activities.Statements.Sequence> as follows.  \n  \n ![Variables](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulesvariables.jpg \"InteropRulesVariables\")  \n  \n ![Solution Explorer](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulessolutionexplorer.jpg \"InteropRulesSolutionExplorer\")  \n  \n Lastly, the <xref:System.Activities.Statements.Interop> activity is used to integrate with the TravelRuleSet. The variables that were declared earlier on the <xref:System.Activities.Statements.Sequence> are used to bind to the dependency properties.  \n  \n ![Activity Type](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprules.jpg \"InteropRules\")  \n  \n ![Arrow](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulesarrow.jpg \"InteropRulesArrow\")  \n  \n ![Properties](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulesproperties.jpg \"InteropRulesProperties\")  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\Built-InActivities\\InteropWith35RuleSet`","nodes":[{"pos":[4,312],"embed":true,"restype":"x-metadata","content":"title: \"Interop with 3.5 Rule Set | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 969f3295-d874-428c-a9c6-623e3d578e51\ncaps.latest.revision: 7\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","nodes":[{"content":"Interop with 3.5 Rule Set | Microsoft Docs","nodes":[{"pos":[0,42],"content":"Interop with 3.5 Rule Set | Microsoft Docs","nodes":[{"content":"Interop with 3.5 Rule Set | Microsoft Docs","pos":[0,42]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[319,344],"content":"Interop with 3.5 Rule Set","linkify":"Interop with 3.5 Rule Set","nodes":[{"content":"Interop with 3.5 Rule Set","pos":[0,25]}]},{"content":"This sample demonstrates the use of the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity to integrate with a custom activity in <ph id=\"ph2\">[!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)]</ph> using","pos":[345,550],"source":"This sample demonstrates the use of the <xref:System.Activities.Statements.Interop> activity to integrate with a custom activity in [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)] using "},{"content":"<ph id=\"ph1\">`System.Workflow.Activities.Policy`</ph> and rules.","pos":[603,649],"source":"`System.Workflow.Activities.Policy` and rules."},{"content":"It passes data to the custom activity by binding <ph id=\"ph1\">[!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)]</ph> variables to the dependency properties exposed by the custom activity.","pos":[650,847],"source":" It passes data to the custom activity by binding [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] variables to the dependency properties exposed by the custom activity."},{"pos":[856,868],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[1120,1132],"content":"Demonstrates","linkify":"Demonstrates","nodes":[{"content":"Demonstrates","pos":[0,12]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity,","pos":[1136,1189],"source":"<xref:System.Activities.Statements.Interop> activity, "},{"content":"<ph id=\"ph1\">`System.Workflow.Activities.Policy`</ph> activity in <ph id=\"ph2\">[!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)]</ph> with dependency properties","pos":[1242,1384],"source":"`System.Workflow.Activities.Policy` activity in [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)] with dependency properties"},{"pos":[1393,1403],"content":"Discussion","linkify":"Discussion","nodes":[{"content":"Discussion","pos":[0,10]}]},{"content":"The sample demonstrates one of the integration scenarios for integrating with a <ph id=\"ph1\">[!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)]</ph> activity.","pos":[1407,1564],"source":"The sample demonstrates one of the integration scenarios for integrating with a [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)] activity."},{"content":"This sample includes a <ph id=\"ph1\">[!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)]</ph> custom activity that invokes a","pos":[1565,1686],"source":" This sample includes a [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)] custom activity that invokes a "},{"content":"<ph id=\"ph1\">`System.Workflow.Activities.Policy`</ph> activity.","pos":[1739,1784],"source":"`System.Workflow.Activities.Policy` activity."},{"pos":[1793,1810],"content":"TravelRuleLibrary","linkify":"TravelRuleLibrary","nodes":[{"content":"TravelRuleLibrary","pos":[0,17]}]},{"content":"Opening TravelRuleSet.cs in the designer shows a custom sequential activity that contains a Policy activity as follows","pos":[1814,1932]},{"pos":[1939,2072],"content":"<bpt id=\"p1\">![</bpt>Interop Activity<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulespolicy.jpg \"</bpt>InteropRulesPolicy<ept id=\"p2\">\")</ept>","source":"![Interop Activity](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulespolicy.jpg \"InteropRulesPolicy\")"},{"content":"Double-click the <bpt id=\"p1\">**</bpt>DiscountPolicy<ept id=\"p1\">**</ept> policy activity to examine the rules.","pos":[2079,2152],"source":"Double-click the **DiscountPolicy** policy activity to examine the rules."},{"content":"The Rules editor appears to show the rules.","pos":[2153,2196]},{"pos":[2203,2349],"content":"<bpt id=\"p1\">![</bpt>Rule Set Editor<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulesruleseteditor.jpg \"</bpt>InteropRulesRuleSetEditor<ept id=\"p2\">\")</ept>","source":"![Rule Set Editor](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulesruleseteditor.jpg \"InteropRulesRuleSetEditor\")"},{"content":"Right-click the <bpt id=\"p1\">**</bpt>DiscountPolicy<ept id=\"p1\">**</ept> activity and select the <bpt id=\"p2\">**</bpt>View Code<ept id=\"p2\">**</ept> option to examine the code-beside C# code that goes with this activity.","pos":[2356,2500],"source":"Right-click the **DiscountPolicy** activity and select the **View Code** option to examine the code-beside C# code that goes with this activity."},{"content":"Observe the dependency property setting for <ph id=\"ph1\">`DiscountLevel`</ph>.","pos":[2501,2561],"source":" Observe the dependency property setting for `DiscountLevel`."},{"content":"This is equivalent to an <ph id=\"ph1\">&lt;xref:System.Activities.Argument&gt;</ph> in <ph id=\"ph2\">[!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)]</ph>.","pos":[2562,2704],"source":" This is equivalent to an <xref:System.Activities.Argument> in [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)]."},{"pos":[3288,3308],"content":"InteropWith35RuleSet","linkify":"InteropWith35RuleSet","nodes":[{"content":"InteropWith35RuleSet","pos":[0,20]}]},{"content":"This is a <ph id=\"ph1\">[!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)]</ph> sequential workflow project that uses the <ph id=\"ph2\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity to integrate with the custom rule set created in the TravelRuleLibrary project.","pos":[3312,3576],"source":"This is a [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)] sequential workflow project that uses the <xref:System.Activities.Statements.Interop> activity to integrate with the custom rule set created in the TravelRuleLibrary project."},{"content":"Variables are created on the top-level <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Sequence&gt;</ph> as follows.","pos":[3577,3672],"source":" Variables are created on the top-level <xref:System.Activities.Statements.Sequence> as follows."},{"pos":[3679,3811],"content":"<bpt id=\"p1\">![</bpt>Variables<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulesvariables.jpg \"</bpt>InteropRulesVariables<ept id=\"p2\">\")</ept>","source":"![Variables](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulesvariables.jpg \"InteropRulesVariables\")"},{"pos":[3818,3972],"content":"<bpt id=\"p1\">![</bpt>Solution Explorer<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulessolutionexplorer.jpg \"</bpt>InteropRulesSolutionExplorer<ept id=\"p2\">\")</ept>","source":"![Solution Explorer](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulessolutionexplorer.jpg \"InteropRulesSolutionExplorer\")"},{"content":"Lastly, the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity is used to integrate with the TravelRuleSet.","pos":[3979,4088],"source":"Lastly, the <xref:System.Activities.Statements.Interop> activity is used to integrate with the TravelRuleSet."},{"content":"The variables that were declared earlier on the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Sequence&gt;</ph> are used to bind to the dependency properties.","pos":[4089,4228],"source":" The variables that were declared earlier on the <xref:System.Activities.Statements.Sequence> are used to bind to the dependency properties."},{"pos":[4235,4353],"content":"<bpt id=\"p1\">![</bpt>Activity Type<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/windows-workflow-foundation/samples/media/interoprules.jpg \"</bpt>InteropRules<ept id=\"p2\">\")</ept>","source":"![Activity Type](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprules.jpg \"InteropRules\")"},{"pos":[4360,4480],"content":"<bpt id=\"p1\">![</bpt>Arrow<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulesarrow.jpg \"</bpt>InteropRulesArrow<ept id=\"p2\">\")</ept>","source":"![Arrow](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulesarrow.jpg \"InteropRulesArrow\")"},{"pos":[4487,4622],"content":"<bpt id=\"p1\">![</bpt>Properties<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulesproperties.jpg \"</bpt>InteropRulesProperties<ept id=\"p2\">\")</ept>","source":"![Properties](../../../../docs/framework/windows-workflow-foundation/samples/media/interoprulesproperties.jpg \"InteropRulesProperties\")"},{"pos":[4630,4762],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[14,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[4816,5142],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[5143,5193]}]}