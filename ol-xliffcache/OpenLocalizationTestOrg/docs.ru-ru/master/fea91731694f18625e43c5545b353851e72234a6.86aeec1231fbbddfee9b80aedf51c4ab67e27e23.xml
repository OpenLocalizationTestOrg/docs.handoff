{"content":"---\ntitle: \"Yield Statement (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.Yield\"\nhelpviewer_keywords: \n  - \"iterators, Yield statement [Visual Basic]\"\n  - \"iterators [Visual Basic]\"\n  - \"Yield statement [Visual Basic]\"\nms.assetid: f33126c5-d7c4-43e2-8e36-4ae3f0703d97\n---\n# Yield Statement (Visual Basic)\nSends the next element of a collection to a `For Each...Next` statement.  \n  \n## Syntax  \n  \n```  \nYield expression  \n```  \n  \n## Parameters  \n  \n|Term|Definition|  \n|---|---|  \n|`expression`|Required. An expression that is implicitly convertible to the type of the iterator function or `Get` accessor that contains the `Yield` statement.|  \n  \n## Remarks  \n The `Yield` statement returns one element of a collection at a time. The `Yield` statement is included in an iterator function or `Get` accessor, which perform custom iterations over a collection.  \n  \n You consume an iterator function by using a [For Each...Next Statement](../../../visual-basic/language-reference/statements/for-each-next-statement.md) or a LINQ query. Each iteration of the `For Each` loop calls the iterator function. When a `Yield` statement is reached in the iterator function, `expression` is returned, and the current location in code is retained. Execution is restarted from that location the next time that the iterator function is called.  \n  \n An implicit conversion must exist from the type of `expression` in the `Yield` statement to the return type of the iterator.  \n  \n You can use an `Exit Function` or `Return` statement to end the iteration.  \n  \n \"Yield\" is not a reserved word and has special meaning only when it is used in an `Iterator` function or `Get` accessor.  \n  \n For more information about iterator functions and `Get` accessors, see [Iterators](../../programming-guide/concepts/iterators.md).  \n  \n## Iterator Functions and Get Accessors  \n The declaration of an iterator function or `Get` accessor must meet the following requirements:  \n  \n-   It must include an [Iterator](../../../visual-basic/language-reference/modifiers/iterator.md) modifier.  \n  \n-   The return type must be <xref:System.Collections.IEnumerable>, <xref:System.Collections.Generic.IEnumerable%601>, <xref:System.Collections.IEnumerator>, or <xref:System.Collections.Generic.IEnumerator%601>.  \n  \n-   It cannot have any `ByRef` parameters.  \n  \n An iterator function cannot occur in an event, instance constructor, static constructor, or static destructor.  \n  \n An iterator function can be an anonymous function. For more information, see [Iterators](../../programming-guide/concepts/iterators.md).  \n  \n## Exception Handling  \n A `Yield` statement can be inside a `Try` block of a [Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md). A `Try` block that has a `Yield` statement can have `Catch` blocks, and can have a `Finally` block.  \n  \n A `Yield` statement cannot be inside a `Catch` block or a `Finally` block.  \n  \n If the `For Each` body (outside of the iterator function) throws an exception, a `Catch` block in the iterator function is not executed, but a `Finally` block in the iterator function is executed. A `Catch` block inside an iterator function catches only exceptions that occur inside the iterator function.  \n  \n## Technical Implementation  \n The following code returns an `IEnumerable (Of String)` from an iterator function and then iterates through the elements of the `IEnumerable (Of String)`.  \n  \n```vb  \nDim elements As IEnumerable(Of String) = MyIteratorFunction()  \n    …  \nFor Each element As String In elements  \nNext  \n```  \n  \n The call to `MyIteratorFunction` doesn't execute the body of the function. Instead the call returns an `IEnumerable(Of String)` into the `elements` variable.  \n  \n On an iteration of the `For Each` loop, the <xref:System.Collections.IEnumerator.MoveNext%2A> method is called for `elements`. This call executes the body of `MyIteratorFunction` until the next `Yield` statement is reached. The `Yield` statement returns an expression that determines not only the value of the `element` variable for consumption by the loop body but also the <xref:System.Collections.Generic.IEnumerator%601.Current%2A> property of elements, which is an `IEnumerable (Of String)`.  \n  \n On each subsequent iteration of the `For Each` loop, the execution of the iterator body continues from where it left off, again stopping when it reaches a `Yield` statement. The `For Each` loop completes when the end of the iterator function or a `Return` or `Exit Function` statement is reached.  \n  \n## Example  \n The following example has a `Yield` statement that is inside a [For…Next](../../../visual-basic/language-reference/statements/for-next-statement.md) loop. Each iteration of the [For Each](../../../visual-basic/language-reference/statements/for-each-next-statement.md) statement body in `Main` creates a call to the `Power` iterator function. Each call to the iterator function proceeds to the next execution of the `Yield` statement, which occurs during the next iteration of the `For…Next` loop.  \n  \n The return type of the iterator method is <xref:System.Collections.Generic.IEnumerable%601>, an iterator interface type. When the iterator method is called, it returns an enumerable object that contains the powers of a number.  \n  \n [!code-vb[VbVbalrStatements#98](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class2.vb#98)]  \n  \n## Example  \n The following example demonstrates a `Get` accessor that is an iterator. The property declaration includes an `Iterator` modifier.  \n  \n [!code-vb[VbVbalrStatements#99](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class2.vb#99)]  \n  \n For additional examples, see [Iterators](../../programming-guide/concepts/iterators.md).  \n  \n## See also\n\n- [Statements](../../../visual-basic/language-reference/statements/index.md)\n","nodes":[{"pos":[4,279],"embed":true,"restype":"x-metadata","content":"title: \"Yield Statement (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.Yield\"\nhelpviewer_keywords: \n  - \"iterators, Yield statement [Visual Basic]\"\n  - \"iterators [Visual Basic]\"\n  - \"Yield statement [Visual Basic]\"\nms.assetid: f33126c5-d7c4-43e2-8e36-4ae3f0703d97","nodes":[{"content":"Yield Statement (Visual Basic)","nodes":[{"pos":[0,30],"content":"Yield Statement (Visual Basic)","nodes":[{"content":"Yield Statement (Visual Basic)","pos":[0,30]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[286,316],"content":"Yield Statement (Visual Basic)","linkify":"Yield Statement (Visual Basic)","nodes":[{"content":"Yield Statement (Visual Basic)","pos":[0,30]}]},{"pos":[317,389],"content":"Sends the next element of a collection to a <ph id=\"ph1\">`For Each...Next`</ph> statement.","source":"Sends the next element of a collection to a `For Each...Next` statement."},{"pos":[398,404],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[447,457],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Term","pos":[464,468]},{"content":"Definition","pos":[469,479]},{"content":"Required.","pos":[509,518]},{"content":"An expression that is implicitly convertible to the type of the iterator function or <ph id=\"ph1\">`Get`</ph> accessor that contains the <ph id=\"ph2\">`Yield`</ph> statement.","pos":[519,655],"source":" An expression that is implicitly convertible to the type of the iterator function or `Get` accessor that contains the `Yield` statement."},{"pos":[665,672],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`Yield`</ph> statement returns one element of a collection at a time.","pos":[676,744],"source":"The `Yield` statement returns one element of a collection at a time."},{"content":"The <ph id=\"ph1\">`Yield`</ph> statement is included in an iterator function or <ph id=\"ph2\">`Get`</ph> accessor, which perform custom iterations over a collection.","pos":[745,872],"source":" The `Yield` statement is included in an iterator function or `Get` accessor, which perform custom iterations over a collection."},{"content":"You consume an iterator function by using a <bpt id=\"p1\">[</bpt>For Each...Next Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/for-each-next-statement.md)</ept> or a LINQ query.","pos":[879,1047],"source":"You consume an iterator function by using a [For Each...Next Statement](../../../visual-basic/language-reference/statements/for-each-next-statement.md) or a LINQ query."},{"content":"Each iteration of the <ph id=\"ph1\">`For Each`</ph> loop calls the iterator function.","pos":[1048,1114],"source":" Each iteration of the `For Each` loop calls the iterator function."},{"content":"When a <ph id=\"ph1\">`Yield`</ph> statement is reached in the iterator function, <ph id=\"ph2\">`expression`</ph> is returned, and the current location in code is retained.","pos":[1115,1248],"source":" When a `Yield` statement is reached in the iterator function, `expression` is returned, and the current location in code is retained."},{"content":"Execution is restarted from that location the next time that the iterator function is called.","pos":[1249,1342]},{"pos":[1349,1473],"content":"An implicit conversion must exist from the type of <ph id=\"ph1\">`expression`</ph> in the <ph id=\"ph2\">`Yield`</ph> statement to the return type of the iterator.","source":"An implicit conversion must exist from the type of `expression` in the `Yield` statement to the return type of the iterator."},{"pos":[1480,1554],"content":"You can use an <ph id=\"ph1\">`Exit Function`</ph> or <ph id=\"ph2\">`Return`</ph> statement to end the iteration.","source":"You can use an `Exit Function` or `Return` statement to end the iteration."},{"pos":[1561,1681],"content":"\"Yield\" is not a reserved word and has special meaning only when it is used in an <ph id=\"ph1\">`Iterator`</ph> function or <ph id=\"ph2\">`Get`</ph> accessor.","source":"\"Yield\" is not a reserved word and has special meaning only when it is used in an `Iterator` function or `Get` accessor."},{"pos":[1688,1818],"content":"For more information about iterator functions and <ph id=\"ph1\">`Get`</ph> accessors, see <bpt id=\"p1\">[</bpt>Iterators<ept id=\"p1\">](../../programming-guide/concepts/iterators.md)</ept>.","source":"For more information about iterator functions and `Get` accessors, see [Iterators](../../programming-guide/concepts/iterators.md)."},{"pos":[1827,1863],"content":"Iterator Functions and Get Accessors","linkify":"Iterator Functions and Get Accessors","nodes":[{"content":"Iterator Functions and Get Accessors","pos":[0,36]}]},{"pos":[1867,1962],"content":"The declaration of an iterator function or <ph id=\"ph1\">`Get`</ph> accessor must meet the following requirements:","source":"The declaration of an iterator function or `Get` accessor must meet the following requirements:"},{"pos":[1972,2075],"content":"It must include an <bpt id=\"p1\">[</bpt>Iterator<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/iterator.md)</ept> modifier.","source":"It must include an [Iterator](../../../visual-basic/language-reference/modifiers/iterator.md) modifier."},{"pos":[2085,2291],"content":"The return type must be <ph id=\"ph1\">&lt;xref:System.Collections.IEnumerable&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Collections.IEnumerator&gt;</ph>, or <ph id=\"ph4\">&lt;xref:System.Collections.Generic.IEnumerator%601&gt;</ph>.","source":"The return type must be <xref:System.Collections.IEnumerable>, <xref:System.Collections.Generic.IEnumerable%601>, <xref:System.Collections.IEnumerator>, or <xref:System.Collections.Generic.IEnumerator%601>."},{"pos":[2301,2339],"content":"It cannot have any <ph id=\"ph1\">`ByRef`</ph> parameters.","source":"It cannot have any `ByRef` parameters."},{"content":"An iterator function cannot occur in an event, instance constructor, static constructor, or static destructor.","pos":[2346,2456]},{"content":"An iterator function can be an anonymous function.","pos":[2463,2513]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Iterators<ept id=\"p1\">](../../programming-guide/concepts/iterators.md)</ept>.","pos":[2514,2599],"source":" For more information, see [Iterators](../../programming-guide/concepts/iterators.md)."},{"pos":[2608,2626],"content":"Exception Handling","linkify":"Exception Handling","nodes":[{"content":"Exception Handling","pos":[0,18]}]},{"content":"A <ph id=\"ph1\">`Yield`</ph> statement can be inside a <ph id=\"ph2\">`Try`</ph> block of a <bpt id=\"p1\">[</bpt>Try...Catch...Finally Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)</ept>.","pos":[2630,2801],"source":"A `Yield` statement can be inside a `Try` block of a [Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)."},{"content":"A <ph id=\"ph1\">`Try`</ph> block that has a <ph id=\"ph2\">`Yield`</ph> statement can have <ph id=\"ph3\">`Catch`</ph> blocks, and can have a <ph id=\"ph4\">`Finally`</ph> block.","pos":[2802,2901],"source":" A `Try` block that has a `Yield` statement can have `Catch` blocks, and can have a `Finally` block."},{"pos":[2908,2982],"content":"A <ph id=\"ph1\">`Yield`</ph> statement cannot be inside a <ph id=\"ph2\">`Catch`</ph> block or a <ph id=\"ph3\">`Finally`</ph> block.","source":"A `Yield` statement cannot be inside a `Catch` block or a `Finally` block."},{"content":"If the <ph id=\"ph1\">`For Each`</ph> body (outside of the iterator function) throws an exception, a <ph id=\"ph2\">`Catch`</ph> block in the iterator function is not executed, but a <ph id=\"ph3\">`Finally`</ph> block in the iterator function is executed.","pos":[2989,3185],"source":"If the `For Each` body (outside of the iterator function) throws an exception, a `Catch` block in the iterator function is not executed, but a `Finally` block in the iterator function is executed."},{"content":"A <ph id=\"ph1\">`Catch`</ph> block inside an iterator function catches only exceptions that occur inside the iterator function.","pos":[3186,3294],"source":" A `Catch` block inside an iterator function catches only exceptions that occur inside the iterator function."},{"pos":[3303,3327],"content":"Technical Implementation","linkify":"Technical Implementation","nodes":[{"content":"Technical Implementation","pos":[0,24]}]},{"pos":[3331,3485],"content":"The following code returns an <ph id=\"ph1\">`IEnumerable (Of String)`</ph> from an iterator function and then iterates through the elements of the <ph id=\"ph2\">`IEnumerable (Of String)`</ph>.","source":"The following code returns an `IEnumerable (Of String)` from an iterator function and then iterates through the elements of the `IEnumerable (Of String)`."},{"content":"The call to <ph id=\"ph1\">`MyIteratorFunction`</ph> doesn't execute the body of the function.","pos":[3629,3703],"source":"The call to `MyIteratorFunction` doesn't execute the body of the function."},{"content":"Instead the call returns an <ph id=\"ph1\">`IEnumerable(Of String)`</ph> into the <ph id=\"ph2\">`elements`</ph> variable.","pos":[3704,3786],"source":" Instead the call returns an `IEnumerable(Of String)` into the `elements` variable."},{"content":"On an iteration of the <ph id=\"ph1\">`For Each`</ph> loop, the <ph id=\"ph2\">&lt;xref:System.Collections.IEnumerator.MoveNext%2A&gt;</ph> method is called for <ph id=\"ph3\">`elements`</ph>.","pos":[3793,3919],"source":"On an iteration of the `For Each` loop, the <xref:System.Collections.IEnumerator.MoveNext%2A> method is called for `elements`."},{"content":"This call executes the body of <ph id=\"ph1\">`MyIteratorFunction`</ph> until the next <ph id=\"ph2\">`Yield`</ph> statement is reached.","pos":[3920,4016],"source":" This call executes the body of `MyIteratorFunction` until the next `Yield` statement is reached."},{"content":"The <ph id=\"ph1\">`Yield`</ph> statement returns an expression that determines not only the value of the <ph id=\"ph2\">`element`</ph> variable for consumption by the loop body but also the <ph id=\"ph3\">&lt;xref:System.Collections.Generic.IEnumerator%601.Current%2A&gt;</ph> property of elements, which is an <ph id=\"ph4\">`IEnumerable (Of String)`</ph>.","pos":[4017,4289],"source":" The `Yield` statement returns an expression that determines not only the value of the `element` variable for consumption by the loop body but also the <xref:System.Collections.Generic.IEnumerator%601.Current%2A> property of elements, which is an `IEnumerable (Of String)`."},{"content":"On each subsequent iteration of the <ph id=\"ph1\">`For Each`</ph> loop, the execution of the iterator body continues from where it left off, again stopping when it reaches a <ph id=\"ph2\">`Yield`</ph> statement.","pos":[4296,4469],"source":"On each subsequent iteration of the `For Each` loop, the execution of the iterator body continues from where it left off, again stopping when it reaches a `Yield` statement."},{"content":"The <ph id=\"ph1\">`For Each`</ph> loop completes when the end of the iterator function or a <ph id=\"ph2\">`Return`</ph> or <ph id=\"ph3\">`Exit Function`</ph> statement is reached.","pos":[4470,4592],"source":" The `For Each` loop completes when the end of the iterator function or a `Return` or `Exit Function` statement is reached."},{"pos":[4601,4608],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example has a <ph id=\"ph1\">`Yield`</ph> statement that is inside a <bpt id=\"p1\">[</bpt>For…Next<ept id=\"p1\">](../../../visual-basic/language-reference/statements/for-next-statement.md)</ept> loop.","pos":[4612,4766],"source":"The following example has a `Yield` statement that is inside a [For…Next](../../../visual-basic/language-reference/statements/for-next-statement.md) loop."},{"content":"Each iteration of the <bpt id=\"p1\">[</bpt>For Each<ept id=\"p1\">](../../../visual-basic/language-reference/statements/for-each-next-statement.md)</ept> statement body in <ph id=\"ph1\">`Main`</ph> creates a call to the <ph id=\"ph2\">`Power`</ph> iterator function.","pos":[4767,4953],"source":" Each iteration of the [For Each](../../../visual-basic/language-reference/statements/for-each-next-statement.md) statement body in `Main` creates a call to the `Power` iterator function."},{"content":"Each call to the iterator function proceeds to the next execution of the <ph id=\"ph1\">`Yield`</ph> statement, which occurs during the next iteration of the <ph id=\"ph2\">`For…Next`</ph> loop.","pos":[4954,5108],"source":" Each call to the iterator function proceeds to the next execution of the `Yield` statement, which occurs during the next iteration of the `For…Next` loop."},{"content":"The return type of the iterator method is <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph>, an iterator interface type.","pos":[5115,5235],"source":"The return type of the iterator method is <xref:System.Collections.Generic.IEnumerable%601>, an iterator interface type."},{"content":"When the iterator method is called, it returns an enumerable object that contains the powers of a number.","pos":[5236,5341]},{"pos":[5476,5483],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example demonstrates a <ph id=\"ph1\">`Get`</ph> accessor that is an iterator.","pos":[5487,5559],"source":"The following example demonstrates a `Get` accessor that is an iterator."},{"content":"The property declaration includes an <ph id=\"ph1\">`Iterator`</ph> modifier.","pos":[5560,5617],"source":" The property declaration includes an `Iterator` modifier."},{"pos":[5750,5838],"content":"For additional examples, see <bpt id=\"p1\">[</bpt>Iterators<ept id=\"p1\">](../../programming-guide/concepts/iterators.md)</ept>.","source":"For additional examples, see [Iterators](../../programming-guide/concepts/iterators.md)."},{"pos":[5847,5855],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5859,5933],"content":"<bpt id=\"p1\">[</bpt>Statements<ept id=\"p1\">](../../../visual-basic/language-reference/statements/index.md)</ept>","source":"[Statements](../../../visual-basic/language-reference/statements/index.md)"}]}