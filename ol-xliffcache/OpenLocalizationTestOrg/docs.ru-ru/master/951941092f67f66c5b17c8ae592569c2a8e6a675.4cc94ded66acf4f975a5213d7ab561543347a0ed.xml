{"content":"---\ntitle: \"CorPinvokeMap Enumeration\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"CorPinvokeMap\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"CorPinvokeMap\"\nhelpviewer_keywords: \n  - \"CorPinvokeMap enumeration [.NET Framework metadata]\"\nms.assetid: f14f986e-f6ce-42bc-aa23-18150c46d28c\ntopic_type: \n  - \"apiref\"\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# CorPinvokeMap Enumeration\nSpecifies options for a PInvoke call.  \n  \n## Syntax  \n  \n```  \ntypedef enum  CorPinvokeMap {  \n  \n    pmNoMangle          = 0x0001,  \n  \n    pmCharSetMask       = 0x0006,  \n    pmCharSetNotSpec    = 0x0000,  \n    pmCharSetAnsi       = 0x0002,  \n    pmCharSetUnicode    = 0x0004,  \n    pmCharSetAuto       = 0x0006,  \n  \n    pmBestFitUseAssem   = 0x0000,  \n    pmBestFitEnabled    = 0x0010,  \n    pmBestFitDisabled   = 0x0020,  \n    pmBestFitMask       = 0x0030,  \n  \n    pmThrowOnUnmappableCharUseAssem   = 0x0000,  \n    pmThrowOnUnmappableCharEnabled    = 0x1000,  \n    pmThrowOnUnmappableCharDisabled   = 0x2000,  \n    pmThrowOnUnmappableCharMask       = 0x3000,  \n  \n    pmSupportsLastError = 0x0040,   \n  \n    pmCallConvMask      = 0x0700,  \n    pmCallConvWinapi    = 0x0100,  \n    pmCallConvCdecl     = 0x0200,  \n    pmCallConvStdcall   = 0x0300,  \n    pmCallConvThiscall  = 0x0400,  \n    pmCallConvFastcall  = 0x0500,  \n  \n    pmMaxValue          = 0xFFFF  \n  \n} CorPinvokeMap;  \n```  \n  \n## Members  \n  \n|Member|Description|  \n|------------|-----------------|  \n|`pmNoMangle`|Use each member name as specified.|  \n|`pmCharSetMask`|Reserved.|  \n|`pmCharSetNotSpec`|Reserved.|  \n|`pmCharSetAnsi`|Marshal strings as multiple-byte character strings.|  \n|`pmCharSetUnicode`|Marshal strings as Unicode 2-byte characters.|  \n|`pmCharSetAuto`|Automatically marshal strings appropriately for the target operating system. The default is Unicode on Windows NT, Windows 2000, Windows XP, and the Windows Server 2003 family; the default is ANSI on Windows 98 and Windows Me.|  \n|`pmBestFitUseAssem`|Reserved.|  \n|`pmBestFitEnabled`|Perform best-fit mapping of Unicode characters that lack an exact match in the ANSI character set.|  \n|`pmBestFitDisabled`|Do not perform best-fit mapping of Unicode characters. In this case, all unmappable characters will be replaced by a ‘?’.|  \n|`pmBestFitMask`|Reserved.|  \n|`pmThrowOnUnmappableCharUseAssem`|Reserved.|  \n|`pmThrowOnUnmappableCharEnabled`|Throw an exception when the interop marshaler encounters an unmappable character.|  \n|`pmThrowOnUnmappableCharDisabled`|Do not throw an exception when the interop marshaler encounters an unmappable character.|  \n|`pmThrowOnUnmappableCharMask`|Reserved|  \n|`pmSupportsLastError`|Allow the callee to call the Win32 `SetLastError` function before returning from the attributed method.|  \n|`pmCallConvMask`|Reserved|  \n|`pmCallConvWinapi`|Use the default platform calling convention. For example, on Windows the default is `StdCall` and on Windows CE .NET it is `Cdecl`.|  \n|`pmCallConvCdecl`|Use the `Cdecl` calling convention. In this case, the caller cleans the stack. This enables calling functions with `varargs` (that is, functions that accept a variable number of parameters).|  \n|`pmCallConvStdcall`|Use the `StdCall` calling convention. In this case, the callee cleans the stack. This is the default convention for calling unmanaged functions with platform invoke.|  \n|`pmCallConvThiscall`|Use the `ThisCall` calling convention. In this case, the first parameter is the `this` pointer and is stored in register ECX. Other parameters are pushed on the stack. The `ThisCall` calling convention is used to call methods on classes exported from an unmanaged DLL.|  \n|`pmCallConvFastcall`|Reserved.|  \n|`pmMaxValue`|Reserved.|  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** CorHdr.h  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See also\n\n- [Metadata Enumerations](../../../../docs/framework/unmanaged-api/metadata/metadata-enumerations.md)\n","nodes":[{"pos":[4,371],"embed":true,"restype":"x-metadata","content":"title: \"CorPinvokeMap Enumeration\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"CorPinvokeMap\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"CorPinvokeMap\"\nhelpviewer_keywords: \n  - \"CorPinvokeMap enumeration [.NET Framework metadata]\"\nms.assetid: f14f986e-f6ce-42bc-aa23-18150c46d28c\ntopic_type: \n  - \"apiref\"\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"CorPinvokeMap Enumeration","nodes":[{"pos":[0,25],"content":"CorPinvokeMap Enumeration","nodes":[{"content":"CorPinvokeMap Enumeration","pos":[0,25]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[378,403],"content":"CorPinvokeMap Enumeration","linkify":"CorPinvokeMap Enumeration","nodes":[{"content":"CorPinvokeMap Enumeration","pos":[0,25]}]},{"content":"Specifies options for a PInvoke call.","pos":[404,441]},{"pos":[450,456],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1403,1410],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"content":"Member","pos":[1417,1423]},{"content":"Description","pos":[1424,1435]},{"content":"Use each member name as specified.","pos":[1488,1522]},{"content":"Reserved.","pos":[1543,1552]},{"content":"Reserved.","pos":[1576,1585]},{"content":"Marshal strings as multiple-byte character strings.","pos":[1606,1657]},{"content":"Marshal strings as Unicode 2-byte characters.","pos":[1681,1726]},{"content":"Automatically marshal strings appropriately for the target operating system.","pos":[1747,1823]},{"content":"The default is Unicode on Windows NT, Windows 2000, Windows XP, and the Windows Server 2003 family; the default is ANSI on Windows 98 and Windows Me.","pos":[1824,1973]},{"content":"Reserved.","pos":[1998,2007]},{"content":"Perform best-fit mapping of Unicode characters that lack an exact match in the ANSI character set.","pos":[2031,2129]},{"content":"Do not perform best-fit mapping of Unicode characters.","pos":[2154,2208]},{"content":"In this case, all unmappable characters will be replaced by a ‘?’.","pos":[2209,2275]},{"content":"Reserved.","pos":[2296,2305]},{"content":"Reserved.","pos":[2344,2353]},{"content":"Throw an exception when the interop marshaler encounters an unmappable character.","pos":[2391,2472]},{"content":"Do not throw an exception when the interop marshaler encounters an unmappable character.","pos":[2511,2599]},{"content":"Reserved","pos":[2634,2642]},{"pos":[2669,2772],"content":"Allow the callee to call the Win32 <ph id=\"ph1\">`SetLastError`</ph> function before returning from the attributed method.","source":"Allow the callee to call the Win32 `SetLastError` function before returning from the attributed method."},{"content":"Reserved","pos":[2794,2802]},{"content":"Use the default platform calling convention.","pos":[2826,2870]},{"content":"For example, on Windows the default is <ph id=\"ph1\">`StdCall`</ph> and on Windows CE .NET it is <ph id=\"ph2\">`Cdecl`</ph>.","pos":[2871,2957],"source":" For example, on Windows the default is `StdCall` and on Windows CE .NET it is `Cdecl`."},{"content":"Use the <ph id=\"ph1\">`Cdecl`</ph> calling convention.","pos":[2980,3015],"source":"Use the `Cdecl` calling convention."},{"content":"In this case, the caller cleans the stack.","pos":[3016,3058]},{"content":"This enables calling functions with <ph id=\"ph1\">`varargs`</ph> (that is, functions that accept a variable number of parameters).","pos":[3059,3170],"source":" This enables calling functions with `varargs` (that is, functions that accept a variable number of parameters)."},{"content":"Use the <ph id=\"ph1\">`StdCall`</ph> calling convention.","pos":[3195,3232],"source":"Use the `StdCall` calling convention."},{"content":"In this case, the callee cleans the stack.","pos":[3233,3275]},{"content":"This is the default convention for calling unmanaged functions with platform invoke.","pos":[3276,3360]},{"content":"Use the <ph id=\"ph1\">`ThisCall`</ph> calling convention.","pos":[3386,3424],"source":"Use the `ThisCall` calling convention."},{"content":"In this case, the first parameter is the <ph id=\"ph1\">`this`</ph> pointer and is stored in register ECX.","pos":[3425,3511],"source":" In this case, the first parameter is the `this` pointer and is stored in register ECX."},{"content":"Other parameters are pushed on the stack.","pos":[3512,3553]},{"content":"The <ph id=\"ph1\">`ThisCall`</ph> calling convention is used to call methods on classes exported from an unmanaged DLL.","pos":[3554,3654],"source":" The `ThisCall` calling convention is used to call methods on classes exported from an unmanaged DLL."},{"content":"Reserved.","pos":[3680,3689]},{"content":"Reserved.","pos":[3707,3716]},{"pos":[3726,3738],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3742,3846],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3853,3873],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> CorHdr.h","source":"**Header:** CorHdr.h"},{"pos":[3880,3988],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]"},{"pos":[3997,4005],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4009,4108],"content":"<bpt id=\"p1\">[</bpt>Metadata Enumerations<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/metadata-enumerations.md)</ept>","source":"[Metadata Enumerations](../../../../docs/framework/unmanaged-api/metadata/metadata-enumerations.md)"}]}