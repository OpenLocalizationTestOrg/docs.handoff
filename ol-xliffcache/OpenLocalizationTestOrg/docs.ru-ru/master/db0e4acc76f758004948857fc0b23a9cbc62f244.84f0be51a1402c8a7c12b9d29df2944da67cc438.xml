{"content":"---\ntitle: \"Workflow Persistence\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"programming [WF], persistence\"\nms.assetid: 39e69d1f-b771-4c16-9e18-696fa43b65b2\n---\n# Workflow Persistence\nWorkflow persistence is the durable capture of a workflow instance's state, independent of process or computer information. This is done to provide a well-known point of recovery for the workflow instance in the event of system failure, or to preserve memory by unloading workflow instances that are not actively doing work, or to move the state of the workflow instance from one node to another node in a server farm.  \n  \n Persistence enables process agility, scalability, recovery in the face of failure, and the ability to manage memory more efficiently. The persistence process includes the identification of a persistence point, the gathering of the data to be saved, and finally the delegation of the actual storage of the data to a persistence provider.  \n  \n To enable persistence for a workflow, you need to associate an instance store with the **WorkflowApplication** or **WorkflowServiceHost** as mentioned in [How to: Enable Persistence for Workflows and Workflow Services](how-to-enable-persistence-for-workflows-and-workflow-services.md). The **WorkflowApplication** and **WorkflowServiceHost** use the instance store associated with them to enable persisting workflow instances into a persistence store and loading workflow instances into memory based on the workflow instance data stored in the persistence store.  \n  \n The [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] ships with the **SqlWorkflowInstanceStore** class, which allows persistence of data and metadata about workflow instances into a SQL Server 2005 or SQL Server 2008 database. See [SQL Workflow Instance Store](sql-workflow-instance-store.md) for more details.  \n  \n To store and load your application-specific data along with the workflow instance-related information, you can create persistence participants that extend the <xref:System.Activities.Persistence.PersistenceParticipant> class. A persistence participant participates in the persistence process to save custom serializable data into the persistence store, to load the data from the instance store into memory, and to perform any additional logic under a persistence transaction. For more information, see [Persistence Participants](persistence-participants.md).  \n  \n Windows Server App Fabric simplifies the process of configuring persistence. For more information, see [Persistence Concepts with Windows Server App Fabric](https://go.microsoft.com/fwlink/?LinkId=201200)  \n  \n## Implicit Persistence Points  \n The following list contains examples of the conditions upon which a workflow is persisted when an instance store is associated with a workflow.  \n  \n-   When a **TransactionScope** activity completes or a **TransactedReceiveScope** activity completes.  \n  \n-   When a workflow instance becomes idle and the **WorkflowIdleBehavior** is set on workflow host. This occurs, for example, when you use messaging activities or a **Delay** activity.  \n  \n-   When a WorkflowApplication becomes idle and the **PersistableIdle** property of the application is set to **PersistableIdleAction.Persist**.  \n  \n-   When a host application is instructed to persist or unload a workflow instance.  \n  \n-   When a workflow instance is terminated or finishes.  \n  \n-   When a **Persist** activity executes.  \n  \n-   When an instance of a workflow developed using a previous version of Windows Workflow Foundation encounters a persistence point during interoperable execution.  \n  \n## In This Section  \n  \n-   [SQL Workflow Instance Store](sql-workflow-instance-store.md)  \n  \n-   [Instance Stores](instance-stores.md)  \n  \n-   [Persistence Participants](persistence-participants.md)  \n  \n-   [Persistence Best Practices](persistence-best-practices.md)  \n  \n-   [Non-Persisted Workflow Instances](non-persisted-workflow-instances.md)  \n  \n-   [Pausing and Resuming a Workflow](pausing-and-resuming-a-workflow.md)\n","nodes":[{"pos":[4,162],"embed":true,"restype":"x-metadata","content":"title: \"Workflow Persistence\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"programming [WF], persistence\"\nms.assetid: 39e69d1f-b771-4c16-9e18-696fa43b65b2","nodes":[{"content":"Workflow Persistence","nodes":[{"pos":[0,20],"content":"Workflow Persistence","nodes":[{"content":"Workflow Persistence","pos":[0,20]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[169,189],"content":"Workflow Persistence","linkify":"Workflow Persistence","nodes":[{"content":"Workflow Persistence","pos":[0,20]}]},{"content":"Workflow persistence is the durable capture of a workflow instance's state, independent of process or computer information.","pos":[190,313]},{"content":"This is done to provide a well-known point of recovery for the workflow instance in the event of system failure, or to preserve memory by unloading workflow instances that are not actively doing work, or to move the state of the workflow instance from one node to another node in a server farm.","pos":[314,608]},{"content":"Persistence enables process agility, scalability, recovery in the face of failure, and the ability to manage memory more efficiently.","pos":[615,748]},{"content":"The persistence process includes the identification of a persistence point, the gathering of the data to be saved, and finally the delegation of the actual storage of the data to a persistence provider.","pos":[749,951]},{"content":"To enable persistence for a workflow, you need to associate an instance store with the <bpt id=\"p1\">**</bpt>WorkflowApplication<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>WorkflowServiceHost<ept id=\"p2\">**</ept> as mentioned in <bpt id=\"p3\">[</bpt>How to: Enable Persistence for Workflows and Workflow Services<ept id=\"p3\">](how-to-enable-persistence-for-workflows-and-workflow-services.md)</ept>.","pos":[958,1243],"source":"To enable persistence for a workflow, you need to associate an instance store with the **WorkflowApplication** or **WorkflowServiceHost** as mentioned in [How to: Enable Persistence for Workflows and Workflow Services](how-to-enable-persistence-for-workflows-and-workflow-services.md)."},{"content":"The <bpt id=\"p1\">**</bpt>WorkflowApplication<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>WorkflowServiceHost<ept id=\"p2\">**</ept> use the instance store associated with them to enable persisting workflow instances into a persistence store and loading workflow instances into memory based on the workflow instance data stored in the persistence store.","pos":[1244,1520],"source":" The **WorkflowApplication** and **WorkflowServiceHost** use the instance store associated with them to enable persisting workflow instances into a persistence store and loading workflow instances into memory based on the workflow instance data stored in the persistence store."},{"content":"The <ph id=\"ph1\">[!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)]</ph> ships with the <bpt id=\"p1\">**</bpt>SqlWorkflowInstanceStore<ept id=\"p1\">**</ept> class, which allows persistence of data and metadata about workflow instances into a SQL Server 2005 or SQL Server 2008 database.","pos":[1527,1779],"source":"The [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] ships with the **SqlWorkflowInstanceStore** class, which allows persistence of data and metadata about workflow instances into a SQL Server 2005 or SQL Server 2008 database."},{"content":"See <bpt id=\"p1\">[</bpt>SQL Workflow Instance Store<ept id=\"p1\">](sql-workflow-instance-store.md)</ept> for more details.","pos":[1780,1863],"source":" See [SQL Workflow Instance Store](sql-workflow-instance-store.md) for more details."},{"content":"To store and load your application-specific data along with the workflow instance-related information, you can create persistence participants that extend the <ph id=\"ph1\">&lt;xref:System.Activities.Persistence.PersistenceParticipant&gt;</ph> class.","pos":[1870,2095],"source":"To store and load your application-specific data along with the workflow instance-related information, you can create persistence participants that extend the <xref:System.Activities.Persistence.PersistenceParticipant> class."},{"content":"A persistence participant participates in the persistence process to save custom serializable data into the persistence store, to load the data from the instance store into memory, and to perform any additional logic under a persistence transaction.","pos":[2096,2345]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Persistence Participants<ept id=\"p1\">](persistence-participants.md)</ept>.","pos":[2346,2428],"source":" For more information, see [Persistence Participants](persistence-participants.md)."},{"content":"Windows Server App Fabric simplifies the process of configuring persistence.","pos":[2435,2511]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Persistence Concepts with Windows Server App Fabric<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=201200)</ept>","pos":[2512,2639],"source":" For more information, see [Persistence Concepts with Windows Server App Fabric](https://go.microsoft.com/fwlink/?LinkId=201200)"},{"pos":[2648,2675],"content":"Implicit Persistence Points","linkify":"Implicit Persistence Points","nodes":[{"content":"Implicit Persistence Points","pos":[0,27]}]},{"content":"The following list contains examples of the conditions upon which a workflow is persisted when an instance store is associated with a workflow.","pos":[2679,2822]},{"pos":[2832,2930],"content":"When a <bpt id=\"p1\">**</bpt>TransactionScope<ept id=\"p1\">**</ept> activity completes or a <bpt id=\"p2\">**</bpt>TransactedReceiveScope<ept id=\"p2\">**</ept> activity completes.","source":"When a **TransactionScope** activity completes or a **TransactedReceiveScope** activity completes."},{"content":"When a workflow instance becomes idle and the <bpt id=\"p1\">**</bpt>WorkflowIdleBehavior<ept id=\"p1\">**</ept> is set on workflow host.","pos":[2940,3035],"source":"When a workflow instance becomes idle and the **WorkflowIdleBehavior** is set on workflow host."},{"content":"This occurs, for example, when you use messaging activities or a <bpt id=\"p1\">**</bpt>Delay<ept id=\"p1\">**</ept> activity.","pos":[3036,3120],"source":" This occurs, for example, when you use messaging activities or a **Delay** activity."},{"pos":[3130,3270],"content":"When a WorkflowApplication becomes idle and the <bpt id=\"p1\">**</bpt>PersistableIdle<ept id=\"p1\">**</ept> property of the application is set to <bpt id=\"p2\">**</bpt>PersistableIdleAction.Persist<ept id=\"p2\">**</ept>.","source":"When a WorkflowApplication becomes idle and the **PersistableIdle** property of the application is set to **PersistableIdleAction.Persist**."},{"content":"When a host application is instructed to persist or unload a workflow instance.","pos":[3280,3359]},{"content":"When a workflow instance is terminated or finishes.","pos":[3369,3420]},{"pos":[3430,3467],"content":"When a <bpt id=\"p1\">**</bpt>Persist<ept id=\"p1\">**</ept> activity executes.","source":"When a **Persist** activity executes."},{"content":"When an instance of a workflow developed using a previous version of Windows Workflow Foundation encounters a persistence point during interoperable execution.","pos":[3477,3636]},{"pos":[3645,3660],"content":"In This Section","linkify":"In This Section","nodes":[{"content":"In This Section","pos":[0,15]}]},{"pos":[3670,3731],"content":"<bpt id=\"p1\">[</bpt>SQL Workflow Instance Store<ept id=\"p1\">](sql-workflow-instance-store.md)</ept>","source":"[SQL Workflow Instance Store](sql-workflow-instance-store.md)"},{"pos":[3741,3778],"content":"<bpt id=\"p1\">[</bpt>Instance Stores<ept id=\"p1\">](instance-stores.md)</ept>","source":"[Instance Stores](instance-stores.md)"},{"pos":[3788,3843],"content":"<bpt id=\"p1\">[</bpt>Persistence Participants<ept id=\"p1\">](persistence-participants.md)</ept>","source":"[Persistence Participants](persistence-participants.md)"},{"pos":[3853,3912],"content":"<bpt id=\"p1\">[</bpt>Persistence Best Practices<ept id=\"p1\">](persistence-best-practices.md)</ept>","source":"[Persistence Best Practices](persistence-best-practices.md)"},{"pos":[3922,3993],"content":"<bpt id=\"p1\">[</bpt>Non-Persisted Workflow Instances<ept id=\"p1\">](non-persisted-workflow-instances.md)</ept>","source":"[Non-Persisted Workflow Instances](non-persisted-workflow-instances.md)"},{"pos":[4003,4072],"content":"<bpt id=\"p1\">[</bpt>Pausing and Resuming a Workflow<ept id=\"p1\">](pausing-and-resuming-a-workflow.md)</ept>","source":"[Pausing and Resuming a Workflow](pausing-and-resuming-a-workflow.md)"}]}