{"content":"---\ntitle: \"Relaxed Delegate Conversion (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"relaxed delegate conversion [Visual Basic]\"\n  - \"delegates [Visual Basic], relaxed conversion\"\n  - \"conversions [Visual Basic], relaxed delegate\"\nms.assetid: 64f371d0-5416-4f65-b23b-adcbf556e81c\n---\n# Relaxed Delegate Conversion (Visual Basic)\nRelaxed delegate conversion enables you to assign subs and functions to delegates or handlers even when their signatures are not identical. Therefore, binding to delegates becomes consistent with the binding already allowed for method invocations.  \n  \n## Parameters and Return Type  \n In place of exact signature match, relaxed conversion requires that the following conditions be met when `Option Strict` is set to `On`:  \n  \n-   A widening conversion must exist from the data type of each delegate parameter to the data type of the corresponding parameter of the assigned function or `Sub`. In the following example, the delegate `Del1` has one parameter, an `Integer`. Parameter `m` in the assigned lambda expressions must have a data type for which there is a widening conversion from `Integer`, such as `Long` or `Double`.  \n  \n     [!code-vb[VbVbalrRelaxedDelegates#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module1.vb#1)]  \n  \n     [!code-vb[VbVbalrRelaxedDelegates#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module1.vb#2)]  \n  \n     Narrowing conversions are permitted only when `Option Strict` is set to `Off`.  \n  \n     [!code-vb[VbVbalrRelaxedDelegates#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module2.vb#8)]  \n  \n-   A widening conversion must exist in the opposite direction from the return type of the assigned function or `Sub` to the return type of the delegate. In the following examples, the body of each assigned lambda expression must evaluate to a data type that widens to `Integer` because the return type of `del1` is `Integer`.  \n  \n     [!code-vb[VbVbalrRelaxedDelegates#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module1.vb#3)]  \n  \n If `Option Strict` is set to `Off`, the widening restriction is removed in both directions.  \n  \n [!code-vb[VbVbalrRelaxedDelegates#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module2.vb#4)]  \n  \n## Omitting Parameter Specifications  \n Relaxed delegates also allow you to completely omit parameter specifications in the assigned method:  \n  \n [!code-vb[VbVbalrRelaxedDelegates#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module1.vb#5)]  \n  \n [!code-vb[VbVbalrRelaxedDelegates#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module1.vb#6)]  \n  \n Note that you cannot specify some parameters and omit others.  \n  \n [!code-vb[VbVbalrRelaxedDelegates#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module1.vb#15)]  \n  \n The ability to omit parameters is helpful in a situation such as defining an event handler, where several complex parameters are involved. The arguments to some event handlers are not used. Instead, the handler directly accesses the state of the control on which the event is registered, and ignores the arguments. Relaxed delegates allow you to omit the arguments in such declarations when no ambiguities result. In the following example, the fully specified method `OnClick` can be rewritten as `RelaxedOnClick`.  \n  \n```vb  \nSub OnClick(ByVal sender As Object, ByVal e As EventArgs) Handles b.Click  \n    MessageBox.Show(\"Hello World from\" + b.Text)  \nEnd Sub  \n  \nSub RelaxedOnClick() Handles b.Click  \n    MessageBox.Show(\"Hello World from\" + b.Text)  \nEnd Sub  \n```  \n  \n## AddressOf Examples  \n Lambda expressions are used in the previous examples to make the type relationships easy to see. However, the same relaxations are permitted for delegate assignments that use `AddressOf`, `Handles`, or `AddHandler`.  \n  \n In the following example, functions `f1`, `f2`, `f3`, and `f4` can all be assigned to `Del1`.  \n  \n [!code-vb[VbVbalrRelaxedDelegates#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module1.vb#1)]  \n  \n [!code-vb[VbVbalrRelaxedDelegates#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module1.vb#7)]  \n  \n [!code-vb[VbVbalrRelaxedDelegates#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module1.vb#9)]  \n  \n The following example is valid only when `Option Strict` is set to `Off`.  \n  \n [!code-vb[VbVbalrRelaxedDelegates#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module2.vb#14)]  \n  \n## Dropping Function Returns  \n Relaxed delegate conversion enables you to assign a function to a `Sub` delegate, effectively ignoring the return value of the function. However, you cannot assign a `Sub` to a function delegate. In the following example, the address of function `doubler` is assigned to `Sub` delegate `Del3`.  \n  \n [!code-vb[VbVbalrRelaxedDelegates#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module1.vb#10)]  \n  \n [!code-vb[VbVbalrRelaxedDelegates#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrRelaxedDelegates/VB/Module1.vb#11)]  \n  \n## See also\n\n- [Lambda Expressions](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)\n- [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)\n- [Delegates](../../../../visual-basic/programming-guide/language-features/delegates/index.md)\n- [How to: Pass Procedures to Another Procedure in Visual Basic](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md)\n- [Local Type Inference](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)\n- [Option Strict Statement](../../../../visual-basic/language-reference/statements/option-strict-statement.md)\n","nodes":[{"pos":[4,297],"embed":true,"restype":"x-metadata","content":"title: \"Relaxed Delegate Conversion (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"relaxed delegate conversion [Visual Basic]\"\n  - \"delegates [Visual Basic], relaxed conversion\"\n  - \"conversions [Visual Basic], relaxed delegate\"\nms.assetid: 64f371d0-5416-4f65-b23b-adcbf556e81c","nodes":[{"content":"Relaxed Delegate Conversion (Visual Basic)","nodes":[{"pos":[0,42],"content":"Relaxed Delegate Conversion (Visual Basic)","nodes":[{"content":"Relaxed Delegate Conversion (Visual Basic)","pos":[0,42]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[304,346],"content":"Relaxed Delegate Conversion (Visual Basic)","linkify":"Relaxed Delegate Conversion (Visual Basic)","nodes":[{"content":"Relaxed Delegate Conversion (Visual Basic)","pos":[0,42]}]},{"content":"Relaxed delegate conversion enables you to assign subs and functions to delegates or handlers even when their signatures are not identical.","pos":[347,486]},{"content":"Therefore, binding to delegates becomes consistent with the binding already allowed for method invocations.","pos":[487,594]},{"pos":[603,629],"content":"Parameters and Return Type","linkify":"Parameters and Return Type","nodes":[{"content":"Parameters and Return Type","pos":[0,26]}]},{"pos":[633,769],"content":"In place of exact signature match, relaxed conversion requires that the following conditions be met when <ph id=\"ph1\">`Option Strict`</ph> is set to <ph id=\"ph2\">`On`</ph>:","source":"In place of exact signature match, relaxed conversion requires that the following conditions be met when `Option Strict` is set to `On`:"},{"content":"A widening conversion must exist from the data type of each delegate parameter to the data type of the corresponding parameter of the assigned function or <ph id=\"ph1\">`Sub`</ph>.","pos":[779,940],"source":"A widening conversion must exist from the data type of each delegate parameter to the data type of the corresponding parameter of the assigned function or `Sub`."},{"content":"In the following example, the delegate <ph id=\"ph1\">`Del1`</ph> has one parameter, an <ph id=\"ph2\">`Integer`</ph>.","pos":[941,1019],"source":" In the following example, the delegate `Del1` has one parameter, an `Integer`."},{"content":"Parameter <ph id=\"ph1\">`m`</ph> in the assigned lambda expressions must have a data type for which there is a widening conversion from <ph id=\"ph2\">`Integer`</ph>, such as <ph id=\"ph3\">`Long`</ph> or <ph id=\"ph4\">`Double`</ph>.","pos":[1020,1175],"source":" Parameter `m` in the assigned lambda expressions must have a data type for which there is a widening conversion from `Integer`, such as `Long` or `Double`."},{"pos":[1468,1546],"content":"Narrowing conversions are permitted only when <ph id=\"ph1\">`Option Strict`</ph> is set to <ph id=\"ph2\">`Off`</ph>.","source":"Narrowing conversions are permitted only when `Option Strict` is set to `Off`."},{"content":"A widening conversion must exist in the opposite direction from the return type of the assigned function or <ph id=\"ph1\">`Sub`</ph> to the return type of the delegate.","pos":[1697,1846],"source":"A widening conversion must exist in the opposite direction from the return type of the assigned function or `Sub` to the return type of the delegate."},{"content":"In the following examples, the body of each assigned lambda expression must evaluate to a data type that widens to <ph id=\"ph1\">`Integer`</ph> because the return type of <ph id=\"ph2\">`del1`</ph> is <ph id=\"ph3\">`Integer`</ph>.","pos":[1847,2019],"source":" In the following examples, the body of each assigned lambda expression must evaluate to a data type that widens to `Integer` because the return type of `del1` is `Integer`."},{"pos":[2167,2258],"content":"If <ph id=\"ph1\">`Option Strict`</ph> is set to <ph id=\"ph2\">`Off`</ph>, the widening restriction is removed in both directions.","source":"If `Option Strict` is set to `Off`, the widening restriction is removed in both directions."},{"pos":[2404,2437],"content":"Omitting Parameter Specifications","linkify":"Omitting Parameter Specifications","nodes":[{"content":"Omitting Parameter Specifications","pos":[0,33]}]},{"content":"Relaxed delegates also allow you to completely omit parameter specifications in the assigned method:","pos":[2441,2541]},{"content":"Note that you cannot specify some parameters and omit others.","pos":[2822,2883]},{"content":"The ability to omit parameters is helpful in a situation such as defining an event handler, where several complex parameters are involved.","pos":[3029,3167]},{"content":"The arguments to some event handlers are not used.","pos":[3168,3218]},{"content":"Instead, the handler directly accesses the state of the control on which the event is registered, and ignores the arguments.","pos":[3219,3343]},{"content":"Relaxed delegates allow you to omit the arguments in such declarations when no ambiguities result.","pos":[3344,3442]},{"content":"In the following example, the fully specified method <ph id=\"ph1\">`OnClick`</ph> can be rewritten as <ph id=\"ph2\">`RelaxedOnClick`</ph>.","pos":[3443,3543],"source":" In the following example, the fully specified method `OnClick` can be rewritten as `RelaxedOnClick`."},{"pos":[3809,3827],"content":"AddressOf Examples","linkify":"AddressOf Examples","nodes":[{"content":"AddressOf Examples","pos":[0,18]}]},{"content":"Lambda expressions are used in the previous examples to make the type relationships easy to see.","pos":[3831,3927]},{"content":"However, the same relaxations are permitted for delegate assignments that use <ph id=\"ph1\">`AddressOf`</ph>, <ph id=\"ph2\">`Handles`</ph>, or <ph id=\"ph3\">`AddHandler`</ph>.","pos":[3928,4046],"source":" However, the same relaxations are permitted for delegate assignments that use `AddressOf`, `Handles`, or `AddHandler`."},{"pos":[4053,4146],"content":"In the following example, functions <ph id=\"ph1\">`f1`</ph>, <ph id=\"ph2\">`f2`</ph>, <ph id=\"ph3\">`f3`</ph>, and <ph id=\"ph4\">`f4`</ph> can all be assigned to <ph id=\"ph5\">`Del1`</ph>.","source":"In the following example, functions `f1`, `f2`, `f3`, and `f4` can all be assigned to `Del1`."},{"pos":[4564,4637],"content":"The following example is valid only when <ph id=\"ph1\">`Option Strict`</ph> is set to <ph id=\"ph2\">`Off`</ph>.","source":"The following example is valid only when `Option Strict` is set to `Off`."},{"pos":[4785,4810],"content":"Dropping Function Returns","linkify":"Dropping Function Returns","nodes":[{"content":"Dropping Function Returns","pos":[0,25]}]},{"content":"Relaxed delegate conversion enables you to assign a function to a <ph id=\"ph1\">`Sub`</ph> delegate, effectively ignoring the return value of the function.","pos":[4814,4950],"source":"Relaxed delegate conversion enables you to assign a function to a `Sub` delegate, effectively ignoring the return value of the function."},{"content":"However, you cannot assign a <ph id=\"ph1\">`Sub`</ph> to a function delegate.","pos":[4951,5009],"source":" However, you cannot assign a `Sub` to a function delegate."},{"content":"In the following example, the address of function <ph id=\"ph1\">`doubler`</ph> is assigned to <ph id=\"ph2\">`Sub`</ph> delegate <ph id=\"ph3\">`Del3`</ph>.","pos":[5010,5107],"source":" In the following example, the address of function `doubler` is assigned to `Sub` delegate `Del3`."},{"pos":[5394,5402],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5406,5521],"content":"<bpt id=\"p1\">[</bpt>Lambda Expressions<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)</ept>","source":"[Lambda Expressions](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)"},{"pos":[5524,5671],"content":"<bpt id=\"p1\">[</bpt>Widening and Narrowing Conversions<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)</ept>","source":"[Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)"},{"pos":[5674,5766],"content":"<bpt id=\"p1\">[</bpt>Delegates<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/delegates/index.md)</ept>","source":"[Delegates](../../../../visual-basic/programming-guide/language-features/delegates/index.md)"},{"pos":[5769,5950],"content":"<bpt id=\"p1\">[</bpt>How to: Pass Procedures to Another Procedure in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md)</ept>","source":"[How to: Pass Procedures to Another Procedure in Visual Basic](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md)"},{"pos":[5953,6071],"content":"<bpt id=\"p1\">[</bpt>Local Type Inference<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)</ept>","source":"[Local Type Inference](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)"},{"pos":[6074,6182],"content":"<bpt id=\"p1\">[</bpt>Option Strict Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/option-strict-statement.md)</ept>","source":"[Option Strict Statement](../../../../visual-basic/language-reference/statements/option-strict-statement.md)"}]}