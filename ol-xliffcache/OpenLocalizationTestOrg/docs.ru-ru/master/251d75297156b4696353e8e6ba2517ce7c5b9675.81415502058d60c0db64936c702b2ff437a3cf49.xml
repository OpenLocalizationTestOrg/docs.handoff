{"content":"---\ntitle: \"GetVersionFromProcess Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"GetVersionFromProcess\"\napi_location: \n  - \"mscoree.dll\"\n  - \"mscoreei.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"GetVersionFromProcess\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetVersionFromProcess function [.NET Framework hosting]\"\nms.assetid: a9f7f824-64a1-408d-8607-91c7f19d21fe\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 20\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# GetVersionFromProcess Function\nGets the version number of the common language runtime (CLR) that is associated with the specified process handle.  \n  \n This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)].  \n  \n## Syntax  \n  \n```  \nHRESULT GetVersionFromProcess (  \n    [in]  HANDLE  hProcess,   \n    [out] LPWSTR  pVersion,   \n    [in]  DWORD   cchBuffer,   \n    [out] DWORD  *dwLength  \n);  \n```  \n  \n#### Parameters  \n `hProcess`  \n [in] A handle to a process.  \n  \n `pVersion`  \n [out] A buffer that contains the version number string upon successful completion of the method.  \n  \n `cchBuffer`  \n [in] The length of the version buffer.  \n  \n `pdwLength`  \n [out] A pointer to the length of the version number string.  \n  \n## Return Value  \n This method returns standard Component Object Model (COM) error codes, as defined in WinError.h, in addition to the following values.  \n  \n|Return code|Description|  \n|-----------------|-----------------|  \n|S_OK|The method completed successfully.|  \n|E_INVALIDARG|`pVersion` is null and `cchBuffer` is not null, or vice versa.<br /><br /> -or-<br /><br /> `hProcess` is not a valid handle to a process.<br /><br /> -or-<br /><br /> The CLR is not loaded.|  \n|ERROR_INSUFFICIENT_BUFFER|`cchBuffer` is null or less than the length of the version string.|  \n|E_NOTIMPL|This method is not available on the Microsoft Windows 95, Microsoft Windows 98, or Microsoft Windows Millennium Edition operating system.|  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See Also  \n [GetRequestedRuntimeInfo Function](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md)   \n [GetRequestedRuntimeVersion Function](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md)   \n [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)","nodes":[{"pos":[12,59],"content":"GetVersionFromProcess Function | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"GetVersionFromProcess Function | Microsoft Docs","pos":[0,47]}]},{"pos":[657,687],"content":"GetVersionFromProcess Function","linkify":"GetVersionFromProcess Function","nodes":[{"content":"GetVersionFromProcess Function","pos":[0,30]}]},{"content":"Gets the version number of the common language runtime (CLR) that is associated with the specified process handle.","pos":[688,802]},{"pos":[809,916],"content":"This function has been deprecated in the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph>.","source":"This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]."},{"pos":[925,931],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1119,1129],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A handle to a process.","pos":[1147,1174]},{"content":"[out] A buffer that contains the version number string upon successful completion of the method.","pos":[1195,1291]},{"content":"[in] The length of the version buffer.","pos":[1313,1351]},{"content":"[out] A pointer to the length of the version number string.","pos":[1373,1432]},{"pos":[1441,1453],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns standard Component Object Model (COM) error codes, as defined in WinError.h, in addition to the following values.","pos":[1457,1590]},{"content":"Return code","pos":[1597,1608]},{"content":"Description","pos":[1609,1620]},{"content":"S_OK","pos":[1665,1669]},{"content":"The method completed successfully.","pos":[1670,1704]},{"content":"E_INVALIDARG","pos":[1709,1721]},{"content":"<ph id=\"ph1\">`pVersion`</ph> is null and <ph id=\"ph2\">`cchBuffer`</ph> is not null, or vice versa.","pos":[1722,1784],"source":"`pVersion` is null and `cchBuffer` is not null, or vice versa."},{"content":"-or-","pos":[1797,1801]},{"content":"<ph id=\"ph1\">`hProcess`</ph> is not a valid handle to a process.","pos":[1814,1860],"source":"`hProcess` is not a valid handle to a process."},{"content":"-or-","pos":[1873,1877]},{"content":"The CLR is not loaded.","pos":[1890,1912]},{"content":"ERROR_INSUFFICIENT_BUFFER","pos":[1917,1942]},{"pos":[1943,2009],"content":"<ph id=\"ph1\">`cchBuffer`</ph> is null or less than the length of the version string.","source":"`cchBuffer` is null or less than the length of the version string."},{"content":"E_NOTIMPL","pos":[2014,2023]},{"content":"This method is not available on the Microsoft Windows 95, Microsoft Windows 98, or Microsoft Windows Millennium Edition operating system.","pos":[2024,2161]},{"pos":[2171,2183],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2187,2291],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2298,2319],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2326,2350],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> MSCorEE.dll","source":"**Library:** MSCorEE.dll"},{"pos":[2357,2465],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[2474,2482],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>GetRequestedRuntimeInfo Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md)</ept><ph id=\"ph1\"> </ph>","pos":[2486,2607],"source":"[GetRequestedRuntimeInfo Function](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md) "},{"content":"<bpt id=\"p1\"> [</bpt>GetRequestedRuntimeVersion Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md)</ept><ph id=\"ph1\"> </ph>","pos":[2610,2738],"source":" [GetRequestedRuntimeVersion Function](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Deprecated CLR Hosting Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)</ept>","pos":[2741,2862],"source":" [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)"}]}