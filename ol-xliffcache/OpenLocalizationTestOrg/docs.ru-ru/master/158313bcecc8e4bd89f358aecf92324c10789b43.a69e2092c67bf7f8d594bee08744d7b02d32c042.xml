{"content":"---\ntitle: \"How to: Handle Multiple Events Using Event Properties\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"event properties [.NET Framework]\"\n  - \"multiple events [.NET Framework]\"\n  - \"event handling [.NET Framework], with multiple events\"\n  - \"events [.NET Framework], multiple\"\nms.assetid: 30047cba-e2fd-41c6-b9ca-2ad7a49003db\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# How to: Handle Multiple Events Using Event Properties\nTo use event properties, you define the event properties in the class that raises the events, and then set the delegates for the event properties in classes that handle the events. To implement multiple event properties in a class, the class must internally store and maintain the delegate defined for each event. A typical approach is to implement a delegate collection that is indexed by an event key.  \n  \n To store the delegates for each event, you can use the <xref:System.ComponentModel.EventHandlerList> class, or implement your own collection. The collection class must provide methods for setting, accessing, and retrieving the event handler delegate based on the event key. For example, you could use a <xref:System.Collections.Hashtable> class, or derive a custom class from the <xref:System.Collections.DictionaryBase> class. The implementation details of the delegate collection do not need to be exposed outside your class.  \n  \n Each event property within the class defines an add accessor method and a remove accessor method. The add accessor for an event property adds the input delegate instance to the delegate collection. The remove accessor for an event property removes the input delegate instance from the delegate collection. The event property accessors use the predefined key for the event property to add and remove instances from the delegate collection.  \n  \n### To handle multiple events using event properties  \n  \n1.  Define a delegate collection within the class that raises the events.  \n  \n2.  Define a key for each event.  \n  \n3.  Define the event properties in the class that raises the events.  \n  \n4.  Use the delegate collection to implement the add and remove accessor methods for the event properties.  \n  \n5.  Use the public event properties to add and remove event handler delegates in the classes that handle the events.  \n  \n## Example  \n The following C# example implements the event properties `MouseDown` and `MouseUp`, using an <xref:System.ComponentModel.EventHandlerList> to store each event's delegate. The keywords of the event property constructs are in bold type.  \n  \n> [!NOTE]\n>  Event properties are not supported in [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)].  \n  \n [!code-cpp[Conceptual.Events.Other#31](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.events.other/cpp/example3.cpp#31)]\n [!code-csharp[Conceptual.Events.Other#31](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.events.other/cs/example3.cs#31)]\n [!code-vb[Conceptual.Events.Other#31](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.events.other/vb/example3.vb#31)]  \n  \n## See also\n\n- <xref:System.ComponentModel.EventHandlerList?displayProperty=nameWithType>\n- [Events](../../../docs/standard/events/index.md)\n- <xref:System.Web.UI.Control.Events%2A>\n- [How to: Declare Custom Events To Conserve Memory](~/docs/visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md)\n","nodes":[{"pos":[4,453],"embed":true,"restype":"x-metadata","content":"title: \"How to: Handle Multiple Events Using Event Properties\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"event properties [.NET Framework]\"\n  - \"multiple events [.NET Framework]\"\n  - \"event handling [.NET Framework], with multiple events\"\n  - \"events [.NET Framework], multiple\"\nms.assetid: 30047cba-e2fd-41c6-b9ca-2ad7a49003db\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"How to: Handle Multiple Events Using Event Properties","nodes":[{"pos":[0,53],"content":"How to: Handle Multiple Events Using Event Properties","nodes":[{"content":"How to: Handle Multiple Events Using Event Properties","pos":[0,53]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[460,513],"content":"How to: Handle Multiple Events Using Event Properties","linkify":"How to: Handle Multiple Events Using Event Properties","nodes":[{"content":"How to: Handle Multiple Events Using Event Properties","pos":[0,53]}]},{"content":"To use event properties, you define the event properties in the class that raises the events, and then set the delegates for the event properties in classes that handle the events.","pos":[514,694]},{"content":"To implement multiple event properties in a class, the class must internally store and maintain the delegate defined for each event.","pos":[695,827]},{"content":"A typical approach is to implement a delegate collection that is indexed by an event key.","pos":[828,917]},{"content":"To store the delegates for each event, you can use the <ph id=\"ph1\">&lt;xref:System.ComponentModel.EventHandlerList&gt;</ph> class, or implement your own collection.","pos":[924,1065],"source":"To store the delegates for each event, you can use the <xref:System.ComponentModel.EventHandlerList> class, or implement your own collection."},{"content":"The collection class must provide methods for setting, accessing, and retrieving the event handler delegate based on the event key.","pos":[1066,1197]},{"content":"For example, you could use a <ph id=\"ph1\">&lt;xref:System.Collections.Hashtable&gt;</ph> class, or derive a custom class from the <ph id=\"ph2\">&lt;xref:System.Collections.DictionaryBase&gt;</ph> class.","pos":[1198,1351],"source":" For example, you could use a <xref:System.Collections.Hashtable> class, or derive a custom class from the <xref:System.Collections.DictionaryBase> class."},{"content":"The implementation details of the delegate collection do not need to be exposed outside your class.","pos":[1352,1451]},{"content":"Each event property within the class defines an add accessor method and a remove accessor method.","pos":[1458,1555]},{"content":"The add accessor for an event property adds the input delegate instance to the delegate collection.","pos":[1556,1655]},{"content":"The remove accessor for an event property removes the input delegate instance from the delegate collection.","pos":[1656,1763]},{"content":"The event property accessors use the predefined key for the event property to add and remove instances from the delegate collection.","pos":[1764,1896]},{"pos":[1906,1954],"content":"To handle multiple events using event properties","linkify":"To handle multiple events using event properties","nodes":[{"content":"To handle multiple events using event properties","pos":[0,48]}]},{"content":"Define a delegate collection within the class that raises the events.","pos":[1964,2033]},{"content":"Define a key for each event.","pos":[2043,2071]},{"content":"Define the event properties in the class that raises the events.","pos":[2081,2145]},{"content":"Use the delegate collection to implement the add and remove accessor methods for the event properties.","pos":[2155,2257]},{"content":"Use the public event properties to add and remove event handler delegates in the classes that handle the events.","pos":[2267,2379]},{"pos":[2388,2395],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following C# example implements the event properties <ph id=\"ph1\">`MouseDown`</ph> and <ph id=\"ph2\">`MouseUp`</ph>, using an <ph id=\"ph3\">&lt;xref:System.ComponentModel.EventHandlerList&gt;</ph> to store each event's delegate.","pos":[2399,2569],"source":"The following C# example implements the event properties `MouseDown` and `MouseUp`, using an <xref:System.ComponentModel.EventHandlerList> to store each event's delegate."},{"content":"The keywords of the event property constructs are in bold type.","pos":[2570,2633]},{"pos":[2641,2749],"content":"[!NOTE]\n Event properties are not supported in [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)].","leadings":["","> "],"nodes":[{"content":"Event properties are not supported in <ph id=\"ph1\">[!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)]</ph>.","pos":[9,106],"source":"Event properties are not supported in [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)]."}]},{"pos":[3168,3176],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3257,3305],"content":"<bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../docs/standard/events/index.md)</ept>","source":"[Events](../../../docs/standard/events/index.md)"},{"pos":[3349,3514],"content":"<bpt id=\"p1\">[</bpt>How to: Declare Custom Events To Conserve Memory<ept id=\"p1\">](~/docs/visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md)</ept>","source":"[How to: Declare Custom Events To Conserve Memory](~/docs/visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md)"}]}