{"content":"---\ntitle: \"ICLRMetaHost::GetRuntime Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICLRMetaHost.GetRuntime\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRMetaHost::GetRuntime\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetRuntime method [.NET Framework hosting]\"\n  - \"ICLRMetaHost::GetRuntime method [.NET Framework hosting]\"\nms.assetid: a10749f1-ab91-47cf-982f-d8ccd2e81bd2\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 31\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# ICLRMetaHost::GetRuntime Method\nGets the [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface that corresponds to a particular version of the common language runtime (CLR). This method supersedes the [CorBindToRuntimeEx](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md) function used with the [STARTUP_LOADER_SAFEMODE](../../../../docs/framework/unmanaged-api/hosting/startup-flags-enumeration.md) flag.  \n  \n## Syntax  \n  \n```  \nHRESULT GetRuntime (  \n    [in] LPCWSTR pwzVersion,  \n    [in, REFIID riid,  \n    [out,iid_is(riid), retval] LPVOID *ppRuntime  \n);  \n```  \n  \n#### Parameters  \n `pwzVersion`  \n [in] The .NET Framework compilation version stored in the metadata, in the format \"v*A*.*B*[.*X*]\". *A*, *B*, and *X* are decimal numbers that correspond to the major version, the minor version, and the build number.  \n  \n> [!NOTE]\n>  This parameter must match the directory name for the .NET Framework version, as it appears under C:\\Windows\\Microsoft.NET\\Framework or C:\\Windows\\Microsoft.NET\\Framework64.  \n  \n Example values are \"v1.0.3705\", \"v1.1.4322\", \"v2.0.50727\", and \"v4.0.*X*\", where *X* depends on the build number installed. The \"v\" prefix is required.  \n  \n `riid`  \n [in] The identifier for the desired interface. Currently, the only valid value for this parameter is IID_ICLRRuntimeInfo.  \n  \n `ppRuntime`  \n [out] A pointer to the [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface that corresponds to the requested runtime.  \n  \n## Return Value  \n This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|The method completed successfully.|  \n|E_POINTER|`pwzVersion` or `ppRuntime` is null.|  \n  \n## Remarks  \n This method interacts consistently with legacy interfaces such as the [ICorRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md) interface and legacy functions such as the deprecated `CorBindTo*` functions (see [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md) in the .NET Framework 2.0 hosting API). That is, runtimes that are loaded with the legacy API are visible to the new API, and runtimes that are loaded with the new API are visible to the legacy API. .  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MetaHost.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See Also  \n [ICLRMetaHost Interface](../../../../docs/framework/unmanaged-api/hosting/iclrmetahost-interface.md)   \n [Deprecated CLR Hosting Interfaces and Coclasses](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-interfaces-and-coclasses.md)   \n [CLR Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/clr-hosting-interfaces.md)   \n [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)   \n [Hosting](../../../../docs/framework/unmanaged-api/hosting/index.md)","nodes":[{"pos":[12,60],"content":"ICLRMetaHost::GetRuntime Method | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ICLRMetaHost::GetRuntime Method | Microsoft Docs","pos":[0,48]}]},{"pos":[688,719],"content":"ICLRMetaHost::GetRuntime Method","linkify":"ICLRMetaHost::GetRuntime Method","nodes":[{"content":"ICLRMetaHost::GetRuntime Method","pos":[0,31]}]},{"content":"Gets the <bpt id=\"p1\">[</bpt>ICLRRuntimeInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md)</ept> interface that corresponds to a particular version of the common language runtime (CLR).","pos":[720,914],"source":"Gets the [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface that corresponds to a particular version of the common language runtime (CLR)."},{"content":"This method supersedes the <bpt id=\"p1\">[</bpt>CorBindToRuntimeEx<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)</ept> function used with the <bpt id=\"p2\">[</bpt>STARTUP_LOADER_SAFEMODE<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/hosting/startup-flags-enumeration.md)</ept> flag.","pos":[915,1177],"source":" This method supersedes the [CorBindToRuntimeEx](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md) function used with the [STARTUP_LOADER_SAFEMODE](../../../../docs/framework/unmanaged-api/hosting/startup-flags-enumeration.md) flag."},{"pos":[1186,1192],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1352,1362],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The .NET Framework compilation version stored in the metadata, in the format \"v<bpt id=\"p1\">*</bpt>A<ept id=\"p1\">*</ept>.<bpt id=\"p2\">*</bpt>B<ept id=\"p2\">*</ept>[.<bpt id=\"p3\">*</bpt>X<ept id=\"p3\">*</ept>]\".","pos":[1382,1481],"source":" [in] The .NET Framework compilation version stored in the metadata, in the format \"v*A*.*B*[.*X*]\"."},{"content":"<bpt id=\"p1\">*</bpt>A<ept id=\"p1\">*</ept>, <bpt id=\"p2\">*</bpt>B<ept id=\"p2\">*</ept>, and <bpt id=\"p3\">*</bpt>X<ept id=\"p3\">*</ept> are decimal numbers that correspond to the major version, the minor version, and the build number.","pos":[1482,1598],"source":"*A*, *B*, and *X* are decimal numbers that correspond to the major version, the minor version, and the build number."},{"pos":[1606,1789],"content":"[!NOTE]\n This parameter must match the directory name for the .NET Framework version, as it appears under C:\\Windows\\Microsoft.NET\\Framework or C:\\Windows\\Microsoft.NET\\Framework64.","leadings":["","> "],"nodes":[{"content":"This parameter must match the directory name for the .NET Framework version, as it appears under C:\\Windows\\Microsoft.NET\\Framework or C:\\Windows\\Microsoft.NET\\Framework64.","pos":[9,181]}]},{"content":"Example values are \"v1.0.3705\", \"v1.1.4322\", \"v2.0.50727\", and \"v4.0.<bpt id=\"p1\">*</bpt>X<ept id=\"p1\">*</ept>\", where <bpt id=\"p2\">*</bpt>X<ept id=\"p2\">*</ept> depends on the build number installed.","pos":[1796,1919],"source":"Example values are \"v1.0.3705\", \"v1.1.4322\", \"v2.0.50727\", and \"v4.0.*X*\", where *X* depends on the build number installed."},{"content":"The \"v\" prefix is required.","pos":[1920,1947]},{"content":"[in] The identifier for the desired interface.","pos":[1964,2010]},{"content":"Currently, the only valid value for this parameter is IID_ICLRRuntimeInfo.","pos":[2011,2085]},{"content":"[out] A pointer to the <bpt id=\"p1\">[</bpt>ICLRRuntimeInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md)</ept> interface that corresponds to the requested runtime.","pos":[2107,2279],"source":" [out] A pointer to the [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface that corresponds to the requested runtime."},{"pos":[2288,2300],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.","pos":[2304,2411]},{"content":"HRESULT","pos":[2418,2425]},{"content":"Description","pos":[2426,2437]},{"content":"S_OK","pos":[2478,2482]},{"content":"The method completed successfully.","pos":[2483,2517]},{"content":"E_POINTER","pos":[2522,2531]},{"pos":[2532,2568],"content":"<ph id=\"ph1\">`pwzVersion`</ph> or <ph id=\"ph2\">`ppRuntime`</ph> is null.","source":"`pwzVersion` or `ppRuntime` is null."},{"pos":[2578,2585],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This method interacts consistently with legacy interfaces such as the <bpt id=\"p1\">[</bpt>ICorRuntimeHost<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md)</ept> interface and legacy functions such as the deprecated <ph id=\"ph1\">`CorBindTo*`</ph> functions (see <bpt id=\"p2\">[</bpt>Deprecated CLR Hosting Functions<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)</ept> in the .NET Framework 2.0 hosting API).","pos":[2589,2998],"source":"This method interacts consistently with legacy interfaces such as the [ICorRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md) interface and legacy functions such as the deprecated `CorBindTo*` functions (see [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md) in the .NET Framework 2.0 hosting API)."},{"content":"That is, runtimes that are loaded with the legacy API are visible to the new API, and runtimes that are loaded with the new API are visible to the legacy API.","pos":[2999,3157]},{"content":".","pos":[3158,3159]},{"pos":[3168,3180],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3184,3288],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3295,3317],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MetaHost.h","source":"**Header:** MetaHost.h"},{"pos":[3324,3374],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[3381,3489],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[3498,3506],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>ICLRMetaHost Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrmetahost-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[3510,3611],"source":"[ICLRMetaHost Interface](../../../../docs/framework/unmanaged-api/hosting/iclrmetahost-interface.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Deprecated CLR Hosting Interfaces and Coclasses<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-interfaces-and-coclasses.md)</ept><ph id=\"ph1\"> </ph>","pos":[3614,3766],"source":" [Deprecated CLR Hosting Interfaces and Coclasses](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-interfaces-and-coclasses.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CLR Hosting Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/clr-hosting-interfaces.md)</ept><ph id=\"ph1\"> </ph>","pos":[3769,3871],"source":" [CLR Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/clr-hosting-interfaces.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Deprecated CLR Hosting Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)</ept><ph id=\"ph1\"> </ph>","pos":[3874,3996],"source":" [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hosting<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/index.md)</ept>","pos":[3999,4068],"source":" [Hosting](../../../../docs/framework/unmanaged-api/hosting/index.md)"}]}