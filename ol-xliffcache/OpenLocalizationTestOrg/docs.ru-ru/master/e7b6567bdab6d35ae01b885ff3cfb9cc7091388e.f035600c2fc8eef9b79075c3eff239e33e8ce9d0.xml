{"content":"---\ntitle: \"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"hosting WPF content in Windows Forms\"\n  - \"composite controls, hosting WPF in\"\nms.assetid: 486369a9-606a-4a3b-b086-a06f2119c7b0\ncaps.latest.revision: 23\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms\nThis walkthrough demonstrates how you can create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control and host it in [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls and forms by using the <xref:System.Windows.Forms.Integration.ElementHost> control.  \n  \n In this walkthrough, you will implement a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl> that contains two child controls. The <xref:System.Windows.Controls.UserControl> displays a three-dimensional (3-D) cone. Rendering 3-D objects is much easier with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] than with [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]. Therefore, it makes sense to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl> class to create 3-D graphics in [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)].  \n  \n Tasks illustrated in this walkthrough include:  \n  \n-   Creating the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl>.  \n  \n-   Creating the Windows Forms host project.  \n  \n-   Hosting the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl>.  \n  \n For a complete code listing of the tasks illustrated in this walkthrough, see [Hosting a 3-D WPF Composite Control in Windows Forms Sample](http://go.microsoft.com/fwlink/?LinkID=160001).  \n  \n## Prerequisites  \n You need the following components to complete this walkthrough:  \n  \n-   [!INCLUDE[vs_orcas_long](../../../../includes/vs-orcas-long-md.md)].  \n  \n<a name=\"To_Create_the_UserControl\"></a>   \n## Creating the UserControl  \n  \n#### To create the UserControl  \n  \n1.  Create a WPF User Control Library project named `HostingWpfUserControlInWf`.  \n  \n2.  Open UserControl1.xaml in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)].  \n  \n3.  Replace the generated code with the following code.  \n  \n     This code defines a <xref:System.Windows.Controls.UserControl?displayProperty=fullName> that contains two child controls. The first child control is a <xref:System.Windows.Controls.Label?displayProperty=fullName> control; the second is a <xref:System.Windows.Controls.Viewport3D> control that displays a 3-D cone.  \n  \n     [!code-xml[HostingWpfUserControlInWf#1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingWpfUserControlInWf/CSharp/HostingWpfUserControlInWf/ConeControl.xaml#1)]  \n  \n<a name=\"To_Create_the_Windows_Forms_Host_Project\"></a>   \n## Creating the Windows Forms Host Project  \n  \n#### To create the host project  \n  \n1.  Add a Windows application project named `WpfUserControlHost` to the solution. For more information, see [How to: Create a New WPF Application Project](http://msdn.microsoft.com/en-us/1f6aea7a-33e1-4d3f-8555-1daa42e95d82).  \n  \n2.  In Solution Explorer, add a reference to the WindowsFormsIntegration assembly, which is named WindowsFormsIntegration.dll.  \n  \n3.  Add references to the following [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] assemblies:  \n  \n    -   PresentationCore  \n  \n    -   PresentationFramework  \n  \n    -   WindowsBase  \n  \n4.  Add a reference to the `HostingWpfUserControlInWf` project.  \n  \n5.  In Solution Explorer, set the `WpfUserControlHost` project to be the startup project.  \n  \n<a name=\"To_Host_the_Windows_Presentation_Foundation\"></a>   \n## Hosting the Windows Presentation Foundation UserControl  \n  \n#### To host the UserControl  \n  \n1.  In the Windows Forms Designer, open Form1.  \n  \n2.  In the Properties window, click **Events**, and then double-click the <xref:System.Windows.Forms.Form.Load> event to create an event handler.  \n  \n     The Code Editor opens to the newly generated `Form1_Load` event handler.  \n  \n3.  Replace the code in Form1.cs with the following code.  \n  \n     The `Form1_Load` event handler creates an instance of `UserControl1` and adds itto the <xref:System.Windows.Forms.Integration.ElementHost> control's collection of child controls. The <xref:System.Windows.Forms.Integration.ElementHost> control is added to the form's collection of child controls.  \n  \n     [!code-csharp[HostingWpfUserControlInWf#10](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingWpfUserControlInWf/CSharp/WpfUserControlHost/Form1.cs#10)]\n     [!code-vb[HostingWpfUserControlInWf#10](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HostingWpfUserControlInWf/VisualBasic/WpfUserControlHost/Form1.vb#10)]  \n  \n4.  Press F5 to build and run the application.  \n  \n## See Also  \n <xref:System.Windows.Forms.Integration.ElementHost>   \n <xref:System.Windows.Forms.Integration.WindowsFormsHost>   \n [WPF Designer](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)   \n [Walkthrough: Hosting a WPF Composite Control in Windows Forms](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)   \n [Walkthrough: Hosting a Windows Forms Composite Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)   \n [Hosting a WPF Composite Control in Windows Forms Sample](http://go.microsoft.com/fwlink/?LinkID=160001)","nodes":[{"pos":[4,501],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"hosting WPF content in Windows Forms\"\n  - \"composite controls, hosting WPF in\"\nms.assetid: 486369a9-606a-4a3b-b086-a06f2119c7b0\ncaps.latest.revision: 23\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms | Microsoft Docs","nodes":[{"pos":[0,82],"content":"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms | Microsoft Docs","nodes":[{"content":"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms | Microsoft Docs","pos":[0,82]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[508,573],"content":"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms","linkify":"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms","nodes":[{"content":"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms","pos":[0,65]}]},{"pos":[574,910],"content":"This walkthrough demonstrates how you can create a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> composite control and host it in <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls and forms by using the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control.","source":"This walkthrough demonstrates how you can create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control and host it in [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls and forms by using the <xref:System.Windows.Forms.Integration.ElementHost> control."},{"content":"In this walkthrough, you will implement a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> that contains two child controls.","pos":[917,1117],"source":"In this walkthrough, you will implement a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl> that contains two child controls."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> displays a three-dimensional (3-D) cone.","pos":[1118,1205],"source":" The <xref:System.Windows.Controls.UserControl> displays a three-dimensional (3-D) cone."},{"content":"Rendering 3-D objects is much easier with the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> than with <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph>.","pos":[1206,1422],"source":" Rendering 3-D objects is much easier with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] than with [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]."},{"content":"Therefore, it makes sense to host a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> class to create 3-D graphics in <ph id=\"ph3\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph>.","pos":[1423,1694],"source":" Therefore, it makes sense to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl> class to create 3-D graphics in [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]."},{"content":"Tasks illustrated in this walkthrough include:","pos":[1701,1747]},{"pos":[1757,1895],"content":"Creating the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph>.","source":"Creating the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl>."},{"content":"Creating the Windows Forms host project.","pos":[1905,1945]},{"pos":[1955,2092],"content":"Hosting the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph>.","source":"Hosting the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl>."},{"pos":[2099,2286],"content":"For a complete code listing of the tasks illustrated in this walkthrough, see <bpt id=\"p1\">[</bpt>Hosting a 3-D WPF Composite Control in Windows Forms Sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=160001)</ept>.","source":"For a complete code listing of the tasks illustrated in this walkthrough, see [Hosting a 3-D WPF Composite Control in Windows Forms Sample](http://go.microsoft.com/fwlink/?LinkID=160001)."},{"pos":[2295,2308],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to complete this walkthrough:","pos":[2312,2375]},{"pos":[2385,2453],"content":"<ph id=\"ph1\">[!INCLUDE[vs_orcas_long](../../../../includes/vs-orcas-long-md.md)]</ph>.","source":"[!INCLUDE[vs_orcas_long](../../../../includes/vs-orcas-long-md.md)]."},{"pos":[2506,2530],"content":"Creating the UserControl","linkify":"Creating the UserControl","nodes":[{"content":"Creating the UserControl","pos":[0,24]}]},{"pos":[2541,2566],"content":"To create the UserControl","linkify":"To create the UserControl","nodes":[{"content":"To create the UserControl","pos":[0,25]}]},{"pos":[2576,2652],"content":"Create a WPF User Control Library project named <ph id=\"ph1\">`HostingWpfUserControlInWf`</ph>.","source":"Create a WPF User Control Library project named `HostingWpfUserControlInWf`."},{"pos":[2662,2784],"content":"Open UserControl1.xaml in the <ph id=\"ph1\">[!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]</ph>.","source":"Open UserControl1.xaml in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]."},{"content":"Replace the generated code with the following code.","pos":[2794,2845]},{"content":"This code defines a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.UserControl?displayProperty=fullName&gt;</ph> that contains two child controls.","pos":[2856,2977],"source":"This code defines a <xref:System.Windows.Controls.UserControl?displayProperty=fullName> that contains two child controls."},{"content":"The first child control is a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Label?displayProperty=fullName&gt;</ph> control; the second is a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Viewport3D&gt;</ph> control that displays a 3-D cone.","pos":[2978,3169],"source":" The first child control is a <xref:System.Windows.Controls.Label?displayProperty=fullName> control; the second is a <xref:System.Windows.Controls.Viewport3D> control that displays a 3-D cone."},{"pos":[3419,3458],"content":"Creating the Windows Forms Host Project","linkify":"Creating the Windows Forms Host Project","nodes":[{"content":"Creating the Windows Forms Host Project","pos":[0,39]}]},{"pos":[3469,3495],"content":"To create the host project","linkify":"To create the host project","nodes":[{"content":"To create the host project","pos":[0,26]}]},{"content":"Add a Windows application project named <ph id=\"ph1\">`WpfUserControlHost`</ph> to the solution.","pos":[3505,3582],"source":"Add a Windows application project named `WpfUserControlHost` to the solution."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Create a New WPF Application Project<ept id=\"p1\">](http://msdn.microsoft.com/en-us/1f6aea7a-33e1-4d3f-8555-1daa42e95d82)</ept>.","pos":[3583,3726],"source":" For more information, see [How to: Create a New WPF Application Project](http://msdn.microsoft.com/en-us/1f6aea7a-33e1-4d3f-8555-1daa42e95d82)."},{"content":"In Solution Explorer, add a reference to the WindowsFormsIntegration assembly, which is named WindowsFormsIntegration.dll.","pos":[3736,3858]},{"pos":[3868,3993],"content":"Add references to the following <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> assemblies:","source":"Add references to the following [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] assemblies:"},{"content":"PresentationCore","pos":[4007,4023]},{"content":"PresentationFramework","pos":[4037,4058]},{"content":"WindowsBase","pos":[4072,4083]},{"pos":[4093,4152],"content":"Add a reference to the <ph id=\"ph1\">`HostingWpfUserControlInWf`</ph> project.","source":"Add a reference to the `HostingWpfUserControlInWf` project."},{"pos":[4162,4247],"content":"In Solution Explorer, set the <ph id=\"ph1\">`WpfUserControlHost`</ph> project to be the startup project.","source":"In Solution Explorer, set the `WpfUserControlHost` project to be the startup project."},{"pos":[4318,4373],"content":"Hosting the Windows Presentation Foundation UserControl","linkify":"Hosting the Windows Presentation Foundation UserControl","nodes":[{"content":"Hosting the Windows Presentation Foundation UserControl","pos":[0,55]}]},{"pos":[4384,4407],"content":"To host the UserControl","linkify":"To host the UserControl","nodes":[{"content":"To host the UserControl","pos":[0,23]}]},{"content":"In the Windows Forms Designer, open Form1.","pos":[4417,4459]},{"pos":[4469,4610],"content":"In the Properties window, click <bpt id=\"p1\">**</bpt>Events<ept id=\"p1\">**</ept>, and then double-click the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.Load&gt;</ph> event to create an event handler.","source":"In the Properties window, click **Events**, and then double-click the <xref:System.Windows.Forms.Form.Load> event to create an event handler."},{"pos":[4621,4693],"content":"The Code Editor opens to the newly generated <ph id=\"ph1\">`Form1_Load`</ph> event handler.","source":"The Code Editor opens to the newly generated `Form1_Load` event handler."},{"content":"Replace the code in Form1.cs with the following code.","pos":[4703,4756]},{"content":"The <ph id=\"ph1\">`Form1_Load`</ph> event handler creates an instance of <ph id=\"ph2\">`UserControl1`</ph> and adds itto the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control's collection of child controls.","pos":[4767,4945],"source":"The `Form1_Load` event handler creates an instance of `UserControl1` and adds itto the <xref:System.Windows.Forms.Integration.ElementHost> control's collection of child controls."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control is added to the form's collection of child controls.","pos":[4946,5062],"source":" The <xref:System.Windows.Forms.Integration.ElementHost> control is added to the form's collection of child controls."},{"pos":[5073,5407],"content":"[!code-csharp[HostingWpfUserControlInWf#10](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingWpfUserControlInWf/CSharp/WpfUserControlHost/Form1.cs#10)]\n [!code-vb[HostingWpfUserControlInWf#10](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HostingWpfUserControlInWf/VisualBasic/WpfUserControlHost/Form1.vb#10)]","leadings":["","    "],"nodes":[]},{"content":"Press F5 to build and run the application.","pos":[5417,5459]},{"pos":[5468,5476],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph>","pos":[5480,5531],"source":"<xref:System.Windows.Forms.Integration.ElementHost> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph>","pos":[5536,5592],"source":"<xref:System.Windows.Forms.Integration.WindowsFormsHost> "},{"content":"<bpt id=\"p1\">[</bpt>WPF Designer<ept id=\"p1\">](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)</ept><ph id=\"ph1\"> </ph>","pos":[5597,5682],"source":"[WPF Designer](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a WPF Composite Control in Windows Forms<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)</ept><ph id=\"ph1\"> </ph>","pos":[5686,5855],"source":"[Walkthrough: Hosting a WPF Composite Control in Windows Forms](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Composite Control in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)</ept><ph id=\"ph1\"> </ph>","pos":[5859,6028],"source":"[Walkthrough: Hosting a Windows Forms Composite Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md) "},{"content":"<bpt id=\"p1\">[</bpt>Hosting a WPF Composite Control in Windows Forms Sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=160001)</ept>","pos":[6032,6136],"source":"[Hosting a WPF Composite Control in Windows Forms Sample](http://go.microsoft.com/fwlink/?LinkID=160001)"}]}