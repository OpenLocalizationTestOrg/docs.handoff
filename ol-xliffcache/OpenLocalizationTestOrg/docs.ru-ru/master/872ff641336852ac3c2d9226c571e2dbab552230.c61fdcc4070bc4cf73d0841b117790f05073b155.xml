{"content":"---\ntitle: \"How to: Determine the Active MDI Child | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"Clipboard, copying data to\"\n  - \"MDI, child windows\"\n  - \"child forms\"\n  - \"MDI, activating forms\"\n  - \"MDI, locating focus\"\nms.assetid: 33880ec3-0207-4c2b-a616-ff140443cc0f\ncaps.latest.revision: 12\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Determine the Active MDI Child\nOn occasion, you will want to provide a command that operates on the control that has focus on the currently active child form. For example, suppose you want to copy selected text from the child form's text box to the Clipboard. You would create a procedure that copies selected text to the Clipboard using the <xref:System.Windows.Forms.Control.Click> event of the Copy menu item on the standard Edit menu.  \n  \n Because an MDI application can have many instances of the same child form, the procedure needs to know which form to use. To specify the correct form, use the <xref:System.Windows.Forms.Form.ActiveMdiChild%2A> property, which returns the child form that has the focus or that was most recently active.  \n  \n When you have several controls on a form, you also need to specify which control is active. Like the <xref:System.Windows.Forms.Form.ActiveMdiChild%2A> property, the <xref:System.Windows.Forms.ContainerControl.ActiveControl%2A> property returns the control with the focus on the active child form. The procedure below illustrates a copy procedure that can be called from a child form menu, a menu on the MDI form, or a toolbar button.  \n  \n### To determine the active MDI child (to copy its text to the Clipboard)  \n  \n1.  Within a method, copy the text of the active control of the active child form to the Clipboard.  \n  \n    > [!NOTE]\n    >  This example assumes there is an MDI parent form (`Form1`) that has one or more MDI child windows containing a <xref:System.Windows.Forms.RichTextBox> control. For more information, see [Creating MDI Parent Forms](../../../../docs/framework/winforms/advanced/how-to-create-mdi-parent-forms.md).  \n  \n    ```vb  \n    Public Sub mniCopy_Click(ByVal sender As Object, _  \n       ByVal e As System.EventArgs) Handles mniCopy.Click  \n  \n       ' Determine the active child form.  \n       Dim activeChild As Form = Me.ActiveMDIChild  \n  \n       ' If there is an active child form, find the active control, which  \n       ' in this example should be a RichTextBox.  \n       If (Not activeChild Is Nothing) Then  \n          Dim theBox As RichTextBox = _  \n            TryCast(activeChild.ActiveControl, RichTextBox)  \n  \n          If (Not theBox Is Nothing) Then  \n             'Put selected text on Clipboard.  \n             Clipboard.SetDataObject(theBox.SelectedText)  \n          Else  \n             MessageBox.Show(\"You need to select a RichTextBox.\")  \n          End If  \n       End If  \n    End Sub  \n  \n    ```  \n  \n    ```csharp  \n    protected void mniCopy_Click (object sender, System.EventArgs e)  \n    {  \n       // Determine the active child form.  \n       Form activeChild = this.ActiveMdiChild;  \n  \n       // If there is an active child form, find the active control, which  \n       // in this example should be a RichTextBox.  \n       if (activeChild != null)  \n       {    \n          try  \n          {  \n             RichTextBox theBox = (RichTextBox)activeChild.ActiveControl;  \n             if (theBox != null)  \n             {  \n                // Put the selected text on the Clipboard.  \n                Clipboard.SetDataObject(theBox.SelectedText);  \n  \n             }  \n          }  \n          catch  \n          {  \n             MessageBox.Show(\"You need to select a RichTextBox.\");  \n          }  \n       }  \n    }  \n  \n    ```  \n  \n## See Also  \n [Multiple-Document Interface (MDI) Applications](../../../../docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md)   \n [How to: Create MDI Parent Forms](../../../../docs/framework/winforms/advanced/how-to-create-mdi-parent-forms.md)   \n [How to: Create MDI Child Forms](../../../../docs/framework/winforms/advanced/how-to-create-mdi-child-forms.md)   \n [How to: Send Data to the Active MDI Child](../../../../docs/framework/winforms/advanced/how-to-send-data-to-the-active-mdi-child.md)   \n [How to: Arrange MDI Child Forms](../../../../docs/framework/winforms/advanced/how-to-arrange-mdi-child-forms.md)","nodes":[{"pos":[4,550],"nodes":[{"content":"How to: Determine the Active MDI Child | Microsoft Docs","nodes":[{"pos":[0,55],"content":"How to: Determine the Active MDI Child | Microsoft Docs","nodes":[{"content":"How to: Determine the Active MDI Child | Microsoft Docs","pos":[0,55]}]}],"pos":[6,64],"yaml":true}],"content":"title: \"How to: Determine the Active MDI Child | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"Clipboard, copying data to\"\n  - \"MDI, child windows\"\n  - \"child forms\"\n  - \"MDI, activating forms\"\n  - \"MDI, locating focus\"\nms.assetid: 33880ec3-0207-4c2b-a616-ff140443cc0f\ncaps.latest.revision: 12\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","yamlblock":true},{"pos":[557,595],"content":"How to: Determine the Active MDI Child","linkify":"How to: Determine the Active MDI Child","nodes":[{"content":"How to: Determine the Active MDI Child","pos":[0,38]}]},{"content":"On occasion, you will want to provide a command that operates on the control that has focus on the currently active child form.","pos":[596,723]},{"content":"For example, suppose you want to copy selected text from the child form's text box to the Clipboard.","pos":[724,824]},{"content":"You would create a procedure that copies selected text to the Clipboard using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event of the Copy menu item on the standard Edit menu.","pos":[825,1003],"source":" You would create a procedure that copies selected text to the Clipboard using the <xref:System.Windows.Forms.Control.Click> event of the Copy menu item on the standard Edit menu."},{"content":"Because an MDI application can have many instances of the same child form, the procedure needs to know which form to use.","pos":[1010,1131]},{"content":"To specify the correct form, use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.ActiveMdiChild%2A&gt;</ph> property, which returns the child form that has the focus or that was most recently active.","pos":[1132,1311],"source":" To specify the correct form, use the <xref:System.Windows.Forms.Form.ActiveMdiChild%2A> property, which returns the child form that has the focus or that was most recently active."},{"content":"When you have several controls on a form, you also need to specify which control is active.","pos":[1318,1409]},{"content":"Like the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.ActiveMdiChild%2A&gt;</ph> property, the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ContainerControl.ActiveControl%2A&gt;</ph> property returns the control with the focus on the active child form.","pos":[1410,1615],"source":" Like the <xref:System.Windows.Forms.Form.ActiveMdiChild%2A> property, the <xref:System.Windows.Forms.ContainerControl.ActiveControl%2A> property returns the control with the focus on the active child form."},{"content":"The procedure below illustrates a copy procedure that can be called from a child form menu, a menu on the MDI form, or a toolbar button.","pos":[1616,1752]},{"pos":[1762,1831],"content":"To determine the active MDI child (to copy its text to the Clipboard)","linkify":"To determine the active MDI child (to copy its text to the Clipboard)","nodes":[{"content":"To determine the active MDI child (to copy its text to the Clipboard)","pos":[0,69]}]},{"content":"Within a method, copy the text of the active control of the active child form to the Clipboard.","pos":[1841,1936]},{"pos":[1948,2257],"content":"[!NOTE]\nThis example assumes there is an MDI parent form (`Form1`) that has one or more MDI child windows containing a <xref:System.Windows.Forms.RichTextBox> control. For more information, see [Creating MDI Parent Forms](../../../../docs/framework/winforms/advanced/how-to-create-mdi-parent-forms.md).","leadings":["","    >  "],"nodes":[{"content":"This example assumes there is an MDI parent form (`Form1`) that has one or more MDI child windows containing a <xref:System.Windows.Forms.RichTextBox> control. For more information, see [Creating MDI Parent Forms](../../../../docs/framework/winforms/advanced/how-to-create-mdi-parent-forms.md).","pos":[8,302],"nodes":[{"content":"This example assumes there is an MDI parent form (<ph id=\"ph1\">`Form1`</ph>) that has one or more MDI child windows containing a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control.","pos":[0,159],"source":"This example assumes there is an MDI parent form (`Form1`) that has one or more MDI child windows containing a <xref:System.Windows.Forms.RichTextBox> control."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Creating MDI Parent Forms<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/how-to-create-mdi-parent-forms.md)</ept>.","pos":[160,294],"source":" For more information, see [Creating MDI Parent Forms](../../../../docs/framework/winforms/advanced/how-to-create-mdi-parent-forms.md)."}]}]},{"pos":[3917,3925],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Multiple-Document Interface (MDI) Applications<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md)</ept><ph id=\"ph1\"> </ph>","pos":[3929,4072],"source":"[Multiple-Document Interface (MDI) Applications](../../../../docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Create MDI Parent Forms<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/how-to-create-mdi-parent-forms.md)</ept><ph id=\"ph1\"> </ph>","pos":[4076,4190],"source":"[How to: Create MDI Parent Forms](../../../../docs/framework/winforms/advanced/how-to-create-mdi-parent-forms.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Create MDI Child Forms<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/how-to-create-mdi-child-forms.md)</ept><ph id=\"ph1\"> </ph>","pos":[4194,4306],"source":"[How to: Create MDI Child Forms](../../../../docs/framework/winforms/advanced/how-to-create-mdi-child-forms.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Send Data to the Active MDI Child<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/how-to-send-data-to-the-active-mdi-child.md)</ept><ph id=\"ph1\"> </ph>","pos":[4310,4444],"source":"[How to: Send Data to the Active MDI Child](../../../../docs/framework/winforms/advanced/how-to-send-data-to-the-active-mdi-child.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Arrange MDI Child Forms<ept id=\"p1\">](../../../../docs/framework/winforms/advanced/how-to-arrange-mdi-child-forms.md)</ept>","pos":[4448,4561],"source":"[How to: Arrange MDI Child Forms](../../../../docs/framework/winforms/advanced/how-to-arrange-mdi-child-forms.md)"}]}