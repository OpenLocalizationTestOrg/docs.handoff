{"content":"---\ntitle: \"Marshaling Data with Platform Invoke | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"platform invoke, marshaling data\"\n  - \"data marshaling, platform invoke\"\n  - \"marshaling, platform invoke\"\nms.assetid: dc5c76cf-7b12-406f-b79c-d1a023ec245d\ncaps.latest.revision: 13\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Marshaling Data with Platform Invoke\nTo call functions exported from an unmanaged library, a .NET Framework application requires a function prototype in managed code that represents the unmanaged function. To create a prototype that enables platform invoke to marshal data correctly, you must do the following:  \n  \n-   Apply the <xref:System.Runtime.InteropServices.DllImportAttribute> attribute to the static function or method in managed code.  \n  \n-   Substitute managed data types for unmanaged data types.  \n  \n You can use the documentation supplied with an unmanaged function to construct an equivalent managed prototype by applying the attribute with its optional fields and substituting managed data types for unmanaged types. For instructions about how to apply the **DllImportAttribute**, see [Consuming Unmanaged DLL Functions](../../../docs/framework/interop/consuming-unmanaged-dll-functions.md).  \n  \n This section provides samples that demonstrate how to create managed function prototypes for passing arguments to and receiving return values from functions exported by unmanaged libraries. The samples also demonstrate when to use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute and the <xref:System.Runtime.InteropServices.Marshal> class to explicitly marshal data.  \n  \n## Platform invoke data types  \n The following table lists data types used in the Win32 API (listed in Wtypes.h) and C-style functions. Many unmanaged libraries contain functions that pass these data types as parameters and return values. The third column lists the corresponding .NET Framework built-in value type or class that you use in managed code. In some cases, you can substitute a type of the same size for the type listed in the table.  \n  \n|Unmanaged type in Wtypes.h|Unmanaged C language type|Managed class name|Description|  \n|--------------------------------|-------------------------------|------------------------|-----------------|  \n|**HANDLE**|**void\\***|<xref:System.IntPtr?displayProperty=fullName>|32 bits on 32-bit Windows operating systems, 64 bits on 64-bit Windows operating systems.|  \n|**BYTE**|**unsigned char**|<xref:System.Byte?displayProperty=fullName>|8 bits|  \n|**SHORT**|**short**|<xref:System.Int16?displayProperty=fullName>|16 bits|  \n|**WORD**|**unsigned short**|<xref:System.UInt16?displayProperty=fullName>|16 bits|  \n|**INT**|**int**|<xref:System.Int32?displayProperty=fullName>|32 bits|  \n|**UINT**|**unsigned int**|<xref:System.UInt32?displayProperty=fullName>|32 bits|  \n|**LONG**|**long**|<xref:System.Int32?displayProperty=fullName>|32 bits|  \n|**BOOL**|**long**|<xref:System.Byte>|32 bits|  \n|**DWORD**|**unsigned long**|<xref:System.UInt32?displayProperty=fullName>|32 bits|  \n|**ULONG**|**unsigned long**|<xref:System.UInt32?displayProperty=fullName>|32 bits|  \n|**CHAR**|**char**|<xref:System.Char?displayProperty=fullName>|Decorate with ANSI.|  \n|**WCHAR**|**wchar_t**|<xref:System.Char?displayProperty=fullName>|Decorate with Unicode.|  \n|**LPSTR**|**char\\***|<xref:System.String?displayProperty=fullName> or <xref:System.Text.StringBuilder?displayProperty=fullName>|Decorate with ANSI.|  \n|**LPCSTR**|**Const char\\***|<xref:System.String?displayProperty=fullName> or <xref:System.Text.StringBuilder?displayProperty=fullName>|Decorate with ANSI.|  \n|**LPWSTR**|**wchar_t\\***|<xref:System.String?displayProperty=fullName> or <xref:System.Text.StringBuilder?displayProperty=fullName>|Decorate with Unicode.|  \n|**LPCWSTR**|**Const wchar_t\\***|<xref:System.String?displayProperty=fullName> or <xref:System.Text.StringBuilder?displayProperty=fullName>|Decorate with Unicode.|  \n|**FLOAT**|**Float**|<xref:System.Single?displayProperty=fullName>|32 bits|  \n|**DOUBLE**|**Double**|<xref:System.Double?displayProperty=fullName>|64 bits|  \n  \n For corresponding types in [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)], C#, and C++, see the [Introduction to the .NET Framework Class Library](../../../docs/standard/class-library-overview.md).  \n  \n## PinvokeLib.dll  \n The following code defines the library functions provided by Pinvoke.dll. Many samples described in this section call this library.  \n  \n### Example  \n [!code-cpp[PInvokeLib#1](../../../samples/snippets/cpp/VS_Snippets_CLR/pinvokelib/cpp/pinvokelib.cpp#1)]  \n  \n [!code-cpp[PInvokeLib#2](../../../samples/snippets/cpp/VS_Snippets_CLR/pinvokelib/cpp/pinvokelib.h#2)]","nodes":[{"pos":[12,65],"content":"Marshaling Data with Platform Invoke | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Marshaling Data with Platform Invoke | Microsoft Docs","pos":[0,53]}]},{"pos":[560,596],"content":"Marshaling Data with Platform Invoke","linkify":"Marshaling Data with Platform Invoke","nodes":[{"content":"Marshaling Data with Platform Invoke","pos":[0,36]}]},{"content":"To call functions exported from an unmanaged library, a .NET Framework application requires a function prototype in managed code that represents the unmanaged function.","pos":[597,765]},{"content":"To create a prototype that enables platform invoke to marshal data correctly, you must do the following:","pos":[766,870]},{"content":"Apply the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.DllImportAttribute&gt;</ph> attribute to the static function or method in managed code.","pos":[880,1006],"source":"Apply the <xref:System.Runtime.InteropServices.DllImportAttribute> attribute to the static function or method in managed code."},{"content":"Substitute managed data types for unmanaged data types.","pos":[1016,1071]},{"content":"You can use the documentation supplied with an unmanaged function to construct an equivalent managed prototype by applying the attribute with its optional fields and substituting managed data types for unmanaged types.","pos":[1078,1296]},{"content":"For instructions about how to apply the <bpt id=\"p1\">**</bpt>DllImportAttribute<ept id=\"p1\">**</ept>, see <bpt id=\"p2\">[</bpt>Consuming Unmanaged DLL Functions<ept id=\"p2\">](../../../docs/framework/interop/consuming-unmanaged-dll-functions.md)</ept>.","pos":[1297,1471],"source":" For instructions about how to apply the **DllImportAttribute**, see [Consuming Unmanaged DLL Functions](../../../docs/framework/interop/consuming-unmanaged-dll-functions.md)."},{"content":"This section provides samples that demonstrate how to create managed function prototypes for passing arguments to and receiving return values from functions exported by unmanaged libraries.","pos":[1478,1667]},{"content":"The samples also demonstrate when to use the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.MarshalAsAttribute&gt;</ph> attribute and the <ph id=\"ph2\">&lt;xref:System.Runtime.InteropServices.Marshal&gt;</ph> class to explicitly marshal data.","pos":[1668,1867],"source":" The samples also demonstrate when to use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute and the <xref:System.Runtime.InteropServices.Marshal> class to explicitly marshal data."},{"pos":[1876,1902],"content":"Platform invoke data types","linkify":"Platform invoke data types","nodes":[{"content":"Platform invoke data types","pos":[0,26]}]},{"content":"The following table lists data types used in the Win32 API (listed in Wtypes.h) and C-style functions.","pos":[1906,2008]},{"content":"Many unmanaged libraries contain functions that pass these data types as parameters and return values.","pos":[2009,2111]},{"content":"The third column lists the corresponding .NET Framework built-in value type or class that you use in managed code.","pos":[2112,2226]},{"content":"In some cases, you can substitute a type of the same size for the type listed in the table.","pos":[2227,2318]},{"content":"Unmanaged type in Wtypes.h","pos":[2325,2351]},{"content":"Unmanaged C language type","pos":[2352,2377]},{"content":"Managed class name","pos":[2378,2396]},{"content":"Description","pos":[2397,2408]},{"pos":[2525,2535],"content":"<bpt id=\"p1\">**</bpt>HANDLE<ept id=\"p1\">**</ept>","source":"**HANDLE**"},{"pos":[2536,2546],"content":"<bpt id=\"p1\">**</bpt>void<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**void\\***"},{"content":"32 bits on 32-bit Windows operating systems, 64 bits on 64-bit Windows operating systems.","pos":[2593,2682]},{"pos":[2687,2695],"content":"<bpt id=\"p1\">**</bpt>BYTE<ept id=\"p1\">**</ept>","source":"**BYTE**"},{"pos":[2696,2713],"content":"<bpt id=\"p1\">**</bpt>unsigned char<ept id=\"p1\">**</ept>","source":"**unsigned char**"},{"content":"8 bits","pos":[2758,2764]},{"pos":[2769,2778],"content":"<bpt id=\"p1\">**</bpt>SHORT<ept id=\"p1\">**</ept>","source":"**SHORT**"},{"pos":[2779,2788],"content":"<bpt id=\"p1\">**</bpt>short<ept id=\"p1\">**</ept>","source":"**short**"},{"content":"16 bits","pos":[2834,2841]},{"pos":[2846,2854],"content":"<bpt id=\"p1\">**</bpt>WORD<ept id=\"p1\">**</ept>","source":"**WORD**"},{"pos":[2855,2873],"content":"<bpt id=\"p1\">**</bpt>unsigned short<ept id=\"p1\">**</ept>","source":"**unsigned short**"},{"content":"16 bits","pos":[2920,2927]},{"pos":[2932,2939],"content":"<bpt id=\"p1\">**</bpt>INT<ept id=\"p1\">**</ept>","source":"**INT**"},{"pos":[2940,2947],"content":"<bpt id=\"p1\">**</bpt>int<ept id=\"p1\">**</ept>","source":"**int**"},{"content":"32 bits","pos":[2993,3000]},{"pos":[3005,3013],"content":"<bpt id=\"p1\">**</bpt>UINT<ept id=\"p1\">**</ept>","source":"**UINT**"},{"pos":[3014,3030],"content":"<bpt id=\"p1\">**</bpt>unsigned int<ept id=\"p1\">**</ept>","source":"**unsigned int**"},{"content":"32 bits","pos":[3077,3084]},{"pos":[3089,3097],"content":"<bpt id=\"p1\">**</bpt>LONG<ept id=\"p1\">**</ept>","source":"**LONG**"},{"pos":[3098,3106],"content":"<bpt id=\"p1\">**</bpt>long<ept id=\"p1\">**</ept>","source":"**long**"},{"content":"32 bits","pos":[3152,3159]},{"pos":[3164,3172],"content":"<bpt id=\"p1\">**</bpt>BOOL<ept id=\"p1\">**</ept>","source":"**BOOL**"},{"pos":[3173,3181],"content":"<bpt id=\"p1\">**</bpt>long<ept id=\"p1\">**</ept>","source":"**long**"},{"content":"32 bits","pos":[3201,3208]},{"pos":[3213,3222],"content":"<bpt id=\"p1\">**</bpt>DWORD<ept id=\"p1\">**</ept>","source":"**DWORD**"},{"pos":[3223,3240],"content":"<bpt id=\"p1\">**</bpt>unsigned long<ept id=\"p1\">**</ept>","source":"**unsigned long**"},{"content":"32 bits","pos":[3287,3294]},{"pos":[3299,3308],"content":"<bpt id=\"p1\">**</bpt>ULONG<ept id=\"p1\">**</ept>","source":"**ULONG**"},{"pos":[3309,3326],"content":"<bpt id=\"p1\">**</bpt>unsigned long<ept id=\"p1\">**</ept>","source":"**unsigned long**"},{"content":"32 bits","pos":[3373,3380]},{"pos":[3385,3393],"content":"<bpt id=\"p1\">**</bpt>CHAR<ept id=\"p1\">**</ept>","source":"**CHAR**"},{"pos":[3394,3402],"content":"<bpt id=\"p1\">**</bpt>char<ept id=\"p1\">**</ept>","source":"**char**"},{"content":"Decorate with ANSI.","pos":[3447,3466]},{"pos":[3471,3480],"content":"<bpt id=\"p1\">**</bpt>WCHAR<ept id=\"p1\">**</ept>","source":"**WCHAR**"},{"pos":[3481,3492],"content":"<bpt id=\"p1\">**</bpt>wchar_t<ept id=\"p1\">**</ept>","source":"**wchar_t**"},{"content":"Decorate with Unicode.","pos":[3537,3559]},{"pos":[3564,3573],"content":"<bpt id=\"p1\">**</bpt>LPSTR<ept id=\"p1\">**</ept>","source":"**LPSTR**"},{"pos":[3574,3584],"content":"<bpt id=\"p1\">**</bpt>char<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**char\\***"},{"content":"<ph id=\"ph1\">&lt;xref:System.String?displayProperty=fullName&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Text.StringBuilder?displayProperty=fullName&gt;</ph>","pos":[3585,3691],"source":"<xref:System.String?displayProperty=fullName> or <xref:System.Text.StringBuilder?displayProperty=fullName>"},{"content":"Decorate with ANSI.","pos":[3692,3711]},{"pos":[3716,3726],"content":"<bpt id=\"p1\">**</bpt>LPCSTR<ept id=\"p1\">**</ept>","source":"**LPCSTR**"},{"pos":[3727,3743],"content":"<bpt id=\"p1\">**</bpt>Const char<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**Const char\\***"},{"content":"<ph id=\"ph1\">&lt;xref:System.String?displayProperty=fullName&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Text.StringBuilder?displayProperty=fullName&gt;</ph>","pos":[3744,3850],"source":"<xref:System.String?displayProperty=fullName> or <xref:System.Text.StringBuilder?displayProperty=fullName>"},{"content":"Decorate with ANSI.","pos":[3851,3870]},{"pos":[3875,3885],"content":"<bpt id=\"p1\">**</bpt>LPWSTR<ept id=\"p1\">**</ept>","source":"**LPWSTR**"},{"pos":[3886,3899],"content":"<bpt id=\"p1\">**</bpt>wchar_t<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**wchar_t\\***"},{"content":"<ph id=\"ph1\">&lt;xref:System.String?displayProperty=fullName&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Text.StringBuilder?displayProperty=fullName&gt;</ph>","pos":[3900,4006],"source":"<xref:System.String?displayProperty=fullName> or <xref:System.Text.StringBuilder?displayProperty=fullName>"},{"content":"Decorate with Unicode.","pos":[4007,4029]},{"pos":[4034,4045],"content":"<bpt id=\"p1\">**</bpt>LPCWSTR<ept id=\"p1\">**</ept>","source":"**LPCWSTR**"},{"pos":[4046,4065],"content":"<bpt id=\"p1\">**</bpt>Const wchar_t<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**Const wchar_t\\***"},{"content":"<ph id=\"ph1\">&lt;xref:System.String?displayProperty=fullName&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Text.StringBuilder?displayProperty=fullName&gt;</ph>","pos":[4066,4172],"source":"<xref:System.String?displayProperty=fullName> or <xref:System.Text.StringBuilder?displayProperty=fullName>"},{"content":"Decorate with Unicode.","pos":[4173,4195]},{"pos":[4200,4209],"content":"<bpt id=\"p1\">**</bpt>FLOAT<ept id=\"p1\">**</ept>","source":"**FLOAT**"},{"pos":[4210,4219],"content":"<bpt id=\"p1\">**</bpt>Float<ept id=\"p1\">**</ept>","source":"**Float**"},{"content":"32 bits","pos":[4266,4273]},{"pos":[4278,4288],"content":"<bpt id=\"p1\">**</bpt>DOUBLE<ept id=\"p1\">**</ept>","source":"**DOUBLE**"},{"pos":[4289,4299],"content":"<bpt id=\"p1\">**</bpt>Double<ept id=\"p1\">**</ept>","source":"**Double**"},{"content":"64 bits","pos":[4346,4353]},{"pos":[4361,4570],"content":"For corresponding types in <ph id=\"ph1\">[!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)]</ph>, C#, and C++, see the <bpt id=\"p1\">[</bpt>Introduction to the .NET Framework Class Library<ept id=\"p1\">](../../../docs/standard/class-library-overview.md)</ept>.","source":"For corresponding types in [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)], C#, and C++, see the [Introduction to the .NET Framework Class Library](../../../docs/standard/class-library-overview.md)."},{"pos":[4579,4593],"content":"PinvokeLib.dll","linkify":"PinvokeLib.dll","nodes":[{"content":"PinvokeLib.dll","pos":[0,14]}]},{"content":"The following code defines the library functions provided by Pinvoke.dll.","pos":[4597,4670]},{"content":"Many samples described in this section call this library.","pos":[4671,4728]},{"pos":[4738,4745],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4749,4853],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>PInvokeLib#1<ept id=\"p2\">](../../../samples/snippets/cpp/VS_Snippets_CLR/pinvokelib/cpp/pinvokelib.cpp#1)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[PInvokeLib#1](../../../samples/snippets/cpp/VS_Snippets_CLR/pinvokelib/cpp/pinvokelib.cpp#1)]"},{"pos":[4860,4962],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>PInvokeLib#2<ept id=\"p2\">](../../../samples/snippets/cpp/VS_Snippets_CLR/pinvokelib/cpp/pinvokelib.h#2)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[PInvokeLib#2](../../../samples/snippets/cpp/VS_Snippets_CLR/pinvokelib/cpp/pinvokelib.h#2)]"}]}