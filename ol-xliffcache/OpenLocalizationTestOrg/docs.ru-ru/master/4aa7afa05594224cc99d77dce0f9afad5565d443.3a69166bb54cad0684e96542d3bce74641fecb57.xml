{"content":"---\ntitle: \"Custom Activity to Switch on a Range of Values | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 441e0a17-421f-430c-ba97-59e4cc6c88e3\ncaps.latest.revision: 10\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Custom Activity to Switch on a Range of Values\nThis sample demonstrates how to create a custom activity that extends the use of a <xref:System.Activities.Statements.Switch%601>. A conventional <xref:System.Activities.Statements.Switch%601> statement allows switching based upon a single value. But, there are business scenarios where an activity must switch based upon a range of values. For example, an activity might execute one action when the value being switched upon is between 1 and 5, another action when the value is between 6 and 10, and a default action for all other values. This custom activity enables exactly that scenario.  \n  \n## The SwitchRange Activity  \n The `SwitchRange` activity schedules a child activity when the result value of its expression is included within the range of one of its `Cases`.  \n  \n The following code example is a custom activity that switches based upon a range of values.  \n  \n```csharp  \npublic sealed class SwitchRange<T> : NativeActivity where T : IComparable  \n{  \n   [RequiredArgument]  \n   [DefaultValue(null)]  \n   public InArgument<T> Expression { get; set; }  \n  \n   public IList<CaseRange<T>> Cases  \n  \n   [DefaultValue(null)]  \n   public Activity Default { get; set; }}  \n}  \n  \n```  \n  \n|Property|Description|  \n|-|-|  \n|Expression|This is the expression to be evaluated and compared against the ranges in the Cases list. The result of the expression is of type T.|  \n|Cases|Each case consists of a range (From and To) and an activity (Body). The expression is evaluated and compared against the ranges. If the result of the expression is within the range of one of the cases, the corresponding activity is executed.|  \n|Default|The activity that is executed when no case is matched. When set to `null`, no action is taken.|  \n  \n## CaseRange Class  \n The `CaseRange` class represents a range within a `SwitchRange` activity. Every instance of `CaseRange` contains a range (composed of a `From` and a `To`) and a `Body` activity that is scheduled if the expression in the `SwitchRange` is evaluated within the range.  \n  \n The following code example is the definition for the `CaseRange` class.  \n  \n```  \npublic class CaseRange<T> where T : IComparable  \n{  \n    public T From { get; set; }  \n  \n    public T To { get; set; }  \n  \n    public Activity Action { get; set; }  \n}  \n  \n```  \n  \n> [!NOTE]\n>  Both the `SwitchRange` and `CaseRange` classes, which are defined in the sample are generic classes that can work with any type that implements `IComparable`, like the <xref:System.Activities.Statements.Switch%601> class.  \n  \n## Sample Usage  \n The following code example demonstrates how to use the `SwitchRange` activity.  \n  \n```csharp  \nActivity SwitchRange = new SwitchRange<int>  \n{  \n    Expression = new InArgument<int>(value),  \n    Cases =   \n    {  \n        new CaseRange<int>                      \n        {  \n            From = 1,  \n            To = 5,  \n            Action = new WriteLine  \n            {  \n                Text = \"Case 1-5 selected\",  \n            }  \n        },  \n        new CaseRange<int>  \n        {  \n            From = 6,  \n            To = 10,  \n            Action = new WriteLine  \n            {  \n                Text = \"Case 6-10 selected\",  \n            }  \n        }  \n    },  \n    Default = new WriteLine { Text = \"Default Case selected\" }  \n};  \n  \n```  \n  \n#### To use this sample  \n  \n1.  Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the SwitchRange.sln solution file.  \n  \n2.  To build the solution, press CTRL+SHIFT+B.  \n  \n3.  To run the solution, press CTRL+F5.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Scenario\\ActivityLibrary\\SwitchRange`  \n  \n## See Also","nodes":[{"pos":[12,75],"content":"Custom Activity to Switch on a Range of Values | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Custom Activity to Switch on a Range of Values | Microsoft Docs","pos":[0,63]}]},{"pos":[341,387],"content":"Custom Activity to Switch on a Range of Values","linkify":"Custom Activity to Switch on a Range of Values","nodes":[{"content":"Custom Activity to Switch on a Range of Values","pos":[0,46]}]},{"content":"This sample demonstrates how to create a custom activity that extends the use of a <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Switch%601&gt;</ph>.","pos":[388,518],"source":"This sample demonstrates how to create a custom activity that extends the use of a <xref:System.Activities.Statements.Switch%601>."},{"content":"A conventional <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Switch%601&gt;</ph> statement allows switching based upon a single value.","pos":[519,634],"source":" A conventional <xref:System.Activities.Statements.Switch%601> statement allows switching based upon a single value."},{"content":"But, there are business scenarios where an activity must switch based upon a range of values.","pos":[635,728]},{"content":"For example, an activity might execute one action when the value being switched upon is between 1 and 5, another action when the value is between 6 and 10, and a default action for all other values.","pos":[729,927]},{"content":"This custom activity enables exactly that scenario.","pos":[928,979]},{"pos":[988,1012],"content":"The SwitchRange Activity","linkify":"The SwitchRange Activity","nodes":[{"content":"The SwitchRange Activity","pos":[0,24]}]},{"pos":[1016,1161],"content":"The <ph id=\"ph1\">`SwitchRange`</ph> activity schedules a child activity when the result value of its expression is included within the range of one of its <ph id=\"ph2\">`Cases`</ph>.","source":"The `SwitchRange` activity schedules a child activity when the result value of its expression is included within the range of one of its `Cases`."},{"content":"The following code example is a custom activity that switches based upon a range of values.","pos":[1168,1259]},{"content":"Property","pos":[1589,1597]},{"content":"Description","pos":[1598,1609]},{"content":"Expression","pos":[1622,1632]},{"content":"This is the expression to be evaluated and compared against the ranges in the Cases list.","pos":[1633,1722]},{"content":"The result of the expression is of type T.","pos":[1723,1765]},{"content":"Cases","pos":[1770,1775]},{"content":"Each case consists of a range (From and To) and an activity (Body).","pos":[1776,1843]},{"content":"The expression is evaluated and compared against the ranges.","pos":[1844,1904]},{"content":"If the result of the expression is within the range of one of the cases, the corresponding activity is executed.","pos":[1905,2017]},{"content":"Default","pos":[2022,2029]},{"content":"The activity that is executed when no case is matched.","pos":[2030,2084]},{"content":"When set to <ph id=\"ph1\">`null`</ph>, no action is taken.","pos":[2085,2124],"source":" When set to `null`, no action is taken."},{"pos":[2134,2149],"content":"CaseRange Class","linkify":"CaseRange Class","nodes":[{"content":"CaseRange Class","pos":[0,15]}]},{"content":"The <ph id=\"ph1\">`CaseRange`</ph> class represents a range within a <ph id=\"ph2\">`SwitchRange`</ph> activity.","pos":[2153,2226],"source":"The `CaseRange` class represents a range within a `SwitchRange` activity."},{"content":"Every instance of <ph id=\"ph1\">`CaseRange`</ph> contains a range (composed of a <ph id=\"ph2\">`From`</ph> and a <ph id=\"ph3\">`To`</ph>) and a <ph id=\"ph4\">`Body`</ph> activity that is scheduled if the expression in the <ph id=\"ph5\">`SwitchRange`</ph> is evaluated within the range.","pos":[2227,2417],"source":" Every instance of `CaseRange` contains a range (composed of a `From` and a `To`) and a `Body` activity that is scheduled if the expression in the `SwitchRange` is evaluated within the range."},{"pos":[2424,2495],"content":"The following code example is the definition for the <ph id=\"ph1\">`CaseRange`</ph> class.","source":"The following code example is the definition for the `CaseRange` class."},{"pos":[2694,2926],"content":"[!NOTE]\n Both the `SwitchRange` and `CaseRange` classes, which are defined in the sample are generic classes that can work with any type that implements `IComparable`, like the <xref:System.Activities.Statements.Switch%601> class.","leadings":["","> "],"nodes":[{"content":"Both the <ph id=\"ph1\">`SwitchRange`</ph> and <ph id=\"ph2\">`CaseRange`</ph> classes, which are defined in the sample are generic classes that can work with any type that implements <ph id=\"ph3\">`IComparable`</ph>, like the <ph id=\"ph4\">&lt;xref:System.Activities.Statements.Switch%601&gt;</ph> class.","pos":[9,230],"source":" Both the `SwitchRange` and `CaseRange` classes, which are defined in the sample are generic classes that can work with any type that implements `IComparable`, like the <xref:System.Activities.Statements.Switch%601> class."}]},{"pos":[2935,2947],"content":"Sample Usage","linkify":"Sample Usage","nodes":[{"content":"Sample Usage","pos":[0,12]}]},{"pos":[2951,3029],"content":"The following code example demonstrates how to use the <ph id=\"ph1\">`SwitchRange`</ph> activity.","source":"The following code example demonstrates how to use the `SwitchRange` activity."},{"pos":[3714,3732],"content":"To use this sample","linkify":"To use this sample","nodes":[{"content":"To use this sample","pos":[0,18]}]},{"pos":[3742,3842],"content":"Using <ph id=\"ph1\">[!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]</ph>, open the SwitchRange.sln solution file.","source":"Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the SwitchRange.sln solution file."},{"content":"To build the solution, press CTRL+SHIFT+B.","pos":[3852,3894]},{"content":"To run the solution, press CTRL+F5.","pos":[3904,3939]},{"pos":[3947,4079],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[4133,4459],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[4460,4510]},{"pos":[4602,4610],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]}]}