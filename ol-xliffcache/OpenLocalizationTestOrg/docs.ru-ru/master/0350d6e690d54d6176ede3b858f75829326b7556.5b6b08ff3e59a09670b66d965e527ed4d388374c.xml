{"content":"---\ntitle: \"How to: Bind Data to the MaskedTextBox Control\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"MaskedTextBox control [Windows Forms]\"\n  - \"data binding [Windows Forms], MaskedTextBox control [Windows Forms]\"\n  - \"MaskedTextBox control [Windows Forms], binding data\"\nms.assetid: 34b29f07-e8df-48d4-b08b-53fcca524708\n---\n# How to: Bind Data to the MaskedTextBox Control\nYou can bind data to a <xref:System.Windows.Forms.MaskedTextBox> control just as you can to any other Windows Forms control. However, if the format of your data in the database does not match the format expected by your mask definition, you will need to reformat the data. The following procedure demonstrates how to do this using the <xref:System.Windows.Forms.Binding.Format> and <xref:System.Windows.Forms.Binding.Parse> events of the <xref:System.Windows.Forms.Binding> class to display separate phone number and phone extension database fields as a single editable field.  \n  \n The following procedure requires that you have access to a SQL Server database with the Northwind sample database installed.  \n  \n### To bind data to a MaskedTextBox control  \n  \n1.  Create a new Windows Forms project.  \n  \n2.  Drag two <xref:System.Windows.Forms.TextBox> controls onto your form; name them `FirstName` and `LastName`.  \n  \n3.  Drag a <xref:System.Windows.Forms.MaskedTextBox> control onto your form; name it `PhoneMask`.  \n  \n4.  Set the <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property of `PhoneMask` to `(000) 000-0000 x9999`.  \n  \n5.  Add the following namespace imports to the form.  \n  \n    ```csharp  \n    using System.Data.SqlClient;  \n    ```  \n  \n    ```vb  \n    Imports System.Data.SqlClient  \n    ```  \n  \n6.  Right-click the form and choose **View Code**. Place this code anywhere in your form class.  \n  \n    ```csharp  \n    Binding currentBinding, phoneBinding;  \n    DataSet employeesTable = new DataSet();  \n    SqlConnection sc;  \n    SqlDataAdapter dataConnect;  \n  \n    private void Form1_Load(object sender, EventArgs e)  \n    {  \n        DoMaskBinding();  \n    }  \n  \n    private void DoMaskBinding()  \n    {  \n        try  \n        {  \n            sc = new SqlConnection(\"Data Source=CLIENTUE;Initial Catalog=NORTHWIND;Integrated Security=SSPI\");  \n            sc.Open();  \n        }  \n        catch (Exception ex)  \n        {  \n            MessageBox.Show(ex.Message);  \n            return;  \n        }  \n  \n        dataConnect = new SqlDataAdapter(\"SELECT * FROM Employees\", sc);  \n        dataConnect.Fill(employeesTable, \"Employees\");  \n  \n        // Now bind MaskedTextBox to appropriate field. Note that we must create the Binding objects  \n        // before adding them to the control - otherwise, we won't get a Format event on the   \n        // initial load.   \n        try  \n        {  \n            currentBinding = new Binding(\"Text\", employeesTable, \"Employees.FirstName\");  \n            firstName.DataBindings.Add(currentBinding);  \n  \n            currentBinding = new Binding(\"Text\", employeesTable, \"Employees.LastName\");  \n            lastName.DataBindings.Add(currentBinding);  \n  \n            phoneBinding =new Binding(\"Text\", employeesTable, \"Employees.HomePhone\");  \n            // We must add the event handlers before we bind, or the Format event will not get called  \n            // for the first record.  \n            phoneBinding.Format += new ConvertEventHandler(phoneBinding_Format);  \n            phoneBinding.Parse += new ConvertEventHandler(phoneBinding_Parse);  \n            phoneMask.DataBindings.Add(phoneBinding);  \n        }  \n        catch (Exception ex)  \n        {  \n            MessageBox.Show(ex.Message);  \n            return;  \n        }  \n    }  \n    ```  \n  \n    ```vb  \n    Dim WithEvents CurrentBinding, PhoneBinding As Binding  \n    Dim EmployeesTable As New DataSet()  \n    Dim sc As SqlConnection  \n    Dim DataConnect As SqlDataAdapter  \n  \n    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load  \n        DoMaskedBinding()  \n    End Sub  \n  \n    Private Sub DoMaskedBinding()  \n        Try  \n            sc = New SqlConnection(\"Data Source=SERVERNAME;Initial Catalog=NORTHWIND;Integrated Security=SSPI\")  \n            sc.Open()  \n        Catch ex As Exception  \n            MessageBox.Show(ex.Message)  \n            Exit Sub  \n        End Try  \n  \n        DataConnect = New SqlDataAdapter(\"SELECT * FROM Employees\", sc)  \n        DataConnect.Fill(EmployeesTable, \"Employees\")  \n  \n        ' Now bind MaskedTextBox to appropriate field. Note that we must create the Binding objects  \n        ' before adding them to the control - otherwise, we won't get a Format event on the   \n        ' initial load.  \n        Try  \n            CurrentBinding = New Binding(\"Text\", EmployeesTable, \"Employees.FirstName\")  \n            firstName.DataBindings.Add(CurrentBinding)  \n            CurrentBinding = New Binding(\"Text\", EmployeesTable, \"Employees.LastName\")  \n            lastName.DataBindings.Add(CurrentBinding)  \n            PhoneBinding = New Binding(\"Text\", EmployeesTable, \"Employees.HomePhone\")  \n            PhoneMask.DataBindings.Add(PhoneBinding)  \n        Catch ex As Exception  \n            MessageBox.Show(ex.Message)  \n            Application.Exit()  \n        End Try  \n    End Sub  \n    ```  \n  \n7.  Add event handlers for the <xref:System.Windows.Forms.Binding.Format> and <xref:System.Windows.Forms.Binding.Parse> events to combine and separate the `PhoneNumber` and `Extension` fields from the bound <xref:System.Data.DataSet>.  \n  \n    ```csharp  \n    private void phoneBinding_Format(Object sender, ConvertEventArgs e)  \n    {  \n        String ext;  \n  \n        DataRowView currentRow = (DataRowView)BindingContext[employeesTable, \"Employees\"].Current;  \n        if (currentRow[\"Extension\"] == null)   \n        {  \n            ext = \"\";  \n        } else   \n        {  \n            ext = currentRow[\"Extension\"].ToString();  \n        }  \n  \n        e.Value = e.Value.ToString().Trim() + \" x\" + ext;  \n    }  \n  \n    private void phoneBinding_Parse(Object sender, ConvertEventArgs e)  \n    {  \n        String phoneNumberAndExt = e.Value.ToString();  \n  \n        int extIndex = phoneNumberAndExt.IndexOf(\"x\");  \n        String ext = phoneNumberAndExt.Substring(extIndex).Trim();  \n        String phoneNumber = phoneNumberAndExt.Substring(0, extIndex).Trim();  \n  \n        //Get the current binding object, and set the new extension manually.   \n        DataRowView currentRow = (DataRowView)BindingContext[employeesTable, \"Employees\"].Current;  \n        // Remove the \"x\" from the extension.  \n        currentRow[\"Extension\"] = ext.Substring(1);  \n  \n        //Return the phone number.  \n        e.Value = phoneNumber;  \n    }  \n    ```  \n  \n    ```vb  \n    Private Sub PhoneBinding_Format(ByVal sender As Object, ByVal e As ConvertEventArgs) Handles PhoneBinding.Format  \n        Dim Ext As String  \n  \n        Dim CurrentRow As DataRowView = CType(Me.BindingContext(EmployeesTable, \"Employees\").Current, DataRowView)  \n        If (CurrentRow(\"Extension\") Is Nothing) Then  \n            Ext = \"\"  \n        Else  \n            Ext = CurrentRow(\"Extension\").ToString()  \n        End If  \n  \n        e.Value = e.Value.ToString().Trim() & \" x\" & Ext  \n    End Sub  \n  \n    Private Sub PhoneBinding_Parse(ByVal sender As Object, ByVal e As ConvertEventArgs) Handles PhoneBinding.Parse  \n        Dim PhoneNumberAndExt As String = e.Value.ToString()  \n  \n        Dim ExtIndex As Integer = PhoneNumberAndExt.IndexOf(\"x\")  \n        Dim Ext As String = PhoneNumberAndExt.Substring(ExtIndex).Trim()  \n        Dim PhoneNumber As String = PhoneNumberAndExt.Substring(0, ExtIndex).Trim()  \n  \n        ' Get the current binding object, and set the new extension manually.   \n        Dim CurrentRow As DataRowView = CType(Me.BindingContext(EmployeesTable, \"Employees\").Current, DataRowView)  \n        ' Remove the \"x\" from the extension.  \n        CurrentRow(\"Extension\") = CObj(Ext.Substring(1))  \n  \n        ' Return the phone number.  \n        e.Value = PhoneNumber  \n    End Sub  \n    ```  \n  \n8.  Add two <xref:System.Windows.Forms.Button> controls to the form. Name them `previousButton` and `nextButton`. Double-click each button to add a <xref:System.Windows.Forms.Control.Click> event handler, and fill in the event handlers as shown in the following code example.  \n  \n    ```csharp  \n    private void previousButton_Click(object sender, EventArgs e)  \n    {  \n        BindingContext[employeesTable, \"Employees\"].Position = BindingContext[employeesTable, \"Employees\"].Position - 1;  \n    }  \n  \n    private void nextButton_Click(object sender, EventArgs e)  \n    {  \n        BindingContext[employeesTable, \"Employees\"].Position = BindingContext[employeesTable, \"Employees\"].Position + 1;  \n    }  \n    ```  \n  \n    ```vb  \n    Private Sub PreviousButton_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PreviousButton.Click  \n        Me.BindingContext(EmployeesTable, \"Employees\").Position = Me.BindingContext(EmployeesTable, \"Employees\").Position - 1  \n    End Sub  \n  \n    Private Sub NextButton_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NextButton.Click  \n        Me.BindingContext(EmployeesTable, \"Employees\").Position = Me.BindingContext(EmployeesTable, \"Employees\").Position + 1  \n    End Sub  \n    ```  \n  \n9. Run the sample. Edit the data, and use the **Previous** and **Next** buttons to see that the data is properly persisted to the <xref:System.Data.DataSet>.  \n  \n## Example  \n The following code example is the full code listing that results from completing the previous procedure.  \n  \n [!code-cpp[MaskedTextBoxData#1](~/samples/snippets/cpp/VS_Snippets_Winforms/MaskedTextBoxData/cpp/form1.cpp#1)]\n [!code-csharp[MaskedTextBoxData#1](~/samples/snippets/csharp/VS_Snippets_Winforms/MaskedTextBoxData/CS/form1.cs#1)]\n [!code-vb[MaskedTextBoxData#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/MaskedTextBoxData/VB/form1.vb#1)]  \n  \n## Compiling the Code  \n  \n-   Create a Visual C# or Visual Basic project.  \n  \n-   Add the <xref:System.Windows.Forms.TextBox> and <xref:System.Windows.Forms.MaskedTextBox> controls to the form, as described in the previous procedure.  \n  \n-   Open the source code file for the project's default form.  \n  \n-   Replace the source code in this file with the code listed in the previous \"Code\" section.  \n  \n-   Compile the application.  \n  \n## See also\n\n- [Walkthrough: Working with the MaskedTextBox Control](walkthrough-working-with-the-maskedtextbox-control.md)\n","nodes":[{"pos":[4,372],"embed":true,"restype":"x-metadata","content":"title: \"How to: Bind Data to the MaskedTextBox Control\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"MaskedTextBox control [Windows Forms]\"\n  - \"data binding [Windows Forms], MaskedTextBox control [Windows Forms]\"\n  - \"MaskedTextBox control [Windows Forms], binding data\"\nms.assetid: 34b29f07-e8df-48d4-b08b-53fcca524708","nodes":[{"content":"How to: Bind Data to the MaskedTextBox Control","nodes":[{"pos":[0,46],"content":"How to: Bind Data to the MaskedTextBox Control","nodes":[{"content":"How to: Bind Data to the MaskedTextBox Control","pos":[0,46]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[379,425],"content":"How to: Bind Data to the MaskedTextBox Control","linkify":"How to: Bind Data to the MaskedTextBox Control","nodes":[{"content":"How to: Bind Data to the MaskedTextBox Control","pos":[0,46]}]},{"content":"You can bind data to a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph> control just as you can to any other Windows Forms control.","pos":[426,550],"source":"You can bind data to a <xref:System.Windows.Forms.MaskedTextBox> control just as you can to any other Windows Forms control."},{"content":"However, if the format of your data in the database does not match the format expected by your mask definition, you will need to reformat the data.","pos":[551,698]},{"content":"The following procedure demonstrates how to do this using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Binding.Format&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Binding.Parse&gt;</ph> events of the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Binding&gt;</ph> class to display separate phone number and phone extension database fields as a single editable field.","pos":[699,1002],"source":" The following procedure demonstrates how to do this using the <xref:System.Windows.Forms.Binding.Format> and <xref:System.Windows.Forms.Binding.Parse> events of the <xref:System.Windows.Forms.Binding> class to display separate phone number and phone extension database fields as a single editable field."},{"content":"The following procedure requires that you have access to a SQL Server database with the Northwind sample database installed.","pos":[1009,1133]},{"pos":[1143,1182],"content":"To bind data to a MaskedTextBox control","linkify":"To bind data to a MaskedTextBox control","nodes":[{"content":"To bind data to a MaskedTextBox control","pos":[0,39]}]},{"content":"Create a new Windows Forms project.","pos":[1192,1227]},{"pos":[1237,1344],"content":"Drag two <ph id=\"ph1\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph> controls onto your form; name them <ph id=\"ph2\">`FirstName`</ph> and <ph id=\"ph3\">`LastName`</ph>.","source":"Drag two <xref:System.Windows.Forms.TextBox> controls onto your form; name them `FirstName` and `LastName`."},{"pos":[1354,1447],"content":"Drag a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph> control onto your form; name it <ph id=\"ph2\">`PhoneMask`</ph>.","source":"Drag a <xref:System.Windows.Forms.MaskedTextBox> control onto your form; name it `PhoneMask`."},{"pos":[1457,1565],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox.Mask%2A&gt;</ph> property of <ph id=\"ph2\">`PhoneMask`</ph> to <ph id=\"ph3\">`(000) 000-0000 x9999`</ph>.","source":"Set the <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property of `PhoneMask` to `(000) 000-0000 x9999`."},{"content":"Add the following namespace imports to the form.","pos":[1575,1623]},{"content":"Right-click the form and choose <bpt id=\"p1\">**</bpt>View Code<ept id=\"p1\">**</ept>.","pos":[1758,1804],"source":"Right-click the form and choose **View Code**."},{"content":"Place this code anywhere in your form class.","pos":[1805,1849]},{"pos":[5371,5601],"content":"Add event handlers for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Binding.Format&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Binding.Parse&gt;</ph> events to combine and separate the <ph id=\"ph3\">`PhoneNumber`</ph> and <ph id=\"ph4\">`Extension`</ph> fields from the bound <ph id=\"ph5\">&lt;xref:System.Data.DataSet&gt;</ph>.","source":"Add event handlers for the <xref:System.Windows.Forms.Binding.Format> and <xref:System.Windows.Forms.Binding.Parse> events to combine and separate the `PhoneNumber` and `Extension` fields from the bound <xref:System.Data.DataSet>."},{"content":"Add two <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> controls to the form.","pos":[8159,8223],"source":"Add two <xref:System.Windows.Forms.Button> controls to the form."},{"content":"Name them <ph id=\"ph1\">`previousButton`</ph> and <ph id=\"ph2\">`nextButton`</ph>.","pos":[8224,8268],"source":" Name them `previousButton` and `nextButton`."},{"content":"Double-click each button to add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler, and fill in the event handlers as shown in the following code example.","pos":[8269,8430],"source":" Double-click each button to add a <xref:System.Windows.Forms.Control.Click> event handler, and fill in the event handlers as shown in the following code example."},{"content":"Run the sample.","pos":[9441,9456]},{"content":"Edit the data, and use the <bpt id=\"p1\">**</bpt>Previous<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> buttons to see that the data is properly persisted to the <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph>.","pos":[9457,9595],"source":" Edit the data, and use the **Previous** and **Next** buttons to see that the data is properly persisted to the <xref:System.Data.DataSet>."},{"pos":[9604,9611],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example is the full code listing that results from completing the previous procedure.","pos":[9615,9719]},{"pos":[10081,10099],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"Create a Visual C# or Visual Basic project.","pos":[10109,10152]},{"pos":[10162,10313],"content":"Add the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph> controls to the form, as described in the previous procedure.","source":"Add the <xref:System.Windows.Forms.TextBox> and <xref:System.Windows.Forms.MaskedTextBox> controls to the form, as described in the previous procedure."},{"content":"Open the source code file for the project's default form.","pos":[10323,10380]},{"content":"Replace the source code in this file with the code listed in the previous \"Code\" section.","pos":[10390,10479]},{"content":"Compile the application.","pos":[10489,10513]},{"pos":[10522,10530],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[10534,10642],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Working with the MaskedTextBox Control<ept id=\"p1\">](walkthrough-working-with-the-maskedtextbox-control.md)</ept>","source":"[Walkthrough: Working with the MaskedTextBox Control](walkthrough-working-with-the-maskedtextbox-control.md)"}]}