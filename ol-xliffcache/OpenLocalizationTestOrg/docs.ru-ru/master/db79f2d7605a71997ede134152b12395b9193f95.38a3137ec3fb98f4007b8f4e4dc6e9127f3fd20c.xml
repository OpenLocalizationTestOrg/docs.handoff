{"content":"---\ntitle: \"Database Access Activities\"\nms.date: \"03/30/2017\"\nms.assetid: 174a381e-1343-46a8-a62c-7c2ae2c4f0b2\n---\n# Database Access Activities\nDatabase access activities allow you to access a database within a workflow. These activities allow accessing databases to retrieve or modify information and use [ADO.NET](https://go.microsoft.com/fwlink/?LinkId=166081) to access the database.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.\n>\n>  `<InstallDrive>:\\WF_WCF_Samples`\n>\n>  If this directory does not exist, go to (download page) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.\n>\n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Scenario\\ActivityLibrary\\DbActivities`\n\n## Database Activities\n The following sections detail the list of activities included in this sample.\n\n## DbUpdate\n Executes a SQL query that produces a modification in the database (insert, update, delete, and other modifications).\n\n This class performs its work asynchronously (it derives from <xref:System.Activities.AsyncCodeActivity> and uses its asynchronous capabilities).\n\n The connection information can be configured by setting a provider invariant name (`ProviderName`) and the connection string (`ConnectionString`) or just using a connection string configuration name (`ConfigFileSectionName`) from the application configuration file.\n\n The query to be executed is configured in its `Sql` property and the parameters are passed through the `Parameters` collection.\n\n After `DbUpdate` is executed, the number of affected records is returned in the `AffectedRecords` property.\n\n```\nPublic class DbUpdate: AsyncCodeActivity\n{\n    [RequiredArgument]\n    [OverloadGroup(\"ConnectionString\")]\n    [DefaultValue(null)]\n    public InArgument<string> ProviderName { get; set; }\n\n    [RequiredArgument]\n    [OverloadGroup(\"ConnectionString\")]\n    [DependsOn(\"ProviderName\")]\n    [DefaultValue(null)]\n    public InArgument<string> ConnectionString { get; set; }\n\n    [RequiredArgument]\n    [OverloadGroup(\"ConfigFileSectionName\")]\n    [DefaultValue(null)]\n    public InArgument<string> ConfigName { get; set; }\n\n    [DefaultValue(null)]\n    public CommandType CommandType { get; set; }\n\n    [RequiredArgument]\n    public InArgument<string> Sql { get; set; }\n\n    [DependsOn(\"Sql\")]\n    [DefaultValue(null)]\n    public IDictionary<string, Argument> Parameters { get; }\n\n    [DependsOn(\"Parameters\")]\n    public OutArgument<int> AffectedRecords { get; set; }\n}\n```\n\n|Argument|Description|\n|-|-|\n|ProviderName|ADO.NET provider invariant name. If this argument is set, then the `ConnectionString` must also be set.|\n|ConnectionString|Connection string to connect to the database. If this argument is set, then `ProviderName` must also be set.|\n|ConfigName|Name of the configuration file section where the connection information is stored. When this argument is set `ProviderName` and `ConnectionString` are not required.|\n|CommandType|Type of the <xref:System.Data.Common.DbCommand> to be executed.|\n|Sql|The SQL command to be executed.|\n|Parameters|Collection of the parameters of the SQL query.|\n|AffectedRecords|Number of records affected by the last operation.|\n\n## DbQueryScalar\n Executes a query that retrieves a single value from the database.\n\n This class performs its work asynchronously (it derives from <xref:System.Activities.AsyncCodeActivity%601> and uses its asynchronous capabilities).\n\n The connection information can be configured by setting a provider invariant name (`ProviderName`) and the connection string (`ConnectionString`) or just using a connection string configuration name (`ConfigFileSectionName`) from the application configuration file.\n\n The query to be executed is configured in its `Sql` property and the parameters are passed through the `Parameters` collection.\n\n After `DbQueryScalar` is executed, the scalar is returned in the `Result out` argument (of type `TResult`, that is defined in the base class <xref:System.Activities.AsyncCodeActivity%601>).\n\n```\npublic class DbQueryScalar<TResult> : AsyncCodeActivity<TResult>\n{\n    // public arguments\n    [RequiredArgument]\n    [OverloadGroup(\"ConnectionString\")]\n    [DefaultValue(null)]\n    public InArgument<string> ProviderName { get; set; }\n\n    [RequiredArgument]\n    [OverloadGroup(\"ConnectionString\")]\n    [DependsOn(\"ProviderName\")]\n    [DefaultValue(null)]\n    public InArgument<string> ConnectionString { get; set; }\n\n    [RequiredArgument]\n    [OverloadGroup(\"ConfigFileSectionName\")]\n    [DefaultValue(null)]\n    public InArgument<string> ConfigName { get; set; }\n\n    [DefaultValue(null)]\n    public CommandType CommandType { get; set; }\n\n    [RequiredArgument]\n    public InArgument<string> Sql { get; set; }\n\n    [DependsOn(\"Sql\")]\n    [DefaultValue(null)]\n    public IDictionary<string, Argument> Parameters { get; }\n}\n```\n\n|Argument|Description|\n|-|-|\n|ProviderName|ADO.NET provider invariant name. If this argument is set, then the `ConnectionString` must also be set.|\n|ConnectionString|Connection string to connect to the database. If this argument is set, then `ProviderName` must also be set.|\n|ConfigName|Name of the configuration file section where the connection information is stored. When this argument is set `ProviderName` and `ConnectionString` are not required.|\n|CommandType|Type of the <xref:System.Data.Common.DbCommand> to be executed.|\n|Sql|The SQL command to be executed.|\n|Parameters|Collection of the parameters of the SQL query.|\n|Result|Scalar that is obtained after the query is executed. This argument is of type `TResult`.|\n\n## DbQuery\n Executes a query that retrieves a list of objects. After the query is executed, a mapping function is executed (it can be <xref:System.Func%601><`DbDataReader`, `TResult`> or an <xref:System.Activities.ActivityFunc%601><`DbDataReader`, `TResult`>). This mapping function gets a record in a `DbDataReader` and maps it to the object to be returned.\n\n The connection information can be configured by setting a provider invariant name (`ProviderName`) and the connection string (`ConnectionString`) or just using a connection string configuration name (`ConfigFileSectionName`) from the application configuration file.\n\n The query to be executed is configured in its `Sql` property and the parameters are passed through the `Parameters` collection.\n\n The results of the SQL query are retrieved using a `DbDataReader`. The activity iterates through the `DbDataReader` and maps the rows in the `DbDataReader` to an instance of `TResult`. The user of `DbQuery` has to provide the mapping code and this can be done in two ways: using a <xref:System.Func%601><`DbDataReader`, `TResult`> or an <xref:System.Activities.ActivityFunc%601><`DbDataReader`, `TResult`>. In the first case, the map is done in a single pulse of execution. Therefore, it is faster, but this cannot be serialized to XAML. In the last case, the map is performed in multiple pulses. Therefore, it might be slower but can be serialized to XAML and authored declaratively (any existing activity can participate in the mapping).\n\n```\npublic class DbQuery<TResult> : AsyncCodeActivity<IList<TResult>> where TResult : class\n{\n    // public arguments\n    [RequiredArgument]\n    [OverloadGroup(\"ConnectionString\")]\n    [DefaultValue(null)]\n    public InArgument<string> ProviderName { get; set; }\n\n    [RequiredArgument]\n    [OverloadGroup(\"ConnectionString\")]\n    [DependsOn(\"ProviderName\")]\n    [DefaultValue(null)]\n    public InArgument<string> ConnectionString { get; set; }\n\n    [RequiredArgument]\n    [OverloadGroup(\"ConfigFileSectionName\")]\n    [DefaultValue(null)]\n    public InArgument<string> ConfigName { get; set; }\n\n    [DefaultValue(null)]\n    public CommandType CommandType { get; set; }\n\n    [RequiredArgument]\n    public InArgument<string> Sql { get; set; }\n\n    [DependsOn(\"Sql\")]\n    [DefaultValue(null)]\n    public IDictionary<string, Argument> Parameters { get; }\n\n    [OverloadGroup(\"DirectMapping\")]\n    [DefaultValue(null)]\n    public Func<DbDataReader, TResult> Mapper { get; set; }\n\n    [OverloadGroup(\"MultiplePulseMapping\")]\n    [DefaultValue(null)]\n    public ActivityFunc<DbDataReader, TResult> MapperFunc { get; set; }\n}\n```\n\n|Argument|Description|\n|-|-|\n|ProviderName|ADO.NET provider invariant name. If this argument is set, then the `ConnectionString` must also be set.|\n|ConnectionString|Connection string to connect to the database. If this argument is set, then `ProviderName` must also be set.|\n|ConfigName|Name of the configuration file section where the connection information is stored. When this argument is set `ProviderName` and `ConnectionString` are not required.|\n|CommandType|Type of the <xref:System.Data.Common.DbCommand> to be executed.|\n|Sql|The SQL command to be executed.|\n|Parameters|Collection of the parameters of the SQL query.|\n|Mapper|Mapping function (<xref:System.Func%601><`DbDataReader`, `TResult`>) that takes a record in the `DataReader` obtained as result of executing the query and returns an instance of an object of type `TResult` to be added to the `Result` collection.<br /><br /> In this case, mapping is done in a single pulse of execution, but it cannot be authored declaratively using the designer.|\n|MapperFunc|Mapping function (<xref:System.Activities.ActivityFunc%601><`DbDataReader`, `TResult`>) that takes a record in the `DataReader` obtained as result of executing the query and returns an instance of an object of type `TResult` to be added to the `Result` collection.<br /><br /> In this case, the mapping is done in multiple pulses of execution. This function can be serialized to XAML and authored declaratively (any existing activity can participate in the mapping).|\n|Result|List of objects obtained as result of executing the query and executing the mapping function for each record in the `DataReader`.|\n\n## DbQueryDataSet\n Executes a query that returns a <xref:System.Data.DataSet>. This class performs its work asynchronously. It derives from <xref:System.Activities.AsyncCodeActivity><`TResult`> and uses its asynchronous capabilities.\n\n The connection information can be configured by setting a provider invariant name (`ProviderName`) and the connection string (`ConnectionString`) or just using a connection string configuration name (`ConfigFileSectionName`) from the application configuration file.\n\n The query to be executed is configured in its `Sql` property and the parameters are passed through the `Parameters` collection.\n\n After the `DbQueryDataSet` is executed the `DataSet` is returned in the `Result out` argument (of type `TResult`, that is defined in the base class <xref:System.Activities.AsyncCodeActivity%601>).\n\n```\npublic class DbQueryDataSet : AsyncCodeActivity<DataSet>\n{\n    // public arguments\n    [RequiredArgument]\n    [OverloadGroup(\"ConnectionString\")]\n    [DefaultValue(null)]\n    public InArgument<string> ProviderName { get; set; }\n\n    [RequiredArgument]\n    [OverloadGroup(\"ConnectionString\")]\n    [DependsOn(\"ProviderName\")]\n    [DefaultValue(null)]\n    public InArgument<string> ConnectionString { get; set; }\n\n    [RequiredArgument]\n    [OverloadGroup(\"ConfigFileSectionName\")]\n    [DefaultValue(null)]\n    public InArgument<string> ConfigName { get; set; }\n\n    [DefaultValue(null)]\n    public CommandType CommandType { get; set; }\n\n    [RequiredArgument]\n    public InArgument<string> Sql { get; set; }\n\n    [DependsOn(\"Sql\")]\n    [DefaultValue(null)]\n    public IDictionary<string, Argument> Parameters { get; }\n}\n```\n\n|Argument|Description|\n|-|-|\n|ProviderName|ADO.NET provider invariant name. If this argument is set, then the `ConnectionString` must also be set.|\n|ConnectionString|Connection string to connect to the database. If this argument is set, then `ProviderName` must also be set.|\n|ConfigName|Name of the configuration file section where the connection information is stored. When this argument is set `ProviderName` and `ConnectionString` are not required.|\n|CommandType|Type of the <xref:System.Data.Common.DbCommand> to be executed.|\n|Sql|The SQL command to be executed.|\n|Parameters|Collection of the parameters of the SQL query.|\n|Result|<xref:System.Data.DataSet> that is obtained after the query is executed.|\n\n## Configuring Connection Information\n All DbActivities share the same configuration parameters. They can be configured in two ways:\n\n-   `ConnectionString + InvariantName`: Set the ADO.NET provider invariant name and connection string.\n\n    ```\n    Activity dbSelectCount = new DbQueryScalar<DateTime>()\n    {\n        ProviderName = \"System.Data.SqlClient\",\n        ConnectionString = @\"Data Source=.\\SQLExpress;\n                             Initial Catalog=DbActivitiesSample;\n                             Integrated Security=True\",\n        Sql = \"SELECT GetDate()\"\n    };\n    ```\n\n-   `ConfigName`: Set the name of the configuration section that contains the connection information.\n\n    ```xml\n    <connectionStrings>\n        <add name=\"DbActivitiesSample\"\n             providerName=\"System.Data.SqlClient\"\n             connectionString=\"Data Source=.\\SQLExpress;Initial Catalog=DbActivitiesSample;Integrated Security=true\"/>\n      </connectionStrings>\n    ```\n\n-   In the activity:\n\n    ```\n    Activity dbSelectCount = new DbQueryScalar<int>()\n    {\n        ConfigName = \"DbActivitiesSample\",\n        Sql = \"SELECT COUNT(*) FROM Roles\"\n    };\n    ```\n\n## Running this sample\n\n### Setup instructions\n This sample uses a database. A set-up and load script (Setup.cmd) is provided with the sample. You must execute that file using the command prompt.\n\n The Setup.cmd script invokes the CreateDb.sql script file, which contains SQL commands that do the following:\n\n-   Creates a database called DbActivitiesSample.\n\n-   Creates the Roles table.\n\n-   Creates Employees table.\n\n-   Inserts three records into the Roles table.\n\n-   Inserts twelve records into the Employees table.\n\n##### To run Setup.cmd\n\n1.  Open a command prompt.\n\n2.  Go to the DbActivities sample folder.\n\n3.  Type \"setup.cmd\" and press ENTER.\n\n    > [!NOTE]\n    >  Setup.cmd attempts to install the sample in your local machine SqlExpress instance. If you want to install it in other SQL server instance, edit Setup.cmd with the new instance name.\n\n##### To uninstall the sample database\n\n1.  Run Cleanup.cmd from the sample folder in a command prompt.\n\n##### To run the sample\n\n1.  Open the solution in Visual Studio 2010\n\n2.  To compile the solution, press CTRL+SHIFT+B.\n\n3.  To run the sample without debugging, press CTRL+F5.\n\n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Scenario\\ActivityLibrary\\DbActivities`\n","nodes":[{"pos":[4,110],"embed":true,"restype":"x-metadata","content":"title: \"Database Access Activities\"\nms.date: \"03/30/2017\"\nms.assetid: 174a381e-1343-46a8-a62c-7c2ae2c4f0b2","nodes":[{"content":"Database Access Activities","nodes":[{"pos":[0,26],"content":"Database Access Activities","nodes":[{"content":"Database Access Activities","pos":[0,26]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[117,143],"content":"Database Access Activities","linkify":"Database Access Activities","nodes":[{"content":"Database Access Activities","pos":[0,26]}]},{"content":"Database access activities allow you to access a database within a workflow.","pos":[144,220]},{"content":"These activities allow accessing databases to retrieve or modify information and use <bpt id=\"p1\">[</bpt>ADO.NET<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=166081)</ept> to access the database.","pos":[221,387],"source":" These activities allow accessing databases to retrieve or modify information and use [ADO.NET](https://go.microsoft.com/fwlink/?LinkId=166081) to access the database."},{"pos":[395,527],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[14,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to (download page) to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[571,742],"source":"If this directory does not exist, go to (download page) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[743,793]},{"pos":[877,896],"content":"Database Activities","linkify":"Database Activities","nodes":[{"content":"Database Activities","pos":[0,19]}]},{"content":"The following sections detail the list of activities included in this sample.","pos":[898,975]},{"pos":[980,988],"content":"DbUpdate","linkify":"DbUpdate","nodes":[{"content":"DbUpdate","pos":[0,8]}]},{"content":"Executes a SQL query that produces a modification in the database (insert, update, delete, and other modifications).","pos":[990,1106]},{"pos":[1109,1253],"content":"This class performs its work asynchronously (it derives from <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity&gt;</ph> and uses its asynchronous capabilities).","source":"This class performs its work asynchronously (it derives from <xref:System.Activities.AsyncCodeActivity> and uses its asynchronous capabilities)."},{"pos":[1256,1521],"content":"The connection information can be configured by setting a provider invariant name (<ph id=\"ph1\">`ProviderName`</ph>) and the connection string (<ph id=\"ph2\">`ConnectionString`</ph>) or just using a connection string configuration name (<ph id=\"ph3\">`ConfigFileSectionName`</ph>) from the application configuration file.","source":"The connection information can be configured by setting a provider invariant name (`ProviderName`) and the connection string (`ConnectionString`) or just using a connection string configuration name (`ConfigFileSectionName`) from the application configuration file."},{"pos":[1524,1651],"content":"The query to be executed is configured in its <ph id=\"ph1\">`Sql`</ph> property and the parameters are passed through the <ph id=\"ph2\">`Parameters`</ph> collection.","source":"The query to be executed is configured in its `Sql` property and the parameters are passed through the `Parameters` collection."},{"pos":[1654,1761],"content":"After <ph id=\"ph1\">`DbUpdate`</ph> is executed, the number of affected records is returned in the <ph id=\"ph2\">`AffectedRecords`</ph> property.","source":"After `DbUpdate` is executed, the number of affected records is returned in the `AffectedRecords` property."},{"content":"Argument","pos":[2640,2648]},{"content":"Description","pos":[2649,2660]},{"content":"ProviderName","pos":[2669,2681]},{"content":"ADO.NET provider invariant name.","pos":[2682,2714]},{"content":"If this argument is set, then the <ph id=\"ph1\">`ConnectionString`</ph> must also be set.","pos":[2715,2785],"source":" If this argument is set, then the `ConnectionString` must also be set."},{"content":"ConnectionString","pos":[2788,2804]},{"content":"Connection string to connect to the database.","pos":[2805,2850]},{"content":"If this argument is set, then <ph id=\"ph1\">`ProviderName`</ph> must also be set.","pos":[2851,2913],"source":" If this argument is set, then `ProviderName` must also be set."},{"content":"ConfigName","pos":[2916,2926]},{"content":"Name of the configuration file section where the connection information is stored.","pos":[2927,3009]},{"content":"When this argument is set <ph id=\"ph1\">`ProviderName`</ph> and <ph id=\"ph2\">`ConnectionString`</ph> are not required.","pos":[3010,3091],"source":" When this argument is set `ProviderName` and `ConnectionString` are not required."},{"content":"CommandType","pos":[3094,3105]},{"pos":[3106,3169],"content":"Type of the <ph id=\"ph1\">&lt;xref:System.Data.Common.DbCommand&gt;</ph> to be executed.","source":"Type of the <xref:System.Data.Common.DbCommand> to be executed."},{"content":"Sql","pos":[3172,3175]},{"content":"The SQL command to be executed.","pos":[3176,3207]},{"content":"Parameters","pos":[3210,3220]},{"content":"Collection of the parameters of the SQL query.","pos":[3221,3267]},{"content":"AffectedRecords","pos":[3270,3285]},{"content":"Number of records affected by the last operation.","pos":[3286,3335]},{"pos":[3341,3354],"content":"DbQueryScalar","linkify":"DbQueryScalar","nodes":[{"content":"DbQueryScalar","pos":[0,13]}]},{"content":"Executes a query that retrieves a single value from the database.","pos":[3356,3421]},{"pos":[3424,3572],"content":"This class performs its work asynchronously (it derives from <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity%601&gt;</ph> and uses its asynchronous capabilities).","source":"This class performs its work asynchronously (it derives from <xref:System.Activities.AsyncCodeActivity%601> and uses its asynchronous capabilities)."},{"pos":[3575,3840],"content":"The connection information can be configured by setting a provider invariant name (<ph id=\"ph1\">`ProviderName`</ph>) and the connection string (<ph id=\"ph2\">`ConnectionString`</ph>) or just using a connection string configuration name (<ph id=\"ph3\">`ConfigFileSectionName`</ph>) from the application configuration file.","source":"The connection information can be configured by setting a provider invariant name (`ProviderName`) and the connection string (`ConnectionString`) or just using a connection string configuration name (`ConfigFileSectionName`) from the application configuration file."},{"pos":[3843,3970],"content":"The query to be executed is configured in its <ph id=\"ph1\">`Sql`</ph> property and the parameters are passed through the <ph id=\"ph2\">`Parameters`</ph> collection.","source":"The query to be executed is configured in its `Sql` property and the parameters are passed through the `Parameters` collection."},{"pos":[3973,4162],"content":"After <ph id=\"ph1\">`DbQueryScalar`</ph> is executed, the scalar is returned in the <ph id=\"ph2\">`Result out`</ph> argument (of type <ph id=\"ph3\">`TResult`</ph>, that is defined in the base class <ph id=\"ph4\">&lt;xref:System.Activities.AsyncCodeActivity%601&gt;</ph>).","source":"After `DbQueryScalar` is executed, the scalar is returned in the `Result out` argument (of type `TResult`, that is defined in the base class <xref:System.Activities.AsyncCodeActivity%601>)."},{"content":"Argument","pos":[5000,5008]},{"content":"Description","pos":[5009,5020]},{"content":"ProviderName","pos":[5029,5041]},{"content":"ADO.NET provider invariant name.","pos":[5042,5074]},{"content":"If this argument is set, then the <ph id=\"ph1\">`ConnectionString`</ph> must also be set.","pos":[5075,5145],"source":" If this argument is set, then the `ConnectionString` must also be set."},{"content":"ConnectionString","pos":[5148,5164]},{"content":"Connection string to connect to the database.","pos":[5165,5210]},{"content":"If this argument is set, then <ph id=\"ph1\">`ProviderName`</ph> must also be set.","pos":[5211,5273],"source":" If this argument is set, then `ProviderName` must also be set."},{"content":"ConfigName","pos":[5276,5286]},{"content":"Name of the configuration file section where the connection information is stored.","pos":[5287,5369]},{"content":"When this argument is set <ph id=\"ph1\">`ProviderName`</ph> and <ph id=\"ph2\">`ConnectionString`</ph> are not required.","pos":[5370,5451],"source":" When this argument is set `ProviderName` and `ConnectionString` are not required."},{"content":"CommandType","pos":[5454,5465]},{"pos":[5466,5529],"content":"Type of the <ph id=\"ph1\">&lt;xref:System.Data.Common.DbCommand&gt;</ph> to be executed.","source":"Type of the <xref:System.Data.Common.DbCommand> to be executed."},{"content":"Sql","pos":[5532,5535]},{"content":"The SQL command to be executed.","pos":[5536,5567]},{"content":"Parameters","pos":[5570,5580]},{"content":"Collection of the parameters of the SQL query.","pos":[5581,5627]},{"content":"Result","pos":[5630,5636]},{"content":"Scalar that is obtained after the query is executed.","pos":[5637,5689]},{"content":"This argument is of type <ph id=\"ph1\">`TResult`</ph>.","pos":[5690,5725],"source":" This argument is of type `TResult`."},{"pos":[5731,5738],"content":"DbQuery","linkify":"DbQuery","nodes":[{"content":"DbQuery","pos":[0,7]}]},{"content":"Executes a query that retrieves a list of objects.","pos":[5740,5790]},{"content":"After the query is executed, a mapping function is executed (it can be <ph id=\"ph1\">&lt;xref:System.Func%601&gt;</ph><ph id=\"ph2\">&lt;</ph><ph id=\"ph3\">`DbDataReader`</ph>, <ph id=\"ph4\">`TResult`</ph>&gt; or an <ph id=\"ph5\">&lt;xref:System.Activities.ActivityFunc%601&gt;</ph><ph id=\"ph6\">&lt;</ph><ph id=\"ph7\">`DbDataReader`</ph>, <ph id=\"ph8\">`TResult`</ph>&gt;).","pos":[5791,5988],"source":" After the query is executed, a mapping function is executed (it can be <xref:System.Func%601><`DbDataReader`, `TResult`> or an <xref:System.Activities.ActivityFunc%601><`DbDataReader`, `TResult`>)."},{"content":"This mapping function gets a record in a <ph id=\"ph1\">`DbDataReader`</ph> and maps it to the object to be returned.","pos":[5989,6086],"source":" This mapping function gets a record in a `DbDataReader` and maps it to the object to be returned."},{"pos":[6089,6354],"content":"The connection information can be configured by setting a provider invariant name (<ph id=\"ph1\">`ProviderName`</ph>) and the connection string (<ph id=\"ph2\">`ConnectionString`</ph>) or just using a connection string configuration name (<ph id=\"ph3\">`ConfigFileSectionName`</ph>) from the application configuration file.","source":"The connection information can be configured by setting a provider invariant name (`ProviderName`) and the connection string (`ConnectionString`) or just using a connection string configuration name (`ConfigFileSectionName`) from the application configuration file."},{"pos":[6357,6484],"content":"The query to be executed is configured in its <ph id=\"ph1\">`Sql`</ph> property and the parameters are passed through the <ph id=\"ph2\">`Parameters`</ph> collection.","source":"The query to be executed is configured in its `Sql` property and the parameters are passed through the `Parameters` collection."},{"content":"The results of the SQL query are retrieved using a <ph id=\"ph1\">`DbDataReader`</ph>.","pos":[6487,6553],"source":"The results of the SQL query are retrieved using a `DbDataReader`."},{"content":"The activity iterates through the <ph id=\"ph1\">`DbDataReader`</ph> and maps the rows in the <ph id=\"ph2\">`DbDataReader`</ph> to an instance of <ph id=\"ph3\">`TResult`</ph>.","pos":[6554,6671],"source":" The activity iterates through the `DbDataReader` and maps the rows in the `DbDataReader` to an instance of `TResult`."},{"content":"The user of <ph id=\"ph1\">`DbQuery`</ph> has to provide the mapping code and this can be done in two ways: using a <ph id=\"ph2\">&lt;xref:System.Func%601&gt;</ph><ph id=\"ph3\">&lt;</ph><ph id=\"ph4\">`DbDataReader`</ph>, <ph id=\"ph5\">`TResult`</ph>&gt; or an <ph id=\"ph6\">&lt;xref:System.Activities.ActivityFunc%601&gt;</ph><ph id=\"ph7\">&lt;</ph><ph id=\"ph8\">`DbDataReader`</ph>, <ph id=\"ph9\">`TResult`</ph>&gt;.","pos":[6672,6893],"source":" The user of `DbQuery` has to provide the mapping code and this can be done in two ways: using a <xref:System.Func%601><`DbDataReader`, `TResult`> or an <xref:System.Activities.ActivityFunc%601><`DbDataReader`, `TResult`>."},{"content":"In the first case, the map is done in a single pulse of execution.","pos":[6894,6960]},{"content":"Therefore, it is faster, but this cannot be serialized to XAML.","pos":[6961,7024]},{"content":"In the last case, the map is performed in multiple pulses.","pos":[7025,7083]},{"content":"Therefore, it might be slower but can be serialized to XAML and authored declaratively (any existing activity can participate in the mapping).","pos":[7084,7226]},{"content":"Argument","pos":[8352,8360]},{"content":"Description","pos":[8361,8372]},{"content":"ProviderName","pos":[8381,8393]},{"content":"ADO.NET provider invariant name.","pos":[8394,8426]},{"content":"If this argument is set, then the <ph id=\"ph1\">`ConnectionString`</ph> must also be set.","pos":[8427,8497],"source":" If this argument is set, then the `ConnectionString` must also be set."},{"content":"ConnectionString","pos":[8500,8516]},{"content":"Connection string to connect to the database.","pos":[8517,8562]},{"content":"If this argument is set, then <ph id=\"ph1\">`ProviderName`</ph> must also be set.","pos":[8563,8625],"source":" If this argument is set, then `ProviderName` must also be set."},{"content":"ConfigName","pos":[8628,8638]},{"content":"Name of the configuration file section where the connection information is stored.","pos":[8639,8721]},{"content":"When this argument is set <ph id=\"ph1\">`ProviderName`</ph> and <ph id=\"ph2\">`ConnectionString`</ph> are not required.","pos":[8722,8803],"source":" When this argument is set `ProviderName` and `ConnectionString` are not required."},{"content":"CommandType","pos":[8806,8817]},{"pos":[8818,8881],"content":"Type of the <ph id=\"ph1\">&lt;xref:System.Data.Common.DbCommand&gt;</ph> to be executed.","source":"Type of the <xref:System.Data.Common.DbCommand> to be executed."},{"content":"Sql","pos":[8884,8887]},{"content":"The SQL command to be executed.","pos":[8888,8919]},{"content":"Parameters","pos":[8922,8932]},{"content":"Collection of the parameters of the SQL query.","pos":[8933,8979]},{"content":"Mapper","pos":[8982,8988]},{"content":"Mapping function (<ph id=\"ph1\">&lt;xref:System.Func%601&gt;</ph><ph id=\"ph2\">&lt;</ph><ph id=\"ph3\">`DbDataReader`</ph>, <ph id=\"ph4\">`TResult`</ph>&gt;) that takes a record in the <ph id=\"ph5\">`DataReader`</ph> obtained as result of executing the query and returns an instance of an object of type <ph id=\"ph6\">`TResult`</ph> to be added to the <ph id=\"ph7\">`Result`</ph> collection.","pos":[8989,9234],"source":"Mapping function (<xref:System.Func%601><`DbDataReader`, `TResult`>) that takes a record in the `DataReader` obtained as result of executing the query and returns an instance of an object of type `TResult` to be added to the `Result` collection."},{"content":"In this case, mapping is done in a single pulse of execution, but it cannot be authored declaratively using the designer.","pos":[9247,9368]},{"content":"MapperFunc","pos":[9371,9381]},{"content":"Mapping function (<ph id=\"ph1\">&lt;xref:System.Activities.ActivityFunc%601&gt;</ph><ph id=\"ph2\">&lt;</ph><ph id=\"ph3\">`DbDataReader`</ph>, <ph id=\"ph4\">`TResult`</ph>&gt;) that takes a record in the <ph id=\"ph5\">`DataReader`</ph> obtained as result of executing the query and returns an instance of an object of type <ph id=\"ph6\">`TResult`</ph> to be added to the <ph id=\"ph7\">`Result`</ph> collection.","pos":[9382,9646],"source":"Mapping function (<xref:System.Activities.ActivityFunc%601><`DbDataReader`, `TResult`>) that takes a record in the `DataReader` obtained as result of executing the query and returns an instance of an object of type `TResult` to be added to the `Result` collection."},{"content":"In this case, the mapping is done in multiple pulses of execution.","pos":[9659,9725]},{"content":"This function can be serialized to XAML and authored declaratively (any existing activity can participate in the mapping).","pos":[9726,9848]},{"content":"Result","pos":[9851,9857]},{"pos":[9858,9987],"content":"List of objects obtained as result of executing the query and executing the mapping function for each record in the <ph id=\"ph1\">`DataReader`</ph>.","source":"List of objects obtained as result of executing the query and executing the mapping function for each record in the `DataReader`."},{"pos":[9993,10007],"content":"DbQueryDataSet","linkify":"DbQueryDataSet","nodes":[{"content":"DbQueryDataSet","pos":[0,14]}]},{"content":"Executes a query that returns a <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph>.","pos":[10009,10068],"source":"Executes a query that returns a <xref:System.Data.DataSet>."},{"content":"This class performs its work asynchronously.","pos":[10069,10113]},{"content":"It derives from <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity&gt;</ph><ph id=\"ph2\">&lt;</ph><ph id=\"ph3\">`TResult`</ph>&gt; and uses its asynchronous capabilities.","pos":[10114,10223],"source":" It derives from <xref:System.Activities.AsyncCodeActivity><`TResult`> and uses its asynchronous capabilities."},{"pos":[10226,10491],"content":"The connection information can be configured by setting a provider invariant name (<ph id=\"ph1\">`ProviderName`</ph>) and the connection string (<ph id=\"ph2\">`ConnectionString`</ph>) or just using a connection string configuration name (<ph id=\"ph3\">`ConfigFileSectionName`</ph>) from the application configuration file.","source":"The connection information can be configured by setting a provider invariant name (`ProviderName`) and the connection string (`ConnectionString`) or just using a connection string configuration name (`ConfigFileSectionName`) from the application configuration file."},{"pos":[10494,10621],"content":"The query to be executed is configured in its <ph id=\"ph1\">`Sql`</ph> property and the parameters are passed through the <ph id=\"ph2\">`Parameters`</ph> collection.","source":"The query to be executed is configured in its `Sql` property and the parameters are passed through the `Parameters` collection."},{"pos":[10624,10820],"content":"After the <ph id=\"ph1\">`DbQueryDataSet`</ph> is executed the <ph id=\"ph2\">`DataSet`</ph> is returned in the <ph id=\"ph3\">`Result out`</ph> argument (of type <ph id=\"ph4\">`TResult`</ph>, that is defined in the base class <ph id=\"ph5\">&lt;xref:System.Activities.AsyncCodeActivity%601&gt;</ph>).","source":"After the `DbQueryDataSet` is executed the `DataSet` is returned in the `Result out` argument (of type `TResult`, that is defined in the base class <xref:System.Activities.AsyncCodeActivity%601>)."},{"content":"Argument","pos":[11650,11658]},{"content":"Description","pos":[11659,11670]},{"content":"ProviderName","pos":[11679,11691]},{"content":"ADO.NET provider invariant name.","pos":[11692,11724]},{"content":"If this argument is set, then the <ph id=\"ph1\">`ConnectionString`</ph> must also be set.","pos":[11725,11795],"source":" If this argument is set, then the `ConnectionString` must also be set."},{"content":"ConnectionString","pos":[11798,11814]},{"content":"Connection string to connect to the database.","pos":[11815,11860]},{"content":"If this argument is set, then <ph id=\"ph1\">`ProviderName`</ph> must also be set.","pos":[11861,11923],"source":" If this argument is set, then `ProviderName` must also be set."},{"content":"ConfigName","pos":[11926,11936]},{"content":"Name of the configuration file section where the connection information is stored.","pos":[11937,12019]},{"content":"When this argument is set <ph id=\"ph1\">`ProviderName`</ph> and <ph id=\"ph2\">`ConnectionString`</ph> are not required.","pos":[12020,12101],"source":" When this argument is set `ProviderName` and `ConnectionString` are not required."},{"content":"CommandType","pos":[12104,12115]},{"pos":[12116,12179],"content":"Type of the <ph id=\"ph1\">&lt;xref:System.Data.Common.DbCommand&gt;</ph> to be executed.","source":"Type of the <xref:System.Data.Common.DbCommand> to be executed."},{"content":"Sql","pos":[12182,12185]},{"content":"The SQL command to be executed.","pos":[12186,12217]},{"content":"Parameters","pos":[12220,12230]},{"content":"Collection of the parameters of the SQL query.","pos":[12231,12277]},{"content":"Result","pos":[12280,12286]},{"pos":[12287,12359],"content":"<ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> that is obtained after the query is executed.","source":"<xref:System.Data.DataSet> that is obtained after the query is executed."},{"pos":[12365,12399],"content":"Configuring Connection Information","linkify":"Configuring Connection Information","nodes":[{"content":"Configuring Connection Information","pos":[0,34]}]},{"content":"All DbActivities share the same configuration parameters.","pos":[12401,12458]},{"content":"They can be configured in two ways:","pos":[12459,12494]},{"pos":[12500,12598],"content":"<ph id=\"ph1\">`ConnectionString + InvariantName`</ph>: Set the ADO.NET provider invariant name and connection string.","source":"`ConnectionString + InvariantName`: Set the ADO.NET provider invariant name and connection string."},{"pos":[12950,13047],"content":"<ph id=\"ph1\">`ConfigName`</ph>: Set the name of the configuration section that contains the connection information.","source":"`ConfigName`: Set the name of the configuration section that contains the connection information."},{"content":"In the activity:","pos":[13332,13348]},{"pos":[13523,13542],"content":"Running this sample","linkify":"Running this sample","nodes":[{"content":"Running this sample","pos":[0,19]}]},{"pos":[13548,13566],"content":"Setup instructions","linkify":"Setup instructions","nodes":[{"content":"Setup instructions","pos":[0,18]}]},{"content":"This sample uses a database.","pos":[13568,13596]},{"content":"A set-up and load script (Setup.cmd) is provided with the sample.","pos":[13597,13662]},{"content":"You must execute that file using the command prompt.","pos":[13663,13715]},{"content":"The Setup.cmd script invokes the CreateDb.sql script file, which contains SQL commands that do the following:","pos":[13718,13827]},{"content":"Creates a database called DbActivitiesSample.","pos":[13833,13878]},{"content":"Creates the Roles table.","pos":[13884,13908]},{"content":"Creates Employees table.","pos":[13914,13938]},{"content":"Inserts three records into the Roles table.","pos":[13944,13987]},{"content":"Inserts twelve records into the Employees table.","pos":[13993,14041]},{"pos":[14049,14065],"content":"To run Setup.cmd","linkify":"To run Setup.cmd","nodes":[{"content":"To run Setup.cmd","pos":[0,16]}]},{"content":"Open a command prompt.","pos":[14071,14093]},{"content":"Go to the DbActivities sample folder.","pos":[14099,14136]},{"content":"Type \"setup.cmd\" and press ENTER.","pos":[14142,14175]},{"pos":[14183,14380],"content":"[!NOTE]\nSetup.cmd attempts to install the sample in your local machine SqlExpress instance. If you want to install it in other SQL server instance, edit Setup.cmd with the new instance name.","leadings":["","    >  "],"nodes":[{"content":"Setup.cmd attempts to install the sample in your local machine SqlExpress instance. If you want to install it in other SQL server instance, edit Setup.cmd with the new instance name.","pos":[8,190],"nodes":[{"content":"Setup.cmd attempts to install the sample in your local machine SqlExpress instance.","pos":[0,83]},{"content":"If you want to install it in other SQL server instance, edit Setup.cmd with the new instance name.","pos":[84,182]}]}]},{"pos":[14388,14420],"content":"To uninstall the sample database","linkify":"To uninstall the sample database","nodes":[{"content":"To uninstall the sample database","pos":[0,32]}]},{"content":"Run Cleanup.cmd from the sample folder in a command prompt.","pos":[14426,14485]},{"pos":[14493,14510],"content":"To run the sample","linkify":"To run the sample","nodes":[{"content":"To run the sample","pos":[0,17]}]},{"content":"Open the solution in Visual Studio 2010","pos":[14516,14555]},{"content":"To compile the solution, press CTRL+SHIFT+B.","pos":[14561,14605]},{"content":"To run the sample without debugging, press CTRL+F5.","pos":[14611,14662]},{"pos":[14666,14798],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[14,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[14852,15162],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[15163,15213]}]}