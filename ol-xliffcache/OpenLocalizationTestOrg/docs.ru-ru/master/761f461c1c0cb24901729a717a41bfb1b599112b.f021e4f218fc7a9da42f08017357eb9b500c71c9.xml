{"content":"---\ntitle: \"How to: Specify Channel Security Credentials\"\nms.date: \"03/30/2017\"\nms.assetid: f8e03f47-9c4f-4dd5-8f85-429e6d876119\n---\n# How to: Specify Channel Security Credentials\nThe Windows Communication Foundation (WCF) Service Moniker allows COM applications to call WCF services. Most WCF services require the client to specify credentials for authentication and authorization. When calling a WCF service from a WCF client, you can specify these credentials in managed code or in an application configuration file. When calling a WCF service from a COM application, you can use the <xref:System.ServiceModel.ComIntegration.IChannelCredentials> interface to specify credentials. This topic will illustrate various ways to specify credentials using the <xref:System.ServiceModel.ComIntegration.IChannelCredentials> interface.  \n  \n> [!NOTE]\n>  <xref:System.ServiceModel.ComIntegration.IChannelCredentials> is an IDispatch-based interface and you will not get IntelliSense functionality in the Visual Studio environment.  \n  \n This article will use the WCF service defined in the [Message Security Sample](../../../../docs/framework/wcf/samples/message-security-sample.md).  \n  \n### To specify a client certificate  \n  \n1.  Run the Setup.bat file in the Message Security directory to create and install the required test certificates.  \n  \n2.  Open the Message Security project.  \n  \n3.  Add `[ServiceBehavior(Namespace=\"http://Microsoft.ServiceModel.Samples\")]` to the `ICalculator` interface definition.  \n  \n4.  Add `bindingNamespace=\"http://Microsoft.ServiceModel.Samples\"` to the endpoint tag in the App.config for the service.  \n  \n5.  Build the Message Security Sample and run Service.exe. Use Internet Explorer and browse to the service's URI (http://localhost:8000/ServiceModelSamples/Service) to ensure that the service is working.  \n  \n6.  Open Visual Basic 6.0 and create a new Standard .exe file. Add a button to the form and double-click the button to add the following code to the Click handler:  \n  \n    ```  \n        monString = \"service:mexAddress=http://localhost:8000/ServiceModelSamples/Service?wsdl\"  \n        monString = monString + \", address=http://localhost:8000/ServiceModelSamples/Service\"  \n        monString = monString + \", contract=ICalculator, contractNamespace=http://Microsoft.ServiceModel.Samples\"  \n        monString = monString + \", binding=BasicHttpBinding_ICalculator, bindingNamespace=http://Microsoft.ServiceModel.Samples\"  \n  \n        Set monikerProxy = GetObject(monString)  \n  \n        'Set the Service Certificate.  \n     monikerProxy.ChannelCredentials.SetServiceCertificateAuthentication \"CurrentUser\", \"NoCheck\", \"PeerOrChainTrust\"  \n    monikerProxy.ChannelCredentials.SetDefaultServiceCertificateFromStore \"CurrentUser\", \"TrustedPeople\", \"FindBySubjectName\", \"localhost\"  \n  \n        'Set the Client Certificate.  \n        monikerProxy.ChannelCredentials.SetClientCertificateFromStoreByName \"CN=client.com\", \"CurrentUser\", \"My\"  \n        MsgBox monikerProxy.Add(3, 4)  \n    ```  \n  \n7.  Run the Visual Basic application and verify the results.  \n  \n     The Visual Basic application will display a message box with the result from calling Add(3, 4). <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetClientCertificateFromFile%28System.String%2CSystem.String%2CSystem.String%29> or <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetClientCertificateFromStoreByName%28System.String%2CSystem.String%2CSystem.String%29> can also be used in place of <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetClientCertificateFromStore%28System.String%2CSystem.String%2CSystem.String%2CSystem.Object%29> to set the Client Certificate:  \n  \n    ```  \n    monikerProxy.ChannelCredentials.SetClientCertificateFromFile \"C:\\MyClientCert.pfx\", \"password\", \"DefaultKeySet\"  \n    ```  \n  \n> [!NOTE]\n>  For this call to work, the client certificate needs to be trusted on the machine the client is running on.  \n  \n> [!NOTE]\n>  If the moniker is malformed or if the service is unavailable, the call to `GetObject` will return an error saying \"Invalid Syntax.\" If you receive this error, make sure the moniker you are using is correct and the service is available.  \n  \n### To specify user name and password  \n  \n1.  Modify the Service App.config file to use the `wsHttpBinding`. This is required for user name and password validation:  \n\n2.  Set the `clientCredentialType` to UserName:  \n\n3.  Open Visual Basic 6.0 and create a new Standard .exe file. Add a button to the form and double-click the button to add the following code to the Click handler:  \n  \n    ```  \n    monString = \"service:mexAddress=http://localhost:8000/ServiceModelSamples/Service?wsdl\"  \n    monString = monString + \", address=http://localhost:8000/ServiceModelSamples/Service\"  \n    monString = monString + \", contract=ICalculator, contractNamespace=http://Microsoft.ServiceModel.Samples\"  \n    monString = monString + \", binding=WSHttpBinding_ICalculator, bindingNamespace=http://Microsoft.ServiceModel.Samples\"  \n  \n    Set monikerProxy = GetObject(monString)  \n  \n    monikerProxy.ChannelCredentials.SetServiceCertificateAuthentication \"CurrentUser\", \"NoCheck\", \"PeerOrChainTrust\"  \n    monikerProxy.ChannelCredentials.SetUserNameCredential \"username\", \"password\"  \n  \n    MsgBox monikerProxy.Add(3, 4)  \n    ```  \n  \n4.  Run the Visual Basic application and verify the results. The Visual Basic application will display a message box with the result from calling Add(3, 4).  \n  \n    > [!NOTE]\n    >  The binding specified in the service moniker in this sample has been changed to WSHttpBinding_ICalculator. Also note that you must supply a valid user name and password in the call to <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetUserNameCredential%28System.String%2CSystem.String%29>.  \n  \n### To specify Windows Credentials  \n  \n1.  Set `clientCredentialType` to Windows in the Service App.config file:  \n\n2.  Open Visual Basic 6.0 and create a new Standard .exe file. Add a button to the form and double-click the button to add the following code to the Click handler:  \n  \n    ```  \n    monString = \"service:mexAddress=http://localhost:8000/ServiceModelSamples/Service?wsdl\"  \n    monString = monString + \", address=http://localhost:8000/ServiceModelSamples/Service\"  \n    monString = monString + \", contract=ICalculator, contractNamespace=http://Microsoft.ServiceModel.Samples\"  \n    monString = monString + \", binding=WSHttpBinding_ICalculator, bindingNamespace=http://Microsoft.ServiceModel.Samples\"  \n    monString = monString + \", upnidentity=domain\\userID\"  \n  \n    Set monikerProxy = GetObject(monString)  \n     monikerProxy.ChannelCredentials.SetWindowsCredential \"domain\", \"userID\", \"password\", 1, True  \n  \n    MsgBox monikerProxy.Add(3, 4)  \n    ```  \n  \n3.  Run the Visual Basic application and verify the results. The Visual Basic application will display a message box with the result from calling Add(3, 4).  \n  \n    > [!NOTE]\n    >  You must replace \"domain\", \"userID\", and \"password\" with valid values.  \n  \n### To specify an issue token  \n  \n1.  Issue tokens are used only for applications using federated security. For more information about federated security, see [Federation and Issued Tokens](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md) and [Federation Sample](../../../../docs/framework/wcf/samples/federation-sample.md).  \n  \n     The following Visual Basic code example illustrates how to call the <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetIssuedToken%28System.String%2CSystem.String%2CSystem.String%29> method:  \n  \n    ```  \n        monString = \"service:mexAddress=http://localhost:8000/ServiceModelSamples/Service?wsdl\"  \n        monString = monString + \", address=http://localhost:8000/SomeService/Service\"  \n        monString = monString + \", contract=ICalculator, contractNamespace=http://SomeService.Samples\"  \n        monString = monString + \", binding=WSHttpBinding_ISomeContract, bindingNamespace=http://SomeService.Samples\"  \n  \n        Set monikerProxy = GetObject(monString)  \n    monikerProxy.SetIssuedToken(\"http://somemachine/sts\", \"bindingType\", \"binding\")  \n    ```  \n  \n     For more information about the parameters for this method, see <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetIssuedToken%28System.String%2CSystem.String%2CSystem.String%29>.  \n  \n## See also\n\n- [Federation](../../../../docs/framework/wcf/feature-details/federation.md)\n- [How to: Configure Credentials on a Federation Service](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)\n- [How to: Create a Federated Client](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)\n- [Message Security](../../../../docs/framework/wcf/feature-details/message-security-in-wcf.md)\n- [Bindings and Security](../../../../docs/framework/wcf/feature-details/bindings-and-security.md)\n","nodes":[{"pos":[4,128],"embed":true,"restype":"x-metadata","content":"title: \"How to: Specify Channel Security Credentials\"\nms.date: \"03/30/2017\"\nms.assetid: f8e03f47-9c4f-4dd5-8f85-429e6d876119","nodes":[{"content":"How to: Specify Channel Security Credentials","nodes":[{"pos":[0,44],"content":"How to: Specify Channel Security Credentials","nodes":[{"content":"How to: Specify Channel Security Credentials","pos":[0,44]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[135,179],"content":"How to: Specify Channel Security Credentials","linkify":"How to: Specify Channel Security Credentials","nodes":[{"content":"How to: Specify Channel Security Credentials","pos":[0,44]}]},{"content":"The Windows Communication Foundation (WCF) Service Moniker allows COM applications to call WCF services.","pos":[180,284]},{"content":"Most WCF services require the client to specify credentials for authentication and authorization.","pos":[285,382]},{"content":"When calling a WCF service from a WCF client, you can specify these credentials in managed code or in an application configuration file.","pos":[383,519]},{"content":"When calling a WCF service from a COM application, you can use the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ComIntegration.IChannelCredentials&gt;</ph> interface to specify credentials.","pos":[520,682],"source":" When calling a WCF service from a COM application, you can use the <xref:System.ServiceModel.ComIntegration.IChannelCredentials> interface to specify credentials."},{"content":"This topic will illustrate various ways to specify credentials using the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ComIntegration.IChannelCredentials&gt;</ph> interface.","pos":[683,828],"source":" This topic will illustrate various ways to specify credentials using the <xref:System.ServiceModel.ComIntegration.IChannelCredentials> interface."},{"pos":[836,1022],"content":"[!NOTE]\n <xref:System.ServiceModel.ComIntegration.IChannelCredentials> is an IDispatch-based interface and you will not get IntelliSense functionality in the Visual Studio environment.","leadings":["","> "],"nodes":[{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.ComIntegration.IChannelCredentials&gt;</ph> is an IDispatch-based interface and you will not get IntelliSense functionality in the Visual Studio environment.","pos":[9,184],"source":"<xref:System.ServiceModel.ComIntegration.IChannelCredentials> is an IDispatch-based interface and you will not get IntelliSense functionality in the Visual Studio environment."}]},{"pos":[1029,1175],"content":"This article will use the WCF service defined in the <bpt id=\"p1\">[</bpt>Message Security Sample<ept id=\"p1\">](../../../../docs/framework/wcf/samples/message-security-sample.md)</ept>.","source":"This article will use the WCF service defined in the [Message Security Sample](../../../../docs/framework/wcf/samples/message-security-sample.md)."},{"pos":[1185,1216],"content":"To specify a client certificate","linkify":"To specify a client certificate","nodes":[{"content":"To specify a client certificate","pos":[0,31]}]},{"content":"Run the Setup.bat file in the Message Security directory to create and install the required test certificates.","pos":[1226,1336]},{"content":"Open the Message Security project.","pos":[1346,1380]},{"pos":[1390,1507],"content":"Add <ph id=\"ph1\">`[ServiceBehavior(Namespace=\"http://Microsoft.ServiceModel.Samples\")]`</ph> to the <ph id=\"ph2\">`ICalculator`</ph> interface definition.","source":"Add `[ServiceBehavior(Namespace=\"http://Microsoft.ServiceModel.Samples\")]` to the `ICalculator` interface definition."},{"pos":[1517,1634],"content":"Add <ph id=\"ph1\">`bindingNamespace=\"http://Microsoft.ServiceModel.Samples\"`</ph> to the endpoint tag in the App.config for the service.","source":"Add `bindingNamespace=\"http://Microsoft.ServiceModel.Samples\"` to the endpoint tag in the App.config for the service."},{"content":"Build the Message Security Sample and run Service.exe.","pos":[1644,1698]},{"content":"Use Internet Explorer and browse to the service's URI (<ph id=\"ph1\">http://localhost:8000/ServiceModelSamples/Service)</ph> to ensure that the service is working.","pos":[1699,1843],"source":" Use Internet Explorer and browse to the service's URI (http://localhost:8000/ServiceModelSamples/Service) to ensure that the service is working."},{"content":"Open Visual Basic 6.0 and create a new Standard .exe file.","pos":[1853,1911]},{"content":"Add a button to the form and double-click the button to add the following code to the Click handler:","pos":[1912,2012]},{"content":"Run the Visual Basic application and verify the results.","pos":[3040,3096]},{"content":"The Visual Basic application will display a message box with the result from calling Add(3, 4).","pos":[3107,3202]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetClientCertificateFromFile%28System.String%2CSystem.String%2CSystem.String%29&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetClientCertificateFromStoreByName%28System.String%2CSystem.String%2CSystem.String%29&gt;</ph> can also be used in place of <ph id=\"ph3\">&lt;xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetClientCertificateFromStore%28System.String%2CSystem.String%2CSystem.String%2CSystem.Object%29&gt;</ph> to set the Client Certificate:","pos":[3203,3715],"source":"<xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetClientCertificateFromFile%28System.String%2CSystem.String%2CSystem.String%29> or <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetClientCertificateFromStoreByName%28System.String%2CSystem.String%2CSystem.String%29> can also be used in place of <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetClientCertificateFromStore%28System.String%2CSystem.String%2CSystem.String%2CSystem.Object%29> to set the Client Certificate:"},{"pos":[3864,3981],"content":"[!NOTE]\n For this call to work, the client certificate needs to be trusted on the machine the client is running on.","leadings":["","> "],"nodes":[{"content":"For this call to work, the client certificate needs to be trusted on the machine the client is running on.","pos":[9,115]}]},{"pos":[3989,4235],"content":"[!NOTE]\n If the moniker is malformed or if the service is unavailable, the call to `GetObject` will return an error saying \"Invalid Syntax.\" If you receive this error, make sure the moniker you are using is correct and the service is available.","leadings":["","> "],"nodes":[{"content":"If the moniker is malformed or if the service is unavailable, the call to `GetObject` will return an error saying \"Invalid Syntax.\" If you receive this error, make sure the moniker you are using is correct and the service is available.","pos":[9,244],"nodes":[{"content":"If the moniker is malformed or if the service is unavailable, the call to <ph id=\"ph1\">`GetObject`</ph> will return an error saying \"Invalid Syntax.\"","pos":[0,131],"source":"If the moniker is malformed or if the service is unavailable, the call to `GetObject` will return an error saying \"Invalid Syntax.\""},{"content":"If you receive this error, make sure the moniker you are using is correct and the service is available.","pos":[132,235]}]}]},{"pos":[4245,4278],"content":"To specify user name and password","linkify":"To specify user name and password","nodes":[{"content":"To specify user name and password","pos":[0,33]}]},{"content":"Modify the Service App.config file to use the <ph id=\"ph1\">`wsHttpBinding`</ph>.","pos":[4288,4350],"source":"Modify the Service App.config file to use the `wsHttpBinding`."},{"content":"This is required for user name and password validation:","pos":[4351,4406]},{"pos":[4414,4457],"content":"Set the <ph id=\"ph1\">`clientCredentialType`</ph> to UserName:","source":"Set the `clientCredentialType` to UserName:"},{"content":"Open Visual Basic 6.0 and create a new Standard .exe file.","pos":[4465,4523]},{"content":"Add a button to the form and double-click the button to add the following code to the Click handler:","pos":[4524,4624]},{"content":"Run the Visual Basic application and verify the results.","pos":[5372,5428]},{"content":"The Visual Basic application will display a message box with the result from calling Add(3, 4).","pos":[5429,5524]},{"pos":[5536,5854],"content":"[!NOTE]\nThe binding specified in the service moniker in this sample has been changed to WSHttpBinding_ICalculator. Also note that you must supply a valid user name and password in the call to <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetUserNameCredential%28System.String%2CSystem.String%29>.","leadings":["","    >  "],"nodes":[{"content":"The binding specified in the service moniker in this sample has been changed to WSHttpBinding_ICalculator. Also note that you must supply a valid user name and password in the call to <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetUserNameCredential%28System.String%2CSystem.String%29>.","pos":[8,311],"nodes":[{"content":"The binding specified in the service moniker in this sample has been changed to WSHttpBinding_ICalculator.","pos":[0,106]},{"content":"Also note that you must supply a valid user name and password in the call to <ph id=\"ph1\">&lt;xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetUserNameCredential%28System.String%2CSystem.String%29&gt;</ph>.","pos":[107,303],"source":" Also note that you must supply a valid user name and password in the call to <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetUserNameCredential%28System.String%2CSystem.String%29>."}]}]},{"pos":[5864,5894],"content":"To specify Windows Credentials","linkify":"To specify Windows Credentials","nodes":[{"content":"To specify Windows Credentials","pos":[0,30]}]},{"pos":[5904,5973],"content":"Set <ph id=\"ph1\">`clientCredentialType`</ph> to Windows in the Service App.config file:","source":"Set `clientCredentialType` to Windows in the Service App.config file:"},{"content":"Open Visual Basic 6.0 and create a new Standard .exe file.","pos":[5981,6039]},{"content":"Add a button to the form and double-click the button to add the following code to the Click handler:","pos":[6040,6140]},{"content":"Run the Visual Basic application and verify the results.","pos":[6843,6899]},{"content":"The Visual Basic application will display a message box with the result from calling Add(3, 4).","pos":[6900,6995]},{"pos":[7007,7092],"content":"[!NOTE]\nYou must replace \"domain\", \"userID\", and \"password\" with valid values.","leadings":["","    >  "],"nodes":[{"content":"You must replace \"domain\", \"userID\", and \"password\" with valid values.","pos":[8,78]}]},{"pos":[7102,7127],"content":"To specify an issue token","linkify":"To specify an issue token","nodes":[{"content":"To specify an issue token","pos":[0,25]}]},{"content":"Issue tokens are used only for applications using federated security.","pos":[7137,7206]},{"content":"For more information about federated security, see <bpt id=\"p1\">[</bpt>Federation and Issued Tokens<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md)</ept> and <bpt id=\"p2\">[</bpt>Federation Sample<ept id=\"p2\">](../../../../docs/framework/wcf/samples/federation-sample.md)</ept>.","pos":[7207,7454],"source":" For more information about federated security, see [Federation and Issued Tokens](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md) and [Federation Sample](../../../../docs/framework/wcf/samples/federation-sample.md)."},{"pos":[7465,7668],"content":"The following Visual Basic code example illustrates how to call the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetIssuedToken%28System.String%2CSystem.String%2CSystem.String%29&gt;</ph> method:","source":"The following Visual Basic code example illustrates how to call the <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetIssuedToken%28System.String%2CSystem.String%2CSystem.String%29> method:"},{"pos":[8251,8442],"content":"For more information about the parameters for this method, see <ph id=\"ph1\">&lt;xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetIssuedToken%28System.String%2CSystem.String%2CSystem.String%29&gt;</ph>.","source":"For more information about the parameters for this method, see <xref:System.ServiceModel.ComIntegration.IChannelCredentials.SetIssuedToken%28System.String%2CSystem.String%2CSystem.String%29>."},{"pos":[8451,8459],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8463,8537],"content":"<bpt id=\"p1\">[</bpt>Federation<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/federation.md)</ept>","source":"[Federation](../../../../docs/framework/wcf/feature-details/federation.md)"},{"pos":[8540,8699],"content":"<bpt id=\"p1\">[</bpt>How to: Configure Credentials on a Federation Service<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)</ept>","source":"[How to: Configure Credentials on a Federation Service](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)"},{"pos":[8702,8821],"content":"<bpt id=\"p1\">[</bpt>How to: Create a Federated Client<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)</ept>","source":"[How to: Create a Federated Client](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)"},{"pos":[8824,8917],"content":"<bpt id=\"p1\">[</bpt>Message Security<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/message-security-in-wcf.md)</ept>","source":"[Message Security](../../../../docs/framework/wcf/feature-details/message-security-in-wcf.md)"},{"pos":[8920,9016],"content":"<bpt id=\"p1\">[</bpt>Bindings and Security<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/bindings-and-security.md)</ept>","source":"[Bindings and Security](../../../../docs/framework/wcf/feature-details/bindings-and-security.md)"}]}