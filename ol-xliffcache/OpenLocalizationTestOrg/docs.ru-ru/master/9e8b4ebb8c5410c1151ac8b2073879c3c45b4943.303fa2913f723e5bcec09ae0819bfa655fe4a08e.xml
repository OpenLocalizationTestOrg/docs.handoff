{"content":"---\ntitle: \"Custom Compensation Sample | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 385920da-9284-44bf-9fe9-0d87c7478ec5\ncaps.latest.revision: 13\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Custom Compensation Sample\nThis sample shows how to use <xref:System.Activities.Statements.CompensableActivity> and its compensation handler to define custom compensation logic. The scenario modeled in this sample is a Truck Rental Agency.  \n  \n## Sample Details  \n The steps simulated are:  \n  \n1.  The user requests truck rental quotes for a given date.  \n  \n2.  Three truck companies are contacted and the three quotes are provided.  \n  \n3.  The user selects one truck quote and proceeds to order by credit card.  \n  \n4.  The application cancels the other two truck quotes.  \n  \n5.  The application charges a service fee that is non-refundable for non-premium accounts if cancelation happens 10 days or less prior to the reservation date.  \n  \n6.  The application charges the truck rental fee.  \n  \n7.  The application waits until the reservation date or until the customer decided to cancel the reservation, whichever comes first.  \n  \n8.  If the customer cancels the reservation, the <xref:System.Activities.Statements.CompensableActivity.CompensationHandler%2A> custom compensation logic runs according to the following logic:  \n  \n    1.  If the customer has a non-premium account and it is less than 10 days prior to the reservation date, then the service fee is still charged; otherwise, the application refunds the service fee.  \n  \n    2.  The rest of the compensable activities (truck order + truck order fee) are run according to the default compensation logic, which is to compensate in reverse order of execution.  \n  \n#### To set up, build, and run the sample  \n  \n1.  Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the CustomCompensation.sln solution. It is located in the \\WF\\Basic\\Compensation\\CustomCompensation directory.  \n  \n2.  Press CTRL+SHIFT+B to build the solution.  \n  \n3.  Press CTRL + F5 to run the application.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\Compensation\\CustomCompensation`  \n  \n## See Also","nodes":[{"pos":[12,55],"content":"Custom Compensation Sample | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Custom Compensation Sample | Microsoft Docs","pos":[0,43]}]},{"pos":[321,347],"content":"Custom Compensation Sample","linkify":"Custom Compensation Sample","nodes":[{"content":"Custom Compensation Sample","pos":[0,26]}]},{"content":"This sample shows how to use <ph id=\"ph1\">&lt;xref:System.Activities.Statements.CompensableActivity&gt;</ph> and its compensation handler to define custom compensation logic.","pos":[348,498],"source":"This sample shows how to use <xref:System.Activities.Statements.CompensableActivity> and its compensation handler to define custom compensation logic."},{"content":"The scenario modeled in this sample is a Truck Rental Agency.","pos":[499,560]},{"pos":[569,583],"content":"Sample Details","linkify":"Sample Details","nodes":[{"content":"Sample Details","pos":[0,14]}]},{"content":"The steps simulated are:","pos":[587,611]},{"content":"The user requests truck rental quotes for a given date.","pos":[621,676]},{"content":"Three truck companies are contacted and the three quotes are provided.","pos":[686,756]},{"content":"The user selects one truck quote and proceeds to order by credit card.","pos":[766,836]},{"content":"The application cancels the other two truck quotes.","pos":[846,897]},{"content":"The application charges a service fee that is non-refundable for non-premium accounts if cancelation happens 10 days or less prior to the reservation date.","pos":[907,1062]},{"content":"The application charges the truck rental fee.","pos":[1072,1117]},{"content":"The application waits until the reservation date or until the customer decided to cancel the reservation, whichever comes first.","pos":[1127,1255]},{"content":"If the customer cancels the reservation, the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.CompensableActivity.CompensationHandler%2A&gt;</ph> custom compensation logic runs according to the following logic:","pos":[1265,1453],"source":"If the customer cancels the reservation, the <xref:System.Activities.Statements.CompensableActivity.CompensationHandler%2A> custom compensation logic runs according to the following logic:"},{"content":"If the customer has a non-premium account and it is less than 10 days prior to the reservation date, then the service fee is still charged; otherwise, the application refunds the service fee.","pos":[1467,1658]},{"content":"The rest of the compensable activities (truck order + truck order fee) are run according to the default compensation logic, which is to compensate in reverse order of execution.","pos":[1672,1849]},{"pos":[1860,1896],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"content":"Using <ph id=\"ph1\">[!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]</ph>, open the CustomCompensation.sln solution.","pos":[1906,2008],"source":"Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the CustomCompensation.sln solution."},{"content":"It is located in the \\WF\\Basic\\Compensation\\CustomCompensation directory.","pos":[2009,2082]},{"content":"Press CTRL+SHIFT+B to build the solution.","pos":[2092,2133]},{"content":"Press CTRL + F5 to run the application.","pos":[2143,2182]},{"pos":[2190,2322],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[2376,2702],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[2703,2753]},{"pos":[2846,2854],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]}]}