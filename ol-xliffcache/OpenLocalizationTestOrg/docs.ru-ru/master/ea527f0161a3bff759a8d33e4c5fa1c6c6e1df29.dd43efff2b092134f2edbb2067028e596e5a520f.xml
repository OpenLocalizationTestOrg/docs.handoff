{"content":"---\ntitle: \"How to: Write to an Application Event Log (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"Computer.EventLog element\"\n  - \"WriteEntry method\"\n  - \"My.Computer.EventLog element\"\n  - \"event logs, writing to\"\nms.assetid: cadbc8c1-87af-4746-934e-55b79a4f6e2b\ncaps.latest.revision: 21\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# How to: Write to an Application Event Log (Visual Basic)\nYou can use the `My.Application.Log` and `My.Log` objects to write information about events that occur in your application. This example shows how to configure an event log listener so `My.Application.Log` writes tracing information to the Application event log.  \n  \n You cannot write to the Security log. In order to write to the System log, you must be a member of the LocalSystem or Administrator account.  \n  \n To view an event log, you can use **Server Explorer** or **Windows Event Viewer**. For more information, see [ETW Events in the .NET Framework](http://msdn.microsoft.com/library/d186276f-6afb-4dfd-bf3c-4251edc2c299).  \n  \n> [!NOTE]\n>  Event logs are not supported on Windows 95, Windows 98, or Windows Millennium Edition.  \n  \n### To add and configure the event log listener  \n  \n1.  Right-click app.config in **Solution Explorer** and choose **Open**.  \n  \n     \\- or -  \n  \n     If there is no app.config file,  \n  \n    1.  On the **Project** menu, choose **Add New Item**.  \n  \n    2.  From the **Add New Item** dialog box, choose **Application Configuration File**.  \n  \n    3.  Click **Add**.  \n  \n2.  Locate the `<listeners>` section in the application configuration file.  \n  \n     You will find the `<listeners>` section in the `<source>` section with the name attribute \"DefaultSource\", which is nested under the `<system.diagnostics>` section, which is nested under the top-level `<configuration>` section.  \n  \n3.  Add this element to that `<listeners>` section:  \n  \n    ```  \n    <add name=\"EventLog\"/>  \n    ```  \n  \n4.  Locate the `<sharedListeners>` section, in the `<system.diagnostics>` section, in the top-level `<configuration>` section.  \n  \n5.  Add this element to that `<sharedListeners>` section:  \n  \n    ```  \n    <add name=\"EventLog\"  \n        type=\"System.Diagnostics.EventLogTraceListener, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"  \n         initializeData=\"APPLICATION_NAME\"/>  \n    ```  \n  \n     Replace `APPLICATION_NAME` with the name of your application.  \n  \n    > [!NOTE]\n    >  Typically, an application writes only errors to the event log. For information on filtering log output, see [Walkthrough: Filtering My.Application.Log Output](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md).  \n  \n### To write event information to the event log  \n  \n-   Use the `My.Application.Log.WriteEntry` or `My.Application.Log.WriteException` method to write information to the event log. For more information, see [How to: Write Log Messages](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md) and [How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md).  \n  \n     After you configure the event log listener for an assembly, it receives all messages that `My.Applcation.Log` writes from that assembly.  \n  \n## See Also  \n <xref:Microsoft.VisualBasic.Logging.Log?displayProperty=fullName>   \n <xref:Microsoft.VisualBasic.Logging.Log.WriteEntry%2A>   \n <xref:Microsoft.VisualBasic.Logging.Log.WriteException%2A>   \n [Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)   \n [How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)   \n [Walkthrough: Determining Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)","nodes":[{"pos":[12,85],"content":"How to: Write to an Application Event Log (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Write to an Application Event Log (Visual Basic) | Microsoft Docs","pos":[0,73]}]},{"pos":[726,782],"content":"How to: Write to an Application Event Log (Visual Basic)","linkify":"How to: Write to an Application Event Log (Visual Basic)","nodes":[{"content":"How to: Write to an Application Event Log (Visual Basic)","pos":[0,56]}]},{"content":"You can use the <ph id=\"ph1\">`My.Application.Log`</ph> and <ph id=\"ph2\">`My.Log`</ph> objects to write information about events that occur in your application.","pos":[783,906],"source":"You can use the `My.Application.Log` and `My.Log` objects to write information about events that occur in your application."},{"content":"This example shows how to configure an event log listener so <ph id=\"ph1\">`My.Application.Log`</ph> writes tracing information to the Application event log.","pos":[907,1045],"source":" This example shows how to configure an event log listener so `My.Application.Log` writes tracing information to the Application event log."},{"content":"You cannot write to the Security log.","pos":[1052,1089]},{"content":"In order to write to the System log, you must be a member of the LocalSystem or Administrator account.","pos":[1090,1192]},{"content":"To view an event log, you can use <bpt id=\"p1\">**</bpt>Server Explorer<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Windows Event Viewer<ept id=\"p2\">**</ept>.","pos":[1199,1281],"source":"To view an event log, you can use **Server Explorer** or **Windows Event Viewer**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>ETW Events in the .NET Framework<ept id=\"p1\">](http://msdn.microsoft.com/library/d186276f-6afb-4dfd-bf3c-4251edc2c299)</ept>.","pos":[1282,1415],"source":" For more information, see [ETW Events in the .NET Framework](http://msdn.microsoft.com/library/d186276f-6afb-4dfd-bf3c-4251edc2c299)."},{"pos":[1423,1520],"content":"[!NOTE]\n Event logs are not supported on Windows 95, Windows 98, or Windows Millennium Edition.","leadings":["","> "],"nodes":[{"content":"Event logs are not supported on Windows 95, Windows 98, or Windows Millennium Edition.","pos":[9,95]}]},{"pos":[1530,1573],"content":"To add and configure the event log listener","linkify":"To add and configure the event log listener","nodes":[{"content":"To add and configure the event log listener","pos":[0,43]}]},{"pos":[1583,1651],"content":"Right-click app.config in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and choose <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","source":"Right-click app.config in **Solution Explorer** and choose **Open**."},{"content":"<ph id=\"ph1\">\\-</ph> or -","pos":[1662,1669],"source":"\\- or -"},{"content":"If there is no app.config file,","pos":[1680,1711]},{"pos":[1725,1774],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Add New Item<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, choose **Add New Item**."},{"pos":[1788,1868],"content":"From the <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> dialog box, choose <bpt id=\"p2\">**</bpt>Application Configuration File<ept id=\"p2\">**</ept>.","source":"From the **Add New Item** dialog box, choose **Application Configuration File**."},{"pos":[1882,1896],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","source":"Click **Add**."},{"pos":[1906,1977],"content":"Locate the <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section in the application configuration file.","source":"Locate the `<listeners>` section in the application configuration file."},{"pos":[1988,2215],"content":"You will find the <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section in the <ph id=\"ph2\">`&lt;source&gt;`</ph> section with the name attribute \"DefaultSource\", which is nested under the <ph id=\"ph3\">`&lt;system.diagnostics&gt;`</ph> section, which is nested under the top-level <ph id=\"ph4\">`&lt;configuration&gt;`</ph> section.","source":"You will find the `<listeners>` section in the `<source>` section with the name attribute \"DefaultSource\", which is nested under the `<system.diagnostics>` section, which is nested under the top-level `<configuration>` section."},{"pos":[2225,2272],"content":"Add this element to that <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section:","source":"Add this element to that `<listeners>` section:"},{"pos":[2334,2456],"content":"Locate the <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> section, in the <ph id=\"ph2\">`&lt;system.diagnostics&gt;`</ph> section, in the top-level <ph id=\"ph3\">`&lt;configuration&gt;`</ph> section.","source":"Locate the `<sharedListeners>` section, in the `<system.diagnostics>` section, in the top-level `<configuration>` section."},{"pos":[2466,2519],"content":"Add this element to that <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> section:","source":"Add this element to that `<sharedListeners>` section:"},{"pos":[2760,2821],"content":"Replace <ph id=\"ph1\">`APPLICATION_NAME`</ph> with the name of your application.","source":"Replace `APPLICATION_NAME` with the name of your application."},{"pos":[2833,3121],"content":"[!NOTE]\nTypically, an application writes only errors to the event log. For information on filtering log output, see [Walkthrough: Filtering My.Application.Log Output](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md).","leadings":["","    >  "],"nodes":[{"content":"Typically, an application writes only errors to the event log. For information on filtering log output, see [Walkthrough: Filtering My.Application.Log Output](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md).","pos":[8,281],"nodes":[{"content":"Typically, an application writes only errors to the event log.","pos":[0,62]},{"content":"For information on filtering log output, see <bpt id=\"p1\">[</bpt>Walkthrough: Filtering My.Application.Log Output<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md)</ept>.","pos":[63,273],"source":" For information on filtering log output, see [Walkthrough: Filtering My.Application.Log Output](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md)."}]}]},{"pos":[3131,3174],"content":"To write event information to the event log","linkify":"To write event information to the event log","nodes":[{"content":"To write event information to the event log","pos":[0,43]}]},{"content":"Use the <ph id=\"ph1\">`My.Application.Log.WriteEntry`</ph> or <ph id=\"ph2\">`My.Application.Log.WriteException`</ph> method to write information to the event log.","pos":[3184,3308],"source":"Use the `My.Application.Log.WriteEntry` or `My.Application.Log.WriteException` method to write information to the event log."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Write Log Messages<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Log Exceptions<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)</ept>.","pos":[3309,3573],"source":" For more information, see [How to: Write Log Messages](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md) and [How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)."},{"pos":[3584,3720],"content":"After you configure the event log listener for an assembly, it receives all messages that <ph id=\"ph1\">`My.Applcation.Log`</ph> writes from that assembly.","source":"After you configure the event log listener for an assembly, it receives all messages that `My.Applcation.Log` writes from that assembly."},{"pos":[3729,3737],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>Working with Application Logs<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)</ept><ph id=\"ph1\"> </ph>","pos":[3932,4061],"source":" [Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Log Exceptions<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)</ept><ph id=\"ph1\"> </ph>","pos":[4064,4178],"source":" [How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Walkthrough: Determining Where My.Application.Log Writes Information<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)</ept>","pos":[4181,4386],"source":" [Walkthrough: Determining Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)"}]}