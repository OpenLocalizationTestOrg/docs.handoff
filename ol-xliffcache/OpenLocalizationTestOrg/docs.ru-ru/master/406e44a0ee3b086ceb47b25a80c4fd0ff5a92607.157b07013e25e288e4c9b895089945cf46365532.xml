{"content":"---\ntitle: \"How to: Use Stored Procedures Mapped for Multiple Result Shapes\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: c2b84dfe-7fec-489a-92de-45215cec4518\n---\n# How to: Use Stored Procedures Mapped for Multiple Result Shapes\nWhen a stored procedure can return multiple result shapes, the return type cannot be strongly typed to a single projection shape. Although [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] can generate all possible projection types, it cannot know the order in which they will be returned.  \n  \n Contrast this scenario with stored procedures that produce multiple result shapes sequentially. For more information, see [How to: Use Stored Procedures Mapped for Sequential Result Shapes](../../../../../../docs/framework/data/adonet/sql/linq/how-to-use-stored-procedures-mapped-for-sequential-result-shapes.md).  \n  \n The <xref:System.Data.Linq.Mapping.ResultTypeAttribute> attribute is applied to stored procedures that return multiple result types to specify the set of types the procedure can return.  \n  \n## Example  \n In the following SQL code example, the result shape depends on the input (`shape =1` or `shape = 2`). You do not know which projection will be returned first.  \n  \n```  \nCREATE PROCEDURE VariableResultShapes(@shape int)  \nAS  \nif(@shape = 1)  \n    select CustomerID, ContactTitle, CompanyName from customers  \nelse if(@shape = 2)  \n    select OrderID, ShipName from orders  \n```  \n  \n [!code-csharp[DLinqSprox#4](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqSprox/cs/northwind-sprox.cs#4)]\n [!code-vb[DLinqSprox#4](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqSprox/vb/northwind-sprox.vb#4)]  \n  \n## Example  \n You would use code similar to the following to execute this stored procedure.  \n  \n> [!NOTE]\n>  You must use the <xref:System.Data.Linq.IMultipleResults.GetResult%2A> pattern to obtain an enumerator of the correct type, based on your knowledge of the stored procedure.  \n  \n [!code-csharp[DLinqSprox#5](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqSprox/cs/Program.cs#5)]\n [!code-vb[DLinqSprox#5](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqSprox/vb/Module1.vb#5)]  \n  \n## See also\n\n- [Stored Procedures](../../../../../../docs/framework/data/adonet/sql/linq/stored-procedures.md)\n","nodes":[{"pos":[4,181],"embed":true,"restype":"x-metadata","content":"title: \"How to: Use Stored Procedures Mapped for Multiple Result Shapes\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: c2b84dfe-7fec-489a-92de-45215cec4518","nodes":[{"content":"How to: Use Stored Procedures Mapped for Multiple Result Shapes","nodes":[{"pos":[0,63],"content":"How to: Use Stored Procedures Mapped for Multiple Result Shapes","nodes":[{"content":"How to: Use Stored Procedures Mapped for Multiple Result Shapes","pos":[0,63]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[188,251],"content":"How to: Use Stored Procedures Mapped for Multiple Result Shapes","linkify":"How to: Use Stored Procedures Mapped for Multiple Result Shapes","nodes":[{"content":"How to: Use Stored Procedures Mapped for Multiple Result Shapes","pos":[0,63]}]},{"content":"When a stored procedure can return multiple result shapes, the return type cannot be strongly typed to a single projection shape.","pos":[252,381]},{"content":"Although <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> can generate all possible projection types, it cannot know the order in which they will be returned.","pos":[382,559],"source":" Although [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] can generate all possible projection types, it cannot know the order in which they will be returned."},{"content":"Contrast this scenario with stored procedures that produce multiple result shapes sequentially.","pos":[566,661]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Use Stored Procedures Mapped for Sequential Result Shapes<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-use-stored-procedures-mapped-for-sequential-result-shapes.md)</ept>.","pos":[662,879],"source":" For more information, see [How to: Use Stored Procedures Mapped for Sequential Result Shapes](../../../../../../docs/framework/data/adonet/sql/linq/how-to-use-stored-procedures-mapped-for-sequential-result-shapes.md)."},{"pos":[886,1071],"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Linq.Mapping.ResultTypeAttribute&gt;</ph> attribute is applied to stored procedures that return multiple result types to specify the set of types the procedure can return.","source":"The <xref:System.Data.Linq.Mapping.ResultTypeAttribute> attribute is applied to stored procedures that return multiple result types to specify the set of types the procedure can return."},{"pos":[1080,1087],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In the following SQL code example, the result shape depends on the input (<ph id=\"ph1\">`shape =1`</ph> or <ph id=\"ph2\">`shape = 2`</ph>).","pos":[1091,1192],"source":"In the following SQL code example, the result shape depends on the input (`shape =1` or `shape = 2`)."},{"content":"You do not know which projection will be returned first.","pos":[1193,1249]},{"pos":[1734,1741],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"You would use code similar to the following to execute this stored procedure.","pos":[1745,1822]},{"pos":[1830,2013],"content":"[!NOTE]\n You must use the <xref:System.Data.Linq.IMultipleResults.GetResult%2A> pattern to obtain an enumerator of the correct type, based on your knowledge of the stored procedure.","leadings":["","> "],"nodes":[{"content":"You must use the <ph id=\"ph1\">&lt;xref:System.Data.Linq.IMultipleResults.GetResult%2A&gt;</ph> pattern to obtain an enumerator of the correct type, based on your knowledge of the stored procedure.","pos":[9,181],"source":"You must use the <xref:System.Data.Linq.IMultipleResults.GetResult%2A> pattern to obtain an enumerator of the correct type, based on your knowledge of the stored procedure."}]},{"pos":[2262,2270],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2274,2369],"content":"<bpt id=\"p1\">[</bpt>Stored Procedures<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/stored-procedures.md)</ept>","source":"[Stored Procedures](../../../../../../docs/framework/data/adonet/sql/linq/stored-procedures.md)"}]}