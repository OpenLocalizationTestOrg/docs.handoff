{"content":"---\ntitle: \"Channel Factory\"\nms.date: \"03/30/2017\"\nms.assetid: 09b53aa1-b13c-476c-a461-e82fcacd2a8b\n---\n# Channel Factory\nThis sample demonstrates how a client application can create a channel with the <xref:System.ServiceModel.ChannelFactory> class instead of a generated client. This sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md) that implements a calculator service.  \n  \n> [!NOTE]\n>  The setup procedure and build instructions for this sample are located at the end of this topic.  \n  \n This sample uses the <xref:System.ServiceModel.ChannelFactory%601> class to create a channel to a service endpoint. Typically, to create a channel to a service endpoint you generate a client type with the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) and create an instance of the generated type. You can also create a channel by using the <xref:System.ServiceModel.ChannelFactory%601> class, as demonstrated in this sample. The service created by the following sample code is identical to the service in the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md).  \n  \n```csharp  \nEndpointAddress address = new EndpointAddress(\"http://localhost/servicemodelsamples/service.svc\");  \nWSHttpBinding binding = new WSHttpBinding();  \nChannelFactory<ICalculator> factory = new   \n                    ChannelFactory<ICalculator>(binding, address);  \nICalculator channel = factory.CreateChannel();  \n```  \n  \n> [!IMPORTANT]\n>  If you are running this sample in a cross-machine scenario, you must replace \"localhost\" in the preceding code with the fully-qualified name of the machine that is running the service. This sample does not use configuration to set the endpoint address, so this must be done in code.  \n  \n Once the channel is created, service operations can be invoked just as with a generated client.  \n  \n```csharp  \n// Call the Add service operation.  \ndouble value1 = 100.00D;  \ndouble value2 = 15.99D;  \ndouble result = channel.Add(value1, value2);  \nConsole.WriteLine(\"Add({0},{1}) = {2}\", value1, value2, result);  \n```  \n  \n To close the channel, it must first be cast to an <xref:System.ServiceModel.IClientChannel> interface. This is because the channel as generated is declared in the client application using the `ICalculator` interface, which has methods like `Add` and `Subtract` but not `Close`. The `Close` method originates on the <xref:System.ServiceModel.ICommunicationObject> interface.  \n  \n```csharp  \n// Close the channel.  \n ((IClientChannel)client).Close();  \n```  \n  \n When you run the sample, the operation requests and responses are displayed in the client console window. Press ENTER in the client window to shut down the client application.  \n  \n```  \nAdd(100,15.99) = 115.99  \nSubtract(145,76.54) = 68.46  \nMultiply(9,81.25) = 731.25  \nDivide(22,7) = 3.14285714285714  \n  \nPress <ENTER> to terminate client.  \n```  \n  \n### To set up, build, and run the sample  \n  \n1.  Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md).  \n  \n2.  To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md). Note that this sample does not enable metadata publishing. You must first enable metadata publishing for this sample to regenerate the client type.  \n  \n3.  To run the sample in a single- or cross-machine configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md).  \n  \n### To run the sample cross machine  \n  \n1.  Replace \"localhost\" in the following code with the fully-qualified name of the machine that is running the service.  \n  \n    ```csharp  \n    EndpointAddress address = new EndpointAddress(\"http://localhost/servicemodelsamples/service.svc\");  \n    ```  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\Client\\ChannelFactory`  \n","nodes":[{"pos":[4,99],"embed":true,"restype":"x-metadata","content":"title: \"Channel Factory\"\nms.date: \"03/30/2017\"\nms.assetid: 09b53aa1-b13c-476c-a461-e82fcacd2a8b","nodes":[{"content":"Channel Factory","nodes":[{"pos":[0,15],"content":"Channel Factory","nodes":[{"content":"Channel Factory","pos":[0,15]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[106,121],"content":"Channel Factory","linkify":"Channel Factory","nodes":[{"content":"Channel Factory","pos":[0,15]}]},{"content":"This sample demonstrates how a client application can create a channel with the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ChannelFactory&gt;</ph> class instead of a generated client.","pos":[122,280],"source":"This sample demonstrates how a client application can create a channel with the <xref:System.ServiceModel.ChannelFactory> class instead of a generated client."},{"content":"This sample is based on the <bpt id=\"p1\">[</bpt>Getting Started<ept id=\"p1\">](../../../../docs/framework/wcf/samples/getting-started-sample.md)</ept> that implements a calculator service.","pos":[281,430],"source":" This sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md) that implements a calculator service."},{"pos":[438,545],"content":"[!NOTE]\n The setup procedure and build instructions for this sample are located at the end of this topic.","leadings":["","> "],"nodes":[{"content":"The setup procedure and build instructions for this sample are located at the end of this topic.","pos":[9,105]}]},{"content":"This sample uses the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ChannelFactory%601&gt;</ph> class to create a channel to a service endpoint.","pos":[552,667],"source":"This sample uses the <xref:System.ServiceModel.ChannelFactory%601> class to create a channel to a service endpoint."},{"content":"Typically, to create a channel to a service endpoint you generate a client type with the <bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept> and create an instance of the generated type.","pos":[668,935],"source":" Typically, to create a channel to a service endpoint you generate a client type with the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) and create an instance of the generated type."},{"content":"You can also create a channel by using the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ChannelFactory%601&gt;</ph> class, as demonstrated in this sample.","pos":[936,1063],"source":" You can also create a channel by using the <xref:System.ServiceModel.ChannelFactory%601> class, as demonstrated in this sample."},{"content":"The service created by the following sample code is identical to the service in the <bpt id=\"p1\">[</bpt>Getting Started<ept id=\"p1\">](../../../../docs/framework/wcf/samples/getting-started-sample.md)</ept>.","pos":[1064,1232],"source":" The service created by the following sample code is identical to the service in the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md)."},{"pos":[1572,1870],"content":"[!IMPORTANT]\n If you are running this sample in a cross-machine scenario, you must replace \"localhost\" in the preceding code with the fully-qualified name of the machine that is running the service. This sample does not use configuration to set the endpoint address, so this must be done in code.","leadings":["","> "],"nodes":[{"content":"If you are running this sample in a cross-machine scenario, you must replace \"localhost\" in the preceding code with the fully-qualified name of the machine that is running the service. This sample does not use configuration to set the endpoint address, so this must be done in code.","pos":[14,296],"nodes":[{"content":"If you are running this sample in a cross-machine scenario, you must replace \"localhost\" in the preceding code with the fully-qualified name of the machine that is running the service.","pos":[0,184]},{"content":"This sample does not use configuration to set the endpoint address, so this must be done in code.","pos":[185,282]}]}]},{"content":"Once the channel is created, service operations can be invoked just as with a generated client.","pos":[1877,1972]},{"content":"To close the channel, it must first be cast to an <ph id=\"ph1\">&lt;xref:System.ServiceModel.IClientChannel&gt;</ph> interface.","pos":[2204,2306],"source":"To close the channel, it must first be cast to an <xref:System.ServiceModel.IClientChannel> interface."},{"content":"This is because the channel as generated is declared in the client application using the <ph id=\"ph1\">`ICalculator`</ph> interface, which has methods like <ph id=\"ph2\">`Add`</ph> and <ph id=\"ph3\">`Subtract`</ph> but not <ph id=\"ph4\">`Close`</ph>.","pos":[2307,2481],"source":" This is because the channel as generated is declared in the client application using the `ICalculator` interface, which has methods like `Add` and `Subtract` but not `Close`."},{"content":"The <ph id=\"ph1\">`Close`</ph> method originates on the <ph id=\"ph2\">&lt;xref:System.ServiceModel.ICommunicationObject&gt;</ph> interface.","pos":[2482,2577],"source":" The `Close` method originates on the <xref:System.ServiceModel.ICommunicationObject> interface."},{"content":"When you run the sample, the operation requests and responses are displayed in the client console window.","pos":[2666,2771]},{"content":"Press ENTER in the client window to shut down the client application.","pos":[2772,2841]},{"pos":[3025,3061],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"pos":[3071,3270],"content":"Ensure that you have performed the <bpt id=\"p1\">[</bpt>One-Time Setup Procedure for the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)</ept>.","source":"Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)."},{"content":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in <bpt id=\"p1\">[</bpt>Building the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/building-the-samples.md)</ept>.","pos":[3280,3489],"source":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md)."},{"content":"Note that this sample does not enable metadata publishing.","pos":[3490,3548]},{"content":"You must first enable metadata publishing for this sample to regenerate the client type.","pos":[3549,3637]},{"pos":[3647,3855],"content":"To run the sample in a single- or cross-machine configuration, follow the instructions in <bpt id=\"p1\">[</bpt>Running the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/running-the-samples.md)</ept>.","source":"To run the sample in a single- or cross-machine configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md)."},{"pos":[3865,3896],"content":"To run the sample cross machine","linkify":"To run the sample cross machine","nodes":[{"content":"To run the sample cross machine","pos":[0,31]}]},{"content":"Replace \"localhost\" in the following code with the fully-qualified name of the machine that is running the service.","pos":[3906,4021]},{"pos":[4163,4295],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[14,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[4349,4659],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[4660,4710]}]}