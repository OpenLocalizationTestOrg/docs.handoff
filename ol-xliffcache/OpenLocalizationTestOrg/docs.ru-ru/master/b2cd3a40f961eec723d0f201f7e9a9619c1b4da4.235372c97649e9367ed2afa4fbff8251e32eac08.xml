{"content":"---\ntitle: \"IActionOnCLREvent::OnEvent Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IActionOnCLREvent.OnEvent\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IActionOnCLREvent::OnEvent\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OnEvent method [.NET Framework hosting]\"\n  - \"IActionOnCLREvent::OnEvent method [.NET Framework hosting]\"\nms.assetid: 0970f10c-4304-4c12-91c0-83e51455afb4\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 12\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# IActionOnCLREvent::OnEvent Method\nPerforms callbacks on events that have been registered by using a call to the [ICLROnEventManager::RegisterActionOnEvent](../../../../docs/framework/unmanaged-api/hosting/iclroneventmanager-registeractiononevent-method.md) method.  \n  \n## Syntax  \n  \n```  \nHRESULT OnEvent (  \n    [in] EClrEvent event,  \n    [in] PVOID     data  \n);  \n```  \n  \n#### Parameters  \n `event`  \n [in] One of the [EClrEvent](../../../../docs/framework/unmanaged-api/hosting/eclrevent-enumeration.md) values, which indicates the type of event.  \n  \n `data`  \n [in] A pointer to an object that contains details about `event`.  \n  \n## Return Value  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|`OnEvent` returned successfully.|  \n|HOST_E_CLRNOTAVAILABLE|The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.|  \n|HOST_E_TIMEOUT|The call timed out.|  \n|HOST_E_NOT_OWNER|The caller does not own the lock.|  \n|HOST_E_ABANDONED|An event was cancelled while a blocked thread or fiber was waiting on it.|  \n|E_FAIL|An unknown catastrophic failure occurred. If a method returns E_FAIL, the CLR is no longer usable within the process. Subsequent calls to any hosting method return HOST_E_CLRNOTAVAILABLE.|  \n  \n## Remarks  \n The `data` parameter is a pointer to an object of unspecified type. If the `event` parameter is `Event_DomainUnload`, `data` is the numeric identifier for the <xref:System.AppDomain> that was unloaded. The host can take appropriate action using this identifier as a key.  \n  \n If `event` is `Event_MDAFired`, `data` is a pointer to an [MDAInfo](../../../../docs/framework/unmanaged-api/hosting/mdainfo-structure.md) instance that contains the message output from a Managed Debugging Assistant (MDA). MDAs are a feature of the CLR that help developers with debugging, by generating XML messages about events that are otherwise difficult to trap. Such messages can be especially useful in debugging transitions between managed and unmanaged code. For more information, see [Diagnosing Errors with Managed Debugging Assistants](../../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md).  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See Also  \n [Diagnosing Errors with Managed Debugging Assistants](../../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)   \n [EClrEvent Enumeration](../../../../docs/framework/unmanaged-api/hosting/eclrevent-enumeration.md)   \n [IActionOnCLREvent Interface](../../../../docs/framework/unmanaged-api/hosting/iactiononclrevent-interface.md)   \n [ICLRControl Interface](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-interface.md)   \n [ICLROnEventManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclroneventmanager-interface.md)   \n [MDAInfo Structure](../../../../docs/framework/unmanaged-api/hosting/mdainfo-structure.md)","nodes":[{"pos":[4,686],"embed":true,"restype":"x-metadata","content":"title: \"IActionOnCLREvent::OnEvent Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IActionOnCLREvent.OnEvent\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IActionOnCLREvent::OnEvent\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OnEvent method [.NET Framework hosting]\"\n  - \"IActionOnCLREvent::OnEvent method [.NET Framework hosting]\"\nms.assetid: 0970f10c-4304-4c12-91c0-83e51455afb4\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 12\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"IActionOnCLREvent::OnEvent Method | Microsoft Docs","nodes":[{"pos":[0,50],"content":"IActionOnCLREvent::OnEvent Method | Microsoft Docs","nodes":[{"content":"IActionOnCLREvent::OnEvent Method | Microsoft Docs","pos":[0,50]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[693,726],"content":"IActionOnCLREvent::OnEvent Method","linkify":"IActionOnCLREvent::OnEvent Method","nodes":[{"content":"IActionOnCLREvent::OnEvent Method","pos":[0,33]}]},{"pos":[727,957],"content":"Performs callbacks on events that have been registered by using a call to the <bpt id=\"p1\">[</bpt>ICLROnEventManager::RegisterActionOnEvent<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclroneventmanager-registeractiononevent-method.md)</ept> method.","source":"Performs callbacks on events that have been registered by using a call to the [ICLROnEventManager::RegisterActionOnEvent](../../../../docs/framework/unmanaged-api/hosting/iclroneventmanager-registeractiononevent-method.md) method."},{"pos":[966,972],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1077,1087],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] One of the <bpt id=\"p1\">[</bpt>EClrEvent<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/eclrevent-enumeration.md)</ept> values, which indicates the type of event.","pos":[1102,1247],"source":"[in] One of the [EClrEvent](../../../../docs/framework/unmanaged-api/hosting/eclrevent-enumeration.md) values, which indicates the type of event."},{"content":"[in] A pointer to an object that contains details about <ph id=\"ph1\">`event`</ph>.","pos":[1264,1328],"source":"[in] A pointer to an object that contains details about `event`."},{"pos":[1337,1349],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"HRESULT","pos":[1356,1363]},{"content":"Description","pos":[1364,1375]},{"content":"S_OK","pos":[1416,1420]},{"pos":[1421,1453],"content":"<ph id=\"ph1\">`OnEvent`</ph> returned successfully.","source":"`OnEvent` returned successfully."},{"content":"HOST_E_CLRNOTAVAILABLE","pos":[1458,1480]},{"content":"The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.","pos":[1481,1645]},{"content":"HOST_E_TIMEOUT","pos":[1650,1664]},{"content":"The call timed out.","pos":[1665,1684]},{"content":"HOST_E_NOT_OWNER","pos":[1689,1705]},{"content":"The caller does not own the lock.","pos":[1706,1739]},{"content":"HOST_E_ABANDONED","pos":[1744,1760]},{"content":"An event was cancelled while a blocked thread or fiber was waiting on it.","pos":[1761,1834]},{"content":"E_FAIL","pos":[1839,1845]},{"content":"An unknown catastrophic failure occurred.","pos":[1846,1887]},{"content":"If a method returns E_FAIL, the CLR is no longer usable within the process.","pos":[1888,1963]},{"content":"Subsequent calls to any hosting method return HOST_E_CLRNOTAVAILABLE.","pos":[1964,2033]},{"pos":[2043,2050],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`data`</ph> parameter is a pointer to an object of unspecified type.","pos":[2054,2121],"source":"The `data` parameter is a pointer to an object of unspecified type."},{"content":"If the <ph id=\"ph1\">`event`</ph> parameter is <ph id=\"ph2\">`Event_DomainUnload`</ph>, <ph id=\"ph3\">`data`</ph> is the numeric identifier for the <ph id=\"ph4\">&lt;xref:System.AppDomain&gt;</ph> that was unloaded.","pos":[2122,2255],"source":" If the `event` parameter is `Event_DomainUnload`, `data` is the numeric identifier for the <xref:System.AppDomain> that was unloaded."},{"content":"The host can take appropriate action using this identifier as a key.","pos":[2256,2324]},{"content":"If <ph id=\"ph1\">`event`</ph> is <ph id=\"ph2\">`Event_MDAFired`</ph>, <ph id=\"ph3\">`data`</ph> is a pointer to an <bpt id=\"p1\">[</bpt>MDAInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/mdainfo-structure.md)</ept> instance that contains the message output from a Managed Debugging Assistant (MDA).","pos":[2331,2553],"source":"If `event` is `Event_MDAFired`, `data` is a pointer to an [MDAInfo](../../../../docs/framework/unmanaged-api/hosting/mdainfo-structure.md) instance that contains the message output from a Managed Debugging Assistant (MDA)."},{"content":"MDAs are a feature of the CLR that help developers with debugging, by generating XML messages about events that are otherwise difficult to trap.","pos":[2554,2698]},{"content":"Such messages can be especially useful in debugging transitions between managed and unmanaged code.","pos":[2699,2798]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept>.","pos":[2799,2982],"source":" For more information, see [Diagnosing Errors with Managed Debugging Assistants](../../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)."},{"pos":[2991,3003],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3007,3111],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3118,3139],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[3146,3196],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[3203,3311],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[3320,3328],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept><ph id=\"ph1\"> </ph>","pos":[3332,3489],"source":"[Diagnosing Errors with Managed Debugging Assistants](../../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md) "},{"content":"<bpt id=\"p1\">[</bpt>EClrEvent Enumeration<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/eclrevent-enumeration.md)</ept><ph id=\"ph1\"> </ph>","pos":[3493,3592],"source":"[EClrEvent Enumeration](../../../../docs/framework/unmanaged-api/hosting/eclrevent-enumeration.md) "},{"content":"<bpt id=\"p1\">[</bpt>IActionOnCLREvent Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iactiononclrevent-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[3596,3707],"source":"[IActionOnCLREvent Interface](../../../../docs/framework/unmanaged-api/hosting/iactiononclrevent-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>ICLRControl Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[3711,3810],"source":"[ICLRControl Interface](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>ICLROnEventManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclroneventmanager-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[3814,3927],"source":"[ICLROnEventManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclroneventmanager-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>MDAInfo Structure<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/mdainfo-structure.md)</ept>","pos":[3931,4021],"source":"[MDAInfo Structure](../../../../docs/framework/unmanaged-api/hosting/mdainfo-structure.md)"}]}