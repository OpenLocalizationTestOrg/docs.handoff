{"content":"---\ntitle: \"Introduction to LINQ in Visual Basic\"\nms.date: 08/28/2018\nhelpviewer_keywords: \n  - \"queries [LINQ in Visual Basic], about LINQ in Visual Basic queries\"\n  - \"query execution [LINQ in Visual Basic]\"\n  - \"range variables [Visual Basic]\"\n  - \"LINQ [Visual Basic]\"\n  - \"LINQ [Visual Basic], about LINQ in Visual Basic\"\n  - \"query expressions [LINQ in Visual Basic]\"\n  - \"LINQ\"\n  - \"deferred execution\"\n  - \"iteration variables [Visual Basic]\"\nms.assetid: 3047d86e-0d49-40e2-928b-dc02e46c7984\n---\n# Introduction to LINQ in Visual Basic\nLanguage-Integrated Query (LINQ) adds query capabilities to Visual Basic and provides simple and powerful capabilities when you work with all kinds of data. Rather than sending a query to a database to be processed, or working with different query syntax for each type of data that you are searching, LINQ introduces queries as part of the Visual Basic language. It uses a unified syntax regardless of the type of data.  \n  \n LINQ enables you to query data from a SQL Server database, XML, in-memory arrays and collections, ADO.NET datasets, or any other remote or local data source that supports LINQ. You can do all this with common Visual Basic language elements. Because your queries are written in the Visual Basic language, your query results are returned as strongly-typed objects. These objects support IntelliSense, which enables you to write code faster and catch errors in your queries at compile time instead of at run time. LINQ queries can be used as the source of additional queries to refine results. They can also be bound to controls so that users can easily view and modify your query results.  \n  \n For example, the following code example shows a LINQ query that returns a list of customers from a collection and groups them based on their location.  \n  \n [!code-vb[VbVbalrIntroToLINQ#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#1)]  \n  \n## Running the examples  \n To run the examples in the introduction and in the [Structure of a LINQ Query](#structure-of-a-linq-query) section, include the following code, which returns lists of customers and orders.  \n  \n [!code-vb[VbVbalrIntroToLINQ#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#31)]  \n  \n## LINQ providers  \n A *LINQ provider* maps your Visual Basic LINQ queries to the data source being queried. When you write a LINQ query, the provider takes that query and translates it into commands that the data source will be able to execute. The provider also converts data from the source to the objects that make up your query result. Finally, it converts objects to data when you send updates to the data source.  \n  \n Visual Basic includes the following LINQ providers.  \n  \n|Provider|Description|  \n|---|---|  \n|LINQ to Objects|The LINQ to Objects provider enables you to query in-memory collections and arrays. If an object supports either the <xref:System.Collections.IEnumerable> or <xref:System.Collections.Generic.IEnumerable%601> interface, the LINQ to Objects provider enables you to query it.<br /><br /> You can enable the LINQ to Objects provider by importing the <xref:System.Linq> namespace, which is imported by default for all Visual Basic projects.<br /><br /> For more information about the LINQ to Objects provider, see [LINQ to Objects](../../concepts/linq/linq-to-objects.md).|  \n|LINQ to SQL|The LINQ to SQL provider enables you to query and modify data in a SQL Server database. This makes it easy to map the object model for an application to the tables and objects in a database.<br /><br /> Visual Basic makes it easier to work with LINQ to SQL by including the Object Relational Designer (O/R Designer). This designer is used to create an object model in an application that maps to objects in a database. The O/R Designer also provides functionality to map stored procedures and functions to the <xref:System.Data.Linq.DataContext> object, which manages communication with the database and stores state for optimistic concurrency checks.<br /><br /> For more information about the LINQ to SQL provider, see [LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md). For more information about the Object Relational Designer, see [LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2).|  \n|LINQ to XML|The LINQ to XML provider enables you to query and modify XML. You can modify in-memory XML, or you can load XML from and save XML to a file.<br /><br /> Additionally, the LINQ to XML provider enables XML literals and XML axis properties that enable you to write XML directly in your Visual Basic code. For more information, see [XML](../../../../visual-basic/programming-guide/language-features/xml/index.md).|  \n|LINQ to DataSet|The LINQ to DataSet provider enables you to query and update data in an [!INCLUDE[vstecado](~/includes/vstecado-md.md)] dataset. You can add the power of LINQ to applications that use datasets in order to simplify and extend your capabilities for querying, aggregating, and updating the data in your dataset.<br /><br /> For more information, see [LINQ to DataSet](../../../../framework/data/adonet/linq-to-dataset.md).|  \n  \n## Structure of a LINQ query  \n A LINQ query, often referred to as a *query expression*, consists of a combination of query clauses that identify the data sources and iteration variables for the query. A query expression can also include instructions for sorting, filtering, grouping, and joining, or calculations to apply to the source data. Query expression syntax resembles the syntax of SQL; therefore, you may find much of the syntax familiar.  \n  \n A query expression starts with a `From` clause. This clause identifies the source data for a query and the variables that are used to refer to each element of the source data individually. These variables are named *range variables* or *iteration variables*. The `From` clause is required for a query, except for `Aggregate` queries, where the `From` clause is optional. After the scope and source of the query are identified in the `From` or `Aggregate` clauses, you can include any combination of query clauses to refine the query. For details about query clauses, see Visual Basic LINQ Query Operators later in this topic. For example, the following query identifies a source collection of customer data as the `customers` variable, and an iteration variable named `cust`.  \n  \n [!code-vb[VbVbalrIntroToLINQ#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#2)]  \n  \n This example is a valid query by itself; however, the query becomes far more powerful when you add more query clauses to refine the result. For example, you can add a `Where` clause to filter the result by one or more values. Query expressions are a single line of code; you can just append additional query clauses to the end of the query. You can break up a query across multiple lines of text to improve readability by using the underscore (\\_) line-continuation character. The following code example shows an example of a query that includes a `Where` clause.  \n  \n [!code-vb[VbVbalrIntroToLINQ#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#3)]  \n  \n Another powerful query clause is the `Select` clause, which enables you to return only selected fields from the data source. LINQ queries return enumerable collections of strongly typed objects. A query can return a collection of anonymous types or named types. You can use the `Select` clause to return only a single field from the data source. When you do this, the type of the collection returned is the type of that single field. You can also use the `Select` clause to return multiple fields from the data source. When you do this, the type of the collection returned is a new anonymous type. You can also match the fields returned by the query to the fields of a specified named type. The following code example shows a query expression that returns a collection of anonymous types that have members populated with data from the selected fields from the data source.  \n  \n [!code-vb[VbVbalrIntroToLINQ#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#4)]  \n  \n LINQ queries can also be used to combine multiple sources of data and return a single result. This can be done with one or more `From` clauses, or by using the `Join` or `Group Join` query clauses. The following code example shows a query expression that combines customer and order data and returns a collection of anonymous types containing customer and order data.  \n  \n [!code-vb[VbVbalrIntroToLINQ#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#5)]  \n  \n You can use the `Group Join` clause to create a hierarchical query result that contains a collection of customer objects. Each customer object has a property that contains a collection of all orders for that customer. The following code example shows a query expression that combines customer and order data as a hierarchical result and returns a collection of anonymous types. The query returns a type that includes a `CustomerOrders` property that contains a collection of order data for the customer. It also includes an `OrderTotal` property that contains the sum of the totals for all the orders for that customer. (This query is equivalent to a LEFT OUTER JOIN.)  \n  \n [!code-vb[VbVbalrIntroToLINQ#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#6)]  \n  \n There are several additional LINQ query operators that you can use to create powerful query expressions. The next section of this topic discusses the various query clauses that you can include in a query expression. For details about Visual Basic query clauses, see [Queries](../../../../visual-basic/language-reference/queries/index.md).  \n  \n## Visual Basic LINQ query operators  \n\nThe classes in the <xref:System.Linq> namespace and the other namespaces that support LINQ queries include methods that you can call to create and refine queries based on the needs of your application. Visual Basic includes keywords for the following common query clauses. For details about Visual Basic query clauses, see [Queries](../../../language-reference/queries/index.md).\n\n### From clause\n\nEither a [`From` clause](../../../../visual-basic/language-reference/queries/from-clause.md) or an `Aggregate` clause is required to begin a query. A `From` clause specifies a source collection and an iteration variable for a query. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#7)]\n\n### Select clause\n\nOptional. A [`Select` clause](../../../../visual-basic/language-reference/queries/select-clause.md) declares a set of iteration variables for a query. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#8)]\n\nIf a `Select` clause is not specified, the iteration variables for the query consist of the iteration variables specified by the `From` or `Aggregate` clause.\n\n### Where clause\n\nOptional. A [`Where` clause](../../../../visual-basic/language-reference/queries/where-clause.md) specifies a filtering condition for a query. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#9)]\n\n### Order By clause]\n\n|Optional. An [`Order By` clause](../../../../visual-basic/language-reference/queries/order-by-clause.md) specifies the sort order for columns in a query. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#10)]\n\n### Join clause\n\nOptional. A [`Join` clause](../../../../visual-basic/language-reference/queries/join-clause.md) combines two collections into a single collection. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#11)]\n\n### Group By clause\n\nOptional. A [`Group By` clause](../../../../visual-basic/language-reference/queries/group-by-clause.md) groups the elements of a query result. It can be used to apply aggregate functions to each group. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#12)]\n\n### Group Join clause\n\nOptional. A [`Group Join` clause](../../../../visual-basic/language-reference/queries/group-join-clause.md) combines two collections into a single hierarchical collection. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#13)]\n\n### Aggregate clause\n\nEither an [`Aggregate` clause](../../../../visual-basic/language-reference/queries/aggregate-clause.md) or a `From` clause is required to begin a query. An `Aggregate` clause applies one or more aggregate functions to a collection. For example, you can use the `Aggregate` clause to calculate a sum for all the elements returned by a query, as the following example does.\n\n [!code-vb[VbVbalrIntroToLINQ#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#14)]\n\nYou can also use the `Aggregate` clause to modify a query. For example, you can use the `Aggregate` clause to perform a calculation on a related query collection. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#15)]\n\n### Let clause\n\nOptional. A [`Let` clause](../../../../visual-basic/language-reference/queries/let-clause.md) computes a value and assigns it to a new variable in the query. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#16)]\n\n### Distinct clause\n\nOptional. A `Distinct` clause restricts the values of the current iteration variable to eliminate duplicate values in query results. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#17](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#17)]\n\n### Skip clause\n\nOptional. A [`Skip` clause](../../../../visual-basic/language-reference/queries/skip-clause.md) bypasses a specified number of elements in a collection and then returns the remaining elements. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#18)]\n\n### Skip While clause\n\nOptional. A [`Skip While` clause](../../../../visual-basic/language-reference/queries/skip-while-clause.md) bypasses elements in a collection as long as a specified condition is `true` and then returns the remaining elements. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#19](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#19)]\n\n### Take clause\n\nOptional. A [`Take` clause](../../../../visual-basic/language-reference/queries/take-clause.md) returns a specified number of contiguous elements from the start of a collection. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#20)]\n\n### Take While clause\n\nOptional. A [`Take While` clause](../../../../visual-basic/language-reference/queries/take-while-clause.md) includes elements in a collection as long as a specified condition is `true` and bypasses the remaining elements. For example:\n\n [!code-vb[VbVbalrIntroToLINQ#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#21)]\n  \n## Use additional LINQ query features  \n  \nYou can use additional LINQ query features by calling members of the enumerable and queryable types provided by LINQ. You can use these additional capabilities by calling a particular query operator on the result of a query expression. For example, the following example uses the <xref:System.Linq.Enumerable.Union%2A?displayProperty=nameWithType> method to combine the results of two queries into one query result. It uses the <xref:System.Linq.Enumerable.ToList%2A?displayProperty=nameWithType> method to return the query result as a generic list.\n  \n [!code-vb[VbVbalrIntroToLINQ#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#22)]  \n  \n For details about additional LINQ capabilities, see [Standard Query Operators Overview](../../concepts/linq/standard-query-operators-overview.md).  \n  \n## Connect to a database by using LINQ to SQL  \n In Visual Basic, you identify the SQL Server database objects, such as tables, views, and stored procedures, that you want to access by using a LINQ to SQL file. A LINQ to SQL file has an extension of .dbml.  \n  \n When you have a valid connection to a SQL Server database, you can add a **LINQ to SQL Classes** item template to your project. This will display the Object Relational Designer (O/R designer). The O/R Designer enables you to drag the items that you want to access in your code from the **Server Explorer**/**Database Explorer** onto the designer surface. The LINQ to SQL file adds a <xref:System.Data.Linq.DataContext> object to your project. This object includes properties and collections for the tables and views that you want access to, and methods for the stored procedures that you want to call. After you have saved your changes to the LINQ to SQL (.dbml) file, you can access these objects in your code by referencing the <xref:System.Data.Linq.DataContext> object that is defined by the O/R Designer. The <xref:System.Data.Linq.DataContext> object for your project is named based on the name of your LINQ to SQL file. For example, a LINQ to SQL file that is named Northwind.dbml will create a <xref:System.Data.Linq.DataContext> object named `NorthwindDataContext`.  \n  \n For examples with step-by-step instructions, see [How to: Query a Database](how-to-query-a-database-by-using-linq.md) and [How to: Call a Stored Procedure](how-to-call-a-stored-procedure-by-using-linq.md).  \n  \n## Visual Basic features that support LINQ  \n Visual Basic includes other notable features that make the use of LINQ simple and reduce the amount of code that you must write to perform LINQ queries. These include the following:  \n  \n-   **Anonymous types**, which enable you to create a new type based on a query result.  \n  \n-   **Implicitly typed variables**, which enable you to defer specifying a type and let the compiler infer the type based on the query result.  \n  \n-   **Extension methods**, which enable you to extend an existing type with your own methods without modifying the type itself.  \n  \n For details, see [Visual Basic Features That Support LINQ](../../concepts/linq/features-that-support-linq.md).  \n  \n## Deferred and immediate query execution\n\n Query execution is separate from creating a query. After a query is created, its execution is triggered by a separate mechanism. A query can be executed as soon as it is defined (*immediate execution*), or the definition can be stored and the query can be executed later (*deferred execution*).  \n  \n By default, when you create a query, the query itself does not execute immediately. Instead, the query definition is stored in the variable that is used to reference the query result. When the query result variable is accessed later in code, such as in a `For…Next` loop, the query is executed. This process is referred to as *deferred execution*.  \n  \n Queries can also be executed when they are defined, which is referred to as *immediate execution*. You can trigger immediate execution by applying a method that requires access to individual elements of the query result. This can be the result of including an aggregate function, such as `Count`, `Sum`, `Average`, `Min`, or `Max`. For more information about aggregate functions, see [Aggregate Clause](../../../language-reference/queries/aggregate-clause.md).  \n  \n Using the `ToList` or `ToArray` methods will also force immediate execution. This can be useful when you want to execute the query immediately and cache the results. For more information about these methods, see [Converting Data Types](../../concepts/linq/converting-data-types.md).  \n  \n For more information about query execution, see [Writing Your First LINQ Query](../../concepts/linq/writing-your-first-linq-query.md).  \n  \n## XML in Visual Basic  \n The XML features in Visual Basic include XML literals and XML axis properties, which enable you easily to create, access, query, and modify XML in your code. XML literals enable you to write XML directly in your code. The Visual Basic compiler treats the XML as a first-class data object.  \n  \n The following code example shows how to create an XML element, access its sub-elements and attributes, and query the contents of the element by using LINQ.  \n  \n [!code-vb[VbXmlSamples#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbXMLSamples/VB/XMLSamples3.vb#8)]  \n  \n For more information, see [XML](../xml/index.md).  \n  \n## Related resources  \n  \n|Topic|Description|  \n|---|---|  \n|[XML](../../language-features/xml/index.md)|Describes the XML features in Visual Basic that can be queried and that enable you to include XML as first-class data objects in your Visual Basic code.|  \n|[Queries](../../../language-reference/queries/index.md)|Provides reference information about the query clauses that are available in Visual Basic.|  \n|[LINQ (Language-Integrated Query)](../../concepts/linq/index.md)|Includes general information, programming guidance, and samples for LINQ.|  \n|[LINQ to SQL](~/docs/framework/data/adonet/sql/linq/index.md)|Includes general information, programming guidance, and samples for LINQ to SQL.|  \n|[LINQ to Objects](../../concepts/linq/linq-to-objects.md)|Includes general information, programming guidance, and samples for LINQ to Objects.|  \n|[LINQ to ADO.NET (Portal Page)](../../concepts/linq/linq-to-adonet-portal-page.md)|Includes links to general information, programming guidance, and samples for LINQ to ADO.NET.|  \n|[LINQ to XML](../../concepts/linq/linq-to-xml.md)|Includes general information, programming guidance, and samples for LINQ to XML.|  \n  \n## How to and walkthrough topics\n [How to: Query a Database](how-to-query-a-database-by-using-linq.md)  \n  \n [How to: Call a Stored Procedure](how-to-call-a-stored-procedure-by-using-linq.md)  \n  \n [How to: Modify Data in a Database](how-to-modify-data-in-a-database-by-using-linq.md)  \n  \n [How to: Combine Data with Joins](how-to-combine-data-with-linq-by-using-joins.md)  \n  \n [How to: Sort Query Results](how-to-sort-query-results-by-using-linq.md)  \n  \n [How to: Filter Query Results](how-to-filter-query-results-by-using-linq.md)  \n  \n [How to: Count, Sum, or Average Data](how-to-count-sum-or-average-data-by-using-linq.md)  \n  \n [How to: Find the Minimum or Maximum Value in a Query Result](how-to-find-the-minimum-or-maximum-value-in-a-query-result.md)  \n  \n [How to: Assign stored procedures to perform updates, inserts, and deletes (O/R Designer)](/visualstudio/data-tools/how-to-assign-stored-procedures-to-perform-updates-inserts-and-deletes-o-r-designer)  \n  \n## Featured book chapters  \n [Chapter 17: LINQ](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652502(v=orm.10)) in [Programming Visual Basic 2008](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652504(v=orm.10))  \n  \n## See also\n\n- [LINQ (Language-Integrated Query)](../../concepts/linq/index.md)\n- [Overview of LINQ to XML in Visual Basic](../../language-features/xml/overview-of-linq-to-xml.md)\n- [LINQ to DataSet Overview](~/docs/framework/data/adonet/linq-to-dataset-overview.md)\n- [LINQ to SQL](~/docs/framework/data/adonet/sql/linq/index.md)\n- [LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)\n- [DataContext Methods (O/R Designer)](/visualstudio/data-tools/datacontext-methods-o-r-designer)\n","nodes":[{"pos":[4,499],"embed":true,"restype":"x-metadata","content":"title: \"Introduction to LINQ in Visual Basic\"\nms.date: 08/28/2018\nhelpviewer_keywords: \n  - \"queries [LINQ in Visual Basic], about LINQ in Visual Basic queries\"\n  - \"query execution [LINQ in Visual Basic]\"\n  - \"range variables [Visual Basic]\"\n  - \"LINQ [Visual Basic]\"\n  - \"LINQ [Visual Basic], about LINQ in Visual Basic\"\n  - \"query expressions [LINQ in Visual Basic]\"\n  - \"LINQ\"\n  - \"deferred execution\"\n  - \"iteration variables [Visual Basic]\"\nms.assetid: 3047d86e-0d49-40e2-928b-dc02e46c7984","nodes":[{"content":"Introduction to LINQ in Visual Basic","nodes":[{"pos":[0,36],"content":"Introduction to LINQ in Visual Basic","nodes":[{"content":"Introduction to LINQ in Visual Basic","pos":[0,36]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[506,542],"content":"Introduction to LINQ in Visual Basic","linkify":"Introduction to LINQ in Visual Basic","nodes":[{"content":"Introduction to LINQ in Visual Basic","pos":[0,36]}]},{"content":"Language-Integrated Query (LINQ) adds query capabilities to Visual Basic and provides simple and powerful capabilities when you work with all kinds of data.","pos":[543,699]},{"content":"Rather than sending a query to a database to be processed, or working with different query syntax for each type of data that you are searching, LINQ introduces queries as part of the Visual Basic language.","pos":[700,905]},{"content":"It uses a unified syntax regardless of the type of data.","pos":[906,962]},{"content":"LINQ enables you to query data from a SQL Server database, XML, in-memory arrays and collections, ADO.NET datasets, or any other remote or local data source that supports LINQ.","pos":[969,1145]},{"content":"You can do all this with common Visual Basic language elements.","pos":[1146,1209]},{"content":"Because your queries are written in the Visual Basic language, your query results are returned as strongly-typed objects.","pos":[1210,1331]},{"content":"These objects support IntelliSense, which enables you to write code faster and catch errors in your queries at compile time instead of at run time.","pos":[1332,1479]},{"content":"LINQ queries can be used as the source of additional queries to refine results.","pos":[1480,1559]},{"content":"They can also be bound to controls so that users can easily view and modify your query results.","pos":[1560,1655]},{"content":"For example, the following code example shows a LINQ query that returns a list of customers from a collection and groups them based on their location.","pos":[1662,1812]},{"pos":[1947,1967],"content":"Running the examples","linkify":"Running the examples","nodes":[{"content":"Running the examples","pos":[0,20]}]},{"pos":[1971,2159],"content":"To run the examples in the introduction and in the <bpt id=\"p1\">[</bpt>Structure of a LINQ Query<ept id=\"p1\">](#structure-of-a-linq-query)</ept> section, include the following code, which returns lists of customers and orders.","source":"To run the examples in the introduction and in the [Structure of a LINQ Query](#structure-of-a-linq-query) section, include the following code, which returns lists of customers and orders."},{"pos":[2296,2310],"content":"LINQ providers","linkify":"LINQ providers","nodes":[{"content":"LINQ providers","pos":[0,14]}]},{"content":"A <bpt id=\"p1\">*</bpt>LINQ provider<ept id=\"p1\">*</ept> maps your Visual Basic LINQ queries to the data source being queried.","pos":[2314,2401],"source":"A *LINQ provider* maps your Visual Basic LINQ queries to the data source being queried."},{"content":"When you write a LINQ query, the provider takes that query and translates it into commands that the data source will be able to execute.","pos":[2402,2538]},{"content":"The provider also converts data from the source to the objects that make up your query result.","pos":[2539,2633]},{"content":"Finally, it converts objects to data when you send updates to the data source.","pos":[2634,2712]},{"content":"Visual Basic includes the following LINQ providers.","pos":[2719,2770]},{"content":"Provider","pos":[2777,2785]},{"content":"Description","pos":[2786,2797]},{"content":"LINQ to Objects","pos":[2814,2829]},{"content":"The LINQ to Objects provider enables you to query in-memory collections and arrays.","pos":[2830,2913]},{"content":"If an object supports either the <ph id=\"ph1\">&lt;xref:System.Collections.IEnumerable&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> interface, the LINQ to Objects provider enables you to query it.","pos":[2914,3102],"source":" If an object supports either the <xref:System.Collections.IEnumerable> or <xref:System.Collections.Generic.IEnumerable%601> interface, the LINQ to Objects provider enables you to query it."},{"content":"You can enable the LINQ to Objects provider by importing the <ph id=\"ph1\">&lt;xref:System.Linq&gt;</ph> namespace, which is imported by default for all Visual Basic projects.","pos":[3115,3265],"source":"You can enable the LINQ to Objects provider by importing the <xref:System.Linq> namespace, which is imported by default for all Visual Basic projects."},{"content":"For more information about the LINQ to Objects provider, see <bpt id=\"p1\">[</bpt>LINQ to Objects<ept id=\"p1\">](../../concepts/linq/linq-to-objects.md)</ept>.","pos":[3278,3397],"source":"For more information about the LINQ to Objects provider, see [LINQ to Objects](../../concepts/linq/linq-to-objects.md)."},{"content":"LINQ to SQL","pos":[3402,3413]},{"content":"The LINQ to SQL provider enables you to query and modify data in a SQL Server database.","pos":[3414,3501]},{"content":"This makes it easy to map the object model for an application to the tables and objects in a database.","pos":[3502,3604]},{"content":"Visual Basic makes it easier to work with LINQ to SQL by including the Object Relational Designer (O/R Designer).","pos":[3617,3730]},{"content":"This designer is used to create an object model in an application that maps to objects in a database.","pos":[3731,3832]},{"content":"The O/R Designer also provides functionality to map stored procedures and functions to the <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object, which manages communication with the database and stores state for optimistic concurrency checks.","pos":[3833,4065],"source":" The O/R Designer also provides functionality to map stored procedures and functions to the <xref:System.Data.Linq.DataContext> object, which manages communication with the database and stores state for optimistic concurrency checks."},{"content":"For more information about the LINQ to SQL provider, see <bpt id=\"p1\">[</bpt>LINQ to SQL<ept id=\"p1\">](../../../../framework/data/adonet/sql/linq/index.md)</ept>.","pos":[4078,4202],"source":"For more information about the LINQ to SQL provider, see [LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md)."},{"content":"For more information about the Object Relational Designer, see <bpt id=\"p1\">[</bpt>LINQ to SQL Tools in Visual Studio<ept id=\"p1\">](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)</ept>.","pos":[4203,4365],"source":" For more information about the Object Relational Designer, see [LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)."},{"content":"LINQ to XML","pos":[4370,4381]},{"content":"The LINQ to XML provider enables you to query and modify XML.","pos":[4382,4443]},{"content":"You can modify in-memory XML, or you can load XML from and save XML to a file.","pos":[4444,4522]},{"content":"Additionally, the LINQ to XML provider enables XML literals and XML axis properties that enable you to write XML directly in your Visual Basic code.","pos":[4535,4683]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>XML<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/index.md)</ept>.","pos":[4684,4791],"source":" For more information, see [XML](../../../../visual-basic/programming-guide/language-features/xml/index.md)."},{"content":"LINQ to DataSet","pos":[4796,4811]},{"content":"The LINQ to DataSet provider enables you to query and update data in an <ph id=\"ph1\">[!INCLUDE[vstecado](~/includes/vstecado-md.md)]</ph> dataset.","pos":[4812,4940],"source":"The LINQ to DataSet provider enables you to query and update data in an [!INCLUDE[vstecado](~/includes/vstecado-md.md)] dataset."},{"content":"You can add the power of LINQ to applications that use datasets in order to simplify and extend your capabilities for querying, aggregating, and updating the data in your dataset.","pos":[4941,5120]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>LINQ to DataSet<ept id=\"p1\">](../../../../framework/data/adonet/linq-to-dataset.md)</ept>.","pos":[5133,5231],"source":"For more information, see [LINQ to DataSet](../../../../framework/data/adonet/linq-to-dataset.md)."},{"pos":[5241,5266],"content":"Structure of a LINQ query","linkify":"Structure of a LINQ query","nodes":[{"content":"Structure of a LINQ query","pos":[0,25]}]},{"content":"A LINQ query, often referred to as a <bpt id=\"p1\">*</bpt>query expression<ept id=\"p1\">*</ept>, consists of a combination of query clauses that identify the data sources and iteration variables for the query.","pos":[5270,5439],"source":"A LINQ query, often referred to as a *query expression*, consists of a combination of query clauses that identify the data sources and iteration variables for the query."},{"content":"A query expression can also include instructions for sorting, filtering, grouping, and joining, or calculations to apply to the source data.","pos":[5440,5580]},{"content":"Query expression syntax resembles the syntax of SQL; therefore, you may find much of the syntax familiar.","pos":[5581,5686]},{"content":"A query expression starts with a <ph id=\"ph1\">`From`</ph> clause.","pos":[5693,5740],"source":"A query expression starts with a `From` clause."},{"content":"This clause identifies the source data for a query and the variables that are used to refer to each element of the source data individually.","pos":[5741,5881]},{"content":"These variables are named <bpt id=\"p1\">*</bpt>range variables<ept id=\"p1\">*</ept> or <bpt id=\"p2\">*</bpt>iteration variables<ept id=\"p2\">*</ept>.","pos":[5882,5951],"source":" These variables are named *range variables* or *iteration variables*."},{"content":"The <ph id=\"ph1\">`From`</ph> clause is required for a query, except for <ph id=\"ph2\">`Aggregate`</ph> queries, where the <ph id=\"ph3\">`From`</ph> clause is optional.","pos":[5952,6063],"source":" The `From` clause is required for a query, except for `Aggregate` queries, where the `From` clause is optional."},{"content":"After the scope and source of the query are identified in the <ph id=\"ph1\">`From`</ph> or <ph id=\"ph2\">`Aggregate`</ph> clauses, you can include any combination of query clauses to refine the query.","pos":[6064,6226],"source":" After the scope and source of the query are identified in the `From` or `Aggregate` clauses, you can include any combination of query clauses to refine the query."},{"content":"For details about query clauses, see Visual Basic LINQ Query Operators later in this topic.","pos":[6227,6318]},{"content":"For example, the following query identifies a source collection of customer data as the <ph id=\"ph1\">`customers`</ph> variable, and an iteration variable named <ph id=\"ph2\">`cust`</ph>.","pos":[6319,6468],"source":" For example, the following query identifies a source collection of customer data as the `customers` variable, and an iteration variable named `cust`."},{"content":"This example is a valid query by itself; however, the query becomes far more powerful when you add more query clauses to refine the result.","pos":[6601,6740]},{"content":"For example, you can add a <ph id=\"ph1\">`Where`</ph> clause to filter the result by one or more values.","pos":[6741,6826],"source":" For example, you can add a `Where` clause to filter the result by one or more values."},{"content":"Query expressions are a single line of code; you can just append additional query clauses to the end of the query.","pos":[6827,6941]},{"content":"You can break up a query across multiple lines of text to improve readability by using the underscore (<ph id=\"ph1\">\\_</ph>) line-continuation character.","pos":[6942,7077],"source":" You can break up a query across multiple lines of text to improve readability by using the underscore (\\_) line-continuation character."},{"content":"The following code example shows an example of a query that includes a <ph id=\"ph1\">`Where`</ph> clause.","pos":[7078,7164],"source":" The following code example shows an example of a query that includes a `Where` clause."},{"content":"Another powerful query clause is the <ph id=\"ph1\">`Select`</ph> clause, which enables you to return only selected fields from the data source.","pos":[7297,7421],"source":"Another powerful query clause is the `Select` clause, which enables you to return only selected fields from the data source."},{"content":"LINQ queries return enumerable collections of strongly typed objects.","pos":[7422,7491]},{"content":"A query can return a collection of anonymous types or named types.","pos":[7492,7558]},{"content":"You can use the <ph id=\"ph1\">`Select`</ph> clause to return only a single field from the data source.","pos":[7559,7642],"source":" You can use the `Select` clause to return only a single field from the data source."},{"content":"When you do this, the type of the collection returned is the type of that single field.","pos":[7643,7730]},{"content":"You can also use the <ph id=\"ph1\">`Select`</ph> clause to return multiple fields from the data source.","pos":[7731,7815],"source":" You can also use the `Select` clause to return multiple fields from the data source."},{"content":"When you do this, the type of the collection returned is a new anonymous type.","pos":[7816,7894]},{"content":"You can also match the fields returned by the query to the fields of a specified named type.","pos":[7895,7987]},{"content":"The following code example shows a query expression that returns a collection of anonymous types that have members populated with data from the selected fields from the data source.","pos":[7988,8169]},{"content":"LINQ queries can also be used to combine multiple sources of data and return a single result.","pos":[8302,8395]},{"content":"This can be done with one or more <ph id=\"ph1\">`From`</ph> clauses, or by using the <ph id=\"ph2\">`Join`</ph> or <ph id=\"ph3\">`Group Join`</ph> query clauses.","pos":[8396,8499],"source":" This can be done with one or more `From` clauses, or by using the `Join` or `Group Join` query clauses."},{"content":"The following code example shows a query expression that combines customer and order data and returns a collection of anonymous types containing customer and order data.","pos":[8500,8669]},{"content":"You can use the <ph id=\"ph1\">`Group Join`</ph> clause to create a hierarchical query result that contains a collection of customer objects.","pos":[8802,8923],"source":"You can use the `Group Join` clause to create a hierarchical query result that contains a collection of customer objects."},{"content":"Each customer object has a property that contains a collection of all orders for that customer.","pos":[8924,9019]},{"content":"The following code example shows a query expression that combines customer and order data as a hierarchical result and returns a collection of anonymous types.","pos":[9020,9179]},{"content":"The query returns a type that includes a <ph id=\"ph1\">`CustomerOrders`</ph> property that contains a collection of order data for the customer.","pos":[9180,9305],"source":" The query returns a type that includes a `CustomerOrders` property that contains a collection of order data for the customer."},{"content":"It also includes an <ph id=\"ph1\">`OrderTotal`</ph> property that contains the sum of the totals for all the orders for that customer.","pos":[9306,9421],"source":" It also includes an `OrderTotal` property that contains the sum of the totals for all the orders for that customer."},{"content":"(This query is equivalent to a LEFT OUTER JOIN.)","pos":[9422,9470]},{"content":"There are several additional LINQ query operators that you can use to create powerful query expressions.","pos":[9603,9707]},{"content":"The next section of this topic discusses the various query clauses that you can include in a query expression.","pos":[9708,9818]},{"content":"For details about Visual Basic query clauses, see <bpt id=\"p1\">[</bpt>Queries<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/index.md)</ept>.","pos":[9819,9941],"source":" For details about Visual Basic query clauses, see [Queries](../../../../visual-basic/language-reference/queries/index.md)."},{"pos":[9950,9983],"content":"Visual Basic LINQ query operators","linkify":"Visual Basic LINQ query operators","nodes":[{"content":"Visual Basic LINQ query operators","pos":[0,33]}]},{"content":"The classes in the <ph id=\"ph1\">&lt;xref:System.Linq&gt;</ph> namespace and the other namespaces that support LINQ queries include methods that you can call to create and refine queries based on the needs of your application.","pos":[9987,10188],"source":"The classes in the <xref:System.Linq> namespace and the other namespaces that support LINQ queries include methods that you can call to create and refine queries based on the needs of your application."},{"content":"Visual Basic includes keywords for the following common query clauses.","pos":[10189,10259]},{"content":"For details about Visual Basic query clauses, see <bpt id=\"p1\">[</bpt>Queries<ept id=\"p1\">](../../../language-reference/queries/index.md)</ept>.","pos":[10260,10366],"source":" For details about Visual Basic query clauses, see [Queries](../../../language-reference/queries/index.md)."},{"pos":[10372,10383],"content":"From clause","linkify":"From clause","nodes":[{"content":"From clause","pos":[0,11]}]},{"content":"Either a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`From`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/from-clause.md)</ept> or an <ph id=\"ph2\">`Aggregate`</ph> clause is required to begin a query.","pos":[10385,10532],"source":"Either a [`From` clause](../../../../visual-basic/language-reference/queries/from-clause.md) or an `Aggregate` clause is required to begin a query."},{"content":"A <ph id=\"ph1\">`From`</ph> clause specifies a source collection and an iteration variable for a query.","pos":[10533,10617],"source":" A `From` clause specifies a source collection and an iteration variable for a query."},{"content":"For example:","pos":[10618,10630]},{"pos":[10758,10771],"content":"Select clause","linkify":"Select clause","nodes":[{"content":"Select clause","pos":[0,13]}]},{"content":"Optional.","pos":[10773,10782]},{"content":"A <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Select`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/select-clause.md)</ept> declares a set of iteration variables for a query.","pos":[10783,10923],"source":" A [`Select` clause](../../../../visual-basic/language-reference/queries/select-clause.md) declares a set of iteration variables for a query."},{"content":"For example:","pos":[10924,10936]},{"pos":[11060,11218],"content":"If a <ph id=\"ph1\">`Select`</ph> clause is not specified, the iteration variables for the query consist of the iteration variables specified by the <ph id=\"ph2\">`From`</ph> or <ph id=\"ph3\">`Aggregate`</ph> clause.","source":"If a `Select` clause is not specified, the iteration variables for the query consist of the iteration variables specified by the `From` or `Aggregate` clause."},{"pos":[11224,11236],"content":"Where clause","linkify":"Where clause","nodes":[{"content":"Where clause","pos":[0,12]}]},{"content":"Optional.","pos":[11238,11247]},{"content":"A <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Where`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/where-clause.md)</ept> specifies a filtering condition for a query.","pos":[11248,11380],"source":" A [`Where` clause](../../../../visual-basic/language-reference/queries/where-clause.md) specifies a filtering condition for a query."},{"content":"For example:","pos":[11381,11393]},{"pos":[11521,11537],"content":"Order By clause]","linkify":"Order By clause]","nodes":[{"content":"Order By clause]","pos":[0,16]}]},{"content":"|Optional.","pos":[11539,11549]},{"content":"An <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Order By`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/order-by-clause.md)</ept> specifies the sort order for columns in a query.","pos":[11550,11693],"source":" An [`Order By` clause](../../../../visual-basic/language-reference/queries/order-by-clause.md) specifies the sort order for columns in a query."},{"content":"For example:","pos":[11694,11706]},{"pos":[11836,11847],"content":"Join clause","linkify":"Join clause","nodes":[{"content":"Join clause","pos":[0,11]}]},{"content":"Optional.","pos":[11849,11858]},{"content":"A <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Join`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/join-clause.md)</ept> combines two collections into a single collection.","pos":[11859,11995],"source":" A [`Join` clause](../../../../visual-basic/language-reference/queries/join-clause.md) combines two collections into a single collection."},{"content":"For example:","pos":[11996,12008]},{"pos":[12138,12153],"content":"Group By clause","linkify":"Group By clause","nodes":[{"content":"Group By clause","pos":[0,15]}]},{"content":"Optional.","pos":[12155,12164]},{"content":"A <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Group By`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/group-by-clause.md)</ept> groups the elements of a query result.","pos":[12165,12297],"source":" A [`Group By` clause](../../../../visual-basic/language-reference/queries/group-by-clause.md) groups the elements of a query result."},{"content":"It can be used to apply aggregate functions to each group.","pos":[12298,12356]},{"content":"For example:","pos":[12357,12369]},{"pos":[12499,12516],"content":"Group Join clause","linkify":"Group Join clause","nodes":[{"content":"Group Join clause","pos":[0,17]}]},{"content":"Optional.","pos":[12518,12527]},{"content":"A <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Group Join`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/group-join-clause.md)</ept> combines two collections into a single hierarchical collection.","pos":[12528,12689],"source":" A [`Group Join` clause](../../../../visual-basic/language-reference/queries/group-join-clause.md) combines two collections into a single hierarchical collection."},{"content":"For example:","pos":[12690,12702]},{"pos":[12832,12848],"content":"Aggregate clause","linkify":"Aggregate clause","nodes":[{"content":"Aggregate clause","pos":[0,16]}]},{"content":"Either an <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Aggregate`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/aggregate-clause.md)</ept> or a <ph id=\"ph2\">`From`</ph> clause is required to begin a query.","pos":[12850,13002],"source":"Either an [`Aggregate` clause](../../../../visual-basic/language-reference/queries/aggregate-clause.md) or a `From` clause is required to begin a query."},{"content":"An <ph id=\"ph1\">`Aggregate`</ph> clause applies one or more aggregate functions to a collection.","pos":[13003,13081],"source":" An `Aggregate` clause applies one or more aggregate functions to a collection."},{"content":"For example, you can use the <ph id=\"ph1\">`Aggregate`</ph> clause to calculate a sum for all the elements returned by a query, as the following example does.","pos":[13082,13221],"source":" For example, you can use the `Aggregate` clause to calculate a sum for all the elements returned by a query, as the following example does."},{"content":"You can also use the <ph id=\"ph1\">`Aggregate`</ph> clause to modify a query.","pos":[13347,13405],"source":"You can also use the `Aggregate` clause to modify a query."},{"content":"For example, you can use the <ph id=\"ph1\">`Aggregate`</ph> clause to perform a calculation on a related query collection.","pos":[13406,13509],"source":" For example, you can use the `Aggregate` clause to perform a calculation on a related query collection."},{"content":"For example:","pos":[13510,13522]},{"pos":[13652,13662],"content":"Let clause","linkify":"Let clause","nodes":[{"content":"Let clause","pos":[0,10]}]},{"content":"Optional.","pos":[13664,13673]},{"content":"A <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Let`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/let-clause.md)</ept> computes a value and assigns it to a new variable in the query.","pos":[13674,13821],"source":" A [`Let` clause](../../../../visual-basic/language-reference/queries/let-clause.md) computes a value and assigns it to a new variable in the query."},{"content":"For example:","pos":[13822,13834]},{"pos":[13964,13979],"content":"Distinct clause","linkify":"Distinct clause","nodes":[{"content":"Distinct clause","pos":[0,15]}]},{"content":"Optional.","pos":[13981,13990]},{"content":"A <ph id=\"ph1\">`Distinct`</ph> clause restricts the values of the current iteration variable to eliminate duplicate values in query results.","pos":[13991,14113],"source":" A `Distinct` clause restricts the values of the current iteration variable to eliminate duplicate values in query results."},{"content":"For example:","pos":[14114,14126]},{"pos":[14256,14267],"content":"Skip clause","linkify":"Skip clause","nodes":[{"content":"Skip clause","pos":[0,11]}]},{"content":"Optional.","pos":[14269,14278]},{"content":"A <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Skip`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/skip-clause.md)</ept> bypasses a specified number of elements in a collection and then returns the remaining elements.","pos":[14279,14461],"source":" A [`Skip` clause](../../../../visual-basic/language-reference/queries/skip-clause.md) bypasses a specified number of elements in a collection and then returns the remaining elements."},{"content":"For example:","pos":[14462,14474]},{"pos":[14604,14621],"content":"Skip While clause","linkify":"Skip While clause","nodes":[{"content":"Skip While clause","pos":[0,17]}]},{"content":"Optional.","pos":[14623,14632]},{"content":"A <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Skip While`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/skip-while-clause.md)</ept> bypasses elements in a collection as long as a specified condition is <ph id=\"ph2\">`true`</ph> and then returns the remaining elements.","pos":[14633,14848],"source":" A [`Skip While` clause](../../../../visual-basic/language-reference/queries/skip-while-clause.md) bypasses elements in a collection as long as a specified condition is `true` and then returns the remaining elements."},{"content":"For example:","pos":[14849,14861]},{"pos":[14991,15002],"content":"Take clause","linkify":"Take clause","nodes":[{"content":"Take clause","pos":[0,11]}]},{"content":"Optional.","pos":[15004,15013]},{"content":"A <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Take`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/take-clause.md)</ept> returns a specified number of contiguous elements from the start of a collection.","pos":[15014,15181],"source":" A [`Take` clause](../../../../visual-basic/language-reference/queries/take-clause.md) returns a specified number of contiguous elements from the start of a collection."},{"content":"For example:","pos":[15182,15194]},{"pos":[15324,15341],"content":"Take While clause","linkify":"Take While clause","nodes":[{"content":"Take While clause","pos":[0,17]}]},{"content":"Optional.","pos":[15343,15352]},{"content":"A <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Take While`</ph> clause<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/take-while-clause.md)</ept> includes elements in a collection as long as a specified condition is <ph id=\"ph2\">`true`</ph> and bypasses the remaining elements.","pos":[15353,15564],"source":" A [`Take While` clause](../../../../visual-basic/language-reference/queries/take-while-clause.md) includes elements in a collection as long as a specified condition is `true` and bypasses the remaining elements."},{"content":"For example:","pos":[15565,15577]},{"pos":[15708,15742],"content":"Use additional LINQ query features","linkify":"Use additional LINQ query features","nodes":[{"content":"Use additional LINQ query features","pos":[0,34]}]},{"content":"You can use additional LINQ query features by calling members of the enumerable and queryable types provided by LINQ.","pos":[15748,15865]},{"content":"You can use these additional capabilities by calling a particular query operator on the result of a query expression.","pos":[15866,15983]},{"content":"For example, the following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Union%2A?displayProperty=nameWithType&gt;</ph> method to combine the results of two queries into one query result.","pos":[15984,16163],"source":" For example, the following example uses the <xref:System.Linq.Enumerable.Union%2A?displayProperty=nameWithType> method to combine the results of two queries into one query result."},{"content":"It uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.ToList%2A?displayProperty=nameWithType&gt;</ph> method to return the query result as a generic list.","pos":[16164,16297],"source":" It uses the <xref:System.Linq.Enumerable.ToList%2A?displayProperty=nameWithType> method to return the query result as a generic list."},{"pos":[16430,16576],"content":"For details about additional LINQ capabilities, see <bpt id=\"p1\">[</bpt>Standard Query Operators Overview<ept id=\"p1\">](../../concepts/linq/standard-query-operators-overview.md)</ept>.","source":"For details about additional LINQ capabilities, see [Standard Query Operators Overview](../../concepts/linq/standard-query-operators-overview.md)."},{"pos":[16585,16627],"content":"Connect to a database by using LINQ to SQL","linkify":"Connect to a database by using LINQ to SQL","nodes":[{"content":"Connect to a database by using LINQ to SQL","pos":[0,42]}]},{"content":"In Visual Basic, you identify the SQL Server database objects, such as tables, views, and stored procedures, that you want to access by using a LINQ to SQL file.","pos":[16631,16792]},{"content":"A LINQ to SQL file has an extension of .dbml.","pos":[16793,16838]},{"content":"When you have a valid connection to a SQL Server database, you can add a <bpt id=\"p1\">**</bpt>LINQ to SQL Classes<ept id=\"p1\">**</ept> item template to your project.","pos":[16845,16972],"source":"When you have a valid connection to a SQL Server database, you can add a **LINQ to SQL Classes** item template to your project."},{"content":"This will display the Object Relational Designer (O/R designer).","pos":[16973,17037]},{"content":"The O/R Designer enables you to drag the items that you want to access in your code from the <bpt id=\"p1\">**</bpt>Server Explorer<ept id=\"p1\">**</ept><ph id=\"ph1\">/</ph><bpt id=\"p2\">**</bpt>Database Explorer<ept id=\"p2\">**</ept> onto the designer surface.","pos":[17038,17199],"source":" The O/R Designer enables you to drag the items that you want to access in your code from the **Server Explorer**/**Database Explorer** onto the designer surface."},{"content":"The LINQ to SQL file adds a <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object to your project.","pos":[17200,17287],"source":" The LINQ to SQL file adds a <xref:System.Data.Linq.DataContext> object to your project."},{"content":"This object includes properties and collections for the tables and views that you want access to, and methods for the stored procedures that you want to call.","pos":[17288,17446]},{"content":"After you have saved your changes to the LINQ to SQL (.dbml) file, you can access these objects in your code by referencing the <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object that is defined by the O/R Designer.","pos":[17447,17654],"source":" After you have saved your changes to the LINQ to SQL (.dbml) file, you can access these objects in your code by referencing the <xref:System.Data.Linq.DataContext> object that is defined by the O/R Designer."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object for your project is named based on the name of your LINQ to SQL file.","pos":[17655,17771],"source":" The <xref:System.Data.Linq.DataContext> object for your project is named based on the name of your LINQ to SQL file."},{"content":"For example, a LINQ to SQL file that is named Northwind.dbml will create a <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object named <ph id=\"ph2\">`NorthwindDataContext`</ph>.","pos":[17772,17919],"source":" For example, a LINQ to SQL file that is named Northwind.dbml will create a <xref:System.Data.Linq.DataContext> object named `NorthwindDataContext`."},{"pos":[17926,18131],"content":"For examples with step-by-step instructions, see <bpt id=\"p1\">[</bpt>How to: Query a Database<ept id=\"p1\">](how-to-query-a-database-by-using-linq.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Call a Stored Procedure<ept id=\"p2\">](how-to-call-a-stored-procedure-by-using-linq.md)</ept>.","source":"For examples with step-by-step instructions, see [How to: Query a Database](how-to-query-a-database-by-using-linq.md) and [How to: Call a Stored Procedure](how-to-call-a-stored-procedure-by-using-linq.md)."},{"pos":[18140,18179],"content":"Visual Basic features that support LINQ","linkify":"Visual Basic features that support LINQ","nodes":[{"content":"Visual Basic features that support LINQ","pos":[0,39]}]},{"content":"Visual Basic includes other notable features that make the use of LINQ simple and reduce the amount of code that you must write to perform LINQ queries.","pos":[18183,18335]},{"content":"These include the following:","pos":[18336,18364]},{"pos":[18374,18457],"content":"<bpt id=\"p1\">**</bpt>Anonymous types<ept id=\"p1\">**</ept>, which enable you to create a new type based on a query result.","source":"**Anonymous types**, which enable you to create a new type based on a query result."},{"pos":[18467,18605],"content":"<bpt id=\"p1\">**</bpt>Implicitly typed variables<ept id=\"p1\">**</ept>, which enable you to defer specifying a type and let the compiler infer the type based on the query result.","source":"**Implicitly typed variables**, which enable you to defer specifying a type and let the compiler infer the type based on the query result."},{"pos":[18615,18738],"content":"<bpt id=\"p1\">**</bpt>Extension methods<ept id=\"p1\">**</ept>, which enable you to extend an existing type with your own methods without modifying the type itself.","source":"**Extension methods**, which enable you to extend an existing type with your own methods without modifying the type itself."},{"pos":[18745,18855],"content":"For details, see <bpt id=\"p1\">[</bpt>Visual Basic Features That Support LINQ<ept id=\"p1\">](../../concepts/linq/features-that-support-linq.md)</ept>.","source":"For details, see [Visual Basic Features That Support LINQ](../../concepts/linq/features-that-support-linq.md)."},{"pos":[18864,18902],"content":"Deferred and immediate query execution","linkify":"Deferred and immediate query execution","nodes":[{"content":"Deferred and immediate query execution","pos":[0,38]}]},{"content":"Query execution is separate from creating a query.","pos":[18905,18955]},{"content":"After a query is created, its execution is triggered by a separate mechanism.","pos":[18956,19033]},{"content":"A query can be executed as soon as it is defined (<bpt id=\"p1\">*</bpt>immediate execution<ept id=\"p1\">*</ept>), or the definition can be stored and the query can be executed later (<bpt id=\"p2\">*</bpt>deferred execution<ept id=\"p2\">*</ept>).","pos":[19034,19199],"source":" A query can be executed as soon as it is defined (*immediate execution*), or the definition can be stored and the query can be executed later (*deferred execution*)."},{"content":"By default, when you create a query, the query itself does not execute immediately.","pos":[19206,19289]},{"content":"Instead, the query definition is stored in the variable that is used to reference the query result.","pos":[19290,19389]},{"content":"When the query result variable is accessed later in code, such as in a <ph id=\"ph1\">`For…Next`</ph> loop, the query is executed.","pos":[19390,19500],"source":" When the query result variable is accessed later in code, such as in a `For…Next` loop, the query is executed."},{"content":"This process is referred to as <bpt id=\"p1\">*</bpt>deferred execution<ept id=\"p1\">*</ept>.","pos":[19501,19553],"source":" This process is referred to as *deferred execution*."},{"content":"Queries can also be executed when they are defined, which is referred to as <bpt id=\"p1\">*</bpt>immediate execution<ept id=\"p1\">*</ept>.","pos":[19560,19658],"source":"Queries can also be executed when they are defined, which is referred to as *immediate execution*."},{"content":"You can trigger immediate execution by applying a method that requires access to individual elements of the query result.","pos":[19659,19780]},{"content":"This can be the result of including an aggregate function, such as <ph id=\"ph1\">`Count`</ph>, <ph id=\"ph2\">`Sum`</ph>, <ph id=\"ph3\">`Average`</ph>, <ph id=\"ph4\">`Min`</ph>, or <ph id=\"ph5\">`Max`</ph>.","pos":[19781,19891],"source":" This can be the result of including an aggregate function, such as `Count`, `Sum`, `Average`, `Min`, or `Max`."},{"content":"For more information about aggregate functions, see <bpt id=\"p1\">[</bpt>Aggregate Clause<ept id=\"p1\">](../../../language-reference/queries/aggregate-clause.md)</ept>.","pos":[19892,20020],"source":" For more information about aggregate functions, see [Aggregate Clause](../../../language-reference/queries/aggregate-clause.md)."},{"content":"Using the <ph id=\"ph1\">`ToList`</ph> or <ph id=\"ph2\">`ToArray`</ph> methods will also force immediate execution.","pos":[20027,20103],"source":"Using the `ToList` or `ToArray` methods will also force immediate execution."},{"content":"This can be useful when you want to execute the query immediately and cache the results.","pos":[20104,20192]},{"content":"For more information about these methods, see <bpt id=\"p1\">[</bpt>Converting Data Types<ept id=\"p1\">](../../concepts/linq/converting-data-types.md)</ept>.","pos":[20193,20309],"source":" For more information about these methods, see [Converting Data Types](../../concepts/linq/converting-data-types.md)."},{"pos":[20316,20450],"content":"For more information about query execution, see <bpt id=\"p1\">[</bpt>Writing Your First LINQ Query<ept id=\"p1\">](../../concepts/linq/writing-your-first-linq-query.md)</ept>.","source":"For more information about query execution, see [Writing Your First LINQ Query](../../concepts/linq/writing-your-first-linq-query.md)."},{"pos":[20459,20478],"content":"XML in Visual Basic","linkify":"XML in Visual Basic","nodes":[{"content":"XML in Visual Basic","pos":[0,19]}]},{"content":"The XML features in Visual Basic include XML literals and XML axis properties, which enable you easily to create, access, query, and modify XML in your code.","pos":[20482,20639]},{"content":"XML literals enable you to write XML directly in your code.","pos":[20640,20699]},{"content":"The Visual Basic compiler treats the XML as a first-class data object.","pos":[20700,20770]},{"content":"The following code example shows how to create an XML element, access its sub-elements and attributes, and query the contents of the element by using LINQ.","pos":[20777,20932]},{"pos":[21058,21107],"content":"For more information, see <bpt id=\"p1\">[</bpt>XML<ept id=\"p1\">](../xml/index.md)</ept>.","source":"For more information, see [XML](../xml/index.md)."},{"pos":[21116,21133],"content":"Related resources","linkify":"Related resources","nodes":[{"content":"Related resources","pos":[0,17]}]},{"content":"Topic","pos":[21140,21145]},{"content":"Description","pos":[21146,21157]},{"pos":[21174,21217],"content":"<bpt id=\"p1\">[</bpt>XML<ept id=\"p1\">](../../language-features/xml/index.md)</ept>","source":"[XML](../../language-features/xml/index.md)"},{"content":"Describes the XML features in Visual Basic that can be queried and that enable you to include XML as first-class data objects in your Visual Basic code.","pos":[21218,21370]},{"pos":[21375,21430],"content":"<bpt id=\"p1\">[</bpt>Queries<ept id=\"p1\">](../../../language-reference/queries/index.md)</ept>","source":"[Queries](../../../language-reference/queries/index.md)"},{"content":"Provides reference information about the query clauses that are available in Visual Basic.","pos":[21431,21521]},{"pos":[21526,21590],"content":"<bpt id=\"p1\">[</bpt>LINQ (Language-Integrated Query)<ept id=\"p1\">](../../concepts/linq/index.md)</ept>","source":"[LINQ (Language-Integrated Query)](../../concepts/linq/index.md)"},{"content":"Includes general information, programming guidance, and samples for LINQ.","pos":[21591,21664]},{"pos":[21669,21730],"content":"<bpt id=\"p1\">[</bpt>LINQ to SQL<ept id=\"p1\">](~/docs/framework/data/adonet/sql/linq/index.md)</ept>","source":"[LINQ to SQL](~/docs/framework/data/adonet/sql/linq/index.md)"},{"content":"Includes general information, programming guidance, and samples for LINQ to SQL.","pos":[21731,21811]},{"pos":[21816,21873],"content":"<bpt id=\"p1\">[</bpt>LINQ to Objects<ept id=\"p1\">](../../concepts/linq/linq-to-objects.md)</ept>","source":"[LINQ to Objects](../../concepts/linq/linq-to-objects.md)"},{"content":"Includes general information, programming guidance, and samples for LINQ to Objects.","pos":[21874,21958]},{"pos":[21963,22045],"content":"<bpt id=\"p1\">[</bpt>LINQ to ADO.NET (Portal Page)<ept id=\"p1\">](../../concepts/linq/linq-to-adonet-portal-page.md)</ept>","source":"[LINQ to ADO.NET (Portal Page)](../../concepts/linq/linq-to-adonet-portal-page.md)"},{"content":"Includes links to general information, programming guidance, and samples for LINQ to ADO.NET.","pos":[22046,22139]},{"pos":[22144,22193],"content":"<bpt id=\"p1\">[</bpt>LINQ to XML<ept id=\"p1\">](../../concepts/linq/linq-to-xml.md)</ept>","source":"[LINQ to XML](../../concepts/linq/linq-to-xml.md)"},{"content":"Includes general information, programming guidance, and samples for LINQ to XML.","pos":[22194,22274]},{"pos":[22284,22313],"content":"How to and walkthrough topics","linkify":"How to and walkthrough topics","nodes":[{"content":"How to and walkthrough topics","pos":[0,29]}]},{"pos":[22315,22383],"content":"<bpt id=\"p1\">[</bpt>How to: Query a Database<ept id=\"p1\">](how-to-query-a-database-by-using-linq.md)</ept>","source":"[How to: Query a Database](how-to-query-a-database-by-using-linq.md)"},{"pos":[22390,22472],"content":"<bpt id=\"p1\">[</bpt>How to: Call a Stored Procedure<ept id=\"p1\">](how-to-call-a-stored-procedure-by-using-linq.md)</ept>","source":"[How to: Call a Stored Procedure](how-to-call-a-stored-procedure-by-using-linq.md)"},{"pos":[22479,22565],"content":"<bpt id=\"p1\">[</bpt>How to: Modify Data in a Database<ept id=\"p1\">](how-to-modify-data-in-a-database-by-using-linq.md)</ept>","source":"[How to: Modify Data in a Database](how-to-modify-data-in-a-database-by-using-linq.md)"},{"pos":[22572,22654],"content":"<bpt id=\"p1\">[</bpt>How to: Combine Data with Joins<ept id=\"p1\">](how-to-combine-data-with-linq-by-using-joins.md)</ept>","source":"[How to: Combine Data with Joins](how-to-combine-data-with-linq-by-using-joins.md)"},{"pos":[22661,22733],"content":"<bpt id=\"p1\">[</bpt>How to: Sort Query Results<ept id=\"p1\">](how-to-sort-query-results-by-using-linq.md)</ept>","source":"[How to: Sort Query Results](how-to-sort-query-results-by-using-linq.md)"},{"pos":[22740,22816],"content":"<bpt id=\"p1\">[</bpt>How to: Filter Query Results<ept id=\"p1\">](how-to-filter-query-results-by-using-linq.md)</ept>","source":"[How to: Filter Query Results](how-to-filter-query-results-by-using-linq.md)"},{"pos":[22823,22911],"content":"<bpt id=\"p1\">[</bpt>How to: Count, Sum, or Average Data<ept id=\"p1\">](how-to-count-sum-or-average-data-by-using-linq.md)</ept>","source":"[How to: Count, Sum, or Average Data](how-to-count-sum-or-average-data-by-using-linq.md)"},{"pos":[22918,23042],"content":"<bpt id=\"p1\">[</bpt>How to: Find the Minimum or Maximum Value in a Query Result<ept id=\"p1\">](how-to-find-the-minimum-or-maximum-value-in-a-query-result.md)</ept>","source":"[How to: Find the Minimum or Maximum Value in a Query Result](how-to-find-the-minimum-or-maximum-value-in-a-query-result.md)"},{"pos":[23049,23249],"content":"<bpt id=\"p1\">[</bpt>How to: Assign stored procedures to perform updates, inserts, and deletes (O/R Designer)<ept id=\"p1\">](/visualstudio/data-tools/how-to-assign-stored-procedures-to-perform-updates-inserts-and-deletes-o-r-designer)</ept>","source":"[How to: Assign stored procedures to perform updates, inserts, and deletes (O/R Designer)](/visualstudio/data-tools/how-to-assign-stored-procedures-to-perform-updates-inserts-and-deletes-o-r-designer)"},{"pos":[23258,23280],"content":"Featured book chapters","linkify":"Featured book chapters","nodes":[{"content":"Featured book chapters","pos":[0,22]}]},{"pos":[23284,23531],"content":"<bpt id=\"p1\">[</bpt>Chapter 17: LINQ<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652502(v=orm.10))</ept> in <bpt id=\"p2\">[</bpt>Programming Visual Basic 2008<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652504(v=orm.10))</ept>","source":"[Chapter 17: LINQ](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652502(v=orm.10)) in [Programming Visual Basic 2008](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652504(v=orm.10))"},{"pos":[23540,23548],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[23552,23616],"content":"<bpt id=\"p1\">[</bpt>LINQ (Language-Integrated Query)<ept id=\"p1\">](../../concepts/linq/index.md)</ept>","source":"[LINQ (Language-Integrated Query)](../../concepts/linq/index.md)"},{"pos":[23619,23716],"content":"<bpt id=\"p1\">[</bpt>Overview of LINQ to XML in Visual Basic<ept id=\"p1\">](../../language-features/xml/overview-of-linq-to-xml.md)</ept>","source":"[Overview of LINQ to XML in Visual Basic](../../language-features/xml/overview-of-linq-to-xml.md)"},{"pos":[23719,23803],"content":"<bpt id=\"p1\">[</bpt>LINQ to DataSet Overview<ept id=\"p1\">](~/docs/framework/data/adonet/linq-to-dataset-overview.md)</ept>","source":"[LINQ to DataSet Overview](~/docs/framework/data/adonet/linq-to-dataset-overview.md)"},{"pos":[23806,23867],"content":"<bpt id=\"p1\">[</bpt>LINQ to SQL<ept id=\"p1\">](~/docs/framework/data/adonet/sql/linq/index.md)</ept>","source":"[LINQ to SQL](~/docs/framework/data/adonet/sql/linq/index.md)"},{"pos":[23870,23968],"content":"<bpt id=\"p1\">[</bpt>LINQ to SQL Tools in Visual Studio<ept id=\"p1\">](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)</ept>","source":"[LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)"},{"pos":[23971,24066],"content":"<bpt id=\"p1\">[</bpt>DataContext Methods (O/R Designer)<ept id=\"p1\">](/visualstudio/data-tools/datacontext-methods-o-r-designer)</ept>","source":"[DataContext Methods (O/R Designer)](/visualstudio/data-tools/datacontext-methods-o-r-designer)"}]}