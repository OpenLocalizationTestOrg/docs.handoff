{"content":"---\ntitle: \"Walkthrough: Working with the MaskedTextBox Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"input, controlling to ensure validity\"\n  - \"MaskedTextBox control [Windows Forms], walkthroughs\"\n  - \"MaskedTextBox control [Windows Forms], validation\"\n  - \"user input, controlling\"\n  - \"text, controls for input\"\nms.assetid: df60565e-5447-4110-92a6-be1f6ff5faa3\ncaps.latest.revision: 16\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Working with the MaskedTextBox Control\nTasks illustrated in this walkthrough include:  \n  \n-   Initializing the <xref:System.Windows.Forms.MaskedTextBox> control  \n  \n-   Using the <xref:System.Windows.Forms.MaskedTextBox.MaskInputRejected> event handler to alert the user when a character does not conform to the mask  \n  \n-   Assigning a type to the <xref:System.Windows.Forms.MaskedTextBox.ValidatingType%2A> property and using the <xref:System.Windows.Forms.MaskedTextBox.TypeValidationCompleted> event handler to alert the user when the value they're attempting to commit is not valid for the type  \n  \n## Creating the Project and Adding a Control  \n  \n#### To add a MaskedTextBox control to your form  \n  \n1.  Open the form on which you want to place the <xref:System.Windows.Forms.MaskedTextBox> control.  \n  \n2.  Drag a <xref:System.Windows.Forms.MaskedTextBox> control from the **Toolbox** to your form.  \n  \n3.  Right-click the control and choose **Properties**. In the **Properties** window, select the **Mask** property and click the **...** (ellipsis) button next to the property name.  \n  \n4.  In the **Input Mask** dialog box, select the **Short Date** mask and click **OK**.  \n  \n5.  In the **Properties** window set the <xref:System.Windows.Forms.MaskedTextBox.BeepOnError%2A> property to `true`. This property causes a short beep to sound every time the user attempts to input a character that violates the mask definition.  \n  \n For a summary of the characters that the Mask property supports, see the Remarks section of the <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property.  \n  \n## Alert the User to Input Errors  \n  \n#### Add a balloon tip for rejected mask input  \n  \n1.  Return to the **Toolbox** and add a <xref:System.Windows.Forms.ToolTip> to your form.  \n  \n2.  Create an event handler for the <xref:System.Windows.Forms.MaskedTextBox.MaskInputRejected> event that raises the <xref:System.Windows.Forms.ToolTip> when an input error occurs. The balloon tip remains visible for five seconds, or until the user clicks it.  \n  \n    ```csharp  \n    public void Form1_Load(Object sender, EventArgs e)   \n    {  \n        ... // Other initialization code  \n        maskedTextBox1.Mask = \"00/00/0000\";  \n        maskedTextBox1.MaskInputRejected += new MaskInputRejectedEventHandler(maskedTextBox1_MaskInputRejected)  \n    }  \n  \n    void maskedTextBox1_MaskInputRejected(object sender, MaskInputRejectedEventArgs e)  \n    {  \n        toolTip1.ToolTipTitle = \"Invalid Input\";  \n        toolTip1.Show(\"We're sorry, but only digits (0-9) are allowed in dates.\", maskedTextBox1, maskedTextBox1.Location, 5000);  \n    }  \n    ```  \n  \n    ```vb  \n    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load  \n        Me.ToolTip1.IsBalloon = True  \n        Me.MaskedTextBox1.Mask = \"00/00/0000\"  \n    End Sub  \n  \n    Private Sub MaskedTextBox1_MaskInputRejected(sender as Object, e as MaskInputRejectedEventArgs) Handles MaskedTextBox1.MaskInputRejected  \n        ToolTip1.ToolTipTitle = \"Invalid Input\"  \n        ToolTip1.Show(\"We're sorry, but only digits (0-9) are allowed in dates.\", MaskedTextBox1, 5000)  \n    End Sub  \n  \n    ```  \n  \n## Alert the User to a Type that Is Not Valid  \n  \n#### Add a balloon tip for invalid data types  \n  \n1.  In your form's <xref:System.Windows.Forms.Form.Load> event handler, assign a <xref:System.Type> object representing the <xref:System.DateTime> type to the <xref:System.Windows.Forms.MaskedTextBox> control's <xref:System.Windows.Forms.MaskedTextBox.ValidatingType%2A> property:  \n  \n    ```csharp  \n    private void Form1_Load(Object sender, EventArgs e)  \n    {  \n        // Other code  \n        maskedTextBox1.ValidatingType = typeof(System.DateTime);  \n        maskedTextBox1.TypeValidationCompleted += new TypeValidationEventHandler(maskedTextBox1_TypeValidationCompleted);  \n    }  \n    ```  \n  \n    ```vb  \n    Private Sub Form1_Load(sender as Object, e as EventArgs)  \n        // Other code  \n        MaskedTextBox1.ValidatingType = GetType(System.DateTime)  \n    End Sub  \n    ```  \n  \n2.  Add an event handler for the <xref:System.Windows.Forms.MaskedTextBox.TypeValidationCompleted> event:  \n  \n    ```csharp  \n    public void maskedTextBox1_TypeValidationCompleted(object sender, TypeValidationEventArgs e)  \n    {  \n        if (!e.IsValidInput)  \n        {  \n           toolTip1.ToolTipTitle = \"Invalid Date Value\";  \n           toolTip1.Show(\"We're sorry, but the value you entered is not a valid date. Please change the value.\", maskedTextBox1, 5000);  \n           e.Cancel = true;  \n        }  \n    }  \n    ```  \n  \n    ```vb  \n    Public Sub MaskedTextBox1_TypeValidationCompleted(sender as Object, e as TypeValidationEventArgs)  \n        If Not e.IsValidInput Then  \n           ToolTip1.ToolTipTitle = \"Invalid Date Value\"  \n           ToolTip1.Show(\"We're sorry, but the value you entered is not a valid date. Please change the value.\", maskedTextBox1, 5000)  \n           e.Cancel = True  \n        End If  \n    End Sub  \n  \n    ```  \n  \n## See Also  \n <xref:System.Windows.Forms.MaskedTextBox>   \n [MaskedTextBox Control](../../../../docs/framework/winforms/controls/maskedtextbox-control-windows-forms.md)","nodes":[{"pos":[12,80],"content":"Walkthrough: Working with the MaskedTextBox Control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Walkthrough: Working with the MaskedTextBox Control | Microsoft Docs","pos":[0,68]}]},{"pos":[659,710],"content":"Walkthrough: Working with the MaskedTextBox Control","linkify":"Walkthrough: Working with the MaskedTextBox Control","nodes":[{"content":"Walkthrough: Working with the MaskedTextBox Control","pos":[0,51]}]},{"content":"Tasks illustrated in this walkthrough include:","pos":[711,757]},{"content":"Initializing the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph> control","pos":[767,833],"source":"Initializing the <xref:System.Windows.Forms.MaskedTextBox> control"},{"content":"Using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox.MaskInputRejected&gt;</ph> event handler to alert the user when a character does not conform to the mask","pos":[843,990],"source":"Using the <xref:System.Windows.Forms.MaskedTextBox.MaskInputRejected> event handler to alert the user when a character does not conform to the mask"},{"content":"Assigning a type to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox.ValidatingType%2A&gt;</ph> property and using the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.MaskedTextBox.TypeValidationCompleted&gt;</ph> event handler to alert the user when the value they're attempting to commit is not valid for the type","pos":[1000,1274],"source":"Assigning a type to the <xref:System.Windows.Forms.MaskedTextBox.ValidatingType%2A> property and using the <xref:System.Windows.Forms.MaskedTextBox.TypeValidationCompleted> event handler to alert the user when the value they're attempting to commit is not valid for the type"},{"pos":[1283,1324],"content":"Creating the Project and Adding a Control","linkify":"Creating the Project and Adding a Control","nodes":[{"content":"Creating the Project and Adding a Control","pos":[0,41]}]},{"pos":[1335,1378],"content":"To add a MaskedTextBox control to your form","linkify":"To add a MaskedTextBox control to your form","nodes":[{"content":"To add a MaskedTextBox control to your form","pos":[0,43]}]},{"content":"Open the form on which you want to place the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph> control.","pos":[1388,1483],"source":"Open the form on which you want to place the <xref:System.Windows.Forms.MaskedTextBox> control."},{"pos":[1493,1584],"content":"Drag a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph> control from the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> to your form.","source":"Drag a <xref:System.Windows.Forms.MaskedTextBox> control from the **Toolbox** to your form."},{"content":"Right-click the control and choose <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","pos":[1594,1644],"source":"Right-click the control and choose **Properties**."},{"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, select the <bpt id=\"p2\">**</bpt>Mask<ept id=\"p2\">**</ept> property and click the <bpt id=\"p3\">**</bpt>...<ept id=\"p3\">**</ept> (ellipsis) button next to the property name.","pos":[1645,1770],"source":" In the **Properties** window, select the **Mask** property and click the **...** (ellipsis) button next to the property name."},{"pos":[1780,1862],"content":"In the <bpt id=\"p1\">**</bpt>Input Mask<ept id=\"p1\">**</ept> dialog box, select the <bpt id=\"p2\">**</bpt>Short Date<ept id=\"p2\">**</ept> mask and click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","source":"In the **Input Mask** dialog box, select the **Short Date** mask and click **OK**."},{"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox.BeepOnError%2A&gt;</ph> property to <ph id=\"ph2\">`true`</ph>.","pos":[1872,1985],"source":"In the **Properties** window set the <xref:System.Windows.Forms.MaskedTextBox.BeepOnError%2A> property to `true`."},{"content":"This property causes a short beep to sound every time the user attempts to input a character that violates the mask definition.","pos":[1986,2113]},{"content":"For a summary of the characters that the Mask property supports, see the Remarks section of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox.Mask%2A&gt;</ph> property.","pos":[2120,2275],"source":"For a summary of the characters that the Mask property supports, see the Remarks section of the <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property."},{"pos":[2284,2314],"content":"Alert the User to Input Errors","linkify":"Alert the User to Input Errors","nodes":[{"content":"Alert the User to Input Errors","pos":[0,30]}]},{"pos":[2325,2366],"content":"Add a balloon tip for rejected mask input","linkify":"Add a balloon tip for rejected mask input","nodes":[{"content":"Add a balloon tip for rejected mask input","pos":[0,41]}]},{"pos":[2376,2461],"content":"Return to the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> and add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolTip&gt;</ph> to your form.","source":"Return to the **Toolbox** and add a <xref:System.Windows.Forms.ToolTip> to your form."},{"content":"Create an event handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox.MaskInputRejected&gt;</ph> event that raises the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolTip&gt;</ph> when an input error occurs.","pos":[2471,2648],"source":"Create an event handler for the <xref:System.Windows.Forms.MaskedTextBox.MaskInputRejected> event that raises the <xref:System.Windows.Forms.ToolTip> when an input error occurs."},{"content":"The balloon tip remains visible for five seconds, or until the user clicks it.","pos":[2649,2727]},{"pos":[3887,3929],"content":"Alert the User to a Type that Is Not Valid","linkify":"Alert the User to a Type that Is Not Valid","nodes":[{"content":"Alert the User to a Type that Is Not Valid","pos":[0,42]}]},{"pos":[3940,3980],"content":"Add a balloon tip for invalid data types","linkify":"Add a balloon tip for invalid data types","nodes":[{"content":"Add a balloon tip for invalid data types","pos":[0,40]}]},{"content":"In your form's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.Load&gt;</ph> event handler, assign a <ph id=\"ph2\">&lt;xref:System.Type&gt;</ph> object representing the <ph id=\"ph3\">&lt;xref:System.DateTime&gt;</ph> type to the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph> control's <ph id=\"ph5\">&lt;xref:System.Windows.Forms.MaskedTextBox.ValidatingType%2A&gt;</ph> property:","pos":[3990,4266],"source":"In your form's <xref:System.Windows.Forms.Form.Load> event handler, assign a <xref:System.Type> object representing the <xref:System.DateTime> type to the <xref:System.Windows.Forms.MaskedTextBox> control's <xref:System.Windows.Forms.MaskedTextBox.ValidatingType%2A> property:"},{"content":"Add an event handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox.TypeValidationCompleted&gt;</ph> event:","pos":[4787,4888],"source":"Add an event handler for the <xref:System.Windows.Forms.MaskedTextBox.TypeValidationCompleted> event:"},{"pos":[5747,5755],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph>","pos":[5759,5800],"source":"<xref:System.Windows.Forms.MaskedTextBox> "},{"content":"<bpt id=\"p1\"> [</bpt>MaskedTextBox Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/maskedtextbox-control-windows-forms.md)</ept>","pos":[5804,5913],"source":" [MaskedTextBox Control](../../../../docs/framework/winforms/controls/maskedtextbox-control-windows-forms.md)"}]}