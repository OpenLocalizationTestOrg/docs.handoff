{"content":"---\ntitle: \"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICorProfilerAssemblyReferenceProvider.AddAssemblyReference\"\napi_location: \n  - \"mscorwks.dll\"\napi_type: \n  - \"COM\"\ndev_langs: \n  - \"C++\"\nms.assetid: 3d5af8e7-c337-48f4-9fa6-97c83878b9b1\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 5\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method\n[Supported in the .NET Framework 4.5.2 and later versions]  \n  \n Informs the common language runtime (CLR) of an assembly reference that the profiler plans to add in the [ICorProfilerCallback::ModuleLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md) callback.  \n  \n## Syntax  \n  \n```vb  \n  \nHRESULT AddAssemblyReference(  \n        const COR_PRF_ASSEMBLY_REFERENCE_INFO* pAssemblyRefInfo  \n);  \n  \n```  \n  \n#### Parameters  \n pAssemblyRefInfo  \n A pointer to a [COR_PRF_ASSEMBLY_REFERENCE_INFO](../../../../docs/framework/unmanaged-api/profiling/cor-prf-assembly-reference-info-structure.md) structure that provides the CLR with information about an assembly reference that it should consider when performing an assembly reference closure walk.  \n  \n## Remarks  \n The profiler calls this method for each target assembly it plans to reference from the assembly specified in the `wszAssemblyPath` argument of the [ICorProfilerCallback6::GetAssemblyReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) callback. The [ICorProfilerAssemblyReferenceProvider](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-interface.md) interface object is passed to the profiler's [ICorProfilerCallback6::GetAssemblyReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) callback, along with the assembly path and name in the `wszAssemblyPath` argument.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** CorProf.idl, CorProf.h  \n  \n **Library:** CorGuids.lib  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v452plus](../../../../includes/net-current-v452plus-md.md)]  \n  \n## See Also  \n [ICorProfilerAssemblyReferenceProvider Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-interface.md)   \n [GetAssemblyReferences Method](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md)   \n [ModuleLoadFinished Method](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md)","nodes":[{"pos":[4,572],"nodes":[{"content":"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method | Microsoft Docs","nodes":[{"pos":[0,83],"content":"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method | Microsoft Docs","nodes":[{"content":"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method | Microsoft Docs","pos":[0,83]}]}],"pos":[6,92],"yaml":true}],"content":"title: \"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICorProfilerAssemblyReferenceProvider.AddAssemblyReference\"\napi_location: \n  - \"mscorwks.dll\"\napi_type: \n  - \"COM\"\ndev_langs: \n  - \"C++\"\nms.assetid: 3d5af8e7-c337-48f4-9fa6-97c83878b9b1\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 5\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[579,645],"content":"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method","linkify":"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method","nodes":[{"content":"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method","pos":[0,66]}]},{"content":"[Supported in the .NET Framework 4.5.2 and later versions]","pos":[646,704]},{"pos":[711,970],"content":"Informs the common language runtime (CLR) of an assembly reference that the profiler plans to add in the <bpt id=\"p1\">[</bpt>ICorProfilerCallback::ModuleLoadFinished<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md)</ept> callback.","source":"Informs the common language runtime (CLR) of an assembly reference that the profiler plans to add in the [ICorProfilerCallback::ModuleLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md) callback."},{"pos":[979,985],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1122,1132],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"pAssemblyRefInfo","pos":[1136,1152]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>COR_PRF_ASSEMBLY_REFERENCE_INFO<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/cor-prf-assembly-reference-info-structure.md)</ept> structure that provides the CLR with information about an assembly reference that it should consider when performing an assembly reference closure walk.","pos":[1156,1454],"source":"A pointer to a [COR_PRF_ASSEMBLY_REFERENCE_INFO](../../../../docs/framework/unmanaged-api/profiling/cor-prf-assembly-reference-info-structure.md) structure that provides the CLR with information about an assembly reference that it should consider when performing an assembly reference closure walk."},{"pos":[1463,1470],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The profiler calls this method for each target assembly it plans to reference from the assembly specified in the <ph id=\"ph1\">`wszAssemblyPath`</ph> argument of the <bpt id=\"p1\">[</bpt>ICorProfilerCallback6::GetAssemblyReferences<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md)</ept> callback.","pos":[1474,1783],"source":"The profiler calls this method for each target assembly it plans to reference from the assembly specified in the `wszAssemblyPath` argument of the [ICorProfilerCallback6::GetAssemblyReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) callback."},{"content":"The <bpt id=\"p1\">[</bpt>ICorProfilerAssemblyReferenceProvider<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-interface.md)</ept> interface object is passed to the profiler's <bpt id=\"p2\">[</bpt>ICorProfilerCallback6::GetAssemblyReferences<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md)</ept> callback, along with the assembly path and name in the <ph id=\"ph1\">`wszAssemblyPath`</ph> argument.","pos":[1784,2211],"source":" The [ICorProfilerAssemblyReferenceProvider](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-interface.md) interface object is passed to the profiler's [ICorProfilerCallback6::GetAssemblyReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) callback, along with the assembly path and name in the `wszAssemblyPath` argument."},{"pos":[2220,2232],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2236,2340],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2347,2381],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> CorProf.idl, CorProf.h","source":"**Header:** CorProf.idl, CorProf.h"},{"pos":[2388,2413],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> CorGuids.lib","source":"**Library:** CorGuids.lib"},{"pos":[2420,2530],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v452plus](../../../../includes/net-current-v452plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v452plus](../../../../includes/net-current-v452plus-md.md)]"},{"pos":[2539,2547],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>ICorProfilerAssemblyReferenceProvider Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[2551,2704],"source":"[ICorProfilerAssemblyReferenceProvider Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>GetAssemblyReferences Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md)</ept><ph id=\"ph1\"> </ph>","pos":[2708,2845],"source":"[GetAssemblyReferences Method](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) "},{"content":"<bpt id=\"p1\">[</bpt>ModuleLoadFinished Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md)</ept>","pos":[2849,2978],"source":"[ModuleLoadFinished Method](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md)"}]}