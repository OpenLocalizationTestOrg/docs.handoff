{"content":"---\ntitle: \"Implementing the UI Automation Grid Control Pattern\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"control patterns, grid\"\n  - \"grid control pattern\"\n  - \"UI Automation, grid control pattern\"\nms.assetid: 234d11a0-7ce7-4309-8989-2f4720e02f78\n---\n# Implementing the UI Automation Grid Control Pattern\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IGridProvider>, including information about properties, methods, and events. Links to additional references are listed at the end of the overview.  \n  \n The <xref:System.Windows.Automation.GridPattern> control pattern is used to support controls that act as containers for a collection of child elements. The children of this element must implement <xref:System.Windows.Automation.Provider.IGridItemProvider> and be organized in a two-dimensional logical coordinate system that can be traversed by row and column. For examples of controls that implement this control pattern, see [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md).  \n  \n<a name=\"Implementation_Guidelines_and_Conventions\"></a>   \n## Implementation Guidelines and Conventions  \n When implementing the Grid control pattern, note the following guidelines and conventions:  \n  \n-   Grid coordinates are zero-based with the upper left (or upper right cell depending on locale) having coordinates (0, 0).  \n  \n-   If a cell is empty, a UI Automation element must still be returned in order to support the <xref:System.Windows.Automation.Provider.IGridItemProvider.ContainingGrid%2A> property for that cell. This is possible when the layout of child elements in the grid is similar to a ragged array (see example below).  \n  \n ![Windows Explorer view showing ragged layout.](../../../docs/framework/ui-automation/media/uia-gridpattern-ragged-array.PNG \"UIA_GridPattern_Ragged_Array\")  \nExample of a Grid Control with Empty Coordinates  \n  \n-   A grid with a single item is still required to implement <xref:System.Windows.Automation.Provider.IGridProvider> if it is logically considered to be a grid. The number of child items in the grid is immaterial.  \n  \n-   Hidden rows and columns, depending on the provider implementation, may be loaded in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree and therefore will be reflected in the <xref:System.Windows.Automation.GridPattern.GridPatternInformation.RowCount%2A> and <xref:System.Windows.Automation.GridPattern.GridPatternInformation.ColumnCount%2A> properties. If the hidden rows and columns have not yet been loaded, they should not be counted.  \n  \n-   <xref:System.Windows.Automation.Provider.IGridProvider> does not enable active manipulation of a grid; <xref:System.Windows.Automation.Provider.ITransformProvider> must be implemented to enable this functionality.  \n  \n-   Use a <xref:System.Windows.Automation.StructureChangedEventHandler> to listen for structural or layout changes to the grid such as cells that have been added, removed, or merged.  \n  \n-   Use a <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> to track traversal through the items or cells of a grid.  \n  \n<a name=\"Required_Members_for_IGridProvider\"></a>   \n## Required Members for IGridProvider  \n The following properties and methods are required for implementing the IGridProvider interface.  \n  \n|Required members|Type|Notes|  \n|----------------------|----------|-----------|  \n|<xref:System.Windows.Automation.Provider.IGridProvider.RowCount%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IGridProvider.ColumnCount%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IGridProvider.GetItem%2A>|Method|None|  \n  \n This control pattern has no associated events.  \n  \n<a name=\"Exceptions\"></a>   \n## Exceptions  \n Providers must throw the following exceptions.  \n  \n|Exception type|Condition|  \n|--------------------|---------------|  \n|<xref:System.ArgumentOutOfRangeException>|<xref:System.Windows.Automation.Provider.IGridProvider.GetItem%2A><br /><br /> -   If the requested row coordinate is larger than the <xref:System.Windows.Automation.Provider.IGridProvider.RowCount%2A> or the column coordinate is larger than the <xref:System.Windows.Automation.Provider.IGridProvider.ColumnCount%2A>.|  \n|<xref:System.ArgumentOutOfRangeException>|<xref:System.Windows.Automation.Provider.IGridProvider.GetItem%2A><br /><br /> -   If either of the requested row or column coordinates is less than zero.|  \n  \n## See also\n\n- [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)\n- [Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)\n- [UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)\n- [Implementing the UI Automation GridItem Control Pattern](../../../docs/framework/ui-automation/implementing-the-ui-automation-griditem-control-pattern.md)\n- [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)\n- [Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)\n","nodes":[{"pos":[4,255],"embed":true,"restype":"x-metadata","content":"title: \"Implementing the UI Automation Grid Control Pattern\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"control patterns, grid\"\n  - \"grid control pattern\"\n  - \"UI Automation, grid control pattern\"\nms.assetid: 234d11a0-7ce7-4309-8989-2f4720e02f78","nodes":[{"content":"Implementing the UI Automation Grid Control Pattern","nodes":[{"pos":[0,51],"content":"Implementing the UI Automation Grid Control Pattern","nodes":[{"content":"Implementing the UI Automation Grid Control Pattern","pos":[0,51]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[262,313],"content":"Implementing the UI Automation Grid Control Pattern","linkify":"Implementing the UI Automation Grid Control Pattern","nodes":[{"content":"Implementing the UI Automation Grid Control Pattern","pos":[0,51]}]},{"pos":[316,779],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,461],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"content":"This topic introduces guidelines and conventions for implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IGridProvider&gt;</ph>, including information about properties, methods, and events.","pos":[786,969],"source":"This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IGridProvider>, including information about properties, methods, and events."},{"content":"Links to additional references are listed at the end of the overview.","pos":[970,1039]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Automation.GridPattern&gt;</ph> control pattern is used to support controls that act as containers for a collection of child elements.","pos":[1046,1197],"source":"The <xref:System.Windows.Automation.GridPattern> control pattern is used to support controls that act as containers for a collection of child elements."},{"content":"The children of this element must implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IGridItemProvider&gt;</ph> and be organized in a two-dimensional logical coordinate system that can be traversed by row and column.","pos":[1198,1406],"source":" The children of this element must implement <xref:System.Windows.Automation.Provider.IGridItemProvider> and be organized in a two-dimensional logical coordinate system that can be traversed by row and column."},{"content":"For examples of controls that implement this control pattern, see <bpt id=\"p1\">[</bpt>Control Pattern Mapping for UI Automation Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)</ept>.","pos":[1407,1617],"source":" For examples of controls that implement this control pattern, see [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)."},{"pos":[1686,1727],"content":"Implementation Guidelines and Conventions","linkify":"Implementation Guidelines and Conventions","nodes":[{"content":"Implementation Guidelines and Conventions","pos":[0,41]}]},{"content":"When implementing the Grid control pattern, note the following guidelines and conventions:","pos":[1731,1821]},{"content":"Grid coordinates are zero-based with the upper left (or upper right cell depending on locale) having coordinates (0, 0).","pos":[1831,1951]},{"content":"If a cell is empty, a UI Automation element must still be returned in order to support the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IGridItemProvider.ContainingGrid%2A&gt;</ph> property for that cell.","pos":[1961,2153],"source":"If a cell is empty, a UI Automation element must still be returned in order to support the <xref:System.Windows.Automation.Provider.IGridItemProvider.ContainingGrid%2A> property for that cell."},{"content":"This is possible when the layout of child elements in the grid is similar to a ragged array (see example below).","pos":[2154,2266]},{"content":"<bpt id=\"p1\">![</bpt>Windows Explorer view showing ragged layout.<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../docs/framework/ui-automation/media/uia-gridpattern-ragged-array.PNG \"</bpt>UIA_GridPattern_Ragged_Array<ept id=\"p2\">\")</ept>","pos":[2273,2429],"source":"![Windows Explorer view showing ragged layout.](../../../docs/framework/ui-automation/media/uia-gridpattern-ragged-array.PNG \"UIA_GridPattern_Ragged_Array\")"},{"content":"Example of a Grid Control with Empty Coordinates","pos":[2432,2480]},{"content":"A grid with a single item is still required to implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IGridProvider&gt;</ph> if it is logically considered to be a grid.","pos":[2490,2646],"source":"A grid with a single item is still required to implement <xref:System.Windows.Automation.Provider.IGridProvider> if it is logically considered to be a grid."},{"content":"The number of child items in the grid is immaterial.","pos":[2647,2699]},{"content":"Hidden rows and columns, depending on the provider implementation, may be loaded in the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> tree and therefore will be reflected in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.GridPattern.GridPatternInformation.RowCount%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Automation.GridPattern.GridPatternInformation.ColumnCount%2A&gt;</ph> properties.","pos":[2709,3104],"source":"Hidden rows and columns, depending on the provider implementation, may be loaded in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree and therefore will be reflected in the <xref:System.Windows.Automation.GridPattern.GridPatternInformation.RowCount%2A> and <xref:System.Windows.Automation.GridPattern.GridPatternInformation.ColumnCount%2A> properties."},{"content":"If the hidden rows and columns have not yet been loaded, they should not be counted.","pos":[3105,3189]},{"pos":[3199,3412],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IGridProvider&gt;</ph> does not enable active manipulation of a grid; <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.ITransformProvider&gt;</ph> must be implemented to enable this functionality.","source":"<xref:System.Windows.Automation.Provider.IGridProvider> does not enable active manipulation of a grid; <xref:System.Windows.Automation.Provider.ITransformProvider> must be implemented to enable this functionality."},{"pos":[3422,3600],"content":"Use a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.StructureChangedEventHandler&gt;</ph> to listen for structural or layout changes to the grid such as cells that have been added, removed, or merged.","source":"Use a <xref:System.Windows.Automation.StructureChangedEventHandler> to listen for structural or layout changes to the grid such as cells that have been added, removed, or merged."},{"pos":[3610,3740],"content":"Use a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationFocusChangedEventHandler&gt;</ph> to track traversal through the items or cells of a grid.","source":"Use a <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> to track traversal through the items or cells of a grid."},{"pos":[3802,3836],"content":"Required Members for IGridProvider","linkify":"Required Members for IGridProvider","nodes":[{"content":"Required Members for IGridProvider","pos":[0,34]}]},{"content":"The following properties and methods are required for implementing the IGridProvider interface.","pos":[3840,3935]},{"content":"Required members","pos":[3942,3958]},{"content":"Type","pos":[3959,3963]},{"content":"Notes","pos":[3964,3969]},{"content":"Property","pos":[4092,4100]},{"content":"None","pos":[4101,4105]},{"content":"Property","pos":[4181,4189]},{"content":"None","pos":[4190,4194]},{"content":"Method","pos":[4266,4272]},{"content":"None","pos":[4273,4277]},{"content":"This control pattern has no associated events.","pos":[4285,4331]},{"pos":[4369,4379],"content":"Exceptions","linkify":"Exceptions","nodes":[{"content":"Exceptions","pos":[0,10]}]},{"content":"Providers must throw the following exceptions.","pos":[4383,4429]},{"content":"Exception type","pos":[4436,4450]},{"content":"Condition","pos":[4451,4460]},{"content":"-   If the requested row coordinate is larger than the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IGridProvider.RowCount%2A&gt;</ph> or the column coordinate is larger than the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.IGridProvider.ColumnCount%2A&gt;</ph>.","pos":[4627,4865],"source":"-   If the requested row coordinate is larger than the <xref:System.Windows.Automation.Provider.IGridProvider.RowCount%2A> or the column coordinate is larger than the <xref:System.Windows.Automation.Provider.IGridProvider.ColumnCount%2A>."},{"content":"-   If either of the requested row or column coordinates is less than zero.","pos":[4991,5066]},{"pos":[5076,5084],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5088,5211],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)</ept>","source":"[UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)"},{"pos":[5214,5363],"content":"<bpt id=\"p1\">[</bpt>Support Control Patterns in a UI Automation Provider<ept id=\"p1\">](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)</ept>","source":"[Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)"},{"pos":[5366,5495],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns for Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)</ept>","source":"[UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)"},{"pos":[5498,5653],"content":"<bpt id=\"p1\">[</bpt>Implementing the UI Automation GridItem Control Pattern<ept id=\"p1\">](../../../docs/framework/ui-automation/implementing-the-ui-automation-griditem-control-pattern.md)</ept>","source":"[Implementing the UI Automation GridItem Control Pattern](../../../docs/framework/ui-automation/implementing-the-ui-automation-griditem-control-pattern.md)"},{"pos":[5656,5755],"content":"<bpt id=\"p1\">[</bpt>UI Automation Tree Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</ept>","source":"[UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)"},{"pos":[5758,5859],"content":"<bpt id=\"p1\">[</bpt>Use Caching in UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)</ept>","source":"[Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)"}]}