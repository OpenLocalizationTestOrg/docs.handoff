{"content":"---\ntitle: \"IMetaDataEmit::GetSaveSize Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataEmit.GetSaveSize\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataEmit::GetSaveSize\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IMetaDataEmit::GetSaveSize method [.NET Framework metadata]\"\n  - \"GetSaveSize method [.NET Framework metadata]\"\nms.assetid: 8aea2e2c-23a3-4cda-9a06-e19f97383830\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 11\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# IMetaDataEmit::GetSaveSize Method\nGets the estimated binary size of the assembly and its metadata in the current scope.  \n  \n## Syntax  \n  \n```  \nHRESULT GetSaveSize (  \n    [in]  CorSaveSize fSave,  \n    [out] DWORD       *pdwSaveSize  \n);  \n```  \n  \n#### Parameters  \n `fSave`  \n [in] A value of the [CorSaveSize](../../../../docs/framework/unmanaged-api/metadata/corsavesize-enumeration.md) enumeration that specifies whether to get an accurate or approximate size. Only three values are valid: cssAccurate, cssQuick, and cssDiscardTransientCAs:  \n  \n-   cssAccurate returns the exact save size but takes longer to calculate.  \n  \n-   cssQuick returns a size, padded for safety, but takes less time to calculate.  \n  \n-   cssDiscardTransientCAs tells `GetSaveSize` that it can throw away discardable custom attributes.  \n  \n `pdwSaveSize`  \n [out] A pointer to the size that is required to save the file.  \n  \n## Remarks  \n `GetSaveSize` calculates the space required, in bytes, to save the assembly and all its metadata in the current scope. (A call to the [IMetaDataEmit::SaveToStream](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-savetostream-method.md) method would emit this number of bytes.)  \n  \n If the caller implements the [IMapToken](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md) interface (through [IMetaDataEmit::SetHandler](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md) or [IMetaDataEmit::Merge](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-merge-method.md)), `GetSaveSize` will perform two passes over the metadata to optimize and compress it. Otherwise, no optimizations are performed.  \n  \n If optimization is performed, the first pass simply sorts the metadata structures to tune the performance of import-time searches. This step typically results in moving records around, with the side effect that tokens retained by the tool for future reference are invalidated. The metadata does not inform the caller of these token changes until after the second pass, however. In the second pass, various optimizations are performed that are intended to reduce the overall size of the metadata, such as optimizing away (early binding) `mdTypeRef` and `mdMemberRef` tokens when the reference is to a type or member that is declared in the current metadata scope. In this pass, another round of token mapping occurs. After this pass, the metadata engine notifies the caller, through its `IMapToken` interface, of any changed token values.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** Cor.h  \n  \n **Library:** Used as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]  \n  \n## See Also  \n [IMetaDataEmit Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md)   \n [IMetaDataEmit2 Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)","nodes":[{"pos":[4,689],"embed":true,"restype":"x-metadata","content":"title: \"IMetaDataEmit::GetSaveSize Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataEmit.GetSaveSize\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataEmit::GetSaveSize\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IMetaDataEmit::GetSaveSize method [.NET Framework metadata]\"\n  - \"GetSaveSize method [.NET Framework metadata]\"\nms.assetid: 8aea2e2c-23a3-4cda-9a06-e19f97383830\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 11\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","nodes":[{"content":"IMetaDataEmit::GetSaveSize Method | Microsoft Docs","nodes":[{"pos":[0,50],"content":"IMetaDataEmit::GetSaveSize Method | Microsoft Docs","nodes":[{"content":"IMetaDataEmit::GetSaveSize Method | Microsoft Docs","pos":[0,50]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[696,729],"content":"IMetaDataEmit::GetSaveSize Method","linkify":"IMetaDataEmit::GetSaveSize Method","nodes":[{"content":"IMetaDataEmit::GetSaveSize Method","pos":[0,33]}]},{"content":"Gets the estimated binary size of the assembly and its metadata in the current scope.","pos":[730,815]},{"pos":[824,830],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[953,963],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A value of the <bpt id=\"p1\">[</bpt>CorSaveSize<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/corsavesize-enumeration.md)</ept> enumeration that specifies whether to get an accurate or approximate size.","pos":[978,1164],"source":"[in] A value of the [CorSaveSize](../../../../docs/framework/unmanaged-api/metadata/corsavesize-enumeration.md) enumeration that specifies whether to get an accurate or approximate size."},{"content":"Only three values are valid: cssAccurate, cssQuick, and cssDiscardTransientCAs:","pos":[1165,1244]},{"content":"cssAccurate returns the exact save size but takes longer to calculate.","pos":[1254,1324]},{"content":"cssQuick returns a size, padded for safety, but takes less time to calculate.","pos":[1334,1411]},{"pos":[1421,1517],"content":"cssDiscardTransientCAs tells <ph id=\"ph1\">`GetSaveSize`</ph> that it can throw away discardable custom attributes.","source":"cssDiscardTransientCAs tells `GetSaveSize` that it can throw away discardable custom attributes."},{"pos":[1524,1603],"content":"`pdwSaveSize`  \n[out] A pointer to the size that is required to save the file.","leadings":[""," "],"nodes":[{"content":"[out] A pointer to the size that is required to save the file.","pos":[16,78]}]},{"pos":[1612,1619],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`GetSaveSize`</ph> calculates the space required, in bytes, to save the assembly and all its metadata in the current scope.","pos":[1623,1741],"source":"`GetSaveSize` calculates the space required, in bytes, to save the assembly and all its metadata in the current scope."},{"content":"(A call to the <bpt id=\"p1\">[</bpt>IMetaDataEmit::SaveToStream<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-savetostream-method.md)</ept> method would emit this number of bytes.)","pos":[1742,1915],"source":" (A call to the [IMetaDataEmit::SaveToStream](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-savetostream-method.md) method would emit this number of bytes.)"},{"content":"If the caller implements the <bpt id=\"p1\">[</bpt>IMapToken<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md)</ept> interface (through <bpt id=\"p2\">[</bpt>IMetaDataEmit::SetHandler<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md)</ept> or <bpt id=\"p3\">[</bpt>IMetaDataEmit::Merge<ept id=\"p3\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-merge-method.md)</ept>), <ph id=\"ph1\">`GetSaveSize`</ph> will perform two passes over the metadata to optimize and compress it.","pos":[1922,2363],"source":"If the caller implements the [IMapToken](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md) interface (through [IMetaDataEmit::SetHandler](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md) or [IMetaDataEmit::Merge](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-merge-method.md)), `GetSaveSize` will perform two passes over the metadata to optimize and compress it."},{"content":"Otherwise, no optimizations are performed.","pos":[2364,2406]},{"content":"If optimization is performed, the first pass simply sorts the metadata structures to tune the performance of import-time searches.","pos":[2413,2543]},{"content":"This step typically results in moving records around, with the side effect that tokens retained by the tool for future reference are invalidated.","pos":[2544,2689]},{"content":"The metadata does not inform the caller of these token changes until after the second pass, however.","pos":[2690,2790]},{"content":"In the second pass, various optimizations are performed that are intended to reduce the overall size of the metadata, such as optimizing away (early binding) <ph id=\"ph1\">`mdTypeRef`</ph> and <ph id=\"ph2\">`mdMemberRef`</ph> tokens when the reference is to a type or member that is declared in the current metadata scope.","pos":[2791,3075],"source":" In the second pass, various optimizations are performed that are intended to reduce the overall size of the metadata, such as optimizing away (early binding) `mdTypeRef` and `mdMemberRef` tokens when the reference is to a type or member that is declared in the current metadata scope."},{"content":"In this pass, another round of token mapping occurs.","pos":[3076,3128]},{"content":"After this pass, the metadata engine notifies the caller, through its <ph id=\"ph1\">`IMapToken`</ph> interface, of any changed token values.","pos":[3129,3250],"source":" After this pass, the metadata engine notifies the caller, through its `IMapToken` interface, of any changed token values."},{"pos":[3259,3271],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3275,3379],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3386,3403],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> Cor.h","source":"**Header:** Cor.h"},{"pos":[3410,3456],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Used as a resource in MSCorEE.dll","source":"**Library:** Used as a resource in MSCorEE.dll"},{"pos":[3463,3571],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]"},{"pos":[3580,3588],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>IMetaDataEmit Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[3592,3696],"source":"[IMetaDataEmit Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>IMetaDataEmit2 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)</ept>","pos":[3700,3805],"source":"[IMetaDataEmit2 Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)"}]}