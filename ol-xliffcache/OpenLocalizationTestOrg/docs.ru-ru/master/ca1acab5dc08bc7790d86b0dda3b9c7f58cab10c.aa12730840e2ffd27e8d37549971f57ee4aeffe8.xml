{"content":"---\ntitle: \"Walkthrough: Embedding Types from Managed Assemblies in Visual Studio (C#)\"\nms.date: 07/20/2015\nms.assetid: 55ed13c9-c5bb-4bc2-bcd8-0587eb568864\n---\n\n# Walkthrough: Embedding Types from Managed Assemblies in Visual Studio (C#)\n\nIf you embed type information from a strong-named managed assembly, you can loosely couple types in an application to achieve version independence. That is, your program can be written to use types from multiple versions of a managed library without having to be recompiled for each version.\n\nType embedding is frequently used with COM interop, such as an application that uses automation objects from Microsoft Office. Embedding type information enables the same build of a program to work with different versions of Microsoft Office on different computers. However, you can also use type embedding with a fully managed solution.\n\nType information can be embedded from an assembly that has the following characteristics:\n\n- The assembly exposes at least one public interface.\n\n- The embedded interfaces are annotated with a `ComImport` attribute and a `Guid` attribute (and a unique GUID).\n\n- The assembly is annotated with the `ImportedFromTypeLib` attribute or the `PrimaryInteropAssembly` attribute, and an assembly-level `Guid` attribute. (By default, Visual C# project templates include an assembly-level `Guid` attribute.)\n\nAfter you have specified the public interfaces that can be embedded, you can create runtime classes that implement those interfaces. A client program can then embed the type information for those interfaces at design time by referencing the assembly that contains the public interfaces and setting the `Embed Interop Types` property of the reference to `True`. This is equivalent to using the command line compiler and referencing the assembly by using the `/link` compiler option. The client program can then load instances of your runtime objects typed as those interfaces. If you create a new version of your strong-named runtime assembly, the client program does not have to be recompiled with the updated runtime assembly. Instead, the client program continues to use whichever version of the runtime assembly is available to it, using the embedded type information for the public interfaces.\n\nBecause the primary function of type embedding is to support embedding of type information from COM interop assemblies, the following limitations apply when you embed type information in a fully managed solution:\n\n- Only attributes specific to COM interop are embedded; other attributes are ignored.\n\n- If a type uses generic parameters and the type of the generic parameter is an embedded type, that type cannot be used across an assembly boundary. Examples of crossing an assembly boundary include calling a method from another assembly or a deriving a type from a type defined in another assembly.\n\n- Constants are not embedded.\n\n- The <xref:System.Collections.Generic.Dictionary%602?displayProperty=nameWithType> class does not support an embedded type as a key. You can implement your own dictionary type to support an embedded type as a key.\n\nIn this walkthrough, you will do the following:\n\n- Create a strong-named assembly that has a public interface that contains type information that can be embedded.\n\n- Create a strong-named runtime assembly that implements that public interface.\n\n- Create a client program that embeds the type information from the public interface and creates an instance of the class from the runtime assembly.\n\n- Modify and rebuild the runtime assembly.\n\n- Run the client program to see that the new version of the runtime assembly is being used without having to recompile the client program.\n\n[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]\n\n## Creating an Interface\n\n#### To create the type equivalence interface project\n\n1. In Visual Studio, on the **File** menu, choose **New** and then click **Project**.\n\n2. In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected. Select **Class Library** in the **Templates** pane. In the **Name** box, type `TypeEquivalenceInterface`, and then click **OK**. The new project is created.\n\n3. In **Solution Explorer**, right-click the Class1.cs file and click **Rename**. Rename the file to `ISampleInterface.cs` and press ENTER. Renaming the file will also rename the class to `ISampleInterface`. This class will represent the public interface for the class.\n\n4. Right-click the TypeEquivalenceInterface project and click **Properties**. Click the **Build** tab. Set the output path to a valid location on your development computer, such as `C:\\TypeEquivalenceSample`. This location will also be used in a later step in this walkthrough.\n\n5. While still editing the project properties, click the **Signing** tab. Select the **Sign the assembly** option. In the **Choose a strong name key file** list, click **\\<New...>**. In the **Key file name** box, type `key.snk`. Clear the **Protect my key file with a password** check box. Click **OK**.\n\n6. Open the ISampleInterface.cs file. Add the following code to the ISampleInterface class file to create the ISampleInterface interface.\n\n    ```csharp\n    using System;\n    using System.Runtime.InteropServices;\n\n    namespace TypeEquivalenceInterface\n    {\n        [ComImport]\n        [Guid(\"8DA56996-A151-4136-B474-32784559F6DF\")]\n        public interface ISampleInterface\n        {\n            void GetUserInput();\n            string UserInput { get; }\n        }\n    }\n    ```\n\n7. On the **Tools** menu, click **Create Guid**. In the **Create GUID** dialog box, click **Registry Format** and then click **Copy**. Click **Exit**.\n\n8. In the `Guid` attribute, delete the sample GUID and paste in the GUID that you copied from the **Create GUID** dialog box. Remove the braces ({}) from the copied GUID.\n\n9. In **Solution Explorer**, expand the **Properties** folder. Double-click the AssemblyInfo.cs file. Add the following attribute to the file.\n\n    ```csharp\n    [assembly: ImportedFromTypeLib(\"\")]\n    ```\n\n     Save the file.\n\n10. Save the project.\n\n11. Right-click the TypeEquivalenceInterface project and click **Build**. The class library .dll file is compiled and saved to the specified build output path (for example, C:\\TypeEquivalenceSample).\n\n## Creating a Runtime Class\n\n#### To create the type equivalence runtime project\n\n1. In Visual Studio, on the **File** menu, point to **New** and then click **Project**.\n\n2. In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected. Select **Class Library** in the **Templates** pane. In the **Name** box, type `TypeEquivalenceRuntime`, and then click **OK**. The new project is created.\n\n3. In **Solution Explorer**, right-click the Class1.cs file and click **Rename**. Rename the file to `SampleClass.cs` and press ENTER. Renaming the file also renames the class to `SampleClass`. This class will implement the `ISampleInterface` interface.\n\n4. Right-click the TypeEquivalenceRuntime project and click **Properties**. Click the **Build** tab. Set the output path to the same location you used in the TypeEquivalenceInterface project, for example, `C:\\TypeEquivalenceSample`.\n\n5. While still editing the project properties, click the **Signing** tab. Select the **Sign the assembly** option. In the **Choose a strong name key file** list, click **\\<New...>**. In the **Key file name** box, type `key.snk`. Clear the **Protect my key file with a password** check box. Click **OK**.\n\n6. Right-click the TypeEquivalenceRuntime project and click **Add Reference**. Click the **Browse** tab and browse to the output path folder. Select the TypeEquivalenceInterface.dll file and click **OK**.\n\n7. In **Solution Explorer**, expand the **References** folder. Select the TypeEquivalenceInterface reference. In the Properties window for the TypeEquivalenceInterface reference, set the **Specific Version** property to **False**.\n\n8. Add the following code to the SampleClass class file to create the SampleClass class.\n\n    ```csharp\n    using System;\n    using System.Collections.Generic;\n    using System.Linq;\n    using System.Text;\n    using TypeEquivalenceInterface;\n\n    namespace TypeEquivalenceRuntime\n    {\n        public class SampleClass : ISampleInterface\n        {\n            private string p_UserInput;\n            public string UserInput { get { return p_UserInput; } }\n\n            public void GetUserInput()\n            {\n                Console.WriteLine(\"Please enter a value:\");\n                p_UserInput = Console.ReadLine();\n            }\n        }\n    }\n    ```\n\n9. Save the project.\n\n10. Right-click the TypeEquivalenceRuntime project and click **Build**. The class library .dll file is compiled and saved to the specified build output path (for example, C:\\TypeEquivalenceSample).\n\n## Creating a Client Project\n\n#### To create the type equivalence client project\n\n1. In Visual Studio, on the **File** menu, point to **New** and then click **Project**.\n\n2. In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected. Select **Console Application** in the **Templates** pane. In the **Name** box, type `TypeEquivalenceClient`, and then click **OK**. The new project is created.\n\n3. Right-click the TypeEquivalenceClient project and click **Properties**. Click the **Build** tab. Set the output path to the same location you used in the TypeEquivalenceInterface project, for example, `C:\\TypeEquivalenceSample`.\n\n4. Right-click the TypeEquivalenceClient project and click **Add Reference**. Click the **Browse** tab and browse to the output path folder. Select the TypeEquivalenceInterface.dll file (not the TypeEquivalenceRuntime.dll) and click **OK**.\n\n5. In **Solution Explorer**, expand the **References** folder. Select the TypeEquivalenceInterface reference. In the Properties window for the TypeEquivalenceInterface reference, set the **Embed Interop Types** property to **True**.\n\n6. Add the following code to the Program.cs file to create the client program.\n\n    ```csharp\n    using System;\n    using System.Collections.Generic;\n    using System.Linq;\n    using System.Text;\n    using TypeEquivalenceInterface;\n    using System.Reflection;\n\n    namespace TypeEquivalenceClient\n    {\n        class Program\n        {\n            static void Main(string[] args)\n            {\n                Assembly sampleAssembly = Assembly.Load(\"TypeEquivalenceRuntime\");\n                ISampleInterface sampleClass =\n                    (ISampleInterface)sampleAssembly.CreateInstance(\"TypeEquivalenceRuntime.SampleClass\");\n                sampleClass.GetUserInput();\n                Console.WriteLine(sampleClass.UserInput);\n                Console.WriteLine(sampleAssembly.GetName().Version.ToString());\n                Console.ReadLine();\n            }\n        }\n    }\n    ```\n\n7. Press CTRL+F5 to build and run the program.\n\n## Modifying the Interface\n\n#### To modify the interface\n\n1. In Visual Studio, on the **File** menu, point to **Open**, and then click **Project/Solution**.\n\n2. In the **Open Project** dialog box, right-click the TypeEquivalenceInterface project, and then click **Properties**. Click the **Application** tab. Click the **Assembly Information** button. Change the **Assembly Version** and **File Version** values to `2.0.0.0`.\n\n3. Open the SampleInterface.cs file. Add the following line of code to the ISampleInterface interface.\n\n    ```csharp\n    DateTime GetDate();\n    ```\n\n    Save the file.\n\n4. Save the project.\n\n5. Right-click the TypeEquivalenceInterface project and click **Build**. A new version of the class library .dll file is compiled and saved in the specified build output path (for example, C:\\TypeEquivalenceSample).\n\n## Modifying the Runtime Class\n\n#### To modify the runtime class\n\n1. In Visual Studio, on the **File** menu, point to **Open**, and then click **Project/Solution**.\n\n2. In the **Open Project** dialog box, right-click the TypeEquivalenceRuntime project and click **Properties**. Click the **Application** tab. Click the **Assembly Information** button. Change the **Assembly Version** and **File Version** values to `2.0.0.0`.\n\n3. Open the SampleClass.cs file. Add the following lines of code to the SampleClass class.\n\n    ```csharp\n    public DateTime GetDate()\n    {\n        return DateTime.Now;\n    }\n    ```\n\n    Save the file.\n\n4. Save the project.\n\n5. Right-click the TypeEquivalenceRuntime project and click **Build**. An updated version of the class library .dll file is compiled and saved in the previously specified build output path (for example, C:\\TypeEquivalenceSample).\n\n6. In File Explorer, open the output path folder (for example, C:\\TypeEquivalenceSample). Double-click the TypeEquivalenceClient.exe to run the program. The program will reflect the new version of the TypeEquivalenceRuntime assembly without having been recompiled.\n\n## See also\n\n- [/link (C# Compiler Options)](../../../../csharp/language-reference/compiler-options/link-compiler-option.md)\n- [C# Programming Guide](../../../../csharp/programming-guide/index.md)\n- [Programming with Assemblies](../../../../framework/app-domains/programming-with-assemblies.md)\n- [Assemblies in .NET](../../../../standard/assembly/index.md)\n","nodes":[{"pos":[4,156],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Embedding Types from Managed Assemblies in Visual Studio (C#)\"\nms.date: 07/20/2015\nms.assetid: 55ed13c9-c5bb-4bc2-bcd8-0587eb568864","nodes":[{"content":"Walkthrough: Embedding Types from Managed Assemblies in Visual Studio (C#)","nodes":[{"pos":[0,74],"content":"Walkthrough: Embedding Types from Managed Assemblies in Visual Studio (C#)","nodes":[{"content":"Walkthrough: Embedding Types from Managed Assemblies in Visual Studio (C#)","pos":[0,74]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[164,238],"content":"Walkthrough: Embedding Types from Managed Assemblies in Visual Studio (C#)","linkify":"Walkthrough: Embedding Types from Managed Assemblies in Visual Studio (C#)","nodes":[{"content":"Walkthrough: Embedding Types from Managed Assemblies in Visual Studio (C#)","pos":[0,74]}]},{"content":"If you embed type information from a strong-named managed assembly, you can loosely couple types in an application to achieve version independence.","pos":[240,387]},{"content":"That is, your program can be written to use types from multiple versions of a managed library without having to be recompiled for each version.","pos":[388,531]},{"content":"Type embedding is frequently used with COM interop, such as an application that uses automation objects from Microsoft Office.","pos":[533,659]},{"content":"Embedding type information enables the same build of a program to work with different versions of Microsoft Office on different computers.","pos":[660,798]},{"content":"However, you can also use type embedding with a fully managed solution.","pos":[799,870]},{"content":"Type information can be embedded from an assembly that has the following characteristics:","pos":[872,961]},{"content":"The assembly exposes at least one public interface.","pos":[965,1016]},{"pos":[1020,1130],"content":"The embedded interfaces are annotated with a <ph id=\"ph1\">`ComImport`</ph> attribute and a <ph id=\"ph2\">`Guid`</ph> attribute (and a unique GUID).","source":"The embedded interfaces are annotated with a `ComImport` attribute and a `Guid` attribute (and a unique GUID)."},{"content":"The assembly is annotated with the <ph id=\"ph1\">`ImportedFromTypeLib`</ph> attribute or the <ph id=\"ph2\">`PrimaryInteropAssembly`</ph> attribute, and an assembly-level <ph id=\"ph3\">`Guid`</ph> attribute.","pos":[1134,1283],"source":"The assembly is annotated with the `ImportedFromTypeLib` attribute or the `PrimaryInteropAssembly` attribute, and an assembly-level `Guid` attribute."},{"content":"(By default, Visual C# project templates include an assembly-level <ph id=\"ph1\">`Guid`</ph> attribute.)","pos":[1284,1369],"source":" (By default, Visual C# project templates include an assembly-level `Guid` attribute.)"},{"content":"After you have specified the public interfaces that can be embedded, you can create runtime classes that implement those interfaces.","pos":[1371,1503]},{"content":"A client program can then embed the type information for those interfaces at design time by referencing the assembly that contains the public interfaces and setting the <ph id=\"ph1\">`Embed Interop Types`</ph> property of the reference to <ph id=\"ph2\">`True`</ph>.","pos":[1504,1731],"source":" A client program can then embed the type information for those interfaces at design time by referencing the assembly that contains the public interfaces and setting the `Embed Interop Types` property of the reference to `True`."},{"content":"This is equivalent to using the command line compiler and referencing the assembly by using the <ph id=\"ph1\">`/link`</ph> compiler option.","pos":[1732,1852],"source":" This is equivalent to using the command line compiler and referencing the assembly by using the `/link` compiler option."},{"content":"The client program can then load instances of your runtime objects typed as those interfaces.","pos":[1853,1946]},{"content":"If you create a new version of your strong-named runtime assembly, the client program does not have to be recompiled with the updated runtime assembly.","pos":[1947,2098]},{"content":"Instead, the client program continues to use whichever version of the runtime assembly is available to it, using the embedded type information for the public interfaces.","pos":[2099,2268]},{"content":"Because the primary function of type embedding is to support embedding of type information from COM interop assemblies, the following limitations apply when you embed type information in a fully managed solution:","pos":[2270,2482]},{"content":"Only attributes specific to COM interop are embedded; other attributes are ignored.","pos":[2486,2569]},{"content":"If a type uses generic parameters and the type of the generic parameter is an embedded type, that type cannot be used across an assembly boundary.","pos":[2573,2719]},{"content":"Examples of crossing an assembly boundary include calling a method from another assembly or a deriving a type from a type defined in another assembly.","pos":[2720,2870]},{"content":"Constants are not embedded.","pos":[2874,2901]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Collections.Generic.Dictionary%602?displayProperty=nameWithType&gt;</ph> class does not support an embedded type as a key.","pos":[2905,3036],"source":"The <xref:System.Collections.Generic.Dictionary%602?displayProperty=nameWithType> class does not support an embedded type as a key."},{"content":"You can implement your own dictionary type to support an embedded type as a key.","pos":[3037,3117]},{"content":"In this walkthrough, you will do the following:","pos":[3119,3166]},{"content":"Create a strong-named assembly that has a public interface that contains type information that can be embedded.","pos":[3170,3281]},{"content":"Create a strong-named runtime assembly that implements that public interface.","pos":[3285,3362]},{"content":"Create a client program that embeds the type information from the public interface and creates an instance of the class from the runtime assembly.","pos":[3366,3512]},{"content":"Modify and rebuild the runtime assembly.","pos":[3516,3556]},{"content":"Run the client program to see that the new version of the runtime assembly is being used without having to recompile the client program.","pos":[3560,3696]},{"pos":[3776,3797],"content":"Creating an Interface","linkify":"Creating an Interface","nodes":[{"content":"Creating an Interface","pos":[0,21]}]},{"pos":[3804,3852],"content":"To create the type equivalence interface project","linkify":"To create the type equivalence interface project","nodes":[{"content":"To create the type equivalence interface project","pos":[0,48]}]},{"pos":[3857,3939],"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"In Visual Studio, on the **File** menu, choose **New** and then click **Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box, in the <bpt id=\"p2\">**</bpt>Project Types<ept id=\"p2\">**</ept> pane, make sure that <bpt id=\"p3\">**</bpt>Windows<ept id=\"p3\">**</ept> is selected.","pos":[3944,4049],"source":"In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected."},{"content":"Select <bpt id=\"p1\">**</bpt>Class Library<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Templates<ept id=\"p2\">**</ept> pane.","pos":[4050,4101],"source":" Select **Class Library** in the **Templates** pane."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`TypeEquivalenceInterface`</ph>, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[4102,4178],"source":" In the **Name** box, type `TypeEquivalenceInterface`, and then click **OK**."},{"content":"The new project is created.","pos":[4179,4206]},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the Class1.cs file and click <bpt id=\"p2\">**</bpt>Rename<ept id=\"p2\">**</ept>.","pos":[4211,4289],"source":"In **Solution Explorer**, right-click the Class1.cs file and click **Rename**."},{"content":"Rename the file to <ph id=\"ph1\">`ISampleInterface.cs`</ph> and press ENTER.","pos":[4290,4347],"source":" Rename the file to `ISampleInterface.cs` and press ENTER."},{"content":"Renaming the file will also rename the class to <ph id=\"ph1\">`ISampleInterface`</ph>.","pos":[4348,4415],"source":" Renaming the file will also rename the class to `ISampleInterface`."},{"content":"This class will represent the public interface for the class.","pos":[4416,4477]},{"content":"Right-click the TypeEquivalenceInterface project and click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","pos":[4482,4556],"source":"Right-click the TypeEquivalenceInterface project and click **Properties**."},{"content":"Click the <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> tab. Set the output path to a valid location on your development computer, such as <ph id=\"ph1\">`C:\\TypeEquivalenceSample`</ph>.","pos":[4557,4687],"source":" Click the **Build** tab. Set the output path to a valid location on your development computer, such as `C:\\TypeEquivalenceSample`."},{"content":"This location will also be used in a later step in this walkthrough.","pos":[4688,4756]},{"content":"While still editing the project properties, click the <bpt id=\"p1\">**</bpt>Signing<ept id=\"p1\">**</ept> tab. Select the <bpt id=\"p2\">**</bpt>Sign the assembly<ept id=\"p2\">**</ept> option.","pos":[4761,4872],"source":"While still editing the project properties, click the **Signing** tab. Select the **Sign the assembly** option."},{"content":"In the <bpt id=\"p1\">**</bpt>Choose a strong name key file<ept id=\"p1\">**</ept> list, click <bpt id=\"p2\">**</bpt><ph id=\"ph1\">\\&lt;</ph>New...&gt;<ept id=\"p2\">**</ept>.","pos":[4873,4940],"source":" In the **Choose a strong name key file** list, click **\\<New...>**."},{"content":"In the <bpt id=\"p1\">**</bpt>Key file name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`key.snk`</ph>.","pos":[4941,4986],"source":" In the **Key file name** box, type `key.snk`."},{"content":"Clear the <bpt id=\"p1\">**</bpt>Protect my key file with a password<ept id=\"p1\">**</ept> check box.","pos":[4987,5047],"source":" Clear the **Protect my key file with a password** check box."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[5048,5061],"source":" Click **OK**."},{"content":"Open the ISampleInterface.cs file.","pos":[5066,5100]},{"content":"Add the following code to the ISampleInterface class file to create the ISampleInterface interface.","pos":[5101,5200]},{"content":"On the <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Create Guid<ept id=\"p2\">**</ept>.","pos":[5548,5593],"source":"On the **Tools** menu, click **Create Guid**."},{"content":"In the <bpt id=\"p1\">**</bpt>Create GUID<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Registry Format<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Copy<ept id=\"p3\">**</ept>.","pos":[5594,5679],"source":" In the **Create GUID** dialog box, click **Registry Format** and then click **Copy**."},{"content":"Click <bpt id=\"p1\">**</bpt>Exit<ept id=\"p1\">**</ept>.","pos":[5680,5695],"source":" Click **Exit**."},{"content":"In the <ph id=\"ph1\">`Guid`</ph> attribute, delete the sample GUID and paste in the GUID that you copied from the <bpt id=\"p1\">**</bpt>Create GUID<ept id=\"p1\">**</ept> dialog box.","pos":[5700,5822],"source":"In the `Guid` attribute, delete the sample GUID and paste in the GUID that you copied from the **Create GUID** dialog box."},{"content":"Remove the braces (<ph id=\"ph1\">{}</ph>) from the copied GUID.","pos":[5823,5867],"source":" Remove the braces ({}) from the copied GUID."},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, expand the <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> folder.","pos":[5872,5931],"source":"In **Solution Explorer**, expand the **Properties** folder."},{"content":"Double-click the AssemblyInfo.cs file.","pos":[5932,5970]},{"content":"Add the following attribute to the file.","pos":[5971,6011]},{"content":"Save the file.","pos":[6081,6095]},{"content":"Save the project.","pos":[6101,6118]},{"content":"Right-click the TypeEquivalenceInterface project and click <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept>.","pos":[6124,6193],"source":"Right-click the TypeEquivalenceInterface project and click **Build**."},{"content":"The class library .dll file is compiled and saved to the specified build output path (for example, C:\\TypeEquivalenceSample).","pos":[6194,6319]},{"pos":[6324,6348],"content":"Creating a Runtime Class","linkify":"Creating a Runtime Class","nodes":[{"content":"Creating a Runtime Class","pos":[0,24]}]},{"pos":[6355,6401],"content":"To create the type equivalence runtime project","linkify":"To create the type equivalence runtime project","nodes":[{"content":"To create the type equivalence runtime project","pos":[0,46]}]},{"pos":[6406,6490],"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"In Visual Studio, on the **File** menu, point to **New** and then click **Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box, in the <bpt id=\"p2\">**</bpt>Project Types<ept id=\"p2\">**</ept> pane, make sure that <bpt id=\"p3\">**</bpt>Windows<ept id=\"p3\">**</ept> is selected.","pos":[6495,6600],"source":"In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected."},{"content":"Select <bpt id=\"p1\">**</bpt>Class Library<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Templates<ept id=\"p2\">**</ept> pane.","pos":[6601,6652],"source":" Select **Class Library** in the **Templates** pane."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`TypeEquivalenceRuntime`</ph>, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[6653,6727],"source":" In the **Name** box, type `TypeEquivalenceRuntime`, and then click **OK**."},{"content":"The new project is created.","pos":[6728,6755]},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the Class1.cs file and click <bpt id=\"p2\">**</bpt>Rename<ept id=\"p2\">**</ept>.","pos":[6760,6838],"source":"In **Solution Explorer**, right-click the Class1.cs file and click **Rename**."},{"content":"Rename the file to <ph id=\"ph1\">`SampleClass.cs`</ph> and press ENTER.","pos":[6839,6891],"source":" Rename the file to `SampleClass.cs` and press ENTER."},{"content":"Renaming the file also renames the class to <ph id=\"ph1\">`SampleClass`</ph>.","pos":[6892,6950],"source":" Renaming the file also renames the class to `SampleClass`."},{"content":"This class will implement the <ph id=\"ph1\">`ISampleInterface`</ph> interface.","pos":[6951,7010],"source":" This class will implement the `ISampleInterface` interface."},{"content":"Right-click the TypeEquivalenceRuntime project and click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","pos":[7015,7087],"source":"Right-click the TypeEquivalenceRuntime project and click **Properties**."},{"content":"Click the <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> tab. Set the output path to the same location you used in the TypeEquivalenceInterface project, for example, <ph id=\"ph1\">`C:\\TypeEquivalenceSample`</ph>.","pos":[7088,7244],"source":" Click the **Build** tab. Set the output path to the same location you used in the TypeEquivalenceInterface project, for example, `C:\\TypeEquivalenceSample`."},{"content":"While still editing the project properties, click the <bpt id=\"p1\">**</bpt>Signing<ept id=\"p1\">**</ept> tab. Select the <bpt id=\"p2\">**</bpt>Sign the assembly<ept id=\"p2\">**</ept> option.","pos":[7249,7360],"source":"While still editing the project properties, click the **Signing** tab. Select the **Sign the assembly** option."},{"content":"In the <bpt id=\"p1\">**</bpt>Choose a strong name key file<ept id=\"p1\">**</ept> list, click <bpt id=\"p2\">**</bpt><ph id=\"ph1\">\\&lt;</ph>New...&gt;<ept id=\"p2\">**</ept>.","pos":[7361,7428],"source":" In the **Choose a strong name key file** list, click **\\<New...>**."},{"content":"In the <bpt id=\"p1\">**</bpt>Key file name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`key.snk`</ph>.","pos":[7429,7474],"source":" In the **Key file name** box, type `key.snk`."},{"content":"Clear the <bpt id=\"p1\">**</bpt>Protect my key file with a password<ept id=\"p1\">**</ept> check box.","pos":[7475,7535],"source":" Clear the **Protect my key file with a password** check box."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[7536,7549],"source":" Click **OK**."},{"content":"Right-click the TypeEquivalenceRuntime project and click <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept>.","pos":[7554,7629],"source":"Right-click the TypeEquivalenceRuntime project and click **Add Reference**."},{"content":"Click the <bpt id=\"p1\">**</bpt>Browse<ept id=\"p1\">**</ept> tab and browse to the output path folder.","pos":[7630,7692],"source":" Click the **Browse** tab and browse to the output path folder."},{"content":"Select the TypeEquivalenceInterface.dll file and click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[7693,7755],"source":" Select the TypeEquivalenceInterface.dll file and click **OK**."},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, expand the <bpt id=\"p2\">**</bpt>References<ept id=\"p2\">**</ept> folder.","pos":[7760,7819],"source":"In **Solution Explorer**, expand the **References** folder."},{"content":"Select the TypeEquivalenceInterface reference.","pos":[7820,7866]},{"content":"In the Properties window for the TypeEquivalenceInterface reference, set the <bpt id=\"p1\">**</bpt>Specific Version<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>False<ept id=\"p2\">**</ept>.","pos":[7867,7987],"source":" In the Properties window for the TypeEquivalenceInterface reference, set the **Specific Version** property to **False**."},{"content":"Add the following code to the SampleClass class file to create the SampleClass class.","pos":[7992,8077]},{"content":"Save the project.","pos":[8651,8668]},{"content":"Right-click the TypeEquivalenceRuntime project and click <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept>.","pos":[8674,8741],"source":"Right-click the TypeEquivalenceRuntime project and click **Build**."},{"content":"The class library .dll file is compiled and saved to the specified build output path (for example, C:\\TypeEquivalenceSample).","pos":[8742,8867]},{"pos":[8872,8897],"content":"Creating a Client Project","linkify":"Creating a Client Project","nodes":[{"content":"Creating a Client Project","pos":[0,25]}]},{"pos":[8904,8949],"content":"To create the type equivalence client project","linkify":"To create the type equivalence client project","nodes":[{"content":"To create the type equivalence client project","pos":[0,45]}]},{"pos":[8954,9038],"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"In Visual Studio, on the **File** menu, point to **New** and then click **Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box, in the <bpt id=\"p2\">**</bpt>Project Types<ept id=\"p2\">**</ept> pane, make sure that <bpt id=\"p3\">**</bpt>Windows<ept id=\"p3\">**</ept> is selected.","pos":[9043,9148],"source":"In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected."},{"content":"Select <bpt id=\"p1\">**</bpt>Console Application<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Templates<ept id=\"p2\">**</ept> pane.","pos":[9149,9206],"source":" Select **Console Application** in the **Templates** pane."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`TypeEquivalenceClient`</ph>, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[9207,9280],"source":" In the **Name** box, type `TypeEquivalenceClient`, and then click **OK**."},{"content":"The new project is created.","pos":[9281,9308]},{"content":"Right-click the TypeEquivalenceClient project and click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","pos":[9313,9384],"source":"Right-click the TypeEquivalenceClient project and click **Properties**."},{"content":"Click the <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> tab. Set the output path to the same location you used in the TypeEquivalenceInterface project, for example, <ph id=\"ph1\">`C:\\TypeEquivalenceSample`</ph>.","pos":[9385,9541],"source":" Click the **Build** tab. Set the output path to the same location you used in the TypeEquivalenceInterface project, for example, `C:\\TypeEquivalenceSample`."},{"content":"Right-click the TypeEquivalenceClient project and click <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept>.","pos":[9546,9620],"source":"Right-click the TypeEquivalenceClient project and click **Add Reference**."},{"content":"Click the <bpt id=\"p1\">**</bpt>Browse<ept id=\"p1\">**</ept> tab and browse to the output path folder.","pos":[9621,9683],"source":" Click the **Browse** tab and browse to the output path folder."},{"content":"Select the TypeEquivalenceInterface.dll file (not the TypeEquivalenceRuntime.dll) and click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[9684,9783],"source":" Select the TypeEquivalenceInterface.dll file (not the TypeEquivalenceRuntime.dll) and click **OK**."},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, expand the <bpt id=\"p2\">**</bpt>References<ept id=\"p2\">**</ept> folder.","pos":[9788,9847],"source":"In **Solution Explorer**, expand the **References** folder."},{"content":"Select the TypeEquivalenceInterface reference.","pos":[9848,9894]},{"content":"In the Properties window for the TypeEquivalenceInterface reference, set the <bpt id=\"p1\">**</bpt>Embed Interop Types<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>True<ept id=\"p2\">**</ept>.","pos":[9895,10017],"source":" In the Properties window for the TypeEquivalenceInterface reference, set the **Embed Interop Types** property to **True**."},{"content":"Add the following code to the Program.cs file to create the client program.","pos":[10022,10097]},{"content":"Press CTRL+F5 to build and run the program.","pos":[10910,10953]},{"pos":[10958,10981],"content":"Modifying the Interface","linkify":"Modifying the Interface","nodes":[{"content":"Modifying the Interface","pos":[0,23]}]},{"pos":[10988,11011],"content":"To modify the interface","linkify":"To modify the interface","nodes":[{"content":"To modify the interface","pos":[0,23]}]},{"pos":[11016,11111],"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Project/Solution<ept id=\"p3\">**</ept>.","source":"In Visual Studio, on the **File** menu, point to **Open**, and then click **Project/Solution**."},{"content":"In the <bpt id=\"p1\">**</bpt>Open Project<ept id=\"p1\">**</ept> dialog box, right-click the TypeEquivalenceInterface project, and then click <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","pos":[11116,11232],"source":"In the **Open Project** dialog box, right-click the TypeEquivalenceInterface project, and then click **Properties**."},{"content":"Click the <bpt id=\"p1\">**</bpt>Application<ept id=\"p1\">**</ept> tab. Click the <bpt id=\"p2\">**</bpt>Assembly Information<ept id=\"p2\">**</ept> button.","pos":[11233,11306],"source":" Click the **Application** tab. Click the **Assembly Information** button."},{"content":"Change the <bpt id=\"p1\">**</bpt>Assembly Version<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>File Version<ept id=\"p2\">**</ept> values to <ph id=\"ph1\">`2.0.0.0`</ph>.","pos":[11307,11380],"source":" Change the **Assembly Version** and **File Version** values to `2.0.0.0`."},{"content":"Open the SampleInterface.cs file.","pos":[11385,11418]},{"content":"Add the following line of code to the ISampleInterface interface.","pos":[11419,11484]},{"content":"Save the file.","pos":[11537,11551]},{"content":"Save the project.","pos":[11556,11573]},{"content":"Right-click the TypeEquivalenceInterface project and click <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept>.","pos":[11578,11647],"source":"Right-click the TypeEquivalenceInterface project and click **Build**."},{"content":"A new version of the class library .dll file is compiled and saved in the specified build output path (for example, C:\\TypeEquivalenceSample).","pos":[11648,11790]},{"pos":[11795,11822],"content":"Modifying the Runtime Class","linkify":"Modifying the Runtime Class","nodes":[{"content":"Modifying the Runtime Class","pos":[0,27]}]},{"pos":[11829,11856],"content":"To modify the runtime class","linkify":"To modify the runtime class","nodes":[{"content":"To modify the runtime class","pos":[0,27]}]},{"pos":[11861,11956],"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Project/Solution<ept id=\"p3\">**</ept>.","source":"In Visual Studio, on the **File** menu, point to **Open**, and then click **Project/Solution**."},{"content":"In the <bpt id=\"p1\">**</bpt>Open Project<ept id=\"p1\">**</ept> dialog box, right-click the TypeEquivalenceRuntime project and click <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","pos":[11961,12069],"source":"In the **Open Project** dialog box, right-click the TypeEquivalenceRuntime project and click **Properties**."},{"content":"Click the <bpt id=\"p1\">**</bpt>Application<ept id=\"p1\">**</ept> tab. Click the <bpt id=\"p2\">**</bpt>Assembly Information<ept id=\"p2\">**</ept> button.","pos":[12070,12143],"source":" Click the **Application** tab. Click the **Assembly Information** button."},{"content":"Change the <bpt id=\"p1\">**</bpt>Assembly Version<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>File Version<ept id=\"p2\">**</ept> values to <ph id=\"ph1\">`2.0.0.0`</ph>.","pos":[12144,12217],"source":" Change the **Assembly Version** and **File Version** values to `2.0.0.0`."},{"content":"Open the SampleClass.cs file.","pos":[12222,12251]},{"content":"Add the following lines of code to the SampleClass class.","pos":[12252,12309]},{"content":"Save the file.","pos":[12409,12423]},{"content":"Save the project.","pos":[12428,12445]},{"content":"Right-click the TypeEquivalenceRuntime project and click <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept>.","pos":[12450,12517],"source":"Right-click the TypeEquivalenceRuntime project and click **Build**."},{"content":"An updated version of the class library .dll file is compiled and saved in the previously specified build output path (for example, C:\\TypeEquivalenceSample).","pos":[12518,12676]},{"content":"In File Explorer, open the output path folder (for example, C:\\TypeEquivalenceSample).","pos":[12681,12767]},{"content":"Double-click the TypeEquivalenceClient.exe to run the program.","pos":[12768,12830]},{"content":"The program will reflect the new version of the TypeEquivalenceRuntime assembly without having been recompiled.","pos":[12831,12942]},{"pos":[12947,12955],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[12959,13068],"content":"<bpt id=\"p1\">[</bpt>/link (C# Compiler Options)<ept id=\"p1\">](../../../../csharp/language-reference/compiler-options/link-compiler-option.md)</ept>","source":"[/link (C# Compiler Options)](../../../../csharp/language-reference/compiler-options/link-compiler-option.md)"},{"pos":[13071,13140],"content":"<bpt id=\"p1\">[</bpt>C# Programming Guide<ept id=\"p1\">](../../../../csharp/programming-guide/index.md)</ept>","source":"[C# Programming Guide](../../../../csharp/programming-guide/index.md)"},{"pos":[13143,13238],"content":"<bpt id=\"p1\">[</bpt>Programming with Assemblies<ept id=\"p1\">](../../../../framework/app-domains/programming-with-assemblies.md)</ept>","source":"[Programming with Assemblies](../../../../framework/app-domains/programming-with-assemblies.md)"},{"pos":[13241,13301],"content":"<bpt id=\"p1\">[</bpt>Assemblies in .NET<ept id=\"p1\">](../../../../standard/assembly/index.md)</ept>","source":"[Assemblies in .NET](../../../../standard/assembly/index.md)"}]}