{"content":"---\ntitle: \"How to: Split a File Into Many Files by Using Groups (LINQ) (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: 5e8b2a2b-0b1d-4933-8a2b-03e91dfaf77f\ncaps.latest.revision: 3\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# How to: Split a File Into Many Files by Using Groups (LINQ) (Visual Basic)\nThis example shows one way to merge the contents of two files and then create a set of new files that organize the data in a new way.  \n  \n### To create the data files  \n  \n1.  Copy these names into a text file that is named names1.txt and save it in your project folder:  \n  \n    ```  \n    Bankov, Peter  \n    Holm, Michael  \n    Garcia, Hugo  \n    Potra, Cristina  \n    Noriega, Fabricio  \n    Aw, Kam Foo  \n    Beebe, Ann  \n    Toyoshima, Tim  \n    Guy, Wey Yuan  \n    Garcia, Debra  \n    ```  \n  \n2.  Copy these names into a text file that is named names2.txt and save it in your project folder: Note that the two files have some names in common.  \n  \n    ```  \n    Liu, Jinghao  \n    Bankov, Peter  \n    Holm, Michael  \n    Garcia, Hugo  \n    Beebe, Ann  \n    Gilchrist, Beth  \n    Myrcha, Jacek  \n    Giakoumakis, Leo  \n    McLin, Nkenge  \n    El Yassir, Mehdi  \n    ```  \n  \n## Example  \n  \n```vb  \nClass SplitWithGroups  \n  \n    Shared Sub Main()  \n  \n        Dim fileA As String() = System.IO.File.ReadAllLines(\"../../../names1.txt\")  \n        Dim fileB As String() = System.IO.File.ReadAllLines(\"../../../names2.txt\")  \n  \n        ' Concatenate and remove duplicate names based on  \n        Dim mergeQuery As IEnumerable(Of String) = fileA.Union(fileB)  \n  \n        ' Group the names by the first letter in the last name  \n        Dim groupQuery = From name In mergeQuery   \n                     Let n = name.Split(New Char() {\",\"})   \n                     Order By n(0)   \n                     Group By groupKey = n(0)(0)   \n                     Into groupName = Group  \n  \n        ' Create a new file for each group that was created  \n        ' Note that nested foreach loops are required to access  \n        ' individual items with each group.  \n        For Each gGroup In groupQuery  \n            Dim fileName As String = \"..'..'..'testFile_\" & gGroup.groupKey & \".txt\"  \n            Dim sw As New System.IO.StreamWriter(fileName)  \n            Console.WriteLine(gGroup.groupKey)  \n            For Each item In gGroup.groupName  \n                Console.WriteLine(\"   \" & item.name)  \n                sw.WriteLine(item.name)  \n            Next  \n            sw.Close()  \n        Next  \n  \n        ' Keep console window open in debug mode.  \n        Console.WriteLine(\"Files have been written. Press any key to exit.\")  \n        Console.ReadKey()  \n  \n    End Sub  \nEnd Class  \n' Console Output:  \n' A  \n'    Aw, Kam Foo  \n' B  \n'    Bankov, Peter  \n'    Beebe, Ann  \n' E  \n'    El Yassir, Mehdi  \n' G  \n'    Garcia, Hugo  \n'    Garcia, Debra  \n'    Giakoumakis, Leo  \n'    Gilchrist, Beth  \n'    Guy, Wey Yuan  \n' H  \n'    Holm, Michael  \n' L  \n'    Liu, Jinghao  \n' M  \n'    McLin, Nkenge  \n'    Myrcha, Jacek  \n' N  \n'    Noriega, Fabricio  \n' P  \n'    Potra, Cristina  \n' T  \n'    Toyoshima, Tim  \n```  \n  \n The program writes a separate file for each group in the same folder as the data files.  \n  \n## Compiling the Code  \n Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a `Imports` statement for the System.Linq namespace.  \n  \n## See Also  \n [LINQ and Strings (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-strings.md)   \n [LINQ and File Directories (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)","nodes":[{"pos":[4,477],"nodes":[{"content":"How to: Split a File Into Many Files by Using Groups (LINQ) (Visual Basic) | Microsoft Docs","nodes":[{"pos":[0,91],"content":"How to: Split a File Into Many Files by Using Groups (LINQ) (Visual Basic) | Microsoft Docs","nodes":[{"content":"How to: Split a File Into Many Files by Using Groups (LINQ) (Visual Basic) | Microsoft Docs","pos":[0,91]}]}],"pos":[6,100],"yaml":true}],"content":"title: \"How to: Split a File Into Many Files by Using Groups (LINQ) (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: 5e8b2a2b-0b1d-4933-8a2b-03e91dfaf77f\ncaps.latest.revision: 3\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"","yamlblock":true},{"pos":[484,558],"content":"How to: Split a File Into Many Files by Using Groups (LINQ) (Visual Basic)","linkify":"How to: Split a File Into Many Files by Using Groups (LINQ) (Visual Basic)","nodes":[{"content":"How to: Split a File Into Many Files by Using Groups (LINQ) (Visual Basic)","pos":[0,74]}]},{"content":"This example shows one way to merge the contents of two files and then create a set of new files that organize the data in a new way.","pos":[559,692]},{"pos":[702,726],"content":"To create the data files","linkify":"To create the data files","nodes":[{"content":"To create the data files","pos":[0,24]}]},{"content":"Copy these names into a text file that is named names1.txt and save it in your project folder:","pos":[736,830]},{"content":"Copy these names into a text file that is named names2.txt and save it in your project folder: Note that the two files have some names in common.","pos":[1064,1209]},{"pos":[1444,1451],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The program writes a separate file for each group in the same folder as the data files.","pos":[3384,3471]},{"pos":[3480,3498],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[3502,3665],"content":"Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a <ph id=\"ph1\">`Imports`</ph> statement for the System.Linq namespace.","source":"Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a `Imports` statement for the System.Linq namespace."},{"pos":[3674,3682],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>LINQ and Strings (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-and-strings.md)</ept><ph id=\"ph1\"> </ph>","pos":[3686,3798],"source":"[LINQ and Strings (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-strings.md) "},{"content":"<bpt id=\"p1\">[</bpt>LINQ and File Directories (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)</ept>","pos":[3802,3931],"source":"[LINQ and File Directories (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)"}]}