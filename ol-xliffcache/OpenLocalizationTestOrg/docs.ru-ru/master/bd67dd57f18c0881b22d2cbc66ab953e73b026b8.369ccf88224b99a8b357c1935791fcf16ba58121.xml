{"content":"---\ntitle: \"How to: Use the Windows Communication Foundation Service Moniker without Registration | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"COM [WCF], service monikers without registration\"\nms.assetid: ee3cf5c0-24f0-4ae7-81da-73a60de4a1a8\ncaps.latest.revision: 16\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Use the Windows Communication Foundation Service Moniker without Registration\nTo connect to and communicate with a [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] service, a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client application must have the details of the service address, the binding configuration, and the service contract.  \n  \n The [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service moniker typically obtains the required contract through prior registration of the required attribute types, but there might be cases where this is not feasible. In place of registration, the moniker can obtain the definition of the contract in the form of a Web Services Definition Language (WSDL) document, through the use of the `wsdl` parameter or through Metadata Exchange, through the use of the `mexAddress` parameter.  \n  \n This enables scenarios such as the distribution of an Excel spreadsheet where some of the cell values are calculated through Web service interactions. In this scenario, it might not be feasible to register the service contract assembly on all clients that might open the document. The `wsdl` parameter or the `mexAddress` parameter enables a self-contained solution.  \n  \n> [!NOTE]\n>  Mutual authentication must be used to protect against request and response tampering or spoofing. Specifically, it is important for clients to be assured that the Metadata Exchange endpoint that is responding is the intended trusted party.  \n  \n## Example  \n This example shows the use of the service moniker with a MEX contract. A service with the following contract is exposed with a wsHttpBinding.  \n  \n```  \nusing System.ServiceModel;  \n  \n...  \n  \n[ServiceContract(Namespace = \"http://Microsoft.ServiceModel.Demo\")]  \npublic interface IAffiliate  \n{  \n    [OperationContract]  \n    bool NewAffiliate(string ID, string company, string fullname, string accountsCode);  \n    [OperationContract]  \n    bool RemoveAffiliate(string ID);  \n    [OperationContract]  \n    double RevenueCheckMonthly(ref string ID);  \n    [OperationContract]  \n    double RevenueCheckTotal(ref string ID);  \n}  \n```  \n  \n To construct a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client for the remote service the following example moniker string can be used.  \n  \n```  \nservice4:mexAddress=\"http://servername/Affiliates/service.svc/mex\",  \naddress=\"http://servername/Affiliates/service.svc\",  \ncontract=IAffiliate, contractNamespace=http://Microsoft.ServiceModel.Demo,  \nbinding=WSHttpBinding_IAffiliate, bindingNamespace=http://tempuri.org/  \n```  \n  \n During the execution of the client application, the client performs a `WS-MetadataExchange` with the provided `mexAddress`. This might return the address, binding and contract details for a number of services. The `address`, `contract`, `contractNamespace`, `binding` and `bindingNamespace` parameters are used to identify the intended service. Once those parameters have been matched, the moniker constructs a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client with the appropriate contract definition and calls can then be made using the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client, as with the typed contract.  \n  \n> [!NOTE]\n>  If the moniker is malformed or if the service is unavailable, the call to `GetObject` returns an error saying \"Invalid Syntax\". If you receive this error, make sure the moniker you are using is correct and the service is available.  \n  \n## See Also  \n [How to: Register and Configure a Service Moniker](../../../../docs/framework/wcf/feature-details/how-to-register-and-configure-a-service-moniker.md)","nodes":[{"pos":[12,114],"content":"How to: Use the Windows Communication Foundation Service Moniker without Registration | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Use the Windows Communication Foundation Service Moniker without Registration | Microsoft Docs","pos":[0,102]}]},{"pos":[490,575],"content":"How to: Use the Windows Communication Foundation Service Moniker without Registration","linkify":"How to: Use the Windows Communication Foundation Service Moniker without Registration","nodes":[{"content":"How to: Use the Windows Communication Foundation Service Moniker without Registration","pos":[0,85]}]},{"pos":[576,853],"content":"To connect to and communicate with a <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> service, a <ph id=\"ph2\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client application must have the details of the service address, the binding configuration, and the service contract.","source":"To connect to and communicate with a [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] service, a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client application must have the details of the service address, the binding configuration, and the service contract."},{"content":"The <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> service moniker typically obtains the required contract through prior registration of the required attribute types, but there might be cases where this is not feasible.","pos":[860,1088],"source":"The [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service moniker typically obtains the required contract through prior registration of the required attribute types, but there might be cases where this is not feasible."},{"content":"In place of registration, the moniker can obtain the definition of the contract in the form of a Web Services Definition Language (WSDL) document, through the use of the <ph id=\"ph1\">`wsdl`</ph> parameter or through Metadata Exchange, through the use of the <ph id=\"ph2\">`mexAddress`</ph> parameter.","pos":[1089,1352],"source":" In place of registration, the moniker can obtain the definition of the contract in the form of a Web Services Definition Language (WSDL) document, through the use of the `wsdl` parameter or through Metadata Exchange, through the use of the `mexAddress` parameter."},{"content":"This enables scenarios such as the distribution of an Excel spreadsheet where some of the cell values are calculated through Web service interactions.","pos":[1359,1509]},{"content":"In this scenario, it might not be feasible to register the service contract assembly on all clients that might open the document.","pos":[1510,1639]},{"content":"The <ph id=\"ph1\">`wsdl`</ph> parameter or the <ph id=\"ph2\">`mexAddress`</ph> parameter enables a self-contained solution.","pos":[1640,1725],"source":" The `wsdl` parameter or the `mexAddress` parameter enables a self-contained solution."},{"pos":[1733,1983],"content":"[!NOTE]\n Mutual authentication must be used to protect against request and response tampering or spoofing. Specifically, it is important for clients to be assured that the Metadata Exchange endpoint that is responding is the intended trusted party.","leadings":["","> "],"nodes":[{"content":" Mutual authentication must be used to protect against request and response tampering or spoofing. Specifically, it is important for clients to be assured that the Metadata Exchange endpoint that is responding is the intended trusted party.","pos":[8,248],"nodes":[{"content":"Mutual authentication must be used to protect against request and response tampering or spoofing.","pos":[1,98]},{"content":"Specifically, it is important for clients to be assured that the Metadata Exchange endpoint that is responding is the intended trusted party.","pos":[99,240]}]}]},{"pos":[1992,1999],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example shows the use of the service moniker with a MEX contract.","pos":[2003,2073]},{"content":"A service with the following contract is exposed with a wsHttpBinding.","pos":[2074,2144]},{"pos":[2644,2794],"content":"To construct a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client for the remote service the following example moniker string can be used.","source":"To construct a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client for the remote service the following example moniker string can be used."},{"content":"During the execution of the client application, the client performs a <ph id=\"ph1\">`WS-MetadataExchange`</ph> with the provided <ph id=\"ph2\">`mexAddress`</ph>.","pos":[3090,3213],"source":"During the execution of the client application, the client performs a `WS-MetadataExchange` with the provided `mexAddress`."},{"content":"This might return the address, binding and contract details for a number of services.","pos":[3214,3299]},{"content":"The <ph id=\"ph1\">`address`</ph>, <ph id=\"ph2\">`contract`</ph>, <ph id=\"ph3\">`contractNamespace`</ph>, <ph id=\"ph4\">`binding`</ph> and <ph id=\"ph5\">`bindingNamespace`</ph> parameters are used to identify the intended service.","pos":[3300,3434],"source":" The `address`, `contract`, `contractNamespace`, `binding` and `bindingNamespace` parameters are used to identify the intended service."},{"content":"Once those parameters have been matched, the moniker constructs a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client with the appropriate contract definition and calls can then be made using the <ph id=\"ph2\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client, as with the typed contract.","pos":[3435,3733],"source":" Once those parameters have been matched, the moniker constructs a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client with the appropriate contract definition and calls can then be made using the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client, as with the typed contract."},{"pos":[3741,3983],"content":"[!NOTE]\n If the moniker is malformed or if the service is unavailable, the call to `GetObject` returns an error saying \"Invalid Syntax\". If you receive this error, make sure the moniker you are using is correct and the service is available.","leadings":["","> "],"nodes":[{"content":" If the moniker is malformed or if the service is unavailable, the call to `GetObject` returns an error saying \"Invalid Syntax\". If you receive this error, make sure the moniker you are using is correct and the service is available.","pos":[8,240],"nodes":[{"content":"If the moniker is malformed or if the service is unavailable, the call to <ph id=\"ph1\">`GetObject`</ph> returns an error saying \"Invalid Syntax\".","pos":[1,128],"source":" If the moniker is malformed or if the service is unavailable, the call to `GetObject` returns an error saying \"Invalid Syntax\"."},{"content":"If you receive this error, make sure the moniker you are using is correct and the service is available.","pos":[129,232]}]}]},{"pos":[3992,4000],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[4004,4153],"content":"<bpt id=\"p1\">[</bpt>How to: Register and Configure a Service Moniker<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-register-and-configure-a-service-moniker.md)</ept>","source":"[How to: Register and Configure a Service Moniker](../../../../docs/framework/wcf/feature-details/how-to-register-and-configure-a-service-moniker.md)"}]}