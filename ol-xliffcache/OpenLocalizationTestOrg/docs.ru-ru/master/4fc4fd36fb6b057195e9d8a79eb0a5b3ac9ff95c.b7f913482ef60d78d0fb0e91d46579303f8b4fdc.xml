{"content":"---\ntitle: \"End Statement (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.End\"\n  - \"End\"\nhelpviewer_keywords: \n  - \"execution [Visual Basic], ending\"\n  - \"files [Visual Basic], closing\"\n  - \"End keyword [Visual Basic], End statements\"\n  - \"programs [Visual Basic], quitting\"\n  - \"code, exiting\"\n  - \"program termination\"\n  - \"End statement [Visual Basic]\"\n  - \"execution [Visual Basic], stopping\"\nms.assetid: 0e64467c-0f34-4aab-9ddd-43f8b9d55d90\n---\n# End Statement\nTerminates execution immediately.  \n  \n## Syntax  \n  \n```  \nEnd  \n```  \n  \n## Remarks  \n You can place the `End` statement anywhere in a procedure to force the entire application to stop running. `End` closes any files opened with an `Open` statement and clears all the application's variables. The application closes as soon as there are no other programs holding references to its objects and none of its code is running.  \n  \n> [!NOTE]\n>  The `End` statement stops code execution abruptly, and does not invoke the `Dispose` or `Finalize` method, or any other Visual Basic code. Object references held by other programs are invalidated. If an `End` statement is encountered within a `Try` or `Catch` block, control does not pass to the corresponding `Finally` block.  \n  \n The `Stop` statement suspends execution, but unlike `End`, it does not close any files or clear any variables, unless it is encountered in a compiled executable (.exe) file.  \n  \n Because `End` terminates your application without attending to any resources that might be open, you should try to close down cleanly before using it. For example, if your application has any forms open, you should close them before control reaches the `End` statement.  \n  \n You should use `End` sparingly, and only when you need to stop immediately. The normal ways to terminate a procedure ([Return Statement](../../../visual-basic/language-reference/statements/return-statement.md) and [Exit Statement](../../../visual-basic/language-reference/statements/exit-statement.md)) not only close down the procedure cleanly but also give the calling code the opportunity to close down cleanly. A console application, for example, can simply `Return` from the `Main` procedure.  \n  \n> [!IMPORTANT]\n>  The `End` statement calls the <xref:System.Environment.Exit%2A> method of the <xref:System.Environment> class in the <xref:System> namespace. <xref:System.Environment.Exit%2A> requires that you have `UnmanagedCode` permission. If you do not, a <xref:System.Security.SecurityException> error occurs.  \n  \n When followed by an additional keyword, [End \\<keyword> Statement](../../../visual-basic/language-reference/statements/end-keyword-statement.md) delineates the end of the definition of the appropriate procedure or block. For example, `End Function` terminates the definition of a `Function` procedure.  \n  \n## Example  \n The following example uses the `End` statement to terminate code execution if the user requests it.  \n  \n [!code-vb[VbVersHelp60Controls#64](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVersHelp60Controls/VB/Form1.vb#64)]  \n  \n## Smart Device Developer Notes  \n This statement is not supported.  \n  \n## See also\n\n- <xref:System.Security.Permissions.SecurityPermissionFlag>\n- [Stop Statement](../../../visual-basic/language-reference/statements/stop-statement.md)\n- [End \\<keyword> Statement](../../../visual-basic/language-reference/statements/end-keyword-statement.md)\n","nodes":[{"pos":[4,455],"embed":true,"restype":"x-metadata","content":"title: \"End Statement (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.End\"\n  - \"End\"\nhelpviewer_keywords: \n  - \"execution [Visual Basic], ending\"\n  - \"files [Visual Basic], closing\"\n  - \"End keyword [Visual Basic], End statements\"\n  - \"programs [Visual Basic], quitting\"\n  - \"code, exiting\"\n  - \"program termination\"\n  - \"End statement [Visual Basic]\"\n  - \"execution [Visual Basic], stopping\"\nms.assetid: 0e64467c-0f34-4aab-9ddd-43f8b9d55d90","nodes":[{"content":"End Statement (Visual Basic)","nodes":[{"pos":[0,28],"content":"End Statement (Visual Basic)","nodes":[{"content":"End Statement (Visual Basic)","pos":[0,28]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[462,475],"content":"End Statement","linkify":"End Statement","nodes":[{"content":"End Statement","pos":[0,13]}]},{"content":"Terminates execution immediately.","pos":[476,509]},{"pos":[518,524],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[554,561],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can place the <ph id=\"ph1\">`End`</ph> statement anywhere in a procedure to force the entire application to stop running.","pos":[565,671],"source":"You can place the `End` statement anywhere in a procedure to force the entire application to stop running."},{"content":"<ph id=\"ph1\">`End`</ph> closes any files opened with an <ph id=\"ph2\">`Open`</ph> statement and clears all the application's variables.","pos":[672,770],"source":"`End` closes any files opened with an `Open` statement and clears all the application's variables."},{"content":"The application closes as soon as there are no other programs holding references to its objects and none of its code is running.","pos":[771,899]},{"pos":[907,1244],"content":"[!NOTE]\n The `End` statement stops code execution abruptly, and does not invoke the `Dispose` or `Finalize` method, or any other Visual Basic code. Object references held by other programs are invalidated. If an `End` statement is encountered within a `Try` or `Catch` block, control does not pass to the corresponding `Finally` block.","leadings":["","> "],"nodes":[{"content":"The `End` statement stops code execution abruptly, and does not invoke the `Dispose` or `Finalize` method, or any other Visual Basic code. Object references held by other programs are invalidated. If an `End` statement is encountered within a `Try` or `Catch` block, control does not pass to the corresponding `Finally` block.","pos":[9,335],"nodes":[{"content":"The <ph id=\"ph1\">`End`</ph> statement stops code execution abruptly, and does not invoke the <ph id=\"ph2\">`Dispose`</ph> or <ph id=\"ph3\">`Finalize`</ph> method, or any other Visual Basic code.","pos":[0,138],"source":"The `End` statement stops code execution abruptly, and does not invoke the `Dispose` or `Finalize` method, or any other Visual Basic code."},{"content":"Object references held by other programs are invalidated.","pos":[139,196]},{"content":"If an <ph id=\"ph1\">`End`</ph> statement is encountered within a <ph id=\"ph2\">`Try`</ph> or <ph id=\"ph3\">`Catch`</ph> block, control does not pass to the corresponding <ph id=\"ph4\">`Finally`</ph> block.","pos":[197,326],"source":" If an `End` statement is encountered within a `Try` or `Catch` block, control does not pass to the corresponding `Finally` block."}]}]},{"pos":[1251,1424],"content":"The <ph id=\"ph1\">`Stop`</ph> statement suspends execution, but unlike <ph id=\"ph2\">`End`</ph>, it does not close any files or clear any variables, unless it is encountered in a compiled executable (.exe) file.","source":"The `Stop` statement suspends execution, but unlike `End`, it does not close any files or clear any variables, unless it is encountered in a compiled executable (.exe) file."},{"content":"Because <ph id=\"ph1\">`End`</ph> terminates your application without attending to any resources that might be open, you should try to close down cleanly before using it.","pos":[1431,1581],"source":"Because `End` terminates your application without attending to any resources that might be open, you should try to close down cleanly before using it."},{"content":"For example, if your application has any forms open, you should close them before control reaches the <ph id=\"ph1\">`End`</ph> statement.","pos":[1582,1700],"source":" For example, if your application has any forms open, you should close them before control reaches the `End` statement."},{"content":"You should use <ph id=\"ph1\">`End`</ph> sparingly, and only when you need to stop immediately.","pos":[1707,1782],"source":"You should use `End` sparingly, and only when you need to stop immediately."},{"content":"The normal ways to terminate a procedure (<bpt id=\"p1\">[</bpt>Return Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/return-statement.md)</ept> and <bpt id=\"p2\">[</bpt>Exit Statement<ept id=\"p2\">](../../../visual-basic/language-reference/statements/exit-statement.md)</ept>) not only close down the procedure cleanly but also give the calling code the opportunity to close down cleanly.","pos":[1783,2121],"source":" The normal ways to terminate a procedure ([Return Statement](../../../visual-basic/language-reference/statements/return-statement.md) and [Exit Statement](../../../visual-basic/language-reference/statements/exit-statement.md)) not only close down the procedure cleanly but also give the calling code the opportunity to close down cleanly."},{"content":"A console application, for example, can simply <ph id=\"ph1\">`Return`</ph> from the <ph id=\"ph2\">`Main`</ph> procedure.","pos":[2122,2204],"source":" A console application, for example, can simply `Return` from the `Main` procedure."},{"pos":[2212,2526],"content":"[!IMPORTANT]\n The `End` statement calls the <xref:System.Environment.Exit%2A> method of the <xref:System.Environment> class in the <xref:System> namespace. <xref:System.Environment.Exit%2A> requires that you have `UnmanagedCode` permission. If you do not, a <xref:System.Security.SecurityException> error occurs.","leadings":["","> "],"nodes":[{"content":"The `End` statement calls the <xref:System.Environment.Exit%2A> method of the <xref:System.Environment> class in the <xref:System> namespace. <xref:System.Environment.Exit%2A> requires that you have `UnmanagedCode` permission. If you do not, a <xref:System.Security.SecurityException> error occurs.","pos":[14,312],"nodes":[{"content":"The <ph id=\"ph1\">`End`</ph> statement calls the <ph id=\"ph2\">&lt;xref:System.Environment.Exit%2A&gt;</ph> method of the <ph id=\"ph3\">&lt;xref:System.Environment&gt;</ph> class in the <ph id=\"ph4\">&lt;xref:System&gt;</ph> namespace.","pos":[0,141],"source":"The `End` statement calls the <xref:System.Environment.Exit%2A> method of the <xref:System.Environment> class in the <xref:System> namespace."},{"content":"<ph id=\"ph1\">&lt;xref:System.Environment.Exit%2A&gt;</ph> requires that you have <ph id=\"ph2\">`UnmanagedCode`</ph> permission.","pos":[142,226],"source":"<xref:System.Environment.Exit%2A> requires that you have `UnmanagedCode` permission."},{"content":"If you do not, a <ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph> error occurs.","pos":[227,298],"source":" If you do not, a <xref:System.Security.SecurityException> error occurs."}]}]},{"content":"When followed by an additional keyword, <bpt id=\"p1\">[</bpt>End <ph id=\"ph1\">\\&lt;</ph>keyword&gt; Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/end-keyword-statement.md)</ept> delineates the end of the definition of the appropriate procedure or block.","pos":[2533,2753],"source":"When followed by an additional keyword, [End \\<keyword> Statement](../../../visual-basic/language-reference/statements/end-keyword-statement.md) delineates the end of the definition of the appropriate procedure or block."},{"content":"For example, <ph id=\"ph1\">`End Function`</ph> terminates the definition of a <ph id=\"ph2\">`Function`</ph> procedure.","pos":[2754,2834],"source":" For example, `End Function` terminates the definition of a `Function` procedure."},{"pos":[2843,2850],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2854,2953],"content":"The following example uses the <ph id=\"ph1\">`End`</ph> statement to terminate code execution if the user requests it.","source":"The following example uses the `End` statement to terminate code execution if the user requests it."},{"pos":[3093,3121],"content":"Smart Device Developer Notes","linkify":"Smart Device Developer Notes","nodes":[{"content":"Smart Device Developer Notes","pos":[0,28]}]},{"content":"This statement is not supported.","pos":[3125,3157]},{"pos":[3166,3174],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3238,3325],"content":"<bpt id=\"p1\">[</bpt>Stop Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/stop-statement.md)</ept>","source":"[Stop Statement](../../../visual-basic/language-reference/statements/stop-statement.md)"},{"pos":[3328,3432],"content":"<bpt id=\"p1\">[</bpt>End <ph id=\"ph1\">\\&lt;</ph>keyword&gt; Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/end-keyword-statement.md)</ept>","source":"[End \\<keyword> Statement](../../../visual-basic/language-reference/statements/end-keyword-statement.md)"}]}