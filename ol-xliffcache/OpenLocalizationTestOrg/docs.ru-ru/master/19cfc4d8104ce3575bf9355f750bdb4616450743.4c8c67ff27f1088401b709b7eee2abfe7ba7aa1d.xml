{"content":"---\ntitle: \"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"event logs, shutdown\"\n  - \"My.Application.Log object, logging\"\n  - \"Startup event [Visual Basic]\"\n  - \"event logs, startup\"\n  - \"Shutdown event [Visual Basic]\"\n  - \"My.Log object, logging\"\nms.assetid: 67624d05-cddf-48b7-8c36-5c99baa4c621\n---\n# How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)\nYou can use the `My.Application.Log` and `My.Log` objects to log information about events that occur in your application. This example shows how to use the `My.Application.Log.WriteEntry` method with the `Startup` and `Shutdown` events to write tracing information.  \n  \n### To access the application's event-handler code  \n  \n1.  Have a project selected in **Solution Explorer**. On the **Project** menu, choose **Properties**.  \n  \n2.  Click the **Application** tab.  \n  \n3.  Click the **View Application Events** button to open the Code Editor.  \n  \n     This opens the ApplicationEvents.vb file.  \n  \n### To log messages when the application starts  \n  \n1.  Have the ApplicationEvents.vb file open in the Code Editor. On the **General** menu, choose **MyApplication Events**.  \n  \n2.  On the **Declarations** menu, choose **Startup**.  \n  \n     The application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup> event before the main application runs.  \n  \n3.  Add the `My.Application.Log.WriteEntry` method to the `Startup` event handler.  \n  \n     [!code-vb[VbVbalrMyApplicationLog#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyApplicationLog/VB/MyEventsFake.vb#1)]  \n  \n### To log messages when the application shuts down  \n  \n1.  Have the ApplicationEvents.vb file open in the Code Editor. On the **General** menu, choose **MyApplication Events**.  \n  \n2.  On the **Declarations** menu, choose **Shutdown**.  \n  \n     The application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown> event after the main application runs, but before it shuts down.  \n  \n3.  Add the `My.Application.Log.WriteEntry` method to the `Shutdown` event handler.  \n  \n     [!code-vb[VbVbalrMyApplicationLog#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyApplicationLog/VB/MyEventsFake.vb#2)]  \n  \n## Example  \n You can use the **Project Designer** to access the application events in the Code Editor. For more information, see [Application Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/application-page-project-designer-visual-basic).  \n  \n [!code-vb[VbVbalrMyApplicationLog#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyApplicationLog/VB/MyEventsFake.vb#3)]  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.Logging.Log?displayProperty=nameWithType>\n- <xref:Microsoft.VisualBasic.Logging.Log.WriteEntry%2A>\n- <xref:Microsoft.VisualBasic.Logging.Log.WriteException%2A>\n- [Application Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/application-page-project-designer-visual-basic)\n- [Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)\n","nodes":[{"pos":[4,375],"embed":true,"restype":"x-metadata","content":"title: \"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"event logs, shutdown\"\n  - \"My.Application.Log object, logging\"\n  - \"Startup event [Visual Basic]\"\n  - \"event logs, startup\"\n  - \"Shutdown event [Visual Basic]\"\n  - \"My.Log object, logging\"\nms.assetid: 67624d05-cddf-48b7-8c36-5c99baa4c621","nodes":[{"content":"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)","nodes":[{"pos":[0,77],"content":"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)","nodes":[{"content":"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)","pos":[0,77]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[382,459],"content":"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)","linkify":"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)","nodes":[{"content":"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)","pos":[0,77]}]},{"content":"You can use the <ph id=\"ph1\">`My.Application.Log`</ph> and <ph id=\"ph2\">`My.Log`</ph> objects to log information about events that occur in your application.","pos":[460,581],"source":"You can use the `My.Application.Log` and `My.Log` objects to log information about events that occur in your application."},{"content":"This example shows how to use the <ph id=\"ph1\">`My.Application.Log.WriteEntry`</ph> method with the <ph id=\"ph2\">`Startup`</ph> and <ph id=\"ph3\">`Shutdown`</ph> events to write tracing information.","pos":[582,725],"source":" This example shows how to use the `My.Application.Log.WriteEntry` method with the `Startup` and `Shutdown` events to write tracing information."},{"pos":[735,781],"content":"To access the application's event-handler code","linkify":"To access the application's event-handler code","nodes":[{"content":"To access the application's event-handler code","pos":[0,46]}]},{"content":"Have a project selected in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>.","pos":[791,840],"source":"Have a project selected in **Solution Explorer**."},{"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","pos":[841,888],"source":" On the **Project** menu, choose **Properties**."},{"pos":[898,928],"content":"Click the <bpt id=\"p1\">**</bpt>Application<ept id=\"p1\">**</ept> tab.","source":"Click the **Application** tab."},{"pos":[938,1007],"content":"Click the <bpt id=\"p1\">**</bpt>View Application Events<ept id=\"p1\">**</ept> button to open the Code Editor.","source":"Click the **View Application Events** button to open the Code Editor."},{"content":"This opens the ApplicationEvents.vb file.","pos":[1018,1059]},{"pos":[1069,1112],"content":"To log messages when the application starts","linkify":"To log messages when the application starts","nodes":[{"content":"To log messages when the application starts","pos":[0,43]}]},{"content":"Have the ApplicationEvents.vb file open in the Code Editor.","pos":[1122,1181]},{"content":"On the <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>MyApplication Events<ept id=\"p2\">**</ept>.","pos":[1182,1239],"source":" On the **General** menu, choose **MyApplication Events**."},{"pos":[1249,1298],"content":"On the <bpt id=\"p1\">**</bpt>Declarations<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Startup<ept id=\"p2\">**</ept>.","source":"On the **Declarations** menu, choose **Startup**."},{"pos":[1309,1460],"content":"The application raises the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup&gt;</ph> event before the main application runs.","source":"The application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup> event before the main application runs."},{"pos":[1470,1548],"content":"Add the <ph id=\"ph1\">`My.Application.Log.WriteEntry`</ph> method to the <ph id=\"ph2\">`Startup`</ph> event handler.","source":"Add the `My.Application.Log.WriteEntry` method to the `Startup` event handler."},{"pos":[1704,1751],"content":"To log messages when the application shuts down","linkify":"To log messages when the application shuts down","nodes":[{"content":"To log messages when the application shuts down","pos":[0,47]}]},{"content":"Have the ApplicationEvents.vb file open in the Code Editor.","pos":[1761,1820]},{"content":"On the <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>MyApplication Events<ept id=\"p2\">**</ept>.","pos":[1821,1878],"source":" On the **General** menu, choose **MyApplication Events**."},{"pos":[1888,1938],"content":"On the <bpt id=\"p1\">**</bpt>Declarations<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Shutdown<ept id=\"p2\">**</ept>.","source":"On the **Declarations** menu, choose **Shutdown**."},{"pos":[1949,2126],"content":"The application raises the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown&gt;</ph> event after the main application runs, but before it shuts down.","source":"The application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown> event after the main application runs, but before it shuts down."},{"pos":[2136,2215],"content":"Add the <ph id=\"ph1\">`My.Application.Log.WriteEntry`</ph> method to the <ph id=\"ph2\">`Shutdown`</ph> event handler.","source":"Add the `My.Application.Log.WriteEntry` method to the `Shutdown` event handler."},{"pos":[2370,2377],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"You can use the <bpt id=\"p1\">**</bpt>Project Designer<ept id=\"p1\">**</ept> to access the application events in the Code Editor.","pos":[2381,2470],"source":"You can use the **Project Designer** to access the application events in the Code Editor."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Application Page, Project Designer (Visual Basic)<ept id=\"p1\">](/visualstudio/ide/reference/application-page-project-designer-visual-basic)</ept>.","pos":[2471,2625],"source":" For more information, see [Application Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/application-page-project-designer-visual-basic)."},{"pos":[2776,2784],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2978,3105],"content":"<bpt id=\"p1\">[</bpt>Application Page, Project Designer (Visual Basic)<ept id=\"p1\">](/visualstudio/ide/reference/application-page-project-designer-visual-basic)</ept>","source":"[Application Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/application-page-project-designer-visual-basic)"},{"pos":[3108,3235],"content":"<bpt id=\"p1\">[</bpt>Working with Application Logs<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)</ept>","source":"[Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)"}]}