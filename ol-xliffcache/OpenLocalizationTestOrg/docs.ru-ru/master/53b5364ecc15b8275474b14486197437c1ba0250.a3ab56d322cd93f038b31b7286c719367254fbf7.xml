{"content":"---\ntitle: \"Using Editing Scope | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 79306f9e-318b-4687-9863-8b93d1841716\ncaps.latest.revision: 5\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Using Editing Scope\nThis sample demonstrates how to batch a set of changes so that they can be undone in a single atomic unit. By default, the actions taken by an activity designer author are automatically integrated into the Undo/Redo system.  \n  \n## Demonstrates  \n Editing scope and Undo and Redo.  \n  \n## Discussion  \n This sample demonstrates how to batch a set of changes to the <xref:System.Activities.Presentation.Model.ModelItem> tree within a single unit of work. Note that when binding to <xref:System.Activities.Presentation.Model.ModelItem> values directly from a WPF designer, changes are applied automatically. This sample demonstrates what must be done when multiple changes to be batched are being made through imperative code, rather than a single change.  \n  \n In this sample, three activities are added. When editing begins, <xref:System.Activities.Presentation.Model.ModelItem.BeginEdit%2A> is called on an instance of <xref:System.Activities.Presentation.Model.ModelItem>. Changes made to the <xref:System.Activities.Presentation.Model.ModelItem> tree within this editing scope are batched. The <xref:System.Activities.Presentation.Model.ModelItem.BeginEdit%2A> command returns an <xref:System.Activities.Presentation.Model.EditingScope>, which can be used to control this instance. Either <xref:System.Activities.Presentation.Model.EditingScope.OnComplete%2A> or <xref:System.Activities.Presentation.Model.EditingScope.OnRevert%2A> can be called to either commit or revert the editing scope.  \n  \n You can also nest <xref:System.Activities.Presentation.Model.EditingScope> objects, which allows for multiple sets of changes to be tracked as part of a larger editing scope and can be controlled individually. A scenario that may use this feature would be when changes from multiple dialogs must be committed or reverted separately, with all changes being treated as a single atomic operation. In this sample, the editing scopes are stacked using an <xref:System.Collections.ObjectModel.ObservableCollection%601> of type <xref:System.Activities.Presentation.Model.ModelEditingScope>. The <xref:System.Collections.ObjectModel.ObservableCollection%601> is used so that the depth of the nesting can be observed on the designer surface.  \n  \n## To set up, build, and run the sample  \n  \n1.  Build and run the sample, and then use the buttons on the left to modify the workflow.  \n  \n2.  Click **Open Editing Scope**.  \n  \n    1.  This command calls <xref:System.Activities.Presentation.Model.ModelItem.BeginEdit%2A> that creates an editing scope and pushes it onto the editing stack.  \n  \n    2.  Three activities are then added to the selected <xref:System.Activities.Presentation.Model.ModelItem>. Note that if the editing scope had not been opened with <xref:System.Activities.Presentation.Model.ModelItem.BeginEdit%2A>, three new activities would appear on the designer canvas. Because this operation is still pending within the <xref:System.Activities.Presentation.Model.EditingScope>, the designer is not yet updated.  \n  \n3.  Press **Close Editing Scope** to commit the editing scope. Three activities appear in the designer.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\CustomActivities\\CustomActivityDesigners\\UsingEditingScope`","nodes":[{"pos":[12,48],"content":"Using Editing Scope | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Using Editing Scope | Microsoft Docs","pos":[0,36]}]},{"pos":[313,332],"content":"Using Editing Scope","linkify":"Using Editing Scope","nodes":[{"content":"Using Editing Scope","pos":[0,19]}]},{"content":"This sample demonstrates how to batch a set of changes so that they can be undone in a single atomic unit.","pos":[333,439]},{"content":"By default, the actions taken by an activity designer author are automatically integrated into the Undo/Redo system.","pos":[440,556]},{"pos":[565,577],"content":"Demonstrates","linkify":"Demonstrates","nodes":[{"content":"Demonstrates","pos":[0,12]}]},{"content":"Editing scope and Undo and Redo.","pos":[581,613]},{"pos":[622,632],"content":"Discussion","linkify":"Discussion","nodes":[{"content":"Discussion","pos":[0,10]}]},{"content":"This sample demonstrates how to batch a set of changes to the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.Model.ModelItem&gt;</ph> tree within a single unit of work.","pos":[636,786],"source":"This sample demonstrates how to batch a set of changes to the <xref:System.Activities.Presentation.Model.ModelItem> tree within a single unit of work."},{"content":"Note that when binding to <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.Model.ModelItem&gt;</ph> values directly from a WPF designer, changes are applied automatically.","pos":[787,938],"source":" Note that when binding to <xref:System.Activities.Presentation.Model.ModelItem> values directly from a WPF designer, changes are applied automatically."},{"content":"This sample demonstrates what must be done when multiple changes to be batched are being made through imperative code, rather than a single change.","pos":[939,1086]},{"content":"In this sample, three activities are added.","pos":[1093,1136]},{"content":"When editing begins, <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.Model.ModelItem.BeginEdit%2A&gt;</ph> is called on an instance of <ph id=\"ph2\">&lt;xref:System.Activities.Presentation.Model.ModelItem&gt;</ph>.","pos":[1137,1307],"source":" When editing begins, <xref:System.Activities.Presentation.Model.ModelItem.BeginEdit%2A> is called on an instance of <xref:System.Activities.Presentation.Model.ModelItem>."},{"content":"Changes made to the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.Model.ModelItem&gt;</ph> tree within this editing scope are batched.","pos":[1308,1425],"source":" Changes made to the <xref:System.Activities.Presentation.Model.ModelItem> tree within this editing scope are batched."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.Model.ModelItem.BeginEdit%2A&gt;</ph> command returns an <ph id=\"ph2\">&lt;xref:System.Activities.Presentation.Model.EditingScope&gt;</ph>, which can be used to control this instance.","pos":[1426,1617],"source":" The <xref:System.Activities.Presentation.Model.ModelItem.BeginEdit%2A> command returns an <xref:System.Activities.Presentation.Model.EditingScope>, which can be used to control this instance."},{"content":"Either <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.Model.EditingScope.OnComplete%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Activities.Presentation.Model.EditingScope.OnRevert%2A&gt;</ph> can be called to either commit or revert the editing scope.","pos":[1618,1827],"source":" Either <xref:System.Activities.Presentation.Model.EditingScope.OnComplete%2A> or <xref:System.Activities.Presentation.Model.EditingScope.OnRevert%2A> can be called to either commit or revert the editing scope."},{"content":"You can also nest <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.Model.EditingScope&gt;</ph> objects, which allows for multiple sets of changes to be tracked as part of a larger editing scope and can be controlled individually.","pos":[1834,2043],"source":"You can also nest <xref:System.Activities.Presentation.Model.EditingScope> objects, which allows for multiple sets of changes to be tracked as part of a larger editing scope and can be controlled individually."},{"content":"A scenario that may use this feature would be when changes from multiple dialogs must be committed or reverted separately, with all changes being treated as a single atomic operation.","pos":[2044,2227]},{"content":"In this sample, the editing scopes are stacked using an <ph id=\"ph1\">&lt;xref:System.Collections.ObjectModel.ObservableCollection%601&gt;</ph> of type <ph id=\"ph2\">&lt;xref:System.Activities.Presentation.Model.ModelEditingScope&gt;</ph>.","pos":[2228,2417],"source":" In this sample, the editing scopes are stacked using an <xref:System.Collections.ObjectModel.ObservableCollection%601> of type <xref:System.Activities.Presentation.Model.ModelEditingScope>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Collections.ObjectModel.ObservableCollection%601&gt;</ph> is used so that the depth of the nesting can be observed on the designer surface.","pos":[2418,2566],"source":" The <xref:System.Collections.ObjectModel.ObservableCollection%601> is used so that the depth of the nesting can be observed on the designer surface."},{"pos":[2575,2611],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"content":"Build and run the sample, and then use the buttons on the left to modify the workflow.","pos":[2621,2707]},{"pos":[2717,2746],"content":"Click <bpt id=\"p1\">**</bpt>Open Editing Scope<ept id=\"p1\">**</ept>.","source":"Click **Open Editing Scope**."},{"content":"This command calls <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.Model.ModelItem.BeginEdit%2A&gt;</ph> that creates an editing scope and pushes it onto the editing stack.","pos":[2760,2913],"source":"This command calls <xref:System.Activities.Presentation.Model.ModelItem.BeginEdit%2A> that creates an editing scope and pushes it onto the editing stack."},{"content":"Three activities are then added to the selected <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.Model.ModelItem&gt;</ph>.","pos":[2927,3029],"source":"Three activities are then added to the selected <xref:System.Activities.Presentation.Model.ModelItem>."},{"content":"Note that if the editing scope had not been opened with <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.Model.ModelItem.BeginEdit%2A&gt;</ph>, three new activities would appear on the designer canvas.","pos":[3030,3211],"source":" Note that if the editing scope had not been opened with <xref:System.Activities.Presentation.Model.ModelItem.BeginEdit%2A>, three new activities would appear on the designer canvas."},{"content":"Because this operation is still pending within the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.Model.EditingScope&gt;</ph>, the designer is not yet updated.","pos":[3212,3353],"source":" Because this operation is still pending within the <xref:System.Activities.Presentation.Model.EditingScope>, the designer is not yet updated."},{"content":"Press <bpt id=\"p1\">**</bpt>Close Editing Scope<ept id=\"p1\">**</ept> to commit the editing scope.","pos":[3363,3421],"source":"Press **Close Editing Scope** to commit the editing scope."},{"content":"Three activities appear in the designer.","pos":[3422,3462]},{"pos":[3470,3602],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[3656,3982],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[3983,4033]}]}