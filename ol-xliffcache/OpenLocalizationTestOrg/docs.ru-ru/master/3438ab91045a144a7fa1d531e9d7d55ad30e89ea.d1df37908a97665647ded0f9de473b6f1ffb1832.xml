{"content":"---\ntitle: \"How to: Sort a GridView Column When a Header Is Clicked\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"controls [WPF], GridView\"\n  - \"controls [WPF], ListView\"\n  - \"ListView controls [WPF], sorting GridView columns\"\n  - \"GridView controls [WPF], ListView control\"\nms.assetid: 4865d720-d147-40ed-83a7-af7587f8aad8\n---\n\n# How to: Sort a GridView Column When a Header Is Clicked\n\nThis example shows how to create a <xref:System.Windows.Controls.ListView> control that implements a <xref:System.Windows.Controls.GridView> view mode and sorts the data content when a user clicks a column header.\n\n## Example\n\nThe following example defines a <xref:System.Windows.Controls.GridView> with three columns that bind to the <xref:System.DateTime.Year%2A>, <xref:System.DateTime.Month%2A>, and <xref:System.DateTime.Day%2A>, properties of the <xref:System.DateTime> structure.\n\n```xaml\n<GridView>\n  <GridViewColumn DisplayMemberBinding=\"{Binding Path=Year}\"\n                  Header=\"Year\"\n                  Width=\"100\"/>\n  <GridViewColumn DisplayMemberBinding=\"{Binding Path=Month}\"\n                  Header=\"Month\"\n                  Width=\"100\"/>\n  <GridViewColumn DisplayMemberBinding=\"{Binding Path=Day}\"\n                  Header=\"Day\"\n                  Width=\"100\"/>\n</GridView>\n```\n\nThe following example shows the data items that are defined as an <xref:System.Collections.ArrayList> of <xref:System.DateTime> objects. The <xref:System.Collections.ArrayList> is defined as the <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> for the <xref:System.Windows.Controls.ListView> control.\n\n```xaml\n<ListView.ItemsSource>\n  <s:ArrayList>\n    <p:DateTime>1993/1/1 12:22:02</p:DateTime>\n    <p:DateTime>1993/1/2 13:2:01</p:DateTime>\n    <p:DateTime>1997/1/3 2:1:6</p:DateTime>\n    <p:DateTime>1997/1/4 13:6:55</p:DateTime>\n    <p:DateTime>1999/2/1 12:22:02</p:DateTime>\n    <p:DateTime>1998/2/2 13:2:01</p:DateTime>\n    <p:DateTime>2000/2/3 2:1:6</p:DateTime>\n    <p:DateTime>2002/2/4 13:6:55</p:DateTime>\n    <p:DateTime>2001/3/1 12:22:02</p:DateTime>\n    <p:DateTime>2006/3/2 13:2:01</p:DateTime>\n    <p:DateTime>2004/3/3 2:1:6</p:DateTime>\n    <p:DateTime>2004/3/4 13:6:55</p:DateTime>\n  </s:ArrayList>\n</ListView.ItemsSource>\n```\n\nThe `s` and `p` identifiers in the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] tags refer to namespace mappings that are defined in the metadata of the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] page. The following example shows the metadata definition.\n\n```xaml\n<Window\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    x:Class=\"ListViewSort.Window1\"\n    xmlns:s=\"clr-namespace:System.Collections;assembly=mscorlib\"\n    xmlns:p=\"clr-namespace:System;assembly=mscorlib\">\n```\n\nTo sort the data according to the contents of a column, the example defines an event handler to handle the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event that occurs when you press the column header button. The following example shows how to specify an event handler for the <xref:System.Windows.Controls.GridViewColumnHeader> control.\n\n```xaml\n<ListView x:Name='lv' Height=\"150\" HorizontalAlignment=\"Center\"\n  VerticalAlignment=\"Center\"\n  GridViewColumnHeader.Click=\"GridViewColumnHeaderClickedHandler\"\n >\n```\n\nThe example defines the event handler so that the sort direction changes between ascending order and descending order each time you press the column header button. The following example shows the event handler.\n\n```csharp\npublic partial class Window1 : Window\n{\n    public Window1()\n    {\n        InitializeComponent();\n    }\n\n    GridViewColumnHeader _lastHeaderClicked = null;\n    ListSortDirection _lastDirection = ListSortDirection.Ascending;\n\n    void GridViewColumnHeaderClickedHandler(object sender,\n                                            RoutedEventArgs e)\n    {\n        var headerClicked = e.OriginalSource as GridViewColumnHeader;\n        ListSortDirection direction;\n\n        if (headerClicked != null)\n        {\n            if (headerClicked.Role != GridViewColumnHeaderRole.Padding)\n            {\n                if (headerClicked != _lastHeaderClicked)\n                {\n                    direction = ListSortDirection.Ascending;\n                }\n                else\n                {\n                    if (_lastDirection == ListSortDirection.Ascending)\n                    {\n                        direction = ListSortDirection.Descending;\n                    }\n                    else\n                    {\n                        direction = ListSortDirection.Ascending;\n                    }\n                }\n\n                var columnBinding = headerClicked.Column.DisplayMemberBinding as Binding;\n                var sortBy = columnBinding?.Path.Path ?? headerClicked.Column.Header as string;\n\n                Sort(sortBy, direction);\n\n                if (direction == ListSortDirection.Ascending)\n                {\n                    headerClicked.Column.HeaderTemplate =\n                      Resources[\"HeaderTemplateArrowUp\"] as DataTemplate;\n                }\n                else\n                {\n                    headerClicked.Column.HeaderTemplate =\n                      Resources[\"HeaderTemplateArrowDown\"] as DataTemplate;\n                }\n\n                // Remove arrow from previously sorted header\n                if (_lastHeaderClicked != null && _lastHeaderClicked != headerClicked)\n                {\n                    _lastHeaderClicked.Column.HeaderTemplate = null;\n                }\n\n                _lastHeaderClicked = headerClicked;\n                _lastDirection = direction;\n            }\n        }\n    }\n}\n```\n\n```vb\nPartial Public Class Window1\n    Inherits Window\n    Public Sub New()\n        InitializeComponent()\n    End Sub\n\n    Private _lastHeaderClicked As GridViewColumnHeader = Nothing\n    Private _lastDirection As ListSortDirection = ListSortDirection.Ascending\n\n    Private Sub GridViewColumnHeaderClickedHandler(ByVal sender As Object, ByVal e As RoutedEventArgs)\n        Dim headerClicked = TryCast(e.OriginalSource, GridViewColumnHeader)\n        Dim direction As ListSortDirection\n\n        If headerClicked IsNot Nothing Then\n            If headerClicked.Role <> GridViewColumnHeaderRole.Padding Then\n                If headerClicked IsNot _lastHeaderClicked Then\n                    direction = ListSortDirection.Ascending\n                Else\n                    If _lastDirection = ListSortDirection.Ascending Then\n                        direction = ListSortDirection.Descending\n                    Else\n                        direction = ListSortDirection.Ascending\n                    End If\n                End If\n\n                Dim columnBinding = TryCast(headerClicked.Column.DisplayMemberBinding, Binding)\n                Dim sortBy = If(columnBinding?.Path.Path, TryCast(headerClicked.Column.Header, String))\n\n                Sort(sortBy, direction)\n\n                If direction = ListSortDirection.Ascending Then\n                    headerClicked.Column.HeaderTemplate = TryCast(Resources(\"HeaderTemplateArrowUp\"), DataTemplate)\n                Else\n                    headerClicked.Column.HeaderTemplate = TryCast(Resources(\"HeaderTemplateArrowDown\"), DataTemplate)\n                End If\n\n                ' Remove arrow from previously sorted header\n                If _lastHeaderClicked IsNot Nothing AndAlso _lastHeaderClicked IsNot headerClicked Then\n                    _lastHeaderClicked.Column.HeaderTemplate = Nothing\n                End If\n\n                _lastHeaderClicked = headerClicked\n                _lastDirection = direction\n            End If\n        End If\n    End Sub\nEnd Class\n```\n\nThe following example shows the sorting algorithm that is called by the event handler to sort the data. The sort is performed by creating a new <xref:System.ComponentModel.SortDescription> structure.\n\n```csharp\nprivate void Sort(string sortBy, ListSortDirection direction)\n{\n    ICollectionView dataView =\n      CollectionViewSource.GetDefaultView(lv.ItemsSource);\n\n    dataView.SortDescriptions.Clear();\n    SortDescription sd = new SortDescription(sortBy, direction);\n    dataView.SortDescriptions.Add(sd);\n    dataView.Refresh();\n}\n```\n\n```vb\nPrivate Sub Sort(ByVal sortBy As String, ByVal direction As ListSortDirection)\n    Dim dataView As ICollectionView = CollectionViewSource.GetDefaultView(lv.ItemsSource)\n\n    dataView.SortDescriptions.Clear()\n    Dim sd As New SortDescription(sortBy, direction)\n    dataView.SortDescriptions.Add(sd)\n    dataView.Refresh()\nEnd Sub\n```\n\n## See also\n\n- <xref:System.Windows.Controls.ListView>\n- <xref:System.Windows.Controls.GridView>\n- [ListView Overview](listview-overview.md)\n- [GridView Overview](gridview-overview.md)\n- [How-to Topics](listview-how-to-topics.md)\n","nodes":[{"pos":[4,359],"embed":true,"restype":"x-metadata","content":"title: \"How to: Sort a GridView Column When a Header Is Clicked\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"controls [WPF], GridView\"\n  - \"controls [WPF], ListView\"\n  - \"ListView controls [WPF], sorting GridView columns\"\n  - \"GridView controls [WPF], ListView control\"\nms.assetid: 4865d720-d147-40ed-83a7-af7587f8aad8","nodes":[{"content":"How to: Sort a GridView Column When a Header Is Clicked","nodes":[{"pos":[0,55],"content":"How to: Sort a GridView Column When a Header Is Clicked","nodes":[{"content":"How to: Sort a GridView Column When a Header Is Clicked","pos":[0,55]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[367,422],"content":"How to: Sort a GridView Column When a Header Is Clicked","linkify":"How to: Sort a GridView Column When a Header Is Clicked","nodes":[{"content":"How to: Sort a GridView Column When a Header Is Clicked","pos":[0,55]}]},{"pos":[424,637],"content":"This example shows how to create a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ListView&gt;</ph> control that implements a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.GridView&gt;</ph> view mode and sorts the data content when a user clicks a column header.","source":"This example shows how to create a <xref:System.Windows.Controls.ListView> control that implements a <xref:System.Windows.Controls.GridView> view mode and sorts the data content when a user clicks a column header."},{"pos":[642,649],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[651,910],"content":"The following example defines a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.GridView&gt;</ph> with three columns that bind to the <ph id=\"ph2\">&lt;xref:System.DateTime.Year%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.DateTime.Month%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.DateTime.Day%2A&gt;</ph>, properties of the <ph id=\"ph5\">&lt;xref:System.DateTime&gt;</ph> structure.","source":"The following example defines a <xref:System.Windows.Controls.GridView> with three columns that bind to the <xref:System.DateTime.Year%2A>, <xref:System.DateTime.Month%2A>, and <xref:System.DateTime.Day%2A>, properties of the <xref:System.DateTime> structure."},{"content":"The following example shows the data items that are defined as an <ph id=\"ph1\">&lt;xref:System.Collections.ArrayList&gt;</ph> of <ph id=\"ph2\">&lt;xref:System.DateTime&gt;</ph> objects.","pos":[1323,1459],"source":"The following example shows the data items that are defined as an <xref:System.Collections.ArrayList> of <xref:System.DateTime> objects."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Collections.ArrayList&gt;</ph> is defined as the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ItemsControl.ItemsSource%2A&gt;</ph> for the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.ListView&gt;</ph> control.","pos":[1460,1633],"source":" The <xref:System.Collections.ArrayList> is defined as the <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> for the <xref:System.Windows.Controls.ListView> control."},{"content":"The <ph id=\"ph1\">`s`</ph> and <ph id=\"ph2\">`p`</ph> identifiers in the <ph id=\"ph3\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> tags refer to namespace mappings that are defined in the metadata of the <ph id=\"ph4\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> page.","pos":[2277,2534],"source":"The `s` and `p` identifiers in the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] tags refer to namespace mappings that are defined in the metadata of the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] page."},{"content":"The following example shows the metadata definition.","pos":[2535,2587]},{"content":"To sort the data according to the contents of a column, the example defines an event handler to handle the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase.Click&gt;</ph> event that occurs when you press the column header button.","pos":[2893,3117],"source":"To sort the data according to the contents of a column, the example defines an event handler to handle the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event that occurs when you press the column header button."},{"content":"The following example shows how to specify an event handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.GridViewColumnHeader&gt;</ph> control.","pos":[3118,3246],"source":" The following example shows how to specify an event handler for the <xref:System.Windows.Controls.GridViewColumnHeader> control."},{"content":"The example defines the event handler so that the sort direction changes between ascending order and descending order each time you press the column header button.","pos":[3423,3586]},{"content":"The following example shows the event handler.","pos":[3587,3633]},{"content":"The following example shows the sorting algorithm that is called by the event handler to sort the data.","pos":[7831,7934]},{"content":"The sort is performed by creating a new <ph id=\"ph1\">&lt;xref:System.ComponentModel.SortDescription&gt;</ph> structure.","pos":[7935,8030],"source":" The sort is performed by creating a new <xref:System.ComponentModel.SortDescription> structure."},{"pos":[8715,8723],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8811,8852],"content":"<bpt id=\"p1\">[</bpt>ListView Overview<ept id=\"p1\">](listview-overview.md)</ept>","source":"[ListView Overview](listview-overview.md)"},{"pos":[8855,8896],"content":"<bpt id=\"p1\">[</bpt>GridView Overview<ept id=\"p1\">](gridview-overview.md)</ept>","source":"[GridView Overview](gridview-overview.md)"},{"pos":[8899,8941],"content":"<bpt id=\"p1\">[</bpt>How-to Topics<ept id=\"p1\">](listview-how-to-topics.md)</ept>","source":"[How-to Topics](listview-how-to-topics.md)"}]}