{"content":"---\ntitle: \"How to: Add Tables and Columns to the Windows Forms DataGrid Control\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"columns [Windows Forms], adding to DataGrid control\"\n  - \"tables [Windows Forms], adding to DataGrid control\"\n  - \"DataGrid control [Windows Forms], adding tables and columns\"\nms.assetid: 2fe661b9-aa06-49b9-a314-a0d3cbfdcb4d\n---\n# How to: Add Tables and Columns to the Windows Forms DataGrid Control\n> [!NOTE]\n>  The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose. For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](differences-between-the-windows-forms-datagridview-and-datagrid-controls.md).  \n  \n You can display data in the Windows Forms <xref:System.Windows.Forms.DataGrid> control in tables and columns by creating **DataGridTableStyle** objects and adding them to the **GridTableStylesCollection** object, which is accessed through the <xref:System.Windows.Forms.DataGrid> control's **TableStyles** property. Each table style displays the contents of whatever data table is specified in the **DataGridTableStyle** object's **MappingName** property. By default, a table style with no column styles specified will display all the columns within that data table. You can restrict which columns from the table appear by adding **DataGridColumnStyle** objects to the **GridColumnStylesCollection** object, which is accessed through the **GridColumnStyles** property of each **DataGridTableStyle** object.  \n  \n### To add a table and column to a DataGrid programmatically  \n  \n1.  In order to display data in the table, you must first bind the <xref:System.Windows.Forms.DataGrid> control to a dataset. For more information, see [How to: Bind the Windows Forms DataGrid Control to a Data Source](how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md).  \n  \n    > [!CAUTION]\n    >  When programmatically specifying column styles, always create **DataGridColumnStyle** objects and add them to the **GridColumnStylesCollection** object before adding **DataGridTableStyle** objects to the **GridTableStylesCollection** object. When you add an empty **DataGridTableStyle** object to the collection, **DataGridColumnStyle** objects are automatically generated for you. Consequently, an exception will be thrown if you try to add new **DataGridColumnStyle** objects with duplicate **MappingName** values to the **GridColumnStylesCollection** object.  \n  \n2.  Declare a new table style and set its mapping name.  \n  \n    ```vb  \n    Dim ts1 As New DataGridTableStyle()  \n    ts1.MappingName = \"Customers\"  \n    ```  \n  \n    ```csharp  \n    DataGridTableStyle ts1 = new DataGridTableStyle();  \n    ts1.MappingName = \"Customers\";  \n    ```  \n  \n    ```cpp  \n    DataGridTableStyle* ts1 = new DataGridTableStyle();  \n    ts1->MappingName = S\"Customers\";  \n    ```  \n  \n3.  Declare a new column style and set its mapping name and other properties.  \n  \n    ```vb  \n    Dim myDataCol As New DataGridBoolColumn()  \n    myDataCol.HeaderText = \"My New Column\"  \n    myDataCol.MappingName = \"Current\"  \n    ```  \n  \n    ```csharp  \n    DataGridBoolColumn myDataCol = new DataGridBoolColumn();  \n    myDataCol.HeaderText = \"My New Column\";  \n    myDataCol.MappingName = \"Current\";  \n    ```  \n  \n    ```cpp  \n    DataGridBoolColumn^ myDataCol = gcnew DataGridBoolColumn();  \n    myDataCol->HeaderText = \"My New Column\";  \n    myDataCol->MappingName = \"Current\";  \n    ```  \n  \n4.  Call the **Add** method of the **GridColumnStylesCollection** object to add the column to the table style  \n  \n    ```vb  \n    ts1.GridColumnStyles.Add(myDataCol)  \n    ```  \n  \n    ```csharp  \n    ts1.GridColumnStyles.Add(myDataCol);  \n    ```  \n  \n    ```cpp  \n    ts1->GridColumnStyles->Add(myDataCol);  \n    ```  \n  \n5.  Call the **Add** method of the **GridTableStylesCollection** object to add the table style to the data grid.  \n  \n    ```vb  \n    DataGrid1.TableStyles.Add(ts1)  \n    ```  \n  \n    ```csharp  \n    dataGrid1.TableStyles.Add(ts1);  \n    ```  \n  \n    ```cpp  \n    dataGrid1->TableStyles->Add(ts1);  \n    ```  \n  \n## See also\n\n- [DataGrid Control](datagrid-control-windows-forms.md)\n- [How to: Delete or Hide Columns in the Windows Forms DataGrid Control](how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md)\n","nodes":[{"pos":[4,399],"embed":true,"restype":"x-metadata","content":"title: \"How to: Add Tables and Columns to the Windows Forms DataGrid Control\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"columns [Windows Forms], adding to DataGrid control\"\n  - \"tables [Windows Forms], adding to DataGrid control\"\n  - \"DataGrid control [Windows Forms], adding tables and columns\"\nms.assetid: 2fe661b9-aa06-49b9-a314-a0d3cbfdcb4d","nodes":[{"content":"How to: Add Tables and Columns to the Windows Forms DataGrid Control","nodes":[{"pos":[0,68],"content":"How to: Add Tables and Columns to the Windows Forms DataGrid Control","nodes":[{"content":"How to: Add Tables and Columns to the Windows Forms DataGrid Control","pos":[0,68]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[406,474],"content":"How to: Add Tables and Columns to the Windows Forms DataGrid Control","linkify":"How to: Add Tables and Columns to the Windows Forms DataGrid Control","nodes":[{"content":"How to: Add Tables and Columns to the Windows Forms DataGrid Control","pos":[0,68]}]},{"pos":[477,937],"content":"[!NOTE]\n The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose. For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](differences-between-the-windows-forms-datagridview-and-datagrid-controls.md).","leadings":["","> "],"nodes":[{"content":"The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose. For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](differences-between-the-windows-forms-datagridview-and-datagrid-controls.md).","pos":[9,458],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control replaces and adds functionality to the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control; however, the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control is retained for both backward compatibility and future use, if you choose.","pos":[0,270],"source":"The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Differences Between the Windows Forms DataGridView and DataGrid Controls<ept id=\"p1\">](differences-between-the-windows-forms-datagridview-and-datagrid-controls.md)</ept>.","pos":[271,449],"source":" For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](differences-between-the-windows-forms-datagridview-and-datagrid-controls.md)."}]}]},{"content":"You can display data in the Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control in tables and columns by creating <bpt id=\"p1\">**</bpt>DataGridTableStyle<ept id=\"p1\">**</ept> objects and adding them to the <bpt id=\"p2\">**</bpt>GridTableStylesCollection<ept id=\"p2\">**</ept> object, which is accessed through the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control's <bpt id=\"p3\">**</bpt>TableStyles<ept id=\"p3\">**</ept> property.","pos":[944,1259],"source":"You can display data in the Windows Forms <xref:System.Windows.Forms.DataGrid> control in tables and columns by creating **DataGridTableStyle** objects and adding them to the **GridTableStylesCollection** object, which is accessed through the <xref:System.Windows.Forms.DataGrid> control's **TableStyles** property."},{"content":"Each table style displays the contents of whatever data table is specified in the <bpt id=\"p1\">**</bpt>DataGridTableStyle<ept id=\"p1\">**</ept> object's <bpt id=\"p2\">**</bpt>MappingName<ept id=\"p2\">**</ept> property.","pos":[1260,1399],"source":" Each table style displays the contents of whatever data table is specified in the **DataGridTableStyle** object's **MappingName** property."},{"content":"By default, a table style with no column styles specified will display all the columns within that data table.","pos":[1400,1510]},{"content":"You can restrict which columns from the table appear by adding <bpt id=\"p1\">**</bpt>DataGridColumnStyle<ept id=\"p1\">**</ept> objects to the <bpt id=\"p2\">**</bpt>GridColumnStylesCollection<ept id=\"p2\">**</ept> object, which is accessed through the <bpt id=\"p3\">**</bpt>GridColumnStyles<ept id=\"p3\">**</ept> property of each <bpt id=\"p4\">**</bpt>DataGridTableStyle<ept id=\"p4\">**</ept> object.","pos":[1511,1750],"source":" You can restrict which columns from the table appear by adding **DataGridColumnStyle** objects to the **GridColumnStylesCollection** object, which is accessed through the **GridColumnStyles** property of each **DataGridTableStyle** object."},{"pos":[1760,1816],"content":"To add a table and column to a DataGrid programmatically","linkify":"To add a table and column to a DataGrid programmatically","nodes":[{"content":"To add a table and column to a DataGrid programmatically","pos":[0,56]}]},{"content":"In order to display data in the table, you must first bind the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control to a dataset.","pos":[1826,1947],"source":"In order to display data in the table, you must first bind the <xref:System.Windows.Forms.DataGrid> control to a dataset."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Bind the Windows Forms DataGrid Control to a Data Source<ept id=\"p1\">](how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)</ept>.","pos":[1948,2109],"source":" For more information, see [How to: Bind the Windows Forms DataGrid Control to a Data Source](how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)."},{"pos":[2121,2700],"content":"[!CAUTION]\nWhen programmatically specifying column styles, always create **DataGridColumnStyle** objects and add them to the **GridColumnStylesCollection** object before adding **DataGridTableStyle** objects to the **GridTableStylesCollection** object. When you add an empty **DataGridTableStyle** object to the collection, **DataGridColumnStyle** objects are automatically generated for you. Consequently, an exception will be thrown if you try to add new **DataGridColumnStyle** objects with duplicate **MappingName** values to the **GridColumnStylesCollection** object.","leadings":["","    >  "],"nodes":[{"content":"When programmatically specifying column styles, always create **DataGridColumnStyle** objects and add them to the **GridColumnStylesCollection** object before adding **DataGridTableStyle** objects to the **GridTableStylesCollection** object. When you add an empty **DataGridTableStyle** object to the collection, **DataGridColumnStyle** objects are automatically generated for you. Consequently, an exception will be thrown if you try to add new **DataGridColumnStyle** objects with duplicate **MappingName** values to the **GridColumnStylesCollection** object.","pos":[11,572],"nodes":[{"content":"When programmatically specifying column styles, always create <bpt id=\"p1\">**</bpt>DataGridColumnStyle<ept id=\"p1\">**</ept> objects and add them to the <bpt id=\"p2\">**</bpt>GridColumnStylesCollection<ept id=\"p2\">**</ept> object before adding <bpt id=\"p3\">**</bpt>DataGridTableStyle<ept id=\"p3\">**</ept> objects to the <bpt id=\"p4\">**</bpt>GridTableStylesCollection<ept id=\"p4\">**</ept> object.","pos":[0,241],"source":"When programmatically specifying column styles, always create **DataGridColumnStyle** objects and add them to the **GridColumnStylesCollection** object before adding **DataGridTableStyle** objects to the **GridTableStylesCollection** object."},{"content":"When you add an empty <bpt id=\"p1\">**</bpt>DataGridTableStyle<ept id=\"p1\">**</ept> object to the collection, <bpt id=\"p2\">**</bpt>DataGridColumnStyle<ept id=\"p2\">**</ept> objects are automatically generated for you.","pos":[242,381],"source":" When you add an empty **DataGridTableStyle** object to the collection, **DataGridColumnStyle** objects are automatically generated for you."},{"content":"Consequently, an exception will be thrown if you try to add new <bpt id=\"p1\">**</bpt>DataGridColumnStyle<ept id=\"p1\">**</ept> objects with duplicate <bpt id=\"p2\">**</bpt>MappingName<ept id=\"p2\">**</ept> values to the <bpt id=\"p3\">**</bpt>GridColumnStylesCollection<ept id=\"p3\">**</ept> object.","pos":[382,561],"source":" Consequently, an exception will be thrown if you try to add new **DataGridColumnStyle** objects with duplicate **MappingName** values to the **GridColumnStylesCollection** object."}]}]},{"content":"Declare a new table style and set its mapping name.","pos":[2710,2761]},{"content":"Declare a new column style and set its mapping name and other properties.","pos":[3120,3193]},{"pos":[3721,3826],"content":"Call the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> method of the <bpt id=\"p2\">**</bpt>GridColumnStylesCollection<ept id=\"p2\">**</ept> object to add the column to the table style","source":"Call the **Add** method of the **GridColumnStylesCollection** object to add the column to the table style"},{"pos":[4046,4154],"content":"Call the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> method of the <bpt id=\"p2\">**</bpt>GridTableStylesCollection<ept id=\"p2\">**</ept> object to add the table style to the data grid.","source":"Call the **Add** method of the **GridTableStylesCollection** object to add the table style to the data grid."},{"pos":[4358,4366],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4370,4423],"content":"<bpt id=\"p1\">[</bpt>DataGrid Control<ept id=\"p1\">](datagrid-control-windows-forms.md)</ept>","source":"[DataGrid Control](datagrid-control-windows-forms.md)"},{"pos":[4426,4568],"content":"<bpt id=\"p1\">[</bpt>How to: Delete or Hide Columns in the Windows Forms DataGrid Control<ept id=\"p1\">](how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md)</ept>","source":"[How to: Delete or Hide Columns in the Windows Forms DataGrid Control](how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md)"}]}