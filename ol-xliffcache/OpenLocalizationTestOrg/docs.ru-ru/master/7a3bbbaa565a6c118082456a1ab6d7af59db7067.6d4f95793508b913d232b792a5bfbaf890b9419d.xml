{"content":"---\ntitle: \"Using Libraries from Partially Trusted Code\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"security [.NET Framework], partially trusted code\"\n  - \"partially trusted code\"\n  - \"partial trust\"\n  - \"AllowPartiallyTrustedCallersAttribute attribute\"\n  - \"code access security, partially trusted code\"\n  - \"APTCA\"\nms.assetid: dd66cd4c-b087-415f-9c3e-94e3a1835f74\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Using Libraries from Partially Trusted Code\n[!INCLUDE[net_security_note](../../../includes/net-security-note-md.md)]  \n  \n> [!NOTE]\n>  This topic addresses the behavior of strong-named assemblies and applies only to [Level 1](../../../docs/framework/misc/security-transparent-code-level-1.md) assemblies. [Security-Transparent Code, Level 2](../../../docs/framework/misc/security-transparent-code-level-2.md) assemblies in the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)] or later are not affected by strong names. For more information about changes to the security system, see [Security Changes](../../../docs/framework/security/security-changes.md).  \n  \n Applications that receive less than full trust from their host or sandbox are not allowed to call shared managed libraries unless the library writer specifically allows them to through the use of the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute. Therefore, application writers must be aware that some libraries will not be available to them from a partially trusted context. By default, all code that executes in a partial-trust [sandbox](../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md) and is not in the list of full-trust assemblies is partially trusted. If you do not expect your code to be executed from a partially trusted context or to be called by partially trusted code, you do not have to be concerned about the information in this section. However, if you write code that must interact with partially trusted code or operate from a partially trusted context, you should consider the following factors:  \n  \n-   Libraries must be signed with a strong name in order to be shared by multiple applications. Strong names allow your code to be placed in the global assembly cache or added to the full-trust list of a sandboxing <xref:System.AppDomain>, and allow consumers to verify that a particular piece of mobile code actually originates from you.  \n  \n-   By default, strong-named [Level 1](../../../docs/framework/misc/security-transparent-code-level-1.md) shared libraries perform an implicit [LinkDemand](../../../docs/framework/misc/link-demands.md) for full trust automatically, without the library writer having to do anything.  \n  \n-   If a caller does not have full trust but still tries to call such a library, the runtime throws a <xref:System.Security.SecurityException> and the caller is not allowed to link to the library.  \n  \n-   In order to disable the automatic **LinkDemand** and prevent the exception from being thrown, you can place the **AllowPartiallyTrustedCallersAttribute** attribute on the assembly scope of a shared library. This attribute allows your libraries to be called from partially trusted managed code.  \n  \n-   Partially trusted code that is granted access to a library with this attribute is still subject to further restrictions defined by the <xref:System.AppDomain>.  \n  \n-   There is no programmatic way for partially trusted code to call a library that does not have the **AllowPartiallyTrustedCallersAttribute** attribute.  \n  \n Libraries that are private to a specific application do not require a strong name or the **AllowPartiallyTrustedCallersAttribute** attribute and cannot be referenced by potentially malicious code outside the application. Such code is protected against intentional or unintentional misuse by partially trusted mobile code without the developer having to do anything extra.  \n  \n You should consider explicitly enabling use by partially trusted code for the following types of code:  \n  \n-   Code that has been diligently tested for security vulnerabilities and is in compliance with the guidelines described in [Secure Coding Guidelines](../../../docs/standard/security/secure-coding-guidelines.md).  \n  \n-   Strong-named code libraries that are specifically written for partially trusted scenarios.  \n  \n-   Any components (whether partially or fully trusted) signed with a strong name that will be called by code that is downloaded from the Internet.  \n  \n> [!NOTE]\n>  Some classes in the .NET Framework class library do not have the **AllowPartiallyTrustedCallersAttribute** attribute and cannot be called by partially trusted code.  \n  \n## See also\n\n- [Code Access Security](../../../docs/framework/misc/code-access-security.md)\n","nodes":[{"pos":[4,408],"embed":true,"restype":"x-metadata","content":"title: \"Using Libraries from Partially Trusted Code\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"security [.NET Framework], partially trusted code\"\n  - \"partially trusted code\"\n  - \"partial trust\"\n  - \"AllowPartiallyTrustedCallersAttribute attribute\"\n  - \"code access security, partially trusted code\"\n  - \"APTCA\"\nms.assetid: dd66cd4c-b087-415f-9c3e-94e3a1835f74\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Using Libraries from Partially Trusted Code","nodes":[{"pos":[0,43],"content":"Using Libraries from Partially Trusted Code","nodes":[{"content":"Using Libraries from Partially Trusted Code","pos":[0,43]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[415,458],"content":"Using Libraries from Partially Trusted Code","linkify":"Using Libraries from Partially Trusted Code","nodes":[{"content":"Using Libraries from Partially Trusted Code","pos":[0,43]}]},{"pos":[539,1084],"content":"[!NOTE]\n This topic addresses the behavior of strong-named assemblies and applies only to [Level 1](../../../docs/framework/misc/security-transparent-code-level-1.md) assemblies. [Security-Transparent Code, Level 2](../../../docs/framework/misc/security-transparent-code-level-2.md) assemblies in the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)] or later are not affected by strong names. For more information about changes to the security system, see [Security Changes](../../../docs/framework/security/security-changes.md).","leadings":["","> "],"nodes":[{"content":"This topic addresses the behavior of strong-named assemblies and applies only to [Level 1](../../../docs/framework/misc/security-transparent-code-level-1.md) assemblies. [Security-Transparent Code, Level 2](../../../docs/framework/misc/security-transparent-code-level-2.md) assemblies in the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)] or later are not affected by strong names. For more information about changes to the security system, see [Security Changes](../../../docs/framework/security/security-changes.md).","pos":[9,543],"nodes":[{"content":"This topic addresses the behavior of strong-named assemblies and applies only to <bpt id=\"p1\">[</bpt>Level 1<ept id=\"p1\">](../../../docs/framework/misc/security-transparent-code-level-1.md)</ept> assemblies.","pos":[0,169],"source":"This topic addresses the behavior of strong-named assemblies and applies only to [Level 1](../../../docs/framework/misc/security-transparent-code-level-1.md) assemblies."},{"content":"<bpt id=\"p1\">[</bpt>Security-Transparent Code, Level 2<ept id=\"p1\">](../../../docs/framework/misc/security-transparent-code-level-2.md)</ept> assemblies in the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)]</ph> or later are not affected by strong names.","pos":[170,397],"source":"[Security-Transparent Code, Level 2](../../../docs/framework/misc/security-transparent-code-level-2.md) assemblies in the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)] or later are not affected by strong names."},{"content":"For more information about changes to the security system, see <bpt id=\"p1\">[</bpt>Security Changes<ept id=\"p1\">](../../../docs/framework/security/security-changes.md)</ept>.","pos":[398,534],"source":" For more information about changes to the security system, see [Security Changes](../../../docs/framework/security/security-changes.md)."}]}]},{"content":"Applications that receive less than full trust from their host or sandbox are not allowed to call shared managed libraries unless the library writer specifically allows them to through the use of the <ph id=\"ph1\">&lt;xref:System.Security.AllowPartiallyTrustedCallersAttribute&gt;</ph> attribute.","pos":[1091,1362],"source":"Applications that receive less than full trust from their host or sandbox are not allowed to call shared managed libraries unless the library writer specifically allows them to through the use of the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute."},{"content":"Therefore, application writers must be aware that some libraries will not be available to them from a partially trusted context.","pos":[1363,1491]},{"content":"By default, all code that executes in a partial-trust <bpt id=\"p1\">[</bpt>sandbox<ept id=\"p1\">](../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md)</ept> and is not in the list of full-trust assemblies is partially trusted.","pos":[1492,1705],"source":" By default, all code that executes in a partial-trust [sandbox](../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md) and is not in the list of full-trust assemblies is partially trusted."},{"content":"If you do not expect your code to be executed from a partially trusted context or to be called by partially trusted code, you do not have to be concerned about the information in this section.","pos":[1706,1898]},{"content":"However, if you write code that must interact with partially trusted code or operate from a partially trusted context, you should consider the following factors:","pos":[1899,2060]},{"content":"Libraries must be signed with a strong name in order to be shared by multiple applications.","pos":[2070,2161]},{"content":"Strong names allow your code to be placed in the global assembly cache or added to the full-trust list of a sandboxing <ph id=\"ph1\">&lt;xref:System.AppDomain&gt;</ph>, and allow consumers to verify that a particular piece of mobile code actually originates from you.","pos":[2162,2404],"source":" Strong names allow your code to be placed in the global assembly cache or added to the full-trust list of a sandboxing <xref:System.AppDomain>, and allow consumers to verify that a particular piece of mobile code actually originates from you."},{"pos":[2414,2691],"content":"By default, strong-named <bpt id=\"p1\">[</bpt>Level 1<ept id=\"p1\">](../../../docs/framework/misc/security-transparent-code-level-1.md)</ept> shared libraries perform an implicit <bpt id=\"p2\">[</bpt>LinkDemand<ept id=\"p2\">](../../../docs/framework/misc/link-demands.md)</ept> for full trust automatically, without the library writer having to do anything.","source":"By default, strong-named [Level 1](../../../docs/framework/misc/security-transparent-code-level-1.md) shared libraries perform an implicit [LinkDemand](../../../docs/framework/misc/link-demands.md) for full trust automatically, without the library writer having to do anything."},{"pos":[2701,2893],"content":"If a caller does not have full trust but still tries to call such a library, the runtime throws a <ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph> and the caller is not allowed to link to the library.","source":"If a caller does not have full trust but still tries to call such a library, the runtime throws a <xref:System.Security.SecurityException> and the caller is not allowed to link to the library."},{"content":"In order to disable the automatic <bpt id=\"p1\">**</bpt>LinkDemand<ept id=\"p1\">**</ept> and prevent the exception from being thrown, you can place the <bpt id=\"p2\">**</bpt>AllowPartiallyTrustedCallersAttribute<ept id=\"p2\">**</ept> attribute on the assembly scope of a shared library.","pos":[2903,3109],"source":"In order to disable the automatic **LinkDemand** and prevent the exception from being thrown, you can place the **AllowPartiallyTrustedCallersAttribute** attribute on the assembly scope of a shared library."},{"content":"This attribute allows your libraries to be called from partially trusted managed code.","pos":[3110,3196]},{"pos":[3206,3365],"content":"Partially trusted code that is granted access to a library with this attribute is still subject to further restrictions defined by the <ph id=\"ph1\">&lt;xref:System.AppDomain&gt;</ph>.","source":"Partially trusted code that is granted access to a library with this attribute is still subject to further restrictions defined by the <xref:System.AppDomain>."},{"pos":[3375,3524],"content":"There is no programmatic way for partially trusted code to call a library that does not have the <bpt id=\"p1\">**</bpt>AllowPartiallyTrustedCallersAttribute<ept id=\"p1\">**</ept> attribute.","source":"There is no programmatic way for partially trusted code to call a library that does not have the **AllowPartiallyTrustedCallersAttribute** attribute."},{"content":"Libraries that are private to a specific application do not require a strong name or the <bpt id=\"p1\">**</bpt>AllowPartiallyTrustedCallersAttribute<ept id=\"p1\">**</ept> attribute and cannot be referenced by potentially malicious code outside the application.","pos":[3531,3751],"source":"Libraries that are private to a specific application do not require a strong name or the **AllowPartiallyTrustedCallersAttribute** attribute and cannot be referenced by potentially malicious code outside the application."},{"content":"Such code is protected against intentional or unintentional misuse by partially trusted mobile code without the developer having to do anything extra.","pos":[3752,3902]},{"content":"You should consider explicitly enabling use by partially trusted code for the following types of code:","pos":[3909,4011]},{"pos":[4021,4229],"content":"Code that has been diligently tested for security vulnerabilities and is in compliance with the guidelines described in <bpt id=\"p1\">[</bpt>Secure Coding Guidelines<ept id=\"p1\">](../../../docs/standard/security/secure-coding-guidelines.md)</ept>.","source":"Code that has been diligently tested for security vulnerabilities and is in compliance with the guidelines described in [Secure Coding Guidelines](../../../docs/standard/security/secure-coding-guidelines.md)."},{"content":"Strong-named code libraries that are specifically written for partially trusted scenarios.","pos":[4239,4329]},{"content":"Any components (whether partially or fully trusted) signed with a strong name that will be called by code that is downloaded from the Internet.","pos":[4339,4482]},{"pos":[4490,4665],"content":"[!NOTE]\n Some classes in the .NET Framework class library do not have the **AllowPartiallyTrustedCallersAttribute** attribute and cannot be called by partially trusted code.","leadings":["","> "],"nodes":[{"content":"Some classes in the .NET Framework class library do not have the <bpt id=\"p1\">**</bpt>AllowPartiallyTrustedCallersAttribute<ept id=\"p1\">**</ept> attribute and cannot be called by partially trusted code.","pos":[9,173],"source":"Some classes in the .NET Framework class library do not have the **AllowPartiallyTrustedCallersAttribute** attribute and cannot be called by partially trusted code."}]},{"pos":[4674,4682],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4686,4762],"content":"<bpt id=\"p1\">[</bpt>Code Access Security<ept id=\"p1\">](../../../docs/framework/misc/code-access-security.md)</ept>","source":"[Code Access Security](../../../docs/framework/misc/code-access-security.md)"}]}