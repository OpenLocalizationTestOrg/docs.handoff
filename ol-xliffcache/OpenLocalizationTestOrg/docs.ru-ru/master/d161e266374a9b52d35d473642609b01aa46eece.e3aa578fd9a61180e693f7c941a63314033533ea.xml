{"content":"---\ntitle: \"Activity Library | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 5323e9d4-71d6-47eb-bfa6-31feac62044d\ncaps.latest.revision: 7\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Activity Library\nThis section contains samples that demonstrate advanced custom activities in [!INCLUDE[wf](../../../../includes/wf-md.md)].  \n  \n## In This Section  \n [Policy Activity in .NET Framework 4.5](../../../../docs/framework/windows-workflow-foundation/samples/policy-activity-in-net-framework-4-5.md)  \n Demonstrates how the Policy4 activity allows [!INCLUDE[wf2](../../../../includes/wf2-md.md)] in [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] (WF 3.5) <xref:System.Workflow.Activities.Rules.RuleSet> objects to be used in [!INCLUDE[wf2](../../../../includes/wf2-md.md)]in [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] (WF 4.5) directly by using the rules engine that is shipped in WF 3.5.  \n  \n [Custom Activity to Switch on a Range of Values](../../../../docs/framework/windows-workflow-foundation/samples/custom-activity-to-switch-on-a-range-of-values.md)  \n Demonstrates how to create a custom activity that extends the use of a <xref:System.Activities.Statements.Switch%601>.  \n  \n [LINQ to Objects Activity](../../../../docs/framework/windows-workflow-foundation/samples/linq-to-objects-activity.md)  \n Demonstrates how to create an activity to use LINQ to Objects to query elements in a collection.  \n  \n [LINQ to SQL Sample](../../../../docs/framework/windows-workflow-foundation/samples/linq-to-sql-sample.md)  \n Demonstrates how to create an activity to use LINQ to SQL query entities from tables in SQL Server databases.  \n  \n [Using the InvokePowerShell Activity](../../../../docs/framework/windows-workflow-foundation/samples/using-the-invokepowershell-activity.md)  \n Demonstrates how to invoke Windows PowerShell commands using the InvokePowerShell activity.  \n  \n [RangeEnumeration Activity](../../../../docs/framework/windows-workflow-foundation/samples/rangeenumeration-activity.md)  \n Demonstrates how to create a custom activity that iterates over a collection of numbers.  \n  \n [Regular Expression Activities](../../../../docs/framework/windows-workflow-foundation/samples/regular-expression-activities.md)  \n Demonstrates how to create a set of activities that expose the regular expression functionality of the <xref:System.Text.RegularExpressions> namespace.  \n  \n [SendMail Custom Activity](../../../../docs/framework/windows-workflow-foundation/samples/sendmail-custom-activity.md)  \n Demonstrates how to create a custom activity that derives from <xref:System.Activities.AsyncCodeActivity> to send mail using SMTP for use within a workflow application.  \n  \n [For Activity](../../../../docs/framework/windows-workflow-foundation/samples/for-activity.md)  \n Demonstrates how to build a custom activity that inherits from <xref:System.Activities.NativeActivity> and use it in a workflow to iterate over a range of values.  \n  \n [Wait For Input Activity](../../../../docs/framework/windows-workflow-foundation/samples/wait-for-input-activity.md)  \n Demonstrates how to create named bookmarks in a workflow.  \n  \n [Throttled Parallel ForEach](../../../../docs/framework/windows-workflow-foundation/samples/throttled-parallel-foreach.md)  \n Demonstrates how the `ThrottleParallelForEach` activity is similar to the <xref:System.Activities.Statements.ParallelForEach%601> activity with the one exception that it allows setting a concurrency factor to restrict the number of simultaneous branches to execute.  \n  \n [Entity Activities](../../../../docs/framework/windows-workflow-foundation/samples/entity-activities.md)  \n Demonstrates how to use the ADO.NET Entity Framework with [!INCLUDE[wf2](../../../../includes/wf2-md.md)] to simplify data access.  \n  \n [Database Access Activities](../../../../docs/framework/windows-workflow-foundation/samples/database-access-activities.md)  \n Demonstrates how to create activities that allow accessing databases to retrieve or modify information and use [ADO.NET](http://go.microsoft.com/fwlink/?LinkId=166081) to access the database.  \n  \n [CommentOut Activity](../../../../docs/framework/windows-workflow-foundation/samples/commentout-activity.md)  \n Demonstrates how to write a custom activity that removes other activities from the path of execution, effectively commenting them out.  \n  \n [Externalized Policy Activity in .NET Framework 4.5](../../../../docs/framework/windows-workflow-foundation/samples/externalized-policy-activity-in-net-framework-4-5.md)  \n Demonstrates how the ExternalizedPolicy4 activity allows executing existing [!INCLUDE[wf2](../../../../includes/wf2-md.md)] in [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] (WF 3.5) <xref:System.Workflow.Activities.Rules.RuleSet> objects in [!INCLUDE[wf2](../../../../includes/wf2-md.md)] in [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] (WF 4.5) directly by using the rules engine that is shipped in WF 3.5.  \n  \n [NoPersistScope Activity](../../../../docs/framework/windows-workflow-foundation/samples/nopersistscope-activity.md)  \n Demonstrates how to manipulate a non-serializable and disposable state within a workflow.  \n  \n [Non-Generic ForEach](../../../../docs/framework/windows-workflow-foundation/samples/non-generic-foreach.md)  \n Demonstrates how to create a non-generic version of the <xref:System.Activities.Statements.ForEach%601> activity.  \n  \n [Non-Generic ParallelForEach](../../../../docs/framework/windows-workflow-foundation/samples/non-generic-parallelforeach.md)  \n Demonstrates how to create a non-generic version of the <xref:System.Activities.Statements.ParallelForEach%601> activity.  \n  \n [Get WorkflowInstanceId](../../../../docs/framework/windows-workflow-foundation/samples/get-workflowinstanceid.md)  \n Demonstrates how to use the custom activity, `GetWorkflowInstanceId`, to return the workflow instance ID.","nodes":[{"pos":[12,45],"content":"Activity Library | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Activity Library | Microsoft Docs","pos":[0,33]}]},{"pos":[310,326],"content":"Activity Library","linkify":"Activity Library","nodes":[{"content":"Activity Library","pos":[0,16]}]},{"pos":[327,450],"content":"This section contains samples that demonstrate advanced custom activities in <ph id=\"ph1\">[!INCLUDE[wf](../../../../includes/wf-md.md)]</ph>.","source":"This section contains samples that demonstrate advanced custom activities in [!INCLUDE[wf](../../../../includes/wf-md.md)]."},{"pos":[459,474],"content":"In This Section","linkify":"In This Section","nodes":[{"content":"In This Section","pos":[0,15]}]},{"content":"<bpt id=\"p1\">[</bpt>Policy Activity in .NET Framework 4.5<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/policy-activity-in-net-framework-4-5.md)</ept>","pos":[478,621],"source":"[Policy Activity in .NET Framework 4.5](../../../../docs/framework/windows-workflow-foundation/samples/policy-activity-in-net-framework-4-5.md)"},{"content":"Demonstrates how the Policy4 activity allows <ph id=\"ph1\">[!INCLUDE[wf2](../../../../includes/wf2-md.md)]</ph> in <ph id=\"ph2\">[!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)]</ph> (WF 3.5) <ph id=\"ph3\">&lt;xref:System.Workflow.Activities.Rules.RuleSet&gt;</ph> objects to be used in <ph id=\"ph4\">[!INCLUDE[wf2](../../../../includes/wf2-md.md)]</ph>in <ph id=\"ph5\">[!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)]</ph> (WF 4.5) directly by using the rules engine that is shipped in WF 3.5.","pos":[625,1064],"source":" Demonstrates how the Policy4 activity allows [!INCLUDE[wf2](../../../../includes/wf2-md.md)] in [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] (WF 3.5) <xref:System.Workflow.Activities.Rules.RuleSet> objects to be used in [!INCLUDE[wf2](../../../../includes/wf2-md.md)]in [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] (WF 4.5) directly by using the rules engine that is shipped in WF 3.5."},{"content":"<bpt id=\"p1\">[</bpt>Custom Activity to Switch on a Range of Values<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/custom-activity-to-switch-on-a-range-of-values.md)</ept>","pos":[1071,1233],"source":"[Custom Activity to Switch on a Range of Values](../../../../docs/framework/windows-workflow-foundation/samples/custom-activity-to-switch-on-a-range-of-values.md)"},{"content":"Demonstrates how to create a custom activity that extends the use of a <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Switch%601&gt;</ph>.","pos":[1237,1355],"source":" Demonstrates how to create a custom activity that extends the use of a <xref:System.Activities.Statements.Switch%601>."},{"content":"<bpt id=\"p1\">[</bpt>LINQ to Objects Activity<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/linq-to-objects-activity.md)</ept>","pos":[1362,1480],"source":"[LINQ to Objects Activity](../../../../docs/framework/windows-workflow-foundation/samples/linq-to-objects-activity.md)"},{"content":"Demonstrates how to create an activity to use LINQ to Objects to query elements in a collection.","pos":[1484,1580]},{"content":"<bpt id=\"p1\">[</bpt>LINQ to SQL Sample<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/linq-to-sql-sample.md)</ept>","pos":[1587,1693],"source":"[LINQ to SQL Sample](../../../../docs/framework/windows-workflow-foundation/samples/linq-to-sql-sample.md)"},{"content":"Demonstrates how to create an activity to use LINQ to SQL query entities from tables in SQL Server databases.","pos":[1697,1806]},{"content":"<bpt id=\"p1\">[</bpt>Using the InvokePowerShell Activity<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/using-the-invokepowershell-activity.md)</ept>","pos":[1813,1953],"source":"[Using the InvokePowerShell Activity](../../../../docs/framework/windows-workflow-foundation/samples/using-the-invokepowershell-activity.md)"},{"content":"Demonstrates how to invoke Windows PowerShell commands using the InvokePowerShell activity.","pos":[1957,2048]},{"content":"<bpt id=\"p1\">[</bpt>RangeEnumeration Activity<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/rangeenumeration-activity.md)</ept>","pos":[2055,2175],"source":"[RangeEnumeration Activity](../../../../docs/framework/windows-workflow-foundation/samples/rangeenumeration-activity.md)"},{"content":"Demonstrates how to create a custom activity that iterates over a collection of numbers.","pos":[2179,2267]},{"content":"<bpt id=\"p1\">[</bpt>Regular Expression Activities<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/regular-expression-activities.md)</ept>","pos":[2274,2402],"source":"[Regular Expression Activities](../../../../docs/framework/windows-workflow-foundation/samples/regular-expression-activities.md)"},{"content":"Demonstrates how to create a set of activities that expose the regular expression functionality of the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions&gt;</ph> namespace.","pos":[2406,2557],"source":" Demonstrates how to create a set of activities that expose the regular expression functionality of the <xref:System.Text.RegularExpressions> namespace."},{"content":"<bpt id=\"p1\">[</bpt>SendMail Custom Activity<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/sendmail-custom-activity.md)</ept>","pos":[2564,2682],"source":"[SendMail Custom Activity](../../../../docs/framework/windows-workflow-foundation/samples/sendmail-custom-activity.md)"},{"content":"Demonstrates how to create a custom activity that derives from <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity&gt;</ph> to send mail using SMTP for use within a workflow application.","pos":[2686,2854],"source":" Demonstrates how to create a custom activity that derives from <xref:System.Activities.AsyncCodeActivity> to send mail using SMTP for use within a workflow application."},{"content":"<bpt id=\"p1\">[</bpt>For Activity<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/for-activity.md)</ept>","pos":[2861,2955],"source":"[For Activity](../../../../docs/framework/windows-workflow-foundation/samples/for-activity.md)"},{"content":"Demonstrates how to build a custom activity that inherits from <ph id=\"ph1\">&lt;xref:System.Activities.NativeActivity&gt;</ph> and use it in a workflow to iterate over a range of values.","pos":[2959,3121],"source":" Demonstrates how to build a custom activity that inherits from <xref:System.Activities.NativeActivity> and use it in a workflow to iterate over a range of values."},{"content":"<bpt id=\"p1\">[</bpt>Wait For Input Activity<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/wait-for-input-activity.md)</ept>","pos":[3128,3244],"source":"[Wait For Input Activity](../../../../docs/framework/windows-workflow-foundation/samples/wait-for-input-activity.md)"},{"content":"Demonstrates how to create named bookmarks in a workflow.","pos":[3248,3305]},{"content":"<bpt id=\"p1\">[</bpt>Throttled Parallel ForEach<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/throttled-parallel-foreach.md)</ept>","pos":[3312,3434],"source":"[Throttled Parallel ForEach](../../../../docs/framework/windows-workflow-foundation/samples/throttled-parallel-foreach.md)"},{"content":"Demonstrates how the <ph id=\"ph1\">`ThrottleParallelForEach`</ph> activity is similar to the <ph id=\"ph2\">&lt;xref:System.Activities.Statements.ParallelForEach%601&gt;</ph> activity with the one exception that it allows setting a concurrency factor to restrict the number of simultaneous branches to execute.","pos":[3438,3703],"source":" Demonstrates how the `ThrottleParallelForEach` activity is similar to the <xref:System.Activities.Statements.ParallelForEach%601> activity with the one exception that it allows setting a concurrency factor to restrict the number of simultaneous branches to execute."},{"content":"<bpt id=\"p1\">[</bpt>Entity Activities<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/entity-activities.md)</ept>","pos":[3710,3814],"source":"[Entity Activities](../../../../docs/framework/windows-workflow-foundation/samples/entity-activities.md)"},{"content":"Demonstrates how to use the ADO.NET Entity Framework with <ph id=\"ph1\">[!INCLUDE[wf2](../../../../includes/wf2-md.md)]</ph> to simplify data access.","pos":[3818,3948],"source":" Demonstrates how to use the ADO.NET Entity Framework with [!INCLUDE[wf2](../../../../includes/wf2-md.md)] to simplify data access."},{"content":"<bpt id=\"p1\">[</bpt>Database Access Activities<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/database-access-activities.md)</ept>","pos":[3955,4077],"source":"[Database Access Activities](../../../../docs/framework/windows-workflow-foundation/samples/database-access-activities.md)"},{"content":"Demonstrates how to create activities that allow accessing databases to retrieve or modify information and use <bpt id=\"p1\">[</bpt>ADO.NET<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=166081)</ept> to access the database.","pos":[4081,4272],"source":" Demonstrates how to create activities that allow accessing databases to retrieve or modify information and use [ADO.NET](http://go.microsoft.com/fwlink/?LinkId=166081) to access the database."},{"content":"<bpt id=\"p1\">[</bpt>CommentOut Activity<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/commentout-activity.md)</ept>","pos":[4279,4387],"source":"[CommentOut Activity](../../../../docs/framework/windows-workflow-foundation/samples/commentout-activity.md)"},{"content":"Demonstrates how to write a custom activity that removes other activities from the path of execution, effectively commenting them out.","pos":[4391,4525]},{"content":"<bpt id=\"p1\">[</bpt>Externalized Policy Activity in .NET Framework 4.5<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/externalized-policy-activity-in-net-framework-4-5.md)</ept>","pos":[4532,4701],"source":"[Externalized Policy Activity in .NET Framework 4.5](../../../../docs/framework/windows-workflow-foundation/samples/externalized-policy-activity-in-net-framework-4-5.md)"},{"content":"Demonstrates how the ExternalizedPolicy4 activity allows executing existing <ph id=\"ph1\">[!INCLUDE[wf2](../../../../includes/wf2-md.md)]</ph> in <ph id=\"ph2\">[!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)]</ph> (WF 3.5) <ph id=\"ph3\">&lt;xref:System.Workflow.Activities.Rules.RuleSet&gt;</ph> objects in <ph id=\"ph4\">[!INCLUDE[wf2](../../../../includes/wf2-md.md)]</ph> in <ph id=\"ph5\">[!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)]</ph> (WF 4.5) directly by using the rules engine that is shipped in WF 3.5.","pos":[4705,5165],"source":" Demonstrates how the ExternalizedPolicy4 activity allows executing existing [!INCLUDE[wf2](../../../../includes/wf2-md.md)] in [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] (WF 3.5) <xref:System.Workflow.Activities.Rules.RuleSet> objects in [!INCLUDE[wf2](../../../../includes/wf2-md.md)] in [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] (WF 4.5) directly by using the rules engine that is shipped in WF 3.5."},{"content":"<bpt id=\"p1\">[</bpt>NoPersistScope Activity<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/nopersistscope-activity.md)</ept>","pos":[5172,5288],"source":"[NoPersistScope Activity](../../../../docs/framework/windows-workflow-foundation/samples/nopersistscope-activity.md)"},{"content":"Demonstrates how to manipulate a non-serializable and disposable state within a workflow.","pos":[5292,5381]},{"content":"<bpt id=\"p1\">[</bpt>Non-Generic ForEach<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/non-generic-foreach.md)</ept>","pos":[5388,5496],"source":"[Non-Generic ForEach](../../../../docs/framework/windows-workflow-foundation/samples/non-generic-foreach.md)"},{"content":"Demonstrates how to create a non-generic version of the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.ForEach%601&gt;</ph> activity.","pos":[5500,5613],"source":" Demonstrates how to create a non-generic version of the <xref:System.Activities.Statements.ForEach%601> activity."},{"content":"<bpt id=\"p1\">[</bpt>Non-Generic ParallelForEach<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/non-generic-parallelforeach.md)</ept>","pos":[5620,5744],"source":"[Non-Generic ParallelForEach](../../../../docs/framework/windows-workflow-foundation/samples/non-generic-parallelforeach.md)"},{"content":"Demonstrates how to create a non-generic version of the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.ParallelForEach%601&gt;</ph> activity.","pos":[5748,5869],"source":" Demonstrates how to create a non-generic version of the <xref:System.Activities.Statements.ParallelForEach%601> activity."},{"content":"<bpt id=\"p1\">[</bpt>Get WorkflowInstanceId<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/get-workflowinstanceid.md)</ept>","pos":[5876,5990],"source":"[Get WorkflowInstanceId](../../../../docs/framework/windows-workflow-foundation/samples/get-workflowinstanceid.md)"},{"content":"Demonstrates how to use the custom activity, <ph id=\"ph1\">`GetWorkflowInstanceId`</ph>, to return the workflow instance ID.","pos":[5994,6099],"source":" Demonstrates how to use the custom activity, `GetWorkflowInstanceId`, to return the workflow instance ID."}]}