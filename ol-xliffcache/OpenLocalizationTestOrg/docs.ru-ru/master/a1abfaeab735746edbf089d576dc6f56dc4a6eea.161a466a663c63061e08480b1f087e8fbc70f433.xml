{"content":"---\ntitle: \"How to: Change Styles on an Element in the Managed HTML Document Object Model\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"managed HTML DOM [Windows Forms], changing styles on elements\"\nms.assetid: 154e8d9f-3e2d-4e8b-a6f3-c85a070e9cc1\n---\n\n# How to: Change Styles on an Element in the Managed HTML Document Object Model\n\nYou can use styles in HTML to control the appearance of a document and its elements. <xref:System.Windows.Forms.HtmlDocument> and <xref:System.Windows.Forms.HtmlElement> support <xref:System.Windows.Forms.HtmlElement.Style%2A> properties that take style strings of the following format:\n\n`name1:value1;...;nameN:valueN;`\n\nHere is a `DIV` with a style string that sets the font to Arial and all text to bold:\n\n`<DIV style=\"font-face:arial;font-weight:bold;\">`\n\n`Hello, world!`\n\n`</DIV>`\n\nThe problem with manipulating styles using the <xref:System.Windows.Forms.HtmlElement.Style%2A> property is that it can prove cumbersome to add to and remove individual style settings from the string. For example, it would become a complex procedure for you to render the previous text in italics whenever the user positions the cursor over the `DIV`, and take italics off when the cursor leaves the `DIV`. Time would become an issue if you need to manipulate a large number of styles in this manner.\n\nThe following procedure contains code that you can use to easily manipulate styles on HTML documents and elements. The procedure requires that you know how to perform basic tasks in Windows Forms, such as creating a new project and adding a control to a form.\n\n### To process style changes in a Windows Forms application\n\n1. Create a new Windows Forms project.\n\n2. Create a new class file ending in the extension appropriate for your programming language.\n\n3. Copy the `StyleGenerator` class code in the Example section of this topic into the class file, and save the code.\n\n4. Save the following HTML to a file named Test.htm.\n\n    ```html\n    <HTML>\n        <BODY>\n\n            <DIV style=\"font-face:arial;font-weight:bold;\">\n                Hello, world!\n            </DIV><P>\n\n            <DIV>\n                Hello again, world!\n            </DIV><P>\n\n        </BODY>\n    </HTML>\n    ```\n\n5. Add a <xref:System.Windows.Forms.WebBrowser> control named `webBrowser1` to the main form of your project.\n\n6. Add the following code to your project's code file.\n\n    > [!IMPORTANT]\n    >  Ensure that the `webBrowser1_DocumentCompleted` event hander is configured as a listener for the <xref:System.Windows.Forms.WebBrowser.DocumentCompleted> event. In Visual Studio, double-click on the <xref:System.Windows.Forms.WebBrowser> control; in a text editor, configure the listener programmatically.  \n  \n     [!code-csharp[ManagedDOMStyles#2](~/samples/snippets/csharp/VS_Snippets_Winforms/ManagedDOMStyles/CS/Form1.cs#2)]\n     [!code-vb[ManagedDOMStyles#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ManagedDOMStyles/VB/Form1.vb#2)]  \n  \n7.  Run the project. Run your cursor over the first `DIV` to observe the effects of the code.  \n  \n## Example  \n The following code example shows the full code for the `StyleGenerator` class, which parses an existing style value, supports adding, changing, and removing styles, and returns a new style value with the requested changes.  \n  \n [!code-csharp[ManagedDOMStyles#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ManagedDOMStyles/CS/StyleGenerator.cs#1)]\n [!code-vb[ManagedDOMStyles#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ManagedDOMStyles/VB/StyleGenerator.vb#1)]  \n  \n## See also\n\n- <xref:System.Windows.Forms.HtmlElement>\n","nodes":[{"pos":[4,283],"embed":true,"restype":"x-metadata","content":"title: \"How to: Change Styles on an Element in the Managed HTML Document Object Model\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"managed HTML DOM [Windows Forms], changing styles on elements\"\nms.assetid: 154e8d9f-3e2d-4e8b-a6f3-c85a070e9cc1","nodes":[{"content":"How to: Change Styles on an Element in the Managed HTML Document Object Model","nodes":[{"pos":[0,77],"content":"How to: Change Styles on an Element in the Managed HTML Document Object Model","nodes":[{"content":"How to: Change Styles on an Element in the Managed HTML Document Object Model","pos":[0,77]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[291,368],"content":"How to: Change Styles on an Element in the Managed HTML Document Object Model","linkify":"How to: Change Styles on an Element in the Managed HTML Document Object Model","nodes":[{"content":"How to: Change Styles on an Element in the Managed HTML Document Object Model","pos":[0,77]}]},{"content":"You can use styles in HTML to control the appearance of a document and its elements.","pos":[370,454]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlDocument&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.HtmlElement&gt;</ph> support <ph id=\"ph3\">&lt;xref:System.Windows.Forms.HtmlElement.Style%2A&gt;</ph> properties that take style strings of the following format:","pos":[455,656],"source":"<xref:System.Windows.Forms.HtmlDocument> and <xref:System.Windows.Forms.HtmlElement> support <xref:System.Windows.Forms.HtmlElement.Style%2A> properties that take style strings of the following format:"},{"pos":[692,777],"content":"Here is a <ph id=\"ph1\">`DIV`</ph> with a style string that sets the font to Arial and all text to bold:","source":"Here is a `DIV` with a style string that sets the font to Arial and all text to bold:"},{"content":"The problem with manipulating styles using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlElement.Style%2A&gt;</ph> property is that it can prove cumbersome to add to and remove individual style settings from the string.","pos":[857,1057],"source":"The problem with manipulating styles using the <xref:System.Windows.Forms.HtmlElement.Style%2A> property is that it can prove cumbersome to add to and remove individual style settings from the string."},{"content":"For example, it would become a complex procedure for you to render the previous text in italics whenever the user positions the cursor over the <ph id=\"ph1\">`DIV`</ph>, and take italics off when the cursor leaves the <ph id=\"ph2\">`DIV`</ph>.","pos":[1058,1263],"source":" For example, it would become a complex procedure for you to render the previous text in italics whenever the user positions the cursor over the `DIV`, and take italics off when the cursor leaves the `DIV`."},{"content":"Time would become an issue if you need to manipulate a large number of styles in this manner.","pos":[1264,1357]},{"content":"The following procedure contains code that you can use to easily manipulate styles on HTML documents and elements.","pos":[1359,1473]},{"content":"The procedure requires that you know how to perform basic tasks in Windows Forms, such as creating a new project and adding a control to a form.","pos":[1474,1618]},{"pos":[1624,1679],"content":"To process style changes in a Windows Forms application","linkify":"To process style changes in a Windows Forms application","nodes":[{"content":"To process style changes in a Windows Forms application","pos":[0,55]}]},{"content":"Create a new Windows Forms project.","pos":[1684,1719]},{"content":"Create a new class file ending in the extension appropriate for your programming language.","pos":[1724,1814]},{"pos":[1819,1932],"content":"Copy the <ph id=\"ph1\">`StyleGenerator`</ph> class code in the Example section of this topic into the class file, and save the code.","source":"Copy the `StyleGenerator` class code in the Example section of this topic into the class file, and save the code."},{"content":"Save the following HTML to a file named Test.htm.","pos":[1937,1986]},{"pos":[2257,2363],"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control named <ph id=\"ph2\">`webBrowser1`</ph> to the main form of your project.","source":"Add a <xref:System.Windows.Forms.WebBrowser> control named `webBrowser1` to the main form of your project."},{"content":"Add the following code to your project's code file.","pos":[2368,2419]},{"pos":[2427,2752],"content":"[!IMPORTANT]\nEnsure that the `webBrowser1_DocumentCompleted` event hander is configured as a listener for the <xref:System.Windows.Forms.WebBrowser.DocumentCompleted> event. In Visual Studio, double-click on the <xref:System.Windows.Forms.WebBrowser> control; in a text editor, configure the listener programmatically.","leadings":["","    >  "],"nodes":[{"content":"Ensure that the `webBrowser1_DocumentCompleted` event hander is configured as a listener for the <xref:System.Windows.Forms.WebBrowser.DocumentCompleted> event. In Visual Studio, double-click on the <xref:System.Windows.Forms.WebBrowser> control; in a text editor, configure the listener programmatically.","pos":[13,318],"nodes":[{"content":"Ensure that the <ph id=\"ph1\">`webBrowser1_DocumentCompleted`</ph> event hander is configured as a listener for the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.WebBrowser.DocumentCompleted&gt;</ph> event.","pos":[0,160],"source":"Ensure that the `webBrowser1_DocumentCompleted` event hander is configured as a listener for the <xref:System.Windows.Forms.WebBrowser.DocumentCompleted> event."},{"content":"In Visual Studio, double-click on the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control; in a text editor, configure the listener programmatically.","pos":[161,305],"source":" In Visual Studio, double-click on the <xref:System.Windows.Forms.WebBrowser> control; in a text editor, configure the listener programmatically."}]}]},{"pos":[2763,2996],"content":"[!code-csharp[ManagedDOMStyles#2](~/samples/snippets/csharp/VS_Snippets_Winforms/ManagedDOMStyles/CS/Form1.cs#2)]\n  [!code-vb[ManagedDOMStyles#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ManagedDOMStyles/VB/Form1.vb#2)]","leadings":["","   "],"nodes":[]},{"content":"Run the project.","pos":[3006,3022]},{"content":"Run your cursor over the first <ph id=\"ph1\">`DIV`</ph> to observe the effects of the code.","pos":[3023,3095],"source":" Run your cursor over the first `DIV` to observe the effects of the code."},{"pos":[3104,3111],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3115,3337],"content":"The following code example shows the full code for the <ph id=\"ph1\">`StyleGenerator`</ph> class, which parses an existing style value, supports adding, changing, and removing styles, and returns a new style value with the requested changes.","source":"The following code example shows the full code for the `StyleGenerator` class, which parses an existing style value, supports adding, changing, and removing styles, and returns a new style value with the requested changes."},{"pos":[3600,3608],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]}]}