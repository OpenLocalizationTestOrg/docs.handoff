{"content":"---\ntitle: \"Walkthrough: Hosting a WPF Composite Control in Windows Forms\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords:\n  - \"hosting WPF content in Windows Forms [WPF]\"\nms.assetid: 0ac41286-4c1b-4b17-9196-d985cb844ce1\n---\n# Walkthrough: Hosting a WPF Composite Control in Windows Forms\n[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides a rich environment for creating applications. However, when you have a substantial investment in [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] code, it can be more effective to extend your existing [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] application with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rather than to rewrite it from scratch. A common scenario is when you want to embed one or more controls implemented with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] within your Windows Forms application. For more information about customizing WPF controls, see [Control Customization](../controls/control-customization.md).  \n  \n This walkthrough steps you through an application that hosts a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control to perform data-entry in a Windows Forms application. The composite control is packaged in a DLL. This general procedure can be extended to more complex applications and controls. This walkthrough is designed to be nearly identical in appearance and functionality to [Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md). The primary difference is that the hosting scenario is reversed.  \n  \n The walkthrough is divided into two sections. The first section briefly describes the implementation of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control. The second section discusses in detail how to host the composite control in a Windows Forms application, receive events from the control, and access some of the control’s properties.  \n  \n Tasks illustrated in this walkthrough include:  \n  \n-   Implementing the WPF composite control.  \n  \n-   Implementing the Windows Forms host application.  \n  \n For a complete code listing of the tasks illustrated in this walkthrough, see [Hosting a WPF Composite Control in Windows Forms Sample](https://go.microsoft.com/fwlink/?LinkID=159996).  \n  \n## Prerequisites  \n\nYou need Visual Studio to complete this walkthrough.  \n  \n## Implementing the WPF Composite Control  \n The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control used in this example is a simple data-entry form that takes the user's name and address. When the user clicks one of two buttons to indicate that the task is finished, the control raises a custom event to return that information to the host. The following illustration shows the rendered control. \n\n The following image shows a WPF composite control: \n\n ![Screenshot that shows a simple WPF control.](./media/walkthrough-hosting-a-wpf-composite-control-in-windows-forms/windows-presentation-foundation-composite-control.png)  \n  \n### Creating the Project  \n To start the project:  \n  \n1.  Launch [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)], and open the **New Project** dialog box.  \n  \n2.  In Visual C# and the Windows category, select the **WPF User Control Library** template.  \n  \n3.  Name the new project `MyControls`.  \n  \n4.  For the location, specify a conveniently named top-level folder, such as `WindowsFormsHostingWpfControl`. Later, you will put the host application in this folder.  \n  \n5.  Click **OK** to create the project. The default project contains a single control named `UserControl1`.  \n  \n6.  In Solution Explorer, rename `UserControl1` to `MyControl1`.  \n  \n Your project should have references to the following system DLLs. If any of these DLLs are not included by default, add them to your project.  \n  \n-   PresentationCore  \n  \n-   PresentationFramework  \n  \n-   System  \n  \n-   WindowsBase  \n  \n### Creating the User Interface  \n The [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] for the composite control is implemented with [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]. The composite control [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] consists of five <xref:System.Windows.Controls.TextBox> elements. Each <xref:System.Windows.Controls.TextBox> element has an associated <xref:System.Windows.Controls.TextBlock> element that serves as a label. There are two <xref:System.Windows.Controls.Button> elements at the bottom, **OK** and **Cancel**. When the user clicks either button, the control raises a custom event to return the information to the host.  \n  \n#### Basic Layout  \n The various [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements are contained in a <xref:System.Windows.Controls.Grid> element. You can use <xref:System.Windows.Controls.Grid> to arrange the contents of the composite control in much the same way you would use a `Table` element in HTML. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] also has a <xref:System.Windows.Documents.Table> element, but <xref:System.Windows.Controls.Grid> is more lightweight and better suited for simple layout tasks.  \n  \n The following XAML shows the basic layout. This XAML defines the overall structure of the control by specifying the number of columns and rows in the <xref:System.Windows.Controls.Grid> element.  \n  \n In MyControl1.xaml, replace the existing XAML with the following XAML.  \n  \n [!code-xaml[WindowsFormsHostingWpfControl#101](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/MyControls/Page1.xaml#101)]  \n[!code-xaml[WindowsFormsHostingWpfControl#102](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/MyControls/Page1.xaml#102)]  \n  \n#### Adding TextBlock and TextBox Elements to the Grid  \n You place a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] element in the grid by setting the element's <xref:System.Windows.Controls.Grid.RowProperty> and <xref:System.Windows.Controls.Grid.ColumnProperty> attributes to the appropriate row and column number. Remember that row and column numbering are zero-based. You can have an element span multiple columns by setting its <xref:System.Windows.Controls.Grid.ColumnSpanProperty> attribute. For more information about <xref:System.Windows.Controls.Grid> elements, see [Create a Grid Element](../controls/how-to-create-a-grid-element.md).  \n  \n The following XAML shows the composite control’s <xref:System.Windows.Controls.TextBox> and <xref:System.Windows.Controls.TextBlock> elements with their <xref:System.Windows.Controls.Grid.RowProperty> and <xref:System.Windows.Controls.Grid.ColumnProperty> attributes, which are set to place the elements properly in the grid.  \n  \n In MyControl1.xaml, add the following XAML within the <xref:System.Windows.Controls.Grid> element.  \n  \n [!code-xaml[WindowsFormsHostingWpfControl#103](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/MyControls/Page1.xaml#103)]  \n  \n#### Styling the UI Elements  \n Many of the elements on the data-entry form have a similar appearance, which means that they have identical settings for several of their properties. Rather than setting each element's attributes separately, the previous XAML uses <xref:System.Windows.Style> elements to define standard property settings for classes of elements. This approach reduces the complexity of the control and enables you to change the appearance of multiple elements through a single style attribute.  \n  \n The <xref:System.Windows.Style> elements are contained in the <xref:System.Windows.Controls.Grid> element's <xref:System.Windows.FrameworkElement.Resources%2A> property, so they can be used by all elements in the control. If a style is named, you apply it to an element by adding a <xref:System.Windows.Style> element set to the style's name. Styles that are not named become the default style for the element. For more information about [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] styles, see [Styling and Templating](../controls/styling-and-templating.md).  \n  \n The following XAML shows the <xref:System.Windows.Style> elements for the composite control. To see how the styles are applied to elements, see the previous XAML. For example, the last <xref:System.Windows.Controls.TextBlock> element has the `inlineText` style, and the last <xref:System.Windows.Controls.TextBox> element uses the default style.  \n  \n In MyControl1.xaml, add the following XAML just after the <xref:System.Windows.Controls.Grid> start element.  \n  \n [!code-xaml[WindowsFormsHostingWpfControl#104](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/MyControls/Page1.xaml#104)]  \n  \n#### Adding the OK and Cancel Buttons  \n The final elements on the composite control are the **OK** and **Cancel**<xref:System.Windows.Controls.Button> elements, which occupy the first two columns of the last row of the <xref:System.Windows.Controls.Grid>. These elements use a common event handler, `ButtonClicked`, and the default <xref:System.Windows.Controls.Button> style defined in the previous XAML.  \n  \n In MyControl1.xaml, add the following XAML after the last <xref:System.Windows.Controls.TextBox> element. The [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] part of the composite control is now complete.  \n  \n [!code-xaml[WindowsFormsHostingWpfControl#105](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/MyControls/Page1.xaml#105)]  \n  \n### Implementing the Code-Behind File  \n The code-behind file, MyControl1.xaml.cs, implements three essential tasks:\n  \n1.  Handles the event that occurs when the user clicks one of the buttons.  \n  \n2.  Retrieves the data from the <xref:System.Windows.Controls.TextBox> elements, and packages it in a custom event argument object.  \n  \n3.  Raises the custom `OnButtonClick` event, which notifies the host that the user is finished and passes the data back to the host.  \n  \n The control also exposes a number of color and font properties that enable you to change the appearance. Unlike the <xref:System.Windows.Forms.Integration.WindowsFormsHost> class, which is used to host a Windows Forms control, the <xref:System.Windows.Forms.Integration.ElementHost> class exposes the control’s <xref:System.Windows.Controls.Panel.Background%2A> property only. To maintain the similarity between this code example and the example discussed in [Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md), the control exposes the remaining properties directly.  \n  \n#### The Basic Structure of the Code-Behind File  \n The code-behind file consists of a single namespace, `MyControls`, which will contain two classes, `MyControl1` and `MyControlEventArgs`.  \n  \n```  \nnamespace MyControls  \n{  \n  public partial class MyControl1 : Grid  \n  {  \n    //...  \n  }  \n  public class MyControlEventArgs : EventArgs  \n  {  \n    //...  \n  }  \n}  \n```  \n  \n The first class, `MyControl1`, is a partial class containing the code that implements the functionality of the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] defined in MyControl1.xaml. When MyControl1.xaml is parsed, the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] is converted to the same partial class, and the two partial classes are merged to form the compiled control. For this reason, the class name in the code-behind file must match the class name assigned to MyControl1.xaml, and it must inherit from the root element of the control. The second class, `MyControlEventArgs`, is an event arguments class that is used to send the data back to the host.  \n  \n Open MyControl1.xaml.cs. Change the existing class declaration so that it has the following name and inherits from <xref:System.Windows.Controls.Grid>.  \n  \n [!code-csharp[WindowsFormsHostingWpfControl#21](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/MyControls/Page1.xaml.cs#21)]  \n  \n#### Initializing the Control  \n The following code implements several basic tasks:  \n  \n-   Declares a private event, `OnButtonClick`, and its associated delegate, `MyControlEventHandler`.  \n  \n-   Creates several private global variables that store the user's data. This data is exposed through corresponding properties.  \n  \n-   Implements a handler, `Init`, for the control’s <xref:System.Windows.FrameworkElement.Loaded> event. This handler initializes the global variables by assigning them the values defined in MyControl1.xaml. To do this, it uses the <xref:System.Windows.FrameworkElement.Name%2A> assigned to a typical <xref:System.Windows.Controls.TextBlock> element, `nameLabel`, to access that element's property settings.  \n  \n Delete the existing constructor and add the following code to your `MyControl1` class.  \n  \n [!code-csharp[WindowsFormsHostingWpfControl#11](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/MyControls/Page1.xaml.cs#11)]  \n  \n#### Handling the Buttons' Click Events  \n The user indicates that the data-entry task is finished by clicking either the **OK** button or the **Cancel** button. Both buttons use the same <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, `ButtonClicked`. Both buttons have a name, `btnOK` or `btnCancel`, that enables the handler to determine which button was clicked by examining the value of the `sender` argument. The handler does the following:  \n  \n-   Creates a `MyControlEventArgs` object that contains the data from the <xref:System.Windows.Controls.TextBox> elements.  \n  \n-   If the user clicked the **Cancel** button, sets the `MyControlEventArgs` object's `IsOK` property to `false`.  \n  \n-   Raises the `OnButtonClick` event to indicate to the host that the user is finished, and passes back the collected data.  \n  \n Add the following code to your `MyControl1` class, after the `Init` method.  \n  \n [!code-csharp[WindowsFormsHostingWpfControl#12](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/MyControls/Page1.xaml.cs#12)]  \n  \n#### Creating Properties  \n The remainder of the class simply exposes properties that correspond to the global variables discussed previously. When a property changes, the set accessor modifies the appearance of the control by changing the corresponding element properties and updating the underlying global variables.  \n  \n Add the following code to your `MyControl1` class.  \n  \n [!code-csharp[WindowsFormsHostingWpfControl#13](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/MyControls/Page1.xaml.cs#13)]  \n  \n#### Sending the Data Back to the Host  \n The final component in the file is the `MyControlEventArgs` class, which is used to send the collected data back to the host.  \n  \n Add the following code to your `MyControls` namespace. The implementation is straightforward, and is not discussed further.  \n  \n [!code-csharp[WindowsFormsHostingWpfControl#14](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/MyControls/Page1.xaml.cs#14)]  \n  \n Build the solution. The build will produce a DLL named MyControls.dll.  \n  \n<a name=\"winforms_host_section\"></a>   \n## Implementing the Windows Forms Host Application  \n The Windows Forms host application uses an <xref:System.Windows.Forms.Integration.ElementHost> object to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control. The application handles the `OnButtonClick` event to receive the data from the composite control. The application also has a set of option buttons that you can use to modify the control’s appearance. The following illustration shows the application.  \n\nThe following image shows a WPF composite control hosted in a Windows Forms application\"  \n\n ![Scteenshot that shows a Windows Form Hosting Avalon control.](./media/walkthrough-hosting-a-wpf-composite-control-in-windows-forms/windows-form-hosting-avalon-control.png)  \n  \n### Creating the Project  \n To start the project:  \n  \n1.  Launch [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], and open the **New Project** dialog box.  \n  \n2.  In Visual C# and the Windows category, select  the **Windows Forms Application** template.  \n  \n3.  Name the new project `WFHost`.  \n  \n4.  For the location, specify the same top-level folder that contains the MyControls project.  \n  \n5.  Click **OK** to create the project.  \n  \n You also need to add references to the DLL that contains `MyControl1` and other assemblies.  \n  \n1.  Right-click the project name in Solution Explorer, and select **Add Reference**.  \n  \n2.  Click the **Browse** tab, and browse to the folder that contains MyControls.dll. For this walkthrough, this folder is MyControls\\bin\\Debug.  \n  \n3.  Select MyControls.dll, and then click **OK**.  \n  \n4.  Add references to the following assemblies.  \n  \n    -   PresentationCore  \n  \n    -   PresentationFramework  \n  \n    -   System.Xaml  \n  \n    -   WindowsBase  \n  \n    -   WindowsFormsIntegration  \n  \n### Implementing the User Interface for the Application  \n The UI for the Windows Form application contains several controls to interact with the WPF composite control.  \n  \n1.  Open Form1 in the Windows Form Designer.  \n  \n2.  Enlarge the form to accommodate the controls.  \n  \n3.  In the upper-right corner of the form, add a <xref:System.Windows.Forms.Panel?displayProperty=nameWithType> control to hold the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control.  \n  \n4.  Add the following <xref:System.Windows.Forms.GroupBox?displayProperty=nameWithType> controls to the form.  \n  \n    |Name|Text|  \n    |----------|----------|  \n    |groupBox1|Background Color|  \n    |groupBox2|Foreground Color|  \n    |groupBox3|Font Size|  \n    |groupBox4|Font Family|  \n    |groupBox5|Font Style|  \n    |groupBox6|Font Weight|  \n    |groupBox7|Data from control|  \n  \n5.  Add the following <xref:System.Windows.Forms.RadioButton?displayProperty=nameWithType> controls to the <xref:System.Windows.Forms.GroupBox?displayProperty=nameWithType> controls.  \n  \n    |GroupBox|Name|Text|  \n    |--------------|----------|----------|  \n    |groupBox1|radioBackgroundOriginal|Original|  \n    |groupBox1|radioBackgroundLightGreen|LightGreen|  \n    |groupBox1|radioBackgroundLightSalmon|LightSalmon|  \n    |groupBox2|radioForegroundOriginal|Original|  \n    |groupBox2|radioForegroundRed|Red|  \n    |groupBox2|radioForegroundYellow|Yellow|  \n    |groupBox3|radioSizeOriginal|Original|  \n    |groupBox3|radioSizeTen|10|  \n    |groupBox3|radioSizeTwelve|12|  \n    |groupBox4|radioFamilyOriginal|Original|  \n    |groupBox4|radioFamilyTimes|Times New Roman|  \n    |groupBox4|radioFamilyWingDings|WingDings|  \n    |groupBox5|radioStyleOriginal|Normal|  \n    |groupBox5|radioStyleItalic|Italic|  \n    |groupBox6|radioWeightOriginal|Original|  \n    |groupBox6|radioWeightBold|Bold|  \n  \n6.  Add the following <xref:System.Windows.Forms.Label?displayProperty=nameWithType> controls to the last <xref:System.Windows.Forms.GroupBox?displayProperty=nameWithType>. These controls display the data returned by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control.  \n  \n    |GroupBox|Name|Text|  \n    |--------------|----------|----------|  \n    |groupBox7|lblName|Name:|  \n    |groupBox7|lblAddress|Street Address:|  \n    |groupBox7|lblCity|City:|  \n    |groupBox7|lblState|State:|  \n    |groupBox7|lblZip|Zip:|  \n  \n### Initializing the Form  \n You generally implement the hosting code in the form's <xref:System.Windows.Forms.Form.Load> event handler. The following code shows the <xref:System.Windows.Forms.Form.Load> event handler, a handler for the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control’s <xref:System.Windows.FrameworkElement.Loaded> event, and declarations for several global variables that are used later.  \n  \n In the Windows Forms Designer, double-click the form to create a <xref:System.Windows.Forms.Form.Load> event handler. At the top of Form1.cs, add the following `using` statements.  \n  \n [!code-csharp[WindowsFormsHostingWpfControl#10](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/WFHost/Form1.cs#10)]  \n  \n Replace the contents of the existing `Form1` class with the following code.  \n  \n [!code-csharp[WindowsFormsHostingWpfControl#2](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/WFHost/Form1.cs#2)]  \n  \n The `Form1_Load` method in the preceding code shows the general procedure for hosting a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control:  \n  \n1.  Create a new <xref:System.Windows.Forms.Integration.ElementHost> object.  \n  \n2.  Set the control's <xref:System.Windows.Forms.Control.Dock%2A> property to <xref:System.Windows.Forms.DockStyle.Fill?displayProperty=nameWithType>.  \n  \n3.  Add the <xref:System.Windows.Forms.Integration.ElementHost> control to the <xref:System.Windows.Forms.Panel> control's <xref:System.Windows.Forms.Control.Controls%2A> collection.  \n  \n4.  Create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control.  \n  \n5.  Host the composite control on the form by assigning the control to the <xref:System.Windows.Forms.Integration.ElementHost> control's <xref:System.Windows.Forms.Integration.ElementHost.Child%2A> property.  \n  \n The remaining two lines in the `Form1_Load` method attach handlers to two control events:  \n  \n-   `OnButtonClick` is a custom event that is fired by the composite control when the user clicks the **OK** or **Cancel** button. You handle the event to get the user's response and to collect any data that the user specified.  \n  \n-   <xref:System.Windows.FrameworkElement.Loaded> is a standard event that is raised by a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control when it is fully loaded. The event is used here because the example needs to initialize several global variables using properties from the control. At the time of the form's <xref:System.Windows.Forms.Form.Load> event, the control is not fully loaded and those values are still set to `null`. You need to wait until the control’s <xref:System.Windows.FrameworkElement.Loaded> event occurs before you can access those properties.  \n  \n The <xref:System.Windows.FrameworkElement.Loaded> event handler is shown in the preceding code. The `OnButtonClick` handler is discussed in the next section.  \n  \n### Handling OnButtonClick  \n The `OnButtonClick` event occurs when the user clicks the **OK** or **Cancel** button.  \n  \n The event handler checks the event argument's `IsOK` field to determine which button was clicked. The `lbl`*data* variables correspond to the <xref:System.Windows.Forms.Label> controls that were discussed earlier. If the user clicks the **OK** button, the data from the control’s <xref:System.Windows.Controls.TextBox> controls is assigned to the corresponding <xref:System.Windows.Forms.Label> control. If the user clicks **Cancel**, the <xref:System.Windows.Forms.Label.Text%2A> values are set to the default strings.  \n  \n Add the following button click event handler code to the `Form1` class.  \n  \n [!code-csharp[WindowsFormsHostingWpfControl#3](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/WFHost/Form1.cs#3)]  \n  \n Build and run the application. Add some text in the WPF composite control and then click **OK**. The text appears in the labels. At this point, code has not been added to handle the radio buttons.  \n  \n### Modifying the Appearance of the Control  \n The <xref:System.Windows.Forms.RadioButton> controls on the form will enable the user to change the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control’s foreground and background colors as well as several font properties. The background color is exposed by the <xref:System.Windows.Forms.Integration.ElementHost> object. The remaining properties are exposed as custom properties of the control.  \n  \n Double-click each <xref:System.Windows.Forms.RadioButton> control on the form to create <xref:System.Windows.Forms.RadioButton.CheckedChanged> event handlers. Replace the <xref:System.Windows.Forms.RadioButton.CheckedChanged> event handlers with the following code.  \n  \n [!code-csharp[WindowsFormsHostingWpfControl#4](~/samples/snippets/csharp/VS_Snippets_Wpf/WindowsFormsHostingWpfControl/CSharp/WFHost/Form1.cs#4)]  \n  \n Build and run the application. Click the different radio buttons to see the effect on the WPF composite control.  \n  \n## See also\n\n- <xref:System.Windows.Forms.Integration.ElementHost>\n- <xref:System.Windows.Forms.Integration.WindowsFormsHost>\n- [Design XAML in Visual Studio](/visualstudio/designers/designing-xaml-in-visual-studio)\n- [Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)\n- [Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms](walkthrough-hosting-a-3-d-wpf-composite-control-in-windows-forms.md)\n","nodes":[{"pos":[4,215],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Hosting a WPF Composite Control in Windows Forms\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords:\n  - \"hosting WPF content in Windows Forms [WPF]\"\nms.assetid: 0ac41286-4c1b-4b17-9196-d985cb844ce1","nodes":[{"content":"Walkthrough: Hosting a WPF Composite Control in Windows Forms","nodes":[{"pos":[0,61],"content":"Walkthrough: Hosting a WPF Composite Control in Windows Forms","nodes":[{"content":"Walkthrough: Hosting a WPF Composite Control in Windows Forms","pos":[0,61]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[222,283],"content":"Walkthrough: Hosting a WPF Composite Control in Windows Forms","linkify":"Walkthrough: Hosting a WPF Composite Control in Windows Forms","nodes":[{"content":"Walkthrough: Hosting a WPF Composite Control in Windows Forms","pos":[0,61]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> provides a rich environment for creating applications.","pos":[284,418],"source":"[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides a rich environment for creating applications."},{"content":"However, when you have a substantial investment in <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> code, it can be more effective to extend your existing <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> application with <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> rather than to rewrite it from scratch.","pos":[419,819],"source":" However, when you have a substantial investment in [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] code, it can be more effective to extend your existing [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] application with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rather than to rewrite it from scratch."},{"content":"A common scenario is when you want to embed one or more controls implemented with <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> within your Windows Forms application.","pos":[820,1022],"source":" A common scenario is when you want to embed one or more controls implemented with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] within your Windows Forms application."},{"content":"For more information about customizing WPF controls, see <bpt id=\"p1\">[</bpt>Control Customization<ept id=\"p1\">](../controls/control-customization.md)</ept>.","pos":[1023,1142],"source":" For more information about customizing WPF controls, see [Control Customization](../controls/control-customization.md)."},{"content":"This walkthrough steps you through an application that hosts a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> composite control to perform data-entry in a Windows Forms application.","pos":[1149,1365],"source":"This walkthrough steps you through an application that hosts a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control to perform data-entry in a Windows Forms application."},{"content":"The composite control is packaged in a DLL.","pos":[1366,1409]},{"content":"This general procedure can be extended to more complex applications and controls.","pos":[1410,1491]},{"content":"This walkthrough is designed to be nearly identical in appearance and functionality to <bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Composite Control in WPF<ept id=\"p1\">](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)</ept>.","pos":[1492,1708],"source":" This walkthrough is designed to be nearly identical in appearance and functionality to [Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)."},{"content":"The primary difference is that the hosting scenario is reversed.","pos":[1709,1773]},{"content":"The walkthrough is divided into two sections.","pos":[1780,1825]},{"content":"The first section briefly describes the implementation of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> composite control.","pos":[1826,1988],"source":" The first section briefly describes the implementation of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control."},{"content":"The second section discusses in detail how to host the composite control in a Windows Forms application, receive events from the control, and access some of the control’s properties.","pos":[1989,2171]},{"content":"Tasks illustrated in this walkthrough include:","pos":[2178,2224]},{"content":"Implementing the WPF composite control.","pos":[2234,2273]},{"content":"Implementing the Windows Forms host application.","pos":[2283,2331]},{"pos":[2338,2522],"content":"For a complete code listing of the tasks illustrated in this walkthrough, see <bpt id=\"p1\">[</bpt>Hosting a WPF Composite Control in Windows Forms Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159996)</ept>.","source":"For a complete code listing of the tasks illustrated in this walkthrough, see [Hosting a WPF Composite Control in Windows Forms Sample](https://go.microsoft.com/fwlink/?LinkID=159996)."},{"pos":[2531,2544],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need Visual Studio to complete this walkthrough.","pos":[2548,2600]},{"pos":[2609,2647],"content":"Implementing the WPF Composite Control","linkify":"Implementing the WPF Composite Control","nodes":[{"content":"Implementing the WPF Composite Control","pos":[0,38]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> composite control used in this example is a simple data-entry form that takes the user's name and address.","pos":[2651,2843],"source":"The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control used in this example is a simple data-entry form that takes the user's name and address."},{"content":"When the user clicks one of two buttons to indicate that the task is finished, the control raises a custom event to return that information to the host.","pos":[2844,2996]},{"content":"The following illustration shows the rendered control.","pos":[2997,3051]},{"content":"The following image shows a WPF composite control:","pos":[3055,3105]},{"content":"Screenshot that shows a simple WPF control.","pos":[3111,3154]},{"pos":[3289,3309],"content":"Creating the Project","linkify":"Creating the Project","nodes":[{"content":"Creating the Project","pos":[0,20]}]},{"content":"To start the project:","pos":[3313,3334]},{"pos":[3344,3472],"content":"Launch <ph id=\"ph1\">[!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)]</ph>, and open the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box.","source":"Launch [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)], and open the **New Project** dialog box."},{"pos":[3482,3570],"content":"In Visual C# and the Windows category, select the <bpt id=\"p1\">**</bpt>WPF User Control Library<ept id=\"p1\">**</ept> template.","source":"In Visual C# and the Windows category, select the **WPF User Control Library** template."},{"pos":[3580,3614],"content":"Name the new project <ph id=\"ph1\">`MyControls`</ph>.","source":"Name the new project `MyControls`."},{"content":"For the location, specify a conveniently named top-level folder, such as <ph id=\"ph1\">`WindowsFormsHostingWpfControl`</ph>.","pos":[3624,3729],"source":"For the location, specify a conveniently named top-level folder, such as `WindowsFormsHostingWpfControl`."},{"content":"Later, you will put the host application in this folder.","pos":[3730,3786]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to create the project.","pos":[3796,3831],"source":"Click **OK** to create the project."},{"content":"The default project contains a single control named <ph id=\"ph1\">`UserControl1`</ph>.","pos":[3832,3899],"source":" The default project contains a single control named `UserControl1`."},{"pos":[3909,3969],"content":"In Solution Explorer, rename <ph id=\"ph1\">`UserControl1`</ph> to <ph id=\"ph2\">`MyControl1`</ph>.","source":"In Solution Explorer, rename `UserControl1` to `MyControl1`."},{"content":"Your project should have references to the following system DLLs.","pos":[3976,4041]},{"content":"If any of these DLLs are not included by default, add them to your project.","pos":[4042,4117]},{"content":"PresentationCore","pos":[4127,4143]},{"content":"PresentationFramework","pos":[4153,4174]},{"content":"System","pos":[4184,4190]},{"content":"WindowsBase","pos":[4200,4211]},{"pos":[4221,4248],"content":"Creating the User Interface","linkify":"Creating the User Interface","nodes":[{"content":"Creating the User Interface","pos":[0,27]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph> for the composite control is implemented with <ph id=\"ph2\">[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]</ph>.","pos":[4252,4438],"source":"The [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] for the composite control is implemented with [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]."},{"content":"The composite control <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> consists of five <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> elements.","pos":[4439,4594],"source":" The composite control [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] consists of five <xref:System.Windows.Controls.TextBox> elements."},{"content":"Each <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> element has an associated <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> element that serves as a label.","pos":[4595,4737],"source":" Each <xref:System.Windows.Controls.TextBox> element has an associated <xref:System.Windows.Controls.TextBlock> element that serves as a label."},{"content":"There are two <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button&gt;</ph> elements at the bottom, <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept>.","pos":[4738,4836],"source":" There are two <xref:System.Windows.Controls.Button> elements at the bottom, **OK** and **Cancel**."},{"content":"When the user clicks either button, the control raises a custom event to return the information to the host.","pos":[4837,4945]},{"pos":[4956,4968],"content":"Basic Layout","linkify":"Basic Layout","nodes":[{"content":"Basic Layout","pos":[0,12]}]},{"content":"The various <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> elements are contained in a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[4972,5124],"source":"The various [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements are contained in a <xref:System.Windows.Controls.Grid> element."},{"content":"You can use <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> to arrange the contents of the composite control in much the same way you would use a <ph id=\"ph2\">`Table`</ph> element in HTML.","pos":[5125,5283],"source":" You can use <xref:System.Windows.Controls.Grid> to arrange the contents of the composite control in much the same way you would use a `Table` element in HTML."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> also has a <ph id=\"ph2\">&lt;xref:System.Windows.Documents.Table&gt;</ph> element, but <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> is more lightweight and better suited for simple layout tasks.","pos":[5284,5526],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] also has a <xref:System.Windows.Documents.Table> element, but <xref:System.Windows.Controls.Grid> is more lightweight and better suited for simple layout tasks."},{"content":"The following XAML shows the basic layout.","pos":[5533,5575]},{"content":"This XAML defines the overall structure of the control by specifying the number of columns and rows in the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[5576,5727],"source":" This XAML defines the overall structure of the control by specifying the number of columns and rows in the <xref:System.Windows.Controls.Grid> element."},{"content":"In MyControl1.xaml, replace the existing XAML with the following XAML.","pos":[5734,5804]},{"pos":[6131,6180],"content":"Adding TextBlock and TextBox Elements to the Grid","linkify":"Adding TextBlock and TextBox Elements to the Grid","nodes":[{"content":"Adding TextBlock and TextBox Elements to the Grid","pos":[0,49]}]},{"content":"You place a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> element in the grid by setting the element's <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Grid.RowProperty&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Grid.ColumnProperty&gt;</ph> attributes to the appropriate row and column number.","pos":[6184,6464],"source":"You place a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] element in the grid by setting the element's <xref:System.Windows.Controls.Grid.RowProperty> and <xref:System.Windows.Controls.Grid.ColumnProperty> attributes to the appropriate row and column number."},{"content":"Remember that row and column numbering are zero-based.","pos":[6465,6519]},{"content":"You can have an element span multiple columns by setting its <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid.ColumnSpanProperty&gt;</ph> attribute.","pos":[6520,6646],"source":" You can have an element span multiple columns by setting its <xref:System.Windows.Controls.Grid.ColumnSpanProperty> attribute."},{"content":"For more information about <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> elements, see <bpt id=\"p1\">[</bpt>Create a Grid Element<ept id=\"p1\">](../controls/how-to-create-a-grid-element.md)</ept>.","pos":[6647,6793],"source":" For more information about <xref:System.Windows.Controls.Grid> elements, see [Create a Grid Element](../controls/how-to-create-a-grid-element.md)."},{"pos":[6800,7125],"content":"The following XAML shows the composite control’s <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> elements with their <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Grid.RowProperty&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.Controls.Grid.ColumnProperty&gt;</ph> attributes, which are set to place the elements properly in the grid.","source":"The following XAML shows the composite control’s <xref:System.Windows.Controls.TextBox> and <xref:System.Windows.Controls.TextBlock> elements with their <xref:System.Windows.Controls.Grid.RowProperty> and <xref:System.Windows.Controls.Grid.ColumnProperty> attributes, which are set to place the elements properly in the grid."},{"pos":[7132,7230],"content":"In MyControl1.xaml, add the following XAML within the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","source":"In MyControl1.xaml, add the following XAML within the <xref:System.Windows.Controls.Grid> element."},{"pos":[7401,7424],"content":"Styling the UI Elements","linkify":"Styling the UI Elements","nodes":[{"content":"Styling the UI Elements","pos":[0,23]}]},{"content":"Many of the elements on the data-entry form have a similar appearance, which means that they have identical settings for several of their properties.","pos":[7428,7577]},{"content":"Rather than setting each element's attributes separately, the previous XAML uses <ph id=\"ph1\">&lt;xref:System.Windows.Style&gt;</ph> elements to define standard property settings for classes of elements.","pos":[7578,7757],"source":" Rather than setting each element's attributes separately, the previous XAML uses <xref:System.Windows.Style> elements to define standard property settings for classes of elements."},{"content":"This approach reduces the complexity of the control and enables you to change the appearance of multiple elements through a single style attribute.","pos":[7758,7905]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Style&gt;</ph> elements are contained in the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element's <ph id=\"ph3\">&lt;xref:System.Windows.FrameworkElement.Resources%2A&gt;</ph> property, so they can be used by all elements in the control.","pos":[7912,8133],"source":"The <xref:System.Windows.Style> elements are contained in the <xref:System.Windows.Controls.Grid> element's <xref:System.Windows.FrameworkElement.Resources%2A> property, so they can be used by all elements in the control."},{"content":"If a style is named, you apply it to an element by adding a <ph id=\"ph1\">&lt;xref:System.Windows.Style&gt;</ph> element set to the style's name.","pos":[8134,8254],"source":" If a style is named, you apply it to an element by adding a <xref:System.Windows.Style> element set to the style's name."},{"content":"Styles that are not named become the default style for the element.","pos":[8255,8322]},{"content":"For more information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> styles, see <bpt id=\"p1\">[</bpt>Styling and Templating<ept id=\"p1\">](../controls/styling-and-templating.md)</ept>.","pos":[8323,8508],"source":" For more information about [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] styles, see [Styling and Templating](../controls/styling-and-templating.md)."},{"content":"The following XAML shows the <ph id=\"ph1\">&lt;xref:System.Windows.Style&gt;</ph> elements for the composite control.","pos":[8515,8607],"source":"The following XAML shows the <xref:System.Windows.Style> elements for the composite control."},{"content":"To see how the styles are applied to elements, see the previous XAML.","pos":[8608,8677]},{"content":"For example, the last <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> element has the <ph id=\"ph2\">`inlineText`</ph> style, and the last <ph id=\"ph3\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> element uses the default style.","pos":[8678,8860],"source":" For example, the last <xref:System.Windows.Controls.TextBlock> element has the `inlineText` style, and the last <xref:System.Windows.Controls.TextBox> element uses the default style."},{"pos":[8867,8975],"content":"In MyControl1.xaml, add the following XAML just after the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> start element.","source":"In MyControl1.xaml, add the following XAML just after the <xref:System.Windows.Controls.Grid> start element."},{"pos":[9146,9178],"content":"Adding the OK and Cancel Buttons","linkify":"Adding the OK and Cancel Buttons","nodes":[{"content":"Adding the OK and Cancel Buttons","pos":[0,32]}]},{"content":"The final elements on the composite control are the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept><ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button&gt;</ph> elements, which occupy the first two columns of the last row of the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Grid&gt;</ph>.","pos":[9182,9397],"source":"The final elements on the composite control are the **OK** and **Cancel**<xref:System.Windows.Controls.Button> elements, which occupy the first two columns of the last row of the <xref:System.Windows.Controls.Grid>."},{"content":"These elements use a common event handler, <ph id=\"ph1\">`ButtonClicked`</ph>, and the default <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Button&gt;</ph> style defined in the previous XAML.","pos":[9398,9547],"source":" These elements use a common event handler, `ButtonClicked`, and the default <xref:System.Windows.Controls.Button> style defined in the previous XAML."},{"content":"In MyControl1.xaml, add the following XAML after the last <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> element.","pos":[9554,9659],"source":"In MyControl1.xaml, add the following XAML after the last <xref:System.Windows.Controls.TextBox> element."},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> part of the composite control is now complete.","pos":[9660,9782],"source":" The [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] part of the composite control is now complete."},{"pos":[9952,9985],"content":"Implementing the Code-Behind File","linkify":"Implementing the Code-Behind File","nodes":[{"content":"Implementing the Code-Behind File","pos":[0,33]}]},{"content":"The code-behind file, MyControl1.xaml.cs, implements three essential tasks:","pos":[9989,10064]},{"content":"Handles the event that occurs when the user clicks one of the buttons.","pos":[10072,10142]},{"pos":[10152,10279],"content":"Retrieves the data from the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> elements, and packages it in a custom event argument object.","source":"Retrieves the data from the <xref:System.Windows.Controls.TextBox> elements, and packages it in a custom event argument object."},{"pos":[10289,10417],"content":"Raises the custom <ph id=\"ph1\">`OnButtonClick`</ph> event, which notifies the host that the user is finished and passes the data back to the host.","source":"Raises the custom `OnButtonClick` event, which notifies the host that the user is finished and passes the data back to the host."},{"content":"The control also exposes a number of color and font properties that enable you to change the appearance.","pos":[10424,10528]},{"content":"Unlike the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> class, which is used to host a Windows Forms control, the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> class exposes the control’s <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Panel.Background%2A&gt;</ph> property only.","pos":[10529,10800],"source":" Unlike the <xref:System.Windows.Forms.Integration.WindowsFormsHost> class, which is used to host a Windows Forms control, the <xref:System.Windows.Forms.Integration.ElementHost> class exposes the control’s <xref:System.Windows.Controls.Panel.Background%2A> property only."},{"content":"To maintain the similarity between this code example and the example discussed in <bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Composite Control in WPF<ept id=\"p1\">](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)</ept>, the control exposes the remaining properties directly.","pos":[10801,11067],"source":" To maintain the similarity between this code example and the example discussed in [Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md), the control exposes the remaining properties directly."},{"pos":[11078,11121],"content":"The Basic Structure of the Code-Behind File","linkify":"The Basic Structure of the Code-Behind File","nodes":[{"content":"The Basic Structure of the Code-Behind File","pos":[0,43]}]},{"pos":[11125,11262],"content":"The code-behind file consists of a single namespace, <ph id=\"ph1\">`MyControls`</ph>, which will contain two classes, <ph id=\"ph2\">`MyControl1`</ph> and <ph id=\"ph3\">`MyControlEventArgs`</ph>.","source":"The code-behind file consists of a single namespace, `MyControls`, which will contain two classes, `MyControl1` and `MyControlEventArgs`."},{"content":"The first class, <ph id=\"ph1\">`MyControl1`</ph>, is a partial class containing the code that implements the functionality of the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> defined in MyControl1.xaml.","pos":[11454,11660],"source":"The first class, `MyControl1`, is a partial class containing the code that implements the functionality of the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] defined in MyControl1.xaml."},{"content":"When MyControl1.xaml is parsed, the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> is converted to the same partial class, and the two partial classes are merged to form the compiled control.","pos":[11661,11877],"source":" When MyControl1.xaml is parsed, the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] is converted to the same partial class, and the two partial classes are merged to form the compiled control."},{"content":"For this reason, the class name in the code-behind file must match the class name assigned to MyControl1.xaml, and it must inherit from the root element of the control.","pos":[11878,12046]},{"content":"The second class, <ph id=\"ph1\">`MyControlEventArgs`</ph>, is an event arguments class that is used to send the data back to the host.","pos":[12047,12162],"source":" The second class, `MyControlEventArgs`, is an event arguments class that is used to send the data back to the host."},{"content":"Open MyControl1.xaml.cs.","pos":[12169,12193]},{"content":"Change the existing class declaration so that it has the following name and inherits from <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph>.","pos":[12194,12320],"source":" Change the existing class declaration so that it has the following name and inherits from <xref:System.Windows.Controls.Grid>."},{"pos":[12494,12518],"content":"Initializing the Control","linkify":"Initializing the Control","nodes":[{"content":"Initializing the Control","pos":[0,24]}]},{"content":"The following code implements several basic tasks:","pos":[12522,12572]},{"pos":[12582,12678],"content":"Declares a private event, <ph id=\"ph1\">`OnButtonClick`</ph>, and its associated delegate, <ph id=\"ph2\">`MyControlEventHandler`</ph>.","source":"Declares a private event, `OnButtonClick`, and its associated delegate, `MyControlEventHandler`."},{"content":"Creates several private global variables that store the user's data.","pos":[12688,12756]},{"content":"This data is exposed through corresponding properties.","pos":[12757,12811]},{"content":"Implements a handler, <ph id=\"ph1\">`Init`</ph>, for the control’s <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event.","pos":[12821,12921],"source":"Implements a handler, `Init`, for the control’s <xref:System.Windows.FrameworkElement.Loaded> event."},{"content":"This handler initializes the global variables by assigning them the values defined in MyControl1.xaml.","pos":[12922,13024]},{"content":"To do this, it uses the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Name%2A&gt;</ph> assigned to a typical <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> element, <ph id=\"ph3\">`nameLabel`</ph>, to access that element's property settings.","pos":[13025,13224],"source":" To do this, it uses the <xref:System.Windows.FrameworkElement.Name%2A> assigned to a typical <xref:System.Windows.Controls.TextBlock> element, `nameLabel`, to access that element's property settings."},{"pos":[13231,13317],"content":"Delete the existing constructor and add the following code to your <ph id=\"ph1\">`MyControl1`</ph> class.","source":"Delete the existing constructor and add the following code to your `MyControl1` class."},{"pos":[13491,13525],"content":"Handling the Buttons' Click Events","linkify":"Handling the Buttons' Click Events","nodes":[{"content":"Handling the Buttons' Click Events","pos":[0,34]}]},{"content":"The user indicates that the data-entry task is finished by clicking either the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button or the <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> button.","pos":[13529,13647],"source":"The user indicates that the data-entry task is finished by clicking either the **OK** button or the **Cancel** button."},{"content":"Both buttons use the same <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase.Click&gt;</ph> event handler, <ph id=\"ph2\">`ButtonClicked`</ph>.","pos":[13648,13764],"source":" Both buttons use the same <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, `ButtonClicked`."},{"content":"Both buttons have a name, <ph id=\"ph1\">`btnOK`</ph> or <ph id=\"ph2\">`btnCancel`</ph>, that enables the handler to determine which button was clicked by examining the value of the <ph id=\"ph3\">`sender`</ph> argument.","pos":[13765,13926],"source":" Both buttons have a name, `btnOK` or `btnCancel`, that enables the handler to determine which button was clicked by examining the value of the `sender` argument."},{"content":"The handler does the following:","pos":[13927,13958]},{"pos":[13968,14086],"content":"Creates a <ph id=\"ph1\">`MyControlEventArgs`</ph> object that contains the data from the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> elements.","source":"Creates a `MyControlEventArgs` object that contains the data from the <xref:System.Windows.Controls.TextBox> elements."},{"pos":[14096,14205],"content":"If the user clicked the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button, sets the <ph id=\"ph1\">`MyControlEventArgs`</ph> object's <ph id=\"ph2\">`IsOK`</ph> property to <ph id=\"ph3\">`false`</ph>.","source":"If the user clicked the **Cancel** button, sets the `MyControlEventArgs` object's `IsOK` property to `false`."},{"pos":[14215,14334],"content":"Raises the <ph id=\"ph1\">`OnButtonClick`</ph> event to indicate to the host that the user is finished, and passes back the collected data.","source":"Raises the `OnButtonClick` event to indicate to the host that the user is finished, and passes back the collected data."},{"pos":[14341,14416],"content":"Add the following code to your <ph id=\"ph1\">`MyControl1`</ph> class, after the <ph id=\"ph2\">`Init`</ph> method.","source":"Add the following code to your `MyControl1` class, after the `Init` method."},{"pos":[14590,14609],"content":"Creating Properties","linkify":"Creating Properties","nodes":[{"content":"Creating Properties","pos":[0,19]}]},{"content":"The remainder of the class simply exposes properties that correspond to the global variables discussed previously.","pos":[14613,14727]},{"content":"When a property changes, the set accessor modifies the appearance of the control by changing the corresponding element properties and updating the underlying global variables.","pos":[14728,14903]},{"pos":[14910,14960],"content":"Add the following code to your <ph id=\"ph1\">`MyControl1`</ph> class.","source":"Add the following code to your `MyControl1` class."},{"pos":[15134,15167],"content":"Sending the Data Back to the Host","linkify":"Sending the Data Back to the Host","nodes":[{"content":"Sending the Data Back to the Host","pos":[0,33]}]},{"pos":[15171,15296],"content":"The final component in the file is the <ph id=\"ph1\">`MyControlEventArgs`</ph> class, which is used to send the collected data back to the host.","source":"The final component in the file is the `MyControlEventArgs` class, which is used to send the collected data back to the host."},{"content":"Add the following code to your <ph id=\"ph1\">`MyControls`</ph> namespace.","pos":[15303,15357],"source":"Add the following code to your `MyControls` namespace."},{"content":"The implementation is straightforward, and is not discussed further.","pos":[15358,15426]},{"content":"Build the solution.","pos":[15596,15615]},{"content":"The build will produce a DLL named MyControls.dll.","pos":[15616,15666]},{"pos":[15715,15762],"content":"Implementing the Windows Forms Host Application","linkify":"Implementing the Windows Forms Host Application","nodes":[{"content":"Implementing the Windows Forms Host Application","pos":[0,47]}]},{"content":"The Windows Forms host application uses an <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> object to host the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> composite control.","pos":[15766,15980],"source":"The Windows Forms host application uses an <xref:System.Windows.Forms.Integration.ElementHost> object to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control."},{"content":"The application handles the <ph id=\"ph1\">`OnButtonClick`</ph> event to receive the data from the composite control.","pos":[15981,16078],"source":" The application handles the `OnButtonClick` event to receive the data from the composite control."},{"content":"The application also has a set of option buttons that you can use to modify the control’s appearance.","pos":[16079,16180]},{"content":"The following illustration shows the application.","pos":[16181,16230]},{"content":"The following image shows a WPF composite control hosted in a Windows Forms application\"","pos":[16234,16322]},{"content":"Scteenshot that shows a Windows Form Hosting Avalon control.","pos":[16329,16389]},{"pos":[16510,16530],"content":"Creating the Project","linkify":"Creating the Project","nodes":[{"content":"Creating the Project","pos":[0,20]}]},{"content":"To start the project:","pos":[16534,16555]},{"pos":[16565,16695],"content":"Launch <ph id=\"ph1\">[!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)]</ph>, and open the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box.","source":"Launch [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], and open the **New Project** dialog box."},{"pos":[16705,16795],"content":"In Visual C# and the Windows category, select  the <bpt id=\"p1\">**</bpt>Windows Forms Application<ept id=\"p1\">**</ept> template.","source":"In Visual C# and the Windows category, select  the **Windows Forms Application** template."},{"pos":[16805,16835],"content":"Name the new project <ph id=\"ph1\">`WFHost`</ph>.","source":"Name the new project `WFHost`."},{"content":"For the location, specify the same top-level folder that contains the MyControls project.","pos":[16845,16934]},{"pos":[16944,16979],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to create the project.","source":"Click **OK** to create the project."},{"pos":[16986,17077],"content":"You also need to add references to the DLL that contains <ph id=\"ph1\">`MyControl1`</ph> and other assemblies.","source":"You also need to add references to the DLL that contains `MyControl1` and other assemblies."},{"pos":[17087,17167],"content":"Right-click the project name in Solution Explorer, and select <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept>.","source":"Right-click the project name in Solution Explorer, and select **Add Reference**."},{"content":"Click the <bpt id=\"p1\">**</bpt>Browse<ept id=\"p1\">**</ept> tab, and browse to the folder that contains MyControls.dll.","pos":[17177,17257],"source":"Click the **Browse** tab, and browse to the folder that contains MyControls.dll."},{"content":"For this walkthrough, this folder is MyControls\\bin\\Debug.","pos":[17258,17316]},{"pos":[17326,17371],"content":"Select MyControls.dll, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Select MyControls.dll, and then click **OK**."},{"content":"Add references to the following assemblies.","pos":[17381,17424]},{"content":"PresentationCore","pos":[17438,17454]},{"content":"PresentationFramework","pos":[17468,17489]},{"content":"System.Xaml","pos":[17503,17514]},{"content":"WindowsBase","pos":[17528,17539]},{"content":"WindowsFormsIntegration","pos":[17553,17576]},{"pos":[17586,17637],"content":"Implementing the User Interface for the Application","linkify":"Implementing the User Interface for the Application","nodes":[{"content":"Implementing the User Interface for the Application","pos":[0,51]}]},{"content":"The UI for the Windows Form application contains several controls to interact with the WPF composite control.","pos":[17641,17750]},{"content":"Open Form1 in the Windows Form Designer.","pos":[17760,17800]},{"content":"Enlarge the form to accommodate the controls.","pos":[17810,17855]},{"pos":[17865,18093],"content":"In the upper-right corner of the form, add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Panel?displayProperty=nameWithType&gt;</ph> control to hold the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> composite control.","source":"In the upper-right corner of the form, add a <xref:System.Windows.Forms.Panel?displayProperty=nameWithType> control to hold the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control."},{"pos":[18103,18208],"content":"Add the following <ph id=\"ph1\">&lt;xref:System.Windows.Forms.GroupBox?displayProperty=nameWithType&gt;</ph> controls to the form.","source":"Add the following <xref:System.Windows.Forms.GroupBox?displayProperty=nameWithType> controls to the form."},{"content":"Name","pos":[18219,18223]},{"content":"Text","pos":[18224,18228]},{"content":"groupBox1","pos":[18267,18276]},{"content":"Background Color","pos":[18277,18293]},{"content":"groupBox2","pos":[18302,18311]},{"content":"Foreground Color","pos":[18312,18328]},{"content":"groupBox3","pos":[18337,18346]},{"content":"Font Size","pos":[18347,18356]},{"content":"groupBox4","pos":[18365,18374]},{"content":"Font Family","pos":[18375,18386]},{"content":"groupBox5","pos":[18395,18404]},{"content":"Font Style","pos":[18405,18415]},{"content":"groupBox6","pos":[18424,18433]},{"content":"Font Weight","pos":[18434,18445]},{"content":"groupBox7","pos":[18454,18463]},{"content":"Data from control","pos":[18464,18481]},{"pos":[18492,18670],"content":"Add the following <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RadioButton?displayProperty=nameWithType&gt;</ph> controls to the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.GroupBox?displayProperty=nameWithType&gt;</ph> controls.","source":"Add the following <xref:System.Windows.Forms.RadioButton?displayProperty=nameWithType> controls to the <xref:System.Windows.Forms.GroupBox?displayProperty=nameWithType> controls."},{"content":"GroupBox","pos":[18681,18689]},{"content":"Name","pos":[18690,18694]},{"content":"Text","pos":[18695,18699]},{"content":"groupBox1","pos":[18753,18762]},{"content":"radioBackgroundOriginal","pos":[18763,18786]},{"content":"Original","pos":[18787,18795]},{"content":"groupBox1","pos":[18804,18813]},{"content":"radioBackgroundLightGreen","pos":[18814,18839]},{"content":"LightGreen","pos":[18840,18850]},{"content":"groupBox1","pos":[18859,18868]},{"content":"radioBackgroundLightSalmon","pos":[18869,18895]},{"content":"LightSalmon","pos":[18896,18907]},{"content":"groupBox2","pos":[18916,18925]},{"content":"radioForegroundOriginal","pos":[18926,18949]},{"content":"Original","pos":[18950,18958]},{"content":"groupBox2","pos":[18967,18976]},{"content":"radioForegroundRed","pos":[18977,18995]},{"content":"Red","pos":[18996,18999]},{"content":"groupBox2","pos":[19008,19017]},{"content":"radioForegroundYellow","pos":[19018,19039]},{"content":"Yellow","pos":[19040,19046]},{"content":"groupBox3","pos":[19055,19064]},{"content":"radioSizeOriginal","pos":[19065,19082]},{"content":"Original","pos":[19083,19091]},{"content":"groupBox3","pos":[19100,19109]},{"content":"radioSizeTen","pos":[19110,19122]},{"content":"10","pos":[19123,19125]},{"content":"groupBox3","pos":[19134,19143]},{"content":"radioSizeTwelve","pos":[19144,19159]},{"content":"12","pos":[19160,19162]},{"content":"groupBox4","pos":[19171,19180]},{"content":"radioFamilyOriginal","pos":[19181,19200]},{"content":"Original","pos":[19201,19209]},{"content":"groupBox4","pos":[19218,19227]},{"content":"radioFamilyTimes","pos":[19228,19244]},{"content":"Times New Roman","pos":[19245,19260]},{"content":"groupBox4","pos":[19269,19278]},{"content":"radioFamilyWingDings","pos":[19279,19299]},{"content":"WingDings","pos":[19300,19309]},{"content":"groupBox5","pos":[19318,19327]},{"content":"radioStyleOriginal","pos":[19328,19346]},{"content":"Normal","pos":[19347,19353]},{"content":"groupBox5","pos":[19362,19371]},{"content":"radioStyleItalic","pos":[19372,19388]},{"content":"Italic","pos":[19389,19395]},{"content":"groupBox6","pos":[19404,19413]},{"content":"radioWeightOriginal","pos":[19414,19433]},{"content":"Original","pos":[19434,19442]},{"content":"groupBox6","pos":[19451,19460]},{"content":"radioWeightBold","pos":[19461,19476]},{"content":"Bold","pos":[19477,19481]},{"content":"Add the following <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Label?displayProperty=nameWithType&gt;</ph> controls to the last <ph id=\"ph2\">&lt;xref:System.Windows.Forms.GroupBox?displayProperty=nameWithType&gt;</ph>.","pos":[19492,19660],"source":"Add the following <xref:System.Windows.Forms.Label?displayProperty=nameWithType> controls to the last <xref:System.Windows.Forms.GroupBox?displayProperty=nameWithType>."},{"content":"These controls display the data returned by the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> composite control.","pos":[19661,19809],"source":" These controls display the data returned by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control."},{"content":"GroupBox","pos":[19820,19828]},{"content":"Name","pos":[19829,19833]},{"content":"Text","pos":[19834,19838]},{"content":"groupBox7","pos":[19892,19901]},{"content":"lblName","pos":[19902,19909]},{"content":"Name:","pos":[19910,19915]},{"content":"groupBox7","pos":[19924,19933]},{"content":"lblAddress","pos":[19934,19944]},{"content":"Street Address:","pos":[19945,19960]},{"content":"groupBox7","pos":[19969,19978]},{"content":"lblCity","pos":[19979,19986]},{"content":"City:","pos":[19987,19992]},{"content":"groupBox7","pos":[20001,20010]},{"content":"lblState","pos":[20011,20019]},{"content":"State:","pos":[20020,20026]},{"content":"groupBox7","pos":[20035,20044]},{"content":"lblZip","pos":[20045,20051]},{"content":"Zip:","pos":[20052,20056]},{"pos":[20067,20088],"content":"Initializing the Form","linkify":"Initializing the Form","nodes":[{"content":"Initializing the Form","pos":[0,21]}]},{"content":"You generally implement the hosting code in the form's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.Load&gt;</ph> event handler.","pos":[20092,20199],"source":"You generally implement the hosting code in the form's <xref:System.Windows.Forms.Form.Load> event handler."},{"content":"The following code shows the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.Load&gt;</ph> event handler, a handler for the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> composite control’s <ph id=\"ph3\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event, and declarations for several global variables that are used later.","pos":[20200,20521],"source":" The following code shows the <xref:System.Windows.Forms.Form.Load> event handler, a handler for the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control’s <xref:System.Windows.FrameworkElement.Loaded> event, and declarations for several global variables that are used later."},{"content":"In the Windows Forms Designer, double-click the form to create a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.Load&gt;</ph> event handler.","pos":[20528,20645],"source":"In the Windows Forms Designer, double-click the form to create a <xref:System.Windows.Forms.Form.Load> event handler."},{"content":"At the top of Form1.cs, add the following <ph id=\"ph1\">`using`</ph> statements.","pos":[20646,20707],"source":" At the top of Form1.cs, add the following `using` statements."},{"pos":[20868,20943],"content":"Replace the contents of the existing <ph id=\"ph1\">`Form1`</ph> class with the following code.","source":"Replace the contents of the existing `Form1` class with the following code."},{"pos":[21102,21280],"content":"The <ph id=\"ph1\">`Form1_Load`</ph> method in the preceding code shows the general procedure for hosting a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> control:","source":"The `Form1_Load` method in the preceding code shows the general procedure for hosting a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control:"},{"pos":[21290,21362],"content":"Create a new <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> object.","source":"Create a new <xref:System.Windows.Forms.Integration.ElementHost> object."},{"pos":[21372,21518],"content":"Set the control's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Dock%2A&gt;</ph> property to <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DockStyle.Fill?displayProperty=nameWithType&gt;</ph>.","source":"Set the control's <xref:System.Windows.Forms.Control.Dock%2A> property to <xref:System.Windows.Forms.DockStyle.Fill?displayProperty=nameWithType>."},{"pos":[21528,21706],"content":"Add the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control to the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Panel&gt;</ph> control's <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Control.Controls%2A&gt;</ph> collection.","source":"Add the <xref:System.Windows.Forms.Integration.ElementHost> control to the <xref:System.Windows.Forms.Panel> control's <xref:System.Windows.Forms.Control.Controls%2A> collection."},{"pos":[21716,21832],"content":"Create an instance of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> control.","source":"Create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control."},{"pos":[21842,22045],"content":"Host the composite control on the form by assigning the control to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.ElementHost.Child%2A&gt;</ph> property.","source":"Host the composite control on the form by assigning the control to the <xref:System.Windows.Forms.Integration.ElementHost> control's <xref:System.Windows.Forms.Integration.ElementHost.Child%2A> property."},{"pos":[22052,22141],"content":"The remaining two lines in the <ph id=\"ph1\">`Form1_Load`</ph> method attach handlers to two control events:","source":"The remaining two lines in the `Form1_Load` method attach handlers to two control events:"},{"content":"<ph id=\"ph1\">`OnButtonClick`</ph> is a custom event that is fired by the composite control when the user clicks the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> button.","pos":[22151,22277],"source":"`OnButtonClick` is a custom event that is fired by the composite control when the user clicks the **OK** or **Cancel** button."},{"content":"You handle the event to get the user's response and to collect any data that the user specified.","pos":[22278,22374]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> is a standard event that is raised by a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> control when it is fully loaded.","pos":[22384,22584],"source":"<xref:System.Windows.FrameworkElement.Loaded> is a standard event that is raised by a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control when it is fully loaded."},{"content":"The event is used here because the example needs to initialize several global variables using properties from the control.","pos":[22585,22707]},{"content":"At the time of the form's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.Load&gt;</ph> event, the control is not fully loaded and those values are still set to <ph id=\"ph2\">`null`</ph>.","pos":[22708,22852],"source":" At the time of the form's <xref:System.Windows.Forms.Form.Load> event, the control is not fully loaded and those values are still set to `null`."},{"content":"You need to wait until the control’s <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event occurs before you can access those properties.","pos":[22853,22988],"source":" You need to wait until the control’s <xref:System.Windows.FrameworkElement.Loaded> event occurs before you can access those properties."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event handler is shown in the preceding code.","pos":[22995,23090],"source":"The <xref:System.Windows.FrameworkElement.Loaded> event handler is shown in the preceding code."},{"content":"The <ph id=\"ph1\">`OnButtonClick`</ph> handler is discussed in the next section.","pos":[23091,23152],"source":" The `OnButtonClick` handler is discussed in the next section."},{"pos":[23162,23184],"content":"Handling OnButtonClick","linkify":"Handling OnButtonClick","nodes":[{"content":"Handling OnButtonClick","pos":[0,22]}]},{"pos":[23188,23274],"content":"The <ph id=\"ph1\">`OnButtonClick`</ph> event occurs when the user clicks the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> button.","source":"The `OnButtonClick` event occurs when the user clicks the **OK** or **Cancel** button."},{"content":"The event handler checks the event argument's <ph id=\"ph1\">`IsOK`</ph> field to determine which button was clicked.","pos":[23281,23378],"source":"The event handler checks the event argument's `IsOK` field to determine which button was clicked."},{"content":"The <ph id=\"ph1\">`lbl`</ph><bpt id=\"p1\">*</bpt>data<ept id=\"p1\">*</ept> variables correspond to the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Label&gt;</ph> controls that were discussed earlier.","pos":[23379,23494],"source":" The `lbl`*data* variables correspond to the <xref:System.Windows.Forms.Label> controls that were discussed earlier."},{"content":"If the user clicks the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button, the data from the control’s <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> controls is assigned to the corresponding <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Label&gt;</ph> control.","pos":[23495,23684],"source":" If the user clicks the **OK** button, the data from the control’s <xref:System.Windows.Controls.TextBox> controls is assigned to the corresponding <xref:System.Windows.Forms.Label> control."},{"content":"If the user clicks <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept>, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Label.Text%2A&gt;</ph> values are set to the default strings.","pos":[23685,23800],"source":" If the user clicks **Cancel**, the <xref:System.Windows.Forms.Label.Text%2A> values are set to the default strings."},{"pos":[23807,23878],"content":"Add the following button click event handler code to the <ph id=\"ph1\">`Form1`</ph> class.","source":"Add the following button click event handler code to the `Form1` class."},{"content":"Build and run the application.","pos":[24037,24067]},{"content":"Add some text in the WPF composite control and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[24068,24133],"source":" Add some text in the WPF composite control and then click **OK**."},{"content":"The text appears in the labels.","pos":[24134,24165]},{"content":"At this point, code has not been added to handle the radio buttons.","pos":[24166,24233]},{"pos":[24243,24282],"content":"Modifying the Appearance of the Control","linkify":"Modifying the Appearance of the Control","nodes":[{"content":"Modifying the Appearance of the Control","pos":[0,39]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RadioButton&gt;</ph> controls on the form will enable the user to change the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> composite control’s foreground and background colors as well as several font properties.","pos":[24286,24556],"source":"The <xref:System.Windows.Forms.RadioButton> controls on the form will enable the user to change the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control’s foreground and background colors as well as several font properties."},{"content":"The background color is exposed by the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> object.","pos":[24557,24655],"source":" The background color is exposed by the <xref:System.Windows.Forms.Integration.ElementHost> object."},{"content":"The remaining properties are exposed as custom properties of the control.","pos":[24656,24729]},{"content":"Double-click each <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RadioButton&gt;</ph> control on the form to create <ph id=\"ph2\">&lt;xref:System.Windows.Forms.RadioButton.CheckedChanged&gt;</ph> event handlers.","pos":[24736,24894],"source":"Double-click each <xref:System.Windows.Forms.RadioButton> control on the form to create <xref:System.Windows.Forms.RadioButton.CheckedChanged> event handlers."},{"content":"Replace the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RadioButton.CheckedChanged&gt;</ph> event handlers with the following code.","pos":[24895,25001],"source":" Replace the <xref:System.Windows.Forms.RadioButton.CheckedChanged> event handlers with the following code."},{"content":"Build and run the application.","pos":[25160,25190]},{"content":"Click the different radio buttons to see the effect on the WPF composite control.","pos":[25191,25272]},{"pos":[25281,25289],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[25406,25493],"content":"<bpt id=\"p1\">[</bpt>Design XAML in Visual Studio<ept id=\"p1\">](/visualstudio/designers/designing-xaml-in-visual-studio)</ept>","source":"[Design XAML in Visual Studio](/visualstudio/designers/designing-xaml-in-visual-studio)"},{"pos":[25496,25624],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Composite Control in WPF<ept id=\"p1\">](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)</ept>","source":"[Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)"},{"pos":[25627,25763],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms<ept id=\"p1\">](walkthrough-hosting-a-3-d-wpf-composite-control-in-windows-forms.md)</ept>","source":"[Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms](walkthrough-hosting-a-3-d-wpf-composite-control-in-windows-forms.md)"}]}