{"content":"---\ntitle: \"How to: Wrap a Windows Forms Control with ToolStripControlHost\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"ToolStrip control [Windows Forms], wrapping controls\"\n  - \"toolbars [Windows Forms], wrapping controls\"\n  - \"ToolStrip control [Windows Forms], hosting controls\"\nms.assetid: e2ce4990-661d-4882-a116-8a9eb575dc84\n---\n# How to: Wrap a Windows Forms Control with ToolStripControlHost\n<xref:System.Windows.Forms.ToolStripControlHost> is designed to enable hosting of arbitrary Windows Forms controls by using the <xref:System.Windows.Forms.ToolStripControlHost> constructor or by extending <xref:System.Windows.Forms.ToolStripControlHost> itself. It is easier to wrap the control by extending <xref:System.Windows.Forms.ToolStripControlHost> and implementing properties and methods that expose frequently used properties and methods of the control. You can also expose events for the control at the <xref:System.Windows.Forms.ToolStripControlHost> level.  \n  \n### To host a control in a ToolStripControlHost by derivation  \n  \n1.  Extend <xref:System.Windows.Forms.ToolStripControlHost>. Implement a default constructor that calls the base class constructor passing in the desired control.  \n  \n     [!code-cpp[System.Windows.Forms.ToolStripControlHost#10](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#10)]\n     [!code-csharp[System.Windows.Forms.ToolStripControlHost#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#10)]\n     [!code-vb[System.Windows.Forms.ToolStripControlHost#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#10)]  \n  \n2.  Declare a property of the same type as the wrapped control and return `Control` as the correct type of control in the property's accessor.  \n  \n     [!code-cpp[System.Windows.Forms.ToolStripControlHost#11](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#11)]\n     [!code-csharp[System.Windows.Forms.ToolStripControlHost#11](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#11)]\n     [!code-vb[System.Windows.Forms.ToolStripControlHost#11](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#11)]  \n  \n3.  Expose other frequently used properties and methods of the wrapped control with properties and methods in the extended class.  \n  \n     [!code-cpp[System.Windows.Forms.ToolStripControlHost#12](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#12)]\n     [!code-csharp[System.Windows.Forms.ToolStripControlHost#12](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#12)]\n     [!code-vb[System.Windows.Forms.ToolStripControlHost#12](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#12)]  \n  \n4.  Optionally, override the <xref:System.Windows.Forms.ToolStripControlHost.OnSubscribeControlEvents%2A>, and <xref:System.Windows.Forms.ToolStripControlHost.OnUnsubscribeControlEvents%2A> methods and add the control events you want to expose.  \n  \n     [!code-cpp[System.Windows.Forms.ToolStripControlHost#16](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#16)]\n     [!code-csharp[System.Windows.Forms.ToolStripControlHost#16](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#16)]\n     [!code-vb[System.Windows.Forms.ToolStripControlHost#16](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#16)]  \n  \n5.  Provide the necessary wrapping for the events you want to expose.  \n  \n     [!code-cpp[System.Windows.Forms.ToolStripControlHost#17](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#17)]\n     [!code-csharp[System.Windows.Forms.ToolStripControlHost#17](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#17)]\n     [!code-vb[System.Windows.Forms.ToolStripControlHost#17](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#17)]  \n  \n## Example  \n [!code-cpp[System.Windows.Forms.ToolStripControlHost#13](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#13)]\n [!code-csharp[System.Windows.Forms.ToolStripControlHost#13](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#13)]\n [!code-vb[System.Windows.Forms.ToolStripControlHost#13](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#13)]  \n  \n## Compiling the Code  \n  \n-   This example requires:  \n  \n-   References to the System and System.Windows.Forms assemblies.  \n  \n For information about building this example from the command line for Visual Basic or Visual C#, see [Building from the Command Line](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md). You can also build this example in Visual Studio by pasting the code into a new project.  \n  \n## See also\n\n- <xref:System.Windows.Forms.ToolStripControlHost>\n- [ToolStrip Control Overview](toolstrip-control-overview-windows-forms.md)\n- [ToolStrip Control Architecture](toolstrip-control-architecture.md)\n- [ToolStrip Technology Summary](toolstrip-technology-summary.md)\n","nodes":[{"pos":[4,379],"embed":true,"restype":"x-metadata","content":"title: \"How to: Wrap a Windows Forms Control with ToolStripControlHost\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"ToolStrip control [Windows Forms], wrapping controls\"\n  - \"toolbars [Windows Forms], wrapping controls\"\n  - \"ToolStrip control [Windows Forms], hosting controls\"\nms.assetid: e2ce4990-661d-4882-a116-8a9eb575dc84","nodes":[{"content":"How to: Wrap a Windows Forms Control with ToolStripControlHost","nodes":[{"pos":[0,62],"content":"How to: Wrap a Windows Forms Control with ToolStripControlHost","nodes":[{"content":"How to: Wrap a Windows Forms Control with ToolStripControlHost","pos":[0,62]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[386,448],"content":"How to: Wrap a Windows Forms Control with ToolStripControlHost","linkify":"How to: Wrap a Windows Forms Control with ToolStripControlHost","nodes":[{"content":"How to: Wrap a Windows Forms Control with ToolStripControlHost","pos":[0,62]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph> is designed to enable hosting of arbitrary Windows Forms controls by using the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph> constructor or by extending <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph> itself.","pos":[449,710],"source":"<xref:System.Windows.Forms.ToolStripControlHost> is designed to enable hosting of arbitrary Windows Forms controls by using the <xref:System.Windows.Forms.ToolStripControlHost> constructor or by extending <xref:System.Windows.Forms.ToolStripControlHost> itself."},{"content":"It is easier to wrap the control by extending <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph> and implementing properties and methods that expose frequently used properties and methods of the control.","pos":[711,912],"source":" It is easier to wrap the control by extending <xref:System.Windows.Forms.ToolStripControlHost> and implementing properties and methods that expose frequently used properties and methods of the control."},{"content":"You can also expose events for the control at the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph> level.","pos":[913,1018],"source":" You can also expose events for the control at the <xref:System.Windows.Forms.ToolStripControlHost> level."},{"pos":[1028,1085],"content":"To host a control in a ToolStripControlHost by derivation","linkify":"To host a control in a ToolStripControlHost by derivation","nodes":[{"content":"To host a control in a ToolStripControlHost by derivation","pos":[0,57]}]},{"content":"Extend <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph>.","pos":[1095,1151],"source":"Extend <xref:System.Windows.Forms.ToolStripControlHost>."},{"content":"Implement a default constructor that calls the base class constructor passing in the desired control.","pos":[1152,1253]},{"pos":[1264,1768],"content":"[!code-cpp[System.Windows.Forms.ToolStripControlHost#10](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#10)]\n [!code-csharp[System.Windows.Forms.ToolStripControlHost#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#10)]\n [!code-vb[System.Windows.Forms.ToolStripControlHost#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#10)]","leadings":["","    ","    "],"nodes":[]},{"pos":[1778,1916],"content":"Declare a property of the same type as the wrapped control and return <ph id=\"ph1\">`Control`</ph> as the correct type of control in the property's accessor.","source":"Declare a property of the same type as the wrapped control and return `Control` as the correct type of control in the property's accessor."},{"pos":[1927,2431],"content":"[!code-cpp[System.Windows.Forms.ToolStripControlHost#11](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#11)]\n [!code-csharp[System.Windows.Forms.ToolStripControlHost#11](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#11)]\n [!code-vb[System.Windows.Forms.ToolStripControlHost#11](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#11)]","leadings":["","    ","    "],"nodes":[]},{"content":"Expose other frequently used properties and methods of the wrapped control with properties and methods in the extended class.","pos":[2441,2566]},{"pos":[2577,3081],"content":"[!code-cpp[System.Windows.Forms.ToolStripControlHost#12](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#12)]\n [!code-csharp[System.Windows.Forms.ToolStripControlHost#12](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#12)]\n [!code-vb[System.Windows.Forms.ToolStripControlHost#12](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#12)]","leadings":["","    ","    "],"nodes":[]},{"pos":[3091,3331],"content":"Optionally, override the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripControlHost.OnSubscribeControlEvents%2A&gt;</ph>, and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripControlHost.OnUnsubscribeControlEvents%2A&gt;</ph> methods and add the control events you want to expose.","source":"Optionally, override the <xref:System.Windows.Forms.ToolStripControlHost.OnSubscribeControlEvents%2A>, and <xref:System.Windows.Forms.ToolStripControlHost.OnUnsubscribeControlEvents%2A> methods and add the control events you want to expose."},{"pos":[3342,3846],"content":"[!code-cpp[System.Windows.Forms.ToolStripControlHost#16](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#16)]\n [!code-csharp[System.Windows.Forms.ToolStripControlHost#16](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#16)]\n [!code-vb[System.Windows.Forms.ToolStripControlHost#16](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#16)]","leadings":["","    ","    "],"nodes":[]},{"content":"Provide the necessary wrapping for the events you want to expose.","pos":[3856,3921]},{"pos":[3932,4436],"content":"[!code-cpp[System.Windows.Forms.ToolStripControlHost#17](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#17)]\n [!code-csharp[System.Windows.Forms.ToolStripControlHost#17](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#17)]\n [!code-vb[System.Windows.Forms.ToolStripControlHost#17](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#17)]","leadings":["","    ","    "],"nodes":[]},{"pos":[4445,4452],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4961,4979],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"This example requires:","pos":[4989,5011]},{"content":"References to the System and System.Windows.Forms assemblies.","pos":[5021,5082]},{"content":"For information about building this example from the command line for Visual Basic or Visual C#, see <bpt id=\"p1\">[</bpt>Building from the Command Line<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md)</ept> or <bpt id=\"p2\">[</bpt>Command-line Building With csc.exe<ept id=\"p2\">](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)</ept>.","pos":[5089,5443],"source":"For information about building this example from the command line for Visual Basic or Visual C#, see [Building from the Command Line](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)."},{"content":"You can also build this example in Visual Studio by pasting the code into a new project.","pos":[5444,5532]},{"pos":[5541,5549],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5604,5677],"content":"<bpt id=\"p1\">[</bpt>ToolStrip Control Overview<ept id=\"p1\">](toolstrip-control-overview-windows-forms.md)</ept>","source":"[ToolStrip Control Overview](toolstrip-control-overview-windows-forms.md)"},{"pos":[5680,5747],"content":"<bpt id=\"p1\">[</bpt>ToolStrip Control Architecture<ept id=\"p1\">](toolstrip-control-architecture.md)</ept>","source":"[ToolStrip Control Architecture](toolstrip-control-architecture.md)"},{"pos":[5750,5813],"content":"<bpt id=\"p1\">[</bpt>ToolStrip Technology Summary<ept id=\"p1\">](toolstrip-technology-summary.md)</ept>","source":"[ToolStrip Technology Summary](toolstrip-technology-summary.md)"}]}