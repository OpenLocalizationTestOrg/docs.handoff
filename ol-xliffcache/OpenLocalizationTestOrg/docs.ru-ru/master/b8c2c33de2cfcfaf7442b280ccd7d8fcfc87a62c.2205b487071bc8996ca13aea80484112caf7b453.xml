{"content":"---\ntitle: \"LoadLibraryShim Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"LoadLibraryShim\"\napi_location: \n  - \"mscoree.dll\"\n  - \"mscoreei.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"LoadLibraryShim\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"LoadLibraryShim function [.NET Framework hosting]\"\nms.assetid: 30931874-4d0e-4df1-b3d1-e425b50655d1\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 20\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# LoadLibraryShim Function\nLoads a specified version of a DLL that is included in the .NET Framework redistributable package.  \n  \n This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]. Use the [ICLRRuntimeInfo::LoadLibrary](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-loadlibrary-method.md) method instead.  \n  \n## Syntax  \n  \n```  \nHRESULT LoadLibraryShim (  \n    [in]  LPCWSTR  szDllName,  \n    [in]  LPCWSTR  szVersion,  \n          LPVOID   pvReserved,  \n    [out] HMODULE *phModDll  \n);  \n```  \n  \n#### Parameters  \n `szDllName`  \n [in] A zero-terminated string that represents the name of the DLL to be loaded from the .NET Framework library.  \n  \n `szVersion`  \n [in] A zero-terminated string that represents the version of the DLL to be loaded. If `szVersion` is null, the version selected for loading is the latest version of the specified DLL that is less than version 4. That is, all versions equal to or greater than version 4 are ignored if `szVersion` is null, and if no version less than version 4 is installed, the DLL fails to load. This is to ensure that installation of the [!INCLUDE[net_v40_short](../../../../includes/net-v40-short-md.md)] does not affect pre-existing applications or components. See the entry [In-Proc SxS and Migration Quick Start](http://go.microsoft.com/fwlink/?LinkId=200329) in the CLR team blog.  \n  \n `pvReserved`  \n Reserved for future use.  \n  \n `phModDll`  \n [out] A pointer to the handle of the module.  \n  \n## Return Value  \n This method returns standard Component Object Model (COM) error codes, as defined in WinError.h, in addition to the following values.  \n  \n|Return code|Description|  \n|-----------------|-----------------|  \n|S_OK|The method completed successfully.|  \n|CLR_E_SHIM_RUNTIMELOAD|Loading `szDllName` requires loading the common language runtime (CLR), and the necessary version of the CLR cannot be loaded.|  \n  \n## Remarks  \n This function is used to load DLLs that are included in the .NET Framework redistributable package. It does not load user-generated DLLs.  \n  \n> [!NOTE]\n>  Beginning with the .NET Framework version 2.0, loading Fusion.dll causes the CLR to be loaded. This is because the functions in Fusion.dll are now wrappers whose implementations are provided by the runtime.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See Also  \n [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)","nodes":[{"pos":[12,53],"content":"LoadLibraryShim Function | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"LoadLibraryShim Function | Microsoft Docs","pos":[0,41]}]},{"pos":[633,657],"content":"LoadLibraryShim Function","linkify":"LoadLibraryShim Function","nodes":[{"content":"LoadLibraryShim Function","pos":[0,24]}]},{"content":"Loads a specified version of a DLL that is included in the .NET Framework redistributable package.","pos":[658,756]},{"content":"This function has been deprecated in the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph>.","pos":[763,870],"source":"This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]."},{"content":"Use the <bpt id=\"p1\">[</bpt>ICLRRuntimeInfo::LoadLibrary<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-loadlibrary-method.md)</ept> method instead.","pos":[871,1013],"source":" Use the [ICLRRuntimeInfo::LoadLibrary](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-loadlibrary-method.md) method instead."},{"pos":[1022,1028],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1214,1224],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A zero-terminated string that represents the name of the DLL to be loaded from the .NET Framework library.","pos":[1243,1354]},{"content":"[in] A zero-terminated string that represents the version of the DLL to be loaded.","pos":[1376,1458]},{"content":"If <ph id=\"ph1\">`szVersion`</ph> is null, the version selected for loading is the latest version of the specified DLL that is less than version 4.","pos":[1459,1587],"source":" If `szVersion` is null, the version selected for loading is the latest version of the specified DLL that is less than version 4."},{"content":"That is, all versions equal to or greater than version 4 are ignored if <ph id=\"ph1\">`szVersion`</ph> is null, and if no version less than version 4 is installed, the DLL fails to load.","pos":[1588,1755],"source":" That is, all versions equal to or greater than version 4 are ignored if `szVersion` is null, and if no version less than version 4 is installed, the DLL fails to load."},{"content":"This is to ensure that installation of the <ph id=\"ph1\">[!INCLUDE[net_v40_short](../../../../includes/net-v40-short-md.md)]</ph> does not affect pre-existing applications or components.","pos":[1756,1923],"source":" This is to ensure that installation of the [!INCLUDE[net_v40_short](../../../../includes/net-v40-short-md.md)] does not affect pre-existing applications or components."},{"content":"See the entry <bpt id=\"p1\">[</bpt>In-Proc SxS and Migration Quick Start<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=200329)</ept> in the CLR team blog.","pos":[1924,2046],"source":" See the entry [In-Proc SxS and Migration Quick Start](http://go.microsoft.com/fwlink/?LinkId=200329) in the CLR team blog."},{"content":"Reserved for future use.","pos":[2069,2093]},{"content":"[out] A pointer to the handle of the module.","pos":[2114,2158]},{"pos":[2167,2179],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns standard Component Object Model (COM) error codes, as defined in WinError.h, in addition to the following values.","pos":[2183,2316]},{"content":"Return code","pos":[2323,2334]},{"content":"Description","pos":[2335,2346]},{"content":"S_OK","pos":[2391,2395]},{"content":"The method completed successfully.","pos":[2396,2430]},{"content":"CLR_E_SHIM_RUNTIMELOAD","pos":[2435,2457]},{"pos":[2458,2584],"content":"Loading <ph id=\"ph1\">`szDllName`</ph> requires loading the common language runtime (CLR), and the necessary version of the CLR cannot be loaded.","source":"Loading `szDllName` requires loading the common language runtime (CLR), and the necessary version of the CLR cannot be loaded."},{"pos":[2594,2601],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This function is used to load DLLs that are included in the .NET Framework redistributable package.","pos":[2605,2704]},{"content":"It does not load user-generated DLLs.","pos":[2705,2742]},{"pos":[2750,2967],"content":"[!NOTE]\n Beginning with the .NET Framework version 2.0, loading Fusion.dll causes the CLR to be loaded. This is because the functions in Fusion.dll are now wrappers whose implementations are provided by the runtime.","leadings":["","> "],"nodes":[{"content":" Beginning with the .NET Framework version 2.0, loading Fusion.dll causes the CLR to be loaded. This is because the functions in Fusion.dll are now wrappers whose implementations are provided by the runtime.","pos":[8,215],"nodes":[{"content":"Beginning with the .NET Framework version 2.0, loading Fusion.dll causes the CLR to be loaded.","pos":[1,95]},{"content":"This is because the functions in Fusion.dll are now wrappers whose implementations are provided by the runtime.","pos":[96,207]}]}]},{"pos":[2976,2988],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2992,3096],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3103,3124],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[3131,3239],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]"},{"pos":[3248,3256],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[3260,3380],"content":"<bpt id=\"p1\">[</bpt>Deprecated CLR Hosting Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)</ept>","source":"[Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)"}]}