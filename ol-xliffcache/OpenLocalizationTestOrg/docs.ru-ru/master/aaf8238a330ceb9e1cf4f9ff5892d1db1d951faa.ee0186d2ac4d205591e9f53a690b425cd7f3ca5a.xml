{"content":"---\ntitle: \"Encrypting and Decrypting Strings in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"encryption [Visual Basic], strings\"\n  - \"strings [Visual Basic], encrypting\"\n  - \"decryption [Visual Basic], strings\"\n  - \"strings [Visual Basic], decrypting\"\nms.assetid: 1f51e40a-2f88-43e2-a83e-28a0b5c0d6fd\n---\n# Walkthrough: Encrypting and Decrypting Strings in Visual Basic\nThis walkthrough shows you how to use the <xref:System.Security.Cryptography.DESCryptoServiceProvider> class to encrypt and decrypt strings using the cryptographic service provider (CSP) version of the Triple Data Encryption Standard (<xref:System.Security.Cryptography.TripleDES>) algorithm. The first step is to create a simple wrapper class that encapsulates the 3DES algorithm and stores the encrypted data as a base-64 encoded string. Then, that wrapper is used to securely store private user data in a publicly accessible text file.  \n  \n You can use encryption to protect user secrets (for example, passwords) and to make credentials unreadable by unauthorized users. This can protect an authorized user's identity from being stolen, which protects the user's assets and provides non-repudiation. Encryption can also protect a user's data from being accessed by unauthorized users.  \n  \n For more information, see [Cryptographic Services](../../../../standard/security/cryptographic-services.md).  \n  \n> [!IMPORTANT]\n>  The Rijndael (now referred to as Advanced Encryption Standard [AES]) and Triple Data Encryption Standard (3DES) algorithms provide greater security than DES because they are more computationally intensive. For more information, see <xref:System.Security.Cryptography.DES> and <xref:System.Security.Cryptography.Rijndael>.  \n  \n### To create the encryption wrapper  \n  \n1.  Create the `Simple3Des` class to encapsulate the encryption and decryption methods.  \n  \n     [!code-vb[VbVbalrStrings#38](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class3.vb#38)]  \n  \n2.  Add an import of the cryptography namespace to the start of the file that contains the `Simple3Des` class.  \n  \n     [!code-vb[VbVbalrStrings#77](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class3.vb#77)]  \n  \n3.  In the `Simple3Des` class, add a private field to store the 3DES cryptographic service provider.  \n  \n     [!code-vb[VbVbalrStrings#39](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class3.vb#39)]  \n  \n4.  Add a private method that creates a byte array of a specified length from the hash of the specified key.  \n  \n     [!code-vb[VbVbalrStrings#41](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class3.vb#41)]  \n  \n5.  Add a constructor to initialize the 3DES cryptographic service provider.  \n  \n     The `key` parameter controls the `EncryptData` and `DecryptData` methods.  \n  \n     [!code-vb[VbVbalrStrings#40](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class3.vb#40)]  \n  \n6.  Add a public method that encrypts a string.  \n  \n     [!code-vb[VbVbalrStrings#42](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class3.vb#42)]  \n  \n7.  Add a public method that decrypts a string.  \n  \n     [!code-vb[VbVbalrStrings#43](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class3.vb#43)]  \n  \n     The wrapper class can now be used to protect user assets. In this example, it is used to securely store private user data in a publicly accessible text file.  \n  \n### To test the encryption wrapper  \n  \n1.  In a separate class, add a method that uses the wrapper's `EncryptData` method to encrypt a string and write it to the user's My Documents folder.  \n  \n     [!code-vb[VbVbalrStrings#78](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class3.vb#78)]  \n  \n2.  Add a method that reads the encrypted string from the user's My Documents folder and decrypts the string with the wrapper's `DecryptData` method.  \n  \n     [!code-vb[VbVbalrStrings#79](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class3.vb#79)]  \n  \n3.  Add user interface code to call the `TestEncoding` and `TestDecoding` methods.  \n  \n4.  Run the application.  \n  \n     When you test the application, notice that it will not decrypt the data if you provide the wrong password.  \n  \n## See also\n\n- <xref:System.Security.Cryptography>\n- <xref:System.Security.Cryptography.DESCryptoServiceProvider>\n- <xref:System.Security.Cryptography.DES>\n- <xref:System.Security.Cryptography.TripleDES>\n- <xref:System.Security.Cryptography.Rijndael>\n- [Cryptographic Services](../../../../standard/security/cryptographic-services.md)\n","nodes":[{"pos":[4,317],"embed":true,"restype":"x-metadata","content":"title: \"Encrypting and Decrypting Strings in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"encryption [Visual Basic], strings\"\n  - \"strings [Visual Basic], encrypting\"\n  - \"decryption [Visual Basic], strings\"\n  - \"strings [Visual Basic], decrypting\"\nms.assetid: 1f51e40a-2f88-43e2-a83e-28a0b5c0d6fd","nodes":[{"content":"Encrypting and Decrypting Strings in Visual Basic","nodes":[{"pos":[0,49],"content":"Encrypting and Decrypting Strings in Visual Basic","nodes":[{"content":"Encrypting and Decrypting Strings in Visual Basic","pos":[0,49]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[324,386],"content":"Walkthrough: Encrypting and Decrypting Strings in Visual Basic","linkify":"Walkthrough: Encrypting and Decrypting Strings in Visual Basic","nodes":[{"content":"Walkthrough: Encrypting and Decrypting Strings in Visual Basic","pos":[0,62]}]},{"content":"This walkthrough shows you how to use the <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.DESCryptoServiceProvider&gt;</ph> class to encrypt and decrypt strings using the cryptographic service provider (CSP) version of the Triple Data Encryption Standard (<ph id=\"ph2\">&lt;xref:System.Security.Cryptography.TripleDES&gt;</ph>) algorithm.","pos":[387,679],"source":"This walkthrough shows you how to use the <xref:System.Security.Cryptography.DESCryptoServiceProvider> class to encrypt and decrypt strings using the cryptographic service provider (CSP) version of the Triple Data Encryption Standard (<xref:System.Security.Cryptography.TripleDES>) algorithm."},{"content":"The first step is to create a simple wrapper class that encapsulates the 3DES algorithm and stores the encrypted data as a base-64 encoded string.","pos":[680,826]},{"content":"Then, that wrapper is used to securely store private user data in a publicly accessible text file.","pos":[827,925]},{"content":"You can use encryption to protect user secrets (for example, passwords) and to make credentials unreadable by unauthorized users.","pos":[932,1061]},{"content":"This can protect an authorized user's identity from being stolen, which protects the user's assets and provides non-repudiation.","pos":[1062,1190]},{"content":"Encryption can also protect a user's data from being accessed by unauthorized users.","pos":[1191,1275]},{"pos":[1282,1390],"content":"For more information, see <bpt id=\"p1\">[</bpt>Cryptographic Services<ept id=\"p1\">](../../../../standard/security/cryptographic-services.md)</ept>.","source":"For more information, see [Cryptographic Services](../../../../standard/security/cryptographic-services.md)."},{"pos":[1398,1735],"content":"[!IMPORTANT]\n The Rijndael (now referred to as Advanced Encryption Standard [AES]) and Triple Data Encryption Standard (3DES) algorithms provide greater security than DES because they are more computationally intensive. For more information, see <xref:System.Security.Cryptography.DES> and <xref:System.Security.Cryptography.Rijndael>.","leadings":["","> "],"nodes":[{"content":"The Rijndael (now referred to as Advanced Encryption Standard [AES]) and Triple Data Encryption Standard (3DES) algorithms provide greater security than DES because they are more computationally intensive. For more information, see <xref:System.Security.Cryptography.DES> and <xref:System.Security.Cryptography.Rijndael>.","pos":[14,335],"nodes":[{"content":"The Rijndael (now referred to as Advanced Encryption Standard [AES]) and Triple Data Encryption Standard (3DES) algorithms provide greater security than DES because they are more computationally intensive.","pos":[0,205]},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.DES&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Security.Cryptography.Rijndael&gt;</ph>.","pos":[206,321],"source":" For more information, see <xref:System.Security.Cryptography.DES> and <xref:System.Security.Cryptography.Rijndael>."}]}]},{"pos":[1745,1777],"content":"To create the encryption wrapper","linkify":"To create the encryption wrapper","nodes":[{"content":"To create the encryption wrapper","pos":[0,32]}]},{"pos":[1787,1870],"content":"Create the <ph id=\"ph1\">`Simple3Des`</ph> class to encapsulate the encryption and decryption methods.","source":"Create the `Simple3Des` class to encapsulate the encryption and decryption methods."},{"pos":[2004,2110],"content":"Add an import of the cryptography namespace to the start of the file that contains the <ph id=\"ph1\">`Simple3Des`</ph> class.","source":"Add an import of the cryptography namespace to the start of the file that contains the `Simple3Des` class."},{"pos":[2244,2340],"content":"In the <ph id=\"ph1\">`Simple3Des`</ph> class, add a private field to store the 3DES cryptographic service provider.","source":"In the `Simple3Des` class, add a private field to store the 3DES cryptographic service provider."},{"content":"Add a private method that creates a byte array of a specified length from the hash of the specified key.","pos":[2474,2578]},{"content":"Add a constructor to initialize the 3DES cryptographic service provider.","pos":[2712,2784]},{"pos":[2795,2868],"content":"The <ph id=\"ph1\">`key`</ph> parameter controls the <ph id=\"ph2\">`EncryptData`</ph> and <ph id=\"ph3\">`DecryptData`</ph> methods.","source":"The `key` parameter controls the `EncryptData` and `DecryptData` methods."},{"content":"Add a public method that encrypts a string.","pos":[3002,3045]},{"content":"Add a public method that decrypts a string.","pos":[3179,3222]},{"content":"The wrapper class can now be used to protect user assets.","pos":[3357,3414]},{"content":"In this example, it is used to securely store private user data in a publicly accessible text file.","pos":[3415,3514]},{"pos":[3524,3554],"content":"To test the encryption wrapper","linkify":"To test the encryption wrapper","nodes":[{"content":"To test the encryption wrapper","pos":[0,30]}]},{"pos":[3564,3710],"content":"In a separate class, add a method that uses the wrapper's <ph id=\"ph1\">`EncryptData`</ph> method to encrypt a string and write it to the user's My Documents folder.","source":"In a separate class, add a method that uses the wrapper's `EncryptData` method to encrypt a string and write it to the user's My Documents folder."},{"pos":[3844,3989],"content":"Add a method that reads the encrypted string from the user's My Documents folder and decrypts the string with the wrapper's <ph id=\"ph1\">`DecryptData`</ph> method.","source":"Add a method that reads the encrypted string from the user's My Documents folder and decrypts the string with the wrapper's `DecryptData` method."},{"pos":[4123,4201],"content":"Add user interface code to call the <ph id=\"ph1\">`TestEncoding`</ph> and <ph id=\"ph2\">`TestDecoding`</ph> methods.","source":"Add user interface code to call the `TestEncoding` and `TestDecoding` methods."},{"content":"Run the application.","pos":[4211,4231]},{"content":"When you test the application, notice that it will not decrypt the data if you provide the wrong password.","pos":[4242,4348]},{"pos":[4357,4365],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4607,4688],"content":"<bpt id=\"p1\">[</bpt>Cryptographic Services<ept id=\"p1\">](../../../../standard/security/cryptographic-services.md)</ept>","source":"[Cryptographic Services](../../../../standard/security/cryptographic-services.md)"}]}