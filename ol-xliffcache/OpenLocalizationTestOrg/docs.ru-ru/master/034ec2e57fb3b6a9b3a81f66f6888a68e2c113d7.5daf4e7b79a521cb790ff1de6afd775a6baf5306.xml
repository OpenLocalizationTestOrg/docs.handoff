{"content":"---\ntitle: \"How to: Find a TreeViewItem in a TreeView\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"TreeView control [WPF], finding a TreeViewItem\"\n  - \"TreeViewItem [WPF], finding\"\nms.assetid: 72ecd40c-3939-4e01-b617-5e9daa6074d9\n---\n# How to: Find a TreeViewItem in a TreeView\nThe <xref:System.Windows.Controls.TreeView> control provides a convenient way to display hierarchical data. If your <xref:System.Windows.Controls.TreeView> is bound to a data source, the <xref:System.Windows.Controls.TreeView.SelectedItem%2A> property provides a convenient way for you to quickly retrieve the selected data object. It is typically best to work with the underlying data object, but sometimes you may need to programmatically manipulate the data's containing <xref:System.Windows.Controls.TreeViewItem>. For example, you may need to programmatically expand the <xref:System.Windows.Controls.TreeViewItem>, or select a different item in the <xref:System.Windows.Controls.TreeView>.  \n  \n To find a <xref:System.Windows.Controls.TreeViewItem> that contains a specific data object, you must traverse each level of the <xref:System.Windows.Controls.TreeView>. The items in a <xref:System.Windows.Controls.TreeView> can also be virtualized to improve performance. In the case where items might be virtualized, you also must realize a <xref:System.Windows.Controls.TreeViewItem> to check whether it contains the data object.  \n  \n## Example  \n  \n## Description  \n The following example searches a <xref:System.Windows.Controls.TreeView> for a specific object and returns the object's containing <xref:System.Windows.Controls.TreeViewItem>. The example ensures that each <xref:System.Windows.Controls.TreeViewItem> is instantiated so that its child items can be searched. This example also works if the <xref:System.Windows.Controls.TreeView> does not use virtualized items.  \n  \n> [!NOTE]\n>  The following example works for any <xref:System.Windows.Controls.TreeView>, regardless of the underlying data model, and searches every <xref:System.Windows.Controls.TreeViewItem> until the object is found. Another technique that has better performance is to search the data model for the specified object, keep track of its location within the data hierarchy, and then find the corresponding <xref:System.Windows.Controls.TreeViewItem> in the <xref:System.Windows.Controls.TreeView>. However, the technique that has better performance requires knowledge of the data model and cannot be generalized for any given <xref:System.Windows.Controls.TreeView>.  \n  \n## Code  \n [!code-csharp[TreeViewFindTVI#1](~/samples/snippets/csharp/VS_Snippets_Wpf/TreeViewFindTVI/CSharp/MainWindow.xaml.cs#1)]\n [!code-vb[TreeViewFindTVI#1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/TreeViewFindTVI/VisualBasic/MainWindow.xaml.vb#1)]  \n  \n The previous code relies on a custom <xref:System.Windows.Controls.VirtualizingStackPanel> that exposes a method named `BringIntoView`. The following code defines the custom <xref:System.Windows.Controls.VirtualizingStackPanel>.  \n  \n [!code-csharp[TreeViewFindTVI#2](~/samples/snippets/csharp/VS_Snippets_Wpf/TreeViewFindTVI/CSharp/MainWindow.xaml.cs#2)]\n [!code-vb[TreeViewFindTVI#2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/TreeViewFindTVI/VisualBasic/MainWindow.xaml.vb#2)]  \n  \n The following XAML shows how to create a <xref:System.Windows.Controls.TreeView> that uses the custom <xref:System.Windows.Controls.VirtualizingStackPanel>.  \n  \n [!code-xaml[TreeViewFindTVI#3](~/samples/snippets/csharp/VS_Snippets_Wpf/TreeViewFindTVI/CSharp/MainWindow.xaml#3)]  \n  \n## See also\n\n- [Improve the Performance of a TreeView](how-to-improve-the-performance-of-a-treeview.md)\n","nodes":[{"pos":[4,268],"embed":true,"restype":"x-metadata","content":"title: \"How to: Find a TreeViewItem in a TreeView\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"TreeView control [WPF], finding a TreeViewItem\"\n  - \"TreeViewItem [WPF], finding\"\nms.assetid: 72ecd40c-3939-4e01-b617-5e9daa6074d9","nodes":[{"content":"How to: Find a TreeViewItem in a TreeView","nodes":[{"pos":[0,41],"content":"How to: Find a TreeViewItem in a TreeView","nodes":[{"content":"How to: Find a TreeViewItem in a TreeView","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[275,316],"content":"How to: Find a TreeViewItem in a TreeView","linkify":"How to: Find a TreeViewItem in a TreeView","nodes":[{"content":"How to: Find a TreeViewItem in a TreeView","pos":[0,41]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeView&gt;</ph> control provides a convenient way to display hierarchical data.","pos":[317,424],"source":"The <xref:System.Windows.Controls.TreeView> control provides a convenient way to display hierarchical data."},{"content":"If your <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeView&gt;</ph> is bound to a data source, the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TreeView.SelectedItem%2A&gt;</ph> property provides a convenient way for you to quickly retrieve the selected data object.","pos":[425,648],"source":" If your <xref:System.Windows.Controls.TreeView> is bound to a data source, the <xref:System.Windows.Controls.TreeView.SelectedItem%2A> property provides a convenient way for you to quickly retrieve the selected data object."},{"content":"It is typically best to work with the underlying data object, but sometimes you may need to programmatically manipulate the data's containing <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeViewItem&gt;</ph>.","pos":[649,835],"source":" It is typically best to work with the underlying data object, but sometimes you may need to programmatically manipulate the data's containing <xref:System.Windows.Controls.TreeViewItem>."},{"content":"For example, you may need to programmatically expand the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeViewItem&gt;</ph>, or select a different item in the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TreeView&gt;</ph>.","pos":[836,1012],"source":" For example, you may need to programmatically expand the <xref:System.Windows.Controls.TreeViewItem>, or select a different item in the <xref:System.Windows.Controls.TreeView>."},{"content":"To find a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeViewItem&gt;</ph> that contains a specific data object, you must traverse each level of the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TreeView&gt;</ph>.","pos":[1019,1187],"source":"To find a <xref:System.Windows.Controls.TreeViewItem> that contains a specific data object, you must traverse each level of the <xref:System.Windows.Controls.TreeView>."},{"content":"The items in a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeView&gt;</ph> can also be virtualized to improve performance.","pos":[1188,1290],"source":" The items in a <xref:System.Windows.Controls.TreeView> can also be virtualized to improve performance."},{"content":"In the case where items might be virtualized, you also must realize a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeViewItem&gt;</ph> to check whether it contains the data object.","pos":[1291,1450],"source":" In the case where items might be virtualized, you also must realize a <xref:System.Windows.Controls.TreeViewItem> to check whether it contains the data object."},{"pos":[1459,1466],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1475,1486],"content":"Description","linkify":"Description","nodes":[{"content":"Description","pos":[0,11]}]},{"content":"The following example searches a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeView&gt;</ph> for a specific object and returns the object's containing <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TreeViewItem&gt;</ph>.","pos":[1490,1665],"source":"The following example searches a <xref:System.Windows.Controls.TreeView> for a specific object and returns the object's containing <xref:System.Windows.Controls.TreeViewItem>."},{"content":"The example ensures that each <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeViewItem&gt;</ph> is instantiated so that its child items can be searched.","pos":[1666,1796],"source":" The example ensures that each <xref:System.Windows.Controls.TreeViewItem> is instantiated so that its child items can be searched."},{"content":"This example also works if the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeView&gt;</ph> does not use virtualized items.","pos":[1797,1899],"source":" This example also works if the <xref:System.Windows.Controls.TreeView> does not use virtualized items."},{"pos":[1907,2572],"content":"[!NOTE]\n The following example works for any <xref:System.Windows.Controls.TreeView>, regardless of the underlying data model, and searches every <xref:System.Windows.Controls.TreeViewItem> until the object is found. Another technique that has better performance is to search the data model for the specified object, keep track of its location within the data hierarchy, and then find the corresponding <xref:System.Windows.Controls.TreeViewItem> in the <xref:System.Windows.Controls.TreeView>. However, the technique that has better performance requires knowledge of the data model and cannot be generalized for any given <xref:System.Windows.Controls.TreeView>.","leadings":["","> "],"nodes":[{"content":"The following example works for any <xref:System.Windows.Controls.TreeView>, regardless of the underlying data model, and searches every <xref:System.Windows.Controls.TreeViewItem> until the object is found. Another technique that has better performance is to search the data model for the specified object, keep track of its location within the data hierarchy, and then find the corresponding <xref:System.Windows.Controls.TreeViewItem> in the <xref:System.Windows.Controls.TreeView>. However, the technique that has better performance requires knowledge of the data model and cannot be generalized for any given <xref:System.Windows.Controls.TreeView>.","pos":[9,663],"nodes":[{"content":"The following example works for any <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeView&gt;</ph>, regardless of the underlying data model, and searches every <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TreeViewItem&gt;</ph> until the object is found.","pos":[0,207],"source":"The following example works for any <xref:System.Windows.Controls.TreeView>, regardless of the underlying data model, and searches every <xref:System.Windows.Controls.TreeViewItem> until the object is found."},{"content":"Another technique that has better performance is to search the data model for the specified object, keep track of its location within the data hierarchy, and then find the corresponding <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeViewItem&gt;</ph> in the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TreeView&gt;</ph>.","pos":[208,485],"source":" Another technique that has better performance is to search the data model for the specified object, keep track of its location within the data hierarchy, and then find the corresponding <xref:System.Windows.Controls.TreeViewItem> in the <xref:System.Windows.Controls.TreeView>."},{"content":"However, the technique that has better performance requires knowledge of the data model and cannot be generalized for any given <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeView&gt;</ph>.","pos":[486,654],"source":" However, the technique that has better performance requires knowledge of the data model and cannot be generalized for any given <xref:System.Windows.Controls.TreeView>."}]}]},{"pos":[2581,2585],"content":"Code","linkify":"Code","nodes":[{"content":"Code","pos":[0,4]}]},{"content":"The previous code relies on a custom <ph id=\"ph1\">&lt;xref:System.Windows.Controls.VirtualizingStackPanel&gt;</ph> that exposes a method named <ph id=\"ph2\">`BringIntoView`</ph>.","pos":[2844,2979],"source":"The previous code relies on a custom <xref:System.Windows.Controls.VirtualizingStackPanel> that exposes a method named `BringIntoView`."},{"content":"The following code defines the custom <ph id=\"ph1\">&lt;xref:System.Windows.Controls.VirtualizingStackPanel&gt;</ph>.","pos":[2980,3072],"source":" The following code defines the custom <xref:System.Windows.Controls.VirtualizingStackPanel>."},{"pos":[3334,3490],"content":"The following XAML shows how to create a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TreeView&gt;</ph> that uses the custom <ph id=\"ph2\">&lt;xref:System.Windows.Controls.VirtualizingStackPanel&gt;</ph>.","source":"The following XAML shows how to create a <xref:System.Windows.Controls.TreeView> that uses the custom <xref:System.Windows.Controls.VirtualizingStackPanel>."},{"pos":[3621,3629],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3633,3721],"content":"<bpt id=\"p1\">[</bpt>Improve the Performance of a TreeView<ept id=\"p1\">](how-to-improve-the-performance-of-a-treeview.md)</ept>","source":"[Improve the Performance of a TreeView](how-to-improve-the-performance-of-a-treeview.md)"}]}