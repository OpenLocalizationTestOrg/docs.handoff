{"content":"---\ntitle: \"Implementing the UI Automation Value Control Pattern\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"control patterns, Value\"\n  - \"UI Automation, Value control pattern\"\n  - \"Value control pattern\"\nms.assetid: b0fcdd87-3add-4345-bca9-e891205e02ba\n---\n# Implementing the UI Automation Value Control Pattern\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IValueProvider>, including information on events and properties. Links to additional references are listed at the end of the topic.  \n  \n The <xref:System.Windows.Automation.ValuePattern> control pattern is used to support controls that have an intrinsic value not spanning a range and that can be represented as a string. This string can be editable, depending on the control and its settings. For examples of controls that implement this pattern, see [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md).  \n  \n<a name=\"Implementation_Guidelines_and_Conventions\"></a>   \n## Implementation Guidelines and Conventions  \n When implementing the Value control pattern, note the following guidelines and conventions:  \n  \n-   Controls such as <xref:System.Windows.Automation.ControlType.ListItem> and <xref:System.Windows.Automation.ControlType.TreeItem> must support <xref:System.Windows.Automation.ValuePattern> if the value of any of the items is editable, regardless of the current edit mode of the control. The parent control must also support <xref:System.Windows.Automation.ValuePattern> if the child items are editable.  \n  \n ![Editable list item.](../../../docs/framework/ui-automation/media/uia-valuepattern-editable-listitem.PNG \"UIA_ValuePattern_Editable_ListItem\")  \nExample of an Editable List Item  \n  \n-   Single-line edit controls support programmatic access to their contents by implementing <xref:System.Windows.Automation.Provider.IValueProvider>. However, multi-line edit controls do not implement <xref:System.Windows.Automation.Provider.IValueProvider>; instead they provide access to their content by implementing <xref:System.Windows.Automation.Provider.ITextProvider>.  \n  \n-   To retrieve the textual contents of a multi-line edit control, the control must implement <xref:System.Windows.Automation.Provider.ITextProvider>. However, <xref:System.Windows.Automation.Provider.ITextProvider> does not support setting the value of a control.  \n  \n-   <xref:System.Windows.Automation.Provider.IValueProvider> does not support the retrieval of formatting information or substring values. Implement <xref:System.Windows.Automation.Provider.ITextProvider> in these scenarios.  \n  \n-   <xref:System.Windows.Automation.Provider.IValueProvider> must be implemented by controls such as the **Color Picker** selection control from [!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)] (illustrated below), which supports string mapping between a color value (for example, \"yellow\") and an equivalent internal [!INCLUDE[TLA#tla_rgb](../../../includes/tlasharptla-rgb-md.md)] structure.  \n  \n ![Color picker with yellow highlighted.](../../../docs/framework/ui-automation/media/uia-valuepattern-colorpicker.png \"UIA_ValuePattern_ColorPicker\")  \nExample of Color Swatch String Mapping  \n  \n-   A control should have its <xref:System.Windows.Automation.AutomationElement.IsEnabledProperty> set to `true` and its <xref:System.Windows.Automation.ValuePattern.IsReadOnlyProperty> set to `false` before allowing a call to <xref:System.Windows.Automation.Provider.IValueProvider.SetValue%2A>.  \n  \n<a name=\"Required_Members_for_the_IValueProvider_Interface\"></a>   \n## Required Members for IValueProvider  \n The following properties and methods are required for implementing <xref:System.Windows.Automation.Provider.IValueProvider>.  \n  \n|Required members|Member type|Notes|  \n|----------------------|-----------------|-----------|  \n|<xref:System.Windows.Automation.ValuePattern.IsReadOnlyProperty>|Property|None|  \n|<xref:System.Windows.Automation.ValuePattern.ValueProperty>|Property|None|  \n|<xref:System.Windows.Automation.ValuePattern.SetValue%2A>|Method|None|  \n  \n<a name=\"Exceptions\"></a>   \n## Exceptions  \n Providers must throw the following exceptions.  \n  \n|Exception type|Condition|  \n|--------------------|---------------|  \n|<xref:System.InvalidOperationException>|<xref:System.Windows.Automation.ValuePattern.SetValue%2A><br /><br /> -   If locale-specific information is passed to a control in an incorrect format such as an incorrectly formatted date.|  \n|<xref:System.ArgumentException>|<xref:System.Windows.Automation.ValuePattern.SetValue%2A><br /><br /> -   If a new value cannot be converted from a string to a format the control recognizes.|  \n|<xref:System.Windows.Automation.ElementNotEnabledException>|<xref:System.Windows.Automation.ValuePattern.SetValue%2A><br /><br /> -   When an attempt is made to manipulate a control that is not enabled.|  \n  \n## See also\n\n- [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)\n- [Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)\n- [UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)\n- [ValuePattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText)\n- [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)\n- [Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)\n","nodes":[{"pos":[4,259],"embed":true,"restype":"x-metadata","content":"title: \"Implementing the UI Automation Value Control Pattern\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"control patterns, Value\"\n  - \"UI Automation, Value control pattern\"\n  - \"Value control pattern\"\nms.assetid: b0fcdd87-3add-4345-bca9-e891205e02ba","nodes":[{"content":"Implementing the UI Automation Value Control Pattern","nodes":[{"pos":[0,52],"content":"Implementing the UI Automation Value Control Pattern","nodes":[{"content":"Implementing the UI Automation Value Control Pattern","pos":[0,52]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[266,318],"content":"Implementing the UI Automation Value Control Pattern","linkify":"Implementing the UI Automation Value Control Pattern","nodes":[{"content":"Implementing the UI Automation Value Control Pattern","pos":[0,52]}]},{"pos":[321,784],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,461],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"content":"This topic introduces guidelines and conventions for implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IValueProvider&gt;</ph>, including information on events and properties.","pos":[791,962],"source":"This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IValueProvider>, including information on events and properties."},{"content":"Links to additional references are listed at the end of the topic.","pos":[963,1029]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Automation.ValuePattern&gt;</ph> control pattern is used to support controls that have an intrinsic value not spanning a range and that can be represented as a string.","pos":[1036,1220],"source":"The <xref:System.Windows.Automation.ValuePattern> control pattern is used to support controls that have an intrinsic value not spanning a range and that can be represented as a string."},{"content":"This string can be editable, depending on the control and its settings.","pos":[1221,1292]},{"content":"For examples of controls that implement this pattern, see <bpt id=\"p1\">[</bpt>Control Pattern Mapping for UI Automation Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)</ept>.","pos":[1293,1495],"source":" For examples of controls that implement this pattern, see [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)."},{"pos":[1564,1605],"content":"Implementation Guidelines and Conventions","linkify":"Implementation Guidelines and Conventions","nodes":[{"content":"Implementation Guidelines and Conventions","pos":[0,41]}]},{"content":"When implementing the Value control pattern, note the following guidelines and conventions:","pos":[1609,1700]},{"content":"Controls such as <ph id=\"ph1\">&lt;xref:System.Windows.Automation.ControlType.ListItem&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Automation.ControlType.TreeItem&gt;</ph> must support <ph id=\"ph3\">&lt;xref:System.Windows.Automation.ValuePattern&gt;</ph> if the value of any of the items is editable, regardless of the current edit mode of the control.","pos":[1710,1995],"source":"Controls such as <xref:System.Windows.Automation.ControlType.ListItem> and <xref:System.Windows.Automation.ControlType.TreeItem> must support <xref:System.Windows.Automation.ValuePattern> if the value of any of the items is editable, regardless of the current edit mode of the control."},{"content":"The parent control must also support <ph id=\"ph1\">&lt;xref:System.Windows.Automation.ValuePattern&gt;</ph> if the child items are editable.","pos":[1996,2111],"source":" The parent control must also support <xref:System.Windows.Automation.ValuePattern> if the child items are editable."},{"content":"<bpt id=\"p1\">![</bpt>Editable list item.<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../docs/framework/ui-automation/media/uia-valuepattern-editable-listitem.PNG \"</bpt>UIA_ValuePattern_Editable_ListItem<ept id=\"p2\">\")</ept>","pos":[2118,2261],"source":"![Editable list item.](../../../docs/framework/ui-automation/media/uia-valuepattern-editable-listitem.PNG \"UIA_ValuePattern_Editable_ListItem\")"},{"content":"Example of an Editable List Item","pos":[2264,2296]},{"content":"Single-line edit controls support programmatic access to their contents by implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IValueProvider&gt;</ph>.","pos":[2306,2451],"source":"Single-line edit controls support programmatic access to their contents by implementing <xref:System.Windows.Automation.Provider.IValueProvider>."},{"content":"However, multi-line edit controls do not implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IValueProvider&gt;</ph>; instead they provide access to their content by implementing <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.ITextProvider&gt;</ph>.","pos":[2452,2678],"source":" However, multi-line edit controls do not implement <xref:System.Windows.Automation.Provider.IValueProvider>; instead they provide access to their content by implementing <xref:System.Windows.Automation.Provider.ITextProvider>."},{"content":"To retrieve the textual contents of a multi-line edit control, the control must implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ITextProvider&gt;</ph>.","pos":[2688,2834],"source":"To retrieve the textual contents of a multi-line edit control, the control must implement <xref:System.Windows.Automation.Provider.ITextProvider>."},{"content":"However, <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ITextProvider&gt;</ph> does not support setting the value of a control.","pos":[2835,2948],"source":" However, <xref:System.Windows.Automation.Provider.ITextProvider> does not support setting the value of a control."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IValueProvider&gt;</ph> does not support the retrieval of formatting information or substring values.","pos":[2958,3092],"source":"<xref:System.Windows.Automation.Provider.IValueProvider> does not support the retrieval of formatting information or substring values."},{"content":"Implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ITextProvider&gt;</ph> in these scenarios.","pos":[3093,3178],"source":" Implement <xref:System.Windows.Automation.Provider.ITextProvider> in these scenarios."},{"pos":[3188,3595],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IValueProvider&gt;</ph> must be implemented by controls such as the <bpt id=\"p1\">**</bpt>Color Picker<ept id=\"p1\">**</ept> selection control from <ph id=\"ph2\">[!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)]</ph> (illustrated below), which supports string mapping between a color value (for example, \"yellow\") and an equivalent internal <ph id=\"ph3\">[!INCLUDE[TLA#tla_rgb](../../../includes/tlasharptla-rgb-md.md)]</ph> structure.","source":"<xref:System.Windows.Automation.Provider.IValueProvider> must be implemented by controls such as the **Color Picker** selection control from [!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)] (illustrated below), which supports string mapping between a color value (for example, \"yellow\") and an equivalent internal [!INCLUDE[TLA#tla_rgb](../../../includes/tlasharptla-rgb-md.md)] structure."},{"content":"<bpt id=\"p1\">![</bpt>Color picker with yellow highlighted.<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../docs/framework/ui-automation/media/uia-valuepattern-colorpicker.png \"</bpt>UIA_ValuePattern_ColorPicker<ept id=\"p2\">\")</ept>","pos":[3602,3751],"source":"![Color picker with yellow highlighted.](../../../docs/framework/ui-automation/media/uia-valuepattern-colorpicker.png \"UIA_ValuePattern_ColorPicker\")"},{"content":"Example of Color Swatch String Mapping","pos":[3754,3792]},{"pos":[3802,4094],"content":"A control should have its <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.IsEnabledProperty&gt;</ph> set to <ph id=\"ph2\">`true`</ph> and its <ph id=\"ph3\">&lt;xref:System.Windows.Automation.ValuePattern.IsReadOnlyProperty&gt;</ph> set to <ph id=\"ph4\">`false`</ph> before allowing a call to <ph id=\"ph5\">&lt;xref:System.Windows.Automation.Provider.IValueProvider.SetValue%2A&gt;</ph>.","source":"A control should have its <xref:System.Windows.Automation.AutomationElement.IsEnabledProperty> set to `true` and its <xref:System.Windows.Automation.ValuePattern.IsReadOnlyProperty> set to `false` before allowing a call to <xref:System.Windows.Automation.Provider.IValueProvider.SetValue%2A>."},{"pos":[4171,4206],"content":"Required Members for IValueProvider","linkify":"Required Members for IValueProvider","nodes":[{"content":"Required Members for IValueProvider","pos":[0,35]}]},{"pos":[4210,4334],"content":"The following properties and methods are required for implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IValueProvider&gt;</ph>.","source":"The following properties and methods are required for implementing <xref:System.Windows.Automation.Provider.IValueProvider>."},{"content":"Required members","pos":[4341,4357]},{"content":"Member type","pos":[4358,4369]},{"content":"Notes","pos":[4370,4375]},{"content":"Property","pos":[4502,4510]},{"content":"None","pos":[4511,4515]},{"content":"Property","pos":[4580,4588]},{"content":"None","pos":[4589,4593]},{"content":"Method","pos":[4656,4662]},{"content":"None","pos":[4663,4667]},{"pos":[4706,4716],"content":"Exceptions","linkify":"Exceptions","nodes":[{"content":"Exceptions","pos":[0,10]}]},{"content":"Providers must throw the following exceptions.","pos":[4720,4766]},{"content":"Exception type","pos":[4773,4787]},{"content":"Condition","pos":[4788,4797]},{"content":"-   If locale-specific information is passed to a control in an incorrect format such as an incorrectly formatted date.","pos":[4953,5072]},{"content":"-   If a new value cannot be converted from a string to a format the control recognizes.","pos":[5179,5267]},{"content":"-   When an attempt is made to manipulate a control that is not enabled.","pos":[5402,5474]},{"pos":[5484,5492],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5496,5619],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)</ept>","source":"[UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)"},{"pos":[5622,5771],"content":"<bpt id=\"p1\">[</bpt>Support Control Patterns in a UI Automation Provider<ept id=\"p1\">](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)</ept>","source":"[Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)"},{"pos":[5774,5903],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns for Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)</ept>","source":"[UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)"},{"pos":[5906,6018],"content":"<bpt id=\"p1\">[</bpt>ValuePattern Insert Text Sample<ept id=\"p1\">](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText)</ept>","source":"[ValuePattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText)"},{"pos":[6021,6120],"content":"<bpt id=\"p1\">[</bpt>UI Automation Tree Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</ept>","source":"[UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)"},{"pos":[6123,6224],"content":"<bpt id=\"p1\">[</bpt>Use Caching in UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)</ept>","source":"[Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)"}]}