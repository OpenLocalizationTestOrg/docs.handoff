{"content":"---\ntitle: \"ICLRDomainManager::SetAppDomainManagerType Method\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"ICLRDomainManager.SetAppDomainManagerType\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRDomainManager::SetAppDomainManagerType\"\nhelpviewer_keywords: \n  - \"SetAppDomainManagerType method, ICLRDomainManager interface [.NET Framework hosting]\"\n  - \"ICLRDomainManager::SetAppDomainManagerType method [.NET Framework hosting]\"\nms.assetid: ee91abb0-cb74-41dd-927b-e117fb8ffdf4\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# ICLRDomainManager::SetAppDomainManagerType Method\nSpecifies the type, derived from the <xref:System.AppDomainManager?displayProperty=nameWithType> class, of the application domain manager that will be used to initialize the default application domain.  \n  \n## Syntax  \n  \n```  \nHRESULT SetAppDomainManagerType(  \n    [in] LPCWSTR wszAppDomainManagerAssembly,  \n    [in] LPCWSTR wszAppDomainManagerType,  \n    [in] EInitializeNewDomainFlags dwInitializeDomainFlags  \n);  \n```  \n  \n## Parameters  \n `wszAppDomainManagerAssembly`  \n [in] The display name of the assembly that contains the application domain manager type; for example: \"AdMgrExample, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6856bccf150f00b3\".  \n  \n `wszAppDomainManagerType`  \n [in] The type name of the application domain manager, including the namespace.  \n  \n `dwInitializeDomainFlags`  \n [in] A combination of [EInitializeNewDomainFlags](../../../../docs/framework/unmanaged-api/hosting/einitializenewdomainflags-enumeration.md) enumeration values that provide information about the application domain manager.  \n  \n## Return Value  \n This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|The method completed successfully.|  \n|HOST_E_CLRNOTAVAILABLE|The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.|  \n  \n## Remarks  \n Currently, the only defined value for `dwInitializeDomainFlags` is `eInitializeNewDomainFlags_NoSecurityChanges`, which tells the common language runtime (CLR) that the application domain manager will not modify security settings during the execution of the <xref:System.AppDomainManager.InitializeNewDomain%2A?displayProperty=nameWithType> method. This allows the CLR to optimize the loading of assemblies that have the conditional <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA) attribute. This can result in a significant improvement in startup time if the transitive closure of this set of assemblies is large.  \n  \n> [!IMPORTANT]\n>  If the host specifies `eInitializeNewDomainFlags_NoSecurityChanges` for the application domain manager, an <xref:System.InvalidOperationException> is thrown if any attempt is made to modify the security of the application domain.  \n  \n Calling the [ICLRControl::SetAppDomainManagerType](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-setappdomainmanagertype-method.md)method is equivalent to calling `ICLRDomainManager::SetAppDomainManagerType` with `eInitializeNewDomainFlags_None`.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MetaHost.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See also\n\n- [Hosting](../../../../docs/framework/unmanaged-api/hosting/index.md)\n- [ICLRDomainManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrdomainmanager-interface.md)\n- [EInitializeNewDomainFlags Enumeration](../../../../docs/framework/unmanaged-api/hosting/einitializenewdomainflags-enumeration.md)\n","nodes":[{"pos":[4,543],"embed":true,"restype":"x-metadata","content":"title: \"ICLRDomainManager::SetAppDomainManagerType Method\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"ICLRDomainManager.SetAppDomainManagerType\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRDomainManager::SetAppDomainManagerType\"\nhelpviewer_keywords: \n  - \"SetAppDomainManagerType method, ICLRDomainManager interface [.NET Framework hosting]\"\n  - \"ICLRDomainManager::SetAppDomainManagerType method [.NET Framework hosting]\"\nms.assetid: ee91abb0-cb74-41dd-927b-e117fb8ffdf4\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"ICLRDomainManager::SetAppDomainManagerType Method","nodes":[{"pos":[0,49],"content":"ICLRDomainManager::SetAppDomainManagerType Method","nodes":[{"content":"ICLRDomainManager::SetAppDomainManagerType Method","pos":[0,49]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[550,599],"content":"ICLRDomainManager::SetAppDomainManagerType Method","linkify":"ICLRDomainManager::SetAppDomainManagerType Method","nodes":[{"content":"ICLRDomainManager::SetAppDomainManagerType Method","pos":[0,49]}]},{"pos":[600,801],"content":"Specifies the type, derived from the <ph id=\"ph1\">&lt;xref:System.AppDomainManager?displayProperty=nameWithType&gt;</ph> class, of the application domain manager that will be used to initialize the default application domain.","source":"Specifies the type, derived from the <xref:System.AppDomainManager?displayProperty=nameWithType> class, of the application domain manager that will be used to initialize the default application domain."},{"pos":[810,816],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1033,1043],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The display name of the assembly that contains the application domain manager type; for example: \"AdMgrExample, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6856bccf150f00b3\".","pos":[1080,1264]},{"content":"[in] The type name of the application domain manager, including the namespace.","pos":[1300,1378]},{"content":"[in] A combination of <bpt id=\"p1\">[</bpt>EInitializeNewDomainFlags<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/einitializenewdomainflags-enumeration.md)</ept> enumeration values that provide information about the application domain manager.","pos":[1414,1636],"source":"[in] A combination of [EInitializeNewDomainFlags](../../../../docs/framework/unmanaged-api/hosting/einitializenewdomainflags-enumeration.md) enumeration values that provide information about the application domain manager."},{"pos":[1645,1657],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.","pos":[1661,1768]},{"content":"HRESULT","pos":[1775,1782]},{"content":"Description","pos":[1783,1794]},{"content":"S_OK","pos":[1835,1839]},{"content":"The method completed successfully.","pos":[1840,1874]},{"content":"HOST_E_CLRNOTAVAILABLE","pos":[1879,1901]},{"content":"The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.","pos":[1902,2066]},{"pos":[2076,2083],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Currently, the only defined value for <ph id=\"ph1\">`dwInitializeDomainFlags`</ph> is <ph id=\"ph2\">`eInitializeNewDomainFlags_NoSecurityChanges`</ph>, which tells the common language runtime (CLR) that the application domain manager will not modify security settings during the execution of the <ph id=\"ph3\">&lt;xref:System.AppDomainManager.InitializeNewDomain%2A?displayProperty=nameWithType&gt;</ph> method.","pos":[2087,2435],"source":"Currently, the only defined value for `dwInitializeDomainFlags` is `eInitializeNewDomainFlags_NoSecurityChanges`, which tells the common language runtime (CLR) that the application domain manager will not modify security settings during the execution of the <xref:System.AppDomainManager.InitializeNewDomain%2A?displayProperty=nameWithType> method."},{"content":"This allows the CLR to optimize the loading of assemblies that have the conditional <ph id=\"ph1\">&lt;xref:System.Security.AllowPartiallyTrustedCallersAttribute&gt;</ph> (APTCA) attribute.","pos":[2436,2599],"source":" This allows the CLR to optimize the loading of assemblies that have the conditional <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA) attribute."},{"content":"This can result in a significant improvement in startup time if the transitive closure of this set of assemblies is large.","pos":[2600,2722]},{"pos":[2730,2975],"content":"[!IMPORTANT]\n If the host specifies `eInitializeNewDomainFlags_NoSecurityChanges` for the application domain manager, an <xref:System.InvalidOperationException> is thrown if any attempt is made to modify the security of the application domain.","leadings":["","> "],"nodes":[{"content":"If the host specifies <ph id=\"ph1\">`eInitializeNewDomainFlags_NoSecurityChanges`</ph> for the application domain manager, an <ph id=\"ph2\">&lt;xref:System.InvalidOperationException&gt;</ph> is thrown if any attempt is made to modify the security of the application domain.","pos":[14,243],"source":"If the host specifies `eInitializeNewDomainFlags_NoSecurityChanges` for the application domain manager, an <xref:System.InvalidOperationException> is thrown if any attempt is made to modify the security of the application domain."}]},{"pos":[2982,3243],"content":"Calling the <bpt id=\"p1\">[</bpt>ICLRControl::SetAppDomainManagerType<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-setappdomainmanagertype-method.md)</ept>method is equivalent to calling <ph id=\"ph1\">`ICLRDomainManager::SetAppDomainManagerType`</ph> with <ph id=\"ph2\">`eInitializeNewDomainFlags_None`</ph>.","source":"Calling the [ICLRControl::SetAppDomainManagerType](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-setappdomainmanagertype-method.md)method is equivalent to calling `ICLRDomainManager::SetAppDomainManagerType` with `eInitializeNewDomainFlags_None`."},{"pos":[3252,3264],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3268,3372],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3379,3401],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MetaHost.h","source":"**Header:** MetaHost.h"},{"pos":[3408,3458],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[3465,3573],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[3582,3590],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3594,3662],"content":"<bpt id=\"p1\">[</bpt>Hosting<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/index.md)</ept>","source":"[Hosting](../../../../docs/framework/unmanaged-api/hosting/index.md)"},{"pos":[3665,3775],"content":"<bpt id=\"p1\">[</bpt>ICLRDomainManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrdomainmanager-interface.md)</ept>","source":"[ICLRDomainManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrdomainmanager-interface.md)"},{"pos":[3778,3908],"content":"<bpt id=\"p1\">[</bpt>EInitializeNewDomainFlags Enumeration<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/einitializenewdomainflags-enumeration.md)</ept>","source":"[EInitializeNewDomainFlags Enumeration](../../../../docs/framework/unmanaged-api/hosting/einitializenewdomainflags-enumeration.md)"}]}