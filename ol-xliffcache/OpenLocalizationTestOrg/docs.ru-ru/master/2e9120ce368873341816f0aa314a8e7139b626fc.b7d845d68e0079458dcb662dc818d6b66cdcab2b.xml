{"content":"---\ntitle: \"dirtyCastAndCallOnInterface MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"managed debugging assistants (MDAs), early bound calls AutoDispatch\"\n  - \"dispatch-only mode\"\n  - \"dirtyCastAndCallOnInterface\"\n  - \"early-bound managed classes\"\n  - \"early bound calls on AutoDispatch\"\n  - \"MDAs (managed debugging assistants), early bound calls AutoDispatch\"\n  - \"EarlyBoundCallOnAutorDispatchClassInteface MDA\"\nms.assetid: aa388ed3-7e3d-48ea-a0b5-c47ae19cec38\ncaps.latest.revision: 17\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# dirtyCastAndCallOnInterface MDA\nThe `dirtyCastAndCallOnInterface` managed debugging assistant (MDA) is activated when an early-bound call through a vtable is attempted on a class interface that has been marked late-bound only.  \n  \n## Symptoms  \n An application throws an access violation or has unexpected behavior when placing an early-bound call via COM into the CLR.  \n  \n## Cause  \n Code is attempting an early-bound call through a vtable via a class interface that is late-bound only. Note that by default class interfaces are identified as being late-bound only. They can also be identified as late-bound with the <xref:System.Runtime.InteropServices.ClassInterfaceAttribute> attribute with an <xref:System.Runtime.InteropServices.ClassInterfaceType> value (`[ClassInterface(ClassInterfaceType.AutoDispatch)]`).  \n  \n## Resolution  \n The recommended resolution is to define an explicit interface for use by COM and have the COM clients call through this interface instead of through the automatically generated class interface. Alternatively, the call from COM can be transformed into a late-bound call via `IDispatch`.  \n  \n Finally, it is possible to identify the class as <xref:System.Runtime.InteropServices.ClassInterfaceType> (`[ClassInterface(ClassInterfaceType.AutoDual)]`) to allow early bound calls to be placed from COM; however, using <xref:System.Runtime.InteropServices.ClassInterfaceType> is strongly discouraged because of the versioning limitations described in <xref:System.Runtime.InteropServices.ClassInterfaceAttribute>.  \n  \n## Effect on the Runtime  \n This MDA has no effect on the CLR. It only reports data about early-bound calls on late-bound interfaces.  \n  \n## Output  \n The name of the method or name of the field being accessed early-bound.  \n  \n## Configuration  \n  \n```  \n<mdaConfig>  \n  <assistants>  \n    <dirtyCastAndCallOnInterface />  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## See Also  \n <xref:System.Runtime.InteropServices.ClassInterfaceAttribute>   \n [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)","nodes":[{"pos":[12,60],"content":"dirtyCastAndCallOnInterface MDA | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"dirtyCastAndCallOnInterface MDA | Microsoft Docs","pos":[0,48]}]},{"pos":[774,805],"content":"dirtyCastAndCallOnInterface MDA","linkify":"dirtyCastAndCallOnInterface MDA","nodes":[{"content":"dirtyCastAndCallOnInterface MDA","pos":[0,31]}]},{"pos":[806,1000],"content":"The <ph id=\"ph1\">`dirtyCastAndCallOnInterface`</ph> managed debugging assistant (MDA) is activated when an early-bound call through a vtable is attempted on a class interface that has been marked late-bound only.","source":"The `dirtyCastAndCallOnInterface` managed debugging assistant (MDA) is activated when an early-bound call through a vtable is attempted on a class interface that has been marked late-bound only."},{"pos":[1009,1017],"content":"Symptoms","linkify":"Symptoms","nodes":[{"content":"Symptoms","pos":[0,8]}]},{"content":"An application throws an access violation or has unexpected behavior when placing an early-bound call via COM into the CLR.","pos":[1021,1144]},{"pos":[1153,1158],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"content":"Code is attempting an early-bound call through a vtable via a class interface that is late-bound only.","pos":[1162,1264]},{"content":"Note that by default class interfaces are identified as being late-bound only.","pos":[1265,1343]},{"content":"They can also be identified as late-bound with the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.ClassInterfaceAttribute&gt;</ph> attribute with an <ph id=\"ph2\">&lt;xref:System.Runtime.InteropServices.ClassInterfaceType&gt;</ph> value (<ph id=\"ph3\">`[ClassInterface(ClassInterfaceType.AutoDispatch)]`</ph>).","pos":[1344,1592],"source":" They can also be identified as late-bound with the <xref:System.Runtime.InteropServices.ClassInterfaceAttribute> attribute with an <xref:System.Runtime.InteropServices.ClassInterfaceType> value (`[ClassInterface(ClassInterfaceType.AutoDispatch)]`)."},{"pos":[1601,1611],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"content":"The recommended resolution is to define an explicit interface for use by COM and have the COM clients call through this interface instead of through the automatically generated class interface.","pos":[1615,1808]},{"content":"Alternatively, the call from COM can be transformed into a late-bound call via <ph id=\"ph1\">`IDispatch`</ph>.","pos":[1809,1900],"source":" Alternatively, the call from COM can be transformed into a late-bound call via `IDispatch`."},{"pos":[1907,2322],"content":"Finally, it is possible to identify the class as <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.ClassInterfaceType&gt;</ph> (<ph id=\"ph2\">`[ClassInterface(ClassInterfaceType.AutoDual)]`</ph>) to allow early bound calls to be placed from COM; however, using <ph id=\"ph3\">&lt;xref:System.Runtime.InteropServices.ClassInterfaceType&gt;</ph> is strongly discouraged because of the versioning limitations described in <ph id=\"ph4\">&lt;xref:System.Runtime.InteropServices.ClassInterfaceAttribute&gt;</ph>.","source":"Finally, it is possible to identify the class as <xref:System.Runtime.InteropServices.ClassInterfaceType> (`[ClassInterface(ClassInterfaceType.AutoDual)]`) to allow early bound calls to be placed from COM; however, using <xref:System.Runtime.InteropServices.ClassInterfaceType> is strongly discouraged because of the versioning limitations described in <xref:System.Runtime.InteropServices.ClassInterfaceAttribute>."},{"pos":[2331,2352],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"content":"This MDA has no effect on the CLR.","pos":[2356,2390]},{"content":"It only reports data about early-bound calls on late-bound interfaces.","pos":[2391,2461]},{"pos":[2470,2476],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"The name of the method or name of the field being accessed early-bound.","pos":[2480,2551]},{"pos":[2560,2573],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[2699,2707],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.ClassInterfaceAttribute&gt;</ph>","pos":[2711,2772],"source":"<xref:System.Runtime.InteropServices.ClassInterfaceAttribute> "},{"content":"<bpt id=\"p1\"> [</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept>","pos":[2776,2930],"source":" [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)"}]}