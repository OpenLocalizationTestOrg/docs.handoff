{"content":"---\ntitle: \"ICorDebugStackWalk::SetContext Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICorDebugStackWalk.SetContext Method\"\napi_location: \n  - \"mscordbi.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICorDebugStackWalk::SetContext\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"SetContext method [.NET Framework debugging]\"\n  - \"ICorDebugStackWalk::SetContext method [.NET Framework debugging]\"\nms.assetid: bac0b156-31a3-4e7f-be4d-ab21789c81f1\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 6\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# ICorDebugStackWalk::SetContext Method\nSets the [ICorDebugStackWalk](../../../../docs/framework/unmanaged-api/debugging/icordebugstackwalk-interface.md) object’s current context to a valid context for the thread.  \n  \n## Syntax  \n  \n```  \nHRESULT SetContext([in] CorDebugSetContextFlag flag,  \n                   [in] ULONG32 contextSize,  \n                   [in, size_is(contextSize)] BYTE context[]);  \n```  \n  \n#### Parameters  \n `flag`  \n [in] A [CorDebugSetContextFlag](../../../../docs/framework/unmanaged-api/debugging/cordebugsetcontextflag-enumeration.md) flag that indicates whether the context is from the active frame on the stack, or a context obtained by unwinding the stack.  \n  \n `contextSize`  \n [in] The allocated size of the `CONTEXT` buffer.  \n  \n `context`  \n [in] The `CONTEXT` buffer.  \n  \n## Return Value  \n This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|The `ICorDebugStackWalk` object's context was successfully set.|  \n|E_FAIL|The `ICorDebugStackWalk` object's context was not set.|  \n|E_INVALIDARG|The context is null.|  \n|HRESULT_FROM_WIN32(ERROR_INSUFFICIENT_BUFFER)|The context buffer is too small.|  \n  \n## Exceptions  \n  \n## Remarks  \n This method does not alter the current context of the thread.  \n  \n Setting the current context to an invalid context may cause unpredictable results from the stack walker.  \n  \n You can retrieve an exact bitwise copy of this context by immediately calling the [ICorDebugStackWalk::GetContext](../../../../docs/framework/unmanaged-api/debugging/icordebugstackwalk-getcontext-method.md) method.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** CorDebug.idl, CorDebug.h  \n  \n **Library:** CorGuids.lib  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See Also  \n [Debugging Interfaces](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md)   \n [Debugging](../../../../docs/framework/unmanaged-api/debugging/index.md)","nodes":[{"pos":[4,716],"embed":true,"restype":"x-metadata","content":"title: \"ICorDebugStackWalk::SetContext Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICorDebugStackWalk.SetContext Method\"\napi_location: \n  - \"mscordbi.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICorDebugStackWalk::SetContext\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"SetContext method [.NET Framework debugging]\"\n  - \"ICorDebugStackWalk::SetContext method [.NET Framework debugging]\"\nms.assetid: bac0b156-31a3-4e7f-be4d-ab21789c81f1\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 6\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"ICorDebugStackWalk::SetContext Method | Microsoft Docs","nodes":[{"pos":[0,54],"content":"ICorDebugStackWalk::SetContext Method | Microsoft Docs","nodes":[{"content":"ICorDebugStackWalk::SetContext Method | Microsoft Docs","pos":[0,54]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[723,760],"content":"ICorDebugStackWalk::SetContext Method","linkify":"ICorDebugStackWalk::SetContext Method","nodes":[{"content":"ICorDebugStackWalk::SetContext Method","pos":[0,37]}]},{"pos":[761,934],"content":"Sets the <bpt id=\"p1\">[</bpt>ICorDebugStackWalk<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/icordebugstackwalk-interface.md)</ept> object’s current context to a valid context for the thread.","source":"Sets the [ICorDebugStackWalk](../../../../docs/framework/unmanaged-api/debugging/icordebugstackwalk-interface.md) object’s current context to a valid context for the thread."},{"pos":[943,949],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1142,1152],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A <bpt id=\"p1\">[</bpt>CorDebugSetContextFlag<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/cordebugsetcontextflag-enumeration.md)</ept> flag that indicates whether the context is from the active frame on the stack, or a context obtained by unwinding the stack.","pos":[1166,1412],"source":"[in] A [CorDebugSetContextFlag](../../../../docs/framework/unmanaged-api/debugging/cordebugsetcontextflag-enumeration.md) flag that indicates whether the context is from the active frame on the stack, or a context obtained by unwinding the stack."},{"content":"[in] The allocated size of the <ph id=\"ph1\">`CONTEXT`</ph> buffer.","pos":[1436,1484],"source":"[in] The allocated size of the `CONTEXT` buffer."},{"content":"[in] The <ph id=\"ph1\">`CONTEXT`</ph> buffer.","pos":[1504,1530],"source":"[in] The `CONTEXT` buffer."},{"pos":[1539,1551],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.","pos":[1555,1662]},{"content":"HRESULT","pos":[1669,1676]},{"content":"Description","pos":[1677,1688]},{"content":"S_OK","pos":[1729,1733]},{"pos":[1734,1797],"content":"The <ph id=\"ph1\">`ICorDebugStackWalk`</ph> object's context was successfully set.","source":"The `ICorDebugStackWalk` object's context was successfully set."},{"content":"E_FAIL","pos":[1802,1808]},{"pos":[1809,1863],"content":"The <ph id=\"ph1\">`ICorDebugStackWalk`</ph> object's context was not set.","source":"The `ICorDebugStackWalk` object's context was not set."},{"content":"E_INVALIDARG","pos":[1868,1880]},{"content":"The context is null.","pos":[1881,1901]},{"content":"HRESULT_FROM_WIN32(ERROR_INSUFFICIENT_BUFFER)","pos":[1906,1951]},{"content":"The context buffer is too small.","pos":[1952,1984]},{"pos":[1994,2004],"content":"Exceptions","linkify":"Exceptions","nodes":[{"content":"Exceptions","pos":[0,10]}]},{"pos":[2013,2020],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This method does not alter the current context of the thread.","pos":[2024,2085]},{"content":"Setting the current context to an invalid context may cause unpredictable results from the stack walker.","pos":[2092,2196]},{"pos":[2203,2417],"content":"You can retrieve an exact bitwise copy of this context by immediately calling the <bpt id=\"p1\">[</bpt>ICorDebugStackWalk::GetContext<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/icordebugstackwalk-getcontext-method.md)</ept> method.","source":"You can retrieve an exact bitwise copy of this context by immediately calling the [ICorDebugStackWalk::GetContext](../../../../docs/framework/unmanaged-api/debugging/icordebugstackwalk-getcontext-method.md) method."},{"pos":[2426,2438],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2442,2546],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2553,2589],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> CorDebug.idl, CorDebug.h","source":"**Header:** CorDebug.idl, CorDebug.h"},{"pos":[2596,2621],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> CorGuids.lib","source":"**Library:** CorGuids.lib"},{"pos":[2628,2736],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[2745,2753],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Debugging Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md)</ept><ph id=\"ph1\"> </ph>","pos":[2757,2856],"source":"[Debugging Interfaces](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md) "},{"content":"<bpt id=\"p1\">[</bpt>Debugging<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/index.md)</ept>","pos":[2860,2932],"source":"[Debugging](../../../../docs/framework/unmanaged-api/debugging/index.md)"}]}