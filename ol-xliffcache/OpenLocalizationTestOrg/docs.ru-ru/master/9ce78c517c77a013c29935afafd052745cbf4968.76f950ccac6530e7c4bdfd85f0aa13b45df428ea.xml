{"content":"---\ntitle: \"How to: Change Displayed Data at Run Time in the Windows Forms DataGrid Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"DataGrid control [Windows Forms], dynamically changing at run time\"\n  - \"DataGrid control [Windows Forms], data binding\"\n  - \"cells, changing DataGrid cell values\"\nms.assetid: 0c7a6d00-30de-416e-8223-0a81ddb4c1f8\ncaps.latest.revision: 16\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Change Displayed Data at Run Time in the Windows Forms DataGrid Control\n> [!NOTE]\n>  The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose. For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](../../../../docs/framework/winforms/controls/differences-between-the-windows-forms-datagridview-and-datagrid-controls.md).  \n  \n After you have created a Windows Forms <xref:System.Windows.Forms.DataGrid> using the design-time features, you may also wish to dynamically change elements of the <xref:System.Data.DataSet> object of the grid at run time. This can include changes to either individual values of the table or changing which data source is bound to the <xref:System.Windows.Forms.DataGrid> control. Changes to individual values are done through the <xref:System.Data.DataSet> object, not the <xref:System.Windows.Forms.DataGrid> control.  \n  \n### To change data programmatically  \n  \n1.  Specify the desired table from the <xref:System.Data.DataSet> object and the desired row and field from the table and set the cell equal to the new value.  \n  \n    > [!NOTE]\n    >  To specify the first table of the <xref:System.Data.DataSet> or the first row of the table, use 0.  \n  \n     The following example shows how to change the second entry of the first row of the first table of a dataset by clicking`Button1`. The <xref:System.Data.DataSet> (`ds`) and Tables (`0` and`1`) were previously created.  \n  \n    ```vb  \n    Protected Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click  \n       ds.tables(0).rows(0)(1) = \"NewEntry\"  \n    End Sub  \n  \n    ```  \n  \n    ```csharp  \n    private void button1_Click(object sender, System.EventArgs e)  \n    {  \n       ds.Tables[0].Rows[0][1]=\"NewEntry\";  \n    }  \n  \n    ```  \n  \n    ```cpp  \n    private:   \n       void button1_Click(System::Object^ sender, System::EventArgs^ e)  \n       {  \n          dataSet1->Tables[0]->Rows[0][1] = \"NewEntry\";  \n       }  \n    ```  \n  \n     ([!INCLUDE[csprcs](../../../../includes/csprcs-md.md)], [!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]) Place the following code in the form's constructor to register the event handler.  \n  \n    ```csharp  \n    this.button1.Click += new System.EventHandler(this.button1_Click);  \n  \n    ```  \n  \n    ```cpp  \n    this->button1->Click +=  \n       gcnew System::EventHandler(this, &Form1::button1_Click);  \n    ```  \n  \n     At run time you can use the <xref:System.Windows.Forms.DataGrid.SetDataBinding%2A> method to bind the <xref:System.Windows.Forms.DataGrid> control to a different data source. For example, you may have several [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] data controls, each connected to a different database.  \n  \n### To change the DataSource programmatically  \n  \n1.  Set the <xref:System.Windows.Forms.DataGrid.SetDataBinding%2A> method to the name of the data source and table you want to bind to.  \n  \n     The following example shows how to change the date source using the <xref:System.Windows.Forms.DataGrid.SetDataBinding%2A> method to an [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] data control (adoPubsAuthors) that is connected to the Authors table in the Pubs database.  \n  \n    ```vb  \n    Private Sub ResetSource()  \n       DataGrid1.SetDataBinding(adoPubsAuthors, \"Authors\")  \n    End Sub  \n  \n    ```  \n  \n    ```csharp  \n    private void ResetSource()  \n    {  \n       DataGrid1.SetDataBinding(adoPubsAuthors, \"Authors\");  \n    }  \n  \n    ```  \n  \n    ```cpp  \n    private:  \n       void ResetSource()  \n       {  \n          dataGrid1->SetDataBinding(adoPubsAuthors, \"Authors\");  \n       }  \n    ```  \n  \n## See Also  \n [ADO.NET DataSets](../../../../docs/framework/data/adonet/ado-net-datasets.md)   \n [How to: Delete or Hide Columns in the Windows Forms DataGrid Control](../../../../docs/framework/winforms/controls/how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md)   \n [How to: Add Tables and Columns to the Windows Forms DataGrid Control](../../../../docs/framework/winforms/controls/how-to-add-tables-and-columns-to-the-windows-forms-datagrid-control.md)   \n [How to: Bind the Windows Forms DataGrid Control to a Data Source](../../../../docs/framework/winforms/controls/how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)","nodes":[{"pos":[4,630],"nodes":[{"content":"How to: Change Displayed Data at Run Time in the Windows Forms DataGrid Control | Microsoft Docs","nodes":[{"pos":[0,96],"content":"How to: Change Displayed Data at Run Time in the Windows Forms DataGrid Control | Microsoft Docs","nodes":[{"content":"How to: Change Displayed Data at Run Time in the Windows Forms DataGrid Control | Microsoft Docs","pos":[0,96]}]}],"pos":[6,105],"yaml":true}],"content":"title: \"How to: Change Displayed Data at Run Time in the Windows Forms DataGrid Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"DataGrid control [Windows Forms], dynamically changing at run time\"\n  - \"DataGrid control [Windows Forms], data binding\"\n  - \"cells, changing DataGrid cell values\"\nms.assetid: 0c7a6d00-30de-416e-8223-0a81ddb4c1f8\ncaps.latest.revision: 16\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","yamlblock":true},{"pos":[637,716],"content":"How to: Change Displayed Data at Run Time in the Windows Forms DataGrid Control","linkify":"How to: Change Displayed Data at Run Time in the Windows Forms DataGrid Control","nodes":[{"content":"How to: Change Displayed Data at Run Time in the Windows Forms DataGrid Control","pos":[0,79]}]},{"pos":[719,1224],"content":"[!NOTE]\n The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose. For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](../../../../docs/framework/winforms/controls/differences-between-the-windows-forms-datagridview-and-datagrid-controls.md).","leadings":["","> "],"nodes":[{"content":"The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose. For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](../../../../docs/framework/winforms/controls/differences-between-the-windows-forms-datagridview-and-datagrid-controls.md).","pos":[9,503],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control replaces and adds functionality to the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control; however, the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control is retained for both backward compatibility and future use, if you choose.","pos":[0,270],"source":"The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Differences Between the Windows Forms DataGridView and DataGrid Controls<ept id=\"p1\">](../../../../docs/framework/winforms/controls/differences-between-the-windows-forms-datagridview-and-datagrid-controls.md)</ept>.","pos":[271,494],"source":" For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](../../../../docs/framework/winforms/controls/differences-between-the-windows-forms-datagridview-and-datagrid-controls.md)."}]}]},{"content":"After you have created a Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> using the design-time features, you may also wish to dynamically change elements of the <ph id=\"ph2\">&lt;xref:System.Data.DataSet&gt;</ph> object of the grid at run time.","pos":[1231,1453],"source":"After you have created a Windows Forms <xref:System.Windows.Forms.DataGrid> using the design-time features, you may also wish to dynamically change elements of the <xref:System.Data.DataSet> object of the grid at run time."},{"content":"This can include changes to either individual values of the table or changing which data source is bound to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control.","pos":[1454,1611],"source":" This can include changes to either individual values of the table or changing which data source is bound to the <xref:System.Windows.Forms.DataGrid> control."},{"content":"Changes to individual values are done through the <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> object, not the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control.","pos":[1612,1750],"source":" Changes to individual values are done through the <xref:System.Data.DataSet> object, not the <xref:System.Windows.Forms.DataGrid> control."},{"pos":[1760,1791],"content":"To change data programmatically","linkify":"To change data programmatically","nodes":[{"content":"To change data programmatically","pos":[0,31]}]},{"content":"Specify the desired table from the <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> object and the desired row and field from the table and set the cell equal to the new value.","pos":[1801,1955],"source":"Specify the desired table from the <xref:System.Data.DataSet> object and the desired row and field from the table and set the cell equal to the new value."},{"pos":[1967,2080],"content":"[!NOTE]\nTo specify the first table of the <xref:System.Data.DataSet> or the first row of the table, use 0.","leadings":["","    >  "],"nodes":[{"content":"To specify the first table of the <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> or the first row of the table, use 0.","pos":[8,106],"source":"To specify the first table of the <xref:System.Data.DataSet> or the first row of the table, use 0."}]},{"content":"The following example shows how to change the second entry of the first row of the first table of a dataset by clicking<ph id=\"ph1\">`Button1`</ph>.","pos":[2091,2220],"source":"The following example shows how to change the second entry of the first row of the first table of a dataset by clicking`Button1`."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> (<ph id=\"ph2\">`ds`</ph>) and Tables (<ph id=\"ph3\">`0`</ph> and<ph id=\"ph4\">`1`</ph>) were previously created.","pos":[2221,2307],"source":" The <xref:System.Data.DataSet> (`ds`) and Tables (`0` and`1`) were previously created."},{"pos":[2879,3071],"content":"(<ph id=\"ph1\">[!INCLUDE[csprcs](../../../../includes/csprcs-md.md)]</ph>, <ph id=\"ph2\">[!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]</ph>) Place the following code in the form's constructor to register the event handler.","source":"([!INCLUDE[csprcs](../../../../includes/csprcs-md.md)], [!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]) Place the following code in the form's constructor to register the event handler."},{"content":"At run time you can use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGrid.SetDataBinding%2A&gt;</ph> method to bind the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control to a different data source.","pos":[3309,3483],"source":"At run time you can use the <xref:System.Windows.Forms.DataGrid.SetDataBinding%2A> method to bind the <xref:System.Windows.Forms.DataGrid> control to a different data source."},{"content":"For example, you may have several <ph id=\"ph1\">[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)]</ph> data controls, each connected to a different database.","pos":[3484,3630],"source":" For example, you may have several [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] data controls, each connected to a different database."},{"pos":[3640,3681],"content":"To change the DataSource programmatically","linkify":"To change the DataSource programmatically","nodes":[{"content":"To change the DataSource programmatically","pos":[0,41]}]},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGrid.SetDataBinding%2A&gt;</ph> method to the name of the data source and table you want to bind to.","pos":[3691,3822],"source":"Set the <xref:System.Windows.Forms.DataGrid.SetDataBinding%2A> method to the name of the data source and table you want to bind to."},{"pos":[3833,4117],"content":"The following example shows how to change the date source using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGrid.SetDataBinding%2A&gt;</ph> method to an <ph id=\"ph2\">[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)]</ph> data control (adoPubsAuthors) that is connected to the Authors table in the Pubs database.","source":"The following example shows how to change the date source using the <xref:System.Windows.Forms.DataGrid.SetDataBinding%2A> method to an [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] data control (adoPubsAuthors) that is connected to the Authors table in the Pubs database."},{"pos":[4561,4569],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>ADO.NET DataSets<ept id=\"p1\">](../../../../docs/framework/data/adonet/ado-net-datasets.md)</ept><ph id=\"ph1\"> </ph>","pos":[4573,4652],"source":"[ADO.NET DataSets](../../../../docs/framework/data/adonet/ado-net-datasets.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Delete or Hide Columns in the Windows Forms DataGrid Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md)</ept><ph id=\"ph1\"> </ph>","pos":[4656,4844],"source":"[How to: Delete or Hide Columns in the Windows Forms DataGrid Control](../../../../docs/framework/winforms/controls/how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Add Tables and Columns to the Windows Forms DataGrid Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-add-tables-and-columns-to-the-windows-forms-datagrid-control.md)</ept><ph id=\"ph1\"> </ph>","pos":[4848,5036],"source":"[How to: Add Tables and Columns to the Windows Forms DataGrid Control](../../../../docs/framework/winforms/controls/how-to-add-tables-and-columns-to-the-windows-forms-datagrid-control.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Bind the Windows Forms DataGrid Control to a Data Source<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)</ept>","pos":[5040,5219],"source":"[How to: Bind the Windows Forms DataGrid Control to a Data Source](../../../../docs/framework/winforms/controls/how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)"}]}