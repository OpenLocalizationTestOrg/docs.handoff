{"content":"---\ntitle: \"The Ink Object Model: Windows Forms and COM versus WPF\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"enabling ink [WPF]\"\n  - \"InkCanvas control [WPF]\"\n  - \"ink object model [WPF]\"\n  - \"tablet pen [WPF], events [WPF]\"\n  - \"ink [WPF], enabling\"\n  - \"events [WPF], tablet pen\"\nms.assetid: 577835be-b145-4226-8570-1d309e9b3901\n---\n# The Ink Object Model: Windows Forms and COM versus WPF\n\nThere are essentially three platforms that support digital ink: the Tablet PC Windows Forms platform, the Tablet PC COM platform, and the Windows Presentation Foundation (WPF) platform.  The Windows Forms and COM platforms share a similar object model, but the object model for the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] platform is substantially different.  This topic discusses the differences at a high-level so that developers that have worked with one object model can better understand the other.  \n  \n## Enabling Ink in an Application  \n All three platforms ship objects and controls that enable an application to receive input from a tablet pen.  The Windows Forms and COM platforms ship with [Microsoft.Ink.InkPicture](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583740(v=vs.90)), [Microsoft.Ink.InkEdit](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552265(v=vs.90)), [Microsoft.Ink.InkOverlay](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90)) and [Microsoft.Ink.InkCollector](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90)) classes.  [Microsoft.Ink.InkPicture](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583740(v=vs.90)) and [Microsoft.Ink.InkEdit](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552265(v=vs.90)) are controls that you can add to an application to collect ink.  The [Microsoft.Ink.InkOverlay](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90)) and [Microsoft.Ink.InkCollector](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90)) can be attached to an existing window to ink-enable windows and custom controls.  \n  \n The WPF platform includes the <xref:System.Windows.Controls.InkCanvas> control.  You can add an <xref:System.Windows.Controls.InkCanvas> to your application and begin collecting ink immediately. With the <xref:System.Windows.Controls.InkCanvas>, the user can copy, select, and resize ink.  You can add other controls to the <xref:System.Windows.Controls.InkCanvas>, and the user can handwrite over those controls, too.  You can create an ink-enabled custom control by adding an <xref:System.Windows.Controls.InkPresenter> to it and collecting its stylus points.  \n  \n The following table lists where to learn more about enabling ink in an application:  \n  \n|To do this…|On the WPF Platform…|On the Windows Forms/COM Platforms…|  \n|-----------------|--------------------------|------------------------------------------|  \n|Add an ink-enabled control to an application|See [Getting Started with Ink](getting-started-with-ink.md).|See [Auto Claims Form Sample](/windows/desktop/tablet/auto-claims-form-sample)|  \n|Enable ink on a custom control|See [Creating an Ink Input Control](creating-an-ink-input-control.md).|See [Ink Clipboard Sample](/windows/desktop/tablet/ink-clipboard-sample).|  \n  \n## Ink Data  \n On the Windows Forms and COM platforms, [Microsoft.Ink.InkCollector](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90)), [Microsoft.Ink.InkOverlay](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90)), [Microsoft.Ink.InkEdit](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552265(v=vs.90)), and [Microsoft.Ink.InkPicture](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583740(v=vs.90)) each expose a [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object. The [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object contains the data for one or more [Microsoft.Ink.Stroke](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552692(v=vs.90)) objects and exposes common methods and properties to manage and manipulate those strokes.  The [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object manages the lifetime of the strokes it contains; the [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object creates and deletes the strokes that it owns.  Each [Microsoft.Ink.Stroke](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552692(v=vs.90)) has an identifier that is unique within its parent [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object.  \n  \n On the WPF platform, the <xref:System.Windows.Ink.Stroke?displayProperty=nameWithType> class owns and manages its own lifetime. A group of <xref:System.Windows.Ink.Stroke> objects can be collected together in a <xref:System.Windows.Ink.StrokeCollection>, which provides methods for common ink data management operations such as hit testing, erasing, transforming, and serializing the ink. A <xref:System.Windows.Ink.Stroke> can belong to zero, one, or more <xref:System.Windows.Ink.StrokeCollection> objects at any give time.  Instead of having a [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object, the <xref:System.Windows.Controls.InkCanvas> and <xref:System.Windows.Controls.InkPresenter> contain a <xref:System.Windows.Ink.StrokeCollection?displayProperty=nameWithType>.  \n  \n The following pair of illustrations compares the ink data object models.  On the Windows Forms and COM platforms, the [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object constrains the lifetime of the [Microsoft.Ink.Stroke](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552692(v=vs.90)) objects, and the stylus packets belong to the individual strokes.  Two or more strokes can reference the same [Microsoft.Ink.DrawingAttributes](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583636(v=vs.90)) object, as shown in the following illustration.  \n  \n ![Diagram of the Ink Object Model for COM&#47;Winforms.](./media/ink-inkownsstrokes.png \"Ink_InkOwnsStrokes\")  \n  \n On the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], each <xref:System.Windows.Ink.Stroke?displayProperty=nameWithType> is a common language runtime object that exists as long as something has a reference to it.  Each <xref:System.Windows.Ink.Stroke> references a <xref:System.Windows.Input.StylusPointCollection> and <xref:System.Windows.Ink.DrawingAttributes?displayProperty=nameWithType> object, which are also common language runtime objects.  \n  \n ![Diagram of the Ink Object Model for WPF.](./media/ink-wpfinkobjectmodel.png \"Ink_WPFInkObjectModel\")  \n  \n The following table compares how to accomplish some common tasks on the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] platform and the Windows Forms and COM platforms.  \n  \n|Task|Windows Presentation Foundation|Windows Forms and COM|  \n|----------|-------------------------------------|---------------------------|  \n|Save Ink|<xref:System.Windows.Ink.StrokeCollection.Save%2A>|[Microsoft.Ink.Ink.Save](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms571335(v=vs.90))|  \n|Load Ink|Create a <xref:System.Windows.Ink.StrokeCollection> with the <xref:System.Windows.Ink.StrokeCollection.%23ctor%2A> constructor.|[Microsoft.Ink.Ink.Load](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms569609(v=vs.90))|  \n|Hit test|<xref:System.Windows.Ink.StrokeCollection.HitTest%2A>|[Microsoft.Ink.Ink.HitTest](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms571330(v=vs.90))|  \n|Copy Ink|<xref:System.Windows.Controls.InkCanvas.CopySelection%2A>|[Microsoft.Ink.Ink.ClipboardCopy](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms571316(v=vs.90))|  \n|Paste Ink|<xref:System.Windows.Controls.InkCanvas.Paste%2A>|[Microsoft.Ink.Ink.ClipboardPaste](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms571318(v=vs.90))|  \n|Access custom properties on a collection of strokes|<xref:System.Windows.Ink.StrokeCollection.AddPropertyData%2A> (the properties are stored internally and accessed via <xref:System.Windows.Ink.StrokeCollection.AddPropertyData%2A>, <xref:System.Windows.Ink.StrokeCollection.RemovePropertyData%2A>, and <xref:System.Windows.Ink.StrokeCollection.ContainsPropertyData%2A>)|Use [Microsoft.Ink.Ink.ExtendedProperties](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms582214(v=vs.90))|  \n  \n### Sharing ink between platforms  \n Although the platforms have different object models for the ink data, sharing the data between the platforms is very easy. The following examples save ink from a Windows Forms application and load the ink into a Windows Presentation Foundation application.  \n  \n [!code-csharp[WinFormWPFInk#UsingWinforms](~/samples/snippets/csharp/VS_Snippets_Wpf/WinformWPFInk/CSharp/Program.cs#usingwinforms)]\n [!code-vb[WinFormWPFInk#UsingWinforms](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WinformWPFInk/VisualBasic/Module1.vb#usingwinforms)]  \n[!code-csharp[WinFormWPFInk#SaveWinforms](~/samples/snippets/csharp/VS_Snippets_Wpf/WinformWPFInk/CSharp/Program.cs#savewinforms)]\n[!code-vb[WinFormWPFInk#SaveWinforms](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WinformWPFInk/VisualBasic/Module1.vb#savewinforms)]  \n  \n [!code-csharp[WinFormWPFInk#UsingWPF](~/samples/snippets/csharp/VS_Snippets_Wpf/WinformWPFInk/CSharp/Program.cs#usingwpf)]\n [!code-vb[WinFormWPFInk#UsingWPF](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WinformWPFInk/VisualBasic/Module1.vb#usingwpf)]  \n[!code-csharp[WinFormWPFInk#LoadWPF](~/samples/snippets/csharp/VS_Snippets_Wpf/WinformWPFInk/CSharp/Program.cs#loadwpf)]\n[!code-vb[WinFormWPFInk#LoadWPF](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WinformWPFInk/VisualBasic/Module1.vb#loadwpf)]  \n  \n The following examples save ink from a Windows Presentation Foundation application and load the ink into a Windows Forms application.  \n  \n [!code-csharp[WinFormWPFInk#UsingWPF](~/samples/snippets/csharp/VS_Snippets_Wpf/WinformWPFInk/CSharp/Program.cs#usingwpf)]\n [!code-vb[WinFormWPFInk#UsingWPF](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WinformWPFInk/VisualBasic/Module1.vb#usingwpf)]  \n[!code-csharp[WinFormWPFInk#SaveWPF](~/samples/snippets/csharp/VS_Snippets_Wpf/WinformWPFInk/CSharp/Program.cs#savewpf)]\n[!code-vb[WinFormWPFInk#SaveWPF](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WinformWPFInk/VisualBasic/Module1.vb#savewpf)]  \n  \n [!code-csharp[WinFormWPFInk#UsingWinforms](~/samples/snippets/csharp/VS_Snippets_Wpf/WinformWPFInk/CSharp/Program.cs#usingwinforms)]\n [!code-vb[WinFormWPFInk#UsingWinforms](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WinformWPFInk/VisualBasic/Module1.vb#usingwinforms)]  \n[!code-csharp[WinFormWPFInk#LoadWinforms](~/samples/snippets/csharp/VS_Snippets_Wpf/WinformWPFInk/CSharp/Program.cs#loadwinforms)]\n[!code-vb[WinFormWPFInk#LoadWinforms](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WinformWPFInk/VisualBasic/Module1.vb#loadwinforms)]\n## Events from the Tablet Pen  \n\n The [Microsoft.Ink.InkOverlay](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90)), [Microsoft.Ink.InkCollector](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90)), and [Microsoft.Ink.InkPicture](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583740(v=vs.90)) on the Windows Forms and COM platforms receive events when the user inputs pen data. The [Microsoft.Ink.InkOverlay](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90)) or [Microsoft.Ink.InkCollector](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90)) is attached to a window or a control, and can subscribe to the events raised by the tablet input data. The thread on which these events occurs depends on whether the events are raised with a pen, a mouse, or programmatically. For more information about threading in relation to these events, see [General Threading Considerations](/windows/desktop/tablet/general-threading-considerations) and [Threads on Which an Event Can Fire](/windows/desktop/tablet/threads-on-which-an-event-can-fire).  \n  \n On the Windows Presentation Foundation platform, the <xref:System.Windows.UIElement> class has events for pen input. This means that every control exposes the full set of stylus events.  The stylus events have tunneling/bubbling event pairs and always occur on the application thread.  For more information, see [Routed Events Overview](routed-events-overview.md).  \n  \n The following diagram shows compares the object models for the classes that raise stylus events. The Windows Presentation Foundation object model shows only the bubbling events, not the tunneling event counterparts.  \n  \n ![Diagram of the Stylus events in WPF vs Winforms.](./media/ink-stylusevents.png \"Ink_StylusEvents\")  \n  \n## Pen Data  \n All three platforms provide you with ways to intercept and manipulate the data that comes in from a tablet pen.  On the Windows Forms and COM Platforms, this is achieved by creating a [Microsoft.StylusInput.RealTimeStylus](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms585724(v=vs.90)), attaching a window or control to it, and creating a class that implements the [Microsoft.StylusInput.IStylusSyncPlugin](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms575201(v=vs.90)) or [Microsoft.StylusInput.IStylusAsyncPlugin](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms575194(v=vs.90)) interface. The custom plug-in is then added to the plug-in collection of the [Microsoft.StylusInput.RealTimeStylus](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms585724(v=vs.90)). For more information about this object model, see [Architecture of the StylusInput APIs](/windows/desktop/tablet/architecture-of-the-stylusinput-apis).  \n  \n On the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] platform, the <xref:System.Windows.UIElement> class exposes a collection of plug-ins, similar in design to the [Microsoft.StylusInput.RealTimeStylus](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms585724(v=vs.90)).  To intercept pen data, create a class that inherits from <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> and add the object to the <xref:System.Windows.UIElement.StylusPlugIns%2A> collection of the <xref:System.Windows.UIElement>. For more information about this interaction, see [Intercepting Input from the Stylus](intercepting-input-from-the-stylus.md).  \n  \n On all platforms, a thread pool receives the ink data via stylus events and sends it to the application thread.  For more information about threading on the COM and Windows Platforms, see [Threading Considerations for the StylusInput APIs](/windows/desktop/tablet/threading-considerations-for-the-stylusinput-apis).  For more information about threading on the Windows Presentation Software, see [The Ink Threading Model](the-ink-threading-model.md).  \n  \n The following illustration compares the object models for the classes that receive pen data on the pen thread pool.  \n  \n ![Diagram of the StylusPlugin model WPF vs Winforms.](./media/ink-stylusplugins.png \"Ink_StylusPlugins\")\n","nodes":[{"pos":[4,372],"embed":true,"restype":"x-metadata","content":"title: \"The Ink Object Model: Windows Forms and COM versus WPF\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"enabling ink [WPF]\"\n  - \"InkCanvas control [WPF]\"\n  - \"ink object model [WPF]\"\n  - \"tablet pen [WPF], events [WPF]\"\n  - \"ink [WPF], enabling\"\n  - \"events [WPF], tablet pen\"\nms.assetid: 577835be-b145-4226-8570-1d309e9b3901","nodes":[{"content":"The Ink Object Model: Windows Forms and COM versus WPF","nodes":[{"pos":[0,54],"content":"The Ink Object Model: Windows Forms and COM versus WPF","nodes":[{"content":"The Ink Object Model: Windows Forms and COM versus WPF","pos":[0,54]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[379,433],"content":"The Ink Object Model: Windows Forms and COM versus WPF","linkify":"The Ink Object Model: Windows Forms and COM versus WPF","nodes":[{"content":"The Ink Object Model: Windows Forms and COM versus WPF","pos":[0,54]}]},{"content":"There are essentially three platforms that support digital ink: the Tablet PC Windows Forms platform, the Tablet PC COM platform, and the Windows Presentation Foundation (WPF) platform.","pos":[435,620]},{"content":"The Windows Forms and COM platforms share a similar object model, but the object model for the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> platform is substantially different.","pos":[622,823],"source":"  The Windows Forms and COM platforms share a similar object model, but the object model for the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] platform is substantially different."},{"content":"This topic discusses the differences at a high-level so that developers that have worked with one object model can better understand the other.","pos":[825,968]},{"pos":[977,1007],"content":"Enabling Ink in an Application","linkify":"Enabling Ink in an Application","nodes":[{"content":"Enabling Ink in an Application","pos":[0,30]}]},{"content":"All three platforms ship objects and controls that enable an application to receive input from a tablet pen.","pos":[1011,1119]},{"content":"The Windows Forms and COM platforms ship with <bpt id=\"p1\">[</bpt>Microsoft.Ink.InkPicture<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583740(v=vs.90))</ept>, <bpt id=\"p2\">[</bpt>Microsoft.Ink.InkEdit<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552265(v=vs.90))</ept>, <bpt id=\"p3\">[</bpt>Microsoft.Ink.InkOverlay<ept id=\"p3\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90))</ept> and <bpt id=\"p4\">[</bpt>Microsoft.Ink.InkCollector<ept id=\"p4\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90))</ept> classes.","pos":[1121,1640],"source":"  The Windows Forms and COM platforms ship with [Microsoft.Ink.InkPicture](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583740(v=vs.90)), [Microsoft.Ink.InkEdit](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552265(v=vs.90)), [Microsoft.Ink.InkOverlay](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90)) and [Microsoft.Ink.InkCollector](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90)) classes."},{"content":"<bpt id=\"p1\">[</bpt>Microsoft.Ink.InkPicture<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583740(v=vs.90))</ept> and <bpt id=\"p2\">[</bpt>Microsoft.Ink.InkEdit<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552265(v=vs.90))</ept> are controls that you can add to an application to collect ink.","pos":[1642,1936],"source":"[Microsoft.Ink.InkPicture](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583740(v=vs.90)) and [Microsoft.Ink.InkEdit](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552265(v=vs.90)) are controls that you can add to an application to collect ink."},{"content":"The <bpt id=\"p1\">[</bpt>Microsoft.Ink.InkOverlay<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90))</ept> and <bpt id=\"p2\">[</bpt>Microsoft.Ink.InkCollector<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90))</ept> can be attached to an existing window to ink-enable windows and custom controls.","pos":[1938,2258],"source":"  The [Microsoft.Ink.InkOverlay](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90)) and [Microsoft.Ink.InkCollector](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90)) can be attached to an existing window to ink-enable windows and custom controls."},{"content":"The WPF platform includes the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.InkCanvas&gt;</ph> control.","pos":[2265,2344],"source":"The WPF platform includes the <xref:System.Windows.Controls.InkCanvas> control."},{"content":"You can add an <ph id=\"ph1\">&lt;xref:System.Windows.Controls.InkCanvas&gt;</ph> to your application and begin collecting ink immediately.","pos":[2346,2459],"source":"  You can add an <xref:System.Windows.Controls.InkCanvas> to your application and begin collecting ink immediately."},{"content":"With the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.InkCanvas&gt;</ph>, the user can copy, select, and resize ink.","pos":[2460,2553],"source":" With the <xref:System.Windows.Controls.InkCanvas>, the user can copy, select, and resize ink."},{"content":"You can add other controls to the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.InkCanvas&gt;</ph>, and the user can handwrite over those controls, too.","pos":[2555,2683],"source":"  You can add other controls to the <xref:System.Windows.Controls.InkCanvas>, and the user can handwrite over those controls, too."},{"content":"You can create an ink-enabled custom control by adding an <ph id=\"ph1\">&lt;xref:System.Windows.Controls.InkPresenter&gt;</ph> to it and collecting its stylus points.","pos":[2685,2826],"source":"  You can create an ink-enabled custom control by adding an <xref:System.Windows.Controls.InkPresenter> to it and collecting its stylus points."},{"content":"The following table lists where to learn more about enabling ink in an application:","pos":[2833,2916]},{"content":"To do this…","pos":[2923,2934]},{"content":"On the WPF Platform…","pos":[2935,2955]},{"content":"On the Windows Forms/COM Platforms…","pos":[2956,2991]},{"content":"Add an ink-enabled control to an application","pos":[3088,3132]},{"pos":[3133,3193],"content":"See <bpt id=\"p1\">[</bpt>Getting Started with Ink<ept id=\"p1\">](getting-started-with-ink.md)</ept>.","source":"See [Getting Started with Ink](getting-started-with-ink.md)."},{"pos":[3194,3272],"content":"See <bpt id=\"p1\">[</bpt>Auto Claims Form Sample<ept id=\"p1\">](/windows/desktop/tablet/auto-claims-form-sample)</ept>","source":"See [Auto Claims Form Sample](/windows/desktop/tablet/auto-claims-form-sample)"},{"content":"Enable ink on a custom control","pos":[3277,3307]},{"pos":[3308,3378],"content":"See <bpt id=\"p1\">[</bpt>Creating an Ink Input Control<ept id=\"p1\">](creating-an-ink-input-control.md)</ept>.","source":"See [Creating an Ink Input Control](creating-an-ink-input-control.md)."},{"pos":[3379,3452],"content":"See <bpt id=\"p1\">[</bpt>Ink Clipboard Sample<ept id=\"p1\">](/windows/desktop/tablet/ink-clipboard-sample)</ept>.","source":"See [Ink Clipboard Sample](/windows/desktop/tablet/ink-clipboard-sample)."},{"pos":[3462,3470],"content":"Ink Data","linkify":"Ink Data","nodes":[{"content":"Ink Data","pos":[0,8]}]},{"content":"On the Windows Forms and COM platforms, <bpt id=\"p1\">[</bpt>Microsoft.Ink.InkCollector<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90))</ept>, <bpt id=\"p2\">[</bpt>Microsoft.Ink.InkOverlay<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90))</ept>, <bpt id=\"p3\">[</bpt>Microsoft.Ink.InkEdit<ept id=\"p3\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552265(v=vs.90))</ept>, and <bpt id=\"p4\">[</bpt>Microsoft.Ink.InkPicture<ept id=\"p4\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583740(v=vs.90))</ept> each expose a <bpt id=\"p5\">[</bpt>Microsoft.Ink.Ink<ept id=\"p5\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90))</ept> object.","pos":[3474,4109],"source":"On the Windows Forms and COM platforms, [Microsoft.Ink.InkCollector](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90)), [Microsoft.Ink.InkOverlay](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90)), [Microsoft.Ink.InkEdit](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552265(v=vs.90)), and [Microsoft.Ink.InkPicture](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583740(v=vs.90)) each expose a [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object."},{"content":"The <bpt id=\"p1\">[</bpt>Microsoft.Ink.Ink<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90))</ept> object contains the data for one or more <bpt id=\"p2\">[</bpt>Microsoft.Ink.Stroke<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552692(v=vs.90))</ept> objects and exposes common methods and properties to manage and manipulate those strokes.","pos":[4110,4463],"source":" The [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object contains the data for one or more [Microsoft.Ink.Stroke](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552692(v=vs.90)) objects and exposes common methods and properties to manage and manipulate those strokes."},{"content":"The <bpt id=\"p1\">[</bpt>Microsoft.Ink.Ink<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90))</ept> object manages the lifetime of the strokes it contains; the <bpt id=\"p2\">[</bpt>Microsoft.Ink.Ink<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90))</ept> object creates and deletes the strokes that it owns.","pos":[4465,4797],"source":"  The [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object manages the lifetime of the strokes it contains; the [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object creates and deletes the strokes that it owns."},{"content":"Each <bpt id=\"p1\">[</bpt>Microsoft.Ink.Stroke<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552692(v=vs.90))</ept> has an identifier that is unique within its parent <bpt id=\"p2\">[</bpt>Microsoft.Ink.Ink<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90))</ept> object.","pos":[4799,5081],"source":"  Each [Microsoft.Ink.Stroke](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552692(v=vs.90)) has an identifier that is unique within its parent [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object."},{"content":"On the WPF platform, the <ph id=\"ph1\">&lt;xref:System.Windows.Ink.Stroke?displayProperty=nameWithType&gt;</ph> class owns and manages its own lifetime.","pos":[5088,5215],"source":"On the WPF platform, the <xref:System.Windows.Ink.Stroke?displayProperty=nameWithType> class owns and manages its own lifetime."},{"content":"A group of <ph id=\"ph1\">&lt;xref:System.Windows.Ink.Stroke&gt;</ph> objects can be collected together in a <ph id=\"ph2\">&lt;xref:System.Windows.Ink.StrokeCollection&gt;</ph>, which provides methods for common ink data management operations such as hit testing, erasing, transforming, and serializing the ink.","pos":[5216,5476],"source":" A group of <xref:System.Windows.Ink.Stroke> objects can be collected together in a <xref:System.Windows.Ink.StrokeCollection>, which provides methods for common ink data management operations such as hit testing, erasing, transforming, and serializing the ink."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Ink.Stroke&gt;</ph> can belong to zero, one, or more <ph id=\"ph2\">&lt;xref:System.Windows.Ink.StrokeCollection&gt;</ph> objects at any give time.","pos":[5477,5613],"source":" A <xref:System.Windows.Ink.Stroke> can belong to zero, one, or more <xref:System.Windows.Ink.StrokeCollection> objects at any give time."},{"content":"Instead of having a <bpt id=\"p1\">[</bpt>Microsoft.Ink.Ink<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90))</ept> object, the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.InkCanvas&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Controls.InkPresenter&gt;</ph> contain a <ph id=\"ph3\">&lt;xref:System.Windows.Ink.StrokeCollection?displayProperty=nameWithType&gt;</ph>.","pos":[5615,5926],"source":"  Instead of having a [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object, the <xref:System.Windows.Controls.InkCanvas> and <xref:System.Windows.Controls.InkPresenter> contain a <xref:System.Windows.Ink.StrokeCollection?displayProperty=nameWithType>."},{"content":"The following pair of illustrations compares the ink data object models.","pos":[5933,6005]},{"content":"On the Windows Forms and COM platforms, the <bpt id=\"p1\">[</bpt>Microsoft.Ink.Ink<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90))</ept> object constrains the lifetime of the <bpt id=\"p2\">[</bpt>Microsoft.Ink.Stroke<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552692(v=vs.90))</ept> objects, and the stylus packets belong to the individual strokes.","pos":[6007,6373],"source":"  On the Windows Forms and COM platforms, the [Microsoft.Ink.Ink](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583670(v=vs.90)) object constrains the lifetime of the [Microsoft.Ink.Stroke](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552692(v=vs.90)) objects, and the stylus packets belong to the individual strokes."},{"content":"Two or more strokes can reference the same <bpt id=\"p1\">[</bpt>Microsoft.Ink.DrawingAttributes<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583636(v=vs.90))</ept> object, as shown in the following illustration.","pos":[6375,6587],"source":"  Two or more strokes can reference the same [Microsoft.Ink.DrawingAttributes](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583636(v=vs.90)) object, as shown in the following illustration."},{"pos":[6594,6703],"content":"<bpt id=\"p1\">![</bpt>Diagram of the Ink Object Model for COM&amp;#47;Winforms.<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/ink-inkownsstrokes.png \"</bpt>Ink_InkOwnsStrokes<ept id=\"p2\">\")</ept>","source":"![Diagram of the Ink Object Model for COM&#47;Winforms.](./media/ink-inkownsstrokes.png \"Ink_InkOwnsStrokes\")"},{"content":"On the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>, each <ph id=\"ph2\">&lt;xref:System.Windows.Ink.Stroke?displayProperty=nameWithType&gt;</ph> is a common language runtime object that exists as long as something has a reference to it.","pos":[6710,6958],"source":"On the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], each <xref:System.Windows.Ink.Stroke?displayProperty=nameWithType> is a common language runtime object that exists as long as something has a reference to it."},{"content":"Each <ph id=\"ph1\">&lt;xref:System.Windows.Ink.Stroke&gt;</ph> references a <ph id=\"ph2\">&lt;xref:System.Windows.Input.StylusPointCollection&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Ink.DrawingAttributes?displayProperty=nameWithType&gt;</ph> object, which are also common language runtime objects.","pos":[6960,7193],"source":"  Each <xref:System.Windows.Ink.Stroke> references a <xref:System.Windows.Input.StylusPointCollection> and <xref:System.Windows.Ink.DrawingAttributes?displayProperty=nameWithType> object, which are also common language runtime objects."},{"pos":[7200,7302],"content":"<bpt id=\"p1\">![</bpt>Diagram of the Ink Object Model for WPF.<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/ink-wpfinkobjectmodel.png \"</bpt>Ink_WPFInkObjectModel<ept id=\"p2\">\")</ept>","source":"![Diagram of the Ink Object Model for WPF.](./media/ink-wpfinkobjectmodel.png \"Ink_WPFInkObjectModel\")"},{"pos":[7309,7500],"content":"The following table compares how to accomplish some common tasks on the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> platform and the Windows Forms and COM platforms.","source":"The following table compares how to accomplish some common tasks on the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] platform and the Windows Forms and COM platforms."},{"content":"Task","pos":[7507,7511]},{"content":"Windows Presentation Foundation","pos":[7512,7543]},{"content":"Windows Forms and COM","pos":[7544,7565]},{"content":"Save Ink","pos":[7651,7659]},{"pos":[7711,7823],"content":"<bpt id=\"p1\">[</bpt>Microsoft.Ink.Ink.Save<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms571335(v=vs.90))</ept>","source":"[Microsoft.Ink.Ink.Save](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms571335(v=vs.90))"},{"content":"Load Ink","pos":[7828,7836]},{"pos":[7837,7964],"content":"Create a <ph id=\"ph1\">&lt;xref:System.Windows.Ink.StrokeCollection&gt;</ph> with the <ph id=\"ph2\">&lt;xref:System.Windows.Ink.StrokeCollection.%23ctor%2A&gt;</ph> constructor.","source":"Create a <xref:System.Windows.Ink.StrokeCollection> with the <xref:System.Windows.Ink.StrokeCollection.%23ctor%2A> constructor."},{"pos":[7965,8077],"content":"<bpt id=\"p1\">[</bpt>Microsoft.Ink.Ink.Load<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms569609(v=vs.90))</ept>","source":"[Microsoft.Ink.Ink.Load](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms569609(v=vs.90))"},{"content":"Hit test","pos":[8082,8090]},{"pos":[8145,8260],"content":"<bpt id=\"p1\">[</bpt>Microsoft.Ink.Ink.HitTest<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms571330(v=vs.90))</ept>","source":"[Microsoft.Ink.Ink.HitTest](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms571330(v=vs.90))"},{"content":"Copy Ink","pos":[8265,8273]},{"pos":[8332,8453],"content":"<bpt id=\"p1\">[</bpt>Microsoft.Ink.Ink.ClipboardCopy<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms571316(v=vs.90))</ept>","source":"[Microsoft.Ink.Ink.ClipboardCopy](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms571316(v=vs.90))"},{"content":"Paste Ink","pos":[8458,8467]},{"pos":[8518,8640],"content":"<bpt id=\"p1\">[</bpt>Microsoft.Ink.Ink.ClipboardPaste<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms571318(v=vs.90))</ept>","source":"[Microsoft.Ink.Ink.ClipboardPaste](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms571318(v=vs.90))"},{"content":"Access custom properties on a collection of strokes","pos":[8645,8696]},{"pos":[8697,9014],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Ink.StrokeCollection.AddPropertyData%2A&gt;</ph> (the properties are stored internally and accessed via <ph id=\"ph2\">&lt;xref:System.Windows.Ink.StrokeCollection.AddPropertyData%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Ink.StrokeCollection.RemovePropertyData%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Windows.Ink.StrokeCollection.ContainsPropertyData%2A&gt;</ph>)","source":"<xref:System.Windows.Ink.StrokeCollection.AddPropertyData%2A> (the properties are stored internally and accessed via <xref:System.Windows.Ink.StrokeCollection.AddPropertyData%2A>, <xref:System.Windows.Ink.StrokeCollection.RemovePropertyData%2A>, and <xref:System.Windows.Ink.StrokeCollection.ContainsPropertyData%2A>)"},{"pos":[9015,9145],"content":"Use <bpt id=\"p1\">[</bpt>Microsoft.Ink.Ink.ExtendedProperties<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms582214(v=vs.90))</ept>","source":"Use [Microsoft.Ink.Ink.ExtendedProperties](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms582214(v=vs.90))"},{"pos":[9156,9185],"content":"Sharing ink between platforms","linkify":"Sharing ink between platforms","nodes":[{"content":"Sharing ink between platforms","pos":[0,29]}]},{"content":"Although the platforms have different object models for the ink data, sharing the data between the platforms is very easy.","pos":[9189,9311]},{"content":"The following examples save ink from a Windows Forms application and load the ink into a Windows Presentation Foundation application.","pos":[9312,9445]},{"content":"The following examples save ink from a Windows Presentation Foundation application and load the ink into a Windows Forms application.","pos":[10510,10643]},{"pos":[11705,11731],"content":"Events from the Tablet Pen","linkify":"Events from the Tablet Pen","nodes":[{"content":"Events from the Tablet Pen","pos":[0,26]}]},{"content":"The <bpt id=\"p1\">[</bpt>Microsoft.Ink.InkOverlay<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90))</ept>, <bpt id=\"p2\">[</bpt>Microsoft.Ink.InkCollector<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90))</ept>, and <bpt id=\"p3\">[</bpt>Microsoft.Ink.InkPicture<ept id=\"p3\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583740(v=vs.90))</ept> on the Windows Forms and COM platforms receive events when the user inputs pen data.","pos":[11736,12177],"source":"The [Microsoft.Ink.InkOverlay](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90)), [Microsoft.Ink.InkCollector](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90)), and [Microsoft.Ink.InkPicture](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583740(v=vs.90)) on the Windows Forms and COM platforms receive events when the user inputs pen data."},{"content":"The <bpt id=\"p1\">[</bpt>Microsoft.Ink.InkOverlay<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90))</ept> or <bpt id=\"p2\">[</bpt>Microsoft.Ink.InkCollector<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90))</ept> is attached to a window or a control, and can subscribe to the events raised by the tablet input data.","pos":[12178,12519],"source":" The [Microsoft.Ink.InkOverlay](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms552322(v=vs.90)) or [Microsoft.Ink.InkCollector](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms583683(v=vs.90)) is attached to a window or a control, and can subscribe to the events raised by the tablet input data."},{"content":"The thread on which these events occurs depends on whether the events are raised with a pen, a mouse, or programmatically.","pos":[12520,12642]},{"content":"For more information about threading in relation to these events, see <bpt id=\"p1\">[</bpt>General Threading Considerations<ept id=\"p1\">](/windows/desktop/tablet/general-threading-considerations)</ept> and <bpt id=\"p2\">[</bpt>Threads on Which an Event Can Fire<ept id=\"p2\">](/windows/desktop/tablet/threads-on-which-an-event-can-fire)</ept>.","pos":[12643,12907],"source":" For more information about threading in relation to these events, see [General Threading Considerations](/windows/desktop/tablet/general-threading-considerations) and [Threads on Which an Event Can Fire](/windows/desktop/tablet/threads-on-which-an-event-can-fire)."},{"content":"On the Windows Presentation Foundation platform, the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement&gt;</ph> class has events for pen input.","pos":[12914,13030],"source":"On the Windows Presentation Foundation platform, the <xref:System.Windows.UIElement> class has events for pen input."},{"content":"This means that every control exposes the full set of stylus events.","pos":[13031,13099]},{"content":"The stylus events have tunneling/bubbling event pairs and always occur on the application thread.","pos":[13101,13198]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Routed Events Overview<ept id=\"p1\">](routed-events-overview.md)</ept>.","pos":[13200,13278],"source":"  For more information, see [Routed Events Overview](routed-events-overview.md)."},{"content":"The following diagram shows compares the object models for the classes that raise stylus events.","pos":[13285,13381]},{"content":"The Windows Presentation Foundation object model shows only the bubbling events, not the tunneling event counterparts.","pos":[13382,13500]},{"pos":[13507,13607],"content":"<bpt id=\"p1\">![</bpt>Diagram of the Stylus events in WPF vs Winforms.<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/ink-stylusevents.png \"</bpt>Ink_StylusEvents<ept id=\"p2\">\")</ept>","source":"![Diagram of the Stylus events in WPF vs Winforms.](./media/ink-stylusevents.png \"Ink_StylusEvents\")"},{"pos":[13616,13624],"content":"Pen Data","linkify":"Pen Data","nodes":[{"content":"Pen Data","pos":[0,8]}]},{"content":"All three platforms provide you with ways to intercept and manipulate the data that comes in from a tablet pen.","pos":[13628,13739]},{"content":"On the Windows Forms and COM Platforms, this is achieved by creating a <bpt id=\"p1\">[</bpt>Microsoft.StylusInput.RealTimeStylus<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms585724(v=vs.90))</ept>, attaching a window or control to it, and creating a class that implements the <bpt id=\"p2\">[</bpt>Microsoft.StylusInput.IStylusSyncPlugin<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms575201(v=vs.90))</ept> or <bpt id=\"p3\">[</bpt>Microsoft.StylusInput.IStylusAsyncPlugin<ept id=\"p3\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms575194(v=vs.90))</ept> interface.","pos":[13741,14292],"source":"  On the Windows Forms and COM Platforms, this is achieved by creating a [Microsoft.StylusInput.RealTimeStylus](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms585724(v=vs.90)), attaching a window or control to it, and creating a class that implements the [Microsoft.StylusInput.IStylusSyncPlugin](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms575201(v=vs.90)) or [Microsoft.StylusInput.IStylusAsyncPlugin](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms575194(v=vs.90)) interface."},{"content":"The custom plug-in is then added to the plug-in collection of the <bpt id=\"p1\">[</bpt>Microsoft.StylusInput.RealTimeStylus<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms585724(v=vs.90))</ept>.","pos":[14293,14486],"source":" The custom plug-in is then added to the plug-in collection of the [Microsoft.StylusInput.RealTimeStylus](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms585724(v=vs.90))."},{"content":"For more information about this object model, see <bpt id=\"p1\">[</bpt>Architecture of the StylusInput APIs<ept id=\"p1\">](/windows/desktop/tablet/architecture-of-the-stylusinput-apis)</ept>.","pos":[14487,14638],"source":" For more information about this object model, see [Architecture of the StylusInput APIs](/windows/desktop/tablet/architecture-of-the-stylusinput-apis)."},{"content":"On the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> platform, the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement&gt;</ph> class exposes a collection of plug-ins, similar in design to the <bpt id=\"p1\">[</bpt>Microsoft.StylusInput.RealTimeStylus<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms585724(v=vs.90))</ept>.","pos":[14645,14960],"source":"On the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] platform, the <xref:System.Windows.UIElement> class exposes a collection of plug-ins, similar in design to the [Microsoft.StylusInput.RealTimeStylus](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms585724(v=vs.90))."},{"content":"To intercept pen data, create a class that inherits from <ph id=\"ph1\">&lt;xref:System.Windows.Input.StylusPlugIns.StylusPlugIn&gt;</ph> and add the object to the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.StylusPlugIns%2A&gt;</ph> collection of the <ph id=\"ph3\">&lt;xref:System.Windows.UIElement&gt;</ph>.","pos":[14962,15199],"source":"  To intercept pen data, create a class that inherits from <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> and add the object to the <xref:System.Windows.UIElement.StylusPlugIns%2A> collection of the <xref:System.Windows.UIElement>."},{"content":"For more information about this interaction, see <bpt id=\"p1\">[</bpt>Intercepting Input from the Stylus<ept id=\"p1\">](intercepting-input-from-the-stylus.md)</ept>.","pos":[15200,15325],"source":" For more information about this interaction, see [Intercepting Input from the Stylus](intercepting-input-from-the-stylus.md)."},{"content":"On all platforms, a thread pool receives the ink data via stylus events and sends it to the application thread.","pos":[15332,15443]},{"content":"For more information about threading on the COM and Windows Platforms, see <bpt id=\"p1\">[</bpt>Threading Considerations for the StylusInput APIs<ept id=\"p1\">](/windows/desktop/tablet/threading-considerations-for-the-stylusinput-apis)</ept>.","pos":[15445,15647],"source":"  For more information about threading on the COM and Windows Platforms, see [Threading Considerations for the StylusInput APIs](/windows/desktop/tablet/threading-considerations-for-the-stylusinput-apis)."},{"content":"For more information about threading on the Windows Presentation Software, see <bpt id=\"p1\">[</bpt>The Ink Threading Model<ept id=\"p1\">](the-ink-threading-model.md)</ept>.","pos":[15649,15782],"source":"  For more information about threading on the Windows Presentation Software, see [The Ink Threading Model](the-ink-threading-model.md)."},{"content":"The following illustration compares the object models for the classes that receive pen data on the pen thread pool.","pos":[15789,15904]},{"pos":[15911,16015],"content":"<bpt id=\"p1\">![</bpt>Diagram of the StylusPlugin model WPF vs Winforms.<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/ink-stylusplugins.png \"</bpt>Ink_StylusPlugins<ept id=\"p2\">\")</ept>","source":"![Diagram of the StylusPlugin model WPF vs Winforms.](./media/ink-stylusplugins.png \"Ink_StylusPlugins\")"}]}