{"content":"---\ntitle: \"Creating Custom Log Listeners (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"custom log listeners\"\n  - \"My.Application.Log object, custom log listeners\"\nms.assetid: 0e019115-4b25-4820-afb1-af8c6e391698\ncaps.latest.revision: 19\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Walkthrough: Creating Custom Log Listeners (Visual Basic)\nThis walkthrough demonstrates how to create a custom log listener and configure it to listen to the output of the `My.Application.Log` object.  \n  \n## Getting Started  \n Log listeners must inherit from the <xref:System.Diagnostics.TraceListener> class.  \n  \n#### To create the listener  \n  \n-   In your application, create a class named `SimpleListener` that inherits from <xref:System.Diagnostics.TraceListener>.  \n  \n     [!code-vb[VbVbalrMyApplicationLog#16](../../../../visual-basic/developing-apps/programming/log-info/codesnippet/VisualBasic/walkthrough-creating-custom-log-listeners_1.vb)]  \n  \n     The <xref:System.Diagnostics.TraceListener.Write%2A> and <xref:System.Diagnostics.TraceListener.WriteLine%2A> methods, required by the base class, call `MsgBox` to display their input.  \n  \n     The <xref:System.Security.Permissions.HostProtectionAttribute> attribute is applied to the <xref:System.Diagnostics.TraceListener.Write%2A> and <xref:System.Diagnostics.TraceListener.WriteLine%2A> methods so that their attributes match the base class methods. The <xref:System.Security.Permissions.HostProtectionAttribute> attribute allows the host that runs the code to determine that the code exposes host-protection synchronization.  \n  \n    > [!NOTE]\n    >  The <xref:System.Security.Permissions.HostProtectionAttribute> attribute is effective only on unmanaged applications that host the common language runtime and that implement host protection, such as SQL Server.  \n  \n To ensure that `My.Application.Log` uses your log listener, you should strongly name the assembly that contains your log listener.  \n  \n The next procedure provides some simple steps for creating a strongly named log-listener assembly. For more information, see [Creating and Using Strong-Named Assemblies](https://msdn.microsoft.com/library/xwb8f617).  \n  \n#### To strongly name the log-listener assembly  \n  \n1.  Have a project selected in **Solution Explorer**. On the **Project** menu, choose **Properties**. For more information, see [Introduction to the Project Designer](http://msdn.microsoft.com/en-us/898dd854-c98d-430c-ba1b-a913ce3c73d7).  \n  \n2.  Click the **Signing** tab.  \n  \n3.  Select the **Sign the assembly** box.  \n  \n4.  Select **\\<New>** from the **Choose a strong name key file** drop-down list.  \n  \n     The **Create Strong Name Key** dialog box opens.  \n  \n5.  Provide a name for the key file in the **Key file name** box.  \n  \n6.  Enter a password in the **Enter password** and **Confirm password** boxes.  \n  \n7.  Click **OK**.  \n  \n8.  Rebuild the application.  \n  \n## Adding the Listener  \n Now that the assembly has a strong name, you need to determine the strong name of the listener so that `My.Application.Log` uses your log listener.  \n  \n The format of a strongly named type is as follows.  \n  \n \\<type name>, \\<assembly name>, \\<version number>, \\<culture>, \\<strong name>  \n  \n#### To determine the strong name of the listener  \n  \n-   The following code shows how to determine the strongly named type name for `SimpleListener`.  \n  \n     [!code-vb[VbVbalrMyApplicationLog#17](../../../../visual-basic/developing-apps/programming/log-info/codesnippet/VisualBasic/walkthrough-creating-custom-log-listeners_2.vb)]  \n  \n     The strong name of the type depends on your project.  \n  \n With the strong name, you can add the listener to the `My.Application.Log` log-listener collection.  \n  \n#### To add the listener to My.Application.Log  \n  \n1.  Right-click on app.config in the **Solution Explorer** and choose **Open**.  \n  \n     -or-  \n  \n     If there is an app.config file:  \n  \n    1.  On the **Project** menu, choose **Add New Item**.  \n  \n    2.  From the **Add New Item** dialog box, choose **Application Configuration File**.  \n  \n    3.  Click **Add**.  \n  \n2.  Locate the `<listeners>` section, in the `<source>` section with the `name` attribute \"DefaultSource\", located in the `<sources>` section. The `<sources>` section is located in the `<system.diagnostics>` section, in the top-level `<configuration>` section.  \n  \n3.  Add this element to the `<listeners>` section:  \n  \n    ```  \n    <add name=\"SimpleLog\" />  \n    ```  \n  \n4.  Locate the `<sharedListeners>` section, in the `<system.diagnostics>` section, in the top-level `<configuration>` section.  \n  \n5.  Add this element to that `<sharedListeners>` section:  \n  \n    ```  \n    <add name=\"SimpleLog\" type=\"SimpleLogStrongName\" />  \n    ```  \n  \n     Change the value of `SimpleLogStrongName` to be the strong name of the listener.  \n  \n## See Also  \n <xref:Microsoft.VisualBasic.Logging.Log?displayProperty=fullName>   \n [Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)   \n [How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)   \n [How to: Write Log Messages](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md)   \n [Walkthrough: Changing Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-changing-where-my-application-log-writes-information.md)","nodes":[{"pos":[4,642],"embed":true,"restype":"x-metadata","content":"title: \"Creating Custom Log Listeners (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"custom log listeners\"\n  - \"My.Application.Log object, custom log listeners\"\nms.assetid: 0e019115-4b25-4820-afb1-af8c6e391698\ncaps.latest.revision: 19\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","nodes":[{"content":"Creating Custom Log Listeners (Visual Basic) | Microsoft Docs","nodes":[{"pos":[0,61],"content":"Creating Custom Log Listeners (Visual Basic) | Microsoft Docs","nodes":[{"content":"Creating Custom Log Listeners (Visual Basic) | Microsoft Docs","pos":[0,61]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[649,706],"content":"Walkthrough: Creating Custom Log Listeners (Visual Basic)","linkify":"Walkthrough: Creating Custom Log Listeners (Visual Basic)","nodes":[{"content":"Walkthrough: Creating Custom Log Listeners (Visual Basic)","pos":[0,57]}]},{"pos":[707,849],"content":"This walkthrough demonstrates how to create a custom log listener and configure it to listen to the output of the <ph id=\"ph1\">`My.Application.Log`</ph> object.","source":"This walkthrough demonstrates how to create a custom log listener and configure it to listen to the output of the `My.Application.Log` object."},{"pos":[858,873],"content":"Getting Started","linkify":"Getting Started","nodes":[{"content":"Getting Started","pos":[0,15]}]},{"pos":[877,959],"content":"Log listeners must inherit from the <ph id=\"ph1\">&lt;xref:System.Diagnostics.TraceListener&gt;</ph> class.","source":"Log listeners must inherit from the <xref:System.Diagnostics.TraceListener> class."},{"pos":[970,992],"content":"To create the listener","linkify":"To create the listener","nodes":[{"content":"To create the listener","pos":[0,22]}]},{"pos":[1002,1120],"content":"In your application, create a class named <ph id=\"ph1\">`SimpleListener`</ph> that inherits from <ph id=\"ph2\">&lt;xref:System.Diagnostics.TraceListener&gt;</ph>.","source":"In your application, create a class named `SimpleListener` that inherits from <xref:System.Diagnostics.TraceListener>."},{"pos":[1314,1498],"content":"The <ph id=\"ph1\">&lt;xref:System.Diagnostics.TraceListener.Write%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Diagnostics.TraceListener.WriteLine%2A&gt;</ph> methods, required by the base class, call <ph id=\"ph3\">`MsgBox`</ph> to display their input.","source":"The <xref:System.Diagnostics.TraceListener.Write%2A> and <xref:System.Diagnostics.TraceListener.WriteLine%2A> methods, required by the base class, call `MsgBox` to display their input."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Security.Permissions.HostProtectionAttribute&gt;</ph> attribute is applied to the <ph id=\"ph2\">&lt;xref:System.Diagnostics.TraceListener.Write%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Diagnostics.TraceListener.WriteLine%2A&gt;</ph> methods so that their attributes match the base class methods.","pos":[1509,1768],"source":"The <xref:System.Security.Permissions.HostProtectionAttribute> attribute is applied to the <xref:System.Diagnostics.TraceListener.Write%2A> and <xref:System.Diagnostics.TraceListener.WriteLine%2A> methods so that their attributes match the base class methods."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Security.Permissions.HostProtectionAttribute&gt;</ph> attribute allows the host that runs the code to determine that the code exposes host-protection synchronization.","pos":[1769,1944],"source":" The <xref:System.Security.Permissions.HostProtectionAttribute> attribute allows the host that runs the code to determine that the code exposes host-protection synchronization."},{"pos":[1956,2181],"content":"[!NOTE]\nThe <xref:System.Security.Permissions.HostProtectionAttribute> attribute is effective only on unmanaged applications that host the common language runtime and that implement host protection, such as SQL Server.","leadings":["","    >  "],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Security.Permissions.HostProtectionAttribute&gt;</ph> attribute is effective only on unmanaged applications that host the common language runtime and that implement host protection, such as SQL Server.","pos":[8,218],"source":"The <xref:System.Security.Permissions.HostProtectionAttribute> attribute is effective only on unmanaged applications that host the common language runtime and that implement host protection, such as SQL Server."}]},{"pos":[2188,2318],"content":"To ensure that <ph id=\"ph1\">`My.Application.Log`</ph> uses your log listener, you should strongly name the assembly that contains your log listener.","source":"To ensure that `My.Application.Log` uses your log listener, you should strongly name the assembly that contains your log listener."},{"content":"The next procedure provides some simple steps for creating a strongly named log-listener assembly.","pos":[2325,2423]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Creating and Using Strong-Named Assemblies<ept id=\"p1\">](https://msdn.microsoft.com/library/xwb8f617)</ept>.","pos":[2424,2540],"source":" For more information, see [Creating and Using Strong-Named Assemblies](https://msdn.microsoft.com/library/xwb8f617)."},{"pos":[2551,2593],"content":"To strongly name the log-listener assembly","linkify":"To strongly name the log-listener assembly","nodes":[{"content":"To strongly name the log-listener assembly","pos":[0,42]}]},{"content":"Have a project selected in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>.","pos":[2603,2652],"source":"Have a project selected in **Solution Explorer**."},{"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","pos":[2653,2700],"source":" On the **Project** menu, choose **Properties**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Introduction to the Project Designer<ept id=\"p1\">](http://msdn.microsoft.com/en-us/898dd854-c98d-430c-ba1b-a913ce3c73d7)</ept>.","pos":[2701,2836],"source":" For more information, see [Introduction to the Project Designer](http://msdn.microsoft.com/en-us/898dd854-c98d-430c-ba1b-a913ce3c73d7)."},{"pos":[2846,2872],"content":"Click the <bpt id=\"p1\">**</bpt>Signing<ept id=\"p1\">**</ept> tab.","source":"Click the **Signing** tab."},{"pos":[2882,2919],"content":"Select the <bpt id=\"p1\">**</bpt>Sign the assembly<ept id=\"p1\">**</ept> box.","source":"Select the **Sign the assembly** box."},{"pos":[2929,3005],"content":"Select <bpt id=\"p1\">**</bpt><ph id=\"ph1\">\\&lt;</ph>New&gt;<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Choose a strong name key file<ept id=\"p2\">**</ept> drop-down list.","source":"Select **\\<New>** from the **Choose a strong name key file** drop-down list."},{"pos":[3016,3064],"content":"The <bpt id=\"p1\">**</bpt>Create Strong Name Key<ept id=\"p1\">**</ept> dialog box opens.","source":"The **Create Strong Name Key** dialog box opens."},{"pos":[3074,3135],"content":"Provide a name for the key file in the <bpt id=\"p1\">**</bpt>Key file name<ept id=\"p1\">**</ept> box.","source":"Provide a name for the key file in the **Key file name** box."},{"pos":[3145,3219],"content":"Enter a password in the <bpt id=\"p1\">**</bpt>Enter password<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Confirm password<ept id=\"p2\">**</ept> boxes.","source":"Enter a password in the **Enter password** and **Confirm password** boxes."},{"pos":[3229,3242],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"content":"Rebuild the application.","pos":[3252,3276]},{"pos":[3285,3304],"content":"Adding the Listener","linkify":"Adding the Listener","nodes":[{"content":"Adding the Listener","pos":[0,19]}]},{"pos":[3308,3455],"content":"Now that the assembly has a strong name, you need to determine the strong name of the listener so that <ph id=\"ph1\">`My.Application.Log`</ph> uses your log listener.","source":"Now that the assembly has a strong name, you need to determine the strong name of the listener so that `My.Application.Log` uses your log listener."},{"content":"The format of a strongly named type is as follows.","pos":[3462,3512]},{"content":"<ph id=\"ph1\">\\&lt;</ph>type name&gt;, <ph id=\"ph2\">\\&lt;</ph>assembly name&gt;, <ph id=\"ph3\">\\&lt;</ph>version number&gt;, <ph id=\"ph4\">\\&lt;</ph>culture&gt;, <ph id=\"ph5\">\\&lt;</ph>strong name&gt;","pos":[3519,3596],"source":"\\<type name>, \\<assembly name>, \\<version number>, \\<culture>, \\<strong name>"},{"pos":[3607,3651],"content":"To determine the strong name of the listener","linkify":"To determine the strong name of the listener","nodes":[{"content":"To determine the strong name of the listener","pos":[0,44]}]},{"pos":[3661,3753],"content":"The following code shows how to determine the strongly named type name for <ph id=\"ph1\">`SimpleListener`</ph>.","source":"The following code shows how to determine the strongly named type name for `SimpleListener`."},{"content":"The strong name of the type depends on your project.","pos":[3947,3999]},{"pos":[4006,4105],"content":"With the strong name, you can add the listener to the <ph id=\"ph1\">`My.Application.Log`</ph> log-listener collection.","source":"With the strong name, you can add the listener to the `My.Application.Log` log-listener collection."},{"pos":[4116,4157],"content":"To add the listener to My.Application.Log","linkify":"To add the listener to My.Application.Log","nodes":[{"content":"To add the listener to My.Application.Log","pos":[0,41]}]},{"pos":[4167,4242],"content":"Right-click on app.config in the <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and choose <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","source":"Right-click on app.config in the **Solution Explorer** and choose **Open**."},{"content":"-or-","pos":[4253,4257]},{"content":"If there is an app.config file:","pos":[4268,4299]},{"pos":[4313,4362],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Add New Item<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, choose **Add New Item**."},{"pos":[4376,4456],"content":"From the <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> dialog box, choose <bpt id=\"p2\">**</bpt>Application Configuration File<ept id=\"p2\">**</ept>.","source":"From the **Add New Item** dialog box, choose **Application Configuration File**."},{"pos":[4470,4484],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","source":"Click **Add**."},{"content":"Locate the <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section, in the <ph id=\"ph2\">`&lt;source&gt;`</ph> section with the <ph id=\"ph3\">`name`</ph> attribute \"DefaultSource\", located in the <ph id=\"ph4\">`&lt;sources&gt;`</ph> section.","pos":[4494,4632],"source":"Locate the `<listeners>` section, in the `<source>` section with the `name` attribute \"DefaultSource\", located in the `<sources>` section."},{"content":"The <ph id=\"ph1\">`&lt;sources&gt;`</ph> section is located in the <ph id=\"ph2\">`&lt;system.diagnostics&gt;`</ph> section, in the top-level <ph id=\"ph3\">`&lt;configuration&gt;`</ph> section.","pos":[4633,4750],"source":" The `<sources>` section is located in the `<system.diagnostics>` section, in the top-level `<configuration>` section."},{"pos":[4760,4806],"content":"Add this element to the <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section:","source":"Add this element to the `<listeners>` section:"},{"pos":[4870,4992],"content":"Locate the <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> section, in the <ph id=\"ph2\">`&lt;system.diagnostics&gt;`</ph> section, in the top-level <ph id=\"ph3\">`&lt;configuration&gt;`</ph> section.","source":"Locate the `<sharedListeners>` section, in the `<system.diagnostics>` section, in the top-level `<configuration>` section."},{"pos":[5002,5055],"content":"Add this element to that <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> section:","source":"Add this element to that `<sharedListeners>` section:"},{"pos":[5147,5227],"content":"Change the value of <ph id=\"ph1\">`SimpleLogStrongName`</ph> to be the strong name of the listener.","source":"Change the value of `SimpleLogStrongName` to be the strong name of the listener."},{"pos":[5236,5244],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Working with Application Logs<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)</ept><ph id=\"ph1\"> </ph>","pos":[5318,5446],"source":"[Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Log Exceptions<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)</ept><ph id=\"ph1\"> </ph>","pos":[5450,5563],"source":"[How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Write Log Messages<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md)</ept><ph id=\"ph1\"> </ph>","pos":[5567,5688],"source":"[How to: Write Log Messages](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Changing Where My.Application.Log Writes Information<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-changing-where-my-application-log-writes-information.md)</ept>","pos":[5692,5890],"source":"[Walkthrough: Changing Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-changing-where-my-application-log-writes-information.md)"}]}