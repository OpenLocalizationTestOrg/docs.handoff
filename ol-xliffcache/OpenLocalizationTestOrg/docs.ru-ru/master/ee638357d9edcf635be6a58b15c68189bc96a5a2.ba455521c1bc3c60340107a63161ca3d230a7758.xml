{"content":"---\ntitle: \"CreateVersionStringFromModule Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"CreateVersionStringFromModule\"\napi_location: \n  - \"dbgshim.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"CreateVersionStringFromModule\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"debugging API [Silverlight]\"\n  - \"Silverlight, debugging\"\n  - \"CreateVersionStringFromModule function\"\nms.assetid: 3d2fe9bd-75ef-4364-84a6-da1e1994ac1a\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 4\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# CreateVersionStringFromModule Function\nCreates a version string from a common language runtime (CLR) path in a target process.  \n  \n## Syntax  \n  \n```  \nHRESULT CreateVersionStringFromModule (  \n    [in]  DWORD      pidDebuggee,  \n    [in]  LPCWSTR    szModuleName,  \n    [out, size_is(cchBuffer),  \n          length_is(*pdwLength)] LPWSTR Buffer,  \n    [in]  DWORD      cchBuffer,  \n    [out] DWORD*     pdwLength  \n);  \n```  \n  \n#### Parameters  \n `pidDebuggee`  \n [in] Identifier of the process in which the target CLR is loaded.  \n  \n `szModuleName`  \n [in] Full or relative path to the target CLR that is loaded in the process.  \n  \n `pBuffer`  \n [out] Return buffer for storing the version string for the target CLR.  \n  \n `cchBuffer`  \n [in] Size of `pBuffer`.  \n  \n `pdwLength`  \n [out] Length of the version string returned by `pBuffer`.  \n  \n## Return Value  \n S_OK  \n The version string for the target CLR was successfully returned in `pBuffer`.  \n  \n E_INVALIDARG  \n `szModuleName` is null, or either `pBuffer` or `cchBuffer` is null. `pBuffer` and `cchBuffer` must both be null or non-null.  \n  \n HRESULT_FROM_WIN32(ERROR_INSUFFICIENT_BUFFER)  \n `pdwLength` is greater than `cchBuffer`. This may be an expected result if you have passed null for both `pBuffer` and `cchBuffer`, and queried the necessary buffer size by using `pdwLength`.  \n  \n HRESULT_FROM_WIN32(ERROR_MOD_NOT_FOUND)  \n `szModuleName` does not contain a path to a valid CLR in the target process.  \n  \n E_FAIL (or other E_ return codes)  \n `pidDebuggee` does not refer to a valid process, or other failure.  \n  \n## Remarks  \n This function accepts a CLR process that is identified by `pidDebuggee` and a string path that is specified by `szModuleName`. The version string is returned in the buffer that `pBuffer` points to. This string is opaque to the function user; that is, there is no intrinsic meaning in the version string itself. It is used solely in the context of this function and the [CreateDebuggingInterfaceFromVersion function](../../../../docs/framework/unmanaged-api/debugging/createdebugginginterfacefromversion-function-for-silverlight.md).  \n  \n This function should be called twice. When you call it the first time, pass null for both `pBuffer` and `cchBuffer`. When you do this, the size of the buffer necessary for `pBuffer` will be returned in `pdwLength`. You can then call the function a second time, and pass the buffer in `pBuffer` and its size in `cchBuffer`.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** dbgshim.h  \n  \n **Library:** dbgshim.dll  \n  \n **.NET Framework Versions:** 3.5 SP1","nodes":[{"pos":[12,67],"content":"CreateVersionStringFromModule Function | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CreateVersionStringFromModule Function | Microsoft Docs","pos":[0,55]}]},{"pos":[701,739],"content":"CreateVersionStringFromModule Function","linkify":"CreateVersionStringFromModule Function","nodes":[{"content":"CreateVersionStringFromModule Function","pos":[0,38]}]},{"content":"Creates a version string from a common language runtime (CLR) path in a target process.","pos":[740,827]},{"pos":[836,842],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1137,1147],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] Identifier of the process in which the target CLR is loaded.","pos":[1168,1233]},{"content":"[in] Full or relative path to the target CLR that is loaded in the process.","pos":[1258,1333]},{"content":"[out] Return buffer for storing the version string for the target CLR.","pos":[1353,1423]},{"content":"[in] Size of <ph id=\"ph1\">`pBuffer`</ph>.","pos":[1445,1468],"source":" [in] Size of `pBuffer`."},{"content":"[out] Length of the version string returned by <ph id=\"ph1\">`pBuffer`</ph>.","pos":[1490,1547],"source":" [out] Length of the version string returned by `pBuffer`."},{"pos":[1556,1568],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"S_OK","pos":[1572,1576]},{"content":"The version string for the target CLR was successfully returned in <ph id=\"ph1\">`pBuffer`</ph>.","pos":[1580,1657],"source":" The version string for the target CLR was successfully returned in `pBuffer`."},{"content":"E_INVALIDARG","pos":[1664,1676]},{"content":"<ph id=\"ph1\"> `szModuleName`</ph> is null, or either <ph id=\"ph2\">`pBuffer`</ph> or <ph id=\"ph3\">`cchBuffer`</ph> is null.","pos":[1679,1747],"source":" `szModuleName` is null, or either `pBuffer` or `cchBuffer` is null."},{"content":"<ph id=\"ph1\">`pBuffer`</ph> and <ph id=\"ph2\">`cchBuffer`</ph> must both be null or non-null.","pos":[1748,1804],"source":"`pBuffer` and `cchBuffer` must both be null or non-null."},{"content":"HRESULT_FROM_WIN32(ERROR_INSUFFICIENT_BUFFER)","pos":[1811,1856]},{"content":"<ph id=\"ph1\"> `pdwLength`</ph> is greater than <ph id=\"ph2\">`cchBuffer`</ph>.","pos":[1859,1900],"source":" `pdwLength` is greater than `cchBuffer`."},{"content":"This may be an expected result if you have passed null for both <ph id=\"ph1\">`pBuffer`</ph> and <ph id=\"ph2\">`cchBuffer`</ph>, and queried the necessary buffer size by using <ph id=\"ph3\">`pdwLength`</ph>.","pos":[1901,2051],"source":" This may be an expected result if you have passed null for both `pBuffer` and `cchBuffer`, and queried the necessary buffer size by using `pdwLength`."},{"content":"HRESULT_FROM_WIN32(ERROR_MOD_NOT_FOUND)","pos":[2058,2097]},{"content":"<ph id=\"ph1\"> `szModuleName`</ph> does not contain a path to a valid CLR in the target process.","pos":[2100,2177],"source":" `szModuleName` does not contain a path to a valid CLR in the target process."},{"content":"E_FAIL (or other E_ return codes)","pos":[2184,2217]},{"content":"<ph id=\"ph1\"> `pidDebuggee`</ph> does not refer to a valid process, or other failure.","pos":[2220,2287],"source":" `pidDebuggee` does not refer to a valid process, or other failure."},{"pos":[2296,2303],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This function accepts a CLR process that is identified by <ph id=\"ph1\">`pidDebuggee`</ph> and a string path that is specified by <ph id=\"ph2\">`szModuleName`</ph>.","pos":[2307,2433],"source":"This function accepts a CLR process that is identified by `pidDebuggee` and a string path that is specified by `szModuleName`."},{"content":"The version string is returned in the buffer that <ph id=\"ph1\">`pBuffer`</ph> points to.","pos":[2434,2504],"source":" The version string is returned in the buffer that `pBuffer` points to."},{"content":"This string is opaque to the function user; that is, there is no intrinsic meaning in the version string itself.","pos":[2505,2617]},{"content":"It is used solely in the context of this function and the <bpt id=\"p1\">[</bpt>CreateDebuggingInterfaceFromVersion function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/createdebugginginterfacefromversion-function-for-silverlight.md)</ept>.","pos":[2618,2839],"source":" It is used solely in the context of this function and the [CreateDebuggingInterfaceFromVersion function](../../../../docs/framework/unmanaged-api/debugging/createdebugginginterfacefromversion-function-for-silverlight.md)."},{"content":"This function should be called twice.","pos":[2846,2883]},{"content":"When you call it the first time, pass null for both <ph id=\"ph1\">`pBuffer`</ph> and <ph id=\"ph2\">`cchBuffer`</ph>.","pos":[2884,2962],"source":" When you call it the first time, pass null for both `pBuffer` and `cchBuffer`."},{"content":"When you do this, the size of the buffer necessary for <ph id=\"ph1\">`pBuffer`</ph> will be returned in <ph id=\"ph2\">`pdwLength`</ph>.","pos":[2963,3060],"source":" When you do this, the size of the buffer necessary for `pBuffer` will be returned in `pdwLength`."},{"content":"You can then call the function a second time, and pass the buffer in <ph id=\"ph1\">`pBuffer`</ph> and its size in <ph id=\"ph2\">`cchBuffer`</ph>.","pos":[3061,3168],"source":" You can then call the function a second time, and pass the buffer in `pBuffer` and its size in `cchBuffer`."},{"pos":[3177,3189],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3193,3297],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3304,3325],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> dbgshim.h","source":"**Header:** dbgshim.h"},{"pos":[3332,3356],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> dbgshim.dll","source":"**Library:** dbgshim.dll"},{"pos":[3363,3399],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> 3.5 SP1","source":"**.NET Framework Versions:** 3.5 SP1"}]}