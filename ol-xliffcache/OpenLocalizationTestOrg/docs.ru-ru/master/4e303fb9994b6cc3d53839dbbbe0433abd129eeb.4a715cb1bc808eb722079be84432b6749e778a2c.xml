{"content":"---\ntitle: \"Guidelines for Creating Components for Side-by-Side Execution | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"side-by-side execution, multiple application versions\"\n  - \"side-by-side execution, multiple component versions\"\nms.assetid: 5c540161-6e40-42e9-be92-6175aee2c46a\ncaps.latest.revision: 9\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Guidelines for Creating Components for Side-by-Side Execution\nFollow these general guidelines to create managed applications or components designed for side-by-side execution:  \n  \n-   Bind type identity to a particular version of a file.  \n  \n     The common language runtime binds type identity to a particular file version by using strong-named assemblies. To create an application or component for side-by-side execution, you must give all assemblies a strong name. This creates precise type identity and ensures that any type resolution is directed to the correct file. A strong-named assembly contains version, culture, and publisher information that the runtime uses to locate the correct file to fulfill a binding request.  \n  \n-   Use version-aware storage.  \n  \n     The runtime uses the global assembly cache to provide version-aware storage. The global assembly cache is a version-aware directory structure installed on every computer that uses the .NET Framework. Assemblies installed in the global assembly cache are not overwritten when a new version of that assembly is installed.  \n  \n-   Create an application or component that runs in isolation.  \n  \n     An application or component that runs in isolation must manage resources to avoid conflicts when two instances of the application or component are running simultaneously. The application or component must also use a version-specific file structure.  \n  \n## Application and Component Isolation  \n One key to successfully designing an application or component for side-by-side execution is isolation. The application or component must manage all resources, particularly file I/O, in an isolated manner. Follow these guidelines to make sure your application or component runs in isolation:  \n  \n-   Write to the registry in a version-specific way. Store values in hives or keys that indicate the version, and do not share information or state across versions of a component. This prevents two applications or components running at the same time from overwriting information.  \n  \n-   Make named kernel objects version-specific so that a race condition does not occur. For example, a race condition occurs when two semaphores from two versions of the same application wait on each other.  \n  \n-   Make file and directory names version-aware. This means that file structures should rely on version information.  \n  \n-   Create user accounts and groups in a version-specific manner. User accounts and groups created by an application should be identified by version. Do not share user accounts and groups between versions of an application.  \n  \n## Installing and Uninstalling Versions  \n When designing an application for side-by-side execution, follow these guidelines concerning installing and uninstalling versions:  \n  \n-   Do not delete information from the registry that may be needed by other applications running under a different version of the .NET Framework.  \n  \n-   Do not replace information in the registry that may be needed by other applications running under a different version of the .NET Framework.  \n  \n-   Do not unregister COM components that may be needed by other applications running under a different version of the .NET Framework.  \n  \n-   Do not change **InprocServer32** or other registry entries for a COM server that was already registered.  \n  \n-   Do not delete user accounts or groups that may be needed by other applications running under a different version of the .NET Framework.  \n  \n-   Do not add anything to the registry that contains an unversioned path.  \n  \n## File Version Number and Assembly Version Number  \n File version is a Win32 version resource that is not used by the runtime. In general, you update the file version even for an in-place update. Two identical files can have different file version information, and two different files can have the same file version information.  \n  \n The assembly version is used by the runtime for assembly binding. Two identical assemblies with different version numbers are treated as two different assemblies by the runtime.  \n  \n The [Global Assembly Cache tool (Gacutil.exe)](../../../docs/framework/tools/gacutil-exe-gac-tool.md) allows you to replace an assembly when only the file version number is newer. The installer generally does not install over an assembly unless the assembly version number is greater.  \n  \n## See Also  \n [Side-by-Side Execution](../../../docs/framework/deployment/side-by-side-execution.md)   \n [How to: Enable and Disable Automatic Binding Redirection](../../../docs/framework/configure-apps/how-to-enable-and-disable-automatic-binding-redirection.md)","nodes":[{"pos":[4,583],"nodes":[{"content":"Guidelines for Creating Components for Side-by-Side Execution | Microsoft Docs","nodes":[{"pos":[0,78],"content":"Guidelines for Creating Components for Side-by-Side Execution | Microsoft Docs","nodes":[{"content":"Guidelines for Creating Components for Side-by-Side Execution | Microsoft Docs","pos":[0,78]}]}],"pos":[6,87],"yaml":true}],"content":"title: \"Guidelines for Creating Components for Side-by-Side Execution | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"side-by-side execution, multiple application versions\"\n  - \"side-by-side execution, multiple component versions\"\nms.assetid: 5c540161-6e40-42e9-be92-6175aee2c46a\ncaps.latest.revision: 9\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[590,651],"content":"Guidelines for Creating Components for Side-by-Side Execution","linkify":"Guidelines for Creating Components for Side-by-Side Execution","nodes":[{"content":"Guidelines for Creating Components for Side-by-Side Execution","pos":[0,61]}]},{"content":"Follow these general guidelines to create managed applications or components designed for side-by-side execution:","pos":[652,765]},{"content":"Bind type identity to a particular version of a file.","pos":[775,828]},{"content":"The common language runtime binds type identity to a particular file version by using strong-named assemblies.","pos":[839,949]},{"content":"To create an application or component for side-by-side execution, you must give all assemblies a strong name.","pos":[950,1059]},{"content":"This creates precise type identity and ensures that any type resolution is directed to the correct file.","pos":[1060,1164]},{"content":"A strong-named assembly contains version, culture, and publisher information that the runtime uses to locate the correct file to fulfill a binding request.","pos":[1165,1320]},{"content":"Use version-aware storage.","pos":[1330,1356]},{"content":"The runtime uses the global assembly cache to provide version-aware storage.","pos":[1367,1443]},{"content":"The global assembly cache is a version-aware directory structure installed on every computer that uses the .NET Framework.","pos":[1444,1566]},{"content":"Assemblies installed in the global assembly cache are not overwritten when a new version of that assembly is installed.","pos":[1567,1686]},{"content":"Create an application or component that runs in isolation.","pos":[1696,1754]},{"content":"An application or component that runs in isolation must manage resources to avoid conflicts when two instances of the application or component are running simultaneously.","pos":[1765,1935]},{"content":"The application or component must also use a version-specific file structure.","pos":[1936,2013]},{"pos":[2022,2057],"content":"Application and Component Isolation","linkify":"Application and Component Isolation","nodes":[{"content":"Application and Component Isolation","pos":[0,35]}]},{"content":"One key to successfully designing an application or component for side-by-side execution is isolation.","pos":[2061,2163]},{"content":"The application or component must manage all resources, particularly file I/O, in an isolated manner.","pos":[2164,2265]},{"content":"Follow these guidelines to make sure your application or component runs in isolation:","pos":[2266,2351]},{"content":"Write to the registry in a version-specific way.","pos":[2361,2409]},{"content":"Store values in hives or keys that indicate the version, and do not share information or state across versions of a component.","pos":[2410,2536]},{"content":"This prevents two applications or components running at the same time from overwriting information.","pos":[2537,2636]},{"content":"Make named kernel objects version-specific so that a race condition does not occur.","pos":[2646,2729]},{"content":"For example, a race condition occurs when two semaphores from two versions of the same application wait on each other.","pos":[2730,2848]},{"content":"Make file and directory names version-aware.","pos":[2858,2902]},{"content":"This means that file structures should rely on version information.","pos":[2903,2970]},{"content":"Create user accounts and groups in a version-specific manner.","pos":[2980,3041]},{"content":"User accounts and groups created by an application should be identified by version.","pos":[3042,3125]},{"content":"Do not share user accounts and groups between versions of an application.","pos":[3126,3199]},{"pos":[3208,3244],"content":"Installing and Uninstalling Versions","linkify":"Installing and Uninstalling Versions","nodes":[{"content":"Installing and Uninstalling Versions","pos":[0,36]}]},{"content":"When designing an application for side-by-side execution, follow these guidelines concerning installing and uninstalling versions:","pos":[3248,3378]},{"content":"Do not delete information from the registry that may be needed by other applications running under a different version of the .NET Framework.","pos":[3388,3529]},{"content":"Do not replace information in the registry that may be needed by other applications running under a different version of the .NET Framework.","pos":[3539,3679]},{"content":"Do not unregister COM components that may be needed by other applications running under a different version of the .NET Framework.","pos":[3689,3819]},{"pos":[3829,3933],"content":"Do not change <bpt id=\"p1\">**</bpt>InprocServer32<ept id=\"p1\">**</ept> or other registry entries for a COM server that was already registered.","source":"Do not change **InprocServer32** or other registry entries for a COM server that was already registered."},{"content":"Do not delete user accounts or groups that may be needed by other applications running under a different version of the .NET Framework.","pos":[3943,4078]},{"content":"Do not add anything to the registry that contains an unversioned path.","pos":[4088,4158]},{"pos":[4167,4214],"content":"File Version Number and Assembly Version Number","linkify":"File Version Number and Assembly Version Number","nodes":[{"content":"File Version Number and Assembly Version Number","pos":[0,47]}]},{"content":"File version is a Win32 version resource that is not used by the runtime.","pos":[4218,4291]},{"content":"In general, you update the file version even for an in-place update.","pos":[4292,4360]},{"content":"Two identical files can have different file version information, and two different files can have the same file version information.","pos":[4361,4493]},{"content":"The assembly version is used by the runtime for assembly binding.","pos":[4500,4565]},{"content":"Two identical assemblies with different version numbers are treated as two different assemblies by the runtime.","pos":[4566,4677]},{"content":"The <bpt id=\"p1\">[</bpt>Global Assembly Cache tool (Gacutil.exe)<ept id=\"p1\">](../../../docs/framework/tools/gacutil-exe-gac-tool.md)</ept> allows you to replace an assembly when only the file version number is newer.","pos":[4684,4863],"source":"The [Global Assembly Cache tool (Gacutil.exe)](../../../docs/framework/tools/gacutil-exe-gac-tool.md) allows you to replace an assembly when only the file version number is newer."},{"content":"The installer generally does not install over an assembly unless the assembly version number is greater.","pos":[4864,4968]},{"pos":[4977,4985],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Side-by-Side Execution<ept id=\"p1\">](../../../docs/framework/deployment/side-by-side-execution.md)</ept><ph id=\"ph1\"> </ph>","pos":[4989,5076],"source":"[Side-by-Side Execution](../../../docs/framework/deployment/side-by-side-execution.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Enable and Disable Automatic Binding Redirection<ept id=\"p1\">](../../../docs/framework/configure-apps/how-to-enable-and-disable-automatic-binding-redirection.md)</ept>","pos":[5080,5237],"source":"[How to: Enable and Disable Automatic Binding Redirection](../../../docs/framework/configure-apps/how-to-enable-and-disable-automatic-binding-redirection.md)"}]}