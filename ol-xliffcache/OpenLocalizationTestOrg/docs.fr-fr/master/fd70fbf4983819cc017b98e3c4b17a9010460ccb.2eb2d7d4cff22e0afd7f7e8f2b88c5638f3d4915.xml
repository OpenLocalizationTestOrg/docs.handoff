{"content":"---\ntitle: \"Message Security Windows\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"WS Security\"\nms.assetid: d2221d1c-c9cb-48d1-b044-a3b4445c7f05\n---\n# Message Security Windows\nThis sample demonstrates how to configure a <xref:System.ServiceModel.WSHttpBinding> binding to use message-level security with Windows authentication. This sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md). In this sample, the service is hosted in Internet Information Services (IIS) and the client is a console application (.exe).  \n  \n> [!NOTE]\n>  The setup procedure and build instructions for this sample are located at the end of this topic.  \n  \n The default security for the [\\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md) is message security using Windows authentication. The configuration files in this sample explicitly set the `mode` attribute of the [\\<security>](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-wshttpbinding.md) to `Message` and the `clientCredentialType` attribute to `Windows`. These values are the default values for this binding, but they have been explicitly configured, as shown in the following sample configuration to demonstrate their use.  \n  \n```xml  \n<bindings>  \n    <wsHttpBinding>  \n        <binding>  \n            <security mode=\"Message\">  \n                <message clientCredentialType=\"Windows\"/>  \n            </security>  \n        </binding>  \n    </wsHttpBinding>  \n</bindings>  \n```  \n  \n The client endpoint configuration consists of an absolute address for the service endpoint, the binding, and the contract. The client binding is configured with the appropriate `securityMode` and `authenticationMode`.  \n  \n```xml  \n<system.serviceModel>  \n  <client>  \n    <endpoint address=  \n            \"http://localhost/servicemodelsamples/service.svc\"   \n            binding=\"wsHttpBinding\"   \n            bindingConfiguration=\"Binding1\"   \n            contract=\"Microsoft.ServiceModel.Samples.ICalculator\" />  \n  </client>  \n  \n  <bindings>  \n    <wsHttpBinding>  \n      <!-- The default security for the WSHttpBinding is -->  \n      <!-- Message security using Windows authentication. -->  \n      <!-- This configuration explicitly defines the security mode -->  \n      <!-- as Message and the clientCredentialType as Windows -->  \n      <!-- for demonstration purposes. -->  \n      <binding name=\"Binding1\">  \n        <security mode=\"Message\">  \n          <message clientCredentialType=\"Windows\"/>  \n        </security>  \n      </binding>  \n    </wsHttpBinding>  \n  </bindings>  \n</system.serviceModel>  \n```  \n  \n The service source code has been modified to demonstrate how the <xref:System.ServiceModel.OperationContext.ServiceSecurityContext%2A> can be used to access the identity of the caller.  \n\n```csharp\npublic string GetCallerIdentity()  \n{  \n    // The Windows identity of the caller can be accessed on the ServiceSecurityContext.WindowsIdentity.  \n    return OperationContext.Current.ServiceSecurityContext.WindowsIdentity.Name;  \n}  \n```\n\n When you run the sample, the operation requests and responses are displayed in the client console window. The first method called - `GetCallerIdentity` - returns the name of the caller identity back to the client. Press ENTER in the console window to shut down the client.  \n  \n### To set up, build, and run the sample  \n  \n1.  Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md).  \n  \n2.  To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md).  \n  \n3.  To run the sample in a single- or cross-computer configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md).  \n","nodes":[{"pos":[4,148],"embed":true,"restype":"x-metadata","content":"title: \"Message Security Windows\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"WS Security\"\nms.assetid: d2221d1c-c9cb-48d1-b044-a3b4445c7f05","nodes":[{"content":"Message Security Windows","nodes":[{"pos":[0,24],"content":"Message Security Windows","nodes":[{"content":"Message Security Windows","pos":[0,24]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[155,179],"content":"Message Security Windows","linkify":"Message Security Windows","nodes":[{"content":"Message Security Windows","pos":[0,24]}]},{"content":"This sample demonstrates how to configure a <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> binding to use message-level security with Windows authentication.","pos":[180,331],"source":"This sample demonstrates how to configure a <xref:System.ServiceModel.WSHttpBinding> binding to use message-level security with Windows authentication."},{"content":"This sample is based on the <bpt id=\"p1\">[</bpt>Getting Started<ept id=\"p1\">](../../../../docs/framework/wcf/samples/getting-started-sample.md)</ept>.","pos":[332,444],"source":" This sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md)."},{"content":"In this sample, the service is hosted in Internet Information Services (IIS) and the client is a console application (.exe).","pos":[445,569]},{"pos":[577,684],"content":"[!NOTE]\n The setup procedure and build instructions for this sample are located at the end of this topic.","leadings":["","> "],"nodes":[{"content":"The setup procedure and build instructions for this sample are located at the end of this topic.","pos":[9,105]}]},{"content":"The default security for the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>wsHttpBinding&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md)</ept> is message security using Windows authentication.","pos":[691,864],"source":"The default security for the [\\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md) is message security using Windows authentication."},{"content":"The configuration files in this sample explicitly set the <ph id=\"ph1\">`mode`</ph> attribute of the <bpt id=\"p1\">[</bpt><ph id=\"ph2\">\\&lt;</ph>security&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-wshttpbinding.md)</ept> to <ph id=\"ph3\">`Message`</ph> and the <ph id=\"ph4\">`clientCredentialType`</ph> attribute to <ph id=\"ph5\">`Windows`</ph>.","pos":[865,1116],"source":" The configuration files in this sample explicitly set the `mode` attribute of the [\\<security>](../../../../docs/framework/configure-apps/file-schema/wcf/security-of-wshttpbinding.md) to `Message` and the `clientCredentialType` attribute to `Windows`."},{"content":"These values are the default values for this binding, but they have been explicitly configured, as shown in the following sample configuration to demonstrate their use.","pos":[1117,1285]},{"content":"The client endpoint configuration consists of an absolute address for the service endpoint, the binding, and the contract.","pos":[1549,1671]},{"content":"The client binding is configured with the appropriate <ph id=\"ph1\">`securityMode`</ph> and <ph id=\"ph2\">`authenticationMode`</ph>.","pos":[1672,1766],"source":" The client binding is configured with the appropriate `securityMode` and `authenticationMode`."},{"pos":[2672,2856],"content":"The service source code has been modified to demonstrate how the <ph id=\"ph1\">&lt;xref:System.ServiceModel.OperationContext.ServiceSecurityContext%2A&gt;</ph> can be used to access the identity of the caller.","source":"The service source code has been modified to demonstrate how the <xref:System.ServiceModel.OperationContext.ServiceSecurityContext%2A> can be used to access the identity of the caller."},{"content":"When you run the sample, the operation requests and responses are displayed in the client console window.","pos":[3110,3215]},{"content":"The first method called - <ph id=\"ph1\">`GetCallerIdentity`</ph> - returns the name of the caller identity back to the client.","pos":[3216,3323],"source":" The first method called - `GetCallerIdentity` - returns the name of the caller identity back to the client."},{"content":"Press ENTER in the console window to shut down the client.","pos":[3324,3382]},{"pos":[3392,3428],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"pos":[3438,3637],"content":"Ensure that you have performed the <bpt id=\"p1\">[</bpt>One-Time Setup Procedure for the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)</ept>.","source":"Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)."},{"pos":[3647,3856],"content":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in <bpt id=\"p1\">[</bpt>Building the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/building-the-samples.md)</ept>.","source":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md)."},{"pos":[3866,4075],"content":"To run the sample in a single- or cross-computer configuration, follow the instructions in <bpt id=\"p1\">[</bpt>Running the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/running-the-samples.md)</ept>.","source":"To run the sample in a single- or cross-computer configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md)."}]}