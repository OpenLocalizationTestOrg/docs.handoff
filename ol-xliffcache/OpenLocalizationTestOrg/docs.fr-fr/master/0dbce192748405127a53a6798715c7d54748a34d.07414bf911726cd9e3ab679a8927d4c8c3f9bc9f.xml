{"content":"---\ntitle: \"Transaction Support | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 8cceb26e-8d36-4365-8967-58e2e89e0187\ncaps.latest.revision: 2\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Transaction Support\n[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] supports three distinct transaction models. The following lists these models in the order of checks performed.  \n  \n## Explicit Local Transaction  \n When <xref:System.Data.Linq.DataContext.SubmitChanges%2A> is called, if the <xref:System.Data.Linq.DataContext.Transaction%2A> property is set to a (`IDbTransaction`) transaction, the <xref:System.Data.Linq.DataContext.SubmitChanges%2A> call is executed in the context of the same transaction.  \n  \n It is your responsibility to commit or rollback the transaction after successful execution of the transaction. The connection corresponding to the transaction must match the connection used for constructing the <xref:System.Data.Linq.DataContext>. An exception is thrown if a different connection is used.  \n  \n## Explicit Distributable Transaction  \n You can call [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] APIs (including but not limited to <xref:System.Data.Linq.DataContext.SubmitChanges%2A>) in the scope of an active <xref:System.Transactions.Transaction>. [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] detects that the call is in the scope of a transaction and does not create a new transaction. [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] also avoids closing the connection in this case. You can perform query and <xref:System.Data.Linq.DataContext.SubmitChanges%2A> executions in the context of such a transaction.  \n  \n## Implicit Transaction  \n When you call <xref:System.Data.Linq.DataContext.SubmitChanges%2A>, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] checks to see whether the call is in the scope of a <xref:System.Transactions.Transaction> or if the `Transaction` property (`IDbTransaction`) is set to a user-started local transaction. If it finds neither transaction, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] starts a local transaction (`IDbTransaction`) and uses it to execute the generated SQL commands. When all SQL commands have been successfully completed, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] commits the local transaction and returns.  \n  \n## See Also  \n [Background Information](../../../../../../docs/framework/data/adonet/sql/linq/background-information.md)   \n [How to: Bracket Data Submissions by Using Transactions](../../../../../../docs/framework/data/adonet/sql/linq/how-to-bracket-data-submissions-by-using-transactions.md)","nodes":[{"pos":[4,350],"embed":true,"restype":"x-metadata","content":"title: \"Transaction Support | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 8cceb26e-8d36-4365-8967-58e2e89e0187\ncaps.latest.revision: 2\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","nodes":[{"content":"Transaction Support | Microsoft Docs","nodes":[{"pos":[0,36],"content":"Transaction Support | Microsoft Docs","nodes":[{"content":"Transaction Support | Microsoft Docs","pos":[0,36]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[357,376],"content":"Transaction Support","linkify":"Transaction Support","nodes":[{"content":"Transaction Support","pos":[0,19]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> supports three distinct transaction models.","pos":[377,488],"source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] supports three distinct transaction models."},{"content":"The following lists these models in the order of checks performed.","pos":[489,555]},{"pos":[564,590],"content":"Explicit Local Transaction","linkify":"Explicit Local Transaction","nodes":[{"content":"Explicit Local Transaction","pos":[0,26]}]},{"pos":[594,887],"content":"When <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext.SubmitChanges%2A&gt;</ph> is called, if the <ph id=\"ph2\">&lt;xref:System.Data.Linq.DataContext.Transaction%2A&gt;</ph> property is set to a (<ph id=\"ph3\">`IDbTransaction`</ph>) transaction, the <ph id=\"ph4\">&lt;xref:System.Data.Linq.DataContext.SubmitChanges%2A&gt;</ph> call is executed in the context of the same transaction.","source":"When <xref:System.Data.Linq.DataContext.SubmitChanges%2A> is called, if the <xref:System.Data.Linq.DataContext.Transaction%2A> property is set to a (`IDbTransaction`) transaction, the <xref:System.Data.Linq.DataContext.SubmitChanges%2A> call is executed in the context of the same transaction."},{"content":"It is your responsibility to commit or rollback the transaction after successful execution of the transaction.","pos":[894,1004]},{"content":"The connection corresponding to the transaction must match the connection used for constructing the <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph>.","pos":[1005,1141],"source":" The connection corresponding to the transaction must match the connection used for constructing the <xref:System.Data.Linq.DataContext>."},{"content":"An exception is thrown if a different connection is used.","pos":[1142,1199]},{"pos":[1208,1242],"content":"Explicit Distributable Transaction","linkify":"Explicit Distributable Transaction","nodes":[{"content":"Explicit Distributable Transaction","pos":[0,34]}]},{"content":"You can call <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> APIs (including but not limited to <ph id=\"ph2\">&lt;xref:System.Data.Linq.DataContext.SubmitChanges%2A&gt;</ph>) in the scope of an active <ph id=\"ph3\">&lt;xref:System.Transactions.Transaction&gt;</ph>.","pos":[1246,1481],"source":"You can call [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] APIs (including but not limited to <xref:System.Data.Linq.DataContext.SubmitChanges%2A>) in the scope of an active <xref:System.Transactions.Transaction>."},{"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> detects that the call is in the scope of a transaction and does not create a new transaction.","pos":[1482,1643],"source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] detects that the call is in the scope of a transaction and does not create a new transaction."},{"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> also avoids closing the connection in this case.","pos":[1644,1760],"source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] also avoids closing the connection in this case."},{"content":"You can perform query and <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext.SubmitChanges%2A&gt;</ph> executions in the context of such a transaction.","pos":[1761,1888],"source":" You can perform query and <xref:System.Data.Linq.DataContext.SubmitChanges%2A> executions in the context of such a transaction."},{"pos":[1897,1917],"content":"Implicit Transaction","linkify":"Implicit Transaction","nodes":[{"content":"Implicit Transaction","pos":[0,20]}]},{"content":"When you call <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext.SubmitChanges%2A&gt;</ph>, <ph id=\"ph2\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> checks to see whether the call is in the scope of a <ph id=\"ph3\">&lt;xref:System.Transactions.Transaction&gt;</ph> or if the <ph id=\"ph4\">`Transaction`</ph> property (<ph id=\"ph5\">`IDbTransaction`</ph>) is set to a user-started local transaction.","pos":[1921,2243],"source":"When you call <xref:System.Data.Linq.DataContext.SubmitChanges%2A>, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] checks to see whether the call is in the scope of a <xref:System.Transactions.Transaction> or if the `Transaction` property (`IDbTransaction`) is set to a user-started local transaction."},{"content":"If it finds neither transaction, <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> starts a local transaction (<ph id=\"ph2\">`IDbTransaction`</ph>) and uses it to execute the generated SQL commands.","pos":[2244,2441],"source":" If it finds neither transaction, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] starts a local transaction (`IDbTransaction`) and uses it to execute the generated SQL commands."},{"content":"When all SQL commands have been successfully completed, <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> commits the local transaction and returns.","pos":[2442,2608],"source":" When all SQL commands have been successfully completed, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] commits the local transaction and returns."},{"pos":[2617,2625],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Background Information<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/background-information.md)</ept><ph id=\"ph1\"> </ph>","pos":[2629,2735],"source":"[Background Information](../../../../../../docs/framework/data/adonet/sql/linq/background-information.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Bracket Data Submissions by Using Transactions<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-bracket-data-submissions-by-using-transactions.md)</ept>","pos":[2739,2907],"source":"[How to: Bracket Data Submissions by Using Transactions](../../../../../../docs/framework/data/adonet/sql/linq/how-to-bracket-data-submissions-by-using-transactions.md)"}]}