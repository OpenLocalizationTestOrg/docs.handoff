{"content":"---\ntitle: \"IMetaDataDispenserEx::SetOption Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataDispenserEx.SetOption\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataDispenserEx::SetOption\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IMetaDataDispenserEx::SetOption method [.NET Framework metadata]\"\n  - \"SetOption method [.NET Framework metadata]\"\nms.assetid: 9f1c7ccd-7fb2-41d8-aa00-24b823376527\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 20\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# IMetaDataDispenserEx::SetOption Method\nSets the specified option to a given value for the current metadata scope. The option controls how calls to the current metadata scope are handled.  \n  \n## Syntax  \n  \n```  \nHRESULT SetOption (  \n    [in] REFGUID optionId,   \n    [in] const VARIANT *pValue  \n);  \n```  \n  \n#### Parameters  \n `optionId`  \n [in] A pointer to a GUID that specifies the option to be set.  \n  \n `pValue`  \n [in] The value to use to set the option. The type of this value must be a variant of the specified option's type.  \n  \n## Remarks  \n The following table lists the available GUIDs that the `optionId` parameter can point to and the corresponding valid values for the `pValue` parameter.  \n  \n|GUID|Description|`pValue` Parameter|  \n|----------|-----------------|------------------------|  \n|MetaDataCheckDuplicatesFor|Controls which items are checked for duplicates. Each time you call an [IMetaDataEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md) method that creates a new item, you can ask the method to check whether the item already exists in the current scope. For example, you can check for the existence of `mdMethodDef` items; in this case, when you call [IMetaDataEmit::DefineMethod](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemethod-method.md), it will check that the method does not already exist in the current scope. This check uses the key that uniquely identifies a given method: parent type, name, and signature.|Must be a variant of type UI4, and must contain a combination of the values of the [CorCheckDuplicatesFor](../../../../docs/framework/unmanaged-api/metadata/corcheckduplicatesfor-enumeration.md) enumeration.|  \n|MetaDataRefToDefCheck|Controls which referenced items are converted to definitions. By default, the metadata engine will optimize the code by converting a referenced item to its definition if the referenced item is actually defined in the current scope.|Must be a variant of type UI4, and must contain a combination of the values of the [CorRefToDefCheck](../../../../docs/framework/unmanaged-api/metadata/correftodefcheck-enumeration.md) enumeration.|  \n|MetaDataNotificationForTokenMovement|Controls which token remaps occurring during a metadata merge generate callbacks. Use the [IMetaDataEmit::SetHandler](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md) method to establish your [IMapToken](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md) interface.|Must be a variant of type UI4, and must contain a combination of the values of the [CorNotificationForTokenMovement](../../../../docs/framework/unmanaged-api/metadata/cornotificationfortokenmovement-enumeration.md) enumeration.|  \n|MetaDataSetENC|Controls the behavior of edit-and-continue (ENC). Only one mode of behavior can be set at a time.|Must be a variant of type UI4, and must contain a value of the [CorSetENC](../../../../docs/framework/unmanaged-api/metadata/corsetenc-enumeration.md) enumeration. The value is not a bitmask.|  \n|MetaDataErrorIfEmitOutOfOrder|Controls which emitted-out-of-order errors generate callbacks. Emitting metadata out of order is not fatal; however, if you emit metadata in an order that is favored by the metadata engine, the metadata is more compact and therefore can be more efficiently searched. Use the `IMetaDataEmit::SetHandler` method to establish your [IMetaDataError](../../../../docs/framework/unmanaged-api/metadata/imetadataerror-interface.md) interface.|Must be a variant of type UI4, and must contain a combination of the values of the [CorErrorIfEmitOutOfOrder](../../../../docs/framework/unmanaged-api/metadata/corerrorifemitoutoforder-enumeration.md) enumeration.|  \n|MetaDataImportOption|Controls which kinds of items that were deleted during an ENC are retrieved by an enumerator.|Must be a variant of type UI4, and must contain a combination of the values of the [CorImportOptions Enumeration](../../../../docs/framework/unmanaged-api/metadata/corimportoptions-enumeration.md) enumeration.|  \n|MetaDataThreadSafetyOptions|Controls whether the metadata engine obtains reader/writer locks, thereby ensuring thread safety. By default, the engine assumes that access is single-threaded by the caller, so no locks are obtained. Clients are responsible for maintaining proper thread synchronization when using the metadata API.|Must be a variant of type UI4, and must contain a value of the [CorThreadSafetyOptions](../../../../docs/framework/unmanaged-api/metadata/corthreadsafetyoptions-enumeration.md) enumeration. The value is not a bitmask.|  \n|MetaDataGenerateTCEAdapters|Controls whether the type library importer should generate the tightly coupled event (TCE) adapters for COM connection point containers.|Must be a variant of type BOOL. If `pValue` is set to `true`, the type library importer generates the TCE adapters.|  \n|MetaDataTypeLibImportNamespace|Specifies a non-default namespace for the type library that is being imported.|Must be either a null value or a variant of type BSTR. If `pValue` is a null value, the current namespace is set to null; otherwise, the current namespace is set to the string that is held in the variant's BSTR type.|  \n|MetaDataLinkerOptions|Controls whether the linker should generate an assembly or a .NET Framework module file.|Must be a variant of type UI4, and must contain a combination of the values of the [CorLinkerOptions](../../../../docs/framework/unmanaged-api/metadata/corlinkeroptions-enumeration.md) enumeration.|  \n|MetaDataRuntimeVersion|Specifies the version of the common language runtime against which this image was built. The version is stored as a string, such as \"v1.0.3705\".|Must be a null value, a VT_EMPTY value, or a variant of type BSTR. If `pValue` is null, the runtime version is set to null. If `pValue` is VT_EMPTY, the version is set to a default value, which is drawn from the version of Mscorwks.dll within which the metadata code is running. Otherwise, the runtime version is set to the string that is held in the variant's BSTR type.|  \n|MetaDataMergerOptions|Specifies options for merging metadata.|Must be a variant of type UI4, and must contain a combination of the values of the `MergeFlags` enumeration, which is described in the CorHdr.h file.|  \n|MetaDataPreserveLocalRefs|Disables optimizing local references into definitions.|Must contain a combination of the values of the [CorLocalRefPreservation](../../../../docs/framework/unmanaged-api/metadata/corlocalrefpreservation-enumeration.md) enumeration.|  \n  \n## Requirements  \n **Platform:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** Cor.h  \n  \n **Library:** Used as a resource in MsCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See Also  \n [IMetaDataDispenserEx Interface](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenserex-interface.md)   \n [IMetaDataDispenser Interface](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-interface.md)","nodes":[{"pos":[12,67],"content":"IMetaDataDispenserEx::SetOption Method | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IMetaDataDispenserEx::SetOption Method | Microsoft Docs","pos":[0,55]}]},{"pos":[714,752],"content":"IMetaDataDispenserEx::SetOption Method","linkify":"IMetaDataDispenserEx::SetOption Method","nodes":[{"content":"IMetaDataDispenserEx::SetOption Method","pos":[0,38]}]},{"content":"Sets the specified option to a given value for the current metadata scope.","pos":[753,827]},{"content":"The option controls how calls to the current metadata scope are handled.","pos":[828,900]},{"pos":[909,915],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1031,1041],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A pointer to a GUID that specifies the option to be set.","pos":[1059,1120]},{"content":"[in] The value to use to set the option.","pos":[1139,1179]},{"content":"The type of this value must be a variant of the specified option's type.","pos":[1180,1252]},{"pos":[1261,1268],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[1272,1423],"content":"The following table lists the available GUIDs that the <ph id=\"ph1\">`optionId`</ph> parameter can point to and the corresponding valid values for the <ph id=\"ph2\">`pValue`</ph> parameter.","source":"The following table lists the available GUIDs that the `optionId` parameter can point to and the corresponding valid values for the `pValue` parameter."},{"content":"GUID","pos":[1430,1434]},{"content":"Description","pos":[1435,1446]},{"pos":[1447,1465],"content":"<ph id=\"ph1\">`pValue`</ph> Parameter","source":"`pValue` Parameter"},{"content":"MetaDataCheckDuplicatesFor","pos":[1528,1554]},{"content":"Controls which items are checked for duplicates.","pos":[1555,1603]},{"content":"Each time you call an <bpt id=\"p1\">[</bpt>IMetaDataEmit<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md)</ept> method that creates a new item, you can ask the method to check whether the item already exists in the current scope.","pos":[1604,1837],"source":" Each time you call an [IMetaDataEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md) method that creates a new item, you can ask the method to check whether the item already exists in the current scope."},{"content":"For example, you can check for the existence of <ph id=\"ph1\">`mdMethodDef`</ph> items; in this case, when you call <bpt id=\"p1\">[</bpt>IMetaDataEmit::DefineMethod<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemethod-method.md)</ept>, it will check that the method does not already exist in the current scope.","pos":[1838,2128],"source":" For example, you can check for the existence of `mdMethodDef` items; in this case, when you call [IMetaDataEmit::DefineMethod](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemethod-method.md), it will check that the method does not already exist in the current scope."},{"content":"This check uses the key that uniquely identifies a given method: parent type, name, and signature.","pos":[2129,2227]},{"pos":[2228,2435],"content":"Must be a variant of type UI4, and must contain a combination of the values of the <bpt id=\"p1\">[</bpt>CorCheckDuplicatesFor<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/corcheckduplicatesfor-enumeration.md)</ept> enumeration.","source":"Must be a variant of type UI4, and must contain a combination of the values of the [CorCheckDuplicatesFor](../../../../docs/framework/unmanaged-api/metadata/corcheckduplicatesfor-enumeration.md) enumeration."},{"content":"MetaDataRefToDefCheck","pos":[2440,2461]},{"content":"Controls which referenced items are converted to definitions.","pos":[2462,2523]},{"content":"By default, the metadata engine will optimize the code by converting a referenced item to its definition if the referenced item is actually defined in the current scope.","pos":[2524,2693]},{"pos":[2694,2891],"content":"Must be a variant of type UI4, and must contain a combination of the values of the <bpt id=\"p1\">[</bpt>CorRefToDefCheck<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/correftodefcheck-enumeration.md)</ept> enumeration.","source":"Must be a variant of type UI4, and must contain a combination of the values of the [CorRefToDefCheck](../../../../docs/framework/unmanaged-api/metadata/correftodefcheck-enumeration.md) enumeration."},{"content":"MetaDataNotificationForTokenMovement","pos":[2896,2932]},{"content":"Controls which token remaps occurring during a metadata merge generate callbacks.","pos":[2933,3014]},{"content":"Use the <bpt id=\"p1\">[</bpt>IMetaDataEmit::SetHandler<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md)</ept> method to establish your <bpt id=\"p2\">[</bpt>IMapToken<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md)</ept> interface.","pos":[3015,3258],"source":" Use the [IMetaDataEmit::SetHandler](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md) method to establish your [IMapToken](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md) interface."},{"pos":[3259,3486],"content":"Must be a variant of type UI4, and must contain a combination of the values of the <bpt id=\"p1\">[</bpt>CorNotificationForTokenMovement<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/cornotificationfortokenmovement-enumeration.md)</ept> enumeration.","source":"Must be a variant of type UI4, and must contain a combination of the values of the [CorNotificationForTokenMovement](../../../../docs/framework/unmanaged-api/metadata/cornotificationfortokenmovement-enumeration.md) enumeration."},{"content":"MetaDataSetENC","pos":[3491,3505]},{"content":"Controls the behavior of edit-and-continue (ENC).","pos":[3506,3555]},{"content":"Only one mode of behavior can be set at a time.","pos":[3556,3603]},{"content":"Must be a variant of type UI4, and must contain a value of the <bpt id=\"p1\">[</bpt>CorSetENC<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/corsetenc-enumeration.md)</ept> enumeration.","pos":[3604,3767],"source":"Must be a variant of type UI4, and must contain a value of the [CorSetENC](../../../../docs/framework/unmanaged-api/metadata/corsetenc-enumeration.md) enumeration."},{"content":"The value is not a bitmask.","pos":[3768,3795]},{"content":"MetaDataErrorIfEmitOutOfOrder","pos":[3800,3829]},{"content":"Controls which emitted-out-of-order errors generate callbacks.","pos":[3830,3892]},{"content":"Emitting metadata out of order is not fatal; however, if you emit metadata in an order that is favored by the metadata engine, the metadata is more compact and therefore can be more efficiently searched.","pos":[3893,4096]},{"content":"Use the <ph id=\"ph1\">`IMetaDataEmit::SetHandler`</ph> method to establish your <bpt id=\"p1\">[</bpt>IMetaDataError<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataerror-interface.md)</ept> interface.","pos":[4097,4264],"source":" Use the `IMetaDataEmit::SetHandler` method to establish your [IMetaDataError](../../../../docs/framework/unmanaged-api/metadata/imetadataerror-interface.md) interface."},{"pos":[4265,4478],"content":"Must be a variant of type UI4, and must contain a combination of the values of the <bpt id=\"p1\">[</bpt>CorErrorIfEmitOutOfOrder<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/corerrorifemitoutoforder-enumeration.md)</ept> enumeration.","source":"Must be a variant of type UI4, and must contain a combination of the values of the [CorErrorIfEmitOutOfOrder](../../../../docs/framework/unmanaged-api/metadata/corerrorifemitoutoforder-enumeration.md) enumeration."},{"content":"MetaDataImportOption","pos":[4483,4503]},{"content":"Controls which kinds of items that were deleted during an ENC are retrieved by an enumerator.","pos":[4504,4597]},{"pos":[4598,4807],"content":"Must be a variant of type UI4, and must contain a combination of the values of the <bpt id=\"p1\">[</bpt>CorImportOptions Enumeration<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/corimportoptions-enumeration.md)</ept> enumeration.","source":"Must be a variant of type UI4, and must contain a combination of the values of the [CorImportOptions Enumeration](../../../../docs/framework/unmanaged-api/metadata/corimportoptions-enumeration.md) enumeration."},{"content":"MetaDataThreadSafetyOptions","pos":[4812,4839]},{"content":"Controls whether the metadata engine obtains reader/writer locks, thereby ensuring thread safety.","pos":[4840,4937]},{"content":"By default, the engine assumes that access is single-threaded by the caller, so no locks are obtained.","pos":[4938,5040]},{"content":"Clients are responsible for maintaining proper thread synchronization when using the metadata API.","pos":[5041,5139]},{"content":"Must be a variant of type UI4, and must contain a value of the <bpt id=\"p1\">[</bpt>CorThreadSafetyOptions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/corthreadsafetyoptions-enumeration.md)</ept> enumeration.","pos":[5140,5329],"source":"Must be a variant of type UI4, and must contain a value of the [CorThreadSafetyOptions](../../../../docs/framework/unmanaged-api/metadata/corthreadsafetyoptions-enumeration.md) enumeration."},{"content":"The value is not a bitmask.","pos":[5330,5357]},{"content":"MetaDataGenerateTCEAdapters","pos":[5362,5389]},{"content":"Controls whether the type library importer should generate the tightly coupled event (TCE) adapters for COM connection point containers.","pos":[5390,5526]},{"content":"Must be a variant of type BOOL.","pos":[5527,5558]},{"content":"If <ph id=\"ph1\">`pValue`</ph> is set to <ph id=\"ph2\">`true`</ph>, the type library importer generates the TCE adapters.","pos":[5559,5642],"source":" If `pValue` is set to `true`, the type library importer generates the TCE adapters."},{"content":"MetaDataTypeLibImportNamespace","pos":[5647,5677]},{"content":"Specifies a non-default namespace for the type library that is being imported.","pos":[5678,5756]},{"content":"Must be either a null value or a variant of type BSTR.","pos":[5757,5811]},{"content":"If <ph id=\"ph1\">`pValue`</ph> is a null value, the current namespace is set to null; otherwise, the current namespace is set to the string that is held in the variant's BSTR type.","pos":[5812,5973],"source":" If `pValue` is a null value, the current namespace is set to null; otherwise, the current namespace is set to the string that is held in the variant's BSTR type."},{"content":"MetaDataLinkerOptions","pos":[5978,5999]},{"content":"Controls whether the linker should generate an assembly or a .NET Framework module file.","pos":[6000,6088]},{"pos":[6089,6286],"content":"Must be a variant of type UI4, and must contain a combination of the values of the <bpt id=\"p1\">[</bpt>CorLinkerOptions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/corlinkeroptions-enumeration.md)</ept> enumeration.","source":"Must be a variant of type UI4, and must contain a combination of the values of the [CorLinkerOptions](../../../../docs/framework/unmanaged-api/metadata/corlinkeroptions-enumeration.md) enumeration."},{"content":"MetaDataRuntimeVersion","pos":[6291,6313]},{"content":"Specifies the version of the common language runtime against which this image was built.","pos":[6314,6402]},{"content":"The version is stored as a string, such as \"v1.0.3705\".","pos":[6403,6458]},{"content":"Must be a null value, a VT_EMPTY value, or a variant of type BSTR.","pos":[6459,6525]},{"content":"If <ph id=\"ph1\">`pValue`</ph> is null, the runtime version is set to null.","pos":[6526,6582],"source":" If `pValue` is null, the runtime version is set to null."},{"content":"If <ph id=\"ph1\">`pValue`</ph> is VT_EMPTY, the version is set to a default value, which is drawn from the version of Mscorwks.dll within which the metadata code is running.","pos":[6583,6737],"source":" If `pValue` is VT_EMPTY, the version is set to a default value, which is drawn from the version of Mscorwks.dll within which the metadata code is running."},{"content":"Otherwise, the runtime version is set to the string that is held in the variant's BSTR type.","pos":[6738,6830]},{"content":"MetaDataMergerOptions","pos":[6835,6856]},{"content":"Specifies options for merging metadata.","pos":[6857,6896]},{"pos":[6897,7046],"content":"Must be a variant of type UI4, and must contain a combination of the values of the <ph id=\"ph1\">`MergeFlags`</ph> enumeration, which is described in the CorHdr.h file.","source":"Must be a variant of type UI4, and must contain a combination of the values of the `MergeFlags` enumeration, which is described in the CorHdr.h file."},{"content":"MetaDataPreserveLocalRefs","pos":[7051,7076]},{"content":"Disables optimizing local references into definitions.","pos":[7077,7131]},{"pos":[7132,7308],"content":"Must contain a combination of the values of the <bpt id=\"p1\">[</bpt>CorLocalRefPreservation<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/corlocalrefpreservation-enumeration.md)</ept> enumeration.","source":"Must contain a combination of the values of the [CorLocalRefPreservation](../../../../docs/framework/unmanaged-api/metadata/corlocalrefpreservation-enumeration.md) enumeration."},{"pos":[7318,7330],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[7334,7437],"content":"<bpt id=\"p1\">**</bpt>Platform:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platform:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[7444,7461],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> Cor.h","source":"**Header:** Cor.h"},{"pos":[7468,7514],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Used as a resource in MsCorEE.dll","source":"**Library:** Used as a resource in MsCorEE.dll"},{"pos":[7521,7629],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]"},{"pos":[7638,7646],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>IMetaDataDispenserEx Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenserex-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[7650,7768],"source":"[IMetaDataDispenserEx Interface](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenserex-interface.md) "},{"content":"<bpt id=\"p1\"> [</bpt>IMetaDataDispenser Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-interface.md)</ept>","pos":[7771,7885],"source":" [IMetaDataDispenser Interface](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-interface.md)"}]}