{"content":"---\ntitle: \"Discovery Find and FindCriteria\"\nms.date: \"03/30/2017\"\nms.assetid: 99016fa4-1778-495b-b4cc-0e22fbec42c6\n---\n# Discovery Find and FindCriteria\nA discovery find operation is initiated by a client to discover one or more services and is one of the main actions in discovery. Performing a find sends a WS-Discovery Probe message over the network. Services that match the criteria specified reply with WS-Discovery ProbeMatch messages. For more information about discovery messages, see the [WS-Discovery specification](https://go.microsoft.com/fwlink/?LinkID=122347).  \n  \n## DiscoveryClient  \n The <xref:System.ServiceModel.Discovery.DiscoveryClient> class provides the mechanism to perform find operations and makes performing discovery client operations easy. It contains a <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> method, which performs a (blocking) synchronous find, and a <xref:System.ServiceModel.Discovery.DiscoveryClient.FindAsync%2A> method, which initiates a non-blocking asynchronous find. Both methods take a <xref:System.ServiceModel.Discovery.FindCriteria> parameter, and provide results to the user through a <xref:System.ServiceModel.Discovery.FindResponse> object.  \n  \n## FindCriteria  \n <xref:System.ServiceModel.Discovery.FindCriteria> has several properties, which can be grouped into search criteria, which specify what services you are looking for, and find termination criteria (how long the search should last). A <xref:System.ServiceModel.Discovery.FindCriteria> can contain multiple search criteria. By default, the service has to match all of the components otherwise it does not consider itself a matching service. If you want to find services that only match some of the criteria, you can implement custom find logic on the service or you can use multiple queries.  \n  \n Search criteria include:  \n  \n-   <xref:System.ServiceModel.Discovery.Configuration.ContractTypeNameElement> - Optional. The contract name of the service being searched for and the criteria typically used when searching for a service. If more than one contract name is specified, only service endpoints matching ALL contracts reply. Note that in WCF an endpoint can only support one contract.  \n  \n-   <xref:System.ServiceModel.Discovery.Configuration.ScopeElement> - Optional. Scopes are absolute URIs that are used to categorize individual service endpoints. You may want to use this in scenarios where multiple endpoints expose the same contract and you want a way to search for a subset of the endpoints. If more than one scope is specified, only service endpoints matching ALL scopes reply.  \n  \n-   <xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchBy%2A> - Specifies the matching algorithm to use while matching the scopes in the Probe message with that of the endpoint. There are five supported scope-matching rules:  \n  \n    -   <xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByExact?displayProperty=nameWithType> does a basic case-sensitive string comparison.  \n  \n    -   <xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByPrefix?displayProperty=nameWithType> matches by segments separated by \"/\". A search for `http://contoso/building1` matches a service with scope `http://contoso/building/floor1`. Note that it does not match `http://contoso/building100` because the last two segments do not match.  \n  \n    -   <xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByLdap?displayProperty=nameWithType> matches scopes by segments using an LDAP URL.  \n  \n    -   <xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByUuid?displayProperty=nameWithType> matches scopes exactly using a UUID string.  \n  \n    -   <xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByNone?displayProperty=nameWithType> matches only those services that do not specify a scope.  \n  \n     If a scope-matching rule is not specified, <xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByPrefix> is used.  \n  \n Termination criteria include:  \n  \n1.  <xref:System.ServiceModel.Discovery.FindCriteria.Duration%2A> - The maximum time to wait for replies from services on the network. The default duration is 20 seconds.  \n  \n2.  <xref:System.ServiceModel.Discovery.FindCriteria.MaxResults%2A> - The maximum number of replies to wait for. If <xref:System.ServiceModel.Discovery.FindCriteria.MaxResults%2A> replies are received before <xref:System.ServiceModel.Discovery.FindCriteria.Duration%2A> has elapsed, the find operation ends.  \n  \n## FindResponse  \n <xref:System.ServiceModel.Discovery.FindResponse> has an <xref:System.ServiceModel.Discovery.FindResponse.Endpoints%2A> collection property that contains any replies sent by matching services on the network. If no services replied, the collection is empty. If one or more services replied, each reply is stored in an <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> object, which contains the address, contract, and some additional information about the service.  \n  \n The following example shows how to perform a find operation in code.  \n  \n```  \n// Create DiscoveryClient  \nDiscoveryClient discoveryClient = new DiscoveryClient(new UdpDiscoveryEndpoint());  \n  \n// Create FindCriteria  \nFindCriteria findCriteria = new FindCriteria(typeof(IPrinterService));  \nfindCriteria.Scopes.Add(new Uri(\"http://www.contoso.com/building1/floor1\"));  \nfindCriteria.Duration = TimeSpan.FromSeconds(10);   \n  \n// Find ICalculatorService endpoints              \nFindResponse findResponse = discoveryClient.Find(findCriteria);  \n  \nConsole.WriteLine(\"Found {0} ICalculatorService endpoint(s).\", findResponse.Endpoints.Count)  \n```  \n  \n## See also\n\n- [WCF Discovery Overview](../../../../docs/framework/wcf/feature-details/wcf-discovery-overview.md)\n- [Using the Discovery Client Channel](../../../../docs/framework/wcf/feature-details/using-the-discovery-client-channel.md)\n- [Discovery with Scopes](../../../../docs/framework/wcf/samples/discovery-with-scopes-sample.md)\n- [Basic](../../../../docs/framework/wcf/samples/basic-sample.md)\n","nodes":[{"pos":[4,115],"embed":true,"restype":"x-metadata","content":"title: \"Discovery Find and FindCriteria\"\nms.date: \"03/30/2017\"\nms.assetid: 99016fa4-1778-495b-b4cc-0e22fbec42c6","nodes":[{"content":"Discovery Find and FindCriteria","nodes":[{"pos":[0,31],"content":"Discovery Find and FindCriteria","nodes":[{"content":"Discovery Find and FindCriteria","pos":[0,31]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[122,153],"content":"Discovery Find and FindCriteria","linkify":"Discovery Find and FindCriteria","nodes":[{"content":"Discovery Find and FindCriteria","pos":[0,31]}]},{"content":"A discovery find operation is initiated by a client to discover one or more services and is one of the main actions in discovery.","pos":[154,283]},{"content":"Performing a find sends a WS-Discovery Probe message over the network.","pos":[284,354]},{"content":"Services that match the criteria specified reply with WS-Discovery ProbeMatch messages.","pos":[355,442]},{"content":"For more information about discovery messages, see the <bpt id=\"p1\">[</bpt>WS-Discovery specification<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=122347)</ept>.","pos":[443,575],"source":" For more information about discovery messages, see the [WS-Discovery specification](https://go.microsoft.com/fwlink/?LinkID=122347)."},{"pos":[584,599],"content":"DiscoveryClient","linkify":"DiscoveryClient","nodes":[{"content":"DiscoveryClient","pos":[0,15]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient&gt;</ph> class provides the mechanism to perform find operations and makes performing discovery client operations easy.","pos":[603,770],"source":"The <xref:System.ServiceModel.Discovery.DiscoveryClient> class provides the mechanism to perform find operations and makes performing discovery client operations easy."},{"content":"It contains a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A&gt;</ph> method, which performs a (blocking) synchronous find, and a <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.FindAsync%2A&gt;</ph> method, which initiates a non-blocking asynchronous find.","pos":[771,1029],"source":" It contains a <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> method, which performs a (blocking) synchronous find, and a <xref:System.ServiceModel.Discovery.DiscoveryClient.FindAsync%2A> method, which initiates a non-blocking asynchronous find."},{"content":"Both methods take a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria&gt;</ph> parameter, and provide results to the user through a <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.FindResponse&gt;</ph> object.","pos":[1030,1210],"source":" Both methods take a <xref:System.ServiceModel.Discovery.FindCriteria> parameter, and provide results to the user through a <xref:System.ServiceModel.Discovery.FindResponse> object."},{"pos":[1219,1231],"content":"FindCriteria","linkify":"FindCriteria","nodes":[{"content":"FindCriteria","pos":[0,12]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria&gt;</ph> has several properties, which can be grouped into search criteria, which specify what services you are looking for, and find termination criteria (how long the search should last).","pos":[1235,1465],"source":"<xref:System.ServiceModel.Discovery.FindCriteria> has several properties, which can be grouped into search criteria, which specify what services you are looking for, and find termination criteria (how long the search should last)."},{"content":"A <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria&gt;</ph> can contain multiple search criteria.","pos":[1466,1555],"source":" A <xref:System.ServiceModel.Discovery.FindCriteria> can contain multiple search criteria."},{"content":"By default, the service has to match all of the components otherwise it does not consider itself a matching service.","pos":[1556,1672]},{"content":"If you want to find services that only match some of the criteria, you can implement custom find logic on the service or you can use multiple queries.","pos":[1673,1823]},{"content":"Search criteria include:","pos":[1830,1854]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.Configuration.ContractTypeNameElement&gt;</ph> - Optional.","pos":[1864,1950],"source":"<xref:System.ServiceModel.Discovery.Configuration.ContractTypeNameElement> - Optional."},{"content":"The contract name of the service being searched for and the criteria typically used when searching for a service.","pos":[1951,2064]},{"content":"If more than one contract name is specified, only service endpoints matching ALL contracts reply.","pos":[2065,2162]},{"content":"Note that in WCF an endpoint can only support one contract.","pos":[2163,2222]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.Configuration.ScopeElement&gt;</ph> - Optional.","pos":[2232,2307],"source":"<xref:System.ServiceModel.Discovery.Configuration.ScopeElement> - Optional."},{"content":"Scopes are absolute URIs that are used to categorize individual service endpoints.","pos":[2308,2390]},{"content":"You may want to use this in scenarios where multiple endpoints expose the same contract and you want a way to search for a subset of the endpoints.","pos":[2391,2538]},{"content":"If more than one scope is specified, only service endpoints matching ALL scopes reply.","pos":[2539,2625]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchBy%2A&gt;</ph> - Specifies the matching algorithm to use while matching the scopes in the Probe message with that of the endpoint.","pos":[2635,2816],"source":"<xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchBy%2A> - Specifies the matching algorithm to use while matching the scopes in the Probe message with that of the endpoint."},{"content":"There are five supported scope-matching rules:","pos":[2817,2863]},{"pos":[2877,3020],"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByExact?displayProperty=nameWithType&gt;</ph> does a basic case-sensitive string comparison.","source":"<xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByExact?displayProperty=nameWithType> does a basic case-sensitive string comparison."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByPrefix?displayProperty=nameWithType&gt;</ph> matches by segments separated by \"/\".","pos":[3034,3169],"source":"<xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByPrefix?displayProperty=nameWithType> matches by segments separated by \"/\"."},{"content":"A search for <ph id=\"ph1\">`http://contoso/building1`</ph> matches a service with scope <ph id=\"ph2\">`http://contoso/building/floor1`</ph>.","pos":[3170,3272],"source":" A search for `http://contoso/building1` matches a service with scope `http://contoso/building/floor1`."},{"content":"Note that it does not match <ph id=\"ph1\">`http://contoso/building100`</ph> because the last two segments do not match.","pos":[3273,3373],"source":" Note that it does not match `http://contoso/building100` because the last two segments do not match."},{"pos":[3387,3528],"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByLdap?displayProperty=nameWithType&gt;</ph> matches scopes by segments using an LDAP URL.","source":"<xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByLdap?displayProperty=nameWithType> matches scopes by segments using an LDAP URL."},{"pos":[3542,3681],"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByUuid?displayProperty=nameWithType&gt;</ph> matches scopes exactly using a UUID string.","source":"<xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByUuid?displayProperty=nameWithType> matches scopes exactly using a UUID string."},{"pos":[3695,3847],"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByNone?displayProperty=nameWithType&gt;</ph> matches only those services that do not specify a scope.","source":"<xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByNone?displayProperty=nameWithType> matches only those services that do not specify a scope."},{"pos":[3858,3978],"content":"If a scope-matching rule is not specified, <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByPrefix&gt;</ph> is used.","source":"If a scope-matching rule is not specified, <xref:System.ServiceModel.Discovery.FindCriteria.ScopeMatchByPrefix> is used."},{"content":"Termination criteria include:","pos":[3985,4014]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria.Duration%2A&gt;</ph> - The maximum time to wait for replies from services on the network.","pos":[4024,4154],"source":"<xref:System.ServiceModel.Discovery.FindCriteria.Duration%2A> - The maximum time to wait for replies from services on the network."},{"content":"The default duration is 20 seconds.","pos":[4155,4190]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria.MaxResults%2A&gt;</ph> - The maximum number of replies to wait for.","pos":[4200,4308],"source":"<xref:System.ServiceModel.Discovery.FindCriteria.MaxResults%2A> - The maximum number of replies to wait for."},{"content":"If <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria.MaxResults%2A&gt;</ph> replies are received before <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.FindCriteria.Duration%2A&gt;</ph> has elapsed, the find operation ends.","pos":[4309,4503],"source":" If <xref:System.ServiceModel.Discovery.FindCriteria.MaxResults%2A> replies are received before <xref:System.ServiceModel.Discovery.FindCriteria.Duration%2A> has elapsed, the find operation ends."},{"pos":[4512,4524],"content":"FindResponse","linkify":"FindResponse","nodes":[{"content":"FindResponse","pos":[0,12]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindResponse&gt;</ph> has an <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.FindResponse.Endpoints%2A&gt;</ph> collection property that contains any replies sent by matching services on the network.","pos":[4528,4735],"source":"<xref:System.ServiceModel.Discovery.FindResponse> has an <xref:System.ServiceModel.Discovery.FindResponse.Endpoints%2A> collection property that contains any replies sent by matching services on the network."},{"content":"If no services replied, the collection is empty.","pos":[4736,4784]},{"content":"If one or more services replied, each reply is stored in an <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata&gt;</ph> object, which contains the address, contract, and some additional information about the service.","pos":[4785,5004],"source":" If one or more services replied, each reply is stored in an <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> object, which contains the address, contract, and some additional information about the service."},{"content":"The following example shows how to perform a find operation in code.","pos":[5011,5079]},{"pos":[5667,5675],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5679,5777],"content":"<bpt id=\"p1\">[</bpt>WCF Discovery Overview<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/wcf-discovery-overview.md)</ept>","source":"[WCF Discovery Overview](../../../../docs/framework/wcf/feature-details/wcf-discovery-overview.md)"},{"pos":[5780,5902],"content":"<bpt id=\"p1\">[</bpt>Using the Discovery Client Channel<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/using-the-discovery-client-channel.md)</ept>","source":"[Using the Discovery Client Channel](../../../../docs/framework/wcf/feature-details/using-the-discovery-client-channel.md)"},{"pos":[5905,6000],"content":"<bpt id=\"p1\">[</bpt>Discovery with Scopes<ept id=\"p1\">](../../../../docs/framework/wcf/samples/discovery-with-scopes-sample.md)</ept>","source":"[Discovery with Scopes](../../../../docs/framework/wcf/samples/discovery-with-scopes-sample.md)"},{"pos":[6003,6066],"content":"<bpt id=\"p1\">[</bpt>Basic<ept id=\"p1\">](../../../../docs/framework/wcf/samples/basic-sample.md)</ept>","source":"[Basic](../../../../docs/framework/wcf/samples/basic-sample.md)"}]}