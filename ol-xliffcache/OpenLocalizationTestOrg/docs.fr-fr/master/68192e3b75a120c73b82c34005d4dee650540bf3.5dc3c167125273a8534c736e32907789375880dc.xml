{"content":"---\ntitle: \"Constructor Design\"\nms.date: \"10/22/2008\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"member design guidelines, constructors\"\n  - \"constructors, design guidelines\"\n  - \"instance constructors\"\n  - \"type constructors\"\n  - \"virtual members\"\n  - \"constructors, types\"\n  - \"default constructors\"\n  - \"static constructors\"\nms.assetid: b4496afe-5fa7-4bb0-85ca-70b0ef21e6fc\nauthor: \"KrzysztofCwalina\"\n---\n# Constructor Design\nThere are two kinds of constructors: type constructors and instance constructors.  \n  \n Type constructors are static and are run by the CLR before the type is used. Instance constructors run when an instance of a type is created.  \n  \n Type constructors cannot take any parameters. Instance constructors can. Instance constructors that don’t take any parameters are often called default constructors.  \n  \n Constructors are the most natural way to create instances of a type. Most developers will search and try to use a constructor before they consider alternative ways of creating instances (such as factory methods).  \n  \n **✓ CONSIDER** providing simple, ideally default, constructors.  \n  \n A simple constructor has a very small number of parameters, and all parameters are primitives or enums. Such simple constructors increase usability of the framework.  \n  \n **✓ CONSIDER** using a static factory method instead of a constructor if the semantics of the desired operation do not map directly to the construction of a new instance, or if following the constructor design guidelines feels unnatural.  \n  \n **✓ DO** use constructor parameters as shortcuts for setting main properties.  \n  \n There should be no difference in semantics between using the empty constructor followed by some property sets and using a constructor with multiple arguments.  \n  \n **✓ DO** use the same name for constructor parameters and a property if the constructor parameters are used to simply set the property.  \n  \n The only difference between such parameters and the properties should be casing.  \n  \n **✓ DO** minimal work in the constructor.  \n  \n Constructors should not do much work other than capture the constructor parameters. The cost of any other processing should be delayed until required.  \n  \n **✓ DO** throw exceptions from instance constructors, if appropriate.  \n  \n **✓ DO** explicitly declare the public default constructor in classes, if such a constructor is required.  \n  \n If you don’t explicitly declare any constructors on a type, many languages (such as C#) will automatically add a public default constructor. (Abstract classes get a protected constructor.)  \n  \n Adding a parameterized constructor to a class prevents the compiler from adding the default constructor. This often causes accidental breaking changes.  \n  \n **X AVOID** explicitly defining default constructors on structs.  \n  \n This makes array creation faster, because if the default constructor is not defined, it does not have to be run on every slot in the array. Note that many compilers, including C#, don’t allow structs to have parameterless constructors for this reason.  \n  \n **X AVOID** calling virtual members on an object inside its constructor.  \n  \n Calling a virtual member will cause the most derived override to be called, even if the constructor of the most derived type has not been fully run yet.  \n  \n### Type Constructor Guidelines  \n **✓ DO** make static constructors private.  \n  \n A static constructor, also called a class constructor, is used to initialize a type. The CLR calls the static constructor before the first instance of the type is created or any static members on that type are called. The user has no control over when the static constructor is called. If a static constructor is not private, it can be called by code other than the CLR. Depending on the operations performed in the constructor, this can cause unexpected behavior. The C# compiler forces static constructors to be private.  \n  \n **X DO NOT** throw exceptions from static constructors.  \n  \n If an exception is thrown from a type constructor, the type is not usable in the current application domain.  \n  \n **✓ CONSIDER** initializing static fields inline rather than explicitly using static constructors, because the runtime is able to optimize the performance of types that don’t have an explicitly defined static constructor.  \n  \n *Portions © 2005, 2009 Microsoft Corporation. All rights reserved.*  \n  \n *Reprinted by permission of Pearson Education, Inc. from [Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619) by Krzysztof Cwalina and Brad Abrams, published Oct 22, 2008 by Addison-Wesley Professional as part of the Microsoft Windows Development Series.*  \n  \n## See also\n\n- [Member Design Guidelines](../../../docs/standard/design-guidelines/member.md)\n- [Framework Design Guidelines](../../../docs/standard/design-guidelines/index.md)\n","nodes":[{"pos":[4,418],"embed":true,"restype":"x-metadata","content":"title: \"Constructor Design\"\nms.date: \"10/22/2008\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"member design guidelines, constructors\"\n  - \"constructors, design guidelines\"\n  - \"instance constructors\"\n  - \"type constructors\"\n  - \"virtual members\"\n  - \"constructors, types\"\n  - \"default constructors\"\n  - \"static constructors\"\nms.assetid: b4496afe-5fa7-4bb0-85ca-70b0ef21e6fc\nauthor: \"KrzysztofCwalina\"","nodes":[{"content":"Constructor Design","nodes":[{"pos":[0,18],"content":"Constructor Design","nodes":[{"content":"Constructor Design","pos":[0,18]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[425,443],"content":"Constructor Design","linkify":"Constructor Design","nodes":[{"content":"Constructor Design","pos":[0,18]}]},{"content":"There are two kinds of constructors: type constructors and instance constructors.","pos":[444,525]},{"content":"Type constructors are static and are run by the CLR before the type is used.","pos":[532,608]},{"content":"Instance constructors run when an instance of a type is created.","pos":[609,673]},{"content":"Type constructors cannot take any parameters.","pos":[680,725]},{"content":"Instance constructors can.","pos":[726,752]},{"content":"Instance constructors that don’t take any parameters are often called default constructors.","pos":[753,844]},{"content":"Constructors are the most natural way to create instances of a type.","pos":[851,919]},{"content":"Most developers will search and try to use a constructor before they consider alternative ways of creating instances (such as factory methods).","pos":[920,1063]},{"pos":[1070,1133],"content":"<bpt id=\"p1\">**</bpt>✓ CONSIDER<ept id=\"p1\">**</ept> providing simple, ideally default, constructors.","source":"**✓ CONSIDER** providing simple, ideally default, constructors."},{"content":"A simple constructor has a very small number of parameters, and all parameters are primitives or enums.","pos":[1140,1243]},{"content":"Such simple constructors increase usability of the framework.","pos":[1244,1305]},{"pos":[1312,1549],"content":"<bpt id=\"p1\">**</bpt>✓ CONSIDER<ept id=\"p1\">**</ept> using a static factory method instead of a constructor if the semantics of the desired operation do not map directly to the construction of a new instance, or if following the constructor design guidelines feels unnatural.","source":"**✓ CONSIDER** using a static factory method instead of a constructor if the semantics of the desired operation do not map directly to the construction of a new instance, or if following the constructor design guidelines feels unnatural."},{"pos":[1556,1633],"content":"<bpt id=\"p1\">**</bpt>✓ DO<ept id=\"p1\">**</ept> use constructor parameters as shortcuts for setting main properties.","source":"**✓ DO** use constructor parameters as shortcuts for setting main properties."},{"content":"There should be no difference in semantics between using the empty constructor followed by some property sets and using a constructor with multiple arguments.","pos":[1640,1798]},{"pos":[1805,1940],"content":"<bpt id=\"p1\">**</bpt>✓ DO<ept id=\"p1\">**</ept> use the same name for constructor parameters and a property if the constructor parameters are used to simply set the property.","source":"**✓ DO** use the same name for constructor parameters and a property if the constructor parameters are used to simply set the property."},{"content":"The only difference between such parameters and the properties should be casing.","pos":[1947,2027]},{"pos":[2034,2075],"content":"<bpt id=\"p1\">**</bpt>✓ DO<ept id=\"p1\">**</ept> minimal work in the constructor.","source":"**✓ DO** minimal work in the constructor."},{"content":"Constructors should not do much work other than capture the constructor parameters.","pos":[2082,2165]},{"content":"The cost of any other processing should be delayed until required.","pos":[2166,2232]},{"pos":[2239,2308],"content":"<bpt id=\"p1\">**</bpt>✓ DO<ept id=\"p1\">**</ept> throw exceptions from instance constructors, if appropriate.","source":"**✓ DO** throw exceptions from instance constructors, if appropriate."},{"pos":[2315,2420],"content":"<bpt id=\"p1\">**</bpt>✓ DO<ept id=\"p1\">**</ept> explicitly declare the public default constructor in classes, if such a constructor is required.","source":"**✓ DO** explicitly declare the public default constructor in classes, if such a constructor is required."},{"content":"If you don’t explicitly declare any constructors on a type, many languages (such as C#) will automatically add a public default constructor.","pos":[2427,2567]},{"content":"(Abstract classes get a protected constructor.)","pos":[2568,2615]},{"content":"Adding a parameterized constructor to a class prevents the compiler from adding the default constructor.","pos":[2622,2726]},{"content":"This often causes accidental breaking changes.","pos":[2727,2773]},{"pos":[2780,2844],"content":"<bpt id=\"p1\">**</bpt>X AVOID<ept id=\"p1\">**</ept> explicitly defining default constructors on structs.","source":"**X AVOID** explicitly defining default constructors on structs."},{"content":"This makes array creation faster, because if the default constructor is not defined, it does not have to be run on every slot in the array.","pos":[2851,2990]},{"content":"Note that many compilers, including C#, don’t allow structs to have parameterless constructors for this reason.","pos":[2991,3102]},{"pos":[3109,3181],"content":"<bpt id=\"p1\">**</bpt>X AVOID<ept id=\"p1\">**</ept> calling virtual members on an object inside its constructor.","source":"**X AVOID** calling virtual members on an object inside its constructor."},{"content":"Calling a virtual member will cause the most derived override to be called, even if the constructor of the most derived type has not been fully run yet.","pos":[3188,3340]},{"pos":[3350,3377],"content":"Type Constructor Guidelines","linkify":"Type Constructor Guidelines","nodes":[{"content":"Type Constructor Guidelines","pos":[0,27]}]},{"pos":[3381,3423],"content":"<bpt id=\"p1\">**</bpt>✓ DO<ept id=\"p1\">**</ept> make static constructors private.","source":"**✓ DO** make static constructors private."},{"content":"A static constructor, also called a class constructor, is used to initialize a type.","pos":[3430,3514]},{"content":"The CLR calls the static constructor before the first instance of the type is created or any static members on that type are called.","pos":[3515,3647]},{"content":"The user has no control over when the static constructor is called.","pos":[3648,3715]},{"content":"If a static constructor is not private, it can be called by code other than the CLR.","pos":[3716,3800]},{"content":"Depending on the operations performed in the constructor, this can cause unexpected behavior.","pos":[3801,3894]},{"content":"The C# compiler forces static constructors to be private.","pos":[3895,3952]},{"pos":[3959,4014],"content":"<bpt id=\"p1\">**</bpt>X DO NOT<ept id=\"p1\">**</ept> throw exceptions from static constructors.","source":"**X DO NOT** throw exceptions from static constructors."},{"content":"If an exception is thrown from a type constructor, the type is not usable in the current application domain.","pos":[4021,4129]},{"pos":[4136,4357],"content":"<bpt id=\"p1\">**</bpt>✓ CONSIDER<ept id=\"p1\">**</ept> initializing static fields inline rather than explicitly using static constructors, because the runtime is able to optimize the performance of types that don’t have an explicitly defined static constructor.","source":"**✓ CONSIDER** initializing static fields inline rather than explicitly using static constructors, because the runtime is able to optimize the performance of types that don’t have an explicitly defined static constructor."},{"pos":[4364,4431],"content":"<bpt id=\"p1\">*</bpt>Portions © 2005, 2009 Microsoft Corporation. All rights reserved.<ept id=\"p1\">*</ept>","source":"*Portions © 2005, 2009 Microsoft Corporation. All rights reserved.*"},{"pos":[4438,4843],"content":"<bpt id=\"p1\">*</bpt>Reprinted by permission of Pearson Education, Inc. from <bpt id=\"p2\">[</bpt>Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition<ept id=\"p2\">](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619)</ept> by Krzysztof Cwalina and Brad Abrams, published Oct 22, 2008 by Addison-Wesley Professional as part of the Microsoft Windows Development Series.<ept id=\"p1\">*</ept>","source":"*Reprinted by permission of Pearson Education, Inc. from [Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619) by Krzysztof Cwalina and Brad Abrams, published Oct 22, 2008 by Addison-Wesley Professional as part of the Microsoft Windows Development Series.*"},{"pos":[4852,4860],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4864,4942],"content":"<bpt id=\"p1\">[</bpt>Member Design Guidelines<ept id=\"p1\">](../../../docs/standard/design-guidelines/member.md)</ept>","source":"[Member Design Guidelines](../../../docs/standard/design-guidelines/member.md)"},{"pos":[4945,5025],"content":"<bpt id=\"p1\">[</bpt>Framework Design Guidelines<ept id=\"p1\">](../../../docs/standard/design-guidelines/index.md)</ept>","source":"[Framework Design Guidelines](../../../docs/standard/design-guidelines/index.md)"}]}