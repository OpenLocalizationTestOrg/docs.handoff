{"content":"---\ntitle: \"IHostTaskManager::BeginThreadAffinity Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IHostTaskManager.BeginThreadAffinity\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostTaskManager::BeginThreadAffinity\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IHostTaskManager::BeginThreadAffinity method [.NET Framework hosting]\"\n  - \"BeginThreadAffinity method [.NET Framework hosting]\"\nms.assetid: fea3ab88-ce41-4c5a-847b-bb78cd748da6\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 13\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# IHostTaskManager::BeginThreadAffinity Method\nNotifies the host that managed code is entering a period in which the current task must not be moved to another operating system thread.  \n  \n## Syntax  \n  \n```  \nHRESULT BeginThreadAffinity ();  \n```  \n  \n## Return Value  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|`BeginThreadAffinity` returned successfully.|  \n|HOST_E_CLRNOTAVAILABLE|The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.|  \n|HOST_E_TIMEOUT|The call timed out.|  \n|HOST_E_NOT_OWNER|The caller does not own the lock.|  \n|HOST_E_ABANDONED|An event was canceled while a blocked thread or fiber was waiting on it.|  \n|E_FAIL|An unknown catastrophic failure occurred. When a method returns E_FAIL, the CLR is no longer usable within the process. Subsequent calls to hosting methods return HOST_E_CLRNOTAVAILABLE.|  \n  \n## Remarks  \n The CLR typically calls `IHostTaskManager::BeginThreadAffinity` in the context of a call to <xref:System.Threading.Thread.BeginThreadAffinity%2A?displayProperty=fullName>. The current task must not be rescheduled until a corresponding call is made to [IHostTaskManager::EndThreadAffinity](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-endthreadaffinity-method.md). Tasks can be switched out, but when they are switched back in, they must be assigned to the same operating system thread from which they were switched out. Nested calls to `BeginThreadAffinity` have no effect, because the call refers to the current task.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See Also  \n [ICLRTask Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md)   \n [ICLRTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)   \n [IHostTask Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md)   \n [IHostTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-interface.md)","nodes":[{"pos":[12,73],"content":"IHostTaskManager::BeginThreadAffinity Method | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IHostTaskManager::BeginThreadAffinity Method | Microsoft Docs","pos":[0,61]}]},{"pos":[749,793],"content":"IHostTaskManager::BeginThreadAffinity Method","linkify":"IHostTaskManager::BeginThreadAffinity Method","nodes":[{"content":"IHostTaskManager::BeginThreadAffinity Method","pos":[0,44]}]},{"content":"Notifies the host that managed code is entering a period in which the current task must not be moved to another operating system thread.","pos":[794,930]},{"pos":[939,945],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1003,1015],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"HRESULT","pos":[1022,1029]},{"content":"Description","pos":[1030,1041]},{"content":"S_OK","pos":[1082,1086]},{"pos":[1087,1131],"content":"<ph id=\"ph1\">`BeginThreadAffinity`</ph> returned successfully.","source":"`BeginThreadAffinity` returned successfully."},{"content":"HOST_E_CLRNOTAVAILABLE","pos":[1136,1158]},{"content":"The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.","pos":[1159,1323]},{"content":"HOST_E_TIMEOUT","pos":[1328,1342]},{"content":"The call timed out.","pos":[1343,1362]},{"content":"HOST_E_NOT_OWNER","pos":[1367,1383]},{"content":"The caller does not own the lock.","pos":[1384,1417]},{"content":"HOST_E_ABANDONED","pos":[1422,1438]},{"content":"An event was canceled while a blocked thread or fiber was waiting on it.","pos":[1439,1511]},{"content":"E_FAIL","pos":[1516,1522]},{"content":"An unknown catastrophic failure occurred.","pos":[1523,1564]},{"content":"When a method returns E_FAIL, the CLR is no longer usable within the process.","pos":[1565,1642]},{"content":"Subsequent calls to hosting methods return HOST_E_CLRNOTAVAILABLE.","pos":[1643,1709]},{"pos":[1719,1726],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The CLR typically calls <ph id=\"ph1\">`IHostTaskManager::BeginThreadAffinity`</ph> in the context of a call to <ph id=\"ph2\">&lt;xref:System.Threading.Thread.BeginThreadAffinity%2A?displayProperty=fullName&gt;</ph>.","pos":[1730,1901],"source":"The CLR typically calls `IHostTaskManager::BeginThreadAffinity` in the context of a call to <xref:System.Threading.Thread.BeginThreadAffinity%2A?displayProperty=fullName>."},{"content":"The current task must not be rescheduled until a corresponding call is made to <bpt id=\"p1\">[</bpt>IHostTaskManager::EndThreadAffinity<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-endthreadaffinity-method.md)</ept>.","pos":[1902,2114],"source":" The current task must not be rescheduled until a corresponding call is made to [IHostTaskManager::EndThreadAffinity](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-endthreadaffinity-method.md)."},{"content":"Tasks can be switched out, but when they are switched back in, they must be assigned to the same operating system thread from which they were switched out.","pos":[2115,2270]},{"content":"Nested calls to <ph id=\"ph1\">`BeginThreadAffinity`</ph> have no effect, because the call refers to the current task.","pos":[2271,2369],"source":" Nested calls to `BeginThreadAffinity` have no effect, because the call refers to the current task."},{"pos":[2378,2390],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2394,2498],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2505,2526],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2533,2583],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[2590,2698],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[2707,2715],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>ICLRTask Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[2719,2812],"source":"[ICLRTask Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md) "},{"content":"<bpt id=\"p1\"> [</bpt>ICLRTaskManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[2815,2923],"source":" [ICLRTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md) "},{"content":"<bpt id=\"p1\"> [</bpt>IHostTask Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[2926,3022],"source":" [IHostTask Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md) "},{"content":"<bpt id=\"p1\"> [</bpt>IHostTaskManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-interface.md)</ept>","pos":[3025,3134],"source":" [IHostTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-interface.md)"}]}