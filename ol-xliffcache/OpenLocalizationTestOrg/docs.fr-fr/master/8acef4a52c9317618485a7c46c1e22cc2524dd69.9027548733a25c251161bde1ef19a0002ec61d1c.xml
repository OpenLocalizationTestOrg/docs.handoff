{"content":"---\ntitle: \"Walkthrough: Creating Direct3D9 Content for Hosting in WPF\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"cpp\"\nhelpviewer_keywords:\n  - \"WPF [WPF], creating Direct3D9 content\"\n  - \"Direct3D9 [WPF interoperability], creating Direct3D9 content\"\nms.assetid: 286e98bc-1eaa-4b5e-923d-3490a9cca5fc\n---\n# Walkthrough: Creating Direct3D9 Content for Hosting in WPF\nThis walkthrough shows how to create Direct3D9 content that is suitable for hosting in a Windows Presentation Foundation (WPF) application. For more information on hosting Direct3D9 content in WPF applications, see [WPF and Direct3D9 Interoperation](wpf-and-direct3d9-interoperation.md).\n\n In this walkthrough, you perform the following tasks:\n\n-   Create a Direct3D9 project.\n\n-   Configure the Direct3D9 project for hosting in a WPF application.\n\n When you are finished, you will have a DLL that contains Direct3D9 content for use in a WPF application.\n\n## Prerequisites\n You need the following components to complete this walkthrough:\n\n-   Visual Studio 2010.\n\n-   DirectX SDK 9 or later.\n\n## Creating the Direct3D9 Project\n The first step is to create and configure the Direct3D9 project.\n\n#### To create the Direct3D9 project\n\n1.  Create a new Win32 Project in C++ named `D3DContent`.\n\n     The Win32 Application Wizard opens and displays the Welcome screen.\n\n2.  Click **Next**.\n\n     The Application Settings screen appears.\n\n3.  In the **Application type:** section, select the **DLL** option.\n\n4.  Click **Finish**.\n\n     The D3DContent project is generated.\n\n5.  In Solution Explorer, right-click the D3DContent project and select **Properties**.\n\n     The **D3DContent Property Pages** dialog box opens.\n\n6.  Select the **C/C++** node.\n\n7.  In the **Additional Include Directories** field, specify the location of the DirectX include folder. The default location for this folder is %ProgramFiles%\\Microsoft DirectX SDK (*version*)\\Include.\n\n8.  Double-click the **Linker** node to expand it.\n\n9. In the **Additional Library Directories** field, specify the location of the DirectX libraries folder. The default location for this folder is %ProgramFiles%\\Microsoft DirectX SDK (*version*)\\Lib\\x86.\n\n10. Select the **Input** node.\n\n11. In the **Additional Dependencies** field, add the `d3d9.lib` and `d3dx9.lib` files.\n\n12. In Solution Explorer, add a new module definition file (.def) named `D3DContent.def` to the project.\n\n## Creating the Direct3D9 Content\n To get the best performance, your Direct3D9 content must use particular settings. The following code shows how to create a Direct3D9 surface that has the best performance characteristics. For more information, see [Performance Considerations for Direct3D9 and WPF Interoperability](performance-considerations-for-direct3d9-and-wpf-interoperability.md).\n\n#### To create the Direct3D9 content\n\n1.  Using Solution Explorer, add three C++ classes to the project named the following.\n\n     `CRenderer` (with virtual destructor)\n\n     `CRendererManager`\n\n     `CTriangleRenderer`\n\n2.  Open Renderer.h in the Code Editor and replace the automatically generated code with the following code.\n\n     [!code-cpp[System.Windows.Interop.D3DImage#RendererH](~/samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/renderer.h#rendererh)]\n\n3.  Open Renderer.cpp in the Code Editor and replace the automatically generated code with the following code.\n\n     [!code-cpp[System.Windows.Interop.D3DImage#RendererCPP](~/samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/renderer.cpp#renderercpp)]\n\n4.  Open RendererManager.h in the Code Editor and replace the automatically generated code with the following code.\n\n     [!code-cpp[System.Windows.Interop.D3DImage#RendererManagerH](~/samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/renderermanager.h#renderermanagerh)]\n\n5.  Open RendererManager.cpp in the Code Editor and replace the automatically generated code with the following code.\n\n     [!code-cpp[System.Windows.Interop.D3DImage#RendererManagerCPP](~/samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/renderermanager.cpp#renderermanagercpp)]\n\n6.  Open TriangleRenderer.h in the Code Editor and replace the automatically generated code with the following code.\n\n     [!code-cpp[System.Windows.Interop.D3DImage#TriangleRendererH](~/samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/trianglerenderer.h#trianglerendererh)]\n\n7.  Open TriangleRenderer.cpp in the Code Editor and replace the automatically generated code with the following code.\n\n     [!code-cpp[System.Windows.Interop.D3DImage#TriangleRendererCPP](~/samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/trianglerenderer.cpp#trianglerenderercpp)]\n\n8.  Open stdafx.h in the Code Editor and replace the automatically generated code with the following code.\n\n     [!code-cpp[System.Windows.Interop.D3DImage#StdafxH](~/samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/stdafx.h#stdafxh)]\n\n9. Open dllmain.cpp in the Code Editor and replace the automatically generated code with the following code.\n\n     [!code-cpp[System.Windows.Interop.D3DImage#DllMain](~/samples/snippets/cpp/VS_Snippets_Wpf/System.Windows.Interop.D3DImage/cpp/dllmain.cpp#dllmain)]\n\n10. Open D3DContent.def in the code editor.\n\n11. Replace the automatically generated code with the following code.\n\n    ```\n    LIBRARY \"D3DContent\"\n\n    EXPORTS\n\n    SetSize\n    SetAlpha\n    SetNumDesiredSamples\n    SetAdapter\n\n    GetBackBufferNoRef\n    Render\n    Destroy\n    ```\n\n12. Build the project.\n\n## Next Steps\n\n-   Host the Direct3D9 content in a WPF application. For more information, see [Walkthrough: Hosting Direct3D9 Content in WPF](walkthrough-hosting-direct3d9-content-in-wpf.md).\n\n## See also\n\n- <xref:System.Windows.Interop.D3DImage>\n- [Performance Considerations for Direct3D9 and WPF Interoperability](performance-considerations-for-direct3d9-and-wpf-interoperability.md)\n- [Walkthrough: Hosting Direct3D9 Content in WPF](walkthrough-hosting-direct3d9-content-in-wpf.md)\n","nodes":[{"pos":[4,295],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Creating Direct3D9 Content for Hosting in WPF\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"cpp\"\nhelpviewer_keywords:\n  - \"WPF [WPF], creating Direct3D9 content\"\n  - \"Direct3D9 [WPF interoperability], creating Direct3D9 content\"\nms.assetid: 286e98bc-1eaa-4b5e-923d-3490a9cca5fc","nodes":[{"content":"Walkthrough: Creating Direct3D9 Content for Hosting in WPF","nodes":[{"pos":[0,58],"content":"Walkthrough: Creating Direct3D9 Content for Hosting in WPF","nodes":[{"content":"Walkthrough: Creating Direct3D9 Content for Hosting in WPF","pos":[0,58]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[302,360],"content":"Walkthrough: Creating Direct3D9 Content for Hosting in WPF","linkify":"Walkthrough: Creating Direct3D9 Content for Hosting in WPF","nodes":[{"content":"Walkthrough: Creating Direct3D9 Content for Hosting in WPF","pos":[0,58]}]},{"content":"This walkthrough shows how to create Direct3D9 content that is suitable for hosting in a Windows Presentation Foundation (WPF) application.","pos":[361,500]},{"content":"For more information on hosting Direct3D9 content in WPF applications, see <bpt id=\"p1\">[</bpt>WPF and Direct3D9 Interoperation<ept id=\"p1\">](wpf-and-direct3d9-interoperation.md)</ept>.","pos":[501,648],"source":" For more information on hosting Direct3D9 content in WPF applications, see [WPF and Direct3D9 Interoperation](wpf-and-direct3d9-interoperation.md)."},{"content":"In this walkthrough, you perform the following tasks:","pos":[651,704]},{"content":"Create a Direct3D9 project.","pos":[710,737]},{"content":"Configure the Direct3D9 project for hosting in a WPF application.","pos":[743,808]},{"content":"When you are finished, you will have a DLL that contains Direct3D9 content for use in a WPF application.","pos":[811,915]},{"pos":[920,933],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to complete this walkthrough:","pos":[935,998]},{"content":"Visual Studio 2010.","pos":[1004,1023]},{"content":"DirectX SDK 9 or later.","pos":[1029,1052]},{"pos":[1057,1087],"content":"Creating the Direct3D9 Project","linkify":"Creating the Direct3D9 Project","nodes":[{"content":"Creating the Direct3D9 Project","pos":[0,30]}]},{"content":"The first step is to create and configure the Direct3D9 project.","pos":[1089,1153]},{"pos":[1160,1191],"content":"To create the Direct3D9 project","linkify":"To create the Direct3D9 project","nodes":[{"content":"To create the Direct3D9 project","pos":[0,31]}]},{"pos":[1197,1250],"content":"Create a new Win32 Project in C++ named <ph id=\"ph1\">`D3DContent`</ph>.","source":"Create a new Win32 Project in C++ named `D3DContent`."},{"content":"The Win32 Application Wizard opens and displays the Welcome screen.","pos":[1257,1324]},{"pos":[1330,1345],"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","source":"Click **Next**."},{"content":"The Application Settings screen appears.","pos":[1352,1392]},{"pos":[1398,1462],"content":"In the <bpt id=\"p1\">**</bpt>Application type:<ept id=\"p1\">**</ept> section, select the <bpt id=\"p2\">**</bpt>DLL<ept id=\"p2\">**</ept> option.","source":"In the **Application type:** section, select the **DLL** option."},{"pos":[1468,1485],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","source":"Click **Finish**."},{"content":"The D3DContent project is generated.","pos":[1492,1528]},{"pos":[1534,1617],"content":"In Solution Explorer, right-click the D3DContent project and select <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","source":"In Solution Explorer, right-click the D3DContent project and select **Properties**."},{"pos":[1624,1675],"content":"The <bpt id=\"p1\">**</bpt>D3DContent Property Pages<ept id=\"p1\">**</ept> dialog box opens.","source":"The **D3DContent Property Pages** dialog box opens."},{"pos":[1681,1707],"content":"Select the <bpt id=\"p1\">**</bpt>C/C++<ept id=\"p1\">**</ept> node.","source":"Select the **C/C++** node."},{"content":"In the <bpt id=\"p1\">**</bpt>Additional Include Directories<ept id=\"p1\">**</ept> field, specify the location of the DirectX include folder.","pos":[1713,1813],"source":"In the **Additional Include Directories** field, specify the location of the DirectX include folder."},{"content":"The default location for this folder is %ProgramFiles%\\Microsoft DirectX SDK (<bpt id=\"p1\">*</bpt>version<ept id=\"p1\">*</ept>)\\Include.","pos":[1814,1911],"source":" The default location for this folder is %ProgramFiles%\\Microsoft DirectX SDK (*version*)\\Include."},{"pos":[1917,1963],"content":"Double-click the <bpt id=\"p1\">**</bpt>Linker<ept id=\"p1\">**</ept> node to expand it.","source":"Double-click the **Linker** node to expand it."},{"content":"In the <bpt id=\"p1\">**</bpt>Additional Library Directories<ept id=\"p1\">**</ept> field, specify the location of the DirectX libraries folder.","pos":[1968,2070],"source":"In the **Additional Library Directories** field, specify the location of the DirectX libraries folder."},{"content":"The default location for this folder is %ProgramFiles%\\Microsoft DirectX SDK (<bpt id=\"p1\">*</bpt>version<ept id=\"p1\">*</ept>)\\Lib\\x86.","pos":[2071,2168],"source":" The default location for this folder is %ProgramFiles%\\Microsoft DirectX SDK (*version*)\\Lib\\x86."},{"pos":[2174,2200],"content":"Select the <bpt id=\"p1\">**</bpt>Input<ept id=\"p1\">**</ept> node.","source":"Select the **Input** node."},{"pos":[2206,2289],"content":"In the <bpt id=\"p1\">**</bpt>Additional Dependencies<ept id=\"p1\">**</ept> field, add the <ph id=\"ph1\">`d3d9.lib`</ph> and <ph id=\"ph2\">`d3dx9.lib`</ph> files.","source":"In the **Additional Dependencies** field, add the `d3d9.lib` and `d3dx9.lib` files."},{"pos":[2295,2395],"content":"In Solution Explorer, add a new module definition file (.def) named <ph id=\"ph1\">`D3DContent.def`</ph> to the project.","source":"In Solution Explorer, add a new module definition file (.def) named `D3DContent.def` to the project."},{"pos":[2400,2430],"content":"Creating the Direct3D9 Content","linkify":"Creating the Direct3D9 Content","nodes":[{"content":"Creating the Direct3D9 Content","pos":[0,30]}]},{"content":"To get the best performance, your Direct3D9 content must use particular settings.","pos":[2432,2513]},{"content":"The following code shows how to create a Direct3D9 surface that has the best performance characteristics.","pos":[2514,2619]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Performance Considerations for Direct3D9 and WPF Interoperability<ept id=\"p1\">](performance-considerations-for-direct3d9-and-wpf-interoperability.md)</ept>.","pos":[2620,2784],"source":" For more information, see [Performance Considerations for Direct3D9 and WPF Interoperability](performance-considerations-for-direct3d9-and-wpf-interoperability.md)."},{"pos":[2791,2822],"content":"To create the Direct3D9 content","linkify":"To create the Direct3D9 content","nodes":[{"content":"To create the Direct3D9 content","pos":[0,31]}]},{"content":"Using Solution Explorer, add three C++ classes to the project named the following.","pos":[2828,2910]},{"pos":[2917,2954],"content":"<ph id=\"ph1\">`CRenderer`</ph> (with virtual destructor)","source":"`CRenderer` (with virtual destructor)"},{"content":"Open Renderer.h in the Code Editor and replace the automatically generated code with the following code.","pos":[3011,3115]},{"content":"Open Renderer.cpp in the Code Editor and replace the automatically generated code with the following code.","pos":[3279,3385]},{"content":"Open RendererManager.h in the Code Editor and replace the automatically generated code with the following code.","pos":[3555,3666]},{"content":"Open RendererManager.cpp in the Code Editor and replace the automatically generated code with the following code.","pos":[3851,3964]},{"content":"Open TriangleRenderer.h in the Code Editor and replace the automatically generated code with the following code.","pos":[4155,4267]},{"content":"Open TriangleRenderer.cpp in the Code Editor and replace the automatically generated code with the following code.","pos":[4455,4569]},{"content":"Open stdafx.h in the Code Editor and replace the automatically generated code with the following code.","pos":[4763,4865]},{"content":"Open dllmain.cpp in the Code Editor and replace the automatically generated code with the following code.","pos":[5022,5127]},{"content":"Open D3DContent.def in the code editor.","pos":[5288,5327]},{"content":"Replace the automatically generated code with the following code.","pos":[5333,5398]},{"content":"Build the project.","pos":[5572,5590]},{"pos":[5595,5605],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"Host the Direct3D9 content in a WPF application.","pos":[5611,5659]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Hosting Direct3D9 Content in WPF<ept id=\"p1\">](walkthrough-hosting-direct3d9-content-in-wpf.md)</ept>.","pos":[5660,5783],"source":" For more information, see [Walkthrough: Hosting Direct3D9 Content in WPF](walkthrough-hosting-direct3d9-content-in-wpf.md)."},{"pos":[5788,5796],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5841,5978],"content":"<bpt id=\"p1\">[</bpt>Performance Considerations for Direct3D9 and WPF Interoperability<ept id=\"p1\">](performance-considerations-for-direct3d9-and-wpf-interoperability.md)</ept>","source":"[Performance Considerations for Direct3D9 and WPF Interoperability](performance-considerations-for-direct3d9-and-wpf-interoperability.md)"},{"pos":[5981,6077],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting Direct3D9 Content in WPF<ept id=\"p1\">](walkthrough-hosting-direct3d9-content-in-wpf.md)</ept>","source":"[Walkthrough: Hosting Direct3D9 Content in WPF](walkthrough-hosting-direct3d9-content-in-wpf.md)"}]}