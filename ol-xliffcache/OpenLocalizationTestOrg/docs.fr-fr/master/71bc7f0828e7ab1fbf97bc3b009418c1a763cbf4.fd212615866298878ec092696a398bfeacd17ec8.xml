{"content":"---\ntitle: \"Interoperating with ASMX Web Services\"\nms.date: \"03/30/2017\"\nms.assetid: a7c11f0a-9e68-4f03-a6b1-39cf478d1a89\n---\n# Interoperating with ASMX Web Services\nThis sample demonstrates how to integrate a Windows Communication Foundation (WCF) client application with an existing ASMX Web service.  \n  \n> [!NOTE]\n>  The setup procedure and build instructions for this sample are located at the end of this topic.  \n  \n This sample consists of a client console program (.exe) and a service library (.dll) hosted by Internet Information Services (IIS). The service is an ASMX Web Service that implements a contract that defines a request-reply communication pattern. The service exposes math operations (`Add`, `Subtract`, `Multiply`, and `Divide`). The client makes synchronous requests to a math operation and the service replies with the result. Client activity is visible in the console window.  \n  \n The ASMX Web service implementation shown in the following sample code calculates and returns the appropriate result.  \n  \n```csharp  \n[WebService(Namespace=\"http://Microsoft.ServiceModel.Samples\")]  \npublic class CalculatorService : System.Web.Services.WebService  \n    {  \n        [WebMethod]  \n        public double Add(double n1, double n2)  \n        {  \n            return n1 + n2;  \n        }  \n        [WebMethod]  \n        public double Subtract(double n1, double n2)  \n        {  \n            return n1 - n2;  \n        }  \n        [WebMethod]  \n        public double Multiply(double n1, double n2)  \n        {  \n            return n1 * n2;  \n        }  \n        [WebMethod]  \n        public double Divide(double n1, double n2)  \n        {  \n            return n1 / n2;  \n        }  \n    }  \n```  \n  \n As configured, the service can be accessed at `http://localhost/servicemodelsamples/service.asmx` by a client on the same machine. For clients on remote machines to access the service, a qualified domain name must be specified instead of localhost.  \n  \n Communication is done through a client generated by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md). The client is contained in the file generatedClient.cs. The ASMX service must be available to generate the proxy code, because it is used to retrieve the updated metadata. Run the following command from a command prompt in the client directory to generate the typed proxy.  \n  \n```  \nsvcutil.exe /n:http://Microsoft.ServiceModel.Samples,Microsoft.ServiceModel.Samples http://localhost/servicemodelsamples/service.svc?wsdl /out:generatedClient.cs  \n```  \n  \n By using the generated client, you can access a service endpoint by configuring the appropriate address and binding. Like the service, the client uses a configuration file (App.config) to specify the endpoint to communicate with. The client endpoint configuration consists of an absolute address for the service endpoint, the binding, and the contract, as shown in the following sample configuration.  \n  \n```xml  \n<client>  \n   <endpoint   \n      address=\"http://localhost/ServiceModelSamples/service.asmx\"   \n      binding=\"basicHttpBinding\"   \n      contract=\"Microsoft.ServiceModel.Samples.CalculatorServiceSoap\" />  \n</client>  \n```  \n  \n The client implementation constructs an instance of the generated client. The generated client can then be used to communicate with the service.  \n  \n```csharp  \n// Create a client.  \nCalculatorServiceSoapClient client = new CalculatorServiceSoapClient();  \n  \n// Call the Add service operation.  \ndouble value1 = 100.00D;  \ndouble value2 = 15.99D;  \ndouble result = client.Add(value1, value2);  \nConsole.WriteLine(\"Add({0},{1}) = {2}\", value1, value2, result);  \n  \n// Call the Subtract service operation.  \nvalue1 = 145.00D;  \nvalue2 = 76.54D;  \nresult = client.Subtract(value1, value2);  \nConsole.WriteLine(\"Subtract({0},{1}) = {2}\", value1, value2, result);  \n  \n// Call the Multiply service operation.  \nvalue1 = 9.00D;  \nvalue2 = 81.25D;  \nresult = client.Multiply(value1, value2);  \nConsole.WriteLine(\"Multiply({0},{1}) = {2}\", value1, value2, result);  \n  \n// Call the Divide service operation.  \nvalue1 = 22.00D;  \nvalue2 = 7.00D;  \nresult = client.Divide(value1, value2);  \nConsole.WriteLine(\"Divide({0},{1}) = {2}\", value1, value2, result);  \n  \n//Closing the client gracefully closes the connection and cleans up resources.  \nclient.Close();  \n  \nConsole.WriteLine();  \nConsole.WriteLine(\"Press <ENTER> to terminate client.\");  \nConsole.ReadLine();  \n```  \n  \n When you run the sample, the operation requests and responses are displayed in the client console window. Press ENTER in the client window to shut down the client.  \n  \n```  \nAdd(100,15.99) = 115.99  \nSubtract(145,76.54) = 68.46  \nMultiply(9,81.25) = 731.25  \nDivide(22,7) = 3.14285714285714  \n  \nPress <ENTER> to terminate client.  \n```  \n  \n### To set up, build, and run the sample  \n  \n1.  Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md).  \n  \n2.  To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md).  \n  \n3.  To run the sample in a single- or cross-machine configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md).  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\Client\\Interop\\ASMX`  \n","nodes":[{"pos":[4,121],"embed":true,"restype":"x-metadata","content":"title: \"Interoperating with ASMX Web Services\"\nms.date: \"03/30/2017\"\nms.assetid: a7c11f0a-9e68-4f03-a6b1-39cf478d1a89","nodes":[{"content":"Interoperating with ASMX Web Services","nodes":[{"pos":[0,37],"content":"Interoperating with ASMX Web Services","nodes":[{"content":"Interoperating with ASMX Web Services","pos":[0,37]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[128,165],"content":"Interoperating with ASMX Web Services","linkify":"Interoperating with ASMX Web Services","nodes":[{"content":"Interoperating with ASMX Web Services","pos":[0,37]}]},{"content":"This sample demonstrates how to integrate a Windows Communication Foundation (WCF) client application with an existing ASMX Web service.","pos":[166,302]},{"pos":[310,417],"content":"[!NOTE]\n The setup procedure and build instructions for this sample are located at the end of this topic.","leadings":["","> "],"nodes":[{"content":"The setup procedure and build instructions for this sample are located at the end of this topic.","pos":[9,105]}]},{"content":"This sample consists of a client console program (.exe) and a service library (.dll) hosted by Internet Information Services (IIS).","pos":[424,555]},{"content":"The service is an ASMX Web Service that implements a contract that defines a request-reply communication pattern.","pos":[556,669]},{"content":"The service exposes math operations (<ph id=\"ph1\">`Add`</ph>, <ph id=\"ph2\">`Subtract`</ph>, <ph id=\"ph3\">`Multiply`</ph>, and <ph id=\"ph4\">`Divide`</ph>).","pos":[670,752],"source":" The service exposes math operations (`Add`, `Subtract`, `Multiply`, and `Divide`)."},{"content":"The client makes synchronous requests to a math operation and the service replies with the result.","pos":[753,851]},{"content":"Client activity is visible in the console window.","pos":[852,901]},{"content":"The ASMX Web service implementation shown in the following sample code calculates and returns the appropriate result.","pos":[908,1025]},{"content":"As configured, the service can be accessed at <ph id=\"ph1\">`http://localhost/servicemodelsamples/service.asmx`</ph> by a client on the same machine.","pos":[1718,1848],"source":"As configured, the service can be accessed at `http://localhost/servicemodelsamples/service.asmx` by a client on the same machine."},{"content":"For clients on remote machines to access the service, a qualified domain name must be specified instead of localhost.","pos":[1849,1966]},{"content":"Communication is done through a client generated by the <bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept>.","pos":[1973,2162],"source":"Communication is done through a client generated by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)."},{"content":"The client is contained in the file generatedClient.cs.","pos":[2163,2218]},{"content":"The ASMX service must be available to generate the proxy code, because it is used to retrieve the updated metadata.","pos":[2219,2334]},{"content":"Run the following command from a command prompt in the client directory to generate the typed proxy.","pos":[2335,2435]},{"content":"By using the generated client, you can access a service endpoint by configuring the appropriate address and binding.","pos":[2621,2737]},{"content":"Like the service, the client uses a configuration file (App.config) to specify the endpoint to communicate with.","pos":[2738,2850]},{"content":"The client endpoint configuration consists of an absolute address for the service endpoint, the binding, and the contract, as shown in the following sample configuration.","pos":[2851,3021]},{"content":"The client implementation constructs an instance of the generated client.","pos":[3265,3338]},{"content":"The generated client can then be used to communicate with the service.","pos":[3339,3409]},{"content":"When you run the sample, the operation requests and responses are displayed in the client console window.","pos":[4538,4643]},{"content":"Press ENTER in the client window to shut down the client.","pos":[4644,4701]},{"pos":[4885,4921],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"pos":[4931,5130],"content":"Ensure that you have performed the <bpt id=\"p1\">[</bpt>One-Time Setup Procedure for the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)</ept>.","source":"Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)."},{"pos":[5140,5349],"content":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in <bpt id=\"p1\">[</bpt>Building the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/building-the-samples.md)</ept>.","source":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md)."},{"pos":[5359,5567],"content":"To run the sample in a single- or cross-machine configuration, follow the instructions in <bpt id=\"p1\">[</bpt>Running the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/running-the-samples.md)</ept>.","source":"To run the sample in a single- or cross-machine configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md)."},{"pos":[5575,5707],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[14,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[5761,6071],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[6072,6122]}]}