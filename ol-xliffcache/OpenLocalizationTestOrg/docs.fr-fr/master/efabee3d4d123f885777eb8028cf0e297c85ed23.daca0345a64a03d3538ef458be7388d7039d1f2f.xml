{"content":"---\ntitle: \"Generic Field and SetField Methods (LINQ to DataSet) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 1883365f-9d6c-4ccb-9187-df309f47706d\ncaps.latest.revision: 2\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Generic Field and SetField Methods (LINQ to DataSet)\n[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] provides extension methods to the <xref:System.Data.DataRow> class for accessing column values: the <xref:System.Data.DataRowExtensions.Field%2A> method and the <xref:System.Data.DataRowExtensions.SetField%2A> method. These methods provide easier access to column values for developers, especially regarding null values. The <xref:System.Data.DataSet> uses <xref:System.DBNull.Value> to represent null values, whereas [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] uses the nullable type support introduced in the [!INCLUDE[dnprdnlong](../../../../includes/dnprdnlong-md.md)]. Using the pre-existing column accessor in <xref:System.Data.DataRow> requires you to cast the return object to the appropriate type. If a particular field in a <xref:System.Data.DataRow> can be null, you must explicitly check for a null value because returning <xref:System.DBNull.Value> and implicitly casting it to another type throws an <xref:System.InvalidCastException>. In the following example, if the <xref:System.Data.DataRow.IsNull%2A> method was not used to check for a null value, an exception would be thrown if the indexer returned <xref:System.DBNull.Value> and tried to cast it to a <xref:System.String>.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#WhereIsNull](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#whereisnull)]\n [!code-vb[DP LINQ to DataSet Examples#WhereIsNull](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#whereisnull)]  \n  \n The <xref:System.Data.DataRowExtensions.Field%2A> method provides access to the column values of a <xref:System.Data.DataRow> and the <xref:System.Data.DataRowExtensions.SetField%2A> sets column values in a <xref:System.Data.DataRow>. Both the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method handle nullable types, so you do not have to explicitly check for null values as in the previous example. Both methods are generic methods, also, so you do not have to cast the return type.  \n  \n The following example uses the <xref:System.Data.DataRowExtensions.Field%2A> method.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#Where3](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#where3)]\n [!code-vb[DP LINQ to DataSet Examples#Where3](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#where3)]  \n  \n Note that the data type specified in the generic parameter `T` of the <xref:System.Data.DataRowExtensions.Field%2A> method and the <xref:System.Data.DataRowExtensions.SetField%2A> method must match the type of the underlying value. Otherwise, an <xref:System.InvalidCastException> exception will be thrown. The specified column name must also match the name of a column in the <xref:System.Data.DataSet>, or an <xref:System.ArgumentException> will be thrown. In both cases, the exception is thrown at run time during the enumeration of the data when the query is executed.  \n  \n The <xref:System.Data.DataRowExtensions.SetField%2A> method itself does not perform any type conversions. This does not mean, however, that a type conversion will not occur. The <xref:System.Data.DataRowExtensions.SetField%2A> method exposes the [!INCLUDE[ado_whidbey_long](../../../../includes/ado-whidbey-long-md.md)] behavior of the <xref:System.Data.DataRow> class. A type conversion could be performed by the <xref:System.Data.DataRow> object and the converted value would then be saved to the <xref:System.Data.DataRow> object.  \n  \n## See Also  \n <xref:System.Data.DataRowExtensions>","nodes":[{"pos":[4,383],"embed":true,"restype":"x-metadata","content":"title: \"Generic Field and SetField Methods (LINQ to DataSet) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 1883365f-9d6c-4ccb-9187-df309f47706d\ncaps.latest.revision: 2\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","nodes":[{"content":"Generic Field and SetField Methods (LINQ to DataSet) | Microsoft Docs","nodes":[{"pos":[0,69],"content":"Generic Field and SetField Methods (LINQ to DataSet) | Microsoft Docs","nodes":[{"content":"Generic Field and SetField Methods (LINQ to DataSet) | Microsoft Docs","pos":[0,69]}]}],"path":["title"]}],"yml":true},{"pos":[390,442],"content":"Generic Field and SetField Methods (LINQ to DataSet)","linkify":"Generic Field and SetField Methods (LINQ to DataSet)","nodes":[{"content":"Generic Field and SetField Methods (LINQ to DataSet)","pos":[0,52]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]</ph> provides extension methods to the <ph id=\"ph2\">&lt;xref:System.Data.DataRow&gt;</ph> class for accessing column values: the <ph id=\"ph3\">&lt;xref:System.Data.DataRowExtensions.Field%2A&gt;</ph> method and the <ph id=\"ph4\">&lt;xref:System.Data.DataRowExtensions.SetField%2A&gt;</ph> method.","pos":[443,726],"source":"[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] provides extension methods to the <xref:System.Data.DataRow> class for accessing column values: the <xref:System.Data.DataRowExtensions.Field%2A> method and the <xref:System.Data.DataRowExtensions.SetField%2A> method."},{"content":"These methods provide easier access to column values for developers, especially regarding null values.","pos":[727,829]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> uses <ph id=\"ph2\">&lt;xref:System.DBNull.Value&gt;</ph> to represent null values, whereas <ph id=\"ph3\">[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]</ph> uses the nullable type support introduced in the <ph id=\"ph4\">[!INCLUDE[dnprdnlong](../../../../includes/dnprdnlong-md.md)]</ph>.","pos":[830,1098],"source":" The <xref:System.Data.DataSet> uses <xref:System.DBNull.Value> to represent null values, whereas [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] uses the nullable type support introduced in the [!INCLUDE[dnprdnlong](../../../../includes/dnprdnlong-md.md)]."},{"content":"Using the pre-existing column accessor in <ph id=\"ph1\">&lt;xref:System.Data.DataRow&gt;</ph> requires you to cast the return object to the appropriate type.","pos":[1099,1231],"source":" Using the pre-existing column accessor in <xref:System.Data.DataRow> requires you to cast the return object to the appropriate type."},{"content":"If a particular field in a <ph id=\"ph1\">&lt;xref:System.Data.DataRow&gt;</ph> can be null, you must explicitly check for a null value because returning <ph id=\"ph2\">&lt;xref:System.DBNull.Value&gt;</ph> and implicitly casting it to another type throws an <ph id=\"ph3\">&lt;xref:System.InvalidCastException&gt;</ph>.","pos":[1232,1474],"source":" If a particular field in a <xref:System.Data.DataRow> can be null, you must explicitly check for a null value because returning <xref:System.DBNull.Value> and implicitly casting it to another type throws an <xref:System.InvalidCastException>."},{"content":"In the following example, if the <ph id=\"ph1\">&lt;xref:System.Data.DataRow.IsNull%2A&gt;</ph> method was not used to check for a null value, an exception would be thrown if the indexer returned <ph id=\"ph2\">&lt;xref:System.DBNull.Value&gt;</ph> and tried to cast it to a <ph id=\"ph3\">&lt;xref:System.String&gt;</ph>.","pos":[1475,1719],"source":" In the following example, if the <xref:System.Data.DataRow.IsNull%2A> method was not used to check for a null value, an exception would be thrown if the indexer returned <xref:System.DBNull.Value> and tried to cast it to a <xref:System.String>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataRowExtensions.Field%2A&gt;</ph> method provides access to the column values of a <ph id=\"ph2\">&lt;xref:System.Data.DataRow&gt;</ph> and the <ph id=\"ph3\">&lt;xref:System.Data.DataRowExtensions.SetField%2A&gt;</ph> sets column values in a <ph id=\"ph4\">&lt;xref:System.Data.DataRow&gt;</ph>.","pos":[2068,2302],"source":"The <xref:System.Data.DataRowExtensions.Field%2A> method provides access to the column values of a <xref:System.Data.DataRow> and the <xref:System.Data.DataRowExtensions.SetField%2A> sets column values in a <xref:System.Data.DataRow>."},{"content":"Both the <ph id=\"ph1\">&lt;xref:System.Data.DataRowExtensions.Field%2A&gt;</ph> method and <ph id=\"ph2\">&lt;xref:System.Data.DataRowExtensions.SetField%2A&gt;</ph> method handle nullable types, so you do not have to explicitly check for null values as in the previous example.","pos":[2303,2530],"source":" Both the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method handle nullable types, so you do not have to explicitly check for null values as in the previous example."},{"content":"Both methods are generic methods, also, so you do not have to cast the return type.","pos":[2531,2614]},{"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Data.DataRowExtensions.Field%2A&gt;</ph> method.","pos":[2621,2705],"source":"The following example uses the <xref:System.Data.DataRowExtensions.Field%2A> method."},{"content":"Note that the data type specified in the generic parameter <ph id=\"ph1\">`T`</ph> of the <ph id=\"ph2\">&lt;xref:System.Data.DataRowExtensions.Field%2A&gt;</ph> method and the <ph id=\"ph3\">&lt;xref:System.Data.DataRowExtensions.SetField%2A&gt;</ph> method must match the type of the underlying value.","pos":[3034,3265],"source":"Note that the data type specified in the generic parameter `T` of the <xref:System.Data.DataRowExtensions.Field%2A> method and the <xref:System.Data.DataRowExtensions.SetField%2A> method must match the type of the underlying value."},{"content":"Otherwise, an <ph id=\"ph1\">&lt;xref:System.InvalidCastException&gt;</ph> exception will be thrown.","pos":[3266,3340],"source":" Otherwise, an <xref:System.InvalidCastException> exception will be thrown."},{"content":"The specified column name must also match the name of a column in the <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph>, or an <ph id=\"ph2\">&lt;xref:System.ArgumentException&gt;</ph> will be thrown.","pos":[3341,3492],"source":" The specified column name must also match the name of a column in the <xref:System.Data.DataSet>, or an <xref:System.ArgumentException> will be thrown."},{"content":"In both cases, the exception is thrown at run time during the enumeration of the data when the query is executed.","pos":[3493,3606]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataRowExtensions.SetField%2A&gt;</ph> method itself does not perform any type conversions.","pos":[3613,3718],"source":"The <xref:System.Data.DataRowExtensions.SetField%2A> method itself does not perform any type conversions."},{"content":"This does not mean, however, that a type conversion will not occur.","pos":[3719,3786]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataRowExtensions.SetField%2A&gt;</ph> method exposes the <ph id=\"ph2\">[!INCLUDE[ado_whidbey_long](../../../../includes/ado-whidbey-long-md.md)]</ph> behavior of the <ph id=\"ph3\">&lt;xref:System.Data.DataRow&gt;</ph> class.","pos":[3787,3982],"source":" The <xref:System.Data.DataRowExtensions.SetField%2A> method exposes the [!INCLUDE[ado_whidbey_long](../../../../includes/ado-whidbey-long-md.md)] behavior of the <xref:System.Data.DataRow> class."},{"content":"A type conversion could be performed by the <ph id=\"ph1\">&lt;xref:System.Data.DataRow&gt;</ph> object and the converted value would then be saved to the <ph id=\"ph2\">&lt;xref:System.Data.DataRow&gt;</ph> object.","pos":[3983,4146],"source":" A type conversion could be performed by the <xref:System.Data.DataRow> object and the converted value would then be saved to the <xref:System.Data.DataRow> object."},{"pos":[4155,4163],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]}]}