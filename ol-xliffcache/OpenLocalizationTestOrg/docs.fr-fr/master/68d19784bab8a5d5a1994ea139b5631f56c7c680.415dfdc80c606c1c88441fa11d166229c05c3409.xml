{"content":"---\ntitle: \"Reading XML Data using XPathDocument and XmlDocument\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 5711b225-6aa2-4e4f-9898-19f2d518ad1a\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Reading XML Data using XPathDocument and XmlDocument\nThere are two ways to read an XML document in the <xref:System.Xml.XPath?displayProperty=nameWithType> namespace. One is to read an XML document using the read-only <xref:System.Xml.XPath.XPathDocument> class and the other is to read an XML document using the editable <xref:System.Xml.XmlDocument> class in the <xref:System.Xml?displayProperty=nameWithType> namespace.  \n  \n## Reading XML Documents using the XPathDocument Class  \n The <xref:System.Xml.XPath.XPathDocument> class provides a fast, read-only, in-memory representation of an XML document using the XPath data model. Instances of the <xref:System.Xml.XPath.XPathDocument> class are created using one of its six constructors. These constructors allow you to read an XML document using a <xref:System.IO.Stream>, <xref:System.IO.TextReader>, or <xref:System.Xml.XmlReader> object, as well as the `string` path to an XML file.  \n  \n The following example illustrates using the <xref:System.Xml.XPath.XPathDocument> class's `string` constructor to read an XML document.  \n  \n```vb  \nDim document As XPathDocument = New XPathDocument(\"books.xml\")  \n```  \n  \n```csharp  \nXPathDocument document = new XPathDocument(\"books.xml\");  \n```  \n  \n## Reading XML Documents using the XmlDocument Class  \n The <xref:System.Xml.XmlDocument> class is an editable in-memory representation of an XML document implementing W3C Document Object Model (DOM) Level 1 Core and Core DOM Level 2. Instances of the <xref:System.Xml.XmlDocument> class are created using one of its three constructors. You can create a new, empty <xref:System.Xml.XmlDocument> object by calling the <xref:System.Xml.XmlDocument> class constructor with no parameters. After calling the constructor, use the <xref:System.Xml.XmlDocument.Load%2A> method to load XML data into the new <xref:System.Xml.XmlDocument> object from a <xref:System.IO.Stream>, <xref:System.IO.TextReader>, or <xref:System.Xml.XmlReader> object, as well as the `string` path to an XML file.  \n  \n The following example illustrates using the <xref:System.Xml.XmlDocument> class constructor with no parameters and the <xref:System.Xml.XmlDocument.Load%2A> method to read an XML document.  \n  \n```vb  \nDim document As XmlDocument = New XmlDocument()  \ndocument.Load(\"books.xml\")  \n```  \n  \n```csharp  \nXmlDocument document = new XmlDocument();  \ndocument.Load(\"books.xml\");  \n```  \n  \n## Determining the Encoding of an XML Document  \n An <xref:System.Xml.XmlReader> object can be used to read an XML document and to create <xref:System.Xml.XPath.XPathDocument> and <xref:System.Xml.XmlDocument> objects as shown in the previous sections. However, an <xref:System.Xml.XmlReader> object may read data that is not encoded and as a result does not provide any encoding information.  \n  \n The <xref:System.Xml.XmlTextReader> class inherits from the <xref:System.Xml.XmlReader> class, provides encoding information using its <xref:System.Xml.XmlTextReader.Encoding%2A> property, and can be used to create an <xref:System.Xml.XPath.XPathDocument> object or <xref:System.Xml.XmlDocument> object.  \n  \n For more information about the encoding information provided by the <xref:System.Xml.XmlTextReader> class, see the <xref:System.Xml.XmlTextReader.Encoding%2A> property in the <xref:System.Xml.XmlTextReader> class reference documentation.  \n  \n## Creating XPathNavigator Objects  \n After you have read an XML document into either an <xref:System.Xml.XPath.XPathDocument> or <xref:System.Xml.XmlDocument> object, you can create an <xref:System.Xml.XPath.XPathNavigator> object to select, evaluate, navigate, and in some cases, edit the underlying XML data.  \n  \n Both the <xref:System.Xml.XPath.XPathDocument> and <xref:System.Xml.XmlDocument> classes, in addition to the <xref:System.Xml.XmlNode> class, implement the <xref:System.Xml.XPath.IXPathNavigable> interface of the <xref:System.Xml.XPath?displayProperty=nameWithType> namespace. As a result, all three classes provide a <xref:System.Xml.XPath.IXPathNavigable.CreateNavigator%2A> method that returns an <xref:System.Xml.XPath.XPathNavigator> object.  \n  \n### Editing XML Documents using the XPathNavigator Class  \n In addition to selecting, evaluating, and navigating XML data, the <xref:System.Xml.XPath.XPathNavigator> class can be used to edit an XML document in some cases, based on the object that created it.  \n  \n The <xref:System.Xml.XPath.XPathDocument> class is read-only while the <xref:System.Xml.XmlDocument> class is editable and as a result, <xref:System.Xml.XPath.XPathNavigator> objects created from an <xref:System.Xml.XPath.XPathDocument> object cannot be used to edit an XML document while those created from an <xref:System.Xml.XmlDocument> object can. The <xref:System.Xml.XPath.XPathDocument> class should be used to read an XML document only. In cases where you need to edit an XML document, or require access to the additional functionality provided by the <xref:System.Xml.XmlDocument> class, like event handling, the <xref:System.Xml.XmlDocument> class should be used.  \n  \n The <xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> property of the <xref:System.Xml.XPath.XPathNavigator> class specifies if an <xref:System.Xml.XPath.XPathNavigator> object may edit XML data.  \n  \n The following table describes the value of the <xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> property for each class.  \n  \n|<xref:System.Xml.XPath.IXPathNavigable> Implementation|<xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> Value|  \n|--------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|  \n|<xref:System.Xml.XPath.XPathDocument>|`false`|  \n|<xref:System.Xml.XmlDocument>|`true`|  \n  \n## See also\n\n- <xref:System.Xml.XmlDocument>\n- <xref:System.Xml.XPath.XPathDocument>\n- <xref:System.Xml.XPath.XPathNavigator>\n- [Process XML Data Using the XPath Data Model](../../../../docs/standard/data/xml/process-xml-data-using-the-xpath-data-model.md)\n- [Accessing XML Data using XPathNavigator](../../../../docs/standard/data/xml/accessing-xml-data-using-xpathnavigator.md)\n- [Editing XML Data using XPathNavigator](../../../../docs/standard/data/xml/editing-xml-data-using-xpathnavigator.md)\n- [Schema Validation using XPathNavigator](../../../../docs/standard/data/xml/schema-validation-using-xpathnavigator.md)\n","nodes":[{"pos":[4,238],"embed":true,"restype":"x-metadata","content":"title: \"Reading XML Data using XPathDocument and XmlDocument\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 5711b225-6aa2-4e4f-9898-19f2d518ad1a\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Reading XML Data using XPathDocument and XmlDocument","nodes":[{"pos":[0,52],"content":"Reading XML Data using XPathDocument and XmlDocument","nodes":[{"content":"Reading XML Data using XPathDocument and XmlDocument","pos":[0,52]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[245,297],"content":"Reading XML Data using XPathDocument and XmlDocument","linkify":"Reading XML Data using XPathDocument and XmlDocument","nodes":[{"content":"Reading XML Data using XPathDocument and XmlDocument","pos":[0,52]}]},{"content":"There are two ways to read an XML document in the <ph id=\"ph1\">&lt;xref:System.Xml.XPath?displayProperty=nameWithType&gt;</ph> namespace.","pos":[298,411],"source":"There are two ways to read an XML document in the <xref:System.Xml.XPath?displayProperty=nameWithType> namespace."},{"content":"One is to read an XML document using the read-only <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class and the other is to read an XML document using the editable <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class in the <ph id=\"ph3\">&lt;xref:System.Xml?displayProperty=nameWithType&gt;</ph> namespace.","pos":[412,667],"source":" One is to read an XML document using the read-only <xref:System.Xml.XPath.XPathDocument> class and the other is to read an XML document using the editable <xref:System.Xml.XmlDocument> class in the <xref:System.Xml?displayProperty=nameWithType> namespace."},{"pos":[676,727],"content":"Reading XML Documents using the XPathDocument Class","linkify":"Reading XML Documents using the XPathDocument Class","nodes":[{"content":"Reading XML Documents using the XPathDocument Class","pos":[0,51]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class provides a fast, read-only, in-memory representation of an XML document using the XPath data model.","pos":[731,878],"source":"The <xref:System.Xml.XPath.XPathDocument> class provides a fast, read-only, in-memory representation of an XML document using the XPath data model."},{"content":"Instances of the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class are created using one of its six constructors.","pos":[879,986],"source":" Instances of the <xref:System.Xml.XPath.XPathDocument> class are created using one of its six constructors."},{"content":"These constructors allow you to read an XML document using a <ph id=\"ph1\">&lt;xref:System.IO.Stream&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.IO.TextReader&gt;</ph>, or <ph id=\"ph3\">&lt;xref:System.Xml.XmlReader&gt;</ph> object, as well as the <ph id=\"ph4\">`string`</ph> path to an XML file.","pos":[987,1185],"source":" These constructors allow you to read an XML document using a <xref:System.IO.Stream>, <xref:System.IO.TextReader>, or <xref:System.Xml.XmlReader> object, as well as the `string` path to an XML file."},{"pos":[1192,1327],"content":"The following example illustrates using the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class's <ph id=\"ph2\">`string`</ph> constructor to read an XML document.","source":"The following example illustrates using the <xref:System.Xml.XPath.XPathDocument> class's `string` constructor to read an XML document."},{"pos":[1498,1547],"content":"Reading XML Documents using the XmlDocument Class","linkify":"Reading XML Documents using the XmlDocument Class","nodes":[{"content":"Reading XML Documents using the XmlDocument Class","pos":[0,49]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class is an editable in-memory representation of an XML document implementing W3C Document Object Model (DOM) Level 1 Core and Core DOM Level 2.","pos":[1551,1729],"source":"The <xref:System.Xml.XmlDocument> class is an editable in-memory representation of an XML document implementing W3C Document Object Model (DOM) Level 1 Core and Core DOM Level 2."},{"content":"Instances of the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class are created using one of its three constructors.","pos":[1730,1831],"source":" Instances of the <xref:System.Xml.XmlDocument> class are created using one of its three constructors."},{"content":"You can create a new, empty <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object by calling the <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class constructor with no parameters.","pos":[1832,1979],"source":" You can create a new, empty <xref:System.Xml.XmlDocument> object by calling the <xref:System.Xml.XmlDocument> class constructor with no parameters."},{"content":"After calling the constructor, use the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument.Load%2A&gt;</ph> method to load XML data into the new <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object from a <ph id=\"ph3\">&lt;xref:System.IO.Stream&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.IO.TextReader&gt;</ph>, or <ph id=\"ph5\">&lt;xref:System.Xml.XmlReader&gt;</ph> object, as well as the <ph id=\"ph6\">`string`</ph> path to an XML file.","pos":[1980,2275],"source":" After calling the constructor, use the <xref:System.Xml.XmlDocument.Load%2A> method to load XML data into the new <xref:System.Xml.XmlDocument> object from a <xref:System.IO.Stream>, <xref:System.IO.TextReader>, or <xref:System.Xml.XmlReader> object, as well as the `string` path to an XML file."},{"pos":[2282,2470],"content":"The following example illustrates using the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class constructor with no parameters and the <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument.Load%2A&gt;</ph> method to read an XML document.","source":"The following example illustrates using the <xref:System.Xml.XmlDocument> class constructor with no parameters and the <xref:System.Xml.XmlDocument.Load%2A> method to read an XML document."},{"pos":[2670,2713],"content":"Determining the Encoding of an XML Document","linkify":"Determining the Encoding of an XML Document","nodes":[{"content":"Determining the Encoding of an XML Document","pos":[0,43]}]},{"content":"An <ph id=\"ph1\">&lt;xref:System.Xml.XmlReader&gt;</ph> object can be used to read an XML document and to create <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Xml.XmlDocument&gt;</ph> objects as shown in the previous sections.","pos":[2717,2919],"source":"An <xref:System.Xml.XmlReader> object can be used to read an XML document and to create <xref:System.Xml.XPath.XPathDocument> and <xref:System.Xml.XmlDocument> objects as shown in the previous sections."},{"content":"However, an <ph id=\"ph1\">&lt;xref:System.Xml.XmlReader&gt;</ph> object may read data that is not encoded and as a result does not provide any encoding information.","pos":[2920,3059],"source":" However, an <xref:System.Xml.XmlReader> object may read data that is not encoded and as a result does not provide any encoding information."},{"pos":[3066,3369],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlTextReader&gt;</ph> class inherits from the <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph> class, provides encoding information using its <ph id=\"ph3\">&lt;xref:System.Xml.XmlTextReader.Encoding%2A&gt;</ph> property, and can be used to create an <ph id=\"ph4\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> object or <ph id=\"ph5\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object.","source":"The <xref:System.Xml.XmlTextReader> class inherits from the <xref:System.Xml.XmlReader> class, provides encoding information using its <xref:System.Xml.XmlTextReader.Encoding%2A> property, and can be used to create an <xref:System.Xml.XPath.XPathDocument> object or <xref:System.Xml.XmlDocument> object."},{"pos":[3376,3613],"content":"For more information about the encoding information provided by the <ph id=\"ph1\">&lt;xref:System.Xml.XmlTextReader&gt;</ph> class, see the <ph id=\"ph2\">&lt;xref:System.Xml.XmlTextReader.Encoding%2A&gt;</ph> property in the <ph id=\"ph3\">&lt;xref:System.Xml.XmlTextReader&gt;</ph> class reference documentation.","source":"For more information about the encoding information provided by the <xref:System.Xml.XmlTextReader> class, see the <xref:System.Xml.XmlTextReader.Encoding%2A> property in the <xref:System.Xml.XmlTextReader> class reference documentation."},{"pos":[3622,3653],"content":"Creating XPathNavigator Objects","linkify":"Creating XPathNavigator Objects","nodes":[{"content":"Creating XPathNavigator Objects","pos":[0,31]}]},{"pos":[3657,3930],"content":"After you have read an XML document into either an <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object, you can create an <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object to select, evaluate, navigate, and in some cases, edit the underlying XML data.","source":"After you have read an XML document into either an <xref:System.Xml.XPath.XPathDocument> or <xref:System.Xml.XmlDocument> object, you can create an <xref:System.Xml.XPath.XPathNavigator> object to select, evaluate, navigate, and in some cases, edit the underlying XML data."},{"content":"Both the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> classes, in addition to the <ph id=\"ph3\">&lt;xref:System.Xml.XmlNode&gt;</ph> class, implement the <ph id=\"ph4\">&lt;xref:System.Xml.XPath.IXPathNavigable&gt;</ph> interface of the <ph id=\"ph5\">&lt;xref:System.Xml.XPath?displayProperty=nameWithType&gt;</ph> namespace.","pos":[3937,4213],"source":"Both the <xref:System.Xml.XPath.XPathDocument> and <xref:System.Xml.XmlDocument> classes, in addition to the <xref:System.Xml.XmlNode> class, implement the <xref:System.Xml.XPath.IXPathNavigable> interface of the <xref:System.Xml.XPath?displayProperty=nameWithType> namespace."},{"content":"As a result, all three classes provide a <ph id=\"ph1\">&lt;xref:System.Xml.XPath.IXPathNavigable.CreateNavigator%2A&gt;</ph> method that returns an <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object.","pos":[4214,4383],"source":" As a result, all three classes provide a <xref:System.Xml.XPath.IXPathNavigable.CreateNavigator%2A> method that returns an <xref:System.Xml.XPath.XPathNavigator> object."},{"pos":[4393,4445],"content":"Editing XML Documents using the XPathNavigator Class","linkify":"Editing XML Documents using the XPathNavigator Class","nodes":[{"content":"Editing XML Documents using the XPathNavigator Class","pos":[0,52]}]},{"pos":[4449,4648],"content":"In addition to selecting, evaluating, and navigating XML data, the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class can be used to edit an XML document in some cases, based on the object that created it.","source":"In addition to selecting, evaluating, and navigating XML data, the <xref:System.Xml.XPath.XPathNavigator> class can be used to edit an XML document in some cases, based on the object that created it."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class is read-only while the <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class is editable and as a result, <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> objects created from an <ph id=\"ph4\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> object cannot be used to edit an XML document while those created from an <ph id=\"ph5\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object can.","pos":[4655,5007],"source":"The <xref:System.Xml.XPath.XPathDocument> class is read-only while the <xref:System.Xml.XmlDocument> class is editable and as a result, <xref:System.Xml.XPath.XPathNavigator> objects created from an <xref:System.Xml.XPath.XPathDocument> object cannot be used to edit an XML document while those created from an <xref:System.Xml.XmlDocument> object can."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class should be used to read an XML document only.","pos":[5008,5100],"source":" The <xref:System.Xml.XPath.XPathDocument> class should be used to read an XML document only."},{"content":"In cases where you need to edit an XML document, or require access to the additional functionality provided by the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class, like event handling, the <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class should be used.","pos":[5101,5329],"source":" In cases where you need to edit an XML document, or require access to the additional functionality provided by the <xref:System.Xml.XmlDocument> class, like event handling, the <xref:System.Xml.XmlDocument> class should be used."},{"pos":[5336,5531],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.CanEdit%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class specifies if an <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object may edit XML data.","source":"The <xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> property of the <xref:System.Xml.XPath.XPathNavigator> class specifies if an <xref:System.Xml.XPath.XPathNavigator> object may edit XML data."},{"pos":[5538,5659],"content":"The following table describes the value of the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.CanEdit%2A&gt;</ph> property for each class.","source":"The following table describes the value of the <xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> property for each class."},{"pos":[5666,5720],"content":"<ph id=\"ph1\">&lt;xref:System.Xml.XPath.IXPathNavigable&gt;</ph> Implementation","source":"<xref:System.Xml.XPath.IXPathNavigable> Implementation"},{"pos":[5721,5776],"content":"<ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.CanEdit%2A&gt;</ph> Value","source":"<xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> Value"},{"pos":[6197,6205],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6322,6450],"content":"<bpt id=\"p1\">[</bpt>Process XML Data Using the XPath Data Model<ept id=\"p1\">](../../../../docs/standard/data/xml/process-xml-data-using-the-xpath-data-model.md)</ept>","source":"[Process XML Data Using the XPath Data Model](../../../../docs/standard/data/xml/process-xml-data-using-the-xpath-data-model.md)"},{"pos":[6453,6573],"content":"<bpt id=\"p1\">[</bpt>Accessing XML Data using XPathNavigator<ept id=\"p1\">](../../../../docs/standard/data/xml/accessing-xml-data-using-xpathnavigator.md)</ept>","source":"[Accessing XML Data using XPathNavigator](../../../../docs/standard/data/xml/accessing-xml-data-using-xpathnavigator.md)"},{"pos":[6576,6692],"content":"<bpt id=\"p1\">[</bpt>Editing XML Data using XPathNavigator<ept id=\"p1\">](../../../../docs/standard/data/xml/editing-xml-data-using-xpathnavigator.md)</ept>","source":"[Editing XML Data using XPathNavigator](../../../../docs/standard/data/xml/editing-xml-data-using-xpathnavigator.md)"},{"pos":[6695,6813],"content":"<bpt id=\"p1\">[</bpt>Schema Validation using XPathNavigator<ept id=\"p1\">](../../../../docs/standard/data/xml/schema-validation-using-xpathnavigator.md)</ept>","source":"[Schema Validation using XPathNavigator](../../../../docs/standard/data/xml/schema-validation-using-xpathnavigator.md)"}]}