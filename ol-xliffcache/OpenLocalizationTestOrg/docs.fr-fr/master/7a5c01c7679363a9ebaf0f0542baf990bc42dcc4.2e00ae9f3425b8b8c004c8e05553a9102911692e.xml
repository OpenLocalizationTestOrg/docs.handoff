{"content":"---\ntitle: \"IHostMemoryManager::GetMemoryLoad Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IHostMemoryManager.GetMemoryLoad\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostMemoryManager::GetMemoryLoad\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IHostMemoryManager::GetMemoryLoad method [.NET Framework hosting]\"\n  - \"GetMemoryLoad method [.NET Framework hosting]\"\nms.assetid: e8138f6e-a0a4-48d4-8dae-9466b4dc6180\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 11\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# IHostMemoryManager::GetMemoryLoad Method\nGets the amount of physical memory that is currently in use, and therefore unavailable, as reported by the host.  \n  \n## Syntax  \n  \n```  \nHRESULT GetMemoryLoad (  \n    [out] DWORD*  pMemoryLoad,   \n    [out] SIZE_T  *pAvailableBytes  \n);  \n```  \n  \n#### Parameters  \n `pMemoryLoad`  \n [out] A pointer to the approximate percentage of total physical memory that is currently in use.  \n  \n `pAvailableBytes`  \n [out] A pointer to the number of bytes available to the common language runtime (CLR).  \n  \n## Return Value  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|`GetMemoryLoad` returned successfully.|  \n|HOST_E_CLRNOTAVAILABLE|The CLR has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.|  \n|HOST_E_TIMEOUT|The call timed out.|  \n|HOST_E_NOT_OWNER|The caller does not own the lock.|  \n|HOST_E_ABANDONED|An event was canceled while a blocked thread or fiber was waiting on it.|  \n|E_FAIL|An unknown catastrophic failure occurred. When a method returns E_FAIL, the CLR is no longer usable within the process. Subsequent calls to hosting methods return HOST_E_CLRNOTAVAILABLE.|  \n  \n## Remarks  \n `GetMemoryLoad` wraps the Win32 `GlobalMemoryStatus` function. The value of `pMemoryLoad` is the equivalent of the `dwMemoryLoad` field in the `MEMORYSTATUS` structure returned from `GlobalMemoryStatus`.  \n  \n The runtime uses the return value as a heuristic for the garbage collector. For example, if the host reports that the majority of memory is in use, the garbage collector may elect to collect from multiple generations to increase the amount of memory that can potentially become available.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See Also  \n <xref:System.GC?displayProperty=fullName>   \n [IHostMemoryManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihostmemorymanager-interface.md)","nodes":[{"pos":[12,69],"content":"IHostMemoryManager::GetMemoryLoad Method | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IHostMemoryManager::GetMemoryLoad Method | Microsoft Docs","pos":[0,57]}]},{"pos":[727,767],"content":"IHostMemoryManager::GetMemoryLoad Method","linkify":"IHostMemoryManager::GetMemoryLoad Method","nodes":[{"content":"IHostMemoryManager::GetMemoryLoad Method","pos":[0,40]}]},{"content":"Gets the amount of physical memory that is currently in use, and therefore unavailable, as reported by the host.","pos":[768,880]},{"pos":[889,895],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1023,1033],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[out] A pointer to the approximate percentage of total physical memory that is currently in use.","pos":[1054,1150]},{"content":"[out] A pointer to the number of bytes available to the common language runtime (CLR).","pos":[1178,1264]},{"pos":[1273,1285],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"HRESULT","pos":[1292,1299]},{"content":"Description","pos":[1300,1311]},{"content":"S_OK","pos":[1352,1356]},{"pos":[1357,1395],"content":"<ph id=\"ph1\">`GetMemoryLoad`</ph> returned successfully.","source":"`GetMemoryLoad` returned successfully."},{"content":"HOST_E_CLRNOTAVAILABLE","pos":[1400,1422]},{"content":"The CLR has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.","pos":[1423,1561]},{"content":"HOST_E_TIMEOUT","pos":[1566,1580]},{"content":"The call timed out.","pos":[1581,1600]},{"content":"HOST_E_NOT_OWNER","pos":[1605,1621]},{"content":"The caller does not own the lock.","pos":[1622,1655]},{"content":"HOST_E_ABANDONED","pos":[1660,1676]},{"content":"An event was canceled while a blocked thread or fiber was waiting on it.","pos":[1677,1749]},{"content":"E_FAIL","pos":[1754,1760]},{"content":"An unknown catastrophic failure occurred.","pos":[1761,1802]},{"content":"When a method returns E_FAIL, the CLR is no longer usable within the process.","pos":[1803,1880]},{"content":"Subsequent calls to hosting methods return HOST_E_CLRNOTAVAILABLE.","pos":[1881,1947]},{"pos":[1957,1964],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`GetMemoryLoad`</ph> wraps the Win32 <ph id=\"ph2\">`GlobalMemoryStatus`</ph> function.","pos":[1968,2030],"source":"`GetMemoryLoad` wraps the Win32 `GlobalMemoryStatus` function."},{"content":"The value of <ph id=\"ph1\">`pMemoryLoad`</ph> is the equivalent of the <ph id=\"ph2\">`dwMemoryLoad`</ph> field in the <ph id=\"ph3\">`MEMORYSTATUS`</ph> structure returned from <ph id=\"ph4\">`GlobalMemoryStatus`</ph>.","pos":[2031,2171],"source":" The value of `pMemoryLoad` is the equivalent of the `dwMemoryLoad` field in the `MEMORYSTATUS` structure returned from `GlobalMemoryStatus`."},{"content":"The runtime uses the return value as a heuristic for the garbage collector.","pos":[2178,2253]},{"content":"For example, if the host reports that the majority of memory is in use, the garbage collector may elect to collect from multiple generations to increase the amount of memory that can potentially become available.","pos":[2254,2466]},{"pos":[2475,2487],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2491,2595],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2602,2623],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2630,2680],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[2687,2795],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[2804,2812],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>IHostMemoryManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostmemorymanager-interface.md)</ept>","pos":[2861,2974],"source":" [IHostMemoryManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihostmemorymanager-interface.md)"}]}