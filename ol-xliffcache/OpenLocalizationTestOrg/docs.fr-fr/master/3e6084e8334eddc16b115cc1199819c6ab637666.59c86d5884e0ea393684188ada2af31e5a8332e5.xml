{"content":"---\ntitle: \"NamedPipe Activation\"\nms.date: \"03/30/2017\"\nms.assetid: f3c0437d-006c-442e-bfb0-6b29216e4e29\n---\n\n# NamedPipe Activation\n\nThis sample demonstrates hosting a service that uses Windows Process Activation Service (WAS) to activate a service that communicates over names pipes. This sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md) and requires [!INCLUDE[wv](../../../../includes/wv-md.md)] to run.\n\n> [!NOTE]\n> The set-up procedure and build instructions for this sample are located at the end of this topic.\n\n> [!IMPORTANT]\n> The samples may already be installed on your computer. Check for the following (default) directory before continuing.\n>\n> `<InstallDrive>:\\WF_WCF_Samples`\n>\n> If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.\n>\n> `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\Services\\Hosting\\WASHost\\NamedPipeActivation`\n\n## Sample Details\n\nThe sample consists of a client console program (.exe) and a service library (.dll) hosted in a worker process activated by the Windows Process Activation Services (WAS). Client activity is visible in the console window.\n\nThe service implements a contract that defines a request-reply communication pattern. The contract is defined by the `ICalculator` interface, which exposes math operations (Add, Subtract, Multiply, and Divide), as shown in the following sample code.\n\n```csharp\n[ServiceContract(Namespace=\"http://Microsoft.ServiceModel.Samples\")]\npublic interface ICalculator\n{\n    [OperationContract]\n    double Add(double n1, double n2);\n    [OperationContract]\n    double Subtract(double n1, double n2);\n    [OperationContract]\n    double Multiply(double n1, double n2);\n    [OperationContract]\n    double Divide(double n1, double n2);\n}\n```\n\nThe client makes synchronous requests to a given math operation and the service implementation calculates and returns the appropriate result.\n\n```csharp\n// Service class that implements the service contract.\npublic class CalculatorService : ICalculator\n{\n    public double Add(double n1, double n2)\n    {\n        return n1 + n2;\n    }\n    public double Subtract(double n1, double n2)\n    {\n        return n1 - n2;\n    }\n    public double Multiply(double n1, double n2)\n    {\n        return n1 * n2;\n    }\n    public double Divide(double n1, double n2)\n    {\n        return n1 / n2;\n    }\n}\n```\n\nThe sample uses a modified `netNamedPipeBinding` binding with no security. The binding is specified in the configuration files for the client and service. The binding type for the service is specified in the endpoint element’s `binding` attribute as shown in the following sample configuration.\n\nIf you want use a secured named pipe binding, change the server's security mode to the desired security setting and run svcutil.exe again on the client to obtain an updated client configuration file.\n\n```xml\n<system.serviceModel>\n        <services>\n            <service name=\"Microsoft.ServiceModel.Samples.CalculatorService\"\n               behaviorConfiguration=\"CalculatorServiceBehavior\">\n\n        <!-- This endpoint is exposed at the base address provided by host: net.pipe://localhost/servicemodelsamples/service.svc  -->\n        <endpoint address=\"\"\n                  binding=\"netNamedPipeBinding\"\n                  bindingConfiguration=\"Binding1\"\n                  contract=\"Microsoft.ServiceModel.Samples.ICalculator\" />\n        <!-- the mex endpoint is exposed at net.pipe://localhost/servicemodelsamples/service.svc/mex -->\n        <endpoint address=\"mex\"\n                  binding=\"mexNamedPipeBinding\"\n                  contract=\"IMetadataExchange\" />\n      </service>\n        </services>\n        <bindings>\n            <netNamedPipeBinding>\n                <binding name=\"Binding1\" >\n                    <security mode = \"None\">\n                    </security>\n                </binding >\n            </netNamedPipeBinding>\n        </bindings>\n\n    <!--For debugging purposes set the includeExceptionDetailInFaults attribute to true-->\n    <behaviors>\n      <serviceBehaviors>\n        <behavior name=\"CalculatorServiceBehavior\">\n          <serviceMetadata />\n          <serviceDebug includeExceptionDetailInFaults=\"False\" />\n        </behavior>\n      </serviceBehaviors>\n    </behaviors>\n\n  </system.serviceModel>\n```\n\nThe client’s endpoint information is configured as shown in the following sample code.\n\n```xml\n<system.serviceModel>\n\n    <client>\n      <endpoint name=\"\"\n                          address=\"net.pipe://localhost/servicemodelsamples/service.svc\"\n                          binding=\"netNamedPipeBinding\"\n                          bindingConfiguration=\"Binding1\"\n                          contract=\"Microsoft.ServiceModel.Samples.ICalculator\" />\n    </client>\n\n    <bindings>\n\n      <!--  Following is the expanded configuration section for a NetNamedPipeBinding.\n            Each property is configured with the default value. -->\n\n      <netNamedPipeBinding>\n        <binding name=\"Binding1\"\n                         maxBufferSize=\"65536\"\n                         maxConnections=\"10\">\n          <security mode = \"None\">\n          </security>\n        </binding >\n\n      </netNamedPipeBinding>\n    </bindings>\n\n  </system.serviceModel>\n```\n\nWhen you run the sample, the operation requests and responses are displayed in the client console window. Press ENTER in the client window to shut down the client.\n\n```console\nAdd(100,15.99) = 115.99\nSubtract(145,76.54) = 68.46\nMultiply(9,81.25) = 731.25\nDivide(22,7) = 3.14285714285714\n\nPress <ENTER> to terminate client.\n```\n\n### To set up, build, and run the sample\n\n1. Ensure that [!INCLUDE[iisver](../../../../includes/iisver-md.md)] is installed. [!INCLUDE[iisver](../../../../includes/iisver-md.md)] is required for WAS activation.\n\n2. Ensure you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md).\n\n    In addition, you must install the WCF non-HTTP activation components:\n\n    1. From the **Start** menu, choose **Control Panel**.\n\n    2. Select **Programs and Features**.\n\n    3. Click **Turn Windows Components on or Off**.\n\n    4. Expand the **Microsoft .NET Framework 3.0** node and check the **Windows Communication Foundation Non-HTTP Activation** feature.\n\n3. Configure the Windows Process Activation Service (WAS) to support named pipe activation.\n\n    As a convenience, the following two steps are implemented in a batch file called AddNetPipeSiteBinding.cmd located in the sample directory.\n\n    1. To support net.pipe activation, the default Web site must first be bound to the net.pipe protocol. This can be done using appcmd.exe, which is installed with the IIS 7.0 management toolset. From an elevated (administrator) command prompt, run the following command.\n\n        ```\n        %windir%\\system32\\inetsrv\\appcmd.exe set site \"Default Web Site\"\n        -+bindings.[protocol='net.pipe',bindingInformation='*']\n        ```\n\n        > [!NOTE]\n        > This command is a single line of text.\n\n        This command adds a net.pipe site binding to the default Web site.\n\n    2. Although all applications within a site share a common net.pipe binding, each application can enable net.pipe support individually. To enable net.pipe for the /servicemodelsamples application, run the following command from an elevated command prompt.\n\n        ```\n        %windir%\\system32\\inetsrv\\appcmd.exe set app \"Default Web Site/servicemodelsamples\" /enabledProtocols:http,net.pipe\n        ```\n\n        > [!NOTE]\n        > This command is a single line of text.\n\n        This command enables the /servicemodelsamples application to be accessed using both `http://localhost/servicemodelsamples` and `net.tcp://localhost/servicemodelsamples`.\n\n4. To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md).\n\n5. Remove the net.pipe site binding you added for this sample.\n\n    As a convenience, the following two steps are implemented in a batch file called RemoveNetPipeSiteBinding.cmd located in the sample directory:\n\n    1. Remove net.tcp from the list of enabled protocols by running the following command from an elevated command prompt.\n\n        ```\n        %windir%\\system32\\inetsrv\\appcmd.exe set app \"Default Web Site/servicemodelsamples\" /enabledProtocols:http\n        ```\n\n        > [!NOTE]\n        > This command must be entered as a single line of text.\n\n    2. Remove the net.tcp site binding by running the following command from an elevated command prompt.\n\n        ```\n        %windir%\\system32\\inetsrv\\appcmd.exe set site \"Default Web Site\" --bindings.[protocol='net.pipe',bindingInformation='*']\n        ```\n\n        > [!NOTE]\n        > This command must be typed in as a single line of text.\n\n## See also\n\n- [AppFabric Hosting and Persistence Samples](https://docs.microsoft.com/previous-versions/appfabric/ff383418(v=azure.10))\n","nodes":[{"pos":[4,104],"embed":true,"restype":"x-metadata","content":"title: \"NamedPipe Activation\"\nms.date: \"03/30/2017\"\nms.assetid: f3c0437d-006c-442e-bfb0-6b29216e4e29","nodes":[{"content":"NamedPipe Activation","nodes":[{"pos":[0,20],"content":"NamedPipe Activation","nodes":[{"content":"NamedPipe Activation","pos":[0,20]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[112,132],"content":"NamedPipe Activation","linkify":"NamedPipe Activation","nodes":[{"content":"NamedPipe Activation","pos":[0,20]}]},{"content":"This sample demonstrates hosting a service that uses Windows Process Activation Service (WAS) to activate a service that communicates over names pipes.","pos":[134,285]},{"content":"This sample is based on the <bpt id=\"p1\">[</bpt>Getting Started<ept id=\"p1\">](../../../../docs/framework/wcf/samples/getting-started-sample.md)</ept> and requires <ph id=\"ph1\">[!INCLUDE[wv](../../../../includes/wv-md.md)]</ph> to run.","pos":[286,464],"source":" This sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md) and requires [!INCLUDE[wv](../../../../includes/wv-md.md)] to run."},{"pos":[468,575],"content":"[!NOTE]\nThe set-up procedure and build instructions for this sample are located at the end of this topic.","leadings":["","> "],"nodes":[{"content":"The set-up procedure and build instructions for this sample are located at the end of this topic.","pos":[8,105]}]},{"pos":[579,711],"content":"[!IMPORTANT]\nThe samples may already be installed on your computer. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your computer. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your computer.","pos":[0,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[753,1063],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[1064,1114]},{"pos":[1211,1225],"content":"Sample Details","linkify":"Sample Details","nodes":[{"content":"Sample Details","pos":[0,14]}]},{"content":"The sample consists of a client console program (.exe) and a service library (.dll) hosted in a worker process activated by the Windows Process Activation Services (WAS).","pos":[1227,1397]},{"content":"Client activity is visible in the console window.","pos":[1398,1447]},{"content":"The service implements a contract that defines a request-reply communication pattern.","pos":[1449,1534]},{"content":"The contract is defined by the <ph id=\"ph1\">`ICalculator`</ph> interface, which exposes math operations (Add, Subtract, Multiply, and Divide), as shown in the following sample code.","pos":[1535,1698],"source":" The contract is defined by the `ICalculator` interface, which exposes math operations (Add, Subtract, Multiply, and Divide), as shown in the following sample code."},{"content":"The client makes synchronous requests to a given math operation and the service implementation calculates and returns the appropriate result.","pos":[2078,2219]},{"content":"The sample uses a modified <ph id=\"ph1\">`netNamedPipeBinding`</ph> binding with no security.","pos":[2673,2747],"source":"The sample uses a modified `netNamedPipeBinding` binding with no security."},{"content":"The binding is specified in the configuration files for the client and service.","pos":[2748,2827]},{"content":"The binding type for the service is specified in the endpoint element’s <ph id=\"ph1\">`binding`</ph> attribute as shown in the following sample configuration.","pos":[2828,2967],"source":" The binding type for the service is specified in the endpoint element’s `binding` attribute as shown in the following sample configuration."},{"content":"If you want use a secured named pipe binding, change the server's security mode to the desired security setting and run svcutil.exe again on the client to obtain an updated client configuration file.","pos":[2969,3168]},{"content":"The client’s endpoint information is configured as shown in the following sample code.","pos":[4601,4687]},{"content":"When you run the sample, the operation requests and responses are displayed in the client console window.","pos":[5537,5642]},{"content":"Press ENTER in the client window to shut down the client.","pos":[5643,5700]},{"pos":[5869,5905],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"content":"Ensure that <ph id=\"ph1\">[!INCLUDE[iisver](../../../../includes/iisver-md.md)]</ph> is installed.","pos":[5910,5989],"source":"Ensure that [!INCLUDE[iisver](../../../../includes/iisver-md.md)] is installed."},{"content":"<ph id=\"ph1\">[!INCLUDE[iisver](../../../../includes/iisver-md.md)]</ph> is required for WAS activation.","pos":[5990,6075],"source":"[!INCLUDE[iisver](../../../../includes/iisver-md.md)] is required for WAS activation."},{"pos":[6080,6274],"content":"Ensure you have performed the <bpt id=\"p1\">[</bpt>One-Time Setup Procedure for the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)</ept>.","source":"Ensure you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)."},{"content":"In addition, you must install the WCF non-HTTP activation components:","pos":[6280,6349]},{"pos":[6358,6408],"content":"From the <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Control Panel<ept id=\"p2\">**</ept>.","source":"From the **Start** menu, choose **Control Panel**."},{"pos":[6417,6450],"content":"Select <bpt id=\"p1\">**</bpt>Programs and Features<ept id=\"p1\">**</ept>.","source":"Select **Programs and Features**."},{"pos":[6459,6503],"content":"Click <bpt id=\"p1\">**</bpt>Turn Windows Components on or Off<ept id=\"p1\">**</ept>.","source":"Click **Turn Windows Components on or Off**."},{"pos":[6512,6640],"content":"Expand the <bpt id=\"p1\">**</bpt>Microsoft .NET Framework 3.0<ept id=\"p1\">**</ept> node and check the <bpt id=\"p2\">**</bpt>Windows Communication Foundation Non-HTTP Activation<ept id=\"p2\">**</ept> feature.","source":"Expand the **Microsoft .NET Framework 3.0** node and check the **Windows Communication Foundation Non-HTTP Activation** feature."},{"content":"Configure the Windows Process Activation Service (WAS) to support named pipe activation.","pos":[6645,6733]},{"content":"As a convenience, the following two steps are implemented in a batch file called AddNetPipeSiteBinding.cmd located in the sample directory.","pos":[6739,6878]},{"content":"To support net.pipe activation, the default Web site must first be bound to the net.pipe protocol.","pos":[6887,6985]},{"content":"This can be done using appcmd.exe, which is installed with the IIS 7.0 management toolset.","pos":[6986,7076]},{"content":"From an elevated (administrator) command prompt, run the following command.","pos":[7077,7152]},{"pos":[7326,7382],"content":"[!NOTE]\nThis command is a single line of text.","leadings":["","        > "],"nodes":[{"content":"This command is a single line of text.","pos":[8,46]}]},{"content":"This command adds a net.pipe site binding to the default Web site.","pos":[7392,7458]},{"content":"Although all applications within a site share a common net.pipe binding, each application can enable net.pipe support individually.","pos":[7467,7598]},{"content":"To enable net.pipe for the /servicemodelsamples application, run the following command from an elevated command prompt.","pos":[7599,7718]},{"pos":[7879,7935],"content":"[!NOTE]\nThis command is a single line of text.","leadings":["","        > "],"nodes":[{"content":"This command is a single line of text.","pos":[8,46]}]},{"pos":[7945,8114],"content":"This command enables the /servicemodelsamples application to be accessed using both <ph id=\"ph1\">`http://localhost/servicemodelsamples`</ph> and <ph id=\"ph2\">`net.tcp://localhost/servicemodelsamples`</ph>.","source":"This command enables the /servicemodelsamples application to be accessed using both `http://localhost/servicemodelsamples` and `net.tcp://localhost/servicemodelsamples`."},{"pos":[8119,8328],"content":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in <bpt id=\"p1\">[</bpt>Building the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/building-the-samples.md)</ept>.","source":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md)."},{"content":"Remove the net.pipe site binding you added for this sample.","pos":[8333,8392]},{"content":"As a convenience, the following two steps are implemented in a batch file called RemoveNetPipeSiteBinding.cmd located in the sample directory:","pos":[8398,8540]},{"content":"Remove net.tcp from the list of enabled protocols by running the following command from an elevated command prompt.","pos":[8549,8664]},{"pos":[8816,8888],"content":"[!NOTE]\nThis command must be entered as a single line of text.","leadings":["","        > "],"nodes":[{"content":"This command must be entered as a single line of text.","pos":[8,62]}]},{"content":"Remove the net.tcp site binding by running the following command from an elevated command prompt.","pos":[8897,8994]},{"pos":[9160,9233],"content":"[!NOTE]\nThis command must be typed in as a single line of text.","leadings":["","        > "],"nodes":[{"content":"This command must be typed in as a single line of text.","pos":[8,63]}]},{"pos":[9238,9246],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[9250,9370],"content":"<bpt id=\"p1\">[</bpt>AppFabric Hosting and Persistence Samples<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/appfabric/ff383418(v=azure.10))</ept>","source":"[AppFabric Hosting and Persistence Samples](https://docs.microsoft.com/previous-versions/appfabric/ff383418(v=azure.10))"}]}