{"content":"---\ntitle: \"TryCast Operator (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.trycast\"\n  - \"trycast\"\nhelpviewer_keywords: \n  - \"TryCast keyword [Visual Basic]\"\nms.assetid: d1ef5d47-fef4-491e-b014-1d910628f65c\n---\n# TryCast Operator (Visual Basic)\nIntroduces a type conversion operation that does not throw an exception.  \n  \n## Remarks  \n If an attempted conversion fails, `CType` and `DirectCast` both throw an <xref:System.InvalidCastException> error. This can adversely affect the performance of your application. `TryCast` returns [Nothing](../../../visual-basic/language-reference/nothing.md), so that instead of having to handle a possible exception, you need only test the returned result against `Nothing`.  \n  \n You use the `TryCast` keyword the same way you use the [CType Function](../../../visual-basic/language-reference/functions/ctype-function.md) and the [DirectCast Operator](../../../visual-basic/language-reference/operators/directcast-operator.md) keyword. You supply an expression as the first argument and a type to convert it to as the second argument. `TryCast` operates only on reference types, such as classes and interfaces. It requires an inheritance or implementation relationship between the two types. This means that one type must inherit from or implement the other.  \n  \n## Errors and Failures  \n `TryCast` generates a compiler error if it detects that no inheritance or implementation relationship exists. But the lack of a compiler error does not guarantee a successful conversion. If the desired conversion is narrowing, it could fail at run time. If this happens, `TryCast` returns [Nothing](../../../visual-basic/language-reference/nothing.md).  \n  \n## Conversion Keywords  \n A comparison of the type conversion keywords is as follows.  \n  \n|Keyword|Data types|Argument relationship|Run-time failure|  \n|---|---|---|---|  \n|[CType Function](../../../visual-basic/language-reference/functions/ctype-function.md)|Any data types|Widening or narrowing conversion must be defined between the two data types|Throws <xref:System.InvalidCastException>|  \n|[DirectCast Operator](../../../visual-basic/language-reference/operators/directcast-operator.md)|Any data types|One type must inherit from or implement the other type|Throws <xref:System.InvalidCastException>|  \n|`TryCast`|Reference types only|One type must inherit from or implement the other type|Returns [Nothing](../../../visual-basic/language-reference/nothing.md)|  \n  \n## Example  \n The following example shows how to use `TryCast`.  \n  \n [!code-vb[VbVbalrKeywords#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrKeywords/VB/Class1.vb#6)]  \n  \n## See also\n\n- [Widening and Narrowing Conversions](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)\n- [Implicit and Explicit Conversions](../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)\n","nodes":[{"pos":[4,217],"embed":true,"restype":"x-metadata","content":"title: \"TryCast Operator (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.trycast\"\n  - \"trycast\"\nhelpviewer_keywords: \n  - \"TryCast keyword [Visual Basic]\"\nms.assetid: d1ef5d47-fef4-491e-b014-1d910628f65c","nodes":[{"content":"TryCast Operator (Visual Basic)","nodes":[{"pos":[0,31],"content":"TryCast Operator (Visual Basic)","nodes":[{"content":"TryCast Operator (Visual Basic)","pos":[0,31]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[224,255],"content":"TryCast Operator (Visual Basic)","linkify":"TryCast Operator (Visual Basic)","nodes":[{"content":"TryCast Operator (Visual Basic)","pos":[0,31]}]},{"content":"Introduces a type conversion operation that does not throw an exception.","pos":[256,328]},{"pos":[337,344],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If an attempted conversion fails, <ph id=\"ph1\">`CType`</ph> and <ph id=\"ph2\">`DirectCast`</ph> both throw an <ph id=\"ph3\">&lt;xref:System.InvalidCastException&gt;</ph> error.","pos":[348,462],"source":"If an attempted conversion fails, `CType` and `DirectCast` both throw an <xref:System.InvalidCastException> error."},{"content":"This can adversely affect the performance of your application.","pos":[463,525]},{"content":"<ph id=\"ph1\">`TryCast`</ph> returns <bpt id=\"p1\">[</bpt>Nothing<ept id=\"p1\">](../../../visual-basic/language-reference/nothing.md)</ept>, so that instead of having to handle a possible exception, you need only test the returned result against <ph id=\"ph2\">`Nothing`</ph>.","pos":[526,723],"source":"`TryCast` returns [Nothing](../../../visual-basic/language-reference/nothing.md), so that instead of having to handle a possible exception, you need only test the returned result against `Nothing`."},{"content":"You use the <ph id=\"ph1\">`TryCast`</ph> keyword the same way you use the <bpt id=\"p1\">[</bpt>CType Function<ept id=\"p1\">](../../../visual-basic/language-reference/functions/ctype-function.md)</ept> and the <bpt id=\"p2\">[</bpt>DirectCast Operator<ept id=\"p2\">](../../../visual-basic/language-reference/operators/directcast-operator.md)</ept> keyword.","pos":[730,985],"source":"You use the `TryCast` keyword the same way you use the [CType Function](../../../visual-basic/language-reference/functions/ctype-function.md) and the [DirectCast Operator](../../../visual-basic/language-reference/operators/directcast-operator.md) keyword."},{"content":"You supply an expression as the first argument and a type to convert it to as the second argument.","pos":[986,1084]},{"content":"<ph id=\"ph1\">`TryCast`</ph> operates only on reference types, such as classes and interfaces.","pos":[1085,1160],"source":"`TryCast` operates only on reference types, such as classes and interfaces."},{"content":"It requires an inheritance or implementation relationship between the two types.","pos":[1161,1241]},{"content":"This means that one type must inherit from or implement the other.","pos":[1242,1308]},{"pos":[1317,1336],"content":"Errors and Failures","linkify":"Errors and Failures","nodes":[{"content":"Errors and Failures","pos":[0,19]}]},{"content":"<ph id=\"ph1\">`TryCast`</ph> generates a compiler error if it detects that no inheritance or implementation relationship exists.","pos":[1340,1449],"source":"`TryCast` generates a compiler error if it detects that no inheritance or implementation relationship exists."},{"content":"But the lack of a compiler error does not guarantee a successful conversion.","pos":[1450,1526]},{"content":"If the desired conversion is narrowing, it could fail at run time.","pos":[1527,1593]},{"content":"If this happens, <ph id=\"ph1\">`TryCast`</ph> returns <bpt id=\"p1\">[</bpt>Nothing<ept id=\"p1\">](../../../visual-basic/language-reference/nothing.md)</ept>.","pos":[1594,1692],"source":" If this happens, `TryCast` returns [Nothing](../../../visual-basic/language-reference/nothing.md)."},{"pos":[1701,1720],"content":"Conversion Keywords","linkify":"Conversion Keywords","nodes":[{"content":"Conversion Keywords","pos":[0,19]}]},{"content":"A comparison of the type conversion keywords is as follows.","pos":[1724,1783]},{"content":"Keyword","pos":[1790,1797]},{"content":"Data types","pos":[1798,1808]},{"content":"Argument relationship","pos":[1809,1830]},{"content":"Run-time failure","pos":[1831,1847]},{"pos":[1872,1958],"content":"<bpt id=\"p1\">[</bpt>CType Function<ept id=\"p1\">](../../../visual-basic/language-reference/functions/ctype-function.md)</ept>","source":"[CType Function](../../../visual-basic/language-reference/functions/ctype-function.md)"},{"content":"Any data types","pos":[1959,1973]},{"content":"Widening or narrowing conversion must be defined between the two data types","pos":[1974,2049]},{"pos":[2050,2091],"content":"Throws <ph id=\"ph1\">&lt;xref:System.InvalidCastException&gt;</ph>","source":"Throws <xref:System.InvalidCastException>"},{"pos":[2096,2192],"content":"<bpt id=\"p1\">[</bpt>DirectCast Operator<ept id=\"p1\">](../../../visual-basic/language-reference/operators/directcast-operator.md)</ept>","source":"[DirectCast Operator](../../../visual-basic/language-reference/operators/directcast-operator.md)"},{"content":"Any data types","pos":[2193,2207]},{"content":"One type must inherit from or implement the other type","pos":[2208,2262]},{"pos":[2263,2304],"content":"Throws <ph id=\"ph1\">&lt;xref:System.InvalidCastException&gt;</ph>","source":"Throws <xref:System.InvalidCastException>"},{"content":"Reference types only","pos":[2319,2339]},{"content":"One type must inherit from or implement the other type","pos":[2340,2394]},{"pos":[2395,2465],"content":"Returns <bpt id=\"p1\">[</bpt>Nothing<ept id=\"p1\">](../../../visual-basic/language-reference/nothing.md)</ept>","source":"Returns [Nothing](../../../visual-basic/language-reference/nothing.md)"},{"pos":[2475,2482],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2486,2535],"content":"The following example shows how to use <ph id=\"ph1\">`TryCast`</ph>.","source":"The following example shows how to use `TryCast`."},{"pos":[2664,2672],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2676,2820],"content":"<bpt id=\"p1\">[</bpt>Widening and Narrowing Conversions<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)</ept>","source":"[Widening and Narrowing Conversions](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)"},{"pos":[2823,2965],"content":"<bpt id=\"p1\">[</bpt>Implicit and Explicit Conversions<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)</ept>","source":"[Implicit and Explicit Conversions](../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)"}]}