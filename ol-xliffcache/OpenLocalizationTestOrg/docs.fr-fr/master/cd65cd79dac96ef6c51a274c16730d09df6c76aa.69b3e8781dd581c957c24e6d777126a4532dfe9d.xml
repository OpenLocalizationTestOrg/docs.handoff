{"content":"---\ntitle: \"IMetaDataEmit::SetClassLayout Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataEmit.SetClassLayout\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataEmit::SetClassLayout\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IMetaDataEmit::SetClassLayout method [.NET Framework metadata]\"\n  - \"SetClassLayout method [.NET Framework metadata]\"\nms.assetid: 2576c449-388d-4434-a0e1-9f53991e11b6\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 12\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# IMetaDataEmit::SetClassLayout Method\nCompletes the layout of fields for a class that has been defined by a prior call to [DefineTypeDef Method](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definetypedef-method.md).  \n  \n## Syntax  \n  \n```  \nHRESULT SetClassLayout (  \n    [in]  mdTypeDef           td,   \n    [in]  DWORD               dwPackSize,   \n    [in]  COR_FIELD_OFFSET    rFieldOffsets[],   \n    [in]  ULONG               ulClassSize   \n);  \n```  \n  \n#### Parameters  \n `td`  \n [in] An `mdTypeDef` token that specifies the class to be laid out.  \n  \n `dwPackSize`  \n [in] The packing size: 1, 2, 4, 8 or 16 bytes. The packing size is the number of bytes between adjacent fields.  \n  \n `rFieldOffsets`  \n [in] An array of [COR_FIELD_OFFSET](../../../../docs/framework/unmanaged-api/metadata/cor-field-offset-structure.md) structures, each of which specifies a field of the class and the field's offset within the class. Terminate the array with `mdTokenNil`.  \n  \n `ulClassSize`  \n [in] The size, in bytes, of the class.  \n  \n## Remarks  \n The class is initially defined by calling the [IMetaDataEmit::DefineTypeDef](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definetypedef-method.md) method, and specifying one of three layouts for the fields of the class: automatic, sequential, or explicit. Normally, you would use automatic layout and let the runtime choose the best way to lay out the fields.  \n  \n However, you might want the fields laid out according to the arrangement that unmanaged code uses. In this case, choose either sequential or explicit layout and call `SetClassLayout` to complete the layout of the fields:  \n  \n-   Sequential layout: Specify the packing size. A field is aligned according to either its natural size or the packing size, whichever results in the smaller offset of the field. Set `rFieldOffsets` and `ulClassSize` to zero.  \n  \n-   Explicit layout: Either specify the offset of each field or specify the class size and the packing size.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** Cor.h  \n  \n **Library:** Used as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See Also  \n [IMetaDataEmit Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md)   \n [IMetaDataEmit2 Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)","nodes":[{"pos":[4,704],"embed":true,"restype":"x-metadata","content":"title: \"IMetaDataEmit::SetClassLayout Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataEmit.SetClassLayout\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataEmit::SetClassLayout\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IMetaDataEmit::SetClassLayout method [.NET Framework metadata]\"\n  - \"SetClassLayout method [.NET Framework metadata]\"\nms.assetid: 2576c449-388d-4434-a0e1-9f53991e11b6\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 12\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","nodes":[{"content":"IMetaDataEmit::SetClassLayout Method | Microsoft Docs","nodes":[{"pos":[0,53],"content":"IMetaDataEmit::SetClassLayout Method | Microsoft Docs","nodes":[{"content":"IMetaDataEmit::SetClassLayout Method | Microsoft Docs","pos":[0,53]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[711,747],"content":"IMetaDataEmit::SetClassLayout Method","linkify":"IMetaDataEmit::SetClassLayout Method","nodes":[{"content":"IMetaDataEmit::SetClassLayout Method","pos":[0,36]}]},{"pos":[748,944],"content":"Completes the layout of fields for a class that has been defined by a prior call to <bpt id=\"p1\">[</bpt>DefineTypeDef Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definetypedef-method.md)</ept>.","source":"Completes the layout of fields for a class that has been defined by a prior call to [DefineTypeDef Method](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definetypedef-method.md)."},{"pos":[953,959],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1194,1204],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] An <ph id=\"ph1\">`mdTypeDef`</ph> token that specifies the class to be laid out.","pos":[1216,1282],"source":"[in] An `mdTypeDef` token that specifies the class to be laid out."},{"content":"[in] The packing size: 1, 2, 4, 8 or 16 bytes.","pos":[1305,1351]},{"content":"The packing size is the number of bytes between adjacent fields.","pos":[1352,1416]},{"content":"[in] An array of <bpt id=\"p1\">[</bpt>COR_FIELD_OFFSET<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/cor-field-offset-structure.md)</ept> structures, each of which specifies a field of the class and the field's offset within the class.","pos":[1442,1656],"source":"[in] An array of [COR_FIELD_OFFSET](../../../../docs/framework/unmanaged-api/metadata/cor-field-offset-structure.md) structures, each of which specifies a field of the class and the field's offset within the class."},{"content":"Terminate the array with <ph id=\"ph1\">`mdTokenNil`</ph>.","pos":[1657,1695],"source":" Terminate the array with `mdTokenNil`."},{"content":"[in] The size, in bytes, of the class.","pos":[1719,1757]},{"pos":[1766,1773],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The class is initially defined by calling the <bpt id=\"p1\">[</bpt>IMetaDataEmit::DefineTypeDef<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definetypedef-method.md)</ept> method, and specifying one of three layouts for the fields of the class: automatic, sequential, or explicit.","pos":[1777,2051],"source":"The class is initially defined by calling the [IMetaDataEmit::DefineTypeDef](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definetypedef-method.md) method, and specifying one of three layouts for the fields of the class: automatic, sequential, or explicit."},{"content":"Normally, you would use automatic layout and let the runtime choose the best way to lay out the fields.","pos":[2052,2155]},{"content":"However, you might want the fields laid out according to the arrangement that unmanaged code uses.","pos":[2162,2260]},{"content":"In this case, choose either sequential or explicit layout and call <ph id=\"ph1\">`SetClassLayout`</ph> to complete the layout of the fields:","pos":[2261,2382],"source":" In this case, choose either sequential or explicit layout and call `SetClassLayout` to complete the layout of the fields:"},{"content":"Sequential layout: Specify the packing size.","pos":[2392,2436]},{"content":"A field is aligned according to either its natural size or the packing size, whichever results in the smaller offset of the field.","pos":[2437,2567]},{"content":"Set <ph id=\"ph1\">`rFieldOffsets`</ph> and <ph id=\"ph2\">`ulClassSize`</ph> to zero.","pos":[2568,2614],"source":" Set `rFieldOffsets` and `ulClassSize` to zero."},{"content":"Explicit layout: Either specify the offset of each field or specify the class size and the packing size.","pos":[2624,2728]},{"pos":[2737,2749],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2753,2857],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2864,2881],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> Cor.h","source":"**Header:** Cor.h"},{"pos":[2888,2934],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Used as a resource in MSCorEE.dll","source":"**Library:** Used as a resource in MSCorEE.dll"},{"pos":[2941,2969],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept>","source":"**.NET Framework Versions:**"},{"pos":[3058,3066],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>IMetaDataEmit Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[3070,3174],"source":"[IMetaDataEmit Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>IMetaDataEmit2 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)</ept>","pos":[3178,3283],"source":"[IMetaDataEmit2 Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)"}]}