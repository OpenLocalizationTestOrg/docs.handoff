{"content":"---\ntitle: \"Security Considerations with Metadata | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: e78ef8ab-4f63-4656-ab93-b1deab2666d5\ncaps.latest.revision: 10\nauthor: \"BrucePerlerMS\"\nms.author: \"bruceper\"\nmanager: \"mbaldwin\"\n---\n# Security Considerations with Metadata\nWhen using the metadata features in [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)], consider the security implications of publishing, retrieving, and using service metadata.  \n  \n## When to Publish Metadata  \n [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services do not publish metadata by default. To publish metadata for a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service you must explicitly enable metadata publishing by adding metadata endpoints to your service (see [Publishing Metadata](../../../../docs/framework/wcf/feature-details/publishing-metadata.md)). Leaving metadata publishing disabled reduces the attack surface for your service and lowers the risk of unintentional information disclosure. Not all services must publish metadata. If you do not have to publish metadata, consider leaving it turned off. Note that you can still generate metadata and client code directly from your service assemblies using the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md). [!INCLUDE[crabout](../../../../includes/crabout-md.md)] using Svcutil.exe to export metadata, see [How to: Use Svcutil.exe to Export Metadata from Compiled Service Code](../../../../docs/framework/wcf/feature-details/how-to-use-svcutil-exe-to-export-metadata-from-compiled-service-code.md).  \n  \n## Publishing Metadata Using a Secure Binding  \n The default metadata bindings that [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] provides are not secure and they allow anonymous access to the metadata. The service metadata that a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service publishes contains a detailed description about the service and may intentionally or unintentionally contain sensitive information. For example, service metadata may contain information about infrastructure operations that was not intended to be broadcast publicly. To protect service metadata from unauthorized access, you can use a secure binding for your metadata endpoint. Metadata endpoints respond to HTTP/GET requests that can use Secure Sockets Layer (SSL) to secure the metadata. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][How to: Secure Metadata Endpoints](../../../../docs/framework/wcf/feature-details/how-to-secure-metadata-endpoints.md).  \n  \n Securing your metadata endpoints also provides a way for requesters to securely retrieve service metadata without the risk of tampering or spoofing.  \n  \n## Using Only Trusted Metadata  \n You can use service metadata to automatically construct the run-time components required to call the service. You can also use metadata at design time to develop a client application or at runtime to dynamically update the binding a client uses to call a service.  \n  \n Service metadata can be tampered with or spoofed when retrieved in an insecure manner. Tampered metadata can redirect your client to a malicious service, contain compromised security settings, or contain malicious XML structures. Metadata documents can be large and are frequently saved to the file system. To protect against tampering and spoofing, use a secure binding to request service metadata when one is available.  \n  \n## Using Safe Techniques for Processing Metadata  \n Service metadata is frequently retrieved from a service over a network using standardized protocols such as WS-MetadataExchange (MEX). Many metadata formats include referencing mechanisms for pointing to additional metadata. The <xref:System.ServiceModel.Description.MetadataExchangeClient> type automatically processes references for you in Web Services Description Language (WSDL) documents, XML Schema, and MEX documents. The size of the <xref:System.ServiceModel.Description.MetadataSet> object created from the retrieved metadata is directly proportional to the <xref:System.ServiceModel.Description.MetadataExchangeClient.MaximumResolvedReferences%2A> value for the <xref:System.ServiceModel.Description.MetadataExchangeClient> instance that is used and the `MaxReceivedMessageSize` value for the binding being used by that <xref:System.ServiceModel.Description.MetadataExchangeClient> instance. Set these quotas to appropriate values as dictated by your scenario.  \n  \n In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], service metadata is processed as XML. When processing XML documents, applications should protect themselves against malicious XML structures. Use the `XmlDictionaryReader` with appropriate quotas when processing XML and also set the <xref:System.Xml.XmlTextReader.DtdProcessing%2A> property to `Prohibit`.  \n  \n The metadata system in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is extensible and metadata extensions can be registered in your application configuration file (see [Extending the Metadata System](../../../../docs/framework/wcf/extending/extending-the-metadata-system.md)). Metadata extensions can run arbitrary code, so you should protect your application configuration file with appropriate access control lists (ACLs) and register only trusted metadata extension implementations.  \n  \n## Validating Generated Clients  \n When generating client code from metadata retrieved from a source that is not trusted, validate the generated client code to ensure that the generated client conforms to your client applications security policies. You can use a validating behavior to check settings on your client binding or visually inspect code generated by tools. For an example of how to implement a client that validates behaviors, see [Client Validation](../../../../docs/framework/wcf/samples/client-validation.md).  \n  \n## Protecting Application Configuration Files  \n A service's application configuration file may control how and if metadata is published. It is a good idea to protect the application configuration file with appropriate access control lists (ACLs) to ensure an attacker cannot modify such settings.  \n  \n## See Also  \n [How to: Secure Metadata Endpoints](../../../../docs/framework/wcf/feature-details/how-to-secure-metadata-endpoints.md)   \n [Security](../../../../docs/framework/wcf/feature-details/security.md)","nodes":[{"pos":[4,369],"embed":true,"restype":"x-metadata","content":"title: \"Security Considerations with Metadata | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: e78ef8ab-4f63-4656-ab93-b1deab2666d5\ncaps.latest.revision: 10\nauthor: \"BrucePerlerMS\"\nms.author: \"bruceper\"\nmanager: \"mbaldwin\"","nodes":[{"content":"Security Considerations with Metadata | Microsoft Docs","nodes":[{"pos":[0,54],"content":"Security Considerations with Metadata | Microsoft Docs","nodes":[{"content":"Security Considerations with Metadata | Microsoft Docs","pos":[0,54]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[376,413],"content":"Security Considerations with Metadata","linkify":"Security Considerations with Metadata","nodes":[{"content":"Security Considerations with Metadata","pos":[0,37]}]},{"pos":[414,596],"content":"When using the metadata features in <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph>, consider the security implications of publishing, retrieving, and using service metadata.","source":"When using the metadata features in [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)], consider the security implications of publishing, retrieving, and using service metadata."},{"pos":[605,629],"content":"When to Publish Metadata","linkify":"When to Publish Metadata","nodes":[{"content":"When to Publish Metadata","pos":[0,24]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> services do not publish metadata by default.","pos":[633,733],"source":"[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services do not publish metadata by default."},{"content":"To publish metadata for a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> service you must explicitly enable metadata publishing by adding metadata endpoints to your service (see <bpt id=\"p1\">[</bpt>Publishing Metadata<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/publishing-metadata.md)</ept>).","pos":[734,1015],"source":" To publish metadata for a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service you must explicitly enable metadata publishing by adding metadata endpoints to your service (see [Publishing Metadata](../../../../docs/framework/wcf/feature-details/publishing-metadata.md))."},{"content":"Leaving metadata publishing disabled reduces the attack surface for your service and lowers the risk of unintentional information disclosure.","pos":[1016,1157]},{"content":"Not all services must publish metadata.","pos":[1158,1197]},{"content":"If you do not have to publish metadata, consider leaving it turned off.","pos":[1198,1269]},{"content":"Note that you can still generate metadata and client code directly from your service assemblies using the <bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept>.","pos":[1270,1509],"source":" Note that you can still generate metadata and client code directly from your service assemblies using the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)."},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> using Svcutil.exe to export metadata, see <bpt id=\"p1\">[</bpt>How to: Use Svcutil.exe to Export Metadata from Compiled Service Code<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-use-svcutil-exe-to-export-metadata-from-compiled-service-code.md)</ept>.","pos":[1510,1800],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] using Svcutil.exe to export metadata, see [How to: Use Svcutil.exe to Export Metadata from Compiled Service Code](../../../../docs/framework/wcf/feature-details/how-to-use-svcutil-exe-to-export-metadata-from-compiled-service-code.md)."},{"pos":[1809,1851],"content":"Publishing Metadata Using a Secure Binding","linkify":"Publishing Metadata Using a Secure Binding","nodes":[{"content":"Publishing Metadata Using a Secure Binding","pos":[0,42]}]},{"content":"The default metadata bindings that <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> provides are not secure and they allow anonymous access to the metadata.","pos":[1855,2018],"source":"The default metadata bindings that [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] provides are not secure and they allow anonymous access to the metadata."},{"content":"The service metadata that a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> service publishes contains a detailed description about the service and may intentionally or unintentionally contain sensitive information.","pos":[2019,2242],"source":" The service metadata that a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service publishes contains a detailed description about the service and may intentionally or unintentionally contain sensitive information."},{"content":"For example, service metadata may contain information about infrastructure operations that was not intended to be broadcast publicly.","pos":[2243,2376]},{"content":"To protect service metadata from unauthorized access, you can use a secure binding for your metadata endpoint.","pos":[2377,2487]},{"content":"Metadata endpoints respond to HTTP/GET requests that can use Secure Sockets Layer (SSL) to secure the metadata.","pos":[2488,2599]},{"content":"<ph id=\"ph1\">[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]</ph><bpt id=\"p1\">[</bpt>How to: Secure Metadata Endpoints<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-secure-metadata-endpoints.md)</ept>.","pos":[2600,2779],"source":"[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][How to: Secure Metadata Endpoints](../../../../docs/framework/wcf/feature-details/how-to-secure-metadata-endpoints.md)."},{"content":"Securing your metadata endpoints also provides a way for requesters to securely retrieve service metadata without the risk of tampering or spoofing.","pos":[2786,2934]},{"pos":[2943,2970],"content":"Using Only Trusted Metadata","linkify":"Using Only Trusted Metadata","nodes":[{"content":"Using Only Trusted Metadata","pos":[0,27]}]},{"content":"You can use service metadata to automatically construct the run-time components required to call the service.","pos":[2974,3083]},{"content":"You can also use metadata at design time to develop a client application or at runtime to dynamically update the binding a client uses to call a service.","pos":[3084,3237]},{"content":"Service metadata can be tampered with or spoofed when retrieved in an insecure manner.","pos":[3244,3330]},{"content":"Tampered metadata can redirect your client to a malicious service, contain compromised security settings, or contain malicious XML structures.","pos":[3331,3473]},{"content":"Metadata documents can be large and are frequently saved to the file system.","pos":[3474,3550]},{"content":"To protect against tampering and spoofing, use a secure binding to request service metadata when one is available.","pos":[3551,3665]},{"pos":[3674,3719],"content":"Using Safe Techniques for Processing Metadata","linkify":"Using Safe Techniques for Processing Metadata","nodes":[{"content":"Using Safe Techniques for Processing Metadata","pos":[0,45]}]},{"content":"Service metadata is frequently retrieved from a service over a network using standardized protocols such as WS-MetadataExchange (MEX).","pos":[3723,3857]},{"content":"Many metadata formats include referencing mechanisms for pointing to additional metadata.","pos":[3858,3947]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.MetadataExchangeClient&gt;</ph> type automatically processes references for you in Web Services Description Language (WSDL) documents, XML Schema, and MEX documents.","pos":[3948,4147],"source":" The <xref:System.ServiceModel.Description.MetadataExchangeClient> type automatically processes references for you in Web Services Description Language (WSDL) documents, XML Schema, and MEX documents."},{"content":"The size of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.MetadataSet&gt;</ph> object created from the retrieved metadata is directly proportional to the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.MetadataExchangeClient.MaximumResolvedReferences%2A&gt;</ph> value for the <ph id=\"ph3\">&lt;xref:System.ServiceModel.Description.MetadataExchangeClient&gt;</ph> instance that is used and the <ph id=\"ph4\">`MaxReceivedMessageSize`</ph> value for the binding being used by that <ph id=\"ph5\">&lt;xref:System.ServiceModel.Description.MetadataExchangeClient&gt;</ph> instance.","pos":[4148,4624],"source":" The size of the <xref:System.ServiceModel.Description.MetadataSet> object created from the retrieved metadata is directly proportional to the <xref:System.ServiceModel.Description.MetadataExchangeClient.MaximumResolvedReferences%2A> value for the <xref:System.ServiceModel.Description.MetadataExchangeClient> instance that is used and the `MaxReceivedMessageSize` value for the binding being used by that <xref:System.ServiceModel.Description.MetadataExchangeClient> instance."},{"content":"Set these quotas to appropriate values as dictated by your scenario.","pos":[4625,4693]},{"content":"In <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph>, service metadata is processed as XML.","pos":[4700,4797],"source":"In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], service metadata is processed as XML."},{"content":"When processing XML documents, applications should protect themselves against malicious XML structures.","pos":[4798,4901]},{"content":"Use the <ph id=\"ph1\">`XmlDictionaryReader`</ph> with appropriate quotas when processing XML and also set the <ph id=\"ph2\">&lt;xref:System.Xml.XmlTextReader.DtdProcessing%2A&gt;</ph> property to <ph id=\"ph3\">`Prohibit`</ph>.","pos":[4902,5065],"source":" Use the `XmlDictionaryReader` with appropriate quotas when processing XML and also set the <xref:System.Xml.XmlTextReader.DtdProcessing%2A> property to `Prohibit`."},{"content":"The metadata system in <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> is extensible and metadata extensions can be registered in your application configuration file (see <bpt id=\"p1\">[</bpt>Extending the Metadata System<ept id=\"p1\">](../../../../docs/framework/wcf/extending/extending-the-metadata-system.md)</ept>).","pos":[5072,5359],"source":"The metadata system in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is extensible and metadata extensions can be registered in your application configuration file (see [Extending the Metadata System](../../../../docs/framework/wcf/extending/extending-the-metadata-system.md))."},{"content":"Metadata extensions can run arbitrary code, so you should protect your application configuration file with appropriate access control lists (ACLs) and register only trusted metadata extension implementations.","pos":[5360,5568]},{"pos":[5577,5605],"content":"Validating Generated Clients","linkify":"Validating Generated Clients","nodes":[{"content":"Validating Generated Clients","pos":[0,28]}]},{"content":"When generating client code from metadata retrieved from a source that is not trusted, validate the generated client code to ensure that the generated client conforms to your client applications security policies.","pos":[5609,5822]},{"content":"You can use a validating behavior to check settings on your client binding or visually inspect code generated by tools.","pos":[5823,5942]},{"content":"For an example of how to implement a client that validates behaviors, see <bpt id=\"p1\">[</bpt>Client Validation<ept id=\"p1\">](../../../../docs/framework/wcf/samples/client-validation.md)</ept>.","pos":[5943,6098],"source":" For an example of how to implement a client that validates behaviors, see [Client Validation](../../../../docs/framework/wcf/samples/client-validation.md)."},{"pos":[6107,6149],"content":"Protecting Application Configuration Files","linkify":"Protecting Application Configuration Files","nodes":[{"content":"Protecting Application Configuration Files","pos":[0,42]}]},{"content":"A service's application configuration file may control how and if metadata is published.","pos":[6153,6241]},{"content":"It is a good idea to protect the application configuration file with appropriate access control lists (ACLs) to ensure an attacker cannot modify such settings.","pos":[6242,6401]},{"pos":[6410,6418],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>How to: Secure Metadata Endpoints<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-secure-metadata-endpoints.md)</ept><ph id=\"ph1\"> </ph>","pos":[6422,6542],"source":"[How to: Secure Metadata Endpoints](../../../../docs/framework/wcf/feature-details/how-to-secure-metadata-endpoints.md) "},{"content":"<bpt id=\"p1\">[</bpt>Security<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/security.md)</ept>","pos":[6546,6616],"source":"[Security](../../../../docs/framework/wcf/feature-details/security.md)"}]}