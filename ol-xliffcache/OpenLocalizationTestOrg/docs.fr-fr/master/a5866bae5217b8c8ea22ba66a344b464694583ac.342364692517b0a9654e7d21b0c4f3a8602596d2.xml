{"content":"---\ntitle: \"How to: Run a Workflow\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nms.assetid: f814ff82-fe2b-4614-aebb-b768c3e61179\n---\n# How to: Run a Workflow\nThis topic is a continuation of the Windows Workflow Foundation Getting Started tutorial and discusses how to create a workflow host and run the workflow defined in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) topic.\n\n> [!NOTE]\n>  Each topic in the Getting Started tutorial depends on the previous topics. To complete this topic you must first complete [How to: Create an Activity](how-to-create-an-activity.md) and [How to: Create a Workflow](how-to-create-a-workflow.md).\n\n> [!NOTE]\n>  To download a completed version of the tutorial, see [Windows Workflow Foundation (WF45) - Getting Started Tutorial](https://go.microsoft.com/fwlink/?LinkID=248976).  \n  \n### To create the workflow host project  \n  \n1.  Open the solution from the previous [How to: Create an Activity](how-to-create-an-activity.md) topic by using Visual Studio 2012.  \n  \n2.  Right-click the **WF45GettingStartedTutorial** solution in **Solution Explorer** and select **Add**, **New Project**.  \n  \n    > [!TIP]\n    >  If the **Solution Explorer** window is not displayed, select **Solution Explorer** from the **View** menu.\n\n3.  In the **Installed** node, select **Visual C#**, **Workflow** (or **Visual Basic**, **Workflow**).\n\n    > [!NOTE]\n    >  Depending on which programming language is configured as the primary language in Visual Studio, the **Visual C#** or **Visual Basic** node may be under the **Other Languages** node in the **Installed** node.\n\n     Ensure that **.NET Framework 4.5** is selected in the .NET Framework version drop-down list. Select **Workflow Console Application** from the **Workflow** list. Type `NumberGuessWorkflowHost` into the **Name** box and click **OK**. This creates a starter workflow application with basic workflow hosting support. This basic hosting code is modified and used to run the workflow application.\n\n4.  Right-click the newly added **NumberGuessWorkflowHost** project in **Solution Explorer** and select **Add Reference**. Select **Solution** from the **Add Reference** list, check the checkbox beside **NumberGuessWorkflowActivities**, and then click **OK**.\n\n5.  Right-click **Workflow1.xaml** in **Solution Explorer** and choose **Delete**. Click **OK** to confirm.\n\n### To modify the workflow hosting code\n\n1.  Double-click **Program.cs** or **Module1.vb** in **Solution Explorer** to display the code.\n\n    > [!TIP]\n    >  If the **Solution Explorer** window is not displayed, select **Solution Explorer** from the **View** menu.\n\n     Because this project was created by using the **Workflow Console Application** template, **Program.cs** or **Module1.vb** contains the following basic workflow hosting code.\n\n    ```vb\n    ' Create and cache the workflow definition\n    Activity workflow1 = new Workflow1()\n    WorkflowInvoker.Invoke(workflow1)\n    ```\n\n    ```csharp\n    // Create and cache the workflow definition\n    Activity workflow1 = new Workflow1();\n    WorkflowInvoker.Invoke(workflow1);\n    ```\n\n     This generated hosting code uses <xref:System.Activities.WorkflowInvoker>. <xref:System.Activities.WorkflowInvoker> provides a simple way for invoking a workflow as if it were a method call and can be used only for workflows that do not use persistence. <xref:System.Activities.WorkflowApplication> provides a richer model for executing workflows that includes notification of life-cycle events, execution control, bookmark resumption, and persistence. This example uses bookmarks and <xref:System.Activities.WorkflowApplication> is used for hosting the workflow. Add the following `using` or **Imports** statement at the top of **Program.cs** or **Module1.vb** below the existing **using** or **Imports** statements.\n\n    ```vb\n    Imports NumberGuessWorkflowActivities\n    Imports System.Threading\n    ```\n\n    ```csharp\n    using NumberGuessWorkflowActivities;\n    using System.Threading;\n    ```\n\n     Replace the lines of code that use <xref:System.Activities.WorkflowInvoker> with the following basic <xref:System.Activities.WorkflowApplication> hosting code. This sample hosting code demonstrates the basic steps for hosting and invoking a workflow, but does not yet contain the functionality to successfully run the workflow from this topic. In the following steps, this basic code is modified and additional features are added until the application is complete.\n\n    > [!NOTE]\n    >  Please replace `Workflow1` in these examples with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow you completed in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) step. If you do not replace `Workflow1` then you will get build errors when you try and build or run the workflow.\n\n     [!code-csharp[CFX_WF_GettingStarted#4](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/extrasnippets.cs#4)]\n     [!code-vb[CFX_WF_GettingStarted#4](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/extrasnippets.vb#4)]\n\n     This code creates a <xref:System.Activities.WorkflowApplication>, subscribes to three workflow life-cycle events, starts the workflow with a call to <xref:System.Activities.WorkflowApplication.Run%2A>, and then waits for the workflow to complete. When the workflow completes, the <xref:System.Threading.AutoResetEvent> is set and the host application completes.\n\n### To set input arguments of a workflow\n\n1.  Add the following statement at the top of **Program.cs** or **Module1.vb** below the existing `using` or `Imports` statements.\n\n     [!code-csharp[CFX_WF_GettingStarted#5](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#5)]\n     [!code-vb[CFX_WF_GettingStarted#5](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#5)]\n\n2.  Replace the line of code that creates the new <xref:System.Activities.WorkflowApplication> with the following code that creates and passes a dictionary of parameters to the workflow when it is created.\n\n    > [!NOTE]\n    >  Please replace `Workflow1` in these examples with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow you completed in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) step. If you do not replace `Workflow1` then you will get build errors when you try and build or run the workflow.\n\n     [!code-csharp[CFX_WF_GettingStarted#6](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#6)]\n     [!code-vb[CFX_WF_GettingStarted#6](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#6)]\n\n     This dictionary contains one element with a key of `MaxNumber`. Keys in the input dictionary correspond to input arguments on the root activity of the workflow. `MaxNumber` is used by the workflow to determine the upper bound for the randomly generated number.\n\n### To retrieve output arguments of a workflow\n\n1.  Modify the <xref:System.Activities.WorkflowApplication.Completed%2A> handler to retrieve and display the number of turns used by the workflow.\n\n     [!code-csharp[CFX_WF_GettingStarted#7](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#7)]\n     [!code-vb[CFX_WF_GettingStarted#7](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#7)]\n\n### To resume a bookmark\n\n1.  Add the following code at the top of the `Main` method just after the existing <xref:System.Threading.AutoResetEvent> declaration.\n\n     [!code-csharp[CFX_WF_GettingStarted#8](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#8)]\n     [!code-vb[CFX_WF_GettingStarted#8](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#8)]\n\n2.  Add the following <xref:System.Activities.WorkflowApplication.Idle%2A> handler just below the existing three workflow life-cycle handlers in `Main`.\n\n     [!code-csharp[CFX_WF_GettingStarted#9](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#9)]\n     [!code-vb[CFX_WF_GettingStarted#9](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#9)]\n\n     Each time the workflow becomes idle waiting for the next guess, this handler is called and the `idleAction` <xref:System.Threading.AutoResetEvent> is set. The code in the following step uses `idleEvent` and `syncEvent` to determine whether the workflow is waiting for the next guess or is complete.\n\n    > [!NOTE]\n    >  In this example, the host application uses auto-reset events in the <xref:System.Activities.WorkflowApplication.Completed%2A> and <xref:System.Activities.WorkflowApplication.Idle%2A> handlers to synchronize the host application with the progress of the workflow. It is not necessary to block and wait for the workflow to become idle before resuming a bookmark, but in this example the synchronization events are required so the host knows whether the workflow is complete or whether it is waiting on more user input by using the <xref:System.Activities.Bookmark>. For more information, see [Bookmarks](bookmarks.md).\n\n3.  Remove the call to `WaitOne`, and replace it with code to gather input from the user and resume the <xref:System.Activities.Bookmark>.\n\n     Remove the following line of code.\n\n     [!code-csharp[CFX_WF_GettingStarted#10](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/extrasnippets.cs#10)]\n     [!code-vb[CFX_WF_GettingStarted#10](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/extrasnippets.vb#10)]\n\n     Replace it with the following example.\n\n     [!code-csharp[CFX_WF_GettingStarted#11](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#11)]\n     [!code-vb[CFX_WF_GettingStarted#11](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#11)]\n\n## <a name=\"BKMK_ToRunTheApplication\"></a> To build and run the application\n\n1.  Right-click **NumberGuessWorkflowHost** in **Solution Explorer** and select **Set as StartUp Project**.\n\n2.  Press CTRL+F5 to build and run the application. Try to guess the number in as few turns as possible.\n\n     To try the application with one of the other styles of workflow, replace `Workflow1` in the code that creates the <xref:System.Activities.WorkflowApplication> with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow style you desire.\n\n     [!code-csharp[CFX_WF_GettingStarted#6](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#6)]\n     [!code-vb[CFX_WF_GettingStarted#6](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#6)]\n\n     For instructions about how to add persistence to a workflow application, see the next topic, [How to: Create and Run a Long Running Workflow](how-to-create-and-run-a-long-running-workflow.md).\n\n## Example\n The following example is the complete code listing for the `Main` method.\n\n> [!NOTE]\n>  Please replace `Workflow1` in these examples with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow you completed in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) step. If you do not replace `Workflow1` then you will get build errors when you try and build or run the workflow.\n\n [!code-csharp[CFX_WF_GettingStarted#12](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#12)]\n [!code-vb[CFX_WF_GettingStarted#12](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#12)]\n\n## See also\n\n- <xref:System.Activities.WorkflowApplication>\n- <xref:System.Activities.Bookmark>\n- [Windows Workflow Foundation Programming](programming.md)\n- [Getting Started Tutorial](getting-started-tutorial.md)\n- [How to: Create a Workflow](how-to-create-a-workflow.md)\n- [How to: Create and Run a Long Running Workflow](how-to-create-and-run-a-long-running-workflow.md)\n- [Waiting for Input in a Workflow](waiting-for-input-in-a-workflow.md)\n- [Hosting Workflows](hosting-workflows.md)","nodes":[{"pos":[4,139],"embed":true,"restype":"x-metadata","content":"title: \"How to: Run a Workflow\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nms.assetid: f814ff82-fe2b-4614-aebb-b768c3e61179","nodes":[{"content":"How to: Run a Workflow","nodes":[{"pos":[0,22],"content":"How to: Run a Workflow","nodes":[{"content":"How to: Run a Workflow","pos":[0,22]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[146,168],"content":"How to: Run a Workflow","linkify":"How to: Run a Workflow","nodes":[{"content":"How to: Run a Workflow","pos":[0,22]}]},{"pos":[169,410],"content":"This topic is a continuation of the Windows Workflow Foundation Getting Started tutorial and discusses how to create a workflow host and run the workflow defined in the previous <bpt id=\"p1\">[</bpt>How to: Create a Workflow<ept id=\"p1\">](how-to-create-a-workflow.md)</ept> topic.","source":"This topic is a continuation of the Windows Workflow Foundation Getting Started tutorial and discusses how to create a workflow host and run the workflow defined in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) topic."},{"pos":[414,667],"content":"[!NOTE]\n Each topic in the Getting Started tutorial depends on the previous topics. To complete this topic you must first complete [How to: Create an Activity](how-to-create-an-activity.md) and [How to: Create a Workflow](how-to-create-a-workflow.md).","leadings":["","> "],"nodes":[{"content":"Each topic in the Getting Started tutorial depends on the previous topics. To complete this topic you must first complete [How to: Create an Activity](how-to-create-an-activity.md) and [How to: Create a Workflow](how-to-create-a-workflow.md).","pos":[9,251],"nodes":[{"content":"Each topic in the Getting Started tutorial depends on the previous topics.","pos":[0,74]},{"content":"To complete this topic you must first complete <bpt id=\"p1\">[</bpt>How to: Create an Activity<ept id=\"p1\">](how-to-create-an-activity.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Create a Workflow<ept id=\"p2\">](how-to-create-a-workflow.md)</ept>.","pos":[75,242],"source":" To complete this topic you must first complete [How to: Create an Activity](how-to-create-an-activity.md) and [How to: Create a Workflow](how-to-create-a-workflow.md)."}]}]},{"pos":[671,847],"content":"[!NOTE]\n To download a completed version of the tutorial, see [Windows Workflow Foundation (WF45) - Getting Started Tutorial](https://go.microsoft.com/fwlink/?LinkID=248976).","leadings":["","> "],"nodes":[{"content":"To download a completed version of the tutorial, see <bpt id=\"p1\">[</bpt>Windows Workflow Foundation (WF45) - Getting Started Tutorial<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=248976)</ept>.","pos":[9,174],"source":"To download a completed version of the tutorial, see [Windows Workflow Foundation (WF45) - Getting Started Tutorial](https://go.microsoft.com/fwlink/?LinkID=248976)."}]},{"pos":[857,892],"content":"To create the workflow host project","linkify":"To create the workflow host project","nodes":[{"content":"To create the workflow host project","pos":[0,35]}]},{"pos":[902,1031],"content":"Open the solution from the previous <bpt id=\"p1\">[</bpt>How to: Create an Activity<ept id=\"p1\">](how-to-create-an-activity.md)</ept> topic by using Visual Studio 2012.","source":"Open the solution from the previous [How to: Create an Activity](how-to-create-an-activity.md) topic by using Visual Studio 2012."},{"pos":[1041,1158],"content":"Right-click the <bpt id=\"p1\">**</bpt>WF45GettingStartedTutorial<ept id=\"p1\">**</ept> solution in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>New Project<ept id=\"p4\">**</ept>.","source":"Right-click the **WF45GettingStartedTutorial** solution in **Solution Explorer** and select **Add**, **New Project**."},{"pos":[1170,1290],"content":"[!TIP]\nIf the **Solution Explorer** window is not displayed, select **Solution Explorer** from the **View** menu.","leadings":["","    >  "],"nodes":[{"content":"If the <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> window is not displayed, select <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>View<ept id=\"p3\">**</ept> menu.","pos":[7,113],"source":"If the **Solution Explorer** window is not displayed, select **Solution Explorer** from the **View** menu."}]},{"pos":[1296,1394],"content":"In the <bpt id=\"p1\">**</bpt>Installed<ept id=\"p1\">**</ept> node, select <bpt id=\"p2\">**</bpt>Visual C#<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Workflow<ept id=\"p3\">**</ept> (or <bpt id=\"p4\">**</bpt>Visual Basic<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>Workflow<ept id=\"p5\">**</ept>).","source":"In the **Installed** node, select **Visual C#**, **Workflow** (or **Visual Basic**, **Workflow**)."},{"pos":[1402,1624],"content":"[!NOTE]\nDepending on which programming language is configured as the primary language in Visual Studio, the **Visual C#** or **Visual Basic** node may be under the **Other Languages** node in the **Installed** node.","leadings":["","    >  "],"nodes":[{"content":"Depending on which programming language is configured as the primary language in Visual Studio, the <bpt id=\"p1\">**</bpt>Visual C#<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Visual Basic<ept id=\"p2\">**</ept> node may be under the <bpt id=\"p3\">**</bpt>Other Languages<ept id=\"p3\">**</ept> node in the <bpt id=\"p4\">**</bpt>Installed<ept id=\"p4\">**</ept> node.","pos":[8,215],"source":"Depending on which programming language is configured as the primary language in Visual Studio, the **Visual C#** or **Visual Basic** node may be under the **Other Languages** node in the **Installed** node."}]},{"content":"Ensure that <bpt id=\"p1\">**</bpt>.NET Framework 4.5<ept id=\"p1\">**</ept> is selected in the .NET Framework version drop-down list.","pos":[1631,1723],"source":"Ensure that **.NET Framework 4.5** is selected in the .NET Framework version drop-down list."},{"content":"Select <bpt id=\"p1\">**</bpt>Workflow Console Application<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Workflow<ept id=\"p2\">**</ept> list.","pos":[1724,1791],"source":" Select **Workflow Console Application** from the **Workflow** list."},{"content":"Type <ph id=\"ph1\">`NumberGuessWorkflowHost`</ph> into the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[1792,1862],"source":" Type `NumberGuessWorkflowHost` into the **Name** box and click **OK**."},{"content":"This creates a starter workflow application with basic workflow hosting support.","pos":[1863,1943]},{"content":"This basic hosting code is modified and used to run the workflow application.","pos":[1944,2021]},{"content":"Right-click the newly added <bpt id=\"p1\">**</bpt>NumberGuessWorkflowHost<ept id=\"p1\">**</ept> project in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Add Reference<ept id=\"p3\">**</ept>.","pos":[2027,2145],"source":"Right-click the newly added **NumberGuessWorkflowHost** project in **Solution Explorer** and select **Add Reference**."},{"content":"Select <bpt id=\"p1\">**</bpt>Solution<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Add Reference<ept id=\"p2\">**</ept> list, check the checkbox beside <bpt id=\"p3\">**</bpt>NumberGuessWorkflowActivities<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept>.","pos":[2146,2282],"source":" Select **Solution** from the **Add Reference** list, check the checkbox beside **NumberGuessWorkflowActivities**, and then click **OK**."},{"content":"Right-click <bpt id=\"p1\">**</bpt>Workflow1.xaml<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and choose <bpt id=\"p3\">**</bpt>Delete<ept id=\"p3\">**</ept>.","pos":[2288,2366],"source":"Right-click **Workflow1.xaml** in **Solution Explorer** and choose **Delete**."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to confirm.","pos":[2367,2391],"source":" Click **OK** to confirm."},{"pos":[2397,2432],"content":"To modify the workflow hosting code","linkify":"To modify the workflow hosting code","nodes":[{"content":"To modify the workflow hosting code","pos":[0,35]}]},{"pos":[2438,2529],"content":"Double-click <bpt id=\"p1\">**</bpt>Program.cs<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Module1.vb<ept id=\"p2\">**</ept> in <bpt id=\"p3\">**</bpt>Solution Explorer<ept id=\"p3\">**</ept> to display the code.","source":"Double-click **Program.cs** or **Module1.vb** in **Solution Explorer** to display the code."},{"pos":[2537,2657],"content":"[!TIP]\nIf the **Solution Explorer** window is not displayed, select **Solution Explorer** from the **View** menu.","leadings":["","    >  "],"nodes":[{"content":"If the <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> window is not displayed, select <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>View<ept id=\"p3\">**</ept> menu.","pos":[7,113],"source":"If the **Solution Explorer** window is not displayed, select **Solution Explorer** from the **View** menu."}]},{"pos":[2664,2837],"content":"Because this project was created by using the <bpt id=\"p1\">**</bpt>Workflow Console Application<ept id=\"p1\">**</ept> template, <bpt id=\"p2\">**</bpt>Program.cs<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>Module1.vb<ept id=\"p3\">**</ept> contains the following basic workflow hosting code.","source":"Because this project was created by using the **Workflow Console Application** template, **Program.cs** or **Module1.vb** contains the following basic workflow hosting code."},{"content":"This generated hosting code uses <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowInvoker&gt;</ph>.","pos":[3141,3215],"source":"This generated hosting code uses <xref:System.Activities.WorkflowInvoker>."},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.WorkflowInvoker&gt;</ph> provides a simple way for invoking a workflow as if it were a method call and can be used only for workflows that do not use persistence.","pos":[3216,3394],"source":"<xref:System.Activities.WorkflowInvoker> provides a simple way for invoking a workflow as if it were a method call and can be used only for workflows that do not use persistence."},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.WorkflowApplication&gt;</ph> provides a richer model for executing workflows that includes notification of life-cycle events, execution control, bookmark resumption, and persistence.","pos":[3395,3593],"source":"<xref:System.Activities.WorkflowApplication> provides a richer model for executing workflows that includes notification of life-cycle events, execution control, bookmark resumption, and persistence."},{"content":"This example uses bookmarks and <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowApplication&gt;</ph> is used for hosting the workflow.","pos":[3594,3704],"source":" This example uses bookmarks and <xref:System.Activities.WorkflowApplication> is used for hosting the workflow."},{"content":"Add the following <ph id=\"ph1\">`using`</ph> or <bpt id=\"p1\">**</bpt>Imports<ept id=\"p1\">**</ept> statement at the top of <bpt id=\"p2\">**</bpt>Program.cs<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>Module1.vb<ept id=\"p3\">**</ept> below the existing <bpt id=\"p4\">**</bpt>using<ept id=\"p4\">**</ept> or <bpt id=\"p5\">**</bpt>Imports<ept id=\"p5\">**</ept> statements.","pos":[3705,3858],"source":" Add the following `using` or **Imports** statement at the top of **Program.cs** or **Module1.vb** below the existing **using** or **Imports** statements."},{"content":"Replace the lines of code that use <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowInvoker&gt;</ph> with the following basic <ph id=\"ph2\">&lt;xref:System.Activities.WorkflowApplication&gt;</ph> hosting code.","pos":[4047,4206],"source":"Replace the lines of code that use <xref:System.Activities.WorkflowInvoker> with the following basic <xref:System.Activities.WorkflowApplication> hosting code."},{"content":"This sample hosting code demonstrates the basic steps for hosting and invoking a workflow, but does not yet contain the functionality to successfully run the workflow from this topic.","pos":[4207,4390]},{"content":"In the following steps, this basic code is modified and additional features are added until the application is complete.","pos":[4391,4511]},{"pos":[4519,4916],"content":"[!NOTE]\nPlease replace `Workflow1` in these examples with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow you completed in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) step. If you do not replace `Workflow1` then you will get build errors when you try and build or run the workflow.","leadings":["","    >  "],"nodes":[{"content":"Please replace `Workflow1` in these examples with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow you completed in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) step. If you do not replace `Workflow1` then you will get build errors when you try and build or run the workflow.","pos":[8,390],"nodes":[{"content":"Please replace <ph id=\"ph1\">`Workflow1`</ph> in these examples with <ph id=\"ph2\">`FlowchartNumberGuessWorkflow`</ph>, <ph id=\"ph3\">`SequentialNumberGuessWorkflow`</ph>, or <ph id=\"ph4\">`StateMachineNumberGuessWorkflow`</ph>, depending on which workflow you completed in the previous <bpt id=\"p1\">[</bpt>How to: Create a Workflow<ept id=\"p1\">](how-to-create-a-workflow.md)</ept> step.","pos":[0,273],"source":"Please replace `Workflow1` in these examples with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow you completed in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) step."},{"content":"If you do not replace <ph id=\"ph1\">`Workflow1`</ph> then you will get build errors when you try and build or run the workflow.","pos":[274,382],"source":" If you do not replace `Workflow1` then you will get build errors when you try and build or run the workflow."}]}]},{"pos":[4923,5182],"content":"[!code-csharp[CFX_WF_GettingStarted#4](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/extrasnippets.cs#4)]\n [!code-vb[CFX_WF_GettingStarted#4](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/extrasnippets.vb#4)]","leadings":["","    "],"nodes":[]},{"content":"This code creates a <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowApplication&gt;</ph>, subscribes to three workflow life-cycle events, starts the workflow with a call to <ph id=\"ph2\">&lt;xref:System.Activities.WorkflowApplication.Run%2A&gt;</ph>, and then waits for the workflow to complete.","pos":[5189,5435],"source":"This code creates a <xref:System.Activities.WorkflowApplication>, subscribes to three workflow life-cycle events, starts the workflow with a call to <xref:System.Activities.WorkflowApplication.Run%2A>, and then waits for the workflow to complete."},{"content":"When the workflow completes, the <ph id=\"ph1\">&lt;xref:System.Threading.AutoResetEvent&gt;</ph> is set and the host application completes.","pos":[5436,5550],"source":" When the workflow completes, the <xref:System.Threading.AutoResetEvent> is set and the host application completes."},{"pos":[5556,5592],"content":"To set input arguments of a workflow","linkify":"To set input arguments of a workflow","nodes":[{"content":"To set input arguments of a workflow","pos":[0,36]}]},{"pos":[5598,5724],"content":"Add the following statement at the top of <bpt id=\"p1\">**</bpt>Program.cs<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Module1.vb<ept id=\"p2\">**</ept> below the existing <ph id=\"ph1\">`using`</ph> or <ph id=\"ph2\">`Imports`</ph> statements.","source":"Add the following statement at the top of **Program.cs** or **Module1.vb** below the existing `using` or `Imports` statements."},{"pos":[5731,5978],"content":"[!code-csharp[CFX_WF_GettingStarted#5](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#5)]\n [!code-vb[CFX_WF_GettingStarted#5](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#5)]","leadings":["","    "],"nodes":[]},{"pos":[5984,6185],"content":"Replace the line of code that creates the new <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowApplication&gt;</ph> with the following code that creates and passes a dictionary of parameters to the workflow when it is created.","source":"Replace the line of code that creates the new <xref:System.Activities.WorkflowApplication> with the following code that creates and passes a dictionary of parameters to the workflow when it is created."},{"pos":[6193,6590],"content":"[!NOTE]\nPlease replace `Workflow1` in these examples with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow you completed in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) step. If you do not replace `Workflow1` then you will get build errors when you try and build or run the workflow.","leadings":["","    >  "],"nodes":[{"content":"Please replace `Workflow1` in these examples with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow you completed in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) step. If you do not replace `Workflow1` then you will get build errors when you try and build or run the workflow.","pos":[8,390],"nodes":[{"content":"Please replace <ph id=\"ph1\">`Workflow1`</ph> in these examples with <ph id=\"ph2\">`FlowchartNumberGuessWorkflow`</ph>, <ph id=\"ph3\">`SequentialNumberGuessWorkflow`</ph>, or <ph id=\"ph4\">`StateMachineNumberGuessWorkflow`</ph>, depending on which workflow you completed in the previous <bpt id=\"p1\">[</bpt>How to: Create a Workflow<ept id=\"p1\">](how-to-create-a-workflow.md)</ept> step.","pos":[0,273],"source":"Please replace `Workflow1` in these examples with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow you completed in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) step."},{"content":"If you do not replace <ph id=\"ph1\">`Workflow1`</ph> then you will get build errors when you try and build or run the workflow.","pos":[274,382],"source":" If you do not replace `Workflow1` then you will get build errors when you try and build or run the workflow."}]}]},{"pos":[6597,6844],"content":"[!code-csharp[CFX_WF_GettingStarted#6](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#6)]\n [!code-vb[CFX_WF_GettingStarted#6](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#6)]","leadings":["","    "],"nodes":[]},{"content":"This dictionary contains one element with a key of <ph id=\"ph1\">`MaxNumber`</ph>.","pos":[6851,6914],"source":"This dictionary contains one element with a key of `MaxNumber`."},{"content":"Keys in the input dictionary correspond to input arguments on the root activity of the workflow.","pos":[6915,7011]},{"content":"<ph id=\"ph1\">`MaxNumber`</ph> is used by the workflow to determine the upper bound for the randomly generated number.","pos":[7012,7111],"source":"`MaxNumber` is used by the workflow to determine the upper bound for the randomly generated number."},{"pos":[7117,7159],"content":"To retrieve output arguments of a workflow","linkify":"To retrieve output arguments of a workflow","nodes":[{"content":"To retrieve output arguments of a workflow","pos":[0,42]}]},{"pos":[7165,7307],"content":"Modify the <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowApplication.Completed%2A&gt;</ph> handler to retrieve and display the number of turns used by the workflow.","source":"Modify the <xref:System.Activities.WorkflowApplication.Completed%2A> handler to retrieve and display the number of turns used by the workflow."},{"pos":[7314,7561],"content":"[!code-csharp[CFX_WF_GettingStarted#7](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#7)]\n [!code-vb[CFX_WF_GettingStarted#7](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#7)]","leadings":["","    "],"nodes":[]},{"pos":[7567,7587],"content":"To resume a bookmark","linkify":"To resume a bookmark","nodes":[{"content":"To resume a bookmark","pos":[0,20]}]},{"pos":[7593,7723],"content":"Add the following code at the top of the <ph id=\"ph1\">`Main`</ph> method just after the existing <ph id=\"ph2\">&lt;xref:System.Threading.AutoResetEvent&gt;</ph> declaration.","source":"Add the following code at the top of the `Main` method just after the existing <xref:System.Threading.AutoResetEvent> declaration."},{"pos":[7730,7977],"content":"[!code-csharp[CFX_WF_GettingStarted#8](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#8)]\n [!code-vb[CFX_WF_GettingStarted#8](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#8)]","leadings":["","    "],"nodes":[]},{"pos":[7983,8131],"content":"Add the following <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowApplication.Idle%2A&gt;</ph> handler just below the existing three workflow life-cycle handlers in <ph id=\"ph2\">`Main`</ph>.","source":"Add the following <xref:System.Activities.WorkflowApplication.Idle%2A> handler just below the existing three workflow life-cycle handlers in `Main`."},{"pos":[8138,8385],"content":"[!code-csharp[CFX_WF_GettingStarted#9](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#9)]\n [!code-vb[CFX_WF_GettingStarted#9](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#9)]","leadings":["","    "],"nodes":[]},{"content":"Each time the workflow becomes idle waiting for the next guess, this handler is called and the <ph id=\"ph1\">`idleAction`</ph> <ph id=\"ph2\">&lt;xref:System.Threading.AutoResetEvent&gt;</ph> is set.","pos":[8392,8546],"source":"Each time the workflow becomes idle waiting for the next guess, this handler is called and the `idleAction` <xref:System.Threading.AutoResetEvent> is set."},{"content":"The code in the following step uses <ph id=\"ph1\">`idleEvent`</ph> and <ph id=\"ph2\">`syncEvent`</ph> to determine whether the workflow is waiting for the next guess or is complete.","pos":[8547,8690],"source":" The code in the following step uses `idleEvent` and `syncEvent` to determine whether the workflow is waiting for the next guess or is complete."},{"pos":[8698,9329],"content":"[!NOTE]\nIn this example, the host application uses auto-reset events in the <xref:System.Activities.WorkflowApplication.Completed%2A> and <xref:System.Activities.WorkflowApplication.Idle%2A> handlers to synchronize the host application with the progress of the workflow. It is not necessary to block and wait for the workflow to become idle before resuming a bookmark, but in this example the synchronization events are required so the host knows whether the workflow is complete or whether it is waiting on more user input by using the <xref:System.Activities.Bookmark>. For more information, see [Bookmarks](bookmarks.md).","leadings":["","    >  "],"nodes":[{"content":"In this example, the host application uses auto-reset events in the <xref:System.Activities.WorkflowApplication.Completed%2A> and <xref:System.Activities.WorkflowApplication.Idle%2A> handlers to synchronize the host application with the progress of the workflow. It is not necessary to block and wait for the workflow to become idle before resuming a bookmark, but in this example the synchronization events are required so the host knows whether the workflow is complete or whether it is waiting on more user input by using the <xref:System.Activities.Bookmark>. For more information, see [Bookmarks](bookmarks.md).","pos":[8,624],"nodes":[{"content":"In this example, the host application uses auto-reset events in the <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowApplication.Completed%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Activities.WorkflowApplication.Idle%2A&gt;</ph> handlers to synchronize the host application with the progress of the workflow.","pos":[0,262],"source":"In this example, the host application uses auto-reset events in the <xref:System.Activities.WorkflowApplication.Completed%2A> and <xref:System.Activities.WorkflowApplication.Idle%2A> handlers to synchronize the host application with the progress of the workflow."},{"content":"It is not necessary to block and wait for the workflow to become idle before resuming a bookmark, but in this example the synchronization events are required so the host knows whether the workflow is complete or whether it is waiting on more user input by using the <ph id=\"ph1\">&lt;xref:System.Activities.Bookmark&gt;</ph>.","pos":[263,563],"source":" It is not necessary to block and wait for the workflow to become idle before resuming a bookmark, but in this example the synchronization events are required so the host knows whether the workflow is complete or whether it is waiting on more user input by using the <xref:System.Activities.Bookmark>."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Bookmarks<ept id=\"p1\">](bookmarks.md)</ept>.","pos":[564,616],"source":" For more information, see [Bookmarks](bookmarks.md)."}]}]},{"pos":[9335,9469],"content":"Remove the call to <ph id=\"ph1\">`WaitOne`</ph>, and replace it with code to gather input from the user and resume the <ph id=\"ph2\">&lt;xref:System.Activities.Bookmark&gt;</ph>.","source":"Remove the call to `WaitOne`, and replace it with code to gather input from the user and resume the <xref:System.Activities.Bookmark>."},{"content":"Remove the following line of code.","pos":[9476,9510]},{"pos":[9517,9780],"content":"[!code-csharp[CFX_WF_GettingStarted#10](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/extrasnippets.cs#10)]\n [!code-vb[CFX_WF_GettingStarted#10](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/extrasnippets.vb#10)]","leadings":["","    "],"nodes":[]},{"content":"Replace it with the following example.","pos":[9787,9825]},{"pos":[9832,10083],"content":"[!code-csharp[CFX_WF_GettingStarted#11](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#11)]\n [!code-vb[CFX_WF_GettingStarted#11](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#11)]","leadings":["","    "],"nodes":[]},{"pos":[10088,10160],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_ToRunTheApplication\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> To build and run the application","linkify":"<a name=\"BKMK_ToRunTheApplication\"></a> To build and run the application","source":"<a name=\"BKMK_ToRunTheApplication\"></a> To build and run the application"},{"pos":[10166,10269],"content":"Right-click <bpt id=\"p1\">**</bpt>NumberGuessWorkflowHost<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Set as StartUp Project<ept id=\"p3\">**</ept>.","source":"Right-click **NumberGuessWorkflowHost** in **Solution Explorer** and select **Set as StartUp Project**."},{"content":"Press CTRL+F5 to build and run the application.","pos":[10275,10322]},{"content":"Try to guess the number in as few turns as possible.","pos":[10323,10375]},{"pos":[10382,10694],"content":"To try the application with one of the other styles of workflow, replace <ph id=\"ph1\">`Workflow1`</ph> in the code that creates the <ph id=\"ph2\">&lt;xref:System.Activities.WorkflowApplication&gt;</ph> with <ph id=\"ph3\">`FlowchartNumberGuessWorkflow`</ph>, <ph id=\"ph4\">`SequentialNumberGuessWorkflow`</ph>, or <ph id=\"ph5\">`StateMachineNumberGuessWorkflow`</ph>, depending on which workflow style you desire.","source":"To try the application with one of the other styles of workflow, replace `Workflow1` in the code that creates the <xref:System.Activities.WorkflowApplication> with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow style you desire."},{"pos":[10701,10948],"content":"[!code-csharp[CFX_WF_GettingStarted#6](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_wf_gettingstarted/cs/program.cs#6)]\n [!code-vb[CFX_WF_GettingStarted#6](~/samples/snippets/visualbasic/VS_Snippets_CFX/cfx_wf_gettingstarted/vb/module1.vb#6)]","leadings":["","    "],"nodes":[]},{"pos":[10955,11147],"content":"For instructions about how to add persistence to a workflow application, see the next topic, <bpt id=\"p1\">[</bpt>How to: Create and Run a Long Running Workflow<ept id=\"p1\">](how-to-create-and-run-a-long-running-workflow.md)</ept>.","source":"For instructions about how to add persistence to a workflow application, see the next topic, [How to: Create and Run a Long Running Workflow](how-to-create-and-run-a-long-running-workflow.md)."},{"pos":[11152,11159],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[11161,11234],"content":"The following example is the complete code listing for the <ph id=\"ph1\">`Main`</ph> method.","source":"The following example is the complete code listing for the `Main` method."},{"pos":[11238,11631],"content":"[!NOTE]\n Please replace `Workflow1` in these examples with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow you completed in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) step. If you do not replace `Workflow1` then you will get build errors when you try and build or run the workflow.","leadings":["","> "],"nodes":[{"content":"Please replace `Workflow1` in these examples with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow you completed in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) step. If you do not replace `Workflow1` then you will get build errors when you try and build or run the workflow.","pos":[9,391],"nodes":[{"content":"Please replace <ph id=\"ph1\">`Workflow1`</ph> in these examples with <ph id=\"ph2\">`FlowchartNumberGuessWorkflow`</ph>, <ph id=\"ph3\">`SequentialNumberGuessWorkflow`</ph>, or <ph id=\"ph4\">`StateMachineNumberGuessWorkflow`</ph>, depending on which workflow you completed in the previous <bpt id=\"p1\">[</bpt>How to: Create a Workflow<ept id=\"p1\">](how-to-create-a-workflow.md)</ept> step.","pos":[0,273],"source":"Please replace `Workflow1` in these examples with `FlowchartNumberGuessWorkflow`, `SequentialNumberGuessWorkflow`, or `StateMachineNumberGuessWorkflow`, depending on which workflow you completed in the previous [How to: Create a Workflow](how-to-create-a-workflow.md) step."},{"content":"If you do not replace <ph id=\"ph1\">`Workflow1`</ph> then you will get build errors when you try and build or run the workflow.","pos":[274,382],"source":" If you do not replace `Workflow1` then you will get build errors when you try and build or run the workflow."}]}]},{"pos":[11886,11894],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[11981,12038],"content":"<bpt id=\"p1\">[</bpt>Windows Workflow Foundation Programming<ept id=\"p1\">](programming.md)</ept>","source":"[Windows Workflow Foundation Programming](programming.md)"},{"pos":[12041,12096],"content":"<bpt id=\"p1\">[</bpt>Getting Started Tutorial<ept id=\"p1\">](getting-started-tutorial.md)</ept>","source":"[Getting Started Tutorial](getting-started-tutorial.md)"},{"pos":[12099,12155],"content":"<bpt id=\"p1\">[</bpt>How to: Create a Workflow<ept id=\"p1\">](how-to-create-a-workflow.md)</ept>","source":"[How to: Create a Workflow](how-to-create-a-workflow.md)"},{"pos":[12158,12256],"content":"<bpt id=\"p1\">[</bpt>How to: Create and Run a Long Running Workflow<ept id=\"p1\">](how-to-create-and-run-a-long-running-workflow.md)</ept>","source":"[How to: Create and Run a Long Running Workflow](how-to-create-and-run-a-long-running-workflow.md)"},{"pos":[12259,12328],"content":"<bpt id=\"p1\">[</bpt>Waiting for Input in a Workflow<ept id=\"p1\">](waiting-for-input-in-a-workflow.md)</ept>","source":"[Waiting for Input in a Workflow](waiting-for-input-in-a-workflow.md)"},{"pos":[12331,12372],"content":"<bpt id=\"p1\">[</bpt>Hosting Workflows<ept id=\"p1\">](hosting-workflows.md)</ept>","source":"[Hosting Workflows](hosting-workflows.md)"}]}