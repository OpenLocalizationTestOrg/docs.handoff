{"content":"---\ntitle: \"DataView Performance\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 90820e49-9d46-41f6-9a3d-6c0741bbd8eb\n---\n# DataView Performance\nThis topic discusses the performance benefits of using the <xref:System.Data.DataView.Find%2A> and <xref:System.Data.DataView.FindRows%2A> methods of the <xref:System.Data.DataView> class, and of caching a <xref:System.Data.DataView> in a Web application.  \n  \n## Find and FindRows  \n <xref:System.Data.DataView> constructs an index. An index contains keys built from one or more columns in the table or view. These keys are stored in a structure that enables the <xref:System.Data.DataView> to find the row or rows associated with the key values quickly and efficiently. Operations that use the index, such as filtering and sorting, see significant performance increases. The index for a <xref:System.Data.DataView> is built both when the <xref:System.Data.DataView> is created and when any of the sorting or filtering information is modified. Creating a <xref:System.Data.DataView> and then setting the sorting or filtering information later causes the index to be built at least twice: once when the <xref:System.Data.DataView> is created, and again when any of the sort or filter properties are modified. For more information about filtering and sorting with <xref:System.Data.DataView>, see [Filtering with DataView](../../../../docs/framework/data/adonet/filtering-with-dataview-linq-to-dataset.md) and [Sorting with DataView](../../../../docs/framework/data/adonet/sorting-with-dataview-linq-to-dataset.md).  \n  \n If you want to return the results of a particular query on the data, as opposed to providing a dynamic view of a subset of the data, you can use the <xref:System.Data.DataView.Find%2A> or <xref:System.Data.DataView.FindRows%2A> methods of the <xref:System.Data.DataView>, rather than setting the <xref:System.Data.DataView.RowFilter%2A> property. The <xref:System.Data.DataView.RowFilter%2A> property is best used in a data-bound application where a bound control displays filtered results. Setting the <xref:System.Data.DataView.RowFilter%2A> property rebuilds the index for the data, adding overhead to your application and decreasing performance. The <xref:System.Data.DataView.Find%2A> and <xref:System.Data.DataView.FindRows%2A> methods use the current index without requiring the index to be rebuilt. If you are going to call <xref:System.Data.DataView.Find%2A> or <xref:System.Data.DataView.FindRows%2A> only once, then you should use the existing <xref:System.Data.DataView>. If you are going to call <xref:System.Data.DataView.Find%2A> or <xref:System.Data.DataView.FindRows%2A> multiple times, you should create a new <xref:System.Data.DataView> to rebuild the index on the column you want to search on, and then call the <xref:System.Data.DataView.Find%2A> or <xref:System.Data.DataView.FindRows%2A> methods. For more information about the <xref:System.Data.DataView.Find%2A> and <xref:System.Data.DataView.FindRows%2A> methods, see [Finding Rows](../../../../docs/framework/data/adonet/dataset-datatable-dataview/finding-rows.md).  \n  \n The following example uses the <xref:System.Data.DataView.Find%2A> method to find a contact with the last name \"Zhu\".  \n  \n [!code-csharp[DP DataView Samples#LDVFromQueryOrderByFind](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP DataView Samples/CS/Form1.cs#ldvfromqueryorderbyfind)]\n [!code-vb[DP DataView Samples#LDVFromQueryOrderByFind](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP DataView Samples/VB/Form1.vb#ldvfromqueryorderbyfind)]  \n  \n The following example uses the <xref:System.Data.DataView.FindRows%2A> method to find all the red colored products.  \n  \n [!code-csharp[DP DataView Samples#LDVFromQueryFindRows](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP DataView Samples/CS/Form1.cs#ldvfromqueryfindrows)]\n [!code-vb[DP DataView Samples#LDVFromQueryFindRows](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP DataView Samples/VB/Form1.vb#ldvfromqueryfindrows)]  \n  \n## ASP.NET  \n ASP.NET has a caching mechanism that allows you to store objects that require extensive server resources to create in memory. Caching these types of resources can significantly improve the performance of your application. Caching is implemented by the <xref:System.Web.Caching.Cache> class, with cache instances that are private to each application. Because creating a new <xref:System.Data.DataView> object can be resource intensive, you might want to use this caching functionality in Web applications so that the <xref:System.Data.DataView> does not have to be rebuilt every time the Web page is refreshed.  \n  \n In the following example, the <xref:System.Data.DataView> is cached so that the data does not have to be re-sorted when the page is refreshed.  \n  \n```vb  \nIf (Cache(\"ordersView\") = Nothing) Then  \n  \nDim dataSet As New DataSet()  \n  \n   FillDataSet(dataSet)  \n  \n   Dim orders As DataTable = dataSet.Tables(\"SalesOrderHeader\")  \n  \n   Dim query = _  \n                    From order In orders.AsEnumerable() _  \n                    Where order.Field(Of Boolean)(\"OnlineOrderFlag\") = True _  \n                    Order By order.Field(Of Decimal)(\"TotalDue\") _  \n                    Select order  \n  \n   Dim view As DataView = query.AsDataView()  \n  \n   Cache.Insert(\"ordersView\", view)  \n  \nEnd If  \n  \nDim ordersView = CType(Cache(\"ordersView\"), DataView)  \n  \nGridView1.DataSource = ordersView  \nGridView1.DataBind()  \n```  \n  \n```csharp  \nif (Cache[\"ordersView\"] == null)  \n{  \n   // Fill the DataSet.                  \n   DataSet dataSet = FillDataSet();  \n  \n   DataTable orders = dataSet.Tables[\"SalesOrderHeader\"];  \n  \n   EnumerableRowCollection<DataRow> query =  \n                        from order in orders.AsEnumerable()  \n                        where order.Field<bool>(\"OnlineOrderFlag\") == true  \n                        orderby order.Field<decimal>(\"TotalDue\")  \n                        select order;  \n  \n   DataView view = query.AsDataView();  \n   Cache.Insert(\"ordersView\", view);  \n}  \n  \nDataView ordersView = (DataView)Cache[\"ordersView\"];  \n  \nGridView1.DataSource = ordersView;  \nGridView1.DataBind();  \n```  \n  \n## See also\n\n- [Data Binding and LINQ to DataSet](../../../../docs/framework/data/adonet/data-binding-and-linq-to-dataset.md)\n","nodes":[{"pos":[4,138],"embed":true,"restype":"x-metadata","content":"title: \"DataView Performance\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 90820e49-9d46-41f6-9a3d-6c0741bbd8eb","nodes":[{"content":"DataView Performance","nodes":[{"pos":[0,20],"content":"DataView Performance","nodes":[{"content":"DataView Performance","pos":[0,20]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[145,165],"content":"DataView Performance","linkify":"DataView Performance","nodes":[{"content":"DataView Performance","pos":[0,20]}]},{"pos":[166,421],"content":"This topic discusses the performance benefits of using the <ph id=\"ph1\">&lt;xref:System.Data.DataView.Find%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Data.DataView.FindRows%2A&gt;</ph> methods of the <ph id=\"ph3\">&lt;xref:System.Data.DataView&gt;</ph> class, and of caching a <ph id=\"ph4\">&lt;xref:System.Data.DataView&gt;</ph> in a Web application.","source":"This topic discusses the performance benefits of using the <xref:System.Data.DataView.Find%2A> and <xref:System.Data.DataView.FindRows%2A> methods of the <xref:System.Data.DataView> class, and of caching a <xref:System.Data.DataView> in a Web application."},{"pos":[430,447],"content":"Find and FindRows","linkify":"Find and FindRows","nodes":[{"content":"Find and FindRows","pos":[0,17]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Data.DataView&gt;</ph> constructs an index.","pos":[451,499],"source":"<xref:System.Data.DataView> constructs an index."},{"content":"An index contains keys built from one or more columns in the table or view.","pos":[500,575]},{"content":"These keys are stored in a structure that enables the <ph id=\"ph1\">&lt;xref:System.Data.DataView&gt;</ph> to find the row or rows associated with the key values quickly and efficiently.","pos":[576,737],"source":" These keys are stored in a structure that enables the <xref:System.Data.DataView> to find the row or rows associated with the key values quickly and efficiently."},{"content":"Operations that use the index, such as filtering and sorting, see significant performance increases.","pos":[738,838]},{"content":"The index for a <ph id=\"ph1\">&lt;xref:System.Data.DataView&gt;</ph> is built both when the <ph id=\"ph2\">&lt;xref:System.Data.DataView&gt;</ph> is created and when any of the sorting or filtering information is modified.","pos":[839,1010],"source":" The index for a <xref:System.Data.DataView> is built both when the <xref:System.Data.DataView> is created and when any of the sorting or filtering information is modified."},{"content":"Creating a <ph id=\"ph1\">&lt;xref:System.Data.DataView&gt;</ph> and then setting the sorting or filtering information later causes the index to be built at least twice: once when the <ph id=\"ph2\">&lt;xref:System.Data.DataView&gt;</ph> is created, and again when any of the sort or filter properties are modified.","pos":[1011,1274],"source":" Creating a <xref:System.Data.DataView> and then setting the sorting or filtering information later causes the index to be built at least twice: once when the <xref:System.Data.DataView> is created, and again when any of the sort or filter properties are modified."},{"content":"For more information about filtering and sorting with <ph id=\"ph1\">&lt;xref:System.Data.DataView&gt;</ph>, see <bpt id=\"p1\">[</bpt>Filtering with DataView<ept id=\"p1\">](../../../../docs/framework/data/adonet/filtering-with-dataview-linq-to-dataset.md)</ept> and <bpt id=\"p2\">[</bpt>Sorting with DataView<ept id=\"p2\">](../../../../docs/framework/data/adonet/sorting-with-dataview-linq-to-dataset.md)</ept>.","pos":[1275,1580],"source":" For more information about filtering and sorting with <xref:System.Data.DataView>, see [Filtering with DataView](../../../../docs/framework/data/adonet/filtering-with-dataview-linq-to-dataset.md) and [Sorting with DataView](../../../../docs/framework/data/adonet/sorting-with-dataview-linq-to-dataset.md)."},{"content":"If you want to return the results of a particular query on the data, as opposed to providing a dynamic view of a subset of the data, you can use the <ph id=\"ph1\">&lt;xref:System.Data.DataView.Find%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Data.DataView.FindRows%2A&gt;</ph> methods of the <ph id=\"ph3\">&lt;xref:System.Data.DataView&gt;</ph>, rather than setting the <ph id=\"ph4\">&lt;xref:System.Data.DataView.RowFilter%2A&gt;</ph> property.","pos":[1587,1933],"source":"If you want to return the results of a particular query on the data, as opposed to providing a dynamic view of a subset of the data, you can use the <xref:System.Data.DataView.Find%2A> or <xref:System.Data.DataView.FindRows%2A> methods of the <xref:System.Data.DataView>, rather than setting the <xref:System.Data.DataView.RowFilter%2A> property."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataView.RowFilter%2A&gt;</ph> property is best used in a data-bound application where a bound control displays filtered results.","pos":[1934,2077],"source":" The <xref:System.Data.DataView.RowFilter%2A> property is best used in a data-bound application where a bound control displays filtered results."},{"content":"Setting the <ph id=\"ph1\">&lt;xref:System.Data.DataView.RowFilter%2A&gt;</ph> property rebuilds the index for the data, adding overhead to your application and decreasing performance.","pos":[2078,2236],"source":" Setting the <xref:System.Data.DataView.RowFilter%2A> property rebuilds the index for the data, adding overhead to your application and decreasing performance."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataView.Find%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Data.DataView.FindRows%2A&gt;</ph> methods use the current index without requiring the index to be rebuilt.","pos":[2237,2393],"source":" The <xref:System.Data.DataView.Find%2A> and <xref:System.Data.DataView.FindRows%2A> methods use the current index without requiring the index to be rebuilt."},{"content":"If you are going to call <ph id=\"ph1\">&lt;xref:System.Data.DataView.Find%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Data.DataView.FindRows%2A&gt;</ph> only once, then you should use the existing <ph id=\"ph3\">&lt;xref:System.Data.DataView&gt;</ph>.","pos":[2394,2570],"source":" If you are going to call <xref:System.Data.DataView.Find%2A> or <xref:System.Data.DataView.FindRows%2A> only once, then you should use the existing <xref:System.Data.DataView>."},{"content":"If you are going to call <ph id=\"ph1\">&lt;xref:System.Data.DataView.Find%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Data.DataView.FindRows%2A&gt;</ph> multiple times, you should create a new <ph id=\"ph3\">&lt;xref:System.Data.DataView&gt;</ph> to rebuild the index on the column you want to search on, and then call the <ph id=\"ph4\">&lt;xref:System.Data.DataView.Find%2A&gt;</ph> or <ph id=\"ph5\">&lt;xref:System.Data.DataView.FindRows%2A&gt;</ph> methods.","pos":[2571,2906],"source":" If you are going to call <xref:System.Data.DataView.Find%2A> or <xref:System.Data.DataView.FindRows%2A> multiple times, you should create a new <xref:System.Data.DataView> to rebuild the index on the column you want to search on, and then call the <xref:System.Data.DataView.Find%2A> or <xref:System.Data.DataView.FindRows%2A> methods."},{"content":"For more information about the <ph id=\"ph1\">&lt;xref:System.Data.DataView.Find%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Data.DataView.FindRows%2A&gt;</ph> methods, see <bpt id=\"p1\">[</bpt>Finding Rows<ept id=\"p1\">](../../../../docs/framework/data/adonet/dataset-datatable-dataview/finding-rows.md)</ept>.","pos":[2907,3129],"source":" For more information about the <xref:System.Data.DataView.Find%2A> and <xref:System.Data.DataView.FindRows%2A> methods, see [Finding Rows](../../../../docs/framework/data/adonet/dataset-datatable-dataview/finding-rows.md)."},{"pos":[3136,3253],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Data.DataView.Find%2A&gt;</ph> method to find a contact with the last name \"Zhu\".","source":"The following example uses the <xref:System.Data.DataView.Find%2A> method to find a contact with the last name \"Zhu\"."},{"pos":[3614,3729],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Data.DataView.FindRows%2A&gt;</ph> method to find all the red colored products.","source":"The following example uses the <xref:System.Data.DataView.FindRows%2A> method to find all the red colored products."},{"pos":[4080,4087],"content":"ASP.NET","linkify":"ASP.NET","nodes":[{"content":"ASP.NET","pos":[0,7]}]},{"content":"ASP.NET has a caching mechanism that allows you to store objects that require extensive server resources to create in memory.","pos":[4091,4216]},{"content":"Caching these types of resources can significantly improve the performance of your application.","pos":[4217,4312]},{"content":"Caching is implemented by the <ph id=\"ph1\">&lt;xref:System.Web.Caching.Cache&gt;</ph> class, with cache instances that are private to each application.","pos":[4313,4440],"source":" Caching is implemented by the <xref:System.Web.Caching.Cache> class, with cache instances that are private to each application."},{"content":"Because creating a new <ph id=\"ph1\">&lt;xref:System.Data.DataView&gt;</ph> object can be resource intensive, you might want to use this caching functionality in Web applications so that the <ph id=\"ph2\">&lt;xref:System.Data.DataView&gt;</ph> does not have to be rebuilt every time the Web page is refreshed.","pos":[4441,4700],"source":" Because creating a new <xref:System.Data.DataView> object can be resource intensive, you might want to use this caching functionality in Web applications so that the <xref:System.Data.DataView> does not have to be rebuilt every time the Web page is refreshed."},{"pos":[4707,4849],"content":"In the following example, the <ph id=\"ph1\">&lt;xref:System.Data.DataView&gt;</ph> is cached so that the data does not have to be re-sorted when the page is refreshed.","source":"In the following example, the <xref:System.Data.DataView> is cached so that the data does not have to be re-sorted when the page is refreshed."},{"pos":[6246,6254],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6258,6368],"content":"<bpt id=\"p1\">[</bpt>Data Binding and LINQ to DataSet<ept id=\"p1\">](../../../../docs/framework/data/adonet/data-binding-and-linq-to-dataset.md)</ept>","source":"[Data Binding and LINQ to DataSet](../../../../docs/framework/data/adonet/data-binding-and-linq-to-dataset.md)"}]}