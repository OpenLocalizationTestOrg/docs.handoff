{"content":"---\ntitle: \"Walkthrough: Hosting a Windows Forms Control in WPF | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"hosting Windows Forms control in WPF\"\nms.assetid: 9cb88415-39b0-4c46-80c4-ff325b674286\ncaps.latest.revision: 36\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Hosting a Windows Forms Control in WPF\n[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides many controls with a rich feature set. However, you may sometimes want to use              [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls on your              [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pages. For example, you may have a substantial investment in existing              [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls, or you may have a              [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control that provides unique functionality.  \n  \n This walkthrough shows you how to host a              [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]<xref:System.Windows.Forms.MaskedTextBox?displayProperty=fullName> control on a              [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] page by using code.  \n  \n For a complete code listing of the tasks shown in this walkthrough, see              [Hosting a Windows Forms Control in WPF Sample](http://go.microsoft.com/fwlink/?LinkID=160057).  \n  \n## Prerequisites  \n You need the following components to complete this walkthrough:  \n  \n-   [!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)].  \n  \n## Hosting the Windows Forms Control  \n  \n#### To host the MaskedTextBox control  \n  \n1.  Create a WPF Application project named                                  `HostingWfInWpf`.  \n  \n2.  Add references to the following assemblies.  \n  \n    -   WindowsFormsIntegration  \n  \n    -   System.Windows.Forms  \n  \n3.  Open MainWindow.xaml in the                                  [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)].  \n  \n4.  Name the                                  <xref:System.Windows.Controls.Grid> element                                  `grid1`.  \n  \n     [!code-xml[HostingWfInWPF#1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWPF/CSharp/HostingWfInWPF/Window1.xaml#1)]  \n  \n5.  In Design view or XAML view, select the                                  <xref:System.Windows.Window> element.  \n  \n6.  In the Properties window, click the                                  **Events** tab.  \n  \n7.  Double-click the                                  <xref:System.Windows.FrameworkElement.Loaded> event.  \n  \n8.  Insert the following code to handle the                                  <xref:System.Windows.FrameworkElement.Loaded> event.  \n  \n     [!code-csharp[HostingWfInWPF#10](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWPF/CSharp/HostingWfInWPF/Window1.xaml.cs#10)]\n     [!code-vb[HostingWfInWPF#10](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HostingWfInWPF/VisualBasic/HostingWfInWpf/Window1.xaml.vb#10)]  \n  \n9. At the top of the file, add the following                                  `Imports` or                                  `using` statement.  \n  \n     [!code-csharp[HostingWfInWPF#11](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWPF/CSharp/HostingWfInWPF/Window1.xaml.cs#11)]\n     [!code-vb[HostingWfInWPF#11](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HostingWfInWPF/VisualBasic/HostingWfInWpf/Window1.xaml.vb#11)]  \n  \n10. Press F5 to build and run the application.  \n  \n## See Also  \n <xref:System.Windows.Forms.Integration.ElementHost>   \n <xref:System.Windows.Forms.Integration.WindowsFormsHost>   \n [WPF Designer](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)   \n [Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-control-in-wpf-by-using-xaml.md)   \n [Walkthrough: Hosting a Windows Forms Composite Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)   \n [Walkthrough: Hosting a WPF Composite Control in Windows Forms](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)   \n [Windows Forms Controls and Equivalent WPF Controls](../../../../docs/framework/wpf/advanced/windows-forms-controls-and-equivalent-wpf-controls.md)   \n [Hosting a Windows Forms Control in WPF Sample](http://go.microsoft.com/fwlink/?LinkID=160057)","nodes":[{"pos":[4,446],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Hosting a Windows Forms Control in WPF | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"hosting Windows Forms control in WPF\"\nms.assetid: 9cb88415-39b0-4c46-80c4-ff325b674286\ncaps.latest.revision: 36\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Control in WPF | Microsoft Docs","nodes":[{"pos":[0,68],"content":"Walkthrough: Hosting a Windows Forms Control in WPF | Microsoft Docs","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Control in WPF | Microsoft Docs","pos":[0,68]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[453,504],"content":"Walkthrough: Hosting a Windows Forms Control in WPF","linkify":"Walkthrough: Hosting a Windows Forms Control in WPF","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Control in WPF","pos":[0,51]}]},{"content":"provides many controls with a rich feature set.","pos":[587,634]},{"content":"However, you may sometimes want to use              <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls on your              <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> pages.","pos":[635,883],"source":" However, you may sometimes want to use              [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls on your              [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pages."},{"content":"For example, you may have a substantial investment in existing              <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls, or you may have a              <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> control that provides unique functionality.","pos":[884,1200],"source":" For example, you may have a substantial investment in existing              [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls, or you may have a              [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control that provides unique functionality."},{"pos":[1207,1532],"content":"This walkthrough shows you how to host a              <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.MaskedTextBox?displayProperty=fullName&gt;</ph> control on a              <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> page by using code.","source":"This walkthrough shows you how to host a              [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]<xref:System.Windows.Forms.MaskedTextBox?displayProperty=fullName> control on a              [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] page by using code."},{"pos":[1539,1719],"content":"For a complete code listing of the tasks shown in this walkthrough, see              <bpt id=\"p1\">[</bpt>Hosting a Windows Forms Control in WPF Sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=160057)</ept>.","source":"For a complete code listing of the tasks shown in this walkthrough, see              [Hosting a Windows Forms Control in WPF Sample](http://go.microsoft.com/fwlink/?LinkID=160057)."},{"pos":[1728,1741],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to complete this walkthrough:","pos":[1745,1808]},{"pos":[1885,1886],"content":"."},{"pos":[1895,1928],"content":"Hosting the Windows Forms Control","linkify":"Hosting the Windows Forms Control","nodes":[{"content":"Hosting the Windows Forms Control","pos":[0,33]}]},{"pos":[1939,1972],"content":"To host the MaskedTextBox control","linkify":"To host the MaskedTextBox control","nodes":[{"content":"To host the MaskedTextBox control","pos":[0,33]}]},{"pos":[1982,2071],"content":"Create a WPF Application project named                                  <ph id=\"ph1\">`HostingWfInWpf`</ph>.","source":"Create a WPF Application project named                                  `HostingWfInWpf`."},{"content":"Add references to the following assemblies.","pos":[2081,2124]},{"content":"WindowsFormsIntegration","pos":[2138,2161]},{"content":"System.Windows.Forms","pos":[2175,2195]},{"pos":[2205,2358],"content":"Open MainWindow.xaml in the                                  <ph id=\"ph1\">[!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]</ph>.","source":"Open MainWindow.xaml in the                                  [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]."},{"pos":[2368,2495],"content":"Name the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element                                  <ph id=\"ph2\">`grid1`</ph>.","source":"Name the                                  <xref:System.Windows.Controls.Grid> element                                  `grid1`."},{"content":"In Design view or XAML view, select the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> element.","pos":[2650,2760],"source":"In Design view or XAML view, select the                                  <xref:System.Windows.Window> element."},{"pos":[2770,2854],"content":"In the Properties window, click the                                  <bpt id=\"p1\">**</bpt>Events<ept id=\"p1\">**</ept> tab.","source":"In the Properties window, click the                                  **Events** tab."},{"content":"Double-click the                                  <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event.","pos":[2864,2966],"source":"Double-click the                                  <xref:System.Windows.FrameworkElement.Loaded> event."},{"content":"Insert the following code to handle the                                  <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event.","pos":[2976,3101],"source":"Insert the following code to handle the                                  <xref:System.Windows.FrameworkElement.Loaded> event."},{"pos":[3112,3408],"content":"[!code-csharp[HostingWfInWPF#10](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWPF/CSharp/HostingWfInWPF/Window1.xaml.cs#10)]\n [!code-vb[HostingWfInWPF#10](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HostingWfInWPF/VisualBasic/HostingWfInWpf/Window1.xaml.vb#10)]","leadings":["","    "],"nodes":[]},{"pos":[3417,3556],"content":"At the top of the file, add the following                                  <ph id=\"ph1\">`Imports`</ph> or                                  <ph id=\"ph2\">`using`</ph> statement.","source":"At the top of the file, add the following                                  `Imports` or                                  `using` statement."},{"pos":[3567,3863],"content":"[!code-csharp[HostingWfInWPF#11](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWPF/CSharp/HostingWfInWPF/Window1.xaml.cs#11)]\n  [!code-vb[HostingWfInWPF#11](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HostingWfInWPF/VisualBasic/HostingWfInWpf/Window1.xaml.vb#11)]","leadings":["","   "],"nodes":[]},{"content":"Press F5 to build and run the application.","pos":[3873,3915]},{"pos":[3924,3932],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph>","pos":[3936,3987],"source":"<xref:System.Windows.Forms.Integration.ElementHost> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph>","pos":[3992,4048],"source":"<xref:System.Windows.Forms.Integration.WindowsFormsHost> "},{"content":"<bpt id=\"p1\">[</bpt>WPF Designer<ept id=\"p1\">](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)</ept><ph id=\"ph1\"> </ph>","pos":[4053,4138],"source":"[WPF Designer](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-control-in-wpf-by-using-xaml.md)</ept><ph id=\"ph1\"> </ph>","pos":[4142,4319],"source":"[Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-control-in-wpf-by-using-xaml.md) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Composite Control in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)</ept><ph id=\"ph1\"> </ph>","pos":[4323,4492],"source":"[Walkthrough: Hosting a Windows Forms Composite Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a WPF Composite Control in Windows Forms<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)</ept><ph id=\"ph1\"> </ph>","pos":[4496,4665],"source":"[Walkthrough: Hosting a WPF Composite Control in Windows Forms](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md) "},{"content":"<bpt id=\"p1\">[</bpt>Windows Forms Controls and Equivalent WPF Controls<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/windows-forms-controls-and-equivalent-wpf-controls.md)</ept><ph id=\"ph1\"> </ph>","pos":[4669,4817],"source":"[Windows Forms Controls and Equivalent WPF Controls](../../../../docs/framework/wpf/advanced/windows-forms-controls-and-equivalent-wpf-controls.md) "},{"content":"<bpt id=\"p1\">[</bpt>Hosting a Windows Forms Control in WPF Sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=160057)</ept>","pos":[4821,4915],"source":"[Hosting a Windows Forms Control in WPF Sample](http://go.microsoft.com/fwlink/?LinkID=160057)"}]}