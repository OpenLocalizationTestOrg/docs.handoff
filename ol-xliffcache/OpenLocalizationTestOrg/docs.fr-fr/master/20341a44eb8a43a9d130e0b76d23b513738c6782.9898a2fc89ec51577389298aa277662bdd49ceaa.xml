{"content":"---\ntitle: \"Accessing Unexposed Members on the Managed HTML Document Object Model\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"unexposed members\"\n  - \"managed HTML DOM [Windows Forms], accessing unexposed members\"\nms.assetid: 762295bd-2355-4aa7-b43c-5bff997a33e6\n---\n# Accessing Unexposed Members on the Managed HTML Document Object Model\nThe managed HTML Document Object Model (DOM) contains a class called <xref:System.Windows.Forms.HtmlElement> that exposes the properties, methods, and events that all HTML elements have in common. Sometimes, however, you will need to access members that the managed interface does not directly expose. This topic examines two ways for accessing unexposed members, including [!INCLUDE[jsprjscript](../../../../includes/jsprjscript-md.md)] and VBScript functions defined inside of a Web page.  \n  \n## Accessing Unexposed Members through Managed Interfaces  \n <xref:System.Windows.Forms.HtmlDocument> and <xref:System.Windows.Forms.HtmlElement> provide four methods that enable access to unexposed members. The following table shows the types and their corresponding methods.  \n  \n|Member Type|Method(s)|  \n|-----------------|-----------------|  \n|Properties (<xref:System.Windows.Forms.HtmlElement>)|<xref:System.Windows.Forms.HtmlElement.GetAttribute%2A><br /><br /> <xref:System.Windows.Forms.HtmlElement.SetAttribute%2A>|  \n|Methods|<xref:System.Windows.Forms.HtmlElement.InvokeMember%2A>|  \n|Events (<xref:System.Windows.Forms.HtmlDocument>)|<xref:System.Windows.Forms.HtmlDocument.AttachEventHandler%2A><br /><br /> <xref:System.Windows.Forms.HtmlDocument.DetachEventHandler%2A>|  \n|Events (<xref:System.Windows.Forms.HtmlElement>)|<xref:System.Windows.Forms.HtmlElement.AttachEventHandler%2A><br /><br /> <xref:System.Windows.Forms.HtmlElement.DetachEventHandler%2A>|  \n|Events (<xref:System.Windows.Forms.HtmlWindow>)|<xref:System.Windows.Forms.HtmlWindow.AttachEventHandler%2A><br /><br /> <xref:System.Windows.Forms.HtmlWindow.DetachEventHandler%2A>|  \n  \n When you use these methods, it is assumed that you have an element of the correct underlying type. Suppose that you want to listen to the `Submit` event of a `FORM` element on an HTML page, so that you can perform some pre-processing on the `FORM`'s values before the user submits them to the server. Ideally, if you have control over the HTML, you would define the `FORM` to have a unique `ID` attribute.  \n  \n```  \n<HTML>  \n  \n    <HEAD>  \n        <TITLE>Form Page</TITLE>  \n    </HEAD>  \n  \n    <BODY>  \n        <FORM ID=\"form1\">  \n             ... form fields defined here ...  \n        </FORM>  \n    </BODY>  \n  \n</HTML>  \n```  \n  \n After you load this page into the <xref:System.Windows.Forms.WebBrowser> control, you can use the <xref:System.Windows.Forms.HtmlDocument.GetElementById%2A> method to retrieve the `FORM` at run time using `form1` as the argument.  \n  \n [!code-csharp[System.Windows.Forms.HtmlElement#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.HtmlElement/CS/Form1.cs#10)]\n [!code-vb[System.Windows.Forms.HtmlElement#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.HtmlElement/VB/Form1.vb#10)]  \n  \n## Accessing Unmanaged Interfaces  \n You can also access unexposed members on the managed HTML DOM by using the unmanaged Component Object Model (COM) interfaces exposed by each DOM class. This is recommended if you have to make several calls against unexposed members, or if the unexposed members return other unmanaged interfaces not wrapped by the managed HTML DOM.  \n  \n The following table shows all of the unmanaged interfaces exposed through the managed HTML DOM. Click on each link for an explanation of its usage and for example code.  \n  \n|Type|Unmanaged Interface|  \n|----------|-------------------------|  \n|<xref:System.Windows.Forms.HtmlDocument>|<xref:System.Windows.Forms.HtmlDocument.DomDocument%2A>|  \n|<xref:System.Windows.Forms.HtmlElement>|<xref:System.Windows.Forms.HtmlElement.DomElement%2A>|  \n|<xref:System.Windows.Forms.HtmlWindow>|<xref:System.Windows.Forms.HtmlWindow.DomWindow%2A>|  \n|<xref:System.Windows.Forms.HtmlHistory>|<xref:System.Windows.Forms.HtmlHistory.DomHistory%2A>|  \n  \n The easiest way to use the COM interfaces is to add a reference to the unmanaged HTML DOM library (MSHTML.dll) from your application, although this is unsupported. For more information, see [Knowledge Base Article 934368](https://support.microsoft.com/kb/934368).  \n  \n## Accessing Script Functions  \n An HTML page can define one or more functions by using a scripting language such as [!INCLUDE[jsprjscript](../../../../includes/jsprjscript-md.md)] or VBScript. These functions are placed inside of a `SCRIPT` page in the page, and can be run on demand or in response to an event on the DOM.  \n  \n You can call any script functions you define in an HTML page using the <xref:System.Windows.Forms.HtmlDocument.InvokeScript%2A> method. If the script method returns an HTML element, you can use a cast to convert this return result to an <xref:System.Windows.Forms.HtmlElement>. For details and example code, see <xref:System.Windows.Forms.HtmlDocument.InvokeScript%2A>.  \n  \n## See also\n\n- [Using the Managed HTML Document Object Model](using-the-managed-html-document-object-model.md)\n","nodes":[{"pos":[4,301],"embed":true,"restype":"x-metadata","content":"title: \"Accessing Unexposed Members on the Managed HTML Document Object Model\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"unexposed members\"\n  - \"managed HTML DOM [Windows Forms], accessing unexposed members\"\nms.assetid: 762295bd-2355-4aa7-b43c-5bff997a33e6","nodes":[{"content":"Accessing Unexposed Members on the Managed HTML Document Object Model","nodes":[{"pos":[0,69],"content":"Accessing Unexposed Members on the Managed HTML Document Object Model","nodes":[{"content":"Accessing Unexposed Members on the Managed HTML Document Object Model","pos":[0,69]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[308,377],"content":"Accessing Unexposed Members on the Managed HTML Document Object Model","linkify":"Accessing Unexposed Members on the Managed HTML Document Object Model","nodes":[{"content":"Accessing Unexposed Members on the Managed HTML Document Object Model","pos":[0,69]}]},{"content":"The managed HTML Document Object Model (DOM) contains a class called <ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlElement&gt;</ph> that exposes the properties, methods, and events that all HTML elements have in common.","pos":[378,574],"source":"The managed HTML Document Object Model (DOM) contains a class called <xref:System.Windows.Forms.HtmlElement> that exposes the properties, methods, and events that all HTML elements have in common."},{"content":"Sometimes, however, you will need to access members that the managed interface does not directly expose.","pos":[575,679]},{"content":"This topic examines two ways for accessing unexposed members, including <ph id=\"ph1\">[!INCLUDE[jsprjscript](../../../../includes/jsprjscript-md.md)]</ph> and VBScript functions defined inside of a Web page.","pos":[680,868],"source":" This topic examines two ways for accessing unexposed members, including [!INCLUDE[jsprjscript](../../../../includes/jsprjscript-md.md)] and VBScript functions defined inside of a Web page."},{"pos":[877,931],"content":"Accessing Unexposed Members through Managed Interfaces","linkify":"Accessing Unexposed Members through Managed Interfaces","nodes":[{"content":"Accessing Unexposed Members through Managed Interfaces","pos":[0,54]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlDocument&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.HtmlElement&gt;</ph> provide four methods that enable access to unexposed members.","pos":[935,1081],"source":"<xref:System.Windows.Forms.HtmlDocument> and <xref:System.Windows.Forms.HtmlElement> provide four methods that enable access to unexposed members."},{"content":"The following table shows the types and their corresponding methods.","pos":[1082,1150]},{"content":"Member Type","pos":[1157,1168]},{"content":"Method(s)","pos":[1169,1178]},{"pos":[1223,1275],"content":"Properties (<ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlElement&gt;</ph>)","source":"Properties (<xref:System.Windows.Forms.HtmlElement>)"},{"content":"Methods","pos":[1404,1411]},{"pos":[1472,1521],"content":"Events (<ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlDocument&gt;</ph>)","source":"Events (<xref:System.Windows.Forms.HtmlDocument>)"},{"pos":[1664,1712],"content":"Events (<ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlElement&gt;</ph>)","source":"Events (<xref:System.Windows.Forms.HtmlElement>)"},{"pos":[1853,1900],"content":"Events (<ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlWindow&gt;</ph>)","source":"Events (<xref:System.Windows.Forms.HtmlWindow>)"},{"content":"When you use these methods, it is assumed that you have an element of the correct underlying type.","pos":[2042,2140]},{"content":"Suppose that you want to listen to the <ph id=\"ph1\">`Submit`</ph> event of a <ph id=\"ph2\">`FORM`</ph> element on an HTML page, so that you can perform some pre-processing on the <ph id=\"ph3\">`FORM`</ph>'s values before the user submits them to the server.","pos":[2141,2342],"source":" Suppose that you want to listen to the `Submit` event of a `FORM` element on an HTML page, so that you can perform some pre-processing on the `FORM`'s values before the user submits them to the server."},{"content":"Ideally, if you have control over the HTML, you would define the <ph id=\"ph1\">`FORM`</ph> to have a unique <ph id=\"ph2\">`ID`</ph> attribute.","pos":[2343,2447],"source":" Ideally, if you have control over the HTML, you would define the `FORM` to have a unique `ID` attribute."},{"pos":[2680,2909],"content":"After you load this page into the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control, you can use the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.HtmlDocument.GetElementById%2A&gt;</ph> method to retrieve the <ph id=\"ph3\">`FORM`</ph> at run time using <ph id=\"ph4\">`form1`</ph> as the argument.","source":"After you load this page into the <xref:System.Windows.Forms.WebBrowser> control, you can use the <xref:System.Windows.Forms.HtmlDocument.GetElementById%2A> method to retrieve the `FORM` at run time using `form1` as the argument."},{"pos":[3222,3252],"content":"Accessing Unmanaged Interfaces","linkify":"Accessing Unmanaged Interfaces","nodes":[{"content":"Accessing Unmanaged Interfaces","pos":[0,30]}]},{"content":"You can also access unexposed members on the managed HTML DOM by using the unmanaged Component Object Model (COM) interfaces exposed by each DOM class.","pos":[3256,3407]},{"content":"This is recommended if you have to make several calls against unexposed members, or if the unexposed members return other unmanaged interfaces not wrapped by the managed HTML DOM.","pos":[3408,3587]},{"content":"The following table shows all of the unmanaged interfaces exposed through the managed HTML DOM.","pos":[3594,3689]},{"content":"Click on each link for an explanation of its usage and for example code.","pos":[3690,3762]},{"content":"Type","pos":[3769,3773]},{"content":"Unmanaged Interface","pos":[3774,3793]},{"content":"The easiest way to use the COM interfaces is to add a reference to the unmanaged HTML DOM library (MSHTML.dll) from your application, although this is unsupported.","pos":[4234,4397]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Knowledge Base Article 934368<ept id=\"p1\">](https://support.microsoft.com/kb/934368)</ept>.","pos":[4398,4497],"source":" For more information, see [Knowledge Base Article 934368](https://support.microsoft.com/kb/934368)."},{"pos":[4506,4532],"content":"Accessing Script Functions","linkify":"Accessing Script Functions","nodes":[{"content":"Accessing Script Functions","pos":[0,26]}]},{"content":"An HTML page can define one or more functions by using a scripting language such as <ph id=\"ph1\">[!INCLUDE[jsprjscript](../../../../includes/jsprjscript-md.md)]</ph> or VBScript.","pos":[4536,4696],"source":"An HTML page can define one or more functions by using a scripting language such as [!INCLUDE[jsprjscript](../../../../includes/jsprjscript-md.md)] or VBScript."},{"content":"These functions are placed inside of a <ph id=\"ph1\">`SCRIPT`</ph> page in the page, and can be run on demand or in response to an event on the DOM.","pos":[4697,4826],"source":" These functions are placed inside of a `SCRIPT` page in the page, and can be run on demand or in response to an event on the DOM."},{"content":"You can call any script functions you define in an HTML page using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlDocument.InvokeScript%2A&gt;</ph> method.","pos":[4833,4968],"source":"You can call any script functions you define in an HTML page using the <xref:System.Windows.Forms.HtmlDocument.InvokeScript%2A> method."},{"content":"If the script method returns an HTML element, you can use a cast to convert this return result to an <ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlElement&gt;</ph>.","pos":[4969,5110],"source":" If the script method returns an HTML element, you can use a cast to convert this return result to an <xref:System.Windows.Forms.HtmlElement>."},{"content":"For details and example code, see <ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlDocument.InvokeScript%2A&gt;</ph>.","pos":[5111,5202],"source":" For details and example code, see <xref:System.Windows.Forms.HtmlDocument.InvokeScript%2A>."},{"pos":[5211,5219],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5223,5318],"content":"<bpt id=\"p1\">[</bpt>Using the Managed HTML Document Object Model<ept id=\"p1\">](using-the-managed-html-document-object-model.md)</ept>","source":"[Using the Managed HTML Document Object Model](using-the-managed-html-document-object-model.md)"}]}