{"content":"---\ntitle: \"Order Processing with Policy | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 66833724-dc36-4fad-86b0-59ffeaa3ba6a\ncaps.latest.revision: 8\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Order Processing with Policy\nThe Order Processing Policy sample demonstrates some of the key features introduced in the [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] of the Windows Workflow Foundation (WF). The following functionality is new for the WF rules engine:  \n  \n-   Support for operator overloading.  \n  \n-   Support for the `new` operator, allowing users to create new objects and arrays from WF rules.  \n  \n-   Support for extension methods to make the user experience in calling extension methods from WF rules compatible with C# coding styles.  \n  \n> [!NOTE]\n>  This sample requires that [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] is installed to build and run. [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] is required to open the project and solution files.  \n  \n The sample demonstrates an `OrderProcessingPolicy` project in which a customer order, which consists of a numbered list of available items and a zip code, is entered. The order is processed successfully if both entries are correct; otherwise, the policy creates error objects, utilizing an overloaded `+` operator and a predefined extension method to inform the user of the errors.  \n  \n> [!NOTE]\n>  [!INCLUDE[crabout](../../../../includes/crabout-md.md)] extension methods, see [C# Version 3.0 Specification](http://go.microsoft.com/fwlink/?LinkId=95402).  \n  \n The sample is comprised of the following projects:  \n  \n-   `OrderErrorLibrary`  \n  \n     The `OrderErrorLibrary` is a class library that defines `OrderError` and `OrderErrorCollection` classes. An `OrderError` instance is created when an invalid input is entered. The library also provides an extension method on the `OrderErrorCollection` class that outputs the `ErrorText` property on all `OrderError` objects in the `OrderErrorCollection`.  \n  \n-   `OrderProcessingPolicy`  \n  \n     The `OrderProcessingPolicy` project is a WF console application that defines a single `PolicyFromFile` activity. The activity has the following rules:  \n  \n    -   `invalidItemNum`  \n  \n         This rule validates that the item number is between 1 and 6, inclusive. If the item number is within the valid range, the rule does nothing (other than printing to the console). If the item number is not between 1 and 6, the `invalidItemNum` rule does the following:  \n  \n        1.  Creates a new `OrderError` object, passing it the item number entered, and sets the `ErrorText` and `CustomerName` properties on the object.  \n  \n        2.  Creates an `invalidItemNumErrorCollection` object.  \n  \n        3.  Adds the newly-created `OrderError` instance to the `invalidItemNumErrorCollection`.  \n  \n         This demonstrates support for the `new` operator, with which you can instantiate objects inside rules.  \n  \n    -   `invalidZip`  \n  \n         This rule validates that the zip code has 5 digits, and is within the range 600 to 99998. If the zip code is within the valid range, the rule does nothing (other than printing to the console). If the length of the zip code is less than 5, or the zip code is not between 00600 and 99998, the `invalidZip` rule does the following:  \n  \n        1.  Creates an `OrderError` object, passing it the zip code entered, and sets the `ErrorText` and `CustomerName` properties on the object.  \n  \n        2.  Creates an `invalidZipCodeErrorCollection` object.  \n  \n        3.  Adds the newly-created `OrderError` instance to the newly-created `invalidZipCodeErrorCollection`.  \n  \n         This rule again demonstrates support for the `new` operator, which allows you to instantiate objects inside rules.  \n  \n    -   `displayErrors`  \n  \n         This rule checks to see if there were any errors added by the previous two rules in the two `OrderErrorCollection` objects `invalidItemNumErrorCollection` and `invalidIZipCodeErrorCollection`. If there were errors (either `invalidItemNumErrorCollection` or `invalidZipCodeErrorCollection` is not `null`), the rule does the following:  \n  \n        1.  Calls the overloaded `+` operator to copy the contents of `invalidItemNumErrorCollection` and `invalidZipCodeErrorCollection` to an `invalidOrdersCollection``OrderErrorCollection` instance.  \n  \n        2.  Calls the `PrintOrderErrors` extension method on `invalidOrdersCollection` and outputs the `ErrorText` property on all `orderError` objects in `invalidOrdersCollection`.  \n  \n The overloaded operator `+` on the `OrderErrorCollection` is defined in the `OrderErrorCollection` class, in the `OrderErrorLibrary` project. It takes two `OrderErrorCollection` objects and combines them into one `OrderErrorCollection` object.  \n  \n The `PrintOrderErrors` extension method is also defined in the `OrderErrorLibrary` project. Extension methods are a new C# feature that enables developers to add new methods to the public contract of an existing CLR type, without having to derive a class from it or recompile the original type.  \n  \n When you run the sample you are prompted to enter a name, the item number of the item to be purchased, and a zip code. This information is then verified by the rules defined in the policy activity. The following is sample output from the program.  \n  \n```  \nPlease enter your name: John  \n  \nWhat would you like to purchase?  \n        (1) Vista Ultimate DVD  \n        (2) Vista Ultimate Upgrade DVD  \n        (3) Vista Home Premium DVD  \n        (4) Vista Home Premium Upgrade DVD  \n        (5) Vista Home Basic DVD  \n        (6) Vista Home Basic Upgrade DVD  \n  \nPlease enter an item number: 1  \n  \nPlease enter your 5-Digit zip code: 98102  \n  \n        Executing Rule: invalidItemNum  \n        Executing Rule: invalidZip  \n        Executing Rule: displayErrors  \n  \n                              Thank you for your order, it has been processed.  \n  \nWorkflow Completed  \nAnother Order? (Y/N): y  \n  \nPlease enter your name: Joel  \n  \nWhat would you like to purchase?  \n        (1) Vista Ultimate DVD  \n        (2) Vista Ultimate Upgrade DVD  \n        (3) Vista Home Premium DVD  \n        (4) Vista Home Premium Upgrade DVD  \n        (5) Vista Home Basic DVD  \n        (6) Vista Home Basic Upgrade DVD  \n  \nPlease enter an item number: 8  \n  \nPlease enter your 5-Digit zip code: 0000  \n  \n        Executing Rule: invalidItemNum  \n        Executing Rule: invalidZip  \n        Executing Rule: displayErrors  \n  \n                              Your order contains the following error(s)  \n  \nError: No item number found. Please choose an available item.  \nError: Invalid zip code. Please choose a zip code between 00600 and 99998.  \n  \nWorkflow Completed  \nAnother Order? (Y/N): n  \n```  \n  \n### To set up, build, and run the sample  \n  \n1.  Open the OrderProcessingPolicy.sln project file in [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)].  \n  \n2.  There are two different projects in the solution: `OrderErrorLibrary` and `OrderProcessingPolicy`. The `OrderProcessingPolicy` project uses classes and methods defined in the `OrderErrorLibrary`.  \n  \n3.  Build all projects.  \n  \n4.  Click **Run**.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your computer. Check for the following (default) directory before continuing:  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory:  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\Rules\\Policy\\OrderProcessingPolicy`  \n  \n## See Also","nodes":[{"pos":[4,315],"nodes":[{"content":"Order Processing with Policy | Microsoft Docs","nodes":[{"pos":[0,45],"content":"Order Processing with Policy | Microsoft Docs","nodes":[{"content":"Order Processing with Policy | Microsoft Docs","pos":[0,45]}]}],"pos":[6,54],"yaml":true}],"content":"title: \"Order Processing with Policy | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 66833724-dc36-4fad-86b0-59ffeaa3ba6a\ncaps.latest.revision: 8\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","yamlblock":true},{"pos":[322,350],"content":"Order Processing with Policy","linkify":"Order Processing with Policy","nodes":[{"content":"Order Processing with Policy","pos":[0,28]}]},{"content":"The Order Processing Policy sample demonstrates some of the key features introduced in the <ph id=\"ph1\">[!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)]</ph> of the Windows Workflow Foundation (WF).","pos":[351,548],"source":"The Order Processing Policy sample demonstrates some of the key features introduced in the [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] of the Windows Workflow Foundation (WF)."},{"content":"The following functionality is new for the WF rules engine:","pos":[549,608]},{"content":"Support for operator overloading.","pos":[618,651]},{"pos":[661,755],"content":"Support for the <ph id=\"ph1\">`new`</ph> operator, allowing users to create new objects and arrays from WF rules.","source":"Support for the `new` operator, allowing users to create new objects and arrays from WF rules."},{"content":"Support for extension methods to make the user experience in calling extension methods from WF rules compatible with C# coding styles.","pos":[765,899]},{"pos":[907,1164],"content":"[!NOTE]\n This sample requires that [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] is installed to build and run. [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] is required to open the project and solution files.","leadings":["","> "],"nodes":[{"content":"This sample requires that [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] is installed to build and run. [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] is required to open the project and solution files.","pos":[9,255],"nodes":[{"content":"This sample requires that <ph id=\"ph1\">[!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)]</ph> is installed to build and run.","pos":[0,122],"source":"This sample requires that [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] is installed to build and run."},{"content":"<ph id=\"ph1\">[!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)]</ph> is required to open the project and solution files.","pos":[123,246],"source":"[!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] is required to open the project and solution files."}]}]},{"content":"The sample demonstrates an <ph id=\"ph1\">`OrderProcessingPolicy`</ph> project in which a customer order, which consists of a numbered list of available items and a zip code, is entered.","pos":[1171,1337],"source":"The sample demonstrates an `OrderProcessingPolicy` project in which a customer order, which consists of a numbered list of available items and a zip code, is entered."},{"content":"The order is processed successfully if both entries are correct; otherwise, the policy creates error objects, utilizing an overloaded <ph id=\"ph1\">`+`</ph> operator and a predefined extension method to inform the user of the errors.","pos":[1338,1552],"source":" The order is processed successfully if both entries are correct; otherwise, the policy creates error objects, utilizing an overloaded `+` operator and a predefined extension method to inform the user of the errors."},{"pos":[1560,1727],"content":"[!NOTE]\n [!INCLUDE[crabout](../../../../includes/crabout-md.md)] extension methods, see [C# Version 3.0 Specification](http://go.microsoft.com/fwlink/?LinkId=95402).","leadings":["","> "],"nodes":[{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> extension methods, see <bpt id=\"p1\">[</bpt>C# Version 3.0 Specification<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=95402)</ept>.","pos":[9,165],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] extension methods, see [C# Version 3.0 Specification](http://go.microsoft.com/fwlink/?LinkId=95402)."}]},{"content":"The sample is comprised of the following projects:","pos":[1734,1784]},{"content":"The <ph id=\"ph1\">`OrderErrorLibrary`</ph> is a class library that defines <ph id=\"ph2\">`OrderError`</ph> and <ph id=\"ph3\">`OrderErrorCollection`</ph> classes.","pos":[1824,1928],"source":"The `OrderErrorLibrary` is a class library that defines `OrderError` and `OrderErrorCollection` classes."},{"content":"An <ph id=\"ph1\">`OrderError`</ph> instance is created when an invalid input is entered.","pos":[1929,1998],"source":" An `OrderError` instance is created when an invalid input is entered."},{"content":"The library also provides an extension method on the <ph id=\"ph1\">`OrderErrorCollection`</ph> class that outputs the <ph id=\"ph2\">`ErrorText`</ph> property on all <ph id=\"ph3\">`OrderError`</ph> objects in the <ph id=\"ph4\">`OrderErrorCollection`</ph>.","pos":[1999,2177],"source":" The library also provides an extension method on the `OrderErrorCollection` class that outputs the `ErrorText` property on all `OrderError` objects in the `OrderErrorCollection`."},{"content":"The <ph id=\"ph1\">`OrderProcessingPolicy`</ph> project is a WF console application that defines a single <ph id=\"ph2\">`PolicyFromFile`</ph> activity.","pos":[2221,2333],"source":"The `OrderProcessingPolicy` project is a WF console application that defines a single `PolicyFromFile` activity."},{"content":"The activity has the following rules:","pos":[2334,2371]},{"content":"This rule validates that the item number is between 1 and 6, inclusive.","pos":[2416,2487]},{"content":"If the item number is within the valid range, the rule does nothing (other than printing to the console).","pos":[2488,2593]},{"content":"If the item number is not between 1 and 6, the <ph id=\"ph1\">`invalidItemNum`</ph> rule does the following:","pos":[2594,2682],"source":" If the item number is not between 1 and 6, the `invalidItemNum` rule does the following:"},{"pos":[2700,2840],"content":"Creates a new <ph id=\"ph1\">`OrderError`</ph> object, passing it the item number entered, and sets the <ph id=\"ph2\">`ErrorText`</ph> and <ph id=\"ph3\">`CustomerName`</ph> properties on the object.","source":"Creates a new `OrderError` object, passing it the item number entered, and sets the `ErrorText` and `CustomerName` properties on the object."},{"pos":[2858,2908],"content":"Creates an <ph id=\"ph1\">`invalidItemNumErrorCollection`</ph> object.","source":"Creates an `invalidItemNumErrorCollection` object."},{"pos":[2926,3010],"content":"Adds the newly-created <ph id=\"ph1\">`OrderError`</ph> instance to the <ph id=\"ph2\">`invalidItemNumErrorCollection`</ph>.","source":"Adds the newly-created `OrderError` instance to the `invalidItemNumErrorCollection`."},{"pos":[3025,3127],"content":"This demonstrates support for the <ph id=\"ph1\">`new`</ph> operator, with which you can instantiate objects inside rules.","source":"This demonstrates support for the `new` operator, with which you can instantiate objects inside rules."},{"content":"This rule validates that the zip code has 5 digits, and is within the range 600 to 99998.","pos":[3168,3257]},{"content":"If the zip code is within the valid range, the rule does nothing (other than printing to the console).","pos":[3258,3360]},{"content":"If the length of the zip code is less than 5, or the zip code is not between 00600 and 99998, the <ph id=\"ph1\">`invalidZip`</ph> rule does the following:","pos":[3361,3496],"source":" If the length of the zip code is less than 5, or the zip code is not between 00600 and 99998, the `invalidZip` rule does the following:"},{"pos":[3514,3648],"content":"Creates an <ph id=\"ph1\">`OrderError`</ph> object, passing it the zip code entered, and sets the <ph id=\"ph2\">`ErrorText`</ph> and <ph id=\"ph3\">`CustomerName`</ph> properties on the object.","source":"Creates an `OrderError` object, passing it the zip code entered, and sets the `ErrorText` and `CustomerName` properties on the object."},{"pos":[3666,3716],"content":"Creates an <ph id=\"ph1\">`invalidZipCodeErrorCollection`</ph> object.","source":"Creates an `invalidZipCodeErrorCollection` object."},{"pos":[3734,3832],"content":"Adds the newly-created <ph id=\"ph1\">`OrderError`</ph> instance to the newly-created <ph id=\"ph2\">`invalidZipCodeErrorCollection`</ph>.","source":"Adds the newly-created `OrderError` instance to the newly-created `invalidZipCodeErrorCollection`."},{"pos":[3847,3961],"content":"This rule again demonstrates support for the <ph id=\"ph1\">`new`</ph> operator, which allows you to instantiate objects inside rules.","source":"This rule again demonstrates support for the `new` operator, which allows you to instantiate objects inside rules."},{"content":"This rule checks to see if there were any errors added by the previous two rules in the two <ph id=\"ph1\">`OrderErrorCollection`</ph> objects <ph id=\"ph2\">`invalidItemNumErrorCollection`</ph> and <ph id=\"ph3\">`invalidIZipCodeErrorCollection`</ph>.","pos":[4005,4197],"source":"This rule checks to see if there were any errors added by the previous two rules in the two `OrderErrorCollection` objects `invalidItemNumErrorCollection` and `invalidIZipCodeErrorCollection`."},{"content":"If there were errors (either <ph id=\"ph1\">`invalidItemNumErrorCollection`</ph> or <ph id=\"ph2\">`invalidZipCodeErrorCollection`</ph> is not <ph id=\"ph3\">`null`</ph>), the rule does the following:","pos":[4198,4338],"source":" If there were errors (either `invalidItemNumErrorCollection` or `invalidZipCodeErrorCollection` is not `null`), the rule does the following:"},{"pos":[4356,4545],"content":"Calls the overloaded <ph id=\"ph1\">`+`</ph> operator to copy the contents of <ph id=\"ph2\">`invalidItemNumErrorCollection`</ph> and <ph id=\"ph3\">`invalidZipCodeErrorCollection`</ph> to an <ph id=\"ph4\">`invalidOrdersCollection``OrderErrorCollection`</ph> instance.","source":"Calls the overloaded `+` operator to copy the contents of `invalidItemNumErrorCollection` and `invalidZipCodeErrorCollection` to an `invalidOrdersCollection``OrderErrorCollection` instance."},{"pos":[4563,4732],"content":"Calls the <ph id=\"ph1\">`PrintOrderErrors`</ph> extension method on <ph id=\"ph2\">`invalidOrdersCollection`</ph> and outputs the <ph id=\"ph3\">`ErrorText`</ph> property on all <ph id=\"ph4\">`orderError`</ph> objects in <ph id=\"ph5\">`invalidOrdersCollection`</ph>.","source":"Calls the `PrintOrderErrors` extension method on `invalidOrdersCollection` and outputs the `ErrorText` property on all `orderError` objects in `invalidOrdersCollection`."},{"content":"The overloaded operator <ph id=\"ph1\">`+`</ph> on the <ph id=\"ph2\">`OrderErrorCollection`</ph> is defined in the <ph id=\"ph3\">`OrderErrorCollection`</ph> class, in the <ph id=\"ph4\">`OrderErrorLibrary`</ph> project.","pos":[4739,4880],"source":"The overloaded operator `+` on the `OrderErrorCollection` is defined in the `OrderErrorCollection` class, in the `OrderErrorLibrary` project."},{"content":"It takes two <ph id=\"ph1\">`OrderErrorCollection`</ph> objects and combines them into one <ph id=\"ph2\">`OrderErrorCollection`</ph> object.","pos":[4881,4982],"source":" It takes two `OrderErrorCollection` objects and combines them into one `OrderErrorCollection` object."},{"content":"The <ph id=\"ph1\">`PrintOrderErrors`</ph> extension method is also defined in the <ph id=\"ph2\">`OrderErrorLibrary`</ph> project.","pos":[4989,5080],"source":"The `PrintOrderErrors` extension method is also defined in the `OrderErrorLibrary` project."},{"content":"Extension methods are a new C# feature that enables developers to add new methods to the public contract of an existing CLR type, without having to derive a class from it or recompile the original type.","pos":[5081,5283]},{"content":"When you run the sample you are prompted to enter a name, the item number of the item to be purchased, and a zip code.","pos":[5290,5408]},{"content":"This information is then verified by the rules defined in the policy activity.","pos":[5409,5487]},{"content":"The following is sample output from the program.","pos":[5488,5536]},{"pos":[6983,7019],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"pos":[7029,7134],"content":"Open the OrderProcessingPolicy.sln project file in <ph id=\"ph1\">[!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]</ph>.","source":"Open the OrderProcessingPolicy.sln project file in [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]."},{"content":"There are two different projects in the solution: <ph id=\"ph1\">`OrderErrorLibrary`</ph> and <ph id=\"ph2\">`OrderProcessingPolicy`</ph>.","pos":[7144,7242],"source":"There are two different projects in the solution: `OrderErrorLibrary` and `OrderProcessingPolicy`."},{"content":"The <ph id=\"ph1\">`OrderProcessingPolicy`</ph> project uses classes and methods defined in the <ph id=\"ph2\">`OrderErrorLibrary`</ph>.","pos":[7243,7339],"source":" The `OrderProcessingPolicy` project uses classes and methods defined in the `OrderErrorLibrary`."},{"content":"Build all projects.","pos":[7349,7368]},{"pos":[7378,7392],"content":"Click <bpt id=\"p1\">**</bpt>Run<ept id=\"p1\">**</ept>.","source":"Click **Run**."},{"pos":[7400,7533],"content":"[!IMPORTANT]\n The samples may already be installed on your computer. Check for the following (default) directory before continuing:","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your computer. Check for the following (default) directory before continuing:","pos":[14,131],"nodes":[{"content":"The samples may already be installed on your computer.","pos":[0,54]},{"content":"Check for the following (default) directory before continuing:","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[7587,7913],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory:","pos":[7914,7964]},{"pos":[8060,8068],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]}]}