{"content":"---\ntitle: \"How to: Generate Text Files from XML (C#)\"\nms.date: 07/20/2015\nms.assetid: 9ad283f7-7cac-42ff-bf32-92aa866e6883\n---\n# How to: Generate Text Files from XML (C#)\nThis example shows how to generate a comma-separated values (CSV) file from an XML file.  \n  \n## Example  \n The C# version of this example uses method syntax and the `Aggregate` operator to generate a CSV file from an XML document in a single expression. For more information, see [Query Syntax and Method Syntax in LINQ](../../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md).  \n  \n This example uses the following XML document: [Sample XML File: Customers and Orders (LINQ to XML)](../../../../csharp/programming-guide/concepts/linq/sample-xml-file-customers-and-orders-linq-to-xml-2.md).  \n  \n```csharp  \nXElement custOrd = XElement.Load(\"CustomersOrders.xml\");  \nstring csv =  \n    (from el in custOrd.Element(\"Customers\").Elements(\"Customer\")  \n    select  \n        String.Format(\"{0},{1},{2},{3},{4},{5},{6},{7},{8},{9}{10}\",  \n            (string)el.Attribute(\"CustomerID\"),  \n            (string)el.Element(\"CompanyName\"),  \n            (string)el.Element(\"ContactName\"),  \n            (string)el.Element(\"ContactTitle\"),  \n            (string)el.Element(\"Phone\"),  \n            (string)el.Element(\"FullAddress\").Element(\"Address\"),  \n            (string)el.Element(\"FullAddress\").Element(\"City\"),  \n            (string)el.Element(\"FullAddress\").Element(\"Region\"),  \n            (string)el.Element(\"FullAddress\").Element(\"PostalCode\"),  \n            (string)el.Element(\"FullAddress\").Element(\"Country\"),  \n            Environment.NewLine  \n        )  \n    )  \n    .Aggregate(  \n        new StringBuilder(),  \n        (sb, s) => sb.Append(s),  \n        sb => sb.ToString()  \n    );  \nConsole.WriteLine(csv);  \n```  \n  \n This code produces the following output:  \n  \n```  \nGREAL,Great Lakes Food Market,Howard Snyder,Marketing Manager,(503) 555-7555,2732 Baker Blvd.,Eugene,OR,97403,USA  \nHUNGC,Hungry Coyote Import Store,Yoshi Latimer,Sales Representative,(503) 555-6874,City Center Plaza 516 Main St.,Elgin,OR,97827,USA  \nLAZYK,Lazy K Kountry Store,John Steel,Marketing Manager,(509) 555-7969,12 Orchestra Terrace,Walla Walla,WA,99362,USA  \nLETSS,Let's Stop N Shop,Jaime Yorres,Owner,(415) 555-5938,87 Polk St. Suite 5,San Francisco,CA,94117,USA  \n```  \n  \n## See also\n\n- [Projections and Transformations (LINQ to XML) (C#)](../../../../csharp/programming-guide/concepts/linq/projections-and-transformations-linq-to-xml.md)\n","nodes":[{"pos":[4,123],"embed":true,"restype":"x-metadata","content":"title: \"How to: Generate Text Files from XML (C#)\"\nms.date: 07/20/2015\nms.assetid: 9ad283f7-7cac-42ff-bf32-92aa866e6883","nodes":[{"content":"How to: Generate Text Files from XML (C#)","nodes":[{"pos":[0,41],"content":"How to: Generate Text Files from XML (C#)","nodes":[{"content":"How to: Generate Text Files from XML (C#)","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[130,171],"content":"How to: Generate Text Files from XML (C#)","linkify":"How to: Generate Text Files from XML (C#)","nodes":[{"content":"How to: Generate Text Files from XML (C#)","pos":[0,41]}]},{"content":"This example shows how to generate a comma-separated values (CSV) file from an XML file.","pos":[172,260]},{"pos":[269,276],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The C# version of this example uses method syntax and the <ph id=\"ph1\">`Aggregate`</ph> operator to generate a CSV file from an XML document in a single expression.","pos":[280,426],"source":"The C# version of this example uses method syntax and the `Aggregate` operator to generate a CSV file from an XML document in a single expression."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Query Syntax and Method Syntax in LINQ<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md)</ept>.","pos":[427,588],"source":" For more information, see [Query Syntax and Method Syntax in LINQ](../../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md)."},{"pos":[595,801],"content":"This example uses the following XML document: <bpt id=\"p1\">[</bpt>Sample XML File: Customers and Orders (LINQ to XML)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/sample-xml-file-customers-and-orders-linq-to-xml-2.md)</ept>.","source":"This example uses the following XML document: [Sample XML File: Customers and Orders (LINQ to XML)](../../../../csharp/programming-guide/concepts/linq/sample-xml-file-customers-and-orders-linq-to-xml-2.md)."},{"content":"This code produces the following output:","pos":[1838,1878]},{"pos":[2379,2387],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2391,2542],"content":"<bpt id=\"p1\">[</bpt>Projections and Transformations (LINQ to XML) (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/projections-and-transformations-linq-to-xml.md)</ept>","source":"[Projections and Transformations (LINQ to XML) (C#)](../../../../csharp/programming-guide/concepts/linq/projections-and-transformations-linq-to-xml.md)"}]}