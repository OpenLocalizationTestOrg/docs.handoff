{"content":"---\ntitle: \"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: edacbcd3-f3e4-4429-a8be-28a58dc0dd70\n---\n# How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)\nThis example shows how to query over all the files in a specified directory tree, open each file, and inspect its contents. This type of technique could be used to create indexes or reverse indexes of the contents of a directory tree. A simple string search is performed in this example. However, more complex types of pattern matching can be performed with a regular expression. For more information, see [How to: Combine LINQ Queries with Regular Expressions (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/how-to-combine-linq-queries-with-regular-expressions.md).  \n  \n## Example  \n  \n```vb  \nModule Module1  \n    'QueryContents  \n    Public Sub Main()  \n  \n        ' Modify this path as necessary.  \n        Dim startFolder = \"c:\\program files\\Microsoft Visual Studio 9.0\\VB\\\"  \n  \n        'Take a snapshot of the folder contents  \n        Dim dir As New System.IO.DirectoryInfo(startFolder)  \n        Dim fileList = dir.GetFiles(\"*.*\", System.IO.SearchOption.AllDirectories)  \n  \n        Dim searchTerm = \"Visual Studio\"  \n  \n        ' Search the contents of each file.  \n        ' A regular expression created with the RegEx class  \n        ' could be used instead of the Contains method.  \n        Dim queryMatchingFiles = From file In fileList _  \n                                 Where file.Extension = \".htm\" _  \n                                 Let fileText = GetFileText(file.FullName) _  \n                                 Where fileText.Contains(searchTerm) _  \n                                 Select file.FullName  \n  \n        Console.WriteLine(\"The term \" & searchTerm & \" was found in:\")  \n  \n        ' Execute the query.  \n        For Each filename In queryMatchingFiles  \n            Console.WriteLine(filename)  \n        Next  \n  \n        ' Keep the console window open in debug mode.  \n        Console.WriteLine(\"Press any key to exit\")  \n        Console.ReadKey()  \n  \n    End Sub  \n  \n    ' Read the contents of the file. This is done in a separate  \n    ' function in order to handle potential file system errors.  \n    Function GetFileText(ByVal name As String) As String  \n  \n        ' If the file has been deleted, the right thing  \n        ' to do in this case is return an empty string.  \n        Dim fileContents = String.Empty  \n  \n        ' If the file has been deleted since we took   \n        ' the snapshot, ignore it and return the empty string.  \n        If System.IO.File.Exists(name) Then  \n            fileContents = System.IO.File.ReadAllText(name)  \n        End If  \n  \n        Return fileContents  \n  \n    End Function  \nEnd Module  \n```  \n  \n## Compiling the Code  \n Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a `Imports` statement for the System.Linq namespace.  \n  \n## See also\n\n- [LINQ to Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)\n- [LINQ and File Directories (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)\n","nodes":[{"pos":[4,151],"embed":true,"restype":"x-metadata","content":"title: \"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: edacbcd3-f3e4-4429-a8be-28a58dc0dd70","nodes":[{"content":"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)","nodes":[{"pos":[0,69],"content":"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)","nodes":[{"content":"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)","pos":[0,69]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[158,227],"content":"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)","linkify":"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)","nodes":[{"content":"How to: Query the Contents of Files in a Folder (LINQ) (Visual Basic)","pos":[0,69]}]},{"content":"This example shows how to query over all the files in a specified directory tree, open each file, and inspect its contents.","pos":[228,351]},{"content":"This type of technique could be used to create indexes or reverse indexes of the contents of a directory tree.","pos":[352,462]},{"content":"A simple string search is performed in this example.","pos":[463,515]},{"content":"However, more complex types of pattern matching can be performed with a regular expression.","pos":[516,607]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Combine LINQ Queries with Regular Expressions (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/how-to-combine-linq-queries-with-regular-expressions.md)</ept>.","pos":[608,819],"source":" For more information, see [How to: Combine LINQ Queries with Regular Expressions (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/how-to-combine-linq-queries-with-regular-expressions.md)."},{"pos":[828,835],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2842,2860],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[2864,3027],"content":"Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a <ph id=\"ph1\">`Imports`</ph> statement for the System.Linq namespace.","source":"Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a `Imports` statement for the System.Linq namespace."},{"pos":[3036,3044],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3048,3157],"content":"<bpt id=\"p1\">[</bpt>LINQ to Objects (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)</ept>","source":"[LINQ to Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)"},{"pos":[3160,3289],"content":"<bpt id=\"p1\">[</bpt>LINQ and File Directories (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)</ept>","source":"[LINQ and File Directories (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)"}]}