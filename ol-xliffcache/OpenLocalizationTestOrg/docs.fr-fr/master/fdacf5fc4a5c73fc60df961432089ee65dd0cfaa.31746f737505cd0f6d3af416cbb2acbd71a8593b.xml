{"content":"---\ntitle: \"Mitigation: WCF Services and Certificate Authentication\"\nms.date: \"03/30/2017\"\nms.assetid: ef19c91a-b9df-4bf0-a28e-eb1e99c4bc95\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# Mitigation: WCF Services and Certificate Authentication\nThe .NET Framework 4.6 adds TLS 1.1 and TLS 1.2 to the WCF SSL protocol default list. When both client and server machines have  the .NET Framework 4.6 or later installed, TLS 1.2 is used for negotiation.  \n  \n## Impact  \n TLS 1.2 does not support MD5 certificate authentication. As a result, if a customer uses an SSL  certificate which uses MD5 for the hash algorithm, the WCF client fails to connect to the WCF service. For more information, see [Mitigation: WCF Services and Certificate Authentication](../../../docs/framework/migration-guide/mitigation-wcf-services-and-certificate-authentication.md).  \n  \n## Mitigation  \n You can work around this issue so that a WCF client can connect to a WCF server by doing any of the following:  \n  \n-   Update the certificate to not use the MD5 algorithm. This is the recommended solution.  \n  \n-   If the binding is not dynamically configured in source code, update the application's configuration file to use TLS 1.1 or an earlier version of the protocol. This allows you to continue to use a certificate with the MD5 hash algorithm.  \n  \n    > [!CAUTION]\n    >  This workaround is not recommended, since a certificate with the MD5 hash algorithm is considered insecure.  \n  \n     The following configuration file does this:  \n  \n    ```xml  \n    <configuration>  \n        <system.serviceModel>  \n            <bindings>  \n                <netTcpBinding>  \n                    <binding>  \n                        <security mode= \"None|Transport|Message|TransportWithMessageCredential\" >  \n                            <transport clientCredentialType=\"None|Windows|Certificate\"  \n                                                protectionLevel=\"None|Sign|EncryptAndSign\"  \n                                                sslProtocols=\"Ssl3|Tls1|Tls11\">  \n                            </transport>  \n                        </security>  \n                    </binding>  \n                </netTcpBinding>  \n            </bindings>  \n        </system.ServiceModel>  \n    </configuration>  \n    ```  \n  \n-   If the binding is dynamically configured in source code, update the <xref:System.ServiceModel.TcpTransportSecurity.SslProtocols%2A?displayProperty=nameWithType> property to use TLS 1.1 (<xref:System.Security.Authentication.SslProtocols.Tls11?displayProperty=nameWithType>) or an  earlier version of the protocol in the source code.  \n  \n    > [!CAUTION]\n    >  This workaround is not recommended, since a certificate with the MD5 hash algorithm is considered insecure.  \n  \n## See also\n\n- [Runtime Changes](../../../docs/framework/migration-guide/runtime-changes-in-the-net-framework-4-6.md)\n","nodes":[{"pos":[4,179],"embed":true,"restype":"x-metadata","content":"title: \"Mitigation: WCF Services and Certificate Authentication\"\nms.date: \"03/30/2017\"\nms.assetid: ef19c91a-b9df-4bf0-a28e-eb1e99c4bc95\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"Mitigation: WCF Services and Certificate Authentication","nodes":[{"pos":[0,55],"content":"Mitigation: WCF Services and Certificate Authentication","nodes":[{"content":"Mitigation: WCF Services and Certificate Authentication","pos":[0,55]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[186,241],"content":"Mitigation: WCF Services and Certificate Authentication","linkify":"Mitigation: WCF Services and Certificate Authentication","nodes":[{"content":"Mitigation: WCF Services and Certificate Authentication","pos":[0,55]}]},{"content":"The .NET Framework 4.6 adds TLS 1.1 and TLS 1.2 to the WCF SSL protocol default list.","pos":[242,327]},{"content":"When both client and server machines have  the .NET Framework 4.6 or later installed, TLS 1.2 is used for negotiation.","pos":[328,446]},{"pos":[455,461],"content":"Impact","linkify":"Impact","nodes":[{"content":"Impact","pos":[0,6]}]},{"content":"TLS 1.2 does not support MD5 certificate authentication.","pos":[465,521]},{"content":"As a result, if a customer uses an SSL  certificate which uses MD5 for the hash algorithm, the WCF client fails to connect to the WCF service.","pos":[522,664]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Mitigation: WCF Services and Certificate Authentication<ept id=\"p1\">](../../../docs/framework/migration-guide/mitigation-wcf-services-and-certificate-authentication.md)</ept>.","pos":[665,848],"source":" For more information, see [Mitigation: WCF Services and Certificate Authentication](../../../docs/framework/migration-guide/mitigation-wcf-services-and-certificate-authentication.md)."},{"pos":[857,867],"content":"Mitigation","linkify":"Mitigation","nodes":[{"content":"Mitigation","pos":[0,10]}]},{"content":"You can work around this issue so that a WCF client can connect to a WCF server by doing any of the following:","pos":[871,981]},{"content":"Update the certificate to not use the MD5 algorithm.","pos":[991,1043]},{"content":"This is the recommended solution.","pos":[1044,1077]},{"content":"If the binding is not dynamically configured in source code, update the application's configuration file to use TLS 1.1 or an earlier version of the protocol.","pos":[1087,1245]},{"content":"This allows you to continue to use a certificate with the MD5 hash algorithm.","pos":[1246,1323]},{"pos":[1335,1460],"content":"[!CAUTION]\nThis workaround is not recommended, since a certificate with the MD5 hash algorithm is considered insecure.","leadings":["","    >  "],"nodes":[{"content":"This workaround is not recommended, since a certificate with the MD5 hash algorithm is considered insecure.","pos":[11,118]}]},{"content":"The following configuration file does this:","pos":[1471,1514]},{"pos":[2290,2621],"content":"If the binding is dynamically configured in source code, update the <ph id=\"ph1\">&lt;xref:System.ServiceModel.TcpTransportSecurity.SslProtocols%2A?displayProperty=nameWithType&gt;</ph> property to use TLS 1.1 (<ph id=\"ph2\">&lt;xref:System.Security.Authentication.SslProtocols.Tls11?displayProperty=nameWithType&gt;</ph>) or an  earlier version of the protocol in the source code.","source":"If the binding is dynamically configured in source code, update the <xref:System.ServiceModel.TcpTransportSecurity.SslProtocols%2A?displayProperty=nameWithType> property to use TLS 1.1 (<xref:System.Security.Authentication.SslProtocols.Tls11?displayProperty=nameWithType>) or an  earlier version of the protocol in the source code."},{"pos":[2633,2758],"content":"[!CAUTION]\nThis workaround is not recommended, since a certificate with the MD5 hash algorithm is considered insecure.","leadings":["","    >  "],"nodes":[{"content":"This workaround is not recommended, since a certificate with the MD5 hash algorithm is considered insecure.","pos":[11,118]}]},{"pos":[2767,2775],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2779,2881],"content":"<bpt id=\"p1\">[</bpt>Runtime Changes<ept id=\"p1\">](../../../docs/framework/migration-guide/runtime-changes-in-the-net-framework-4-6.md)</ept>","source":"[Runtime Changes](../../../docs/framework/migration-guide/runtime-changes-in-the-net-framework-4-6.md)"}]}