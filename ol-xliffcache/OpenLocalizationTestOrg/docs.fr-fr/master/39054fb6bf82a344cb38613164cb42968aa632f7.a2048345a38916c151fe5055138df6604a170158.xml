{"content":"---\ntitle: \"Type of optional value for optional parameter <parametername> is not CLS-compliant\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"BC40042\"\n  - \"vbc40042\"\nhelpviewer_keywords: \n  - \"BC40042\"\nms.assetid: 1d6eae29-4ad3-4434-bde4-a53b6051adf5\n---\n# Type of optional value for optional parameter \\<parametername> is not CLS-compliant\nA procedure is marked as `<CLSCompliant(True)>` but declares an [Optional](../../../visual-basic/language-reference/modifiers/optional.md) parameter with default value of a noncompliant type.  \n  \n For a procedure to be compliant with the [Language Independence and Language-Independent Components](../../../standard/language-independence-and-language-independent-components.md) (CLS), it must use only CLS-compliant types. This applies to the types of the parameters, the return type, and the types of all its local variables. It also applies to the default values of optional parameters.  \n  \n The following Visual Basic data types are not CLS-compliant:  \n  \n-   [SByte Data Type](../../../visual-basic/language-reference/data-types/sbyte-data-type.md)  \n  \n-   [UInteger Data Type](../../../visual-basic/language-reference/data-types/uinteger-data-type.md)  \n  \n-   [ULong Data Type](../../../visual-basic/language-reference/data-types/ulong-data-type.md)  \n  \n-   [UShort Data Type](../../../visual-basic/language-reference/data-types/ushort-data-type.md)  \n  \n When you apply the <xref:System.CLSCompliantAttribute> attribute to a programming element, you set the attribute's `isCompliant` parameter to either `True` or `False` to indicate compliance or noncompliance. There is no default for this parameter, and you must supply a value.  \n  \n If you do not apply <xref:System.CLSCompliantAttribute> to an element, it is considered to be noncompliant.  \n  \n By default, this message is a warning. For information on hiding warnings or treating warnings as errors, see [Configuring Warnings in Visual Basic](/visualstudio/ide/configuring-warnings-in-visual-basic).  \n  \n **Error ID:** BC40042  \n  \n## To correct this error  \n  \n-   If the optional parameter must have a default value of this particular type, remove <xref:System.CLSCompliantAttribute>. The procedure cannot be CLS-compliant.  \n  \n-   If the procedure must be CLS-compliant, change the type of this default value to the closest CLS-compliant type. For example, in place of `UInteger` you might be able to use `Integer` if you do not need the value range above 2,147,483,647. If you do need the extended range, you can replace `UInteger` with `Long`.  \n  \n-   If you are interfacing with Automation or COM objects, keep in mind that some types have different data widths than in the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]. For example, `int` is often 16 bits in other environments. If you are accepting a 16-bit integer from such a component, declare it as `Short` instead of `Integer` in your managed Visual Basic code.","nodes":[{"pos":[4,243],"embed":true,"restype":"x-metadata","content":"title: \"Type of optional value for optional parameter <parametername> is not CLS-compliant\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"BC40042\"\n  - \"vbc40042\"\nhelpviewer_keywords: \n  - \"BC40042\"\nms.assetid: 1d6eae29-4ad3-4434-bde4-a53b6051adf5","nodes":[{"content":"Type of optional value for optional parameter <parametername> is not CLS-compliant","nodes":[{"pos":[0,82],"content":"Type of optional value for optional parameter <ph id=\"ph1\">&lt;parametername&gt;</ph> is not CLS-compliant","source":"Type of optional value for optional parameter <parametername> is not CLS-compliant"}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[250,333],"content":"Type of optional value for optional parameter \\<parametername> is not CLS-compliant","linkify":"Type of optional value for optional parameter \\<parametername> is not CLS-compliant","nodes":[{"content":"Type of optional value for optional parameter <ph id=\"ph1\">\\&lt;</ph>parametername&gt; is not CLS-compliant","pos":[0,83],"source":"Type of optional value for optional parameter \\<parametername> is not CLS-compliant"}]},{"pos":[334,525],"content":"A procedure is marked as <ph id=\"ph1\">`&lt;CLSCompliant(True)&gt;`</ph> but declares an <bpt id=\"p1\">[</bpt>Optional<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/optional.md)</ept> parameter with default value of a noncompliant type.","source":"A procedure is marked as `<CLSCompliant(True)>` but declares an [Optional](../../../visual-basic/language-reference/modifiers/optional.md) parameter with default value of a noncompliant type."},{"content":"For a procedure to be compliant with the <bpt id=\"p1\">[</bpt>Language Independence and Language-Independent Components<ept id=\"p1\">](../../../standard/language-independence-and-language-independent-components.md)</ept> (CLS), it must use only CLS-compliant types.","pos":[532,757],"source":"For a procedure to be compliant with the [Language Independence and Language-Independent Components](../../../standard/language-independence-and-language-independent-components.md) (CLS), it must use only CLS-compliant types."},{"content":"This applies to the types of the parameters, the return type, and the types of all its local variables.","pos":[758,861]},{"content":"It also applies to the default values of optional parameters.","pos":[862,923]},{"content":"The following Visual Basic data types are not CLS-compliant:","pos":[930,990]},{"pos":[1000,1089],"content":"<bpt id=\"p1\">[</bpt>SByte Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/sbyte-data-type.md)</ept>","source":"[SByte Data Type](../../../visual-basic/language-reference/data-types/sbyte-data-type.md)"},{"pos":[1099,1194],"content":"<bpt id=\"p1\">[</bpt>UInteger Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/uinteger-data-type.md)</ept>","source":"[UInteger Data Type](../../../visual-basic/language-reference/data-types/uinteger-data-type.md)"},{"pos":[1204,1293],"content":"<bpt id=\"p1\">[</bpt>ULong Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/ulong-data-type.md)</ept>","source":"[ULong Data Type](../../../visual-basic/language-reference/data-types/ulong-data-type.md)"},{"pos":[1303,1394],"content":"<bpt id=\"p1\">[</bpt>UShort Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/ushort-data-type.md)</ept>","source":"[UShort Data Type](../../../visual-basic/language-reference/data-types/ushort-data-type.md)"},{"content":"When you apply the <ph id=\"ph1\">&lt;xref:System.CLSCompliantAttribute&gt;</ph> attribute to a programming element, you set the attribute's <ph id=\"ph2\">`isCompliant`</ph> parameter to either <ph id=\"ph3\">`True`</ph> or <ph id=\"ph4\">`False`</ph> to indicate compliance or noncompliance.","pos":[1401,1608],"source":"When you apply the <xref:System.CLSCompliantAttribute> attribute to a programming element, you set the attribute's `isCompliant` parameter to either `True` or `False` to indicate compliance or noncompliance."},{"content":"There is no default for this parameter, and you must supply a value.","pos":[1609,1677]},{"pos":[1684,1791],"content":"If you do not apply <ph id=\"ph1\">&lt;xref:System.CLSCompliantAttribute&gt;</ph> to an element, it is considered to be noncompliant.","source":"If you do not apply <xref:System.CLSCompliantAttribute> to an element, it is considered to be noncompliant."},{"content":"By default, this message is a warning.","pos":[1798,1836]},{"content":"For information on hiding warnings or treating warnings as errors, see <bpt id=\"p1\">[</bpt>Configuring Warnings in Visual Basic<ept id=\"p1\">](/visualstudio/ide/configuring-warnings-in-visual-basic)</ept>.","pos":[1837,2003],"source":" For information on hiding warnings or treating warnings as errors, see [Configuring Warnings in Visual Basic](/visualstudio/ide/configuring-warnings-in-visual-basic)."},{"pos":[2010,2031],"content":"<bpt id=\"p1\">**</bpt>Error ID:<ept id=\"p1\">**</ept> BC40042","source":"**Error ID:** BC40042"},{"pos":[2040,2061],"content":"To correct this error","linkify":"To correct this error","nodes":[{"content":"To correct this error","pos":[0,21]}]},{"content":"If the optional parameter must have a default value of this particular type, remove <ph id=\"ph1\">&lt;xref:System.CLSCompliantAttribute&gt;</ph>.","pos":[2071,2191],"source":"If the optional parameter must have a default value of this particular type, remove <xref:System.CLSCompliantAttribute>."},{"content":"The procedure cannot be CLS-compliant.","pos":[2192,2230]},{"content":"If the procedure must be CLS-compliant, change the type of this default value to the closest CLS-compliant type.","pos":[2240,2352]},{"content":"For example, in place of <ph id=\"ph1\">`UInteger`</ph> you might be able to use <ph id=\"ph2\">`Integer`</ph> if you do not need the value range above 2,147,483,647.","pos":[2353,2479],"source":" For example, in place of `UInteger` you might be able to use `Integer` if you do not need the value range above 2,147,483,647."},{"content":"If you do need the extended range, you can replace <ph id=\"ph1\">`UInteger`</ph> with <ph id=\"ph2\">`Long`</ph>.","pos":[2480,2554],"source":" If you do need the extended range, you can replace `UInteger` with `Long`."},{"content":"If you are interfacing with Automation or COM objects, keep in mind that some types have different data widths than in the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph>.","pos":[2564,2741],"source":"If you are interfacing with Automation or COM objects, keep in mind that some types have different data widths than in the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]."},{"content":"For example, <ph id=\"ph1\">`int`</ph> is often 16 bits in other environments.","pos":[2742,2800],"source":" For example, `int` is often 16 bits in other environments."},{"content":"If you are accepting a 16-bit integer from such a component, declare it as <ph id=\"ph1\">`Short`</ph> instead of <ph id=\"ph2\">`Integer`</ph> in your managed Visual Basic code.","pos":[2801,2939],"source":" If you are accepting a 16-bit integer from such a component, declare it as `Short` instead of `Integer` in your managed Visual Basic code."}]}