{"content":"---\ntitle: \"The custom-designed version of 'System.Runtime.CompilerServices.ExtensionAttribute' found by the compiler is not valid\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vbc36558\"\n  - \"bc36558\"\nhelpviewer_keywords: \n  - \"BC36558\"\nms.assetid: f47d310a-95fd-4340-bda2-21262c217dbb\n---\n# The custom-designed version of 'System.Runtime.CompilerServices.ExtensionAttribute' found by the compiler is not valid\nThe custom-designed version of 'System.Runtime.CompilerServices.ExtensionAttribute' found by the compiler is not valid. Its attribute usage flags must be set to allow assemblies, classes, and methods.  \n  \n The custom-designed version of <xref:System.Runtime.CompilerServices.ExtensionAttribute?displayProperty=nameWithType> that the compiler found does not set its attribute usage flags to enable application of the attribute to assemblies, methods, and classes. Application to at least those three program elements is required.  \n  \n **Error ID:** BC36558  \n  \n## To correct this error  \n  \n-   Change the attribute definition to enable the attribute to apply at least to assemblies, methods, and classes, as shown in the following examples.  \n  \n-   Use <xref:System.Runtime.CompilerServices.ExtensionAttribute?displayProperty=nameWithType> instead of the custom-designed version.  \n  \n## Example  \n The following example uses the `AttributeUsage` attribute to specify which program elements the new version of `ExtensionAttribute` can apply to. The example specifies three members of the `AttributeTargets` enumeration: `Assembly`, `Class`, and `Method`. The omission of any one of these elements will cause this error.  \n  \n```  \nNamespace System.Runtime.CompilerServices  \n    <AttributeUsage(AttributeTargets.Assembly Or _  \n        AttributeTargets.Class Or AttributeTargets.Method)>  \n    Class ExtensionAttribute  \n        Inherits System.Attribute  \n        ' Definitions of methods, fields, and properties.  \n    End Class  \nEnd Namespace  \n```  \n  \n Alternatively, you could allow `ExtensionAttribute` to apply to all program elements by using the `All` member of `AttributeTargets`.  \n  \n```xml  \n<AttributeUsage(AttributeTargets.All)>  \n```  \n  \n Deleting the `AttributeUsage` line, as shown in the following code, produces the same result.  \n  \n```  \nNamespace System.Runtime.CompilerServices  \n    Class ExtensionAttribute  \n        Inherits System.Attribute  \n        ' Definitions of methods, fields, and properties.  \n    End Class  \nEnd Namespace  \n```  \n  \n## See also\n\n- <xref:System.Runtime.CompilerServices.ExtensionAttribute>\n\n- [Creating custom attributes](~/docs/visual-basic/programming-guide/concepts/attributes/creating-custom-attributes.md)\n- [Extension Methods](../../visual-basic/programming-guide/language-features/procedures/extension-methods.md)\n- [Attributes overview](~/docs/visual-basic/programming-guide/concepts/attributes/index.md)\n- [Writing Custom Attributes](../../standard/attributes/writing-custom-attributes.md)\n","nodes":[{"pos":[4,279],"embed":true,"restype":"x-metadata","content":"title: \"The custom-designed version of 'System.Runtime.CompilerServices.ExtensionAttribute' found by the compiler is not valid\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vbc36558\"\n  - \"bc36558\"\nhelpviewer_keywords: \n  - \"BC36558\"\nms.assetid: f47d310a-95fd-4340-bda2-21262c217dbb","nodes":[{"content":"The custom-designed version of 'System.Runtime.CompilerServices.ExtensionAttribute' found by the compiler is not valid","nodes":[{"pos":[0,118],"content":"The custom-designed version of 'System.Runtime.CompilerServices.ExtensionAttribute' found by the compiler is not valid","nodes":[{"content":"The custom-designed version of 'System.Runtime.CompilerServices.ExtensionAttribute' found by the compiler is not valid","pos":[0,118]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[286,404],"content":"The custom-designed version of 'System.Runtime.CompilerServices.ExtensionAttribute' found by the compiler is not valid","linkify":"The custom-designed version of 'System.Runtime.CompilerServices.ExtensionAttribute' found by the compiler is not valid","nodes":[{"content":"The custom-designed version of 'System.Runtime.CompilerServices.ExtensionAttribute' found by the compiler is not valid","pos":[0,118]}]},{"content":"The custom-designed version of 'System.Runtime.CompilerServices.ExtensionAttribute' found by the compiler is not valid.","pos":[405,524]},{"content":"Its attribute usage flags must be set to allow assemblies, classes, and methods.","pos":[525,605]},{"content":"The custom-designed version of <ph id=\"ph1\">&lt;xref:System.Runtime.CompilerServices.ExtensionAttribute?displayProperty=nameWithType&gt;</ph> that the compiler found does not set its attribute usage flags to enable application of the attribute to assemblies, methods, and classes.","pos":[612,868],"source":"The custom-designed version of <xref:System.Runtime.CompilerServices.ExtensionAttribute?displayProperty=nameWithType> that the compiler found does not set its attribute usage flags to enable application of the attribute to assemblies, methods, and classes."},{"content":"Application to at least those three program elements is required.","pos":[869,934]},{"pos":[941,962],"content":"<bpt id=\"p1\">**</bpt>Error ID:<ept id=\"p1\">**</ept> BC36558","source":"**Error ID:** BC36558"},{"pos":[971,992],"content":"To correct this error","linkify":"To correct this error","nodes":[{"content":"To correct this error","pos":[0,21]}]},{"content":"Change the attribute definition to enable the attribute to apply at least to assemblies, methods, and classes, as shown in the following examples.","pos":[1002,1148]},{"pos":[1158,1288],"content":"Use <ph id=\"ph1\">&lt;xref:System.Runtime.CompilerServices.ExtensionAttribute?displayProperty=nameWithType&gt;</ph> instead of the custom-designed version.","source":"Use <xref:System.Runtime.CompilerServices.ExtensionAttribute?displayProperty=nameWithType> instead of the custom-designed version."},{"pos":[1297,1304],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example uses the <ph id=\"ph1\">`AttributeUsage`</ph> attribute to specify which program elements the new version of <ph id=\"ph2\">`ExtensionAttribute`</ph> can apply to.","pos":[1308,1453],"source":"The following example uses the `AttributeUsage` attribute to specify which program elements the new version of `ExtensionAttribute` can apply to."},{"content":"The example specifies three members of the <ph id=\"ph1\">`AttributeTargets`</ph> enumeration: <ph id=\"ph2\">`Assembly`</ph>, <ph id=\"ph3\">`Class`</ph>, and <ph id=\"ph4\">`Method`</ph>.","pos":[1454,1563],"source":" The example specifies three members of the `AttributeTargets` enumeration: `Assembly`, `Class`, and `Method`."},{"content":"The omission of any one of these elements will cause this error.","pos":[1564,1628]},{"pos":[1968,2101],"content":"Alternatively, you could allow <ph id=\"ph1\">`ExtensionAttribute`</ph> to apply to all program elements by using the <ph id=\"ph2\">`All`</ph> member of <ph id=\"ph3\">`AttributeTargets`</ph>.","source":"Alternatively, you could allow `ExtensionAttribute` to apply to all program elements by using the `All` member of `AttributeTargets`."},{"pos":[2167,2260],"content":"Deleting the <ph id=\"ph1\">`AttributeUsage`</ph> line, as shown in the following code, produces the same result.","source":"Deleting the `AttributeUsage` line, as shown in the following code, produces the same result."},{"pos":[2487,2495],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2560,2677],"content":"<bpt id=\"p1\">[</bpt>Creating custom attributes<ept id=\"p1\">](~/docs/visual-basic/programming-guide/concepts/attributes/creating-custom-attributes.md)</ept>","source":"[Creating custom attributes](~/docs/visual-basic/programming-guide/concepts/attributes/creating-custom-attributes.md)"},{"pos":[2680,2787],"content":"<bpt id=\"p1\">[</bpt>Extension Methods<ept id=\"p1\">](../../visual-basic/programming-guide/language-features/procedures/extension-methods.md)</ept>","source":"[Extension Methods](../../visual-basic/programming-guide/language-features/procedures/extension-methods.md)"},{"pos":[2790,2879],"content":"<bpt id=\"p1\">[</bpt>Attributes overview<ept id=\"p1\">](~/docs/visual-basic/programming-guide/concepts/attributes/index.md)</ept>","source":"[Attributes overview](~/docs/visual-basic/programming-guide/concepts/attributes/index.md)"},{"pos":[2882,2965],"content":"<bpt id=\"p1\">[</bpt>Writing Custom Attributes<ept id=\"p1\">](../../standard/attributes/writing-custom-attributes.md)</ept>","source":"[Writing Custom Attributes](../../standard/attributes/writing-custom-attributes.md)"}]}