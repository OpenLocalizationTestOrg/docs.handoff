{"content":"---\ntitle: \"How to: Create a Tree from an XmlReader (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 6de683d8-177d-402b-b0de-d0539f1ce5d8\n---\n# How to: Create a Tree from an XmlReader (Visual Basic)\nThis topic shows how to create an XML tree directly from an <xref:System.Xml.XmlReader>. To create an <xref:System.Xml.Linq.XElement> from an <xref:System.Xml.XmlReader>, you must position the <xref:System.Xml.XmlReader> on an element node. The <xref:System.Xml.XmlReader> will skip comments and processing instructions, but if the <xref:System.Xml.XmlReader> is positioned on a text node, an error will be thrown. To avoid such errors, always position the <xref:System.Xml.XmlReader> on an element before you create an XML tree from the <xref:System.Xml.XmlReader>.  \n  \n## Example  \n This example uses the following XML document: [Sample XML File: Books (LINQ to XML)](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-books-linq-to-xml.md).  \n  \n The following code creates an `T:System.Xml.XmlReader` object, and then reads nodes until it finds the first element node. It then loads the <xref:System.Xml.Linq.XElement> object.  \n  \n```vb  \nDim r As XmlReader = XmlReader.Create(\"books.xml\")  \nDo While r.NodeType <> XmlNodeType.Element  \n    r.Read()  \nLoop  \nDim e As XElement = XElement.Load(r)  \nConsole.WriteLine(e)  \n```  \n  \n This example produces the following output:  \n  \n```xml  \n<Catalog>  \n   <Book id=\"bk101\">  \n      <Author>Garghentini, Davide</Author>  \n      <Title>XML Developer's Guide</Title>  \n      <Genre>Computer</Genre>  \n      <Price>44.95</Price>  \n      <PublishDate>2000-10-01</PublishDate>  \n      <Description>An in-depth look at creating applications   \n      with XML.</Description>  \n   </Book>  \n   <Book id=\"bk102\">  \n      <Author>Garcia, Debra</Author>  \n      <Title>Midnight Rain</Title>  \n      <Genre>Fantasy</Genre>  \n      <Price>5.95</Price>  \n      <PublishDate>2000-12-16</PublishDate>  \n      <Description>A former architect battles corporate zombies,   \n      an evil sorceress, and her own childhood to become queen   \n      of the world.</Description>  \n   </Book>  \n</Catalog>  \n```  \n  \n## See also\n\n- [Parsing XML (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/parsing-xml.md)\n","nodes":[{"pos":[4,136],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create a Tree from an XmlReader (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 6de683d8-177d-402b-b0de-d0539f1ce5d8","nodes":[{"content":"How to: Create a Tree from an XmlReader (Visual Basic)","nodes":[{"pos":[0,54],"content":"How to: Create a Tree from an XmlReader (Visual Basic)","nodes":[{"content":"How to: Create a Tree from an XmlReader (Visual Basic)","pos":[0,54]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[143,197],"content":"How to: Create a Tree from an XmlReader (Visual Basic)","linkify":"How to: Create a Tree from an XmlReader (Visual Basic)","nodes":[{"content":"How to: Create a Tree from an XmlReader (Visual Basic)","pos":[0,54]}]},{"content":"This topic shows how to create an XML tree directly from an <ph id=\"ph1\">&lt;xref:System.Xml.XmlReader&gt;</ph>.","pos":[198,286],"source":"This topic shows how to create an XML tree directly from an <xref:System.Xml.XmlReader>."},{"content":"To create an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> from an <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph>, you must position the <ph id=\"ph3\">&lt;xref:System.Xml.XmlReader&gt;</ph> on an element node.","pos":[287,438],"source":" To create an <xref:System.Xml.Linq.XElement> from an <xref:System.Xml.XmlReader>, you must position the <xref:System.Xml.XmlReader> on an element node."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlReader&gt;</ph> will skip comments and processing instructions, but if the <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph> is positioned on a text node, an error will be thrown.","pos":[439,612],"source":" The <xref:System.Xml.XmlReader> will skip comments and processing instructions, but if the <xref:System.Xml.XmlReader> is positioned on a text node, an error will be thrown."},{"content":"To avoid such errors, always position the <ph id=\"ph1\">&lt;xref:System.Xml.XmlReader&gt;</ph> on an element before you create an XML tree from the <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph>.","pos":[613,764],"source":" To avoid such errors, always position the <xref:System.Xml.XmlReader> on an element before you create an XML tree from the <xref:System.Xml.XmlReader>."},{"pos":[773,780],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[784,964],"content":"This example uses the following XML document: <bpt id=\"p1\">[</bpt>Sample XML File: Books (LINQ to XML)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-books-linq-to-xml.md)</ept>.","source":"This example uses the following XML document: [Sample XML File: Books (LINQ to XML)](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-books-linq-to-xml.md)."},{"content":"The following code creates an <ph id=\"ph1\">`T:System.Xml.XmlReader`</ph> object, and then reads nodes until it finds the first element node.","pos":[971,1093],"source":"The following code creates an `T:System.Xml.XmlReader` object, and then reads nodes until it finds the first element node."},{"content":"It then loads the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> object.","pos":[1094,1151],"source":" It then loads the <xref:System.Xml.Linq.XElement> object."},{"content":"This example produces the following output:","pos":[1357,1400]},{"pos":[2168,2176],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2180,2281],"content":"<bpt id=\"p1\">[</bpt>Parsing XML (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/parsing-xml.md)</ept>","source":"[Parsing XML (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/parsing-xml.md)"}]}