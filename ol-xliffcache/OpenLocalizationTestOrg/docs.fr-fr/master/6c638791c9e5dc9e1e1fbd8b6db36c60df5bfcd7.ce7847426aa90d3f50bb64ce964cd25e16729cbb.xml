{"content":"---\ntitle: \"Socket Performance Enhancements in Version 3.5\"\nms.date: \"03/30/2017\"\nms.assetid: 225aa5f9-c54b-4620-ab64-5cd100cfd54c\n---\n# Socket Performance Enhancements in Version 3.5\nThe <xref:System.Net.Sockets.Socket?displayProperty=nameWithType> class has been enhanced in Version 3.5 for use by applications that use asynchronous network I/O to achieve the highest performance. A series of new classes have been added as part of a set of enhancements to the <xref:System.Net.Sockets.Socket> class that provide an alternative asynchronous pattern that can be used by specialized high-performance socket applications. These enhancements were specifically designed for network server applications that require high performance. An application can use the enhanced asynchronous pattern exclusively, or only in targeted hot areas of their application (when receiving large amounts of data, for example).  \n  \n## Class Enhancements  \n The main feature of these enhancements is the avoidance of the repeated allocation and synchronization of objects during high-volume asynchronous socket I/O. The Begin/End design pattern currently implemented by the <xref:System.Net.Sockets.Socket> class for asynchronous socket I/O requires a <xref:System.IAsyncResult?displayProperty=nameWithType> object be allocated for each asynchronous socket operation.  \n  \n In the new <xref:System.Net.Sockets.Socket> class enhancements, asynchronous socket operations are described by reusable <xref:System.Net.Sockets.SocketAsyncEventArgs?displayProperty=nameWithType> class objects allocated and maintained by the application. High-performance socket applications know best the amount of overlapped socket operations that must be sustained. The application can create as many of the <xref:System.Net.Sockets.SocketAsyncEventArgs> objects that it needs. For example, if a server application needs to have 15 socket accept operations outstanding at all times to support incoming client connection rates, it can allocate 15 reusable <xref:System.Net.Sockets.SocketAsyncEventArgs> objects in advance for that purpose.  \n  \n The pattern for performing an asynchronous socket operation with this class consists of the following steps:  \n  \n1.  Allocate a new <xref:System.Net.Sockets.SocketAsyncEventArgs> context object, or get a free one from an application pool.  \n  \n2.  Set properties on the context object to the operation about to be performed (the callback delegate method and data buffer, for example).  \n  \n3.  Call the appropriate socket method (xxxAsync) to initiate the asynchronous operation.  \n  \n4.  If the asynchronous socket method (xxxAsync) returns true in the callback, query the context properties for completion status.  \n  \n5.  If the asynchronous socket method (xxxAsync) returns false in the callback, the operation completed synchronously. The context properties may be queried for the operation result.  \n  \n6.  Reuse the context for another operation, put it back in the pool, or discard it.  \n  \n The lifetime of the new asynchronous socket operation context object is determined by references in the application code and asynchronous I/O references. It is not necessary for the application to retain a reference to an asynchronous socket operation context object after it is submitted as a parameter to one of the asynchronous socket operation methods. It will remain referenced until the completion callback returns. However it is advantageous for the application to retain the reference to the context object so that it can be reused for a future asynchronous socket operation.  \n  \n## See also\n\n- <xref:System.Net.Sockets.Socket?displayProperty=nameWithType>\n- <xref:System.Net.Sockets.SendPacketsElement?displayProperty=nameWithType>\n- <xref:System.Net.Sockets.SocketAsyncEventArgs?displayProperty=nameWithType>\n- <xref:System.Net.Sockets.SocketAsyncOperation?displayProperty=nameWithType>\n- [Network Programming Samples](../../../docs/framework/network-programming/network-programming-samples.md)\n- [Socket Code Examples](socket-code-examples.md)\n","nodes":[{"pos":[4,130],"embed":true,"restype":"x-metadata","content":"title: \"Socket Performance Enhancements in Version 3.5\"\nms.date: \"03/30/2017\"\nms.assetid: 225aa5f9-c54b-4620-ab64-5cd100cfd54c","nodes":[{"content":"Socket Performance Enhancements in Version 3.5","nodes":[{"pos":[0,46],"content":"Socket Performance Enhancements in Version 3.5","nodes":[{"content":"Socket Performance Enhancements in Version 3.5","pos":[0,46]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[137,183],"content":"Socket Performance Enhancements in Version 3.5","linkify":"Socket Performance Enhancements in Version 3.5","nodes":[{"content":"Socket Performance Enhancements in Version 3.5","pos":[0,46]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Net.Sockets.Socket?displayProperty=nameWithType&gt;</ph> class has been enhanced in Version 3.5 for use by applications that use asynchronous network I/O to achieve the highest performance.","pos":[184,382],"source":"The <xref:System.Net.Sockets.Socket?displayProperty=nameWithType> class has been enhanced in Version 3.5 for use by applications that use asynchronous network I/O to achieve the highest performance."},{"content":"A series of new classes have been added as part of a set of enhancements to the <ph id=\"ph1\">&lt;xref:System.Net.Sockets.Socket&gt;</ph> class that provide an alternative asynchronous pattern that can be used by specialized high-performance socket applications.","pos":[383,620],"source":" A series of new classes have been added as part of a set of enhancements to the <xref:System.Net.Sockets.Socket> class that provide an alternative asynchronous pattern that can be used by specialized high-performance socket applications."},{"content":"These enhancements were specifically designed for network server applications that require high performance.","pos":[621,729]},{"content":"An application can use the enhanced asynchronous pattern exclusively, or only in targeted hot areas of their application (when receiving large amounts of data, for example).","pos":[730,903]},{"pos":[912,930],"content":"Class Enhancements","linkify":"Class Enhancements","nodes":[{"content":"Class Enhancements","pos":[0,18]}]},{"content":"The main feature of these enhancements is the avoidance of the repeated allocation and synchronization of objects during high-volume asynchronous socket I/O.","pos":[934,1091]},{"content":"The Begin/End design pattern currently implemented by the <ph id=\"ph1\">&lt;xref:System.Net.Sockets.Socket&gt;</ph> class for asynchronous socket I/O requires a <ph id=\"ph2\">&lt;xref:System.IAsyncResult?displayProperty=nameWithType&gt;</ph> object be allocated for each asynchronous socket operation.","pos":[1092,1343],"source":" The Begin/End design pattern currently implemented by the <xref:System.Net.Sockets.Socket> class for asynchronous socket I/O requires a <xref:System.IAsyncResult?displayProperty=nameWithType> object be allocated for each asynchronous socket operation."},{"content":"In the new <ph id=\"ph1\">&lt;xref:System.Net.Sockets.Socket&gt;</ph> class enhancements, asynchronous socket operations are described by reusable <ph id=\"ph2\">&lt;xref:System.Net.Sockets.SocketAsyncEventArgs?displayProperty=nameWithType&gt;</ph> class objects allocated and maintained by the application.","pos":[1350,1605],"source":"In the new <xref:System.Net.Sockets.Socket> class enhancements, asynchronous socket operations are described by reusable <xref:System.Net.Sockets.SocketAsyncEventArgs?displayProperty=nameWithType> class objects allocated and maintained by the application."},{"content":"High-performance socket applications know best the amount of overlapped socket operations that must be sustained.","pos":[1606,1719]},{"content":"The application can create as many of the <ph id=\"ph1\">&lt;xref:System.Net.Sockets.SocketAsyncEventArgs&gt;</ph> objects that it needs.","pos":[1720,1831],"source":" The application can create as many of the <xref:System.Net.Sockets.SocketAsyncEventArgs> objects that it needs."},{"content":"For example, if a server application needs to have 15 socket accept operations outstanding at all times to support incoming client connection rates, it can allocate 15 reusable <ph id=\"ph1\">&lt;xref:System.Net.Sockets.SocketAsyncEventArgs&gt;</ph> objects in advance for that purpose.","pos":[1832,2092],"source":" For example, if a server application needs to have 15 socket accept operations outstanding at all times to support incoming client connection rates, it can allocate 15 reusable <xref:System.Net.Sockets.SocketAsyncEventArgs> objects in advance for that purpose."},{"content":"The pattern for performing an asynchronous socket operation with this class consists of the following steps:","pos":[2099,2207]},{"pos":[2217,2338],"content":"Allocate a new <ph id=\"ph1\">&lt;xref:System.Net.Sockets.SocketAsyncEventArgs&gt;</ph> context object, or get a free one from an application pool.","source":"Allocate a new <xref:System.Net.Sockets.SocketAsyncEventArgs> context object, or get a free one from an application pool."},{"content":"Set properties on the context object to the operation about to be performed (the callback delegate method and data buffer, for example).","pos":[2348,2484]},{"content":"Call the appropriate socket method (xxxAsync) to initiate the asynchronous operation.","pos":[2494,2579]},{"content":"If the asynchronous socket method (xxxAsync) returns true in the callback, query the context properties for completion status.","pos":[2589,2715]},{"content":"If the asynchronous socket method (xxxAsync) returns false in the callback, the operation completed synchronously.","pos":[2725,2839]},{"content":"The context properties may be queried for the operation result.","pos":[2840,2903]},{"content":"Reuse the context for another operation, put it back in the pool, or discard it.","pos":[2913,2993]},{"content":"The lifetime of the new asynchronous socket operation context object is determined by references in the application code and asynchronous I/O references.","pos":[3000,3153]},{"content":"It is not necessary for the application to retain a reference to an asynchronous socket operation context object after it is submitted as a parameter to one of the asynchronous socket operation methods.","pos":[3154,3356]},{"content":"It will remain referenced until the completion callback returns.","pos":[3357,3421]},{"content":"However it is advantageous for the application to retain the reference to the context object so that it can be reused for a future asynchronous socket operation.","pos":[3422,3583]},{"pos":[3592,3600],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3900,4005],"content":"<bpt id=\"p1\">[</bpt>Network Programming Samples<ept id=\"p1\">](../../../docs/framework/network-programming/network-programming-samples.md)</ept>","source":"[Network Programming Samples](../../../docs/framework/network-programming/network-programming-samples.md)"},{"pos":[4008,4055],"content":"<bpt id=\"p1\">[</bpt>Socket Code Examples<ept id=\"p1\">](socket-code-examples.md)</ept>","source":"[Socket Code Examples](socket-code-examples.md)"}]}