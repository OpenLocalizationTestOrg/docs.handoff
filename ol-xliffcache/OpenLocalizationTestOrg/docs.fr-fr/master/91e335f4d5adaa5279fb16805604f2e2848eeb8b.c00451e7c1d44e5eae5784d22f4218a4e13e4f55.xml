{"content":"---\ntitle: \"Timing Events Overview\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"timelines [WPF]\"\n  - \"timing events [WPF]\"\nms.assetid: 597e3280-0867-4359-a97b-5b2f4149e350\n---\n# Timing Events Overview\nThis topic describes how to use the five timing events available on <xref:System.Windows.Media.Animation.Timeline> and <xref:System.Windows.Media.Animation.Clock> objects.  \n  \n## Prerequisites  \n To understand this topic, you should understand how to create and use animations. To get started with animation, see the [Animation Overview](animation-overview.md).  \n  \n There are multiple ways to animate properties in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]:  \n  \n-   **Using storyboard objects** (markup and code): You can use <xref:System.Windows.Media.Animation.Storyboard> objects to arrange and distribute animations to one or more objects. For an example, see [Animate a Property by Using a Storyboard](how-to-animate-a-property-by-using-a-storyboard.md).  \n  \n-   **Using local animations** (code only): You can apply <xref:System.Windows.Media.Animation.AnimationTimeline> objects directly to the properties they animate. For an example, see [Animate a Property Without Using a Storyboard](how-to-animate-a-property-without-using-a-storyboard.md).  \n  \n-   **Using clocks** (code only): You can explicitly manage clock creation and distribute the animation clocks yourself.  For an example, see [Animate a Property by Using an AnimationClock](how-to-animate-a-property-by-using-an-animationclock.md).  \n  \n Because you can use them in markup and code, the examples in this overview use <xref:System.Windows.Media.Animation.Storyboard> objects. However, the concepts described can be applied to the other methods of animating properties.  \n  \n### What is a clock?  \n A timeline, by itself, doesn't actually do anything other than describe a segment of time. It's the timeline's <xref:System.Windows.Media.Animation.Clock> object that does the real work: it maintains timing-related run-time state for the timeline. In most cases, such as when using storyboards, a clock is created automatically for your timeline. You can also create a <xref:System.Windows.Media.Animation.Clock> explicitly by using the <xref:System.Windows.Media.Animation.Timeline.CreateClock%2A> method. For more information about <xref:System.Windows.Media.Animation.Clock> objects, see the [Animation and Timing System Overview](animation-and-timing-system-overview.md).  \n  \n## Why Use Events?  \n With the exception of one (seek aligned to last tick), all interactive timing operations are asynchronous. There is no way for you to know exactly when they will execute. That can be a problem when you have other code that's dependent upon your timing operation. Suppose that you wanted to stop a timeline that animated a rectangle. After the timeline stops, you change the color of the rectangle.  \n  \n [!code-csharp[events_procedural#NeedForEventsFragment](~/samples/snippets/csharp/VS_Snippets_Wpf/events_procedural/CSharp/EventExample.cs#needforeventsfragment)]\n [!code-vb[events_procedural#NeedForEventsFragment](~/samples/snippets/visualbasic/VS_Snippets_Wpf/events_procedural/VisualBasic/EventExample.vb#needforeventsfragment)]  \n  \n In the previous example, the second line of code might execute before the storyboard stops. That's because stopping is an asynchronous operation. Telling a timeline or clock to stop creates a \"stop request\" of sorts that isn't processed until the timing engine's next tick.  \n  \n To execute commands after a timeline completes, use timing events. In the following example, an event handler is used to change the color of a rectangle after the storyboard stops playing.  \n  \n [!code-csharp[events_procedural#RegisterForStoryboardCurrentStateInvalidatedEvent](~/samples/snippets/csharp/VS_Snippets_Wpf/events_procedural/CSharp/EventExample.cs#registerforstoryboardcurrentstateinvalidatedevent)]\n [!code-vb[events_procedural#RegisterForStoryboardCurrentStateInvalidatedEvent](~/samples/snippets/visualbasic/VS_Snippets_Wpf/events_procedural/VisualBasic/EventExample.vb#registerforstoryboardcurrentstateinvalidatedevent)]  \n[!code-csharp[events_procedural#StoryboardCurrentStateInvalidatedEvent2](~/samples/snippets/csharp/VS_Snippets_Wpf/events_procedural/CSharp/EventExample.cs#storyboardcurrentstateinvalidatedevent2)]\n[!code-vb[events_procedural#StoryboardCurrentStateInvalidatedEvent2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/events_procedural/VisualBasic/EventExample.vb#storyboardcurrentstateinvalidatedevent2)]  \n  \n For a more complete example, see [Receive Notification When a Clock's State Changes](how-to-receive-notification-when-clock-state-changes.md).  \n  \n## Public Events  \n The <xref:System.Windows.Media.Animation.Timeline> and <xref:System.Windows.Media.Animation.Clock> classes both provide five timing events. The following table lists these events and the conditions that trigger them.  \n  \n|Event|Triggering interactive operation|Other triggers|  \n|-----------|--------------------------------------|--------------------|  \n|**Completed**|Skip to fill|The clock completes.|  \n|**CurrentGlobalSpeedInvalidated**|Pause, resume, seek, set speed ratio, skip to fill, stop|The clock reverses, accelerates, starts, or stops.|  \n|**CurrentStateInvalidated**|Begin, skip to fill, stop|The clock starts, stops, or fills.|  \n|**CurrentTimeInvalidated**|Begin, seek, skip to fill, stop|The clock progresses.|  \n|**RemoveRequested**|Remove||  \n  \n## Ticking and Event Consolidation  \n When you animate objects in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], it’s the timing engine that manages your animations. The timing engine tracks the progression of time and computes the state of each animation. It makes many such evaluation passes in a second. These evaluation passes are known as \"ticks.\"  \n  \n While ticks occur frequently, it's possible for a lot of things to happen between ticks. For example, a timeline might be stopped, started, and stopped again, in which case its current state will have changed three times. In theory, the event could be raised multiple times in a single tick; however, the timing engine consolidates events, so that each event can be raised at most once per tick.  \n  \n## Registering for Events  \n There are two ways to register for timing events: you can register with the timeline or with the clock created from the timeline. Registering for an event directly with a clock is fairly straightforward, although it can only be done from code. You can register for events with a timeline from markup or code. The next section describes how to register for clock events with a timeline.  \n  \n<a name=\"registeringforclockeventswithatimeline\"></a>   \n## Registering for Clock Events with a Timeline  \n Although a timeline's <xref:System.Windows.Media.Animation.Timeline.Completed>, <xref:System.Windows.Media.Animation.Timeline.CurrentGlobalSpeedInvalidated>, <xref:System.Windows.Media.Animation.Timeline.CurrentStateInvalidated>, <xref:System.Windows.Media.Animation.Timeline.CurrentTimeInvalidated>, and <xref:System.Windows.Media.Animation.Timeline.RemoveRequested> events appear to be associated with the timeline, registering for these events actually associates an event handler with the <xref:System.Windows.Media.Animation.Clock> created for the timeline.  \n  \n When you register for the <xref:System.Windows.Media.Animation.Timeline.Completed> event on a timeline, for example, you're actually telling the system to register for the <xref:System.Windows.Media.Animation.Clock.Completed> event of each clock that is created for the timeline. In code, you must register for this event before the <xref:System.Windows.Media.Animation.Clock> is created for this timeline; otherwise, you won't receive notification. This happens automatically in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]; the parser automatically registers for the event before the <xref:System.Windows.Media.Animation.Clock> is created.  \n  \n## See also\n\n- [Animation and Timing System Overview](animation-and-timing-system-overview.md)\n- [Animation Overview](animation-overview.md)\n- [Timing Behaviors Overview](timing-behaviors-overview.md)\n","nodes":[{"pos":[4,210],"embed":true,"restype":"x-metadata","content":"title: \"Timing Events Overview\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"timelines [WPF]\"\n  - \"timing events [WPF]\"\nms.assetid: 597e3280-0867-4359-a97b-5b2f4149e350","nodes":[{"content":"Timing Events Overview","nodes":[{"pos":[0,22],"content":"Timing Events Overview","nodes":[{"content":"Timing Events Overview","pos":[0,22]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[217,239],"content":"Timing Events Overview","linkify":"Timing Events Overview","nodes":[{"content":"Timing Events Overview","pos":[0,22]}]},{"pos":[240,411],"content":"This topic describes how to use the five timing events available on <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> objects.","source":"This topic describes how to use the five timing events available on <xref:System.Windows.Media.Animation.Timeline> and <xref:System.Windows.Media.Animation.Clock> objects."},{"pos":[420,433],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"To understand this topic, you should understand how to create and use animations.","pos":[437,518]},{"content":"To get started with animation, see the <bpt id=\"p1\">[</bpt>Animation Overview<ept id=\"p1\">](animation-overview.md)</ept>.","pos":[519,602],"source":" To get started with animation, see the [Animation Overview](animation-overview.md)."},{"pos":[609,740],"content":"There are multiple ways to animate properties in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>:","source":"There are multiple ways to animate properties in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]:"},{"content":"<bpt id=\"p1\">**</bpt>Using storyboard objects<ept id=\"p1\">**</ept> (markup and code): You can use <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Storyboard&gt;</ph> objects to arrange and distribute animations to one or more objects.","pos":[750,927],"source":"**Using storyboard objects** (markup and code): You can use <xref:System.Windows.Media.Animation.Storyboard> objects to arrange and distribute animations to one or more objects."},{"content":"For an example, see <bpt id=\"p1\">[</bpt>Animate a Property by Using a Storyboard<ept id=\"p1\">](how-to-animate-a-property-by-using-a-storyboard.md)</ept>.","pos":[928,1043],"source":" For an example, see [Animate a Property by Using a Storyboard](how-to-animate-a-property-by-using-a-storyboard.md)."},{"content":"<bpt id=\"p1\">**</bpt>Using local animations<ept id=\"p1\">**</ept> (code only): You can apply <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline&gt;</ph> objects directly to the properties they animate.","pos":[1053,1211],"source":"**Using local animations** (code only): You can apply <xref:System.Windows.Media.Animation.AnimationTimeline> objects directly to the properties they animate."},{"content":"For an example, see <bpt id=\"p1\">[</bpt>Animate a Property Without Using a Storyboard<ept id=\"p1\">](how-to-animate-a-property-without-using-a-storyboard.md)</ept>.","pos":[1212,1337],"source":" For an example, see [Animate a Property Without Using a Storyboard](how-to-animate-a-property-without-using-a-storyboard.md)."},{"content":"<bpt id=\"p1\">**</bpt>Using clocks<ept id=\"p1\">**</ept> (code only): You can explicitly manage clock creation and distribute the animation clocks yourself.","pos":[1347,1463],"source":"**Using clocks** (code only): You can explicitly manage clock creation and distribute the animation clocks yourself."},{"content":"For an example, see <bpt id=\"p1\">[</bpt>Animate a Property by Using an AnimationClock<ept id=\"p1\">](how-to-animate-a-property-by-using-an-animationclock.md)</ept>.","pos":[1465,1590],"source":"  For an example, see [Animate a Property by Using an AnimationClock](how-to-animate-a-property-by-using-an-animationclock.md)."},{"content":"Because you can use them in markup and code, the examples in this overview use <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Storyboard&gt;</ph> objects.","pos":[1597,1733],"source":"Because you can use them in markup and code, the examples in this overview use <xref:System.Windows.Media.Animation.Storyboard> objects."},{"content":"However, the concepts described can be applied to the other methods of animating properties.","pos":[1734,1826]},{"pos":[1836,1852],"content":"What is a clock?","linkify":"What is a clock?","nodes":[{"content":"What is a clock?","pos":[0,16]}]},{"content":"A timeline, by itself, doesn't actually do anything other than describe a segment of time.","pos":[1856,1946]},{"content":"It's the timeline's <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> object that does the real work: it maintains timing-related run-time state for the timeline.","pos":[1947,2103],"source":" It's the timeline's <xref:System.Windows.Media.Animation.Clock> object that does the real work: it maintains timing-related run-time state for the timeline."},{"content":"In most cases, such as when using storyboards, a clock is created automatically for your timeline.","pos":[2104,2202]},{"content":"You can also create a <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> explicitly by using the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Timeline.CreateClock%2A&gt;</ph> method.","pos":[2203,2362],"source":" You can also create a <xref:System.Windows.Media.Animation.Clock> explicitly by using the <xref:System.Windows.Media.Animation.Timeline.CreateClock%2A> method."},{"content":"For more information about <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> objects, see the <bpt id=\"p1\">[</bpt>Animation and Timing System Overview<ept id=\"p1\">](animation-and-timing-system-overview.md)</ept>.","pos":[2363,2531],"source":" For more information about <xref:System.Windows.Media.Animation.Clock> objects, see the [Animation and Timing System Overview](animation-and-timing-system-overview.md)."},{"pos":[2540,2555],"content":"Why Use Events?","linkify":"Why Use Events?","nodes":[{"content":"Why Use Events?","pos":[0,15]}]},{"content":"With the exception of one (seek aligned to last tick), all interactive timing operations are asynchronous.","pos":[2559,2665]},{"content":"There is no way for you to know exactly when they will execute.","pos":[2666,2729]},{"content":"That can be a problem when you have other code that's dependent upon your timing operation.","pos":[2730,2821]},{"content":"Suppose that you wanted to stop a timeline that animated a rectangle.","pos":[2822,2891]},{"content":"After the timeline stops, you change the color of the rectangle.","pos":[2892,2956]},{"content":"In the previous example, the second line of code might execute before the storyboard stops.","pos":[3300,3391]},{"content":"That's because stopping is an asynchronous operation.","pos":[3392,3445]},{"content":"Telling a timeline or clock to stop creates a \"stop request\" of sorts that isn't processed until the timing engine's next tick.","pos":[3446,3573]},{"content":"To execute commands after a timeline completes, use timing events.","pos":[3580,3646]},{"content":"In the following example, an event handler is used to change the color of a rectangle after the storyboard stops playing.","pos":[3647,3768]},{"pos":[4628,4770],"content":"For a more complete example, see <bpt id=\"p1\">[</bpt>Receive Notification When a Clock's State Changes<ept id=\"p1\">](how-to-receive-notification-when-clock-state-changes.md)</ept>.","source":"For a more complete example, see [Receive Notification When a Clock's State Changes](how-to-receive-notification-when-clock-state-changes.md)."},{"pos":[4779,4792],"content":"Public Events","linkify":"Public Events","nodes":[{"content":"Public Events","pos":[0,13]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Timeline&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> classes both provide five timing events.","pos":[4796,4935],"source":"The <xref:System.Windows.Media.Animation.Timeline> and <xref:System.Windows.Media.Animation.Clock> classes both provide five timing events."},{"content":"The following table lists these events and the conditions that trigger them.","pos":[4936,5012]},{"content":"Event","pos":[5019,5024]},{"content":"Triggering interactive operation","pos":[5025,5057]},{"content":"Other triggers","pos":[5058,5072]},{"pos":[5153,5166],"content":"<bpt id=\"p1\">**</bpt>Completed<ept id=\"p1\">**</ept>","source":"**Completed**"},{"content":"Skip to fill","pos":[5167,5179]},{"content":"The clock completes.","pos":[5180,5200]},{"pos":[5205,5238],"content":"<bpt id=\"p1\">**</bpt>CurrentGlobalSpeedInvalidated<ept id=\"p1\">**</ept>","source":"**CurrentGlobalSpeedInvalidated**"},{"content":"Pause, resume, seek, set speed ratio, skip to fill, stop","pos":[5239,5295]},{"content":"The clock reverses, accelerates, starts, or stops.","pos":[5296,5346]},{"pos":[5351,5378],"content":"<bpt id=\"p1\">**</bpt>CurrentStateInvalidated<ept id=\"p1\">**</ept>","source":"**CurrentStateInvalidated**"},{"content":"Begin, skip to fill, stop","pos":[5379,5404]},{"content":"The clock starts, stops, or fills.","pos":[5405,5439]},{"pos":[5444,5470],"content":"<bpt id=\"p1\">**</bpt>CurrentTimeInvalidated<ept id=\"p1\">**</ept>","source":"**CurrentTimeInvalidated**"},{"content":"Begin, seek, skip to fill, stop","pos":[5471,5502]},{"content":"The clock progresses.","pos":[5503,5524]},{"pos":[5529,5548],"content":"<bpt id=\"p1\">**</bpt>RemoveRequested<ept id=\"p1\">**</ept>","source":"**RemoveRequested**"},{"content":"Remove","pos":[5549,5555]},{"pos":[5566,5597],"content":"Ticking and Event Consolidation","linkify":"Ticking and Event Consolidation","nodes":[{"content":"Ticking and Event Consolidation","pos":[0,31]}]},{"content":"When you animate objects in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>, it’s the timing engine that manages your animations.","pos":[5601,5764],"source":"When you animate objects in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], it’s the timing engine that manages your animations."},{"content":"The timing engine tracks the progression of time and computes the state of each animation.","pos":[5765,5855]},{"content":"It makes many such evaluation passes in a second.","pos":[5856,5905]},{"content":"These evaluation passes are known as \"ticks.\"","pos":[5906,5951]},{"content":"While ticks occur frequently, it's possible for a lot of things to happen between ticks.","pos":[5958,6046]},{"content":"For example, a timeline might be stopped, started, and stopped again, in which case its current state will have changed three times.","pos":[6047,6179]},{"content":"In theory, the event could be raised multiple times in a single tick; however, the timing engine consolidates events, so that each event can be raised at most once per tick.","pos":[6180,6353]},{"pos":[6362,6384],"content":"Registering for Events","linkify":"Registering for Events","nodes":[{"content":"Registering for Events","pos":[0,22]}]},{"content":"There are two ways to register for timing events: you can register with the timeline or with the clock created from the timeline.","pos":[6388,6517]},{"content":"Registering for an event directly with a clock is fairly straightforward, although it can only be done from code.","pos":[6518,6631]},{"content":"You can register for events with a timeline from markup or code.","pos":[6632,6696]},{"content":"The next section describes how to register for clock events with a timeline.","pos":[6697,6773]},{"pos":[6839,6883],"content":"Registering for Clock Events with a Timeline","linkify":"Registering for Clock Events with a Timeline","nodes":[{"content":"Registering for Clock Events with a Timeline","pos":[0,44]}]},{"pos":[6887,7449],"content":"Although a timeline's <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Timeline.Completed&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Timeline.CurrentGlobalSpeedInvalidated&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Media.Animation.Timeline.CurrentStateInvalidated&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Media.Animation.Timeline.CurrentTimeInvalidated&gt;</ph>, and <ph id=\"ph5\">&lt;xref:System.Windows.Media.Animation.Timeline.RemoveRequested&gt;</ph> events appear to be associated with the timeline, registering for these events actually associates an event handler with the <ph id=\"ph6\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> created for the timeline.","source":"Although a timeline's <xref:System.Windows.Media.Animation.Timeline.Completed>, <xref:System.Windows.Media.Animation.Timeline.CurrentGlobalSpeedInvalidated>, <xref:System.Windows.Media.Animation.Timeline.CurrentStateInvalidated>, <xref:System.Windows.Media.Animation.Timeline.CurrentTimeInvalidated>, and <xref:System.Windows.Media.Animation.Timeline.RemoveRequested> events appear to be associated with the timeline, registering for these events actually associates an event handler with the <xref:System.Windows.Media.Animation.Clock> created for the timeline."},{"content":"When you register for the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Timeline.Completed&gt;</ph> event on a timeline, for example, you're actually telling the system to register for the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Clock.Completed&gt;</ph> event of each clock that is created for the timeline.","pos":[7456,7735],"source":"When you register for the <xref:System.Windows.Media.Animation.Timeline.Completed> event on a timeline, for example, you're actually telling the system to register for the <xref:System.Windows.Media.Animation.Clock.Completed> event of each clock that is created for the timeline."},{"content":"In code, you must register for this event before the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> is created for this timeline; otherwise, you won't receive notification.","pos":[7736,7905],"source":" In code, you must register for this event before the <xref:System.Windows.Media.Animation.Clock> is created for this timeline; otherwise, you won't receive notification."},{"content":"This happens automatically in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph>; the parser automatically registers for the event before the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.Clock&gt;</ph> is created.","pos":[7906,8124],"source":" This happens automatically in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]; the parser automatically registers for the event before the <xref:System.Windows.Media.Animation.Clock> is created."},{"pos":[8133,8141],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8145,8224],"content":"<bpt id=\"p1\">[</bpt>Animation and Timing System Overview<ept id=\"p1\">](animation-and-timing-system-overview.md)</ept>","source":"[Animation and Timing System Overview](animation-and-timing-system-overview.md)"},{"pos":[8227,8270],"content":"<bpt id=\"p1\">[</bpt>Animation Overview<ept id=\"p1\">](animation-overview.md)</ept>","source":"[Animation Overview](animation-overview.md)"},{"pos":[8273,8330],"content":"<bpt id=\"p1\">[</bpt>Timing Behaviors Overview<ept id=\"p1\">](timing-behaviors-overview.md)</ept>","source":"[Timing Behaviors Overview](timing-behaviors-overview.md)"}]}