{"content":"---\ntitle: \"How to: Wrap a Windows Forms Control with ToolStripControlHost | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"ToolStripControlHost class\"\n  - \"ToolStrip control [Windows Forms], wrapping controls\"\n  - \"toolbars [Windows Forms], wrapping controls\"\n  - \"ToolStrip control [Windows Forms], hosting controls\"\nms.assetid: e2ce4990-661d-4882-a116-8a9eb575dc84\ncaps.latest.revision: 15\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Wrap a Windows Forms Control with ToolStripControlHost\n<xref:System.Windows.Forms.ToolStripControlHost> is designed to enable hosting of arbitrary Windows Forms controls by using the <xref:System.Windows.Forms.ToolStripControlHost> constructor or by extending <xref:System.Windows.Forms.ToolStripControlHost> itself. It is easier to wrap the control by extending <xref:System.Windows.Forms.ToolStripControlHost> and implementing properties and methods that expose frequently used properties and methods of the control. You can also expose events for the control at the <xref:System.Windows.Forms.ToolStripControlHost> level.  \n  \n### To host a control in a ToolStripControlHost by derivation  \n  \n1.  Extend <xref:System.Windows.Forms.ToolStripControlHost>. Implement a default constructor that calls the base class constructor passing in the desired control.  \n  \n     [!code-cpp[System.Windows.Forms.ToolStripControlHost#10](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#10)]\n     [!code-csharp[System.Windows.Forms.ToolStripControlHost#10](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#10)]\n     [!code-vb[System.Windows.Forms.ToolStripControlHost#10](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#10)]  \n  \n2.  Declare a property of the same type as the wrapped control and return `Control` as the correct type of control in the property's accessor.  \n  \n     [!code-cpp[System.Windows.Forms.ToolStripControlHost#11](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#11)]\n     [!code-csharp[System.Windows.Forms.ToolStripControlHost#11](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#11)]\n     [!code-vb[System.Windows.Forms.ToolStripControlHost#11](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#11)]  \n  \n3.  Expose other frequently used properties and methods of the wrapped control with properties and methods in the extended class.  \n  \n     [!code-cpp[System.Windows.Forms.ToolStripControlHost#12](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#12)]\n     [!code-csharp[System.Windows.Forms.ToolStripControlHost#12](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#12)]\n     [!code-vb[System.Windows.Forms.ToolStripControlHost#12](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#12)]  \n  \n4.  Optionally, override the <xref:System.Windows.Forms.ToolStripControlHost.OnSubscribeControlEvents%2A>, and <xref:System.Windows.Forms.ToolStripControlHost.OnUnsubscribeControlEvents%2A> methods and add the control events you want to expose.  \n  \n     [!code-cpp[System.Windows.Forms.ToolStripControlHost#16](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#16)]\n     [!code-csharp[System.Windows.Forms.ToolStripControlHost#16](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#16)]\n     [!code-vb[System.Windows.Forms.ToolStripControlHost#16](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#16)]  \n  \n5.  Provide the necessary wrapping for the events you want to expose.  \n  \n     [!code-cpp[System.Windows.Forms.ToolStripControlHost#17](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#17)]\n     [!code-csharp[System.Windows.Forms.ToolStripControlHost#17](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#17)]\n     [!code-vb[System.Windows.Forms.ToolStripControlHost#17](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#17)]  \n  \n## Example  \n [!code-cpp[System.Windows.Forms.ToolStripControlHost#13](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#13)]\n [!code-csharp[System.Windows.Forms.ToolStripControlHost#13](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#13)]\n [!code-vb[System.Windows.Forms.ToolStripControlHost#13](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#13)]  \n  \n## Compiling the Code  \n  \n-   This example requires:  \n  \n-   References to the System and System.Windows.Forms assemblies.  \n  \n For information about building this example from the command line for [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)] or [!INCLUDE[csprcs](../../../../includes/csprcs-md.md)], see [Building from the Command Line](~/docs/visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md). You can also build this example in [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] by pasting the code into a new project.  Also see [How to: Compile and Run a Complete Windows Forms Code Example Using Visual Studio](http://msdn.microsoft.com/library/Bb129228\\(v=vs.110\\)).  \n  \n## See Also  \n <xref:System.Windows.Forms.ToolStripControlHost>   \n [ToolStrip Control Overview](../../../../docs/framework/winforms/controls/toolstrip-control-overview-windows-forms.md)   \n [ToolStrip Control Architecture](../../../../docs/framework/winforms/controls/toolstrip-control-architecture.md)   \n [ToolStrip Technology Summary](../../../../docs/framework/winforms/controls/toolstrip-technology-summary.md)","nodes":[{"pos":[4,644],"embed":true,"restype":"x-metadata","content":"title: \"How to: Wrap a Windows Forms Control with ToolStripControlHost | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"ToolStripControlHost class\"\n  - \"ToolStrip control [Windows Forms], wrapping controls\"\n  - \"toolbars [Windows Forms], wrapping controls\"\n  - \"ToolStrip control [Windows Forms], hosting controls\"\nms.assetid: e2ce4990-661d-4882-a116-8a9eb575dc84\ncaps.latest.revision: 15\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"How to: Wrap a Windows Forms Control with ToolStripControlHost | Microsoft Docs","nodes":[{"pos":[0,79],"content":"How to: Wrap a Windows Forms Control with ToolStripControlHost | Microsoft Docs","nodes":[{"content":"How to: Wrap a Windows Forms Control with ToolStripControlHost | Microsoft Docs","pos":[0,79]}]}],"path":["title"]}],"yml":true},{"pos":[651,713],"content":"How to: Wrap a Windows Forms Control with ToolStripControlHost","linkify":"How to: Wrap a Windows Forms Control with ToolStripControlHost","nodes":[{"content":"How to: Wrap a Windows Forms Control with ToolStripControlHost","pos":[0,62]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph> is designed to enable hosting of arbitrary Windows Forms controls by using the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph> constructor or by extending <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph> itself.","pos":[714,975],"source":"<xref:System.Windows.Forms.ToolStripControlHost> is designed to enable hosting of arbitrary Windows Forms controls by using the <xref:System.Windows.Forms.ToolStripControlHost> constructor or by extending <xref:System.Windows.Forms.ToolStripControlHost> itself."},{"content":"It is easier to wrap the control by extending <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph> and implementing properties and methods that expose frequently used properties and methods of the control.","pos":[976,1177],"source":" It is easier to wrap the control by extending <xref:System.Windows.Forms.ToolStripControlHost> and implementing properties and methods that expose frequently used properties and methods of the control."},{"content":"You can also expose events for the control at the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph> level.","pos":[1178,1283],"source":" You can also expose events for the control at the <xref:System.Windows.Forms.ToolStripControlHost> level."},{"pos":[1293,1350],"content":"To host a control in a ToolStripControlHost by derivation","linkify":"To host a control in a ToolStripControlHost by derivation","nodes":[{"content":"To host a control in a ToolStripControlHost by derivation","pos":[0,57]}]},{"content":"Extend <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph>.","pos":[1360,1416],"source":"Extend <xref:System.Windows.Forms.ToolStripControlHost>."},{"content":"Implement a default constructor that calls the base class constructor passing in the desired control.","pos":[1417,1518]},{"pos":[1529,2063],"content":"[!code-cpp[System.Windows.Forms.ToolStripControlHost#10](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#10)]\n [!code-csharp[System.Windows.Forms.ToolStripControlHost#10](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#10)]\n [!code-vb[System.Windows.Forms.ToolStripControlHost#10](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#10)]","leadings":["","    ","    "],"nodes":[]},{"pos":[2073,2211],"content":"Declare a property of the same type as the wrapped control and return <ph id=\"ph1\">`Control`</ph> as the correct type of control in the property's accessor.","source":"Declare a property of the same type as the wrapped control and return `Control` as the correct type of control in the property's accessor."},{"pos":[2222,2756],"content":"[!code-cpp[System.Windows.Forms.ToolStripControlHost#11](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#11)]\n [!code-csharp[System.Windows.Forms.ToolStripControlHost#11](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#11)]\n [!code-vb[System.Windows.Forms.ToolStripControlHost#11](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#11)]","leadings":["","    ","    "],"nodes":[]},{"content":"Expose other frequently used properties and methods of the wrapped control with properties and methods in the extended class.","pos":[2766,2891]},{"pos":[2902,3436],"content":"[!code-cpp[System.Windows.Forms.ToolStripControlHost#12](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#12)]\n [!code-csharp[System.Windows.Forms.ToolStripControlHost#12](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#12)]\n [!code-vb[System.Windows.Forms.ToolStripControlHost#12](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#12)]","leadings":["","    ","    "],"nodes":[]},{"content":"Optionally, override the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripControlHost.OnSubscribeControlEvents%2A&gt;</ph>, and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripControlHost.OnUnsubscribeControlEvents%2A&gt;</ph> methods and add the control events you want to expose.","pos":[3446,3686],"source":"Optionally, override the <xref:System.Windows.Forms.ToolStripControlHost.OnSubscribeControlEvents%2A>, and <xref:System.Windows.Forms.ToolStripControlHost.OnUnsubscribeControlEvents%2A> methods and add the control events you want to expose."},{"pos":[3697,4231],"content":"[!code-cpp[System.Windows.Forms.ToolStripControlHost#16](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#16)]\n [!code-csharp[System.Windows.Forms.ToolStripControlHost#16](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#16)]\n [!code-vb[System.Windows.Forms.ToolStripControlHost#16](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#16)]","leadings":["","    ","    "],"nodes":[]},{"content":"Provide the necessary wrapping for the events you want to expose.","pos":[4241,4306]},{"pos":[4317,4851],"content":"[!code-cpp[System.Windows.Forms.ToolStripControlHost#17](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CPP/form1.cpp#17)]\n [!code-csharp[System.Windows.Forms.ToolStripControlHost#17](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/CS/form1.cs#17)]\n [!code-vb[System.Windows.Forms.ToolStripControlHost#17](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStripControlHost/VB/form1.vb#17)]","leadings":["","    ","    "],"nodes":[]},{"pos":[4860,4867],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5406,5424],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"This example requires:","pos":[5434,5456]},{"content":"References to the System and System.Windows.Forms assemblies.","pos":[5466,5527]},{"content":"For information about building this example from the command line for <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]</ph> or <ph id=\"ph2\">[!INCLUDE[csprcs](../../../../includes/csprcs-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Building from the Command Line<ept id=\"p1\">](~/docs/visual-basic/reference/command-line-compiler/building-from-the-command-line.md)</ept> or <bpt id=\"p2\">[</bpt>Command-line Building With csc.exe<ept id=\"p2\">](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)</ept>.","pos":[5534,5969],"source":"For information about building this example from the command line for [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)] or [!INCLUDE[csprcs](../../../../includes/csprcs-md.md)], see [Building from the Command Line](~/docs/visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)."},{"content":"You can also build this example in <ph id=\"ph1\">[!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)]</ph> by pasting the code into a new project.","pos":[5970,6098],"source":" You can also build this example in [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] by pasting the code into a new project."},{"content":"Also see <bpt id=\"p1\">[</bpt>How to: Compile and Run a Complete Windows Forms Code Example Using Visual Studio<ept id=\"p1\">](http://msdn.microsoft.com/library/Bb129228\\(v=vs.110\\))</ept>.","pos":[6100,6249],"source":"  Also see [How to: Compile and Run a Complete Windows Forms Code Example Using Visual Studio](http://msdn.microsoft.com/library/Bb129228\\(v=vs.110\\))."},{"pos":[6258,6266],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripControlHost&gt;</ph>","pos":[6270,6318],"source":"<xref:System.Windows.Forms.ToolStripControlHost> "},{"content":"<bpt id=\"p1\">[</bpt>ToolStrip Control Overview<ept id=\"p1\">](../../../../docs/framework/winforms/controls/toolstrip-control-overview-windows-forms.md)</ept><ph id=\"ph1\"> </ph>","pos":[6323,6442],"source":"[ToolStrip Control Overview](../../../../docs/framework/winforms/controls/toolstrip-control-overview-windows-forms.md) "},{"content":"<bpt id=\"p1\">[</bpt>ToolStrip Control Architecture<ept id=\"p1\">](../../../../docs/framework/winforms/controls/toolstrip-control-architecture.md)</ept><ph id=\"ph1\"> </ph>","pos":[6446,6559],"source":"[ToolStrip Control Architecture](../../../../docs/framework/winforms/controls/toolstrip-control-architecture.md) "},{"content":"<bpt id=\"p1\">[</bpt>ToolStrip Technology Summary<ept id=\"p1\">](../../../../docs/framework/winforms/controls/toolstrip-technology-summary.md)</ept>","pos":[6563,6671],"source":"[ToolStrip Technology Summary](../../../../docs/framework/winforms/controls/toolstrip-technology-summary.md)"}]}