{"content":"---\ntitle: \"Manipulating Files by Using .NET Framework Methods (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"I/O [Visual Basic], walkthroughs\"\n  - \"text files, writing to\"\n  - \"reading text files\"\n  - \"text, writing to files\"\n  - \"files, searching\"\n  - \"StreamReader class, walkthroughs\"\n  - \"files, accessing\"\n  - \"I/O [Visual Basic], writing text to files\"\n  - \"writing to files, walkthroughs\"\n  - \"StreamWriter class, walkthroughs\"\n  - \"text files, reading\"\n  - \"I/O [Visual Basic], reading text from files\"\nms.assetid: 7d2109eb-f98a-4389-b43d-30f384aaa7d5\ncaps.latest.revision: 18\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Walkthrough: Manipulating Files by Using .NET Framework Methods (Visual Basic)\nThis walkthrough demonstrates how to open and read a file using the <xref:System.IO.StreamReader> class, check to see if a file is being accessed, search for a string within a file read with an instance of the <xref:System.IO.StreamReader> class, and write to a file using the <xref:System.IO.StreamWriter> class.  \n  \n[!INCLUDE[note_settings_general](../../../../csharp/language-reference/compiler-messages/includes/note_settings_general_md.md)]  \n  \n## Creating the Application  \n Start [!INCLUDE[vsprvs](../../../../csharp/includes/vsprvs_md.md)] and begin the project by creating a form that the user can use to write to the designated file.  \n  \n#### To create the project  \n  \n1.  On the **File** menu, select **New Project**.  \n  \n2.  In the **New Project** pane, click **Windows Application**.  \n  \n3.  In the **Name** box type `MyDiary` and click **OK**.  \n  \n     [!INCLUDE[vsprvs](../../../../csharp/includes/vsprvs_md.md)] adds the project to **Solution Explorer**, and the **Windows Forms Designer** opens.  \n  \n4.  Add the controls in the following table to the form and set the corresponding values for their properties.  \n  \n|**Object**|**Properties**|**Value**|  \n|---|---|---|   \n|<xref:System.Windows.Forms.Button>|**Name**<br /><br /> **Text**|`Submit`<br /><br /> **Submit Entry**|  \n|<xref:System.Windows.Forms.Button>|**Name**<br /><br /> **Text**|`Clear`<br /><br /> **Clear Entry**|  \n|<xref:System.Windows.Forms.TextBox>|**Name**<br /><br /> **Text**<br /><br /> **Multiline**|`Entry`<br /><br /> **Please enter something.**<br /><br /> `False`|  \n  \n## Writing to the File  \n To add the ability to write to a file via the application, use the <xref:System.IO.StreamWriter> class. <xref:System.IO.StreamWriter> is designed for character output in a particular encoding, whereas the <xref:System.IO.Stream> class is designed for byte input and output. Use <xref:System.IO.StreamWriter> for writing lines of information to a standard text file. For more information on the <xref:System.IO.StreamWriter> class, see <xref:System.IO.StreamWriter>.  \n  \n#### To add writing functionality  \n  \n1.  From the **View** menu, choose **Code** to open the Code Editor.  \n  \n2.  Because the application references the <xref:System.IO> namespace, add the following statements at the very beginning of your code, before the class declaration for the form, which begins `Public Class Form1`.  \n  \n     [!code-vb[VbVbcnMyFileSystem#35](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_1.vb)]  \n  \n     Before writing to the file, you must create an instance of a <xref:System.IO.StreamWriter> class.  \n  \n3.  From the **View** menu, choose **Designer** to return to the **Windows Forms Designer**. Double-click the `Submit` button to create a <xref:System.Windows.Forms.Control.Click> event handler for the button, and then add the following code.  \n  \n     [!code-vb[VbVbcnMyFileSystem#36](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_2.vb)]  \n  \n> [!NOTE]\n>  The Visual Studio Integrated Development Environment (IDE) will return to the Code Editor and position the insertion point within the event handler where you should add the code.  \n  \n1.  To write to the file, use the <xref:System.IO.StreamWriter.Write%2A> method of the <xref:System.IO.StreamWriter> class. Add the following code directly after `Dim fw As StreamWriter`. You do not need to worry that an exception will be thrown if the file is not found, because it will be created if it does not already exist.  \n  \n     [!code-vb[VbVbcnMyFileSystem#37](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_3.vb)]  \n  \n2.  Make sure that the user cannot submit a blank entry by adding the following code directly after `Dim ReadString As String`.  \n  \n     [!code-vb[VbVbcnMyFileSystem#38](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_4.vb)]  \n  \n3.  Because this is a diary, the user will want to assign a date to each entry. Insert the following code after `fw = New StreamWriter(\"C:\\MyDiary.txt\", True)` to set the variable `Today` to the current date.  \n  \n     [!code-vb[VbVbcnMyFileSystem#39](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_5.vb)]  \n  \n4.  Finally, attach code to clear the <xref:System.Windows.Forms.TextBox>. Add the following code to the `Clear` button's <xref:System.Windows.Forms.Control.Click> event.  \n  \n     [!code-vb[VbVbcnMyFileSystem#40](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_6.vb)]  \n  \n## Adding Display Features to the Diary  \n In this section, you add a feature that displays the latest entry in the `DisplayEntry`<xref:System.Windows.Forms.TextBox>. You can also add a <xref:System.Windows.Forms.ComboBox> that displays various entries and from which a user can select an entry to display in the `DisplayEntry`<xref:System.Windows.Forms.TextBox>. An instance of the <xref:System.IO.StreamReader> class reads from `MyDiary.txt`. Like the <xref:System.IO.StreamWriter> class, <xref:System.IO.StreamReader> is intended for use with text files.  \n  \n For this section of the walkthrough, add the controls in the following table to the form and set the corresponding values for their properties.  \n  \n|Control|Properties|Values|  \n|-------------|----------------|------------|  \n|<xref:System.Windows.Forms.TextBox>|**Name**<br /><br /> **Visible**<br /><br /> **Size**<br /><br /> **Multiline**|`DisplayEntry`<br /><br /> `False`<br /><br /> `120,60`<br /><br /> `True`|  \n|<xref:System.Windows.Forms.Button>|**Name**<br /><br /> **Text**|`Display`<br /><br /> **Display**|  \n|<xref:System.Windows.Forms.Button>|**Name**<br /><br /> **Text**|`GetEntries`<br /><br /> **Get Entries**|  \n|<xref:System.Windows.Forms.ComboBox>|**Name**<br /><br /> **Text**<br /><br /> **Enabled**|`PickEntries`<br /><br /> **Select an Entry**<br /><br /> `False`|  \n  \n#### To populate the combo box  \n  \n1.  The `PickEntries`<xref:System.Windows.Forms.ComboBox> is used to display the dates on which a user submits each entry, so the user can select an entry from a specific date. Create a <xref:System.Windows.Forms.Control.Click> event handler to the `GetEntries` button and add the following code.  \n  \n     [!code-vb[VbVbcnMyFileSystem#41](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_7.vb)]  \n  \n2.  To test your code, press F5 to compile the application, and then click **Get Entries**. Click the drop-down arrow in the <xref:System.Windows.Forms.ComboBox> to display the entry dates.  \n  \n#### To choose and display individual entries  \n  \n1.  Create a <xref:System.Windows.Forms.Control.Click> event handler for the `Display` button and add the following code.  \n  \n     [!code-vb[VbVbcnMyFileSystem#42](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_8.vb)]  \n  \n2.  To test your code, press F5 to compile the application, and then submit an entry. Click **Get Entries**, select an entry from the <xref:System.Windows.Forms.ComboBox>, and then click **Display**. The contents of the selected entry appear in the `DisplayEntry`<xref:System.Windows.Forms.TextBox>.  \n  \n## Enabling Users to Delete or Modify Entries  \n Finally, you can include additional functionality enables users to delete or modify an entry by using `DeleteEntry` and `EditEntry` buttons. Both buttons remain disabled unless an entry is displayed.  \n  \n Add the controls in the following table to the form and set the corresponding values for their properties.  \n  \n|Control|Properties|Values|  \n|-------------|----------------|------------|  \n|<xref:System.Windows.Forms.Button>|**Name**<br /><br /> **Text**<br /><br /> **Enabled**|`DeleteEntry`<br /><br /> **Delete Entry**<br /><br /> `False`|  \n|<xref:System.Windows.Forms.Button>|**Name**<br /><br /> **Text**<br /><br /> **Enabled**|`EditEntry`<br /><br /> **Edit Entry**<br /><br /> `False`|  \n|<xref:System.Windows.Forms.Button>|**Name**<br /><br /> **Text**<br /><br /> **Enabled**|`SubmitEdit`<br /><br /> **Submit Edit**<br /><br /> `False`|  \n  \n#### To enable deletion and modification of entries  \n  \n1.  Add the following code to the `Display` button's <xref:System.Windows.Forms.Control.Click> event, after `DisplayEntry.Text = ReadString`.  \n  \n     [!code-vb[VbVbcnMyFileSystem#43](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_9.vb)]  \n  \n2.  Create a <xref:System.Windows.Forms.Control.Click> event handler for the `DeleteEntry` button and add the following code.  \n  \n     [!code-vb[VbVbcnMyFileSystem#44](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_10.vb)]  \n  \n3.  When a user displays an entry, the `EditEntry` button becomes enabled. Add the following code to the <xref:System.Windows.Forms.Control.Click> event of the `Display` button after `DisplayEntry.Text = ReadString`.  \n  \n     [!code-vb[VbVbcnMyFileSystem#45](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_11.vb)]  \n  \n4.  Create a <xref:System.Windows.Forms.Control.Click> event handler for the `EditEntry` button and add the following code.  \n  \n     [!code-vb[VbVbcnMyFileSystem#46](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_12.vb)]  \n  \n5.  Create a <xref:System.Windows.Forms.Control.Click> event handler for the `SubmitEdit` button and add the following code  \n  \n     [!code-vb[VbVbcnMyFileSystem#47](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_13.vb)]  \n  \n To test your code, press F5 to compile the application. Click **Get Entries**, select an entry, and then click **Display**. The entry appears in the `DisplayEntry`<xref:System.Windows.Forms.TextBox>. Click **Edit Entry**. The entry appears in the `Entry`<xref:System.Windows.Forms.TextBox>. Edit the entry in the `Entry`<xref:System.Windows.Forms.TextBox> and click **Submit Edit**. Open the `MyDiary.txt` file to confirm your correction. Now select an entry and click **Delete Entry**. When the <xref:System.Windows.Forms.MessageBox> requests confirmation, click **OK**. Close the application and open `MyDiary.txt` to confirm the deletion.  \n  \n## See Also  \n <xref:System.IO.StreamReader>   \n <xref:System.IO.StreamWriter>   \n [Walkthroughs](../../../../visual-basic/walkthroughs.md)\n","nodes":[{"pos":[12,94],"content":"Manipulating Files by Using .NET Framework Methods (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Manipulating Files by Using .NET Framework Methods (Visual Basic) | Microsoft Docs","pos":[0,82]}]},{"pos":[996,1074],"content":"Walkthrough: Manipulating Files by Using .NET Framework Methods (Visual Basic)","linkify":"Walkthrough: Manipulating Files by Using .NET Framework Methods (Visual Basic)","nodes":[{"content":"Walkthrough: Manipulating Files by Using .NET Framework Methods (Visual Basic)","pos":[0,78]}]},{"content":"This walkthrough demonstrates how to open and read a file using the <ph id=\"ph1\">&lt;xref:System.IO.StreamReader&gt;</ph> class, check to see if a file is being accessed, search for a string within a file read with an instance of the <ph id=\"ph2\">&lt;xref:System.IO.StreamReader&gt;</ph> class, and write to a file using the <ph id=\"ph3\">&lt;xref:System.IO.StreamWriter&gt;</ph> class.","pos":[1075,1388],"source":"This walkthrough demonstrates how to open and read a file using the <xref:System.IO.StreamReader> class, check to see if a file is being accessed, search for a string within a file read with an instance of the <xref:System.IO.StreamReader> class, and write to a file using the <xref:System.IO.StreamWriter> class."},{"pos":[1530,1554],"content":"Creating the Application","linkify":"Creating the Application","nodes":[{"content":"Creating the Application","pos":[0,24]}]},{"pos":[1558,1720],"content":"Start <ph id=\"ph1\">[!INCLUDE[vsprvs](../../../../csharp/includes/vsprvs_md.md)]</ph> and begin the project by creating a form that the user can use to write to the designated file.","source":"Start [!INCLUDE[vsprvs](../../../../csharp/includes/vsprvs_md.md)] and begin the project by creating a form that the user can use to write to the designated file."},{"pos":[1731,1752],"content":"To create the project","linkify":"To create the project","nodes":[{"content":"To create the project","pos":[0,21]}]},{"pos":[1762,1807],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, select <bpt id=\"p2\">**</bpt>New Project<ept id=\"p2\">**</ept>.","source":"On the **File** menu, select **New Project**."},{"pos":[1817,1876],"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> pane, click <bpt id=\"p2\">**</bpt>Windows Application<ept id=\"p2\">**</ept>.","source":"In the **New Project** pane, click **Windows Application**."},{"pos":[1886,1938],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box type <ph id=\"ph1\">`MyDiary`</ph> and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"In the **Name** box type `MyDiary` and click **OK**."},{"pos":[1949,2094],"content":"<ph id=\"ph1\">[!INCLUDE[vsprvs](../../../../csharp/includes/vsprvs_md.md)]</ph> adds the project to <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, and the <bpt id=\"p2\">**</bpt>Windows Forms Designer<ept id=\"p2\">**</ept> opens.","source":"[!INCLUDE[vsprvs](../../../../csharp/includes/vsprvs_md.md)] adds the project to **Solution Explorer**, and the **Windows Forms Designer** opens."},{"content":"Add the controls in the following table to the form and set the corresponding values for their properties.","pos":[2104,2210]},{"pos":[2217,2227],"content":"<bpt id=\"p1\">**</bpt>Object<ept id=\"p1\">**</ept>","source":"**Object**"},{"pos":[2228,2242],"content":"<bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>","source":"**Properties**"},{"pos":[2243,2252],"content":"<bpt id=\"p1\">**</bpt>Value<ept id=\"p1\">**</ept>","source":"**Value**"},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[2309,2317],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept>","pos":[2330,2338],"source":"**Text**"},{"content":"<bpt id=\"p1\">**</bpt>Submit Entry<ept id=\"p1\">**</ept>","pos":[2360,2376],"source":"**Submit Entry**"},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[2416,2424],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept>","pos":[2437,2445],"source":"**Text**"},{"content":"<bpt id=\"p1\">**</bpt>Clear Entry<ept id=\"p1\">**</ept>","pos":[2466,2481],"source":"**Clear Entry**"},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[2522,2530],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept>","pos":[2543,2551],"source":"**Text**"},{"content":"<bpt id=\"p1\">**</bpt>Multiline<ept id=\"p1\">**</ept>","pos":[2564,2577],"source":"**Multiline**"},{"content":"<bpt id=\"p1\">**</bpt>Please enter something.<ept id=\"p1\">**</ept>","pos":[2598,2625],"source":"**Please enter something.**"},{"pos":[2655,2674],"content":"Writing to the File","linkify":"Writing to the File","nodes":[{"content":"Writing to the File","pos":[0,19]}]},{"content":"To add the ability to write to a file via the application, use the <ph id=\"ph1\">&lt;xref:System.IO.StreamWriter&gt;</ph> class.","pos":[2678,2781],"source":"To add the ability to write to a file via the application, use the <xref:System.IO.StreamWriter> class."},{"content":"<ph id=\"ph1\">&lt;xref:System.IO.StreamWriter&gt;</ph> is designed for character output in a particular encoding, whereas the <ph id=\"ph2\">&lt;xref:System.IO.Stream&gt;</ph> class is designed for byte input and output.","pos":[2782,2951],"source":"<xref:System.IO.StreamWriter> is designed for character output in a particular encoding, whereas the <xref:System.IO.Stream> class is designed for byte input and output."},{"content":"Use <ph id=\"ph1\">&lt;xref:System.IO.StreamWriter&gt;</ph> for writing lines of information to a standard text file.","pos":[2952,3043],"source":" Use <xref:System.IO.StreamWriter> for writing lines of information to a standard text file."},{"content":"For more information on the <ph id=\"ph1\">&lt;xref:System.IO.StreamWriter&gt;</ph> class, see <ph id=\"ph2\">&lt;xref:System.IO.StreamWriter&gt;</ph>.","pos":[3044,3143],"source":" For more information on the <xref:System.IO.StreamWriter> class, see <xref:System.IO.StreamWriter>."},{"pos":[3154,3182],"content":"To add writing functionality","linkify":"To add writing functionality","nodes":[{"content":"To add writing functionality","pos":[0,28]}]},{"pos":[3192,3256],"content":"From the <bpt id=\"p1\">**</bpt>View<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Code<ept id=\"p2\">**</ept> to open the Code Editor.","source":"From the **View** menu, choose **Code** to open the Code Editor."},{"pos":[3266,3475],"content":"Because the application references the <ph id=\"ph1\">&lt;xref:System.IO&gt;</ph> namespace, add the following statements at the very beginning of your code, before the class declaration for the form, which begins <ph id=\"ph2\">`Public Class Form1`</ph>.","source":"Because the application references the <xref:System.IO> namespace, add the following statements at the very beginning of your code, before the class declaration for the form, which begins `Public Class Form1`."},{"pos":[3486,3689],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#35<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#35](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_1.vb)]"},{"content":"Before writing to the file, you must create an instance of a <ph id=\"ph1\">&lt;xref:System.IO.StreamWriter&gt;</ph> class.","pos":[3700,3797],"source":"Before writing to the file, you must create an instance of a <xref:System.IO.StreamWriter> class."},{"content":"From the <bpt id=\"p1\">**</bpt>View<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Designer<ept id=\"p2\">**</ept> to return to the <bpt id=\"p3\">**</bpt>Windows Forms Designer<ept id=\"p3\">**</ept>.","pos":[3807,3895],"source":"From the **View** menu, choose **Designer** to return to the **Windows Forms Designer**."},{"content":"Double-click the <ph id=\"ph1\">`Submit`</ph> button to create a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler for the button, and then add the following code.","pos":[3896,4045],"source":" Double-click the `Submit` button to create a <xref:System.Windows.Forms.Control.Click> event handler for the button, and then add the following code."},{"pos":[4056,4259],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#36<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_2.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#36](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_2.vb)]"},{"pos":[4267,4456],"content":"[!NOTE]\n The Visual Studio Integrated Development Environment (IDE) will return to the Code Editor and position the insertion point within the event handler where you should add the code.","leadings":["","> "],"nodes":[{"content":"The Visual Studio Integrated Development Environment (IDE) will return to the Code Editor and position the insertion point within the event handler where you should add the code.","pos":[9,187]}]},{"content":"To write to the file, use the <ph id=\"ph1\">&lt;xref:System.IO.StreamWriter.Write%2A&gt;</ph> method of the <ph id=\"ph2\">&lt;xref:System.IO.StreamWriter&gt;</ph> class.","pos":[4466,4585],"source":"To write to the file, use the <xref:System.IO.StreamWriter.Write%2A> method of the <xref:System.IO.StreamWriter> class."},{"content":"Add the following code directly after <ph id=\"ph1\">`Dim fw As StreamWriter`</ph>.","pos":[4586,4649],"source":" Add the following code directly after `Dim fw As StreamWriter`."},{"content":"You do not need to worry that an exception will be thrown if the file is not found, because it will be created if it does not already exist.","pos":[4650,4790]},{"pos":[4801,5004],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#37<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_3.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#37](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_3.vb)]"},{"pos":[5014,5137],"content":"Make sure that the user cannot submit a blank entry by adding the following code directly after <ph id=\"ph1\">`Dim ReadString As String`</ph>.","source":"Make sure that the user cannot submit a blank entry by adding the following code directly after `Dim ReadString As String`."},{"pos":[5148,5351],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#38<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_4.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#38](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_4.vb)]"},{"content":"Because this is a diary, the user will want to assign a date to each entry.","pos":[5361,5436]},{"content":"Insert the following code after <ph id=\"ph1\">`fw = New StreamWriter(\"C:\\MyDiary.txt\", True)`</ph> to set the variable <ph id=\"ph2\">`Today`</ph> to the current date.","pos":[5437,5565],"source":" Insert the following code after `fw = New StreamWriter(\"C:\\MyDiary.txt\", True)` to set the variable `Today` to the current date."},{"pos":[5576,5779],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#39<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_5.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#39](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_5.vb)]"},{"content":"Finally, attach code to clear the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph>.","pos":[5789,5859],"source":"Finally, attach code to clear the <xref:System.Windows.Forms.TextBox>."},{"content":"Add the following code to the <ph id=\"ph1\">`Clear`</ph> button's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event.","pos":[5860,5955],"source":" Add the following code to the `Clear` button's <xref:System.Windows.Forms.Control.Click> event."},{"pos":[5966,6169],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#40<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_6.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#40](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_6.vb)]"},{"pos":[6178,6214],"content":"Adding Display Features to the Diary","linkify":"Adding Display Features to the Diary","nodes":[{"content":"Adding Display Features to the Diary","pos":[0,36]}]},{"content":"In this section, you add a feature that displays the latest entry in the <ph id=\"ph1\">`DisplayEntry`</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph>.","pos":[6218,6341],"source":"In this section, you add a feature that displays the latest entry in the `DisplayEntry`<xref:System.Windows.Forms.TextBox>."},{"content":"You can also add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ComboBox&gt;</ph> that displays various entries and from which a user can select an entry to display in the <ph id=\"ph2\">`DisplayEntry`</ph><ph id=\"ph3\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph>.","pos":[6342,6538],"source":" You can also add a <xref:System.Windows.Forms.ComboBox> that displays various entries and from which a user can select an entry to display in the `DisplayEntry`<xref:System.Windows.Forms.TextBox>."},{"content":"An instance of the <ph id=\"ph1\">&lt;xref:System.IO.StreamReader&gt;</ph> class reads from <ph id=\"ph2\">`MyDiary.txt`</ph>.","pos":[6539,6619],"source":" An instance of the <xref:System.IO.StreamReader> class reads from `MyDiary.txt`."},{"content":"Like the <ph id=\"ph1\">&lt;xref:System.IO.StreamWriter&gt;</ph> class, <ph id=\"ph2\">&lt;xref:System.IO.StreamReader&gt;</ph> is intended for use with text files.","pos":[6620,6732],"source":" Like the <xref:System.IO.StreamWriter> class, <xref:System.IO.StreamReader> is intended for use with text files."},{"content":"For this section of the walkthrough, add the controls in the following table to the form and set the corresponding values for their properties.","pos":[6739,6882]},{"content":"Control","pos":[6889,6896]},{"content":"Properties","pos":[6897,6907]},{"content":"Values","pos":[6908,6914]},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[7003,7011],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Visible<ept id=\"p1\">**</ept>","pos":[7024,7035],"source":"**Visible**"},{"content":"<bpt id=\"p1\">**</bpt>Size<ept id=\"p1\">**</ept>","pos":[7048,7056],"source":"**Size**"},{"content":"<bpt id=\"p1\">**</bpt>Multiline<ept id=\"p1\">**</ept>","pos":[7069,7082],"source":"**Multiline**"},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[7197,7205],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept>","pos":[7218,7226],"source":"**Text**"},{"content":"<bpt id=\"p1\">**</bpt>Display<ept id=\"p1\">**</ept>","pos":[7249,7260],"source":"**Display**"},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[7300,7308],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept>","pos":[7321,7329],"source":"**Text**"},{"content":"<bpt id=\"p1\">**</bpt>Get Entries<ept id=\"p1\">**</ept>","pos":[7355,7370],"source":"**Get Entries**"},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[7412,7420],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept>","pos":[7433,7441],"source":"**Text**"},{"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>","pos":[7454,7465],"source":"**Enabled**"},{"content":"<bpt id=\"p1\">**</bpt>Select an Entry<ept id=\"p1\">**</ept>","pos":[7492,7511],"source":"**Select an Entry**"},{"pos":[7543,7568],"content":"To populate the combo box","linkify":"To populate the combo box","nodes":[{"content":"To populate the combo box","pos":[0,25]}]},{"content":"The <ph id=\"ph1\">`PickEntries`</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.ComboBox&gt;</ph> is used to display the dates on which a user submits each entry, so the user can select an entry from a specific date.","pos":[7578,7750],"source":"The `PickEntries`<xref:System.Windows.Forms.ComboBox> is used to display the dates on which a user submits each entry, so the user can select an entry from a specific date."},{"content":"Create a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler to the <ph id=\"ph2\">`GetEntries`</ph> button and add the following code.","pos":[7751,7870],"source":" Create a <xref:System.Windows.Forms.Control.Click> event handler to the `GetEntries` button and add the following code."},{"pos":[7881,8084],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#41<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_7.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#41](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_7.vb)]"},{"content":"To test your code, press F5 to compile the application, and then click <bpt id=\"p1\">**</bpt>Get Entries<ept id=\"p1\">**</ept>.","pos":[8094,8181],"source":"To test your code, press F5 to compile the application, and then click **Get Entries**."},{"content":"Click the drop-down arrow in the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ComboBox&gt;</ph> to display the entry dates.","pos":[8182,8279],"source":" Click the drop-down arrow in the <xref:System.Windows.Forms.ComboBox> to display the entry dates."},{"pos":[8290,8330],"content":"To choose and display individual entries","linkify":"To choose and display individual entries","nodes":[{"content":"To choose and display individual entries","pos":[0,40]}]},{"pos":[8340,8457],"content":"Create a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler for the <ph id=\"ph2\">`Display`</ph> button and add the following code.","source":"Create a <xref:System.Windows.Forms.Control.Click> event handler for the `Display` button and add the following code."},{"pos":[8468,8671],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#42<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_8.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#42](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_8.vb)]"},{"content":"To test your code, press F5 to compile the application, and then submit an entry.","pos":[8681,8762]},{"content":"Click <bpt id=\"p1\">**</bpt>Get Entries<ept id=\"p1\">**</ept>, select an entry from the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ComboBox&gt;</ph>, and then click <bpt id=\"p2\">**</bpt>Display<ept id=\"p2\">**</ept>.","pos":[8763,8876],"source":" Click **Get Entries**, select an entry from the <xref:System.Windows.Forms.ComboBox>, and then click **Display**."},{"content":"The contents of the selected entry appear in the <ph id=\"ph1\">`DisplayEntry`</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph>.","pos":[8877,8976],"source":" The contents of the selected entry appear in the `DisplayEntry`<xref:System.Windows.Forms.TextBox>."},{"pos":[8985,9027],"content":"Enabling Users to Delete or Modify Entries","linkify":"Enabling Users to Delete or Modify Entries","nodes":[{"content":"Enabling Users to Delete or Modify Entries","pos":[0,42]}]},{"content":"Finally, you can include additional functionality enables users to delete or modify an entry by using <ph id=\"ph1\">`DeleteEntry`</ph> and <ph id=\"ph2\">`EditEntry`</ph> buttons.","pos":[9031,9171],"source":"Finally, you can include additional functionality enables users to delete or modify an entry by using `DeleteEntry` and `EditEntry` buttons."},{"content":"Both buttons remain disabled unless an entry is displayed.","pos":[9172,9230]},{"content":"Add the controls in the following table to the form and set the corresponding values for their properties.","pos":[9237,9343]},{"content":"Control","pos":[9350,9357]},{"content":"Properties","pos":[9358,9368]},{"content":"Values","pos":[9369,9375]},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[9463,9471],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept>","pos":[9484,9492],"source":"**Text**"},{"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>","pos":[9505,9516],"source":"**Enabled**"},{"content":"<bpt id=\"p1\">**</bpt>Delete Entry<ept id=\"p1\">**</ept>","pos":[9543,9559],"source":"**Delete Entry**"},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[9619,9627],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept>","pos":[9640,9648],"source":"**Text**"},{"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>","pos":[9661,9672],"source":"**Enabled**"},{"content":"<bpt id=\"p1\">**</bpt>Edit Entry<ept id=\"p1\">**</ept>","pos":[9697,9711],"source":"**Edit Entry**"},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[9771,9779],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept>","pos":[9792,9800],"source":"**Text**"},{"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>","pos":[9813,9824],"source":"**Enabled**"},{"content":"<bpt id=\"p1\">**</bpt>Submit Edit<ept id=\"p1\">**</ept>","pos":[9850,9865],"source":"**Submit Edit**"},{"pos":[9897,9943],"content":"To enable deletion and modification of entries","linkify":"To enable deletion and modification of entries","nodes":[{"content":"To enable deletion and modification of entries","pos":[0,46]}]},{"pos":[9953,10090],"content":"Add the following code to the <ph id=\"ph1\">`Display`</ph> button's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event, after <ph id=\"ph3\">`DisplayEntry.Text = ReadString`</ph>.","source":"Add the following code to the `Display` button's <xref:System.Windows.Forms.Control.Click> event, after `DisplayEntry.Text = ReadString`."},{"pos":[10101,10304],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#43<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_9.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#43](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_9.vb)]"},{"pos":[10314,10435],"content":"Create a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler for the <ph id=\"ph2\">`DeleteEntry`</ph> button and add the following code.","source":"Create a <xref:System.Windows.Forms.Control.Click> event handler for the `DeleteEntry` button and add the following code."},{"pos":[10446,10650],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#44<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_10.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#44](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_10.vb)]"},{"content":"When a user displays an entry, the <ph id=\"ph1\">`EditEntry`</ph> button becomes enabled.","pos":[10660,10730],"source":"When a user displays an entry, the `EditEntry` button becomes enabled."},{"content":"Add the following code to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event of the <ph id=\"ph2\">`Display`</ph> button after <ph id=\"ph3\">`DisplayEntry.Text = ReadString`</ph>.","pos":[10731,10872],"source":" Add the following code to the <xref:System.Windows.Forms.Control.Click> event of the `Display` button after `DisplayEntry.Text = ReadString`."},{"pos":[10883,11087],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#45<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_11.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#45](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_11.vb)]"},{"pos":[11097,11216],"content":"Create a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler for the <ph id=\"ph2\">`EditEntry`</ph> button and add the following code.","source":"Create a <xref:System.Windows.Forms.Control.Click> event handler for the `EditEntry` button and add the following code."},{"pos":[11227,11431],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#46<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_12.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#46](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_12.vb)]"},{"pos":[11441,11560],"content":"Create a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler for the <ph id=\"ph2\">`SubmitEdit`</ph> button and add the following code","source":"Create a <xref:System.Windows.Forms.Control.Click> event handler for the `SubmitEdit` button and add the following code"},{"pos":[11571,11775],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#47<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_13.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#47](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-by-using-net-framework-methods_13.vb)]"},{"content":"To test your code, press F5 to compile the application.","pos":[11782,11837]},{"content":"Click <bpt id=\"p1\">**</bpt>Get Entries<ept id=\"p1\">**</ept>, select an entry, and then click <bpt id=\"p2\">**</bpt>Display<ept id=\"p2\">**</ept>.","pos":[11838,11905],"source":" Click **Get Entries**, select an entry, and then click **Display**."},{"content":"The entry appears in the <ph id=\"ph1\">`DisplayEntry`</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph>.","pos":[11906,11981],"source":" The entry appears in the `DisplayEntry`<xref:System.Windows.Forms.TextBox>."},{"content":"Click <bpt id=\"p1\">**</bpt>Edit Entry<ept id=\"p1\">**</ept>.","pos":[11982,12003],"source":" Click **Edit Entry**."},{"content":"The entry appears in the <ph id=\"ph1\">`Entry`</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph>.","pos":[12004,12072],"source":" The entry appears in the `Entry`<xref:System.Windows.Forms.TextBox>."},{"content":"Edit the entry in the <ph id=\"ph1\">`Entry`</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph> and click <bpt id=\"p1\">**</bpt>Submit Edit<ept id=\"p1\">**</ept>.","pos":[12073,12164],"source":" Edit the entry in the `Entry`<xref:System.Windows.Forms.TextBox> and click **Submit Edit**."},{"content":"Open the <ph id=\"ph1\">`MyDiary.txt`</ph> file to confirm your correction.","pos":[12165,12220],"source":" Open the `MyDiary.txt` file to confirm your correction."},{"content":"Now select an entry and click <bpt id=\"p1\">**</bpt>Delete Entry<ept id=\"p1\">**</ept>.","pos":[12221,12268],"source":" Now select an entry and click **Delete Entry**."},{"content":"When the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MessageBox&gt;</ph> requests confirmation, click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[12269,12353],"source":" When the <xref:System.Windows.Forms.MessageBox> requests confirmation, click **OK**."},{"content":"Close the application and open <ph id=\"ph1\">`MyDiary.txt`</ph> to confirm the deletion.","pos":[12354,12423],"source":" Close the application and open `MyDiary.txt` to confirm the deletion."},{"pos":[12432,12440],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>Walkthroughs<ept id=\"p1\">](../../../../visual-basic/walkthroughs.md)</ept>","pos":[12511,12568],"source":" [Walkthroughs](../../../../visual-basic/walkthroughs.md)"}]}