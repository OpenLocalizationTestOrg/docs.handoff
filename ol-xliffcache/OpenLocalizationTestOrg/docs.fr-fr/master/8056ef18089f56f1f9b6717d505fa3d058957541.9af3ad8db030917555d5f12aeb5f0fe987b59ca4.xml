{"content":"---\ntitle: SpawnInstance function (Unmanaged API Reference)\ndescription: The SpawnInstance function creates a new instance of a class.\nms.date: \"11/06/2017\"\napi_name: \n  - \"SpawnInstance\"\napi_location: \n  - \"WMINet_Utils.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"SpawnInstance\"\nhelpviewer_keywords: \n  - \"SpawnInstance function [.NET WMI and performance counters]\"\ntopic_type: \n  - \"Reference\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# SpawnInstance function\nCreates a new instance of a class.    \n  \n[!INCLUDE[internalonly-unmanaged](../../../../includes/internalonly-unmanaged.md)]\n  \n## Syntax  \n  \n```  \nHRESULT SpawnInstance (\n   [in] int                  vFunc, \n   [in] IWbemClassObject*    ptr, \n   [in] LONG                 lFlags,\n   [out] IWbemClassObject**  ppNewInstance); \n```  \n\n## Parameters\n\n`vFunc`  \n[in] This parameter is unused.\n\n`ptr`  \n[in] A pointer to an [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) instance.\n\n`lFlags`  \n[in] Reserved. This parameter must be 0.\n\n`ppNewInstance`  \n[out] Receives the pointer to the new instance of the class. If an error occurs, a new object is not returned, and `ppNewInstance` is left unmodified.\n\n## Return value\n\nThe following values returned by this function are defined in the *WbemCli.h* header file, or you can define them as constants in your code:\n\n|Constant  |Value  |Description  |\n|---------|---------|---------|\n| `WBEM_E_INCOMPLETE_CLASS` | 0x80041020 | `ptr` is not a valid class definition and cannot spawn new instances. Either it is incomplete or it has not been registered with Windows Management by calling [PutClassWmi](putclasswmi.md). |\n| `WBEM_E_OUT_OF_MEMORY` | 0x80041006 | Not enough memory is available to complete the operation. |\n| `WBEM_E_INVALID_PARAMETER` | 0x80041008 | `ppNewClass` is `null`. |\n| `WBEM_S_NO_ERROR` | 0 | The function call was successful.  |\n  \n## Remarks\n\nThis function wraps a call to the [IWbemClassObject::SpawnInstance](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-spawninstance) method.\n\n`ptr` must be a class definition obtained from Windows Management. (Note that spawning an instance from an instance is supported but the returned instance is empty.) You then use this class definition to create new instances. A call to the [PutInstanceWmi](putinstancewmi.md) function is required if you intend to write the instance to Windows Management.\n\nThe new object returned in `ppNewClass` automatically becomes a subclass of the current object. This behavior cannot be overridden. There is no other method by which subclasses (derived classes) can be created.\n\n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** WMINet_Utils.idl  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]  \n  \n## See also\n\n- [WMI and Performance Counters (Unmanaged API Reference)](index.md)\n","nodes":[{"pos":[4,442],"embed":true,"restype":"x-metadata","content":"title: SpawnInstance function (Unmanaged API Reference)\ndescription: The SpawnInstance function creates a new instance of a class.\nms.date: \"11/06/2017\"\napi_name: \n  - \"SpawnInstance\"\napi_location: \n  - \"WMINet_Utils.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"SpawnInstance\"\nhelpviewer_keywords: \n  - \"SpawnInstance function [.NET WMI and performance counters]\"\ntopic_type: \n  - \"Reference\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"SpawnInstance function (Unmanaged API Reference)","nodes":[{"pos":[0,48],"content":"SpawnInstance function (Unmanaged API Reference)","nodes":[{"content":"SpawnInstance function (Unmanaged API Reference)","pos":[0,48]}]}],"path":["title"],"nosxs":false},{"content":"The SpawnInstance function creates a new instance of a class.","nodes":[{"pos":[0,61],"content":"The SpawnInstance function creates a new instance of a class.","nodes":[{"content":"The SpawnInstance function creates a new instance of a class.","pos":[0,61]}]}],"path":["description"],"nosxs":false}],"yml":true},{"pos":[449,471],"content":"SpawnInstance function","linkify":"SpawnInstance function","nodes":[{"content":"SpawnInstance function","pos":[0,22]}]},{"content":"Creates a new instance of a class.","pos":[472,506]},{"pos":[603,609],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[810,820],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] This parameter is unused.","pos":[832,862]},{"content":"[in] A pointer to an <bpt id=\"p1\">[</bpt>IWbemClassObject<ept id=\"p1\">](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject)</ept> instance.","pos":[872,979],"source":"[in] A pointer to an [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) instance."},{"content":"[in] Reserved.","pos":[992,1006]},{"content":"This parameter must be 0.","pos":[1007,1032]},{"content":"[out] Receives the pointer to the new instance of the class.","pos":[1052,1112]},{"content":"If an error occurs, a new object is not returned, and <ph id=\"ph1\">`ppNewInstance`</ph> is left unmodified.","pos":[1113,1202],"source":" If an error occurs, a new object is not returned, and `ppNewInstance` is left unmodified."},{"pos":[1207,1219],"content":"Return value","linkify":"Return value","nodes":[{"content":"Return value","pos":[0,12]}]},{"pos":[1221,1361],"content":"The following values returned by this function are defined in the <bpt id=\"p1\">*</bpt>WbemCli.h<ept id=\"p1\">*</ept> header file, or you can define them as constants in your code:","source":"The following values returned by this function are defined in the *WbemCli.h* header file, or you can define them as constants in your code:"},{"content":"Constant","pos":[1364,1372]},{"content":"Value","pos":[1375,1380]},{"content":"Description","pos":[1383,1394]},{"content":"0x80041020","pos":[1460,1470]},{"content":"<ph id=\"ph1\">`ptr`</ph> is not a valid class definition and cannot spawn new instances.","pos":[1473,1542],"source":"`ptr` is not a valid class definition and cannot spawn new instances."},{"content":"Either it is incomplete or it has not been registered with Windows Management by calling <bpt id=\"p1\">[</bpt>PutClassWmi<ept id=\"p1\">](putclasswmi.md)</ept>.","pos":[1543,1662],"source":" Either it is incomplete or it has not been registered with Windows Management by calling [PutClassWmi](putclasswmi.md)."},{"content":"0x80041006","pos":[1692,1702]},{"content":"Not enough memory is available to complete the operation.","pos":[1705,1762]},{"content":"0x80041008","pos":[1796,1806]},{"pos":[1809,1832],"content":"<ph id=\"ph1\">`ppNewClass`</ph> is <ph id=\"ph2\">`null`</ph>.","source":"`ppNewClass` is `null`."},{"content":"0","pos":[1857,1858]},{"content":"The function call was successful.","pos":[1861,1894]},{"pos":[1904,1911],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[1913,2060],"content":"This function wraps a call to the <bpt id=\"p1\">[</bpt>IWbemClassObject::SpawnInstance<ept id=\"p1\">](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-spawninstance)</ept> method.","source":"This function wraps a call to the [IWbemClassObject::SpawnInstance](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-spawninstance) method."},{"content":"<ph id=\"ph1\">`ptr`</ph> must be a class definition obtained from Windows Management.","pos":[2062,2128],"source":"`ptr` must be a class definition obtained from Windows Management."},{"content":"(Note that spawning an instance from an instance is supported but the returned instance is empty.) You then use this class definition to create new instances.","pos":[2129,2287]},{"content":"A call to the <bpt id=\"p1\">[</bpt>PutInstanceWmi<ept id=\"p1\">](putinstancewmi.md)</ept> function is required if you intend to write the instance to Windows Management.","pos":[2288,2417],"source":" A call to the [PutInstanceWmi](putinstancewmi.md) function is required if you intend to write the instance to Windows Management."},{"content":"The new object returned in <ph id=\"ph1\">`ppNewClass`</ph> automatically becomes a subclass of the current object.","pos":[2419,2514],"source":"The new object returned in `ppNewClass` automatically becomes a subclass of the current object."},{"content":"This behavior cannot be overridden.","pos":[2515,2550]},{"content":"There is no other method by which subclasses (derived classes) can be created.","pos":[2551,2629]},{"pos":[2634,2646],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2650,2754],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2761,2789],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> WMINet_Utils.idl","source":"**Header:** WMINet_Utils.idl"},{"pos":[2796,2903],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]"},{"pos":[2912,2920],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2924,2990],"content":"<bpt id=\"p1\">[</bpt>WMI and Performance Counters (Unmanaged API Reference)<ept id=\"p1\">](index.md)</ept>","source":"[WMI and Performance Counters (Unmanaged API Reference)](index.md)"}]}