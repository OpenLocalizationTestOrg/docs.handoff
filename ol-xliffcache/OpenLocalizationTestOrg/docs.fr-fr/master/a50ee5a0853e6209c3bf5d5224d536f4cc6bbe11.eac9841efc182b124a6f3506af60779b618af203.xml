{"content":"---\ntitle: \"How to: Delete a Registry Key in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.DeleteSetting\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"GetSetting function\"\n  - \"registry, deleting values\"\n  - \"GetAllSettings function\"\n  - \"registry keys, deleting\"\n  - \"registry, deleting keys\"\n  - \"examples [Visual Basic], registry\"\nms.assetid: ab9aca0e-42b0-4ff7-8ff9-845a4bfdf9f2\ncaps.latest.revision: 28\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Delete a Registry Key in Visual Basic\nThe <xref:Microsoft.Win32.RegistryKey.DeleteSubKey%28System.String%29> and <xref:Microsoft.Win32.RegistryKey.DeleteSubKey%28System.String%2CSystem.Boolean%29> methods can be used to delete registry keys.  \n  \n## Procedure  \n  \n#### To delete a registry key  \n  \n-   Use the `DeleteSubKey` method to delete a registry key. This example deletes the key Software/TestApp in the CurrentUser hive. You can change this in the code to the appropriate string, or have it rely on user-supplied information.  \n  \n     [!code-vb[VbResourceTasks#19](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-delete-a-registry-key_1.vb)]  \n  \n## Robust Programming  \n The `DeleteSubKey` method returns an empty string if the key/value pair does not exist.  \n  \n The following conditions may cause an exception:  \n  \n-   The name of the key is `Nothing` (<xref:System.ArgumentNullException>).  \n  \n-   The user does not have permissions to delete registry keys (<xref:System.Security.SecurityException>).  \n  \n-   The key name exceeds the 255-character limit (<xref:System.ArgumentException>).  \n  \n-   The registry key is read-only (<xref:System.UnauthorizedAccessException>).  \n  \n## .NET Framework Security  \n Registry calls fail if either sufficient run-time permissions are not granted (<xref:System.Security.Permissions.RegistryPermission>) or if the user does not have the correct access (as determined by the ACLs) for creating or writing to settings. For example, a local application that has the code access security permission might not have operating system permission.  \n  \n## See Also  \n <xref:Microsoft.Win32.RegistryKey.DeleteSubKey%2A>   \n <xref:Microsoft.Win32.RegistryKey.DeleteSubKey%2A>   \n <xref:Microsoft.Win32.RegistryKey>   \n [Security and the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/security-and-the-registry.md)   \n [Reading from and Writing to the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)","nodes":[{"pos":[12,74],"content":"How to: Delete a Registry Key in Visual Basic | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Delete a Registry Key in Visual Basic | Microsoft Docs","pos":[0,62]}]},{"pos":[794,839],"content":"How to: Delete a Registry Key in Visual Basic","linkify":"How to: Delete a Registry Key in Visual Basic","nodes":[{"content":"How to: Delete a Registry Key in Visual Basic","pos":[0,45]}]},{"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.Win32.RegistryKey.DeleteSubKey%28System.String%29&gt;</ph> and <ph id=\"ph2\">&lt;xref:Microsoft.Win32.RegistryKey.DeleteSubKey%28System.String%2CSystem.Boolean%29&gt;</ph> methods can be used to delete registry keys.","pos":[840,1043],"source":"The <xref:Microsoft.Win32.RegistryKey.DeleteSubKey%28System.String%29> and <xref:Microsoft.Win32.RegistryKey.DeleteSubKey%28System.String%2CSystem.Boolean%29> methods can be used to delete registry keys."},{"pos":[1052,1061],"content":"Procedure","linkify":"Procedure","nodes":[{"content":"Procedure","pos":[0,9]}]},{"pos":[1072,1096],"content":"To delete a registry key","linkify":"To delete a registry key","nodes":[{"content":"To delete a registry key","pos":[0,24]}]},{"content":"Use the <ph id=\"ph1\">`DeleteSubKey`</ph> method to delete a registry key.","pos":[1106,1161],"source":"Use the `DeleteSubKey` method to delete a registry key."},{"content":"This example deletes the key Software/TestApp in the CurrentUser hive.","pos":[1162,1232]},{"content":"You can change this in the code to the appropriate string, or have it rely on user-supplied information.","pos":[1233,1337]},{"pos":[1348,1509],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbResourceTasks#19<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-delete-a-registry-key_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbResourceTasks#19](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-delete-a-registry-key_1.vb)]"},{"pos":[1518,1536],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"pos":[1540,1627],"content":"The <ph id=\"ph1\">`DeleteSubKey`</ph> method returns an empty string if the key/value pair does not exist.","source":"The `DeleteSubKey` method returns an empty string if the key/value pair does not exist."},{"content":"The following conditions may cause an exception:","pos":[1634,1682]},{"pos":[1692,1763],"content":"The name of the key is <ph id=\"ph1\">`Nothing`</ph> (<ph id=\"ph2\">&lt;xref:System.ArgumentNullException&gt;</ph>).","source":"The name of the key is `Nothing` (<xref:System.ArgumentNullException>)."},{"content":"The user does not have permissions to delete registry keys (<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","pos":[1773,1875],"source":"The user does not have permissions to delete registry keys (<xref:System.Security.SecurityException>)."},{"content":"The key name exceeds the 255-character limit (<ph id=\"ph1\">&lt;xref:System.ArgumentException&gt;</ph>).","pos":[1885,1964],"source":"The key name exceeds the 255-character limit (<xref:System.ArgumentException>)."},{"content":"The registry key is read-only (<ph id=\"ph1\">&lt;xref:System.UnauthorizedAccessException&gt;</ph>).","pos":[1974,2048],"source":"The registry key is read-only (<xref:System.UnauthorizedAccessException>)."},{"pos":[2057,2080],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"Registry calls fail if either sufficient run-time permissions are not granted (<ph id=\"ph1\">&lt;xref:System.Security.Permissions.RegistryPermission&gt;</ph>) or if the user does not have the correct access (as determined by the ACLs) for creating or writing to settings.","pos":[2084,2330],"source":"Registry calls fail if either sufficient run-time permissions are not granted (<xref:System.Security.Permissions.RegistryPermission>) or if the user does not have the correct access (as determined by the ACLs) for creating or writing to settings."},{"content":"For example, a local application that has the code access security permission might not have operating system permission.","pos":[2331,2452]},{"pos":[2461,2469],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>Security and the Registry<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/security-and-the-registry.md)</ept><ph id=\"ph1\"> </ph>","pos":[2621,2752],"source":" [Security and the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/security-and-the-registry.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Reading from and Writing to the Registry<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)</ept>","pos":[2755,2915],"source":" [Reading from and Writing to the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)"}]}