{"content":"---\ntitle: \"Printing Overview | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"PrintTicket class\"\n  - \"classes, PrintCapabilities\"\n  - \"classes, PrintQueue\"\n  - \"classes, PrintTicket\"\n  - \"print path, XPS\"\n  - \"classes, PrintServer\"\n  - \"printers, XPSDrv-based\"\n  - \"printing\"\n  - \"PrintQueue class PrintServer class\"\n  - \"XML Paper Specification (XPS) file format\"\n  - \"XPS (XML Paper Specification) file format\"\n  - \"XPSDrv-based printers\"\n  - \"PrintCapabilities class\"\n  - \"GDI print path\"\nms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1\ncaps.latest.revision: 35\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Printing Overview\nWith [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)], application developers using [!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)] have a rich new set of printing and print system management [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)]. With [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)], some of these print system enhancements are also available to developers creating [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] applications and developers using unmanaged code. At the core of this new functionality is the new [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] file format and the [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] print path.  \n  \n This topic contains the following sections.  \n  \n<a name=\"introduction_to_XPS\"></a>   \n## About XPS  \n [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] is an electronic document format, a spool file format and a page description language. It is an open document format that uses [!INCLUDE[TLA#tla_xml](../../../../includes/tlasharptla-xml-md.md)], [!INCLUDE[TLA#tla_opc](../../../../includes/tlasharptla-opc-md.md)], and other industry standards to create cross-platform documents. [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] simplifies the process by which digital documents are created, shared, printed, viewed, and archived. For additional information on [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)], see the [XPS Web Site](http://www.microsoft.com/xps).  \n  \n Several techniques for printing [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] based content using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] are demonstrated in [Programmatically Print XPS Files](../../../../docs/framework/wpf/advanced/how-to-programmatically-print-xps-files.md). You may find it useful to reference these samples during review of content contained in this topic. (Unmanaged code developers should see the help for the *Microsoft XPS Document Converter printer escape*. [!INCLUDE[TLA2#tla_winforms#initcap](../../../../includes/tla2sharptla-winformssharpinitcap-md.md)] developers must use the [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] in the <xref:System.Drawing.Printing> namespace which does not support the full [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] print path, but does support a hybrid GDI-to-XPS print path. See **Print Path Architecture** below.)  \n  \n<a name=\"XPS_print_path_intro\"></a>   \n## XPS Print Path  \n The [!INCLUDE[TLA#tla_metro](../../../../includes/tlasharptla-metro-md.md)] print path is a new [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] feature that redefines how printing is handled in [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] applications. Because [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] format from application publication to the final processing in the print driver or device.  \n  \n The [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path is built upon the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver model (XPSDrv), which provides several benefits for developers such as [!INCLUDE[TLA#tla_wys](../../../../includes/tlasharptla-wys-md.md)] printing, improved color support, and significantly improved print performance. (For more on XPSDrv, see the [Windows Driver Development Kit](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx).)  \n  \n The operation of the print spooler for [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] documents is essentially the same as in previous versions of [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]. However, it has been enhanced to support the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path in addition to the existing [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] print path. The new print path natively consumes an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] spool file. While user-mode printer drivers written for previous versions of [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] will continue to work, an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) is required in order to use the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path.  \n  \n The benefits of the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path are significant, and include:  \n  \n-   [!INCLUDE[TLA2#tla_wys](../../../../includes/tla2sharptla-wys-md.md)] print support  \n  \n-   Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.  \n  \n-   Improved print performance for both [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] and [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] based applications.  \n  \n-   Industry standard [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] format.  \n  \n For basic print scenarios, a simple and intuitive [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] is available with a single entry point for user interface, configuration and job submission. For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities. Both options provide print support in full or partial trust mode.  \n  \n [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] was designed with extensibility in mind. By using the extensibility framework, features and capabilities can be added to [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] in a modular manner. Extensibility features include:  \n  \n-   Print Schema. The public schema is updated regularly and enables rapid extension of device capabilities. (See **PrintTicket and PrintCapabilities** below.)  \n  \n-   Extensible Filter Pipeline. The [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] documents. (Lookup \"XPSDrv\" in the [Windows Driver Development Kit](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx).)  \n  \n### Print Path Architecture  \n While both [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] applications support [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)], [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] applications use a [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] to [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] conversion in order to create [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] formatted content for the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv). These applications are not required to use the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path, and can continue to use [!INCLUDE[TLA#tla_emf](../../../../includes/tlasharptla-emf-md.md)] based printing. However, most [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features and enhancements are only available to applications that target the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path.  \n  \n To enable the use of XPSDrv-based printers by [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] applications, the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) supports conversion of [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] to [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] format. The XPSDrv model also provides a converter for [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] to [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] format so that [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications can print [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] Documents. For [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications, conversion of [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] to [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver. ([!INCLUDE[TLA2#tla_winforms#initcap](../../../../includes/tla2sharptla-winformssharpinitcap-md.md)] applications cannot print [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] Documents.)  \n  \n The following illustration depicts the print subsystem and defines the portions provided by [!INCLUDE[TLA#tla_ms](../../../../includes/tlasharptla-ms-md.md)], and the portions defined by software and hardware vendors.  \n  \n ![The XPS Print System](../../../../docs/framework/wpf/advanced/media/xpsprint.PNG \"XPSPrint\")  \n  \n### Basic XPS Printing  \n [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] defines both a basic and advanced [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)]. For those applications that do not require extensive print customization or access to the complete [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] feature set, basic print support is available. Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]. Many [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features are available using this simplified print model.  \n  \n#### PrintDialog  \n The <xref:System.Windows.Controls.PrintDialog?displayProperty=fullName> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] job submission. For information about how to instantiate and use the control, see [Invoke a Print Dialog](../../../../docs/framework/wpf/advanced/how-to-invoke-a-print-dialog.md).  \n  \n### Advanced XPS Printing  \n To access the complete set of [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features, the advanced print [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] must be used. Several relevant [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] are described in greater detail below. For a complete list of [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.  \n  \n#### PrintTicket and PrintCapabilities  \n The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features. Both types of objects are [!INCLUDE[TLA#tla_xml](../../../../includes/tlasharptla-xml-md.md)] formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema. A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job. The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer. By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features. Similarly, unsupported features can be avoided.  \n  \n The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.  \n  \n [!code-cpp[xpscreate#PrinterCapabilities](../../../../samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]\n [!code-csharp[xpscreate#PrinterCapabilities](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]\n [!code-vb[xpscreate#PrinterCapabilities](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  \n  \n#### PrintServer and PrintQueue  \n The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it. Together, these [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] allow advanced management of a server's print jobs. A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>. The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.  \n  \n The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.  \n  \n [!code-csharp[xpsprint#PrintQueueSnip](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]\n [!code-vb[xpsprint#PrintQueueSnip](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  \n  \n#### XpsDocumentWriter  \n An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] documents to a <xref:System.Printing.PrintQueue>. For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] document and <xref:System.Printing.PrintTicket> synchronously. The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] document and <xref:System.Printing.PrintTicket> asynchronously.  \n  \n The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.  \n  \n [!code-csharp[XpsPrint#PrintQueueSnip](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]\n [!code-vb[XpsPrint#PrintQueueSnip](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  \n  \n The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print. See [Programmatically Print XPS Files](../../../../docs/framework/wpf/advanced/how-to-programmatically-print-xps-files.md). for details.  \n  \n<a name=\"GDI_Print_Path_intro\"></a>   \n## GDI Print Path  \n While [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications natively support the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] applications can also take advantage of some [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features. The [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) can convert [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] based output to [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] format. For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter printer escape](http://go.microsoft.com/fwlink/p/?LinkID=227195). Similarly, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications can also output to the [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.  \n  \n For applications that do not require [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] functionality or support, the current [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] print path remains unchanged.  \n  \n-   For additional reference material on the [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] print path and the various [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] conversion options, see [Microsoft XPS Document Converter printer escape](http://go.microsoft.com/fwlink/p/?LinkID=227195) and \"XPSDrv\" in the [Windows Driver Development Kit](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx).  \n  \n<a name=\"XPS_Driver_Model_intro\"></a>   \n## XPSDrv Driver Model  \n The [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path improves spooler efficiency by using [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] as the native print spool format when printing to an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] -enabled printer or driver. The simplified spooling process eliminates the need to generate an intermediate spool file, such as an [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] data file, before the document is spooled. Through smaller spool file sizes, the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path can reduce network traffic and improve print performance.  \n  \n [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] is a closed format that represents application output as a series of calls into [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] for rendering services. Unlike [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)], the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] spool format represents the actual document without requiring further interpretation when output to an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]-based printer driver (XPSDrv). The drivers can operate directly on the data in the format. This capability eliminates the data and color space conversions required when you use [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] files and [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]-based print drivers.  \n  \n Spool file sizes are usually reduced when you use [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] Documents that target an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) compared with their [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] equivalents; however, there are exceptions:  \n  \n-   A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.  \n  \n-   For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts. But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.  \n  \n Spool size reduction is performed through several mechanisms:  \n  \n-   **Font subsetting**. Only characters used within the actual document are stored in the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] file.  \n  \n-   **Advanced Graphics Support**. Native support for transparency and gradient primitives avoids rasterization of content in the [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] Document.  \n  \n-   **Identification of common resources**. Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.  \n  \n-   **ZIP compression**. All [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] documents use ZIP compression.  \n  \n## See Also  \n <xref:System.Windows.Controls.PrintDialog>   \n <xref:System.Windows.Xps.XpsDocumentWriter>   \n <xref:System.Windows.Xps.Packaging.XpsDocument>   \n <xref:System.Printing.PrintTicket>   \n <xref:System.Printing.PrintCapabilities>   \n <xref:System.Printing.PrintServer>   \n <xref:System.Printing.PrintQueue>   \n [How-to Topics](../../../../docs/framework/wpf/advanced/printing-how-to-topics.md)   \n [Documents in WPF](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)   \n [XPS](http://www.microsoft.com/xps)   \n [Document Serialization and Storage](../../../../docs/framework/wpf/advanced/document-serialization-and-storage.md)   \n [Microsoft XPS Document Converter printer escape](http://go.microsoft.com/fwlink/p/?LinkID=227195)","nodes":[{"pos":[12,46],"content":"Printing Overview | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Printing Overview | Microsoft Docs","pos":[0,34]}]},{"pos":[795,812],"content":"Printing Overview","linkify":"Printing Overview","nodes":[{"content":"Printing Overview","pos":[0,17]}]},{"content":"With <ph id=\"ph1\">[!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)]</ph>, application developers using <ph id=\"ph2\">[!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)]</ph> have a rich new set of printing and print system management <ph id=\"ph3\">[!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)]</ph>.","pos":[813,1134],"source":"With [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)], application developers using [!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)] have a rich new set of printing and print system management [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)]."},{"content":"With <ph id=\"ph1\">[!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)]</ph>, some of these print system enhancements are also available to developers creating <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> applications and developers using unmanaged code.","pos":[1135,1428],"source":" With [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)], some of these print system enhancements are also available to developers creating [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] applications and developers using unmanaged code."},{"content":"At the core of this new functionality is the new <ph id=\"ph1\">[!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)]</ph> file format and the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> print path.","pos":[1429,1647],"source":" At the core of this new functionality is the new [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] file format and the [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] print path."},{"content":"This topic contains the following sections.","pos":[1654,1697]},{"pos":[1744,1753],"content":"About XPS","linkify":"About XPS","nodes":[{"content":"About XPS","pos":[0,9]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> is an electronic document format, a spool file format and a page description language.","pos":[1757,1917],"source":"[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] is an electronic document format, a spool file format and a page description language."},{"content":"It is an open document format that uses <ph id=\"ph1\">[!INCLUDE[TLA#tla_xml](../../../../includes/tlasharptla-xml-md.md)]</ph>, <ph id=\"ph2\">[!INCLUDE[TLA#tla_opc](../../../../includes/tlasharptla-opc-md.md)]</ph>, and other industry standards to create cross-platform documents.","pos":[1918,2160],"source":" It is an open document format that uses [!INCLUDE[TLA#tla_xml](../../../../includes/tlasharptla-xml-md.md)], [!INCLUDE[TLA#tla_opc](../../../../includes/tlasharptla-opc-md.md)], and other industry standards to create cross-platform documents."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> simplifies the process by which digital documents are created, shared, printed, viewed, and archived.","pos":[2161,2336],"source":"[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] simplifies the process by which digital documents are created, shared, printed, viewed, and archived."},{"content":"For additional information on <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph>, see the <bpt id=\"p1\">[</bpt>XPS Web Site<ept id=\"p1\">](http://www.microsoft.com/xps)</ept>.","pos":[2337,2495],"source":" For additional information on [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)], see the [XPS Web Site](http://www.microsoft.com/xps)."},{"content":"Several techniques for printing <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> based content using <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> are demonstrated in <bpt id=\"p1\">[</bpt>Programmatically Print XPS Files<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/how-to-programmatically-print-xps-files.md)</ept>.","pos":[2502,2837],"source":"Several techniques for printing [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] based content using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] are demonstrated in [Programmatically Print XPS Files](../../../../docs/framework/wpf/advanced/how-to-programmatically-print-xps-files.md)."},{"content":"You may find it useful to reference these samples during review of content contained in this topic.","pos":[2838,2937]},{"content":"(Unmanaged code developers should see the help for the <bpt id=\"p1\">*</bpt>Microsoft XPS Document Converter printer escape<ept id=\"p1\">*</ept>.","pos":[2938,3043],"source":" (Unmanaged code developers should see the help for the *Microsoft XPS Document Converter printer escape*."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winforms#initcap](../../../../includes/tla2sharptla-winformssharpinitcap-md.md)]</ph> developers must use the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> in the <ph id=\"ph3\">&lt;xref:System.Drawing.Printing&gt;</ph> namespace which does not support the full <ph id=\"ph4\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> print path, but does support a hybrid GDI-to-XPS print path.","pos":[3044,3448],"source":"[!INCLUDE[TLA2#tla_winforms#initcap](../../../../includes/tla2sharptla-winformssharpinitcap-md.md)] developers must use the [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] in the <xref:System.Drawing.Printing> namespace which does not support the full [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] print path, but does support a hybrid GDI-to-XPS print path."},{"content":"See <bpt id=\"p1\">**</bpt>Print Path Architecture<ept id=\"p1\">**</ept> below.)","pos":[3449,3488],"source":" See **Print Path Architecture** below.)"},{"pos":[3536,3550],"content":"XPS Print Path","linkify":"XPS Print Path","nodes":[{"content":"XPS Print Path","pos":[0,14]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA#tla_metro](../../../../includes/tlasharptla-metro-md.md)]</ph> print path is a new <ph id=\"ph2\">[!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)]</ph> feature that redefines how printing is handled in <ph id=\"ph3\">[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]</ph> applications.","pos":[3554,3859],"source":"The [!INCLUDE[TLA#tla_metro](../../../../includes/tlasharptla-metro-md.md)] print path is a new [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] feature that redefines how printing is handled in [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] applications."},{"content":"Because <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> format from application publication to the final processing in the print driver or device.","pos":[3860,4294],"source":" Because [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] format from application publication to the final processing in the print driver or device."},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> print path is built upon the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> printer driver model (XPSDrv), which provides several benefits for developers such as <ph id=\"ph3\">[!INCLUDE[TLA#tla_wys](../../../../includes/tlasharptla-wys-md.md)]</ph> printing, improved color support, and significantly improved print performance.","pos":[4301,4715],"source":"The [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path is built upon the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver model (XPSDrv), which provides several benefits for developers such as [!INCLUDE[TLA#tla_wys](../../../../includes/tlasharptla-wys-md.md)] printing, improved color support, and significantly improved print performance."},{"content":"(For more on XPSDrv, see the <bpt id=\"p1\">[</bpt>Windows Driver Development Kit<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx)</ept>.)","pos":[4716,4846],"source":" (For more on XPSDrv, see the [Windows Driver Development Kit](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx).)"},{"content":"The operation of the print spooler for <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> documents is essentially the same as in previous versions of <ph id=\"ph2\">[!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]</ph>.","pos":[4853,5101],"source":"The operation of the print spooler for [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] documents is essentially the same as in previous versions of [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)]."},{"content":"However, it has been enhanced to support the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> print path in addition to the existing <ph id=\"ph2\">[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]</ph> print path.","pos":[5102,5341],"source":" However, it has been enhanced to support the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path in addition to the existing [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] print path."},{"content":"The new print path natively consumes an <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> spool file.","pos":[5342,5467],"source":" The new print path natively consumes an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] spool file."},{"content":"While user-mode printer drivers written for previous versions of <ph id=\"ph1\">[!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)]</ph> will continue to work, an <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> printer driver (XPSDrv) is required in order to use the <ph id=\"ph3\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> print path.","pos":[5468,5846],"source":" While user-mode printer drivers written for previous versions of [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] will continue to work, an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) is required in order to use the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path."},{"pos":[5853,5987],"content":"The benefits of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> print path are significant, and include:","source":"The benefits of the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path are significant, and include:"},{"pos":[5997,6080],"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_wys](../../../../includes/tla2sharptla-wys-md.md)]</ph> print support","source":"[!INCLUDE[TLA2#tla_wys](../../../../includes/tla2sharptla-wys-md.md)] print support"},{"content":"Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.","pos":[6090,6251]},{"pos":[6261,6466],"content":"Improved print performance for both <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)]</ph> based applications.","source":"Improved print performance for both [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] and [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] based applications."},{"pos":[6476,6575],"content":"Industry standard <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> format.","source":"Industry standard [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] format."},{"content":"For basic print scenarios, a simple and intuitive <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> is available with a single entry point for user interface, configuration and job submission.","pos":[6582,6794],"source":"For basic print scenarios, a simple and intuitive [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] is available with a single entry point for user interface, configuration and job submission."},{"content":"For advanced scenarios, an additional support is added for <ph id=\"ph1\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph> customization (or no <ph id=\"ph2\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> at all), synchronous or asynchronous printing, and batch printing capabilities.","pos":[6795,7088],"source":" For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities."},{"content":"Both options provide print support in full or partial trust mode.","pos":[7089,7154]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> was designed with extensibility in mind.","pos":[7161,7275],"source":"[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] was designed with extensibility in mind."},{"content":"By using the extensibility framework, features and capabilities can be added to <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> in a modular manner.","pos":[7276,7450],"source":" By using the extensibility framework, features and capabilities can be added to [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] in a modular manner."},{"content":"Extensibility features include:","pos":[7451,7482]},{"content":"Print Schema.","pos":[7492,7505]},{"content":"The public schema is updated regularly and enables rapid extension of device capabilities.","pos":[7506,7596]},{"content":"(See <bpt id=\"p1\">**</bpt>PrintTicket and PrintCapabilities<ept id=\"p1\">**</ept> below.)","pos":[7597,7647],"source":" (See **PrintTicket and PrintCapabilities** below.)"},{"content":"Extensible Filter Pipeline.","pos":[7657,7684]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> documents.","pos":[7685,7947],"source":" The [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] documents."},{"content":"(Lookup \"XPSDrv\" in the <bpt id=\"p1\">[</bpt>Windows Driver Development Kit<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx)</ept>.)","pos":[7948,8073],"source":" (Lookup \"XPSDrv\" in the [Windows Driver Development Kit](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx).)"},{"pos":[8083,8106],"content":"Print Path Architecture","linkify":"Print Path Architecture","nodes":[{"content":"Print Path Architecture","pos":[0,23]}]},{"content":"While both <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)]</ph> applications support <ph id=\"ph3\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph>, <ph id=\"ph4\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> and <ph id=\"ph5\">[!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)]</ph> applications use a <ph id=\"ph6\">[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]</ph> to <ph id=\"ph7\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> conversion in order to create <ph id=\"ph8\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> formatted content for the <ph id=\"ph9\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> printer driver (XPSDrv).","pos":[8110,8921],"source":"While both [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] applications support [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)], [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] applications use a [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] to [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] conversion in order to create [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] formatted content for the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv)."},{"content":"These applications are not required to use the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> print path, and can continue to use <ph id=\"ph2\">[!INCLUDE[TLA#tla_emf](../../../../includes/tlasharptla-emf-md.md)]</ph> based printing.","pos":[8922,9162],"source":" These applications are not required to use the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path, and can continue to use [!INCLUDE[TLA#tla_emf](../../../../includes/tlasharptla-emf-md.md)] based printing."},{"content":"However, most <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> features and enhancements are only available to applications that target the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> print path.","pos":[9163,9413],"source":" However, most [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features and enhancements are only available to applications that target the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path."},{"content":"To enable the use of XPSDrv-based printers by <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)]</ph> applications, the <ph id=\"ph3\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> printer driver (XPSDrv) supports conversion of <ph id=\"ph4\">[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]</ph> to <ph id=\"ph5\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> format.","pos":[9420,9917],"source":"To enable the use of XPSDrv-based printers by [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] applications, the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) supports conversion of [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] to [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] format."},{"content":"The XPSDrv model also provides a converter for <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> to <ph id=\"ph2\">[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]</ph> format so that <ph id=\"ph3\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> applications can print <ph id=\"ph4\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> Documents.","pos":[9918,10304],"source":" The XPSDrv model also provides a converter for [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] to [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] format so that [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications can print [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] Documents."},{"content":"For <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> applications, conversion of <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> to <ph id=\"ph3\">[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]</ph> format is done automatically by the <ph id=\"ph4\">&lt;xref:System.Windows.Xps.XpsDocumentWriter.Write%2A&gt;</ph> and <ph id=\"ph5\">&lt;xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A&gt;</ph> methods of the <ph id=\"ph6\">&lt;xref:System.Windows.Xps.XpsDocumentWriter&gt;</ph> class whenever the target print queue of the write operation does not have an XPSDrv driver.","pos":[10305,10856],"source":" For [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications, conversion of [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] to [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver."},{"content":"(<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winforms#initcap](../../../../includes/tla2sharptla-winformssharpinitcap-md.md)]</ph> applications cannot print <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> Documents.)","pos":[10857,11065],"source":" ([!INCLUDE[TLA2#tla_winforms#initcap](../../../../includes/tla2sharptla-winformssharpinitcap-md.md)] applications cannot print [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] Documents.)"},{"pos":[11072,11289],"content":"The following illustration depicts the print subsystem and defines the portions provided by <ph id=\"ph1\">[!INCLUDE[TLA#tla_ms](../../../../includes/tlasharptla-ms-md.md)]</ph>, and the portions defined by software and hardware vendors.","source":"The following illustration depicts the print subsystem and defines the portions provided by [!INCLUDE[TLA#tla_ms](../../../../includes/tlasharptla-ms-md.md)], and the portions defined by software and hardware vendors."},{"pos":[11296,11390],"content":"<bpt id=\"p1\">![</bpt>The XPS Print System<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wpf/advanced/media/xpsprint.PNG \"</bpt>XPSPrint<ept id=\"p2\">\")</ept>","source":"![The XPS Print System](../../../../docs/framework/wpf/advanced/media/xpsprint.PNG \"XPSPrint\")"},{"pos":[11400,11418],"content":"Basic XPS Printing","linkify":"Basic XPS Printing","nodes":[{"content":"Basic XPS Printing","pos":[0,18]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> defines both a basic and advanced <ph id=\"ph2\">[!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)]</ph>.","pos":[11422,11594],"source":"[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] defines both a basic and advanced [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)]."},{"content":"For those applications that do not require extensive print customization or access to the complete <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> feature set, basic print support is available.","pos":[11595,11814],"source":" For those applications that do not require extensive print customization or access to the complete [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] feature set, basic print support is available."},{"content":"Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph>.","pos":[11815,12005],"source":" Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]."},{"content":"Many <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> features are available using this simplified print model.","pos":[12006,12142],"source":" Many [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features are available using this simplified print model."},{"pos":[12153,12164],"content":"PrintDialog","linkify":"PrintDialog","nodes":[{"content":"PrintDialog","pos":[0,11]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.PrintDialog?displayProperty=fullName&gt;</ph> control provides a single entry point for <ph id=\"ph2\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph>, configuration, and <ph id=\"ph3\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> job submission.","pos":[12168,12459],"source":"The <xref:System.Windows.Controls.PrintDialog?displayProperty=fullName> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] job submission."},{"content":"For information about how to instantiate and use the control, see <bpt id=\"p1\">[</bpt>Invoke a Print Dialog<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/how-to-invoke-a-print-dialog.md)</ept>.","pos":[12460,12623],"source":" For information about how to instantiate and use the control, see [Invoke a Print Dialog](../../../../docs/framework/wpf/advanced/how-to-invoke-a-print-dialog.md)."},{"pos":[12633,12654],"content":"Advanced XPS Printing","linkify":"Advanced XPS Printing","nodes":[{"content":"Advanced XPS Printing","pos":[0,21]}]},{"content":"To access the complete set of <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> features, the advanced print <ph id=\"ph2\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> must be used.","pos":[12658,12874],"source":"To access the complete set of [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features, the advanced print [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] must be used."},{"content":"Several relevant <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> are described in greater detail below.","pos":[12875,13000],"source":" Several relevant [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] are described in greater detail below."},{"content":"For a complete list of <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> print path <ph id=\"ph2\">[!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)]</ph>, see the <ph id=\"ph3\">&lt;xref:System.Windows.Xps&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Printing&gt;</ph> namespace references.","pos":[13001,13280],"source":" For a complete list of [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references."},{"pos":[13291,13324],"content":"PrintTicket and PrintCapabilities","linkify":"PrintTicket and PrintCapabilities","nodes":[{"content":"PrintTicket and PrintCapabilities","pos":[0,33]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Printing.PrintTicket&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Printing.PrintCapabilities&gt;</ph> classes are the foundation of the advanced <ph id=\"ph3\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> features.","pos":[13328,13538],"source":"The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features."},{"content":"Both types of objects are <ph id=\"ph1\">[!INCLUDE[TLA#tla_xml](../../../../includes/tlasharptla-xml-md.md)]</ph> formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.","pos":[13539,13784],"source":" Both types of objects are [!INCLUDE[TLA#tla_xml](../../../../includes/tlasharptla-xml-md.md)] formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Printing.PrintTicket&gt;</ph> instructs a printer how to process a print job.","pos":[13785,13869],"source":" A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Printing.PrintCapabilities&gt;</ph> class defines the capabilities of a printer.","pos":[13870,13959],"source":" The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer."},{"content":"By querying the capabilities of a printer, a <ph id=\"ph1\">&lt;xref:System.Printing.PrintTicket&gt;</ph> can be created that takes full advantage of a printer's supported features.","pos":[13960,14115],"source":" By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features."},{"content":"Similarly, unsupported features can be avoided.","pos":[14116,14163]},{"content":"The following example demonstrates how to query the <ph id=\"ph1\">&lt;xref:System.Printing.PrintCapabilities&gt;</ph> of a printer and create a <ph id=\"ph2\">&lt;xref:System.Printing.PrintTicket&gt;</ph> using code.","pos":[14170,14335],"source":"The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code."},{"pos":[14342,14788],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>xpscreate#PrinterCapabilities<ept id=\"p2\">](../../../../samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-csharp</bpt><bpt id=\"p4\">[</bpt>xpscreate#PrinterCapabilities<ept id=\"p4\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)</ept><ept id=\"p3\">]</ept> <bpt id=\"p5\">[!code-vb</bpt><bpt id=\"p6\">[</bpt>xpscreate#PrinterCapabilities<ept id=\"p6\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)</ept><ept id=\"p5\">]</ept>","source":"[!code-cpp[xpscreate#PrinterCapabilities](../../../../samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]\n [!code-csharp[xpscreate#PrinterCapabilities](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]\n [!code-vb[xpscreate#PrinterCapabilities](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]"},{"pos":[14799,14825],"content":"PrintServer and PrintQueue","linkify":"PrintServer and PrintQueue","nodes":[{"content":"PrintServer and PrintQueue","pos":[0,26]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Printing.PrintServer&gt;</ph> class represents a network print server and the <ph id=\"ph2\">&lt;xref:System.Printing.PrintQueue&gt;</ph> class represents a printer and the output job queue associated with it.","pos":[14829,15021],"source":"The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it."},{"content":"Together, these <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)]</ph> allow advanced management of a server's print jobs.","pos":[15022,15177],"source":" Together, these [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] allow advanced management of a server's print jobs."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Printing.PrintServer&gt;</ph>, or one of its derived classes, is used to manage a <ph id=\"ph2\">&lt;xref:System.Printing.PrintQueue&gt;</ph>.","pos":[15178,15301],"source":" A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.AddJob%2A&gt;</ph> method is used to insert a new print job into the queue.","pos":[15302,15406],"source":" The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue."},{"content":"The following example demonstrates how to create a <ph id=\"ph1\">&lt;xref:System.Printing.LocalPrintServer&gt;</ph> and access its default <ph id=\"ph2\">&lt;xref:System.Printing.PrintQueue&gt;</ph> by using code.","pos":[15413,15575],"source":"The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code."},{"pos":[15582,15872],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>xpsprint#PrintQueueSnip<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>xpsprint#PrintQueueSnip<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[xpsprint#PrintQueueSnip](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]\n [!code-vb[xpsprint#PrintQueueSnip](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]"},{"pos":[15883,15900],"content":"XpsDocumentWriter","linkify":"XpsDocumentWriter","nodes":[{"content":"XpsDocumentWriter","pos":[0,17]}]},{"content":"An <ph id=\"ph1\">&lt;xref:System.Windows.Xps.XpsDocumentWriter&gt;</ph>, with its many the <ph id=\"ph2\">&lt;xref:System.Windows.Xps.XpsDocumentWriter.Write%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A&gt;</ph> methods, is used to write <ph id=\"ph4\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> documents to a <ph id=\"ph5\">&lt;xref:System.Printing.PrintQueue&gt;</ph>.","pos":[15904,16234],"source":"An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] documents to a <xref:System.Printing.PrintQueue>."},{"content":"For example, the <ph id=\"ph1\">&lt;xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29&gt;</ph> method is used to output an <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> document and <ph id=\"ph3\">&lt;xref:System.Printing.PrintTicket&gt;</ph> synchronously.","pos":[16235,16536],"source":" For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] document and <xref:System.Printing.PrintTicket> synchronously."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29&gt;</ph> method is used to output an <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> document and <ph id=\"ph3\">&lt;xref:System.Printing.PrintTicket&gt;</ph> asynchronously.","pos":[16537,16835],"source":" The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] document and <xref:System.Printing.PrintTicket> asynchronously."},{"content":"The following example demonstrates how to create an <ph id=\"ph1\">&lt;xref:System.Windows.Xps.XpsDocumentWriter&gt;</ph> using code.","pos":[16842,16949],"source":"The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code."},{"pos":[16956,17246],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>XpsPrint#PrintQueueSnip<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>XpsPrint#PrintQueueSnip<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[XpsPrint#PrintQueueSnip](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]\n [!code-vb[XpsPrint#PrintQueueSnip](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]"},{"content":"The <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.AddJob%2A&gt;</ph> methods also provide ways to print.","pos":[17253,17336],"source":"The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print."},{"content":"See <bpt id=\"p1\">[</bpt>Programmatically Print XPS Files<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/how-to-programmatically-print-xps-files.md)</ept>.","pos":[17337,17460],"source":" See [Programmatically Print XPS Files](../../../../docs/framework/wpf/advanced/how-to-programmatically-print-xps-files.md)."},{"content":"for details.","pos":[17461,17473]},{"pos":[17521,17535],"content":"GDI Print Path","linkify":"GDI Print Path","nodes":[{"content":"GDI Print Path","pos":[0,14]}]},{"content":"While <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> applications natively support the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> print path, <ph id=\"ph3\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> and <ph id=\"ph4\">[!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)]</ph> applications can also take advantage of some <ph id=\"ph5\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> features.","pos":[17539,18021],"source":"While [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications natively support the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] applications can also take advantage of some [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features."},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> printer driver (XPSDrv) can convert <ph id=\"ph2\">[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]</ph> based output to <ph id=\"ph3\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> format.","pos":[18022,18303],"source":" The [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) can convert [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] based output to [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] format."},{"content":"For advanced scenarios, custom conversion of content is supported using the <bpt id=\"p1\">[</bpt>Microsoft XPS Document Converter printer escape<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkID=227195)</ept>.","pos":[18304,18479],"source":" For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter printer escape](http://go.microsoft.com/fwlink/p/?LinkID=227195)."},{"content":"Similarly, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> applications can also output to the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]</ph> print path by calling one of the <ph id=\"ph3\">&lt;xref:System.Windows.Xps.XpsDocumentWriter.Write%2A&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A&gt;</ph> methods of the <ph id=\"ph5\">&lt;xref:System.Windows.Xps.XpsDocumentWriter&gt;</ph> class and designating a non-XpsDrv printer as the target print queue.","pos":[18480,18942],"source":" Similarly, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications can also output to the [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue."},{"pos":[18949,19197],"content":"For applications that do not require <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> functionality or support, the current <ph id=\"ph2\">[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]</ph> print path remains unchanged.","source":"For applications that do not require [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] functionality or support, the current [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] print path remains unchanged."},{"pos":[19207,19662],"content":"For additional reference material on the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]</ph> print path and the various <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> conversion options, see <bpt id=\"p1\">[</bpt>Microsoft XPS Document Converter printer escape<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkID=227195)</ept> and \"XPSDrv\" in the <bpt id=\"p2\">[</bpt>Windows Driver Development Kit<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx)</ept>.","source":"For additional reference material on the [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] print path and the various [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] conversion options, see [Microsoft XPS Document Converter printer escape](http://go.microsoft.com/fwlink/p/?LinkID=227195) and \"XPSDrv\" in the [Windows Driver Development Kit](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx)."},{"pos":[19712,19731],"content":"XPSDrv Driver Model","linkify":"XPSDrv Driver Model","nodes":[{"content":"XPSDrv Driver Model","pos":[0,19]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> print path improves spooler efficiency by using <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> as the native print spool format when printing to an <ph id=\"ph3\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> -enabled printer or driver.","pos":[19735,20089],"source":"The [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path improves spooler efficiency by using [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] as the native print spool format when printing to an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] -enabled printer or driver."},{"content":"The simplified spooling process eliminates the need to generate an intermediate spool file, such as an <ph id=\"ph1\">[!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)]</ph> data file, before the document is spooled.","pos":[20090,20305],"source":" The simplified spooling process eliminates the need to generate an intermediate spool file, such as an [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] data file, before the document is spooled."},{"content":"Through smaller spool file sizes, the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> print path can reduce network traffic and improve print performance.","pos":[20306,20486],"source":" Through smaller spool file sizes, the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path can reduce network traffic and improve print performance."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)]</ph> is a closed format that represents application output as a series of calls into <ph id=\"ph2\">[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]</ph> for rendering services.","pos":[20493,20736],"source":"[!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] is a closed format that represents application output as a series of calls into [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] for rendering services."},{"content":"Unlike <ph id=\"ph1\">[!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)]</ph>, the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> spool format represents the actual document without requiring further interpretation when output to an <ph id=\"ph3\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph>-based printer driver (XPSDrv).","pos":[20737,21100],"source":" Unlike [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)], the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] spool format represents the actual document without requiring further interpretation when output to an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]-based printer driver (XPSDrv)."},{"content":"The drivers can operate directly on the data in the format.","pos":[21101,21160]},{"content":"This capability eliminates the data and color space conversions required when you use <ph id=\"ph1\">[!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)]</ph> files and <ph id=\"ph2\">[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]</ph>-based print drivers.","pos":[21161,21417],"source":" This capability eliminates the data and color space conversions required when you use [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] files and [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]-based print drivers."},{"pos":[21424,21804],"content":"Spool file sizes are usually reduced when you use <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> Documents that target an <ph id=\"ph2\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> printer driver (XPSDrv) compared with their <ph id=\"ph3\">[!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)]</ph> equivalents; however, there are exceptions:","source":"Spool file sizes are usually reduced when you use [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] Documents that target an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) compared with their [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] equivalents; however, there are exceptions:"},{"content":"A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.","pos":[21814,21952]},{"content":"For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.","pos":[21962,22103]},{"content":"But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.","pos":[22104,22246]},{"content":"Spool size reduction is performed through several mechanisms:","pos":[22253,22314]},{"content":"<bpt id=\"p1\">**</bpt>Font subsetting<ept id=\"p1\">**</ept>.","pos":[22324,22344],"source":"**Font subsetting**."},{"content":"Only characters used within the actual document are stored in the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> file.","pos":[22345,22490],"source":" Only characters used within the actual document are stored in the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] file."},{"content":"<bpt id=\"p1\">**</bpt>Advanced Graphics Support<ept id=\"p1\">**</ept>.","pos":[22500,22530],"source":"**Advanced Graphics Support**."},{"content":"Native support for transparency and gradient primitives avoids rasterization of content in the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> Document.","pos":[22531,22705],"source":" Native support for transparency and gradient primitives avoids rasterization of content in the [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] Document."},{"content":"<bpt id=\"p1\">**</bpt>Identification of common resources<ept id=\"p1\">**</ept>.","pos":[22715,22754],"source":"**Identification of common resources**."},{"content":"Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.","pos":[22755,22903]},{"content":"<bpt id=\"p1\">**</bpt>ZIP compression<ept id=\"p1\">**</ept>.","pos":[22913,22933],"source":"**ZIP compression**."},{"content":"All <ph id=\"ph1\">[!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]</ph> documents use ZIP compression.","pos":[22934,23042],"source":" All [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] documents use ZIP compression."},{"pos":[23051,23059],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Controls.PrintDialog&gt;</ph>","pos":[23063,23105],"source":"<xref:System.Windows.Controls.PrintDialog> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Xps.XpsDocumentWriter&gt;</ph>","pos":[23110,23153],"source":" <xref:System.Windows.Xps.XpsDocumentWriter> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Xps.Packaging.XpsDocument&gt;</ph>","pos":[23158,23205],"source":" <xref:System.Windows.Xps.Packaging.XpsDocument> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Printing.PrintTicket&gt;</ph>","pos":[23210,23244],"source":" <xref:System.Printing.PrintTicket> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Printing.PrintCapabilities&gt;</ph>","pos":[23249,23289],"source":" <xref:System.Printing.PrintCapabilities> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Printing.PrintServer&gt;</ph>","pos":[23294,23328],"source":" <xref:System.Printing.PrintServer> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue&gt;</ph>","pos":[23333,23366],"source":" <xref:System.Printing.PrintQueue> "},{"content":"<bpt id=\"p1\"> [</bpt>How-to Topics<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/printing-how-to-topics.md)</ept><ph id=\"ph1\"> </ph>","pos":[23370,23454],"source":" [How-to Topics](../../../../docs/framework/wpf/advanced/printing-how-to-topics.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Documents in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)</ept><ph id=\"ph1\"> </ph>","pos":[23457,23538],"source":" [Documents in WPF](../../../../docs/framework/wpf/advanced/documents-in-wpf.md) "},{"content":"<bpt id=\"p1\"> [</bpt>XPS<ept id=\"p1\">](http://www.microsoft.com/xps)</ept><ph id=\"ph1\"> </ph>","pos":[23541,23578],"source":" [XPS](http://www.microsoft.com/xps) "},{"content":"<bpt id=\"p1\"> [</bpt>Document Serialization and Storage<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/document-serialization-and-storage.md)</ept><ph id=\"ph1\"> </ph>","pos":[23581,23698],"source":" [Document Serialization and Storage](../../../../docs/framework/wpf/advanced/document-serialization-and-storage.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Microsoft XPS Document Converter printer escape<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkID=227195)</ept>","pos":[23701,23800],"source":" [Microsoft XPS Document Converter printer escape](http://go.microsoft.com/fwlink/p/?LinkID=227195)"}]}