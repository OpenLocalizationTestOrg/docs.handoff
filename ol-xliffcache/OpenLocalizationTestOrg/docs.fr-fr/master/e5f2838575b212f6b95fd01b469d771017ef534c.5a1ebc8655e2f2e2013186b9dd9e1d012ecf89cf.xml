{"content":"---\ntitle: \"AJAX Service with JSON and XML Sample\"\nms.date: \"03/30/2017\"\nms.assetid: 8ea5860d-0c42-4ae9-941a-e07efdd8e29c\n---\n# AJAX Service with JSON and XML Sample\nThis sample demonstrates how to use Windows Communication Foundation (WCF) to create an Asynchronous JavaScript and XML (AJAX) service that returns either JavaScript Object Notation (JSON) or XML data. You can access an AJAX service by using JavaScript code from a Web browser client. This sample builds on the [Basic AJAX Service](../../../../docs/framework/wcf/samples/basic-ajax-service.md) sample.  \n  \n Unlike the other AJAX samples, this sample does not use ASP.NET AJAX and the <xref:System.Web.UI.ScriptManager> control. With some additional configuration, WCF AJAX services can be accessed from any HTML page through JavaScript, and this scenario is shown here. For an example of using WCF with ASP.NET AJAX, see [AJAX Samples](ajax.md).\n  \n This sample shows how to switch the response type of an operation between JSON and XML. This functionality is available regardless of whether the service is configured to be accessed by ASP.NET AJAX or by an HTML/JavaScript client page.  \n  \n> [!NOTE]\n> The setup procedure and build instructions for this sample are located at the end of this topic.\n  \nTo enable the use of non-ASP.NET AJAX clients, use <xref:System.ServiceModel.Activation.WebServiceHostFactory> (not <xref:System.ServiceModel.Activation.WebScriptServiceHostFactory>) in the .svc file. <xref:System.ServiceModel.Activation.WebServiceHostFactory> adds a <xref:System.ServiceModel.Description.WebHttpEndpoint> standard endpoint to the service. The endpoint is configured at an empty address relative to the .svc file; this means that the address of the service is `http://localhost/ServiceModelSamples/service.svc`, with no additional suffixes other than the operation name.  \n  \n```svc\n<%@ServiceHost language=\"c#\" Debug=\"true\" Service=\"Microsoft.Samples.XmlAjaxService.CalculatorService\" Factory=\"System.ServiceModel.Activation.WebServiceHostFactory\" %>  \n```  \n  \n The following section in Web.config can be used to make additional configuration changes to the endpoint. It can be removed if no extra changes are needed.  \n  \n```xml  \n<system.serviceModel>  \n  <standardEndpoints>  \n    <webHttpEndpoint>  \n      <!-- Use this element to configure the endpoint -->  \n      <standardEndpoint name=\"\" />  \n    </webHttpEndpoint>  \n  </standardEndpoints>  \n</system.serviceModel>  \n```  \n  \n The default data format for <xref:System.ServiceModel.Description.WebHttpEndpoint> is XML, while the default data format for <xref:System.ServiceModel.Description.WebScriptEndpoint> is JSON. For more information, see [Creating WCF AJAX Services without ASP.NET](../../../../docs/framework/wcf/feature-details/creating-wcf-ajax-services-without-aspnet.md).  \n  \n The service in the following sample is a standard WCF service with two operations. Both operations require the <xref:System.ServiceModel.Web.WebMessageBodyStyle.Wrapped> body style on the <xref:System.ServiceModel.Web.WebGetAttribute> or <xref:System.ServiceModel.Web.WebInvokeAttribute> attributes, which is specific to the `webHttp` behavior and has no bearing on the JSON/XML data format switch.  \n\n```csharp\n[OperationContract]  \n[WebInvoke(ResponseFormat = WebMessageFormat.Xml, BodyStyle = WebMessageBodyStyle.Wrapped)]  \nMathResult DoMathXml(double n1, double n2);  \n```\n\n The response format for the operation is specified as XML, which is the default setting for the [\\<webHttp>](../../../../docs/framework/configure-apps/file-schema/wcf/webhttp.md) behavior. However, it is good practice explicitly specify the response format.  \n  \n The other operation uses the `WebInvokeAttribute` attribute and explicitly specifies JSON instead of XML for the response.  \n\n```csharp\n[OperationContract]  \n[WebInvoke(ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.Wrapped)]  \nMathResult DoMathJson(double n1, double n2);  \n```\n\n Note that in both cases the operations return a complex type, `MathResult`, which is a standard WCF data contract type.  \n  \n The client Web page XmlAjaxClientPage.htm contains JavaScript code that invokes one of the preceding two operations when the user clicks the **Perform calculation (return JSON)** or **Perform calculation (return XML)** buttons on the page. The code to invoke the service constructs a JSON body and sends it using HTTP POST. The request is created manually in JavaScript, unlike the [Basic AJAX Service](../../../../docs/framework/wcf/samples/basic-ajax-service.md) sample and the other samples using ASP.NET AJAX.  \n\n```csharp\n// Create HTTP request  \nvar xmlHttp;  \n// Request instantiation code omitted…  \n// Result handler code omitted…  \n  \n// Build the operation URL  \nvar url = \"service.svc/ajaxEndpoint/\";  \nurl = url + operation;  \n  \n// Build the body of the JSON message  \nvar body = '{\"n1\":';  \nbody = body + document.getElementById(\"num1\").value + ',\"n2\":';  \nbody = body + document.getElementById(\"num2\").value + '}';  \n  \n// Send the HTTP request  \nxmlHttp.open(\"POST\", url, true);  \nxmlHttp.setRequestHeader(\"Content-type\", \"application/json\");  \nxmlHttp.send(body);  \n```\n\n When the service responds, the response is displayed without any further processing in a textbox on the page. This is implemented for demonstration purposes to allow you to directly observe the XML and JSON data formats used.  \n\n```javascript\n// Create result handler   \nxmlHttp.onreadystatechange=function(){  \n     if(xmlHttp.readyState == 4){  \n          document.getElementById(\"result\").value = xmlHttp.responseText;  \n     }  \n}  \n```\n\n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\AJAX\\XmlAjaxService`  \n  \n#### To set up, build, and run the sample  \n  \n1.  Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md).  \n  \n2.  Build the solution XmlAjaxService.sln as described in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md).  \n  \n3.  Navigate to `http://localhost/ServiceModelSamples/XmlAjaxClientPage.htm` (do not open XmlAjaxClientPage.htm in the browser from the project directory).  \n  \n## See also\n\n- [AJAX Service Using HTTP POST](../../../../docs/framework/wcf/samples/ajax-service-using-http-post.md)\n","nodes":[{"pos":[4,121],"embed":true,"restype":"x-metadata","content":"title: \"AJAX Service with JSON and XML Sample\"\nms.date: \"03/30/2017\"\nms.assetid: 8ea5860d-0c42-4ae9-941a-e07efdd8e29c","nodes":[{"content":"AJAX Service with JSON and XML Sample","nodes":[{"pos":[0,37],"content":"AJAX Service with JSON and XML Sample","nodes":[{"content":"AJAX Service with JSON and XML Sample","pos":[0,37]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[128,165],"content":"AJAX Service with JSON and XML Sample","linkify":"AJAX Service with JSON and XML Sample","nodes":[{"content":"AJAX Service with JSON and XML Sample","pos":[0,37]}]},{"content":"This sample demonstrates how to use Windows Communication Foundation (WCF) to create an Asynchronous JavaScript and XML (AJAX) service that returns either JavaScript Object Notation (JSON) or XML data.","pos":[166,367]},{"content":"You can access an AJAX service by using JavaScript code from a Web browser client.","pos":[368,450]},{"content":"This sample builds on the <bpt id=\"p1\">[</bpt>Basic AJAX Service<ept id=\"p1\">](../../../../docs/framework/wcf/samples/basic-ajax-service.md)</ept> sample.","pos":[451,567],"source":" This sample builds on the [Basic AJAX Service](../../../../docs/framework/wcf/samples/basic-ajax-service.md) sample."},{"content":"Unlike the other AJAX samples, this sample does not use ASP.NET AJAX and the <ph id=\"ph1\">&lt;xref:System.Web.UI.ScriptManager&gt;</ph> control.","pos":[574,694],"source":"Unlike the other AJAX samples, this sample does not use ASP.NET AJAX and the <xref:System.Web.UI.ScriptManager> control."},{"content":"With some additional configuration, WCF AJAX services can be accessed from any HTML page through JavaScript, and this scenario is shown here.","pos":[695,836]},{"content":"For an example of using WCF with ASP.NET AJAX, see <bpt id=\"p1\">[</bpt>AJAX Samples<ept id=\"p1\">](ajax.md)</ept>.","pos":[837,912],"source":" For an example of using WCF with ASP.NET AJAX, see [AJAX Samples](ajax.md)."},{"content":"This sample shows how to switch the response type of an operation between JSON and XML.","pos":[917,1004]},{"content":"This functionality is available regardless of whether the service is configured to be accessed by ASP.NET AJAX or by an HTML/JavaScript client page.","pos":[1005,1153]},{"pos":[1161,1267],"content":"[!NOTE]\nThe setup procedure and build instructions for this sample are located at the end of this topic.","leadings":["","> "],"nodes":[{"content":"The setup procedure and build instructions for this sample are located at the end of this topic.","pos":[8,104]}]},{"content":"To enable the use of non-ASP.NET AJAX clients, use <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activation.WebServiceHostFactory&gt;</ph> (not <ph id=\"ph2\">&lt;xref:System.ServiceModel.Activation.WebScriptServiceHostFactory&gt;</ph>) in the .svc file.","pos":[1271,1471],"source":"To enable the use of non-ASP.NET AJAX clients, use <xref:System.ServiceModel.Activation.WebServiceHostFactory> (not <xref:System.ServiceModel.Activation.WebScriptServiceHostFactory>) in the .svc file."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Activation.WebServiceHostFactory&gt;</ph> adds a <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.WebHttpEndpoint&gt;</ph> standard endpoint to the service.","pos":[1472,1627],"source":"<xref:System.ServiceModel.Activation.WebServiceHostFactory> adds a <xref:System.ServiceModel.Description.WebHttpEndpoint> standard endpoint to the service."},{"content":"The endpoint is configured at an empty address relative to the .svc file; this means that the address of the service is <ph id=\"ph1\">`http://localhost/ServiceModelSamples/service.svc`</ph>, with no additional suffixes other than the operation name.","pos":[1628,1858],"source":" The endpoint is configured at an empty address relative to the .svc file; this means that the address of the service is `http://localhost/ServiceModelSamples/service.svc`, with no additional suffixes other than the operation name."},{"content":"The following section in Web.config can be used to make additional configuration changes to the endpoint.","pos":[2052,2157]},{"content":"It can be removed if no extra changes are needed.","pos":[2158,2207]},{"content":"The default data format for <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.WebHttpEndpoint&gt;</ph> is XML, while the default data format for <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.WebScriptEndpoint&gt;</ph> is JSON.","pos":[2476,2666],"source":"The default data format for <xref:System.ServiceModel.Description.WebHttpEndpoint> is XML, while the default data format for <xref:System.ServiceModel.Description.WebScriptEndpoint> is JSON."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Creating WCF AJAX Services without ASP.NET<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/creating-wcf-ajax-services-without-aspnet.md)</ept>.","pos":[2667,2831],"source":" For more information, see [Creating WCF AJAX Services without ASP.NET](../../../../docs/framework/wcf/feature-details/creating-wcf-ajax-services-without-aspnet.md)."},{"content":"The service in the following sample is a standard WCF service with two operations.","pos":[2838,2920]},{"content":"Both operations require the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Web.WebMessageBodyStyle.Wrapped&gt;</ph> body style on the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Web.WebGetAttribute&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.ServiceModel.Web.WebInvokeAttribute&gt;</ph> attributes, which is specific to the <ph id=\"ph4\">`webHttp`</ph> behavior and has no bearing on the JSON/XML data format switch.","pos":[2921,3236],"source":" Both operations require the <xref:System.ServiceModel.Web.WebMessageBodyStyle.Wrapped> body style on the <xref:System.ServiceModel.Web.WebGetAttribute> or <xref:System.ServiceModel.Web.WebInvokeAttribute> attributes, which is specific to the `webHttp` behavior and has no bearing on the JSON/XML data format switch."},{"content":"The response format for the operation is specified as XML, which is the default setting for the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>webHttp&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/webhttp.md)</ept> behavior.","pos":[3418,3606],"source":"The response format for the operation is specified as XML, which is the default setting for the [\\<webHttp>](../../../../docs/framework/configure-apps/file-schema/wcf/webhttp.md) behavior."},{"content":"However, it is good practice explicitly specify the response format.","pos":[3607,3675]},{"pos":[3682,3804],"content":"The other operation uses the <ph id=\"ph1\">`WebInvokeAttribute`</ph> attribute and explicitly specifies JSON instead of XML for the response.","source":"The other operation uses the `WebInvokeAttribute` attribute and explicitly specifies JSON instead of XML for the response."},{"pos":[3988,4107],"content":"Note that in both cases the operations return a complex type, <ph id=\"ph1\">`MathResult`</ph>, which is a standard WCF data contract type.","source":"Note that in both cases the operations return a complex type, `MathResult`, which is a standard WCF data contract type."},{"content":"The client Web page XmlAjaxClientPage.htm contains JavaScript code that invokes one of the preceding two operations when the user clicks the <bpt id=\"p1\">**</bpt>Perform calculation (return JSON)<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Perform calculation (return XML)<ept id=\"p2\">**</ept> buttons on the page.","pos":[4114,4353],"source":"The client Web page XmlAjaxClientPage.htm contains JavaScript code that invokes one of the preceding two operations when the user clicks the **Perform calculation (return JSON)** or **Perform calculation (return XML)** buttons on the page."},{"content":"The code to invoke the service constructs a JSON body and sends it using HTTP POST.","pos":[4354,4437]},{"content":"The request is created manually in JavaScript, unlike the <bpt id=\"p1\">[</bpt>Basic AJAX Service<ept id=\"p1\">](../../../../docs/framework/wcf/samples/basic-ajax-service.md)</ept> sample and the other samples using ASP.NET AJAX.","pos":[4438,4627],"source":" The request is created manually in JavaScript, unlike the [Basic AJAX Service](../../../../docs/framework/wcf/samples/basic-ajax-service.md) sample and the other samples using ASP.NET AJAX."},{"content":"When the service responds, the response is displayed without any further processing in a textbox on the page.","pos":[5204,5313]},{"content":"This is implemented for demonstration purposes to allow you to directly observe the XML and JSON data formats used.","pos":[5314,5429]},{"pos":[5648,5780],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[14,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[5834,6144],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[6145,6195]},{"pos":[6279,6315],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"pos":[6325,6524],"content":"Ensure that you have performed the <bpt id=\"p1\">[</bpt>One-Time Setup Procedure for the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)</ept>.","source":"Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)."},{"pos":[6534,6708],"content":"Build the solution XmlAjaxService.sln as described in <bpt id=\"p1\">[</bpt>Building the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/building-the-samples.md)</ept>.","source":"Build the solution XmlAjaxService.sln as described in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md)."},{"pos":[6718,6869],"content":"Navigate to <ph id=\"ph1\">`http://localhost/ServiceModelSamples/XmlAjaxClientPage.htm`</ph> (do not open XmlAjaxClientPage.htm in the browser from the project directory).","source":"Navigate to `http://localhost/ServiceModelSamples/XmlAjaxClientPage.htm` (do not open XmlAjaxClientPage.htm in the browser from the project directory)."},{"pos":[6878,6886],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6890,6992],"content":"<bpt id=\"p1\">[</bpt>AJAX Service Using HTTP POST<ept id=\"p1\">](../../../../docs/framework/wcf/samples/ajax-service-using-http-post.md)</ept>","source":"[AJAX Service Using HTTP POST](../../../../docs/framework/wcf/samples/ajax-service-using-http-post.md)"}]}