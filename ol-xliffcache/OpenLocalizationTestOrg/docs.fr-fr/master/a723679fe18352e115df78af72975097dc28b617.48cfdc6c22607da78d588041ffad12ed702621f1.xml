{"content":"---\ntitle: \"Enumerating Instances of SQL Server (ADO.NET)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: ddf1c83c-9d40-45e6-b04d-9828c6cbbfdc\n---\n# Enumerating Instances of SQL Server (ADO.NET)\nSQL Server permits applications to find SQL Server instances within the current network. The <xref:System.Data.Sql.SqlDataSourceEnumerator> class exposes this information to the application developer, providing a <xref:System.Data.DataTable> containing information about all the visible servers. This returned table contains a list of server instances available on the network that matches the list provided when a user attempts to create a new connection, and expands the drop-down list containing all the available servers on the **Connection Properties** dialog box. The results displayed are not always complete.  \n  \n> [!NOTE]\n>  As with most Windows services, it is best to run the SQL Browser service with the least possible privileges. See SQL Server Books Online for more information on the SQL Browser service, and how to manage its behavior.  \n  \n## Retrieving an Enumerator Instance  \n In order to retrieve the table containing information about the available SQL Server instances, you must first retrieve an enumerator, using the shared/static <xref:System.Data.Sql.SqlDataSourceEnumerator.Instance%2A> property:  \n  \n```vb  \nDim instance As System.Data.Sql.SqlDataSourceEnumerator = _  \n   System.Data.Sql.SqlDataSourceEnumerator.Instance  \n```  \n  \n```csharp  \nSystem.Data.Sql.SqlDataSourceEnumerator instance =   \n   System.Data.Sql.SqlDataSourceEnumerator.Instance  \n```  \n  \n Once you have retrieved the static instance, you can call the <xref:System.Data.Sql.SqlDataSourceEnumerator.GetDataSources%2A> method, which returns a <xref:System.Data.DataTable> containing information about the available servers:  \n  \n```vb  \nDim dataTable As System.Data.DataTable = instance.GetDataSources()  \n```  \n  \n```csharp  \nSystem.Data.DataTable dataTable = instance.GetDataSources();  \n```  \n  \n The table returned from the method call contains the following columns, all of which contain `string` values:  \n  \n|Column|Description|  \n|------------|-----------------|  \n|**ServerName**|Name of the server.|  \n|**InstanceName**|Name of the server instance. Blank if the server is running as the default instance.|  \n|**IsClustered**|Indicates whether the server is part of a cluster.|  \n|**Version**|Version of the server. For example:<br /><br /> -   9.00.x ([!INCLUDE[ssVersion2005](../../../../../includes/ssversion2005-md.md)])<br />-   10.0.xx ([!INCLUDE[ssKatmai](../../../../../includes/sskatmai-md.md)])<br />-   10.50.x ([!INCLUDE[ssKilimanjaro](../../../../../includes/sskilimanjaro-md.md)])<br />-   11.0.xx (SQL Server 2012)|  \n  \n## Enumeration Limitations  \n All of the available servers may or may not be listed. The list can vary depending on factors such as timeouts and network traffic. This can cause the list to be different on two consecutive calls. Only servers on the same network will be listed. Broadcast packets typically won't traverse routers, which is why you may not see a server listed, but it will be stable across calls.  \n  \n Listed servers may or may not have additional information such as `IsClustered` and version. This is dependent on how the list was obtained. Servers listed through the SQL Server browser service will have more details than those found through the Windows infrastructure, which will list only the name.  \n  \n> [!NOTE]\n>  Server enumeration is only available when running in full-trust. Assemblies running in a partially-trusted environment will not be able to use it, even if they have the <xref:System.Data.SqlClient.SqlClientPermission> Code Access Security (CAS) permission.  \n  \n SQL Server provides information for the <xref:System.Data.Sql.SqlDataSourceEnumerator> through the use of an external Windows service named SQL Browser. This service is enabled by default, but administrators may turn it off or disable it, making the server instance invisible to this class.  \n  \n## Example  \n The following console application retrieves information about all of the visible SQL Server instances and displays the information in the console window.  \n  \n```vb  \nImports System.Data.Sql  \n  \nModule Module1  \n  Sub Main()  \n    ' Retrieve the enumerator instance and then the data.  \n    Dim instance As SqlDataSourceEnumerator = _  \n     SqlDataSourceEnumerator.Instance  \n    Dim table As System.Data.DataTable = instance.GetDataSources()  \n  \n    ' Display the contents of the table.  \n    DisplayData(table)  \n  \n    Console.WriteLine(\"Press any key to continue.\")  \n    Console.ReadKey()  \n  End Sub  \n  \n  Private Sub DisplayData(ByVal table As DataTable)  \n    For Each row As DataRow In table.Rows  \n      For Each col As DataColumn In table.Columns  \n        Console.WriteLine(\"{0} = {1}\", col.ColumnName, row(col))  \n      Next  \n      Console.WriteLine(\"============================\")  \n    Next  \n  End Sub  \nEnd Module  \n```  \n  \n```csharp  \nusing System.Data.Sql;  \n  \nclass Program  \n{  \n  static void Main()  \n  {  \n    // Retrieve the enumerator instance and then the data.  \n    SqlDataSourceEnumerator instance =  \n      SqlDataSourceEnumerator.Instance;  \n    System.Data.DataTable table = instance.GetDataSources();  \n  \n    // Display the contents of the table.  \n    DisplayData(table);  \n  \n    Console.WriteLine(\"Press any key to continue.\");  \n    Console.ReadKey();  \n  }  \n  \n  private static void DisplayData(System.Data.DataTable table)  \n  {  \n    foreach (System.Data.DataRow row in table.Rows)  \n    {  \n      foreach (System.Data.DataColumn col in table.Columns)  \n      {  \n        Console.WriteLine(\"{0} = {1}\", col.ColumnName, row[col]);  \n      }  \n      Console.WriteLine(\"============================\");  \n    }  \n  }  \n}  \n```  \n  \n## See also\n\n- [SQL Server and ADO.NET](../../../../../docs/framework/data/adonet/sql/index.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,163],"embed":true,"restype":"x-metadata","content":"title: \"Enumerating Instances of SQL Server (ADO.NET)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: ddf1c83c-9d40-45e6-b04d-9828c6cbbfdc","nodes":[{"content":"Enumerating Instances of SQL Server (ADO.NET)","nodes":[{"pos":[0,45],"content":"Enumerating Instances of SQL Server (ADO.NET)","nodes":[{"content":"Enumerating Instances of SQL Server (ADO.NET)","pos":[0,45]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[170,215],"content":"Enumerating Instances of SQL Server (ADO.NET)","linkify":"Enumerating Instances of SQL Server (ADO.NET)","nodes":[{"content":"Enumerating Instances of SQL Server (ADO.NET)","pos":[0,45]}]},{"content":"SQL Server permits applications to find SQL Server instances within the current network.","pos":[216,304]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Sql.SqlDataSourceEnumerator&gt;</ph> class exposes this information to the application developer, providing a <ph id=\"ph2\">&lt;xref:System.Data.DataTable&gt;</ph> containing information about all the visible servers.","pos":[305,511],"source":" The <xref:System.Data.Sql.SqlDataSourceEnumerator> class exposes this information to the application developer, providing a <xref:System.Data.DataTable> containing information about all the visible servers."},{"content":"This returned table contains a list of server instances available on the network that matches the list provided when a user attempts to create a new connection, and expands the drop-down list containing all the available servers on the <bpt id=\"p1\">**</bpt>Connection Properties<ept id=\"p1\">**</ept> dialog box.","pos":[512,785],"source":" This returned table contains a list of server instances available on the network that matches the list provided when a user attempts to create a new connection, and expands the drop-down list containing all the available servers on the **Connection Properties** dialog box."},{"content":"The results displayed are not always complete.","pos":[786,832]},{"pos":[840,1068],"content":"[!NOTE]\n As with most Windows services, it is best to run the SQL Browser service with the least possible privileges. See SQL Server Books Online for more information on the SQL Browser service, and how to manage its behavior.","leadings":["","> "],"nodes":[{"content":"As with most Windows services, it is best to run the SQL Browser service with the least possible privileges. See SQL Server Books Online for more information on the SQL Browser service, and how to manage its behavior.","pos":[9,226],"nodes":[{"content":"As with most Windows services, it is best to run the SQL Browser service with the least possible privileges.","pos":[0,108]},{"content":"See SQL Server Books Online for more information on the SQL Browser service, and how to manage its behavior.","pos":[109,217]}]}]},{"pos":[1077,1110],"content":"Retrieving an Enumerator Instance","linkify":"Retrieving an Enumerator Instance","nodes":[{"content":"Retrieving an Enumerator Instance","pos":[0,33]}]},{"pos":[1114,1341],"content":"In order to retrieve the table containing information about the available SQL Server instances, you must first retrieve an enumerator, using the shared/static <ph id=\"ph1\">&lt;xref:System.Data.Sql.SqlDataSourceEnumerator.Instance%2A&gt;</ph> property:","source":"In order to retrieve the table containing information about the available SQL Server instances, you must first retrieve an enumerator, using the shared/static <xref:System.Data.Sql.SqlDataSourceEnumerator.Instance%2A> property:"},{"pos":[1610,1841],"content":"Once you have retrieved the static instance, you can call the <ph id=\"ph1\">&lt;xref:System.Data.Sql.SqlDataSourceEnumerator.GetDataSources%2A&gt;</ph> method, which returns a <ph id=\"ph2\">&lt;xref:System.Data.DataTable&gt;</ph> containing information about the available servers:","source":"Once you have retrieved the static instance, you can call the <xref:System.Data.Sql.SqlDataSourceEnumerator.GetDataSources%2A> method, which returns a <xref:System.Data.DataTable> containing information about the available servers:"},{"pos":[2018,2127],"content":"The table returned from the method call contains the following columns, all of which contain <ph id=\"ph1\">`string`</ph> values:","source":"The table returned from the method call contains the following columns, all of which contain `string` values:"},{"content":"Column","pos":[2134,2140]},{"content":"Description","pos":[2141,2152]},{"pos":[2192,2206],"content":"<bpt id=\"p1\">**</bpt>ServerName<ept id=\"p1\">**</ept>","source":"**ServerName**"},{"content":"Name of the server.","pos":[2207,2226]},{"pos":[2231,2247],"content":"<bpt id=\"p1\">**</bpt>InstanceName<ept id=\"p1\">**</ept>","source":"**InstanceName**"},{"content":"Name of the server instance.","pos":[2248,2276]},{"content":"Blank if the server is running as the default instance.","pos":[2277,2332]},{"pos":[2337,2352],"content":"<bpt id=\"p1\">**</bpt>IsClustered<ept id=\"p1\">**</ept>","source":"**IsClustered**"},{"content":"Indicates whether the server is part of a cluster.","pos":[2353,2403]},{"pos":[2408,2419],"content":"<bpt id=\"p1\">**</bpt>Version<ept id=\"p1\">**</ept>","source":"**Version**"},{"content":"Version of the server.","pos":[2420,2442]},{"content":"For example:","pos":[2443,2455]},{"content":"-   9.00.x (<ph id=\"ph1\">[!INCLUDE[ssVersion2005](../../../../../includes/ssversion2005-md.md)]</ph>)","pos":[2468,2551],"source":"-   9.00.x ([!INCLUDE[ssVersion2005](../../../../../includes/ssversion2005-md.md)])"},{"content":"-   10.0.xx (<ph id=\"ph1\">[!INCLUDE[ssKatmai](../../../../../includes/sskatmai-md.md)]</ph>)","pos":[2557,2631],"source":"-   10.0.xx ([!INCLUDE[ssKatmai](../../../../../includes/sskatmai-md.md)])"},{"content":"-   10.50.x (<ph id=\"ph1\">[!INCLUDE[ssKilimanjaro](../../../../../includes/sskilimanjaro-md.md)]</ph>)","pos":[2637,2721],"source":"-   10.50.x ([!INCLUDE[ssKilimanjaro](../../../../../includes/sskilimanjaro-md.md)])"},{"content":"-   11.0.xx (SQL Server 2012)","pos":[2727,2756]},{"pos":[2766,2789],"content":"Enumeration Limitations","linkify":"Enumeration Limitations","nodes":[{"content":"Enumeration Limitations","pos":[0,23]}]},{"content":"All of the available servers may or may not be listed.","pos":[2793,2847]},{"content":"The list can vary depending on factors such as timeouts and network traffic.","pos":[2848,2924]},{"content":"This can cause the list to be different on two consecutive calls.","pos":[2925,2990]},{"content":"Only servers on the same network will be listed.","pos":[2991,3039]},{"content":"Broadcast packets typically won't traverse routers, which is why you may not see a server listed, but it will be stable across calls.","pos":[3040,3173]},{"content":"Listed servers may or may not have additional information such as <ph id=\"ph1\">`IsClustered`</ph> and version.","pos":[3180,3272],"source":"Listed servers may or may not have additional information such as `IsClustered` and version."},{"content":"This is dependent on how the list was obtained.","pos":[3273,3320]},{"content":"Servers listed through the SQL Server browser service will have more details than those found through the Windows infrastructure, which will list only the name.","pos":[3321,3481]},{"pos":[3489,3756],"content":"[!NOTE]\n Server enumeration is only available when running in full-trust. Assemblies running in a partially-trusted environment will not be able to use it, even if they have the <xref:System.Data.SqlClient.SqlClientPermission> Code Access Security (CAS) permission.","leadings":["","> "],"nodes":[{"content":"Server enumeration is only available when running in full-trust. Assemblies running in a partially-trusted environment will not be able to use it, even if they have the <xref:System.Data.SqlClient.SqlClientPermission> Code Access Security (CAS) permission.","pos":[9,265],"nodes":[{"content":"Server enumeration is only available when running in full-trust.","pos":[0,64]},{"content":"Assemblies running in a partially-trusted environment will not be able to use it, even if they have the <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlClientPermission&gt;</ph> Code Access Security (CAS) permission.","pos":[65,256],"source":" Assemblies running in a partially-trusted environment will not be able to use it, even if they have the <xref:System.Data.SqlClient.SqlClientPermission> Code Access Security (CAS) permission."}]}]},{"content":"SQL Server provides information for the <ph id=\"ph1\">&lt;xref:System.Data.Sql.SqlDataSourceEnumerator&gt;</ph> through the use of an external Windows service named SQL Browser.","pos":[3763,3915],"source":"SQL Server provides information for the <xref:System.Data.Sql.SqlDataSourceEnumerator> through the use of an external Windows service named SQL Browser."},{"content":"This service is enabled by default, but administrators may turn it off or disable it, making the server instance invisible to this class.","pos":[3916,4053]},{"pos":[4062,4069],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following console application retrieves information about all of the visible SQL Server instances and displays the information in the console window.","pos":[4073,4226]},{"pos":[5853,5861],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5865,5945],"content":"<bpt id=\"p1\">[</bpt>SQL Server and ADO.NET<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/index.md)</ept>","source":"[SQL Server and ADO.NET](../../../../../docs/framework/data/adonet/sql/index.md)"},{"pos":[5948,6052],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}