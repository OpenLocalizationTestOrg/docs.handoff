{"content":"---\ntitle: \"raceOnRCWCleanup MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"RCW\"\n  - \"managed debugging assistants (MDAs), RCWs\"\n  - \"race on RCW cleanup\"\n  - \"MDAs (managed debugging assistants), RCWs\"\n  - \"RaceOnRCWCleanup MDA\"\n  - \"runtime callable wrappers\"\nms.assetid: bee1e9b1-50a8-4c89-9cd9-7dd6b2458187\ncaps.latest.revision: 9\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# raceOnRCWCleanup MDA\nThe `raceOnRCWCleanup` managed debugging assistant (MDA) is activated when the common language runtime (CLR) detects that a [Runtime Callable Wrapper](../../../docs/framework/interop/runtime-callable-wrapper.md) (RCW) is in use when a call to release it is made using a command such as the <xref:System.Runtime.InteropServices.Marshal.ReleaseComObject%2A?displayProperty=fullName> method.  \n  \n## Symptoms  \n Access violations or memory corruption during or after freeing an RCW using <xref:System.Runtime.InteropServices.Marshal.ReleaseComObject%2A> or a similar method.  \n  \n## Cause  \n The RCW is in use on another thread or on the freeing thread stack.  An RCW that is in use cannot be released.  \n  \n## Resolution  \n Do not free an RCW that could be in use either in the current or in other threads.  \n  \n## Effect on the Runtime  \n This MDA has no effect on the CLR.  \n  \n## Output  \n A message describing the error.  \n  \n## Configuration  \n  \n```  \n<mdaConfig>  \n  <assistants>  \n    <raceOnRCWCleanup/>  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## See Also  \n <xref:System.Runtime.InteropServices.MarshalAsAttribute>   \n [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)   \n [Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)","nodes":[{"pos":[4,612],"nodes":[{"content":"raceOnRCWCleanup MDA | Microsoft Docs","nodes":[{"pos":[0,37],"content":"raceOnRCWCleanup MDA | Microsoft Docs","nodes":[{"content":"raceOnRCWCleanup MDA | Microsoft Docs","pos":[0,37]}]}],"pos":[6,46],"yaml":true}],"content":"title: \"raceOnRCWCleanup MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"RCW\"\n  - \"managed debugging assistants (MDAs), RCWs\"\n  - \"race on RCW cleanup\"\n  - \"MDAs (managed debugging assistants), RCWs\"\n  - \"RaceOnRCWCleanup MDA\"\n  - \"runtime callable wrappers\"\nms.assetid: bee1e9b1-50a8-4c89-9cd9-7dd6b2458187\ncaps.latest.revision: 9\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[619,639],"content":"raceOnRCWCleanup MDA","linkify":"raceOnRCWCleanup MDA","nodes":[{"content":"raceOnRCWCleanup MDA","pos":[0,20]}]},{"pos":[640,1028],"content":"The <ph id=\"ph1\">`raceOnRCWCleanup`</ph> managed debugging assistant (MDA) is activated when the common language runtime (CLR) detects that a <bpt id=\"p1\">[</bpt>Runtime Callable Wrapper<ept id=\"p1\">](../../../docs/framework/interop/runtime-callable-wrapper.md)</ept> (RCW) is in use when a call to release it is made using a command such as the <ph id=\"ph2\">&lt;xref:System.Runtime.InteropServices.Marshal.ReleaseComObject%2A?displayProperty=fullName&gt;</ph> method.","source":"The `raceOnRCWCleanup` managed debugging assistant (MDA) is activated when the common language runtime (CLR) detects that a [Runtime Callable Wrapper](../../../docs/framework/interop/runtime-callable-wrapper.md) (RCW) is in use when a call to release it is made using a command such as the <xref:System.Runtime.InteropServices.Marshal.ReleaseComObject%2A?displayProperty=fullName> method."},{"pos":[1037,1045],"content":"Symptoms","linkify":"Symptoms","nodes":[{"content":"Symptoms","pos":[0,8]}]},{"content":"Access violations or memory corruption during or after freeing an RCW using <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.Marshal.ReleaseComObject%2A&gt;</ph> or a similar method.","pos":[1049,1211],"source":"Access violations or memory corruption during or after freeing an RCW using <xref:System.Runtime.InteropServices.Marshal.ReleaseComObject%2A> or a similar method."},{"pos":[1220,1225],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"content":"The RCW is in use on another thread or on the freeing thread stack.","pos":[1229,1296]},{"content":"An RCW that is in use cannot be released.","pos":[1298,1339]},{"pos":[1348,1358],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"content":"Do not free an RCW that could be in use either in the current or in other threads.","pos":[1362,1444]},{"pos":[1453,1474],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"content":"This MDA has no effect on the CLR.","pos":[1478,1512]},{"pos":[1521,1527],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"A message describing the error.","pos":[1531,1562]},{"pos":[1571,1584],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[1698,1706],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.MarshalAsAttribute&gt;</ph>","pos":[1710,1766],"source":"<xref:System.Runtime.InteropServices.MarshalAsAttribute> "},{"content":"<bpt id=\"p1\">[</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept><ph id=\"ph1\"> </ph>","pos":[1771,1925],"source":"[Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md) "},{"content":"<bpt id=\"p1\">[</bpt>Interop Marshaling<ept id=\"p1\">](../../../docs/framework/interop/interop-marshaling.md)</ept>","pos":[1929,2004],"source":"[Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)"}]}