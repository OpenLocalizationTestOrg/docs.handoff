{"content":"---\ntitle: \"failedQI MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"failed QueryInterface\"\n  - \"FailedQI MDA\"\n  - \"QueryInterface call failures\"\n  - \"MDAs (managed debugging assistants), failed QueryInterface\"\n  - \"managed debugging assistants (MDAs), failed QueryInterface\"\nms.assetid: 902dc863-34b3-477c-b433-b8a6bb6133c6\ncaps.latest.revision: 15\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# failedQI MDA\nThe `failedQI` managed debugging assistant (MDA) is activated when the runtime calls `QueryInterface` on a COM interface pointer on behalf of a runtime callable wrapper (RCW), and the `QueryInterface` call fails.  \n  \n## Symptoms  \n A cast on an RCW fails, or a call to COM from an RCW fails unexpectedly.  \n  \n## Cause  \n  \n-   The call is made from the wrong context.  \n  \n-   The registered proxy is failing the `QueryInterface` call because the call was attempted in the wrong context.  \n  \n-   An OLE-owned proxy returned a failure HRESULT.  \n  \n## Resolution  \n See the MSDN documentation on COM rules.  \n  \n## Effect on the Runtime  \n If a `QueryInterface` call fails, the context is switched and the `QueryInterface` call is attempted again to see if an incorrect context was at fault.  \n  \n## Output  \n The managed name of the interface, the GUID of the interface, and the HRESULT of the failure.  \n  \n## Configuration  \n  \n```  \n<mdaConfig>  \n  <assistants>  \n    <failedQI/>  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## See Also  \n <xref:System.Runtime.InteropServices.MarshalAsAttribute>   \n [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)   \n [Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)","nodes":[{"pos":[12,41],"content":"failedQI MDA | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"failedQI MDA | Microsoft Docs","pos":[0,29]}]},{"pos":[633,645],"content":"failedQI MDA","linkify":"failedQI MDA","nodes":[{"content":"failedQI MDA","pos":[0,12]}]},{"pos":[646,858],"content":"The <ph id=\"ph1\">`failedQI`</ph> managed debugging assistant (MDA) is activated when the runtime calls <ph id=\"ph2\">`QueryInterface`</ph> on a COM interface pointer on behalf of a runtime callable wrapper (RCW), and the <ph id=\"ph3\">`QueryInterface`</ph> call fails.","source":"The `failedQI` managed debugging assistant (MDA) is activated when the runtime calls `QueryInterface` on a COM interface pointer on behalf of a runtime callable wrapper (RCW), and the `QueryInterface` call fails."},{"pos":[867,875],"content":"Symptoms","linkify":"Symptoms","nodes":[{"content":"Symptoms","pos":[0,8]}]},{"content":"A cast on an RCW fails, or a call to COM from an RCW fails unexpectedly.","pos":[879,951]},{"pos":[960,965],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"content":"The call is made from the wrong context.","pos":[975,1015]},{"pos":[1025,1135],"content":"The registered proxy is failing the <ph id=\"ph1\">`QueryInterface`</ph> call because the call was attempted in the wrong context.","source":"The registered proxy is failing the `QueryInterface` call because the call was attempted in the wrong context."},{"content":"An OLE-owned proxy returned a failure HRESULT.","pos":[1145,1191]},{"pos":[1200,1210],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"content":"See the MSDN documentation on COM rules.","pos":[1214,1254]},{"pos":[1263,1284],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"pos":[1288,1439],"content":"If a <ph id=\"ph1\">`QueryInterface`</ph> call fails, the context is switched and the <ph id=\"ph2\">`QueryInterface`</ph> call is attempted again to see if an incorrect context was at fault.","source":"If a `QueryInterface` call fails, the context is switched and the `QueryInterface` call is attempted again to see if an incorrect context was at fault."},{"pos":[1448,1454],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"The managed name of the interface, the GUID of the interface, and the HRESULT of the failure.","pos":[1458,1551]},{"pos":[1560,1573],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[1679,1687],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept><ph id=\"ph1\"> </ph>","pos":[1751,1906],"source":" [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Interop Marshaling<ept id=\"p1\">](../../../docs/framework/interop/interop-marshaling.md)</ept>","pos":[1909,1985],"source":" [Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)"}]}