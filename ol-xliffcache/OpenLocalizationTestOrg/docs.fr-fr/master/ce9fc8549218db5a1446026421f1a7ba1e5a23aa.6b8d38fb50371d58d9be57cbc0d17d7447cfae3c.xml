{"content":"---\ntitle: \"How to: Set the ProtectionLevel Property\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"WCF, security\"\n  - \"ProtectionLevel property\"\nms.assetid: 3d4e8f80-0f9e-4a26-9899-beb6584e78df\n---\n# How to: Set the ProtectionLevel Property\nYou can set the protection level by applying an appropriate attribute and setting the property. You can set protection at the service level to affect all parts of every message, or you can set protection at increasingly granular levels, from methods to message parts. For more information about the `ProtectionLevel` property, see [Understanding Protection Level](../../../docs/framework/wcf/understanding-protection-level.md).  \n  \n> [!NOTE]\n>  You can set protection levels only in code, not in configuration.  \n  \n### To sign all messages for a service  \n  \n1.  Create an interface for the service.  \n  \n2.  Apply the <xref:System.ServiceModel.ServiceContractAttribute> attribute to the service and set the <xref:System.ServiceModel.ServiceContractAttribute.ProtectionLevel%2A> property to <xref:System.Net.Security.ProtectionLevel.Sign>, as shown in the following code (the default level is <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>).  \n  \n     [!code-csharp[C_ProtectionLevel#1](../../../samples/snippets/csharp/VS_Snippets_CFX/c_protectionlevel/cs/source.cs#1)]\n     [!code-vb[C_ProtectionLevel#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_protectionlevel/vb/source.vb#1)]  \n  \n### To sign all message parts for an operation  \n  \n1.  Create an interface for the service and apply the <xref:System.ServiceModel.ServiceContractAttribute> attribute to the interface.  \n  \n2.  Add a method declaration to the interface.  \n  \n3.  Apply the <xref:System.ServiceModel.OperationContractAttribute> attribute to the method, and set the <xref:System.ServiceModel.ServiceContractAttribute.ProtectionLevel%2A> property to <xref:System.Net.Security.ProtectionLevel.Sign>, as shown in the following code.  \n  \n     [!code-csharp[C_ProtectionLevel#2](../../../samples/snippets/csharp/VS_Snippets_CFX/c_protectionlevel/cs/source.cs#2)]\n     [!code-vb[C_ProtectionLevel#2](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_protectionlevel/vb/source.vb#2)]  \n  \n## Protecting Fault Messages  \n Exceptions that are thrown on a service can be sent to a client as SOAP faults. For more information about creating strongly typed faults, see [Specifying and Handling Faults in Contracts and Services](../../../docs/framework/wcf/specifying-and-handling-faults-in-contracts-and-services.md) and [How to: Declare Faults in Service Contracts](../../../docs/framework/wcf/how-to-declare-faults-in-service-contracts.md).  \n  \n#### To protect a fault message  \n  \n1.  Create a type that represents the fault message. The following example creates a class named `MathFault` with two fields.  \n  \n2.  Apply the <xref:System.Runtime.Serialization.DataContractAttribute> attribute to the type and a <xref:System.Runtime.Serialization.DataMemberAttribute> attribute to each field that should be serialized, as shown in the following code.  \n  \n     [!code-csharp[C_ProtectionLevel#3](../../../samples/snippets/csharp/VS_Snippets_CFX/c_protectionlevel/cs/source.cs#3)]\n     [!code-vb[C_ProtectionLevel#3](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_protectionlevel/vb/source.vb#3)]  \n  \n3.  In the interface that will return the fault, apply the <xref:System.ServiceModel.FaultContractAttribute> attribute to the method that will return the fault and set the `detailType` parameter to the type of the fault class.  \n  \n4.  Also in the constructor, set the <xref:System.ServiceModel.FaultContractAttribute.ProtectionLevel%2A> property to <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>, as shown in the following code.  \n  \n     [!code-csharp[C_ProtectionLevel#4](../../../samples/snippets/csharp/VS_Snippets_CFX/c_protectionlevel/cs/source.cs#4)]\n     [!code-vb[C_ProtectionLevel#4](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_protectionlevel/vb/source.vb#4)]  \n  \n## Protecting Message Parts  \n Use a message contract to protect parts of a message. For more information about message contracts, see [Using Message Contracts](../../../docs/framework/wcf/feature-details/using-message-contracts.md).  \n  \n#### To protect a message body  \n  \n1.  Create a type that represents the message. The following example creates a `Company` class with two fields, `CompanyName` and `CompanyID`.  \n  \n2.  Apply the <xref:System.ServiceModel.MessageContractAttribute> attribute to the class and set the <xref:System.ServiceModel.MessageContractAttribute.ProtectionLevel%2A> property to <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>.  \n  \n3.  Apply the <xref:System.ServiceModel.MessageHeaderAttribute> attribute to a field that will be expressed as a message header and set the `ProtectionLevel` property to <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>.  \n  \n4.  Apply the <xref:System.ServiceModel.MessageBodyMemberAttribute> to any field that will be expressed as part of the message body, and set the `ProtectionLevel` property to <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>, as shown in the following example.  \n  \n     [!code-csharp[C_ProtectionLevel#5](../../../samples/snippets/csharp/VS_Snippets_CFX/c_protectionlevel/cs/source.cs#5)]\n     [!code-vb[C_ProtectionLevel#5](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_protectionlevel/vb/source.vb#5)]  \n  \n## Example  \n The following example sets the `ProtectionLevel` property of several attribute classes at various places in a service.  \n  \n [!code-csharp[C_ProtectionLevel#6](../../../samples/snippets/csharp/VS_Snippets_CFX/c_protectionlevel/cs/source.cs#6)]\n [!code-vb[C_ProtectionLevel#6](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_protectionlevel/vb/source.vb#6)]  \n  \n## Compiling the Code  \n The following code shows the namespaces required to compile the example code.  \n  \n [!code-csharp[C_ProtectionLevel#0](../../../samples/snippets/csharp/VS_Snippets_CFX/c_protectionlevel/cs/source.cs#0)]\n [!code-vb[C_ProtectionLevel#0](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_protectionlevel/vb/source.vb#0)]  \n  \n## See also\n\n- <xref:System.ServiceModel.ServiceContractAttribute>\n- <xref:System.ServiceModel.OperationContractAttribute>\n- <xref:System.ServiceModel.FaultContractAttribute>\n- <xref:System.ServiceModel.MessageContractAttribute>\n- <xref:System.ServiceModel.MessageBodyMemberAttribute>\n- [Understanding Protection Level](../../../docs/framework/wcf/understanding-protection-level.md)\n","nodes":[{"pos":[4,231],"embed":true,"restype":"x-metadata","content":"title: \"How to: Set the ProtectionLevel Property\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"WCF, security\"\n  - \"ProtectionLevel property\"\nms.assetid: 3d4e8f80-0f9e-4a26-9899-beb6584e78df","nodes":[{"content":"How to: Set the ProtectionLevel Property","nodes":[{"pos":[0,40],"content":"How to: Set the ProtectionLevel Property","nodes":[{"content":"How to: Set the ProtectionLevel Property","pos":[0,40]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[238,278],"content":"How to: Set the ProtectionLevel Property","linkify":"How to: Set the ProtectionLevel Property","nodes":[{"content":"How to: Set the ProtectionLevel Property","pos":[0,40]}]},{"content":"You can set the protection level by applying an appropriate attribute and setting the property.","pos":[279,374]},{"content":"You can set protection at the service level to affect all parts of every message, or you can set protection at increasingly granular levels, from methods to message parts.","pos":[375,546]},{"content":"For more information about the <ph id=\"ph1\">`ProtectionLevel`</ph> property, see <bpt id=\"p1\">[</bpt>Understanding Protection Level<ept id=\"p1\">](../../../docs/framework/wcf/understanding-protection-level.md)</ept>.","pos":[547,706],"source":" For more information about the `ProtectionLevel` property, see [Understanding Protection Level](../../../docs/framework/wcf/understanding-protection-level.md)."},{"pos":[714,790],"content":"[!NOTE]\n You can set protection levels only in code, not in configuration.","leadings":["","> "],"nodes":[{"content":"You can set protection levels only in code, not in configuration.","pos":[9,74]}]},{"pos":[800,834],"content":"To sign all messages for a service","linkify":"To sign all messages for a service","nodes":[{"content":"To sign all messages for a service","pos":[0,34]}]},{"content":"Create an interface for the service.","pos":[844,880]},{"pos":[890,1233],"content":"Apply the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceContractAttribute&gt;</ph> attribute to the service and set the <ph id=\"ph2\">&lt;xref:System.ServiceModel.ServiceContractAttribute.ProtectionLevel%2A&gt;</ph> property to <ph id=\"ph3\">&lt;xref:System.Net.Security.ProtectionLevel.Sign&gt;</ph>, as shown in the following code (the default level is <ph id=\"ph4\">&lt;xref:System.Net.Security.ProtectionLevel.EncryptAndSign&gt;</ph>).","source":"Apply the <xref:System.ServiceModel.ServiceContractAttribute> attribute to the service and set the <xref:System.ServiceModel.ServiceContractAttribute.ProtectionLevel%2A> property to <xref:System.Net.Security.ProtectionLevel.Sign>, as shown in the following code (the default level is <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>)."},{"pos":[1244,1487],"content":"[!code-csharp[C_ProtectionLevel#1](../../../samples/snippets/csharp/VS_Snippets_CFX/c_protectionlevel/cs/source.cs#1)]\n [!code-vb[C_ProtectionLevel#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_protectionlevel/vb/source.vb#1)]","leadings":["","    "],"nodes":[]},{"pos":[1497,1539],"content":"To sign all message parts for an operation","linkify":"To sign all message parts for an operation","nodes":[{"content":"To sign all message parts for an operation","pos":[0,42]}]},{"pos":[1549,1678],"content":"Create an interface for the service and apply the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceContractAttribute&gt;</ph> attribute to the interface.","source":"Create an interface for the service and apply the <xref:System.ServiceModel.ServiceContractAttribute> attribute to the interface."},{"content":"Add a method declaration to the interface.","pos":[1688,1730]},{"pos":[1740,2004],"content":"Apply the <ph id=\"ph1\">&lt;xref:System.ServiceModel.OperationContractAttribute&gt;</ph> attribute to the method, and set the <ph id=\"ph2\">&lt;xref:System.ServiceModel.ServiceContractAttribute.ProtectionLevel%2A&gt;</ph> property to <ph id=\"ph3\">&lt;xref:System.Net.Security.ProtectionLevel.Sign&gt;</ph>, as shown in the following code.","source":"Apply the <xref:System.ServiceModel.OperationContractAttribute> attribute to the method, and set the <xref:System.ServiceModel.ServiceContractAttribute.ProtectionLevel%2A> property to <xref:System.Net.Security.ProtectionLevel.Sign>, as shown in the following code."},{"pos":[2015,2258],"content":"[!code-csharp[C_ProtectionLevel#2](../../../samples/snippets/csharp/VS_Snippets_CFX/c_protectionlevel/cs/source.cs#2)]\n [!code-vb[C_ProtectionLevel#2](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_protectionlevel/vb/source.vb#2)]","leadings":["","    "],"nodes":[]},{"pos":[2267,2292],"content":"Protecting Fault Messages","linkify":"Protecting Fault Messages","nodes":[{"content":"Protecting Fault Messages","pos":[0,25]}]},{"content":"Exceptions that are thrown on a service can be sent to a client as SOAP faults.","pos":[2296,2375]},{"content":"For more information about creating strongly typed faults, see <bpt id=\"p1\">[</bpt>Specifying and Handling Faults in Contracts and Services<ept id=\"p1\">](../../../docs/framework/wcf/specifying-and-handling-faults-in-contracts-and-services.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Declare Faults in Service Contracts<ept id=\"p2\">](../../../docs/framework/wcf/how-to-declare-faults-in-service-contracts.md)</ept>.","pos":[2376,2712],"source":" For more information about creating strongly typed faults, see [Specifying and Handling Faults in Contracts and Services](../../../docs/framework/wcf/specifying-and-handling-faults-in-contracts-and-services.md) and [How to: Declare Faults in Service Contracts](../../../docs/framework/wcf/how-to-declare-faults-in-service-contracts.md)."},{"pos":[2723,2749],"content":"To protect a fault message","linkify":"To protect a fault message","nodes":[{"content":"To protect a fault message","pos":[0,26]}]},{"content":"Create a type that represents the fault message.","pos":[2759,2807]},{"content":"The following example creates a class named <ph id=\"ph1\">`MathFault`</ph> with two fields.","pos":[2808,2880],"source":" The following example creates a class named `MathFault` with two fields."},{"pos":[2890,3124],"content":"Apply the <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataContractAttribute&gt;</ph> attribute to the type and a <ph id=\"ph2\">&lt;xref:System.Runtime.Serialization.DataMemberAttribute&gt;</ph> attribute to each field that should be serialized, as shown in the following code.","source":"Apply the <xref:System.Runtime.Serialization.DataContractAttribute> attribute to the type and a <xref:System.Runtime.Serialization.DataMemberAttribute> attribute to each field that should be serialized, as shown in the following code."},{"pos":[3135,3378],"content":"[!code-csharp[C_ProtectionLevel#3](../../../samples/snippets/csharp/VS_Snippets_CFX/c_protectionlevel/cs/source.cs#3)]\n [!code-vb[C_ProtectionLevel#3](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_protectionlevel/vb/source.vb#3)]","leadings":["","    "],"nodes":[]},{"pos":[3388,3610],"content":"In the interface that will return the fault, apply the <ph id=\"ph1\">&lt;xref:System.ServiceModel.FaultContractAttribute&gt;</ph> attribute to the method that will return the fault and set the <ph id=\"ph2\">`detailType`</ph> parameter to the type of the fault class.","source":"In the interface that will return the fault, apply the <xref:System.ServiceModel.FaultContractAttribute> attribute to the method that will return the fault and set the `detailType` parameter to the type of the fault class."},{"pos":[3620,3824],"content":"Also in the constructor, set the <ph id=\"ph1\">&lt;xref:System.ServiceModel.FaultContractAttribute.ProtectionLevel%2A&gt;</ph> property to <ph id=\"ph2\">&lt;xref:System.Net.Security.ProtectionLevel.EncryptAndSign&gt;</ph>, as shown in the following code.","source":"Also in the constructor, set the <xref:System.ServiceModel.FaultContractAttribute.ProtectionLevel%2A> property to <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>, as shown in the following code."},{"pos":[3835,4078],"content":"[!code-csharp[C_ProtectionLevel#4](../../../samples/snippets/csharp/VS_Snippets_CFX/c_protectionlevel/cs/source.cs#4)]\n [!code-vb[C_ProtectionLevel#4](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_protectionlevel/vb/source.vb#4)]","leadings":["","    "],"nodes":[]},{"pos":[4087,4111],"content":"Protecting Message Parts","linkify":"Protecting Message Parts","nodes":[{"content":"Protecting Message Parts","pos":[0,24]}]},{"content":"Use a message contract to protect parts of a message.","pos":[4115,4168]},{"content":"For more information about message contracts, see <bpt id=\"p1\">[</bpt>Using Message Contracts<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/using-message-contracts.md)</ept>.","pos":[4169,4317],"source":" For more information about message contracts, see [Using Message Contracts](../../../docs/framework/wcf/feature-details/using-message-contracts.md)."},{"pos":[4328,4353],"content":"To protect a message body","linkify":"To protect a message body","nodes":[{"content":"To protect a message body","pos":[0,25]}]},{"content":"Create a type that represents the message.","pos":[4363,4405]},{"content":"The following example creates a <ph id=\"ph1\">`Company`</ph> class with two fields, <ph id=\"ph2\">`CompanyName`</ph> and <ph id=\"ph3\">`CompanyID`</ph>.","pos":[4406,4501],"source":" The following example creates a `Company` class with two fields, `CompanyName` and `CompanyID`."},{"pos":[4511,4749],"content":"Apply the <ph id=\"ph1\">&lt;xref:System.ServiceModel.MessageContractAttribute&gt;</ph> attribute to the class and set the <ph id=\"ph2\">&lt;xref:System.ServiceModel.MessageContractAttribute.ProtectionLevel%2A&gt;</ph> property to <ph id=\"ph3\">&lt;xref:System.Net.Security.ProtectionLevel.EncryptAndSign&gt;</ph>.","source":"Apply the <xref:System.ServiceModel.MessageContractAttribute> attribute to the class and set the <xref:System.ServiceModel.MessageContractAttribute.ProtectionLevel%2A> property to <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>."},{"pos":[4759,4983],"content":"Apply the <ph id=\"ph1\">&lt;xref:System.ServiceModel.MessageHeaderAttribute&gt;</ph> attribute to a field that will be expressed as a message header and set the <ph id=\"ph2\">`ProtectionLevel`</ph> property to <ph id=\"ph3\">&lt;xref:System.Net.Security.ProtectionLevel.EncryptAndSign&gt;</ph>.","source":"Apply the <xref:System.ServiceModel.MessageHeaderAttribute> attribute to a field that will be expressed as a message header and set the `ProtectionLevel` property to <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>."},{"pos":[4993,5257],"content":"Apply the <ph id=\"ph1\">&lt;xref:System.ServiceModel.MessageBodyMemberAttribute&gt;</ph> to any field that will be expressed as part of the message body, and set the <ph id=\"ph2\">`ProtectionLevel`</ph> property to <ph id=\"ph3\">&lt;xref:System.Net.Security.ProtectionLevel.EncryptAndSign&gt;</ph>, as shown in the following example.","source":"Apply the <xref:System.ServiceModel.MessageBodyMemberAttribute> to any field that will be expressed as part of the message body, and set the `ProtectionLevel` property to <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>, as shown in the following example."},{"pos":[5268,5511],"content":"[!code-csharp[C_ProtectionLevel#5](../../../samples/snippets/csharp/VS_Snippets_CFX/c_protectionlevel/cs/source.cs#5)]\n [!code-vb[C_ProtectionLevel#5](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_protectionlevel/vb/source.vb#5)]","leadings":["","    "],"nodes":[]},{"pos":[5520,5527],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5531,5649],"content":"The following example sets the <ph id=\"ph1\">`ProtectionLevel`</ph> property of several attribute classes at various places in a service.","source":"The following example sets the `ProtectionLevel` property of several attribute classes at various places in a service."},{"pos":[5904,5922],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"The following code shows the namespaces required to compile the example code.","pos":[5926,6003]},{"pos":[6258,6266],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6542,6637],"content":"<bpt id=\"p1\">[</bpt>Understanding Protection Level<ept id=\"p1\">](../../../docs/framework/wcf/understanding-protection-level.md)</ept>","source":"[Understanding Protection Level](../../../docs/framework/wcf/understanding-protection-level.md)"}]}