{"content":"---\ntitle: \"CLR ETW Providers\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"ETW, CLR providers\"\n  - \"CLR ETW providers\"\nms.assetid: 0beafad4-b2c8-47f4-b342-83411d57a51f\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# CLR ETW Providers\nThe common language runtime (CLR) has two providers: the runtime provider and the rundown provider.  \n  \n The runtime provider raises events, depending on which keywords (categories of events) are enabled. For example, you can collect loader events by enabling the `LoaderKeyword` keyword.  \n  \n Event tracking for Windows (ETW) events are logged into a file that has an .etl extension, which can later be post-processed in comma-separated value (.csv) files as needed. For information about how to convert the .etl file to a .csv file, see [Controlling .NET Framework Logging](../../../docs/framework/performance/controlling-logging.md).  \n  \n## The Runtime Provider  \n The runtime provider is the main CLR ETW provider.  \n  \n The CLR runtime provider GUID is e13c0d23-ccbc-4e12-931b-d9cc2eee27e4.  \n  \n For examples of how to log and view CLR ETW events by using commonly available tools, see [Controlling .NET Framework Logging](../../../docs/framework/performance/controlling-logging.md).  \n  \n In addition to using keywords such as `LoaderKeyword`, you may have to enable keywords for logging events that may be raised too frequently. The `StartEnumerationKeyword` and the `EndEnumerationKeyword` keywords enable these events and are summarized in [CLR ETW Keywords and Levels](../../../docs/framework/performance/clr-etw-keywords-and-levels.md).  \n  \n## The Rundown Provider  \n The rundown provider must be turned on for certain special-purpose uses. However, for a majority of users, the runtime provider should suffice.  \n  \n The CLR rundown provider GUID is A669021C-C450-4609-A035-5AF59AF4DF18.  \n  \n Normally, ETW logging is enabled before a process launches, and the logging is turned off after the process exits. However, if ETW logging is turned on while the process is executing, additional information is needed about the process. For example, for symbol resolution you have to log method events for methods that were already loaded before logging was turned on.  \n  \n The `DCStart` and `DCEnd` events capture the state of the process when data collection was started and stopped. (State refers to information at a high level, including the methods that were already just-in-time (JIT) compiled and assemblies that were loaded.) These two events can provide information about what has already happened in the process; for example, which methods were JIT- compiled, and so on.  \n  \n Only the events with `DC`, `DCStart`, `DCEnd`, or `DCInit` in their names are raised under the rundown provider. Additionally, these events are raised only under the rundown provider.  \n  \n In addition to the event keyword filters, the rundown provider also supports the `StartRundownKeyword` and `EndRundownKeyword` keywords to provide targeted filtering.  \n  \n### Start Rundown  \n A start rundown is triggered when logging under the rundown provider is enabled with the `StartRundownKeyword` keyword. This causes the `DCStart` event to be raised, and captures the state of the system. Before the start of the enumeration, the `DCStartInit` event is raised. At the end of the enumeration, the `DCStartComplete` event is raised to notify the controller that data collection terminated normally.  \n  \n### End Rundown  \n An end rundown is triggered when logging under the rundown provider is enabled with the `EndRundownKeyword` keyword. End rundown stops profiling on a process that continues to execute. The `DCEnd` events capture the state of the system when profiling is stopped.  \n  \n Before the start of the enumeration, the `DCEndInit` event is raised. At the end of the enumeration, the `DCEndComplete` event is raised to notify the consumer that data collection terminated normally. Start rundown and end rundown are primarily used for managed symbol resolution. Start rundown can provide address range information for methods that were already JIT-compiled before the profiling session was started. End rundown can provide address range information for all methods that have been JIT-compiled when profiling is about to be turned off.  \n  \n End rundown does not happen automatically when a profiling session is stopped. Instead, a tool that is seeking to perform managed symbol resolution has to explicitly invoke a CLR rundown provider session with the `EndRundownKeyword` keyword enabled, just before profiling is stopped.  \n  \n Although either start rundown or end rundown can provide method address range information for managed symbol resolution, we recommend that you use the `EndRundownKeyword` keyword (which supplies `DCEnd` events) instead of the `StartRundownKeyword` keyword (which supplies `DCStart` events). Using `StartRundownKeyword` causes the rundown to happen during the profiling session, which may disturb the profiled scenario.  \n  \n## ETW Data Collection Using Runtime and Rundown Providers  \n The following example demonstrates how to use the CLR rundown provider in a way that allows symbol resolution of managed processes with minimal impact, regardless of whether the processes start or end inside or outside the profiled window.  \n  \n1.  Turn on ETW logging by using the CLR runtime provider:  \n  \n    ```  \n    xperf -start clr -on e13c0d23-ccbc-4e12-931b-d9cc2eee27e4:0x1CCBD:0x5 -f clr1.etl      \n    ```  \n  \n     The log will be saved to the clr1.etl file.  \n  \n2.  To stop profiling while the process continues to execute, start the rundown provider to capture the `DCEnd` events:  \n  \n    ```  \n    xperf -start clrRundown -on A669021C-C450-4609-A035-5AF59AF4DF18:0xB8:0x5 -f clr2.etl      \n    ```  \n  \n     This enables the collection of `DCEnd` events to start a rundown session. You may need to wait 30 to 60 seconds for all events to be collected. The log will be saved to the clr1.et2 file.  \n  \n3.  Turn off all ETW profiling:  \n  \n    ```  \n    xperf -stop clrRundown   \n    xperf -stop clr  \n    ```  \n  \n4.  Merge the profiles to create one log file:  \n  \n    ```  \n    xperf -merge clr1.etl clr2.etl merged.etl  \n    ```  \n  \n     The merged.etl file will contain the events from the runtime and the rundown provider sessions.  \n  \n A tool can execute steps 2 and 3 (starting a rundown session and then terminating profiling) instead of immediately turning off profiling when a user requests profiling to be stopped. A tool can also execute step 4.  \n  \n## See also\n\n- [ETW Events in the Common Language Runtime](../../../docs/framework/performance/etw-events-in-the-common-language-runtime.md)\n","nodes":[{"pos":[4,209],"embed":true,"restype":"x-metadata","content":"title: \"CLR ETW Providers\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"ETW, CLR providers\"\n  - \"CLR ETW providers\"\nms.assetid: 0beafad4-b2c8-47f4-b342-83411d57a51f\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"CLR ETW Providers","nodes":[{"pos":[0,17],"content":"CLR ETW Providers","nodes":[{"content":"CLR ETW Providers","pos":[0,17]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[216,233],"content":"CLR ETW Providers","linkify":"CLR ETW Providers","nodes":[{"content":"CLR ETW Providers","pos":[0,17]}]},{"content":"The common language runtime (CLR) has two providers: the runtime provider and the rundown provider.","pos":[234,333]},{"content":"The runtime provider raises events, depending on which keywords (categories of events) are enabled.","pos":[340,439]},{"content":"For example, you can collect loader events by enabling the <ph id=\"ph1\">`LoaderKeyword`</ph> keyword.","pos":[440,523],"source":" For example, you can collect loader events by enabling the `LoaderKeyword` keyword."},{"content":"Event tracking for Windows (ETW) events are logged into a file that has an .etl extension, which can later be post-processed in comma-separated value (.csv) files as needed.","pos":[530,703]},{"content":"For information about how to convert the .etl file to a .csv file, see <bpt id=\"p1\">[</bpt>Controlling .NET Framework Logging<ept id=\"p1\">](../../../docs/framework/performance/controlling-logging.md)</ept>.","pos":[704,872],"source":" For information about how to convert the .etl file to a .csv file, see [Controlling .NET Framework Logging](../../../docs/framework/performance/controlling-logging.md)."},{"pos":[881,901],"content":"The Runtime Provider","linkify":"The Runtime Provider","nodes":[{"content":"The Runtime Provider","pos":[0,20]}]},{"content":"The runtime provider is the main CLR ETW provider.","pos":[905,955]},{"content":"The CLR runtime provider GUID is e13c0d23-ccbc-4e12-931b-d9cc2eee27e4.","pos":[962,1032]},{"pos":[1039,1226],"content":"For examples of how to log and view CLR ETW events by using commonly available tools, see <bpt id=\"p1\">[</bpt>Controlling .NET Framework Logging<ept id=\"p1\">](../../../docs/framework/performance/controlling-logging.md)</ept>.","source":"For examples of how to log and view CLR ETW events by using commonly available tools, see [Controlling .NET Framework Logging](../../../docs/framework/performance/controlling-logging.md)."},{"content":"In addition to using keywords such as <ph id=\"ph1\">`LoaderKeyword`</ph>, you may have to enable keywords for logging events that may be raised too frequently.","pos":[1233,1373],"source":"In addition to using keywords such as `LoaderKeyword`, you may have to enable keywords for logging events that may be raised too frequently."},{"content":"The <ph id=\"ph1\">`StartEnumerationKeyword`</ph> and the <ph id=\"ph2\">`EndEnumerationKeyword`</ph> keywords enable these events and are summarized in <bpt id=\"p1\">[</bpt>CLR ETW Keywords and Levels<ept id=\"p1\">](../../../docs/framework/performance/clr-etw-keywords-and-levels.md)</ept>.","pos":[1374,1585],"source":" The `StartEnumerationKeyword` and the `EndEnumerationKeyword` keywords enable these events and are summarized in [CLR ETW Keywords and Levels](../../../docs/framework/performance/clr-etw-keywords-and-levels.md)."},{"pos":[1594,1614],"content":"The Rundown Provider","linkify":"The Rundown Provider","nodes":[{"content":"The Rundown Provider","pos":[0,20]}]},{"content":"The rundown provider must be turned on for certain special-purpose uses.","pos":[1618,1690]},{"content":"However, for a majority of users, the runtime provider should suffice.","pos":[1691,1761]},{"content":"The CLR rundown provider GUID is A669021C-C450-4609-A035-5AF59AF4DF18.","pos":[1768,1838]},{"content":"Normally, ETW logging is enabled before a process launches, and the logging is turned off after the process exits.","pos":[1845,1959]},{"content":"However, if ETW logging is turned on while the process is executing, additional information is needed about the process.","pos":[1960,2080]},{"content":"For example, for symbol resolution you have to log method events for methods that were already loaded before logging was turned on.","pos":[2081,2212]},{"content":"The <ph id=\"ph1\">`DCStart`</ph> and <ph id=\"ph2\">`DCEnd`</ph> events capture the state of the process when data collection was started and stopped.","pos":[2219,2330],"source":"The `DCStart` and `DCEnd` events capture the state of the process when data collection was started and stopped."},{"content":"(State refers to information at a high level, including the methods that were already just-in-time (JIT) compiled and assemblies that were loaded.) These two events can provide information about what has already happened in the process; for example, which methods were JIT- compiled, and so on.","pos":[2331,2625]},{"content":"Only the events with <ph id=\"ph1\">`DC`</ph>, <ph id=\"ph2\">`DCStart`</ph>, <ph id=\"ph3\">`DCEnd`</ph>, or <ph id=\"ph4\">`DCInit`</ph> in their names are raised under the rundown provider.","pos":[2632,2744],"source":"Only the events with `DC`, `DCStart`, `DCEnd`, or `DCInit` in their names are raised under the rundown provider."},{"content":"Additionally, these events are raised only under the rundown provider.","pos":[2745,2815]},{"pos":[2822,2988],"content":"In addition to the event keyword filters, the rundown provider also supports the <ph id=\"ph1\">`StartRundownKeyword`</ph> and <ph id=\"ph2\">`EndRundownKeyword`</ph> keywords to provide targeted filtering.","source":"In addition to the event keyword filters, the rundown provider also supports the `StartRundownKeyword` and `EndRundownKeyword` keywords to provide targeted filtering."},{"pos":[2998,3011],"content":"Start Rundown","linkify":"Start Rundown","nodes":[{"content":"Start Rundown","pos":[0,13]}]},{"content":"A start rundown is triggered when logging under the rundown provider is enabled with the <ph id=\"ph1\">`StartRundownKeyword`</ph> keyword.","pos":[3015,3134],"source":"A start rundown is triggered when logging under the rundown provider is enabled with the `StartRundownKeyword` keyword."},{"content":"This causes the <ph id=\"ph1\">`DCStart`</ph> event to be raised, and captures the state of the system.","pos":[3135,3218],"source":" This causes the `DCStart` event to be raised, and captures the state of the system."},{"content":"Before the start of the enumeration, the <ph id=\"ph1\">`DCStartInit`</ph> event is raised.","pos":[3219,3290],"source":" Before the start of the enumeration, the `DCStartInit` event is raised."},{"content":"At the end of the enumeration, the <ph id=\"ph1\">`DCStartComplete`</ph> event is raised to notify the controller that data collection terminated normally.","pos":[3291,3426],"source":" At the end of the enumeration, the `DCStartComplete` event is raised to notify the controller that data collection terminated normally."},{"pos":[3436,3447],"content":"End Rundown","linkify":"End Rundown","nodes":[{"content":"End Rundown","pos":[0,11]}]},{"content":"An end rundown is triggered when logging under the rundown provider is enabled with the <ph id=\"ph1\">`EndRundownKeyword`</ph> keyword.","pos":[3451,3567],"source":"An end rundown is triggered when logging under the rundown provider is enabled with the `EndRundownKeyword` keyword."},{"content":"End rundown stops profiling on a process that continues to execute.","pos":[3568,3635]},{"content":"The <ph id=\"ph1\">`DCEnd`</ph> events capture the state of the system when profiling is stopped.","pos":[3636,3713],"source":" The `DCEnd` events capture the state of the system when profiling is stopped."},{"content":"Before the start of the enumeration, the <ph id=\"ph1\">`DCEndInit`</ph> event is raised.","pos":[3720,3789],"source":"Before the start of the enumeration, the `DCEndInit` event is raised."},{"content":"At the end of the enumeration, the <ph id=\"ph1\">`DCEndComplete`</ph> event is raised to notify the consumer that data collection terminated normally.","pos":[3790,3921],"source":" At the end of the enumeration, the `DCEndComplete` event is raised to notify the consumer that data collection terminated normally."},{"content":"Start rundown and end rundown are primarily used for managed symbol resolution.","pos":[3922,4001]},{"content":"Start rundown can provide address range information for methods that were already JIT-compiled before the profiling session was started.","pos":[4002,4138]},{"content":"End rundown can provide address range information for all methods that have been JIT-compiled when profiling is about to be turned off.","pos":[4139,4274]},{"content":"End rundown does not happen automatically when a profiling session is stopped.","pos":[4281,4359]},{"content":"Instead, a tool that is seeking to perform managed symbol resolution has to explicitly invoke a CLR rundown provider session with the <ph id=\"ph1\">`EndRundownKeyword`</ph> keyword enabled, just before profiling is stopped.","pos":[4360,4564],"source":" Instead, a tool that is seeking to perform managed symbol resolution has to explicitly invoke a CLR rundown provider session with the `EndRundownKeyword` keyword enabled, just before profiling is stopped."},{"content":"Although either start rundown or end rundown can provide method address range information for managed symbol resolution, we recommend that you use the <ph id=\"ph1\">`EndRundownKeyword`</ph> keyword (which supplies <ph id=\"ph2\">`DCEnd`</ph> events) instead of the <ph id=\"ph3\">`StartRundownKeyword`</ph> keyword (which supplies <ph id=\"ph4\">`DCStart`</ph> events).","pos":[4571,4861],"source":"Although either start rundown or end rundown can provide method address range information for managed symbol resolution, we recommend that you use the `EndRundownKeyword` keyword (which supplies `DCEnd` events) instead of the `StartRundownKeyword` keyword (which supplies `DCStart` events)."},{"content":"Using <ph id=\"ph1\">`StartRundownKeyword`</ph> causes the rundown to happen during the profiling session, which may disturb the profiled scenario.","pos":[4862,4989],"source":" Using `StartRundownKeyword` causes the rundown to happen during the profiling session, which may disturb the profiled scenario."},{"pos":[4998,5053],"content":"ETW Data Collection Using Runtime and Rundown Providers","linkify":"ETW Data Collection Using Runtime and Rundown Providers","nodes":[{"content":"ETW Data Collection Using Runtime and Rundown Providers","pos":[0,55]}]},{"content":"The following example demonstrates how to use the CLR rundown provider in a way that allows symbol resolution of managed processes with minimal impact, regardless of whether the processes start or end inside or outside the profiled window.","pos":[5057,5296]},{"content":"Turn on ETW logging by using the CLR runtime provider:","pos":[5306,5360]},{"content":"The log will be saved to the clr1.etl file.","pos":[5486,5529]},{"pos":[5539,5654],"content":"To stop profiling while the process continues to execute, start the rundown provider to capture the <ph id=\"ph1\">`DCEnd`</ph> events:","source":"To stop profiling while the process continues to execute, start the rundown provider to capture the `DCEnd` events:"},{"content":"This enables the collection of <ph id=\"ph1\">`DCEnd`</ph> events to start a rundown session.","pos":[5784,5857],"source":"This enables the collection of `DCEnd` events to start a rundown session."},{"content":"You may need to wait 30 to 60 seconds for all events to be collected.","pos":[5858,5927]},{"content":"The log will be saved to the clr1.et2 file.","pos":[5928,5971]},{"content":"Turn off all ETW profiling:","pos":[5981,6008]},{"content":"Merge the profiles to create one log file:","pos":[6093,6135]},{"content":"The merged.etl file will contain the events from the runtime and the rundown provider sessions.","pos":[6217,6312]},{"content":"A tool can execute steps 2 and 3 (starting a rundown session and then terminating profiling) instead of immediately turning off profiling when a user requests profiling to be stopped.","pos":[6319,6502]},{"content":"A tool can also execute step 4.","pos":[6503,6534]},{"pos":[6543,6551],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6555,6680],"content":"<bpt id=\"p1\">[</bpt>ETW Events in the Common Language Runtime<ept id=\"p1\">](../../../docs/framework/performance/etw-events-in-the-common-language-runtime.md)</ept>","source":"[ETW Events in the Common Language Runtime](../../../docs/framework/performance/etw-events-in-the-common-language-runtime.md)"}]}