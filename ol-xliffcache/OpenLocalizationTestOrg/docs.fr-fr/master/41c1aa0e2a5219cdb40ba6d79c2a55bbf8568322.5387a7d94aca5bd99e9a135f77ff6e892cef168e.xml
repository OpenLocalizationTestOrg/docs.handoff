{"content":"---\ntitle: \"Use Caching in UI Automation\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"caching, UI Automation\"\n  - \"UI Automation, caching\"\nms.assetid: ec722dff-6009-4279-b86a-e18d3fa94ebf\n---\n# Use Caching in UI Automation\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This section shows how to implement caching of <xref:System.Windows.Automation.AutomationElement> properties and control patterns.  \n  \n### Activate a Cache Request  \n  \n1.  Create a <xref:System.Windows.Automation.CacheRequest>.  \n  \n2.  Specify properties and patterns to cache by using <xref:System.Windows.Automation.CacheRequest.Add%2A>.  \n  \n3.  Specify the scope of caching by setting the <xref:System.Windows.Automation.CacheRequest.TreeScope%2A> property.  \n  \n4.  Specify the view of the subtree by setting the <xref:System.Windows.Automation.CacheRequest.TreeFilter%2A> property.  \n  \n5.  Set the <xref:System.Windows.Automation.CacheRequest.AutomationElementMode%2A> property to <xref:System.Windows.Automation.AutomationElementMode.None> if you wish to increase efficiency by not retrieving a full reference to objects. (This will make it impossible to retrieve current values from those objects.)  \n  \n6.  Activate the request by using <xref:System.Windows.Automation.CacheRequest.Activate%2A> within a `using` block (`Using` in Microsoft Visual Basic .NET).  \n  \n After obtaining <xref:System.Windows.Automation.AutomationElement> objects or subscribing to events, deactivate the request by using <xref:System.Windows.Automation.CacheRequest.Pop%2A> (if <xref:System.Windows.Automation.CacheRequest.Push%2A> was used) or by disposing the object created by <xref:System.Windows.Automation.CacheRequest.Activate%2A>. (Use <xref:System.Windows.Automation.CacheRequest.Activate%2A> in a `using` block (`Using` in Microsoft Visual Basic .NET).  \n  \n### Cache AutomationElement Properties  \n  \n1.  While a <xref:System.Windows.Automation.CacheRequest> is active, obtain <xref:System.Windows.Automation.AutomationElement> objects by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A>; or obtain an <xref:System.Windows.Automation.AutomationElement> as the source of an event that you registered for when the <xref:System.Windows.Automation.CacheRequest> was active. (You can also create a cache by passing a <xref:System.Windows.Automation.CacheRequest> to GetUpdatedCache or one of the <xref:System.Windows.Automation.TreeWalker> methods.)  \n  \n2.  Use <xref:System.Windows.Automation.AutomationElement.GetCachedPropertyValue%2A> or retrieve a property from the <xref:System.Windows.Automation.AutomationElement.Cached%2A> property of the <xref:System.Windows.Automation.AutomationElement>.  \n  \n### Obtain Cached Patterns and Their Properties  \n  \n1.  While a <xref:System.Windows.Automation.CacheRequest> is active, obtain <xref:System.Windows.Automation.AutomationElement> objects by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A>; or obtain an <xref:System.Windows.Automation.AutomationElement> as the source of an event that you registered for when the <xref:System.Windows.Automation.CacheRequest> was active. (You can also create a cache by passing a <xref:System.Windows.Automation.CacheRequest> to GetUpdatedCache or one of the <xref:System.Windows.Automation.TreeWalker> methods.)  \n  \n2.  Use <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> or <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> to retrieve a cached pattern.  \n  \n3.  Retrieve property values from the `Cached` property of the control pattern.  \n  \n## Example  \n The following code example shows various aspects of caching, using <xref:System.Windows.Automation.CacheRequest.Activate%2A> to activate the <xref:System.Windows.Automation.CacheRequest>.  \n  \n [!code-csharp[UIAClient_snip#107](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAClient_snip/CSharp/ClientForm.cs#107)]\n [!code-vb[UIAClient_snip#107](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAClient_snip/VisualBasic/ClientForm.vb#107)]  \n  \n## Example  \n The following code example shows various aspects of caching, using <xref:System.Windows.Automation.CacheRequest.Push%2A> to activate the <xref:System.Windows.Automation.CacheRequest>. Except when you wish to nest cache requests, it is preferable to use <xref:System.Windows.Automation.CacheRequest.Activate%2A>.  \n  \n [!code-csharp[UIAClient_snip#108](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAClient_snip/CSharp/ClientForm.cs#108)]\n [!code-vb[UIAClient_snip#108](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAClient_snip/VisualBasic/ClientForm.vb#108)]  \n  \n## See also\n\n- [Caching in UI Automation Clients](../../../docs/framework/ui-automation/caching-in-ui-automation-clients.md)\n","nodes":[{"pos":[4,226],"embed":true,"restype":"x-metadata","content":"title: \"Use Caching in UI Automation\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"caching, UI Automation\"\n  - \"UI Automation, caching\"\nms.assetid: ec722dff-6009-4279-b86a-e18d3fa94ebf","nodes":[{"content":"Use Caching in UI Automation","nodes":[{"pos":[0,28],"content":"Use Caching in UI Automation","nodes":[{"content":"Use Caching in UI Automation","pos":[0,28]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[233,261],"content":"Use Caching in UI Automation","linkify":"Use Caching in UI Automation","nodes":[{"content":"Use Caching in UI Automation","pos":[0,28]}]},{"pos":[264,727],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,461],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"pos":[734,864],"content":"This section shows how to implement caching of <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> properties and control patterns.","source":"This section shows how to implement caching of <xref:System.Windows.Automation.AutomationElement> properties and control patterns."},{"pos":[874,898],"content":"Activate a Cache Request","linkify":"Activate a Cache Request","nodes":[{"content":"Activate a Cache Request","pos":[0,24]}]},{"pos":[908,963],"content":"Create a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph>.","source":"Create a <xref:System.Windows.Automation.CacheRequest>."},{"pos":[973,1076],"content":"Specify properties and patterns to cache by using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.Add%2A&gt;</ph>.","source":"Specify properties and patterns to cache by using <xref:System.Windows.Automation.CacheRequest.Add%2A>."},{"pos":[1086,1198],"content":"Specify the scope of caching by setting the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.TreeScope%2A&gt;</ph> property.","source":"Specify the scope of caching by setting the <xref:System.Windows.Automation.CacheRequest.TreeScope%2A> property."},{"pos":[1208,1324],"content":"Specify the view of the subtree by setting the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.TreeFilter%2A&gt;</ph> property.","source":"Specify the view of the subtree by setting the <xref:System.Windows.Automation.CacheRequest.TreeFilter%2A> property."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.AutomationElementMode%2A&gt;</ph> property to <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElementMode.None&gt;</ph> if you wish to increase efficiency by not retrieving a full reference to objects.","pos":[1334,1566],"source":"Set the <xref:System.Windows.Automation.CacheRequest.AutomationElementMode%2A> property to <xref:System.Windows.Automation.AutomationElementMode.None> if you wish to increase efficiency by not retrieving a full reference to objects."},{"content":"(This will make it impossible to retrieve current values from those objects.)","pos":[1567,1644]},{"pos":[1654,1806],"content":"Activate the request by using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.Activate%2A&gt;</ph> within a <ph id=\"ph2\">`using`</ph> block (<ph id=\"ph3\">`Using`</ph> in Microsoft Visual Basic .NET).","source":"Activate the request by using <xref:System.Windows.Automation.CacheRequest.Activate%2A> within a `using` block (`Using` in Microsoft Visual Basic .NET)."},{"content":"After obtaining <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> objects or subscribing to events, deactivate the request by using <ph id=\"ph2\">&lt;xref:System.Windows.Automation.CacheRequest.Pop%2A&gt;</ph> (if <ph id=\"ph3\">&lt;xref:System.Windows.Automation.CacheRequest.Push%2A&gt;</ph> was used) or by disposing the object created by <ph id=\"ph4\">&lt;xref:System.Windows.Automation.CacheRequest.Activate%2A&gt;</ph>.","pos":[1813,2163],"source":"After obtaining <xref:System.Windows.Automation.AutomationElement> objects or subscribing to events, deactivate the request by using <xref:System.Windows.Automation.CacheRequest.Pop%2A> (if <xref:System.Windows.Automation.CacheRequest.Push%2A> was used) or by disposing the object created by <xref:System.Windows.Automation.CacheRequest.Activate%2A>."},{"content":"(Use <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.Activate%2A&gt;</ph> in a <ph id=\"ph2\">`using`</ph> block (<ph id=\"ph3\">`Using`</ph> in Microsoft Visual Basic .NET).","pos":[2164,2287],"source":" (Use <xref:System.Windows.Automation.CacheRequest.Activate%2A> in a `using` block (`Using` in Microsoft Visual Basic .NET)."},{"pos":[2297,2331],"content":"Cache AutomationElement Properties","linkify":"Cache AutomationElement Properties","nodes":[{"content":"Cache AutomationElement Properties","pos":[0,34]}]},{"content":"While a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph> is active, obtain <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> objects by using <ph id=\"ph3\">&lt;xref:System.Windows.Automation.AutomationElement.FindFirst%2A&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Windows.Automation.AutomationElement.FindAll%2A&gt;</ph>; or obtain an <ph id=\"ph5\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> as the source of an event that you registered for when the <ph id=\"ph6\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph> was active.","pos":[2341,2791],"source":"While a <xref:System.Windows.Automation.CacheRequest> is active, obtain <xref:System.Windows.Automation.AutomationElement> objects by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A>; or obtain an <xref:System.Windows.Automation.AutomationElement> as the source of an event that you registered for when the <xref:System.Windows.Automation.CacheRequest> was active."},{"content":"(You can also create a cache by passing a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph> to GetUpdatedCache or one of the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TreeWalker&gt;</ph> methods.)","pos":[2792,2966],"source":" (You can also create a cache by passing a <xref:System.Windows.Automation.CacheRequest> to GetUpdatedCache or one of the <xref:System.Windows.Automation.TreeWalker> methods.)"},{"pos":[2976,3217],"content":"Use <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.GetCachedPropertyValue%2A&gt;</ph> or retrieve a property from the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.Cached%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph>.","source":"Use <xref:System.Windows.Automation.AutomationElement.GetCachedPropertyValue%2A> or retrieve a property from the <xref:System.Windows.Automation.AutomationElement.Cached%2A> property of the <xref:System.Windows.Automation.AutomationElement>."},{"pos":[3227,3270],"content":"Obtain Cached Patterns and Their Properties","linkify":"Obtain Cached Patterns and Their Properties","nodes":[{"content":"Obtain Cached Patterns and Their Properties","pos":[0,43]}]},{"content":"While a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph> is active, obtain <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> objects by using <ph id=\"ph3\">&lt;xref:System.Windows.Automation.AutomationElement.FindFirst%2A&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Windows.Automation.AutomationElement.FindAll%2A&gt;</ph>; or obtain an <ph id=\"ph5\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> as the source of an event that you registered for when the <ph id=\"ph6\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph> was active.","pos":[3280,3730],"source":"While a <xref:System.Windows.Automation.CacheRequest> is active, obtain <xref:System.Windows.Automation.AutomationElement> objects by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A>; or obtain an <xref:System.Windows.Automation.AutomationElement> as the source of an event that you registered for when the <xref:System.Windows.Automation.CacheRequest> was active."},{"content":"(You can also create a cache by passing a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph> to GetUpdatedCache or one of the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TreeWalker&gt;</ph> methods.)","pos":[3731,3905],"source":" (You can also create a cache by passing a <xref:System.Windows.Automation.CacheRequest> to GetUpdatedCache or one of the <xref:System.Windows.Automation.TreeWalker> methods.)"},{"pos":[3915,4096],"content":"Use <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A&gt;</ph> to retrieve a cached pattern.","source":"Use <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> or <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> to retrieve a cached pattern."},{"pos":[4106,4181],"content":"Retrieve property values from the <ph id=\"ph1\">`Cached`</ph> property of the control pattern.","source":"Retrieve property values from the `Cached` property of the control pattern."},{"pos":[4190,4197],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4201,4388],"content":"The following code example shows various aspects of caching, using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.Activate%2A&gt;</ph> to activate the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph>.","source":"The following code example shows various aspects of caching, using <xref:System.Windows.Automation.CacheRequest.Activate%2A> to activate the <xref:System.Windows.Automation.CacheRequest>."},{"pos":[4660,4667],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example shows various aspects of caching, using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.Push%2A&gt;</ph> to activate the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph>.","pos":[4671,4854],"source":"The following code example shows various aspects of caching, using <xref:System.Windows.Automation.CacheRequest.Push%2A> to activate the <xref:System.Windows.Automation.CacheRequest>."},{"content":"Except when you wish to nest cache requests, it is preferable to use <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.Activate%2A&gt;</ph>.","pos":[4855,4982],"source":" Except when you wish to nest cache requests, it is preferable to use <xref:System.Windows.Automation.CacheRequest.Activate%2A>."},{"pos":[5254,5262],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5266,5375],"content":"<bpt id=\"p1\">[</bpt>Caching in UI Automation Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/caching-in-ui-automation-clients.md)</ept>","source":"[Caching in UI Automation Clients](../../../docs/framework/ui-automation/caching-in-ui-automation-clients.md)"}]}