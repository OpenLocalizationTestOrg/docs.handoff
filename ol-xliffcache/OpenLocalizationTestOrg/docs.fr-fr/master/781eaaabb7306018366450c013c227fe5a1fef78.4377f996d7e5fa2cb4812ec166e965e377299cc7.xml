{"content":"---\ntitle: \"Walkthrough: Assigning WPF Content on Windows Forms at Design Time\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords:\n  - \"WPF content [Windows Forms], assigning at design time\"\n  - \"ElementHost control [Windows Forms], assigning WPF content at design time\"\n  - \"interoperability [WPF]\"\n  - \"Windows Forms, content assignments\"\n  - \"WPF user control [Windows Forms], hosting in Windows Forms\"\nms.assetid: b3e9ef93-7e0f-4a2f-8f1e-3437609a1eb7\n---\n# Walkthrough: Assigning WPF Content on Windows Forms at Design Time\nThis walkthrough show you how to select the Windows Presentation Foundation (WPF) control types you want to display on your form. You can select any WPF control types which are included in your project.\n\n In this walkthrough, you perform the following tasks:\n\n-   Create the project.\n\n-   Create the WPF control types.\n\n-   Select WPF controls.\n\n> [!NOTE]\n>  The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).  \n  \n## Prerequisites  \n You need the following components to complete this walkthrough:  \n  \n-   Visual Studio 2012.  \n  \n## Creating the Project  \n The first step is to create the Windows Forms project.  \n  \n> [!NOTE]\n>  When hosting WPF content, only C# and Visual Basic projects are supported.  \n  \n#### To create the project  \n  \n-   Create a new Windows Forms Application project in Visual Basic or Visual C# named `SelectingWpfContent`.  \n  \n## Creating the WPF Control Types  \n After you add WPF control types to the project, you can host them in different <xref:System.Windows.Forms.Integration.ElementHost> controls.  \n  \n#### To create WPF control types  \n  \n1.  Add a new WPF <xref:System.Windows.Controls.UserControl> project to the solution. Use the default name for the control type, `UserControl1.xaml`. For more information, see [Walkthrough: Creating New WPF Content on Windows Forms at Design Time](walkthrough-creating-new-wpf-content-on-windows-forms-at-design-time.md).  \n  \n2.  In Design view, make sure that `UserControl1` is selected. For more information, see [How to: Select and Move Elements on the Design Surface](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/bb514527(v=vs.100)).  \n  \n3.  In the **Properties** window, set the value of the <xref:System.Windows.FrameworkElement.Width%2A> and <xref:System.Windows.FrameworkElement.Height%2A> properties to `200`.  \n  \n4.  Add a <xref:System.Windows.Controls.TextBox?displayProperty=nameWithType> control to the <xref:System.Windows.Controls.UserControl> and set the value of the <xref:System.Windows.Controls.TextBox.Text%2A> property to **Hosted Content**.  \n  \n5.  Add a second WPF <xref:System.Windows.Controls.UserControl> to the project. Use the default name for the control type, `UserControl2.xaml`.  \n  \n6.  In the **Properties** window, set the value of the <xref:System.Windows.FrameworkElement.Width%2A> and <xref:System.Windows.FrameworkElement.Height%2A> properties to `200`.  \n  \n7.  Add a <xref:System.Windows.Controls.TextBox?displayProperty=nameWithType> control to the <xref:System.Windows.Controls.UserControl> and set the value of the <xref:System.Windows.Controls.TextBox.Text%2A> property to **Hosted Content 2**.  \n  \n **Note** In general, you should host more sophisticated WPF content. The <xref:System.Windows.Controls.TextBox?displayProperty=nameWithType> control is used here for illustrative purposes only.  \n  \n1.  Build the project.  \n  \n## Selecting WPF Controls  \n You can assign different WPF content to an <xref:System.Windows.Forms.Integration.ElementHost> control, which is already hosting content.  \n  \n#### To select WPF controls  \n  \n1.  Open `Form1` in the Windows Forms Designer.  \n  \n2.  In the **Toolbox**, double-click `UserControl1` to create an instance of `UserControl1` on the form.  \n  \n     An instance of `UserControl1` is hosted in a new <xref:System.Windows.Forms.Integration.ElementHost> control named `elementHost1`.  \n  \n3.  In the smart tag panel for `elementHost1`, open the **Select Hosted Content** drop-down list.  \n  \n4.  Select **UserControl2** from the drop-down list box.  \n  \n     The `elementHost1` control now hosts an instance of the `UserControl2` type.  \n  \n5.  In the **Properties** window, confirm that the <xref:System.Windows.Forms.Integration.ElementHost.Child%2A> property is set to **UserControl2**.  \n  \n6.  From the **Toolbox**, in the **WPF Interoperability** group, drag an <xref:System.Windows.Forms.Integration.ElementHost> control onto the form.  \n  \n     The default name for the new control is `elementHost2`.  \n  \n7.  In the smart tag panel for `elementHost2`, open the **Select Hosted Content** drop-down list.  \n  \n8.  Select **UserControl1** from the drop-down list.  \n  \n9. The `elementHost2` control now hosts an instance of the `UserControl1` type.  \n  \n## See also\n\n- <xref:System.Windows.Forms.Integration.ElementHost>\n- <xref:System.Windows.Forms.Integration.WindowsFormsHost>\n- [Migration and Interoperability](../../wpf/advanced/migration-and-interoperability.md)\n- [Using WPF Controls](using-wpf-controls.md)\n- [Design XAML in Visual Studio](/visualstudio/designers/designing-xaml-in-visual-studio)\n","nodes":[{"pos":[4,446],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Assigning WPF Content on Windows Forms at Design Time\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords:\n  - \"WPF content [Windows Forms], assigning at design time\"\n  - \"ElementHost control [Windows Forms], assigning WPF content at design time\"\n  - \"interoperability [WPF]\"\n  - \"Windows Forms, content assignments\"\n  - \"WPF user control [Windows Forms], hosting in Windows Forms\"\nms.assetid: b3e9ef93-7e0f-4a2f-8f1e-3437609a1eb7","nodes":[{"content":"Walkthrough: Assigning WPF Content on Windows Forms at Design Time","nodes":[{"pos":[0,66],"content":"Walkthrough: Assigning WPF Content on Windows Forms at Design Time","nodes":[{"content":"Walkthrough: Assigning WPF Content on Windows Forms at Design Time","pos":[0,66]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[453,519],"content":"Walkthrough: Assigning WPF Content on Windows Forms at Design Time","linkify":"Walkthrough: Assigning WPF Content on Windows Forms at Design Time","nodes":[{"content":"Walkthrough: Assigning WPF Content on Windows Forms at Design Time","pos":[0,66]}]},{"content":"This walkthrough show you how to select the Windows Presentation Foundation (WPF) control types you want to display on your form.","pos":[520,649]},{"content":"You can select any WPF control types which are included in your project.","pos":[650,722]},{"content":"In this walkthrough, you perform the following tasks:","pos":[725,778]},{"content":"Create the project.","pos":[784,803]},{"content":"Create the WPF control types.","pos":[809,838]},{"content":"Select WPF controls.","pos":[844,864]},{"pos":[868,1213],"content":"[!NOTE]\n The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).","leadings":["","> "],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).","pos":[9,343],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition.","pos":[0,130]},{"content":"To change your settings, choose <bpt id=\"p1\">**</bpt>Import and Export Settings<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Tools<ept id=\"p2\">**</ept> menu.","pos":[131,216],"source":" To change your settings, choose **Import and Export Settings** on the **Tools** menu."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Personalize the Visual Studio IDE<ept id=\"p1\">](/visualstudio/ide/personalizing-the-visual-studio-ide)</ept>.","pos":[217,334],"source":" For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide)."}]}]},{"pos":[1222,1235],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to complete this walkthrough:","pos":[1239,1302]},{"content":"Visual Studio 2012.","pos":[1312,1331]},{"pos":[1340,1360],"content":"Creating the Project","linkify":"Creating the Project","nodes":[{"content":"Creating the Project","pos":[0,20]}]},{"content":"The first step is to create the Windows Forms project.","pos":[1364,1418]},{"pos":[1426,1511],"content":"[!NOTE]\n When hosting WPF content, only C# and Visual Basic projects are supported.","leadings":["","> "],"nodes":[{"content":"When hosting WPF content, only C# and Visual Basic projects are supported.","pos":[9,83]}]},{"pos":[1522,1543],"content":"To create the project","linkify":"To create the project","nodes":[{"content":"To create the project","pos":[0,21]}]},{"pos":[1553,1657],"content":"Create a new Windows Forms Application project in Visual Basic or Visual C# named <ph id=\"ph1\">`SelectingWpfContent`</ph>.","source":"Create a new Windows Forms Application project in Visual Basic or Visual C# named `SelectingWpfContent`."},{"pos":[1666,1696],"content":"Creating the WPF Control Types","linkify":"Creating the WPF Control Types","nodes":[{"content":"Creating the WPF Control Types","pos":[0,30]}]},{"pos":[1700,1840],"content":"After you add WPF control types to the project, you can host them in different <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> controls.","source":"After you add WPF control types to the project, you can host them in different <xref:System.Windows.Forms.Integration.ElementHost> controls."},{"pos":[1851,1878],"content":"To create WPF control types","linkify":"To create WPF control types","nodes":[{"content":"To create WPF control types","pos":[0,27]}]},{"content":"Add a new WPF <ph id=\"ph1\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> project to the solution.","pos":[1888,1969],"source":"Add a new WPF <xref:System.Windows.Controls.UserControl> project to the solution."},{"content":"Use the default name for the control type, <ph id=\"ph1\">`UserControl1.xaml`</ph>.","pos":[1970,2033],"source":" Use the default name for the control type, `UserControl1.xaml`."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Creating New WPF Content on Windows Forms at Design Time<ept id=\"p1\">](walkthrough-creating-new-wpf-content-on-windows-forms-at-design-time.md)</ept>.","pos":[2034,2205],"source":" For more information, see [Walkthrough: Creating New WPF Content on Windows Forms at Design Time](walkthrough-creating-new-wpf-content-on-windows-forms-at-design-time.md)."},{"content":"In Design view, make sure that <ph id=\"ph1\">`UserControl1`</ph> is selected.","pos":[2215,2273],"source":"In Design view, make sure that `UserControl1` is selected."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Select and Move Elements on the Design Surface<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/bb514527(v=vs.100))</ept>.","pos":[2274,2454],"source":" For more information, see [How to: Select and Move Elements on the Design Surface](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/bb514527(v=vs.100))."},{"pos":[2464,2636],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set the value of the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Width%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement.Height%2A&gt;</ph> properties to <ph id=\"ph3\">`200`</ph>.","source":"In the **Properties** window, set the value of the <xref:System.Windows.FrameworkElement.Width%2A> and <xref:System.Windows.FrameworkElement.Height%2A> properties to `200`."},{"pos":[2646,2881],"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox?displayProperty=nameWithType&gt;</ph> control to the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> and set the value of the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.TextBox.Text%2A&gt;</ph> property to <bpt id=\"p1\">**</bpt>Hosted Content<ept id=\"p1\">**</ept>.","source":"Add a <xref:System.Windows.Controls.TextBox?displayProperty=nameWithType> control to the <xref:System.Windows.Controls.UserControl> and set the value of the <xref:System.Windows.Controls.TextBox.Text%2A> property to **Hosted Content**."},{"content":"Add a second WPF <ph id=\"ph1\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> to the project.","pos":[2891,2966],"source":"Add a second WPF <xref:System.Windows.Controls.UserControl> to the project."},{"content":"Use the default name for the control type, <ph id=\"ph1\">`UserControl2.xaml`</ph>.","pos":[2967,3030],"source":" Use the default name for the control type, `UserControl2.xaml`."},{"pos":[3040,3212],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set the value of the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Width%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement.Height%2A&gt;</ph> properties to <ph id=\"ph3\">`200`</ph>.","source":"In the **Properties** window, set the value of the <xref:System.Windows.FrameworkElement.Width%2A> and <xref:System.Windows.FrameworkElement.Height%2A> properties to `200`."},{"pos":[3222,3459],"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox?displayProperty=nameWithType&gt;</ph> control to the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> and set the value of the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.TextBox.Text%2A&gt;</ph> property to <bpt id=\"p1\">**</bpt>Hosted Content 2<ept id=\"p1\">**</ept>.","source":"Add a <xref:System.Windows.Controls.TextBox?displayProperty=nameWithType> control to the <xref:System.Windows.Controls.UserControl> and set the value of the <xref:System.Windows.Controls.TextBox.Text%2A> property to **Hosted Content 2**."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> In general, you should host more sophisticated WPF content.","pos":[3466,3534],"source":"**Note** In general, you should host more sophisticated WPF content."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox?displayProperty=nameWithType&gt;</ph> control is used here for illustrative purposes only.","pos":[3535,3659],"source":" The <xref:System.Windows.Controls.TextBox?displayProperty=nameWithType> control is used here for illustrative purposes only."},{"content":"Build the project.","pos":[3669,3687]},{"pos":[3696,3718],"content":"Selecting WPF Controls","linkify":"Selecting WPF Controls","nodes":[{"content":"Selecting WPF Controls","pos":[0,22]}]},{"pos":[3722,3859],"content":"You can assign different WPF content to an <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control, which is already hosting content.","source":"You can assign different WPF content to an <xref:System.Windows.Forms.Integration.ElementHost> control, which is already hosting content."},{"pos":[3870,3892],"content":"To select WPF controls","linkify":"To select WPF controls","nodes":[{"content":"To select WPF controls","pos":[0,22]}]},{"pos":[3902,3945],"content":"Open <ph id=\"ph1\">`Form1`</ph> in the Windows Forms Designer.","source":"Open `Form1` in the Windows Forms Designer."},{"pos":[3955,4055],"content":"In the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, double-click <ph id=\"ph1\">`UserControl1`</ph> to create an instance of <ph id=\"ph2\">`UserControl1`</ph> on the form.","source":"In the **Toolbox**, double-click `UserControl1` to create an instance of `UserControl1` on the form."},{"pos":[4066,4196],"content":"An instance of <ph id=\"ph1\">`UserControl1`</ph> is hosted in a new <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control named <ph id=\"ph3\">`elementHost1`</ph>.","source":"An instance of `UserControl1` is hosted in a new <xref:System.Windows.Forms.Integration.ElementHost> control named `elementHost1`."},{"pos":[4206,4299],"content":"In the smart tag panel for <ph id=\"ph1\">`elementHost1`</ph>, open the <bpt id=\"p1\">**</bpt>Select Hosted Content<ept id=\"p1\">**</ept> drop-down list.","source":"In the smart tag panel for `elementHost1`, open the **Select Hosted Content** drop-down list."},{"pos":[4309,4361],"content":"Select <bpt id=\"p1\">**</bpt>UserControl2<ept id=\"p1\">**</ept> from the drop-down list box.","source":"Select **UserControl2** from the drop-down list box."},{"pos":[4372,4448],"content":"The <ph id=\"ph1\">`elementHost1`</ph> control now hosts an instance of the <ph id=\"ph2\">`UserControl2`</ph> type.","source":"The `elementHost1` control now hosts an instance of the `UserControl2` type."},{"pos":[4458,4602],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, confirm that the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost.Child%2A&gt;</ph> property is set to <bpt id=\"p2\">**</bpt>UserControl2<ept id=\"p2\">**</ept>.","source":"In the **Properties** window, confirm that the <xref:System.Windows.Forms.Integration.ElementHost.Child%2A> property is set to **UserControl2**."},{"pos":[4612,4755],"content":"From the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, in the <bpt id=\"p2\">**</bpt>WPF Interoperability<ept id=\"p2\">**</ept> group, drag an <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control onto the form.","source":"From the **Toolbox**, in the **WPF Interoperability** group, drag an <xref:System.Windows.Forms.Integration.ElementHost> control onto the form."},{"pos":[4766,4821],"content":"The default name for the new control is <ph id=\"ph1\">`elementHost2`</ph>.","source":"The default name for the new control is `elementHost2`."},{"pos":[4831,4924],"content":"In the smart tag panel for <ph id=\"ph1\">`elementHost2`</ph>, open the <bpt id=\"p1\">**</bpt>Select Hosted Content<ept id=\"p1\">**</ept> drop-down list.","source":"In the smart tag panel for `elementHost2`, open the **Select Hosted Content** drop-down list."},{"pos":[4934,4982],"content":"Select <bpt id=\"p1\">**</bpt>UserControl1<ept id=\"p1\">**</ept> from the drop-down list.","source":"Select **UserControl1** from the drop-down list."},{"pos":[4991,5067],"content":"The <ph id=\"ph1\">`elementHost2`</ph> control now hosts an instance of the <ph id=\"ph2\">`UserControl1`</ph> type.","source":"The `elementHost2` control now hosts an instance of the `UserControl1` type."},{"pos":[5076,5084],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5201,5287],"content":"<bpt id=\"p1\">[</bpt>Migration and Interoperability<ept id=\"p1\">](../../wpf/advanced/migration-and-interoperability.md)</ept>","source":"[Migration and Interoperability](../../wpf/advanced/migration-and-interoperability.md)"},{"pos":[5290,5333],"content":"<bpt id=\"p1\">[</bpt>Using WPF Controls<ept id=\"p1\">](using-wpf-controls.md)</ept>","source":"[Using WPF Controls](using-wpf-controls.md)"},{"pos":[5336,5423],"content":"<bpt id=\"p1\">[</bpt>Design XAML in Visual Studio<ept id=\"p1\">](/visualstudio/designers/designing-xaml-in-visual-studio)</ept>","source":"[Design XAML in Visual Studio](/visualstudio/designers/designing-xaml-in-visual-studio)"}]}