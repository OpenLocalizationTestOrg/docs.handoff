{"content":"---\ntitle: \"How to: Create a Windows Forms application from the command line\"\nms.date: \"03/14/2018\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"Windows Forms, application development from command line\"\n  - \"Windows Forms, getting started\"\n  - \"Windows Forms, creating basic form\"\nms.assetid: 45ad3f8b-1c26-4c9f-91a9-3bb0759a47a4\nauthor: rpetrusha\nms.author: ronpet\n---\n# How to: Create a Windows Forms application from the command line\nThe following procedures describe the basic steps that you must complete to create and run a Windows Forms application from the command line. There is extensive support for these procedures in Visual Studio.  Also see [Walkthrough: Hosting a Windows Forms Control in WPF](../wpf/advanced/walkthrough-hosting-a-windows-forms-control-in-wpf.md).  \n  \n## Procedure  \n  \n#### To create the form  \n  \n1.  In an empty code file, type the following import or using statements:  \n  \n     [!code-csharp[System.Windows.Forms.BasicForm#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/CS/Form1.cs#2)]\n     [!code-vb[System.Windows.Forms.BasicForm#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/VB/Form1.vb#2)]  \n  \n2.  Declare a class named `Form1` that inherits from the Form class.  \n  \n     [!code-csharp[System.Windows.Forms.BasicForm#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/CS/Form1.cs#3)]\n     [!code-vb[System.Windows.Forms.BasicForm#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/VB/Form1.vb#3)]  \n  \n3.  Create a default constructor for `Form1`.  \n  \n     You will add more code to the constructor in a subsequent procedure.  \n  \n     [!code-csharp[System.Windows.Forms.BasicForm#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/CS/Form1.cs#4)]\n     [!code-vb[System.Windows.Forms.BasicForm#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/VB/Form1.vb#4)]  \n  \n4.  Add a `Main` method to the class.  \n  \n    1.  Apply the <xref:System.STAThreadAttribute> to the C# `Main` method to specify your Windows Forms application is a single-threaded apartment. (The attribute is not necessary in Visual Basic, since Windows forms applications developed with Visual Basic use a single-threaded apartment model by default.)  \n  \n    2.  Call <xref:System.Windows.Forms.Application.EnableVisualStyles%2A> to apply operating system styles to your application.  \n  \n    3.  Create an instance of the form and run it.  \n  \n     [!code-csharp[System.Windows.Forms.BasicForm#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/CS/Form1.cs#5)]\n     [!code-vb[System.Windows.Forms.BasicForm#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/VB/Form1.vb#5)]  \n  \n#### To compile and run the application  \n  \n1.  At the .NET Framework command prompt, navigate to the directory you created the `Form1` class.  \n  \n2.  Compile the form.  \n  \n    -   If you are using C#, type: `csc form1.cs`  \n  \n         `-or-`  \n  \n    -   If you are using Visual Basic, type: `vbc form1.vb`  \n  \n3.  At the command prompt, type: `Form1.exe`  \n  \n## Adding a Control and Handling an Event  \n The previous procedure steps demonstrated how to just create a basic Windows Form that compiles and runs. The next procedure will show you how to create and add a control to the form, and handle an event for the control. For more information about the controls you can add to Windows Forms, see [Windows Forms Controls](./controls/index.md).  \n  \n In addition to understanding how to create Windows Forms applications, you should understand event-based programming and how to handle user input. For more information, see [Creating Event Handlers in Windows Forms](creating-event-handlers-in-windows-forms.md), and [Handling User Input](./controls/handling-user-input.md)  \n  \n#### To declare a button control and handle its click event  \n  \n1.  Declare a button control named `button1`.  \n  \n2.  In the constructor, create the button and set its <xref:System.Windows.Forms.Control.Size%2A>, <xref:System.Windows.Forms.Control.Location%2A> and <xref:System.Windows.Forms.Control.Text%2A> properties.  \n  \n3.  Add the button to the form.  \n  \n     The following code example demonstrates how to declare the button control.  \n  \n     [!code-csharp[System.Windows.Forms.FormWithButton#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/CS/Form1.cs#2)]\n     [!code-vb[System.Windows.Forms.FormWithButton#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/VB/Form1.vb#2)]  \n  \n4.  Create a method to handle the <xref:System.Windows.Forms.Control.Click> event for the button.  \n  \n5.  In the click event handler, display a <xref:System.Windows.Forms.MessageBox> with the message, \"Hello World\".  \n  \n     The following code example demonstrates how to handle the button control's click event.  \n  \n     [!code-csharp[System.Windows.Forms.FormWithButton#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/CS/Form1.cs#3)]\n     [!code-vb[System.Windows.Forms.FormWithButton#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/VB/Form1.vb#3)]  \n  \n6.  Associate the <xref:System.Windows.Forms.Control.Click> event with the method you created.  \n  \n     The following code example demonstrates how to associate the event with the method.  \n  \n     [!code-csharp[System.Windows.Forms.FormWithButton#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/CS/Form1.cs#4)]\n     [!code-vb[System.Windows.Forms.FormWithButton#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/VB/Form1.vb#4)]  \n  \n7.  Compile and run the application as described in the previous procedure.  \n  \n## Example  \n Following code example is the complete example from the previous procedures.  \n  \n [!code-csharp[System.Windows.Forms.FormWithButton#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/CS/Form1.cs#1)]\n [!code-vb[System.Windows.Forms.FormWithButton#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/VB/Form1.vb#1)]  \n  \n## Compiling the Code  \n  \n-   To compile the code, follow the instructions in the proceeding procedure that describe how to compile and run the application.  \n  \n## See also\n\n- <xref:System.Windows.Forms.Form>\n- <xref:System.Windows.Forms.Control>\n- [Changing the Appearance of Windows Forms](changing-the-appearance-of-windows-forms.md)\n- [Enhancing Windows Forms Applications](./advanced/index.md)\n- [Getting Started with Windows Forms](getting-started-with-windows-forms.md)\n","nodes":[{"pos":[4,381],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create a Windows Forms application from the command line\"\nms.date: \"03/14/2018\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"Windows Forms, application development from command line\"\n  - \"Windows Forms, getting started\"\n  - \"Windows Forms, creating basic form\"\nms.assetid: 45ad3f8b-1c26-4c9f-91a9-3bb0759a47a4\nauthor: rpetrusha\nms.author: ronpet","nodes":[{"content":"How to: Create a Windows Forms application from the command line","nodes":[{"pos":[0,64],"content":"How to: Create a Windows Forms application from the command line","nodes":[{"content":"How to: Create a Windows Forms application from the command line","pos":[0,64]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[388,452],"content":"How to: Create a Windows Forms application from the command line","linkify":"How to: Create a Windows Forms application from the command line","nodes":[{"content":"How to: Create a Windows Forms application from the command line","pos":[0,64]}]},{"content":"The following procedures describe the basic steps that you must complete to create and run a Windows Forms application from the command line.","pos":[453,594]},{"content":"There is extensive support for these procedures in Visual Studio.","pos":[595,660]},{"content":"Also see <bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Control in WPF<ept id=\"p1\">](../wpf/advanced/walkthrough-hosting-a-windows-forms-control-in-wpf.md)</ept>.","pos":[662,796],"source":"  Also see [Walkthrough: Hosting a Windows Forms Control in WPF](../wpf/advanced/walkthrough-hosting-a-windows-forms-control-in-wpf.md)."},{"pos":[805,814],"content":"Procedure","linkify":"Procedure","nodes":[{"content":"Procedure","pos":[0,9]}]},{"pos":[825,843],"content":"To create the form","linkify":"To create the form","nodes":[{"content":"To create the form","pos":[0,18]}]},{"content":"In an empty code file, type the following import or using statements:","pos":[853,922]},{"pos":[933,1222],"content":"[!code-csharp[System.Windows.Forms.BasicForm#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/CS/Form1.cs#2)]\n [!code-vb[System.Windows.Forms.BasicForm#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/VB/Form1.vb#2)]","leadings":["","    "],"nodes":[]},{"pos":[1232,1296],"content":"Declare a class named <ph id=\"ph1\">`Form1`</ph> that inherits from the Form class.","source":"Declare a class named `Form1` that inherits from the Form class."},{"pos":[1307,1596],"content":"[!code-csharp[System.Windows.Forms.BasicForm#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/CS/Form1.cs#3)]\n [!code-vb[System.Windows.Forms.BasicForm#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/VB/Form1.vb#3)]","leadings":["","    "],"nodes":[]},{"pos":[1606,1647],"content":"Create a default constructor for <ph id=\"ph1\">`Form1`</ph>.","source":"Create a default constructor for `Form1`."},{"content":"You will add more code to the constructor in a subsequent procedure.","pos":[1658,1726]},{"pos":[1737,2026],"content":"[!code-csharp[System.Windows.Forms.BasicForm#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/CS/Form1.cs#4)]\n [!code-vb[System.Windows.Forms.BasicForm#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/VB/Form1.vb#4)]","leadings":["","    "],"nodes":[]},{"pos":[2036,2069],"content":"Add a <ph id=\"ph1\">`Main`</ph> method to the class.","source":"Add a `Main` method to the class."},{"content":"Apply the <ph id=\"ph1\">&lt;xref:System.STAThreadAttribute&gt;</ph> to the C# <ph id=\"ph2\">`Main`</ph> method to specify your Windows Forms application is a single-threaded apartment.","pos":[2083,2223],"source":"Apply the <xref:System.STAThreadAttribute> to the C# `Main` method to specify your Windows Forms application is a single-threaded apartment."},{"content":"(The attribute is not necessary in Visual Basic, since Windows forms applications developed with Visual Basic use a single-threaded apartment model by default.)","pos":[2224,2384]},{"pos":[2398,2518],"content":"Call <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Application.EnableVisualStyles%2A&gt;</ph> to apply operating system styles to your application.","source":"Call <xref:System.Windows.Forms.Application.EnableVisualStyles%2A> to apply operating system styles to your application."},{"content":"Create an instance of the form and run it.","pos":[2532,2574]},{"pos":[2585,2874],"content":"[!code-csharp[System.Windows.Forms.BasicForm#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/CS/Form1.cs#5)]\n[!code-vb[System.Windows.Forms.BasicForm#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.BasicForm/VB/Form1.vb#5)]","leadings":["","     "],"nodes":[]},{"pos":[2885,2919],"content":"To compile and run the application","linkify":"To compile and run the application","nodes":[{"content":"To compile and run the application","pos":[0,34]}]},{"pos":[2929,3023],"content":"At the .NET Framework command prompt, navigate to the directory you created the <ph id=\"ph1\">`Form1`</ph> class.","source":"At the .NET Framework command prompt, navigate to the directory you created the `Form1` class."},{"content":"Compile the form.","pos":[3033,3050]},{"pos":[3064,3105],"content":"If you are using C#, type: <ph id=\"ph1\">`csc form1.cs`</ph>","source":"If you are using C#, type: `csc form1.cs`"},{"pos":[3140,3191],"content":"If you are using Visual Basic, type: <ph id=\"ph1\">`vbc form1.vb`</ph>","source":"If you are using Visual Basic, type: `vbc form1.vb`"},{"pos":[3201,3241],"content":"At the command prompt, type: <ph id=\"ph1\">`Form1.exe`</ph>","source":"At the command prompt, type: `Form1.exe`"},{"pos":[3250,3288],"content":"Adding a Control and Handling an Event","linkify":"Adding a Control and Handling an Event","nodes":[{"content":"Adding a Control and Handling an Event","pos":[0,38]}]},{"content":"The previous procedure steps demonstrated how to just create a basic Windows Form that compiles and runs.","pos":[3292,3397]},{"content":"The next procedure will show you how to create and add a control to the form, and handle an event for the control.","pos":[3398,3512]},{"content":"For more information about the controls you can add to Windows Forms, see <bpt id=\"p1\">[</bpt>Windows Forms Controls<ept id=\"p1\">](./controls/index.md)</ept>.","pos":[3513,3633],"source":" For more information about the controls you can add to Windows Forms, see [Windows Forms Controls](./controls/index.md)."},{"content":"In addition to understanding how to create Windows Forms applications, you should understand event-based programming and how to handle user input.","pos":[3640,3786]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Creating Event Handlers in Windows Forms<ept id=\"p1\">](creating-event-handlers-in-windows-forms.md)</ept>, and <bpt id=\"p2\">[</bpt>Handling User Input<ept id=\"p2\">](./controls/handling-user-input.md)</ept>","pos":[3787,3962],"source":" For more information, see [Creating Event Handlers in Windows Forms](creating-event-handlers-in-windows-forms.md), and [Handling User Input](./controls/handling-user-input.md)"},{"pos":[3973,4027],"content":"To declare a button control and handle its click event","linkify":"To declare a button control and handle its click event","nodes":[{"content":"To declare a button control and handle its click event","pos":[0,54]}]},{"pos":[4037,4078],"content":"Declare a button control named <ph id=\"ph1\">`button1`</ph>.","source":"Declare a button control named `button1`."},{"pos":[4088,4290],"content":"In the constructor, create the button and set its <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Size%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Location%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Control.Text%2A&gt;</ph> properties.","source":"In the constructor, create the button and set its <xref:System.Windows.Forms.Control.Size%2A>, <xref:System.Windows.Forms.Control.Location%2A> and <xref:System.Windows.Forms.Control.Text%2A> properties."},{"content":"Add the button to the form.","pos":[4300,4327]},{"content":"The following code example demonstrates how to declare the button control.","pos":[4338,4412]},{"pos":[4423,4732],"content":"[!code-csharp[System.Windows.Forms.FormWithButton#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/CS/Form1.cs#2)]\n [!code-vb[System.Windows.Forms.FormWithButton#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/VB/Form1.vb#2)]","leadings":["","    "],"nodes":[]},{"pos":[4742,4835],"content":"Create a method to handle the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event for the button.","source":"Create a method to handle the <xref:System.Windows.Forms.Control.Click> event for the button."},{"pos":[4845,4954],"content":"In the click event handler, display a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MessageBox&gt;</ph> with the message, \"Hello World\".","source":"In the click event handler, display a <xref:System.Windows.Forms.MessageBox> with the message, \"Hello World\"."},{"content":"The following code example demonstrates how to handle the button control's click event.","pos":[4965,5052]},{"pos":[5063,5372],"content":"[!code-csharp[System.Windows.Forms.FormWithButton#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/CS/Form1.cs#3)]\n [!code-vb[System.Windows.Forms.FormWithButton#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/VB/Form1.vb#3)]","leadings":["","    "],"nodes":[]},{"pos":[5382,5472],"content":"Associate the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event with the method you created.","source":"Associate the <xref:System.Windows.Forms.Control.Click> event with the method you created."},{"content":"The following code example demonstrates how to associate the event with the method.","pos":[5483,5566]},{"pos":[5577,5886],"content":"[!code-csharp[System.Windows.Forms.FormWithButton#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/CS/Form1.cs#4)]\n [!code-vb[System.Windows.Forms.FormWithButton#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FormWithButton/VB/Form1.vb#4)]","leadings":["","    "],"nodes":[]},{"content":"Compile and run the application as described in the previous procedure.","pos":[5896,5967]},{"pos":[5976,5983],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"Following code example is the complete example from the previous procedures.","pos":[5987,6063]},{"pos":[6384,6402],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"To compile the code, follow the instructions in the proceeding procedure that describe how to compile and run the application.","pos":[6412,6538]},{"pos":[6547,6555],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6632,6719],"content":"<bpt id=\"p1\">[</bpt>Changing the Appearance of Windows Forms<ept id=\"p1\">](changing-the-appearance-of-windows-forms.md)</ept>","source":"[Changing the Appearance of Windows Forms](changing-the-appearance-of-windows-forms.md)"},{"pos":[6722,6781],"content":"<bpt id=\"p1\">[</bpt>Enhancing Windows Forms Applications<ept id=\"p1\">](./advanced/index.md)</ept>","source":"[Enhancing Windows Forms Applications](./advanced/index.md)"},{"pos":[6784,6859],"content":"<bpt id=\"p1\">[</bpt>Getting Started with Windows Forms<ept id=\"p1\">](getting-started-with-windows-forms.md)</ept>","source":"[Getting Started with Windows Forms](getting-started-with-windows-forms.md)"}]}