{"content":"---\ntitle: \"Windows Forms and WPF Interoperability Input Architecture\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"input architecture [WPF interoperability]\"\n  - \"messages [WPF]\"\n  - \"Windows Forms [WPF], interoperability with\"\n  - \"Windows Forms [WPF], WPF interoperation\"\n  - \"interoperability [WPF], Windows Forms\"\n  - \"modeless forms [WPF]\"\n  - \"ElementHost keyboard and messages [WPF]\"\n  - \"keyboard interoperation [WPF]\"\n  - \"WindowsFormsHost keyboard and messages [WPF]\"\n  - \"modeless dialog boxes [WPF]\"\nms.assetid: 0eb6f137-f088-4c5e-9e37-f96afd28f235\n---\n# Windows Forms and WPF Interoperability Input Architecture\nInteroperation between the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] requires that both technologies have the appropriate keyboard input processing. This topic describes how these technologies implement keyboard and message processing to enable smooth interoperation in hybrid applications.  \n  \n This topic contains the following subsections:  \n  \n-   Modeless Forms and Dialog Boxes  \n  \n-   WindowsFormsHost Keyboard and Message Processing  \n  \n-   ElementHost Keyboard and Message Processing  \n  \n## Modeless Forms and Dialog Boxes  \n Call the <xref:System.Windows.Forms.Integration.WindowsFormsHost.EnableWindowsFormsInterop%2A> method on the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element to open a modeless form or dialog box from a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based application.  \n  \n Call the <xref:System.Windows.Forms.Integration.ElementHost.EnableModelessKeyboardInterop%2A> method on the <xref:System.Windows.Forms.Integration.ElementHost> control to open a modeless [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] page in a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]-based application.  \n  \n## WindowsFormsHost Keyboard and Message Processing  \n When hosted by a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based application, [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] keyboard and message processing consists of the following:  \n  \n-   The <xref:System.Windows.Forms.Integration.WindowsFormsHost> class acquires messages from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] message loop, which is implemented by the <xref:System.Windows.Interop.ComponentDispatcher> class.  \n  \n-   The <xref:System.Windows.Forms.Integration.WindowsFormsHost> class creates a surrogate [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] message loop to ensure that ordinary [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] keyboard processing occurs.  \n  \n-   The <xref:System.Windows.Forms.Integration.WindowsFormsHost> class implements the <xref:System.Windows.Interop.IKeyboardInputSink> interface to coordinate focus management with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  \n  \n-   The <xref:System.Windows.Forms.Integration.WindowsFormsHost> controls register themselves and start their message loops.  \n  \n The following sections describe these parts of the process in more detail.  \n  \n### Acquiring Messages from the WPF Message Loop  \n The <xref:System.Windows.Interop.ComponentDispatcher> class implements the message loop manager for [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]. The <xref:System.Windows.Interop.ComponentDispatcher> class provides hooks to enable external clients to filter messages before [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] processes them.  \n  \n The interoperation implementation handles the <xref:System.Windows.Interop.ComponentDispatcher.ThreadFilterMessage?displayProperty=nameWithType> event, which enables [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls to process messages before [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls.  \n  \n### Surrogate Windows Forms Message Loop  \n By default, the <xref:System.Windows.Forms.Application?displayProperty=nameWithType> class contains the primary message loop for [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] applications. During interoperation, the [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] message loop does not process messages. Therefore, this logic must be reproduced. The handler for the <xref:System.Windows.Interop.ComponentDispatcher.ThreadFilterMessage?displayProperty=nameWithType> event performs the following steps:  \n  \n1.  Filters the message using the <xref:System.Windows.Forms.IMessageFilter> interface.  \n  \n2.  Calls the <xref:System.Windows.Forms.Control.PreProcessMessage%2A?displayProperty=nameWithType> method.  \n  \n3.  Translates and dispatches the message, if it is required.  \n  \n4.  Passes the message to the hosting control, if no other controls process the message.  \n  \n### IKeyboardInputSink Implementation  \n The surrogate message loop handles keyboard management. Therefore, the <xref:System.Windows.Interop.IKeyboardInputSink.TabInto%2A?displayProperty=nameWithType> method is the only <xref:System.Windows.Interop.IKeyboardInputSink> member that requires an implementation in the <xref:System.Windows.Forms.Integration.WindowsFormsHost> class.  \n  \n By default, the <xref:System.Windows.Interop.HwndHost> class returns `false` for its <xref:System.Windows.Interop.HwndHost.System%23Windows%23Interop%23IKeyboardInputSink%23TabInto%2A> implementation. This prevents tabbing from a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control to a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control.  \n  \n The <xref:System.Windows.Forms.Integration.WindowsFormsHost> implementation of the <xref:System.Windows.Interop.IKeyboardInputSink.TabInto%2A?displayProperty=nameWithType> method performs the following steps:  \n  \n1.  Finds the first or last [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control that is contained by the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control and that can receive focus. The control choice depends on traversal information.  \n  \n2.  Sets focus to the control and returns `true`.  \n  \n3.  If no control can receive focus, returns `false`.  \n  \n### WindowsFormsHost Registration  \n When the window handle to a <xref:System.Windows.Forms.Integration.WindowsFormsHost> control is created, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control calls an internal static method that registers its presence for the message loop.  \n  \n During registration, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control examines the message loop. If the message loop has not been started, the <xref:System.Windows.Interop.ComponentDispatcher.ThreadFilterMessage?displayProperty=nameWithType> event handler is created. The message loop is considered to be running when the <xref:System.Windows.Interop.ComponentDispatcher.ThreadFilterMessage?displayProperty=nameWithType> event handler is attached.  \n  \n When the window handle is destroyed, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control removes itself from registration.  \n  \n## ElementHost Keyboard and Message Processing  \n When hosted by a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] application, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] keyboard and message processing consists of the following:  \n  \n-   <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.IKeyboardInputSink>, and <xref:System.Windows.Interop.IKeyboardInputSite> interface implementations.  \n  \n-   Tabbing and arrow keys.  \n  \n-   Command keys and dialog box keys.  \n  \n-   [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] accelerator processing.  \n  \n The following sections describe these parts in more detail.  \n  \n### Interface Implementations  \n In [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)], keyboard messages are routed to the window handle of the control that has focus. In the <xref:System.Windows.Forms.Integration.ElementHost> control, these messages are routed to the hosted element. To accomplish this, the <xref:System.Windows.Forms.Integration.ElementHost> control provides an <xref:System.Windows.Interop.HwndSource> instance. If the <xref:System.Windows.Forms.Integration.ElementHost> control has focus, the <xref:System.Windows.Interop.HwndSource> instance routes most keyboard input so that it can be processed by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Input.InputManager> class.  \n  \n The <xref:System.Windows.Interop.HwndSource> class implements the <xref:System.Windows.Interop.IKeyboardInputSink> and <xref:System.Windows.Interop.IKeyboardInputSite> interfaces.  \n  \n Keyboard interoperation relies on implementing the <xref:System.Windows.Interop.IKeyboardInputSite.OnNoMoreTabStops%2A> method to handle TAB key and arrow key input that moves focus out of hosted elements.  \n  \n### Tabbing and Arrow Keys  \n The [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] selection logic is mapped to the <xref:System.Windows.Interop.HwndSource.System%23Windows%23Interop%23IKeyboardInputSink%23TabInto%2A> and <xref:System.Windows.Interop.IKeyboardInputSite.OnNoMoreTabStops%2A> methods to implement TAB and arrow key navigation. Overriding the <xref:System.Windows.Forms.Integration.ElementHost.Select%2A> method accomplishes this mapping.  \n  \n### Command Keys and Dialog Box Keys  \n To give [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the first opportunity to process command keys and dialog keys, [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] command preprocessing is connected to the <xref:System.Windows.Interop.IKeyboardInputSink.TranslateAccelerator%2A> method. Overriding the <xref:System.Windows.Forms.Control.ProcessCmdKey%2A?displayProperty=nameWithType> method connects the two technologies.  \n  \n With the <xref:System.Windows.Interop.IKeyboardInputSink.TranslateAccelerator%2A> method, the hosted elements can handle any key message, such as WM_KEYDOWN, WM_KEYUP, WM_SYSKEYDOWN, or WM_SYSKEYUP, including command keys, such as TAB, ENTER, ESC, and arrow keys. If a key message is not handled, it is sent up the [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] ancestor hierarchy for handling.  \n  \n### Accelerator Processing  \n To process accelerators correctly, [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] accelerator processing must be connected to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Input.AccessKeyManager> class. Additionally, all WM_CHAR messages must be correctly routed to hosted elements.  \n  \n Because the default <xref:System.Windows.Interop.HwndSource> implementation of the <xref:System.Windows.Interop.IKeyboardInputSink.TranslateChar%2A> method returns `false`, WM_CHAR messages are processed using the following logic:  \n  \n-   The <xref:System.Windows.Forms.Control.IsInputChar%2A?displayProperty=nameWithType> method is overridden to ensure that all WM_CHAR messages are forwarded to hosted elements.  \n  \n-   If the ALT key is pressed, the message is WM_SYSCHAR. [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] does not preprocess this message through the <xref:System.Windows.Forms.Control.IsInputChar%2A> method. Therefore, the <xref:System.Windows.Forms.Control.ProcessMnemonic%2A> method is overridden to query the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Input.AccessKeyManager> for a registered accelerator. If a registered accelerator is found, <xref:System.Windows.Input.AccessKeyManager> processes it.  \n  \n-   If the ALT key is not pressed, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Input.InputManager> class processes the unhandled input. If the input is an accelerator, the <xref:System.Windows.Input.AccessKeyManager> processes it. The <xref:System.Windows.Input.InputManager.PostProcessInput> event is handled for WM_CHAR messages that were not processed.  \n  \n When the user presses the ALT key, accelerator visual cues are shown on the whole form. To support this behavior, all <xref:System.Windows.Forms.Integration.ElementHost> controls on the active form receive WM_SYSKEYDOWN messages, regardless of which control has focus.  \n  \n Messages are sent only to <xref:System.Windows.Forms.Integration.ElementHost> controls in the active form.  \n  \n## See also\n\n- <xref:System.Windows.Forms.Integration.WindowsFormsHost.EnableWindowsFormsInterop%2A>\n- <xref:System.Windows.Forms.Integration.ElementHost.EnableModelessKeyboardInterop%2A>\n- <xref:System.Windows.Forms.Integration.ElementHost>\n- <xref:System.Windows.Forms.Integration.WindowsFormsHost>\n- [Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)\n- [Walkthrough: Hosting a WPF Composite Control in Windows Forms](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)\n- [WPF and Win32 Interoperation](wpf-and-win32-interoperation.md)\n","nodes":[{"pos":[4,565],"embed":true,"restype":"x-metadata","content":"title: \"Windows Forms and WPF Interoperability Input Architecture\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"input architecture [WPF interoperability]\"\n  - \"messages [WPF]\"\n  - \"Windows Forms [WPF], interoperability with\"\n  - \"Windows Forms [WPF], WPF interoperation\"\n  - \"interoperability [WPF], Windows Forms\"\n  - \"modeless forms [WPF]\"\n  - \"ElementHost keyboard and messages [WPF]\"\n  - \"keyboard interoperation [WPF]\"\n  - \"WindowsFormsHost keyboard and messages [WPF]\"\n  - \"modeless dialog boxes [WPF]\"\nms.assetid: 0eb6f137-f088-4c5e-9e37-f96afd28f235","nodes":[{"content":"Windows Forms and WPF Interoperability Input Architecture","nodes":[{"pos":[0,57],"content":"Windows Forms and WPF Interoperability Input Architecture","nodes":[{"content":"Windows Forms and WPF Interoperability Input Architecture","pos":[0,57]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[572,629],"content":"Windows Forms and WPF Interoperability Input Architecture","linkify":"Windows Forms and WPF Interoperability Input Architecture","nodes":[{"content":"Windows Forms and WPF Interoperability Input Architecture","pos":[0,57]}]},{"content":"Interoperation between the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> requires that both technologies have the appropriate keyboard input processing.","pos":[630,900],"source":"Interoperation between the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] requires that both technologies have the appropriate keyboard input processing."},{"content":"This topic describes how these technologies implement keyboard and message processing to enable smooth interoperation in hybrid applications.","pos":[901,1042]},{"content":"This topic contains the following subsections:","pos":[1049,1095]},{"content":"Modeless Forms and Dialog Boxes","pos":[1105,1136]},{"content":"WindowsFormsHost Keyboard and Message Processing","pos":[1146,1194]},{"content":"ElementHost Keyboard and Message Processing","pos":[1204,1247]},{"pos":[1256,1287],"content":"Modeless Forms and Dialog Boxes","linkify":"Modeless Forms and Dialog Boxes","nodes":[{"content":"Modeless Forms and Dialog Boxes","pos":[0,31]}]},{"pos":[1291,1610],"content":"Call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost.EnableWindowsFormsInterop%2A&gt;</ph> method on the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element to open a modeless form or dialog box from a <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>-based application.","source":"Call the <xref:System.Windows.Forms.Integration.WindowsFormsHost.EnableWindowsFormsInterop%2A> method on the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element to open a modeless form or dialog box from a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based application."},{"pos":[1617,1992],"content":"Call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost.EnableModelessKeyboardInterop%2A&gt;</ph> method on the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control to open a modeless <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> page in a <ph id=\"ph4\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph>-based application.","source":"Call the <xref:System.Windows.Forms.Integration.ElementHost.EnableModelessKeyboardInterop%2A> method on the <xref:System.Windows.Forms.Integration.ElementHost> control to open a modeless [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] page in a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]-based application."},{"pos":[2001,2049],"content":"WindowsFormsHost Keyboard and Message Processing","linkify":"WindowsFormsHost Keyboard and Message Processing","nodes":[{"content":"WindowsFormsHost Keyboard and Message Processing","pos":[0,48]}]},{"pos":[2053,2307],"content":"When hosted by a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>-based application, <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> keyboard and message processing consists of the following:","source":"When hosted by a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based application, [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] keyboard and message processing consists of the following:"},{"pos":[2317,2591],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> class acquires messages from the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> message loop, which is implemented by the <ph id=\"ph3\">&lt;xref:System.Windows.Interop.ComponentDispatcher&gt;</ph> class.","source":"The <xref:System.Windows.Forms.Integration.WindowsFormsHost> class acquires messages from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] message loop, which is implemented by the <xref:System.Windows.Interop.ComponentDispatcher> class."},{"pos":[2601,2908],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> class creates a surrogate <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> message loop to ensure that ordinary <ph id=\"ph3\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> keyboard processing occurs.","source":"The <xref:System.Windows.Forms.Integration.WindowsFormsHost> class creates a surrogate [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] message loop to ensure that ordinary [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] keyboard processing occurs."},{"pos":[2918,3177],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> class implements the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.IKeyboardInputSink&gt;</ph> interface to coordinate focus management with <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>.","source":"The <xref:System.Windows.Forms.Integration.WindowsFormsHost> class implements the <xref:System.Windows.Interop.IKeyboardInputSink> interface to coordinate focus management with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]."},{"pos":[3187,3307],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> controls register themselves and start their message loops.","source":"The <xref:System.Windows.Forms.Integration.WindowsFormsHost> controls register themselves and start their message loops."},{"content":"The following sections describe these parts of the process in more detail.","pos":[3314,3388]},{"pos":[3398,3442],"content":"Acquiring Messages from the WPF Message Loop","linkify":"Acquiring Messages from the WPF Message Loop","nodes":[{"content":"Acquiring Messages from the WPF Message Loop","pos":[0,44]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Interop.ComponentDispatcher&gt;</ph> class implements the message loop manager for <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>.","pos":[3446,3628],"source":"The <xref:System.Windows.Interop.ComponentDispatcher> class implements the message loop manager for [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Interop.ComponentDispatcher&gt;</ph> class provides hooks to enable external clients to filter messages before <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> processes them.","pos":[3629,3854],"source":" The <xref:System.Windows.Interop.ComponentDispatcher> class provides hooks to enable external clients to filter messages before [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] processes them."},{"pos":[3861,4232],"content":"The interoperation implementation handles the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.ComponentDispatcher.ThreadFilterMessage?displayProperty=nameWithType&gt;</ph> event, which enables <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls to process messages before <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> controls.","source":"The interoperation implementation handles the <xref:System.Windows.Interop.ComponentDispatcher.ThreadFilterMessage?displayProperty=nameWithType> event, which enables [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls to process messages before [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls."},{"pos":[4242,4278],"content":"Surrogate Windows Forms Message Loop","linkify":"Surrogate Windows Forms Message Loop","nodes":[{"content":"Surrogate Windows Forms Message Loop","pos":[0,36]}]},{"content":"By default, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Application?displayProperty=nameWithType&gt;</ph> class contains the primary message loop for <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> applications.","pos":[4282,4502],"source":"By default, the <xref:System.Windows.Forms.Application?displayProperty=nameWithType> class contains the primary message loop for [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] applications."},{"content":"During interoperation, the <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> message loop does not process messages.","pos":[4503,4647],"source":" During interoperation, the [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] message loop does not process messages."},{"content":"Therefore, this logic must be reproduced.","pos":[4648,4689]},{"content":"The handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.ComponentDispatcher.ThreadFilterMessage?displayProperty=nameWithType&gt;</ph> event performs the following steps:","pos":[4690,4844],"source":" The handler for the <xref:System.Windows.Interop.ComponentDispatcher.ThreadFilterMessage?displayProperty=nameWithType> event performs the following steps:"},{"pos":[4854,4937],"content":"Filters the message using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.IMessageFilter&gt;</ph> interface.","source":"Filters the message using the <xref:System.Windows.Forms.IMessageFilter> interface."},{"pos":[4947,5050],"content":"Calls the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.PreProcessMessage%2A?displayProperty=nameWithType&gt;</ph> method.","source":"Calls the <xref:System.Windows.Forms.Control.PreProcessMessage%2A?displayProperty=nameWithType> method."},{"content":"Translates and dispatches the message, if it is required.","pos":[5060,5117]},{"content":"Passes the message to the hosting control, if no other controls process the message.","pos":[5127,5211]},{"pos":[5221,5254],"content":"IKeyboardInputSink Implementation","linkify":"IKeyboardInputSink Implementation","nodes":[{"content":"IKeyboardInputSink Implementation","pos":[0,33]}]},{"content":"The surrogate message loop handles keyboard management.","pos":[5258,5313]},{"content":"Therefore, the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.IKeyboardInputSink.TabInto%2A?displayProperty=nameWithType&gt;</ph> method is the only <ph id=\"ph2\">&lt;xref:System.Windows.Interop.IKeyboardInputSink&gt;</ph> member that requires an implementation in the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> class.","pos":[5314,5595],"source":" Therefore, the <xref:System.Windows.Interop.IKeyboardInputSink.TabInto%2A?displayProperty=nameWithType> method is the only <xref:System.Windows.Interop.IKeyboardInputSink> member that requires an implementation in the <xref:System.Windows.Forms.Integration.WindowsFormsHost> class."},{"content":"By default, the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndHost&gt;</ph> class returns <ph id=\"ph2\">`false`</ph> for its <ph id=\"ph3\">&lt;xref:System.Windows.Interop.HwndHost.System%23Windows%23Interop%23IKeyboardInputSink%23TabInto%2A&gt;</ph> implementation.","pos":[5602,5802],"source":"By default, the <xref:System.Windows.Interop.HwndHost> class returns `false` for its <xref:System.Windows.Interop.HwndHost.System%23Windows%23Interop%23IKeyboardInputSink%23TabInto%2A> implementation."},{"content":"This prevents tabbing from a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> control to a <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> control.","pos":[5803,6013],"source":" This prevents tabbing from a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control to a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control."},{"pos":[6020,6228],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> implementation of the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.IKeyboardInputSink.TabInto%2A?displayProperty=nameWithType&gt;</ph> method performs the following steps:","source":"The <xref:System.Windows.Forms.Integration.WindowsFormsHost> implementation of the <xref:System.Windows.Interop.IKeyboardInputSink.TabInto%2A?displayProperty=nameWithType> method performs the following steps:"},{"content":"Finds the first or last <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> control that is contained by the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> control and that can receive focus.","pos":[6238,6465],"source":"Finds the first or last [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control that is contained by the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control and that can receive focus."},{"content":"The control choice depends on traversal information.","pos":[6466,6518]},{"pos":[6528,6573],"content":"Sets focus to the control and returns <ph id=\"ph1\">`true`</ph>.","source":"Sets focus to the control and returns `true`."},{"pos":[6583,6632],"content":"If no control can receive focus, returns <ph id=\"ph1\">`false`</ph>.","source":"If no control can receive focus, returns `false`."},{"pos":[6642,6671],"content":"WindowsFormsHost Registration","linkify":"WindowsFormsHost Registration","nodes":[{"content":"WindowsFormsHost Registration","pos":[0,29]}]},{"pos":[6675,6930],"content":"When the window handle to a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> control is created, the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> control calls an internal static method that registers its presence for the message loop.","source":"When the window handle to a <xref:System.Windows.Forms.Integration.WindowsFormsHost> control is created, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control calls an internal static method that registers its presence for the message loop."},{"content":"During registration, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> control examines the message loop.","pos":[6937,7053],"source":"During registration, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control examines the message loop."},{"content":"If the message loop has not been started, the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.ComponentDispatcher.ThreadFilterMessage?displayProperty=nameWithType&gt;</ph> event handler is created.","pos":[7054,7224],"source":" If the message loop has not been started, the <xref:System.Windows.Interop.ComponentDispatcher.ThreadFilterMessage?displayProperty=nameWithType> event handler is created."},{"content":"The message loop is considered to be running when the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.ComponentDispatcher.ThreadFilterMessage?displayProperty=nameWithType&gt;</ph> event handler is attached.","pos":[7225,7404],"source":" The message loop is considered to be running when the <xref:System.Windows.Interop.ComponentDispatcher.ThreadFilterMessage?displayProperty=nameWithType> event handler is attached."},{"pos":[7411,7550],"content":"When the window handle is destroyed, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> control removes itself from registration.","source":"When the window handle is destroyed, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control removes itself from registration."},{"pos":[7559,7602],"content":"ElementHost Keyboard and Message Processing","linkify":"ElementHost Keyboard and Message Processing","nodes":[{"content":"ElementHost Keyboard and Message Processing","pos":[0,43]}]},{"pos":[7606,7854],"content":"When hosted by a <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> application, <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> keyboard and message processing consists of the following:","source":"When hosted by a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] application, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] keyboard and message processing consists of the following:"},{"pos":[7864,8035],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Interop.IKeyboardInputSink&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Windows.Interop.IKeyboardInputSite&gt;</ph> interface implementations.","source":"<xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.IKeyboardInputSink>, and <xref:System.Windows.Interop.IKeyboardInputSite> interface implementations."},{"content":"Tabbing and arrow keys.","pos":[8045,8068]},{"content":"Command keys and dialog box keys.","pos":[8078,8111]},{"pos":[8121,8222],"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> accelerator processing.","source":"[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] accelerator processing."},{"content":"The following sections describe these parts in more detail.","pos":[8229,8288]},{"pos":[8298,8323],"content":"Interface Implementations","linkify":"Interface Implementations","nodes":[{"content":"Interface Implementations","pos":[0,25]}]},{"content":"In <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph>, keyboard messages are routed to the window handle of the control that has focus.","pos":[8327,8489],"source":"In [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)], keyboard messages are routed to the window handle of the control that has focus."},{"content":"In the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control, these messages are routed to the hosted element.","pos":[8490,8606],"source":" In the <xref:System.Windows.Forms.Integration.ElementHost> control, these messages are routed to the hosted element."},{"content":"To accomplish this, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control provides an <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> instance.","pos":[8607,8753],"source":" To accomplish this, the <xref:System.Windows.Forms.Integration.ElementHost> control provides an <xref:System.Windows.Interop.HwndSource> instance."},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control has focus, the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> instance routes most keyboard input so that it can be processed by the <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph4\">&lt;xref:System.Windows.Input.InputManager&gt;</ph> class.","pos":[8754,9077],"source":" If the <xref:System.Windows.Forms.Integration.ElementHost> control has focus, the <xref:System.Windows.Interop.HwndSource> instance routes most keyboard input so that it can be processed by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Input.InputManager> class."},{"pos":[9084,9263],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> class implements the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.IKeyboardInputSink&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Interop.IKeyboardInputSite&gt;</ph> interfaces.","source":"The <xref:System.Windows.Interop.HwndSource> class implements the <xref:System.Windows.Interop.IKeyboardInputSink> and <xref:System.Windows.Interop.IKeyboardInputSite> interfaces."},{"pos":[9270,9475],"content":"Keyboard interoperation relies on implementing the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.IKeyboardInputSite.OnNoMoreTabStops%2A&gt;</ph> method to handle TAB key and arrow key input that moves focus out of hosted elements.","source":"Keyboard interoperation relies on implementing the <xref:System.Windows.Interop.IKeyboardInputSite.OnNoMoreTabStops%2A> method to handle TAB key and arrow key input that moves focus out of hosted elements."},{"pos":[9485,9507],"content":"Tabbing and Arrow Keys","linkify":"Tabbing and Arrow Keys","nodes":[{"content":"Tabbing and Arrow Keys","pos":[0,22]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> selection logic is mapped to the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSource.System%23Windows%23Interop%23IKeyboardInputSink%23TabInto%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Interop.IKeyboardInputSite.OnNoMoreTabStops%2A&gt;</ph> methods to implement TAB and arrow key navigation.","pos":[9511,9851],"source":"The [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] selection logic is mapped to the <xref:System.Windows.Interop.HwndSource.System%23Windows%23Interop%23IKeyboardInputSink%23TabInto%2A> and <xref:System.Windows.Interop.IKeyboardInputSite.OnNoMoreTabStops%2A> methods to implement TAB and arrow key navigation."},{"content":"Overriding the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost.Select%2A&gt;</ph> method accomplishes this mapping.","pos":[9852,9962],"source":" Overriding the <xref:System.Windows.Forms.Integration.ElementHost.Select%2A> method accomplishes this mapping."},{"pos":[9972,10004],"content":"Command Keys and Dialog Box Keys","linkify":"Command Keys and Dialog Box Keys","nodes":[{"content":"Command Keys and Dialog Box Keys","pos":[0,32]}]},{"content":"To give <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> the first opportunity to process command keys and dialog keys, <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> command preprocessing is connected to the <ph id=\"ph3\">&lt;xref:System.Windows.Interop.IKeyboardInputSink.TranslateAccelerator%2A&gt;</ph> method.","pos":[10008,10361],"source":"To give [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the first opportunity to process command keys and dialog keys, [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] command preprocessing is connected to the <xref:System.Windows.Interop.IKeyboardInputSink.TranslateAccelerator%2A> method."},{"content":"Overriding the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.ProcessCmdKey%2A?displayProperty=nameWithType&gt;</ph> method connects the two technologies.","pos":[10362,10496],"source":" Overriding the <xref:System.Windows.Forms.Control.ProcessCmdKey%2A?displayProperty=nameWithType> method connects the two technologies."},{"content":"With the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.IKeyboardInputSink.TranslateAccelerator%2A&gt;</ph> method, the hosted elements can handle any key message, such as WM_KEYDOWN, WM_KEYUP, WM_SYSKEYDOWN, or WM_SYSKEYUP, including command keys, such as TAB, ENTER, ESC, and arrow keys.","pos":[10503,10766],"source":"With the <xref:System.Windows.Interop.IKeyboardInputSink.TranslateAccelerator%2A> method, the hosted elements can handle any key message, such as WM_KEYDOWN, WM_KEYUP, WM_SYSKEYDOWN, or WM_SYSKEYUP, including command keys, such as TAB, ENTER, ESC, and arrow keys."},{"content":"If a key message is not handled, it is sent up the <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> ancestor hierarchy for handling.","pos":[10767,10928],"source":" If a key message is not handled, it is sent up the [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] ancestor hierarchy for handling."},{"pos":[10938,10960],"content":"Accelerator Processing","linkify":"Accelerator Processing","nodes":[{"content":"Accelerator Processing","pos":[0,22]}]},{"content":"To process accelerators correctly, <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> accelerator processing must be connected to the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph3\">&lt;xref:System.Windows.Input.AccessKeyManager&gt;</ph> class.","pos":[10964,11258],"source":"To process accelerators correctly, [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] accelerator processing must be connected to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Input.AccessKeyManager> class."},{"content":"Additionally, all WM_CHAR messages must be correctly routed to hosted elements.","pos":[11259,11338]},{"pos":[11345,11575],"content":"Because the default <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> implementation of the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.IKeyboardInputSink.TranslateChar%2A&gt;</ph> method returns <ph id=\"ph3\">`false`</ph>, WM_CHAR messages are processed using the following logic:","source":"Because the default <xref:System.Windows.Interop.HwndSource> implementation of the <xref:System.Windows.Interop.IKeyboardInputSink.TranslateChar%2A> method returns `false`, WM_CHAR messages are processed using the following logic:"},{"pos":[11585,11759],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.IsInputChar%2A?displayProperty=nameWithType&gt;</ph> method is overridden to ensure that all WM_CHAR messages are forwarded to hosted elements.","source":"The <xref:System.Windows.Forms.Control.IsInputChar%2A?displayProperty=nameWithType> method is overridden to ensure that all WM_CHAR messages are forwarded to hosted elements."},{"content":"If the ALT key is pressed, the message is WM_SYSCHAR.","pos":[11769,11822]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> does not preprocess this message through the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.IsInputChar%2A&gt;</ph> method.","pos":[11823,12004],"source":"[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] does not preprocess this message through the <xref:System.Windows.Forms.Control.IsInputChar%2A> method."},{"content":"Therefore, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.ProcessMnemonic%2A&gt;</ph> method is overridden to query the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph3\">&lt;xref:System.Windows.Input.AccessKeyManager&gt;</ph> for a registered accelerator.","pos":[12005,12265],"source":" Therefore, the <xref:System.Windows.Forms.Control.ProcessMnemonic%2A> method is overridden to query the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Input.AccessKeyManager> for a registered accelerator."},{"content":"If a registered accelerator is found, <ph id=\"ph1\">&lt;xref:System.Windows.Input.AccessKeyManager&gt;</ph> processes it.","pos":[12266,12362],"source":" If a registered accelerator is found, <xref:System.Windows.Input.AccessKeyManager> processes it."},{"content":"If the ALT key is not pressed, the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Input.InputManager&gt;</ph> class processes the unhandled input.","pos":[12372,12566],"source":"If the ALT key is not pressed, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Input.InputManager> class processes the unhandled input."},{"content":"If the input is an accelerator, the <ph id=\"ph1\">&lt;xref:System.Windows.Input.AccessKeyManager&gt;</ph> processes it.","pos":[12567,12661],"source":" If the input is an accelerator, the <xref:System.Windows.Input.AccessKeyManager> processes it."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.InputManager.PostProcessInput&gt;</ph> event is handled for WM_CHAR messages that were not processed.","pos":[12662,12786],"source":" The <xref:System.Windows.Input.InputManager.PostProcessInput> event is handled for WM_CHAR messages that were not processed."},{"content":"When the user presses the ALT key, accelerator visual cues are shown on the whole form.","pos":[12793,12880]},{"content":"To support this behavior, all <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> controls on the active form receive WM_SYSKEYDOWN messages, regardless of which control has focus.","pos":[12881,13061],"source":" To support this behavior, all <xref:System.Windows.Forms.Integration.ElementHost> controls on the active form receive WM_SYSKEYDOWN messages, regardless of which control has focus."},{"pos":[13068,13174],"content":"Messages are sent only to <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> controls in the active form.","source":"Messages are sent only to <xref:System.Windows.Forms.Integration.ElementHost> controls in the active form."},{"pos":[13183,13191],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[13483,13611],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Composite Control in WPF<ept id=\"p1\">](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)</ept>","source":"[Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)"},{"pos":[13614,13742],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a WPF Composite Control in Windows Forms<ept id=\"p1\">](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)</ept>","source":"[Walkthrough: Hosting a WPF Composite Control in Windows Forms](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)"},{"pos":[13745,13808],"content":"<bpt id=\"p1\">[</bpt>WPF and Win32 Interoperation<ept id=\"p1\">](wpf-and-win32-interoperation.md)</ept>","source":"[WPF and Win32 Interoperation](wpf-and-win32-interoperation.md)"}]}