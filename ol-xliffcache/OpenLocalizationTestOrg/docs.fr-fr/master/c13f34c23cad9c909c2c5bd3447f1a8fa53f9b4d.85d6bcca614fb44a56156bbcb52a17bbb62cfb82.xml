{"content":"---\ntitle: \"-keyfile\"\nms.date: 03/10/2018\nhelpviewer_keywords: \n  - \"/keyfile compiler option [Visual Basic]\"\n  - \"keyfile compiler option [Visual Basic]\"\n  - \"-keyfile compiler option [Visual Basic]\"\nms.assetid: ffa82a4b-517a-4c6c-9889-5bae7b534bb8\n---\n# -keyfile\nSpecifies a file containing a key or key pair to give an assembly a strong name.  \n  \n## Syntax  \n  \n``` \n-keyfile:file  \n```  \n  \n## Arguments  \n `file`  \n Required. File that contains the key. If the file name contains a space, enclose the name in quotation marks (\" \").  \n  \n## Remarks  \n The compiler inserts the public key into the assembly manifest and then signs the final assembly with the private key. To generate a key file, type `sn -k file` at the command line. For more information, see [Sn.exe (Strong Name Tool)](../../../framework/tools/sn-exe-strong-name-tool.md)).  \n  \n If you compile with `-target:module`, the name of the key file is held in the module and incorporated into the assembly that is created when you compile an assembly with [/addmodule](../../../visual-basic/reference/command-line-compiler/addmodule.md).  \n  \n You can also pass your encryption information to the compiler with [-keycontainer](../../../visual-basic/reference/command-line-compiler/keycontainer.md). Use [-delaysign](../../../visual-basic/reference/command-line-compiler/delaysign.md) if you want a partially signed assembly.  \n  \n You can also specify this option as a custom attribute (<xref:System.Reflection.AssemblyKeyFileAttribute>) in the source code for any Microsoft intermediate language module.  \n  \n In case both `-keyfile` and [-keycontainer](../../../visual-basic/reference/command-line-compiler/keycontainer.md) are specified (either by command-line option or by custom attribute) in the same compilation, the compiler first tries the key container. If that succeeds, then the assembly is signed with the information in the key container. If the compiler does not find the key container, it tries the file specified with `-keyfile`. If this succeeds, the assembly is signed with the information in the key file, and the key information is installed in the key container (similar to `sn -i`) so that on the next compilation, the key container will be valid.  \n  \n Note that a key file might contain only the public key.  \n  \n See [Creating and Using Strong-Named Assemblies](../../../framework/app-domains/create-and-use-strong-named-assemblies.md) for more information on signing an assembly.  \n  \n> [!NOTE]\n>  The `-keyfile` option is not available from within the Visual Studio development environment; it is available only when compiling from the command line.  \n  \n## Example  \n The following code compiles source file `Input.vb` and specifies a key file.  \n  \n```console  \nvbc -keyfile:myfile.sn input.vb  \n```  \n  \n## See also\n\n- [Assemblies in .NET](../../../standard/assembly/index.md)\n- [Visual Basic Command-Line Compiler](../../../visual-basic/reference/command-line-compiler/index.md)\n- [-reference (Visual Basic)](../../../visual-basic/reference/command-line-compiler/reference.md)\n- [Sample Compilation Command Lines](../../../visual-basic/reference/command-line-compiler/sample-compilation-command-lines.md)\n","nodes":[{"pos":[4,249],"embed":true,"restype":"x-metadata","content":"title: \"-keyfile\"\nms.date: 03/10/2018\nhelpviewer_keywords: \n  - \"/keyfile compiler option [Visual Basic]\"\n  - \"keyfile compiler option [Visual Basic]\"\n  - \"-keyfile compiler option [Visual Basic]\"\nms.assetid: ffa82a4b-517a-4c6c-9889-5bae7b534bb8","nodes":[{"content":"-keyfile","nodes":[{"pos":[0,8],"content":"-keyfile","nodes":[{"content":"-keyfile","pos":[0,8]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[256,264],"content":"-keyfile","linkify":"-keyfile","nodes":[{"content":"-keyfile","pos":[0,8]}]},{"content":"Specifies a file containing a key or key pair to give an assembly a strong name.","pos":[265,345]},{"pos":[354,360],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[399,408],"content":"Arguments","linkify":"Arguments","nodes":[{"content":"Arguments","pos":[0,9]}]},{"content":"Required.","pos":[422,431]},{"content":"File that contains the key.","pos":[432,459]},{"content":"If the file name contains a space, enclose the name in quotation marks (\" \").","pos":[460,537]},{"pos":[546,553],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The compiler inserts the public key into the assembly manifest and then signs the final assembly with the private key.","pos":[557,675]},{"content":"To generate a key file, type <ph id=\"ph1\">`sn -k file`</ph> at the command line.","pos":[676,738],"source":" To generate a key file, type `sn -k file` at the command line."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Sn.exe (Strong Name Tool)<ept id=\"p1\">](../../../framework/tools/sn-exe-strong-name-tool.md)</ept>).","pos":[739,847],"source":" For more information, see [Sn.exe (Strong Name Tool)](../../../framework/tools/sn-exe-strong-name-tool.md))."},{"pos":[854,1105],"content":"If you compile with <ph id=\"ph1\">`-target:module`</ph>, the name of the key file is held in the module and incorporated into the assembly that is created when you compile an assembly with <bpt id=\"p1\">[</bpt>/addmodule<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/addmodule.md)</ept>.","source":"If you compile with `-target:module`, the name of the key file is held in the module and incorporated into the assembly that is created when you compile an assembly with [/addmodule](../../../visual-basic/reference/command-line-compiler/addmodule.md)."},{"content":"You can also pass your encryption information to the compiler with <bpt id=\"p1\">[</bpt>-keycontainer<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/keycontainer.md)</ept>.","pos":[1112,1266],"source":"You can also pass your encryption information to the compiler with [-keycontainer](../../../visual-basic/reference/command-line-compiler/keycontainer.md)."},{"content":"Use <bpt id=\"p1\">[</bpt>-delaysign<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/delaysign.md)</ept> if you want a partially signed assembly.","pos":[1267,1392],"source":" Use [-delaysign](../../../visual-basic/reference/command-line-compiler/delaysign.md) if you want a partially signed assembly."},{"pos":[1399,1572],"content":"You can also specify this option as a custom attribute (<ph id=\"ph1\">&lt;xref:System.Reflection.AssemblyKeyFileAttribute&gt;</ph>) in the source code for any Microsoft intermediate language module.","source":"You can also specify this option as a custom attribute (<xref:System.Reflection.AssemblyKeyFileAttribute>) in the source code for any Microsoft intermediate language module."},{"content":"In case both <ph id=\"ph1\">`-keyfile`</ph> and <bpt id=\"p1\">[</bpt>-keycontainer<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/keycontainer.md)</ept> are specified (either by command-line option or by custom attribute) in the same compilation, the compiler first tries the key container.","pos":[1579,1831],"source":"In case both `-keyfile` and [-keycontainer](../../../visual-basic/reference/command-line-compiler/keycontainer.md) are specified (either by command-line option or by custom attribute) in the same compilation, the compiler first tries the key container."},{"content":"If that succeeds, then the assembly is signed with the information in the key container.","pos":[1832,1920]},{"content":"If the compiler does not find the key container, it tries the file specified with <ph id=\"ph1\">`-keyfile`</ph>.","pos":[1921,2014],"source":" If the compiler does not find the key container, it tries the file specified with `-keyfile`."},{"content":"If this succeeds, the assembly is signed with the information in the key file, and the key information is installed in the key container (similar to <ph id=\"ph1\">`sn -i`</ph>) so that on the next compilation, the key container will be valid.","pos":[2015,2238],"source":" If this succeeds, the assembly is signed with the information in the key file, and the key information is installed in the key container (similar to `sn -i`) so that on the next compilation, the key container will be valid."},{"content":"Note that a key file might contain only the public key.","pos":[2245,2300]},{"pos":[2307,2474],"content":"See <bpt id=\"p1\">[</bpt>Creating and Using Strong-Named Assemblies<ept id=\"p1\">](../../../framework/app-domains/create-and-use-strong-named-assemblies.md)</ept> for more information on signing an assembly.","source":"See [Creating and Using Strong-Named Assemblies](../../../framework/app-domains/create-and-use-strong-named-assemblies.md) for more information on signing an assembly."},{"pos":[2482,2645],"content":"[!NOTE]\n The `-keyfile` option is not available from within the Visual Studio development environment; it is available only when compiling from the command line.","leadings":["","> "],"nodes":[{"content":"The <ph id=\"ph1\">`-keyfile`</ph> option is not available from within the Visual Studio development environment; it is available only when compiling from the command line.","pos":[9,161],"source":"The `-keyfile` option is not available from within the Visual Studio development environment; it is available only when compiling from the command line."}]},{"pos":[2654,2661],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2665,2741],"content":"The following code compiles source file <ph id=\"ph1\">`Input.vb`</ph> and specifies a key file.","source":"The following code compiles source file `Input.vb` and specifies a key file."},{"pos":[2806,2814],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2818,2875],"content":"<bpt id=\"p1\">[</bpt>Assemblies in .NET<ept id=\"p1\">](../../../standard/assembly/index.md)</ept>","source":"[Assemblies in .NET](../../../standard/assembly/index.md)"},{"pos":[2878,2978],"content":"<bpt id=\"p1\">[</bpt>Visual Basic Command-Line Compiler<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/index.md)</ept>","source":"[Visual Basic Command-Line Compiler](../../../visual-basic/reference/command-line-compiler/index.md)"},{"pos":[2981,3076],"content":"<bpt id=\"p1\">[</bpt>-reference (Visual Basic)<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/reference.md)</ept>","source":"[-reference (Visual Basic)](../../../visual-basic/reference/command-line-compiler/reference.md)"},{"pos":[3079,3204],"content":"<bpt id=\"p1\">[</bpt>Sample Compilation Command Lines<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/sample-compilation-command-lines.md)</ept>","source":"[Sample Compilation Command Lines](../../../visual-basic/reference/command-line-compiler/sample-compilation-command-lines.md)"}]}