{"content":"---\ntitle: \"#If...Then...#Else Directives | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\n\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.#EndIf\"\n  - \"#End If\"\n  - \"#Then\"\n  - \"#ElseIf\"\n  - \"vb.#ElseIf\"\n  - \"vb.#Else\"\n  - \"vb.#If\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"Visual Basic code, compiling\"\n  - \"#If directive [Visual Basic]\"\n  - \"conditional compilation, directives\"\n  - \"#End if directive [Visual Basic]\"\n  - \"selective compiling\"\n  - \"else directive (#else)\"\n  - \"#Else directive [Visual Basic]\"\nms.assetid: 10bba104-e3fd-451b-b672-faa472530502\ncaps.latest.revision: 14\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# #If...Then...#Else Directives\nConditionally compiles selected blocks of Visual Basic code.  \n  \n## Syntax  \n  \n```  \n#If expression Then  \n   statements  \n[ #ElseIf expression Then  \n   [ statements ]  \n...  \n#ElseIf expression Then  \n   [ statements ] ]  \n[ #Else  \n   [ statements ] ]  \n#End If  \n```  \n  \n## Parts  \n `expression`  \n Required for `#If` and `#ElseIf` statements, optional elsewhere. Any expression, consisting exclusively of one or more conditional compiler constants, literals, and operators, that evaluates to `True` or `False`.  \n  \n `statements`  \n Required for `#If` statement block, optional elsewhere. Visual Basic program lines or compiler directives that are compiled if the associated expression evaluates to `True`.  \n  \n `#End If`  \n Terminates the `#If` statement block.  \n  \n## Remarks  \n On the surface, the behavior of the `#If...Then...#Else` directives appears the same as that of the `If...Then...Else` statements. However, the `#If...Then...#Else` directives evaluate what is compiled by the compiler, whereas the `If...Then...Else` statements evaluate conditions at run time.  \n  \n Conditional compilation is typically used to compile the same program for different platforms. It is also used to prevent debugging code from appearing in an executable file. Code excluded during conditional compilation is completely omitted from the final executable file, so it has no effect on size or performance.  \n  \n Regardless of the outcome of any evaluation, all expressions are evaluated using `Option Compare Binary`. The `Option Compare` statement does not affect expressions in `#If` and `#ElseIf` statements.  \n  \n> [!NOTE]\n>  No single-line form of the `#If`, `#Else`, `#ElseIf`, and `#End If` directives exists. No other code can appear on the same line as any of the directives.  \n  \n## Example  \n This example uses the `#If...Then...#Else` construct to determine whether to compile certain statements.  \n  \n [!code-vb[VbVbalrConditionalComp#1](../../../visual-basic/language-reference/directives/codesnippet/VisualBasic/if-then-else-directives_1.vb)]  \n  \n## See Also  \n [#Const Directive](../../../visual-basic/language-reference/directives/const-directive.md)   \n [If...Then...Else Statement](../../../visual-basic/language-reference/statements/if-then-else-statement.md)   \n [Conditional Compilation](../../../visual-basic/programming-guide/program-structure/conditional-compilation.md)","nodes":[{"pos":[4,876],"nodes":[{"content":"#If...Then...#Else Directives | Microsoft Docs","nodes":[{"pos":[1,46],"content":"If...Then...#Else Directives | Microsoft Docs","linkify":"If...Then...#Else Directives | Microsoft Docs","nodes":[{"content":"If...Then...#Else Directives | Microsoft Docs","pos":[0,45]}]}],"pos":[6,55],"yaml":true}],"content":"title: \"#If...Then...#Else Directives | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\n\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.#EndIf\"\n  - \"#End If\"\n  - \"#Then\"\n  - \"#ElseIf\"\n  - \"vb.#ElseIf\"\n  - \"vb.#Else\"\n  - \"vb.#If\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"Visual Basic code, compiling\"\n  - \"#If directive [Visual Basic]\"\n  - \"conditional compilation, directives\"\n  - \"#End if directive [Visual Basic]\"\n  - \"selective compiling\"\n  - \"else directive (#else)\"\n  - \"#Else directive [Visual Basic]\"\nms.assetid: 10bba104-e3fd-451b-b672-faa472530502\ncaps.latest.revision: 14\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","yamlblock":true},{"pos":[883,912],"content":"#If...Then...#Else Directives","linkify":"#If...Then...#Else Directives","nodes":[{"content":"#If...Then...#Else Directives","pos":[0,29]}]},{"content":"Conditionally compiles selected blocks of Visual Basic code.","pos":[913,973]},{"pos":[982,988],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1194,1199],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"content":"Required for <ph id=\"ph1\">`#If`</ph> and <ph id=\"ph2\">`#ElseIf`</ph> statements, optional elsewhere.","pos":[1219,1283],"source":"Required for `#If` and `#ElseIf` statements, optional elsewhere."},{"content":"Any expression, consisting exclusively of one or more conditional compiler constants, literals, and operators, that evaluates to <ph id=\"ph1\">`True`</ph> or <ph id=\"ph2\">`False`</ph>.","pos":[1284,1431],"source":" Any expression, consisting exclusively of one or more conditional compiler constants, literals, and operators, that evaluates to `True` or `False`."},{"content":"Required for <ph id=\"ph1\">`#If`</ph> statement block, optional elsewhere.","pos":[1454,1509],"source":"Required for `#If` statement block, optional elsewhere."},{"content":"Visual Basic program lines or compiler directives that are compiled if the associated expression evaluates to <ph id=\"ph1\">`True`</ph>.","pos":[1510,1627],"source":" Visual Basic program lines or compiler directives that are compiled if the associated expression evaluates to `True`."},{"content":"Terminates the <ph id=\"ph1\">`#If`</ph> statement block.","pos":[1647,1684],"source":"Terminates the `#If` statement block."},{"pos":[1693,1700],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"On the surface, the behavior of the <ph id=\"ph1\">`#If...Then...#Else`</ph> directives appears the same as that of the <ph id=\"ph2\">`If...Then...Else`</ph> statements.","pos":[1704,1834],"source":"On the surface, the behavior of the `#If...Then...#Else` directives appears the same as that of the `If...Then...Else` statements."},{"content":"However, the <ph id=\"ph1\">`#If...Then...#Else`</ph> directives evaluate what is compiled by the compiler, whereas the <ph id=\"ph2\">`If...Then...Else`</ph> statements evaluate conditions at run time.","pos":[1835,1997],"source":" However, the `#If...Then...#Else` directives evaluate what is compiled by the compiler, whereas the `If...Then...Else` statements evaluate conditions at run time."},{"content":"Conditional compilation is typically used to compile the same program for different platforms.","pos":[2004,2098]},{"content":"It is also used to prevent debugging code from appearing in an executable file.","pos":[2099,2178]},{"content":"Code excluded during conditional compilation is completely omitted from the final executable file, so it has no effect on size or performance.","pos":[2179,2321]},{"content":"Regardless of the outcome of any evaluation, all expressions are evaluated using <ph id=\"ph1\">`Option Compare Binary`</ph>.","pos":[2328,2433],"source":"Regardless of the outcome of any evaluation, all expressions are evaluated using `Option Compare Binary`."},{"content":"The <ph id=\"ph1\">`Option Compare`</ph> statement does not affect expressions in <ph id=\"ph2\">`#If`</ph> and <ph id=\"ph3\">`#ElseIf`</ph> statements.","pos":[2434,2527],"source":" The `Option Compare` statement does not affect expressions in `#If` and `#ElseIf` statements."},{"pos":[2535,2700],"content":"[!NOTE]\n No single-line form of the `#If`, `#Else`, `#ElseIf`, and `#End If` directives exists. No other code can appear on the same line as any of the directives.","leadings":["","> "],"nodes":[{"content":"No single-line form of the `#If`, `#Else`, `#ElseIf`, and `#End If` directives exists. No other code can appear on the same line as any of the directives.","pos":[9,163],"nodes":[{"content":"No single-line form of the <ph id=\"ph1\">`#If`</ph>, <ph id=\"ph2\">`#Else`</ph>, <ph id=\"ph3\">`#ElseIf`</ph>, and <ph id=\"ph4\">`#End If`</ph> directives exists.","pos":[0,86],"source":"No single-line form of the `#If`, `#Else`, `#ElseIf`, and `#End If` directives exists."},{"content":"No other code can appear on the same line as any of the directives.","pos":[87,154]}]}]},{"pos":[2709,2716],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2720,2824],"content":"This example uses the <ph id=\"ph1\">`#If...Then...#Else`</ph> construct to determine whether to compile certain statements.","source":"This example uses the `#If...Then...#Else` construct to determine whether to compile certain statements."},{"pos":[2831,2973],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrConditionalComp#1<ept id=\"p2\">](../../../visual-basic/language-reference/directives/codesnippet/VisualBasic/if-then-else-directives_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrConditionalComp#1](../../../visual-basic/language-reference/directives/codesnippet/VisualBasic/if-then-else-directives_1.vb)]"},{"pos":[2982,2990],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>#Const Directive<ept id=\"p1\">](../../../visual-basic/language-reference/directives/const-directive.md)</ept><ph id=\"ph1\"> </ph>","pos":[2994,3085],"source":"[#Const Directive](../../../visual-basic/language-reference/directives/const-directive.md) "},{"content":"<bpt id=\"p1\">[</bpt>If...Then...Else Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/if-then-else-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[3089,3197],"source":"[If...Then...Else Statement](../../../visual-basic/language-reference/statements/if-then-else-statement.md) "},{"content":"<bpt id=\"p1\">[</bpt>Conditional Compilation<ept id=\"p1\">](../../../visual-basic/programming-guide/program-structure/conditional-compilation.md)</ept>","pos":[3201,3312],"source":"[Conditional Compilation](../../../visual-basic/programming-guide/program-structure/conditional-compilation.md)"}]}