{"content":"---\ntitle: \"How to: Validate Application Settings\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"validating application settings\"\n  - \"application settings [Windows Forms], Windows Forms\"\n  - \"application settings [Windows Forms], validating\"\nms.assetid: 9f145ada-4267-436a-aa4c-c4dcffd0afb7\n---\n# How to: Validate Application Settings\nThis topic demonstrates how to validate application settings before they are persisted.  \n  \n Because application settings are strongly typed, you have some confidence that users cannot assign data of an incorrect type to a given setting. However, a user still may attempt to assign a value to a setting that falls outside of acceptable bounds—for example, supplying a birth date that occurs in the future. <xref:System.Configuration.ApplicationSettingsBase>, the parent class of all application settings classes, exposes four events to enable such bounds checking. Handling these events puts all of your validation code in a single location, rather than scattering it throughout your project.  \n  \n The event you use depends upon when you need to validate your settings, as described in the following table.  \n  \n|Event|Occurrence and use|  \n|-----------|------------------------|  \n|<xref:System.Configuration.ApplicationSettingsBase.SettingsLoaded>|Occurs after the initial loading of a settings property group.<br /><br /> Use this event to validate initial values for the entire property group before they are used within the application.|  \n|<xref:System.Configuration.ApplicationSettingsBase.SettingChanging>|Occurs before the value of a single settings property is changed.<br /><br /> Use this event to validate a single property before it is changed. It can provide immediate feedback to users regarding their actions and choices.|  \n|<xref:System.Configuration.ApplicationSettingsBase.PropertyChanged>|Occurs after the value of a single settings property is changed.<br /><br /> Use this event to validate a single property after it is changed. This event is rarely used for validation unless a lengthy, asynchronous validation process is required.|  \n|<xref:System.Configuration.ApplicationSettingsBase.SettingsSaving>|Occurs before the settings property group is stored.<br /><br /> Use this event to validate values for the entire property group before they are persisted to disk.|  \n  \n Typically, you will not use all of these events within the same application for validation purposes. For example, it is often possible to fulfill all validation requirements by handling only the <xref:System.Configuration.ApplicationSettingsBase.SettingChanging> event.  \n  \n An event handler generally performs one of the following actions when it detects an invalid value:  \n  \n-   Automatically supplies a value known to be correct, such as the default value.  \n  \n-   Re-queries the user of server code for information.  \n  \n-   For events raised before their associated actions, such as <xref:System.Configuration.ApplicationSettingsBase.SettingChanging> and <xref:System.Configuration.ApplicationSettingsBase.SettingsSaving>, uses the <xref:System.ComponentModel.CancelEventArgs> argument to cancel the operation.  \n  \n For more information about event handling, see [Event Handlers Overview](../event-handlers-overview-windows-forms.md).  \n  \n The following procedures show how to test for a valid birth date using either the <xref:System.Configuration.ApplicationSettingsBase.SettingChanging> or the <xref:System.Configuration.ApplicationSettingsBase.SettingsSaving> event. The procedures were written under the assumption that you have already created your application settings; in this example, we will perform bounds checking on a setting named `DateOfBirth`. For more information about creating settings, see [How to: Create Application Settings](how-to-create-application-settings.md).  \n  \n### To obtain the application settings object  \n  \n-   Obtain a reference to the application settings object (the wrapper instance) by completing one of the following bulleted items:  \n  \n    -   If you created your settings using the Visual Studio Application Settings dialog box in the **Property Editor**, you can retrieve the default settings object generated for your language through the following expression.  \n  \n        ```csharp  \n        Configuration.Settings.Default   \n        ```  \n  \n        ```vb  \n        MySettings.Default   \n        ```  \n  \n         -or-  \n  \n    -   If you are a Visual Basic developer and you created your application settings using the Project Designer, you can retrieve your settings by using the [My.Settings Object](~/docs/visual-basic/language-reference/objects/my-settings-object.md).  \n  \n         -or-  \n  \n    -   If you created your settings by deriving from <xref:System.Configuration.ApplicationSettingsBase> directly, you need to instantiate your class manually.  \n  \n        ```csharp  \n        MyCustomSettings settings = new MyCustomSettings();  \n        ```  \n  \n        ```vb  \n        Dim Settings as New MyCustomSettings()  \n        ```  \n  \n The following procedures were written under the assumption that the application settings object was obtained by completing the last bulleted item in this procedure.  \n  \n### To validate Application Settings when a setting is changing  \n  \n1.  If you are a C# developer, in your form or control's `Load` event, add an event handler for the <xref:System.Configuration.ApplicationSettingsBase.SettingChanging> event.  \n  \n     -or-  \n  \n     If you are a Visual Basic developer, you should declare the `Settings` variable using the `WithEvents` keyword.  \n  \n    ```csharp  \n    public void Form1_Load(Object sender, EventArgs e)   \n    {  \n        settings.SettingChanging += new SettingChangingEventHandler(MyCustomSettings_SettingChanging);  \n    }  \n    ```  \n  \n    ```vb  \n    Public Sub Form1_Load(sender as Object, e as EventArgs)  \n        AddHandler settings.SettingChanging, AddressOf MyCustomSettings_SettingChanging  \n    End Sub   \n    ```  \n  \n2.  Define the event handler, and write the code inside of it to perform bounds checking on the birth date.  \n  \n    ```csharp  \n    private void MyCustomSettings_SettingChanging(Object sender, SettingChangingEventArgs e)  \n    {  \n        if (e.SettingName.Equals(\"DateOfBirth\")) {  \n            Date newDate = (Date)e.NewValue;  \n            If (newDate > Date.Now) {  \n                e.Cancel = true;  \n                // Inform the user.  \n            }  \n        }  \n    }  \n    ```  \n  \n    ```vb  \n    Private Sub MyCustomSettings_SettingChanging(sender as Object, e as SettingChangingEventArgs) Handles Settings.SettingChanging  \n        If (e.SettingName.Equals(\"DateOfBirth\")) Then  \n            Dim NewDate as Date = CType(e.NewValue, Date)  \n            If (NewDate > Date.Now) Then  \n                e.Cancel = True  \n                ' Inform the user.  \n            End If  \n        End If  \n    End Sub  \n    ```  \n  \n### To validate Application Settings when a Save occurs  \n  \n1.  In your form or control's `Load` event, add an event handler for the <xref:System.Configuration.ApplicationSettingsBase.SettingsSaving> event.  \n  \n    ```csharp  \n    public void Form1_Load(Object sender, EventArgs e)   \n    {  \n        settings.SettingsSaving += new SettingsSavingEventHandler(MyCustomSettings_SettingsSaving);  \n    }  \n    ```  \n  \n    ```vb  \n    Public Sub Form1_Load(Sender as Object, e as EventArgs)  \n        AddHandler settings.SettingsSaving, AddressOf MyCustomSettings_SettingsSaving  \n    End Sub  \n    ```  \n  \n2.  Define the event handler, and write the code inside of it to perform bounds checking on the birth date.  \n  \n    ```csharp  \n    private void MyCustomSettings_SettingsSaving(Object sender, SettingsSavingEventArgs e)  \n    {  \n        if (this[\"DateOfBirth\"] > Date.Now) {  \n            e.Cancel = true;  \n        }  \n    }  \n    ```  \n  \n    ```vb  \n    Private Sub MyCustomSettings_SettingsSaving(Sender as Object, e as SettingsSavingEventArgs)  \n        If (Me[\"DateOfBirth\"] > Date.Now) Then  \n            e.Cancel = True  \n        End If  \n    End Sub  \n    ```  \n  \n## See also\n\n- [Creating Event Handlers in Windows Forms](../creating-event-handlers-in-windows-forms.md)\n- [How to: Create Application Settings](how-to-create-application-settings.md)\n","nodes":[{"pos":[4,328],"embed":true,"restype":"x-metadata","content":"title: \"How to: Validate Application Settings\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"validating application settings\"\n  - \"application settings [Windows Forms], Windows Forms\"\n  - \"application settings [Windows Forms], validating\"\nms.assetid: 9f145ada-4267-436a-aa4c-c4dcffd0afb7","nodes":[{"content":"How to: Validate Application Settings","nodes":[{"pos":[0,37],"content":"How to: Validate Application Settings","nodes":[{"content":"How to: Validate Application Settings","pos":[0,37]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[335,372],"content":"How to: Validate Application Settings","linkify":"How to: Validate Application Settings","nodes":[{"content":"How to: Validate Application Settings","pos":[0,37]}]},{"content":"This topic demonstrates how to validate application settings before they are persisted.","pos":[373,460]},{"content":"Because application settings are strongly typed, you have some confidence that users cannot assign data of an incorrect type to a given setting.","pos":[467,611]},{"content":"However, a user still may attempt to assign a value to a setting that falls outside of acceptable bounds—for example, supplying a birth date that occurs in the future.","pos":[612,779]},{"content":"<ph id=\"ph1\">&lt;xref:System.Configuration.ApplicationSettingsBase&gt;</ph>, the parent class of all application settings classes, exposes four events to enable such bounds checking.","pos":[780,938],"source":"<xref:System.Configuration.ApplicationSettingsBase>, the parent class of all application settings classes, exposes four events to enable such bounds checking."},{"content":"Handling these events puts all of your validation code in a single location, rather than scattering it throughout your project.","pos":[939,1066]},{"content":"The event you use depends upon when you need to validate your settings, as described in the following table.","pos":[1073,1181]},{"content":"Event","pos":[1188,1193]},{"content":"Occurrence and use","pos":[1194,1212]},{"content":"Occurs after the initial loading of a settings property group.","pos":[1325,1387]},{"content":"Use this event to validate initial values for the entire property group before they are used within the application.","pos":[1400,1516]},{"content":"Occurs before the value of a single settings property is changed.","pos":[1589,1654]},{"content":"Use this event to validate a single property before it is changed.","pos":[1667,1733]},{"content":"It can provide immediate feedback to users regarding their actions and choices.","pos":[1734,1813]},{"content":"Occurs after the value of a single settings property is changed.","pos":[1886,1950]},{"content":"Use this event to validate a single property after it is changed.","pos":[1963,2028]},{"content":"This event is rarely used for validation unless a lengthy, asynchronous validation process is required.","pos":[2029,2132]},{"content":"Occurs before the settings property group is stored.","pos":[2204,2256]},{"content":"Use this event to validate values for the entire property group before they are persisted to disk.","pos":[2269,2367]},{"content":"Typically, you will not use all of these events within the same application for validation purposes.","pos":[2375,2475]},{"content":"For example, it is often possible to fulfill all validation requirements by handling only the <ph id=\"ph1\">&lt;xref:System.Configuration.ApplicationSettingsBase.SettingChanging&gt;</ph> event.","pos":[2476,2644],"source":" For example, it is often possible to fulfill all validation requirements by handling only the <xref:System.Configuration.ApplicationSettingsBase.SettingChanging> event."},{"content":"An event handler generally performs one of the following actions when it detects an invalid value:","pos":[2651,2749]},{"content":"Automatically supplies a value known to be correct, such as the default value.","pos":[2759,2837]},{"content":"Re-queries the user of server code for information.","pos":[2847,2898]},{"pos":[2908,3194],"content":"For events raised before their associated actions, such as <ph id=\"ph1\">&lt;xref:System.Configuration.ApplicationSettingsBase.SettingChanging&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Configuration.ApplicationSettingsBase.SettingsSaving&gt;</ph>, uses the <ph id=\"ph3\">&lt;xref:System.ComponentModel.CancelEventArgs&gt;</ph> argument to cancel the operation.","source":"For events raised before their associated actions, such as <xref:System.Configuration.ApplicationSettingsBase.SettingChanging> and <xref:System.Configuration.ApplicationSettingsBase.SettingsSaving>, uses the <xref:System.ComponentModel.CancelEventArgs> argument to cancel the operation."},{"pos":[3201,3319],"content":"For more information about event handling, see <bpt id=\"p1\">[</bpt>Event Handlers Overview<ept id=\"p1\">](../event-handlers-overview-windows-forms.md)</ept>.","source":"For more information about event handling, see [Event Handlers Overview](../event-handlers-overview-windows-forms.md)."},{"content":"The following procedures show how to test for a valid birth date using either the <ph id=\"ph1\">&lt;xref:System.Configuration.ApplicationSettingsBase.SettingChanging&gt;</ph> or the <ph id=\"ph2\">&lt;xref:System.Configuration.ApplicationSettingsBase.SettingsSaving&gt;</ph> event.","pos":[3326,3556],"source":"The following procedures show how to test for a valid birth date using either the <xref:System.Configuration.ApplicationSettingsBase.SettingChanging> or the <xref:System.Configuration.ApplicationSettingsBase.SettingsSaving> event."},{"content":"The procedures were written under the assumption that you have already created your application settings; in this example, we will perform bounds checking on a setting named <ph id=\"ph1\">`DateOfBirth`</ph>.","pos":[3557,3745],"source":" The procedures were written under the assumption that you have already created your application settings; in this example, we will perform bounds checking on a setting named `DateOfBirth`."},{"content":"For more information about creating settings, see <bpt id=\"p1\">[</bpt>How to: Create Application Settings<ept id=\"p1\">](how-to-create-application-settings.md)</ept>.","pos":[3746,3873],"source":" For more information about creating settings, see [How to: Create Application Settings](how-to-create-application-settings.md)."},{"pos":[3883,3924],"content":"To obtain the application settings object","linkify":"To obtain the application settings object","nodes":[{"content":"To obtain the application settings object","pos":[0,41]}]},{"content":"Obtain a reference to the application settings object (the wrapper instance) by completing one of the following bulleted items:","pos":[3934,4061]},{"pos":[4075,4294],"content":"If you created your settings using the Visual Studio Application Settings dialog box in the <bpt id=\"p1\">**</bpt>Property Editor<ept id=\"p1\">**</ept>, you can retrieve the default settings object generated for your language through the following expression.","source":"If you created your settings using the Visual Studio Application Settings dialog box in the **Property Editor**, you can retrieve the default settings object generated for your language through the following expression."},{"content":"-or-","pos":[4451,4455]},{"pos":[4469,4710],"content":"If you are a Visual Basic developer and you created your application settings using the Project Designer, you can retrieve your settings by using the <bpt id=\"p1\">[</bpt>My.Settings Object<ept id=\"p1\">](~/docs/visual-basic/language-reference/objects/my-settings-object.md)</ept>.","source":"If you are a Visual Basic developer and you created your application settings using the Project Designer, you can retrieve your settings by using the [My.Settings Object](~/docs/visual-basic/language-reference/objects/my-settings-object.md)."},{"content":"-or-","pos":[4725,4729]},{"pos":[4743,4895],"content":"If you created your settings by deriving from <ph id=\"ph1\">&lt;xref:System.Configuration.ApplicationSettingsBase&gt;</ph> directly, you need to instantiate your class manually.","source":"If you created your settings by deriving from <xref:System.Configuration.ApplicationSettingsBase> directly, you need to instantiate your class manually."},{"content":"The following procedures were written under the assumption that the application settings object was obtained by completing the last bulleted item in this procedure.","pos":[5083,5247]},{"pos":[5257,5316],"content":"To validate Application Settings when a setting is changing","linkify":"To validate Application Settings when a setting is changing","nodes":[{"content":"To validate Application Settings when a setting is changing","pos":[0,59]}]},{"pos":[5326,5496],"content":"If you are a C# developer, in your form or control's <ph id=\"ph1\">`Load`</ph> event, add an event handler for the <ph id=\"ph2\">&lt;xref:System.Configuration.ApplicationSettingsBase.SettingChanging&gt;</ph> event.","source":"If you are a C# developer, in your form or control's `Load` event, add an event handler for the <xref:System.Configuration.ApplicationSettingsBase.SettingChanging> event."},{"content":"-or-","pos":[5507,5511]},{"pos":[5522,5633],"content":"If you are a Visual Basic developer, you should declare the <ph id=\"ph1\">`Settings`</ph> variable using the <ph id=\"ph2\">`WithEvents`</ph> keyword.","source":"If you are a Visual Basic developer, you should declare the `Settings` variable using the `WithEvents` keyword."},{"content":"Define the event handler, and write the code inside of it to perform bounds checking on the birth date.","pos":[6043,6146]},{"pos":[6977,7028],"content":"To validate Application Settings when a Save occurs","linkify":"To validate Application Settings when a Save occurs","nodes":[{"content":"To validate Application Settings when a Save occurs","pos":[0,51]}]},{"pos":[7038,7180],"content":"In your form or control's <ph id=\"ph1\">`Load`</ph> event, add an event handler for the <ph id=\"ph2\">&lt;xref:System.Configuration.ApplicationSettingsBase.SettingsSaving&gt;</ph> event.","source":"In your form or control's `Load` event, add an event handler for the <xref:System.Configuration.ApplicationSettingsBase.SettingsSaving> event."},{"content":"Define the event handler, and write the code inside of it to perform bounds checking on the birth date.","pos":[7584,7687]},{"pos":[8158,8166],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8170,8260],"content":"<bpt id=\"p1\">[</bpt>Creating Event Handlers in Windows Forms<ept id=\"p1\">](../creating-event-handlers-in-windows-forms.md)</ept>","source":"[Creating Event Handlers in Windows Forms](../creating-event-handlers-in-windows-forms.md)"},{"pos":[8263,8339],"content":"<bpt id=\"p1\">[</bpt>How to: Create Application Settings<ept id=\"p1\">](how-to-create-application-settings.md)</ept>","source":"[How to: Create Application Settings](how-to-create-application-settings.md)"}]}