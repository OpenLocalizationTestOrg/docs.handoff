{"content":"---\ntitle: \"How to: Serialize Using XmlSerializer (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: cace24eb-0f43-4016-8e4b-199e5ef73a1c\n---\n# How to: Serialize Using XmlSerializer (Visual Basic)\nThis topic shows an example that serializes and deserializes using <xref:System.Xml.Serialization.XmlSerializer>.  \n  \n## Example  \n The following example creates a number of objects that contain <xref:System.Xml.Linq.XElement> objects. It then serializes them to a memory stream, and then deserializes them from the memory stream.  \n  \n```vb  \nImports System  \nImports System.Xml  \nImports System.Xml.Linq  \nImports System.IO  \nImports System.Runtime.Serialization  \nImports System.Xml.Serialization  \n  \nPublic Class XElementContainer  \n    Public member As XElement  \n  \n    Public Sub XElementContainer()  \n        member = XLinqTest.CreateXElement()  \n    End Sub  \n  \n    Overrides Function ToString() As String  \n        Return member.ToString()  \n    End Function  \nEnd Class  \n  \nPublic Class XElementNullContainer  \n    Public member As XElement  \n  \n    Public Sub XElementNullContainer()  \n        member = Nothing  \n    End Sub  \nEnd Class  \n  \nPublic Class XLinqTest  \n    Shared Sub Main()  \n        Test(Of XElementNullContainer)(New XElementNullContainer())  \n        Test(Of XElement)(CreateXElement())  \n        Test(Of XElementContainer)(New XElementContainer())  \n    End Sub  \n  \n    Public Shared Function CreateXElement() As XElement  \n        Dim ns As XNamespace = \"http://www.adventure-works.com\"  \n        Return New XElement(ns + \"aw\")  \n    End Function  \n  \n    Public Shared Sub Test(Of T)(ByRef obj)  \n        Using stream As New MemoryStream()  \n            Dim s As XmlSerializer = New XmlSerializer(GetType(T))  \n            Console.WriteLine(\"Testing for type: {0}\", GetType(T))  \n            s.Serialize(XmlWriter.Create(stream), obj)  \n            stream.Flush()  \n            stream.Seek(0, SeekOrigin.Begin)  \n            Dim o As Object = s.Deserialize(XmlReader.Create(stream))  \n            Console.WriteLine(\"  Deserialized type: {0}\", o.GetType())  \n        End Using  \n    End Sub  \nEnd Class  \n```  \n  \n This example produces the following output:  \n  \n```  \nTesting for type: XElementNullContainer  \n  Deserialized type: XElementNullContainer  \nTesting for type: System.Xml.Linq.XElement  \n  Deserialized type: System.Xml.Linq.XElement  \nTesting for type: XElementContainer  \n  Deserialized type: XElementContainer  \n```  \n  \n## See also\n\n- [Serializing Object Graphs that Contain XElement Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/serializing-object-graphs-that-contain-xelement-objects.md)\n","nodes":[{"pos":[4,134],"embed":true,"restype":"x-metadata","content":"title: \"How to: Serialize Using XmlSerializer (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: cace24eb-0f43-4016-8e4b-199e5ef73a1c","nodes":[{"content":"How to: Serialize Using XmlSerializer (Visual Basic)","nodes":[{"pos":[0,52],"content":"How to: Serialize Using XmlSerializer (Visual Basic)","nodes":[{"content":"How to: Serialize Using XmlSerializer (Visual Basic)","pos":[0,52]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[141,193],"content":"How to: Serialize Using XmlSerializer (Visual Basic)","linkify":"How to: Serialize Using XmlSerializer (Visual Basic)","nodes":[{"content":"How to: Serialize Using XmlSerializer (Visual Basic)","pos":[0,52]}]},{"pos":[194,307],"content":"This topic shows an example that serializes and deserializes using <ph id=\"ph1\">&lt;xref:System.Xml.Serialization.XmlSerializer&gt;</ph>.","source":"This topic shows an example that serializes and deserializes using <xref:System.Xml.Serialization.XmlSerializer>."},{"pos":[316,323],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example creates a number of objects that contain <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> objects.","pos":[327,430],"source":"The following example creates a number of objects that contain <xref:System.Xml.Linq.XElement> objects."},{"content":"It then serializes them to a memory stream, and then deserializes them from the memory stream.","pos":[431,525]},{"content":"This example produces the following output:","pos":[2146,2189]},{"pos":[2472,2480],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2484,2673],"content":"<bpt id=\"p1\">[</bpt>Serializing Object Graphs that Contain XElement Objects (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/serializing-object-graphs-that-contain-xelement-objects.md)</ept>","source":"[Serializing Object Graphs that Contain XElement Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/serializing-object-graphs-that-contain-xelement-objects.md)"}]}