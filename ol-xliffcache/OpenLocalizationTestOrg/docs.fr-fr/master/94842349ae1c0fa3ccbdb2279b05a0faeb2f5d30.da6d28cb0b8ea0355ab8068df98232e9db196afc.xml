{"content":"---\ntitle: \"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"event logs, shutdown\"\n  - \"My.Application.Log object, logging\"\n  - \"Startup event\"\n  - \"event logs, startup\"\n  - \"Shutdown event\"\n  - \"My.Log object, logging\"\nms.assetid: 67624d05-cddf-48b7-8c36-5c99baa4c621\ncaps.latest.revision: 16\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)\nYou can use the `My.Application.Log` and `My.Log` objects to log information about events that occur in your application. This example shows how to use the `My.Application.Log.WriteEntry` method with the `Startup` and `Shutdown` events to write tracing information.  \n  \n### To access the application's event-handler code  \n  \n1.  Have a project selected in **Solution Explorer**. On the **Project** menu, choose **Properties**.  \n  \n2.  Click the **Application** tab.  \n  \n3.  Click the **View Application Events** button to open the Code Editor.  \n  \n     This opens the ApplicationEvents.vb file.  \n  \n### To log messages when the application starts  \n  \n1.  Have the ApplicationEvents.vb file open in the Code Editor. On the **General** menu, choose **MyApplication Events**.  \n  \n2.  On the **Declarations** menu, choose **Startup**.  \n  \n     The application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup> event before the main application runs.  \n  \n3.  Add the `My.Application.Log.WriteEntry` method to the `Startup` event handler.  \n  \n     [!code-vb[VbVbalrMyApplicationLog#1](../../../../visual-basic/developing-apps/programming/log-info/codesnippet/VisualBasic/how-to-log-messages-when-the-application-starts-or-shuts-down_1.vb)]  \n  \n### To log messages when the application shuts down  \n  \n1.  Have the ApplicationEvents.vb file open in the Code Editor. On the **General** menu, choose **MyApplication Events**.  \n  \n2.  On the **Declarations** menu, choose **Shutdown**.  \n  \n     The application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown> event after the main application runs, but before it shuts down.  \n  \n3.  Add the `My.Application.Log.WriteEntry` method to the `Shutdown` event handler.  \n  \n     [!code-vb[VbVbalrMyApplicationLog#2](../../../../visual-basic/developing-apps/programming/log-info/codesnippet/VisualBasic/how-to-log-messages-when-the-application-starts-or-shuts-down_2.vb)]  \n  \n## Example  \n You can use the **Project Designer** to access the application events in the Code Editor. For more information, see [Application Page, Project Designer (Visual Basic)](https://docs.microsoft.com/visualstudio/ide/reference/application-page-project-designer-visual-basic).  \n  \n [!code-vb[VbVbalrMyApplicationLog#3](../../../../visual-basic/developing-apps/programming/log-info/codesnippet/VisualBasic/how-to-log-messages-when-the-application-starts-or-shuts-down_3.vb)]  \n  \n## See Also  \n <xref:Microsoft.VisualBasic.Logging.Log?displayProperty=fullName>   \n <xref:Microsoft.VisualBasic.Logging.Log.WriteEntry%2A>   \n <xref:Microsoft.VisualBasic.Logging.Log.WriteException%2A>   \n [Application Page, Project Designer (Visual Basic)](https://docs.microsoft.com/visualstudio/ide/reference/application-page-project-designer-visual-basic)   \n [Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)","nodes":[{"pos":[4,784],"nodes":[{"content":"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic) | Microsoft Docs","nodes":[{"pos":[0,94],"content":"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic) | Microsoft Docs","nodes":[{"content":"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic) | Microsoft Docs","pos":[0,94]}]}],"pos":[6,103],"yaml":true}],"content":"title: \"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"event logs, shutdown\"\n  - \"My.Application.Log object, logging\"\n  - \"Startup event\"\n  - \"event logs, startup\"\n  - \"Shutdown event\"\n  - \"My.Log object, logging\"\nms.assetid: 67624d05-cddf-48b7-8c36-5c99baa4c621\ncaps.latest.revision: 16\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"","yamlblock":true},{"pos":[791,868],"content":"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)","linkify":"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)","nodes":[{"content":"How to: Log Messages When the Application Starts or Shuts Down (Visual Basic)","pos":[0,77]}]},{"content":"You can use the <ph id=\"ph1\">`My.Application.Log`</ph> and <ph id=\"ph2\">`My.Log`</ph> objects to log information about events that occur in your application.","pos":[869,990],"source":"You can use the `My.Application.Log` and `My.Log` objects to log information about events that occur in your application."},{"content":"This example shows how to use the <ph id=\"ph1\">`My.Application.Log.WriteEntry`</ph> method with the <ph id=\"ph2\">`Startup`</ph> and <ph id=\"ph3\">`Shutdown`</ph> events to write tracing information.","pos":[991,1134],"source":" This example shows how to use the `My.Application.Log.WriteEntry` method with the `Startup` and `Shutdown` events to write tracing information."},{"pos":[1144,1190],"content":"To access the application's event-handler code","linkify":"To access the application's event-handler code","nodes":[{"content":"To access the application's event-handler code","pos":[0,46]}]},{"content":"Have a project selected in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>.","pos":[1200,1249],"source":"Have a project selected in **Solution Explorer**."},{"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","pos":[1250,1297],"source":" On the **Project** menu, choose **Properties**."},{"pos":[1307,1337],"content":"Click the <bpt id=\"p1\">**</bpt>Application<ept id=\"p1\">**</ept> tab.","source":"Click the **Application** tab."},{"pos":[1347,1416],"content":"Click the <bpt id=\"p1\">**</bpt>View Application Events<ept id=\"p1\">**</ept> button to open the Code Editor.","source":"Click the **View Application Events** button to open the Code Editor."},{"content":"This opens the ApplicationEvents.vb file.","pos":[1427,1468]},{"pos":[1478,1521],"content":"To log messages when the application starts","linkify":"To log messages when the application starts","nodes":[{"content":"To log messages when the application starts","pos":[0,43]}]},{"content":"Have the ApplicationEvents.vb file open in the Code Editor.","pos":[1531,1590]},{"content":"On the <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>MyApplication Events<ept id=\"p2\">**</ept>.","pos":[1591,1648],"source":" On the **General** menu, choose **MyApplication Events**."},{"pos":[1658,1707],"content":"On the <bpt id=\"p1\">**</bpt>Declarations<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Startup<ept id=\"p2\">**</ept>.","source":"On the **Declarations** menu, choose **Startup**."},{"content":"The application raises the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup&gt;</ph> event before the main application runs.","pos":[1718,1869],"source":"The application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup> event before the main application runs."},{"pos":[1879,1957],"content":"Add the <ph id=\"ph1\">`My.Application.Log.WriteEntry`</ph> method to the <ph id=\"ph2\">`Startup`</ph> event handler.","source":"Add the `My.Application.Log.WriteEntry` method to the `Startup` event handler."},{"pos":[1968,2159],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrMyApplicationLog#1<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/log-info/codesnippet/VisualBasic/how-to-log-messages-when-the-application-starts-or-shuts-down_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrMyApplicationLog#1](../../../../visual-basic/developing-apps/programming/log-info/codesnippet/VisualBasic/how-to-log-messages-when-the-application-starts-or-shuts-down_1.vb)]"},{"pos":[2169,2216],"content":"To log messages when the application shuts down","linkify":"To log messages when the application shuts down","nodes":[{"content":"To log messages when the application shuts down","pos":[0,47]}]},{"content":"Have the ApplicationEvents.vb file open in the Code Editor.","pos":[2226,2285]},{"content":"On the <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>MyApplication Events<ept id=\"p2\">**</ept>.","pos":[2286,2343],"source":" On the **General** menu, choose **MyApplication Events**."},{"pos":[2353,2403],"content":"On the <bpt id=\"p1\">**</bpt>Declarations<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Shutdown<ept id=\"p2\">**</ept>.","source":"On the **Declarations** menu, choose **Shutdown**."},{"content":"The application raises the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown&gt;</ph> event after the main application runs, but before it shuts down.","pos":[2414,2591],"source":"The application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown> event after the main application runs, but before it shuts down."},{"pos":[2601,2680],"content":"Add the <ph id=\"ph1\">`My.Application.Log.WriteEntry`</ph> method to the <ph id=\"ph2\">`Shutdown`</ph> event handler.","source":"Add the `My.Application.Log.WriteEntry` method to the `Shutdown` event handler."},{"pos":[2691,2882],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrMyApplicationLog#2<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/log-info/codesnippet/VisualBasic/how-to-log-messages-when-the-application-starts-or-shuts-down_2.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrMyApplicationLog#2](../../../../visual-basic/developing-apps/programming/log-info/codesnippet/VisualBasic/how-to-log-messages-when-the-application-starts-or-shuts-down_2.vb)]"},{"pos":[2891,2898],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"You can use the <bpt id=\"p1\">**</bpt>Project Designer<ept id=\"p1\">**</ept> to access the application events in the Code Editor.","pos":[2902,2991],"source":"You can use the **Project Designer** to access the application events in the Code Editor."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Application Page, Project Designer (Visual Basic)<ept id=\"p1\">](https://docs.microsoft.com/visualstudio/ide/reference/application-page-project-designer-visual-basic)</ept>.","pos":[2992,3172],"source":" For more information, see [Application Page, Project Designer (Visual Basic)](https://docs.microsoft.com/visualstudio/ide/reference/application-page-project-designer-visual-basic)."},{"pos":[3179,3370],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrMyApplicationLog#3<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/log-info/codesnippet/VisualBasic/how-to-log-messages-when-the-application-starts-or-shuts-down_3.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrMyApplicationLog#3](../../../../visual-basic/developing-apps/programming/log-info/codesnippet/VisualBasic/how-to-log-messages-when-the-application-starts-or-shuts-down_3.vb)]"},{"pos":[3379,3387],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.Logging.Log?displayProperty=fullName&gt;</ph>","pos":[3391,3456],"source":"<xref:Microsoft.VisualBasic.Logging.Log?displayProperty=fullName> "},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.Logging.Log.WriteEntry%2A&gt;</ph>","pos":[3461,3515],"source":"<xref:Microsoft.VisualBasic.Logging.Log.WriteEntry%2A> "},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.Logging.Log.WriteException%2A&gt;</ph>","pos":[3520,3578],"source":"<xref:Microsoft.VisualBasic.Logging.Log.WriteException%2A> "},{"content":"<bpt id=\"p1\">[</bpt>Application Page, Project Designer (Visual Basic)<ept id=\"p1\">](https://docs.microsoft.com/visualstudio/ide/reference/application-page-project-designer-visual-basic)</ept><ph id=\"ph1\"> </ph>","pos":[3583,3737],"source":"[Application Page, Project Designer (Visual Basic)](https://docs.microsoft.com/visualstudio/ide/reference/application-page-project-designer-visual-basic) "},{"content":"<bpt id=\"p1\">[</bpt>Working with Application Logs<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)</ept>","pos":[3741,3868],"source":"[Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)"}]}