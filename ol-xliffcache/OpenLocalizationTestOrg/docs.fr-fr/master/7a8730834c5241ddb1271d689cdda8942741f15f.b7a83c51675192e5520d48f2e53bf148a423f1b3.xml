{"content":"---\ntitle: \"Lifetime in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"static variables [Visual Basic], lifetime\"\n  - \"static variables [Visual Basic], Visual Basic\"\n  - \"declared elements [Visual Basic], lifetime\"\n  - \"Shared variable lifetime [Visual Basic]\"\n  - \"lifetime [Visual Basic], declared elements\"\n  - \"lifetime [Visual Basic], Visual Basic\"\n  - \"lifetime [Visual Basic]\"\nms.assetid: bd91e390-690a-469a-9946-8dca70bc14e7\n---\n# Lifetime in Visual Basic\nThe *lifetime* of a declared element is the period of time during which it is available for use. Variables are the only elements that have lifetime. For this purpose, the compiler treats procedure parameters and function returns as special cases of variables. The lifetime of a variable represents the period of time during which it can hold a value. Its value can change over its lifetime, but it always holds some value.  \n  \n## Different Lifetimes  \n A *member variable* (declared at module level, outside any procedure) typically has the same lifetime as the element in which it is declared. A nonshared variable declared in a class or structure exists as a separate copy for each instance of the class or structure in which it is declared. Each such variable has the same lifetime as its instance. However, a `Shared` variable has only a single lifetime, which lasts for the entire time your application is running.  \n  \n A *local variable* (declared inside a procedure) exists only while the procedure in which it is declared is running. This applies also to that procedure's parameters and to any function return. However, if that procedure calls other procedures, the local variables retain their values while the called procedures are running.  \n  \n## Beginning of Lifetime  \n A local variable's lifetime begins when control enters the procedure in which it is declared. Every local variable is initialized to the default value for its data type as soon as the procedure begins running. When the procedure encounters a `Dim` statement that specifies initial values, it sets those variables to those values, even if your code had already assigned other values to them.  \n  \n Each member of a structure variable is initialized as if it were a separate variable. Similarly, each element of an array variable is initialized individually.  \n  \n Variables declared within a block inside a procedure (such as a `For` loop) are initialized on entry to the procedure. These initializations take effect whether or not your code ever executes the block.  \n  \n## End of Lifetime  \n When a procedure terminates, the values of its local variables are not preserved, and Visual Basic reclaims their memory. The next time you call the procedure, all its local variables are created afresh and reinitialized.  \n  \n When an instance of a class or structure terminates, its nonshared variables lose their memory and their values. Each new instance of the class or structure creates and reinitializes its nonshared variables. However, `Shared` variables are preserved until your application stops running.  \n  \n## Extension of Lifetime  \n If you declare a local variable with the `Static` keyword, its lifetime is longer than the execution time of its procedure. The following table shows how the procedure declaration determines how long a `Static` variable exists.  \n  \n|Procedure location and sharing|Static variable lifetime begins|Static variable lifetime ends|  \n|------------------------------------|-------------------------------------|-----------------------------------|  \n|In a module (shared by default)|The first time the procedure is called|When your application stops running|  \n|In a class, `Shared` (procedure is not an instance member)|The first time the procedure is called either on a specific instance or on the class or structure name itself|When your application stops running|  \n|In an instance of a class, not `Shared` (procedure is an instance member)|The first time the procedure is called on the specific instance|When the instance is released for garbage collection (GC)|  \n  \n## Static Variables of the Same Name  \n You can declare static variables with the same name in more than one procedure. If you do this, the Visual Basic compiler considers each such variable to be a separate element. The initialization of one of these variables does not affect the values of the others. The same applies if you define a procedure with a set of overloads and declare a static variable with the same name in each overload.  \n  \n## Containing Elements for Static Variables  \n You can declare a static local variable within a class, that is, inside a procedure in that class. However, you cannot declare a static local variable within a structure, either as a structure member or as a local variable of a procedure within that structure.  \n  \n## Example  \n  \n### Description  \n The following example declares a variable with the [Static](../../../../visual-basic/language-reference/modifiers/static.md) keyword. (Note that you do not need the `Dim` keyword when the [Dim Statement](../../../../visual-basic/language-reference/statements/dim-statement.md) uses a modifier such as `Static`.)  \n  \n### Code  \n [!code-vb[VbVbalrKeywords#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrKeywords/VB/class7.vb#13)]  \n  \n### Comments  \n In the preceding example, the variable `applesSold` continues to exist after the procedure `runningTotal` returns to the calling code. The next time `runningTotal` is called, `applesSold` retains its previously calculated value.  \n  \n If `applesSold` had been declared without using `Static`, the previous accumulated values would not be preserved across calls to `runningTotal`. The next time `runningTotal` was called, `applesSold` would have been recreated and initialized to 0, and `runningTotal` would have simply returned the same value with which it was called.  \n  \n### Compiling the Code  \n You can initialize the value of a static local variable as part of its declaration. If you declare an array to be `Static`, you can initialize its rank (number of dimensions), the length of each dimension, and the values of the individual elements.  \n  \n### Security  \n In the preceding example, you can produce the same lifetime by declaring `applesSold` at module level. If you changed the scope of a variable this way, however, the procedure would no longer have exclusive access to it. Because other procedures could access `applesSold` and change its value, the running total could be unreliable and the code could be more difficult to maintain.  \n  \n## See also\n\n- [Shared](../../../../visual-basic/language-reference/modifiers/shared.md)\n- [Nothing](../../../../visual-basic/language-reference/nothing.md)\n- [Declared Element Names](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)\n- [References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)\n- [Scope in Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)\n- [Access levels in Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)\n- [Variables](../../../../visual-basic/programming-guide/language-features/variables/index.md)\n- [Variable Declaration](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)\n- [Troubleshooting Data Types](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md)\n- [Static](../../../../visual-basic/language-reference/modifiers/static.md)\n","nodes":[{"pos":[4,446],"embed":true,"restype":"x-metadata","content":"title: \"Lifetime in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"static variables [Visual Basic], lifetime\"\n  - \"static variables [Visual Basic], Visual Basic\"\n  - \"declared elements [Visual Basic], lifetime\"\n  - \"Shared variable lifetime [Visual Basic]\"\n  - \"lifetime [Visual Basic], declared elements\"\n  - \"lifetime [Visual Basic], Visual Basic\"\n  - \"lifetime [Visual Basic]\"\nms.assetid: bd91e390-690a-469a-9946-8dca70bc14e7","nodes":[{"content":"Lifetime in Visual Basic","nodes":[{"pos":[0,24],"content":"Lifetime in Visual Basic","nodes":[{"content":"Lifetime in Visual Basic","pos":[0,24]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[453,477],"content":"Lifetime in Visual Basic","linkify":"Lifetime in Visual Basic","nodes":[{"content":"Lifetime in Visual Basic","pos":[0,24]}]},{"content":"The <bpt id=\"p1\">*</bpt>lifetime<ept id=\"p1\">*</ept> of a declared element is the period of time during which it is available for use.","pos":[478,574],"source":"The *lifetime* of a declared element is the period of time during which it is available for use."},{"content":"Variables are the only elements that have lifetime.","pos":[575,626]},{"content":"For this purpose, the compiler treats procedure parameters and function returns as special cases of variables.","pos":[627,737]},{"content":"The lifetime of a variable represents the period of time during which it can hold a value.","pos":[738,828]},{"content":"Its value can change over its lifetime, but it always holds some value.","pos":[829,900]},{"pos":[909,928],"content":"Different Lifetimes","linkify":"Different Lifetimes","nodes":[{"content":"Different Lifetimes","pos":[0,19]}]},{"content":"A <bpt id=\"p1\">*</bpt>member variable<ept id=\"p1\">*</ept> (declared at module level, outside any procedure) typically has the same lifetime as the element in which it is declared.","pos":[932,1073],"source":"A *member variable* (declared at module level, outside any procedure) typically has the same lifetime as the element in which it is declared."},{"content":"A nonshared variable declared in a class or structure exists as a separate copy for each instance of the class or structure in which it is declared.","pos":[1074,1222]},{"content":"Each such variable has the same lifetime as its instance.","pos":[1223,1280]},{"content":"However, a <ph id=\"ph1\">`Shared`</ph> variable has only a single lifetime, which lasts for the entire time your application is running.","pos":[1281,1398],"source":" However, a `Shared` variable has only a single lifetime, which lasts for the entire time your application is running."},{"content":"A <bpt id=\"p1\">*</bpt>local variable<ept id=\"p1\">*</ept> (declared inside a procedure) exists only while the procedure in which it is declared is running.","pos":[1405,1521],"source":"A *local variable* (declared inside a procedure) exists only while the procedure in which it is declared is running."},{"content":"This applies also to that procedure's parameters and to any function return.","pos":[1522,1598]},{"content":"However, if that procedure calls other procedures, the local variables retain their values while the called procedures are running.","pos":[1599,1730]},{"pos":[1739,1760],"content":"Beginning of Lifetime","linkify":"Beginning of Lifetime","nodes":[{"content":"Beginning of Lifetime","pos":[0,21]}]},{"content":"A local variable's lifetime begins when control enters the procedure in which it is declared.","pos":[1764,1857]},{"content":"Every local variable is initialized to the default value for its data type as soon as the procedure begins running.","pos":[1858,1973]},{"content":"When the procedure encounters a <ph id=\"ph1\">`Dim`</ph> statement that specifies initial values, it sets those variables to those values, even if your code had already assigned other values to them.","pos":[1974,2154],"source":" When the procedure encounters a `Dim` statement that specifies initial values, it sets those variables to those values, even if your code had already assigned other values to them."},{"content":"Each member of a structure variable is initialized as if it were a separate variable.","pos":[2161,2246]},{"content":"Similarly, each element of an array variable is initialized individually.","pos":[2247,2320]},{"content":"Variables declared within a block inside a procedure (such as a <ph id=\"ph1\">`For`</ph> loop) are initialized on entry to the procedure.","pos":[2327,2445],"source":"Variables declared within a block inside a procedure (such as a `For` loop) are initialized on entry to the procedure."},{"content":"These initializations take effect whether or not your code ever executes the block.","pos":[2446,2529]},{"pos":[2538,2553],"content":"End of Lifetime","linkify":"End of Lifetime","nodes":[{"content":"End of Lifetime","pos":[0,15]}]},{"content":"When a procedure terminates, the values of its local variables are not preserved, and Visual Basic reclaims their memory.","pos":[2557,2678]},{"content":"The next time you call the procedure, all its local variables are created afresh and reinitialized.","pos":[2679,2778]},{"content":"When an instance of a class or structure terminates, its nonshared variables lose their memory and their values.","pos":[2785,2897]},{"content":"Each new instance of the class or structure creates and reinitializes its nonshared variables.","pos":[2898,2992]},{"content":"However, <ph id=\"ph1\">`Shared`</ph> variables are preserved until your application stops running.","pos":[2993,3072],"source":" However, `Shared` variables are preserved until your application stops running."},{"pos":[3081,3102],"content":"Extension of Lifetime","linkify":"Extension of Lifetime","nodes":[{"content":"Extension of Lifetime","pos":[0,21]}]},{"content":"If you declare a local variable with the <ph id=\"ph1\">`Static`</ph> keyword, its lifetime is longer than the execution time of its procedure.","pos":[3106,3229],"source":"If you declare a local variable with the `Static` keyword, its lifetime is longer than the execution time of its procedure."},{"content":"The following table shows how the procedure declaration determines how long a <ph id=\"ph1\">`Static`</ph> variable exists.","pos":[3230,3333],"source":" The following table shows how the procedure declaration determines how long a `Static` variable exists."},{"content":"Procedure location and sharing","pos":[3340,3370]},{"content":"Static variable lifetime begins","pos":[3371,3402]},{"content":"Static variable lifetime ends","pos":[3403,3432]},{"content":"In a module (shared by default)","pos":[3552,3583]},{"content":"The first time the procedure is called","pos":[3584,3622]},{"content":"When your application stops running","pos":[3623,3658]},{"pos":[3663,3721],"content":"In a class, <ph id=\"ph1\">`Shared`</ph> (procedure is not an instance member)","source":"In a class, `Shared` (procedure is not an instance member)"},{"content":"The first time the procedure is called either on a specific instance or on the class or structure name itself","pos":[3722,3831]},{"content":"When your application stops running","pos":[3832,3867]},{"pos":[3872,3945],"content":"In an instance of a class, not <ph id=\"ph1\">`Shared`</ph> (procedure is an instance member)","source":"In an instance of a class, not `Shared` (procedure is an instance member)"},{"content":"The first time the procedure is called on the specific instance","pos":[3946,4009]},{"content":"When the instance is released for garbage collection (GC)","pos":[4010,4067]},{"pos":[4077,4110],"content":"Static Variables of the Same Name","linkify":"Static Variables of the Same Name","nodes":[{"content":"Static Variables of the Same Name","pos":[0,33]}]},{"content":"You can declare static variables with the same name in more than one procedure.","pos":[4114,4193]},{"content":"If you do this, the Visual Basic compiler considers each such variable to be a separate element.","pos":[4194,4290]},{"content":"The initialization of one of these variables does not affect the values of the others.","pos":[4291,4377]},{"content":"The same applies if you define a procedure with a set of overloads and declare a static variable with the same name in each overload.","pos":[4378,4511]},{"pos":[4520,4560],"content":"Containing Elements for Static Variables","linkify":"Containing Elements for Static Variables","nodes":[{"content":"Containing Elements for Static Variables","pos":[0,40]}]},{"content":"You can declare a static local variable within a class, that is, inside a procedure in that class.","pos":[4564,4662]},{"content":"However, you cannot declare a static local variable within a structure, either as a structure member or as a local variable of a procedure within that structure.","pos":[4663,4824]},{"pos":[4833,4840],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4850,4861],"content":"Description","linkify":"Description","nodes":[{"content":"Description","pos":[0,11]}]},{"content":"The following example declares a variable with the <bpt id=\"p1\">[</bpt>Static<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/static.md)</ept> keyword.","pos":[4865,4998],"source":"The following example declares a variable with the [Static](../../../../visual-basic/language-reference/modifiers/static.md) keyword."},{"content":"(Note that you do not need the <ph id=\"ph1\">`Dim`</ph> keyword when the <bpt id=\"p1\">[</bpt>Dim Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/dim-statement.md)</ept> uses a modifier such as <ph id=\"ph2\">`Static`</ph>.)","pos":[4999,5176],"source":" (Note that you do not need the `Dim` keyword when the [Dim Statement](../../../../visual-basic/language-reference/statements/dim-statement.md) uses a modifier such as `Static`.)"},{"pos":[5186,5190],"content":"Code","linkify":"Code","nodes":[{"content":"Code","pos":[0,4]}]},{"pos":[5319,5327],"content":"Comments","linkify":"Comments","nodes":[{"content":"Comments","pos":[0,8]}]},{"content":"In the preceding example, the variable <ph id=\"ph1\">`applesSold`</ph> continues to exist after the procedure <ph id=\"ph2\">`runningTotal`</ph> returns to the calling code.","pos":[5331,5465],"source":"In the preceding example, the variable `applesSold` continues to exist after the procedure `runningTotal` returns to the calling code."},{"content":"The next time <ph id=\"ph1\">`runningTotal`</ph> is called, <ph id=\"ph2\">`applesSold`</ph> retains its previously calculated value.","pos":[5466,5559],"source":" The next time `runningTotal` is called, `applesSold` retains its previously calculated value."},{"content":"If <ph id=\"ph1\">`applesSold`</ph> had been declared without using <ph id=\"ph2\">`Static`</ph>, the previous accumulated values would not be preserved across calls to <ph id=\"ph3\">`runningTotal`</ph>.","pos":[5566,5710],"source":"If `applesSold` had been declared without using `Static`, the previous accumulated values would not be preserved across calls to `runningTotal`."},{"content":"The next time <ph id=\"ph1\">`runningTotal`</ph> was called, <ph id=\"ph2\">`applesSold`</ph> would have been recreated and initialized to 0, and <ph id=\"ph3\">`runningTotal`</ph> would have simply returned the same value with which it was called.","pos":[5711,5899],"source":" The next time `runningTotal` was called, `applesSold` would have been recreated and initialized to 0, and `runningTotal` would have simply returned the same value with which it was called."},{"pos":[5909,5927],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"You can initialize the value of a static local variable as part of its declaration.","pos":[5931,6014]},{"content":"If you declare an array to be <ph id=\"ph1\">`Static`</ph>, you can initialize its rank (number of dimensions), the length of each dimension, and the values of the individual elements.","pos":[6015,6179],"source":" If you declare an array to be `Static`, you can initialize its rank (number of dimensions), the length of each dimension, and the values of the individual elements."},{"pos":[6189,6197],"content":"Security","linkify":"Security","nodes":[{"content":"Security","pos":[0,8]}]},{"content":"In the preceding example, you can produce the same lifetime by declaring <ph id=\"ph1\">`applesSold`</ph> at module level.","pos":[6201,6303],"source":"In the preceding example, you can produce the same lifetime by declaring `applesSold` at module level."},{"content":"If you changed the scope of a variable this way, however, the procedure would no longer have exclusive access to it.","pos":[6304,6420]},{"content":"Because other procedures could access <ph id=\"ph1\">`applesSold`</ph> and change its value, the running total could be unreliable and the code could be more difficult to maintain.","pos":[6421,6581],"source":" Because other procedures could access `applesSold` and change its value, the running total could be unreliable and the code could be more difficult to maintain."},{"pos":[6590,6598],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6602,6675],"content":"<bpt id=\"p1\">[</bpt>Shared<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/shared.md)</ept>","source":"[Shared](../../../../visual-basic/language-reference/modifiers/shared.md)"},{"pos":[6678,6743],"content":"<bpt id=\"p1\">[</bpt>Nothing<ept id=\"p1\">](../../../../visual-basic/language-reference/nothing.md)</ept>","source":"[Nothing](../../../../visual-basic/language-reference/nothing.md)"},{"pos":[6746,6876],"content":"<bpt id=\"p1\">[</bpt>Declared Element Names<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)</ept>","source":"[Declared Element Names](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)"},{"pos":[6879,7027],"content":"<bpt id=\"p1\">[</bpt>References to Declared Elements<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)</ept>","source":"[References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)"},{"pos":[7030,7142],"content":"<bpt id=\"p1\">[</bpt>Scope in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)</ept>","source":"[Scope in Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)"},{"pos":[7145,7273],"content":"<bpt id=\"p1\">[</bpt>Access levels in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)</ept>","source":"[Access levels in Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)"},{"pos":[7276,7368],"content":"<bpt id=\"p1\">[</bpt>Variables<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/index.md)</ept>","source":"[Variables](../../../../visual-basic/programming-guide/language-features/variables/index.md)"},{"pos":[7371,7489],"content":"<bpt id=\"p1\">[</bpt>Variable Declaration<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)</ept>","source":"[Variable Declaration](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)"},{"pos":[7492,7623],"content":"<bpt id=\"p1\">[</bpt>Troubleshooting Data Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md)</ept>","source":"[Troubleshooting Data Types](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md)"},{"pos":[7626,7699],"content":"<bpt id=\"p1\">[</bpt>Static<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/static.md)</ept>","source":"[Static](../../../../visual-basic/language-reference/modifiers/static.md)"}]}