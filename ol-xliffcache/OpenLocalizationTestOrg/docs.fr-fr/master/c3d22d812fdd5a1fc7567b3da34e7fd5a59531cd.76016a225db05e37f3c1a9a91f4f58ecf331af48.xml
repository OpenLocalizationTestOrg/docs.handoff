{"content":"---\ntitle: \"How To: Enable WIF for a WCF Web Service Application\"\nms.date: \"03/30/2017\"\nms.assetid: bfc64b3d-64e9-4093-a6a4-72e933917af7\nauthor: \"BrucePerlerMS\"\n---\n# How To: Enable WIF for a WCF Web Service Application\n## Applies To  \n  \n-   Microsoft® Windows® Identity Foundation (WIF)  \n  \n-   Microsoft® Windows® Communication Foundation (WCF)  \n  \n## Summary  \n This How-To provides detailed step-by-step procedures for enabling WIF in a WCF web service. It also provides instructions for how to test the application to verify that the web service is correctly presenting claims when the application is run. This How-To does not have detailed instructions for creating a Security Token Service (STS), and instead uses the Development STS that comes with the Identity and Access tool. The Development STS does not perform real authentication and is intended for testing purposes only. You will need to install the Identity and Access tool to complete this How-To. It can be downloaded from the following location: [Identity and Access Tool](https://go.microsoft.com/fwlink/?LinkID=245849)  \n  \n## Contents  \n  \n-   Objectives  \n  \n-   Overview  \n  \n-   Summary of Steps  \n  \n-   Step 1 – Create a Simple WCF Service  \n  \n-   Step 2 – Create a Client Application for the WCF Service  \n  \n-   Step 3 – Test Your Solution  \n  \n## Objectives  \n  \n-   Create a WCF service that requires issued tokens  \n  \n-   Create a WCF client that requests a token from an STS and passes it to the WCF service  \n  \n## Overview  \n This How-To is intended to demonstrate how a developer can use federated authentication when developing WCF services. Some of the benefits of using federation in WCF services include:  \n  \n1.  Factoring authentication logic out of WCF service code  \n  \n2.  Re-using existing identity management solutions  \n  \n3.  Interoperability with other identity solutions  \n  \n4.  Flexibility and resilience to future changes  \n  \n WIF and the associated Identity and Access tool make it easier to develop and test a WCF service using federated authentication, as the following steps demonstrate.  \n  \n## Summary of Steps  \n  \n-   Step 1 – Create a Simple WCF Service  \n  \n-   Step 2 – Create a Client Application for the WCF Service  \n  \n-   Step 3 – Test Your Solution  \n  \n## Step 1 – Create a Simple WCF Service  \n In this step, you will create a new WCF service that uses the Development STS that is included with the Identity and Access tool.  \n  \n#### To create a simple WCF service  \n  \n1.  Start Visual Studio in elevated mode as administrator.  \n  \n2.  In Visual Studio, click **File**, click **New**, and then click **Project**.  \n  \n3.  In the **New Project** window, click **WCF Service Application**.  \n  \n4.  In **Name**, enter `TestService` and press **OK**.  \n  \n5.  Right-click the **TestService** project under **Solution Explorer**, then select **Identity and Access**.  \n  \n6.  The **Identity and Access** window appears. Under **Providers**, select **Test your application with the Local Development STS**, then click **Apply**. The Identity and Access Tool configures the service to use WIF and to outsource authentication to the local development STS (**LocalSTS**) by adding configuration elements to the *Web.config* file.  \n  \n7.  In the *Service1.svc.cs* file, add a `using` directive for the **System.Security.Claims** namespace and replace the existing code with the following, then save the file:  \n  \n    ```csharp  \n    public class Service1 : IService1  \n    {  \n        public string ComputeResponse(string input)  \n        {  \n            // Get the caller's identity from ClaimsPrincipal.Current  \n            ClaimsPrincipal claimsPrincipal = OperationContext.Current.ClaimsPrincipal;  \n  \n            // Start generating the output  \n            StringBuilder builder = new StringBuilder();  \n            builder.AppendLine(\"Computed by ClaimsAwareWebService\");  \n            builder.AppendLine(\"Input received from client:\" + input);  \n  \n            if (claimsPrincipal != null)  \n            {  \n                // Display the claims from the caller. Do not use this code in a production application.  \n                ClaimsIdentity identity = claimsPrincipal.Identity as ClaimsIdentity;  \n                builder.AppendLine(\"Client Name:\" + identity.Name);  \n                builder.AppendLine(\"IsAuthenticated:\" + identity.IsAuthenticated);  \n                builder.AppendLine(\"The service received the following issued claims of the client:\");  \n  \n                // Iterate over the caller’s claims and append to the output  \n                foreach (Claim claim in claimsPrincipal.Claims)  \n                {  \n                    builder.AppendLine(\"ClaimType :\" + claim.Type + \"   ClaimValue:\" + claim.Value);  \n                }  \n            }  \n  \n            return builder.ToString();  \n        }  \n    }  \n    ```  \n  \n     The `ComputeResponse` method displays the properties of various claims that are issued by **LocalSTS**.  \n  \n8.  In the *IService1.cs* file, replace the existing code with the following, then save the file:  \n  \n    ```csharp  \n    [ServiceContract]  \n    public interface IService1  \n    {  \n        [OperationContract]  \n        string ComputeResponse(string input);  \n    }  \n    ```  \n  \n9. Build the project.  \n  \n10. Press **Ctrl-F5** to run the service without starting the debugger. A Web page should open for the service and you can verify that **LocalSTS** is running by looking in the notification area (system tray).  \n  \n    > [!IMPORTANT]\n    >  Both **TestService** and **LocalSTS** must be running when you add the service reference to the client application in the next step.  \n  \n## Step 2 – Create a Client Application for the WCF Service  \n In this step, you will create a console application that uses the Development STS to authenticate with the WCF service you created in the previous step.  \n  \n#### To create a client application  \n  \n1.  In Visual Studio, right-click on the solution, click **Add**, and then click **New Project**.  \n  \n2.  In the **Add New Project** window, select **Console Application** from the **Visual C#** templates list, enter `Client`, and then press **OK**. The new project will be created in your solution folder.  \n  \n3.  Right-click on **References** under the **Client** project, and then click **Add Service Reference**.  \n  \n4.  In the **Add Service Reference** window, click the drop-down arrow on the **Discover** button and click **Services in Solution**. The **Address** will automatically populate with the WCF service you created earlier, and the **Namespace** will be set to **ServiceReference1**. Click **OK**.  \n  \n    > [!IMPORTANT]\n    >  Both **TestService** and **LocalSTS** must be running when you add the service reference to the client.  \n  \n5.  Visual Studio will generate proxy classes for the WCF service, and add all of the necessary reference information. It will also add elements to the *App.config* file to configure the client to get a token from the STS to authenticate with the service. When this process is finished, the **Program.cs** file will open. Add a `using` directive for **System.ServiceModel** and another for **Client.ServiceReference1**, replace the **Main** method with the following code, then save the file:  \n  \n    ```csharp  \n    static void Main(string[] args)  \n    {  \n        // Create the client for the service  \n        Service1Client client = new Service1Client();  \n        Console.WriteLine(\"-------------WCF Client Application--------------\\n\");  \n  \n        while (!ShouldQuitApplication())  \n        {  \n            try  \n            {  \n                Console.WriteLine(client.ComputeResponse(\"Hello World\"));  \n            }  \n            catch (CommunicationException e)  \n            {  \n                Console.WriteLine(e.Message);  \n                Console.WriteLine(e.StackTrace);  \n                Exception ex = e.InnerException;  \n                while (ex != null)  \n                {  \n                    Console.WriteLine(\"===========================\");  \n                    Console.WriteLine(ex.Message);  \n                    Console.WriteLine(ex.StackTrace);  \n                    ex = ex.InnerException;  \n                }  \n            }  \n            catch (TimeoutException)  \n            {  \n                Console.WriteLine(\"Timed out...\");  \n            }  \n            catch (Exception e)  \n            {  \n                Console.WriteLine(\"An unexpected exception occurred.\");  \n                Console.WriteLine(e.StackTrace);  \n            }  \n        }  \n  \n        client.Close();  \n  \n        if (client != null)  \n        {  \n            client.Abort();  \n        }  \n    }  \n  \n    static bool ShouldQuitApplication()  \n    {  \n        Console.WriteLine(\"---------------------------------------------------------------------\");  \n        Console.WriteLine(\"Press Enter key to invoke service, any other key to quit application:\");  \n        Console.WriteLine(\"----------------------------------------------------------------------\");  \n  \n        ConsoleKeyInfo keyInfo = Console.ReadKey();  \n        if (keyInfo.Key == ConsoleKey.Enter)  \n            return false;  \n        return true;  \n    }  \n    ```  \n  \n6.  Open the *App.config* file and add the following XML as the first child element under the `<system.serviceModel>` element, then save the file:  \n  \n    ```xml  \n    <behaviors>  \n       <endpointBehaviors>  \n         <behavior>  \n           <clientCredentials>  \n             <serviceCertificate>  \n               <authentication certificateValidationMode=\"None\"/>  \n             </serviceCertificate>  \n           </clientCredentials>  \n         </behavior>  \n       </endpointBehaviors>  \n     </behaviors>  \n    ```  \n  \n     This disables certificate validation.  \n  \n7.  Right-click the **TestService** solution and click on **Set StartUp Projects**. The **Startup Project** property page opens. In the **Startup Project** property page, select **Multiple startup projects** then click in the **Action** field for each project and select **Start** from the drop-down menu. Click **OK** to save the settings.  \n  \n8.  Build the solution.  \n  \n## Step 3 – Test Your Solution  \n In this step you will test your WIF-enabled WCF application and verify that claims are presented.  \n  \n#### To test your WIF-enabled WCF application for claims  \n  \n1.  Press **F5** to build and run the application. You should be presented with a console window, and the following text: **Press Enter key to invoke service, any other key to quit application:**  \n  \n2.  Press **Enter**, and the following claims information should appear in the console:  \n  \n    ```  \n    Computed by Service1  \n    Input received from client: Hello World  \n    Client Name: Terry  \n    IsAuthenticated: True  \n    The service received the following issued claims of the client:  \n    ClaimType :http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name    ClaimValue:Terry  \n    ClaimType :http://schema.xmlsoap.org/ws/2005/05/identity/claims/surname    ClaimValue:Adams  \n    ClaimType :http://schemas.microsoft.com/ws/2008/06/identity/claims/role    ClaimValue:developer  \n    ClaimType :http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress    ClaimValue:terry@contoso.com  \n    ```  \n  \n    > [!IMPORTANT]\n    >  Both **TestService** and **LocalSTS** must be running before you press **Enter**. A Web page should open for the service and you can verify that **LocalSTS** is running by looking in the notification area (system tray).  \n  \n3.  If these claims appear in the console, you have successfully authenticated with the STS to display claims from the WCF service.\n","nodes":[{"pos":[4,160],"embed":true,"restype":"x-metadata","content":"title: \"How To: Enable WIF for a WCF Web Service Application\"\nms.date: \"03/30/2017\"\nms.assetid: bfc64b3d-64e9-4093-a6a4-72e933917af7\nauthor: \"BrucePerlerMS\"","nodes":[{"content":"How To: Enable WIF for a WCF Web Service Application","nodes":[{"pos":[0,52],"content":"How To: Enable WIF for a WCF Web Service Application","nodes":[{"content":"How To: Enable WIF for a WCF Web Service Application","pos":[0,52]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[167,219],"content":"How To: Enable WIF for a WCF Web Service Application","linkify":"How To: Enable WIF for a WCF Web Service Application","nodes":[{"content":"How To: Enable WIF for a WCF Web Service Application","pos":[0,52]}]},{"pos":[223,233],"content":"Applies To","linkify":"Applies To","nodes":[{"content":"Applies To","pos":[0,10]}]},{"content":"Microsoft® Windows® Identity Foundation (WIF)","pos":[243,288]},{"content":"Microsoft® Windows® Communication Foundation (WCF)","pos":[298,348]},{"pos":[357,364],"content":"Summary","linkify":"Summary","nodes":[{"content":"Summary","pos":[0,7]}]},{"content":"This How-To provides detailed step-by-step procedures for enabling WIF in a WCF web service.","pos":[368,460]},{"content":"It also provides instructions for how to test the application to verify that the web service is correctly presenting claims when the application is run.","pos":[461,613]},{"content":"This How-To does not have detailed instructions for creating a Security Token Service (STS), and instead uses the Development STS that comes with the Identity and Access tool.","pos":[614,789]},{"content":"The Development STS does not perform real authentication and is intended for testing purposes only.","pos":[790,889]},{"content":"You will need to install the Identity and Access tool to complete this How-To.","pos":[890,968]},{"content":"It can be downloaded from the following location: <bpt id=\"p1\">[</bpt>Identity and Access Tool<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=245849)</ept>","pos":[969,1093],"source":" It can be downloaded from the following location: [Identity and Access Tool](https://go.microsoft.com/fwlink/?LinkID=245849)"},{"pos":[1102,1110],"content":"Contents","linkify":"Contents","nodes":[{"content":"Contents","pos":[0,8]}]},{"content":"Objectives","pos":[1120,1130]},{"content":"Overview","pos":[1140,1148]},{"content":"Summary of Steps","pos":[1158,1174]},{"content":"Step 1 – Create a Simple WCF Service","pos":[1184,1220]},{"content":"Step 2 – Create a Client Application for the WCF Service","pos":[1230,1286]},{"content":"Step 3 – Test Your Solution","pos":[1296,1323]},{"pos":[1332,1342],"content":"Objectives","linkify":"Objectives","nodes":[{"content":"Objectives","pos":[0,10]}]},{"content":"Create a WCF service that requires issued tokens","pos":[1352,1400]},{"content":"Create a WCF client that requests a token from an STS and passes it to the WCF service","pos":[1410,1496]},{"pos":[1505,1513],"content":"Overview","linkify":"Overview","nodes":[{"content":"Overview","pos":[0,8]}]},{"content":"This How-To is intended to demonstrate how a developer can use federated authentication when developing WCF services.","pos":[1517,1634]},{"content":"Some of the benefits of using federation in WCF services include:","pos":[1635,1700]},{"content":"Factoring authentication logic out of WCF service code","pos":[1710,1764]},{"content":"Re-using existing identity management solutions","pos":[1774,1821]},{"content":"Interoperability with other identity solutions","pos":[1831,1877]},{"content":"Flexibility and resilience to future changes","pos":[1887,1931]},{"content":"WIF and the associated Identity and Access tool make it easier to develop and test a WCF service using federated authentication, as the following steps demonstrate.","pos":[1938,2102]},{"pos":[2111,2127],"content":"Summary of Steps","linkify":"Summary of Steps","nodes":[{"content":"Summary of Steps","pos":[0,16]}]},{"content":"Step 1 – Create a Simple WCF Service","pos":[2137,2173]},{"content":"Step 2 – Create a Client Application for the WCF Service","pos":[2183,2239]},{"content":"Step 3 – Test Your Solution","pos":[2249,2276]},{"pos":[2285,2321],"content":"Step 1 – Create a Simple WCF Service","linkify":"Step 1 – Create a Simple WCF Service","nodes":[{"content":"Step 1 – Create a Simple WCF Service","pos":[0,36]}]},{"content":"In this step, you will create a new WCF service that uses the Development STS that is included with the Identity and Access tool.","pos":[2325,2454]},{"pos":[2465,2495],"content":"To create a simple WCF service","linkify":"To create a simple WCF service","nodes":[{"content":"To create a simple WCF service","pos":[0,30]}]},{"content":"Start Visual Studio in elevated mode as administrator.","pos":[2505,2559]},{"pos":[2569,2645],"content":"In Visual Studio, click <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"In Visual Studio, click **File**, click **New**, and then click **Project**."},{"pos":[2655,2720],"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> window, click <bpt id=\"p2\">**</bpt>WCF Service Application<ept id=\"p2\">**</ept>.","source":"In the **New Project** window, click **WCF Service Application**."},{"pos":[2730,2780],"content":"In <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>, enter <ph id=\"ph1\">`TestService`</ph> and press <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"In **Name**, enter `TestService` and press **OK**."},{"pos":[2790,2895],"content":"Right-click the <bpt id=\"p1\">**</bpt>TestService<ept id=\"p1\">**</ept> project under <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept>, then select <bpt id=\"p3\">**</bpt>Identity and Access<ept id=\"p3\">**</ept>.","source":"Right-click the **TestService** project under **Solution Explorer**, then select **Identity and Access**."},{"content":"The <bpt id=\"p1\">**</bpt>Identity and Access<ept id=\"p1\">**</ept> window appears.","pos":[2905,2948],"source":"The **Identity and Access** window appears."},{"content":"Under <bpt id=\"p1\">**</bpt>Providers<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Test your application with the Local Development STS<ept id=\"p2\">**</ept>, then click <bpt id=\"p3\">**</bpt>Apply<ept id=\"p3\">**</ept>.","pos":[2949,3056],"source":" Under **Providers**, select **Test your application with the Local Development STS**, then click **Apply**."},{"content":"The Identity and Access Tool configures the service to use WIF and to outsource authentication to the local development STS (<bpt id=\"p1\">**</bpt>LocalSTS<ept id=\"p1\">**</ept>) by adding configuration elements to the <bpt id=\"p2\">*</bpt>Web.config<ept id=\"p2\">*</ept> file.","pos":[3057,3254],"source":" The Identity and Access Tool configures the service to use WIF and to outsource authentication to the local development STS (**LocalSTS**) by adding configuration elements to the *Web.config* file."},{"pos":[3264,3433],"content":"In the <bpt id=\"p1\">*</bpt>Service1.svc.cs<ept id=\"p1\">*</ept> file, add a <ph id=\"ph1\">`using`</ph> directive for the <bpt id=\"p2\">**</bpt>System.Security.Claims<ept id=\"p2\">**</ept> namespace and replace the existing code with the following, then save the file:","source":"In the *Service1.svc.cs* file, add a `using` directive for the **System.Security.Claims** namespace and replace the existing code with the following, then save the file:"},{"pos":[4888,4991],"content":"The <ph id=\"ph1\">`ComputeResponse`</ph> method displays the properties of various claims that are issued by <bpt id=\"p1\">**</bpt>LocalSTS<ept id=\"p1\">**</ept>.","source":"The `ComputeResponse` method displays the properties of various claims that are issued by **LocalSTS**."},{"pos":[5001,5094],"content":"In the <bpt id=\"p1\">*</bpt>IService1.cs<ept id=\"p1\">*</ept> file, replace the existing code with the following, then save the file:","source":"In the *IService1.cs* file, replace the existing code with the following, then save the file:"},{"content":"Build the project.","pos":[5283,5301]},{"content":"Press <bpt id=\"p1\">**</bpt>Ctrl-F5<ept id=\"p1\">**</ept> to run the service without starting the debugger.","pos":[5311,5378],"source":"Press **Ctrl-F5** to run the service without starting the debugger."},{"content":"A Web page should open for the service and you can verify that <bpt id=\"p1\">**</bpt>LocalSTS<ept id=\"p1\">**</ept> is running by looking in the notification area (system tray).","pos":[5379,5516],"source":" A Web page should open for the service and you can verify that **LocalSTS** is running by looking in the notification area (system tray)."},{"pos":[5528,5680],"content":"[!IMPORTANT]\nBoth **TestService** and **LocalSTS** must be running when you add the service reference to the client application in the next step.","leadings":["","    >  "],"nodes":[{"content":"Both <bpt id=\"p1\">**</bpt>TestService<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>LocalSTS<ept id=\"p2\">**</ept> must be running when you add the service reference to the client application in the next step.","pos":[13,145],"source":"Both **TestService** and **LocalSTS** must be running when you add the service reference to the client application in the next step."}]},{"pos":[5689,5745],"content":"Step 2 – Create a Client Application for the WCF Service","linkify":"Step 2 – Create a Client Application for the WCF Service","nodes":[{"content":"Step 2 – Create a Client Application for the WCF Service","pos":[0,56]}]},{"content":"In this step, you will create a console application that uses the Development STS to authenticate with the WCF service you created in the previous step.","pos":[5749,5901]},{"pos":[5912,5942],"content":"To create a client application","linkify":"To create a client application","nodes":[{"content":"To create a client application","pos":[0,30]}]},{"pos":[5952,6045],"content":"In Visual Studio, right-click on the solution, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>New Project<ept id=\"p2\">**</ept>.","source":"In Visual Studio, right-click on the solution, click **Add**, and then click **New Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>Add New Project<ept id=\"p1\">**</ept> window, select <bpt id=\"p2\">**</bpt>Console Application<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Visual C#<ept id=\"p3\">**</ept> templates list, enter <ph id=\"ph1\">`Client`</ph>, and then press <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept>.","pos":[6055,6198],"source":"In the **Add New Project** window, select **Console Application** from the **Visual C#** templates list, enter `Client`, and then press **OK**."},{"content":"The new project will be created in your solution folder.","pos":[6199,6255]},{"pos":[6265,6366],"content":"Right-click on <bpt id=\"p1\">**</bpt>References<ept id=\"p1\">**</ept> under the <bpt id=\"p2\">**</bpt>Client<ept id=\"p2\">**</ept> project, and then click <bpt id=\"p3\">**</bpt>Add Service Reference<ept id=\"p3\">**</ept>.","source":"Right-click on **References** under the **Client** project, and then click **Add Service Reference**."},{"content":"In the <bpt id=\"p1\">**</bpt>Add Service Reference<ept id=\"p1\">**</ept> window, click the drop-down arrow on the <bpt id=\"p2\">**</bpt>Discover<ept id=\"p2\">**</ept> button and click <bpt id=\"p3\">**</bpt>Services in Solution<ept id=\"p3\">**</ept>.","pos":[6376,6505],"source":"In the **Add Service Reference** window, click the drop-down arrow on the **Discover** button and click **Services in Solution**."},{"content":"The <bpt id=\"p1\">**</bpt>Address<ept id=\"p1\">**</ept> will automatically populate with the WCF service you created earlier, and the <bpt id=\"p2\">**</bpt>Namespace<ept id=\"p2\">**</ept> will be set to <bpt id=\"p3\">**</bpt>ServiceReference1<ept id=\"p3\">**</ept>.","pos":[6506,6651],"source":" The **Address** will automatically populate with the WCF service you created earlier, and the **Namespace** will be set to **ServiceReference1**."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[6652,6665],"source":" Click **OK**."},{"pos":[6677,6800],"content":"[!IMPORTANT]\nBoth **TestService** and **LocalSTS** must be running when you add the service reference to the client.","leadings":["","    >  "],"nodes":[{"content":"Both <bpt id=\"p1\">**</bpt>TestService<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>LocalSTS<ept id=\"p2\">**</ept> must be running when you add the service reference to the client.","pos":[13,116],"source":"Both **TestService** and **LocalSTS** must be running when you add the service reference to the client."}]},{"content":"Visual Studio will generate proxy classes for the WCF service, and add all of the necessary reference information.","pos":[6810,6924]},{"content":"It will also add elements to the <bpt id=\"p1\">*</bpt>App.config<ept id=\"p1\">*</ept> file to configure the client to get a token from the STS to authenticate with the service.","pos":[6925,7061],"source":" It will also add elements to the *App.config* file to configure the client to get a token from the STS to authenticate with the service."},{"content":"When this process is finished, the <bpt id=\"p1\">**</bpt>Program.cs<ept id=\"p1\">**</ept> file will open.","pos":[7062,7127],"source":" When this process is finished, the **Program.cs** file will open."},{"content":"Add a <ph id=\"ph1\">`using`</ph> directive for <bpt id=\"p1\">**</bpt>System.ServiceModel<ept id=\"p1\">**</ept> and another for <bpt id=\"p2\">**</bpt>Client.ServiceReference1<ept id=\"p2\">**</ept>, replace the <bpt id=\"p3\">**</bpt>Main<ept id=\"p3\">**</ept> method with the following code, then save the file:","pos":[7128,7298],"source":" Add a `using` directive for **System.ServiceModel** and another for **Client.ServiceReference1**, replace the **Main** method with the following code, then save the file:"},{"pos":[9261,9403],"content":"Open the <bpt id=\"p1\">*</bpt>App.config<ept id=\"p1\">*</ept> file and add the following XML as the first child element under the <ph id=\"ph1\">`&lt;system.serviceModel&gt;`</ph> element, then save the file:","source":"Open the *App.config* file and add the following XML as the first child element under the `<system.serviceModel>` element, then save the file:"},{"content":"This disables certificate validation.","pos":[9790,9827]},{"content":"Right-click the <bpt id=\"p1\">**</bpt>TestService<ept id=\"p1\">**</ept> solution and click on <bpt id=\"p2\">**</bpt>Set StartUp Projects<ept id=\"p2\">**</ept>.","pos":[9837,9916],"source":"Right-click the **TestService** solution and click on **Set StartUp Projects**."},{"content":"The <bpt id=\"p1\">**</bpt>Startup Project<ept id=\"p1\">**</ept> property page opens.","pos":[9917,9961],"source":" The **Startup Project** property page opens."},{"content":"In the <bpt id=\"p1\">**</bpt>Startup Project<ept id=\"p1\">**</ept> property page, select <bpt id=\"p2\">**</bpt>Multiple startup projects<ept id=\"p2\">**</ept> then click in the <bpt id=\"p3\">**</bpt>Action<ept id=\"p3\">**</ept> field for each project and select <bpt id=\"p4\">**</bpt>Start<ept id=\"p4\">**</ept> from the drop-down menu.","pos":[9962,10138],"source":" In the **Startup Project** property page, select **Multiple startup projects** then click in the **Action** field for each project and select **Start** from the drop-down menu."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to save the settings.","pos":[10139,10173],"source":" Click **OK** to save the settings."},{"content":"Build the solution.","pos":[10183,10202]},{"pos":[10211,10238],"content":"Step 3 – Test Your Solution","linkify":"Step 3 – Test Your Solution","nodes":[{"content":"Step 3 – Test Your Solution","pos":[0,27]}]},{"content":"In this step you will test your WIF-enabled WCF application and verify that claims are presented.","pos":[10242,10339]},{"pos":[10350,10401],"content":"To test your WIF-enabled WCF application for claims","linkify":"To test your WIF-enabled WCF application for claims","nodes":[{"content":"To test your WIF-enabled WCF application for claims","pos":[0,51]}]},{"content":"Press <bpt id=\"p1\">**</bpt>F5<ept id=\"p1\">**</ept> to build and run the application.","pos":[10411,10457],"source":"Press **F5** to build and run the application."},{"content":"You should be presented with a console window, and the following text: <bpt id=\"p1\">**</bpt>Press Enter key to invoke service, any other key to quit application:<ept id=\"p1\">**</ept>","pos":[10458,10602],"source":" You should be presented with a console window, and the following text: **Press Enter key to invoke service, any other key to quit application:**"},{"pos":[10612,10695],"content":"Press <bpt id=\"p1\">**</bpt>Enter<ept id=\"p1\">**</ept>, and the following claims information should appear in the console:","source":"Press **Enter**, and the following claims information should appear in the console:"},{"pos":[11338,11577],"content":"[!IMPORTANT]\nBoth **TestService** and **LocalSTS** must be running before you press **Enter**. A Web page should open for the service and you can verify that **LocalSTS** is running by looking in the notification area (system tray).","leadings":["","    >  "],"nodes":[{"content":"Both **TestService** and **LocalSTS** must be running before you press **Enter**. A Web page should open for the service and you can verify that **LocalSTS** is running by looking in the notification area (system tray).","pos":[13,232],"nodes":[{"content":"Both <bpt id=\"p1\">**</bpt>TestService<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>LocalSTS<ept id=\"p2\">**</ept> must be running before you press <bpt id=\"p3\">**</bpt>Enter<ept id=\"p3\">**</ept>.","pos":[0,81],"source":"Both **TestService** and **LocalSTS** must be running before you press **Enter**."},{"content":"A Web page should open for the service and you can verify that <bpt id=\"p1\">**</bpt>LocalSTS<ept id=\"p1\">**</ept> is running by looking in the notification area (system tray).","pos":[82,219],"source":" A Web page should open for the service and you can verify that **LocalSTS** is running by looking in the notification area (system tray)."}]}]},{"content":"If these claims appear in the console, you have successfully authenticated with the STS to display claims from the WCF service.","pos":[11587,11714]}]}