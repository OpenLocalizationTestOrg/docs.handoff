{"content":"---\ntitle: \"GetCORSystemDirectory Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"GetCORSystemDirectory\"\napi_location: \n  - \"mscoree.dll\"\n  - \"mscoreei.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"GetCORSystemDirectory\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetCORSystemDirectory function [.NET Framework hosting]\"\nms.assetid: 3dcd16a7-dafc-4ca8-b5cd-20ffb37db91d\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 21\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# GetCORSystemDirectory Function\nReturns the installation directory of the common language runtime (CLR) that is loaded into the process. The installation directory is fully qualified, for example, \"c:\\windows\\microsoft.net\\framework\\v1.0.3705\".  \n  \n This function is deprecated. It is superseded by the [ICLRRuntimeInfo::GetRuntimeDirectory](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-getruntimedirectory-method.md) method provided in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)].  \n  \n## Syntax  \n  \n```  \nHRESULT GetCORSystemDirectory (   \n    [out] LPWSTR  pbuffer,     \n    [in]  DWORD   cchBuffer,   \n    [out] DWORD*  dwlength  \n);   \n```  \n  \n#### Parameters  \n `pbuffer`  \n [out] A buffer in which the runtime returns a string that contains the fully qualified name of the installation directory for the runtime that is loaded into the process. If the runtime has not yet been loaded into the process, the function returns the appropriate directory information for the latest version of the runtime installed on the computer.  \n  \n `cchBuffer`  \n [in] The size, in bytes, of `pbuffer`.  \n  \n `dwLength`  \n [out] The number of characters returned in `pbuffer`.  \n  \n## Remarks  \n  \n> [!CAUTION]\n>  Do not use this function in processes that are running version 4 of the CLR. If an earlier version of the CLR is installed on the computer, this function returns the installation directory for that version.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See Also  \n [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)\n","nodes":[{"pos":[12,59],"content":"GetCORSystemDirectory Function | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"GetCORSystemDirectory Function | Microsoft Docs","pos":[0,47]}]},{"pos":[657,687],"content":"GetCORSystemDirectory Function","linkify":"GetCORSystemDirectory Function","nodes":[{"content":"GetCORSystemDirectory Function","pos":[0,30]}]},{"content":"Returns the installation directory of the common language runtime (CLR) that is loaded into the process.","pos":[688,792]},{"content":"The installation directory is fully qualified, for example, \"c:\\windows\\microsoft.net\\framework\\v1.0.3705\".","pos":[793,900]},{"content":"This function is deprecated.","pos":[907,935]},{"content":"It is superseded by the <bpt id=\"p1\">[</bpt>ICLRRuntimeInfo::GetRuntimeDirectory<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-getruntimedirectory-method.md)</ept> method provided in the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph>.","pos":[936,1184],"source":" It is superseded by the [ICLRRuntimeInfo::GetRuntimeDirectory](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-getruntimedirectory-method.md) method provided in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]."},{"pos":[1193,1199],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1359,1369],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[out] A buffer in which the runtime returns a string that contains the fully qualified name of the installation directory for the runtime that is loaded into the process.","pos":[1386,1556]},{"content":"If the runtime has not yet been loaded into the process, the function returns the appropriate directory information for the latest version of the runtime installed on the computer.","pos":[1557,1737]},{"content":"[in] The size, in bytes, of <ph id=\"ph1\">`pbuffer`</ph>.","pos":[1759,1797],"source":" [in] The size, in bytes, of `pbuffer`."},{"content":"[out] The number of characters returned in <ph id=\"ph1\">`pbuffer`</ph>.","pos":[1818,1871],"source":" [out] The number of characters returned in `pbuffer`."},{"pos":[1880,1887],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[1895,2115],"content":"[!CAUTION]\n Do not use this function in processes that are running version 4 of the CLR. If an earlier version of the CLR is installed on the computer, this function returns the installation directory for that version.","leadings":["","> "],"nodes":[{"content":" Do not use this function in processes that are running version 4 of the CLR. If an earlier version of the CLR is installed on the computer, this function returns the installation directory for that version.","pos":[11,218],"nodes":[{"content":"Do not use this function in processes that are running version 4 of the CLR.","pos":[1,77]},{"content":"If an earlier version of the CLR is installed on the computer, this function returns the installation directory for that version.","pos":[78,207]}]}]},{"pos":[2124,2136],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2140,2244],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2251,2272],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2279,2303],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> MSCorEE.dll","source":"**Library:** MSCorEE.dll"},{"pos":[2310,2418],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]"},{"pos":[2427,2435],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2439,2559],"content":"<bpt id=\"p1\">[</bpt>Deprecated CLR Hosting Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)</ept>","source":"[Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)"}]}