{"content":"---\ntitle: \"Collection Initializers (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.CollectionInitializer\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"collection initializers [Visual Basic]\"\nms.assetid: a9290329-77b0-4fdf-ae75-8fc17287f469\ncaps.latest.revision: 23\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Collection Initializers (Visual Basic)\n*Collection initializers* provide a shortened syntax that enables you to create a collection and populate it with an initial set of values. Collection initializers are useful when you are creating a collection from a set of known values, for example, a list of menu options or categories, an initial set of numeric values, a static list of strings such as day or month names, or geographic locations such as a list of states that is used for validation.  \n  \n For more information about collections, see [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b).  \n  \n You identify a collection initializer by using the `From` keyword followed by braces (`{}`). This is similar to the array literal syntax that is described in [Arrays](../../../../visual-basic/programming-guide/language-features/arrays/index.md). The following examples show various ways to use collection initializers to create collections.  \n  \n [!code-vb[VbVbalrCollectionInitializers#1](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_1.vb)]  \n  \n> [!NOTE]\n>  C# also provides collection initializers. C# collection initializers provide the same functionality as Visual Basic collection initializers. For more information about C# collection initializers, see [Object and Collection Initializers](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).  \n  \n## Syntax  \n A collection initializer consists of a list of comma-separated values that are enclosed in braces (`{}`), preceded by the `From` keyword, as shown in the following code.  \n  \n [!code-vb[VbVbalrCollectionInitializers#2](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_2.vb)]  \n  \n When you create a collection, such as a <xref:System.Collections.Generic.List%601> or a <xref:System.Collections.Generic.Dictionary%602>, you must supply the collection type before the collection initializer, as shown in the following code.  \n  \n [!code-vb[VbVbalrCollectionInitializers#13](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_3.vb)]  \n  \n> [!NOTE]\n>  You cannot combine both a collection initializer and an object initializer to initialize the same collection object. You can use object initializers to initialize objects in a collection initializer.  \n  \n## Creating a Collection by Using a Collection Intializer  \n When you create a collection by using a collection initializer, each value that is supplied in the collection initializer is passed to the appropriate `Add` method of the collection. For example, if you create a <xref:System.Collections.Generic.List%601> by using a collection initializer, each string value in the collection initializer is passed to the <xref:System.Collections.Generic.List%601.Add%2A> method. If you want to create a collection by using a collection initializer, the specified type must be valid collection type. Examples of valid collection types include classes that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or inherit the <xref:System.Collections.CollectionBase> class. The specified type must also expose an `Add` method that meets the following criteria.  \n  \n-   The `Add` method must be available from the scope in which the collection initializer is being called. The `Add` method does not have to be public if you are using the collection initializer in a scenario where non-public methods of the collection can be accessed.  \n  \n-   The `Add` method must be an instance member or `Shared` member of the collection class, or an extension method.  \n  \n-   An `Add` method must exist that can be matched, based on overload resolution rules, to the types that are supplied in the collection initializer.  \n  \n For example, the following code example shows how to create a `List(Of Customer)` collection by using a collection initializer. When the code is run, each `Customer` object is passed to the `Add(Customer)` method of the generic list.  \n  \n [!code-vb[VbVbalrCollectionInitializers#9](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_4.vb)]  \n  \n The following code example shows equivalent code that does not use a collection initializer.  \n  \n [!code-vb[VbVbalrCollectionInitializers#10](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_5.vb)]  \n  \n If the collection has an `Add` method that has parameters that match the constructor for the `Customer` object, you could nest parameter values for the `Add` method within collection initializers, as discussed in the next section. If the collection does not have such an `Add` method, you can create one as an extension method. For an example of how to create an `Add` method as an extension method for a collection, see [How to: Create an Add Extension Method Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md). For an example of how to create a custom collection that can be used with a collection initializer, see [How to: Create a Collection Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md).  \n  \n## Nesting Collection Initializers  \n You can nest values within a collection initializer to identify a specific overload of an `Add` method for the collection that is being created. The values passed to the `Add` method must be separated by commas and enclosed in braces (`{}`), like you would do in an array literal or collection initializer.  \n  \n When you create a collection by using nested values, each element of the nested value list is passed as an argument to the `Add` method that matches the element types. For example, the following code example creates a <xref:System.Collections.Generic.Dictionary%602> in which the keys are of type `Integer` and the values are of type `String`. Each of the nested value lists is matched to the <xref:System.Collections.Generic.Dictionary%602.Add%2A> method for the `Dictionary`.  \n  \n [!code-vb[VbVbalrCollectionInitializers#5](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_6.vb)]  \n  \n The previous code example is equivalent to the following code.  \n  \n [!code-vb[VbVbalrCollectionInitializers#6](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_7.vb)]  \n  \n Only nested value lists from the first level of nesting are sent to the `Add` method for the collection type. Deeper levels of nesting are treated as array literals and the nested value lists are not matched to the `Add` method of any collection.  \n  \n## Related Topics  \n  \n|Title|Description|  \n|---|---|  \n|[How to: Create an Add Extension Method Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md)|Shows how to create an extension method called `Add` that can be used to populate a collection with values from a collection initializer.|  \n|[How to: Create a Collection Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md)|Shows how to enable use of a collection initializer by including an `Add` method in a collection class that implements `IEnumerable`.|  \n  \n## See Also  \n [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)   \n [Arrays](../../../../visual-basic/programming-guide/language-features/arrays/index.md)   \n [Object Initializers: Named and Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)   \n [New Operator](../../../../visual-basic/language-reference/operators/new-operator.md)   \n [Auto-Implemented Properties](../../../../visual-basic/programming-guide/language-features/procedures/auto-implemented-properties.md)   \n [How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)   \n [Local Type Inference](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)   \n [Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)   \n [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)   \n [How to: Create a List of Items](../../../../visual-basic/programming-guide/concepts/linq/how-to-create-a-list-of-items.md)","nodes":[{"pos":[12,67],"content":"Collection Initializers (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Collection Initializers (Visual Basic) | Microsoft Docs","pos":[0,55]}]},{"pos":[652,690],"content":"Collection Initializers (Visual Basic)","linkify":"Collection Initializers (Visual Basic)","nodes":[{"content":"Collection Initializers (Visual Basic)","pos":[0,38]}]},{"content":"<bpt id=\"p1\">*</bpt>Collection initializers<ept id=\"p1\">*</ept> provide a shortened syntax that enables you to create a collection and populate it with an initial set of values.","pos":[691,830],"source":"*Collection initializers* provide a shortened syntax that enables you to create a collection and populate it with an initial set of values."},{"content":"Collection initializers are useful when you are creating a collection from a set of known values, for example, a list of menu options or categories, an initial set of numeric values, a static list of strings such as day or month names, or geographic locations such as a list of states that is used for validation.","pos":[831,1144]},{"pos":[1151,1281],"content":"For more information about collections, see <bpt id=\"p1\">[</bpt>Collections<ept id=\"p1\">](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)</ept>.","source":"For more information about collections, see [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)."},{"content":"You identify a collection initializer by using the <ph id=\"ph1\">`From`</ph> keyword followed by braces (<ph id=\"ph2\">`{}`</ph>).","pos":[1288,1380],"source":"You identify a collection initializer by using the `From` keyword followed by braces (`{}`)."},{"content":"This is similar to the array literal syntax that is described in <bpt id=\"p1\">[</bpt>Arrays<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/index.md)</ept>.","pos":[1381,1533],"source":" This is similar to the array literal syntax that is described in [Arrays](../../../../visual-basic/programming-guide/language-features/arrays/index.md)."},{"content":"The following examples show various ways to use collection initializers to create collections.","pos":[1534,1628]},{"pos":[1635,1782],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrCollectionInitializers#1<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrCollectionInitializers#1](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_1.vb)]"},{"pos":[1790,2134],"content":"[!NOTE]\n C# also provides collection initializers. C# collection initializers provide the same functionality as Visual Basic collection initializers. For more information about C# collection initializers, see [Object and Collection Initializers](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).","leadings":["","> "],"nodes":[{"content":" C# also provides collection initializers. C# collection initializers provide the same functionality as Visual Basic collection initializers. For more information about C# collection initializers, see [Object and Collection Initializers](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).","pos":[8,342],"nodes":[{"content":"C# also provides collection initializers.","pos":[1,42]},{"content":"C# collection initializers provide the same functionality as Visual Basic collection initializers.","pos":[43,141]},{"content":"For more information about C# collection initializers, see <bpt id=\"p1\">[</bpt>Object and Collection Initializers<ept id=\"p1\">](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md)</ept>.","pos":[142,334],"source":" For more information about C# collection initializers, see [Object and Collection Initializers](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md)."}]}]},{"pos":[2143,2149],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[2153,2322],"content":"A collection initializer consists of a list of comma-separated values that are enclosed in braces (<ph id=\"ph1\">`{}`</ph>), preceded by the <ph id=\"ph2\">`From`</ph> keyword, as shown in the following code.","source":"A collection initializer consists of a list of comma-separated values that are enclosed in braces (`{}`), preceded by the `From` keyword, as shown in the following code."},{"pos":[2329,2476],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrCollectionInitializers#2<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_2.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrCollectionInitializers#2](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_2.vb)]"},{"content":"When you create a collection, such as a <ph id=\"ph1\">&lt;xref:System.Collections.Generic.List%601&gt;</ph> or a <ph id=\"ph2\">&lt;xref:System.Collections.Generic.Dictionary%602&gt;</ph>, you must supply the collection type before the collection initializer, as shown in the following code.","pos":[2483,2723],"source":"When you create a collection, such as a <xref:System.Collections.Generic.List%601> or a <xref:System.Collections.Generic.Dictionary%602>, you must supply the collection type before the collection initializer, as shown in the following code."},{"pos":[2730,2878],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrCollectionInitializers#13<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_3.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrCollectionInitializers#13](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_3.vb)]"},{"pos":[2886,3096],"content":"[!NOTE]\n You cannot combine both a collection initializer and an object initializer to initialize the same collection object. You can use object initializers to initialize objects in a collection initializer.","leadings":["","> "],"nodes":[{"content":" You cannot combine both a collection initializer and an object initializer to initialize the same collection object. You can use object initializers to initialize objects in a collection initializer.","pos":[8,208],"nodes":[{"content":"You cannot combine both a collection initializer and an object initializer to initialize the same collection object.","pos":[1,117]},{"content":"You can use object initializers to initialize objects in a collection initializer.","pos":[118,200]}]}]},{"pos":[3105,3159],"content":"Creating a Collection by Using a Collection Intializer","linkify":"Creating a Collection by Using a Collection Intializer","nodes":[{"content":"Creating a Collection by Using a Collection Intializer","pos":[0,54]}]},{"content":"When you create a collection by using a collection initializer, each value that is supplied in the collection initializer is passed to the appropriate <ph id=\"ph1\">`Add`</ph> method of the collection.","pos":[3163,3345],"source":"When you create a collection by using a collection initializer, each value that is supplied in the collection initializer is passed to the appropriate `Add` method of the collection."},{"content":"For example, if you create a <ph id=\"ph1\">&lt;xref:System.Collections.Generic.List%601&gt;</ph> by using a collection initializer, each string value in the collection initializer is passed to the <ph id=\"ph2\">&lt;xref:System.Collections.Generic.List%601.Add%2A&gt;</ph> method.","pos":[3346,3575],"source":" For example, if you create a <xref:System.Collections.Generic.List%601> by using a collection initializer, each string value in the collection initializer is passed to the <xref:System.Collections.Generic.List%601.Add%2A> method."},{"content":"If you want to create a collection by using a collection initializer, the specified type must be valid collection type.","pos":[3576,3695]},{"content":"Examples of valid collection types include classes that implement the <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> interface or inherit the <ph id=\"ph2\">&lt;xref:System.Collections.CollectionBase&gt;</ph> class.","pos":[3696,3888],"source":" Examples of valid collection types include classes that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or inherit the <xref:System.Collections.CollectionBase> class."},{"content":"The specified type must also expose an <ph id=\"ph1\">`Add`</ph> method that meets the following criteria.","pos":[3889,3975],"source":" The specified type must also expose an `Add` method that meets the following criteria."},{"content":"The <ph id=\"ph1\">`Add`</ph> method must be available from the scope in which the collection initializer is being called.","pos":[3985,4087],"source":"The `Add` method must be available from the scope in which the collection initializer is being called."},{"content":"The <ph id=\"ph1\">`Add`</ph> method does not have to be public if you are using the collection initializer in a scenario where non-public methods of the collection can be accessed.","pos":[4088,4249],"source":" The `Add` method does not have to be public if you are using the collection initializer in a scenario where non-public methods of the collection can be accessed."},{"pos":[4259,4370],"content":"The <ph id=\"ph1\">`Add`</ph> method must be an instance member or <ph id=\"ph2\">`Shared`</ph> member of the collection class, or an extension method.","source":"The `Add` method must be an instance member or `Shared` member of the collection class, or an extension method."},{"pos":[4380,4525],"content":"An <ph id=\"ph1\">`Add`</ph> method must exist that can be matched, based on overload resolution rules, to the types that are supplied in the collection initializer.","source":"An `Add` method must exist that can be matched, based on overload resolution rules, to the types that are supplied in the collection initializer."},{"content":"For example, the following code example shows how to create a <ph id=\"ph1\">`List(Of Customer)`</ph> collection by using a collection initializer.","pos":[4532,4659],"source":"For example, the following code example shows how to create a `List(Of Customer)` collection by using a collection initializer."},{"content":"When the code is run, each <ph id=\"ph1\">`Customer`</ph> object is passed to the <ph id=\"ph2\">`Add(Customer)`</ph> method of the generic list.","pos":[4660,4765],"source":" When the code is run, each `Customer` object is passed to the `Add(Customer)` method of the generic list."},{"pos":[4772,4919],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrCollectionInitializers#9<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_4.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrCollectionInitializers#9](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_4.vb)]"},{"content":"The following code example shows equivalent code that does not use a collection initializer.","pos":[4926,5018]},{"pos":[5025,5173],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrCollectionInitializers#10<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_5.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrCollectionInitializers#10](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_5.vb)]"},{"content":"If the collection has an <ph id=\"ph1\">`Add`</ph> method that has parameters that match the constructor for the <ph id=\"ph2\">`Customer`</ph> object, you could nest parameter values for the <ph id=\"ph3\">`Add`</ph> method within collection initializers, as discussed in the next section.","pos":[5180,5410],"source":"If the collection has an `Add` method that has parameters that match the constructor for the `Customer` object, you could nest parameter values for the `Add` method within collection initializers, as discussed in the next section."},{"content":"If the collection does not have such an <ph id=\"ph1\">`Add`</ph> method, you can create one as an extension method.","pos":[5411,5507],"source":" If the collection does not have such an `Add` method, you can create one as an extension method."},{"content":"For an example of how to create an <ph id=\"ph1\">`Add`</ph> method as an extension method for a collection, see <bpt id=\"p1\">[</bpt>How to: Create an Add Extension Method Used by a Collection Initializer<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md)</ept>.","pos":[5508,5835],"source":" For an example of how to create an `Add` method as an extension method for a collection, see [How to: Create an Add Extension Method Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md)."},{"content":"For an example of how to create a custom collection that can be used with a collection initializer, see <bpt id=\"p1\">[</bpt>How to: Create a Collection Used by a Collection Initializer<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md)</ept>.","pos":[5836,6152],"source":" For an example of how to create a custom collection that can be used with a collection initializer, see [How to: Create a Collection Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md)."},{"pos":[6161,6192],"content":"Nesting Collection Initializers","linkify":"Nesting Collection Initializers","nodes":[{"content":"Nesting Collection Initializers","pos":[0,31]}]},{"content":"You can nest values within a collection initializer to identify a specific overload of an <ph id=\"ph1\">`Add`</ph> method for the collection that is being created.","pos":[6196,6340],"source":"You can nest values within a collection initializer to identify a specific overload of an `Add` method for the collection that is being created."},{"content":"The values passed to the <ph id=\"ph1\">`Add`</ph> method must be separated by commas and enclosed in braces (<ph id=\"ph2\">`{}`</ph>), like you would do in an array literal or collection initializer.","pos":[6341,6502],"source":" The values passed to the `Add` method must be separated by commas and enclosed in braces (`{}`), like you would do in an array literal or collection initializer."},{"content":"When you create a collection by using nested values, each element of the nested value list is passed as an argument to the <ph id=\"ph1\">`Add`</ph> method that matches the element types.","pos":[6509,6676],"source":"When you create a collection by using nested values, each element of the nested value list is passed as an argument to the `Add` method that matches the element types."},{"content":"For example, the following code example creates a <ph id=\"ph1\">&lt;xref:System.Collections.Generic.Dictionary%602&gt;</ph> in which the keys are of type <ph id=\"ph2\">`Integer`</ph> and the values are of type <ph id=\"ph3\">`String`</ph>.","pos":[6677,6852],"source":" For example, the following code example creates a <xref:System.Collections.Generic.Dictionary%602> in which the keys are of type `Integer` and the values are of type `String`."},{"content":"Each of the nested value lists is matched to the <ph id=\"ph1\">&lt;xref:System.Collections.Generic.Dictionary%602.Add%2A&gt;</ph> method for the <ph id=\"ph2\">`Dictionary`</ph>.","pos":[6853,6986],"source":" Each of the nested value lists is matched to the <xref:System.Collections.Generic.Dictionary%602.Add%2A> method for the `Dictionary`."},{"pos":[6993,7140],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrCollectionInitializers#5<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_6.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrCollectionInitializers#5](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_6.vb)]"},{"content":"The previous code example is equivalent to the following code.","pos":[7147,7209]},{"pos":[7216,7363],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrCollectionInitializers#6<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_7.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrCollectionInitializers#6](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_7.vb)]"},{"content":"Only nested value lists from the first level of nesting are sent to the <ph id=\"ph1\">`Add`</ph> method for the collection type.","pos":[7370,7479],"source":"Only nested value lists from the first level of nesting are sent to the `Add` method for the collection type."},{"content":"Deeper levels of nesting are treated as array literals and the nested value lists are not matched to the <ph id=\"ph1\">`Add`</ph> method of any collection.","pos":[7480,7616],"source":" Deeper levels of nesting are treated as array literals and the nested value lists are not matched to the `Add` method of any collection."},{"pos":[7625,7639],"content":"Related Topics","linkify":"Related Topics","nodes":[{"content":"Related Topics","pos":[0,14]}]},{"content":"Title","pos":[7646,7651]},{"content":"Description","pos":[7652,7663]},{"pos":[7680,7913],"content":"<bpt id=\"p1\">[</bpt>How to: Create an Add Extension Method Used by a Collection Initializer<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md)</ept>","source":"[How to: Create an Add Extension Method Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md)"},{"pos":[7914,8051],"content":"Shows how to create an extension method called <ph id=\"ph1\">`Add`</ph> that can be used to populate a collection with values from a collection initializer.","source":"Shows how to create an extension method called `Add` that can be used to populate a collection with values from a collection initializer."},{"pos":[8056,8267],"content":"<bpt id=\"p1\">[</bpt>How to: Create a Collection Used by a Collection Initializer<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md)</ept>","source":"[How to: Create a Collection Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md)"},{"pos":[8268,8401],"content":"Shows how to enable use of a collection initializer by including an <ph id=\"ph1\">`Add`</ph> method in a collection class that implements <ph id=\"ph2\">`IEnumerable`</ph>.","source":"Shows how to enable use of a collection initializer by including an `Add` method in a collection class that implements `IEnumerable`."},{"pos":[8411,8419],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Collections<ept id=\"p1\">](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)</ept><ph id=\"ph1\"> </ph>","pos":[8423,8509],"source":"[Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b) "},{"content":"<bpt id=\"p1\"> [</bpt>Arrays<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[8512,8600],"source":" [Arrays](../../../../visual-basic/programming-guide/language-features/arrays/index.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Object Initializers: Named and Anonymous Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)</ept><ph id=\"ph1\"> </ph>","pos":[8603,8784],"source":" [Object Initializers: Named and Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md) "},{"content":"<bpt id=\"p1\"> [</bpt>New Operator<ept id=\"p1\">](../../../../visual-basic/language-reference/operators/new-operator.md)</ept><ph id=\"ph1\"> </ph>","pos":[8787,8874],"source":" [New Operator](../../../../visual-basic/language-reference/operators/new-operator.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Auto-Implemented Properties<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/procedures/auto-implemented-properties.md)</ept><ph id=\"ph1\"> </ph>","pos":[8877,9012],"source":" [Auto-Implemented Properties](../../../../visual-basic/programming-guide/language-features/procedures/auto-implemented-properties.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Initialize an Array Variable in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)</ept><ph id=\"ph1\"> </ph>","pos":[9015,9179],"source":" [How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Local Type Inference<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)</ept><ph id=\"ph1\"> </ph>","pos":[9182,9302],"source":" [Local Type Inference](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Anonymous Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)</ept><ph id=\"ph1\"> </ph>","pos":[9305,9425],"source":" [Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Introduction to LINQ in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)</ept><ph id=\"ph1\"> </ph>","pos":[9428,9559],"source":" [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Create a List of Items<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/how-to-create-a-list-of-items.md)</ept>","pos":[9562,9686],"source":" [How to: Create a List of Items](../../../../visual-basic/programming-guide/concepts/linq/how-to-create-a-list-of-items.md)"}]}