{"content":"---\ntitle: \"How to: Log Information About Services\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"AutoLog property\"\n  - \"services, logging information\"\n  - \"Windows Service applications, logging information about\"\n  - \"event logs, service applications\"\n  - \"application event logs, service applications\"\n  - \"logs, service applications\"\nms.assetid: c0d8140f-c055-4d8e-a2e0-37358a550116\nauthor: \"ghogen\"\n---\n# How to: Log Information About Services\nBy default, all Windows Service projects have the ability to interact with the Application event log and write information and exceptions to it. You use the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property to indicate whether you want this functionality in your application. By default, logging is turned on for any service you create with the Windows Service project template. You can use a static form of the <xref:System.Diagnostics.EventLog> class to write service information to a log without having to create an instance of an <xref:System.Diagnostics.EventLog> component or manually register a source.  \n  \n The installer for your service automatically registers each service in your project as a valid source of events with the Application log on the computer where the service is installed, when logging is turned on. The service logs information each time the service is started, stopped, paused, resumed, installed, or uninstalled. It also logs any failures that occur. You do not need to write any code to write entries to the log when using the default behavior; the service handles this for you automatically.  \n  \n If you want to write to an event log other than the Application log, you must set the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property to `false`, create your own custom event log within your services code, and register your service as a valid source of entries for that log. You must then write code to record entries to the log whenever an action you're interested in occurs.  \n  \n> [!NOTE]\n>  If you use a custom event log and configure your service application to write to it, you must not attempt to access the event log before setting the service's <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property in your code. The event log needs this property's value to register your service as a valid source of events.  \n  \n### To enable default event logging for your service  \n  \n-   Set the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property for your component to `true`.  \n  \n    > [!NOTE]\n    >  By default, this property is set to `true`. You do not need to set this explicitly unless you are building more complex processing, such as evaluating a condition and then setting the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property based on the result of that condition.  \n  \n### To disable event logging for your service  \n  \n-   Set the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property for your component to `false`.  \n  \n     [!code-csharp[VbRadconService#17](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#17)]\n     [!code-vb[VbRadconService#17](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#17)]  \n  \n### To set up logging to a custom log  \n  \n1.  Set the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property to `false`.  \n  \n    > [!NOTE]\n    >  You must set <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> to false in order to use a custom log.  \n  \n2.  Set up an instance of an <xref:System.Diagnostics.EventLog> component in your Windows Service application.  \n  \n3.  Create a custom log by calling the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method and specifying the source string and the name of the log file you want to create.  \n  \n4.  Set the <xref:System.Diagnostics.EventLog.Source%2A> property on the <xref:System.Diagnostics.EventLog> component instance to the source string you created in step 3.  \n  \n5.  Write your entries by accessing the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method on the <xref:System.Diagnostics.EventLog> component instance.  \n  \n     The following code shows how to set up logging to a custom log.  \n  \n    > [!NOTE]\n    >  In this code example, an instance of an <xref:System.Diagnostics.EventLog> component is named `eventLog1` (`EventLog1` in Visual Basic). If you created an instance with another name in step 2, change the code accordingly.  \n  \n     [!code-csharp[VbRadconService#14](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#14)]\n     [!code-vb[VbRadconService#14](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#14)]  \n    [!code-csharp[VbRadconService#15](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#15)]\n    [!code-vb[VbRadconService#15](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#15)]  \n  \n## See also\n\n- [Introduction to Windows Service Applications](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)\n","nodes":[{"pos":[4,439],"embed":true,"restype":"x-metadata","content":"title: \"How to: Log Information About Services\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"AutoLog property\"\n  - \"services, logging information\"\n  - \"Windows Service applications, logging information about\"\n  - \"event logs, service applications\"\n  - \"application event logs, service applications\"\n  - \"logs, service applications\"\nms.assetid: c0d8140f-c055-4d8e-a2e0-37358a550116\nauthor: \"ghogen\"","nodes":[{"content":"How to: Log Information About Services","nodes":[{"pos":[0,38],"content":"How to: Log Information About Services","nodes":[{"content":"How to: Log Information About Services","pos":[0,38]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[446,484],"content":"How to: Log Information About Services","linkify":"How to: Log Information About Services","nodes":[{"content":"How to: Log Information About Services","pos":[0,38]}]},{"content":"By default, all Windows Service projects have the ability to interact with the Application event log and write information and exceptions to it.","pos":[485,629]},{"content":"You use the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.AutoLog%2A&gt;</ph> property to indicate whether you want this functionality in your application.","pos":[630,771],"source":" You use the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property to indicate whether you want this functionality in your application."},{"content":"By default, logging is turned on for any service you create with the Windows Service project template.","pos":[772,874]},{"content":"You can use a static form of the <ph id=\"ph1\">&lt;xref:System.Diagnostics.EventLog&gt;</ph> class to write service information to a log without having to create an instance of an <ph id=\"ph2\">&lt;xref:System.Diagnostics.EventLog&gt;</ph> component or manually register a source.","pos":[875,1105],"source":" You can use a static form of the <xref:System.Diagnostics.EventLog> class to write service information to a log without having to create an instance of an <xref:System.Diagnostics.EventLog> component or manually register a source."},{"content":"The installer for your service automatically registers each service in your project as a valid source of events with the Application log on the computer where the service is installed, when logging is turned on.","pos":[1112,1323]},{"content":"The service logs information each time the service is started, stopped, paused, resumed, installed, or uninstalled.","pos":[1324,1439]},{"content":"It also logs any failures that occur.","pos":[1440,1477]},{"content":"You do not need to write any code to write entries to the log when using the default behavior; the service handles this for you automatically.","pos":[1478,1620]},{"content":"If you want to write to an event log other than the Application log, you must set the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.AutoLog%2A&gt;</ph> property to <ph id=\"ph2\">`false`</ph>, create your own custom event log within your services code, and register your service as a valid source of entries for that log.","pos":[1627,1914],"source":"If you want to write to an event log other than the Application log, you must set the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property to `false`, create your own custom event log within your services code, and register your service as a valid source of entries for that log."},{"content":"You must then write code to record entries to the log whenever an action you're interested in occurs.","pos":[1915,2016]},{"pos":[2024,2368],"content":"[!NOTE]\n If you use a custom event log and configure your service application to write to it, you must not attempt to access the event log before setting the service's <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property in your code. The event log needs this property's value to register your service as a valid source of events.","leadings":["","> "],"nodes":[{"content":"If you use a custom event log and configure your service application to write to it, you must not attempt to access the event log before setting the service's <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property in your code. The event log needs this property's value to register your service as a valid source of events.","pos":[9,342],"nodes":[{"content":"If you use a custom event log and configure your service application to write to it, you must not attempt to access the event log before setting the service's <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.ServiceName%2A&gt;</ph> property in your code.","pos":[0,237],"source":"If you use a custom event log and configure your service application to write to it, you must not attempt to access the event log before setting the service's <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property in your code."},{"content":"The event log needs this property's value to register your service as a valid source of events.","pos":[238,333]}]}]},{"pos":[2378,2426],"content":"To enable default event logging for your service","linkify":"To enable default event logging for your service","nodes":[{"content":"To enable default event logging for your service","pos":[0,48]}]},{"pos":[2436,2534],"content":"Set the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.AutoLog%2A&gt;</ph> property for your component to <ph id=\"ph2\">`true`</ph>.","source":"Set the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property for your component to `true`."},{"pos":[2546,2844],"content":"[!NOTE]\nBy default, this property is set to `true`. You do not need to set this explicitly unless you are building more complex processing, such as evaluating a condition and then setting the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property based on the result of that condition.","leadings":["","    >  "],"nodes":[{"content":"By default, this property is set to `true`. You do not need to set this explicitly unless you are building more complex processing, such as evaluating a condition and then setting the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property based on the result of that condition.","pos":[8,291],"nodes":[{"content":"By default, this property is set to <ph id=\"ph1\">`true`</ph>.","pos":[0,43],"source":"By default, this property is set to `true`."},{"content":"You do not need to set this explicitly unless you are building more complex processing, such as evaluating a condition and then setting the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.AutoLog%2A&gt;</ph> property based on the result of that condition.","pos":[44,283],"source":" You do not need to set this explicitly unless you are building more complex processing, such as evaluating a condition and then setting the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property based on the result of that condition."}]}]},{"pos":[2854,2895],"content":"To disable event logging for your service","linkify":"To disable event logging for your service","nodes":[{"content":"To disable event logging for your service","pos":[0,41]}]},{"pos":[2905,3004],"content":"Set the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.AutoLog%2A&gt;</ph> property for your component to <ph id=\"ph2\">`false`</ph>.","source":"Set the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property for your component to `false`."},{"pos":[3015,3276],"content":"[!code-csharp[VbRadconService#17](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#17)]\n [!code-vb[VbRadconService#17](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#17)]","leadings":["","    "],"nodes":[]},{"pos":[3286,3319],"content":"To set up logging to a custom log","linkify":"To set up logging to a custom log","nodes":[{"content":"To set up logging to a custom log","pos":[0,33]}]},{"pos":[3329,3409],"content":"Set the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.AutoLog%2A&gt;</ph> property to <ph id=\"ph2\">`false`</ph>.","source":"Set the <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> property to `false`."},{"pos":[3421,3539],"content":"[!NOTE]\nYou must set <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> to false in order to use a custom log.","leadings":["","    >  "],"nodes":[{"content":"You must set <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.AutoLog%2A&gt;</ph> to false in order to use a custom log.","pos":[8,111],"source":"You must set <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> to false in order to use a custom log."}]},{"pos":[3549,3655],"content":"Set up an instance of an <ph id=\"ph1\">&lt;xref:System.Diagnostics.EventLog&gt;</ph> component in your Windows Service application.","source":"Set up an instance of an <xref:System.Diagnostics.EventLog> component in your Windows Service application."},{"pos":[3665,3844],"content":"Create a custom log by calling the <ph id=\"ph1\">&lt;xref:System.Diagnostics.EventLog.CreateEventSource%2A&gt;</ph> method and specifying the source string and the name of the log file you want to create.","source":"Create a custom log by calling the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method and specifying the source string and the name of the log file you want to create."},{"pos":[3854,4020],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Diagnostics.EventLog.Source%2A&gt;</ph> property on the <ph id=\"ph2\">&lt;xref:System.Diagnostics.EventLog&gt;</ph> component instance to the source string you created in step 3.","source":"Set the <xref:System.Diagnostics.EventLog.Source%2A> property on the <xref:System.Diagnostics.EventLog> component instance to the source string you created in step 3."},{"pos":[4030,4183],"content":"Write your entries by accessing the <ph id=\"ph1\">&lt;xref:System.Diagnostics.EventLog.WriteEntry%2A&gt;</ph> method on the <ph id=\"ph2\">&lt;xref:System.Diagnostics.EventLog&gt;</ph> component instance.","source":"Write your entries by accessing the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method on the <xref:System.Diagnostics.EventLog> component instance."},{"content":"The following code shows how to set up logging to a custom log.","pos":[4194,4257]},{"pos":[4269,4505],"content":"[!NOTE]\nIn this code example, an instance of an <xref:System.Diagnostics.EventLog> component is named `eventLog1` (`EventLog1` in Visual Basic). If you created an instance with another name in step 2, change the code accordingly.","leadings":["","    >  "],"nodes":[{"content":"In this code example, an instance of an <xref:System.Diagnostics.EventLog> component is named `eventLog1` (`EventLog1` in Visual Basic). If you created an instance with another name in step 2, change the code accordingly.","pos":[8,229],"nodes":[{"content":"In this code example, an instance of an <ph id=\"ph1\">&lt;xref:System.Diagnostics.EventLog&gt;</ph> component is named <ph id=\"ph2\">`eventLog1`</ph> (<ph id=\"ph3\">`EventLog1`</ph> in Visual Basic).","pos":[0,136],"source":"In this code example, an instance of an <xref:System.Diagnostics.EventLog> component is named `eventLog1` (`EventLog1` in Visual Basic)."},{"content":"If you created an instance with another name in step 2, change the code accordingly.","pos":[137,221]}]}]},{"pos":[4516,5044],"content":"[!code-csharp[VbRadconService#14](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#14)]\n [!code-vb[VbRadconService#14](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#14)]  \n[!code-csharp[VbRadconService#15](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#15)]\n[!code-vb[VbRadconService#15](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#15)]","leadings":["","    ","    ","    "],"nodes":[]},{"pos":[5053,5061],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5065,5201],"content":"<bpt id=\"p1\">[</bpt>Introduction to Windows Service Applications<ept id=\"p1\">](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)</ept>","source":"[Introduction to Windows Service Applications](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)"}]}