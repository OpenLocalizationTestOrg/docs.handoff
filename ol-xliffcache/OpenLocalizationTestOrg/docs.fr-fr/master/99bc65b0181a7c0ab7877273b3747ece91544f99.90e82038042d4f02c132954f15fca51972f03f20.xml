{"content":"---\ntitle: PutMethod function (Unmanaged API Reference)\ndescription: The PutMethod function creates a method.\nms.date: \"11/06/2017\"\napi_name: \n  - \"PutMethod\"\napi_location: \n  - \"WMINet_Utils.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"PutMethod\"\nhelpviewer_keywords: \n  - \"PutMethod function [.NET WMI and performance counters]\"\ntopic_type: \n  - \"Reference\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# PutMethod function\nCreates a method.\n\n[!INCLUDE[internalonly-unmanaged](../../../../includes/internalonly-unmanaged.md)]\n    \n## Syntax  \n  \n```  \nHRESULT PutMethod (\n   [in] int                vFunc, \n   [in] IWbemClassObject*  ptr, \n   [in] LPCWSTR            wszName,\n   [in] LONG               lFlags,\n   [in] IWbemClassObject*  pInSignature,\n   [in] IWbemClassObject*  pOutSignature\n); \n```  \n\n## Parameters\n\n`vFunc`  \n[in] This parameter is unused.\n\n`ptr`  \n[in] A pointer to an [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) instance.\n\n`wszName`  \n[in] The name of the method to create. \n\n`lFlags`  \n[in] Reserved. This parameter must be 0.\n\n`pSignatureIn`  \n[in] A pointer to a copy of the [__Parameters system class](/windows/desktop/WmiSdk/--parameters) that contains the `in` parameters for the method. This parameter is ignored if set to `null`.  \n\n`pSignatureOut`  \n[in]  A pointer to a copy of the [__Parameters system class](/windows/desktop/WmiSdk/--parameters) that contains the `out` parameters for the method. This parameter is ignored if set to `null`.\n\n## Return value\n\nThe following values returned by this function are defined in the *WbemCli.h* header file, or you can define them as constants in your code:\n\n|Constant  |Value  |Description  |\n|---------|---------|---------|\n| `WBEM_E_INVALID_PARAMETER` | 0x80041008 | One or more parameters are not valid. |\n| `WBEM_E_INVALID_DUPLICATE_PARAMETER` | 0x80041043 | The `[in, out]` method parameter specified in both the *pInSignature* and *pOutSignature* objects have different qualifiers.\n| `WBEM_E_MISSING_PARAMETER_ID` | 0x80041036 | A method parameter is missing the specification of the **ID** qualifier. |\n| `WBEM_E_NONCONSECUTIVE_PARAMETER_IDS` | 0x80041038 | The ID series that is assigned to the method parameters is not consecutive or does not start at 0. |\n| `WBEM_E_PARAMETER_ID_ON_RETVAL` | 0x80041039 | The return value for a method has an **ID** qualifier. |\n| `WBEM_E_PROPAGATED_METHOD` | 0x80041034 | An attempt was made to reuse an existing method name from a parent class, and the signatures did not match. |\n| `WBEM_S_NO_ERROR` | 0 | The function call was successful. |\n  \n## Remarks\n\nThis function wraps a call to the [IWbemClassObject::PutMethod](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-putmethod) method.\n\nThis method call is only supported if `ptr` is a CIM class definition. Method manipulation is not available from [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) pointers that point to CIM instances.\n\nUsers cannot create methods with names that begin or end with an underscore. This is reserved for system classes and properties.\n\nFor a method, the `in` and `out` parameters are described as properties in [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) objects.\n\nAn `[in/out]` parameter can be defined by adding the same property to both objects pointed to by the `pInSignature` and `pOutSignature` parameters. In this case, the properties share the same **ID** qualifier value.\n\nEach property in a [__Parameters](/windows/desktop/WmiSdk/--parameters) class object other than `ReturnValue` must have an **ID** qualifier, a zero-based numeric value that identifies the order in which the parameters appear. No two parameters can have the same **ID** value, and no **ID** value can be skipped. If either condition occurs, the `PutMethod` function returns `WBEM_E_NONCONSECUTIVE_PARAMETER_IDS`.\n\n## Example\n\nFor an example, see the [IWbemClassObject::PutMethod](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-putmethod) method.\n\n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** WMINet_Utils.idl  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]  \n  \n## See also\n\n- [WMI and Performance Counters (Unmanaged API Reference)](index.md)\n","nodes":[{"pos":[4,405],"embed":true,"restype":"x-metadata","content":"title: PutMethod function (Unmanaged API Reference)\ndescription: The PutMethod function creates a method.\nms.date: \"11/06/2017\"\napi_name: \n  - \"PutMethod\"\napi_location: \n  - \"WMINet_Utils.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"PutMethod\"\nhelpviewer_keywords: \n  - \"PutMethod function [.NET WMI and performance counters]\"\ntopic_type: \n  - \"Reference\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"PutMethod function (Unmanaged API Reference)","nodes":[{"pos":[0,44],"content":"PutMethod function (Unmanaged API Reference)","nodes":[{"content":"PutMethod function (Unmanaged API Reference)","pos":[0,44]}]}],"path":["title"],"nosxs":false},{"content":"The PutMethod function creates a method.","nodes":[{"pos":[0,40],"content":"The PutMethod function creates a method.","nodes":[{"content":"The PutMethod function creates a method.","pos":[0,40]}]}],"path":["description"],"nosxs":false}],"yml":true},{"pos":[412,430],"content":"PutMethod function","linkify":"PutMethod function","nodes":[{"content":"PutMethod function","pos":[0,18]}]},{"content":"Creates a method.","pos":[431,448]},{"pos":[541,547],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[814,824],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] This parameter is unused.","pos":[836,866]},{"content":"[in] A pointer to an <bpt id=\"p1\">[</bpt>IWbemClassObject<ept id=\"p1\">](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject)</ept> instance.","pos":[876,983],"source":"[in] A pointer to an [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) instance."},{"content":"[in] The name of the method to create.","pos":[997,1035]},{"content":"[in] Reserved.","pos":[1049,1063]},{"content":"This parameter must be 0.","pos":[1064,1089]},{"content":"[in] A pointer to a copy of the <bpt id=\"p1\">[</bpt>__Parameters system class<ept id=\"p1\">](/windows/desktop/WmiSdk/--parameters)</ept> that contains the <ph id=\"ph1\">`in`</ph> parameters for the method.","pos":[1108,1255],"source":"[in] A pointer to a copy of the [__Parameters system class](/windows/desktop/WmiSdk/--parameters) that contains the `in` parameters for the method."},{"content":"This parameter is ignored if set to <ph id=\"ph1\">`null`</ph>.","pos":[1256,1299],"source":" This parameter is ignored if set to `null`."},{"content":"[in]  A pointer to a copy of the <bpt id=\"p1\">[</bpt>__Parameters system class<ept id=\"p1\">](/windows/desktop/WmiSdk/--parameters)</ept> that contains the <ph id=\"ph1\">`out`</ph> parameters for the method.","pos":[1321,1470],"source":"[in]  A pointer to a copy of the [__Parameters system class](/windows/desktop/WmiSdk/--parameters) that contains the `out` parameters for the method."},{"content":"This parameter is ignored if set to <ph id=\"ph1\">`null`</ph>.","pos":[1471,1514],"source":" This parameter is ignored if set to `null`."},{"pos":[1519,1531],"content":"Return value","linkify":"Return value","nodes":[{"content":"Return value","pos":[0,12]}]},{"pos":[1533,1673],"content":"The following values returned by this function are defined in the <bpt id=\"p1\">*</bpt>WbemCli.h<ept id=\"p1\">*</ept> header file, or you can define them as constants in your code:","source":"The following values returned by this function are defined in the *WbemCli.h* header file, or you can define them as constants in your code:"},{"content":"Constant","pos":[1676,1684]},{"content":"Value","pos":[1687,1692]},{"content":"Description","pos":[1695,1706]},{"content":"0x80041008","pos":[1773,1783]},{"content":"One or more parameters are not valid.","pos":[1786,1823]},{"content":"0x80041043","pos":[1867,1877]},{"pos":[1880,2004],"content":"The <ph id=\"ph1\">`[in, out]`</ph> method parameter specified in both the <bpt id=\"p1\">*</bpt>pInSignature<ept id=\"p1\">*</ept> and <bpt id=\"p2\">*</bpt>pOutSignature<ept id=\"p2\">*</ept> objects have different qualifiers.","source":"The `[in, out]` method parameter specified in both the *pInSignature* and *pOutSignature* objects have different qualifiers."},{"content":"0x80041036","pos":[2039,2049]},{"pos":[2052,2124],"content":"A method parameter is missing the specification of the <bpt id=\"p1\">**</bpt>ID<ept id=\"p1\">**</ept> qualifier.","source":"A method parameter is missing the specification of the **ID** qualifier."},{"content":"0x80041038","pos":[2169,2179]},{"content":"The ID series that is assigned to the method parameters is not consecutive or does not start at 0.","pos":[2182,2280]},{"content":"0x80041039","pos":[2319,2329]},{"pos":[2332,2386],"content":"The return value for a method has an <bpt id=\"p1\">**</bpt>ID<ept id=\"p1\">**</ept> qualifier.","source":"The return value for a method has an **ID** qualifier."},{"content":"0x80041034","pos":[2420,2430]},{"content":"An attempt was made to reuse an existing method name from a parent class, and the signatures did not match.","pos":[2433,2540]},{"content":"0","pos":[2565,2566]},{"content":"The function call was successful.","pos":[2569,2602]},{"pos":[2611,2618],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2620,2759],"content":"This function wraps a call to the <bpt id=\"p1\">[</bpt>IWbemClassObject::PutMethod<ept id=\"p1\">](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-putmethod)</ept> method.","source":"This function wraps a call to the [IWbemClassObject::PutMethod](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-putmethod) method."},{"content":"This method call is only supported if <ph id=\"ph1\">`ptr`</ph> is a CIM class definition.","pos":[2761,2831],"source":"This method call is only supported if `ptr` is a CIM class definition."},{"content":"Method manipulation is not available from <bpt id=\"p1\">[</bpt>IWbemClassObject<ept id=\"p1\">](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject)</ept> pointers that point to CIM instances.","pos":[2832,2988],"source":" Method manipulation is not available from [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) pointers that point to CIM instances."},{"content":"Users cannot create methods with names that begin or end with an underscore.","pos":[2990,3066]},{"content":"This is reserved for system classes and properties.","pos":[3067,3118]},{"pos":[3120,3280],"content":"For a method, the <ph id=\"ph1\">`in`</ph> and <ph id=\"ph2\">`out`</ph> parameters are described as properties in <bpt id=\"p1\">[</bpt>IWbemClassObject<ept id=\"p1\">](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject)</ept> objects.","source":"For a method, the `in` and `out` parameters are described as properties in [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) objects."},{"content":"An <ph id=\"ph1\">`[in/out]`</ph> parameter can be defined by adding the same property to both objects pointed to by the <ph id=\"ph2\">`pInSignature`</ph> and <ph id=\"ph3\">`pOutSignature`</ph> parameters.","pos":[3282,3429],"source":"An `[in/out]` parameter can be defined by adding the same property to both objects pointed to by the `pInSignature` and `pOutSignature` parameters."},{"content":"In this case, the properties share the same <bpt id=\"p1\">**</bpt>ID<ept id=\"p1\">**</ept> qualifier value.","pos":[3430,3497],"source":" In this case, the properties share the same **ID** qualifier value."},{"content":"Each property in a <bpt id=\"p1\">[</bpt>__Parameters<ept id=\"p1\">](/windows/desktop/WmiSdk/--parameters)</ept> class object other than <ph id=\"ph1\">`ReturnValue`</ph> must have an <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> qualifier, a zero-based numeric value that identifies the order in which the parameters appear.","pos":[3499,3724],"source":"Each property in a [__Parameters](/windows/desktop/WmiSdk/--parameters) class object other than `ReturnValue` must have an **ID** qualifier, a zero-based numeric value that identifies the order in which the parameters appear."},{"content":"No two parameters can have the same <bpt id=\"p1\">**</bpt>ID<ept id=\"p1\">**</ept> value, and no <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> value can be skipped.","pos":[3725,3810],"source":" No two parameters can have the same **ID** value, and no **ID** value can be skipped."},{"content":"If either condition occurs, the <ph id=\"ph1\">`PutMethod`</ph> function returns <ph id=\"ph2\">`WBEM_E_NONCONSECUTIVE_PARAMETER_IDS`</ph>.","pos":[3811,3910],"source":" If either condition occurs, the `PutMethod` function returns `WBEM_E_NONCONSECUTIVE_PARAMETER_IDS`."},{"pos":[3915,3922],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3924,4053],"content":"For an example, see the <bpt id=\"p1\">[</bpt>IWbemClassObject::PutMethod<ept id=\"p1\">](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-putmethod)</ept> method.","source":"For an example, see the [IWbemClassObject::PutMethod](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-putmethod) method."},{"pos":[4058,4070],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4074,4178],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[4185,4213],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> WMINet_Utils.idl","source":"**Header:** WMINet_Utils.idl"},{"pos":[4220,4327],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]"},{"pos":[4336,4344],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4348,4414],"content":"<bpt id=\"p1\">[</bpt>WMI and Performance Counters (Unmanaged API Reference)<ept id=\"p1\">](index.md)</ept>","source":"[WMI and Performance Counters (Unmanaged API Reference)](index.md)"}]}