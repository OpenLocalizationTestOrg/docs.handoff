{"content":"---\ntitle: \"dangerousThreadingAPI MDA\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"suspending threads\"\n  - \"DangerousThreadingAPI MDA\"\n  - \"managed debugging assistants (MDAs), dangerous threading operations\"\n  - \"threading [.NET Framework], suspending\"\n  - \"MDAs (managed debugging assistants), dangerous threading operations\"\n  - \"Suspend method\"\n  - \"threading [.NET Framework], managed debugging assistants\"\nms.assetid: 3e5efbc5-92e4-4229-b31f-ce368a1adb96\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# dangerousThreadingAPI MDA\nThe `dangerousThreadingAPI` managed debugging assistant (MDA) is activated when the <xref:System.Threading.Thread.Suspend%2A?displayProperty=nameWithType> method is called on a thread other than the current thread.  \n  \n## Symptoms  \n An application is unresponsive or hangs indefinitely. System or application data might be left in an unpredictable state temporarily or even after an application has been shut down. Some operations are not completing as expected.  \n  \n Symptoms can vary widely due to the randomness inherent to the problem.  \n  \n## Cause  \n A thread is asynchronously suspended by another thread using the <xref:System.Threading.Thread.Suspend%2A> method. There is no way to determine when it is safe to suspend another thread which might be in the middle of an operation. Suspending the thread can result in the corruption of data or the breaking of invariants. Should a thread be placed into a suspended state and never resumed using the <xref:System.Threading.Thread.Resume%2A> method, the application can hang indefinitely and possibly damage application data. These methods have been marked as obsolete.  \n  \n If synchronization primitives are held by the target thread, they remain held during suspension. This can lead to deadlocks should another thread, for example the thread performing the <xref:System.Threading.Thread.Suspend%2A>, attempt to acquire a lock on the primitive. In this situation, the problem manifests itself as a deadlock.  \n  \n## Resolution  \n Avoid designs that require the use of <xref:System.Threading.Thread.Suspend%2A> and <xref:System.Threading.Thread.Resume%2A>. For cooperation between threads, use synchronization primitives such as <xref:System.Threading.Monitor>, <xref:System.Threading.ReaderWriterLock>, <xref:System.Threading.Mutex>, or the C# `lock` statement. If you must use these methods, reduce the window of time and minimize the amount of code that executes while the thread is in a suspended state.  \n  \n## Effect on the Runtime  \n This MDA has no effect on the CLR. It only reports data about dangerous threading operations.  \n  \n## Output  \n The MDA identifies the dangerous threading method that caused it to be activated.  \n  \n## Configuration  \n  \n```xml  \n<mdaConfig>  \n  <assistants>  \n    <dangerousThreadingAPI />  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## Example  \n The following code example demonstrates a call to the <xref:System.Threading.Thread.Suspend%2A> method that causes the activation of the `dangerousThreadingAPI`.  \n  \n```csharp\nusing System.Threading;  \nvoid FireMda()  \n{  \nThread t = new Thread(delegate() { Thread.Sleep(1000); });  \n    t.Start();  \n    // The following line activates the MDA.  \n    t.Suspend();   \n    t.Resume();  \n    t.Join();  \n}  \n```  \n  \n## See also\n\n- <xref:System.Threading.Thread>\n- [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)\n- [lock Statement](~/docs/csharp/language-reference/keywords/lock-statement.md)\n","nodes":[{"pos":[4,502],"embed":true,"restype":"x-metadata","content":"title: \"dangerousThreadingAPI MDA\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"suspending threads\"\n  - \"DangerousThreadingAPI MDA\"\n  - \"managed debugging assistants (MDAs), dangerous threading operations\"\n  - \"threading [.NET Framework], suspending\"\n  - \"MDAs (managed debugging assistants), dangerous threading operations\"\n  - \"Suspend method\"\n  - \"threading [.NET Framework], managed debugging assistants\"\nms.assetid: 3e5efbc5-92e4-4229-b31f-ce368a1adb96\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"dangerousThreadingAPI MDA","nodes":[{"pos":[0,25],"content":"dangerousThreadingAPI MDA","nodes":[{"content":"dangerousThreadingAPI MDA","pos":[0,25]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[509,534],"content":"dangerousThreadingAPI MDA","linkify":"dangerousThreadingAPI MDA","nodes":[{"content":"dangerousThreadingAPI MDA","pos":[0,25]}]},{"pos":[535,749],"content":"The <ph id=\"ph1\">`dangerousThreadingAPI`</ph> managed debugging assistant (MDA) is activated when the <ph id=\"ph2\">&lt;xref:System.Threading.Thread.Suspend%2A?displayProperty=nameWithType&gt;</ph> method is called on a thread other than the current thread.","source":"The `dangerousThreadingAPI` managed debugging assistant (MDA) is activated when the <xref:System.Threading.Thread.Suspend%2A?displayProperty=nameWithType> method is called on a thread other than the current thread."},{"pos":[758,766],"content":"Symptoms","linkify":"Symptoms","nodes":[{"content":"Symptoms","pos":[0,8]}]},{"content":"An application is unresponsive or hangs indefinitely.","pos":[770,823]},{"content":"System or application data might be left in an unpredictable state temporarily or even after an application has been shut down.","pos":[824,951]},{"content":"Some operations are not completing as expected.","pos":[952,999]},{"content":"Symptoms can vary widely due to the randomness inherent to the problem.","pos":[1006,1077]},{"pos":[1086,1091],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"content":"A thread is asynchronously suspended by another thread using the <ph id=\"ph1\">&lt;xref:System.Threading.Thread.Suspend%2A&gt;</ph> method.","pos":[1095,1209],"source":"A thread is asynchronously suspended by another thread using the <xref:System.Threading.Thread.Suspend%2A> method."},{"content":"There is no way to determine when it is safe to suspend another thread which might be in the middle of an operation.","pos":[1210,1326]},{"content":"Suspending the thread can result in the corruption of data or the breaking of invariants.","pos":[1327,1416]},{"content":"Should a thread be placed into a suspended state and never resumed using the <ph id=\"ph1\">&lt;xref:System.Threading.Thread.Resume%2A&gt;</ph> method, the application can hang indefinitely and possibly damage application data.","pos":[1417,1618],"source":" Should a thread be placed into a suspended state and never resumed using the <xref:System.Threading.Thread.Resume%2A> method, the application can hang indefinitely and possibly damage application data."},{"content":"These methods have been marked as obsolete.","pos":[1619,1662]},{"content":"If synchronization primitives are held by the target thread, they remain held during suspension.","pos":[1669,1765]},{"content":"This can lead to deadlocks should another thread, for example the thread performing the <ph id=\"ph1\">&lt;xref:System.Threading.Thread.Suspend%2A&gt;</ph>, attempt to acquire a lock on the primitive.","pos":[1766,1940],"source":" This can lead to deadlocks should another thread, for example the thread performing the <xref:System.Threading.Thread.Suspend%2A>, attempt to acquire a lock on the primitive."},{"content":"In this situation, the problem manifests itself as a deadlock.","pos":[1941,2003]},{"pos":[2012,2022],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"content":"Avoid designs that require the use of <ph id=\"ph1\">&lt;xref:System.Threading.Thread.Suspend%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Threading.Thread.Resume%2A&gt;</ph>.","pos":[2026,2151],"source":"Avoid designs that require the use of <xref:System.Threading.Thread.Suspend%2A> and <xref:System.Threading.Thread.Resume%2A>."},{"content":"For cooperation between threads, use synchronization primitives such as <ph id=\"ph1\">&lt;xref:System.Threading.Monitor&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Threading.ReaderWriterLock&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Threading.Mutex&gt;</ph>, or the C# <ph id=\"ph4\">`lock`</ph> statement.","pos":[2152,2357],"source":" For cooperation between threads, use synchronization primitives such as <xref:System.Threading.Monitor>, <xref:System.Threading.ReaderWriterLock>, <xref:System.Threading.Mutex>, or the C# `lock` statement."},{"content":"If you must use these methods, reduce the window of time and minimize the amount of code that executes while the thread is in a suspended state.","pos":[2358,2502]},{"pos":[2511,2532],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"content":"This MDA has no effect on the CLR.","pos":[2536,2570]},{"content":"It only reports data about dangerous threading operations.","pos":[2571,2629]},{"pos":[2638,2644],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"The MDA identifies the dangerous threading method that caused it to be activated.","pos":[2648,2729]},{"pos":[2738,2751],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[2874,2881],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2885,3046],"content":"The following code example demonstrates a call to the <ph id=\"ph1\">&lt;xref:System.Threading.Thread.Suspend%2A&gt;</ph> method that causes the activation of the <ph id=\"ph2\">`dangerousThreadingAPI`</ph>.","source":"The following code example demonstrates a call to the <xref:System.Threading.Thread.Suspend%2A> method that causes the activation of the `dangerousThreadingAPI`."},{"pos":[3304,3312],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3349,3502],"content":"<bpt id=\"p1\">[</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept>","source":"[Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)"},{"pos":[3505,3582],"content":"<bpt id=\"p1\">[</bpt>lock Statement<ept id=\"p1\">](~/docs/csharp/language-reference/keywords/lock-statement.md)</ept>","source":"[lock Statement](~/docs/csharp/language-reference/keywords/lock-statement.md)"}]}