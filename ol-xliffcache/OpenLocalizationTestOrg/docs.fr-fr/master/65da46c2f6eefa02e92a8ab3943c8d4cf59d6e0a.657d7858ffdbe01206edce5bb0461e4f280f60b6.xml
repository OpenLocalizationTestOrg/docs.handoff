{"content":"---\ntitle: \"dateTimeInvalidLocalFormat MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"dates [.NET Framework], formatting\"\n  - \"invalid date time local format\"\n  - \"invalid local formats\"\n  - \"MDAs (managed debugging assistants), invalid local formats\"\n  - \"managed debugging assistants (MDAs), invalid local formats\"\n  - \"dateTimeInvalidLocalFormat MDA\"\n  - \"date formatting\"\n  - \"time formatting\"\n  - \"UTC formatting\"\nms.assetid: c4a942bb-2651-4b65-8718-809f892a0659\ncaps.latest.revision: 8\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# dateTimeInvalidLocalFormat MDA\nThe `dateTimeInvalidLocalFormat` MDA is activated when a <xref:System.DateTime> instance that is stored as a Universal Coordinated Time (UTC) is formatted using a format that is intended to be used only for local <xref:System.DateTime> instances. This MDA is not activated for unspecified or default <xref:System.DateTime> instances.  \n  \n## Symptom  \n An application is manually serializing a UTC <xref:System.DateTime> instance using a local format:  \n  \n```  \nDateTime myDateTime = DateTime.UtcNow;  \nSerialize(myDateTime.ToString(\"yyyy-MM-dd'T'HH:mm:ss.fffffffzzz\"));  \n```  \n  \n### Cause  \n The 'z' format for the <xref:System.DateTime.ToString%2A?displayProperty=fullName> method includes the local time zone offset, for example, \"+10:00\" for Sydney time. As such, it will only produce a meaningful result if the value of the <xref:System.DateTime> is local. If the value is UTC time, <xref:System.DateTime.ToString%2A?displayProperty=fullName> includes the local time zone offset, but it does not display or adjust the time zone specifier.  \n  \n### Resolution  \n UTC <xref:System.DateTime> instances should be formatted in a way that indicates that they are UTC. The recommended format for UTC times to use a 'Z' to denote UTC time:  \n  \n```  \nDateTime myDateTime = DateTime.UtcNow;  \nSerialize(myDateTime.ToString(\"yyyy-MM-dd'T'HH:mm:ss.fffffffZ\"));  \n```  \n  \n There is also an \"o\" format that serializes a <xref:System.DateTime> making use of the <xref:System.DateTime.Kind%2A> property that serializes correctly regardless of whether the instance is local, UTC, or unspecified:  \n  \n```  \nDateTime myDateTime = DateTime.UtcNow;  \nSerialize(myDateTime.ToString(\"o\"));  \n```  \n  \n## Effect on the Runtime  \n This MDA does not affect the runtime.  \n  \n## Output  \n There is no special output as a result of this MDA activating., However, the call stack can be used to determine the location of the <xref:System.DateTime.ToString%2A> call that activated the MDA.  \n  \n## Configuration  \n  \n```  \n<mdaConfig>  \n  <assistants>  \n    <dateTimeInvalidLocalFormat />  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## Example  \n Consider an application that is indirectly serializing a UTC <xref:System.DateTime> value by using the <xref:System.Xml.XmlConvert> or <xref:System.Data.DataSet> class, in the following manner.  \n  \n```  \nDateTime myDateTime = DateTime.UtcNow;  \nString serialized = XMLConvert.ToString(myDateTime);  \n```  \n  \n The <xref:System.Xml.XmlConvert> and <xref:System.Data.DataSet> serializations use local formats for serialization by default. Additional options are required to serialize other kinds of <xref:System.DateTime> values, such as UTC.  \n  \n For this specific example, pass in `XmlDateTimeSerializationMode.RoundtripKind` to the `ToString` call on `XmlConvert`. This serializes the data as a UTC time.  \n  \n If using a <xref:System.Data.DataSet>, set the <xref:System.Data.DataColumn.DateTimeMode%2A> property on the <xref:System.Data.DataColumn> object to <xref:System.Data.DataSetDateTime>.  \n  \n```  \nDateTime myDateTime = DateTime.UtcNow;  \nString serialized = XmlConvert.ToString(myDateTime,   \n    XmlDateTimeSerializationMode.RoundtripKind);  \n```  \n  \n## See Also  \n <xref:System.Globalization.DateTimeFormatInfo>   \n [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)","nodes":[{"pos":[4,769],"nodes":[{"content":"dateTimeInvalidLocalFormat MDA | Microsoft Docs","nodes":[{"pos":[0,47],"content":"dateTimeInvalidLocalFormat MDA | Microsoft Docs","nodes":[{"content":"dateTimeInvalidLocalFormat MDA | Microsoft Docs","pos":[0,47]}]}],"pos":[6,56],"yaml":true}],"content":"title: \"dateTimeInvalidLocalFormat MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"dates [.NET Framework], formatting\"\n  - \"invalid date time local format\"\n  - \"invalid local formats\"\n  - \"MDAs (managed debugging assistants), invalid local formats\"\n  - \"managed debugging assistants (MDAs), invalid local formats\"\n  - \"dateTimeInvalidLocalFormat MDA\"\n  - \"date formatting\"\n  - \"time formatting\"\n  - \"UTC formatting\"\nms.assetid: c4a942bb-2651-4b65-8718-809f892a0659\ncaps.latest.revision: 8\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[776,806],"content":"dateTimeInvalidLocalFormat MDA","linkify":"dateTimeInvalidLocalFormat MDA","nodes":[{"content":"dateTimeInvalidLocalFormat MDA","pos":[0,30]}]},{"content":"The <ph id=\"ph1\">`dateTimeInvalidLocalFormat`</ph> MDA is activated when a <ph id=\"ph2\">&lt;xref:System.DateTime&gt;</ph> instance that is stored as a Universal Coordinated Time (UTC) is formatted using a format that is intended to be used only for local <ph id=\"ph3\">&lt;xref:System.DateTime&gt;</ph> instances.","pos":[807,1053],"source":"The `dateTimeInvalidLocalFormat` MDA is activated when a <xref:System.DateTime> instance that is stored as a Universal Coordinated Time (UTC) is formatted using a format that is intended to be used only for local <xref:System.DateTime> instances."},{"content":"This MDA is not activated for unspecified or default <ph id=\"ph1\">&lt;xref:System.DateTime&gt;</ph> instances.","pos":[1054,1140],"source":" This MDA is not activated for unspecified or default <xref:System.DateTime> instances."},{"pos":[1149,1156],"content":"Symptom","linkify":"Symptom","nodes":[{"content":"Symptom","pos":[0,7]}]},{"content":"An application is manually serializing a UTC <ph id=\"ph1\">&lt;xref:System.DateTime&gt;</ph> instance using a local format:","pos":[1160,1258],"source":"An application is manually serializing a UTC <xref:System.DateTime> instance using a local format:"},{"pos":[1394,1399],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"content":"The 'z' format for the <ph id=\"ph1\">&lt;xref:System.DateTime.ToString%2A?displayProperty=fullName&gt;</ph> method includes the local time zone offset, for example, \"+10:00\" for Sydney time.","pos":[1403,1568],"source":"The 'z' format for the <xref:System.DateTime.ToString%2A?displayProperty=fullName> method includes the local time zone offset, for example, \"+10:00\" for Sydney time."},{"content":"As such, it will only produce a meaningful result if the value of the <ph id=\"ph1\">&lt;xref:System.DateTime&gt;</ph> is local.","pos":[1569,1671],"source":" As such, it will only produce a meaningful result if the value of the <xref:System.DateTime> is local."},{"content":"If the value is UTC time, <ph id=\"ph1\">&lt;xref:System.DateTime.ToString%2A?displayProperty=fullName&gt;</ph> includes the local time zone offset, but it does not display or adjust the time zone specifier.","pos":[1672,1853],"source":" If the value is UTC time, <xref:System.DateTime.ToString%2A?displayProperty=fullName> includes the local time zone offset, but it does not display or adjust the time zone specifier."},{"pos":[1863,1873],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"content":"UTC <ph id=\"ph1\">&lt;xref:System.DateTime&gt;</ph> instances should be formatted in a way that indicates that they are UTC.","pos":[1877,1976],"source":"UTC <xref:System.DateTime> instances should be formatted in a way that indicates that they are UTC."},{"content":"The recommended format for UTC times to use a 'Z' to denote UTC time:","pos":[1977,2046]},{"content":"There is also an \"o\" format that serializes a <ph id=\"ph1\">&lt;xref:System.DateTime&gt;</ph> making use of the <ph id=\"ph2\">&lt;xref:System.DateTime.Kind%2A&gt;</ph> property that serializes correctly regardless of whether the instance is local, UTC, or unspecified:","pos":[2177,2395],"source":"There is also an \"o\" format that serializes a <xref:System.DateTime> making use of the <xref:System.DateTime.Kind%2A> property that serializes correctly regardless of whether the instance is local, UTC, or unspecified:"},{"pos":[2499,2520],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"content":"This MDA does not affect the runtime.","pos":[2524,2561]},{"pos":[2570,2576],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"There is no special output as a result of this MDA activating., However, the call stack can be used to determine the location of the <ph id=\"ph1\">&lt;xref:System.DateTime.ToString%2A&gt;</ph> call that activated the MDA.","pos":[2580,2776],"source":"There is no special output as a result of this MDA activating., However, the call stack can be used to determine the location of the <xref:System.DateTime.ToString%2A> call that activated the MDA."},{"pos":[2785,2798],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[2923,2930],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"Consider an application that is indirectly serializing a UTC <ph id=\"ph1\">&lt;xref:System.DateTime&gt;</ph> value by using the <ph id=\"ph2\">&lt;xref:System.Xml.XmlConvert&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Data.DataSet&gt;</ph> class, in the following manner.","pos":[2934,3127],"source":"Consider an application that is indirectly serializing a UTC <xref:System.DateTime> value by using the <xref:System.Xml.XmlConvert> or <xref:System.Data.DataSet> class, in the following manner."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlConvert&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Data.DataSet&gt;</ph> serializations use local formats for serialization by default.","pos":[3245,3371],"source":"The <xref:System.Xml.XmlConvert> and <xref:System.Data.DataSet> serializations use local formats for serialization by default."},{"content":"Additional options are required to serialize other kinds of <ph id=\"ph1\">&lt;xref:System.DateTime&gt;</ph> values, such as UTC.","pos":[3372,3475],"source":" Additional options are required to serialize other kinds of <xref:System.DateTime> values, such as UTC."},{"content":"For this specific example, pass in <ph id=\"ph1\">`XmlDateTimeSerializationMode.RoundtripKind`</ph> to the <ph id=\"ph2\">`ToString`</ph> call on <ph id=\"ph3\">`XmlConvert`</ph>.","pos":[3482,3601],"source":"For this specific example, pass in `XmlDateTimeSerializationMode.RoundtripKind` to the `ToString` call on `XmlConvert`."},{"content":"This serializes the data as a UTC time.","pos":[3602,3641]},{"content":"If using a <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph>, set the <ph id=\"ph2\">&lt;xref:System.Data.DataColumn.DateTimeMode%2A&gt;</ph> property on the <ph id=\"ph3\">&lt;xref:System.Data.DataColumn&gt;</ph> object to <ph id=\"ph4\">&lt;xref:System.Data.DataSetDateTime&gt;</ph>.","pos":[3648,3832],"source":"If using a <xref:System.Data.DataSet>, set the <xref:System.Data.DataColumn.DateTimeMode%2A> property on the <xref:System.Data.DataColumn> object to <xref:System.Data.DataSetDateTime>."},{"pos":[4003,4011],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Globalization.DateTimeFormatInfo&gt;</ph>","pos":[4015,4061],"source":"<xref:System.Globalization.DateTimeFormatInfo> "},{"content":"<bpt id=\"p1\">[</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept>","pos":[4066,4219],"source":"[Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)"}]}