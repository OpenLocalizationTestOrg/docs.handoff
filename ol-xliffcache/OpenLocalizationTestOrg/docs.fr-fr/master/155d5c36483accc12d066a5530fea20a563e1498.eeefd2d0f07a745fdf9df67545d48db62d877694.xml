{"content":"---\ntitle: \"Visual Basic Features That Support LINQ\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"Visual Basic, LINQ features\"\n  - \"LINQ [Visual Basic], features supporting LINQ\"\nms.assetid: c821bb50-b6f6-4cf9-8aba-2717e465bd3a\n---\n# Visual Basic Features That Support LINQ\nThe name [!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)] refers to technology in Visual Basic that supports query syntax and other language constructs directly in the language. With [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], you do not have to learn a new language to query against an external data source. You can query against data in relational databases, XML stores, or objects by using Visual Basic. This integration of query capabilities into the language enables compile-time checking for syntax errors and type safety. This integration also ensures that you already know most of what you have to know to write rich, varied queries in Visual Basic.  \n  \n The following sections describe the language constructs that support LINQ in enough detail to enable you to get started in reading the introductory documentation, code examples, and sample applications. You can also click the links to find more detailed explanations of how the language features come together to enable language-integrated query. A good place to start is [Walkthrough: Writing Queries in Visual Basic](../../../../visual-basic/programming-guide/concepts/linq/walkthrough-writing-queries.md).  \n  \n## Query Expressions  \n Query expressions in Visual Basic can be expressed in a declarative syntax similar to that of SQL or XQuery. At compile time, query syntax is converted into method calls to a LINQ provider's implementation of the standard query operator extension methods. Applications control which standard query operators are in scope by specifying the appropriate namespace with an `Imports` statement. Syntax for a Visual Basic query expression looks like this:  \n  \n [!code-vb[VbLINQVbFeatures#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQVbFeatures/VB/Class1.vb#1)]  \n  \n For more information, see [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md).  \n  \n## Implicitly Typed Variables  \n Instead of explicitly specifying a type when you declare and initialize a variable, you can enable the compiler to infer and assign the type. This is referred to as *local type inference*.  \n  \n Variables whose types are inferred are strongly typed, just like variables whose type you specify explicitly. Local type inference works only when you are defining a local variable inside a method body. For more information, see [Option Infer Statement](../../../../visual-basic/language-reference/statements/option-infer-statement.md) and [Local Type Inference](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md).  \n  \n The following example illustrates local type inference. To use this example, you must set `Option Infer` to `On`.  \n  \n [!code-vb[VbLINQVbFeatures#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQVbFeatures/VB/Class1.vb#2)]  \n  \n Local type inference also makes it possible to create anonymous types, which are described later in this section and are necessary for LINQ queries.  \n  \n In the following LINQ example, type inference occurs if `Option Infer` is either `On` or `Off`. A compile-time error occurs if `Option Infer` is `Off` and `Option Strict` is `On`.  \n  \n [!code-vb[VbLINQVbFeatures#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQVbFeatures/VB/Class1.vb#3)]  \n  \n## Object Initializers  \n Object initializers are used in query expressions when you have to create an anonymous type to hold the results of a query. They also can be used to initialize objects of named types outside of queries. By using an object initializer, you can initialize an object in a single line without explicitly calling a constructor. Assuming that you have a class named `Customer` that has public `Name` and `Phone` properties, along with other properties, an object initializer can be used in this manner:  \n  \n [!code-vb[VbLINQVbFeatures#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQVbFeatures/VB/Class1.vb#4)]  \n  \n For more information, see [Object Initializers: Named and Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md).  \n  \n## Anonymous Types  \n Anonymous types provide a convenient way to temporarily group a set of properties into an element that you want to include in a query result. This enables you to choose any combination of available fields in the query, in any order, without defining a named data type for the element.  \n  \n An *anonymous type* is constructed dynamically by the compiler. The name of the type is assigned by the compiler, and it might change with each new compilation. Therefore, the name cannot be used directly. Anonymous types are initialized in the following way:  \n  \n [!code-vb[VbLINQVbFeatures#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQVbFeatures/VB/Class1.vb#5)]  \n  \n For more information, see [Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md).  \n  \n## Extension Methods  \n Extension methods enable you to add methods to a data type or interface from outside the definition. This feature enables you to, in effect, add new methods to an existing type without actually modifying the type. The standard query operators are themselves a set of extension methods that provide [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query functionality for any type that implements <xref:System.Collections.Generic.IEnumerable%601>. Other extensions to <xref:System.Collections.Generic.IEnumerable%601> include <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.Union%2A>, and <xref:System.Linq.Enumerable.Intersect%2A>.  \n  \n The following extension method adds a print method to the <xref:System.String> class.  \n  \n [!code-vb[VbLINQVbFeatures#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQVbFeatures/VB/Class1.vb#6)]  \n  \n The method is called like an ordinary instance method of <xref:System.String>:  \n  \n [!code-vb[VbLINQVbFeatures#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQVbFeatures/VB/Class1.vb#7)]  \n  \n For more information, see [Extension Methods](../../../../visual-basic/programming-guide/language-features/procedures/extension-methods.md).  \n  \n## Lambda Expressions  \n A lambda expression is a function without a name that calculates and returns a single value. Unlike named functions, a lambda expression can be defined and executed at the same time. The following example displays 4.  \n  \n [!code-vb[VbLINQVbFeatures#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQVbFeatures/VB/Class1.vb#8)]  \n  \n You can assign the lambda expression definition to a variable name and then use the name to call the function. The following example also displays 4.  \n  \n [!code-vb[VbLINQVbFeatures#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQVbFeatures/VB/Class1.vb#12)]  \n  \n In [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], lambda expressions underlie many of the standard query operators. The compiler creates lambda expressions to capture the calculations that are defined in fundamental query methods such as `Where`, `Select`, `Order By`, `Take While`, and others.  \n  \n For example, the following code defines a query that returns all senior students from a list of students.  \n  \n [!code-vb[VbLINQVbFeatures#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQVbFeatures/VB/Class1.vb#9)]  \n  \n The query definition is compiled into code that is similar to the following example, which uses two lambda expressions to specify the arguments for `Where` and `Select`.  \n  \n [!code-vb[VbLINQVbFeatures#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQVbFeatures/VB/Class1.vb#10)]  \n  \n Either version can be run by using a `For Each` loop:  \n  \n [!code-vb[VbLINQVbFeatures#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQVbFeatures/VB/Class1.vb#11)]  \n  \n For more information, see [Lambda Expressions](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md).  \n  \n## See also\n\n- [Language-Integrated Query (LINQ) (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/index.md)\n- [Getting Started with LINQ in Visual Basic](../../../../visual-basic/programming-guide/concepts/linq/getting-started-with-linq.md)\n- [LINQ and Strings (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-strings.md)\n- [Option Infer Statement](../../../../visual-basic/language-reference/statements/option-infer-statement.md)\n- [Option Strict Statement](../../../../visual-basic/language-reference/statements/option-strict-statement.md)\n","nodes":[{"pos":[4,229],"embed":true,"restype":"x-metadata","content":"title: \"Visual Basic Features That Support LINQ\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"Visual Basic, LINQ features\"\n  - \"LINQ [Visual Basic], features supporting LINQ\"\nms.assetid: c821bb50-b6f6-4cf9-8aba-2717e465bd3a","nodes":[{"content":"Visual Basic Features That Support LINQ","nodes":[{"pos":[0,39],"content":"Visual Basic Features That Support LINQ","nodes":[{"content":"Visual Basic Features That Support LINQ","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[236,275],"content":"Visual Basic Features That Support LINQ","linkify":"Visual Basic Features That Support LINQ","nodes":[{"content":"Visual Basic Features That Support LINQ","pos":[0,39]}]},{"content":"The name <ph id=\"ph1\">[!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)]</ph> refers to technology in Visual Basic that supports query syntax and other language constructs directly in the language.","pos":[276,460],"source":"The name [!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)] refers to technology in Visual Basic that supports query syntax and other language constructs directly in the language."},{"content":"With <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph>, you do not have to learn a new language to query against an external data source.","pos":[461,598],"source":" With [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], you do not have to learn a new language to query against an external data source."},{"content":"You can query against data in relational databases, XML stores, or objects by using Visual Basic.","pos":[599,696]},{"content":"This integration of query capabilities into the language enables compile-time checking for syntax errors and type safety.","pos":[697,818]},{"content":"This integration also ensures that you already know most of what you have to know to write rich, varied queries in Visual Basic.","pos":[819,947]},{"content":"The following sections describe the language constructs that support LINQ in enough detail to enable you to get started in reading the introductory documentation, code examples, and sample applications.","pos":[954,1156]},{"content":"You can also click the links to find more detailed explanations of how the language features come together to enable language-integrated query.","pos":[1157,1300]},{"content":"A good place to start is <bpt id=\"p1\">[</bpt>Walkthrough: Writing Queries in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/walkthrough-writing-queries.md)</ept>.","pos":[1301,1462],"source":" A good place to start is [Walkthrough: Writing Queries in Visual Basic](../../../../visual-basic/programming-guide/concepts/linq/walkthrough-writing-queries.md)."},{"pos":[1471,1488],"content":"Query Expressions","linkify":"Query Expressions","nodes":[{"content":"Query Expressions","pos":[0,17]}]},{"content":"Query expressions in Visual Basic can be expressed in a declarative syntax similar to that of SQL or XQuery.","pos":[1492,1600]},{"content":"At compile time, query syntax is converted into method calls to a LINQ provider's implementation of the standard query operator extension methods.","pos":[1601,1747]},{"content":"Applications control which standard query operators are in scope by specifying the appropriate namespace with an <ph id=\"ph1\">`Imports`</ph> statement.","pos":[1748,1881],"source":" Applications control which standard query operators are in scope by specifying the appropriate namespace with an `Imports` statement."},{"content":"Syntax for a Visual Basic query expression looks like this:","pos":[1882,1941]},{"pos":[2070,2226],"content":"For more information, see <bpt id=\"p1\">[</bpt>Introduction to LINQ in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)</ept>.","source":"For more information, see [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)."},{"pos":[2235,2261],"content":"Implicitly Typed Variables","linkify":"Implicitly Typed Variables","nodes":[{"content":"Implicitly Typed Variables","pos":[0,26]}]},{"content":"Instead of explicitly specifying a type when you declare and initialize a variable, you can enable the compiler to infer and assign the type.","pos":[2265,2406]},{"content":"This is referred to as <bpt id=\"p1\">*</bpt>local type inference<ept id=\"p1\">*</ept>.","pos":[2407,2453],"source":" This is referred to as *local type inference*."},{"content":"Variables whose types are inferred are strongly typed, just like variables whose type you specify explicitly.","pos":[2460,2569]},{"content":"Local type inference works only when you are defining a local variable inside a method body.","pos":[2570,2662]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Option Infer Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/option-infer-statement.md)</ept> and <bpt id=\"p2\">[</bpt>Local Type Inference<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)</ept>.","pos":[2663,2919],"source":" For more information, see [Option Infer Statement](../../../../visual-basic/language-reference/statements/option-infer-statement.md) and [Local Type Inference](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)."},{"content":"The following example illustrates local type inference.","pos":[2926,2981]},{"content":"To use this example, you must set <ph id=\"ph1\">`Option Infer`</ph> to <ph id=\"ph2\">`On`</ph>.","pos":[2982,3039],"source":" To use this example, you must set `Option Infer` to `On`."},{"content":"Local type inference also makes it possible to create anonymous types, which are described later in this section and are necessary for LINQ queries.","pos":[3168,3316]},{"content":"In the following LINQ example, type inference occurs if <ph id=\"ph1\">`Option Infer`</ph> is either <ph id=\"ph2\">`On`</ph> or <ph id=\"ph3\">`Off`</ph>.","pos":[3323,3418],"source":"In the following LINQ example, type inference occurs if `Option Infer` is either `On` or `Off`."},{"content":"A compile-time error occurs if <ph id=\"ph1\">`Option Infer`</ph> is <ph id=\"ph2\">`Off`</ph> and <ph id=\"ph3\">`Option Strict`</ph> is <ph id=\"ph4\">`On`</ph>.","pos":[3419,3502],"source":" A compile-time error occurs if `Option Infer` is `Off` and `Option Strict` is `On`."},{"pos":[3633,3652],"content":"Object Initializers","linkify":"Object Initializers","nodes":[{"content":"Object Initializers","pos":[0,19]}]},{"content":"Object initializers are used in query expressions when you have to create an anonymous type to hold the results of a query.","pos":[3656,3779]},{"content":"They also can be used to initialize objects of named types outside of queries.","pos":[3780,3858]},{"content":"By using an object initializer, you can initialize an object in a single line without explicitly calling a constructor.","pos":[3859,3978]},{"content":"Assuming that you have a class named <ph id=\"ph1\">`Customer`</ph> that has public <ph id=\"ph2\">`Name`</ph> and <ph id=\"ph3\">`Phone`</ph> properties, along with other properties, an object initializer can be used in this manner:","pos":[3979,4152],"source":" Assuming that you have a class named `Customer` that has public `Name` and `Phone` properties, along with other properties, an object initializer can be used in this manner:"},{"pos":[4281,4487],"content":"For more information, see <bpt id=\"p1\">[</bpt>Object Initializers: Named and Anonymous Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)</ept>.","source":"For more information, see [Object Initializers: Named and Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)."},{"pos":[4496,4511],"content":"Anonymous Types","linkify":"Anonymous Types","nodes":[{"content":"Anonymous Types","pos":[0,15]}]},{"content":"Anonymous types provide a convenient way to temporarily group a set of properties into an element that you want to include in a query result.","pos":[4515,4656]},{"content":"This enables you to choose any combination of available fields in the query, in any order, without defining a named data type for the element.","pos":[4657,4799]},{"content":"An <bpt id=\"p1\">*</bpt>anonymous type<ept id=\"p1\">*</ept> is constructed dynamically by the compiler.","pos":[4806,4869],"source":"An *anonymous type* is constructed dynamically by the compiler."},{"content":"The name of the type is assigned by the compiler, and it might change with each new compilation.","pos":[4870,4966]},{"content":"Therefore, the name cannot be used directly.","pos":[4967,5011]},{"content":"Anonymous types are initialized in the following way:","pos":[5012,5065]},{"pos":[5194,5339],"content":"For more information, see <bpt id=\"p1\">[</bpt>Anonymous Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)</ept>.","source":"For more information, see [Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)."},{"pos":[5348,5365],"content":"Extension Methods","linkify":"Extension Methods","nodes":[{"content":"Extension Methods","pos":[0,17]}]},{"content":"Extension methods enable you to add methods to a data type or interface from outside the definition.","pos":[5369,5469]},{"content":"This feature enables you to, in effect, add new methods to an existing type without actually modifying the type.","pos":[5470,5582]},{"content":"The standard query operators are themselves a set of extension methods that provide <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> query functionality for any type that implements <ph id=\"ph2\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph>.","pos":[5583,5816],"source":" The standard query operators are themselves a set of extension methods that provide [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query functionality for any type that implements <xref:System.Collections.Generic.IEnumerable%601>."},{"content":"Other extensions to <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> include <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.Count%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Linq.Enumerable.Union%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Linq.Enumerable.Intersect%2A&gt;</ph>.","pos":[5817,6022],"source":" Other extensions to <xref:System.Collections.Generic.IEnumerable%601> include <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.Union%2A>, and <xref:System.Linq.Enumerable.Intersect%2A>."},{"pos":[6029,6114],"content":"The following extension method adds a print method to the <ph id=\"ph1\">&lt;xref:System.String&gt;</ph> class.","source":"The following extension method adds a print method to the <xref:System.String> class."},{"pos":[6243,6321],"content":"The method is called like an ordinary instance method of <ph id=\"ph1\">&lt;xref:System.String&gt;</ph>:","source":"The method is called like an ordinary instance method of <xref:System.String>:"},{"pos":[6450,6590],"content":"For more information, see <bpt id=\"p1\">[</bpt>Extension Methods<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/procedures/extension-methods.md)</ept>.","source":"For more information, see [Extension Methods](../../../../visual-basic/programming-guide/language-features/procedures/extension-methods.md)."},{"pos":[6599,6617],"content":"Lambda Expressions","linkify":"Lambda Expressions","nodes":[{"content":"Lambda Expressions","pos":[0,18]}]},{"content":"A lambda expression is a function without a name that calculates and returns a single value.","pos":[6621,6713]},{"content":"Unlike named functions, a lambda expression can be defined and executed at the same time.","pos":[6714,6803]},{"content":"The following example displays 4.","pos":[6804,6837]},{"content":"You can assign the lambda expression definition to a variable name and then use the name to call the function.","pos":[6966,7076]},{"content":"The following example also displays 4.","pos":[7077,7115]},{"content":"In <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph>, lambda expressions underlie many of the standard query operators.","pos":[7246,7365],"source":"In [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], lambda expressions underlie many of the standard query operators."},{"content":"The compiler creates lambda expressions to capture the calculations that are defined in fundamental query methods such as <ph id=\"ph1\">`Where`</ph>, <ph id=\"ph2\">`Select`</ph>, <ph id=\"ph3\">`Order By`</ph>, <ph id=\"ph4\">`Take While`</ph>, and others.","pos":[7366,7544],"source":" The compiler creates lambda expressions to capture the calculations that are defined in fundamental query methods such as `Where`, `Select`, `Order By`, `Take While`, and others."},{"content":"For example, the following code defines a query that returns all senior students from a list of students.","pos":[7551,7656]},{"pos":[7785,7954],"content":"The query definition is compiled into code that is similar to the following example, which uses two lambda expressions to specify the arguments for <ph id=\"ph1\">`Where`</ph> and <ph id=\"ph2\">`Select`</ph>.","source":"The query definition is compiled into code that is similar to the following example, which uses two lambda expressions to specify the arguments for `Where` and `Select`."},{"pos":[8085,8138],"content":"Either version can be run by using a <ph id=\"ph1\">`For Each`</ph> loop:","source":"Either version can be run by using a `For Each` loop:"},{"pos":[8269,8411],"content":"For more information, see <bpt id=\"p1\">[</bpt>Lambda Expressions<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)</ept>.","source":"For more information, see [Lambda Expressions](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)."},{"pos":[8420,8428],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8432,8548],"content":"<bpt id=\"p1\">[</bpt>Language-Integrated Query (LINQ) (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/index.md)</ept>","source":"[Language-Integrated Query (LINQ) (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/index.md)"},{"pos":[8551,8681],"content":"<bpt id=\"p1\">[</bpt>Getting Started with LINQ in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/getting-started-with-linq.md)</ept>","source":"[Getting Started with LINQ in Visual Basic](../../../../visual-basic/programming-guide/concepts/linq/getting-started-with-linq.md)"},{"pos":[8684,8795],"content":"<bpt id=\"p1\">[</bpt>LINQ and Strings (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-and-strings.md)</ept>","source":"[LINQ and Strings (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-strings.md)"},{"pos":[8798,8904],"content":"<bpt id=\"p1\">[</bpt>Option Infer Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/option-infer-statement.md)</ept>","source":"[Option Infer Statement](../../../../visual-basic/language-reference/statements/option-infer-statement.md)"},{"pos":[8907,9015],"content":"<bpt id=\"p1\">[</bpt>Option Strict Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/option-strict-statement.md)</ept>","source":"[Option Strict Statement](../../../../visual-basic/language-reference/statements/option-strict-statement.md)"}]}