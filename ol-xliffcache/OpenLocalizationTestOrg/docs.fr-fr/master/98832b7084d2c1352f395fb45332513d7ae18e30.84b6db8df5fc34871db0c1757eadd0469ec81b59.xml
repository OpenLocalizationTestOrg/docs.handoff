{"content":"---\ntitle: \"How to: Simulate Mouse and Keyboard Events in Code | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"keyboards, event simulation\"\n  - \"user input, simulating\"\n  - \"SendKeys, using\"\n  - \"mouse clicks, simulating\"\n  - \"mouse, event simulation\"\nms.assetid: 6abcb67e-3766-4af2-9590-bf5dabd17e41\ncaps.latest.revision: 14\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Simulate Mouse and Keyboard Events in Code\nWindows Forms provides several options for programmatically simulating mouse and keyboard input. This topic provides an overview of these options.  \n  \n## Simulating Mouse Input  \n The best way to simulate mouse events is to call the `On`*EventName* method that raises the mouse event you want to simulate. This option is usually possible only within custom controls and forms, because the methods that raise events are protected and cannot be accessed outside the control or form. For example, the following steps illustrate how to simulate clicking the right mouse button in code.  \n  \n#### To programmatically click the right mouse button  \n  \n1.  Create a <xref:System.Windows.Forms.MouseEventArgs> whose <xref:System.Windows.Forms.MouseEventArgs.Button%2A> property is set to the <xref:System.Windows.Forms.MouseButtons?displayProperty=fullName> value.  \n  \n2.  Call the <xref:System.Windows.Forms.Control.OnMouseClick%2A> method with this <xref:System.Windows.Forms.MouseEventArgs> as the argument.  \n  \n For more information on custom controls, see [Developing Windows Forms Controls at Design Time](../../../docs/framework/winforms/controls/developing-windows-forms-controls-at-design-time.md).  \n  \n There are other ways to simulate mouse input. For example, you can programmatically set a control property that represents a state that is typically set through mouse input (such as the <xref:System.Windows.Forms.CheckBox.Checked%2A> property of the <xref:System.Windows.Forms.CheckBox> control), or you can directly call the delegate that is attached to the event you want to simulate.  \n  \n## Simulating Keyboard Input  \n Although you can simulate keyboard input by using the strategies discussed above for mouse input, Windows Forms also provides the <xref:System.Windows.Forms.SendKeys> class for sending keystrokes to the active application.  \n  \n> [!CAUTION]\n>  If your application is intended for international use with a variety of keyboards, the use of <xref:System.Windows.Forms.SendKeys.Send%2A?displayProperty=fullName> could yield unpredictable results and should be avoided.  \n  \n> [!NOTE]\n>  The <xref:System.Windows.Forms.SendKeys> class has been updated for the .NET Framework 3.0 to enable its use in applications that run on Windows Vista. The enhanced security of Windows Vista (known as User Account Control or UAC) prevents the previous implementation from working as expected.  \n>   \n>  The <xref:System.Windows.Forms.SendKeys> class is susceptible to timing issues, which some developers have had to work around. The updated implementation is still susceptible to timing issues, but is slightly faster and may require changes to the workarounds. The <xref:System.Windows.Forms.SendKeys> class tries to use the previous implementation first, and if that fails, uses the new implementation. As a result, the <xref:System.Windows.Forms.SendKeys> class may behave differently on different operating systems. Additionally, when the <xref:System.Windows.Forms.SendKeys> class uses the new implementation, the <xref:System.Windows.Forms.SendKeys.SendWait%2A> method will not wait for messages to be processed when they are sent to another process.  \n>   \n>  If your application relies on consistent behavior regardless of the operating system, you can force the <xref:System.Windows.Forms.SendKeys> class to use the new implementation by adding the following application setting to your app.config file.  \n>   \n>  `<appSettings>`  \n>   \n>  `<add key=\"SendKeys\" value=\"SendInput\"/>`  \n>   \n>  `</appSettings>`  \n>   \n>  To force the <xref:System.Windows.Forms.SendKeys> class to use the previous implementation, use the value `\"JournalHook\"` instead.  \n  \n#### To send a keystroke to the same application  \n  \n1.  Call the <xref:System.Windows.Forms.SendKeys.Send%2A> or <xref:System.Windows.Forms.SendKeys.SendWait%2A> method of the <xref:System.Windows.Forms.SendKeys> class. The specified keystrokes will be received by the active control of the application. The following code example uses <xref:System.Windows.Forms.SendKeys.Send%2A> to simulate pressing the ENTER key when the user double-clicks the surface of the form. This example assumes a <xref:System.Windows.Forms.Form> with a single <xref:System.Windows.Forms.Button> control that has a tab index of 0.  \n  \n     [!code-cpp[System.Windows.Forms.SimulateKeyPress#10](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/cpp/form1.cpp#10)]\n     [!code-csharp[System.Windows.Forms.SimulateKeyPress#10](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/CS/form1.cs#10)]\n     [!code-vb[System.Windows.Forms.SimulateKeyPress#10](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/VB/form1.vb#10)]  \n  \n#### To send a keystroke to a different application  \n  \n1.  Activate the application window that will receive the keystrokes, and then call the <xref:System.Windows.Forms.SendKeys.Send%2A> or <xref:System.Windows.Forms.SendKeys.SendWait%2A> method. Because there is no managed method to activate another application, you must use native Windows methods to force focus on other applications. The following code example uses platform invoke to call the `FindWindow` and `SetForegroundWindow` methods to activate the Calculator application window, and then calls <xref:System.Windows.Forms.SendKeys.SendWait%2A> to issue a series of calculations to the Calculator application.  \n  \n    > [!NOTE]\n    >  The correct parameters of the `FindWindow` call that locates the Calculator application vary based on your version of Windows.  The following code finds the Calculator application on [!INCLUDE[win7](../../../includes/win7-md.md)]. On [!INCLUDE[windowsver](../../../includes/windowsver-md.md)], change the first parameter to \"SciCalc\". You can use the Spy++ tool, included with Visual Studio, to determine the correct parameters.  \n  \n     [!code-cpp[System.Windows.Forms.SimulateKeyPress#5](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/cpp/form1.cpp#5)]\n     [!code-csharp[System.Windows.Forms.SimulateKeyPress#5](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/CS/form1.cs#5)]\n     [!code-vb[System.Windows.Forms.SimulateKeyPress#5](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/VB/form1.vb#5)]  \n  \n## Example  \n The following code example is the complete application for the previous code examples.  \n  \n [!code-cpp[System.Windows.Forms.SimulateKeyPress#0](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/cpp/form1.cpp#0)]\n [!code-csharp[System.Windows.Forms.SimulateKeyPress#0](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/CS/form1.cs#0)]\n [!code-vb[System.Windows.Forms.SimulateKeyPress#0](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/VB/form1.vb#0)]  \n  \n## Compiling the Code  \n This example requires:  \n  \n-   References to the System, System.Drawing and System.Windows.Forms assemblies.  \n  \n For information about building this example from the command line for [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] or [!INCLUDE[csprcs](../../../includes/csprcs-md.md)], see [Building from the Command Line](~/docs/visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md). You can also build this example in [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] by pasting the code into a new project.  Also see [How to: Compile and Run a Complete Windows Forms Code Example Using Visual Studio](http://msdn.microsoft.com/library/Bb129228\\(v=vs.110\\)).  \n  \n## See Also  \n [User Input in Windows Forms](../../../docs/framework/winforms/user-input-in-windows-forms.md)","nodes":[{"pos":[4,578],"embed":true,"restype":"x-metadata","content":"title: \"How to: Simulate Mouse and Keyboard Events in Code | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"keyboards, event simulation\"\n  - \"user input, simulating\"\n  - \"SendKeys, using\"\n  - \"mouse clicks, simulating\"\n  - \"mouse, event simulation\"\nms.assetid: 6abcb67e-3766-4af2-9590-bf5dabd17e41\ncaps.latest.revision: 14\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"How to: Simulate Mouse and Keyboard Events in Code | Microsoft Docs","nodes":[{"pos":[0,67],"content":"How to: Simulate Mouse and Keyboard Events in Code | Microsoft Docs","nodes":[{"content":"How to: Simulate Mouse and Keyboard Events in Code | Microsoft Docs","pos":[0,67]}]}],"path":["title"]}],"yml":true},{"pos":[585,635],"content":"How to: Simulate Mouse and Keyboard Events in Code","linkify":"How to: Simulate Mouse and Keyboard Events in Code","nodes":[{"content":"How to: Simulate Mouse and Keyboard Events in Code","pos":[0,50]}]},{"content":"Windows Forms provides several options for programmatically simulating mouse and keyboard input.","pos":[636,732]},{"content":"This topic provides an overview of these options.","pos":[733,782]},{"pos":[791,813],"content":"Simulating Mouse Input","linkify":"Simulating Mouse Input","nodes":[{"content":"Simulating Mouse Input","pos":[0,22]}]},{"content":"The best way to simulate mouse events is to call the <ph id=\"ph1\">`On`</ph><bpt id=\"p1\">*</bpt>EventName<ept id=\"p1\">*</ept> method that raises the mouse event you want to simulate.","pos":[817,942],"source":"The best way to simulate mouse events is to call the `On`*EventName* method that raises the mouse event you want to simulate."},{"content":"This option is usually possible only within custom controls and forms, because the methods that raise events are protected and cannot be accessed outside the control or form.","pos":[943,1117]},{"content":"For example, the following steps illustrate how to simulate clicking the right mouse button in code.","pos":[1118,1218]},{"pos":[1229,1277],"content":"To programmatically click the right mouse button","linkify":"To programmatically click the right mouse button","nodes":[{"content":"To programmatically click the right mouse button","pos":[0,48]}]},{"content":"Create a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MouseEventArgs&gt;</ph> whose <ph id=\"ph2\">&lt;xref:System.Windows.Forms.MouseEventArgs.Button%2A&gt;</ph> property is set to the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.MouseButtons?displayProperty=fullName&gt;</ph> value.","pos":[1287,1493],"source":"Create a <xref:System.Windows.Forms.MouseEventArgs> whose <xref:System.Windows.Forms.MouseEventArgs.Button%2A> property is set to the <xref:System.Windows.Forms.MouseButtons?displayProperty=fullName> value."},{"content":"Call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.OnMouseClick%2A&gt;</ph> method with this <ph id=\"ph2\">&lt;xref:System.Windows.Forms.MouseEventArgs&gt;</ph> as the argument.","pos":[1503,1640],"source":"Call the <xref:System.Windows.Forms.Control.OnMouseClick%2A> method with this <xref:System.Windows.Forms.MouseEventArgs> as the argument."},{"pos":[1647,1838],"content":"For more information on custom controls, see <bpt id=\"p1\">[</bpt>Developing Windows Forms Controls at Design Time<ept id=\"p1\">](../../../docs/framework/winforms/controls/developing-windows-forms-controls-at-design-time.md)</ept>.","source":"For more information on custom controls, see [Developing Windows Forms Controls at Design Time](../../../docs/framework/winforms/controls/developing-windows-forms-controls-at-design-time.md)."},{"content":"There are other ways to simulate mouse input.","pos":[1845,1890]},{"content":"For example, you can programmatically set a control property that represents a state that is typically set through mouse input (such as the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.CheckBox.Checked%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.CheckBox&gt;</ph> control), or you can directly call the delegate that is attached to the event you want to simulate.","pos":[1891,2231],"source":" For example, you can programmatically set a control property that represents a state that is typically set through mouse input (such as the <xref:System.Windows.Forms.CheckBox.Checked%2A> property of the <xref:System.Windows.Forms.CheckBox> control), or you can directly call the delegate that is attached to the event you want to simulate."},{"pos":[2240,2265],"content":"Simulating Keyboard Input","linkify":"Simulating Keyboard Input","nodes":[{"content":"Simulating Keyboard Input","pos":[0,25]}]},{"content":"Although you can simulate keyboard input by using the strategies discussed above for mouse input, Windows Forms also provides the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SendKeys&gt;</ph> class for sending keystrokes to the active application.","pos":[2269,2491],"source":"Although you can simulate keyboard input by using the strategies discussed above for mouse input, Windows Forms also provides the <xref:System.Windows.Forms.SendKeys> class for sending keystrokes to the active application."},{"pos":[2499,2733],"content":"[!CAUTION]\n If your application is intended for international use with a variety of keyboards, the use of <xref:System.Windows.Forms.SendKeys.Send%2A?displayProperty=fullName> could yield unpredictable results and should be avoided.","leadings":["","> "],"nodes":[{"content":"If your application is intended for international use with a variety of keyboards, the use of <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SendKeys.Send%2A?displayProperty=fullName&gt;</ph> could yield unpredictable results and should be avoided.","pos":[12,232],"source":"If your application is intended for international use with a variety of keyboards, the use of <xref:System.Windows.Forms.SendKeys.Send%2A?displayProperty=fullName> could yield unpredictable results and should be avoided."}]},{"pos":[2741,3044],"content":"[!NOTE]\n The <xref:System.Windows.Forms.SendKeys> class has been updated for the .NET Framework 3.0 to enable its use in applications that run on Windows Vista. The enhanced security of Windows Vista (known as User Account Control or UAC) prevents the previous implementation from working as expected.","leadings":["","> "],"nodes":[{"content":"The <xref:System.Windows.Forms.SendKeys> class has been updated for the .NET Framework 3.0 to enable its use in applications that run on Windows Vista. The enhanced security of Windows Vista (known as User Account Control or UAC) prevents the previous implementation from working as expected.","pos":[9,301],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SendKeys&gt;</ph> class has been updated for the .NET Framework 3.0 to enable its use in applications that run on Windows Vista.","pos":[0,151],"source":"The <xref:System.Windows.Forms.SendKeys> class has been updated for the .NET Framework 3.0 to enable its use in applications that run on Windows Vista."},{"content":"The enhanced security of Windows Vista (known as User Account Control or UAC) prevents the previous implementation from working as expected.","pos":[152,292]}]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SendKeys&gt;</ph> class is susceptible to timing issues, which some developers have had to work around.","pos":[3055,3181],"source":"The <xref:System.Windows.Forms.SendKeys> class is susceptible to timing issues, which some developers have had to work around."},{"content":"The updated implementation is still susceptible to timing issues, but is slightly faster and may require changes to the workarounds.","pos":[3182,3314]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SendKeys&gt;</ph> class tries to use the previous implementation first, and if that fails, uses the new implementation.","pos":[3315,3457],"source":" The <xref:System.Windows.Forms.SendKeys> class tries to use the previous implementation first, and if that fails, uses the new implementation."},{"content":"As a result, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SendKeys&gt;</ph> class may behave differently on different operating systems.","pos":[3458,3572],"source":" As a result, the <xref:System.Windows.Forms.SendKeys> class may behave differently on different operating systems."},{"content":"Additionally, when the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SendKeys&gt;</ph> class uses the new implementation, the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.SendKeys.SendWait%2A&gt;</ph> method will not wait for messages to be processed when they are sent to another process.","pos":[3573,3809],"source":" Additionally, when the <xref:System.Windows.Forms.SendKeys> class uses the new implementation, the <xref:System.Windows.Forms.SendKeys.SendWait%2A> method will not wait for messages to be processed when they are sent to another process."},{"content":"If your application relies on consistent behavior regardless of the operating system, you can force the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SendKeys&gt;</ph> class to use the new implementation by adding the following application setting to your app.config file.","pos":[3820,4065],"source":"If your application relies on consistent behavior regardless of the operating system, you can force the <xref:System.Windows.Forms.SendKeys> class to use the new implementation by adding the following application setting to your app.config file."},{"pos":[4181,4311],"content":"To force the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SendKeys&gt;</ph> class to use the previous implementation, use the value <ph id=\"ph2\">`\"JournalHook\"`</ph> instead.","source":"To force the <xref:System.Windows.Forms.SendKeys> class to use the previous implementation, use the value `\"JournalHook\"` instead."},{"pos":[4322,4365],"content":"To send a keystroke to the same application","linkify":"To send a keystroke to the same application","nodes":[{"content":"To send a keystroke to the same application","pos":[0,43]}]},{"content":"Call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SendKeys.Send%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Forms.SendKeys.SendWait%2A&gt;</ph> method of the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.SendKeys&gt;</ph> class.","pos":[4375,4538],"source":"Call the <xref:System.Windows.Forms.SendKeys.Send%2A> or <xref:System.Windows.Forms.SendKeys.SendWait%2A> method of the <xref:System.Windows.Forms.SendKeys> class."},{"content":"The specified keystrokes will be received by the active control of the application.","pos":[4539,4622]},{"content":"The following code example uses <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SendKeys.Send%2A&gt;</ph> to simulate pressing the ENTER key when the user double-clicks the surface of the form.","pos":[4623,4787],"source":" The following code example uses <xref:System.Windows.Forms.SendKeys.Send%2A> to simulate pressing the ENTER key when the user double-clicks the surface of the form."},{"content":"This example assumes a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form&gt;</ph> with a single <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Button&gt;</ph> control that has a tab index of 0.","pos":[4788,4927],"source":" This example assumes a <xref:System.Windows.Forms.Form> with a single <xref:System.Windows.Forms.Button> control that has a tab index of 0."},{"pos":[4938,5439],"content":"[!code-cpp[System.Windows.Forms.SimulateKeyPress#10](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/cpp/form1.cpp#10)]\n [!code-csharp[System.Windows.Forms.SimulateKeyPress#10](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/CS/form1.cs#10)]\n [!code-vb[System.Windows.Forms.SimulateKeyPress#10](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/VB/form1.vb#10)]","leadings":["","    ","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.SimulateKeyPress#10<ept id=\"p2\">](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/cpp/form1.cpp#10)</ept><ept id=\"p1\">]</ept>","pos":[0,160],"source":"[!code-cpp[System.Windows.Forms.SimulateKeyPress#10](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/cpp/form1.cpp#10)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.SimulateKeyPress#10<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/CS/form1.cs#10)</ept><ept id=\"p1\">]</ept>","pos":[162,326],"source":"[!code-csharp[System.Windows.Forms.SimulateKeyPress#10](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/CS/form1.cs#10)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.SimulateKeyPress#10<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/VB/form1.vb#10)</ept><ept id=\"p1\">]</ept>","pos":[328,493],"source":"[!code-vb[System.Windows.Forms.SimulateKeyPress#10](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/VB/form1.vb#10)]"}]},{"pos":[5450,5496],"content":"To send a keystroke to a different application","linkify":"To send a keystroke to a different application","nodes":[{"content":"To send a keystroke to a different application","pos":[0,46]}]},{"content":"Activate the application window that will receive the keystrokes, and then call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SendKeys.Send%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Forms.SendKeys.SendWait%2A&gt;</ph> method.","pos":[5506,5694],"source":"Activate the application window that will receive the keystrokes, and then call the <xref:System.Windows.Forms.SendKeys.Send%2A> or <xref:System.Windows.Forms.SendKeys.SendWait%2A> method."},{"content":"Because there is no managed method to activate another application, you must use native Windows methods to force focus on other applications.","pos":[5695,5836]},{"content":"The following code example uses platform invoke to call the <ph id=\"ph1\">`FindWindow`</ph> and <ph id=\"ph2\">`SetForegroundWindow`</ph> methods to activate the Calculator application window, and then calls <ph id=\"ph3\">&lt;xref:System.Windows.Forms.SendKeys.SendWait%2A&gt;</ph> to issue a series of calculations to the Calculator application.","pos":[5837,6119],"source":" The following code example uses platform invoke to call the `FindWindow` and `SetForegroundWindow` methods to activate the Calculator application window, and then calls <xref:System.Windows.Forms.SendKeys.SendWait%2A> to issue a series of calculations to the Calculator application."},{"pos":[6131,6574],"content":"[!NOTE]\nThe correct parameters of the `FindWindow` call that locates the Calculator application vary based on your version of Windows.  The following code finds the Calculator application on [!INCLUDE[win7](../../../includes/win7-md.md)]. On [!INCLUDE[windowsver](../../../includes/windowsver-md.md)], change the first parameter to \"SciCalc\". You can use the Spy++ tool, included with Visual Studio, to determine the correct parameters.","leadings":["","    >  "],"nodes":[{"content":"The correct parameters of the `FindWindow` call that locates the Calculator application vary based on your version of Windows.  The following code finds the Calculator application on [!INCLUDE[win7](../../../includes/win7-md.md)]. On [!INCLUDE[windowsver](../../../includes/windowsver-md.md)], change the first parameter to \"SciCalc\". You can use the Spy++ tool, included with Visual Studio, to determine the correct parameters.","pos":[8,436],"nodes":[{"content":"The correct parameters of the <ph id=\"ph1\">`FindWindow`</ph> call that locates the Calculator application vary based on your version of Windows.","pos":[0,126],"source":"The correct parameters of the `FindWindow` call that locates the Calculator application vary based on your version of Windows."},{"content":"The following code finds the Calculator application on <ph id=\"ph1\">[!INCLUDE[win7](../../../includes/win7-md.md)]</ph>.","pos":[128,230],"source":"  The following code finds the Calculator application on [!INCLUDE[win7](../../../includes/win7-md.md)]."},{"content":"On <ph id=\"ph1\">[!INCLUDE[windowsver](../../../includes/windowsver-md.md)]</ph>, change the first parameter to \"SciCalc\".","pos":[231,334],"source":" On [!INCLUDE[windowsver](../../../includes/windowsver-md.md)], change the first parameter to \"SciCalc\"."},{"content":"You can use the Spy++ tool, included with Visual Studio, to determine the correct parameters.","pos":[335,428]}]}]},{"pos":[6585,7080],"content":"[!code-cpp[System.Windows.Forms.SimulateKeyPress#5](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/cpp/form1.cpp#5)]\n [!code-csharp[System.Windows.Forms.SimulateKeyPress#5](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/CS/form1.cs#5)]\n [!code-vb[System.Windows.Forms.SimulateKeyPress#5](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/VB/form1.vb#5)]","leadings":["","    ","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.SimulateKeyPress#5<ept id=\"p2\">](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/cpp/form1.cpp#5)</ept><ept id=\"p1\">]</ept>","pos":[0,158],"source":"[!code-cpp[System.Windows.Forms.SimulateKeyPress#5](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/cpp/form1.cpp#5)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.SimulateKeyPress#5<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/CS/form1.cs#5)</ept><ept id=\"p1\">]</ept>","pos":[160,322],"source":"[!code-csharp[System.Windows.Forms.SimulateKeyPress#5](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/CS/form1.cs#5)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.SimulateKeyPress#5<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/VB/form1.vb#5)</ept><ept id=\"p1\">]</ept>","pos":[324,487],"source":"[!code-vb[System.Windows.Forms.SimulateKeyPress#5](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/VB/form1.vb#5)]"}]},{"pos":[7089,7096],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example is the complete application for the previous code examples.","pos":[7100,7186]},{"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.SimulateKeyPress#0<ept id=\"p2\">](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/cpp/form1.cpp#0)</ept><ept id=\"p1\">]</ept>","pos":[7193,7351],"source":"[!code-cpp[System.Windows.Forms.SimulateKeyPress#0](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/cpp/form1.cpp#0)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.SimulateKeyPress#0<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/CS/form1.cs#0)</ept><ept id=\"p1\">]</ept>","pos":[7353,7515],"source":"[!code-csharp[System.Windows.Forms.SimulateKeyPress#0](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/CS/form1.cs#0)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.SimulateKeyPress#0<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/VB/form1.vb#0)</ept><ept id=\"p1\">]</ept>","pos":[7517,7680],"source":"[!code-vb[System.Windows.Forms.SimulateKeyPress#0](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.SimulateKeyPress/VB/form1.vb#0)]"},{"pos":[7689,7707],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"This example requires:","pos":[7711,7733]},{"content":"References to the System, System.Drawing and System.Windows.Forms assemblies.","pos":[7743,7820]},{"content":"For information about building this example from the command line for <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)]</ph> or <ph id=\"ph2\">[!INCLUDE[csprcs](../../../includes/csprcs-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Building from the Command Line<ept id=\"p1\">](~/docs/visual-basic/reference/command-line-compiler/building-from-the-command-line.md)</ept> or <bpt id=\"p2\">[</bpt>Command-line Building With csc.exe<ept id=\"p2\">](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)</ept>.","pos":[7827,8256],"source":"For information about building this example from the command line for [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] or [!INCLUDE[csprcs](../../../includes/csprcs-md.md)], see [Building from the Command Line](~/docs/visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)."},{"content":"You can also build this example in <ph id=\"ph1\">[!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)]</ph> by pasting the code into a new project.","pos":[8257,8382],"source":" You can also build this example in [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] by pasting the code into a new project."},{"content":"Also see <bpt id=\"p1\">[</bpt>How to: Compile and Run a Complete Windows Forms Code Example Using Visual Studio<ept id=\"p1\">](http://msdn.microsoft.com/library/Bb129228\\(v=vs.110\\))</ept>.","pos":[8384,8533],"source":"  Also see [How to: Compile and Run a Complete Windows Forms Code Example Using Visual Studio](http://msdn.microsoft.com/library/Bb129228\\(v=vs.110\\))."},{"pos":[8542,8550],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[8554,8648],"content":"<bpt id=\"p1\">[</bpt>User Input in Windows Forms<ept id=\"p1\">](../../../docs/framework/winforms/user-input-in-windows-forms.md)</ept>","source":"[User Input in Windows Forms](../../../docs/framework/winforms/user-input-in-windows-forms.md)"}]}