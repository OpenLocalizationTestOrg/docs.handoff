{"content":"---\ntitle: \"Activity Localization | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 8ee7bc16-e609-469a-a3e8-8062952e2676\ncaps.latest.revision: 5\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Activity Localization\nWhen workflow applications and components have the potential to be localized into other cultures and languages, resource strings should be used so that they can be localized without recompiling.  \n  \n## Activity Localization  \n As with all applications that must be localized (released in different versions for different languages and cultures), any strings that are displayed to the user should not be put directly in code, but rather stored in a resource file. The strings can then be accessed through <!--zz <xref:System.Environment.GetResourceString> --> `GetResourceString`. If you are developing a component that is distributed in several languages, you also want to use resource strings for activity validation messages, user-defined tracking data, tracing messages, and error messages as well.  \n  \n The following exercise demonstrates how to use a resource file.  \n  \n#### Using resource files for localized strings  \n  \n1.  In [!INCLUDE[vs2010](../../../includes/vs2010-md.md)], right-click your project in **Solution Explorer** and select **Add…**, **New Item…**.  \n  \n2.  Select **Resources File** and name the file ErrorResources.resx. Click **Add**.  \n  \n3.  Open the resource file. Add a new entry with a **Name** of ErrorString and a **Value** of \"The activity is not valid.\"  \n  \n4.  Add the following `using` statements to your class.  \n  \n    ```  \n    using System.Reflection;  \n    using System.Resources;  \n  \n    ```  \n  \n5.  Create a resource manager in your project.  \n  \n    ```  \n    ResourceManager ErrorManager;  \n    ...  \n    ErrorManager = new ResourceManager(\"MyNamespace.ErrorResources\", Assembly.GetExecutingAssembly());  \n  \n    ```  \n  \n6.  Get the string from the resource manager where it is required.  \n  \n    ```  \n    String errorMessage = ErrorManager.GetString(\"ErrorString\");  \n  \n    ```  \n  \n The following code sample demonstrates how to utilize localized strings in the <xref:System.Activities.Activity.CacheMetadata%2A> method.  \n  \n```  \n       protected override void CacheMetadata(CodeActivityMetadata metadata)  \n        {  \n           .....  \n          // rest of the code elided for brevity  \n           .....  \n            if (this.Value != null && this.To != null)  \n            {  \n                if (!TypeHelper.AreTypesCompatible(this.Value.ArgumentType, this.To.ArgumentType))  \n                {  \n//---------------------------------------------  \n// ** SR.TypeMismatchForAssign will fetch the string from the resource manager **  \n//---------------------------------------------  \n                    metadata.AddValidationError(SR.TypeMismatchForAssign(  \n                                this.Value.ArgumentType,  \n                                this.To.ArgumentType,  \n                                this.DisplayName));  \n                }  \n            }  \n        }  \n```","nodes":[{"pos":[12,50],"content":"Activity Localization | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Activity Localization | Microsoft Docs","pos":[0,38]}]},{"pos":[315,336],"content":"Activity Localization","linkify":"Activity Localization","nodes":[{"content":"Activity Localization","pos":[0,21]}]},{"content":"When workflow applications and components have the potential to be localized into other cultures and languages, resource strings should be used so that they can be localized without recompiling.","pos":[337,531]},{"pos":[540,561],"content":"Activity Localization","linkify":"Activity Localization","nodes":[{"content":"Activity Localization","pos":[0,21]}]},{"content":"As with all applications that must be localized (released in different versions for different languages and cultures), any strings that are displayed to the user should not be put directly in code, but rather stored in a resource file.","pos":[565,800]},{"content":"The strings can then be accessed through <ph id=\"ph1\">&lt;!--zz &lt;xref:System.Environment.GetResourceString&gt; --&gt;</ph> <ph id=\"ph2\">`GetResourceString`</ph>.","pos":[801,917],"source":" The strings can then be accessed through <!--zz <xref:System.Environment.GetResourceString> --> `GetResourceString`."},{"content":"If you are developing a component that is distributed in several languages, you also want to use resource strings for activity validation messages, user-defined tracking data, tracing messages, and error messages as well.","pos":[918,1139]},{"content":"The following exercise demonstrates how to use a resource file.","pos":[1146,1209]},{"pos":[1220,1262],"content":"Using resource files for localized strings","linkify":"Using resource files for localized strings","nodes":[{"content":"Using resource files for localized strings","pos":[0,42]}]},{"pos":[1272,1412],"content":"In <ph id=\"ph1\">[!INCLUDE[vs2010](../../../includes/vs2010-md.md)]</ph>, right-click your project in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and select <bpt id=\"p2\">**</bpt>Add…<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>New Item…<ept id=\"p3\">**</ept>.","source":"In [!INCLUDE[vs2010](../../../includes/vs2010-md.md)], right-click your project in **Solution Explorer** and select **Add…**, **New Item…**."},{"content":"Select <bpt id=\"p1\">**</bpt>Resources File<ept id=\"p1\">**</ept> and name the file ErrorResources.resx.","pos":[1422,1486],"source":"Select **Resources File** and name the file ErrorResources.resx."},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","pos":[1487,1501],"source":" Click **Add**."},{"content":"Open the resource file.","pos":[1511,1534]},{"content":"Add a new entry with a <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> of ErrorString and a <bpt id=\"p2\">**</bpt>Value<ept id=\"p2\">**</ept> of \"The activity is not valid.\"","pos":[1535,1629],"source":" Add a new entry with a **Name** of ErrorString and a **Value** of \"The activity is not valid.\""},{"pos":[1639,1690],"content":"Add the following <ph id=\"ph1\">`using`</ph> statements to your class.","source":"Add the following `using` statements to your class."},{"content":"Create a resource manager in your project.","pos":[1787,1829]},{"content":"Get the string from the resource manager where it is required.","pos":[2016,2078]},{"content":"The following code sample demonstrates how to utilize localized strings in the <ph id=\"ph1\">&lt;xref:System.Activities.Activity.CacheMetadata%2A&gt;</ph> method.","pos":[2178,2315],"source":"The following code sample demonstrates how to utilize localized strings in the <xref:System.Activities.Activity.CacheMetadata%2A> method."}]}