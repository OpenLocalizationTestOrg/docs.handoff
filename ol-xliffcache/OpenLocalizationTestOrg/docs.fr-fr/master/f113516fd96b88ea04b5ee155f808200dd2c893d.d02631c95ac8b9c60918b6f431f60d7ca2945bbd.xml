{"content":"---\ntitle: \"How to: Programmatically Print XPS Files\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"printing XPS files programmatically [WPF]\"\n  - \"XPS files [WPF], printing programmatically\"\nms.assetid: 0b1c0a3f-b19e-43d6-bcc9-eb3ec4e555ad\n---\n# How to: Programmatically Print XPS Files\nYou can use one overload of the <xref:System.Printing.PrintQueue.AddJob%2A> method to print [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] files without opening a <xref:System.Windows.Controls.PrintDialog> or, in principle, any [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] at all.  \n  \n You can also print [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] files using the many <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter>. For more about this, [Printing an XPS Document](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms771525(v=vs.90)).  \n  \n Another way of printing [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] is to use the <xref:System.Windows.Controls.PrintDialog.PrintDocument%2A> or <xref:System.Windows.Controls.PrintDialog.PrintVisual%2A> methods of the <xref:System.Windows.Controls.PrintDialog> control. See [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).  \n  \n## Example  \n The main steps to using the three-parameter <xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29> method are as follows. The example below gives details.  \n  \n1.  Determine if the printer is an XPSDrv printer. (See [Printing Overview](printing-overview.md) for more about XPSDrv.)  \n  \n2.  If the printer is not an XPSDrv printer, set the thread's apartment to single thread.  \n  \n3.  Instantiate a print server and print queue object.  \n  \n4.  Call the method, specifying a job name, the file to be printed, and a <xref:System.Boolean> flag indicating whether or not the printer is an XPSDrv printer.  \n  \n The example below shows how to batch print all [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] files in a directory. Although the application prompts the user to specify the directory, the three-parameter <xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29> method does not require a [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]. It can be used in any code path where you have an [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] file name and path that you can pass to it.  \n  \n The three-parameter <xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29> overload of <xref:System.Printing.PrintQueue.AddJob%2A> must run in a single thread apartment whenever the <xref:System.Boolean> parameter is `false`, which it must be when a non-XPSDrv printer is being used. However, the default apartment state for [!INCLUDE[TLA#tla_net](../../../../includes/tlasharptla-net-md.md)] is multiple thread. This default must be reversed since the example assumes a non-XPSDrv printer.  \n  \n There are two ways to change the default. One way is to simply add the <xref:System.STAThreadAttribute> (that is, \"`[System.STAThreadAttribute()]`\") just above the first line of the application's `Main` method (usually \"`static void Main(string[] args)`\"). However, many applications require that the `Main` method have a multi-threaded apartment state, so there is a second method: put the call to <xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29> in a separate thread whose apartment state is set to <xref:System.Threading.ApartmentState.STA> with <xref:System.Threading.Thread.SetApartmentState%2A>. The example below uses this second technique.  \n  \n Accordingly, the example begins by instantiating a <xref:System.Threading.Thread> object and passing it a **PrintXPS** method as the <xref:System.Threading.ThreadStart> parameter. (The **PrintXPS** method is defined later in the example.) Next the thread is set to a single thread apartment. The only remaining code of the `Main` method starts the new thread.  \n  \n The meat of the example is in the `static`**BatchXPSPrinter.PrintXPS** method. After creating a print server and queue, the method prompts the user for a directory containing [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] files. After validating the existence of the directory and the presence of \\*.xps files in it, the method adds each such file to the print queue. The example assumes that the printer is non-XPSDrv, so we are passing `false` to the last parameter of <xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29> method. For this reason, the method will validate the [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] markup in the file before it attempts to convert it to the printer's page description language. If the validation fails, an exception is thrown. The example code will catch the exception, notify the user about it, and then go on to process the next [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] file.  \n  \n [!code-csharp[BatchPrintXPSFiles#BatchPrintXPSFiles](~/samples/snippets/csharp/VS_Snippets_Wpf/BatchPrintXPSFiles/CSharp/Program.cs#batchprintxpsfiles)]\n [!code-vb[BatchPrintXPSFiles#BatchPrintXPSFiles](~/samples/snippets/visualbasic/VS_Snippets_Wpf/BatchPrintXPSFiles/visualbasic/program.vb#batchprintxpsfiles)]  \n  \n If you are using an XPSDrv printer, then you can set the final parameter to `true`. In that case, since [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] is the printer's page description language, the method will send the file to the printer without validating it or converting it to another page description language. If you are uncertain at design time whether the application will be using an XPSDrv printer, you can modify the application to have it read the <xref:System.Printing.PrintQueue.IsXpsDevice%2A> property and branch according to what it finds.  \n  \n Since there will initially be few XPSDrv printers available immediately after the release of [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)] and Microsoft .NET Framework, you may need to disguise a non-XPSDrv printer as an XPSDrv printer. To do so, add Pipelineconfig.xml to the list of files in the following registry key of the computer running your application:  \n  \n HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\Windows NT x86\\Drivers\\Version-3\\\\*\\<PseudoXPSPrinter>*\\DependentFiles  \n  \n where *\\<PseudoXPSPrinter>* is any print queue. The machine must then be rebooted.  \n  \n This disguise will enable you to pass `true` as the final parameter of <xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29> without causing an exception, but since *\\<PseudoXPSPrinter>* is not really an XPSDrv printer, only garbage will print.  \n  \n **Note** For simplicity, the example above uses the presence of an \\*.xps extension as its test that a file is [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]. However, [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] files do not have to have this extension. The [isXPS.exe (isXPS Conformance Tool)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aa348104(v=vs.100)) is one way of testing a file for [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] validity.  \n  \n## See also\n\n- <xref:System.Printing.PrintQueue>\n- <xref:System.Printing.PrintQueue.AddJob%2A>\n- <xref:System.Threading.ApartmentState>\n- <xref:System.STAThreadAttribute>\n- [XPS Documents](/windows/desktop/printdocs/documents)\n- [Printing an XPS Document](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms771525(v=vs.90))\n- [Managed and Unmanaged Threading](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/5s8ee185(v=vs.100))\n- [isXPS.exe (isXPS Conformance Tool)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aa348104(v=vs.100))\n- [Documents in WPF](documents-in-wpf.md)\n- [Printing Overview](printing-overview.md)\n","nodes":[{"pos":[4,277],"embed":true,"restype":"x-metadata","content":"title: \"How to: Programmatically Print XPS Files\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"printing XPS files programmatically [WPF]\"\n  - \"XPS files [WPF], printing programmatically\"\nms.assetid: 0b1c0a3f-b19e-43d6-bcc9-eb3ec4e555ad","nodes":[{"content":"How to: Programmatically Print XPS Files","nodes":[{"pos":[0,40],"content":"How to: Programmatically Print XPS Files","nodes":[{"content":"How to: Programmatically Print XPS Files","pos":[0,40]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[284,324],"content":"How to: Programmatically Print XPS Files","linkify":"How to: Programmatically Print XPS Files","nodes":[{"content":"How to: Programmatically Print XPS Files","pos":[0,40]}]},{"pos":[325,647],"content":"You can use one overload of the <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.AddJob%2A&gt;</ph> method to print <ph id=\"ph2\">[!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)]</ph> files without opening a <ph id=\"ph3\">&lt;xref:System.Windows.Controls.PrintDialog&gt;</ph> or, in principle, any <ph id=\"ph4\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph> at all.","source":"You can use one overload of the <xref:System.Printing.PrintQueue.AddJob%2A> method to print [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] files without opening a <xref:System.Windows.Controls.PrintDialog> or, in principle, any [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] at all."},{"content":"You can also print <ph id=\"ph1\">[!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)]</ph> files using the many <ph id=\"ph2\">&lt;xref:System.Windows.Xps.XpsDocumentWriter.Write%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A&gt;</ph> methods of the <ph id=\"ph4\">&lt;xref:System.Windows.Xps.XpsDocumentWriter&gt;</ph>.","pos":[654,936],"source":"You can also print [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] files using the many <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter>."},{"content":"For more about this, <bpt id=\"p1\">[</bpt>Printing an XPS Document<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms771525(v=vs.90))</ept>.","pos":[937,1073],"source":" For more about this, [Printing an XPS Document](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms771525(v=vs.90))."},{"content":"Another way of printing <ph id=\"ph1\">[!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)]</ph> is to use the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.PrintDialog.PrintDocument%2A&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Windows.Controls.PrintDialog.PrintVisual%2A&gt;</ph> methods of the <ph id=\"ph4\">&lt;xref:System.Windows.Controls.PrintDialog&gt;</ph> control.","pos":[1080,1373],"source":"Another way of printing [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] is to use the <xref:System.Windows.Controls.PrintDialog.PrintDocument%2A> or <xref:System.Windows.Controls.PrintDialog.PrintVisual%2A> methods of the <xref:System.Windows.Controls.PrintDialog> control."},{"content":"See <bpt id=\"p1\">[</bpt>Invoke a Print Dialog<ept id=\"p1\">](how-to-invoke-a-print-dialog.md)</ept>.","pos":[1374,1435],"source":" See [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md)."},{"pos":[1444,1451],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The main steps to using the three-parameter <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29&gt;</ph> method are as follows.","pos":[1455,1614],"source":"The main steps to using the three-parameter <xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29> method are as follows."},{"content":"The example below gives details.","pos":[1615,1647]},{"content":"Determine if the printer is an XPSDrv printer.","pos":[1657,1703]},{"content":"(See <bpt id=\"p1\">[</bpt>Printing Overview<ept id=\"p1\">](printing-overview.md)</ept> for more about XPSDrv.)","pos":[1704,1774],"source":" (See [Printing Overview](printing-overview.md) for more about XPSDrv.)"},{"content":"If the printer is not an XPSDrv printer, set the thread's apartment to single thread.","pos":[1784,1869]},{"content":"Instantiate a print server and print queue object.","pos":[1879,1929]},{"pos":[1939,2095],"content":"Call the method, specifying a job name, the file to be printed, and a <ph id=\"ph1\">&lt;xref:System.Boolean&gt;</ph> flag indicating whether or not the printer is an XPSDrv printer.","source":"Call the method, specifying a job name, the file to be printed, and a <xref:System.Boolean> flag indicating whether or not the printer is an XPSDrv printer."},{"content":"The example below shows how to batch print all <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> files in a directory.","pos":[2102,2240],"source":"The example below shows how to batch print all [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] files in a directory."},{"content":"Although the application prompts the user to specify the directory, the three-parameter <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29&gt;</ph> method does not require a <ph id=\"ph2\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph>.","pos":[2241,2514],"source":" Although the application prompts the user to specify the directory, the three-parameter <xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29> method does not require a [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]."},{"content":"It can be used in any code path where you have an <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> file name and path that you can pass to it.","pos":[2515,2678],"source":" It can be used in any code path where you have an [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] file name and path that you can pass to it."},{"content":"The three-parameter <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29&gt;</ph> overload of <ph id=\"ph2\">&lt;xref:System.Printing.PrintQueue.AddJob%2A&gt;</ph> must run in a single thread apartment whenever the <ph id=\"ph3\">&lt;xref:System.Boolean&gt;</ph> parameter is <ph id=\"ph4\">`false`</ph>, which it must be when a non-XPSDrv printer is being used.","pos":[2685,3006],"source":"The three-parameter <xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29> overload of <xref:System.Printing.PrintQueue.AddJob%2A> must run in a single thread apartment whenever the <xref:System.Boolean> parameter is `false`, which it must be when a non-XPSDrv printer is being used."},{"content":"However, the default apartment state for <ph id=\"ph1\">[!INCLUDE[TLA#tla_net](../../../../includes/tlasharptla-net-md.md)]</ph> is multiple thread.","pos":[3007,3135],"source":" However, the default apartment state for [!INCLUDE[TLA#tla_net](../../../../includes/tlasharptla-net-md.md)] is multiple thread."},{"content":"This default must be reversed since the example assumes a non-XPSDrv printer.","pos":[3136,3213]},{"content":"There are two ways to change the default.","pos":[3220,3261]},{"content":"One way is to simply add the <ph id=\"ph1\">&lt;xref:System.STAThreadAttribute&gt;</ph> (that is, \"<ph id=\"ph2\">`[System.STAThreadAttribute()]`</ph>\") just above the first line of the application's <ph id=\"ph3\">`Main`</ph> method (usually \"<ph id=\"ph4\">`static void Main(string[] args)`</ph>\").","pos":[3262,3476],"source":" One way is to simply add the <xref:System.STAThreadAttribute> (that is, \"`[System.STAThreadAttribute()]`\") just above the first line of the application's `Main` method (usually \"`static void Main(string[] args)`\")."},{"content":"However, many applications require that the <ph id=\"ph1\">`Main`</ph> method have a multi-threaded apartment state, so there is a second method: put the call to <ph id=\"ph2\">&lt;xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29&gt;</ph> in a separate thread whose apartment state is set to <ph id=\"ph3\">&lt;xref:System.Threading.ApartmentState.STA&gt;</ph> with <ph id=\"ph4\">&lt;xref:System.Threading.Thread.SetApartmentState%2A&gt;</ph>.","pos":[3477,3865],"source":" However, many applications require that the `Main` method have a multi-threaded apartment state, so there is a second method: put the call to <xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29> in a separate thread whose apartment state is set to <xref:System.Threading.ApartmentState.STA> with <xref:System.Threading.Thread.SetApartmentState%2A>."},{"content":"The example below uses this second technique.","pos":[3866,3911]},{"content":"Accordingly, the example begins by instantiating a <ph id=\"ph1\">&lt;xref:System.Threading.Thread&gt;</ph> object and passing it a <bpt id=\"p1\">**</bpt>PrintXPS<ept id=\"p1\">**</ept> method as the <ph id=\"ph2\">&lt;xref:System.Threading.ThreadStart&gt;</ph> parameter.","pos":[3918,4097],"source":"Accordingly, the example begins by instantiating a <xref:System.Threading.Thread> object and passing it a **PrintXPS** method as the <xref:System.Threading.ThreadStart> parameter."},{"content":"(The <bpt id=\"p1\">**</bpt>PrintXPS<ept id=\"p1\">**</ept> method is defined later in the example.) Next the thread is set to a single thread apartment.","pos":[4098,4209],"source":" (The **PrintXPS** method is defined later in the example.) Next the thread is set to a single thread apartment."},{"content":"The only remaining code of the <ph id=\"ph1\">`Main`</ph> method starts the new thread.","pos":[4210,4277],"source":" The only remaining code of the `Main` method starts the new thread."},{"content":"The meat of the example is in the <ph id=\"ph1\">`static`</ph><bpt id=\"p1\">**</bpt>BatchXPSPrinter.PrintXPS<ept id=\"p1\">**</ept> method.","pos":[4284,4362],"source":"The meat of the example is in the `static`**BatchXPSPrinter.PrintXPS** method."},{"content":"After creating a print server and queue, the method prompts the user for a directory containing <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> files.","pos":[4363,4535],"source":" After creating a print server and queue, the method prompts the user for a directory containing [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] files."},{"content":"After validating the existence of the directory and the presence of <ph id=\"ph1\">\\*</ph>.xps files in it, the method adds each such file to the print queue.","pos":[4536,4674],"source":" After validating the existence of the directory and the presence of \\*.xps files in it, the method adds each such file to the print queue."},{"content":"The example assumes that the printer is non-XPSDrv, so we are passing <ph id=\"ph1\">`false`</ph> to the last parameter of <ph id=\"ph2\">&lt;xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29&gt;</ph> method.","pos":[4675,4878],"source":" The example assumes that the printer is non-XPSDrv, so we are passing `false` to the last parameter of <xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29> method."},{"content":"For this reason, the method will validate the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> markup in the file before it attempts to convert it to the printer's page description language.","pos":[4879,5090],"source":" For this reason, the method will validate the [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] markup in the file before it attempts to convert it to the printer's page description language."},{"content":"If the validation fails, an exception is thrown.","pos":[5091,5139]},{"content":"The example code will catch the exception, notify the user about it, and then go on to process the next <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> file.","pos":[5140,5319],"source":" The example code will catch the exception, notify the user about it, and then go on to process the next [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] file."},{"pos":[5326,5638],"content":"[!code-csharp[BatchPrintXPSFiles#BatchPrintXPSFiles](~/samples/snippets/csharp/VS_Snippets_Wpf/BatchPrintXPSFiles/CSharp/Program.cs#batchprintxpsfiles)]\n[!code-vb[BatchPrintXPSFiles#BatchPrintXPSFiles](~/samples/snippets/visualbasic/VS_Snippets_Wpf/BatchPrintXPSFiles/visualbasic/program.vb#batchprintxpsfiles)]","leadings":[""," "],"nodes":[]},{"content":"If you are using an XPSDrv printer, then you can set the final parameter to <ph id=\"ph1\">`true`</ph>.","pos":[5645,5728],"source":"If you are using an XPSDrv printer, then you can set the final parameter to `true`."},{"content":"In that case, since <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> is the printer's page description language, the method will send the file to the printer without validating it or converting it to another page description language.","pos":[5729,5984],"source":" In that case, since [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] is the printer's page description language, the method will send the file to the printer without validating it or converting it to another page description language."},{"content":"If you are uncertain at design time whether the application will be using an XPSDrv printer, you can modify the application to have it read the <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.IsXpsDevice%2A&gt;</ph> property and branch according to what it finds.","pos":[5985,6225],"source":" If you are uncertain at design time whether the application will be using an XPSDrv printer, you can modify the application to have it read the <xref:System.Printing.PrintQueue.IsXpsDevice%2A> property and branch according to what it finds."},{"content":"Since there will initially be few XPSDrv printers available immediately after the release of <ph id=\"ph1\">[!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)]</ph> and Microsoft .NET Framework, you may need to disguise a non-XPSDrv printer as an XPSDrv printer.","pos":[6232,6500],"source":"Since there will initially be few XPSDrv printers available immediately after the release of [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)] and Microsoft .NET Framework, you may need to disguise a non-XPSDrv printer as an XPSDrv printer."},{"content":"To do so, add Pipelineconfig.xml to the list of files in the following registry key of the computer running your application:","pos":[6501,6626]},{"pos":[6633,6774],"content":"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\Windows NT x86\\Drivers\\Version-3<ph id=\"ph1\">\\\\</ph><bpt id=\"p1\">*</bpt><ph id=\"ph2\">\\&lt;</ph>PseudoXPSPrinter&gt;<ept id=\"p1\">*</ept>\\DependentFiles","source":"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\Windows NT x86\\Drivers\\Version-3\\\\*\\<PseudoXPSPrinter>*\\DependentFiles"},{"content":"where <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>PseudoXPSPrinter&gt;<ept id=\"p1\">*</ept> is any print queue.","pos":[6781,6828],"source":"where *\\<PseudoXPSPrinter>* is any print queue."},{"content":"The machine must then be rebooted.","pos":[6829,6863]},{"pos":[6870,7153],"content":"This disguise will enable you to pass <ph id=\"ph1\">`true`</ph> as the final parameter of <ph id=\"ph2\">&lt;xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29&gt;</ph> without causing an exception, but since <bpt id=\"p1\">*</bpt><ph id=\"ph3\">\\&lt;</ph>PseudoXPSPrinter&gt;<ept id=\"p1\">*</ept> is not really an XPSDrv printer, only garbage will print.","source":"This disguise will enable you to pass `true` as the final parameter of <xref:System.Printing.PrintQueue.AddJob%28System.String%2CSystem.String%2CSystem.Boolean%29> without causing an exception, but since *\\<PseudoXPSPrinter>* is not really an XPSDrv printer, only garbage will print."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> For simplicity, the example above uses the presence of an <ph id=\"ph1\">\\*</ph>.xps extension as its test that a file is <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph>.","pos":[7160,7341],"source":"**Note** For simplicity, the example above uses the presence of an \\*.xps extension as its test that a file is [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]."},{"content":"However, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> files do not have to have this extension.","pos":[7342,7462],"source":" However, [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] files do not have to have this extension."},{"content":"The <bpt id=\"p1\">[</bpt>isXPS.exe (isXPS Conformance Tool)<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aa348104(v=vs.100))</ept> is one way of testing a file for <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]</ph> validity.","pos":[7463,7705],"source":" The [isXPS.exe (isXPS Conformance Tool)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aa348104(v=vs.100)) is one way of testing a file for [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] validity."},{"pos":[7714,7722],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7884,7937],"content":"<bpt id=\"p1\">[</bpt>XPS Documents<ept id=\"p1\">](/windows/desktop/printdocs/documents)</ept>","source":"[XPS Documents](/windows/desktop/printdocs/documents)"},{"pos":[7940,8054],"content":"<bpt id=\"p1\">[</bpt>Printing an XPS Document<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms771525(v=vs.90))</ept>","source":"[Printing an XPS Document](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms771525(v=vs.90))"},{"pos":[8057,8179],"content":"<bpt id=\"p1\">[</bpt>Managed and Unmanaged Threading<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/5s8ee185(v=vs.100))</ept>","source":"[Managed and Unmanaged Threading](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/5s8ee185(v=vs.100))"},{"pos":[8182,8307],"content":"<bpt id=\"p1\">[</bpt>isXPS.exe (isXPS Conformance Tool)<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aa348104(v=vs.100))</ept>","source":"[isXPS.exe (isXPS Conformance Tool)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aa348104(v=vs.100))"},{"pos":[8310,8349],"content":"<bpt id=\"p1\">[</bpt>Documents in WPF<ept id=\"p1\">](documents-in-wpf.md)</ept>","source":"[Documents in WPF](documents-in-wpf.md)"},{"pos":[8352,8393],"content":"<bpt id=\"p1\">[</bpt>Printing Overview<ept id=\"p1\">](printing-overview.md)</ept>","source":"[Printing Overview](printing-overview.md)"}]}