{"content":"---\ntitle: \"How to: Synchronize Concurrent Operations with a Barrier | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"Barrier, how to use\"\nms.assetid: e1a253ff-e0fb-4df8-95ff-d01a90d4cb19\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# How to: Synchronize Concurrent Operations with a Barrier\nThe following example shows how to synchronize concurrent tasks with a <xref:System.Threading.Barrier>.  \n  \n## Example  \n The purpose of the following program is to count how many iterations (or phases) are required for two threads to each find their half of the solution on the same phase by using a randomizing algorithm to reshuffle the words. After each thread has shuffled its words, the barrier post-phase operation compares the two results to see if the complete sentence has been rendered in correct word order.  \n  \n [!code-csharp[CDS_Barrier#01](../../../samples/snippets/csharp/VS_Snippets_Misc/cds_barrier/cs/barrier.cs#01)]\n [!code-vb[CDS_Barrier#01](../../../samples/snippets/visualbasic/VS_Snippets_Misc/cds_barrier/vb/barrier_vb.vb#01)]  \n  \n A <xref:System.Threading.Barrier> is an object that prevents individual tasks in a parallel operation from continuing until all tasks reach the barrier. It is useful when a parallel operation occurs in phases, and each phase requires synchronization between tasks. In this example, there are two phases to the operation. In the first phase, each task fills its section of the buffer with data. When each task finishes filling its section, the task signals the barrier that it is ready to continue, and then waits. When all tasks have signaled the barrier, they are unblocked and the second phase starts. The barrier is necessary because the second phase requires that each task have access to all the data that has been generated to this point. Without the barrier, the first tasks to complete might try to read from buffers that have not been filled in yet by other tasks. You can synchronize any number of phases in this manner.  \n  \n## See Also  \n [Data Structures for Parallel Programming](../../../docs/standard/parallel-programming/data-structures-for-parallel-programming.md)","nodes":[{"pos":[4,418],"embed":true,"restype":"x-metadata","content":"title: \"How to: Synchronize Concurrent Operations with a Barrier | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"Barrier, how to use\"\nms.assetid: e1a253ff-e0fb-4df8-95ff-d01a90d4cb19\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"How to: Synchronize Concurrent Operations with a Barrier | Microsoft Docs","nodes":[{"pos":[0,73],"content":"How to: Synchronize Concurrent Operations with a Barrier | Microsoft Docs","nodes":[{"content":"How to: Synchronize Concurrent Operations with a Barrier | Microsoft Docs","pos":[0,73]}]}],"path":["title"]}],"yml":true},{"pos":[425,481],"content":"How to: Synchronize Concurrent Operations with a Barrier","linkify":"How to: Synchronize Concurrent Operations with a Barrier","nodes":[{"content":"How to: Synchronize Concurrent Operations with a Barrier","pos":[0,56]}]},{"content":"The following example shows how to synchronize concurrent tasks with a <ph id=\"ph1\">&lt;xref:System.Threading.Barrier&gt;</ph>.","pos":[482,585],"source":"The following example shows how to synchronize concurrent tasks with a <xref:System.Threading.Barrier>."},{"pos":[594,601],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The purpose of the following program is to count how many iterations (or phases) are required for two threads to each find their half of the solution on the same phase by using a randomizing algorithm to reshuffle the words.","pos":[605,829]},{"content":"After each thread has shuffled its words, the barrier post-phase operation compares the two results to see if the complete sentence has been rendered in correct word order.","pos":[830,1002]},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>CDS_Barrier#01<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Misc/cds_barrier/cs/barrier.cs#01)</ept><ept id=\"p1\">]</ept>","pos":[1009,1119],"source":"[!code-csharp[CDS_Barrier#01](../../../samples/snippets/csharp/VS_Snippets_Misc/cds_barrier/cs/barrier.cs#01)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>CDS_Barrier#01<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_Misc/cds_barrier/vb/barrier_vb.vb#01)</ept><ept id=\"p1\">]</ept>","pos":[1121,1235],"source":"[!code-vb[CDS_Barrier#01](../../../samples/snippets/visualbasic/VS_Snippets_Misc/cds_barrier/vb/barrier_vb.vb#01)]"},{"content":"A <ph id=\"ph1\">&lt;xref:System.Threading.Barrier&gt;</ph> is an object that prevents individual tasks in a parallel operation from continuing until all tasks reach the barrier.","pos":[1242,1394],"source":"A <xref:System.Threading.Barrier> is an object that prevents individual tasks in a parallel operation from continuing until all tasks reach the barrier."},{"content":"It is useful when a parallel operation occurs in phases, and each phase requires synchronization between tasks.","pos":[1395,1506]},{"content":"In this example, there are two phases to the operation.","pos":[1507,1562]},{"content":"In the first phase, each task fills its section of the buffer with data.","pos":[1563,1635]},{"content":"When each task finishes filling its section, the task signals the barrier that it is ready to continue, and then waits.","pos":[1636,1755]},{"content":"When all tasks have signaled the barrier, they are unblocked and the second phase starts.","pos":[1756,1845]},{"content":"The barrier is necessary because the second phase requires that each task have access to all the data that has been generated to this point.","pos":[1846,1986]},{"content":"Without the barrier, the first tasks to complete might try to read from buffers that have not been filled in yet by other tasks.","pos":[1987,2115]},{"content":"You can synchronize any number of phases in this manner.","pos":[2116,2172]},{"pos":[2181,2189],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2193,2324],"content":"<bpt id=\"p1\">[</bpt>Data Structures for Parallel Programming<ept id=\"p1\">](../../../docs/standard/parallel-programming/data-structures-for-parallel-programming.md)</ept>","source":"[Data Structures for Parallel Programming](../../../docs/standard/parallel-programming/data-structures-for-parallel-programming.md)"}]}