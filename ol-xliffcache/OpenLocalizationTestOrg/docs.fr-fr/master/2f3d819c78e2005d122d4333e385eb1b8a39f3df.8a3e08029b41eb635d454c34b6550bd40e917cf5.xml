{"content":"---\ntitle: \"How to: Diagnose Problematic Print Job | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"troubleshooting print job problems\"\n  - \"print jobs, troubleshooting\"\n  - \"print jobs, diagnosing problems\"\nms.assetid: b081a170-84c6-48f9-a487-5766a8d58a82\ncaps.latest.revision: 7\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Diagnose Problematic Print Job\nNetwork administrators often field complaints from users about print jobs that do not print or print slowly. The rich set of print job properties exposed in the [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] of [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)] provide a means for performing a rapid remote diagnosis of print jobs.  \n  \n## Example  \n The major steps for creating this kind of utility are as follows.  \n  \n1.  Identify the print job that the user is complaining about. Users often cannot do this precisely. They may not know the names of the print servers or printers. They may describe the location of the printer in different terminology than was used in setting its <xref:System.Printing.PrintQueue.Location%2A> property. Accordingly, it is a good idea to generate a list of the user's currently submitted jobs. If there is more than one, then communication between the user and the print system administrator can be used to pinpoint the job that is having problems. The substeps are as follows.  \n  \n    1.  Obtain a list of all print servers.  \n  \n    2.  Loop through the servers to query their print queues.  \n  \n    3.  Within each pass of the server loop, loop through all the server's queues to query their jobs  \n  \n    4.  Within each pass of the queue loop, loop through its jobs and gather identifying information about those that were submitted by the complaining user.  \n  \n2.  When the problematic print job has been identified, examine relevant properties to see what might be the problem. For example, is job in an error state or did the printer servicing the queue go offline before the job could print?  \n  \n The code below is series of code examples. The first code example contains the loop through the print queues. (Step 1c above.) The variable `myPrintQueues` is the <xref:System.Printing.PrintQueueCollection> object for the current print server.  \n  \n The code example begins by refreshing the current print queue object with <xref:System.Printing.PrintQueue.Refresh%2A?displayProperty=fullName>. This ensures that the object's properties accurately represent the state of the physical printer that it represents. Then the application gets the collection of print jobs currently in the print queue by using <xref:System.Printing.PrintQueue.GetPrintJobInfoCollection%2A>.  \n  \n Next the application loops through the <xref:System.Printing.PrintSystemJobInfo> collection and compares each <xref:System.Printing.PrintSystemJobInfo.Submitter%2A> property with the alias of the complaining user. If they match, the application adds identifying information about the job to the string that will be presented. (The `userName` and `jobList` variables are initialized earlier in the application.)  \n  \n [!code-cpp[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#enumeratejobsinqueues)]\n [!code-csharp[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#enumeratejobsinqueues)]\n [!code-vb[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#enumeratejobsinqueues)]  \n  \n The next code example picks up the application at Step 2. (See above.) The problematic job has been identified and the application prompts for the information that will identify it. From this information it creates <xref:System.Printing.PrintServer>, <xref:System.Printing.PrintQueue>, and <xref:System.Printing.PrintSystemJobInfo> objects.  \n  \n At this point the application contains a branching structure corresponding to the two ways of checking a print job's status:  \n  \n-   You can read the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property which is of type <xref:System.Printing.PrintJobStatus>.  \n  \n-   You can read each relevant property such as <xref:System.Printing.PrintSystemJobInfo.IsBlocked%2A> and <xref:System.Printing.PrintSystemJobInfo.IsInError%2A>.  \n  \n This example demonstrates both methods, so the user was previously prompted as to which method to use and responded with \"Y\" if he or she wanted to use the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property. See below for the details of the two methods. Finally, the application uses a method called **ReportQueueAndJobAvailability** to report on whether the job can be printed at this time of day. This method is discussed in [Discover Whether a Print Job Can Be Printed At This Time of Day](../../../../docs/framework/wpf/advanced/how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day.md).  \n  \n [!code-cpp[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#identifyanddiagnoseproblematicjob)]\n [!code-csharp[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#identifyanddiagnoseproblematicjob)]\n [!code-vb[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#identifyanddiagnoseproblematicjob)]  \n  \n To check print job status using the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property, you check each relevant flag to see if it is set. The standard way to see if one bit is set in a set of bit flags is to perform a logical AND operation with the set of flags as one operand and the flag itself as the other. Since the flag itself has only one bit set, the result of the logical AND is that, at most, that same bit is set. To find out whether it is or not, just compare the result of the logical AND with the flag itself. For more information, see <xref:System.Printing.PrintJobStatus>, the [& Operator (C# Reference)](~/docs/csharp/language-reference/operators/and-operator.md), and <xref:System.FlagsAttribute>.  \n  \n For each attribute whose bit is set, the code reports this to the console screen and sometimes suggests a way to respond. (The **HandlePausedJob** method that is called if the job or queue is paused is discussed below.)  \n  \n [!code-cpp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobattributes)]\n [!code-csharp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobattributes)]\n [!code-vb[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobattributes)]  \n  \n To check print job status using separate properties, you simply read each property and, if the property is `true`, report to the console screen and possibly suggest a way to respond. (The **HandlePausedJob** method that is called if the job or queue is paused is discussed below.)  \n  \n [!code-cpp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobproperties)]\n [!code-csharp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobproperties)]\n [!code-vb[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobproperties)]  \n  \n The **HandlePausedJob** method enables the application's user to remotely resume paused jobs. Because there might be a good reason why the print queue was paused, the method begins by prompting for a user decision about whether to resume it. If the answer is \"Y\", then the <xref:System.Printing.PrintQueue.Resume%2A?displayProperty=fullName> method is called.  \n  \n Next the user is prompted to decide if the job itself should be resumed, just in case it is paused independently of the print queue. (Compare <xref:System.Printing.PrintQueue.IsPaused%2A?displayProperty=fullName> and <xref:System.Printing.PrintSystemJobInfo.IsPaused%2A?displayProperty=fullName>.) If the answer is \"Y\", then <xref:System.Printing.PrintSystemJobInfo.Resume%2A?displayProperty=fullName> is called; otherwise <xref:System.Printing.PrintSystemJobInfo.Cancel%2A> is called.  \n  \n [!code-cpp[DiagnoseProblematicPrintJob#HandlePausedJob](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#handlepausedjob)]\n [!code-csharp[DiagnoseProblematicPrintJob#HandlePausedJob](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#handlepausedjob)]\n [!code-vb[DiagnoseProblematicPrintJob#HandlePausedJob](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#handlepausedjob)]  \n  \n## See Also  \n <xref:System.Printing.PrintJobStatus>   \n <xref:System.Printing.PrintSystemJobInfo>   \n <xref:System.FlagsAttribute>   \n <xref:System.Printing.PrintQueue>   \n [& Operator (C# Reference)](~/docs/csharp/language-reference/operators/and-operator.md)   \n [Documents in WPF](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)   \n [Printing Overview](../../../../docs/framework/wpf/advanced/printing-overview.md)","nodes":[{"pos":[4,502],"embed":true,"restype":"x-metadata","content":"title: \"How to: Diagnose Problematic Print Job | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"troubleshooting print job problems\"\n  - \"print jobs, troubleshooting\"\n  - \"print jobs, diagnosing problems\"\nms.assetid: b081a170-84c6-48f9-a487-5766a8d58a82\ncaps.latest.revision: 7\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"How to: Diagnose Problematic Print Job | Microsoft Docs","nodes":[{"pos":[0,55],"content":"How to: Diagnose Problematic Print Job | Microsoft Docs","nodes":[{"content":"How to: Diagnose Problematic Print Job | Microsoft Docs","pos":[0,55]}]}],"path":["title"]}],"yml":true},{"pos":[509,547],"content":"How to: Diagnose Problematic Print Job","linkify":"How to: Diagnose Problematic Print Job","nodes":[{"content":"How to: Diagnose Problematic Print Job","pos":[0,38]}]},{"content":"Network administrators often field complaints from users about print jobs that do not print or print slowly.","pos":[548,656]},{"content":"The rich set of print job properties exposed in the <ph id=\"ph1\">[!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)]</ph> of <ph id=\"ph2\">[!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)]</ph> provide a means for performing a rapid remote diagnosis of print jobs.","pos":[657,940],"source":" The rich set of print job properties exposed in the [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] of [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)] provide a means for performing a rapid remote diagnosis of print jobs."},{"pos":[949,956],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The major steps for creating this kind of utility are as follows.","pos":[960,1025]},{"content":"Identify the print job that the user is complaining about.","pos":[1035,1093]},{"content":"Users often cannot do this precisely.","pos":[1094,1131]},{"content":"They may not know the names of the print servers or printers.","pos":[1132,1193]},{"content":"They may describe the location of the printer in different terminology than was used in setting its <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.Location%2A&gt;</ph> property.","pos":[1194,1349],"source":" They may describe the location of the printer in different terminology than was used in setting its <xref:System.Printing.PrintQueue.Location%2A> property."},{"content":"Accordingly, it is a good idea to generate a list of the user's currently submitted jobs.","pos":[1350,1439]},{"content":"If there is more than one, then communication between the user and the print system administrator can be used to pinpoint the job that is having problems.","pos":[1440,1594]},{"content":"The substeps are as follows.","pos":[1595,1623]},{"content":"Obtain a list of all print servers.","pos":[1637,1672]},{"content":"Loop through the servers to query their print queues.","pos":[1686,1739]},{"content":"Within each pass of the server loop, loop through all the server's queues to query their jobs","pos":[1753,1846]},{"content":"Within each pass of the queue loop, loop through its jobs and gather identifying information about those that were submitted by the complaining user.","pos":[1860,2009]},{"content":"When the problematic print job has been identified, examine relevant properties to see what might be the problem.","pos":[2019,2132]},{"content":"For example, is job in an error state or did the printer servicing the queue go offline before the job could print?","pos":[2133,2248]},{"content":"The code below is series of code examples.","pos":[2255,2297]},{"content":"The first code example contains the loop through the print queues.","pos":[2298,2364]},{"content":"(Step 1c above.) The variable <ph id=\"ph1\">`myPrintQueues`</ph> is the <ph id=\"ph2\">&lt;xref:System.Printing.PrintQueueCollection&gt;</ph> object for the current print server.","pos":[2365,2498],"source":" (Step 1c above.) The variable `myPrintQueues` is the <xref:System.Printing.PrintQueueCollection> object for the current print server."},{"content":"The code example begins by refreshing the current print queue object with <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.Refresh%2A?displayProperty=fullName&gt;</ph>.","pos":[2505,2649],"source":"The code example begins by refreshing the current print queue object with <xref:System.Printing.PrintQueue.Refresh%2A?displayProperty=fullName>."},{"content":"This ensures that the object's properties accurately represent the state of the physical printer that it represents.","pos":[2650,2766]},{"content":"Then the application gets the collection of print jobs currently in the print queue by using <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.GetPrintJobInfoCollection%2A&gt;</ph>.","pos":[2767,2923],"source":" Then the application gets the collection of print jobs currently in the print queue by using <xref:System.Printing.PrintQueue.GetPrintJobInfoCollection%2A>."},{"content":"Next the application loops through the <ph id=\"ph1\">&lt;xref:System.Printing.PrintSystemJobInfo&gt;</ph> collection and compares each <ph id=\"ph2\">&lt;xref:System.Printing.PrintSystemJobInfo.Submitter%2A&gt;</ph> property with the alias of the complaining user.","pos":[2930,3143],"source":"Next the application loops through the <xref:System.Printing.PrintSystemJobInfo> collection and compares each <xref:System.Printing.PrintSystemJobInfo.Submitter%2A> property with the alias of the complaining user."},{"content":"If they match, the application adds identifying information about the job to the string that will be presented.","pos":[3144,3255]},{"content":"(The <ph id=\"ph1\">`userName`</ph> and <ph id=\"ph2\">`jobList`</ph> variables are initialized earlier in the application.)","pos":[3256,3340],"source":" (The `userName` and `jobList` variables are initialized earlier in the application.)"},{"pos":[3347,3907],"content":"[!code-cpp[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#enumeratejobsinqueues)]\n[!code-csharp[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#enumeratejobsinqueues)]\n[!code-vb[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#enumeratejobsinqueues)]","leadings":[""," "," "],"nodes":[{"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#EnumerateJobsInQueues<ept id=\"p2\">](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#enumeratejobsinqueues)</ept><ept id=\"p1\">]</ept>","pos":[0,178],"source":"[!code-cpp[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#enumeratejobsinqueues)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#EnumerateJobsInQueues<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#enumeratejobsinqueues)</ept><ept id=\"p1\">]</ept>","pos":[179,365],"source":"[!code-csharp[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#enumeratejobsinqueues)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#EnumerateJobsInQueues<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#enumeratejobsinqueues)</ept><ept id=\"p1\">]</ept>","pos":[366,558],"source":"[!code-vb[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#enumeratejobsinqueues)]"}]},{"content":"The next code example picks up the application at Step 2.","pos":[3914,3971]},{"content":"(See above.) The problematic job has been identified and the application prompts for the information that will identify it.","pos":[3972,4095]},{"content":"From this information it creates <ph id=\"ph1\">&lt;xref:System.Printing.PrintServer&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Printing.PrintQueue&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Printing.PrintSystemJobInfo&gt;</ph> objects.","pos":[4096,4254],"source":" From this information it creates <xref:System.Printing.PrintServer>, <xref:System.Printing.PrintQueue>, and <xref:System.Printing.PrintSystemJobInfo> objects."},{"content":"At this point the application contains a branching structure corresponding to the two ways of checking a print job's status:","pos":[4261,4385]},{"content":"You can read the flags of the <ph id=\"ph1\">&lt;xref:System.Printing.PrintSystemJobInfo.JobStatus%2A&gt;</ph> property which is of type <ph id=\"ph2\">&lt;xref:System.Printing.PrintJobStatus&gt;</ph>.","pos":[4395,4544],"source":"You can read the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property which is of type <xref:System.Printing.PrintJobStatus>."},{"content":"You can read each relevant property such as <ph id=\"ph1\">&lt;xref:System.Printing.PrintSystemJobInfo.IsBlocked%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Printing.PrintSystemJobInfo.IsInError%2A&gt;</ph>.","pos":[4554,4712],"source":"You can read each relevant property such as <xref:System.Printing.PrintSystemJobInfo.IsBlocked%2A> and <xref:System.Printing.PrintSystemJobInfo.IsInError%2A>."},{"content":"This example demonstrates both methods, so the user was previously prompted as to which method to use and responded with \"Y\" if he or she wanted to use the flags of the <ph id=\"ph1\">&lt;xref:System.Printing.PrintSystemJobInfo.JobStatus%2A&gt;</ph> property.","pos":[4719,4952],"source":"This example demonstrates both methods, so the user was previously prompted as to which method to use and responded with \"Y\" if he or she wanted to use the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property."},{"content":"See below for the details of the two methods.","pos":[4953,4998]},{"content":"Finally, the application uses a method called <bpt id=\"p1\">**</bpt>ReportQueueAndJobAvailability<ept id=\"p1\">**</ept> to report on whether the job can be printed at this time of day.","pos":[4999,5143],"source":" Finally, the application uses a method called **ReportQueueAndJobAvailability** to report on whether the job can be printed at this time of day."},{"content":"This method is discussed in <bpt id=\"p1\">[</bpt>Discover Whether a Print Job Can Be Printed At This Time of Day<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day.md)</ept>.","pos":[5144,5353],"source":" This method is discussed in [Discover Whether a Print Job Can Be Printed At This Time of Day](../../../../docs/framework/wpf/advanced/how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day.md)."},{"pos":[5360,5992],"content":"[!code-cpp[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#identifyanddiagnoseproblematicjob)]\n[!code-csharp[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#identifyanddiagnoseproblematicjob)]\n[!code-vb[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#identifyanddiagnoseproblematicjob)]","leadings":[""," "," "],"nodes":[{"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob<ept id=\"p2\">](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#identifyanddiagnoseproblematicjob)</ept><ept id=\"p1\">]</ept>","pos":[0,202],"source":"[!code-cpp[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#identifyanddiagnoseproblematicjob)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#identifyanddiagnoseproblematicjob)</ept><ept id=\"p1\">]</ept>","pos":[203,413],"source":"[!code-csharp[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#identifyanddiagnoseproblematicjob)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#identifyanddiagnoseproblematicjob)</ept><ept id=\"p1\">]</ept>","pos":[414,630],"source":"[!code-vb[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#identifyanddiagnoseproblematicjob)]"}]},{"content":"To check print job status using the flags of the <ph id=\"ph1\">&lt;xref:System.Printing.PrintSystemJobInfo.JobStatus%2A&gt;</ph> property, you check each relevant flag to see if it is set.","pos":[5999,6162],"source":"To check print job status using the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property, you check each relevant flag to see if it is set."},{"content":"The standard way to see if one bit is set in a set of bit flags is to perform a logical AND operation with the set of flags as one operand and the flag itself as the other.","pos":[6163,6335]},{"content":"Since the flag itself has only one bit set, the result of the logical AND is that, at most, that same bit is set.","pos":[6336,6449]},{"content":"To find out whether it is or not, just compare the result of the logical AND with the flag itself.","pos":[6450,6548]},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.Printing.PrintJobStatus&gt;</ph>, the <bpt id=\"p1\">[</bpt>&amp; Operator (C# Reference)<ept id=\"p1\">](~/docs/csharp/language-reference/operators/and-operator.md)</ept>, and <ph id=\"ph2\">&lt;xref:System.FlagsAttribute&gt;</ph>.","pos":[6549,6740],"source":" For more information, see <xref:System.Printing.PrintJobStatus>, the [& Operator (C# Reference)](~/docs/csharp/language-reference/operators/and-operator.md), and <xref:System.FlagsAttribute>."},{"content":"For each attribute whose bit is set, the code reports this to the console screen and sometimes suggests a way to respond.","pos":[6747,6868]},{"content":"(The <bpt id=\"p1\">**</bpt>HandlePausedJob<ept id=\"p1\">**</ept> method that is called if the job or queue is paused is discussed below.)","pos":[6869,6966],"source":" (The **HandlePausedJob** method that is called if the job or queue is paused is discussed below.)"},{"pos":[6973,7581],"content":"[!code-cpp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobattributes)]\n[!code-csharp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobattributes)]\n[!code-vb[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobattributes)]","leadings":[""," "," "],"nodes":[{"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes<ept id=\"p2\">](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobattributes)</ept><ept id=\"p1\">]</ept>","pos":[0,194],"source":"[!code-cpp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobattributes)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobattributes)</ept><ept id=\"p1\">]</ept>","pos":[195,397],"source":"[!code-csharp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobattributes)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobattributes)</ept><ept id=\"p1\">]</ept>","pos":[398,606],"source":"[!code-vb[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobattributes)]"}]},{"content":"To check print job status using separate properties, you simply read each property and, if the property is <ph id=\"ph1\">`true`</ph>, report to the console screen and possibly suggest a way to respond.","pos":[7588,7770],"source":"To check print job status using separate properties, you simply read each property and, if the property is `true`, report to the console screen and possibly suggest a way to respond."},{"content":"(The <bpt id=\"p1\">**</bpt>HandlePausedJob<ept id=\"p1\">**</ept> method that is called if the job or queue is paused is discussed below.)","pos":[7771,7868],"source":" (The **HandlePausedJob** method that is called if the job or queue is paused is discussed below.)"},{"pos":[7875,8483],"content":"[!code-cpp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobproperties)]\n[!code-csharp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobproperties)]\n[!code-vb[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobproperties)]","leadings":[""," "," "],"nodes":[{"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties<ept id=\"p2\">](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobproperties)</ept><ept id=\"p1\">]</ept>","pos":[0,194],"source":"[!code-cpp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobproperties)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobproperties)</ept><ept id=\"p1\">]</ept>","pos":[195,397],"source":"[!code-csharp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobproperties)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobproperties)</ept><ept id=\"p1\">]</ept>","pos":[398,606],"source":"[!code-vb[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobproperties)]"}]},{"content":"The <bpt id=\"p1\">**</bpt>HandlePausedJob<ept id=\"p1\">**</ept> method enables the application's user to remotely resume paused jobs.","pos":[8490,8583],"source":"The **HandlePausedJob** method enables the application's user to remotely resume paused jobs."},{"content":"Because there might be a good reason why the print queue was paused, the method begins by prompting for a user decision about whether to resume it.","pos":[8584,8731]},{"content":"If the answer is \"Y\", then the <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.Resume%2A?displayProperty=fullName&gt;</ph> method is called.","pos":[8732,8849],"source":" If the answer is \"Y\", then the <xref:System.Printing.PrintQueue.Resume%2A?displayProperty=fullName> method is called."},{"content":"Next the user is prompted to decide if the job itself should be resumed, just in case it is paused independently of the print queue.","pos":[8856,8988]},{"content":"(Compare <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue.IsPaused%2A?displayProperty=fullName&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Printing.PrintSystemJobInfo.IsPaused%2A?displayProperty=fullName&gt;</ph>.) If the answer is \"Y\", then <ph id=\"ph3\">&lt;xref:System.Printing.PrintSystemJobInfo.Resume%2A?displayProperty=fullName&gt;</ph> is called; otherwise <ph id=\"ph4\">&lt;xref:System.Printing.PrintSystemJobInfo.Cancel%2A&gt;</ph> is called.","pos":[8989,9341],"source":" (Compare <xref:System.Printing.PrintQueue.IsPaused%2A?displayProperty=fullName> and <xref:System.Printing.PrintSystemJobInfo.IsPaused%2A?displayProperty=fullName>.) If the answer is \"Y\", then <xref:System.Printing.PrintSystemJobInfo.Resume%2A?displayProperty=fullName> is called; otherwise <xref:System.Printing.PrintSystemJobInfo.Cancel%2A> is called."},{"pos":[9348,9872],"content":"[!code-cpp[DiagnoseProblematicPrintJob#HandlePausedJob](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#handlepausedjob)]\n[!code-csharp[DiagnoseProblematicPrintJob#HandlePausedJob](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#handlepausedjob)]\n[!code-vb[DiagnoseProblematicPrintJob#HandlePausedJob](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#handlepausedjob)]","leadings":[""," "," "],"nodes":[{"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#HandlePausedJob<ept id=\"p2\">](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#handlepausedjob)</ept><ept id=\"p1\">]</ept>","pos":[0,166],"source":"[!code-cpp[DiagnoseProblematicPrintJob#HandlePausedJob](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#handlepausedjob)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#HandlePausedJob<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#handlepausedjob)</ept><ept id=\"p1\">]</ept>","pos":[167,341],"source":"[!code-csharp[DiagnoseProblematicPrintJob#HandlePausedJob](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#handlepausedjob)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DiagnoseProblematicPrintJob#HandlePausedJob<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#handlepausedjob)</ept><ept id=\"p1\">]</ept>","pos":[342,522],"source":"[!code-vb[DiagnoseProblematicPrintJob#HandlePausedJob](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#handlepausedjob)]"}]},{"pos":[9881,9889],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Printing.PrintJobStatus&gt;</ph>","pos":[9893,9930],"source":"<xref:System.Printing.PrintJobStatus> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Printing.PrintSystemJobInfo&gt;</ph>","pos":[9935,9976],"source":"<xref:System.Printing.PrintSystemJobInfo> "},{"content":"<ph id=\"ph1\">&lt;xref:System.FlagsAttribute&gt;</ph>","pos":[9981,10009],"source":"<xref:System.FlagsAttribute> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue&gt;</ph>","pos":[10014,10047],"source":"<xref:System.Printing.PrintQueue> "},{"content":"<bpt id=\"p1\">[</bpt>&amp; Operator (C# Reference)<ept id=\"p1\">](~/docs/csharp/language-reference/operators/and-operator.md)</ept><ph id=\"ph1\"> </ph>","pos":[10052,10140],"source":"[& Operator (C# Reference)](~/docs/csharp/language-reference/operators/and-operator.md) "},{"content":"<bpt id=\"p1\">[</bpt>Documents in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)</ept><ph id=\"ph1\"> </ph>","pos":[10144,10224],"source":"[Documents in WPF](../../../../docs/framework/wpf/advanced/documents-in-wpf.md) "},{"content":"<bpt id=\"p1\">[</bpt>Printing Overview<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/printing-overview.md)</ept>","pos":[10228,10309],"source":"[Printing Overview](../../../../docs/framework/wpf/advanced/printing-overview.md)"}]}