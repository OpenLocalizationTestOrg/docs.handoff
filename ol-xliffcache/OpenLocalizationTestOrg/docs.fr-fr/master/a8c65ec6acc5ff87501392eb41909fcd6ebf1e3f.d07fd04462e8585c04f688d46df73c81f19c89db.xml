{"content":"---\ntitle: \"CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT\"\nms.date: \"03/30/2017\"\nf1_keywords: \n  - \"CORPROF_E_UNSUPPORTED_CALL_SEQUENCE\"\nhelpviewer_keywords: \n  - \"CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT [.NET Framework profiling]\"\nms.assetid: f2fc441f-d62e-4f72-a011-354ea13c8c59\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT\nThe CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT was introduced in the .NET Framework version 2.0. The [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)] returns this HRESULT in two scenarios:  \n  \n-   When a hijacking profiler forcibly resets a thread's register context at an arbitrary time so that the thread tries to access structures that are in an inconsistent state.  \n  \n-   When a profiler tries to call an informational method that triggers garbage collection from a callback method that forbids garbage collection.  \n  \n These two scenarios are discussed in the following sections.  \n  \n## Hijacking Profilers  \n (This scenario is primarily an issue with hijacking profilers although there are cases where non-hijacking profilers can see this HRESULT.)  \n  \n In this scenario, a hijacking profiler forcibly resets a thread's register context at an arbitrary time so that the thread can enter profiler code or re-enter the common language runtime (CLR) through an [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) method.  \n  \n Many of the IDs that the profiling API provides point to data structures in the CLR. Many `ICorProfilerInfo` calls merely read information from these data structures and pass them back. However, the CLR might change things in those structures as it runs, and it might use locks to do so. Suppose the CLR was already holding (or attempting to acquire) a lock at the time the profiler hijacked the thread. If the thread re-enters the CLR and tries to take more locks or inspect structures that were in the process of being modified, these structures might be in an inconsistent state. Deadlocks and access violations can easily occur in such situations.  \n  \n In general, when a non-hijacking profiler executes code inside an [ICorProfilerCallback](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) method and calls into an `ICorProfilerInfo` method with valid parameters, it should not deadlock or receive an access violation. For example, profiler code that runs inside the [ICorProfilerCallback::ClassLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadfinished-method.md) method may ask for information about the class by calling the [ICorProfilerInfo2::GetClassIDInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getclassidinfo2-method.md) method. The code might receive an CORPROF_E_DATAINCOMPLETE HRESULT to indicate that information is unavailable; however, it will not deadlock or receive an access violation. This class of calls into `ICorProfilerInfo` are called synchronous, because they are made from an `ICorProfilerCallback` method.  \n  \n However, a managed thread that executes code that is not within an `ICorProfilerCallback` method is considered to be making an asynchronous call. In the .NET Framework version 1, it was difficult to determine what might happen in an asynchronous call. The call could deadlock, crash, or give an invalid answer. The .NET Framework version 2.0 introduced some simple checks to help you avoid this problem. In the .NET Framework 2.0, if you call an unsafe `ICorProfilerInfo` function asynchronously, it fails with an CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT.  \n  \n In general, asynchronous calls are not safe. However, the following methods are safe and specifically support asynchronous calls:  \n  \n-   [GetEventMask](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-geteventmask-method.md)  \n  \n-   [SetEventMask](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-seteventmask-method.md)  \n  \n-   [GetCurrentThreadID](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getcurrentthreadid-method.md)  \n  \n-   [GetThreadContext](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getthreadcontext-method.md)  \n  \n-   [GetThreadAppDomain](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getthreadappdomain-method.md)  \n  \n-   [GetFunctionFromIP](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getfunctionfromip-method.md)  \n  \n-   [GetFunctionInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getfunctioninfo-method.md)  \n  \n-   [GetFunctionInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getfunctioninfo2-method.md)  \n  \n-   [GetCodeInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getcodeinfo-method.md)  \n  \n-   [GetCodeInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getcodeinfo2-method.md)  \n  \n-   [GetModuleInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getmoduleinfo-method.md)  \n  \n-   [GetClassIDInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getclassidinfo-method.md)  \n  \n-   [GetClassIDInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getclassidinfo2-method.md)  \n  \n-   [IsArrayClass](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-isarrayclass-method.md)  \n  \n-   [SetFunctionIDMapper](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-setfunctionidmapper-method.md)  \n  \n-   [DoStackSnapshot](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md)  \n  \n For additional information, see the entry [Why we have CORPROF_E_UNSUPPORTED_CALL_SEQUENCE](https://go.microsoft.com/fwlink/?LinkId=169156) in the CLR Profiling API blog.  \n  \n## Triggering Garbage Collections  \n This scenario involves a profiler that is running inside a callback method (for example, one of the `ICorProfilerCallback` methods) that forbids garbage collection. If the profiler tries to call an informational method (for example, a method on the `ICorProfilerInfo` interface) that might trigger a garbage collection, the informational method fails with a CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT.  \n  \n The following table displays the callback methods that forbid garbage collections, and informational methods that may trigger garbage collections. If the profiler executes inside one of the listed callback methods and calls one of the listed informational methods, that informational method fails with a CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT.  \n  \n|Callback methods that forbid garbage collections|Informational methods that trigger garbage collections|  \n|------------------------------------------------------|------------------------------------------------------------|  \n|[ThreadAssignedToOSThread](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-threadassignedtoosthread-method.md)<br /><br /> [ExceptionUnwindFunctionEnter](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptionunwindfunctionenter-method.md)<br /><br /> [ExceptionUnwindFunctionLeave](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptionunwindfunctionleave-method.md)<br /><br /> [ExceptionUnwindFinallyEnter](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptionunwindfinallyenter-method.md)<br /><br /> [ExceptionUnwindFinallyLeave](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptionunwindfinallyleave-method.md)<br /><br /> [ExceptionCatcherEnter](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptioncatcherenter-method.md)<br /><br /> [RuntimeSuspendStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimesuspendstarted-method.md)<br /><br /> [RuntimeSuspendFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimesuspendfinished-method.md)<br /><br /> [RuntimeSuspendAborted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimesuspendaborted-method.md)<br /><br /> [RuntimeThreadSuspended](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimethreadsuspended-method.md)<br /><br /> [RuntimeThreadResumed](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimethreadresumed-method.md)<br /><br /> [MovedReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-movedreferences-method.md)<br /><br /> [ObjectReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-objectreferences-method.md)<br /><br /> [ObjectsAllocatedByClass](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-objectsallocatedbyclass-method.md)<br /><br /> [RootReferences2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-rootreferences-method.md)<br /><br /> [HandleCreated](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-handlecreated-method.md)<br /><br /> [HandleDestroyed](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-handledestroyed-method.md)<br /><br /> [GarbageCollectionStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-garbagecollectionstarted-method.md)<br /><br /> [GarbageCollectionFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-garbagecollectionfinished-method.md)|[GetILFunctionBodyAllocator](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getilfunctionbodyallocator-method.md)<br /><br /> [SetILFunctionBody](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-setilfunctionbody-method.md)<br /><br /> [SetILInstrumentedCodeMap](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-setilinstrumentedcodemap-method.md)<br /><br /> [ForceGC](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-forcegc-method.md)<br /><br /> [GetClassFromToken](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getclassfromtoken-method.md)<br /><br /> [GetClassFromTokenAndTypeArgs](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getclassfromtokenandtypeargs-method.md)<br /><br /> [GetFunctionFromTokenAndTypeArgs](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getfunctionfromtokenandtypeargs-method.md)<br /><br /> [GetAppDomainInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getappdomaininfo-method.md)<br /><br /> [EnumModules](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-enummodules-method.md)<br /><br /> [RequestProfilerDetach](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-requestprofilerdetach-method.md)<br /><br /> [GetAppDomainsContainingModule](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-getappdomainscontainingmodule-method.md)|  \n  \n## See also\n\n- [ICorProfilerCallback Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md)\n- [ICorProfilerCallback2 Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md)\n- [ICorProfilerCallback3 Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback3-interface.md)\n- [ICorProfilerInfo Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md)\n- [ICorProfilerInfo2 Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md)\n- [ICorProfilerInfo3 Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-interface.md)\n- [Profiling Interfaces](../../../../docs/framework/unmanaged-api/profiling/profiling-interfaces.md)\n- [Profiling](../../../../docs/framework/unmanaged-api/profiling/index.md)\n","nodes":[{"pos":[4,319],"embed":true,"restype":"x-metadata","content":"title: \"CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT\"\nms.date: \"03/30/2017\"\nf1_keywords: \n  - \"CORPROF_E_UNSUPPORTED_CALL_SEQUENCE\"\nhelpviewer_keywords: \n  - \"CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT [.NET Framework profiling]\"\nms.assetid: f2fc441f-d62e-4f72-a011-354ea13c8c59\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT","nodes":[{"pos":[0,43],"content":"CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT","nodes":[{"content":"CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT","pos":[0,43]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[326,369],"content":"CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT","linkify":"CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT","nodes":[{"content":"CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT","pos":[0,43]}]},{"content":"The CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT was introduced in the .NET Framework version 2.0.","pos":[370,467]},{"content":"The <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph> returns this HRESULT in two scenarios:","pos":[468,576],"source":" The [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)] returns this HRESULT in two scenarios:"},{"content":"When a hijacking profiler forcibly resets a thread's register context at an arbitrary time so that the thread tries to access structures that are in an inconsistent state.","pos":[586,757]},{"content":"When a profiler tries to call an informational method that triggers garbage collection from a callback method that forbids garbage collection.","pos":[767,909]},{"content":"These two scenarios are discussed in the following sections.","pos":[916,976]},{"pos":[985,1004],"content":"Hijacking Profilers","linkify":"Hijacking Profilers","nodes":[{"content":"Hijacking Profilers","pos":[0,19]}]},{"content":"(This scenario is primarily an issue with hijacking profilers although there are cases where non-hijacking profilers can see this HRESULT.)","pos":[1008,1147]},{"pos":[1154,1466],"content":"In this scenario, a hijacking profiler forcibly resets a thread's register context at an arbitrary time so that the thread can enter profiler code or re-enter the common language runtime (CLR) through an <bpt id=\"p1\">[</bpt>ICorProfilerInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md)</ept> method.","source":"In this scenario, a hijacking profiler forcibly resets a thread's register context at an arbitrary time so that the thread can enter profiler code or re-enter the common language runtime (CLR) through an [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) method."},{"content":"Many of the IDs that the profiling API provides point to data structures in the CLR.","pos":[1473,1557]},{"content":"Many <ph id=\"ph1\">`ICorProfilerInfo`</ph> calls merely read information from these data structures and pass them back.","pos":[1558,1658],"source":" Many `ICorProfilerInfo` calls merely read information from these data structures and pass them back."},{"content":"However, the CLR might change things in those structures as it runs, and it might use locks to do so.","pos":[1659,1760]},{"content":"Suppose the CLR was already holding (or attempting to acquire) a lock at the time the profiler hijacked the thread.","pos":[1761,1876]},{"content":"If the thread re-enters the CLR and tries to take more locks or inspect structures that were in the process of being modified, these structures might be in an inconsistent state.","pos":[1877,2055]},{"content":"Deadlocks and access violations can easily occur in such situations.","pos":[2056,2124]},{"content":"In general, when a non-hijacking profiler executes code inside an <bpt id=\"p1\">[</bpt>ICorProfilerCallback<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md)</ept> method and calls into an <ph id=\"ph1\">`ICorProfilerInfo`</ph> method with valid parameters, it should not deadlock or receive an access violation.","pos":[2131,2434],"source":"In general, when a non-hijacking profiler executes code inside an [ICorProfilerCallback](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) method and calls into an `ICorProfilerInfo` method with valid parameters, it should not deadlock or receive an access violation."},{"content":"For example, profiler code that runs inside the <bpt id=\"p1\">[</bpt>ICorProfilerCallback::ClassLoadFinished<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadfinished-method.md)</ept> method may ask for information about the class by calling the <bpt id=\"p2\">[</bpt>ICorProfilerInfo2::GetClassIDInfo2<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getclassidinfo2-method.md)</ept> method.","pos":[2435,2828],"source":" For example, profiler code that runs inside the [ICorProfilerCallback::ClassLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadfinished-method.md) method may ask for information about the class by calling the [ICorProfilerInfo2::GetClassIDInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getclassidinfo2-method.md) method."},{"content":"The code might receive an CORPROF_E_DATAINCOMPLETE HRESULT to indicate that information is unavailable; however, it will not deadlock or receive an access violation.","pos":[2829,2994]},{"content":"This class of calls into <ph id=\"ph1\">`ICorProfilerInfo`</ph> are called synchronous, because they are made from an <ph id=\"ph2\">`ICorProfilerCallback`</ph> method.","pos":[2995,3123],"source":" This class of calls into `ICorProfilerInfo` are called synchronous, because they are made from an `ICorProfilerCallback` method."},{"content":"However, a managed thread that executes code that is not within an <ph id=\"ph1\">`ICorProfilerCallback`</ph> method is considered to be making an asynchronous call.","pos":[3130,3275],"source":"However, a managed thread that executes code that is not within an `ICorProfilerCallback` method is considered to be making an asynchronous call."},{"content":"In the .NET Framework version 1, it was difficult to determine what might happen in an asynchronous call.","pos":[3276,3381]},{"content":"The call could deadlock, crash, or give an invalid answer.","pos":[3382,3440]},{"content":"The .NET Framework version 2.0 introduced some simple checks to help you avoid this problem.","pos":[3441,3533]},{"content":"In the .NET Framework 2.0, if you call an unsafe <ph id=\"ph1\">`ICorProfilerInfo`</ph> function asynchronously, it fails with an CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT.","pos":[3534,3688],"source":" In the .NET Framework 2.0, if you call an unsafe `ICorProfilerInfo` function asynchronously, it fails with an CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT."},{"content":"In general, asynchronous calls are not safe.","pos":[3695,3739]},{"content":"However, the following methods are safe and specifically support asynchronous calls:","pos":[3740,3824]},{"pos":[3834,3940],"content":"<bpt id=\"p1\">[</bpt>GetEventMask<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-geteventmask-method.md)</ept>","source":"[GetEventMask](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-geteventmask-method.md)"},{"pos":[3950,4056],"content":"<bpt id=\"p1\">[</bpt>SetEventMask<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-seteventmask-method.md)</ept>","source":"[SetEventMask](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-seteventmask-method.md)"},{"pos":[4066,4184],"content":"<bpt id=\"p1\">[</bpt>GetCurrentThreadID<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getcurrentthreadid-method.md)</ept>","source":"[GetCurrentThreadID](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getcurrentthreadid-method.md)"},{"pos":[4194,4308],"content":"<bpt id=\"p1\">[</bpt>GetThreadContext<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getthreadcontext-method.md)</ept>","source":"[GetThreadContext](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getthreadcontext-method.md)"},{"pos":[4318,4437],"content":"<bpt id=\"p1\">[</bpt>GetThreadAppDomain<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getthreadappdomain-method.md)</ept>","source":"[GetThreadAppDomain](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getthreadappdomain-method.md)"},{"pos":[4447,4563],"content":"<bpt id=\"p1\">[</bpt>GetFunctionFromIP<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getfunctionfromip-method.md)</ept>","source":"[GetFunctionFromIP](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getfunctionfromip-method.md)"},{"pos":[4573,4685],"content":"<bpt id=\"p1\">[</bpt>GetFunctionInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getfunctioninfo-method.md)</ept>","source":"[GetFunctionInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getfunctioninfo-method.md)"},{"pos":[4695,4810],"content":"<bpt id=\"p1\">[</bpt>GetFunctionInfo2<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getfunctioninfo2-method.md)</ept>","source":"[GetFunctionInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getfunctioninfo2-method.md)"},{"pos":[4820,4924],"content":"<bpt id=\"p1\">[</bpt>GetCodeInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getcodeinfo-method.md)</ept>","source":"[GetCodeInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getcodeinfo-method.md)"},{"pos":[4934,5041],"content":"<bpt id=\"p1\">[</bpt>GetCodeInfo2<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getcodeinfo2-method.md)</ept>","source":"[GetCodeInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getcodeinfo2-method.md)"},{"pos":[5051,5159],"content":"<bpt id=\"p1\">[</bpt>GetModuleInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getmoduleinfo-method.md)</ept>","source":"[GetModuleInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getmoduleinfo-method.md)"},{"pos":[5169,5279],"content":"<bpt id=\"p1\">[</bpt>GetClassIDInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getclassidinfo-method.md)</ept>","source":"[GetClassIDInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getclassidinfo-method.md)"},{"pos":[5289,5402],"content":"<bpt id=\"p1\">[</bpt>GetClassIDInfo2<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getclassidinfo2-method.md)</ept>","source":"[GetClassIDInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getclassidinfo2-method.md)"},{"pos":[5412,5518],"content":"<bpt id=\"p1\">[</bpt>IsArrayClass<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-isarrayclass-method.md)</ept>","source":"[IsArrayClass](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-isarrayclass-method.md)"},{"pos":[5528,5648],"content":"<bpt id=\"p1\">[</bpt>SetFunctionIDMapper<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-setfunctionidmapper-method.md)</ept>","source":"[SetFunctionIDMapper](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-setfunctionidmapper-method.md)"},{"pos":[5658,5771],"content":"<bpt id=\"p1\">[</bpt>DoStackSnapshot<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md)</ept>","source":"[DoStackSnapshot](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md)"},{"pos":[5778,5948],"content":"For additional information, see the entry <bpt id=\"p1\">[</bpt>Why we have CORPROF_E_UNSUPPORTED_CALL_SEQUENCE<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=169156)</ept> in the CLR Profiling API blog.","source":"For additional information, see the entry [Why we have CORPROF_E_UNSUPPORTED_CALL_SEQUENCE](https://go.microsoft.com/fwlink/?LinkId=169156) in the CLR Profiling API blog."},{"pos":[5957,5987],"content":"Triggering Garbage Collections","linkify":"Triggering Garbage Collections","nodes":[{"content":"Triggering Garbage Collections","pos":[0,30]}]},{"content":"This scenario involves a profiler that is running inside a callback method (for example, one of the <ph id=\"ph1\">`ICorProfilerCallback`</ph> methods) that forbids garbage collection.","pos":[5991,6155],"source":"This scenario involves a profiler that is running inside a callback method (for example, one of the `ICorProfilerCallback` methods) that forbids garbage collection."},{"content":"If the profiler tries to call an informational method (for example, a method on the <ph id=\"ph1\">`ICorProfilerInfo`</ph> interface) that might trigger a garbage collection, the informational method fails with a CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT.","pos":[6156,6393],"source":" If the profiler tries to call an informational method (for example, a method on the `ICorProfilerInfo` interface) that might trigger a garbage collection, the informational method fails with a CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT."},{"content":"The following table displays the callback methods that forbid garbage collections, and informational methods that may trigger garbage collections.","pos":[6400,6546]},{"content":"If the profiler executes inside one of the listed callback methods and calls one of the listed informational methods, that informational method fails with a CORPROF_E_UNSUPPORTED_CALL_SEQUENCE HRESULT.","pos":[6547,6748]},{"content":"Callback methods that forbid garbage collections","pos":[6755,6803]},{"content":"Informational methods that trigger garbage collections","pos":[6804,6858]},{"content":"<bpt id=\"p1\">[</bpt>ThreadAssignedToOSThread<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-threadassignedtoosthread-method.md)</ept>","pos":[6983,7117],"source":"[ThreadAssignedToOSThread](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-threadassignedtoosthread-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>ExceptionUnwindFunctionEnter<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptionunwindfunctionenter-method.md)</ept>","pos":[7130,7272],"source":"[ExceptionUnwindFunctionEnter](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptionunwindfunctionenter-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>ExceptionUnwindFunctionLeave<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptionunwindfunctionleave-method.md)</ept>","pos":[7285,7427],"source":"[ExceptionUnwindFunctionLeave](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptionunwindfunctionleave-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>ExceptionUnwindFinallyEnter<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptionunwindfinallyenter-method.md)</ept>","pos":[7440,7580],"source":"[ExceptionUnwindFinallyEnter](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptionunwindfinallyenter-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>ExceptionUnwindFinallyLeave<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptionunwindfinallyleave-method.md)</ept>","pos":[7593,7733],"source":"[ExceptionUnwindFinallyLeave](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptionunwindfinallyleave-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>ExceptionCatcherEnter<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptioncatcherenter-method.md)</ept>","pos":[7746,7874],"source":"[ExceptionCatcherEnter](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-exceptioncatcherenter-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>RuntimeSuspendStarted<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimesuspendstarted-method.md)</ept>","pos":[7887,8015],"source":"[RuntimeSuspendStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimesuspendstarted-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>RuntimeSuspendFinished<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimesuspendfinished-method.md)</ept>","pos":[8028,8158],"source":"[RuntimeSuspendFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimesuspendfinished-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>RuntimeSuspendAborted<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimesuspendaborted-method.md)</ept>","pos":[8171,8299],"source":"[RuntimeSuspendAborted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimesuspendaborted-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>RuntimeThreadSuspended<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimethreadsuspended-method.md)</ept>","pos":[8312,8442],"source":"[RuntimeThreadSuspended](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimethreadsuspended-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>RuntimeThreadResumed<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimethreadresumed-method.md)</ept>","pos":[8455,8581],"source":"[RuntimeThreadResumed](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-runtimethreadresumed-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>MovedReferences<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-movedreferences-method.md)</ept>","pos":[8594,8710],"source":"[MovedReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-movedreferences-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>ObjectReferences<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-objectreferences-method.md)</ept>","pos":[8723,8841],"source":"[ObjectReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-objectreferences-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>ObjectsAllocatedByClass<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-objectsallocatedbyclass-method.md)</ept>","pos":[8854,8986],"source":"[ObjectsAllocatedByClass](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-objectsallocatedbyclass-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>RootReferences2<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-rootreferences-method.md)</ept>","pos":[8999,9114],"source":"[RootReferences2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-rootreferences-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>HandleCreated<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-handlecreated-method.md)</ept>","pos":[9127,9240],"source":"[HandleCreated](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-handlecreated-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>HandleDestroyed<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-handledestroyed-method.md)</ept>","pos":[9253,9370],"source":"[HandleDestroyed](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-handledestroyed-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>GarbageCollectionStarted<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-garbagecollectionstarted-method.md)</ept>","pos":[9383,9518],"source":"[GarbageCollectionStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-garbagecollectionstarted-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>GarbageCollectionFinished<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-garbagecollectionfinished-method.md)</ept>","pos":[9531,9668],"source":"[GarbageCollectionFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-garbagecollectionfinished-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>GetILFunctionBodyAllocator<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getilfunctionbodyallocator-method.md)</ept>","pos":[9669,9803],"source":"[GetILFunctionBodyAllocator](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getilfunctionbodyallocator-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>SetILFunctionBody<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-setilfunctionbody-method.md)</ept>","pos":[9816,9932],"source":"[SetILFunctionBody](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-setilfunctionbody-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>SetILInstrumentedCodeMap<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-setilinstrumentedcodemap-method.md)</ept>","pos":[9945,10075],"source":"[SetILInstrumentedCodeMap](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-setilinstrumentedcodemap-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>ForceGC<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-forcegc-method.md)</ept>","pos":[10088,10184],"source":"[ForceGC](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-forcegc-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>GetClassFromToken<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getclassfromtoken-method.md)</ept>","pos":[10197,10313],"source":"[GetClassFromToken](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getclassfromtoken-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>GetClassFromTokenAndTypeArgs<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getclassfromtokenandtypeargs-method.md)</ept>","pos":[10326,10465],"source":"[GetClassFromTokenAndTypeArgs](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getclassfromtokenandtypeargs-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>GetFunctionFromTokenAndTypeArgs<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getfunctionfromtokenandtypeargs-method.md)</ept>","pos":[10478,10623],"source":"[GetFunctionFromTokenAndTypeArgs](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getfunctionfromtokenandtypeargs-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>GetAppDomainInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getappdomaininfo-method.md)</ept>","pos":[10636,10750],"source":"[GetAppDomainInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getappdomaininfo-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>EnumModules<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-enummodules-method.md)</ept>","pos":[10763,10868],"source":"[EnumModules](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-enummodules-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>RequestProfilerDetach<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-requestprofilerdetach-method.md)</ept>","pos":[10881,11006],"source":"[RequestProfilerDetach](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-requestprofilerdetach-method.md)"},{"content":"<bpt id=\"p1\">[</bpt>GetAppDomainsContainingModule<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-getappdomainscontainingmodule-method.md)</ept>","pos":[11019,11160],"source":"[GetAppDomainsContainingModule](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-getappdomainscontainingmodule-method.md)"},{"pos":[11170,11178],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[11182,11300],"content":"<bpt id=\"p1\">[</bpt>ICorProfilerCallback Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md)</ept>","source":"[ICorProfilerCallback Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md)"},{"pos":[11303,11423],"content":"<bpt id=\"p1\">[</bpt>ICorProfilerCallback2 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md)</ept>","source":"[ICorProfilerCallback2 Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md)"},{"pos":[11426,11546],"content":"<bpt id=\"p1\">[</bpt>ICorProfilerCallback3 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback3-interface.md)</ept>","source":"[ICorProfilerCallback3 Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback3-interface.md)"},{"pos":[11549,11659],"content":"<bpt id=\"p1\">[</bpt>ICorProfilerInfo Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md)</ept>","source":"[ICorProfilerInfo Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md)"},{"pos":[11662,11774],"content":"<bpt id=\"p1\">[</bpt>ICorProfilerInfo2 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md)</ept>","source":"[ICorProfilerInfo2 Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md)"},{"pos":[11777,11889],"content":"<bpt id=\"p1\">[</bpt>ICorProfilerInfo3 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-interface.md)</ept>","source":"[ICorProfilerInfo3 Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-interface.md)"},{"pos":[11892,11990],"content":"<bpt id=\"p1\">[</bpt>Profiling Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/profiling-interfaces.md)</ept>","source":"[Profiling Interfaces](../../../../docs/framework/unmanaged-api/profiling/profiling-interfaces.md)"},{"pos":[11993,12065],"content":"<bpt id=\"p1\">[</bpt>Profiling<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/index.md)</ept>","source":"[Profiling](../../../../docs/framework/unmanaged-api/profiling/index.md)"}]}