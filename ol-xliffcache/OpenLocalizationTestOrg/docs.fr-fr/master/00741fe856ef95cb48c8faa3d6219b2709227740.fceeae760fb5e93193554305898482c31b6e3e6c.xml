{"content":"---\ntitle: \"GetRequestedRuntimeVersion Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"GetRequestedRuntimeVersion\"\napi_location: \n  - \"mscoree.dll\"\n  - \"mscoreei.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"GetRequestedRuntimeVersion\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetRequestedRuntimeVersion function [.NET Framework hosting]\"\nms.assetid: 82f596a4-483d-4509-b0c5-a84c53c3da1b\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 14\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# GetRequestedRuntimeVersion Function\nGets the version number of the common language runtime (CLR) requested by the specified application. If that version is not installed, gets the most recent version that is installed before the requested version.  \n  \n This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)].  \n  \n## Syntax  \n  \n```  \nHRESULT GetRequestedRuntimeVersion (  \n    [in]  LPWSTR  pExe,   \n    [out] LPWSTR  pVersion,   \n    [in]  DWORD   cchBuffer,   \n    [out] DWORD  *pdwLength  \n);  \n```  \n  \n#### Parameters  \n `pExe`  \n [in] The name of the application.  \n  \n `pVersion`  \n [out] A buffer that contains the version number string upon successful completion.  \n  \n `cchBuffer`  \n [in] The length of the version buffer.  \n  \n `pdwLength`  \n [out] A pointer to the length of the version number string.  \n  \n## Return Value  \n This method returns standard Component Object Model (COM) error codes, as defined in WinError.h, in addition to the following values.  \n  \n|Return code|Description|  \n|-----------------|-----------------|  \n|S_OK|The method completed successfully.|  \n|ERROR_INSUFFICIENT_BUFFER|The version buffer is not large enough to store the version string.|  \n|E_POINTER|`pdwLength` is null.|  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]  \n  \n## See Also  \n [GetRequestedRuntimeInfo Function](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md)   \n [GetVersionFromProcess Function](../../../../docs/framework/unmanaged-api/hosting/getversionfromprocess-function.md)   \n [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)","nodes":[{"pos":[4,670],"embed":true,"restype":"x-metadata","content":"title: \"GetRequestedRuntimeVersion Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"GetRequestedRuntimeVersion\"\napi_location: \n  - \"mscoree.dll\"\n  - \"mscoreei.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"GetRequestedRuntimeVersion\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetRequestedRuntimeVersion function [.NET Framework hosting]\"\nms.assetid: 82f596a4-483d-4509-b0c5-a84c53c3da1b\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 14\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"GetRequestedRuntimeVersion Function | Microsoft Docs","nodes":[{"pos":[0,52],"content":"GetRequestedRuntimeVersion Function | Microsoft Docs","nodes":[{"content":"GetRequestedRuntimeVersion Function | Microsoft Docs","pos":[0,52]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[677,712],"content":"GetRequestedRuntimeVersion Function","linkify":"GetRequestedRuntimeVersion Function","nodes":[{"content":"GetRequestedRuntimeVersion Function","pos":[0,35]}]},{"content":"Gets the version number of the common language runtime (CLR) requested by the specified application.","pos":[713,813]},{"content":"If that version is not installed, gets the most recent version that is installed before the requested version.","pos":[814,924]},{"pos":[931,1038],"content":"This function has been deprecated in the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph>.","source":"This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]."},{"pos":[1047,1053],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1243,1253],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The name of the application.","pos":[1267,1300]},{"content":"[out] A buffer that contains the version number string upon successful completion.","pos":[1321,1403]},{"content":"[in] The length of the version buffer.","pos":[1425,1463]},{"content":"[out] A pointer to the length of the version number string.","pos":[1485,1544]},{"pos":[1553,1565],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns standard Component Object Model (COM) error codes, as defined in WinError.h, in addition to the following values.","pos":[1569,1702]},{"content":"Return code","pos":[1709,1720]},{"content":"Description","pos":[1721,1732]},{"content":"S_OK","pos":[1777,1781]},{"content":"The method completed successfully.","pos":[1782,1816]},{"content":"ERROR_INSUFFICIENT_BUFFER","pos":[1821,1846]},{"content":"The version buffer is not large enough to store the version string.","pos":[1847,1914]},{"content":"E_POINTER","pos":[1919,1928]},{"pos":[1929,1949],"content":"<ph id=\"ph1\">`pdwLength`</ph> is null.","source":"`pdwLength` is null."},{"pos":[1959,1971],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[1975,2079],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2086,2107],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2114,2138],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> MSCorEE.dll","source":"**Library:** MSCorEE.dll"},{"pos":[2145,2253],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]"},{"pos":[2262,2270],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>GetRequestedRuntimeInfo Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md)</ept><ph id=\"ph1\"> </ph>","pos":[2274,2395],"source":"[GetRequestedRuntimeInfo Function](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md) "},{"content":"<bpt id=\"p1\">[</bpt>GetVersionFromProcess Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/getversionfromprocess-function.md)</ept><ph id=\"ph1\"> </ph>","pos":[2399,2516],"source":"[GetVersionFromProcess Function](../../../../docs/framework/unmanaged-api/hosting/getversionfromprocess-function.md) "},{"content":"<bpt id=\"p1\">[</bpt>Deprecated CLR Hosting Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)</ept>","pos":[2520,2640],"source":"[Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)"}]}