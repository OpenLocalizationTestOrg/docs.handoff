{"content":"---\ntitle: \"Message Security with a User Name Client | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 36335cb9-76b8-4443-92c7-44f081eabb21\ncaps.latest.revision: 15\nauthor: \"BrucePerlerMS\"\nms.author: \"bruceper\"\nmanager: \"mbaldwin\"\n---\n# Message Security with a User Name Client\nThe following illustration shows an [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] service and client secured using message-level security. The service is authenticated with an X.509 certificate. The client authenticates using a user name and password.  \n  \n For a sample application, see [Message Security User Name](../../../../docs/framework/wcf/samples/message-security-user-name.md).  \n  \n ![Message security using username authentication](../../../../docs/framework/wcf/feature-details/media/1fb10a61-7e1d-42f5-b1af-195bfee5b3c6.gif \"1fb10a61-7e1d-42f5-b1af-195bfee5b3c6\")  \n  \n|Characteristic|Description|  \n|--------------------|-----------------|  \n|Security Mode|Message|  \n|Interoperability|[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] only|  \n|Authentication (Server)|Initial negotiation requires server authentication|  \n|Authentication (Client)|User name/password|  \n|Integrity|Yes, using shared security context|  \n|Confidentiality|Yes, using shared security context|  \n|Transport|HTTP|  \n|Binding|<xref:System.ServiceModel.WSHttpBinding>|  \n  \n## Service  \n The following code and configuration are meant to run independently. Do one of the following:  \n  \n-   Create a stand-alone service using the code with no configuration.  \n  \n-   Create a service using the supplied configuration, but do not define any endpoints.  \n  \n### Code  \n The following code shows how to create a service endpoint that uses message security.  \n  \n [!code-csharp[C_SecurityScenarios#9](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#9)]\n [!code-vb[C_SecurityScenarios#9](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#9)]  \n  \n### Configuration  \n The following configuration can be used instead of the code:  \n  \n```  \n<?xml version=\"1.0\" encoding=\"utf-8\"?>  \n<configuration>  \n  <system.serviceModel>  \n    <behaviors>  \n      <serviceBehaviors>  \n        <behavior name=\"ServiceCredentialsBehavior\">  \n          <serviceCredentials>  \n            <serviceCertificate findValue=\"Contoso.com\"   \n                                storeLocation=\"LocalMachine\"  \n                                storeName=\"My\"     \n                                x509FindType=\"FindBySubjectName\" />  \n          </serviceCredentials>  \n        </behavior>  \n      </serviceBehaviors>  \n    </behaviors>  \n    <services>  \n      <service behaviorConfiguration=\"ServiceCredentialsBehavior\"  \n               name=\"ServiceModel.Calculator\">  \n        <endpoint address=\"http://localhost/Calculator\"  \n                  binding=\"wsHttpBinding\"  \n                  bindingConfiguration=\"MessageAndUserName\"  \n                  name=\"SecuredByTransportEndpoint\"  \n                  contract=\"ServiceModel.ICalculator\" />  \n      </service>  \n    </services>  \n    <bindings>  \n      <wsHttpBinding>  \n        <binding name=\"MessageAndUserName\">  \n          <security mode=\"Message\">              \n            <message clientCredentialType=\"UserName\" />  \n          </security>  \n        </binding>  \n      </wsHttpBinding>  \n    </bindings>  \n    <client />  \n  </system.serviceModel>  \n</configuration>  \n```  \n  \n## Client  \n  \n### Code  \n The following code creates the client. The binding is to message mode security, and the client credential type is set to `UserName`. The user name and password can only be specified using code (it is not configurable). The code to return the user name and password is not shown here because it must be done at the application level. For example, use a Windows Forms dialog box to query the user for the data.  \n  \n [!code-csharp[C_SecurityScenarios#16](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#16)]\n [!code-vb[C_SecurityScenarios#16](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#16)]  \n  \n### Configuration  \n The following code configures the client. The binding is to message mode security, and the client credential type is set to `UserName`. The user name and password can only be specified using code (it is not configurable).  \n  \n```  \n<?xml version=\"1.0\" encoding=\"utf-8\"?>  \n<configuration>  \n  <system.serviceModel>  \n    <bindings>  \n      <wsHttpBinding>  \n        <binding name=\"WSHttpBinding_ICalculator\" >  \n          <security mode=\"Message\">  \n            <message clientCredentialType=\"UserName\" />  \n          </security>  \n        </binding>  \n      </wsHttpBinding>  \n    </bindings>  \n    <client>  \n      <endpoint address=\"http://machineName/Calculator\"   \n                binding=\"wsHttpBinding\"  \n                bindingConfiguration=\"WSHttpBinding_ICalculator\"   \n                contract=\"ICalculator\"  \n                name=\"WSHttpBinding_ICalculator\">  \n        <identity>  \n          <dns value =\"Contoso.com\" />  \n        </identity>  \n      </endpoint>  \n    </client>  \n  </system.serviceModel>  \n</configuration>  \n```  \n  \n## See Also  \n [Security Overview](../../../../docs/framework/wcf/feature-details/security-overview.md)   \n [Message Security User Name](../../../../docs/framework/wcf/samples/message-security-user-name.md)   \n [Service Identity and Authentication](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md)   \n [\\<identity>](../../../../docs/framework/configure-apps/file-schema/wcf/identity.md)   \n [Security Model for Windows Server App Fabric](http://go.microsoft.com/fwlink/?LinkID=201279&clcid=0x409)","nodes":[{"pos":[4,372],"embed":true,"restype":"x-metadata","content":"title: \"Message Security with a User Name Client | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 36335cb9-76b8-4443-92c7-44f081eabb21\ncaps.latest.revision: 15\nauthor: \"BrucePerlerMS\"\nms.author: \"bruceper\"\nmanager: \"mbaldwin\"","nodes":[{"content":"Message Security with a User Name Client | Microsoft Docs","nodes":[{"pos":[0,57],"content":"Message Security with a User Name Client | Microsoft Docs","nodes":[{"content":"Message Security with a User Name Client | Microsoft Docs","pos":[0,57]}]}],"path":["title"]}],"yml":true},{"pos":[379,419],"content":"Message Security with a User Name Client","linkify":"Message Security with a User Name Client","nodes":[{"content":"Message Security with a User Name Client","pos":[0,40]}]},{"content":"The following illustration shows an <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> service and client secured using message-level security.","pos":[420,568],"source":"The following illustration shows an [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] service and client secured using message-level security."},{"content":"The service is authenticated with an X.509 certificate.","pos":[569,624]},{"content":"The client authenticates using a user name and password.","pos":[625,681]},{"pos":[688,817],"content":"For a sample application, see <bpt id=\"p1\">[</bpt>Message Security User Name<ept id=\"p1\">](../../../../docs/framework/wcf/samples/message-security-user-name.md)</ept>.","source":"For a sample application, see [Message Security User Name](../../../../docs/framework/wcf/samples/message-security-user-name.md)."},{"pos":[824,1007],"content":"<bpt id=\"p1\">![</bpt>Message security using username authentication<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wcf/feature-details/media/1fb10a61-7e1d-42f5-b1af-195bfee5b3c6.gif \"</bpt>1fb10a61-7e1d-42f5-b1af-195bfee5b3c6<ept id=\"p2\">\")</ept>","source":"![Message security using username authentication](../../../../docs/framework/wcf/feature-details/media/1fb10a61-7e1d-42f5-b1af-195bfee5b3c6.gif \"1fb10a61-7e1d-42f5-b1af-195bfee5b3c6\")"},{"content":"Characteristic","pos":[1014,1028]},{"content":"Description","pos":[1029,1040]},{"content":"Security Mode","pos":[1088,1101]},{"content":"Message","pos":[1102,1109]},{"content":"Interoperability","pos":[1114,1130]},{"pos":[1131,1191],"content":"<ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> only","source":"[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] only"},{"content":"Authentication (Server)","pos":[1196,1219]},{"content":"Initial negotiation requires server authentication","pos":[1220,1270]},{"content":"Authentication (Client)","pos":[1275,1298]},{"content":"User name/password","pos":[1299,1317]},{"content":"Integrity","pos":[1322,1331]},{"content":"Yes, using shared security context","pos":[1332,1366]},{"content":"Confidentiality","pos":[1371,1386]},{"content":"Yes, using shared security context","pos":[1387,1421]},{"content":"Transport","pos":[1426,1435]},{"content":"HTTP","pos":[1436,1440]},{"content":"Binding","pos":[1445,1452]},{"pos":[1503,1510],"content":"Service","linkify":"Service","nodes":[{"content":"Service","pos":[0,7]}]},{"content":"The following code and configuration are meant to run independently.","pos":[1514,1582]},{"content":"Do one of the following:","pos":[1583,1607]},{"content":"Create a stand-alone service using the code with no configuration.","pos":[1617,1683]},{"content":"Create a service using the supplied configuration, but do not define any endpoints.","pos":[1693,1776]},{"pos":[1786,1790],"content":"Code","linkify":"Code","nodes":[{"content":"Code","pos":[0,4]}]},{"content":"The following code shows how to create a service endpoint that uses message security.","pos":[1794,1879]},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_SecurityScenarios#9<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#9)</ept><ept id=\"p1\">]</ept>","pos":[1886,2011],"source":"[!code-csharp[C_SecurityScenarios#9](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#9)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>C_SecurityScenarios#9<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#9)</ept><ept id=\"p1\">]</ept>","pos":[2013,2139],"source":"[!code-vb[C_SecurityScenarios#9](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#9)]"},{"pos":[2149,2162],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"content":"The following configuration can be used instead of the code:","pos":[2166,2226]},{"pos":[3609,3615],"content":"Client","linkify":"Client","nodes":[{"content":"Client","pos":[0,6]}]},{"pos":[3625,3629],"content":"Code","linkify":"Code","nodes":[{"content":"Code","pos":[0,4]}]},{"content":"The following code creates the client.","pos":[3633,3671]},{"content":"The binding is to message mode security, and the client credential type is set to <ph id=\"ph1\">`UserName`</ph>.","pos":[3672,3765],"source":" The binding is to message mode security, and the client credential type is set to `UserName`."},{"content":"The user name and password can only be specified using code (it is not configurable).","pos":[3766,3851]},{"content":"The code to return the user name and password is not shown here because it must be done at the application level.","pos":[3852,3965]},{"content":"For example, use a Windows Forms dialog box to query the user for the data.","pos":[3966,4041]},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_SecurityScenarios#16<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#16)</ept><ept id=\"p1\">]</ept>","pos":[4048,4175],"source":"[!code-csharp[C_SecurityScenarios#16](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_securityscenarios/cs/source.cs#16)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>C_SecurityScenarios#16<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#16)</ept><ept id=\"p1\">]</ept>","pos":[4177,4305],"source":"[!code-vb[C_SecurityScenarios#16](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securityscenarios/vb/source.vb#16)]"},{"pos":[4315,4328],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"content":"The following code configures the client.","pos":[4332,4373]},{"content":"The binding is to message mode security, and the client credential type is set to <ph id=\"ph1\">`UserName`</ph>.","pos":[4374,4467],"source":" The binding is to message mode security, and the client credential type is set to `UserName`."},{"content":"The user name and password can only be specified using code (it is not configurable).","pos":[4468,4553]},{"pos":[5384,5392],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Security Overview<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/security-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[5396,5485],"source":"[Security Overview](../../../../docs/framework/wcf/feature-details/security-overview.md) "},{"content":"<bpt id=\"p1\">[</bpt>Message Security User Name<ept id=\"p1\">](../../../../docs/framework/wcf/samples/message-security-user-name.md)</ept><ph id=\"ph1\"> </ph>","pos":[5489,5588],"source":"[Message Security User Name](../../../../docs/framework/wcf/samples/message-security-user-name.md) "},{"content":"<bpt id=\"p1\">[</bpt>Service Identity and Authentication<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md)</ept><ph id=\"ph1\"> </ph>","pos":[5592,5717],"source":"[Service Identity and Authentication](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md) "},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>identity&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/identity.md)</ept><ph id=\"ph2\"> </ph>","pos":[5721,5806],"source":"[\\<identity>](../../../../docs/framework/configure-apps/file-schema/wcf/identity.md) "},{"content":"<bpt id=\"p1\">[</bpt>Security Model for Windows Server App Fabric<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=201279&amp;clcid=0x409)</ept>","pos":[5810,5915],"source":"[Security Model for Windows Server App Fabric](http://go.microsoft.com/fwlink/?LinkID=201279&clcid=0x409)"}]}