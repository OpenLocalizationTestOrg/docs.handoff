{"content":"---\ntitle: \"Running Intranet Applications in Full Trust\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"full trust, running intranet applications in\"\n  - \"intranet applications, running in full trust\"\n  - \"running intranet applications in full trust\"\nms.assetid: ee13c0a8-ab02-49f7-b8fb-9eab16c6c4f0\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# Running Intranet Applications in Full Trust\nStarting with the .NET Framework version 3.5 Service Pack 1 (SP1), applications and their library assemblies can be run as full-trust assemblies from a network share. <xref:System.Security.SecurityZone.MyComputer> zone evidence is automatically added to assemblies that are loaded from a share on the intranet. This evidence gives those assemblies the same grant set (which is typically full trust) as the assemblies that reside on the computer. This functionality does not apply to ClickOnce applications or to applications that are designed to run on a host.  \n  \n## Rules for Library Assemblies  \n The following rules apply to assemblies that are loaded by an executable on a network share:  \n  \n-   Library assemblies must reside in the same folder as the executable assembly. Assemblies that reside in a subfolder or are referenced on a different path are not given the full-trust grant set.  \n  \n-   If the executable delay-loads an assembly, it must use the same path that was used to start the executable. For example, if the share \\\\\\\\*network-computer*\\\\*share* is mapped to a drive letter and the executable is run from that path, assemblies that are loaded by the executable by using the network path will not be granted full trust. To delay-load an assembly in the <xref:System.Security.SecurityZone.MyComputer> zone, the executable must use the drive letter path.  \n  \n## Restoring the Former Intranet Policy  \n In earlier versions of the .NET Framework, shared assemblies were granted <xref:System.Security.SecurityZone.Intranet> zone evidence. You had to specify code access security policy to grant full trust to an assembly on a share.  \n  \n This new behavior is the default for intranet assemblies. You can return to the earlier behavior of providing <xref:System.Security.SecurityZone.Intranet> evidence by setting a registry key that applies to all applications on the computer. This process is different for 32-bit and 64-bit computers:  \n  \n-   On 32-bit computers, create a subkey under the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\\.NETFramework key in the system registry. Use the key name LegacyMyComputerZone with a DWORD value of 1.  \n  \n-   On 64-bit computers, create a subkey under the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\\.NETFramework key in the system registry. Use the key name LegacyMyComputerZone with a DWORD value of 1. Create the same subkey under the HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\\\.NETFramework key.  \n  \n## See also\n\n- [Programming with Assemblies](../../../docs/framework/app-domains/programming-with-assemblies.md)\n","nodes":[{"pos":[4,341],"embed":true,"restype":"x-metadata","content":"title: \"Running Intranet Applications in Full Trust\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"full trust, running intranet applications in\"\n  - \"intranet applications, running in full trust\"\n  - \"running intranet applications in full trust\"\nms.assetid: ee13c0a8-ab02-49f7-b8fb-9eab16c6c4f0\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"Running Intranet Applications in Full Trust","nodes":[{"pos":[0,43],"content":"Running Intranet Applications in Full Trust","nodes":[{"content":"Running Intranet Applications in Full Trust","pos":[0,43]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[348,391],"content":"Running Intranet Applications in Full Trust","linkify":"Running Intranet Applications in Full Trust","nodes":[{"content":"Running Intranet Applications in Full Trust","pos":[0,43]}]},{"content":"Starting with the .NET Framework version 3.5 Service Pack 1 (SP1), applications and their library assemblies can be run as full-trust assemblies from a network share.","pos":[392,558]},{"content":"<ph id=\"ph1\">&lt;xref:System.Security.SecurityZone.MyComputer&gt;</ph> zone evidence is automatically added to assemblies that are loaded from a share on the intranet.","pos":[559,702],"source":"<xref:System.Security.SecurityZone.MyComputer> zone evidence is automatically added to assemblies that are loaded from a share on the intranet."},{"content":"This evidence gives those assemblies the same grant set (which is typically full trust) as the assemblies that reside on the computer.","pos":[703,837]},{"content":"This functionality does not apply to ClickOnce applications or to applications that are designed to run on a host.","pos":[838,952]},{"pos":[961,989],"content":"Rules for Library Assemblies","linkify":"Rules for Library Assemblies","nodes":[{"content":"Rules for Library Assemblies","pos":[0,28]}]},{"content":"The following rules apply to assemblies that are loaded by an executable on a network share:","pos":[993,1085]},{"content":"Library assemblies must reside in the same folder as the executable assembly.","pos":[1095,1172]},{"content":"Assemblies that reside in a subfolder or are referenced on a different path are not given the full-trust grant set.","pos":[1173,1288]},{"content":"If the executable delay-loads an assembly, it must use the same path that was used to start the executable.","pos":[1298,1405]},{"content":"For example, if the share <ph id=\"ph1\">\\\\</ph><ph id=\"ph2\">\\\\</ph><bpt id=\"p1\">*</bpt>network-computer<ept id=\"p1\">*</ept><ph id=\"ph3\">\\\\</ph><bpt id=\"p2\">*</bpt>share<ept id=\"p2\">*</ept> is mapped to a drive letter and the executable is run from that path, assemblies that are loaded by the executable by using the network path will not be granted full trust.","pos":[1406,1636],"source":" For example, if the share \\\\\\\\*network-computer*\\\\*share* is mapped to a drive letter and the executable is run from that path, assemblies that are loaded by the executable by using the network path will not be granted full trust."},{"content":"To delay-load an assembly in the <ph id=\"ph1\">&lt;xref:System.Security.SecurityZone.MyComputer&gt;</ph> zone, the executable must use the drive letter path.","pos":[1637,1769],"source":" To delay-load an assembly in the <xref:System.Security.SecurityZone.MyComputer> zone, the executable must use the drive letter path."},{"pos":[1778,1814],"content":"Restoring the Former Intranet Policy","linkify":"Restoring the Former Intranet Policy","nodes":[{"content":"Restoring the Former Intranet Policy","pos":[0,36]}]},{"content":"In earlier versions of the .NET Framework, shared assemblies were granted <ph id=\"ph1\">&lt;xref:System.Security.SecurityZone.Intranet&gt;</ph> zone evidence.","pos":[1818,1951],"source":"In earlier versions of the .NET Framework, shared assemblies were granted <xref:System.Security.SecurityZone.Intranet> zone evidence."},{"content":"You had to specify code access security policy to grant full trust to an assembly on a share.","pos":[1952,2045]},{"content":"This new behavior is the default for intranet assemblies.","pos":[2052,2109]},{"content":"You can return to the earlier behavior of providing <ph id=\"ph1\">&lt;xref:System.Security.SecurityZone.Intranet&gt;</ph> evidence by setting a registry key that applies to all applications on the computer.","pos":[2110,2291],"source":" You can return to the earlier behavior of providing <xref:System.Security.SecurityZone.Intranet> evidence by setting a registry key that applies to all applications on the computer."},{"content":"This process is different for 32-bit and 64-bit computers:","pos":[2292,2350]},{"content":"On 32-bit computers, create a subkey under the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft<ph id=\"ph1\">\\\\</ph>.NETFramework key in the system registry.","pos":[2360,2487],"source":"On 32-bit computers, create a subkey under the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\\.NETFramework key in the system registry."},{"content":"Use the key name LegacyMyComputerZone with a DWORD value of 1.","pos":[2488,2550]},{"content":"On 64-bit computers, create a subkey under the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft<ph id=\"ph1\">\\\\</ph>.NETFramework key in the system registry.","pos":[2560,2687],"source":"On 64-bit computers, create a subkey under the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\\.NETFramework key in the system registry."},{"content":"Use the key name LegacyMyComputerZone with a DWORD value of 1.","pos":[2688,2750]},{"content":"Create the same subkey under the HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft<ph id=\"ph1\">\\\\</ph>.NETFramework key.","pos":[2751,2853],"source":" Create the same subkey under the HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\\\.NETFramework key."},{"pos":[2862,2870],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2874,2971],"content":"<bpt id=\"p1\">[</bpt>Programming with Assemblies<ept id=\"p1\">](../../../docs/framework/app-domains/programming-with-assemblies.md)</ept>","source":"[Programming with Assemblies](../../../docs/framework/app-domains/programming-with-assemblies.md)"}]}