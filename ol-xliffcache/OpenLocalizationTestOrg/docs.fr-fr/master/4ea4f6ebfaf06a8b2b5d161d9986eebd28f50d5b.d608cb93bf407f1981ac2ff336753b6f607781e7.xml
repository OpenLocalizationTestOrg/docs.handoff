{"content":"---\ntitle: \"How to: Read From Text Files in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"extended characters, reading\"\n  - \"reading text files\"\n  - \"reading data, text files\"\n  - \"examples [Visual Basic], reading text files\"\n  - \"text files, reading\"\nms.assetid: 735fe9d7-0f7a-4185-ba02-f35e580ec4b8\ncaps.latest.revision: 27\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Read From Text Files in Visual Basic\nThe <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.ReadAllText%2A> method of the `My.Computer.FileSystem` object allows you to read from a text file. The file encoding can be specified if the contents of the file use an encoding such as ASCII or UTF-8.  \n  \n If you are reading from a file with extended characters, you will need to specify the file encoding.  \n  \n> [!NOTE]\n>  To read a file a single line of text at a time, use the <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileReader%2A> method of the `My.Computer.FileSystem` object. The `OpenTextFileReader` method returns a <xref:System.IO.StreamReader> object. You can use the <xref:System.IO.StreamReader.ReadLine%2A> method of the `StreamReader` object to read a file one line at a time. You can test for the end of the file using the <xref:System.IO.StreamReader.EndOfStream%2A> method of the `StreamReader` object.  \n  \n### To read from a text file  \n  \n-   Use the `ReadAllText` method of the `My.Computer.FileSystem` object to read the contents of a text file into a string, supplying the path. The following example reads the contents of test.txt into a string and then displays it in a message box.  \n  \n     [!code-vb[VbFileIORead#2](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-text-files_1.vb)]  \n  \n### To read from a text file that is encoded  \n  \n-   Use the `ReadAllText` method of the `My.Computer.FileSystem` object to read the contents of a text file into a string, supplying the path and file encoding type. The following example reads the contents of the UTF32 file test.txt into a string and then displays it in a message box.  \n  \n     [!code-vb[VbFileIORead#3](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-text-files_2.vb)]  \n  \n## Robust Programming  \n The following conditions may cause an exception:  \n  \n-   The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (<xref:System.ArgumentException>).  \n  \n-   The path is not valid because it is `Nothing` (<xref:System.ArgumentNullException>).  \n  \n-   The file does not exist (<xref:System.IO.FileNotFoundException>).  \n  \n-   The file is in use by another process or an I/O error occurs (<xref:System.IO.IOException>).  \n  \n-   The path exceeds the system-defined maximum length (<xref:System.IO.PathTooLongException>).  \n  \n-   A file or directory name in the path contains a colon (:) or is in an invalid format (<xref:System.NotSupportedException>).  \n  \n-   There is not enough memory to write the string to buffer (<xref:System.OutOfMemoryException>).  \n  \n-   The user lacks necessary permissions to view the path (<xref:System.Security.SecurityException>).  \n  \n Do not make decisions about the contents of the file based on the name of the file. For example, the file Form1.vb may not be a [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] source file.  \n  \n Verify all inputs before using the data in your application. The contents of the file may not be what is expected, and methods to read from the file may fail.  \n  \n## See Also  \n <xref:Microsoft.VisualBasic.FileIO.FileSystem>   \n <xref:Microsoft.VisualBasic.FileIO.FileSystem.ReadAllText%2A>   \n [Reading from Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/reading-from-files.md)   \n [How to: Read From Comma-Delimited Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md)   \n [How to: Read From Fixed-width Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md)   \n [How to: Read From Text Files with Multiple Formats](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)   \n [Troubleshooting: Reading from and Writing to Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md)   \n [Walkthrough: Manipulating Files and Directories in Visual Basic](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md)   \n [File Encodings](../../../../visual-basic/developing-apps/programming/drives-directories-files/file-encodings.md)","nodes":[{"pos":[12,73],"content":"How to: Read From Text Files in Visual Basic | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Read From Text Files in Visual Basic | Microsoft Docs","pos":[0,61]}]},{"pos":[735,779],"content":"How to: Read From Text Files in Visual Basic","linkify":"How to: Read From Text Files in Visual Basic","nodes":[{"content":"How to: Read From Text Files in Visual Basic","pos":[0,44]}]},{"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.ReadAllText%2A&gt;</ph> method of the <ph id=\"ph2\">`My.Computer.FileSystem`</ph> object allows you to read from a text file.","pos":[780,937],"source":"The <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.ReadAllText%2A> method of the `My.Computer.FileSystem` object allows you to read from a text file."},{"content":"The file encoding can be specified if the contents of the file use an encoding such as ASCII or UTF-8.","pos":[938,1040]},{"content":"If you are reading from a file with extended characters, you will need to specify the file encoding.","pos":[1047,1147]},{"pos":[1155,1684],"content":"[!NOTE]\n To read a file a single line of text at a time, use the <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileReader%2A> method of the `My.Computer.FileSystem` object. The `OpenTextFileReader` method returns a <xref:System.IO.StreamReader> object. You can use the <xref:System.IO.StreamReader.ReadLine%2A> method of the `StreamReader` object to read a file one line at a time. You can test for the end of the file using the <xref:System.IO.StreamReader.EndOfStream%2A> method of the `StreamReader` object.","leadings":["","> "],"nodes":[{"content":" To read a file a single line of text at a time, use the <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileReader%2A> method of the `My.Computer.FileSystem` object. The `OpenTextFileReader` method returns a <xref:System.IO.StreamReader> object. You can use the <xref:System.IO.StreamReader.ReadLine%2A> method of the `StreamReader` object to read a file one line at a time. You can test for the end of the file using the <xref:System.IO.StreamReader.EndOfStream%2A> method of the `StreamReader` object.","pos":[8,527],"nodes":[{"content":"To read a file a single line of text at a time, use the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileReader%2A&gt;</ph> method of the <ph id=\"ph2\">`My.Computer.FileSystem`</ph> object.","pos":[1,181],"source":" To read a file a single line of text at a time, use the <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileReader%2A> method of the `My.Computer.FileSystem` object."},{"content":"The <ph id=\"ph1\">`OpenTextFileReader`</ph> method returns a <ph id=\"ph2\">&lt;xref:System.IO.StreamReader&gt;</ph> object.","pos":[182,261],"source":" The `OpenTextFileReader` method returns a <xref:System.IO.StreamReader> object."},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.IO.StreamReader.ReadLine%2A&gt;</ph> method of the <ph id=\"ph2\">`StreamReader`</ph> object to read a file one line at a time.","pos":[262,390],"source":" You can use the <xref:System.IO.StreamReader.ReadLine%2A> method of the `StreamReader` object to read a file one line at a time."},{"content":"You can test for the end of the file using the <ph id=\"ph1\">&lt;xref:System.IO.StreamReader.EndOfStream%2A&gt;</ph> method of the <ph id=\"ph2\">`StreamReader`</ph> object.","pos":[391,519],"source":" You can test for the end of the file using the <xref:System.IO.StreamReader.EndOfStream%2A> method of the `StreamReader` object."}]}]},{"pos":[1694,1718],"content":"To read from a text file","linkify":"To read from a text file","nodes":[{"content":"To read from a text file","pos":[0,24]}]},{"content":"Use the <ph id=\"ph1\">`ReadAllText`</ph> method of the <ph id=\"ph2\">`My.Computer.FileSystem`</ph> object to read the contents of a text file into a string, supplying the path.","pos":[1728,1866],"source":"Use the `ReadAllText` method of the `My.Computer.FileSystem` object to read the contents of a text file into a string, supplying the path."},{"content":"The following example reads the contents of test.txt into a string and then displays it in a message box.","pos":[1867,1972]},{"pos":[1983,2145],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbFileIORead#2<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-text-files_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbFileIORead#2](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-text-files_1.vb)]"},{"pos":[2155,2195],"content":"To read from a text file that is encoded","linkify":"To read from a text file that is encoded","nodes":[{"content":"To read from a text file that is encoded","pos":[0,40]}]},{"content":"Use the <ph id=\"ph1\">`ReadAllText`</ph> method of the <ph id=\"ph2\">`My.Computer.FileSystem`</ph> object to read the contents of a text file into a string, supplying the path and file encoding type.","pos":[2205,2366],"source":"Use the `ReadAllText` method of the `My.Computer.FileSystem` object to read the contents of a text file into a string, supplying the path and file encoding type."},{"content":"The following example reads the contents of the UTF32 file test.txt into a string and then displays it in a message box.","pos":[2367,2487]},{"pos":[2498,2660],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbFileIORead#3<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-text-files_2.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbFileIORead#3](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-text-files_2.vb)]"},{"pos":[2669,2687],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"The following conditions may cause an exception:","pos":[2691,2739]},{"content":"The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (<ph id=\"ph1\">&lt;xref:System.ArgumentException&gt;</ph>).","pos":[2749,2952],"source":"The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (<xref:System.ArgumentException>)."},{"pos":[2962,3046],"content":"The path is not valid because it is <ph id=\"ph1\">`Nothing`</ph> (<ph id=\"ph2\">&lt;xref:System.ArgumentNullException&gt;</ph>).","source":"The path is not valid because it is `Nothing` (<xref:System.ArgumentNullException>)."},{"content":"The file does not exist (<ph id=\"ph1\">&lt;xref:System.IO.FileNotFoundException&gt;</ph>).","pos":[3056,3121],"source":"The file does not exist (<xref:System.IO.FileNotFoundException>)."},{"content":"The file is in use by another process or an I/O error occurs (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","pos":[3131,3223],"source":"The file is in use by another process or an I/O error occurs (<xref:System.IO.IOException>)."},{"content":"The path exceeds the system-defined maximum length (<ph id=\"ph1\">&lt;xref:System.IO.PathTooLongException&gt;</ph>).","pos":[3233,3324],"source":"The path exceeds the system-defined maximum length (<xref:System.IO.PathTooLongException>)."},{"content":"A file or directory name in the path contains a colon (:) or is in an invalid format (<ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph>).","pos":[3334,3457],"source":"A file or directory name in the path contains a colon (:) or is in an invalid format (<xref:System.NotSupportedException>)."},{"content":"There is not enough memory to write the string to buffer (<ph id=\"ph1\">&lt;xref:System.OutOfMemoryException&gt;</ph>).","pos":[3467,3561],"source":"There is not enough memory to write the string to buffer (<xref:System.OutOfMemoryException>)."},{"content":"The user lacks necessary permissions to view the path (<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","pos":[3571,3668],"source":"The user lacks necessary permissions to view the path (<xref:System.Security.SecurityException>)."},{"content":"Do not make decisions about the contents of the file based on the name of the file.","pos":[3675,3758]},{"content":"For example, the file Form1.vb may not be a <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> source file.","pos":[3759,3908],"source":" For example, the file Form1.vb may not be a [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] source file."},{"content":"Verify all inputs before using the data in your application.","pos":[3915,3975]},{"content":"The contents of the file may not be what is expected, and methods to read from the file may fail.","pos":[3976,4073]},{"pos":[4082,4090],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.FileSystem&gt;</ph>","pos":[4094,4140],"source":"<xref:Microsoft.VisualBasic.FileIO.FileSystem> "},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.FileSystem.ReadAllText%2A&gt;</ph>","pos":[4145,4206],"source":" <xref:Microsoft.VisualBasic.FileIO.FileSystem.ReadAllText%2A> "},{"content":"<bpt id=\"p1\"> [</bpt>Reading from Files<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/reading-from-files.md)</ept><ph id=\"ph1\"> </ph>","pos":[4210,4333],"source":" [Reading from Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/reading-from-files.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Read From Comma-Delimited Text Files<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md)</ept><ph id=\"ph1\"> </ph>","pos":[4336,4510],"source":" [How to: Read From Comma-Delimited Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Read From Fixed-width Text Files<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md)</ept><ph id=\"ph1\"> </ph>","pos":[4513,4679],"source":" [How to: Read From Fixed-width Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Read From Text Files with Multiple Formats<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)</ept><ph id=\"ph1\"> </ph>","pos":[4682,4868],"source":" [How to: Read From Text Files with Multiple Formats](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Troubleshooting: Reading from and Writing to Text Files<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md)</ept><ph id=\"ph1\"> </ph>","pos":[4871,5067],"source":" [Troubleshooting: Reading from and Writing to Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Walkthrough: Manipulating Files and Directories in Visual Basic<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md)</ept><ph id=\"ph1\"> </ph>","pos":[5070,5266],"source":" [Walkthrough: Manipulating Files and Directories in Visual Basic](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md) "},{"content":"<bpt id=\"p1\"> [</bpt>File Encodings<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/file-encodings.md)</ept>","pos":[5269,5383],"source":" [File Encodings](../../../../visual-basic/developing-apps/programming/drives-directories-files/file-encodings.md)"}]}