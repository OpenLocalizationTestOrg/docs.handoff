{"content":"---\ntitle: \"UI Automation Threading Issues | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"UI Automation, threading issues\"\n  - \"threading issues with UI Automation\"\nms.assetid: 0ab8d42c-5b8b-481b-b788-2caecc2f0191\ncaps.latest.revision: 9\nauthor: \"Xansky\"\nms.author: \"mhopkins\"\nmanager: \"markl\"\n---\n# UI Automation Threading Issues\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n Because of the way [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] uses Windows messages, conflicts can occur when a client application attempts to interact with its own [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] on the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] thread. These conflicts can lead to very slow performance or even cause the application to stop responding.  \n  \n If your client application is intended to interact with all elements on the desktop, including its own [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], you should make all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls on a separate thread. This includes locating elements (for example, by using <xref:System.Windows.Automation.TreeWalker> or the <xref:System.Windows.Automation.AutomationElement.FindAll%2A> method) and using control patterns.  \n  \n It is safe to make [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls within a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] event handler, because the event handler is always called on a non-[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] thread. However, when subscribing to events that may originate from your client application's [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], you must make the call to <xref:System.Windows.Automation.Automation.AddAutomationEventHandler%2A>, or a related method, on a non-[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] thread. Remove event handlers on the same thread.","nodes":[{"pos":[12,59],"content":"UI Automation Threading Issues | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"UI Automation Threading Issues | Microsoft Docs","pos":[0,47]}]},{"pos":[460,490],"content":"UI Automation Threading Issues","linkify":"UI Automation Threading Issues","nodes":[{"content":"UI Automation Threading Issues","pos":[0,30]}]},{"pos":[493,955],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":" This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","pos":[8,460],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[1,241],"source":" This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[242,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"content":"Because of the way <ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> uses Windows messages, conflicts can occur when a client application attempts to interact with its own <ph id=\"ph2\">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]</ph> on the <ph id=\"ph3\">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]</ph> thread.","pos":[962,1311],"source":"Because of the way [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] uses Windows messages, conflicts can occur when a client application attempts to interact with its own [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] on the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] thread."},{"content":"These conflicts can lead to very slow performance or even cause the application to stop responding.","pos":[1312,1411]},{"content":"If your client application is intended to interact with all elements on the desktop, including its own <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]</ph>, you should make all <ph id=\"ph2\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> calls on a separate thread.","pos":[1418,1719],"source":"If your client application is intended to interact with all elements on the desktop, including its own [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], you should make all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls on a separate thread."},{"content":"This includes locating elements (for example, by using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TreeWalker&gt;</ph> or the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.FindAll%2A&gt;</ph> method) and using control patterns.","pos":[1720,1923],"source":" This includes locating elements (for example, by using <xref:System.Windows.Automation.TreeWalker> or the <xref:System.Windows.Automation.AutomationElement.FindAll%2A> method) and using control patterns."},{"content":"It is safe to make <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> calls within a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> event handler, because the event handler is always called on a non-<ph id=\"ph3\">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]</ph> thread.","pos":[1930,2273],"source":"It is safe to make [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls within a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] event handler, because the event handler is always called on a non-[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] thread."},{"content":"However, when subscribing to events that may originate from your client application's <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]</ph>, you must make the call to <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Automation.AddAutomationEventHandler%2A&gt;</ph>, or a related method, on a non-<ph id=\"ph3\">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]</ph> thread.","pos":[2274,2628],"source":" However, when subscribing to events that may originate from your client application's [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], you must make the call to <xref:System.Windows.Automation.Automation.AddAutomationEventHandler%2A>, or a related method, on a non-[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] thread."},{"content":"Remove event handlers on the same thread.","pos":[2629,2670]}]}