{"content":"---\ntitle: \"Type of '<variablename>' is ambiguous because the loop bounds and the step variable do not widen to the same type\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vbc30983\"\n  - \"bc30983\"\nhelpviewer_keywords: \n  - \"BC30983\"\nms.assetid: 6b97153c-dee3-4429-b92a-2e5a212c864b\n---\n# Type of '\\<variablename>' is ambiguous because the loop bounds and the step variable do not widen to the same type\nYour code contains a `For...Next` loop in which the compiler cannot infer a data type for the loop control variable because the following conditions is true:  \n  \n-   The data type of the loop control variable is not specified with an `As` clause.  \n  \n-   The loop bounds and step variable contain at least two data types.  \n  \n-   More than one possible conversion exists between the data types.  \n  \n-   There is no best type among the candidates, so that the choice of type for the loop control variable is ambiguous.  \n  \n For example, the following loop has one loop bound of type `Integer` and one loop bound of type `UInteger`:  \n  \n```vb  \nDim m As Integer = 1  \nDim n As UInteger = 10  \n' Not valid.  \n' For i = m To n  \n    ' Loop processing.  \n' Next  \n```  \n  \n There is a possible conversion between `Integer` and `UInteger`, and a possible conversion between `UInteger` and `Integer`, but both are narrowing conversions so neither is the best choice.  \n  \n In the next example, a third variable of type `Double` is added. Both `Integer` and `UInteger` have standard widening conversions to `Double`, which makes conversion to `Double` the best choice. Type inference assigns to loop control variable `i` the data type `Double`.  \n  \n```vb  \nDim stepVar As Double = 1  \n' Valid.  \nFor i = m To n Step stepVar  \n    ' Loop processing.  \nNext  \n```  \n  \n **Error ID:** BC30983  \n  \n## To correct this error  \n  \n-   Explicitly convert one of the variables to a type that the others have a widening conversion to, for example:  \n  \n    ```  \n    For i = m To CLng(n)  \n    ```  \n  \n-   Use an `As` clause to specify the type of the control variable:  \n  \n    ```  \n    For i As Double = m To n   \n    ```  \n  \n## See also\n\n- [For...Next Statement](../../visual-basic/language-reference/statements/for-next-statement.md)\n- [Implicit and Explicit Conversions](../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)\n- [Local Type Inference](../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)\n- [Option Infer Statement](../../visual-basic/language-reference/statements/option-infer-statement.md)\n- [Widening and Narrowing Conversions](../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)\n","nodes":[{"pos":[4,274],"embed":true,"restype":"x-metadata","content":"title: \"Type of '<variablename>' is ambiguous because the loop bounds and the step variable do not widen to the same type\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vbc30983\"\n  - \"bc30983\"\nhelpviewer_keywords: \n  - \"BC30983\"\nms.assetid: 6b97153c-dee3-4429-b92a-2e5a212c864b","nodes":[{"content":"Type of '<variablename>' is ambiguous because the loop bounds and the step variable do not widen to the same type","nodes":[{"pos":[0,113],"content":"Type of '<ph id=\"ph1\">&lt;variablename&gt;</ph>' is ambiguous because the loop bounds and the step variable do not widen to the same type","source":"Type of '<variablename>' is ambiguous because the loop bounds and the step variable do not widen to the same type"}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[281,395],"content":"Type of '\\<variablename>' is ambiguous because the loop bounds and the step variable do not widen to the same type","linkify":"Type of '\\<variablename>' is ambiguous because the loop bounds and the step variable do not widen to the same type","nodes":[{"content":"Type of '<ph id=\"ph1\">\\&lt;</ph>variablename&gt;' is ambiguous because the loop bounds and the step variable do not widen to the same type","pos":[0,114],"source":"Type of '\\<variablename>' is ambiguous because the loop bounds and the step variable do not widen to the same type"}]},{"pos":[396,553],"content":"Your code contains a <ph id=\"ph1\">`For...Next`</ph> loop in which the compiler cannot infer a data type for the loop control variable because the following conditions is true:","source":"Your code contains a `For...Next` loop in which the compiler cannot infer a data type for the loop control variable because the following conditions is true:"},{"pos":[563,643],"content":"The data type of the loop control variable is not specified with an <ph id=\"ph1\">`As`</ph> clause.","source":"The data type of the loop control variable is not specified with an `As` clause."},{"content":"The loop bounds and step variable contain at least two data types.","pos":[653,719]},{"content":"More than one possible conversion exists between the data types.","pos":[729,793]},{"content":"There is no best type among the candidates, so that the choice of type for the loop control variable is ambiguous.","pos":[803,917]},{"pos":[924,1031],"content":"For example, the following loop has one loop bound of type <ph id=\"ph1\">`Integer`</ph> and one loop bound of type <ph id=\"ph2\">`UInteger`</ph>:","source":"For example, the following loop has one loop bound of type `Integer` and one loop bound of type `UInteger`:"},{"pos":[1171,1361],"content":"There is a possible conversion between <ph id=\"ph1\">`Integer`</ph> and <ph id=\"ph2\">`UInteger`</ph>, and a possible conversion between <ph id=\"ph3\">`UInteger`</ph> and <ph id=\"ph4\">`Integer`</ph>, but both are narrowing conversions so neither is the best choice.","source":"There is a possible conversion between `Integer` and `UInteger`, and a possible conversion between `UInteger` and `Integer`, but both are narrowing conversions so neither is the best choice."},{"content":"In the next example, a third variable of type <ph id=\"ph1\">`Double`</ph> is added.","pos":[1368,1432],"source":"In the next example, a third variable of type `Double` is added."},{"content":"Both <ph id=\"ph1\">`Integer`</ph> and <ph id=\"ph2\">`UInteger`</ph> have standard widening conversions to <ph id=\"ph3\">`Double`</ph>, which makes conversion to <ph id=\"ph4\">`Double`</ph> the best choice.","pos":[1433,1562],"source":" Both `Integer` and `UInteger` have standard widening conversions to `Double`, which makes conversion to `Double` the best choice."},{"content":"Type inference assigns to loop control variable <ph id=\"ph1\">`i`</ph> the data type <ph id=\"ph2\">`Double`</ph>.","pos":[1563,1638],"source":" Type inference assigns to loop control variable `i` the data type `Double`."},{"pos":[1763,1784],"content":"<bpt id=\"p1\">**</bpt>Error ID:<ept id=\"p1\">**</ept> BC30983","source":"**Error ID:** BC30983"},{"pos":[1793,1814],"content":"To correct this error","linkify":"To correct this error","nodes":[{"content":"To correct this error","pos":[0,21]}]},{"content":"Explicitly convert one of the variables to a type that the others have a widening conversion to, for example:","pos":[1824,1933]},{"pos":[1993,2056],"content":"Use an <ph id=\"ph1\">`As`</ph> clause to specify the type of the control variable:","source":"Use an `As` clause to specify the type of the control variable:"},{"pos":[2120,2128],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2132,2226],"content":"<bpt id=\"p1\">[</bpt>For...Next Statement<ept id=\"p1\">](../../visual-basic/language-reference/statements/for-next-statement.md)</ept>","source":"[For...Next Statement](../../visual-basic/language-reference/statements/for-next-statement.md)"},{"pos":[2229,2368],"content":"<bpt id=\"p1\">[</bpt>Implicit and Explicit Conversions<ept id=\"p1\">](../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)</ept>","source":"[Implicit and Explicit Conversions](../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)"},{"pos":[2371,2483],"content":"<bpt id=\"p1\">[</bpt>Local Type Inference<ept id=\"p1\">](../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)</ept>","source":"[Local Type Inference](../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)"},{"pos":[2486,2586],"content":"<bpt id=\"p1\">[</bpt>Option Infer Statement<ept id=\"p1\">](../../visual-basic/language-reference/statements/option-infer-statement.md)</ept>","source":"[Option Infer Statement](../../visual-basic/language-reference/statements/option-infer-statement.md)"},{"pos":[2589,2730],"content":"<bpt id=\"p1\">[</bpt>Widening and Narrowing Conversions<ept id=\"p1\">](../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)</ept>","source":"[Widening and Narrowing Conversions](../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)"}]}