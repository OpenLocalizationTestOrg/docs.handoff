{"content":"---\ntitle: \"How to: Set Up a Signature Confirmation | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"signature confirmation\"\n  - \"WCF, security\"\nms.assetid: 2424c137-c7c2-4aa9-8d5d-a066e12fefda\ncaps.latest.revision: 11\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Set Up a Signature Confirmation\n*Signature confirmation* is a mechanism for a message initiator to ensure that a received reply was generated in response to the sender's original message. Signature confirmation is defined in the WS-Security 1.1 specification. If an endpoint supports WS-Security 1.0, you cannot use signature confirmation.  \n  \n The following procedures specify how to enable signature confirmation using an <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>. You can use the same procedure with a <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement>. The procedure builds upon the basic steps found in [How to: Create a Custom Binding Using the SecurityBindingElement](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-binding-using-the-securitybindingelement.md).  \n  \n### To enable signature confirmation in code  \n  \n1.  Create an instance of the <xref:System.ServiceModel.Channels.BindingElementCollection> class.  \n  \n2.  Create an instance of the  <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> class.  \n  \n3.  Set the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement.RequireSignatureConfirmation%2A> to `true`.  \n  \n4.  Add the security element to the binding collection.  \n  \n5.  Create a custom binding, as specified in [How to: Create a Custom Binding Using the SecurityBindingElement](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-binding-using-the-securitybindingelement.md).  \n  \n### To enable signature confirmation in configuration  \n  \n1.  Add a `<customBinding>` element to the `<bindings>` section of the configuration file.  \n  \n2.  Add a `<binding>` element and set the name attribute to an appropriate value.  \n  \n3.  Add an appropriate encoding element. The following example adds a `<TextMessageEncoding>` element.  \n  \n4.  Add a `<security>` child element and set the `requireSignatureConfirmation` attribute to `true`.  \n  \n5.  Optional. To enable signature confirmation during the bootstrap, add a [\\<secureConversationBootstrap>](../../../../docs/framework/configure-apps/file-schema/wcf/secureconversationbootstrap.md) child element and set the `equireSignatureConfirmation` attribute to `true`.  \n  \n6.  Add an appropriate transport element. The following example adds an [\\<httpTransport>](../../../../docs/framework/configure-apps/file-schema/wcf/httptransport.md):  \n  \n    ```  \n    <bindings>  \n      <customBinding>  \n        <binding name=\"SignatureConfirmationBinding\">  \n          <security requireSignatureConfirmation=\"true\">  \n            <secureConversationBootstrap requireSignatureConfirmation=\"true\" />  \n              </security>  \n           <textMessageEncoding />  \n             <httpTransport />  \n        </binding>  \n      </customBinding>  \n    </bindings>  \n    ```  \n  \n## Example  \n The following code creates an instance of the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> and sets the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement.RequireSignatureConfirmation%2A> property to `true`. Note that this example does not use the `<secureConversationBootstrap>` element shown in the preceding example. This example demonstrates signature confirmation when using a Windows (Kerberos protocol) token. In this case, the signature of the client is returned in all responses from the service and is confirmed by the client.  \n  \n [!code-csharp[c_SignatureConfirmation#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_signatureconfirmation/cs/source.cs#1)]\n [!code-vb[c_SignatureConfirmation#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_signatureconfirmation/vb/source.vb#1)]  \n  \n## See Also  \n <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement>   \n <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>   \n <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateMutualCertificateBindingElement%2A>   \n [How to: Create a Custom Binding Using the SecurityBindingElement](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-binding-using-the-securitybindingelement.md)   \n [How to: Create a SecurityBindingElement for a Specified Authentication Mode](../../../../docs/framework/wcf/feature-details/how-to-create-a-securitybindingelement-for-a-specified-authentication-mode.md)","nodes":[{"pos":[4,431],"embed":true,"restype":"x-metadata","content":"title: \"How to: Set Up a Signature Confirmation | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"signature confirmation\"\n  - \"WCF, security\"\nms.assetid: 2424c137-c7c2-4aa9-8d5d-a066e12fefda\ncaps.latest.revision: 11\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","nodes":[{"content":"How to: Set Up a Signature Confirmation | Microsoft Docs","nodes":[{"pos":[0,56],"content":"How to: Set Up a Signature Confirmation | Microsoft Docs","nodes":[{"content":"How to: Set Up a Signature Confirmation | Microsoft Docs","pos":[0,56]}]}],"path":["title"]}],"yml":true},{"pos":[438,477],"content":"How to: Set Up a Signature Confirmation","linkify":"How to: Set Up a Signature Confirmation","nodes":[{"content":"How to: Set Up a Signature Confirmation","pos":[0,39]}]},{"content":"<bpt id=\"p1\">*</bpt>Signature confirmation<ept id=\"p1\">*</ept> is a mechanism for a message initiator to ensure that a received reply was generated in response to the sender's original message.","pos":[478,633],"source":"*Signature confirmation* is a mechanism for a message initiator to ensure that a received reply was generated in response to the sender's original message."},{"content":"Signature confirmation is defined in the WS-Security 1.1 specification.","pos":[634,705]},{"content":"If an endpoint supports WS-Security 1.0, you cannot use signature confirmation.","pos":[706,785]},{"content":"The following procedures specify how to enable signature confirmation using an <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement&gt;</ph>.","pos":[792,940],"source":"The following procedures specify how to enable signature confirmation using an <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>."},{"content":"You can use the same procedure with a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement&gt;</ph>.","pos":[941,1047],"source":" You can use the same procedure with a <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement>."},{"content":"The procedure builds upon the basic steps found in <bpt id=\"p1\">[</bpt>How to: Create a Custom Binding Using the SecurityBindingElement<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-binding-using-the-securitybindingelement.md)</ept>.","pos":[1048,1281],"source":" The procedure builds upon the basic steps found in [How to: Create a Custom Binding Using the SecurityBindingElement](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-binding-using-the-securitybindingelement.md)."},{"pos":[1291,1331],"content":"To enable signature confirmation in code","linkify":"To enable signature confirmation in code","nodes":[{"content":"To enable signature confirmation in code","pos":[0,40]}]},{"content":"Create an instance of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.BindingElementCollection&gt;</ph> class.","pos":[1341,1434],"source":"Create an instance of the <xref:System.ServiceModel.Channels.BindingElementCollection> class."},{"content":"Create an instance of the  <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement&gt;</ph> class.","pos":[1444,1545],"source":"Create an instance of the  <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> class."},{"pos":[1555,1673],"content":"Set the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement.RequireSignatureConfirmation%2A&gt;</ph> to <ph id=\"ph2\">`true`</ph>.","source":"Set the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement.RequireSignatureConfirmation%2A> to `true`."},{"content":"Add the security element to the binding collection.","pos":[1683,1734]},{"pos":[1744,1967],"content":"Create a custom binding, as specified in <bpt id=\"p1\">[</bpt>How to: Create a Custom Binding Using the SecurityBindingElement<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-binding-using-the-securitybindingelement.md)</ept>.","source":"Create a custom binding, as specified in [How to: Create a Custom Binding Using the SecurityBindingElement](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-binding-using-the-securitybindingelement.md)."},{"pos":[1977,2026],"content":"To enable signature confirmation in configuration","linkify":"To enable signature confirmation in configuration","nodes":[{"content":"To enable signature confirmation in configuration","pos":[0,49]}]},{"pos":[2036,2122],"content":"Add a <ph id=\"ph1\">`&lt;customBinding&gt;`</ph> element to the <ph id=\"ph2\">`&lt;bindings&gt;`</ph> section of the configuration file.","source":"Add a `<customBinding>` element to the `<bindings>` section of the configuration file."},{"pos":[2132,2209],"content":"Add a <ph id=\"ph1\">`&lt;binding&gt;`</ph> element and set the name attribute to an appropriate value.","source":"Add a `<binding>` element and set the name attribute to an appropriate value."},{"content":"Add an appropriate encoding element.","pos":[2219,2255]},{"content":"The following example adds a <ph id=\"ph1\">`&lt;TextMessageEncoding&gt;`</ph> element.","pos":[2256,2317],"source":" The following example adds a `<TextMessageEncoding>` element."},{"pos":[2327,2423],"content":"Add a <ph id=\"ph1\">`&lt;security&gt;`</ph> child element and set the <ph id=\"ph2\">`requireSignatureConfirmation`</ph> attribute to <ph id=\"ph3\">`true`</ph>.","source":"Add a `<security>` child element and set the `requireSignatureConfirmation` attribute to `true`."},{"content":"Optional.","pos":[2433,2442]},{"content":"To enable signature confirmation during the bootstrap, add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>secureConversationBootstrap&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/secureconversationbootstrap.md)</ept> child element and set the <ph id=\"ph2\">`equireSignatureConfirmation`</ph> attribute to <ph id=\"ph3\">`true`</ph>.","pos":[2443,2703],"source":" To enable signature confirmation during the bootstrap, add a [\\<secureConversationBootstrap>](../../../../docs/framework/configure-apps/file-schema/wcf/secureconversationbootstrap.md) child element and set the `equireSignatureConfirmation` attribute to `true`."},{"content":"Add an appropriate transport element.","pos":[2713,2750]},{"content":"The following example adds an <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>httpTransport&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/httptransport.md)</ept>:","pos":[2751,2876],"source":" The following example adds an [\\<httpTransport>](../../../../docs/framework/configure-apps/file-schema/wcf/httptransport.md):"},{"pos":[3308,3315],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code creates an instance of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement&gt;</ph> and sets the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement.RequireSignatureConfirmation%2A&gt;</ph> property to <ph id=\"ph3\">`true`</ph>.","pos":[3319,3565],"source":"The following code creates an instance of the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> and sets the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement.RequireSignatureConfirmation%2A> property to `true`."},{"content":"Note that this example does not use the <ph id=\"ph1\">`&lt;secureConversationBootstrap&gt;`</ph> element shown in the preceding example.","pos":[3566,3677],"source":" Note that this example does not use the `<secureConversationBootstrap>` element shown in the preceding example."},{"content":"This example demonstrates signature confirmation when using a Windows (Kerberos protocol) token.","pos":[3678,3774]},{"content":"In this case, the signature of the client is returned in all responses from the service and is confirmed by the client.","pos":[3775,3894]},{"pos":[4179,4187],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement&gt;</ph>","pos":[4191,4258],"source":"<xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> "},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement&gt;</ph>","pos":[4263,4331],"source":"<xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement> "},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.SecurityBindingElement.CreateMutualCertificateBindingElement%2A&gt;</ph>","pos":[4336,4435],"source":"<xref:System.ServiceModel.Channels.SecurityBindingElement.CreateMutualCertificateBindingElement%2A> "},{"content":"<bpt id=\"p1\">[</bpt>How to: Create a Custom Binding Using the SecurityBindingElement<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-binding-using-the-securitybindingelement.md)</ept><ph id=\"ph1\"> </ph>","pos":[4440,4622],"source":"[How to: Create a Custom Binding Using the SecurityBindingElement](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-binding-using-the-securitybindingelement.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Create a SecurityBindingElement for a Specified Authentication Mode<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-create-a-securitybindingelement-for-a-specified-authentication-mode.md)</ept>","pos":[4626,4829],"source":"[How to: Create a SecurityBindingElement for a Specified Authentication Mode](../../../../docs/framework/wcf/feature-details/how-to-create-a-securitybindingelement-for-a-specified-authentication-mode.md)"}]}