{"content":"---\ntitle: \"Commanding Overview | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"interfaces, ICommandSource\"\n  - \"classes, CommandBinding\"\n  - \"command library\"\n  - \"commands, definition of\"\n  - \"CommandBindings\"\n  - \"ICommandSource interfaces\"\n  - \"commanding\"\n  - \"CommandManager\"\nms.assetid: bc208dfe-367d-426a-99de-52b7e7511e81\ncaps.latest.revision: 35\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Commanding Overview\n<a name=\"introduction\"></a> Commanding is an input mechanism in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] which provides input handling at a more semantic level than device input. Examples of commands are the **Copy**, **Cut**, and **Paste** operations found on many applications.  \n  \n This overview defines what commands are in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], which classes are part of the commanding model, and how to use and create commands in your applications.  \n  \n This topic contains the following sections:  \n  \n-   [What Are Commands?](#commands_at_10000_feet)  \n  \n-   [Simple Command Example in WPF](#simple_command)  \n  \n-   [Four Main Concepts in WPF Commanding](#Four_main_Concepts)  \n  \n-   [Command Library](#Command_Library)  \n  \n-   [Creating Custom Commands](#creating_commands)  \n  \n<a name=\"commands_at_10000_feet\"></a>   \n## What Are Commands?  \n Commands have several purposes. The first purpose is to separate the semantics and the object that invokes a command from the logic that executes the command. This allows for multiple and disparate sources to invoke the same command logic, and it allows the command logic to be customized for different targets. For example, the editing operations **Copy**, **Cut**, and **Paste**, which are found in many applications, can be invoked by using different user actions if they are implemented by using commands. An application might allow a user to cut selected objects or text by either clicking a button, choosing an item in a menu, or using a key combination, such as CTRL+X. By using commands, you can bind each type of user action to the same logic.  \n  \n Another purpose of commands is to indicate whether an action is available. To continue the example of cutting an object or text, the action only makes sense when something is selected. If a user tries to cut an object or text without having anything selected, nothing would happen. To indicate this to the user, many applications disable buttons and menu items so that the user knows whether it is possible to perform an action. A command can indicate whether an action is possible by implementing the <xref:System.Windows.Input.ICommand.CanExecute%2A> method. A button can subscribe to the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event and be disabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `false` or be enabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `true`.  \n  \n The semantics of a command can be consistent across applications and classes, but the logic of the action is specific to the particular object acted upon. The key combination CTRL+X invokes the **Cut** command in text classes, image classes, and Web browsers, but the actual logic for performing the **Cut** operation is defined by the application that performs the cut. A <xref:System.Windows.Input.RoutedCommand> enables clients to implement the logic. A text object may cut the selected text into the clipboard, while an image object may cut the selected image. When an application handles the <xref:System.Windows.Input.CommandManager.Executed> event, it has access to the target of the command and can take appropriate action depending on the target's type.  \n  \n<a name=\"simple_command\"></a>   \n## Simple Command Example in WPF  \n The simplest way to use a command in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is to use a predefined <xref:System.Windows.Input.RoutedCommand> from one of the command library classes; use a control that has native support for handling the command; and use a control that has native support for invoking a command.  The <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is one of the predefined commands in the <xref:System.Windows.Input.ApplicationCommands> class.  The <xref:System.Windows.Controls.TextBox> control has built in logic for handling the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command.  And the <xref:System.Windows.Controls.MenuItem> class has native support for invoking commands.  \n  \n The following example shows how to set up a <xref:System.Windows.Controls.MenuItem> so that when it is clicked it will invoke the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command on a <xref:System.Windows.Controls.TextBox>, assuming the <xref:System.Windows.Controls.TextBox> has keyboard focus.  \n  \n [!code-xml[CommandingOverviewSnippets#CommandingOverviewSimpleCommand](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewsimplecommand)]  \n  \n [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]\n [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  \n  \n<a name=\"Four_main_Concepts\"></a>   \n## Four Main Concepts in WPF Commanding  \n The routed command model in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can be broken up into four main concepts: the command, the command source, the command target, and the command binding:  \n  \n-   The *command* is the action to be executed.  \n  \n-   The *command source* is the object which invokes the command.  \n  \n-   The *command target* is the object that the command is being executed on.  \n  \n-   The *command binding* is the object which maps the command logic to the command.  \n  \n In the previous example, the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is the command, the <xref:System.Windows.Controls.MenuItem> is the command source, the <xref:System.Windows.Controls.TextBox> is the command target, and the command binding is supplied by the <xref:System.Windows.Controls.TextBox> control.  It is worth noting that it is not always the case that the <xref:System.Windows.Input.CommandBinding> is supplied by the control that is the command target class.  Quite often the <xref:System.Windows.Input.CommandBinding> must be created by the application developer, or the <xref:System.Windows.Input.CommandBinding> might be attached to an ancestor of the command target.  \n  \n<a name=\"Commands\"></a>   \n### Commands  \n Commands in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are created by implementing the <xref:System.Windows.Input.ICommand> interface.  <xref:System.Windows.Input.ICommand> exposes two methods, <xref:System.Windows.Input.ICommand.Execute%2A>, and <xref:System.Windows.Input.ICommand.CanExecute%2A>, and an event, <xref:System.Windows.Input.ICommand.CanExecuteChanged>. <xref:System.Windows.Input.ICommand.Execute%2A> performs the actions that are associated with the command. <xref:System.Windows.Input.ICommand.CanExecute%2A> determines whether the command can execute on the current command target. <xref:System.Windows.Input.ICommand.CanExecuteChanged> is raised if the command manager that centralizes the commanding operations detects a change in the command source that might invalidate a command that has been raised but not yet executed by the command binding.  The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of <xref:System.Windows.Input.ICommand> is the <xref:System.Windows.Input.RoutedCommand> class and is the focus of this overview.  \n  \n The main sources of input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the mouse, the keyboard, ink, and routed commands.  The more device-oriented inputs use a <xref:System.Windows.RoutedEvent> to notify objects in an application page that an input event has occurred.  A <xref:System.Windows.Input.RoutedCommand> is no different.  The <xref:System.Windows.Input.RoutedCommand.Execute%2A> and <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> methods of a <xref:System.Windows.Input.RoutedCommand> do not contain the application logic for the command, but rather they raise routed events that tunnel and bubble through the element tree until they encounter an object with a <xref:System.Windows.Input.CommandBinding>.  The <xref:System.Windows.Input.CommandBinding> contains the handlers for these events and it is the handlers that perform the command.  For more information on event routing in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).  \n  \n The <xref:System.Windows.Input.RoutedCommand.Execute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.PreviewExecuted> and the <xref:System.Windows.Input.CommandManager.Executed> events on the command target.  The <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.CanExecute> and <xref:System.Windows.Input.CommandManager.PreviewCanExecute> events on the command target.  These events tunnel and bubble through the element tree until they encounter an object which has a <xref:System.Windows.Input.CommandBinding> for that particular command.  \n  \n [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] supplies a set of common routed commands spread across several classes: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands>, and <xref:System.Windows.Documents.EditingCommands>.  These classes consist only of the <xref:System.Windows.Input.RoutedCommand> objects and not the implementation logic of the command.  The implementation logic is the responsibility of the object on which the command is being executed on.  \n  \n<a name=\"Command_Sources\"></a>   \n### Command Sources  \n A command source is the object which invokes the command.  Examples of command sources are <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button>, and <xref:System.Windows.Input.KeyGesture>.  \n  \n Command sources in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] generally implement the <xref:System.Windows.Input.ICommandSource> interface.  \n  \n <xref:System.Windows.Input.ICommandSource> exposes three properties: <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, and <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:  \n  \n-   <xref:System.Windows.Input.ICommandSource.Command%2A> is the command to execute when the command source is invoked.  \n  \n-   <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is the object on which to execute the command.  It is worth noting that in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.  If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored. If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is not set, the element with keyboard focus will be the command target.  \n  \n-   <xref:System.Windows.Input.ICommandSource.CommandParameter%2A> is a user-defined data type used to pass information to the handlers implementing the command.  \n  \n The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes that implement <xref:System.Windows.Input.ICommandSource> are <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink>, and <xref:System.Windows.Input.InputBinding>.  <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, and <xref:System.Windows.Documents.Hyperlink> invoke a command when they are clicked, and an <xref:System.Windows.Input.InputBinding> invokes a command when the <xref:System.Windows.Input.InputGesture> associated with it is performed.  \n  \n The following example shows how to use a <xref:System.Windows.Controls.MenuItem> in a <xref:System.Windows.Controls.ContextMenu> as a command source for the <xref:System.Windows.Input.ApplicationCommands.Properties%2A> command.  \n  \n [!code-xml[CommandingOverviewSnippets#CommandingOverviewCmdSourceXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewcmdsourcexaml)]  \n  \n [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCmdSource](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcmdsource)]\n [!code-vb[CommandingOverviewSnippets#CommandingOverviewCmdSource](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcmdsource)]  \n  \n Typically, a command source will listen to the <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> event.  This event informs the command source that the ability of the command to execute on the current command target may have changed.  The command source can query the current status of the <xref:System.Windows.Input.RoutedCommand> by using the <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method.  The command source can then disable itself if the command cannot execute.  An example of this is a <xref:System.Windows.Controls.MenuItem> graying itself out when a command cannot execute.  \n  \n An <xref:System.Windows.Input.InputGesture> can be used as a command source.  Two types of input gestures in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the <xref:System.Windows.Input.KeyGesture> and <xref:System.Windows.Input.MouseGesture>.  You can think of a <xref:System.Windows.Input.KeyGesture> as a keyboard shortcut, such as CTRL+C.  A <xref:System.Windows.Input.KeyGesture> is comprised of a <xref:System.Windows.Input.Key> and a set of <xref:System.Windows.Input.ModifierKeys>.  A <xref:System.Windows.Input.MouseGesture> is comprised of a <xref:System.Windows.Input.MouseAction> and an optional set of <xref:System.Windows.Input.ModifierKeys>.  \n  \n In order for an <xref:System.Windows.Input.InputGesture> to act as a command source, it must be associated with a command. There are a few ways to accomplish this.  One way is to use an <xref:System.Windows.Input.InputBinding>.  \n  \n The following example shows how to create a <xref:System.Windows.Input.KeyBinding> between a <xref:System.Windows.Input.KeyGesture> and a <xref:System.Windows.Input.RoutedCommand>.  \n  \n [!code-xml[CommandingOverviewSnippets#CommandingOverviewXAMLKeyBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlkeybinding)]  \n  \n [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeybinding)]\n [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeybinding)]  \n  \n Another way to associate an <xref:System.Windows.Input.InputGesture> to a <xref:System.Windows.Input.RoutedCommand> is to add the <xref:System.Windows.Input.InputGesture> to the <xref:System.Windows.Input.InputGestureCollection> on the <xref:System.Windows.Input.RoutedCommand>.  \n  \n The following example shows how to add a <xref:System.Windows.Input.KeyGesture> to the <xref:System.Windows.Input.InputGestureCollection> of a <xref:System.Windows.Input.RoutedCommand>.  \n  \n [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeygestureoncmd)]\n [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeygestureoncmd)]  \n  \n<a name=\"Command_Binding\"></a>   \n### CommandBinding  \n A <xref:System.Windows.Input.CommandBinding> associates a command with the event handlers that implement the command.  \n  \n The <xref:System.Windows.Input.CommandBinding> class contains a <xref:System.Windows.Input.CommandBinding.Command%2A> property, and <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute>, and <xref:System.Windows.Input.CommandBinding.CanExecute> events.  \n  \n <xref:System.Windows.Input.CommandBinding.Command%2A> is the command that the <xref:System.Windows.Input.CommandBinding> is being associated with.  The event handlers which are attached to the <xref:System.Windows.Input.CommandBinding.PreviewExecuted> and <xref:System.Windows.Input.CommandBinding.Executed> events implement the command logic.  The event handlers attached to the <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> and <xref:System.Windows.Input.CommandBinding.CanExecute> events determine if the command can execute on the current command target.  \n  \n The following example shows how to create a <xref:System.Windows.Input.CommandBinding> on the root <xref:System.Windows.Window> of an application.  The <xref:System.Windows.Input.CommandBinding> associates the <xref:System.Windows.Input.ApplicationCommands.Open%2A> command with <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandBinding.CanExecute> handlers.  \n  \n [!code-xml[commandwithhandler#CommandHandlerCommandBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml#commandhandlercommandbinding)]  \n  \n [!code-csharp[CommandHandlerProcedural#CommandHandlerBindingInit](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandHandlerProcedural/CSharp/Window1.xaml.cs#commandhandlerbindinginit)]\n [!code-vb[CommandHandlerProcedural#CommandHandlerBindingInit](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandHandlerProcedural/visualbasic/window1.xaml.vb#commandhandlerbindinginit)]  \n  \n Next, the <xref:System.Windows.Input.ExecutedRoutedEventHandler> and a <xref:System.Windows.Input.CanExecuteRoutedEventHandler> are created.  The <xref:System.Windows.Input.ExecutedRoutedEventHandler> opens a <xref:System.Windows.MessageBox> that displays a string saying the command has been executed.  The <xref:System.Windows.Input.CanExecuteRoutedEventHandler> sets the <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> property to `true`.  \n  \n [!code-csharp[commandwithhandler#CommandHandlerExecutedHandler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlerexecutedhandler)]\n [!code-vb[commandwithhandler#CommandHandlerExecutedHandler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlerexecutedhandler)]  \n  \n [!code-csharp[commandwithhandler#CommandHandlerCanExecuteHandler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlercanexecutehandler)]\n [!code-vb[commandwithhandler#CommandHandlerCanExecuteHandler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlercanexecutehandler)]  \n  \n A <xref:System.Windows.Input.CommandBinding> is attached to a specific object, such as the root <xref:System.Windows.Window> of the application or a control.  The object that the <xref:System.Windows.Input.CommandBinding> is attached to defines the scope of the binding.  For example, a <xref:System.Windows.Input.CommandBinding> attached to an ancestor of the command target can be reached by the <xref:System.Windows.Input.CommandBinding.Executed> event, but a <xref:System.Windows.Input.CommandBinding> attached to a descendant of the command target cannot be reached.  This is a direct consequence of the way a <xref:System.Windows.RoutedEvent> tunnels and bubbles from the object that raises the event.  \n  \n In some situations the <xref:System.Windows.Input.CommandBinding> is attached to the command target itself, such as with the <xref:System.Windows.Controls.TextBox> class and the <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, and <xref:System.Windows.Input.ApplicationCommands.Paste%2A> commands. Quite often though, it is more convenient to attach the <xref:System.Windows.Input.CommandBinding> to an ancestor of the command target, such as the main <xref:System.Windows.Window> or the Application object, especially if the same <xref:System.Windows.Input.CommandBinding> can be used for multiple command targets.  These are design decisions you will want to consider when you are creating your commanding infrastructure.  \n  \n<a name=\"Commane_Target\"></a>   \n### Command Target  \n The command target is the element on which the command is executed.  With regards to a <xref:System.Windows.Input.RoutedCommand>, the command target is the element at which routing of the <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandManager.CanExecute> starts.  As noted previously, in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.  If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.  \n  \n The command source can explicitly set the command target.  If the command target is not defined, the element with keyboard focus will be used as the command target.  One of the benefits of using the element with keyboard focus as the command target is that it allows the application developer to use the same command source to invoke a command on multiple targets without having to keep track of the command target.  For example, if a <xref:System.Windows.Controls.MenuItem> invokes the **Paste** command in an application that has a <xref:System.Windows.Controls.TextBox> control and a <xref:System.Windows.Controls.PasswordBox> control, the target can be either the <xref:System.Windows.Controls.TextBox> or <xref:System.Windows.Controls.PasswordBox> depending on which control has keyboard focus.  \n  \n The following example shows how to explicitly set the command target in markup and in code behind.  \n  \n [!code-xml[CommandingOverviewSnippets#CommandingOverviewXAMLCommandTarget](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlcommandtarget)]  \n  \n [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]\n [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  \n  \n<a name=\"Command_Manager\"></a>   \n### The CommandManager  \n The <xref:System.Windows.Input.CommandManager> serves a number of command related functions.  It provides a set of static methods for adding and removing <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute>, and <xref:System.Windows.Input.CommandManager.CanExecute> event handlers to and from a specific element.  It provides a means to register <xref:System.Windows.Input.CommandBinding> and <xref:System.Windows.Input.InputBinding> objects onto a specific class.  The <xref:System.Windows.Input.CommandManager> also provides a means, through the <xref:System.Windows.Input.CommandManager.RequerySuggested> event, to notify a command when it should raise the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event.  \n  \n The <xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> method forces the <xref:System.Windows.Input.CommandManager> to raise the <xref:System.Windows.Input.CommandManager.RequerySuggested> event.  This is useful for conditions that should disable/enable a command but are not conditions that the <xref:System.Windows.Input.CommandManager> is aware of.  \n  \n<a name=\"Command_Library\"></a>   \n## Command Library  \n [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a set of predefined commands.  The command library consists of the following classes: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands>, and the <xref:System.Windows.Input.ComponentCommands>.  These classes provide commands such as <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> and <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A>, and <xref:System.Windows.Input.MediaCommands.Pause%2A>.  \n  \n Many of these commands include a set of default input bindings.  For example, if you specify that your application handles the copy command, you automatically get the keyboard binding \"CTRL+C\" You also get bindings for other input devices, such as [!INCLUDE[TLA2#tla_tpc](../../../../includes/tla2sharptla-tpc-md.md)] pen gestures and speech information.  \n  \n When you reference commands in the various command libraries using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can usually omit the class name of the library class that exposes the static command property. Generally, the command names are unambiguous as strings, and the owning types exist to provide a logical grouping of commands but are not necessary for disambiguation. For instance, you can specify `Command=\"Cut\"` rather than the more verbose `Command=\"ApplicationCommands.Cut\"`. This is a convenience mechanism that is built in to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor for commands (more precisely, it is a type converter behavior of <xref:System.Windows.Input.ICommand>, which the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor references at load time).  \n  \n<a name=\"creating_commands\"></a>   \n## Creating Custom Commands  \n If the commands in the command library classes do not meet your needs, then you can create your own commands.  There are two ways to create a custom command.  The first is to start from the ground up and implement the <xref:System.Windows.Input.ICommand> interface.  The other way, and the more common approach, is to create a <xref:System.Windows.Input.RoutedCommand> or a <xref:System.Windows.Input.RoutedUICommand>.  \n  \n For an example of creating a custom <xref:System.Windows.Input.RoutedCommand>, see [Create a Custom RoutedCommand Sample](http://go.microsoft.com/fwlink/?LinkID=159980).  \n  \n## See Also  \n <xref:System.Windows.Input.RoutedCommand>   \n <xref:System.Windows.Input.CommandBinding>   \n <xref:System.Windows.Input.InputBinding>   \n <xref:System.Windows.Input.CommandManager>   \n [Input Overview](../../../../docs/framework/wpf/advanced/input-overview.md)   \n [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md)   \n [Implement ICommandSource](../../../../docs/framework/wpf/advanced/how-to-implement-icommandsource.md)   \n [How to: Add a Command to a MenuItem](http://msdn.microsoft.com/en-us/013d68a0-5373-4a68-bd91-5de574307370)   \n [Create a Custom RoutedCommand Sample](http://go.microsoft.com/fwlink/?LinkID=159980)","nodes":[{"pos":[12,48],"content":"Commanding Overview | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Commanding Overview | Microsoft Docs","pos":[0,36]}]},{"pos":[585,604],"content":"Commanding Overview","linkify":"Commanding Overview","nodes":[{"content":"Commanding Overview","pos":[0,19]}]},{"content":"<bpt id=\"p1\">&lt;a name=\"introduction\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Commanding is an input mechanism in <ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> which provides input handling at a more semantic level than device input.","pos":[605,822],"source":"<a name=\"introduction\"></a> Commanding is an input mechanism in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] which provides input handling at a more semantic level than device input."},{"content":"Examples of commands are the <bpt id=\"p1\">**</bpt>Copy<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Cut<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>Paste<ept id=\"p3\">**</ept> operations found on many applications.","pos":[823,923],"source":" Examples of commands are the **Copy**, **Cut**, and **Paste** operations found on many applications."},{"pos":[930,1160],"content":"This overview defines what commands are in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>, which classes are part of the commanding model, and how to use and create commands in your applications.","source":"This overview defines what commands are in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], which classes are part of the commanding model, and how to use and create commands in your applications."},{"content":"This topic contains the following sections:","pos":[1167,1210]},{"pos":[1220,1265],"content":"<bpt id=\"p1\">[</bpt>What Are Commands?<ept id=\"p1\">](#commands_at_10000_feet)</ept>","source":"[What Are Commands?](#commands_at_10000_feet)"},{"pos":[1275,1323],"content":"<bpt id=\"p1\">[</bpt>Simple Command Example in WPF<ept id=\"p1\">](#simple_command)</ept>","source":"[Simple Command Example in WPF](#simple_command)"},{"pos":[1333,1392],"content":"<bpt id=\"p1\">[</bpt>Four Main Concepts in WPF Commanding<ept id=\"p1\">](#Four_main_Concepts)</ept>","source":"[Four Main Concepts in WPF Commanding](#Four_main_Concepts)"},{"pos":[1402,1437],"content":"<bpt id=\"p1\">[</bpt>Command Library<ept id=\"p1\">](#Command_Library)</ept>","source":"[Command Library](#Command_Library)"},{"pos":[1447,1493],"content":"<bpt id=\"p1\">[</bpt>Creating Custom Commands<ept id=\"p1\">](#creating_commands)</ept>","source":"[Creating Custom Commands](#creating_commands)"},{"pos":[1543,1561],"content":"What Are Commands?","linkify":"What Are Commands?","nodes":[{"content":"What Are Commands?","pos":[0,18]}]},{"content":"Commands have several purposes.","pos":[1565,1596]},{"content":"The first purpose is to separate the semantics and the object that invokes a command from the logic that executes the command.","pos":[1597,1723]},{"content":"This allows for multiple and disparate sources to invoke the same command logic, and it allows the command logic to be customized for different targets.","pos":[1724,1876]},{"content":"For example, the editing operations <bpt id=\"p1\">**</bpt>Copy<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Cut<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>Paste<ept id=\"p3\">**</ept>, which are found in many applications, can be invoked by using different user actions if they are implemented by using commands.","pos":[1877,2074],"source":" For example, the editing operations **Copy**, **Cut**, and **Paste**, which are found in many applications, can be invoked by using different user actions if they are implemented by using commands."},{"content":"An application might allow a user to cut selected objects or text by either clicking a button, choosing an item in a menu, or using a key combination, such as CTRL+X.","pos":[2075,2241]},{"content":"By using commands, you can bind each type of user action to the same logic.","pos":[2242,2317]},{"content":"Another purpose of commands is to indicate whether an action is available.","pos":[2324,2398]},{"content":"To continue the example of cutting an object or text, the action only makes sense when something is selected.","pos":[2399,2508]},{"content":"If a user tries to cut an object or text without having anything selected, nothing would happen.","pos":[2509,2605]},{"content":"To indicate this to the user, many applications disable buttons and menu items so that the user knows whether it is possible to perform an action.","pos":[2606,2752]},{"content":"A command can indicate whether an action is possible by implementing the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommand.CanExecute%2A&gt;</ph> method.","pos":[2753,2884],"source":" A command can indicate whether an action is possible by implementing the <xref:System.Windows.Input.ICommand.CanExecute%2A> method."},{"content":"A button can subscribe to the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommand.CanExecuteChanged&gt;</ph> event and be disabled if <ph id=\"ph2\">&lt;xref:System.Windows.Input.ICommand.CanExecute%2A&gt;</ph> returns <ph id=\"ph3\">`false`</ph> or be enabled if <ph id=\"ph4\">&lt;xref:System.Windows.Input.ICommand.CanExecute%2A&gt;</ph> returns <ph id=\"ph5\">`true`</ph>.","pos":[2885,3145],"source":" A button can subscribe to the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event and be disabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `false` or be enabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `true`."},{"content":"The semantics of a command can be consistent across applications and classes, but the logic of the action is specific to the particular object acted upon.","pos":[3152,3306]},{"content":"The key combination CTRL+X invokes the <bpt id=\"p1\">**</bpt>Cut<ept id=\"p1\">**</ept> command in text classes, image classes, and Web browsers, but the actual logic for performing the <bpt id=\"p2\">**</bpt>Cut<ept id=\"p2\">**</ept> operation is defined by the application that performs the cut.","pos":[3307,3522],"source":" The key combination CTRL+X invokes the **Cut** command in text classes, image classes, and Web browsers, but the actual logic for performing the **Cut** operation is defined by the application that performs the cut."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> enables clients to implement the logic.","pos":[3523,3606],"source":" A <xref:System.Windows.Input.RoutedCommand> enables clients to implement the logic."},{"content":"A text object may cut the selected text into the clipboard, while an image object may cut the selected image.","pos":[3607,3716]},{"content":"When an application handles the <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandManager.Executed&gt;</ph> event, it has access to the target of the command and can take appropriate action depending on the target's type.","pos":[3717,3914],"source":" When an application handles the <xref:System.Windows.Input.CommandManager.Executed> event, it has access to the target of the command and can take appropriate action depending on the target's type."},{"pos":[3956,3985],"content":"Simple Command Example in WPF","linkify":"Simple Command Example in WPF","nodes":[{"content":"Simple Command Example in WPF","pos":[0,29]}]},{"content":"The simplest way to use a command in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> is to use a predefined <ph id=\"ph2\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> from one of the command library classes; use a control that has native support for handling the command; and use a control that has native support for invoking a command.","pos":[3989,4343],"source":"The simplest way to use a command in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is to use a predefined <xref:System.Windows.Input.RoutedCommand> from one of the command library classes; use a control that has native support for handling the command; and use a control that has native support for invoking a command."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.ApplicationCommands.Paste%2A&gt;</ph> command is one of the predefined commands in the <ph id=\"ph2\">&lt;xref:System.Windows.Input.ApplicationCommands&gt;</ph> class.","pos":[4345,4509],"source":"  The <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is one of the predefined commands in the <xref:System.Windows.Input.ApplicationCommands> class."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> control has built in logic for handling the <ph id=\"ph2\">&lt;xref:System.Windows.Input.ApplicationCommands.Paste%2A&gt;</ph> command.","pos":[4511,4663],"source":"  The <xref:System.Windows.Controls.TextBox> control has built in logic for handling the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command."},{"content":"And the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph> class has native support for invoking commands.","pos":[4665,4760],"source":"  And the <xref:System.Windows.Controls.MenuItem> class has native support for invoking commands."},{"content":"The following example shows how to set up a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph> so that when it is clicked it will invoke the <ph id=\"ph2\">&lt;xref:System.Windows.Input.ApplicationCommands.Paste%2A&gt;</ph> command on a <ph id=\"ph3\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph>, assuming the <ph id=\"ph4\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> has keyboard focus.","pos":[4767,5078],"source":"The following example shows how to set up a <xref:System.Windows.Controls.MenuItem> so that when it is clicked it will invoke the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command on a <xref:System.Windows.Controls.TextBox>, assuming the <xref:System.Windows.Controls.TextBox> has keyboard focus."},{"pos":[5085,5288],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>CommandingOverviewSnippets#CommandingOverviewSimpleCommand<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewsimplecommand)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[CommandingOverviewSnippets#CommandingOverviewSimpleCommand](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewsimplecommand)]"},{"pos":[5295,5761],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]\n [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]"},{"pos":[5807,5843],"content":"Four Main Concepts in WPF Commanding","linkify":"Four Main Concepts in WPF Commanding","nodes":[{"content":"Four Main Concepts in WPF Commanding","pos":[0,36]}]},{"pos":[5847,6076],"content":"The routed command model in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> can be broken up into four main concepts: the command, the command source, the command target, and the command binding:","source":"The routed command model in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can be broken up into four main concepts: the command, the command source, the command target, and the command binding:"},{"pos":[6086,6129],"content":"The <bpt id=\"p1\">*</bpt>command<ept id=\"p1\">*</ept> is the action to be executed.","source":"The *command* is the action to be executed."},{"pos":[6139,6200],"content":"The <bpt id=\"p1\">*</bpt>command source<ept id=\"p1\">*</ept> is the object which invokes the command.","source":"The *command source* is the object which invokes the command."},{"pos":[6210,6283],"content":"The <bpt id=\"p1\">*</bpt>command target<ept id=\"p1\">*</ept> is the object that the command is being executed on.","source":"The *command target* is the object that the command is being executed on."},{"pos":[6293,6373],"content":"The <bpt id=\"p1\">*</bpt>command binding<ept id=\"p1\">*</ept> is the object which maps the command logic to the command.","source":"The *command binding* is the object which maps the command logic to the command."},{"content":"In the previous example, the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ApplicationCommands.Paste%2A&gt;</ph> command is the command, the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph> is the command source, the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> is the command target, and the command binding is supplied by the <ph id=\"ph4\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> control.","pos":[6380,6713],"source":"In the previous example, the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is the command, the <xref:System.Windows.Controls.MenuItem> is the command source, the <xref:System.Windows.Controls.TextBox> is the command target, and the command binding is supplied by the <xref:System.Windows.Controls.TextBox> control."},{"content":"It is worth noting that it is not always the case that the <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> is supplied by the control that is the command target class.","pos":[6715,6877],"source":"  It is worth noting that it is not always the case that the <xref:System.Windows.Input.CommandBinding> is supplied by the control that is the command target class."},{"content":"Quite often the <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> must be created by the application developer, or the <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> might be attached to an ancestor of the command target.","pos":[6879,7089],"source":"  Quite often the <xref:System.Windows.Input.CommandBinding> must be created by the application developer, or the <xref:System.Windows.Input.CommandBinding> might be attached to an ancestor of the command target."},{"pos":[7126,7134],"content":"Commands","linkify":"Commands","nodes":[{"content":"Commands","pos":[0,8]}]},{"content":"Commands in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> are created by implementing the <ph id=\"ph2\">&lt;xref:System.Windows.Input.ICommand&gt;</ph> interface.","pos":[7138,7311],"source":"Commands in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are created by implementing the <xref:System.Windows.Input.ICommand> interface."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommand&gt;</ph> exposes two methods, <ph id=\"ph2\">&lt;xref:System.Windows.Input.ICommand.Execute%2A&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Windows.Input.ICommand.CanExecute%2A&gt;</ph>, and an event, <ph id=\"ph4\">&lt;xref:System.Windows.Input.ICommand.CanExecuteChanged&gt;</ph>.","pos":[7313,7545],"source":"<xref:System.Windows.Input.ICommand> exposes two methods, <xref:System.Windows.Input.ICommand.Execute%2A>, and <xref:System.Windows.Input.ICommand.CanExecute%2A>, and an event, <xref:System.Windows.Input.ICommand.CanExecuteChanged>."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommand.Execute%2A&gt;</ph> performs the actions that are associated with the command.","pos":[7546,7652],"source":"<xref:System.Windows.Input.ICommand.Execute%2A> performs the actions that are associated with the command."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommand.CanExecute%2A&gt;</ph> determines whether the command can execute on the current command target.","pos":[7653,7777],"source":"<xref:System.Windows.Input.ICommand.CanExecute%2A> determines whether the command can execute on the current command target."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommand.CanExecuteChanged&gt;</ph> is raised if the command manager that centralizes the commanding operations detects a change in the command source that might invalidate a command that has been raised but not yet executed by the command binding.","pos":[7778,8045],"source":"<xref:System.Windows.Input.ICommand.CanExecuteChanged> is raised if the command manager that centralizes the commanding operations detects a change in the command source that might invalidate a command that has been raised but not yet executed by the command binding."},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> implementation of <ph id=\"ph2\">&lt;xref:System.Windows.Input.ICommand&gt;</ph> is the <ph id=\"ph3\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> class and is the focus of this overview.","pos":[8047,8277],"source":"  The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of <xref:System.Windows.Input.ICommand> is the <xref:System.Windows.Input.RoutedCommand> class and is the focus of this overview."},{"content":"The main sources of input in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> are the mouse, the keyboard, ink, and routed commands.","pos":[8284,8449],"source":"The main sources of input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the mouse, the keyboard, ink, and routed commands."},{"content":"The more device-oriented inputs use a <ph id=\"ph1\">&lt;xref:System.Windows.RoutedEvent&gt;</ph> to notify objects in an application page that an input event has occurred.","pos":[8451,8597],"source":"  The more device-oriented inputs use a <xref:System.Windows.RoutedEvent> to notify objects in an application page that an input event has occurred."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> is no different.","pos":[8599,8659],"source":"  A <xref:System.Windows.Input.RoutedCommand> is no different."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand.Execute%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Input.RoutedCommand.CanExecute%2A&gt;</ph> methods of a <ph id=\"ph3\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> do not contain the application logic for the command, but rather they raise routed events that tunnel and bubble through the element tree until they encounter an object with a <ph id=\"ph4\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph>.","pos":[8661,9052],"source":"  The <xref:System.Windows.Input.RoutedCommand.Execute%2A> and <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> methods of a <xref:System.Windows.Input.RoutedCommand> do not contain the application logic for the command, but rather they raise routed events that tunnel and bubble through the element tree until they encounter an object with a <xref:System.Windows.Input.CommandBinding>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> contains the handlers for these events and it is the handlers that perform the command.","pos":[9054,9188],"source":"  The <xref:System.Windows.Input.CommandBinding> contains the handlers for these events and it is the handlers that perform the command."},{"content":"For more information on event routing in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Routed Events Overview<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/routed-events-overview.md)</ept>.","pos":[9190,9410],"source":"  For more information on event routing in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md)."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand.Execute%2A&gt;</ph> method on a <ph id=\"ph2\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> raises the <ph id=\"ph3\">&lt;xref:System.Windows.Input.CommandManager.PreviewExecuted&gt;</ph> and the <ph id=\"ph4\">&lt;xref:System.Windows.Input.CommandManager.Executed&gt;</ph> events on the command target.","pos":[9417,9687],"source":"The <xref:System.Windows.Input.RoutedCommand.Execute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.PreviewExecuted> and the <xref:System.Windows.Input.CommandManager.Executed> events on the command target."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand.CanExecute%2A&gt;</ph> method on a <ph id=\"ph2\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> raises the <ph id=\"ph3\">&lt;xref:System.Windows.Input.CommandManager.CanExecute&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.Input.CommandManager.PreviewCanExecute&gt;</ph> events on the command target.","pos":[9689,9962],"source":"  The <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.CanExecute> and <xref:System.Windows.Input.CommandManager.PreviewCanExecute> events on the command target."},{"content":"These events tunnel and bubble through the element tree until they encounter an object which has a <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> for that particular command.","pos":[9964,10134],"source":"  These events tunnel and bubble through the element tree until they encounter an object which has a <xref:System.Windows.Input.CommandBinding> for that particular command."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> supplies a set of common routed commands spread across several classes: <ph id=\"ph2\">&lt;xref:System.Windows.Input.MediaCommands&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Input.ApplicationCommands&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Input.NavigationCommands&gt;</ph>, <ph id=\"ph5\">&lt;xref:System.Windows.Input.ComponentCommands&gt;</ph>, and <ph id=\"ph6\">&lt;xref:System.Windows.Documents.EditingCommands&gt;</ph>.","pos":[10141,10534],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] supplies a set of common routed commands spread across several classes: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands>, and <xref:System.Windows.Documents.EditingCommands>."},{"content":"These classes consist only of the <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> objects and not the implementation logic of the command.","pos":[10536,10668],"source":"  These classes consist only of the <xref:System.Windows.Input.RoutedCommand> objects and not the implementation logic of the command."},{"content":"The implementation logic is the responsibility of the object on which the command is being executed on.","pos":[10670,10773]},{"pos":[10817,10832],"content":"Command Sources","linkify":"Command Sources","nodes":[{"content":"Command Sources","pos":[0,15]}]},{"content":"A command source is the object which invokes the command.","pos":[10836,10893]},{"content":"Examples of command sources are <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Button&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Windows.Input.KeyGesture&gt;</ph>.","pos":[10895,11050],"source":"  Examples of command sources are <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button>, and <xref:System.Windows.Input.KeyGesture>."},{"pos":[11057,11235],"content":"Command sources in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> generally implement the <ph id=\"ph2\">&lt;xref:System.Windows.Input.ICommandSource&gt;</ph> interface.","source":"Command sources in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] generally implement the <xref:System.Windows.Input.ICommandSource> interface."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommandSource&gt;</ph> exposes three properties: <ph id=\"ph2\">&lt;xref:System.Windows.Input.ICommandSource.Command%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Input.ICommandSource.CommandTarget%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Windows.Input.ICommandSource.CommandParameter%2A&gt;</ph>:","pos":[11242,11494],"source":"<xref:System.Windows.Input.ICommandSource> exposes three properties: <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, and <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:"},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommandSource.Command%2A&gt;</ph> is the command to execute when the command source is invoked.","pos":[11504,11619],"source":"<xref:System.Windows.Input.ICommandSource.Command%2A> is the command to execute when the command source is invoked."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommandSource.CommandTarget%2A&gt;</ph> is the object on which to execute the command.","pos":[11629,11735],"source":"<xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is the object on which to execute the command."},{"content":"It is worth noting that in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> the <ph id=\"ph2\">&lt;xref:System.Windows.Input.ICommandSource.CommandTarget%2A&gt;</ph> property on <ph id=\"ph3\">&lt;xref:System.Windows.Input.ICommandSource&gt;</ph> is only applicable when the <ph id=\"ph4\">&lt;xref:System.Windows.Input.ICommand&gt;</ph> is a <ph id=\"ph5\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph>.","pos":[11737,12077],"source":"  It is worth noting that in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>."},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommandSource.CommandTarget%2A&gt;</ph> is set on an <ph id=\"ph2\">&lt;xref:System.Windows.Input.ICommandSource&gt;</ph> and the corresponding command is not a <ph id=\"ph3\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph>, the command target is ignored.","pos":[12079,12314],"source":"  If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored."},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommandSource.CommandTarget%2A&gt;</ph> is not set, the element with keyboard focus will be the command target.","pos":[12315,12453],"source":" If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is not set, the element with keyboard focus will be the command target."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommandSource.CommandParameter%2A&gt;</ph> is a user-defined data type used to pass information to the handlers implementing the command.","pos":[12463,12620],"source":"<xref:System.Windows.Input.ICommandSource.CommandParameter%2A> is a user-defined data type used to pass information to the handlers implementing the command."},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> classes that implement <ph id=\"ph2\">&lt;xref:System.Windows.Input.ICommandSource&gt;</ph> are <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph>, <ph id=\"ph5\">&lt;xref:System.Windows.Documents.Hyperlink&gt;</ph>, and <ph id=\"ph6\">&lt;xref:System.Windows.Input.InputBinding&gt;</ph>.","pos":[12627,12966],"source":"The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes that implement <xref:System.Windows.Input.ICommandSource> are <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink>, and <xref:System.Windows.Input.InputBinding>."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Windows.Documents.Hyperlink&gt;</ph> invoke a command when they are clicked, and an <ph id=\"ph4\">&lt;xref:System.Windows.Input.InputBinding&gt;</ph> invokes a command when the <ph id=\"ph5\">&lt;xref:System.Windows.Input.InputGesture&gt;</ph> associated with it is performed.","pos":[12968,13297],"source":"<xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, and <xref:System.Windows.Documents.Hyperlink> invoke a command when they are clicked, and an <xref:System.Windows.Input.InputBinding> invokes a command when the <xref:System.Windows.Input.InputGesture> associated with it is performed."},{"content":"The following example shows how to use a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph> in a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ContextMenu&gt;</ph> as a command source for the <ph id=\"ph3\">&lt;xref:System.Windows.Input.ApplicationCommands.Properties%2A&gt;</ph> command.","pos":[13304,13531],"source":"The following example shows how to use a <xref:System.Windows.Controls.MenuItem> in a <xref:System.Windows.Controls.ContextMenu> as a command source for the <xref:System.Windows.Input.ApplicationCommands.Properties%2A> command."},{"pos":[13538,13741],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>CommandingOverviewSnippets#CommandingOverviewCmdSourceXAML<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewcmdsourcexaml)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[CommandingOverviewSnippets#CommandingOverviewCmdSourceXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewcmdsourcexaml)]"},{"pos":[13748,14158],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>CommandingOverviewSnippets#CommandingOverviewCmdSource<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcmdsource)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>CommandingOverviewSnippets#CommandingOverviewCmdSource<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcmdsource)</ept><ept id=\"p3\">]</ept>","leadings":[""," "],"source":"[!code-csharp[CommandingOverviewSnippets#CommandingOverviewCmdSource](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcmdsource)]\n[!code-vb[CommandingOverviewSnippets#CommandingOverviewCmdSource](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcmdsource)]"},{"content":"Typically, a command source will listen to the <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand.CanExecuteChanged&gt;</ph> event.","pos":[14165,14278],"source":"Typically, a command source will listen to the <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> event."},{"content":"This event informs the command source that the ability of the command to execute on the current command target may have changed.","pos":[14280,14408]},{"content":"The command source can query the current status of the <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> by using the <ph id=\"ph2\">&lt;xref:System.Windows.Input.RoutedCommand.CanExecute%2A&gt;</ph> method.","pos":[14410,14583],"source":"  The command source can query the current status of the <xref:System.Windows.Input.RoutedCommand> by using the <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method."},{"content":"The command source can then disable itself if the command cannot execute.","pos":[14585,14658]},{"content":"An example of this is a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph> graying itself out when a command cannot execute.","pos":[14660,14773],"source":"  An example of this is a <xref:System.Windows.Controls.MenuItem> graying itself out when a command cannot execute."},{"content":"An <ph id=\"ph1\">&lt;xref:System.Windows.Input.InputGesture&gt;</ph> can be used as a command source.","pos":[14780,14856],"source":"An <xref:System.Windows.Input.InputGesture> can be used as a command source."},{"content":"Two types of input gestures in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> are the <ph id=\"ph2\">&lt;xref:System.Windows.Input.KeyGesture&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Input.MouseGesture&gt;</ph>.","pos":[14858,15063],"source":"  Two types of input gestures in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the <xref:System.Windows.Input.KeyGesture> and <xref:System.Windows.Input.MouseGesture>."},{"content":"You can think of a <ph id=\"ph1\">&lt;xref:System.Windows.Input.KeyGesture&gt;</ph> as a keyboard shortcut, such as CTRL+C.","pos":[15065,15162],"source":"  You can think of a <xref:System.Windows.Input.KeyGesture> as a keyboard shortcut, such as CTRL+C."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Input.KeyGesture&gt;</ph> is comprised of a <ph id=\"ph2\">&lt;xref:System.Windows.Input.Key&gt;</ph> and a set of <ph id=\"ph3\">&lt;xref:System.Windows.Input.ModifierKeys&gt;</ph>.","pos":[15164,15309],"source":"  A <xref:System.Windows.Input.KeyGesture> is comprised of a <xref:System.Windows.Input.Key> and a set of <xref:System.Windows.Input.ModifierKeys>."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Input.MouseGesture&gt;</ph> is comprised of a <ph id=\"ph2\">&lt;xref:System.Windows.Input.MouseAction&gt;</ph> and an optional set of <ph id=\"ph3\">&lt;xref:System.Windows.Input.ModifierKeys&gt;</ph>.","pos":[15311,15476],"source":"  A <xref:System.Windows.Input.MouseGesture> is comprised of a <xref:System.Windows.Input.MouseAction> and an optional set of <xref:System.Windows.Input.ModifierKeys>."},{"content":"In order for an <ph id=\"ph1\">&lt;xref:System.Windows.Input.InputGesture&gt;</ph> to act as a command source, it must be associated with a command.","pos":[15483,15605],"source":"In order for an <xref:System.Windows.Input.InputGesture> to act as a command source, it must be associated with a command."},{"content":"There are a few ways to accomplish this.","pos":[15606,15646]},{"content":"One way is to use an <ph id=\"ph1\">&lt;xref:System.Windows.Input.InputBinding&gt;</ph>.","pos":[15648,15710],"source":"  One way is to use an <xref:System.Windows.Input.InputBinding>."},{"content":"The following example shows how to create a <ph id=\"ph1\">&lt;xref:System.Windows.Input.KeyBinding&gt;</ph> between a <ph id=\"ph2\">&lt;xref:System.Windows.Input.KeyGesture&gt;</ph> and a <ph id=\"ph3\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph>.","pos":[15717,15897],"source":"The following example shows how to create a <xref:System.Windows.Input.KeyBinding> between a <xref:System.Windows.Input.KeyGesture> and a <xref:System.Windows.Input.RoutedCommand>."},{"pos":[15904,16109],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>CommandingOverviewSnippets#CommandingOverviewXAMLKeyBinding<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlkeybinding)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[CommandingOverviewSnippets#CommandingOverviewXAMLKeyBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlkeybinding)]"},{"pos":[16116,16530],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>CommandingOverviewSnippets#CommandingOverviewKeyBinding<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeybinding)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>CommandingOverviewSnippets#CommandingOverviewKeyBinding<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeybinding)</ept><ept id=\"p3\">]</ept>","leadings":[""," "],"source":"[!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeybinding)]\n[!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeybinding)]"},{"content":"Another way to associate an <ph id=\"ph1\">&lt;xref:System.Windows.Input.InputGesture&gt;</ph> to a <ph id=\"ph2\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> is to add the <ph id=\"ph3\">&lt;xref:System.Windows.Input.InputGesture&gt;</ph> to the <ph id=\"ph4\">&lt;xref:System.Windows.Input.InputGestureCollection&gt;</ph> on the <ph id=\"ph5\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph>.","pos":[16537,16815],"source":"Another way to associate an <xref:System.Windows.Input.InputGesture> to a <xref:System.Windows.Input.RoutedCommand> is to add the <xref:System.Windows.Input.InputGesture> to the <xref:System.Windows.Input.InputGestureCollection> on the <xref:System.Windows.Input.RoutedCommand>."},{"content":"The following example shows how to add a <ph id=\"ph1\">&lt;xref:System.Windows.Input.KeyGesture&gt;</ph> to the <ph id=\"ph2\">&lt;xref:System.Windows.Input.InputGestureCollection&gt;</ph> of a <ph id=\"ph3\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph>.","pos":[16822,17007],"source":"The following example shows how to add a <xref:System.Windows.Input.KeyGesture> to the <xref:System.Windows.Input.InputGestureCollection> of a <xref:System.Windows.Input.RoutedCommand>."},{"pos":[17014,17448],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeygestureoncmd)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeygestureoncmd)</ept><ept id=\"p3\">]</ept>","leadings":[""," "],"source":"[!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeygestureoncmd)]\n[!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeygestureoncmd)]"},{"pos":[17492,17506],"content":"CommandBinding","linkify":"CommandBinding","nodes":[{"content":"CommandBinding","pos":[0,14]}]},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> associates a command with the event handlers that implement the command.","pos":[17510,17627],"source":"A <xref:System.Windows.Input.CommandBinding> associates a command with the event handlers that implement the command."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> class contains a <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandBinding.Command%2A&gt;</ph> property, and <ph id=\"ph3\">&lt;xref:System.Windows.Input.CommandBinding.PreviewExecuted&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Input.CommandBinding.Executed&gt;</ph>, <ph id=\"ph5\">&lt;xref:System.Windows.Input.CommandBinding.PreviewCanExecute&gt;</ph>, and <ph id=\"ph6\">&lt;xref:System.Windows.Input.CommandBinding.CanExecute&gt;</ph> events.","pos":[17634,18006],"source":"The <xref:System.Windows.Input.CommandBinding> class contains a <xref:System.Windows.Input.CommandBinding.Command%2A> property, and <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute>, and <xref:System.Windows.Input.CommandBinding.CanExecute> events."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding.Command%2A&gt;</ph> is the command that the <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> is being associated with.","pos":[18013,18159],"source":"<xref:System.Windows.Input.CommandBinding.Command%2A> is the command that the <xref:System.Windows.Input.CommandBinding> is being associated with."},{"content":"The event handlers which are attached to the <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding.PreviewExecuted&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandBinding.Executed&gt;</ph> events implement the command logic.","pos":[18161,18356],"source":"  The event handlers which are attached to the <xref:System.Windows.Input.CommandBinding.PreviewExecuted> and <xref:System.Windows.Input.CommandBinding.Executed> events implement the command logic."},{"content":"The event handlers attached to the <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding.PreviewCanExecute&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandBinding.CanExecute&gt;</ph> events determine if the command can execute on the current command target.","pos":[18358,18586],"source":"  The event handlers attached to the <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> and <xref:System.Windows.Input.CommandBinding.CanExecute> events determine if the command can execute on the current command target."},{"content":"The following example shows how to create a <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> on the root <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> of an application.","pos":[18593,18739],"source":"The following example shows how to create a <xref:System.Windows.Input.CommandBinding> on the root <xref:System.Windows.Window> of an application."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> associates the <ph id=\"ph2\">&lt;xref:System.Windows.Input.ApplicationCommands.Open%2A&gt;</ph> command with <ph id=\"ph3\">&lt;xref:System.Windows.Input.CommandManager.Executed&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.Input.CommandBinding.CanExecute&gt;</ph> handlers.","pos":[18741,18991],"source":"  The <xref:System.Windows.Input.CommandBinding> associates the <xref:System.Windows.Input.ApplicationCommands.Open%2A> command with <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandBinding.CanExecute> handlers."},{"pos":[18998,19179],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>commandwithhandler#CommandHandlerCommandBinding<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml#commandhandlercommandbinding)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[commandwithhandler#CommandHandlerCommandBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml#commandhandlercommandbinding)]"},{"pos":[19186,19580],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>CommandHandlerProcedural#CommandHandlerBindingInit<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandHandlerProcedural/CSharp/Window1.xaml.cs#commandhandlerbindinginit)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>CommandHandlerProcedural#CommandHandlerBindingInit<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandHandlerProcedural/visualbasic/window1.xaml.vb#commandhandlerbindinginit)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[CommandHandlerProcedural#CommandHandlerBindingInit](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandHandlerProcedural/CSharp/Window1.xaml.cs#commandhandlerbindinginit)]\n [!code-vb[CommandHandlerProcedural#CommandHandlerBindingInit](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandHandlerProcedural/visualbasic/window1.xaml.vb#commandhandlerbindinginit)]"},{"content":"Next, the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ExecutedRoutedEventHandler&gt;</ph> and a <ph id=\"ph2\">&lt;xref:System.Windows.Input.CanExecuteRoutedEventHandler&gt;</ph> are created.","pos":[19587,19727],"source":"Next, the <xref:System.Windows.Input.ExecutedRoutedEventHandler> and a <xref:System.Windows.Input.CanExecuteRoutedEventHandler> are created."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.ExecutedRoutedEventHandler&gt;</ph> opens a <ph id=\"ph2\">&lt;xref:System.Windows.MessageBox&gt;</ph> that displays a string saying the command has been executed.","pos":[19729,19889],"source":"  The <xref:System.Windows.Input.ExecutedRoutedEventHandler> opens a <xref:System.Windows.MessageBox> that displays a string saying the command has been executed."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.CanExecuteRoutedEventHandler&gt;</ph> sets the <ph id=\"ph2\">&lt;xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A&gt;</ph> property to <ph id=\"ph3\">`true`</ph>.","pos":[19891,20048],"source":"  The <xref:System.Windows.Input.CanExecuteRoutedEventHandler> sets the <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> property to `true`."},{"pos":[20055,20441],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>commandwithhandler#CommandHandlerExecutedHandler<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlerexecutedhandler)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>commandwithhandler#CommandHandlerExecutedHandler<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlerexecutedhandler)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[commandwithhandler#CommandHandlerExecutedHandler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlerexecutedhandler)]\n [!code-vb[commandwithhandler#CommandHandlerExecutedHandler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlerexecutedhandler)]"},{"pos":[20448,20842],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>commandwithhandler#CommandHandlerCanExecuteHandler<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlercanexecutehandler)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>commandwithhandler#CommandHandlerCanExecuteHandler<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlercanexecutehandler)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[commandwithhandler#CommandHandlerCanExecuteHandler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlercanexecutehandler)]\n [!code-vb[commandwithhandler#CommandHandlerCanExecuteHandler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlercanexecutehandler)]"},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> is attached to a specific object, such as the root <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> of the application or a control.","pos":[20849,21006],"source":"A <xref:System.Windows.Input.CommandBinding> is attached to a specific object, such as the root <xref:System.Windows.Window> of the application or a control."},{"content":"The object that the <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> is attached to defines the scope of the binding.","pos":[21008,21119],"source":"  The object that the <xref:System.Windows.Input.CommandBinding> is attached to defines the scope of the binding."},{"content":"For example, a <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> attached to an ancestor of the command target can be reached by the <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandBinding.Executed&gt;</ph> event, but a <ph id=\"ph3\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> attached to a descendant of the command target cannot be reached.","pos":[21121,21420],"source":"  For example, a <xref:System.Windows.Input.CommandBinding> attached to an ancestor of the command target can be reached by the <xref:System.Windows.Input.CommandBinding.Executed> event, but a <xref:System.Windows.Input.CommandBinding> attached to a descendant of the command target cannot be reached."},{"content":"This is a direct consequence of the way a <ph id=\"ph1\">&lt;xref:System.Windows.RoutedEvent&gt;</ph> tunnels and bubbles from the object that raises the event.","pos":[21422,21556],"source":"  This is a direct consequence of the way a <xref:System.Windows.RoutedEvent> tunnels and bubbles from the object that raises the event."},{"content":"In some situations the <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> is attached to the command target itself, such as with the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> class and the <ph id=\"ph3\">&lt;xref:System.Windows.Input.ApplicationCommands.Cut%2A&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Input.ApplicationCommands.Copy%2A&gt;</ph>, and <ph id=\"ph5\">&lt;xref:System.Windows.Input.ApplicationCommands.Paste%2A&gt;</ph> commands.","pos":[21563,21924],"source":"In some situations the <xref:System.Windows.Input.CommandBinding> is attached to the command target itself, such as with the <xref:System.Windows.Controls.TextBox> class and the <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, and <xref:System.Windows.Input.ApplicationCommands.Paste%2A> commands."},{"content":"Quite often though, it is more convenient to attach the <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> to an ancestor of the command target, such as the main <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> or the Application object, especially if the same <ph id=\"ph3\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> can be used for multiple command targets.","pos":[21925,22242],"source":" Quite often though, it is more convenient to attach the <xref:System.Windows.Input.CommandBinding> to an ancestor of the command target, such as the main <xref:System.Windows.Window> or the Application object, especially if the same <xref:System.Windows.Input.CommandBinding> can be used for multiple command targets."},{"content":"These are design decisions you will want to consider when you are creating your commanding infrastructure.","pos":[22244,22350]},{"pos":[22393,22407],"content":"Command Target","linkify":"Command Target","nodes":[{"content":"Command Target","pos":[0,14]}]},{"content":"The command target is the element on which the command is executed.","pos":[22411,22478]},{"content":"With regards to a <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph>, the command target is the element at which routing of the <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandManager.Executed&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Input.CommandManager.CanExecute&gt;</ph> starts.","pos":[22480,22716],"source":"  With regards to a <xref:System.Windows.Input.RoutedCommand>, the command target is the element at which routing of the <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandManager.CanExecute> starts."},{"content":"As noted previously, in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> the <ph id=\"ph2\">&lt;xref:System.Windows.Input.ICommandSource.CommandTarget%2A&gt;</ph> property on <ph id=\"ph3\">&lt;xref:System.Windows.Input.ICommandSource&gt;</ph> is only applicable when the <ph id=\"ph4\">&lt;xref:System.Windows.Input.ICommand&gt;</ph> is a <ph id=\"ph5\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph>.","pos":[22718,23055],"source":"  As noted previously, in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>."},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommandSource.CommandTarget%2A&gt;</ph> is set on an <ph id=\"ph2\">&lt;xref:System.Windows.Input.ICommandSource&gt;</ph> and the corresponding command is not a <ph id=\"ph3\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph>, the command target is ignored.","pos":[23057,23292],"source":"  If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored."},{"content":"The command source can explicitly set the command target.","pos":[23299,23356]},{"content":"If the command target is not defined, the element with keyboard focus will be used as the command target.","pos":[23358,23463]},{"content":"One of the benefits of using the element with keyboard focus as the command target is that it allows the application developer to use the same command source to invoke a command on multiple targets without having to keep track of the command target.","pos":[23465,23714]},{"content":"For example, if a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph> invokes the <bpt id=\"p1\">**</bpt>Paste<ept id=\"p1\">**</ept> command in an application that has a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> control and a <ph id=\"ph3\">&lt;xref:System.Windows.Controls.PasswordBox&gt;</ph> control, the target can be either the <ph id=\"ph4\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> or <ph id=\"ph5\">&lt;xref:System.Windows.Controls.PasswordBox&gt;</ph> depending on which control has keyboard focus.","pos":[23716,24098],"source":"  For example, if a <xref:System.Windows.Controls.MenuItem> invokes the **Paste** command in an application that has a <xref:System.Windows.Controls.TextBox> control and a <xref:System.Windows.Controls.PasswordBox> control, the target can be either the <xref:System.Windows.Controls.TextBox> or <xref:System.Windows.Controls.PasswordBox> depending on which control has keyboard focus."},{"content":"The following example shows how to explicitly set the command target in markup and in code behind.","pos":[24105,24203]},{"pos":[24210,24421],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>CommandingOverviewSnippets#CommandingOverviewXAMLCommandTarget<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlcommandtarget)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[CommandingOverviewSnippets#CommandingOverviewXAMLCommandTarget](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlcommandtarget)]"},{"pos":[24428,24894],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]\n [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]"},{"pos":[24938,24956],"content":"The CommandManager","linkify":"The CommandManager","nodes":[{"content":"The CommandManager","pos":[0,18]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandManager&gt;</ph> serves a number of command related functions.","pos":[24960,25052],"source":"The <xref:System.Windows.Input.CommandManager> serves a number of command related functions."},{"content":"It provides a set of static methods for adding and removing <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandManager.PreviewExecuted&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandManager.Executed&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Input.CommandManager.PreviewCanExecute&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Windows.Input.CommandManager.CanExecute&gt;</ph> event handlers to and from a specific element.","pos":[25054,25393],"source":"  It provides a set of static methods for adding and removing <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute>, and <xref:System.Windows.Input.CommandManager.CanExecute> event handlers to and from a specific element."},{"content":"It provides a means to register <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Input.InputBinding&gt;</ph> objects onto a specific class.","pos":[25395,25545],"source":"  It provides a means to register <xref:System.Windows.Input.CommandBinding> and <xref:System.Windows.Input.InputBinding> objects onto a specific class."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandManager&gt;</ph> also provides a means, through the <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandManager.RequerySuggested&gt;</ph> event, to notify a command when it should raise the <ph id=\"ph3\">&lt;xref:System.Windows.Input.ICommand.CanExecuteChanged&gt;</ph> event.","pos":[25547,25802],"source":"  The <xref:System.Windows.Input.CommandManager> also provides a means, through the <xref:System.Windows.Input.CommandManager.RequerySuggested> event, to notify a command when it should raise the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A&gt;</ph> method forces the <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandManager&gt;</ph> to raise the <ph id=\"ph3\">&lt;xref:System.Windows.Input.CommandManager.RequerySuggested&gt;</ph> event.","pos":[25809,26026],"source":"The <xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> method forces the <xref:System.Windows.Input.CommandManager> to raise the <xref:System.Windows.Input.CommandManager.RequerySuggested> event."},{"content":"This is useful for conditions that should disable/enable a command but are not conditions that the <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandManager&gt;</ph> is aware of.","pos":[26028,26182],"source":"  This is useful for conditions that should disable/enable a command but are not conditions that the <xref:System.Windows.Input.CommandManager> is aware of."},{"pos":[26225,26240],"content":"Command Library","linkify":"Command Library","nodes":[{"content":"Command Library","pos":[0,15]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> provides a set of predefined commands.","pos":[26244,26364],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a set of predefined commands."},{"content":"The command library consists of the following classes: <ph id=\"ph1\">&lt;xref:System.Windows.Input.ApplicationCommands&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Input.NavigationCommands&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Input.MediaCommands&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Documents.EditingCommands&gt;</ph>, and the <ph id=\"ph5\">&lt;xref:System.Windows.Input.ComponentCommands&gt;</ph>.","pos":[26366,26664],"source":"  The command library consists of the following classes: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands>, and the <xref:System.Windows.Input.ComponentCommands>."},{"content":"These classes provide commands such as <ph id=\"ph1\">&lt;xref:System.Windows.Input.ApplicationCommands.Cut%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Input.NavigationCommands.BrowseBack%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Input.NavigationCommands.BrowseForward%2A&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Input.MediaCommands.Play%2A&gt;</ph>, <ph id=\"ph5\">&lt;xref:System.Windows.Input.MediaCommands.Stop%2A&gt;</ph>, and <ph id=\"ph6\">&lt;xref:System.Windows.Input.MediaCommands.Pause%2A&gt;</ph>.","pos":[26666,27048],"source":"  These classes provide commands such as <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> and <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A>, and <xref:System.Windows.Input.MediaCommands.Pause%2A>."},{"content":"Many of these commands include a set of default input bindings.","pos":[27055,27118]},{"content":"For example, if you specify that your application handles the copy command, you automatically get the keyboard binding \"CTRL+C\" You also get bindings for other input devices, such as <ph id=\"ph1\">[!INCLUDE[TLA2#tla_tpc](../../../../includes/tla2sharptla-tpc-md.md)]</ph> pen gestures and speech information.","pos":[27120,27409],"source":"  For example, if you specify that your application handles the copy command, you automatically get the keyboard binding \"CTRL+C\" You also get bindings for other input devices, such as [!INCLUDE[TLA2#tla_tpc](../../../../includes/tla2sharptla-tpc-md.md)] pen gestures and speech information."},{"content":"When you reference commands in the various command libraries using <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph>, you can usually omit the class name of the library class that exposes the static command property.","pos":[27416,27654],"source":"When you reference commands in the various command libraries using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can usually omit the class name of the library class that exposes the static command property."},{"content":"Generally, the command names are unambiguous as strings, and the owning types exist to provide a logical grouping of commands but are not necessary for disambiguation.","pos":[27655,27822]},{"content":"For instance, you can specify <ph id=\"ph1\">`Command=\"Cut\"`</ph> rather than the more verbose <ph id=\"ph2\">`Command=\"ApplicationCommands.Cut\"`</ph>.","pos":[27823,27934],"source":" For instance, you can specify `Command=\"Cut\"` rather than the more verbose `Command=\"ApplicationCommands.Cut\"`."},{"content":"This is a convenience mechanism that is built in to the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> processor for commands (more precisely, it is a type converter behavior of <ph id=\"ph3\">&lt;xref:System.Windows.Input.ICommand&gt;</ph>, which the <ph id=\"ph4\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph5\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> processor references at load time).","pos":[27935,28457],"source":" This is a convenience mechanism that is built in to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor for commands (more precisely, it is a type converter behavior of <xref:System.Windows.Input.ICommand>, which the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor references at load time)."},{"pos":[28502,28526],"content":"Creating Custom Commands","linkify":"Creating Custom Commands","nodes":[{"content":"Creating Custom Commands","pos":[0,24]}]},{"content":"If the commands in the command library classes do not meet your needs, then you can create your own commands.","pos":[28530,28639]},{"content":"There are two ways to create a custom command.","pos":[28641,28687]},{"content":"The first is to start from the ground up and implement the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ICommand&gt;</ph> interface.","pos":[28689,28795],"source":"  The first is to start from the ground up and implement the <xref:System.Windows.Input.ICommand> interface."},{"content":"The other way, and the more common approach, is to create a <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> or a <ph id=\"ph2\">&lt;xref:System.Windows.Input.RoutedUICommand&gt;</ph>.","pos":[28797,28948],"source":"  The other way, and the more common approach, is to create a <xref:System.Windows.Input.RoutedCommand> or a <xref:System.Windows.Input.RoutedUICommand>."},{"pos":[28955,29124],"content":"For an example of creating a custom <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph>, see <bpt id=\"p1\">[</bpt>Create a Custom RoutedCommand Sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=159980)</ept>.","source":"For an example of creating a custom <xref:System.Windows.Input.RoutedCommand>, see [Create a Custom RoutedCommand Sample](http://go.microsoft.com/fwlink/?LinkID=159980)."},{"pos":[29133,29141],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>Input Overview<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/input-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[29329,29406],"source":" [Input Overview](../../../../docs/framework/wpf/advanced/input-overview.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Routed Events Overview<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/routed-events-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[29409,29502],"source":" [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Implement ICommandSource<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/how-to-implement-icommandsource.md)</ept><ph id=\"ph1\"> </ph>","pos":[29505,29609],"source":" [Implement ICommandSource](../../../../docs/framework/wpf/advanced/how-to-implement-icommandsource.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Add a Command to a MenuItem<ept id=\"p1\">](http://msdn.microsoft.com/en-us/013d68a0-5373-4a68-bd91-5de574307370)</ept><ph id=\"ph1\"> </ph>","pos":[29612,29721],"source":" [How to: Add a Command to a MenuItem](http://msdn.microsoft.com/en-us/013d68a0-5373-4a68-bd91-5de574307370) "},{"content":"<bpt id=\"p1\"> [</bpt>Create a Custom RoutedCommand Sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=159980)</ept>","pos":[29724,29810],"source":" [Create a Custom RoutedCommand Sample](http://go.microsoft.com/fwlink/?LinkID=159980)"}]}