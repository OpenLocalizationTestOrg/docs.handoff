{"content":"---\ntitle: \"Basic TransactionScope | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 1e22b76a-76de-43b4-9be7-7a86ed3d5a44\ncaps.latest.revision: 13\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Basic TransactionScope\nThis sample consists of four scenarios that run showing how to nest <xref:System.Activities.Statements.TransactionScope> instances. The first scenario shows nesting a 3rd party activity of which the author has no knowledge of the construction. The second and third scenarios show how time-outs are respected and the final scenario shows the <xref:System.Activities.Statements.TransactionScope.AbortInstanceOnTransactionFailure%2A> setting.  \n  \n## Nesting of TransactionScopeActivity  \n The workflow for the first scenario consists of a sequence of two <xref:System.Activities.Statements.WriteLine> activities and a <xref:System.Activities.Statements.TransactionScope>. The body of the <xref:System.Activities.Statements.TransactionScope> is a sequence of two more <xref:System.Activities.Statements.WriteLine> activities, a custom activity that prints the local identifier of the transaction and a third party activity. The third party activity `TransactionScopeTest` contains a <xref:System.Activities.Statements.TransactionScope> although the workflow author has no way of knowing. This scenario shows that <xref:System.Activities.Statements.TransactionScope> activities can be nested.  \n  \n## Time-Outs  \n The workflow for the second scenario is nearly identical to the first. The `TransactionScopeTest` has been replaced with a <xref:System.Activities.Statements.TransactionScope>. The body of the <xref:System.Activities.Statements.TransactionScope> is a five-second delay and the time-out for the transaction is set to two seconds. The time-out for the outer <xref:System.Activities.Statements.TransactionScope> is set to 10 seconds. Note that the smallest time-out in scope is respected and the transaction times out.  \n  \n The workflow for the third scenario is nearly identical to scenario two. The delay activity has been moved from the body of the inner <xref:System.Activities.Statements.TransactionScope> to immediately after it in the sequence that is the body of the outer <xref:System.Activities.Statements.TransactionScope>. The transaction still times out but because the two second time-out of the inner <xref:System.Activities.Statements.TransactionScope> no longer applies. The transaction times out at 10 seconds when the outer <xref:System.Activities.Statements.TransactionScope> time-out is exceeded.  \n  \n## Aborting on Transaction Failure  \n This workflow is similar to scenario three except the time-outs have been replaced by the <xref:System.Activities.Statements.TransactionScope.AbortInstanceOnTransactionFailure%2A> property. Note that the flags of all inner children, if set, must match the outer <xref:System.Activities.Statements.TransactionScope>. In this scenario, they do not and an exception is thrown when the workflow opens.  \n  \n#### To run the sample  \n  \n1.  Open the BasicTransactionScopeSample.sln solution in [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)].  \n  \n2.  To build the solution, press CTRL+SHIFT+B or select **Build Solution** from the **Build** menu.  \n  \n3.  Once the build has succeeded, press F5 or select **Start Debugging** from the **Debug** menu. Alternatively you can press CTRL+F5 or select **Start Without Debugging** from the **Debug** menu to run without debugging.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\Transactions\\BasicTransactionScope`  \n  \n## See Also","nodes":[{"pos":[12,51],"content":"Basic TransactionScope | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Basic TransactionScope | Microsoft Docs","pos":[0,39]}]},{"pos":[317,339],"content":"Basic TransactionScope","linkify":"Basic TransactionScope","nodes":[{"content":"Basic TransactionScope","pos":[0,22]}]},{"content":"This sample consists of four scenarios that run showing how to nest <ph id=\"ph1\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph> instances.","pos":[340,471],"source":"This sample consists of four scenarios that run showing how to nest <xref:System.Activities.Statements.TransactionScope> instances."},{"content":"The first scenario shows nesting a 3rd party activity of which the author has no knowledge of the construction.","pos":[472,583]},{"content":"The second and third scenarios show how time-outs are respected and the final scenario shows the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.TransactionScope.AbortInstanceOnTransactionFailure%2A&gt;</ph> setting.","pos":[584,779],"source":" The second and third scenarios show how time-outs are respected and the final scenario shows the <xref:System.Activities.Statements.TransactionScope.AbortInstanceOnTransactionFailure%2A> setting."},{"pos":[788,823],"content":"Nesting of TransactionScopeActivity","linkify":"Nesting of TransactionScopeActivity","nodes":[{"content":"Nesting of TransactionScopeActivity","pos":[0,35]}]},{"content":"The workflow for the first scenario consists of a sequence of two <ph id=\"ph1\">&lt;xref:System.Activities.Statements.WriteLine&gt;</ph> activities and a <ph id=\"ph2\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph>.","pos":[827,1009],"source":"The workflow for the first scenario consists of a sequence of two <xref:System.Activities.Statements.WriteLine> activities and a <xref:System.Activities.Statements.TransactionScope>."},{"content":"The body of the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph> is a sequence of two more <ph id=\"ph2\">&lt;xref:System.Activities.Statements.WriteLine&gt;</ph> activities, a custom activity that prints the local identifier of the transaction and a third party activity.","pos":[1010,1260],"source":" The body of the <xref:System.Activities.Statements.TransactionScope> is a sequence of two more <xref:System.Activities.Statements.WriteLine> activities, a custom activity that prints the local identifier of the transaction and a third party activity."},{"content":"The third party activity <ph id=\"ph1\">`TransactionScopeTest`</ph> contains a <ph id=\"ph2\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph> although the workflow author has no way of knowing.","pos":[1261,1424],"source":" The third party activity `TransactionScopeTest` contains a <xref:System.Activities.Statements.TransactionScope> although the workflow author has no way of knowing."},{"content":"This scenario shows that <ph id=\"ph1\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph> activities can be nested.","pos":[1425,1528],"source":" This scenario shows that <xref:System.Activities.Statements.TransactionScope> activities can be nested."},{"pos":[1537,1546],"content":"Time-Outs","linkify":"Time-Outs","nodes":[{"content":"Time-Outs","pos":[0,9]}]},{"content":"The workflow for the second scenario is nearly identical to the first.","pos":[1550,1620]},{"content":"The <ph id=\"ph1\">`TransactionScopeTest`</ph> has been replaced with a <ph id=\"ph2\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph>.","pos":[1621,1726],"source":" The `TransactionScopeTest` has been replaced with a <xref:System.Activities.Statements.TransactionScope>."},{"content":"The body of the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph> is a five-second delay and the time-out for the transaction is set to two seconds.","pos":[1727,1878],"source":" The body of the <xref:System.Activities.Statements.TransactionScope> is a five-second delay and the time-out for the transaction is set to two seconds."},{"content":"The time-out for the outer <ph id=\"ph1\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph> is set to 10 seconds.","pos":[1879,1980],"source":" The time-out for the outer <xref:System.Activities.Statements.TransactionScope> is set to 10 seconds."},{"content":"Note that the smallest time-out in scope is respected and the transaction times out.","pos":[1981,2065]},{"content":"The workflow for the third scenario is nearly identical to scenario two.","pos":[2072,2144]},{"content":"The delay activity has been moved from the body of the inner <ph id=\"ph1\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph> to immediately after it in the sequence that is the body of the outer <ph id=\"ph2\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph>.","pos":[2145,2382],"source":" The delay activity has been moved from the body of the inner <xref:System.Activities.Statements.TransactionScope> to immediately after it in the sequence that is the body of the outer <xref:System.Activities.Statements.TransactionScope>."},{"content":"The transaction still times out but because the two second time-out of the inner <ph id=\"ph1\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph> no longer applies.","pos":[2383,2535],"source":" The transaction still times out but because the two second time-out of the inner <xref:System.Activities.Statements.TransactionScope> no longer applies."},{"content":"The transaction times out at 10 seconds when the outer <ph id=\"ph1\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph> time-out is exceeded.","pos":[2536,2665],"source":" The transaction times out at 10 seconds when the outer <xref:System.Activities.Statements.TransactionScope> time-out is exceeded."},{"pos":[2674,2705],"content":"Aborting on Transaction Failure","linkify":"Aborting on Transaction Failure","nodes":[{"content":"Aborting on Transaction Failure","pos":[0,31]}]},{"content":"This workflow is similar to scenario three except the time-outs have been replaced by the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.TransactionScope.AbortInstanceOnTransactionFailure%2A&gt;</ph> property.","pos":[2709,2898],"source":"This workflow is similar to scenario three except the time-outs have been replaced by the <xref:System.Activities.Statements.TransactionScope.AbortInstanceOnTransactionFailure%2A> property."},{"content":"Note that the flags of all inner children, if set, must match the outer <ph id=\"ph1\">&lt;xref:System.Activities.Statements.TransactionScope&gt;</ph>.","pos":[2899,3024],"source":" Note that the flags of all inner children, if set, must match the outer <xref:System.Activities.Statements.TransactionScope>."},{"content":"In this scenario, they do not and an exception is thrown when the workflow opens.","pos":[3025,3106]},{"pos":[3117,3134],"content":"To run the sample","linkify":"To run the sample","nodes":[{"content":"To run the sample","pos":[0,17]}]},{"pos":[3144,3251],"content":"Open the BasicTransactionScopeSample.sln solution in <ph id=\"ph1\">[!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]</ph>.","source":"Open the BasicTransactionScopeSample.sln solution in [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]."},{"pos":[3261,3356],"content":"To build the solution, press CTRL+SHIFT+B or select <bpt id=\"p1\">**</bpt>Build Solution<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Build<ept id=\"p2\">**</ept> menu.","source":"To build the solution, press CTRL+SHIFT+B or select **Build Solution** from the **Build** menu."},{"content":"Once the build has succeeded, press F5 or select <bpt id=\"p1\">**</bpt>Start Debugging<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Debug<ept id=\"p2\">**</ept> menu.","pos":[3366,3459],"source":"Once the build has succeeded, press F5 or select **Start Debugging** from the **Debug** menu."},{"content":"Alternatively you can press CTRL+F5 or select <bpt id=\"p1\">**</bpt>Start Without Debugging<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Debug<ept id=\"p2\">**</ept> menu to run without debugging.","pos":[3460,3583],"source":" Alternatively you can press CTRL+F5 or select **Start Without Debugging** from the **Debug** menu to run without debugging."},{"pos":[3591,3723],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[3777,4103],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[4104,4154]},{"pos":[4250,4258],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]}]}