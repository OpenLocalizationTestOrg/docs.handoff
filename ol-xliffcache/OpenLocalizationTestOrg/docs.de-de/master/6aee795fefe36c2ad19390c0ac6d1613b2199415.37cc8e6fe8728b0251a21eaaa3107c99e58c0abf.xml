{"content":"---\ntitle: \"How to: Change the Value of a Procedure Argument (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"procedures [Visual Basic], arguments\"\n  - \"procedures [Visual Basic], parameters\"\n  - \"procedure arguments\"\n  - \"arguments [Visual Basic], passing by reference\"\n  - \"Visual Basic code, procedures\"\n  - \"arguments [Visual Basic], ByVal\"\n  - \"arguments [Visual Basic], passing by value\"\n  - \"procedure parameters\"\n  - \"arguments [Visual Basic], ByRef\"\n  - \"arguments [Visual Basic], changing value\"\nms.assetid: 6fad2368-5da7-4c07-8bf8-0f4e65a1be67\n---\n# How to: Change the Value of a Procedure Argument (Visual Basic)\nWhen you call a procedure, each argument you supply corresponds to one of the parameters defined in the procedure. In some cases, the procedure code can change the value underlying an argument in the calling code. In other cases, the procedure can change only its local copy of an argument.  \n  \n When you call the procedure, Visual Basic makes a local copy of every argument that is passed [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md). For each argument passed [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md), Visual Basic gives the procedure code a direct reference to the programming element underlying the argument in the calling code.  \n  \n If the underlying element in the calling code is a modifiable element and the argument is passed `ByRef`, the procedure code can use the direct reference to change the element's value in the calling code.  \n  \n## Changing the Underlying Value  \n  \n#### To change the underlying value of a procedure argument in the calling code  \n  \n1.  In the procedure declaration, specify [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md) for the parameter corresponding to the argument.  \n  \n2.  In the calling code, pass a modifiable programming element as the argument.  \n  \n3.  In the calling code, do not enclose the argument in parentheses in the argument list.  \n  \n4.  In the procedure code, use the parameter name to assign a value to the underlying element in the calling code.  \n  \n See the example further down for a demonstration.  \n  \n## Changing Local Copies  \n If the underlying element in the calling code is a nonmodifiable element, or if the argument is passed `ByVal`, the procedure cannot change its value in the calling code. However, the procedure can change its local copy of such an argument.  \n  \n#### To change the copy of a procedure argument in the procedure code  \n  \n1.  In the procedure declaration, specify [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) for the parameter corresponding to the argument.  \n  \n     -or-  \n  \n     In the calling code, enclose the argument in parentheses in the argument list. This forces Visual Basic to pass the argument by value, even if the corresponding parameter specifies `ByRef`.  \n  \n2.  In the procedure code, use the parameter name to assign a value to the local copy of the argument. The underlying value in the calling code is not changed.  \n  \n## Example  \n The following example shows two procedures that take an array variable and operate on its elements. The `increase` procedure simply adds one to each element. The `replace` procedure assigns a new array to the parameter `a()` and then adds one to each element.  \n  \n [!code-vb[VbVbcnProcedures#35](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#35)]  \n  \n [!code-vb[VbVbcnProcedures#36](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#36)]  \n  \n [!code-vb[VbVbcnProcedures#37](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#37)]  \n  \n The first `MsgBox` call displays \"After increase(n): 11, 21, 31, 41\". Because the array `n` is a reference type, `replace` can change its members, even though the passing mechanism is `ByVal`.  \n  \n The second `MsgBox` call displays \"After replace(n): 101, 201, 301\". Because `n` is passed `ByRef`, `replace` can modify the variable `n` in the calling code and assign a new array to it. Because `n` is a reference type, `replace` can also change its members.  \n  \n You can prevent the procedure from modifying the variable itself in the calling code. See [How to: Protect a Procedure Argument Against Value Changes](./how-to-protect-a-procedure-argument-against-value-changes.md).  \n  \n## Compiling the Code  \n When you pass a variable by reference, you must use the `ByRef` keyword to specify this mechanism.  \n  \n The default in Visual Basic is to pass arguments by value. However, it is good programming practice to include either the [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) or [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md) keyword with every declared parameter. This makes your code easier to read.  \n  \n## .NET Framework Security  \n There is always a potential risk in allowing a procedure to change the value underlying an argument in the calling code. Make sure you expect this value to be changed, and be prepared to check it for validity before using it.  \n  \n## See also\n\n- [Procedures](./index.md)\n- [Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)\n- [How to: Pass Arguments to a Procedure](./how-to-pass-arguments-to-a-procedure.md)\n- [Passing Arguments by Value and by Reference](./passing-arguments-by-value-and-by-reference.md)\n- [Differences Between Modifiable and Nonmodifiable Arguments](./differences-between-modifiable-and-nonmodifiable-arguments.md)\n- [Differences Between Passing an Argument By Value and By Reference](./differences-between-passing-an-argument-by-value-and-by-reference.md)\n- [How to: Protect a Procedure Argument Against Value Changes](./how-to-protect-a-procedure-argument-against-value-changes.md)\n- [How to: Force an Argument to Be Passed by Value](./how-to-force-an-argument-to-be-passed-by-value.md)\n- [Passing Arguments by Position and by Name](./passing-arguments-by-position-and-by-name.md)\n- [Value Types and Reference Types](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)\n","nodes":[{"pos":[4,568],"embed":true,"restype":"x-metadata","content":"title: \"How to: Change the Value of a Procedure Argument (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"procedures [Visual Basic], arguments\"\n  - \"procedures [Visual Basic], parameters\"\n  - \"procedure arguments\"\n  - \"arguments [Visual Basic], passing by reference\"\n  - \"Visual Basic code, procedures\"\n  - \"arguments [Visual Basic], ByVal\"\n  - \"arguments [Visual Basic], passing by value\"\n  - \"procedure parameters\"\n  - \"arguments [Visual Basic], ByRef\"\n  - \"arguments [Visual Basic], changing value\"\nms.assetid: 6fad2368-5da7-4c07-8bf8-0f4e65a1be67","nodes":[{"content":"How to: Change the Value of a Procedure Argument (Visual Basic)","nodes":[{"pos":[0,63],"content":"How to: Change the Value of a Procedure Argument (Visual Basic)","nodes":[{"content":"How to: Change the Value of a Procedure Argument (Visual Basic)","pos":[0,63]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[575,638],"content":"How to: Change the Value of a Procedure Argument (Visual Basic)","linkify":"How to: Change the Value of a Procedure Argument (Visual Basic)","nodes":[{"content":"How to: Change the Value of a Procedure Argument (Visual Basic)","pos":[0,63]}]},{"content":"When you call a procedure, each argument you supply corresponds to one of the parameters defined in the procedure.","pos":[639,753]},{"content":"In some cases, the procedure code can change the value underlying an argument in the calling code.","pos":[754,852]},{"content":"In other cases, the procedure can change only its local copy of an argument.","pos":[853,929]},{"content":"When you call the procedure, Visual Basic makes a local copy of every argument that is passed <bpt id=\"p1\">[</bpt>ByVal<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byval.md)</ept>.","pos":[936,1102],"source":"When you call the procedure, Visual Basic makes a local copy of every argument that is passed [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md)."},{"content":"For each argument passed <bpt id=\"p1\">[</bpt>ByRef<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byref.md)</ept>, Visual Basic gives the procedure code a direct reference to the programming element underlying the argument in the calling code.","pos":[1103,1329],"source":" For each argument passed [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md), Visual Basic gives the procedure code a direct reference to the programming element underlying the argument in the calling code."},{"pos":[1336,1540],"content":"If the underlying element in the calling code is a modifiable element and the argument is passed <ph id=\"ph1\">`ByRef`</ph>, the procedure code can use the direct reference to change the element's value in the calling code.","source":"If the underlying element in the calling code is a modifiable element and the argument is passed `ByRef`, the procedure code can use the direct reference to change the element's value in the calling code."},{"pos":[1549,1578],"content":"Changing the Underlying Value","linkify":"Changing the Underlying Value","nodes":[{"content":"Changing the Underlying Value","pos":[0,29]}]},{"pos":[1589,1663],"content":"To change the underlying value of a procedure argument in the calling code","linkify":"To change the underlying value of a procedure argument in the calling code","nodes":[{"content":"To change the underlying value of a procedure argument in the calling code","pos":[0,74]}]},{"pos":[1673,1831],"content":"In the procedure declaration, specify <bpt id=\"p1\">[</bpt>ByRef<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byref.md)</ept> for the parameter corresponding to the argument.","source":"In the procedure declaration, specify [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md) for the parameter corresponding to the argument."},{"content":"In the calling code, pass a modifiable programming element as the argument.","pos":[1841,1916]},{"content":"In the calling code, do not enclose the argument in parentheses in the argument list.","pos":[1926,2011]},{"content":"In the procedure code, use the parameter name to assign a value to the underlying element in the calling code.","pos":[2021,2131]},{"content":"See the example further down for a demonstration.","pos":[2138,2187]},{"pos":[2196,2217],"content":"Changing Local Copies","linkify":"Changing Local Copies","nodes":[{"content":"Changing Local Copies","pos":[0,21]}]},{"content":"If the underlying element in the calling code is a nonmodifiable element, or if the argument is passed <ph id=\"ph1\">`ByVal`</ph>, the procedure cannot change its value in the calling code.","pos":[2221,2391],"source":"If the underlying element in the calling code is a nonmodifiable element, or if the argument is passed `ByVal`, the procedure cannot change its value in the calling code."},{"content":"However, the procedure can change its local copy of such an argument.","pos":[2392,2461]},{"pos":[2472,2536],"content":"To change the copy of a procedure argument in the procedure code","linkify":"To change the copy of a procedure argument in the procedure code","nodes":[{"content":"To change the copy of a procedure argument in the procedure code","pos":[0,64]}]},{"pos":[2546,2704],"content":"In the procedure declaration, specify <bpt id=\"p1\">[</bpt>ByVal<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byval.md)</ept> for the parameter corresponding to the argument.","source":"In the procedure declaration, specify [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) for the parameter corresponding to the argument."},{"content":"-or-","pos":[2715,2719]},{"content":"In the calling code, enclose the argument in parentheses in the argument list.","pos":[2730,2808]},{"content":"This forces Visual Basic to pass the argument by value, even if the corresponding parameter specifies <ph id=\"ph1\">`ByRef`</ph>.","pos":[2809,2919],"source":" This forces Visual Basic to pass the argument by value, even if the corresponding parameter specifies `ByRef`."},{"content":"In the procedure code, use the parameter name to assign a value to the local copy of the argument.","pos":[2929,3027]},{"content":"The underlying value in the calling code is not changed.","pos":[3028,3084]},{"pos":[3093,3100],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows two procedures that take an array variable and operate on its elements.","pos":[3104,3203]},{"content":"The <ph id=\"ph1\">`increase`</ph> procedure simply adds one to each element.","pos":[3204,3261],"source":" The `increase` procedure simply adds one to each element."},{"content":"The <ph id=\"ph1\">`replace`</ph> procedure assigns a new array to the parameter <ph id=\"ph2\">`a()`</ph> and then adds one to each element.","pos":[3262,3363],"source":" The `replace` procedure assigns a new array to the parameter `a()` and then adds one to each element."},{"content":"The first <ph id=\"ph1\">`MsgBox`</ph> call displays \"After increase(n): 11, 21, 31, 41\".","pos":[3742,3811],"source":"The first `MsgBox` call displays \"After increase(n): 11, 21, 31, 41\"."},{"content":"Because the array <ph id=\"ph1\">`n`</ph> is a reference type, <ph id=\"ph2\">`replace`</ph> can change its members, even though the passing mechanism is <ph id=\"ph3\">`ByVal`</ph>.","pos":[3812,3934],"source":" Because the array `n` is a reference type, `replace` can change its members, even though the passing mechanism is `ByVal`."},{"content":"The second <ph id=\"ph1\">`MsgBox`</ph> call displays \"After replace(n): 101, 201, 301\".","pos":[3941,4009],"source":"The second `MsgBox` call displays \"After replace(n): 101, 201, 301\"."},{"content":"Because <ph id=\"ph1\">`n`</ph> is passed <ph id=\"ph2\">`ByRef`</ph>, <ph id=\"ph3\">`replace`</ph> can modify the variable <ph id=\"ph4\">`n`</ph> in the calling code and assign a new array to it.","pos":[4010,4128],"source":" Because `n` is passed `ByRef`, `replace` can modify the variable `n` in the calling code and assign a new array to it."},{"content":"Because <ph id=\"ph1\">`n`</ph> is a reference type, <ph id=\"ph2\">`replace`</ph> can also change its members.","pos":[4129,4200],"source":" Because `n` is a reference type, `replace` can also change its members."},{"content":"You can prevent the procedure from modifying the variable itself in the calling code.","pos":[4207,4292]},{"content":"See <bpt id=\"p1\">[</bpt>How to: Protect a Procedure Argument Against Value Changes<ept id=\"p1\">](./how-to-protect-a-procedure-argument-against-value-changes.md)</ept>.","pos":[4293,4422],"source":" See [How to: Protect a Procedure Argument Against Value Changes](./how-to-protect-a-procedure-argument-against-value-changes.md)."},{"pos":[4431,4449],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[4453,4551],"content":"When you pass a variable by reference, you must use the <ph id=\"ph1\">`ByRef`</ph> keyword to specify this mechanism.","source":"When you pass a variable by reference, you must use the `ByRef` keyword to specify this mechanism."},{"content":"The default in Visual Basic is to pass arguments by value.","pos":[4558,4616]},{"content":"However, it is good programming practice to include either the <bpt id=\"p1\">[</bpt>ByVal<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byval.md)</ept> or <bpt id=\"p2\">[</bpt>ByRef<ept id=\"p2\">](../../../../visual-basic/language-reference/modifiers/byref.md)</ept> keyword with every declared parameter.","pos":[4617,4865],"source":" However, it is good programming practice to include either the [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) or [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md) keyword with every declared parameter."},{"content":"This makes your code easier to read.","pos":[4866,4902]},{"pos":[4911,4934],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"There is always a potential risk in allowing a procedure to change the value underlying an argument in the calling code.","pos":[4938,5058]},{"content":"Make sure you expect this value to be changed, and be prepared to check it for validity before using it.","pos":[5059,5163]},{"pos":[5172,5180],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5184,5208],"content":"<bpt id=\"p1\">[</bpt>Procedures<ept id=\"p1\">](./index.md)</ept>","source":"[Procedures](./index.md)"},{"pos":[5211,5288],"content":"<bpt id=\"p1\">[</bpt>Procedure Parameters and Arguments<ept id=\"p1\">](./procedure-parameters-and-arguments.md)</ept>","source":"[Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)"},{"pos":[5291,5373],"content":"<bpt id=\"p1\">[</bpt>How to: Pass Arguments to a Procedure<ept id=\"p1\">](./how-to-pass-arguments-to-a-procedure.md)</ept>","source":"[How to: Pass Arguments to a Procedure](./how-to-pass-arguments-to-a-procedure.md)"},{"pos":[5376,5471],"content":"<bpt id=\"p1\">[</bpt>Passing Arguments by Value and by Reference<ept id=\"p1\">](./passing-arguments-by-value-and-by-reference.md)</ept>","source":"[Passing Arguments by Value and by Reference](./passing-arguments-by-value-and-by-reference.md)"},{"pos":[5474,5599],"content":"<bpt id=\"p1\">[</bpt>Differences Between Modifiable and Nonmodifiable Arguments<ept id=\"p1\">](./differences-between-modifiable-and-nonmodifiable-arguments.md)</ept>","source":"[Differences Between Modifiable and Nonmodifiable Arguments](./differences-between-modifiable-and-nonmodifiable-arguments.md)"},{"pos":[5602,5741],"content":"<bpt id=\"p1\">[</bpt>Differences Between Passing an Argument By Value and By Reference<ept id=\"p1\">](./differences-between-passing-an-argument-by-value-and-by-reference.md)</ept>","source":"[Differences Between Passing an Argument By Value and By Reference](./differences-between-passing-an-argument-by-value-and-by-reference.md)"},{"pos":[5744,5868],"content":"<bpt id=\"p1\">[</bpt>How to: Protect a Procedure Argument Against Value Changes<ept id=\"p1\">](./how-to-protect-a-procedure-argument-against-value-changes.md)</ept>","source":"[How to: Protect a Procedure Argument Against Value Changes](./how-to-protect-a-procedure-argument-against-value-changes.md)"},{"pos":[5871,5973],"content":"<bpt id=\"p1\">[</bpt>How to: Force an Argument to Be Passed by Value<ept id=\"p1\">](./how-to-force-an-argument-to-be-passed-by-value.md)</ept>","source":"[How to: Force an Argument to Be Passed by Value](./how-to-force-an-argument-to-be-passed-by-value.md)"},{"pos":[5976,6067],"content":"<bpt id=\"p1\">[</bpt>Passing Arguments by Position and by Name<ept id=\"p1\">](./passing-arguments-by-position-and-by-name.md)</ept>","source":"[Passing Arguments by Position and by Name](./passing-arguments-by-position-and-by-name.md)"},{"pos":[6070,6211],"content":"<bpt id=\"p1\">[</bpt>Value Types and Reference Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)</ept>","source":"[Value Types and Reference Types](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)"}]}