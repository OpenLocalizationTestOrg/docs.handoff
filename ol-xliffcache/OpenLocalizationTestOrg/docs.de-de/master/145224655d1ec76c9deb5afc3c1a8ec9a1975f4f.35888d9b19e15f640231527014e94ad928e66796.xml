{"content":"---\ntitle: \"How to: Exchange Messages Within a Reliable Session\"\nms.date: \"03/30/2017\"\nms.assetid: 87cd0e75-dd2c-44c1-8da0-7b494bbdeaea\n---\n\n# How to: Exchange Messages Within a Reliable Session\n\nThis topic outlines the steps required to enable a reliable session using one of the system-provided bindings that support such a session, but not by default. You enable a reliable session imperatively using code or declaratively in your configuration file. This procedure uses the client and service configuration files to enable the reliable session and to stipulate that the messages arrive in the same order in which they were sent.\n\nThe key part of this procedure is that the endpoint configuration element contain a `bindingConfiguration` attribute that references a binding configuration named `Binding1`. The [**\\<binding>**](../../../../docs/framework/misc/binding.md) configuration element references this name to enable reliable sessions by setting the `enabled` attribute of the [**\\<reliableSession>**](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms731302(v=vs.100)) element to `true`. You specify the ordered delivery assurances for the reliable session by setting the `ordered` attribute to `true`.\n\nFor the source copy of this example, see [WS Reliable Session](../../../../docs/framework/wcf/samples/ws-reliable-session.md).\n\n### Configure the service with a WSHttpBinding to use a reliable session\n\n1. Define a service contract for the type of service.\n\n   [!code-csharp[c_HowTo_UseReliableSession#1121](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_usereliablesession/cs/service.cs#1121)]\n\n1. Implement the service contract in a service class. Note that the address or binding information isn't specified inside the implementation of the service. You aren't required to write code to retrieve the address or binding information from the configuration file.\n\n   [!code-csharp[c_HowTo_UseReliableSession#1122](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_usereliablesession/cs/service.cs#1122)]\n\n1. Create a *Web.config* file to configure an endpoint for the `CalculatorService` that uses the <xref:System.ServiceModel.WSHttpBinding> with reliable session enabled and ordered delivery of messages required.\n\n   [!code-xml[c_HowTo_UseReliableSession#2111](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_usereliablesession/common/web.config#2111)]\n\n1. Create a *Service.svc* file that contains the line:\n\n   ```\n   <%@ServiceHost language=c# Service=\"CalculatorService\" %>\n   ```\n\n1.  Place the *Service.svc* file in your Internet Information Services (IIS) virtual directory.\n\n### Configure the client with a WSHttpBinding to use a reliable session\n\n1. Use the [ServiceModel Metadata Utility Tool (*Svcutil.exe*)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) from the command line to generate code from service metadata:\n\n   ```console\n   Svcutil.exe <service's Metadata Exchange (MEX) address or HTTP GET address>\n   ```\n\n1. The generated client contains the `ICalculator` interface that defines the service contract that the client implementation must satisfy.\n\n   [!code-csharp[C_HowTo_UseReliableSession#1221](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_usereliablesession/cs/client.cs#1221)]\n\n1. The generated client application also contains the implementation of the `ClientCalculator`. Note that the address and binding information isn't specified anywhere inside the implementation of the service. You aren't required to write code to retrieve the address or binding information from the configuration file.\n\n   [!code-csharp[C_HowTo_UseReliableSession#1222](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_usereliablesession/cs/client.cs#1222)]\n\n1. *Svcutil.exe* also generates the configuration for the client that uses the <xref:System.ServiceModel.WSHttpBinding> class. Name the configuration file *App.config* when using Visual Studio.\n\n   [!code-xml[C_HowTo_UseReliableSession#2211](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_usereliablesession/common/app.config#2211)]\n\n1. Create an instance of the `ClientCalculator` in an application and call the service operations.\n\n   [!code-csharp[C_HowTo_UseReliableSession#1223](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_usereliablesession/cs/client.cs#1223)]\n\n1. Compile and run the client.\n\n## Example\n\nSeveral of the system-provided bindings support reliable sessions by default. These include:\n\n- <xref:System.ServiceModel.WSDualHttpBinding>\n\n- <xref:System.ServiceModel.NetNamedPipeBinding>\n\n- <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>\n\nFor an example of how to create a custom binding that supports reliable sessions, see [How to: Create a Custom Reliable Session Binding with HTTPS](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-reliable-session-binding-with-https.md).\n\n## See also\n\n- [Reliable Sessions](../../../../docs/framework/wcf/feature-details/reliable-sessions.md)\n","nodes":[{"pos":[4,135],"embed":true,"restype":"x-metadata","content":"title: \"How to: Exchange Messages Within a Reliable Session\"\nms.date: \"03/30/2017\"\nms.assetid: 87cd0e75-dd2c-44c1-8da0-7b494bbdeaea","nodes":[{"content":"How to: Exchange Messages Within a Reliable Session","nodes":[{"pos":[0,51],"content":"How to: Exchange Messages Within a Reliable Session","nodes":[{"content":"How to: Exchange Messages Within a Reliable Session","pos":[0,51]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[143,194],"content":"How to: Exchange Messages Within a Reliable Session","linkify":"How to: Exchange Messages Within a Reliable Session","nodes":[{"content":"How to: Exchange Messages Within a Reliable Session","pos":[0,51]}]},{"content":"This topic outlines the steps required to enable a reliable session using one of the system-provided bindings that support such a session, but not by default.","pos":[196,354]},{"content":"You enable a reliable session imperatively using code or declaratively in your configuration file.","pos":[355,453]},{"content":"This procedure uses the client and service configuration files to enable the reliable session and to stipulate that the messages arrive in the same order in which they were sent.","pos":[454,632]},{"content":"The key part of this procedure is that the endpoint configuration element contain a <ph id=\"ph1\">`bindingConfiguration`</ph> attribute that references a binding configuration named <ph id=\"ph2\">`Binding1`</ph>.","pos":[634,808],"source":"The key part of this procedure is that the endpoint configuration element contain a `bindingConfiguration` attribute that references a binding configuration named `Binding1`."},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt><ph id=\"ph1\">\\&lt;</ph>binding&gt;<ept id=\"p2\">**</ept><ept id=\"p1\">](../../../../docs/framework/misc/binding.md)</ept> configuration element references this name to enable reliable sessions by setting the <ph id=\"ph2\">`enabled`</ph> attribute of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt><ph id=\"ph3\">\\&lt;</ph>reliableSession&gt;<ept id=\"p4\">**</ept><ept id=\"p3\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms731302(v=vs.100))</ept> element to <ph id=\"ph4\">`true`</ph>.","pos":[809,1119],"source":" The [**\\<binding>**](../../../../docs/framework/misc/binding.md) configuration element references this name to enable reliable sessions by setting the `enabled` attribute of the [**\\<reliableSession>**](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms731302(v=vs.100)) element to `true`."},{"content":"You specify the ordered delivery assurances for the reliable session by setting the <ph id=\"ph1\">`ordered`</ph> attribute to <ph id=\"ph2\">`true`</ph>.","pos":[1120,1234],"source":" You specify the ordered delivery assurances for the reliable session by setting the `ordered` attribute to `true`."},{"pos":[1236,1362],"content":"For the source copy of this example, see <bpt id=\"p1\">[</bpt>WS Reliable Session<ept id=\"p1\">](../../../../docs/framework/wcf/samples/ws-reliable-session.md)</ept>.","source":"For the source copy of this example, see [WS Reliable Session](../../../../docs/framework/wcf/samples/ws-reliable-session.md)."},{"pos":[1368,1436],"content":"Configure the service with a WSHttpBinding to use a reliable session","linkify":"Configure the service with a WSHttpBinding to use a reliable session","nodes":[{"content":"Configure the service with a WSHttpBinding to use a reliable session","pos":[0,68]}]},{"content":"Define a service contract for the type of service.","pos":[1441,1491]},{"content":"Implement the service contract in a service class.","pos":[1647,1697]},{"content":"Note that the address or binding information isn't specified inside the implementation of the service.","pos":[1698,1800]},{"content":"You aren't required to write code to retrieve the address or binding information from the configuration file.","pos":[1801,1910]},{"pos":[2066,2273],"content":"Create a <bpt id=\"p1\">*</bpt>Web.config<ept id=\"p1\">*</ept> file to configure an endpoint for the <ph id=\"ph1\">`CalculatorService`</ph> that uses the <ph id=\"ph2\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> with reliable session enabled and ordered delivery of messages required.","source":"Create a *Web.config* file to configure an endpoint for the `CalculatorService` that uses the <xref:System.ServiceModel.WSHttpBinding> with reliable session enabled and ordered delivery of messages required."},{"pos":[2430,2481],"content":"Create a <bpt id=\"p1\">*</bpt>Service.svc<ept id=\"p1\">*</ept> file that contains the line:","source":"Create a *Service.svc* file that contains the line:"},{"pos":[2563,2654],"content":"Place the <bpt id=\"p1\">*</bpt>Service.svc<ept id=\"p1\">*</ept> file in your Internet Information Services (IIS) virtual directory.","source":"Place the *Service.svc* file in your Internet Information Services (IIS) virtual directory."},{"pos":[2660,2727],"content":"Configure the client with a WSHttpBinding to use a reliable session","linkify":"Configure the client with a WSHttpBinding to use a reliable session","nodes":[{"content":"Configure the client with a WSHttpBinding to use a reliable session","pos":[0,67]}]},{"pos":[2732,2936],"content":"Use the <bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (<bpt id=\"p2\">*</bpt>Svcutil.exe<ept id=\"p2\">*</ept>)<ept id=\"p1\">](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept> from the command line to generate code from service metadata:","source":"Use the [ServiceModel Metadata Utility Tool (*Svcutil.exe*)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) from the command line to generate code from service metadata:"},{"pos":[3042,3178],"content":"The generated client contains the <ph id=\"ph1\">`ICalculator`</ph> interface that defines the service contract that the client implementation must satisfy.","source":"The generated client contains the `ICalculator` interface that defines the service contract that the client implementation must satisfy."},{"content":"The generated client application also contains the implementation of the <ph id=\"ph1\">`ClientCalculator`</ph>.","pos":[3333,3425],"source":"The generated client application also contains the implementation of the `ClientCalculator`."},{"content":"Note that the address and binding information isn't specified anywhere inside the implementation of the service.","pos":[3426,3538]},{"content":"You aren't required to write code to retrieve the address or binding information from the configuration file.","pos":[3539,3648]},{"content":"<bpt id=\"p1\">*</bpt>Svcutil.exe<ept id=\"p1\">*</ept> also generates the configuration for the client that uses the <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> class.","pos":[3803,3926],"source":"*Svcutil.exe* also generates the configuration for the client that uses the <xref:System.ServiceModel.WSHttpBinding> class."},{"content":"Name the configuration file <bpt id=\"p1\">*</bpt>App.config<ept id=\"p1\">*</ept> when using Visual Studio.","pos":[3927,3993],"source":" Name the configuration file *App.config* when using Visual Studio."},{"pos":[4150,4245],"content":"Create an instance of the <ph id=\"ph1\">`ClientCalculator`</ph> in an application and call the service operations.","source":"Create an instance of the `ClientCalculator` in an application and call the service operations."},{"content":"Compile and run the client.","pos":[4400,4427]},{"pos":[4432,4439],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"Several of the system-provided bindings support reliable sessions by default.","pos":[4441,4518]},{"content":"These include:","pos":[4519,4533]},{"pos":[4702,4960],"content":"For an example of how to create a custom binding that supports reliable sessions, see <bpt id=\"p1\">[</bpt>How to: Create a Custom Reliable Session Binding with HTTPS<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-reliable-session-binding-with-https.md)</ept>.","source":"For an example of how to create a custom binding that supports reliable sessions, see [How to: Create a Custom Reliable Session Binding with HTTPS](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-reliable-session-binding-with-https.md)."},{"pos":[4965,4973],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4977,5065],"content":"<bpt id=\"p1\">[</bpt>Reliable Sessions<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/reliable-sessions.md)</ept>","source":"[Reliable Sessions](../../../../docs/framework/wcf/feature-details/reliable-sessions.md)"}]}