{"content":"---\ntitle: \"Walkthrough: Creating a Professionally Styled ToolStrip Control\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"ToolStripProfessionalRenderer class [Windows Forms]\"\n  - \"ToolStripRenderer class [Windows Forms]\"\n  - \"toolbars [Windows Forms], walkthroughs\"\n  - \"ToolStrip control [Windows Forms], creating professionally styled controls\"\nms.assetid: b52339ae-f1d3-494e-996e-eb455614098a\n---\n# Walkthrough: Creating a Professionally Styled ToolStrip Control\nYou can give your application’s <xref:System.Windows.Forms.ToolStrip> controls a professional appearance and behavior by writing your own class derived from the <xref:System.Windows.Forms.ToolStripProfessionalRenderer> type.  \n  \n This walkthrough demonstrates how to use <xref:System.Windows.Forms.ToolStrip> controls to create a composite control that resembles the **Navigation Pane** provided by Microsoft® Outlook®. The following tasks are illustrated in this walkthrough:  \n  \n-   Creating a Windows Control Library project.  \n  \n-   Designing the StackView Control.  \n  \n-   Implementing a Custom Renderer.  \n  \n When you are finished, you will have a reusable custom client control with the professional appearance of a Microsoft Office® XP control.  \n  \n To copy the code in this topic as a single listing, see [How to: Create a Professionally Styled ToolStrip Control](how-to-create-a-professionally-styled-toolstrip-control.md).  \n  \n> [!NOTE]\n>  The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).  \n  \n## Prerequisites  \n In order to complete this walkthrough, you will need:  \n  \n-   Sufficient permissions to be able to create and run Windows Forms application projects on the computer where Visual Studio is installed.  \n  \n## Creating a Windows Control Library Project  \n The first step is to create the control library project.  \n  \n#### To create the control library project  \n  \n1.  Create a new Windows Control Library project named `StackViewLibrary`.  \n  \n2.  In **Solution Explorer**, delete the project's default control by deleting the source file named \"UserControl1.cs\" or \"UserControl1.vb\", depending on your language of choice.  \n  \n     For more information, see [How to: Remove, Delete, and Exclude Items](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/0ebzhwsk(v=vs.100)).  \n  \n3.  Add a new <xref:System.Windows.Forms.UserControl> item to the **StackViewLibrary** project. Give the new source file a base name of `StackView`.  \n  \n## Designing the StackView Control  \n The `StackView` control is a composite control with one child <xref:System.Windows.Forms.ToolStrip> control. For more information about composite controls, see [Varieties of Custom Controls](varieties-of-custom-controls.md).  \n  \n#### To design the StackView control  \n  \n1.  From the **Toolbox**, drag a <xref:System.Windows.Forms.ToolStrip> control to the design surface.  \n  \n2.  In the **Properties** window, set the <xref:System.Windows.Forms.ToolStrip> control's properties according to the following table.  \n  \n    |Property|Value|  \n    |--------------|-----------|  \n    |Name|`stackStrip`|  \n    |CanOverflow|`false`|  \n    |Dock|<xref:System.Windows.Forms.DockStyle.Bottom>|  \n    |Font|`Tahoma, 10pt, style=Bold`|  \n    |GripStyle|<xref:System.Windows.Forms.ToolStripGripStyle.Hidden>|  \n    |LayoutStyle|<xref:System.Windows.Forms.ToolStripLayoutStyle.VerticalStackWithOverflow>|  \n    |Padding|`0, 7, 0, 0`|  \n    |RenderMode|<xref:System.Windows.Forms.ToolStripRenderMode.Professional>|  \n  \n3.  In the Windows Forms Designer, click the <xref:System.Windows.Forms.ToolStrip> control's **Add** button and add a <xref:System.Windows.Forms.ToolStripButton> to the `stackStrip` control.  \n  \n4.  In the **Properties** window, set the <xref:System.Windows.Forms.ToolStripButton> control's properties according to the following table.  \n  \n    |Property|Value|  \n    |--------------|-----------|  \n    |Name|`mailStackButton`|  \n    |CheckOnClick|true|  \n    |CheckState|<xref:System.Windows.Forms.CheckState.Checked>|  \n    |DisplayStyle|<xref:System.Windows.Forms.ToolStripItemDisplayStyle.ImageAndText>|  \n    |ImageAlign|<xref:System.Drawing.ContentAlignment.MiddleLeft>|  \n    |ImageScaling|<xref:System.Windows.Forms.ToolStripItemImageScaling.None>|  \n    |ImageTransparentColor|`238, 238, 238`|  \n    |Margin|`0, 0, 0, 0`|  \n    |Padding|`3, 3, 3, 3`|  \n    |Text|**Mail**|  \n    |TextAlign|<xref:System.Drawing.ContentAlignment.MiddleLeft>|  \n  \n5.  Repeat step 7 for three more <xref:System.Windows.Forms.ToolStripButton> controls.  \n  \n     Name the controls `calendarStackButton`, `contactsStackButton`, and `tasksStackButton`. Set the value of the <xref:System.Windows.Forms.Control.Text%2A> property to **Calendar**, **Contacts**, and **Tasks**, respectively.  \n  \n## Handling Events  \n Two events are important to make the `StackView` control behave correctly. Handle the <xref:System.Windows.Forms.UserControl.Load> event to position the control correctly. Handle the <xref:System.Windows.Forms.ToolStripItem.Click> event for each <xref:System.Windows.Forms.ToolStripButton> to give the `StackView` control state behavior similar to the <xref:System.Windows.Forms.RadioButton> control.  \n  \n#### To handle events  \n  \n1.  In the Windows Forms Designer, select the `StackView` control.  \n  \n2.  In the **Properties** window, click **Events**.  \n  \n3.  Double-click the Load event to generate the `StackView_Load` event handler.  \n  \n4.  In the `StackView_Load` event handler, copy and paste the following code.  \n  \n     [!code-csharp[System.Windows.Forms.ToolStrip.StackView#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#3)]\n     [!code-vb[System.Windows.Forms.ToolStrip.StackView#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#3)]  \n  \n5.  In the Windows Forms Designer, select the `mailStackButton` control.  \n  \n6.  In the **Properties** window, click **Events**.  \n  \n7.  Double-click the Click event.  \n  \n     The Windows Forms Designer generates the `mailStackButton_Click` event handler.  \n  \n8.  Rename the `mailStackButton_Click` event handler to `stackButton_Click`.  \n  \n     For more information, see [Rename a code symbol refactoring](/visualstudio/ide/reference/rename).  \n  \n9. Insert the following code into the `stackButton_Click` event handler.  \n  \n     [!code-csharp[System.Windows.Forms.ToolStrip.StackView#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#4)]\n     [!code-vb[System.Windows.Forms.ToolStrip.StackView#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#4)]  \n  \n10. In the Windows Forms Designer, select the `calendarStackButton` control.  \n  \n11. In the **Properties** window, set the Click event to the `stackButton_Click` event handler.  \n  \n12. Repeat steps 10 and 11 for the `contactsStackButton` and `tasksStackButton` controls.  \n  \n## Defining Icons  \n Each `StackView` button has an associated icon. For convenience, each icon is represented as a Base64-encoded string, which is deserialized before a <xref:System.Drawing.Bitmap> is created from it. In a production environment, you store bitmap data as a resource, and your icons appear in the Windows Forms Designer. For more information, see [How to: Add Background Images to Windows Forms](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/dff9f95f(v=vs.100)).  \n  \n#### To define icons  \n  \n1.  In the Code Editor, insert the following code into the `StackView` class definition. This code initializes the bitmaps for the <xref:System.Windows.Forms.ToolStripButton> icons.  \n  \n     [!code-csharp[System.Windows.Forms.ToolStrip.StackView#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#2)]\n     [!code-vb[System.Windows.Forms.ToolStrip.StackView#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#2)]  \n  \n2.  Add a call to the `InitializeImages` method in the `StackView` class constructor.  \n  \n     [!code-csharp[System.Windows.Forms.ToolStrip.StackView#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#5)]\n     [!code-vb[System.Windows.Forms.ToolStrip.StackView#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#5)]  \n  \n## Implementing a Custom Renderer  \n You can customize most elements of the `StackView` control my implementing a class that derives from the <xref:System.Windows.Forms.ToolStripRenderer> class. In this procedure, you will implement a <xref:System.Windows.Forms.ToolStripProfessionalRenderer> class that customizes the grip and draws gradient backgrounds for the <xref:System.Windows.Forms.ToolStripButton> controls.  \n  \n#### To implement a custom renderer  \n  \n1.  Insert the following code into the `StackView` control definition.  \n  \n     This is the definition for the `StackRenderer` class, which overrides the <xref:System.Windows.Forms.ToolStripRenderer.RenderGrip>, <xref:System.Windows.Forms.ToolStripRenderer.RenderToolStripBorder>, and <xref:System.Windows.Forms.ToolStripRenderer.RenderButtonBackground> methods to produce a custom appearance.  \n  \n     [!code-csharp[System.Windows.Forms.ToolStrip.StackView#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#10)]\n     [!code-vb[System.Windows.Forms.ToolStrip.StackView#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#10)]  \n  \n2.  In the `StackView` control's constructor, create a new instance of the `StackRenderer` class and assign this instance to the `stackStrip` control's <xref:System.Windows.Forms.ToolStrip.Renderer%2A> property.  \n  \n     [!code-csharp[System.Windows.Forms.ToolStrip.StackView#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#5)]\n     [!code-vb[System.Windows.Forms.ToolStrip.StackView#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#5)]  \n  \n## Testing the StackView Control  \n The `StackView` control derives from the <xref:System.Windows.Forms.UserControl> class. Therefore, you can test the control with the **UserControl Test Container**. For more information, see [How to: Test the Run-Time Behavior of a UserControl](how-to-test-the-run-time-behavior-of-a-usercontrol.md).  \n  \n#### To test the StackView control  \n  \n1.  Press F5 to build the project and start the **UserControl Test Container**.  \n  \n2.  Move the pointer over the buttons of the `StackView` control, and then click a button to see the appearance of its selected state.  \n  \n## Next Steps  \n In this walkthrough, you have created a reusable custom client control with the professional appearance of an Office XP control. You can use the <xref:System.Windows.Forms.ToolStrip> family of controls for many other purposes:  \n  \n-   Create shortcut menus for your controls with <xref:System.Windows.Forms.ContextMenuStrip>. For more information, see [ContextMenu Component Overview](contextmenu-component-overview-windows-forms.md).  \n  \n-   Create a form with an automatically populated standard menu. For more information, see [Walkthrough: Providing Standard Menu Items to a Form](walkthrough-providing-standard-menu-items-to-a-form.md).  \n  \n-   Create a multiple document interface (MDI) form with docking <xref:System.Windows.Forms.ToolStrip> controls. For more information, see [How to: Create an MDI Form with Menu Merging and ToolStrip Controls](how-to-create-an-mdi-form-with-menu-merging-and-toolstrip-controls.md).  \n  \n## See also\n\n- <xref:System.Windows.Forms.MenuStrip>\n- <xref:System.Windows.Forms.ToolStrip>\n- <xref:System.Windows.Forms.StatusStrip>\n- [ToolStrip Control](toolstrip-control-windows-forms.md)\n- [How to: Provide Standard Menu Items to a Form](how-to-provide-standard-menu-items-to-a-form.md)\n","nodes":[{"pos":[4,433],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Creating a Professionally Styled ToolStrip Control\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"ToolStripProfessionalRenderer class [Windows Forms]\"\n  - \"ToolStripRenderer class [Windows Forms]\"\n  - \"toolbars [Windows Forms], walkthroughs\"\n  - \"ToolStrip control [Windows Forms], creating professionally styled controls\"\nms.assetid: b52339ae-f1d3-494e-996e-eb455614098a","nodes":[{"content":"Walkthrough: Creating a Professionally Styled ToolStrip Control","nodes":[{"pos":[0,63],"content":"Walkthrough: Creating a Professionally Styled ToolStrip Control","nodes":[{"content":"Walkthrough: Creating a Professionally Styled ToolStrip Control","pos":[0,63]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[440,503],"content":"Walkthrough: Creating a Professionally Styled ToolStrip Control","linkify":"Walkthrough: Creating a Professionally Styled ToolStrip Control","nodes":[{"content":"Walkthrough: Creating a Professionally Styled ToolStrip Control","pos":[0,63]}]},{"pos":[504,728],"content":"You can give your application’s <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> controls a professional appearance and behavior by writing your own class derived from the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripProfessionalRenderer&gt;</ph> type.","source":"You can give your application’s <xref:System.Windows.Forms.ToolStrip> controls a professional appearance and behavior by writing your own class derived from the <xref:System.Windows.Forms.ToolStripProfessionalRenderer> type."},{"content":"This walkthrough demonstrates how to use <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> controls to create a composite control that resembles the <bpt id=\"p1\">**</bpt>Navigation Pane<ept id=\"p1\">**</ept> provided by Microsoft® Outlook®.","pos":[735,924],"source":"This walkthrough demonstrates how to use <xref:System.Windows.Forms.ToolStrip> controls to create a composite control that resembles the **Navigation Pane** provided by Microsoft® Outlook®."},{"content":"The following tasks are illustrated in this walkthrough:","pos":[925,981]},{"content":"Creating a Windows Control Library project.","pos":[991,1034]},{"content":"Designing the StackView Control.","pos":[1044,1076]},{"content":"Implementing a Custom Renderer.","pos":[1086,1117]},{"content":"When you are finished, you will have a reusable custom client control with the professional appearance of a Microsoft Office® XP control.","pos":[1124,1261]},{"pos":[1268,1443],"content":"To copy the code in this topic as a single listing, see <bpt id=\"p1\">[</bpt>How to: Create a Professionally Styled ToolStrip Control<ept id=\"p1\">](how-to-create-a-professionally-styled-toolstrip-control.md)</ept>.","source":"To copy the code in this topic as a single listing, see [How to: Create a Professionally Styled ToolStrip Control](how-to-create-a-professionally-styled-toolstrip-control.md)."},{"pos":[1451,1796],"content":"[!NOTE]\n The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).","leadings":["","> "],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).","pos":[9,343],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition.","pos":[0,130]},{"content":"To change your settings, choose <bpt id=\"p1\">**</bpt>Import and Export Settings<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Tools<ept id=\"p2\">**</ept> menu.","pos":[131,216],"source":" To change your settings, choose **Import and Export Settings** on the **Tools** menu."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Personalize the Visual Studio IDE<ept id=\"p1\">](/visualstudio/ide/personalizing-the-visual-studio-ide)</ept>.","pos":[217,334],"source":" For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide)."}]}]},{"pos":[1805,1818],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"In order to complete this walkthrough, you will need:","pos":[1822,1875]},{"content":"Sufficient permissions to be able to create and run Windows Forms application projects on the computer where Visual Studio is installed.","pos":[1885,2021]},{"pos":[2030,2072],"content":"Creating a Windows Control Library Project","linkify":"Creating a Windows Control Library Project","nodes":[{"content":"Creating a Windows Control Library Project","pos":[0,42]}]},{"content":"The first step is to create the control library project.","pos":[2076,2132]},{"pos":[2143,2180],"content":"To create the control library project","linkify":"To create the control library project","nodes":[{"content":"To create the control library project","pos":[0,37]}]},{"pos":[2190,2260],"content":"Create a new Windows Control Library project named <ph id=\"ph1\">`StackViewLibrary`</ph>.","source":"Create a new Windows Control Library project named `StackViewLibrary`."},{"pos":[2270,2444],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, delete the project's default control by deleting the source file named \"UserControl1.cs\" or \"UserControl1.vb\", depending on your language of choice.","source":"In **Solution Explorer**, delete the project's default control by deleting the source file named \"UserControl1.cs\" or \"UserControl1.vb\", depending on your language of choice."},{"pos":[2455,2622],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Remove, Delete, and Exclude Items<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/0ebzhwsk(v=vs.100))</ept>.","source":"For more information, see [How to: Remove, Delete, and Exclude Items](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/0ebzhwsk(v=vs.100))."},{"content":"Add a new <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> item to the <bpt id=\"p1\">**</bpt>StackViewLibrary<ept id=\"p1\">**</ept> project.","pos":[2632,2723],"source":"Add a new <xref:System.Windows.Forms.UserControl> item to the **StackViewLibrary** project."},{"content":"Give the new source file a base name of <ph id=\"ph1\">`StackView`</ph>.","pos":[2724,2776],"source":" Give the new source file a base name of `StackView`."},{"pos":[2785,2816],"content":"Designing the StackView Control","linkify":"Designing the StackView Control","nodes":[{"content":"Designing the StackView Control","pos":[0,31]}]},{"content":"The <ph id=\"ph1\">`StackView`</ph> control is a composite control with one child <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> control.","pos":[2820,2928],"source":"The `StackView` control is a composite control with one child <xref:System.Windows.Forms.ToolStrip> control."},{"content":"For more information about composite controls, see <bpt id=\"p1\">[</bpt>Varieties of Custom Controls<ept id=\"p1\">](varieties-of-custom-controls.md)</ept>.","pos":[2929,3044],"source":" For more information about composite controls, see [Varieties of Custom Controls](varieties-of-custom-controls.md)."},{"pos":[3055,3086],"content":"To design the StackView control","linkify":"To design the StackView control","nodes":[{"content":"To design the StackView control","pos":[0,31]}]},{"pos":[3096,3193],"content":"From the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, drag a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> control to the design surface.","source":"From the **Toolbox**, drag a <xref:System.Windows.Forms.ToolStrip> control to the design surface."},{"pos":[3203,3333],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> control's properties according to the following table.","source":"In the **Properties** window, set the <xref:System.Windows.Forms.ToolStrip> control's properties according to the following table."},{"content":"Property","pos":[3344,3352]},{"content":"Value","pos":[3353,3358]},{"content":"Name","pos":[3402,3406]},{"content":"CanOverflow","pos":[3428,3439]},{"content":"Dock","pos":[3456,3460]},{"content":"Font","pos":[3514,3518]},{"content":"GripStyle","pos":[3554,3563]},{"content":"LayoutStyle","pos":[3626,3637]},{"content":"Padding","pos":[3721,3728]},{"content":"RenderMode","pos":[3750,3760]},{"pos":[3832,4018],"content":"In the Windows Forms Designer, click the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> control's <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> button and add a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripButton&gt;</ph> to the <ph id=\"ph3\">`stackStrip`</ph> control.","source":"In the Windows Forms Designer, click the <xref:System.Windows.Forms.ToolStrip> control's **Add** button and add a <xref:System.Windows.Forms.ToolStripButton> to the `stackStrip` control."},{"pos":[4028,4164],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripButton&gt;</ph> control's properties according to the following table.","source":"In the **Properties** window, set the <xref:System.Windows.Forms.ToolStripButton> control's properties according to the following table."},{"content":"Property","pos":[4175,4183]},{"content":"Value","pos":[4184,4189]},{"content":"Name","pos":[4233,4237]},{"content":"CheckOnClick","pos":[4264,4276]},{"content":"true","pos":[4277,4281]},{"content":"CheckState","pos":[4290,4300]},{"content":"DisplayStyle","pos":[4356,4368]},{"content":"ImageAlign","pos":[4444,4454]},{"content":"ImageScaling","pos":[4513,4525]},{"content":"ImageTransparentColor","pos":[4593,4614]},{"content":"Margin","pos":[4639,4645]},{"content":"Padding","pos":[4667,4674]},{"content":"Text","pos":[4696,4700]},{"pos":[4701,4709],"content":"<bpt id=\"p1\">**</bpt>Mail<ept id=\"p1\">**</ept>","source":"**Mail**"},{"content":"TextAlign","pos":[4718,4727]},{"pos":[4788,4870],"content":"Repeat step 7 for three more <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripButton&gt;</ph> controls.","source":"Repeat step 7 for three more <xref:System.Windows.Forms.ToolStripButton> controls."},{"content":"Name the controls <ph id=\"ph1\">`calendarStackButton`</ph>, <ph id=\"ph2\">`contactsStackButton`</ph>, and <ph id=\"ph3\">`tasksStackButton`</ph>.","pos":[4881,4968],"source":"Name the controls `calendarStackButton`, `contactsStackButton`, and `tasksStackButton`."},{"content":"Set the value of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Text%2A&gt;</ph> property to <bpt id=\"p1\">**</bpt>Calendar<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Contacts<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>Tasks<ept id=\"p3\">**</ept>, respectively.","pos":[4969,5102],"source":" Set the value of the <xref:System.Windows.Forms.Control.Text%2A> property to **Calendar**, **Contacts**, and **Tasks**, respectively."},{"pos":[5111,5126],"content":"Handling Events","linkify":"Handling Events","nodes":[{"content":"Handling Events","pos":[0,15]}]},{"content":"Two events are important to make the <ph id=\"ph1\">`StackView`</ph> control behave correctly.","pos":[5130,5204],"source":"Two events are important to make the `StackView` control behave correctly."},{"content":"Handle the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl.Load&gt;</ph> event to position the control correctly.","pos":[5205,5301],"source":" Handle the <xref:System.Windows.Forms.UserControl.Load> event to position the control correctly."},{"content":"Handle the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripItem.Click&gt;</ph> event for each <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripButton&gt;</ph> to give the <ph id=\"ph3\">`StackView`</ph> control state behavior similar to the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.RadioButton&gt;</ph> control.","pos":[5302,5530],"source":" Handle the <xref:System.Windows.Forms.ToolStripItem.Click> event for each <xref:System.Windows.Forms.ToolStripButton> to give the `StackView` control state behavior similar to the <xref:System.Windows.Forms.RadioButton> control."},{"pos":[5541,5557],"content":"To handle events","linkify":"To handle events","nodes":[{"content":"To handle events","pos":[0,16]}]},{"pos":[5567,5629],"content":"In the Windows Forms Designer, select the <ph id=\"ph1\">`StackView`</ph> control.","source":"In the Windows Forms Designer, select the `StackView` control."},{"pos":[5639,5686],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, click <bpt id=\"p2\">**</bpt>Events<ept id=\"p2\">**</ept>.","source":"In the **Properties** window, click **Events**."},{"pos":[5696,5771],"content":"Double-click the Load event to generate the <ph id=\"ph1\">`StackView_Load`</ph> event handler.","source":"Double-click the Load event to generate the `StackView_Load` event handler."},{"pos":[5781,5854],"content":"In the <ph id=\"ph1\">`StackView_Load`</ph> event handler, copy and paste the following code.","source":"In the `StackView_Load` event handler, copy and paste the following code."},{"pos":[5865,6202],"content":"[!code-csharp[System.Windows.Forms.ToolStrip.StackView#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#3)]\n [!code-vb[System.Windows.Forms.ToolStrip.StackView#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#3)]","leadings":["","    "],"nodes":[]},{"pos":[6212,6280],"content":"In the Windows Forms Designer, select the <ph id=\"ph1\">`mailStackButton`</ph> control.","source":"In the Windows Forms Designer, select the `mailStackButton` control."},{"pos":[6290,6337],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, click <bpt id=\"p2\">**</bpt>Events<ept id=\"p2\">**</ept>.","source":"In the **Properties** window, click **Events**."},{"content":"Double-click the Click event.","pos":[6347,6376]},{"pos":[6387,6466],"content":"The Windows Forms Designer generates the <ph id=\"ph1\">`mailStackButton_Click`</ph> event handler.","source":"The Windows Forms Designer generates the `mailStackButton_Click` event handler."},{"pos":[6476,6548],"content":"Rename the <ph id=\"ph1\">`mailStackButton_Click`</ph> event handler to <ph id=\"ph2\">`stackButton_Click`</ph>.","source":"Rename the `mailStackButton_Click` event handler to `stackButton_Click`."},{"pos":[6559,6656],"content":"For more information, see <bpt id=\"p1\">[</bpt>Rename a code symbol refactoring<ept id=\"p1\">](/visualstudio/ide/reference/rename)</ept>.","source":"For more information, see [Rename a code symbol refactoring](/visualstudio/ide/reference/rename)."},{"pos":[6665,6734],"content":"Insert the following code into the <ph id=\"ph1\">`stackButton_Click`</ph> event handler.","source":"Insert the following code into the `stackButton_Click` event handler."},{"pos":[6745,7082],"content":"[!code-csharp[System.Windows.Forms.ToolStrip.StackView#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#4)]\n  [!code-vb[System.Windows.Forms.ToolStrip.StackView#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#4)]","leadings":["","   "],"nodes":[]},{"pos":[7092,7164],"content":"In the Windows Forms Designer, select the <ph id=\"ph1\">`calendarStackButton`</ph> control.","source":"In the Windows Forms Designer, select the `calendarStackButton` control."},{"pos":[7174,7265],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set the Click event to the <ph id=\"ph1\">`stackButton_Click`</ph> event handler.","source":"In the **Properties** window, set the Click event to the `stackButton_Click` event handler."},{"pos":[7275,7360],"content":"Repeat steps 10 and 11 for the <ph id=\"ph1\">`contactsStackButton`</ph> and <ph id=\"ph2\">`tasksStackButton`</ph> controls.","source":"Repeat steps 10 and 11 for the `contactsStackButton` and `tasksStackButton` controls."},{"pos":[7369,7383],"content":"Defining Icons","linkify":"Defining Icons","nodes":[{"content":"Defining Icons","pos":[0,14]}]},{"content":"Each <ph id=\"ph1\">`StackView`</ph> button has an associated icon.","pos":[7387,7434],"source":"Each `StackView` button has an associated icon."},{"content":"For convenience, each icon is represented as a Base64-encoded string, which is deserialized before a <ph id=\"ph1\">&lt;xref:System.Drawing.Bitmap&gt;</ph> is created from it.","pos":[7435,7584],"source":" For convenience, each icon is represented as a Base64-encoded string, which is deserialized before a <xref:System.Drawing.Bitmap> is created from it."},{"content":"In a production environment, you store bitmap data as a resource, and your icons appear in the Windows Forms Designer.","pos":[7585,7703]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Add Background Images to Windows Forms<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/dff9f95f(v=vs.100))</ept>.","pos":[7704,7876],"source":" For more information, see [How to: Add Background Images to Windows Forms](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/dff9f95f(v=vs.100))."},{"pos":[7887,7902],"content":"To define icons","linkify":"To define icons","nodes":[{"content":"To define icons","pos":[0,15]}]},{"content":"In the Code Editor, insert the following code into the <ph id=\"ph1\">`StackView`</ph> class definition.","pos":[7912,7996],"source":"In the Code Editor, insert the following code into the `StackView` class definition."},{"content":"This code initializes the bitmaps for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripButton&gt;</ph> icons.","pos":[7997,8089],"source":" This code initializes the bitmaps for the <xref:System.Windows.Forms.ToolStripButton> icons."},{"pos":[8100,8437],"content":"[!code-csharp[System.Windows.Forms.ToolStrip.StackView#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#2)]\n [!code-vb[System.Windows.Forms.ToolStrip.StackView#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#2)]","leadings":["","    "],"nodes":[]},{"pos":[8447,8528],"content":"Add a call to the <ph id=\"ph1\">`InitializeImages`</ph> method in the <ph id=\"ph2\">`StackView`</ph> class constructor.","source":"Add a call to the `InitializeImages` method in the `StackView` class constructor."},{"pos":[8539,8876],"content":"[!code-csharp[System.Windows.Forms.ToolStrip.StackView#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#5)]\n [!code-vb[System.Windows.Forms.ToolStrip.StackView#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#5)]","leadings":["","    "],"nodes":[]},{"pos":[8885,8915],"content":"Implementing a Custom Renderer","linkify":"Implementing a Custom Renderer","nodes":[{"content":"Implementing a Custom Renderer","pos":[0,30]}]},{"content":"You can customize most elements of the <ph id=\"ph1\">`StackView`</ph> control my implementing a class that derives from the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripRenderer&gt;</ph> class.","pos":[8919,9076],"source":"You can customize most elements of the `StackView` control my implementing a class that derives from the <xref:System.Windows.Forms.ToolStripRenderer> class."},{"content":"In this procedure, you will implement a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripProfessionalRenderer&gt;</ph> class that customizes the grip and draws gradient backgrounds for the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripButton&gt;</ph> controls.","pos":[9077,9298],"source":" In this procedure, you will implement a <xref:System.Windows.Forms.ToolStripProfessionalRenderer> class that customizes the grip and draws gradient backgrounds for the <xref:System.Windows.Forms.ToolStripButton> controls."},{"pos":[9309,9339],"content":"To implement a custom renderer","linkify":"To implement a custom renderer","nodes":[{"content":"To implement a custom renderer","pos":[0,30]}]},{"pos":[9349,9415],"content":"Insert the following code into the <ph id=\"ph1\">`StackView`</ph> control definition.","source":"Insert the following code into the `StackView` control definition."},{"pos":[9426,9739],"content":"This is the definition for the <ph id=\"ph1\">`StackRenderer`</ph> class, which overrides the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripRenderer.RenderGrip&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ToolStripRenderer.RenderToolStripBorder&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Windows.Forms.ToolStripRenderer.RenderButtonBackground&gt;</ph> methods to produce a custom appearance.","source":"This is the definition for the `StackRenderer` class, which overrides the <xref:System.Windows.Forms.ToolStripRenderer.RenderGrip>, <xref:System.Windows.Forms.ToolStripRenderer.RenderToolStripBorder>, and <xref:System.Windows.Forms.ToolStripRenderer.RenderButtonBackground> methods to produce a custom appearance."},{"pos":[9750,10091],"content":"[!code-csharp[System.Windows.Forms.ToolStrip.StackView#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#10)]\n [!code-vb[System.Windows.Forms.ToolStrip.StackView#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#10)]","leadings":["","    "],"nodes":[]},{"pos":[10101,10308],"content":"In the <ph id=\"ph1\">`StackView`</ph> control's constructor, create a new instance of the <ph id=\"ph2\">`StackRenderer`</ph> class and assign this instance to the <ph id=\"ph3\">`stackStrip`</ph> control's <ph id=\"ph4\">&lt;xref:System.Windows.Forms.ToolStrip.Renderer%2A&gt;</ph> property.","source":"In the `StackView` control's constructor, create a new instance of the `StackRenderer` class and assign this instance to the `stackStrip` control's <xref:System.Windows.Forms.ToolStrip.Renderer%2A> property."},{"pos":[10319,10656],"content":"[!code-csharp[System.Windows.Forms.ToolStrip.StackView#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/CS/StackView.cs#5)]\n [!code-vb[System.Windows.Forms.ToolStrip.StackView#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ToolStrip.StackView/VB/StackView.vb#5)]","leadings":["","    "],"nodes":[]},{"pos":[10665,10694],"content":"Testing the StackView Control","linkify":"Testing the StackView Control","nodes":[{"content":"Testing the StackView Control","pos":[0,29]}]},{"content":"The <ph id=\"ph1\">`StackView`</ph> control derives from the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> class.","pos":[10698,10785],"source":"The `StackView` control derives from the <xref:System.Windows.Forms.UserControl> class."},{"content":"Therefore, you can test the control with the <bpt id=\"p1\">**</bpt>UserControl Test Container<ept id=\"p1\">**</ept>.","pos":[10786,10862],"source":" Therefore, you can test the control with the **UserControl Test Container**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Test the Run-Time Behavior of a UserControl<ept id=\"p1\">](how-to-test-the-run-time-behavior-of-a-usercontrol.md)</ept>.","pos":[10863,10998],"source":" For more information, see [How to: Test the Run-Time Behavior of a UserControl](how-to-test-the-run-time-behavior-of-a-usercontrol.md)."},{"pos":[11009,11038],"content":"To test the StackView control","linkify":"To test the StackView control","nodes":[{"content":"To test the StackView control","pos":[0,29]}]},{"pos":[11048,11123],"content":"Press F5 to build the project and start the <bpt id=\"p1\">**</bpt>UserControl Test Container<ept id=\"p1\">**</ept>.","source":"Press F5 to build the project and start the **UserControl Test Container**."},{"pos":[11133,11263],"content":"Move the pointer over the buttons of the <ph id=\"ph1\">`StackView`</ph> control, and then click a button to see the appearance of its selected state.","source":"Move the pointer over the buttons of the `StackView` control, and then click a button to see the appearance of its selected state."},{"pos":[11272,11282],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"In this walkthrough, you have created a reusable custom client control with the professional appearance of an Office XP control.","pos":[11286,11414]},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> family of controls for many other purposes:","pos":[11415,11512],"source":" You can use the <xref:System.Windows.Forms.ToolStrip> family of controls for many other purposes:"},{"content":"Create shortcut menus for your controls with <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ContextMenuStrip&gt;</ph>.","pos":[11522,11612],"source":"Create shortcut menus for your controls with <xref:System.Windows.Forms.ContextMenuStrip>."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>ContextMenu Component Overview<ept id=\"p1\">](contextmenu-component-overview-windows-forms.md)</ept>.","pos":[11613,11721],"source":" For more information, see [ContextMenu Component Overview](contextmenu-component-overview-windows-forms.md)."},{"content":"Create a form with an automatically populated standard menu.","pos":[11731,11791]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Providing Standard Menu Items to a Form<ept id=\"p1\">](walkthrough-providing-standard-menu-items-to-a-form.md)</ept>.","pos":[11792,11929],"source":" For more information, see [Walkthrough: Providing Standard Menu Items to a Form](walkthrough-providing-standard-menu-items-to-a-form.md)."},{"content":"Create a multiple document interface (MDI) form with docking <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> controls.","pos":[11939,12047],"source":"Create a multiple document interface (MDI) form with docking <xref:System.Windows.Forms.ToolStrip> controls."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Create an MDI Form with Menu Merging and ToolStrip Controls<ept id=\"p1\">](how-to-create-an-mdi-form-with-menu-merging-and-toolstrip-controls.md)</ept>.","pos":[12048,12215],"source":" For more information, see [How to: Create an MDI Form with Menu Merging and ToolStrip Controls](how-to-create-an-mdi-form-with-menu-merging-and-toolstrip-controls.md)."},{"pos":[12224,12232],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[12358,12413],"content":"<bpt id=\"p1\">[</bpt>ToolStrip Control<ept id=\"p1\">](toolstrip-control-windows-forms.md)</ept>","source":"[ToolStrip Control](toolstrip-control-windows-forms.md)"},{"pos":[12416,12512],"content":"<bpt id=\"p1\">[</bpt>How to: Provide Standard Menu Items to a Form<ept id=\"p1\">](how-to-provide-standard-menu-items-to-a-form.md)</ept>","source":"[How to: Provide Standard Menu Items to a Form](how-to-provide-standard-menu-items-to-a-form.md)"}]}