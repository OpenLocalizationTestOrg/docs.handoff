{"content":"---\ntitle: \"Integrating with COM Applications Overview\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"COM [WCF], integration overview\"\nms.assetid: 02c5697f-6e2e-47d6-b715-f3a28aebfbd5\n---\n# Integrating with COM Applications Overview\nWindows Communication Foundation (WCF) provides the managed code developer with a rich environment for creating connected applications. However, if you have a substantial investment in unmanaged COM-based code and do not want to migrate, you can still integrate WCF Web services directly into your existing code by using the WCF service moniker. The service moniker can be used from a wide range of COM-based development environments, such as Office VBA, Visual Basic 6.0, or Visual C++ 6.0.  \n  \n> [!NOTE]\n>  The service moniker uses a WCF communication channel for all communication. The security and identity mechanisms for that channel differ from those used in standard COM and DCOM proxies. In addition, because the service moniker uses a WCF communication channel the default timeout period is one minute for all calls.  \n  \n The service moniker is used with the `GetObject` function to provide the unmanaged developer with a strongly-typed, COM-specific approach for calling WCF Web services. This requires a local, COM-visible definition of the WCF Web service contract and the binding that is to be used. Like other WCF clients, the service moniker must construct a typed channel to the service, though this channel construction occurs transparently to the COM programmer on the first method call.  \n  \n In common with other WCF clients, when using the moniker, applications specify the address, binding and contract to communicate with a service. The contract can be specified in one of the following ways:  \n  \n-   Typed contract – the contract is registered as a COM visible type on the client machine.  \n  \n-   WSDL contract – the contract is supplied in the form of a WSDL document.  \n  \n-   MEX contract – the contract is retrieved at runtime from a Metadata Exchange (MEX) endpoint.  \n  \n## Parameters Supported by the Service Moniker  \n The following table shows the parameters that are supported by the service moniker.  \n  \n|Parameter|Description|  \n|---------------|-----------------|  \n|`address`|URL location of the service.|  \n|`binding`|Binding section name from the application configuration.|  \n|`bindingConfiguration`|Named binding instance from within the named binding section.|  \n|`contract`|Interface identifier (IID) that represents the service contract or the contract name (from MEX).|  \n|`wsdl`|WSDL document that provides an alternative form of contract definition.|  \n|`spnIdentity`|Server principal name (SPN) identity to be used to communicate with the service.|  \n|`upnIdentity`|User principal name (UPN) identity to be used to communicate with the service.|  \n|`dnsIdentity`|DNS identity to be used to communicate with the service.|  \n|`mexAddress`|URL location of the Metadata Exchange (MEX) endpoint of the service.|  \n|`mexBinding`|Binding section name from the application configuration to connect with the MEX endpoint.|  \n|`mexBindingConfiguration`|Named binding instance from within the named binding section to connect with the MEX endpoint.|  \n|`bindingNamespace`|Namespace of the binding section name from the retrieved MEX.|  \n|`contractNamespace`|Namespace of the contract from the retrieved MEX.|  \n|`mexSpnIdentity`|Server principal name (SPN) identity to be used to communicate with the MEX endpoint.|  \n|`mexUpnIdentity`|User principal name (UPN) identity to be used to communicate with the MEX endpoint.|  \n|`mexDnsIdentity`|DNS identity to be used to communicate with the MEX endpoint.|  \n|`serializer`|Specify the use of either the \"xml\" or \"datacontract\" serializer.|  \n  \n> [!NOTE]\n>  Even when used with entirely COM-based clients, the service moniker requires WCF and the supporting .NET Framework 2.0 to be installed on the client computer. It is also critical that client applications that use the service moniker load the appropriate version of the .NET Framework runtime. When using the moniker within Office applications, a configuration file may be required to ensure that the correct framework version is loaded. For example, with Excel, the following text should be placed in a file called Excel.exe.config in the same directory as the Excel.exe file:  \n>   \n>  `<?xml version=\"1.0\" encoding=\"utf-8\"?>`  \n>   \n>  `<configuration xmlns=` `http://schemas.microsoft.com/.NetConfiguration/v2.0` `>`  \n>   \n>  `<startup>`  \n>   \n>  `<requiredRuntime version=\"v2.0.50727\" />`  \n>   \n>  `</startup>`  \n>   \n>  `</configuration>`  \n  \n## See also\n\n- [How to: Register and Configure a Service Moniker](../../../../docs/framework/wcf/feature-details/how-to-register-and-configure-a-service-moniker.md)\n","nodes":[{"pos":[4,186],"embed":true,"restype":"x-metadata","content":"title: \"Integrating with COM Applications Overview\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"COM [WCF], integration overview\"\nms.assetid: 02c5697f-6e2e-47d6-b715-f3a28aebfbd5","nodes":[{"content":"Integrating with COM Applications Overview","nodes":[{"pos":[0,42],"content":"Integrating with COM Applications Overview","nodes":[{"content":"Integrating with COM Applications Overview","pos":[0,42]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[193,235],"content":"Integrating with COM Applications Overview","linkify":"Integrating with COM Applications Overview","nodes":[{"content":"Integrating with COM Applications Overview","pos":[0,42]}]},{"content":"Windows Communication Foundation (WCF) provides the managed code developer with a rich environment for creating connected applications.","pos":[236,371]},{"content":"However, if you have a substantial investment in unmanaged COM-based code and do not want to migrate, you can still integrate WCF Web services directly into your existing code by using the WCF service moniker.","pos":[372,581]},{"content":"The service moniker can be used from a wide range of COM-based development environments, such as Office VBA, Visual Basic 6.0, or Visual C++ 6.0.","pos":[582,727]},{"pos":[735,1062],"content":"[!NOTE]\n The service moniker uses a WCF communication channel for all communication. The security and identity mechanisms for that channel differ from those used in standard COM and DCOM proxies. In addition, because the service moniker uses a WCF communication channel the default timeout period is one minute for all calls.","leadings":["","> "],"nodes":[{"content":"The service moniker uses a WCF communication channel for all communication. The security and identity mechanisms for that channel differ from those used in standard COM and DCOM proxies. In addition, because the service moniker uses a WCF communication channel the default timeout period is one minute for all calls.","pos":[9,325],"nodes":[{"content":"The service moniker uses a WCF communication channel for all communication.","pos":[0,75]},{"content":"The security and identity mechanisms for that channel differ from those used in standard COM and DCOM proxies.","pos":[76,186]},{"content":"In addition, because the service moniker uses a WCF communication channel the default timeout period is one minute for all calls.","pos":[187,316]}]}]},{"content":"The service moniker is used with the <ph id=\"ph1\">`GetObject`</ph> function to provide the unmanaged developer with a strongly-typed, COM-specific approach for calling WCF Web services.","pos":[1069,1236],"source":"The service moniker is used with the `GetObject` function to provide the unmanaged developer with a strongly-typed, COM-specific approach for calling WCF Web services."},{"content":"This requires a local, COM-visible definition of the WCF Web service contract and the binding that is to be used.","pos":[1237,1350]},{"content":"Like other WCF clients, the service moniker must construct a typed channel to the service, though this channel construction occurs transparently to the COM programmer on the first method call.","pos":[1351,1543]},{"content":"In common with other WCF clients, when using the moniker, applications specify the address, binding and contract to communicate with a service.","pos":[1550,1693]},{"content":"The contract can be specified in one of the following ways:","pos":[1694,1753]},{"content":"Typed contract – the contract is registered as a COM visible type on the client machine.","pos":[1763,1851]},{"content":"WSDL contract – the contract is supplied in the form of a WSDL document.","pos":[1861,1933]},{"content":"MEX contract – the contract is retrieved at runtime from a Metadata Exchange (MEX) endpoint.","pos":[1943,2035]},{"pos":[2044,2087],"content":"Parameters Supported by the Service Moniker","linkify":"Parameters Supported by the Service Moniker","nodes":[{"content":"Parameters Supported by the Service Moniker","pos":[0,43]}]},{"content":"The following table shows the parameters that are supported by the service moniker.","pos":[2091,2174]},{"content":"Parameter","pos":[2181,2190]},{"content":"Description","pos":[2191,2202]},{"content":"URL location of the service.","pos":[2255,2283]},{"content":"Binding section name from the application configuration.","pos":[2298,2354]},{"content":"Named binding instance from within the named binding section.","pos":[2382,2443]},{"content":"Interface identifier (IID) that represents the service contract or the contract name (from MEX).","pos":[2459,2555]},{"content":"WSDL document that provides an alternative form of contract definition.","pos":[2567,2638]},{"content":"Server principal name (SPN) identity to be used to communicate with the service.","pos":[2657,2737]},{"content":"User principal name (UPN) identity to be used to communicate with the service.","pos":[2756,2834]},{"content":"DNS identity to be used to communicate with the service.","pos":[2853,2909]},{"content":"URL location of the Metadata Exchange (MEX) endpoint of the service.","pos":[2927,2995]},{"content":"Binding section name from the application configuration to connect with the MEX endpoint.","pos":[3013,3102]},{"content":"Named binding instance from within the named binding section to connect with the MEX endpoint.","pos":[3133,3227]},{"content":"Namespace of the binding section name from the retrieved MEX.","pos":[3251,3312]},{"content":"Namespace of the contract from the retrieved MEX.","pos":[3337,3386]},{"content":"Server principal name (SPN) identity to be used to communicate with the MEX endpoint.","pos":[3408,3493]},{"content":"User principal name (UPN) identity to be used to communicate with the MEX endpoint.","pos":[3515,3598]},{"content":"DNS identity to be used to communicate with the MEX endpoint.","pos":[3620,3681]},{"content":"Specify the use of either the \"xml\" or \"datacontract\" serializer.","pos":[3699,3764]},{"pos":[3773,4360],"content":"[!NOTE]\n Even when used with entirely COM-based clients, the service moniker requires WCF and the supporting .NET Framework 2.0 to be installed on the client computer. It is also critical that client applications that use the service moniker load the appropriate version of the .NET Framework runtime. When using the moniker within Office applications, a configuration file may be required to ensure that the correct framework version is loaded. For example, with Excel, the following text should be placed in a file called Excel.exe.config in the same directory as the Excel.exe file:","leadings":["","> "],"nodes":[{"content":"Even when used with entirely COM-based clients, the service moniker requires WCF and the supporting .NET Framework 2.0 to be installed on the client computer. It is also critical that client applications that use the service moniker load the appropriate version of the .NET Framework runtime. When using the moniker within Office applications, a configuration file may be required to ensure that the correct framework version is loaded. For example, with Excel, the following text should be placed in a file called Excel.exe.config in the same directory as the Excel.exe file:","pos":[9,585],"nodes":[{"content":"Even when used with entirely COM-based clients, the service moniker requires WCF and the supporting .NET Framework 2.0 to be installed on the client computer.","pos":[0,158]},{"content":"It is also critical that client applications that use the service moniker load the appropriate version of the .NET Framework runtime.","pos":[159,292]},{"content":"When using the moniker within Office applications, a configuration file may be required to ensure that the correct framework version is loaded.","pos":[293,436]},{"content":"For example, with Excel, the following text should be placed in a file called Excel.exe.config in the same directory as the Excel.exe file:","pos":[437,576]}]}]},{"pos":[4422,4503],"content":"<ph id=\"ph1\">`&lt;configuration xmlns=`</ph> <ph id=\"ph2\">`http://schemas.microsoft.com/.NetConfiguration/v2.0`</ph> <ph id=\"ph3\">`&gt;`</ph>","source":"`<configuration xmlns=` `http://schemas.microsoft.com/.NetConfiguration/v2.0` `>`"},{"pos":[4639,4647],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4651,4800],"content":"<bpt id=\"p1\">[</bpt>How to: Register and Configure a Service Moniker<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-register-and-configure-a-service-moniker.md)</ept>","source":"[How to: Register and Configure a Service Moniker](../../../../docs/framework/wcf/feature-details/how-to-register-and-configure-a-service-moniker.md)"}]}