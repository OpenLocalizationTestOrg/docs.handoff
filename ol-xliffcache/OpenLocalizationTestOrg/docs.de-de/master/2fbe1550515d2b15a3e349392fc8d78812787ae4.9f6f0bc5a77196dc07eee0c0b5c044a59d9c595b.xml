{"content":"---\ntitle: \"Value of type &#39;&lt;typename1&gt;&#39; cannot be converted to &#39;&lt;typename2&gt;&#39; | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vbc30955\"\n  - \"bc30955\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"BC30955\"\nms.assetid: 966b61eb-441e-48b0-bedf-ca95384ecb8b\ncaps.latest.revision: 12\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Value of type &#39;&lt;typename1&gt;&#39; cannot be converted to &#39;&lt;typename2&gt;&#39;\nValue of type '\\<typename1>' cannot be converted to '\\<typename2>'. Type mismatch could be due to the mixing of a file reference with a project reference to assembly '\\<assemblyname>'. Try replacing the file reference to '\\<filepath>' in project '\\<projectname1>' with a project reference to '\\<projectname2>'.  \n  \n In a situation where a project makes both a project reference and a file reference, the compiler cannot guarantee that one type can be converted to another.  \n  \n The following pseudo-code illustrates a situation that can generate this error.  \n  \n `' ================ Visual Basic project P1 ================`  \n  \n `'        P1 makes a PROJECT REFERENCE to project P2`  \n  \n `'        and a FILE REFERENCE to project P3.`  \n  \n `Public commonObject As P3.commonClass`  \n  \n `commonObject = P2.getCommonClass()`  \n  \n `' ================ Visual Basic project P2 ================`  \n  \n `'        P2 makes a PROJECT REFERENCE to project P3`  \n  \n `Public Function getCommonClass() As P3.commonClass`  \n  \n `Return New P3.commonClass`  \n  \n `End Function`  \n  \n `' ================ Visual Basic project P3 ================`  \n  \n `Public Class commonClass`  \n  \n `End Class`  \n  \n Project `P1` makes an indirect project reference through project `P2` to project `P3`, and also a direct file reference to `P3`. The declaration of `commonObject` uses the file reference to `P3`, while the call to `P2.getCommonClass` uses the project reference to `P3`.  \n  \n The problem in this situation is that the file reference specifies a file path and name for the output file of `P3` (typically p3.dll), while the project references identify the source project (`P3`) by project name. Because of this, the compiler cannot guarantee that the type `P3.commonClass` comes from the same source code through the two different references.  \n  \n This situation typically occurs when project references and file references are mixed. In the preceding illustration, the problem would not occur if `P1` made a direct project reference to `P3` instead of a file reference.  \n  \n **Error ID:** BC30955  \n  \n## To correct this error  \n  \n-   Change the file reference to a project reference.  \n  \n## See Also  \n [Type Conversions in Visual Basic](../../../visual-basic/programming-guide/language-features/data-types/type-conversions.md)   \n [Managing references in a project](https://docs.microsoft.com/visualstudio/ide/managing-references-in-a-project)   \n [NIB How to: Add or Remove References By Using the Add Reference Dialog Box](http://msdn.microsoft.com/en-us/3bd75d61-f00c-47c0-86a2-dd1f20e231c9)","nodes":[{"pos":[12,121],"content":"Value of type &#39;&lt;typename1&gt;&#39; cannot be converted to &#39;&lt;typename2&gt;&#39; | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Value of type &amp;#39;<ph id=\"ph1\">&amp;lt;</ph>typename1<ph id=\"ph2\">&amp;gt;</ph>&amp;#39; cannot be converted to &amp;#39;<ph id=\"ph3\">&amp;lt;</ph>typename2<ph id=\"ph4\">&amp;gt;</ph>&amp;#39; | Microsoft Docs","pos":[0,109],"source":"Value of type &#39;&lt;typename1&gt;&#39; cannot be converted to &#39;&lt;typename2&gt;&#39; | Microsoft Docs"}]},{"pos":[660,752],"content":"Value of type &#39;&lt;typename1&gt;&#39; cannot be converted to &#39;&lt;typename2&gt;&#39;","linkify":"Value of type &#39;&lt;typename1&gt;&#39; cannot be converted to &#39;&lt;typename2&gt;&#39;","nodes":[{"content":"Value of type &amp;#39;<ph id=\"ph1\">&amp;lt;</ph>typename1<ph id=\"ph2\">&amp;gt;</ph>&amp;#39; cannot be converted to &amp;#39;<ph id=\"ph3\">&amp;lt;</ph>typename2<ph id=\"ph4\">&amp;gt;</ph>&amp;#39;","pos":[0,92],"source":"Value of type &#39;&lt;typename1&gt;&#39; cannot be converted to &#39;&lt;typename2&gt;&#39;"}]},{"content":"Value of type '<ph id=\"ph1\">\\&lt;</ph>typename1&gt;' cannot be converted to '<ph id=\"ph2\">\\&lt;</ph>typename2&gt;'.","pos":[753,820],"source":"Value of type '\\<typename1>' cannot be converted to '\\<typename2>'."},{"content":"Type mismatch could be due to the mixing of a file reference with a project reference to assembly '<ph id=\"ph1\">\\&lt;</ph>assemblyname&gt;'.","pos":[821,937],"source":" Type mismatch could be due to the mixing of a file reference with a project reference to assembly '\\<assemblyname>'."},{"content":"Try replacing the file reference to '<ph id=\"ph1\">\\&lt;</ph>filepath&gt;' in project '<ph id=\"ph2\">\\&lt;</ph>projectname1&gt;' with a project reference to '<ph id=\"ph3\">\\&lt;</ph>projectname2&gt;'.","pos":[938,1063],"source":" Try replacing the file reference to '\\<filepath>' in project '\\<projectname1>' with a project reference to '\\<projectname2>'."},{"content":"In a situation where a project makes both a project reference and a file reference, the compiler cannot guarantee that one type can be converted to another.","pos":[1070,1226]},{"content":"The following pseudo-code illustrates a situation that can generate this error.","pos":[1233,1312]},{"content":"Project <ph id=\"ph1\">`P1`</ph> makes an indirect project reference through project <ph id=\"ph2\">`P2`</ph> to project <ph id=\"ph3\">`P3`</ph>, and also a direct file reference to <ph id=\"ph4\">`P3`</ph>.","pos":[1950,2078],"source":"Project `P1` makes an indirect project reference through project `P2` to project `P3`, and also a direct file reference to `P3`."},{"content":"The declaration of <ph id=\"ph1\">`commonObject`</ph> uses the file reference to <ph id=\"ph2\">`P3`</ph>, while the call to <ph id=\"ph3\">`P2.getCommonClass`</ph> uses the project reference to <ph id=\"ph4\">`P3`</ph>.","pos":[2079,2219],"source":" The declaration of `commonObject` uses the file reference to `P3`, while the call to `P2.getCommonClass` uses the project reference to `P3`."},{"content":"The problem in this situation is that the file reference specifies a file path and name for the output file of <ph id=\"ph1\">`P3`</ph> (typically p3.dll), while the project references identify the source project (<ph id=\"ph2\">`P3`</ph>) by project name.","pos":[2226,2442],"source":"The problem in this situation is that the file reference specifies a file path and name for the output file of `P3` (typically p3.dll), while the project references identify the source project (`P3`) by project name."},{"content":"Because of this, the compiler cannot guarantee that the type <ph id=\"ph1\">`P3.commonClass`</ph> comes from the same source code through the two different references.","pos":[2443,2590],"source":" Because of this, the compiler cannot guarantee that the type `P3.commonClass` comes from the same source code through the two different references."},{"content":"This situation typically occurs when project references and file references are mixed.","pos":[2597,2683]},{"content":"In the preceding illustration, the problem would not occur if <ph id=\"ph1\">`P1`</ph> made a direct project reference to <ph id=\"ph2\">`P3`</ph> instead of a file reference.","pos":[2684,2819],"source":" In the preceding illustration, the problem would not occur if `P1` made a direct project reference to `P3` instead of a file reference."},{"pos":[2826,2847],"content":"<bpt id=\"p1\">**</bpt>Error ID:<ept id=\"p1\">**</ept> BC30955","source":"**Error ID:** BC30955"},{"pos":[2856,2877],"content":"To correct this error","linkify":"To correct this error","nodes":[{"content":"To correct this error","pos":[0,21]}]},{"content":"Change the file reference to a project reference.","pos":[2887,2936]},{"pos":[2945,2953],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Type Conversions in Visual Basic<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/type-conversions.md)</ept><ph id=\"ph1\"> </ph>","pos":[2957,3082],"source":"[Type Conversions in Visual Basic](../../../visual-basic/programming-guide/language-features/data-types/type-conversions.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Managing references in a project<ept id=\"p1\">](https://docs.microsoft.com/visualstudio/ide/managing-references-in-a-project)</ept><ph id=\"ph1\"> </ph>","pos":[3085,3199],"source":" [Managing references in a project](https://docs.microsoft.com/visualstudio/ide/managing-references-in-a-project) "},{"content":"<bpt id=\"p1\"> [</bpt>NIB How to: Add or Remove References By Using the Add Reference Dialog Box<ept id=\"p1\">](http://msdn.microsoft.com/en-us/3bd75d61-f00c-47c0-86a2-dd1f20e231c9)</ept>","pos":[3202,3349],"source":" [NIB How to: Add or Remove References By Using the Add Reference Dialog Box](http://msdn.microsoft.com/en-us/3bd75d61-f00c-47c0-86a2-dd1f20e231c9)"}]}