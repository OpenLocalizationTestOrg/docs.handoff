{"content":"---\ntitle: \"How to: Call Custom Database Functions | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 4354e5eb-dd45-469d-97fb-1c495705ee59\ncaps.latest.revision: 3\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# How to: Call Custom Database Functions\nThis topic describes how to call custom functions that are defined in the database from within LINQ to Entities queries.  \n  \n Database functions that are called from LINQ to Entities queries are executed in the database. Executing functions in the database can improve application performance.  \n  \n The procedure below provides a high-level outline for calling a custom database function. The example that follows provides more detail about the steps in the procedure.  \n  \n### To call custom functions that are defined in the database  \n  \n1.  Create a custom function in your database.  \n  \n     For more information about creating custom functions in SQL Server, see [CREATE FUNCTION (Transact-SQL)](http://go.microsoft.com/fwlink/?LinkID=139871).  \n  \n2.  Declare a function in the store schema definition language (SSDL) of your .edmx file. The name of the function must be the same as the name of the function declared in the database.  \n  \n     For more information, see [Function Element (SSDL)](http://msdn.microsoft.com/en-us/b60cfc3d-8b93-423e-8c99-b867256640a4).  \n  \n3.  Add a corresponding method to a class in your application code and apply a <xref:System.Data.Objects.DataClasses.EdmFunctionAttribute> to the method Note that the <xref:System.Data.Objects.DataClasses.EdmFunctionAttribute.NamespaceName%2A> and <xref:System.Data.Objects.DataClasses.EdmFunctionAttribute.FunctionName%2A> parameters of the attribute are the namespace name of the conceptual model and the function name in the conceptual model respectively. Function name resolution for LINQ is case sensitive.  \n  \n4.  Call the method in a LINQ to Entities query.  \n  \n## Example  \n The following example demonstrates how to call a custom database function from within a LINQ to Entities query. The example uses the School model. For information about the School model, see [Creating the School Sample Database](http://msdn.microsoft.com/en-us/c1bec483-a0ea-4660-aa0b-7b0a8b68fed0) and [Generating the School .edmx File](http://msdn.microsoft.com/en-us/c48b3907-a8be-4fe6-884c-e95af1852758).  \n  \n The following code adds the `AvgStudentGrade` function to the School sample database.  \n  \n> [!NOTE]\n>  The steps for calling a custom database function are the same regardless of the database server. However, the code below is specific to creating a function in a SQL Server database. The code for creating a custom function in other database servers might differ.  \n  \n [!code-sql[DP L2E MapToDBFunction#1](../../../../../../samples/snippets/tsql/VS_Snippets_Data/dp l2e maptodbfunction/tsql/create_avgstudentgrade.sql#1)]  \n  \n## Example  \n Next, declare a function in the store schema definition language (SSDL) of your .edmx file. the following code declares the `AvgStudentGrade` function in SSDL:  \n  \n [!code-xml[DP L2E MapToDBFunction#2](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp l2e maptodbfunction/cs/school.edmx#2)]  \n  \n## Example  \n Now create a method and map it to the function declared in the SSDL. The method in the following class is mapped to the function defined in the SSDL (above) by using an <xref:System.Data.Objects.DataClasses.EdmFunctionAttribute>. When this method is called, the corresponding function in the database is executed.  \n  \n [!code-csharp[DP L2E MapToDBFunction#3](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp l2e maptodbfunction/cs/program.cs#3)]\n [!code-vb[DP L2E MapToDBFunction#3](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/dp l2e maptodbfunction/vb/module1.vb#3)]  \n  \n## Example  \n Finally, call the method in a LINQ to Entities query. The following code displays students' last names and average grades to the console:  \n  \n [!code-csharp[DP L2E MapToDBFunction#4](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp l2e maptodbfunction/cs/program.cs#4)]\n [!code-vb[DP L2E MapToDBFunction#4](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/dp l2e maptodbfunction/vb/module1.vb#4)]  \n  \n## See Also  \n [.edmx File Overview](http://msdn.microsoft.com/en-us/f4c8e7ce-1db6-417e-9759-15f8b55155d4)   \n [Queries in LINQ to Entities](../../../../../../docs/framework/data/adonet/ef/language-reference/queries-in-linq-to-entities.md)","nodes":[{"pos":[4,369],"embed":true,"restype":"x-metadata","content":"title: \"How to: Call Custom Database Functions | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 4354e5eb-dd45-469d-97fb-1c495705ee59\ncaps.latest.revision: 3\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","nodes":[{"content":"How to: Call Custom Database Functions | Microsoft Docs","nodes":[{"pos":[0,55],"content":"How to: Call Custom Database Functions | Microsoft Docs","nodes":[{"content":"How to: Call Custom Database Functions | Microsoft Docs","pos":[0,55]}]}],"path":["title"]}],"yml":true},{"pos":[376,414],"content":"How to: Call Custom Database Functions","linkify":"How to: Call Custom Database Functions","nodes":[{"content":"How to: Call Custom Database Functions","pos":[0,38]}]},{"content":"This topic describes how to call custom functions that are defined in the database from within LINQ to Entities queries.","pos":[415,535]},{"content":"Database functions that are called from LINQ to Entities queries are executed in the database.","pos":[542,636]},{"content":"Executing functions in the database can improve application performance.","pos":[637,709]},{"content":"The procedure below provides a high-level outline for calling a custom database function.","pos":[716,805]},{"content":"The example that follows provides more detail about the steps in the procedure.","pos":[806,885]},{"pos":[895,952],"content":"To call custom functions that are defined in the database","linkify":"To call custom functions that are defined in the database","nodes":[{"content":"To call custom functions that are defined in the database","pos":[0,57]}]},{"content":"Create a custom function in your database.","pos":[962,1004]},{"pos":[1015,1167],"content":"For more information about creating custom functions in SQL Server, see <bpt id=\"p1\">[</bpt>CREATE FUNCTION (Transact-SQL)<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=139871)</ept>.","source":"For more information about creating custom functions in SQL Server, see [CREATE FUNCTION (Transact-SQL)](http://go.microsoft.com/fwlink/?LinkID=139871)."},{"content":"Declare a function in the store schema definition language (SSDL) of your .edmx file.","pos":[1177,1262]},{"content":"The name of the function must be the same as the name of the function declared in the database.","pos":[1263,1358]},{"pos":[1369,1491],"content":"For more information, see <bpt id=\"p1\">[</bpt>Function Element (SSDL)<ept id=\"p1\">](http://msdn.microsoft.com/en-us/b60cfc3d-8b93-423e-8c99-b867256640a4)</ept>.","source":"For more information, see [Function Element (SSDL)](http://msdn.microsoft.com/en-us/b60cfc3d-8b93-423e-8c99-b867256640a4)."},{"content":"Add a corresponding method to a class in your application code and apply a <ph id=\"ph1\">&lt;xref:System.Data.Objects.DataClasses.EdmFunctionAttribute&gt;</ph> to the method Note that the <ph id=\"ph2\">&lt;xref:System.Data.Objects.DataClasses.EdmFunctionAttribute.NamespaceName%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Data.Objects.DataClasses.EdmFunctionAttribute.FunctionName%2A&gt;</ph> parameters of the attribute are the namespace name of the conceptual model and the function name in the conceptual model respectively.","pos":[1501,1955],"source":"Add a corresponding method to a class in your application code and apply a <xref:System.Data.Objects.DataClasses.EdmFunctionAttribute> to the method Note that the <xref:System.Data.Objects.DataClasses.EdmFunctionAttribute.NamespaceName%2A> and <xref:System.Data.Objects.DataClasses.EdmFunctionAttribute.FunctionName%2A> parameters of the attribute are the namespace name of the conceptual model and the function name in the conceptual model respectively."},{"content":"Function name resolution for LINQ is case sensitive.","pos":[1956,2008]},{"content":"Call the method in a LINQ to Entities query.","pos":[2018,2062]},{"pos":[2071,2078],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example demonstrates how to call a custom database function from within a LINQ to Entities query.","pos":[2082,2193]},{"content":"The example uses the School model.","pos":[2194,2228]},{"content":"For information about the School model, see <bpt id=\"p1\">[</bpt>Creating the School Sample Database<ept id=\"p1\">](http://msdn.microsoft.com/en-us/c1bec483-a0ea-4660-aa0b-7b0a8b68fed0)</ept> and <bpt id=\"p2\">[</bpt>Generating the School .edmx File<ept id=\"p2\">](http://msdn.microsoft.com/en-us/c48b3907-a8be-4fe6-884c-e95af1852758)</ept>.","pos":[2229,2490],"source":" For information about the School model, see [Creating the School Sample Database](http://msdn.microsoft.com/en-us/c1bec483-a0ea-4660-aa0b-7b0a8b68fed0) and [Generating the School .edmx File](http://msdn.microsoft.com/en-us/c48b3907-a8be-4fe6-884c-e95af1852758)."},{"pos":[2497,2582],"content":"The following code adds the <ph id=\"ph1\">`AvgStudentGrade`</ph> function to the School sample database.","source":"The following code adds the `AvgStudentGrade` function to the School sample database."},{"pos":[2590,2862],"content":"[!NOTE]\n The steps for calling a custom database function are the same regardless of the database server. However, the code below is specific to creating a function in a SQL Server database. The code for creating a custom function in other database servers might differ.","leadings":["","> "],"nodes":[{"content":"The steps for calling a custom database function are the same regardless of the database server. However, the code below is specific to creating a function in a SQL Server database. The code for creating a custom function in other database servers might differ.","pos":[9,270],"nodes":[{"content":"The steps for calling a custom database function are the same regardless of the database server.","pos":[0,96]},{"content":"However, the code below is specific to creating a function in a SQL Server database.","pos":[97,181]},{"content":"The code for creating a custom function in other database servers might differ.","pos":[182,261]}]}]},{"pos":[2869,3021],"content":"<bpt id=\"p1\">[!code-sql</bpt><bpt id=\"p2\">[</bpt>DP L2E MapToDBFunction#1<ept id=\"p2\">](../../../../../../samples/snippets/tsql/VS_Snippets_Data/dp l2e maptodbfunction/tsql/create_avgstudentgrade.sql#1)</ept><ept id=\"p1\">]</ept>","source":"[!code-sql[DP L2E MapToDBFunction#1](../../../../../../samples/snippets/tsql/VS_Snippets_Data/dp l2e maptodbfunction/tsql/create_avgstudentgrade.sql#1)]"},{"pos":[3030,3037],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"Next, declare a function in the store schema definition language (SSDL) of your .edmx file.","pos":[3041,3132]},{"content":"the following code declares the <ph id=\"ph1\">`AvgStudentGrade`</ph> function in SSDL:","pos":[3133,3200],"source":" the following code declares the `AvgStudentGrade` function in SSDL:"},{"pos":[3207,3344],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>DP L2E MapToDBFunction#2<ept id=\"p2\">](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp l2e maptodbfunction/cs/school.edmx#2)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[DP L2E MapToDBFunction#2](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp l2e maptodbfunction/cs/school.edmx#2)]"},{"pos":[3353,3360],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"Now create a method and map it to the function declared in the SSDL.","pos":[3364,3432]},{"content":"The method in the following class is mapped to the function defined in the SSDL (above) by using an <ph id=\"ph1\">&lt;xref:System.Data.Objects.DataClasses.EdmFunctionAttribute&gt;</ph>.","pos":[3433,3593],"source":" The method in the following class is mapped to the function defined in the SSDL (above) by using an <xref:System.Data.Objects.DataClasses.EdmFunctionAttribute>."},{"content":"When this method is called, the corresponding function in the database is executed.","pos":[3594,3677]},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DP L2E MapToDBFunction#3<ept id=\"p2\">](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp l2e maptodbfunction/cs/program.cs#3)</ept><ept id=\"p1\">]</ept>","pos":[3684,3823],"source":"[!code-csharp[DP L2E MapToDBFunction#3](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp l2e maptodbfunction/cs/program.cs#3)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DP L2E MapToDBFunction#3<ept id=\"p2\">](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/dp l2e maptodbfunction/vb/module1.vb#3)</ept><ept id=\"p1\">]</ept>","pos":[3825,3965],"source":"[!code-vb[DP L2E MapToDBFunction#3](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/dp l2e maptodbfunction/vb/module1.vb#3)]"},{"pos":[3974,3981],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"Finally, call the method in a LINQ to Entities query.","pos":[3985,4038]},{"content":"The following code displays students' last names and average grades to the console:","pos":[4039,4122]},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DP L2E MapToDBFunction#4<ept id=\"p2\">](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp l2e maptodbfunction/cs/program.cs#4)</ept><ept id=\"p1\">]</ept>","pos":[4129,4268],"source":"[!code-csharp[DP L2E MapToDBFunction#4](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp l2e maptodbfunction/cs/program.cs#4)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DP L2E MapToDBFunction#4<ept id=\"p2\">](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/dp l2e maptodbfunction/vb/module1.vb#4)</ept><ept id=\"p1\">]</ept>","pos":[4270,4410],"source":"[!code-vb[DP L2E MapToDBFunction#4](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/dp l2e maptodbfunction/vb/module1.vb#4)]"},{"pos":[4419,4427],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>.edmx File Overview<ept id=\"p1\">](http://msdn.microsoft.com/en-us/f4c8e7ce-1db6-417e-9759-15f8b55155d4)</ept><ph id=\"ph1\"> </ph>","pos":[4431,4523],"source":"[.edmx File Overview](http://msdn.microsoft.com/en-us/f4c8e7ce-1db6-417e-9759-15f8b55155d4) "},{"content":"<bpt id=\"p1\">[</bpt>Queries in LINQ to Entities<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/language-reference/queries-in-linq-to-entities.md)</ept>","pos":[4527,4655],"source":"[Queries in LINQ to Entities](../../../../../../docs/framework/data/adonet/ef/language-reference/queries-in-linq-to-entities.md)"}]}