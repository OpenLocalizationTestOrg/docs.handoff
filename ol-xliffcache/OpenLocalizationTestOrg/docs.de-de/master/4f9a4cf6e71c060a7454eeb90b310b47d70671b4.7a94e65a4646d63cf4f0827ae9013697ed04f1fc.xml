{"content":"---\ntitle: \"ICorDebugProcess5::EnumerateHeapRegions Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICorDebugProcess5.EnumerateHeapRegions\"\napi_location: \n  - \"mscordbi.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICorDebugProcess5::EnumerateHeapRegions\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"EnumerateHeapRegions method, ICorDebugProcess5 interface [.NET Framework debugging]\"\n  - \"ICorDebugProcess5::EnumerateHeapRegions method [.NET Framework debugging]\"\nms.assetid: b1edba68-9c36-4f69-be9f-678ce0b33480\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 9\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# ICorDebugProcess5::EnumerateHeapRegions Method\nGets an enumerator for the memory ranges of the managed heap.  \n  \n## Syntax  \n  \n```  \nHRESULT EnumerateHeapRegions(  \n   [out] ICorDebugHeapSegmentEnum **ppRegions  \n);  \n```  \n  \n#### Parameters  \n `ppRegions`  \n [out] A pointer to the address of an [ICorDebugHeapSegmentEnum](../../../../docs/framework/unmanaged-api/debugging/icordebugheapsegmentenum-interface.md) interface object that is an enumerator for the ranges of memory in which objects reside in the managed heap.  \n  \n## Remarks  \n Before calling the `ICorDebugProcess5::EnumerateHeapRegions` method, you should call the [ICorDebugProcess5::GetGCHeapInformation](../../../../docs/framework/unmanaged-api/debugging/icordebugprocess5-getgcheapinformation-method.md) method and examine the value of the `areGCStructuresValid` field of the returned [COR_HEAPINFO](../../../../docs/framework/unmanaged-api/debugging/cor-heapinfo-structure.md) object to ensure that the garbage collection heap in its current state is enumerable. In addition, the `ICorDebugProcess5::EnumerateHeapRegions` method returns `E_FAIL` if you attach too early in the lifetime of the process, before memory regions are created.  \n  \n This method is guaranteed to enumerate all memory regions that may contain managed objects, but it does not guarantee that managed objects actually reside in those regions. The [ICorDebugHeapSegmentEnum](../../../../docs/framework/unmanaged-api/debugging/icordebugheapsegmentenum-interface.md) collection object may include empty or reserved memory regions.  \n  \n The [ICorDebugHeapSegmentEnum](../../../../docs/framework/unmanaged-api/debugging/icordebugheapsegmentenum-interface.md) interface object is a standard enumerator derived from the ICorDebugEnum interface that allows you to enumerate [COR_SEGMENT](../../../../docs/framework/unmanaged-api/debugging/cor-segment-structure.md) objects. Each [COR_SEGMENT](../../../../docs/framework/unmanaged-api/debugging/cor-segment-structure.md) object provides information about the memory range of a particular segment, along with the generation of the objects in that segment.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** CorDebug.idl, CorDebug.h  \n  \n **Library:** CorGuids.lib  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v45plus](../../../../includes/net-current-v45plus-md.md)]  \n  \n## See Also  \n [ICorDebugProcess5 Interface](../../../../docs/framework/unmanaged-api/debugging/icordebugprocess5-interface.md)   \n [Debugging Interfaces](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md)","nodes":[{"pos":[4,784],"embed":true,"restype":"x-metadata","content":"title: \"ICorDebugProcess5::EnumerateHeapRegions Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICorDebugProcess5.EnumerateHeapRegions\"\napi_location: \n  - \"mscordbi.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICorDebugProcess5::EnumerateHeapRegions\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"EnumerateHeapRegions method, ICorDebugProcess5 interface [.NET Framework debugging]\"\n  - \"ICorDebugProcess5::EnumerateHeapRegions method [.NET Framework debugging]\"\nms.assetid: b1edba68-9c36-4f69-be9f-678ce0b33480\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 9\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"ICorDebugProcess5::EnumerateHeapRegions Method | Microsoft Docs","nodes":[{"pos":[0,63],"content":"ICorDebugProcess5::EnumerateHeapRegions Method | Microsoft Docs","nodes":[{"content":"ICorDebugProcess5::EnumerateHeapRegions Method | Microsoft Docs","pos":[0,63]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[791,837],"content":"ICorDebugProcess5::EnumerateHeapRegions Method","linkify":"ICorDebugProcess5::EnumerateHeapRegions Method","nodes":[{"content":"ICorDebugProcess5::EnumerateHeapRegions Method","pos":[0,46]}]},{"content":"Gets an enumerator for the memory ranges of the managed heap.","pos":[838,899]},{"pos":[908,914],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1025,1035],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[out] A pointer to the address of an <bpt id=\"p1\">[</bpt>ICorDebugHeapSegmentEnum<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/icordebugheapsegmentenum-interface.md)</ept> interface object that is an enumerator for the ranges of memory in which objects reside in the managed heap.","pos":[1054,1316],"source":"[out] A pointer to the address of an [ICorDebugHeapSegmentEnum](../../../../docs/framework/unmanaged-api/debugging/icordebugheapsegmentenum-interface.md) interface object that is an enumerator for the ranges of memory in which objects reside in the managed heap."},{"pos":[1325,1332],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Before calling the <ph id=\"ph1\">`ICorDebugProcess5::EnumerateHeapRegions`</ph> method, you should call the <bpt id=\"p1\">[</bpt>ICorDebugProcess5::GetGCHeapInformation<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/icordebugprocess5-getgcheapinformation-method.md)</ept> method and examine the value of the <ph id=\"ph2\">`areGCStructuresValid`</ph> field of the returned <bpt id=\"p2\">[</bpt>COR_HEAPINFO<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/debugging/cor-heapinfo-structure.md)</ept> object to ensure that the garbage collection heap in its current state is enumerable.","pos":[1336,1827],"source":"Before calling the `ICorDebugProcess5::EnumerateHeapRegions` method, you should call the [ICorDebugProcess5::GetGCHeapInformation](../../../../docs/framework/unmanaged-api/debugging/icordebugprocess5-getgcheapinformation-method.md) method and examine the value of the `areGCStructuresValid` field of the returned [COR_HEAPINFO](../../../../docs/framework/unmanaged-api/debugging/cor-heapinfo-structure.md) object to ensure that the garbage collection heap in its current state is enumerable."},{"content":"In addition, the <ph id=\"ph1\">`ICorDebugProcess5::EnumerateHeapRegions`</ph> method returns <ph id=\"ph2\">`E_FAIL`</ph> if you attach too early in the lifetime of the process, before memory regions are created.","pos":[1828,2001],"source":" In addition, the `ICorDebugProcess5::EnumerateHeapRegions` method returns `E_FAIL` if you attach too early in the lifetime of the process, before memory regions are created."},{"content":"This method is guaranteed to enumerate all memory regions that may contain managed objects, but it does not guarantee that managed objects actually reside in those regions.","pos":[2008,2180]},{"content":"The <bpt id=\"p1\">[</bpt>ICorDebugHeapSegmentEnum<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/icordebugheapsegmentenum-interface.md)</ept> collection object may include empty or reserved memory regions.","pos":[2181,2365],"source":" The [ICorDebugHeapSegmentEnum](../../../../docs/framework/unmanaged-api/debugging/icordebugheapsegmentenum-interface.md) collection object may include empty or reserved memory regions."},{"content":"The <bpt id=\"p1\">[</bpt>ICorDebugHeapSegmentEnum<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/icordebugheapsegmentenum-interface.md)</ept> interface object is a standard enumerator derived from the ICorDebugEnum interface that allows you to enumerate <bpt id=\"p2\">[</bpt>COR_SEGMENT<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/debugging/cor-segment-structure.md)</ept> objects.","pos":[2372,2704],"source":"The [ICorDebugHeapSegmentEnum](../../../../docs/framework/unmanaged-api/debugging/icordebugheapsegmentenum-interface.md) interface object is a standard enumerator derived from the ICorDebugEnum interface that allows you to enumerate [COR_SEGMENT](../../../../docs/framework/unmanaged-api/debugging/cor-segment-structure.md) objects."},{"content":"Each <bpt id=\"p1\">[</bpt>COR_SEGMENT<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/cor-segment-structure.md)</ept> object provides information about the memory range of a particular segment, along with the generation of the objects in that segment.","pos":[2705,2934],"source":" Each [COR_SEGMENT](../../../../docs/framework/unmanaged-api/debugging/cor-segment-structure.md) object provides information about the memory range of a particular segment, along with the generation of the objects in that segment."},{"pos":[2943,2955],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2959,3063],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3070,3106],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> CorDebug.idl, CorDebug.h","source":"**Header:** CorDebug.idl, CorDebug.h"},{"pos":[3113,3138],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> CorGuids.lib","source":"**Library:** CorGuids.lib"},{"pos":[3145,3253],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v45plus](../../../../includes/net-current-v45plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v45plus](../../../../includes/net-current-v45plus-md.md)]"},{"pos":[3262,3270],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>ICorDebugProcess5 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/icordebugprocess5-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[3274,3387],"source":"[ICorDebugProcess5 Interface](../../../../docs/framework/unmanaged-api/debugging/icordebugprocess5-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>Debugging Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md)</ept>","pos":[3391,3489],"source":"[Debugging Interfaces](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md)"}]}