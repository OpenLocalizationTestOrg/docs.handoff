{"content":"---\ntitle: \"Operator Procedures (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"Visual Basic code, procedures\"\n  - \"procedures [Visual Basic], operator\"\n  - \"Visual Basic code, operators\"\n  - \"syntax [Visual Basic], Operator procedures\"\n  - \"operators [Visual Basic], overloading\"\n  - \"overloaded operators [Visual Basic]\"\n  - \"operator overloading\"\n  - \"operator procedures\"\nms.assetid: 8c513d38-246b-4fb7-8b75-29e1364e555b\n---\n# Operator Procedures (Visual Basic)\nAn operator procedure is a series of Visual Basic statements that define the behavior of a standard operator (such as `*`, `<>`, or `And`) on a class or structure you have defined. This is also called *operator overloading*.  \n  \n## When to Define Operator Procedures  \n When you have defined a class or structure, you can declare variables to be of the type of that class or structure. Sometimes such a variable needs to participate in an operation as part of an expression. To do this, it must be an operand of an operator.  \n  \n Visual Basic defines operators only on its fundamental data types. You can define the behavior of an operator when one or both of the operands are of the type of your class or structure.  \n  \n For more information, see [Operator Statement](../../../../visual-basic/language-reference/statements/operator-statement.md).  \n  \n## Types of Operator Procedure  \n An operator procedure can be one of the following types:  \n  \n-   A definition of a unary operator where the argument is of the type of your class or structure.  \n  \n-   A definition of a binary operator where at least one of the arguments is of the type of your class or structure.  \n  \n-   A definition of a conversion operator where the argument is of the type of your class or structure.  \n  \n-   A definition of a conversion operator that returns the type of your class or structure.  \n  \n Conversion operators are always unary, and you always use `CType` as the operator you are defining.  \n  \n## Declaration Syntax  \n The syntax for declaring an operator procedure is as follows:  \n  \n `Public Shared`   `[Widening | Narrowing]`   `Operator`  *operatorsymbol*  `(` *operand1*  `[,`  *operand2* `]) As`  *datatype*  \n  \n `' Statements of the operator procedure.`  \n  \n `End Operator`  \n  \n You use the `Widening` or `Narrowing` keyword only on a type conversion operator. The operator symbol is always [CType Function](../../../../visual-basic/language-reference/functions/ctype-function.md) for a type conversion operator.  \n  \n You declare two operands to define a binary operator, and you declare one operand to define a unary operator, including a type conversion operator. All operands must be declared `ByVal`.  \n  \n You declare each operand the same way you declare parameters for [Sub Procedures](./sub-procedures.md).  \n  \n### Data Type  \n Because you are defining an operator on a class or structure you have defined, at least one of the operands must be of the data type of that class or structure. For a type conversion operator, either the operand or the return type must be of the data type of the class or structure.  \n  \n For more details, see [Operator Statement](../../../../visual-basic/language-reference/statements/operator-statement.md).  \n  \n## Calling Syntax  \n You invoke an operator procedure implicitly by using the operator symbol in an expression. You supply the operands the same way you do for predefined operators.  \n  \n The syntax for an implicit call to an operator procedure is as follows:  \n  \n `Dim testStruct As`  *structurename*  \n  \n `Dim testNewStruct As`  *structurename*  `= testStruct`  *operatorsymbol*  `10`  \n  \n### Illustration of Declaration and Call  \n The following structure stores a signed 128-bit integer value as the constituent high-order and low-order parts. It defines the `+` operator to add two `veryLong` values and generate a resulting `veryLong` value.  \n  \n [!code-vb[VbVbcnProcedures#23](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#23)]  \n  \n The following example shows a typical call to the `+` operator defined on `veryLong`.  \n  \n [!code-vb[VbVbcnProcedures#24](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#24)]  \n\n## See also\n\n- [Procedures](./index.md)\n- [Sub Procedures](./sub-procedures.md)\n- [Function Procedures](./function-procedures.md)\n- [Property Procedures](./property-procedures.md)\n- [Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)\n- [Operator Statement](../../../../visual-basic/language-reference/statements/operator-statement.md)\n- [How to: Define an Operator](./how-to-define-an-operator.md)\n- [How to: Define a Conversion Operator](./how-to-define-a-conversion-operator.md)\n- [How to: Call an Operator Procedure](./how-to-call-an-operator-procedure.md)\n- [How to: Use a Class that Defines Operators](./how-to-use-a-class-that-defines-operators.md)\n","nodes":[{"pos":[4,439],"embed":true,"restype":"x-metadata","content":"title: \"Operator Procedures (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"Visual Basic code, procedures\"\n  - \"procedures [Visual Basic], operator\"\n  - \"Visual Basic code, operators\"\n  - \"syntax [Visual Basic], Operator procedures\"\n  - \"operators [Visual Basic], overloading\"\n  - \"overloaded operators [Visual Basic]\"\n  - \"operator overloading\"\n  - \"operator procedures\"\nms.assetid: 8c513d38-246b-4fb7-8b75-29e1364e555b","nodes":[{"content":"Operator Procedures (Visual Basic)","nodes":[{"pos":[0,34],"content":"Operator Procedures (Visual Basic)","nodes":[{"content":"Operator Procedures (Visual Basic)","pos":[0,34]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[446,480],"content":"Operator Procedures (Visual Basic)","linkify":"Operator Procedures (Visual Basic)","nodes":[{"content":"Operator Procedures (Visual Basic)","pos":[0,34]}]},{"content":"An operator procedure is a series of Visual Basic statements that define the behavior of a standard operator (such as <ph id=\"ph1\">`*`</ph>, <ph id=\"ph2\">`&lt;&gt;`</ph>, or <ph id=\"ph3\">`And`</ph>) on a class or structure you have defined.","pos":[481,661],"source":"An operator procedure is a series of Visual Basic statements that define the behavior of a standard operator (such as `*`, `<>`, or `And`) on a class or structure you have defined."},{"content":"This is also called <bpt id=\"p1\">*</bpt>operator overloading<ept id=\"p1\">*</ept>.","pos":[662,705],"source":" This is also called *operator overloading*."},{"pos":[714,748],"content":"When to Define Operator Procedures","linkify":"When to Define Operator Procedures","nodes":[{"content":"When to Define Operator Procedures","pos":[0,34]}]},{"content":"When you have defined a class or structure, you can declare variables to be of the type of that class or structure.","pos":[752,867]},{"content":"Sometimes such a variable needs to participate in an operation as part of an expression.","pos":[868,956]},{"content":"To do this, it must be an operand of an operator.","pos":[957,1006]},{"content":"Visual Basic defines operators only on its fundamental data types.","pos":[1013,1079]},{"content":"You can define the behavior of an operator when one or both of the operands are of the type of your class or structure.","pos":[1080,1199]},{"pos":[1206,1331],"content":"For more information, see <bpt id=\"p1\">[</bpt>Operator Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/operator-statement.md)</ept>.","source":"For more information, see [Operator Statement](../../../../visual-basic/language-reference/statements/operator-statement.md)."},{"pos":[1340,1367],"content":"Types of Operator Procedure","linkify":"Types of Operator Procedure","nodes":[{"content":"Types of Operator Procedure","pos":[0,27]}]},{"content":"An operator procedure can be one of the following types:","pos":[1371,1427]},{"content":"A definition of a unary operator where the argument is of the type of your class or structure.","pos":[1437,1531]},{"content":"A definition of a binary operator where at least one of the arguments is of the type of your class or structure.","pos":[1541,1653]},{"content":"A definition of a conversion operator where the argument is of the type of your class or structure.","pos":[1663,1762]},{"content":"A definition of a conversion operator that returns the type of your class or structure.","pos":[1772,1859]},{"pos":[1866,1965],"content":"Conversion operators are always unary, and you always use <ph id=\"ph1\">`CType`</ph> as the operator you are defining.","source":"Conversion operators are always unary, and you always use `CType` as the operator you are defining."},{"pos":[1974,1992],"content":"Declaration Syntax","linkify":"Declaration Syntax","nodes":[{"content":"Declaration Syntax","pos":[0,18]}]},{"content":"The syntax for declaring an operator procedure is as follows:","pos":[1996,2057]},{"pos":[2064,2191],"content":"<ph id=\"ph1\">`Public Shared`</ph>   <ph id=\"ph2\">`[Widening | Narrowing]`</ph>   <ph id=\"ph3\">`Operator`</ph>  <bpt id=\"p1\">*</bpt>operatorsymbol<ept id=\"p1\">*</ept>  <ph id=\"ph4\">`(`</ph> <bpt id=\"p2\">*</bpt>operand1<ept id=\"p2\">*</ept>  <ph id=\"ph5\">`[,`</ph>  <bpt id=\"p3\">*</bpt>operand2<ept id=\"p3\">*</ept> <ph id=\"ph6\">`]) As`</ph>  <bpt id=\"p4\">*</bpt>datatype<ept id=\"p4\">*</ept>","source":"`Public Shared`   `[Widening | Narrowing]`   `Operator`  *operatorsymbol*  `(` *operand1*  `[,`  *operand2* `]) As`  *datatype*"},{"content":"You use the <ph id=\"ph1\">`Widening`</ph> or <ph id=\"ph2\">`Narrowing`</ph> keyword only on a type conversion operator.","pos":[2267,2348],"source":"You use the `Widening` or `Narrowing` keyword only on a type conversion operator."},{"content":"The operator symbol is always <bpt id=\"p1\">[</bpt>CType Function<ept id=\"p1\">](../../../../visual-basic/language-reference/functions/ctype-function.md)</ept> for a type conversion operator.","pos":[2349,2500],"source":" The operator symbol is always [CType Function](../../../../visual-basic/language-reference/functions/ctype-function.md) for a type conversion operator."},{"content":"You declare two operands to define a binary operator, and you declare one operand to define a unary operator, including a type conversion operator.","pos":[2507,2654]},{"content":"All operands must be declared <ph id=\"ph1\">`ByVal`</ph>.","pos":[2655,2693],"source":" All operands must be declared `ByVal`."},{"pos":[2700,2803],"content":"You declare each operand the same way you declare parameters for <bpt id=\"p1\">[</bpt>Sub Procedures<ept id=\"p1\">](./sub-procedures.md)</ept>.","source":"You declare each operand the same way you declare parameters for [Sub Procedures](./sub-procedures.md)."},{"pos":[2813,2822],"content":"Data Type","linkify":"Data Type","nodes":[{"content":"Data Type","pos":[0,9]}]},{"content":"Because you are defining an operator on a class or structure you have defined, at least one of the operands must be of the data type of that class or structure.","pos":[2826,2986]},{"content":"For a type conversion operator, either the operand or the return type must be of the data type of the class or structure.","pos":[2987,3108]},{"pos":[3115,3236],"content":"For more details, see <bpt id=\"p1\">[</bpt>Operator Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/operator-statement.md)</ept>.","source":"For more details, see [Operator Statement](../../../../visual-basic/language-reference/statements/operator-statement.md)."},{"pos":[3245,3259],"content":"Calling Syntax","linkify":"Calling Syntax","nodes":[{"content":"Calling Syntax","pos":[0,14]}]},{"content":"You invoke an operator procedure implicitly by using the operator symbol in an expression.","pos":[3263,3353]},{"content":"You supply the operands the same way you do for predefined operators.","pos":[3354,3423]},{"content":"The syntax for an implicit call to an operator procedure is as follows:","pos":[3430,3501]},{"pos":[3508,3544],"content":"<ph id=\"ph1\">`Dim testStruct As`</ph>  <bpt id=\"p1\">*</bpt>structurename<ept id=\"p1\">*</ept>","source":"`Dim testStruct As`  *structurename*"},{"pos":[3551,3630],"content":"<ph id=\"ph1\">`Dim testNewStruct As`</ph>  <bpt id=\"p1\">*</bpt>structurename<ept id=\"p1\">*</ept>  <ph id=\"ph2\">`= testStruct`</ph>  <bpt id=\"p2\">*</bpt>operatorsymbol<ept id=\"p2\">*</ept>  <ph id=\"ph3\">`10`</ph>","source":"`Dim testNewStruct As`  *structurename*  `= testStruct`  *operatorsymbol*  `10`"},{"pos":[3640,3676],"content":"Illustration of Declaration and Call","linkify":"Illustration of Declaration and Call","nodes":[{"content":"Illustration of Declaration and Call","pos":[0,36]}]},{"content":"The following structure stores a signed 128-bit integer value as the constituent high-order and low-order parts.","pos":[3680,3792]},{"content":"It defines the <ph id=\"ph1\">`+`</ph> operator to add two <ph id=\"ph2\">`veryLong`</ph> values and generate a resulting <ph id=\"ph3\">`veryLong`</ph> value.","pos":[3793,3892],"source":" It defines the `+` operator to add two `veryLong` values and generate a resulting `veryLong` value."},{"pos":[4023,4108],"content":"The following example shows a typical call to the <ph id=\"ph1\">`+`</ph> operator defined on <ph id=\"ph2\">`veryLong`</ph>.","source":"The following example shows a typical call to the `+` operator defined on `veryLong`."},{"pos":[4239,4247],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4251,4275],"content":"<bpt id=\"p1\">[</bpt>Procedures<ept id=\"p1\">](./index.md)</ept>","source":"[Procedures](./index.md)"},{"pos":[4278,4315],"content":"<bpt id=\"p1\">[</bpt>Sub Procedures<ept id=\"p1\">](./sub-procedures.md)</ept>","source":"[Sub Procedures](./sub-procedures.md)"},{"pos":[4318,4365],"content":"<bpt id=\"p1\">[</bpt>Function Procedures<ept id=\"p1\">](./function-procedures.md)</ept>","source":"[Function Procedures](./function-procedures.md)"},{"pos":[4368,4415],"content":"<bpt id=\"p1\">[</bpt>Property Procedures<ept id=\"p1\">](./property-procedures.md)</ept>","source":"[Property Procedures](./property-procedures.md)"},{"pos":[4418,4495],"content":"<bpt id=\"p1\">[</bpt>Procedure Parameters and Arguments<ept id=\"p1\">](./procedure-parameters-and-arguments.md)</ept>","source":"[Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)"},{"pos":[4498,4596],"content":"<bpt id=\"p1\">[</bpt>Operator Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/operator-statement.md)</ept>","source":"[Operator Statement](../../../../visual-basic/language-reference/statements/operator-statement.md)"},{"pos":[4599,4659],"content":"<bpt id=\"p1\">[</bpt>How to: Define an Operator<ept id=\"p1\">](./how-to-define-an-operator.md)</ept>","source":"[How to: Define an Operator](./how-to-define-an-operator.md)"},{"pos":[4662,4742],"content":"<bpt id=\"p1\">[</bpt>How to: Define a Conversion Operator<ept id=\"p1\">](./how-to-define-a-conversion-operator.md)</ept>","source":"[How to: Define a Conversion Operator](./how-to-define-a-conversion-operator.md)"},{"pos":[4745,4821],"content":"<bpt id=\"p1\">[</bpt>How to: Call an Operator Procedure<ept id=\"p1\">](./how-to-call-an-operator-procedure.md)</ept>","source":"[How to: Call an Operator Procedure](./how-to-call-an-operator-procedure.md)"},{"pos":[4824,4916],"content":"<bpt id=\"p1\">[</bpt>How to: Use a Class that Defines Operators<ept id=\"p1\">](./how-to-use-a-class-that-defines-operators.md)</ept>","source":"[How to: Use a Class that Defines Operators](./how-to-use-a-class-that-defines-operators.md)"}]}