{"content":"---\ntitle: \"How to: Use the COM+ Service Model Configuration Tool | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"COM+ [WCF], using service model configuration tool\"\nms.assetid: 7e68cd8d-5fda-4641-b92f-290db874376e\ncaps.latest.revision: 13\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Use the COM+ Service Model Configuration Tool\nOnce you have selected an appropriate hosting mode, use the COM+ Service Model Configuration command-line tool (ComSvcConfig.exe) to configure the application interfaces that will be exposed as Web services.  \n  \n> [!NOTE]\n>  You must be an administrator on the machine to perform any of the following tasks.  \n  \n When using ComSvcConfig.exe on a Windows 7 machine to configure a web service to use the latest service model version (currently v4.5), perform the following steps:  \n  \n1.  Set the registry key  `[HKEY_LOCAL_COMPUTER\\SOFTWARE\\Microsoft\\.NETFramework]\\OnlyUseLatestCLR` to a DWORD value of 0x00000001  \n  \n2.  Run comsvcconfig.exe  \n  \n3.  Revert the registry key added in step 1 back to its original value, or delete it if did not exist.  \n  \n> [!IMPORTANT]\n>  Reverting this registry key is important. This is a compatibility key. Not reverting this change may cause issues with other .NET applications running on the machine).  \n  \n> [!WARNING]\n>  When using ComSvcConfig.exe  /install on a Windows 8 machine a dialog is displayed stating \"An app on your PC needs the following Windows feature: .NET Framework 3.5 (includes .NET 2.0 and .NET 3.0\" if .NET Framework 3.5 is not installed. This dialog may be ignored. Alternatively you can sed the OnlyUseLatestCLR registry key to a DWORD value of 0x00000001  \n  \n### To add an interface to the set of interfaces that are to be exposed as Web services, using the COM+ hosting mode  \n  \n-   Run ComSvcConfig using the `/install` and `/hosting:complus` options, as shown in the following example.  \n  \n    ```  \n    ComSvcConfig.exe /install /application:OnlineStore /contract:ItemOrders.Financial,IFinances /hosting:complus /verbose  \n    ```  \n  \n     The command adds the `IFinances` interface of the `ItemOrders.IFinancial` component (from the OnlineStore COM+ application) to the set of interfaces that will be exposed as Web services. The service uses the COM+ hosting mode and therefore requires explicit application activation.  \n  \n     While the wildcard asterisk (*) character can be used for the component and the interface, avoid using it because you might want to expose only selected functionality as a Web service. If run with a future version of this component, using the wildcard may unintentionally expose interfaces that may not have been present when the configuration syntax was determined.  \n  \n     The /verbose option instructs the tool to display warnings in addition to any errors.  \n  \n     The contract for the exposed service will contain all of the methods from the `IFinances` interface.  \n  \n### To add only specific methods from an interface to the set of interfaces that are to be exposed as Web services, using the COM+ hosting mode  \n  \n-   Run ComSvcConfig using the `/install` and `/hosting:complus` options with explicit naming of the required methods, as shown in the following example.  \n  \n    ```  \n    ComSvcConfig.exe /install /application:OnlineStore /contract:ItemOrders.Financial,IFinances.{Credit,Debit} /hosting:complus /verbose  \n    ```  \n  \n     The command adds only the `Credit` and `Debit` methods from the `IFinances` interface as operations to the exposed service contract. All other methods on the interface will be omitted from the contract and will not be callable from Web service clients.  \n  \n### To add an interface to the set of interfaces that are to be exposed as Web services, using the Web hosting mode  \n  \n-   Run ComSvcConfig using the `/install` option and the `/hosting:was` option, as shown in the following example.  \n  \n    ```  \n    ComSvcConfig.exe /install /application:OnlineWarehouse /contract:ItemInventory.Warehouse,IStockLevels /hosting:was /webDirectory:root/OnlineWarehouse /mex /verbose  \n    ```  \n  \n     The command adds the `IStockLevels` interface on the `ItemInventory.Warehouse` component (from the OnlineWarehouse COM+ application) to the set of interfaces that will be exposed as Web services. The service is Web hosted in the OnlineWarehouse virtual directory of IIS rather than in COM+, and thus the application is automatically activated as required.  \n  \n     To use the Web-hosted in-process configuration, the COM+ application must be configured to run as a Library application rather than a Server application using the Component Services administration console. Applications configured as Server applications use the standard Web-hosted mode and incur a process hop to process each request.  \n  \n     The `/mex` option adds an additional Metadata Exchange (MEX) service endpoint that uses the same transport as the application's service endpoint to support clients that want to retrieve a contract definition from the service.  \n  \n### To remove a Web service for a specified interface  \n  \n-   Run ComSvcConfig using the `/uninstall` option, as shown in the following example.  \n  \n    ```  \n    ComSvcConfig.exe /uninstall /application:OnlineStore /contract:ItemOrders.Financial,IFinances /hosting:complus  \n    ```  \n  \n     The command removes the `IFinances` interface on the `ItemOrders.Financial` component (from the OnlineStore COM+ application).  \n  \n### To list currently exposed interfaces  \n  \n-   Run ComSvcConfig using the `/list` option, as shown in the following example.  \n  \n    ```  \n    ComSvcConfig.exe /list  \n    ```  \n  \n     The command lists the currently exposed interfaces, along with the corresponding address and binding details, scoped to the local machine.  \n  \n### To list specific currently exposed interfaces  \n  \n-   Run ComSvcConfig using the `/list` option, as shown in the following example.  \n  \n    ```  \n    ComSvcConfig.exe /list /application:OnlineStore /hosting:complus  \n    ```  \n  \n     The command lists currently exposed COM+-hosted interfaces, along with the corresponding address and binding details, for the OnlineStore COM+ application on the local machine.  \n  \n### To display help on the options that can be used with the utility  \n  \n-   Run ComSvcConfig using the /? option, as shown in the following example.  \n  \n    ```  \n    ComSvcConfig.exe /?  \n  \n    ```  \n  \n## See Also  \n [Integrating with COM+ Applications Overview](../../../../docs/framework/wcf/feature-details/integrating-with-com-plus-applications-overview.md)","nodes":[{"pos":[12,82],"content":"How to: Use the COM+ Service Model Configuration Tool | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Use the COM+ Service Model Configuration Tool | Microsoft Docs","pos":[0,70]}]},{"pos":[460,513],"content":"How to: Use the COM+ Service Model Configuration Tool","linkify":"How to: Use the COM+ Service Model Configuration Tool","nodes":[{"content":"How to: Use the COM+ Service Model Configuration Tool","pos":[0,53]}]},{"content":"Once you have selected an appropriate hosting mode, use the COM+ Service Model Configuration command-line tool (ComSvcConfig.exe) to configure the application interfaces that will be exposed as Web services.","pos":[514,721]},{"pos":[729,822],"content":"[!NOTE]\n You must be an administrator on the machine to perform any of the following tasks.","leadings":["","> "],"nodes":[{"content":"You must be an administrator on the machine to perform any of the following tasks.","pos":[9,91]}]},{"content":"When using ComSvcConfig.exe on a Windows 7 machine to configure a web service to use the latest service model version (currently v4.5), perform the following steps:","pos":[829,993]},{"pos":[1003,1129],"content":"Set the registry key  <ph id=\"ph1\">`[HKEY_LOCAL_COMPUTER\\SOFTWARE\\Microsoft\\.NETFramework]\\OnlyUseLatestCLR`</ph> to a DWORD value of 0x00000001","source":"Set the registry key  `[HKEY_LOCAL_COMPUTER\\SOFTWARE\\Microsoft\\.NETFramework]\\OnlyUseLatestCLR` to a DWORD value of 0x00000001"},{"content":"Run comsvcconfig.exe","pos":[1139,1159]},{"content":"Revert the registry key added in step 1 back to its original value, or delete it if did not exist.","pos":[1169,1267]},{"pos":[1275,1458],"content":"[!IMPORTANT]\n Reverting this registry key is important. This is a compatibility key. Not reverting this change may cause issues with other .NET applications running on the machine).","leadings":["","> "],"nodes":[{"content":" Reverting this registry key is important. This is a compatibility key. Not reverting this change may cause issues with other .NET applications running on the machine).","pos":[13,181],"nodes":[{"content":"Reverting this registry key is important.","pos":[1,42]},{"content":"This is a compatibility key.","pos":[43,71]},{"content":"Not reverting this change may cause issues with other .NET applications running on the machine).","pos":[72,168]}]}]},{"pos":[1466,1837],"content":"[!WARNING]\n When using ComSvcConfig.exe  /install on a Windows 8 machine a dialog is displayed stating \"An app on your PC needs the following Windows feature: .NET Framework 3.5 (includes .NET 2.0 and .NET 3.0\" if .NET Framework 3.5 is not installed. This dialog may be ignored. Alternatively you can sed the OnlyUseLatestCLR registry key to a DWORD value of 0x00000001","leadings":["","> "],"nodes":[{"content":" When using ComSvcConfig.exe  /install on a Windows 8 machine a dialog is displayed stating \"An app on your PC needs the following Windows feature: .NET Framework 3.5 (includes .NET 2.0 and .NET 3.0\" if .NET Framework 3.5 is not installed. This dialog may be ignored. Alternatively you can sed the OnlyUseLatestCLR registry key to a DWORD value of 0x00000001","pos":[11,369],"nodes":[{"content":"When using ComSvcConfig.exe  /install on a Windows 8 machine a dialog is displayed stating \"An app on your PC needs the following Windows feature: .NET Framework 3.5 (includes .NET 2.0 and .NET 3.0\" if .NET Framework 3.5 is not installed.","pos":[1,239]},{"content":"This dialog may be ignored.","pos":[240,267]},{"content":"Alternatively you can sed the OnlyUseLatestCLR registry key to a DWORD value of 0x00000001","pos":[268,358]}]}]},{"pos":[1847,1959],"content":"To add an interface to the set of interfaces that are to be exposed as Web services, using the COM+ hosting mode","linkify":"To add an interface to the set of interfaces that are to be exposed as Web services, using the COM+ hosting mode","nodes":[{"content":"To add an interface to the set of interfaces that are to be exposed as Web services, using the COM+ hosting mode","pos":[0,112]}]},{"pos":[1969,2073],"content":"Run ComSvcConfig using the <ph id=\"ph1\">`/install`</ph> and <ph id=\"ph2\">`/hosting:complus`</ph> options, as shown in the following example.","source":"Run ComSvcConfig using the `/install` and `/hosting:complus` options, as shown in the following example."},{"content":"The command adds the <ph id=\"ph1\">`IFinances`</ph> interface of the <ph id=\"ph2\">`ItemOrders.IFinancial`</ph> component (from the OnlineStore COM+ application) to the set of interfaces that will be exposed as Web services.","pos":[2231,2417],"source":"The command adds the `IFinances` interface of the `ItemOrders.IFinancial` component (from the OnlineStore COM+ application) to the set of interfaces that will be exposed as Web services."},{"content":"The service uses the COM+ hosting mode and therefore requires explicit application activation.","pos":[2418,2512]},{"content":"While the wildcard asterisk (*) character can be used for the component and the interface, avoid using it because you might want to expose only selected functionality as a Web service.","pos":[2523,2707]},{"content":"If run with a future version of this component, using the wildcard may unintentionally expose interfaces that may not have been present when the configuration syntax was determined.","pos":[2708,2889]},{"content":"The /verbose option instructs the tool to display warnings in addition to any errors.","pos":[2900,2985]},{"pos":[2996,3096],"content":"The contract for the exposed service will contain all of the methods from the <ph id=\"ph1\">`IFinances`</ph> interface.","source":"The contract for the exposed service will contain all of the methods from the `IFinances` interface."},{"pos":[3106,3245],"content":"To add only specific methods from an interface to the set of interfaces that are to be exposed as Web services, using the COM+ hosting mode","linkify":"To add only specific methods from an interface to the set of interfaces that are to be exposed as Web services, using the COM+ hosting mode","nodes":[{"content":"To add only specific methods from an interface to the set of interfaces that are to be exposed as Web services, using the COM+ hosting mode","pos":[0,139]}]},{"pos":[3255,3404],"content":"Run ComSvcConfig using the <ph id=\"ph1\">`/install`</ph> and <ph id=\"ph2\">`/hosting:complus`</ph> options with explicit naming of the required methods, as shown in the following example.","source":"Run ComSvcConfig using the `/install` and `/hosting:complus` options with explicit naming of the required methods, as shown in the following example."},{"content":"The command adds only the <ph id=\"ph1\">`Credit`</ph> and <ph id=\"ph2\">`Debit`</ph> methods from the <ph id=\"ph3\">`IFinances`</ph> interface as operations to the exposed service contract.","pos":[3577,3709],"source":"The command adds only the `Credit` and `Debit` methods from the `IFinances` interface as operations to the exposed service contract."},{"content":"All other methods on the interface will be omitted from the contract and will not be callable from Web service clients.","pos":[3710,3829]},{"pos":[3839,3950],"content":"To add an interface to the set of interfaces that are to be exposed as Web services, using the Web hosting mode","linkify":"To add an interface to the set of interfaces that are to be exposed as Web services, using the Web hosting mode","nodes":[{"content":"To add an interface to the set of interfaces that are to be exposed as Web services, using the Web hosting mode","pos":[0,111]}]},{"pos":[3960,4070],"content":"Run ComSvcConfig using the <ph id=\"ph1\">`/install`</ph> option and the <ph id=\"ph2\">`/hosting:was`</ph> option, as shown in the following example.","source":"Run ComSvcConfig using the `/install` option and the `/hosting:was` option, as shown in the following example."},{"content":"The command adds the <ph id=\"ph1\">`IStockLevels`</ph> interface on the <ph id=\"ph2\">`ItemInventory.Warehouse`</ph> component (from the OnlineWarehouse COM+ application) to the set of interfaces that will be exposed as Web services.","pos":[4274,4469],"source":"The command adds the `IStockLevels` interface on the `ItemInventory.Warehouse` component (from the OnlineWarehouse COM+ application) to the set of interfaces that will be exposed as Web services."},{"content":"The service is Web hosted in the OnlineWarehouse virtual directory of IIS rather than in COM+, and thus the application is automatically activated as required.","pos":[4470,4629]},{"content":"To use the Web-hosted in-process configuration, the COM+ application must be configured to run as a Library application rather than a Server application using the Component Services administration console.","pos":[4640,4845]},{"content":"Applications configured as Server applications use the standard Web-hosted mode and incur a process hop to process each request.","pos":[4846,4974]},{"pos":[4985,5210],"content":"The <ph id=\"ph1\">`/mex`</ph> option adds an additional Metadata Exchange (MEX) service endpoint that uses the same transport as the application's service endpoint to support clients that want to retrieve a contract definition from the service.","source":"The `/mex` option adds an additional Metadata Exchange (MEX) service endpoint that uses the same transport as the application's service endpoint to support clients that want to retrieve a contract definition from the service."},{"pos":[5220,5269],"content":"To remove a Web service for a specified interface","linkify":"To remove a Web service for a specified interface","nodes":[{"content":"To remove a Web service for a specified interface","pos":[0,49]}]},{"pos":[5279,5361],"content":"Run ComSvcConfig using the <ph id=\"ph1\">`/uninstall`</ph> option, as shown in the following example.","source":"Run ComSvcConfig using the `/uninstall` option, as shown in the following example."},{"pos":[5512,5638],"content":"The command removes the <ph id=\"ph1\">`IFinances`</ph> interface on the <ph id=\"ph2\">`ItemOrders.Financial`</ph> component (from the OnlineStore COM+ application).","source":"The command removes the `IFinances` interface on the `ItemOrders.Financial` component (from the OnlineStore COM+ application)."},{"pos":[5648,5684],"content":"To list currently exposed interfaces","linkify":"To list currently exposed interfaces","nodes":[{"content":"To list currently exposed interfaces","pos":[0,36]}]},{"pos":[5694,5771],"content":"Run ComSvcConfig using the <ph id=\"ph1\">`/list`</ph> option, as shown in the following example.","source":"Run ComSvcConfig using the `/list` option, as shown in the following example."},{"content":"The command lists the currently exposed interfaces, along with the corresponding address and binding details, scoped to the local machine.","pos":[5834,5972]},{"pos":[5982,6027],"content":"To list specific currently exposed interfaces","linkify":"To list specific currently exposed interfaces","nodes":[{"content":"To list specific currently exposed interfaces","pos":[0,45]}]},{"pos":[6037,6114],"content":"Run ComSvcConfig using the <ph id=\"ph1\">`/list`</ph> option, as shown in the following example.","source":"Run ComSvcConfig using the `/list` option, as shown in the following example."},{"content":"The command lists currently exposed COM+-hosted interfaces, along with the corresponding address and binding details, for the OnlineStore COM+ application on the local machine.","pos":[6219,6395]},{"pos":[6405,6469],"content":"To display help on the options that can be used with the utility","linkify":"To display help on the options that can be used with the utility","nodes":[{"content":"To display help on the options that can be used with the utility","pos":[0,64]}]},{"content":"Run ComSvcConfig using the /?","pos":[6479,6508]},{"content":"option, as shown in the following example.","pos":[6509,6551]},{"pos":[6612,6620],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[6624,6768],"content":"<bpt id=\"p1\">[</bpt>Integrating with COM+ Applications Overview<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/integrating-with-com-plus-applications-overview.md)</ept>","source":"[Integrating with COM+ Applications Overview](../../../../docs/framework/wcf/feature-details/integrating-with-com-plus-applications-overview.md)"}]}