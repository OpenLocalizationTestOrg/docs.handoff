{"content":"---\ntitle: \"Tracking Profiles\"\nms.date: \"03/30/2017\"\nms.assetid: 22682566-1cd9-4672-9791-fb3523638e18\n---\n\n# Tracking Profiles\n\nTracking profiles contain tracking queries that permit a tracking participant to subscribe to workflow events that are emitted when the state of a workflow instance changes at runtime.\n\n## Tracking Profiles\n\nTracking profiles are used to specify which tracking information is emitted for a workflow instance. If no profile is specified, then all tracking events are emitted. If a profile is specified, then the tracking events specified in the profile will be emitted. Depending on your monitoring requirements, you may write a profile that is very general, which subscribes to a small set of high-level state changes on a workflow. Conversely, you may create a very detailed profile whose resulting events are rich enough to reconstruct a detailed execution flow later.\n\nTracking profiles manifest themselves as XML elements within a standard [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] configuration file or specified in code. The following example is of a [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] tracking profile in a configuration file that allows a tracking participant to subscribe to the `Started` and `Completed` workflow events.\n\n```xml\n<system.serviceModel>\n    ...\n    <tracking>\n      <trackingProfile name=\"Sample Tracking Profile\">\n        <workflow activityDefinitionId=\"*\">\n          <workflowInstanceQueries>\n            <workflowInstanceQuery>\n              <states>\n                <state name=\"Started\"/>\n                <state name=\"Completed\"/>\n              </states>\n            </workflowInstanceQuery>\n          </workflowInstanceQueries>\n        </workflow>\n      </trackingProfile>\n    </profiles>\n  </tracking>\n    ...\n</system.serviceModel>\n```\n\nThe following example shows the equivalent tracking profile created using code.\n\n```csharp\nTrackingProfile profile = new TrackingProfile()\n{\n    Name = \"CustomTrackingProfile\",\n    Queries =\n    {\n        new WorkflowInstanceQuery()\n        {\n            // Limit workflow instance tracking records for started and\n            // completed workflow states.\n            States = { WorkflowInstanceStates.Started, WorkflowInstanceStates.Completed },\n        }\n    }\n};\n```\n\nTracking records are filtered through the visibility mode within a tracking profile by using the <xref:System.Activities.Tracking.ImplementationVisibility> attribute. A composite activity is a top-level activity that contains other activities that form its implementation. The visibility mode specifies the tracking records emitted from composite activities within a workflow activity, to specify if activities that form the implementation are being tracked. The visibility mode applies at the tracking profile level. The filtering of tracking records for individual activities within a workflow is controlled by the queries within the tracking profile. For more information, see the **Tracking Profile Query Types** section in this document.\n\nThe two visibility modes specified by the `implementationVisibility` attribute in the tracking profile are `RootScope` and `All`. Using the `RootScope` mode suppresses the tracking records for activities that form the implementation of an activity in the case where a composite activity is not the root of a workflow. This implies that, when an activity that is implemented using other activities is added to a workflow, and the `implementationVisibility` set to RootScope, only the top-level activity within that composite activity is tracked. If an activity is the root of the workflow, then the implementation of the activity is the workflow itself and tracking records are emitted for activities that form the implementation. Using the All mode permits all tracking records to be emitted for the root activity and all its composite activities.\n\nFor example, suppose *MyActivity* is a composite activity whose implementation contains two activities, *Activity1* and *Activity2*. When this activity is added to a workflow and tracking is enabled with a tracking profile with `implementationVisibility` set to `RootScope`, tracking records are emitted only for *MyActivity*. However, no records are emitted for activities *Activity1* and *Activity2*.\n\nHowever, if the `implementationVisibility` attribute for the tracking profile is  set to `All`, then tracking records are emitted not only for *MyActivity*, but also for activities *Activity1* and *Activity2*.\n\nThe `implementationVisibility` flag applies to following tracking record types:\n\n- ActivityStateRecord\n\n- FaultPropagationRecord\n\n- CancelRequestedRecord\n\n- ActivityScheduledRecord\n\n> [!NOTE]\n> CustomTrackingRecords emitted from activity implementation are not filtered out by the implementationVisibility setting.\n\nThe `implementationVisibility` functionality is specified as <xref:System.Activities.Tracking.ImplementationVisibility.RootScope> on the tracking profile in code as follows:\n\n```csharp\nTrackingProfile sampleTrackingProfile = new TrackingProfile()\n{\n    Name = \"Sample Tracking Profile\",\n    ImplementationVisibility = ImplementationVisibility.RootScope\n};\n```\n\nThe `implementationVisibility` functionality is specified as <xref:System.Activities.Tracking.ImplementationVisibility.All> on the tracking profile in a configuration file as follows:\n\n```xml\n<tracking>\n      <profiles>\n        <trackingProfile name=\"Shipping Monitoring\" implementationVisibility=\"All\">\n          <workflow activityDefinitionId=\"*\">\n...\n         </workflow>\n        </trackingProfile>\n      </profiles>\n</tracking>\n```\n\nThe `ImplementationVisibility` setting on the tracking profile is optional. By default, its value is set to `RootScope`. The values for this attribute are also case-sensitive.\n\n### Tracking Profile Query Types\n\nTracking profiles are structured as declarative subscriptions for tracking records that allow you to query the workflow runtime for specific tracking records. There are several query types that allow you subscribe to different classes of <xref:System.Activities.Tracking.TrackingRecord> objects. Tracking profiles can be specified in configuration or through code. Here are the most common query types:\n\n- <xref:System.Activities.Tracking.WorkflowInstanceQuery> - Use this to track workflow instance life cycle changes like the previously-demonstrated `Started` and `Completed`. The <xref:System.Activities.Tracking.WorkflowInstanceQuery> is used to subscribe to the following <xref:System.Activities.Tracking.TrackingRecord> objects:\n\n    - <xref:System.Activities.Tracking.WorkflowInstanceRecord>\n\n    - <xref:System.Activities.Tracking.WorkflowInstanceAbortedRecord>\n\n    - <xref:System.Activities.Tracking.WorkflowInstanceUnhandledExceptionRecord>\n\n    - <xref:System.Activities.Tracking.WorkflowInstanceTerminatedRecord>\n\n    - <xref:System.Activities.Tracking.WorkflowInstanceSuspendedRecord>\n\n    The states that can be subscribed to are specified in the <xref:System.Activities.Tracking.WorkflowInstanceStates> class.\n\n    The configuration or code used to subscribe to workflow instance-level tracking records for the `Started` instance state using the <xref:System.Activities.Tracking.WorkflowInstanceQuery> is shown in the following example.\n\n    ```xml\n    <workflowInstanceQueries>\n        <workflowInstanceQuery>\n          <states>\n            <state name=\"Started\"/>\n          </states>\n        </workflowInstanceQuery>\n    </workflowInstanceQueries>\n    ```\n\n    ```csharp\n    TrackingProfile sampleTrackingProfile = new TrackingProfile()\n    {\n        Name = \"Sample Tracking Profile\",\n        Queries =\n        {\n            new WorkflowInstanceQuery()\n            {\n                States = { WorkflowInstanceStates.Started}\n            }\n        }\n    };\n    ```\n\n- <xref:System.Activities.Tracking.ActivityStateQuery> - Use this to track life cycle changes of the activities that make up a workflow instance. For example, you may want to keep track of every time the \"Send E-Mail\" activity completes within a workflow instance. This query is necessary for a <xref:System.Activities.Tracking.TrackingParticipant> to subscribe to <xref:System.Activities.Tracking.ActivityStateRecord> objects. The available states to subscribe to are specified in <xref:System.Activities.Tracking.ActivityStates>.\n\n    The configuration and code used to subscribe activity state tracking records that use the <xref:System.Activities.Tracking.ActivityStateQuery> for the `SendEmailActivity` activity is shown in the following example.\n\n    ```xml\n    <activityStateQueries>\n      <activityStateQuery activityName=\"SendEmailActivity\">\n        <states>\n          <state name=\"Closed\"/>\n        </states>\n      </activityStateQuery>\n    </activityStateQueries>\n    ```\n\n    ```csharp\n    TrackingProfile sampleTrackingProfile = new TrackingProfile()\n    {\n        Name = \"Sample Tracking Profile\",\n        Queries =\n        {\n            new ActivityStateQuery()\n            {\n                ActivityName = \"SendEmailActivity\",\n                States = { ActivityStates.Closed }\n            }\n        }\n    };\n    ```\n\n    > [!NOTE]\n    > If multiple activityStateQuery elements have the same name, only the states in the last element are used in the tracking profile.\n\n- <xref:System.Activities.Tracking.ActivityScheduledQuery> - This query allows you to track an activity scheduled for execution by a parent activity. The query is necessary for a <xref:System.Activities.Tracking.TrackingParticipant> to subscribe to <xref:System.Activities.Tracking.ActivityScheduledRecord> objects.\n\n    The configuration and code used to subscribe to records related to the `SendEmailActivity` child activity being scheduled using the <xref:System.Activities.Tracking.ActivityScheduledQuery> is shown in the following example.\n\n    ```xml\n    <activityScheduledQueries>\n      <activityScheduledQuery activityName=\"ProcessNotificationsActivity\" childActivityName=\"SendEmailActivity\" />\n     </activityScheduledQueries>\n    ```\n\n    ```csharp\n    TrackingProfile sampleTrackingProfile = new TrackingProfile()\n    {\n        Name = \"Sample Tracking Profile\",\n        Queries =\n        {\n            new ActivityScheduledQuery()\n            {\n                ActivityName = \"ProcessNotificationsActivity\",\n                ChildActivityName = \"SendEmailActivity\"\n            }\n        }\n    };\n    ```\n\n- <xref:System.Activities.Tracking.FaultPropagationQuery> - Use this to track the handling of faults that occur within an activity. The query is necessary for a <xref:System.Activities.Tracking.TrackingParticipant> to subscribe to <xref:System.Activities.Tracking.FaultPropagationRecord> objects.\n\n    The configuration and code used to subscribe to records related to fault propagation using <xref:System.Activities.Tracking.FaultPropagationQuery> is shown in the following example.\n\n    ```xml\n    <faultPropagationQueries>\n      <faultPropagationQuery faultSourceActivityName=\"SendEmailActivity\" faultHandlerActivityName=\"NotificationsFaultHandler\" />\n    </faultPropagationQueries>\n    ```\n\n    ```csharp\n    TrackingProfile sampleTrackingProfile = new TrackingProfile()\n    {\n        Name = \"Sample Tracking Profile\",\n        Queries =\n        {\n            new FaultPropagationQuery()\n            {\n                FaultSourceActivityName = \"SendEmailActivity\",\n                FaultHandlerActivityName = \"NotificationsFaultHandler\"\n            }\n        }\n    };\n    ```\n\n- <xref:System.Activities.Tracking.CancelRequestedQuery> - Use this to track requests to cancel a child activity by the parent activity. The query is necessary for a <xref:System.Activities.Tracking.TrackingParticipant> to subscribe to <xref:System.Activities.Tracking.CancelRequestedRecord> objects.\n\n    The configuration and code used to subscribe to records related to activity cancellation using <xref:System.Activities.Tracking.CancelRequestedQuery> is shown in the following example.\n\n    ```xml\n    <cancelRequestedQueries>\n      <cancelRequestedQuery activityName=\"ProcessNotificationsActivity\" childActivityName=\"SendEmailActivity\" />\n    </cancelRequestedQueries>\n    ```\n\n    ```csharp\n    TrackingProfile sampleTrackingProfile = new TrackingProfile()\n    {\n        Name = \"Sample Tracking Profile\",\n        Queries =\n        {\n            new CancelRequestedQuery()\n            {\n                ActivityName = \"ProcessNotificationsActivity\",\n                ChildActivityName = \"SendEmailActivity\"\n            }\n        }\n    };\n    ```\n\n- <xref:System.Activities.Tracking.CustomTrackingQuery> - Use this to track events that you define in your code activities. The query is necessary for a <xref:System.Activities.Tracking.TrackingParticipant> to subscribe to <xref:System.Activities.Tracking.CustomTrackingRecord> objects.\n\n    The configuration and code used to subscribe to records related to custom tracking records using <xref:System.Activities.Tracking.CustomTrackingQuery> is shown in the following example.\n\n    ```xml\n    <customTrackingQueries>\n      <customTrackingQuery name=\"EmailAddress\" activityName=\"SendEmailActivity\" />\n    </customTrackingQueries>\n    ```\n\n    ```csharp\n    TrackingProfile sampleTrackingProfile = new TrackingProfile()\n    {\n        Name = \"Sample Tracking Profile\",\n        Queries =\n        {\n            new CustomTrackingQuery()\n            {\n                Name = \"EmailAddress\",\n                ActivityName = \"SendEmailActivity\"\n            }\n        }\n    };\n    ```\n\n- <xref:System.Activities.Tracking.BookmarkResumptionQuery> - Use this to track resumption of a bookmark within a workflow instance. This query is necessary for a <xref:System.Activities.Tracking.TrackingParticipant> to subscribe to <xref:System.Activities.Tracking.BookmarkResumptionRecord> objects.\n\n    The configuration and code used to subscribe to records related to bookmark resumption using <xref:System.Activities.Tracking.BookmarkResumptionQuery> is shown in the following example.\n\n    ```xml\n    <bookmarkResumptionQueries>\n      <bookmarkResumptionQuery name=\"SentEmailBookmark\" />\n    </bookmarkResumptionQueries>\n    ```\n\n    ```csharp\n    TrackingProfile sampleTrackingProfile = new TrackingProfile()\n    {\n        Name = \"Sample Tracking Profile\",\n        Queries =\n        {\n            new BookmarkResumptionQuery()\n            {\n                Name = \"sentEmailBookmark\"\n            }\n        }\n    };\n    ```\n\n### Annotations\n\nAnnotations allow you to arbitrarily tag tracking records with a value that can be configured after build time. For example, you might want several tracking records across several workflows to be tagged with \"Mail Server\" == \"Mail Server1\". This makes it easy to find all records with this tag when querying tracking records later.\n\nTo accomplish this, an annotation is added to a tracking query as shown in the following example.\n\n```xml\n<activityStateQuery activityName=\"SendEmailActivity\">\n  <states>\n    <state name=\"Closed\"/>\n  </states>\n  <annotations>\n    <annotation name=\"MailServer\" value=\"Mail Server1\"/>\n  </annotations>\n</activityStateQuery>\n```\n\n### How to Create a Tracking Profile\n\nTracking query elements are used to create a tracking profile using either an XML configuration file or [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)]code. Here is an example of a tracking profile created using a configuration file.\n\n```xml\n<system.serviceModel>\n  <tracking>\n    <profiles>\n      <trackingProfile name=\"Sample Tracking Profile \">\n        <workflow activityDefinitionId=\"*\">\n          <!--Specify the tracking profile query elements to subscribe for tracking records-->\n        </workflow>\n      </trackingProfile>\n    </profiles>\n  </tracking>\n</system.serviceModel>\n```\n\n> [!WARNING]\n> For a WF using the Workflow service host, the tracking profile is typically created using a configuration file. It is also possible to create a tracking profile with code using the tracking profile and tracking query API.\n\nA profile configured as an XML configuration file is applied to a tracking participant using a behavior extension. This is added to a WorkflowServiceHost as described in the later section [Configuring Tracking for a Workflow](configuring-tracking-for-a-workflow.md).\n\nThe verbosity of the tracking records emitted by the host is determined by configuration settings within the tracking profile. A tracking participant subscribes to tracking records by adding queries to a tracking profile. To subscribe to all tracking records, the tracking profile needs to specify all tracking queries using \"\\*\" in the name fields in each of the queries.\n\nHere are some of the common examples of tracking profiles.\n\n- A tracking profile to obtain workflow instance records and faults.\n\n```xml\n<trackingProfile name=\"Instance and Fault Records\">\n  <workflow activityDefinitionId=\"*\">\n    <workflowInstanceQueries>\n      <workflowInstanceQuery>\n        <states>\n          <state name=\"*\" />\n        </states>\n      </workflowInstanceQuery>\n    </workflowInstanceQueries>\n    <activityStateQueries>\n      <activityStateQuery activityName=\"*\">\n        <states>\n          <state name=\"Faulted\"/>\n        </states>\n      </activityStateQuery>\n    </activityStateQueries>\n  </workflow>\n</trackingProfile>\n```\n\n1. A tracking profile to obtain all custom tracking records.\n\n```xml\n<trackingProfile name=\"Instance_And_Custom_Records\">\n  <workflow activityDefinitionId=\"*\">\n    <customTrackingQueries>\n      <customTrackingQuery name=\"*\" activityName=\"*\" />\n    </customTrackingQueries>\n  </workflow>\n</trackingProfile>\n```\n\n## See also\n\n- [SQL Tracking](./samples/sql-tracking.md)\n- [Windows Server App Fabric Monitoring](https://go.microsoft.com/fwlink/?LinkId=201273)\n- [Monitoring Applications with App Fabric](https://go.microsoft.com/fwlink/?LinkId=201275)\n","nodes":[{"pos":[4,101],"embed":true,"restype":"x-metadata","content":"title: \"Tracking Profiles\"\nms.date: \"03/30/2017\"\nms.assetid: 22682566-1cd9-4672-9791-fb3523638e18","nodes":[{"content":"Tracking Profiles","nodes":[{"pos":[0,17],"content":"Tracking Profiles","nodes":[{"content":"Tracking Profiles","pos":[0,17]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[109,126],"content":"Tracking Profiles","linkify":"Tracking Profiles","nodes":[{"content":"Tracking Profiles","pos":[0,17]}]},{"content":"Tracking profiles contain tracking queries that permit a tracking participant to subscribe to workflow events that are emitted when the state of a workflow instance changes at runtime.","pos":[128,312]},{"pos":[317,334],"content":"Tracking Profiles","linkify":"Tracking Profiles","nodes":[{"content":"Tracking Profiles","pos":[0,17]}]},{"content":"Tracking profiles are used to specify which tracking information is emitted for a workflow instance.","pos":[336,436]},{"content":"If no profile is specified, then all tracking events are emitted.","pos":[437,502]},{"content":"If a profile is specified, then the tracking events specified in the profile will be emitted.","pos":[503,596]},{"content":"Depending on your monitoring requirements, you may write a profile that is very general, which subscribes to a small set of high-level state changes on a workflow.","pos":[597,760]},{"content":"Conversely, you may create a very detailed profile whose resulting events are rich enough to reconstruct a detailed execution flow later.","pos":[761,898]},{"content":"Tracking profiles manifest themselves as XML elements within a standard <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]</ph> configuration file or specified in code.","pos":[900,1073],"source":"Tracking profiles manifest themselves as XML elements within a standard [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] configuration file or specified in code."},{"content":"The following example is of a <ph id=\"ph1\">[!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)]</ph> tracking profile in a configuration file that allows a tracking participant to subscribe to the <ph id=\"ph2\">`Started`</ph> and <ph id=\"ph3\">`Completed`</ph> workflow events.","pos":[1074,1317],"source":" The following example is of a [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] tracking profile in a configuration file that allows a tracking participant to subscribe to the `Started` and `Completed` workflow events."},{"content":"The following example shows the equivalent tracking profile created using code.","pos":[1856,1935]},{"content":"Tracking records are filtered through the visibility mode within a tracking profile by using the <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.ImplementationVisibility&gt;</ph> attribute.","pos":[2328,2494],"source":"Tracking records are filtered through the visibility mode within a tracking profile by using the <xref:System.Activities.Tracking.ImplementationVisibility> attribute."},{"content":"A composite activity is a top-level activity that contains other activities that form its implementation.","pos":[2495,2600]},{"content":"The visibility mode specifies the tracking records emitted from composite activities within a workflow activity, to specify if activities that form the implementation are being tracked.","pos":[2601,2786]},{"content":"The visibility mode applies at the tracking profile level.","pos":[2787,2845]},{"content":"The filtering of tracking records for individual activities within a workflow is controlled by the queries within the tracking profile.","pos":[2846,2981]},{"content":"For more information, see the <bpt id=\"p1\">**</bpt>Tracking Profile Query Types<ept id=\"p1\">**</ept> section in this document.","pos":[2982,3070],"source":" For more information, see the **Tracking Profile Query Types** section in this document."},{"content":"The two visibility modes specified by the <ph id=\"ph1\">`implementationVisibility`</ph> attribute in the tracking profile are <ph id=\"ph2\">`RootScope`</ph> and <ph id=\"ph3\">`All`</ph>.","pos":[3072,3201],"source":"The two visibility modes specified by the `implementationVisibility` attribute in the tracking profile are `RootScope` and `All`."},{"content":"Using the <ph id=\"ph1\">`RootScope`</ph> mode suppresses the tracking records for activities that form the implementation of an activity in the case where a composite activity is not the root of a workflow.","pos":[3202,3389],"source":" Using the `RootScope` mode suppresses the tracking records for activities that form the implementation of an activity in the case where a composite activity is not the root of a workflow."},{"content":"This implies that, when an activity that is implemented using other activities is added to a workflow, and the <ph id=\"ph1\">`implementationVisibility`</ph> set to RootScope, only the top-level activity within that composite activity is tracked.","pos":[3390,3616],"source":" This implies that, when an activity that is implemented using other activities is added to a workflow, and the `implementationVisibility` set to RootScope, only the top-level activity within that composite activity is tracked."},{"content":"If an activity is the root of the workflow, then the implementation of the activity is the workflow itself and tracking records are emitted for activities that form the implementation.","pos":[3617,3801]},{"content":"Using the All mode permits all tracking records to be emitted for the root activity and all its composite activities.","pos":[3802,3919]},{"content":"For example, suppose <bpt id=\"p1\">*</bpt>MyActivity<ept id=\"p1\">*</ept> is a composite activity whose implementation contains two activities, <bpt id=\"p2\">*</bpt>Activity1<ept id=\"p2\">*</ept> and <bpt id=\"p3\">*</bpt>Activity2<ept id=\"p3\">*</ept>.","pos":[3921,4053],"source":"For example, suppose *MyActivity* is a composite activity whose implementation contains two activities, *Activity1* and *Activity2*."},{"content":"When this activity is added to a workflow and tracking is enabled with a tracking profile with <ph id=\"ph1\">`implementationVisibility`</ph> set to <ph id=\"ph2\">`RootScope`</ph>, tracking records are emitted only for <bpt id=\"p1\">*</bpt>MyActivity<ept id=\"p1\">*</ept>.","pos":[4054,4247],"source":" When this activity is added to a workflow and tracking is enabled with a tracking profile with `implementationVisibility` set to `RootScope`, tracking records are emitted only for *MyActivity*."},{"content":"However, no records are emitted for activities <bpt id=\"p1\">*</bpt>Activity1<ept id=\"p1\">*</ept> and <bpt id=\"p2\">*</bpt>Activity2<ept id=\"p2\">*</ept>.","pos":[4248,4323],"source":" However, no records are emitted for activities *Activity1* and *Activity2*."},{"pos":[4325,4534],"content":"However, if the <ph id=\"ph1\">`implementationVisibility`</ph> attribute for the tracking profile is  set to <ph id=\"ph2\">`All`</ph>, then tracking records are emitted not only for <bpt id=\"p1\">*</bpt>MyActivity<ept id=\"p1\">*</ept>, but also for activities <bpt id=\"p2\">*</bpt>Activity1<ept id=\"p2\">*</ept> and <bpt id=\"p3\">*</bpt>Activity2<ept id=\"p3\">*</ept>.","source":"However, if the `implementationVisibility` attribute for the tracking profile is  set to `All`, then tracking records are emitted not only for *MyActivity*, but also for activities *Activity1* and *Activity2*."},{"pos":[4536,4615],"content":"The <ph id=\"ph1\">`implementationVisibility`</ph> flag applies to following tracking record types:","source":"The `implementationVisibility` flag applies to following tracking record types:"},{"content":"ActivityStateRecord","pos":[4619,4638]},{"content":"FaultPropagationRecord","pos":[4642,4664]},{"content":"CancelRequestedRecord","pos":[4668,4689]},{"content":"ActivityScheduledRecord","pos":[4693,4716]},{"pos":[4720,4850],"content":"[!NOTE]\nCustomTrackingRecords emitted from activity implementation are not filtered out by the implementationVisibility setting.","leadings":["","> "],"nodes":[{"content":"CustomTrackingRecords emitted from activity implementation are not filtered out by the implementationVisibility setting.","pos":[8,128]}]},{"pos":[4852,5025],"content":"The <ph id=\"ph1\">`implementationVisibility`</ph> functionality is specified as <ph id=\"ph2\">&lt;xref:System.Activities.Tracking.ImplementationVisibility.RootScope&gt;</ph> on the tracking profile in code as follows:","source":"The `implementationVisibility` functionality is specified as <xref:System.Activities.Tracking.ImplementationVisibility.RootScope> on the tracking profile in code as follows:"},{"pos":[5213,5396],"content":"The <ph id=\"ph1\">`implementationVisibility`</ph> functionality is specified as <ph id=\"ph2\">&lt;xref:System.Activities.Tracking.ImplementationVisibility.All&gt;</ph> on the tracking profile in a configuration file as follows:","source":"The `implementationVisibility` functionality is specified as <xref:System.Activities.Tracking.ImplementationVisibility.All> on the tracking profile in a configuration file as follows:"},{"content":"The <ph id=\"ph1\">`ImplementationVisibility`</ph> setting on the tracking profile is optional.","pos":[5650,5725],"source":"The `ImplementationVisibility` setting on the tracking profile is optional."},{"content":"By default, its value is set to <ph id=\"ph1\">`RootScope`</ph>.","pos":[5726,5770],"source":" By default, its value is set to `RootScope`."},{"content":"The values for this attribute are also case-sensitive.","pos":[5771,5825]},{"pos":[5831,5859],"content":"Tracking Profile Query Types","linkify":"Tracking Profile Query Types","nodes":[{"content":"Tracking Profile Query Types","pos":[0,28]}]},{"content":"Tracking profiles are structured as declarative subscriptions for tracking records that allow you to query the workflow runtime for specific tracking records.","pos":[5861,6019]},{"content":"There are several query types that allow you subscribe to different classes of <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.TrackingRecord&gt;</ph> objects.","pos":[6020,6156],"source":" There are several query types that allow you subscribe to different classes of <xref:System.Activities.Tracking.TrackingRecord> objects."},{"content":"Tracking profiles can be specified in configuration or through code.","pos":[6157,6225]},{"content":"Here are the most common query types:","pos":[6226,6263]},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.Tracking.WorkflowInstanceQuery&gt;</ph> - Use this to track workflow instance life cycle changes like the previously-demonstrated <ph id=\"ph2\">`Started`</ph> and <ph id=\"ph3\">`Completed`</ph>.","pos":[6267,6439],"source":"<xref:System.Activities.Tracking.WorkflowInstanceQuery> - Use this to track workflow instance life cycle changes like the previously-demonstrated `Started` and `Completed`."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.WorkflowInstanceQuery&gt;</ph> is used to subscribe to the following <ph id=\"ph2\">&lt;xref:System.Activities.Tracking.TrackingRecord&gt;</ph> objects:","pos":[6440,6595],"source":" The <xref:System.Activities.Tracking.WorkflowInstanceQuery> is used to subscribe to the following <xref:System.Activities.Tracking.TrackingRecord> objects:"},{"pos":[6965,7086],"content":"The states that can be subscribed to are specified in the <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.WorkflowInstanceStates&gt;</ph> class.","source":"The states that can be subscribed to are specified in the <xref:System.Activities.Tracking.WorkflowInstanceStates> class."},{"pos":[7092,7313],"content":"The configuration or code used to subscribe to workflow instance-level tracking records for the <ph id=\"ph1\">`Started`</ph> instance state using the <ph id=\"ph2\">&lt;xref:System.Activities.Tracking.WorkflowInstanceQuery&gt;</ph> is shown in the following example.","source":"The configuration or code used to subscribe to workflow instance-level tracking records for the `Started` instance state using the <xref:System.Activities.Tracking.WorkflowInstanceQuery> is shown in the following example."},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.Tracking.ActivityStateQuery&gt;</ph> - Use this to track life cycle changes of the activities that make up a workflow instance.","pos":[7847,7990],"source":"<xref:System.Activities.Tracking.ActivityStateQuery> - Use this to track life cycle changes of the activities that make up a workflow instance."},{"content":"For example, you may want to keep track of every time the \"Send E-Mail\" activity completes within a workflow instance.","pos":[7991,8109]},{"content":"This query is necessary for a <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.TrackingParticipant&gt;</ph> to subscribe to <ph id=\"ph2\">&lt;xref:System.Activities.Tracking.ActivityStateRecord&gt;</ph> objects.","pos":[8110,8272],"source":" This query is necessary for a <xref:System.Activities.Tracking.TrackingParticipant> to subscribe to <xref:System.Activities.Tracking.ActivityStateRecord> objects."},{"content":"The available states to subscribe to are specified in <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.ActivityStates&gt;</ph>.","pos":[8273,8376],"source":" The available states to subscribe to are specified in <xref:System.Activities.Tracking.ActivityStates>."},{"pos":[8382,8596],"content":"The configuration and code used to subscribe activity state tracking records that use the <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.ActivityStateQuery&gt;</ph> for the <ph id=\"ph2\">`SendEmailActivity`</ph> activity is shown in the following example.","source":"The configuration and code used to subscribe activity state tracking records that use the <xref:System.Activities.Tracking.ActivityStateQuery> for the `SendEmailActivity` activity is shown in the following example."},{"pos":[9185,9328],"content":"[!NOTE]\nIf multiple activityStateQuery elements have the same name, only the states in the last element are used in the tracking profile.","leadings":["","    > "],"nodes":[{"content":"If multiple activityStateQuery elements have the same name, only the states in the last element are used in the tracking profile.","pos":[8,137]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.Tracking.ActivityScheduledQuery&gt;</ph> - This query allows you to track an activity scheduled for execution by a parent activity.","pos":[9332,9479],"source":"<xref:System.Activities.Tracking.ActivityScheduledQuery> - This query allows you to track an activity scheduled for execution by a parent activity."},{"content":"The query is necessary for a <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.TrackingParticipant&gt;</ph> to subscribe to <ph id=\"ph2\">&lt;xref:System.Activities.Tracking.ActivityScheduledRecord&gt;</ph> objects.","pos":[9480,9645],"source":" The query is necessary for a <xref:System.Activities.Tracking.TrackingParticipant> to subscribe to <xref:System.Activities.Tracking.ActivityScheduledRecord> objects."},{"pos":[9651,9874],"content":"The configuration and code used to subscribe to records related to the <ph id=\"ph1\">`SendEmailActivity`</ph> child activity being scheduled using the <ph id=\"ph2\">&lt;xref:System.Activities.Tracking.ActivityScheduledQuery&gt;</ph> is shown in the following example.","source":"The configuration and code used to subscribe to records related to the `SendEmailActivity` child activity being scheduled using the <xref:System.Activities.Tracking.ActivityScheduledQuery> is shown in the following example."},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.Tracking.FaultPropagationQuery&gt;</ph> - Use this to track the handling of faults that occur within an activity.","pos":[10447,10576],"source":"<xref:System.Activities.Tracking.FaultPropagationQuery> - Use this to track the handling of faults that occur within an activity."},{"content":"The query is necessary for a <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.TrackingParticipant&gt;</ph> to subscribe to <ph id=\"ph2\">&lt;xref:System.Activities.Tracking.FaultPropagationRecord&gt;</ph> objects.","pos":[10577,10741],"source":" The query is necessary for a <xref:System.Activities.Tracking.TrackingParticipant> to subscribe to <xref:System.Activities.Tracking.FaultPropagationRecord> objects."},{"pos":[10747,10928],"content":"The configuration and code used to subscribe to records related to fault propagation using <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.FaultPropagationQuery&gt;</ph> is shown in the following example.","source":"The configuration and code used to subscribe to records related to fault propagation using <xref:System.Activities.Tracking.FaultPropagationQuery> is shown in the following example."},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.Tracking.CancelRequestedQuery&gt;</ph> - Use this to track requests to cancel a child activity by the parent activity.","pos":[11526,11660],"source":"<xref:System.Activities.Tracking.CancelRequestedQuery> - Use this to track requests to cancel a child activity by the parent activity."},{"content":"The query is necessary for a <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.TrackingParticipant&gt;</ph> to subscribe to <ph id=\"ph2\">&lt;xref:System.Activities.Tracking.CancelRequestedRecord&gt;</ph> objects.","pos":[11661,11824],"source":" The query is necessary for a <xref:System.Activities.Tracking.TrackingParticipant> to subscribe to <xref:System.Activities.Tracking.CancelRequestedRecord> objects."},{"pos":[11830,12014],"content":"The configuration and code used to subscribe to records related to activity cancellation using <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.CancelRequestedQuery&gt;</ph> is shown in the following example.","source":"The configuration and code used to subscribe to records related to activity cancellation using <xref:System.Activities.Tracking.CancelRequestedQuery> is shown in the following example."},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.Tracking.CustomTrackingQuery&gt;</ph> - Use this to track events that you define in your code activities.","pos":[12578,12699],"source":"<xref:System.Activities.Tracking.CustomTrackingQuery> - Use this to track events that you define in your code activities."},{"content":"The query is necessary for a <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.TrackingParticipant&gt;</ph> to subscribe to <ph id=\"ph2\">&lt;xref:System.Activities.Tracking.CustomTrackingRecord&gt;</ph> objects.","pos":[12700,12862],"source":" The query is necessary for a <xref:System.Activities.Tracking.TrackingParticipant> to subscribe to <xref:System.Activities.Tracking.CustomTrackingRecord> objects."},{"pos":[12868,13053],"content":"The configuration and code used to subscribe to records related to custom tracking records using <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.CustomTrackingQuery&gt;</ph> is shown in the following example.","source":"The configuration and code used to subscribe to records related to custom tracking records using <xref:System.Activities.Tracking.CustomTrackingQuery> is shown in the following example."},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.Tracking.BookmarkResumptionQuery&gt;</ph> - Use this to track resumption of a bookmark within a workflow instance.","pos":[13555,13685],"source":"<xref:System.Activities.Tracking.BookmarkResumptionQuery> - Use this to track resumption of a bookmark within a workflow instance."},{"content":"This query is necessary for a <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.TrackingParticipant&gt;</ph> to subscribe to <ph id=\"ph2\">&lt;xref:System.Activities.Tracking.BookmarkResumptionRecord&gt;</ph> objects.","pos":[13686,13853],"source":" This query is necessary for a <xref:System.Activities.Tracking.TrackingParticipant> to subscribe to <xref:System.Activities.Tracking.BookmarkResumptionRecord> objects."},{"pos":[13859,14044],"content":"The configuration and code used to subscribe to records related to bookmark resumption using <ph id=\"ph1\">&lt;xref:System.Activities.Tracking.BookmarkResumptionQuery&gt;</ph> is shown in the following example.","source":"The configuration and code used to subscribe to records related to bookmark resumption using <xref:System.Activities.Tracking.BookmarkResumptionQuery> is shown in the following example."},{"pos":[14489,14500],"content":"Annotations","linkify":"Annotations","nodes":[{"content":"Annotations","pos":[0,11]}]},{"content":"Annotations allow you to arbitrarily tag tracking records with a value that can be configured after build time.","pos":[14502,14613]},{"content":"For example, you might want several tracking records across several workflows to be tagged with \"Mail Server\" == \"Mail Server1\".","pos":[14614,14742]},{"content":"This makes it easy to find all records with this tag when querying tracking records later.","pos":[14743,14833]},{"content":"To accomplish this, an annotation is added to a tracking query as shown in the following example.","pos":[14835,14932]},{"pos":[15166,15198],"content":"How to Create a Tracking Profile","linkify":"How to Create a Tracking Profile","nodes":[{"content":"How to Create a Tracking Profile","pos":[0,32]}]},{"content":"Tracking query elements are used to create a tracking profile using either an XML configuration file or <ph id=\"ph1\">[!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)]</ph>code.","pos":[15200,15383],"source":"Tracking query elements are used to create a tracking profile using either an XML configuration file or [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)]code."},{"content":"Here is an example of a tracking profile created using a configuration file.","pos":[15384,15460]},{"pos":[15819,16053],"content":"[!WARNING]\nFor a WF using the Workflow service host, the tracking profile is typically created using a configuration file. It is also possible to create a tracking profile with code using the tracking profile and tracking query API.","leadings":["","> "],"nodes":[{"content":"For a WF using the Workflow service host, the tracking profile is typically created using a configuration file. It is also possible to create a tracking profile with code using the tracking profile and tracking query API.","pos":[11,232],"nodes":[{"content":"For a WF using the Workflow service host, the tracking profile is typically created using a configuration file.","pos":[0,111]},{"content":"It is also possible to create a tracking profile with code using the tracking profile and tracking query API.","pos":[112,221]}]}]},{"content":"A profile configured as an XML configuration file is applied to a tracking participant using a behavior extension.","pos":[16055,16169]},{"content":"This is added to a WorkflowServiceHost as described in the later section <bpt id=\"p1\">[</bpt>Configuring Tracking for a Workflow<ept id=\"p1\">](configuring-tracking-for-a-workflow.md)</ept>.","pos":[16170,16321],"source":" This is added to a WorkflowServiceHost as described in the later section [Configuring Tracking for a Workflow](configuring-tracking-for-a-workflow.md)."},{"content":"The verbosity of the tracking records emitted by the host is determined by configuration settings within the tracking profile.","pos":[16323,16449]},{"content":"A tracking participant subscribes to tracking records by adding queries to a tracking profile.","pos":[16450,16544]},{"content":"To subscribe to all tracking records, the tracking profile needs to specify all tracking queries using \"<ph id=\"ph1\">\\*</ph>\" in the name fields in each of the queries.","pos":[16545,16695],"source":" To subscribe to all tracking records, the tracking profile needs to specify all tracking queries using \"\\*\" in the name fields in each of the queries."},{"content":"Here are some of the common examples of tracking profiles.","pos":[16697,16755]},{"content":"A tracking profile to obtain workflow instance records and faults.","pos":[16759,16825]},{"content":"A tracking profile to obtain all custom tracking records.","pos":[17347,17404]},{"pos":[17658,17666],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[17670,17711],"content":"<bpt id=\"p1\">[</bpt>SQL Tracking<ept id=\"p1\">](./samples/sql-tracking.md)</ept>","source":"[SQL Tracking](./samples/sql-tracking.md)"},{"pos":[17714,17800],"content":"<bpt id=\"p1\">[</bpt>Windows Server App Fabric Monitoring<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=201273)</ept>","source":"[Windows Server App Fabric Monitoring](https://go.microsoft.com/fwlink/?LinkId=201273)"},{"pos":[17803,17892],"content":"<bpt id=\"p1\">[</bpt>Monitoring Applications with App Fabric<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=201275)</ept>","source":"[Monitoring Applications with App Fabric](https://go.microsoft.com/fwlink/?LinkId=201275)"}]}