{"content":"---\ntitle: \"IHostTaskManager::CallNeedsHostHook Method\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"IHostTaskManager.CallNeedsHostHook\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostTaskManager::CallNeedsHostHook\"\nhelpviewer_keywords: \n  - \"CallNeedsHostHook method [.NET Framework hosting]\"\n  - \"IHostTaskManager::CallNeedsHostHook method [.NET Framework hosting]\"\nms.assetid: b60f1f59-9825-4b57-961f-d2979518e6a7\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# IHostTaskManager::CallNeedsHostHook Method\nEnables the host to specify whether the common language runtime (CLR) can inline the specified call to an unmanaged function.  \n  \n## Syntax  \n  \n```  \nHRESULT CallNeedsHostHook (  \n    [in]  SIZE_T target,   \n    [out] BOOL   *pbCallNeedsHostHook  \n);  \n```  \n  \n## Parameters  \n `target`  \n [in] The address within the mapped portable executable (PE) file of the unmanaged function that is to be called.  \n  \n `pbCallNeedsHostHook`  \n [out] A pointer to a Boolean value that indicates whether the host requires the call to be hooked.  \n  \n## Return Value  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|`CallNeedsHostHook` returned successfully.|  \n|HOST_E_CLRNOTAVAILABLE|The CLR has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.|  \n|HOST_E_TIMEOUT|The call timed out.|  \n|HOST_E_NOT_OWNER|The caller does not own the lock.|  \n|HOST_E_ABANDONED|An event was canceled while a blocked thread or fiber was waiting on it.|  \n|E_FAIL|An unknown catastrophic failure has occurred. When a method returns E_FAIL, the CLR is no longer usable within the process. Subsequent calls to hosting methods return HOST_E_CLRNOTAVAILABLE.|  \n  \n## Remarks  \n To help optimize code execution, the CLR performs an analysis of each platform invoke call during compilation to determine whether the call can be inlined. `CallNeedsHostHook` enables the host to override that decision by requiring that a call to an unmanaged function be hooked. If the host requires a hook, the runtime does not inline the call.  \n  \n The host typically would require a hook where it must adjust a floating-point state, or upon receiving notification that a call is entering a state where the host cannot track the runtime's requests for memory or any locks taken. When the host requires that the call be hooked, the runtime notifies the host of transitions to and from managed code by using calls to [EnterRuntime](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-enterruntime-method.md), [LeaveRuntime](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-leaveruntime-method.md), [ReverseEnterRuntime](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-reverseenterruntime-method.md), and [ReverseLeaveRuntime](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-reverseleaveruntime-method.md).  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See also\n\n- [ICLRTask Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md)\n- [ICLRTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)\n- [IHostTask Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md)\n- [IHostTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-interface.md)\n","nodes":[{"pos":[4,506],"embed":true,"restype":"x-metadata","content":"title: \"IHostTaskManager::CallNeedsHostHook Method\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"IHostTaskManager.CallNeedsHostHook\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostTaskManager::CallNeedsHostHook\"\nhelpviewer_keywords: \n  - \"CallNeedsHostHook method [.NET Framework hosting]\"\n  - \"IHostTaskManager::CallNeedsHostHook method [.NET Framework hosting]\"\nms.assetid: b60f1f59-9825-4b57-961f-d2979518e6a7\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"IHostTaskManager::CallNeedsHostHook Method","nodes":[{"pos":[0,42],"content":"IHostTaskManager::CallNeedsHostHook Method","nodes":[{"content":"IHostTaskManager::CallNeedsHostHook Method","pos":[0,42]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[513,555],"content":"IHostTaskManager::CallNeedsHostHook Method","linkify":"IHostTaskManager::CallNeedsHostHook Method","nodes":[{"content":"IHostTaskManager::CallNeedsHostHook Method","pos":[0,42]}]},{"content":"Enables the host to specify whether the common language runtime (CLR) can inline the specified call to an unmanaged function.","pos":[556,681]},{"pos":[690,696],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[823,833],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The address within the mapped portable executable (PE) file of the unmanaged function that is to be called.","pos":[849,961]},{"content":"[out] A pointer to a Boolean value that indicates whether the host requires the call to be hooked.","pos":[993,1091]},{"pos":[1100,1112],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"HRESULT","pos":[1119,1126]},{"content":"Description","pos":[1127,1138]},{"content":"S_OK","pos":[1179,1183]},{"pos":[1184,1226],"content":"<ph id=\"ph1\">`CallNeedsHostHook`</ph> returned successfully.","source":"`CallNeedsHostHook` returned successfully."},{"content":"HOST_E_CLRNOTAVAILABLE","pos":[1231,1253]},{"content":"The CLR has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.","pos":[1254,1392]},{"content":"HOST_E_TIMEOUT","pos":[1397,1411]},{"content":"The call timed out.","pos":[1412,1431]},{"content":"HOST_E_NOT_OWNER","pos":[1436,1452]},{"content":"The caller does not own the lock.","pos":[1453,1486]},{"content":"HOST_E_ABANDONED","pos":[1491,1507]},{"content":"An event was canceled while a blocked thread or fiber was waiting on it.","pos":[1508,1580]},{"content":"E_FAIL","pos":[1585,1591]},{"content":"An unknown catastrophic failure has occurred.","pos":[1592,1637]},{"content":"When a method returns E_FAIL, the CLR is no longer usable within the process.","pos":[1638,1715]},{"content":"Subsequent calls to hosting methods return HOST_E_CLRNOTAVAILABLE.","pos":[1716,1782]},{"pos":[1792,1799],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"To help optimize code execution, the CLR performs an analysis of each platform invoke call during compilation to determine whether the call can be inlined.","pos":[1803,1958]},{"content":"<ph id=\"ph1\">`CallNeedsHostHook`</ph> enables the host to override that decision by requiring that a call to an unmanaged function be hooked.","pos":[1959,2082],"source":"`CallNeedsHostHook` enables the host to override that decision by requiring that a call to an unmanaged function be hooked."},{"content":"If the host requires a hook, the runtime does not inline the call.","pos":[2083,2149]},{"content":"The host typically would require a hook where it must adjust a floating-point state, or upon receiving notification that a call is entering a state where the host cannot track the runtime's requests for memory or any locks taken.","pos":[2156,2385]},{"content":"When the host requires that the call be hooked, the runtime notifies the host of transitions to and from managed code by using calls to <bpt id=\"p1\">[</bpt>EnterRuntime<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-enterruntime-method.md)</ept>, <bpt id=\"p2\">[</bpt>LeaveRuntime<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-leaveruntime-method.md)</ept>, <bpt id=\"p3\">[</bpt>ReverseEnterRuntime<ept id=\"p3\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-reverseenterruntime-method.md)</ept>, and <bpt id=\"p4\">[</bpt>ReverseLeaveRuntime<ept id=\"p4\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-reverseleaveruntime-method.md)</ept>.","pos":[2386,2977],"source":" When the host requires that the call be hooked, the runtime notifies the host of transitions to and from managed code by using calls to [EnterRuntime](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-enterruntime-method.md), [LeaveRuntime](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-leaveruntime-method.md), [ReverseEnterRuntime](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-reverseenterruntime-method.md), and [ReverseLeaveRuntime](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-reverseleaveruntime-method.md)."},{"pos":[2986,2998],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3002,3106],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3113,3134],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[3141,3191],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[3198,3306],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[3315,3323],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3327,3419],"content":"<bpt id=\"p1\">[</bpt>ICLRTask Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md)</ept>","source":"[ICLRTask Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md)"},{"pos":[3422,3528],"content":"<bpt id=\"p1\">[</bpt>ICLRTaskManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)</ept>","source":"[ICLRTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)"},{"pos":[3531,3625],"content":"<bpt id=\"p1\">[</bpt>IHostTask Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md)</ept>","source":"[IHostTask Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md)"},{"pos":[3628,3736],"content":"<bpt id=\"p1\">[</bpt>IHostTaskManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-interface.md)</ept>","source":"[IHostTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-interface.md)"}]}