{"content":"---\ntitle: \"Group Join Clause (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.QueryGroupJoinIn\"\n  - \"vb.QueryGroupJoinOn\"\n  - \"vb.QueryGroupJoin\"\n  - \"vb.QueryGroupJoinInto\"\nhelpviewer_keywords: \n  - \"Group Join clause [Visual Basic]\"\n  - \"Group Join statement [Visual Basic]\"\n  - \"queries [Visual Basic], Group Join\"\nms.assetid: 37dbf79c-7b5c-421b-bbb7-dadfd2b92a1c\n---\n# Group Join Clause (Visual Basic)\nCombines two collections into a single hierarchical collection. The join operation is based on matching keys.  \n  \n## Syntax  \n  \n```  \nGroup Join element [As type] In collection _  \n  On key1 Equals key2 [ And key3 Equals key4 [... ] ] _  \n  Into expressionList  \n```  \n  \n## Parts  \n  \n|Term|Definition|  \n|---|---|  \n|`element`|Required. The control variable for the collection being joined.|  \n|`type`|Optional. The type of `element`. If no `type` is specified, the type of `element` is inferred from `collection`.|  \n|`collection`|Required. The collection to combine with the collection that is on the left side of the `Group Join` operator. A `Group Join` clause can be nested in a `Join` clause or in another `Group Join` clause.|  \n|`key1` `Equals` `key2`|Required. Identifies keys for the collections being joined. You must use the `Equals` operator to compare keys from the collections being joined. You can combine join conditions by using the `And` operator to identify multiple keys. The `key1` parameter must be from the collection on the left side of the `Join` operator. The `key2` parameter must be from the collection on the right side of the `Join` operator.<br /><br /> The keys used in the join condition can be expressions that include more than one item from the collection. However, each key expression can contain only items from its respective collection.|  \n|`expressionList`|Required. One or more expressions that identify how the groups of elements from the collection are aggregated. To identify a member name for the grouped results, use the `Group` keyword (`<alias> = Group`). You can also include aggregate functions to apply to the group.|  \n  \n## Remarks  \n The `Group Join` clause combines two collections based on matching key values from the collections being joined. The resulting collection can contain a member that references a collection of elements from the second collection that match the key value from the first collection. You can also specify aggregate functions to apply to the grouped elements from the second collection. For information about aggregate functions, see [Aggregate Clause](../../../visual-basic/language-reference/queries/aggregate-clause.md).  \n  \n Consider, for example, a collection of managers and a collection of employees. Elements from both collections have a ManagerID property that identifies the employees that report to a particular manager. The results from a join operation would contain a result for each manager and employee with a matching ManagerID value. The results from a `Group Join` operation would contain the complete list of managers. Each manager result would have a member that referenced the list of employees that were a match for the specific manager.  \n  \n The collection resulting from a `Group Join` operation can contain any combination of values from the collection identified in the `From` clause and the expressions identified in the `Into` clause of the `Group Join` clause. For more information about valid expressions for the `Into` clause, see [Aggregate Clause](../../../visual-basic/language-reference/queries/aggregate-clause.md).  \n  \n A `Group Join` operation will return all results from the collection identified on the left side of the `Group Join` operator. This is true even if there are no matches in the collection being joined. This is like a `LEFT OUTER JOIN` in SQL.  \n  \n You can use the `Join` clause to combine collections into a single collection. This is equivalent to an `INNER JOIN` in SQL.  \n  \n## Example  \n The following code example joins two collections by using the `Group Join` clause.  \n  \n [!code-vb[VbSimpleQuerySamples#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbSimpleQuerySamples/VB/QuerySamples1.vb#14)]  \n  \n## See also\n\n- [Introduction to LINQ in Visual Basic](../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)\n- [Queries](../../../visual-basic/language-reference/queries/index.md)\n- [Select Clause](../../../visual-basic/language-reference/queries/select-clause.md)\n- [From Clause](../../../visual-basic/language-reference/queries/from-clause.md)\n- [Join Clause](../../../visual-basic/language-reference/queries/join-clause.md)\n- [Where Clause](../../../visual-basic/language-reference/queries/where-clause.md)\n- [Group By Clause](../../../visual-basic/language-reference/queries/group-by-clause.md)\n","nodes":[{"pos":[4,376],"embed":true,"restype":"x-metadata","content":"title: \"Group Join Clause (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.QueryGroupJoinIn\"\n  - \"vb.QueryGroupJoinOn\"\n  - \"vb.QueryGroupJoin\"\n  - \"vb.QueryGroupJoinInto\"\nhelpviewer_keywords: \n  - \"Group Join clause [Visual Basic]\"\n  - \"Group Join statement [Visual Basic]\"\n  - \"queries [Visual Basic], Group Join\"\nms.assetid: 37dbf79c-7b5c-421b-bbb7-dadfd2b92a1c","nodes":[{"content":"Group Join Clause (Visual Basic)","nodes":[{"pos":[0,32],"content":"Group Join Clause (Visual Basic)","nodes":[{"content":"Group Join Clause (Visual Basic)","pos":[0,32]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[383,415],"content":"Group Join Clause (Visual Basic)","linkify":"Group Join Clause (Visual Basic)","nodes":[{"content":"Group Join Clause (Visual Basic)","pos":[0,32]}]},{"content":"Combines two collections into a single hierarchical collection.","pos":[416,479]},{"content":"The join operation is based on matching keys.","pos":[480,525]},{"pos":[534,540],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[693,698],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"content":"Term","pos":[705,709]},{"content":"Definition","pos":[710,720]},{"content":"Required.","pos":[747,756]},{"content":"The control variable for the collection being joined.","pos":[757,810]},{"content":"Optional.","pos":[822,831]},{"content":"The type of <ph id=\"ph1\">`element`</ph>.","pos":[832,854],"source":" The type of `element`."},{"content":"If no <ph id=\"ph1\">`type`</ph> is specified, the type of <ph id=\"ph2\">`element`</ph> is inferred from <ph id=\"ph3\">`collection`</ph>.","pos":[855,934],"source":" If no `type` is specified, the type of `element` is inferred from `collection`."},{"content":"Required.","pos":[952,961]},{"content":"The collection to combine with the collection that is on the left side of the <ph id=\"ph1\">`Group Join`</ph> operator.","pos":[962,1062],"source":" The collection to combine with the collection that is on the left side of the `Group Join` operator."},{"content":"A <ph id=\"ph1\">`Group Join`</ph> clause can be nested in a <ph id=\"ph2\">`Join`</ph> clause or in another <ph id=\"ph3\">`Group Join`</ph> clause.","pos":[1063,1152],"source":" A `Group Join` clause can be nested in a `Join` clause or in another `Group Join` clause."},{"pos":[1157,1179],"content":"<ph id=\"ph1\">`key1`</ph> <ph id=\"ph2\">`Equals`</ph> <ph id=\"ph3\">`key2`</ph>","source":"`key1` `Equals` `key2`"},{"content":"Required.","pos":[1180,1189]},{"content":"Identifies keys for the collections being joined.","pos":[1190,1239]},{"content":"You must use the <ph id=\"ph1\">`Equals`</ph> operator to compare keys from the collections being joined.","pos":[1240,1325],"source":" You must use the `Equals` operator to compare keys from the collections being joined."},{"content":"You can combine join conditions by using the <ph id=\"ph1\">`And`</ph> operator to identify multiple keys.","pos":[1326,1412],"source":" You can combine join conditions by using the `And` operator to identify multiple keys."},{"content":"The <ph id=\"ph1\">`key1`</ph> parameter must be from the collection on the left side of the <ph id=\"ph2\">`Join`</ph> operator.","pos":[1413,1502],"source":" The `key1` parameter must be from the collection on the left side of the `Join` operator."},{"content":"The <ph id=\"ph1\">`key2`</ph> parameter must be from the collection on the right side of the <ph id=\"ph2\">`Join`</ph> operator.","pos":[1503,1593],"source":" The `key2` parameter must be from the collection on the right side of the `Join` operator."},{"content":"The keys used in the join condition can be expressions that include more than one item from the collection.","pos":[1606,1713]},{"content":"However, each key expression can contain only items from its respective collection.","pos":[1714,1797]},{"content":"Required.","pos":[1819,1828]},{"content":"One or more expressions that identify how the groups of elements from the collection are aggregated.","pos":[1829,1929]},{"content":"To identify a member name for the grouped results, use the <ph id=\"ph1\">`Group`</ph> keyword (<ph id=\"ph2\">`&lt;alias&gt; = Group`</ph>).","pos":[1930,2025],"source":" To identify a member name for the grouped results, use the `Group` keyword (`<alias> = Group`)."},{"content":"You can also include aggregate functions to apply to the group.","pos":[2026,2089]},{"pos":[2099,2106],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`Group Join`</ph> clause combines two collections based on matching key values from the collections being joined.","pos":[2110,2222],"source":"The `Group Join` clause combines two collections based on matching key values from the collections being joined."},{"content":"The resulting collection can contain a member that references a collection of elements from the second collection that match the key value from the first collection.","pos":[2223,2388]},{"content":"You can also specify aggregate functions to apply to the grouped elements from the second collection.","pos":[2389,2490]},{"content":"For information about aggregate functions, see <bpt id=\"p1\">[</bpt>Aggregate Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/aggregate-clause.md)</ept>.","pos":[2491,2627],"source":" For information about aggregate functions, see [Aggregate Clause](../../../visual-basic/language-reference/queries/aggregate-clause.md)."},{"content":"Consider, for example, a collection of managers and a collection of employees.","pos":[2634,2712]},{"content":"Elements from both collections have a ManagerID property that identifies the employees that report to a particular manager.","pos":[2713,2836]},{"content":"The results from a join operation would contain a result for each manager and employee with a matching ManagerID value.","pos":[2837,2956]},{"content":"The results from a <ph id=\"ph1\">`Group Join`</ph> operation would contain the complete list of managers.","pos":[2957,3043],"source":" The results from a `Group Join` operation would contain the complete list of managers."},{"content":"Each manager result would have a member that referenced the list of employees that were a match for the specific manager.","pos":[3044,3165]},{"content":"The collection resulting from a <ph id=\"ph1\">`Group Join`</ph> operation can contain any combination of values from the collection identified in the <ph id=\"ph2\">`From`</ph> clause and the expressions identified in the <ph id=\"ph3\">`Into`</ph> clause of the <ph id=\"ph4\">`Group Join`</ph> clause.","pos":[3172,3396],"source":"The collection resulting from a `Group Join` operation can contain any combination of values from the collection identified in the `From` clause and the expressions identified in the `Into` clause of the `Group Join` clause."},{"content":"For more information about valid expressions for the <ph id=\"ph1\">`Into`</ph> clause, see <bpt id=\"p1\">[</bpt>Aggregate Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/aggregate-clause.md)</ept>.","pos":[3397,3558],"source":" For more information about valid expressions for the `Into` clause, see [Aggregate Clause](../../../visual-basic/language-reference/queries/aggregate-clause.md)."},{"content":"A <ph id=\"ph1\">`Group Join`</ph> operation will return all results from the collection identified on the left side of the <ph id=\"ph2\">`Group Join`</ph> operator.","pos":[3565,3691],"source":"A `Group Join` operation will return all results from the collection identified on the left side of the `Group Join` operator."},{"content":"This is true even if there are no matches in the collection being joined.","pos":[3692,3765]},{"content":"This is like a <ph id=\"ph1\">`LEFT OUTER JOIN`</ph> in SQL.","pos":[3766,3806],"source":" This is like a `LEFT OUTER JOIN` in SQL."},{"content":"You can use the <ph id=\"ph1\">`Join`</ph> clause to combine collections into a single collection.","pos":[3813,3891],"source":"You can use the `Join` clause to combine collections into a single collection."},{"content":"This is equivalent to an <ph id=\"ph1\">`INNER JOIN`</ph> in SQL.","pos":[3892,3937],"source":" This is equivalent to an `INNER JOIN` in SQL."},{"pos":[3946,3953],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3957,4039],"content":"The following code example joins two collections by using the <ph id=\"ph1\">`Group Join`</ph> clause.","source":"The following code example joins two collections by using the `Group Join` clause."},{"pos":[4187,4195],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4199,4325],"content":"<bpt id=\"p1\">[</bpt>Introduction to LINQ in Visual Basic<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)</ept>","source":"[Introduction to LINQ in Visual Basic](../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)"},{"pos":[4328,4396],"content":"<bpt id=\"p1\">[</bpt>Queries<ept id=\"p1\">](../../../visual-basic/language-reference/queries/index.md)</ept>","source":"[Queries](../../../visual-basic/language-reference/queries/index.md)"},{"pos":[4399,4481],"content":"<bpt id=\"p1\">[</bpt>Select Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/select-clause.md)</ept>","source":"[Select Clause](../../../visual-basic/language-reference/queries/select-clause.md)"},{"pos":[4484,4562],"content":"<bpt id=\"p1\">[</bpt>From Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/from-clause.md)</ept>","source":"[From Clause](../../../visual-basic/language-reference/queries/from-clause.md)"},{"pos":[4565,4643],"content":"<bpt id=\"p1\">[</bpt>Join Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/join-clause.md)</ept>","source":"[Join Clause](../../../visual-basic/language-reference/queries/join-clause.md)"},{"pos":[4646,4726],"content":"<bpt id=\"p1\">[</bpt>Where Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/where-clause.md)</ept>","source":"[Where Clause](../../../visual-basic/language-reference/queries/where-clause.md)"},{"pos":[4729,4815],"content":"<bpt id=\"p1\">[</bpt>Group By Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/group-by-clause.md)</ept>","source":"[Group By Clause](../../../visual-basic/language-reference/queries/group-by-clause.md)"}]}