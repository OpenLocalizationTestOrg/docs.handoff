{"content":"---\ntitle: \"User-Defined Data Type | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\n\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"UserDefined\"\n  - \"UDT\"\n  - \"vb.UDT\"\n  - \"User-Defined\"\n  - \"vb.UserDefined\"\n  - \"vb.User-Defined\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"user-defined data types, Visual Basic\"\n  - \"user-defined types\"\n  - \"structures, as user-defined data types\"\n  - \"user-defined types, Visual Basic\"\n  - \"user-defined types, structure declaration\"\n  - \"user-defined types, structures in Visual Basic\"\n  - \"user-defined data types, structure declaration\"\n  - \"data types [Visual Basic], assigning\"\n  - \"Structure statement\"\n  - \"data types [Visual Basic], user-defined\"\n  - \"user-defined data types, structures in Visual Basic\"\n  - \"user-defined data types\"\n  - \"types [Visual Basic], user-defined\"\nms.assetid: be913dca-a364-4a51-96a1-549a1b390b0a\ncaps.latest.revision: 12\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# User-Defined Data Type\nHolds data in a format you define. The `Structure` statement defines the format.  \n  \n Previous versions of Visual Basic support the user-defined type (UDT). The current version expands the UDT to a *structure*. A structure is a concatenation of one or more *members* of various data types. Visual Basic treats a structure as a single unit, although you can also access its members individually.  \n  \n## Remarks  \n Define and use a structure data type when you need to combine various data types into a single unit, or when none of the elementary data types serve your needs.  \n  \n The default value of a structure data type consists of the combination of the default values of each of its members.  \n  \n## Declaration Format  \n A structure declaration starts with the [Structure Statement](../../../visual-basic/language-reference/statements/structure-statement.md) and ends with the `End``Structure` statement. The `Structure` statement supplies the name of the structure, which is also the identifier of the data type the structure is defining. Other parts of the code can use this identifier to declare variables, parameters, and function return values to be of this structure's data type.  \n  \n The declarations between the `Structure` and `End``Structure` statements define the members of the structure.  \n  \n## Member Access Levels  \n You must declare every member using a [Dim Statement](../../../visual-basic/language-reference/statements/dim-statement.md) or a statement that specifies access level, such as [Public](../../../visual-basic/language-reference/modifiers/public.md), [Friend](../../../visual-basic/language-reference/modifiers/friend.md), or [Private](../../../visual-basic/language-reference/modifiers/private.md). If you use a `Dim` statement, the access level defaults to public.  \n  \n## Programming Tips  \n  \n-   **Memory Consumption.** As with all composite data types, you cannot safely calculate the total memory consumption of a structure by adding together the nominal storage allocations of its members. Furthermore, you cannot safely assume that the order of storage in memory is the same as your order of declaration. If you need to control the storage layout of a structure, you can apply the <xref:System.Runtime.InteropServices.StructLayoutAttribute> attribute to the `Structure` statement.  \n  \n-   **Interop Considerations.** If you are interfacing with components not written for the .NET Framework, for example Automation or COM objects, keep in mind that user-defined types in other environments are not compatible with Visual Basic structure types.  \n  \n-   **Widening.** There is no automatic conversion to or from any structure data type. You can define conversion operators on your structure using the [Operator Statement](../../../visual-basic/language-reference/statements/operator-statement.md), and you can declare each conversion operator to be `Widening` or `Narrowing`.  \n  \n-   **Type Characters.** Structure data types have no literal type character or identifier type character.  \n  \n-   **Framework Type.** There is no corresponding type in the .NET Framework. All structures inherit from the .NET Framework class <xref:System.ValueType?displayProperty=fullName>, but no individual structure corresponds to <xref:System.ValueType?displayProperty=fullName>.  \n  \n## Example  \n The following paradigm shows the outline of the declaration of a structure.  \n  \n```  \n[Public | Protected | Friend | Protected Friend | Private] Structure structname  \n    {Dim | Public | Friend | Private} member1 As datatype1  \n    ' ...  \n    {Dim | Public | Friend | Private} memberN As datatypeN  \nEnd Structure  \n```  \n  \n## See Also  \n <xref:System.ValueType>   \n <xref:System.Runtime.InteropServices.StructLayoutAttribute>   \n [Data Types](../../../visual-basic/language-reference/data-types/data-type-summary.md)   \n [Type Conversion Functions](../../../visual-basic/language-reference/functions/type-conversion-functions.md)   \n [Conversion Summary](../../../visual-basic/language-reference/keywords/conversion-summary.md)   \n [Structure Statement](../../../visual-basic/language-reference/statements/structure-statement.md)   \n [Widening](../../../visual-basic/language-reference/modifiers/widening.md)   \n [Narrowing](../../../visual-basic/language-reference/modifiers/narrowing.md)   \n [Structures](../../../visual-basic/programming-guide/language-features/data-types/structures.md)   \n [Efficient Use of Data Types](../../../visual-basic/programming-guide/language-features/data-types/efficient-use-of-data-types.md)","nodes":[{"pos":[4,1179],"embed":true,"restype":"x-metadata","content":"title: \"User-Defined Data Type | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\n\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"UserDefined\"\n  - \"UDT\"\n  - \"vb.UDT\"\n  - \"User-Defined\"\n  - \"vb.UserDefined\"\n  - \"vb.User-Defined\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"user-defined data types, Visual Basic\"\n  - \"user-defined types\"\n  - \"structures, as user-defined data types\"\n  - \"user-defined types, Visual Basic\"\n  - \"user-defined types, structure declaration\"\n  - \"user-defined types, structures in Visual Basic\"\n  - \"user-defined data types, structure declaration\"\n  - \"data types [Visual Basic], assigning\"\n  - \"Structure statement\"\n  - \"data types [Visual Basic], user-defined\"\n  - \"user-defined data types, structures in Visual Basic\"\n  - \"user-defined data types\"\n  - \"types [Visual Basic], user-defined\"\nms.assetid: be913dca-a364-4a51-96a1-549a1b390b0a\ncaps.latest.revision: 12\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","nodes":[{"content":"User-Defined Data Type | Microsoft Docs","nodes":[{"pos":[0,39],"content":"User-Defined Data Type | Microsoft Docs","nodes":[{"content":"User-Defined Data Type | Microsoft Docs","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[1186,1208],"content":"User-Defined Data Type","linkify":"User-Defined Data Type","nodes":[{"content":"User-Defined Data Type","pos":[0,22]}]},{"content":"Holds data in a format you define.","pos":[1209,1243]},{"content":"The <ph id=\"ph1\">`Structure`</ph> statement defines the format.","pos":[1244,1289],"source":" The `Structure` statement defines the format."},{"content":"Previous versions of Visual Basic support the user-defined type (UDT).","pos":[1296,1366]},{"content":"The current version expands the UDT to a <bpt id=\"p1\">*</bpt>structure<ept id=\"p1\">*</ept>.","pos":[1367,1420],"source":" The current version expands the UDT to a *structure*."},{"content":"A structure is a concatenation of one or more <bpt id=\"p1\">*</bpt>members<ept id=\"p1\">*</ept> of various data types.","pos":[1421,1499],"source":" A structure is a concatenation of one or more *members* of various data types."},{"content":"Visual Basic treats a structure as a single unit, although you can also access its members individually.","pos":[1500,1604]},{"pos":[1613,1620],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Define and use a structure data type when you need to combine various data types into a single unit, or when none of the elementary data types serve your needs.","pos":[1624,1784]},{"content":"The default value of a structure data type consists of the combination of the default values of each of its members.","pos":[1791,1907]},{"pos":[1916,1934],"content":"Declaration Format","linkify":"Declaration Format","nodes":[{"content":"Declaration Format","pos":[0,18]}]},{"content":"A structure declaration starts with the <bpt id=\"p1\">[</bpt>Structure Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/structure-statement.md)</ept> and ends with the <ph id=\"ph1\">`End``Structure`</ph> statement.","pos":[1938,2121],"source":"A structure declaration starts with the [Structure Statement](../../../visual-basic/language-reference/statements/structure-statement.md) and ends with the `End``Structure` statement."},{"content":"The <ph id=\"ph1\">`Structure`</ph> statement supplies the name of the structure, which is also the identifier of the data type the structure is defining.","pos":[2122,2256],"source":" The `Structure` statement supplies the name of the structure, which is also the identifier of the data type the structure is defining."},{"content":"Other parts of the code can use this identifier to declare variables, parameters, and function return values to be of this structure's data type.","pos":[2257,2402]},{"pos":[2409,2518],"content":"The declarations between the <ph id=\"ph1\">`Structure`</ph> and <ph id=\"ph2\">`End``Structure`</ph> statements define the members of the structure.","source":"The declarations between the `Structure` and `End``Structure` statements define the members of the structure."},{"pos":[2527,2547],"content":"Member Access Levels","linkify":"Member Access Levels","nodes":[{"content":"Member Access Levels","pos":[0,20]}]},{"content":"You must declare every member using a <bpt id=\"p1\">[</bpt>Dim Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/dim-statement.md)</ept> or a statement that specifies access level, such as <bpt id=\"p2\">[</bpt>Public<ept id=\"p2\">](../../../visual-basic/language-reference/modifiers/public.md)</ept>, <bpt id=\"p3\">[</bpt>Friend<ept id=\"p3\">](../../../visual-basic/language-reference/modifiers/friend.md)</ept>, or <bpt id=\"p4\">[</bpt>Private<ept id=\"p4\">](../../../visual-basic/language-reference/modifiers/private.md)</ept>.","pos":[2551,2947],"source":"You must declare every member using a [Dim Statement](../../../visual-basic/language-reference/statements/dim-statement.md) or a statement that specifies access level, such as [Public](../../../visual-basic/language-reference/modifiers/public.md), [Friend](../../../visual-basic/language-reference/modifiers/friend.md), or [Private](../../../visual-basic/language-reference/modifiers/private.md)."},{"content":"If you use a <ph id=\"ph1\">`Dim`</ph> statement, the access level defaults to public.","pos":[2948,3014],"source":" If you use a `Dim` statement, the access level defaults to public."},{"pos":[3023,3039],"content":"Programming Tips","linkify":"Programming Tips","nodes":[{"content":"Programming Tips","pos":[0,16]}]},{"content":"<bpt id=\"p1\">**</bpt>Memory Consumption.<ept id=\"p1\">**</ept>","pos":[3049,3072],"source":"**Memory Consumption.**"},{"content":"As with all composite data types, you cannot safely calculate the total memory consumption of a structure by adding together the nominal storage allocations of its members.","pos":[3073,3245]},{"content":"Furthermore, you cannot safely assume that the order of storage in memory is the same as your order of declaration.","pos":[3246,3361]},{"content":"If you need to control the storage layout of a structure, you can apply the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.StructLayoutAttribute&gt;</ph> attribute to the <ph id=\"ph2\">`Structure`</ph> statement.","pos":[3362,3537],"source":" If you need to control the storage layout of a structure, you can apply the <xref:System.Runtime.InteropServices.StructLayoutAttribute> attribute to the `Structure` statement."},{"content":"<bpt id=\"p1\">**</bpt>Interop Considerations.<ept id=\"p1\">**</ept>","pos":[3547,3574],"source":"**Interop Considerations.**"},{"content":"If you are interfacing with components not written for the .NET Framework, for example Automation or COM objects, keep in mind that user-defined types in other environments are not compatible with Visual Basic structure types.","pos":[3575,3801]},{"content":"<bpt id=\"p1\">**</bpt>Widening.<ept id=\"p1\">**</ept>","pos":[3811,3824],"source":"**Widening.**"},{"content":"There is no automatic conversion to or from any structure data type.","pos":[3825,3893]},{"content":"You can define conversion operators on your structure using the <bpt id=\"p1\">[</bpt>Operator Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/operator-statement.md)</ept>, and you can declare each conversion operator to be <ph id=\"ph1\">`Widening`</ph> or <ph id=\"ph2\">`Narrowing`</ph>.","pos":[3894,4132],"source":" You can define conversion operators on your structure using the [Operator Statement](../../../visual-basic/language-reference/statements/operator-statement.md), and you can declare each conversion operator to be `Widening` or `Narrowing`."},{"content":"<bpt id=\"p1\">**</bpt>Type Characters.<ept id=\"p1\">**</ept>","pos":[4142,4162],"source":"**Type Characters.**"},{"content":"Structure data types have no literal type character or identifier type character.","pos":[4163,4244]},{"content":"<bpt id=\"p1\">**</bpt>Framework Type.<ept id=\"p1\">**</ept>","pos":[4254,4273],"source":"**Framework Type.**"},{"content":"There is no corresponding type in the .NET Framework.","pos":[4274,4327]},{"content":"All structures inherit from the .NET Framework class <ph id=\"ph1\">&lt;xref:System.ValueType?displayProperty=fullName&gt;</ph>, but no individual structure corresponds to <ph id=\"ph2\">&lt;xref:System.ValueType?displayProperty=fullName&gt;</ph>.","pos":[4328,4523],"source":" All structures inherit from the .NET Framework class <xref:System.ValueType?displayProperty=fullName>, but no individual structure corresponds to <xref:System.ValueType?displayProperty=fullName>."},{"pos":[4532,4539],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following paradigm shows the outline of the declaration of a structure.","pos":[4543,4618]},{"pos":[4874,4882],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Data Types<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/data-type-summary.md)</ept><ph id=\"ph1\"> </ph>","pos":[4978,5065],"source":"[Data Types](../../../visual-basic/language-reference/data-types/data-type-summary.md) "},{"content":"<bpt id=\"p1\">[</bpt>Type Conversion Functions<ept id=\"p1\">](../../../visual-basic/language-reference/functions/type-conversion-functions.md)</ept><ph id=\"ph1\"> </ph>","pos":[5069,5178],"source":"[Type Conversion Functions](../../../visual-basic/language-reference/functions/type-conversion-functions.md) "},{"content":"<bpt id=\"p1\">[</bpt>Conversion Summary<ept id=\"p1\">](../../../visual-basic/language-reference/keywords/conversion-summary.md)</ept><ph id=\"ph1\"> </ph>","pos":[5182,5276],"source":"[Conversion Summary](../../../visual-basic/language-reference/keywords/conversion-summary.md) "},{"content":"<bpt id=\"p1\">[</bpt>Structure Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/structure-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[5280,5378],"source":"[Structure Statement](../../../visual-basic/language-reference/statements/structure-statement.md) "},{"content":"<bpt id=\"p1\">[</bpt>Widening<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/widening.md)</ept><ph id=\"ph1\"> </ph>","pos":[5382,5457],"source":"[Widening](../../../visual-basic/language-reference/modifiers/widening.md) "},{"content":"<bpt id=\"p1\">[</bpt>Narrowing<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/narrowing.md)</ept><ph id=\"ph1\"> </ph>","pos":[5461,5538],"source":"[Narrowing](../../../visual-basic/language-reference/modifiers/narrowing.md) "},{"content":"<bpt id=\"p1\">[</bpt>Structures<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/structures.md)</ept><ph id=\"ph1\"> </ph>","pos":[5542,5639],"source":"[Structures](../../../visual-basic/programming-guide/language-features/data-types/structures.md) "},{"content":"<bpt id=\"p1\">[</bpt>Efficient Use of Data Types<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/efficient-use-of-data-types.md)</ept>","pos":[5643,5773],"source":"[Efficient Use of Data Types](../../../visual-basic/programming-guide/language-features/data-types/efficient-use-of-data-types.md)"}]}