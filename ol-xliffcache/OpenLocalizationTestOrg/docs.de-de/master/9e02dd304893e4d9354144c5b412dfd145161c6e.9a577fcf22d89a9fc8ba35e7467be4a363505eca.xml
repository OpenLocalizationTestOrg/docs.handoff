{"content":"---\ntitle: \"Select Nodes Using XPath Navigation\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 8e4450dc-56b3-472b-b467-32f5694f83ad\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Select Nodes Using XPath Navigation\nThe XML Document Object Model (DOM) contains methods that allow you to use XML Path Language (XPath) navigation to query information in the DOM. You can use XPath to find a single, specific node or to find all nodes that match some criteria.  \n  \n## XPath Select Methods  \n The DOM classes provide two methods for XPath selection: the <xref:System.Xml.XmlNode.SelectSingleNode%2A> method and the <xref:System.Xml.XmlNode.SelectNodes%2A> method. The <xref:System.Xml.XmlNode.SelectSingleNode%2A> method returns the first node that matches the selection criteria. The <xref:System.Xml.XmlNode.SelectNodes%2A> method returns an <xref:System.Xml.XmlNodeList> that contains the matching nodes.  \n  \n The following example uses the <xref:System.Xml.XmlNode.SelectSingleNode%2A> method to select the first `book` node in which the author's last name meets the specified criteria. The bookstore.xml file (which is provided at the end of this topic) is used as the input file.  \n  \n```vb  \nDim doc As New XmlDocument()  \ndoc.Load(\"bookstore.xml\")  \nDim root As XmlNode = doc.DocumentElement  \n  \n' Add the namespace.  \nDim nsmgr As New XmlNamespaceManager(doc.NameTable)  \nnsmgr.AddNamespace(\"bk\", \"urn:newbooks-schema\")  \n  \n' Select and display the first node in which the author's   \n' last name is Kingsolver.  \nDim node As XmlNode = root.SelectSingleNode( _  \n     \"descendant::bk:book[bk:author/bk:last-name='Kingsolver']\", nsmgr)  \nConsole.WriteLine(node.InnerXml)  \n```  \n  \n```csharp  \n// Load the document and set the root element.  \nXmlDocument doc = new XmlDocument();  \ndoc.Load(\"bookstore.xml\");  \nXmlNode root = doc.DocumentElement;  \n  \n// Add the namespace.  \nXmlNamespaceManager nsmgr = new XmlNamespaceManager(doc.NameTable);  \nnsmgr.AddNamespace(\"bk\", \"urn:newbooks-schema\");  \n  \n// Select and display the first node in which the author's   \n// last name is Kingsolver.  \nXmlNode node = root.SelectSingleNode(  \n    \"descendant::bk:book[bk:author/bk:last-name='Kingsolver']\", nsmgr);  \nConsole.WriteLine(node.InnerXml);  \n```  \n  \n The next example uses the <xref:System.Xml.XmlNode.SelectNodes%2A> method to select all the book nodes in which the price is greater than a specified amount. The price for each book in the selected list is then programmatically reduced by ten percent. Finally, the updated file is written to the console. The bookstore.xml file (which is provided at the end of this topic) is used as the input file.  \n  \n```vb  \n' Load the document and set the root element.  \nDim doc As New XmlDocument()  \ndoc.Load(\"bookstore.xml\")  \nDim root As XmlNode = doc.DocumentElement  \n  \n' Add the namespace.  \nDim nsmgr As New XmlNamespaceManager(doc.NameTable)  \nnsmgr.AddNamespace(\"bk\", \"urn:newbooks-schema\")  \n  \n' Select all nodes where the book price is greater than 10.00.  \nDim nodeList As XmlNodeList = root.SelectNodes( _  \n     \"descendant::bk:book[bk:price>10.00]\", nsmgr)  \nFor Each book As XmlNode In nodeList  \n     Dim price As Double  \n     price = Math.Round(Convert.ToSingle( _  \n          book.LastChild.InnerText) * 0.9, 2)  \n     book.LastChild.InnerText = price.ToString()  \nNext  \n  \n' Display the updated document.  \ndoc.Save(Console.Out)  \n```  \n  \n```csharp  \n// Load the document and set the root element.  \nXmlDocument doc = new XmlDocument();  \ndoc.Load(\"bookstore.xml\");  \nXmlNode root = doc.DocumentElement;  \n  \n// Add the namespace.  \nXmlNamespaceManager nsmgr = new XmlNamespaceManager(doc.NameTable);  \nnsmgr.AddNamespace(\"bk\", \"urn:newbooks-schema\");  \n  \n// Select all nodes where the book price is greater than 10.00.  \nXmlNodeList nodeList = root.SelectNodes(  \n     \"descendant::bk:book[bk:price>10.00]\", nsmgr);  \nforeach (XmlNode book in nodeList)  \n{  \n     // Discount prices by 10%.  \n     double price;  \n     price = Math.Round(Convert.ToSingle(  \n          book.LastChild.InnerText) * 0.9, 2);  \n     book.LastChild.InnerText = price.ToString();  \n}  \n  \n// Display the updated document.  \ndoc.Save(Console.Out);  \n```  \n  \n The examples above start the XPath query at the document element. Setting the starting point for the XPath query sets the context node, which is the starting point for the XPath query. If you do not want to start at the document element, but want to start from the first child of the document element, you can code the select statement as follows:  \n  \n```vb  \ndoc.DocumentElement.FirstChild.SelectNodes(. . . )  \n```  \n  \n```csharp  \nthis doc.DocumentElement.FirstChild.SelectNodes(. . .);  \n```  \n  \n All <xref:System.Xml.XmlNodeList> objects are synchronized with the underlying document. Therefore, if you iterate through the node list and modify the value of a node, that node is also updated in the document it came from. Notice in the previous example that when a node is modified in the selected <xref:System.Xml.XmlNodeList> the underlying document is also modified.  \n  \n> [!NOTE]\n>  When the underlying document is modified, it is advisable to rerun the select. If the node modified is one that could cause the node to be added to the node list when it was not previously, or would now cause it to be removed from the node list, there is no guarantee that the node list is now accurate.  \n  \n## Namespaces in XPath Expressions  \n XPath expressions can include namespaces. Namespace resolution is supported using the <xref:System.Xml.XmlNamespaceManager>. If the XPath expression includes a prefix, the prefix and namespace URI pair must be added to the <xref:System.Xml.XmlNamespaceManager>, and the <xref:System.Xml.XmlNamespaceManager> is passed to the <xref:System.Xml.XmlNode.SelectNodes%28System.String%2CSystem.Xml.XmlNamespaceManager%29> or <xref:System.Xml.XmlNode.SelectSingleNode%28System.String%2CSystem.Xml.XmlNamespaceManager%29> method. Notice that the code examples above use the <xref:System.Xml.XmlNamespaceManager> to resolve the namespace of the bookstore.xml document.  \n  \n> [!NOTE]\n>  If the XPath expression does not include a prefix, it is assumed that the namespace Uniform Resource Identifier (URI) is the empty namespace. If your XML includes a default namespace, you must still add a prefix and namespace URI to the <xref:System.Xml.XmlNamespaceManager>; otherwise, no nodes will be selected.  \n  \n#### Input File  \n The following is the bookstore.xml file that is used as the input file in the examples in this topic:  \n  \n```xml  \n<?xml version='1.0'?>  \n<bookstore xmlns=\"urn:newbooks-schema\">  \n  <book genre=\"novel\" style=\"hardcover\">  \n    <title>The Handmaid's Tale</title>  \n    <author>  \n      <first-name>Margaret</first-name>  \n      <last-name>Atwood</last-name>  \n    </author>  \n    <price>19.95</price>  \n  </book>  \n  <book genre=\"novel\" style=\"other\">  \n    <title>The Poisonwood Bible</title>  \n    <author>  \n      <first-name>Barbara</first-name>  \n      <last-name>Kingsolver</last-name>  \n    </author>  \n    <price>11.99</price>  \n  </book>  \n  <book genre=\"novel\" style=\"paperback\">  \n    <title>The Bean Trees</title>  \n    <author>  \n      <first-name>Barbara</first-name>  \n      <last-name>Kingsolver</last-name>  \n    </author>  \n    <price>5.99</price>  \n  </book>  \n</bookstore>  \n```  \n  \n## See also\n\n- [XML Document Object Model (DOM)](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)\n","nodes":[{"pos":[4,221],"embed":true,"restype":"x-metadata","content":"title: \"Select Nodes Using XPath Navigation\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 8e4450dc-56b3-472b-b467-32f5694f83ad\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Select Nodes Using XPath Navigation","nodes":[{"pos":[0,35],"content":"Select Nodes Using XPath Navigation","nodes":[{"content":"Select Nodes Using XPath Navigation","pos":[0,35]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[228,263],"content":"Select Nodes Using XPath Navigation","linkify":"Select Nodes Using XPath Navigation","nodes":[{"content":"Select Nodes Using XPath Navigation","pos":[0,35]}]},{"content":"The XML Document Object Model (DOM) contains methods that allow you to use XML Path Language (XPath) navigation to query information in the DOM.","pos":[264,408]},{"content":"You can use XPath to find a single, specific node or to find all nodes that match some criteria.","pos":[409,505]},{"pos":[514,534],"content":"XPath Select Methods","linkify":"XPath Select Methods","nodes":[{"content":"XPath Select Methods","pos":[0,20]}]},{"content":"The DOM classes provide two methods for XPath selection: the <ph id=\"ph1\">&lt;xref:System.Xml.XmlNode.SelectSingleNode%2A&gt;</ph> method and the <ph id=\"ph2\">&lt;xref:System.Xml.XmlNode.SelectNodes%2A&gt;</ph> method.","pos":[538,708],"source":"The DOM classes provide two methods for XPath selection: the <xref:System.Xml.XmlNode.SelectSingleNode%2A> method and the <xref:System.Xml.XmlNode.SelectNodes%2A> method."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlNode.SelectSingleNode%2A&gt;</ph> method returns the first node that matches the selection criteria.","pos":[709,825],"source":" The <xref:System.Xml.XmlNode.SelectSingleNode%2A> method returns the first node that matches the selection criteria."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlNode.SelectNodes%2A&gt;</ph> method returns an <ph id=\"ph2\">&lt;xref:System.Xml.XmlNodeList&gt;</ph> that contains the matching nodes.","pos":[826,952],"source":" The <xref:System.Xml.XmlNode.SelectNodes%2A> method returns an <xref:System.Xml.XmlNodeList> that contains the matching nodes."},{"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Xml.XmlNode.SelectSingleNode%2A&gt;</ph> method to select the first <ph id=\"ph2\">`book`</ph> node in which the author's last name meets the specified criteria.","pos":[959,1136],"source":"The following example uses the <xref:System.Xml.XmlNode.SelectSingleNode%2A> method to select the first `book` node in which the author's last name meets the specified criteria."},{"content":"The bookstore.xml file (which is provided at the end of this topic) is used as the input file.","pos":[1137,1231]},{"content":"The next example uses the <ph id=\"ph1\">&lt;xref:System.Xml.XmlNode.SelectNodes%2A&gt;</ph> method to select all the book nodes in which the price is greater than a specified amount.","pos":[2308,2465],"source":"The next example uses the <xref:System.Xml.XmlNode.SelectNodes%2A> method to select all the book nodes in which the price is greater than a specified amount."},{"content":"The price for each book in the selected list is then programmatically reduced by ten percent.","pos":[2466,2559]},{"content":"Finally, the updated file is written to the console.","pos":[2560,2612]},{"content":"The bookstore.xml file (which is provided at the end of this topic) is used as the input file.","pos":[2613,2707]},{"content":"The examples above start the XPath query at the document element.","pos":[4262,4327]},{"content":"Setting the starting point for the XPath query sets the context node, which is the starting point for the XPath query.","pos":[4328,4446]},{"content":"If you do not want to start at the document element, but want to start from the first child of the document element, you can code the select statement as follows:","pos":[4447,4609]},{"content":"All <ph id=\"ph1\">&lt;xref:System.Xml.XmlNodeList&gt;</ph> objects are synchronized with the underlying document.","pos":[4765,4853],"source":"All <xref:System.Xml.XmlNodeList> objects are synchronized with the underlying document."},{"content":"Therefore, if you iterate through the node list and modify the value of a node, that node is also updated in the document it came from.","pos":[4854,4989]},{"content":"Notice in the previous example that when a node is modified in the selected <ph id=\"ph1\">&lt;xref:System.Xml.XmlNodeList&gt;</ph> the underlying document is also modified.","pos":[4990,5137],"source":" Notice in the previous example that when a node is modified in the selected <xref:System.Xml.XmlNodeList> the underlying document is also modified."},{"pos":[5145,5459],"content":"[!NOTE]\n When the underlying document is modified, it is advisable to rerun the select. If the node modified is one that could cause the node to be added to the node list when it was not previously, or would now cause it to be removed from the node list, there is no guarantee that the node list is now accurate.","leadings":["","> "],"nodes":[{"content":"When the underlying document is modified, it is advisable to rerun the select. If the node modified is one that could cause the node to be added to the node list when it was not previously, or would now cause it to be removed from the node list, there is no guarantee that the node list is now accurate.","pos":[9,312],"nodes":[{"content":"When the underlying document is modified, it is advisable to rerun the select.","pos":[0,78]},{"content":"If the node modified is one that could cause the node to be added to the node list when it was not previously, or would now cause it to be removed from the node list, there is no guarantee that the node list is now accurate.","pos":[79,303]}]}]},{"pos":[5468,5499],"content":"Namespaces in XPath Expressions","linkify":"Namespaces in XPath Expressions","nodes":[{"content":"Namespaces in XPath Expressions","pos":[0,31]}]},{"content":"XPath expressions can include namespaces.","pos":[5503,5544]},{"content":"Namespace resolution is supported using the <ph id=\"ph1\">&lt;xref:System.Xml.XmlNamespaceManager&gt;</ph>.","pos":[5545,5627],"source":" Namespace resolution is supported using the <xref:System.Xml.XmlNamespaceManager>."},{"content":"If the XPath expression includes a prefix, the prefix and namespace URI pair must be added to the <ph id=\"ph1\">&lt;xref:System.Xml.XmlNamespaceManager&gt;</ph>, and the <ph id=\"ph2\">&lt;xref:System.Xml.XmlNamespaceManager&gt;</ph> is passed to the <ph id=\"ph3\">&lt;xref:System.Xml.XmlNode.SelectNodes%28System.String%2CSystem.Xml.XmlNamespaceManager%29&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Xml.XmlNode.SelectSingleNode%28System.String%2CSystem.Xml.XmlNamespaceManager%29&gt;</ph> method.","pos":[5628,6023],"source":" If the XPath expression includes a prefix, the prefix and namespace URI pair must be added to the <xref:System.Xml.XmlNamespaceManager>, and the <xref:System.Xml.XmlNamespaceManager> is passed to the <xref:System.Xml.XmlNode.SelectNodes%28System.String%2CSystem.Xml.XmlNamespaceManager%29> or <xref:System.Xml.XmlNode.SelectSingleNode%28System.String%2CSystem.Xml.XmlNamespaceManager%29> method."},{"content":"Notice that the code examples above use the <ph id=\"ph1\">&lt;xref:System.Xml.XmlNamespaceManager&gt;</ph> to resolve the namespace of the bookstore.xml document.","pos":[6024,6161],"source":" Notice that the code examples above use the <xref:System.Xml.XmlNamespaceManager> to resolve the namespace of the bookstore.xml document."},{"pos":[6169,6493],"content":"[!NOTE]\n If the XPath expression does not include a prefix, it is assumed that the namespace Uniform Resource Identifier (URI) is the empty namespace. If your XML includes a default namespace, you must still add a prefix and namespace URI to the <xref:System.Xml.XmlNamespaceManager>; otherwise, no nodes will be selected.","leadings":["","> "],"nodes":[{"content":"If the XPath expression does not include a prefix, it is assumed that the namespace Uniform Resource Identifier (URI) is the empty namespace. If your XML includes a default namespace, you must still add a prefix and namespace URI to the <xref:System.Xml.XmlNamespaceManager>; otherwise, no nodes will be selected.","pos":[9,322],"nodes":[{"content":"If the XPath expression does not include a prefix, it is assumed that the namespace Uniform Resource Identifier (URI) is the empty namespace.","pos":[0,141]},{"content":"If your XML includes a default namespace, you must still add a prefix and namespace URI to the <ph id=\"ph1\">&lt;xref:System.Xml.XmlNamespaceManager&gt;</ph>; otherwise, no nodes will be selected.","pos":[142,313],"source":" If your XML includes a default namespace, you must still add a prefix and namespace URI to the <xref:System.Xml.XmlNamespaceManager>; otherwise, no nodes will be selected."}]}]},{"pos":[6504,6514],"content":"Input File","linkify":"Input File","nodes":[{"content":"Input File","pos":[0,10]}]},{"content":"The following is the bookstore.xml file that is used as the input file in the examples in this topic:","pos":[6518,6619]},{"pos":[7426,7434],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7438,7540],"content":"<bpt id=\"p1\">[</bpt>XML Document Object Model (DOM)<ept id=\"p1\">](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)</ept>","source":"[XML Document Object Model (DOM)](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)"}]}