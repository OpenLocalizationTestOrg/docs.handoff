{"content":"---\ntitle: \"Ref Return Values (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2017-04-28\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"variables [Visual Basic]\"\n  - \"ref return values [Visual Basic]\"\n  - \"ref returns [Visual Basic]\"\nms.assetid: 5ef0cc69-eb3a-4a67-92a2-78585f223cb5\nauthor: rpetrusha\nms.author: ronpet\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Support for reference return values (Visual Basic)\n\nStarting with C# 7, the C# language supports *reference return values*. One way to understand reference return values is that they are the opposite of arguments that are passed by reference to a method. When an argument passed by reference is modified, the changes are reflected in value of the variable on the caller. When an method provides a reference return value to a caller, modifications made to the reference return value by the caller are reflected in the called method's data.\n\nVisual Basic does not allow you to author methods with reference return values, but it does allow you to consume reference return values. In other words, you can call a method with a reference return value and modify that return value, and changes to the reference return value are reflected in the called method's data.\n\n## Modifying the ref return value directly\n\nFor methods that always succeed and have no `ByRef` parameters, you can modify the reference return value directly. You do this by assigning the new value to the expressions that returns the reference return value. \n\nThe following C# example defines a `NumericValue.IncrementValue` method that increments an internal value and returns it as a reference return value. \n\n[!code-cs[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]\n\nThe reference return value is then modified by the caller in the following Visual Basic example. Note that the line with the `NumericValue.IncrementValue` method call does not assign a value to the method. Instead, it assigns a value to the reference return value returned by the method.\n\n[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]\n\n## Using a helper method\n\nIn other cases, modifying the reference return value of a method call directly may not always be desirable. For example, a search method that returns a string may not always find a match. In that case, you want to modify the reference return value only if the search is successful.\n\nThe following C# example illustrates this scenario. It defines a `Sentence` class written in C# includes a `FindNext` method that finds the next word in a sentence that begins with a specified substring. The string is returned as a reference return value, and a `Boolean` variable passed by reference to the method indicates whether the search was successful. The reference return value indicates that the caller can not only read the returned value; he or she can also modify it, and that modification is reflected in the data contained internally in the `Sentence` class.\n\n[!code-cs[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]\n\nDirectly modifying the reference return value in this case is not reliable, since the method call may fail to find a match and return the first word in the sentence. In that case, the caller will inadvertently modify the first word of the sentence. This could be prevented by the caller returning a `null` (or `Nothing` in Visual Basic). But in that case, attempting to modify a string whose value is `Nothing` throws a <xref:System.NullReferenceException>. If could also be prevented by the caller returning <xref:System.String.Empty?displayProperty=fullName>, but this requires that the caller define a string variable whose value is <xref:System.String.Empty?displayProperty=fullName>. While the caller can modify that string, the modification itself serves no purpose, since the modified string has no relationship to the words in the sentence stored by the `Sentence` class.\n\nThe best way to handle this scenario is to pass the reference return value by reference to a helper method. The helper method then contains the logic to determine whether the method call succeeded and, if it did, to modify the reference return value. The following example provides a possible implementation.\n\n[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]\n\n## See also\n\n[Passing arguments by value and by reference](passing-arguments-by-value-and-by-reference.md)   \n[Procedures in Visual Basic](index.md)   \n\n\n","nodes":[{"pos":[12,61],"content":"Ref Return Values (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Ref Return Values (Visual Basic) | Microsoft Docs","pos":[0,49]}]},{"pos":[642,692],"content":"Support for reference return values (Visual Basic)","linkify":"Support for reference return values (Visual Basic)","nodes":[{"content":"Support for reference return values (Visual Basic)","pos":[0,50]}]},{"content":"Starting with C# 7, the C# language supports <bpt id=\"p1\">*</bpt>reference return values<ept id=\"p1\">*</ept>.","pos":[694,765],"source":"Starting with C# 7, the C# language supports *reference return values*."},{"content":"One way to understand reference return values is that they are the opposite of arguments that are passed by reference to a method.","pos":[766,896]},{"content":"When an argument passed by reference is modified, the changes are reflected in value of the variable on the caller.","pos":[897,1012]},{"content":"When an method provides a reference return value to a caller, modifications made to the reference return value by the caller are reflected in the called method's data.","pos":[1013,1180]},{"content":"Visual Basic does not allow you to author methods with reference return values, but it does allow you to consume reference return values.","pos":[1182,1319]},{"content":"In other words, you can call a method with a reference return value and modify that return value, and changes to the reference return value are reflected in the called method's data.","pos":[1320,1502]},{"pos":[1507,1546],"content":"Modifying the ref return value directly","linkify":"Modifying the ref return value directly","nodes":[{"content":"Modifying the ref return value directly","pos":[0,39]}]},{"content":"For methods that always succeed and have no <ph id=\"ph1\">`ByRef`</ph> parameters, you can modify the reference return value directly.","pos":[1548,1663],"source":"For methods that always succeed and have no `ByRef` parameters, you can modify the reference return value directly."},{"content":"You do this by assigning the new value to the expressions that returns the reference return value.","pos":[1664,1762]},{"pos":[1765,1914],"content":"The following C# example defines a <ph id=\"ph1\">`NumericValue.IncrementValue`</ph> method that increments an internal value and returns it as a reference return value.","source":"The following C# example defines a `NumericValue.IncrementValue` method that increments an internal value and returns it as a reference return value."},{"pos":[1917,2047],"content":"<bpt id=\"p1\">[!code-cs</bpt><bpt id=\"p2\">[</bpt>Ref-Return<ept id=\"p2\">](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)</ept><ept id=\"p1\">]</ept>","source":"[!code-cs[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]"},{"content":"The reference return value is then modified by the caller in the following Visual Basic example.","pos":[2049,2145]},{"content":"Note that the line with the <ph id=\"ph1\">`NumericValue.IncrementValue`</ph> method call does not assign a value to the method.","pos":[2146,2254],"source":" Note that the line with the `NumericValue.IncrementValue` method call does not assign a value to the method."},{"content":"Instead, it assigns a value to the reference return value returned by the method.","pos":[2255,2336]},{"pos":[2338,2472],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>Ref-Return<ept id=\"p2\">](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]"},{"pos":[2477,2498],"content":"Using a helper method","linkify":"Using a helper method","nodes":[{"content":"Using a helper method","pos":[0,21]}]},{"content":"In other cases, modifying the reference return value of a method call directly may not always be desirable.","pos":[2500,2607]},{"content":"For example, a search method that returns a string may not always find a match.","pos":[2608,2687]},{"content":"In that case, you want to modify the reference return value only if the search is successful.","pos":[2688,2781]},{"content":"The following C# example illustrates this scenario.","pos":[2783,2834]},{"content":"It defines a <ph id=\"ph1\">`Sentence`</ph> class written in C# includes a <ph id=\"ph2\">`FindNext`</ph> method that finds the next word in a sentence that begins with a specified substring.","pos":[2835,2986],"source":" It defines a `Sentence` class written in C# includes a `FindNext` method that finds the next word in a sentence that begins with a specified substring."},{"content":"The string is returned as a reference return value, and a <ph id=\"ph1\">`Boolean`</ph> variable passed by reference to the method indicates whether the search was successful.","pos":[2987,3142],"source":" The string is returned as a reference return value, and a `Boolean` variable passed by reference to the method indicates whether the search was successful."},{"content":"The reference return value indicates that the caller can not only read the returned value; he or she can also modify it, and that modification is reflected in the data contained internally in the <ph id=\"ph1\">`Sentence`</ph> class.","pos":[3143,3356],"source":" The reference return value indicates that the caller can not only read the returned value; he or she can also modify it, and that modification is reflected in the data contained internally in the `Sentence` class."},{"pos":[3358,3456],"content":"<bpt id=\"p1\">[!code-cs</bpt><bpt id=\"p2\">[</bpt>Ref-Return<ept id=\"p2\">](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)</ept><ept id=\"p1\">]</ept>","source":"[!code-cs[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]"},{"content":"Directly modifying the reference return value in this case is not reliable, since the method call may fail to find a match and return the first word in the sentence.","pos":[3458,3623]},{"content":"In that case, the caller will inadvertently modify the first word of the sentence.","pos":[3624,3706]},{"content":"This could be prevented by the caller returning a <ph id=\"ph1\">`null`</ph> (or <ph id=\"ph2\">`Nothing`</ph> in Visual Basic).","pos":[3707,3795],"source":" This could be prevented by the caller returning a `null` (or `Nothing` in Visual Basic)."},{"content":"But in that case, attempting to modify a string whose value is <ph id=\"ph1\">`Nothing`</ph> throws a <ph id=\"ph2\">&lt;xref:System.NullReferenceException&gt;</ph>.","pos":[3796,3915],"source":" But in that case, attempting to modify a string whose value is `Nothing` throws a <xref:System.NullReferenceException>."},{"content":"If could also be prevented by the caller returning <ph id=\"ph1\">&lt;xref:System.String.Empty?displayProperty=fullName&gt;</ph>, but this requires that the caller define a string variable whose value is <ph id=\"ph2\">&lt;xref:System.String.Empty?displayProperty=fullName&gt;</ph>.","pos":[3916,4146],"source":" If could also be prevented by the caller returning <xref:System.String.Empty?displayProperty=fullName>, but this requires that the caller define a string variable whose value is <xref:System.String.Empty?displayProperty=fullName>."},{"content":"While the caller can modify that string, the modification itself serves no purpose, since the modified string has no relationship to the words in the sentence stored by the <ph id=\"ph1\">`Sentence`</ph> class.","pos":[4147,4337],"source":" While the caller can modify that string, the modification itself serves no purpose, since the modified string has no relationship to the words in the sentence stored by the `Sentence` class."},{"content":"The best way to handle this scenario is to pass the reference return value by reference to a helper method.","pos":[4339,4446]},{"content":"The helper method then contains the logic to determine whether the method call succeeded and, if it did, to modify the reference return value.","pos":[4447,4589]},{"content":"The following example provides a possible implementation.","pos":[4590,4647]},{"pos":[4649,4755],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>Ref-Return<ept id=\"p2\">](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]"},{"pos":[4760,4768],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Passing arguments by value and by reference<ept id=\"p1\">](passing-arguments-by-value-and-by-reference.md)</ept><ph id=\"ph1\"> </ph>","pos":[4770,4864],"source":"[Passing arguments by value and by reference](passing-arguments-by-value-and-by-reference.md) "},{"content":"<bpt id=\"p1\">[</bpt>Procedures in Visual Basic<ept id=\"p1\">](index.md)</ept>","pos":[4867,4905],"source":"[Procedures in Visual Basic](index.md)"}]}