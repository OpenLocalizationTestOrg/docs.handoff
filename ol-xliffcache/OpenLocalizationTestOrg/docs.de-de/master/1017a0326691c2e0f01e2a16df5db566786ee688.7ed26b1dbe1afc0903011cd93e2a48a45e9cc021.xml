{"content":"---\ntitle: \"Accessing Custom Attributes\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"custom attributes, accessibility\"\n  - \"attributes [.NET Framework], accessing\"\n  - \"reflection, custom attributes\"\nms.assetid: 1d8e3398-00d8-47d5-a084-214f9859d3d7\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# Accessing Custom Attributes\nAfter attributes have been associated with program elements, reflection can be used to query their existence and values. In the .NET Framework version 1.0 and 1.1, custom attributes are examined in the execution context. The .NET Framework version 2.0 provides a new load context, the reflection-only context, which can be used to examine code that cannot be loaded for execution.  \n  \n## The Reflection-Only Context  \n Code loaded into the reflection-only context cannot be executed. This means that instances of custom attributes cannot be created, because that would require executing their constructors. To load and examine custom attributes in the reflection-only context, use the <xref:System.Reflection.CustomAttributeData> class. You can obtain instances of this class by using the appropriate overload of the static <xref:System.Reflection.CustomAttributeData.GetCustomAttributes%2A?displayProperty=nameWithType> method. See [How to: Load Assemblies into the Reflection-Only Context](../../../docs/framework/reflection-and-codedom/how-to-load-assemblies-into-the-reflection-only-context.md).  \n  \n## The Execution Context  \n The main reflection methods to query attributes in the execution context are <xref:System.Reflection.MemberInfo.GetCustomAttributes%2A?displayProperty=nameWithType> and <xref:System.Attribute.GetCustomAttributes%2A?displayProperty=nameWithType>.  \n  \n The accessibility of a custom attribute is checked with respect to the assembly in which it is attached. This is equivalent to checking whether a method on a type in the assembly in which the custom attribute is attached can call the constructor of the custom attribute.  \n  \n Methods such as <xref:System.Reflection.Assembly.GetCustomAttributes%28System.Boolean%29?displayProperty=nameWithType> check the visibility and accessibility of the type argument. Only code in the assembly that contains the user-defined type can retrieve a custom attribute of that type using **GetCustomAttributes**.  \n  \n The following C# example is a typical custom attribute design pattern. It illustrates the runtime custom attribute reflection model.  \n  \n```  \nSystem.DLL  \npublic class DescriptionAttribute : Attribute  \n{  \n}  \n  \nSystem.Web.DLL  \ninternal class MyDescriptionAttribute : DescriptionAttribute  \n{  \n}  \n  \npublic class LocalizationExtenderProvider  \n{  \n    [MyDescriptionAttribute(...)]  \n    public CultureInfo GetLanguage(...)  \n    {  \n    }  \n}  \n```  \n  \n If the runtime is attempting to retrieve the custom attributes for the public custom attribute type <xref:System.ComponentModel.DescriptionAttribute> attached to the **GetLanguage** method, it performs the following actions:  \n  \n1.  The runtime checks that the type argument **DescriptionAttribute** to **Type.GetCustomAttributes**(Type *type*) is public, and therefore is visible and accessible.  \n  \n2.  The runtime checks that the user-defined type **MyDescriptionAttribute** that is derived from **DescriptionAttribute** is visible and accessible within the **System.Web.DLL** assembly, where it is attached to the method **GetLanguage**().  \n  \n3.  The runtime checks that the constructor of **MyDescriptionAttribute** is visible and accessible within the **System.Web.DLL** assembly.  \n  \n4.  The runtime calls the constructor of **MyDescriptionAttribute** with the custom attribute parameters and returns the new object to the caller.  \n  \n The custom attribute reflection model could leak instances of user-defined types outside the assembly in which the type is defined. This is no different from the members in the runtime system library that return instances of user-defined types, such as <xref:System.Type.GetMethods%2A?displayProperty=nameWithType> returning an array of **RuntimeMethodInfo** objects. To prevent a client from discovering information about a user-defined custom attribute type, define the type's members to be nonpublic.  \n  \n The following example demonstrates the basic way of using reflection to get access to custom attributes.  \n  \n [!code-cpp[CustomAttributeData#2](../../../samples/snippets/cpp/VS_Snippets_CLR/CustomAttributeData/CPP/source2.cpp#2)]\n [!code-csharp[CustomAttributeData#2](../../../samples/snippets/csharp/VS_Snippets_CLR/CustomAttributeData/CS/source2.cs#2)]\n [!code-vb[CustomAttributeData#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CustomAttributeData/VB/source2.vb#2)]  \n  \n## See also\n\n- <xref:System.Reflection.MemberInfo.GetCustomAttributes%2A?displayProperty=nameWithType>\n- <xref:System.Attribute.GetCustomAttributes%2A?displayProperty=nameWithType>\n- [Viewing Type Information](../../../docs/framework/reflection-and-codedom/viewing-type-information.md)\n- [Security Considerations for Reflection](../../../docs/framework/reflection-and-codedom/security-considerations-for-reflection.md)\n","nodes":[{"pos":[4,337],"embed":true,"restype":"x-metadata","content":"title: \"Accessing Custom Attributes\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"custom attributes, accessibility\"\n  - \"attributes [.NET Framework], accessing\"\n  - \"reflection, custom attributes\"\nms.assetid: 1d8e3398-00d8-47d5-a084-214f9859d3d7\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"Accessing Custom Attributes","nodes":[{"pos":[0,27],"content":"Accessing Custom Attributes","nodes":[{"content":"Accessing Custom Attributes","pos":[0,27]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[344,371],"content":"Accessing Custom Attributes","linkify":"Accessing Custom Attributes","nodes":[{"content":"Accessing Custom Attributes","pos":[0,27]}]},{"content":"After attributes have been associated with program elements, reflection can be used to query their existence and values.","pos":[372,492]},{"content":"In the .NET Framework version 1.0 and 1.1, custom attributes are examined in the execution context.","pos":[493,592]},{"content":"The .NET Framework version 2.0 provides a new load context, the reflection-only context, which can be used to examine code that cannot be loaded for execution.","pos":[593,752]},{"pos":[761,788],"content":"The Reflection-Only Context","linkify":"The Reflection-Only Context","nodes":[{"content":"The Reflection-Only Context","pos":[0,27]}]},{"content":"Code loaded into the reflection-only context cannot be executed.","pos":[792,856]},{"content":"This means that instances of custom attributes cannot be created, because that would require executing their constructors.","pos":[857,979]},{"content":"To load and examine custom attributes in the reflection-only context, use the <ph id=\"ph1\">&lt;xref:System.Reflection.CustomAttributeData&gt;</ph> class.","pos":[980,1109],"source":" To load and examine custom attributes in the reflection-only context, use the <xref:System.Reflection.CustomAttributeData> class."},{"content":"You can obtain instances of this class by using the appropriate overload of the static <ph id=\"ph1\">&lt;xref:System.Reflection.CustomAttributeData.GetCustomAttributes%2A?displayProperty=nameWithType&gt;</ph> method.","pos":[1110,1301],"source":" You can obtain instances of this class by using the appropriate overload of the static <xref:System.Reflection.CustomAttributeData.GetCustomAttributes%2A?displayProperty=nameWithType> method."},{"content":"See <bpt id=\"p1\">[</bpt>How to: Load Assemblies into the Reflection-Only Context<ept id=\"p1\">](../../../docs/framework/reflection-and-codedom/how-to-load-assemblies-into-the-reflection-only-context.md)</ept>.","pos":[1302,1472],"source":" See [How to: Load Assemblies into the Reflection-Only Context](../../../docs/framework/reflection-and-codedom/how-to-load-assemblies-into-the-reflection-only-context.md)."},{"pos":[1481,1502],"content":"The Execution Context","linkify":"The Execution Context","nodes":[{"content":"The Execution Context","pos":[0,21]}]},{"pos":[1506,1751],"content":"The main reflection methods to query attributes in the execution context are <ph id=\"ph1\">&lt;xref:System.Reflection.MemberInfo.GetCustomAttributes%2A?displayProperty=nameWithType&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Attribute.GetCustomAttributes%2A?displayProperty=nameWithType&gt;</ph>.","source":"The main reflection methods to query attributes in the execution context are <xref:System.Reflection.MemberInfo.GetCustomAttributes%2A?displayProperty=nameWithType> and <xref:System.Attribute.GetCustomAttributes%2A?displayProperty=nameWithType>."},{"content":"The accessibility of a custom attribute is checked with respect to the assembly in which it is attached.","pos":[1758,1862]},{"content":"This is equivalent to checking whether a method on a type in the assembly in which the custom attribute is attached can call the constructor of the custom attribute.","pos":[1863,2028]},{"content":"Methods such as <ph id=\"ph1\">&lt;xref:System.Reflection.Assembly.GetCustomAttributes%28System.Boolean%29?displayProperty=nameWithType&gt;</ph> check the visibility and accessibility of the type argument.","pos":[2035,2214],"source":"Methods such as <xref:System.Reflection.Assembly.GetCustomAttributes%28System.Boolean%29?displayProperty=nameWithType> check the visibility and accessibility of the type argument."},{"content":"Only code in the assembly that contains the user-defined type can retrieve a custom attribute of that type using <bpt id=\"p1\">**</bpt>GetCustomAttributes<ept id=\"p1\">**</ept>.","pos":[2215,2352],"source":" Only code in the assembly that contains the user-defined type can retrieve a custom attribute of that type using **GetCustomAttributes**."},{"content":"The following C# example is a typical custom attribute design pattern.","pos":[2359,2429]},{"content":"It illustrates the runtime custom attribute reflection model.","pos":[2430,2491]},{"pos":[2822,3046],"content":"If the runtime is attempting to retrieve the custom attributes for the public custom attribute type <ph id=\"ph1\">&lt;xref:System.ComponentModel.DescriptionAttribute&gt;</ph> attached to the <bpt id=\"p1\">**</bpt>GetLanguage<ept id=\"p1\">**</ept> method, it performs the following actions:","source":"If the runtime is attempting to retrieve the custom attributes for the public custom attribute type <xref:System.ComponentModel.DescriptionAttribute> attached to the **GetLanguage** method, it performs the following actions:"},{"pos":[3056,3219],"content":"The runtime checks that the type argument <bpt id=\"p1\">**</bpt>DescriptionAttribute<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>Type.GetCustomAttributes<ept id=\"p2\">**</ept>(Type <bpt id=\"p3\">*</bpt>type<ept id=\"p3\">*</ept>) is public, and therefore is visible and accessible.","source":"The runtime checks that the type argument **DescriptionAttribute** to **Type.GetCustomAttributes**(Type *type*) is public, and therefore is visible and accessible."},{"pos":[3229,3467],"content":"The runtime checks that the user-defined type <bpt id=\"p1\">**</bpt>MyDescriptionAttribute<ept id=\"p1\">**</ept> that is derived from <bpt id=\"p2\">**</bpt>DescriptionAttribute<ept id=\"p2\">**</ept> is visible and accessible within the <bpt id=\"p3\">**</bpt>System.Web.DLL<ept id=\"p3\">**</ept> assembly, where it is attached to the method <bpt id=\"p4\">**</bpt>GetLanguage<ept id=\"p4\">**</ept>().","source":"The runtime checks that the user-defined type **MyDescriptionAttribute** that is derived from **DescriptionAttribute** is visible and accessible within the **System.Web.DLL** assembly, where it is attached to the method **GetLanguage**()."},{"pos":[3477,3612],"content":"The runtime checks that the constructor of <bpt id=\"p1\">**</bpt>MyDescriptionAttribute<ept id=\"p1\">**</ept> is visible and accessible within the <bpt id=\"p2\">**</bpt>System.Web.DLL<ept id=\"p2\">**</ept> assembly.","source":"The runtime checks that the constructor of **MyDescriptionAttribute** is visible and accessible within the **System.Web.DLL** assembly."},{"pos":[3622,3764],"content":"The runtime calls the constructor of <bpt id=\"p1\">**</bpt>MyDescriptionAttribute<ept id=\"p1\">**</ept> with the custom attribute parameters and returns the new object to the caller.","source":"The runtime calls the constructor of **MyDescriptionAttribute** with the custom attribute parameters and returns the new object to the caller."},{"content":"The custom attribute reflection model could leak instances of user-defined types outside the assembly in which the type is defined.","pos":[3771,3902]},{"content":"This is no different from the members in the runtime system library that return instances of user-defined types, such as <ph id=\"ph1\">&lt;xref:System.Type.GetMethods%2A?displayProperty=nameWithType&gt;</ph> returning an array of <bpt id=\"p1\">**</bpt>RuntimeMethodInfo<ept id=\"p1\">**</ept> objects.","pos":[3903,4138],"source":" This is no different from the members in the runtime system library that return instances of user-defined types, such as <xref:System.Type.GetMethods%2A?displayProperty=nameWithType> returning an array of **RuntimeMethodInfo** objects."},{"content":"To prevent a client from discovering information about a user-defined custom attribute type, define the type's members to be nonpublic.","pos":[4139,4274]},{"content":"The following example demonstrates the basic way of using reflection to get access to custom attributes.","pos":[4281,4385]},{"pos":[4392,4762],"content":"[!code-cpp[CustomAttributeData#2](../../../samples/snippets/cpp/VS_Snippets_CLR/CustomAttributeData/CPP/source2.cpp#2)]\n[!code-csharp[CustomAttributeData#2](../../../samples/snippets/csharp/VS_Snippets_CLR/CustomAttributeData/CS/source2.cs#2)]\n[!code-vb[CustomAttributeData#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CustomAttributeData/VB/source2.vb#2)]","leadings":[""," "," "],"nodes":[]},{"pos":[4771,4779],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4951,5053],"content":"<bpt id=\"p1\">[</bpt>Viewing Type Information<ept id=\"p1\">](../../../docs/framework/reflection-and-codedom/viewing-type-information.md)</ept>","source":"[Viewing Type Information](../../../docs/framework/reflection-and-codedom/viewing-type-information.md)"},{"pos":[5056,5186],"content":"<bpt id=\"p1\">[</bpt>Security Considerations for Reflection<ept id=\"p1\">](../../../docs/framework/reflection-and-codedom/security-considerations-for-reflection.md)</ept>","source":"[Security Considerations for Reflection](../../../docs/framework/reflection-and-codedom/security-considerations-for-reflection.md)"}]}