{"content":"---\ntitle: \"How to: Modify Data in a Database by Using LINQ (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"inserting rows [LINQ to SQL]\"\n  - \"deleting rows [LINQ to SQL]\"\n  - \"updating rows [LINQ to SQL]\"\n  - \"inserting data [Visual Basic]\"\n  - \"deleting data\"\n  - \"data [Visual Basic], updating\"\n  - \"updating data [LINQ]\"\n  - \"queries [LINQ in Visual Basic], data changes in database\"\n  - \"queries [LINQ in Visual Basic], how-to topics\"\nms.assetid: cf52635f-0c1b-46c3-aff1-bdf181cf19b1\n---\n# How to: Modify Data in a Database by Using LINQ (Visual Basic)\nLanguage-Integrated Query (LINQ) queries make it easy to access database information and modify values in the database.  \n  \n The following example shows how to create a new application that retrieves and updates information in a SQL Server database.  \n  \n The examples in this topic use the Northwind sample database. If you do not have this database on your development computer, you can download it from the Microsoft Download Center. For instructions, see [Downloading Sample Databases](../../../../framework/data/adonet/sql/linq/downloading-sample-databases.md).  \n  \n### To create a connection to a database  \n  \n1.  In Visual Studio, open **Server Explorer**/**Database Explorer** by clicking the **View** menu, and then select **Server Explorer**/**Database Explorer**.  \n  \n2.  Right-click **Data Connections** in **Server Explorer**/**Database Explorer**, and click **Add Connection**.  \n  \n3.  Specify a valid connection to the Northwind sample database.  \n  \n### To add a Project with a LINQ to SQL file  \n  \n1.  In Visual Studio, on the **File** menu, point to **New** and then click **Project**. Select Visual Basic **Windows Forms Application** as the project type.  \n  \n2.  On the **Project** menu, click **Add New Item**. Select the **LINQ to SQL Classes** item template.  \n  \n3.  Name the file `northwind.dbml`. Click **Add**. The Object Relational Designer (O/R Designer) is opened for the `northwind.dbml` file.  \n  \n### To add tables to query and modify to the designer  \n  \n1.  In **Server Explorer**/**Database Explorer**, expand the connection to the Northwind database. Expand the **Tables** folder.  \n  \n     If you have closed the O/R Designer, you can reopen it by double-clicking the `northwind.dbml` file that you added earlier.  \n  \n2.  Click the Customers table and drag it to the left pane of the designer.  \n  \n     The designer creates a new Customer object for your project.  \n  \n3.  Save your changes and close the designer.  \n  \n4.  Save your project.  \n  \n### To add code to modify the database and display the results  \n  \n1.  From the **Toolbox**, drag a <xref:System.Windows.Forms.DataGridView> control onto the default Windows Form for your project, Form1.  \n  \n2.  When you added tables to the O/R Designer, the designer added a <xref:System.Data.Linq.DataContext> object to your project. This object contains code that you can use to access the Customers table. It also contains code that defines  a local Customer object and a Customers collection for the table. The <xref:System.Data.Linq.DataContext> object for your project is named based on the name of your .dbml file. For this project, the <xref:System.Data.Linq.DataContext> object is named `northwindDataContext`.  \n  \n     You can create an instance of the <xref:System.Data.Linq.DataContext> object in your code and query and modify the Customers collection specified by the O/R Designer. Changes that you make to the Customers collection are not reflected in the database until you submit them by calling the <xref:System.Data.Linq.DataContext.SubmitChanges%2A> method of the <xref:System.Data.Linq.DataContext> object.  \n  \n     Double-click the Windows Form, Form1, to add code to the <xref:System.Windows.Forms.Form.Load> event to query the Customers table that is exposed as a property of your <xref:System.Data.Linq.DataContext>. Add the following code:  \n  \n    ```vb  \n    Private db As northwindDataContext  \n  \n    Private Sub Form1_Load(ByVal sender As System.Object,   \n                           ByVal e As System.EventArgs  \n                          ) Handles MyBase.Load  \n      db = New northwindDataContext()  \n  \n      RefreshData()  \n    End Sub  \n  \n    Private Sub RefreshData()  \n      Dim customers = From cust In db.Customers   \n                      Where cust.City(0) = \"W\"   \n                      Select cust  \n  \n      DataGridView1.DataSource = customers  \n    End Sub  \n    ```  \n  \n3.  From the **Toolbox**, drag three <xref:System.Windows.Forms.Button> controls onto the form. Select the first `Button` control. In the **Properties** window, set the `Name` of the `Button` control to `AddButton` and the `Text` to `Add`. Select the second button and set the `Name` property to `UpdateButton` and the `Text` property to `Update`. Select the third button and set the `Name` property to `DeleteButton` and the `Text` property to `Delete`.  \n  \n4.  Double-click the **Add** button to add code to its `Click` event. Add the following code:  \n  \n    ```vb  \n    Private Sub AddButton_Click(ByVal sender As System.Object,   \n                                ByVal e As System.EventArgs  \n                               ) Handles AddButton.Click  \n      Dim cust As New Customer With {   \n        .City = \"Wellington\",   \n        .CompanyName = \"Blue Yonder Airlines\",   \n        .ContactName = \"Jill Frank\",   \n        .Country = \"New Zealand\",   \n        .CustomerID = \"JILLF\"}  \n  \n      db.Customers.InsertOnSubmit(cust)  \n  \n      Try  \n        db.SubmitChanges()  \n      Catch  \n        ' Handle exception.  \n      End Try  \n  \n      RefreshData()  \n    End Sub  \n    ```  \n  \n5.  Double-click the **Update** button to add code to its `Click` event. Add the following code:  \n  \n    ```vb  \n    Private Sub UpdateButton_Click(ByVal sender As System.Object, _  \n                                   ByVal e As System.EventArgs  \n                                  ) Handles UpdateButton.Click  \n      Dim updateCust = (From cust In db.Customers   \n                        Where cust.CustomerID = \"JILLF\").ToList()(0)  \n  \n      updateCust.ContactName = \"Jill Shrader\"\n      updateCust.Country = \"Wales\"\n      updateCust.CompanyName = \"Red Yonder Airlines\"\n      updateCust.City = \"Cardiff\"\n  \n      Try  \n        db.SubmitChanges()  \n      Catch  \n        ' Handle exception.  \n      End Try  \n  \n      RefreshData()  \n    End Sub  \n    ```  \n  \n6.  Double-click the **Delete** button to add code to its `Click` event. Add the following code:  \n  \n    ```vb  \n    Private Sub DeleteButton_Click(ByVal sender As System.Object, _  \n                                   ByVal e As System.EventArgs  \n                                  ) Handles DeleteButton.Click  \n      Dim deleteCust = (From cust In db.Customers   \n                        Where cust.CustomerID = \"JILLF\").ToList()(0)  \n  \n      db.Customers.DeleteOnSubmit(deleteCust)  \n  \n      Try  \n        db.SubmitChanges()  \n      Catch  \n        ' Handle exception.  \n      End Try  \n  \n      RefreshData()  \n    End Sub  \n    ```  \n  \n7.  Press F5 to run your project. Click **Add** to add a new record. Click **Update** to modify the new record. Click **Delete** to delete the new record.  \n  \n## See also\n\n- [LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)\n- [Queries](../../../../visual-basic/language-reference/queries/index.md)\n- [LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md)\n- [DataContext Methods (O/R Designer)](/visualstudio/data-tools/datacontext-methods-o-r-designer)\n- [How to: Assign stored procedures to perform updates, inserts, and deletes (O/R Designer)](/visualstudio/data-tools/how-to-assign-stored-procedures-to-perform-updates-inserts-and-deletes-o-r-designer)\n","nodes":[{"pos":[4,503],"embed":true,"restype":"x-metadata","content":"title: \"How to: Modify Data in a Database by Using LINQ (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"inserting rows [LINQ to SQL]\"\n  - \"deleting rows [LINQ to SQL]\"\n  - \"updating rows [LINQ to SQL]\"\n  - \"inserting data [Visual Basic]\"\n  - \"deleting data\"\n  - \"data [Visual Basic], updating\"\n  - \"updating data [LINQ]\"\n  - \"queries [LINQ in Visual Basic], data changes in database\"\n  - \"queries [LINQ in Visual Basic], how-to topics\"\nms.assetid: cf52635f-0c1b-46c3-aff1-bdf181cf19b1","nodes":[{"content":"How to: Modify Data in a Database by Using LINQ (Visual Basic)","nodes":[{"pos":[0,62],"content":"How to: Modify Data in a Database by Using LINQ (Visual Basic)","nodes":[{"content":"How to: Modify Data in a Database by Using LINQ (Visual Basic)","pos":[0,62]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[510,572],"content":"How to: Modify Data in a Database by Using LINQ (Visual Basic)","linkify":"How to: Modify Data in a Database by Using LINQ (Visual Basic)","nodes":[{"content":"How to: Modify Data in a Database by Using LINQ (Visual Basic)","pos":[0,62]}]},{"content":"Language-Integrated Query (LINQ) queries make it easy to access database information and modify values in the database.","pos":[573,692]},{"content":"The following example shows how to create a new application that retrieves and updates information in a SQL Server database.","pos":[699,823]},{"content":"The examples in this topic use the Northwind sample database.","pos":[830,891]},{"content":"If you do not have this database on your development computer, you can download it from the Microsoft Download Center.","pos":[892,1010]},{"content":"For instructions, see <bpt id=\"p1\">[</bpt>Downloading Sample Databases<ept id=\"p1\">](../../../../framework/data/adonet/sql/linq/downloading-sample-databases.md)</ept>.","pos":[1011,1140],"source":" For instructions, see [Downloading Sample Databases](../../../../framework/data/adonet/sql/linq/downloading-sample-databases.md)."},{"pos":[1150,1186],"content":"To create a connection to a database","linkify":"To create a connection to a database","nodes":[{"content":"To create a connection to a database","pos":[0,36]}]},{"pos":[1196,1350],"content":"In Visual Studio, open <bpt id=\"p1\">**</bpt>Server Explorer<ept id=\"p1\">**</ept><ph id=\"ph1\">/</ph><bpt id=\"p2\">**</bpt>Database Explorer<ept id=\"p2\">**</ept> by clicking the <bpt id=\"p3\">**</bpt>View<ept id=\"p3\">**</ept> menu, and then select <bpt id=\"p4\">**</bpt>Server Explorer<ept id=\"p4\">**</ept><ph id=\"ph2\">/</ph><bpt id=\"p5\">**</bpt>Database Explorer<ept id=\"p5\">**</ept>.","source":"In Visual Studio, open **Server Explorer**/**Database Explorer** by clicking the **View** menu, and then select **Server Explorer**/**Database Explorer**."},{"pos":[1360,1468],"content":"Right-click <bpt id=\"p1\">**</bpt>Data Connections<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Server Explorer<ept id=\"p2\">**</ept><ph id=\"ph1\">/</ph><bpt id=\"p3\">**</bpt>Database Explorer<ept id=\"p3\">**</ept>, and click <bpt id=\"p4\">**</bpt>Add Connection<ept id=\"p4\">**</ept>.","source":"Right-click **Data Connections** in **Server Explorer**/**Database Explorer**, and click **Add Connection**."},{"content":"Specify a valid connection to the Northwind sample database.","pos":[1478,1538]},{"pos":[1548,1588],"content":"To add a Project with a LINQ to SQL file","linkify":"To add a Project with a LINQ to SQL file","nodes":[{"content":"To add a Project with a LINQ to SQL file","pos":[0,40]}]},{"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","pos":[1598,1682],"source":"In Visual Studio, on the **File** menu, point to **New** and then click **Project**."},{"content":"Select Visual Basic <bpt id=\"p1\">**</bpt>Windows Forms Application<ept id=\"p1\">**</ept> as the project type.","pos":[1683,1753],"source":" Select Visual Basic **Windows Forms Application** as the project type."},{"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Add New Item<ept id=\"p2\">**</ept>.","pos":[1763,1811],"source":"On the **Project** menu, click **Add New Item**."},{"content":"Select the <bpt id=\"p1\">**</bpt>LINQ to SQL Classes<ept id=\"p1\">**</ept> item template.","pos":[1812,1861],"source":" Select the **LINQ to SQL Classes** item template."},{"content":"Name the file <ph id=\"ph1\">`northwind.dbml`</ph>.","pos":[1871,1902],"source":"Name the file `northwind.dbml`."},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","pos":[1903,1917],"source":" Click **Add**."},{"content":"The Object Relational Designer (O/R Designer) is opened for the <ph id=\"ph1\">`northwind.dbml`</ph> file.","pos":[1918,2004],"source":" The Object Relational Designer (O/R Designer) is opened for the `northwind.dbml` file."},{"pos":[2014,2063],"content":"To add tables to query and modify to the designer","linkify":"To add tables to query and modify to the designer","nodes":[{"content":"To add tables to query and modify to the designer","pos":[0,49]}]},{"content":"In <bpt id=\"p1\">**</bpt>Server Explorer<ept id=\"p1\">**</ept><ph id=\"ph1\">/</ph><bpt id=\"p2\">**</bpt>Database Explorer<ept id=\"p2\">**</ept>, expand the connection to the Northwind database.","pos":[2073,2167],"source":"In **Server Explorer**/**Database Explorer**, expand the connection to the Northwind database."},{"content":"Expand the <bpt id=\"p1\">**</bpt>Tables<ept id=\"p1\">**</ept> folder.","pos":[2168,2197],"source":" Expand the **Tables** folder."},{"pos":[2208,2331],"content":"If you have closed the O/R Designer, you can reopen it by double-clicking the <ph id=\"ph1\">`northwind.dbml`</ph> file that you added earlier.","source":"If you have closed the O/R Designer, you can reopen it by double-clicking the `northwind.dbml` file that you added earlier."},{"content":"Click the Customers table and drag it to the left pane of the designer.","pos":[2341,2412]},{"content":"The designer creates a new Customer object for your project.","pos":[2423,2483]},{"content":"Save your changes and close the designer.","pos":[2493,2534]},{"content":"Save your project.","pos":[2544,2562]},{"pos":[2572,2630],"content":"To add code to modify the database and display the results","linkify":"To add code to modify the database and display the results","nodes":[{"content":"To add code to modify the database and display the results","pos":[0,58]}]},{"pos":[2640,2772],"content":"From the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, drag a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control onto the default Windows Form for your project, Form1.","source":"From the **Toolbox**, drag a <xref:System.Windows.Forms.DataGridView> control onto the default Windows Form for your project, Form1."},{"content":"When you added tables to the O/R Designer, the designer added a <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object to your project.","pos":[2782,2905],"source":"When you added tables to the O/R Designer, the designer added a <xref:System.Data.Linq.DataContext> object to your project."},{"content":"This object contains code that you can use to access the Customers table.","pos":[2906,2979]},{"content":"It also contains code that defines  a local Customer object and a Customers collection for the table.","pos":[2980,3081]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object for your project is named based on the name of your .dbml file.","pos":[3082,3192],"source":" The <xref:System.Data.Linq.DataContext> object for your project is named based on the name of your .dbml file."},{"content":"For this project, the <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object is named <ph id=\"ph2\">`northwindDataContext`</ph>.","pos":[3193,3290],"source":" For this project, the <xref:System.Data.Linq.DataContext> object is named `northwindDataContext`."},{"content":"You can create an instance of the <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object in your code and query and modify the Customers collection specified by the O/R Designer.","pos":[3301,3467],"source":"You can create an instance of the <xref:System.Data.Linq.DataContext> object in your code and query and modify the Customers collection specified by the O/R Designer."},{"content":"Changes that you make to the Customers collection are not reflected in the database until you submit them by calling the <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext.SubmitChanges%2A&gt;</ph> method of the <ph id=\"ph2\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object.","pos":[3468,3699],"source":" Changes that you make to the Customers collection are not reflected in the database until you submit them by calling the <xref:System.Data.Linq.DataContext.SubmitChanges%2A> method of the <xref:System.Data.Linq.DataContext> object."},{"content":"Double-click the Windows Form, Form1, to add code to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.Load&gt;</ph> event to query the Customers table that is exposed as a property of your <ph id=\"ph2\">&lt;xref:System.Data.Linq.DataContext&gt;</ph>.","pos":[3710,3914],"source":"Double-click the Windows Form, Form1, to add code to the <xref:System.Windows.Forms.Form.Load> event to query the Customers table that is exposed as a property of your <xref:System.Data.Linq.DataContext>."},{"content":"Add the following code:","pos":[3915,3938]},{"content":"From the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, drag three <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> controls onto the form.","pos":[4498,4589],"source":"From the **Toolbox**, drag three <xref:System.Windows.Forms.Button> controls onto the form."},{"content":"Select the first <ph id=\"ph1\">`Button`</ph> control.","pos":[4590,4624],"source":" Select the first `Button` control."},{"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set the <ph id=\"ph1\">`Name`</ph> of the <ph id=\"ph2\">`Button`</ph> control to <ph id=\"ph3\">`AddButton`</ph> and the <ph id=\"ph4\">`Text`</ph> to <ph id=\"ph5\">`Add`</ph>.","pos":[4625,4733],"source":" In the **Properties** window, set the `Name` of the `Button` control to `AddButton` and the `Text` to `Add`."},{"content":"Select the second button and set the <ph id=\"ph1\">`Name`</ph> property to <ph id=\"ph2\">`UpdateButton`</ph> and the <ph id=\"ph3\">`Text`</ph> property to <ph id=\"ph4\">`Update`</ph>.","pos":[4734,4841],"source":" Select the second button and set the `Name` property to `UpdateButton` and the `Text` property to `Update`."},{"content":"Select the third button and set the <ph id=\"ph1\">`Name`</ph> property to <ph id=\"ph2\">`DeleteButton`</ph> and the <ph id=\"ph3\">`Text`</ph> property to <ph id=\"ph4\">`Delete`</ph>.","pos":[4842,4948],"source":" Select the third button and set the `Name` property to `DeleteButton` and the `Text` property to `Delete`."},{"content":"Double-click the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> button to add code to its <ph id=\"ph1\">`Click`</ph> event.","pos":[4958,5023],"source":"Double-click the **Add** button to add code to its `Click` event."},{"content":"Add the following code:","pos":[5024,5047]},{"content":"Double-click the <bpt id=\"p1\">**</bpt>Update<ept id=\"p1\">**</ept> button to add code to its <ph id=\"ph1\">`Click`</ph> event.","pos":[5691,5759],"source":"Double-click the **Update** button to add code to its `Click` event."},{"content":"Add the following code:","pos":[5760,5783]},{"content":"Double-click the <bpt id=\"p1\">**</bpt>Delete<ept id=\"p1\">**</ept> button to add code to its <ph id=\"ph1\">`Click`</ph> event.","pos":[6456,6524],"source":"Double-click the **Delete** button to add code to its `Click` event."},{"content":"Add the following code:","pos":[6525,6548]},{"content":"Press F5 to run your project.","pos":[7101,7130]},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> to add a new record.","pos":[7131,7165],"source":" Click **Add** to add a new record."},{"content":"Click <bpt id=\"p1\">**</bpt>Update<ept id=\"p1\">**</ept> to modify the new record.","pos":[7166,7208],"source":" Click **Update** to modify the new record."},{"content":"Click <bpt id=\"p1\">**</bpt>Delete<ept id=\"p1\">**</ept> to delete the new record.","pos":[7209,7251],"source":" Click **Delete** to delete the new record."},{"pos":[7260,7268],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7272,7354],"content":"<bpt id=\"p1\">[</bpt>LINQ<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/linq/index.md)</ept>","source":"[LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)"},{"pos":[7357,7428],"content":"<bpt id=\"p1\">[</bpt>Queries<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/index.md)</ept>","source":"[Queries](../../../../visual-basic/language-reference/queries/index.md)"},{"pos":[7431,7497],"content":"<bpt id=\"p1\">[</bpt>LINQ to SQL<ept id=\"p1\">](../../../../framework/data/adonet/sql/linq/index.md)</ept>","source":"[LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md)"},{"pos":[7500,7595],"content":"<bpt id=\"p1\">[</bpt>DataContext Methods (O/R Designer)<ept id=\"p1\">](/visualstudio/data-tools/datacontext-methods-o-r-designer)</ept>","source":"[DataContext Methods (O/R Designer)](/visualstudio/data-tools/datacontext-methods-o-r-designer)"},{"pos":[7598,7798],"content":"<bpt id=\"p1\">[</bpt>How to: Assign stored procedures to perform updates, inserts, and deletes (O/R Designer)<ept id=\"p1\">](/visualstudio/data-tools/how-to-assign-stored-procedures-to-perform-updates-inserts-and-deletes-o-r-designer)</ept>","source":"[How to: Assign stored procedures to perform updates, inserts, and deletes (O/R Designer)](/visualstudio/data-tools/how-to-assign-stored-procedures-to-perform-updates-inserts-and-deletes-o-r-designer)"}]}