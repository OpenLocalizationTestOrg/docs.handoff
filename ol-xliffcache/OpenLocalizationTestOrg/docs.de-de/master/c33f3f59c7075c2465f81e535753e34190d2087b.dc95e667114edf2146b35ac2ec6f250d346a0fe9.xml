{"content":"---\ntitle: \"CASE (Entity SQL) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\nms.assetid: 26a47873-e87d-4ba2-9e2c-3787c21efe89\ncaps.latest.revision: 5\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# CASE (Entity SQL)\nEvaluates a set of `Boolean` expressions to determine the result.  \n  \n## Syntax  \n  \n```  \n  \nCASE  \n     WHEN Boolean_expression THEN result_expression   \n    [ ...n ]   \n     [   \n    ELSE else_result_expression   \n     ]   \nEND  \n```  \n  \n## Arguments  \n `n`  \n Is a placeholder that indicates that multiple WHEN `Boolean_expression` THEN `result_expression` clauses can be used.  \n  \n THEN `result_expression`  \n Is the expression returned when `Boolean_expression` evaluates to `true`. `result expression` is any valid expression.  \n  \n ELSE `else_result_expression`  \n Is the expression returned if no comparison operation evaluates to `true`. If this argument is omitted and no comparison operation evaluates to `true`, CASE returns null. `else_result_expression` is any valid expression. The data types of `else_result_expression` and any `result_expression` must be the same or must be an implicit conversion.  \n  \n WHEN `Boolean_expression`  \n Is the `Boolean` expression evaluated when the searched CASE format is used. `Boolean_expression` is any valid `Boolean` expression.  \n  \n## Return Value  \n Returns the highest precedence type from the set of types in the `result_expression` and the optional `else_result_expression`.  \n  \n## Remarks  \n The [!INCLUDE[esql](../../../../../../includes/esql-md.md)] case expression resembles the [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] case expression. You use the case expression to make a series of conditional tests to determine which expression will yield the appropriate result. This form of the case expression applies to a series of one or more `Boolean` expressions to determine the correct resulting expression.  \n  \n The CASE function evaluates `Boolean_expression` for each WHEN clause in the order specified, and returns `result_expression` of the first `Boolean_expression` that evaluates to `true`. The remaining expressions are not evaluated. If no `Boolean_expression` evaluates to `true`, the Database Engine returns the `else_result_expression` if an ELSE clause is specified, or a null value if no ELSE clause is specified.  \n  \n A CASE statement cannot return a multiset.  \n  \n## Example  \n The following Entity SQL query uses the CASE expression to evaluate a set of `Boolean` expressions in order to determine the result. The query is based on the AdventureWorks Sales Model. To compile and run this query, follow these steps:  \n  \n1.  Follow the procedure in [How to: Execute a Query that Returns PrimitiveType Results](../../../../../../docs/framework/data/adonet/ef/how-to-execute-a-query-that-returns-primitivetype-results.md).  \n  \n2.  Pass the following query as an argument to the `ExecutePrimitiveTypeQuery` method:  \n  \n [!code-csharp[DP EntityServices Concepts 2#CASE_WHEN_THEN_ELSE](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts 2/cs/entitysql.cs#case_when_then_else)]  \n  \n## See Also  \n [THEN](../../../../../../docs/framework/data/adonet/ef/language-reference/then-entity-sql.md)   \n [SELECT](../../../../../../docs/framework/data/adonet/ef/language-reference/select-entity-sql.md)   \n [Entity SQL Reference](../../../../../../docs/framework/data/adonet/ef/language-reference/entity-sql-reference.md)\n","nodes":[{"pos":[4,392],"nodes":[{"content":"CASE (Entity SQL) | Microsoft Docs","nodes":[{"pos":[0,34],"content":"CASE (Entity SQL) | Microsoft Docs","nodes":[{"content":"CASE (Entity SQL) | Microsoft Docs","pos":[0,34]}]}],"pos":[6,43],"yaml":true}],"content":"title: \"CASE (Entity SQL) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\nms.assetid: 26a47873-e87d-4ba2-9e2c-3787c21efe89\ncaps.latest.revision: 5\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","yamlblock":true},{"pos":[399,416],"content":"CASE (Entity SQL)","linkify":"CASE (Entity SQL)","nodes":[{"content":"CASE (Entity SQL)","pos":[0,17]}]},{"pos":[417,482],"content":"Evaluates a set of <ph id=\"ph1\">`Boolean`</ph> expressions to determine the result.","source":"Evaluates a set of `Boolean` expressions to determine the result."},{"pos":[491,497],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[663,672],"content":"Arguments","linkify":"Arguments","nodes":[{"content":"Arguments","pos":[0,9]}]},{"content":"Is a placeholder that indicates that multiple WHEN <ph id=\"ph1\">`Boolean_expression`</ph> THEN <ph id=\"ph2\">`result_expression`</ph> clauses can be used.","pos":[683,800],"source":"Is a placeholder that indicates that multiple WHEN `Boolean_expression` THEN `result_expression` clauses can be used."},{"content":"THEN <ph id=\"ph1\">`result_expression`</ph>","pos":[807,831],"source":"THEN `result_expression`"},{"content":"Is the expression returned when <ph id=\"ph1\">`Boolean_expression`</ph> evaluates to <ph id=\"ph2\">`true`</ph>.","pos":[835,908],"source":"Is the expression returned when `Boolean_expression` evaluates to `true`."},{"content":"<ph id=\"ph1\">`result expression`</ph> is any valid expression.","pos":[909,953],"source":"`result expression` is any valid expression."},{"content":"ELSE <ph id=\"ph1\">`else_result_expression`</ph>","pos":[960,989],"source":"ELSE `else_result_expression`"},{"content":"Is the expression returned if no comparison operation evaluates to <ph id=\"ph1\">`true`</ph>.","pos":[993,1067],"source":"Is the expression returned if no comparison operation evaluates to `true`."},{"content":"If this argument is omitted and no comparison operation evaluates to <ph id=\"ph1\">`true`</ph>, CASE returns null.","pos":[1068,1163],"source":" If this argument is omitted and no comparison operation evaluates to `true`, CASE returns null."},{"content":"<ph id=\"ph1\">`else_result_expression`</ph> is any valid expression.","pos":[1164,1213],"source":"`else_result_expression` is any valid expression."},{"content":"The data types of <ph id=\"ph1\">`else_result_expression`</ph> and any <ph id=\"ph2\">`result_expression`</ph> must be the same or must be an implicit conversion.","pos":[1214,1336],"source":" The data types of `else_result_expression` and any `result_expression` must be the same or must be an implicit conversion."},{"content":"WHEN <ph id=\"ph1\">`Boolean_expression`</ph>","pos":[1343,1368],"source":"WHEN `Boolean_expression`"},{"content":"Is the <ph id=\"ph1\">`Boolean`</ph> expression evaluated when the searched CASE format is used.","pos":[1372,1448],"source":"Is the `Boolean` expression evaluated when the searched CASE format is used."},{"content":"<ph id=\"ph1\">`Boolean_expression`</ph> is any valid <ph id=\"ph2\">`Boolean`</ph> expression.","pos":[1449,1504],"source":"`Boolean_expression` is any valid `Boolean` expression."},{"pos":[1513,1525],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[1529,1656],"content":"Returns the highest precedence type from the set of types in the <ph id=\"ph1\">`result_expression`</ph> and the optional <ph id=\"ph2\">`else_result_expression`</ph>.","source":"Returns the highest precedence type from the set of types in the `result_expression` and the optional `else_result_expression`."},{"pos":[1665,1672],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[esql](../../../../../../includes/esql-md.md)]</ph> case expression resembles the <ph id=\"ph2\">[!INCLUDE[tsql](../../../../../../includes/tsql-md.md)]</ph> case expression.","pos":[1676,1838],"source":"The [!INCLUDE[esql](../../../../../../includes/esql-md.md)] case expression resembles the [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] case expression."},{"content":"You use the case expression to make a series of conditional tests to determine which expression will yield the appropriate result.","pos":[1839,1969]},{"content":"This form of the case expression applies to a series of one or more <ph id=\"ph1\">`Boolean`</ph> expressions to determine the correct resulting expression.","pos":[1970,2106],"source":" This form of the case expression applies to a series of one or more `Boolean` expressions to determine the correct resulting expression."},{"content":"The CASE function evaluates <ph id=\"ph1\">`Boolean_expression`</ph> for each WHEN clause in the order specified, and returns <ph id=\"ph2\">`result_expression`</ph> of the first <ph id=\"ph3\">`Boolean_expression`</ph> that evaluates to <ph id=\"ph4\">`true`</ph>.","pos":[2113,2298],"source":"The CASE function evaluates `Boolean_expression` for each WHEN clause in the order specified, and returns `result_expression` of the first `Boolean_expression` that evaluates to `true`."},{"content":"The remaining expressions are not evaluated.","pos":[2299,2343]},{"content":"If no <ph id=\"ph1\">`Boolean_expression`</ph> evaluates to <ph id=\"ph2\">`true`</ph>, the Database Engine returns the <ph id=\"ph3\">`else_result_expression`</ph> if an ELSE clause is specified, or a null value if no ELSE clause is specified.","pos":[2344,2528],"source":" If no `Boolean_expression` evaluates to `true`, the Database Engine returns the `else_result_expression` if an ELSE clause is specified, or a null value if no ELSE clause is specified."},{"content":"A CASE statement cannot return a multiset.","pos":[2535,2577]},{"pos":[2586,2593],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following Entity SQL query uses the CASE expression to evaluate a set of <ph id=\"ph1\">`Boolean`</ph> expressions in order to determine the result.","pos":[2597,2729],"source":"The following Entity SQL query uses the CASE expression to evaluate a set of `Boolean` expressions in order to determine the result."},{"content":"The query is based on the AdventureWorks Sales Model.","pos":[2730,2783]},{"content":"To compile and run this query, follow these steps:","pos":[2784,2834]},{"pos":[2844,3039],"content":"Follow the procedure in <bpt id=\"p1\">[</bpt>How to: Execute a Query that Returns PrimitiveType Results<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/how-to-execute-a-query-that-returns-primitivetype-results.md)</ept>.","source":"Follow the procedure in [How to: Execute a Query that Returns PrimitiveType Results](../../../../../../docs/framework/data/adonet/ef/how-to-execute-a-query-that-returns-primitivetype-results.md)."},{"pos":[3049,3131],"content":"Pass the following query as an argument to the <ph id=\"ph1\">`ExecutePrimitiveTypeQuery`</ph> method:","source":"Pass the following query as an argument to the `ExecutePrimitiveTypeQuery` method:"},{"pos":[3138,3327],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DP EntityServices Concepts 2#CASE_WHEN_THEN_ELSE<ept id=\"p2\">](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts 2/cs/entitysql.cs#case_when_then_else)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[DP EntityServices Concepts 2#CASE_WHEN_THEN_ELSE](../../../../../../samples/snippets/csharp/VS_Snippets_Data/dp entityservices concepts 2/cs/entitysql.cs#case_when_then_else)]"},{"pos":[3336,3344],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>THEN<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/language-reference/then-entity-sql.md)</ept><ph id=\"ph1\"> </ph>","pos":[3348,3442],"source":"[THEN](../../../../../../docs/framework/data/adonet/ef/language-reference/then-entity-sql.md) "},{"content":"<bpt id=\"p1\">[</bpt>SELECT<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/language-reference/select-entity-sql.md)</ept><ph id=\"ph1\"> </ph>","pos":[3446,3544],"source":"[SELECT](../../../../../../docs/framework/data/adonet/ef/language-reference/select-entity-sql.md) "},{"content":"<bpt id=\"p1\">[</bpt>Entity SQL Reference<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/language-reference/entity-sql-reference.md)</ept>","pos":[3548,3662],"source":"[Entity SQL Reference](../../../../../../docs/framework/data/adonet/ef/language-reference/entity-sql-reference.md)"}]}