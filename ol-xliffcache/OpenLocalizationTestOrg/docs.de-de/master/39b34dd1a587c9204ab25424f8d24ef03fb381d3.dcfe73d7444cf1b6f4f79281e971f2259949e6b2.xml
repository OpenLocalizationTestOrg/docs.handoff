{"content":"---\ntitle: \"Interoperability with Enterprise Services and COM+ Transactions | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: d0fd0d26-fe86-443b-b208-4d57d39fa4aa\ncaps.latest.revision: 3\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Interoperability with Enterprise Services and COM+ Transactions\nThe <xref:System.Transactions> namespace supports interoperability between transaction objects created using this namespace and transactions created through COM+.  \n  \n You can use the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration when you create a new <xref:System.Transactions.TransactionScope> instance to specify the level of interoperability with COM+.  \n  \n By default, when your application code checks the static <xref:System.Transactions.Transaction.Current%2A> property, <xref:System.Transactions> attempts to look for a transaction that is otherwise current, or a <xref:System.Transactions.TransactionScope> object that dictates that <xref:System.Transactions.Transaction.Current%2A> is **null**. If it cannot find either one of these, <xref:System.Transactions> queries the COM+ context for a transaction. Note that even though <xref:System.Transactions> may find a transaction from the COM+ context, it still favors transactions that are native to <xref:System.Transactions>.  \n  \n## Interoperability levels  \n The <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration defines the following levels of interoperability—<xref:System.Transactions.EnterpriseServicesInteropOption>, <xref:System.Transactions.EnterpriseServicesInteropOption> and <xref:System.Transactions.EnterpriseServicesInteropOption>.  \n  \n The <xref:System.Transactions.TransactionScope> class provides constructors that accept <xref:System.Transactions.EnterpriseServicesInteropOption> as a parameter.  \n  \n <xref:System.Transactions.EnterpriseServicesInteropOption>, as the name implies, implies that there is no interoperability between <xref:System.EnterpriseServices> contexts and transaction scopes. After creating a <xref:System.Transactions.TransactionScope> object with <xref:System.Transactions.EnterpriseServicesInteropOption>, any changes to <xref:System.Transactions.Transaction.Current%2A> are not reflected in the COM+ context. Similarly, changes to the transaction in the COM+ context are not reflected in <xref:System.Transactions.Transaction.Current%2A>. This is the fastest mode of operation for <xref:System.Transactions> because there is no extra synchronization required. <xref:System.Transactions.EnterpriseServicesInteropOption> is the default value used by <xref:System.Transactions.TransactionScope> with all constructors that do not accept <xref:System.Transactions.EnterpriseServicesInteropOption> as a parameter.  \n  \n If you do want to combine <xref:System.EnterpriseServices> transactions with your ambient transaction, you need to use either <xref:System.Transactions.EnterpriseServicesInteropOption> or <xref:System.Transactions.EnterpriseServicesInteropOption>. Both of these values rely on a feature called services without components, and therefore you should be running on Windows XP Service Pack 2 or Windows Server 2003 when using them.  \n  \n <xref:System.Transactions.EnterpriseServicesInteropOption> specifies that the ambient transactions for <xref:System.Transactions> and <xref:System.EnterpriseServices> are always the same. It results in creating a new <xref:System.EnterpriseServices> transactional context and applying the transaction that is current for the <xref:System.Transactions.TransactionScope> to be current for that context. As such, the transaction in <xref:System.Transactions.Transaction.Current%2A> is completely in synchronization with the transaction in <xref:System.EnterpriseServices.ContextUtil.Transaction%2A>. This value introduces a performance penalty because new COM+ contexts may need to be created.  \n  \n <xref:System.Transactions.EnterpriseServicesInteropOption> specifies the following requirements:  \n  \n-   When <xref:System.Transactions.Transaction.Current%2A> is checked, <xref:System.Transactions> should support transactions in the COM+ context if it detects that it is running in a context other than the default context. Note that the default context cannot contain a transaction. Therefore, in the default context, even with <xref:System.Transactions.EnterpriseServicesInteropOption>, the transaction stored in the thread local storage used by <xref:System.Transactions> is returned for <xref:System.Transactions.Transaction.Current%2A>.  \n  \n-   If a new <xref:System.Transactions.TransactionScope> object is created and the creation occurs in a context other than the default context, the transaction that is current for the <xref:System.Transactions.TransactionScope> object should be reflected in COM+. In this case, <xref:System.Transactions.EnterpriseServicesInteropOption> behaves like <xref:System.Transactions.EnterpriseServicesInteropOption> in that it creates a new COM+ context.  \n  \n In addition when <xref:System.Transactions.Transaction.Current%2A> is set in both <xref:System.Transactions.EnterpriseServicesInteropOption> and <xref:System.Transactions.EnterpriseServicesInteropOption>, both of these modes imply that <xref:System.Transactions.Transaction.Current%2A> cannot be set directly.  Any attempt to set <xref:System.Transactions.Transaction.Current%2A> directly other than creating a <xref:System.Transactions.TransactionScope> results in an <xref:System.InvalidOperationException>. The <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration value is inherited by new transaction scopes that do not explicitly specify which value to use. For example, if you create a new <xref:System.Transactions.TransactionScope> object with <xref:System.Transactions.EnterpriseServicesInteropOption>, and then create a second <xref:System.Transactions.TransactionScope> object but do not specify an <xref:System.Transactions.EnterpriseServicesInteropOption> value, the second <xref:System.Transactions.TransactionScope> object also has a <xref:System.Transactions.EnterpriseServicesInteropOption>.  \n  \n In summary, the following rules apply when creating a new transaction scope:  \n  \n1.  <xref:System.Transactions.Transaction.Current%2A> is checked to see if there is a transaction. This check results in:  \n  \n    -   A check to see if there is a scope.  \n  \n    -   If there is a scope, the value of the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration passed in when the scope was initially created is checked.  \n  \n    -   If the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration is set to <xref:System.Transactions.EnterpriseServicesInteropOption>, the COM+ transaction (<xref:System.EnterpriseServices> Transaction) takes precedence over the <xref:System.Transactions> transaction in managed thread local storage.  \n  \n         If the value is set to <xref:System.Transactions.EnterpriseServicesInteropOption>, the <xref:System.Transactions> transaction in managed thread local storage takes precedence.  \n  \n         If the value is <xref:System.Transactions.EnterpriseServicesInteropOption>, there is only one transaction and it is a COM+ transaction.  \n  \n2.  The value of the <xref:System.Transactions.TransactionScopeOption> enumeration passed in by the <xref:System.Transactions.TransactionScope> constructor is checked. This determines if a new transaction must be created.  \n  \n3.  If a new transaction is to be created, the following values of <xref:System.Transactions.EnterpriseServicesInteropOption> result in:  \n  \n    -   <xref:System.Transactions.EnterpriseServicesInteropOption>:  a transaction associated with a COM+ context is created.  \n  \n    -   <xref:System.Transactions.EnterpriseServicesInteropOption>: a <xref:System.Transactions> transaction is created.  \n  \n    -   <xref:System.Transactions.EnterpriseServicesInteropOption>: if there is a COM+ context, a transaction is created and attached to the context.  \n  \n The following table illustrates the Enterprise Services (ES) context and a transactional scope that requires a transaction using the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration.  \n  \n|ES Context|None|Automatic|Full|  \n|----------------|----------|---------------|----------|  \n|Default context|Default context|Default context|Create new <br />transactional context|  \n|Non-default context|Maintain client's context|Create new transactional context|Create new transactional context|  \n  \n The following table illustrates what the ambient transaction is, given a particular <xref:System.EnterpriseServices> context, and a transactional scope that requires a transaction using the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration.  \n  \n|ES Context|None|Automatic|Full|  \n|----------------|----------|---------------|----------|  \n|Default context|ST|ST|ES|  \n|Non-default context|ST|ES|ES|  \n  \n In the preceding table:  \n  \n-   ST means that the scope's ambient transaction is managed by <xref:System.Transactions>, separate from any <xref:System.EnterpriseServices> context's transaction that may be present.  \n  \n-   ES means that the scope's ambient transaction is same as the <xref:System.EnterpriseServices> context's transaction.","nodes":[{"pos":[12,92],"content":"Interoperability with Enterprise Services and COM+ Transactions | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Interoperability with Enterprise Services and COM+ Transactions | Microsoft Docs","pos":[0,80]}]},{"pos":[357,420],"content":"Interoperability with Enterprise Services and COM+ Transactions","linkify":"Interoperability with Enterprise Services and COM+ Transactions","nodes":[{"content":"Interoperability with Enterprise Services and COM+ Transactions","pos":[0,63]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Transactions&gt;</ph> namespace supports interoperability between transaction objects created using this namespace and transactions created through COM+.","pos":[421,583],"source":"The <xref:System.Transactions> namespace supports interoperability between transaction objects created using this namespace and transactions created through COM+."},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration when you create a new <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> instance to specify the level of interoperability with COM+.","pos":[590,803],"source":"You can use the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration when you create a new <xref:System.Transactions.TransactionScope> instance to specify the level of interoperability with COM+."},{"content":"By default, when your application code checks the static <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> property, <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph> attempts to look for a transaction that is otherwise current, or a <ph id=\"ph3\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object that dictates that <ph id=\"ph4\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> is <bpt id=\"p1\">**</bpt>null<ept id=\"p1\">**</ept>.","pos":[810,1153],"source":"By default, when your application code checks the static <xref:System.Transactions.Transaction.Current%2A> property, <xref:System.Transactions> attempts to look for a transaction that is otherwise current, or a <xref:System.Transactions.TransactionScope> object that dictates that <xref:System.Transactions.Transaction.Current%2A> is **null**."},{"content":"If it cannot find either one of these, <ph id=\"ph1\">&lt;xref:System.Transactions&gt;</ph> queries the COM+ context for a transaction.","pos":[1154,1263],"source":" If it cannot find either one of these, <xref:System.Transactions> queries the COM+ context for a transaction."},{"content":"Note that even though <ph id=\"ph1\">&lt;xref:System.Transactions&gt;</ph> may find a transaction from the COM+ context, it still favors transactions that are native to <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph>.","pos":[1264,1434],"source":" Note that even though <xref:System.Transactions> may find a transaction from the COM+ context, it still favors transactions that are native to <xref:System.Transactions>."},{"pos":[1443,1466],"content":"Interoperability levels","linkify":"Interoperability levels","nodes":[{"content":"Interoperability levels","pos":[0,23]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration defines the following levels of interoperability—<ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>.","pos":[1470,1776],"source":"The <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration defines the following levels of interoperability—<xref:System.Transactions.EnterpriseServicesInteropOption>, <xref:System.Transactions.EnterpriseServicesInteropOption> and <xref:System.Transactions.EnterpriseServicesInteropOption>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> class provides constructors that accept <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> as a parameter.","pos":[1783,1945],"source":"The <xref:System.Transactions.TransactionScope> class provides constructors that accept <xref:System.Transactions.EnterpriseServicesInteropOption> as a parameter."},{"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>, as the name implies, implies that there is no interoperability between <ph id=\"ph2\">&lt;xref:System.EnterpriseServices&gt;</ph> contexts and transaction scopes.","pos":[1952,2148],"source":"<xref:System.Transactions.EnterpriseServicesInteropOption>, as the name implies, implies that there is no interoperability between <xref:System.EnterpriseServices> contexts and transaction scopes."},{"content":"After creating a <ph id=\"ph1\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object with <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>, any changes to <ph id=\"ph3\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> are not reflected in the COM+ context.","pos":[2149,2385],"source":" After creating a <xref:System.Transactions.TransactionScope> object with <xref:System.Transactions.EnterpriseServicesInteropOption>, any changes to <xref:System.Transactions.Transaction.Current%2A> are not reflected in the COM+ context."},{"content":"Similarly, changes to the transaction in the COM+ context are not reflected in <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph>.","pos":[2386,2515],"source":" Similarly, changes to the transaction in the COM+ context are not reflected in <xref:System.Transactions.Transaction.Current%2A>."},{"content":"This is the fastest mode of operation for <ph id=\"ph1\">&lt;xref:System.Transactions&gt;</ph> because there is no extra synchronization required.","pos":[2516,2636],"source":" This is the fastest mode of operation for <xref:System.Transactions> because there is no extra synchronization required."},{"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> is the default value used by <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> with all constructors that do not accept <ph id=\"ph3\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> as a parameter.","pos":[2637,2884],"source":"<xref:System.Transactions.EnterpriseServicesInteropOption> is the default value used by <xref:System.Transactions.TransactionScope> with all constructors that do not accept <xref:System.Transactions.EnterpriseServicesInteropOption> as a parameter."},{"content":"If you do want to combine <ph id=\"ph1\">&lt;xref:System.EnterpriseServices&gt;</ph> transactions with your ambient transaction, you need to use either <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>.","pos":[2891,3138],"source":"If you do want to combine <xref:System.EnterpriseServices> transactions with your ambient transaction, you need to use either <xref:System.Transactions.EnterpriseServicesInteropOption> or <xref:System.Transactions.EnterpriseServicesInteropOption>."},{"content":"Both of these values rely on a feature called services without components, and therefore you should be running on Windows XP Service Pack 2 or Windows Server 2003 when using them.","pos":[3139,3318]},{"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> specifies that the ambient transactions for <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.EnterpriseServices&gt;</ph> are always the same.","pos":[3325,3512],"source":"<xref:System.Transactions.EnterpriseServicesInteropOption> specifies that the ambient transactions for <xref:System.Transactions> and <xref:System.EnterpriseServices> are always the same."},{"content":"It results in creating a new <ph id=\"ph1\">&lt;xref:System.EnterpriseServices&gt;</ph> transactional context and applying the transaction that is current for the <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> to be current for that context.","pos":[3513,3725],"source":" It results in creating a new <xref:System.EnterpriseServices> transactional context and applying the transaction that is current for the <xref:System.Transactions.TransactionScope> to be current for that context."},{"content":"As such, the transaction in <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> is completely in synchronization with the transaction in <ph id=\"ph2\">&lt;xref:System.EnterpriseServices.ContextUtil.Transaction%2A&gt;</ph>.","pos":[3726,3921],"source":" As such, the transaction in <xref:System.Transactions.Transaction.Current%2A> is completely in synchronization with the transaction in <xref:System.EnterpriseServices.ContextUtil.Transaction%2A>."},{"content":"This value introduces a performance penalty because new COM+ contexts may need to be created.","pos":[3922,4015]},{"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> specifies the following requirements:","pos":[4022,4118],"source":"<xref:System.Transactions.EnterpriseServicesInteropOption> specifies the following requirements:"},{"content":"When <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> is checked, <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph> should support transactions in the COM+ context if it detects that it is running in a context other than the default context.","pos":[4128,4347],"source":"When <xref:System.Transactions.Transaction.Current%2A> is checked, <xref:System.Transactions> should support transactions in the COM+ context if it detects that it is running in a context other than the default context."},{"content":"Note that the default context cannot contain a transaction.","pos":[4348,4407]},{"content":"Therefore, in the default context, even with <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>, the transaction stored in the thread local storage used by <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph> is returned for <ph id=\"ph3\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph>.","pos":[4408,4665],"source":" Therefore, in the default context, even with <xref:System.Transactions.EnterpriseServicesInteropOption>, the transaction stored in the thread local storage used by <xref:System.Transactions> is returned for <xref:System.Transactions.Transaction.Current%2A>."},{"content":"If a new <ph id=\"ph1\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object is created and the creation occurs in a context other than the default context, the transaction that is current for the <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object should be reflected in COM+.","pos":[4675,4934],"source":"If a new <xref:System.Transactions.TransactionScope> object is created and the creation occurs in a context other than the default context, the transaction that is current for the <xref:System.Transactions.TransactionScope> object should be reflected in COM+."},{"content":"In this case, <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> behaves like <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> in that it creates a new COM+ context.","pos":[4935,5118],"source":" In this case, <xref:System.Transactions.EnterpriseServicesInteropOption> behaves like <xref:System.Transactions.EnterpriseServicesInteropOption> in that it creates a new COM+ context."},{"content":"In addition when <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> is set in both <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>, both of these modes imply that <ph id=\"ph4\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> cannot be set directly.","pos":[5125,5434],"source":"In addition when <xref:System.Transactions.Transaction.Current%2A> is set in both <xref:System.Transactions.EnterpriseServicesInteropOption> and <xref:System.Transactions.EnterpriseServicesInteropOption>, both of these modes imply that <xref:System.Transactions.Transaction.Current%2A> cannot be set directly."},{"content":"Any attempt to set <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> directly other than creating a <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> results in an <ph id=\"ph3\">&lt;xref:System.InvalidOperationException&gt;</ph>.","pos":[5436,5634],"source":"  Any attempt to set <xref:System.Transactions.Transaction.Current%2A> directly other than creating a <xref:System.Transactions.TransactionScope> results in an <xref:System.InvalidOperationException>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration value is inherited by new transaction scopes that do not explicitly specify which value to use.","pos":[5635,5805],"source":" The <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration value is inherited by new transaction scopes that do not explicitly specify which value to use."},{"content":"For example, if you create a new <ph id=\"ph1\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object with <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>, and then create a second <ph id=\"ph3\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object but do not specify an <ph id=\"ph4\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> value, the second <ph id=\"ph5\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object also has a <ph id=\"ph6\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>.","pos":[5806,6251],"source":" For example, if you create a new <xref:System.Transactions.TransactionScope> object with <xref:System.Transactions.EnterpriseServicesInteropOption>, and then create a second <xref:System.Transactions.TransactionScope> object but do not specify an <xref:System.Transactions.EnterpriseServicesInteropOption> value, the second <xref:System.Transactions.TransactionScope> object also has a <xref:System.Transactions.EnterpriseServicesInteropOption>."},{"content":"In summary, the following rules apply when creating a new transaction scope:","pos":[6258,6334]},{"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> is checked to see if there is a transaction.","pos":[6344,6438],"source":"<xref:System.Transactions.Transaction.Current%2A> is checked to see if there is a transaction."},{"content":"This check results in:","pos":[6439,6461]},{"content":"A check to see if there is a scope.","pos":[6475,6510]},{"content":"If there is a scope, the value of the <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration passed in when the scope was initially created is checked.","pos":[6524,6691],"source":"If there is a scope, the value of the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration passed in when the scope was initially created is checked."},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration is set to <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>, the COM+ transaction (<ph id=\"ph3\">&lt;xref:System.EnterpriseServices&gt;</ph> Transaction) takes precedence over the <ph id=\"ph4\">&lt;xref:System.Transactions&gt;</ph> transaction in managed thread local storage.","pos":[6705,7018],"source":"If the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration is set to <xref:System.Transactions.EnterpriseServicesInteropOption>, the COM+ transaction (<xref:System.EnterpriseServices> Transaction) takes precedence over the <xref:System.Transactions> transaction in managed thread local storage."},{"content":"If the value is set to <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>, the <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph> transaction in managed thread local storage takes precedence.","pos":[7033,7208],"source":"If the value is set to <xref:System.Transactions.EnterpriseServicesInteropOption>, the <xref:System.Transactions> transaction in managed thread local storage takes precedence."},{"content":"If the value is <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>, there is only one transaction and it is a COM+ transaction.","pos":[7223,7358],"source":"If the value is <xref:System.Transactions.EnterpriseServicesInteropOption>, there is only one transaction and it is a COM+ transaction."},{"content":"The value of the <ph id=\"ph1\">&lt;xref:System.Transactions.TransactionScopeOption&gt;</ph> enumeration passed in by the <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> constructor is checked.","pos":[7368,7531],"source":"The value of the <xref:System.Transactions.TransactionScopeOption> enumeration passed in by the <xref:System.Transactions.TransactionScope> constructor is checked."},{"content":"This determines if a new transaction must be created.","pos":[7532,7585]},{"content":"If a new transaction is to be created, the following values of <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> result in:","pos":[7595,7727],"source":"If a new transaction is to be created, the following values of <xref:System.Transactions.EnterpriseServicesInteropOption> result in:"},{"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>:  a transaction associated with a COM+ context is created.","pos":[7741,7858],"source":"<xref:System.Transactions.EnterpriseServicesInteropOption>:  a transaction associated with a COM+ context is created."},{"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>: a <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph> transaction is created.","pos":[7872,7984],"source":"<xref:System.Transactions.EnterpriseServicesInteropOption>: a <xref:System.Transactions> transaction is created."},{"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph>: if there is a COM+ context, a transaction is created and attached to the context.","pos":[7998,8139],"source":"<xref:System.Transactions.EnterpriseServicesInteropOption>: if there is a COM+ context, a transaction is created and attached to the context."},{"content":"The following table illustrates the Enterprise Services (ES) context and a transactional scope that requires a transaction using the <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration.","pos":[8146,8350],"source":"The following table illustrates the Enterprise Services (ES) context and a transactional scope that requires a transaction using the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration."},{"content":"ES Context","pos":[8357,8367]},{"content":"None","pos":[8368,8372]},{"content":"Automatic","pos":[8373,8382]},{"content":"Full","pos":[8383,8387]},{"content":"Default context","pos":[8451,8466]},{"content":"Default context","pos":[8467,8482]},{"content":"Default context","pos":[8483,8498]},{"content":"Create new","pos":[8499,8509]},{"content":"transactional context","pos":[8516,8537]},{"content":"Non-default context","pos":[8542,8561]},{"content":"Maintain client's context","pos":[8562,8587]},{"content":"Create new transactional context","pos":[8588,8620]},{"content":"Create new transactional context","pos":[8621,8653]},{"content":"The following table illustrates what the ambient transaction is, given a particular <ph id=\"ph1\">&lt;xref:System.EnterpriseServices&gt;</ph> context, and a transactional scope that requires a transaction using the <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration.","pos":[8661,8922],"source":"The following table illustrates what the ambient transaction is, given a particular <xref:System.EnterpriseServices> context, and a transactional scope that requires a transaction using the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration."},{"content":"ES Context","pos":[8929,8939]},{"content":"None","pos":[8940,8944]},{"content":"Automatic","pos":[8945,8954]},{"content":"Full","pos":[8955,8959]},{"content":"Default context","pos":[9023,9038]},{"content":"ST","pos":[9039,9041]},{"content":"ST","pos":[9042,9044]},{"content":"ES","pos":[9045,9047]},{"content":"Non-default context","pos":[9052,9071]},{"content":"ST","pos":[9072,9074]},{"content":"ES","pos":[9075,9077]},{"content":"ES","pos":[9078,9080]},{"content":"In the preceding table:","pos":[9088,9111]},{"content":"ST means that the scope's ambient transaction is managed by <ph id=\"ph1\">&lt;xref:System.Transactions&gt;</ph>, separate from any <ph id=\"ph2\">&lt;xref:System.EnterpriseServices&gt;</ph> context's transaction that may be present.","pos":[9121,9302],"source":"ST means that the scope's ambient transaction is managed by <xref:System.Transactions>, separate from any <xref:System.EnterpriseServices> context's transaction that may be present."},{"content":"ES means that the scope's ambient transaction is same as the <ph id=\"ph1\">&lt;xref:System.EnterpriseServices&gt;</ph> context's transaction.","pos":[9312,9428],"source":"ES means that the scope's ambient transaction is same as the <xref:System.EnterpriseServices> context's transaction."}]}