{"content":"---\ntitle: \"How to: Resolve Conflicts by Retaining Database Values | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: b475cf72-9e64-4f6e-99c1-af7737bc85ef\ncaps.latest.revision: 2\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# How to: Resolve Conflicts by Retaining Database Values\nTo reconcile differences between expected and actual database values before you try to resubmit your changes, you can use <xref:System.Data.Linq.RefreshMode> to retain the values found in the database. The current values in the object model are then overwritten. For more information, see [Optimistic Concurrency: Overview](../../../../../../docs/framework/data/adonet/sql/linq/optimistic-concurrency-overview.md).  \n  \n> [!NOTE]\n>  In all cases, the record on the client is first refreshed by retrieving the updated data from the database. This action makes sure that the next update try will not fail on the same concurrency checks.  \n  \n## Example  \n In this scenario, a <xref:System.Data.Linq.ChangeConflictException> exception is thrown when User1 tries to submit changes, because User2 has in the meantime changed the Assistant and Department columns. The following table shows the situation.  \n  \n||Manager|Assistant|Department|  \n|------|-------------|---------------|----------------|  \n|Original database state when queried by User1 and User2.|Alfreds|Maria|Sales|  \n|User1 prepares to submit these changes.|Alfred||Marketing|  \n|User2 has already submitted these changes.||Mary|Service|  \n  \n User1 decides to resolve this conflict by having the newer database values overwrite the current values in the object model.  \n  \n When User1 resolves the conflict by using <xref:System.Data.Linq.RefreshMode>, the result in the database is as follows in the table:  \n  \n||Manager|Assistant|Department|  \n|------|-------------|---------------|----------------|  \n|New state after conflict resolution.|Alfreds<br /><br /> (original)|Mary<br /><br /> (from User2)|Service<br /><br /> (from User2)|  \n  \n The following example code shows how to overwrite current values in the object model with the database values. (No inspection or custom handling of individual member conflicts occurs.)  \n  \n [!code-csharp[System.Data.Linq.RefreshMode#1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/system.data.linq.refreshmode/cs/program.cs#1)]\n [!code-vb[System.Data.Linq.RefreshMode#1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/system.data.linq.refreshmode/vb/module1.vb#1)]  \n  \n## See Also  \n [How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)","nodes":[{"pos":[12,83],"content":"How to: Resolve Conflicts by Retaining Database Values | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Resolve Conflicts by Retaining Database Values | Microsoft Docs","pos":[0,71]}]},{"pos":[392,446],"content":"How to: Resolve Conflicts by Retaining Database Values","linkify":"How to: Resolve Conflicts by Retaining Database Values","nodes":[{"content":"How to: Resolve Conflicts by Retaining Database Values","pos":[0,54]}]},{"content":"To reconcile differences between expected and actual database values before you try to resubmit your changes, you can use <ph id=\"ph1\">&lt;xref:System.Data.Linq.RefreshMode&gt;</ph> to retain the values found in the database.","pos":[447,648],"source":"To reconcile differences between expected and actual database values before you try to resubmit your changes, you can use <xref:System.Data.Linq.RefreshMode> to retain the values found in the database."},{"content":"The current values in the object model are then overwritten.","pos":[649,709]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Optimistic Concurrency: Overview<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/optimistic-concurrency-overview.md)</ept>.","pos":[710,861],"source":" For more information, see [Optimistic Concurrency: Overview](../../../../../../docs/framework/data/adonet/sql/linq/optimistic-concurrency-overview.md)."},{"pos":[869,1081],"content":"[!NOTE]\n In all cases, the record on the client is first refreshed by retrieving the updated data from the database. This action makes sure that the next update try will not fail on the same concurrency checks.","leadings":["","> "],"nodes":[{"content":" In all cases, the record on the client is first refreshed by retrieving the updated data from the database. This action makes sure that the next update try will not fail on the same concurrency checks.","pos":[8,210],"nodes":[{"content":"In all cases, the record on the client is first refreshed by retrieving the updated data from the database.","pos":[1,108]},{"content":"This action makes sure that the next update try will not fail on the same concurrency checks.","pos":[109,202]}]}]},{"pos":[1090,1097],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In this scenario, a <ph id=\"ph1\">&lt;xref:System.Data.Linq.ChangeConflictException&gt;</ph> exception is thrown when User1 tries to submit changes, because User2 has in the meantime changed the Assistant and Department columns.","pos":[1101,1304],"source":"In this scenario, a <xref:System.Data.Linq.ChangeConflictException> exception is thrown when User1 tries to submit changes, because User2 has in the meantime changed the Assistant and Department columns."},{"content":"The following table shows the situation.","pos":[1305,1345]},{"content":"Manager","pos":[1353,1360]},{"content":"Assistant","pos":[1361,1370]},{"content":"Department","pos":[1371,1381]},{"content":"Original database state when queried by User1 and User2.","pos":[1444,1500]},{"content":"Alfreds","pos":[1501,1508]},{"content":"Maria","pos":[1509,1514]},{"content":"Sales","pos":[1515,1520]},{"content":"User1 prepares to submit these changes.","pos":[1525,1564]},{"content":"Alfred","pos":[1565,1571]},{"content":"Marketing","pos":[1573,1582]},{"content":"User2 has already submitted these changes.","pos":[1587,1629]},{"content":"Mary","pos":[1631,1635]},{"content":"Service","pos":[1636,1643]},{"content":"User1 decides to resolve this conflict by having the newer database values overwrite the current values in the object model.","pos":[1651,1775]},{"content":"When User1 resolves the conflict by using <ph id=\"ph1\">&lt;xref:System.Data.Linq.RefreshMode&gt;</ph>, the result in the database is as follows in the table:","pos":[1782,1915],"source":"When User1 resolves the conflict by using <xref:System.Data.Linq.RefreshMode>, the result in the database is as follows in the table:"},{"content":"Manager","pos":[1923,1930]},{"content":"Assistant","pos":[1931,1940]},{"content":"Department","pos":[1941,1951]},{"content":"New state after conflict resolution.","pos":[2014,2050]},{"content":"Alfreds","pos":[2051,2058]},{"content":"(original)","pos":[2071,2081]},{"content":"Mary","pos":[2082,2086]},{"content":"(from User2)","pos":[2099,2111]},{"content":"Service","pos":[2112,2119]},{"content":"(from User2)","pos":[2132,2144]},{"content":"The following example code shows how to overwrite current values in the object model with the database values.","pos":[2152,2262]},{"content":"(No inspection or custom handling of individual member conflicts occurs.)","pos":[2263,2336]},{"pos":[2343,2648],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Data.Linq.RefreshMode#1<ept id=\"p2\">](../../../../../../samples/snippets/csharp/VS_Snippets_Data/system.data.linq.refreshmode/cs/program.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Data.Linq.RefreshMode#1<ept id=\"p4\">](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/system.data.linq.refreshmode/vb/module1.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.Data.Linq.RefreshMode#1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/system.data.linq.refreshmode/cs/program.cs#1)]\n [!code-vb[System.Data.Linq.RefreshMode#1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/system.data.linq.refreshmode/vb/module1.vb#1)]"},{"pos":[2657,2665],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2669,2791],"content":"<bpt id=\"p1\">[</bpt>How to: Manage Change Conflicts<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)</ept>","source":"[How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)"}]}