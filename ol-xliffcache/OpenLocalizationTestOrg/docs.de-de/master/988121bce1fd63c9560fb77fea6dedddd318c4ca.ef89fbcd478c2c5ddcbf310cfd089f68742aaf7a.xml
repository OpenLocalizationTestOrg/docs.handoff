{"content":"---\ntitle: \"Troubleshooting Control and Component Authoring\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"troubleshooting components\"\n  - \"troubleshooting controls [Windows Forms]\"\n  - \"controls [Windows Forms], troubleshooting\"\n  - \"components [Windows Forms], troubleshooting\"\n  - \"Windows Forms controls, debugging\"\nms.assetid: e9c8c099-2271-4737-882f-50f336c7a55e\n---\n# Troubleshooting Control and Component Authoring\nThis topic lists the following common problems that arise when developing components and controls. For more information, see [Programming with Components](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/0ffkdtkf(v=vs.120)).  \n  \n-   Cannot Add Control to Toolbox  \n  \n-   Cannot Debug the Windows Forms User Control or Component  \n  \n-   Event Is Raised Twice in Inherited Control or Component  \n  \n-   Design-Time Error: \"Failed to Create Component '*Component Name*'\"  \n  \n-   STAThreadAttribute  \n  \n-   Component Icon Does Not Appear in Toolbox  \n  \n## Cannot Add Control to Toolbox  \n If you want to add a custom control that you created in another project or a third-party control to the **Toolbox**, you must do so manually. If the current project contains your control or component, it should appear in the **Toolbox** automatically. For more information, see [Walkthrough: Automatically Populating the Toolbox with Custom Components](walkthrough-automatically-populating-the-toolbox-with-custom-components.md).  \n  \n#### To add a control to the Toolbox  \n  \n1.  Right-click the **Toolbox** and from the shortcut menu, select **Choose Items**.  \n  \n2.  In the **Choose Toolbox Items** dialog box, add the component:  \n  \n    -   If you want to add a .NET Framework component or control, click the **.NET Framework Components** tab.  \n  \n         – or –  \n  \n    -   If you want to add a COM component or ActiveX control, click the **COM Components** tab.  \n  \n3.  If your control is listed in the dialog box, confirm it is selected, and then click **OK**.  \n  \n     The control is added to the **Toolbox**.  \n  \n4.  If your control is not listed in the dialog box, do the following:  \n  \n    1.  Click the **Browse** button.  \n  \n    2.  Browse to the folder that contains the .dll file that contains your control.  \n  \n    3.  Select the .dll file and click **Open**.  \n  \n         Your control appears in the dialog box.  \n  \n    4.  Confirm that your control is selected, and then click **OK**.  \n  \n         Your control is added to the **Toolbox**.  \n  \n## Cannot Debug the Windows Forms User Control or Component  \n If your control derives from the <xref:System.Windows.Forms.UserControl> class, you can debug its run-time behavior with the test container. For more information, see [How to: Test the Run-Time Behavior of a UserControl](how-to-test-the-run-time-behavior-of-a-usercontrol.md).  \n  \n Other custom controls and components are not stand-alone projects. They must be hosted by an application such as a Windows Forms project. To debug a control or component, you must add it to a Windows Forms project.  \n  \n#### To debug a control or component  \n  \n1.  From the **Build** menu, click **Build Solution** to build your solution.  \n  \n2.  From the **File** menu, choose **Add**, and then **New Project** to add a test project to your application.  \n  \n3.  In the **Add New Project** dialog box choose **Windows Application** for the type of project.  \n  \n4.  In **Solution Explorer**, right-click the **References** node for the new project. On the shortcut menu, click **Add Reference** to add a reference to the project containing the control or component.  \n  \n5.  Create an instance of your control or component in the test project. If your component is in the **Toolbox**, you can drag it to your designer surface, or you can create the instance programmatically, as shown in the following code example.  \n  \n    ```vb  \n    Dim Component1 As New MyNeatComponent()  \n    ```  \n  \n    ```csharp  \n    MyNeatComponent Component1 = new MyNeatComponent();  \n    ```  \n  \n     You can now debug your control or component as usual.  \n  \n For more information about debugging, see [Debugging in Visual Studio](/visualstudio/debugger/debugging-in-visual-studio) and [Walkthrough: Debugging Custom Windows Forms Controls at Design Time](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md).  \n  \n## Event Is Raised Twice in Inherited Control or Component  \n This is likely due to a duplicated `Handles` clause. For more information, see [Troubleshooting Inherited Event Handlers in Visual Basic](~/docs/visual-basic/programming-guide/language-features/events/troubleshooting-inherited-event-handlers.md).  \n  \n## Design-Time Error: \"Failed to Create Component 'Component Name'\"  \n Your component or control must provide a default constructor with no parameters. When the design environment creates an instance of your component or control, it does not attempt to provide any parameters to constructor overloads that take parameters.  \n  \n## STAThreadAttribute  \n The <xref:System.STAThreadAttribute> informs the common language runtime (CLR) that Windows Forms uses the single-threaded apartment model. You may notice unintended behavior if you do not apply this attribute to your Windows Forms application's `Main` method. For example, background images may not appear for controls like <xref:System.Windows.Forms.ListView>. Some controls may also require this attribute for correct AutoComplete and drag-and-drop behavior.  \n  \n## Component Icon Does Not Appear in Toolbox  \n When you use <xref:System.Drawing.ToolboxBitmapAttribute> to associate an icon with your custom component, the bitmap does not appear in the Toolbox for autogenerated components. To see the bitmap, reload the control by using the **Choose Toolbox Items** dialog box. For more information, see [How to: Provide a Toolbox Bitmap for a Control](how-to-provide-a-toolbox-bitmap-for-a-control.md).  \n  \n## See also\n\n- [Developing Windows Forms Controls at Design Time](developing-windows-forms-controls-at-design-time.md)\n- [Walkthrough: Automatically Populating the Toolbox with Custom Components](walkthrough-automatically-populating-the-toolbox-with-custom-components.md)\n- [How to: Test the Run-Time Behavior of a UserControl](how-to-test-the-run-time-behavior-of-a-usercontrol.md)\n- [Walkthrough: Debugging Custom Windows Forms Controls at Design Time](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md)\n- [Component Authoring](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/5dya64wy(v=vs.120))\n- [Troubleshooting Design-Time Development](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/ms171843(v=vs.120))\n","nodes":[{"pos":[4,405],"embed":true,"restype":"x-metadata","content":"title: \"Troubleshooting Control and Component Authoring\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"troubleshooting components\"\n  - \"troubleshooting controls [Windows Forms]\"\n  - \"controls [Windows Forms], troubleshooting\"\n  - \"components [Windows Forms], troubleshooting\"\n  - \"Windows Forms controls, debugging\"\nms.assetid: e9c8c099-2271-4737-882f-50f336c7a55e","nodes":[{"content":"Troubleshooting Control and Component Authoring","nodes":[{"pos":[0,47],"content":"Troubleshooting Control and Component Authoring","nodes":[{"content":"Troubleshooting Control and Component Authoring","pos":[0,47]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[412,459],"content":"Troubleshooting Control and Component Authoring","linkify":"Troubleshooting Control and Component Authoring","nodes":[{"content":"Troubleshooting Control and Component Authoring","pos":[0,47]}]},{"content":"This topic lists the following common problems that arise when developing components and controls.","pos":[460,558]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Programming with Components<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/0ffkdtkf(v=vs.120))</ept>.","pos":[559,712],"source":" For more information, see [Programming with Components](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/0ffkdtkf(v=vs.120))."},{"content":"Cannot Add Control to Toolbox","pos":[722,751]},{"content":"Cannot Debug the Windows Forms User Control or Component","pos":[761,817]},{"content":"Event Is Raised Twice in Inherited Control or Component","pos":[827,882]},{"pos":[892,958],"content":"Design-Time Error: \"Failed to Create Component '<bpt id=\"p1\">*</bpt>Component Name<ept id=\"p1\">*</ept>'\"","source":"Design-Time Error: \"Failed to Create Component '*Component Name*'\""},{"content":"STAThreadAttribute","pos":[968,986]},{"content":"Component Icon Does Not Appear in Toolbox","pos":[996,1037]},{"pos":[1046,1075],"content":"Cannot Add Control to Toolbox","linkify":"Cannot Add Control to Toolbox","nodes":[{"content":"Cannot Add Control to Toolbox","pos":[0,29]}]},{"content":"If you want to add a custom control that you created in another project or a third-party control to the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, you must do so manually.","pos":[1079,1220],"source":"If you want to add a custom control that you created in another project or a third-party control to the **Toolbox**, you must do so manually."},{"content":"If the current project contains your control or component, it should appear in the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> automatically.","pos":[1221,1330],"source":" If the current project contains your control or component, it should appear in the **Toolbox** automatically."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Automatically Populating the Toolbox with Custom Components<ept id=\"p1\">](walkthrough-automatically-populating-the-toolbox-with-custom-components.md)</ept>.","pos":[1331,1508],"source":" For more information, see [Walkthrough: Automatically Populating the Toolbox with Custom Components](walkthrough-automatically-populating-the-toolbox-with-custom-components.md)."},{"pos":[1519,1550],"content":"To add a control to the Toolbox","linkify":"To add a control to the Toolbox","nodes":[{"content":"To add a control to the Toolbox","pos":[0,31]}]},{"pos":[1560,1640],"content":"Right-click the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> and from the shortcut menu, select <bpt id=\"p2\">**</bpt>Choose Items<ept id=\"p2\">**</ept>.","source":"Right-click the **Toolbox** and from the shortcut menu, select **Choose Items**."},{"pos":[1650,1712],"content":"In the <bpt id=\"p1\">**</bpt>Choose Toolbox Items<ept id=\"p1\">**</ept> dialog box, add the component:","source":"In the **Choose Toolbox Items** dialog box, add the component:"},{"pos":[1726,1828],"content":"If you want to add a .NET Framework component or control, click the <bpt id=\"p1\">**</bpt>.NET Framework Components<ept id=\"p1\">**</ept> tab.","source":"If you want to add a .NET Framework component or control, click the **.NET Framework Components** tab."},{"content":"– or –","pos":[1843,1849]},{"pos":[1863,1951],"content":"If you want to add a COM component or ActiveX control, click the <bpt id=\"p1\">**</bpt>COM Components<ept id=\"p1\">**</ept> tab.","source":"If you want to add a COM component or ActiveX control, click the **COM Components** tab."},{"pos":[1961,2052],"content":"If your control is listed in the dialog box, confirm it is selected, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"If your control is listed in the dialog box, confirm it is selected, and then click **OK**."},{"pos":[2063,2103],"content":"The control is added to the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>.","source":"The control is added to the **Toolbox**."},{"content":"If your control is not listed in the dialog box, do the following:","pos":[2113,2179]},{"pos":[2193,2221],"content":"Click the <bpt id=\"p1\">**</bpt>Browse<ept id=\"p1\">**</ept> button.","source":"Click the **Browse** button."},{"content":"Browse to the folder that contains the .dll file that contains your control.","pos":[2235,2311]},{"pos":[2325,2365],"content":"Select the .dll file and click <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>.","source":"Select the .dll file and click **Open**."},{"content":"Your control appears in the dialog box.","pos":[2380,2419]},{"pos":[2433,2494],"content":"Confirm that your control is selected, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Confirm that your control is selected, and then click **OK**."},{"pos":[2509,2550],"content":"Your control is added to the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>.","source":"Your control is added to the **Toolbox**."},{"pos":[2559,2615],"content":"Cannot Debug the Windows Forms User Control or Component","linkify":"Cannot Debug the Windows Forms User Control or Component","nodes":[{"content":"Cannot Debug the Windows Forms User Control or Component","pos":[0,56]}]},{"content":"If your control derives from the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> class, you can debug its run-time behavior with the test container.","pos":[2619,2759],"source":"If your control derives from the <xref:System.Windows.Forms.UserControl> class, you can debug its run-time behavior with the test container."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Test the Run-Time Behavior of a UserControl<ept id=\"p1\">](how-to-test-the-run-time-behavior-of-a-usercontrol.md)</ept>.","pos":[2760,2895],"source":" For more information, see [How to: Test the Run-Time Behavior of a UserControl](how-to-test-the-run-time-behavior-of-a-usercontrol.md)."},{"content":"Other custom controls and components are not stand-alone projects.","pos":[2902,2968]},{"content":"They must be hosted by an application such as a Windows Forms project.","pos":[2969,3039]},{"content":"To debug a control or component, you must add it to a Windows Forms project.","pos":[3040,3116]},{"pos":[3127,3158],"content":"To debug a control or component","linkify":"To debug a control or component","nodes":[{"content":"To debug a control or component","pos":[0,31]}]},{"pos":[3168,3241],"content":"From the <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Build Solution<ept id=\"p2\">**</ept> to build your solution.","source":"From the **Build** menu, click **Build Solution** to build your solution."},{"pos":[3251,3358],"content":"From the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>, and then <bpt id=\"p3\">**</bpt>New Project<ept id=\"p3\">**</ept> to add a test project to your application.","source":"From the **File** menu, choose **Add**, and then **New Project** to add a test project to your application."},{"pos":[3368,3461],"content":"In the <bpt id=\"p1\">**</bpt>Add New Project<ept id=\"p1\">**</ept> dialog box choose <bpt id=\"p2\">**</bpt>Windows Application<ept id=\"p2\">**</ept> for the type of project.","source":"In the **Add New Project** dialog box choose **Windows Application** for the type of project."},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the <bpt id=\"p2\">**</bpt>References<ept id=\"p2\">**</ept> node for the new project.","pos":[3471,3553],"source":"In **Solution Explorer**, right-click the **References** node for the new project."},{"content":"On the shortcut menu, click <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept> to add a reference to the project containing the control or component.","pos":[3554,3670],"source":" On the shortcut menu, click **Add Reference** to add a reference to the project containing the control or component."},{"content":"Create an instance of your control or component in the test project.","pos":[3680,3748]},{"content":"If your component is in the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, you can drag it to your designer surface, or you can create the instance programmatically, as shown in the following code example.","pos":[3749,3920],"source":" If your component is in the **Toolbox**, you can drag it to your designer surface, or you can create the instance programmatically, as shown in the following code example."},{"content":"You can now debug your control or component as usual.","pos":[4089,4142]},{"pos":[4149,4416],"content":"For more information about debugging, see <bpt id=\"p1\">[</bpt>Debugging in Visual Studio<ept id=\"p1\">](/visualstudio/debugger/debugging-in-visual-studio)</ept> and <bpt id=\"p2\">[</bpt>Walkthrough: Debugging Custom Windows Forms Controls at Design Time<ept id=\"p2\">](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md)</ept>.","source":"For more information about debugging, see [Debugging in Visual Studio](/visualstudio/debugger/debugging-in-visual-studio) and [Walkthrough: Debugging Custom Windows Forms Controls at Design Time](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md)."},{"pos":[4425,4480],"content":"Event Is Raised Twice in Inherited Control or Component","linkify":"Event Is Raised Twice in Inherited Control or Component","nodes":[{"content":"Event Is Raised Twice in Inherited Control or Component","pos":[0,55]}]},{"content":"This is likely due to a duplicated <ph id=\"ph1\">`Handles`</ph> clause.","pos":[4484,4536],"source":"This is likely due to a duplicated `Handles` clause."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Troubleshooting Inherited Event Handlers in Visual Basic<ept id=\"p1\">](~/docs/visual-basic/programming-guide/language-features/events/troubleshooting-inherited-event-handlers.md)</ept>.","pos":[4537,4730],"source":" For more information, see [Troubleshooting Inherited Event Handlers in Visual Basic](~/docs/visual-basic/programming-guide/language-features/events/troubleshooting-inherited-event-handlers.md)."},{"pos":[4739,4803],"content":"Design-Time Error: \"Failed to Create Component 'Component Name'\"","linkify":"Design-Time Error: \"Failed to Create Component 'Component Name'\"","nodes":[{"content":"Design-Time Error: \"Failed to Create Component 'Component Name'\"","pos":[0,64]}]},{"content":"Your component or control must provide a default constructor with no parameters.","pos":[4807,4887]},{"content":"When the design environment creates an instance of your component or control, it does not attempt to provide any parameters to constructor overloads that take parameters.","pos":[4888,5058]},{"pos":[5067,5085],"content":"STAThreadAttribute","linkify":"STAThreadAttribute","nodes":[{"content":"STAThreadAttribute","pos":[0,18]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.STAThreadAttribute&gt;</ph> informs the common language runtime (CLR) that Windows Forms uses the single-threaded apartment model.","pos":[5089,5228],"source":"The <xref:System.STAThreadAttribute> informs the common language runtime (CLR) that Windows Forms uses the single-threaded apartment model."},{"content":"You may notice unintended behavior if you do not apply this attribute to your Windows Forms application's <ph id=\"ph1\">`Main`</ph> method.","pos":[5229,5349],"source":" You may notice unintended behavior if you do not apply this attribute to your Windows Forms application's `Main` method."},{"content":"For example, background images may not appear for controls like <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView&gt;</ph>.","pos":[5350,5451],"source":" For example, background images may not appear for controls like <xref:System.Windows.Forms.ListView>."},{"content":"Some controls may also require this attribute for correct AutoComplete and drag-and-drop behavior.","pos":[5452,5550]},{"pos":[5559,5600],"content":"Component Icon Does Not Appear in Toolbox","linkify":"Component Icon Does Not Appear in Toolbox","nodes":[{"content":"Component Icon Does Not Appear in Toolbox","pos":[0,41]}]},{"content":"When you use <ph id=\"ph1\">&lt;xref:System.Drawing.ToolboxBitmapAttribute&gt;</ph> to associate an icon with your custom component, the bitmap does not appear in the Toolbox for autogenerated components.","pos":[5604,5782],"source":"When you use <xref:System.Drawing.ToolboxBitmapAttribute> to associate an icon with your custom component, the bitmap does not appear in the Toolbox for autogenerated components."},{"content":"To see the bitmap, reload the control by using the <bpt id=\"p1\">**</bpt>Choose Toolbox Items<ept id=\"p1\">**</ept> dialog box.","pos":[5783,5870],"source":" To see the bitmap, reload the control by using the **Choose Toolbox Items** dialog box."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Provide a Toolbox Bitmap for a Control<ept id=\"p1\">](how-to-provide-a-toolbox-bitmap-for-a-control.md)</ept>.","pos":[5871,5996],"source":" For more information, see [How to: Provide a Toolbox Bitmap for a Control](how-to-provide-a-toolbox-bitmap-for-a-control.md)."},{"pos":[6005,6013],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6017,6120],"content":"<bpt id=\"p1\">[</bpt>Developing Windows Forms Controls at Design Time<ept id=\"p1\">](developing-windows-forms-controls-at-design-time.md)</ept>","source":"[Developing Windows Forms Controls at Design Time](developing-windows-forms-controls-at-design-time.md)"},{"pos":[6123,6273],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Automatically Populating the Toolbox with Custom Components<ept id=\"p1\">](walkthrough-automatically-populating-the-toolbox-with-custom-components.md)</ept>","source":"[Walkthrough: Automatically Populating the Toolbox with Custom Components](walkthrough-automatically-populating-the-toolbox-with-custom-components.md)"},{"pos":[6276,6384],"content":"<bpt id=\"p1\">[</bpt>How to: Test the Run-Time Behavior of a UserControl<ept id=\"p1\">](how-to-test-the-run-time-behavior-of-a-usercontrol.md)</ept>","source":"[How to: Test the Run-Time Behavior of a UserControl](how-to-test-the-run-time-behavior-of-a-usercontrol.md)"},{"pos":[6387,6527],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Debugging Custom Windows Forms Controls at Design Time<ept id=\"p1\">](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md)</ept>","source":"[Walkthrough: Debugging Custom Windows Forms Controls at Design Time](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md)"},{"pos":[6530,6648],"content":"<bpt id=\"p1\">[</bpt>Component Authoring<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/5dya64wy(v=vs.120))</ept>","source":"[Component Authoring](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/5dya64wy(v=vs.120))"},{"pos":[6651,6789],"content":"<bpt id=\"p1\">[</bpt>Troubleshooting Design-Time Development<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/ms171843(v=vs.120))</ept>","source":"[Troubleshooting Design-Time Development](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/ms171843(v=vs.120))"}]}