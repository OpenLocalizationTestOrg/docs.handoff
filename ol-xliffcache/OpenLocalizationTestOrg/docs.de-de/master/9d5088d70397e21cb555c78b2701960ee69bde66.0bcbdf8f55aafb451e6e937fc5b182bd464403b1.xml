{"content":"---\ntitle: \"Mitigation: PNG Frames in Icon Objects | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: ca87fefb-7144-4b4e-8832-5a939adbb4b2\ncaps.latest.revision: 4\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Mitigation: PNG Frames in Icon Objects\nStarting with the .NET Framework 4.6, the <xref:System.Drawing.Icon.ToBitmap%2A?displayProperty=fullName> method successfully converts icons with PNG frames into <xref:System.Drawing.Bitmap> objects.  \n  \n In apps that target the .NET Framework 4.5.2 and earlier versions, the <xref:System.Drawing.Icon.ToBitmap%2A?displayProperty=fullName> method throws an <xref:System.ArgumentOutOfRangeException> exception if the <xref:System.Drawing.Icon> object has PNG frames.  \n  \n## Impact  \n This change affects apps that are recompiled to target the .NET Framework 4.6 and that implement special handling for the <xref:System.ArgumentOutOfRangeException> that is thrown when an <xref:System.Drawing.Icon> object has PNG frames. When running under the .NET Framework 4.6, the conversion is successful, an <xref:System.ArgumentOutOfRangeException> is no longer thrown, and therefore the exception handler is no longer invoked.  \n  \n### Mitigation  \n If this behavior is undesirable, you can retain the previous behavior by adding the following element to the [\\<runtime>](../../../docs/framework/configure-apps/file-schema/runtime/runtime-element.md) section of your app.config file:  \n  \n```  \n<AppContextSwitchOverrides   \n      value=\"Switch.System.Drawing.DontSupportPngFramesInIcons=true\" />  \n  \n```  \n  \n If the app.config file already contains the `AppContextSwitchOverrides` element, the new value should be merged with the `value` attribute like this:  \n  \n```  \n<AppContextSwitchOverrides   \n      value=\"Switch.System.Drawing.DontSupportPngFramesInIcons=true;<previous key>=<previous value>\" />  \n  \n```  \n  \n## See Also  \n [Retargeting Changes](../../../docs/framework/migration-guide/retargeting-changes-in-the-net-framework-4-6.md)","nodes":[{"pos":[12,67],"content":"Mitigation: PNG Frames in Icon Objects | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Mitigation: PNG Frames in Icon Objects | Microsoft Docs","pos":[0,55]}]},{"pos":[370,408],"content":"Mitigation: PNG Frames in Icon Objects","linkify":"Mitigation: PNG Frames in Icon Objects","nodes":[{"content":"Mitigation: PNG Frames in Icon Objects","pos":[0,38]}]},{"content":"Starting with the .NET Framework 4.6, the <ph id=\"ph1\">&lt;xref:System.Drawing.Icon.ToBitmap%2A?displayProperty=fullName&gt;</ph> method successfully converts icons with PNG frames into <ph id=\"ph2\">&lt;xref:System.Drawing.Bitmap&gt;</ph> objects.","pos":[409,608],"source":"Starting with the .NET Framework 4.6, the <xref:System.Drawing.Icon.ToBitmap%2A?displayProperty=fullName> method successfully converts icons with PNG frames into <xref:System.Drawing.Bitmap> objects."},{"content":"In apps that target the .NET Framework 4.5.2 and earlier versions, the <ph id=\"ph1\">&lt;xref:System.Drawing.Icon.ToBitmap%2A?displayProperty=fullName&gt;</ph> method throws an <ph id=\"ph2\">&lt;xref:System.ArgumentOutOfRangeException&gt;</ph> exception if the <ph id=\"ph3\">&lt;xref:System.Drawing.Icon&gt;</ph> object has PNG frames.","pos":[615,875],"source":"In apps that target the .NET Framework 4.5.2 and earlier versions, the <xref:System.Drawing.Icon.ToBitmap%2A?displayProperty=fullName> method throws an <xref:System.ArgumentOutOfRangeException> exception if the <xref:System.Drawing.Icon> object has PNG frames."},{"pos":[884,890],"content":"Impact","linkify":"Impact","nodes":[{"content":"Impact","pos":[0,6]}]},{"content":"This change affects apps that are recompiled to target the .NET Framework 4.6 and that implement special handling for the <ph id=\"ph1\">&lt;xref:System.ArgumentOutOfRangeException&gt;</ph> that is thrown when an <ph id=\"ph2\">&lt;xref:System.Drawing.Icon&gt;</ph> object has PNG frames.","pos":[894,1130],"source":"This change affects apps that are recompiled to target the .NET Framework 4.6 and that implement special handling for the <xref:System.ArgumentOutOfRangeException> that is thrown when an <xref:System.Drawing.Icon> object has PNG frames."},{"content":"When running under the .NET Framework 4.6, the conversion is successful, an <ph id=\"ph1\">&lt;xref:System.ArgumentOutOfRangeException&gt;</ph> is no longer thrown, and therefore the exception handler is no longer invoked.","pos":[1131,1327],"source":" When running under the .NET Framework 4.6, the conversion is successful, an <xref:System.ArgumentOutOfRangeException> is no longer thrown, and therefore the exception handler is no longer invoked."},{"pos":[1337,1347],"content":"Mitigation","linkify":"Mitigation","nodes":[{"content":"Mitigation","pos":[0,10]}]},{"pos":[1351,1584],"content":"If this behavior is undesirable, you can retain the previous behavior by adding the following element to the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>runtime&gt;<ept id=\"p1\">](../../../docs/framework/configure-apps/file-schema/runtime/runtime-element.md)</ept> section of your app.config file:","source":"If this behavior is undesirable, you can retain the previous behavior by adding the following element to the [\\<runtime>](../../../docs/framework/configure-apps/file-schema/runtime/runtime-element.md) section of your app.config file:"},{"pos":[1713,1862],"content":"If the app.config file already contains the <ph id=\"ph1\">`AppContextSwitchOverrides`</ph> element, the new value should be merged with the <ph id=\"ph2\">`value`</ph> attribute like this:","source":"If the app.config file already contains the `AppContextSwitchOverrides` element, the new value should be merged with the `value` attribute like this:"},{"pos":[2025,2033],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2037,2147],"content":"<bpt id=\"p1\">[</bpt>Retargeting Changes<ept id=\"p1\">](../../../docs/framework/migration-guide/retargeting-changes-in-the-net-framework-4-6.md)</ept>","source":"[Retargeting Changes](../../../docs/framework/migration-guide/retargeting-changes-in-the-net-framework-4-6.md)"}]}