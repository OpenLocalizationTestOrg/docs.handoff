{"content":"---\ntitle: \"Dynamic Arguments | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 122ad479-d306-4602-a943-5aefe711329d\ncaps.latest.revision: 9\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Dynamic Arguments\nThis sample demonstrates how to implement an activity for which the arguments are defined by the activity consumer rather than the activity author. It does this by overriding the way the runtime constructs the activity’s metadata.  \n  \n## Sample details  \n Prior to execution, the runtime builds a description of an activity by examining the public members of the activity type and automatically declaring arguments, variables, child activities, and activity delegates as part of an activity’s metadata. It does this to ensure correct construction of a workflow as well as to manage run-time relationships and lifetime rules. Typically an activity author defines the arguments of an activity by specifying public members on the activity type that derive from <xref:System.Activities.Argument>. For each public member that derives from <xref:System.Activities.Argument>, the runtime creates a <xref:System.Activities.RuntimeArgument> and binds it to the user-provided argument set on that member. In some cases, however, the consumer of the activity provides some configuration that determines the set of arguments. An activity author overrides <xref:System.Activities.Activity.CacheMetadata%2A> to customize the way activity metadata is built, which includes the set of arguments associated with the activity.  \n  \n This sample demonstrates how to build an argument list dynamically for an activity that invokes a method. The activity consumer specifies the type and the method name they want to invoke along with a collection of arguments to be passed to that method.  \n  \n> [!NOTE]\n>  The purpose of this sample is to demonstrate how to override <xref:System.Activities.CodeActivity.CacheMetadata%2A> and how to use <xref:System.Activities.RuntimeArgument>. There are several caveats with respect to the kinds of methods that this activity can invoke. For example, it does not work with generics or parameter arrays. The <xref:System.Activities.Statements.InvokeMethod> activity that ships in.NET Framework handles these cases and more.  \n  \n The `MethodInvoke` activity overrides <xref:System.Activities.CodeActivity.CacheMetadata%2A> and begins by creating a <xref:System.Activities.RuntimeArgument> to handle any result from the method invocation. It binds this <xref:System.Activities.RuntimeArgument> to the publicly settable <xref:System.Activities.OutArgument> named `Result`. If `MethodInvoke.Result` is `null`, the runtime automatically populates it with an <xref:System.Activities.OutArgument> configured with the default expression for its type. This behavior means an activity author never has to check whether an argument property is `null`.  \n  \n Next, the <xref:System.Activities.CodeActivity.CacheMetadata%2A> override determines the `MethodInfo` it uses for invocation from the user-provided `MethodName` and `TargetType`. The `DetermineMethodInfo` method takes the <xref:System.Activities.CodeActivityMetadata> parameter passed to the <xref:System.Activities.CodeActivity.CacheMetadata%2A> override so that any configuration errors can be reported as validation errors. This is done by calling `metadata.AddValidationError`.  \n  \n Once the `MethodInfo` has been set, the sample iterates over the `MethodInfo` parameters. For each parameter, it creates a <xref:System.Activities.RuntimeArgument> and binds it to the corresponding argument in the user-provided collection from the `Parameters` property. Finally, the collection of <xref:System.Activities.RuntimeArgument>s is associated with the activity by calling `metadata.SetArgumentsCollection`.  \n  \n Note that argument resolution can be done using a <xref:System.Activities.RuntimeArgument>, as in the case of `resultArgument` or the user-provided argument, as in the case of the `Parameters` collection.  \n  \n#### To use this sample  \n  \n1.  Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the DynamicArguments.sln file.  \n  \n2.  To build the solution, press CTRL+SHIFT+B.  \n  \n3.  To run the solution, press CTRL+F5.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\CustomActivities\\Code-Bodied\\DynamicArguments`  \n  \n## See Also","nodes":[{"pos":[12,46],"content":"Dynamic Arguments | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Dynamic Arguments | Microsoft Docs","pos":[0,34]}]},{"pos":[311,328],"content":"Dynamic Arguments","linkify":"Dynamic Arguments","nodes":[{"content":"Dynamic Arguments","pos":[0,17]}]},{"content":"This sample demonstrates how to implement an activity for which the arguments are defined by the activity consumer rather than the activity author.","pos":[329,476]},{"content":"It does this by overriding the way the runtime constructs the activity’s metadata.","pos":[477,559]},{"pos":[568,582],"content":"Sample details","linkify":"Sample details","nodes":[{"content":"Sample details","pos":[0,14]}]},{"content":"Prior to execution, the runtime builds a description of an activity by examining the public members of the activity type and automatically declaring arguments, variables, child activities, and activity delegates as part of an activity’s metadata.","pos":[586,832]},{"content":"It does this to ensure correct construction of a workflow as well as to manage run-time relationships and lifetime rules.","pos":[833,954]},{"content":"Typically an activity author defines the arguments of an activity by specifying public members on the activity type that derive from <ph id=\"ph1\">&lt;xref:System.Activities.Argument&gt;</ph>.","pos":[955,1122],"source":" Typically an activity author defines the arguments of an activity by specifying public members on the activity type that derive from <xref:System.Activities.Argument>."},{"content":"For each public member that derives from <ph id=\"ph1\">&lt;xref:System.Activities.Argument&gt;</ph>, the runtime creates a <ph id=\"ph2\">&lt;xref:System.Activities.RuntimeArgument&gt;</ph> and binds it to the user-provided argument set on that member.","pos":[1123,1324],"source":" For each public member that derives from <xref:System.Activities.Argument>, the runtime creates a <xref:System.Activities.RuntimeArgument> and binds it to the user-provided argument set on that member."},{"content":"In some cases, however, the consumer of the activity provides some configuration that determines the set of arguments.","pos":[1325,1443]},{"content":"An activity author overrides <ph id=\"ph1\">&lt;xref:System.Activities.Activity.CacheMetadata%2A&gt;</ph> to customize the way activity metadata is built, which includes the set of arguments associated with the activity.","pos":[1444,1638],"source":" An activity author overrides <xref:System.Activities.Activity.CacheMetadata%2A> to customize the way activity metadata is built, which includes the set of arguments associated with the activity."},{"content":"This sample demonstrates how to build an argument list dynamically for an activity that invokes a method.","pos":[1645,1750]},{"content":"The activity consumer specifies the type and the method name they want to invoke along with a collection of arguments to be passed to that method.","pos":[1751,1897]},{"pos":[1905,2367],"content":"[!NOTE]\n The purpose of this sample is to demonstrate how to override <xref:System.Activities.CodeActivity.CacheMetadata%2A> and how to use <xref:System.Activities.RuntimeArgument>. There are several caveats with respect to the kinds of methods that this activity can invoke. For example, it does not work with generics or parameter arrays. The <xref:System.Activities.Statements.InvokeMethod> activity that ships in.NET Framework handles these cases and more.","leadings":["","> "],"nodes":[{"content":" The purpose of this sample is to demonstrate how to override <xref:System.Activities.CodeActivity.CacheMetadata%2A> and how to use <xref:System.Activities.RuntimeArgument>. There are several caveats with respect to the kinds of methods that this activity can invoke. For example, it does not work with generics or parameter arrays. The <xref:System.Activities.Statements.InvokeMethod> activity that ships in.NET Framework handles these cases and more.","pos":[8,460],"nodes":[{"content":"The purpose of this sample is to demonstrate how to override <ph id=\"ph1\">&lt;xref:System.Activities.CodeActivity.CacheMetadata%2A&gt;</ph> and how to use <ph id=\"ph2\">&lt;xref:System.Activities.RuntimeArgument&gt;</ph>.","pos":[1,173],"source":" The purpose of this sample is to demonstrate how to override <xref:System.Activities.CodeActivity.CacheMetadata%2A> and how to use <xref:System.Activities.RuntimeArgument>."},{"content":"There are several caveats with respect to the kinds of methods that this activity can invoke.","pos":[174,267]},{"content":"For example, it does not work with generics or parameter arrays.","pos":[268,332]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Activities.Statements.InvokeMethod&gt;</ph> activity that ships in.NET Framework handles these cases and more.","pos":[333,452],"source":" The <xref:System.Activities.Statements.InvokeMethod> activity that ships in.NET Framework handles these cases and more."}]}]},{"content":"The <ph id=\"ph1\">`MethodInvoke`</ph> activity overrides <ph id=\"ph2\">&lt;xref:System.Activities.CodeActivity.CacheMetadata%2A&gt;</ph> and begins by creating a <ph id=\"ph3\">&lt;xref:System.Activities.RuntimeArgument&gt;</ph> to handle any result from the method invocation.","pos":[2374,2581],"source":"The `MethodInvoke` activity overrides <xref:System.Activities.CodeActivity.CacheMetadata%2A> and begins by creating a <xref:System.Activities.RuntimeArgument> to handle any result from the method invocation."},{"content":"It binds this <ph id=\"ph1\">&lt;xref:System.Activities.RuntimeArgument&gt;</ph> to the publicly settable <ph id=\"ph2\">&lt;xref:System.Activities.OutArgument&gt;</ph> named <ph id=\"ph3\">`Result`</ph>.","pos":[2582,2714],"source":" It binds this <xref:System.Activities.RuntimeArgument> to the publicly settable <xref:System.Activities.OutArgument> named `Result`."},{"content":"If <ph id=\"ph1\">`MethodInvoke.Result`</ph> is <ph id=\"ph2\">`null`</ph>, the runtime automatically populates it with an <ph id=\"ph3\">&lt;xref:System.Activities.OutArgument&gt;</ph> configured with the default expression for its type.","pos":[2715,2887],"source":" If `MethodInvoke.Result` is `null`, the runtime automatically populates it with an <xref:System.Activities.OutArgument> configured with the default expression for its type."},{"content":"This behavior means an activity author never has to check whether an argument property is <ph id=\"ph1\">`null`</ph>.","pos":[2888,2985],"source":" This behavior means an activity author never has to check whether an argument property is `null`."},{"content":"Next, the <ph id=\"ph1\">&lt;xref:System.Activities.CodeActivity.CacheMetadata%2A&gt;</ph> override determines the <ph id=\"ph2\">`MethodInfo`</ph> it uses for invocation from the user-provided <ph id=\"ph3\">`MethodName`</ph> and <ph id=\"ph4\">`TargetType`</ph>.","pos":[2992,3170],"source":"Next, the <xref:System.Activities.CodeActivity.CacheMetadata%2A> override determines the `MethodInfo` it uses for invocation from the user-provided `MethodName` and `TargetType`."},{"content":"The <ph id=\"ph1\">`DetermineMethodInfo`</ph> method takes the <ph id=\"ph2\">&lt;xref:System.Activities.CodeActivityMetadata&gt;</ph> parameter passed to the <ph id=\"ph3\">&lt;xref:System.Activities.CodeActivity.CacheMetadata%2A&gt;</ph> override so that any configuration errors can be reported as validation errors.","pos":[3171,3418],"source":" The `DetermineMethodInfo` method takes the <xref:System.Activities.CodeActivityMetadata> parameter passed to the <xref:System.Activities.CodeActivity.CacheMetadata%2A> override so that any configuration errors can be reported as validation errors."},{"content":"This is done by calling <ph id=\"ph1\">`metadata.AddValidationError`</ph>.","pos":[3419,3473],"source":" This is done by calling `metadata.AddValidationError`."},{"content":"Once the <ph id=\"ph1\">`MethodInfo`</ph> has been set, the sample iterates over the <ph id=\"ph2\">`MethodInfo`</ph> parameters.","pos":[3480,3569],"source":"Once the `MethodInfo` has been set, the sample iterates over the `MethodInfo` parameters."},{"content":"For each parameter, it creates a <ph id=\"ph1\">&lt;xref:System.Activities.RuntimeArgument&gt;</ph> and binds it to the corresponding argument in the user-provided collection from the <ph id=\"ph2\">`Parameters`</ph> property.","pos":[3570,3750],"source":" For each parameter, it creates a <xref:System.Activities.RuntimeArgument> and binds it to the corresponding argument in the user-provided collection from the `Parameters` property."},{"content":"Finally, the collection of <ph id=\"ph1\">&lt;xref:System.Activities.RuntimeArgument&gt;</ph>s is associated with the activity by calling <ph id=\"ph2\">`metadata.SetArgumentsCollection`</ph>.","pos":[3751,3897],"source":" Finally, the collection of <xref:System.Activities.RuntimeArgument>s is associated with the activity by calling `metadata.SetArgumentsCollection`."},{"pos":[3904,4108],"content":"Note that argument resolution can be done using a <ph id=\"ph1\">&lt;xref:System.Activities.RuntimeArgument&gt;</ph>, as in the case of <ph id=\"ph2\">`resultArgument`</ph> or the user-provided argument, as in the case of the <ph id=\"ph3\">`Parameters`</ph> collection.","source":"Note that argument resolution can be done using a <xref:System.Activities.RuntimeArgument>, as in the case of `resultArgument` or the user-provided argument, as in the case of the `Parameters` collection."},{"pos":[4119,4137],"content":"To use this sample","linkify":"To use this sample","nodes":[{"content":"To use this sample","pos":[0,18]}]},{"pos":[4147,4243],"content":"Using <ph id=\"ph1\">[!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]</ph>, open the DynamicArguments.sln file.","source":"Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the DynamicArguments.sln file."},{"content":"To build the solution, press CTRL+SHIFT+B.","pos":[4253,4295]},{"content":"To run the solution, press CTRL+F5.","pos":[4305,4340]},{"pos":[4348,4480],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[4534,4860],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[4861,4911]},{"pos":[5018,5026],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]}]}