{"content":"---\ntitle: \"GetVersionFromProcess Function\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"GetVersionFromProcess\"\napi_location: \n  - \"mscoree.dll\"\n  - \"mscoreei.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"GetVersionFromProcess\"\nhelpviewer_keywords: \n  - \"GetVersionFromProcess function [.NET Framework hosting]\"\nms.assetid: a9f7f824-64a1-408d-8607-91c7f19d21fe\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# GetVersionFromProcess Function\nGets the version number of the common language runtime (CLR) that is associated with the specified process handle.  \n  \n This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)].  \n  \n## Syntax  \n  \n```  \nHRESULT GetVersionFromProcess (  \n    [in]  HANDLE  hProcess,   \n    [out] LPWSTR  pVersion,   \n    [in]  DWORD   cchBuffer,   \n    [out] DWORD  *dwLength  \n);  \n```  \n  \n## Parameters  \n `hProcess`  \n [in] A handle to a process.  \n  \n `pVersion`  \n [out] A buffer that contains the version number string upon successful completion of the method.  \n  \n `cchBuffer`  \n [in] The length of the version buffer.  \n  \n `pdwLength`  \n [out] A pointer to the length of the version number string.  \n  \n## Return Value  \n This method returns standard Component Object Model (COM) error codes, as defined in WinError.h, in addition to the following values.  \n  \n|Return code|Description|  \n|-----------------|-----------------|  \n|S_OK|The method completed successfully.|  \n|E_INVALIDARG|`pVersion` is null and `cchBuffer` is not null, or vice versa.<br /><br /> -or-<br /><br /> `hProcess` is not a valid handle to a process.<br /><br /> -or-<br /><br /> The CLR is not loaded.|  \n|ERROR_INSUFFICIENT_BUFFER|`cchBuffer` is null or less than the length of the version string.|  \n|E_NOTIMPL|This method is not available on the Microsoft Windows 95, Microsoft Windows 98, or Microsoft Windows Millennium Edition operating system.|  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See also\n\n- [GetRequestedRuntimeInfo Function](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md)\n- [GetRequestedRuntimeVersion Function](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md)\n- [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)\n","nodes":[{"pos":[4,424],"embed":true,"restype":"x-metadata","content":"title: \"GetVersionFromProcess Function\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"GetVersionFromProcess\"\napi_location: \n  - \"mscoree.dll\"\n  - \"mscoreei.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"GetVersionFromProcess\"\nhelpviewer_keywords: \n  - \"GetVersionFromProcess function [.NET Framework hosting]\"\nms.assetid: a9f7f824-64a1-408d-8607-91c7f19d21fe\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"GetVersionFromProcess Function","nodes":[{"pos":[0,30],"content":"GetVersionFromProcess Function","nodes":[{"content":"GetVersionFromProcess Function","pos":[0,30]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[431,461],"content":"GetVersionFromProcess Function","linkify":"GetVersionFromProcess Function","nodes":[{"content":"GetVersionFromProcess Function","pos":[0,30]}]},{"content":"Gets the version number of the common language runtime (CLR) that is associated with the specified process handle.","pos":[462,576]},{"pos":[583,690],"content":"This function has been deprecated in the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph>.","source":"This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]."},{"pos":[699,705],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[891,901],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A handle to a process.","pos":[919,946]},{"content":"[out] A buffer that contains the version number string upon successful completion of the method.","pos":[967,1063]},{"content":"[in] The length of the version buffer.","pos":[1085,1123]},{"content":"[out] A pointer to the length of the version number string.","pos":[1145,1204]},{"pos":[1213,1225],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns standard Component Object Model (COM) error codes, as defined in WinError.h, in addition to the following values.","pos":[1229,1362]},{"content":"Return code","pos":[1369,1380]},{"content":"Description","pos":[1381,1392]},{"content":"S_OK","pos":[1437,1441]},{"content":"The method completed successfully.","pos":[1442,1476]},{"content":"E_INVALIDARG","pos":[1481,1493]},{"content":"<ph id=\"ph1\">`pVersion`</ph> is null and <ph id=\"ph2\">`cchBuffer`</ph> is not null, or vice versa.","pos":[1494,1556],"source":"`pVersion` is null and `cchBuffer` is not null, or vice versa."},{"content":"-or-","pos":[1569,1573]},{"content":"<ph id=\"ph1\">`hProcess`</ph> is not a valid handle to a process.","pos":[1586,1632],"source":"`hProcess` is not a valid handle to a process."},{"content":"-or-","pos":[1645,1649]},{"content":"The CLR is not loaded.","pos":[1662,1684]},{"content":"ERROR_INSUFFICIENT_BUFFER","pos":[1689,1714]},{"pos":[1715,1781],"content":"<ph id=\"ph1\">`cchBuffer`</ph> is null or less than the length of the version string.","source":"`cchBuffer` is null or less than the length of the version string."},{"content":"E_NOTIMPL","pos":[1786,1795]},{"content":"This method is not available on the Microsoft Windows 95, Microsoft Windows 98, or Microsoft Windows Millennium Edition operating system.","pos":[1796,1933]},{"pos":[1943,1955],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[1959,2063],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2070,2091],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2098,2122],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> MSCorEE.dll","source":"**Library:** MSCorEE.dll"},{"pos":[2129,2237],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[2246,2254],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2258,2378],"content":"<bpt id=\"p1\">[</bpt>GetRequestedRuntimeInfo Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md)</ept>","source":"[GetRequestedRuntimeInfo Function](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md)"},{"pos":[2381,2507],"content":"<bpt id=\"p1\">[</bpt>GetRequestedRuntimeVersion Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md)</ept>","source":"[GetRequestedRuntimeVersion Function](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md)"},{"pos":[2510,2630],"content":"<bpt id=\"p1\">[</bpt>Deprecated CLR Hosting Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)</ept>","source":"[Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)"}]}