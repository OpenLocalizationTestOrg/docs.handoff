{"content":"---\ntitle: \"How to: Retrieve Data from the Clipboard\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"pasting Clipboard data\"\n  - \"Clipboard [Windows Forms], retrieving data\"\nms.assetid: 99612537-2c8a-449f-aab5-2b3b28d656e7\n---\n# How to: Retrieve Data from the Clipboard\nThe <xref:System.Windows.Forms.Clipboard> class provides methods that you can use to interact with the Windows operating system Clipboard feature. Many applications use the Clipboard as a temporary repository for data. For example, word processors use the Clipboard during cut-and-paste operations. The Clipboard is also useful for transferring information from one application to another.  \n  \n Some applications store data on the Clipboard in multiple formats to increase the number of other applications that can potentially use the data. A Clipboard format is a string that identifies the format. An application that uses the identified format can retrieve the associated data on the Clipboard. The <xref:System.Windows.Forms.DataFormats> class provides predefined format names for your use. You can also use your own format names or use an object's type as its format. For information about adding data to the Clipboard, see [How to: Add Data to the Clipboard](how-to-add-data-to-the-clipboard.md).  \n  \n To determine whether the Clipboard contains data in a particular format, use one of the `Contains`*Format* methods or the <xref:System.Windows.Forms.Clipboard.GetData%2A> method. To retrieve data from the Clipboard, use one of the `Get`*Format* methods or the <xref:System.Windows.Forms.Clipboard.GetData%2A> method. These methods are new in [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)].  \n  \n To access data from the Clipboard by using versions earlier than [!INCLUDE[dnprdnlong](../../../../includes/dnprdnlong-md.md)], use the <xref:System.Windows.Forms.Clipboard.GetDataObject%2A> method and call the methods of the returned <xref:System.Windows.Forms.IDataObject>. To determine whether a particular format is available in the returned object, for example, call the <xref:System.Windows.Forms.IDataObject.GetDataPresent%2A> method.  \n  \n> [!NOTE]\n>  All Windows-based applications share the system Clipboard. Therefore, the contents are subject to change when you switch to another application.  \n>   \n>  The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode. To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.  \n  \n### To retrieve data from the Clipboard in a single, common format  \n  \n1.  Use the <xref:System.Windows.Forms.Clipboard.GetAudioStream%2A>, <xref:System.Windows.Forms.Clipboard.GetFileDropList%2A>, <xref:System.Windows.Forms.Clipboard.GetImage%2A>, or <xref:System.Windows.Forms.Clipboard.GetText%2A> method. Optionally, use the corresponding `Contains`*Format* methods first to determine whether data is available in a particular format. These methods are available only in [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)].  \n  \n     [!code-csharp[System.Windows.Forms.Clipboard#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#2)]\n     [!code-vb[System.Windows.Forms.Clipboard#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#2)]  \n  \n### To retrieve data from the Clipboard in a custom format  \n  \n1.  Use the <xref:System.Windows.Forms.Clipboard.GetData%2A> method with a custom format name. This method is available only in [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)].  \n  \n     You can also use predefined format names with the <xref:System.Windows.Forms.Clipboard.SetData%2A> method. For more information, see <xref:System.Windows.Forms.DataFormats>.  \n  \n     [!code-csharp[System.Windows.Forms.Clipboard#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#3)]\n     [!code-vb[System.Windows.Forms.Clipboard#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#3)]  \n    [!code-csharp[System.Windows.Forms.Clipboard#100](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#100)]\n    [!code-vb[System.Windows.Forms.Clipboard#100](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#100)]  \n  \n### To retrieve data from the Clipboard in multiple formats  \n  \n1.  Use the <xref:System.Windows.Forms.Clipboard.GetDataObject%2A> method. You must use this method to retrieve data from the Clipboard on versions earlier than [!INCLUDE[dnprdnlong](../../../../includes/dnprdnlong-md.md)].  \n  \n     [!code-csharp[System.Windows.Forms.Clipboard#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#4)]\n     [!code-vb[System.Windows.Forms.Clipboard#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#4)]  \n    [!code-csharp[System.Windows.Forms.Clipboard#100](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#100)]\n    [!code-vb[System.Windows.Forms.Clipboard#100](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#100)]  \n  \n## See also\n\n- [Drag-and-Drop Operations and Clipboard Support](drag-and-drop-operations-and-clipboard-support.md)\n- [How to: Add Data to the Clipboard](how-to-add-data-to-the-clipboard.md)\n","nodes":[{"pos":[4,258],"embed":true,"restype":"x-metadata","content":"title: \"How to: Retrieve Data from the Clipboard\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"pasting Clipboard data\"\n  - \"Clipboard [Windows Forms], retrieving data\"\nms.assetid: 99612537-2c8a-449f-aab5-2b3b28d656e7","nodes":[{"content":"How to: Retrieve Data from the Clipboard","nodes":[{"pos":[0,40],"content":"How to: Retrieve Data from the Clipboard","nodes":[{"content":"How to: Retrieve Data from the Clipboard","pos":[0,40]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[265,305],"content":"How to: Retrieve Data from the Clipboard","linkify":"How to: Retrieve Data from the Clipboard","nodes":[{"content":"How to: Retrieve Data from the Clipboard","pos":[0,40]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Clipboard&gt;</ph> class provides methods that you can use to interact with the Windows operating system Clipboard feature.","pos":[306,452],"source":"The <xref:System.Windows.Forms.Clipboard> class provides methods that you can use to interact with the Windows operating system Clipboard feature."},{"content":"Many applications use the Clipboard as a temporary repository for data.","pos":[453,524]},{"content":"For example, word processors use the Clipboard during cut-and-paste operations.","pos":[525,604]},{"content":"The Clipboard is also useful for transferring information from one application to another.","pos":[605,695]},{"content":"Some applications store data on the Clipboard in multiple formats to increase the number of other applications that can potentially use the data.","pos":[702,847]},{"content":"A Clipboard format is a string that identifies the format.","pos":[848,906]},{"content":"An application that uses the identified format can retrieve the associated data on the Clipboard.","pos":[907,1004]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataFormats&gt;</ph> class provides predefined format names for your use.","pos":[1005,1101],"source":" The <xref:System.Windows.Forms.DataFormats> class provides predefined format names for your use."},{"content":"You can also use your own format names or use an object's type as its format.","pos":[1102,1179]},{"content":"For information about adding data to the Clipboard, see <bpt id=\"p1\">[</bpt>How to: Add Data to the Clipboard<ept id=\"p1\">](how-to-add-data-to-the-clipboard.md)</ept>.","pos":[1180,1309],"source":" For information about adding data to the Clipboard, see [How to: Add Data to the Clipboard](how-to-add-data-to-the-clipboard.md)."},{"content":"To determine whether the Clipboard contains data in a particular format, use one of the <ph id=\"ph1\">`Contains`</ph><bpt id=\"p1\">*</bpt>Format<ept id=\"p1\">*</ept> methods or the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Clipboard.GetData%2A&gt;</ph> method.","pos":[1316,1494],"source":"To determine whether the Clipboard contains data in a particular format, use one of the `Contains`*Format* methods or the <xref:System.Windows.Forms.Clipboard.GetData%2A> method."},{"content":"To retrieve data from the Clipboard, use one of the <ph id=\"ph1\">`Get`</ph><bpt id=\"p1\">*</bpt>Format<ept id=\"p1\">*</ept> methods or the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Clipboard.GetData%2A&gt;</ph> method.","pos":[1495,1632],"source":" To retrieve data from the Clipboard, use one of the `Get`*Format* methods or the <xref:System.Windows.Forms.Clipboard.GetData%2A> method."},{"content":"These methods are new in <ph id=\"ph1\">[!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)]</ph>.","pos":[1633,1718],"source":" These methods are new in [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)]."},{"content":"To access data from the Clipboard by using versions earlier than <ph id=\"ph1\">[!INCLUDE[dnprdnlong](../../../../includes/dnprdnlong-md.md)]</ph>, use the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Clipboard.GetDataObject%2A&gt;</ph> method and call the methods of the returned <ph id=\"ph3\">&lt;xref:System.Windows.Forms.IDataObject&gt;</ph>.","pos":[1725,2000],"source":"To access data from the Clipboard by using versions earlier than [!INCLUDE[dnprdnlong](../../../../includes/dnprdnlong-md.md)], use the <xref:System.Windows.Forms.Clipboard.GetDataObject%2A> method and call the methods of the returned <xref:System.Windows.Forms.IDataObject>."},{"content":"To determine whether a particular format is available in the returned object, for example, call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.IDataObject.GetDataPresent%2A&gt;</ph> method.","pos":[2001,2166],"source":" To determine whether a particular format is available in the returned object, for example, call the <xref:System.Windows.Forms.IDataObject.GetDataPresent%2A> method."},{"pos":[2174,2329],"content":"[!NOTE]\n All Windows-based applications share the system Clipboard. Therefore, the contents are subject to change when you switch to another application.","leadings":["","> "],"nodes":[{"content":"All Windows-based applications share the system Clipboard. Therefore, the contents are subject to change when you switch to another application.","pos":[9,153],"nodes":[{"content":"All Windows-based applications share the system Clipboard.","pos":[0,58]},{"content":"Therefore, the contents are subject to change when you switch to another application.","pos":[59,144]}]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Clipboard&gt;</ph> class can only be used in threads set to single thread apartment (STA) mode.","pos":[2340,2458],"source":"The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode."},{"content":"To use this class, ensure that your <ph id=\"ph1\">`Main`</ph> method is marked with the <ph id=\"ph2\">&lt;xref:System.STAThreadAttribute&gt;</ph> attribute.","pos":[2459,2571],"source":" To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute."},{"pos":[2581,2643],"content":"To retrieve data from the Clipboard in a single, common format","linkify":"To retrieve data from the Clipboard in a single, common format","nodes":[{"content":"To retrieve data from the Clipboard in a single, common format","pos":[0,62]}]},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Clipboard.GetAudioStream%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Clipboard.GetFileDropList%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Clipboard.GetImage%2A&gt;</ph>, or <ph id=\"ph4\">&lt;xref:System.Windows.Forms.Clipboard.GetText%2A&gt;</ph> method.","pos":[2653,2886],"source":"Use the <xref:System.Windows.Forms.Clipboard.GetAudioStream%2A>, <xref:System.Windows.Forms.Clipboard.GetFileDropList%2A>, <xref:System.Windows.Forms.Clipboard.GetImage%2A>, or <xref:System.Windows.Forms.Clipboard.GetText%2A> method."},{"content":"Optionally, use the corresponding <ph id=\"ph1\">`Contains`</ph><bpt id=\"p1\">*</bpt>Format<ept id=\"p1\">*</ept> methods first to determine whether data is available in a particular format.","pos":[2887,3016],"source":" Optionally, use the corresponding `Contains`*Format* methods first to determine whether data is available in a particular format."},{"content":"These methods are available only in <ph id=\"ph1\">[!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)]</ph>.","pos":[3017,3113],"source":" These methods are available only in [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)]."},{"pos":[3124,3413],"content":"[!code-csharp[System.Windows.Forms.Clipboard#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#2)]\n [!code-vb[System.Windows.Forms.Clipboard#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#2)]","leadings":["","    "],"nodes":[]},{"pos":[3423,3477],"content":"To retrieve data from the Clipboard in a custom format","linkify":"To retrieve data from the Clipboard in a custom format","nodes":[{"content":"To retrieve data from the Clipboard in a custom format","pos":[0,54]}]},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Clipboard.GetData%2A&gt;</ph> method with a custom format name.","pos":[3487,3577],"source":"Use the <xref:System.Windows.Forms.Clipboard.GetData%2A> method with a custom format name."},{"content":"This method is available only in <ph id=\"ph1\">[!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)]</ph>.","pos":[3578,3671],"source":" This method is available only in [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)]."},{"content":"You can also use predefined format names with the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Clipboard.SetData%2A&gt;</ph> method.","pos":[3682,3788],"source":"You can also use predefined format names with the <xref:System.Windows.Forms.Clipboard.SetData%2A> method."},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataFormats&gt;</ph>.","pos":[3789,3855],"source":" For more information, see <xref:System.Windows.Forms.DataFormats>."},{"pos":[3866,4458],"content":"[!code-csharp[System.Windows.Forms.Clipboard#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#3)]\n [!code-vb[System.Windows.Forms.Clipboard#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#3)]  \n[!code-csharp[System.Windows.Forms.Clipboard#100](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#100)]\n[!code-vb[System.Windows.Forms.Clipboard#100](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#100)]","leadings":["","    ","    ","    "],"nodes":[]},{"pos":[4468,4523],"content":"To retrieve data from the Clipboard in multiple formats","linkify":"To retrieve data from the Clipboard in multiple formats","nodes":[{"content":"To retrieve data from the Clipboard in multiple formats","pos":[0,55]}]},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Clipboard.GetDataObject%2A&gt;</ph> method.","pos":[4533,4603],"source":"Use the <xref:System.Windows.Forms.Clipboard.GetDataObject%2A> method."},{"content":"You must use this method to retrieve data from the Clipboard on versions earlier than <ph id=\"ph1\">[!INCLUDE[dnprdnlong](../../../../includes/dnprdnlong-md.md)]</ph>.","pos":[4604,4752],"source":" You must use this method to retrieve data from the Clipboard on versions earlier than [!INCLUDE[dnprdnlong](../../../../includes/dnprdnlong-md.md)]."},{"pos":[4763,5355],"content":"[!code-csharp[System.Windows.Forms.Clipboard#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#4)]\n [!code-vb[System.Windows.Forms.Clipboard#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#4)]  \n[!code-csharp[System.Windows.Forms.Clipboard#100](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#100)]\n[!code-vb[System.Windows.Forms.Clipboard#100](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#100)]","leadings":["","    ","    ","    "],"nodes":[]},{"pos":[5364,5372],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5376,5475],"content":"<bpt id=\"p1\">[</bpt>Drag-and-Drop Operations and Clipboard Support<ept id=\"p1\">](drag-and-drop-operations-and-clipboard-support.md)</ept>","source":"[Drag-and-Drop Operations and Clipboard Support](drag-and-drop-operations-and-clipboard-support.md)"},{"pos":[5478,5550],"content":"<bpt id=\"p1\">[</bpt>How to: Add Data to the Clipboard<ept id=\"p1\">](how-to-add-data-to-the-clipboard.md)</ept>","source":"[How to: Add Data to the Clipboard](how-to-add-data-to-the-clipboard.md)"}]}