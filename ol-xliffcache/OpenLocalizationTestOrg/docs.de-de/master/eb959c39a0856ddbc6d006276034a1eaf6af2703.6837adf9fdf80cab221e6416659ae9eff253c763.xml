{"content":"---\ntitle: \"How to: Save Files with the Windows Forms RichTextBox Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"saving files\"\n  - \"RTF files, saving in RichTextBox control\"\n  - \"examples [Windows Forms], text boxes\"\n  - \"saving files, RichTextBox control\"\n  - \"files, saving with RichTextBox control\"\n  - \"RichTextBox control [Windows Forms], saving files\"\n  - \".rtf files, saving in RichTextBox control\"\n  - \"text files, saving from RichTextBox control\"\nms.assetid: 4a58ec19-84d1-4383-9110-298c06adcfca\ncaps.latest.revision: 15\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Save Files with the Windows Forms RichTextBox Control\nThe Windows Forms <xref:System.Windows.Forms.RichTextBox> control can write the information it displays in one of several formats:  \n  \n-   Plain text  \n  \n-   Unicode plain text  \n  \n-   Rich-Text Format (RTF)  \n  \n-   RTF with spaces in place of OLE objects  \n  \n-   Plain text with a textual representation of OLE objects  \n  \n To save a file, call the <xref:System.Windows.Forms.RichTextBox.SaveFile%2A> method. You can also use the **SaveFile** method to save data to a stream. For more information, see <xref:System.Windows.Forms.RichTextBox.SaveFile%28System.IO.Stream%2CSystem.Windows.Forms.RichTextBoxStreamType%29>.  \n  \n### To save the contents of the control to a file  \n  \n1.  Determine the path of the file to be saved.  \n  \n     To do this in a real-world application, you would typically use the <xref:System.Windows.Forms.SaveFileDialog> component. For an overview, see [SaveFileDialog Component Overview](../../../../docs/framework/winforms/controls/savefiledialog-component-overview-windows-forms.md).  \n  \n2.  Call the <xref:System.Windows.Forms.RichTextBox.SaveFile%2A> method of the <xref:System.Windows.Forms.RichTextBox> control, specifying the file to save and optionally a file type. If you call the method with a file name as its only argument, the file will be saved as RTF. To specify another file type, call the method with a value of the <xref:System.Windows.Forms.RichTextBoxStreamType> enumeration as its second argument.  \n  \n     In the example below, the path set for the location of the rich-text file is the **My Documents** folder. This location is used because you can assume that most computers running the Windows operating system will include this folder. Choosing this location also allows users with minimal system access levels to safely run the application. The example below assumes a form with a <xref:System.Windows.Forms.RichTextBox> control already added.  \n  \n    ```vb  \n    Public Sub SaveFile()  \n       ' You should replace the bold file name in the   \n       ' sample below with a file name of your own choosing.  \n       RichTextBox1.SaveFile(System.Environment.GetFolderPath _  \n       (System.Environment.SpecialFolder.Personal) _  \n       & \"\\Testdoc.rtf\", _  \n          RichTextBoxStreamType.RichNoOleObjs)  \n    End Sub  \n  \n    ```  \n  \n    ```csharp  \n    public void SaveFile()  \n    {  \n       // You should replace the bold file name in the   \n       // sample below with a file name of your own choosing.  \n       // Note the escape character used (@) when specifying the path.  \n       richTextBox1.SaveFile(System.Environment.GetFolderPath  \n       (System.Environment.SpecialFolder.Personal)  \n       + @\"\\Testdoc.rtf\",  \n          RichTextBoxStreamType.RichNoOleObjs);  \n    }  \n  \n    ```  \n  \n    ```cpp  \n    public:  \n       void SaveFile()  \n       {  \n          // You should replace the bold file name in the   \n          // sample below with a file name of your own choosing.  \n          richTextBox1->SaveFile(String::Concat  \n             (System::Environment::GetFolderPath  \n             (System::Environment::SpecialFolder::Personal),  \n             \"\\\\Testdoc.rtf\"), RichTextBoxStreamType::RichNoOleObjs);  \n       }  \n    ```  \n  \n    > [!IMPORTANT]\n    >  This example creates a new file, if the file does not already exist. If an application needs to create a file, that application needs Create access for the folder. Permissions are set using access control lists. If the file already exists, the application needs only Write access, a lesser privilege. Where possible, it is more secure to create the file during deployment, and only grant Read access to a single file, rather than Create access for a folder. Also, it is more secure to write data to user folders than to the root folder or the Program Files folder.  \n  \n## See Also  \n <xref:System.Windows.Forms.RichTextBox.SaveFile%2A?displayProperty=fullName>   \n <xref:System.Windows.Forms.RichTextBox>   \n [RichTextBox Control](../../../../docs/framework/winforms/controls/richtextbox-control-windows-forms.md)   \n [Controls to Use on Windows Forms](../../../../docs/framework/winforms/controls/controls-to-use-on-windows-forms.md)","nodes":[{"pos":[12,90],"content":"How to: Save Files with the Windows Forms RichTextBox Control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Save Files with the Windows Forms RichTextBox Control | Microsoft Docs","pos":[0,78]}]},{"pos":[798,859],"content":"How to: Save Files with the Windows Forms RichTextBox Control","linkify":"How to: Save Files with the Windows Forms RichTextBox Control","nodes":[{"content":"How to: Save Files with the Windows Forms RichTextBox Control","pos":[0,61]}]},{"content":"The Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control can write the information it displays in one of several formats:","pos":[860,990],"source":"The Windows Forms <xref:System.Windows.Forms.RichTextBox> control can write the information it displays in one of several formats:"},{"content":"Plain text","pos":[1000,1010]},{"content":"Unicode plain text","pos":[1020,1038]},{"content":"Rich-Text Format (RTF)","pos":[1048,1070]},{"content":"RTF with spaces in place of OLE objects","pos":[1080,1119]},{"content":"Plain text with a textual representation of OLE objects","pos":[1129,1184]},{"content":"To save a file, call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.SaveFile%2A&gt;</ph> method.","pos":[1191,1275],"source":"To save a file, call the <xref:System.Windows.Forms.RichTextBox.SaveFile%2A> method."},{"content":"You can also use the <bpt id=\"p1\">**</bpt>SaveFile<ept id=\"p1\">**</ept> method to save data to a stream.","pos":[1276,1342],"source":" You can also use the **SaveFile** method to save data to a stream."},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.SaveFile%28System.IO.Stream%2CSystem.Windows.Forms.RichTextBoxStreamType%29&gt;</ph>.","pos":[1343,1485],"source":" For more information, see <xref:System.Windows.Forms.RichTextBox.SaveFile%28System.IO.Stream%2CSystem.Windows.Forms.RichTextBoxStreamType%29>."},{"pos":[1495,1540],"content":"To save the contents of the control to a file","linkify":"To save the contents of the control to a file","nodes":[{"content":"To save the contents of the control to a file","pos":[0,45]}]},{"content":"Determine the path of the file to be saved.","pos":[1550,1593]},{"content":"To do this in a real-world application, you would typically use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SaveFileDialog&gt;</ph> component.","pos":[1604,1725],"source":"To do this in a real-world application, you would typically use the <xref:System.Windows.Forms.SaveFileDialog> component."},{"content":"For an overview, see <bpt id=\"p1\">[</bpt>SaveFileDialog Component Overview<ept id=\"p1\">](../../../../docs/framework/winforms/controls/savefiledialog-component-overview-windows-forms.md)</ept>.","pos":[1726,1880],"source":" For an overview, see [SaveFileDialog Component Overview](../../../../docs/framework/winforms/controls/savefiledialog-component-overview-windows-forms.md)."},{"content":"Call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.SaveFile%2A&gt;</ph> method of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control, specifying the file to save and optionally a file type.","pos":[1890,2069],"source":"Call the <xref:System.Windows.Forms.RichTextBox.SaveFile%2A> method of the <xref:System.Windows.Forms.RichTextBox> control, specifying the file to save and optionally a file type."},{"content":"If you call the method with a file name as its only argument, the file will be saved as RTF.","pos":[2070,2162]},{"content":"To specify another file type, call the method with a value of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBoxStreamType&gt;</ph> enumeration as its second argument.","pos":[2163,2314],"source":" To specify another file type, call the method with a value of the <xref:System.Windows.Forms.RichTextBoxStreamType> enumeration as its second argument."},{"content":"In the example below, the path set for the location of the rich-text file is the <bpt id=\"p1\">**</bpt>My Documents<ept id=\"p1\">**</ept> folder.","pos":[2325,2430],"source":"In the example below, the path set for the location of the rich-text file is the **My Documents** folder."},{"content":"This location is used because you can assume that most computers running the Windows operating system will include this folder.","pos":[2431,2558]},{"content":"Choosing this location also allows users with minimal system access levels to safely run the application.","pos":[2559,2664]},{"content":"The example below assumes a form with a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control already added.","pos":[2665,2767],"source":" The example below assumes a form with a <xref:System.Windows.Forms.RichTextBox> control already added."},{"pos":[4086,4670],"content":"[!IMPORTANT]\nThis example creates a new file, if the file does not already exist. If an application needs to create a file, that application needs Create access for the folder. Permissions are set using access control lists. If the file already exists, the application needs only Write access, a lesser privilege. Where possible, it is more secure to create the file during deployment, and only grant Read access to a single file, rather than Create access for a folder. Also, it is more secure to write data to user folders than to the root folder or the Program Files folder.","leadings":["","    >  "],"nodes":[{"content":"This example creates a new file, if the file does not already exist. If an application needs to create a file, that application needs Create access for the folder. Permissions are set using access control lists. If the file already exists, the application needs only Write access, a lesser privilege. Where possible, it is more secure to create the file during deployment, and only grant Read access to a single file, rather than Create access for a folder. Also, it is more secure to write data to user folders than to the root folder or the Program Files folder.","pos":[13,577],"nodes":[{"content":"This example creates a new file, if the file does not already exist.","pos":[0,68]},{"content":"If an application needs to create a file, that application needs Create access for the folder.","pos":[69,163]},{"content":"Permissions are set using access control lists.","pos":[164,211]},{"content":"If the file already exists, the application needs only Write access, a lesser privilege.","pos":[212,300]},{"content":"Where possible, it is more secure to create the file during deployment, and only grant Read access to a single file, rather than Create access for a folder.","pos":[301,457]},{"content":"Also, it is more secure to write data to user folders than to the root folder or the Program Files folder.","pos":[458,564]}]}]},{"pos":[4679,4687],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>RichTextBox Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/richtextbox-control-windows-forms.md)</ept><ph id=\"ph1\"> </ph>","pos":[4815,4921],"source":" [RichTextBox Control](../../../../docs/framework/winforms/controls/richtextbox-control-windows-forms.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Controls to Use on Windows Forms<ept id=\"p1\">](../../../../docs/framework/winforms/controls/controls-to-use-on-windows-forms.md)</ept>","pos":[4924,5041],"source":" [Controls to Use on Windows Forms](../../../../docs/framework/winforms/controls/controls-to-use-on-windows-forms.md)"}]}