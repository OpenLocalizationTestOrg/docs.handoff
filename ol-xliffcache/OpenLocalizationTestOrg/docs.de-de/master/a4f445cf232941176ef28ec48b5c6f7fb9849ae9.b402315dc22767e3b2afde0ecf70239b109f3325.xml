{"content":"---\ntitle: \"ICLRStrongName::StrongNameTokenFromAssemblyEx Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICLRStrongName.StrongNameTokenFromAssemblyEx\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRStrongName::StrongNameTokenFromAssemblyEx\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"StrongNameTokenFromAssemblyEx method, ICLRStrongName interface [.NET Framework hosting]\"\n  - \"ICLRStrongName::StrongNameTokenFromAssemblyEx method [.NET Framework hosting]\"\nms.assetid: 648ea90e-5e60-40a0-a56a-3e61bf2fba7c\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 8\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# ICLRStrongName::StrongNameTokenFromAssemblyEx Method\nCreates a strong name token from the specified assembly file, and returns the public key that the token represents.  \n  \n## Syntax  \n  \n```  \nHRESULT StrongNameTokenFromAssemblyEx (  \n    [in]  LPCWSTR   wszFilePath,  \n    [out] BYTE      **ppbStrongNameToken,  \n    [out] ULONG     *pcbStrongNameToken,  \n    [out] BYTE      **ppbPublicKeyBlob,  \n    [out] ULONG     *pcbPublicKeyBlob  \n);  \n```  \n  \n#### Parameters  \n `wszFilePath`  \n [in] The path to the portable executable (PE) file for the assembly.  \n  \n `ppbStrongNameToken`  \n [out] The returned strong name token.  \n  \n `pcbStrongNameToken`  \n [out] The size, in bytes, of the strong name token.  \n  \n `ppbPublicKeyBlob`  \n [out] The returned public key.  \n  \n `pcbPublicKeyBlob`  \n [out] The size, in bytes, of the public key.  \n  \n## Return Value  \n `S_OK` if the method completed successfully; otherwise, an HRESULT value that indicates failure (see [Common HRESULT Values](http://go.microsoft.com/fwlink/?LinkId=213878) for a list).  \n  \n## Remarks  \n A strong name token is the shortened form of a public key. The token is a 64-bit hash that is created from the public key used to sign the assembly. The token is a part of the strong name for the assembly, and can be read from the assembly metadata.  \n  \n After the key is retrieved and the token is created, you should call the [ICLRStrongName::StrongNameFreeBuffer](../../../../docs/framework/unmanaged-api/hosting/iclrstrongname-strongnamefreebuffer-method.md) method to release the allocated memory.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MetaHost.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See Also  \n [StrongNameTokenFromAssembly Method](../../../../docs/framework/unmanaged-api/hosting/iclrstrongname-strongnametokenfromassembly-method.md)   \n [ICLRStrongName Interface](../../../../docs/framework/unmanaged-api/hosting/iclrstrongname-interface.md)","nodes":[{"pos":[12,81],"content":"ICLRStrongName::StrongNameTokenFromAssemblyEx Method | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ICLRStrongName::StrongNameTokenFromAssemblyEx Method | Microsoft Docs","pos":[0,69]}]},{"pos":[816,868],"content":"ICLRStrongName::StrongNameTokenFromAssemblyEx Method","linkify":"ICLRStrongName::StrongNameTokenFromAssemblyEx Method","nodes":[{"content":"ICLRStrongName::StrongNameTokenFromAssemblyEx Method","pos":[0,52]}]},{"content":"Creates a strong name token from the specified assembly file, and returns the public key that the token represents.","pos":[869,984]},{"pos":[993,999],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1276,1286],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The path to the portable executable (PE) file for the assembly.","pos":[1307,1375]},{"content":"[out] The returned strong name token.","pos":[1406,1443]},{"content":"[out] The size, in bytes, of the strong name token.","pos":[1474,1525]},{"content":"[out] The returned public key.","pos":[1554,1584]},{"content":"[out] The size, in bytes, of the public key.","pos":[1613,1657]},{"pos":[1666,1678],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[1682,1866],"content":"<ph id=\"ph1\">`S_OK`</ph> if the method completed successfully; otherwise, an HRESULT value that indicates failure (see <bpt id=\"p1\">[</bpt>Common HRESULT Values<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=213878)</ept> for a list).","source":"`S_OK` if the method completed successfully; otherwise, an HRESULT value that indicates failure (see [Common HRESULT Values](http://go.microsoft.com/fwlink/?LinkId=213878) for a list)."},{"pos":[1875,1882],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"A strong name token is the shortened form of a public key.","pos":[1886,1944]},{"content":"The token is a 64-bit hash that is created from the public key used to sign the assembly.","pos":[1945,2034]},{"content":"The token is a part of the strong name for the assembly, and can be read from the assembly metadata.","pos":[2035,2135]},{"pos":[2142,2389],"content":"After the key is retrieved and the token is created, you should call the <bpt id=\"p1\">[</bpt>ICLRStrongName::StrongNameFreeBuffer<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrstrongname-strongnamefreebuffer-method.md)</ept> method to release the allocated memory.","source":"After the key is retrieved and the token is created, you should call the [ICLRStrongName::StrongNameFreeBuffer](../../../../docs/framework/unmanaged-api/hosting/iclrstrongname-strongnamefreebuffer-method.md) method to release the allocated memory."},{"pos":[2398,2410],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2414,2518],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2525,2547],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MetaHost.h","source":"**Header:** MetaHost.h"},{"pos":[2554,2604],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[2611,2719],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[2728,2736],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>StrongNameTokenFromAssembly Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrstrongname-strongnametokenfromassembly-method.md)</ept><ph id=\"ph1\"> </ph>","pos":[2740,2880],"source":"[StrongNameTokenFromAssembly Method](../../../../docs/framework/unmanaged-api/hosting/iclrstrongname-strongnametokenfromassembly-method.md) "},{"content":"<bpt id=\"p1\"> [</bpt>ICLRStrongName Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrstrongname-interface.md)</ept>","pos":[2883,2988],"source":" [ICLRStrongName Interface](../../../../docs/framework/unmanaged-api/hosting/iclrstrongname-interface.md)"}]}