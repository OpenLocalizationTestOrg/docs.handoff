{"content":"---\ntitle: \"How to: Configure a Custom WS-Metadata Exchange Binding | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"WS-Metadata Exchange [WCF]\"\n  - \"WS-Metadata Exchange [WCF], configuring a custom binding\"\nms.assetid: cdba4d73-da64-4805-bc56-9822becfd1e4\ncaps.latest.revision: 7\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Configure a Custom WS-Metadata Exchange Binding\nThis topic will explain how to configure a custom WS-Metadata exchange binding. [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] includes four system-defined metadata bindings, but you can publish metadata using any binding you want. This topic will show you how to publish metadata using the `wsHttpBinding`. This binding gives you the option of exposing metadata in a secure way. The code in this article is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md).  \n  \n### Using a configuration file  \n  \n1.  In the service's configuration file, add a service behavior that contains the `serviceMetadata` tag:  \n  \n    ```  \n    <behaviors>  \n       <serviceBehaviors>  \n         <behavior name=\"CalculatorServiceBehavior\">  \n           <serviceMetadata httpGetEnabled=\"True\"/>  \n         </behavior>  \n       </serviceBehaviors>  \n    </behaviors>  \n    ```  \n  \n2.  Add a `behaviorConfiguration` attribute to the service tag that references this new behavior:  \n  \n    ```  \n    <service        name=\"Microsoft.ServiceModel.Samples.CalculatorService\"  \n    behaviorConfiguration=\"CalculatorServiceBehavior\">   \n    ```  \n  \n3.  Add a metadata endpoint specifying mex as the address, `wsHttpBinding` as the binding, and <xref:System.ServiceModel.Description.IMetadataExchange> as the contract:  \n  \n    ```  \n    <endpoint address=\"mex\"  \n              binding=\"wsHttpBinding\"  \n              contract=\"IMetadataExchange\" />  \n    ```  \n  \n4.  To verify the metadata exchange endpoint is working correctly add an endpoint tag in the client configuration file:  \n  \n    ```  \n    <endpoint name=\"MyMexEndpoint\"               address=\"http://localhost:8000/servicemodelsamples/service/mex\"  \n              binding=\"wsHttpBinding\"  \n              contract=\"IMetadataExchange\"/>  \n    ```  \n  \n5.  In the client's Main() method, create a new <xref:System.ServiceModel.Description.MetadataExchangeClient> instance, set its <xref:System.ServiceModel.Description.MetadataExchangeClient.ResolveMetadataReferences%2A> property to `true`, call <xref:System.ServiceModel.Description.MetadataExchangeClient.GetMetadata%2A> and then iterate through the collection of metadata returned:  \n  \n    ```  \n    string mexAddress = \"http://localhost:8000/servicemodelsamples/service/mex\";  \n  \n    MetadataExchangeClient mexClient = new MetadataExchangeClient(\"MyMexEndpoint\");  \n    mexClient.ResolveMetadataReferences = true;  \n    MetadataSet mdSet = mexClient.GetMetadata(new EndpointAddress(mexAddress));  \n    foreach (MetadataSection section in mdSet.MetadataSections)  \n    Console.WriteLine(\"Metadata section: \" + section.Dialect.ToString());  \n    ```  \n  \n### Configuring by code  \n  \n1.  Create a <<!--zz xref:System.ServiceModel.WsHttpBinding --> `xref:System.ServiceModel.WsHttpBinding`> binding instance:  \n  \n    ```  \n    WSHttpBinding binding = new WSHttpBinding();  \n    ```  \n  \n2.  Create a <xref:System.ServiceModel.ServiceHost> instance:  \n  \n    ```  \n    ServiceHost serviceHost = new ServiceHost(typeof(CalculatorService), baseAddress);  \n    ```  \n  \n3.  Add a service endpoint and add a <xref:System.ServiceModel.Description.ServiceMetadataBehavior> instance:  \n  \n    ```  \n    serviceHost.AddServiceEndpoint(typeof(ICalculator), binding, baseAddress);  \n    ServiceMetadataBehavior smb = new ServiceMetadataBehavior();  \n    smb.HttpGetEnabled = true;  \n    serviceHost.Description.Behaviors.Add(smb);  \n    ```  \n  \n4.  Add a metadata exchange endpoint, specifying the <<!--zz xref:System.ServiceModel.WsHttpBinding --> `xref:System.ServiceModel.WsHttpBinding`> created earlier:  \n  \n    ```  \n    serviceHost.AddServiceEndpoint(typeof(IMetadataExchange), binding, mexAddress);  \n    ```  \n  \n5.  To verify that the metadata exchange endpoint is working correctly, add an endpoint tag in the client configuration file:  \n  \n    ```  \n    <endpoint name=\"MyMexEndpoint\"               address=\"http://localhost:8000/servicemodelsamples/service/mex\"  \n              binding=\"wsHttpBinding\"  \n              contract=\"IMetadataExchange\"/>  \n    ```  \n  \n6.  In the client's Main() method, create a new <xref:System.ServiceModel.Description.MetadataExchangeClient> instance, set the <xref:System.ServiceModel.Description.MetadataExchangeClient.ResolveMetadataReferences%2A> property to `true`, call <xref:System.ServiceModel.Description.MetadataExchangeClient.GetMetadata%2A> and then iterate through the collection of metadata returned:  \n  \n    ```  \n    string mexAddress = \"http://localhost:8000/servicemodelsamples/service/mex\";  \n  \n    MetadataExchangeClient mexClient = new MetadataExchangeClient(\"MyMexEndpoint\");  \n    mexClient.ResolveMetadataReferences = true;  \n    MetadataSet mdSet = mexClient.GetMetadata(new EndpointAddress(mexAddress));  \n    foreach (MetadataSection section in mdSet.MetadataSections)  \n    Console.WriteLine(\"Metadata section: \" + section.Dialect.ToString());  \n  \n    ```  \n  \n## See Also  \n [Metadata Publishing Behavior](../../../../docs/framework/wcf/samples/metadata-publishing-behavior.md)   \n [Retrieve Metadata](../../../../docs/framework/wcf/samples/retrieve-metadata.md)   \n [Metadata](../../../../docs/framework/wcf/feature-details/metadata.md)   \n [Publishing Metadata](../../../../docs/framework/wcf/feature-details/publishing-metadata.md)   \n [Publishing Metadata Endpoints](../../../../docs/framework/wcf/publishing-metadata-endpoints.md)","nodes":[{"pos":[4,493],"nodes":[{"content":"How to: Configure a Custom WS-Metadata Exchange Binding | Microsoft Docs","nodes":[{"pos":[0,72],"content":"How to: Configure a Custom WS-Metadata Exchange Binding | Microsoft Docs","nodes":[{"content":"How to: Configure a Custom WS-Metadata Exchange Binding | Microsoft Docs","pos":[0,72]}]}],"pos":[6,81],"yaml":true}],"content":"title: \"How to: Configure a Custom WS-Metadata Exchange Binding | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"WS-Metadata Exchange [WCF]\"\n  - \"WS-Metadata Exchange [WCF], configuring a custom binding\"\nms.assetid: cdba4d73-da64-4805-bc56-9822becfd1e4\ncaps.latest.revision: 7\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","yamlblock":true},{"pos":[500,555],"content":"How to: Configure a Custom WS-Metadata Exchange Binding","linkify":"How to: Configure a Custom WS-Metadata Exchange Binding","nodes":[{"content":"How to: Configure a Custom WS-Metadata Exchange Binding","pos":[0,55]}]},{"content":"This topic will explain how to configure a custom WS-Metadata exchange binding.","pos":[556,635]},{"content":"<ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> includes four system-defined metadata bindings, but you can publish metadata using any binding you want.","pos":[636,796],"source":"[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] includes four system-defined metadata bindings, but you can publish metadata using any binding you want."},{"content":"This topic will show you how to publish metadata using the <ph id=\"ph1\">`wsHttpBinding`</ph>.","pos":[797,872],"source":" This topic will show you how to publish metadata using the `wsHttpBinding`."},{"content":"This binding gives you the option of exposing metadata in a secure way.","pos":[873,944]},{"content":"The code in this article is based on the <bpt id=\"p1\">[</bpt>Getting Started<ept id=\"p1\">](../../../../docs/framework/wcf/samples/getting-started-sample.md)</ept>.","pos":[945,1070],"source":" The code in this article is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md)."},{"pos":[1080,1106],"content":"Using a configuration file","linkify":"Using a configuration file","nodes":[{"content":"Using a configuration file","pos":[0,26]}]},{"pos":[1116,1216],"content":"In the service's configuration file, add a service behavior that contains the <ph id=\"ph1\">`serviceMetadata`</ph> tag:","source":"In the service's configuration file, add a service behavior that contains the `serviceMetadata` tag:"},{"pos":[1475,1568],"content":"Add a <ph id=\"ph1\">`behaviorConfiguration`</ph> attribute to the service tag that references this new behavior:","source":"Add a `behaviorConfiguration` attribute to the service tag that references this new behavior:"},{"pos":[1737,1901],"content":"Add a metadata endpoint specifying mex as the address, <ph id=\"ph1\">`wsHttpBinding`</ph> as the binding, and <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.IMetadataExchange&gt;</ph> as the contract:","source":"Add a metadata endpoint specifying mex as the address, `wsHttpBinding` as the binding, and <xref:System.ServiceModel.Description.IMetadataExchange> as the contract:"},{"content":"To verify the metadata exchange endpoint is working correctly add an endpoint tag in the client configuration file:","pos":[2052,2167]},{"pos":[2402,2780],"content":"In the client's Main() method, create a new <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.MetadataExchangeClient&gt;</ph> instance, set its <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.MetadataExchangeClient.ResolveMetadataReferences%2A&gt;</ph> property to <ph id=\"ph3\">`true`</ph>, call <ph id=\"ph4\">&lt;xref:System.ServiceModel.Description.MetadataExchangeClient.GetMetadata%2A&gt;</ph> and then iterate through the collection of metadata returned:","source":"In the client's Main() method, create a new <xref:System.ServiceModel.Description.MetadataExchangeClient> instance, set its <xref:System.ServiceModel.Description.MetadataExchangeClient.ResolveMetadataReferences%2A> property to `true`, call <xref:System.ServiceModel.Description.MetadataExchangeClient.GetMetadata%2A> and then iterate through the collection of metadata returned:"},{"pos":[3259,3278],"content":"Configuring by code","linkify":"Configuring by code","nodes":[{"content":"Configuring by code","pos":[0,19]}]},{"pos":[3288,3407],"content":"Create a &lt;<ph id=\"ph1\">&lt;!--zz xref:System.ServiceModel.WsHttpBinding --&gt;</ph> <ph id=\"ph2\">`xref:System.ServiceModel.WsHttpBinding`</ph>&gt; binding instance:","source":"Create a <<!--zz xref:System.ServiceModel.WsHttpBinding --> `xref:System.ServiceModel.WsHttpBinding`> binding instance:"},{"content":"Create a <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceHost&gt;</ph> instance:","pos":[3491,3548],"source":"Create a <xref:System.ServiceModel.ServiceHost> instance:"},{"content":"Add a service endpoint and add a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.ServiceMetadataBehavior&gt;</ph> instance:","pos":[3670,3775],"source":"Add a service endpoint and add a <xref:System.ServiceModel.Description.ServiceMetadataBehavior> instance:"},{"pos":[4039,4197],"content":"Add a metadata exchange endpoint, specifying the &lt;<ph id=\"ph1\">&lt;!--zz xref:System.ServiceModel.WsHttpBinding --&gt;</ph> <ph id=\"ph2\">`xref:System.ServiceModel.WsHttpBinding`</ph>&gt; created earlier:","source":"Add a metadata exchange endpoint, specifying the <<!--zz xref:System.ServiceModel.WsHttpBinding --> `xref:System.ServiceModel.WsHttpBinding`> created earlier:"},{"content":"To verify that the metadata exchange endpoint is working correctly, add an endpoint tag in the client configuration file:","pos":[4316,4437]},{"pos":[4672,5050],"content":"In the client's Main() method, create a new <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.MetadataExchangeClient&gt;</ph> instance, set the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.MetadataExchangeClient.ResolveMetadataReferences%2A&gt;</ph> property to <ph id=\"ph3\">`true`</ph>, call <ph id=\"ph4\">&lt;xref:System.ServiceModel.Description.MetadataExchangeClient.GetMetadata%2A&gt;</ph> and then iterate through the collection of metadata returned:","source":"In the client's Main() method, create a new <xref:System.ServiceModel.Description.MetadataExchangeClient> instance, set the <xref:System.ServiceModel.Description.MetadataExchangeClient.ResolveMetadataReferences%2A> property to `true`, call <xref:System.ServiceModel.Description.MetadataExchangeClient.GetMetadata%2A> and then iterate through the collection of metadata returned:"},{"pos":[5531,5539],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Metadata Publishing Behavior<ept id=\"p1\">](../../../../docs/framework/wcf/samples/metadata-publishing-behavior.md)</ept><ph id=\"ph1\"> </ph>","pos":[5543,5646],"source":"[Metadata Publishing Behavior](../../../../docs/framework/wcf/samples/metadata-publishing-behavior.md) "},{"content":"<bpt id=\"p1\">[</bpt>Retrieve Metadata<ept id=\"p1\">](../../../../docs/framework/wcf/samples/retrieve-metadata.md)</ept><ph id=\"ph1\"> </ph>","pos":[5650,5731],"source":"[Retrieve Metadata](../../../../docs/framework/wcf/samples/retrieve-metadata.md) "},{"content":"<bpt id=\"p1\">[</bpt>Metadata<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/metadata.md)</ept><ph id=\"ph1\"> </ph>","pos":[5735,5806],"source":"[Metadata](../../../../docs/framework/wcf/feature-details/metadata.md) "},{"content":"<bpt id=\"p1\">[</bpt>Publishing Metadata<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/publishing-metadata.md)</ept><ph id=\"ph1\"> </ph>","pos":[5810,5903],"source":"[Publishing Metadata](../../../../docs/framework/wcf/feature-details/publishing-metadata.md) "},{"content":"<bpt id=\"p1\">[</bpt>Publishing Metadata Endpoints<ept id=\"p1\">](../../../../docs/framework/wcf/publishing-metadata-endpoints.md)</ept>","pos":[5907,6003],"source":"[Publishing Metadata Endpoints](../../../../docs/framework/wcf/publishing-metadata-endpoints.md)"}]}