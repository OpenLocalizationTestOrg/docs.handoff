{"content":"---\ntitle: \"Handling DataView Events\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: e5675663-fc91-4e0d-87a9-481b25b64c0f\n---\n# Handling DataView Events\nYou can use the <xref:System.Data.DataView.ListChanged> event of the <xref:System.Data.DataView> to determine if a view has been updated. Updates that raise the event include adding, deleting, or modifying a row in the underlying table; adding or deleting a column to the schema of the underlying table; and a change in a parent or child relationship. The **ListChanged** event also notifies you if the list of rows you are viewing has changed significantly due to the application of a new sort order or a filter.  \n  \n The **ListChanged** event implements the **ListChangedEventHandler** delegate of the <xref:System.ComponentModel> namespace and takes as input a <xref:System.ComponentModel.ListChangedEventArgs> object. You can determine what type of change has occurred using the <xref:System.ComponentModel.ListChangedType> enumeration value in the **ListChangedType** property of the **ListChangedEventArgs** object. For changes that involve adding, deleting, or moving rows, the new index of the added or moved row and the previous index of the deleted row can be accessed using the **NewIndex** property of the **ListChangedEventArgs** object. In the case of a moved row, the previous index of the moved row can be accessed using the **OldIndex** property of the **ListChangedEventArgs** object.  \n  \n The **DataViewManager** also exposes a **ListChanged** event to notify you if a table has been added or removed, or if a change has been made to the **Relations** collection of the underlying **DataSet**.  \n  \n The following code example shows how to add a **ListChanged** event handler.  \n  \n```vb  \nAddHandler custView.ListChanged, _  \n  New System.ComponentModel.ListChangedEventHandler( _  \n  AddressOf OnListChanged)  \n  \nPrivate Shared Sub OnListChanged( _  \n  sender As Object, args As System.ComponentModel.ListChangedEventArgs)  \n  Console.WriteLine(\"ListChanged:\")  \n  Console.WriteLine(vbTab & \"    Type = \" & _  \n    System.Enum.GetName(args.ListChangedType.GetType(), _  \n    args.ListChangedType))  \n  Console.WriteLine(vbTab & \"OldIndex = \" & args.OldIndex)  \n  Console.WriteLine(vbTab & \"NewIndex = \" & args.NewIndex)  \nEnd Sub  \n```  \n  \n```csharp  \ncustView.ListChanged  += new   \n  System.ComponentModel.ListChangedEventHandler(OnListChanged);  \n  \nprotected static void OnListChanged(object sender,   \n  System.ComponentModel.ListChangedEventArgs args)  \n{  \n  Console.WriteLine(\"ListChanged:\");  \n  Console.WriteLine(\"\\t    Type = \" + args.ListChangedType);  \n  Console.WriteLine(\"\\tOldIndex = \" + args.OldIndex);  \n  Console.WriteLine(\"\\tNewIndex = \" + args.NewIndex);  \n}  \n```  \n  \n## See also\n\n- <xref:System.Data.DataView>\n- <xref:System.ComponentModel.ListChangedEventHandler>\n- [DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataviews.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,142],"embed":true,"restype":"x-metadata","content":"title: \"Handling DataView Events\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: e5675663-fc91-4e0d-87a9-481b25b64c0f","nodes":[{"content":"Handling DataView Events","nodes":[{"pos":[0,24],"content":"Handling DataView Events","nodes":[{"content":"Handling DataView Events","pos":[0,24]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[149,173],"content":"Handling DataView Events","linkify":"Handling DataView Events","nodes":[{"content":"Handling DataView Events","pos":[0,24]}]},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Data.DataView.ListChanged&gt;</ph> event of the <ph id=\"ph2\">&lt;xref:System.Data.DataView&gt;</ph> to determine if a view has been updated.","pos":[174,311],"source":"You can use the <xref:System.Data.DataView.ListChanged> event of the <xref:System.Data.DataView> to determine if a view has been updated."},{"content":"Updates that raise the event include adding, deleting, or modifying a row in the underlying table; adding or deleting a column to the schema of the underlying table; and a change in a parent or child relationship.","pos":[312,525]},{"content":"The <bpt id=\"p1\">**</bpt>ListChanged<ept id=\"p1\">**</ept> event also notifies you if the list of rows you are viewing has changed significantly due to the application of a new sort order or a filter.","pos":[526,687],"source":" The **ListChanged** event also notifies you if the list of rows you are viewing has changed significantly due to the application of a new sort order or a filter."},{"content":"The <bpt id=\"p1\">**</bpt>ListChanged<ept id=\"p1\">**</ept> event implements the <bpt id=\"p2\">**</bpt>ListChangedEventHandler<ept id=\"p2\">**</ept> delegate of the <ph id=\"ph1\">&lt;xref:System.ComponentModel&gt;</ph> namespace and takes as input a <ph id=\"ph2\">&lt;xref:System.ComponentModel.ListChangedEventArgs&gt;</ph> object.","pos":[694,896],"source":"The **ListChanged** event implements the **ListChangedEventHandler** delegate of the <xref:System.ComponentModel> namespace and takes as input a <xref:System.ComponentModel.ListChangedEventArgs> object."},{"content":"You can determine what type of change has occurred using the <ph id=\"ph1\">&lt;xref:System.ComponentModel.ListChangedType&gt;</ph> enumeration value in the <bpt id=\"p1\">**</bpt>ListChangedType<ept id=\"p1\">**</ept> property of the <bpt id=\"p2\">**</bpt>ListChangedEventArgs<ept id=\"p2\">**</ept> object.","pos":[897,1096],"source":" You can determine what type of change has occurred using the <xref:System.ComponentModel.ListChangedType> enumeration value in the **ListChangedType** property of the **ListChangedEventArgs** object."},{"content":"For changes that involve adding, deleting, or moving rows, the new index of the added or moved row and the previous index of the deleted row can be accessed using the <bpt id=\"p1\">**</bpt>NewIndex<ept id=\"p1\">**</ept> property of the <bpt id=\"p2\">**</bpt>ListChangedEventArgs<ept id=\"p2\">**</ept> object.","pos":[1097,1325],"source":" For changes that involve adding, deleting, or moving rows, the new index of the added or moved row and the previous index of the deleted row can be accessed using the **NewIndex** property of the **ListChangedEventArgs** object."},{"content":"In the case of a moved row, the previous index of the moved row can be accessed using the <bpt id=\"p1\">**</bpt>OldIndex<ept id=\"p1\">**</ept> property of the <bpt id=\"p2\">**</bpt>ListChangedEventArgs<ept id=\"p2\">**</ept> object.","pos":[1326,1477],"source":" In the case of a moved row, the previous index of the moved row can be accessed using the **OldIndex** property of the **ListChangedEventArgs** object."},{"pos":[1484,1688],"content":"The <bpt id=\"p1\">**</bpt>DataViewManager<ept id=\"p1\">**</ept> also exposes a <bpt id=\"p2\">**</bpt>ListChanged<ept id=\"p2\">**</ept> event to notify you if a table has been added or removed, or if a change has been made to the <bpt id=\"p3\">**</bpt>Relations<ept id=\"p3\">**</ept> collection of the underlying <bpt id=\"p4\">**</bpt>DataSet<ept id=\"p4\">**</ept>.","source":"The **DataViewManager** also exposes a **ListChanged** event to notify you if a table has been added or removed, or if a change has been made to the **Relations** collection of the underlying **DataSet**."},{"pos":[1695,1771],"content":"The following code example shows how to add a <bpt id=\"p1\">**</bpt>ListChanged<ept id=\"p1\">**</ept> event handler.","source":"The following code example shows how to add a **ListChanged** event handler."},{"pos":[2793,2801],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2890,2984],"content":"<bpt id=\"p1\">[</bpt>DataViews<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataviews.md)</ept>","source":"[DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataviews.md)"},{"pos":[2987,3091],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}