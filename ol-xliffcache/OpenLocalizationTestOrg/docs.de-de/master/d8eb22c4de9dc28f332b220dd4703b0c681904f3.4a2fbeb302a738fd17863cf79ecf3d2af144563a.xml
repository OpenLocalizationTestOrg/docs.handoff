{"content":"---\ntitle: \"Input Overview\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"commands [WPF]\"\n  - \"input [WPF], overview\"\n  - \"keyboard focus [WPF]\"\n  - \"keyboard input [WPF]\"\n  - \"touch events [WPF]\"\n  - \"event routing [WPF]\"\n  - \"touch input [WPF]\"\n  - \"manipulation [WPF]\"\n  - \"logical focus [WPF]\"\n  - \"stylus input [WPF]\"\n  - \"text input [WPF]\"\n  - \"input events [WPF], handling\"\n  - \"WPF [WPF], input overview\"\n  - \"manipulation events [WPF]\"\n  - \"mouse input [WPF]\"\n  - \"mouse capture [WPF]\"\n  - \"focus [WPF]\"\n  - \"mouse position [WPF]\"\nms.assetid: ee5258b7-6567-415a-9b1c-c0cbe46e79ef\n---\n# Input Overview\n<a name=\"introduction\"></a> The [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] subsystem provides a powerful [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] for obtaining input from a variety of devices, including the mouse, keyboard, touch, and stylus. This topic describes the services provided by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and explains the architecture of the input systems.\n\n<a name=\"input_api\"></a>\n## Input API\n The primary input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] exposure is found on the base element classes: <xref:System.Windows.UIElement>, <xref:System.Windows.ContentElement>, <xref:System.Windows.FrameworkElement>, and <xref:System.Windows.FrameworkContentElement>.  For more information about the base elements, see [Base Elements Overview](base-elements-overview.md).  These classes provide functionality for input events related to key presses, mouse buttons, mouse wheel, mouse movement, focus management, and mouse capture, to name a few. By placing the input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] on the base elements, rather than treating all input events as a service, the input architecture enables the input events to be sourced by a particular object in the UI, and to support an event routing scheme whereby more than one element has an opportunity to handle an input event. Many input events have a pair of events associated with them.  For example, the key down event is associated with the <xref:System.Windows.Input.Keyboard.KeyDown> and <xref:System.Windows.Input.Keyboard.PreviewKeyDown> events.  The difference in these events is in how they are routed to the target element.  Preview events tunnel down the element tree from the root element to the target element.  Bubbling events bubble up from the target element to the root element.  Event routing in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is discussed in more detail later in this overview and in the [Routed Events Overview](routed-events-overview.md).\n\n### Keyboard and Mouse Classes\n In addition to the input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] on the base element classes, the <xref:System.Windows.Input.Keyboard> class and <xref:System.Windows.Input.Mouse> classes provide additional [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] for working with keyboard and mouse input.\n\n Examples of input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] on the <xref:System.Windows.Input.Keyboard> class are the <xref:System.Windows.Input.Keyboard.Modifiers%2A> property, which returns the <xref:System.Windows.Input.ModifierKeys> currently pressed, and the <xref:System.Windows.Input.Keyboard.IsKeyDown%2A> method, which determines whether a specified key is pressed.\n\n The following example uses the <xref:System.Windows.Input.Keyboard.GetKeyStates%2A> method to determine if a <xref:System.Windows.Input.Key> is in the down state.\n\n [!code-csharp[keyargssnippetsample#KeyEventArgsKeyBoardGetKeyStates](~/samples/snippets/csharp/VS_Snippets_Wpf/KeyArgsSnippetSample/CSharp/Window1.xaml.cs#keyeventargskeyboardgetkeystates)]\n [!code-vb[keyargssnippetsample#KeyEventArgsKeyBoardGetKeyStates](~/samples/snippets/visualbasic/VS_Snippets_Wpf/KeyArgsSnippetSample/visualbasic/window1.xaml.vb#keyeventargskeyboardgetkeystates)]\n\n Examples of input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] on the <xref:System.Windows.Input.Mouse> class are <xref:System.Windows.Input.Mouse.MiddleButton%2A>, which obtains the state of the middle mouse button, and <xref:System.Windows.Input.Mouse.DirectlyOver%2A>, which gets the element the mouse pointer is currently over.\n\n The following example determines whether the <xref:System.Windows.Input.Mouse.LeftButton%2A> on the mouse is in the <xref:System.Windows.Input.MouseButtonState.Pressed> state.\n\n [!code-csharp[mouserelatedsnippets#MouseRelatedSnippetsGetLeftButtonMouse](~/samples/snippets/csharp/VS_Snippets_Wpf/MouseRelatedSnippets/CSharp/Window1.xaml.cs#mouserelatedsnippetsgetleftbuttonmouse)]\n [!code-vb[mouserelatedsnippets#MouseRelatedSnippetsGetLeftButtonMouse](~/samples/snippets/visualbasic/VS_Snippets_Wpf/MouseRelatedSnippets/visualbasic/window1.xaml.vb#mouserelatedsnippetsgetleftbuttonmouse)]\n\n The <xref:System.Windows.Input.Mouse> and <xref:System.Windows.Input.Keyboard> classes are covered in more detail throughout this overview.\n\n### Stylus Input\n [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] has integrated support for the <xref:System.Windows.Input.Stylus>.  The <xref:System.Windows.Input.Stylus> is a pen input made popular by the [!INCLUDE[TLA#tla_tpc](../../../../includes/tlasharptla-tpc-md.md)].  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications can treat the stylus as a mouse by using the mouse [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)], but [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] also exposes a stylus device abstraction that use a model similar to the keyboard and mouse.  All stylus-related [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] contain the word \"Stylus\".\n\n Because the stylus can act as a mouse, applications that support only mouse input can still obtain some level of stylus support automatically. When the stylus is used in such a manner, the application is given the opportunity to handle the appropriate stylus event and then handles the corresponding mouse event. In addition, higher-level services such as ink input are also available through the stylus device abstraction.  For more information about ink as input, see [Getting Started with Ink](getting-started-with-ink.md).\n\n<a name=\"event_routing\"></a>\n## Event Routing\n A <xref:System.Windows.FrameworkElement> can contain other elements as child elements in its content model, forming a tree of elements.  In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the parent element can participate in input directed to its child elements or other descendants by handing events. This is especially useful for building controls out of smaller controls, a process known as \"control composition\" or \"compositing.\" For more information about element trees and how element trees relate to event routes, see [Trees in WPF](trees-in-wpf.md).\n\n Event routing is the process of forwarding events to multiple elements, so that a particular object or element along the route can choose to offer a significant response (through handling) to an event that might have been sourced by a different element.  Routed events use one of three routing mechanisms: direct, bubbling, and tunneling.  In direct routing, the source element is the only element notified, and the event is not routed to any other elements. However, the direct routed event still offers some additional capabilities that are only present for routed events as opposed to standard [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] events. Bubbling works up the element tree by first notifying the element that sourced the event, then the parent element, and so on.  Tunneling starts at the root of the element tree and works down, ending with the original source element.  For more information about routed events, see [Routed Events Overview](routed-events-overview.md).\n\n [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input events generally come in pairs that consists of a tunneling event and a bubbling event.  Tunneling events are distinguished from bubbling events with the \"Preview\" prefix.  For instance, <xref:System.Windows.Input.Mouse.PreviewMouseMove> is the tunneling version of a mouse move event and <xref:System.Windows.Input.Mouse.MouseMove> is the bubbling version of this event. This event pairing is a convention that is implemented at the element level and is not an inherent capability of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system. For details, see the WPF Input Events section in [Routed Events Overview](routed-events-overview.md).\n\n<a name=\"handling_input_events\"></a>\n## Handling Input Events\n To receive input on an element, an event handler must be associated with that particular event.  In [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] this is straightforward: you reference the name of the event as an attribute of the element that will be listening for this event.  Then, you set the value of the attribute to the name of the event handler that you define, based on a delegate.  The event handler must be written in code such as C# and can be included in a code-behind file.\n\n Keyboard events occur when the operating system reports key actions that occur while keyboard focus is on an element. Mouse and stylus events each fall into two categories: events that report changes in pointer position relative to the element, and events that report changes in the state of device buttons.\n\n### Keyboard Input Event Example\n The following example listens for a left arrow key press.  A <xref:System.Windows.Controls.StackPanel> is created that has a <xref:System.Windows.Controls.Button>.  An event handler to listen for the left arrow key press is attached to the <xref:System.Windows.Controls.Button> instance.\n\n The first section of the example creates the <xref:System.Windows.Controls.StackPanel> and the <xref:System.Windows.Controls.Button> and attaches the event handler for the <xref:System.Windows.UIElement.KeyDown>.\n\n [!code-xaml[InputOvw#Input_OvwKeyboardExampleXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml#input_ovwkeyboardexamplexaml)]\n\n [!code-csharp[InputOvw#Input_OvwKeyboardExampleUICodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwkeyboardexampleuicodebehind)]\n [!code-vb[InputOvw#Input_OvwKeyboardExampleUICodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwkeyboardexampleuicodebehind)]\n\n The second section is written in code and defines the event handler.  When the left arrow key is pressed and the <xref:System.Windows.Controls.Button> has keyboard focus, the handler runs and the <xref:System.Windows.Controls.Control.Background%2A> color of the <xref:System.Windows.Controls.Button> is changed.  If the key is pressed, but it is not the left arrow key, the <xref:System.Windows.Controls.Control.Background%2A> color of the <xref:System.Windows.Controls.Button> is changed back to its starting color.\n\n [!code-csharp[InputOvw#Input_OvwKeyboardExampleHandlerCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwkeyboardexamplehandlercodebehind)]\n [!code-vb[InputOvw#Input_OvwKeyboardExampleHandlerCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwkeyboardexamplehandlercodebehind)]\n\n### Mouse Input Event Example\n In the following example, the <xref:System.Windows.Controls.Control.Background%2A> color of a <xref:System.Windows.Controls.Button> is changed when the mouse pointer enters the <xref:System.Windows.Controls.Button>.  The <xref:System.Windows.Controls.Control.Background%2A> color is restored when the mouse leaves the <xref:System.Windows.Controls.Button>.\n\n The first section of the example creates the <xref:System.Windows.Controls.StackPanel> and the <xref:System.Windows.Controls.Button> control and attaches the event handlers for the <xref:System.Windows.UIElement.MouseEnter> and <xref:System.Windows.UIElement.MouseLeave> events to the <xref:System.Windows.Controls.Button>.\n\n [!code-xaml[InputOvw#Input_OvwMouseExampleXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml#input_ovwmouseexamplexaml)]\n\n [!code-csharp[InputOvw#Input_OvwMouseExampleUICodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwmouseexampleuicodebehind)]\n [!code-vb[InputOvw#Input_OvwMouseExampleUICodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwmouseexampleuicodebehind)]\n\n The second section of the example is written in code and defines the event handlers.  When the mouse enters the <xref:System.Windows.Controls.Button>, the <xref:System.Windows.Controls.Control.Background%2A> color of the <xref:System.Windows.Controls.Button> is changed to <xref:System.Windows.Media.Brushes.SlateGray%2A>.  When the mouse leaves the <xref:System.Windows.Controls.Button>, the <xref:System.Windows.Controls.Control.Background%2A> color of the <xref:System.Windows.Controls.Button> is changed back to <xref:System.Windows.Media.Brushes.AliceBlue%2A>.\n\n [!code-csharp[InputOvw#Input_OvwMouseExampleEneterHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwmouseexampleeneterhandler)]\n [!code-vb[InputOvw#Input_OvwMouseExampleEneterHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwmouseexampleeneterhandler)]\n\n [!code-csharp[InputOvw#Input_OvwMouseExampleLeaveHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwmouseexampleleavehandler)]\n [!code-vb[InputOvw#Input_OvwMouseExampleLeaveHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwmouseexampleleavehandler)]\n\n<a name=\"text_input\"></a>\n## Text Input\n The <xref:System.Windows.ContentElement.TextInput> event enables you to listen for text input in a device-independent manner. The keyboard is the primary means of text input, but speech, handwriting, and other input devices can generate text input also.\n\n For keyboard input, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] first sends the appropriate <xref:System.Windows.ContentElement.KeyDown>/<xref:System.Windows.ContentElement.KeyUp> events. If those events are not handled and the key is textual (rather than a control key such as directional arrows or function keys), then a <xref:System.Windows.ContentElement.TextInput> event is raised.  There is not always a simple one-to-one mapping between <xref:System.Windows.ContentElement.KeyDown>/<xref:System.Windows.ContentElement.KeyUp> and <xref:System.Windows.ContentElement.TextInput> events because multiple keystrokes can generate a single character of text input and single keystrokes can generate multi-character strings.  This is especially true for languages such as Chinese, Japanese, and Korean which use [!INCLUDE[TLA#tla_ime#plural](../../../../includes/tlasharptla-imesharpplural-md.md)] to generate the thousands of possible characters in their corresponding alphabets.\n\n When [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sends a <xref:System.Windows.ContentElement.KeyUp>/<xref:System.Windows.ContentElement.KeyDown> event, <xref:System.Windows.Input.KeyEventArgs.Key%2A> is set to <xref:System.Windows.Input.Key.System?displayProperty=nameWithType> if the keystrokes could become part of a <xref:System.Windows.ContentElement.TextInput> event (if ALT+S is pressed, for example). This allows code in a <xref:System.Windows.ContentElement.KeyDown> event handler to check for <xref:System.Windows.Input.Key.System?displayProperty=nameWithType> and, if found, leave processing for the handler of the subsequently raised <xref:System.Windows.ContentElement.TextInput> event. In these cases, the various properties of the <xref:System.Windows.Input.TextCompositionEventArgs> argument can be used to determine the original keystrokes. Similarly, if an [!INCLUDE[TLA2#tla_ime](../../../../includes/tla2sharptla-ime-md.md)] is active, <xref:System.Windows.Input.Key> has the value of <xref:System.Windows.Input.Key.ImeProcessed?displayProperty=nameWithType>, and <xref:System.Windows.Input.KeyEventArgs.ImeProcessedKey%2A> gives the original keystroke or keystrokes.\n\n The following example defines a handler for the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event and a handler for the <xref:System.Windows.UIElement.KeyDown> event.\n\n The first segment of code or markup creates the user interface.\n\n [!code-xaml[InputOvw#Input_OvwTextInputXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml#input_ovwtextinputxaml)]\n\n [!code-csharp[InputOvw#Input_OvwTextInputUICodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwtextinputuicodebehind)]\n [!code-vb[InputOvw#Input_OvwTextInputUICodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwtextinputuicodebehind)]\n\n The second segment of code contains the event handlers.\n\n [!code-csharp[InputOvw#Input_OvwTextInputHandlersCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwtextinputhandlerscodebehind)]\n [!code-vb[InputOvw#Input_OvwTextInputHandlersCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwtextinputhandlerscodebehind)]\n\n Because input events bubble up the event route, the <xref:System.Windows.Controls.StackPanel> receives the input regardless of which element has keyboard focus. The <xref:System.Windows.Controls.TextBox> control is notified first and the `OnTextInputKeyDown` handler is called only if the <xref:System.Windows.Controls.TextBox> did not handle the input. If the <xref:System.Windows.UIElement.PreviewKeyDown> event is used instead of the <xref:System.Windows.UIElement.KeyDown> event, the `OnTextInputKeyDown` handler is called first.\n\n In this example, the handling logic is written two timesâ€”one time for CTRL+O, and again for button's click event. This can be simplified by using commands, instead of handling the input events directly.  Commands are discussed in this overview and in [Commanding Overview](commanding-overview.md).\n\n<a name=\"touch_and_manipulation\"></a>\n## Touch and Manipulation\n New hardware and API in the Windows 7 operating system provide applications the ability to receive input from multiple touches simultaneously. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] enables applications to detect and respond to touch in a manner similar to responding to other input, such as the mouse or keyboard, by raising events when touch occurs.\n\n [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] exposes two types of events when touch occurs: touch events and manipulation events. Touch events provide raw data about each finger on a touchscreen and its movement. Manipulation events interpret the input as certain actions. Both types of events are discussed in this section.\n\n### Prerequisites\n You need the following components to develop an application that responds to touch.\n\n-   Visual Studio 2010.\n\n-   Windows 7.\n\n-   A device, such as a touchscreen, that supports Windows Touch.\n\n### Terminology\n The following terms are used when touch is discussed.\n\n-   **Touch** is a type of user input that is recognized by Windows 7. Usually, touch is initiated by putting fingers on a touch-sensitive screen. Note that devices such as a touchpad that is common on laptop computers do not support touch if the device merely converts the finger's position and movement as mouse input.\n\n-   **Multitouch** is touch that occurs from more than one point simultaneously. Windows 7 and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] supports multitouch. Whenever touch is discussed in the documentation for [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the concepts apply to multitouch.\n\n-   A **manipulation** occurs when touch is interpreted as a physical action that is applied to an object. In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], manipulation events interpret input as a translation, expansion, or rotation manipulation.\n\n-   A `touch device` represents a device that produces touch input, such as a single finger on a touchscreen.\n\n### Controls that Respond to Touch\n The following controls can be scrolled by dragging a finger across the control if it has content that is scrolled out of view.\n\n-   <xref:System.Windows.Controls.ComboBox>\n\n-   <xref:System.Windows.Controls.ContextMenu>\n\n-   <xref:System.Windows.Controls.DataGrid>\n\n-   <xref:System.Windows.Controls.ListBox>\n\n-   <xref:System.Windows.Controls.ListView>\n\n-   <xref:System.Windows.Controls.MenuItem>\n\n-   <xref:System.Windows.Controls.TextBox>\n\n-   <xref:System.Windows.Controls.ToolBar>\n\n-   <xref:System.Windows.Controls.TreeView>\n\n The <xref:System.Windows.Controls.ScrollViewer> defines the <xref:System.Windows.Controls.ScrollViewer.PanningMode%2A?displayProperty=nameWithType> attached property that enables you to specify whether touch panning is enabled horizontally, vertically, both, or neither. The <xref:System.Windows.Controls.ScrollViewer.PanningDeceleration%2A?displayProperty=nameWithType> property specifies how quickly the scrolling slows down when the user lifts the finger from the touchscreen. The <xref:System.Windows.Controls.ScrollViewer.PanningRatio%2A?displayProperty=nameWithType> attached property specifies the ratio of scrolling offset to translate manipulation offset.\n\n### Touch Events\n The base classes, <xref:System.Windows.UIElement>, <xref:System.Windows.UIElement3D>, and <xref:System.Windows.ContentElement>, define events that you can subscribe to so your application will respond to touch. Touch events are useful when your application interprets touch as something other than manipulating an object. For example, an application that enables a user to draw with one or more fingers would subscribe to touch events.\n\n All three classes define the following events, which behave similarly, regardless of the defining class.\n\n-   <xref:System.Windows.UIElement.TouchDown>\n\n-   <xref:System.Windows.UIElement.TouchMove>\n\n-   <xref:System.Windows.UIElement.TouchUp>\n\n-   <xref:System.Windows.UIElement.TouchEnter>\n\n-   <xref:System.Windows.UIElement.TouchLeave>\n\n-   <xref:System.Windows.UIElement.PreviewTouchDown>\n\n-   <xref:System.Windows.UIElement.PreviewTouchMove>\n\n-   <xref:System.Windows.UIElement.PreviewTouchUp>\n\n-   <xref:System.Windows.UIElement.GotTouchCapture>\n\n-   <xref:System.Windows.UIElement.LostTouchCapture>\n\n Like keyboard and mouse events, the touch events are routed events. The events that begin with `Preview` are tunneling events and the events that begin with `Touch` are bubbling events. For more information about routed events, see [Routed Events Overview](routed-events-overview.md). When you handle these events, you can get the position of the input, relative to any element, by calling the <xref:System.Windows.Input.TouchEventArgs.GetTouchPoint%2A> or <xref:System.Windows.Input.TouchEventArgs.GetIntermediateTouchPoints%2A> method.\n\n To understand the interaction among the touch events, consider the scenario where a user puts one finger on an element, moves the finger in the element, and then lifts the finger from the element. The following illustration shows the execution of the bubbling events (the tunneling events are omitted for simplicity).\n\n ![The sequence of touch events.](./media/ndp-touchevents.png \"NDP_TouchEvents\")\nTouch events\n\n The following list describes the sequence of the events in the preceding illustration.\n\n1.  The <xref:System.Windows.UIElement.TouchEnter> event occurs one time when the user puts a finger on the element.\n\n2.  The <xref:System.Windows.UIElement.TouchDown> event occurs one time.\n\n3.  The <xref:System.Windows.UIElement.TouchMove> event occurs multiple times as the user moves the finger within the element.\n\n4.  The <xref:System.Windows.UIElement.TouchUp> event occurs one time when the user lifts the finger from the element.\n\n5.  The <xref:System.Windows.UIElement.TouchLeave> event occurs one time.\n\n When more than two fingers are used, the events occur for each finger.\n\n### Manipulation Events\n For cases where an application enables a user to manipulate an object, the <xref:System.Windows.UIElement> class defines manipulation events. Unlike the touch events that simply report the position of touch, the manipulation events report how the input can be interpreted. There are three types of manipulations, translation, expansion, and rotation. The following list describes how to invoke the three types of manipulations.\n\n-   Put a finger on an object and move the finger across the touchscreen to invoke a translation manipulation. This usually moves the object.\n\n-   Put two fingers on an object and move the fingers closer together or farther apart from one another to invoke an expansion manipulation. This usually resizes the object.\n\n-   Put two fingers on an object and rotate the fingers around each other to invoke a rotation manipulation. This usually rotates the object.\n\n More than one type of manipulation can occur simultaneously.\n\n When you cause objects to respond to manipulations, you can have the object appear to have inertia. This can make your objects simulate the physical world. For example, when you push a book across a table, if you push hard enough the book will continue to move after you release it. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] enables you to simulate this behavior by raising manipulation events after the user's fingers releases the object.\n\n For information about how to create an application that enables the user to move, resize, and rotate an object, see [Walkthrough: Creating Your First Touch Application](walkthrough-creating-your-first-touch-application.md).\n\n The <xref:System.Windows.UIElement> defines the following manipulation events.\n\n-   <xref:System.Windows.UIElement.ManipulationStarting>\n\n-   <xref:System.Windows.UIElement.ManipulationStarted>\n\n-   <xref:System.Windows.UIElement.ManipulationDelta>\n\n-   <xref:System.Windows.UIElement.ManipulationInertiaStarting>\n\n-   <xref:System.Windows.UIElement.ManipulationCompleted>\n\n-   <xref:System.Windows.UIElement.ManipulationBoundaryFeedback>\n\n By default, a <xref:System.Windows.UIElement> does not receive these manipulation events. To receive manipulation events on a <xref:System.Windows.UIElement>, set <xref:System.Windows.UIElement.IsManipulationEnabled%2A?displayProperty=nameWithType> to `true`.\n\n#### The Execution Path of Manipulation Events\n Consider a scenario where a user \"throws\" an object. The user puts a finger on the object, moves the finger across the touchscreen for a short distance, and then lifts the finger while it is moving. The result of this is that the object will move under the user's finger and continue to move after the user lifts the finger.\n\n The following illustration shows the execution path of manipulation events and important information about each event.\n\n ![The sequence of manipulation events.](./media/ndp-manipulationevents.png \"NDP_ManipulationEvents\")\nManipulation events\n\n The following list describes the sequence of the events in the preceding illustration.\n\n1.  The <xref:System.Windows.UIElement.ManipulationStarting> event occurs when the user places a finger on the object. Among other things, this event allows you to set the <xref:System.Windows.Input.ManipulationStartingEventArgs.ManipulationContainer%2A> property. In the subsequent events, the position of the manipulation will be relative to the <xref:System.Windows.Input.ManipulationStartingEventArgs.ManipulationContainer%2A>. In events other than <xref:System.Windows.UIElement.ManipulationStarting>, this property is read-only, so the <xref:System.Windows.UIElement.ManipulationStarting> event is the only time that you can set this property.\n\n2.  The <xref:System.Windows.UIElement.ManipulationStarted> event occurs next. This event reports the origin of the manipulation.\n\n3.  The <xref:System.Windows.UIElement.ManipulationDelta> event occurs multiple times as a user's fingers move on a touchscreen. The <xref:System.Windows.Input.ManipulationDeltaEventArgs.DeltaManipulation%2A> property of the <xref:System.Windows.Input.ManipulationDeltaEventArgs> class reports whether the manipulation is interpreted as movement, expansion, or translation. This is where you perform most of the work of manipulating an object.\n\n4.  The <xref:System.Windows.UIElement.ManipulationInertiaStarting> event occurs when the user's fingers lose contact with the object. This event enables you to specify the deceleration of the manipulations during inertia. This is so your object can emulate different physical spaces or attributes if you choose. For example, suppose your application has two objects that represent items in the physical world, and one is heavier than the other. You can make the heavier object decelerate faster than the lighter object.\n\n5.  The <xref:System.Windows.UIElement.ManipulationDelta> event occurs multiple times as inertia occurs. Note that this event occurs when the user's fingers move across the touchscreen and when [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] simulates inertia. In other words, <xref:System.Windows.UIElement.ManipulationDelta> occurs before and after the <xref:System.Windows.UIElement.ManipulationInertiaStarting> event. The <xref:System.Windows.Input.ManipulationDeltaEventArgs.IsInertial%2A?displayProperty=nameWithType> property reports whether the <xref:System.Windows.UIElement.ManipulationDelta> event occurs during inertia, so you can check that property and perform different actions, depending on its value.\n\n6.  The <xref:System.Windows.UIElement.ManipulationCompleted> event occurs when the manipulation and any inertia ends. That is, after all the <xref:System.Windows.UIElement.ManipulationDelta> events occur, the <xref:System.Windows.UIElement.ManipulationCompleted> event occurs to signal that the manipulation is complete.\n\n The <xref:System.Windows.UIElement> also defines the <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> event. This event occurs when the <xref:System.Windows.Input.ManipulationDeltaEventArgs.ReportBoundaryFeedback%2A> method is called in the <xref:System.Windows.UIElement.ManipulationDelta> event. The <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> event enables applications or components to provide visual feedback when an object hits a boundary. For example, the <xref:System.Windows.Window> class handles the <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> event to cause the window to slightly move when its edge is encountered.\n\n You can cancel the manipulation by calling the <xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A> method on the event arguments in any manipulation event except <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> event. When you call <xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A>, the manipulation events are no longer raised and mouse events occur for touch. The following table describes the relationship between the time the manipulation is canceled and the mouse events that occur.\n\n|The event that Cancel is called in|The mouse events that occur for input that already occurred|\n|----------------------------------------|-----------------------------------------------------------------|\n|<xref:System.Windows.UIElement.ManipulationStarting> and <xref:System.Windows.UIElement.ManipulationStarted>|Mouse down events.|\n|<xref:System.Windows.UIElement.ManipulationDelta>|Mouse down and mouse move events.|\n|<xref:System.Windows.UIElement.ManipulationInertiaStarting> and <xref:System.Windows.UIElement.ManipulationCompleted>|Mouse down, mouse move, and mouse up events.|\n\n Note that if you call <xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A> when the manipulation is in inertia, the method returns `false` and the input does not raise mouse events.\n\n### The Relationship Between Touch and Manipulation Events\n A <xref:System.Windows.UIElement> can always receive touch events. When the <xref:System.Windows.UIElement.IsManipulationEnabled%2A> property is set to `true`, a <xref:System.Windows.UIElement> can receive both touch and manipulation events.  If the <xref:System.Windows.UIElement.TouchDown> event is not handled (that is, the <xref:System.Windows.RoutedEventArgs.Handled%2A> property is `false`), the manipulation logic captures the touch to the element and generates the manipulation events. If the <xref:System.Windows.RoutedEventArgs.Handled%2A> property is set to `true` in the <xref:System.Windows.UIElement.TouchDown> event, the manipulation logic does not generate manipulation events. The following illustration shows the relationship between touch events and manipulation events.\n\n ![Relationship between touch and manipulation events](./media/ndp-touchmanipulateevents.png \"NDP_TouchManipulateEvents\")\nTouch and manipulation events\n\n The following list describes the relationship between the touch and manipulation events that is shown in the preceding illustration.\n\n-   When the first touch device generates a <xref:System.Windows.UIElement.TouchDown> event on a <xref:System.Windows.UIElement>, the manipulation logic calls the <xref:System.Windows.UIElement.CaptureTouch%2A> method, which generates the <xref:System.Windows.UIElement.GotTouchCapture> event.\n\n-   When the <xref:System.Windows.UIElement.GotTouchCapture> occurs, the manipulation logic calls the <xref:System.Windows.Input.Manipulation.AddManipulator%2A?displayProperty=nameWithType> method, which generates the <xref:System.Windows.UIElement.ManipulationStarting> event.\n\n-   When the <xref:System.Windows.UIElement.TouchMove> events occur, the manipulation logic generates the <xref:System.Windows.UIElement.ManipulationDelta> events that occur before the <xref:System.Windows.UIElement.ManipulationInertiaStarting> event.\n\n-   When the last touch device on the element raises the <xref:System.Windows.UIElement.TouchUp> event, the manipulation logic generates the <xref:System.Windows.UIElement.ManipulationInertiaStarting> event.\n\n<a name=\"focus\"></a>\n## Focus\n There are two main concepts that pertain to focus in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]: keyboard focus and logical focus.\n\n### Keyboard Focus\n Keyboard focus refers to the element that is receiving keyboard input.  There can be only one element on the whole desktop that has keyboard focus.  In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the element that has keyboard focus will have <xref:System.Windows.IInputElement.IsKeyboardFocused%2A> set to `true`.  The static <xref:System.Windows.Input.Keyboard> method <xref:System.Windows.Input.Keyboard.FocusedElement%2A> returns the element that currently has keyboard focus.\n\n Keyboard focus can be obtained by tabbing to an element or by clicking the mouse on certain elements, such as a <xref:System.Windows.Controls.TextBox>.  Keyboard focus can also be obtained programmatically by using the <xref:System.Windows.Input.Keyboard.Focus%2A> method on the <xref:System.Windows.Input.Keyboard> class.  <xref:System.Windows.Input.Keyboard.Focus%2A> attempts to give the specified element keyboard focus.  The element returned by <xref:System.Windows.Input.Keyboard.Focus%2A> is the element that currently has keyboard focus.\n\n In order for an element to obtain keyboard focus the <xref:System.Windows.UIElement.Focusable%2A> property and the <xref:System.Windows.UIElement.IsVisible%2A> properties must be set to **true**.  Some classes, such as <xref:System.Windows.Controls.Panel>, have <xref:System.Windows.UIElement.Focusable%2A> set to `false` by default; therefore, you may have to set this property to `true` if you want that element to be able to obtain focus.\n\n The following example uses <xref:System.Windows.Input.Keyboard.Focus%2A> to set keyboard focus on a <xref:System.Windows.Controls.Button>.  The recommended place to set initial focus in an application is in the <xref:System.Windows.FrameworkElement.Loaded> event handler.\n\n [!code-csharp[focussample#FocusSampleSetFocus](~/samples/snippets/csharp/VS_Snippets_Wpf/FocusSample/CSharp/Window1.xaml.cs#focussamplesetfocus)]\n [!code-vb[focussample#FocusSampleSetFocus](~/samples/snippets/visualbasic/VS_Snippets_Wpf/FocusSample/visualbasic/window1.xaml.vb#focussamplesetfocus)]\n\n For more information about keyboard focus, see [Focus Overview](focus-overview.md).\n\n### Logical Focus\n Logical focus refers to the <xref:System.Windows.Input.FocusManager.FocusedElement%2A?displayProperty=nameWithType> in a focus scope.  There can be multiple elements that have logical focus in an application, but there may only be one element that has logical focus in a particular focus scope.\n\n A focus scope is a container element that keeps track of the <xref:System.Windows.Input.FocusManager.FocusedElement%2A> within its scope.  When focus leaves a focus scope, the focused element will lose keyboard focus but will retain logical focus.  When focus returns to the focus scope, the focused element will obtain keyboard focus.  This allows for keyboard focus to be changed between multiple focus scopes but insures that the focused element within the focus scope remains the focused element when focus returns.\n\n An element can be turned into a focus scope in [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] by setting the <xref:System.Windows.Input.FocusManager> attached property <xref:System.Windows.Input.FocusManager.IsFocusScope%2A> to `true`, or in code by setting the attached property by using the <xref:System.Windows.Input.FocusManager.SetIsFocusScope%2A> method.\n\n The following example makes a <xref:System.Windows.Controls.StackPanel> into a focus scope by setting the <xref:System.Windows.Input.FocusManager.IsFocusScope%2A> attached property.\n\n [!code-xaml[MarkupSnippets#MarkupIsFocusScopeXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/MarkupSnippets/CSharp/Window1.xaml#markupisfocusscopexaml)]\n\n [!code-csharp[FocusSnippets#FocusSetIsFocusScope](~/samples/snippets/csharp/VS_Snippets_Wpf/FocusSnippets/CSharp/Window1.xaml.cs#focussetisfocusscope)]\n [!code-vb[FocusSnippets#FocusSetIsFocusScope](~/samples/snippets/visualbasic/VS_Snippets_Wpf/FocusSnippets/visualbasic/window1.xaml.vb#focussetisfocusscope)]\n\n Classes in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] which are focus scopes by default are <xref:System.Windows.Window>, <xref:System.Windows.Controls.Menu>, <xref:System.Windows.Controls.ToolBar>, and <xref:System.Windows.Controls.ContextMenu>.\n\n An element that has keyboard focus will also have logical focus for the focus scope it belongs to; therefore, setting focus on an element with the <xref:System.Windows.Input.Keyboard.Focus%2A> method on the <xref:System.Windows.Input.Keyboard> class or the base element classes will attempt to give the element keyboard focus and logical focus.\n\n To determine the focused element in a focus scope, use <xref:System.Windows.Input.FocusManager.GetFocusedElement%2A>. To change the focused element for a focus scope, use <xref:System.Windows.Input.FocusManager.SetFocusedElement%2A>.\n\n For more information about logical focus, see [Focus Overview](focus-overview.md).\n\n<a name=\"mouse_position\"></a>\n## Mouse Position\n The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] provides helpful information with regard to coordinate spaces.  For example, coordinate `(0,0)` is the upper-left coordinate, but the upper-left of which element in the tree? The element that is the input target? The element you attached your event handler to? Or something else? To avoid confusion, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] requires that you specify your frame of reference when you work with coordinates obtained through the mouse. The <xref:System.Windows.Input.Mouse.GetPosition%2A> method returns the coordinate of the mouse pointer relative to the specified element.\n\n<a name=\"mouse_capture\"></a>\n## Mouse Capture\n Mouse devices specifically hold a modal characteristic known as mouse capture. Mouse capture is used to maintain a transitional input state when a drag-and-drop operation is started, so that other operations involving the nominal on-screen position of the mouse pointer do not necessarily occur. During the drag, the user cannot click without aborting the drag-and-drop, which makes most mouseover cues inappropriate while the mouse capture is held by the drag origin. The input system exposes [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] that can determine mouse capture state, as well as [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] that can force mouse capture to a specific element, or clear mouse capture state. For more information on drag-and-drop operations, see [Drag and Drop Overview](drag-and-drop-overview.md).\n\n<a name=\"commands\"></a>\n## Commands\n Commands enable input handling at a more semantic level than device input.  Commands are simple directives, such as `Cut`, `Copy`, `Paste`, or `Open`.  Commands are useful for centralizing your command logic.  The same command might be accessed from a <xref:System.Windows.Controls.Menu>, on a <xref:System.Windows.Controls.ToolBar>, or through a keyboard shortcut. Commands also provide a mechanism for disabling controls when the command becomes unavailable.\n\n <xref:System.Windows.Input.RoutedCommand> is the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of <xref:System.Windows.Input.ICommand>.  When a <xref:System.Windows.Input.RoutedCommand> is executed, a <xref:System.Windows.Input.CommandManager.PreviewExecuted> and an <xref:System.Windows.Input.CommandManager.Executed> event are raised on the command target, which tunnel and bubble through the element tree like other input.  If a command target is not set, the element with keyboard focus will be the command target.  The logic that performs the command is attached to a <xref:System.Windows.Input.CommandBinding>.  When an <xref:System.Windows.Input.CommandManager.Executed> event reaches a <xref:System.Windows.Input.CommandBinding> for that specific command, the <xref:System.Windows.Input.ExecutedRoutedEventHandler> on the <xref:System.Windows.Input.CommandBinding> is called.  This handler performs the action of the command.\n\n For more information on commanding, see [Commanding Overview](commanding-overview.md).\n\n [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a library of common commands which consists of <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ComponentCommands>, <xref:System.Windows.Input.NavigationCommands>, and <xref:System.Windows.Documents.EditingCommands>, or you can define your own.\n\n The following example shows how to set up a <xref:System.Windows.Controls.MenuItem> so that when it is clicked it will invoke the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command on the <xref:System.Windows.Controls.TextBox>, assuming the <xref:System.Windows.Controls.TextBox> has keyboard focus.\n\n [!code-xaml[CommandingOverviewSnippets#CommandingOverviewSimpleCommand](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewsimplecommand)]\n\n [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]\n [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]\n\n For more information about commands in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Commanding Overview](commanding-overview.md).\n\n<a name=\"the_input_system_and_base_elements\"></a>\n## The Input System and Base Elements\n Input events such as the attached events defined by the <xref:System.Windows.Input.Mouse>, <xref:System.Windows.Input.Keyboard>, and <xref:System.Windows.Input.Stylus> classes are raised by the input system and injected into a particular position in the object model based on hit testing the visual tree at run time.\n\n Each of the events that <xref:System.Windows.Input.Mouse>, <xref:System.Windows.Input.Keyboard>, and <xref:System.Windows.Input.Stylus> define as an attached event is also re-exposed by the base element classes <xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement> as a new routed event. The base element routed events are generated by classes handling the original attached event and reusing the event data.\n\n When the input event becomes associated with a particular source element through its base element input event implementation, it can be routed through the remainder of an event route that is based on a combination of logical and visual tree objects, and be handled by application code.  Generally, it is more convenient to handle these device-related input events using the routed events on <xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement>, because you can use more intuitive event handler syntax both in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] and in code. You could choose to handle the attached event that initiated the process instead, but you would face several issues: the attached event may be marked handled by the base element class handling, and you need to use accessor methods rather than true event syntax in order to attach handlers for attached events.\n\n<a name=\"whats_next\"></a>\n## What's Next\n You now have several techniques to handle input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  You should also have an improved understanding of the various types of input events and the routed event mechanisms used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].\n\n Additional resources are available that explain [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] framework elements and event routing in more detail. See the following overviews for more information, [Commanding Overview](commanding-overview.md), [Focus Overview](focus-overview.md), [Base Elements Overview](base-elements-overview.md), [Trees in WPF](trees-in-wpf.md), and [Routed Events Overview](routed-events-overview.md).\n\n## See also\n\n- [Focus Overview](focus-overview.md)\n- [Commanding Overview](commanding-overview.md)\n- [Routed Events Overview](routed-events-overview.md)\n- [Base Elements Overview](base-elements-overview.md)\n- [Properties](properties-wpf.md)\n","nodes":[{"pos":[4,623],"embed":true,"restype":"x-metadata","content":"title: \"Input Overview\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"commands [WPF]\"\n  - \"input [WPF], overview\"\n  - \"keyboard focus [WPF]\"\n  - \"keyboard input [WPF]\"\n  - \"touch events [WPF]\"\n  - \"event routing [WPF]\"\n  - \"touch input [WPF]\"\n  - \"manipulation [WPF]\"\n  - \"logical focus [WPF]\"\n  - \"stylus input [WPF]\"\n  - \"text input [WPF]\"\n  - \"input events [WPF], handling\"\n  - \"WPF [WPF], input overview\"\n  - \"manipulation events [WPF]\"\n  - \"mouse input [WPF]\"\n  - \"mouse capture [WPF]\"\n  - \"focus [WPF]\"\n  - \"mouse position [WPF]\"\nms.assetid: ee5258b7-6567-415a-9b1c-c0cbe46e79ef","nodes":[{"content":"Input Overview","nodes":[{"pos":[0,14],"content":"Input Overview","nodes":[{"content":"Input Overview","pos":[0,14]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[630,644],"content":"Input Overview","linkify":"Input Overview","nodes":[{"content":"Input Overview","pos":[0,14]}]},{"content":"<bpt id=\"p1\">&lt;a name=\"introduction\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> The <ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> subsystem provides a powerful <ph id=\"ph2\">[!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)]</ph> for obtaining input from a variety of devices, including the mouse, keyboard, touch, and stylus.","pos":[645,951],"source":"<a name=\"introduction\"></a> The [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] subsystem provides a powerful [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] for obtaining input from a variety of devices, including the mouse, keyboard, touch, and stylus."},{"content":"This topic describes the services provided by <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> and explains the architecture of the input systems.","pos":[952,1131],"source":" This topic describes the services provided by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and explains the architecture of the input systems."},{"pos":[1161,1170],"content":"Input API","linkify":"Input API","nodes":[{"content":"Input API","pos":[0,9]}]},{"content":"The primary input <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> exposure is found on the base element classes: <ph id=\"ph2\">&lt;xref:System.Windows.UIElement&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.ContentElement&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.FrameworkElement&gt;</ph>, and <ph id=\"ph5\">&lt;xref:System.Windows.FrameworkContentElement&gt;</ph>.","pos":[1172,1468],"source":"The primary input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] exposure is found on the base element classes: <xref:System.Windows.UIElement>, <xref:System.Windows.ContentElement>, <xref:System.Windows.FrameworkElement>, and <xref:System.Windows.FrameworkContentElement>."},{"content":"For more information about the base elements, see <bpt id=\"p1\">[</bpt>Base Elements Overview<ept id=\"p1\">](base-elements-overview.md)</ept>.","pos":[1470,1572],"source":"  For more information about the base elements, see [Base Elements Overview](base-elements-overview.md)."},{"content":"These classes provide functionality for input events related to key presses, mouse buttons, mouse wheel, mouse movement, focus management, and mouse capture, to name a few.","pos":[1574,1746]},{"content":"By placing the input <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> on the base elements, rather than treating all input events as a service, the input architecture enables the input events to be sourced by a particular object in the UI, and to support an event routing scheme whereby more than one element has an opportunity to handle an input event.","pos":[1747,2121],"source":" By placing the input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] on the base elements, rather than treating all input events as a service, the input architecture enables the input events to be sourced by a particular object in the UI, and to support an event routing scheme whereby more than one element has an opportunity to handle an input event."},{"content":"Many input events have a pair of events associated with them.","pos":[2122,2183]},{"content":"For example, the key down event is associated with the <ph id=\"ph1\">&lt;xref:System.Windows.Input.Keyboard.KeyDown&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Input.Keyboard.PreviewKeyDown&gt;</ph> events.","pos":[2185,2348],"source":"  For example, the key down event is associated with the <xref:System.Windows.Input.Keyboard.KeyDown> and <xref:System.Windows.Input.Keyboard.PreviewKeyDown> events."},{"content":"The difference in these events is in how they are routed to the target element.","pos":[2350,2429]},{"content":"Preview events tunnel down the element tree from the root element to the target element.","pos":[2431,2519]},{"content":"Bubbling events bubble up from the target element to the root element.","pos":[2521,2591]},{"content":"Event routing in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> is discussed in more detail later in this overview and in the <bpt id=\"p1\">[</bpt>Routed Events Overview<ept id=\"p1\">](routed-events-overview.md)</ept>.","pos":[2593,2806],"source":"  Event routing in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is discussed in more detail later in this overview and in the [Routed Events Overview](routed-events-overview.md)."},{"pos":[2812,2838],"content":"Keyboard and Mouse Classes","linkify":"Keyboard and Mouse Classes","nodes":[{"content":"Keyboard and Mouse Classes","pos":[0,26]}]},{"pos":[2840,3188],"content":"In addition to the input <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> on the base element classes, the <ph id=\"ph2\">&lt;xref:System.Windows.Input.Keyboard&gt;</ph> class and <ph id=\"ph3\">&lt;xref:System.Windows.Input.Mouse&gt;</ph> classes provide additional <ph id=\"ph4\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> for working with keyboard and mouse input.","source":"In addition to the input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] on the base element classes, the <xref:System.Windows.Input.Keyboard> class and <xref:System.Windows.Input.Mouse> classes provide additional [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] for working with keyboard and mouse input."},{"pos":[3191,3593],"content":"Examples of input <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> on the <ph id=\"ph2\">&lt;xref:System.Windows.Input.Keyboard&gt;</ph> class are the <ph id=\"ph3\">&lt;xref:System.Windows.Input.Keyboard.Modifiers%2A&gt;</ph> property, which returns the <ph id=\"ph4\">&lt;xref:System.Windows.Input.ModifierKeys&gt;</ph> currently pressed, and the <ph id=\"ph5\">&lt;xref:System.Windows.Input.Keyboard.IsKeyDown%2A&gt;</ph> method, which determines whether a specified key is pressed.","source":"Examples of input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] on the <xref:System.Windows.Input.Keyboard> class are the <xref:System.Windows.Input.Keyboard.Modifiers%2A> property, which returns the <xref:System.Windows.Input.ModifierKeys> currently pressed, and the <xref:System.Windows.Input.Keyboard.IsKeyDown%2A> method, which determines whether a specified key is pressed."},{"pos":[3596,3758],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Windows.Input.Keyboard.GetKeyStates%2A&gt;</ph> method to determine if a <ph id=\"ph2\">&lt;xref:System.Windows.Input.Key&gt;</ph> is in the down state.","source":"The following example uses the <xref:System.Windows.Input.Keyboard.GetKeyStates%2A> method to determine if a <xref:System.Windows.Input.Key> is in the down state."},{"pos":[4150,4506],"content":"Examples of input <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> on the <ph id=\"ph2\">&lt;xref:System.Windows.Input.Mouse&gt;</ph> class are <ph id=\"ph3\">&lt;xref:System.Windows.Input.Mouse.MiddleButton%2A&gt;</ph>, which obtains the state of the middle mouse button, and <ph id=\"ph4\">&lt;xref:System.Windows.Input.Mouse.DirectlyOver%2A&gt;</ph>, which gets the element the mouse pointer is currently over.","source":"Examples of input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] on the <xref:System.Windows.Input.Mouse> class are <xref:System.Windows.Input.Mouse.MiddleButton%2A>, which obtains the state of the middle mouse button, and <xref:System.Windows.Input.Mouse.DirectlyOver%2A>, which gets the element the mouse pointer is currently over."},{"pos":[4509,4684],"content":"The following example determines whether the <ph id=\"ph1\">&lt;xref:System.Windows.Input.Mouse.LeftButton%2A&gt;</ph> on the mouse is in the <ph id=\"ph2\">&lt;xref:System.Windows.Input.MouseButtonState.Pressed&gt;</ph> state.","source":"The following example determines whether the <xref:System.Windows.Input.Mouse.LeftButton%2A> on the mouse is in the <xref:System.Windows.Input.MouseButtonState.Pressed> state."},{"pos":[5100,5239],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.Mouse&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Input.Keyboard&gt;</ph> classes are covered in more detail throughout this overview.","source":"The <xref:System.Windows.Input.Mouse> and <xref:System.Windows.Input.Keyboard> classes are covered in more detail throughout this overview."},{"pos":[5245,5257],"content":"Stylus Input","linkify":"Stylus Input","nodes":[{"content":"Stylus Input","pos":[0,12]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> has integrated support for the <ph id=\"ph2\">&lt;xref:System.Windows.Input.Stylus&gt;</ph>.","pos":[5259,5407],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] has integrated support for the <xref:System.Windows.Input.Stylus>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.Stylus&gt;</ph> is a pen input made popular by the <ph id=\"ph2\">[!INCLUDE[TLA#tla_tpc](../../../../includes/tlasharptla-tpc-md.md)]</ph>.","pos":[5409,5551],"source":"  The <xref:System.Windows.Input.Stylus> is a pen input made popular by the [!INCLUDE[TLA#tla_tpc](../../../../includes/tlasharptla-tpc-md.md)]."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> applications can treat the stylus as a mouse by using the mouse <ph id=\"ph2\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph>, but <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> also exposes a stylus device abstraction that use a model similar to the keyboard and mouse.","pos":[5553,5948],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications can treat the stylus as a mouse by using the mouse [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)], but [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] also exposes a stylus device abstraction that use a model similar to the keyboard and mouse."},{"content":"All stylus-related <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)]</ph> contain the word \"Stylus\".","pos":[5950,6083],"source":"  All stylus-related [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] contain the word \"Stylus\"."},{"content":"Because the stylus can act as a mouse, applications that support only mouse input can still obtain some level of stylus support automatically.","pos":[6086,6228]},{"content":"When the stylus is used in such a manner, the application is given the opportunity to handle the appropriate stylus event and then handles the corresponding mouse event.","pos":[6229,6398]},{"content":"In addition, higher-level services such as ink input are also available through the stylus device abstraction.","pos":[6399,6509]},{"content":"For more information about ink as input, see <bpt id=\"p1\">[</bpt>Getting Started with Ink<ept id=\"p1\">](getting-started-with-ink.md)</ept>.","pos":[6511,6612],"source":"  For more information about ink as input, see [Getting Started with Ink](getting-started-with-ink.md)."},{"pos":[6646,6659],"content":"Event Routing","linkify":"Event Routing","nodes":[{"content":"Event Routing","pos":[0,13]}]},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> can contain other elements as child elements in its content model, forming a tree of elements.","pos":[6661,6796],"source":"A <xref:System.Windows.FrameworkElement> can contain other elements as child elements in its content model, forming a tree of elements."},{"content":"In <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>, the parent element can participate in input directed to its child elements or other descendants by handing events.","pos":[6798,6998],"source":"  In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the parent element can participate in input directed to its child elements or other descendants by handing events."},{"content":"This is especially useful for building controls out of smaller controls, a process known as \"control composition\" or \"compositing.\"","pos":[6999,7130]},{"content":"For more information about element trees and how element trees relate to event routes, see <bpt id=\"p1\">[</bpt>Trees in WPF<ept id=\"p1\">](trees-in-wpf.md)</ept>.","pos":[7131,7254],"source":" For more information about element trees and how element trees relate to event routes, see [Trees in WPF](trees-in-wpf.md)."},{"content":"Event routing is the process of forwarding events to multiple elements, so that a particular object or element along the route can choose to offer a significant response (through handling) to an event that might have been sourced by a different element.","pos":[7257,7510]},{"content":"Routed events use one of three routing mechanisms: direct, bubbling, and tunneling.","pos":[7512,7595]},{"content":"In direct routing, the source element is the only element notified, and the event is not routed to any other elements.","pos":[7597,7715]},{"content":"However, the direct routed event still offers some additional capabilities that are only present for routed events as opposed to standard <ph id=\"ph1\">[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]</ph> events.","pos":[7716,7931],"source":" However, the direct routed event still offers some additional capabilities that are only present for routed events as opposed to standard [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] events."},{"content":"Bubbling works up the element tree by first notifying the element that sourced the event, then the parent element, and so on.","pos":[7932,8057]},{"content":"Tunneling starts at the root of the element tree and works down, ending with the original source element.","pos":[8059,8164]},{"content":"For more information about routed events, see <bpt id=\"p1\">[</bpt>Routed Events Overview<ept id=\"p1\">](routed-events-overview.md)</ept>.","pos":[8166,8264],"source":"  For more information about routed events, see [Routed Events Overview](routed-events-overview.md)."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> input events generally come in pairs that consists of a tunneling event and a bubbling event.","pos":[8267,8442],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input events generally come in pairs that consists of a tunneling event and a bubbling event."},{"content":"Tunneling events are distinguished from bubbling events with the \"Preview\" prefix.","pos":[8444,8526]},{"content":"For instance, <ph id=\"ph1\">&lt;xref:System.Windows.Input.Mouse.PreviewMouseMove&gt;</ph> is the tunneling version of a mouse move event and <ph id=\"ph2\">&lt;xref:System.Windows.Input.Mouse.MouseMove&gt;</ph> is the bubbling version of this event.","pos":[8528,8726],"source":"  For instance, <xref:System.Windows.Input.Mouse.PreviewMouseMove> is the tunneling version of a mouse move event and <xref:System.Windows.Input.Mouse.MouseMove> is the bubbling version of this event."},{"content":"This event pairing is a convention that is implemented at the element level and is not an inherent capability of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> event system.","pos":[8727,8939],"source":" This event pairing is a convention that is implemented at the element level and is not an inherent capability of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system."},{"content":"For details, see the WPF Input Events section in <bpt id=\"p1\">[</bpt>Routed Events Overview<ept id=\"p1\">](routed-events-overview.md)</ept>.","pos":[8940,9041],"source":" For details, see the WPF Input Events section in [Routed Events Overview](routed-events-overview.md)."},{"pos":[9083,9104],"content":"Handling Input Events","linkify":"Handling Input Events","nodes":[{"content":"Handling Input Events","pos":[0,21]}]},{"content":"To receive input on an element, an event handler must be associated with that particular event.","pos":[9106,9201]},{"content":"In <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> this is straightforward: you reference the name of the event as an attribute of the element that will be listening for this event.","pos":[9203,9408],"source":"  In [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] this is straightforward: you reference the name of the event as an attribute of the element that will be listening for this event."},{"content":"Then, you set the value of the attribute to the name of the event handler that you define, based on a delegate.","pos":[9410,9521]},{"content":"The event handler must be written in code such as C# and can be included in a code-behind file.","pos":[9523,9618]},{"content":"Keyboard events occur when the operating system reports key actions that occur while keyboard focus is on an element.","pos":[9621,9738]},{"content":"Mouse and stylus events each fall into two categories: events that report changes in pointer position relative to the element, and events that report changes in the state of device buttons.","pos":[9739,9928]},{"pos":[9934,9962],"content":"Keyboard Input Event Example","linkify":"Keyboard Input Event Example","nodes":[{"content":"Keyboard Input Event Example","pos":[0,28]}]},{"content":"The following example listens for a left arrow key press.","pos":[9964,10021]},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Controls.StackPanel&gt;</ph> is created that has a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Button&gt;</ph>.","pos":[10023,10127],"source":"  A <xref:System.Windows.Controls.StackPanel> is created that has a <xref:System.Windows.Controls.Button>."},{"content":"An event handler to listen for the left arrow key press is attached to the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button&gt;</ph> instance.","pos":[10129,10251],"source":"  An event handler to listen for the left arrow key press is attached to the <xref:System.Windows.Controls.Button> instance."},{"pos":[10254,10466],"content":"The first section of the example creates the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.StackPanel&gt;</ph> and the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Button&gt;</ph> and attaches the event handler for the <ph id=\"ph3\">&lt;xref:System.Windows.UIElement.KeyDown&gt;</ph>.","source":"The first section of the example creates the <xref:System.Windows.Controls.StackPanel> and the <xref:System.Windows.Controls.Button> and attaches the event handler for the <xref:System.Windows.UIElement.KeyDown>."},{"content":"The second section is written in code and defines the event handler.","pos":[10975,11043]},{"content":"When the left arrow key is pressed and the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button&gt;</ph> has keyboard focus, the handler runs and the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Control.Background%2A&gt;</ph> color of the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Button&gt;</ph> is changed.","pos":[11045,11286],"source":"  When the left arrow key is pressed and the <xref:System.Windows.Controls.Button> has keyboard focus, the handler runs and the <xref:System.Windows.Controls.Control.Background%2A> color of the <xref:System.Windows.Controls.Button> is changed."},{"content":"If the key is pressed, but it is not the left arrow key, the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Control.Background%2A&gt;</ph> color of the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Button&gt;</ph> is changed back to its starting color.","pos":[11288,11491],"source":"  If the key is pressed, but it is not the left arrow key, the <xref:System.Windows.Controls.Control.Background%2A> color of the <xref:System.Windows.Controls.Button> is changed back to its starting color."},{"pos":[11870,11895],"content":"Mouse Input Event Example","linkify":"Mouse Input Event Example","nodes":[{"content":"Mouse Input Event Example","pos":[0,25]}]},{"content":"In the following example, the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Control.Background%2A&gt;</ph> color of a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Button&gt;</ph> is changed when the mouse pointer enters the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Button&gt;</ph>.","pos":[11897,12112],"source":"In the following example, the <xref:System.Windows.Controls.Control.Background%2A> color of a <xref:System.Windows.Controls.Button> is changed when the mouse pointer enters the <xref:System.Windows.Controls.Button>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Control.Background%2A&gt;</ph> color is restored when the mouse leaves the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Button&gt;</ph>.","pos":[12114,12253],"source":"  The <xref:System.Windows.Controls.Control.Background%2A> color is restored when the mouse leaves the <xref:System.Windows.Controls.Button>."},{"pos":[12256,12579],"content":"The first section of the example creates the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.StackPanel&gt;</ph> and the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Button&gt;</ph> control and attaches the event handlers for the <ph id=\"ph3\">&lt;xref:System.Windows.UIElement.MouseEnter&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.UIElement.MouseLeave&gt;</ph> events to the <ph id=\"ph5\">&lt;xref:System.Windows.Controls.Button&gt;</ph>.","source":"The first section of the example creates the <xref:System.Windows.Controls.StackPanel> and the <xref:System.Windows.Controls.Button> control and attaches the event handlers for the <xref:System.Windows.UIElement.MouseEnter> and <xref:System.Windows.UIElement.MouseLeave> events to the <xref:System.Windows.Controls.Button>."},{"content":"The second section of the example is written in code and defines the event handlers.","pos":[13070,13154]},{"content":"When the mouse enters the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button&gt;</ph>, the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Control.Background%2A&gt;</ph> color of the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Button&gt;</ph> is changed to <ph id=\"ph4\">&lt;xref:System.Windows.Media.Brushes.SlateGray%2A&gt;</ph>.","pos":[13156,13392],"source":"  When the mouse enters the <xref:System.Windows.Controls.Button>, the <xref:System.Windows.Controls.Control.Background%2A> color of the <xref:System.Windows.Controls.Button> is changed to <xref:System.Windows.Media.Brushes.SlateGray%2A>."},{"content":"When the mouse leaves the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button&gt;</ph>, the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Control.Background%2A&gt;</ph> color of the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Button&gt;</ph> is changed back to <ph id=\"ph4\">&lt;xref:System.Windows.Media.Brushes.AliceBlue%2A&gt;</ph>.","pos":[13394,13635],"source":"  When the mouse leaves the <xref:System.Windows.Controls.Button>, the <xref:System.Windows.Controls.Control.Background%2A> color of the <xref:System.Windows.Controls.Button> is changed back to <xref:System.Windows.Media.Brushes.AliceBlue%2A>."},{"pos":[14352,14362],"content":"Text Input","linkify":"Text Input","nodes":[{"content":"Text Input","pos":[0,10]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.ContentElement.TextInput&gt;</ph> event enables you to listen for text input in a device-independent manner.","pos":[14364,14489],"source":"The <xref:System.Windows.ContentElement.TextInput> event enables you to listen for text input in a device-independent manner."},{"content":"The keyboard is the primary means of text input, but speech, handwriting, and other input devices can generate text input also.","pos":[14490,14617]},{"content":"For keyboard input, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> first sends the appropriate <ph id=\"ph2\">&lt;xref:System.Windows.ContentElement.KeyDown&gt;</ph><ph id=\"ph3\">/</ph><ph id=\"ph4\">&lt;xref:System.Windows.ContentElement.KeyUp&gt;</ph> events.","pos":[14620,14845],"source":"For keyboard input, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] first sends the appropriate <xref:System.Windows.ContentElement.KeyDown>/<xref:System.Windows.ContentElement.KeyUp> events."},{"content":"If those events are not handled and the key is textual (rather than a control key such as directional arrows or function keys), then a <ph id=\"ph1\">&lt;xref:System.Windows.ContentElement.TextInput&gt;</ph> event is raised.","pos":[14846,15044],"source":" If those events are not handled and the key is textual (rather than a control key such as directional arrows or function keys), then a <xref:System.Windows.ContentElement.TextInput> event is raised."},{"content":"There is not always a simple one-to-one mapping between <ph id=\"ph1\">&lt;xref:System.Windows.ContentElement.KeyDown&gt;</ph><ph id=\"ph2\">/</ph><ph id=\"ph3\">&lt;xref:System.Windows.ContentElement.KeyUp&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.ContentElement.TextInput&gt;</ph> events because multiple keystrokes can generate a single character of text input and single keystrokes can generate multi-character strings.","pos":[15046,15381],"source":"  There is not always a simple one-to-one mapping between <xref:System.Windows.ContentElement.KeyDown>/<xref:System.Windows.ContentElement.KeyUp> and <xref:System.Windows.ContentElement.TextInput> events because multiple keystrokes can generate a single character of text input and single keystrokes can generate multi-character strings."},{"content":"This is especially true for languages such as Chinese, Japanese, and Korean which use <ph id=\"ph1\">[!INCLUDE[TLA#tla_ime#plural](../../../../includes/tlasharptla-imesharpplural-md.md)]</ph> to generate the thousands of possible characters in their corresponding alphabets.","pos":[15383,15637],"source":"  This is especially true for languages such as Chinese, Japanese, and Korean which use [!INCLUDE[TLA#tla_ime#plural](../../../../includes/tlasharptla-imesharpplural-md.md)] to generate the thousands of possible characters in their corresponding alphabets."},{"content":"When <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> sends a <ph id=\"ph2\">&lt;xref:System.Windows.ContentElement.KeyUp&gt;</ph><ph id=\"ph3\">/</ph><ph id=\"ph4\">&lt;xref:System.Windows.ContentElement.KeyDown&gt;</ph> event, <ph id=\"ph5\">&lt;xref:System.Windows.Input.KeyEventArgs.Key%2A&gt;</ph> is set to <ph id=\"ph6\">&lt;xref:System.Windows.Input.Key.System?displayProperty=nameWithType&gt;</ph> if the keystrokes could become part of a <ph id=\"ph7\">&lt;xref:System.Windows.ContentElement.TextInput&gt;</ph> event (if ALT+S is pressed, for example).","pos":[15640,16085],"source":"When [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sends a <xref:System.Windows.ContentElement.KeyUp>/<xref:System.Windows.ContentElement.KeyDown> event, <xref:System.Windows.Input.KeyEventArgs.Key%2A> is set to <xref:System.Windows.Input.Key.System?displayProperty=nameWithType> if the keystrokes could become part of a <xref:System.Windows.ContentElement.TextInput> event (if ALT+S is pressed, for example)."},{"content":"This allows code in a <ph id=\"ph1\">&lt;xref:System.Windows.ContentElement.KeyDown&gt;</ph> event handler to check for <ph id=\"ph2\">&lt;xref:System.Windows.Input.Key.System?displayProperty=nameWithType&gt;</ph> and, if found, leave processing for the handler of the subsequently raised <ph id=\"ph3\">&lt;xref:System.Windows.ContentElement.TextInput&gt;</ph> event.","pos":[16086,16376],"source":" This allows code in a <xref:System.Windows.ContentElement.KeyDown> event handler to check for <xref:System.Windows.Input.Key.System?displayProperty=nameWithType> and, if found, leave processing for the handler of the subsequently raised <xref:System.Windows.ContentElement.TextInput> event."},{"content":"In these cases, the various properties of the <ph id=\"ph1\">&lt;xref:System.Windows.Input.TextCompositionEventArgs&gt;</ph> argument can be used to determine the original keystrokes.","pos":[16377,16534],"source":" In these cases, the various properties of the <xref:System.Windows.Input.TextCompositionEventArgs> argument can be used to determine the original keystrokes."},{"content":"Similarly, if an <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ime](../../../../includes/tla2sharptla-ime-md.md)]</ph> is active, <ph id=\"ph2\">&lt;xref:System.Windows.Input.Key&gt;</ph> has the value of <ph id=\"ph3\">&lt;xref:System.Windows.Input.Key.ImeProcessed?displayProperty=nameWithType&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Windows.Input.KeyEventArgs.ImeProcessedKey%2A&gt;</ph> gives the original keystroke or keystrokes.","pos":[16535,16864],"source":" Similarly, if an [!INCLUDE[TLA2#tla_ime](../../../../includes/tla2sharptla-ime-md.md)] is active, <xref:System.Windows.Input.Key> has the value of <xref:System.Windows.Input.Key.ImeProcessed?displayProperty=nameWithType>, and <xref:System.Windows.Input.KeyEventArgs.ImeProcessedKey%2A> gives the original keystroke or keystrokes."},{"pos":[16867,17048],"content":"The following example defines a handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase.Click&gt;</ph> event and a handler for the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.KeyDown&gt;</ph> event.","source":"The following example defines a handler for the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event and a handler for the <xref:System.Windows.UIElement.KeyDown> event."},{"content":"The first segment of code or markup creates the user interface.","pos":[17051,17114]},{"content":"The second segment of code contains the event handlers.","pos":[17587,17642]},{"content":"Because input events bubble up the event route, the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.StackPanel&gt;</ph> receives the input regardless of which element has keyboard focus.","pos":[17998,18158],"source":"Because input events bubble up the event route, the <xref:System.Windows.Controls.StackPanel> receives the input regardless of which element has keyboard focus."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> control is notified first and the <ph id=\"ph2\">`OnTextInputKeyDown`</ph> handler is called only if the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> did not handle the input.","pos":[18159,18351],"source":" The <xref:System.Windows.Controls.TextBox> control is notified first and the `OnTextInputKeyDown` handler is called only if the <xref:System.Windows.Controls.TextBox> did not handle the input."},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.PreviewKeyDown&gt;</ph> event is used instead of the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.KeyDown&gt;</ph> event, the <ph id=\"ph3\">`OnTextInputKeyDown`</ph> handler is called first.","pos":[18352,18531],"source":" If the <xref:System.Windows.UIElement.PreviewKeyDown> event is used instead of the <xref:System.Windows.UIElement.KeyDown> event, the `OnTextInputKeyDown` handler is called first."},{"content":"In this example, the handling logic is written two timesâ€”one time for CTRL+O, and again for button's click event.","pos":[18534,18647]},{"content":"This can be simplified by using commands, instead of handling the input events directly.","pos":[18648,18736]},{"content":"Commands are discussed in this overview and in <bpt id=\"p1\">[</bpt>Commanding Overview<ept id=\"p1\">](commanding-overview.md)</ept>.","pos":[18738,18831],"source":"  Commands are discussed in this overview and in [Commanding Overview](commanding-overview.md)."},{"pos":[18874,18896],"content":"Touch and Manipulation","linkify":"Touch and Manipulation","nodes":[{"content":"Touch and Manipulation","pos":[0,22]}]},{"content":"New hardware and API in the Windows 7 operating system provide applications the ability to receive input from multiple touches simultaneously.","pos":[18898,19040]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> enables applications to detect and respond to touch in a manner similar to responding to other input, such as the mouse or keyboard, by raising events when touch occurs.","pos":[19041,19292],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] enables applications to detect and respond to touch in a manner similar to responding to other input, such as the mouse or keyboard, by raising events when touch occurs."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> exposes two types of events when touch occurs: touch events and manipulation events.","pos":[19295,19461],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] exposes two types of events when touch occurs: touch events and manipulation events."},{"content":"Touch events provide raw data about each finger on a touchscreen and its movement.","pos":[19462,19544]},{"content":"Manipulation events interpret the input as certain actions.","pos":[19545,19604]},{"content":"Both types of events are discussed in this section.","pos":[19605,19656]},{"pos":[19662,19675],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to develop an application that responds to touch.","pos":[19677,19760]},{"content":"Visual Studio 2010.","pos":[19766,19785]},{"content":"Windows 7.","pos":[19791,19801]},{"content":"A device, such as a touchscreen, that supports Windows Touch.","pos":[19807,19868]},{"pos":[19874,19885],"content":"Terminology","linkify":"Terminology","nodes":[{"content":"Terminology","pos":[0,11]}]},{"content":"The following terms are used when touch is discussed.","pos":[19887,19940]},{"content":"<bpt id=\"p1\">**</bpt>Touch<ept id=\"p1\">**</ept> is a type of user input that is recognized by Windows 7.","pos":[19946,20012],"source":"**Touch** is a type of user input that is recognized by Windows 7."},{"content":"Usually, touch is initiated by putting fingers on a touch-sensitive screen.","pos":[20013,20088]},{"content":"Note that devices such as a touchpad that is common on laptop computers do not support touch if the device merely converts the finger's position and movement as mouse input.","pos":[20089,20262]},{"content":"<bpt id=\"p1\">**</bpt>Multitouch<ept id=\"p1\">**</ept> is touch that occurs from more than one point simultaneously.","pos":[20268,20344],"source":"**Multitouch** is touch that occurs from more than one point simultaneously."},{"content":"Windows 7 and <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> supports multitouch.","pos":[20345,20461],"source":" Windows 7 and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] supports multitouch."},{"content":"Whenever touch is discussed in the documentation for <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>, the concepts apply to multitouch.","pos":[20462,20631],"source":" Whenever touch is discussed in the documentation for [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the concepts apply to multitouch."},{"content":"A <bpt id=\"p1\">**</bpt>manipulation<ept id=\"p1\">**</ept> occurs when touch is interpreted as a physical action that is applied to an object.","pos":[20637,20739],"source":"A **manipulation** occurs when touch is interpreted as a physical action that is applied to an object."},{"content":"In <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>, manipulation events interpret input as a translation, expansion, or rotation manipulation.","pos":[20740,20916],"source":" In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], manipulation events interpret input as a translation, expansion, or rotation manipulation."},{"pos":[20922,21027],"content":"A <ph id=\"ph1\">`touch device`</ph> represents a device that produces touch input, such as a single finger on a touchscreen.","source":"A `touch device` represents a device that produces touch input, such as a single finger on a touchscreen."},{"pos":[21033,21063],"content":"Controls that Respond to Touch","linkify":"Controls that Respond to Touch","nodes":[{"content":"Controls that Respond to Touch","pos":[0,30]}]},{"content":"The following controls can be scrolled by dragging a finger across the control if it has content that is scrolled out of view.","pos":[21065,21191]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ScrollViewer&gt;</ph> defines the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ScrollViewer.PanningMode%2A?displayProperty=nameWithType&gt;</ph> attached property that enables you to specify whether touch panning is enabled horizontally, vertically, both, or neither.","pos":[21599,21869],"source":"The <xref:System.Windows.Controls.ScrollViewer> defines the <xref:System.Windows.Controls.ScrollViewer.PanningMode%2A?displayProperty=nameWithType> attached property that enables you to specify whether touch panning is enabled horizontally, vertically, both, or neither."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ScrollViewer.PanningDeceleration%2A?displayProperty=nameWithType&gt;</ph> property specifies how quickly the scrolling slows down when the user lifts the finger from the touchscreen.","pos":[21870,22078],"source":" The <xref:System.Windows.Controls.ScrollViewer.PanningDeceleration%2A?displayProperty=nameWithType> property specifies how quickly the scrolling slows down when the user lifts the finger from the touchscreen."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ScrollViewer.PanningRatio%2A?displayProperty=nameWithType&gt;</ph> attached property specifies the ratio of scrolling offset to translate manipulation offset.","pos":[22079,22263],"source":" The <xref:System.Windows.Controls.ScrollViewer.PanningRatio%2A?displayProperty=nameWithType> attached property specifies the ratio of scrolling offset to translate manipulation offset."},{"pos":[22269,22281],"content":"Touch Events","linkify":"Touch Events","nodes":[{"content":"Touch Events","pos":[0,12]}]},{"content":"The base classes, <ph id=\"ph1\">&lt;xref:System.Windows.UIElement&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.UIElement3D&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Windows.ContentElement&gt;</ph>, define events that you can subscribe to so your application will respond to touch.","pos":[22283,22493],"source":"The base classes, <xref:System.Windows.UIElement>, <xref:System.Windows.UIElement3D>, and <xref:System.Windows.ContentElement>, define events that you can subscribe to so your application will respond to touch."},{"content":"Touch events are useful when your application interprets touch as something other than manipulating an object.","pos":[22494,22604]},{"content":"For example, an application that enables a user to draw with one or more fingers would subscribe to touch events.","pos":[22605,22718]},{"content":"All three classes define the following events, which behave similarly, regardless of the defining class.","pos":[22721,22825]},{"content":"Like keyboard and mouse events, the touch events are routed events.","pos":[23330,23397]},{"content":"The events that begin with <ph id=\"ph1\">`Preview`</ph> are tunneling events and the events that begin with <ph id=\"ph2\">`Touch`</ph> are bubbling events.","pos":[23398,23515],"source":" The events that begin with `Preview` are tunneling events and the events that begin with `Touch` are bubbling events."},{"content":"For more information about routed events, see <bpt id=\"p1\">[</bpt>Routed Events Overview<ept id=\"p1\">](routed-events-overview.md)</ept>.","pos":[23516,23614],"source":" For more information about routed events, see [Routed Events Overview](routed-events-overview.md)."},{"content":"When you handle these events, you can get the position of the input, relative to any element, by calling the <ph id=\"ph1\">&lt;xref:System.Windows.Input.TouchEventArgs.GetTouchPoint%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Input.TouchEventArgs.GetIntermediateTouchPoints%2A&gt;</ph> method.","pos":[23615,23867],"source":" When you handle these events, you can get the position of the input, relative to any element, by calling the <xref:System.Windows.Input.TouchEventArgs.GetTouchPoint%2A> or <xref:System.Windows.Input.TouchEventArgs.GetIntermediateTouchPoints%2A> method."},{"content":"To understand the interaction among the touch events, consider the scenario where a user puts one finger on an element, moves the finger in the element, and then lifts the finger from the element.","pos":[23870,24066]},{"content":"The following illustration shows the execution of the bubbling events (the tunneling events are omitted for simplicity).","pos":[24067,24187]},{"pos":[24190,24282],"content":"<bpt id=\"p1\">![</bpt>The sequence of touch events.<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/ndp-touchevents.png \"</bpt>NDP_TouchEvents<ept id=\"p2\">\")</ept> Touch events","source":"![The sequence of touch events.](./media/ndp-touchevents.png \"NDP_TouchEvents\")\nTouch events"},{"content":"The following list describes the sequence of the events in the preceding illustration.","pos":[24285,24371]},{"pos":[24377,24489],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.TouchEnter&gt;</ph> event occurs one time when the user puts a finger on the element.","source":"The <xref:System.Windows.UIElement.TouchEnter> event occurs one time when the user puts a finger on the element."},{"pos":[24495,24563],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.TouchDown&gt;</ph> event occurs one time.","source":"The <xref:System.Windows.UIElement.TouchDown> event occurs one time."},{"pos":[24569,24691],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.TouchMove&gt;</ph> event occurs multiple times as the user moves the finger within the element.","source":"The <xref:System.Windows.UIElement.TouchMove> event occurs multiple times as the user moves the finger within the element."},{"pos":[24697,24811],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.TouchUp&gt;</ph> event occurs one time when the user lifts the finger from the element.","source":"The <xref:System.Windows.UIElement.TouchUp> event occurs one time when the user lifts the finger from the element."},{"pos":[24817,24886],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.TouchLeave&gt;</ph> event occurs one time.","source":"The <xref:System.Windows.UIElement.TouchLeave> event occurs one time."},{"content":"When more than two fingers are used, the events occur for each finger.","pos":[24889,24959]},{"pos":[24965,24984],"content":"Manipulation Events","linkify":"Manipulation Events","nodes":[{"content":"Manipulation Events","pos":[0,19]}]},{"content":"For cases where an application enables a user to manipulate an object, the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement&gt;</ph> class defines manipulation events.","pos":[24986,25127],"source":"For cases where an application enables a user to manipulate an object, the <xref:System.Windows.UIElement> class defines manipulation events."},{"content":"Unlike the touch events that simply report the position of touch, the manipulation events report how the input can be interpreted.","pos":[25128,25258]},{"content":"There are three types of manipulations, translation, expansion, and rotation.","pos":[25259,25336]},{"content":"The following list describes how to invoke the three types of manipulations.","pos":[25337,25413]},{"content":"Put a finger on an object and move the finger across the touchscreen to invoke a translation manipulation.","pos":[25419,25525]},{"content":"This usually moves the object.","pos":[25526,25556]},{"content":"Put two fingers on an object and move the fingers closer together or farther apart from one another to invoke an expansion manipulation.","pos":[25562,25698]},{"content":"This usually resizes the object.","pos":[25699,25731]},{"content":"Put two fingers on an object and rotate the fingers around each other to invoke a rotation manipulation.","pos":[25737,25841]},{"content":"This usually rotates the object.","pos":[25842,25874]},{"content":"More than one type of manipulation can occur simultaneously.","pos":[25877,25937]},{"content":"When you cause objects to respond to manipulations, you can have the object appear to have inertia.","pos":[25940,26039]},{"content":"This can make your objects simulate the physical world.","pos":[26040,26095]},{"content":"For example, when you push a book across a table, if you push hard enough the book will continue to move after you release it.","pos":[26096,26222]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> enables you to simulate this behavior by raising manipulation events after the user's fingers releases the object.","pos":[26223,26419],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] enables you to simulate this behavior by raising manipulation events after the user's fingers releases the object."},{"pos":[26422,26645],"content":"For information about how to create an application that enables the user to move, resize, and rotate an object, see <bpt id=\"p1\">[</bpt>Walkthrough: Creating Your First Touch Application<ept id=\"p1\">](walkthrough-creating-your-first-touch-application.md)</ept>.","source":"For information about how to create an application that enables the user to move, resize, and rotate an object, see [Walkthrough: Creating Your First Touch Application](walkthrough-creating-your-first-touch-application.md)."},{"pos":[26648,26726],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement&gt;</ph> defines the following manipulation events.","source":"The <xref:System.Windows.UIElement> defines the following manipulation events."},{"content":"By default, a <ph id=\"ph1\">&lt;xref:System.Windows.UIElement&gt;</ph> does not receive these manipulation events.","pos":[27089,27178],"source":"By default, a <xref:System.Windows.UIElement> does not receive these manipulation events."},{"content":"To receive manipulation events on a <ph id=\"ph1\">&lt;xref:System.Windows.UIElement&gt;</ph>, set <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.IsManipulationEnabled%2A?displayProperty=nameWithType&gt;</ph> to <ph id=\"ph3\">`true`</ph>.","pos":[27179,27348],"source":" To receive manipulation events on a <xref:System.Windows.UIElement>, set <xref:System.Windows.UIElement.IsManipulationEnabled%2A?displayProperty=nameWithType> to `true`."},{"pos":[27355,27396],"content":"The Execution Path of Manipulation Events","linkify":"The Execution Path of Manipulation Events","nodes":[{"content":"The Execution Path of Manipulation Events","pos":[0,41]}]},{"content":"Consider a scenario where a user \"throws\" an object.","pos":[27398,27450]},{"content":"The user puts a finger on the object, moves the finger across the touchscreen for a short distance, and then lifts the finger while it is moving.","pos":[27451,27596]},{"content":"The result of this is that the object will move under the user's finger and continue to move after the user lifts the finger.","pos":[27597,27722]},{"content":"The following illustration shows the execution path of manipulation events and important information about each event.","pos":[27725,27843]},{"pos":[27846,27966],"content":"<bpt id=\"p1\">![</bpt>The sequence of manipulation events.<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/ndp-manipulationevents.png \"</bpt>NDP_ManipulationEvents<ept id=\"p2\">\")</ept> Manipulation events","source":"![The sequence of manipulation events.](./media/ndp-manipulationevents.png \"NDP_ManipulationEvents\")\nManipulation events"},{"content":"The following list describes the sequence of the events in the preceding illustration.","pos":[27969,28055]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.ManipulationStarting&gt;</ph> event occurs when the user places a finger on the object.","pos":[28061,28175],"source":"The <xref:System.Windows.UIElement.ManipulationStarting> event occurs when the user places a finger on the object."},{"content":"Among other things, this event allows you to set the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ManipulationStartingEventArgs.ManipulationContainer%2A&gt;</ph> property.","pos":[28176,28321],"source":" Among other things, this event allows you to set the <xref:System.Windows.Input.ManipulationStartingEventArgs.ManipulationContainer%2A> property."},{"content":"In the subsequent events, the position of the manipulation will be relative to the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ManipulationStartingEventArgs.ManipulationContainer%2A&gt;</ph>.","pos":[28322,28488],"source":" In the subsequent events, the position of the manipulation will be relative to the <xref:System.Windows.Input.ManipulationStartingEventArgs.ManipulationContainer%2A>."},{"content":"In events other than <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.ManipulationStarting&gt;</ph>, this property is read-only, so the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.ManipulationStarting&gt;</ph> event is the only time that you can set this property.","pos":[28489,28706],"source":" In events other than <xref:System.Windows.UIElement.ManipulationStarting>, this property is read-only, so the <xref:System.Windows.UIElement.ManipulationStarting> event is the only time that you can set this property."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.ManipulationStarted&gt;</ph> event occurs next.","pos":[28712,28786],"source":"The <xref:System.Windows.UIElement.ManipulationStarted> event occurs next."},{"content":"This event reports the origin of the manipulation.","pos":[28787,28837]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.ManipulationDelta&gt;</ph> event occurs multiple times as a user's fingers move on a touchscreen.","pos":[28843,28967],"source":"The <xref:System.Windows.UIElement.ManipulationDelta> event occurs multiple times as a user's fingers move on a touchscreen."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.ManipulationDeltaEventArgs.DeltaManipulation%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Input.ManipulationDeltaEventArgs&gt;</ph> class reports whether the manipulation is interpreted as movement, expansion, or translation.","pos":[28968,29212],"source":" The <xref:System.Windows.Input.ManipulationDeltaEventArgs.DeltaManipulation%2A> property of the <xref:System.Windows.Input.ManipulationDeltaEventArgs> class reports whether the manipulation is interpreted as movement, expansion, or translation."},{"content":"This is where you perform most of the work of manipulating an object.","pos":[29213,29282]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.ManipulationInertiaStarting&gt;</ph> event occurs when the user's fingers lose contact with the object.","pos":[29288,29418],"source":"The <xref:System.Windows.UIElement.ManipulationInertiaStarting> event occurs when the user's fingers lose contact with the object."},{"content":"This event enables you to specify the deceleration of the manipulations during inertia.","pos":[29419,29506]},{"content":"This is so your object can emulate different physical spaces or attributes if you choose.","pos":[29507,29596]},{"content":"For example, suppose your application has two objects that represent items in the physical world, and one is heavier than the other.","pos":[29597,29729]},{"content":"You can make the heavier object decelerate faster than the lighter object.","pos":[29730,29804]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.ManipulationDelta&gt;</ph> event occurs multiple times as inertia occurs.","pos":[29810,29910],"source":"The <xref:System.Windows.UIElement.ManipulationDelta> event occurs multiple times as inertia occurs."},{"content":"Note that this event occurs when the user's fingers move across the touchscreen and when <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> simulates inertia.","pos":[29911,30100],"source":" Note that this event occurs when the user's fingers move across the touchscreen and when [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] simulates inertia."},{"content":"In other words, <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.ManipulationDelta&gt;</ph> occurs before and after the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.ManipulationInertiaStarting&gt;</ph> event.","pos":[30101,30261],"source":" In other words, <xref:System.Windows.UIElement.ManipulationDelta> occurs before and after the <xref:System.Windows.UIElement.ManipulationInertiaStarting> event."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.ManipulationDeltaEventArgs.IsInertial%2A?displayProperty=nameWithType&gt;</ph> property reports whether the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.ManipulationDelta&gt;</ph> event occurs during inertia, so you can check that property and perform different actions, depending on its value.","pos":[30262,30557],"source":" The <xref:System.Windows.Input.ManipulationDeltaEventArgs.IsInertial%2A?displayProperty=nameWithType> property reports whether the <xref:System.Windows.UIElement.ManipulationDelta> event occurs during inertia, so you can check that property and perform different actions, depending on its value."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.ManipulationCompleted&gt;</ph> event occurs when the manipulation and any inertia ends.","pos":[30563,30677],"source":"The <xref:System.Windows.UIElement.ManipulationCompleted> event occurs when the manipulation and any inertia ends."},{"content":"That is, after all the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.ManipulationDelta&gt;</ph> events occur, the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.ManipulationCompleted&gt;</ph> event occurs to signal that the manipulation is complete.","pos":[30678,30880],"source":" That is, after all the <xref:System.Windows.UIElement.ManipulationDelta> events occur, the <xref:System.Windows.UIElement.ManipulationCompleted> event occurs to signal that the manipulation is complete."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement&gt;</ph> also defines the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.ManipulationBoundaryFeedback&gt;</ph> event.","pos":[30883,31003],"source":"The <xref:System.Windows.UIElement> also defines the <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> event."},{"content":"This event occurs when the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ManipulationDeltaEventArgs.ReportBoundaryFeedback%2A&gt;</ph> method is called in the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.ManipulationDelta&gt;</ph> event.","pos":[31004,31192],"source":" This event occurs when the <xref:System.Windows.Input.ManipulationDeltaEventArgs.ReportBoundaryFeedback%2A> method is called in the <xref:System.Windows.UIElement.ManipulationDelta> event."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.ManipulationBoundaryFeedback&gt;</ph> event enables applications or components to provide visual feedback when an object hits a boundary.","pos":[31193,31357],"source":" The <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> event enables applications or components to provide visual feedback when an object hits a boundary."},{"content":"For example, the <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> class handles the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.ManipulationBoundaryFeedback&gt;</ph> event to cause the window to slightly move when its edge is encountered.","pos":[31358,31555],"source":" For example, the <xref:System.Windows.Window> class handles the <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> event to cause the window to slightly move when its edge is encountered."},{"content":"You can cancel the manipulation by calling the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A&gt;</ph> method on the event arguments in any manipulation event except <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.ManipulationBoundaryFeedback&gt;</ph> event.","pos":[31558,31803],"source":"You can cancel the manipulation by calling the <xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A> method on the event arguments in any manipulation event except <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> event."},{"content":"When you call <ph id=\"ph1\">&lt;xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A&gt;</ph>, the manipulation events are no longer raised and mouse events occur for touch.","pos":[31804,31965],"source":" When you call <xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A>, the manipulation events are no longer raised and mouse events occur for touch."},{"content":"The following table describes the relationship between the time the manipulation is canceled and the mouse events that occur.","pos":[31966,32091]},{"content":"The event that Cancel is called in","pos":[32094,32128]},{"content":"The mouse events that occur for input that already occurred","pos":[32129,32188]},{"pos":[32300,32408],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.UIElement.ManipulationStarting&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.ManipulationStarted&gt;</ph>","source":"<xref:System.Windows.UIElement.ManipulationStarting> and <xref:System.Windows.UIElement.ManipulationStarted>"},{"content":"Mouse down events.","pos":[32409,32427]},{"content":"Mouse down and mouse move events.","pos":[32480,32513]},{"pos":[32516,32633],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.UIElement.ManipulationInertiaStarting&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.ManipulationCompleted&gt;</ph>","source":"<xref:System.Windows.UIElement.ManipulationInertiaStarting> and <xref:System.Windows.UIElement.ManipulationCompleted>"},{"content":"Mouse down, mouse move, and mouse up events.","pos":[32634,32678]},{"pos":[32682,32878],"content":"Note that if you call <ph id=\"ph1\">&lt;xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A&gt;</ph> when the manipulation is in inertia, the method returns <ph id=\"ph2\">`false`</ph> and the input does not raise mouse events.","source":"Note that if you call <xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A> when the manipulation is in inertia, the method returns `false` and the input does not raise mouse events."},{"pos":[32884,32938],"content":"The Relationship Between Touch and Manipulation Events","linkify":"The Relationship Between Touch and Manipulation Events","nodes":[{"content":"The Relationship Between Touch and Manipulation Events","pos":[0,54]}]},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.UIElement&gt;</ph> can always receive touch events.","pos":[32940,33006],"source":"A <xref:System.Windows.UIElement> can always receive touch events."},{"content":"When the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.IsManipulationEnabled%2A&gt;</ph> property is set to <ph id=\"ph2\">`true`</ph>, a <ph id=\"ph3\">&lt;xref:System.Windows.UIElement&gt;</ph> can receive both touch and manipulation events.","pos":[33007,33181],"source":" When the <xref:System.Windows.UIElement.IsManipulationEnabled%2A> property is set to `true`, a <xref:System.Windows.UIElement> can receive both touch and manipulation events."},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.TouchDown&gt;</ph> event is not handled (that is, the <ph id=\"ph2\">&lt;xref:System.Windows.RoutedEventArgs.Handled%2A&gt;</ph> property is <ph id=\"ph3\">`false`</ph>), the manipulation logic captures the touch to the element and generates the manipulation events.","pos":[33183,33433],"source":"  If the <xref:System.Windows.UIElement.TouchDown> event is not handled (that is, the <xref:System.Windows.RoutedEventArgs.Handled%2A> property is `false`), the manipulation logic captures the touch to the element and generates the manipulation events."},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.RoutedEventArgs.Handled%2A&gt;</ph> property is set to <ph id=\"ph2\">`true`</ph> in the <ph id=\"ph3\">&lt;xref:System.Windows.UIElement.TouchDown&gt;</ph> event, the manipulation logic does not generate manipulation events.","pos":[33434,33633],"source":" If the <xref:System.Windows.RoutedEventArgs.Handled%2A> property is set to `true` in the <xref:System.Windows.UIElement.TouchDown> event, the manipulation logic does not generate manipulation events."},{"content":"The following illustration shows the relationship between touch events and manipulation events.","pos":[33634,33729]},{"pos":[33732,33882],"content":"<bpt id=\"p1\">![</bpt>Relationship between touch and manipulation events<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/ndp-touchmanipulateevents.png \"</bpt>NDP_TouchManipulateEvents<ept id=\"p2\">\")</ept> Touch and manipulation events","source":"![Relationship between touch and manipulation events](./media/ndp-touchmanipulateevents.png \"NDP_TouchManipulateEvents\")\nTouch and manipulation events"},{"content":"The following list describes the relationship between the touch and manipulation events that is shown in the preceding illustration.","pos":[33885,34017]},{"pos":[34023,34312],"content":"When the first touch device generates a <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.TouchDown&gt;</ph> event on a <ph id=\"ph2\">&lt;xref:System.Windows.UIElement&gt;</ph>, the manipulation logic calls the <ph id=\"ph3\">&lt;xref:System.Windows.UIElement.CaptureTouch%2A&gt;</ph> method, which generates the <ph id=\"ph4\">&lt;xref:System.Windows.UIElement.GotTouchCapture&gt;</ph> event.","source":"When the first touch device generates a <xref:System.Windows.UIElement.TouchDown> event on a <xref:System.Windows.UIElement>, the manipulation logic calls the <xref:System.Windows.UIElement.CaptureTouch%2A> method, which generates the <xref:System.Windows.UIElement.GotTouchCapture> event."},{"pos":[34318,34591],"content":"When the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.GotTouchCapture&gt;</ph> occurs, the manipulation logic calls the <ph id=\"ph2\">&lt;xref:System.Windows.Input.Manipulation.AddManipulator%2A?displayProperty=nameWithType&gt;</ph> method, which generates the <ph id=\"ph3\">&lt;xref:System.Windows.UIElement.ManipulationStarting&gt;</ph> event.","source":"When the <xref:System.Windows.UIElement.GotTouchCapture> occurs, the manipulation logic calls the <xref:System.Windows.Input.Manipulation.AddManipulator%2A?displayProperty=nameWithType> method, which generates the <xref:System.Windows.UIElement.ManipulationStarting> event."},{"pos":[34597,34844],"content":"When the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.TouchMove&gt;</ph> events occur, the manipulation logic generates the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.ManipulationDelta&gt;</ph> events that occur before the <ph id=\"ph3\">&lt;xref:System.Windows.UIElement.ManipulationInertiaStarting&gt;</ph> event.","source":"When the <xref:System.Windows.UIElement.TouchMove> events occur, the manipulation logic generates the <xref:System.Windows.UIElement.ManipulationDelta> events that occur before the <xref:System.Windows.UIElement.ManipulationInertiaStarting> event."},{"pos":[34850,35053],"content":"When the last touch device on the element raises the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.TouchUp&gt;</ph> event, the manipulation logic generates the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.ManipulationInertiaStarting&gt;</ph> event.","source":"When the last touch device on the element raises the <xref:System.Windows.UIElement.TouchUp> event, the manipulation logic generates the <xref:System.Windows.UIElement.ManipulationInertiaStarting> event."},{"pos":[35079,35084],"content":"Focus","linkify":"Focus","nodes":[{"content":"Focus","pos":[0,5]}]},{"pos":[35086,35255],"content":"There are two main concepts that pertain to focus in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>: keyboard focus and logical focus.","source":"There are two main concepts that pertain to focus in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]: keyboard focus and logical focus."},{"pos":[35261,35275],"content":"Keyboard Focus","linkify":"Keyboard Focus","nodes":[{"content":"Keyboard Focus","pos":[0,14]}]},{"content":"Keyboard focus refers to the element that is receiving keyboard input.","pos":[35277,35347]},{"content":"There can be only one element on the whole desktop that has keyboard focus.","pos":[35349,35424]},{"content":"In <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>, the element that has keyboard focus will have <ph id=\"ph2\">&lt;xref:System.Windows.IInputElement.IsKeyboardFocused%2A&gt;</ph> set to <ph id=\"ph3\">`true`</ph>.","pos":[35426,35629],"source":"  In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the element that has keyboard focus will have <xref:System.Windows.IInputElement.IsKeyboardFocused%2A> set to `true`."},{"content":"The static <ph id=\"ph1\">&lt;xref:System.Windows.Input.Keyboard&gt;</ph> method <ph id=\"ph2\">&lt;xref:System.Windows.Input.Keyboard.FocusedElement%2A&gt;</ph> returns the element that currently has keyboard focus.","pos":[35631,35795],"source":"  The static <xref:System.Windows.Input.Keyboard> method <xref:System.Windows.Input.Keyboard.FocusedElement%2A> returns the element that currently has keyboard focus."},{"content":"Keyboard focus can be obtained by tabbing to an element or by clicking the mouse on certain elements, such as a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph>.","pos":[35798,35949],"source":"Keyboard focus can be obtained by tabbing to an element or by clicking the mouse on certain elements, such as a <xref:System.Windows.Controls.TextBox>."},{"content":"Keyboard focus can also be obtained programmatically by using the <ph id=\"ph1\">&lt;xref:System.Windows.Input.Keyboard.Focus%2A&gt;</ph> method on the <ph id=\"ph2\">&lt;xref:System.Windows.Input.Keyboard&gt;</ph> class.","pos":[35951,36120],"source":"  Keyboard focus can also be obtained programmatically by using the <xref:System.Windows.Input.Keyboard.Focus%2A> method on the <xref:System.Windows.Input.Keyboard> class."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Input.Keyboard.Focus%2A&gt;</ph> attempts to give the specified element keyboard focus.","pos":[36122,36222],"source":"<xref:System.Windows.Input.Keyboard.Focus%2A> attempts to give the specified element keyboard focus."},{"content":"The element returned by <ph id=\"ph1\">&lt;xref:System.Windows.Input.Keyboard.Focus%2A&gt;</ph> is the element that currently has keyboard focus.","pos":[36224,36343],"source":"  The element returned by <xref:System.Windows.Input.Keyboard.Focus%2A> is the element that currently has keyboard focus."},{"content":"In order for an element to obtain keyboard focus the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.Focusable%2A&gt;</ph> property and the <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.IsVisible%2A&gt;</ph> properties must be set to <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept>.","pos":[36346,36541],"source":"In order for an element to obtain keyboard focus the <xref:System.Windows.UIElement.Focusable%2A> property and the <xref:System.Windows.UIElement.IsVisible%2A> properties must be set to **true**."},{"content":"Some classes, such as <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Panel&gt;</ph>, have <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.Focusable%2A&gt;</ph> set to <ph id=\"ph3\">`false`</ph> by default; therefore, you may have to set this property to <ph id=\"ph4\">`true`</ph> if you want that element to be able to obtain focus.","pos":[36543,36787],"source":"  Some classes, such as <xref:System.Windows.Controls.Panel>, have <xref:System.Windows.UIElement.Focusable%2A> set to `false` by default; therefore, you may have to set this property to `true` if you want that element to be able to obtain focus."},{"content":"The following example uses <ph id=\"ph1\">&lt;xref:System.Windows.Input.Keyboard.Focus%2A&gt;</ph> to set keyboard focus on a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Button&gt;</ph>.","pos":[36790,36928],"source":"The following example uses <xref:System.Windows.Input.Keyboard.Focus%2A> to set keyboard focus on a <xref:System.Windows.Controls.Button>."},{"content":"The recommended place to set initial focus in an application is in the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event handler.","pos":[36930,37061],"source":"  The recommended place to set initial focus in an application is in the <xref:System.Windows.FrameworkElement.Loaded> event handler."},{"pos":[37365,37448],"content":"For more information about keyboard focus, see <bpt id=\"p1\">[</bpt>Focus Overview<ept id=\"p1\">](focus-overview.md)</ept>.","source":"For more information about keyboard focus, see [Focus Overview](focus-overview.md)."},{"pos":[37454,37467],"content":"Logical Focus","linkify":"Logical Focus","nodes":[{"content":"Logical Focus","pos":[0,13]}]},{"content":"Logical focus refers to the <ph id=\"ph1\">&lt;xref:System.Windows.Input.FocusManager.FocusedElement%2A?displayProperty=nameWithType&gt;</ph> in a focus scope.","pos":[37469,37602],"source":"Logical focus refers to the <xref:System.Windows.Input.FocusManager.FocusedElement%2A?displayProperty=nameWithType> in a focus scope."},{"content":"There can be multiple elements that have logical focus in an application, but there may only be one element that has logical focus in a particular focus scope.","pos":[37604,37763]},{"content":"A focus scope is a container element that keeps track of the <ph id=\"ph1\">&lt;xref:System.Windows.Input.FocusManager.FocusedElement%2A&gt;</ph> within its scope.","pos":[37766,37903],"source":"A focus scope is a container element that keeps track of the <xref:System.Windows.Input.FocusManager.FocusedElement%2A> within its scope."},{"content":"When focus leaves a focus scope, the focused element will lose keyboard focus but will retain logical focus.","pos":[37905,38013]},{"content":"When focus returns to the focus scope, the focused element will obtain keyboard focus.","pos":[38015,38101]},{"content":"This allows for keyboard focus to be changed between multiple focus scopes but insures that the focused element within the focus scope remains the focused element when focus returns.","pos":[38103,38285]},{"pos":[38288,38671],"content":"An element can be turned into a focus scope in <ph id=\"ph1\">[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]</ph> by setting the <ph id=\"ph2\">&lt;xref:System.Windows.Input.FocusManager&gt;</ph> attached property <ph id=\"ph3\">&lt;xref:System.Windows.Input.FocusManager.IsFocusScope%2A&gt;</ph> to <ph id=\"ph4\">`true`</ph>, or in code by setting the attached property by using the <ph id=\"ph5\">&lt;xref:System.Windows.Input.FocusManager.SetIsFocusScope%2A&gt;</ph> method.","source":"An element can be turned into a focus scope in [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] by setting the <xref:System.Windows.Input.FocusManager> attached property <xref:System.Windows.Input.FocusManager.IsFocusScope%2A> to `true`, or in code by setting the attached property by using the <xref:System.Windows.Input.FocusManager.SetIsFocusScope%2A> method."},{"pos":[38674,38855],"content":"The following example makes a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.StackPanel&gt;</ph> into a focus scope by setting the <ph id=\"ph2\">&lt;xref:System.Windows.Input.FocusManager.IsFocusScope%2A&gt;</ph> attached property.","source":"The following example makes a <xref:System.Windows.Controls.StackPanel> into a focus scope by setting the <xref:System.Windows.Input.FocusManager.IsFocusScope%2A> attached property."},{"pos":[39326,39611],"content":"Classes in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> which are focus scopes by default are <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Menu&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Controls.ToolBar&gt;</ph>, and <ph id=\"ph5\">&lt;xref:System.Windows.Controls.ContextMenu&gt;</ph>.","source":"Classes in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] which are focus scopes by default are <xref:System.Windows.Window>, <xref:System.Windows.Controls.Menu>, <xref:System.Windows.Controls.ToolBar>, and <xref:System.Windows.Controls.ContextMenu>."},{"pos":[39614,39958],"content":"An element that has keyboard focus will also have logical focus for the focus scope it belongs to; therefore, setting focus on an element with the <ph id=\"ph1\">&lt;xref:System.Windows.Input.Keyboard.Focus%2A&gt;</ph> method on the <ph id=\"ph2\">&lt;xref:System.Windows.Input.Keyboard&gt;</ph> class or the base element classes will attempt to give the element keyboard focus and logical focus.","source":"An element that has keyboard focus will also have logical focus for the focus scope it belongs to; therefore, setting focus on an element with the <xref:System.Windows.Input.Keyboard.Focus%2A> method on the <xref:System.Windows.Input.Keyboard> class or the base element classes will attempt to give the element keyboard focus and logical focus."},{"content":"To determine the focused element in a focus scope, use <ph id=\"ph1\">&lt;xref:System.Windows.Input.FocusManager.GetFocusedElement%2A&gt;</ph>.","pos":[39961,40078],"source":"To determine the focused element in a focus scope, use <xref:System.Windows.Input.FocusManager.GetFocusedElement%2A>."},{"content":"To change the focused element for a focus scope, use <ph id=\"ph1\">&lt;xref:System.Windows.Input.FocusManager.SetFocusedElement%2A&gt;</ph>.","pos":[40079,40194],"source":" To change the focused element for a focus scope, use <xref:System.Windows.Input.FocusManager.SetFocusedElement%2A>."},{"pos":[40197,40279],"content":"For more information about logical focus, see <bpt id=\"p1\">[</bpt>Focus Overview<ept id=\"p1\">](focus-overview.md)</ept>.","source":"For more information about logical focus, see [Focus Overview](focus-overview.md)."},{"pos":[40314,40328],"content":"Mouse Position","linkify":"Mouse Position","nodes":[{"content":"Mouse Position","pos":[0,14]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> input <ph id=\"ph2\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> provides helpful information with regard to coordinate spaces.","pos":[40330,40554],"source":"The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] provides helpful information with regard to coordinate spaces."},{"content":"For example, coordinate <ph id=\"ph1\">`(0,0)`</ph> is the upper-left coordinate, but the upper-left of which element in the tree?","pos":[40556,40666],"source":"  For example, coordinate `(0,0)` is the upper-left coordinate, but the upper-left of which element in the tree?"},{"content":"The element that is the input target?","pos":[40667,40704]},{"content":"The element you attached your event handler to?","pos":[40705,40752]},{"content":"Or something else?","pos":[40753,40771]},{"content":"To avoid confusion, the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> input <ph id=\"ph2\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> requires that you specify your frame of reference when you work with coordinates obtained through the mouse.","pos":[40772,41062],"source":" To avoid confusion, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] requires that you specify your frame of reference when you work with coordinates obtained through the mouse."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Input.Mouse.GetPosition%2A&gt;</ph> method returns the coordinate of the mouse pointer relative to the specified element.","pos":[41063,41201],"source":" The <xref:System.Windows.Input.Mouse.GetPosition%2A> method returns the coordinate of the mouse pointer relative to the specified element."},{"pos":[41235,41248],"content":"Mouse Capture","linkify":"Mouse Capture","nodes":[{"content":"Mouse Capture","pos":[0,13]}]},{"content":"Mouse devices specifically hold a modal characteristic known as mouse capture.","pos":[41250,41328]},{"content":"Mouse capture is used to maintain a transitional input state when a drag-and-drop operation is started, so that other operations involving the nominal on-screen position of the mouse pointer do not necessarily occur.","pos":[41329,41545]},{"content":"During the drag, the user cannot click without aborting the drag-and-drop, which makes most mouseover cues inappropriate while the mouse capture is held by the drag origin.","pos":[41546,41718]},{"content":"The input system exposes <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)]</ph> that can determine mouse capture state, as well as <ph id=\"ph2\">[!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)]</ph> that can force mouse capture to a specific element, or clear mouse capture state.","pos":[41719,42052],"source":" The input system exposes [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] that can determine mouse capture state, as well as [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] that can force mouse capture to a specific element, or clear mouse capture state."},{"content":"For more information on drag-and-drop operations, see <bpt id=\"p1\">[</bpt>Drag and Drop Overview<ept id=\"p1\">](drag-and-drop-overview.md)</ept>.","pos":[42053,42159],"source":" For more information on drag-and-drop operations, see [Drag and Drop Overview](drag-and-drop-overview.md)."},{"pos":[42188,42196],"content":"Commands","linkify":"Commands","nodes":[{"content":"Commands","pos":[0,8]}]},{"content":"Commands enable input handling at a more semantic level than device input.","pos":[42198,42272]},{"content":"Commands are simple directives, such as <ph id=\"ph1\">`Cut`</ph>, <ph id=\"ph2\">`Copy`</ph>, <ph id=\"ph3\">`Paste`</ph>, or <ph id=\"ph4\">`Open`</ph>.","pos":[42274,42348],"source":"  Commands are simple directives, such as `Cut`, `Copy`, `Paste`, or `Open`."},{"content":"Commands are useful for centralizing your command logic.","pos":[42350,42406]},{"content":"The same command might be accessed from a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Menu&gt;</ph>, on a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ToolBar&gt;</ph>, or through a keyboard shortcut.","pos":[42408,42563],"source":"  The same command might be accessed from a <xref:System.Windows.Controls.Menu>, on a <xref:System.Windows.Controls.ToolBar>, or through a keyboard shortcut."},{"content":"Commands also provide a mechanism for disabling controls when the command becomes unavailable.","pos":[42564,42658]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> is the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> implementation of <ph id=\"ph3\">&lt;xref:System.Windows.Input.ICommand&gt;</ph>.","pos":[42661,42847],"source":"<xref:System.Windows.Input.RoutedCommand> is the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of <xref:System.Windows.Input.ICommand>."},{"content":"When a <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> is executed, a <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandManager.PreviewExecuted&gt;</ph> and an <ph id=\"ph3\">&lt;xref:System.Windows.Input.CommandManager.Executed&gt;</ph> event are raised on the command target, which tunnel and bubble through the element tree like other input.","pos":[42849,43137],"source":"  When a <xref:System.Windows.Input.RoutedCommand> is executed, a <xref:System.Windows.Input.CommandManager.PreviewExecuted> and an <xref:System.Windows.Input.CommandManager.Executed> event are raised on the command target, which tunnel and bubble through the element tree like other input."},{"content":"If a command target is not set, the element with keyboard focus will be the command target.","pos":[43139,43230]},{"content":"The logic that performs the command is attached to a <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph>.","pos":[43232,43328],"source":"  The logic that performs the command is attached to a <xref:System.Windows.Input.CommandBinding>."},{"content":"When an <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandManager.Executed&gt;</ph> event reaches a <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> for that specific command, the <ph id=\"ph3\">&lt;xref:System.Windows.Input.ExecutedRoutedEventHandler&gt;</ph> on the <ph id=\"ph4\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> is called.","pos":[43330,43595],"source":"  When an <xref:System.Windows.Input.CommandManager.Executed> event reaches a <xref:System.Windows.Input.CommandBinding> for that specific command, the <xref:System.Windows.Input.ExecutedRoutedEventHandler> on the <xref:System.Windows.Input.CommandBinding> is called."},{"content":"This handler performs the action of the command.","pos":[43597,43645]},{"pos":[43648,43734],"content":"For more information on commanding, see <bpt id=\"p1\">[</bpt>Commanding Overview<ept id=\"p1\">](commanding-overview.md)</ept>.","source":"For more information on commanding, see [Commanding Overview](commanding-overview.md)."},{"pos":[43737,44142],"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> provides a library of common commands which consists of <ph id=\"ph2\">&lt;xref:System.Windows.Input.ApplicationCommands&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Input.MediaCommands&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Input.ComponentCommands&gt;</ph>, <ph id=\"ph5\">&lt;xref:System.Windows.Input.NavigationCommands&gt;</ph>, and <ph id=\"ph6\">&lt;xref:System.Windows.Documents.EditingCommands&gt;</ph>, or you can define your own.","source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a library of common commands which consists of <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ComponentCommands>, <xref:System.Windows.Input.NavigationCommands>, and <xref:System.Windows.Documents.EditingCommands>, or you can define your own."},{"pos":[44145,44458],"content":"The following example shows how to set up a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph> so that when it is clicked it will invoke the <ph id=\"ph2\">&lt;xref:System.Windows.Input.ApplicationCommands.Paste%2A&gt;</ph> command on the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph>, assuming the <ph id=\"ph4\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> has keyboard focus.","source":"The following example shows how to set up a <xref:System.Windows.Controls.MenuItem> so that when it is clicked it will invoke the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command on the <xref:System.Windows.Controls.TextBox>, assuming the <xref:System.Windows.Controls.TextBox> has keyboard focus."},{"pos":[45107,45279],"content":"For more information about commands in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Commanding Overview<ept id=\"p1\">](commanding-overview.md)</ept>.","source":"For more information about commands in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Commanding Overview](commanding-overview.md)."},{"pos":[45334,45368],"content":"The Input System and Base Elements","linkify":"The Input System and Base Elements","nodes":[{"content":"The Input System and Base Elements","pos":[0,34]}]},{"pos":[45370,45686],"content":"Input events such as the attached events defined by the <ph id=\"ph1\">&lt;xref:System.Windows.Input.Mouse&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Input.Keyboard&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Windows.Input.Stylus&gt;</ph> classes are raised by the input system and injected into a particular position in the object model based on hit testing the visual tree at run time.","source":"Input events such as the attached events defined by the <xref:System.Windows.Input.Mouse>, <xref:System.Windows.Input.Keyboard>, and <xref:System.Windows.Input.Stylus> classes are raised by the input system and injected into a particular position in the object model based on hit testing the visual tree at run time."},{"content":"Each of the events that <ph id=\"ph1\">&lt;xref:System.Windows.Input.Mouse&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Input.Keyboard&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Windows.Input.Stylus&gt;</ph> define as an attached event is also re-exposed by the base element classes <ph id=\"ph4\">&lt;xref:System.Windows.UIElement&gt;</ph> and <ph id=\"ph5\">&lt;xref:System.Windows.ContentElement&gt;</ph> as a new routed event.","pos":[45689,45995],"source":"Each of the events that <xref:System.Windows.Input.Mouse>, <xref:System.Windows.Input.Keyboard>, and <xref:System.Windows.Input.Stylus> define as an attached event is also re-exposed by the base element classes <xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement> as a new routed event."},{"content":"The base element routed events are generated by classes handling the original attached event and reusing the event data.","pos":[45996,46116]},{"content":"When the input event becomes associated with a particular source element through its base element input event implementation, it can be routed through the remainder of an event route that is based on a combination of logical and visual tree objects, and be handled by application code.","pos":[46119,46404]},{"content":"Generally, it is more convenient to handle these device-related input events using the routed events on <ph id=\"ph1\">&lt;xref:System.Windows.UIElement&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.ContentElement&gt;</ph>, because you can use more intuitive event handler syntax both in <ph id=\"ph3\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> and in code.","pos":[46406,46732],"source":"  Generally, it is more convenient to handle these device-related input events using the routed events on <xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement>, because you can use more intuitive event handler syntax both in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] and in code."},{"content":"You could choose to handle the attached event that initiated the process instead, but you would face several issues: the attached event may be marked handled by the base element class handling, and you need to use accessor methods rather than true event syntax in order to attach handlers for attached events.","pos":[46733,47042]},{"pos":[47073,47084],"content":"What's Next","linkify":"What's Next","nodes":[{"content":"What's Next","pos":[0,11]}]},{"content":"You now have several techniques to handle input in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>.","pos":[47086,47219],"source":"You now have several techniques to handle input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]."},{"content":"You should also have an improved understanding of the various types of input events and the routed event mechanisms used by <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>.","pos":[47221,47427],"source":"  You should also have an improved understanding of the various types of input events and the routed event mechanisms used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]."},{"content":"Additional resources are available that explain <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> framework elements and event routing in more detail.","pos":[47430,47612],"source":"Additional resources are available that explain [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] framework elements and event routing in more detail."},{"content":"See the following overviews for more information, <bpt id=\"p1\">[</bpt>Commanding Overview<ept id=\"p1\">](commanding-overview.md)</ept>, <bpt id=\"p2\">[</bpt>Focus Overview<ept id=\"p2\">](focus-overview.md)</ept>, <bpt id=\"p3\">[</bpt>Base Elements Overview<ept id=\"p3\">](base-elements-overview.md)</ept>, <bpt id=\"p4\">[</bpt>Trees in WPF<ept id=\"p4\">](trees-in-wpf.md)</ept>, and <bpt id=\"p5\">[</bpt>Routed Events Overview<ept id=\"p5\">](routed-events-overview.md)</ept>.","pos":[47613,47889],"source":" See the following overviews for more information, [Commanding Overview](commanding-overview.md), [Focus Overview](focus-overview.md), [Base Elements Overview](base-elements-overview.md), [Trees in WPF](trees-in-wpf.md), and [Routed Events Overview](routed-events-overview.md)."},{"pos":[47894,47902],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[47906,47941],"content":"<bpt id=\"p1\">[</bpt>Focus Overview<ept id=\"p1\">](focus-overview.md)</ept>","source":"[Focus Overview](focus-overview.md)"},{"pos":[47944,47989],"content":"<bpt id=\"p1\">[</bpt>Commanding Overview<ept id=\"p1\">](commanding-overview.md)</ept>","source":"[Commanding Overview](commanding-overview.md)"},{"pos":[47992,48043],"content":"<bpt id=\"p1\">[</bpt>Routed Events Overview<ept id=\"p1\">](routed-events-overview.md)</ept>","source":"[Routed Events Overview](routed-events-overview.md)"},{"pos":[48046,48097],"content":"<bpt id=\"p1\">[</bpt>Base Elements Overview<ept id=\"p1\">](base-elements-overview.md)</ept>","source":"[Base Elements Overview](base-elements-overview.md)"},{"pos":[48100,48131],"content":"<bpt id=\"p1\">[</bpt>Properties<ept id=\"p1\">](properties-wpf.md)</ept>","source":"[Properties](properties-wpf.md)"}]}