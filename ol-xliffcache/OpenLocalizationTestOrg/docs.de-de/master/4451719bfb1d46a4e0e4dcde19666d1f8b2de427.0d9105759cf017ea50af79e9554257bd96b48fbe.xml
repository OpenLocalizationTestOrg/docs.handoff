{"content":"---\ntitle: \"Document Approval Process\"\nms.date: \"03/30/2017\"\nms.assetid: 9b240937-76a7-45cd-8823-7f82c34d03bd\n---\n# Document Approval Process\nThis sample demonstrates the use of many Windows Workflow Foundation (WF) and Windows Communication Foundation (WCF) features together. Together they implement a document approval process scenario. A client application can submit documents for approval and approve documents. An approval manager application exists to facilitate communications between clients and to enforce the rules of the approval process. The approval process is a workflow that can execute several types of approval. Activities exist to get a single approval, a quorum approval (a percentage of set of approvers), and a complex approval process that consists of a quorum and single approval in a sequence.\n\n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Application\\DocumentApprovalProcess`  \n  \n## Sample Details  \n The following graphic demonstrates the document approval process workflow:  \n  \n ![A document approval process workflow](./media/document-approval-process/document-approval-process.jpg)  \n  \n From the client's perspective, the approval process functions as follows:  \n  \n1.  A client subscribes to be a user in the approval process system.  \n  \n2.  A WCF client sends to a WCF service hosted by the approval manager application.  \n  \n3.  A unique user ID is returned to the client. The client can now participate in approval processes.  \n  \n4.  Once joined, a client can send a document for approval using single, quorum or complex approval processes.  \n  \n5.  A button in the client’s interface is clicked, starting a workflow instance in a client Workflow Service Host.  \n  \n6.  The workflow sends an approval request to the approval manager application.  \n  \n7.  The workflow manager starts a workflow on its own side to represent an approval process.  \n  \n8.  Once the manager approval workflow executes, the results are sent back to the client.  \n  \n9. The client displays the results.  \n  \n10. A client may receive an approval request and respond to the request at any point in time.  \n  \n11. A WCF service hosted on the client can receive an approval request from the approval manager application.  \n  \n12. The document information is presented on the client for review.  \n  \n13. The user can approve or reject the document.  \n  \n14. A WCF client is used to send an approval response back to the approval manager application.  \n  \n From the approval manager application’s point of view, the approval process functions as follows:  \n  \n1.  A client requests to participate to the approval process system.  \n  \n2.  A WCF service on the approval manager receives a request to be part of the approval process system.  \n  \n3.  A unique ID is generated for the client. The user information is stored in a database.  \n  \n4.  The unique ID is sent back to the user.  \n  \n5.  An approval request is receive. The approval manager executes an approval process.  \n  \n6.  An approval request is received by the approval manager, starting a new workflow.  \n  \n7.  Depending on the type of request (simple, quorum, or complex) a different activity is executed.  \n  \n8.  Send and Receive activities with correlation are used to send the approval request to the client for review and receive the response.  \n  \n9. The result of the approval process workflow is sent to the client.  \n  \n## Using the Sample  \n  \n##### To set up the database  \n  \n1.  From a Visual Studio 2010 command prompt opened with Administrator privileges, navigate to this DocumentApprovalProcess folder and run Setup.cmd.  \n  \n##### To set up the application  \n  \n1.  Using Visual Studio 2010, open the DocumentApprovalProcess.sln solution file.  \n  \n2.  To build the solution, press CTRL+SHIFT+B.  \n  \n3.  To run the solution, launch the Approval Manager Application by right-clicking the ApprovalManager project in the **Solution Explorer** and clicking **Debug**->**Start** new instance from the right-click menu.  \n  \n     Wait for the manager’s output to let you know that it is ready.  \n  \n##### To run the single approval scenario  \n  \n1.  Open a command prompt with administrator permission.  \n  \n2.  Navigate to the directory that contains the solution.  \n  \n3.  Navigate to the ApprovalClient\\Bin\\Debug folder and execute two instances of ApprovalClient.exe.  \n  \n4.  Click **discover**, wait until the **subscribe** button is enabled.  \n  \n5.  Type any user name and click **subscribe**. For one client, use `UserType1` and the other type `UserType2`.  \n  \n6.  In the `UserType1` client, select the single approval type from the drop down menu and type a document name and content. Click **Request Approval**.  \n  \n7.  In the `UserType2` client, a document awaiting approval appears. Select it and press **approve** or **reject**. The results should show in the `UserType1` client.  \n  \n##### To run the quorum approval scenario  \n  \n1.  Open a command prompt with administrator permission.  \n  \n2.  Navigate to the directory that contains the solution.  \n  \n3.  Navigate to the ApprovalClient\\Bin\\Debug folder and execute three instances of ApprovalClient.exe.  \n  \n4.  Click **discover**, wait until the **subscribe** button is enabled.  \n  \n5.  Type any user name and click **subscribe**. For one client use `UserType1` and the other two type `UserType2`.  \n  \n6.  In the `UserType1` client, select the quorum approval type from the drop down menu and type a document name and content. Click **Request Approval**. This requests that the two `UserType2` clients approve or reject the document. While both `UserType2` clients must respond, only one client must approve the document for it to be approved.  \n  \n7.  In the `UserType2` clients, a document awaiting approval appears. Select it and press **approve** or **reject**. The results should show in the `UserType1` client.  \n  \n##### To run the complex approval scenario  \n  \n1.  Open a command prompt with administrator permission.  \n  \n2.  Navigate to the directory that contains the solution.  \n  \n3.  Navigate to the ApprovalClient\\Bin\\Debug folder and execute four instances of ApprovalClient.exe.  \n  \n4.  Click **discover**, wait until the **subscribe** button is enabled.  \n  \n5.  Type any user name and click **subscribe**. For one client use `UserType1`, in two uses type `UserType2`, and in the last use `UserType3`.  \n  \n6.  In the `UserType1` client, select the single approval type from the drop down menu and type a document name and content. Click **Request Approval**.  \n  \n7.  In the `UserType2` clients, a document awaiting approval appears. Select it and press **approve**, the document is passed to the `UserType3` client.  \n  \n     If the document is approved by the first `UserType2` quorum, the document is passed to the `UserType3` client.  \n  \n8.  Approve or reject the document from the `UserType3` client. The results should show in the `UserType1` client.  \n  \n##### To clean up  \n  \n1.  From a Visual Studio 2010 command prompt, navigate to the DocumentApprovalProcess folder and run Cleanup.cmd.\n","nodes":[{"pos":[4,109],"embed":true,"restype":"x-metadata","content":"title: \"Document Approval Process\"\nms.date: \"03/30/2017\"\nms.assetid: 9b240937-76a7-45cd-8823-7f82c34d03bd","nodes":[{"content":"Document Approval Process","nodes":[{"pos":[0,25],"content":"Document Approval Process","nodes":[{"content":"Document Approval Process","pos":[0,25]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[116,141],"content":"Document Approval Process","linkify":"Document Approval Process","nodes":[{"content":"Document Approval Process","pos":[0,25]}]},{"content":"This sample demonstrates the use of many Windows Workflow Foundation (WF) and Windows Communication Foundation (WCF) features together.","pos":[142,277]},{"content":"Together they implement a document approval process scenario.","pos":[278,339]},{"content":"A client application can submit documents for approval and approve documents.","pos":[340,417]},{"content":"An approval manager application exists to facilitate communications between clients and to enforce the rules of the approval process.","pos":[418,551]},{"content":"The approval process is a workflow that can execute several types of approval.","pos":[552,630]},{"content":"Activities exist to get a single approval, a quorum approval (a percentage of set of approvers), and a complex approval process that consists of a quorum and single approval in a sequence.","pos":[631,819]},{"pos":[823,955],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[14,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[1009,1319],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[1320,1370]},{"pos":[1461,1475],"content":"Sample Details","linkify":"Sample Details","nodes":[{"content":"Sample Details","pos":[0,14]}]},{"content":"The following graphic demonstrates the document approval process workflow:","pos":[1479,1553]},{"content":"A document approval process workflow","pos":[1562,1598]},{"content":"From the client's perspective, the approval process functions as follows:","pos":[1671,1744]},{"content":"A client subscribes to be a user in the approval process system.","pos":[1754,1818]},{"content":"A WCF client sends to a WCF service hosted by the approval manager application.","pos":[1828,1907]},{"content":"A unique user ID is returned to the client.","pos":[1917,1960]},{"content":"The client can now participate in approval processes.","pos":[1961,2014]},{"content":"Once joined, a client can send a document for approval using single, quorum or complex approval processes.","pos":[2024,2130]},{"content":"A button in the client’s interface is clicked, starting a workflow instance in a client Workflow Service Host.","pos":[2140,2250]},{"content":"The workflow sends an approval request to the approval manager application.","pos":[2260,2335]},{"content":"The workflow manager starts a workflow on its own side to represent an approval process.","pos":[2345,2433]},{"content":"Once the manager approval workflow executes, the results are sent back to the client.","pos":[2443,2528]},{"content":"The client displays the results.","pos":[2537,2569]},{"content":"A client may receive an approval request and respond to the request at any point in time.","pos":[2579,2668]},{"content":"A WCF service hosted on the client can receive an approval request from the approval manager application.","pos":[2678,2783]},{"content":"The document information is presented on the client for review.","pos":[2793,2856]},{"content":"The user can approve or reject the document.","pos":[2866,2910]},{"content":"A WCF client is used to send an approval response back to the approval manager application.","pos":[2920,3011]},{"content":"From the approval manager application’s point of view, the approval process functions as follows:","pos":[3018,3115]},{"content":"A client requests to participate to the approval process system.","pos":[3125,3189]},{"content":"A WCF service on the approval manager receives a request to be part of the approval process system.","pos":[3199,3298]},{"content":"A unique ID is generated for the client.","pos":[3308,3348]},{"content":"The user information is stored in a database.","pos":[3349,3394]},{"content":"The unique ID is sent back to the user.","pos":[3404,3443]},{"content":"An approval request is receive.","pos":[3453,3484]},{"content":"The approval manager executes an approval process.","pos":[3485,3535]},{"content":"An approval request is received by the approval manager, starting a new workflow.","pos":[3545,3626]},{"content":"Depending on the type of request (simple, quorum, or complex) a different activity is executed.","pos":[3636,3731]},{"content":"Send and Receive activities with correlation are used to send the approval request to the client for review and receive the response.","pos":[3741,3874]},{"content":"The result of the approval process workflow is sent to the client.","pos":[3883,3949]},{"pos":[3958,3974],"content":"Using the Sample","linkify":"Using the Sample","nodes":[{"content":"Using the Sample","pos":[0,16]}]},{"pos":[3986,4008],"content":"To set up the database","linkify":"To set up the database","nodes":[{"content":"To set up the database","pos":[0,22]}]},{"content":"From a Visual Studio 2010 command prompt opened with Administrator privileges, navigate to this DocumentApprovalProcess folder and run Setup.cmd.","pos":[4018,4163]},{"pos":[4175,4200],"content":"To set up the application","linkify":"To set up the application","nodes":[{"content":"To set up the application","pos":[0,25]}]},{"content":"Using Visual Studio 2010, open the DocumentApprovalProcess.sln solution file.","pos":[4210,4287]},{"content":"To build the solution, press CTRL+SHIFT+B.","pos":[4297,4339]},{"pos":[4349,4558],"content":"To run the solution, launch the Approval Manager Application by right-clicking the ApprovalManager project in the <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and clicking <bpt id=\"p2\">**</bpt>Debug<ept id=\"p2\">**</ept><ph id=\"ph1\">-&gt;</ph><bpt id=\"p3\">**</bpt>Start<ept id=\"p3\">**</ept> new instance from the right-click menu.","source":"To run the solution, launch the Approval Manager Application by right-clicking the ApprovalManager project in the **Solution Explorer** and clicking **Debug**->**Start** new instance from the right-click menu."},{"content":"Wait for the manager’s output to let you know that it is ready.","pos":[4569,4632]},{"pos":[4644,4679],"content":"To run the single approval scenario","linkify":"To run the single approval scenario","nodes":[{"content":"To run the single approval scenario","pos":[0,35]}]},{"content":"Open a command prompt with administrator permission.","pos":[4689,4741]},{"content":"Navigate to the directory that contains the solution.","pos":[4751,4804]},{"content":"Navigate to the ApprovalClient\\Bin\\Debug folder and execute two instances of ApprovalClient.exe.","pos":[4814,4910]},{"pos":[4920,4987],"content":"Click <bpt id=\"p1\">**</bpt>discover<ept id=\"p1\">**</ept>, wait until the <bpt id=\"p2\">**</bpt>subscribe<ept id=\"p2\">**</ept> button is enabled.","source":"Click **discover**, wait until the **subscribe** button is enabled."},{"content":"Type any user name and click <bpt id=\"p1\">**</bpt>subscribe<ept id=\"p1\">**</ept>.","pos":[4997,5040],"source":"Type any user name and click **subscribe**."},{"content":"For one client, use <ph id=\"ph1\">`UserType1`</ph> and the other type <ph id=\"ph2\">`UserType2`</ph>.","pos":[5041,5104],"source":" For one client, use `UserType1` and the other type `UserType2`."},{"content":"In the <ph id=\"ph1\">`UserType1`</ph> client, select the single approval type from the drop down menu and type a document name and content.","pos":[5114,5234],"source":"In the `UserType1` client, select the single approval type from the drop down menu and type a document name and content."},{"content":"Click <bpt id=\"p1\">**</bpt>Request Approval<ept id=\"p1\">**</ept>.","pos":[5235,5262],"source":" Click **Request Approval**."},{"content":"In the <ph id=\"ph1\">`UserType2`</ph> client, a document awaiting approval appears.","pos":[5272,5336],"source":"In the `UserType2` client, a document awaiting approval appears."},{"content":"Select it and press <bpt id=\"p1\">**</bpt>approve<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>reject<ept id=\"p2\">**</ept>.","pos":[5337,5383],"source":" Select it and press **approve** or **reject**."},{"content":"The results should show in the <ph id=\"ph1\">`UserType1`</ph> client.","pos":[5384,5434],"source":" The results should show in the `UserType1` client."},{"pos":[5446,5481],"content":"To run the quorum approval scenario","linkify":"To run the quorum approval scenario","nodes":[{"content":"To run the quorum approval scenario","pos":[0,35]}]},{"content":"Open a command prompt with administrator permission.","pos":[5491,5543]},{"content":"Navigate to the directory that contains the solution.","pos":[5553,5606]},{"content":"Navigate to the ApprovalClient\\Bin\\Debug folder and execute three instances of ApprovalClient.exe.","pos":[5616,5714]},{"pos":[5724,5791],"content":"Click <bpt id=\"p1\">**</bpt>discover<ept id=\"p1\">**</ept>, wait until the <bpt id=\"p2\">**</bpt>subscribe<ept id=\"p2\">**</ept> button is enabled.","source":"Click **discover**, wait until the **subscribe** button is enabled."},{"content":"Type any user name and click <bpt id=\"p1\">**</bpt>subscribe<ept id=\"p1\">**</ept>.","pos":[5801,5844],"source":"Type any user name and click **subscribe**."},{"content":"For one client use <ph id=\"ph1\">`UserType1`</ph> and the other two type <ph id=\"ph2\">`UserType2`</ph>.","pos":[5845,5911],"source":" For one client use `UserType1` and the other two type `UserType2`."},{"content":"In the <ph id=\"ph1\">`UserType1`</ph> client, select the quorum approval type from the drop down menu and type a document name and content.","pos":[5921,6041],"source":"In the `UserType1` client, select the quorum approval type from the drop down menu and type a document name and content."},{"content":"Click <bpt id=\"p1\">**</bpt>Request Approval<ept id=\"p1\">**</ept>.","pos":[6042,6069],"source":" Click **Request Approval**."},{"content":"This requests that the two <ph id=\"ph1\">`UserType2`</ph> clients approve or reject the document.","pos":[6070,6148],"source":" This requests that the two `UserType2` clients approve or reject the document."},{"content":"While both <ph id=\"ph1\">`UserType2`</ph> clients must respond, only one client must approve the document for it to be approved.","pos":[6149,6258],"source":" While both `UserType2` clients must respond, only one client must approve the document for it to be approved."},{"content":"In the <ph id=\"ph1\">`UserType2`</ph> clients, a document awaiting approval appears.","pos":[6268,6333],"source":"In the `UserType2` clients, a document awaiting approval appears."},{"content":"Select it and press <bpt id=\"p1\">**</bpt>approve<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>reject<ept id=\"p2\">**</ept>.","pos":[6334,6380],"source":" Select it and press **approve** or **reject**."},{"content":"The results should show in the <ph id=\"ph1\">`UserType1`</ph> client.","pos":[6381,6431],"source":" The results should show in the `UserType1` client."},{"pos":[6443,6479],"content":"To run the complex approval scenario","linkify":"To run the complex approval scenario","nodes":[{"content":"To run the complex approval scenario","pos":[0,36]}]},{"content":"Open a command prompt with administrator permission.","pos":[6489,6541]},{"content":"Navigate to the directory that contains the solution.","pos":[6551,6604]},{"content":"Navigate to the ApprovalClient\\Bin\\Debug folder and execute four instances of ApprovalClient.exe.","pos":[6614,6711]},{"pos":[6721,6788],"content":"Click <bpt id=\"p1\">**</bpt>discover<ept id=\"p1\">**</ept>, wait until the <bpt id=\"p2\">**</bpt>subscribe<ept id=\"p2\">**</ept> button is enabled.","source":"Click **discover**, wait until the **subscribe** button is enabled."},{"content":"Type any user name and click <bpt id=\"p1\">**</bpt>subscribe<ept id=\"p1\">**</ept>.","pos":[6798,6841],"source":"Type any user name and click **subscribe**."},{"content":"For one client use <ph id=\"ph1\">`UserType1`</ph>, in two uses type <ph id=\"ph2\">`UserType2`</ph>, and in the last use <ph id=\"ph3\">`UserType3`</ph>.","pos":[6842,6936],"source":" For one client use `UserType1`, in two uses type `UserType2`, and in the last use `UserType3`."},{"content":"In the <ph id=\"ph1\">`UserType1`</ph> client, select the single approval type from the drop down menu and type a document name and content.","pos":[6946,7066],"source":"In the `UserType1` client, select the single approval type from the drop down menu and type a document name and content."},{"content":"Click <bpt id=\"p1\">**</bpt>Request Approval<ept id=\"p1\">**</ept>.","pos":[7067,7094],"source":" Click **Request Approval**."},{"content":"In the <ph id=\"ph1\">`UserType2`</ph> clients, a document awaiting approval appears.","pos":[7104,7169],"source":"In the `UserType2` clients, a document awaiting approval appears."},{"content":"Select it and press <bpt id=\"p1\">**</bpt>approve<ept id=\"p1\">**</ept>, the document is passed to the <ph id=\"ph1\">`UserType3`</ph> client.","pos":[7170,7252],"source":" Select it and press **approve**, the document is passed to the `UserType3` client."},{"pos":[7263,7373],"content":"If the document is approved by the first <ph id=\"ph1\">`UserType2`</ph> quorum, the document is passed to the <ph id=\"ph2\">`UserType3`</ph> client.","source":"If the document is approved by the first `UserType2` quorum, the document is passed to the `UserType3` client."},{"content":"Approve or reject the document from the <ph id=\"ph1\">`UserType3`</ph> client.","pos":[7383,7442],"source":"Approve or reject the document from the `UserType3` client."},{"content":"The results should show in the <ph id=\"ph1\">`UserType1`</ph> client.","pos":[7443,7493],"source":" The results should show in the `UserType1` client."},{"pos":[7505,7516],"content":"To clean up","linkify":"To clean up","nodes":[{"content":"To clean up","pos":[0,11]}]},{"content":"From a Visual Studio 2010 command prompt, navigate to the DocumentApprovalProcess folder and run Cleanup.cmd.","pos":[7526,7635]}]}