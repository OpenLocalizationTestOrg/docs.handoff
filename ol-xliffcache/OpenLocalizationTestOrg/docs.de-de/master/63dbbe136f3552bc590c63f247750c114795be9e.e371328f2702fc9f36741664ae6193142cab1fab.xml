{"content":"---\ntitle: \"Example that Outputs Office Open XML Document Parts (C#) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"CSharp\"\nms.assetid: 6cd37055-89b4-42e8-bf27-5a29717e35f3\ncaps.latest.revision: 3\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n\n---\n# Example that Outputs Office Open XML Document Parts (C#)\nThis topic shows how to open an Office Open XML document and access parts within it.  \n  \n## Example  \n The following example opens an Office Open XML document, and prints the document part and the style part to the console.  \n  \n This example uses classes from the WindowsBase assembly. It uses types in the <xref:System.IO.Packaging?displayProperty=fullName> namespace.  \n  \n```csharp  \nconst string fileName = \"SampleDoc.docx\";  \n  \nconst string documentRelationshipType =  \n  \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\";  \nconst string stylesRelationshipType =  \n  \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\";  \nconst string wordmlNamespace =  \n  \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\";  \nXNamespace w = wordmlNamespace;  \n  \nusing (Package wdPackage = Package.Open(fileName, FileMode.Open, FileAccess.Read))  \n{  \n    PackageRelationship docPackageRelationship =  \n      wdPackage.GetRelationshipsByType(documentRelationshipType).FirstOrDefault();  \n    if (docPackageRelationship != null)  \n    {  \n        Uri documentUri = PackUriHelper.ResolvePartUri(new Uri(\"/\", UriKind.Relative),  \n          docPackageRelationship.TargetUri);  \n        PackagePart documentPart = wdPackage.GetPart(documentUri);  \n  \n        //  Load the document XML in the part into an XDocument instance.  \n        XDocument xdoc = XDocument.Load(XmlReader.Create(documentPart.GetStream()));  \n  \n        Console.WriteLine(\"TargetUri:{0}\", docPackageRelationship.TargetUri);  \n        Console.WriteLine(\"==================================================================\");  \n        Console.WriteLine(xdoc.Root);  \n        Console.WriteLine();  \n  \n        //  Find the styles part. There will only be one.  \n        PackageRelationship styleRelation =  \n          documentPart.GetRelationshipsByType(stylesRelationshipType).FirstOrDefault();  \n        if (styleRelation != null)  \n        {  \n            Uri styleUri = PackUriHelper.ResolvePartUri(documentUri, styleRelation.TargetUri);  \n            PackagePart stylePart = wdPackage.GetPart(styleUri);  \n  \n            //  Load the style XML in the part into an XDocument instance.  \n            XDocument styleDoc = XDocument.Load(XmlReader.Create(stylePart.GetStream()));  \n  \n            Console.WriteLine(\"TargetUri:{0}\", styleRelation.TargetUri);  \n            Console.WriteLine(\"==================================================================\");  \n            Console.WriteLine(styleDoc.Root);  \n            Console.WriteLine();  \n        }  \n    }  \n}  \n```  \n  \n## See Also  \n [Details of Office Open XML WordprocessingML Documents (C#)](../../../../csharp/programming-guide/concepts/linq/details-of-office-open-xml-wordprocessingml-documents.md)","nodes":[{"pos":[12,85],"content":"Example that Outputs Office Open XML Document Parts (C#) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Example that Outputs Office Open XML Document Parts (C#) | Microsoft Docs","pos":[0,73]}]},{"pos":[370,426],"content":"Example that Outputs Office Open XML Document Parts (C#)","linkify":"Example that Outputs Office Open XML Document Parts (C#)","nodes":[{"content":"Example that Outputs Office Open XML Document Parts (C#)","pos":[0,56]}]},{"content":"This topic shows how to open an Office Open XML document and access parts within it.","pos":[427,511]},{"pos":[520,527],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example opens an Office Open XML document, and prints the document part and the style part to the console.","pos":[531,651]},{"content":"This example uses classes from the WindowsBase assembly.","pos":[658,714]},{"content":"It uses types in the <ph id=\"ph1\">&lt;xref:System.IO.Packaging?displayProperty=fullName&gt;</ph> namespace.","pos":[715,798],"source":" It uses types in the <xref:System.IO.Packaging?displayProperty=fullName> namespace."},{"pos":[3038,3046],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[3050,3219],"content":"<bpt id=\"p1\">[</bpt>Details of Office Open XML WordprocessingML Documents (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/details-of-office-open-xml-wordprocessingml-documents.md)</ept>","source":"[Details of Office Open XML WordprocessingML Documents (C#)](../../../../csharp/programming-guide/concepts/linq/details-of-office-open-xml-wordprocessingml-documents.md)"}]}