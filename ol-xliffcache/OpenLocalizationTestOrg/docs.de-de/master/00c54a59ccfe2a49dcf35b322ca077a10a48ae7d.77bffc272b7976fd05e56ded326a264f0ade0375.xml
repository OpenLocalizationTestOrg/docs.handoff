{"content":"---\ntitle: \"Working with Application Logs in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords:\n  - \"logs, application\"\n  - \"application event logs, Visual Basic\"\n  - \"application event logs\"\nms.assetid: 2581afd1-5791-4bc4-86b2-46244e9fe468\n---\n\n# Working with Application Logs in Visual Basic\n\nThe `My.Application.Log` and `My.Log` objects make it easy to write logging and tracing information to logs.\n\n## How Messages are Logged\n\nFirst, the severity of the message is checked with the <xref:System.Diagnostics.TraceSource.Switch%2A> property of the log's <xref:Microsoft.VisualBasic.Logging.Log.TraceSource%2A> property. By default, only messages of severity \"Information\" and higher are passed on to the trace listeners, specified in the log's `TraceListener` collection. Then, each listener compares the severity of the message to the listener's <xref:System.Diagnostics.TraceSource.Switch%2A> property. If the message's severity is high enough, the listener writes out the message.\n\nThe following diagram shows how a message written to the `WriteEntry` method gets passed to the `WriteLine` methods of the log's trace listeners:\n\n![Diagram that shows My log call.](./media/working-with-application-logs/my-log-call-messages.png)\n\nYou can change the behavior of the log and the trace listeners by changing the application's configuration file. The following diagram shows the correspondence between the parts of the log and the configuration file.\n\n![Diagram that shows My log configuration.](./media/working-with-application-logs/my-log-configuration.png)\n\n## Where Messages are Logged\n\nIf the assembly has no configuration file, the `My.Application.Log` and `My.Log` objects write to the application's debug output (through the <xref:System.Diagnostics.DefaultTraceListener> class). In addition, the `My.Application.Log` object writes to the assembly's log file (through the <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener> class), while the `My.Log` object writes to the ASP.NET Web page's output (through the <xref:System.Web.WebPageTraceListener> class).\n\nThe debug output can be viewed in the Visual Studio **Output** window when running your application in debug mode. To open the **Output** window, click the **Debug** menu item, point to **Windows**, and then click **Output**. In the **Output** window, select **Debug** from the **Show output from** box.\n\nBy default, `My.Application.Log` writes the log file in the path for the user's application data. You can get the path from the <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.FullLogFileName%2A> property of the <xref:Microsoft.VisualBasic.Logging.Log.DefaultFileLogWriter%2A> object. The format of that path is as follows:\n\n`BasePath`\\\\`CompanyName`\\\\`ProductName`\\\\`ProductVersion`\n\nA typical value for `BasePath` is as follows.\n\nC:\\Documents and Settings\\\\`username`\\Application Data\n\nThe values of `CompanyName`, `ProductName`, and `ProductVersion` come from the application's assembly information. The form of the log file name is *AssemblyName*.log, where *AssemblyName* is the file name of the assembly without the extension. If more than one log file is needed, such as when the original log is unavailable when the application attempts to write to the log, the form for the log file name is *AssemblyName*-*iteration*.log, where `iteration` is a positive `Integer`.\n\nYou can override the default behavior by adding or changing the computer's and the application's configuration files. For more information, see [Walkthrough: Changing Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-changing-where-my-application-log-writes-information.md).\n\n## Configuring Log Settings\n\nThe `Log` object has a default implementation that works without an application configuration file, app.config. To change the defaults, you must add a configuration file with the new settings. For more information, see [Walkthrough: Filtering My.Application.Log Output](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md).\n\nThe log configuration sections are located in the `<system.diagnostics>` node in the main `<configuration>` node of the app.config file. Log information is defined in several nodes:\n\n- The listeners for the `Log` object are defined in the `<sources>` node named DefaultSource.\n\n- The severity filter for the `Log` object is defined in the `<switches>` node named DefaultSwitch.\n\n- The log listeners are defined in the `<sharedListeners>` node.\n\n Examples of `<sources>`, `<switches>`, and `<sharedListeners>` nodes are shown in the following code:\n\n```xml\n<configuration>\n  <system.diagnostics>\n    <sources>\n      <source name=\"DefaultSource\" switchName=\"DefaultSwitch\">\n        <listeners>\n          <add name=\"FileLog\"/>\n        </listeners>\n      </source>\n    </sources>\n    <switches>\n      <add name=\"DefaultSwitch\" value=\"Information\" />\n    </switches>\n    <sharedListeners>\n      <add name=\"FileLog\"\n        type=\"Microsoft.VisualBasic.Logging.FileLogTraceListener,\n          Microsoft.VisualBasic, Version=8.0.0.0, Culture=neutral,\n          PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL\"\n        initializeData=\"FileLogWriter\"\n      />\n    </sharedListeners>\n  </system.diagnostics>\n</configuration>\n```\n\n## Changing Log Settings after Deployment\n\nWhen you develop an application, its configuration settings are stored in the app.config file, as shown in the examples above. After you deploy your application, you can still configure the log by editing the configuration file. In a Windows-based application, this file's name is *applicationName*.exe.config, and it must reside in the same folder as the executable file. For a Web application, this is the Web.config file associated with the project.\n\nWhen your application executes the code that creates an instance of a class for the first time, it checks the configuration file for information about the object. For the `Log` object, this happens the first time the `Log` object is accessed. The system examines the configuration file only once for any particular object—the first time your application creates the object. Therefore, you may need to restart the application for the changes to take effect.\n\nIn a deployed application, you enable trace code by reconfiguring switch objects before your application starts. Typically, this involves turning the switch objects on and off or by changing the tracing levels, and then restarting your application.\n\n## Security Considerations\n\nConsider the following when writing data to the log:\n\n- **Avoid leaking user information.** Ensure that your application writes only approved information to the log. For example, it may be acceptable for the application log to contain user names, but not user passwords.\n\n- **Make log locations secure.** Any log that contains potentially sensitive information should be stored in a secure location.\n\n- **Avoid misleading information.** In general, your application should validate all data entered by a user before using that data. This includes writing data to the application log.\n\n- **Avoid denial of service.** If your application writes too much information to the log, it could fill the log or make finding important information difficult.\n\n## See also\n\n- <xref:Microsoft.VisualBasic.Logging.Log?displayProperty=nameWithType>\n- [Logging Information from the Application](../../../../visual-basic/developing-apps/programming/log-info/index.md)\n","nodes":[{"pos":[4,244],"embed":true,"restype":"x-metadata","content":"title: \"Working with Application Logs in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords:\n  - \"logs, application\"\n  - \"application event logs, Visual Basic\"\n  - \"application event logs\"\nms.assetid: 2581afd1-5791-4bc4-86b2-46244e9fe468","nodes":[{"content":"Working with Application Logs in Visual Basic","nodes":[{"pos":[0,45],"content":"Working with Application Logs in Visual Basic","nodes":[{"content":"Working with Application Logs in Visual Basic","pos":[0,45]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[252,297],"content":"Working with Application Logs in Visual Basic","linkify":"Working with Application Logs in Visual Basic","nodes":[{"content":"Working with Application Logs in Visual Basic","pos":[0,45]}]},{"pos":[299,407],"content":"The <ph id=\"ph1\">`My.Application.Log`</ph> and <ph id=\"ph2\">`My.Log`</ph> objects make it easy to write logging and tracing information to logs.","source":"The `My.Application.Log` and `My.Log` objects make it easy to write logging and tracing information to logs."},{"pos":[412,435],"content":"How Messages are Logged","linkify":"How Messages are Logged","nodes":[{"content":"How Messages are Logged","pos":[0,23]}]},{"content":"First, the severity of the message is checked with the <ph id=\"ph1\">&lt;xref:System.Diagnostics.TraceSource.Switch%2A&gt;</ph> property of the log's <ph id=\"ph2\">&lt;xref:Microsoft.VisualBasic.Logging.Log.TraceSource%2A&gt;</ph> property.","pos":[437,627],"source":"First, the severity of the message is checked with the <xref:System.Diagnostics.TraceSource.Switch%2A> property of the log's <xref:Microsoft.VisualBasic.Logging.Log.TraceSource%2A> property."},{"content":"By default, only messages of severity \"Information\" and higher are passed on to the trace listeners, specified in the log's <ph id=\"ph1\">`TraceListener`</ph> collection.","pos":[628,779],"source":" By default, only messages of severity \"Information\" and higher are passed on to the trace listeners, specified in the log's `TraceListener` collection."},{"content":"Then, each listener compares the severity of the message to the listener's <ph id=\"ph1\">&lt;xref:System.Diagnostics.TraceSource.Switch%2A&gt;</ph> property.","pos":[780,912],"source":" Then, each listener compares the severity of the message to the listener's <xref:System.Diagnostics.TraceSource.Switch%2A> property."},{"content":"If the message's severity is high enough, the listener writes out the message.","pos":[913,991]},{"pos":[993,1138],"content":"The following diagram shows how a message written to the <ph id=\"ph1\">`WriteEntry`</ph> method gets passed to the <ph id=\"ph2\">`WriteLine`</ph> methods of the log's trace listeners:","source":"The following diagram shows how a message written to the `WriteEntry` method gets passed to the `WriteLine` methods of the log's trace listeners:"},{"content":"Diagram that shows My log call.","pos":[1142,1173]},{"content":"You can change the behavior of the log and the trace listeners by changing the application's configuration file.","pos":[1240,1352]},{"content":"The following diagram shows the correspondence between the parts of the log and the configuration file.","pos":[1353,1456]},{"content":"Diagram that shows My log configuration.","pos":[1460,1500]},{"pos":[1570,1595],"content":"Where Messages are Logged","linkify":"Where Messages are Logged","nodes":[{"content":"Where Messages are Logged","pos":[0,25]}]},{"content":"If the assembly has no configuration file, the <ph id=\"ph1\">`My.Application.Log`</ph> and <ph id=\"ph2\">`My.Log`</ph> objects write to the application's debug output (through the <ph id=\"ph3\">&lt;xref:System.Diagnostics.DefaultTraceListener&gt;</ph> class).","pos":[1597,1793],"source":"If the assembly has no configuration file, the `My.Application.Log` and `My.Log` objects write to the application's debug output (through the <xref:System.Diagnostics.DefaultTraceListener> class)."},{"content":"In addition, the <ph id=\"ph1\">`My.Application.Log`</ph> object writes to the assembly's log file (through the <ph id=\"ph2\">&lt;xref:Microsoft.VisualBasic.Logging.FileLogTraceListener&gt;</ph> class), while the <ph id=\"ph3\">`My.Log`</ph> object writes to the ASP.NET Web page's output (through the <ph id=\"ph4\">&lt;xref:System.Web.WebPageTraceListener&gt;</ph> class).","pos":[1794,2077],"source":" In addition, the `My.Application.Log` object writes to the assembly's log file (through the <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener> class), while the `My.Log` object writes to the ASP.NET Web page's output (through the <xref:System.Web.WebPageTraceListener> class)."},{"content":"The debug output can be viewed in the Visual Studio <bpt id=\"p1\">**</bpt>Output<ept id=\"p1\">**</ept> window when running your application in debug mode.","pos":[2079,2193],"source":"The debug output can be viewed in the Visual Studio **Output** window when running your application in debug mode."},{"content":"To open the <bpt id=\"p1\">**</bpt>Output<ept id=\"p1\">**</ept> window, click the <bpt id=\"p2\">**</bpt>Debug<ept id=\"p2\">**</ept> menu item, point to <bpt id=\"p3\">**</bpt>Windows<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>Output<ept id=\"p4\">**</ept>.","pos":[2194,2304],"source":" To open the **Output** window, click the **Debug** menu item, point to **Windows**, and then click **Output**."},{"content":"In the <bpt id=\"p1\">**</bpt>Output<ept id=\"p1\">**</ept> window, select <bpt id=\"p2\">**</bpt>Debug<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Show output from<ept id=\"p3\">**</ept> box.","pos":[2305,2382],"source":" In the **Output** window, select **Debug** from the **Show output from** box."},{"content":"By default, <ph id=\"ph1\">`My.Application.Log`</ph> writes the log file in the path for the user's application data.","pos":[2384,2481],"source":"By default, `My.Application.Log` writes the log file in the path for the user's application data."},{"content":"You can get the path from the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.FullLogFileName%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:Microsoft.VisualBasic.Logging.Log.DefaultFileLogWriter%2A&gt;</ph> object.","pos":[2482,2677],"source":" You can get the path from the <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener.FullLogFileName%2A> property of the <xref:Microsoft.VisualBasic.Logging.Log.DefaultFileLogWriter%2A> object."},{"content":"The format of that path is as follows:","pos":[2678,2716]},{"pos":[2778,2823],"content":"A typical value for <ph id=\"ph1\">`BasePath`</ph> is as follows.","source":"A typical value for `BasePath` is as follows."},{"pos":[2825,2879],"content":"C:\\Documents and Settings<ph id=\"ph1\">\\\\</ph><ph id=\"ph2\">`username`</ph>\\Application Data","source":"C:\\Documents and Settings\\\\`username`\\Application Data"},{"content":"The values of <ph id=\"ph1\">`CompanyName`</ph>, <ph id=\"ph2\">`ProductName`</ph>, and <ph id=\"ph3\">`ProductVersion`</ph> come from the application's assembly information.","pos":[2881,2995],"source":"The values of `CompanyName`, `ProductName`, and `ProductVersion` come from the application's assembly information."},{"content":"The form of the log file name is <bpt id=\"p1\">*</bpt>AssemblyName<ept id=\"p1\">*</ept>.log, where <bpt id=\"p2\">*</bpt>AssemblyName<ept id=\"p2\">*</ept> is the file name of the assembly without the extension.","pos":[2996,3125],"source":" The form of the log file name is *AssemblyName*.log, where *AssemblyName* is the file name of the assembly without the extension."},{"content":"If more than one log file is needed, such as when the original log is unavailable when the application attempts to write to the log, the form for the log file name is <bpt id=\"p1\">*</bpt>AssemblyName<ept id=\"p1\">*</ept><ph id=\"ph1\">-</ph><bpt id=\"p2\">*</bpt>iteration<ept id=\"p2\">*</ept>.log, where <ph id=\"ph2\">`iteration`</ph> is a positive <ph id=\"ph3\">`Integer`</ph>.","pos":[3126,3367],"source":" If more than one log file is needed, such as when the original log is unavailable when the application attempts to write to the log, the form for the log file name is *AssemblyName*-*iteration*.log, where `iteration` is a positive `Integer`."},{"content":"You can override the default behavior by adding or changing the computer's and the application's configuration files.","pos":[3369,3486]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Changing Where My.Application.Log Writes Information<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-changing-where-my-application-log-writes-information.md)</ept>.","pos":[3487,3712],"source":" For more information, see [Walkthrough: Changing Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-changing-where-my-application-log-writes-information.md)."},{"pos":[3717,3741],"content":"Configuring Log Settings","linkify":"Configuring Log Settings","nodes":[{"content":"Configuring Log Settings","pos":[0,24]}]},{"content":"The <ph id=\"ph1\">`Log`</ph> object has a default implementation that works without an application configuration file, app.config. To change the defaults, you must add a configuration file with the new settings.","pos":[3743,3935],"source":"The `Log` object has a default implementation that works without an application configuration file, app.config. To change the defaults, you must add a configuration file with the new settings."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Filtering My.Application.Log Output<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md)</ept>.","pos":[3936,4127],"source":" For more information, see [Walkthrough: Filtering My.Application.Log Output](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md)."},{"content":"The log configuration sections are located in the <ph id=\"ph1\">`&lt;system.diagnostics&gt;`</ph> node in the main <ph id=\"ph2\">`&lt;configuration&gt;`</ph> node of the app.config file.","pos":[4129,4265],"source":"The log configuration sections are located in the `<system.diagnostics>` node in the main `<configuration>` node of the app.config file."},{"content":"Log information is defined in several nodes:","pos":[4266,4310]},{"pos":[4314,4405],"content":"The listeners for the <ph id=\"ph1\">`Log`</ph> object are defined in the <ph id=\"ph2\">`&lt;sources&gt;`</ph> node named DefaultSource.","source":"The listeners for the `Log` object are defined in the `<sources>` node named DefaultSource."},{"pos":[4409,4506],"content":"The severity filter for the <ph id=\"ph1\">`Log`</ph> object is defined in the <ph id=\"ph2\">`&lt;switches&gt;`</ph> node named DefaultSwitch.","source":"The severity filter for the `Log` object is defined in the `<switches>` node named DefaultSwitch."},{"pos":[4510,4572],"content":"The log listeners are defined in the <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> node.","source":"The log listeners are defined in the `<sharedListeners>` node."},{"pos":[4575,4676],"content":"Examples of <ph id=\"ph1\">`&lt;sources&gt;`</ph>, <ph id=\"ph2\">`&lt;switches&gt;`</ph>, and <ph id=\"ph3\">`&lt;sharedListeners&gt;`</ph> nodes are shown in the following code:","source":"Examples of `<sources>`, `<switches>`, and `<sharedListeners>` nodes are shown in the following code:"},{"pos":[5363,5401],"content":"Changing Log Settings after Deployment","linkify":"Changing Log Settings after Deployment","nodes":[{"content":"Changing Log Settings after Deployment","pos":[0,38]}]},{"content":"When you develop an application, its configuration settings are stored in the app.config file, as shown in the examples above.","pos":[5403,5529]},{"content":"After you deploy your application, you can still configure the log by editing the configuration file.","pos":[5530,5631]},{"content":"In a Windows-based application, this file's name is <bpt id=\"p1\">*</bpt>applicationName<ept id=\"p1\">*</ept>.exe.config, and it must reside in the same folder as the executable file.","pos":[5632,5775],"source":" In a Windows-based application, this file's name is *applicationName*.exe.config, and it must reside in the same folder as the executable file."},{"content":"For a Web application, this is the Web.config file associated with the project.","pos":[5776,5855]},{"content":"When your application executes the code that creates an instance of a class for the first time, it checks the configuration file for information about the object.","pos":[5857,6019]},{"content":"For the <ph id=\"ph1\">`Log`</ph> object, this happens the first time the <ph id=\"ph2\">`Log`</ph> object is accessed.","pos":[6020,6099],"source":" For the `Log` object, this happens the first time the `Log` object is accessed."},{"content":"The system examines the configuration file only once for any particular object—the first time your application creates the object.","pos":[6100,6230]},{"content":"Therefore, you may need to restart the application for the changes to take effect.","pos":[6231,6313]},{"content":"In a deployed application, you enable trace code by reconfiguring switch objects before your application starts.","pos":[6315,6427]},{"content":"Typically, this involves turning the switch objects on and off or by changing the tracing levels, and then restarting your application.","pos":[6428,6563]},{"pos":[6568,6591],"content":"Security Considerations","linkify":"Security Considerations","nodes":[{"content":"Security Considerations","pos":[0,23]}]},{"content":"Consider the following when writing data to the log:","pos":[6593,6645]},{"content":"<bpt id=\"p1\">**</bpt>Avoid leaking user information.<ept id=\"p1\">**</ept>","pos":[6649,6684],"source":"**Avoid leaking user information.**"},{"content":"Ensure that your application writes only approved information to the log.","pos":[6685,6758]},{"content":"For example, it may be acceptable for the application log to contain user names, but not user passwords.","pos":[6759,6863]},{"content":"<bpt id=\"p1\">**</bpt>Make log locations secure.<ept id=\"p1\">**</ept>","pos":[6867,6897],"source":"**Make log locations secure.**"},{"content":"Any log that contains potentially sensitive information should be stored in a secure location.","pos":[6898,6992]},{"content":"<bpt id=\"p1\">**</bpt>Avoid misleading information.<ept id=\"p1\">**</ept>","pos":[6996,7029],"source":"**Avoid misleading information.**"},{"content":"In general, your application should validate all data entered by a user before using that data.","pos":[7030,7125]},{"content":"This includes writing data to the application log.","pos":[7126,7176]},{"content":"<bpt id=\"p1\">**</bpt>Avoid denial of service.<ept id=\"p1\">**</ept>","pos":[7180,7208],"source":"**Avoid denial of service.**"},{"content":"If your application writes too much information to the log, it could fill the log or make finding important information difficult.","pos":[7209,7339]},{"pos":[7344,7352],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7428,7542],"content":"<bpt id=\"p1\">[</bpt>Logging Information from the Application<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/index.md)</ept>","source":"[Logging Information from the Application](../../../../visual-basic/developing-apps/programming/log-info/index.md)"}]}