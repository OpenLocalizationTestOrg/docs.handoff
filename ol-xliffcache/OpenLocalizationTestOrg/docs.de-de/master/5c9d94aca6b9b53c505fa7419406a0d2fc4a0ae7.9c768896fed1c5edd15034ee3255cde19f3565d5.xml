{"content":"---\ntitle: \"Implementing the UI Automation Invoke Control Pattern\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"UI Automation, Invoke control pattern\"\n  - \"control patterns, Invoke\"\n  - \"Invoke control pattern\"\nms.assetid: e5b1e239-49f8-468e-bfec-1fba02ec9ac4\n---\n# Implementing the UI Automation Invoke Control Pattern\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IInvokeProvider>, including information about events and properties. Links to additional references are listed at the end of the topic.  \n  \n The <xref:System.Windows.Automation.InvokePattern> control pattern is used to support controls that do not maintain state when activated but rather initiate or perform a single, unambiguous action. Controls that do maintain state, such as check boxes and radio buttons, must instead implement <xref:System.Windows.Automation.Provider.IToggleProvider> and <xref:System.Windows.Automation.Provider.ISelectionItemProvider> respectively. For examples of controls that implement the Invoke control pattern, see [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md).  \n  \n<a name=\"Implementation_Guidelines_and_Conventions\"></a>   \n## Implementation Guidelines and Conventions  \n When implementing the Invoke control pattern, note the following guidelines and conventions:  \n  \n-   Controls implement <xref:System.Windows.Automation.Provider.IInvokeProvider> if the same behavior is not exposed through another control pattern provider. For example, if the <xref:System.Windows.Automation.InvokePattern.Invoke%2A> method on a control performs the same action as the <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> or <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> method, the control should not implement <xref:System.Windows.Automation.Provider.IInvokeProvider>.  \n  \n-   Invoking a control is generally performed by clicking or double-clicking or pressing ENTER, a predefined keyboard shortcut, or some alternate combination of keystrokes.  \n  \n-   <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> is raised on a control that has been activated (as a response to a control carrying out its associated action). If possible, the event should be raised after the control has completed the action and returned without blocking. The Invoked event should be raised before servicing the Invoke request in the following scenarios:  \n  \n    -   It is not possible or practical to wait until the action is complete.  \n  \n    -   The action requires user interaction.  \n  \n    -   The action is time-consuming and will cause the calling client to block for a significant amount of time.  \n  \n-   If invoking the control has significant side-effects, those side-effects should be exposed through the <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.HelpText%2A> property. For example, even though <xref:System.Windows.Automation.Provider.IInvokeProvider.Invoke%2A> is not associated with selection, <xref:System.Windows.Automation.Provider.IInvokeProvider.Invoke%2A> may cause another control to become selected.  \n  \n-   Hover (or mouse-over) effects generally do not constitute an Invoked event. However, controls that perform an action (as opposed to cause a visual effect) based on the hover state should support the <xref:System.Windows.Automation.InvokePattern> control pattern.  \n  \n> [!NOTE]\n>  This implementation is considered an accessibility issue if the control can be invoked only as a result of a mouse-related side effect.  \n  \n-   Invoking a control is different from selecting an item. However, depending on the control, invoking it may cause the item to become selected as a side-effect. For example, invoking a [!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)] document list item in the My Documents folder both selects the item and opens the document.  \n  \n-   An element can disappear from the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree immediately upon being invoked. Requesting information from the element provided by the event callback may fail as a result. Pre-fetching cached information is the recommended workaround.  \n  \n-   Controls can implement multiple control patterns. For example, the Fill Color control on the [!INCLUDE[TLA#tla_xl](../../../includes/tlasharptla-xl-md.md)] toolbar implements both the <xref:System.Windows.Automation.InvokePattern> and the <xref:System.Windows.Automation.ExpandCollapsePattern> control patterns. <xref:System.Windows.Automation.ExpandCollapsePattern> exposes the menu and the <xref:System.Windows.Automation.InvokePattern> fills the active selection with the chosen color.  \n  \n<a name=\"Required_Members_for_the_IValueProvider_Interface\"></a>   \n## Required Members for IInvokeProvider  \n The following properties and methods are required for implementing <xref:System.Windows.Automation.Provider.IInvokeProvider>.  \n  \n|Required members|Member type|Notes|  \n|----------------------|-----------------|-----------|  \n|<xref:System.Windows.Automation.Provider.IInvokeProvider.Invoke%2A>|method|<xref:System.Windows.Automation.Provider.IInvokeProvider.Invoke%2A> is an asynchronous call and must return immediately without blocking.<br /><br /> This behavior is particularly critical for controls that, directly or indirectly, launch a modal dialog when invoked. Any UI Automation client that instigated the event will remain blocked until the modal dialog is closed.|  \n  \n<a name=\"Exceptions\"></a>   \n## Exceptions  \n Providers must throw the following exceptions.  \n  \n|Exception Type|Condition|  \n|--------------------|---------------|  \n|<xref:System.Windows.Automation.ElementNotEnabledException>|If the control is not enabled.|  \n  \n## See also\n\n- [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)\n- [Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)\n- [UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)\n- [Invoke a Control Using UI Automation](../../../docs/framework/ui-automation/invoke-a-control-using-ui-automation.md)\n- [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)\n- [Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)\n","nodes":[{"pos":[4,263],"embed":true,"restype":"x-metadata","content":"title: \"Implementing the UI Automation Invoke Control Pattern\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"UI Automation, Invoke control pattern\"\n  - \"control patterns, Invoke\"\n  - \"Invoke control pattern\"\nms.assetid: e5b1e239-49f8-468e-bfec-1fba02ec9ac4","nodes":[{"content":"Implementing the UI Automation Invoke Control Pattern","nodes":[{"pos":[0,53],"content":"Implementing the UI Automation Invoke Control Pattern","nodes":[{"content":"Implementing the UI Automation Invoke Control Pattern","pos":[0,53]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[270,323],"content":"Implementing the UI Automation Invoke Control Pattern","linkify":"Implementing the UI Automation Invoke Control Pattern","nodes":[{"content":"Implementing the UI Automation Invoke Control Pattern","pos":[0,53]}]},{"pos":[326,789],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,461],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"content":"This topic introduces guidelines and conventions for implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IInvokeProvider&gt;</ph>, including information about events and properties.","pos":[796,971],"source":"This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IInvokeProvider>, including information about events and properties."},{"content":"Links to additional references are listed at the end of the topic.","pos":[972,1038]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Automation.InvokePattern&gt;</ph> control pattern is used to support controls that do not maintain state when activated but rather initiate or perform a single, unambiguous action.","pos":[1045,1242],"source":"The <xref:System.Windows.Automation.InvokePattern> control pattern is used to support controls that do not maintain state when activated but rather initiate or perform a single, unambiguous action."},{"content":"Controls that do maintain state, such as check boxes and radio buttons, must instead implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IToggleProvider&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.ISelectionItemProvider&gt;</ph> respectively.","pos":[1243,1478],"source":" Controls that do maintain state, such as check boxes and radio buttons, must instead implement <xref:System.Windows.Automation.Provider.IToggleProvider> and <xref:System.Windows.Automation.Provider.ISelectionItemProvider> respectively."},{"content":"For examples of controls that implement the Invoke control pattern, see <bpt id=\"p1\">[</bpt>Control Pattern Mapping for UI Automation Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)</ept>.","pos":[1479,1695],"source":" For examples of controls that implement the Invoke control pattern, see [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)."},{"pos":[1764,1805],"content":"Implementation Guidelines and Conventions","linkify":"Implementation Guidelines and Conventions","nodes":[{"content":"Implementation Guidelines and Conventions","pos":[0,41]}]},{"content":"When implementing the Invoke control pattern, note the following guidelines and conventions:","pos":[1809,1901]},{"content":"Controls implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IInvokeProvider&gt;</ph> if the same behavior is not exposed through another control pattern provider.","pos":[1911,2065],"source":"Controls implement <xref:System.Windows.Automation.Provider.IInvokeProvider> if the same behavior is not exposed through another control pattern provider."},{"content":"For example, if the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.InvokePattern.Invoke%2A&gt;</ph> method on a control performs the same action as the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A&gt;</ph> method, the control should not implement <ph id=\"ph4\">&lt;xref:System.Windows.Automation.Provider.IInvokeProvider&gt;</ph>.","pos":[2066,2429],"source":" For example, if the <xref:System.Windows.Automation.InvokePattern.Invoke%2A> method on a control performs the same action as the <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> or <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> method, the control should not implement <xref:System.Windows.Automation.Provider.IInvokeProvider>."},{"content":"Invoking a control is generally performed by clicking or double-clicking or pressing ENTER, a predefined keyboard shortcut, or some alternate combination of keystrokes.","pos":[2439,2607]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent&gt;</ph> is raised on a control that has been activated (as a response to a control carrying out its associated action).","pos":[2617,2799],"source":"<xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> is raised on a control that has been activated (as a response to a control carrying out its associated action)."},{"content":"If possible, the event should be raised after the control has completed the action and returned without blocking.","pos":[2800,2913]},{"content":"The Invoked event should be raised before servicing the Invoke request in the following scenarios:","pos":[2914,3012]},{"content":"It is not possible or practical to wait until the action is complete.","pos":[3026,3095]},{"content":"The action requires user interaction.","pos":[3109,3146]},{"content":"The action is time-consuming and will cause the calling client to block for a significant amount of time.","pos":[3160,3265]},{"content":"If invoking the control has significant side-effects, those side-effects should be exposed through the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.HelpText%2A&gt;</ph> property.","pos":[3275,3479],"source":"If invoking the control has significant side-effects, those side-effects should be exposed through the <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.HelpText%2A> property."},{"content":"For example, even though <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IInvokeProvider.Invoke%2A&gt;</ph> is not associated with selection, <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.IInvokeProvider.Invoke%2A&gt;</ph> may cause another control to become selected.","pos":[3480,3720],"source":" For example, even though <xref:System.Windows.Automation.Provider.IInvokeProvider.Invoke%2A> is not associated with selection, <xref:System.Windows.Automation.Provider.IInvokeProvider.Invoke%2A> may cause another control to become selected."},{"content":"Hover (or mouse-over) effects generally do not constitute an Invoked event.","pos":[3730,3805]},{"content":"However, controls that perform an action (as opposed to cause a visual effect) based on the hover state should support the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.InvokePattern&gt;</ph> control pattern.","pos":[3806,3992],"source":" However, controls that perform an action (as opposed to cause a visual effect) based on the hover state should support the <xref:System.Windows.Automation.InvokePattern> control pattern."},{"pos":[4000,4146],"content":"[!NOTE]\n This implementation is considered an accessibility issue if the control can be invoked only as a result of a mouse-related side effect.","leadings":["","> "],"nodes":[{"content":"This implementation is considered an accessibility issue if the control can be invoked only as a result of a mouse-related side effect.","pos":[9,144]}]},{"content":"Invoking a control is different from selecting an item.","pos":[4156,4211]},{"content":"However, depending on the control, invoking it may cause the item to become selected as a side-effect.","pos":[4212,4314]},{"content":"For example, invoking a <ph id=\"ph1\">[!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)]</ph> document list item in the My Documents folder both selects the item and opens the document.","pos":[4315,4497],"source":" For example, invoking a [!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)] document list item in the My Documents folder both selects the item and opens the document."},{"content":"An element can disappear from the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> tree immediately upon being invoked.","pos":[4507,4662],"source":"An element can disappear from the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree immediately upon being invoked."},{"content":"Requesting information from the element provided by the event callback may fail as a result.","pos":[4663,4755]},{"content":"Pre-fetching cached information is the recommended workaround.","pos":[4756,4818]},{"content":"Controls can implement multiple control patterns.","pos":[4828,4877]},{"content":"For example, the Fill Color control on the <ph id=\"ph1\">[!INCLUDE[TLA#tla_xl](../../../includes/tlasharptla-xl-md.md)]</ph> toolbar implements both the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.InvokePattern&gt;</ph> and the <ph id=\"ph3\">&lt;xref:System.Windows.Automation.ExpandCollapsePattern&gt;</ph> control patterns.","pos":[4878,5139],"source":" For example, the Fill Color control on the [!INCLUDE[TLA#tla_xl](../../../includes/tlasharptla-xl-md.md)] toolbar implements both the <xref:System.Windows.Automation.InvokePattern> and the <xref:System.Windows.Automation.ExpandCollapsePattern> control patterns."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.ExpandCollapsePattern&gt;</ph> exposes the menu and the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.InvokePattern&gt;</ph> fills the active selection with the chosen color.","pos":[5140,5316],"source":"<xref:System.Windows.Automation.ExpandCollapsePattern> exposes the menu and the <xref:System.Windows.Automation.InvokePattern> fills the active selection with the chosen color."},{"pos":[5393,5429],"content":"Required Members for IInvokeProvider","linkify":"Required Members for IInvokeProvider","nodes":[{"content":"Required Members for IInvokeProvider","pos":[0,36]}]},{"pos":[5433,5558],"content":"The following properties and methods are required for implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IInvokeProvider&gt;</ph>.","source":"The following properties and methods are required for implementing <xref:System.Windows.Automation.Provider.IInvokeProvider>."},{"content":"Required members","pos":[5565,5581]},{"content":"Member type","pos":[5582,5593]},{"content":"Notes","pos":[5594,5599]},{"content":"method","pos":[5729,5735]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IInvokeProvider.Invoke%2A&gt;</ph> is an asynchronous call and must return immediately without blocking.","pos":[5736,5873],"source":"<xref:System.Windows.Automation.Provider.IInvokeProvider.Invoke%2A> is an asynchronous call and must return immediately without blocking."},{"content":"This behavior is particularly critical for controls that, directly or indirectly, launch a modal dialog when invoked.","pos":[5886,6003]},{"content":"Any UI Automation client that instigated the event will remain blocked until the modal dialog is closed.","pos":[6004,6108]},{"pos":[6147,6157],"content":"Exceptions","linkify":"Exceptions","nodes":[{"content":"Exceptions","pos":[0,10]}]},{"content":"Providers must throw the following exceptions.","pos":[6161,6207]},{"content":"Exception Type","pos":[6214,6228]},{"content":"Condition","pos":[6229,6238]},{"content":"If the control is not enabled.","pos":[6344,6374]},{"pos":[6384,6392],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6396,6519],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)</ept>","source":"[UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)"},{"pos":[6522,6671],"content":"<bpt id=\"p1\">[</bpt>Support Control Patterns in a UI Automation Provider<ept id=\"p1\">](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)</ept>","source":"[Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)"},{"pos":[6674,6803],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns for Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)</ept>","source":"[UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)"},{"pos":[6806,6923],"content":"<bpt id=\"p1\">[</bpt>Invoke a Control Using UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/invoke-a-control-using-ui-automation.md)</ept>","source":"[Invoke a Control Using UI Automation](../../../docs/framework/ui-automation/invoke-a-control-using-ui-automation.md)"},{"pos":[6926,7025],"content":"<bpt id=\"p1\">[</bpt>UI Automation Tree Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</ept>","source":"[UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)"},{"pos":[7028,7129],"content":"<bpt id=\"p1\">[</bpt>Use Caching in UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)</ept>","source":"[Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)"}]}