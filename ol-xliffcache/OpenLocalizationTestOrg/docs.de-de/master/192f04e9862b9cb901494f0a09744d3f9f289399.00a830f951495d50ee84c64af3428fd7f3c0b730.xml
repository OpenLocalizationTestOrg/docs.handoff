{"content":"---\ntitle: \"How to: Retrieve Paragraphs from an Office Open XML Document (C#)\"\nms.date: 07/20/2015\nms.assetid: cc2687cf-d648-451e-88ac-3847c6c967c8\n---\n# How to: Retrieve Paragraphs from an Office Open XML Document (C#)\nThis topic presents an example that opens an Office Open XML document, and retrieves a collection of all of the paragraphs in the document.  \n  \n For more information on Office Open XML, see [Open XML SDK](https://github.com/OfficeDev/Open-XML-SDK) and [www.ericwhite.com](http://ericwhite.com/).  \n  \n## Example  \n This example opens an Office Open XML package, uses the relationships within the Open XML package to find the document and the style parts. It then queries the document, projecting a collection of an anonymous type that contains the paragraph <xref:System.Xml.Linq.XElement> node, the style name of each paragraph, and the text of each paragraph.  \n  \n The example uses an extension method named `StringConcatenate`, which is also supplied in the example.  \n  \n For a detailed tutorial that explains how this example works, see [Pure Functional Transformations of XML (C#)](../../../../csharp/programming-guide/concepts/linq/pure-functional-transformations-of-xml.md).  \n  \n This example uses classes found in the WindowsBase assembly. It uses types in the <xref:System.IO.Packaging?displayProperty=nameWithType> namespace.  \n  \n```csharp  \npublic static class LocalExtensions  \n{  \n    public static string StringConcatenate(this IEnumerable<string> source)  \n    {  \n        StringBuilder sb = new StringBuilder();  \n        foreach (string s in source)  \n            sb.Append(s);  \n        return sb.ToString();  \n    }  \n  \n    public static string StringConcatenate<T>(this IEnumerable<T> source,  \n        Func<T, string> func)  \n    {  \n        StringBuilder sb = new StringBuilder();  \n        foreach (T item in source)  \n            sb.Append(func(item));  \n        return sb.ToString();  \n    }  \n  \n    public static string StringConcatenate(this IEnumerable<string> source, string separator)  \n    {  \n        StringBuilder sb = new StringBuilder();  \n        foreach (string s in source)  \n            sb.Append(s).Append(separator);  \n        return sb.ToString();  \n    }  \n  \n    public static string StringConcatenate<T>(this IEnumerable<T> source,  \n        Func<T, string> func, string separator)  \n    {  \n        StringBuilder sb = new StringBuilder();  \n        foreach (T item in source)  \n            sb.Append(func(item)).Append(separator);  \n        return sb.ToString();  \n    }  \n}  \n  \nclass Program  \n{  \n    public static string ParagraphText(XElement e)  \n    {  \n        XNamespace w = e.Name.Namespace;  \n        return e  \n               .Elements(w + \"r\")  \n               .Elements(w + \"t\")  \n               .StringConcatenate(element => (string)element);  \n    }  \n  \n    static void Main(string[] args)  \n    {  \n        const string fileName = \"SampleDoc.docx\";  \n  \n        const string documentRelationshipType =  \n          \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\";  \n        const string stylesRelationshipType =  \n          \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\";  \n        const string wordmlNamespace =  \n          \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\";  \n        XNamespace w = wordmlNamespace;  \n  \n        XDocument xDoc = null;  \n        XDocument styleDoc = null;  \n  \n        using (Package wdPackage = Package.Open(fileName, FileMode.Open, FileAccess.Read))  \n        {  \n            PackageRelationship docPackageRelationship =  \n              wdPackage  \n              .GetRelationshipsByType(documentRelationshipType)  \n              .FirstOrDefault();  \n            if (docPackageRelationship != null)  \n            {  \n                Uri documentUri =  \n                    PackUriHelper  \n                    .ResolvePartUri(  \n                       new Uri(\"/\", UriKind.Relative),  \n                             docPackageRelationship.TargetUri);  \n                PackagePart documentPart =  \n                    wdPackage.GetPart(documentUri);  \n  \n                //  Load the document XML in the part into an XDocument instance.  \n                xDoc = XDocument.Load(XmlReader.Create(documentPart.GetStream()));  \n  \n                //  Find the styles part. There will only be one.  \n                PackageRelationship styleRelation =  \n                  documentPart.GetRelationshipsByType(stylesRelationshipType)  \n                  .FirstOrDefault();  \n                if (styleRelation != null)  \n                {  \n                    Uri styleUri = PackUriHelper.ResolvePartUri(documentUri, styleRelation.TargetUri);  \n                    PackagePart stylePart = wdPackage.GetPart(styleUri);  \n  \n                    //  Load the style XML in the part into an XDocument instance.  \n                    styleDoc = XDocument.Load(XmlReader.Create(stylePart.GetStream()));  \n                }  \n            }  \n        }  \n  \n        string defaultStyle =  \n            (string)(  \n                from style in styleDoc.Root.Elements(w + \"style\")  \n                where (string)style.Attribute(w + \"type\") == \"paragraph\" &&  \n                      (string)style.Attribute(w + \"default\") == \"1\"  \n                select style  \n            ).First().Attribute(w + \"styleId\");  \n  \n        // Find all paragraphs in the document.  \n        var paragraphs =  \n            from para in xDoc  \n                         .Root  \n                         .Element(w + \"body\")  \n                         .Descendants(w + \"p\")  \n            let styleNode = para  \n                            .Elements(w + \"pPr\")  \n                            .Elements(w + \"pStyle\")  \n                            .FirstOrDefault()  \n            select new  \n            {  \n                ParagraphNode = para,  \n                StyleName = styleNode != null ?  \n                    (string)styleNode.Attribute(w + \"val\") :  \n                    defaultStyle  \n            };  \n  \n        // Retrieve the text of each paragraph.  \n        var paraWithText =  \n            from para in paragraphs  \n            select new  \n            {  \n                ParagraphNode = para.ParagraphNode,  \n                StyleName = para.StyleName,  \n                Text = ParagraphText(para.ParagraphNode)  \n            };  \n  \n        foreach (var p in paraWithText)  \n            Console.WriteLine(\"StyleName:{0} >{1}<\", p.StyleName, p.Text);  \n    }  \n}  \n```  \n  \n When run with the sample Open XML document described in [Creating the Source Office Open XML Document (C#)](../../../../csharp/programming-guide/concepts/linq/creating-the-source-office-open-xml-document.md), this example produces the following output:  \n  \n```  \nStyleName:Heading1 >Parsing WordprocessingML with LINQ to XML<  \nStyleName:Normal ><  \nStyleName:Normal >The following example prints to the console.<  \nStyleName:Normal ><  \nStyleName:Code >using System;<  \nStyleName:Code ><  \nStyleName:Code >class Program {<  \nStyleName:Code >    public static void (string[] args) {<  \nStyleName:Code >        Console.WriteLine(\"Hello World\");<  \nStyleName:Code >    }<  \nStyleName:Code >}<  \nStyleName:Normal ><  \nStyleName:Normal >This example produces the following output:<  \nStyleName:Normal ><  \nStyleName:Code >Hello World<  \n```  \n  \n## See also\n\n- [Advanced Query Techniques (LINQ to XML) (C#)](../../../../csharp/programming-guide/concepts/linq/advanced-query-techniques-linq-to-xml.md)\n","nodes":[{"pos":[4,147],"embed":true,"restype":"x-metadata","content":"title: \"How to: Retrieve Paragraphs from an Office Open XML Document (C#)\"\nms.date: 07/20/2015\nms.assetid: cc2687cf-d648-451e-88ac-3847c6c967c8","nodes":[{"content":"How to: Retrieve Paragraphs from an Office Open XML Document (C#)","nodes":[{"pos":[0,65],"content":"How to: Retrieve Paragraphs from an Office Open XML Document (C#)","nodes":[{"content":"How to: Retrieve Paragraphs from an Office Open XML Document (C#)","pos":[0,65]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[154,219],"content":"How to: Retrieve Paragraphs from an Office Open XML Document (C#)","linkify":"How to: Retrieve Paragraphs from an Office Open XML Document (C#)","nodes":[{"content":"How to: Retrieve Paragraphs from an Office Open XML Document (C#)","pos":[0,65]}]},{"content":"This topic presents an example that opens an Office Open XML document, and retrieves a collection of all of the paragraphs in the document.","pos":[220,359]},{"pos":[366,516],"content":"For more information on Office Open XML, see <bpt id=\"p1\">[</bpt>Open XML SDK<ept id=\"p1\">](https://github.com/OfficeDev/Open-XML-SDK)</ept> and <bpt id=\"p2\">[</bpt>www.ericwhite.com<ept id=\"p2\">](http://ericwhite.com/)</ept>.","source":"For more information on Office Open XML, see [Open XML SDK](https://github.com/OfficeDev/Open-XML-SDK) and [www.ericwhite.com](http://ericwhite.com/)."},{"pos":[525,532],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example opens an Office Open XML package, uses the relationships within the Open XML package to find the document and the style parts.","pos":[536,675]},{"content":"It then queries the document, projecting a collection of an anonymous type that contains the paragraph <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> node, the style name of each paragraph, and the text of each paragraph.","pos":[676,882],"source":" It then queries the document, projecting a collection of an anonymous type that contains the paragraph <xref:System.Xml.Linq.XElement> node, the style name of each paragraph, and the text of each paragraph."},{"pos":[889,991],"content":"The example uses an extension method named <ph id=\"ph1\">`StringConcatenate`</ph>, which is also supplied in the example.","source":"The example uses an extension method named `StringConcatenate`, which is also supplied in the example."},{"pos":[998,1204],"content":"For a detailed tutorial that explains how this example works, see <bpt id=\"p1\">[</bpt>Pure Functional Transformations of XML (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/pure-functional-transformations-of-xml.md)</ept>.","source":"For a detailed tutorial that explains how this example works, see [Pure Functional Transformations of XML (C#)](../../../../csharp/programming-guide/concepts/linq/pure-functional-transformations-of-xml.md)."},{"content":"This example uses classes found in the WindowsBase assembly.","pos":[1211,1271]},{"content":"It uses types in the <ph id=\"ph1\">&lt;xref:System.IO.Packaging?displayProperty=nameWithType&gt;</ph> namespace.","pos":[1272,1359],"source":" It uses types in the <xref:System.IO.Packaging?displayProperty=nameWithType> namespace."},{"pos":[6556,6808],"content":"When run with the sample Open XML document described in <bpt id=\"p1\">[</bpt>Creating the Source Office Open XML Document (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/creating-the-source-office-open-xml-document.md)</ept>, this example produces the following output:","source":"When run with the sample Open XML document described in [Creating the Source Office Open XML Document (C#)](../../../../csharp/programming-guide/concepts/linq/creating-the-source-office-open-xml-document.md), this example produces the following output:"},{"pos":[7402,7410],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7414,7553],"content":"<bpt id=\"p1\">[</bpt>Advanced Query Techniques (LINQ to XML) (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/advanced-query-techniques-linq-to-xml.md)</ept>","source":"[Advanced Query Techniques (LINQ to XML) (C#)](../../../../csharp/programming-guide/concepts/linq/advanced-query-techniques-linq-to-xml.md)"}]}