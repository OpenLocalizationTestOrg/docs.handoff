{"content":"---\ntitle: \"How to: Use Multiple Security Tokens of the Same Type | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: cf179f48-4ed4-4caa-86a5-ef8eecc231cd\ncaps.latest.revision: 8\nauthor: \"BrucePerlerMS\"\nms.author: \"bruceper\"\nmanager: \"mbaldwin\"\n---\n# How to: Use Multiple Security Tokens of the Same Type\n-   In [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 3.0, a client message only contained one token of any given type. Now client messages can contain multiple tokens of a type. This topic shows how to include multiple tokens of the same type in a client message.  \n  \n-   Note that you cannot configure a service in this way: a service can contain only one supporting token.  \n  \n### To use multiple security tokens of the same type  \n  \n1.  Create an empty binding element collection to be populated.  \n  \n     [!code-csharp[C_CustomBinding#9](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#9)]  \n  \n2.  Create a <xref:System.ServiceModel.Channels.SecurityBindingElement> by calling <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateMutualCertificateBindingElement%2A>.  \n  \n     [!code-csharp[C_CustomBinding#10](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#10)]  \n  \n3.  Create a <xref:System.ServiceModel.Security.Tokens.SupportingTokenParameters> collection.  \n  \n     [!code-csharp[C_CustomBinding#11](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#11)]  \n  \n4.  Add SAML tokens to the collection.  \n  \n     [!code-csharp[C_CustomBinding#12](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#12)]  \n  \n5.  Add the collection to the <xref:System.ServiceModel.Channels.SecurityBindingElement>.  \n  \n     [!code-csharp[C_CustomBinding#13](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#13)]  \n  \n6.  Add binding elements to the binding element collection.  \n  \n     [!code-csharp[C_CustomBinding#14](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#14)]  \n  \n7.  Return a new custom binding created from the binding element collection.  \n  \n     [!code-csharp[C_CustomBinding#15](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#15)]  \n  \n## Example  \n The following is the entire method described by the preceding procedure.  \n  \n [!code-csharp[C_CustomBinding#7](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#7)]  \n  \n## See Also  \n [Security Architecture](http://msdn.microsoft.com/en-us/16593476-d36a-408d-808c-ae6fd483e28f)","nodes":[{"pos":[12,82],"content":"How to: Use Multiple Security Tokens of the Same Type | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Use Multiple Security Tokens of the Same Type | Microsoft Docs","pos":[0,70]}]},{"pos":[391,444],"content":"How to: Use Multiple Security Tokens of the Same Type","linkify":"How to: Use Multiple Security Tokens of the Same Type","nodes":[{"content":"How to: Use Multiple Security Tokens of the Same Type","pos":[0,53]}]},{"content":"In <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> 3.0, a client message only contained one token of any given type.","pos":[449,581],"source":"In [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 3.0, a client message only contained one token of any given type."},{"content":"Now client messages can contain multiple tokens of a type.","pos":[582,640]},{"content":"This topic shows how to include multiple tokens of the same type in a client message.","pos":[641,726]},{"content":"Note that you cannot configure a service in this way: a service can contain only one supporting token.","pos":[736,838]},{"pos":[848,896],"content":"To use multiple security tokens of the same type","linkify":"To use multiple security tokens of the same type","nodes":[{"content":"To use multiple security tokens of the same type","pos":[0,48]}]},{"content":"Create an empty binding element collection to be populated.","pos":[906,965]},{"pos":[976,1102],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_CustomBinding#9<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#9)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[C_CustomBinding#9](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#9)]"},{"content":"Create a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.SecurityBindingElement&gt;</ph> by calling <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.SecurityBindingElement.CreateMutualCertificateBindingElement%2A&gt;</ph>.","pos":[1112,1291],"source":"Create a <xref:System.ServiceModel.Channels.SecurityBindingElement> by calling <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateMutualCertificateBindingElement%2A>."},{"pos":[1302,1430],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_CustomBinding#10<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#10)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[C_CustomBinding#10](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#10)]"},{"content":"Create a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Security.Tokens.SupportingTokenParameters&gt;</ph> collection.","pos":[1440,1529],"source":"Create a <xref:System.ServiceModel.Security.Tokens.SupportingTokenParameters> collection."},{"pos":[1540,1668],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_CustomBinding#11<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#11)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[C_CustomBinding#11](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#11)]"},{"content":"Add SAML tokens to the collection.","pos":[1678,1712]},{"pos":[1723,1851],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_CustomBinding#12<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#12)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[C_CustomBinding#12](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#12)]"},{"content":"Add the collection to the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.SecurityBindingElement&gt;</ph>.","pos":[1861,1946],"source":"Add the collection to the <xref:System.ServiceModel.Channels.SecurityBindingElement>."},{"pos":[1957,2085],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_CustomBinding#13<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#13)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[C_CustomBinding#13](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#13)]"},{"content":"Add binding elements to the binding element collection.","pos":[2095,2150]},{"pos":[2161,2289],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_CustomBinding#14<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#14)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[C_CustomBinding#14](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#14)]"},{"content":"Return a new custom binding created from the binding element collection.","pos":[2299,2371]},{"pos":[2382,2510],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_CustomBinding#15<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#15)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[C_CustomBinding#15](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#15)]"},{"pos":[2519,2526],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following is the entire method described by the preceding procedure.","pos":[2530,2602]},{"pos":[2609,2735],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>C_CustomBinding#7<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#7)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[C_CustomBinding#7](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#7)]"},{"pos":[2744,2752],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2756,2849],"content":"<bpt id=\"p1\">[</bpt>Security Architecture<ept id=\"p1\">](http://msdn.microsoft.com/en-us/16593476-d36a-408d-808c-ae6fd483e28f)</ept>","source":"[Security Architecture](http://msdn.microsoft.com/en-us/16593476-d36a-408d-808c-ae6fd483e28f)"}]}