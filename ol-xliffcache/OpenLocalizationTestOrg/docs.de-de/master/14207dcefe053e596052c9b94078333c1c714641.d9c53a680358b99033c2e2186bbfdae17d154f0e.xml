{"content":"---\ntitle: \"SignTool.exe (Sign Tool)\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"Sign tool\"\n  - \"SignTool.exe\"\nms.assetid: 0c25ff6c-bff3-422e-b017-146a3ee86cb9\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# SignTool.exe (Sign Tool)\nSign Tool is a command-line tool that digitally signs files, verifies signatures in files, and time-stamps files.  \n  \n This tool is automatically installed with Visual Studio. To run the tool, use the Developer Command Prompt for Visual Studio (or the Visual Studio Command Prompt in Windows 7). For more information, see [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md).  \n  \n At the command prompt, type the following:  \n  \n## Syntax  \n  \n```  \nsigntool [command] [options] [file_name | ...]  \n```  \n  \n## Parameters  \n  \n|Argument|Description|  \n|--------------|-----------------|  \n|`command`|One of four commands (`catdb`, `sign`, `Timestamp`, or `Verify`) that specifies an operation to perform on a file. For a description of each command, see the next table.|  \n|`options`|An option that modifies a command. In addition to the global `/q` and `/v` options, each command supports a unique set of options.|  \n|`file_name`|The path to a file to sign.|  \n  \n The following commands are supported by Sign Tool. Each command is used with distinct sets of options, which are listed in their respective sections.  \n  \n|Command|Description|  \n|-------------|-----------------|  \n|`catdb`|Adds a catalog file to, or removes it from, a catalog database. Catalog databases are used for automatic lookup of catalog files and are identified by GUID. For a list of the options supported by the `catdb` command, see [catdb Command Options](../../../docs/framework/tools/signtool-exe.md#catdb).|  \n|`sign`|Digitally signs files. Digital signatures protect files from tampering, and enable users to verify the signer based on a signing certificate. For a list of the options supported by the `sign` command, see [sign Command Options](../../../docs/framework/tools/signtool-exe.md#sign).|  \n|`Timestamp`|Time-stamps files. For a list of the options supported by the `TimeStamp` command, see [TimeStamp Command Options](../../../docs/framework/tools/signtool-exe.md#TimeStamp).|  \n|`Verify`|Verifies the digital signature of files by determining whether the signing certificate was issued by a trusted authority, whether the signing certificate has been revoked, and, optionally, whether the signing certificate is valid for a specific policy. For a list of the options supported by the `Verify` command, see [Verify Command Options](../../../docs/framework/tools/signtool-exe.md#Verify).|  \n  \n The following options apply to all Sign Tool commands.  \n  \n|Global option|Description|  \n|-------------------|-----------------|  \n|**/q**|Displays no output if the command runs successfully, and displays minimal output if the command fails.|  \n|**/v**|Displays verbose output regardless of whether the command runs successfully or fails, and displays warning messages.|  \n|**/debug**|Displays debugging information.|  \n  \n<a name=\"catdb\"></a>   \n## catdb Command Options  \n The following table lists the options that can be used with the `catdb` command.  \n  \n|Catdb option|Description|  \n|------------------|-----------------|  \n|`/d`|Specifies that the default catalog database is updated. If neither the `/d` nor the `/g` option is used, Sign Tool updates the system component and driver database.|  \n|`/g` *GUID*|Specifies that the catalog database identified by the globally unique identifier *GUID* is updated.|  \n|`/r`|Removes the specified catalogs from the catalog database. If this option is not specified, Sign Tool adds the specified catalogs to the catalog database.|  \n|`/u`|Specifies that a unique name is automatically generated for the added catalog files. If necessary, the catalog files are renamed to prevent name conflicts with existing catalog files. If this option is not specified, Sign Tool overwrites any existing catalog that has the same name as the catalog being added.|  \n  \n<a name=\"sign\"></a>   \n## sign Command Options  \n The following table lists the options that can be used with the `sign` command.  \n  \n|Sign command option|Description|  \n|-------------------------|-----------------|  \n|`/a`|Automatically selects the best signing certificate. Sign Tool will find all valid certificates that satisfy all specified conditions and select the one that is valid for the longest time. If this option is not present, Sign Tool expects to find only one valid signing certificate.|  \n|`/ac`  *file*|Adds an additional certificate from *file* to the signature block.|  \n|`/as`|Appends this signature. If no primary signature is present, this signature is made the primary signature instead.|  \n|`/c`  *CertTemplateName*|Specifies the Certificate Template Name (a Microsoft extension) for the signing certificate.|  \n|`/csp`  *CSPName*|Specifies the cryptographic service provider (CSP) that contains the private key container.|  \n|`/d`  *Desc*|Specifies a description of the signed content.|  \n|`/du`  *URL*|Specifies a Uniform Resource Locator (URL) for the expanded description of the signed content.|  \n|`/f`  *SignCertFile*|Specifies the signing certificate in a file. If the file is in Personal Information Exchange (PFX) format and protected by a password, use the `/p` option to specify the password. If the file does not contain private keys, use the `/csp` and `/kc` options to specify the CSP and private key container name.|  \n|`/fd`|Specifies the file digest algorithm to use for creating file signatures. The default is SHA1.|  \n|`/i`  *IssuerName*|Specifies the name of the issuer of the signing certificate. This value can be a substring of the entire issuer name.|  \n|`/kc`  *PrivKeyContainerName*|Specifies the private key container name.|  \n|`/n`  *SubjectName*|Specifies the name of the subject of the signing certificate. This value can be a substring of the entire subject name.|  \n|`/nph`|If supported, suppresses page hashes for executable files. The default is determined by the SIGNTOOL_PAGE_HASHES environment variable and by the wintrust.dll version. This option is ignored for non-PE files.|  \n|`/p`  *Password*|Specifies the password to use when opening a PFX file. (Use the `/f` option to specify a PFX file.)|  \n|`/p7` *Path*|Specifies that a Public Key Cryptography Standards (PKCS) #7 file is produced for each specified content file. PKCS #7 files are named *path*\\\\*filename*.p7.|  \n|`/p7ce` *Value*|Specifies options for the signed PKCS #7 content. Set *Value* to \"Embedded\" to embed the signed content in the PKCS #7 file, or to \"DetachedSignedData\" to produce the signed data portion of a detached PKCS #7 file. If the `/p7ce` option is not used, the signed content is embedded by default.|  \n|`/p7co` *\\<OID>*|Specifies the object identifier (OID) that identifies the signed PKCS #7 content.|  \n|`/ph`|If supported, generates page hashes for executable files.|  \n|`/r`  *RootSubjectName*|Specifies the name of the subject of the root certificate that the signing certificate must chain to. This value may be a substring of the entire subject name of the root certificate.|  \n|`/s`  *StoreName*|Specifies the store to open when searching for the certificate. If this option is not specified, the `My` store is opened.|  \n|`/sha1`  *Hash*|Specifies the SHA1 hash of the signing certificate. The SHA1 hash is commonly specified when multiple certificates satisfy the criteria specified by the remaining switches.|  \n|`/sm`|Specifies that a machine store, instead of a user store, is used.|  \n|`/t`  *URL*|Specifies the URL of the time stamp server. If this option (or `/tr`) is not present, the signed file will not be time stamped. A warning is generated if time stamping fails. This option cannot be used with the `/tr` option.|  \n|`/td`  *alg*|Used with the `/tr` option to request a digest algorithm used by the RFC 3161 time stamp server.|  \n|`/tr`  *URL*|Specifies the URL of the RFC 3161 time stamp server. If this option (or `/t`) is not present, the signed file will not be time stamped. A warning is generated if time stamping fails. This option cannot be used with the `/t` option.|  \n|`/u`  *Usage*|Specifies the enhanced key usage (EKU) that must be present in the signing certificate. The usage value can be specified by OID or string. The default usage is \"Code Signing\" (1.3.6.1.5.5.7.3.3).|  \n|`/uw`|Specifies usage of \"Windows System Component Verification\" (1.3.6.1.4.1.311.10.3.6).|  \n  \n For usage examples, see [Using SignTool to Sign a File](/windows/desktop/SecCrypto/using-signtool-to-sign-a-file).  \n  \n<a name=\"TimeStamp\"></a>   \n## TimeStamp Command Options  \n The following table lists the options that can be used with the `TimeStamp` command.  \n  \n|TimeStamp option|Description|  \n|----------------------|-----------------|  \n|`/p7`|Time stamps PKCS #7 files.|  \n|`/t`  *URL*|Specifies the URL of the time stamp server. The file being time stamped must have previously been signed. Either the `/t` or the `/tr` option is required.|  \n|`/td`  *alg*|Requests a digest algorithm used by the RFC 3161 time stamp server. `/td` is used with the `/tr` option.|  \n|`/tp` *index*|Time stamps the signature at *index*.|  \n|`/tr`  *URL*|Specifies the URL of the RFC 3161 time stamp server. The file being time stamped must have previously been signed. Either the `/tr` or the `/t` option is required.|  \n  \n For a usage example, see [Adding Time Stamps to Previously Signed Files](/windows/desktop/SecCrypto/adding-time-stamps-to-previously-signed-files).  \n  \n<a name=\"Verify\"></a>   \n## Verify Command Options  \n  \n|Verify option|Description|  \n|-------------------|-----------------|  \n|`/a`|Specifies that all methods can be used to verify the file. First, the catalog databases are searched to determine whether the file is signed in a catalog. If the file is not signed in any catalog, Sign Tool attempts to verify the file's embedded signature. This option is recommended when verifying files that may or may not be signed in a catalog. Examples of these files include Windows files or drivers.|  \n|`/ad`|Finds the catalog by using the default catalog database.|  \n|`/ag` *CatDBGUID*|Finds the catalog in the catalog database that is identified by the *CatDBGUID*.|  \n|`/all`|Verifies all signatures in a file that includes multiple signatures.|  \n|`/as`|Finds the catalog by using the system component (driver) catalog database.|  \n|`/c` *CatFile*|Specifies the catalog file by name.|  \n|`/d`|Specifies that Sign Tool should print the description and the description URL.|  \n|`/ds`  *Index*|Verifies the signature at a specified position.|  \n|`/hash` (`SHA1`&#124;`SHA256`)|Specifies an optional hash algorithm to use when searching for a file in a catalog.|  \n|`/kp`|Specifies that verification should be performed with the kernel-mode driver signing policy.|  \n|`/ms`|Uses multiple verification semantics. This is the default behavior of a [WinVerifyTrust](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust) call on [!INCLUDE[win8](../../../includes/win8-md.md)] and above.|  \n|`/o` *Version*|Verifies the file by operating system version. *Version* has the following form: *PlatformID*:*VerMajor*.*VerMinor*.*BuildNumber*. *PlatformID* represents the underlying value of a <xref:System.PlatformID> enumeration member. **Important:**  The use of the `/o` switch is recommended. If `/o` is not specified, SignTool.exe may return unexpected results. For example, if you do not include the `/o` switch, system catalogs that validate correctly on an older operating system may not validate correctly on a newer operating system.|  \n|`/p7`|Verifies PKCS #7 files. No existing policies are used for PKCS #7 validation. The signature is checked and a chain is built for the signing certificate.|  \n|`/pa`|Specifies that the Default Authenticode Verification Policy should be used. If the `/pa` option is not specified, Sign Tool uses the Windows Driver Verification Policy. This option cannot be used with the `catdb` options.|  \n|`/pg` *PolicyGUID*|Specifies a verification policy by GUID. The *PolicyGUID* corresponds to the ActionID of the verification policy. This option cannot be used with the `catdb` options.|  \n|`/ph`|Specifies that Sign Tool should print and verify page hash values.|  \n|`/r` *RootSubjectName*|Specifies the name of the subject of the root certificate that the signing certificate must chain to. This value can be a substring of the entire subject name of the root certificate.|  \n|`/tw`|Specifies that a warning should be generated if the signature is not time stamped.|  \n  \n For usage examples, see [Using SignTool to Verify a File Signature](/windows/desktop/SecCrypto/using-signtool-to-verify-a-file-signature).  \n  \n## Return Value  \n Sign Tool returns one of the following exit codes when it terminates.  \n  \n|Exit code|Description|  \n|---------------|-----------------|  \n|0|Execution was successful.|  \n|1|Execution has failed.|  \n|2|Execution has completed with warnings.|  \n  \n## Examples  \n The following command adds the catalog file MyCatalogFileName.cat to the system component and driver database. The `/u` option generates a unique name if necessary to prevent replacing an existing catalog file named `MyCatalogFileName.cat`.  \n  \n```  \nsigntool catdb /v /u MyCatalogFileName.cat  \n```  \n  \n The following command signs a file automatically by using the best certificate.  \n  \n```  \nsigntool sign /a MyFile.exe  \n```  \n  \n The following command digitally signs a file by using a certificate stored in a password-protected PFX file.  \n  \n```  \nsigntool sign /f MyCert.pfx /p MyPassword MyFile.exe  \n```  \n  \n The following command digitally signs and time-stamps a file. The certificate used to sign the file is stored in a PFX file.  \n  \n```  \nsigntool sign /f MyCert.pfx /t http://timestamp.verisign.com/scripts/timstamp.dll MyFile.exe  \n```  \n  \n The following command signs a file by using a certificate located in the `My` store that has a subject name of `My Company Certificate`.  \n  \n```  \nsigntool sign /n \"My Company Certificate\" MyFile.exe  \n```  \n  \n The following command signs an ActiveX control and provides information that is displayed by Internet Explorer when the user is prompted to install the control.  \n  \n```  \nSigntool sign /f MyCert.pfx /d: \"MyControl\" /du http://www.example.com/MyControl/info.html MyControl.exe  \n```  \n  \n The following command time-stamps a file that has already been digitally signed.  \n  \n```  \nsigntool timestamp /t http://timestamp.verisign.com/scripts/timstamp.dll MyFile.exe  \n```  \n  \n The following command verifies that a file has been signed.  \n  \n```  \nsigntool verify MyFile.exe  \n```  \n  \n The following command verifies a system file that may be signed in a catalog.  \n  \n```  \nsigntool verify /a SystemFile.dll  \n```  \n  \n The following command verifies a system file that is signed in a catalog named `MyCatalog.cat`.  \n  \n```  \nsigntool verify /c MyCatalog.cat SystemFile.dll  \n```  \n  \n## See also\n\n- [Tools](../../../docs/framework/tools/index.md)\n- [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md)\n","nodes":[{"pos":[4,205],"embed":true,"restype":"x-metadata","content":"title: \"SignTool.exe (Sign Tool)\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"Sign tool\"\n  - \"SignTool.exe\"\nms.assetid: 0c25ff6c-bff3-422e-b017-146a3ee86cb9\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"SignTool.exe (Sign Tool)","nodes":[{"pos":[0,24],"content":"SignTool.exe (Sign Tool)","nodes":[{"content":"SignTool.exe (Sign Tool)","pos":[0,24]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[212,236],"content":"SignTool.exe (Sign Tool)","linkify":"SignTool.exe (Sign Tool)","nodes":[{"content":"SignTool.exe (Sign Tool)","pos":[0,24]}]},{"content":"Sign Tool is a command-line tool that digitally signs files, verifies signatures in files, and time-stamps files.","pos":[237,350]},{"content":"This tool is automatically installed with Visual Studio.","pos":[357,413]},{"content":"To run the tool, use the Developer Command Prompt for Visual Studio (or the Visual Studio Command Prompt in Windows 7).","pos":[414,533]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Command Prompts<ept id=\"p1\">](../../../docs/framework/tools/developer-command-prompt-for-vs.md)</ept>.","pos":[534,644],"source":" For more information, see [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md)."},{"content":"At the command prompt, type the following:","pos":[651,693]},{"pos":[702,708],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[781,791],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Argument","pos":[798,806]},{"content":"Description","pos":[807,818]},{"content":"One of four commands (<ph id=\"ph1\">`catdb`</ph>, <ph id=\"ph2\">`sign`</ph>, <ph id=\"ph3\">`Timestamp`</ph>, or <ph id=\"ph4\">`Verify`</ph>) that specifies an operation to perform on a file.","pos":[870,984],"source":"One of four commands (`catdb`, `sign`, `Timestamp`, or `Verify`) that specifies an operation to perform on a file."},{"content":"For a description of each command, see the next table.","pos":[985,1039]},{"content":"An option that modifies a command.","pos":[1054,1088]},{"content":"In addition to the global <ph id=\"ph1\">`/q`</ph> and <ph id=\"ph2\">`/v`</ph> options, each command supports a unique set of options.","pos":[1089,1184],"source":" In addition to the global `/q` and `/v` options, each command supports a unique set of options."},{"content":"The path to a file to sign.","pos":[1201,1228]},{"content":"The following commands are supported by Sign Tool.","pos":[1236,1286]},{"content":"Each command is used with distinct sets of options, which are listed in their respective sections.","pos":[1287,1385]},{"content":"Command","pos":[1392,1399]},{"content":"Description","pos":[1400,1411]},{"content":"Adds a catalog file to, or removes it from, a catalog database.","pos":[1460,1523]},{"content":"Catalog databases are used for automatic lookup of catalog files and are identified by GUID.","pos":[1524,1616]},{"content":"For a list of the options supported by the <ph id=\"ph1\">`catdb`</ph> command, see <bpt id=\"p1\">[</bpt>catdb Command Options<ept id=\"p1\">](../../../docs/framework/tools/signtool-exe.md#catdb)</ept>.","pos":[1617,1758],"source":" For a list of the options supported by the `catdb` command, see [catdb Command Options](../../../docs/framework/tools/signtool-exe.md#catdb)."},{"content":"Digitally signs files.","pos":[1770,1792]},{"content":"Digital signatures protect files from tampering, and enable users to verify the signer based on a signing certificate.","pos":[1793,1911]},{"content":"For a list of the options supported by the <ph id=\"ph1\">`sign`</ph> command, see <bpt id=\"p1\">[</bpt>sign Command Options<ept id=\"p1\">](../../../docs/framework/tools/signtool-exe.md#sign)</ept>.","pos":[1912,2050],"source":" For a list of the options supported by the `sign` command, see [sign Command Options](../../../docs/framework/tools/signtool-exe.md#sign)."},{"content":"Time-stamps files.","pos":[2067,2085]},{"content":"For a list of the options supported by the <ph id=\"ph1\">`TimeStamp`</ph> command, see <bpt id=\"p1\">[</bpt>TimeStamp Command Options<ept id=\"p1\">](../../../docs/framework/tools/signtool-exe.md#TimeStamp)</ept>.","pos":[2086,2239],"source":" For a list of the options supported by the `TimeStamp` command, see [TimeStamp Command Options](../../../docs/framework/tools/signtool-exe.md#TimeStamp)."},{"content":"Verifies the digital signature of files by determining whether the signing certificate was issued by a trusted authority, whether the signing certificate has been revoked, and, optionally, whether the signing certificate is valid for a specific policy.","pos":[2253,2505]},{"content":"For a list of the options supported by the <ph id=\"ph1\">`Verify`</ph> command, see <bpt id=\"p1\">[</bpt>Verify Command Options<ept id=\"p1\">](../../../docs/framework/tools/signtool-exe.md#Verify)</ept>.","pos":[2506,2650],"source":" For a list of the options supported by the `Verify` command, see [Verify Command Options](../../../docs/framework/tools/signtool-exe.md#Verify)."},{"content":"The following options apply to all Sign Tool commands.","pos":[2658,2712]},{"content":"Global option","pos":[2719,2732]},{"content":"Description","pos":[2733,2744]},{"pos":[2791,2797],"content":"<bpt id=\"p1\">**</bpt>/q<ept id=\"p1\">**</ept>","source":"**/q**"},{"content":"Displays no output if the command runs successfully, and displays minimal output if the command fails.","pos":[2798,2900]},{"pos":[2905,2911],"content":"<bpt id=\"p1\">**</bpt>/v<ept id=\"p1\">**</ept>","source":"**/v**"},{"content":"Displays verbose output regardless of whether the command runs successfully or fails, and displays warning messages.","pos":[2912,3028]},{"pos":[3033,3043],"content":"<bpt id=\"p1\">**</bpt>/debug<ept id=\"p1\">**</ept>","source":"**/debug**"},{"content":"Displays debugging information.","pos":[3044,3075]},{"pos":[3109,3130],"content":"catdb Command Options","linkify":"catdb Command Options","nodes":[{"content":"catdb Command Options","pos":[0,21]}]},{"pos":[3134,3214],"content":"The following table lists the options that can be used with the <ph id=\"ph1\">`catdb`</ph> command.","source":"The following table lists the options that can be used with the `catdb` command."},{"content":"Catdb option","pos":[3221,3233]},{"content":"Description","pos":[3234,3245]},{"content":"Specifies that the default catalog database is updated.","pos":[3296,3351]},{"content":"If neither the <ph id=\"ph1\">`/d`</ph> nor the <ph id=\"ph2\">`/g`</ph> option is used, Sign Tool updates the system component and driver database.","pos":[3352,3460],"source":" If neither the `/d` nor the `/g` option is used, Sign Tool updates the system component and driver database."},{"pos":[3465,3476],"content":"<ph id=\"ph1\">`/g`</ph> <bpt id=\"p1\">*</bpt>GUID<ept id=\"p1\">*</ept>","source":"`/g` *GUID*"},{"pos":[3477,3576],"content":"Specifies that the catalog database identified by the globally unique identifier <bpt id=\"p1\">*</bpt>GUID<ept id=\"p1\">*</ept> is updated.","source":"Specifies that the catalog database identified by the globally unique identifier *GUID* is updated."},{"content":"Removes the specified catalogs from the catalog database.","pos":[3586,3643]},{"content":"If this option is not specified, Sign Tool adds the specified catalogs to the catalog database.","pos":[3644,3739]},{"content":"Specifies that a unique name is automatically generated for the added catalog files.","pos":[3749,3833]},{"content":"If necessary, the catalog files are renamed to prevent name conflicts with existing catalog files.","pos":[3834,3932]},{"content":"If this option is not specified, Sign Tool overwrites any existing catalog that has the same name as the catalog being added.","pos":[3933,4058]},{"pos":[4091,4111],"content":"sign Command Options","linkify":"sign Command Options","nodes":[{"content":"sign Command Options","pos":[0,20]}]},{"pos":[4115,4194],"content":"The following table lists the options that can be used with the <ph id=\"ph1\">`sign`</ph> command.","source":"The following table lists the options that can be used with the `sign` command."},{"content":"Sign command option","pos":[4201,4220]},{"content":"Description","pos":[4221,4232]},{"content":"Automatically selects the best signing certificate.","pos":[4290,4341]},{"content":"Sign Tool will find all valid certificates that satisfy all specified conditions and select the one that is valid for the longest time.","pos":[4342,4477]},{"content":"If this option is not present, Sign Tool expects to find only one valid signing certificate.","pos":[4478,4570]},{"pos":[4575,4588],"content":"<ph id=\"ph1\">`/ac`</ph>  <bpt id=\"p1\">*</bpt>file<ept id=\"p1\">*</ept>","source":"`/ac`  *file*"},{"pos":[4589,4655],"content":"Adds an additional certificate from <bpt id=\"p1\">*</bpt>file<ept id=\"p1\">*</ept> to the signature block.","source":"Adds an additional certificate from *file* to the signature block."},{"content":"Appends this signature.","pos":[4666,4689]},{"content":"If no primary signature is present, this signature is made the primary signature instead.","pos":[4690,4779]},{"pos":[4784,4808],"content":"<ph id=\"ph1\">`/c`</ph>  <bpt id=\"p1\">*</bpt>CertTemplateName<ept id=\"p1\">*</ept>","source":"`/c`  *CertTemplateName*"},{"content":"Specifies the Certificate Template Name (a Microsoft extension) for the signing certificate.","pos":[4809,4901]},{"pos":[4906,4923],"content":"<ph id=\"ph1\">`/csp`</ph>  <bpt id=\"p1\">*</bpt>CSPName<ept id=\"p1\">*</ept>","source":"`/csp`  *CSPName*"},{"content":"Specifies the cryptographic service provider (CSP) that contains the private key container.","pos":[4924,5015]},{"pos":[5020,5032],"content":"<ph id=\"ph1\">`/d`</ph>  <bpt id=\"p1\">*</bpt>Desc<ept id=\"p1\">*</ept>","source":"`/d`  *Desc*"},{"content":"Specifies a description of the signed content.","pos":[5033,5079]},{"pos":[5084,5096],"content":"<ph id=\"ph1\">`/du`</ph>  <bpt id=\"p1\">*</bpt>URL<ept id=\"p1\">*</ept>","source":"`/du`  *URL*"},{"content":"Specifies a Uniform Resource Locator (URL) for the expanded description of the signed content.","pos":[5097,5191]},{"pos":[5196,5216],"content":"<ph id=\"ph1\">`/f`</ph>  <bpt id=\"p1\">*</bpt>SignCertFile<ept id=\"p1\">*</ept>","source":"`/f`  *SignCertFile*"},{"content":"Specifies the signing certificate in a file.","pos":[5217,5261]},{"content":"If the file is in Personal Information Exchange (PFX) format and protected by a password, use the <ph id=\"ph1\">`/p`</ph> option to specify the password.","pos":[5262,5396],"source":" If the file is in Personal Information Exchange (PFX) format and protected by a password, use the `/p` option to specify the password."},{"content":"If the file does not contain private keys, use the <ph id=\"ph1\">`/csp`</ph> and <ph id=\"ph2\">`/kc`</ph> options to specify the CSP and private key container name.","pos":[5397,5523],"source":" If the file does not contain private keys, use the `/csp` and `/kc` options to specify the CSP and private key container name."},{"content":"Specifies the file digest algorithm to use for creating file signatures.","pos":[5534,5606]},{"content":"The default is SHA1.","pos":[5607,5627]},{"pos":[5632,5650],"content":"<ph id=\"ph1\">`/i`</ph>  <bpt id=\"p1\">*</bpt>IssuerName<ept id=\"p1\">*</ept>","source":"`/i`  *IssuerName*"},{"content":"Specifies the name of the issuer of the signing certificate.","pos":[5651,5711]},{"content":"This value can be a substring of the entire issuer name.","pos":[5712,5768]},{"pos":[5773,5802],"content":"<ph id=\"ph1\">`/kc`</ph>  <bpt id=\"p1\">*</bpt>PrivKeyContainerName<ept id=\"p1\">*</ept>","source":"`/kc`  *PrivKeyContainerName*"},{"content":"Specifies the private key container name.","pos":[5803,5844]},{"pos":[5849,5868],"content":"<ph id=\"ph1\">`/n`</ph>  <bpt id=\"p1\">*</bpt>SubjectName<ept id=\"p1\">*</ept>","source":"`/n`  *SubjectName*"},{"content":"Specifies the name of the subject of the signing certificate.","pos":[5869,5930]},{"content":"This value can be a substring of the entire subject name.","pos":[5931,5988]},{"content":"If supported, suppresses page hashes for executable files.","pos":[6000,6058]},{"content":"The default is determined by the SIGNTOOL_PAGE_HASHES environment variable and by the wintrust.dll version.","pos":[6059,6166]},{"content":"This option is ignored for non-PE files.","pos":[6167,6207]},{"pos":[6212,6228],"content":"<ph id=\"ph1\">`/p`</ph>  <bpt id=\"p1\">*</bpt>Password<ept id=\"p1\">*</ept>","source":"`/p`  *Password*"},{"content":"Specifies the password to use when opening a PFX file.","pos":[6229,6283]},{"content":"(Use the <ph id=\"ph1\">`/f`</ph> option to specify a PFX file.)","pos":[6284,6328],"source":" (Use the `/f` option to specify a PFX file.)"},{"pos":[6333,6345],"content":"<ph id=\"ph1\">`/p7`</ph> <bpt id=\"p1\">*</bpt>Path<ept id=\"p1\">*</ept>","source":"`/p7` *Path*"},{"content":"Specifies that a Public Key Cryptography Standards (PKCS) #7 file is produced for each specified content file.","pos":[6346,6456]},{"content":"PKCS #7 files are named <bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept><ph id=\"ph1\">\\\\</ph><bpt id=\"p2\">*</bpt>filename<ept id=\"p2\">*</ept>.p7.","pos":[6457,6503],"source":" PKCS #7 files are named *path*\\\\*filename*.p7."},{"pos":[6508,6523],"content":"<ph id=\"ph1\">`/p7ce`</ph> <bpt id=\"p1\">*</bpt>Value<ept id=\"p1\">*</ept>","source":"`/p7ce` *Value*"},{"content":"Specifies options for the signed PKCS #7 content.","pos":[6524,6573]},{"content":"Set <bpt id=\"p1\">*</bpt>Value<ept id=\"p1\">*</ept> to \"Embedded\" to embed the signed content in the PKCS #7 file, or to \"DetachedSignedData\" to produce the signed data portion of a detached PKCS #7 file.","pos":[6574,6738],"source":" Set *Value* to \"Embedded\" to embed the signed content in the PKCS #7 file, or to \"DetachedSignedData\" to produce the signed data portion of a detached PKCS #7 file."},{"content":"If the <ph id=\"ph1\">`/p7ce`</ph> option is not used, the signed content is embedded by default.","pos":[6739,6816],"source":" If the `/p7ce` option is not used, the signed content is embedded by default."},{"pos":[6821,6837],"content":"<ph id=\"ph1\">`/p7co`</ph> <bpt id=\"p1\">*</bpt><ph id=\"ph2\">\\&lt;</ph>OID&gt;<ept id=\"p1\">*</ept>","source":"`/p7co` *\\<OID>*"},{"content":"Specifies the object identifier (OID) that identifies the signed PKCS #7 content.","pos":[6838,6919]},{"content":"If supported, generates page hashes for executable files.","pos":[6930,6987]},{"pos":[6992,7015],"content":"<ph id=\"ph1\">`/r`</ph>  <bpt id=\"p1\">*</bpt>RootSubjectName<ept id=\"p1\">*</ept>","source":"`/r`  *RootSubjectName*"},{"content":"Specifies the name of the subject of the root certificate that the signing certificate must chain to.","pos":[7016,7117]},{"content":"This value may be a substring of the entire subject name of the root certificate.","pos":[7118,7199]},{"pos":[7204,7221],"content":"<ph id=\"ph1\">`/s`</ph>  <bpt id=\"p1\">*</bpt>StoreName<ept id=\"p1\">*</ept>","source":"`/s`  *StoreName*"},{"content":"Specifies the store to open when searching for the certificate.","pos":[7222,7285]},{"content":"If this option is not specified, the <ph id=\"ph1\">`My`</ph> store is opened.","pos":[7286,7344],"source":" If this option is not specified, the `My` store is opened."},{"pos":[7349,7364],"content":"<ph id=\"ph1\">`/sha1`</ph>  <bpt id=\"p1\">*</bpt>Hash<ept id=\"p1\">*</ept>","source":"`/sha1`  *Hash*"},{"content":"Specifies the SHA1 hash of the signing certificate.","pos":[7365,7416]},{"content":"The SHA1 hash is commonly specified when multiple certificates satisfy the criteria specified by the remaining switches.","pos":[7417,7537]},{"content":"Specifies that a machine store, instead of a user store, is used.","pos":[7548,7613]},{"pos":[7618,7629],"content":"<ph id=\"ph1\">`/t`</ph>  <bpt id=\"p1\">*</bpt>URL<ept id=\"p1\">*</ept>","source":"`/t`  *URL*"},{"content":"Specifies the URL of the time stamp server.","pos":[7630,7673]},{"content":"If this option (or <ph id=\"ph1\">`/tr`</ph>) is not present, the signed file will not be time stamped.","pos":[7674,7757],"source":" If this option (or `/tr`) is not present, the signed file will not be time stamped."},{"content":"A warning is generated if time stamping fails.","pos":[7758,7804]},{"content":"This option cannot be used with the <ph id=\"ph1\">`/tr`</ph> option.","pos":[7805,7854],"source":" This option cannot be used with the `/tr` option."},{"pos":[7859,7871],"content":"<ph id=\"ph1\">`/td`</ph>  <bpt id=\"p1\">*</bpt>alg<ept id=\"p1\">*</ept>","source":"`/td`  *alg*"},{"pos":[7872,7968],"content":"Used with the <ph id=\"ph1\">`/tr`</ph> option to request a digest algorithm used by the RFC 3161 time stamp server.","source":"Used with the `/tr` option to request a digest algorithm used by the RFC 3161 time stamp server."},{"pos":[7973,7985],"content":"<ph id=\"ph1\">`/tr`</ph>  <bpt id=\"p1\">*</bpt>URL<ept id=\"p1\">*</ept>","source":"`/tr`  *URL*"},{"content":"Specifies the URL of the RFC 3161 time stamp server.","pos":[7986,8038]},{"content":"If this option (or <ph id=\"ph1\">`/t`</ph>) is not present, the signed file will not be time stamped.","pos":[8039,8121],"source":" If this option (or `/t`) is not present, the signed file will not be time stamped."},{"content":"A warning is generated if time stamping fails.","pos":[8122,8168]},{"content":"This option cannot be used with the <ph id=\"ph1\">`/t`</ph> option.","pos":[8169,8217],"source":" This option cannot be used with the `/t` option."},{"pos":[8222,8235],"content":"<ph id=\"ph1\">`/u`</ph>  <bpt id=\"p1\">*</bpt>Usage<ept id=\"p1\">*</ept>","source":"`/u`  *Usage*"},{"content":"Specifies the enhanced key usage (EKU) that must be present in the signing certificate.","pos":[8236,8323]},{"content":"The usage value can be specified by OID or string.","pos":[8324,8374]},{"content":"The default usage is \"Code Signing\" (1.3.6.1.5.5.7.3.3).","pos":[8375,8431]},{"content":"Specifies usage of \"Windows System Component Verification\" (1.3.6.1.4.1.311.10.3.6).","pos":[8442,8526]},{"pos":[8534,8648],"content":"For usage examples, see <bpt id=\"p1\">[</bpt>Using SignTool to Sign a File<ept id=\"p1\">](/windows/desktop/SecCrypto/using-signtool-to-sign-a-file)</ept>.","source":"For usage examples, see [Using SignTool to Sign a File](/windows/desktop/SecCrypto/using-signtool-to-sign-a-file)."},{"pos":[8685,8710],"content":"TimeStamp Command Options","linkify":"TimeStamp Command Options","nodes":[{"content":"TimeStamp Command Options","pos":[0,25]}]},{"pos":[8714,8798],"content":"The following table lists the options that can be used with the <ph id=\"ph1\">`TimeStamp`</ph> command.","source":"The following table lists the options that can be used with the `TimeStamp` command."},{"content":"TimeStamp option","pos":[8805,8821]},{"content":"Description","pos":[8822,8833]},{"content":"Time stamps PKCS #7 files.","pos":[8889,8915]},{"pos":[8920,8931],"content":"<ph id=\"ph1\">`/t`</ph>  <bpt id=\"p1\">*</bpt>URL<ept id=\"p1\">*</ept>","source":"`/t`  *URL*"},{"content":"Specifies the URL of the time stamp server.","pos":[8932,8975]},{"content":"The file being time stamped must have previously been signed.","pos":[8976,9037]},{"content":"Either the <ph id=\"ph1\">`/t`</ph> or the <ph id=\"ph2\">`/tr`</ph> option is required.","pos":[9038,9086],"source":" Either the `/t` or the `/tr` option is required."},{"pos":[9091,9103],"content":"<ph id=\"ph1\">`/td`</ph>  <bpt id=\"p1\">*</bpt>alg<ept id=\"p1\">*</ept>","source":"`/td`  *alg*"},{"content":"Requests a digest algorithm used by the RFC 3161 time stamp server.","pos":[9104,9171]},{"content":"<ph id=\"ph1\">`/td`</ph> is used with the <ph id=\"ph2\">`/tr`</ph> option.","pos":[9172,9208],"source":"`/td` is used with the `/tr` option."},{"pos":[9213,9226],"content":"<ph id=\"ph1\">`/tp`</ph> <bpt id=\"p1\">*</bpt>index<ept id=\"p1\">*</ept>","source":"`/tp` *index*"},{"pos":[9227,9264],"content":"Time stamps the signature at <bpt id=\"p1\">*</bpt>index<ept id=\"p1\">*</ept>.","source":"Time stamps the signature at *index*."},{"pos":[9269,9281],"content":"<ph id=\"ph1\">`/tr`</ph>  <bpt id=\"p1\">*</bpt>URL<ept id=\"p1\">*</ept>","source":"`/tr`  *URL*"},{"content":"Specifies the URL of the RFC 3161 time stamp server.","pos":[9282,9334]},{"content":"The file being time stamped must have previously been signed.","pos":[9335,9396]},{"content":"Either the <ph id=\"ph1\">`/tr`</ph> or the <ph id=\"ph2\">`/t`</ph> option is required.","pos":[9397,9445],"source":" Either the `/tr` or the `/t` option is required."},{"pos":[9453,9600],"content":"For a usage example, see <bpt id=\"p1\">[</bpt>Adding Time Stamps to Previously Signed Files<ept id=\"p1\">](/windows/desktop/SecCrypto/adding-time-stamps-to-previously-signed-files)</ept>.","source":"For a usage example, see [Adding Time Stamps to Previously Signed Files](/windows/desktop/SecCrypto/adding-time-stamps-to-previously-signed-files)."},{"pos":[9634,9656],"content":"Verify Command Options","linkify":"Verify Command Options","nodes":[{"content":"Verify Command Options","pos":[0,22]}]},{"content":"Verify option","pos":[9663,9676]},{"content":"Description","pos":[9677,9688]},{"content":"Specifies that all methods can be used to verify the file.","pos":[9740,9798]},{"content":"First, the catalog databases are searched to determine whether the file is signed in a catalog.","pos":[9799,9894]},{"content":"If the file is not signed in any catalog, Sign Tool attempts to verify the file's embedded signature.","pos":[9895,9996]},{"content":"This option is recommended when verifying files that may or may not be signed in a catalog.","pos":[9997,10088]},{"content":"Examples of these files include Windows files or drivers.","pos":[10089,10146]},{"content":"Finds the catalog by using the default catalog database.","pos":[10157,10213]},{"pos":[10218,10235],"content":"<ph id=\"ph1\">`/ag`</ph> <bpt id=\"p1\">*</bpt>CatDBGUID<ept id=\"p1\">*</ept>","source":"`/ag` *CatDBGUID*"},{"pos":[10236,10316],"content":"Finds the catalog in the catalog database that is identified by the <bpt id=\"p1\">*</bpt>CatDBGUID<ept id=\"p1\">*</ept>.","source":"Finds the catalog in the catalog database that is identified by the *CatDBGUID*."},{"content":"Verifies all signatures in a file that includes multiple signatures.","pos":[10328,10396]},{"content":"Finds the catalog by using the system component (driver) catalog database.","pos":[10407,10481]},{"pos":[10486,10500],"content":"<ph id=\"ph1\">`/c`</ph> <bpt id=\"p1\">*</bpt>CatFile<ept id=\"p1\">*</ept>","source":"`/c` *CatFile*"},{"content":"Specifies the catalog file by name.","pos":[10501,10536]},{"content":"Specifies that Sign Tool should print the description and the description URL.","pos":[10546,10624]},{"pos":[10629,10643],"content":"<ph id=\"ph1\">`/ds`</ph>  <bpt id=\"p1\">*</bpt>Index<ept id=\"p1\">*</ept>","source":"`/ds`  *Index*"},{"content":"Verifies the signature at a specified position.","pos":[10644,10691]},{"pos":[10696,10726],"content":"<ph id=\"ph1\">`/hash`</ph> (<ph id=\"ph2\">`SHA1`</ph>&amp;#124;<ph id=\"ph3\">`SHA256`</ph>)","source":"`/hash` (`SHA1`&#124;`SHA256`)"},{"content":"Specifies an optional hash algorithm to use when searching for a file in a catalog.","pos":[10727,10810]},{"content":"Specifies that verification should be performed with the kernel-mode driver signing policy.","pos":[10821,10912]},{"content":"Uses multiple verification semantics.","pos":[10923,10960]},{"content":"This is the default behavior of a <bpt id=\"p1\">[</bpt>WinVerifyTrust<ept id=\"p1\">](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust)</ept> call on <ph id=\"ph1\">[!INCLUDE[win8](../../../includes/win8-md.md)]</ph> and above.","pos":[10961,11135],"source":" This is the default behavior of a [WinVerifyTrust](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust) call on [!INCLUDE[win8](../../../includes/win8-md.md)] and above."},{"pos":[11140,11154],"content":"<ph id=\"ph1\">`/o`</ph> <bpt id=\"p1\">*</bpt>Version<ept id=\"p1\">*</ept>","source":"`/o` *Version*"},{"content":"Verifies the file by operating system version.","pos":[11155,11201]},{"content":"<bpt id=\"p1\">*</bpt>Version<ept id=\"p1\">*</ept> has the following form: <bpt id=\"p2\">*</bpt>PlatformID<ept id=\"p2\">*</ept>:<bpt id=\"p3\">*</bpt>VerMajor<ept id=\"p3\">*</ept>.<bpt id=\"p4\">*</bpt>VerMinor<ept id=\"p4\">*</ept>.<bpt id=\"p5\">*</bpt>BuildNumber<ept id=\"p5\">*</ept>.","pos":[11202,11285],"source":"*Version* has the following form: *PlatformID*:*VerMajor*.*VerMinor*.*BuildNumber*."},{"content":"<bpt id=\"p1\">*</bpt>PlatformID<ept id=\"p1\">*</ept> represents the underlying value of a <ph id=\"ph1\">&lt;xref:System.PlatformID&gt;</ph> enumeration member.","pos":[11286,11380],"source":"*PlatformID* represents the underlying value of a <xref:System.PlatformID> enumeration member."},{"content":"<bpt id=\"p1\">**</bpt>Important:<ept id=\"p1\">**</ept>  The use of the <ph id=\"ph1\">`/o`</ph> switch is recommended.","pos":[11381,11439],"source":"**Important:**  The use of the `/o` switch is recommended."},{"content":"If <ph id=\"ph1\">`/o`</ph> is not specified, SignTool.exe may return unexpected results.","pos":[11440,11509],"source":" If `/o` is not specified, SignTool.exe may return unexpected results."},{"content":"For example, if you do not include the <ph id=\"ph1\">`/o`</ph> switch, system catalogs that validate correctly on an older operating system may not validate correctly on a newer operating system.","pos":[11510,11686],"source":" For example, if you do not include the `/o` switch, system catalogs that validate correctly on an older operating system may not validate correctly on a newer operating system."},{"content":"Verifies PKCS #7 files.","pos":[11697,11720]},{"content":"No existing policies are used for PKCS #7 validation.","pos":[11721,11774]},{"content":"The signature is checked and a chain is built for the signing certificate.","pos":[11775,11849]},{"content":"Specifies that the Default Authenticode Verification Policy should be used.","pos":[11860,11935]},{"content":"If the <ph id=\"ph1\">`/pa`</ph> option is not specified, Sign Tool uses the Windows Driver Verification Policy.","pos":[11936,12028],"source":" If the `/pa` option is not specified, Sign Tool uses the Windows Driver Verification Policy."},{"content":"This option cannot be used with the <ph id=\"ph1\">`catdb`</ph> options.","pos":[12029,12081],"source":" This option cannot be used with the `catdb` options."},{"pos":[12086,12104],"content":"<ph id=\"ph1\">`/pg`</ph> <bpt id=\"p1\">*</bpt>PolicyGUID<ept id=\"p1\">*</ept>","source":"`/pg` *PolicyGUID*"},{"content":"Specifies a verification policy by GUID.","pos":[12105,12145]},{"content":"The <bpt id=\"p1\">*</bpt>PolicyGUID<ept id=\"p1\">*</ept> corresponds to the ActionID of the verification policy.","pos":[12146,12218],"source":" The *PolicyGUID* corresponds to the ActionID of the verification policy."},{"content":"This option cannot be used with the <ph id=\"ph1\">`catdb`</ph> options.","pos":[12219,12271],"source":" This option cannot be used with the `catdb` options."},{"content":"Specifies that Sign Tool should print and verify page hash values.","pos":[12282,12348]},{"pos":[12353,12375],"content":"<ph id=\"ph1\">`/r`</ph> <bpt id=\"p1\">*</bpt>RootSubjectName<ept id=\"p1\">*</ept>","source":"`/r` *RootSubjectName*"},{"content":"Specifies the name of the subject of the root certificate that the signing certificate must chain to.","pos":[12376,12477]},{"content":"This value can be a substring of the entire subject name of the root certificate.","pos":[12478,12559]},{"content":"Specifies that a warning should be generated if the signature is not time stamped.","pos":[12570,12652]},{"pos":[12660,12798],"content":"For usage examples, see <bpt id=\"p1\">[</bpt>Using SignTool to Verify a File Signature<ept id=\"p1\">](/windows/desktop/SecCrypto/using-signtool-to-verify-a-file-signature)</ept>.","source":"For usage examples, see [Using SignTool to Verify a File Signature](/windows/desktop/SecCrypto/using-signtool-to-verify-a-file-signature)."},{"pos":[12807,12819],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Sign Tool returns one of the following exit codes when it terminates.","pos":[12823,12892]},{"content":"Exit code","pos":[12899,12908]},{"content":"Description","pos":[12909,12920]},{"content":"0","pos":[12963,12964]},{"content":"Execution was successful.","pos":[12965,12990]},{"content":"1","pos":[12995,12996]},{"content":"Execution has failed.","pos":[12997,13018]},{"content":"2","pos":[13023,13024]},{"content":"Execution has completed with warnings.","pos":[13025,13063]},{"pos":[13073,13081],"content":"Examples","linkify":"Examples","nodes":[{"content":"Examples","pos":[0,8]}]},{"content":"The following command adds the catalog file MyCatalogFileName.cat to the system component and driver database.","pos":[13085,13195]},{"content":"The <ph id=\"ph1\">`/u`</ph> option generates a unique name if necessary to prevent replacing an existing catalog file named <ph id=\"ph2\">`MyCatalogFileName.cat`</ph>.","pos":[13196,13325],"source":" The `/u` option generates a unique name if necessary to prevent replacing an existing catalog file named `MyCatalogFileName.cat`."},{"content":"The following command signs a file automatically by using the best certificate.","pos":[13392,13471]},{"content":"The following command digitally signs a file by using a certificate stored in a password-protected PFX file.","pos":[13523,13631]},{"content":"The following command digitally signs and time-stamps a file.","pos":[13708,13769]},{"content":"The certificate used to sign the file is stored in a PFX file.","pos":[13770,13832]},{"pos":[13949,14085],"content":"The following command signs a file by using a certificate located in the <ph id=\"ph1\">`My`</ph> store that has a subject name of <ph id=\"ph2\">`My Company Certificate`</ph>.","source":"The following command signs a file by using a certificate located in the `My` store that has a subject name of `My Company Certificate`."},{"content":"The following command signs an ActiveX control and provides information that is displayed by Internet Explorer when the user is prompted to install the control.","pos":[14162,14322]},{"content":"The following command time-stamps a file that has already been digitally signed.","pos":[14451,14531]},{"content":"The following command verifies that a file has been signed.","pos":[14639,14698]},{"content":"The following command verifies a system file that may be signed in a catalog.","pos":[14749,14826]},{"pos":[14884,14979],"content":"The following command verifies a system file that is signed in a catalog named <ph id=\"ph1\">`MyCatalog.cat`</ph>.","source":"The following command verifies a system file that is signed in a catalog named `MyCatalog.cat`."},{"pos":[15053,15061],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[15065,15112],"content":"<bpt id=\"p1\">[</bpt>Tools<ept id=\"p1\">](../../../docs/framework/tools/index.md)</ept>","source":"[Tools](../../../docs/framework/tools/index.md)"},{"pos":[15115,15198],"content":"<bpt id=\"p1\">[</bpt>Command Prompts<ept id=\"p1\">](../../../docs/framework/tools/developer-command-prompt-for-vs.md)</ept>","source":"[Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md)"}]}