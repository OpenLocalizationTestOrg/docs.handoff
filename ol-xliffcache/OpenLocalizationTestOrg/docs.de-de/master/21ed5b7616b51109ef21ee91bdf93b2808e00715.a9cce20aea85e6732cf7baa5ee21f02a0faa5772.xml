{"content":"---\ntitle: \"Claims-Based Identity Model\"\nms.date: \"03/30/2017\"\nms.assetid: 4a96a9af-d980-43be-bf91-341a23401431\nauthor: \"BrucePerlerMS\"\n---\n# Claims-Based Identity Model\nWhen you build claims-aware applications, the user identity is represented in your application as a set of claims. One claim could be the user’s name, another might be an email address. The idea is that an external identity system is configured to give your application everything it needs to know about the user with each request she makes, along with cryptographic assurance that the identity data you receive comes from a trusted source.  \n  \n Under this model, single sign-on is much easier to achieve, and your application is no longer responsible for the following:  \n  \n-   Authenticating users.  \n  \n-   Storing user accounts and passwords.  \n  \n-   Calling to enterprise directories to look up user identity details.  \n  \n-   Integrating with identity systems from other platforms or companies.  \n  \n Under this model, your application makes identity-related decisions based on claims supplied by the system that authenticated your user. This could be anything from simple application personalization with the user’s first name, to authorizing the user to access higher valued features and resources in your application.  \n  \n This topic provides the following information:  \n  \n-   [Introduction to Claims-Based Identity](../../../docs/framework/security/claims-based-identity-model.md#BKMK_1)  \n  \n-   [Basic Scenario for a Claims-Based Identity Model](../../../docs/framework/security/claims-based-identity-model.md#BKMK_2)  \n  \n<a name=\"BKMK_1\"></a>   \n## Introduction to Claims-Based Identity  \n The following terminology and concepts can help you understand this new architecture for identity.  \n  \n### Identity  \n For the purposes of describing the programming model in Windows Identity Foundation (WIF), we will use the term \"identity\" to represent a set of attributes that describe a user or some other entity in a system that you want to secure.  \n  \n### Claim  \n Think of a claim as a piece of identity information such as name, email address, age, membership in the Sales role. The more claims your application receives, the more you’ll know about your user. You may be wondering why these are called \"claims,\" rather than \"attributes,\" as is commonly used in describing enterprise directories. The reason has to do with the delivery method. In this model, your application doesn’t look up user attributes in a directory. Instead, the user delivers claims to your application, and your application examines them. Each claim is made by an issuer, and you trust the claim only as much as you trust the issuer. For example, you trust a claim made by your company’s domain controller more than you trust a claim made by the user herself. WIF represents claims with a <xref:System.Security.Claims.Claim> type, which has an <xref:System.Security.Claims.Claim.Issuer%2A> property that allows you to find out who issued the claim.  \n  \n### Security Token  \n The user delivers a set of claims to your application along with a request. In a Web service, these claims are carried in the security header of the SOAP envelope. In a browser-based Web application, the claims arrive through an HTTP POST from the user’s browser, and may later be cached in a cookie if a session is desired. Regardless of how these claims arrive, they must be serialized, which is where security tokens come in. A security token is a serialized set of claims that is digitally signed by the issuing authority. The signature is important: it gives you assurance that the user didn’t just make up a bunch of claims and send them to you. In low security situations where cryptography isn’t necessary or desired, you can use unsigned tokens, but that scenario is not described in this topic.  \n  \n One of the core features in WIF is the ability to create and read security tokens. WIF and the .NET Framework handle all of the cryptographic work, and present your application with a set of claims that you can read.  \n  \n### Issuing Authority  \n There are lots of different types of issuing authorities, from domain controllers that issue Kerberos tickets, to certification authorities that issue X.509 certificates, but the specific type of authority discussed in this topic issues security tokens that contain claims. This issuing authority is a Web application or Web service that knows how to issue security tokens. It must have enough knowledge to be able to issue the proper claims given the target relying party and the user making the request, and might be responsible for interacting with user stores to look up claims and authenticate the users themselves.  \n  \n Whatever issuing authority you choose, it plays a central role in your identity solution. When you factor authentication out of your application by relying on claims, you’re passing responsibility to that authority and asking it to authenticate users on your behalf.  \n  \n### Security Token Service (STS)  \n A security token service (STS) is the service component that builds, signs, and issues security tokens according to the WS-Trust and WS-Federation protocols. There’s a lot of work that goes into implementing these protocols, but WIF does all of this work for you, making it feasible for someone who isn’t an expert in the protocols to get an STS up and running with very little effort. You can use a pre-built STS such as [Active Directory® Federation Services (AD FS) 2.0](https://go.microsoft.com/fwlink/?LinkID=247516), a cloud STS such as a [Windows Azure Access Control Service (ACS)](https://go.microsoft.com/fwlink/?LinkID=247517), or, if you want to issue custom tokens or provide custom authentication or authorization, you can build your own custom STS using WIF. WIF makes it easy to build your own STS.  \n  \n### Relying Party Application  \n When you build an application that relies on claims, you are building a relying party (RP) application. Synonyms for an RP include \"claims-aware application\" and \"claims-based application\". Web applications and Web services can both be RPs. A RP application consumes the tokens issued by a STS and extracts the claims from tokens to use them for identity related tasks. WIF offers functionalities to help you build RP applications.  \n  \n### Standards  \n In order to make all of this interoperable, several WS-* standards are used in the previous scenario. Policy is retrieved using WS-MetadataExchange, and the policy itself is structured according to the WS-Policy specification. The STS exposes endpoints that implement the WS-Trust specification, which describes how to request and receive security tokens. Most STSs today issue tokens formatted with Security Assertion Markup Langauge (SAML). SAML is an industry-recognized XML vocabulary that can be used to represent claims in an interoperable way. Or, in a multi-platform situation, this allows you to communicate with an STS on an entirely different platform and achieve single sign-on across all of your applications, regardless of platform.  \n  \n### Browser-Based Applications  \n Smart clients aren’t the only ones who can use the claims-based identity model. Browser-based applications (also referred to as passive clients) can use it as well. The following scenario describes how this works.  \n  \n First, the user points a browser at a claims-aware Web application (the relying party application). The Web application redirects the browser to the STS so the user can be authenticated. The STS is hosted in a simple web application that reads the incoming request, authenticates the user using standard HTTP mechanisms, and then creates a SAML token and replies with a piece of JavaScript code that causes the browser to initiate an HTTP POST that sends the SAML token back to the RP. The body of this POST contains the claims that the RP requested. At this point, it is common for the RP to package the claims into a cookie so that the user doesn’t have to be redirected for each request.  \n  \n<a name=\"BKMK_2\"></a>   \n## Basic Scenario for a Claims-Based Identity Model  \n The following is an example of a claims-based system.  \n  \n ![Relying Partner Authentication Flow](../../../docs/framework/security/media/conc-relying-partner-processc.png \"conc_relying_partner_processc\")  \n  \n This diagram shows a Web site (the relying party application, RP) that has been configured to use WIF for authentication and a client, a web browser, that wants to use that site.  \n  \n1.  When an unauthenticated user requests a page, their browser is redirected to the identity provider (IdP) pages.  \n  \n2.  The IdP requires the user to present their credentials, such as username/password or Kerberos authentication.  \n  \n3.  The IdP issues a token back to that is returned to the browser.  \n  \n4.  The browser is now redirected back to the originally requested page where WIF determines if the token satisfies the requirements to access the page. If so a cookie is issued to establish a session so the authentication only needs to occur once, and control is passed to the application.\n","nodes":[{"pos":[4,135],"embed":true,"restype":"x-metadata","content":"title: \"Claims-Based Identity Model\"\nms.date: \"03/30/2017\"\nms.assetid: 4a96a9af-d980-43be-bf91-341a23401431\nauthor: \"BrucePerlerMS\"","nodes":[{"content":"Claims-Based Identity Model","nodes":[{"pos":[0,27],"content":"Claims-Based Identity Model","nodes":[{"content":"Claims-Based Identity Model","pos":[0,27]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[142,169],"content":"Claims-Based Identity Model","linkify":"Claims-Based Identity Model","nodes":[{"content":"Claims-Based Identity Model","pos":[0,27]}]},{"content":"When you build claims-aware applications, the user identity is represented in your application as a set of claims.","pos":[170,284]},{"content":"One claim could be the user’s name, another might be an email address.","pos":[285,355]},{"content":"The idea is that an external identity system is configured to give your application everything it needs to know about the user with each request she makes, along with cryptographic assurance that the identity data you receive comes from a trusted source.","pos":[356,610]},{"content":"Under this model, single sign-on is much easier to achieve, and your application is no longer responsible for the following:","pos":[617,741]},{"content":"Authenticating users.","pos":[751,772]},{"content":"Storing user accounts and passwords.","pos":[782,818]},{"content":"Calling to enterprise directories to look up user identity details.","pos":[828,895]},{"content":"Integrating with identity systems from other platforms or companies.","pos":[905,973]},{"content":"Under this model, your application makes identity-related decisions based on claims supplied by the system that authenticated your user.","pos":[980,1116]},{"content":"This could be anything from simple application personalization with the user’s first name, to authorizing the user to access higher valued features and resources in your application.","pos":[1117,1299]},{"content":"This topic provides the following information:","pos":[1306,1352]},{"pos":[1362,1473],"content":"<bpt id=\"p1\">[</bpt>Introduction to Claims-Based Identity<ept id=\"p1\">](../../../docs/framework/security/claims-based-identity-model.md#BKMK_1)</ept>","source":"[Introduction to Claims-Based Identity](../../../docs/framework/security/claims-based-identity-model.md#BKMK_1)"},{"pos":[1483,1605],"content":"<bpt id=\"p1\">[</bpt>Basic Scenario for a Claims-Based Identity Model<ept id=\"p1\">](../../../docs/framework/security/claims-based-identity-model.md#BKMK_2)</ept>","source":"[Basic Scenario for a Claims-Based Identity Model](../../../docs/framework/security/claims-based-identity-model.md#BKMK_2)"},{"pos":[1639,1676],"content":"Introduction to Claims-Based Identity","linkify":"Introduction to Claims-Based Identity","nodes":[{"content":"Introduction to Claims-Based Identity","pos":[0,37]}]},{"content":"The following terminology and concepts can help you understand this new architecture for identity.","pos":[1680,1778]},{"pos":[1788,1796],"content":"Identity","linkify":"Identity","nodes":[{"content":"Identity","pos":[0,8]}]},{"content":"For the purposes of describing the programming model in Windows Identity Foundation (WIF), we will use the term \"identity\" to represent a set of attributes that describe a user or some other entity in a system that you want to secure.","pos":[1800,2034]},{"pos":[2044,2049],"content":"Claim","linkify":"Claim","nodes":[{"content":"Claim","pos":[0,5]}]},{"content":"Think of a claim as a piece of identity information such as name, email address, age, membership in the Sales role.","pos":[2053,2168]},{"content":"The more claims your application receives, the more you’ll know about your user.","pos":[2169,2249]},{"content":"You may be wondering why these are called \"claims,\" rather than \"attributes,\" as is commonly used in describing enterprise directories.","pos":[2250,2385]},{"content":"The reason has to do with the delivery method.","pos":[2386,2432]},{"content":"In this model, your application doesn’t look up user attributes in a directory.","pos":[2433,2512]},{"content":"Instead, the user delivers claims to your application, and your application examines them.","pos":[2513,2603]},{"content":"Each claim is made by an issuer, and you trust the claim only as much as you trust the issuer.","pos":[2604,2698]},{"content":"For example, you trust a claim made by your company’s domain controller more than you trust a claim made by the user herself.","pos":[2699,2824]},{"content":"WIF represents claims with a <ph id=\"ph1\">&lt;xref:System.Security.Claims.Claim&gt;</ph> type, which has an <ph id=\"ph2\">&lt;xref:System.Security.Claims.Claim.Issuer%2A&gt;</ph> property that allows you to find out who issued the claim.","pos":[2825,3013],"source":" WIF represents claims with a <xref:System.Security.Claims.Claim> type, which has an <xref:System.Security.Claims.Claim.Issuer%2A> property that allows you to find out who issued the claim."},{"pos":[3023,3037],"content":"Security Token","linkify":"Security Token","nodes":[{"content":"Security Token","pos":[0,14]}]},{"content":"The user delivers a set of claims to your application along with a request.","pos":[3041,3116]},{"content":"In a Web service, these claims are carried in the security header of the SOAP envelope.","pos":[3117,3204]},{"content":"In a browser-based Web application, the claims arrive through an HTTP POST from the user’s browser, and may later be cached in a cookie if a session is desired.","pos":[3205,3365]},{"content":"Regardless of how these claims arrive, they must be serialized, which is where security tokens come in.","pos":[3366,3469]},{"content":"A security token is a serialized set of claims that is digitally signed by the issuing authority.","pos":[3470,3567]},{"content":"The signature is important: it gives you assurance that the user didn’t just make up a bunch of claims and send them to you.","pos":[3568,3692]},{"content":"In low security situations where cryptography isn’t necessary or desired, you can use unsigned tokens, but that scenario is not described in this topic.","pos":[3693,3845]},{"content":"One of the core features in WIF is the ability to create and read security tokens.","pos":[3852,3934]},{"content":"WIF and the .NET Framework handle all of the cryptographic work, and present your application with a set of claims that you can read.","pos":[3935,4068]},{"pos":[4078,4095],"content":"Issuing Authority","linkify":"Issuing Authority","nodes":[{"content":"Issuing Authority","pos":[0,17]}]},{"content":"There are lots of different types of issuing authorities, from domain controllers that issue Kerberos tickets, to certification authorities that issue X.509 certificates, but the specific type of authority discussed in this topic issues security tokens that contain claims.","pos":[4099,4372]},{"content":"This issuing authority is a Web application or Web service that knows how to issue security tokens.","pos":[4373,4472]},{"content":"It must have enough knowledge to be able to issue the proper claims given the target relying party and the user making the request, and might be responsible for interacting with user stores to look up claims and authenticate the users themselves.","pos":[4473,4719]},{"content":"Whatever issuing authority you choose, it plays a central role in your identity solution.","pos":[4726,4815]},{"content":"When you factor authentication out of your application by relying on claims, you’re passing responsibility to that authority and asking it to authenticate users on your behalf.","pos":[4816,4992]},{"pos":[5002,5030],"content":"Security Token Service (STS)","linkify":"Security Token Service (STS)","nodes":[{"content":"Security Token Service (STS)","pos":[0,28]}]},{"content":"A security token service (STS) is the service component that builds, signs, and issues security tokens according to the WS-Trust and WS-Federation protocols.","pos":[5034,5191]},{"content":"There’s a lot of work that goes into implementing these protocols, but WIF does all of this work for you, making it feasible for someone who isn’t an expert in the protocols to get an STS up and running with very little effort.","pos":[5192,5419]},{"content":"You can use a pre-built STS such as <bpt id=\"p1\">[</bpt>Active Directory® Federation Services (AD FS) 2.0<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=247516)</ept>, a cloud STS such as a <bpt id=\"p2\">[</bpt>Windows Azure Access Control Service (ACS)<ept id=\"p2\">](https://go.microsoft.com/fwlink/?LinkID=247517)</ept>, or, if you want to issue custom tokens or provide custom authentication or authorization, you can build your own custom STS using WIF.","pos":[5420,5807],"source":" You can use a pre-built STS such as [Active Directory® Federation Services (AD FS) 2.0](https://go.microsoft.com/fwlink/?LinkID=247516), a cloud STS such as a [Windows Azure Access Control Service (ACS)](https://go.microsoft.com/fwlink/?LinkID=247517), or, if you want to issue custom tokens or provide custom authentication or authorization, you can build your own custom STS using WIF."},{"content":"WIF makes it easy to build your own STS.","pos":[5808,5848]},{"pos":[5858,5883],"content":"Relying Party Application","linkify":"Relying Party Application","nodes":[{"content":"Relying Party Application","pos":[0,25]}]},{"content":"When you build an application that relies on claims, you are building a relying party (RP) application.","pos":[5887,5990]},{"content":"Synonyms for an RP include \"claims-aware application\" and \"claims-based application\".","pos":[5991,6076]},{"content":"Web applications and Web services can both be RPs.","pos":[6077,6127]},{"content":"A RP application consumes the tokens issued by a STS and extracts the claims from tokens to use them for identity related tasks.","pos":[6128,6256]},{"content":"WIF offers functionalities to help you build RP applications.","pos":[6257,6318]},{"pos":[6328,6337],"content":"Standards","linkify":"Standards","nodes":[{"content":"Standards","pos":[0,9]}]},{"content":"In order to make all of this interoperable, several WS-* standards are used in the previous scenario.","pos":[6341,6442]},{"content":"Policy is retrieved using WS-MetadataExchange, and the policy itself is structured according to the WS-Policy specification.","pos":[6443,6567]},{"content":"The STS exposes endpoints that implement the WS-Trust specification, which describes how to request and receive security tokens.","pos":[6568,6696]},{"content":"Most STSs today issue tokens formatted with Security Assertion Markup Langauge (SAML).","pos":[6697,6783]},{"content":"SAML is an industry-recognized XML vocabulary that can be used to represent claims in an interoperable way.","pos":[6784,6891]},{"content":"Or, in a multi-platform situation, this allows you to communicate with an STS on an entirely different platform and achieve single sign-on across all of your applications, regardless of platform.","pos":[6892,7087]},{"pos":[7097,7123],"content":"Browser-Based Applications","linkify":"Browser-Based Applications","nodes":[{"content":"Browser-Based Applications","pos":[0,26]}]},{"content":"Smart clients aren’t the only ones who can use the claims-based identity model.","pos":[7127,7206]},{"content":"Browser-based applications (also referred to as passive clients) can use it as well.","pos":[7207,7291]},{"content":"The following scenario describes how this works.","pos":[7292,7340]},{"content":"First, the user points a browser at a claims-aware Web application (the relying party application).","pos":[7347,7446]},{"content":"The Web application redirects the browser to the STS so the user can be authenticated.","pos":[7447,7533]},{"content":"The STS is hosted in a simple web application that reads the incoming request, authenticates the user using standard HTTP mechanisms, and then creates a SAML token and replies with a piece of JavaScript code that causes the browser to initiate an HTTP POST that sends the SAML token back to the RP.","pos":[7534,7832]},{"content":"The body of this POST contains the claims that the RP requested.","pos":[7833,7897]},{"content":"At this point, it is common for the RP to package the claims into a cookie so that the user doesn’t have to be redirected for each request.","pos":[7898,8037]},{"pos":[8071,8119],"content":"Basic Scenario for a Claims-Based Identity Model","linkify":"Basic Scenario for a Claims-Based Identity Model","nodes":[{"content":"Basic Scenario for a Claims-Based Identity Model","pos":[0,48]}]},{"content":"The following is an example of a claims-based system.","pos":[8123,8176]},{"pos":[8183,8327],"content":"<bpt id=\"p1\">![</bpt>Relying Partner Authentication Flow<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../docs/framework/security/media/conc-relying-partner-processc.png \"</bpt>conc_relying_partner_processc<ept id=\"p2\">\")</ept>","source":"![Relying Partner Authentication Flow](../../../docs/framework/security/media/conc-relying-partner-processc.png \"conc_relying_partner_processc\")"},{"content":"This diagram shows a Web site (the relying party application, RP) that has been configured to use WIF for authentication and a client, a web browser, that wants to use that site.","pos":[8334,8512]},{"content":"When an unauthenticated user requests a page, their browser is redirected to the identity provider (IdP) pages.","pos":[8522,8633]},{"content":"The IdP requires the user to present their credentials, such as username/password or Kerberos authentication.","pos":[8643,8752]},{"content":"The IdP issues a token back to that is returned to the browser.","pos":[8762,8825]},{"content":"The browser is now redirected back to the originally requested page where WIF determines if the token satisfies the requirements to access the page.","pos":[8835,8983]},{"content":"If so a cookie is issued to establish a session so the authentication only needs to occur once, and control is passed to the application.","pos":[8984,9121]}]}