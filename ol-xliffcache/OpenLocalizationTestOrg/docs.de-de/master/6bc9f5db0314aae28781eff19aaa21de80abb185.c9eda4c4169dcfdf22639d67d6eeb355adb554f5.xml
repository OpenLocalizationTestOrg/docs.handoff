{"content":"---\ntitle: \"Use Caching in UI Automation | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"caching, UI Automation\"\n  - \"UI Automation, caching\"\nms.assetid: ec722dff-6009-4279-b86a-e18d3fa94ebf\ncaps.latest.revision: 14\nauthor: \"Xansky\"\nms.author: \"mhopkins\"\nmanager: \"markl\"\n---\n# Use Caching in UI Automation\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This section shows how to implement caching of <xref:System.Windows.Automation.AutomationElement> properties and control patterns.  \n  \n### Activate a Cache Request  \n  \n1.  Create a <xref:System.Windows.Automation.CacheRequest>.  \n  \n2.  Specify properties and patterns to cache by using <xref:System.Windows.Automation.CacheRequest.Add%2A>.  \n  \n3.  Specify the scope of caching by setting the <xref:System.Windows.Automation.CacheRequest.TreeScope%2A> property.  \n  \n4.  Specify the view of the subtree by setting the <xref:System.Windows.Automation.CacheRequest.TreeFilter%2A> property.  \n  \n5.  Set the <xref:System.Windows.Automation.CacheRequest.AutomationElementMode%2A> property to <xref:System.Windows.Automation.AutomationElementMode> if you wish to increase efficiency by not retrieving a full reference to objects. (This will make it impossible to retrieve current values from those objects.)  \n  \n6.  Activate the request by using <xref:System.Windows.Automation.CacheRequest.Activate%2A> within a `using` block (`Using` in [!INCLUDE[TLA#tla_visualbnet](../../../includes/tlasharptla-visualbnet-md.md)]).  \n  \n After obtaining <xref:System.Windows.Automation.AutomationElement> objects or subscribing to events, deactivate the request by using <xref:System.Windows.Automation.CacheRequest.Pop%2A> (if <xref:System.Windows.Automation.CacheRequest.Push%2A> was used) or by disposing the object created by <xref:System.Windows.Automation.CacheRequest.Activate%2A>. (Use <xref:System.Windows.Automation.CacheRequest.Activate%2A> in a `using` block (`Using` in [!INCLUDE[TLA#tla_visualbnet](../../../includes/tlasharptla-visualbnet-md.md)]).  \n  \n### Cache AutomationElement Properties  \n  \n1.  While a <xref:System.Windows.Automation.CacheRequest> is active, obtain <xref:System.Windows.Automation.AutomationElement> objects by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A>; or obtain an <xref:System.Windows.Automation.AutomationElement> as the source of an event that you registered for when the <xref:System.Windows.Automation.CacheRequest> was active. (You can also create a cache by passing a <xref:System.Windows.Automation.CacheRequest> to GetUpdatedCache or one of the <xref:System.Windows.Automation.TreeWalker> methods.)  \n  \n2.  Use <xref:System.Windows.Automation.AutomationElement.GetCachedPropertyValue%2A> or retrieve a property from the <xref:System.Windows.Automation.AutomationElement.Cached%2A> property of the <xref:System.Windows.Automation.AutomationElement>.  \n  \n### Obtain Cached Patterns and Their Properties  \n  \n1.  While a <xref:System.Windows.Automation.CacheRequest> is active, obtain <xref:System.Windows.Automation.AutomationElement> objects by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A>; or obtain an <xref:System.Windows.Automation.AutomationElement> as the source of an event that you registered for when the <xref:System.Windows.Automation.CacheRequest> was active. (You can also create a cache by passing a <xref:System.Windows.Automation.CacheRequest> to GetUpdatedCache or one of the <xref:System.Windows.Automation.TreeWalker> methods.)  \n  \n2.  Use <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> or <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> to retrieve a cached pattern.  \n  \n3.  Retrieve property values from the `Cached` property of the control pattern.  \n  \n## Example  \n The following code example shows various aspects of caching, using <xref:System.Windows.Automation.CacheRequest.Activate%2A> to activate the <xref:System.Windows.Automation.CacheRequest>.  \n  \n [!code-csharp[UIAClient_snip#107](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAClient_snip/CSharp/ClientForm.cs#107)]\n [!code-vb[UIAClient_snip#107](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAClient_snip/VisualBasic/ClientForm.vb#107)]  \n  \n## Example  \n The following code example shows various aspects of caching, using <xref:System.Windows.Automation.CacheRequest.Push%2A> to activate the <xref:System.Windows.Automation.CacheRequest>. Except when you wish to nest cache requests, it is preferable to use <xref:System.Windows.Automation.CacheRequest.Activate%2A>.  \n  \n [!code-csharp[UIAClient_snip#108](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAClient_snip/CSharp/ClientForm.cs#108)]\n [!code-vb[UIAClient_snip#108](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAClient_snip/VisualBasic/ClientForm.vb#108)]  \n  \n## See Also  \n [Caching in UI Automation Clients](../../../docs/framework/ui-automation/caching-in-ui-automation-clients.md)","nodes":[{"pos":[4,430],"embed":true,"restype":"x-metadata","content":"title: \"Use Caching in UI Automation | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"caching, UI Automation\"\n  - \"UI Automation, caching\"\nms.assetid: ec722dff-6009-4279-b86a-e18d3fa94ebf\ncaps.latest.revision: 14\nauthor: \"Xansky\"\nms.author: \"mhopkins\"\nmanager: \"markl\"","nodes":[{"content":"Use Caching in UI Automation | Microsoft Docs","nodes":[{"pos":[0,45],"content":"Use Caching in UI Automation | Microsoft Docs","nodes":[{"content":"Use Caching in UI Automation | Microsoft Docs","pos":[0,45]}]}],"path":["title"]}],"yml":true},{"pos":[437,465],"content":"Use Caching in UI Automation","linkify":"Use Caching in UI Automation","nodes":[{"content":"Use Caching in UI Automation","pos":[0,28]}]},{"pos":[468,930],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,460],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,451],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"content":"This section shows how to implement caching of <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> properties and control patterns.","pos":[937,1067],"source":"This section shows how to implement caching of <xref:System.Windows.Automation.AutomationElement> properties and control patterns."},{"pos":[1077,1101],"content":"Activate a Cache Request","linkify":"Activate a Cache Request","nodes":[{"content":"Activate a Cache Request","pos":[0,24]}]},{"content":"Create a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph>.","pos":[1111,1166],"source":"Create a <xref:System.Windows.Automation.CacheRequest>."},{"content":"Specify properties and patterns to cache by using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.Add%2A&gt;</ph>.","pos":[1176,1279],"source":"Specify properties and patterns to cache by using <xref:System.Windows.Automation.CacheRequest.Add%2A>."},{"content":"Specify the scope of caching by setting the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.TreeScope%2A&gt;</ph> property.","pos":[1289,1401],"source":"Specify the scope of caching by setting the <xref:System.Windows.Automation.CacheRequest.TreeScope%2A> property."},{"content":"Specify the view of the subtree by setting the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.TreeFilter%2A&gt;</ph> property.","pos":[1411,1527],"source":"Specify the view of the subtree by setting the <xref:System.Windows.Automation.CacheRequest.TreeFilter%2A> property."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.AutomationElementMode%2A&gt;</ph> property to <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElementMode&gt;</ph> if you wish to increase efficiency by not retrieving a full reference to objects.","pos":[1537,1764],"source":"Set the <xref:System.Windows.Automation.CacheRequest.AutomationElementMode%2A> property to <xref:System.Windows.Automation.AutomationElementMode> if you wish to increase efficiency by not retrieving a full reference to objects."},{"content":"(This will make it impossible to retrieve current values from those objects.)","pos":[1765,1842]},{"pos":[1852,2055],"content":"Activate the request by using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.Activate%2A&gt;</ph> within a <ph id=\"ph2\">`using`</ph> block (<ph id=\"ph3\">`Using`</ph> in <ph id=\"ph4\">[!INCLUDE[TLA#tla_visualbnet](../../../includes/tlasharptla-visualbnet-md.md)]</ph>).","source":"Activate the request by using <xref:System.Windows.Automation.CacheRequest.Activate%2A> within a `using` block (`Using` in [!INCLUDE[TLA#tla_visualbnet](../../../includes/tlasharptla-visualbnet-md.md)])."},{"content":"After obtaining <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> objects or subscribing to events, deactivate the request by using <ph id=\"ph2\">&lt;xref:System.Windows.Automation.CacheRequest.Pop%2A&gt;</ph> (if <ph id=\"ph3\">&lt;xref:System.Windows.Automation.CacheRequest.Push%2A&gt;</ph> was used) or by disposing the object created by <ph id=\"ph4\">&lt;xref:System.Windows.Automation.CacheRequest.Activate%2A&gt;</ph>.","pos":[2062,2412],"source":"After obtaining <xref:System.Windows.Automation.AutomationElement> objects or subscribing to events, deactivate the request by using <xref:System.Windows.Automation.CacheRequest.Pop%2A> (if <xref:System.Windows.Automation.CacheRequest.Push%2A> was used) or by disposing the object created by <xref:System.Windows.Automation.CacheRequest.Activate%2A>."},{"content":"(Use <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.Activate%2A&gt;</ph> in a <ph id=\"ph2\">`using`</ph> block (<ph id=\"ph3\">`Using`</ph> in <ph id=\"ph4\">[!INCLUDE[TLA#tla_visualbnet](../../../includes/tlasharptla-visualbnet-md.md)]</ph>).","pos":[2413,2587],"source":" (Use <xref:System.Windows.Automation.CacheRequest.Activate%2A> in a `using` block (`Using` in [!INCLUDE[TLA#tla_visualbnet](../../../includes/tlasharptla-visualbnet-md.md)])."},{"pos":[2597,2631],"content":"Cache AutomationElement Properties","linkify":"Cache AutomationElement Properties","nodes":[{"content":"Cache AutomationElement Properties","pos":[0,34]}]},{"content":"While a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph> is active, obtain <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> objects by using <ph id=\"ph3\">&lt;xref:System.Windows.Automation.AutomationElement.FindFirst%2A&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Windows.Automation.AutomationElement.FindAll%2A&gt;</ph>; or obtain an <ph id=\"ph5\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> as the source of an event that you registered for when the <ph id=\"ph6\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph> was active.","pos":[2641,3091],"source":"While a <xref:System.Windows.Automation.CacheRequest> is active, obtain <xref:System.Windows.Automation.AutomationElement> objects by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A>; or obtain an <xref:System.Windows.Automation.AutomationElement> as the source of an event that you registered for when the <xref:System.Windows.Automation.CacheRequest> was active."},{"content":"(You can also create a cache by passing a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph> to GetUpdatedCache or one of the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TreeWalker&gt;</ph> methods.)","pos":[3092,3266],"source":" (You can also create a cache by passing a <xref:System.Windows.Automation.CacheRequest> to GetUpdatedCache or one of the <xref:System.Windows.Automation.TreeWalker> methods.)"},{"content":"Use <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.GetCachedPropertyValue%2A&gt;</ph> or retrieve a property from the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.Cached%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph>.","pos":[3276,3517],"source":"Use <xref:System.Windows.Automation.AutomationElement.GetCachedPropertyValue%2A> or retrieve a property from the <xref:System.Windows.Automation.AutomationElement.Cached%2A> property of the <xref:System.Windows.Automation.AutomationElement>."},{"pos":[3527,3570],"content":"Obtain Cached Patterns and Their Properties","linkify":"Obtain Cached Patterns and Their Properties","nodes":[{"content":"Obtain Cached Patterns and Their Properties","pos":[0,43]}]},{"content":"While a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph> is active, obtain <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> objects by using <ph id=\"ph3\">&lt;xref:System.Windows.Automation.AutomationElement.FindFirst%2A&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Windows.Automation.AutomationElement.FindAll%2A&gt;</ph>; or obtain an <ph id=\"ph5\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> as the source of an event that you registered for when the <ph id=\"ph6\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph> was active.","pos":[3580,4030],"source":"While a <xref:System.Windows.Automation.CacheRequest> is active, obtain <xref:System.Windows.Automation.AutomationElement> objects by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A>; or obtain an <xref:System.Windows.Automation.AutomationElement> as the source of an event that you registered for when the <xref:System.Windows.Automation.CacheRequest> was active."},{"content":"(You can also create a cache by passing a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph> to GetUpdatedCache or one of the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TreeWalker&gt;</ph> methods.)","pos":[4031,4205],"source":" (You can also create a cache by passing a <xref:System.Windows.Automation.CacheRequest> to GetUpdatedCache or one of the <xref:System.Windows.Automation.TreeWalker> methods.)"},{"content":"Use <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A&gt;</ph> to retrieve a cached pattern.","pos":[4215,4396],"source":"Use <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> or <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> to retrieve a cached pattern."},{"pos":[4406,4481],"content":"Retrieve property values from the <ph id=\"ph1\">`Cached`</ph> property of the control pattern.","source":"Retrieve property values from the `Cached` property of the control pattern."},{"pos":[4490,4497],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example shows various aspects of caching, using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.Activate%2A&gt;</ph> to activate the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph>.","pos":[4501,4688],"source":"The following code example shows various aspects of caching, using <xref:System.Windows.Automation.CacheRequest.Activate%2A> to activate the <xref:System.Windows.Automation.CacheRequest>."},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>UIAClient_snip#107<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAClient_snip/CSharp/ClientForm.cs#107)</ept><ept id=\"p1\">]</ept>","pos":[4695,4819],"source":"[!code-csharp[UIAClient_snip#107](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAClient_snip/CSharp/ClientForm.cs#107)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>UIAClient_snip#107<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAClient_snip/VisualBasic/ClientForm.vb#107)</ept><ept id=\"p1\">]</ept>","pos":[4821,4951],"source":"[!code-vb[UIAClient_snip#107](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAClient_snip/VisualBasic/ClientForm.vb#107)]"},{"pos":[4960,4967],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example shows various aspects of caching, using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.Push%2A&gt;</ph> to activate the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.CacheRequest&gt;</ph>.","pos":[4971,5154],"source":"The following code example shows various aspects of caching, using <xref:System.Windows.Automation.CacheRequest.Push%2A> to activate the <xref:System.Windows.Automation.CacheRequest>."},{"content":"Except when you wish to nest cache requests, it is preferable to use <ph id=\"ph1\">&lt;xref:System.Windows.Automation.CacheRequest.Activate%2A&gt;</ph>.","pos":[5155,5282],"source":" Except when you wish to nest cache requests, it is preferable to use <xref:System.Windows.Automation.CacheRequest.Activate%2A>."},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>UIAClient_snip#108<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAClient_snip/CSharp/ClientForm.cs#108)</ept><ept id=\"p1\">]</ept>","pos":[5289,5413],"source":"[!code-csharp[UIAClient_snip#108](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAClient_snip/CSharp/ClientForm.cs#108)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>UIAClient_snip#108<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAClient_snip/VisualBasic/ClientForm.vb#108)</ept><ept id=\"p1\">]</ept>","pos":[5415,5545],"source":"[!code-vb[UIAClient_snip#108](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAClient_snip/VisualBasic/ClientForm.vb#108)]"},{"pos":[5554,5562],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[5566,5675],"content":"<bpt id=\"p1\">[</bpt>Caching in UI Automation Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/caching-in-ui-automation-clients.md)</ept>","source":"[Caching in UI Automation Clients](../../../docs/framework/ui-automation/caching-in-ui-automation-clients.md)"}]}