{"content":"---\ntitle: \"Conditional Compilation in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"conditional compilation [Visual Basic], about conditional compilation\"\n  - \"compilation [Visual Basic], conditional\"\nms.assetid: 9c35e55e-7eee-44fb-a586-dad1f1884848\n---\n# Conditional Compilation in Visual Basic\nIn *conditional compilation*, particular blocks of code in a program are compiled selectively while others are ignored.  \n  \n For example, you may want to write debugging statements that compare the speed of different approaches to the same programming task, or you may want to localize an application for multiple languages. Conditional compilation statements are designed to run during compile time, not at run time.  \n  \n You denote blocks of code to be conditionally compiled with the `#If...Then...#Else` directive. For example, to create French- and German-language versions of the same application from the same source code, you embed platform-specific code segments in `#If...Then` statements using the predefined constants `FrenchVersion` and `GermanVersion`. The following example demonstrates how:  \n  \n [!code-vb[VbVbalrConditionalComp#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrConditionalComp/VB/Class1.vb#5)]  \n  \n If you set the value of the `FrenchVersion` conditional compilation constant to `True` at compile time, the conditional code for the French version is compiled. If you set the value of the `GermanVersion` constant to `True`, the compiler uses the German version. If neither is set to `True`, the code in the last `Else` block runs.  \n  \n> [!NOTE]\n>  Autocompletion will not function when editing code and using conditional compilation directives if the code is not part of the current branch.  \n  \n## Declaring Conditional Compilation Constants  \n You can set conditional compilation constants in one of three ways:  \n  \n-   In the **Project Designer**  \n  \n-   At the command line when using the command-line compiler  \n  \n-   In your code  \n  \n Conditional compilation constants have a special scope and cannot be accessed from standard code. The scope of a conditional compilation constant is dependent on the way it is set. The following table lists the scope of constants declared using each of the three ways mentioned above.  \n  \n|How constant is set|Scope of constant|  \n|---|---|  \n|**Project Designer**|Public to all files in the project|  \n|Command line|Public to all files passed to the command-line compiler|  \n|`#Const` statement in code|Private to the file in which it is declared|  \n  \n|To set constants in the Project Designer|  \n|---|  \n|-   Before creating your executable file, set constants in the **Project Designer** by following the steps provided in [Managing Project and Solution Properties](/visualstudio/ide/managing-project-and-solution-properties).|  \n  \n|To set constants at the command line|  \n|---|  \n|-   Use the **/d** switch to enter conditional compilation constants, as in the following example:<br />     `vbc MyProj.vb /d:conFrenchVersion=â€“1:conANSI=0`<br />     No space is required between the **/d** switch and the first constant. For more information, see [/define (Visual Basic)](../../../visual-basic/reference/command-line-compiler/define.md).<br />     Command-line declarations override declarations entered in the **Project Designer**, but do not erase them. Arguments set in **Project Designer** remain in effect for subsequent compilations.<br />     When writing constants in the code itself, there are no strict rules as to their placement, since their scope is the entire module in which they are declared.|  \n  \n|To set constants in your code|  \n|---|  \n|-   Place the constants in the declaration block of the module in which they are used. This helps keep your code organized and easier to read.|  \n  \n## Related Topics  \n  \n|Title|Description|  \n|---|---|  \n|[Program Structure and Code Conventions](../../../visual-basic/programming-guide/program-structure/program-structure-and-code-conventions.md)|Provides suggestions for making your code easy to read and maintain.|  \n  \n## Reference  \n [#Const Directive](../../../visual-basic/language-reference/directives/const-directive.md)  \n  \n [#If...Then...#Else Directives](../../../visual-basic/language-reference/directives/if-then-else-directives.md)  \n  \n [/define (Visual Basic)](../../../visual-basic/reference/command-line-compiler/define.md)\n","nodes":[{"pos":[4,265],"embed":true,"restype":"x-metadata","content":"title: \"Conditional Compilation in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"conditional compilation [Visual Basic], about conditional compilation\"\n  - \"compilation [Visual Basic], conditional\"\nms.assetid: 9c35e55e-7eee-44fb-a586-dad1f1884848","nodes":[{"content":"Conditional Compilation in Visual Basic","nodes":[{"pos":[0,39],"content":"Conditional Compilation in Visual Basic","nodes":[{"content":"Conditional Compilation in Visual Basic","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[272,311],"content":"Conditional Compilation in Visual Basic","linkify":"Conditional Compilation in Visual Basic","nodes":[{"content":"Conditional Compilation in Visual Basic","pos":[0,39]}]},{"pos":[312,431],"content":"In <bpt id=\"p1\">*</bpt>conditional compilation<ept id=\"p1\">*</ept>, particular blocks of code in a program are compiled selectively while others are ignored.","source":"In *conditional compilation*, particular blocks of code in a program are compiled selectively while others are ignored."},{"content":"For example, you may want to write debugging statements that compare the speed of different approaches to the same programming task, or you may want to localize an application for multiple languages.","pos":[438,637]},{"content":"Conditional compilation statements are designed to run during compile time, not at run time.","pos":[638,730]},{"content":"You denote blocks of code to be conditionally compiled with the <ph id=\"ph1\">`#If...Then...#Else`</ph> directive.","pos":[737,832],"source":"You denote blocks of code to be conditionally compiled with the `#If...Then...#Else` directive."},{"content":"For example, to create French- and German-language versions of the same application from the same source code, you embed platform-specific code segments in <ph id=\"ph1\">`#If...Then`</ph> statements using the predefined constants <ph id=\"ph2\">`FrenchVersion`</ph> and <ph id=\"ph3\">`GermanVersion`</ph>.","pos":[833,1080],"source":" For example, to create French- and German-language versions of the same application from the same source code, you embed platform-specific code segments in `#If...Then` statements using the predefined constants `FrenchVersion` and `GermanVersion`."},{"content":"The following example demonstrates how:","pos":[1081,1120]},{"content":"If you set the value of the <ph id=\"ph1\">`FrenchVersion`</ph> conditional compilation constant to <ph id=\"ph2\">`True`</ph> at compile time, the conditional code for the French version is compiled.","pos":[1261,1421],"source":"If you set the value of the `FrenchVersion` conditional compilation constant to `True` at compile time, the conditional code for the French version is compiled."},{"content":"If you set the value of the <ph id=\"ph1\">`GermanVersion`</ph> constant to <ph id=\"ph2\">`True`</ph>, the compiler uses the German version.","pos":[1422,1523],"source":" If you set the value of the `GermanVersion` constant to `True`, the compiler uses the German version."},{"content":"If neither is set to <ph id=\"ph1\">`True`</ph>, the code in the last <ph id=\"ph2\">`Else`</ph> block runs.","pos":[1524,1592],"source":" If neither is set to `True`, the code in the last `Else` block runs."},{"pos":[1600,1753],"content":"[!NOTE]\n Autocompletion will not function when editing code and using conditional compilation directives if the code is not part of the current branch.","leadings":["","> "],"nodes":[{"content":"Autocompletion will not function when editing code and using conditional compilation directives if the code is not part of the current branch.","pos":[9,151]}]},{"pos":[1762,1805],"content":"Declaring Conditional Compilation Constants","linkify":"Declaring Conditional Compilation Constants","nodes":[{"content":"Declaring Conditional Compilation Constants","pos":[0,43]}]},{"content":"You can set conditional compilation constants in one of three ways:","pos":[1809,1876]},{"pos":[1886,1913],"content":"In the <bpt id=\"p1\">**</bpt>Project Designer<ept id=\"p1\">**</ept>","source":"In the **Project Designer**"},{"content":"At the command line when using the command-line compiler","pos":[1923,1979]},{"content":"In your code","pos":[1989,2001]},{"content":"Conditional compilation constants have a special scope and cannot be accessed from standard code.","pos":[2008,2105]},{"content":"The scope of a conditional compilation constant is dependent on the way it is set.","pos":[2106,2188]},{"content":"The following table lists the scope of constants declared using each of the three ways mentioned above.","pos":[2189,2292]},{"content":"How constant is set","pos":[2299,2318]},{"content":"Scope of constant","pos":[2319,2336]},{"pos":[2353,2373],"content":"<bpt id=\"p1\">**</bpt>Project Designer<ept id=\"p1\">**</ept>","source":"**Project Designer**"},{"content":"Public to all files in the project","pos":[2374,2408]},{"content":"Command line","pos":[2413,2425]},{"content":"Public to all files passed to the command-line compiler","pos":[2426,2481]},{"pos":[2486,2512],"content":"<ph id=\"ph1\">`#Const`</ph> statement in code","source":"`#Const` statement in code"},{"content":"Private to the file in which it is declared","pos":[2513,2556]},{"content":"To set constants in the Project Designer","pos":[2564,2604]},{"pos":[2617,2839],"content":"-   Before creating your executable file, set constants in the <bpt id=\"p1\">**</bpt>Project Designer<ept id=\"p1\">**</ept> by following the steps provided in <bpt id=\"p2\">[</bpt>Managing Project and Solution Properties<ept id=\"p2\">](/visualstudio/ide/managing-project-and-solution-properties)</ept>.","source":"-   Before creating your executable file, set constants in the **Project Designer** by following the steps provided in [Managing Project and Solution Properties](/visualstudio/ide/managing-project-and-solution-properties)."},{"content":"To set constants at the command line","pos":[2847,2883]},{"content":"-   Use the <bpt id=\"p1\">**</bpt>/d<ept id=\"p1\">**</ept> switch to enter conditional compilation constants, as in the following example:","pos":[2896,2994],"source":"-   Use the **/d** switch to enter conditional compilation constants, as in the following example:"},{"content":"No space is required between the <bpt id=\"p1\">**</bpt>/d<ept id=\"p1\">**</ept> switch and the first constant.","pos":[3064,3134],"source":"No space is required between the **/d** switch and the first constant."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>/define (Visual Basic)<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/define.md)</ept>.","pos":[3135,3251],"source":" For more information, see [/define (Visual Basic)](../../../visual-basic/reference/command-line-compiler/define.md)."},{"content":"Command-line declarations override declarations entered in the <bpt id=\"p1\">**</bpt>Project Designer<ept id=\"p1\">**</ept>, but do not erase them.","pos":[3262,3369],"source":"Command-line declarations override declarations entered in the **Project Designer**, but do not erase them."},{"content":"Arguments set in <bpt id=\"p1\">**</bpt>Project Designer<ept id=\"p1\">**</ept> remain in effect for subsequent compilations.","pos":[3370,3453],"source":" Arguments set in **Project Designer** remain in effect for subsequent compilations."},{"content":"When writing constants in the code itself, there are no strict rules as to their placement, since their scope is the entire module in which they are declared.","pos":[3464,3622]},{"content":"To set constants in your code","pos":[3630,3659]},{"content":"-   Place the constants in the declaration block of the module in which they are used.","pos":[3672,3758]},{"content":"This helps keep your code organized and easier to read.","pos":[3759,3814]},{"pos":[3824,3838],"content":"Related Topics","linkify":"Related Topics","nodes":[{"content":"Related Topics","pos":[0,14]}]},{"content":"Title","pos":[3845,3850]},{"content":"Description","pos":[3851,3862]},{"pos":[3879,4020],"content":"<bpt id=\"p1\">[</bpt>Program Structure and Code Conventions<ept id=\"p1\">](../../../visual-basic/programming-guide/program-structure/program-structure-and-code-conventions.md)</ept>","source":"[Program Structure and Code Conventions](../../../visual-basic/programming-guide/program-structure/program-structure-and-code-conventions.md)"},{"content":"Provides suggestions for making your code easy to read and maintain.","pos":[4021,4089]},{"pos":[4099,4108],"content":"Reference","linkify":"Reference","nodes":[{"content":"Reference","pos":[0,9]}]},{"pos":[4112,4202],"content":"<bpt id=\"p1\">[</bpt>#Const Directive<ept id=\"p1\">](../../../visual-basic/language-reference/directives/const-directive.md)</ept>","source":"[#Const Directive](../../../visual-basic/language-reference/directives/const-directive.md)"},{"pos":[4209,4320],"content":"<bpt id=\"p1\">[</bpt>#If...Then...#Else Directives<ept id=\"p1\">](../../../visual-basic/language-reference/directives/if-then-else-directives.md)</ept>","source":"[#If...Then...#Else Directives](../../../visual-basic/language-reference/directives/if-then-else-directives.md)"},{"pos":[4327,4416],"content":"<bpt id=\"p1\">[</bpt>/define (Visual Basic)<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/define.md)</ept>","source":"[/define (Visual Basic)](../../../visual-basic/reference/command-line-compiler/define.md)"}]}