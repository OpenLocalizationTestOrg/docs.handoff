{"content":"---\ntitle: \"Serializing with an XML Declaration (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: 8726f79e-2bb0-4ba0-969d-197cca591647\ncaps.latest.revision: 3\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Serializing with an XML Declaration (Visual Basic)\nThis topic describes how to control whether serialization generates an XML declaration.  \n  \n## XML Declaration Generation  \n Serializing to a <xref:System.IO.File> or a <xref:System.IO.TextWriter> using the <xref:System.Xml.Linq.XElement.Save%2A?displayProperty=fullName> method or the <xref:System.Xml.Linq.XDocument.Save%2A?displayProperty=fullName> method generates an XML declaration. When you serialize to an <xref:System.Xml.XmlWriter>, the writer settings (specified in an <xref:System.Xml.XmlWriterSettings> object) determine whether an XML declaration is generated or not.  \n  \n If you are serializing to a string using the `ToString` method, the resulting XML will not include an XML declaration.  \n  \n### Serializing with an XML Declaration  \n The following example creates an <xref:System.Xml.Linq.XElement>, saves the document to a file, and then prints the file to the console:  \n  \n```vb  \nDim root As XElement = <Root>  \n                           <Child>child content</Child>  \n                       </Root>  \nroot.Save(\"Root.xml\")  \nDim str As String = File.ReadAllText(\"Root.xml\")  \nConsole.WriteLine(str)  \n```  \n  \n This example produces the following output:  \n  \n```xml  \n<?xml version=\"1.0\" encoding=\"utf-8\"?>  \n<Root>  \n  <Child>child content</Child>  \n</Root>  \n```  \n  \n### Serializing without an XML Declaration  \n The following example shows how to save an <xref:System.Xml.Linq.XElement> to an <xref:System.Xml.XmlWriter>.  \n  \n```vb  \nDim sb As StringBuilder = New StringBuilder()  \nDim xws As XmlWriterSettings = New XmlWriterSettings()  \nxws.OmitXmlDeclaration = True  \n  \nUsing xw As XmlWriter = XmlWriter.Create(sb, xws)  \n    Dim root = <Root>  \n                   <Child>child content</Child>  \n               </Root>  \n    root.Save(xw)  \nEnd Using  \nConsole.WriteLine(sb.ToString())  \n```  \n  \n This example produces the following output:  \n  \n```xml  \n<Root><Child>child content</Child></Root>  \n```  \n  \n## See Also  \n [Serializing XML Trees (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/serializing-xml-trees.md)","nodes":[{"pos":[12,79],"content":"Serializing with an XML Declaration (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Serializing with an XML Declaration (Visual Basic) | Microsoft Docs","pos":[0,67]}]},{"pos":[460,510],"content":"Serializing with an XML Declaration (Visual Basic)","linkify":"Serializing with an XML Declaration (Visual Basic)","nodes":[{"content":"Serializing with an XML Declaration (Visual Basic)","pos":[0,50]}]},{"content":"This topic describes how to control whether serialization generates an XML declaration.","pos":[511,598]},{"pos":[607,633],"content":"XML Declaration Generation","linkify":"XML Declaration Generation","nodes":[{"content":"XML Declaration Generation","pos":[0,26]}]},{"content":"Serializing to a <ph id=\"ph1\">&lt;xref:System.IO.File&gt;</ph> or a <ph id=\"ph2\">&lt;xref:System.IO.TextWriter&gt;</ph> using the <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XElement.Save%2A?displayProperty=fullName&gt;</ph> method or the <ph id=\"ph4\">&lt;xref:System.Xml.Linq.XDocument.Save%2A?displayProperty=fullName&gt;</ph> method generates an XML declaration.","pos":[637,900],"source":"Serializing to a <xref:System.IO.File> or a <xref:System.IO.TextWriter> using the <xref:System.Xml.Linq.XElement.Save%2A?displayProperty=fullName> method or the <xref:System.Xml.Linq.XDocument.Save%2A?displayProperty=fullName> method generates an XML declaration."},{"content":"When you serialize to an <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph>, the writer settings (specified in an <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriterSettings&gt;</ph> object) determine whether an XML declaration is generated or not.","pos":[901,1093],"source":" When you serialize to an <xref:System.Xml.XmlWriter>, the writer settings (specified in an <xref:System.Xml.XmlWriterSettings> object) determine whether an XML declaration is generated or not."},{"pos":[1100,1218],"content":"If you are serializing to a string using the <ph id=\"ph1\">`ToString`</ph> method, the resulting XML will not include an XML declaration.","source":"If you are serializing to a string using the `ToString` method, the resulting XML will not include an XML declaration."},{"pos":[1228,1263],"content":"Serializing with an XML Declaration","linkify":"Serializing with an XML Declaration","nodes":[{"content":"Serializing with an XML Declaration","pos":[0,35]}]},{"content":"The following example creates an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph>, saves the document to a file, and then prints the file to the console:","pos":[1267,1403],"source":"The following example creates an <xref:System.Xml.Linq.XElement>, saves the document to a file, and then prints the file to the console:"},{"content":"This example produces the following output:","pos":[1650,1693]},{"pos":[1814,1852],"content":"Serializing without an XML Declaration","linkify":"Serializing without an XML Declaration","nodes":[{"content":"Serializing without an XML Declaration","pos":[0,38]}]},{"content":"The following example shows how to save an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> to an <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter&gt;</ph>.","pos":[1856,1965],"source":"The following example shows how to save an <xref:System.Xml.Linq.XElement> to an <xref:System.Xml.XmlWriter>."},{"content":"This example produces the following output:","pos":[2347,2390]},{"pos":[2461,2469],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2473,2594],"content":"<bpt id=\"p1\">[</bpt>Serializing XML Trees (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/serializing-xml-trees.md)</ept>","source":"[Serializing XML Trees (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/serializing-xml-trees.md)"}]}