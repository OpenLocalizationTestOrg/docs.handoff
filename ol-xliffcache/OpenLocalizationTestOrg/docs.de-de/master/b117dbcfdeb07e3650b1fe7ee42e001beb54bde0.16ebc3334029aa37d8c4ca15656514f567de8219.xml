{"content":"---\ntitle: \"Using Multiple Authentication Schemes with WCF | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: f32a56a0-e2b2-46bf-a302-29e1275917f9\ncaps.latest.revision: 4\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Using Multiple Authentication Schemes with WCF\nWCF now allows you to specify multiple authentication schemes on a single endpoint. Furthermore web hosted services can inherit their authentication settings directly from IIS. Self-hosted services can specify what authentication schemes can be used. For more information about setting authentication settings in IIS, see [IIS Authentication](http://go.microsoft.com/fwlink/?LinkId=232458)  \n  \n## IIS-Hosted Services  \n For IIS-hosted services, set the authentication schemes you wish to use in IIS. Then in your service’s web.config file, in your binding configuration specify clientCredential type as \"InheritedFromHost\" as shown in the following XML snippet:  \n  \n```xml  \n<bindings>  \n      <basicHttpBinding>  \n        <binding name=\"secureBinding\">  \n          <security mode=\"Transport\">  \n            <transport clientCredentialType=\"InheritedFromHost\" />  \n          </security>  \n        </binding>  \n      </basicHttpBinding>  \n    </bindings>  \n```  \n  \n You can specify that you only want a subset of authentication schemes to be used with your service using the ServiceAuthenticationBehavior or the \\<serviceAuthenticationManager> element. When configuring this in code use the ServiceAuthenticationBehavior as shown in the following code snippet.  \n  \n```csharp  \n// ...  \nServiceAuthenticationBehavior sab = null;  \nsab = serviceHost.Description.Behaviors.Find<ServiceAuthenticationBehavior>();  \n  \nif (sab == null)  \n{  \n    sab = new ServiceAuthenticationBehavior();  \n    sab.AuthenticationSchemes = AuthenticationSchemes.Basic | AuthenticationSchemes.Negotiate | AuthenticationSchemes.Digest;  \n    serviceHost.Description.Behaviors.Add(sab);  \n}  \nelse  \n{  \n     sab.AuthenticationSchemes = AuthenticationSchemes.Basic | AuthenticationSchemes.Negotiate | AuthenticationSchemes.Digest;  \n}  \n// ...  \n  \n```  \n  \n When configuring this in a config file, use the \\<serviceAuthenticationManager> element as shown in the following XML snippet.  \n  \n```xml  \n<behaviors>  \n      <serviceBehaviors>  \n        <behavior name=\"limitedAuthBehavior\">  \n          <serviceAuthenticationManager authenticationSchemes=\"Negotiate, Digest, Basic\"/>  \n          <!-- ... -->  \n        </behavior>  \n      </serviceBehaviors>  \n    </behaviors>  \n```  \n  \n This will ensure that only a subset of the authentication schemes listed here will be considered for applying on the service endpoint, depending on what is selected in the IIS. This means that a developer can exclude say Basic auth from the list by omitting it from the serviceAuthenticationManager listing and even if it is enabled in IIS, it will not be applied on the service endpoint  \n  \n## Self-Hosted Services  \n Self-hosted services are configured a bit differently since there is no IIS to inherit settings from. Here you use the \\<serviceAuthenticationManager> element or ServiceAuthenticationBehavior to specify the authentication settings that will be inherited. In code it looks like this:  \n  \n```csharp  \n// ...  \nServiceAuthenticationBehavior sab = null;  \nsab = serviceHost.Description.Behaviors.Find<ServiceAuthenticationBehavior>();  \n  \nif (sab == null)  \n{  \n    sab = new ServiceAuthenticationBehavior();  \n    sab.AuthenticationSchemes = AuthenticationSchemes.Basic | AuthenticationSchemes.Negotiate | AuthenticationSchemes.Digest;  \n    serviceHost.Description.Behaviors.Add(sab);  \n}  \nelse  \n{  \n     sab.AuthenticationSchemes = AuthenticationSchemes.Basic | AuthenticationSchemes.Negotiate | AuthenticationSchemes.Digest;  \n}  \n// ...  \n  \n```  \n  \n In config, it looks like this:  \n  \n```xml  \n<behaviors>  \n      <serviceBehaviors>  \n        <behavior name=\"limitedAuthBehavior\">  \n          <serviceAuthenticationManager authenticationSchemes=\"Negotiate, Digest, Basic\"/>  \n          <!-- ... -->  \n        </behavior>  \n      </serviceBehaviors>  \n    </behaviors>  \n```  \n  \n And then you can specify InheritFromHost in your binding settings as shown in the following XML snippet.  \n  \n```xml  \n<bindings>  \n      <basicHttpBinding>  \n        <binding name=\"secureBinding\">  \n          <security mode=\"Transport\">  \n            <transport clientCredentialType=\"InheritedFromHost\" />  \n          </security>  \n        </binding>  \n      </basicHttpBinding>  \n    </bindings>  \n```  \n  \n Alternatively, you can specify the authentication schemes in a custom binding, by setting the authentication schemes on the HTTP transport binding element, as shown in the following config snippet.  \n  \n```xml  \n<binding name=\"multipleBinding\">  \n      <textMessageEncoding/>  \n      <httpTransport authenticationScheme=\"Negotiate, Ntlm, Digest, Basic\" />  \n    </binding>  \n  \n```  \n  \n## See Also  \n [Bindings and Security](../../../../docs/framework/wcf/feature-details/bindings-and-security.md)   \n [Endpoints: Addresses, Bindings, and Contracts](../../../../docs/framework/wcf/feature-details/endpoints-addresses-bindings-and-contracts.md)   \n [Configuring System-Provided Bindings](../../../../docs/framework/wcf/feature-details/configuring-system-provided-bindings.md)   \n [Security Capabilities with Custom Bindings](../../../../docs/framework/wcf/feature-details/security-capabilities-with-custom-bindings.md)   \n [Bindings](../../../../docs/framework/wcf/feature-details/bindings.md)   \n [Bindings](../../../../docs/framework/wcf/feature-details/bindings.md)   \n [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md)\n","nodes":[{"pos":[4,366],"nodes":[{"content":"Using Multiple Authentication Schemes with WCF | Microsoft Docs","nodes":[{"pos":[0,63],"content":"Using Multiple Authentication Schemes with WCF | Microsoft Docs","nodes":[{"content":"Using Multiple Authentication Schemes with WCF | Microsoft Docs","pos":[0,63]}]}],"pos":[6,72],"yaml":true}],"content":"title: \"Using Multiple Authentication Schemes with WCF | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: f32a56a0-e2b2-46bf-a302-29e1275917f9\ncaps.latest.revision: 4\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","yamlblock":true},{"pos":[373,419],"content":"Using Multiple Authentication Schemes with WCF","linkify":"Using Multiple Authentication Schemes with WCF","nodes":[{"content":"Using Multiple Authentication Schemes with WCF","pos":[0,46]}]},{"content":"WCF now allows you to specify multiple authentication schemes on a single endpoint.","pos":[420,503]},{"content":"Furthermore web hosted services can inherit their authentication settings directly from IIS.","pos":[504,596]},{"content":"Self-hosted services can specify what authentication schemes can be used.","pos":[597,670]},{"content":"For more information about setting authentication settings in IIS, see <bpt id=\"p1\">[</bpt>IIS Authentication<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=232458)</ept>","pos":[671,809],"source":" For more information about setting authentication settings in IIS, see [IIS Authentication](http://go.microsoft.com/fwlink/?LinkId=232458)"},{"pos":[818,837],"content":"IIS-Hosted Services","linkify":"IIS-Hosted Services","nodes":[{"content":"IIS-Hosted Services","pos":[0,19]}]},{"content":"For IIS-hosted services, set the authentication schemes you wish to use in IIS.","pos":[841,920]},{"content":"Then in your service’s web.config file, in your binding configuration specify clientCredential type as \"InheritedFromHost\" as shown in the following XML snippet:","pos":[921,1082]},{"content":"You can specify that you only want a subset of authentication schemes to be used with your service using the ServiceAuthenticationBehavior or the <ph id=\"ph1\">\\&lt;</ph>serviceAuthenticationManager&gt; element.","pos":[1388,1574],"source":"You can specify that you only want a subset of authentication schemes to be used with your service using the ServiceAuthenticationBehavior or the \\<serviceAuthenticationManager> element."},{"content":"When configuring this in code use the ServiceAuthenticationBehavior as shown in the following code snippet.","pos":[1575,1682]},{"content":"When configuring this in a config file, use the <ph id=\"ph1\">\\&lt;</ph>serviceAuthenticationManager&gt; element as shown in the following XML snippet.","pos":[2257,2383],"source":"When configuring this in a config file, use the \\<serviceAuthenticationManager> element as shown in the following XML snippet."},{"content":"This will ensure that only a subset of the authentication schemes listed here will be considered for applying on the service endpoint, depending on what is selected in the IIS.","pos":[2684,2860]},{"content":"This means that a developer can exclude say Basic auth from the list by omitting it from the serviceAuthenticationManager listing and even if it is enabled in IIS, it will not be applied on the service endpoint","pos":[2861,3071]},{"pos":[3080,3100],"content":"Self-Hosted Services","linkify":"Self-Hosted Services","nodes":[{"content":"Self-Hosted Services","pos":[0,20]}]},{"content":"Self-hosted services are configured a bit differently since there is no IIS to inherit settings from.","pos":[3104,3205]},{"content":"Here you use the <ph id=\"ph1\">\\&lt;</ph>serviceAuthenticationManager&gt; element or ServiceAuthenticationBehavior to specify the authentication settings that will be inherited.","pos":[3206,3358],"source":" Here you use the \\<serviceAuthenticationManager> element or ServiceAuthenticationBehavior to specify the authentication settings that will be inherited."},{"content":"In code it looks like this:","pos":[3359,3386]},{"content":"In config, it looks like this:","pos":[3961,3991]},{"content":"And then you can specify InheritFromHost in your binding settings as shown in the following XML snippet.","pos":[4292,4396]},{"content":"Alternatively, you can specify the authentication schemes in a custom binding, by setting the authentication schemes on the HTTP transport binding element, as shown in the following config snippet.","pos":[4702,4899]},{"pos":[5092,5100],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Bindings and Security<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/bindings-and-security.md)</ept><ph id=\"ph1\"> </ph>","pos":[5104,5201],"source":"[Bindings and Security](../../../../docs/framework/wcf/feature-details/bindings-and-security.md) "},{"content":"<bpt id=\"p1\">[</bpt>Endpoints: Addresses, Bindings, and Contracts<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/endpoints-addresses-bindings-and-contracts.md)</ept><ph id=\"ph1\"> </ph>","pos":[5205,5347],"source":"[Endpoints: Addresses, Bindings, and Contracts](../../../../docs/framework/wcf/feature-details/endpoints-addresses-bindings-and-contracts.md) "},{"content":"<bpt id=\"p1\">[</bpt>Configuring System-Provided Bindings<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/configuring-system-provided-bindings.md)</ept><ph id=\"ph1\"> </ph>","pos":[5351,5478],"source":"[Configuring System-Provided Bindings](../../../../docs/framework/wcf/feature-details/configuring-system-provided-bindings.md) "},{"content":"<bpt id=\"p1\">[</bpt>Security Capabilities with Custom Bindings<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/security-capabilities-with-custom-bindings.md)</ept><ph id=\"ph1\"> </ph>","pos":[5482,5621],"source":"[Security Capabilities with Custom Bindings](../../../../docs/framework/wcf/feature-details/security-capabilities-with-custom-bindings.md) "},{"content":"<bpt id=\"p1\">[</bpt>Bindings<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/bindings.md)</ept><ph id=\"ph1\"> </ph>","pos":[5625,5696],"source":"[Bindings](../../../../docs/framework/wcf/feature-details/bindings.md) "},{"content":"<bpt id=\"p1\">[</bpt>Bindings<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/bindings.md)</ept><ph id=\"ph1\"> </ph>","pos":[5700,5771],"source":"[Bindings](../../../../docs/framework/wcf/feature-details/bindings.md) "},{"content":"<bpt id=\"p1\">[</bpt>Custom Bindings<ept id=\"p1\">](../../../../docs/framework/wcf/extending/custom-bindings.md)</ept>","pos":[5775,5853],"source":"[Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md)"}]}