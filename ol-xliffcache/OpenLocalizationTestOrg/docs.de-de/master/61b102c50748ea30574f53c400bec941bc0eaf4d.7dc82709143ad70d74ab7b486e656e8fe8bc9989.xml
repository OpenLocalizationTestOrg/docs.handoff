{"content":"---\ntitle: \"Implementing the UI Automation Window Control Pattern | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"control patterns, Window\"\n  - \"UI Automation, Window control pattern\"\n  - \"Window control pattern\"\nms.assetid: a28cb286-296e-4a62-b4cb-55ad636ebccc\ncaps.latest.revision: 21\nauthor: \"Xansky\"\nms.author: \"mhopkins\"\nmanager: \"markl\"\n---\n# Implementing the UI Automation Window Control Pattern\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IWindowProvider>, including information about <xref:System.Windows.Automation.WindowPattern> properties, methods, and events. Links to additional references are listed at the end of the topic.  \n  \n The <xref:System.Windows.Automation.WindowPattern> control pattern is used to support controls that provide fundamental window-based functionality within a traditional [!INCLUDE[TLA#tla_gui](../../../includes/tlasharptla-gui-md.md)]. Examples of controls that must implement this control pattern include top-level application windows, [!INCLUDE[TLA#tla_mdi](../../../includes/tlasharptla-mdi-md.md)] child windows, resizable split pane controls, modal dialogs and balloon help windows.  \n  \n<a name=\"Implementation_Guidelines_and_Conventions\"></a>   \n## Implementation Guidelines and Conventions  \n When implementing the Window control pattern, note the following guidelines and conventions:  \n  \n-   To support the ability to modify both window size and screen position using UI Automation, a control must implement <xref:System.Windows.Automation.Provider.ITransformProvider> in addition to <xref:System.Windows.Automation.Provider.IWindowProvider>.  \n  \n-   Controls that contain title bars and title bar elements that enable the control to be moved, resized, maximized, minimized, or closed are typically required to implement <xref:System.Windows.Automation.Provider.IWindowProvider>.  \n  \n-   Controls such as tooltip pop-ups and combo box or menu drop-downs do not typically implement <xref:System.Windows.Automation.Provider.IWindowProvider>.  \n  \n-   Balloon help windows are differentiated from basic tooltip pop-ups by the provision of a window-like Close button.  \n  \n-   Full-screen mode is not supported by IWindowProvider as it is feature-specific to an application and is not typical window behavior.  \n  \n<a name=\"Required_Members_for_IWindowProvider\"></a>   \n## Required Members for IWindowProvider  \n The following properties, methods, and events are required for the IWindowProvider interface.  \n  \n|Required member|Member type|Notes|  \n|---------------------|-----------------|-----------|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.InteractionState%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.IsModal%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.IsTopmost%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.Maximizable%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.Minimizable%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.VisualState%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.Close%2A>|Method|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.SetVisualState%2A>|Method|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.WaitForInputIdle%2A>|Method|None|  \n|<xref:System.Windows.Automation.WindowPattern.WindowClosedEvent>|Event|None|  \n|<xref:System.Windows.Automation.WindowPattern.WindowOpenedEvent>|Event|None|  \n|<xref:System.Windows.Automation.WindowInteractionState>|Event|Is not guaranteed to be <xref:System.Windows.Automation.WindowInteractionState>|  \n  \n<a name=\"Exceptions\"></a>   \n## Exceptions  \n Providers must throw the following exceptions.  \n  \n|Exception type|Condition|  \n|--------------------|---------------|  \n|<xref:System.InvalidOperationException>|<xref:System.Windows.Automation.Provider.IWindowProvider.SetVisualState%2A><br /><br /> -   When a control does not support a requested behavior.|  \n|<xref:System.ArgumentOutOfRangeException>|<xref:System.Windows.Automation.Provider.IWindowProvider.WaitForInputIdle%2A><br /><br /> -   When the parameter is not a valid number.|  \n  \n## See Also  \n [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)   \n [Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)   \n [UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)   \n [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)   \n [Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)","nodes":[{"pos":[4,501],"nodes":[{"content":"Implementing the UI Automation Window Control Pattern | Microsoft Docs","nodes":[{"pos":[0,70],"content":"Implementing the UI Automation Window Control Pattern | Microsoft Docs","nodes":[{"content":"Implementing the UI Automation Window Control Pattern | Microsoft Docs","pos":[0,70]}]}],"pos":[6,79],"yaml":true}],"content":"title: \"Implementing the UI Automation Window Control Pattern | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"control patterns, Window\"\n  - \"UI Automation, Window control pattern\"\n  - \"Window control pattern\"\nms.assetid: a28cb286-296e-4a62-b4cb-55ad636ebccc\ncaps.latest.revision: 21\nauthor: \"Xansky\"\nms.author: \"mhopkins\"\nmanager: \"markl\"","yamlblock":true},{"pos":[508,561],"content":"Implementing the UI Automation Window Control Pattern","linkify":"Implementing the UI Automation Window Control Pattern","nodes":[{"content":"Implementing the UI Automation Window Control Pattern","pos":[0,53]}]},{"pos":[564,1026],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,460],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,451],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"content":"This topic introduces guidelines and conventions for implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IWindowProvider&gt;</ph>, including information about <ph id=\"ph2\">&lt;xref:System.Windows.Automation.WindowPattern&gt;</ph> properties, methods, and events.","pos":[1033,1265],"source":"This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IWindowProvider>, including information about <xref:System.Windows.Automation.WindowPattern> properties, methods, and events."},{"content":"Links to additional references are listed at the end of the topic.","pos":[1266,1332]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Automation.WindowPattern&gt;</ph> control pattern is used to support controls that provide fundamental window-based functionality within a traditional <ph id=\"ph2\">[!INCLUDE[TLA#tla_gui](../../../includes/tlasharptla-gui-md.md)]</ph>.","pos":[1339,1572],"source":"The <xref:System.Windows.Automation.WindowPattern> control pattern is used to support controls that provide fundamental window-based functionality within a traditional [!INCLUDE[TLA#tla_gui](../../../includes/tlasharptla-gui-md.md)]."},{"content":"Examples of controls that must implement this control pattern include top-level application windows, <ph id=\"ph1\">[!INCLUDE[TLA#tla_mdi](../../../includes/tlasharptla-mdi-md.md)]</ph> child windows, resizable split pane controls, modal dialogs and balloon help windows.","pos":[1573,1824],"source":" Examples of controls that must implement this control pattern include top-level application windows, [!INCLUDE[TLA#tla_mdi](../../../includes/tlasharptla-mdi-md.md)] child windows, resizable split pane controls, modal dialogs and balloon help windows."},{"pos":[1893,1934],"content":"Implementation Guidelines and Conventions","linkify":"Implementation Guidelines and Conventions","nodes":[{"content":"Implementation Guidelines and Conventions","pos":[0,41]}]},{"content":"When implementing the Window control pattern, note the following guidelines and conventions:","pos":[1938,2030]},{"content":"To support the ability to modify both window size and screen position using UI Automation, a control must implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ITransformProvider&gt;</ph> in addition to <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.IWindowProvider&gt;</ph>.","pos":[2040,2290],"source":"To support the ability to modify both window size and screen position using UI Automation, a control must implement <xref:System.Windows.Automation.Provider.ITransformProvider> in addition to <xref:System.Windows.Automation.Provider.IWindowProvider>."},{"content":"Controls that contain title bars and title bar elements that enable the control to be moved, resized, maximized, minimized, or closed are typically required to implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IWindowProvider&gt;</ph>.","pos":[2300,2528],"source":"Controls that contain title bars and title bar elements that enable the control to be moved, resized, maximized, minimized, or closed are typically required to implement <xref:System.Windows.Automation.Provider.IWindowProvider>."},{"content":"Controls such as tooltip pop-ups and combo box or menu drop-downs do not typically implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IWindowProvider&gt;</ph>.","pos":[2538,2689],"source":"Controls such as tooltip pop-ups and combo box or menu drop-downs do not typically implement <xref:System.Windows.Automation.Provider.IWindowProvider>."},{"content":"Balloon help windows are differentiated from basic tooltip pop-ups by the provision of a window-like Close button.","pos":[2699,2813]},{"content":"Full-screen mode is not supported by IWindowProvider as it is feature-specific to an application and is not typical window behavior.","pos":[2823,2955]},{"pos":[3019,3055],"content":"Required Members for IWindowProvider","linkify":"Required Members for IWindowProvider","nodes":[{"content":"Required Members for IWindowProvider","pos":[0,36]}]},{"content":"The following properties, methods, and events are required for the IWindowProvider interface.","pos":[3059,3152]},{"content":"Required member","pos":[3159,3174]},{"content":"Member type","pos":[3175,3186]},{"content":"Notes","pos":[3187,3192]},{"content":"Property","pos":[3331,3339]},{"content":"None","pos":[3340,3344]},{"content":"Property","pos":[3418,3426]},{"content":"None","pos":[3427,3431]},{"content":"Property","pos":[3507,3515]},{"content":"None","pos":[3516,3520]},{"content":"Property","pos":[3598,3606]},{"content":"None","pos":[3607,3611]},{"content":"Property","pos":[3689,3697]},{"content":"None","pos":[3698,3702]},{"content":"Property","pos":[3780,3788]},{"content":"None","pos":[3789,3793]},{"content":"Method","pos":[3865,3871]},{"content":"None","pos":[3872,3876]},{"content":"Method","pos":[3957,3963]},{"content":"None","pos":[3964,3968]},{"content":"Method","pos":[4051,4057]},{"content":"None","pos":[4058,4062]},{"content":"Event","pos":[4132,4137]},{"content":"None","pos":[4138,4142]},{"content":"Event","pos":[4212,4217]},{"content":"None","pos":[4218,4222]},{"content":"Event","pos":[4283,4288]},{"content":"Is not guaranteed to be <ph id=\"ph1\">&lt;xref:System.Windows.Automation.WindowInteractionState&gt;</ph>","pos":[4289,4368],"source":"Is not guaranteed to be <xref:System.Windows.Automation.WindowInteractionState>"},{"pos":[4407,4417],"content":"Exceptions","linkify":"Exceptions","nodes":[{"content":"Exceptions","pos":[0,10]}]},{"content":"Providers must throw the following exceptions.","pos":[4421,4467]},{"content":"Exception type","pos":[4474,4488]},{"content":"Condition","pos":[4489,4498]},{"content":"-   When a control does not support a requested behavior.","pos":[4672,4729]},{"content":"-   When the parameter is not a valid number.","pos":[4866,4911]},{"pos":[4921,4929],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[4933,5057],"source":"[UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md) "},{"content":"<bpt id=\"p1\">[</bpt>Support Control Patterns in a UI Automation Provider<ept id=\"p1\">](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)</ept><ph id=\"ph1\"> </ph>","pos":[5061,5211],"source":"[Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md) "},{"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns for Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)</ept><ph id=\"ph1\"> </ph>","pos":[5215,5345],"source":"[UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md) "},{"content":"<bpt id=\"p1\">[</bpt>UI Automation Tree Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[5349,5449],"source":"[UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md) "},{"content":"<bpt id=\"p1\">[</bpt>Use Caching in UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)</ept>","pos":[5453,5554],"source":"[Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)"}]}