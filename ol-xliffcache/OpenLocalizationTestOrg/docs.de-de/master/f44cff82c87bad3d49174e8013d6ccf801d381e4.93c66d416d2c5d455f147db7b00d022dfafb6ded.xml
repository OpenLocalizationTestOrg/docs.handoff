{"content":"---\ntitle: \"Discover a Service with Unique Listen Uri Mode Sample | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 9a6d35b2-0469-43c8-a0c9-63623e3d2733\ncaps.latest.revision: 8\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Discover a Service with Unique Listen Uri Mode Sample\nThis sample demonstrates how to discover a service that has the <xref:System.ServiceModel.Channels.BindingContext.ListenUriMode%2A> property set to <xref:System.ServiceModel.Description.ListenUriMode>. When the <xref:System.ServiceModel.Channels.BindingContext.ListenUriMode%2A> property is set to <xref:System.ServiceModel.Description.ListenUriMode>, the ListenUri is ensured to be unique by either setting the port to be unique or for the path to be unique by appending a GUID.  \n  \n### Features on the Service  \n The <xref:System.ServiceModel.Channels.BindingContext.ListenUriMode%2A> property is set to <xref:System.ServiceModel.Description.ListenUriMode> for the TCP endpoint. The service is then made discoverable over a <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint> endpoint.  \n  \n### Features on the Client  \n This client connects to the service using the correct `Via.Uri` by using the <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> method. The <xref:System.ServiceModel.Discovery.FindResponse> that is returned from the method is then queried for whether it contains a valid <xref:System.ServiceModel.Endpoint.ListenUri%2A> and whether it is different than `Address.Uri`. The appropriate information is then passed to the `InvokeCalculatorService` method. In the `InvokeCalculatorService` method, the <xref:System.ServiceModel.Endpoint.ListenUri%2A> was passed in by the caller, then a `ClientViaBehavior` with the correct `Via.Uri` is added to the client’s endpoint.  \n  \n##### To use this sample  \n  \n1.  Using [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], open UniqueListenUriMode.sln.  \n  \n2.  To build the solution, press CTRL+SHIFT+B.  \n  \n3.  Run the service application, which is generated in the [solution base directory]\\service\\bin\\debug folder.  \n  \n4.  Run the client application, which is generated in the [solution base directory]\\Client\\bin\\debug folder.  \n  \n     The client locates the running service and writes to the console the metadata published by the service’s endpoint.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\Discovery\\UniqueListenUriMode`  \n  \n## See Also","nodes":[{"pos":[12,82],"content":"Discover a Service with Unique Listen Uri Mode Sample | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Discover a Service with Unique Listen Uri Mode Sample | Microsoft Docs","pos":[0,70]}]},{"pos":[380,433],"content":"Discover a Service with Unique Listen Uri Mode Sample","linkify":"Discover a Service with Unique Listen Uri Mode Sample","nodes":[{"content":"Discover a Service with Unique Listen Uri Mode Sample","pos":[0,53]}]},{"content":"This sample demonstrates how to discover a service that has the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.BindingContext.ListenUriMode%2A&gt;</ph> property set to <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.ListenUriMode&gt;</ph>.","pos":[434,635],"source":"This sample demonstrates how to discover a service that has the <xref:System.ServiceModel.Channels.BindingContext.ListenUriMode%2A> property set to <xref:System.ServiceModel.Description.ListenUriMode>."},{"content":"When the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.BindingContext.ListenUriMode%2A&gt;</ph> property is set to <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.ListenUriMode&gt;</ph>, the ListenUri is ensured to be unique by either setting the port to be unique or for the path to be unique by appending a GUID.","pos":[636,913],"source":" When the <xref:System.ServiceModel.Channels.BindingContext.ListenUriMode%2A> property is set to <xref:System.ServiceModel.Description.ListenUriMode>, the ListenUri is ensured to be unique by either setting the port to be unique or for the path to be unique by appending a GUID."},{"pos":[923,946],"content":"Features on the Service","linkify":"Features on the Service","nodes":[{"content":"Features on the Service","pos":[0,23]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.BindingContext.ListenUriMode%2A&gt;</ph> property is set to <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.ListenUriMode&gt;</ph> for the TCP endpoint.","pos":[950,1115],"source":"The <xref:System.ServiceModel.Channels.BindingContext.ListenUriMode%2A> property is set to <xref:System.ServiceModel.Description.ListenUriMode> for the TCP endpoint."},{"content":"The service is then made discoverable over a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint&gt;</ph> endpoint.","pos":[1116,1228],"source":" The service is then made discoverable over a <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint> endpoint."},{"pos":[1238,1260],"content":"Features on the Client","linkify":"Features on the Client","nodes":[{"content":"Features on the Client","pos":[0,22]}]},{"content":"This client connects to the service using the correct <ph id=\"ph1\">`Via.Uri`</ph> by using the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A&gt;</ph> method.","pos":[1264,1409],"source":"This client connects to the service using the correct `Via.Uri` by using the <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> method."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindResponse&gt;</ph> that is returned from the method is then queried for whether it contains a valid <ph id=\"ph2\">&lt;xref:System.ServiceModel.Endpoint.ListenUri%2A&gt;</ph> and whether it is different than <ph id=\"ph3\">`Address.Uri`</ph>.","pos":[1410,1641],"source":" The <xref:System.ServiceModel.Discovery.FindResponse> that is returned from the method is then queried for whether it contains a valid <xref:System.ServiceModel.Endpoint.ListenUri%2A> and whether it is different than `Address.Uri`."},{"content":"The appropriate information is then passed to the <ph id=\"ph1\">`InvokeCalculatorService`</ph> method.","pos":[1642,1725],"source":" The appropriate information is then passed to the `InvokeCalculatorService` method."},{"content":"In the <ph id=\"ph1\">`InvokeCalculatorService`</ph> method, the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Endpoint.ListenUri%2A&gt;</ph> was passed in by the caller, then a <ph id=\"ph3\">`ClientViaBehavior`</ph> with the correct <ph id=\"ph4\">`Via.Uri`</ph> is added to the client’s endpoint.","pos":[1726,1937],"source":" In the `InvokeCalculatorService` method, the <xref:System.ServiceModel.Endpoint.ListenUri%2A> was passed in by the caller, then a `ClientViaBehavior` with the correct `Via.Uri` is added to the client’s endpoint."},{"pos":[1949,1967],"content":"To use this sample","linkify":"To use this sample","nodes":[{"content":"To use this sample","pos":[0,18]}]},{"pos":[1977,2085],"content":"Using <ph id=\"ph1\">[!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)]</ph>, open UniqueListenUriMode.sln.","source":"Using [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], open UniqueListenUriMode.sln."},{"content":"To build the solution, press CTRL+SHIFT+B.","pos":[2095,2137]},{"content":"Run the service application, which is generated in the [solution base directory]\\service\\bin\\debug folder.","pos":[2147,2253]},{"content":"Run the client application, which is generated in the [solution base directory]\\Client\\bin\\debug folder.","pos":[2263,2367]},{"content":"The client locates the running service and writes to the console the metadata published by the service’s endpoint.","pos":[2378,2492]},{"pos":[2500,2632],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[2686,3012],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[3013,3063]},{"pos":[3155,3163],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]}]}