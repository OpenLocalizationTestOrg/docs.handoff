{"content":"---\ntitle: \"Troubleshooting Arrays (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"troubleshooting arrays\"\n  - \"arrays [Visual Basic], initialization errors\"\n  - \"troubleshooting Visual Basic, arrays\"\n  - \"arrays [Visual Basic], compilation errors\"\n  - \"arrays [Visual Basic], declaration errors\"\n  - \"arrays [Visual Basic], troubleshooting\"\nms.assetid: f4e971c7-c0a4-4ed7-a77a-8d71039f266f\ncaps.latest.revision: 17\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Troubleshooting Arrays (Visual Basic)\nThis page lists some common problems that can occur when working with arrays.  \n  \n## Compilation Errors Declaring and Initializing an Array  \n Compilation errors can arise from misunderstanding of the rules for declaring, creating, and initializing arrays. The most common causes of errors are the following:  \n  \n-   Supplying a [New Operator](../../../../visual-basic/language-reference/operators/new-operator.md) clause after specifying dimension lengths in the array variable declaration. The following code lines show invalid declarations of this type.  \n  \n     `Dim INVALIDsingleDimByteArray(2) As Byte = New Byte()`  \n  \n     `Dim INVALIDtwoDimShortArray(1, 1) As Short = New Short(,)`  \n  \n     `Dim INVALIDjaggedByteArray(1)() As Byte = New Byte()()`  \n  \n-   Specifying dimension lengths for more than the top-level array of a jagged array. The following code line shows an invalid declaration of this type.  \n  \n     `Dim INVALIDjaggedByteArray(1)(1) As Byte`  \n  \n-   Omitting the `New` keyword when specifying the element values. The following code line shows an invalid declaration of this type.  \n  \n     `Dim INVALIDoneDimShortArray() As Short = Short() {0, 1, 2, 3}`  \n  \n-   Supplying a `New` clause without braces (`{}`). The following code lines show invalid declarations of this type.  \n  \n     `Dim INVALIDsingleDimByteArray() As Byte = New Byte()`  \n  \n     `Dim INVALIDsingleDimByteArray() As Byte = New Byte(2)`  \n  \n     `Dim INVALIDtwoDimShortArray(,) As Short = New Short(,)`  \n  \n     `Dim INVALIDtwoDimShortArray(,) As Short = New Short(1, 1)`  \n  \n## Accessing an Array Out of Bounds  \n The process of initializing an array assigns an upper bound and a lower bound to each dimension. Every access to an element of the array must specify a valid index, or subscript, for every dimension. If any index is below its lower bound or above its upper bound, an <xref:System.IndexOutOfRangeException> exception results. The compiler cannot detect such an error, so an error occurs at run time.  \n  \n### Determining Bounds  \n If another component passes an array to your code, for example as a procedure argument, you do not know the size of that array or the lengths of its dimensions. You should always determine the upper bound for every dimension of an array before you attempt to access any elements. If the array has been created by some means other than a [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] `New` clause, the lower bound might be something other than 0, and it is safest to determine that lower bound as well.  \n  \n### Specifying the Dimension  \n When determining the bounds of a multidimensional array, take care how you specify the dimension. The `dimension` parameters of the <xref:System.Array.GetLowerBound%2A> and <xref:System.Array.GetUpperBound%2A> methods are 0-based, while the `Rank` parameters of the [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] <xref:Microsoft.VisualBasic.Information.LBound%2A> and <xref:Microsoft.VisualBasic.Information.UBound%2A> functions are 1-based.  \n  \n## See Also  \n [Arrays](../../../../visual-basic/programming-guide/language-features/arrays/index.md)   \n [How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)","nodes":[{"pos":[4,818],"nodes":[{"content":"Troubleshooting Arrays (Visual Basic) | Microsoft Docs","nodes":[{"pos":[0,54],"content":"Troubleshooting Arrays (Visual Basic) | Microsoft Docs","nodes":[{"content":"Troubleshooting Arrays (Visual Basic) | Microsoft Docs","pos":[0,54]}]}],"pos":[6,63],"yaml":true}],"content":"title: \"Troubleshooting Arrays (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"troubleshooting arrays\"\n  - \"arrays [Visual Basic], initialization errors\"\n  - \"troubleshooting Visual Basic, arrays\"\n  - \"arrays [Visual Basic], compilation errors\"\n  - \"arrays [Visual Basic], declaration errors\"\n  - \"arrays [Visual Basic], troubleshooting\"\nms.assetid: f4e971c7-c0a4-4ed7-a77a-8d71039f266f\ncaps.latest.revision: 17\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","yamlblock":true},{"pos":[825,862],"content":"Troubleshooting Arrays (Visual Basic)","linkify":"Troubleshooting Arrays (Visual Basic)","nodes":[{"content":"Troubleshooting Arrays (Visual Basic)","pos":[0,37]}]},{"content":"This page lists some common problems that can occur when working with arrays.","pos":[863,940]},{"pos":[949,1003],"content":"Compilation Errors Declaring and Initializing an Array","linkify":"Compilation Errors Declaring and Initializing an Array","nodes":[{"content":"Compilation Errors Declaring and Initializing an Array","pos":[0,54]}]},{"content":"Compilation errors can arise from misunderstanding of the rules for declaring, creating, and initializing arrays.","pos":[1007,1120]},{"content":"The most common causes of errors are the following:","pos":[1121,1172]},{"content":"Supplying a <bpt id=\"p1\">[</bpt>New Operator<ept id=\"p1\">](../../../../visual-basic/language-reference/operators/new-operator.md)</ept> clause after specifying dimension lengths in the array variable declaration.","pos":[1182,1356],"source":"Supplying a [New Operator](../../../../visual-basic/language-reference/operators/new-operator.md) clause after specifying dimension lengths in the array variable declaration."},{"content":"The following code lines show invalid declarations of this type.","pos":[1357,1421]},{"content":"Specifying dimension lengths for more than the top-level array of a jagged array.","pos":[1634,1715]},{"content":"The following code line shows an invalid declaration of this type.","pos":[1716,1782]},{"content":"Omitting the <ph id=\"ph1\">`New`</ph> keyword when specifying the element values.","pos":[1845,1907],"source":"Omitting the `New` keyword when specifying the element values."},{"content":"The following code line shows an invalid declaration of this type.","pos":[1908,1974]},{"content":"Supplying a <ph id=\"ph1\">`New`</ph> clause without braces (<ph id=\"ph2\">`{}`</ph>).","pos":[2058,2105],"source":"Supplying a `New` clause without braces (`{}`)."},{"content":"The following code lines show invalid declarations of this type.","pos":[2106,2170]},{"pos":[2447,2479],"content":"Accessing an Array Out of Bounds","linkify":"Accessing an Array Out of Bounds","nodes":[{"content":"Accessing an Array Out of Bounds","pos":[0,32]}]},{"content":"The process of initializing an array assigns an upper bound and a lower bound to each dimension.","pos":[2483,2579]},{"content":"Every access to an element of the array must specify a valid index, or subscript, for every dimension.","pos":[2580,2682]},{"content":"If any index is below its lower bound or above its upper bound, an <ph id=\"ph1\">&lt;xref:System.IndexOutOfRangeException&gt;</ph> exception results.","pos":[2683,2807],"source":" If any index is below its lower bound or above its upper bound, an <xref:System.IndexOutOfRangeException> exception results."},{"content":"The compiler cannot detect such an error, so an error occurs at run time.","pos":[2808,2881]},{"pos":[2891,2909],"content":"Determining Bounds","linkify":"Determining Bounds","nodes":[{"content":"Determining Bounds","pos":[0,18]}]},{"content":"If another component passes an array to your code, for example as a procedure argument, you do not know the size of that array or the lengths of its dimensions.","pos":[2913,3073]},{"content":"You should always determine the upper bound for every dimension of an array before you attempt to access any elements.","pos":[3074,3192]},{"content":"If the array has been created by some means other than a <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> <ph id=\"ph2\">`New`</ph> clause, the lower bound might be something other than 0, and it is safest to determine that lower bound as well.","pos":[3193,3461],"source":" If the array has been created by some means other than a [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] `New` clause, the lower bound might be something other than 0, and it is safest to determine that lower bound as well."},{"pos":[3471,3495],"content":"Specifying the Dimension","linkify":"Specifying the Dimension","nodes":[{"content":"Specifying the Dimension","pos":[0,24]}]},{"content":"When determining the bounds of a multidimensional array, take care how you specify the dimension.","pos":[3499,3596]},{"content":"The <ph id=\"ph1\">`dimension`</ph> parameters of the <ph id=\"ph2\">&lt;xref:System.Array.GetLowerBound%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Array.GetUpperBound%2A&gt;</ph> methods are 0-based, while the <ph id=\"ph4\">`Rank`</ph> parameters of the <ph id=\"ph5\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> <ph id=\"ph6\">&lt;xref:Microsoft.VisualBasic.Information.LBound%2A&gt;</ph> and <ph id=\"ph7\">&lt;xref:Microsoft.VisualBasic.Information.UBound%2A&gt;</ph> functions are 1-based.","pos":[3597,3986],"source":" The `dimension` parameters of the <xref:System.Array.GetLowerBound%2A> and <xref:System.Array.GetUpperBound%2A> methods are 0-based, while the `Rank` parameters of the [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] <xref:Microsoft.VisualBasic.Information.LBound%2A> and <xref:Microsoft.VisualBasic.Information.UBound%2A> functions are 1-based."},{"pos":[3995,4003],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Arrays<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[4007,4094],"source":"[Arrays](../../../../visual-basic/programming-guide/language-features/arrays/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Initialize an Array Variable in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)</ept>","pos":[4098,4260],"source":"[How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)"}]}