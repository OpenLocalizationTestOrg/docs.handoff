{"content":"---\ntitle: \"On Error Statement (Visual Basic) | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.OnError\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"Visual Basic code, control flow\"\n  - \"Resume Next statement\"\n  - \"errors [Visual Basic], trapping\"\n  - \"error handling, On Error statement\"\n  - \"Next statement, On Error\"\n  - \"control flow, branching\"\n  - \"Error keyword\"\n  - \"execution, conditional\"\n  - \"Resume statement, and On Error statement\"\n  - \"Error statement, and On Error statement\"\n  - \"GoTo statement, and On Error statement\"\n  - \"branching, on error\"\n  - \"conditional statements, On Error\"\n  - \"On Error statement, syntax\"\n  - \"On keyword\"\n  - \"run-time errors, handling\"\n  - \"On Error statement\"\nms.assetid: ff947930-fb84-40cf-bd66-1ea219561d5c\ncaps.latest.revision: 22\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# On Error Statement (Visual Basic)\nEnables an error-handling routine and specifies the location of the routine within a procedure; can also be used to disable an error-handling routine.  \n  \n Without an `On Error` statement, any run-time error that occurs is fatal: an error message is displayed, and execution stops.  \n  \n Whenever possible, we suggest you use structured exception handling in your code, rather than using unstructured exception handling and the `On Error` statement. For more information, see [Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md).  \n  \n> [!NOTE]\n>  The `Error` keyword is also used in the [Error Statement](../../../visual-basic/language-reference/statements/error-statement.md), which is supported for backward compatibility.  \n  \n## Syntax  \n  \n```  \nOn Error { GoTo [ line | 0 | -1 ] | Resume Next }  \n```  \n  \n## Parts  \n  \n|Term|Definition|  \n|---|---|  \n|`GoTo` `line`|Enables the error-handling routine that starts at the line specified in the required `line` argument. The `line` argument is any line label or line number. If a run-time error occurs, control branches to the specified line, making the error handler active. The specified line must be in the same procedure as the `On Error` statement, or a compile-time error will occur.|  \n|`GoTo` 0|Disables enabled error handler in the current procedure and resets it to `Nothing`.|  \n|`GoTo` -1|Disables enabled exception in the current procedure and resets it to `Nothing`.|  \n|`Resume Next`|Specifies that when a run-time error occurs, control goes to the statement immediately following the statement where the error occurred, and execution continues from that point. Use this form rather than `On Error GoTo` when accessing objects.|  \n  \n## Remarks  \n  \n> [!NOTE]\n>  We recommend that you use structured exception handling in your code whenever possible, rather than using unstructured exception handling and the `On Error` statement. For more information, see [Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md).  \n  \n An \"enabled\" error handler is one that is turned on by an `On Error` statement. An \"active\" error handler is an enabled handler that is in the process of handling an error.  \n  \n If an error occurs while an error handler is active (between the occurrence of the error and a `Resume`, `Exit Sub`, `Exit Function`, or `Exit Property` statement), the current procedure's error handler cannot handle the error. Control returns to the calling procedure.  \n  \n If the calling procedure has an enabled error handler, it is activated to handle the error. If the calling procedure's error handler is also active, control passes back through previous calling procedures until an enabled, but inactive, error handler is found. If no such error handler is found, the error is fatal at the point at which it actually occurred.  \n  \n Each time the error handler passes control back to a calling procedure, that procedure becomes the current procedure. Once an error is handled by an error handler in any procedure, execution resumes in the current procedure at the point designated by the `Resume` statement.  \n  \n> [!NOTE]\n>  An error-handling routine is not a `Sub` procedure or a `Function` procedure. It is a section of code marked by a line label or a line number.  \n  \n## Number Property  \n Error-handling routines rely on the value in the `Number` property of the `Err` object to determine the cause of the error. The routine should test or save relevant property values in the `Err` object before any other error can occur or before a procedure that might cause an error is called. The property values in the `Err` object reflect only the most recent error. The error message associated with `Err.Number` is contained in `Err.Description`.  \n  \n## Throw Statement  \n An error that is raised with the `Err.Raise` method sets the `Exception` property to a newly created instance of the <xref:System.Exception> class. In order to support the raising of exceptions of derived exception types, a `Throw` statement is supported in the language. This takes a single parameter that is the exception instance to be thrown. The following example shows how these features can be used with the existing exception handling support:  \n  \n [!code-vb[VbVbalrErrorHandling#17](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_1.vb)]  \n  \n Notice that the `On Error GoTo` statement traps all errors, regardless of the exception class.  \n  \n## On Error Resume Next  \n `On Error Resume Next` causes execution to continue with the statement immediately following the statement that caused the run-time error, or with the statement immediately following the most recent call out of the procedure containing the `On Error Resume Next` statement. This statement allows execution to continue despite a run-time error. You can place the error-handling routine where the error would occur rather than transferring control to another location within the procedure. An `On Error Resume Next` statement becomes inactive when another procedure is called, so you should execute an `On Error Resume Next` statement in each called routine if you want inline error handling within that routine.  \n  \n> [!NOTE]\n>  The `On Error Resume Next` construct may be preferable to `On Error GoTo` when handling errors generated during access to other objects. Checking `Err` after each interaction with an object removes ambiguity about which object was accessed by the code. You can be sure which object placed the error code in `Err.Number`, as well as which object originally generated the error (the object specified in `Err.Source`).  \n  \n## On Error GoTo 0  \n `On Error GoTo 0` disables error handling in the current procedure. It doesn't specify line 0 as the start of the error-handling code, even if the procedure contains a line numbered 0. Without an `On Error GoTo 0` statement, an error handler is automatically disabled when a procedure is exited.  \n  \n## On Error GoTo -1  \n `On Error GoTo -1` disables the exception in the current procedure. It does not specify line -1 as the start of the error-handling code, even if the procedure contains a line numbered -1. Without an `On Error GoTo -1` statement, an exception is automatically disabled when a procedure is exited.  \n  \n To prevent error-handling code from running when no error has occurred, place an `Exit Sub`, `Exit Function`, or `Exit Property` statement immediately before the error-handling routine, as in the following fragment:  \n  \n [!code-vb[VbVbalrErrorHandling#18](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_2.vb)]  \n  \n Here, the error-handling code follows the `Exit Sub` statement and precedes the `End Sub` statement to separate it from the procedure flow. You can place error-handling code anywhere in a procedure.  \n  \n## Untrapped Errors  \n Untrapped errors in objects are returned to the controlling application when the object is running as an executable file. Within the development environment, untrapped errors are returned to the controlling application only if the proper options are set. See your host application's documentation for a description of which options should be set during debugging, how to set them, and whether the host can create classes.  \n  \n If you create an object that accesses other objects, you should try to handle any unhandled errors they pass back. If you cannot, map the error codes in `Err.Number` to one of your own errors and then pass them back to the caller of your object. You should specify your error by adding your error code to the `VbObjectError` constant. For example, if your error code is 1052, assign it as follows:  \n  \n [!code-vb[VbVbalrErrorHandling#19](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_3.vb)]  \n  \n> [!CAUTION]\n>  System errors during calls to Windows dynamic-link libraries (DLLs) do not raise exceptions and cannot be trapped with Visual Basic error trapping. When calling DLL functions, you should check each return value for success or failure (according to the API specifications), and in the event of a failure, check the value in the `Err` object's `LastDLLError` property.  \n  \n## Example  \n This example first uses the `On Error GoTo` statement to specify the location of an error-handling routine within a procedure. In the example, an attempt to divide by zero generates error number 6. The error is handled in the error-handling routine, and control is then returned to the statement that caused the error. The `On Error GoTo 0` statement turns off error trapping. Then the `On Error Resume Next` statement is used to defer error trapping so that the context for the error generated by the next statement can be known for certain. Note that `Err.Clear` is used to clear the `Err` object's properties after the error is handled.  \n  \n [!code-vb[VbVbalrErrorHandling#20](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_4.vb)]  \n  \n## Requirements  \n **Namespace:** [Microsoft.VisualBasic](../../../visual-basic/language-reference/runtime-library-members.md)  \n  \n **Assembly:** Visual Basic Runtime Library (in Microsoft.VisualBasic.dll)  \n  \n## See Also  \n <xref:Microsoft.VisualBasic.Information.Err%2A>   \n <xref:Microsoft.VisualBasic.ErrObject.Number%2A>   \n <xref:Microsoft.VisualBasic.ErrObject.Description%2A>   \n <xref:Microsoft.VisualBasic.ErrObject.LastDllError%2A>   \n [End Statement](../../../visual-basic/language-reference/statements/end-statement.md)   \n [Exit Statement](../../../visual-basic/language-reference/statements/exit-statement.md)   \n [Resume Statement](../../../visual-basic/language-reference/statements/resume-statement.md)   \n [Error Messages](../../../visual-basic/language-reference/error-messages/index.md)   \n [Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)","nodes":[{"pos":[4,1133],"nodes":[{"content":"On Error Statement (Visual Basic) | Microsoft Docs","nodes":[{"pos":[0,50],"content":"On Error Statement (Visual Basic) | Microsoft Docs","nodes":[{"content":"On Error Statement (Visual Basic) | Microsoft Docs","pos":[0,50]}]}],"pos":[6,59],"yaml":true}],"content":"title: \"On Error Statement (Visual Basic) | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.OnError\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"Visual Basic code, control flow\"\n  - \"Resume Next statement\"\n  - \"errors [Visual Basic], trapping\"\n  - \"error handling, On Error statement\"\n  - \"Next statement, On Error\"\n  - \"control flow, branching\"\n  - \"Error keyword\"\n  - \"execution, conditional\"\n  - \"Resume statement, and On Error statement\"\n  - \"Error statement, and On Error statement\"\n  - \"GoTo statement, and On Error statement\"\n  - \"branching, on error\"\n  - \"conditional statements, On Error\"\n  - \"On Error statement, syntax\"\n  - \"On keyword\"\n  - \"run-time errors, handling\"\n  - \"On Error statement\"\nms.assetid: ff947930-fb84-40cf-bd66-1ea219561d5c\ncaps.latest.revision: 22\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","yamlblock":true},{"pos":[1140,1173],"content":"On Error Statement (Visual Basic)","linkify":"On Error Statement (Visual Basic)","nodes":[{"content":"On Error Statement (Visual Basic)","pos":[0,33]}]},{"content":"Enables an error-handling routine and specifies the location of the routine within a procedure; can also be used to disable an error-handling routine.","pos":[1174,1324]},{"pos":[1331,1456],"content":"Without an <ph id=\"ph1\">`On Error`</ph> statement, any run-time error that occurs is fatal: an error message is displayed, and execution stops.","source":"Without an `On Error` statement, any run-time error that occurs is fatal: an error message is displayed, and execution stops."},{"content":"Whenever possible, we suggest you use structured exception handling in your code, rather than using unstructured exception handling and the <ph id=\"ph1\">`On Error`</ph> statement.","pos":[1463,1624],"source":"Whenever possible, we suggest you use structured exception handling in your code, rather than using unstructured exception handling and the `On Error` statement."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Try...Catch...Finally Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)</ept>.","pos":[1625,1769],"source":" For more information, see [Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)."},{"pos":[1777,1965],"content":"[!NOTE]\n The `Error` keyword is also used in the [Error Statement](../../../visual-basic/language-reference/statements/error-statement.md), which is supported for backward compatibility.","leadings":["","> "],"nodes":[{"content":"The <ph id=\"ph1\">`Error`</ph> keyword is also used in the <bpt id=\"p1\">[</bpt>Error Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/error-statement.md)</ept>, which is supported for backward compatibility.","pos":[9,186],"source":"The `Error` keyword is also used in the [Error Statement](../../../visual-basic/language-reference/statements/error-statement.md), which is supported for backward compatibility."}]},{"pos":[1974,1980],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[2056,2061],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"content":"Term","pos":[2068,2072]},{"content":"Definition","pos":[2073,2083]},{"pos":[2100,2113],"content":"<ph id=\"ph1\">`GoTo`</ph> <ph id=\"ph2\">`line`</ph>","source":"`GoTo` `line`"},{"content":"Enables the error-handling routine that starts at the line specified in the required <ph id=\"ph1\">`line`</ph> argument.","pos":[2114,2215],"source":"Enables the error-handling routine that starts at the line specified in the required `line` argument."},{"content":"The <ph id=\"ph1\">`line`</ph> argument is any line label or line number.","pos":[2216,2269],"source":" The `line` argument is any line label or line number."},{"content":"If a run-time error occurs, control branches to the specified line, making the error handler active.","pos":[2270,2370]},{"content":"The specified line must be in the same procedure as the <ph id=\"ph1\">`On Error`</ph> statement, or a compile-time error will occur.","pos":[2371,2484],"source":" The specified line must be in the same procedure as the `On Error` statement, or a compile-time error will occur."},{"pos":[2489,2497],"content":"<ph id=\"ph1\">`GoTo`</ph> 0","source":"`GoTo` 0"},{"pos":[2498,2581],"content":"Disables enabled error handler in the current procedure and resets it to <ph id=\"ph1\">`Nothing`</ph>.","source":"Disables enabled error handler in the current procedure and resets it to `Nothing`."},{"pos":[2586,2595],"content":"<ph id=\"ph1\">`GoTo`</ph> -1","source":"`GoTo` -1"},{"pos":[2596,2675],"content":"Disables enabled exception in the current procedure and resets it to <ph id=\"ph1\">`Nothing`</ph>.","source":"Disables enabled exception in the current procedure and resets it to `Nothing`."},{"content":"Specifies that when a run-time error occurs, control goes to the statement immediately following the statement where the error occurred, and execution continues from that point.","pos":[2694,2871]},{"content":"Use this form rather than <ph id=\"ph1\">`On Error GoTo`</ph> when accessing objects.","pos":[2872,2937],"source":" Use this form rather than `On Error GoTo` when accessing objects."},{"pos":[2947,2954],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2962,3285],"content":"[!NOTE]\n We recommend that you use structured exception handling in your code whenever possible, rather than using unstructured exception handling and the `On Error` statement. For more information, see [Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md).","leadings":["","> "],"nodes":[{"content":"We recommend that you use structured exception handling in your code whenever possible, rather than using unstructured exception handling and the `On Error` statement. For more information, see [Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md).","pos":[9,321],"nodes":[{"content":"We recommend that you use structured exception handling in your code whenever possible, rather than using unstructured exception handling and the <ph id=\"ph1\">`On Error`</ph> statement.","pos":[0,167],"source":"We recommend that you use structured exception handling in your code whenever possible, rather than using unstructured exception handling and the `On Error` statement."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Try...Catch...Finally Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)</ept>.","pos":[168,312],"source":" For more information, see [Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)."}]}]},{"content":"An \"enabled\" error handler is one that is turned on by an <ph id=\"ph1\">`On Error`</ph> statement.","pos":[3292,3371],"source":"An \"enabled\" error handler is one that is turned on by an `On Error` statement."},{"content":"An \"active\" error handler is an enabled handler that is in the process of handling an error.","pos":[3372,3464]},{"content":"If an error occurs while an error handler is active (between the occurrence of the error and a <ph id=\"ph1\">`Resume`</ph>, <ph id=\"ph2\">`Exit Sub`</ph>, <ph id=\"ph3\">`Exit Function`</ph>, or <ph id=\"ph4\">`Exit Property`</ph> statement), the current procedure's error handler cannot handle the error.","pos":[3471,3698],"source":"If an error occurs while an error handler is active (between the occurrence of the error and a `Resume`, `Exit Sub`, `Exit Function`, or `Exit Property` statement), the current procedure's error handler cannot handle the error."},{"content":"Control returns to the calling procedure.","pos":[3699,3740]},{"content":"If the calling procedure has an enabled error handler, it is activated to handle the error.","pos":[3747,3838]},{"content":"If the calling procedure's error handler is also active, control passes back through previous calling procedures until an enabled, but inactive, error handler is found.","pos":[3839,4007]},{"content":"If no such error handler is found, the error is fatal at the point at which it actually occurred.","pos":[4008,4105]},{"content":"Each time the error handler passes control back to a calling procedure, that procedure becomes the current procedure.","pos":[4112,4229]},{"content":"Once an error is handled by an error handler in any procedure, execution resumes in the current procedure at the point designated by the <ph id=\"ph1\">`Resume`</ph> statement.","pos":[4230,4386],"source":" Once an error is handled by an error handler in any procedure, execution resumes in the current procedure at the point designated by the `Resume` statement."},{"pos":[4394,4547],"content":"[!NOTE]\n An error-handling routine is not a `Sub` procedure or a `Function` procedure. It is a section of code marked by a line label or a line number.","leadings":["","> "],"nodes":[{"content":"An error-handling routine is not a `Sub` procedure or a `Function` procedure. It is a section of code marked by a line label or a line number.","pos":[9,151],"nodes":[{"content":"An error-handling routine is not a <ph id=\"ph1\">`Sub`</ph> procedure or a <ph id=\"ph2\">`Function`</ph> procedure.","pos":[0,77],"source":"An error-handling routine is not a `Sub` procedure or a `Function` procedure."},{"content":"It is a section of code marked by a line label or a line number.","pos":[78,142]}]}]},{"pos":[4556,4571],"content":"Number Property","linkify":"Number Property","nodes":[{"content":"Number Property","pos":[0,15]}]},{"content":"Error-handling routines rely on the value in the <ph id=\"ph1\">`Number`</ph> property of the <ph id=\"ph2\">`Err`</ph> object to determine the cause of the error.","pos":[4575,4698],"source":"Error-handling routines rely on the value in the `Number` property of the `Err` object to determine the cause of the error."},{"content":"The routine should test or save relevant property values in the <ph id=\"ph1\">`Err`</ph> object before any other error can occur or before a procedure that might cause an error is called.","pos":[4699,4867],"source":" The routine should test or save relevant property values in the `Err` object before any other error can occur or before a procedure that might cause an error is called."},{"content":"The property values in the <ph id=\"ph1\">`Err`</ph> object reflect only the most recent error.","pos":[4868,4943],"source":" The property values in the `Err` object reflect only the most recent error."},{"content":"The error message associated with <ph id=\"ph1\">`Err.Number`</ph> is contained in <ph id=\"ph2\">`Err.Description`</ph>.","pos":[4944,5025],"source":" The error message associated with `Err.Number` is contained in `Err.Description`."},{"pos":[5034,5049],"content":"Throw Statement","linkify":"Throw Statement","nodes":[{"content":"Throw Statement","pos":[0,15]}]},{"content":"An error that is raised with the <ph id=\"ph1\">`Err.Raise`</ph> method sets the <ph id=\"ph2\">`Exception`</ph> property to a newly created instance of the <ph id=\"ph3\">&lt;xref:System.Exception&gt;</ph> class.","pos":[5053,5200],"source":"An error that is raised with the `Err.Raise` method sets the `Exception` property to a newly created instance of the <xref:System.Exception> class."},{"content":"In order to support the raising of exceptions of derived exception types, a <ph id=\"ph1\">`Throw`</ph> statement is supported in the language.","pos":[5201,5324],"source":" In order to support the raising of exceptions of derived exception types, a `Throw` statement is supported in the language."},{"content":"This takes a single parameter that is the exception instance to be thrown.","pos":[5325,5399]},{"content":"The following example shows how these features can be used with the existing exception handling support:","pos":[5400,5504]},{"pos":[5511,5647],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrErrorHandling#17<ept id=\"p2\">](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrErrorHandling#17](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_1.vb)]"},{"pos":[5654,5748],"content":"Notice that the <ph id=\"ph1\">`On Error GoTo`</ph> statement traps all errors, regardless of the exception class.","source":"Notice that the `On Error GoTo` statement traps all errors, regardless of the exception class."},{"pos":[5757,5777],"content":"On Error Resume Next","linkify":"On Error Resume Next","nodes":[{"content":"On Error Resume Next","pos":[0,20]}]},{"content":"<ph id=\"ph1\">`On Error Resume Next`</ph> causes execution to continue with the statement immediately following the statement that caused the run-time error, or with the statement immediately following the most recent call out of the procedure containing the <ph id=\"ph2\">`On Error Resume Next`</ph> statement.","pos":[5781,6054],"source":"`On Error Resume Next` causes execution to continue with the statement immediately following the statement that caused the run-time error, or with the statement immediately following the most recent call out of the procedure containing the `On Error Resume Next` statement."},{"content":"This statement allows execution to continue despite a run-time error.","pos":[6055,6124]},{"content":"You can place the error-handling routine where the error would occur rather than transferring control to another location within the procedure.","pos":[6125,6268]},{"content":"An <ph id=\"ph1\">`On Error Resume Next`</ph> statement becomes inactive when another procedure is called, so you should execute an <ph id=\"ph2\">`On Error Resume Next`</ph> statement in each called routine if you want inline error handling within that routine.","pos":[6269,6491],"source":" An `On Error Resume Next` statement becomes inactive when another procedure is called, so you should execute an `On Error Resume Next` statement in each called routine if you want inline error handling within that routine."},{"pos":[6499,6925],"content":"[!NOTE]\n The `On Error Resume Next` construct may be preferable to `On Error GoTo` when handling errors generated during access to other objects. Checking `Err` after each interaction with an object removes ambiguity about which object was accessed by the code. You can be sure which object placed the error code in `Err.Number`, as well as which object originally generated the error (the object specified in `Err.Source`).","leadings":["","> "],"nodes":[{"content":"The `On Error Resume Next` construct may be preferable to `On Error GoTo` when handling errors generated during access to other objects. Checking `Err` after each interaction with an object removes ambiguity about which object was accessed by the code. You can be sure which object placed the error code in `Err.Number`, as well as which object originally generated the error (the object specified in `Err.Source`).","pos":[9,424],"nodes":[{"content":"The <ph id=\"ph1\">`On Error Resume Next`</ph> construct may be preferable to <ph id=\"ph2\">`On Error GoTo`</ph> when handling errors generated during access to other objects.","pos":[0,136],"source":"The `On Error Resume Next` construct may be preferable to `On Error GoTo` when handling errors generated during access to other objects."},{"content":"Checking <ph id=\"ph1\">`Err`</ph> after each interaction with an object removes ambiguity about which object was accessed by the code.","pos":[137,252],"source":" Checking `Err` after each interaction with an object removes ambiguity about which object was accessed by the code."},{"content":"You can be sure which object placed the error code in <ph id=\"ph1\">`Err.Number`</ph>, as well as which object originally generated the error (the object specified in <ph id=\"ph2\">`Err.Source`</ph>).","pos":[253,415],"source":" You can be sure which object placed the error code in `Err.Number`, as well as which object originally generated the error (the object specified in `Err.Source`)."}]}]},{"pos":[6934,6949],"content":"On Error GoTo 0","linkify":"On Error GoTo 0","nodes":[{"content":"On Error GoTo 0","pos":[0,15]}]},{"content":"<ph id=\"ph1\">`On Error GoTo 0`</ph> disables error handling in the current procedure.","pos":[6953,7020],"source":"`On Error GoTo 0` disables error handling in the current procedure."},{"content":"It doesn't specify line 0 as the start of the error-handling code, even if the procedure contains a line numbered 0.","pos":[7021,7137]},{"content":"Without an <ph id=\"ph1\">`On Error GoTo 0`</ph> statement, an error handler is automatically disabled when a procedure is exited.","pos":[7138,7248],"source":" Without an `On Error GoTo 0` statement, an error handler is automatically disabled when a procedure is exited."},{"pos":[7257,7273],"content":"On Error GoTo -1","linkify":"On Error GoTo -1","nodes":[{"content":"On Error GoTo -1","pos":[0,16]}]},{"content":"<ph id=\"ph1\">`On Error GoTo -1`</ph> disables the exception in the current procedure.","pos":[7277,7344],"source":"`On Error GoTo -1` disables the exception in the current procedure."},{"content":"It does not specify line -1 as the start of the error-handling code, even if the procedure contains a line numbered -1.","pos":[7345,7464]},{"content":"Without an <ph id=\"ph1\">`On Error GoTo -1`</ph> statement, an exception is automatically disabled when a procedure is exited.","pos":[7465,7572],"source":" Without an `On Error GoTo -1` statement, an exception is automatically disabled when a procedure is exited."},{"pos":[7579,7794],"content":"To prevent error-handling code from running when no error has occurred, place an <ph id=\"ph1\">`Exit Sub`</ph>, <ph id=\"ph2\">`Exit Function`</ph>, or <ph id=\"ph3\">`Exit Property`</ph> statement immediately before the error-handling routine, as in the following fragment:","source":"To prevent error-handling code from running when no error has occurred, place an `Exit Sub`, `Exit Function`, or `Exit Property` statement immediately before the error-handling routine, as in the following fragment:"},{"pos":[7801,7937],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrErrorHandling#18<ept id=\"p2\">](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_2.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrErrorHandling#18](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_2.vb)]"},{"content":"Here, the error-handling code follows the <ph id=\"ph1\">`Exit Sub`</ph> statement and precedes the <ph id=\"ph2\">`End Sub`</ph> statement to separate it from the procedure flow.","pos":[7944,8083],"source":"Here, the error-handling code follows the `Exit Sub` statement and precedes the `End Sub` statement to separate it from the procedure flow."},{"content":"You can place error-handling code anywhere in a procedure.","pos":[8084,8142]},{"pos":[8151,8167],"content":"Untrapped Errors","linkify":"Untrapped Errors","nodes":[{"content":"Untrapped Errors","pos":[0,16]}]},{"content":"Untrapped errors in objects are returned to the controlling application when the object is running as an executable file.","pos":[8171,8292]},{"content":"Within the development environment, untrapped errors are returned to the controlling application only if the proper options are set.","pos":[8293,8425]},{"content":"See your host application's documentation for a description of which options should be set during debugging, how to set them, and whether the host can create classes.","pos":[8426,8592]},{"content":"If you create an object that accesses other objects, you should try to handle any unhandled errors they pass back.","pos":[8599,8713]},{"content":"If you cannot, map the error codes in <ph id=\"ph1\">`Err.Number`</ph> to one of your own errors and then pass them back to the caller of your object.","pos":[8714,8844],"source":" If you cannot, map the error codes in `Err.Number` to one of your own errors and then pass them back to the caller of your object."},{"content":"You should specify your error by adding your error code to the <ph id=\"ph1\">`VbObjectError`</ph> constant.","pos":[8845,8933],"source":" You should specify your error by adding your error code to the `VbObjectError` constant."},{"content":"For example, if your error code is 1052, assign it as follows:","pos":[8934,8996]},{"pos":[9003,9139],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrErrorHandling#19<ept id=\"p2\">](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_3.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrErrorHandling#19](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_3.vb)]"},{"pos":[9147,9527],"content":"[!CAUTION]\n System errors during calls to Windows dynamic-link libraries (DLLs) do not raise exceptions and cannot be trapped with Visual Basic error trapping. When calling DLL functions, you should check each return value for success or failure (according to the API specifications), and in the event of a failure, check the value in the `Err` object's `LastDLLError` property.","leadings":["","> "],"nodes":[{"content":"System errors during calls to Windows dynamic-link libraries (DLLs) do not raise exceptions and cannot be trapped with Visual Basic error trapping. When calling DLL functions, you should check each return value for success or failure (according to the API specifications), and in the event of a failure, check the value in the `Err` object's `LastDLLError` property.","pos":[12,378],"nodes":[{"content":"System errors during calls to Windows dynamic-link libraries (DLLs) do not raise exceptions and cannot be trapped with Visual Basic error trapping.","pos":[0,147]},{"content":"When calling DLL functions, you should check each return value for success or failure (according to the API specifications), and in the event of a failure, check the value in the <ph id=\"ph1\">`Err`</ph> object's <ph id=\"ph2\">`LastDLLError`</ph> property.","pos":[148,366],"source":" When calling DLL functions, you should check each return value for success or failure (according to the API specifications), and in the event of a failure, check the value in the `Err` object's `LastDLLError` property."}]}]},{"pos":[9536,9543],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example first uses the <ph id=\"ph1\">`On Error GoTo`</ph> statement to specify the location of an error-handling routine within a procedure.","pos":[9547,9673],"source":"This example first uses the `On Error GoTo` statement to specify the location of an error-handling routine within a procedure."},{"content":"In the example, an attempt to divide by zero generates error number 6.","pos":[9674,9744]},{"content":"The error is handled in the error-handling routine, and control is then returned to the statement that caused the error.","pos":[9745,9865]},{"content":"The <ph id=\"ph1\">`On Error GoTo 0`</ph> statement turns off error trapping.","pos":[9866,9923],"source":" The `On Error GoTo 0` statement turns off error trapping."},{"content":"Then the <ph id=\"ph1\">`On Error Resume Next`</ph> statement is used to defer error trapping so that the context for the error generated by the next statement can be known for certain.","pos":[9924,10089],"source":" Then the `On Error Resume Next` statement is used to defer error trapping so that the context for the error generated by the next statement can be known for certain."},{"content":"Note that <ph id=\"ph1\">`Err.Clear`</ph> is used to clear the <ph id=\"ph2\">`Err`</ph> object's properties after the error is handled.","pos":[10090,10186],"source":" Note that `Err.Clear` is used to clear the `Err` object's properties after the error is handled."},{"pos":[10193,10329],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrErrorHandling#20<ept id=\"p2\">](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_4.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrErrorHandling#20](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_4.vb)]"},{"pos":[10338,10350],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[10354,10461],"content":"<bpt id=\"p1\">**</bpt>Namespace:<ept id=\"p1\">**</ept> <bpt id=\"p2\">[</bpt>Microsoft.VisualBasic<ept id=\"p2\">](../../../visual-basic/language-reference/runtime-library-members.md)</ept>","source":"**Namespace:** [Microsoft.VisualBasic](../../../visual-basic/language-reference/runtime-library-members.md)"},{"pos":[10468,10541],"content":"<bpt id=\"p1\">**</bpt>Assembly:<ept id=\"p1\">**</ept> Visual Basic Runtime Library (in Microsoft.VisualBasic.dll)","source":"**Assembly:** Visual Basic Runtime Library (in Microsoft.VisualBasic.dll)"},{"pos":[10550,10558],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.Information.Err%2A&gt;</ph>","pos":[10562,10609],"source":"<xref:Microsoft.VisualBasic.Information.Err%2A> "},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ErrObject.Number%2A&gt;</ph>","pos":[10614,10662],"source":"<xref:Microsoft.VisualBasic.ErrObject.Number%2A> "},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ErrObject.Description%2A&gt;</ph>","pos":[10667,10720],"source":"<xref:Microsoft.VisualBasic.ErrObject.Description%2A> "},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ErrObject.LastDllError%2A&gt;</ph>","pos":[10725,10779],"source":"<xref:Microsoft.VisualBasic.ErrObject.LastDllError%2A> "},{"content":"<bpt id=\"p1\">[</bpt>End Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/end-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[10784,10870],"source":"[End Statement](../../../visual-basic/language-reference/statements/end-statement.md) "},{"content":"<bpt id=\"p1\">[</bpt>Exit Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/exit-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[10874,10962],"source":"[Exit Statement](../../../visual-basic/language-reference/statements/exit-statement.md) "},{"content":"<bpt id=\"p1\">[</bpt>Resume Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/resume-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[10966,11058],"source":"[Resume Statement](../../../visual-basic/language-reference/statements/resume-statement.md) "},{"content":"<bpt id=\"p1\">[</bpt>Error Messages<ept id=\"p1\">](../../../visual-basic/language-reference/error-messages/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[11062,11145],"source":"[Error Messages](../../../visual-basic/language-reference/error-messages/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>Try...Catch...Finally Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)</ept>","pos":[11149,11266],"source":"[Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)"}]}