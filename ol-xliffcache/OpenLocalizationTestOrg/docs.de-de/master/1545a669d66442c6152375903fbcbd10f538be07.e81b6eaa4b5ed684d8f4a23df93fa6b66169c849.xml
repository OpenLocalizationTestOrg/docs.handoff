{"content":"---\ntitle: \"How to: Access the Managed HTML Document Object Model | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"HTML DOM, accessing\"\n  - \"managed HTML DOM, accessing\"\nms.assetid: 40fa5cd5-1ed8-42f6-a93f-9ac01608bbeb\ncaps.latest.revision: 12\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Access the Managed HTML Document Object Model\nYou can access the managed HTML Document Object Model (DOM) from two types of applications:  \n  \n-   A Windows Forms application (.exe) that hosted the managed <xref:System.Windows.Forms.WebBrowser> control. These two technologies complement one another, with the <xref:System.Windows.Forms.WebBrowser> control displaying the page to the user and the HTML DOM representing the document's logical structure.  \n  \n-   A Windows Forms <xref:System.Windows.Forms.UserControl> hosted within Internet Explorer. You can access the HTML DOM representing the page on which your <xref:System.Windows.Forms.UserControl> is hosted in order to change the document's structure or open modal dialog boxes, among many other possibilities.  \n  \n### To access DOM from a Windows Forms application  \n  \n1.  Host a <xref:System.Windows.Forms.WebBrowser> control within your Windows Forms application and monitor for the <xref:System.Windows.Forms.WebBrowser.DocumentCompleted> event. For details on hosting controls and monitoring for events, see [Events](../../../../docs/standard/events/index.md).  \n  \n2.  Retrieve the <xref:System.Windows.Forms.HtmlDocument> for the current page by accessing the <xref:System.Windows.Forms.WebBrowser.Document%2A> property of the <xref:System.Windows.Forms.WebBrowser> control.  \n\n### To access DOM from a UserControl hosted in Internet Explorer  \n  \n1.  Create your own custom derived class of the <xref:System.Windows.Forms.UserControl> class. For more information, see [How to: Author Composite Controls](../../../../docs/framework/winforms/controls/how-to-author-composite-controls.md).  \n  \n2.  Place the following code inside of your Load event handler for your <xref:System.Windows.Forms.UserControl>:  \n  \n [!code-csharp[AccessHTMLDOMControl#1](../../../../samples/snippets/csharp/VS_Snippets_Winforms/AccessHTMLDOMControl/cs/UserControl1.cs#1)]\n [!code-vb[AccessHTMLDOMControl#1](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/AccessHTMLDOMControl/vb/UserControl1.vb#1)]  \n  \n## Robust Programming  \n  \n1.  When using the DOM through the <xref:System.Windows.Forms.WebBrowser> control, you should always wait until the <xref:System.Windows.Forms.WebBrowser.DocumentCompleted> event occurs before attempting to access the <xref:System.Windows.Forms.WebBrowser.Document%2A> property of the <xref:System.Windows.Forms.WebBrowser> control. The <xref:System.Windows.Forms.WebBrowser.DocumentCompleted> event is raised after the entire document has loaded; if you use the DOM before then, you risk causing a run-time exception in your application.  \n  \n## .NET Framework Security  \n  \n1.  Your application or <xref:System.Windows.Forms.UserControl> will require full trust in order to access the managed HTML DOM. If you are deploying a Windows Forms application using [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)], you can request full trust using either Permission Elevation or Trusted Application Deployment; see [Securing ClickOnce Applications](/visualstudio/deployment/securing-clickonce-applications) for details.  \n  \n## See Also  \n [Using the Managed HTML Document Object Model](../../../../docs/framework/winforms/controls/using-the-managed-html-document-object-model.md)","nodes":[{"pos":[12,82],"content":"How to: Access the Managed HTML Document Object Model | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Access the Managed HTML Document Object Model | Microsoft Docs","pos":[0,70]}]},{"pos":[502,555],"content":"How to: Access the Managed HTML Document Object Model","linkify":"How to: Access the Managed HTML Document Object Model","nodes":[{"content":"How to: Access the Managed HTML Document Object Model","pos":[0,53]}]},{"content":"You can access the managed HTML Document Object Model (DOM) from two types of applications:","pos":[556,647]},{"content":"A Windows Forms application (.exe) that hosted the managed <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control.","pos":[657,763],"source":"A Windows Forms application (.exe) that hosted the managed <xref:System.Windows.Forms.WebBrowser> control."},{"content":"These two technologies complement one another, with the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control displaying the page to the user and the HTML DOM representing the document's logical structure.","pos":[764,962],"source":" These two technologies complement one another, with the <xref:System.Windows.Forms.WebBrowser> control displaying the page to the user and the HTML DOM representing the document's logical structure."},{"content":"A Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> hosted within Internet Explorer.","pos":[972,1060],"source":"A Windows Forms <xref:System.Windows.Forms.UserControl> hosted within Internet Explorer."},{"content":"You can access the HTML DOM representing the page on which your <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> is hosted in order to change the document's structure or open modal dialog boxes, among many other possibilities.","pos":[1061,1278],"source":" You can access the HTML DOM representing the page on which your <xref:System.Windows.Forms.UserControl> is hosted in order to change the document's structure or open modal dialog boxes, among many other possibilities."},{"pos":[1288,1334],"content":"To access DOM from a Windows Forms application","linkify":"To access DOM from a Windows Forms application","nodes":[{"content":"To access DOM from a Windows Forms application","pos":[0,46]}]},{"content":"Host a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control within your Windows Forms application and monitor for the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.WebBrowser.DocumentCompleted&gt;</ph> event.","pos":[1344,1519],"source":"Host a <xref:System.Windows.Forms.WebBrowser> control within your Windows Forms application and monitor for the <xref:System.Windows.Forms.WebBrowser.DocumentCompleted> event."},{"content":"For details on hosting controls and monitoring for events, see <bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../../docs/standard/events/index.md)</ept>.","pos":[1520,1635],"source":" For details on hosting controls and monitoring for events, see [Events](../../../../docs/standard/events/index.md)."},{"content":"Retrieve the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.HtmlDocument&gt;</ph> for the current page by accessing the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.WebBrowser.Document%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control.","pos":[1645,1851],"source":"Retrieve the <xref:System.Windows.Forms.HtmlDocument> for the current page by accessing the <xref:System.Windows.Forms.WebBrowser.Document%2A> property of the <xref:System.Windows.Forms.WebBrowser> control."},{"pos":[1859,1919],"content":"To access DOM from a UserControl hosted in Internet Explorer","linkify":"To access DOM from a UserControl hosted in Internet Explorer","nodes":[{"content":"To access DOM from a UserControl hosted in Internet Explorer","pos":[0,60]}]},{"content":"Create your own custom derived class of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> class.","pos":[1929,2019],"source":"Create your own custom derived class of the <xref:System.Windows.Forms.UserControl> class."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Author Composite Controls<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-author-composite-controls.md)</ept>.","pos":[2020,2164],"source":" For more information, see [How to: Author Composite Controls](../../../../docs/framework/winforms/controls/how-to-author-composite-controls.md)."},{"content":"Place the following code inside of your Load event handler for your <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph>:","pos":[2174,2282],"source":"Place the following code inside of your Load event handler for your <xref:System.Windows.Forms.UserControl>:"},{"pos":[2289,2568],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>AccessHTMLDOMControl#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/AccessHTMLDOMControl/cs/UserControl1.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>AccessHTMLDOMControl#1<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/AccessHTMLDOMControl/vb/UserControl1.vb#1)</ept><ept id=\"p3\">]</ept>","leadings":[""," "],"source":"[!code-csharp[AccessHTMLDOMControl#1](../../../../samples/snippets/csharp/VS_Snippets_Winforms/AccessHTMLDOMControl/cs/UserControl1.cs#1)]\n[!code-vb[AccessHTMLDOMControl#1](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/AccessHTMLDOMControl/vb/UserControl1.vb#1)]"},{"pos":[2577,2595],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"When using the DOM through the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control, you should always wait until the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.WebBrowser.DocumentCompleted&gt;</ph> event occurs before attempting to access the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.WebBrowser.Document%2A&gt;</ph> property of the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control.","pos":[2605,2933],"source":"When using the DOM through the <xref:System.Windows.Forms.WebBrowser> control, you should always wait until the <xref:System.Windows.Forms.WebBrowser.DocumentCompleted> event occurs before attempting to access the <xref:System.Windows.Forms.WebBrowser.Document%2A> property of the <xref:System.Windows.Forms.WebBrowser> control."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.DocumentCompleted&gt;</ph> event is raised after the entire document has loaded; if you use the DOM before then, you risk causing a run-time exception in your application.","pos":[2934,3139],"source":" The <xref:System.Windows.Forms.WebBrowser.DocumentCompleted> event is raised after the entire document has loaded; if you use the DOM before then, you risk causing a run-time exception in your application."},{"pos":[3148,3171],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"Your application or <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> will require full trust in order to access the managed HTML DOM.","pos":[3181,3305],"source":"Your application or <xref:System.Windows.Forms.UserControl> will require full trust in order to access the managed HTML DOM."},{"content":"If you are deploying a Windows Forms application using <ph id=\"ph1\">[!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)]</ph>, you can request full trust using either Permission Elevation or Trusted Application Deployment; see <bpt id=\"p1\">[</bpt>Securing ClickOnce Applications<ept id=\"p1\">](/visualstudio/deployment/securing-clickonce-applications)</ept> for details.","pos":[3306,3630],"source":" If you are deploying a Windows Forms application using [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)], you can request full trust using either Permission Elevation or Trusted Application Deployment; see [Securing ClickOnce Applications](/visualstudio/deployment/securing-clickonce-applications) for details."},{"pos":[3639,3647],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[3651,3791],"content":"<bpt id=\"p1\">[</bpt>Using the Managed HTML Document Object Model<ept id=\"p1\">](../../../../docs/framework/winforms/controls/using-the-managed-html-document-object-model.md)</ept>","source":"[Using the Managed HTML Document Object Model](../../../../docs/framework/winforms/controls/using-the-managed-html-document-object-model.md)"}]}