{"content":"---\ntitle: \"ICLRRuntimeHost Interface\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"ICLRRuntimeHost\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRRuntimeHost\"\nhelpviewer_keywords: \n  - \"ICLRRuntimeHost interface [.NET Framework hosting]\"\nms.assetid: cb0c5f65-3791-47bc-b833-2f84f4101ba5\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# ICLRRuntimeHost Interface\nProvides functionality similar to that of the [ICorRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md) interface provided in the .NET Framework version 1, with the following changes:  \n  \n-   The addition of the [SetHostControl](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-sethostcontrol-method.md) method to set the host control interface.  \n  \n-   The omission of some methods provided by `ICorRuntimeHost`.  \n  \n## Methods  \n  \n|Method|Description|  \n|------------|-----------------|  \n|[ExecuteApplication Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeapplication-method.md)|Used in manifest-based ClickOnce deployment scenarios to specify the application to be activated in a new domain.|  \n|[ExecuteInAppDomain Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeinappdomain-method.md)|Specifies the <xref:System.AppDomain> in which to execute the specified managed code.|  \n|[ExecuteInDefaultAppDomain Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeindefaultappdomain-method.md)|Invokes the specified method of the specified type in the specified assembly.|  \n|[GetCLRControl Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-getclrcontrol-method.md)|Gets an interface pointer of type [ICLRControl](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-interface.md) that hosts can use to customize aspects of the common language runtime (CLR).|  \n|[GetCurrentAppDomainId Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-getcurrentappdomainid-method.md)|Gets the numeric identifier of the <xref:System.AppDomain> that is currently executing.|  \n|[SetHostControl Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-sethostcontrol-method.md)|Sets the host control interface. You must call `SetHostControl` before calling `Start`.|  \n|[Start Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-start-method.md)|Initializes the CLR into a process.|  \n|[Stop Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-stop-method.md)|Stops the execution of code by the runtime.|  \n|[UnloadAppDomain Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-unloadappdomain-method.md)|Unloads the <xref:System.AppDomain> that corresponds to the specified numeric identifier.|  \n  \n## Remarks  \n Starting with the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)], use the [ICLRMetaHost](../../../../docs/framework/unmanaged-api/hosting/iclrmetahost-interface.md) interface to get a pointer to the [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface, and then call the [ICLRRuntimeInfo::GetInterface](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-getinterface-method.md) method to get a pointer to `ICLRRuntimeHost`. In earlier versions of the .NET Framework, the host gets a pointer to an `ICLRRuntimeHost` instance by calling [CorBindToRuntimeEx](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md) or [CorBindToCurrentRuntime](../../../../docs/framework/unmanaged-api/hosting/corbindtocurrentruntime-function.md). To provide implementations of any of the technologies provided in the .NET Framework version 2.0, you must use `ICLRRuntimeHost` instead of `ICorRuntimeHost`.  \n  \n> [!IMPORTANT]\n>  Do not call the [Start](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-start-method.md) method before calling the [ExecuteApplication](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeapplication-method.md) method to activate a manifest-based application. If the `Start` method is called first, the `ExecuteApplication` method call will fail.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See also\n\n- [CorBindToCurrentRuntime Function](../../../../docs/framework/unmanaged-api/hosting/corbindtocurrentruntime-function.md)\n- [CorBindToRuntimeEx Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)\n- [ICLRControl Interface](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-interface.md)\n- [ICorRuntimeHost Interface](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md)\n- [Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)\n- [CLRRuntimeHost Coclass](../../../../docs/framework/unmanaged-api/hosting/clrruntimehost-coclass.md)\n","nodes":[{"pos":[4,377],"embed":true,"restype":"x-metadata","content":"title: \"ICLRRuntimeHost Interface\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"ICLRRuntimeHost\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRRuntimeHost\"\nhelpviewer_keywords: \n  - \"ICLRRuntimeHost interface [.NET Framework hosting]\"\nms.assetid: cb0c5f65-3791-47bc-b833-2f84f4101ba5\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"ICLRRuntimeHost Interface","nodes":[{"pos":[0,25],"content":"ICLRRuntimeHost Interface","nodes":[{"content":"ICLRRuntimeHost Interface","pos":[0,25]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[384,409],"content":"ICLRRuntimeHost Interface","linkify":"ICLRRuntimeHost Interface","nodes":[{"content":"ICLRRuntimeHost Interface","pos":[0,25]}]},{"pos":[410,632],"content":"Provides functionality similar to that of the <bpt id=\"p1\">[</bpt>ICorRuntimeHost<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md)</ept> interface provided in the .NET Framework version 1, with the following changes:","source":"Provides functionality similar to that of the [ICorRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md) interface provided in the .NET Framework version 1, with the following changes:"},{"pos":[642,811],"content":"The addition of the <bpt id=\"p1\">[</bpt>SetHostControl<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-sethostcontrol-method.md)</ept> method to set the host control interface.","source":"The addition of the [SetHostControl](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-sethostcontrol-method.md) method to set the host control interface."},{"pos":[821,880],"content":"The omission of some methods provided by <ph id=\"ph1\">`ICorRuntimeHost`</ph>.","source":"The omission of some methods provided by `ICorRuntimeHost`."},{"pos":[889,896],"content":"Methods","linkify":"Methods","nodes":[{"content":"Methods","pos":[0,7]}]},{"content":"Method","pos":[903,909]},{"content":"Description","pos":[910,921]},{"pos":[961,1083],"content":"<bpt id=\"p1\">[</bpt>ExecuteApplication Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeapplication-method.md)</ept>","source":"[ExecuteApplication Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeapplication-method.md)"},{"content":"Used in manifest-based ClickOnce deployment scenarios to specify the application to be activated in a new domain.","pos":[1084,1197]},{"pos":[1202,1324],"content":"<bpt id=\"p1\">[</bpt>ExecuteInAppDomain Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeinappdomain-method.md)</ept>","source":"[ExecuteInAppDomain Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeinappdomain-method.md)"},{"pos":[1325,1410],"content":"Specifies the <ph id=\"ph1\">&lt;xref:System.AppDomain&gt;</ph> in which to execute the specified managed code.","source":"Specifies the <xref:System.AppDomain> in which to execute the specified managed code."},{"pos":[1415,1551],"content":"<bpt id=\"p1\">[</bpt>ExecuteInDefaultAppDomain Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeindefaultappdomain-method.md)</ept>","source":"[ExecuteInDefaultAppDomain Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeindefaultappdomain-method.md)"},{"content":"Invokes the specified method of the specified type in the specified assembly.","pos":[1552,1629]},{"pos":[1634,1746],"content":"<bpt id=\"p1\">[</bpt>GetCLRControl Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-getclrcontrol-method.md)</ept>","source":"[GetCLRControl Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-getclrcontrol-method.md)"},{"pos":[1747,1947],"content":"Gets an interface pointer of type <bpt id=\"p1\">[</bpt>ICLRControl<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-interface.md)</ept> that hosts can use to customize aspects of the common language runtime (CLR).","source":"Gets an interface pointer of type [ICLRControl](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-interface.md) that hosts can use to customize aspects of the common language runtime (CLR)."},{"pos":[1952,2080],"content":"<bpt id=\"p1\">[</bpt>GetCurrentAppDomainId Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-getcurrentappdomainid-method.md)</ept>","source":"[GetCurrentAppDomainId Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-getcurrentappdomainid-method.md)"},{"pos":[2081,2168],"content":"Gets the numeric identifier of the <ph id=\"ph1\">&lt;xref:System.AppDomain&gt;</ph> that is currently executing.","source":"Gets the numeric identifier of the <xref:System.AppDomain> that is currently executing."},{"pos":[2173,2287],"content":"<bpt id=\"p1\">[</bpt>SetHostControl Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-sethostcontrol-method.md)</ept>","source":"[SetHostControl Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-sethostcontrol-method.md)"},{"content":"Sets the host control interface.","pos":[2288,2320]},{"content":"You must call <ph id=\"ph1\">`SetHostControl`</ph> before calling <ph id=\"ph2\">`Start`</ph>.","pos":[2321,2375],"source":" You must call `SetHostControl` before calling `Start`."},{"pos":[2380,2476],"content":"<bpt id=\"p1\">[</bpt>Start Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-start-method.md)</ept>","source":"[Start Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-start-method.md)"},{"content":"Initializes the CLR into a process.","pos":[2477,2512]},{"pos":[2517,2611],"content":"<bpt id=\"p1\">[</bpt>Stop Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-stop-method.md)</ept>","source":"[Stop Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-stop-method.md)"},{"content":"Stops the execution of code by the runtime.","pos":[2612,2655]},{"pos":[2660,2776],"content":"<bpt id=\"p1\">[</bpt>UnloadAppDomain Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-unloadappdomain-method.md)</ept>","source":"[UnloadAppDomain Method](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-unloadappdomain-method.md)"},{"pos":[2777,2866],"content":"Unloads the <ph id=\"ph1\">&lt;xref:System.AppDomain&gt;</ph> that corresponds to the specified numeric identifier.","source":"Unloads the <xref:System.AppDomain> that corresponds to the specified numeric identifier."},{"pos":[2876,2883],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Starting with the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph>, use the <bpt id=\"p1\">[</bpt>ICLRMetaHost<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrmetahost-interface.md)</ept> interface to get a pointer to the <bpt id=\"p2\">[</bpt>ICLRRuntimeInfo<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md)</ept> interface, and then call the <bpt id=\"p3\">[</bpt>ICLRRuntimeInfo::GetInterface<ept id=\"p3\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-getinterface-method.md)</ept> method to get a pointer to <ph id=\"ph2\">`ICLRRuntimeHost`</ph>.","pos":[2887,3397],"source":"Starting with the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)], use the [ICLRMetaHost](../../../../docs/framework/unmanaged-api/hosting/iclrmetahost-interface.md) interface to get a pointer to the [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface, and then call the [ICLRRuntimeInfo::GetInterface](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-getinterface-method.md) method to get a pointer to `ICLRRuntimeHost`."},{"content":"In earlier versions of the .NET Framework, the host gets a pointer to an <ph id=\"ph1\">`ICLRRuntimeHost`</ph> instance by calling <bpt id=\"p1\">[</bpt>CorBindToRuntimeEx<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)</ept> or <bpt id=\"p2\">[</bpt>CorBindToCurrentRuntime<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/hosting/corbindtocurrentruntime-function.md)</ept>.","pos":[3398,3726],"source":" In earlier versions of the .NET Framework, the host gets a pointer to an `ICLRRuntimeHost` instance by calling [CorBindToRuntimeEx](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md) or [CorBindToCurrentRuntime](../../../../docs/framework/unmanaged-api/hosting/corbindtocurrentruntime-function.md)."},{"content":"To provide implementations of any of the technologies provided in the .NET Framework version 2.0, you must use <ph id=\"ph1\">`ICLRRuntimeHost`</ph> instead of <ph id=\"ph2\">`ICorRuntimeHost`</ph>.","pos":[3727,3885],"source":" To provide implementations of any of the technologies provided in the .NET Framework version 2.0, you must use `ICLRRuntimeHost` instead of `ICorRuntimeHost`."},{"pos":[3893,4292],"content":"[!IMPORTANT]\n Do not call the [Start](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-start-method.md) method before calling the [ExecuteApplication](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeapplication-method.md) method to activate a manifest-based application. If the `Start` method is called first, the `ExecuteApplication` method call will fail.","leadings":["","> "],"nodes":[{"content":"Do not call the [Start](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-start-method.md) method before calling the [ExecuteApplication](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeapplication-method.md) method to activate a manifest-based application. If the `Start` method is called first, the `ExecuteApplication` method call will fail.","pos":[14,397],"nodes":[{"content":"Do not call the <bpt id=\"p1\">[</bpt>Start<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-start-method.md)</ept> method before calling the <bpt id=\"p2\">[</bpt>ExecuteApplication<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeapplication-method.md)</ept> method to activate a manifest-based application.","pos":[0,296],"source":"Do not call the [Start](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-start-method.md) method before calling the [ExecuteApplication](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-executeapplication-method.md) method to activate a manifest-based application."},{"content":"If the <ph id=\"ph1\">`Start`</ph> method is called first, the <ph id=\"ph2\">`ExecuteApplication`</ph> method call will fail.","pos":[297,383],"source":" If the `Start` method is called first, the `ExecuteApplication` method call will fail."}]}]},{"pos":[4301,4313],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4317,4421],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[4428,4449],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[4456,4506],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[4513,4621],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[4630,4638],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4642,4762],"content":"<bpt id=\"p1\">[</bpt>CorBindToCurrentRuntime Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtocurrentruntime-function.md)</ept>","source":"[CorBindToCurrentRuntime Function](../../../../docs/framework/unmanaged-api/hosting/corbindtocurrentruntime-function.md)"},{"pos":[4765,4875],"content":"<bpt id=\"p1\">[</bpt>CorBindToRuntimeEx Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)</ept>","source":"[CorBindToRuntimeEx Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)"},{"pos":[4878,4976],"content":"<bpt id=\"p1\">[</bpt>ICLRControl Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-interface.md)</ept>","source":"[ICLRControl Interface](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-interface.md)"},{"pos":[4979,5085],"content":"<bpt id=\"p1\">[</bpt>ICorRuntimeHost Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md)</ept>","source":"[ICorRuntimeHost Interface](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md)"},{"pos":[5088,5180],"content":"<bpt id=\"p1\">[</bpt>Hosting Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)</ept>","source":"[Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)"},{"pos":[5183,5283],"content":"<bpt id=\"p1\">[</bpt>CLRRuntimeHost Coclass<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/clrruntimehost-coclass.md)</ept>","source":"[CLRRuntimeHost Coclass](../../../../docs/framework/unmanaged-api/hosting/clrruntimehost-coclass.md)"}]}