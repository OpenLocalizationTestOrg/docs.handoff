{"content":"---\ntitle: \"_CorValidateImage Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"_CorValidateImage\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"_CorValidateImage\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"_CorValidateImage function [.NET Framework hosting]\"\nms.assetid: 0117e080-05f9-4772-885d-e1847230947c\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 22\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# _CorValidateImage Function\nValidates managed module images, and notifies the operating system loader after they have been loaded.  \n  \n## Syntax  \n  \n```  \nSTDAPI _CorValidateImage (   \n   [in] PVOID* ImageBase,  \n   [in] LPCWSTR FileName  \n);  \n```  \n  \n#### Parameters  \n `ImageBase`  \n [in] A pointer to the starting location of the image to validate as managed code. The image must already be loaded into memory.  \n  \n `FileName`  \n [in] The file name of the image.  \n  \n## Return Value  \n This function returns the standard values `E_INVALIDARG`, `E_OUTOFMEMORY`, `E_UNEXPECTED`, and `E_FAIL`, as well as the following values.  \n  \n|Return value|Description|  \n|------------------|-----------------|  \n|`STATUS_INVALID_IMAGE_FORMAT`|The image is invalid. This value has the HRESULT 0xC000007BL.|  \n|`STATUS_SUCCESS`|The image is valid. This value has the HRESULT 0x00000000L.|  \n  \n## Remarks  \n In Windows XP and later versions, the operating system loader checks for managed modules by examining the COM Descriptor Directory bit in the common object file format (COFF) header. A set bit indicates a managed module. If the loader detects a managed module, it loads MsCorEE.dll and calls `_CorValidateImage`, which performs the following actions:  \n  \n-   Confirms that the image is a valid managed module.  \n  \n-   Changes the entry point in the image to an entry point in the common language runtime (CLR).  \n  \n-   For 64-bit versions of Windows, modifies the image that is in memory by transforming it from PE32 to PE32+ format.  \n  \n-   Returns to the loader when the managed module images are loaded.  \n  \n For executable images, the operating system loader then calls the [_CorExeMain](../../../../docs/framework/unmanaged-api/hosting/corexemain-function.md) function, regardless of the entry point specified in the executable. For DLL assembly images, the loader calls the [_CorDllMain](../../../../docs/framework/unmanaged-api/hosting/cordllmain-function.md) function.  \n  \n `_CorExeMain` or `_CorDllMain` performs the following actions:  \n  \n-   Initializes the CLR.  \n  \n-   Locates the managed entry point from the assembly's CLR header.  \n  \n-   Begins execution.  \n  \n The loader calls the [_CorImageUnloading](../../../../docs/framework/unmanaged-api/hosting/corimageunloading-function.md) function when managed module images are unloaded. However, this function does not perform any action; it just returns.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** Cor.h  \n  \n **Library:** Included as a resource in MsCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See Also  \n [Metadata Global Static Functions](../../../../docs/framework/unmanaged-api/metadata/metadata-global-static-functions.md)\n","nodes":[{"pos":[4,615],"embed":true,"restype":"x-metadata","content":"title: \"_CorValidateImage Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"_CorValidateImage\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"_CorValidateImage\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"_CorValidateImage function [.NET Framework hosting]\"\nms.assetid: 0117e080-05f9-4772-885d-e1847230947c\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 22\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"_CorValidateImage Function | Microsoft Docs","nodes":[{"pos":[0,43],"content":"_CorValidateImage Function | Microsoft Docs","nodes":[{"content":"_CorValidateImage Function | Microsoft Docs","pos":[0,43]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[622,648],"content":"_CorValidateImage Function","linkify":"_CorValidateImage Function","nodes":[{"content":"_CorValidateImage Function","pos":[0,26]}]},{"content":"Validates managed module images, and notifies the operating system loader after they have been loaded.","pos":[649,751]},{"pos":[760,766],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[882,892],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A pointer to the starting location of the image to validate as managed code.","pos":[911,992]},{"content":"The image must already be loaded into memory.","pos":[993,1038]},{"content":"[in] The file name of the image.","pos":[1059,1091]},{"pos":[1100,1112],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[1116,1253],"content":"This function returns the standard values <ph id=\"ph1\">`E_INVALIDARG`</ph>, <ph id=\"ph2\">`E_OUTOFMEMORY`</ph>, <ph id=\"ph3\">`E_UNEXPECTED`</ph>, and <ph id=\"ph4\">`E_FAIL`</ph>, as well as the following values.","source":"This function returns the standard values `E_INVALIDARG`, `E_OUTOFMEMORY`, `E_UNEXPECTED`, and `E_FAIL`, as well as the following values."},{"content":"Return value","pos":[1260,1272]},{"content":"Description","pos":[1273,1284]},{"content":"The image is invalid.","pos":[1360,1381]},{"content":"This value has the HRESULT 0xC000007BL.","pos":[1382,1421]},{"content":"The image is valid.","pos":[1443,1462]},{"content":"This value has the HRESULT 0x00000000L.","pos":[1463,1502]},{"pos":[1512,1519],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"In Windows XP and later versions, the operating system loader checks for managed modules by examining the COM Descriptor Directory bit in the common object file format (COFF) header.","pos":[1523,1705]},{"content":"A set bit indicates a managed module.","pos":[1706,1743]},{"content":"If the loader detects a managed module, it loads MsCorEE.dll and calls <ph id=\"ph1\">`_CorValidateImage`</ph>, which performs the following actions:","pos":[1744,1873],"source":" If the loader detects a managed module, it loads MsCorEE.dll and calls `_CorValidateImage`, which performs the following actions:"},{"content":"Confirms that the image is a valid managed module.","pos":[1883,1933]},{"content":"Changes the entry point in the image to an entry point in the common language runtime (CLR).","pos":[1943,2035]},{"content":"For 64-bit versions of Windows, modifies the image that is in memory by transforming it from PE32 to PE32+ format.","pos":[2045,2159]},{"content":"Returns to the loader when the managed module images are loaded.","pos":[2169,2233]},{"content":"For executable images, the operating system loader then calls the <bpt id=\"p1\">[</bpt>_CorExeMain<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corexemain-function.md)</ept> function, regardless of the entry point specified in the executable.","pos":[2240,2461],"source":"For executable images, the operating system loader then calls the [_CorExeMain](../../../../docs/framework/unmanaged-api/hosting/corexemain-function.md) function, regardless of the entry point specified in the executable."},{"content":"For DLL assembly images, the loader calls the <bpt id=\"p1\">[</bpt>_CorDllMain<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/cordllmain-function.md)</ept> function.","pos":[2462,2604],"source":" For DLL assembly images, the loader calls the [_CorDllMain](../../../../docs/framework/unmanaged-api/hosting/cordllmain-function.md) function."},{"pos":[2611,2673],"content":"<ph id=\"ph1\">`_CorExeMain`</ph> or <ph id=\"ph2\">`_CorDllMain`</ph> performs the following actions:","source":"`_CorExeMain` or `_CorDllMain` performs the following actions:"},{"content":"Initializes the CLR.","pos":[2683,2703]},{"content":"Locates the managed entry point from the assembly's CLR header.","pos":[2713,2776]},{"content":"Begins execution.","pos":[2786,2803]},{"content":"The loader calls the <bpt id=\"p1\">[</bpt>_CorImageUnloading<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corimageunloading-function.md)</ept> function when managed module images are unloaded.","pos":[2810,2981],"source":"The loader calls the [_CorImageUnloading](../../../../docs/framework/unmanaged-api/hosting/corimageunloading-function.md) function when managed module images are unloaded."},{"content":"However, this function does not perform any action; it just returns.","pos":[2982,3050]},{"pos":[3059,3071],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3075,3179],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3186,3203],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> Cor.h","source":"**Header:** Cor.h"},{"pos":[3210,3260],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MsCorEE.dll","source":"**Library:** Included as a resource in MsCorEE.dll"},{"pos":[3267,3375],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]"},{"pos":[3384,3392],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[3396,3517],"content":"<bpt id=\"p1\">[</bpt>Metadata Global Static Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/metadata-global-static-functions.md)</ept>","source":"[Metadata Global Static Functions](../../../../docs/framework/unmanaged-api/metadata/metadata-global-static-functions.md)"}]}