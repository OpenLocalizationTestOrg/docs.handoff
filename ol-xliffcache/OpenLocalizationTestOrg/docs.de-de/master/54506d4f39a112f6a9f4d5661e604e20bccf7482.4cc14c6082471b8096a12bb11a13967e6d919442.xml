{"content":"---\ntitle: \"How to: Customize Sorting in the Windows Forms DataGridView Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"sorting, DataGridView control\"\n  - \"DataGridView control [Windows Forms], sorting\"\n  - \"data grids, customizing sorting\"\nms.assetid: 92fb5c14-afab-4cf5-a97e-924fd9cb99f5\ncaps.latest.revision: 12\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Customize Sorting in the Windows Forms DataGridView Control\nThe <xref:System.Windows.Forms.DataGridView> control provides automatic sorting but, depending on your needs, you might need to customize sort operations. For example, you can use programmatic sorting to create an alternate user interface (UI). Alternatively, you can handle the <xref:System.Windows.Forms.DataGridView.SortCompare> event or call the `Sort(IComparer)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method for greater sorting flexibility, such as sorting multiple columns.  \n  \n The following code examples demonstrate these three approaches to custom sorting. For more information, see [Column Sort Modes in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/column-sort-modes-in-the-windows-forms-datagridview-control.md).  \n  \n## Programmatic Sorting  \n The following code example demonstrates a programmatic sort using the <xref:System.Windows.Forms.DataGridView.SortOrder%2A> and <xref:System.Windows.Forms.DataGridView.SortedColumn%2A> properties to determine the direction of the sort, and the <xref:System.Windows.Forms.DataGridViewColumnHeaderCell.SortGlyphDirection%2A> property to manually set the sort glyph. The `Sort(DataGridViewColumn,ListSortDirection)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method is used to sort data only in a single column.  \n  \n [!code-csharp[System.Windows.Forms.DataGridViewProgrammaticSort#00](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewProgrammaticSort/CS/form1.cs#00)]\n [!code-vb[System.Windows.Forms.DataGridViewProgrammaticSort#00](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewProgrammaticSort/VB/form1.vb#00)]  \n  \n## Custom Sorting Using the SortCompare Event  \n The following code example demonstrates custom sorting using a <xref:System.Windows.Forms.DataGridView.SortCompare> event handler. The selected <xref:System.Windows.Forms.DataGridViewColumn> is sorted and, if there are duplicate values in the column, the ID column is used to determine the final order.  \n  \n [!code-csharp[System.Windows.Forms.DataGridView.SortCompare#00](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.SortCompare/CS/form1.cs#00)]\n [!code-vb[System.Windows.Forms.DataGridView.SortCompare#00](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.SortCompare/VB/form1.vb#00)]  \n  \n## Custom Sorting Using the IComparer Interface  \n The following code example demonstrates custom sorting using the `Sort(IComparer)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method, which takes an implementation of the <xref:System.Collections.IComparer> interface to perform a multiple-column sort.  \n  \n [!code-csharp[System.Windows.Forms.DataGridViewIComparerSort#00](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewIComparerSort/CS/form1.cs#00)]\n [!code-vb[System.Windows.Forms.DataGridViewIComparerSort#00](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewIComparerSort/VB/form1.vb#00)]  \n  \n## Compiling the Code  \n These examples require:  \n  \n-   References to the System, System.Drawing, and System.Windows.Forms assemblies.  \n  \n For information about building these examples from the command line for [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)] or [!INCLUDE[csprcs](../../../../includes/csprcs-md.md)], see [Building from the Command Line](~/docs/visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md). You can also build this example in [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] by pasting the code into a new project.  Also see [How to: Compile and Run a Complete Windows Forms Code Example Using Visual Studio](http://msdn.microsoft.com/library/Bb129228\\(v=vs.110\\)).  \n  \n## See Also  \n <xref:System.Windows.Forms.DataGridView>   \n [Sorting Data in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/sorting-data-in-the-windows-forms-datagridview-control.md)   \n [Column Sort Modes in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/column-sort-modes-in-the-windows-forms-datagridview-control.md)   \n [How to: Set the Sort Modes for Columns in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/set-the-sort-modes-for-columns-wf-datagridview-control.md)","nodes":[{"pos":[12,96],"content":"How to: Customize Sorting in the Windows Forms DataGridView Control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Customize Sorting in the Windows Forms DataGridView Control | Microsoft Docs","pos":[0,84]}]},{"pos":[582,649],"content":"How to: Customize Sorting in the Windows Forms DataGridView Control","linkify":"How to: Customize Sorting in the Windows Forms DataGridView Control","nodes":[{"content":"How to: Customize Sorting in the Windows Forms DataGridView Control","pos":[0,67]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control provides automatic sorting but, depending on your needs, you might need to customize sort operations.","pos":[650,804],"source":"The <xref:System.Windows.Forms.DataGridView> control provides automatic sorting but, depending on your needs, you might need to customize sort operations."},{"content":"For example, you can use programmatic sorting to create an alternate user interface (UI).","pos":[805,894]},{"content":"Alternatively, you can handle the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.SortCompare&gt;</ph> event or call the <ph id=\"ph2\">`Sort(IComparer)`</ph> overload of the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.DataGridView.Sort%2A&gt;</ph> method for greater sorting flexibility, such as sorting multiple columns.","pos":[895,1156],"source":" Alternatively, you can handle the <xref:System.Windows.Forms.DataGridView.SortCompare> event or call the `Sort(IComparer)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method for greater sorting flexibility, such as sorting multiple columns."},{"content":"The following code examples demonstrate these three approaches to custom sorting.","pos":[1163,1244]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Column Sort Modes in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/column-sort-modes-in-the-windows-forms-datagridview-control.md)</ept>.","pos":[1245,1442],"source":" For more information, see [Column Sort Modes in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/column-sort-modes-in-the-windows-forms-datagridview-control.md)."},{"pos":[1451,1471],"content":"Programmatic Sorting","linkify":"Programmatic Sorting","nodes":[{"content":"Programmatic Sorting","pos":[0,20]}]},{"content":"The following code example demonstrates a programmatic sort using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.SortOrder%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView.SortedColumn%2A&gt;</ph> properties to determine the direction of the sort, and the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.DataGridViewColumnHeaderCell.SortGlyphDirection%2A&gt;</ph> property to manually set the sort glyph.","pos":[1475,1838],"source":"The following code example demonstrates a programmatic sort using the <xref:System.Windows.Forms.DataGridView.SortOrder%2A> and <xref:System.Windows.Forms.DataGridView.SortedColumn%2A> properties to determine the direction of the sort, and the <xref:System.Windows.Forms.DataGridViewColumnHeaderCell.SortGlyphDirection%2A> property to manually set the sort glyph."},{"content":"The <ph id=\"ph1\">`Sort(DataGridViewColumn,ListSortDirection)`</ph> overload of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView.Sort%2A&gt;</ph> method is used to sort data only in a single column.","pos":[1839,2005],"source":" The `Sort(DataGridViewColumn,ListSortDirection)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method is used to sort data only in a single column."},{"pos":[2012,2397],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DataGridViewProgrammaticSort#00<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewProgrammaticSort/CS/form1.cs#00)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DataGridViewProgrammaticSort#00<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewProgrammaticSort/VB/form1.vb#00)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.Windows.Forms.DataGridViewProgrammaticSort#00](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewProgrammaticSort/CS/form1.cs#00)]\n [!code-vb[System.Windows.Forms.DataGridViewProgrammaticSort#00](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewProgrammaticSort/VB/form1.vb#00)]"},{"pos":[2406,2448],"content":"Custom Sorting Using the SortCompare Event","linkify":"Custom Sorting Using the SortCompare Event","nodes":[{"content":"Custom Sorting Using the SortCompare Event","pos":[0,42]}]},{"content":"The following code example demonstrates custom sorting using a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.SortCompare&gt;</ph> event handler.","pos":[2452,2582],"source":"The following code example demonstrates custom sorting using a <xref:System.Windows.Forms.DataGridView.SortCompare> event handler."},{"content":"The selected <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridViewColumn&gt;</ph> is sorted and, if there are duplicate values in the column, the ID column is used to determine the final order.","pos":[2583,2754],"source":" The selected <xref:System.Windows.Forms.DataGridViewColumn> is sorted and, if there are duplicate values in the column, the ID column is used to determine the final order."},{"pos":[2761,3130],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DataGridView.SortCompare#00<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.SortCompare/CS/form1.cs#00)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DataGridView.SortCompare#00<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.SortCompare/VB/form1.vb#00)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.Windows.Forms.DataGridView.SortCompare#00](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.SortCompare/CS/form1.cs#00)]\n [!code-vb[System.Windows.Forms.DataGridView.SortCompare#00](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.SortCompare/VB/form1.vb#00)]"},{"pos":[3139,3183],"content":"Custom Sorting Using the IComparer Interface","linkify":"Custom Sorting Using the IComparer Interface","nodes":[{"content":"Custom Sorting Using the IComparer Interface","pos":[0,44]}]},{"pos":[3187,3460],"content":"The following code example demonstrates custom sorting using the <ph id=\"ph1\">`Sort(IComparer)`</ph> overload of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView.Sort%2A&gt;</ph> method, which takes an implementation of the <ph id=\"ph3\">&lt;xref:System.Collections.IComparer&gt;</ph> interface to perform a multiple-column sort.","source":"The following code example demonstrates custom sorting using the `Sort(IComparer)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method, which takes an implementation of the <xref:System.Collections.IComparer> interface to perform a multiple-column sort."},{"pos":[3467,3840],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DataGridViewIComparerSort#00<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewIComparerSort/CS/form1.cs#00)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DataGridViewIComparerSort#00<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewIComparerSort/VB/form1.vb#00)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.Windows.Forms.DataGridViewIComparerSort#00](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewIComparerSort/CS/form1.cs#00)]\n [!code-vb[System.Windows.Forms.DataGridViewIComparerSort#00](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewIComparerSort/VB/form1.vb#00)]"},{"pos":[3849,3867],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"These examples require:","pos":[3871,3894]},{"content":"References to the System, System.Drawing, and System.Windows.Forms assemblies.","pos":[3904,3982]},{"content":"For information about building these examples from the command line for <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]</ph> or <ph id=\"ph2\">[!INCLUDE[csprcs](../../../../includes/csprcs-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Building from the Command Line<ept id=\"p1\">](~/docs/visual-basic/reference/command-line-compiler/building-from-the-command-line.md)</ept> or <bpt id=\"p2\">[</bpt>Command-line Building With csc.exe<ept id=\"p2\">](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)</ept>.","pos":[3989,4426],"source":"For information about building these examples from the command line for [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)] or [!INCLUDE[csprcs](../../../../includes/csprcs-md.md)], see [Building from the Command Line](~/docs/visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)."},{"content":"You can also build this example in <ph id=\"ph1\">[!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)]</ph> by pasting the code into a new project.","pos":[4427,4555],"source":" You can also build this example in [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] by pasting the code into a new project."},{"content":"Also see <bpt id=\"p1\">[</bpt>How to: Compile and Run a Complete Windows Forms Code Example Using Visual Studio<ept id=\"p1\">](http://msdn.microsoft.com/library/Bb129228\\(v=vs.110\\))</ept>.","pos":[4557,4706],"source":"  Also see [How to: Compile and Run a Complete Windows Forms Code Example Using Visual Studio](http://msdn.microsoft.com/library/Bb129228\\(v=vs.110\\))."},{"pos":[4715,4723],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph>","pos":[4727,4767],"source":"<xref:System.Windows.Forms.DataGridView> "},{"content":"<bpt id=\"p1\"> [</bpt>Sorting Data in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/sorting-data-in-the-windows-forms-datagridview-control.md)</ept><ph id=\"ph1\"> </ph>","pos":[4771,4933],"source":" [Sorting Data in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/sorting-data-in-the-windows-forms-datagridview-control.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Column Sort Modes in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/column-sort-modes-in-the-windows-forms-datagridview-control.md)</ept><ph id=\"ph1\"> </ph>","pos":[4936,5108],"source":" [Column Sort Modes in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/column-sort-modes-in-the-windows-forms-datagridview-control.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Set the Sort Modes for Columns in the Windows Forms DataGridView Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/set-the-sort-modes-for-columns-wf-datagridview-control.md)</ept>","pos":[5111,5298],"source":" [How to: Set the Sort Modes for Columns in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/set-the-sort-modes-for-columns-wf-datagridview-control.md)"}]}