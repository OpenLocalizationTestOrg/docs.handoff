{"content":"---\ntitle: \"How to: Reference COM Objects from Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"COM interop [Visual Basic], referencing COM objects\"\n  - \"referencing objects, COM objects from Visual Basic\"\n  - \"objects [Visual Basic], referencing\"\n  - \"COM objects, referencing\"\n  - \"interop assemblies\"\nms.assetid: 9c518fb4-27d9-4112-9e6a-5a7d0210af6f\n---\n# How to: Reference COM Objects from Visual Basic\nIn Visual Basic, adding references to COM objects that have type libraries requires the creation of an interop assembly for the COM library. References to the members of the COM object are routed to the interop assembly and then forwarded to the actual COM object. Responses from the COM object are routed to the interop assembly and forwarded to your [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] application.  \n  \n You can reference a COM object without using an interop assembly by embedding the type information for the COM object in a .NET assembly. To embed type information, set the `Embed Interop Types` property to `True` for the reference to the COM object. If you are compiling by using the command-line compiler, use the `/link` option to reference the COM library. For more information, see [/link (Visual Basic)](../../../visual-basic/reference/command-line-compiler/link.md).  \n  \n Visual Basic automatically creates interop assemblies when you add a reference to a type library from the integrated development environment (IDE). When working from the command line, you can use the Tlbimp utility to manually create interop assemblies.  \n  \n### To add references to COM objects  \n  \n1.  On the **Project** menu, choose **Add Reference** and then click the **COM** tab in the dialog box.  \n  \n2.  Select the component you want to use from the list of COM objects.  \n  \n3.  To simplify access to the interop assembly, add an `Imports` statement to the top of the class or module in which you will use the COM object. For example, the following code example imports the namespace `INKEDLib` for objects referenced in the `Microsoft InkEdit Control 1.0` library.  \n  \n     [!code-vb[VbVbalrInterop#40](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#40)]  \n  \n### To create an interop assembly using Tlbimp  \n  \n1.  Add the location of Tlbimp to the search path, if it is not already part of the search path and you are not currently in the directory where it is located.  \n  \n2.  Call Tlbimp from a command prompt, providing the following information:  \n  \n    -   Name and location of the DLL that contains the type library  \n  \n    -   Name and location of the namespace where the information should be placed  \n  \n    -   Name and location of the target interop assembly  \n  \n     The following code provides an example:  \n  \n    ```  \n    Tlbimp test3.dll /out:NameSpace1 /out:Interop1.dll  \n    ```  \n  \n     You can use Tlbimp to create interop assemblies for type libraries, even for unregistered COM objects. However, the COM objects referred to by interop assemblies must be properly registered on the computer where they are to be used. You can register a COM object by using the Regsvr32 utility included with the Windows operating system.  \n  \n## See also\n\n- [COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)\n- [Tlbimp.exe (Type Library Importer)](../../../framework/tools/tlbimp-exe-type-library-importer.md)\n- [Tlbexp.exe (Type Library Exporter)](../../../framework/tools/tlbexp-exe-type-library-exporter.md)\n- [Walkthrough: Implementing Inheritance with COM Objects](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)\n- [Troubleshooting Interoperability](../../../visual-basic/programming-guide/com-interop/troubleshooting-interoperability.md)\n- [Imports Statement (.NET Namespace and Type)](../../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md)\n","nodes":[{"pos":[4,364],"embed":true,"restype":"x-metadata","content":"title: \"How to: Reference COM Objects from Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"COM interop [Visual Basic], referencing COM objects\"\n  - \"referencing objects, COM objects from Visual Basic\"\n  - \"objects [Visual Basic], referencing\"\n  - \"COM objects, referencing\"\n  - \"interop assemblies\"\nms.assetid: 9c518fb4-27d9-4112-9e6a-5a7d0210af6f","nodes":[{"content":"How to: Reference COM Objects from Visual Basic","nodes":[{"pos":[0,47],"content":"How to: Reference COM Objects from Visual Basic","nodes":[{"content":"How to: Reference COM Objects from Visual Basic","pos":[0,47]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[371,418],"content":"How to: Reference COM Objects from Visual Basic","linkify":"How to: Reference COM Objects from Visual Basic","nodes":[{"content":"How to: Reference COM Objects from Visual Basic","pos":[0,47]}]},{"content":"In Visual Basic, adding references to COM objects that have type libraries requires the creation of an interop assembly for the COM library.","pos":[419,559]},{"content":"References to the members of the COM object are routed to the interop assembly and then forwarded to the actual COM object.","pos":[560,683]},{"content":"Responses from the COM object are routed to the interop assembly and forwarded to your <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> application.","pos":[684,837],"source":" Responses from the COM object are routed to the interop assembly and forwarded to your [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] application."},{"content":"You can reference a COM object without using an interop assembly by embedding the type information for the COM object in a .NET assembly.","pos":[844,981]},{"content":"To embed type information, set the <ph id=\"ph1\">`Embed Interop Types`</ph> property to <ph id=\"ph2\">`True`</ph> for the reference to the COM object.","pos":[982,1094],"source":" To embed type information, set the `Embed Interop Types` property to `True` for the reference to the COM object."},{"content":"If you are compiling by using the command-line compiler, use the <ph id=\"ph1\">`/link`</ph> option to reference the COM library.","pos":[1095,1204],"source":" If you are compiling by using the command-line compiler, use the `/link` option to reference the COM library."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>/link (Visual Basic)<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/link.md)</ept>.","pos":[1205,1317],"source":" For more information, see [/link (Visual Basic)](../../../visual-basic/reference/command-line-compiler/link.md)."},{"content":"Visual Basic automatically creates interop assemblies when you add a reference to a type library from the integrated development environment (IDE).","pos":[1324,1471]},{"content":"When working from the command line, you can use the Tlbimp utility to manually create interop assemblies.","pos":[1472,1577]},{"pos":[1587,1619],"content":"To add references to COM objects","linkify":"To add references to COM objects","nodes":[{"content":"To add references to COM objects","pos":[0,32]}]},{"pos":[1629,1728],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Add Reference<ept id=\"p2\">**</ept> and then click the <bpt id=\"p3\">**</bpt>COM<ept id=\"p3\">**</ept> tab in the dialog box.","source":"On the **Project** menu, choose **Add Reference** and then click the **COM** tab in the dialog box."},{"content":"Select the component you want to use from the list of COM objects.","pos":[1738,1804]},{"content":"To simplify access to the interop assembly, add an <ph id=\"ph1\">`Imports`</ph> statement to the top of the class or module in which you will use the COM object.","pos":[1814,1956],"source":"To simplify access to the interop assembly, add an `Imports` statement to the top of the class or module in which you will use the COM object."},{"content":"For example, the following code example imports the namespace <ph id=\"ph1\">`INKEDLib`</ph> for objects referenced in the <ph id=\"ph2\">`Microsoft InkEdit Control 1.0`</ph> library.","pos":[1957,2100],"source":" For example, the following code example imports the namespace `INKEDLib` for objects referenced in the `Microsoft InkEdit Control 1.0` library."},{"pos":[2234,2276],"content":"To create an interop assembly using Tlbimp","linkify":"To create an interop assembly using Tlbimp","nodes":[{"content":"To create an interop assembly using Tlbimp","pos":[0,42]}]},{"content":"Add the location of Tlbimp to the search path, if it is not already part of the search path and you are not currently in the directory where it is located.","pos":[2286,2441]},{"content":"Call Tlbimp from a command prompt, providing the following information:","pos":[2451,2522]},{"content":"Name and location of the DLL that contains the type library","pos":[2536,2595]},{"content":"Name and location of the namespace where the information should be placed","pos":[2609,2682]},{"content":"Name and location of the target interop assembly","pos":[2696,2744]},{"content":"The following code provides an example:","pos":[2755,2794]},{"content":"You can use Tlbimp to create interop assemblies for type libraries, even for unregistered COM objects.","pos":[2885,2987]},{"content":"However, the COM objects referred to by interop assemblies must be properly registered on the computer where they are to be used.","pos":[2988,3117]},{"content":"You can register a COM object by using the Regsvr32 utility included with the Windows operating system.","pos":[3118,3221]},{"pos":[3230,3238],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3242,3317],"content":"<bpt id=\"p1\">[</bpt>COM Interop<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/index.md)</ept>","source":"[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)"},{"pos":[3320,3418],"content":"<bpt id=\"p1\">[</bpt>Tlbimp.exe (Type Library Importer)<ept id=\"p1\">](../../../framework/tools/tlbimp-exe-type-library-importer.md)</ept>","source":"[Tlbimp.exe (Type Library Importer)](../../../framework/tools/tlbimp-exe-type-library-importer.md)"},{"pos":[3421,3519],"content":"<bpt id=\"p1\">[</bpt>Tlbexp.exe (Type Library Exporter)<ept id=\"p1\">](../../../framework/tools/tlbexp-exe-type-library-exporter.md)</ept>","source":"[Tlbexp.exe (Type Library Exporter)](../../../framework/tools/tlbexp-exe-type-library-exporter.md)"},{"pos":[3522,3688],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Implementing Inheritance with COM Objects<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)</ept>","source":"[Walkthrough: Implementing Inheritance with COM Objects](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)"},{"pos":[3691,3814],"content":"<bpt id=\"p1\">[</bpt>Troubleshooting Interoperability<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/troubleshooting-interoperability.md)</ept>","source":"[Troubleshooting Interoperability](../../../visual-basic/programming-guide/com-interop/troubleshooting-interoperability.md)"},{"pos":[3817,3959],"content":"<bpt id=\"p1\">[</bpt>Imports Statement (.NET Namespace and Type)<ept id=\"p1\">](../../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md)</ept>","source":"[Imports Statement (.NET Namespace and Type)](../../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md)"}]}