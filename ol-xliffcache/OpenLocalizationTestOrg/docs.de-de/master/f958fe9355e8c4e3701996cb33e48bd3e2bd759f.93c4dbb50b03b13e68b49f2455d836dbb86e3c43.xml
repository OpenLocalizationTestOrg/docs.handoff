{"content":"---\ntitle: \"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"registry [Visual Basic]\"\nms.assetid: 4a0dcce0-c27b-4199-baa8-ee4528da6a56\n---\n# Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)\nAlthough `My.Computer.Registry` should cover your basic needs when programming against the registry, you can also use the <xref:Microsoft.Win32.Registry> and <xref:Microsoft.Win32.RegistryKey> classes in the <xref:Microsoft.Win32> namespace of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)].  \n  \n## Keys in the Registry Class  \n The <xref:Microsoft.Win32.Registry> class supplies the base registry keys that can be used to access subkeys and their values. The base keys themselves are read-only. The following table lists and describes the seven keys exposed by the <xref:Microsoft.Win32.Registry> class.  \n  \n|**Key**|**Description**|  \n|-------------|---------------------|  \n|<xref:Microsoft.Win32.Registry.ClassesRoot>|Defines the types of documents and the properties associated with those types.|  \n|<xref:Microsoft.Win32.Registry.CurrentConfig>|Contains hardware configuration information that is not user-specific.|  \n|<xref:Microsoft.Win32.Registry.CurrentUser>|Contains information about the current user preferences, such as environmental variables.|  \n|<xref:Microsoft.Win32.Registry.DynData>|Contains dynamic registry data, such as that used by Virtual Device Drivers.|  \n|<xref:Microsoft.Win32.Registry.LocalMachine>|Contains five subkeys (Hardware, SAM, Security, Software, and System) that hold the configuration data for the local computer.|  \n|<xref:Microsoft.Win32.Registry.PerformanceData>|Contains performance information for software components.|  \n|<xref:Microsoft.Win32.Registry.Users>|Contains information about the default user preferences.|  \n  \n> [!IMPORTANT]\n>  It is more secure to write data to the current user (<xref:Microsoft.Win32.Registry.CurrentUser>) than to the local computer (<xref:Microsoft.Win32.Registry.LocalMachine>). A condition that's typically referred to as \"squatting\" occurs when the key you are creating was previously created by another, possibly malicious, process. To prevent this from occurring, use a method, such as <xref:Microsoft.Win32.RegistryKey.GetValue%2A>, that returns `Nothing` if the key does not already exist.  \n  \n## Reading a Value from the Registry  \n The following code shows how to read a string from HKEY_CURRENT_USER.  \n  \n [!code-vb[VbResourceTasks#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbResourceTasks/VB/Class1.vb#20)]  \n  \n The following code reads, increments, and then writes a string to HKEY_CURRENT_USER.  \n  \n [!code-vb[VbResourceTasks#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbResourceTasks/VB/Class1.vb#21)]  \n  \n## See also\n\n- <xref:System.SystemException>\n- <xref:System.ApplicationException>\n- <xref:Microsoft.VisualBasic.MyServices.RegistryProxy>\n- [Try...Catch...Finally Statement](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)\n- [Reading from and Writing to the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)\n- [Security and the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/security-and-the-registry.md)\n","nodes":[{"pos":[4,225],"embed":true,"restype":"x-metadata","content":"title: \"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"registry [Visual Basic]\"\nms.assetid: 4a0dcce0-c27b-4199-baa8-ee4528da6a56","nodes":[{"content":"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)","nodes":[{"pos":[0,91],"content":"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)","nodes":[{"content":"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)","pos":[0,91]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[232,323],"content":"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)","linkify":"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)","nodes":[{"content":"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)","pos":[0,91]}]},{"pos":[324,626],"content":"Although <ph id=\"ph1\">`My.Computer.Registry`</ph> should cover your basic needs when programming against the registry, you can also use the <ph id=\"ph2\">&lt;xref:Microsoft.Win32.Registry&gt;</ph> and <ph id=\"ph3\">&lt;xref:Microsoft.Win32.RegistryKey&gt;</ph> classes in the <ph id=\"ph4\">&lt;xref:Microsoft.Win32&gt;</ph> namespace of the <ph id=\"ph5\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph>.","source":"Although `My.Computer.Registry` should cover your basic needs when programming against the registry, you can also use the <xref:Microsoft.Win32.Registry> and <xref:Microsoft.Win32.RegistryKey> classes in the <xref:Microsoft.Win32> namespace of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]."},{"pos":[635,661],"content":"Keys in the Registry Class","linkify":"Keys in the Registry Class","nodes":[{"content":"Keys in the Registry Class","pos":[0,26]}]},{"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.Win32.Registry&gt;</ph> class supplies the base registry keys that can be used to access subkeys and their values.","pos":[665,791],"source":"The <xref:Microsoft.Win32.Registry> class supplies the base registry keys that can be used to access subkeys and their values."},{"content":"The base keys themselves are read-only.","pos":[792,831]},{"content":"The following table lists and describes the seven keys exposed by the <ph id=\"ph1\">&lt;xref:Microsoft.Win32.Registry&gt;</ph> class.","pos":[832,940],"source":" The following table lists and describes the seven keys exposed by the <xref:Microsoft.Win32.Registry> class."},{"pos":[947,954],"content":"<bpt id=\"p1\">**</bpt>Key<ept id=\"p1\">**</ept>","source":"**Key**"},{"pos":[955,970],"content":"<bpt id=\"p1\">**</bpt>Description<ept id=\"p1\">**</ept>","source":"**Description**"},{"content":"Defines the types of documents and the properties associated with those types.","pos":[1059,1137]},{"content":"Contains hardware configuration information that is not user-specific.","pos":[1188,1258]},{"content":"Contains information about the current user preferences, such as environmental variables.","pos":[1307,1396]},{"content":"Contains dynamic registry data, such as that used by Virtual Device Drivers.","pos":[1441,1517]},{"content":"Contains five subkeys (Hardware, SAM, Security, Software, and System) that hold the configuration data for the local computer.","pos":[1567,1693]},{"content":"Contains performance information for software components.","pos":[1746,1803]},{"content":"Contains information about the default user preferences.","pos":[1846,1902]},{"pos":[1911,2416],"content":"[!IMPORTANT]\n It is more secure to write data to the current user (<xref:Microsoft.Win32.Registry.CurrentUser>) than to the local computer (<xref:Microsoft.Win32.Registry.LocalMachine>). A condition that's typically referred to as \"squatting\" occurs when the key you are creating was previously created by another, possibly malicious, process. To prevent this from occurring, use a method, such as <xref:Microsoft.Win32.RegistryKey.GetValue%2A>, that returns `Nothing` if the key does not already exist.","leadings":["","> "],"nodes":[{"content":"It is more secure to write data to the current user (<xref:Microsoft.Win32.Registry.CurrentUser>) than to the local computer (<xref:Microsoft.Win32.Registry.LocalMachine>). A condition that's typically referred to as \"squatting\" occurs when the key you are creating was previously created by another, possibly malicious, process. To prevent this from occurring, use a method, such as <xref:Microsoft.Win32.RegistryKey.GetValue%2A>, that returns `Nothing` if the key does not already exist.","pos":[14,503],"nodes":[{"content":"It is more secure to write data to the current user (<ph id=\"ph1\">&lt;xref:Microsoft.Win32.Registry.CurrentUser&gt;</ph>) than to the local computer (<ph id=\"ph2\">&lt;xref:Microsoft.Win32.Registry.LocalMachine&gt;</ph>).","pos":[0,172],"source":"It is more secure to write data to the current user (<xref:Microsoft.Win32.Registry.CurrentUser>) than to the local computer (<xref:Microsoft.Win32.Registry.LocalMachine>)."},{"content":"A condition that's typically referred to as \"squatting\" occurs when the key you are creating was previously created by another, possibly malicious, process.","pos":[173,329]},{"content":"To prevent this from occurring, use a method, such as <ph id=\"ph1\">&lt;xref:Microsoft.Win32.RegistryKey.GetValue%2A&gt;</ph>, that returns <ph id=\"ph2\">`Nothing`</ph> if the key does not already exist.","pos":[330,489],"source":" To prevent this from occurring, use a method, such as <xref:Microsoft.Win32.RegistryKey.GetValue%2A>, that returns `Nothing` if the key does not already exist."}]}]},{"pos":[2425,2458],"content":"Reading a Value from the Registry","linkify":"Reading a Value from the Registry","nodes":[{"content":"Reading a Value from the Registry","pos":[0,33]}]},{"content":"The following code shows how to read a string from HKEY_CURRENT_USER.","pos":[2462,2531]},{"content":"The following code reads, increments, and then writes a string to HKEY_CURRENT_USER.","pos":[2660,2744]},{"pos":[2875,2883],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3012,3132],"content":"<bpt id=\"p1\">[</bpt>Try...Catch...Finally Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)</ept>","source":"[Try...Catch...Finally Statement](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)"},{"pos":[3135,3294],"content":"<bpt id=\"p1\">[</bpt>Reading from and Writing to the Registry<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)</ept>","source":"[Reading from and Writing to the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)"},{"pos":[3297,3426],"content":"<bpt id=\"p1\">[</bpt>Security and the Registry<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/security-and-the-registry.md)</ept>","source":"[Security and the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/security-and-the-registry.md)"}]}