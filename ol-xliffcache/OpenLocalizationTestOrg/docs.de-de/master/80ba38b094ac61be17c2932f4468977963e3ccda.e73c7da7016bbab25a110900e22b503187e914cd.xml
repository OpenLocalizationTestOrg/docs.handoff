{"content":"---\ntitle: \"ASP.NET Compatibility | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: c8b51f1e-c096-4c42-ad99-0519887bbbc5\ncaps.latest.revision: 25\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# ASP.NET Compatibility\nThis sample demonstrates how to enable [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Compatibility mode in [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]. Services running in [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Compatibility mode participate fully in the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] application pipeline and can make use of [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] features such as file/URL authorization, session state, and the <xref:System.Web.HttpContext> class. The <xref:System.Web.HttpContext> class allows access to cookies, sessions, and other [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] features. This mode requires that the bindings use the HTTP transport and the service itself must be hosted in IIS.  \n  \n In this sample, the client is a console application (an executable) and the service is hosted in Internet Information Services (IIS).  \n  \n> [!NOTE]\n>  The set-up procedure and build instructions for this sample are located at the end of this topic.  \n  \n> [!NOTE]\n>  This sample requires a [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)] application pool in order to run. To create a new application pool, or to modify the default application pool, follow these steps.  \n>   \n>  1.  Open **Control Panel**.  Open the **Administrative Tools** applet under the **System and Security** heading. Open the **Internet Information Services (IIS) Manager** applet.  \n> 2.  Expand the treeview in the **Connections** pane. Select the **Application Pools** node.  \n> 3.  To set the default application pool to use [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)] (which may cause incompatibility problems with existing sites), right-click the **DefaultAppPool** list item and select **Basic Settings…**. Set the **.Net Framework Version** pull-down to **.Net Framework v4.0.30128** (or later).  \n> 4.  To create a new application pool that uses [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)] (to preserve compatibility for other applications), right-click the **Application Pools** node and select **Add Application Pool…**. Name the new application pool, and set the **.Net Framework Version** pull-down to **.Net Framework v4.0.30128** (or later). After running the setup steps below, right-click the **ServiceModelSamples** application and select **Manage Application**, **Advanced Settings…**. Set the **Application Pool** to the new application pool.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your computer. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\Services\\Hosting\\WebHost\\ASPNetCompatibility`  \n  \n This sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md), which implements a calculator service. The `ICalculator` contract has been modified as the `ICalculatorSession` contract to allow a set of operations to be performed, while keeping a running result.  \n  \n```  \n[ServiceContract(Namespace=\"http://Microsoft.ServiceModel.Samples\")]  \npublic interface ICalculatorSession  \n{  \n    [OperationContract]  \n    void Clear();  \n    [OperationContract]  \n    void AddTo(double n);  \n    [OperationContract]  \n    void SubtractFrom(double n);  \n    [OperationContract]  \n    void MultiplyBy(double n);  \n    [OperationContract]  \n    void DivideBy(double n);  \n    [OperationContract]  \n    double Result();  \n}  \n  \n```  \n  \n The service maintains state, using the feature, for each client as multiple service operations are called to perform a calculation. The client can retrieve the current result by calling `Result` and can clear the result to zero by calling `Clear`.  \n  \n The service uses the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] session to store the result for each client session. This allows the service to maintain the running result for each client across multiple calls to the service.  \n  \n> [!NOTE]\n>  [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] session state and [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] sessions are very different things.  See the [Session](../../../../docs/framework/wcf/samples/session.md) for details on [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] sessions.  \n  \n The service has an intimate dependency on [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] session state and requires [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] compatibility mode to function correctly. These requirements are expressed declaratively by applying the `AspNetCompatibilityRequirements` attribute.  \n  \n```  \n[AspNetCompatibilityRequirements(RequirementsMode =  \n                       AspNetCompatibilityRequirementsMode.Required)]  \npublic class CalculatorService : ICalculatorSession  \n{  \n    double Result  \n    {  // store result in AspNet Session  \n       get {  \n          if (HttpContext.Current.Session[\"Result\"] != null)  \n             return (double)HttpContext.Current.Session[\"Result\"];  \n          return 0.0D;  \n       }  \n       set  \n       {  \n          HttpContext.Current.Session[\"Result\"] = value;  \n       }  \n    }  \n    public void Clear()  \n    {  \n        Result = 0.0D;  \n    }  \n    public void AddTo(double n)  \n    {  \n        Result += n;  \n    }  \n    public void SubtractFrom(double n)  \n    {  \n        Result -= n;  \n    }  \n    public void MultiplyBy(double n)  \n    {  \n        Result *= n;  \n    }  \n    public void DivideBy(double n)  \n    {  \n        Result /= n;  \n    }  \n    public double Result()  \n    {  \n        return Result;  \n    }  \n}  \n```  \n  \n When you run the sample, the operation requests and responses are displayed in the client console window. Press ENTER in the client window to shut down the client.  \n  \n```  \n  \n0, + 100, - 50, * 17.65, / 2 = 441.25  \nPress <ENTER> to terminate client.  \n  \n```  \n  \n### To set up, build, and run the sample  \n  \n1.  Be sure you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md).  \n  \n2.  To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md).  \n  \n3.  After the solution has been built, run Setup.bat to set up the ServiceModelSamples Application in [!INCLUDE[iisver](../../../../includes/iisver-md.md)]. The ServiceModelSamples directory should now appear as an [!INCLUDE[iisver](../../../../includes/iisver-md.md)] Application.  \n  \n4.  To run the sample in a single- or cross-computer configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md).  \n  \n## See Also  \n [AppFabric Hosting and Persistence Samples](http://go.microsoft.com/fwlink/?LinkId=193961)","nodes":[{"pos":[12,50],"content":"ASP.NET Compatibility | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ASP.NET Compatibility | Microsoft Docs","pos":[0,38]}]},{"pos":[349,370],"content":"ASP.NET Compatibility","linkify":"ASP.NET Compatibility","nodes":[{"content":"ASP.NET Compatibility","pos":[0,21]}]},{"content":"This sample demonstrates how to enable <ph id=\"ph1\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> Compatibility mode in <ph id=\"ph2\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph>.","pos":[371,546],"source":"This sample demonstrates how to enable [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Compatibility mode in [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]."},{"content":"Services running in <ph id=\"ph1\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> Compatibility mode participate fully in the <ph id=\"ph2\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> application pipeline and can make use of <ph id=\"ph3\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> features such as file/URL authorization, session state, and the <ph id=\"ph4\">&lt;xref:System.Web.HttpContext&gt;</ph> class.","pos":[547,926],"source":" Services running in [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Compatibility mode participate fully in the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] application pipeline and can make use of [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] features such as file/URL authorization, session state, and the <xref:System.Web.HttpContext> class."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Web.HttpContext&gt;</ph> class allows access to cookies, sessions, and other <ph id=\"ph2\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> features.","pos":[927,1080],"source":" The <xref:System.Web.HttpContext> class allows access to cookies, sessions, and other [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] features."},{"content":"This mode requires that the bindings use the HTTP transport and the service itself must be hosted in IIS.","pos":[1081,1186]},{"content":"In this sample, the client is a console application (an executable) and the service is hosted in Internet Information Services (IIS).","pos":[1193,1326]},{"pos":[1334,1442],"content":"[!NOTE]\n The set-up procedure and build instructions for this sample are located at the end of this topic.","leadings":["","> "],"nodes":[{"content":"The set-up procedure and build instructions for this sample are located at the end of this topic.","pos":[9,106]}]},{"pos":[1450,1680],"content":"[!NOTE]\n This sample requires a [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)] application pool in order to run. To create a new application pool, or to modify the default application pool, follow these steps.","leadings":["","> "],"nodes":[{"content":" This sample requires a [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)] application pool in order to run. To create a new application pool, or to modify the default application pool, follow these steps.","pos":[8,228],"nodes":[{"content":"This sample requires a <ph id=\"ph1\">[!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)]</ph> application pool in order to run.","pos":[1,123],"source":" This sample requires a [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)] application pool in order to run."},{"content":"To create a new application pool, or to modify the default application pool, follow these steps.","pos":[124,220]}]}]},{"content":"Open <bpt id=\"p1\">**</bpt>Control Panel<ept id=\"p1\">**</ept>.","pos":[1695,1718],"source":"Open **Control Panel**."},{"content":"Open the <bpt id=\"p1\">**</bpt>Administrative Tools<ept id=\"p1\">**</ept> applet under the <bpt id=\"p2\">**</bpt>System and Security<ept id=\"p2\">**</ept> heading.","pos":[1720,1803],"source":"  Open the **Administrative Tools** applet under the **System and Security** heading."},{"content":"Open the <bpt id=\"p1\">**</bpt>Internet Information Services (IIS) Manager<ept id=\"p1\">**</ept> applet.","pos":[1804,1868],"source":" Open the **Internet Information Services (IIS) Manager** applet."},{"content":"Expand the treeview in the <bpt id=\"p1\">**</bpt>Connections<ept id=\"p1\">**</ept> pane.","pos":[1877,1925],"source":"Expand the treeview in the **Connections** pane."},{"content":"Select the <bpt id=\"p1\">**</bpt>Application Pools<ept id=\"p1\">**</ept> node.","pos":[1926,1964],"source":" Select the **Application Pools** node."},{"content":"To set the default application pool to use <ph id=\"ph1\">[!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)]</ph> (which may cause incompatibility problems with existing sites), right-click the <bpt id=\"p1\">**</bpt>DefaultAppPool<ept id=\"p1\">**</ept> list item and select <bpt id=\"p2\">**</bpt>Basic Settings…<ept id=\"p2\">**</ept>.","pos":[1973,2222],"source":"To set the default application pool to use [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)] (which may cause incompatibility problems with existing sites), right-click the **DefaultAppPool** list item and select **Basic Settings…**."},{"content":"Set the <bpt id=\"p1\">**</bpt>.Net Framework Version<ept id=\"p1\">**</ept> pull-down to <bpt id=\"p2\">**</bpt>.Net Framework v4.0.30128<ept id=\"p2\">**</ept> (or later).","pos":[2223,2312],"source":" Set the **.Net Framework Version** pull-down to **.Net Framework v4.0.30128** (or later)."},{"content":"To create a new application pool that uses <ph id=\"ph1\">[!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)]</ph> (to preserve compatibility for other applications), right-click the <bpt id=\"p1\">**</bpt>Application Pools<ept id=\"p1\">**</ept> node and select <bpt id=\"p2\">**</bpt>Add Application Pool…<ept id=\"p2\">**</ept>.","pos":[2321,2562],"source":"To create a new application pool that uses [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)] (to preserve compatibility for other applications), right-click the **Application Pools** node and select **Add Application Pool…**."},{"content":"Name the new application pool, and set the <bpt id=\"p1\">**</bpt>.Net Framework Version<ept id=\"p1\">**</ept> pull-down to <bpt id=\"p2\">**</bpt>.Net Framework v4.0.30128<ept id=\"p2\">**</ept> (or later).","pos":[2563,2687],"source":" Name the new application pool, and set the **.Net Framework Version** pull-down to **.Net Framework v4.0.30128** (or later)."},{"content":"After running the setup steps below, right-click the <bpt id=\"p1\">**</bpt>ServiceModelSamples<ept id=\"p1\">**</ept> application and select <bpt id=\"p2\">**</bpt>Manage Application<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Advanced Settings…<ept id=\"p3\">**</ept>.","pos":[2688,2835],"source":" After running the setup steps below, right-click the **ServiceModelSamples** application and select **Manage Application**, **Advanced Settings…**."},{"content":"Set the <bpt id=\"p1\">**</bpt>Application Pool<ept id=\"p1\">**</ept> to the new application pool.","pos":[2836,2893],"source":" Set the **Application Pool** to the new application pool."},{"pos":[2901,3034],"content":"[!IMPORTANT]\n The samples may already be installed on your computer. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your computer. Check for the following (default) directory before continuing.","pos":[13,131],"nodes":[{"content":"The samples may already be installed on your computer.","pos":[1,55]},{"content":"Check for the following (default) directory before continuing.","pos":[56,118]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[3088,3414],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[3415,3465]},{"content":"This sample is based on the <bpt id=\"p1\">[</bpt>Getting Started<ept id=\"p1\">](../../../../docs/framework/wcf/samples/getting-started-sample.md)</ept>, which implements a calculator service.","pos":[3570,3721],"source":"This sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md), which implements a calculator service."},{"content":"The <ph id=\"ph1\">`ICalculator`</ph> contract has been modified as the <ph id=\"ph2\">`ICalculatorSession`</ph> contract to allow a set of operations to be performed, while keeping a running result.","pos":[3722,3881],"source":" The `ICalculator` contract has been modified as the `ICalculatorSession` contract to allow a set of operations to be performed, while keeping a running result."},{"content":"The service maintains state, using the feature, for each client as multiple service operations are called to perform a calculation.","pos":[4349,4480]},{"content":"The client can retrieve the current result by calling <ph id=\"ph1\">`Result`</ph> and can clear the result to zero by calling <ph id=\"ph2\">`Clear`</ph>.","pos":[4481,4596],"source":" The client can retrieve the current result by calling `Result` and can clear the result to zero by calling `Clear`."},{"content":"The service uses the <ph id=\"ph1\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> session to store the result for each client session.","pos":[4603,4734],"source":"The service uses the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] session to store the result for each client session."},{"content":"This allows the service to maintain the running result for each client across multiple calls to the service.","pos":[4735,4843]},{"pos":[4851,5180],"content":"[!NOTE]\n [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] session state and [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] sessions are very different things.  See the [Session](../../../../docs/framework/wcf/samples/session.md) for details on [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] sessions.","leadings":["","> "],"nodes":[{"content":" [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] session state and [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] sessions are very different things.  See the [Session](../../../../docs/framework/wcf/samples/session.md) for details on [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] sessions.","pos":[8,327],"nodes":[{"content":"<ph id=\"ph1\"> [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> session state and <ph id=\"ph2\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> sessions are very different things.","pos":[0,168],"source":" [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] session state and [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] sessions are very different things."},{"content":"See the <bpt id=\"p1\">[</bpt>Session<ept id=\"p1\">](../../../../docs/framework/wcf/samples/session.md)</ept> for details on <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> sessions.","pos":[170,319],"source":"  See the [Session](../../../../docs/framework/wcf/samples/session.md) for details on [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] sessions."}]}]},{"content":"The service has an intimate dependency on <ph id=\"ph1\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> session state and requires <ph id=\"ph2\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> compatibility mode to function correctly.","pos":[5187,5413],"source":"The service has an intimate dependency on [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] session state and requires [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] compatibility mode to function correctly."},{"content":"These requirements are expressed declaratively by applying the <ph id=\"ph1\">`AspNetCompatibilityRequirements`</ph> attribute.","pos":[5414,5521],"source":" These requirements are expressed declaratively by applying the `AspNetCompatibilityRequirements` attribute."},{"content":"When you run the sample, the operation requests and responses are displayed in the client console window.","pos":[6523,6628]},{"content":"Press ENTER in the client window to shut down the client.","pos":[6629,6686]},{"pos":[6794,6830],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"pos":[6840,7035],"content":"Be sure you have performed the <bpt id=\"p1\">[</bpt>One-Time Setup Procedure for the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)</ept>.","source":"Be sure you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)."},{"pos":[7045,7254],"content":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in <bpt id=\"p1\">[</bpt>Building the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/building-the-samples.md)</ept>.","source":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md)."},{"content":"After the solution has been built, run Setup.bat to set up the ServiceModelSamples Application in <ph id=\"ph1\">[!INCLUDE[iisver](../../../../includes/iisver-md.md)]</ph>.","pos":[7264,7416],"source":"After the solution has been built, run Setup.bat to set up the ServiceModelSamples Application in [!INCLUDE[iisver](../../../../includes/iisver-md.md)]."},{"content":"The ServiceModelSamples directory should now appear as an <ph id=\"ph1\">[!INCLUDE[iisver](../../../../includes/iisver-md.md)]</ph> Application.","pos":[7417,7541],"source":" The ServiceModelSamples directory should now appear as an [!INCLUDE[iisver](../../../../includes/iisver-md.md)] Application."},{"pos":[7551,7760],"content":"To run the sample in a single- or cross-computer configuration, follow the instructions in <bpt id=\"p1\">[</bpt>Running the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/running-the-samples.md)</ept>.","source":"To run the sample in a single- or cross-computer configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md)."},{"pos":[7769,7777],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[7781,7871],"content":"<bpt id=\"p1\">[</bpt>AppFabric Hosting and Persistence Samples<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=193961)</ept>","source":"[AppFabric Hosting and Persistence Samples](http://go.microsoft.com/fwlink/?LinkId=193961)"}]}