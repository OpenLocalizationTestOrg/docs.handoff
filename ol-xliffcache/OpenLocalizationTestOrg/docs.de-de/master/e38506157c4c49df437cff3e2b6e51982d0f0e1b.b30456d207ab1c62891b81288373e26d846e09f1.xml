{"content":"---\ntitle: \"Qualifying .NET Types for Interoperation | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"exposing .NET Framework components to COM\"\n  - \"COM interop, qualifying .NET types\"\n  - \"qualifying .NET types for interoperation\"\n  - \"interoperation with unmanaged code, qualifying .NET types\"\n  - \"interoperation with unmanaged code, exposing .NET Framework components\"\n  - \"COM interop, exposing COM components\"\nms.assetid: 4b8afb52-fb8d-4e65-b47c-fd82956a3cdd\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Qualifying .NET Types for Interoperation\nIf you intend to expose types in an assembly to COM applications, consider the requirements of COM interop at design time. Managed types (class, interface, structure, and enumeration) seamlessly integrate with COM types when you adhere to the following guidelines:  \n  \n-   Classes should implement interfaces explicitly.  \n  \n     Although COM interop provides a mechanism to automatically generate an interface containing all members of the class and the members of its base class, it is far better to provide explicit interfaces. The automatically generated interface is called the class interface. For guidelines, see [Introducing the Class Interface](http://msdn.microsoft.com/en-us/733c0dd2-12e5-46e6-8de1-39d5b25df024).  \n  \n     You can use [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)], C#, and C++ to incorporate interface definitions in your code, instead of having to use Interface Definition Language (IDL) or its equivalent. For syntax details, see your language documentation.  \n  \n-   Managed types must be public.  \n  \n     Only public types in an assembly are registered and exported to the type library. As a result, only public types are visible to COM.  \n  \n     Managed types expose features to other managed code that might not be exposed to COM. For instance, parameterized constructors, static methods, and constant fields are not exposed to COM clients. Further, as the runtime marshals data in and out of a type, the data might be copied or transformed.  \n  \n-   Methods, properties, fields, and events must be public.  \n  \n     Members of public types must also be public if they are to be visible to COM. You can restrict the visibility of an assembly, a public type, or public members of a public type by applying the <xref:System.Runtime.InteropServices.ComVisibleAttribute>. By default, all public types and members are visible.  \n  \n-   Types must have a public default constructor to be activated from COM.  \n  \n     Managed, public types are visible to COM. However, without a public default constructor (a constructor with no arguments), COM clients cannot create the type. COM clients can still use the type if it is activated by some other means.  \n  \n-   Types cannot be abstract.  \n  \n     Neither COM clients nor .NET clients can create abstract types.  \n  \n When exported to COM, the inheritance hierarchy of a managed type is flattened. Versioning also differs between managed and unmanaged environments. Types exposed to COM do not have the same versioning characteristics as other managed types.  \n  \n## See Also  \n <xref:System.Runtime.InteropServices.ComVisibleAttribute>   \n [Exposing .NET Framework Components to COM](../../../docs/framework/interop/exposing-dotnet-components-to-com.md)   \n [Introducing the Class Interface](http://msdn.microsoft.com/en-us/733c0dd2-12e5-46e6-8de1-39d5b25df024)   \n [Applying Interop Attributes](../../../docs/framework/interop/applying-interop-attributes.md)   \n [Packaging an Assembly for COM](../../../docs/framework/interop/packaging-an-assembly-for-com.md)","nodes":[{"pos":[12,69],"content":"Qualifying .NET Types for Interoperation | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Qualifying .NET Types for Interoperation | Microsoft Docs","pos":[0,57]}]},{"pos":[772,812],"content":"Qualifying .NET Types for Interoperation","linkify":"Qualifying .NET Types for Interoperation","nodes":[{"content":"Qualifying .NET Types for Interoperation","pos":[0,40]}]},{"content":"If you intend to expose types in an assembly to COM applications, consider the requirements of COM interop at design time.","pos":[813,935]},{"content":"Managed types (class, interface, structure, and enumeration) seamlessly integrate with COM types when you adhere to the following guidelines:","pos":[936,1077]},{"content":"Classes should implement interfaces explicitly.","pos":[1087,1134]},{"content":"Although COM interop provides a mechanism to automatically generate an interface containing all members of the class and the members of its base class, it is far better to provide explicit interfaces.","pos":[1145,1345]},{"content":"The automatically generated interface is called the class interface.","pos":[1346,1414]},{"content":"For guidelines, see <bpt id=\"p1\">[</bpt>Introducing the Class Interface<ept id=\"p1\">](http://msdn.microsoft.com/en-us/733c0dd2-12e5-46e6-8de1-39d5b25df024)</ept>.","pos":[1415,1539],"source":" For guidelines, see [Introducing the Class Interface](http://msdn.microsoft.com/en-us/733c0dd2-12e5-46e6-8de1-39d5b25df024)."},{"content":"You can use <ph id=\"ph1\">[!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)]</ph>, C#, and C++ to incorporate interface definitions in your code, instead of having to use Interface Definition Language (IDL) or its equivalent.","pos":[1550,1764],"source":"You can use [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)], C#, and C++ to incorporate interface definitions in your code, instead of having to use Interface Definition Language (IDL) or its equivalent."},{"content":"For syntax details, see your language documentation.","pos":[1765,1817]},{"content":"Managed types must be public.","pos":[1827,1856]},{"content":"Only public types in an assembly are registered and exported to the type library.","pos":[1867,1948]},{"content":"As a result, only public types are visible to COM.","pos":[1949,1999]},{"content":"Managed types expose features to other managed code that might not be exposed to COM.","pos":[2010,2095]},{"content":"For instance, parameterized constructors, static methods, and constant fields are not exposed to COM clients.","pos":[2096,2205]},{"content":"Further, as the runtime marshals data in and out of a type, the data might be copied or transformed.","pos":[2206,2306]},{"content":"Methods, properties, fields, and events must be public.","pos":[2316,2371]},{"content":"Members of public types must also be public if they are to be visible to COM.","pos":[2382,2459]},{"content":"You can restrict the visibility of an assembly, a public type, or public members of a public type by applying the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.ComVisibleAttribute&gt;</ph>.","pos":[2460,2632],"source":" You can restrict the visibility of an assembly, a public type, or public members of a public type by applying the <xref:System.Runtime.InteropServices.ComVisibleAttribute>."},{"content":"By default, all public types and members are visible.","pos":[2633,2686]},{"content":"Types must have a public default constructor to be activated from COM.","pos":[2696,2766]},{"content":"Managed, public types are visible to COM.","pos":[2777,2818]},{"content":"However, without a public default constructor (a constructor with no arguments), COM clients cannot create the type.","pos":[2819,2935]},{"content":"COM clients can still use the type if it is activated by some other means.","pos":[2936,3010]},{"content":"Types cannot be abstract.","pos":[3020,3045]},{"content":"Neither COM clients nor .NET clients can create abstract types.","pos":[3056,3119]},{"content":"When exported to COM, the inheritance hierarchy of a managed type is flattened.","pos":[3126,3205]},{"content":"Versioning also differs between managed and unmanaged environments.","pos":[3206,3273]},{"content":"Types exposed to COM do not have the same versioning characteristics as other managed types.","pos":[3274,3366]},{"pos":[3375,3383],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.ComVisibleAttribute&gt;</ph>","pos":[3387,3444],"source":"<xref:System.Runtime.InteropServices.ComVisibleAttribute> "},{"content":"<bpt id=\"p1\"> [</bpt>Exposing .NET Framework Components to COM<ept id=\"p1\">](../../../docs/framework/interop/exposing-dotnet-components-to-com.md)</ept><ph id=\"ph1\"> </ph>","pos":[3448,3563],"source":" [Exposing .NET Framework Components to COM](../../../docs/framework/interop/exposing-dotnet-components-to-com.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Introducing the Class Interface<ept id=\"p1\">](http://msdn.microsoft.com/en-us/733c0dd2-12e5-46e6-8de1-39d5b25df024)</ept><ph id=\"ph1\"> </ph>","pos":[3566,3671],"source":" [Introducing the Class Interface](http://msdn.microsoft.com/en-us/733c0dd2-12e5-46e6-8de1-39d5b25df024) "},{"content":"<bpt id=\"p1\"> [</bpt>Applying Interop Attributes<ept id=\"p1\">](../../../docs/framework/interop/applying-interop-attributes.md)</ept><ph id=\"ph1\"> </ph>","pos":[3674,3769],"source":" [Applying Interop Attributes](../../../docs/framework/interop/applying-interop-attributes.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Packaging an Assembly for COM<ept id=\"p1\">](../../../docs/framework/interop/packaging-an-assembly-for-com.md)</ept>","pos":[3772,3870],"source":" [Packaging an Assembly for COM](../../../docs/framework/interop/packaging-an-assembly-for-com.md)"}]}