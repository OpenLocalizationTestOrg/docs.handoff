{"content":"---\ntitle: \"Manipulating Files and Directories in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"files, reading text\"\n  - \"reading files, text\"\n  - \"I/O [Visual Basic], walkthroughs\"\n  - \"text, writing to files\"\n  - \"text, reading from files\"\n  - \"reading text from files, walkthroughs\"\n  - \"Visual Basic code, file access\"\n  - \"files, writing text\"\n  - \"I/O [Visual Basic], writing text to files\"\n  - \"file access, walkthroughs\"\n  - \"writing to files, walkthroughs\"\n  - \"I/O [Visual Basic], reading text from files\"\nms.assetid: cae77565-9f78-4e46-8e42-eb2f9f8e1ffd\ncaps.latest.revision: 49\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Walkthrough: Manipulating Files and Directories in Visual Basic\nThis walkthrough provides an introduction to the fundamentals of file I/O in [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]. It describes how to create a small application that lists and examines text files in a directory. For each selected text file, the application provides file attributes and the first line of content. There is an option to write information to a log file.  \n  \n This walkthrough uses members of the `My.Computer.FileSystem Object`, which are available in [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]. See <xref:Microsoft.VisualBasic.FileIO.FileSystem> for more information. At the end of the walkthrough, an equivalent example is provided that uses classes from the <xref:System.IO> namespace.  \n  \n[!INCLUDE[note_settings_general](../../../../csharp/language-reference/compiler-messages/includes/note_settings_general_md.md)]  \n  \n### To create the project  \n  \n1.  On the **File** menu, click **New Project**.  \n  \n     The **New Project** dialog box appears.  \n  \n2.  In the **Installed Templates** pane, expand **Visual Basic**, and then click **Windows**. In the **Templates** pane in the middle, click **Windows Forms Application**.  \n  \n3.  In the **Name** box, type `FileExplorer` to set the project name, and then click **OK**.  \n  \n     [!INCLUDE[vsprvs](../../../../csharp/includes/vsprvs_md.md)] adds the project to **Solution Explorer**, and the Windows Forms Designer opens.  \n  \n4.  Add the controls in the following table to the form, and set the corresponding values for their properties.  \n  \n    |Control|Property|Value|  \n    |-------------|--------------|-----------|  \n    |**ListBox**|**Name**|`filesListBox`|  \n    |**Button**|**Name**<br /><br /> **Text**|`browseButton`<br /><br /> **Browse**|  \n    |**Button**|**Name**<br /><br /> **Text**|`examineButton`<br /><br /> **Examine**|  \n    |**CheckBox**|**Name**<br /><br /> **Text**|`saveCheckBox`<br /><br /> **Save Results**|  \n    |**FolderBrowserDialog**|**Name**|`FolderBrowserDialog1`|  \n  \n### To select a folder, and list files in a folder  \n  \n1.  Create a `Click` event handler for `browseButton` by double-clicking the control on the form. The Code Editor opens.  \n  \n2.  Add the following code to the `Click` event handler.  \n  \n     [!code-vb[VbVbcnMyFileSystem#103](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_1.vb)]  \n  \n     The `FolderBrowserDialog1.ShowDialog` call opens the **Browse For Folder** dialog box. After the user clicks **OK**, the <xref:System.Windows.Forms.FolderBrowserDialog.SelectedPath%2A> property is sent as an argument to the `ListFiles` method, which is added in the next step.  \n  \n3.  Add the following `ListFiles` method.  \n  \n     [!code-vb[VbVbcnMyFileSystem#104](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_2.vb)]  \n  \n     This code first clears the **ListBox**.  \n  \n     The <xref:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles%2A> method then retrieves a collection of strings, one for each file in the directory. The `GetFiles` method accepts a search pattern argument to retrieve files that match a particular pattern. In this example, only files that have the extension .txt are returned.  \n  \n     The strings that are returned by the `GetFiles` method are then added to the **ListBox**.  \n  \n4.  Run the application. Click the **Browse** button. In the **Browse For Folder** dialog box, browse to a folder that contains .txt files, and then select the folder and click **OK**.  \n  \n     The `ListBox` contains a list of .txt files in the selected folder.  \n  \n5.  Stop running the application.  \n  \n### To obtain attributes of a file, and content from a text file  \n  \n1.  Create a `Click` event handler for `examineButton` by double-clicking the control on the form.  \n  \n2.  Add the following code to the `Click` event handler.  \n  \n     [!code-vb[VbVbcnMyFileSystem#105](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_3.vb)]  \n  \n     The code verifies that an item is selected in the `ListBox`. It then obtains the file path entry from the `ListBox`. The <xref:Microsoft.VisualBasic.FileIO.FileSystem.FileExists%2A> method is used to check whether the file still exists.  \n  \n     The file path is sent as an argument to the `GetTextForOutput` method, which is added in the next step. This method returns a string that contains file information. The file information appears in a **MessageBox**.  \n  \n3.  Add the following `GetTextForOutput` method.  \n  \n     [!code-vb[VbVbcnMyFileSystem#107](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_4.vb)]  \n  \n     The code uses the <xref:Microsoft.VisualBasic.FileIO.FileSystem.GetFileInfo%2A> method to obtain file parameters. The file parameters are added to a <xref:System.Text.StringBuilder>.  \n  \n     The <xref:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileReader%2A> method reads the file contents into a <xref:System.IO.StreamReader>. The first line of the contents is obtained from the `StreamReader` and is added to the `StringBuilder`.  \n  \n4.  Run the application. Click **Browse**, and browse to a folder that contains .txt files. Click **OK**.  \n  \n     Select a file in the `ListBox`, and then click **Examine**. A `MessageBox` shows the file information.  \n  \n5.  Stop running the application.  \n  \n### To add a log entry  \n  \n1.  Add the following code to the end of the `examineButton_Click` event handler.  \n  \n     [!code-vb[VbVbcnMyFileSystem#106](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_5.vb)]  \n  \n     The code sets the log file path to put the log file in the same directory as that of the selected file. The text of the log entry is set to the current date and time followed by the file information.  \n  \n     The <xref:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText%2A> method, with the `append` argument set to `True`, is used to create the log entry.  \n  \n2.  Run the application. Browse to a text file, select it in the `ListBox`, select the **Save Results** check box, and then click **Examine**. Verify that the log entry is written to the `log.txt` file.  \n  \n3.  Stop running the application.  \n  \n### To use the current directory  \n  \n1.  Create an event handler for `Form1_Load` by double-clicking the form.  \n  \n2.  Add the following code to the event handler.  \n  \n     [!code-vb[VbVbcnMyFileSystem#102](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_6.vb)]  \n  \n     This code sets the default directory of the folder browser to the current directory.  \n  \n3.  Run the application. When you click **Browse** the first time, the **Browse For Folder** dialog box opens to the current directory.  \n  \n4.  Stop running the application.  \n  \n### To selectively enable controls  \n  \n1.  Add the following `SetEnabled` method.  \n  \n     [!code-vb[VbVbcnMyFileSystem#108](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_7.vb)]  \n  \n     The `SetEnabled` method enables or disables controls depending on whether an item is selected in the `ListBox`.  \n  \n2.  Create a `SelectedIndexChanged` event handler for `filesListBox` by double-clicking the `ListBox` control on the form.  \n  \n3.  Add a call to `SetEnabled` in the new `filesListBox_SelectedIndexChanged` event handler.  \n  \n4.  Add a call to `SetEnabled` at the end of the `browseButton_Click` event handler.  \n  \n5.  Add a call to `SetEnabled` at the end of the `Form1_Load` event handler.  \n  \n6.  Run the application. The **Save Results** check box and the **Examine** button are disabled if an item is not selected in the `ListBox`.  \n  \n## Full example using My.Computer.FileSystem  \n Following is the complete example.  \n  \n [!code-vb[VbVbcnMyFileSystem#101](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_8.vb)]  \n  \n## Full example using System.IO  \n The following equivalent example uses classes from the <xref:System.IO> namespace instead of using `My.Computer.FileSystem` objects.  \n  \n [!code-vb[VbVbcnMyFileSystem#111](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_9.vb)]  \n  \n## See Also  \n <xref:System.IO>   \n <xref:Microsoft.VisualBasic.FileIO.FileSystem>   \n <xref:Microsoft.VisualBasic.FileIO.FileSystem.CurrentDirectory%2A>   \n [Walkthrough: Manipulating Files by Using .NET Framework Methods](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-by-using-net-framework-methods.md)\n","nodes":[{"pos":[12,79],"content":"Manipulating Files and Directories in Visual Basic | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Manipulating Files and Directories in Visual Basic | Microsoft Docs","pos":[0,67]}]},{"pos":[999,1062],"content":"Walkthrough: Manipulating Files and Directories in Visual Basic","linkify":"Walkthrough: Manipulating Files and Directories in Visual Basic","nodes":[{"content":"Walkthrough: Manipulating Files and Directories in Visual Basic","pos":[0,63]}]},{"content":"This walkthrough provides an introduction to the fundamentals of file I/O in <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph>.","pos":[1063,1233],"source":"This walkthrough provides an introduction to the fundamentals of file I/O in [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]."},{"content":"It describes how to create a small application that lists and examines text files in a directory.","pos":[1234,1331]},{"content":"For each selected text file, the application provides file attributes and the first line of content.","pos":[1332,1432]},{"content":"There is an option to write information to a log file.","pos":[1433,1487]},{"content":"This walkthrough uses members of the <ph id=\"ph1\">`My.Computer.FileSystem Object`</ph>, which are available in <ph id=\"ph2\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph>.","pos":[1494,1680],"source":"This walkthrough uses members of the `My.Computer.FileSystem Object`, which are available in [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]."},{"content":"See <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.FileSystem&gt;</ph> for more information.","pos":[1681,1753],"source":" See <xref:Microsoft.VisualBasic.FileIO.FileSystem> for more information."},{"content":"At the end of the walkthrough, an equivalent example is provided that uses classes from the <ph id=\"ph1\">&lt;xref:System.IO&gt;</ph> namespace.","pos":[1754,1873],"source":" At the end of the walkthrough, an equivalent example is provided that uses classes from the <xref:System.IO> namespace."},{"pos":[2016,2037],"content":"To create the project","linkify":"To create the project","nodes":[{"content":"To create the project","pos":[0,21]}]},{"pos":[2047,2091],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>New Project<ept id=\"p2\">**</ept>.","source":"On the **File** menu, click **New Project**."},{"pos":[2102,2141],"content":"The <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box appears.","source":"The **New Project** dialog box appears."},{"content":"In the <bpt id=\"p1\">**</bpt>Installed Templates<ept id=\"p1\">**</ept> pane, expand <bpt id=\"p2\">**</bpt>Visual Basic<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Windows<ept id=\"p3\">**</ept>.","pos":[2151,2240],"source":"In the **Installed Templates** pane, expand **Visual Basic**, and then click **Windows**."},{"content":"In the <bpt id=\"p1\">**</bpt>Templates<ept id=\"p1\">**</ept> pane in the middle, click <bpt id=\"p2\">**</bpt>Windows Forms Application<ept id=\"p2\">**</ept>.","pos":[2241,2318],"source":" In the **Templates** pane in the middle, click **Windows Forms Application**."},{"pos":[2328,2416],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`FileExplorer`</ph> to set the project name, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"In the **Name** box, type `FileExplorer` to set the project name, and then click **OK**."},{"pos":[2427,2568],"content":"<ph id=\"ph1\">[!INCLUDE[vsprvs](../../../../csharp/includes/vsprvs_md.md)]</ph> adds the project to <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, and the Windows Forms Designer opens.","source":"[!INCLUDE[vsprvs](../../../../csharp/includes/vsprvs_md.md)] adds the project to **Solution Explorer**, and the Windows Forms Designer opens."},{"content":"Add the controls in the following table to the form, and set the corresponding values for their properties.","pos":[2578,2685]},{"content":"Control","pos":[2696,2703]},{"content":"Property","pos":[2704,2712]},{"content":"Value","pos":[2713,2718]},{"pos":[2776,2787],"content":"<bpt id=\"p1\">**</bpt>ListBox<ept id=\"p1\">**</ept>","source":"**ListBox**"},{"pos":[2788,2796],"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","source":"**Name**"},{"pos":[2820,2830],"content":"<bpt id=\"p1\">**</bpt>Button<ept id=\"p1\">**</ept>","source":"**Button**"},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[2831,2839],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept>","pos":[2852,2860],"source":"**Text**"},{"content":"<bpt id=\"p1\">**</bpt>Browse<ept id=\"p1\">**</ept>","pos":[2888,2898],"source":"**Browse**"},{"pos":[2907,2917],"content":"<bpt id=\"p1\">**</bpt>Button<ept id=\"p1\">**</ept>","source":"**Button**"},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[2918,2926],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept>","pos":[2939,2947],"source":"**Text**"},{"content":"<bpt id=\"p1\">**</bpt>Examine<ept id=\"p1\">**</ept>","pos":[2976,2987],"source":"**Examine**"},{"pos":[2996,3008],"content":"<bpt id=\"p1\">**</bpt>CheckBox<ept id=\"p1\">**</ept>","source":"**CheckBox**"},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","pos":[3009,3017],"source":"**Name**"},{"content":"<bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept>","pos":[3030,3038],"source":"**Text**"},{"content":"<bpt id=\"p1\">**</bpt>Save Results<ept id=\"p1\">**</ept>","pos":[3066,3082],"source":"**Save Results**"},{"pos":[3091,3114],"content":"<bpt id=\"p1\">**</bpt>FolderBrowserDialog<ept id=\"p1\">**</ept>","source":"**FolderBrowserDialog**"},{"pos":[3115,3123],"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>","source":"**Name**"},{"pos":[3157,3203],"content":"To select a folder, and list files in a folder","linkify":"To select a folder, and list files in a folder","nodes":[{"content":"To select a folder, and list files in a folder","pos":[0,46]}]},{"content":"Create a <ph id=\"ph1\">`Click`</ph> event handler for <ph id=\"ph2\">`browseButton`</ph> by double-clicking the control on the form.","pos":[3213,3306],"source":"Create a `Click` event handler for `browseButton` by double-clicking the control on the form."},{"content":"The Code Editor opens.","pos":[3307,3329]},{"pos":[3339,3391],"content":"Add the following code to the <ph id=\"ph1\">`Click`</ph> event handler.","source":"Add the following code to the `Click` event handler."},{"pos":[3402,3591],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#103<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#103](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_1.vb)]"},{"content":"The <ph id=\"ph1\">`FolderBrowserDialog1.ShowDialog`</ph> call opens the <bpt id=\"p1\">**</bpt>Browse For Folder<ept id=\"p1\">**</ept> dialog box.","pos":[3602,3688],"source":"The `FolderBrowserDialog1.ShowDialog` call opens the **Browse For Folder** dialog box."},{"content":"After the user clicks <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.FolderBrowserDialog.SelectedPath%2A&gt;</ph> property is sent as an argument to the <ph id=\"ph2\">`ListFiles`</ph> method, which is added in the next step.","pos":[3689,3878],"source":" After the user clicks **OK**, the <xref:System.Windows.Forms.FolderBrowserDialog.SelectedPath%2A> property is sent as an argument to the `ListFiles` method, which is added in the next step."},{"pos":[3888,3925],"content":"Add the following <ph id=\"ph1\">`ListFiles`</ph> method.","source":"Add the following `ListFiles` method."},{"pos":[3936,4125],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#104<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_2.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#104](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_2.vb)]"},{"pos":[4136,4175],"content":"This code first clears the <bpt id=\"p1\">**</bpt>ListBox<ept id=\"p1\">**</ept>.","source":"This code first clears the **ListBox**."},{"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles%2A&gt;</ph> method then retrieves a collection of strings, one for each file in the directory.","pos":[4186,4331],"source":"The <xref:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles%2A> method then retrieves a collection of strings, one for each file in the directory."},{"content":"The <ph id=\"ph1\">`GetFiles`</ph> method accepts a search pattern argument to retrieve files that match a particular pattern.","pos":[4332,4438],"source":" The `GetFiles` method accepts a search pattern argument to retrieve files that match a particular pattern."},{"content":"In this example, only files that have the extension .txt are returned.","pos":[4439,4509]},{"pos":[4520,4609],"content":"The strings that are returned by the <ph id=\"ph1\">`GetFiles`</ph> method are then added to the <bpt id=\"p1\">**</bpt>ListBox<ept id=\"p1\">**</ept>.","source":"The strings that are returned by the `GetFiles` method are then added to the **ListBox**."},{"content":"Run the application.","pos":[4619,4639]},{"content":"Click the <bpt id=\"p1\">**</bpt>Browse<ept id=\"p1\">**</ept> button.","pos":[4640,4668],"source":" Click the **Browse** button."},{"content":"In the <bpt id=\"p1\">**</bpt>Browse For Folder<ept id=\"p1\">**</ept> dialog box, browse to a folder that contains .txt files, and then select the folder and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[4669,4799],"source":" In the **Browse For Folder** dialog box, browse to a folder that contains .txt files, and then select the folder and click **OK**."},{"pos":[4810,4877],"content":"The <ph id=\"ph1\">`ListBox`</ph> contains a list of .txt files in the selected folder.","source":"The `ListBox` contains a list of .txt files in the selected folder."},{"content":"Stop running the application.","pos":[4887,4916]},{"pos":[4926,4986],"content":"To obtain attributes of a file, and content from a text file","linkify":"To obtain attributes of a file, and content from a text file","nodes":[{"content":"To obtain attributes of a file, and content from a text file","pos":[0,60]}]},{"pos":[4996,5090],"content":"Create a <ph id=\"ph1\">`Click`</ph> event handler for <ph id=\"ph2\">`examineButton`</ph> by double-clicking the control on the form.","source":"Create a `Click` event handler for `examineButton` by double-clicking the control on the form."},{"pos":[5100,5152],"content":"Add the following code to the <ph id=\"ph1\">`Click`</ph> event handler.","source":"Add the following code to the `Click` event handler."},{"pos":[5163,5352],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#105<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_3.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#105](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_3.vb)]"},{"content":"The code verifies that an item is selected in the <ph id=\"ph1\">`ListBox`</ph>.","pos":[5363,5423],"source":"The code verifies that an item is selected in the `ListBox`."},{"content":"It then obtains the file path entry from the <ph id=\"ph1\">`ListBox`</ph>.","pos":[5424,5479],"source":" It then obtains the file path entry from the `ListBox`."},{"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.FileSystem.FileExists%2A&gt;</ph> method is used to check whether the file still exists.","pos":[5480,5599],"source":" The <xref:Microsoft.VisualBasic.FileIO.FileSystem.FileExists%2A> method is used to check whether the file still exists."},{"content":"The file path is sent as an argument to the <ph id=\"ph1\">`GetTextForOutput`</ph> method, which is added in the next step.","pos":[5610,5713],"source":"The file path is sent as an argument to the `GetTextForOutput` method, which is added in the next step."},{"content":"This method returns a string that contains file information.","pos":[5714,5774]},{"content":"The file information appears in a <bpt id=\"p1\">**</bpt>MessageBox<ept id=\"p1\">**</ept>.","pos":[5775,5824],"source":" The file information appears in a **MessageBox**."},{"pos":[5834,5878],"content":"Add the following <ph id=\"ph1\">`GetTextForOutput`</ph> method.","source":"Add the following `GetTextForOutput` method."},{"pos":[5889,6078],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#107<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_4.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#107](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_4.vb)]"},{"content":"The code uses the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.FileSystem.GetFileInfo%2A&gt;</ph> method to obtain file parameters.","pos":[6089,6202],"source":"The code uses the <xref:Microsoft.VisualBasic.FileIO.FileSystem.GetFileInfo%2A> method to obtain file parameters."},{"content":"The file parameters are added to a <ph id=\"ph1\">&lt;xref:System.Text.StringBuilder&gt;</ph>.","pos":[6203,6271],"source":" The file parameters are added to a <xref:System.Text.StringBuilder>."},{"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileReader%2A&gt;</ph> method reads the file contents into a <ph id=\"ph2\">&lt;xref:System.IO.StreamReader&gt;</ph>.","pos":[6282,6423],"source":"The <xref:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileReader%2A> method reads the file contents into a <xref:System.IO.StreamReader>."},{"content":"The first line of the contents is obtained from the <ph id=\"ph1\">`StreamReader`</ph> and is added to the <ph id=\"ph2\">`StringBuilder`</ph>.","pos":[6424,6527],"source":" The first line of the contents is obtained from the `StreamReader` and is added to the `StringBuilder`."},{"content":"Run the application.","pos":[6537,6557]},{"content":"Click <bpt id=\"p1\">**</bpt>Browse<ept id=\"p1\">**</ept>, and browse to a folder that contains .txt files.","pos":[6558,6624],"source":" Click **Browse**, and browse to a folder that contains .txt files."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[6625,6638],"source":" Click **OK**."},{"content":"Select a file in the <ph id=\"ph1\">`ListBox`</ph>, and then click <bpt id=\"p1\">**</bpt>Examine<ept id=\"p1\">**</ept>.","pos":[6649,6708],"source":"Select a file in the `ListBox`, and then click **Examine**."},{"content":"A <ph id=\"ph1\">`MessageBox`</ph> shows the file information.","pos":[6709,6751],"source":" A `MessageBox` shows the file information."},{"content":"Stop running the application.","pos":[6761,6790]},{"pos":[6800,6818],"content":"To add a log entry","linkify":"To add a log entry","nodes":[{"content":"To add a log entry","pos":[0,18]}]},{"pos":[6828,6905],"content":"Add the following code to the end of the <ph id=\"ph1\">`examineButton_Click`</ph> event handler.","source":"Add the following code to the end of the `examineButton_Click` event handler."},{"pos":[6916,7105],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#106<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_5.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#106](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_5.vb)]"},{"content":"The code sets the log file path to put the log file in the same directory as that of the selected file.","pos":[7116,7219]},{"content":"The text of the log entry is set to the current date and time followed by the file information.","pos":[7220,7315]},{"pos":[7326,7475],"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText%2A&gt;</ph> method, with the <ph id=\"ph2\">`append`</ph> argument set to <ph id=\"ph3\">`True`</ph>, is used to create the log entry.","source":"The <xref:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText%2A> method, with the `append` argument set to `True`, is used to create the log entry."},{"content":"Run the application.","pos":[7485,7505]},{"content":"Browse to a text file, select it in the <ph id=\"ph1\">`ListBox`</ph>, select the <bpt id=\"p1\">**</bpt>Save Results<ept id=\"p1\">**</ept> check box, and then click <bpt id=\"p2\">**</bpt>Examine<ept id=\"p2\">**</ept>.","pos":[7506,7623],"source":" Browse to a text file, select it in the `ListBox`, select the **Save Results** check box, and then click **Examine**."},{"content":"Verify that the log entry is written to the <ph id=\"ph1\">`log.txt`</ph> file.","pos":[7624,7683],"source":" Verify that the log entry is written to the `log.txt` file."},{"content":"Stop running the application.","pos":[7693,7722]},{"pos":[7732,7760],"content":"To use the current directory","linkify":"To use the current directory","nodes":[{"content":"To use the current directory","pos":[0,28]}]},{"pos":[7770,7839],"content":"Create an event handler for <ph id=\"ph1\">`Form1_Load`</ph> by double-clicking the form.","source":"Create an event handler for `Form1_Load` by double-clicking the form."},{"content":"Add the following code to the event handler.","pos":[7849,7893]},{"pos":[7904,8093],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#102<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_6.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#102](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_6.vb)]"},{"content":"This code sets the default directory of the folder browser to the current directory.","pos":[8104,8188]},{"content":"Run the application.","pos":[8198,8218]},{"content":"When you click <bpt id=\"p1\">**</bpt>Browse<ept id=\"p1\">**</ept> the first time, the <bpt id=\"p2\">**</bpt>Browse For Folder<ept id=\"p2\">**</ept> dialog box opens to the current directory.","pos":[8219,8329],"source":" When you click **Browse** the first time, the **Browse For Folder** dialog box opens to the current directory."},{"content":"Stop running the application.","pos":[8339,8368]},{"pos":[8378,8408],"content":"To selectively enable controls","linkify":"To selectively enable controls","nodes":[{"content":"To selectively enable controls","pos":[0,30]}]},{"pos":[8418,8456],"content":"Add the following <ph id=\"ph1\">`SetEnabled`</ph> method.","source":"Add the following `SetEnabled` method."},{"pos":[8467,8656],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#108<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_7.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#108](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_7.vb)]"},{"pos":[8667,8778],"content":"The <ph id=\"ph1\">`SetEnabled`</ph> method enables or disables controls depending on whether an item is selected in the <ph id=\"ph2\">`ListBox`</ph>.","source":"The `SetEnabled` method enables or disables controls depending on whether an item is selected in the `ListBox`."},{"pos":[8788,8906],"content":"Create a <ph id=\"ph1\">`SelectedIndexChanged`</ph> event handler for <ph id=\"ph2\">`filesListBox`</ph> by double-clicking the <ph id=\"ph3\">`ListBox`</ph> control on the form.","source":"Create a `SelectedIndexChanged` event handler for `filesListBox` by double-clicking the `ListBox` control on the form."},{"pos":[8916,9004],"content":"Add a call to <ph id=\"ph1\">`SetEnabled`</ph> in the new <ph id=\"ph2\">`filesListBox_SelectedIndexChanged`</ph> event handler.","source":"Add a call to `SetEnabled` in the new `filesListBox_SelectedIndexChanged` event handler."},{"pos":[9014,9094],"content":"Add a call to <ph id=\"ph1\">`SetEnabled`</ph> at the end of the <ph id=\"ph2\">`browseButton_Click`</ph> event handler.","source":"Add a call to `SetEnabled` at the end of the `browseButton_Click` event handler."},{"pos":[9104,9176],"content":"Add a call to <ph id=\"ph1\">`SetEnabled`</ph> at the end of the <ph id=\"ph2\">`Form1_Load`</ph> event handler.","source":"Add a call to `SetEnabled` at the end of the `Form1_Load` event handler."},{"content":"Run the application.","pos":[9186,9206]},{"content":"The <bpt id=\"p1\">**</bpt>Save Results<ept id=\"p1\">**</ept> check box and the <bpt id=\"p2\">**</bpt>Examine<ept id=\"p2\">**</ept> button are disabled if an item is not selected in the <ph id=\"ph1\">`ListBox`</ph>.","pos":[9207,9322],"source":" The **Save Results** check box and the **Examine** button are disabled if an item is not selected in the `ListBox`."},{"pos":[9331,9372],"content":"Full example using My.Computer.FileSystem","linkify":"Full example using My.Computer.FileSystem","nodes":[{"content":"Full example using My.Computer.FileSystem","pos":[0,41]}]},{"content":"Following is the complete example.","pos":[9376,9410]},{"pos":[9417,9606],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#101<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_8.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#101](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_8.vb)]"},{"pos":[9615,9643],"content":"Full example using System.IO","linkify":"Full example using System.IO","nodes":[{"content":"Full example using System.IO","pos":[0,28]}]},{"pos":[9647,9779],"content":"The following equivalent example uses classes from the <ph id=\"ph1\">&lt;xref:System.IO&gt;</ph> namespace instead of using <ph id=\"ph2\">`My.Computer.FileSystem`</ph> objects.","source":"The following equivalent example uses classes from the <xref:System.IO> namespace instead of using `My.Computer.FileSystem` objects."},{"pos":[9786,9975],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbcnMyFileSystem#111<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_9.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbcnMyFileSystem#111](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/walkthrough-manipulating-files-and-directories_9.vb)]"},{"pos":[9984,9992],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>Walkthrough: Manipulating Files by Using .NET Framework Methods<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-by-using-net-framework-methods.md)</ept>","pos":[10138,10348],"source":" [Walkthrough: Manipulating Files by Using .NET Framework Methods](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-by-using-net-framework-methods.md)"}]}