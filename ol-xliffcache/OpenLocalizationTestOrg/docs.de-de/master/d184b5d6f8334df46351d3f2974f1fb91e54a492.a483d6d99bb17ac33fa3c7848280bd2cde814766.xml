{"content":"---\ntitle: \"How to: Create Unsigned Friend Assemblies (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: 5735eb79-9729-4c46-ac1f-537ada3acaa7\ncaps.latest.revision: 4\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# How to: Create Unsigned Friend Assemblies (Visual Basic)\nThis example shows how to use friend assemblies with assemblies that are unsigned.  \n  \n### To create an assembly and a friend assembly  \n  \n1.  Open a command prompt.  \n  \n2.  Create a Visual Basic file named `friend_signed_A.` that contains the following code. The code uses the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute to declare friend_signed_B as a friend assembly.  \n  \n    ```vb  \n    ' friend_unsigned_A.vb  \n    ' Compile with:   \n    ' Vbc /target:library friend_unsigned_A.vb  \n    Imports System.Runtime.CompilerServices  \n    Imports System  \n  \n    <Assembly: InternalsVisibleTo(\"friend_unsigned_B\")>   \n  \n    ' Friend type.  \n    Friend Class Class1  \n        Public Sub Test()  \n            Console.WriteLine(\"Class1.Test\")  \n        End Sub  \n    End Class  \n  \n    ' Public type with Friend member.  \n    Public Class Class2  \n        Friend Sub Test()  \n            Console.WriteLine(\"Class2.Test\")  \n        End Sub  \n    End Class  \n    ```  \n  \n3.  Compile and sign friend_signed_A by using the following command.  \n  \n    ```vb  \n    Vbc /target:library friend_unsigned_A.vb  \n    ```  \n  \n4.  Create a Visual Basic file named `friend_unsigned_B` that contains the following code. Because friend_unsigned_A specifies friend_unsigned_B as a friend assembly, the code in friend_unsigned_B can access `Friend` types and members from friend_unsigned_A.  \n  \n    ```vb  \n    ' friend_unsigned_B.vb  \n    ' Compile with:   \n    ' Vbc /r:friend_unsigned_A.dll friend_unsigned_B.vb  \n    Module Module1  \n        Sub Main()  \n            ' Access a Friend type.  \n            Dim inst1 As New Class1()  \n            inst1.Test()  \n  \n            Dim inst2 As New Class2()  \n            ' Access a Friend member of a public type.  \n            inst2.Test()  \n  \n            System.Console.ReadLine()  \n        End Sub  \n    End Module  \n    ```  \n  \n5.  Compile friend_signed_B by using the following command.  \n  \n    ```vb  \n    Vbc /r:friend_unsigned_A.dll friend_unsigned_B.vb  \n    ```  \n  \n     The name of the assembly that is generated by the compiler must match the friend assembly name that is passed to the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute. You can explicitly set the assembly by using the `/out` compiler option.  \n  \n6.  Run the friend_signed_B.exe file.  \n  \n     The program prints two strings: \"Class1.Test\" and \"Class2.Test\".  \n  \n## .NET Framework Security  \n There are similarities between the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute and the <xref:System.Security.Permissions.StrongNameIdentityPermission> class. The main difference is that <xref:System.Security.Permissions.StrongNameIdentityPermission> can demand security permissions to run a particular section of code, whereas the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute controls the visibility of `Friend` types and members.  \n  \n## See Also  \n <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute>   \n [Assemblies and the Global Assembly Cache (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/index.md)   \n [Friend Assemblies (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/friend-assemblies.md)   \n [How to: Create Signed Friend Assemblies (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-signed-friend-assemblies.md)   \n [Programming Guide Concepts](../../../../visual-basic/programming-guide/concepts/index.md)","nodes":[{"pos":[4,459],"nodes":[{"content":"How to: Create Unsigned Friend Assemblies (Visual Basic) | Microsoft Docs","nodes":[{"pos":[0,73],"content":"How to: Create Unsigned Friend Assemblies (Visual Basic) | Microsoft Docs","nodes":[{"content":"How to: Create Unsigned Friend Assemblies (Visual Basic) | Microsoft Docs","pos":[0,73]}]}],"pos":[6,82],"yaml":true}],"content":"title: \"How to: Create Unsigned Friend Assemblies (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: 5735eb79-9729-4c46-ac1f-537ada3acaa7\ncaps.latest.revision: 4\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"","yamlblock":true},{"pos":[466,522],"content":"How to: Create Unsigned Friend Assemblies (Visual Basic)","linkify":"How to: Create Unsigned Friend Assemblies (Visual Basic)","nodes":[{"content":"How to: Create Unsigned Friend Assemblies (Visual Basic)","pos":[0,56]}]},{"content":"This example shows how to use friend assemblies with assemblies that are unsigned.","pos":[523,605]},{"pos":[615,658],"content":"To create an assembly and a friend assembly","linkify":"To create an assembly and a friend assembly","nodes":[{"content":"To create an assembly and a friend assembly","pos":[0,43]}]},{"content":"Open a command prompt.","pos":[668,690]},{"content":"Create a Visual Basic file named <ph id=\"ph1\">`friend_signed_A.`</ph> that contains the following code.","pos":[700,785],"source":"Create a Visual Basic file named `friend_signed_A.` that contains the following code."},{"content":"The code uses the <ph id=\"ph1\">&lt;xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute&gt;</ph> attribute to declare friend_signed_B as a friend assembly.","pos":[786,929],"source":" The code uses the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute to declare friend_signed_B as a friend assembly."},{"content":"Compile and sign friend_signed_A by using the following command.","pos":[1531,1595]},{"content":"Create a Visual Basic file named <ph id=\"ph1\">`friend_unsigned_B`</ph> that contains the following code.","pos":[1677,1763],"source":"Create a Visual Basic file named `friend_unsigned_B` that contains the following code."},{"content":"Because friend_unsigned_A specifies friend_unsigned_B as a friend assembly, the code in friend_unsigned_B can access <ph id=\"ph1\">`Friend`</ph> types and members from friend_unsigned_A.","pos":[1764,1931],"source":" Because friend_unsigned_A specifies friend_unsigned_B as a friend assembly, the code in friend_unsigned_B can access `Friend` types and members from friend_unsigned_A."},{"content":"Compile friend_signed_B by using the following command.","pos":[2428,2483]},{"content":"The name of the assembly that is generated by the compiler must match the friend assembly name that is passed to the <ph id=\"ph1\">&lt;xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute&gt;</ph> attribute.","pos":[2575,2769],"source":"The name of the assembly that is generated by the compiler must match the friend assembly name that is passed to the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute."},{"content":"You can explicitly set the assembly by using the <ph id=\"ph1\">`/out`</ph> compiler option.","pos":[2770,2842],"source":" You can explicitly set the assembly by using the `/out` compiler option."},{"content":"Run the friend_signed_B.exe file.","pos":[2852,2885]},{"content":"The program prints two strings: \"Class1.Test\" and \"Class2.Test\".","pos":[2896,2960]},{"pos":[2969,2992],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"There are similarities between the <ph id=\"ph1\">&lt;xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute&gt;</ph> attribute and the <ph id=\"ph2\">&lt;xref:System.Security.Permissions.StrongNameIdentityPermission&gt;</ph> class.","pos":[2996,3186],"source":"There are similarities between the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute and the <xref:System.Security.Permissions.StrongNameIdentityPermission> class."},{"content":"The main difference is that <ph id=\"ph1\">&lt;xref:System.Security.Permissions.StrongNameIdentityPermission&gt;</ph> can demand security permissions to run a particular section of code, whereas the <ph id=\"ph2\">&lt;xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute&gt;</ph> attribute controls the visibility of <ph id=\"ph3\">`Friend`</ph> types and members.","pos":[3187,3491],"source":" The main difference is that <xref:System.Security.Permissions.StrongNameIdentityPermission> can demand security permissions to run a particular section of code, whereas the <xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> attribute controls the visibility of `Friend` types and members."},{"pos":[3500,3508],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute&gt;</ph>","pos":[3512,3578],"source":"<xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute> "},{"content":"<bpt id=\"p1\">[</bpt>Assemblies and the Global Assembly Cache (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/assemblies-gac/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[3583,3718],"source":"[Assemblies and the Global Assembly Cache (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>Friend Assemblies (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/assemblies-gac/friend-assemblies.md)</ept><ph id=\"ph1\"> </ph>","pos":[3722,3846],"source":"[Friend Assemblies (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/friend-assemblies.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Create Signed Friend Assemblies (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-signed-friend-assemblies.md)</ept><ph id=\"ph1\"> </ph>","pos":[3850,4017],"source":"[How to: Create Signed Friend Assemblies (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-create-signed-friend-assemblies.md) "},{"content":"<bpt id=\"p1\">[</bpt>Programming Guide Concepts<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/index.md)</ept>","pos":[4021,4111],"source":"[Programming Guide Concepts](../../../../visual-basic/programming-guide/concepts/index.md)"}]}