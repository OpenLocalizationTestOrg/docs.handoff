{"content":"---\ntitle: \"How to: Create COM Wrappers | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"COM,wrappers creating\"\n  - \"COM,wrappers Visual Studio\"\nms.assetid: bdf89bea-1623-45ee-a57b-cf7c90395efa\ncaps.latest.revision: 12\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# How to: Create COM Wrappers\nYou can create Component Object Model (COM) wrappers by using [!INCLUDE[vsprvsext](../../../includes/vsprvsext-md.md)] features or the .NET Framework tools Tlbimp.exe and Regasm.exe. Both methods generate two types of COM wrappers:  \n  \n-   A [Runtime Callable Wrapper](../../../docs/framework/interop/runtime-callable-wrapper.md) from a type library to run a COM object in managed code.  \n  \n-   A [COM Callable Wrapper](../../../docs/framework/interop/com-callable-wrapper.md) with the required registry settings to run a managed object in a native application.  \n  \n In [!INCLUDE[vsprvslong](../../../includes/vsprvslong-md.md)], you can add the COM wrapper as a reference to your project.  \n  \n## Wrapping COM Objects in a Managed Application  \n  \n#### To create a runtime callable wrapper using Visual Studio  \n  \n1.  Open the project for your managed application.  \n  \n2.  On the **Project** menu, click **Show All Files**.  \n  \n3.  On the **Project** menu, click **Add Reference**.  \n  \n4.  In the Add Reference dialog box, click the **COM** tab, select the component you want to use, and click **OK**.  \n  \n     In **Solution Explorer**, note that the COM component is added to the References folder in your project.  \n  \n You can now write code to access the COM object. You can begin by declaring the object, such as with an `Imports` statement for [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)] or a `Using` statement for [!INCLUDE[csprcslong](../../../includes/csprcslong-md.md)].  \n  \n> [!NOTE]\n>  If you want to program Microsoft Office components, first install the [Microsoft Office Primary Interop Assemblies](http://go.microsoft.com/fwlink/?LinkId=50479) (PIAs) from the Microsoft Download Center. In step 4, select the latest version of the object library available for the Office product you want, such as the **Microsoft Word 11.0 Object Library**.  \n  \n#### To create a runtime callable wrapper using .NET Framework tools  \n  \n-   Run the [Tlbimp.exe (Type Library Importer)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md) tool.  \n  \n This tool creates an assembly that contains run-time metadata for the types defined in the original type library.  \n  \n## Wrapping Managed Objects in a Native Application  \n  \n#### To create a COM callable wrapper using Visual Studio  \n  \n1.  Create a Class Library project for the managed class that you want to run in native code. The class must have a default constructor.  \n  \n     Verify that you have a complete four-part version number for your assembly in the AssemblyInfo file. This number is required for maintaining versioning in the Windows registry. For more information about version numbers, see [Assembly Versioning](../../../docs/framework/app-domains/assembly-versioning.md).  \n  \n2.  On the **Project** menu, click **Properties**.  \n  \n3.  Click the **Compile** tab.  \n  \n4.  Select the **Register for COM interop** check box.  \n  \n When you build the project, the assembly is automatically registered for COM interop. If you are building a native application in [!INCLUDE[vsprvslong](../../../includes/vsprvslong-md.md)], you can use the assembly by clicking **Add Reference** on the **Project** menu.  \n  \n#### To create a COM callable wrapper using .NET Framework tools  \n  \n-   Run the [Regasm.exe (Assembly Registration Tool)](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md) tool.  \n  \n This tool reads the assembly metadata and adds the necessary entries to the registry. As a result, COM clients can create .NET Framework classes transparently. You can use the assembly as if it were a native COM class.  \n  \n You can run Regasm.exe on an assembly located in any directory, and then run the [Gacutil.exe (Global Assembly Cache Tool)](../../../docs/framework/tools/gacutil-exe-gac-tool.md) to move it to the global assembly cache. Moving the assembly does not invalidate location registry entries, because the global assembly cache is always examined if the assembly is not found elsewhere.  \n  \n## See Also  \n [Runtime Callable Wrapper](../../../docs/framework/interop/runtime-callable-wrapper.md)   \n [COM Callable Wrapper](../../../docs/framework/interop/com-callable-wrapper.md)","nodes":[{"pos":[4,493],"nodes":[{"content":"How to: Create COM Wrappers | Microsoft Docs","nodes":[{"pos":[0,44],"content":"How to: Create COM Wrappers | Microsoft Docs","nodes":[{"content":"How to: Create COM Wrappers | Microsoft Docs","pos":[0,44]}]}],"pos":[6,53],"yaml":true}],"content":"title: \"How to: Create COM Wrappers | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"COM,wrappers creating\"\n  - \"COM,wrappers Visual Studio\"\nms.assetid: bdf89bea-1623-45ee-a57b-cf7c90395efa\ncaps.latest.revision: 12\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[500,527],"content":"How to: Create COM Wrappers","linkify":"How to: Create COM Wrappers","nodes":[{"content":"How to: Create COM Wrappers","pos":[0,27]}]},{"content":"You can create Component Object Model (COM) wrappers by using <ph id=\"ph1\">[!INCLUDE[vsprvsext](../../../includes/vsprvsext-md.md)]</ph> features or the .NET Framework tools Tlbimp.exe and Regasm.exe.","pos":[528,710],"source":"You can create Component Object Model (COM) wrappers by using [!INCLUDE[vsprvsext](../../../includes/vsprvsext-md.md)] features or the .NET Framework tools Tlbimp.exe and Regasm.exe."},{"content":"Both methods generate two types of COM wrappers:","pos":[711,759]},{"pos":[769,915],"content":"A <bpt id=\"p1\">[</bpt>Runtime Callable Wrapper<ept id=\"p1\">](../../../docs/framework/interop/runtime-callable-wrapper.md)</ept> from a type library to run a COM object in managed code.","source":"A [Runtime Callable Wrapper](../../../docs/framework/interop/runtime-callable-wrapper.md) from a type library to run a COM object in managed code."},{"pos":[925,1091],"content":"A <bpt id=\"p1\">[</bpt>COM Callable Wrapper<ept id=\"p1\">](../../../docs/framework/interop/com-callable-wrapper.md)</ept> with the required registry settings to run a managed object in a native application.","source":"A [COM Callable Wrapper](../../../docs/framework/interop/com-callable-wrapper.md) with the required registry settings to run a managed object in a native application."},{"pos":[1098,1220],"content":"In <ph id=\"ph1\">[!INCLUDE[vsprvslong](../../../includes/vsprvslong-md.md)]</ph>, you can add the COM wrapper as a reference to your project.","source":"In [!INCLUDE[vsprvslong](../../../includes/vsprvslong-md.md)], you can add the COM wrapper as a reference to your project."},{"pos":[1229,1274],"content":"Wrapping COM Objects in a Managed Application","linkify":"Wrapping COM Objects in a Managed Application","nodes":[{"content":"Wrapping COM Objects in a Managed Application","pos":[0,45]}]},{"pos":[1285,1341],"content":"To create a runtime callable wrapper using Visual Studio","linkify":"To create a runtime callable wrapper using Visual Studio","nodes":[{"content":"To create a runtime callable wrapper using Visual Studio","pos":[0,56]}]},{"content":"Open the project for your managed application.","pos":[1351,1397]},{"pos":[1407,1457],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Show All Files<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, click **Show All Files**."},{"pos":[1467,1516],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Add Reference<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, click **Add Reference**."},{"pos":[1526,1637],"content":"In the Add Reference dialog box, click the <bpt id=\"p1\">**</bpt>COM<ept id=\"p1\">**</ept> tab, select the component you want to use, and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"In the Add Reference dialog box, click the **COM** tab, select the component you want to use, and click **OK**."},{"pos":[1648,1752],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, note that the COM component is added to the References folder in your project.","source":"In **Solution Explorer**, note that the COM component is added to the References folder in your project."},{"content":"You can now write code to access the COM object.","pos":[1759,1807]},{"content":"You can begin by declaring the object, such as with an <ph id=\"ph1\">`Imports`</ph> statement for <ph id=\"ph2\">[!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)]</ph> or a <ph id=\"ph3\">`Using`</ph> statement for <ph id=\"ph4\">[!INCLUDE[csprcslong](../../../includes/csprcslong-md.md)]</ph>.","pos":[1808,2032],"source":" You can begin by declaring the object, such as with an `Imports` statement for [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)] or a `Using` statement for [!INCLUDE[csprcslong](../../../includes/csprcslong-md.md)]."},{"pos":[2040,2409],"content":"[!NOTE]\n If you want to program Microsoft Office components, first install the [Microsoft Office Primary Interop Assemblies](http://go.microsoft.com/fwlink/?LinkId=50479) (PIAs) from the Microsoft Download Center. In step 4, select the latest version of the object library available for the Office product you want, such as the **Microsoft Word 11.0 Object Library**.","leadings":["","> "],"nodes":[{"content":"If you want to program Microsoft Office components, first install the [Microsoft Office Primary Interop Assemblies](http://go.microsoft.com/fwlink/?LinkId=50479) (PIAs) from the Microsoft Download Center. In step 4, select the latest version of the object library available for the Office product you want, such as the **Microsoft Word 11.0 Object Library**.","pos":[9,367],"nodes":[{"content":"If you want to program Microsoft Office components, first install the <bpt id=\"p1\">[</bpt>Microsoft Office Primary Interop Assemblies<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=50479)</ept> (PIAs) from the Microsoft Download Center.","pos":[0,204],"source":"If you want to program Microsoft Office components, first install the [Microsoft Office Primary Interop Assemblies](http://go.microsoft.com/fwlink/?LinkId=50479) (PIAs) from the Microsoft Download Center."},{"content":"In step 4, select the latest version of the object library available for the Office product you want, such as the <bpt id=\"p1\">**</bpt>Microsoft Word 11.0 Object Library<ept id=\"p1\">**</ept>.","pos":[205,358],"source":" In step 4, select the latest version of the object library available for the Office product you want, such as the **Microsoft Word 11.0 Object Library**."}]}]},{"pos":[2420,2483],"content":"To create a runtime callable wrapper using .NET Framework tools","linkify":"To create a runtime callable wrapper using .NET Framework tools","nodes":[{"content":"To create a runtime callable wrapper using .NET Framework tools","pos":[0,63]}]},{"pos":[2493,2610],"content":"Run the <bpt id=\"p1\">[</bpt>Tlbimp.exe (Type Library Importer)<ept id=\"p1\">](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)</ept> tool.","source":"Run the [Tlbimp.exe (Type Library Importer)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md) tool."},{"content":"This tool creates an assembly that contains run-time metadata for the types defined in the original type library.","pos":[2617,2730]},{"pos":[2739,2787],"content":"Wrapping Managed Objects in a Native Application","linkify":"Wrapping Managed Objects in a Native Application","nodes":[{"content":"Wrapping Managed Objects in a Native Application","pos":[0,48]}]},{"pos":[2798,2850],"content":"To create a COM callable wrapper using Visual Studio","linkify":"To create a COM callable wrapper using Visual Studio","nodes":[{"content":"To create a COM callable wrapper using Visual Studio","pos":[0,52]}]},{"content":"Create a Class Library project for the managed class that you want to run in native code.","pos":[2860,2949]},{"content":"The class must have a default constructor.","pos":[2950,2992]},{"content":"Verify that you have a complete four-part version number for your assembly in the AssemblyInfo file.","pos":[3003,3103]},{"content":"This number is required for maintaining versioning in the Windows registry.","pos":[3104,3179]},{"content":"For more information about version numbers, see <bpt id=\"p1\">[</bpt>Assembly Versioning<ept id=\"p1\">](../../../docs/framework/app-domains/assembly-versioning.md)</ept>.","pos":[3180,3310],"source":" For more information about version numbers, see [Assembly Versioning](../../../docs/framework/app-domains/assembly-versioning.md)."},{"pos":[3320,3366],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, click **Properties**."},{"pos":[3376,3402],"content":"Click the <bpt id=\"p1\">**</bpt>Compile<ept id=\"p1\">**</ept> tab.","source":"Click the **Compile** tab."},{"pos":[3412,3462],"content":"Select the <bpt id=\"p1\">**</bpt>Register for COM interop<ept id=\"p1\">**</ept> check box.","source":"Select the **Register for COM interop** check box."},{"content":"When you build the project, the assembly is automatically registered for COM interop.","pos":[3469,3554]},{"content":"If you are building a native application in <ph id=\"ph1\">[!INCLUDE[vsprvslong](../../../includes/vsprvslong-md.md)]</ph>, you can use the assembly by clicking <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Project<ept id=\"p2\">**</ept> menu.","pos":[3555,3738],"source":" If you are building a native application in [!INCLUDE[vsprvslong](../../../includes/vsprvslong-md.md)], you can use the assembly by clicking **Add Reference** on the **Project** menu."},{"pos":[3749,3808],"content":"To create a COM callable wrapper using .NET Framework tools","linkify":"To create a COM callable wrapper using .NET Framework tools","nodes":[{"content":"To create a COM callable wrapper using .NET Framework tools","pos":[0,59]}]},{"pos":[3818,3945],"content":"Run the <bpt id=\"p1\">[</bpt>Regasm.exe (Assembly Registration Tool)<ept id=\"p1\">](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md)</ept> tool.","source":"Run the [Regasm.exe (Assembly Registration Tool)](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md) tool."},{"content":"This tool reads the assembly metadata and adds the necessary entries to the registry.","pos":[3952,4037]},{"content":"As a result, COM clients can create .NET Framework classes transparently.","pos":[4038,4111]},{"content":"You can use the assembly as if it were a native COM class.","pos":[4112,4170]},{"content":"You can run Regasm.exe on an assembly located in any directory, and then run the <bpt id=\"p1\">[</bpt>Gacutil.exe (Global Assembly Cache Tool)<ept id=\"p1\">](../../../docs/framework/tools/gacutil-exe-gac-tool.md)</ept> to move it to the global assembly cache.","pos":[4177,4396],"source":"You can run Regasm.exe on an assembly located in any directory, and then run the [Gacutil.exe (Global Assembly Cache Tool)](../../../docs/framework/tools/gacutil-exe-gac-tool.md) to move it to the global assembly cache."},{"content":"Moving the assembly does not invalidate location registry entries, because the global assembly cache is always examined if the assembly is not found elsewhere.","pos":[4397,4556]},{"pos":[4565,4573],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Runtime Callable Wrapper<ept id=\"p1\">](../../../docs/framework/interop/runtime-callable-wrapper.md)</ept><ph id=\"ph1\"> </ph>","pos":[4577,4665],"source":"[Runtime Callable Wrapper](../../../docs/framework/interop/runtime-callable-wrapper.md) "},{"content":"<bpt id=\"p1\">[</bpt>COM Callable Wrapper<ept id=\"p1\">](../../../docs/framework/interop/com-callable-wrapper.md)</ept>","pos":[4669,4748],"source":"[COM Callable Wrapper](../../../docs/framework/interop/com-callable-wrapper.md)"}]}