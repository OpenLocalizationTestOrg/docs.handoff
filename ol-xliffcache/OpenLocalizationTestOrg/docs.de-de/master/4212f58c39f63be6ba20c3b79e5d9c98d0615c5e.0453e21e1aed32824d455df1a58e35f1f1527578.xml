{"content":"---\ntitle: \"Packaging and deploying custom My extensions (Visual Basic)\"\nms.date: 08/14/2018\nhelpviewer_keywords:\n  - \"My namespace [Visual Basic], customizing\"\n  - \"My namespace\"\n  - \"My namespace [Visual Basic], extending\"\nms.assetid: fd89c54b-0290-4c50-95a3-ff17d4487a21\n---\n# Package and deploy custom My extensions (Visual Basic)\n\nVisual Basic provides an easy way for you to deploy your custom `My` namespace extensions by using Visual Studio templates. If you are creating a project template for which your `My` extensions are an integral part of the new project type, you can just include your custom `My` extension code with the project when you export the template. For more information about exporting project templates, see [How to: Create Project Templates](/visualstudio/ide/how-to-create-project-templates).\n\nIf your custom `My` extension is in a single code file, you can export the file as an item template that users can add to any type of Visual Basic project. You can then customize the item template to enable additional capabilities and behavior for your custom `My` extension in a Visual Basic project. Those capabilities include the following:\n\n- Allowing users to manage your custom `My` extension from the **My Extensions** page of the Visual Basic Project Designer.\n\n- Automatically adding your custom `My` extension when a reference to a specified assembly is added to a project.\n\n- Hiding the `My` extension item template in the **Add Item** dialog box so that it is not included in the list of project items.\n\nThis topic discusses how to package a custom `My` extension as a hidden item template that can be managed from the **My Extensions** page of the Visual Basic Project Designer. The custom `My` extension can also be added automatically when a reference to a specified assembly is added to a project.\n\n## Create a My namespace extension\n\nThe first step in creating a deployment package for a custom `My` extension is to create the extension as a single code file. For details and guidance about how to create a custom `My` extension, see [Extending the My Namespace in Visual Basic](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.md).\n\n## Export a My namespace extension as an item template\n\nAfter you have a code file that includes your `My` namespace extension, you can export the code file as a Visual Studio item template. For instructions on how to export a file as a Visual Studio item template, see [How to: Create Item Templates](/visualstudio/ide/how-to-create-item-templates).\n\n> [!NOTE]\n> If your `My` namespace extension has a dependency on a particular assembly, you can customize your item template to automatically install your `My` namespace extension when a reference to that assembly is added. As a result, you will want to exclude that assembly reference when you export the code file as a Visual Studio item template.\n\n## Customize the item template\n\nYou can enable your item template to be managed from the **My Extensions** page of the Visual Basic Project Designer. You can also enable the item template to be added automatically when a reference to a specified assembly is added to a project. To enable these customizations, you will add a new file, called the CustomData file, to your template, and then add a new element to the XML in your .vstemplate file.\n\n### Add the CustomData file\n\nThe CustomData file is a text file that has a file name extension of .CustomData (the file name can be set to any value meaningful to your template) and that contains XML. The XML in the CustomData file instructs Visual Basic to include your `My` extension when users use the **My Extensions** page of the Visual Basic Project Designer. You can optionally add the <`AssemblyFullName>` attribute to your CustomData file XML. This instructs Visual Basic to automatically install your custom `My` extension when a reference to a particular assembly is added to the project. You can use any text editor or XML editor to create the CustomData file, and then add it to your item template's compressed folder (.zip file).\n\nFor example, the following XML shows the contents of a CustomData file that will add the template item to the My Extensions folder of a Visual Basic project when a reference to the Microsoft.VisualBasic.PowerPacks.Vs.dll assembly is added to the project.\n\n```xml\n<VBMyExtensionTemplate\n    ID=\"Microsoft.VisualBasic.Samples.MyExtensions.MyPrinterInfo\"\n    Version=\"1.0.0.0\"\n    AssemblyFullName=\"Microsoft.VisualBasic.PowerPacks.vs\"\n/>\n```\n\nThe CustomData file contains a <`VBMyExtensionTemplate>` element that has attributes as listed in the following table.\n\n|Attribute|Description|\n|---|---|\n|`ID`|Required. A unique identifier for the extension. If the extension that has this ID has already been added to the project, the user will not be prompted to add it again.|\n|`Version`|Required. A version number for the item template.|\n|`AssemblyFullName`|Optional. An assembly name. When a reference to this assembly is added to the project, the user will be prompted to add the `My` extension from this item template.|\n\n### Add the \\<CustomDataSignature> element to the .vstemplate file\n\nTo identify your Visual Studio item template as a `My` namespace extension, you must also modify the .vstemplate file for your item template. You must add a `<CustomDataSignature>` element to the `<TemplateData>` element. The `<CustomDataSignature>` element must contain the text `Microsoft.VisualBasic.MyExtension`, as shown in the following example.\n\n```xml\n<CustomDataSignature>Microsoft.VisualBasic.MyExtension</CustomDataSignature>\n```\n\nYou cannot modify files in a compressed folder (.zip file) directly. You must copy the .vstemplate file from the compressed folder, modify it, and then replace the .vstemplate file in the compressed folder with your updated copy.\n\nThe following example shows the contents of a .vstemplate file that has the `<CustomDataSignature>` element added.\n\n```xml\n<VSTemplate Version=\"2.0.0\" xmlns=\"http://schemas.microsoft.com/developer/vstemplate/2005\" Type=\"Item\">\n  <TemplateData>\n    <DefaultName>MyCustomExtensionModule.vb</DefaultName>\n    <Name>MyPrinterInfo</Name>\n    <Description>Custom My Extensions Item Template</Description>\n    <ProjectType>VisualBasic</ProjectType>\n    <SortOrder>10</SortOrder>\n    <Icon>__TemplateIcon.ico</Icon>\n    <CustomDataSignature      >Microsoft.VisualBasic.MyExtension</CustomDataSignature>\n  </TemplateData>\n  <TemplateContent>\n    <References />\n    <ProjectItem SubType=\"Code\"\n                 TargetFileName=\"$fileinputname$.vb\"\n                 ReplaceParameters=\"true\"\n     >MyCustomExtensionModule.vb</ProjectItem>\n  </TemplateContent>\n</VSTemplate>\n```\n\n## Install the template\n\nTo install the template, you can copy the compressed folder (*.zip* file) to the Visual Basic item templates folder. By default, user item templates are located in *%USERPROFILE%\\Documents\\Visual Studio \\<Version\\>\\Templates\\ItemTemplates\\Visual Basic*. Alternatively, you can publish the template as a Visual Studio Installer (*.vsi*) file.\n\n## See also\n\n- [Extending the My Namespace in Visual Basic](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.md)\n- [Extending the Visual Basic Application Model](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-visual-basic-application-model.md)\n- [Customizing Which Objects are Available in My](../../../visual-basic/developing-apps/customizing-extending-my/customizing-which-objects-are-available-in-my.md)\n- [My Extensions Page, Project Designer](/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic)\n","nodes":[{"pos":[4,273],"embed":true,"restype":"x-metadata","content":"title: \"Packaging and deploying custom My extensions (Visual Basic)\"\nms.date: 08/14/2018\nhelpviewer_keywords:\n  - \"My namespace [Visual Basic], customizing\"\n  - \"My namespace\"\n  - \"My namespace [Visual Basic], extending\"\nms.assetid: fd89c54b-0290-4c50-95a3-ff17d4487a21","nodes":[{"content":"Packaging and deploying custom My extensions (Visual Basic)","nodes":[{"pos":[0,59],"content":"Packaging and deploying custom My extensions (Visual Basic)","nodes":[{"content":"Packaging and deploying custom My extensions (Visual Basic)","pos":[0,59]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[280,334],"content":"Package and deploy custom My extensions (Visual Basic)","linkify":"Package and deploy custom My extensions (Visual Basic)","nodes":[{"content":"Package and deploy custom My extensions (Visual Basic)","pos":[0,54]}]},{"content":"Visual Basic provides an easy way for you to deploy your custom <ph id=\"ph1\">`My`</ph> namespace extensions by using Visual Studio templates.","pos":[336,459],"source":"Visual Basic provides an easy way for you to deploy your custom `My` namespace extensions by using Visual Studio templates."},{"content":"If you are creating a project template for which your <ph id=\"ph1\">`My`</ph> extensions are an integral part of the new project type, you can just include your custom <ph id=\"ph2\">`My`</ph> extension code with the project when you export the template.","pos":[460,675],"source":" If you are creating a project template for which your `My` extensions are an integral part of the new project type, you can just include your custom `My` extension code with the project when you export the template."},{"content":"For more information about exporting project templates, see <bpt id=\"p1\">[</bpt>How to: Create Project Templates<ept id=\"p1\">](/visualstudio/ide/how-to-create-project-templates)</ept>.","pos":[676,822],"source":" For more information about exporting project templates, see [How to: Create Project Templates](/visualstudio/ide/how-to-create-project-templates)."},{"content":"If your custom <ph id=\"ph1\">`My`</ph> extension is in a single code file, you can export the file as an item template that users can add to any type of Visual Basic project.","pos":[824,979],"source":"If your custom `My` extension is in a single code file, you can export the file as an item template that users can add to any type of Visual Basic project."},{"content":"You can then customize the item template to enable additional capabilities and behavior for your custom <ph id=\"ph1\">`My`</ph> extension in a Visual Basic project.","pos":[980,1125],"source":" You can then customize the item template to enable additional capabilities and behavior for your custom `My` extension in a Visual Basic project."},{"content":"Those capabilities include the following:","pos":[1126,1167]},{"pos":[1171,1292],"content":"Allowing users to manage your custom <ph id=\"ph1\">`My`</ph> extension from the <bpt id=\"p1\">**</bpt>My Extensions<ept id=\"p1\">**</ept> page of the Visual Basic Project Designer.","source":"Allowing users to manage your custom `My` extension from the **My Extensions** page of the Visual Basic Project Designer."},{"pos":[1296,1407],"content":"Automatically adding your custom <ph id=\"ph1\">`My`</ph> extension when a reference to a specified assembly is added to a project.","source":"Automatically adding your custom `My` extension when a reference to a specified assembly is added to a project."},{"pos":[1411,1538],"content":"Hiding the <ph id=\"ph1\">`My`</ph> extension item template in the <bpt id=\"p1\">**</bpt>Add Item<ept id=\"p1\">**</ept> dialog box so that it is not included in the list of project items.","source":"Hiding the `My` extension item template in the **Add Item** dialog box so that it is not included in the list of project items."},{"content":"This topic discusses how to package a custom <ph id=\"ph1\">`My`</ph> extension as a hidden item template that can be managed from the <bpt id=\"p1\">**</bpt>My Extensions<ept id=\"p1\">**</ept> page of the Visual Basic Project Designer.","pos":[1540,1715],"source":"This topic discusses how to package a custom `My` extension as a hidden item template that can be managed from the **My Extensions** page of the Visual Basic Project Designer."},{"content":"The custom <ph id=\"ph1\">`My`</ph> extension can also be added automatically when a reference to a specified assembly is added to a project.","pos":[1716,1837],"source":" The custom `My` extension can also be added automatically when a reference to a specified assembly is added to a project."},{"pos":[1842,1873],"content":"Create a My namespace extension","linkify":"Create a My namespace extension","nodes":[{"content":"Create a My namespace extension","pos":[0,31]}]},{"content":"The first step in creating a deployment package for a custom <ph id=\"ph1\">`My`</ph> extension is to create the extension as a single code file.","pos":[1875,2000],"source":"The first step in creating a deployment package for a custom `My` extension is to create the extension as a single code file."},{"content":"For details and guidance about how to create a custom <ph id=\"ph1\">`My`</ph> extension, see <bpt id=\"p1\">[</bpt>Extending the My Namespace in Visual Basic<ept id=\"p1\">](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.md)</ept>.","pos":[2001,2214],"source":" For details and guidance about how to create a custom `My` extension, see [Extending the My Namespace in Visual Basic](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.md)."},{"pos":[2219,2270],"content":"Export a My namespace extension as an item template","linkify":"Export a My namespace extension as an item template","nodes":[{"content":"Export a My namespace extension as an item template","pos":[0,51]}]},{"content":"After you have a code file that includes your <ph id=\"ph1\">`My`</ph> namespace extension, you can export the code file as a Visual Studio item template.","pos":[2272,2406],"source":"After you have a code file that includes your `My` namespace extension, you can export the code file as a Visual Studio item template."},{"content":"For instructions on how to export a file as a Visual Studio item template, see <bpt id=\"p1\">[</bpt>How to: Create Item Templates<ept id=\"p1\">](/visualstudio/ide/how-to-create-item-templates)</ept>.","pos":[2407,2566],"source":" For instructions on how to export a file as a Visual Studio item template, see [How to: Create Item Templates](/visualstudio/ide/how-to-create-item-templates)."},{"pos":[2570,2917],"content":"[!NOTE]\nIf your `My` namespace extension has a dependency on a particular assembly, you can customize your item template to automatically install your `My` namespace extension when a reference to that assembly is added. As a result, you will want to exclude that assembly reference when you export the code file as a Visual Studio item template.","leadings":["","> "],"nodes":[{"content":"If your `My` namespace extension has a dependency on a particular assembly, you can customize your item template to automatically install your `My` namespace extension when a reference to that assembly is added. As a result, you will want to exclude that assembly reference when you export the code file as a Visual Studio item template.","pos":[8,345],"nodes":[{"content":"If your <ph id=\"ph1\">`My`</ph> namespace extension has a dependency on a particular assembly, you can customize your item template to automatically install your <ph id=\"ph2\">`My`</ph> namespace extension when a reference to that assembly is added.","pos":[0,211],"source":"If your `My` namespace extension has a dependency on a particular assembly, you can customize your item template to automatically install your `My` namespace extension when a reference to that assembly is added."},{"content":"As a result, you will want to exclude that assembly reference when you export the code file as a Visual Studio item template.","pos":[212,337]}]}]},{"pos":[2922,2949],"content":"Customize the item template","linkify":"Customize the item template","nodes":[{"content":"Customize the item template","pos":[0,27]}]},{"content":"You can enable your item template to be managed from the <bpt id=\"p1\">**</bpt>My Extensions<ept id=\"p1\">**</ept> page of the Visual Basic Project Designer.","pos":[2951,3068],"source":"You can enable your item template to be managed from the **My Extensions** page of the Visual Basic Project Designer."},{"content":"You can also enable the item template to be added automatically when a reference to a specified assembly is added to a project.","pos":[3069,3196]},{"content":"To enable these customizations, you will add a new file, called the CustomData file, to your template, and then add a new element to the XML in your .vstemplate file.","pos":[3197,3363]},{"pos":[3369,3392],"content":"Add the CustomData file","linkify":"Add the CustomData file","nodes":[{"content":"Add the CustomData file","pos":[0,23]}]},{"content":"The CustomData file is a text file that has a file name extension of .CustomData (the file name can be set to any value meaningful to your template) and that contains XML.","pos":[3394,3565]},{"content":"The XML in the CustomData file instructs Visual Basic to include your <ph id=\"ph1\">`My`</ph> extension when users use the <bpt id=\"p1\">**</bpt>My Extensions<ept id=\"p1\">**</ept> page of the Visual Basic Project Designer.","pos":[3566,3730],"source":" The XML in the CustomData file instructs Visual Basic to include your `My` extension when users use the **My Extensions** page of the Visual Basic Project Designer."},{"content":"You can optionally add the &lt;<ph id=\"ph1\">`AssemblyFullName&gt;`</ph> attribute to your CustomData file XML.","pos":[3731,3817],"source":" You can optionally add the <`AssemblyFullName>` attribute to your CustomData file XML."},{"content":"This instructs Visual Basic to automatically install your custom <ph id=\"ph1\">`My`</ph> extension when a reference to a particular assembly is added to the project.","pos":[3818,3964],"source":" This instructs Visual Basic to automatically install your custom `My` extension when a reference to a particular assembly is added to the project."},{"content":"You can use any text editor or XML editor to create the CustomData file, and then add it to your item template's compressed folder (.zip file).","pos":[3965,4108]},{"content":"For example, the following XML shows the contents of a CustomData file that will add the template item to the My Extensions folder of a Visual Basic project when a reference to the Microsoft.VisualBasic.PowerPacks.Vs.dll assembly is added to the project.","pos":[4110,4364]},{"pos":[4551,4669],"content":"The CustomData file contains a &lt;<ph id=\"ph1\">`VBMyExtensionTemplate&gt;`</ph> element that has attributes as listed in the following table.","source":"The CustomData file contains a <`VBMyExtensionTemplate>` element that has attributes as listed in the following table."},{"content":"Attribute","pos":[4672,4681]},{"content":"Description","pos":[4682,4693]},{"content":"Required.","pos":[4711,4720]},{"content":"A unique identifier for the extension.","pos":[4721,4759]},{"content":"If the extension that has this ID has already been added to the project, the user will not be prompted to add it again.","pos":[4760,4879]},{"content":"Required.","pos":[4892,4901]},{"content":"A version number for the item template.","pos":[4902,4941]},{"content":"Optional.","pos":[4963,4972]},{"content":"An assembly name.","pos":[4973,4990]},{"content":"When a reference to this assembly is added to the project, the user will be prompted to add the <ph id=\"ph1\">`My`</ph> extension from this item template.","pos":[4991,5126],"source":" When a reference to this assembly is added to the project, the user will be prompted to add the `My` extension from this item template."},{"pos":[5133,5195],"content":"Add the \\<CustomDataSignature> element to the .vstemplate file","linkify":"Add the \\<CustomDataSignature> element to the .vstemplate file","nodes":[{"content":"Add the <ph id=\"ph1\">\\&lt;</ph>CustomDataSignature&gt; element to the .vstemplate file","pos":[0,62],"source":"Add the \\<CustomDataSignature> element to the .vstemplate file"}]},{"content":"To identify your Visual Studio item template as a <ph id=\"ph1\">`My`</ph> namespace extension, you must also modify the .vstemplate file for your item template.","pos":[5197,5338],"source":"To identify your Visual Studio item template as a `My` namespace extension, you must also modify the .vstemplate file for your item template."},{"content":"You must add a <ph id=\"ph1\">`&lt;CustomDataSignature&gt;`</ph> element to the <ph id=\"ph2\">`&lt;TemplateData&gt;`</ph> element.","pos":[5339,5418],"source":" You must add a `<CustomDataSignature>` element to the `<TemplateData>` element."},{"content":"The <ph id=\"ph1\">`&lt;CustomDataSignature&gt;`</ph> element must contain the text <ph id=\"ph2\">`Microsoft.VisualBasic.MyExtension`</ph>, as shown in the following example.","pos":[5419,5548],"source":" The `<CustomDataSignature>` element must contain the text `Microsoft.VisualBasic.MyExtension`, as shown in the following example."},{"content":"You cannot modify files in a compressed folder (.zip file) directly.","pos":[5639,5707]},{"content":"You must copy the .vstemplate file from the compressed folder, modify it, and then replace the .vstemplate file in the compressed folder with your updated copy.","pos":[5708,5868]},{"pos":[5870,5984],"content":"The following example shows the contents of a .vstemplate file that has the <ph id=\"ph1\">`&lt;CustomDataSignature&gt;`</ph> element added.","source":"The following example shows the contents of a .vstemplate file that has the `<CustomDataSignature>` element added."},{"pos":[6739,6759],"content":"Install the template","linkify":"Install the template","nodes":[{"content":"Install the template","pos":[0,20]}]},{"content":"To install the template, you can copy the compressed folder (<bpt id=\"p1\">*</bpt>.zip<ept id=\"p1\">*</ept> file) to the Visual Basic item templates folder.","pos":[6761,6877],"source":"To install the template, you can copy the compressed folder (*.zip* file) to the Visual Basic item templates folder."},{"content":"By default, user item templates are located in <bpt id=\"p1\">*</bpt>%USERPROFILE%\\Documents\\Visual Studio <ph id=\"ph1\">\\&lt;</ph>Version<ph id=\"ph2\">\\&gt;</ph>\\Templates\\ItemTemplates\\Visual Basic<ept id=\"p1\">*</ept>.","pos":[6878,7014],"source":" By default, user item templates are located in *%USERPROFILE%\\Documents\\Visual Studio \\<Version\\>\\Templates\\ItemTemplates\\Visual Basic*."},{"content":"Alternatively, you can publish the template as a Visual Studio Installer (<bpt id=\"p1\">*</bpt>.vsi<ept id=\"p1\">*</ept>) file.","pos":[7015,7102],"source":" Alternatively, you can publish the template as a Visual Studio Installer (*.vsi*) file."},{"pos":[7107,7115],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7119,7257],"content":"<bpt id=\"p1\">[</bpt>Extending the My Namespace in Visual Basic<ept id=\"p1\">](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.md)</ept>","source":"[Extending the My Namespace in Visual Basic](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.md)"},{"pos":[7260,7418],"content":"<bpt id=\"p1\">[</bpt>Extending the Visual Basic Application Model<ept id=\"p1\">](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-visual-basic-application-model.md)</ept>","source":"[Extending the Visual Basic Application Model](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-visual-basic-application-model.md)"},{"pos":[7421,7581],"content":"<bpt id=\"p1\">[</bpt>Customizing Which Objects are Available in My<ept id=\"p1\">](../../../visual-basic/developing-apps/customizing-extending-my/customizing-which-objects-are-available-in-my.md)</ept>","source":"[Customizing Which Objects are Available in My](../../../visual-basic/developing-apps/customizing-extending-my/customizing-which-objects-are-available-in-my.md)"},{"pos":[7584,7700],"content":"<bpt id=\"p1\">[</bpt>My Extensions Page, Project Designer<ept id=\"p1\">](/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic)</ept>","source":"[My Extensions Page, Project Designer](/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic)"}]}