{"content":"---\ntitle: \"LockClrVersion Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"LockClrVersion\"\napi_location: \n  - \"mscoree.dll\"\n  - \"mscoreei.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"LockClrVersion\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"LockClrVersion function [.NET Framework hosting]\"\nms.assetid: 1318ee37-c43b-40eb-bbe8-88fc46453d74\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 15\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# LockClrVersion Function\nAllows the host to determine which version of the common language runtime (CLR) will be used within the process before explicitly initializing the CLR.  \n  \n This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)].  \n  \n## Syntax  \n  \n```  \nHRESULT LockClrVersion (  \n    [in] FLockClrVersionCallback   hostCallback,  \n    [in] FLockClrVersionCallback  *pBeginHostSetup,  \n    [in] FLockClrVersionCallback  *pEndHostSetup  \n);  \n```  \n  \n#### Parameters  \n `hostCallback`  \n [in] The function to be called by the CLR upon initialization.  \n  \n `pBeginHostSetup`  \n [in] The function to be called by the host to inform the CLR that initialization is starting.  \n  \n `pEndHostSetup`  \n [in] The function to be called by the host to inform the CLR that initialization is complete.  \n  \n## Return Value  \n This method returns standard COM error codes, as defined in WinError.h, in addition to the following values.  \n  \n|Return code|Description|  \n|-----------------|-----------------|  \n|S_OK|The method completed successfully.|  \n|E_INVALIDARG|One or more of the arguments is null.|  \n  \n## Remarks  \n The host calls `LockClrVersion` before initializing the CLR. `LockClrVersion` takes three parameters, all of which are callbacks of type [FLockClrVersionCallback](../../../../docs/framework/unmanaged-api/hosting/flockclrversioncallback-function-pointer.md). This type is defined as follows.  \n  \n```  \ntypedef HRESULT ( __stdcall *FLockClrVersionCallback ) ();  \n```  \n  \n The following steps occur upon initialization of the runtime:  \n  \n1.  The host calls [CorBindToRuntimeEx](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md) or one of the other runtime initialization functions. Alternatively, the host could initialize the runtime using COM object activation.  \n  \n2.  The runtime calls the function specified by the `hostCallback` parameter.  \n  \n3.  The function specified by `hostCallback` then makes the following sequence of calls:  \n  \n    -   The function specified by the `pBeginHostSetup` parameter.  \n  \n    -   `CorBindToRuntimeEx` (or another runtime initialization function).  \n  \n    -   [ICLRRuntimeHost::SetHostControl](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-sethostcontrol-method.md).  \n  \n    -   [ICLRRuntimeHost::Start](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-start-method.md).  \n  \n    -   The function specified by the `pEndHostSetup` parameter.  \n  \n All the calls from `pBeginHostSetup` to `pEndHostSetup` must occur on a single thread or fiber, with the same logical stack. This thread can be different from the thread upon which `hostCallback` is called.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See Also  \n [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)","nodes":[{"pos":[4,622],"embed":true,"restype":"x-metadata","content":"title: \"LockClrVersion Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"LockClrVersion\"\napi_location: \n  - \"mscoree.dll\"\n  - \"mscoreei.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"LockClrVersion\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"LockClrVersion function [.NET Framework hosting]\"\nms.assetid: 1318ee37-c43b-40eb-bbe8-88fc46453d74\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 15\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"LockClrVersion Function | Microsoft Docs","nodes":[{"pos":[0,40],"content":"LockClrVersion Function | Microsoft Docs","nodes":[{"content":"LockClrVersion Function | Microsoft Docs","pos":[0,40]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[629,652],"content":"LockClrVersion Function","linkify":"LockClrVersion Function","nodes":[{"content":"LockClrVersion Function","pos":[0,23]}]},{"content":"Allows the host to determine which version of the common language runtime (CLR) will be used within the process before explicitly initializing the CLR.","pos":[653,804]},{"pos":[811,918],"content":"This function has been deprecated in the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph>.","source":"This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]."},{"pos":[927,933],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1147,1157],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The function to be called by the CLR upon initialization.","pos":[1179,1241]},{"content":"[in] The function to be called by the host to inform the CLR that initialization is starting.","pos":[1269,1362]},{"content":"[in] The function to be called by the host to inform the CLR that initialization is complete.","pos":[1388,1481]},{"pos":[1490,1502],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns standard COM error codes, as defined in WinError.h, in addition to the following values.","pos":[1506,1614]},{"content":"Return code","pos":[1621,1632]},{"content":"Description","pos":[1633,1644]},{"content":"S_OK","pos":[1689,1693]},{"content":"The method completed successfully.","pos":[1694,1728]},{"content":"E_INVALIDARG","pos":[1733,1745]},{"content":"One or more of the arguments is null.","pos":[1746,1783]},{"pos":[1793,1800],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The host calls <ph id=\"ph1\">`LockClrVersion`</ph> before initializing the CLR.","pos":[1804,1864],"source":"The host calls `LockClrVersion` before initializing the CLR."},{"content":"<ph id=\"ph1\">`LockClrVersion`</ph> takes three parameters, all of which are callbacks of type <bpt id=\"p1\">[</bpt>FLockClrVersionCallback<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/flockclrversioncallback-function-pointer.md)</ept>.","pos":[1865,2061],"source":"`LockClrVersion` takes three parameters, all of which are callbacks of type [FLockClrVersionCallback](../../../../docs/framework/unmanaged-api/hosting/flockclrversioncallback-function-pointer.md)."},{"content":"This type is defined as follows.","pos":[2062,2094]},{"content":"The following steps occur upon initialization of the runtime:","pos":[2177,2238]},{"content":"The host calls <bpt id=\"p1\">[</bpt>CorBindToRuntimeEx<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)</ept> or one of the other runtime initialization functions.","pos":[2248,2418],"source":"The host calls [CorBindToRuntimeEx](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md) or one of the other runtime initialization functions."},{"content":"Alternatively, the host could initialize the runtime using COM object activation.","pos":[2419,2500]},{"pos":[2510,2583],"content":"The runtime calls the function specified by the <ph id=\"ph1\">`hostCallback`</ph> parameter.","source":"The runtime calls the function specified by the `hostCallback` parameter."},{"pos":[2593,2677],"content":"The function specified by <ph id=\"ph1\">`hostCallback`</ph> then makes the following sequence of calls:","source":"The function specified by `hostCallback` then makes the following sequence of calls:"},{"pos":[2691,2749],"content":"The function specified by the <ph id=\"ph1\">`pBeginHostSetup`</ph> parameter.","source":"The function specified by the `pBeginHostSetup` parameter."},{"pos":[2763,2829],"content":"<ph id=\"ph1\">`CorBindToRuntimeEx`</ph> (or another runtime initialization function).","source":"`CorBindToRuntimeEx` (or another runtime initialization function)."},{"pos":[2843,2968],"content":"<bpt id=\"p1\">[</bpt>ICLRRuntimeHost::SetHostControl<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-sethostcontrol-method.md)</ept>.","source":"[ICLRRuntimeHost::SetHostControl](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-sethostcontrol-method.md)."},{"pos":[2982,3089],"content":"<bpt id=\"p1\">[</bpt>ICLRRuntimeHost::Start<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-start-method.md)</ept>.","source":"[ICLRRuntimeHost::Start](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-start-method.md)."},{"pos":[3103,3159],"content":"The function specified by the <ph id=\"ph1\">`pEndHostSetup`</ph> parameter.","source":"The function specified by the `pEndHostSetup` parameter."},{"content":"All the calls from <ph id=\"ph1\">`pBeginHostSetup`</ph> to <ph id=\"ph2\">`pEndHostSetup`</ph> must occur on a single thread or fiber, with the same logical stack.","pos":[3166,3290],"source":"All the calls from `pBeginHostSetup` to `pEndHostSetup` must occur on a single thread or fiber, with the same logical stack."},{"content":"This thread can be different from the thread upon which <ph id=\"ph1\">`hostCallback`</ph> is called.","pos":[3291,3372],"source":" This thread can be different from the thread upon which `hostCallback` is called."},{"pos":[3381,3393],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3397,3501],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3508,3529],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[3536,3560],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> MSCorEE.dll","source":"**Library:** MSCorEE.dll"},{"pos":[3567,3675],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[3684,3692],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[3696,3816],"content":"<bpt id=\"p1\">[</bpt>Deprecated CLR Hosting Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)</ept>","source":"[Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)"}]}