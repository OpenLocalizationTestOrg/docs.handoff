{"content":"---\ntitle: \"Fixed Size Buffers - C# Programming Guide\"\nms.custom: seodec18\nms.date: 04/20/2018\nhelpviewer_keywords: \n  - \"fixed size buffers [C#]\"\n  - \"unsafe buffers [C#]\"\n  - \"unsafe code [C#], fixed size buffers\"\n---\n# Fixed Size Buffers (C# Programming Guide)\n\nIn C#, you can use the [fixed](../../language-reference/keywords/fixed-statement.md) statement to create a buffer with a fixed size array in a data structure. Fixed size buffers are useful when you write methods that interop with data sources from other languages or platforms. The fixed array can take any attributes or modifiers that are allowed for regular struct members. The only restriction is that the array type must be `bool`, `byte`, `char`, `short`, `int`, `long`, `sbyte`, `ushort`, `uint`, `ulong`, `float`, or `double`.\n\n```csharp\nprivate fixed char name[30];\n```\n\n## Remarks\n\nIn safe code, a C# struct that contains an array does not contain the array elements. Instead, the struct contains a reference to the elements. You can embed an array of fixed size in a [struct](../../language-reference/keywords/struct.md) when it is used in an [unsafe](../../language-reference/keywords/unsafe.md) code block.\n\nThe following `struct` is 8 bytes in size. The `pathName` array is a reference:\n\n[!code-csharp[Struct with embedded array](../../../../samples/snippets/csharp/keywords/FixedKeywordExamples.cs#6)]\n\nA `struct` can contain an embedded array in unsafe code. In the following example, the `fixedBuffer` array has a fixed size. You use a `fixed` statement to establish a pointer to the first element. You access the elements of the array through this pointer. The `fixed` statement pins the `fixedBuffer` instance field to a specific location in memory.\n\n[!code-csharp[Struct with embedded inline array](../../../../samples/snippets/csharp/keywords/FixedKeywordExamples.cs#7)]\n\nThe size of the 128 element `char` array is 256 bytes. Fixed size [char](../../language-reference/keywords/char.md) buffers always take two bytes per character, regardless of the encoding. This is true even when char buffers are marshaled to API methods or structs with `CharSet = CharSet.Auto` or `CharSet = CharSet.Ansi`. For more information, see <xref:System.Runtime.InteropServices.CharSet>.\n\nThe  preceding example demonstrates accessing `fixed` fields without pinning, which is available starting with C# 7.3.\n\nAnother common fixed-size array is the [bool](../../language-reference/keywords/bool.md) array. The elements in a `bool` array are always one byte in size. `bool` arrays are not appropriate for creating bit arrays or buffers.\n\n> [!NOTE]\n> Except for memory created by using [stackalloc](../../language-reference/keywords/stackalloc.md), the C# compiler and the common language runtime (CLR) do not perform any security buffer overrun checks. As with all unsafe code, use caution.\n\nUnsafe buffers differ from regular arrays in the following ways:\n\n- You can only use unsafe buffers in an unsafe context.\n- Unsafe buffers are always vectors, or one-dimensional arrays.\n- The declaration of the array should include a count, such as `char id[8]`. You cannot use `char id[]`.\n- Unsafe buffers can only be instance fields of structs in an unsafe context.\n\n## See also\n\n- [C# Programming Guide](../index.md)\n- [Unsafe Code and Pointers](index.md)\n- [fixed Statement](../../language-reference/keywords/fixed-statement.md)\n- [Interoperability](../interop/index.md)\n","nodes":[{"pos":[4,215],"embed":true,"restype":"x-metadata","content":"title: \"Fixed Size Buffers - C# Programming Guide\"\nms.custom: seodec18\nms.date: 04/20/2018\nhelpviewer_keywords: \n  - \"fixed size buffers [C#]\"\n  - \"unsafe buffers [C#]\"\n  - \"unsafe code [C#], fixed size buffers\"","nodes":[{"content":"Fixed Size Buffers - C# Programming Guide","nodes":[{"pos":[0,41],"content":"Fixed Size Buffers - C# Programming Guide","nodes":[{"content":"Fixed Size Buffers - C# Programming Guide","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[222,263],"content":"Fixed Size Buffers (C# Programming Guide)","linkify":"Fixed Size Buffers (C# Programming Guide)","nodes":[{"content":"Fixed Size Buffers (C# Programming Guide)","pos":[0,41]}]},{"content":"In C#, you can use the <bpt id=\"p1\">[</bpt>fixed<ept id=\"p1\">](../../language-reference/keywords/fixed-statement.md)</ept> statement to create a buffer with a fixed size array in a data structure.","pos":[265,423],"source":"In C#, you can use the [fixed](../../language-reference/keywords/fixed-statement.md) statement to create a buffer with a fixed size array in a data structure."},{"content":"Fixed size buffers are useful when you write methods that interop with data sources from other languages or platforms.","pos":[424,542]},{"content":"The fixed array can take any attributes or modifiers that are allowed for regular struct members.","pos":[543,640]},{"content":"The only restriction is that the array type must be <ph id=\"ph1\">`bool`</ph>, <ph id=\"ph2\">`byte`</ph>, <ph id=\"ph3\">`char`</ph>, <ph id=\"ph4\">`short`</ph>, <ph id=\"ph5\">`int`</ph>, <ph id=\"ph6\">`long`</ph>, <ph id=\"ph7\">`sbyte`</ph>, <ph id=\"ph8\">`ushort`</ph>, <ph id=\"ph9\">`uint`</ph>, <ph id=\"ph10\">`ulong`</ph>, <ph id=\"ph11\">`float`</ph>, or <ph id=\"ph12\">`double`</ph>.","pos":[641,798],"source":" The only restriction is that the array type must be `bool`, `byte`, `char`, `short`, `int`, `long`, `sbyte`, `ushort`, `uint`, `ulong`, `float`, or `double`."},{"pos":[847,854],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"In safe code, a C# struct that contains an array does not contain the array elements.","pos":[856,941]},{"content":"Instead, the struct contains a reference to the elements.","pos":[942,999]},{"content":"You can embed an array of fixed size in a <bpt id=\"p1\">[</bpt>struct<ept id=\"p1\">](../../language-reference/keywords/struct.md)</ept> when it is used in an <bpt id=\"p2\">[</bpt>unsafe<ept id=\"p2\">](../../language-reference/keywords/unsafe.md)</ept> code block.","pos":[1000,1183],"source":" You can embed an array of fixed size in a [struct](../../language-reference/keywords/struct.md) when it is used in an [unsafe](../../language-reference/keywords/unsafe.md) code block."},{"content":"The following <ph id=\"ph1\">`struct`</ph> is 8 bytes in size.","pos":[1185,1227],"source":"The following `struct` is 8 bytes in size."},{"content":"The <ph id=\"ph1\">`pathName`</ph> array is a reference:","pos":[1228,1264],"source":" The `pathName` array is a reference:"},{"content":"A <ph id=\"ph1\">`struct`</ph> can contain an embedded array in unsafe code.","pos":[1382,1438],"source":"A `struct` can contain an embedded array in unsafe code."},{"content":"In the following example, the <ph id=\"ph1\">`fixedBuffer`</ph> array has a fixed size.","pos":[1439,1506],"source":" In the following example, the `fixedBuffer` array has a fixed size."},{"content":"You use a <ph id=\"ph1\">`fixed`</ph> statement to establish a pointer to the first element.","pos":[1507,1579],"source":" You use a `fixed` statement to establish a pointer to the first element."},{"content":"You access the elements of the array through this pointer.","pos":[1580,1638]},{"content":"The <ph id=\"ph1\">`fixed`</ph> statement pins the <ph id=\"ph2\">`fixedBuffer`</ph> instance field to a specific location in memory.","pos":[1639,1732],"source":" The `fixed` statement pins the `fixedBuffer` instance field to a specific location in memory."},{"content":"The size of the 128 element <ph id=\"ph1\">`char`</ph> array is 256 bytes.","pos":[1857,1911],"source":"The size of the 128 element `char` array is 256 bytes."},{"content":"Fixed size <bpt id=\"p1\">[</bpt>char<ept id=\"p1\">](../../language-reference/keywords/char.md)</ept> buffers always take two bytes per character, regardless of the encoding.","pos":[1912,2045],"source":" Fixed size [char](../../language-reference/keywords/char.md) buffers always take two bytes per character, regardless of the encoding."},{"content":"This is true even when char buffers are marshaled to API methods or structs with <ph id=\"ph1\">`CharSet = CharSet.Auto`</ph> or <ph id=\"ph2\">`CharSet = CharSet.Ansi`</ph>.","pos":[2046,2180],"source":" This is true even when char buffers are marshaled to API methods or structs with `CharSet = CharSet.Auto` or `CharSet = CharSet.Ansi`."},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.CharSet&gt;</ph>.","pos":[2181,2253],"source":" For more information, see <xref:System.Runtime.InteropServices.CharSet>."},{"pos":[2255,2373],"content":"The  preceding example demonstrates accessing <ph id=\"ph1\">`fixed`</ph> fields without pinning, which is available starting with C# 7.3.","source":"The  preceding example demonstrates accessing `fixed` fields without pinning, which is available starting with C# 7.3."},{"content":"Another common fixed-size array is the <bpt id=\"p1\">[</bpt>bool<ept id=\"p1\">](../../language-reference/keywords/bool.md)</ept> array.","pos":[2375,2470],"source":"Another common fixed-size array is the [bool](../../language-reference/keywords/bool.md) array."},{"content":"The elements in a <ph id=\"ph1\">`bool`</ph> array are always one byte in size.","pos":[2471,2530],"source":" The elements in a `bool` array are always one byte in size."},{"content":"<ph id=\"ph1\">`bool`</ph> arrays are not appropriate for creating bit arrays or buffers.","pos":[2531,2600],"source":"`bool` arrays are not appropriate for creating bit arrays or buffers."},{"pos":[2604,2854],"content":"[!NOTE]\nExcept for memory created by using [stackalloc](../../language-reference/keywords/stackalloc.md), the C# compiler and the common language runtime (CLR) do not perform any security buffer overrun checks. As with all unsafe code, use caution.","leadings":["","> "],"nodes":[{"content":"Except for memory created by using [stackalloc](../../language-reference/keywords/stackalloc.md), the C# compiler and the common language runtime (CLR) do not perform any security buffer overrun checks. As with all unsafe code, use caution.","pos":[8,248],"nodes":[{"content":"Except for memory created by using <bpt id=\"p1\">[</bpt>stackalloc<ept id=\"p1\">](../../language-reference/keywords/stackalloc.md)</ept>, the C# compiler and the common language runtime (CLR) do not perform any security buffer overrun checks.","pos":[0,202],"source":"Except for memory created by using [stackalloc](../../language-reference/keywords/stackalloc.md), the C# compiler and the common language runtime (CLR) do not perform any security buffer overrun checks."},{"content":"As with all unsafe code, use caution.","pos":[203,240]}]}]},{"content":"Unsafe buffers differ from regular arrays in the following ways:","pos":[2856,2920]},{"content":"You can only use unsafe buffers in an unsafe context.","pos":[2924,2977]},{"content":"Unsafe buffers are always vectors, or one-dimensional arrays.","pos":[2980,3041]},{"content":"The declaration of the array should include a count, such as <ph id=\"ph1\">`char id[8]`</ph>.","pos":[3044,3118],"source":"The declaration of the array should include a count, such as `char id[8]`."},{"content":"You cannot use <ph id=\"ph1\">`char id[]`</ph>.","pos":[3119,3146],"source":" You cannot use `char id[]`."},{"content":"Unsafe buffers can only be instance fields of structs in an unsafe context.","pos":[3149,3224]},{"pos":[3229,3237],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3241,3276],"content":"<bpt id=\"p1\">[</bpt>C# Programming Guide<ept id=\"p1\">](../index.md)</ept>","source":"[C# Programming Guide](../index.md)"},{"pos":[3279,3315],"content":"<bpt id=\"p1\">[</bpt>Unsafe Code and Pointers<ept id=\"p1\">](index.md)</ept>","source":"[Unsafe Code and Pointers](index.md)"},{"pos":[3318,3389],"content":"<bpt id=\"p1\">[</bpt>fixed Statement<ept id=\"p1\">](../../language-reference/keywords/fixed-statement.md)</ept>","source":"[fixed Statement](../../language-reference/keywords/fixed-statement.md)"},{"pos":[3392,3431],"content":"<bpt id=\"p1\">[</bpt>Interoperability<ept id=\"p1\">](../interop/index.md)</ept>","source":"[Interoperability](../interop/index.md)"}]}