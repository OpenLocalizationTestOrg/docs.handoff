{"content":"---\ntitle: \"Nesting DataRelations\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 9530f9c9-dd98-4b93-8cdb-40d7f1e8d0ab\n---\n# Nesting DataRelations\nIn a relational representation of data, individual tables contain rows that are related to one another using a column or set of columns. In the ADO.NET <xref:System.Data.DataSet>, the relationship between tables is implemented using a <xref:System.Data.DataRelation>. When you create a **DataRelation**, the parent-child relationships of the columns are managed only through the relation. The tables and columns are separate entities. In the hierarchical representation of data that XML provides, the parent-child relationships are represented by parent elements that contain nested child elements.  \n  \n To facilitate the nesting of child objects when a **DataSet** is synchronized with an <xref:System.Xml.XmlDataDocument> or written as XML data using **WriteXml**, the **DataRelation** exposes a **Nested** property. Setting the **Nested** property of a **DataRelation** to **true** causes the child rows of the relation to be nested within the parent column when written as XML data or synchronized with an **XmlDataDocument**. The **Nested** property of the **DataRelation** is **false**, by default.  \n  \n For example, consider the following **DataSet**.  \n  \n```vb  \n' Assumes connection is a valid SqlConnection.  \nDim customerAdapter As SqlDataAdapter = New SqlDataAdapter( _  \n  \"SELECT CustomerID, CompanyName FROM Customers\", connection)  \nDim orderAdapter As SqlDataAdapter = New SqlDataAdapter( _  \n  \"SELECT OrderID, CustomerID, OrderDate FROM Orders\", connection)  \n  \nconnection.Open()  \n  \nDim dataSet As DataSet = New DataSet(\"CustomerOrders\")  \ncustomerAdapter.Fill(dataSet, \"Customers\")  \norderAdapter.Fill(dataSet, \"Orders\")  \n  \nconnection.Close()  \n  \nDim customerOrders As DataRelation = dataSet.Relations.Add( _  \n  \"CustOrders\", dataSet.Tables(\"Customers\").Columns(\"CustomerID\"), _  \n  dataSet.Tables(\"Orders\").Columns(\"CustomerID\"))  \n```  \n  \n```csharp  \n// Assumes connection is a valid SqlConnection.  \nSqlDataAdapter customerAdapter = new SqlDataAdapter(  \n  \"SELECT CustomerID, CompanyName FROM Customers\", connection);  \nSqlDataAdapter orderAdapter = new SqlDataAdapter(  \n  \"SELECT OrderID, CustomerID, OrderDate FROM Orders\", connection);  \n  \nconnection.Open();  \n  \nDataSet dataSet = new DataSet(\"CustomerOrders\");  \ncustomerAdapter.Fill(dataSet, \"Customers\");  \norderAdapter.Fill(dataSet, \"Orders\");  \n  \nconnection.Close();  \n  \nDataRelation customerOrders = dataSet.Relations.Add(  \n  \"CustOrders\", dataSet.Tables[\"Customers\"].Columns[\"CustomerID\"],  \n  dataSet.Tables[\"Orders\"].Columns[\"CustomerID\"]);  \n```  \n  \n Because the **Nested** property of the **DataRelation** object is not set to **true** for this **DataSet**, the child objects are not nested within the parent elements when this **DataSet** is represented as XML data. Transforming the XML representation of a **DataSet** that contains related **DataSet**s with non-nested data relations can cause slow performance. We recommend that you nest the data relations. To do this, set the **Nested** property to **true**. Then write code in the XSLT style sheet that uses top-down hierarchical XPath query expressions to locate and transform the data.  \n  \n The following code example shows the result from calling **WriteXml** on the **DataSet**.  \n  \n```xml  \n<CustomerOrders>  \n  <Customers>  \n    <CustomerID>ALFKI</CustomerID>  \n    <CompanyName>Alfreds Futterkiste</CompanyName>  \n  </Customers>  \n  <Customers>  \n    <CustomerID>ANATR</CustomerID>  \n    <CompanyName>Ana Trujillo Emparedados y helados</CompanyName>  \n  </Customers>  \n  <Orders>  \n    <OrderID>10643</OrderID>  \n    <CustomerID>ALFKI</CustomerID>  \n    <OrderDate>1997-08-25T00:00:00</OrderDate>  \n  </Orders>  \n  <Orders>  \n    <OrderID>10692</OrderID>  \n    <CustomerID>ALFKI</CustomerID>  \n    <OrderDate>1997-10-03T00:00:00</OrderDate>  \n  </Orders>  \n  <Orders>  \n    <OrderID>10308</OrderID>  \n    <CustomerID>ANATR</CustomerID>  \n    <OrderDate>1996-09-18T00:00:00</OrderDate>  \n  </Orders>  \n</CustomerOrders>  \n```  \n  \n Note that the **Customers** element and the **Orders** elements are shown as sibling elements. If you wanted the **Orders** elements to show up as children of their respective parent elements, the **Nested** property of the **DataRelation** would need to be set to **true** and you would add the following:  \n  \n```vb  \ncustomerOrders.Nested = True  \n```  \n  \n```csharp  \ncustomerOrders.Nested = true;  \n```  \n  \n The following code shows what the resulting output would look like, with the **Orders** elements nested within their respective parent elements.  \n  \n```xml  \n<CustomerOrders>  \n  <Customers>  \n    <CustomerID>ALFKI</CustomerID>  \n    <Orders>  \n      <OrderID>10643</OrderID>  \n      <CustomerID>ALFKI</CustomerID>  \n      <OrderDate>1997-08-25T00:00:00</OrderDate>  \n    </Orders>  \n    <Orders>  \n      <OrderID>10692</OrderID>  \n      <CustomerID>ALFKI</CustomerID>  \n      <OrderDate>1997-10-03T00:00:00</OrderDate>  \n    </Orders>  \n    <CompanyName>Alfreds Futterkiste</CompanyName>  \n  </Customers>  \n  <Customers>  \n    <CustomerID>ANATR</CustomerID>  \n    <Orders>  \n      <OrderID>10308</OrderID>  \n      <CustomerID>ANATR</CustomerID>  \n      <OrderDate>1996-09-18T00:00:00</OrderDate>  \n    </Orders>  \n    <CompanyName>Ana Trujillo Emparedados y helados</CompanyName>  \n  </Customers>  \n</CustomerOrders>  \n```  \n  \n## See also\n\n- [Using XML in a DataSet](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/using-xml-in-a-dataset.md)\n- [Adding DataRelations](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/adding-datarelations.md)\n- [DataSets, DataTables, and DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,139],"embed":true,"restype":"x-metadata","content":"title: \"Nesting DataRelations\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 9530f9c9-dd98-4b93-8cdb-40d7f1e8d0ab","nodes":[{"content":"Nesting DataRelations","nodes":[{"pos":[0,21],"content":"Nesting DataRelations","nodes":[{"content":"Nesting DataRelations","pos":[0,21]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[146,167],"content":"Nesting DataRelations","linkify":"Nesting DataRelations","nodes":[{"content":"Nesting DataRelations","pos":[0,21]}]},{"content":"In a relational representation of data, individual tables contain rows that are related to one another using a column or set of columns.","pos":[168,304]},{"content":"In the ADO.NET <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph>, the relationship between tables is implemented using a <ph id=\"ph2\">&lt;xref:System.Data.DataRelation&gt;</ph>.","pos":[305,435],"source":" In the ADO.NET <xref:System.Data.DataSet>, the relationship between tables is implemented using a <xref:System.Data.DataRelation>."},{"content":"When you create a <bpt id=\"p1\">**</bpt>DataRelation<ept id=\"p1\">**</ept>, the parent-child relationships of the columns are managed only through the relation.","pos":[436,556],"source":" When you create a **DataRelation**, the parent-child relationships of the columns are managed only through the relation."},{"content":"The tables and columns are separate entities.","pos":[557,602]},{"content":"In the hierarchical representation of data that XML provides, the parent-child relationships are represented by parent elements that contain nested child elements.","pos":[603,766]},{"content":"To facilitate the nesting of child objects when a <bpt id=\"p1\">**</bpt>DataSet<ept id=\"p1\">**</ept> is synchronized with an <ph id=\"ph1\">&lt;xref:System.Xml.XmlDataDocument&gt;</ph> or written as XML data using <bpt id=\"p2\">**</bpt>WriteXml<ept id=\"p2\">**</ept>, the <bpt id=\"p3\">**</bpt>DataRelation<ept id=\"p3\">**</ept> exposes a <bpt id=\"p4\">**</bpt>Nested<ept id=\"p4\">**</ept> property.","pos":[773,987],"source":"To facilitate the nesting of child objects when a **DataSet** is synchronized with an <xref:System.Xml.XmlDataDocument> or written as XML data using **WriteXml**, the **DataRelation** exposes a **Nested** property."},{"content":"Setting the <bpt id=\"p1\">**</bpt>Nested<ept id=\"p1\">**</ept> property of a <bpt id=\"p2\">**</bpt>DataRelation<ept id=\"p2\">**</ept> to <bpt id=\"p3\">**</bpt>true<ept id=\"p3\">**</ept> causes the child rows of the relation to be nested within the parent column when written as XML data or synchronized with an <bpt id=\"p4\">**</bpt>XmlDataDocument<ept id=\"p4\">**</ept>.","pos":[988,1199],"source":" Setting the **Nested** property of a **DataRelation** to **true** causes the child rows of the relation to be nested within the parent column when written as XML data or synchronized with an **XmlDataDocument**."},{"content":"The <bpt id=\"p1\">**</bpt>Nested<ept id=\"p1\">**</ept> property of the <bpt id=\"p2\">**</bpt>DataRelation<ept id=\"p2\">**</ept> is <bpt id=\"p3\">**</bpt>false<ept id=\"p3\">**</ept>, by default.","pos":[1200,1273],"source":" The **Nested** property of the **DataRelation** is **false**, by default."},{"pos":[1280,1328],"content":"For example, consider the following <bpt id=\"p1\">**</bpt>DataSet<ept id=\"p1\">**</ept>.","source":"For example, consider the following **DataSet**."},{"content":"Because the <bpt id=\"p1\">**</bpt>Nested<ept id=\"p1\">**</ept> property of the <bpt id=\"p2\">**</bpt>DataRelation<ept id=\"p2\">**</ept> object is not set to <bpt id=\"p3\">**</bpt>true<ept id=\"p3\">**</ept> for this <bpt id=\"p4\">**</bpt>DataSet<ept id=\"p4\">**</ept>, the child objects are not nested within the parent elements when this <bpt id=\"p5\">**</bpt>DataSet<ept id=\"p5\">**</ept> is represented as XML data.","pos":[2724,2941],"source":"Because the **Nested** property of the **DataRelation** object is not set to **true** for this **DataSet**, the child objects are not nested within the parent elements when this **DataSet** is represented as XML data."},{"content":"Transforming the XML representation of a <bpt id=\"p1\">**</bpt>DataSet<ept id=\"p1\">**</ept> that contains related <bpt id=\"p2\">**</bpt>DataSet<ept id=\"p2\">**</ept>s with non-nested data relations can cause slow performance.","pos":[2942,3088],"source":" Transforming the XML representation of a **DataSet** that contains related **DataSet**s with non-nested data relations can cause slow performance."},{"content":"We recommend that you nest the data relations.","pos":[3089,3135]},{"content":"To do this, set the <bpt id=\"p1\">**</bpt>Nested<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>true<ept id=\"p2\">**</ept>.","pos":[3136,3188],"source":" To do this, set the **Nested** property to **true**."},{"content":"Then write code in the XSLT style sheet that uses top-down hierarchical XPath query expressions to locate and transform the data.","pos":[3189,3318]},{"pos":[3325,3414],"content":"The following code example shows the result from calling <bpt id=\"p1\">**</bpt>WriteXml<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>DataSet<ept id=\"p2\">**</ept>.","source":"The following code example shows the result from calling **WriteXml** on the **DataSet**."},{"content":"Note that the <bpt id=\"p1\">**</bpt>Customers<ept id=\"p1\">**</ept> element and the <bpt id=\"p2\">**</bpt>Orders<ept id=\"p2\">**</ept> elements are shown as sibling elements.","pos":[4171,4265],"source":"Note that the **Customers** element and the **Orders** elements are shown as sibling elements."},{"content":"If you wanted the <bpt id=\"p1\">**</bpt>Orders<ept id=\"p1\">**</ept> elements to show up as children of their respective parent elements, the <bpt id=\"p2\">**</bpt>Nested<ept id=\"p2\">**</ept> property of the <bpt id=\"p3\">**</bpt>DataRelation<ept id=\"p3\">**</ept> would need to be set to <bpt id=\"p4\">**</bpt>true<ept id=\"p4\">**</ept> and you would add the following:","pos":[4266,4477],"source":" If you wanted the **Orders** elements to show up as children of their respective parent elements, the **Nested** property of the **DataRelation** would need to be set to **true** and you would add the following:"},{"pos":[4585,4729],"content":"The following code shows what the resulting output would look like, with the <bpt id=\"p1\">**</bpt>Orders<ept id=\"p1\">**</ept> elements nested within their respective parent elements.","source":"The following code shows what the resulting output would look like, with the **Orders** elements nested within their respective parent elements."},{"pos":[5518,5526],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5530,5650],"content":"<bpt id=\"p1\">[</bpt>Using XML in a DataSet<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/using-xml-in-a-dataset.md)</ept>","source":"[Using XML in a DataSet](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/using-xml-in-a-dataset.md)"},{"pos":[5653,5769],"content":"<bpt id=\"p1\">[</bpt>Adding DataRelations<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/adding-datarelations.md)</ept>","source":"[Adding DataRelations](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/adding-datarelations.md)"},{"pos":[5772,5888],"content":"<bpt id=\"p1\">[</bpt>DataSets, DataTables, and DataViews<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)</ept>","source":"[DataSets, DataTables, and DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)"},{"pos":[5891,5995],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}