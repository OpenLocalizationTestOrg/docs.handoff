{"content":"---\ntitle: \"Support for the msxsl:node-set() Function\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nms.assetid: d0cbf517-d9f6-4097-9851-4fa62903decd\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Support for the msxsl:node-set() Function\nThe `msxsl:node-set` function enables you to convert a result tree fragment into a node set. The resulting node set always contains a single node and is the root node of the tree.  \n  \n> [!NOTE]\n>  The <xref:System.Xml.Xsl.XslTransform> class is obsolete in the [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)]. You can perform Extensible Stylesheet Language for Transformations (XSLT) transformations using the <xref:System.Xml.Xsl.XslCompiledTransform> class. See [Using the XslCompiledTransform Class](../../../../docs/standard/data/xml/using-the-xslcompiledtransform-class.md) and [Migrating From the XslTransform Class](../../../../docs/standard/data/xml/migrating-from-the-xsltransform-class.md) for more information.  \n  \n The `msxsl:node-set` function enables you to convert a result tree fragment into a node set. The resulting node set always contains a single node and is the root node of the tree.  \n  \n## Example  \n In the following example, `$var` is a variable that is a node tree in the style sheet. The for-each statement combined with the `node-set` function allows the user to iterate over this node tree as a node set.  \n  \n## nodeset.xsl  \n  \n```xml  \n<xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"  \n                xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"  \n                xmlns:user=\"http://www.contoso.com\"  \n                version=\"1.0\">  \n    <xsl:variable name=\"books\">  \n        <book author=\"Michael Howard\">Writing Secure Code</book>  \n        <book author=\"Michael Kay\">XSLT Reference</book>  \n    </xsl:variable>  \n  \n    <xsl:template match=\"/\">  \n        <authors>  \n            <xsl:for-each select=\"msxsl:node-set($books)/book\">   \n                <author><xsl:value-of select=\"@author\"/)</author>  \n            </xsl:for-each>  \n        </authors>  \n    </xsl:template>  \n</xsl:stylesheet>  \n```  \n  \n## Output  \n The output of the transformation is  \n  \n```xml  \n<?xml version=\"1.0\" encoding=\"utf-8\"?>  \n<authors><author>Michael Howard</author><author>Michael Kay</author></authors>  \n```  \n  \n## See also\n\n- [XslTransform Class Implements the XSLT Processor](../../../../docs/standard/data/xml/xsltransform-class-implements-the-xslt-processor.md)\n","nodes":[{"pos":[4,193],"embed":true,"restype":"x-metadata","content":"title: \"Support for the msxsl:node-set() Function\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nms.assetid: d0cbf517-d9f6-4097-9851-4fa62903decd\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Support for the msxsl:node-set() Function","nodes":[{"pos":[0,41],"content":"Support for the msxsl:node-set() Function","nodes":[{"content":"Support for the msxsl:node-set() Function","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[200,241],"content":"Support for the msxsl:node-set() Function","linkify":"Support for the msxsl:node-set() Function","nodes":[{"content":"Support for the msxsl:node-set() Function","pos":[0,41]}]},{"content":"The <ph id=\"ph1\">`msxsl:node-set`</ph> function enables you to convert a result tree fragment into a node set.","pos":[242,334],"source":"The `msxsl:node-set` function enables you to convert a result tree fragment into a node set."},{"content":"The resulting node set always contains a single node and is the root node of the tree.","pos":[335,421]},{"pos":[429,976],"content":"[!NOTE]\n The <xref:System.Xml.Xsl.XslTransform> class is obsolete in the [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)]. You can perform Extensible Stylesheet Language for Transformations (XSLT) transformations using the <xref:System.Xml.Xsl.XslCompiledTransform> class. See [Using the XslCompiledTransform Class](../../../../docs/standard/data/xml/using-the-xslcompiledtransform-class.md) and [Migrating From the XslTransform Class](../../../../docs/standard/data/xml/migrating-from-the-xsltransform-class.md) for more information.","leadings":["","> "],"nodes":[{"content":"The <xref:System.Xml.Xsl.XslTransform> class is obsolete in the [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)]. You can perform Extensible Stylesheet Language for Transformations (XSLT) transformations using the <xref:System.Xml.Xsl.XslCompiledTransform> class. See [Using the XslCompiledTransform Class](../../../../docs/standard/data/xml/using-the-xslcompiledtransform-class.md) and [Migrating From the XslTransform Class](../../../../docs/standard/data/xml/migrating-from-the-xsltransform-class.md) for more information.","pos":[9,545],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslTransform&gt;</ph> class is obsolete in the <ph id=\"ph2\">[!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)]</ph>.","pos":[0,124],"source":"The <xref:System.Xml.Xsl.XslTransform> class is obsolete in the [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)]."},{"content":"You can perform Extensible Stylesheet Language for Transformations (XSLT) transformations using the <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class.","pos":[125,274],"source":" You can perform Extensible Stylesheet Language for Transformations (XSLT) transformations using the <xref:System.Xml.Xsl.XslCompiledTransform> class."},{"content":"See <bpt id=\"p1\">[</bpt>Using the XslCompiledTransform Class<ept id=\"p1\">](../../../../docs/standard/data/xml/using-the-xslcompiledtransform-class.md)</ept> and <bpt id=\"p2\">[</bpt>Migrating From the XslTransform Class<ept id=\"p2\">](../../../../docs/standard/data/xml/migrating-from-the-xsltransform-class.md)</ept> for more information.","pos":[275,536],"source":" See [Using the XslCompiledTransform Class](../../../../docs/standard/data/xml/using-the-xslcompiledtransform-class.md) and [Migrating From the XslTransform Class](../../../../docs/standard/data/xml/migrating-from-the-xsltransform-class.md) for more information."}]}]},{"content":"The <ph id=\"ph1\">`msxsl:node-set`</ph> function enables you to convert a result tree fragment into a node set.","pos":[983,1075],"source":"The `msxsl:node-set` function enables you to convert a result tree fragment into a node set."},{"content":"The resulting node set always contains a single node and is the root node of the tree.","pos":[1076,1162]},{"pos":[1171,1178],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In the following example, <ph id=\"ph1\">`$var`</ph> is a variable that is a node tree in the style sheet.","pos":[1182,1268],"source":"In the following example, `$var` is a variable that is a node tree in the style sheet."},{"content":"The for-each statement combined with the <ph id=\"ph1\">`node-set`</ph> function allows the user to iterate over this node tree as a node set.","pos":[1269,1391],"source":" The for-each statement combined with the `node-set` function allows the user to iterate over this node tree as a node set."},{"pos":[1400,1411],"content":"nodeset.xsl","linkify":"nodeset.xsl","nodes":[{"content":"nodeset.xsl","pos":[0,11]}]},{"pos":[2119,2125],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"The output of the transformation is","pos":[2129,2164]},{"pos":[2313,2321],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2325,2463],"content":"<bpt id=\"p1\">[</bpt>XslTransform Class Implements the XSLT Processor<ept id=\"p1\">](../../../../docs/standard/data/xml/xsltransform-class-implements-the-xslt-processor.md)</ept>","source":"[XslTransform Class Implements the XSLT Processor](../../../../docs/standard/data/xml/xsltransform-class-implements-the-xslt-processor.md)"}]}