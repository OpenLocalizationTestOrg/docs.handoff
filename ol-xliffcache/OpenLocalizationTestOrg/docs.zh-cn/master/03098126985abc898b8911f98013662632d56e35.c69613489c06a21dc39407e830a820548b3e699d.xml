{"content":"---\ntitle: \"How to: Configure .NET Framework-Based COM Components for Registration-Free Activation\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"components [.NET Framework], manifest\"\n  - \"application manifests [.NET Framework]\"\n  - \"manifests [.NET Framework]\"\n  - \"registration-free COM interop, configuring .NET-based components\"\n  - \"activation, registration-free\"\nms.assetid: 32f8b7c6-3f73-455d-8e13-9846895bd43b\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# How to: Configure .NET Framework-Based COM Components for Registration-Free Activation\nRegistration-free activation for .NET Framework-based components is only slightly more complicated than it is for COM components. The setup requires two manifests:  \n  \n-   COM applications must have a Win32-style application manifest to identify the managed component.  \n  \n-   .NET Framework-based components must have a component manifest for activation information needed at run time.  \n  \n This topic describes how to associate an application manifest with an application; associate a component manifest with a component; and embed a component manifest in an assembly.  \n  \n### To create an application manifest  \n  \n1.  Using an XML editor, create (or modify) the application manifest owned by the COM application that is interoperating with one or more managed components.  \n  \n2.  Insert the following standard header at the beginning of the file:  \n  \n    ```xml  \n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>  \n    <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">  \n    ```  \n  \n     For information about manifest elements and their attributes, see [Application Manifests](/windows/desktop/SbsCs/application-manifests).  \n  \n3.  Identify the owner of the manifest. In the following example, `myComApp` version 1 owns the manifest file.  \n  \n    ```xml  \n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>  \n    <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">  \n      <assemblyIdentity type=\"win32\"   \n                        name=\"myOrganization.myDivision.myComApp\"   \n                        version=\"1.0.0.0\"   \n                        processorArchitecture=\"msil\"   \n      />  \n    ```  \n  \n4.  Identify dependent assemblies. In the following example, `myComApp` depends on `myManagedComp`.  \n  \n    ```xml  \n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>  \n    <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">  \n      <assemblyIdentity type=\"win32\"   \n                        name=\"myOrganization.myDivision.myComApp\"   \n                        version=\"1.0.0.0\"   \n                        processorArchitecture=\"x86\"   \n                        publicKeyToken=\"8275b28176rcbbef\"  \n      />  \n      <dependency>  \n        <dependentAssembly>  \n          <assemblyIdentity type=\"win32\"   \n                        name=\"myOrganization.myDivision.myManagedComp\"   \n                        version=\"6.0.0.0\"   \n                        processorArchitecture=\"X86\"   \n                        publicKeyToken=\"8275b28176rcbbef\"  \n          />  \n        </dependentAssembly>  \n      </dependency>  \n    </assembly>  \n    ```  \n  \n5.  Save and name the manifest file. The name of an application manifest is the name of the assembly executable followed by the .manifest extension. For example, the application manifest file name for myComApp.exe is myComApp.exe.manifest.  \n  \n You can install an application manifest in the same directory as the COM application. Alternatively, you can add it as a resource to the application's .exe file. For additional information, For more information, see [About Side-by-Side Assemblies](/windows/desktop/SbsCs/about-side-by-side-assemblies-).  \n  \n#### To create a component manifest  \n  \n1.  Using an XML editor, create a component manifest to describe the managed assembly.  \n  \n2.  Insert the following standard header at the beginning of the file:  \n  \n    ```xml  \n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>  \n    <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">  \n    ```  \n  \n3.  Identify the owner of the file. The `<assemblyIdentity>` element of the `<dependentAssembly>` element in application manifest file must match the one in the component manifest. In the following example, `myManagedComp` version 1.2.3.4 owns the manifest file.  \n  \n    ```xml  \n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>  \n    <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">  \n           <assemblyIdentity  \n                        name=\"myOrganization.myDivision.myManagedComp\"  \n                        version=\"1.2.3.4\"  \n                        publicKeyToken=\"8275b28176rcbbef\"  \n                        processorArchitecture=\"msil\"  \n           />  \n    ```  \n  \n4.  Identify each class in the assembly. Use the `<clrClass>` element to uniquely identify each class in the managed assembly. The element, which is a subelement of the `<assembly>` element, has the attributes described in the following table.  \n  \n    |Attribute|Description|Required|  \n    |---------------|-----------------|--------------|  \n    |`clsid`|The identifier that specifies the class to be activated.|Yes|  \n    |`description`|A string that informs the user about the component. An empty string is the default.|No|  \n    |`name`|A string that represents the managed class.|Yes|  \n    |`progid`|The identifier to be used for late-bound activation.|No|  \n    |`threadingModel`|The COM threading model. \"Both\" is the default value.|No|  \n    |`runtimeVersion`|Specifies the common language runtime (CLR) version to use. If you do not specify this attribute, and the CLR is not already loaded, the component is loaded with the latest installed CLR prior to CLR version 4. If you specify v1.0.3705, v1.1.4322, or v2.0.50727, the version automatically rolls forward to the latest installed CLR version prior to CLR version 4 (usually v2.0.50727). If another version of the CLR is already loaded and the specified version can be loaded side-by-side in-process, the specified version is loaded; otherwise, the loaded CLR is used. This might cause a load failure.|No|  \n    |`tlbid`|The identifier of the type library that contains type information about the class.|No|  \n  \n     All attribute tags are case-sensitive. You can obtain CLSIDs, ProgIDs, threading models, and the runtime version by viewing the exported type library for the assembly with the OLE/COM ObjectViewer (Oleview.exe).  \n  \n     The following component manifest identifies two classes, `testClass1` and `testClass2`.  \n  \n    ```xml  \n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>  \n    <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">  \n           <assemblyIdentity  \n                        name=\"myOrganization.myDivision.myManagedComp\"  \n                        version=\"1.2.3.4\"   \n                        publicKeyToken=\"8275b28176rcbbef\"  \n           />  \n           <clrClass  \n                        clsid=\"{65722BE6-3449-4628-ABD3-74B6864F9739}\"  \n                        progid=\"myManagedComp.testClass1\"  \n                        threadingModel=\"Both\"  \n                        name=\"myManagedComp.testClass1\"  \n                        runtimeVersion=\"v1.0.3705\">  \n           </clrClass>  \n           <clrClass  \n                        clsid=\"{367221D6-3559-3328-ABD3-45B6825F9732}\"  \n                        progid=\"myManagedComp.testClass2\"  \n                        threadingModel=\"Both\"  \n                        name=\"myManagedComp.testClass2\"  \n                        runtimeVersion=\"v1.0.3705\">  \n           </clrClass>  \n           <file name=\"MyManagedComp.dll\">  \n           </file>  \n    </assembly>  \n    ```  \n  \n5.  Save and name the manifest file. The name of a component manifest is the name of the assembly library followed by the .manifest extension. For example, the myManagedComp.dll is myManagedComp.manifest.  \n  \n You must embed the component manifest as a resource in the assembly.  \n  \n#### To embed a component manifest in a managed assembly  \n  \n1.  Create a resource script that contains the following statement:  \n  \n     `RT_MANIFEST 1 myManagedComp.manifest`  \n  \n     In this statement, `myManagedComp.manifest` is the name of the component manifest being embedded. For this example, the script file name is `myresource.rc`.  \n  \n2.  Compile the script using the Microsoft Windows Resource Compiler (Rc.exe). At the command prompt, type the following command:  \n  \n     `rc myresource.rc`  \n  \n     Rc.exe produces the `myresource.res` resource file.  \n  \n3.  Compile the assembly's source file again and specify the resource file by using the **/win32res** option:  \n  \n    ```  \n    /win32res:myresource.res  \n    ```  \n  \n     Again, `myresource.res` is the name of the resource file containing embedded resource.  \n  \n## See also\n\n- [Registration-Free COM Interop](registration-free-com-interop.md)\n- [Requirements for Registration-Free COM Interop](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/f8h7012w(v=vs.100))\n- [Configuring COM Components for Registration-Free Activation](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/x65a421a(v=vs.100))\n- [Registration-Free Activation of .NET-Based Components: A Walkthrough](https://docs.microsoft.com/previous-versions/dotnet/articles/ms973915(v=msdn.10))\n","nodes":[{"pos":[4,461],"embed":true,"restype":"x-metadata","content":"title: \"How to: Configure .NET Framework-Based COM Components for Registration-Free Activation\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"components [.NET Framework], manifest\"\n  - \"application manifests [.NET Framework]\"\n  - \"manifests [.NET Framework]\"\n  - \"registration-free COM interop, configuring .NET-based components\"\n  - \"activation, registration-free\"\nms.assetid: 32f8b7c6-3f73-455d-8e13-9846895bd43b\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"How to: Configure .NET Framework-Based COM Components for Registration-Free Activation","nodes":[{"pos":[0,86],"content":"How to: Configure .NET Framework-Based COM Components for Registration-Free Activation","nodes":[{"content":"How to: Configure .NET Framework-Based COM Components for Registration-Free Activation","pos":[0,86]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[468,554],"content":"How to: Configure .NET Framework-Based COM Components for Registration-Free Activation","linkify":"How to: Configure .NET Framework-Based COM Components for Registration-Free Activation","nodes":[{"content":"How to: Configure .NET Framework-Based COM Components for Registration-Free Activation","pos":[0,86]}]},{"content":"Registration-free activation for .NET Framework-based components is only slightly more complicated than it is for COM components.","pos":[555,684]},{"content":"The setup requires two manifests:","pos":[685,718]},{"content":"COM applications must have a Win32-style application manifest to identify the managed component.","pos":[728,824]},{"content":".NET Framework-based components must have a component manifest for activation information needed at run time.","pos":[834,943]},{"content":"This topic describes how to associate an application manifest with an application; associate a component manifest with a component; and embed a component manifest in an assembly.","pos":[950,1128]},{"pos":[1138,1171],"content":"To create an application manifest","linkify":"To create an application manifest","nodes":[{"content":"To create an application manifest","pos":[0,33]}]},{"content":"Using an XML editor, create (or modify) the application manifest owned by the COM application that is interoperating with one or more managed components.","pos":[1181,1334]},{"content":"Insert the following standard header at the beginning of the file:","pos":[1344,1410]},{"pos":[1589,1725],"content":"For information about manifest elements and their attributes, see <bpt id=\"p1\">[</bpt>Application Manifests<ept id=\"p1\">](/windows/desktop/SbsCs/application-manifests)</ept>.","source":"For information about manifest elements and their attributes, see [Application Manifests](/windows/desktop/SbsCs/application-manifests)."},{"content":"Identify the owner of the manifest.","pos":[1735,1770]},{"content":"In the following example, <ph id=\"ph1\">`myComApp`</ph> version 1 owns the manifest file.","pos":[1771,1841],"source":" In the following example, `myComApp` version 1 owns the manifest file."},{"content":"Identify dependent assemblies.","pos":[2240,2270]},{"content":"In the following example, <ph id=\"ph1\">`myComApp`</ph> depends on <ph id=\"ph2\">`myManagedComp`</ph>.","pos":[2271,2335],"source":" In the following example, `myComApp` depends on `myManagedComp`."},{"content":"Save and name the manifest file.","pos":[3208,3240]},{"content":"The name of an application manifest is the name of the assembly executable followed by the .manifest extension.","pos":[3241,3352]},{"content":"For example, the application manifest file name for myComApp.exe is myComApp.exe.manifest.","pos":[3353,3443]},{"content":"You can install an application manifest in the same directory as the COM application.","pos":[3450,3535]},{"content":"Alternatively, you can add it as a resource to the application's .exe file.","pos":[3536,3611]},{"content":"For additional information, For more information, see <bpt id=\"p1\">[</bpt>About Side-by-Side Assemblies<ept id=\"p1\">](/windows/desktop/SbsCs/about-side-by-side-assemblies-)</ept>.","pos":[3612,3753],"source":" For additional information, For more information, see [About Side-by-Side Assemblies](/windows/desktop/SbsCs/about-side-by-side-assemblies-)."},{"pos":[3764,3794],"content":"To create a component manifest","linkify":"To create a component manifest","nodes":[{"content":"To create a component manifest","pos":[0,30]}]},{"content":"Using an XML editor, create a component manifest to describe the managed assembly.","pos":[3804,3886]},{"content":"Insert the following standard header at the beginning of the file:","pos":[3896,3962]},{"content":"Identify the owner of the file.","pos":[4140,4171]},{"content":"The <ph id=\"ph1\">`&lt;assemblyIdentity&gt;`</ph> element of the <ph id=\"ph2\">`&lt;dependentAssembly&gt;`</ph> element in application manifest file must match the one in the component manifest.","pos":[4172,4316],"source":" The `<assemblyIdentity>` element of the `<dependentAssembly>` element in application manifest file must match the one in the component manifest."},{"content":"In the following example, <ph id=\"ph1\">`myManagedComp`</ph> version 1.2.3.4 owns the manifest file.","pos":[4317,4398],"source":" In the following example, `myManagedComp` version 1.2.3.4 owns the manifest file."},{"content":"Identify each class in the assembly.","pos":[4855,4891]},{"content":"Use the <ph id=\"ph1\">`&lt;clrClass&gt;`</ph> element to uniquely identify each class in the managed assembly.","pos":[4892,4977],"source":" Use the `<clrClass>` element to uniquely identify each class in the managed assembly."},{"content":"The element, which is a subelement of the <ph id=\"ph1\">`&lt;assembly&gt;`</ph> element, has the attributes described in the following table.","pos":[4978,5094],"source":" The element, which is a subelement of the `<assembly>` element, has the attributes described in the following table."},{"content":"Attribute","pos":[5105,5114]},{"content":"Description","pos":[5115,5126]},{"content":"Required","pos":[5127,5135]},{"content":"The identifier that specifies the class to be activated.","pos":[5209,5265]},{"content":"Yes","pos":[5266,5269]},{"content":"A string that informs the user about the component.","pos":[5292,5343]},{"content":"An empty string is the default.","pos":[5344,5375]},{"content":"No","pos":[5376,5378]},{"content":"A string that represents the managed class.","pos":[5394,5437]},{"content":"Yes","pos":[5438,5441]},{"content":"The identifier to be used for late-bound activation.","pos":[5459,5511]},{"content":"No","pos":[5512,5514]},{"content":"The COM threading model.","pos":[5540,5564]},{"content":"\"Both\" is the default value.","pos":[5565,5593]},{"content":"No","pos":[5594,5596]},{"content":"Specifies the common language runtime (CLR) version to use.","pos":[5622,5681]},{"content":"If you do not specify this attribute, and the CLR is not already loaded, the component is loaded with the latest installed CLR prior to CLR version 4.","pos":[5682,5832]},{"content":"If you specify v1.0.3705, v1.1.4322, or v2.0.50727, the version automatically rolls forward to the latest installed CLR version prior to CLR version 4 (usually v2.0.50727).","pos":[5833,6005]},{"content":"If another version of the CLR is already loaded and the specified version can be loaded side-by-side in-process, the specified version is loaded; otherwise, the loaded CLR is used.","pos":[6006,6186]},{"content":"This might cause a load failure.","pos":[6187,6219]},{"content":"No","pos":[6220,6222]},{"content":"The identifier of the type library that contains type information about the class.","pos":[6239,6321]},{"content":"No","pos":[6322,6324]},{"content":"All attribute tags are case-sensitive.","pos":[6336,6374]},{"content":"You can obtain CLSIDs, ProgIDs, threading models, and the runtime version by viewing the exported type library for the assembly with the OLE/COM ObjectViewer (Oleview.exe).","pos":[6375,6547]},{"pos":[6558,6645],"content":"The following component manifest identifies two classes, <ph id=\"ph1\">`testClass1`</ph> and <ph id=\"ph2\">`testClass2`</ph>.","source":"The following component manifest identifies two classes, `testClass1` and `testClass2`."},{"content":"Save and name the manifest file.","pos":[7814,7846]},{"content":"The name of a component manifest is the name of the assembly library followed by the .manifest extension.","pos":[7847,7952]},{"content":"For example, the myManagedComp.dll is myManagedComp.manifest.","pos":[7953,8014]},{"content":"You must embed the component manifest as a resource in the assembly.","pos":[8021,8089]},{"pos":[8100,8151],"content":"To embed a component manifest in a managed assembly","linkify":"To embed a component manifest in a managed assembly","nodes":[{"content":"To embed a component manifest in a managed assembly","pos":[0,51]}]},{"content":"Create a resource script that contains the following statement:","pos":[8161,8224]},{"content":"In this statement, <ph id=\"ph1\">`myManagedComp.manifest`</ph> is the name of the component manifest being embedded.","pos":[8284,8381],"source":"In this statement, `myManagedComp.manifest` is the name of the component manifest being embedded."},{"content":"For this example, the script file name is <ph id=\"ph1\">`myresource.rc`</ph>.","pos":[8382,8440],"source":" For this example, the script file name is `myresource.rc`."},{"content":"Compile the script using the Microsoft Windows Resource Compiler (Rc.exe).","pos":[8450,8524]},{"content":"At the command prompt, type the following command:","pos":[8525,8575]},{"pos":[8615,8666],"content":"Rc.exe produces the <ph id=\"ph1\">`myresource.res`</ph> resource file.","source":"Rc.exe produces the `myresource.res` resource file."},{"pos":[8676,8781],"content":"Compile the assembly's source file again and specify the resource file by using the <bpt id=\"p1\">**</bpt>/win32res<ept id=\"p1\">**</ept> option:","source":"Compile the assembly's source file again and specify the resource file by using the **/win32res** option:"},{"pos":[8846,8932],"content":"Again, <ph id=\"ph1\">`myresource.res`</ph> is the name of the resource file containing embedded resource.","source":"Again, `myresource.res` is the name of the resource file containing embedded resource."},{"pos":[8941,8949],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8953,9018],"content":"<bpt id=\"p1\">[</bpt>Registration-Free COM Interop<ept id=\"p1\">](registration-free-com-interop.md)</ept>","source":"[Registration-Free COM Interop](registration-free-com-interop.md)"},{"pos":[9021,9158],"content":"<bpt id=\"p1\">[</bpt>Requirements for Registration-Free COM Interop<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/f8h7012w(v=vs.100))</ept>","source":"[Requirements for Registration-Free COM Interop](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/f8h7012w(v=vs.100))"},{"pos":[9161,9311],"content":"<bpt id=\"p1\">[</bpt>Configuring COM Components for Registration-Free Activation<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/x65a421a(v=vs.100))</ept>","source":"[Configuring COM Components for Registration-Free Activation](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/x65a421a(v=vs.100))"},{"pos":[9314,9466],"content":"<bpt id=\"p1\">[</bpt>Registration-Free Activation of .NET-Based Components: A Walkthrough<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/articles/ms973915(v=msdn.10))</ept>","source":"[Registration-Free Activation of .NET-Based Components: A Walkthrough](https://docs.microsoft.com/previous-versions/dotnet/articles/ms973915(v=msdn.10))"}]}