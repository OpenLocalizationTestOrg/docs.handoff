{"content":"---\ntitle: \"How to: Save time zones to an embedded resource\"\nms.date: \"04/10/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"time zones [.NET Framework], saving\"\n  - \"time zone objects [.NET Framework], serializing\"\n  - \"time zone objects [.NET Framework], saving\"\nms.assetid: 3c96d83a-a057-4496-abb0-8f4b12712558\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# How to: Save time zones to an embedded resource\n\nA time zone-aware application often requires the presence of a particular time zone. However, because the availability of individual <xref:System.TimeZoneInfo> objects depends on information stored in the local system's registry, even customarily available time zones may be absent. In addition, information about custom time zones instantiated by using the <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> method is not stored with other time zone information in the registry. To ensure that these time zones are available when they are needed, you can save them by serializing them, and later restore them by deserializing them.\n\nTypically, serializing a <xref:System.TimeZoneInfo> object occurs apart from the time zone-aware application. Depending on the data store used to hold serialized <xref:System.TimeZoneInfo> objects, time zone data may be serialized as part of a setup or installation routine (for example, when the data is stored in an application key of the registry), or as part of a utility routine that runs before the final application is compiled (for example, when the serialized data is stored in a .NET XML resource (.resx) file).\n\nIn addition to a resource file that is compiled with the application, several other data stores can be used for time zone information. These include the following:\n\n* The registry. Note that an application should use the subkeys of its own application key to store custom time zone data rather than using the subkeys of HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Time Zones.\n\n* Configuration files.\n\n* Other system files.\n\n### To save a time zone by serializing it to a .resx file\n\n1. Retrieve an existing time zone or create a new time zone.\n\n   To retrieve an existing time zone, see [How to: Access the predefined UTC and local time zone objects](../../../docs/standard/datetime/access-utc-and-local.md) and [How to: Instantiate a TimeZoneInfo object](../../../docs/standard/datetime/instantiate-time-zone-info.md).\n\n   To create a new time zone, call one of the overloads of the <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> method. For more information, see [How to: Create time zones without adjustment rules](../../../docs/standard/datetime/create-time-zones-without-adjustment-rules.md) and [How to: Create time zones with adjustment rules](../../../docs/standard/datetime/create-time-zones-with-adjustment-rules.md).\n\n2. Call the <xref:System.TimeZoneInfo.ToSerializedString%2A> method to create a string that contains the time zone's data.\n\n3. Instantiate a <xref:System.IO.StreamWriter> object by providing the name and optionally the path of the .resx file to the <xref:System.IO.StreamWriter> class constructor.\n\n4. Instantiate a <xref:System.Resources.ResXResourceWriter> object by passing the <xref:System.IO.StreamWriter> object to the <xref:System.Resources.ResXResourceWriter> class constructor.\n\n5. Pass the time zone's serialized string to the <xref:System.Resources.ResXResourceWriter.AddResource%2A?displayProperty=nameWithType> method.\n\n6. Call the <xref:System.Resources.ResXResourceWriter.Generate%2A?displayProperty=nameWithType> method.\n\n7. Call the <xref:System.Resources.ResXResourceWriter.Close%2A?displayProperty=nameWithType> method.\n\n8. Close the <xref:System.IO.StreamWriter> object by calling its <xref:System.IO.StreamWriter.Close%2A> method.\n\n9. Add the generated .resx file to the application's Visual Studio project.\n\n10. Using the **Properties** window in Visual Studio, make sure that the .resx file's **Build Action** property is set to **Embedded Resource**.\n\n## Example\n\nThe following example serializes a <xref:System.TimeZoneInfo> object that represents Central Standard Time and a <xref:System.TimeZoneInfo> object that represents the Palmer Station, Antarctica time to a .NET XML resource file that is named SerializedTimeZones.resx. Central Standard Time is typically defined in the registry; Palmer Station, Antarctica is a custom time zone.\n\n[!code-csharp[TimeZone2.Serialization#1](../../../samples/snippets/csharp/VS_Snippets_CLR/TimeZone2.Serialization/cs/SerializeTimeZoneData.cs#1)]\n[!code-vb[TimeZone2.Serialization#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/TimeZone2.Serialization/vb/SerializeTimeZoneData.vb#1)]\n\nThis example serializes <xref:System.TimeZoneInfo> objects so that they are available in a resource file at compile time.\n\nBecause the <xref:System.Resources.ResXResourceWriter.Generate%2A?displayProperty=nameWithType> method adds complete header information to a .NET XML resource file, it cannot be used to add resources to an existing file. The example handles this by checking for the SerializedTimeZones.resx file and, if it exists, storing all of its resources other than the two serialized time zones to a generic <xref:System.Collections.Generic.Dictionary%602> object. The existing file is then deleted and the existing resources are added to a new SerializedTimeZones.resx file. The serialized time zone data is also added to this file.\n\nThe key (or **Name**) fields of resources should not contain embedded spaces. The <xref:System.String.Replace%28System.String%2CSystem.String%29> method is called to remove all embedded spaces in the time zone identifiers before they are assigned to the resource file.\n\n## Compiling the code\n\nThis example requires:\n\n* That a reference to System.Windows.Forms.dll and System.Core.dll be added to the project.\n\n* That the following namespaces be imported:\n\n  [!code-csharp[TimeZone2.Serialization#2](../../../samples/snippets/csharp/VS_Snippets_CLR/TimeZone2.Serialization/cs/SerializeTimeZoneData.cs#2)]\n  [!code-vb[TimeZone2.Serialization#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/TimeZone2.Serialization/vb/SerializeTimeZoneData.vb#2)]\n\n## See also\n\n- [Dates, times, and time zones](../../../docs/standard/datetime/index.md)\n- [Time zone overview](../../../docs/standard/datetime/time-zone-overview.md)\n- [How to: Restore time zones from an embedded resource](../../../docs/standard/datetime/restore-time-zones-from-an-embedded-resource.md)\n","nodes":[{"pos":[4,403],"embed":true,"restype":"x-metadata","content":"title: \"How to: Save time zones to an embedded resource\"\nms.date: \"04/10/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"time zones [.NET Framework], saving\"\n  - \"time zone objects [.NET Framework], serializing\"\n  - \"time zone objects [.NET Framework], saving\"\nms.assetid: 3c96d83a-a057-4496-abb0-8f4b12712558\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"How to: Save time zones to an embedded resource","nodes":[{"pos":[0,47],"content":"How to: Save time zones to an embedded resource","nodes":[{"content":"How to: Save time zones to an embedded resource","pos":[0,47]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[410,457],"content":"How to: Save time zones to an embedded resource","linkify":"How to: Save time zones to an embedded resource","nodes":[{"content":"How to: Save time zones to an embedded resource","pos":[0,47]}]},{"content":"A time zone-aware application often requires the presence of a particular time zone.","pos":[459,543]},{"content":"However, because the availability of individual <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> objects depends on information stored in the local system's registry, even customarily available time zones may be absent.","pos":[544,741],"source":" However, because the availability of individual <xref:System.TimeZoneInfo> objects depends on information stored in the local system's registry, even customarily available time zones may be absent."},{"content":"In addition, information about custom time zones instantiated by using the <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo.CreateCustomTimeZone%2A&gt;</ph> method is not stored with other time zone information in the registry.","pos":[742,938],"source":" In addition, information about custom time zones instantiated by using the <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> method is not stored with other time zone information in the registry."},{"content":"To ensure that these time zones are available when they are needed, you can save them by serializing them, and later restore them by deserializing them.","pos":[939,1091]},{"content":"Typically, serializing a <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> object occurs apart from the time zone-aware application.","pos":[1093,1202],"source":"Typically, serializing a <xref:System.TimeZoneInfo> object occurs apart from the time zone-aware application."},{"content":"Depending on the data store used to hold serialized <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> objects, time zone data may be serialized as part of a setup or installation routine (for example, when the data is stored in an application key of the registry), or as part of a utility routine that runs before the final application is compiled (for example, when the serialized data is stored in a .NET XML resource (.resx) file).","pos":[1203,1614],"source":" Depending on the data store used to hold serialized <xref:System.TimeZoneInfo> objects, time zone data may be serialized as part of a setup or installation routine (for example, when the data is stored in an application key of the registry), or as part of a utility routine that runs before the final application is compiled (for example, when the serialized data is stored in a .NET XML resource (.resx) file)."},{"content":"In addition to a resource file that is compiled with the application, several other data stores can be used for time zone information.","pos":[1616,1750]},{"content":"These include the following:","pos":[1751,1779]},{"content":"The registry.","pos":[1783,1796]},{"content":"Note that an application should use the subkeys of its own application key to store custom time zone data rather than using the subkeys of HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Time Zones.","pos":[1797,2011]},{"content":"Configuration files.","pos":[2015,2035]},{"content":"Other system files.","pos":[2039,2058]},{"pos":[2064,2117],"content":"To save a time zone by serializing it to a .resx file","linkify":"To save a time zone by serializing it to a .resx file","nodes":[{"content":"To save a time zone by serializing it to a .resx file","pos":[0,53]}]},{"content":"Retrieve an existing time zone or create a new time zone.","pos":[2122,2179]},{"pos":[2184,2455],"content":"To retrieve an existing time zone, see <bpt id=\"p1\">[</bpt>How to: Access the predefined UTC and local time zone objects<ept id=\"p1\">](../../../docs/standard/datetime/access-utc-and-local.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Instantiate a TimeZoneInfo object<ept id=\"p2\">](../../../docs/standard/datetime/instantiate-time-zone-info.md)</ept>.","source":"To retrieve an existing time zone, see [How to: Access the predefined UTC and local time zone objects](../../../docs/standard/datetime/access-utc-and-local.md) and [How to: Instantiate a TimeZoneInfo object](../../../docs/standard/datetime/instantiate-time-zone-info.md)."},{"content":"To create a new time zone, call one of the overloads of the <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo.CreateCustomTimeZone%2A&gt;</ph> method.","pos":[2460,2578],"source":"To create a new time zone, call one of the overloads of the <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> method."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Create time zones without adjustment rules<ept id=\"p1\">](../../../docs/standard/datetime/create-time-zones-without-adjustment-rules.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Create time zones with adjustment rules<ept id=\"p2\">](../../../docs/standard/datetime/create-time-zones-with-adjustment-rules.md)</ept>.","pos":[2579,2867],"source":" For more information, see [How to: Create time zones without adjustment rules](../../../docs/standard/datetime/create-time-zones-without-adjustment-rules.md) and [How to: Create time zones with adjustment rules](../../../docs/standard/datetime/create-time-zones-with-adjustment-rules.md)."},{"pos":[2872,2991],"content":"Call the <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo.ToSerializedString%2A&gt;</ph> method to create a string that contains the time zone's data.","source":"Call the <xref:System.TimeZoneInfo.ToSerializedString%2A> method to create a string that contains the time zone's data."},{"pos":[2996,3166],"content":"Instantiate a <ph id=\"ph1\">&lt;xref:System.IO.StreamWriter&gt;</ph> object by providing the name and optionally the path of the .resx file to the <ph id=\"ph2\">&lt;xref:System.IO.StreamWriter&gt;</ph> class constructor.","source":"Instantiate a <xref:System.IO.StreamWriter> object by providing the name and optionally the path of the .resx file to the <xref:System.IO.StreamWriter> class constructor."},{"pos":[3171,3355],"content":"Instantiate a <ph id=\"ph1\">&lt;xref:System.Resources.ResXResourceWriter&gt;</ph> object by passing the <ph id=\"ph2\">&lt;xref:System.IO.StreamWriter&gt;</ph> object to the <ph id=\"ph3\">&lt;xref:System.Resources.ResXResourceWriter&gt;</ph> class constructor.","source":"Instantiate a <xref:System.Resources.ResXResourceWriter> object by passing the <xref:System.IO.StreamWriter> object to the <xref:System.Resources.ResXResourceWriter> class constructor."},{"pos":[3360,3500],"content":"Pass the time zone's serialized string to the <ph id=\"ph1\">&lt;xref:System.Resources.ResXResourceWriter.AddResource%2A?displayProperty=nameWithType&gt;</ph> method.","source":"Pass the time zone's serialized string to the <xref:System.Resources.ResXResourceWriter.AddResource%2A?displayProperty=nameWithType> method."},{"pos":[3505,3605],"content":"Call the <ph id=\"ph1\">&lt;xref:System.Resources.ResXResourceWriter.Generate%2A?displayProperty=nameWithType&gt;</ph> method.","source":"Call the <xref:System.Resources.ResXResourceWriter.Generate%2A?displayProperty=nameWithType> method."},{"pos":[3610,3707],"content":"Call the <ph id=\"ph1\">&lt;xref:System.Resources.ResXResourceWriter.Close%2A?displayProperty=nameWithType&gt;</ph> method.","source":"Call the <xref:System.Resources.ResXResourceWriter.Close%2A?displayProperty=nameWithType> method."},{"pos":[3712,3820],"content":"Close the <ph id=\"ph1\">&lt;xref:System.IO.StreamWriter&gt;</ph> object by calling its <ph id=\"ph2\">&lt;xref:System.IO.StreamWriter.Close%2A&gt;</ph> method.","source":"Close the <xref:System.IO.StreamWriter> object by calling its <xref:System.IO.StreamWriter.Close%2A> method."},{"content":"Add the generated .resx file to the application's Visual Studio project.","pos":[3825,3897]},{"pos":[3903,4043],"content":"Using the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window in Visual Studio, make sure that the .resx file's <bpt id=\"p2\">**</bpt>Build Action<ept id=\"p2\">**</ept> property is set to <bpt id=\"p3\">**</bpt>Embedded Resource<ept id=\"p3\">**</ept>.","source":"Using the **Properties** window in Visual Studio, make sure that the .resx file's **Build Action** property is set to **Embedded Resource**."},{"pos":[4048,4055],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example serializes a <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> object that represents Central Standard Time and a <ph id=\"ph2\">&lt;xref:System.TimeZoneInfo&gt;</ph> object that represents the Palmer Station, Antarctica time to a .NET XML resource file that is named SerializedTimeZones.resx.","pos":[4057,4323],"source":"The following example serializes a <xref:System.TimeZoneInfo> object that represents Central Standard Time and a <xref:System.TimeZoneInfo> object that represents the Palmer Station, Antarctica time to a .NET XML resource file that is named SerializedTimeZones.resx."},{"content":"Central Standard Time is typically defined in the registry; Palmer Station, Antarctica is a custom time zone.","pos":[4324,4433]},{"pos":[4729,4850],"content":"This example serializes <ph id=\"ph1\">&lt;xref:System.TimeZoneInfo&gt;</ph> objects so that they are available in a resource file at compile time.","source":"This example serializes <xref:System.TimeZoneInfo> objects so that they are available in a resource file at compile time."},{"content":"Because the <ph id=\"ph1\">&lt;xref:System.Resources.ResXResourceWriter.Generate%2A?displayProperty=nameWithType&gt;</ph> method adds complete header information to a .NET XML resource file, it cannot be used to add resources to an existing file.","pos":[4852,5072],"source":"Because the <xref:System.Resources.ResXResourceWriter.Generate%2A?displayProperty=nameWithType> method adds complete header information to a .NET XML resource file, it cannot be used to add resources to an existing file."},{"content":"The example handles this by checking for the SerializedTimeZones.resx file and, if it exists, storing all of its resources other than the two serialized time zones to a generic <ph id=\"ph1\">&lt;xref:System.Collections.Generic.Dictionary%602&gt;</ph> object.","pos":[5073,5306],"source":" The example handles this by checking for the SerializedTimeZones.resx file and, if it exists, storing all of its resources other than the two serialized time zones to a generic <xref:System.Collections.Generic.Dictionary%602> object."},{"content":"The existing file is then deleted and the existing resources are added to a new SerializedTimeZones.resx file.","pos":[5307,5417]},{"content":"The serialized time zone data is also added to this file.","pos":[5418,5475]},{"content":"The key (or <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>) fields of resources should not contain embedded spaces.","pos":[5477,5554],"source":"The key (or **Name**) fields of resources should not contain embedded spaces."},{"content":"The <ph id=\"ph1\">&lt;xref:System.String.Replace%28System.String%2CSystem.String%29&gt;</ph> method is called to remove all embedded spaces in the time zone identifiers before they are assigned to the resource file.","pos":[5555,5745],"source":" The <xref:System.String.Replace%28System.String%2CSystem.String%29> method is called to remove all embedded spaces in the time zone identifiers before they are assigned to the resource file."},{"pos":[5750,5768],"content":"Compiling the code","linkify":"Compiling the code","nodes":[{"content":"Compiling the code","pos":[0,18]}]},{"content":"This example requires:","pos":[5770,5792]},{"content":"That a reference to System.Windows.Forms.dll and System.Core.dll be added to the project.","pos":[5796,5885]},{"content":"That the following namespaces be imported:","pos":[5889,5931]},{"pos":[5935,6229],"content":"[!code-csharp[TimeZone2.Serialization#2](../../../samples/snippets/csharp/VS_Snippets_CLR/TimeZone2.Serialization/cs/SerializeTimeZoneData.cs#2)]\n[!code-vb[TimeZone2.Serialization#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/TimeZone2.Serialization/vb/SerializeTimeZoneData.vb#2)]","leadings":["","  "],"nodes":[]},{"pos":[6234,6242],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6246,6318],"content":"<bpt id=\"p1\">[</bpt>Dates, times, and time zones<ept id=\"p1\">](../../../docs/standard/datetime/index.md)</ept>","source":"[Dates, times, and time zones](../../../docs/standard/datetime/index.md)"},{"pos":[6321,6396],"content":"<bpt id=\"p1\">[</bpt>Time zone overview<ept id=\"p1\">](../../../docs/standard/datetime/time-zone-overview.md)</ept>","source":"[Time zone overview](../../../docs/standard/datetime/time-zone-overview.md)"},{"pos":[6399,6534],"content":"<bpt id=\"p1\">[</bpt>How to: Restore time zones from an embedded resource<ept id=\"p1\">](../../../docs/standard/datetime/restore-time-zones-from-an-embedded-resource.md)</ept>","source":"[How to: Restore time zones from an embedded resource](../../../docs/standard/datetime/restore-time-zones-from-an-embedded-resource.md)"}]}