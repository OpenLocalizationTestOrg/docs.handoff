{"content":"---\ntitle: \"How to: Retrieve the Shallow Value of an Element (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 730a6670-fb8c-41fc-8a1b-eb97a837e432\n---\n\n# How to: Retrieve the Shallow Value of an Element (Visual Basic)\n\nThis topic shows how to get the shallow value of an element. The shallow value is the value of the specific element only, as opposed to the deep value, which includes the values of all descendent elements concatenated into a single string.\n\nWhen you retrieve an element value by using either casting or the <xref:System.Xml.Linq.XElement.Value%2A?displayProperty=nameWithType> property, you retrieve the deep value. To retrieve the shallow value, you can use the `ShallowValue` extension method, as shown in the following example. Retrieving the shallow value is useful when you want to select elements based on their content.\n\nThe following example declares an extension method that retrieves the shallow value of an element. It then uses the extension method in a query to list all elements that contain a calculated value.\n\n## Example\n\nThe following text file, Report.xml, is the source for this example.\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n<Report>\n  <Section>\n    <Heading>\n      <Column Name=\"CustomerId\">=Customer.CustomerId.Heading</Column>\n      <Column Name=\"Name\">=Customer.Name.Heading</Column>\n    </Heading>\n    <Detail>\n      <Column Name=\"CustomerId\">=Customer.CustomerId</Column>\n      <Column Name=\"Name\">=Customer.Name</Column>\n    </Detail>\n  </Section>\n</Report>\n```\n\n```vb\nModule Module1\n    <System.Runtime.CompilerServices.Extension()> _\n    Public Function ShallowValue(ByVal xe As XElement)\n        Return xe _\n               .Nodes() _\n               .OfType(Of XText)() _\n               .Aggregate(New StringBuilder(), _\n                              Function(s, c) s.Append(c), _\n                              Function(s) s.ToString())\n    End Function\n\n    Sub Main()\n        Dim root As XElement = XElement.Load(\"Report.xml\")\n\n        Dim query As IEnumerable(Of XElement) = _\n            From el In root.Descendants() _\n            Where (el.ShallowValue().StartsWith(\"=\")) _\n            Select el\n\n        For Each q As XElement In query\n            Console.WriteLine(\"{0}{1}{2}\", _\n                q.Name.ToString().PadRight(8), _\n                q.Attribute(\"Name\").ToString().PadRight(20), _\n                q.ShallowValue())\n        Next\n    End Sub\nEnd Module\n```\n\nThis example produces the following output:\n\n```\nColumn  Name=\"CustomerId\"   =Customer.CustomerId.Heading\nColumn  Name=\"Name\"         =Customer.Name.Heading\nColumn  Name=\"CustomerId\"   =Customer.CustomerId\nColumn  Name=\"Name\"         =Customer.Name\n```\n\n## See also\n\n- [LINQ to XML Axes (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-axes.md)\n","nodes":[{"pos":[4,145],"embed":true,"restype":"x-metadata","content":"title: \"How to: Retrieve the Shallow Value of an Element (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 730a6670-fb8c-41fc-8a1b-eb97a837e432","nodes":[{"content":"How to: Retrieve the Shallow Value of an Element (Visual Basic)","nodes":[{"pos":[0,63],"content":"How to: Retrieve the Shallow Value of an Element (Visual Basic)","nodes":[{"content":"How to: Retrieve the Shallow Value of an Element (Visual Basic)","pos":[0,63]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[153,216],"content":"How to: Retrieve the Shallow Value of an Element (Visual Basic)","linkify":"How to: Retrieve the Shallow Value of an Element (Visual Basic)","nodes":[{"content":"How to: Retrieve the Shallow Value of an Element (Visual Basic)","pos":[0,63]}]},{"content":"This topic shows how to get the shallow value of an element.","pos":[218,278]},{"content":"The shallow value is the value of the specific element only, as opposed to the deep value, which includes the values of all descendent elements concatenated into a single string.","pos":[279,457]},{"content":"When you retrieve an element value by using either casting or the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement.Value%2A?displayProperty=nameWithType&gt;</ph> property, you retrieve the deep value.","pos":[459,633],"source":"When you retrieve an element value by using either casting or the <xref:System.Xml.Linq.XElement.Value%2A?displayProperty=nameWithType> property, you retrieve the deep value."},{"content":"To retrieve the shallow value, you can use the <ph id=\"ph1\">`ShallowValue`</ph> extension method, as shown in the following example.","pos":[634,748],"source":" To retrieve the shallow value, you can use the `ShallowValue` extension method, as shown in the following example."},{"content":"Retrieving the shallow value is useful when you want to select elements based on their content.","pos":[749,844]},{"content":"The following example declares an extension method that retrieves the shallow value of an element.","pos":[846,944]},{"content":"It then uses the extension method in a query to list all elements that contain a calculated value.","pos":[945,1043]},{"pos":[1048,1055],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following text file, Report.xml, is the source for this example.","pos":[1057,1125]},{"content":"This example produces the following output:","pos":[2433,2476]},{"pos":[2690,2698],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2702,2813],"content":"<bpt id=\"p1\">[</bpt>LINQ to XML Axes (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-axes.md)</ept>","source":"[LINQ to XML Axes (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-axes.md)"}]}