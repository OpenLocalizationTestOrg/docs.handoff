{"content":"---\ntitle: \"Insert XML Data using XPathNavigator\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nms.assetid: 2ed8c28b-b88d-4be7-9c87-92df01f0821f\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Insert XML Data using XPathNavigator\nThe <xref:System.Xml.XPath.XPathNavigator> class provides a set of methods used to insert sibling, child, and attribute nodes in an XML document. In order to use these methods, the <xref:System.Xml.XPath.XPathNavigator> object must be editable, that is, its <xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> property must be `true`.  \n  \n <xref:System.Xml.XPath.XPathNavigator> objects that can edit an XML document are created by the <xref:System.Xml.XmlDocument.CreateNavigator%2A> method of the <xref:System.Xml.XmlDocument> class. <xref:System.Xml.XPath.XPathNavigator> objects created by the <xref:System.Xml.XPath.XPathDocument> class are read-only and any attempt to use the editing methods of an <xref:System.Xml.XPath.XPathNavigator> object created by an <xref:System.Xml.XPath.XPathDocument> object results in a <xref:System.NotSupportedException>.  \n  \n For more information about creating editable <xref:System.Xml.XPath.XPathNavigator> objects, see [Reading XML Data using XPathDocument and XmlDocument](../../../../docs/standard/data/xml/reading-xml-data-using-xpathdocument-and-xmldocument.md).  \n  \n## Inserting Nodes  \n The <xref:System.Xml.XPath.XPathNavigator> class provides methods to insert sibling, child, and attribute nodes in an XML document. These methods allow you to insert nodes and attributes in different locations in relation to the current position of an <xref:System.Xml.XPath.XPathNavigator> object and are described in the following sections.  \n  \n### Inserting Sibling Nodes  \n The <xref:System.Xml.XPath.XPathNavigator> class provides the following methods to insert sibling nodes.  \n  \n-   <xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A>  \n  \n-   <xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A>  \n  \n-   <xref:System.Xml.XPath.XPathNavigator.InsertElementAfter%2A>  \n  \n-   <xref:System.Xml.XPath.XPathNavigator.InsertElementBefore%2A>  \n  \n These methods insert sibling nodes before and after the node an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on.  \n  \n The <xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A> and <xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A> methods are overloaded and accept a `string`, <xref:System.Xml.XmlReader> object, or <xref:System.Xml.XPath.XPathNavigator> object containing the sibling node to add as parameters. Both methods also return an <xref:System.Xml.XmlWriter> object used to insert sibling nodes.  \n  \n The <xref:System.Xml.XPath.XPathNavigator.InsertElementAfter%2A> and <xref:System.Xml.XPath.XPathNavigator.InsertElementBefore%2A> methods insert a single sibling node before and after the node an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on using the namespace prefix, local name, namespace URI, and value specified as parameters.  \n  \n In the following example a new `pages` element is inserted before the `price` child element of the first `book` element in the `contosoBooks.xml` file.  \n  \n [!code-cpp[XPathNavigatorMethods#19](../../../../samples/snippets/cpp/VS_Snippets_Data/XPathNavigatorMethods/CPP/xpathnavigatormethods.cpp#19)]\n [!code-csharp[XPathNavigatorMethods#19](../../../../samples/snippets/csharp/VS_Snippets_Data/XPathNavigatorMethods/CS/xpathnavigatormethods.cs#19)]\n [!code-vb[XPathNavigatorMethods#19](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XPathNavigatorMethods/VB/xpathnavigatormethods.vb#19)]  \n  \n The example takes the `contosoBooks.xml` file as an input.  \n  \n [!code-xml[XPathXMLExamples#2](../../../../samples/snippets/xml/VS_Snippets_Data/XPathXMLExamples/XML/contosoBooks.xml#2)]  \n  \n For more information about the <xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A>, <xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A>, <xref:System.Xml.XPath.XPathNavigator.InsertElementAfter%2A> and <xref:System.Xml.XPath.XPathNavigator.InsertElementBefore%2A> methods, see the <xref:System.Xml.XPath.XPathNavigator> class reference documentation.  \n  \n### Inserting Child Nodes  \n The <xref:System.Xml.XPath.XPathNavigator> class provides the following methods to insert child nodes.  \n  \n-   <xref:System.Xml.XPath.XPathNavigator.AppendChild%2A>  \n  \n-   <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A>  \n  \n-   <xref:System.Xml.XPath.XPathNavigator.AppendChildElement%2A>  \n  \n-   <xref:System.Xml.XPath.XPathNavigator.PrependChildElement%2A>  \n  \n These methods append and prepend child nodes to the end of and the beginning of the list of child nodes of the node an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on.  \n  \n Like the methods in the \"Inserting Sibling Nodes\" section, the <xref:System.Xml.XPath.XPathNavigator.AppendChild%2A> and <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A> methods accept a `string`, <xref:System.Xml.XmlReader> object, or <xref:System.Xml.XPath.XPathNavigator> object containing the child node to add as parameters. Both methods also return an <xref:System.Xml.XmlWriter> object used to insert child nodes.  \n  \n Also like the methods in the \"Inserting Sibling Nodes\" section, the <xref:System.Xml.XPath.XPathNavigator.AppendChildElement%2A> and <xref:System.Xml.XPath.XPathNavigator.PrependChildElement%2A> methods insert a single child node to the end of and the beginning of the list of child nodes of the node an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on using the namespace prefix, local name, namespace URI, and value specified as parameters.  \n  \n In the following example, a new `pages` child element is appended to the list of child elements of the first `book` element in the `contosoBooks.xml` file.  \n  \n [!code-cpp[XPathNavigatorMethods#2](../../../../samples/snippets/cpp/VS_Snippets_Data/XPathNavigatorMethods/CPP/xpathnavigatormethods.cpp#2)]\n [!code-csharp[XPathNavigatorMethods#2](../../../../samples/snippets/csharp/VS_Snippets_Data/XPathNavigatorMethods/CS/xpathnavigatormethods.cs#2)]\n [!code-vb[XPathNavigatorMethods#2](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XPathNavigatorMethods/VB/xpathnavigatormethods.vb#2)]  \n  \n The example takes the `contosoBooks.xml` file as an input.  \n  \n [!code-xml[XPathXMLExamples#2](../../../../samples/snippets/xml/VS_Snippets_Data/XPathXMLExamples/XML/contosoBooks.xml#2)]  \n  \n For more information about the <xref:System.Xml.XPath.XPathNavigator.AppendChild%2A>, <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A>, <xref:System.Xml.XPath.XPathNavigator.AppendChildElement%2A> and <xref:System.Xml.XPath.XPathNavigator.PrependChildElement%2A> methods, see the <xref:System.Xml.XPath.XPathNavigator> class reference documentation.  \n  \n### Inserting Attribute Nodes  \n The <xref:System.Xml.XPath.XPathNavigator> class provides the following methods to insert attribute nodes.  \n  \n-   <xref:System.Xml.XPath.XPathNavigator.CreateAttribute%2A>  \n  \n-   <xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A>  \n  \n These methods insert attribute nodes on the element node an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on. The <xref:System.Xml.XPath.XPathNavigator.CreateAttribute%2A> method creates an attribute node on the element node an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on using the namespace prefix, local name, namespace URI, and value specified as parameters. The <xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A> method returns an <xref:System.Xml.XmlWriter> object used to insert attribute nodes.  \n  \n In the following example, new `discount` and `currency` attributes are created on the `price` child element of the first `book` element in the `contosoBooks.xml` file using the <xref:System.Xml.XmlWriter> object returned from the <xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A> method.  \n  \n [!code-cpp[XPathNavigatorMethods#8](../../../../samples/snippets/cpp/VS_Snippets_Data/XPathNavigatorMethods/CPP/xpathnavigatormethods.cpp#8)]\n [!code-csharp[XPathNavigatorMethods#8](../../../../samples/snippets/csharp/VS_Snippets_Data/XPathNavigatorMethods/CS/xpathnavigatormethods.cs#8)]\n [!code-vb[XPathNavigatorMethods#8](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XPathNavigatorMethods/VB/xpathnavigatormethods.vb#8)]  \n  \n The example takes the `contosoBooks.xml` file as an input.  \n  \n [!code-xml[XPathXMLExamples#2](../../../../samples/snippets/xml/VS_Snippets_Data/XPathXMLExamples/XML/contosoBooks.xml#2)]  \n  \n For more information about the <xref:System.Xml.XPath.XPathNavigator.CreateAttribute%2A> and <xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A> methods, see the <xref:System.Xml.XPath.XPathNavigator> class reference documentation.  \n  \n## Copying Nodes  \n In certain cases you may want to populate an XML document with the contents from another XML document. Both the <xref:System.Xml.XPath.XPathNavigator> class and the <xref:System.Xml.XmlWriter> class can copy nodes to an <xref:System.Xml.XmlDocument> object from an existing <xref:System.Xml.XmlReader> object or <xref:System.Xml.XPath.XPathNavigator> object.  \n  \n The <xref:System.Xml.XPath.XPathNavigator.AppendChild%2A>, <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A>, <xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A> and <xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A> methods of the <xref:System.Xml.XPath.XPathNavigator> class all have overloads that can accept an <xref:System.Xml.XPath.XPathNavigator> object or an <xref:System.Xml.XmlReader> object as a parameter.  \n  \n The <xref:System.Xml.XmlWriter.WriteNode%2A> method of the <xref:System.Xml.XmlWriter> class has overloads that can accept an <xref:System.Xml.XmlNode>, <xref:System.Xml.XmlReader>, or <xref:System.Xml.XPath.XPathNavigator> object.  \n  \n The following example copies all the `book` elements from one document to another.  \n  \n```vb  \nDim document As XmlDocument = New XmlDocument()  \ndocument.Load(\"books.xml\")  \nDim navigator As XPathNavigator = document.CreateNavigator()  \n  \nnavigator.MoveToChild(\"bookstore\", String.Empty)  \n  \nDim newBooks As XPathDocument = New XPathDocument(\"newBooks.xml\")  \nDim newBooksNavigator As XPathNavigator = newBooks.CreateNavigator()  \n  \nDim nav As XPathNavigator  \nFor Each nav in newBooksNavigator.SelectDescendants(\"book\", \"\", false)  \n    navigator.AppendChild(nav)  \nNext  \n  \ndocument.Save(\"newBooks.xml\");  \n```  \n  \n```csharp  \nXmlDocument document = new XmlDocument();  \ndocument.Load(\"books.xml\");  \nXPathNavigator navigator = document.CreateNavigator();  \n  \nnavigator.MoveToChild(\"bookstore\", String.Empty);  \n  \nXPathDocument newBooks = new XPathDocument(\"newBooks.xml\");  \nXPathNavigator newBooksNavigator = newBooks.CreateNavigator();  \n  \nforeach (XPathNavigator nav in newBooksNavigator.SelectDescendants(\"book\", \"\", false))  \n{  \n    navigator.AppendChild(nav);  \n}  \n  \ndocument.Save(\"newBooks.xml\");  \n```  \n  \n## Inserting Values  \n The <xref:System.Xml.XPath.XPathNavigator> class provides the <xref:System.Xml.XPath.XPathNavigator.SetValue%2A> and <xref:System.Xml.XPath.XPathNavigator.SetTypedValue%2A> methods to insert values for a node into an <xref:System.Xml.XmlDocument> object.  \n  \n### Inserting Untyped Values  \n The <xref:System.Xml.XPath.XPathNavigator.SetValue%2A> method simply inserts the untyped `string` value passed as a parameter as the value of the node the <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on. The value is inserted without any type or without verifying that the new value is valid according to the type of the node if schema information is available.  \n  \n In the following example, the <xref:System.Xml.XPath.XPathNavigator.SetValue%2A> method is used to update all `price` elements in the `contosoBooks.xml` file.  \n  \n [!code-cpp[XPathNavigatorMethods#47](../../../../samples/snippets/cpp/VS_Snippets_Data/XPathNavigatorMethods/CPP/xpathnavigatormethods.cpp#47)]\n [!code-csharp[XPathNavigatorMethods#47](../../../../samples/snippets/csharp/VS_Snippets_Data/XPathNavigatorMethods/CS/xpathnavigatormethods.cs#47)]\n [!code-vb[XPathNavigatorMethods#47](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XPathNavigatorMethods/VB/xpathnavigatormethods.vb#47)]  \n  \n The example takes the `contosoBooks.xml` file as an input.  \n  \n [!code-xml[XPathXMLExamples#2](../../../../samples/snippets/xml/VS_Snippets_Data/XPathXMLExamples/XML/contosoBooks.xml#2)]  \n  \n### Inserting Typed Values  \n When the type of a node is a W3C XML Schema simple type, the new value inserted by the <xref:System.Xml.XPath.XPathNavigator.SetTypedValue%2A> method is checked against the facets of the simple type before the value is set. If the new value is not valid according to the type of the node (for example, setting a value of `-1` on an element whose type is `xs:positiveInteger`), it results in an exception.  \n  \n The following example attempts to change the value of the `price` element of the first `book` element in the `contosoBooks.xml` file to a <xref:System.DateTime> value. Because the XML Schema type of the `price` element is defined as `xs:decimal` in the `contosoBooks.xsd` files, this results in an exception.  \n  \n```vb  \nDim settings As XmlReaderSettings = New XmlReaderSettings()  \nsettings.Schemas.Add(\"http://www.contoso.com/books\", \"contosoBooks.xsd\")  \nsettings.ValidationType = ValidationType.Schema  \n  \nDim reader As XmlReader = XmlReader.Create(\"contosoBooks.xml\", settings)  \n  \nDim document As XmlDocument = New XmlDocument()  \ndocument.Load(reader)  \nDim navigator As XPathNavigator = document.CreateNavigator()  \n  \nnavigator.MoveToChild(\"bookstore\", \"http://www.contoso.com/books\")  \nnavigator.MoveToChild(\"book\", \"http://www.contoso.com/books\")  \nnavigator.MoveToChild(\"price\", \"http://www.contoso.com/books\")  \n  \nnavigator.SetTypedValue(DateTime.Now)  \n```  \n  \n```csharp  \nXmlReaderSettings settings = new XmlReaderSettings();  \nsettings.Schemas.Add(\"http://www.contoso.com/books\", \"contosoBooks.xsd\");  \nsettings.ValidationType = ValidationType.Schema;  \n  \nXmlReader reader = XmlReader.Create(\"contosoBooks.xml\", settings);  \n  \nXmlDocument document = new XmlDocument();  \ndocument.Load(reader);  \nXPathNavigator navigator = document.CreateNavigator();  \n  \nnavigator.MoveToChild(\"bookstore\", \"http://www.contoso.com/books\");  \nnavigator.MoveToChild(\"book\", \"http://www.contoso.com/books\");  \nnavigator.MoveToChild(\"price\", \"http://www.contoso.com/books\");  \n  \nnavigator.SetTypedValue(DateTime.Now);  \n```  \n  \n The example takes the `contosoBooks.xml` file as an input.  \n  \n [!code-xml[XPathXMLExamples#2](../../../../samples/snippets/xml/VS_Snippets_Data/XPathXMLExamples/XML/contosoBooks.xml#2)]  \n  \n The example also takes the `contosoBooks.xsd` as an input.  \n  \n [!code-xml[XPathXMLExamples#3](../../../../samples/snippets/xml/VS_Snippets_Data/XPathXMLExamples/XML/contosoBooks.xsd#3)]  \n  \n## The InnerXml and OuterXml Properties  \n The <xref:System.Xml.XPath.XPathNavigator.InnerXml%2A> and <xref:System.Xml.XPath.XPathNavigator.OuterXml%2A> properties of the <xref:System.Xml.XPath.XPathNavigator> class change the XML markup of the nodes an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on.  \n  \n The <xref:System.Xml.XPath.XPathNavigator.InnerXml%2A> property changes the XML markup of the child nodes an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on with the parsed contents of the given XML `string`. Similarly, the <xref:System.Xml.XPath.XPathNavigator.OuterXml%2A> property changes the XML markup of the child nodes an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on as well as the current node itself.  \n  \n In addition to the methods described in this topic, the <xref:System.Xml.XPath.XPathNavigator.InnerXml%2A> and <xref:System.Xml.XPath.XPathNavigator.OuterXml%2A> properties can be used to insert nodes and values in an XML document. For more information about using the <xref:System.Xml.XPath.XPathNavigator.InnerXml%2A> and <xref:System.Xml.XPath.XPathNavigator.OuterXml%2A> properties to insert nodes and values, see the [Modify XML Data using XPathNavigator](../../../../docs/standard/data/xml/modify-xml-data-using-xpathnavigator.md) topic.  \n  \n## Namespace and xml:lang Conflicts  \n Certain conflicts related to the scope of namespace and `xml:lang` declarations can occur when inserting XML data using the <xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A>, <xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A>, <xref:System.Xml.XPath.XPathNavigator.AppendChild%2A> and <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A> methods of the <xref:System.Xml.XPath.XPathNavigator> class that take <xref:System.Xml.XmlReader> objects as parameters.  \n  \n The following are the possible namespace conflicts.  \n  \n-   If there is a namespace in-scope within the <xref:System.Xml.XmlReader> object's context, where the prefix to namespace URI mapping is not in the <xref:System.Xml.XPath.XPathNavigator> object's context, a new namespace declaration is added to the newly inserted node.  \n  \n-   If the same namespace URI is in-scope within both the <xref:System.Xml.XmlReader> object's context and the <xref:System.Xml.XPath.XPathNavigator> object's context, but has a different prefix mapped to it in both contexts, a new namespace declaration is added to the newly inserted node, with the prefix and namespace URI taken from the <xref:System.Xml.XmlReader> object.  \n  \n-   If the same namespace prefix is in-scope within both the <xref:System.Xml.XmlReader> object's context and the <xref:System.Xml.XPath.XPathNavigator> object's context, but has a different namespace URI mapped to it in both contexts, a new namespace declaration is added to the newly inserted node which re-declares that prefix with the namespace URI taken from <xref:System.Xml.XmlReader> object.  \n  \n-   If the prefix as well as the namespace URI in both the <xref:System.Xml.XmlReader> object's context and the <xref:System.Xml.XPath.XPathNavigator> object's context is the same, no new namespace declaration is added to the newly inserted node.  \n  \n> [!NOTE]\n>  The description above also applies to namespace declarations with the empty `string` as a prefix (for example, the default namespace declaration).  \n  \n The following are the possible `xml:lang` conflicts.  \n  \n-   If there is an `xml:lang` attribute in-scope within the <xref:System.Xml.XmlReader> object's context but not in the <xref:System.Xml.XPath.XPathNavigator> object's context, an `xml:lang` attribute whose value is taken from the <xref:System.Xml.XmlReader> object is added to the newly inserted node.  \n  \n-   If there is an `xml:lang` attribute in-scope within both the <xref:System.Xml.XmlReader> object's context and the <xref:System.Xml.XPath.XPathNavigator> object's context, but each has a different value, an `xml:lang` attribute whose value is taken from the <xref:System.Xml.XmlReader> object is added to the newly inserted node.  \n  \n-   If there is an `xml:lang` attribute in-scope within both the <xref:System.Xml.XmlReader> object's context and the <xref:System.Xml.XPath.XPathNavigator> object's context, but each with the same value, no new `xml:lang` attribute is added on the newly inserted node.  \n  \n-   If there is an `xml:lang` attribute in-scope within the <xref:System.Xml.XPath.XPathNavigator> object's context, but none existing in the <xref:System.Xml.XmlReader> object's context, no `xml:lang` attribute is added to the newly inserted node.  \n  \n## Inserting Nodes with XmlWriter  \n The methods used to insert sibling, child and attribute nodes described in the \"Inserting Nodes and Values\" section are overloaded. The <xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A>, <xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A>, <xref:System.Xml.XPath.XPathNavigator.AppendChild%2A>, <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A> and <xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A> methods of the <xref:System.Xml.XPath.XPathNavigator> class return an <xref:System.Xml.XmlWriter> object used to insert nodes.  \n  \n### Unsupported XmlWriter Methods  \n Not all of the methods used for writing information to an XML document using the <xref:System.Xml.XmlWriter> class are supported by the <xref:System.Xml.XPath.XPathNavigator> class due to difference between the XPath data model and the Document Object Model (DOM).  \n  \n The following table describes the <xref:System.Xml.XmlWriter> class methods not supported by the <xref:System.Xml.XPath.XPathNavigator> class.  \n  \n|Method|Description|  \n|------------|-----------------|  \n|<xref:System.Xml.XmlWriter.WriteEntityRef%2A>|Throws a <xref:System.NotSupportedException> exception.|  \n|<xref:System.Xml.XmlWriter.WriteDocType%2A>|Ignored at the root level and throws a <xref:System.NotSupportedException> exception if called at any other level in the XML document.|  \n|<xref:System.Xml.XmlWriter.WriteCData%2A>|Treated as a call to the <xref:System.Xml.XmlWriter.WriteString%2A> method for the equivalent character or characters.|  \n|<xref:System.Xml.XmlWriter.WriteCharEntity%2A>|Treated as a call to the <xref:System.Xml.XmlWriter.WriteString%2A> method for the equivalent character or characters.|  \n|<xref:System.Xml.XmlWriter.WriteSurrogateCharEntity%2A>|Treated as a call to the <xref:System.Xml.XmlWriter.WriteString%2A> method for the equivalent character or characters.|  \n  \n For more information about the <xref:System.Xml.XmlWriter> class, see the <xref:System.Xml.XmlWriter> class reference documentation.  \n  \n### Multiple XmlWriter Objects  \n It is possible to have multiple <xref:System.Xml.XPath.XPathNavigator> objects pointing to different parts of an XML document with one or more open <xref:System.Xml.XmlWriter> objects. Multiple <xref:System.Xml.XmlWriter> objects are allowed and supported in single-threaded scenarios.  \n  \n The following are important notes to consider when using multiple <xref:System.Xml.XmlWriter> objects.  \n  \n-   XML fragments written by <xref:System.Xml.XmlWriter> objects are added to the XML document when the <xref:System.Xml.XmlWriter.Close%2A> method of each <xref:System.Xml.XmlWriter> object is called. Until that point, the <xref:System.Xml.XmlWriter> object is writing a disconnected fragment. If an operation is performed on the XML document, any fragments being written by an <xref:System.Xml.XmlWriter> object, before the <xref:System.Xml.XmlWriter.Close%2A> has been called, are not affected.  \n  \n-   If there is an open <xref:System.Xml.XmlWriter> object on a particular XML subtree and that subtree is deleted, the <xref:System.Xml.XmlWriter> object may still add to the sub-tree. The subtree simply becomes a deleted fragment.  \n  \n-   If multiple <xref:System.Xml.XmlWriter> objects are opened at the same point in the XML document, they are added to the XML document in the order in which the <xref:System.Xml.XmlWriter> objects are closed, not in the order in which they were opened.  \n  \n The following example creates an <xref:System.Xml.XmlDocument> object, creates an <xref:System.Xml.XPath.XPathNavigator> object, and then uses the <xref:System.Xml.XmlWriter> object returned by the <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A> method to create the structure of the first book in the `books.xml` file. The example then saves it as the `book.xml` file.  \n  \n```vb  \nDim document As XmlDocument = New XmlDocument()  \nDim navigator As XPathNavigator = document.CreateNavigator()  \n  \nUsing writer As XmlWriter = navigator.PrependChild()  \n  \n    writer.WriteStartElement(\"bookstore\")  \n    writer.WriteStartElement(\"book\")  \n    writer.WriteAttributeString(\"genre\", \"autobiography\")  \n    writer.WriteAttributeString(\"publicationdate\", \"1981-03-22\")  \n    writer.WriteAttributeString(\"ISBN\", \"1-861003-11-0\")  \n    writer.WriteElementString(\"title\", \"The Autobiography of Benjamin Franklin\")  \n    writer.WriteStartElement(\"author\")  \n    writer.WriteElementString(\"first-name\", \"Benjamin\")  \n    writer.WriteElementString(\"last-name\", \"Franklin\")  \n    writer.WriteElementString(\"price\", \"8.99\")  \n    writer.WriteEndElement()  \n    writer.WriteEndElement()  \n    writer.WriteEndElement()  \n  \nEnd Using  \n  \ndocument.Save(\"book.xml\")  \n```  \n  \n```csharp  \nXmlDocument document = new XmlDocument();  \nXPathNavigator navigator = document.CreateNavigator();  \n  \nusing (XmlWriter writer = navigator.PrependChild())  \n{  \n    writer.WriteStartElement(\"bookstore\");  \n    writer.WriteStartElement(\"book\");  \n    writer.WriteAttributeString(\"genre\", \"autobiography\");  \n    writer.WriteAttributeString(\"publicationdate\", \"1981-03-22\");  \n    writer.WriteAttributeString(\"ISBN\", \"1-861003-11-0\");  \n    writer.WriteElementString(\"title\", \"The Autobiography of Benjamin Franklin\");  \n    writer.WriteStartElement(\"author\");  \n    writer.WriteElementString(\"first-name\", \"Benjamin\");  \n    writer.WriteElementString(\"last-name\", \"Franklin\");  \n    writer.WriteElementString(\"price\", \"8.99\");  \n    writer.WriteEndElement();  \n    writer.WriteEndElement();  \n    writer.WriteEndElement();  \n}  \ndocument.Save(\"book.xml\");  \n```  \n  \n## Saving an XML Document  \n Saving changes made to an <xref:System.Xml.XmlDocument> object as the result of the methods described in this topic is performed using the methods of the <xref:System.Xml.XmlDocument> class. For more information about saving changes made to an <xref:System.Xml.XmlDocument> object, see [Saving and Writing a Document](../../../../docs/standard/data/xml/saving-and-writing-a-document.md).  \n  \n## See also\n\n- <xref:System.Xml.XmlDocument>\n- <xref:System.Xml.XPath.XPathDocument>\n- <xref:System.Xml.XPath.XPathNavigator>\n- [Process XML Data Using the XPath Data Model](../../../../docs/standard/data/xml/process-xml-data-using-the-xpath-data-model.md)\n- [Modify XML Data using XPathNavigator](../../../../docs/standard/data/xml/modify-xml-data-using-xpathnavigator.md)\n- [Remove XML Data using XPathNavigator](../../../../docs/standard/data/xml/remove-xml-data-using-xpathnavigator.md)\n","nodes":[{"pos":[4,232],"embed":true,"restype":"x-metadata","content":"title: \"Insert XML Data using XPathNavigator\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nms.assetid: 2ed8c28b-b88d-4be7-9c87-92df01f0821f\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Insert XML Data using XPathNavigator","nodes":[{"pos":[0,36],"content":"Insert XML Data using XPathNavigator","nodes":[{"content":"Insert XML Data using XPathNavigator","pos":[0,36]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[239,275],"content":"Insert XML Data using XPathNavigator","linkify":"Insert XML Data using XPathNavigator","nodes":[{"content":"Insert XML Data using XPathNavigator","pos":[0,36]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class provides a set of methods used to insert sibling, child, and attribute nodes in an XML document.","pos":[276,421],"source":"The <xref:System.Xml.XPath.XPathNavigator> class provides a set of methods used to insert sibling, child, and attribute nodes in an XML document."},{"content":"In order to use these methods, the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object must be editable, that is, its <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.CanEdit%2A&gt;</ph> property must be <ph id=\"ph3\">`true`</ph>.","pos":[422,608],"source":" In order to use these methods, the <xref:System.Xml.XPath.XPathNavigator> object must be editable, that is, its <xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> property must be `true`."},{"content":"<ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> objects that can edit an XML document are created by the <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument.CreateNavigator%2A&gt;</ph> method of the <ph id=\"ph3\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class.","pos":[615,810],"source":"<xref:System.Xml.XPath.XPathNavigator> objects that can edit an XML document are created by the <xref:System.Xml.XmlDocument.CreateNavigator%2A> method of the <xref:System.Xml.XmlDocument> class."},{"content":"<ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> objects created by the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class are read-only and any attempt to use the editing methods of an <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object created by an <ph id=\"ph4\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> object results in a <ph id=\"ph5\">&lt;xref:System.NotSupportedException&gt;</ph>.","pos":[811,1134],"source":"<xref:System.Xml.XPath.XPathNavigator> objects created by the <xref:System.Xml.XPath.XPathDocument> class are read-only and any attempt to use the editing methods of an <xref:System.Xml.XPath.XPathNavigator> object created by an <xref:System.Xml.XPath.XPathDocument> object results in a <xref:System.NotSupportedException>."},{"pos":[1141,1385],"content":"For more information about creating editable <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> objects, see <bpt id=\"p1\">[</bpt>Reading XML Data using XPathDocument and XmlDocument<ept id=\"p1\">](../../../../docs/standard/data/xml/reading-xml-data-using-xpathdocument-and-xmldocument.md)</ept>.","source":"For more information about creating editable <xref:System.Xml.XPath.XPathNavigator> objects, see [Reading XML Data using XPathDocument and XmlDocument](../../../../docs/standard/data/xml/reading-xml-data-using-xpathdocument-and-xmldocument.md)."},{"pos":[1394,1409],"content":"Inserting Nodes","linkify":"Inserting Nodes","nodes":[{"content":"Inserting Nodes","pos":[0,15]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class provides methods to insert sibling, child, and attribute nodes in an XML document.","pos":[1413,1544],"source":"The <xref:System.Xml.XPath.XPathNavigator> class provides methods to insert sibling, child, and attribute nodes in an XML document."},{"content":"These methods allow you to insert nodes and attributes in different locations in relation to the current position of an <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object and are described in the following sections.","pos":[1545,1755],"source":" These methods allow you to insert nodes and attributes in different locations in relation to the current position of an <xref:System.Xml.XPath.XPathNavigator> object and are described in the following sections."},{"pos":[1765,1788],"content":"Inserting Sibling Nodes","linkify":"Inserting Sibling Nodes","nodes":[{"content":"Inserting Sibling Nodes","pos":[0,23]}]},{"pos":[1792,1896],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class provides the following methods to insert sibling nodes.","source":"The <xref:System.Xml.XPath.XPathNavigator> class provides the following methods to insert sibling nodes."},{"pos":[2171,2308],"content":"These methods insert sibling nodes before and after the node an <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object is currently positioned on.","source":"These methods insert sibling nodes before and after the node an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A&gt;</ph> methods are overloaded and accept a <ph id=\"ph3\">`string`</ph>, <ph id=\"ph4\">&lt;xref:System.Xml.XmlReader&gt;</ph> object, or <ph id=\"ph5\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object containing the sibling node to add as parameters.","pos":[2315,2612],"source":"The <xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A> and <xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A> methods are overloaded and accept a `string`, <xref:System.Xml.XmlReader> object, or <xref:System.Xml.XPath.XPathNavigator> object containing the sibling node to add as parameters."},{"content":"Both methods also return an <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object used to insert sibling nodes.","pos":[2613,2705],"source":" Both methods also return an <xref:System.Xml.XmlWriter> object used to insert sibling nodes."},{"pos":[2712,3071],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertElementAfter%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertElementBefore%2A&gt;</ph> methods insert a single sibling node before and after the node an <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object is currently positioned on using the namespace prefix, local name, namespace URI, and value specified as parameters.","source":"The <xref:System.Xml.XPath.XPathNavigator.InsertElementAfter%2A> and <xref:System.Xml.XPath.XPathNavigator.InsertElementBefore%2A> methods insert a single sibling node before and after the node an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on using the namespace prefix, local name, namespace URI, and value specified as parameters."},{"pos":[3078,3229],"content":"In the following example a new <ph id=\"ph1\">`pages`</ph> element is inserted before the <ph id=\"ph2\">`price`</ph> child element of the first <ph id=\"ph3\">`book`</ph> element in the <ph id=\"ph4\">`contosoBooks.xml`</ph> file.","source":"In the following example a new `pages` element is inserted before the `price` child element of the first `book` element in the `contosoBooks.xml` file."},{"pos":[3236,3678],"content":"[!code-cpp[XPathNavigatorMethods#19](../../../../samples/snippets/cpp/VS_Snippets_Data/XPathNavigatorMethods/CPP/xpathnavigatormethods.cpp#19)]\n[!code-csharp[XPathNavigatorMethods#19](../../../../samples/snippets/csharp/VS_Snippets_Data/XPathNavigatorMethods/CS/xpathnavigatormethods.cs#19)]\n[!code-vb[XPathNavigatorMethods#19](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XPathNavigatorMethods/VB/xpathnavigatormethods.vb#19)]","leadings":[""," "," "],"nodes":[]},{"pos":[3685,3743],"content":"The example takes the <ph id=\"ph1\">`contosoBooks.xml`</ph> file as an input.","source":"The example takes the `contosoBooks.xml` file as an input."},{"pos":[3879,4234],"content":"For more information about the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertElementAfter%2A&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertElementBefore%2A&gt;</ph> methods, see the <ph id=\"ph5\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class reference documentation.","source":"For more information about the <xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A>, <xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A>, <xref:System.Xml.XPath.XPathNavigator.InsertElementAfter%2A> and <xref:System.Xml.XPath.XPathNavigator.InsertElementBefore%2A> methods, see the <xref:System.Xml.XPath.XPathNavigator> class reference documentation."},{"pos":[4244,4265],"content":"Inserting Child Nodes","linkify":"Inserting Child Nodes","nodes":[{"content":"Inserting Child Nodes","pos":[0,21]}]},{"pos":[4269,4371],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class provides the following methods to insert child nodes.","source":"The <xref:System.Xml.XPath.XPathNavigator> class provides the following methods to insert child nodes."},{"pos":[4646,4838],"content":"These methods append and prepend child nodes to the end of and the beginning of the list of child nodes of the node an <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object is currently positioned on.","source":"These methods append and prepend child nodes to the end of and the beginning of the list of child nodes of the node an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on."},{"content":"Like the methods in the \"Inserting Sibling Nodes\" section, the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.AppendChild%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.PrependChild%2A&gt;</ph> methods accept a <ph id=\"ph3\">`string`</ph>, <ph id=\"ph4\">&lt;xref:System.Xml.XmlReader&gt;</ph> object, or <ph id=\"ph5\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object containing the child node to add as parameters.","pos":[4845,5180],"source":"Like the methods in the \"Inserting Sibling Nodes\" section, the <xref:System.Xml.XPath.XPathNavigator.AppendChild%2A> and <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A> methods accept a `string`, <xref:System.Xml.XmlReader> object, or <xref:System.Xml.XPath.XPathNavigator> object containing the child node to add as parameters."},{"content":"Both methods also return an <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object used to insert child nodes.","pos":[5181,5271],"source":" Both methods also return an <xref:System.Xml.XmlWriter> object used to insert child nodes."},{"pos":[5278,5744],"content":"Also like the methods in the \"Inserting Sibling Nodes\" section, the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.AppendChildElement%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.PrependChildElement%2A&gt;</ph> methods insert a single child node to the end of and the beginning of the list of child nodes of the node an <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object is currently positioned on using the namespace prefix, local name, namespace URI, and value specified as parameters.","source":"Also like the methods in the \"Inserting Sibling Nodes\" section, the <xref:System.Xml.XPath.XPathNavigator.AppendChildElement%2A> and <xref:System.Xml.XPath.XPathNavigator.PrependChildElement%2A> methods insert a single child node to the end of and the beginning of the list of child nodes of the node an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on using the namespace prefix, local name, namespace URI, and value specified as parameters."},{"pos":[5751,5906],"content":"In the following example, a new <ph id=\"ph1\">`pages`</ph> child element is appended to the list of child elements of the first <ph id=\"ph2\">`book`</ph> element in the <ph id=\"ph3\">`contosoBooks.xml`</ph> file.","source":"In the following example, a new `pages` child element is appended to the list of child elements of the first `book` element in the `contosoBooks.xml` file."},{"pos":[5913,6349],"content":"[!code-cpp[XPathNavigatorMethods#2](../../../../samples/snippets/cpp/VS_Snippets_Data/XPathNavigatorMethods/CPP/xpathnavigatormethods.cpp#2)]\n[!code-csharp[XPathNavigatorMethods#2](../../../../samples/snippets/csharp/VS_Snippets_Data/XPathNavigatorMethods/CS/xpathnavigatormethods.cs#2)]\n[!code-vb[XPathNavigatorMethods#2](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XPathNavigatorMethods/VB/xpathnavigatormethods.vb#2)]","leadings":[""," "," "],"nodes":[]},{"pos":[6356,6414],"content":"The example takes the <ph id=\"ph1\">`contosoBooks.xml`</ph> file as an input.","source":"The example takes the `contosoBooks.xml` file as an input."},{"pos":[6550,6905],"content":"For more information about the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.AppendChild%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.PrependChild%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator.AppendChildElement%2A&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Xml.XPath.XPathNavigator.PrependChildElement%2A&gt;</ph> methods, see the <ph id=\"ph5\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class reference documentation.","source":"For more information about the <xref:System.Xml.XPath.XPathNavigator.AppendChild%2A>, <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A>, <xref:System.Xml.XPath.XPathNavigator.AppendChildElement%2A> and <xref:System.Xml.XPath.XPathNavigator.PrependChildElement%2A> methods, see the <xref:System.Xml.XPath.XPathNavigator> class reference documentation."},{"pos":[6915,6940],"content":"Inserting Attribute Nodes","linkify":"Inserting Attribute Nodes","nodes":[{"content":"Inserting Attribute Nodes","pos":[0,25]}]},{"pos":[6944,7050],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class provides the following methods to insert attribute nodes.","source":"The <xref:System.Xml.XPath.XPathNavigator> class provides the following methods to insert attribute nodes."},{"content":"These methods insert attribute nodes on the element node an <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object is currently positioned on.","pos":[7192,7325],"source":"These methods insert attribute nodes on the element node an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.CreateAttribute%2A&gt;</ph> method creates an attribute node on the element node an <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object is currently positioned on using the namespace prefix, local name, namespace URI, and value specified as parameters.","pos":[7326,7606],"source":" The <xref:System.Xml.XPath.XPathNavigator.CreateAttribute%2A> method creates an attribute node on the element node an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on using the namespace prefix, local name, namespace URI, and value specified as parameters."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A&gt;</ph> method returns an <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object used to insert attribute nodes.","pos":[7607,7754],"source":" The <xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A> method returns an <xref:System.Xml.XmlWriter> object used to insert attribute nodes."},{"pos":[7761,8057],"content":"In the following example, new <ph id=\"ph1\">`discount`</ph> and <ph id=\"ph2\">`currency`</ph> attributes are created on the <ph id=\"ph3\">`price`</ph> child element of the first <ph id=\"ph4\">`book`</ph> element in the <ph id=\"ph5\">`contosoBooks.xml`</ph> file using the <ph id=\"ph6\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object returned from the <ph id=\"ph7\">&lt;xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A&gt;</ph> method.","source":"In the following example, new `discount` and `currency` attributes are created on the `price` child element of the first `book` element in the `contosoBooks.xml` file using the <xref:System.Xml.XmlWriter> object returned from the <xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A> method."},{"pos":[8064,8500],"content":"[!code-cpp[XPathNavigatorMethods#8](../../../../samples/snippets/cpp/VS_Snippets_Data/XPathNavigatorMethods/CPP/xpathnavigatormethods.cpp#8)]\n[!code-csharp[XPathNavigatorMethods#8](../../../../samples/snippets/csharp/VS_Snippets_Data/XPathNavigatorMethods/CS/xpathnavigatormethods.cs#8)]\n[!code-vb[XPathNavigatorMethods#8](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XPathNavigatorMethods/VB/xpathnavigatormethods.vb#8)]","leadings":[""," "," "],"nodes":[]},{"pos":[8507,8565],"content":"The example takes the <ph id=\"ph1\">`contosoBooks.xml`</ph> file as an input.","source":"The example takes the `contosoBooks.xml` file as an input."},{"pos":[8701,8939],"content":"For more information about the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.CreateAttribute%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A&gt;</ph> methods, see the <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class reference documentation.","source":"For more information about the <xref:System.Xml.XPath.XPathNavigator.CreateAttribute%2A> and <xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A> methods, see the <xref:System.Xml.XPath.XPathNavigator> class reference documentation."},{"pos":[8948,8961],"content":"Copying Nodes","linkify":"Copying Nodes","nodes":[{"content":"Copying Nodes","pos":[0,13]}]},{"content":"In certain cases you may want to populate an XML document with the contents from another XML document.","pos":[8965,9067]},{"content":"Both the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class and the <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter&gt;</ph> class can copy nodes to an <ph id=\"ph3\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object from an existing <ph id=\"ph4\">&lt;xref:System.Xml.XmlReader&gt;</ph> object or <ph id=\"ph5\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object.","pos":[9068,9323],"source":" Both the <xref:System.Xml.XPath.XPathNavigator> class and the <xref:System.Xml.XmlWriter> class can copy nodes to an <xref:System.Xml.XmlDocument> object from an existing <xref:System.Xml.XmlReader> object or <xref:System.Xml.XPath.XPathNavigator> object."},{"pos":[9330,9758],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.AppendChild%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.PrependChild%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A&gt;</ph> methods of the <ph id=\"ph5\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class all have overloads that can accept an <ph id=\"ph6\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object or an <ph id=\"ph7\">&lt;xref:System.Xml.XmlReader&gt;</ph> object as a parameter.","source":"The <xref:System.Xml.XPath.XPathNavigator.AppendChild%2A>, <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A>, <xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A> and <xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A> methods of the <xref:System.Xml.XPath.XPathNavigator> class all have overloads that can accept an <xref:System.Xml.XPath.XPathNavigator> object or an <xref:System.Xml.XmlReader> object as a parameter."},{"pos":[9765,9996],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter.WriteNode%2A&gt;</ph> method of the <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter&gt;</ph> class has overloads that can accept an <ph id=\"ph3\">&lt;xref:System.Xml.XmlNode&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Xml.XmlReader&gt;</ph>, or <ph id=\"ph5\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object.","source":"The <xref:System.Xml.XmlWriter.WriteNode%2A> method of the <xref:System.Xml.XmlWriter> class has overloads that can accept an <xref:System.Xml.XmlNode>, <xref:System.Xml.XmlReader>, or <xref:System.Xml.XPath.XPathNavigator> object."},{"pos":[10003,10085],"content":"The following example copies all the <ph id=\"ph1\">`book`</ph> elements from one document to another.","source":"The following example copies all the `book` elements from one document to another."},{"pos":[11136,11152],"content":"Inserting Values","linkify":"Inserting Values","nodes":[{"content":"Inserting Values","pos":[0,16]}]},{"pos":[11156,11410],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class provides the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.SetValue%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator.SetTypedValue%2A&gt;</ph> methods to insert values for a node into an <ph id=\"ph4\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object.","source":"The <xref:System.Xml.XPath.XPathNavigator> class provides the <xref:System.Xml.XPath.XPathNavigator.SetValue%2A> and <xref:System.Xml.XPath.XPathNavigator.SetTypedValue%2A> methods to insert values for a node into an <xref:System.Xml.XmlDocument> object."},{"pos":[11420,11444],"content":"Inserting Untyped Values","linkify":"Inserting Untyped Values","nodes":[{"content":"Inserting Untyped Values","pos":[0,24]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.SetValue%2A&gt;</ph> method simply inserts the untyped <ph id=\"ph2\">`string`</ph> value passed as a parameter as the value of the node the <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object is currently positioned on.","pos":[11448,11676],"source":"The <xref:System.Xml.XPath.XPathNavigator.SetValue%2A> method simply inserts the untyped `string` value passed as a parameter as the value of the node the <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on."},{"content":"The value is inserted without any type or without verifying that the new value is valid according to the type of the node if schema information is available.","pos":[11677,11834]},{"pos":[11841,11999],"content":"In the following example, the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.SetValue%2A&gt;</ph> method is used to update all <ph id=\"ph2\">`price`</ph> elements in the <ph id=\"ph3\">`contosoBooks.xml`</ph> file.","source":"In the following example, the <xref:System.Xml.XPath.XPathNavigator.SetValue%2A> method is used to update all `price` elements in the `contosoBooks.xml` file."},{"pos":[12455,12513],"content":"The example takes the <ph id=\"ph1\">`contosoBooks.xml`</ph> file as an input.","source":"The example takes the `contosoBooks.xml` file as an input."},{"pos":[12652,12674],"content":"Inserting Typed Values","linkify":"Inserting Typed Values","nodes":[{"content":"Inserting Typed Values","pos":[0,22]}]},{"content":"When the type of a node is a W3C XML Schema simple type, the new value inserted by the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.SetTypedValue%2A&gt;</ph> method is checked against the facets of the simple type before the value is set.","pos":[12678,12901],"source":"When the type of a node is a W3C XML Schema simple type, the new value inserted by the <xref:System.Xml.XPath.XPathNavigator.SetTypedValue%2A> method is checked against the facets of the simple type before the value is set."},{"content":"If the new value is not valid according to the type of the node (for example, setting a value of <ph id=\"ph1\">`-1`</ph> on an element whose type is <ph id=\"ph2\">`xs:positiveInteger`</ph>), it results in an exception.","pos":[12902,13082],"source":" If the new value is not valid according to the type of the node (for example, setting a value of `-1` on an element whose type is `xs:positiveInteger`), it results in an exception."},{"content":"The following example attempts to change the value of the <ph id=\"ph1\">`price`</ph> element of the first <ph id=\"ph2\">`book`</ph> element in the <ph id=\"ph3\">`contosoBooks.xml`</ph> file to a <ph id=\"ph4\">&lt;xref:System.DateTime&gt;</ph> value.","pos":[13089,13256],"source":"The following example attempts to change the value of the `price` element of the first `book` element in the `contosoBooks.xml` file to a <xref:System.DateTime> value."},{"content":"Because the XML Schema type of the <ph id=\"ph1\">`price`</ph> element is defined as <ph id=\"ph2\">`xs:decimal`</ph> in the <ph id=\"ph3\">`contosoBooks.xsd`</ph> files, this results in an exception.","pos":[13257,13397],"source":" Because the XML Schema type of the `price` element is defined as `xs:decimal` in the `contosoBooks.xsd` files, this results in an exception."},{"pos":[14723,14781],"content":"The example takes the <ph id=\"ph1\">`contosoBooks.xml`</ph> file as an input.","source":"The example takes the `contosoBooks.xml` file as an input."},{"pos":[14917,14975],"content":"The example also takes the <ph id=\"ph1\">`contosoBooks.xsd`</ph> as an input.","source":"The example also takes the `contosoBooks.xsd` as an input."},{"pos":[15113,15149],"content":"The InnerXml and OuterXml Properties","linkify":"The InnerXml and OuterXml Properties","nodes":[{"content":"The InnerXml and OuterXml Properties","pos":[0,36]}]},{"pos":[15153,15437],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.InnerXml%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.OuterXml%2A&gt;</ph> properties of the <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class change the XML markup of the nodes an <ph id=\"ph4\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object is currently positioned on.","source":"The <xref:System.Xml.XPath.XPathNavigator.InnerXml%2A> and <xref:System.Xml.XPath.XPathNavigator.OuterXml%2A> properties of the <xref:System.Xml.XPath.XPathNavigator> class change the XML markup of the nodes an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.InnerXml%2A&gt;</ph> property changes the XML markup of the child nodes an <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object is currently positioned on with the parsed contents of the given XML <ph id=\"ph3\">`string`</ph>.","pos":[15444,15677],"source":"The <xref:System.Xml.XPath.XPathNavigator.InnerXml%2A> property changes the XML markup of the child nodes an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on with the parsed contents of the given XML `string`."},{"content":"Similarly, the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.OuterXml%2A&gt;</ph> property changes the XML markup of the child nodes an <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object is currently positioned on as well as the current node itself.","pos":[15678,15906],"source":" Similarly, the <xref:System.Xml.XPath.XPathNavigator.OuterXml%2A> property changes the XML markup of the child nodes an <xref:System.Xml.XPath.XPathNavigator> object is currently positioned on as well as the current node itself."},{"content":"In addition to the methods described in this topic, the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.InnerXml%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.OuterXml%2A&gt;</ph> properties can be used to insert nodes and values in an XML document.","pos":[15913,16144],"source":"In addition to the methods described in this topic, the <xref:System.Xml.XPath.XPathNavigator.InnerXml%2A> and <xref:System.Xml.XPath.XPathNavigator.OuterXml%2A> properties can be used to insert nodes and values in an XML document."},{"content":"For more information about using the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.InnerXml%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.OuterXml%2A&gt;</ph> properties to insert nodes and values, see the <bpt id=\"p1\">[</bpt>Modify XML Data using XPathNavigator<ept id=\"p1\">](../../../../docs/standard/data/xml/modify-xml-data-using-xpathnavigator.md)</ept> topic.","pos":[16145,16456],"source":" For more information about using the <xref:System.Xml.XPath.XPathNavigator.InnerXml%2A> and <xref:System.Xml.XPath.XPathNavigator.OuterXml%2A> properties to insert nodes and values, see the [Modify XML Data using XPathNavigator](../../../../docs/standard/data/xml/modify-xml-data-using-xpathnavigator.md) topic."},{"pos":[16465,16497],"content":"Namespace and xml:lang Conflicts","linkify":"Namespace and xml:lang Conflicts","nodes":[{"content":"Namespace and xml:lang Conflicts","pos":[0,32]}]},{"pos":[16501,16969],"content":"Certain conflicts related to the scope of namespace and <ph id=\"ph1\">`xml:lang`</ph> declarations can occur when inserting XML data using the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Xml.XPath.XPathNavigator.AppendChild%2A&gt;</ph> and <ph id=\"ph5\">&lt;xref:System.Xml.XPath.XPathNavigator.PrependChild%2A&gt;</ph> methods of the <ph id=\"ph6\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class that take <ph id=\"ph7\">&lt;xref:System.Xml.XmlReader&gt;</ph> objects as parameters.","source":"Certain conflicts related to the scope of namespace and `xml:lang` declarations can occur when inserting XML data using the <xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A>, <xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A>, <xref:System.Xml.XPath.XPathNavigator.AppendChild%2A> and <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A> methods of the <xref:System.Xml.XPath.XPathNavigator> class that take <xref:System.Xml.XmlReader> objects as parameters."},{"content":"The following are the possible namespace conflicts.","pos":[16976,17027]},{"pos":[17037,17304],"content":"If there is a namespace in-scope within the <ph id=\"ph1\">&lt;xref:System.Xml.XmlReader&gt;</ph> object's context, where the prefix to namespace URI mapping is not in the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object's context, a new namespace declaration is added to the newly inserted node.","source":"If there is a namespace in-scope within the <xref:System.Xml.XmlReader> object's context, where the prefix to namespace URI mapping is not in the <xref:System.Xml.XPath.XPathNavigator> object's context, a new namespace declaration is added to the newly inserted node."},{"pos":[17314,17685],"content":"If the same namespace URI is in-scope within both the <ph id=\"ph1\">&lt;xref:System.Xml.XmlReader&gt;</ph> object's context and the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object's context, but has a different prefix mapped to it in both contexts, a new namespace declaration is added to the newly inserted node, with the prefix and namespace URI taken from the <ph id=\"ph3\">&lt;xref:System.Xml.XmlReader&gt;</ph> object.","source":"If the same namespace URI is in-scope within both the <xref:System.Xml.XmlReader> object's context and the <xref:System.Xml.XPath.XPathNavigator> object's context, but has a different prefix mapped to it in both contexts, a new namespace declaration is added to the newly inserted node, with the prefix and namespace URI taken from the <xref:System.Xml.XmlReader> object."},{"pos":[17695,18090],"content":"If the same namespace prefix is in-scope within both the <ph id=\"ph1\">&lt;xref:System.Xml.XmlReader&gt;</ph> object's context and the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object's context, but has a different namespace URI mapped to it in both contexts, a new namespace declaration is added to the newly inserted node which re-declares that prefix with the namespace URI taken from <ph id=\"ph3\">&lt;xref:System.Xml.XmlReader&gt;</ph> object.","source":"If the same namespace prefix is in-scope within both the <xref:System.Xml.XmlReader> object's context and the <xref:System.Xml.XPath.XPathNavigator> object's context, but has a different namespace URI mapped to it in both contexts, a new namespace declaration is added to the newly inserted node which re-declares that prefix with the namespace URI taken from <xref:System.Xml.XmlReader> object."},{"pos":[18100,18342],"content":"If the prefix as well as the namespace URI in both the <ph id=\"ph1\">&lt;xref:System.Xml.XmlReader&gt;</ph> object's context and the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object's context is the same, no new namespace declaration is added to the newly inserted node.","source":"If the prefix as well as the namespace URI in both the <xref:System.Xml.XmlReader> object's context and the <xref:System.Xml.XPath.XPathNavigator> object's context is the same, no new namespace declaration is added to the newly inserted node."},{"pos":[18350,18507],"content":"[!NOTE]\n The description above also applies to namespace declarations with the empty `string` as a prefix (for example, the default namespace declaration).","leadings":["","> "],"nodes":[{"content":"The description above also applies to namespace declarations with the empty <ph id=\"ph1\">`string`</ph> as a prefix (for example, the default namespace declaration).","pos":[9,155],"source":"The description above also applies to namespace declarations with the empty `string` as a prefix (for example, the default namespace declaration)."}]},{"pos":[18514,18566],"content":"The following are the possible <ph id=\"ph1\">`xml:lang`</ph> conflicts.","source":"The following are the possible `xml:lang` conflicts."},{"pos":[18576,18874],"content":"If there is an <ph id=\"ph1\">`xml:lang`</ph> attribute in-scope within the <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph> object's context but not in the <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object's context, an <ph id=\"ph4\">`xml:lang`</ph> attribute whose value is taken from the <ph id=\"ph5\">&lt;xref:System.Xml.XmlReader&gt;</ph> object is added to the newly inserted node.","source":"If there is an `xml:lang` attribute in-scope within the <xref:System.Xml.XmlReader> object's context but not in the <xref:System.Xml.XPath.XPathNavigator> object's context, an `xml:lang` attribute whose value is taken from the <xref:System.Xml.XmlReader> object is added to the newly inserted node."},{"pos":[18884,19212],"content":"If there is an <ph id=\"ph1\">`xml:lang`</ph> attribute in-scope within both the <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph> object's context and the <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object's context, but each has a different value, an <ph id=\"ph4\">`xml:lang`</ph> attribute whose value is taken from the <ph id=\"ph5\">&lt;xref:System.Xml.XmlReader&gt;</ph> object is added to the newly inserted node.","source":"If there is an `xml:lang` attribute in-scope within both the <xref:System.Xml.XmlReader> object's context and the <xref:System.Xml.XPath.XPathNavigator> object's context, but each has a different value, an `xml:lang` attribute whose value is taken from the <xref:System.Xml.XmlReader> object is added to the newly inserted node."},{"pos":[19222,19487],"content":"If there is an <ph id=\"ph1\">`xml:lang`</ph> attribute in-scope within both the <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph> object's context and the <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object's context, but each with the same value, no new <ph id=\"ph4\">`xml:lang`</ph> attribute is added on the newly inserted node.","source":"If there is an `xml:lang` attribute in-scope within both the <xref:System.Xml.XmlReader> object's context and the <xref:System.Xml.XPath.XPathNavigator> object's context, but each with the same value, no new `xml:lang` attribute is added on the newly inserted node."},{"pos":[19497,19741],"content":"If there is an <ph id=\"ph1\">`xml:lang`</ph> attribute in-scope within the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object's context, but none existing in the <ph id=\"ph3\">&lt;xref:System.Xml.XmlReader&gt;</ph> object's context, no <ph id=\"ph4\">`xml:lang`</ph> attribute is added to the newly inserted node.","source":"If there is an `xml:lang` attribute in-scope within the <xref:System.Xml.XPath.XPathNavigator> object's context, but none existing in the <xref:System.Xml.XmlReader> object's context, no `xml:lang` attribute is added to the newly inserted node."},{"pos":[19750,19780],"content":"Inserting Nodes with XmlWriter","linkify":"Inserting Nodes with XmlWriter","nodes":[{"content":"Inserting Nodes with XmlWriter","pos":[0,30]}]},{"content":"The methods used to insert sibling, child and attribute nodes described in the \"Inserting Nodes and Values\" section are overloaded.","pos":[19784,19915]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator.AppendChild%2A&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Xml.XPath.XPathNavigator.PrependChild%2A&gt;</ph> and <ph id=\"ph5\">&lt;xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A&gt;</ph> methods of the <ph id=\"ph6\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class return an <ph id=\"ph7\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object used to insert nodes.","pos":[19916,20330],"source":" The <xref:System.Xml.XPath.XPathNavigator.InsertAfter%2A>, <xref:System.Xml.XPath.XPathNavigator.InsertBefore%2A>, <xref:System.Xml.XPath.XPathNavigator.AppendChild%2A>, <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A> and <xref:System.Xml.XPath.XPathNavigator.CreateAttributes%2A> methods of the <xref:System.Xml.XPath.XPathNavigator> class return an <xref:System.Xml.XmlWriter> object used to insert nodes."},{"pos":[20340,20369],"content":"Unsupported XmlWriter Methods","linkify":"Unsupported XmlWriter Methods","nodes":[{"content":"Unsupported XmlWriter Methods","pos":[0,29]}]},{"pos":[20373,20637],"content":"Not all of the methods used for writing information to an XML document using the <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph> class are supported by the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class due to difference between the XPath data model and the Document Object Model (DOM).","source":"Not all of the methods used for writing information to an XML document using the <xref:System.Xml.XmlWriter> class are supported by the <xref:System.Xml.XPath.XPathNavigator> class due to difference between the XPath data model and the Document Object Model (DOM)."},{"pos":[20644,20786],"content":"The following table describes the <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph> class methods not supported by the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class.","source":"The following table describes the <xref:System.Xml.XmlWriter> class methods not supported by the <xref:System.Xml.XPath.XPathNavigator> class."},{"content":"Method","pos":[20793,20799]},{"content":"Description","pos":[20800,20811]},{"pos":[20897,20952],"content":"Throws a <ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph> exception.","source":"Throws a <xref:System.NotSupportedException> exception."},{"pos":[21001,21135],"content":"Ignored at the root level and throws a <ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph> exception if called at any other level in the XML document.","source":"Ignored at the root level and throws a <xref:System.NotSupportedException> exception if called at any other level in the XML document."},{"pos":[21182,21300],"content":"Treated as a call to the <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter.WriteString%2A&gt;</ph> method for the equivalent character or characters.","source":"Treated as a call to the <xref:System.Xml.XmlWriter.WriteString%2A> method for the equivalent character or characters."},{"pos":[21352,21470],"content":"Treated as a call to the <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter.WriteString%2A&gt;</ph> method for the equivalent character or characters.","source":"Treated as a call to the <xref:System.Xml.XmlWriter.WriteString%2A> method for the equivalent character or characters."},{"pos":[21531,21649],"content":"Treated as a call to the <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter.WriteString%2A&gt;</ph> method for the equivalent character or characters.","source":"Treated as a call to the <xref:System.Xml.XmlWriter.WriteString%2A> method for the equivalent character or characters."},{"pos":[21657,21789],"content":"For more information about the <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph> class, see the <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter&gt;</ph> class reference documentation.","source":"For more information about the <xref:System.Xml.XmlWriter> class, see the <xref:System.Xml.XmlWriter> class reference documentation."},{"pos":[21799,21825],"content":"Multiple XmlWriter Objects","linkify":"Multiple XmlWriter Objects","nodes":[{"content":"Multiple XmlWriter Objects","pos":[0,26]}]},{"content":"It is possible to have multiple <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> objects pointing to different parts of an XML document with one or more open <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter&gt;</ph> objects.","pos":[21829,22013],"source":"It is possible to have multiple <xref:System.Xml.XPath.XPathNavigator> objects pointing to different parts of an XML document with one or more open <xref:System.Xml.XmlWriter> objects."},{"content":"Multiple <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph> objects are allowed and supported in single-threaded scenarios.","pos":[22014,22114],"source":" Multiple <xref:System.Xml.XmlWriter> objects are allowed and supported in single-threaded scenarios."},{"pos":[22121,22223],"content":"The following are important notes to consider when using multiple <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph> objects.","source":"The following are important notes to consider when using multiple <xref:System.Xml.XmlWriter> objects."},{"content":"XML fragments written by <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph> objects are added to the XML document when the <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter.Close%2A&gt;</ph> method of each <ph id=\"ph3\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object is called.","pos":[22233,22430],"source":"XML fragments written by <xref:System.Xml.XmlWriter> objects are added to the XML document when the <xref:System.Xml.XmlWriter.Close%2A> method of each <xref:System.Xml.XmlWriter> object is called."},{"content":"Until that point, the <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object is writing a disconnected fragment.","pos":[22431,22523],"source":" Until that point, the <xref:System.Xml.XmlWriter> object is writing a disconnected fragment."},{"content":"If an operation is performed on the XML document, any fragments being written by an <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object, before the <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter.Close%2A&gt;</ph> has been called, are not affected.","pos":[22524,22726],"source":" If an operation is performed on the XML document, any fragments being written by an <xref:System.Xml.XmlWriter> object, before the <xref:System.Xml.XmlWriter.Close%2A> has been called, are not affected."},{"content":"If there is an open <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object on a particular XML subtree and that subtree is deleted, the <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object may still add to the sub-tree.","pos":[22736,22917],"source":"If there is an open <xref:System.Xml.XmlWriter> object on a particular XML subtree and that subtree is deleted, the <xref:System.Xml.XmlWriter> object may still add to the sub-tree."},{"content":"The subtree simply becomes a deleted fragment.","pos":[22918,22964]},{"pos":[22974,23224],"content":"If multiple <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph> objects are opened at the same point in the XML document, they are added to the XML document in the order in which the <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter&gt;</ph> objects are closed, not in the order in which they were opened.","source":"If multiple <xref:System.Xml.XmlWriter> objects are opened at the same point in the XML document, they are added to the XML document in the order in which the <xref:System.Xml.XmlWriter> objects are closed, not in the order in which they were opened."},{"content":"The following example creates an <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object, creates an <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object, and then uses the <ph id=\"ph3\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object returned by the <ph id=\"ph4\">&lt;xref:System.Xml.XPath.XPathNavigator.PrependChild%2A&gt;</ph> method to create the structure of the first book in the <ph id=\"ph5\">`books.xml`</ph> file.","pos":[23231,23557],"source":"The following example creates an <xref:System.Xml.XmlDocument> object, creates an <xref:System.Xml.XPath.XPathNavigator> object, and then uses the <xref:System.Xml.XmlWriter> object returned by the <xref:System.Xml.XPath.XPathNavigator.PrependChild%2A> method to create the structure of the first book in the `books.xml` file."},{"content":"The example then saves it as the <ph id=\"ph1\">`book.xml`</ph> file.","pos":[23558,23607],"source":" The example then saves it as the `book.xml` file."},{"pos":[25382,25404],"content":"Saving an XML Document","linkify":"Saving an XML Document","nodes":[{"content":"Saving an XML Document","pos":[0,22]}]},{"content":"Saving changes made to an <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object as the result of the methods described in this topic is performed using the methods of the <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class.","pos":[25408,25598],"source":"Saving changes made to an <xref:System.Xml.XmlDocument> object as the result of the methods described in this topic is performed using the methods of the <xref:System.Xml.XmlDocument> class."},{"content":"For more information about saving changes made to an <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object, see <bpt id=\"p1\">[</bpt>Saving and Writing a Document<ept id=\"p1\">](../../../../docs/standard/data/xml/saving-and-writing-a-document.md)</ept>.","pos":[25599,25795],"source":" For more information about saving changes made to an <xref:System.Xml.XmlDocument> object, see [Saving and Writing a Document](../../../../docs/standard/data/xml/saving-and-writing-a-document.md)."},{"pos":[25804,25812],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[25929,26057],"content":"<bpt id=\"p1\">[</bpt>Process XML Data Using the XPath Data Model<ept id=\"p1\">](../../../../docs/standard/data/xml/process-xml-data-using-the-xpath-data-model.md)</ept>","source":"[Process XML Data Using the XPath Data Model](../../../../docs/standard/data/xml/process-xml-data-using-the-xpath-data-model.md)"},{"pos":[26060,26174],"content":"<bpt id=\"p1\">[</bpt>Modify XML Data using XPathNavigator<ept id=\"p1\">](../../../../docs/standard/data/xml/modify-xml-data-using-xpathnavigator.md)</ept>","source":"[Modify XML Data using XPathNavigator](../../../../docs/standard/data/xml/modify-xml-data-using-xpathnavigator.md)"},{"pos":[26177,26291],"content":"<bpt id=\"p1\">[</bpt>Remove XML Data using XPathNavigator<ept id=\"p1\">](../../../../docs/standard/data/xml/remove-xml-data-using-xpathnavigator.md)</ept>","source":"[Remove XML Data using XPathNavigator](../../../../docs/standard/data/xml/remove-xml-data-using-xpathnavigator.md)"}]}