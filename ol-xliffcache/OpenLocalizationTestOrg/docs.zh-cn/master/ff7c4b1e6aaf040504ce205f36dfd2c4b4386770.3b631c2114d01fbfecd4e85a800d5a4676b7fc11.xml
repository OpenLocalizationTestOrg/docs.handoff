{"content":"---\ntitle: \"How to: Configure Persistence with WorkflowServiceHost | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: e31cd4df-13a3-4a9a-9be8-5243e0055356\ncaps.latest.revision: 14\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Configure Persistence with WorkflowServiceHost\nThis topic describes how to configure the SQL Workflow Instance Store feature to enable persistence for workflows hosted in <xref:System.ServiceModel.Activities.WorkflowServiceHost> by using a configuration file. Before using the SQL Workflow Instance Store feature you must create a SQL database that is used to persist workflow instances. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][How to: Enable SQL Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md).  \n  \n### To Configure the SQL Workflow Instance Store in Configuration  \n  \n1.  The properties of the SQL workflow instance store can be configured through the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior>, a service behavior that allows you to change the settings through XML configuration. The following configuration example shows how to configure the SQL workflow instance store by using the <`sqlWorkflowInstanceStore`> behavior element in a configuration file.  \n  \n    ```xml  \n    <serviceBehaviors>  \n        <behavior name=\"\">  \n            <sqlWorkflowInstanceStore   \n                 connectionString=\"provider=System.Data.SqlClient;Data Source=(local);Initial Catalog=DefaultPersistenceProviderDb;Integrated Security=True;Async=true\"  \n                 instanceEncodingOption=\"GZip | None\"  \n                 instanceCompletionAction=\"DeleteAll | DeleteNothing\"  \n                 instanceLockedExceptionAction=\"NoRetry | SimpleRetry | AggressiveRetry\"  \n                 hostLockRenewalPeriod=\"00:00:30\"   \n                 runnableInstancesDetectionPeriod=\"00:00:05\">  \n            <sqlWorkflowInstanceStore/>  \n        </behavior>  \n    </serviceBehaviors>  \n  \n    ```  \n  \n     [!INCLUDE[crabout](../../../../includes/crabout-md.md)] how to configure the SQL workflow instance store, see [How to: Enable SQL Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md). [!INCLUDE[crabout](../../../../includes/crabout-md.md)] the individual settings for the <`sqlWorkflowInstanceStore`> behavior element, see [SQL Workflow Instance Store](../../../../docs/framework/windows-workflow-foundation/sql-workflow-instance-store.md). Windows Server App Fabric provides its own persistence store. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Windows Server App Fabric Persistence](http://go.microsoft.com/fwlink/?LinkId=193121).  \n  \n    > [!NOTE]\n    >  The preceding configuration example uses simplified configuration. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)  \n  \n### To Configure the SQL Workflow Instance Store in Code  \n  \n1.  The properties of the SQL workflow instance store can be configured through the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior>, a service behavior that allows you to change the settings through code. The following example shows how to configure the SQL workflow instance store by using the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior> behavior element in a code  \n  \n    ```csharp  \n    host.Description.Behaviors.Add(new SqlWorkflowInstanceStoreBehavior  \n    {  \n       ConnectionString = \"provider=System.Data.SqlClient;Data Source=(local);Initial Catalog=DefaultPersistenceProviderDb;Integrated Security=True;Async=true\",  \n       InstanceEncodingOption = \"GZip | None\",  \n       InstanceCompletionAction = \"DeleteAll | DeleteNothing\",  \n       InstanceLockedExceptionAction = \"NoRetry | SimpleRetry | AggressiveRetry\",  \n       HostLockRenewalPeriod = new TimeSpan(00, 00, 30),  \n       RunnableInstancesDetectionPeriod = new TimeSpan(00, 00, 05)  \n    });  \n    ```  \n  \n     [!INCLUDE[crabout](../../../../includes/crabout-md.md)] how to configure the SQL workflow instance store, see [How to: Enable SQL Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md). [!INCLUDE[crabout](../../../../includes/crabout-md.md)] the individual settings for the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior> behavior element, see [SQL Workflow Instance Store](../../../../docs/framework/windows-workflow-foundation/sql-workflow-instance-store.md). Windows Server App Fabric provides its own persistence store. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Windows Server App Fabric Persistence](http://go.microsoft.com/fwlink/?LinkId=193121).  \n  \n    > [!NOTE]\n    >  The preceding configuration example uses simplified configuration. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)  \n  \n     For an example of how to configure persistence programmatically see [How to: Enable Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-persistence-for-workflows-and-workflow-services.md).  \n  \n## See Also  \n [Workflow Services](../../../../docs/framework/wcf/feature-details/workflow-services.md)   \n [Workflow Persistence](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md)   \n [Windows Server App Fabric Persistence](http://go.microsoft.com/fwlink/?LinkId=193121)","nodes":[{"pos":[12,83],"content":"How to: Configure Persistence with WorkflowServiceHost | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Configure Persistence with WorkflowServiceHost | Microsoft Docs","pos":[0,71]}]},{"pos":[382,436],"content":"How to: Configure Persistence with WorkflowServiceHost","linkify":"How to: Configure Persistence with WorkflowServiceHost","nodes":[{"content":"How to: Configure Persistence with WorkflowServiceHost","pos":[0,54]}]},{"content":"This topic describes how to configure the SQL Workflow Instance Store feature to enable persistence for workflows hosted in <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost&gt;</ph> by using a configuration file.","pos":[437,649],"source":"This topic describes how to configure the SQL Workflow Instance Store feature to enable persistence for workflows hosted in <xref:System.ServiceModel.Activities.WorkflowServiceHost> by using a configuration file."},{"content":"Before using the SQL Workflow Instance Store feature you must create a SQL database that is used to persist workflow instances.","pos":[650,777]},{"content":"<ph id=\"ph1\">[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]</ph><bpt id=\"p1\">[</bpt>How to: Enable SQL Persistence for Workflows and Workflow Services<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md)</ept>.","pos":[778,1031],"source":"[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][How to: Enable SQL Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md)."},{"pos":[1041,1102],"content":"To Configure the SQL Workflow Instance Store in Configuration","linkify":"To Configure the SQL Workflow Instance Store in Configuration","nodes":[{"content":"To Configure the SQL Workflow Instance Store in Configuration","pos":[0,61]}]},{"content":"The properties of the SQL workflow instance store can be configured through the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior&gt;</ph>, a service behavior that allows you to change the settings through XML configuration.","pos":[1112,1360],"source":"The properties of the SQL workflow instance store can be configured through the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior>, a service behavior that allows you to change the settings through XML configuration."},{"content":"The following configuration example shows how to configure the SQL workflow instance store by using the &lt;<ph id=\"ph1\">`sqlWorkflowInstanceStore`</ph>&gt; behavior element in a configuration file.","pos":[1361,1535],"source":" The following configuration example shows how to configure the SQL workflow instance store by using the <`sqlWorkflowInstanceStore`> behavior element in a configuration file."},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> how to configure the SQL workflow instance store, see <bpt id=\"p1\">[</bpt>How to: Enable SQL Persistence for Workflows and Workflow Services<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md)</ept>.","pos":[2266,2570],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] how to configure the SQL workflow instance store, see [How to: Enable SQL Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md)."},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> the individual settings for the &lt;<ph id=\"ph2\">`sqlWorkflowInstanceStore`</ph>&gt; behavior element, see <bpt id=\"p1\">[</bpt>SQL Workflow Instance Store<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/sql-workflow-instance-store.md)</ept>.","pos":[2571,2827],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] the individual settings for the <`sqlWorkflowInstanceStore`> behavior element, see [SQL Workflow Instance Store](../../../../docs/framework/windows-workflow-foundation/sql-workflow-instance-store.md)."},{"content":"Windows Server App Fabric provides its own persistence store.","pos":[2828,2889]},{"content":"<ph id=\"ph1\">[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]</ph><bpt id=\"p1\">[</bpt>Windows Server App Fabric Persistence<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=193121)</ept>.","pos":[2890,3036],"source":"[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Windows Server App Fabric Persistence](http://go.microsoft.com/fwlink/?LinkId=193121)."},{"pos":[3048,3275],"content":"[!NOTE]\nThe preceding configuration example uses simplified configuration. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)","leadings":["","    >  "],"nodes":[{"content":"The preceding configuration example uses simplified configuration. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)","pos":[8,220],"nodes":[{"content":"The preceding configuration example uses simplified configuration.","pos":[0,66]},{"content":"<ph id=\"ph1\">[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]</ph><bpt id=\"p1\">[</bpt>Simplified Configuration<ept id=\"p1\">](../../../../docs/framework/wcf/simplified-configuration.md)</ept>","pos":[67,212],"source":"[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)"}]}]},{"pos":[3285,3337],"content":"To Configure the SQL Workflow Instance Store in Code","linkify":"To Configure the SQL Workflow Instance Store in Code","nodes":[{"content":"To Configure the SQL Workflow Instance Store in Code","pos":[0,52]}]},{"content":"The properties of the SQL workflow instance store can be configured through the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior&gt;</ph>, a service behavior that allows you to change the settings through code.","pos":[3347,3582],"source":"The properties of the SQL workflow instance store can be configured through the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior>, a service behavior that allows you to change the settings through code."},{"content":"The following example shows how to configure the SQL workflow instance store by using the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior&gt;</ph> behavior element in a code","pos":[3583,3782],"source":" The following example shows how to configure the SQL workflow instance store by using the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior> behavior element in a code"},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> how to configure the SQL workflow instance store, see <bpt id=\"p1\">[</bpt>How to: Enable SQL Persistence for Workflows and Workflow Services<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md)</ept>.","pos":[4403,4707],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] how to configure the SQL workflow instance store, see [How to: Enable SQL Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-sql-persistence-for-workflows-and-workflow-services.md)."},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> the individual settings for the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior&gt;</ph> behavior element, see <bpt id=\"p1\">[</bpt>SQL Workflow Instance Store<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/sql-workflow-instance-store.md)</ept>.","pos":[4708,5018],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] the individual settings for the <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior> behavior element, see [SQL Workflow Instance Store](../../../../docs/framework/windows-workflow-foundation/sql-workflow-instance-store.md)."},{"content":"Windows Server App Fabric provides its own persistence store.","pos":[5019,5080]},{"content":"<ph id=\"ph1\">[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]</ph><bpt id=\"p1\">[</bpt>Windows Server App Fabric Persistence<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=193121)</ept>.","pos":[5081,5227],"source":"[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Windows Server App Fabric Persistence](http://go.microsoft.com/fwlink/?LinkId=193121)."},{"pos":[5239,5466],"content":"[!NOTE]\nThe preceding configuration example uses simplified configuration. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)","leadings":["","    >  "],"nodes":[{"content":"The preceding configuration example uses simplified configuration. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)","pos":[8,220],"nodes":[{"content":"The preceding configuration example uses simplified configuration.","pos":[0,66]},{"content":"<ph id=\"ph1\">[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]</ph><bpt id=\"p1\">[</bpt>Simplified Configuration<ept id=\"p1\">](../../../../docs/framework/wcf/simplified-configuration.md)</ept>","pos":[67,212],"source":"[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Simplified Configuration](../../../../docs/framework/wcf/simplified-configuration.md)"}]}]},{"pos":[5477,5731],"content":"For an example of how to configure persistence programmatically see <bpt id=\"p1\">[</bpt>How to: Enable Persistence for Workflows and Workflow Services<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/how-to-enable-persistence-for-workflows-and-workflow-services.md)</ept>.","source":"For an example of how to configure persistence programmatically see [How to: Enable Persistence for Workflows and Workflow Services](../../../../docs/framework/windows-workflow-foundation/how-to-enable-persistence-for-workflows-and-workflow-services.md)."},{"pos":[5740,5748],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Workflow Services<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/workflow-services.md)</ept><ph id=\"ph1\"> </ph>","pos":[5752,5841],"source":"[Workflow Services](../../../../docs/framework/wcf/feature-details/workflow-services.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Workflow Persistence<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md)</ept><ph id=\"ph1\"> </ph>","pos":[5844,5948],"source":" [Workflow Persistence](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Windows Server App Fabric Persistence<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=193121)</ept>","pos":[5951,6038],"source":" [Windows Server App Fabric Persistence](http://go.microsoft.com/fwlink/?LinkId=193121)"}]}