{"content":"---\ntitle: \"How to: Use a Custom Context Menu with a TextBox | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"context menus, custom\"\n  - \"menus, custom\"\n  - \"custom context menus\"\n  - \"TextBox control, custom content menus\"\nms.assetid: 842d3cd5-6fa0-4be4-8d90-6c7466213b1c\ncaps.latest.revision: 9\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Use a Custom Context Menu with a TextBox\nThis example shows how to define and implement a simple custom context menu for a <xref:System.Windows.Controls.TextBox>.  \n  \n## Example  \n The following [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] example defines a <xref:System.Windows.Controls.TextBox> control that includes a custom context menu.  \n  \n The context menu is defined using a <xref:System.Windows.Controls.ContextMenu> element.  The context menu itself consists of a series of <xref:System.Windows.Controls.MenuItem> elements and <xref:System.Windows.Controls.Separator> elements.  Each <xref:System.Windows.Controls.MenuItem> element defines a command in the context menu; the <xref:System.Windows.Controls.HeaderedItemsControl.Header%2A> attribute defines the display text for the menu command, and the <xref:System.Windows.Controls.MenuItem.Click> attribute specifies a handler method for each menu item.  The <xref:System.Windows.Controls.Separator> element simply causes a separating line to be rendered between the previous and subsequent menu items.  \n  \n [!code-xml[TextBox_ContextMenu#_TextBox_ContextMenuXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/TextBox_ContextMenu/CSharp/Window1.xaml#_textbox_contextmenuxaml)]  \n  \n## Example  \n The following example shows the implementation code for the preceding context menu definition, as well as the code that enables and disables the context menu.  The <xref:System.Windows.Controls.ContextMenu.Opened> event is used to dynamically enable or disable certain commands depending on the current state of the <xref:System.Windows.Controls.TextBox>.  \n  \n To restore the default context menu, use the <xref:System.Windows.DependencyObject.ClearValue%2A> method to clear the value of the <xref:System.Windows.FrameworkElement.ContextMenu%2A> property.  To disable the context menu altogether, set the <xref:System.Windows.FrameworkElement.ContextMenu%2A> property to a null reference (`Nothing` in Visual Basic).  \n  \n [!code-csharp[TextBox_ContextMenu#_TextBox_ContextMenu](../../../../samples/snippets/csharp/VS_Snippets_Wpf/TextBox_ContextMenu/CSharp/Window1.xaml.cs#_textbox_contextmenu)]\n [!code-vb[TextBox_ContextMenu#_TextBox_ContextMenu](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/TextBox_ContextMenu/VisualBasic/Window1.xaml.vb#_textbox_contextmenu)]  \n  \n## See Also  \n [Use Spell Checking with a Context Menu](../../../../docs/framework/wpf/controls/how-to-use-spell-checking-with-a-context-menu.md)   \n [TextBox Overview](../../../../docs/framework/wpf/controls/textbox-overview.md)   \n [RichTextBox Overview](../../../../docs/framework/wpf/controls/richtextbox-overview.md)","nodes":[{"pos":[4,518],"embed":true,"restype":"x-metadata","content":"title: \"How to: Use a Custom Context Menu with a TextBox | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"context menus, custom\"\n  - \"menus, custom\"\n  - \"custom context menus\"\n  - \"TextBox control, custom content menus\"\nms.assetid: 842d3cd5-6fa0-4be4-8d90-6c7466213b1c\ncaps.latest.revision: 9\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"How to: Use a Custom Context Menu with a TextBox | Microsoft Docs","nodes":[{"pos":[0,65],"content":"How to: Use a Custom Context Menu with a TextBox | Microsoft Docs","nodes":[{"content":"How to: Use a Custom Context Menu with a TextBox | Microsoft Docs","pos":[0,65]}]}],"path":["title"]}],"yml":true},{"pos":[525,573],"content":"How to: Use a Custom Context Menu with a TextBox","linkify":"How to: Use a Custom Context Menu with a TextBox","nodes":[{"content":"How to: Use a Custom Context Menu with a TextBox","pos":[0,48]}]},{"content":"This example shows how to define and implement a simple custom context menu for a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph>.","pos":[574,695],"source":"This example shows how to define and implement a simple custom context menu for a <xref:System.Windows.Controls.TextBox>."},{"pos":[704,711],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[715,900],"content":"The following <ph id=\"ph1\">[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]</ph> example defines a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> control that includes a custom context menu.","source":"The following [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] example defines a <xref:System.Windows.Controls.TextBox> control that includes a custom context menu."},{"content":"The context menu is defined using a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ContextMenu&gt;</ph> element.","pos":[907,994],"source":"The context menu is defined using a <xref:System.Windows.Controls.ContextMenu> element."},{"content":"The context menu itself consists of a series of <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph> elements and <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Separator&gt;</ph> elements.","pos":[996,1147],"source":"  The context menu itself consists of a series of <xref:System.Windows.Controls.MenuItem> elements and <xref:System.Windows.Controls.Separator> elements."},{"content":"Each <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph> element defines a command in the context menu; the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.HeaderedItemsControl.Header%2A&gt;</ph> attribute defines the display text for the menu command, and the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.MenuItem.Click&gt;</ph> attribute specifies a handler method for each menu item.","pos":[1149,1474],"source":"  Each <xref:System.Windows.Controls.MenuItem> element defines a command in the context menu; the <xref:System.Windows.Controls.HeaderedItemsControl.Header%2A> attribute defines the display text for the menu command, and the <xref:System.Windows.Controls.MenuItem.Click> attribute specifies a handler method for each menu item."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Separator&gt;</ph> element simply causes a separating line to be rendered between the previous and subsequent menu items.","pos":[1476,1623],"source":"  The <xref:System.Windows.Controls.Separator> element simply causes a separating line to be rendered between the previous and subsequent menu items."},{"pos":[1630,1805],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>TextBox_ContextMenu#_TextBox_ContextMenuXAML<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/TextBox_ContextMenu/CSharp/Window1.xaml#_textbox_contextmenuxaml)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[TextBox_ContextMenu#_TextBox_ContextMenuXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/TextBox_ContextMenu/CSharp/Window1.xaml#_textbox_contextmenuxaml)]"},{"pos":[1814,1821],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows the implementation code for the preceding context menu definition, as well as the code that enables and disables the context menu.","pos":[1825,1983]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ContextMenu.Opened&gt;</ph> event is used to dynamically enable or disable certain commands depending on the current state of the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph>.","pos":[1985,2180],"source":"  The <xref:System.Windows.Controls.ContextMenu.Opened> event is used to dynamically enable or disable certain commands depending on the current state of the <xref:System.Windows.Controls.TextBox>."},{"content":"To restore the default context menu, use the <ph id=\"ph1\">&lt;xref:System.Windows.DependencyObject.ClearValue%2A&gt;</ph> method to clear the value of the <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement.ContextMenu%2A&gt;</ph> property.","pos":[2187,2381],"source":"To restore the default context menu, use the <xref:System.Windows.DependencyObject.ClearValue%2A> method to clear the value of the <xref:System.Windows.FrameworkElement.ContextMenu%2A> property."},{"content":"To disable the context menu altogether, set the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.ContextMenu%2A&gt;</ph> property to a null reference (<ph id=\"ph2\">`Nothing`</ph> in Visual Basic).","pos":[2383,2542],"source":"  To disable the context menu altogether, set the <xref:System.Windows.FrameworkElement.ContextMenu%2A> property to a null reference (`Nothing` in Visual Basic)."},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>TextBox_ContextMenu#_TextBox_ContextMenu<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/TextBox_ContextMenu/CSharp/Window1.xaml.cs#_textbox_contextmenu)</ept><ept id=\"p1\">]</ept>","pos":[2549,2722],"source":"[!code-csharp[TextBox_ContextMenu#_TextBox_ContextMenu](../../../../samples/snippets/csharp/VS_Snippets_Wpf/TextBox_ContextMenu/CSharp/Window1.xaml.cs#_textbox_contextmenu)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>TextBox_ContextMenu#_TextBox_ContextMenu<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/TextBox_ContextMenu/VisualBasic/Window1.xaml.vb#_textbox_contextmenu)</ept><ept id=\"p1\">]</ept>","pos":[2724,2903],"source":"[!code-vb[TextBox_ContextMenu#_TextBox_ContextMenu](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/TextBox_ContextMenu/VisualBasic/Window1.xaml.vb#_textbox_contextmenu)]"},{"pos":[2912,2920],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Use Spell Checking with a Context Menu<ept id=\"p1\">](../../../../docs/framework/wpf/controls/how-to-use-spell-checking-with-a-context-menu.md)</ept><ph id=\"ph1\"> </ph>","pos":[2924,3055],"source":"[Use Spell Checking with a Context Menu](../../../../docs/framework/wpf/controls/how-to-use-spell-checking-with-a-context-menu.md) "},{"content":"<bpt id=\"p1\">[</bpt>TextBox Overview<ept id=\"p1\">](../../../../docs/framework/wpf/controls/textbox-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[3059,3139],"source":"[TextBox Overview](../../../../docs/framework/wpf/controls/textbox-overview.md) "},{"content":"<bpt id=\"p1\">[</bpt>RichTextBox Overview<ept id=\"p1\">](../../../../docs/framework/wpf/controls/richtextbox-overview.md)</ept>","pos":[3143,3230],"source":"[RichTextBox Overview](../../../../docs/framework/wpf/controls/richtextbox-overview.md)"}]}