{"content":"---\ntitle: \"How to: Create a Class Using CodeDOM | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"Code Document Object Model, graphs\"\n  - \"Code Document Object Model, creating classes\"\n  - \"graphing with CodeDOM\"\n  - \"CodeDOM, creating classes\"\n  - \"CodeDOM, graphs\"\nms.assetid: 0ceb70fe-36e1-49bb-922b-e9f615c20a14\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# How to: Create a Class Using CodeDOM\nThe following procedures illustrate how to create and compile a CodeDOM graph that generates a class containing two fields, three properties, a method, a constructor, and an entry point.  \n  \n1.  Create a console application that will use CodeDOM code to generate the source code for a class.  \n  \n     In this example, the generating class is named `Sample`, and the generated code is a class named `CodeDOMCreatedClass` in a file named SampleCode.  \n  \n2.  In the generating class, initialize the CodeDOM graph and use CodeDOM methods to define the members, constructor, and entry point (`Main` method) of the generated class.  \n  \n     In this example, the generated class has two fields, three properties, a constructor, a method, and a `Main` method.  \n  \n3.  In the generating class, create a language-specific code provider and call its <xref:System.CodeDom.Compiler.CodeDomProvider.GenerateCodeFromCompileUnit%2A> method to generate the code from the graph.  \n  \n4.  Compile and execute the application to generate the code.  \n  \n     In this example, the generated code is in a file named SampleCode. Compile and execute that code to see the sample output.  \n  \n### To create the application that will execute the CodeDOM code  \n  \n-   Create a console application class to contain the CodeDOM code. Define the global fields that are to be used in the class to reference the assembly (<xref:System.CodeDom.CodeCompileUnit>) and class (<xref:System.CodeDom.CodeTypeDeclaration>), specify the name of the generated source file, and declare the `Main` method.  \n  \n     [!code-csharp[CodeDOM Class Sample Main#1](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample Main/CS/program.cs#1)]\n     [!code-vb[CodeDOM Class Sample Main#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample Main/VB/program.vb#1)]  \n  \n### To initialize the CodeDOM graph  \n  \n-   In the constructor for the console application class, initialize the assembly and class, and add the appropriate declarations to the CodeDOM graph.  \n  \n     [!code-csharp[CodeDOM Class Sample#2](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#2)]\n     [!code-vb[CodeDOM Class Sample#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#2)]  \n  \n### To add members to the CodeDOM graph  \n  \n-   Add fields to the CodeDOM graph by adding <xref:System.CodeDom.CodeMemberField> objects to the <xref:System.CodeDom.CodeTypeDeclaration.Members%2A> property of the class.  \n  \n     [!code-csharp[CodeDOM Class Sample#3](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#3)]\n     [!code-vb[CodeDOM Class Sample#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#3)]  \n  \n-   Add properties to the CodeDOM graph by adding <xref:System.CodeDom.CodeMemberProperty> objects to the <xref:System.CodeDom.CodeTypeDeclaration.Members%2A> property of the class.  \n  \n     [!code-csharp[CodeDOM Class Sample#4](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#4)]\n     [!code-vb[CodeDOM Class Sample#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#4)]  \n  \n-   Add a method to the CodeDOM graph by adding a <xref:System.CodeDom.CodeMemberMethod> object to the <xref:System.CodeDom.CodeTypeDeclaration.Members%2A> property of the class.  \n  \n     [!code-csharp[CodeDOM Class Sample#5](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#5)]\n     [!code-vb[CodeDOM Class Sample#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#5)]  \n  \n-   Add a constructor to the CodeDOM graph by adding a <xref:System.CodeDom.CodeConstructor> object to the <xref:System.CodeDom.CodeTypeDeclaration.Members%2A> property of the class.  \n  \n     [!code-csharp[CodeDOM Class Sample#6](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#6)]\n     [!code-vb[CodeDOM Class Sample#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#6)]  \n  \n-   Add an entry point to the CodeDOM graph by adding a <xref:System.CodeDom.CodeEntryPointMethod> object to the <xref:System.CodeDom.CodeTypeDeclaration.Members%2A> property of the class.  \n  \n     [!code-csharp[CodeDOM Class Sample#7](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#7)]\n     [!code-vb[CodeDOM Class Sample#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#7)]  \n  \n### To generate the code from the CodeDOM graph  \n  \n-   Generate source code from the CodeDOM graph by calling the <xref:System.CodeDom.Compiler.CodeDomProvider.GenerateCodeFromCompileUnit%2A> method.  \n  \n     [!code-csharp[CodeDOM Class Sample#8](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#8)]\n     [!code-vb[CodeDOM Class Sample#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#8)]  \n  \n### To create the graph and generate the code  \n  \n1.  Add the methods created in the preceding steps to the `Main` method defined in the first step.  \n  \n     [!code-csharp[CodeDOM Class Sample#9](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#9)]\n     [!code-vb[CodeDOM Class Sample#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#9)]  \n  \n2.  Compile and execute the generating class.  \n  \n## Example  \n The following code example shows the code from the preceding steps.  \n  \n [!code-csharp[CodeDOM Class Sample#1](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#1)]\n [!code-vb[CodeDOM Class Sample#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#1)]  \n  \n When the preceding example is compiled and executed, it produces the following source code.  \n  \n [!code-csharp[CodeDOM Class Sample#99](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/SampleCode.cs#99)]\n [!code-vb[CodeDOM Class Sample#99](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/SampleCode.vb#99)]  \n  \n The generated source code produces the following output when compiled and executed.  \n  \n```  \nThe object:  \n width = 5.3,  \n height = 6.9,  \n area = 36.57  \n```  \n  \n## Compiling the Code  \n  \n-   This code example requires the `FullTrust` permission set to execute successfully.  \n  \n## See Also  \n [Using the CodeDOM](../../../docs/framework/reflection-and-codedom/using-the-codedom.md)   \n [Generating and Compiling Source Code from a CodeDOM Graph](../../../docs/framework/reflection-and-codedom/generating-and-compiling-source-code-from-a-codedom-graph.md)","nodes":[{"pos":[4,558],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create a Class Using CodeDOM | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"Code Document Object Model, graphs\"\n  - \"Code Document Object Model, creating classes\"\n  - \"graphing with CodeDOM\"\n  - \"CodeDOM, creating classes\"\n  - \"CodeDOM, graphs\"\nms.assetid: 0ceb70fe-36e1-49bb-922b-e9f615c20a14\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"How to: Create a Class Using CodeDOM | Microsoft Docs","nodes":[{"pos":[0,53],"content":"How to: Create a Class Using CodeDOM | Microsoft Docs","nodes":[{"content":"How to: Create a Class Using CodeDOM | Microsoft Docs","pos":[0,53]}]}],"path":["title"]}],"yml":true},{"pos":[565,601],"content":"How to: Create a Class Using CodeDOM","linkify":"How to: Create a Class Using CodeDOM","nodes":[{"content":"How to: Create a Class Using CodeDOM","pos":[0,36]}]},{"content":"The following procedures illustrate how to create and compile a CodeDOM graph that generates a class containing two fields, three properties, a method, a constructor, and an entry point.","pos":[602,788]},{"content":"Create a console application that will use CodeDOM code to generate the source code for a class.","pos":[798,894]},{"pos":[905,1051],"content":"In this example, the generating class is named <ph id=\"ph1\">`Sample`</ph>, and the generated code is a class named <ph id=\"ph2\">`CodeDOMCreatedClass`</ph> in a file named SampleCode.","source":"In this example, the generating class is named `Sample`, and the generated code is a class named `CodeDOMCreatedClass` in a file named SampleCode."},{"pos":[1061,1230],"content":"In the generating class, initialize the CodeDOM graph and use CodeDOM methods to define the members, constructor, and entry point (<ph id=\"ph1\">`Main`</ph> method) of the generated class.","source":"In the generating class, initialize the CodeDOM graph and use CodeDOM methods to define the members, constructor, and entry point (`Main` method) of the generated class."},{"pos":[1241,1357],"content":"In this example, the generated class has two fields, three properties, a constructor, a method, and a <ph id=\"ph1\">`Main`</ph> method.","source":"In this example, the generated class has two fields, three properties, a constructor, a method, and a `Main` method."},{"content":"In the generating class, create a language-specific code provider and call its <ph id=\"ph1\">&lt;xref:System.CodeDom.Compiler.CodeDomProvider.GenerateCodeFromCompileUnit%2A&gt;</ph> method to generate the code from the graph.","pos":[1367,1567],"source":"In the generating class, create a language-specific code provider and call its <xref:System.CodeDom.Compiler.CodeDomProvider.GenerateCodeFromCompileUnit%2A> method to generate the code from the graph."},{"content":"Compile and execute the application to generate the code.","pos":[1577,1634]},{"content":"In this example, the generated code is in a file named SampleCode.","pos":[1645,1711]},{"content":"Compile and execute that code to see the sample output.","pos":[1712,1767]},{"pos":[1777,1837],"content":"To create the application that will execute the CodeDOM code","linkify":"To create the application that will execute the CodeDOM code","nodes":[{"content":"To create the application that will execute the CodeDOM code","pos":[0,60]}]},{"content":"Create a console application class to contain the CodeDOM code.","pos":[1847,1910]},{"content":"Define the global fields that are to be used in the class to reference the assembly (<ph id=\"ph1\">&lt;xref:System.CodeDom.CodeCompileUnit&gt;</ph>) and class (<ph id=\"ph2\">&lt;xref:System.CodeDom.CodeTypeDeclaration&gt;</ph>), specify the name of the generated source file, and declare the <ph id=\"ph3\">`Main`</ph> method.","pos":[1911,2167],"source":" Define the global fields that are to be used in the class to reference the assembly (<xref:System.CodeDom.CodeCompileUnit>) and class (<xref:System.CodeDom.CodeTypeDeclaration>), specify the name of the generated source file, and declare the `Main` method."},{"pos":[2178,2455],"content":"[!code-csharp[CodeDOM Class Sample Main#1](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample Main/CS/program.cs#1)]\n [!code-vb[CodeDOM Class Sample Main#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample Main/VB/program.vb#1)]","leadings":["","    "],"nodes":[]},{"pos":[2465,2496],"content":"To initialize the CodeDOM graph","linkify":"To initialize the CodeDOM graph","nodes":[{"content":"To initialize the CodeDOM graph","pos":[0,31]}]},{"content":"In the constructor for the console application class, initialize the assembly and class, and add the appropriate declarations to the CodeDOM graph.","pos":[2506,2653]},{"pos":[2664,2921],"content":"[!code-csharp[CodeDOM Class Sample#2](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#2)]\n [!code-vb[CodeDOM Class Sample#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#2)]","leadings":["","    "],"nodes":[]},{"pos":[2931,2966],"content":"To add members to the CodeDOM graph","linkify":"To add members to the CodeDOM graph","nodes":[{"content":"To add members to the CodeDOM graph","pos":[0,35]}]},{"content":"Add fields to the CodeDOM graph by adding <ph id=\"ph1\">&lt;xref:System.CodeDom.CodeMemberField&gt;</ph> objects to the <ph id=\"ph2\">&lt;xref:System.CodeDom.CodeTypeDeclaration.Members%2A&gt;</ph> property of the class.","pos":[2976,3146],"source":"Add fields to the CodeDOM graph by adding <xref:System.CodeDom.CodeMemberField> objects to the <xref:System.CodeDom.CodeTypeDeclaration.Members%2A> property of the class."},{"pos":[3157,3414],"content":"[!code-csharp[CodeDOM Class Sample#3](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#3)]\n [!code-vb[CodeDOM Class Sample#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#3)]","leadings":["","    "],"nodes":[]},{"content":"Add properties to the CodeDOM graph by adding <ph id=\"ph1\">&lt;xref:System.CodeDom.CodeMemberProperty&gt;</ph> objects to the <ph id=\"ph2\">&lt;xref:System.CodeDom.CodeTypeDeclaration.Members%2A&gt;</ph> property of the class.","pos":[3424,3601],"source":"Add properties to the CodeDOM graph by adding <xref:System.CodeDom.CodeMemberProperty> objects to the <xref:System.CodeDom.CodeTypeDeclaration.Members%2A> property of the class."},{"pos":[3612,3869],"content":"[!code-csharp[CodeDOM Class Sample#4](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#4)]\n [!code-vb[CodeDOM Class Sample#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#4)]","leadings":["","    "],"nodes":[]},{"content":"Add a method to the CodeDOM graph by adding a <ph id=\"ph1\">&lt;xref:System.CodeDom.CodeMemberMethod&gt;</ph> object to the <ph id=\"ph2\">&lt;xref:System.CodeDom.CodeTypeDeclaration.Members%2A&gt;</ph> property of the class.","pos":[3879,4053],"source":"Add a method to the CodeDOM graph by adding a <xref:System.CodeDom.CodeMemberMethod> object to the <xref:System.CodeDom.CodeTypeDeclaration.Members%2A> property of the class."},{"pos":[4064,4321],"content":"[!code-csharp[CodeDOM Class Sample#5](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#5)]\n [!code-vb[CodeDOM Class Sample#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#5)]","leadings":["","    "],"nodes":[]},{"content":"Add a constructor to the CodeDOM graph by adding a <ph id=\"ph1\">&lt;xref:System.CodeDom.CodeConstructor&gt;</ph> object to the <ph id=\"ph2\">&lt;xref:System.CodeDom.CodeTypeDeclaration.Members%2A&gt;</ph> property of the class.","pos":[4331,4509],"source":"Add a constructor to the CodeDOM graph by adding a <xref:System.CodeDom.CodeConstructor> object to the <xref:System.CodeDom.CodeTypeDeclaration.Members%2A> property of the class."},{"pos":[4520,4777],"content":"[!code-csharp[CodeDOM Class Sample#6](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#6)]\n [!code-vb[CodeDOM Class Sample#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#6)]","leadings":["","    "],"nodes":[]},{"content":"Add an entry point to the CodeDOM graph by adding a <ph id=\"ph1\">&lt;xref:System.CodeDom.CodeEntryPointMethod&gt;</ph> object to the <ph id=\"ph2\">&lt;xref:System.CodeDom.CodeTypeDeclaration.Members%2A&gt;</ph> property of the class.","pos":[4787,4971],"source":"Add an entry point to the CodeDOM graph by adding a <xref:System.CodeDom.CodeEntryPointMethod> object to the <xref:System.CodeDom.CodeTypeDeclaration.Members%2A> property of the class."},{"pos":[4982,5239],"content":"[!code-csharp[CodeDOM Class Sample#7](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#7)]\n [!code-vb[CodeDOM Class Sample#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#7)]","leadings":["","    "],"nodes":[]},{"pos":[5249,5292],"content":"To generate the code from the CodeDOM graph","linkify":"To generate the code from the CodeDOM graph","nodes":[{"content":"To generate the code from the CodeDOM graph","pos":[0,43]}]},{"content":"Generate source code from the CodeDOM graph by calling the <ph id=\"ph1\">&lt;xref:System.CodeDom.Compiler.CodeDomProvider.GenerateCodeFromCompileUnit%2A&gt;</ph> method.","pos":[5302,5446],"source":"Generate source code from the CodeDOM graph by calling the <xref:System.CodeDom.Compiler.CodeDomProvider.GenerateCodeFromCompileUnit%2A> method."},{"pos":[5457,5714],"content":"[!code-csharp[CodeDOM Class Sample#8](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#8)]\n [!code-vb[CodeDOM Class Sample#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#8)]","leadings":["","    "],"nodes":[]},{"pos":[5724,5765],"content":"To create the graph and generate the code","linkify":"To create the graph and generate the code","nodes":[{"content":"To create the graph and generate the code","pos":[0,41]}]},{"pos":[5775,5869],"content":"Add the methods created in the preceding steps to the <ph id=\"ph1\">`Main`</ph> method defined in the first step.","source":"Add the methods created in the preceding steps to the `Main` method defined in the first step."},{"pos":[5880,6137],"content":"[!code-csharp[CodeDOM Class Sample#9](../../../samples/snippets/csharp/VS_Snippets_CLR/CodeDOM Class Sample/CS/program.cs#9)]\n [!code-vb[CodeDOM Class Sample#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/CodeDOM Class Sample/VB/program.vb#9)]","leadings":["","    "],"nodes":[]},{"content":"Compile and execute the generating class.","pos":[6147,6188]},{"pos":[6197,6204],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example shows the code from the preceding steps.","pos":[6208,6275]},{"content":"When the preceding example is compiled and executed, it produces the following source code.","pos":[6542,6633]},{"content":"The generated source code produces the following output when compiled and executed.","pos":[6910,6993]},{"pos":[7080,7098],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[7108,7190],"content":"This code example requires the <ph id=\"ph1\">`FullTrust`</ph> permission set to execute successfully.","source":"This code example requires the `FullTrust` permission set to execute successfully."},{"pos":[7199,7207],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Using the CodeDOM<ept id=\"p1\">](../../../docs/framework/reflection-and-codedom/using-the-codedom.md)</ept><ph id=\"ph1\"> </ph>","pos":[7211,7300],"source":"[Using the CodeDOM](../../../docs/framework/reflection-and-codedom/using-the-codedom.md) "},{"content":"<bpt id=\"p1\">[</bpt>Generating and Compiling Source Code from a CodeDOM Graph<ept id=\"p1\">](../../../docs/framework/reflection-and-codedom/generating-and-compiling-source-code-from-a-codedom-graph.md)</ept>","pos":[7304,7472],"source":"[Generating and Compiling Source Code from a CodeDOM Graph](../../../docs/framework/reflection-and-codedom/generating-and-compiling-source-code-from-a-codedom-graph.md)"}]}