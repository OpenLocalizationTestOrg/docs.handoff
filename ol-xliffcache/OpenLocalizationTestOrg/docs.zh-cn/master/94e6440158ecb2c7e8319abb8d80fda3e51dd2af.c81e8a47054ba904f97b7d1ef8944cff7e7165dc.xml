{"content":"---\ntitle: \"XML Schema Constraints and Relationships | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 165bc2bc-60a1-40e0-9b89-7c68ef979079\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# XML Schema Constraints and Relationships\nIn an XML Schema definition language (XSD) schema, you can specify constraints (unique, key, and keyref constraints) and relationships (using the **msdata:Relationship** annotation). This topic explains how the constraints and relationships specified in an XML Schema are interpreted to generate the <xref:System.Data.DataSet>.  \n  \n In general, in an XML Schema, you specify the **msdata:Relationship** annotation if you want to generate only relationships in the **DataSet**. For more information, see [Generating DataSet Relations from XML Schema (XSD)](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/generating-dataset-relations-from-xml-schema-xsd.md). You specify constraints (unique, key, and keyref) if you want to generate constraints in the **DataSet**. Note that the key and keyref constraints are also used to generate relationships, as explained later in this topic.  \n  \n## Generating a Relationship from key and keyref Constraints  \n Instead of specifying the **msdata:Relationship** annotation, you can specify key and keyref constraints, which are used during the XML Schema mapping process to generate not only the constraints but also the relationship in the **DataSet**. However, if you specify `msdata:ConstraintOnly=\"true\"` in the **keyref** element, the **DataSet** will include only the constraints and will not include the relationship.  \n  \n The following example shows an XML Schema that includes **Order** and **OrderDetail** elements, which are not nested. The schema also specifies key and keyref constraints.  \n  \n```  \n<xs:schema id=\"MyDataSet\" xmlns=\"\"   \n            xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"   \n            xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\">  \n  \n <xs:element name=\"MyDataSet\" msdata:IsDataSet=\"true\">  \n  <xs:complexType>  \n    <xs:choice maxOccurs=\"unbounded\">  \n      <xs:element name=\"OrderDetail\">  \n       <xs:complexType>  \n         <xs:sequence>  \n           <xs:element name=\"OrderNo\" type=\"xs:integer\" />  \n           <xs:element name=\"ItemNo\" type=\"xs:string\" />  \n         </xs:sequence>  \n       </xs:complexType>  \n      </xs:element>  \n      <xs:element name=\"Order\">  \n        <xs:complexType>  \n          <xs:sequence>  \n            <xs:element name=\"OrderNumber\" type=\"xs:integer\" />  \n            <xs:element name=\"EmpNumber\" type=\"xs:integer\" />  \n          </xs:sequence>  \n        </xs:complexType>  \n      </xs:element>  \n    </xs:choice>  \n  </xs:complexType>  \n  \n  <xs:key name=\"OrderNumberKey\"  >  \n    <xs:selector xpath=\".//Order\" />  \n    <xs:field xpath=\"OrderNumber\" />  \n  </xs:key>  \n  \n  <xs:keyref name=\"OrderNoRef\" refer=\"OrderNumberKey\">  \n    <xs:selector xpath=\".//OrderDetail\" />  \n    <xs:field xpath=\"OrderNo\" />  \n  </xs:keyref>  \n </xs:element>  \n</xs:schema>  \n```  \n  \n The **DataSet** that is generated during the XML Schema mapping process includes the **Order** and **OrderDetail** tables. In addition, the **DataSet** includes relationships and constraints. The following example shows these relationships and constraints. Note that the schema does not specify the **msdata:Relationship** annotation; instead, the key and keyref constraints are used to generate the relation.  \n  \n```  \n....ConstraintName: OrderNumberKey  \n....Type: UniqueConstraint  \n....Table: Order  \n....Columns: OrderNumber  \n....IsPrimaryKey: False  \n  \n....ConstraintName: OrderNoRef  \n....Type: ForeignKeyConstraint  \n....Table: OrderDetail  \n....Columns: OrderNo  \n....RelatedTable: Order  \n....RelatedColumns: OrderNumber  \n  \n..RelationName: OrderNoRef  \n..ParentTable: Order  \n..ParentColumns: OrderNumber  \n..ChildTable: OrderDetail  \n..ChildColumns: OrderNo  \n..ParentKeyConstraint: OrderNumberKey  \n..ChildKeyConstraint: OrderNoRef  \n..Nested: False  \n```  \n  \n In the previous schema example, the **Order** and **OrderDetail** elements are not nested. In the following schema example, these elements are nested. However, no **msdata:Relationship** annotation is specified; therefore, an implicit relation is assumed. For more information, see [Map Implicit Relations Between Nested Schema Elements](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/map-implicit-relations-between-nested-schema-elements.md). The schema also specifies key and keyref constraints.  \n  \n```  \n<xs:schema id=\"MyDataSet\" xmlns=\"\"   \n            xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"   \n            xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\">  \n  \n <xs:element name=\"MyDataSet\" msdata:IsDataSet=\"true\">  \n  <xs:complexType>  \n    <xs:choice maxOccurs=\"unbounded\">  \n  \n      <xs:element name=\"Order\">  \n        <xs:complexType>  \n          <xs:sequence>  \n            <xs:element name=\"OrderNumber\" type=\"xs:integer\" />  \n            <xs:element name=\"EmpNumber\" type=\"xs:integer\" />  \n  \n            <xs:element name=\"OrderDetail\">  \n              <xs:complexType>  \n                <xs:sequence>  \n                  <xs:element name=\"OrderNo\" type=\"xs:integer\" />  \n                  <xs:element name=\"ItemNo\" type=\"xs:string\" />  \n                </xs:sequence>  \n              </xs:complexType>  \n            </xs:element>  \n          </xs:sequence>  \n        </xs:complexType>  \n      </xs:element>  \n    </xs:choice>  \n  </xs:complexType>  \n  \n  <xs:key name=\"OrderNumberKey\"  >  \n    <xs:selector xpath=\".//Order\" />  \n    <xs:field xpath=\"OrderNumber\" />  \n  </xs:key>  \n  \n  <xs:keyref name=\"OrderNoRef\" refer=\"OrderNumberKey\">  \n    <xs:selector xpath=\".//OrderDetail\" />  \n    <xs:field xpath=\"OrderNo\" />  \n  </xs:keyref>  \n </xs:element>  \n</xs:schema>  \n```  \n  \n The **DataSet** resulting from the XML Schema mapping process includes two tables:  \n  \n```  \nOrder(OrderNumber, EmpNumber, Order_Id)  \nOrderDetail(OrderNumber, ItemNumber, Order_Id)  \n```  \n  \n The **DataSet** also includes the two relationships (one based on the **msdata:relationship** annotation and the other based on the key and keyref constraints) and various constraints. The following example shows the relations and constraints.  \n  \n```  \n..RelationName: Order_OrderDetail  \n..ParentTable: Order  \n..ParentColumns: Order_Id  \n..ChildTable: OrderDetail  \n..ChildColumns: Order_Id  \n..ParentKeyConstraint: Constraint1  \n..ChildKeyConstraint: Order_OrderDetail  \n..Nested: True  \n  \n..RelationName: OrderNoRef  \n..ParentTable: Order  \n..ParentColumns: OrderNumber  \n..ChildTable: OrderDetail  \n..ChildColumns: OrderNo  \n..ParentKeyConstraint: OrderNumberKey  \n..ChildKeyConstraint: OrderNoRef  \n..Nested: False  \n  \n..ConstraintName: OrderNumberKey  \n..Type: UniqueConstraint  \n..Table: Order  \n..Columns: OrderNumber  \n..IsPrimaryKey: False  \n  \n..ConstraintName: Constraint1  \n..Type: UniqueConstraint  \n..Table: Order  \n..Columns: Order_Id  \n..IsPrimaryKey: True  \n  \n..ConstraintName: Order_OrderDetail  \n..Type: ForeignKeyConstraint  \n..Table: OrderDetail  \n..Columns: Order_Id  \n..RelatedTable: Order  \n..RelatedColumns: Order_Id  \n  \n..ConstraintName: OrderNoRef  \n..Type: ForeignKeyConstraint  \n..Table: OrderDetail  \n..Columns: OrderNo  \n..RelatedTable: Order  \n..RelatedColumns: OrderNumber  \n```  \n  \n If a keyref constraint referring to a nested table contains the **msdata:IsNested=\"true\"** annotation, the **DataSet** will create a single nested relationship that is based on the keyref constraint and the related unique/key constraint.  \n  \n## See Also  \n [Deriving DataSet Relational Structure from XML Schema (XSD)](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/deriving-dataset-relational-structure-from-xml-schema-xsd.md)   \n [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)","nodes":[{"pos":[4,371],"nodes":[{"content":"XML Schema Constraints and Relationships | Microsoft Docs","nodes":[{"pos":[0,57],"content":"XML Schema Constraints and Relationships | Microsoft Docs","nodes":[{"content":"XML Schema Constraints and Relationships | Microsoft Docs","pos":[0,57]}]}],"pos":[6,66],"yaml":true}],"content":"title: \"XML Schema Constraints and Relationships | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 165bc2bc-60a1-40e0-9b89-7c68ef979079\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","yamlblock":true},{"pos":[378,418],"content":"XML Schema Constraints and Relationships","linkify":"XML Schema Constraints and Relationships","nodes":[{"content":"XML Schema Constraints and Relationships","pos":[0,40]}]},{"content":"In an XML Schema definition language (XSD) schema, you can specify constraints (unique, key, and keyref constraints) and relationships (using the <bpt id=\"p1\">**</bpt>msdata:Relationship<ept id=\"p1\">**</ept> annotation).","pos":[419,601],"source":"In an XML Schema definition language (XSD) schema, you can specify constraints (unique, key, and keyref constraints) and relationships (using the **msdata:Relationship** annotation)."},{"content":"This topic explains how the constraints and relationships specified in an XML Schema are interpreted to generate the <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph>.","pos":[602,746],"source":" This topic explains how the constraints and relationships specified in an XML Schema are interpreted to generate the <xref:System.Data.DataSet>."},{"content":"In general, in an XML Schema, you specify the <bpt id=\"p1\">**</bpt>msdata:Relationship<ept id=\"p1\">**</ept> annotation if you want to generate only relationships in the <bpt id=\"p2\">**</bpt>DataSet<ept id=\"p2\">**</ept>.","pos":[753,896],"source":"In general, in an XML Schema, you specify the **msdata:Relationship** annotation if you want to generate only relationships in the **DataSet**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Generating DataSet Relations from XML Schema (XSD)<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/generating-dataset-relations-from-xml-schema-xsd.md)</ept>.","pos":[897,1098],"source":" For more information, see [Generating DataSet Relations from XML Schema (XSD)](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/generating-dataset-relations-from-xml-schema-xsd.md)."},{"content":"You specify constraints (unique, key, and keyref) if you want to generate constraints in the <bpt id=\"p1\">**</bpt>DataSet<ept id=\"p1\">**</ept>.","pos":[1099,1204],"source":" You specify constraints (unique, key, and keyref) if you want to generate constraints in the **DataSet**."},{"content":"Note that the key and keyref constraints are also used to generate relationships, as explained later in this topic.","pos":[1205,1320]},{"pos":[1329,1386],"content":"Generating a Relationship from key and keyref Constraints","linkify":"Generating a Relationship from key and keyref Constraints","nodes":[{"content":"Generating a Relationship from key and keyref Constraints","pos":[0,57]}]},{"content":"Instead of specifying the <bpt id=\"p1\">**</bpt>msdata:Relationship<ept id=\"p1\">**</ept> annotation, you can specify key and keyref constraints, which are used during the XML Schema mapping process to generate not only the constraints but also the relationship in the <bpt id=\"p2\">**</bpt>DataSet<ept id=\"p2\">**</ept>.","pos":[1390,1631],"source":"Instead of specifying the **msdata:Relationship** annotation, you can specify key and keyref constraints, which are used during the XML Schema mapping process to generate not only the constraints but also the relationship in the **DataSet**."},{"content":"However, if you specify <ph id=\"ph1\">`msdata:ConstraintOnly=\"true\"`</ph> in the <bpt id=\"p1\">**</bpt>keyref<ept id=\"p1\">**</ept> element, the <bpt id=\"p2\">**</bpt>DataSet<ept id=\"p2\">**</ept> will include only the constraints and will not include the relationship.","pos":[1632,1802],"source":" However, if you specify `msdata:ConstraintOnly=\"true\"` in the **keyref** element, the **DataSet** will include only the constraints and will not include the relationship."},{"content":"The following example shows an XML Schema that includes <bpt id=\"p1\">**</bpt>Order<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>OrderDetail<ept id=\"p2\">**</ept> elements, which are not nested.","pos":[1809,1926],"source":"The following example shows an XML Schema that includes **Order** and **OrderDetail** elements, which are not nested."},{"content":"The schema also specifies key and keyref constraints.","pos":[1927,1980]},{"content":"The <bpt id=\"p1\">**</bpt>DataSet<ept id=\"p1\">**</ept> that is generated during the XML Schema mapping process includes the <bpt id=\"p2\">**</bpt>Order<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>OrderDetail<ept id=\"p3\">**</ept> tables.","pos":[3229,3351],"source":"The **DataSet** that is generated during the XML Schema mapping process includes the **Order** and **OrderDetail** tables."},{"content":"In addition, the <bpt id=\"p1\">**</bpt>DataSet<ept id=\"p1\">**</ept> includes relationships and constraints.","pos":[3352,3420],"source":" In addition, the **DataSet** includes relationships and constraints."},{"content":"The following example shows these relationships and constraints.","pos":[3421,3485]},{"content":"Note that the schema does not specify the <bpt id=\"p1\">**</bpt>msdata:Relationship<ept id=\"p1\">**</ept> annotation; instead, the key and keyref constraints are used to generate the relation.","pos":[3486,3638],"source":" Note that the schema does not specify the **msdata:Relationship** annotation; instead, the key and keyref constraints are used to generate the relation."},{"content":"In the previous schema example, the <bpt id=\"p1\">**</bpt>Order<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>OrderDetail<ept id=\"p2\">**</ept> elements are not nested.","pos":[4208,4298],"source":"In the previous schema example, the **Order** and **OrderDetail** elements are not nested."},{"content":"In the following schema example, these elements are nested.","pos":[4299,4358]},{"content":"However, no <bpt id=\"p1\">**</bpt>msdata:Relationship<ept id=\"p1\">**</ept> annotation is specified; therefore, an implicit relation is assumed.","pos":[4359,4463],"source":" However, no **msdata:Relationship** annotation is specified; therefore, an implicit relation is assumed."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Map Implicit Relations Between Nested Schema Elements<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/map-implicit-relations-between-nested-schema-elements.md)</ept>.","pos":[4464,4673],"source":" For more information, see [Map Implicit Relations Between Nested Schema Elements](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/map-implicit-relations-between-nested-schema-elements.md)."},{"content":"The schema also specifies key and keyref constraints.","pos":[4674,4727]},{"pos":[6036,6118],"content":"The <bpt id=\"p1\">**</bpt>DataSet<ept id=\"p1\">**</ept> resulting from the XML Schema mapping process includes two tables:","source":"The **DataSet** resulting from the XML Schema mapping process includes two tables:"},{"content":"The <bpt id=\"p1\">**</bpt>DataSet<ept id=\"p1\">**</ept> also includes the two relationships (one based on the <bpt id=\"p2\">**</bpt>msdata:relationship<ept id=\"p2\">**</ept> annotation and the other based on the key and keyref constraints) and various constraints.","pos":[6231,6415],"source":"The **DataSet** also includes the two relationships (one based on the **msdata:relationship** annotation and the other based on the key and keyref constraints) and various constraints."},{"content":"The following example shows the relations and constraints.","pos":[6416,6474]},{"pos":[7557,7794],"content":"If a keyref constraint referring to a nested table contains the <bpt id=\"p1\">**</bpt>msdata:IsNested=\"true\"<ept id=\"p1\">**</ept> annotation, the <bpt id=\"p2\">**</bpt>DataSet<ept id=\"p2\">**</ept> will create a single nested relationship that is based on the keyref constraint and the related unique/key constraint.","source":"If a keyref constraint referring to a nested table contains the **msdata:IsNested=\"true\"** annotation, the **DataSet** will create a single nested relationship that is based on the keyref constraint and the related unique/key constraint."},{"pos":[7803,7811],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Deriving DataSet Relational Structure from XML Schema (XSD)<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/deriving-dataset-relational-structure-from-xml-schema-xsd.md)</ept><ph id=\"ph1\"> </ph>","pos":[7815,8008],"source":"[Deriving DataSet Relational Structure from XML Schema (XSD)](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/deriving-dataset-relational-structure-from-xml-schema-xsd.md) "},{"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=217917)</ept>","pos":[8012,8115],"source":"[ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)"}]}