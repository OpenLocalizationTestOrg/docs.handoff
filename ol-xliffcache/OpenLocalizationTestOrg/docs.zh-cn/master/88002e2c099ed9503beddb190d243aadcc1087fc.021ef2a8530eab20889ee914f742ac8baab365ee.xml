{"content":"---\ntitle: \"Array Conversions (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"arrays [Visual Basic], converting type\"\n  - \"type conversion [Visual Basic], arrays\"\n  - \"conversions [Visual Basic], type\"\n  - \"arrays [Visual Basic], data types\"\n  - \"conversions [Visual Basic], data type\"\n  - \"object arrays [Visual Basic], converting type\"\n  - \"data type conversion [Visual Basic], array conversions\"\n  - \"conversions [Visual Basic], array types\"\n  - \"object arrays\"\nms.assetid: fceff7d2-a1b7-44c7-b9aa-8bd831d8a444\n---\n# Array Conversions (Visual Basic)\nYou can convert an array type to a different array type provided you meet the following conditions:  \n  \n-   **Equal Rank.** The ranks of the two arrays must be the same, that is, they must have the same number of dimensions. However, the lengths of the respective dimensions do not need to be the same.  \n  \n-   **Element Data Type.** The data types of the elements of both arrays must be reference types. You cannot convert an `Integer` array to a `Long` array, or even to an `Object` array, because at least one value type is involved. For more information, see [Value Types and Reference Types](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md).  \n  \n-   **Convertibility.** A conversion, either widening or narrowing, must be possible between the element types of the two arrays. An example that fails this requirement is an attempted conversion between a `String` array and an array of a class derived from <xref:System.Attribute?displayProperty=nameWithType>. These two types have nothing in common, and no conversion of any kind exists between them.  \n  \n A conversion of one array type to another is widening or narrowing depending on whether the conversion of the respective elements is widening or narrowing. For more information, see [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md).  \n  \n## Conversion to an Object Array  \n When you declare an `Object` array without initializing it, its element type is `Object` as long as it remains uninitialized. When you set it to an array of a specific class, it takes on the type of that class. However, its underlying type is still `Object`, and you can subsequently set it to another array of an unrelated class. Since all classes derive from `Object`, you can change the array's element type from any class to any other class.  \n  \n In the following example, no conversion exists between types `student` and `String`, but both derive from `Object`, so all assignments are valid.  \n  \n```  \n' Assume student has already been defined as a class.  \nDim testArray() As Object  \n' testArray is still an Object array at this point.  \nDim names() As String = New String(3) {\"Name0\", \"Name1\", \"Name2\", \"Name3\"}  \ntestArray = New student(3) {}  \n' testArray is now of type student().  \ntestArray = names  \n' testArray is now a String array.  \n```  \n  \n### Underlying Type of an Array  \n If you originally declare an array with a specific class, its underlying element type is that class. If you subsequently set it to an array of another class, there must be a conversion between the two classes.  \n  \n In the following example, `students` is a `student` array. Since no conversion exists between `String` and `student`, the last statement fails.  \n  \n```  \nDim students() As student  \nDim names() As String = New String(3) {\"Name0\", \"Name1\", \"Name2\", \"Name3\"}  \nstudents = New Student(3) {}  \n' The following statement fails at compile time.  \nstudents = names  \n```  \n  \n## See also\n\n- [Data Types](../../../../visual-basic/programming-guide/language-features/data-types/index.md)\n- [Type Conversions in Visual Basic](../../../../visual-basic/programming-guide/language-features/data-types/type-conversions.md)\n- [Implicit and Explicit Conversions](../../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)\n- [Conversions Between Strings and Other Types](../../../../visual-basic/programming-guide/language-features/data-types/conversions-between-strings-and-other-types.md)\n- [How to: Convert an Object to Another Type in Visual Basic](../../../../visual-basic/programming-guide/language-features/data-types/how-to-convert-an-object-to-another-type.md)\n- [Data Types](../../../../visual-basic/language-reference/data-types/index.md)\n- [Type Conversion Functions](../../../../visual-basic/language-reference/functions/type-conversion-functions.md)\n- [Arrays](../../../../visual-basic/programming-guide/language-features/arrays/index.md)\n","nodes":[{"pos":[4,528],"embed":true,"restype":"x-metadata","content":"title: \"Array Conversions (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"arrays [Visual Basic], converting type\"\n  - \"type conversion [Visual Basic], arrays\"\n  - \"conversions [Visual Basic], type\"\n  - \"arrays [Visual Basic], data types\"\n  - \"conversions [Visual Basic], data type\"\n  - \"object arrays [Visual Basic], converting type\"\n  - \"data type conversion [Visual Basic], array conversions\"\n  - \"conversions [Visual Basic], array types\"\n  - \"object arrays\"\nms.assetid: fceff7d2-a1b7-44c7-b9aa-8bd831d8a444","nodes":[{"content":"Array Conversions (Visual Basic)","nodes":[{"pos":[0,32],"content":"Array Conversions (Visual Basic)","nodes":[{"content":"Array Conversions (Visual Basic)","pos":[0,32]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[535,567],"content":"Array Conversions (Visual Basic)","linkify":"Array Conversions (Visual Basic)","nodes":[{"content":"Array Conversions (Visual Basic)","pos":[0,32]}]},{"content":"You can convert an array type to a different array type provided you meet the following conditions:","pos":[568,667]},{"content":"<bpt id=\"p1\">**</bpt>Equal Rank.<ept id=\"p1\">**</ept>","pos":[677,692],"source":"**Equal Rank.**"},{"content":"The ranks of the two arrays must be the same, that is, they must have the same number of dimensions.","pos":[693,793]},{"content":"However, the lengths of the respective dimensions do not need to be the same.","pos":[794,871]},{"content":"<bpt id=\"p1\">**</bpt>Element Data Type.<ept id=\"p1\">**</ept>","pos":[881,903],"source":"**Element Data Type.**"},{"content":"The data types of the elements of both arrays must be reference types.","pos":[904,974]},{"content":"You cannot convert an <ph id=\"ph1\">`Integer`</ph> array to a <ph id=\"ph2\">`Long`</ph> array, or even to an <ph id=\"ph3\">`Object`</ph> array, because at least one value type is involved.","pos":[975,1106],"source":" You cannot convert an `Integer` array to a `Long` array, or even to an `Object` array, because at least one value type is involved."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Value Types and Reference Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)</ept>.","pos":[1107,1275],"source":" For more information, see [Value Types and Reference Types](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)."},{"content":"<bpt id=\"p1\">**</bpt>Convertibility.<ept id=\"p1\">**</ept>","pos":[1285,1304],"source":"**Convertibility.**"},{"content":"A conversion, either widening or narrowing, must be possible between the element types of the two arrays.","pos":[1305,1410]},{"content":"An example that fails this requirement is an attempted conversion between a <ph id=\"ph1\">`String`</ph> array and an array of a class derived from <ph id=\"ph2\">&lt;xref:System.Attribute?displayProperty=nameWithType&gt;</ph>.","pos":[1411,1592],"source":" An example that fails this requirement is an attempted conversion between a `String` array and an array of a class derived from <xref:System.Attribute?displayProperty=nameWithType>."},{"content":"These two types have nothing in common, and no conversion of any kind exists between them.","pos":[1593,1683]},{"content":"A conversion of one array type to another is widening or narrowing depending on whether the conversion of the respective elements is widening or narrowing.","pos":[1690,1845]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Widening and Narrowing Conversions<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)</ept>.","pos":[1846,2020],"source":" For more information, see [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)."},{"pos":[2029,2058],"content":"Conversion to an Object Array","linkify":"Conversion to an Object Array","nodes":[{"content":"Conversion to an Object Array","pos":[0,29]}]},{"content":"When you declare an <ph id=\"ph1\">`Object`</ph> array without initializing it, its element type is <ph id=\"ph2\">`Object`</ph> as long as it remains uninitialized.","pos":[2062,2187],"source":"When you declare an `Object` array without initializing it, its element type is `Object` as long as it remains uninitialized."},{"content":"When you set it to an array of a specific class, it takes on the type of that class.","pos":[2188,2272]},{"content":"However, its underlying type is still <ph id=\"ph1\">`Object`</ph>, and you can subsequently set it to another array of an unrelated class.","pos":[2273,2392],"source":" However, its underlying type is still `Object`, and you can subsequently set it to another array of an unrelated class."},{"content":"Since all classes derive from <ph id=\"ph1\">`Object`</ph>, you can change the array's element type from any class to any other class.","pos":[2393,2507],"source":" Since all classes derive from `Object`, you can change the array's element type from any class to any other class."},{"pos":[2514,2659],"content":"In the following example, no conversion exists between types <ph id=\"ph1\">`student`</ph> and <ph id=\"ph2\">`String`</ph>, but both derive from <ph id=\"ph3\">`Object`</ph>, so all assignments are valid.","source":"In the following example, no conversion exists between types `student` and `String`, but both derive from `Object`, so all assignments are valid."},{"pos":[3028,3055],"content":"Underlying Type of an Array","linkify":"Underlying Type of an Array","nodes":[{"content":"Underlying Type of an Array","pos":[0,27]}]},{"content":"If you originally declare an array with a specific class, its underlying element type is that class.","pos":[3059,3159]},{"content":"If you subsequently set it to an array of another class, there must be a conversion between the two classes.","pos":[3160,3268]},{"content":"In the following example, <ph id=\"ph1\">`students`</ph> is a <ph id=\"ph2\">`student`</ph> array.","pos":[3275,3333],"source":"In the following example, `students` is a `student` array."},{"content":"Since no conversion exists between <ph id=\"ph1\">`String`</ph> and <ph id=\"ph2\">`student`</ph>, the last statement fails.","pos":[3334,3418],"source":" Since no conversion exists between `String` and `student`, the last statement fails."},{"pos":[3648,3656],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3660,3754],"content":"<bpt id=\"p1\">[</bpt>Data Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/index.md)</ept>","source":"[Data Types](../../../../visual-basic/programming-guide/language-features/data-types/index.md)"},{"pos":[3757,3884],"content":"<bpt id=\"p1\">[</bpt>Type Conversions in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/type-conversions.md)</ept>","source":"[Type Conversions in Visual Basic](../../../../visual-basic/programming-guide/language-features/data-types/type-conversions.md)"},{"pos":[3887,4032],"content":"<bpt id=\"p1\">[</bpt>Implicit and Explicit Conversions<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)</ept>","source":"[Implicit and Explicit Conversions](../../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)"},{"pos":[4035,4200],"content":"<bpt id=\"p1\">[</bpt>Conversions Between Strings and Other Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/conversions-between-strings-and-other-types.md)</ept>","source":"[Conversions Between Strings and Other Types](../../../../visual-basic/programming-guide/language-features/data-types/conversions-between-strings-and-other-types.md)"},{"pos":[4203,4379],"content":"<bpt id=\"p1\">[</bpt>How to: Convert an Object to Another Type in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/how-to-convert-an-object-to-another-type.md)</ept>","source":"[How to: Convert an Object to Another Type in Visual Basic](../../../../visual-basic/programming-guide/language-features/data-types/how-to-convert-an-object-to-another-type.md)"},{"pos":[4382,4459],"content":"<bpt id=\"p1\">[</bpt>Data Types<ept id=\"p1\">](../../../../visual-basic/language-reference/data-types/index.md)</ept>","source":"[Data Types](../../../../visual-basic/language-reference/data-types/index.md)"},{"pos":[4462,4573],"content":"<bpt id=\"p1\">[</bpt>Type Conversion Functions<ept id=\"p1\">](../../../../visual-basic/language-reference/functions/type-conversion-functions.md)</ept>","source":"[Type Conversion Functions](../../../../visual-basic/language-reference/functions/type-conversion-functions.md)"},{"pos":[4576,4662],"content":"<bpt id=\"p1\">[</bpt>Arrays<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/index.md)</ept>","source":"[Arrays](../../../../visual-basic/programming-guide/language-features/arrays/index.md)"}]}