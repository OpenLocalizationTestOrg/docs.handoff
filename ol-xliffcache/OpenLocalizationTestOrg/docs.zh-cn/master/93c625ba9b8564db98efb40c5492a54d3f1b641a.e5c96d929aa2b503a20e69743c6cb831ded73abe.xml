{"content":"---\ntitle: \"How to: Get the Offset of a Visual | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"getting offset values from visual objects\"\n  - \"offset values, retrieving from visual objects\"\n  - \"visual objects, retrieving offset values from\"\n  - \"retrieving offset values from visual objects\"\nms.assetid: 889a1dd6-1b11-445a-b351-fbb04c53ee34\ncaps.latest.revision: 6\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Get the Offset of a Visual\nThese examples show how to retrieve the offset value of a visual object that is relative to its parent, or any ancestor or descendant.  \n  \n## Example  \n The following markup example shows a <xref:System.Windows.Controls.TextBlock> that is defined with <xref:System.Windows.FrameworkElement.Margin%2A> value of 4.  \n  \n [!code-xml[VisualSnippets#VisualSnippet1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml#visualsnippet1)]  \n  \n The following code example shows how to use the <xref:System.Windows.Media.VisualTreeHelper.GetOffset%2A> method to retrieve the offset of the <xref:System.Windows.Controls.TextBlock>. The offset values are contained within the returned <xref:System.Windows.Vector> value.  \n  \n [!code-csharp[VisualSnippets#VisualSnippet2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml.cs#visualsnippet2)]\n [!code-vb[VisualSnippets#VisualSnippet2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/VisualSnippets/visualbasic/window1.xaml.vb#visualsnippet2)]  \n  \n The offset takes into account the <xref:System.Windows.FrameworkElement.Margin%2A> value. In this case, <xref:System.Windows.Vector.X%2A> is 4, and <xref:System.Windows.Vector.Y%2A> is 4.  \n  \n The returned offset value is relative to the parent of the <xref:System.Windows.Media.Visual>. If you want to return an offset value that is not relative to the parent of a <xref:System.Windows.Media.Visual>, use the <xref:System.Windows.Media.Visual.TransformToAncestor%2A> method.  \n  \n## Getting the Offset Relative to an Ancestor  \n The following markup example shows a <xref:System.Windows.Controls.TextBlock> that is nested within two <xref:System.Windows.Controls.StackPanel> objects.  \n  \n [!code-xml[VisualSnippets#VisualSnippet7](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window2.xaml#visualsnippet7)]  \n  \n The following illustration shows the results of the markup.  \n  \n ![Offset values of objects](../../../../docs/framework/wpf/graphics-multimedia/media/visualoffset-01.png \"VisualOffset_01\")  \nTextBlock nested within two StackPanels  \n  \n The following code example shows how to use the <xref:System.Windows.Media.Visual.TransformToAncestor%2A> method to retrieve the offset of the <xref:System.Windows.Controls.TextBlock> relative to the containing <xref:System.Windows.Window>. The offset values are contained within the returned <xref:System.Windows.Media.GeneralTransform> value.  \n  \n [!code-csharp[VisualSnippets#VisualSnippet5](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml.cs#visualsnippet5)]\n [!code-vb[VisualSnippets#VisualSnippet5](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/VisualSnippets/visualbasic/window1.xaml.vb#visualsnippet5)]  \n  \n The offset takes into account the <xref:System.Windows.FrameworkElement.Margin%2A> values for all objects within the containing <xref:System.Windows.Window>. In this case, <xref:System.Windows.Vector.X%2A> is 28 (16 + 8 + 4), and <xref:System.Windows.Vector.Y%2A> is 28.  \n  \n The returned offset value is relative to the ancestor of the <xref:System.Windows.Media.Visual>. If you want to return an offset value that is relative to the descendant of a <xref:System.Windows.Media.Visual>, use the <xref:System.Windows.Media.Visual.TransformToDescendant%2A> method.  \n  \n## Getting the Offset Relative to a Descendant  \n The following markup example shows a <xref:System.Windows.Controls.TextBlock> that is contained within a <xref:System.Windows.Controls.StackPanel> object.  \n  \n [!code-xml[VisualSnippets#VisualSnippet4](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml#visualsnippet4)]  \n  \n The following code example shows how to use the <xref:System.Windows.Media.Visual.TransformToDescendant%2A> method to retrieve the offset of the <xref:System.Windows.Controls.StackPanel> relative to its child <xref:System.Windows.Controls.TextBlock>. The offset values are contained within the returned <xref:System.Windows.Media.GeneralTransform> value.  \n  \n [!code-csharp[VisualSnippets#VisualSnippet9](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml.cs#visualsnippet9)]\n [!code-vb[VisualSnippets#VisualSnippet9](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/VisualSnippets/visualbasic/window1.xaml.vb#visualsnippet9)]  \n  \n The offset takes into account the <xref:System.Windows.FrameworkElement.Margin%2A> values for all objects. In this case, <xref:System.Windows.Vector.X%2A> is -4, and <xref:System.Windows.Vector.Y%2A> is -4. The offset values are negative values, since the parent object is negatively offset relative to its child object.  \n  \n## See Also  \n <xref:System.Windows.Media.Visual>   \n <xref:System.Windows.Media.VisualTreeHelper>   \n [WPF Graphics Rendering Overview](../../../../docs/framework/wpf/graphics-multimedia/wpf-graphics-rendering-overview.md)","nodes":[{"pos":[4,588],"embed":true,"restype":"x-metadata","content":"title: \"How to: Get the Offset of a Visual | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"getting offset values from visual objects\"\n  - \"offset values, retrieving from visual objects\"\n  - \"visual objects, retrieving offset values from\"\n  - \"retrieving offset values from visual objects\"\nms.assetid: 889a1dd6-1b11-445a-b351-fbb04c53ee34\ncaps.latest.revision: 6\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"How to: Get the Offset of a Visual | Microsoft Docs","nodes":[{"pos":[0,51],"content":"How to: Get the Offset of a Visual | Microsoft Docs","nodes":[{"content":"How to: Get the Offset of a Visual | Microsoft Docs","pos":[0,51]}]}],"path":["title"]}],"yml":true},{"pos":[595,629],"content":"How to: Get the Offset of a Visual","linkify":"How to: Get the Offset of a Visual","nodes":[{"content":"How to: Get the Offset of a Visual","pos":[0,34]}]},{"content":"These examples show how to retrieve the offset value of a visual object that is relative to its parent, or any ancestor or descendant.","pos":[630,764]},{"pos":[773,780],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following markup example shows a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> that is defined with <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement.Margin%2A&gt;</ph> value of 4.","pos":[784,943],"source":"The following markup example shows a <xref:System.Windows.Controls.TextBlock> that is defined with <xref:System.Windows.FrameworkElement.Margin%2A> value of 4."},{"pos":[950,1095],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>VisualSnippets#VisualSnippet1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml#visualsnippet1)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[VisualSnippets#VisualSnippet1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml#visualsnippet1)]"},{"content":"The following code example shows how to use the <ph id=\"ph1\">&lt;xref:System.Windows.Media.VisualTreeHelper.GetOffset%2A&gt;</ph> method to retrieve the offset of the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph>.","pos":[1102,1286],"source":"The following code example shows how to use the <xref:System.Windows.Media.VisualTreeHelper.GetOffset%2A> method to retrieve the offset of the <xref:System.Windows.Controls.TextBlock>."},{"content":"The offset values are contained within the returned <ph id=\"ph1\">&lt;xref:System.Windows.Vector&gt;</ph> value.","pos":[1287,1374],"source":" The offset values are contained within the returned <xref:System.Windows.Vector> value."},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>VisualSnippets#VisualSnippet2<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml.cs#visualsnippet2)</ept><ept id=\"p1\">]</ept>","pos":[1381,1532],"source":"[!code-csharp[VisualSnippets#VisualSnippet2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml.cs#visualsnippet2)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VisualSnippets#VisualSnippet2<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/VisualSnippets/visualbasic/window1.xaml.vb#visualsnippet2)</ept><ept id=\"p1\">]</ept>","pos":[1534,1691],"source":"[!code-vb[VisualSnippets#VisualSnippet2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/VisualSnippets/visualbasic/window1.xaml.vb#visualsnippet2)]"},{"content":"The offset takes into account the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Margin%2A&gt;</ph> value.","pos":[1698,1787],"source":"The offset takes into account the <xref:System.Windows.FrameworkElement.Margin%2A> value."},{"content":"In this case, <ph id=\"ph1\">&lt;xref:System.Windows.Vector.X%2A&gt;</ph> is 4, and <ph id=\"ph2\">&lt;xref:System.Windows.Vector.Y%2A&gt;</ph> is 4.","pos":[1788,1885],"source":" In this case, <xref:System.Windows.Vector.X%2A> is 4, and <xref:System.Windows.Vector.Y%2A> is 4."},{"content":"The returned offset value is relative to the parent of the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Visual&gt;</ph>.","pos":[1892,1986],"source":"The returned offset value is relative to the parent of the <xref:System.Windows.Media.Visual>."},{"content":"If you want to return an offset value that is not relative to the parent of a <ph id=\"ph1\">&lt;xref:System.Windows.Media.Visual&gt;</ph>, use the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Visual.TransformToAncestor%2A&gt;</ph> method.","pos":[1987,2174],"source":" If you want to return an offset value that is not relative to the parent of a <xref:System.Windows.Media.Visual>, use the <xref:System.Windows.Media.Visual.TransformToAncestor%2A> method."},{"pos":[2183,2225],"content":"Getting the Offset Relative to an Ancestor","linkify":"Getting the Offset Relative to an Ancestor","nodes":[{"content":"Getting the Offset Relative to an Ancestor","pos":[0,42]}]},{"content":"The following markup example shows a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> that is nested within two <ph id=\"ph2\">&lt;xref:System.Windows.Controls.StackPanel&gt;</ph> objects.","pos":[2229,2383],"source":"The following markup example shows a <xref:System.Windows.Controls.TextBlock> that is nested within two <xref:System.Windows.Controls.StackPanel> objects."},{"pos":[2390,2535],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>VisualSnippets#VisualSnippet7<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window2.xaml#visualsnippet7)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[VisualSnippets#VisualSnippet7](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window2.xaml#visualsnippet7)]"},{"content":"The following illustration shows the results of the markup.","pos":[2542,2601]},{"content":"<bpt id=\"p1\">![</bpt>Offset values of objects<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wpf/graphics-multimedia/media/visualoffset-01.png \"</bpt>VisualOffset_01<ept id=\"p2\">\")</ept>","pos":[2608,2731],"source":"![Offset values of objects](../../../../docs/framework/wpf/graphics-multimedia/media/visualoffset-01.png \"VisualOffset_01\")"},{"content":"TextBlock nested within two StackPanels","pos":[2734,2773]},{"content":"The following code example shows how to use the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Visual.TransformToAncestor%2A&gt;</ph> method to retrieve the offset of the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> relative to the containing <ph id=\"ph3\">&lt;xref:System.Windows.Window&gt;</ph>.","pos":[2780,3020],"source":"The following code example shows how to use the <xref:System.Windows.Media.Visual.TransformToAncestor%2A> method to retrieve the offset of the <xref:System.Windows.Controls.TextBlock> relative to the containing <xref:System.Windows.Window>."},{"content":"The offset values are contained within the returned <ph id=\"ph1\">&lt;xref:System.Windows.Media.GeneralTransform&gt;</ph> value.","pos":[3021,3124],"source":" The offset values are contained within the returned <xref:System.Windows.Media.GeneralTransform> value."},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>VisualSnippets#VisualSnippet5<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml.cs#visualsnippet5)</ept><ept id=\"p1\">]</ept>","pos":[3131,3282],"source":"[!code-csharp[VisualSnippets#VisualSnippet5](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml.cs#visualsnippet5)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VisualSnippets#VisualSnippet5<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/VisualSnippets/visualbasic/window1.xaml.vb#visualsnippet5)</ept><ept id=\"p1\">]</ept>","pos":[3284,3441],"source":"[!code-vb[VisualSnippets#VisualSnippet5](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/VisualSnippets/visualbasic/window1.xaml.vb#visualsnippet5)]"},{"content":"The offset takes into account the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Margin%2A&gt;</ph> values for all objects within the containing <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph>.","pos":[3448,3605],"source":"The offset takes into account the <xref:System.Windows.FrameworkElement.Margin%2A> values for all objects within the containing <xref:System.Windows.Window>."},{"content":"In this case, <ph id=\"ph1\">&lt;xref:System.Windows.Vector.X%2A&gt;</ph> is 28 (16 + 8 + 4), and <ph id=\"ph2\">&lt;xref:System.Windows.Vector.Y%2A&gt;</ph> is 28.","pos":[3606,3718],"source":" In this case, <xref:System.Windows.Vector.X%2A> is 28 (16 + 8 + 4), and <xref:System.Windows.Vector.Y%2A> is 28."},{"content":"The returned offset value is relative to the ancestor of the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Visual&gt;</ph>.","pos":[3725,3821],"source":"The returned offset value is relative to the ancestor of the <xref:System.Windows.Media.Visual>."},{"content":"If you want to return an offset value that is relative to the descendant of a <ph id=\"ph1\">&lt;xref:System.Windows.Media.Visual&gt;</ph>, use the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Visual.TransformToDescendant%2A&gt;</ph> method.","pos":[3822,4011],"source":" If you want to return an offset value that is relative to the descendant of a <xref:System.Windows.Media.Visual>, use the <xref:System.Windows.Media.Visual.TransformToDescendant%2A> method."},{"pos":[4020,4063],"content":"Getting the Offset Relative to a Descendant","linkify":"Getting the Offset Relative to a Descendant","nodes":[{"content":"Getting the Offset Relative to a Descendant","pos":[0,43]}]},{"content":"The following markup example shows a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> that is contained within a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.StackPanel&gt;</ph> object.","pos":[4067,4221],"source":"The following markup example shows a <xref:System.Windows.Controls.TextBlock> that is contained within a <xref:System.Windows.Controls.StackPanel> object."},{"pos":[4228,4373],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>VisualSnippets#VisualSnippet4<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml#visualsnippet4)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[VisualSnippets#VisualSnippet4](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml#visualsnippet4)]"},{"content":"The following code example shows how to use the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Visual.TransformToDescendant%2A&gt;</ph> method to retrieve the offset of the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.StackPanel&gt;</ph> relative to its child <ph id=\"ph3\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph>.","pos":[4380,4630],"source":"The following code example shows how to use the <xref:System.Windows.Media.Visual.TransformToDescendant%2A> method to retrieve the offset of the <xref:System.Windows.Controls.StackPanel> relative to its child <xref:System.Windows.Controls.TextBlock>."},{"content":"The offset values are contained within the returned <ph id=\"ph1\">&lt;xref:System.Windows.Media.GeneralTransform&gt;</ph> value.","pos":[4631,4734],"source":" The offset values are contained within the returned <xref:System.Windows.Media.GeneralTransform> value."},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>VisualSnippets#VisualSnippet9<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml.cs#visualsnippet9)</ept><ept id=\"p1\">]</ept>","pos":[4741,4892],"source":"[!code-csharp[VisualSnippets#VisualSnippet9](../../../../samples/snippets/csharp/VS_Snippets_Wpf/VisualSnippets/CSharp/Window1.xaml.cs#visualsnippet9)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VisualSnippets#VisualSnippet9<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/VisualSnippets/visualbasic/window1.xaml.vb#visualsnippet9)</ept><ept id=\"p1\">]</ept>","pos":[4894,5051],"source":"[!code-vb[VisualSnippets#VisualSnippet9](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/VisualSnippets/visualbasic/window1.xaml.vb#visualsnippet9)]"},{"content":"The offset takes into account the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Margin%2A&gt;</ph> values for all objects.","pos":[5058,5164],"source":"The offset takes into account the <xref:System.Windows.FrameworkElement.Margin%2A> values for all objects."},{"content":"In this case, <ph id=\"ph1\">&lt;xref:System.Windows.Vector.X%2A&gt;</ph> is -4, and <ph id=\"ph2\">&lt;xref:System.Windows.Vector.Y%2A&gt;</ph> is -4.","pos":[5165,5264],"source":" In this case, <xref:System.Windows.Vector.X%2A> is -4, and <xref:System.Windows.Vector.Y%2A> is -4."},{"content":"The offset values are negative values, since the parent object is negatively offset relative to its child object.","pos":[5265,5378]},{"pos":[5387,5395],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Media.Visual&gt;</ph>","pos":[5399,5433],"source":"<xref:System.Windows.Media.Visual> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Media.VisualTreeHelper&gt;</ph>","pos":[5438,5482],"source":"<xref:System.Windows.Media.VisualTreeHelper> "},{"content":"<bpt id=\"p1\">[</bpt>WPF Graphics Rendering Overview<ept id=\"p1\">](../../../../docs/framework/wpf/graphics-multimedia/wpf-graphics-rendering-overview.md)</ept>","pos":[5487,5607],"source":"[WPF Graphics Rendering Overview](../../../../docs/framework/wpf/graphics-multimedia/wpf-graphics-rendering-overview.md)"}]}