{"content":"---\ntitle: \"Overview of the Visual Basic Application Model\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"My.Application object [Visual Basic], Visual Basic application model\"\n  - \"Visual Basic application model\"\nms.assetid: 17538984-84fe-43c9-82c8-724c9529fe8b\n---\n# Overview of the Visual Basic Application Model\nVisual Basic provides a well-defined model for controlling the behavior of Windows Forms applications: the Visual Basic Application model. This model includes events for handling the application's startup and shutdown, as well as events for catching unhandled exceptions. It also provides support for developing single-instance applications. The application model is extensible, so developers that need more control can customize its overridable methods.  \n  \n## Uses for the Application Model  \n A typical application needs to perform tasks when it starts up and shuts down. For example, when it starts up, the application can display a splash screen, make database connections, load a saved state, and so on. When the application shuts down, it can close database connections, save the current state, and so on. In addition, the application can execute specific code when the application shuts down unexpectedly, such as during an unhandled exception.  \n  \n The Visual Basic Application model makes it easy to create a *single-instance* application. A single-instance application differs from a normal application in that only one instance of the application can be running at a time. An attempt to launch another instance of a single-instance application results in the original instance being notified—by means of the `StartupNextInstance` event—that another launch attempt was made. The notification includes the subsequent instance's command-line arguments. The subsequent instance of the application is then closed before any initialization can occur.  \n  \n A single-instance application starts and checks whether it is the first instance or a subsequent instance of the application:  \n  \n-   If it is the first instance, it starts as usual.  \n  \n-   Each subsequent attempt to start the application, while the first instance runs, results in very different behavior. The subsequent attempt notifies the first instance about the command-line arguments, and then immediately exits. The first instance handles the `StartupNextInstance` event to determine what the subsequent instance's command-line arguments were, and continues to run.  \n  \n     This diagram shows how a subsequent instance signals the first instance:  \n  \n     ![Diagram that shows a single instance application image.](./media/overview-of-the-visual-basic-application-model/single-instance-application.gif)  \n  \n By handling the `StartupNextInstance` event, you can control how your single-instance application behaves. For example, Microsoft Outlook typically runs as a single-instance application; when Outlook is running and you attempt to start Outlook again, focus shifts to the original instance but another instance does not open.  \n  \n## Events in the Application Model  \n The following events are found in the application model:  \n  \n-   **Application startup**. The application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup> event when it starts. By handling this event, you can add code that initializes the application before the main form is loaded. The `Startup` event also provides for canceling execution of the application during that phase of the startup process, if desired.  \n  \n     You can configure the application to show a splash screen while the application startup code runs. By default, the application model suppresses the splash screen when either the `/nosplash` or `-nosplash` command-line argument is used.  \n  \n-   **Single-instance applications**. The <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.StartupNextInstance> event is raised when a subsequent instance of a single-instance application starts. The event passes the command-line arguments of the subsequent instance.  \n  \n-   **Unhandled exceptions**. If the application encounters an unhandled exception, it raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.UnhandledException> event. Your handler for that event can examine the exception and determine whether to continue execution.  \n  \n     The `UnhandledException` event is not raised in some circumstances. For more information, see <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.UnhandledException>.  \n  \n-   **Network-connectivity changes**. If the computer's network availability changes, the application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.NetworkAvailabilityChanged> event.  \n  \n     The `NetworkAvailabilityChanged` event is not raised in some circumstances. For more information, see <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.NetworkAvailabilityChanged>.  \n  \n-   **Application shut down**. The application provides the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown> event to signal when it is about to shut down. In that event handler, you can make sure that the operations your application needs to perform—closing and saving, for example—are completed. You can configure your application to shut down when the main form closes, or to shut down only when all forms close.  \n  \n## Availability  \n By default, the Visual Basic Application model is available for Windows Forms projects. If you configure the application to use a different startup object, or start the application code with a custom `Sub Main`, then that object or class may need to provide an implementation of the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase> class to use the application model. For information about changing the startup object, see [Application Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/application-page-project-designer-visual-basic).  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase>\n- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup>\n- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.StartupNextInstance>\n- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.UnhandledException>\n- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown>\n- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.NetworkAvailabilityChanged>\n- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase>\n- [Extending the Visual Basic Application Model](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-visual-basic-application-model.md)\n","nodes":[{"pos":[4,262],"embed":true,"restype":"x-metadata","content":"title: \"Overview of the Visual Basic Application Model\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"My.Application object [Visual Basic], Visual Basic application model\"\n  - \"Visual Basic application model\"\nms.assetid: 17538984-84fe-43c9-82c8-724c9529fe8b","nodes":[{"content":"Overview of the Visual Basic Application Model","nodes":[{"pos":[0,46],"content":"Overview of the Visual Basic Application Model","nodes":[{"content":"Overview of the Visual Basic Application Model","pos":[0,46]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[269,315],"content":"Overview of the Visual Basic Application Model","linkify":"Overview of the Visual Basic Application Model","nodes":[{"content":"Overview of the Visual Basic Application Model","pos":[0,46]}]},{"content":"Visual Basic provides a well-defined model for controlling the behavior of Windows Forms applications: the Visual Basic Application model.","pos":[316,454]},{"content":"This model includes events for handling the application's startup and shutdown, as well as events for catching unhandled exceptions.","pos":[455,587]},{"content":"It also provides support for developing single-instance applications.","pos":[588,657]},{"content":"The application model is extensible, so developers that need more control can customize its overridable methods.","pos":[658,770]},{"pos":[779,809],"content":"Uses for the Application Model","linkify":"Uses for the Application Model","nodes":[{"content":"Uses for the Application Model","pos":[0,30]}]},{"content":"A typical application needs to perform tasks when it starts up and shuts down.","pos":[813,891]},{"content":"For example, when it starts up, the application can display a splash screen, make database connections, load a saved state, and so on.","pos":[892,1026]},{"content":"When the application shuts down, it can close database connections, save the current state, and so on.","pos":[1027,1129]},{"content":"In addition, the application can execute specific code when the application shuts down unexpectedly, such as during an unhandled exception.","pos":[1130,1269]},{"content":"The Visual Basic Application model makes it easy to create a <bpt id=\"p1\">*</bpt>single-instance<ept id=\"p1\">*</ept> application.","pos":[1276,1367],"source":"The Visual Basic Application model makes it easy to create a *single-instance* application."},{"content":"A single-instance application differs from a normal application in that only one instance of the application can be running at a time.","pos":[1368,1502]},{"content":"An attempt to launch another instance of a single-instance application results in the original instance being notified—by means of the <ph id=\"ph1\">`StartupNextInstance`</ph> event—that another launch attempt was made.","pos":[1503,1703],"source":" An attempt to launch another instance of a single-instance application results in the original instance being notified—by means of the `StartupNextInstance` event—that another launch attempt was made."},{"content":"The notification includes the subsequent instance's command-line arguments.","pos":[1704,1779]},{"content":"The subsequent instance of the application is then closed before any initialization can occur.","pos":[1780,1874]},{"content":"A single-instance application starts and checks whether it is the first instance or a subsequent instance of the application:","pos":[1881,2006]},{"content":"If it is the first instance, it starts as usual.","pos":[2016,2064]},{"content":"Each subsequent attempt to start the application, while the first instance runs, results in very different behavior.","pos":[2074,2190]},{"content":"The subsequent attempt notifies the first instance about the command-line arguments, and then immediately exits.","pos":[2191,2303]},{"content":"The first instance handles the <ph id=\"ph1\">`StartupNextInstance`</ph> event to determine what the subsequent instance's command-line arguments were, and continues to run.","pos":[2304,2457],"source":" The first instance handles the `StartupNextInstance` event to determine what the subsequent instance's command-line arguments were, and continues to run."},{"content":"This diagram shows how a subsequent instance signals the first instance:","pos":[2468,2540]},{"content":"Diagram that shows a single instance application image.","pos":[2553,2608]},{"content":"By handling the <ph id=\"ph1\">`StartupNextInstance`</ph> event, you can control how your single-instance application behaves.","pos":[2704,2810],"source":"By handling the `StartupNextInstance` event, you can control how your single-instance application behaves."},{"content":"For example, Microsoft Outlook typically runs as a single-instance application; when Outlook is running and you attempt to start Outlook again, focus shifts to the original instance but another instance does not open.","pos":[2811,3028]},{"pos":[3037,3068],"content":"Events in the Application Model","linkify":"Events in the Application Model","nodes":[{"content":"Events in the Application Model","pos":[0,31]}]},{"content":"The following events are found in the application model:","pos":[3072,3128]},{"content":"<bpt id=\"p1\">**</bpt>Application startup<ept id=\"p1\">**</ept>.","pos":[3138,3162],"source":"**Application startup**."},{"content":"The application raises the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup&gt;</ph> event when it starts.","pos":[3163,3296],"source":" The application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup> event when it starts."},{"content":"By handling this event, you can add code that initializes the application before the main form is loaded.","pos":[3297,3402]},{"content":"The <ph id=\"ph1\">`Startup`</ph> event also provides for canceling execution of the application during that phase of the startup process, if desired.","pos":[3403,3533],"source":" The `Startup` event also provides for canceling execution of the application during that phase of the startup process, if desired."},{"content":"You can configure the application to show a splash screen while the application startup code runs.","pos":[3544,3642]},{"content":"By default, the application model suppresses the splash screen when either the <ph id=\"ph1\">`/nosplash`</ph> or <ph id=\"ph2\">`-nosplash`</ph> command-line argument is used.","pos":[3643,3779],"source":" By default, the application model suppresses the splash screen when either the `/nosplash` or `-nosplash` command-line argument is used."},{"content":"<bpt id=\"p1\">**</bpt>Single-instance applications<ept id=\"p1\">**</ept>.","pos":[3789,3822],"source":"**Single-instance applications**."},{"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.StartupNextInstance&gt;</ph> event is raised when a subsequent instance of a single-instance application starts.","pos":[3823,4007],"source":" The <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.StartupNextInstance> event is raised when a subsequent instance of a single-instance application starts."},{"content":"The event passes the command-line arguments of the subsequent instance.","pos":[4008,4079]},{"content":"<bpt id=\"p1\">**</bpt>Unhandled exceptions<ept id=\"p1\">**</ept>.","pos":[4089,4114],"source":"**Unhandled exceptions**."},{"content":"If the application encounters an unhandled exception, it raises the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.UnhandledException&gt;</ph> event.","pos":[4115,4285],"source":" If the application encounters an unhandled exception, it raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.UnhandledException> event."},{"content":"Your handler for that event can examine the exception and determine whether to continue execution.","pos":[4286,4384]},{"content":"The <ph id=\"ph1\">`UnhandledException`</ph> event is not raised in some circumstances.","pos":[4395,4462],"source":"The `UnhandledException` event is not raised in some circumstances."},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.UnhandledException&gt;</ph>.","pos":[4463,4585],"source":" For more information, see <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.UnhandledException>."},{"content":"<bpt id=\"p1\">**</bpt>Network-connectivity changes<ept id=\"p1\">**</ept>.","pos":[4595,4628],"source":"**Network-connectivity changes**."},{"content":"If the computer's network availability changes, the application raises the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.NetworkAvailabilityChanged&gt;</ph> event.","pos":[4629,4814],"source":" If the computer's network availability changes, the application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.NetworkAvailabilityChanged> event."},{"content":"The <ph id=\"ph1\">`NetworkAvailabilityChanged`</ph> event is not raised in some circumstances.","pos":[4825,4900],"source":"The `NetworkAvailabilityChanged` event is not raised in some circumstances."},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.NetworkAvailabilityChanged&gt;</ph>.","pos":[4901,5031],"source":" For more information, see <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.NetworkAvailabilityChanged>."},{"content":"<bpt id=\"p1\">**</bpt>Application shut down<ept id=\"p1\">**</ept>.","pos":[5041,5067],"source":"**Application shut down**."},{"content":"The application provides the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown&gt;</ph> event to signal when it is about to shut down.","pos":[5068,5229],"source":" The application provides the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown> event to signal when it is about to shut down."},{"content":"In that event handler, you can make sure that the operations your application needs to perform—closing and saving, for example—are completed.","pos":[5230,5371]},{"content":"You can configure your application to shut down when the main form closes, or to shut down only when all forms close.","pos":[5372,5489]},{"pos":[5498,5510],"content":"Availability","linkify":"Availability","nodes":[{"content":"Availability","pos":[0,12]}]},{"content":"By default, the Visual Basic Application model is available for Windows Forms projects.","pos":[5514,5601]},{"content":"If you configure the application to use a different startup object, or start the application code with a custom <ph id=\"ph1\">`Sub Main`</ph>, then that object or class may need to provide an implementation of the <ph id=\"ph2\">&lt;xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase&gt;</ph> class to use the application model.","pos":[5602,5909],"source":" If you configure the application to use a different startup object, or start the application code with a custom `Sub Main`, then that object or class may need to provide an implementation of the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase> class to use the application model."},{"content":"For information about changing the startup object, see <bpt id=\"p1\">[</bpt>Application Page, Project Designer (Visual Basic)<ept id=\"p1\">](/visualstudio/ide/reference/application-page-project-designer-visual-basic)</ept>.","pos":[5910,6093],"source":" For information about changing the startup object, see [Application Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/application-page-project-designer-visual-basic)."},{"pos":[6102,6110],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6750,6908],"content":"<bpt id=\"p1\">[</bpt>Extending the Visual Basic Application Model<ept id=\"p1\">](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-visual-basic-application-model.md)</ept>","source":"[Extending the Visual Basic Application Model](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-visual-basic-application-model.md)"}]}