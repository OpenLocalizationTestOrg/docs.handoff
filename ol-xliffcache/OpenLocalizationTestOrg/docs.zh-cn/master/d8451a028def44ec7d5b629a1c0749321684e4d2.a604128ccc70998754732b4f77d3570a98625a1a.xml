{"content":"---\ntitle: \"-link (Visual Basic)\"\nms.date: 03/10/2018\nhelpviewer_keywords: \n  - \"l compiler option [Visual Basic]\"\n  - \"EmbedInteropTypes\"\n  - \"embed interop types [COM Interop]\"\n  - \"-link compiler option [Visual Basic]\"\n  - \"/link compiler option [Visual Basic]\"\n  - \"link compiler option [Visual Basic]\"\n  - \"-l compiler option [Visual Basic]\"\n  - \"/l compiler option [Visual Basic]\"\nms.assetid: 1885f24a-86f5-486c-a064-9fb7e455ccec\n---\n# -link (Visual Basic)\nCauses the compiler to make COM type information in the specified assemblies available to the project that you are currently compiling.  \n  \n## Syntax  \n  \n```  \n-link:fileList  \n' -or-  \n-l:fileList  \n```  \n  \n## Arguments  \n  \n|Term|Definition|  \n|---|---|  \n|`fileList`|Required. Comma-delimited list of assembly file names. If the file name contains a space, enclose the name in quotation marks.|  \n  \n## Remarks  \n The `-link` option enables you to deploy an application that has embedded type information. The application can then use types in a runtime assembly that implement the embedded type information without requiring a reference to the runtime assembly. If various versions of the runtime assembly are published, the application that contains the embedded type information can work with the various versions without having to be recompiled. For an example, see [Walkthrough: Embedding Types from Managed Assemblies](../../../visual-basic/programming-guide/concepts/assemblies-gac/walkthrough-embedding-types-from-managed-assemblies-in-vs.md).  \n  \n Using the `-link` option is especially useful when you are working with COM interop. You can embed COM types so that your application no longer requires a primary interop assembly (PIA) on the target computer. The `-link` option instructs the compiler to embed the COM type information from the referenced interop assembly into the resulting compiled code. The COM type is identified by the CLSID (GUID) value. As a result, your application can run on a target computer that has installed the same COM types with the same CLSID values. Applications that automate Microsoft Office are a good example. Because applications like Office usually keep the same CLSID value across different versions, your application can use the referenced COM types as long as .NET Framework 4 or later is installed on the target computer and your application uses methods, properties, or events that are included in the referenced COM types.  \n  \n The `-link` option embeds only interfaces, structures, and delegates. Embedding COM classes is not supported.  \n  \n> [!NOTE]\n>  When you create an instance of an embedded COM type in your code, you must create the instance by using the appropriate interface. Attempting to create an instance of an embedded COM type by using the CoClass causes an error.  \n  \n To set the `-link` option in Visual Studio, add an assembly reference and set the `Embed Interop Types` property to **true**. The default for the `Embed Interop Types` property is **false**.  \n  \n If you link to a COM assembly (Assembly A) which itself references another COM assembly (Assembly B), you also have to link to Assembly B if either of the following is true:  \n  \n-   A type from Assembly A inherits from a type or implements an interface from Assembly B.  \n  \n-   A field, property, event, or method that has a return type or parameter type from Assembly B is invoked.  \n  \n Use [-libpath](../../../visual-basic/reference/command-line-compiler/libpath.md) to specify the directory in which one or more of your assembly references is located.  \n  \n Like the [/reference](../../../visual-basic/reference/command-line-compiler/reference.md) compiler option, the `-link` compiler option uses the Vbc.rsp response file, which references frequently used [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] assemblies. Use the [-noconfig](../../../visual-basic/reference/command-line-compiler/noconfig.md) compiler option if you do not want the compiler to use the Vbc.rsp file.  \n  \n The short form of `-link` is `-l`.  \n  \n## Generics and Embedded Types  \n The following sections describe the limitations on using generic types in applications that embed interop types.  \n  \n### Generic Interfaces  \n Generic interfaces that are embedded from an interop assembly cannot be used. This is shown in the following example.  \n  \n [!code-vb[VbLinkCompiler#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vblinkcompiler/vb/module1.vb#1)]  \n  \n### Types That Have Generic Parameters  \n Types that have a generic parameter whose type is embedded from an interop assembly cannot be used if that type is from an external assembly. This restriction does not apply to interfaces. For example, consider the <xref:Microsoft.Office.Interop.Excel.Range> interface that is defined in the <xref:Microsoft.Office.Interop.Excel> assembly. If a library embeds interop types from the <xref:Microsoft.Office.Interop.Excel> assembly and exposes a method that returns a generic type that has a parameter whose type is the <xref:Microsoft.Office.Interop.Excel.Range> interface, that method must return a generic interface, as shown in the following code example.  \n  \n [!code-vb[VbLinkCompiler#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vblinkcompiler/vb/utility.vb#2)]  \n[!code-vb[VbLinkCompiler#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vblinkcompiler/vb/utility.vb#3)]  \n[!code-vb[VbLinkCompiler#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vblinkcompiler/vb/utility.vb#4)]  \n  \n In the following example, client code can call the method that returns the <xref:System.Collections.IList> generic interface without error.  \n  \n [!code-vb[VbLinkCompiler#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vblinkcompiler/vb/module1.vb#5)]  \n  \n## Example  \n The following command line compiles source file `OfficeApp.vb` and reference assemblies from `COMData1.dll` and `COMData2.dll` to produce `OfficeApp.exe`.  \n  \n```console  \nvbc -link:COMData1.dll,COMData2.dll /out:OfficeApp.exe OfficeApp.vb  \n```  \n  \n## See also\n\n- [Visual Basic Command-Line Compiler](../../../visual-basic/reference/command-line-compiler/index.md)\n- [Walkthrough: Embedding Types from Managed Assemblies](../../../visual-basic/programming-guide/concepts/assemblies-gac/walkthrough-embedding-types-from-managed-assemblies-in-vs.md)\n- [-reference (Visual Basic)](../../../visual-basic/reference/command-line-compiler/reference.md)\n- [-noconfig](../../../visual-basic/reference/command-line-compiler/noconfig.md)\n- [-libpath](../../../visual-basic/reference/command-line-compiler/libpath.md)\n- [Sample Compilation Command Lines](../../../visual-basic/reference/command-line-compiler/sample-compilation-command-lines.md)\n- [Introduction to COM Interop](../../../visual-basic/programming-guide/com-interop/introduction-to-com-interop.md)\n","nodes":[{"pos":[4,435],"embed":true,"restype":"x-metadata","content":"title: \"-link (Visual Basic)\"\nms.date: 03/10/2018\nhelpviewer_keywords: \n  - \"l compiler option [Visual Basic]\"\n  - \"EmbedInteropTypes\"\n  - \"embed interop types [COM Interop]\"\n  - \"-link compiler option [Visual Basic]\"\n  - \"/link compiler option [Visual Basic]\"\n  - \"link compiler option [Visual Basic]\"\n  - \"-l compiler option [Visual Basic]\"\n  - \"/l compiler option [Visual Basic]\"\nms.assetid: 1885f24a-86f5-486c-a064-9fb7e455ccec","nodes":[{"content":"-link (Visual Basic)","nodes":[{"pos":[0,20],"content":"-link (Visual Basic)","nodes":[{"content":"-link (Visual Basic)","pos":[0,20]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[442,462],"content":"-link (Visual Basic)","linkify":"-link (Visual Basic)","nodes":[{"content":"-link (Visual Basic)","pos":[0,20]}]},{"content":"Causes the compiler to make COM type information in the specified assemblies available to the project that you are currently compiling.","pos":[463,598]},{"pos":[607,613],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[677,686],"content":"Arguments","linkify":"Arguments","nodes":[{"content":"Arguments","pos":[0,9]}]},{"content":"Term","pos":[693,697]},{"content":"Definition","pos":[698,708]},{"content":"Required.","pos":[736,745]},{"content":"Comma-delimited list of assembly file names.","pos":[746,790]},{"content":"If the file name contains a space, enclose the name in quotation marks.","pos":[791,862]},{"pos":[872,879],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`-link`</ph> option enables you to deploy an application that has embedded type information.","pos":[883,974],"source":"The `-link` option enables you to deploy an application that has embedded type information."},{"content":"The application can then use types in a runtime assembly that implement the embedded type information without requiring a reference to the runtime assembly.","pos":[975,1131]},{"content":"If various versions of the runtime assembly are published, the application that contains the embedded type information can work with the various versions without having to be recompiled.","pos":[1132,1318]},{"content":"For an example, see <bpt id=\"p1\">[</bpt>Walkthrough: Embedding Types from Managed Assemblies<ept id=\"p1\">](../../../visual-basic/programming-guide/concepts/assemblies-gac/walkthrough-embedding-types-from-managed-assemblies-in-vs.md)</ept>.","pos":[1319,1520],"source":" For an example, see [Walkthrough: Embedding Types from Managed Assemblies](../../../visual-basic/programming-guide/concepts/assemblies-gac/walkthrough-embedding-types-from-managed-assemblies-in-vs.md)."},{"content":"Using the <ph id=\"ph1\">`-link`</ph> option is especially useful when you are working with COM interop.","pos":[1527,1611],"source":"Using the `-link` option is especially useful when you are working with COM interop."},{"content":"You can embed COM types so that your application no longer requires a primary interop assembly (PIA) on the target computer.","pos":[1612,1736]},{"content":"The <ph id=\"ph1\">`-link`</ph> option instructs the compiler to embed the COM type information from the referenced interop assembly into the resulting compiled code.","pos":[1737,1883],"source":" The `-link` option instructs the compiler to embed the COM type information from the referenced interop assembly into the resulting compiled code."},{"content":"The COM type is identified by the CLSID (GUID) value.","pos":[1884,1937]},{"content":"As a result, your application can run on a target computer that has installed the same COM types with the same CLSID values.","pos":[1938,2062]},{"content":"Applications that automate Microsoft Office are a good example.","pos":[2063,2126]},{"content":"Because applications like Office usually keep the same CLSID value across different versions, your application can use the referenced COM types as long as .NET Framework 4 or later is installed on the target computer and your application uses methods, properties, or events that are included in the referenced COM types.","pos":[2127,2447]},{"content":"The <ph id=\"ph1\">`-link`</ph> option embeds only interfaces, structures, and delegates.","pos":[2454,2523],"source":"The `-link` option embeds only interfaces, structures, and delegates."},{"content":"Embedding COM classes is not supported.","pos":[2524,2563]},{"pos":[2571,2807],"content":"[!NOTE]\n When you create an instance of an embedded COM type in your code, you must create the instance by using the appropriate interface. Attempting to create an instance of an embedded COM type by using the CoClass causes an error.","leadings":["","> "],"nodes":[{"content":"When you create an instance of an embedded COM type in your code, you must create the instance by using the appropriate interface. Attempting to create an instance of an embedded COM type by using the CoClass causes an error.","pos":[9,234],"nodes":[{"content":"When you create an instance of an embedded COM type in your code, you must create the instance by using the appropriate interface.","pos":[0,130]},{"content":"Attempting to create an instance of an embedded COM type by using the CoClass causes an error.","pos":[131,225]}]}]},{"content":"To set the <ph id=\"ph1\">`-link`</ph> option in Visual Studio, add an assembly reference and set the <ph id=\"ph2\">`Embed Interop Types`</ph> property to <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept>.","pos":[2814,2939],"source":"To set the `-link` option in Visual Studio, add an assembly reference and set the `Embed Interop Types` property to **true**."},{"content":"The default for the <ph id=\"ph1\">`Embed Interop Types`</ph> property is <bpt id=\"p1\">**</bpt>false<ept id=\"p1\">**</ept>.","pos":[2940,3004],"source":" The default for the `Embed Interop Types` property is **false**."},{"content":"If you link to a COM assembly (Assembly A) which itself references another COM assembly (Assembly B), you also have to link to Assembly B if either of the following is true:","pos":[3011,3184]},{"content":"A type from Assembly A inherits from a type or implements an interface from Assembly B.","pos":[3194,3281]},{"content":"A field, property, event, or method that has a return type or parameter type from Assembly B is invoked.","pos":[3291,3395]},{"pos":[3402,3568],"content":"Use <bpt id=\"p1\">[</bpt>-libpath<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/libpath.md)</ept> to specify the directory in which one or more of your assembly references is located.","source":"Use [-libpath](../../../visual-basic/reference/command-line-compiler/libpath.md) to specify the directory in which one or more of your assembly references is located."},{"content":"Like the <bpt id=\"p1\">[</bpt>/reference<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/reference.md)</ept> compiler option, the <ph id=\"ph1\">`-link`</ph> compiler option uses the Vbc.rsp response file, which references frequently used <ph id=\"ph2\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> assemblies.","pos":[3575,3840],"source":"Like the [/reference](../../../visual-basic/reference/command-line-compiler/reference.md) compiler option, the `-link` compiler option uses the Vbc.rsp response file, which references frequently used [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] assemblies."},{"content":"Use the <bpt id=\"p1\">[</bpt>-noconfig<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/noconfig.md)</ept> compiler option if you do not want the compiler to use the Vbc.rsp file.","pos":[3841,4000],"source":" Use the [-noconfig](../../../visual-basic/reference/command-line-compiler/noconfig.md) compiler option if you do not want the compiler to use the Vbc.rsp file."},{"pos":[4007,4041],"content":"The short form of <ph id=\"ph1\">`-link`</ph> is <ph id=\"ph2\">`-l`</ph>.","source":"The short form of `-link` is `-l`."},{"pos":[4050,4077],"content":"Generics and Embedded Types","linkify":"Generics and Embedded Types","nodes":[{"content":"Generics and Embedded Types","pos":[0,27]}]},{"content":"The following sections describe the limitations on using generic types in applications that embed interop types.","pos":[4081,4193]},{"pos":[4203,4221],"content":"Generic Interfaces","linkify":"Generic Interfaces","nodes":[{"content":"Generic Interfaces","pos":[0,18]}]},{"content":"Generic interfaces that are embedded from an interop assembly cannot be used.","pos":[4225,4302]},{"content":"This is shown in the following example.","pos":[4303,4342]},{"pos":[4471,4505],"content":"Types That Have Generic Parameters","linkify":"Types That Have Generic Parameters","nodes":[{"content":"Types That Have Generic Parameters","pos":[0,34]}]},{"content":"Types that have a generic parameter whose type is embedded from an interop assembly cannot be used if that type is from an external assembly.","pos":[4509,4650]},{"content":"This restriction does not apply to interfaces.","pos":[4651,4697]},{"content":"For example, consider the <ph id=\"ph1\">&lt;xref:Microsoft.Office.Interop.Excel.Range&gt;</ph> interface that is defined in the <ph id=\"ph2\">&lt;xref:Microsoft.Office.Interop.Excel&gt;</ph> assembly.","pos":[4698,4848],"source":" For example, consider the <xref:Microsoft.Office.Interop.Excel.Range> interface that is defined in the <xref:Microsoft.Office.Interop.Excel> assembly."},{"content":"If a library embeds interop types from the <ph id=\"ph1\">&lt;xref:Microsoft.Office.Interop.Excel&gt;</ph> assembly and exposes a method that returns a generic type that has a parameter whose type is the <ph id=\"ph2\">&lt;xref:Microsoft.Office.Interop.Excel.Range&gt;</ph> interface, that method must return a generic interface, as shown in the following code example.","pos":[4849,5166],"source":" If a library embeds interop types from the <xref:Microsoft.Office.Interop.Excel> assembly and exposes a method that returns a generic type that has a parameter whose type is the <xref:Microsoft.Office.Interop.Excel.Range> interface, that method must return a generic interface, as shown in the following code example."},{"pos":[5522,5661],"content":"In the following example, client code can call the method that returns the <ph id=\"ph1\">&lt;xref:System.Collections.IList&gt;</ph> generic interface without error.","source":"In the following example, client code can call the method that returns the <xref:System.Collections.IList> generic interface without error."},{"pos":[5789,5796],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5800,5954],"content":"The following command line compiles source file <ph id=\"ph1\">`OfficeApp.vb`</ph> and reference assemblies from <ph id=\"ph2\">`COMData1.dll`</ph> and <ph id=\"ph3\">`COMData2.dll`</ph> to produce <ph id=\"ph4\">`OfficeApp.exe`</ph>.","source":"The following command line compiles source file `OfficeApp.vb` and reference assemblies from `COMData1.dll` and `COMData2.dll` to produce `OfficeApp.exe`."},{"pos":[6055,6063],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6067,6167],"content":"<bpt id=\"p1\">[</bpt>Visual Basic Command-Line Compiler<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/index.md)</ept>","source":"[Visual Basic Command-Line Compiler](../../../visual-basic/reference/command-line-compiler/index.md)"},{"pos":[6170,6350],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Embedding Types from Managed Assemblies<ept id=\"p1\">](../../../visual-basic/programming-guide/concepts/assemblies-gac/walkthrough-embedding-types-from-managed-assemblies-in-vs.md)</ept>","source":"[Walkthrough: Embedding Types from Managed Assemblies](../../../visual-basic/programming-guide/concepts/assemblies-gac/walkthrough-embedding-types-from-managed-assemblies-in-vs.md)"},{"pos":[6353,6448],"content":"<bpt id=\"p1\">[</bpt>-reference (Visual Basic)<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/reference.md)</ept>","source":"[-reference (Visual Basic)](../../../visual-basic/reference/command-line-compiler/reference.md)"},{"pos":[6451,6529],"content":"<bpt id=\"p1\">[</bpt>-noconfig<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/noconfig.md)</ept>","source":"[-noconfig](../../../visual-basic/reference/command-line-compiler/noconfig.md)"},{"pos":[6532,6608],"content":"<bpt id=\"p1\">[</bpt>-libpath<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/libpath.md)</ept>","source":"[-libpath](../../../visual-basic/reference/command-line-compiler/libpath.md)"},{"pos":[6611,6736],"content":"<bpt id=\"p1\">[</bpt>Sample Compilation Command Lines<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/sample-compilation-command-lines.md)</ept>","source":"[Sample Compilation Command Lines](../../../visual-basic/reference/command-line-compiler/sample-compilation-command-lines.md)"},{"pos":[6739,6852],"content":"<bpt id=\"p1\">[</bpt>Introduction to COM Interop<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/introduction-to-com-interop.md)</ept>","source":"[Introduction to COM Interop](../../../visual-basic/programming-guide/com-interop/introduction-to-com-interop.md)"}]}