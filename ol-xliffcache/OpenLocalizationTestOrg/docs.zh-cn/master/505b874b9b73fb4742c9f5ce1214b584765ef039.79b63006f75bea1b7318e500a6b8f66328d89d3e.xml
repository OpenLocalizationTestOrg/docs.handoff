{"content":"---\ntitle: \"Using Variables with a .NET Framework 3.5 Ruleset | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 27b56249-22fe-4252-840f-74c0d6c7a6b3\ncaps.latest.revision: 7\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Using Variables with a .NET Framework 3.5 Ruleset\nThis sample demonstrates how to create a workflow that uses the <xref:System.Activities.Statements.Interop> activity to integrate a custom activity written in [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)] that uses policy and rules. The workflow passes data to the custom activity by binding variables to the dependency properties exposed by the custom activity.  \n  \n## Sample walkthrough  \n  \n#### To examine TravelRuleLibrary  \n  \n1.  Using [!INCLUDE[vs_current_short](../../../../includes/vs-current-short-md.md)], open the InteropWith35RuleSet.sln solution file.  \n  \n2.  Open the TravelRuleSet.cs in the workflow designer.  \n  \n     A custom sequential activity that contains a <xref:System.Workflow.Activities.PolicyActivity> is displayed.  \n  \n3.  Double-click the DiscountPolicy policy activity to examine the rules.  \n  \n     The Rules editor pops up to show the rules.  \n  \n4.  Right click the `DiscountPolicy` and select the **View Code** option to examine the code beside C# code for the activity.  \n  \n     Observe the dependency property setting for `DiscountLevel`. This is equivalent to arguments in [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)]. [!INCLUDE[crabout](../../../../includes/crabout-md.md)]arguments, see [Variables and Arguments](../../../../docs/framework/windows-workflow-foundation/variables-and-arguments.md).  \n  \n## InteropWith35RuleSet  \n This is a sequential workflow project that uses the <xref:System.Activities.Statements.Interop> activity to integrate with the custom Rule set created in the `TravelRuleLibrary` project. Variables are created on the top level <xref:System.Activities.Statements.Sequence> activity. The <xref:System.Activities.Statements.Interop> activity is used to integrate with the `TravelRuleSet` activity. The variables that are declared on the <xref:System.Activities.Statements.Sequence> are used to bind to the dependency properties.  \n  \n## To use this sample  \n  \n1.  Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the InteropWith35RuleSet.sln solution file.  \n  \n2.  To build the solution, press CTRL+SHIFT+B.  \n  \n3.  To run the solution, press CTRL+F5.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\Built-InActivities\\InteropWith35RuleSet`  \n  \n## See Also","nodes":[{"pos":[12,78],"content":"Using Variables with a .NET Framework 3.5 Ruleset | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Using Variables with a .NET Framework 3.5 Ruleset | Microsoft Docs","pos":[0,66]}]},{"pos":[343,392],"content":"Using Variables with a .NET Framework 3.5 Ruleset","linkify":"Using Variables with a .NET Framework 3.5 Ruleset","nodes":[{"content":"Using Variables with a .NET Framework 3.5 Ruleset","pos":[0,49]}]},{"content":"This sample demonstrates how to create a workflow that uses the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity to integrate a custom activity written in <ph id=\"ph2\">[!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)]</ph> that uses policy and rules.","pos":[393,647],"source":"This sample demonstrates how to create a workflow that uses the <xref:System.Activities.Statements.Interop> activity to integrate a custom activity written in [!INCLUDE[netfx35_short](../../../../includes/netfx35-short-md.md)] that uses policy and rules."},{"content":"The workflow passes data to the custom activity by binding variables to the dependency properties exposed by the custom activity.","pos":[648,777]},{"pos":[786,804],"content":"Sample walkthrough","linkify":"Sample walkthrough","nodes":[{"content":"Sample walkthrough","pos":[0,18]}]},{"pos":[815,843],"content":"To examine TravelRuleLibrary","linkify":"To examine TravelRuleLibrary","nodes":[{"content":"To examine TravelRuleLibrary","pos":[0,28]}]},{"pos":[853,982],"content":"Using <ph id=\"ph1\">[!INCLUDE[vs_current_short](../../../../includes/vs-current-short-md.md)]</ph>, open the InteropWith35RuleSet.sln solution file.","source":"Using [!INCLUDE[vs_current_short](../../../../includes/vs-current-short-md.md)], open the InteropWith35RuleSet.sln solution file."},{"content":"Open the TravelRuleSet.cs in the workflow designer.","pos":[992,1043]},{"content":"A custom sequential activity that contains a <ph id=\"ph1\">&lt;xref:System.Workflow.Activities.PolicyActivity&gt;</ph> is displayed.","pos":[1054,1161],"source":"A custom sequential activity that contains a <xref:System.Workflow.Activities.PolicyActivity> is displayed."},{"content":"Double-click the DiscountPolicy policy activity to examine the rules.","pos":[1171,1240]},{"content":"The Rules editor pops up to show the rules.","pos":[1251,1294]},{"pos":[1304,1425],"content":"Right click the <ph id=\"ph1\">`DiscountPolicy`</ph> and select the <bpt id=\"p1\">**</bpt>View Code<ept id=\"p1\">**</ept> option to examine the code beside C# code for the activity.","source":"Right click the `DiscountPolicy` and select the **View Code** option to examine the code beside C# code for the activity."},{"content":"Observe the dependency property setting for <ph id=\"ph1\">`DiscountLevel`</ph>.","pos":[1436,1496],"source":"Observe the dependency property setting for `DiscountLevel`."},{"content":"This is equivalent to arguments in <ph id=\"ph1\">[!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)]</ph>.","pos":[1497,1612],"source":" This is equivalent to arguments in [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)]."},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph>arguments, see <bpt id=\"p1\">[</bpt>Variables and Arguments<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/variables-and-arguments.md)</ept>.","pos":[1613,1792],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)]arguments, see [Variables and Arguments](../../../../docs/framework/windows-workflow-foundation/variables-and-arguments.md)."},{"pos":[1801,1821],"content":"InteropWith35RuleSet","linkify":"InteropWith35RuleSet","nodes":[{"content":"InteropWith35RuleSet","pos":[0,20]}]},{"content":"This is a sequential workflow project that uses the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity to integrate with the custom Rule set created in the <ph id=\"ph2\">`TravelRuleLibrary`</ph> project.","pos":[1825,2011],"source":"This is a sequential workflow project that uses the <xref:System.Activities.Statements.Interop> activity to integrate with the custom Rule set created in the `TravelRuleLibrary` project."},{"content":"Variables are created on the top level <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Sequence&gt;</ph> activity.","pos":[2012,2105],"source":" Variables are created on the top level <xref:System.Activities.Statements.Sequence> activity."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity is used to integrate with the <ph id=\"ph2\">`TravelRuleSet`</ph> activity.","pos":[2106,2218],"source":" The <xref:System.Activities.Statements.Interop> activity is used to integrate with the `TravelRuleSet` activity."},{"content":"The variables that are declared on the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Sequence&gt;</ph> are used to bind to the dependency properties.","pos":[2219,2349],"source":" The variables that are declared on the <xref:System.Activities.Statements.Sequence> are used to bind to the dependency properties."},{"pos":[2358,2376],"content":"To use this sample","linkify":"To use this sample","nodes":[{"content":"To use this sample","pos":[0,18]}]},{"pos":[2386,2495],"content":"Using <ph id=\"ph1\">[!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]</ph>, open the InteropWith35RuleSet.sln solution file.","source":"Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the InteropWith35RuleSet.sln solution file."},{"content":"To build the solution, press CTRL+SHIFT+B.","pos":[2505,2547]},{"content":"To run the solution, press CTRL+F5.","pos":[2557,2592]},{"pos":[2600,2732],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[2786,3112],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[3113,3163]},{"pos":[3264,3272],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]}]}