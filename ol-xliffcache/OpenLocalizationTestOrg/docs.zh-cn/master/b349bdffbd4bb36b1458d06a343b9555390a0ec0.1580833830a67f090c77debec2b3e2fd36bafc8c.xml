{"content":"---\ntitle: \"&lt;forcePerformanceCounterUniqueSharedMemoryReads&gt; Element | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"forcePerformanceCounterUniqueSharedMemoryReads element\"\n  - \"<forcePerformanceCounterUniqueSharedMemoryReads> element\"\nms.assetid: 91149858-4810-4f65-9b48-468488172c9b\ncaps.latest.revision: 8\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# &lt;forcePerformanceCounterUniqueSharedMemoryReads&gt; Element\nSpecifies whether PerfCounter.dll uses the CategoryOptions registry setting in a .NET Framework version 1.1 application to determine whether to load performance counter data from category-specific shared memory or global memory.  \n  \n \\<configuration>  \n\\<runtime>  \n\\<forcePerformanceCounterUniqueSharedMemoryReads>  \n  \n## Syntax  \n  \n```  \n<forcePerformanceCounterUniqueSharedMemoryReads   \nenabled=\"true|false\"/>  \n```  \n  \n## Attributes and Elements  \n The following sections describe attributes, child elements, and parent elements.  \n  \n### Attributes  \n  \n|Attribute|Description|  \n|---------------|-----------------|  \n|`enabled`|Required attribute.<br /><br /> Indicates whether PerfCounter.dll uses the CategoryOptions registry setting to determine whether to load performance counter data from category-specific shared memory or global memory.|  \n  \n## enabled Attribute  \n  \n|Value|Description|  \n|-----------|-----------------|  \n|`false`|PerfCounter.dll does not use the CategoryOptions registry setting This is the default.|  \n|`true`|PerfCounter.dll does use the CategoryOptions registry setting.|  \n  \n### Child Elements  \n None.  \n  \n### Parent Elements  \n  \n|Element|Description|  \n|-------------|-----------------|  \n|`configuration`|The root element in every configuration file used by the common language runtime and .NET Framework applications.|  \n|`runtime`|Contains information about assembly binding and garbage collection.|  \n  \n## Remarks  \n In versions of the .NET Framework before the [!INCLUDE[net_v40_long](../../../../../includes/net-v40-long-md.md)], the version of PerfCounter.dll that was loaded corresponded to the runtime that was loaded in the process. If a computer had both the .NET Framework version 1.1 and the [!INCLUDE[dnprdnlong](../../../../../includes/dnprdnlong-md.md)] installed, a .NET Framework 1.1 application would load the .NET Framework 1.1 version of PerfCounter.dll. Starting with the [!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)], the newest installed version of PerfCounter.dll is loaded. This means that a .NET Framework 1.1 application will load the [!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)] version of PerfCounter.dll if the [!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)] is installed on the computer.  \n  \n Starting with the [!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)], when consuming performance counters, PerfCounter.dll checks the CategoryOptions registry entry for each provider to determine whether it should read from category-specific shared memory or global shared memory. The .NET Framework 1.1 PerfCounter.dll does not read that registry entry, because it is not aware of category-specific shared memory; it always reads from global shared memory.  \n  \n For backward compatibility, the [!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)] PerfCounter.dll does not check the CategoryOptions registry entry when running in a .NET Framework 1.1 application. It simply uses global shared memory, just like the .NET Framework 1.1 PerfCounter.dll. However, you can instruct the [!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)] PerfCounter.dll to check the registry setting by enabling the `<forcePerformanceCounterUniqueSharedMemoryReads>` element.  \n  \n> [!NOTE]\n>  Enabling the `<forcePerformanceCounterUniqueSharedMemoryReads>` element does not guarantee that category-specific shared memory will be used. Setting enabled to `true` only causes PerfCounter.dll to reference the CategoryOptions registry setting. The default setting for CategoryOptions is to use category-specific shared memory; however, you can change CategoryOptions to indicate that global shared memory should be used.  \n  \n The registry key that contains the CategoryOptions setting is HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\\\<categoryName\\>\\Performance. By default, CategoryOptions is set to 3, which instructs PerfCounter.dll to use category-specific shared memory. If CategoryOptions is set to 0, PerfCounter.dll uses global shared memory. Instance data will be reused only if the name of the instance being created is identical to the instance being reused. All versions will be able to write to the category. If CategoryOptions is set to 1, global shared memory is used, but instance data can be reused if the category name is the same length as the category being reused.  \n  \n The settings 0 and 1 can lead to memory leaks and the filling up of performance counter memory.  \n  \n## Example  \n The following example shows how to specify that PerfCounter.dll should reference the CategoryOptions registry entry to determine whether it should use category-specific shared memory.  \n  \n```  \n<configuration>  \n  <runtime>  \n    <forcePerformanceCounterUniqueSharedMemoryReads enabled=\"true\"/>  \n  </runtime>  \n</configuration>  \n```  \n  \n## See Also  \n [Runtime Settings Schema](../../../../../docs/framework/configure-apps/file-schema/runtime/index.md)   \n [Configuration File Schema](../../../../../docs/framework/configure-apps/file-schema/index.md)","nodes":[{"pos":[4,590],"nodes":[{"content":"&lt;forcePerformanceCounterUniqueSharedMemoryReads&gt; Element | Microsoft Docs","nodes":[{"pos":[0,79],"content":"&lt;forcePerformanceCounterUniqueSharedMemoryReads&gt; Element | Microsoft Docs","nodes":[{"content":"<ph id=\"ph1\">&amp;lt;</ph>forcePerformanceCounterUniqueSharedMemoryReads<ph id=\"ph2\">&amp;gt;</ph> Element | Microsoft Docs","pos":[0,79],"source":"&lt;forcePerformanceCounterUniqueSharedMemoryReads&gt; Element | Microsoft Docs"}]}],"pos":[6,88],"yaml":true}],"content":"title: \"&lt;forcePerformanceCounterUniqueSharedMemoryReads&gt; Element | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"forcePerformanceCounterUniqueSharedMemoryReads element\"\n  - \"<forcePerformanceCounterUniqueSharedMemoryReads> element\"\nms.assetid: 91149858-4810-4f65-9b48-468488172c9b\ncaps.latest.revision: 8\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[597,659],"content":"&lt;forcePerformanceCounterUniqueSharedMemoryReads&gt; Element","linkify":"&lt;forcePerformanceCounterUniqueSharedMemoryReads&gt; Element","nodes":[{"content":"<ph id=\"ph1\">&amp;lt;</ph>forcePerformanceCounterUniqueSharedMemoryReads<ph id=\"ph2\">&amp;gt;</ph> Element","pos":[0,62],"source":"&lt;forcePerformanceCounterUniqueSharedMemoryReads&gt; Element"}]},{"content":"Specifies whether PerfCounter.dll uses the CategoryOptions registry setting in a .NET Framework version 1.1 application to determine whether to load performance counter data from category-specific shared memory or global memory.","pos":[660,888]},{"content":"<ph id=\"ph1\">\\&lt;</ph>configuration&gt;","pos":[895,911],"source":"\\<configuration>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>runtime&gt;","pos":[914,924],"source":"\\<runtime>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>forcePerformanceCounterUniqueSharedMemoryReads&gt;","pos":[927,976],"source":"\\<forcePerformanceCounterUniqueSharedMemoryReads>"},{"pos":[985,991],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1091,1114],"content":"Attributes and Elements","linkify":"Attributes and Elements","nodes":[{"content":"Attributes and Elements","pos":[0,23]}]},{"content":"The following sections describe attributes, child elements, and parent elements.","pos":[1118,1198]},{"pos":[1208,1218],"content":"Attributes","linkify":"Attributes","nodes":[{"content":"Attributes","pos":[0,10]}]},{"content":"Attribute","pos":[1225,1234]},{"content":"Description","pos":[1235,1246]},{"content":"Required attribute.","pos":[1299,1318]},{"content":"Indicates whether PerfCounter.dll uses the CategoryOptions registry setting to determine whether to load performance counter data from category-specific shared memory or global memory.","pos":[1331,1515]},{"pos":[1525,1542],"content":"enabled Attribute","linkify":"enabled Attribute","nodes":[{"content":"enabled Attribute","pos":[0,17]}]},{"content":"Value","pos":[1549,1554]},{"content":"Description","pos":[1555,1566]},{"content":"PerfCounter.dll does not use the CategoryOptions registry setting This is the default.","pos":[1613,1699]},{"content":"PerfCounter.dll does use the CategoryOptions registry setting.","pos":[1711,1773]},{"pos":[1784,1798],"content":"Child Elements","linkify":"Child Elements","nodes":[{"content":"Child Elements","pos":[0,14]}]},{"content":"None.","pos":[1802,1807]},{"pos":[1817,1832],"content":"Parent Elements","linkify":"Parent Elements","nodes":[{"content":"Parent Elements","pos":[0,15]}]},{"content":"Element","pos":[1839,1846]},{"content":"Description","pos":[1847,1858]},{"content":"The root element in every configuration file used by the common language runtime and .NET Framework applications.","pos":[1915,2028]},{"content":"Contains information about assembly binding and garbage collection.","pos":[2043,2110]},{"pos":[2120,2127],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"In versions of the .NET Framework before the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../../includes/net-v40-long-md.md)]</ph>, the version of PerfCounter.dll that was loaded corresponded to the runtime that was loaded in the process.","pos":[2131,2352],"source":"In versions of the .NET Framework before the [!INCLUDE[net_v40_long](../../../../../includes/net-v40-long-md.md)], the version of PerfCounter.dll that was loaded corresponded to the runtime that was loaded in the process."},{"content":"If a computer had both the .NET Framework version 1.1 and the <ph id=\"ph1\">[!INCLUDE[dnprdnlong](../../../../../includes/dnprdnlong-md.md)]</ph> installed, a .NET Framework 1.1 application would load the .NET Framework 1.1 version of PerfCounter.dll.","pos":[2353,2585],"source":" If a computer had both the .NET Framework version 1.1 and the [!INCLUDE[dnprdnlong](../../../../../includes/dnprdnlong-md.md)] installed, a .NET Framework 1.1 application would load the .NET Framework 1.1 version of PerfCounter.dll."},{"content":"Starting with the <ph id=\"ph1\">[!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)]</ph>, the newest installed version of PerfCounter.dll is loaded.","pos":[2586,2734],"source":" Starting with the [!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)], the newest installed version of PerfCounter.dll is loaded."},{"content":"This means that a .NET Framework 1.1 application will load the <ph id=\"ph1\">[!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)]</ph> version of PerfCounter.dll if the <ph id=\"ph2\">[!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)]</ph> is installed on the computer.","pos":[2735,3003],"source":" This means that a .NET Framework 1.1 application will load the [!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)] version of PerfCounter.dll if the [!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)] is installed on the computer."},{"content":"Starting with the <ph id=\"ph1\">[!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)]</ph>, when consuming performance counters, PerfCounter.dll checks the CategoryOptions registry entry for each provider to determine whether it should read from category-specific shared memory or global shared memory.","pos":[3010,3310],"source":"Starting with the [!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)], when consuming performance counters, PerfCounter.dll checks the CategoryOptions registry entry for each provider to determine whether it should read from category-specific shared memory or global shared memory."},{"content":"The .NET Framework 1.1 PerfCounter.dll does not read that registry entry, because it is not aware of category-specific shared memory; it always reads from global shared memory.","pos":[3311,3487]},{"content":"For backward compatibility, the <ph id=\"ph1\">[!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)]</ph> PerfCounter.dll does not check the CategoryOptions registry entry when running in a .NET Framework 1.1 application.","pos":[3494,3712],"source":"For backward compatibility, the [!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)] PerfCounter.dll does not check the CategoryOptions registry entry when running in a .NET Framework 1.1 application."},{"content":"It simply uses global shared memory, just like the .NET Framework 1.1 PerfCounter.dll.","pos":[3713,3799]},{"content":"However, you can instruct the <ph id=\"ph1\">[!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)]</ph> PerfCounter.dll to check the registry setting by enabling the <ph id=\"ph2\">`&lt;forcePerformanceCounterUniqueSharedMemoryReads&gt;`</ph> element.","pos":[3800,4022],"source":" However, you can instruct the [!INCLUDE[net_v40_short](../../../../../includes/net-v40-short-md.md)] PerfCounter.dll to check the registry setting by enabling the `<forcePerformanceCounterUniqueSharedMemoryReads>` element."},{"pos":[4030,4464],"content":"[!NOTE]\n Enabling the `<forcePerformanceCounterUniqueSharedMemoryReads>` element does not guarantee that category-specific shared memory will be used. Setting enabled to `true` only causes PerfCounter.dll to reference the CategoryOptions registry setting. The default setting for CategoryOptions is to use category-specific shared memory; however, you can change CategoryOptions to indicate that global shared memory should be used.","leadings":["","> "],"nodes":[{"content":"Enabling the `<forcePerformanceCounterUniqueSharedMemoryReads>` element does not guarantee that category-specific shared memory will be used. Setting enabled to `true` only causes PerfCounter.dll to reference the CategoryOptions registry setting. The default setting for CategoryOptions is to use category-specific shared memory; however, you can change CategoryOptions to indicate that global shared memory should be used.","pos":[9,432],"nodes":[{"content":"Enabling the <ph id=\"ph1\">`&lt;forcePerformanceCounterUniqueSharedMemoryReads&gt;`</ph> element does not guarantee that category-specific shared memory will be used.","pos":[0,141],"source":"Enabling the `<forcePerformanceCounterUniqueSharedMemoryReads>` element does not guarantee that category-specific shared memory will be used."},{"content":"Setting enabled to <ph id=\"ph1\">`true`</ph> only causes PerfCounter.dll to reference the CategoryOptions registry setting.","pos":[142,246],"source":" Setting enabled to `true` only causes PerfCounter.dll to reference the CategoryOptions registry setting."},{"content":"The default setting for CategoryOptions is to use category-specific shared memory; however, you can change CategoryOptions to indicate that global shared memory should be used.","pos":[247,423]}]}]},{"content":"The registry key that contains the CategoryOptions setting is HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services<ph id=\"ph1\">\\\\</ph>&lt;categoryName<ph id=\"ph2\">\\&gt;</ph>\\Performance.","pos":[4471,4615],"source":"The registry key that contains the CategoryOptions setting is HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\\\<categoryName\\>\\Performance."},{"content":"By default, CategoryOptions is set to 3, which instructs PerfCounter.dll to use category-specific shared memory.","pos":[4616,4728]},{"content":"If CategoryOptions is set to 0, PerfCounter.dll uses global shared memory.","pos":[4729,4803]},{"content":"Instance data will be reused only if the name of the instance being created is identical to the instance being reused.","pos":[4804,4922]},{"content":"All versions will be able to write to the category.","pos":[4923,4974]},{"content":"If CategoryOptions is set to 1, global shared memory is used, but instance data can be reused if the category name is the same length as the category being reused.","pos":[4975,5138]},{"content":"The settings 0 and 1 can lead to memory leaks and the filling up of performance counter memory.","pos":[5145,5240]},{"pos":[5249,5256],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows how to specify that PerfCounter.dll should reference the CategoryOptions registry entry to determine whether it should use category-specific shared memory.","pos":[5260,5443]},{"pos":[5604,5612],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Runtime Settings Schema<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/runtime/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[5616,5717],"source":"[Runtime Settings Schema](../../../../../docs/framework/configure-apps/file-schema/runtime/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>Configuration File Schema<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/index.md)</ept>","pos":[5721,5815],"source":"[Configuration File Schema](../../../../../docs/framework/configure-apps/file-schema/index.md)"}]}