{"content":"---\ntitle: \".NET Performance Tips\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"C# language, performance\"\n  - \"performance [C#]\"\n  - \"Visual Basic, performance\"\n  - \"performance [Visual Basic]\"\nms.assetid: ae275793-857d-4102-9095-b4c2a02d57f4\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n---\n# .NET Performance Tips\nThe term *performance* generally refers to the execution speed of a program. You can sometimes increase execution speed by following certain basic rules in your source code. In some programs, it is important to examine code closely and use profilers to make sure that it is running as fast as possible. In other programs, you do not have to perform such optimization because the code is running acceptably fast as it is written. This article lists some common areas where performance can suffer and tips for improving it as well as links to additional performance topics. For more information about planning and measuring for performance, see [Performance](../../../docs/framework/performance/index.md)  \n  \n## Boxing and Unboxing  \n It is best to avoid using value types in situations where they must be boxed a high number of times, for example in non-generic collections classes such as <xref:System.Collections.ArrayList?displayProperty=nameWithType>. You can avoid boxing of value types by using generic collections such as <xref:System.Collections.Generic.List%601?displayProperty=nameWithType>. Boxing and unboxing are computationally expensive processes. When a value type is boxed, an entirely new object must be created. This can take up to 20 times longer than a simple reference assignment. When unboxing, the casting process can take four times as long as an assignment. For more information, see [Boxing and Unboxing](~/docs/csharp/programming-guide/types/boxing-and-unboxing.md).  \n  \n## Strings  \n When you concatenate a large number of string variables, for example in a tight loop, use <xref:System.Text.StringBuilder?displayProperty=nameWithType> instead of the C# [+ operator](~/docs/csharp/language-reference/operators/addition-operator.md) or the Visual Basic [Concatenation Operators](~/docs/visual-basic/language-reference/operators/concatenation-operators.md). For more information, see [How to: Concatenate Multiple Strings](../../csharp/how-to/concatenate-multiple-strings.md) and [Concatenation Operators in Visual Basic](~/docs/visual-basic/programming-guide/language-features/operators-and-expressions/concatenation-operators.md).  \n  \n## Destructors  \n Empty destructors should not be used. When a class contains a destructor, an entry is created in the Finalize queue. When the destructor is called, the garbage collector is invoked to process the queue. If the destructor is empty, this simply results in a loss of performance. For more information, see [Destructors](~/docs/csharp/programming-guide/classes-and-structs/destructors.md) and [Object Lifetime: How Objects Are Created and Destroyed](~/docs/visual-basic/programming-guide/language-features/objects-and-classes/object-lifetime-how-objects-are-created-and-destroyed.md).  \n  \n## Other Resources  \n  \n-   [Writing Faster Managed Code: Know What Things Cost](https://go.microsoft.com/fwlink/?LinkId=99294)  \n  \n-   [Writing High-Performance Managed Applications: A Primer](https://go.microsoft.com/fwlink/?LinkId=99295)  \n  \n-   [Garbage Collector Basics and Performance Hints](https://go.microsoft.com/fwlink/?LinkId=99296)  \n  \n-   [Performance Tips and Tricks in .NET Applications](https://go.microsoft.com/fwlink/?LinkId=99297)  \n\n-   [Rico Mariani's Performance Tidbits](https://go.microsoft.com/fwlink/?LinkId=115679)  \n\n-   [Vance Morrison's Blog](https://blogs.msdn.microsoft.com/vancem/)\n  \n## See also\n\n- [Performance](../../../docs/framework/performance/index.md)\n- [Visual Basic Programming Guide](../../visual-basic/programming-guide/index.md)\n- [C# Programming Guide](../../csharp/programming-guide/index.md)\n","nodes":[{"pos":[4,287],"embed":true,"restype":"x-metadata","content":"title: \".NET Performance Tips\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"C# language, performance\"\n  - \"performance [C#]\"\n  - \"Visual Basic, performance\"\n  - \"performance [Visual Basic]\"\nms.assetid: ae275793-857d-4102-9095-b4c2a02d57f4\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"","nodes":[{"content":".NET Performance Tips","nodes":[{"pos":[0,21],"content":".NET Performance Tips","nodes":[{"content":".NET Performance Tips","pos":[0,21]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[294,315],"content":".NET Performance Tips","linkify":".NET Performance Tips","nodes":[{"content":".NET Performance Tips","pos":[0,21]}]},{"content":"The term <bpt id=\"p1\">*</bpt>performance<ept id=\"p1\">*</ept> generally refers to the execution speed of a program.","pos":[316,392],"source":"The term *performance* generally refers to the execution speed of a program."},{"content":"You can sometimes increase execution speed by following certain basic rules in your source code.","pos":[393,489]},{"content":"In some programs, it is important to examine code closely and use profilers to make sure that it is running as fast as possible.","pos":[490,618]},{"content":"In other programs, you do not have to perform such optimization because the code is running acceptably fast as it is written.","pos":[619,744]},{"content":"This article lists some common areas where performance can suffer and tips for improving it as well as links to additional performance topics.","pos":[745,887]},{"content":"For more information about planning and measuring for performance, see <bpt id=\"p1\">[</bpt>Performance<ept id=\"p1\">](../../../docs/framework/performance/index.md)</ept>","pos":[888,1018],"source":" For more information about planning and measuring for performance, see [Performance](../../../docs/framework/performance/index.md)"},{"pos":[1027,1046],"content":"Boxing and Unboxing","linkify":"Boxing and Unboxing","nodes":[{"content":"Boxing and Unboxing","pos":[0,19]}]},{"content":"It is best to avoid using value types in situations where they must be boxed a high number of times, for example in non-generic collections classes such as <ph id=\"ph1\">&lt;xref:System.Collections.ArrayList?displayProperty=nameWithType&gt;</ph>.","pos":[1050,1271],"source":"It is best to avoid using value types in situations where they must be boxed a high number of times, for example in non-generic collections classes such as <xref:System.Collections.ArrayList?displayProperty=nameWithType>."},{"content":"You can avoid boxing of value types by using generic collections such as <ph id=\"ph1\">&lt;xref:System.Collections.Generic.List%601?displayProperty=nameWithType&gt;</ph>.","pos":[1272,1417],"source":" You can avoid boxing of value types by using generic collections such as <xref:System.Collections.Generic.List%601?displayProperty=nameWithType>."},{"content":"Boxing and unboxing are computationally expensive processes.","pos":[1418,1478]},{"content":"When a value type is boxed, an entirely new object must be created.","pos":[1479,1546]},{"content":"This can take up to 20 times longer than a simple reference assignment.","pos":[1547,1618]},{"content":"When unboxing, the casting process can take four times as long as an assignment.","pos":[1619,1699]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Boxing and Unboxing<ept id=\"p1\">](~/docs/csharp/programming-guide/types/boxing-and-unboxing.md)</ept>.","pos":[1700,1810],"source":" For more information, see [Boxing and Unboxing](~/docs/csharp/programming-guide/types/boxing-and-unboxing.md)."},{"pos":[1819,1826],"content":"Strings","linkify":"Strings","nodes":[{"content":"Strings","pos":[0,7]}]},{"content":"When you concatenate a large number of string variables, for example in a tight loop, use <ph id=\"ph1\">&lt;xref:System.Text.StringBuilder?displayProperty=nameWithType&gt;</ph> instead of the C# <bpt id=\"p1\">[</bpt>+ operator<ept id=\"p1\">](~/docs/csharp/language-reference/operators/addition-operator.md)</ept> or the Visual Basic <bpt id=\"p2\">[</bpt>Concatenation Operators<ept id=\"p2\">](~/docs/visual-basic/language-reference/operators/concatenation-operators.md)</ept>.","pos":[1830,2201],"source":"When you concatenate a large number of string variables, for example in a tight loop, use <xref:System.Text.StringBuilder?displayProperty=nameWithType> instead of the C# [+ operator](~/docs/csharp/language-reference/operators/addition-operator.md) or the Visual Basic [Concatenation Operators](~/docs/visual-basic/language-reference/operators/concatenation-operators.md)."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Concatenate Multiple Strings<ept id=\"p1\">](../../csharp/how-to/concatenate-multiple-strings.md)</ept> and <bpt id=\"p2\">[</bpt>Concatenation Operators in Visual Basic<ept id=\"p2\">](~/docs/visual-basic/programming-guide/language-features/operators-and-expressions/concatenation-operators.md)</ept>.","pos":[2202,2476],"source":" For more information, see [How to: Concatenate Multiple Strings](../../csharp/how-to/concatenate-multiple-strings.md) and [Concatenation Operators in Visual Basic](~/docs/visual-basic/programming-guide/language-features/operators-and-expressions/concatenation-operators.md)."},{"pos":[2485,2496],"content":"Destructors","linkify":"Destructors","nodes":[{"content":"Destructors","pos":[0,11]}]},{"content":"Empty destructors should not be used.","pos":[2500,2537]},{"content":"When a class contains a destructor, an entry is created in the Finalize queue.","pos":[2538,2616]},{"content":"When the destructor is called, the garbage collector is invoked to process the queue.","pos":[2617,2702]},{"content":"If the destructor is empty, this simply results in a loss of performance.","pos":[2703,2776]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Destructors<ept id=\"p1\">](~/docs/csharp/programming-guide/classes-and-structs/destructors.md)</ept> and <bpt id=\"p2\">[</bpt>Object Lifetime: How Objects Are Created and Destroyed<ept id=\"p2\">](~/docs/visual-basic/programming-guide/language-features/objects-and-classes/object-lifetime-how-objects-are-created-and-destroyed.md)</ept>.","pos":[2777,3080],"source":" For more information, see [Destructors](~/docs/csharp/programming-guide/classes-and-structs/destructors.md) and [Object Lifetime: How Objects Are Created and Destroyed](~/docs/visual-basic/programming-guide/language-features/objects-and-classes/object-lifetime-how-objects-are-created-and-destroyed.md)."},{"pos":[3089,3104],"content":"Other Resources","linkify":"Other Resources","nodes":[{"content":"Other Resources","pos":[0,15]}]},{"pos":[3114,3213],"content":"<bpt id=\"p1\">[</bpt>Writing Faster Managed Code: Know What Things Cost<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=99294)</ept>","source":"[Writing Faster Managed Code: Know What Things Cost](https://go.microsoft.com/fwlink/?LinkId=99294)"},{"pos":[3223,3327],"content":"<bpt id=\"p1\">[</bpt>Writing High-Performance Managed Applications: A Primer<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=99295)</ept>","source":"[Writing High-Performance Managed Applications: A Primer](https://go.microsoft.com/fwlink/?LinkId=99295)"},{"pos":[3337,3432],"content":"<bpt id=\"p1\">[</bpt>Garbage Collector Basics and Performance Hints<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=99296)</ept>","source":"[Garbage Collector Basics and Performance Hints](https://go.microsoft.com/fwlink/?LinkId=99296)"},{"pos":[3442,3539],"content":"<bpt id=\"p1\">[</bpt>Performance Tips and Tricks in .NET Applications<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=99297)</ept>","source":"[Performance Tips and Tricks in .NET Applications](https://go.microsoft.com/fwlink/?LinkId=99297)"},{"pos":[3547,3631],"content":"<bpt id=\"p1\">[</bpt>Rico Mariani's Performance Tidbits<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=115679)</ept>","source":"[Rico Mariani's Performance Tidbits](https://go.microsoft.com/fwlink/?LinkId=115679)"},{"pos":[3639,3704],"content":"<bpt id=\"p1\">[</bpt>Vance Morrison's Blog<ept id=\"p1\">](https://blogs.msdn.microsoft.com/vancem/)</ept>","source":"[Vance Morrison's Blog](https://blogs.msdn.microsoft.com/vancem/)"},{"pos":[3711,3719],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3723,3782],"content":"<bpt id=\"p1\">[</bpt>Performance<ept id=\"p1\">](../../../docs/framework/performance/index.md)</ept>","source":"[Performance](../../../docs/framework/performance/index.md)"},{"pos":[3785,3864],"content":"<bpt id=\"p1\">[</bpt>Visual Basic Programming Guide<ept id=\"p1\">](../../visual-basic/programming-guide/index.md)</ept>","source":"[Visual Basic Programming Guide](../../visual-basic/programming-guide/index.md)"},{"pos":[3867,3930],"content":"<bpt id=\"p1\">[</bpt>C# Programming Guide<ept id=\"p1\">](../../csharp/programming-guide/index.md)</ept>","source":"[C# Programming Guide](../../csharp/programming-guide/index.md)"}]}