{"content":"---\ntitle: \"Generating Keys for Encryption and Decryption\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"keys, encryption and decryption\"\n  - \"keys, asymmetric\"\n  - \"keys, symmetric\"\n  - \"encryption [.NET Framework], keys\"\n  - \"symmetric keys\"\n  - \"asymmetric keys [.NET Framework]\"\n  - \"cryptography [.NET Framework], keys\"\nms.assetid: c197dfc9-a453-4226-898d-37a16638056e\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Generating Keys for Encryption and Decryption\nCreating and managing keys is an important part of the cryptographic process. Symmetric algorithms require the creation of a key and an initialization vector (IV). The key must be kept secret from anyone who should not decrypt your data. The IV does not have to be secret, but should be changed for each session. Asymmetric algorithms require the creation of a public key and a private key. The public key can be made public to anyone, while the private key must known only by the party who will decrypt the data encrypted with the public key. This section describes how to generate and manage keys for both symmetric and asymmetric algorithms.  \n  \n## Symmetric Keys  \n The symmetric encryption classes supplied by the .NET Framework require a key and a new initialization vector (IV) to encrypt and decrypt data. Whenever you create a new instance of one of the managed symmetric cryptographic classes using the default constructor, a new key and IV are automatically created. Anyone that you allow to decrypt your data must possess the same key and IV and use the same algorithm. Generally, a new key and IV should be created for every session, and neither the key nor IV should be stored for use in a later session.  \n  \n To communicate a symmetric key and IV to a remote party, you would usually encrypt the symmetric key by using asymmetric encryption. Sending the key across an insecure network without encrypting it is unsafe, because anyone who intercepts the key and IV can then decrypt your data. For more information about exchanging data by using encryption, see [Creating a Cryptographic Scheme](../../../docs/standard/security/creating-a-cryptographic-scheme.md).  \n  \n The following example shows the creation of a new instance of the <xref:System.Security.Cryptography.TripleDESCryptoServiceProvider> class that implements the TripleDES algorithm.  \n  \n```vb  \nDim tdes As TripleDESCryptoServiceProvider = new TripleDESCryptoServiceProvider()  \n```  \n  \n```csharp  \nTripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();  \n```  \n  \n When the previous code is executed, a new key and IV are generated and placed in the **Key** and **IV** properties, respectively.  \n  \n Sometimes you might need to generate multiple keys. In this situation, you can create a new instance of a class that implements a symmetric algorithm and then create a new key and IV by calling the **GenerateKey** and **GenerateIV** methods. The following code example illustrates how to create new keys and IVs after a new instance of the symmetric cryptographic class has been made.  \n  \n```vb  \nDim tdes As TripleDESCryptoServiceProvider = new TripleDESCryptoServiceProvider()  \ntdes.GenerateIV()  \ntdes.GenerateKey()  \n```  \n  \n```csharp  \nTripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();  \ntdes.GenerateIV();  \ntdes.GenerateKey();  \n```  \n  \n When the previous code is executed, a key and IV are generated when the new instance of **TripleDESCryptoServiceProvider** is made. Another key and IV are created when the **GenerateKey** and **GenerateIV** methods are called.  \n  \n## Asymmetric Keys  \n The .NET Framework provides the <xref:System.Security.Cryptography.RSACryptoServiceProvider> and <xref:System.Security.Cryptography.DSACryptoServiceProvider> classes for asymmetric encryption. These classes create a public/private key pair when you use the default constructor to create a new instance. Asymmetric keys can be either stored for use in multiple sessions or generated for one session only. While the public key can be made generally available, the private key should be closely guarded.  \n  \n A public/private key pair is generated whenever a new instance of an asymmetric algorithm class is created. After a new instance of the class is created, the key information can be extracted using one of two methods:  \n  \n-   The <xref:System.Security.Cryptography.RSA.ToXmlString%2A> method, which returns an XML representation of the key information.  \n  \n-   The <xref:System.Security.Cryptography.RSACryptoServiceProvider.ExportParameters%2A> method, which returns an <xref:System.Security.Cryptography.RSAParameters> structure that holds the key information.  \n  \n Both methods accept a Boolean value that indicates whether to return only the public key information or to return both the public-key and the private-key information. An **RSACryptoServiceProvider** class can be initialized to the value of an **RSAParameters** structure by using the <xref:System.Security.Cryptography.RSACryptoServiceProvider.ImportParameters%2A> method.  \n  \n Asymmetric private keys should never be stored verbatim or in plain text on the local computer. If you need to store a private key, you should use a key container. For more on how to store a private key in a key container, see [How to: Store Asymmetric Keys in a Key Container](../../../docs/standard/security/how-to-store-asymmetric-keys-in-a-key-container.md).  \n  \n The following code example creates a new instance of the **RSACryptoServiceProvider** class, creating a public/private key pair, and saves the public key information to an **RSAParameters** structure.  \n  \n```vb  \n'Generate a public/private key pair.  \nDim rsa as RSACryptoServiceProvider = new RSACryptoServiceProvider()  \n'Save the public key information to an RSAParameters structure.  \nDim rsaKeyInfo As RSAParameters = rsa.ExportParameters(false)  \n```  \n  \n```csharp  \n//Generate a public/private key pair.  \nRSACryptoServiceProvider rsa = new RSACryptoServiceProvider();  \n//Save the public key information to an RSAParameters structure.  \nRSAParameters rsaKeyInfo = rsa.ExportParameters(false);  \n```  \n  \n## See also\n\n- [Encrypting Data](../../../docs/standard/security/encrypting-data.md)\n- [Decrypting Data](../../../docs/standard/security/decrypting-data.md)\n- [Cryptographic Services](../../../docs/standard/security/cryptographic-services.md)\n- [How to: Store Asymmetric Keys in a Key Container](../../../docs/standard/security/how-to-store-asymmetric-keys-in-a-key-container.md)\n","nodes":[{"pos":[4,478],"embed":true,"restype":"x-metadata","content":"title: \"Generating Keys for Encryption and Decryption\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"keys, encryption and decryption\"\n  - \"keys, asymmetric\"\n  - \"keys, symmetric\"\n  - \"encryption [.NET Framework], keys\"\n  - \"symmetric keys\"\n  - \"asymmetric keys [.NET Framework]\"\n  - \"cryptography [.NET Framework], keys\"\nms.assetid: c197dfc9-a453-4226-898d-37a16638056e\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Generating Keys for Encryption and Decryption","nodes":[{"pos":[0,45],"content":"Generating Keys for Encryption and Decryption","nodes":[{"content":"Generating Keys for Encryption and Decryption","pos":[0,45]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[485,530],"content":"Generating Keys for Encryption and Decryption","linkify":"Generating Keys for Encryption and Decryption","nodes":[{"content":"Generating Keys for Encryption and Decryption","pos":[0,45]}]},{"content":"Creating and managing keys is an important part of the cryptographic process.","pos":[531,608]},{"content":"Symmetric algorithms require the creation of a key and an initialization vector (IV).","pos":[609,694]},{"content":"The key must be kept secret from anyone who should not decrypt your data.","pos":[695,768]},{"content":"The IV does not have to be secret, but should be changed for each session.","pos":[769,843]},{"content":"Asymmetric algorithms require the creation of a public key and a private key.","pos":[844,921]},{"content":"The public key can be made public to anyone, while the private key must known only by the party who will decrypt the data encrypted with the public key.","pos":[922,1074]},{"content":"This section describes how to generate and manage keys for both symmetric and asymmetric algorithms.","pos":[1075,1175]},{"pos":[1184,1198],"content":"Symmetric Keys","linkify":"Symmetric Keys","nodes":[{"content":"Symmetric Keys","pos":[0,14]}]},{"content":"The symmetric encryption classes supplied by the .NET Framework require a key and a new initialization vector (IV) to encrypt and decrypt data.","pos":[1202,1345]},{"content":"Whenever you create a new instance of one of the managed symmetric cryptographic classes using the default constructor, a new key and IV are automatically created.","pos":[1346,1509]},{"content":"Anyone that you allow to decrypt your data must possess the same key and IV and use the same algorithm.","pos":[1510,1613]},{"content":"Generally, a new key and IV should be created for every session, and neither the key nor IV should be stored for use in a later session.","pos":[1614,1750]},{"content":"To communicate a symmetric key and IV to a remote party, you would usually encrypt the symmetric key by using asymmetric encryption.","pos":[1757,1889]},{"content":"Sending the key across an insecure network without encrypting it is unsafe, because anyone who intercepts the key and IV can then decrypt your data.","pos":[1890,2038]},{"content":"For more information about exchanging data by using encryption, see <bpt id=\"p1\">[</bpt>Creating a Cryptographic Scheme<ept id=\"p1\">](../../../docs/standard/security/creating-a-cryptographic-scheme.md)</ept>.","pos":[2039,2209],"source":" For more information about exchanging data by using encryption, see [Creating a Cryptographic Scheme](../../../docs/standard/security/creating-a-cryptographic-scheme.md)."},{"pos":[2216,2395],"content":"The following example shows the creation of a new instance of the <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.TripleDESCryptoServiceProvider&gt;</ph> class that implements the TripleDES algorithm.","source":"The following example shows the creation of a new instance of the <xref:System.Security.Cryptography.TripleDESCryptoServiceProvider> class that implements the TripleDES algorithm."},{"pos":[2602,2731],"content":"When the previous code is executed, a new key and IV are generated and placed in the <bpt id=\"p1\">**</bpt>Key<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>IV<ept id=\"p2\">**</ept> properties, respectively.","source":"When the previous code is executed, a new key and IV are generated and placed in the **Key** and **IV** properties, respectively."},{"content":"Sometimes you might need to generate multiple keys.","pos":[2738,2789]},{"content":"In this situation, you can create a new instance of a class that implements a symmetric algorithm and then create a new key and IV by calling the <bpt id=\"p1\">**</bpt>GenerateKey<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>GenerateIV<ept id=\"p2\">**</ept> methods.","pos":[2790,2979],"source":" In this situation, you can create a new instance of a class that implements a symmetric algorithm and then create a new key and IV by calling the **GenerateKey** and **GenerateIV** methods."},{"content":"The following code example illustrates how to create new keys and IVs after a new instance of the symmetric cryptographic class has been made.","pos":[2980,3122]},{"content":"When the previous code is executed, a key and IV are generated when the new instance of <bpt id=\"p1\">**</bpt>TripleDESCryptoServiceProvider<ept id=\"p1\">**</ept> is made.","pos":[3413,3544],"source":"When the previous code is executed, a key and IV are generated when the new instance of **TripleDESCryptoServiceProvider** is made."},{"content":"Another key and IV are created when the <bpt id=\"p1\">**</bpt>GenerateKey<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>GenerateIV<ept id=\"p2\">**</ept> methods are called.","pos":[3545,3639],"source":" Another key and IV are created when the **GenerateKey** and **GenerateIV** methods are called."},{"pos":[3648,3663],"content":"Asymmetric Keys","linkify":"Asymmetric Keys","nodes":[{"content":"Asymmetric Keys","pos":[0,15]}]},{"content":"The .NET Framework provides the <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.RSACryptoServiceProvider&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Security.Cryptography.DSACryptoServiceProvider&gt;</ph> classes for asymmetric encryption.","pos":[3667,3859],"source":"The .NET Framework provides the <xref:System.Security.Cryptography.RSACryptoServiceProvider> and <xref:System.Security.Cryptography.DSACryptoServiceProvider> classes for asymmetric encryption."},{"content":"These classes create a public/private key pair when you use the default constructor to create a new instance.","pos":[3860,3969]},{"content":"Asymmetric keys can be either stored for use in multiple sessions or generated for one session only.","pos":[3970,4070]},{"content":"While the public key can be made generally available, the private key should be closely guarded.","pos":[4071,4167]},{"content":"A public/private key pair is generated whenever a new instance of an asymmetric algorithm class is created.","pos":[4174,4281]},{"content":"After a new instance of the class is created, the key information can be extracted using one of two methods:","pos":[4282,4390]},{"pos":[4400,4526],"content":"The <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.RSA.ToXmlString%2A&gt;</ph> method, which returns an XML representation of the key information.","source":"The <xref:System.Security.Cryptography.RSA.ToXmlString%2A> method, which returns an XML representation of the key information."},{"pos":[4536,4737],"content":"The <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.RSACryptoServiceProvider.ExportParameters%2A&gt;</ph> method, which returns an <ph id=\"ph2\">&lt;xref:System.Security.Cryptography.RSAParameters&gt;</ph> structure that holds the key information.","source":"The <xref:System.Security.Cryptography.RSACryptoServiceProvider.ExportParameters%2A> method, which returns an <xref:System.Security.Cryptography.RSAParameters> structure that holds the key information."},{"content":"Both methods accept a Boolean value that indicates whether to return only the public key information or to return both the public-key and the private-key information.","pos":[4744,4910]},{"content":"An <bpt id=\"p1\">**</bpt>RSACryptoServiceProvider<ept id=\"p1\">**</ept> class can be initialized to the value of an <bpt id=\"p2\">**</bpt>RSAParameters<ept id=\"p2\">**</ept> structure by using the <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.RSACryptoServiceProvider.ImportParameters%2A&gt;</ph> method.","pos":[4911,5116],"source":" An **RSACryptoServiceProvider** class can be initialized to the value of an **RSAParameters** structure by using the <xref:System.Security.Cryptography.RSACryptoServiceProvider.ImportParameters%2A> method."},{"content":"Asymmetric private keys should never be stored verbatim or in plain text on the local computer.","pos":[5123,5218]},{"content":"If you need to store a private key, you should use a key container.","pos":[5219,5286]},{"content":"For more on how to store a private key in a key container, see <bpt id=\"p1\">[</bpt>How to: Store Asymmetric Keys in a Key Container<ept id=\"p1\">](../../../docs/standard/security/how-to-store-asymmetric-keys-in-a-key-container.md)</ept>.","pos":[5287,5485],"source":" For more on how to store a private key in a key container, see [How to: Store Asymmetric Keys in a Key Container](../../../docs/standard/security/how-to-store-asymmetric-keys-in-a-key-container.md)."},{"pos":[5492,5692],"content":"The following code example creates a new instance of the <bpt id=\"p1\">**</bpt>RSACryptoServiceProvider<ept id=\"p1\">**</ept> class, creating a public/private key pair, and saves the public key information to an <bpt id=\"p2\">**</bpt>RSAParameters<ept id=\"p2\">**</ept> structure.","source":"The following code example creates a new instance of the **RSACryptoServiceProvider** class, creating a public/private key pair, and saves the public key information to an **RSAParameters** structure."},{"pos":[6209,6217],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6221,6290],"content":"<bpt id=\"p1\">[</bpt>Encrypting Data<ept id=\"p1\">](../../../docs/standard/security/encrypting-data.md)</ept>","source":"[Encrypting Data](../../../docs/standard/security/encrypting-data.md)"},{"pos":[6293,6362],"content":"<bpt id=\"p1\">[</bpt>Decrypting Data<ept id=\"p1\">](../../../docs/standard/security/decrypting-data.md)</ept>","source":"[Decrypting Data](../../../docs/standard/security/decrypting-data.md)"},{"pos":[6365,6448],"content":"<bpt id=\"p1\">[</bpt>Cryptographic Services<ept id=\"p1\">](../../../docs/standard/security/cryptographic-services.md)</ept>","source":"[Cryptographic Services](../../../docs/standard/security/cryptographic-services.md)"},{"pos":[6451,6585],"content":"<bpt id=\"p1\">[</bpt>How to: Store Asymmetric Keys in a Key Container<ept id=\"p1\">](../../../docs/standard/security/how-to-store-asymmetric-keys-in-a-key-container.md)</ept>","source":"[How to: Store Asymmetric Keys in a Key Container](../../../docs/standard/security/how-to-store-asymmetric-keys-in-a-key-container.md)"}]}