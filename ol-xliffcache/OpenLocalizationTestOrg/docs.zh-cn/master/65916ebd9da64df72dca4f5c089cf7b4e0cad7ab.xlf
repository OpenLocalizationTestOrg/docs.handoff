<?xml version="1.0"?>
<xliff version="1.2" xmlns="urn:oasis:names:tc:xliff:document:1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xliff:document:1.2 xliff-core-1.2-transitional.xsd">
  <file datatype="xml" original="markdown" source-language="en-US" target-language="zh-cn">
    <header>
      <tool tool-id="mdxliff" tool-name="mdxliff" tool-version="1.0-b81d562" tool-company="Microsoft" />
      <xliffext:olfilehash xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">65916ebd9da64df72dca4f5c089cf7b4e0cad7ab</xliffext:olfilehash>
      <xliffext:olfilepath xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">docs\framework\windows-workflow-foundation\instance-locked-exception-action.md</xliffext:olfilepath>
      <xliffext:oltranslationpriority xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">net-med-mt</xliffext:oltranslationpriority>
      <xliffext:oltranslationtype xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">Machine Translation</xliffext:oltranslationtype>
      <xliffext:olskeletonhash xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">6c528327ecadc3beadb307f2cf84bba4245301a3</xliffext:olskeletonhash>
      <xliffext:olxliffhash xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">19a3c591ed0b7f8b70765ef351aadfe803454a2b</xliffext:olxliffhash>
    </header>
    <body>
      <group id="content" extype="content">
        <trans-unit id="101" translate="yes" xml:space="preserve">
          <source>Instance Locked Exception Action | Microsoft Docs</source>
        </trans-unit>
        <trans-unit id="102" translate="yes" xml:space="preserve">
          <source>Instance Locked Exception Action</source>
        </trans-unit>
        <trans-unit id="103" translate="yes" xml:space="preserve">
          <source>The <ph id="ph1">&lt;xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A&gt;</ph> property of the SQL Workflow Instance Store lets you specify what action the SQL persistence provider should take when it receives an <ph id="ph2">&lt;xref:System.Runtime.DurableInstancing.InstanceLockedException&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="104" translate="yes" xml:space="preserve">
          <source>The persistence provider receives this exception when it tries to lock a workflow service instance that is currently locked by another service host.</source>
        </trans-unit>
        <trans-unit id="105" translate="yes" xml:space="preserve">
          <source>The values for this property are <ph id="ph1">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph>, <ph id="ph2">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph>, and <ph id="ph3">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="106" translate="yes" xml:space="preserve">
          <source>The default value is <ph id="ph1">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="107" translate="yes" xml:space="preserve">
          <source>The following list describes the three options:</source>
        </trans-unit>
        <trans-unit id="108" translate="yes" xml:space="preserve">
          <source><ph id="ph1">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="109" translate="yes" xml:space="preserve">
          <source>The service host does not attempt to lock the workflow service instance and passes the <ph id="ph1">&lt;xref:System.Runtime.DurableInstancing.InstanceLockedException&gt;</ph> to the caller.</source>
        </trans-unit>
        <trans-unit id="110" translate="yes" xml:space="preserve">
          <source>If your workflow stays in memory for a period exceeding 60 seconds, use <ph id="ph1">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph> as the retry.</source>
        </trans-unit>
        <trans-unit id="111" translate="yes" xml:space="preserve">
          <source>The default value is <ph id="ph1">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="112" translate="yes" xml:space="preserve">
          <source><ph id="ph1">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="113" translate="yes" xml:space="preserve">
          <source>The service host reattempts to lock the workflow service instance with a linear interval between retry attempts and passes the <ph id="ph1">&lt;xref:System.Runtime.DurableInstancing.InstanceLockedException&gt;</ph> to the caller at the end of the sequence.</source>
        </trans-unit>
        <trans-unit id="114" translate="yes" xml:space="preserve">
          <source>If you workflow stays in memory approximately between 5-60 seconds, and messages arrive in batches where it is more likely for messages being sent to the same instance on the same host to process all messages before unloading the workflow, use <ph id="ph1">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph> to achieve the best latency without wasting resources.</source>
        </trans-unit>
        <trans-unit id="115" translate="yes" xml:space="preserve">
          <source><ph id="ph1">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="116" translate="yes" xml:space="preserve">
          <source>The service host reattempts to lock the workflow service instance with an exponential backoff interval between retry attempts, and passes the exception to the caller at the end of the sequence.</source>
        </trans-unit>
        <trans-unit id="117" translate="yes" xml:space="preserve">
          <source>If your workflow stays in memory for a very short time (less than 5 seconds), or a Web farm is large and the chance of another message being delivered to the same host is not very high, use <ph id="ph1">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph> to achieve the best latency.</source>
        </trans-unit>
        <trans-unit id="118" translate="yes" xml:space="preserve">
          <source>The Instance Locked Exception Action feature supports the following scenarios.</source>
        </trans-unit>
        <trans-unit id="119" translate="yes" xml:space="preserve">
          <source>In all scenarios, if the instanceLockedExceptionAction property of the SqlWorkflowInstanceStore is set to <ph id="ph1">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph> or <ph id="ph2">&lt;xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction&gt;</ph>, the host transparently retries to acquire the lock on instances periodically.</source>
        </trans-unit>
        <trans-unit id="120" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Enabling graceful shutdown and overlapped recycling of application domains.<ept id="p1">**</ept></source>
        </trans-unit>
        <trans-unit id="121" translate="yes" xml:space="preserve">
          <source>Suppose an <bpt id="p1">**</bpt>AppDomain<ept id="p1">**</ept> with a service host running workflow service instances is being recycled and a new <bpt id="p2">**</bpt>AppDomain<ept id="p2">**</ept> is brought up to handle new requests in parallel while the old <bpt id="p3">**</bpt>AppDomain<ept id="p3">**</ept> is brought down gracefully.</source>
        </trans-unit>
        <trans-unit id="122" translate="yes" xml:space="preserve">
          <source>The shutdown waits until workflow service instances are idle, and then persists and unloads the instances.</source>
        </trans-unit>
        <trans-unit id="123" translate="yes" xml:space="preserve">
          <source>Any attempts by hosts in the new <bpt id="p1">**</bpt>AppDomain<ept id="p1">**</ept> to lock an instance will cause an <ph id="ph1">&lt;xref:System.Runtime.DurableInstancing.InstanceLockedException&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="124" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Horizontally scaling durable workflows across a homogeneous farm of servers.<ept id="p1">**</ept></source>
        </trans-unit>
        <trans-unit id="125" translate="yes" xml:space="preserve">
          <source>Suppose a node of a server farm on which a workflow instance is running crashes and the workflow host cannot remove locks on the instance it is running.</source>
        </trans-unit>
        <trans-unit id="126" translate="yes" xml:space="preserve">
          <source>When a service host running on another node of the farm receives a message for that workflow instance, it tries to acquire locks on these instances it will receive the <ph id="ph1">&lt;xref:System.Runtime.DurableInstancing.InstanceLockedException&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="127" translate="yes" xml:space="preserve">
          <source>The locks will expire after some time because the host that was supposed to renew the lock no longer exists.</source>
        </trans-unit>
        <trans-unit id="128" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Horizontally scaling durable workflows across a homogeneous farm of servers.<ept id="p1">**</ept></source>
        </trans-unit>
        <trans-unit id="129" translate="yes" xml:space="preserve">
          <source>Suppose you want to horizontally scale a durable workflow using multiple hosts behind a NLB (Network Load Balancer), the workflow host running on one node of the farm loads a workflow instance and is processing a message, and the next message to the instance is routed to the host that is running on another node because the NLB does not have routing algorithm to deliver messages to the host that is already running the instance.</source>
        </trans-unit>
        <trans-unit id="130" translate="yes" xml:space="preserve">
          <source>Upon receiving the message, the second host attempts to load the workflow instance and receives the <ph id="ph1">&lt;xref:System.Runtime.DurableInstancing.InstanceLockedException&gt;</ph> because the first host has a lock on the instance.</source>
        </trans-unit>
        <trans-unit id="131" translate="yes" xml:space="preserve">
          <source>The first host unlocks the instance when it is finished with processing the first message and the second host acquires the lock when it retries the next time, loads the instance, and processes the second message.</source>
        </trans-unit>
      </group>
    </body>
  </file>
</xliff>