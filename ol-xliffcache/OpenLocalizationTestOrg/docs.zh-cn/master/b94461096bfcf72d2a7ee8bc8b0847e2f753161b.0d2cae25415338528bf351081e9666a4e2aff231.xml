{"content":"---\ntitle: \"Using Serviced Components with the Global Assembly Cache | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"assemblies [.NET Framework], global assembly cache\"\n  - \"GAC (global assembly cache), serviced components\"\n  - \"serviced components, global assembly cache\"\n  - \"global assembly cache, serviced components\"\nms.assetid: 3423e5d9-234c-4571-8161-e35f6d130128\ncaps.latest.revision: 8\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Using Serviced Components with the Global Assembly Cache\nServiced components (managed code COM+ components) should be put in the global assembly cache. In some scenarios, the common language runtime and COM+ Services can handle serviced components that are not in the global assembly cache; in other scenarios, they cannot. The following scenarios illustrate this:  \n  \n-   For serviced components in a COM+ Server application, the assembly containing the components must be in the global assembly cache, because Dllhost.exe does not run in the same directory as the one that contains the serviced components.  \n  \n-   For serviced components in a COM+ Library application, the runtime and COM+ Services can resolve the reference to the assembly containing the components by searching in the current directory. In this case, the assembly does not have to be in the global assembly cache.  \n  \n-   For serviced components in an ASP.NET application, the situation is different. If you place the assembly containing the serviced components in the bin directory of the application base and use on-demand registration, the assembly will be shadow-copied into the download cache because ASP.NET leverages the shadow capabilities of the runtime.  \n  \n## See Also  \n [Working with Assemblies and the Global Assembly Cache](../../../docs/framework/app-domains/working-with-assemblies-and-the-gac.md)   \n [Gacutil.exe (Global Assembly Cache Tool)](../../../docs/framework/tools/gacutil-exe-gac-tool.md)","nodes":[{"pos":[4,613],"nodes":[{"content":"Using Serviced Components with the Global Assembly Cache | Microsoft Docs","nodes":[{"pos":[0,73],"content":"Using Serviced Components with the Global Assembly Cache | Microsoft Docs","nodes":[{"content":"Using Serviced Components with the Global Assembly Cache | Microsoft Docs","pos":[0,73]}]}],"pos":[6,82],"yaml":true}],"content":"title: \"Using Serviced Components with the Global Assembly Cache | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"assemblies [.NET Framework], global assembly cache\"\n  - \"GAC (global assembly cache), serviced components\"\n  - \"serviced components, global assembly cache\"\n  - \"global assembly cache, serviced components\"\nms.assetid: 3423e5d9-234c-4571-8161-e35f6d130128\ncaps.latest.revision: 8\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[620,676],"content":"Using Serviced Components with the Global Assembly Cache","linkify":"Using Serviced Components with the Global Assembly Cache","nodes":[{"content":"Using Serviced Components with the Global Assembly Cache","pos":[0,56]}]},{"content":"Serviced components (managed code COM+ components) should be put in the global assembly cache.","pos":[677,771]},{"content":"In some scenarios, the common language runtime and COM+ Services can handle serviced components that are not in the global assembly cache; in other scenarios, they cannot.","pos":[772,943]},{"content":"The following scenarios illustrate this:","pos":[944,984]},{"content":"For serviced components in a COM+ Server application, the assembly containing the components must be in the global assembly cache, because Dllhost.exe does not run in the same directory as the one that contains the serviced components.","pos":[994,1229]},{"content":"For serviced components in a COM+ Library application, the runtime and COM+ Services can resolve the reference to the assembly containing the components by searching in the current directory.","pos":[1239,1430]},{"content":"In this case, the assembly does not have to be in the global assembly cache.","pos":[1431,1507]},{"content":"For serviced components in an ASP.NET application, the situation is different.","pos":[1517,1595]},{"content":"If you place the assembly containing the serviced components in the bin directory of the application base and use on-demand registration, the assembly will be shadow-copied into the download cache because ASP.NET leverages the shadow capabilities of the runtime.","pos":[1596,1858]},{"pos":[1867,1875],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Working with Assemblies and the Global Assembly Cache<ept id=\"p1\">](../../../docs/framework/app-domains/working-with-assemblies-and-the-gac.md)</ept><ph id=\"ph1\"> </ph>","pos":[1879,2011],"source":"[Working with Assemblies and the Global Assembly Cache](../../../docs/framework/app-domains/working-with-assemblies-and-the-gac.md) "},{"content":"<bpt id=\"p1\">[</bpt>Gacutil.exe (Global Assembly Cache Tool)<ept id=\"p1\">](../../../docs/framework/tools/gacutil-exe-gac-tool.md)</ept>","pos":[2015,2112],"source":"[Gacutil.exe (Global Assembly Cache Tool)](../../../docs/framework/tools/gacutil-exe-gac-tool.md)"}]}