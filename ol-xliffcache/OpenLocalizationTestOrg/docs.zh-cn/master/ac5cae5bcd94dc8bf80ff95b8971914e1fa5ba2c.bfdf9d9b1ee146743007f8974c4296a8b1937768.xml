{"content":"---\ntitle: \"How to: Hit Test Using a Win32 Host Container\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"hit tests [WPF], using Win32 host containers\"\n  - \"visual objects [WPF], hit tests on\"\n  - \"Win32 host containers [WPF], hit tests using\"\nms.assetid: 9491f7f3-d8ba-4573-a888-2f064d1349dc\n---\n# How to: Hit Test Using a Win32 Host Container\nYou can create visual objects within a [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] window by providing a host window container for the visual objects. To provide event handling for the contained visual objects you process the messages passed to the host window container’s message filter loop. Refer to [Tutorial: Hosting Visual Objects in a Win32 Application](tutorial-hosting-visual-objects-in-a-win32-application.md) for more information on how to host visual objects in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.  \n  \n## Example  \n The following code shows how to set up mouse event handlers for a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is used as a host container for visual objects.  \n  \n [!code-csharp[VisualsHitTesting#103](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsHitTesting/CSharp/MyWindow.cs#103)]\n [!code-vb[VisualsHitTesting#103](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsHitTesting/VisualBasic/MyWindow.vb#103)]  \n  \n The following example shows how to set up a hit test in response to trapping specific mouse events.  \n  \n [!code-csharp[VisualsHitTesting#104](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsHitTesting/CSharp/MyCircle.cs#104)]\n [!code-vb[VisualsHitTesting#104](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsHitTesting/VisualBasic/MyCircle.vb#104)]  \n  \n The <xref:System.Windows.Interop.HwndSource> object presents [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] content within a [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] window. The value of the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource> object represents the top-most node in the visual tree hierarchy.  \n  \n For the complete sample on hit testing objects using a Win32 host container, see [Hit Test with Win32 Interoperation Sample](https://go.microsoft.com/fwlink/?LinkID=159995).  \n  \n## See also\n\n- <xref:System.Windows.Interop.HwndSource>\n- [Hit Testing in the Visual Layer](hit-testing-in-the-visual-layer.md)\n- [Tutorial: Hosting Visual Objects in a Win32 Application](tutorial-hosting-visual-objects-in-a-win32-application.md)\n","nodes":[{"pos":[4,328],"embed":true,"restype":"x-metadata","content":"title: \"How to: Hit Test Using a Win32 Host Container\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"hit tests [WPF], using Win32 host containers\"\n  - \"visual objects [WPF], hit tests on\"\n  - \"Win32 host containers [WPF], hit tests using\"\nms.assetid: 9491f7f3-d8ba-4573-a888-2f064d1349dc","nodes":[{"content":"How to: Hit Test Using a Win32 Host Container","nodes":[{"pos":[0,45],"content":"How to: Hit Test Using a Win32 Host Container","nodes":[{"content":"How to: Hit Test Using a Win32 Host Container","pos":[0,45]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[335,380],"content":"How to: Hit Test Using a Win32 Host Container","linkify":"How to: Hit Test Using a Win32 Host Container","nodes":[{"content":"How to: Hit Test Using a Win32 Host Container","pos":[0,45]}]},{"content":"You can create visual objects within a <ph id=\"ph1\">[!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)]</ph> window by providing a host window container for the visual objects.","pos":[381,559],"source":"You can create visual objects within a [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] window by providing a host window container for the visual objects."},{"content":"To provide event handling for the contained visual objects you process the messages passed to the host window container’s message filter loop.","pos":[560,702]},{"content":"Refer to <bpt id=\"p1\">[</bpt>Tutorial: Hosting Visual Objects in a Win32 Application<ept id=\"p1\">](tutorial-hosting-visual-objects-in-a-win32-application.md)</ept> for more information on how to host visual objects in a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window.","pos":[703,966],"source":" Refer to [Tutorial: Hosting Visual Objects in a Win32 Application](tutorial-hosting-visual-objects-in-a-win32-application.md) for more information on how to host visual objects in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window."},{"pos":[975,982],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[986,1185],"content":"The following code shows how to set up mouse event handlers for a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window that is used as a host container for visual objects.","source":"The following code shows how to set up mouse event handlers for a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is used as a host container for visual objects."},{"content":"The following example shows how to set up a hit test in response to trapping specific mouse events.","pos":[1449,1548]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object presents <ph id=\"ph2\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> content within a <ph id=\"ph3\">[!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)]</ph> window.","pos":[1812,2049],"source":"The <xref:System.Windows.Interop.HwndSource> object presents [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] content within a [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] window."},{"content":"The value of the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource.RootVisual%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object represents the top-most node in the visual tree hierarchy.","pos":[2050,2244],"source":" The value of the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource> object represents the top-most node in the visual tree hierarchy."},{"pos":[2251,2424],"content":"For the complete sample on hit testing objects using a Win32 host container, see <bpt id=\"p1\">[</bpt>Hit Test with Win32 Interoperation Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159995)</ept>.","source":"For the complete sample on hit testing objects using a Win32 host container, see [Hit Test with Win32 Interoperation Sample](https://go.microsoft.com/fwlink/?LinkID=159995)."},{"pos":[2433,2441],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2488,2557],"content":"<bpt id=\"p1\">[</bpt>Hit Testing in the Visual Layer<ept id=\"p1\">](hit-testing-in-the-visual-layer.md)</ept>","source":"[Hit Testing in the Visual Layer](hit-testing-in-the-visual-layer.md)"},{"pos":[2560,2676],"content":"<bpt id=\"p1\">[</bpt>Tutorial: Hosting Visual Objects in a Win32 Application<ept id=\"p1\">](tutorial-hosting-visual-objects-in-a-win32-application.md)</ept>","source":"[Tutorial: Hosting Visual Objects in a Win32 Application](tutorial-hosting-visual-objects-in-a-win32-application.md)"}]}