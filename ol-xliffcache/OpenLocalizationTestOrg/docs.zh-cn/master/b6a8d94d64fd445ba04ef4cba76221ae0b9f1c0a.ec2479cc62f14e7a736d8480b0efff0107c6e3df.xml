{"content":"---\ntitle: \"Walkthrough: Persisting an Object in Visual Studio (C#) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"get-started-article\"\ndev_langs: \n  - \"CSharp\"\nms.assetid: a544ce46-ee25-49da-afd4-457a3d59bf63\ncaps.latest.revision: 3\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Walkthrough: Persisting an Object in Visual Studio (C#)\nAlthough you can set an object's properties to default values at design time, any values entered at run time are lost when the object is destroyed. You can use serialization to persist an object's data between instances, which enables you to store values and retrieve them the next time that the object is instantiated.  \n  \n In this walkthrough, you will create a simple `Loan` object and persist its data to a file. You will then retrieve the data from the file when you re-create the object.  \n  \n> [!IMPORTANT]\n>  This example creates a new file if the file does not already exist. If an application must create a file, that application must `Create` permission for the folder. Permissions are set by using access control lists. If the file already exists, the application needs only `Write` permission, a lesser permission. Where possible, it is more secure to create the file during deployment, and only grant `Read` permissions to a single file (instead of Create permissions for a folder). Also, it is more secure to write data to user folders than to the root folder or the Program Files folder.  \n  \n> [!IMPORTANT]\n>  This example stores data in a binary format file. These formats should not be used for sensitive data, such as passwords or credit-card information.  \n  \n> [!NOTE]\n>  The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, click **Import and Export Settings** on the **Tools** menu. For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  \n  \n## Creating the Loan Object  \n The first step is to create a `Loan` class and a test application that uses the class.  \n  \n### To create the Loan class  \n  \n1.  Create a new Class Library project and name it \"LoanClass\". For more information, see [Creating Solutions and Projects](https://docs.microsoft.com/visualstudio/ide/creating-solutions-and-projects).  \n  \n2.  In **Solution Explorer**, open the shortcut menu for the Class1 file and choose **Rename**. Rename the file to `Loan` and press ENTER. Renaming the file will also rename the class to `Loan`.  \n  \n3.  Add the following public members to the class:  \n  \n    ```csharp  \n    public class Loan : System.ComponentModel.INotifyPropertyChanged  \n    {  \n        public double LoanAmount {get; set;}  \n        public double InterestRate {get; set;}  \n        public int Term {get; set;}  \n  \n        private string p_Customer;  \n        public string Customer  \n        {  \n            get { return p_Customer; }  \n            set   \n            {  \n                p_Customer = value;  \n                PropertyChanged(this,  \n                  new System.ComponentModel.PropertyChangedEventArgs(\"Customer\"));  \n            }  \n        }  \n  \n        public event System.ComponentModel.PropertyChangedEventHandler PropertyChanged;  \n  \n        public Loan(double loanAmount,  \n                    double interestRate,  \n                    int term,  \n                    string customer)  \n        {  \n            this.LoanAmount = loanAmount;  \n            this.InterestRate = interestRate;  \n            this.Term = term;  \n            p_Customer = customer;  \n        }  \n    }  \n    ```  \n  \n You will also have to create a simple application that uses the `Loan` class.  \n  \n### To create a test application  \n  \n1.  To add a Windows Forms Application project to your solution, on the **File** menu, choose **Add**, **New Project**.  \n  \n2.  In the **Add New Project** dialog box, choose **Windows Forms Application**, and enter `LoanApp` as the name of the project, and then click **OK** to close the dialog box.  \n  \n3.  In **Solution Explorer**, choose the LoanApp project.  \n  \n4.  On the **Project** menu, choose **Set as StartUp Project**.  \n  \n5.  On the **Project** menu, choose **Add Reference**.  \n  \n6.  In the **Add Reference** dialog box, choose the **Projects** tab and then choose the LoanClass project.  \n  \n7.  Click **OK** to close the dialog box.  \n  \n8.  In the designer, add four <xref:System.Windows.Forms.TextBox> controls to the form.  \n  \n9. In the Code Editor, add the following code:  \n  \n    ```csharp  \n    private LoanClass.Loan TestLoan = new LoanClass.Loan(10000.0, 0.075, 36, \"Neil Black\");  \n  \n    private void Form1_Load(object sender, EventArgs e)  \n    {  \n        textBox1.Text = TestLoan.LoanAmount.ToString();  \n        textBox2.Text = TestLoan.InterestRate.ToString();  \n        textBox3.Text = TestLoan.Term.ToString();  \n        textBox4.Text = TestLoan.Customer;  \n    }  \n    ```  \n  \n10. Add an event handler for the `PropertyChanged` event to the form by using the following code:  \n  \n    ```csharp  \n    private void CustomerPropertyChanged(object sender,   \n        System.ComponentModel.PropertyChangedEventArgs e)  \n    {  \n        MessageBox.Show(e.PropertyName + \" has been changed.\");  \n    }  \n    ```  \n  \n At this point, you can build and run the application. Note that the default values from the `Loan` class appear in the text boxes. Try to change the interest-rate value from 7.5 to 7.1, and then close the application and run it again—the value reverts to the default of 7.5.  \n  \n In the real world, interest rates change periodically, but not necessarily every time that the application is run. Rather than making the user update the interest rate every time that the application runs, it is better to preserve the most recent interest rate between instances of the application. In the next step, you will do just that by adding serialization to the Loan class.  \n  \n## Using Serialization to Persist the Object  \n In order to persist the values for the Loan class, you must first mark the class with the `Serializable` attribute.  \n  \n### To mark a class as serializable  \n  \n-   Change the class declaration for the Loan class as follows:  \n  \n    ```csharp  \n    [Serializable()]  \n    public class Loan : System.ComponentModel.INotifyPropertyChanged  \n    {  \n    ```  \n  \n The `Serializable` attribute tells the compiler that everything in the class can be persisted to a file. Because the `PropertyChanged` event is handled by a Windows Form object, it cannot be serialized. The `NonSerialized` attribute can be used to mark class members that should not be persisted.  \n  \n### To prevent a member from being serialized  \n  \n-   Change the declaration for the `PropertyChanged` event as follows:  \n  \n    ```csharp  \n    [field: NonSerialized()]  \n    public event System.ComponentModel.PropertyChangedEventHandler PropertyChanged;  \n    ```  \n  \n The next step is to add the serialization code to the LoanApp application. In order to serialize the class and write it to a file, you will use the <xref:System.IO> and <xref:System.Xml.Serialization> namespaces. To avoid typing the fully qualified names, you can add references to the necessary class libraries.  \n  \n### To add references to namespaces  \n  \n-   Add the following statements to the top of the `Form1` class:  \n  \n    ```csharp  \n    using System.IO;  \n    using System.Runtime.Serialization.Formatters.Binary;  \n    ```  \n  \n     In this case, you are using a binary formatter to save the object in a binary format.  \n  \n The next step is to add code to deserialize the object from the file when the object is created.  \n  \n### To deserialize an object  \n  \n1.  Add a constant to the class for the serialized data's file name.  \n  \n    ```csharp  \n    const string FileName = @\"..\\..\\SavedLoan.bin\";  \n    ```  \n  \n2.  Modify the code in the `Form1_Load` event procedure as follows:  \n  \n    ```csharp  \n    private LoanClass.Loan TestLoan = new LoanClass.Loan(10000.0, 0.075, 36, \"Neil Black\");  \n  \n    private void Form1_Load(object sender, EventArgs e)  \n    {  \n        if (File.Exists(FileName))  \n        {  \n            Stream TestFileStream = File.OpenRead(FileName);  \n            BinaryFormatter deserializer = new BinaryFormatter();  \n            TestLoan = (LoanClass.Loan)deserializer.Deserialize(TestFileStream);  \n            TestFileStream.Close();  \n        }  \n  \n        TestLoan.PropertyChanged += this.CustomerPropertyChanged;  \n  \n        textBox1.Text = TestLoan.LoanAmount.ToString();  \n        textBox2.Text = TestLoan.InterestRate.ToString();  \n        textBox3.Text = TestLoan.Term.ToString();  \n        textBox4.Text = TestLoan.Customer;  \n    }  \n    ```  \n  \n     Note that you first must check that the file exists. If it exists, create a <xref:System.IO.Stream> class to read the binary file and a <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter> class to translate the file. You also need to convert from the stream type to the Loan object type.  \n  \n Next you must add code to save the data entered in the text boxes to the `Loan` class, and then you must serialize the class to a file.  \n  \n### To save the data and serialize the class  \n  \n-   Add the following code to the `Form1_FormClosing` event procedure:  \n  \n    ```csharp  \n    private void Form1_FormClosing(object sender, FormClosingEventArgs e)  \n    {  \n        TestLoan.LoanAmount = Convert.ToDouble(textBox1.Text);  \n        TestLoan.InterestRate = Convert.ToDouble(textBox2.Text);  \n        TestLoan.Term = Convert.ToInt32(textBox3.Text);  \n        TestLoan.Customer = textBox4.Text;  \n  \n        Stream TestFileStream = File.Create(FileName);  \n        BinaryFormatter serializer = new BinaryFormatter();  \n        serializer.Serialize(TestFileStream, TestLoan);  \n        TestFileStream.Close();  \n    }  \n    ```  \n  \n At this point, you can again build and run the application. Initially, the default values appear in the text boxes. Try to change the values and enter a name in the fourth text box. Close the application and then run it again. Note that the new values now appear in the text boxes.  \n  \n## See Also  \n [Serialization (C# )](../../../../csharp/programming-guide/concepts/serialization/index.md)   \n [C# Programming Guide](../../../../csharp/programming-guide/index.md)\n","nodes":[{"pos":[4,448],"nodes":[{"content":"Walkthrough: Persisting an Object in Visual Studio (C#) | Microsoft Docs","nodes":[{"pos":[0,72],"content":"Walkthrough: Persisting an Object in Visual Studio (C#) | Microsoft Docs","nodes":[{"content":"Walkthrough: Persisting an Object in Visual Studio (C#) | Microsoft Docs","pos":[0,72]}]}],"pos":[6,81],"yaml":true}],"content":"title: \"Walkthrough: Persisting an Object in Visual Studio (C#) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"get-started-article\"\ndev_langs: \n  - \"CSharp\"\nms.assetid: a544ce46-ee25-49da-afd4-457a3d59bf63\ncaps.latest.revision: 3\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"","yamlblock":true},{"pos":[455,510],"content":"Walkthrough: Persisting an Object in Visual Studio (C#)","linkify":"Walkthrough: Persisting an Object in Visual Studio (C#)","nodes":[{"content":"Walkthrough: Persisting an Object in Visual Studio (C#)","pos":[0,55]}]},{"content":"Although you can set an object's properties to default values at design time, any values entered at run time are lost when the object is destroyed.","pos":[511,658]},{"content":"You can use serialization to persist an object's data between instances, which enables you to store values and retrieve them the next time that the object is instantiated.","pos":[659,830]},{"content":"In this walkthrough, you will create a simple <ph id=\"ph1\">`Loan`</ph> object and persist its data to a file.","pos":[837,928],"source":"In this walkthrough, you will create a simple `Loan` object and persist its data to a file."},{"content":"You will then retrieve the data from the file when you re-create the object.","pos":[929,1005]},{"pos":[1013,1615],"content":"[!IMPORTANT]\n This example creates a new file if the file does not already exist. If an application must create a file, that application must `Create` permission for the folder. Permissions are set by using access control lists. If the file already exists, the application needs only `Write` permission, a lesser permission. Where possible, it is more secure to create the file during deployment, and only grant `Read` permissions to a single file (instead of Create permissions for a folder). Also, it is more secure to write data to user folders than to the root folder or the Program Files folder.","leadings":["","> "],"nodes":[{"content":"This example creates a new file if the file does not already exist. If an application must create a file, that application must `Create` permission for the folder. Permissions are set by using access control lists. If the file already exists, the application needs only `Write` permission, a lesser permission. Where possible, it is more secure to create the file during deployment, and only grant `Read` permissions to a single file (instead of Create permissions for a folder). Also, it is more secure to write data to user folders than to the root folder or the Program Files folder.","pos":[14,600],"nodes":[{"content":"This example creates a new file if the file does not already exist.","pos":[0,67]},{"content":"If an application must create a file, that application must <ph id=\"ph1\">`Create`</ph> permission for the folder.","pos":[68,163],"source":" If an application must create a file, that application must `Create` permission for the folder."},{"content":"Permissions are set by using access control lists.","pos":[164,214]},{"content":"If the file already exists, the application needs only <ph id=\"ph1\">`Write`</ph> permission, a lesser permission.","pos":[215,310],"source":" If the file already exists, the application needs only `Write` permission, a lesser permission."},{"content":"Where possible, it is more secure to create the file during deployment, and only grant <ph id=\"ph1\">`Read`</ph> permissions to a single file (instead of Create permissions for a folder).","pos":[311,479],"source":" Where possible, it is more secure to create the file during deployment, and only grant `Read` permissions to a single file (instead of Create permissions for a folder)."},{"content":"Also, it is more secure to write data to user folders than to the root folder or the Program Files folder.","pos":[480,586]}]}]},{"pos":[1623,1787],"content":"[!IMPORTANT]\n This example stores data in a binary format file. These formats should not be used for sensitive data, such as passwords or credit-card information.","leadings":["","> "],"nodes":[{"content":"This example stores data in a binary format file. These formats should not be used for sensitive data, such as passwords or credit-card information.","pos":[14,162],"nodes":[{"content":"This example stores data in a binary format file.","pos":[0,49]},{"content":"These formats should not be used for sensitive data, such as passwords or credit-card information.","pos":[50,148]}]}]},{"pos":[1795,2170],"content":"[!NOTE]\n The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, click **Import and Export Settings** on the **Tools** menu. For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3).","leadings":["","> "],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, click **Import and Export Settings** on the **Tools** menu. For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3).","pos":[9,373],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition.","pos":[0,130]},{"content":"To change your settings, click <bpt id=\"p1\">**</bpt>Import and Export Settings<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Tools<ept id=\"p2\">**</ept> menu.","pos":[131,215],"source":" To change your settings, click **Import and Export Settings** on the **Tools** menu."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Customizing Development Settings in Visual Studio<ept id=\"p1\">](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3)</ept>.","pos":[216,364],"source":" For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/en-us/22c4debb-4e31-47a8-8f19-16f328d7dcd3)."}]}]},{"pos":[2179,2203],"content":"Creating the Loan Object","linkify":"Creating the Loan Object","nodes":[{"content":"Creating the Loan Object","pos":[0,24]}]},{"pos":[2207,2293],"content":"The first step is to create a <ph id=\"ph1\">`Loan`</ph> class and a test application that uses the class.","source":"The first step is to create a `Loan` class and a test application that uses the class."},{"pos":[2303,2327],"content":"To create the Loan class","linkify":"To create the Loan class","nodes":[{"content":"To create the Loan class","pos":[0,24]}]},{"content":"Create a new Class Library project and name it \"LoanClass\".","pos":[2337,2396]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Creating Solutions and Projects<ept id=\"p1\">](https://docs.microsoft.com/visualstudio/ide/creating-solutions-and-projects)</ept>.","pos":[2397,2534],"source":" For more information, see [Creating Solutions and Projects](https://docs.microsoft.com/visualstudio/ide/creating-solutions-and-projects)."},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, open the shortcut menu for the Class1 file and choose <bpt id=\"p2\">**</bpt>Rename<ept id=\"p2\">**</ept>.","pos":[2544,2635],"source":"In **Solution Explorer**, open the shortcut menu for the Class1 file and choose **Rename**."},{"content":"Rename the file to <ph id=\"ph1\">`Loan`</ph> and press ENTER.","pos":[2636,2678],"source":" Rename the file to `Loan` and press ENTER."},{"content":"Renaming the file will also rename the class to <ph id=\"ph1\">`Loan`</ph>.","pos":[2679,2734],"source":" Renaming the file will also rename the class to `Loan`."},{"content":"Add the following public members to the class:","pos":[2744,2790]},{"pos":[3835,3912],"content":"You will also have to create a simple application that uses the <ph id=\"ph1\">`Loan`</ph> class.","source":"You will also have to create a simple application that uses the `Loan` class."},{"pos":[3922,3950],"content":"To create a test application","linkify":"To create a test application","nodes":[{"content":"To create a test application","pos":[0,28]}]},{"pos":[3960,4075],"content":"To add a Windows Forms Application project to your solution, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>New Project<ept id=\"p3\">**</ept>.","source":"To add a Windows Forms Application project to your solution, on the **File** menu, choose **Add**, **New Project**."},{"pos":[4085,4256],"content":"In the <bpt id=\"p1\">**</bpt>Add New Project<ept id=\"p1\">**</ept> dialog box, choose <bpt id=\"p2\">**</bpt>Windows Forms Application<ept id=\"p2\">**</ept>, and enter <ph id=\"ph1\">`LoanApp`</ph> as the name of the project, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept> to close the dialog box.","source":"In the **Add New Project** dialog box, choose **Windows Forms Application**, and enter `LoanApp` as the name of the project, and then click **OK** to close the dialog box."},{"pos":[4266,4319],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, choose the LoanApp project.","source":"In **Solution Explorer**, choose the LoanApp project."},{"pos":[4329,4388],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Set as StartUp Project<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, choose **Set as StartUp Project**."},{"pos":[4398,4448],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Add Reference<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, choose **Add Reference**."},{"pos":[4458,4561],"content":"In the <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept> dialog box, choose the <bpt id=\"p2\">**</bpt>Projects<ept id=\"p2\">**</ept> tab and then choose the LoanClass project.","source":"In the **Add Reference** dialog box, choose the **Projects** tab and then choose the LoanClass project."},{"pos":[4571,4608],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to close the dialog box.","source":"Click **OK** to close the dialog box."},{"content":"In the designer, add four <ph id=\"ph1\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph> controls to the form.","pos":[4618,4701],"source":"In the designer, add four <xref:System.Windows.Forms.TextBox> controls to the form."},{"content":"In the Code Editor, add the following code:","pos":[4710,4753]},{"pos":[5178,5271],"content":"Add an event handler for the <ph id=\"ph1\">`PropertyChanged`</ph> event to the form by using the following code:","source":"Add an event handler for the `PropertyChanged` event to the form by using the following code:"},{"content":"At this point, you can build and run the application.","pos":[5508,5561]},{"content":"Note that the default values from the <ph id=\"ph1\">`Loan`</ph> class appear in the text boxes.","pos":[5562,5638],"source":" Note that the default values from the `Loan` class appear in the text boxes."},{"content":"Try to change the interest-rate value from 7.5 to 7.1, and then close the application and run it again—the value reverts to the default of 7.5.","pos":[5639,5782]},{"content":"In the real world, interest rates change periodically, but not necessarily every time that the application is run.","pos":[5789,5903]},{"content":"Rather than making the user update the interest rate every time that the application runs, it is better to preserve the most recent interest rate between instances of the application.","pos":[5904,6087]},{"content":"In the next step, you will do just that by adding serialization to the Loan class.","pos":[6088,6170]},{"pos":[6179,6220],"content":"Using Serialization to Persist the Object","linkify":"Using Serialization to Persist the Object","nodes":[{"content":"Using Serialization to Persist the Object","pos":[0,41]}]},{"pos":[6224,6339],"content":"In order to persist the values for the Loan class, you must first mark the class with the <ph id=\"ph1\">`Serializable`</ph> attribute.","source":"In order to persist the values for the Loan class, you must first mark the class with the `Serializable` attribute."},{"pos":[6349,6380],"content":"To mark a class as serializable","linkify":"To mark a class as serializable","nodes":[{"content":"To mark a class as serializable","pos":[0,31]}]},{"content":"Change the class declaration for the Loan class as follows:","pos":[6390,6449]},{"content":"The <ph id=\"ph1\">`Serializable`</ph> attribute tells the compiler that everything in the class can be persisted to a file.","pos":[6587,6691],"source":"The `Serializable` attribute tells the compiler that everything in the class can be persisted to a file."},{"content":"Because the <ph id=\"ph1\">`PropertyChanged`</ph> event is handled by a Windows Form object, it cannot be serialized.","pos":[6692,6789],"source":" Because the `PropertyChanged` event is handled by a Windows Form object, it cannot be serialized."},{"content":"The <ph id=\"ph1\">`NonSerialized`</ph> attribute can be used to mark class members that should not be persisted.","pos":[6790,6883],"source":" The `NonSerialized` attribute can be used to mark class members that should not be persisted."},{"pos":[6893,6934],"content":"To prevent a member from being serialized","linkify":"To prevent a member from being serialized","nodes":[{"content":"To prevent a member from being serialized","pos":[0,41]}]},{"pos":[6944,7010],"content":"Change the declaration for the <ph id=\"ph1\">`PropertyChanged`</ph> event as follows:","source":"Change the declaration for the `PropertyChanged` event as follows:"},{"content":"The next step is to add the serialization code to the LoanApp application.","pos":[7163,7237]},{"content":"In order to serialize the class and write it to a file, you will use the <ph id=\"ph1\">&lt;xref:System.IO&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.Serialization&gt;</ph> namespaces.","pos":[7238,7375],"source":" In order to serialize the class and write it to a file, you will use the <xref:System.IO> and <xref:System.Xml.Serialization> namespaces."},{"content":"To avoid typing the fully qualified names, you can add references to the necessary class libraries.","pos":[7376,7475]},{"pos":[7485,7516],"content":"To add references to namespaces","linkify":"To add references to namespaces","nodes":[{"content":"To add references to namespaces","pos":[0,31]}]},{"pos":[7526,7587],"content":"Add the following statements to the top of the <ph id=\"ph1\">`Form1`</ph> class:","source":"Add the following statements to the top of the `Form1` class:"},{"content":"In this case, you are using a binary formatter to save the object in a binary format.","pos":[7710,7795]},{"content":"The next step is to add code to deserialize the object from the file when the object is created.","pos":[7802,7898]},{"pos":[7908,7932],"content":"To deserialize an object","linkify":"To deserialize an object","nodes":[{"content":"To deserialize an object","pos":[0,24]}]},{"content":"Add a constant to the class for the serialized data's file name.","pos":[7942,8006]},{"pos":[8099,8162],"content":"Modify the code in the <ph id=\"ph1\">`Form1_Load`</ph> event procedure as follows:","source":"Modify the code in the `Form1_Load` event procedure as follows:"},{"content":"Note that you first must check that the file exists.","pos":[8975,9027]},{"content":"If it exists, create a <ph id=\"ph1\">&lt;xref:System.IO.Stream&gt;</ph> class to read the binary file and a <ph id=\"ph2\">&lt;xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter&gt;</ph> class to translate the file.","pos":[9028,9209],"source":" If it exists, create a <xref:System.IO.Stream> class to read the binary file and a <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter> class to translate the file."},{"content":"You also need to convert from the stream type to the Loan object type.","pos":[9210,9280]},{"pos":[9287,9422],"content":"Next you must add code to save the data entered in the text boxes to the <ph id=\"ph1\">`Loan`</ph> class, and then you must serialize the class to a file.","source":"Next you must add code to save the data entered in the text boxes to the `Loan` class, and then you must serialize the class to a file."},{"pos":[9432,9472],"content":"To save the data and serialize the class","linkify":"To save the data and serialize the class","nodes":[{"content":"To save the data and serialize the class","pos":[0,40]}]},{"pos":[9482,9548],"content":"Add the following code to the <ph id=\"ph1\">`Form1_FormClosing`</ph> event procedure:","source":"Add the following code to the `Form1_FormClosing` event procedure:"},{"content":"At this point, you can again build and run the application.","pos":[10125,10184]},{"content":"Initially, the default values appear in the text boxes.","pos":[10185,10240]},{"content":"Try to change the values and enter a name in the fourth text box.","pos":[10241,10306]},{"content":"Close the application and then run it again.","pos":[10307,10351]},{"content":"Note that the new values now appear in the text boxes.","pos":[10352,10406]},{"pos":[10415,10423],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Serialization (C# )<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/serialization/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[10427,10519],"source":"[Serialization (C# )](../../../../csharp/programming-guide/concepts/serialization/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>C# Programming Guide<ept id=\"p1\">](../../../../csharp/programming-guide/index.md)</ept>","pos":[10523,10592],"source":"[C# Programming Guide](../../../../csharp/programming-guide/index.md)"}]}