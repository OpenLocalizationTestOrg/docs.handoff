<?xml version="1.0"?>
<xliff version="1.2" xmlns="urn:oasis:names:tc:xliff:document:1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xliff:document:1.2 xliff-core-1.2-transitional.xsd">
  <file datatype="xml" original="markdown" source-language="en-US" target-language="zh-cn">
    <header>
      <tool tool-id="mdxliff" tool-name="mdxliff" tool-version="1.0-b81d562" tool-company="Microsoft" />
      <xliffext:olfilehash xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">875cabb978fa1a47c150b6418a955f8856bba4b6</xliffext:olfilehash>
      <xliffext:olfilepath xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">docs\framework\windows-workflow-foundation\using-the-interop-activity-in-a-net-framework-4-workflow.md</xliffext:olfilepath>
      <xliffext:oltranslationpriority xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">net-med-mt</xliffext:oltranslationpriority>
      <xliffext:oltranslationtype xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">Machine Translation</xliffext:oltranslationtype>
      <xliffext:olskeletonhash xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">cb930e2b9feccd50a143faaceb073dab1d5cc4bd</xliffext:olskeletonhash>
      <xliffext:olxliffhash xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">eff077e5ef4c8b4858afe3138b172fa9c07db8e1</xliffext:olxliffhash>
    </header>
    <body>
      <group id="content" extype="content">
        <trans-unit id="101" translate="yes" xml:space="preserve">
          <source>Using the Interop Activity in a .NET Framework 4 Workflow | Microsoft Docs</source>
        </trans-unit>
        <trans-unit id="102" translate="yes" xml:space="preserve">
          <source>Using the Interop Activity in a .NET Framework 4 Workflow</source>
        </trans-unit>
        <trans-unit id="103" translate="yes" xml:space="preserve">
          <source>Activities created using <ph id="ph1">[!INCLUDE[vstecwinfx](../../../includes/vstecwinfx-md.md)]</ph> or <ph id="ph2">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph> can be used in a <ph id="ph3">[!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)]</ph> workflow by using the <ph id="ph4">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity.</source>
        </trans-unit>
        <trans-unit id="104" translate="yes" xml:space="preserve">
          <source>This topic provides an overview of using the <ph id="ph1">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity.</source>
        </trans-unit>
        <trans-unit id="105" translate="yes" xml:space="preserve">
          <source>The <ph id="ph1">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity does not appear in the workflow designer toolbox unless the workflow's project has its <bpt id="p1">**</bpt>Target Framework<ept id="p1">**</ept> setting set to <bpt id="p2">**</bpt>.Net Framework 4<ept id="p2">**</ept> or later.</source>
        </trans-unit>
        <trans-unit id="106" translate="yes" xml:space="preserve">
          <source>Using the Interop Activity in .NET Framework 4.5 Workflows</source>
        </trans-unit>
        <trans-unit id="107" translate="yes" xml:space="preserve">
          <source>In this topic, a <ph id="ph1">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph> activity library is created that contains a <ph id="ph2">`DiscountCalculator`</ph> activity.</source>
        </trans-unit>
        <trans-unit id="108" translate="yes" xml:space="preserve">
          <source>The <ph id="ph1">`DiscountCalculator`</ph> calculates a discount based on a purchase amount and consists of a <ph id="ph2">&lt;xref:System.Workflow.Activities.SequenceActivity&gt;</ph> that contains a <ph id="ph3">&lt;xref:System.Workflow.Activities.PolicyActivity&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="109" translate="yes" xml:space="preserve">
          <source>The <ph id="ph1">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph> activity created in this topic uses a <ph id="ph2">&lt;xref:System.Workflow.Activities.PolicyActivity&gt;</ph> to implement the logic of the activity.</source>
        </trans-unit>
        <trans-unit id="110" translate="yes" xml:space="preserve">
          <source>It is not required to use a custom <ph id="ph1">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph> activity or the <ph id="ph2">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity in order to use rules in a <ph id="ph3">[!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)]</ph> workflow.</source>
        </trans-unit>
        <trans-unit id="111" translate="yes" xml:space="preserve">
          <source>For an example of using rules in a <ph id="ph1">[!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)]</ph> workflow without using the <ph id="ph2">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity, see the <bpt id="p1">[</bpt>Policy Activity in .NET Framework 4.5<ept id="p1">](../../../docs/framework/windows-workflow-foundation/samples/policy-activity-in-net-framework-4-5.md)</ept> sample.</source>
        </trans-unit>
        <trans-unit id="112" translate="yes" xml:space="preserve">
          <source>To create the .NET Framework 3.5 activity library project</source>
        </trans-unit>
        <trans-unit id="113" translate="yes" xml:space="preserve">
          <source>Open <ph id="ph1">[!INCLUDE[vs_current_long](../../../includes/vs-current-long-md.md)]</ph> and select <bpt id="p1">**</bpt>New<ept id="p1">**</ept> and then <bpt id="p2">**</bpt>Project…<ept id="p2">**</ept></source>
        </trans-unit>
        <trans-unit id="114" translate="yes" xml:space="preserve">
          <source>from the <bpt id="p1">**</bpt>File<ept id="p1">**</ept> menu.</source>
        </trans-unit>
        <trans-unit id="115" translate="yes" xml:space="preserve">
          <source>Expand the <bpt id="p1">**</bpt>Other Project Types<ept id="p1">**</ept> node in the <bpt id="p2">**</bpt>Installed Templates<ept id="p2">**</ept> pane and select <bpt id="p3">**</bpt>Visual Studio Solutions<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="116" translate="yes" xml:space="preserve">
          <source>Select <bpt id="p1">**</bpt>Blank Solution<ept id="p1">**</ept> from the <bpt id="p2">**</bpt>Visual Studio Solutions<ept id="p2">**</ept> list.</source>
        </trans-unit>
        <trans-unit id="117" translate="yes" xml:space="preserve">
          <source>Type <ph id="ph1">`PolicyInteropDemo`</ph> in the <bpt id="p1">**</bpt>Name<ept id="p1">**</ept> box and click <bpt id="p2">**</bpt>OK<ept id="p2">**</ept>.</source>
        </trans-unit>
        <trans-unit id="118" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>PolicyInteropDemo<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>Add<ept id="p3">**</ept> and then <bpt id="p4">**</bpt>New Project…<ept id="p4">**</ept>.</source>
        </trans-unit>
        <trans-unit id="119" translate="yes" xml:space="preserve">
          <source>If the <bpt id="p1">**</bpt>Solution Explorer<ept id="p1">**</ept> window is not visible, select <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> from the <bpt id="p3">**</bpt>View<ept id="p3">**</ept> menu.</source>
        </trans-unit>
        <trans-unit id="120" translate="yes" xml:space="preserve">
          <source>In the <bpt id="p1">**</bpt>Installed Templates<ept id="p1">**</ept> list, select <bpt id="p2">**</bpt>Visual C#<ept id="p2">**</ept> and then <bpt id="p3">**</bpt>Workflow<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="121" translate="yes" xml:space="preserve">
          <source>Select <bpt id="p1">**</bpt>.NET Framework 3.5<ept id="p1">**</ept> from the .NET Framework version drop-down list, and then select <bpt id="p2">**</bpt>Workflow Activity Library<ept id="p2">**</ept> from the <bpt id="p3">**</bpt>Templates<ept id="p3">**</ept> list.</source>
        </trans-unit>
        <trans-unit id="122" translate="yes" xml:space="preserve">
          <source>Type <ph id="ph1">`PolicyActivityLibrary`</ph> in the <bpt id="p1">**</bpt>Name<ept id="p1">**</ept> box and click <bpt id="p2">**</bpt>OK<ept id="p2">**</ept>.</source>
        </trans-unit>
        <trans-unit id="123" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>Activity1.cs<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>Delete<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="124" translate="yes" xml:space="preserve">
          <source>Click <bpt id="p1">**</bpt>OK<ept id="p1">**</ept> to confirm.</source>
        </trans-unit>
        <trans-unit id="125" translate="yes" xml:space="preserve">
          <source>To create the DiscountCalculator activity</source>
        </trans-unit>
        <trans-unit id="126" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>PolicyActivityLibrary<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>Add<ept id="p3">**</ept> and then <bpt id="p4">**</bpt>Activity…<ept id="p4">**</ept>.</source>
        </trans-unit>
        <trans-unit id="127" translate="yes" xml:space="preserve">
          <source>Select <bpt id="p1">**</bpt>Activity (with code separation)<ept id="p1">**</ept> from the <bpt id="p2">**</bpt>Visual C# Items<ept id="p2">**</ept> list.</source>
        </trans-unit>
        <trans-unit id="128" translate="yes" xml:space="preserve">
          <source>Type <ph id="ph1">`DiscountCalculator`</ph> in the <bpt id="p1">**</bpt>Name<ept id="p1">**</ept> box and click <bpt id="p2">**</bpt>OK<ept id="p2">**</ept>.</source>
        </trans-unit>
        <trans-unit id="129" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>DiscountCalculator.xoml<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>View Code<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="130" translate="yes" xml:space="preserve">
          <source>Add the following three properties to the <ph id="ph1">`DiscountCalculator`</ph> class.</source>
        </trans-unit>
        <trans-unit id="131" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>DiscountCalculator.xoml<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>View Designer<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="132" translate="yes" xml:space="preserve">
          <source>Drag a <bpt id="p1">**</bpt>Policy<ept id="p1">**</ept> activity from the <bpt id="p2">**</bpt>Windows Workflow v3.0<ept id="p2">**</ept> section of the <bpt id="p3">**</bpt>Toolbox<ept id="p3">**</ept> and drop it in the <bpt id="p4">**</bpt>DiscountCalculator<ept id="p4">**</ept> activity.</source>
        </trans-unit>
        <trans-unit id="133" translate="yes" xml:space="preserve">
          <source>If the <bpt id="p1">**</bpt>Toolbox<ept id="p1">**</ept> window is not visible, select <bpt id="p2">**</bpt>Toolbox<ept id="p2">**</ept> from the <bpt id="p3">**</bpt>View<ept id="p3">**</ept> menu.</source>
        </trans-unit>
        <trans-unit id="134" translate="yes" xml:space="preserve">
          <source>To configure the rules</source>
        </trans-unit>
        <trans-unit id="135" translate="yes" xml:space="preserve">
          <source>Click the newly added <bpt id="p1">**</bpt>Policy<ept id="p1">**</ept> activity to select it, if it is not already selected.</source>
        </trans-unit>
        <trans-unit id="136" translate="yes" xml:space="preserve">
          <source>Click the <bpt id="p1">**</bpt>RuleSetReference<ept id="p1">**</ept> property in the <bpt id="p2">**</bpt>Properties<ept id="p2">**</ept> window to select it, and click the ellipsis button to the right of the property.</source>
        </trans-unit>
        <trans-unit id="137" translate="yes" xml:space="preserve">
          <source>If the <bpt id="p1">**</bpt>Properties<ept id="p1">**</ept> window is not visible, choose <bpt id="p2">**</bpt>Properties Window<ept id="p2">**</ept> from the <bpt id="p3">**</bpt>View<ept id="p3">**</ept> menu.</source>
        </trans-unit>
        <trans-unit id="138" translate="yes" xml:space="preserve">
          <source>Select <bpt id="p1">**</bpt>Click New…<ept id="p1">**</ept>.</source>
        </trans-unit>
        <trans-unit id="139" translate="yes" xml:space="preserve">
          <source>Click <bpt id="p1">**</bpt>Add Rule<ept id="p1">**</ept>.</source>
        </trans-unit>
        <trans-unit id="140" translate="yes" xml:space="preserve">
          <source>Type the following expression into the <bpt id="p1">**</bpt>Condition<ept id="p1">**</ept> box.</source>
        </trans-unit>
        <trans-unit id="141" translate="yes" xml:space="preserve">
          <source>Type the following expression into the <bpt id="p1">**</bpt>Then Actions<ept id="p1">**</ept> box.</source>
        </trans-unit>
        <trans-unit id="142" translate="yes" xml:space="preserve">
          <source>Click <bpt id="p1">**</bpt>Add Rule<ept id="p1">**</ept>.</source>
        </trans-unit>
        <trans-unit id="143" translate="yes" xml:space="preserve">
          <source>Type the following expression into the <bpt id="p1">**</bpt>Condition<ept id="p1">**</ept> box.</source>
        </trans-unit>
        <trans-unit id="144" translate="yes" xml:space="preserve">
          <source>Type the following expression into the <bpt id="p1">**</bpt>Then Actions<ept id="p1">**</ept> box.</source>
        </trans-unit>
        <trans-unit id="145" translate="yes" xml:space="preserve">
          <source>Click <bpt id="p1">**</bpt>Add Rule<ept id="p1">**</ept>.</source>
        </trans-unit>
        <trans-unit id="146" translate="yes" xml:space="preserve">
          <source>Type the following expression into the <bpt id="p1">**</bpt>Condition<ept id="p1">**</ept> box.</source>
        </trans-unit>
        <trans-unit id="147" translate="yes" xml:space="preserve">
          <source>Type the following expression into the <bpt id="p1">**</bpt>Then Actions<ept id="p1">**</ept> box.</source>
        </trans-unit>
        <trans-unit id="148" translate="yes" xml:space="preserve">
          <source>Type the following expression into the <bpt id="p1">**</bpt>Else Actions<ept id="p1">**</ept> box.</source>
        </trans-unit>
        <trans-unit id="149" translate="yes" xml:space="preserve">
          <source>Click <bpt id="p1">**</bpt>OK<ept id="p1">**</ept> to close the <bpt id="p2">**</bpt>Rule Set Editor<ept id="p2">**</ept> dialog box.</source>
        </trans-unit>
        <trans-unit id="150" translate="yes" xml:space="preserve">
          <source>Ensure that the newly-created <ph id="ph1">&lt;xref:System.Workflow.Activities.Rules.RuleSet&gt;</ph> is selected in the <bpt id="p1">**</bpt>Name<ept id="p1">**</ept> list, and click <bpt id="p2">**</bpt>OK<ept id="p2">**</ept>.</source>
        </trans-unit>
        <trans-unit id="151" translate="yes" xml:space="preserve">
          <source>Press CTRL+SHIFT+B to build the solution.</source>
        </trans-unit>
        <trans-unit id="152" translate="yes" xml:space="preserve">
          <source>The rules added to the <ph id="ph1">`DiscountCalculator`</ph> activity in this procedure are shown in the following code example.</source>
        </trans-unit>
        <trans-unit id="153" translate="yes" xml:space="preserve">
          <source>When the <ph id="ph1">&lt;xref:System.Workflow.Activities.PolicyActivity&gt;</ph> executes, these three rules evaluate and modify the <ph id="ph2">`Subtotal`</ph>, <ph id="ph3">`DiscountPercent`</ph>, and <ph id="ph4">`Total`</ph> property values of the <ph id="ph5">`DiscountCalculator`</ph> activity to calculate the desired discount.</source>
        </trans-unit>
        <trans-unit id="154" translate="yes" xml:space="preserve">
          <source>Using the DiscountCalculator Activity with the Interop Activity</source>
        </trans-unit>
        <trans-unit id="155" translate="yes" xml:space="preserve">
          <source>To use the <ph id="ph1">`DiscountCalculator`</ph> activity inside a <ph id="ph2">[!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)]</ph> workflow, the <ph id="ph3">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity is used.</source>
        </trans-unit>
        <trans-unit id="156" translate="yes" xml:space="preserve">
          <source>In this section two workflows are created, one using code and one using the workflow designer, which show how to use the <ph id="ph1">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity with the <ph id="ph2">`DiscountCalculator`</ph> activity.</source>
        </trans-unit>
        <trans-unit id="157" translate="yes" xml:space="preserve">
          <source>The same host application is used for both workflows.</source>
        </trans-unit>
        <trans-unit id="158" translate="yes" xml:space="preserve">
          <source>To create the host application</source>
        </trans-unit>
        <trans-unit id="159" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>PolicyInteropDemo<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>Add<ept id="p3">**</ept>, and then <bpt id="p4">**</bpt>New Project…<ept id="p4">**</ept>.</source>
        </trans-unit>
        <trans-unit id="160" translate="yes" xml:space="preserve">
          <source>Ensure that <bpt id="p1">**</bpt>.NET Framework 4.5<ept id="p1">**</ept> is selected in the .NET Framework version drop-down list, and select  <bpt id="p2">**</bpt>Workflow Console Application<ept id="p2">**</ept> from the <bpt id="p3">**</bpt>Visual C# Items<ept id="p3">**</ept> list.</source>
        </trans-unit>
        <trans-unit id="161" translate="yes" xml:space="preserve">
          <source>Type <ph id="ph1">`PolicyInteropHost`</ph> into the <bpt id="p1">**</bpt>Name<ept id="p1">**</ept> box and click <bpt id="p2">**</bpt>OK<ept id="p2">**</ept>.</source>
        </trans-unit>
        <trans-unit id="162" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>PolicyInteropHost<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>Properties<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="163" translate="yes" xml:space="preserve">
          <source>In the <bpt id="p1">**</bpt>Target framework<ept id="p1">**</ept> drop-down list, change the selection from <bpt id="p2">**</bpt>.NET Framework 4 Client Profile<ept id="p2">**</ept> to <bpt id="p3">**</bpt>.NET Framework 4.5<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="164" translate="yes" xml:space="preserve">
          <source>Click <bpt id="p1">**</bpt>Yes<ept id="p1">**</ept> to confirm.</source>
        </trans-unit>
        <trans-unit id="165" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>PolicyInteropHost<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>Add Reference…<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="166" translate="yes" xml:space="preserve">
          <source>Select <bpt id="p1">**</bpt>PolicyActivityLibrary<ept id="p1">**</ept> from the <bpt id="p2">**</bpt>Projects<ept id="p2">**</ept> tab and click <bpt id="p3">**</bpt>OK<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="167" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>PolicyInteropHost<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>Add Reference…<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="168" translate="yes" xml:space="preserve">
          <source>Select <bpt id="p1">**</bpt>System.Workflow.Activities<ept id="p1">**</ept>, <bpt id="p2">**</bpt>System.Workflow.ComponentModel<ept id="p2">**</ept>, and then <bpt id="p3">**</bpt>System.Workflow.Runtime<ept id="p3">**</ept> from the <bpt id="p4">**</bpt>.NET<ept id="p4">**</ept> tab and click <bpt id="p5">**</bpt>OK<ept id="p5">**</ept>.</source>
        </trans-unit>
        <trans-unit id="169" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>PolicyInteropHost<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>Set as StartUp Project<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="170" translate="yes" xml:space="preserve">
          <source>Press CTRL+SHIFT+B to build the solution.</source>
        </trans-unit>
        <trans-unit id="171" translate="yes" xml:space="preserve">
          <source>Using the Interop Activity in Code</source>
        </trans-unit>
        <trans-unit id="172" translate="yes" xml:space="preserve">
          <source>In this example, a workflow definition is created using code that contains the <ph id="ph1">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity and the <ph id="ph2">`DiscountCalculator`</ph> activity.</source>
        </trans-unit>
        <trans-unit id="173" translate="yes" xml:space="preserve">
          <source>This workflow is invoked using <ph id="ph1">&lt;xref:System.Activities.WorkflowInvoker&gt;</ph> and the results of the rule evaluation are written to the console using a <ph id="ph2">&lt;xref:System.Activities.Statements.WriteLine&gt;</ph> activity.</source>
        </trans-unit>
        <trans-unit id="174" translate="yes" xml:space="preserve">
          <source>To use the Interop activity in code</source>
        </trans-unit>
        <trans-unit id="175" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>Program.cs<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>View Code<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="176" translate="yes" xml:space="preserve">
          <source>Add the following <ph id="ph1">`using`</ph> statement at the top of the file.</source>
        </trans-unit>
        <trans-unit id="177" translate="yes" xml:space="preserve">
          <source>Remove the contents of the <ph id="ph1">`Main`</ph> method and replace with the following code.</source>
        </trans-unit>
        <trans-unit id="178" translate="yes" xml:space="preserve">
          <source>Create a new method in the <ph id="ph1">`Program`</ph> class called <ph id="ph2">`CalculateDiscountUsingCodeWorkflow`</ph> that contains the following code.</source>
        </trans-unit>
        <trans-unit id="179" translate="yes" xml:space="preserve">
          <source>The <ph id="ph1">`Subtotal`</ph>, <ph id="ph2">`DiscountPercent`</ph>, and <ph id="ph3">`Total`</ph> properties of the <ph id="ph4">`DiscountCalculator`</ph> activity are surfaced as arguments of the <ph id="ph5">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity, and bound to local workflow variables in the <ph id="ph6">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity’s <ph id="ph7">&lt;xref:System.Activities.Statements.Interop.ActivityProperties%2A&gt;</ph> collection.</source>
        </trans-unit>
        <trans-unit id="180" translate="yes" xml:space="preserve">
          <source><ph id="ph1">`Subtotal`</ph> is added as an <ph id="ph2">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> argument because the <ph id="ph3">`Subtotal`</ph> data flows into the <ph id="ph4">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity, and <ph id="ph5">`DiscountPercent`</ph> and <ph id="ph6">`Total`</ph> are added as <ph id="ph7">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments because their data flows out of the <ph id="ph8">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity.</source>
        </trans-unit>
        <trans-unit id="181" translate="yes" xml:space="preserve">
          <source>Note that the two <ph id="ph1">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments are added with the names <ph id="ph2">`DiscountPercentOut`</ph> and <ph id="ph3">`TotalOut`</ph> to indicate that they represent <ph id="ph4">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments.</source>
        </trans-unit>
        <trans-unit id="182" translate="yes" xml:space="preserve">
          <source>The <ph id="ph1">`DiscountCalculator`</ph> type is specified as the <ph id="ph2">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity’s <ph id="ph3">&lt;xref:System.Activities.Statements.Interop.ActivityType%2A&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="183" translate="yes" xml:space="preserve">
          <source>Press CTRL+F5 to build and run the application.</source>
        </trans-unit>
        <trans-unit id="184" translate="yes" xml:space="preserve">
          <source>Substitute different values for the <ph id="ph1">`Subtotal`</ph> value to test out the different discount levels provided by the <ph id="ph2">`DiscountCalculator`</ph> activity.</source>
        </trans-unit>
        <trans-unit id="185" translate="yes" xml:space="preserve">
          <source>Using the Interop Activity in the Workflow Designer</source>
        </trans-unit>
        <trans-unit id="186" translate="yes" xml:space="preserve">
          <source>In this example, a workflow is created using the workflow designer.</source>
        </trans-unit>
        <trans-unit id="187" translate="yes" xml:space="preserve">
          <source>This workflow has the same functionality as the previous example, except than instead of using a <ph id="ph1">&lt;xref:System.Activities.Statements.WriteLine&gt;</ph> activity to display the discount, the host application retrieves and displays the discount information when the workflow completes.</source>
        </trans-unit>
        <trans-unit id="188" translate="yes" xml:space="preserve">
          <source>Also, instead of using local workflow variables to contain the data, arguments are created in the workflow designer and the values are passed in from the host when the workflow is invoked.</source>
        </trans-unit>
        <trans-unit id="189" translate="yes" xml:space="preserve">
          <source>To host the PolicyActivity using a Workflow Designer-created workflow</source>
        </trans-unit>
        <trans-unit id="190" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>Workflow1.xaml<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>Delete<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="191" translate="yes" xml:space="preserve">
          <source>Click <bpt id="p1">**</bpt>OK<ept id="p1">**</ept> to confirm.</source>
        </trans-unit>
        <trans-unit id="192" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>PolicyInteropHost<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>Add<ept id="p3">**</ept>, <bpt id="p4">**</bpt>New Item…<ept id="p4">**</ept>.</source>
        </trans-unit>
        <trans-unit id="193" translate="yes" xml:space="preserve">
          <source>Expand the <bpt id="p1">**</bpt>Visual C# Items<ept id="p1">**</ept> node and select <bpt id="p2">**</bpt>Workflow<ept id="p2">**</ept>.</source>
        </trans-unit>
        <trans-unit id="194" translate="yes" xml:space="preserve">
          <source>Select <bpt id="p1">**</bpt>Activity<ept id="p1">**</ept> from the <bpt id="p2">**</bpt>Visual C# Items<ept id="p2">**</ept> list.</source>
        </trans-unit>
        <trans-unit id="195" translate="yes" xml:space="preserve">
          <source>Type <ph id="ph1">`DiscountWorkflow`</ph> into the <bpt id="p1">**</bpt>Name<ept id="p1">**</ept> box and click <bpt id="p2">**</bpt>Add<ept id="p2">**</ept>.</source>
        </trans-unit>
        <trans-unit id="196" translate="yes" xml:space="preserve">
          <source>Click the <bpt id="p1">**</bpt>Arguments<ept id="p1">**</ept> button on the lower left side of the workflow designer to display the <bpt id="p2">**</bpt>Arguments<ept id="p2">**</ept> pane.</source>
        </trans-unit>
        <trans-unit id="197" translate="yes" xml:space="preserve">
          <source>Click <bpt id="p1">**</bpt>Create Argument<ept id="p1">**</ept>.</source>
        </trans-unit>
        <trans-unit id="198" translate="yes" xml:space="preserve">
          <source>Type <ph id="ph1">`Subtotal`</ph> into the <bpt id="p1">**</bpt>Name<ept id="p1">**</ept> box, select <bpt id="p2">**</bpt>In<ept id="p2">**</ept> from the <bpt id="p3">**</bpt>Direction<ept id="p3">**</ept> drop-down, select <bpt id="p4">**</bpt>Double<ept id="p4">**</ept> from the <bpt id="p5">**</bpt>Argument type<ept id="p5">**</ept> drop-down, and then press ENTER to save the argument.</source>
        </trans-unit>
        <trans-unit id="199" translate="yes" xml:space="preserve">
          <source>If <bpt id="p1">**</bpt>Double<ept id="p1">**</ept> is not in the <bpt id="p2">**</bpt>Argument type<ept id="p2">**</ept> drop-down list, select <bpt id="p3">**</bpt>Browse for Types …<ept id="p3">**</ept>, type <ph id="ph1">`System.Double`</ph> in the <bpt id="p4">**</bpt>Type Name<ept id="p4">**</ept> box, and click <bpt id="p5">**</bpt>OK<ept id="p5">**</ept>.</source>
        </trans-unit>
        <trans-unit id="200" translate="yes" xml:space="preserve">
          <source>Click <bpt id="p1">**</bpt>Create Argument<ept id="p1">**</ept>.</source>
        </trans-unit>
        <trans-unit id="201" translate="yes" xml:space="preserve">
          <source>Type <ph id="ph1">`DiscountPercent`</ph> into the <bpt id="p1">**</bpt>Name<ept id="p1">**</ept> box, select <bpt id="p2">**</bpt>Out<ept id="p2">**</ept> from the <bpt id="p3">**</bpt>Direction<ept id="p3">**</ept> drop-down, select <bpt id="p4">**</bpt>Double<ept id="p4">**</ept> from the <bpt id="p5">**</bpt>Argument type<ept id="p5">**</ept> drop-down, and then press ENTER to save the argument.</source>
        </trans-unit>
        <trans-unit id="202" translate="yes" xml:space="preserve">
          <source>Click <bpt id="p1">**</bpt>Create Argument<ept id="p1">**</ept>.</source>
        </trans-unit>
        <trans-unit id="203" translate="yes" xml:space="preserve">
          <source>Type <ph id="ph1">`Total`</ph> into the <bpt id="p1">**</bpt>Name<ept id="p1">**</ept> box, select <bpt id="p2">**</bpt>Out<ept id="p2">**</ept> from the <bpt id="p3">**</bpt>Direction<ept id="p3">**</ept> drop-down, select <bpt id="p4">**</bpt>Double<ept id="p4">**</ept> from the <bpt id="p5">**</bpt>Argument type<ept id="p5">**</ept> drop-down, and then press ENTER to save the argument.</source>
        </trans-unit>
        <trans-unit id="204" translate="yes" xml:space="preserve">
          <source>Click the <bpt id="p1">**</bpt>Arguments<ept id="p1">**</ept> button on the lower left side of the workflow designer to close the <bpt id="p2">**</bpt>Arguments<ept id="p2">**</ept> pane.</source>
        </trans-unit>
        <trans-unit id="205" translate="yes" xml:space="preserve">
          <source>Drag a <bpt id="p1">**</bpt>Sequence<ept id="p1">**</ept> activity from the <bpt id="p2">**</bpt>Control Flow<ept id="p2">**</ept> section of the <bpt id="p3">**</bpt>Toolbox<ept id="p3">**</ept> and drop it onto the workflow designer surface.</source>
        </trans-unit>
        <trans-unit id="206" translate="yes" xml:space="preserve">
          <source>Drag an <bpt id="p1">**</bpt>Interop<ept id="p1">**</ept> activity from the <bpt id="p2">**</bpt>Migration<ept id="p2">**</ept> section of the <bpt id="p3">**</bpt>Toolbox<ept id="p3">**</ept> and drop it in the <bpt id="p4">**</bpt>Sequence<ept id="p4">**</ept> activity.</source>
        </trans-unit>
        <trans-unit id="207" translate="yes" xml:space="preserve">
          <source>Click the <bpt id="p1">**</bpt>Interop<ept id="p1">**</ept> activity on the <bpt id="p2">**</bpt>Click to browse…<ept id="p2">**</ept></source>
        </trans-unit>
        <trans-unit id="208" translate="yes" xml:space="preserve">
          <source>label, type <bpt id="p1">**</bpt>DiscountCalculator<ept id="p1">**</ept> in the <bpt id="p2">**</bpt>Type Name<ept id="p2">**</ept> box, and click <bpt id="p3">**</bpt>OK<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="209" translate="yes" xml:space="preserve">
          <source>When the <ph id="ph1">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity is added to the workflow and the <ph id="ph2">`DiscountCalculator`</ph> type is specified as its <ph id="ph3">&lt;xref:System.Activities.Statements.Interop.ActivityType%2A&gt;</ph>, the <ph id="ph4">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity exposes three <ph id="ph5">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments and three <ph id="ph6">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments that represent the three public properties of the <ph id="ph7">`DiscountCalculator`</ph> activity.</source>
        </trans-unit>
        <trans-unit id="210" translate="yes" xml:space="preserve">
          <source>The <ph id="ph1">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments have the same name as the three public properties, and the three <ph id="ph2">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments have the same names with <bpt id="p1">**</bpt>Out<ept id="p1">**</ept> appended to the property name.</source>
        </trans-unit>
        <trans-unit id="211" translate="yes" xml:space="preserve">
          <source>In the following steps, the workflow arguments created in the previous steps are bound to the <ph id="ph1">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity’s arguments.</source>
        </trans-unit>
        <trans-unit id="212" translate="yes" xml:space="preserve">
          <source>Type <ph id="ph1">`DiscountPercent`</ph> into the <bpt id="p1">**</bpt>Enter a VB expression<ept id="p1">**</ept> box to the right of the <bpt id="p2">**</bpt>DiscountPercentOut<ept id="p2">**</ept> property and press TAB.</source>
        </trans-unit>
        <trans-unit id="213" translate="yes" xml:space="preserve">
          <source>Type <ph id="ph1">`Subtotal`</ph> into the <bpt id="p1">**</bpt>Enter a VB expression<ept id="p1">**</ept> box to the right of the <bpt id="p2">**</bpt>Subtotal<ept id="p2">**</ept> property and press TAB.</source>
        </trans-unit>
        <trans-unit id="214" translate="yes" xml:space="preserve">
          <source>Type <ph id="ph1">`Total`</ph> into the <bpt id="p1">**</bpt>Enter a VB expression<ept id="p1">**</ept> box to the right of the <bpt id="p2">**</bpt>TotalOut<ept id="p2">**</ept> property and press TAB.</source>
        </trans-unit>
        <trans-unit id="215" translate="yes" xml:space="preserve">
          <source>Right-click <bpt id="p1">**</bpt>Program.cs<ept id="p1">**</ept> in <bpt id="p2">**</bpt>Solution Explorer<ept id="p2">**</ept> and select <bpt id="p3">**</bpt>View Code<ept id="p3">**</ept>.</source>
        </trans-unit>
        <trans-unit id="216" translate="yes" xml:space="preserve">
          <source>Add the following <ph id="ph1">`using`</ph> statement at the top of the file.</source>
        </trans-unit>
        <trans-unit id="217" translate="yes" xml:space="preserve">
          <source>Comment out the call to the <ph id="ph1">`CalculateDiscountInCode`</ph> method in the <ph id="ph2">`Main`</ph> method and add the following code.</source>
        </trans-unit>
        <trans-unit id="218" translate="yes" xml:space="preserve">
          <source>If you did not follow the previous procedure and the default <ph id="ph1">`Main`</ph> code is present, replace the contents of <ph id="ph2">`Main`</ph> with the following code.</source>
        </trans-unit>
        <trans-unit id="219" translate="yes" xml:space="preserve">
          <source>Create a new method in the <ph id="ph1">`Program`</ph> class called <ph id="ph2">`CalculateDiscountUsingDesignerWorkflow`</ph> that contains the following code.</source>
        </trans-unit>
        <trans-unit id="220" translate="yes" xml:space="preserve">
          <source>Press CTRL+F5 to build and run the application.</source>
        </trans-unit>
        <trans-unit id="221" translate="yes" xml:space="preserve">
          <source>To specify a different <ph id="ph1">`Subtotal`</ph> amount, change the value of <ph id="ph2">`SubtotalValue`</ph> in the following code.</source>
        </trans-unit>
        <trans-unit id="222" translate="yes" xml:space="preserve">
          <source>Rules Features Overview</source>
        </trans-unit>
        <trans-unit id="223" translate="yes" xml:space="preserve">
          <source>The <ph id="ph1">[!INCLUDE[wf1](../../../includes/wf1-md.md)]</ph> rules engine provides support for processing rules in a priority-based manner with support for forward chaining.</source>
        </trans-unit>
        <trans-unit id="224" translate="yes" xml:space="preserve">
          <source>Rules can be evaluated for a single item or for items in a collection.</source>
        </trans-unit>
        <trans-unit id="225" translate="yes" xml:space="preserve">
          <source>For an overview of rules and information on specific rules functionality, please refer to the following table.</source>
        </trans-unit>
        <trans-unit id="226" translate="yes" xml:space="preserve">
          <source>Rules Feature</source>
        </trans-unit>
        <trans-unit id="227" translate="yes" xml:space="preserve">
          <source>Documentation</source>
        </trans-unit>
        <trans-unit id="228" translate="yes" xml:space="preserve">
          <source>Rules Overview</source>
        </trans-unit>
        <trans-unit id="229" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Introduction to the Windows Workflow Foundation Rules Engine<ept id="p1">](http://go.microsoft.com/fwlink/?LinkID=152836)</ept></source>
        </trans-unit>
        <trans-unit id="230" translate="yes" xml:space="preserve">
          <source>RuleSet</source>
        </trans-unit>
        <trans-unit id="231" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Using RuleSets in Workflows<ept id="p1">](http://go.microsoft.com/fwlink/?LinkId=178516)</ept> and <ph id="ph1">&lt;xref:System.Workflow.Activities.Rules.RuleSet&gt;</ph></source>
        </trans-unit>
        <trans-unit id="232" translate="yes" xml:space="preserve">
          <source>Evaluation of Rules</source>
        </trans-unit>
        <trans-unit id="233" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Rules Evaluation in RuleSets<ept id="p1">](http://go.microsoft.com/fwlink/?LinkId=178517)</ept></source>
        </trans-unit>
        <trans-unit id="234" translate="yes" xml:space="preserve">
          <source>Rules Chaining</source>
        </trans-unit>
        <trans-unit id="235" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Forward Chaining Control<ept id="p1">](http://go.microsoft.com/fwlink/?LinkId=178518)</ept> and <bpt id="p2">[</bpt>Forward Chaining of Rules<ept id="p2">](http://go.microsoft.com/fwlink/?LinkId=178519)</ept></source>
        </trans-unit>
        <trans-unit id="236" translate="yes" xml:space="preserve">
          <source>Processing Collections in Rules</source>
        </trans-unit>
        <trans-unit id="237" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Processing Collections in Rules<ept id="p1">](http://go.microsoft.com/fwlink/?LinkId=178520)</ept></source>
        </trans-unit>
        <trans-unit id="238" translate="yes" xml:space="preserve">
          <source>Using the PolicyActivity</source>
        </trans-unit>
        <trans-unit id="239" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Using the PolicyActivity Activity<ept id="p1">](http://go.microsoft.com/fwlink/?LinkId=178521)</ept> and <ph id="ph1">&lt;xref:System.Workflow.Activities.PolicyActivity&gt;</ph></source>
        </trans-unit>
        <trans-unit id="240" translate="yes" xml:space="preserve">
          <source>Workflows created in <ph id="ph1">[!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)]</ph> do not use all of the rules features provided by <ph id="ph2">[!INCLUDE[wf1](../../../includes/wf1-md.md)]</ph>, such as declarative activity conditions and conditional activities such as the <ph id="ph3">&lt;xref:System.Workflow.Activities.ConditionedActivityGroup&gt;</ph> and <ph id="ph4">&lt;xref:System.Workflow.Activities.ReplicatorActivity&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="241" translate="yes" xml:space="preserve">
          <source>If required, this functionality is available for workflows created using <ph id="ph1">[!INCLUDE[vstecwinfx](../../../includes/vstecwinfx-md.md)]</ph> and <ph id="ph2">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph>.</source>
        </trans-unit>
        <trans-unit id="242" translate="yes" xml:space="preserve">
          <source><ph id="ph1">[!INCLUDE[crdefault](../../../includes/crdefault-md.md)]</ph><bpt id="p1">[</bpt>Migration Guidance<ept id="p1">](../../../docs/framework/windows-workflow-foundation/migration-guidance.md)</ept>.</source>
        </trans-unit>
      </group>
    </body>
  </file>
</xliff>