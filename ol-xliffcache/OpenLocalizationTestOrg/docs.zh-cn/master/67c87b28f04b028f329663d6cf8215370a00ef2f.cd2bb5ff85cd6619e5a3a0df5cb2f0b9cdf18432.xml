{"content":"---\ntitle: \"Using the Row for New Records in the Windows Forms DataGridView Control\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"DataGridView control [Windows Forms], adding rows for new records\"\n  - \"rows [Windows Forms], new records\"\n  - \"DataGridView control [Windows Forms], data entry\"\nms.assetid: 6110f1ea-9794-442c-a98a-f104a1feeaf4\n---\n# Using the Row for New Records in the Windows Forms DataGridView Control\nWhen you use a <xref:System.Windows.Forms.DataGridView> for editing data in your application, you will often want to give your users the ability to add new rows of data to the data store. The <xref:System.Windows.Forms.DataGridView> control supports this functionality by providing a row for new records, which is always shown as the last row. It is marked with an asterisk (*) symbol in its row header. The following sections discuss some of the things you should consider when you program with the row for new records enabled.  \n  \n## Displaying the Row for New Records  \n Use the <xref:System.Windows.Forms.DataGridView.AllowUserToAddRows%2A> property to indicate whether the row for new records is displayed. The default value of this property is `true`.  \n  \n For the data bound case, the row for new records will be shown if the <xref:System.Windows.Forms.DataGridView.AllowUserToAddRows%2A> property of the control and the <xref:System.ComponentModel.IBindingList.AllowNew%2A?displayProperty=nameWithType> property of the data source are both `true`. If either is `false` then the row will not be shown.  \n  \n## Populating the Row for New Records with Default Data  \n When the user selects the row for new records as the current row, the <xref:System.Windows.Forms.DataGridView> control raises the <xref:System.Windows.Forms.DataGridView.DefaultValuesNeeded> event.  \n  \n This event provides access to the new <xref:System.Windows.Forms.DataGridViewRow> and enables you to populate the new row with default data. For more information, see [How to: Specify Default Values for New Rows in the Windows Forms DataGridView Control](specify-default-values-for-new-rows-in-the-datagrid.md)  \n  \n## The Rows Collection  \n The row for new records is contained in the <xref:System.Windows.Forms.DataGridView> control's <xref:System.Windows.Forms.DataGridView.Rows%2A> collection but behaves differently in two respects:  \n  \n-   The row for new records cannot be removed from the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection programmatically. An <xref:System.InvalidOperationException> is thrown if this is attempted. The user also cannot delete the row for new records. The <xref:System.Windows.Forms.DataGridViewRowCollection.Clear%2A?displayProperty=nameWithType> method does not remove this row from the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection.  \n  \n-   No row can be added after the row for new records. An <xref:System.InvalidOperationException> is raised if this is attempted. As a result, the row for new records is always the last row in the <xref:System.Windows.Forms.DataGridView> control. The methods on <xref:System.Windows.Forms.DataGridViewRowCollection> that add rows—<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, and <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>—all call insertion methods internally when the row for new records is present.  \n  \n## Visual Customization of the Row for New Records  \n When the row for new records is created, it is based on the row specified by the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A> property. Any cell styles that are not specified for this row are inherited from other properties. For more information about cell style inheritance, see [Cell Styles in the Windows Forms DataGridView Control](cell-styles-in-the-windows-forms-datagridview-control.md).  \n  \n The initial values displayed by cells in the row for new records are retrieved from each cell's <xref:System.Windows.Forms.DataGridViewCell.DefaultNewRowValue%2A> property. For cells of type <xref:System.Windows.Forms.DataGridViewImageCell>, this property returns a placeholder image. Otherwise, this property returns `null`. You can override this property to return a custom value. However, these initial values can be replaced by a <xref:System.Windows.Forms.DataGridView.DefaultValuesNeeded> event handler when focus enters the row for new records.  \n  \n The standard icons for this row's header, which are an arrow or an asterisk, are not exposed publicly. If you want to customize the icons, you will need to create a custom <xref:System.Windows.Forms.DataGridViewRowHeaderCell> class.  \n  \n The standard icons use the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property of the <xref:System.Windows.Forms.DataGridViewCellStyle> in use by the row header cell. The standard icons are not rendered if there is not enough space to display them completely.  \n  \n If the row header cell has a string value set, and if there is not enough room for both the text and icon, the icon is dropped first.  \n  \n## Sorting  \n In unbound mode, new records will always be added to the end of the <xref:System.Windows.Forms.DataGridView> even if the user has sorted the content of the <xref:System.Windows.Forms.DataGridView>. The user will need to apply the sort again in order to sort the row to the correct position; this behavior is similar to that of the <xref:System.Windows.Forms.ListView> control.  \n  \n In data bound and virtual modes, the insertion behavior when a sort is applied will be dependent on the implementation of the data model. For [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)], the row is immediately sorted into the correct position.  \n  \n## Other Notes on the Row for New Records  \n You cannot set the <xref:System.Windows.Forms.DataGridViewRow.Visible%2A> property of this row to `false`. An <xref:System.InvalidOperationException> is raised if this is attempted.  \n  \n The row for new records is always created in the unselected state.  \n  \n## Virtual Mode  \n If you are implementing virtual mode, you will need to track when a row for new records is needed in the data model and when to roll back the addition of the row. The exact implementation of this functionality depends on the implementation of the data model and its transaction semantics, for example, whether commit scope is at the cell or row level. For more information, see [Virtual Mode in the Windows Forms DataGridView Control](virtual-mode-in-the-windows-forms-datagridview-control.md).  \n  \n## See also\n\n- <xref:System.Windows.Forms.DataGridView>\n- <xref:System.Windows.Forms.DataGridView.DefaultValuesNeeded?displayProperty=nameWithType>\n- [Data Entry in the Windows Forms DataGridView Control](data-entry-in-the-windows-forms-datagridview-control.md)\n- [How to: Specify Default Values for New Rows in the Windows Forms DataGridView Control](specify-default-values-for-new-rows-in-the-datagrid.md)\n","nodes":[{"pos":[4,344],"embed":true,"restype":"x-metadata","content":"title: \"Using the Row for New Records in the Windows Forms DataGridView Control\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"DataGridView control [Windows Forms], adding rows for new records\"\n  - \"rows [Windows Forms], new records\"\n  - \"DataGridView control [Windows Forms], data entry\"\nms.assetid: 6110f1ea-9794-442c-a98a-f104a1feeaf4","nodes":[{"content":"Using the Row for New Records in the Windows Forms DataGridView Control","nodes":[{"pos":[0,71],"content":"Using the Row for New Records in the Windows Forms DataGridView Control","nodes":[{"content":"Using the Row for New Records in the Windows Forms DataGridView Control","pos":[0,71]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[351,422],"content":"Using the Row for New Records in the Windows Forms DataGridView Control","linkify":"Using the Row for New Records in the Windows Forms DataGridView Control","nodes":[{"content":"Using the Row for New Records in the Windows Forms DataGridView Control","pos":[0,71]}]},{"content":"When you use a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> for editing data in your application, you will often want to give your users the ability to add new rows of data to the data store.","pos":[423,610],"source":"When you use a <xref:System.Windows.Forms.DataGridView> for editing data in your application, you will often want to give your users the ability to add new rows of data to the data store."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control supports this functionality by providing a row for new records, which is always shown as the last row.","pos":[611,766],"source":" The <xref:System.Windows.Forms.DataGridView> control supports this functionality by providing a row for new records, which is always shown as the last row."},{"content":"It is marked with an asterisk (*) symbol in its row header.","pos":[767,826]},{"content":"The following sections discuss some of the things you should consider when you program with the row for new records enabled.","pos":[827,951]},{"pos":[960,994],"content":"Displaying the Row for New Records","linkify":"Displaying the Row for New Records","nodes":[{"content":"Displaying the Row for New Records","pos":[0,34]}]},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.AllowUserToAddRows%2A&gt;</ph> property to indicate whether the row for new records is displayed.","pos":[998,1135],"source":"Use the <xref:System.Windows.Forms.DataGridView.AllowUserToAddRows%2A> property to indicate whether the row for new records is displayed."},{"content":"The default value of this property is <ph id=\"ph1\">`true`</ph>.","pos":[1136,1181],"source":" The default value of this property is `true`."},{"content":"For the data bound case, the row for new records will be shown if the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.AllowUserToAddRows%2A&gt;</ph> property of the control and the <ph id=\"ph2\">&lt;xref:System.ComponentModel.IBindingList.AllowNew%2A?displayProperty=nameWithType&gt;</ph> property of the data source are both <ph id=\"ph3\">`true`</ph>.","pos":[1188,1480],"source":"For the data bound case, the row for new records will be shown if the <xref:System.Windows.Forms.DataGridView.AllowUserToAddRows%2A> property of the control and the <xref:System.ComponentModel.IBindingList.AllowNew%2A?displayProperty=nameWithType> property of the data source are both `true`."},{"content":"If either is <ph id=\"ph1\">`false`</ph> then the row will not be shown.","pos":[1481,1533],"source":" If either is `false` then the row will not be shown."},{"pos":[1542,1594],"content":"Populating the Row for New Records with Default Data","linkify":"Populating the Row for New Records with Default Data","nodes":[{"content":"Populating the Row for New Records with Default Data","pos":[0,52]}]},{"pos":[1598,1795],"content":"When the user selects the row for new records as the current row, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control raises the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView.DefaultValuesNeeded&gt;</ph> event.","source":"When the user selects the row for new records as the current row, the <xref:System.Windows.Forms.DataGridView> control raises the <xref:System.Windows.Forms.DataGridView.DefaultValuesNeeded> event."},{"content":"This event provides access to the new <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridViewRow&gt;</ph> and enables you to populate the new row with default data.","pos":[1802,1942],"source":"This event provides access to the new <xref:System.Windows.Forms.DataGridViewRow> and enables you to populate the new row with default data."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Specify Default Values for New Rows in the Windows Forms DataGridView Control<ept id=\"p1\">](specify-default-values-for-new-rows-in-the-datagrid.md)</ept>","pos":[1943,2112],"source":" For more information, see [How to: Specify Default Values for New Rows in the Windows Forms DataGridView Control](specify-default-values-for-new-rows-in-the-datagrid.md)"},{"pos":[2121,2140],"content":"The Rows Collection","linkify":"The Rows Collection","nodes":[{"content":"The Rows Collection","pos":[0,19]}]},{"pos":[2144,2339],"content":"The row for new records is contained in the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView.Rows%2A&gt;</ph> collection but behaves differently in two respects:","source":"The row for new records is contained in the <xref:System.Windows.Forms.DataGridView> control's <xref:System.Windows.Forms.DataGridView.Rows%2A> collection but behaves differently in two respects:"},{"content":"The row for new records cannot be removed from the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.Rows%2A&gt;</ph> collection programmatically.","pos":[2349,2477],"source":"The row for new records cannot be removed from the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection programmatically."},{"content":"An <ph id=\"ph1\">&lt;xref:System.InvalidOperationException&gt;</ph> is thrown if this is attempted.","pos":[2478,2552],"source":" An <xref:System.InvalidOperationException> is thrown if this is attempted."},{"content":"The user also cannot delete the row for new records.","pos":[2553,2605]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridViewRowCollection.Clear%2A?displayProperty=nameWithType&gt;</ph> method does not remove this row from the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView.Rows%2A&gt;</ph> collection.","pos":[2606,2803],"source":" The <xref:System.Windows.Forms.DataGridViewRowCollection.Clear%2A?displayProperty=nameWithType> method does not remove this row from the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection."},{"content":"No row can be added after the row for new records.","pos":[2813,2863]},{"content":"An <ph id=\"ph1\">&lt;xref:System.InvalidOperationException&gt;</ph> is raised if this is attempted.","pos":[2864,2938],"source":" An <xref:System.InvalidOperationException> is raised if this is attempted."},{"content":"As a result, the row for new records is always the last row in the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control.","pos":[2939,3055],"source":" As a result, the row for new records is always the last row in the <xref:System.Windows.Forms.DataGridView> control."},{"content":"The methods on <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridViewRowCollection&gt;</ph> that add rows—<ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A&gt;</ph>—all call insertion methods internally when the row for new records is present.","pos":[3056,3416],"source":" The methods on <xref:System.Windows.Forms.DataGridViewRowCollection> that add rows—<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, and <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>—all call insertion methods internally when the row for new records is present."},{"pos":[3425,3472],"content":"Visual Customization of the Row for New Records","linkify":"Visual Customization of the Row for New Records","nodes":[{"content":"Visual Customization of the Row for New Records","pos":[0,47]}]},{"content":"When the row for new records is created, it is based on the row specified by the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.RowTemplate%2A&gt;</ph> property.","pos":[3476,3622],"source":"When the row for new records is created, it is based on the row specified by the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A> property."},{"content":"Any cell styles that are not specified for this row are inherited from other properties.","pos":[3623,3711]},{"content":"For more information about cell style inheritance, see <bpt id=\"p1\">[</bpt>Cell Styles in the Windows Forms DataGridView Control<ept id=\"p1\">](cell-styles-in-the-windows-forms-datagridview-control.md)</ept>.","pos":[3712,3881],"source":" For more information about cell style inheritance, see [Cell Styles in the Windows Forms DataGridView Control](cell-styles-in-the-windows-forms-datagridview-control.md)."},{"content":"The initial values displayed by cells in the row for new records are retrieved from each cell's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridViewCell.DefaultNewRowValue%2A&gt;</ph> property.","pos":[3888,4060],"source":"The initial values displayed by cells in the row for new records are retrieved from each cell's <xref:System.Windows.Forms.DataGridViewCell.DefaultNewRowValue%2A> property."},{"content":"For cells of type <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridViewImageCell&gt;</ph>, this property returns a placeholder image.","pos":[4061,4172],"source":" For cells of type <xref:System.Windows.Forms.DataGridViewImageCell>, this property returns a placeholder image."},{"content":"Otherwise, this property returns <ph id=\"ph1\">`null`</ph>.","pos":[4173,4213],"source":" Otherwise, this property returns `null`."},{"content":"You can override this property to return a custom value.","pos":[4214,4270]},{"content":"However, these initial values can be replaced by a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView.DefaultValuesNeeded&gt;</ph> event handler when focus enters the row for new records.","pos":[4271,4439],"source":" However, these initial values can be replaced by a <xref:System.Windows.Forms.DataGridView.DefaultValuesNeeded> event handler when focus enters the row for new records."},{"content":"The standard icons for this row's header, which are an arrow or an asterisk, are not exposed publicly.","pos":[4446,4548]},{"content":"If you want to customize the icons, you will need to create a custom <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridViewRowHeaderCell&gt;</ph> class.","pos":[4549,4678],"source":" If you want to customize the icons, you will need to create a custom <xref:System.Windows.Forms.DataGridViewRowHeaderCell> class."},{"content":"The standard icons use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridViewCellStyle&gt;</ph> in use by the row header cell.","pos":[4685,4871],"source":"The standard icons use the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property of the <xref:System.Windows.Forms.DataGridViewCellStyle> in use by the row header cell."},{"content":"The standard icons are not rendered if there is not enough space to display them completely.","pos":[4872,4964]},{"content":"If the row header cell has a string value set, and if there is not enough room for both the text and icon, the icon is dropped first.","pos":[4971,5104]},{"pos":[5113,5120],"content":"Sorting","linkify":"Sorting","nodes":[{"content":"Sorting","pos":[0,7]}]},{"content":"In unbound mode, new records will always be added to the end of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> even if the user has sorted the content of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph>.","pos":[5124,5321],"source":"In unbound mode, new records will always be added to the end of the <xref:System.Windows.Forms.DataGridView> even if the user has sorted the content of the <xref:System.Windows.Forms.DataGridView>."},{"content":"The user will need to apply the sort again in order to sort the row to the correct position; this behavior is similar to that of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView&gt;</ph> control.","pos":[5322,5500],"source":" The user will need to apply the sort again in order to sort the row to the correct position; this behavior is similar to that of the <xref:System.Windows.Forms.ListView> control."},{"content":"In data bound and virtual modes, the insertion behavior when a sort is applied will be dependent on the implementation of the data model.","pos":[5507,5644]},{"content":"For <ph id=\"ph1\">[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)]</ph>, the row is immediately sorted into the correct position.","pos":[5645,5764],"source":" For [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)], the row is immediately sorted into the correct position."},{"pos":[5773,5811],"content":"Other Notes on the Row for New Records","linkify":"Other Notes on the Row for New Records","nodes":[{"content":"Other Notes on the Row for New Records","pos":[0,38]}]},{"content":"You cannot set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridViewRow.Visible%2A&gt;</ph> property of this row to <ph id=\"ph2\">`false`</ph>.","pos":[5815,5921],"source":"You cannot set the <xref:System.Windows.Forms.DataGridViewRow.Visible%2A> property of this row to `false`."},{"content":"An <ph id=\"ph1\">&lt;xref:System.InvalidOperationException&gt;</ph> is raised if this is attempted.","pos":[5922,5996],"source":" An <xref:System.InvalidOperationException> is raised if this is attempted."},{"content":"The row for new records is always created in the unselected state.","pos":[6003,6069]},{"pos":[6078,6090],"content":"Virtual Mode","linkify":"Virtual Mode","nodes":[{"content":"Virtual Mode","pos":[0,12]}]},{"content":"If you are implementing virtual mode, you will need to track when a row for new records is needed in the data model and when to roll back the addition of the row.","pos":[6094,6256]},{"content":"The exact implementation of this functionality depends on the implementation of the data model and its transaction semantics, for example, whether commit scope is at the cell or row level.","pos":[6257,6445]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Virtual Mode in the Windows Forms DataGridView Control<ept id=\"p1\">](virtual-mode-in-the-windows-forms-datagridview-control.md)</ept>.","pos":[6446,6588],"source":" For more information, see [Virtual Mode in the Windows Forms DataGridView Control](virtual-mode-in-the-windows-forms-datagridview-control.md)."},{"pos":[6597,6605],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6744,6855],"content":"<bpt id=\"p1\">[</bpt>Data Entry in the Windows Forms DataGridView Control<ept id=\"p1\">](data-entry-in-the-windows-forms-datagridview-control.md)</ept>","source":"[Data Entry in the Windows Forms DataGridView Control](data-entry-in-the-windows-forms-datagridview-control.md)"},{"pos":[6858,7001],"content":"<bpt id=\"p1\">[</bpt>How to: Specify Default Values for New Rows in the Windows Forms DataGridView Control<ept id=\"p1\">](specify-default-values-for-new-rows-in-the-datagrid.md)</ept>","source":"[How to: Specify Default Values for New Rows in the Windows Forms DataGridView Control](specify-default-values-for-new-rows-in-the-datagrid.md)"}]}