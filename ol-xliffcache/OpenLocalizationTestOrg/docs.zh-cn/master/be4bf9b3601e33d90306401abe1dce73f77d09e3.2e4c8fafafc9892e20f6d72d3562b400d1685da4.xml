{"content":"---\ntitle: \"How to: Secure Metadata Endpoints\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 9f71b6ae-737c-4382-8d89-0a7b1c7e182b\n---\n# How to: Secure Metadata Endpoints\nMetadata for a service can contain sensitive information about your application that a malicious user can leverage. Consumers of your service may also require a secure mechanism for obtaining metadata about your service. Therefore, it is sometimes necessary to publish your metadata using a secure endpoint.  \n  \n Metadata endpoints are generally secured using the standard security mechanisms defined in Windows Communication Foundation (WCF) for securing application endpoints. (For more information, see [Security Overview](../../../../docs/framework/wcf/feature-details/security-overview.md).)  \n  \n This topic walks through the steps to create an endpoint secured by a Secure Sockets Layer (SSL) certificate or, in other words, an HTTPS endpoint.  \n  \n### To create a secure HTTPS GET metadata endpoint in code  \n  \n1.  Configure a port with an appropriate X.509 certificate. The certificate must come from a trusted authority, and it must have an intended use of \"Service Authorization.\" You must use the HttpCfg.exe tool to attach the certificate to the port. See [How to: Configure a Port with an SSL Certificate](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md).  \n  \n    > [!IMPORTANT]\n    >  The subject of the certificate or its Domain Name System (DNS) must match the name of the computer. This is essential because one of the first steps the HTTPS mechanism performs is to check that the certificate is issued to the same Uniform Resource Identifier (URI) as the address upon which it is invoked.  \n  \n2.  Create a new instance of the <xref:System.ServiceModel.Description.ServiceMetadataBehavior> class.  \n  \n3.  Set the <xref:System.ServiceModel.Description.ServiceMetadataBehavior.HttpsGetEnabled%2A> property of the <xref:System.ServiceModel.Description.ServiceMetadataBehavior> class to `true`.  \n  \n4.  Set the <xref:System.ServiceModel.Description.ServiceMetadataBehavior.HttpsGetUrl%2A> property to an appropriate URL. Note that if you specify an absolute address, the URL must begin with the scheme \"https://\". If you specify a relative address, you must supply an HTTPS base address for your service host. If this property is not set, the default address is \"\", or directly at the HTTPS base address for the service.  \n  \n5.  Add the instance to the behaviors collection that the <xref:System.ServiceModel.Description.ServiceDescription.Behaviors%2A> property of the <xref:System.ServiceModel.Description.ServiceDescription> class returns, as shown in the following code.  \n  \n     [!code-csharp[c_HowToSecureEndpoint#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howtosecureendpoint/cs/source.cs#1)]\n     [!code-vb[c_HowToSecureEndpoint#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_howtosecureendpoint/vb/source.vb#1)]  \n  \n### To create a secure HTTPS GET metadata endpoint in configuration  \n  \n1.  Add a [\\<behaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md) element to the [\\<system.serviceModel>](../../../../docs/framework/configure-apps/file-schema/wcf/system-servicemodel.md) element of the configuration file for your service.  \n  \n2.  Add a [\\<serviceBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md) element to the [\\<behaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md) element.  \n  \n3.  Add a [\\<behavior>](../../../../docs/framework/configure-apps/file-schema/wcf/behavior-of-servicebehaviors.md) element to the `<serviceBehaviors>` element.  \n  \n4.  Set the `name` attribute of the `<behavior>` element to an appropriate value. The `name` attribute is required. The example below uses the value `mySvcBehavior`.  \n  \n5.  Add a [\\<serviceMetadata>](../../../../docs/framework/configure-apps/file-schema/wcf/servicemetadata.md) to the `<behavior>` element.  \n  \n6.  Set the `httpsGetEnabled` attribute of the `<serviceMetadata>` element to `true`.  \n  \n7.  Set the `httpsGetUrl` attribute of the `<serviceMetadata>` element to an appropriate value. Note that if you specify an absolute address, the URL must begin with the scheme \"https://\". If you specify a relative address, you must supply an HTTPS base address for your service host. If this property is not set, the default address is \"\", or directly at the HTTPS base address for the service.  \n  \n8.  To use the behavior with a service, set the `behaviorConfiguration` attribute of the [\\<service>](../../../../docs/framework/configure-apps/file-schema/wcf/service.md) element to the value of the name attribute of the behavior element. The following configuration code shows a complete example.  \n  \n    ```xml  \n    <?xml version=\"1.0\" encoding=\"utf-8\" ?>  \n    <configuration>  \n     <system.serviceModel>  \n      <behaviors>  \n       <serviceBehaviors>  \n        <behavior name=\"mySvcBehavior\">  \n         <serviceMetadata httpsGetEnabled=\"true\"   \n              httpsGetUrl=\"https://localhost:8036/calcMetadata\" />  \n        </behavior>  \n       </serviceBehaviors>  \n      </behaviors>  \n     <services>  \n      <service behaviorConfiguration=\"mySvcBehavior\"   \n            name=\"Microsoft.Security.Samples.Calculator\">  \n       <endpoint address=\"http://localhost:8037/ServiceModelSamples/calculator\"  \n       binding=\"wsHttpBinding\" bindingConfiguration=\"\"     \n       contract=\"Microsoft.Security.Samples.ICalculator\" />  \n      </service>  \n     </services>  \n    </system.serviceModel>  \n    </configuration>  \n    ```  \n  \n## Example  \n The following example creates an instance of a <xref:System.ServiceModel.ServiceHost> class and adds an endpoint. The code then creates an instance of the <xref:System.ServiceModel.Description.ServiceMetadataBehavior> class and sets the properties to create a secure metadata exchange point.  \n  \n [!code-csharp[c_HowToSecureEndpoint#0](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howtosecureendpoint/cs/source.cs#0)]\n [!code-vb[c_HowToSecureEndpoint#0](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_howtosecureendpoint/vb/source.vb#0)]  \n  \n## Compiling the Code  \n The code example uses the following namespaces:  \n  \n-   <xref:System.ServiceModel?displayProperty=nameWithType>  \n  \n-   <xref:System.ServiceModel.Description?displayProperty=nameWithType>  \n  \n## See also\n\n- <xref:System.ServiceModel.Description.ServiceMetadataBehavior.HttpsGetEnabled%2A>\n- <xref:System.ServiceModel.Description.ServiceMetadataBehavior>\n- <xref:System.ServiceModel.Description.ServiceMetadataBehavior.HttpsGetUrl%2A>\n- [How to: Configure a Port with an SSL Certificate](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md)\n- [Working with Certificates](../../../../docs/framework/wcf/feature-details/working-with-certificates.md)\n- [Security Considerations with Metadata](../../../../docs/framework/wcf/feature-details/security-considerations-with-metadata.md)\n- [Securing Services and Clients](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)\n","nodes":[{"pos":[4,151],"embed":true,"restype":"x-metadata","content":"title: \"How to: Secure Metadata Endpoints\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 9f71b6ae-737c-4382-8d89-0a7b1c7e182b","nodes":[{"content":"How to: Secure Metadata Endpoints","nodes":[{"pos":[0,33],"content":"How to: Secure Metadata Endpoints","nodes":[{"content":"How to: Secure Metadata Endpoints","pos":[0,33]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[158,191],"content":"How to: Secure Metadata Endpoints","linkify":"How to: Secure Metadata Endpoints","nodes":[{"content":"How to: Secure Metadata Endpoints","pos":[0,33]}]},{"content":"Metadata for a service can contain sensitive information about your application that a malicious user can leverage.","pos":[192,307]},{"content":"Consumers of your service may also require a secure mechanism for obtaining metadata about your service.","pos":[308,412]},{"content":"Therefore, it is sometimes necessary to publish your metadata using a secure endpoint.","pos":[413,499]},{"content":"Metadata endpoints are generally secured using the standard security mechanisms defined in Windows Communication Foundation (WCF) for securing application endpoints.","pos":[506,671]},{"content":"(For more information, see <bpt id=\"p1\">[</bpt>Security Overview<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/security-overview.md)</ept>.)","pos":[672,789],"source":" (For more information, see [Security Overview](../../../../docs/framework/wcf/feature-details/security-overview.md).)"},{"content":"This topic walks through the steps to create an endpoint secured by a Secure Sockets Layer (SSL) certificate or, in other words, an HTTPS endpoint.","pos":[796,943]},{"pos":[953,1007],"content":"To create a secure HTTPS GET metadata endpoint in code","linkify":"To create a secure HTTPS GET metadata endpoint in code","nodes":[{"content":"To create a secure HTTPS GET metadata endpoint in code","pos":[0,54]}]},{"content":"Configure a port with an appropriate X.509 certificate.","pos":[1017,1072]},{"content":"The certificate must come from a trusted authority, and it must have an intended use of \"Service Authorization.\"","pos":[1073,1185]},{"content":"You must use the HttpCfg.exe tool to attach the certificate to the port.","pos":[1186,1258]},{"content":"See <bpt id=\"p1\">[</bpt>How to: Configure a Port with an SSL Certificate<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md)</ept>.","pos":[1259,1413],"source":" See [How to: Configure a Port with an SSL Certificate](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md)."},{"pos":[1425,1752],"content":"[!IMPORTANT]\nThe subject of the certificate or its Domain Name System (DNS) must match the name of the computer. This is essential because one of the first steps the HTTPS mechanism performs is to check that the certificate is issued to the same Uniform Resource Identifier (URI) as the address upon which it is invoked.","leadings":["","    >  "],"nodes":[{"content":"The subject of the certificate or its Domain Name System (DNS) must match the name of the computer. This is essential because one of the first steps the HTTPS mechanism performs is to check that the certificate is issued to the same Uniform Resource Identifier (URI) as the address upon which it is invoked.","pos":[13,320],"nodes":[{"content":"The subject of the certificate or its Domain Name System (DNS) must match the name of the computer.","pos":[0,99]},{"content":"This is essential because one of the first steps the HTTPS mechanism performs is to check that the certificate is issued to the same Uniform Resource Identifier (URI) as the address upon which it is invoked.","pos":[100,307]}]}]},{"pos":[1762,1860],"content":"Create a new instance of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.ServiceMetadataBehavior&gt;</ph> class.","source":"Create a new instance of the <xref:System.ServiceModel.Description.ServiceMetadataBehavior> class."},{"pos":[1870,2055],"content":"Set the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.ServiceMetadataBehavior.HttpsGetEnabled%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.ServiceMetadataBehavior&gt;</ph> class to <ph id=\"ph3\">`true`</ph>.","source":"Set the <xref:System.ServiceModel.Description.ServiceMetadataBehavior.HttpsGetEnabled%2A> property of the <xref:System.ServiceModel.Description.ServiceMetadataBehavior> class to `true`."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.ServiceMetadataBehavior.HttpsGetUrl%2A&gt;</ph> property to an appropriate URL.","pos":[2065,2182],"source":"Set the <xref:System.ServiceModel.Description.ServiceMetadataBehavior.HttpsGetUrl%2A> property to an appropriate URL."},{"content":"Note that if you specify an absolute address, the URL must begin with the scheme \"https://\".","pos":[2183,2275]},{"content":"If you specify a relative address, you must supply an HTTPS base address for your service host.","pos":[2276,2371]},{"content":"If this property is not set, the default address is \"\", or directly at the HTTPS base address for the service.","pos":[2372,2482]},{"pos":[2492,2737],"content":"Add the instance to the behaviors collection that the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.ServiceDescription.Behaviors%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.ServiceDescription&gt;</ph> class returns, as shown in the following code.","source":"Add the instance to the behaviors collection that the <xref:System.ServiceModel.Description.ServiceDescription.Behaviors%2A> property of the <xref:System.ServiceModel.Description.ServiceDescription> class returns, as shown in the following code."},{"pos":[2748,3013],"content":"[!code-csharp[c_HowToSecureEndpoint#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howtosecureendpoint/cs/source.cs#1)]\n [!code-vb[c_HowToSecureEndpoint#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_howtosecureendpoint/vb/source.vb#1)]","leadings":["","    "],"nodes":[]},{"pos":[3023,3086],"content":"To create a secure HTTPS GET metadata endpoint in configuration","linkify":"To create a secure HTTPS GET metadata endpoint in configuration","nodes":[{"content":"To create a secure HTTPS GET metadata endpoint in configuration","pos":[0,63]}]},{"pos":[3096,3362],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>behaviors&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md)</ept> element to the <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>system.serviceModel&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/system-servicemodel.md)</ept> element of the configuration file for your service.","source":"Add a [\\<behaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md) element to the [\\<system.serviceModel>](../../../../docs/framework/configure-apps/file-schema/wcf/system-servicemodel.md) element of the configuration file for your service."},{"pos":[3372,3589],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceBehaviors&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md)</ept> element to the <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>behaviors&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md)</ept> element.","source":"Add a [\\<serviceBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md) element to the [\\<behaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md) element."},{"pos":[3599,3754],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>behavior&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/behavior-of-servicebehaviors.md)</ept> element to the <ph id=\"ph2\">`&lt;serviceBehaviors&gt;`</ph> element.","source":"Add a [\\<behavior>](../../../../docs/framework/configure-apps/file-schema/wcf/behavior-of-servicebehaviors.md) element to the `<serviceBehaviors>` element."},{"content":"Set the <ph id=\"ph1\">`name`</ph> attribute of the <ph id=\"ph2\">`&lt;behavior&gt;`</ph> element to an appropriate value.","pos":[3764,3841],"source":"Set the `name` attribute of the `<behavior>` element to an appropriate value."},{"content":"The <ph id=\"ph1\">`name`</ph> attribute is required.","pos":[3842,3875],"source":" The `name` attribute is required."},{"content":"The example below uses the value <ph id=\"ph1\">`mySvcBehavior`</ph>.","pos":[3876,3925],"source":" The example below uses the value `mySvcBehavior`."},{"pos":[3935,4068],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceMetadata&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicemetadata.md)</ept> to the <ph id=\"ph2\">`&lt;behavior&gt;`</ph> element.","source":"Add a [\\<serviceMetadata>](../../../../docs/framework/configure-apps/file-schema/wcf/servicemetadata.md) to the `<behavior>` element."},{"pos":[4078,4159],"content":"Set the <ph id=\"ph1\">`httpsGetEnabled`</ph> attribute of the <ph id=\"ph2\">`&lt;serviceMetadata&gt;`</ph> element to <ph id=\"ph3\">`true`</ph>.","source":"Set the `httpsGetEnabled` attribute of the `<serviceMetadata>` element to `true`."},{"content":"Set the <ph id=\"ph1\">`httpsGetUrl`</ph> attribute of the <ph id=\"ph2\">`&lt;serviceMetadata&gt;`</ph> element to an appropriate value.","pos":[4169,4260],"source":"Set the `httpsGetUrl` attribute of the `<serviceMetadata>` element to an appropriate value."},{"content":"Note that if you specify an absolute address, the URL must begin with the scheme \"https://\".","pos":[4261,4353]},{"content":"If you specify a relative address, you must supply an HTTPS base address for your service host.","pos":[4354,4449]},{"content":"If this property is not set, the default address is \"\", or directly at the HTTPS base address for the service.","pos":[4450,4560]},{"content":"To use the behavior with a service, set the <ph id=\"ph1\">`behaviorConfiguration`</ph> attribute of the <bpt id=\"p1\">[</bpt><ph id=\"ph2\">\\&lt;</ph>service&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/service.md)</ept> element to the value of the name attribute of the behavior element.","pos":[4570,4805],"source":"To use the behavior with a service, set the `behaviorConfiguration` attribute of the [\\<service>](../../../../docs/framework/configure-apps/file-schema/wcf/service.md) element to the value of the name attribute of the behavior element."},{"content":"The following configuration code shows a complete example.","pos":[4806,4864]},{"pos":[5707,5714],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example creates an instance of a <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceHost&gt;</ph> class and adds an endpoint.","pos":[5718,5831],"source":"The following example creates an instance of a <xref:System.ServiceModel.ServiceHost> class and adds an endpoint."},{"content":"The code then creates an instance of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.ServiceMetadataBehavior&gt;</ph> class and sets the properties to create a secure metadata exchange point.","pos":[5832,6009],"source":" The code then creates an instance of the <xref:System.ServiceModel.Description.ServiceMetadataBehavior> class and sets the properties to create a secure metadata exchange point."},{"pos":[6286,6304],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"The code example uses the following namespaces:","pos":[6308,6355]},{"pos":[6506,6514],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6747,6896],"content":"<bpt id=\"p1\">[</bpt>How to: Configure a Port with an SSL Certificate<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md)</ept>","source":"[How to: Configure a Port with an SSL Certificate](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md)"},{"pos":[6899,7003],"content":"<bpt id=\"p1\">[</bpt>Working with Certificates<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/working-with-certificates.md)</ept>","source":"[Working with Certificates](../../../../docs/framework/wcf/feature-details/working-with-certificates.md)"},{"pos":[7006,7134],"content":"<bpt id=\"p1\">[</bpt>Security Considerations with Metadata<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/security-considerations-with-metadata.md)</ept>","source":"[Security Considerations with Metadata](../../../../docs/framework/wcf/feature-details/security-considerations-with-metadata.md)"},{"pos":[7137,7249],"content":"<bpt id=\"p1\">[</bpt>Securing Services and Clients<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)</ept>","source":"[Securing Services and Clients](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)"}]}