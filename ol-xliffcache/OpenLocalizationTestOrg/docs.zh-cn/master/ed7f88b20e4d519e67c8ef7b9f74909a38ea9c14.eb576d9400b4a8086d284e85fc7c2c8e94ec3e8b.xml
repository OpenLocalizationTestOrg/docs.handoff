{"content":"---\ntitle: \"Changing Where My.Application.Log Writes Information (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"My.Application.Log object, walkthroughs\"\n  - \"event logs, changing output location\"\nms.assetid: ecc74f95-743c-450d-93f6-09a30db0fe4a\n---\n# Walkthrough: Changing Where My.Application.Log Writes Information (Visual Basic)\nYou can use the `My.Application.Log` and `My.Log` objects to log information about events that occur in your application. This walkthrough shows how to override the default settings and cause the `Log` object to write to other log listeners.  \n  \n## Prerequisites  \n The `Log` object can write information to several log listeners. You need to determine the current configuration of the log listeners before changing the configurations. For more information, see [Walkthrough: Determining Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md).  \n  \n You may want to review [How to: Write Event Information to a Text File](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-event-information-to-a-text-file.md) or [How to: Write to an Application Event Log](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-to-an-application-event-log.md).  \n  \n### To add listeners  \n  \n1.  Right-click app.config in **Solution Explorer** and choose **Open**.  \n  \n     \\- or -  \n  \n     If there is no app.config file:  \n  \n    1.  On the **Project** menu, choose **Add New Item**.  \n  \n    2.  From the **Add New Item** dialog box, select **Application Configuration File**.  \n  \n    3.  Click **Add**.  \n  \n2.  Locate the `<listeners>` section, under the `<source>` section with the `name` attribute \"DefaultSource\", in the `<sources>` section. The `<sources>` section is in the `<system.diagnostics>` section, in the top-level `<configuration>` section.  \n  \n3.  Add these elements to that `<listeners>` section.  \n  \n    ```xml  \n    <!-- Uncomment to connect the application file log. -->  \n    <!-- <add name=\"FileLog\" /> -->  \n    <!-- Uncomment to connect the event log. -->  \n    <!-- <add name=\"EventLog\" /> -->  \n    <!-- Uncomment to connect the event log. -->  \n    <!-- <add name=\"Delimited\" /> -->  \n    <!-- Uncomment to connect the XML log. -->  \n    <!-- <add name=\"XmlWriter\" /> -->  \n    <!-- Uncomment to connect the console log. -->  \n    <!-- <add name=\"Console\" /> -->  \n    ```  \n  \n4.  Uncomment the log listeners that you want to receive `Log` messages.  \n  \n5.  Locate the `<sharedListeners>` section, in the `<system.diagnostics>` section, in the top-level `<configuration>` section.  \n  \n6.  Add these elements to that `<sharedListeners>` section.  \n  \n    ```xml  \n    <add name=\"FileLog\"  \n         type=\"Microsoft.VisualBasic.Logging.FileLogTraceListener,   \n               Microsoft.VisualBasic, Version=8.0.0.0,   \n               Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\"  \n         initializeData=\"FileLogWriter\" />  \n    <add name=\"EventLog\"  \n         type=\"System.Diagnostics.EventLogTraceListener,   \n               System, Version=2.0.0.0,   \n               Culture=neutral, PublicKeyToken=b77a5c561934e089\"  \n         initializeData=\"sample application\"/>  \n    <add name=\"Delimited\"   \n         type=\"System.Diagnostics.DelimitedListTraceListener,   \n               System, Version=2.0.0.0,   \n               Culture=neutral, PublicKeyToken=b77a5c561934e089\"  \n         initializeData=\"c:\\temp\\sampleDelimitedFile.txt\"  \n         traceOutputOptions=\"DateTime\" />  \n    <add name=\"XmlWriter\"  \n         type=\"System.Diagnostics.XmlWriterTraceListener,   \n               System, Version=2.0.0.0,   \n               Culture=neutral, PublicKeyToken=b77a5c561934e089\"  \n         initializeData=\"c:\\temp\\sampleLogFile.xml\" />  \n    <add name=\"Console\"  \n         type=\"System.Diagnostics.ConsoleTraceListener,   \n               System, Version=2.0.0.0,   \n               Culture=neutral, PublicKeyToken=b77a5c561934e089\"  \n         initializeData=\"true\" />  \n    ```  \n  \n7.  The content of the app.config file should be similar to the following XML:  \n  \n    ```xml  \n    <?xml version=\"1.0\" encoding=\"utf-8\" ?>  \n    <configuration>  \n      <system.diagnostics>  \n        <sources>  \n          <!-- This section configures My.Application.Log -->  \n          <source name=\"DefaultSource\" switchName=\"DefaultSwitch\">  \n            <listeners>  \n              <add name=\"FileLog\"/>  \n              <!-- Uncomment to connect the application file log. -->  \n              <!-- <add name=\"FileLog\" /> -->  \n              <!-- Uncomment to connect the event log. -->  \n              <!-- <add name=\"EventLog\" /> -->  \n              <!-- Uncomment to connect the event log. -->  \n              <!-- <add name=\"Delimited\" /> -->  \n              <!-- Uncomment to connect the XML log. -->  \n              <!-- <add name=\"XmlWriter\" /> -->  \n              <!-- Uncomment to connect the console log. -->  \n              <!-- <add name=\"Console\" /> -->  \n            </listeners>  \n          </source>  \n        </sources>  \n        <switches>  \n          <add name=\"DefaultSwitch\" value=\"Information\" />  \n        </switches>  \n        <sharedListeners>  \n          <add name=\"FileLog\"  \n               type=\"Microsoft.VisualBasic.Logging.FileLogTraceListener,   \n                     Microsoft.VisualBasic, Version=8.0.0.0,   \n                     Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\"  \n               initializeData=\"FileLogWriter\" />  \n          <add name=\"EventLog\"  \n               type=\"System.Diagnostics.EventLogTraceListener,   \n                     System, Version=2.0.0.0,   \n                     Culture=neutral, PublicKeyToken=b77a5c561934e089\"  \n               initializeData=\"sample application\"/>  \n          <add name=\"Delimited\"   \n               type=\"System.Diagnostics.DelimitedListTraceListener,   \n                     System, Version=2.0.0.0,   \n                     Culture=neutral, PublicKeyToken=b77a5c561934e089\"  \n               initializeData=\"c:\\temp\\sampleDelimitedFile.txt\"  \n               traceOutputOptions=\"DateTime\" />  \n          <add name=\"XmlWriter\"  \n               type=\"System.Diagnostics.XmlWriterTraceListener,   \n                     System, Version=2.0.0.0,   \n                     Culture=neutral, PublicKeyToken=b77a5c561934e089\"  \n               initializeData=\"c:\\temp\\sampleLogFile.xml\" />  \n          <add name=\"Console\"  \n               type=\"System.Diagnostics.ConsoleTraceListener,   \n                     System, Version=2.0.0.0,   \n                     Culture=neutral, PublicKeyToken=b77a5c561934e089\"  \n               initializeData=\"true\" />  \n        </sharedListeners>  \n      </system.diagnostics>  \n    </configuration>  \n    ```  \n  \n### To reconfigure a listener  \n  \n1.  Locate the listener's `<add>` element from the `<sharedListeners>` section.  \n  \n2.  The `type` attribute gives the name of the listener type. This type must inherit from the <xref:System.Diagnostics.TraceListener> class. Use the strongly named type name to ensure that the right type is used. For more information, see the \"To reference a strongly named type\" section below.  \n  \n     Some types that you can use are:  \n  \n    -   A <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener?displayProperty=nameWithType> listener, which writes to a file log.  \n  \n    -   A <xref:System.Diagnostics.EventLogTraceListener?displayProperty=nameWithType> listener, which writes information to the computer event log specified by the `initializeData` parameter.  \n  \n    -   The <xref:System.Diagnostics.DelimitedListTraceListener?displayProperty=nameWithType> and <xref:System.Diagnostics.XmlWriterTraceListener?displayProperty=nameWithType> listeners, which write to the file specified in the `initializeData` parameter.  \n  \n    -   A <xref:System.Diagnostics.ConsoleTraceListener?displayProperty=nameWithType> listener, which writes to the command-line console.  \n  \n     For information about where other types of log listeners write information, consult that type's documentation.  \n  \n3.  When the application creates the log-listener object, it passes the `initializeData` attribute as the constructor parameter. The meaning of the `initializeData` attribute depends on the trace listener.  \n  \n4.  After creating the log listener, the application sets the listener's properties. These properties are defined by the other attributes in the `<add>` element. For more information on the properties for a particular listener, see the documentation for that listener's type.  \n  \n### To reference a strongly named type  \n  \n1.  To ensure that the right type is used for your log listener, make sure to use the fully qualified type name and the strongly named assembly name. The syntax of a strongly named type is as follows:  \n  \n     \\<*type name*>, \\<*assembly name*>, \\<*version number*>, \\<*culture*>, \\<*strong name*>  \n  \n2.  This code example shows how to determine the strongly named type name for a fully qualified type—\"System.Diagnostics.FileLogTraceListener\" in this case.  \n  \n     [!code-vb[VbVbalrMyApplicationLog#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyApplicationLog/VB/Form1.vb#15)]  \n  \n     This is the output, and it can be used to uniquely reference a strongly named type, as in the \"To add listeners\" procedure above.  \n  \n     `Microsoft.VisualBasic.Logging.FileLogTraceListener, Microsoft.VisualBasic, Version=8.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a`  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.Logging.Log?displayProperty=nameWithType>\n- <xref:System.Diagnostics.TraceListener>\n- <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener?displayProperty=nameWithType>\n- <xref:System.Diagnostics.EventLogTraceListener?displayProperty=nameWithType>\n- [How to: Write Event Information to a Text File](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-event-information-to-a-text-file.md)\n- [How to: Write to an Application Event Log](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-to-an-application-event-log.md)\n","nodes":[{"pos":[4,260],"embed":true,"restype":"x-metadata","content":"title: \"Changing Where My.Application.Log Writes Information (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"My.Application.Log object, walkthroughs\"\n  - \"event logs, changing output location\"\nms.assetid: ecc74f95-743c-450d-93f6-09a30db0fe4a","nodes":[{"content":"Changing Where My.Application.Log Writes Information (Visual Basic)","nodes":[{"pos":[0,67],"content":"Changing Where My.Application.Log Writes Information (Visual Basic)","nodes":[{"content":"Changing Where My.Application.Log Writes Information (Visual Basic)","pos":[0,67]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[267,347],"content":"Walkthrough: Changing Where My.Application.Log Writes Information (Visual Basic)","linkify":"Walkthrough: Changing Where My.Application.Log Writes Information (Visual Basic)","nodes":[{"content":"Walkthrough: Changing Where My.Application.Log Writes Information (Visual Basic)","pos":[0,80]}]},{"content":"You can use the <ph id=\"ph1\">`My.Application.Log`</ph> and <ph id=\"ph2\">`My.Log`</ph> objects to log information about events that occur in your application.","pos":[348,469],"source":"You can use the `My.Application.Log` and `My.Log` objects to log information about events that occur in your application."},{"content":"This walkthrough shows how to override the default settings and cause the <ph id=\"ph1\">`Log`</ph> object to write to other log listeners.","pos":[470,589],"source":" This walkthrough shows how to override the default settings and cause the `Log` object to write to other log listeners."},{"pos":[598,611],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"The <ph id=\"ph1\">`Log`</ph> object can write information to several log listeners.","pos":[615,679],"source":"The `Log` object can write information to several log listeners."},{"content":"You need to determine the current configuration of the log listeners before changing the configurations.","pos":[680,784]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Determining Where My.Application.Log Writes Information<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)</ept>.","pos":[785,1016],"source":" For more information, see [Walkthrough: Determining Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)."},{"pos":[1023,1361],"content":"You may want to review <bpt id=\"p1\">[</bpt>How to: Write Event Information to a Text File<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-event-information-to-a-text-file.md)</ept> or <bpt id=\"p2\">[</bpt>How to: Write to an Application Event Log<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-to-an-application-event-log.md)</ept>.","source":"You may want to review [How to: Write Event Information to a Text File](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-event-information-to-a-text-file.md) or [How to: Write to an Application Event Log](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-to-an-application-event-log.md)."},{"pos":[1371,1387],"content":"To add listeners","linkify":"To add listeners","nodes":[{"content":"To add listeners","pos":[0,16]}]},{"pos":[1397,1465],"content":"Right-click app.config in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and choose <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","source":"Right-click app.config in **Solution Explorer** and choose **Open**."},{"content":"<ph id=\"ph1\">\\-</ph> or -","pos":[1476,1483],"source":"\\- or -"},{"content":"If there is no app.config file:","pos":[1494,1525]},{"pos":[1539,1588],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Add New Item<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, choose **Add New Item**."},{"pos":[1602,1682],"content":"From the <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> dialog box, select <bpt id=\"p2\">**</bpt>Application Configuration File<ept id=\"p2\">**</ept>.","source":"From the **Add New Item** dialog box, select **Application Configuration File**."},{"pos":[1696,1710],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","source":"Click **Add**."},{"content":"Locate the <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section, under the <ph id=\"ph2\">`&lt;source&gt;`</ph> section with the <ph id=\"ph3\">`name`</ph> attribute \"DefaultSource\", in the <ph id=\"ph4\">`&lt;sources&gt;`</ph> section.","pos":[1720,1853],"source":"Locate the `<listeners>` section, under the `<source>` section with the `name` attribute \"DefaultSource\", in the `<sources>` section."},{"content":"The <ph id=\"ph1\">`&lt;sources&gt;`</ph> section is in the <ph id=\"ph2\">`&lt;system.diagnostics&gt;`</ph> section, in the top-level <ph id=\"ph3\">`&lt;configuration&gt;`</ph> section.","pos":[1854,1963],"source":" The `<sources>` section is in the `<system.diagnostics>` section, in the top-level `<configuration>` section."},{"pos":[1973,2022],"content":"Add these elements to that <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section.","source":"Add these elements to that `<listeners>` section."},{"pos":[2519,2587],"content":"Uncomment the log listeners that you want to receive <ph id=\"ph1\">`Log`</ph> messages.","source":"Uncomment the log listeners that you want to receive `Log` messages."},{"pos":[2597,2719],"content":"Locate the <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> section, in the <ph id=\"ph2\">`&lt;system.diagnostics&gt;`</ph> section, in the top-level <ph id=\"ph3\">`&lt;configuration&gt;`</ph> section.","source":"Locate the `<sharedListeners>` section, in the `<system.diagnostics>` section, in the top-level `<configuration>` section."},{"pos":[2729,2784],"content":"Add these elements to that <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> section.","source":"Add these elements to that `<sharedListeners>` section."},{"content":"The content of the app.config file should be similar to the following XML:","pos":[4127,4201]},{"pos":[6859,6884],"content":"To reconfigure a listener","linkify":"To reconfigure a listener","nodes":[{"content":"To reconfigure a listener","pos":[0,25]}]},{"pos":[6894,6969],"content":"Locate the listener's <ph id=\"ph1\">`&lt;add&gt;`</ph> element from the <ph id=\"ph2\">`&lt;sharedListeners&gt;`</ph> section.","source":"Locate the listener's `<add>` element from the `<sharedListeners>` section."},{"content":"The <ph id=\"ph1\">`type`</ph> attribute gives the name of the listener type.","pos":[6979,7036],"source":"The `type` attribute gives the name of the listener type."},{"content":"This type must inherit from the <ph id=\"ph1\">&lt;xref:System.Diagnostics.TraceListener&gt;</ph> class.","pos":[7037,7115],"source":" This type must inherit from the <xref:System.Diagnostics.TraceListener> class."},{"content":"Use the strongly named type name to ensure that the right type is used.","pos":[7116,7187]},{"content":"For more information, see the \"To reference a strongly named type\" section below.","pos":[7188,7269]},{"content":"Some types that you can use are:","pos":[7280,7312]},{"pos":[7326,7452],"content":"A <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.Logging.FileLogTraceListener?displayProperty=nameWithType&gt;</ph> listener, which writes to a file log.","source":"A <xref:Microsoft.VisualBasic.Logging.FileLogTraceListener?displayProperty=nameWithType> listener, which writes to a file log."},{"pos":[7466,7650],"content":"A <ph id=\"ph1\">&lt;xref:System.Diagnostics.EventLogTraceListener?displayProperty=nameWithType&gt;</ph> listener, which writes information to the computer event log specified by the <ph id=\"ph2\">`initializeData`</ph> parameter.","source":"A <xref:System.Diagnostics.EventLogTraceListener?displayProperty=nameWithType> listener, which writes information to the computer event log specified by the `initializeData` parameter."},{"pos":[7664,7911],"content":"The <ph id=\"ph1\">&lt;xref:System.Diagnostics.DelimitedListTraceListener?displayProperty=nameWithType&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Diagnostics.XmlWriterTraceListener?displayProperty=nameWithType&gt;</ph> listeners, which write to the file specified in the <ph id=\"ph3\">`initializeData`</ph> parameter.","source":"The <xref:System.Diagnostics.DelimitedListTraceListener?displayProperty=nameWithType> and <xref:System.Diagnostics.XmlWriterTraceListener?displayProperty=nameWithType> listeners, which write to the file specified in the `initializeData` parameter."},{"pos":[7925,8054],"content":"A <ph id=\"ph1\">&lt;xref:System.Diagnostics.ConsoleTraceListener?displayProperty=nameWithType&gt;</ph> listener, which writes to the command-line console.","source":"A <xref:System.Diagnostics.ConsoleTraceListener?displayProperty=nameWithType> listener, which writes to the command-line console."},{"content":"For information about where other types of log listeners write information, consult that type's documentation.","pos":[8065,8175]},{"content":"When the application creates the log-listener object, it passes the <ph id=\"ph1\">`initializeData`</ph> attribute as the constructor parameter.","pos":[8185,8309],"source":"When the application creates the log-listener object, it passes the `initializeData` attribute as the constructor parameter."},{"content":"The meaning of the <ph id=\"ph1\">`initializeData`</ph> attribute depends on the trace listener.","pos":[8310,8386],"source":" The meaning of the `initializeData` attribute depends on the trace listener."},{"content":"After creating the log listener, the application sets the listener's properties.","pos":[8396,8476]},{"content":"These properties are defined by the other attributes in the <ph id=\"ph1\">`&lt;add&gt;`</ph> element.","pos":[8477,8553],"source":" These properties are defined by the other attributes in the `<add>` element."},{"content":"For more information on the properties for a particular listener, see the documentation for that listener's type.","pos":[8554,8667]},{"pos":[8677,8711],"content":"To reference a strongly named type","linkify":"To reference a strongly named type","nodes":[{"content":"To reference a strongly named type","pos":[0,34]}]},{"content":"To ensure that the right type is used for your log listener, make sure to use the fully qualified type name and the strongly named assembly name.","pos":[8721,8866]},{"content":"The syntax of a strongly named type is as follows:","pos":[8867,8917]},{"pos":[8928,9015],"content":"<ph id=\"ph1\">\\&lt;</ph><bpt id=\"p1\">*</bpt>type name<ept id=\"p1\">*</ept>&gt;, <ph id=\"ph2\">\\&lt;</ph><bpt id=\"p2\">*</bpt>assembly name<ept id=\"p2\">*</ept>&gt;, <ph id=\"ph3\">\\&lt;</ph><bpt id=\"p3\">*</bpt>version number<ept id=\"p3\">*</ept>&gt;, <ph id=\"ph4\">\\&lt;</ph><bpt id=\"p4\">*</bpt>culture<ept id=\"p4\">*</ept>&gt;, <ph id=\"ph5\">\\&lt;</ph><bpt id=\"p5\">*</bpt>strong name<ept id=\"p5\">*</ept><ph id=\"ph6\">&gt;</ph>","source":"\\<*type name*>, \\<*assembly name*>, \\<*version number*>, \\<*culture*>, \\<*strong name*>"},{"content":"This code example shows how to determine the strongly named type name for a fully qualified type—\"System.Diagnostics.FileLogTraceListener\" in this case.","pos":[9025,9177]},{"content":"This is the output, and it can be used to uniquely reference a strongly named type, as in the \"To add listeners\" procedure above.","pos":[9329,9458]},{"pos":[9620,9628],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[9914,10074],"content":"<bpt id=\"p1\">[</bpt>How to: Write Event Information to a Text File<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-event-information-to-a-text-file.md)</ept>","source":"[How to: Write Event Information to a Text File](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-event-information-to-a-text-file.md)"},{"pos":[10077,10227],"content":"<bpt id=\"p1\">[</bpt>How to: Write to an Application Event Log<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-to-an-application-event-log.md)</ept>","source":"[How to: Write to an Application Event Log](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-to-an-application-event-log.md)"}]}