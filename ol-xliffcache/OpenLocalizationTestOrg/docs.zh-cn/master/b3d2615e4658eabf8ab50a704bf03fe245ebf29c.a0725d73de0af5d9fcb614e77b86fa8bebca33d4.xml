{"content":"---\ntitle: \"Walkthrough: Creating a Windows Service Application in the Component Designer | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"Windows Service applications, walkthroughs\"\n  - \"Windows Service applications, creating\"\nms.assetid: e24d8a3d-edc6-485c-b6e0-5672d91fb607\ncaps.latest.revision: 57\nauthor: \"ghogen\"\nms.author: \"ghogen\"\nmanager: \"douge\"\n---\n# Walkthrough: Creating a Windows Service Application in the Component Designer\nThis article demonstrates how to create a simple Windows Service application in Visual Studio that writes messages to an event log. Here are the basic steps that you perform to create and use your service:  \n  \n1.  [Creating a Service](#BK_CreateProject) by using the **Windows Service** project template, and configure it. This template creates a class for you that inherits from <xref:System.ServiceProcess.ServiceBase?displayProperty=fullName> and writes much of the basic service code, such as the code to start the service.  \n  \n2.  [Adding Features to the Service](#BK_WriteCode) for the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> procedures, and override any other methods that you want to redefine.  \n  \n3.  [Setting Service Status](#BK_SetStatus). By default, services created with <xref:System.ServiceProcess.ServiceBase?displayProperty=fullName> implement only a subset of the available status flags. If your service takes a long time to start up, pause, or stop, you can implement status values such as Start Pending or Stop Pending to indicate that it's working on an operation.  \n  \n4.  [Adding Installers to the Service](#BK_AddInstallers) for your service application.  \n  \n5.  (Optional) [Set Startup Parameters](#BK_StartupParameters), specify default startup arguments, and enable users to override default settings when they start your service manually.  \n  \n6.  [Building the Service](#BK_Build).  \n  \n7.  [Installing the Service](#BK_Install) on the local machine.  \n  \n8.  Access the Windows Service Control Manager and [Starting and Running the Service](#BK_StartService).  \n  \n9. [Uninstalling a Windows Service](#BK_Uninstall).  \n  \n> [!WARNING]\n>  The Windows Services project template that is required for this walkthrough is not available in the Express edition of Visual Studio.  \n  \n [!INCLUDE[note_settings_general](../../../includes/note-settings-general-md.md)]  \n  \n<a name=\"BK_CreateProject\"></a>   \n## Creating a Service  \n To begin, you create the project and set values that are required for the service to function correctly.  \n  \n#### To create and configure your service  \n  \n1.  In Visual Studio, on the menu bar, choose **File**, **New**, **Project**.  \n  \n     The **New Project** dialog box opens.  \n  \n2.  In the list of Visual Basic or Visual C# project templates, choose **Windows Service**, and name the project **MyNewService**. Choose **OK**.  \n  \n     The project template automatically adds a component class named `Service1` that inherits from <xref:System.ServiceProcess.ServiceBase?displayProperty=fullName>.  \n  \n3.  On the **Edit** menu, choose **Find and Replace**, **Find in Files** (Keyboard: Ctrl+Shift+F). Change all occurrences of `Service1` to `MyNewService`. You’ll find instances in Service1.cs, Program.cs, and Service1.Designer.cs (or their .vb equivalents).  \n  \n4.  In the **Properties** window for **Service1.cs [Design]** or **Service1.vb [Design]**, set the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> and the **(Name)** property for `Service1` to **MyNewService**, if it's not already set.  \n  \n5.  In Solution Explorer, rename **Service1.cs** to **MyNewService.cs**, or **Service1.vb** to **MyNewService.vb**.  \n  \n<a name=\"BK_WriteCode\"></a>   \n## Adding Features to the Service  \n In this section, you add a custom event log to the Windows service. Event logs are not associated in any way with Windows services. Here the <xref:System.Diagnostics.EventLog> component is used as an example of the type of component you could add to a Windows service.  \n  \n#### To add custom event log functionality to your service  \n  \n1.  In **Solution Explorer**, open the context menu for **MyNewService.cs** or **MyNewService.vb**, and then choose **View Designer**.  \n  \n2.  From the **Components** section of the **Toolbox**, drag an <xref:System.Diagnostics.EventLog> component to the designer.  \n  \n3.  In **Solution Explorer**, open the context menu for **MyNewService.cs** or **MyNewService.vb**, and then choose **View Code**.  \n  \n4.  Add a declaration for the **eventLog** object in the `MyNewService` class, right after the line that declares the `components` variable:  \n  \n     [!code-csharp[VbRadconService#16](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#16)]\n     [!code-vb[VbRadconService#16](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#16)]  \n  \n5.  Add or edit the constructor to define a custom event log:  \n  \n     [!code-csharp[VbRadconService#2](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#2)]\n     [!code-vb[VbRadconService#2](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#2)]  \n  \n#### To define what occurs when the service starts  \n  \n-   In the Code Editor, locate the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method that was automatically overridden when you created the project, and replace the code with the following. This adds an entry to the event log when the service starts running:  \n  \n     [!code-csharp[VbRadconService#3](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#3)]\n     [!code-vb[VbRadconService#3](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#3)]  \n  \n     A service application is designed to be long-running, so it usually polls or monitors something in the system. The monitoring is set up in the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method. However, <xref:System.ServiceProcess.ServiceBase.OnStart%2A> doesn’t actually do the monitoring. The <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method must return to the operating system after the service's operation has begun. It must not loop forever or block. To set up a simple polling mechanism, you can use the <xref:System.Timers.Timer?displayProperty=fullName> component as follows: In the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method, set parameters on the component, and then set the <xref:System.Timers.Timer.Enabled%2A> property to `true`. The timer raises events in your code periodically, at which time your service could do its monitoring. You can use the following code to do this:  \n  \n    ```csharp  \n    // Set up a timer to trigger every minute.  \n    System.Timers.Timer timer = new System.Timers.Timer();  \n    timer.Interval = 60000; // 60 seconds  \n    timer.Elapsed += new System.Timers.ElapsedEventHandler(this.OnTimer);  \n    timer.Start();  \n    ```  \n  \n    ```vb  \n    ' Set up a timer to trigger every minute.  \n    Dim timer As System.Timers.Timer = New System.Timers.Timer()  \n    timer.Interval = 60000 ' 60 seconds  \n    AddHandler timer.Elapsed, AddressOf Me.OnTimer  \n    timer.Start()  \n    ```  \n  \n     Add code to handle the timer event:  \n  \n    ```csharp  \n    public void OnTimer(object sender, System.Timers.ElapsedEventArgs args)  \n    {  \n        // TODO: Insert monitoring activities here.  \n        eventLog1.WriteEntry(\"Monitoring the System\", EventLogEntryType.Information, eventId++);  \n    }  \n    ```  \n  \n    ```vb  \n    Private Sub OnTimer(sender As Object, e As Timers.ElapsedEventArgs)  \n        ' TODO: Insert monitoring activities here.  \n        eventLog1.WriteEntry(\"Monitoring the System\", EventLogEntryType.Information, eventId)  \n        eventId = eventId + 1  \n    End Sub  \n    ```  \n  \n     You might want to perform tasks by using background worker threads instead of running all your work on the main thread. For an example of this, see the <xref:System.ServiceProcess.ServiceBase?displayProperty=fullName> reference page.  \n  \n#### To define what occurs when the service is stopped  \n  \n-   Replace the code for the <xref:System.ServiceProcess.ServiceBase.OnStop%2A> method with the following. This adds an entry to the event log when the service is stopped:  \n  \n     [!code-csharp[VbRadconService#4](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#4)]\n     [!code-vb[VbRadconService#4](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#4)]  \n  \n In the next section, you can override the <xref:System.ServiceProcess.ServiceBase.OnPause%2A>, <xref:System.ServiceProcess.ServiceBase.OnContinue%2A>, and <xref:System.ServiceProcess.ServiceBase.OnShutdown%2A> methods to define additional processing for your component.  \n  \n#### To define other actions for the service  \n  \n-   Locate the method that you want to handle, and override it to define what you want to occur.  \n  \n     The following code shows how you can override the <xref:System.ServiceProcess.ServiceBase.OnContinue%2A> method:  \n  \n     [!code-csharp[VbRadconService#5](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#5)]\n     [!code-vb[VbRadconService#5](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#5)]  \n  \n Some custom actions have to occur when a Windows service is installed by the <xref:System.Configuration.Install.Installer> class. Visual Studio can create these installers specifically for a Windows service and add them to your project.  \n  \n<a name=\"BK_SetStatus\"></a>   \n## Setting Service Status  \n Services report their status to the Service Control Manager, so that users can tell whether a service is functioning correctly. By default, services that inherit from <xref:System.ServiceProcess.ServiceBase> report a limited set of status settings, including Stopped, Paused, and Running. If a service takes a little while to start up, it might be helpful to report a Start Pending status. You can also implement the Start Pending and Stop Pending status settings by adding code that calls into the Windows [SetServiceStatus function](http://msdn.microsoft.com/library/windows/desktop/ms686241.aspx).  \n  \n#### To implement service pending status  \n  \n1.  Add a `using` statement or `Imports` declaration to the <xref:System.Runtime.InteropServices?displayProperty=fullName> namespace in the MyNewService.cs or MyNewService.vb file:  \n  \n    ```csharp  \n    using System.Runtime.InteropServices;  \n    ```  \n  \n    ```vb  \n    Imports System.Runtime.InteropServices  \n    ```  \n  \n2.  Add the following code to MyNewService.cs to declare the `ServiceState` values and to add a structure for the status, which you'll use in a platform invoke call:  \n  \n    ```csharp  \n    public enum ServiceState  \n      {  \n          SERVICE_STOPPED = 0x00000001,  \n          SERVICE_START_PENDING = 0x00000002,  \n          SERVICE_STOP_PENDING = 0x00000003,  \n          SERVICE_RUNNING = 0x00000004,  \n          SERVICE_CONTINUE_PENDING = 0x00000005,  \n          SERVICE_PAUSE_PENDING = 0x00000006,  \n          SERVICE_PAUSED = 0x00000007,  \n      }  \n  \n      [StructLayout(LayoutKind.Sequential)]  \n      public struct ServiceStatus  \n      {  \n          public long dwServiceType;  \n          public ServiceState dwCurrentState;  \n          public long dwControlsAccepted;  \n          public long dwWin32ExitCode;  \n          public long dwServiceSpecificExitCode;  \n          public long dwCheckPoint;  \n          public long dwWaitHint;  \n      };  \n    ```  \n  \n    ```vb  \n    Public Enum ServiceState  \n        SERVICE_STOPPED = 1  \n        SERVICE_START_PENDING = 2  \n        SERVICE_STOP_PENDING = 3  \n        SERVICE_RUNNING = 4  \n        SERVICE_CONTINUE_PENDING = 5  \n        SERVICE_PAUSE_PENDING = 6  \n        SERVICE_PAUSED = 7  \n    End Enum  \n  \n    <StructLayout(LayoutKind.Sequential)>  \n    Public Structure ServiceStatus  \n        Public dwServiceType As Long  \n        Public dwCurrentState As ServiceState  \n        Public dwControlsAccepted As Long  \n        Public dwWin32ExitCode As Long  \n        Public dwServiceSpecificExitCode As Long  \n        Public dwCheckPoint As Long  \n        Public dwWaitHint As Long  \n    End Structure  \n    ```  \n  \n3.  Now, in the `MyNewService` class, declare the [SetServiceStatus function](http://msdn.microsoft.com/library/windows/desktop/ms686241.aspx) by using platform invoke:  \n  \n    ```csharp  \n    [DllImport(\"advapi32.dll\", SetLastError=true)]  \n            private static extern bool SetServiceStatus(IntPtr handle, ref ServiceStatus serviceStatus);  \n  \n    ```  \n  \n    ```vb  \n    Declare Auto Function SetServiceStatus Lib \"advapi32.dll\" (ByVal handle As IntPtr, ByRef serviceStatus As ServiceStatus) As Boolean  \n    ```  \n  \n4.  To implement the Start Pending status, add the following code to the beginning of the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method:  \n  \n    ```csharp  \n    // Update the service state to Start Pending.  \n    ServiceStatus serviceStatus = new ServiceStatus();  \n    serviceStatus.dwCurrentState = ServiceState.SERVICE_START_PENDING;  \n    serviceStatus.dwWaitHint = 100000;  \n    SetServiceStatus(this.ServiceHandle, ref serviceStatus);  \n    ```  \n  \n    ```vb  \n    ' Update the service state to Start Pending.  \n    Dim serviceStatus As ServiceStatus = New ServiceStatus()  \n    serviceStatus.dwCurrentState = ServiceState.SERVICE_START_PENDING  \n    serviceStatus.dwWaitHint = 100000  \n    SetServiceStatus(Me.ServiceHandle, serviceStatus)  \n    ```  \n  \n5.  Add code to set the status to Running at the end of the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method.  \n  \n    ```  \n    // Update the service state to Running.  \n    serviceStatus.dwCurrentState = ServiceState.SERVICE_RUNNING;  \n    SetServiceStatus(this.ServiceHandle, ref serviceStatus);  \n    ```  \n  \n    ```vb  \n    ' Update the service state to Running.  \n    serviceStatus.dwCurrentState = ServiceState.SERVICE_RUNNING  \n    SetServiceStatus(Me.ServiceHandle, serviceStatus)  \n    ```  \n  \n6.  (Optional) Repeat this procedure for the <xref:System.ServiceProcess.ServiceBase.OnStop%2A> method.  \n  \n> [!CAUTION]\n>  The [Service Control Manager](http://msdn.microsoft.com/library/windows/desktop/ms685150.aspx) uses the `dwWaitHint` and `dwCheckpoint` members of the [SERVICE_STATUS structure](http://msdn.microsoft.com/library/windows/desktop/ms685996.aspx) to determine how much time to wait for a Windows Service to start or shut down. If your <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> methods run long, your service can request more time by calling [SetServiceStatus](http://msdn.microsoft.com/library/windows/desktop/ms686241.aspx) again with an incremented `dwCheckPoint` value.  \n  \n<a name=\"BK_AddInstallers\"></a>   \n## Adding Installers to the Service  \n Before you can run a Windows Service, you need to install it, which registers it with the Service Control Manager. You can add installers to your project that handle the registration details.  \n  \n#### To create the installers for your service  \n  \n1.  In **Solution Explorer**, open the context menu for **MyNewService.cs** or **MyNewService.vb**, and then choose **View Designer**.  \n  \n2.  Click the background of the designer to select the service itself, instead of any of its contents.  \n  \n3.  Open the context menu for the designer window (if you’re using a pointing device, right-click inside the window), and then choose **Add Installer**.  \n  \n     By default, a component class that contains two installers is added to your project. The component is named **ProjectInstaller**, and the installers it contains are the installer for your service and the installer for the service's associated process.  \n  \n4.  In **Design** view for **ProjectInstaller**, choose **serviceInstaller1** for a Visual C# project, or **ServiceInstaller1** for a Visual Basic project.  \n  \n5.  In the **Properties** window, make sure the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> property is set to **MyNewService**.  \n  \n6.  Set the **Description** property to some text, such as \"A sample service\". This text appears in the Services window and helps the user identify the service and understand what it’s used for.  \n  \n7.  Set the <xref:System.ServiceProcess.ServiceInstaller.DisplayName%2A> property to the text that you want to appear in the Services window in the **Name** column. For example, you can enter \"MyNewService Display Name\". This name can be different from the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> property, which is the name used by the system (for example, when you use the `net start` command to start your service).  \n  \n8.  Set the <xref:System.ServiceProcess.ServiceInstaller.StartType%2A> property to <xref:System.ServiceProcess.ServiceStartMode>.  \n  \n     ![Installer Properties for a Windows Service](../../../docs/framework/windows-services/media/windowsservice-installerproperties.PNG \"WindowsService_InstallerProperties\")  \n  \n9. In the designer, choose **serviceProcessInstaller1** for a Visual C# project, or **ServiceProcessInstaller1** for a Visual Basic project. Set the <xref:System.ServiceProcess.ServiceProcessInstaller.Account%2A> property to <xref:System.ServiceProcess.ServiceAccount>. This will cause the service to be installed and to run on a local service account.  \n  \n    > [!IMPORTANT]\n    >  The <xref:System.ServiceProcess.ServiceAccount> account has broad permissions, including the ability to write to the event log. Use this account with caution, because it might increase your risk of attacks from malicious software. For other tasks, consider using the <xref:System.ServiceProcess.ServiceAccount> account, which acts as a non-privileged user on the local computer and presents anonymous credentials to any remote server. This example fails if you try to use the <xref:System.ServiceProcess.ServiceAccount> account, because it needs permission to write to the event log.  \n  \n     For more information about installers, see [How to: Add Installers to Your Service Application](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md).  \n  \n<a name=\"BK_StartupParameters\"></a>   \n## Set Startup Parameters  \n A Windows Service, like any other executable, can accept command-line arguments, or startup parameters. When you add code to process startup parameters, users can start your service with their own custom startup parameters by using the Services window in the Windows Control Panel. However, these startup parameters are not persisted the next time the service starts. To set startup parameters permanently, you can set them in the registry, as shown in this procedure.  \n  \n> [!NOTE]\n>  Before you decide to add startup parameters, consider whether that is the best way to pass information to your service. Although startup parameters are easy to use and to parse, and users can easily override them, they might be harder for users to discover and use without documentation. Generally, if your service requires more than just a few startup parameters, you should consider using the registry or a configuration file instead. Every Windows Service has an entry in the registry under HKLM\\System\\CurrentControlSet\\services. Under the service's key, you can use the **Parameters** subkey to store information that your service can access. You can use application configuration files for a Windows Service the same way you do for other types of programs. For example code, see <xref:System.Configuration.ConfigurationManager.AppSettings%2A>.  \n  \n#### Adding startup parameters  \n  \n1.  In the `Main` method in Program.cs or in MyNewService.Designer.vb, add an argument for the command line:  \n  \n    ```csharp  \n    static void Main(string[] args)        {            ServiceBase[] ServicesToRun;            ServicesToRun = new ServiceBase[]             {                 new MyNewService(args)             };            ServiceBase.Run(ServicesToRun);        }  \n    ```  \n  \n    ```vb  \n    Shared Sub Main(ByVal cmdArgs() As String)        Dim ServicesToRun() As System.ServiceProcess.ServiceBase        ServicesToRun = New System.ServiceProcess.ServiceBase() {New MyNewServiceVB(cmdArgs)}        System.ServiceProcess.ServiceBase.Run(ServicesToRun)    End Sub  \n    ```  \n  \n2.  Change the `MyNewService` constructor as follows:  \n  \n    ```csharp  \n    public MyNewService(string[] args)        {            InitializeComponent();            string eventSourceName = \"MySource\";            string logName = \"MyNewLog\";            if (args.Count() > 0)            {                eventSourceName = args[0];            }            if (args.Count() > 1)            {                logName = args[1];            }            eventLog1 = new System.Diagnostics.EventLog();            if (!System.Diagnostics.EventLog.SourceExists(eventSourceName))            {                System.Diagnostics.EventLog.CreateEventSource(                    eventSourceName, logName);            }            eventLog1.Source = eventSourceName;            eventLog1.Log = logName;        }  \n    ```  \n  \n    ```vb  \n    Public Sub New(ByVal cmdArgs() As String)        InitializeComponent()        Dim eventSourceName As String = \"MySource\"        Dim logName As String = \"MyNewLog\"        If (cmdArgs.Count() > 0) Then            eventSourceName = cmdArgs(0)        End If        If (cmdArgs.Count() > 1) Then            logName = cmdArgs(1)        End If        eventLog1 = New System.Diagnostics.EventLog()        If (Not System.Diagnostics.EventLog.SourceExists(eventSourceName)) Then            System.Diagnostics.EventLog.CreateEventSource(                eventSourceName, logName)        End If        eventLog1.Source = eventSourceName        eventLog1.Log = logName    End Sub  \n    ```  \n  \n     This code sets the event source and log name according to the supplied startup parameters, or uses default values if no arguments are supplied.  \n  \n3.  To specify the command-line arguments, add the following code to the `ProjectInstaller` class in ProjectInstaller.cs or ProjectInstaller.vb:  \n  \n    ```csharp  \n    protected override void OnBeforeInstall(IDictionary savedState)        {            string parameter = \"MySource1\\\" \\\"MyLogFile1\";            Context.Parameters[\"assemblypath\"] = \"\\\"\" + Context.Parameters[\"assemblypath\"] + \"\\\" \\\"\" + parameter + \"\\\"\";            base.OnBeforeInstall(savedState);        }  \n    ```  \n  \n    ```vb  \n    Protected Overrides Sub OnBeforeInstall(ByVal savedState As IDictionary)        Dim parameter As String = \"MySource1\"\" \"\"MyLogFile1\"        Context.Parameters(\"assemblypath\") = \"\"\"\" + Context.Parameters(\"assemblypath\") + \"\"\" \"\"\" + parameter + \"\"\"\"        MyBase.OnBeforeInstall(savedState)    End Sub  \n    ```  \n  \n     This code modifies the **ImagePath** registry key, which typically contains the full path to the executable for the Windows Service, by adding the default parameter values. The quotation marks around the path (and around each individual parameter) are required for the service to start up correctly. To change the startup parameters for this Windows Service, users can change the parameters given in the **ImagePath** registry key, although the better way is to change it programmatically and expose the functionality to users in a friendly way (for example, in a management or configuration utility).  \n  \n<a name=\"BK_Build\"></a>   \n## Building the Service  \n  \n#### To build your service project  \n  \n1.  In **Solution Explorer**, open the context menu for your project, and then choose **Properties**. The property pages for your project  appear.  \n  \n2.  On the Application tab, in the **Startup object** list, choose **MyNewService.Program**.  \n  \n3.  In **Solution Explorer**, open the context menu for your project, and then choose **Build** to build the project (Keyboard: Ctrl+Shift+B).  \n  \n<a name=\"BK_Install\"></a>   \n## Installing the Service  \n Now that you've built the Windows service, you can install it. To install a Windows service, you must have administrative credentials on the computer on which you're installing it.  \n  \n#### To install a Windows Service  \n  \n1.  In Windows 7 and Windows Server, open the **Developer Command Prompt** under **Visual Studio Tools** in the **Start** menu. In Windows 8 or Windows 8.1, choose the **Visual Studio Tools** tile on the **Start** screen, and then run Developer Command Prompt with administrative credentials. (If you’re using a mouse, right-click on **Developer Command Prompt**, and then choose **Run as Administrator**.)  \n  \n2.  In the Command Prompt window, navigate to the folder that contains your project's output. For example, under your My Documents folder, navigate to Visual Studio 2013\\Projects\\MyNewService\\bin\\Debug.  \n  \n3.  Enter the following command:  \n  \n    ```  \n    installutil.exe MyNewService.exe  \n    ```  \n  \n     If the service installs successfully, installutil.exe will report success. If the system could not find InstallUtil.exe, make sure that it exists on your computer. This tool is installed with the .NET Framework to the folder `%WINDIR%\\Microsoft.NET\\Framework[64]\\`*framework_version*. For example, the default path for the 32-bit version of the .NET Framework 4, 4.5, 4.5.1, and 4.5.2 is `C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\InstallUtil.exe`.  \n  \n     If the installutil.exe process reports failure, check the install log to find out why. By default the log is in the same folder as the service executable. The installation can fail if  the <xref:System.ComponentModel.RunInstallerAttribute> Class is not present on the `ProjectInstaller` class, or else the attribute is not set to `true`, or else the `ProjectInstaller` class is not `public`.  \n  \n     For more information, see [How to: Install and Uninstall Services](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md).  \n  \n<a name=\"BK_StartService\"></a>   \n## Starting and Running the Service  \n  \n#### To start and stop your service  \n  \n1.  In Windows, open the **Start** screen or **Start** menu, and type `services.msc`.  \n  \n     You should now see **MyNewService** listed in the **Services** window.  \n  \n     ![MyNewService in the Services window.](../../../docs/framework/windows-services/media/windowsservices-serviceswindow.PNG \"WindowsServices_ServicesWindow\")  \n  \n2.  In the **Services** window, open the shortcut menu for your service, and then choose **Start**.  \n  \n3.  Open the shortcut menu for the service, and then choose **Stop**.  \n  \n4.  (Optional) From the command line, you can use the commands `net start``ServiceName` and `net stop``ServiceName` to start and stop your service.  \n  \n#### To verify the event log output of your service  \n  \n1.  In Visual Studio, open **Server Explorer** (Keyboard: Ctrl+Alt+S), and access the **Event Logs** node for the local computer.  \n  \n2.  Locate the listing for **MyNewLog** (or **MyLogFile1**, if you used the optional procedure to add command-line arguments) and expand it. You should see entries for the two actions (start and stop) your service has performed.  \n  \n     ![Use the Event Viewer to see the event log entries.](../../../docs/framework/windows-services/media/windowsservices-eventviewer.PNG \"WindowsServices_EventViewer\")  \n  \n<a name=\"BK_Uninstall\"></a>   \n## Uninstalling a Windows Service  \n  \n#### To uninstall your service  \n  \n1.  Open a developer command prompt with administrative credentials.  \n  \n2.  In the Command Prompt window, navigate to the folder that contains your project's output. For example, under your My Documents folder, navigate to Visual Studio 2013\\Projects\\MyNewService\\bin\\Debug.  \n  \n3.  Enter the following command:  \n  \n    ```  \n    installutil.exe /u MyNewService.exe  \n    ```  \n  \n     If the service uninstalls successfully, installutil.exe will report that your service was successfully removed. For more information, see [How to: Install and Uninstall Services](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md).  \n  \n## Next Steps  \n You can create a standalone setup program that others can use to install your Windows service, but it requires additional steps. ClickOnce doesn't support Windows services, so you can't use the Publish Wizard. You can use a full edition of InstallShield, which Microsoft doesn't provide. For more information about InstallShield, see [InstallShield Limited Edition](/visualstudio/deployment/installshield-limited-edition). You can also use the [Windows Installer XML Toolset](http://go.microsoft.com/fwlink/?LinkId=249067) to create an installer for a Windows service.  \n  \n You might explore the use of a <xref:System.ServiceProcess.ServiceController> component, which enables you to send commands to the service you have installed.  \n  \n You can use an installer to create an event log when the application is installed instead of creating the event log when the application runs. Additionally, the event log will be deleted by the installer when the application is uninstalled. For more information, see the <xref:System.Diagnostics.EventLogInstaller> reference page.  \n  \n## See Also  \n [Windows Service Applications](../../../docs/framework/windows-services/index.md)   \n [Introduction to Windows Service Applications](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)   \n [How to: Debug Windows Service Applications](../../../docs/framework/windows-services/how-to-debug-windows-service-applications.md)   \n [Services (Windows)](http://msdn.microsoft.com/library/windows/desktop/ms685141.aspx)","nodes":[{"pos":[4,513],"nodes":[{"content":"Walkthrough: Creating a Windows Service Application in the Component Designer | Microsoft Docs","nodes":[{"pos":[0,94],"content":"Walkthrough: Creating a Windows Service Application in the Component Designer | Microsoft Docs","nodes":[{"content":"Walkthrough: Creating a Windows Service Application in the Component Designer | Microsoft Docs","pos":[0,94]}]}],"pos":[6,103],"yaml":true}],"content":"title: \"Walkthrough: Creating a Windows Service Application in the Component Designer | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"Windows Service applications, walkthroughs\"\n  - \"Windows Service applications, creating\"\nms.assetid: e24d8a3d-edc6-485c-b6e0-5672d91fb607\ncaps.latest.revision: 57\nauthor: \"ghogen\"\nms.author: \"ghogen\"\nmanager: \"douge\"","yamlblock":true},{"pos":[520,597],"content":"Walkthrough: Creating a Windows Service Application in the Component Designer","linkify":"Walkthrough: Creating a Windows Service Application in the Component Designer","nodes":[{"content":"Walkthrough: Creating a Windows Service Application in the Component Designer","pos":[0,77]}]},{"content":"This article demonstrates how to create a simple Windows Service application in Visual Studio that writes messages to an event log.","pos":[598,729]},{"content":"Here are the basic steps that you perform to create and use your service:","pos":[730,803]},{"content":"<bpt id=\"p1\">[</bpt>Creating a Service<ept id=\"p1\">](#BK_CreateProject)</ept> by using the <bpt id=\"p2\">**</bpt>Windows Service<ept id=\"p2\">**</ept> project template, and configure it.","pos":[813,921],"source":"[Creating a Service](#BK_CreateProject) by using the **Windows Service** project template, and configure it."},{"content":"This template creates a class for you that inherits from <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase?displayProperty=fullName&gt;</ph> and writes much of the basic service code, such as the code to start the service.","pos":[922,1126],"source":" This template creates a class for you that inherits from <xref:System.ServiceProcess.ServiceBase?displayProperty=fullName> and writes much of the basic service code, such as the code to start the service."},{"pos":[1136,1368],"content":"<bpt id=\"p1\">[</bpt>Adding Features to the Service<ept id=\"p1\">](#BK_WriteCode)</ept> for the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase.OnStop%2A&gt;</ph> procedures, and override any other methods that you want to redefine.","source":"[Adding Features to the Service](#BK_WriteCode) for the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> procedures, and override any other methods that you want to redefine."},{"content":"<bpt id=\"p1\">[</bpt>Setting Service Status<ept id=\"p1\">](#BK_SetStatus)</ept>.","pos":[1378,1418],"source":"[Setting Service Status](#BK_SetStatus)."},{"content":"By default, services created with <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase?displayProperty=fullName&gt;</ph> implement only a subset of the available status flags.","pos":[1419,1573],"source":" By default, services created with <xref:System.ServiceProcess.ServiceBase?displayProperty=fullName> implement only a subset of the available status flags."},{"content":"If your service takes a long time to start up, pause, or stop, you can implement status values such as Start Pending or Stop Pending to indicate that it's working on an operation.","pos":[1574,1753]},{"pos":[1763,1846],"content":"<bpt id=\"p1\">[</bpt>Adding Installers to the Service<ept id=\"p1\">](#BK_AddInstallers)</ept> for your service application.","source":"[Adding Installers to the Service](#BK_AddInstallers) for your service application."},{"pos":[1856,2035],"content":"(Optional) <bpt id=\"p1\">[</bpt>Set Startup Parameters<ept id=\"p1\">](#BK_StartupParameters)</ept>, specify default startup arguments, and enable users to override default settings when they start your service manually.","source":"(Optional) [Set Startup Parameters](#BK_StartupParameters), specify default startup arguments, and enable users to override default settings when they start your service manually."},{"pos":[2045,2079],"content":"<bpt id=\"p1\">[</bpt>Building the Service<ept id=\"p1\">](#BK_Build)</ept>.","source":"[Building the Service](#BK_Build)."},{"pos":[2089,2148],"content":"<bpt id=\"p1\">[</bpt>Installing the Service<ept id=\"p1\">](#BK_Install)</ept> on the local machine.","source":"[Installing the Service](#BK_Install) on the local machine."},{"pos":[2158,2258],"content":"Access the Windows Service Control Manager and <bpt id=\"p1\">[</bpt>Starting and Running the Service<ept id=\"p1\">](#BK_StartService)</ept>.","source":"Access the Windows Service Control Manager and [Starting and Running the Service](#BK_StartService)."},{"pos":[2267,2315],"content":"<bpt id=\"p1\">[</bpt>Uninstalling a Windows Service<ept id=\"p1\">](#BK_Uninstall)</ept>.","source":"[Uninstalling a Windows Service](#BK_Uninstall)."},{"pos":[2323,2470],"content":"[!WARNING]\n The Windows Services project template that is required for this walkthrough is not available in the Express edition of Visual Studio.","leadings":["","> "],"nodes":[{"content":"The Windows Services project template that is required for this walkthrough is not available in the Express edition of Visual Studio.","pos":[12,145]}]},{"pos":[2601,2619],"content":"Creating a Service","linkify":"Creating a Service","nodes":[{"content":"Creating a Service","pos":[0,18]}]},{"content":"To begin, you create the project and set values that are required for the service to function correctly.","pos":[2623,2727]},{"pos":[2738,2774],"content":"To create and configure your service","linkify":"To create and configure your service","nodes":[{"content":"To create and configure your service","pos":[0,36]}]},{"pos":[2784,2857],"content":"In Visual Studio, on the menu bar, choose <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"In Visual Studio, on the menu bar, choose **File**, **New**, **Project**."},{"pos":[2868,2905],"content":"The <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box opens.","source":"The **New Project** dialog box opens."},{"content":"In the list of Visual Basic or Visual C# project templates, choose <bpt id=\"p1\">**</bpt>Windows Service<ept id=\"p1\">**</ept>, and name the project <bpt id=\"p2\">**</bpt>MyNewService<ept id=\"p2\">**</ept>.","pos":[2915,3041],"source":"In the list of Visual Basic or Visual C# project templates, choose **Windows Service**, and name the project **MyNewService**."},{"content":"Choose <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[3042,3056],"source":" Choose **OK**."},{"pos":[3067,3227],"content":"The project template automatically adds a component class named <ph id=\"ph1\">`Service1`</ph> that inherits from <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase?displayProperty=fullName&gt;</ph>.","source":"The project template automatically adds a component class named `Service1` that inherits from <xref:System.ServiceProcess.ServiceBase?displayProperty=fullName>."},{"content":"On the <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Find and Replace<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Find in Files<ept id=\"p3\">**</ept> (Keyboard: Ctrl+Shift+F).","pos":[3237,3331],"source":"On the **Edit** menu, choose **Find and Replace**, **Find in Files** (Keyboard: Ctrl+Shift+F)."},{"content":"Change all occurrences of <ph id=\"ph1\">`Service1`</ph> to <ph id=\"ph2\">`MyNewService`</ph>.","pos":[3332,3387],"source":" Change all occurrences of `Service1` to `MyNewService`."},{"content":"You’ll find instances in Service1.cs, Program.cs, and Service1.Designer.cs (or their .vb equivalents).","pos":[3388,3490]},{"pos":[3500,3739],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window for <bpt id=\"p2\">**</bpt>Service1.cs [Design]<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>Service1.vb [Design]<ept id=\"p3\">**</ept>, set the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.ServiceName%2A&gt;</ph> and the <bpt id=\"p4\">**</bpt>(Name)<ept id=\"p4\">**</ept> property for <ph id=\"ph2\">`Service1`</ph> to <bpt id=\"p5\">**</bpt>MyNewService<ept id=\"p5\">**</ept>, if it's not already set.","source":"In the **Properties** window for **Service1.cs [Design]** or **Service1.vb [Design]**, set the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> and the **(Name)** property for `Service1` to **MyNewService**, if it's not already set."},{"pos":[3749,3860],"content":"In Solution Explorer, rename <bpt id=\"p1\">**</bpt>Service1.cs<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>MyNewService.cs<ept id=\"p2\">**</ept>, or <bpt id=\"p3\">**</bpt>Service1.vb<ept id=\"p3\">**</ept> to <bpt id=\"p4\">**</bpt>MyNewService.vb<ept id=\"p4\">**</ept>.","source":"In Solution Explorer, rename **Service1.cs** to **MyNewService.cs**, or **Service1.vb** to **MyNewService.vb**."},{"pos":[3900,3930],"content":"Adding Features to the Service","linkify":"Adding Features to the Service","nodes":[{"content":"Adding Features to the Service","pos":[0,30]}]},{"content":"In this section, you add a custom event log to the Windows service.","pos":[3934,4001]},{"content":"Event logs are not associated in any way with Windows services.","pos":[4002,4065]},{"content":"Here the <ph id=\"ph1\">&lt;xref:System.Diagnostics.EventLog&gt;</ph> component is used as an example of the type of component you could add to a Windows service.","pos":[4066,4202],"source":" Here the <xref:System.Diagnostics.EventLog> component is used as an example of the type of component you could add to a Windows service."},{"pos":[4213,4266],"content":"To add custom event log functionality to your service","linkify":"To add custom event log functionality to your service","nodes":[{"content":"To add custom event log functionality to your service","pos":[0,53]}]},{"pos":[4276,4406],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, open the context menu for <bpt id=\"p2\">**</bpt>MyNewService.cs<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>MyNewService.vb<ept id=\"p3\">**</ept>, and then choose <bpt id=\"p4\">**</bpt>View Designer<ept id=\"p4\">**</ept>.","source":"In **Solution Explorer**, open the context menu for **MyNewService.cs** or **MyNewService.vb**, and then choose **View Designer**."},{"pos":[4416,4537],"content":"From the <bpt id=\"p1\">**</bpt>Components<ept id=\"p1\">**</ept> section of the <bpt id=\"p2\">**</bpt>Toolbox<ept id=\"p2\">**</ept>, drag an <ph id=\"ph1\">&lt;xref:System.Diagnostics.EventLog&gt;</ph> component to the designer.","source":"From the **Components** section of the **Toolbox**, drag an <xref:System.Diagnostics.EventLog> component to the designer."},{"pos":[4547,4673],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, open the context menu for <bpt id=\"p2\">**</bpt>MyNewService.cs<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>MyNewService.vb<ept id=\"p3\">**</ept>, and then choose <bpt id=\"p4\">**</bpt>View Code<ept id=\"p4\">**</ept>.","source":"In **Solution Explorer**, open the context menu for **MyNewService.cs** or **MyNewService.vb**, and then choose **View Code**."},{"pos":[4683,4819],"content":"Add a declaration for the <bpt id=\"p1\">**</bpt>eventLog<ept id=\"p1\">**</ept> object in the <ph id=\"ph1\">`MyNewService`</ph> class, right after the line that declares the <ph id=\"ph2\">`components`</ph> variable:","source":"Add a declaration for the **eventLog** object in the `MyNewService` class, right after the line that declares the `components` variable:"},{"pos":[4830,5091],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>VbRadconService#16<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#16)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>VbRadconService#16<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#16)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[VbRadconService#16](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#16)]\n [!code-vb[VbRadconService#16](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#16)]"},{"content":"Add or edit the constructor to define a custom event log:","pos":[5101,5158]},{"pos":[5169,5426],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>VbRadconService#2<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#2)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>VbRadconService#2<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#2)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[VbRadconService#2](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#2)]\n [!code-vb[VbRadconService#2](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#2)]"},{"pos":[5437,5482],"content":"To define what occurs when the service starts","linkify":"To define what occurs when the service starts","nodes":[{"content":"To define what occurs when the service starts","pos":[0,45]}]},{"content":"In the Code Editor, locate the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> method that was automatically overridden when you created the project, and replace the code with the following.","pos":[5492,5686],"source":"In the Code Editor, locate the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method that was automatically overridden when you created the project, and replace the code with the following."},{"content":"This adds an entry to the event log when the service starts running:","pos":[5687,5755]},{"pos":[5766,6023],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>VbRadconService#3<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#3)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>VbRadconService#3<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#3)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[VbRadconService#3](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#3)]\n [!code-vb[VbRadconService#3](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#3)]"},{"content":"A service application is designed to be long-running, so it usually polls or monitors something in the system.","pos":[6034,6144]},{"content":"The monitoring is set up in the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> method.","pos":[6145,6236],"source":" The monitoring is set up in the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method."},{"content":"However, <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> doesn’t actually do the monitoring.","pos":[6237,6333],"source":" However, <xref:System.ServiceProcess.ServiceBase.OnStart%2A> doesn’t actually do the monitoring."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> method must return to the operating system after the service's operation has begun.","pos":[6334,6473],"source":" The <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method must return to the operating system after the service's operation has begun."},{"content":"It must not loop forever or block.","pos":[6474,6508]},{"content":"To set up a simple polling mechanism, you can use the <ph id=\"ph1\">&lt;xref:System.Timers.Timer?displayProperty=fullName&gt;</ph> component as follows: In the <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> method, set parameters on the component, and then set the <ph id=\"ph3\">&lt;xref:System.Timers.Timer.Enabled%2A&gt;</ph> property to <ph id=\"ph4\">`true`</ph>.","pos":[6509,6811],"source":" To set up a simple polling mechanism, you can use the <xref:System.Timers.Timer?displayProperty=fullName> component as follows: In the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method, set parameters on the component, and then set the <xref:System.Timers.Timer.Enabled%2A> property to `true`."},{"content":"The timer raises events in your code periodically, at which time your service could do its monitoring.","pos":[6812,6914]},{"content":"You can use the following code to do this:","pos":[6915,6957]},{"content":"Add code to handle the timer event:","pos":[7503,7538]},{"content":"You might want to perform tasks by using background worker threads instead of running all your work on the main thread.","pos":[8119,8238]},{"content":"For an example of this, see the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase?displayProperty=fullName&gt;</ph> reference page.","pos":[8239,8352],"source":" For an example of this, see the <xref:System.ServiceProcess.ServiceBase?displayProperty=fullName> reference page."},{"pos":[8363,8412],"content":"To define what occurs when the service is stopped","linkify":"To define what occurs when the service is stopped","nodes":[{"content":"To define what occurs when the service is stopped","pos":[0,49]}]},{"content":"Replace the code for the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStop%2A&gt;</ph> method with the following.","pos":[8422,8524],"source":"Replace the code for the <xref:System.ServiceProcess.ServiceBase.OnStop%2A> method with the following."},{"content":"This adds an entry to the event log when the service is stopped:","pos":[8525,8589]},{"pos":[8600,8857],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>VbRadconService#4<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#4)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>VbRadconService#4<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#4)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[VbRadconService#4](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#4)]\n [!code-vb[VbRadconService#4](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#4)]"},{"content":"In the next section, you can override the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnPause%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase.OnContinue%2A&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.ServiceProcess.ServiceBase.OnShutdown%2A&gt;</ph> methods to define additional processing for your component.","pos":[8864,9133],"source":"In the next section, you can override the <xref:System.ServiceProcess.ServiceBase.OnPause%2A>, <xref:System.ServiceProcess.ServiceBase.OnContinue%2A>, and <xref:System.ServiceProcess.ServiceBase.OnShutdown%2A> methods to define additional processing for your component."},{"pos":[9144,9183],"content":"To define other actions for the service","linkify":"To define other actions for the service","nodes":[{"content":"To define other actions for the service","pos":[0,39]}]},{"content":"Locate the method that you want to handle, and override it to define what you want to occur.","pos":[9193,9285]},{"content":"The following code shows how you can override the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnContinue%2A&gt;</ph> method:","pos":[9296,9408],"source":"The following code shows how you can override the <xref:System.ServiceProcess.ServiceBase.OnContinue%2A> method:"},{"pos":[9419,9676],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>VbRadconService#5<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#5)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>VbRadconService#5<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#5)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[VbRadconService#5](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#5)]\n [!code-vb[VbRadconService#5](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#5)]"},{"content":"Some custom actions have to occur when a Windows service is installed by the <ph id=\"ph1\">&lt;xref:System.Configuration.Install.Installer&gt;</ph> class.","pos":[9683,9812],"source":"Some custom actions have to occur when a Windows service is installed by the <xref:System.Configuration.Install.Installer> class."},{"content":"Visual Studio can create these installers specifically for a Windows service and add them to your project.","pos":[9813,9919]},{"pos":[9959,9981],"content":"Setting Service Status","linkify":"Setting Service Status","nodes":[{"content":"Setting Service Status","pos":[0,22]}]},{"content":"Services report their status to the Service Control Manager, so that users can tell whether a service is functioning correctly.","pos":[9985,10112]},{"content":"By default, services that inherit from <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase&gt;</ph> report a limited set of status settings, including Stopped, Paused, and Running.","pos":[10113,10273],"source":" By default, services that inherit from <xref:System.ServiceProcess.ServiceBase> report a limited set of status settings, including Stopped, Paused, and Running."},{"content":"If a service takes a little while to start up, it might be helpful to report a Start Pending status.","pos":[10274,10374]},{"content":"You can also implement the Start Pending and Stop Pending status settings by adding code that calls into the Windows <bpt id=\"p1\">[</bpt>SetServiceStatus function<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms686241.aspx)</ept>.","pos":[10375,10585],"source":" You can also implement the Start Pending and Stop Pending status settings by adding code that calls into the Windows [SetServiceStatus function](http://msdn.microsoft.com/library/windows/desktop/ms686241.aspx)."},{"pos":[10596,10631],"content":"To implement service pending status","linkify":"To implement service pending status","nodes":[{"content":"To implement service pending status","pos":[0,35]}]},{"pos":[10641,10817],"content":"Add a <ph id=\"ph1\">`using`</ph> statement or <ph id=\"ph2\">`Imports`</ph> declaration to the <ph id=\"ph3\">&lt;xref:System.Runtime.InteropServices?displayProperty=fullName&gt;</ph> namespace in the MyNewService.cs or MyNewService.vb file:","source":"Add a `using` statement or `Imports` declaration to the <xref:System.Runtime.InteropServices?displayProperty=fullName> namespace in the MyNewService.cs or MyNewService.vb file:"},{"pos":[10970,11131],"content":"Add the following code to MyNewService.cs to declare the <ph id=\"ph1\">`ServiceState`</ph> values and to add a structure for the status, which you'll use in a platform invoke call:","source":"Add the following code to MyNewService.cs to declare the `ServiceState` values and to add a structure for the status, which you'll use in a platform invoke call:"},{"pos":[12650,12814],"content":"Now, in the <ph id=\"ph1\">`MyNewService`</ph> class, declare the <bpt id=\"p1\">[</bpt>SetServiceStatus function<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms686241.aspx)</ept> by using platform invoke:","source":"Now, in the `MyNewService` class, declare the [SetServiceStatus function](http://msdn.microsoft.com/library/windows/desktop/ms686241.aspx) by using platform invoke:"},{"content":"To implement the Start Pending status, add the following code to the beginning of the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> method:","pos":[13179,13324],"source":"To implement the Start Pending status, add the following code to the beginning of the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method:"},{"content":"Add code to set the status to Running at the end of the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> method.","pos":[13956,14071],"source":"Add code to set the status to Running at the end of the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method."},{"content":"(Optional) Repeat this procedure for the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStop%2A&gt;</ph> method.","pos":[14472,14571],"source":"(Optional) Repeat this procedure for the <xref:System.ServiceProcess.ServiceBase.OnStop%2A> method."},{"pos":[14579,15226],"content":"[!CAUTION]\n The [Service Control Manager](http://msdn.microsoft.com/library/windows/desktop/ms685150.aspx) uses the `dwWaitHint` and `dwCheckpoint` members of the [SERVICE_STATUS structure](http://msdn.microsoft.com/library/windows/desktop/ms685996.aspx) to determine how much time to wait for a Windows Service to start or shut down. If your <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> methods run long, your service can request more time by calling [SetServiceStatus](http://msdn.microsoft.com/library/windows/desktop/ms686241.aspx) again with an incremented `dwCheckPoint` value.","leadings":["","> "],"nodes":[{"content":"The [Service Control Manager](http://msdn.microsoft.com/library/windows/desktop/ms685150.aspx) uses the `dwWaitHint` and `dwCheckpoint` members of the [SERVICE_STATUS structure](http://msdn.microsoft.com/library/windows/desktop/ms685996.aspx) to determine how much time to wait for a Windows Service to start or shut down. If your <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> methods run long, your service can request more time by calling [SetServiceStatus](http://msdn.microsoft.com/library/windows/desktop/ms686241.aspx) again with an incremented `dwCheckPoint` value.","pos":[12,645],"nodes":[{"content":"The <bpt id=\"p1\">[</bpt>Service Control Manager<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms685150.aspx)</ept> uses the <ph id=\"ph1\">`dwWaitHint`</ph> and <ph id=\"ph2\">`dwCheckpoint`</ph> members of the <bpt id=\"p2\">[</bpt>SERVICE_STATUS structure<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms685996.aspx)</ept> to determine how much time to wait for a Windows Service to start or shut down.","pos":[0,322],"source":"The [Service Control Manager](http://msdn.microsoft.com/library/windows/desktop/ms685150.aspx) uses the `dwWaitHint` and `dwCheckpoint` members of the [SERVICE_STATUS structure](http://msdn.microsoft.com/library/windows/desktop/ms685996.aspx) to determine how much time to wait for a Windows Service to start or shut down."},{"content":"If your <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase.OnStop%2A&gt;</ph> methods run long, your service can request more time by calling <bpt id=\"p1\">[</bpt>SetServiceStatus<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms686241.aspx)</ept> again with an incremented <ph id=\"ph3\">`dwCheckPoint`</ph> value.","pos":[323,633],"source":" If your <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> methods run long, your service can request more time by calling [SetServiceStatus](http://msdn.microsoft.com/library/windows/desktop/ms686241.aspx) again with an incremented `dwCheckPoint` value."}]}]},{"pos":[15270,15302],"content":"Adding Installers to the Service","linkify":"Adding Installers to the Service","nodes":[{"content":"Adding Installers to the Service","pos":[0,32]}]},{"content":"Before you can run a Windows Service, you need to install it, which registers it with the Service Control Manager.","pos":[15306,15420]},{"content":"You can add installers to your project that handle the registration details.","pos":[15421,15497]},{"pos":[15508,15549],"content":"To create the installers for your service","linkify":"To create the installers for your service","nodes":[{"content":"To create the installers for your service","pos":[0,41]}]},{"pos":[15559,15689],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, open the context menu for <bpt id=\"p2\">**</bpt>MyNewService.cs<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>MyNewService.vb<ept id=\"p3\">**</ept>, and then choose <bpt id=\"p4\">**</bpt>View Designer<ept id=\"p4\">**</ept>.","source":"In **Solution Explorer**, open the context menu for **MyNewService.cs** or **MyNewService.vb**, and then choose **View Designer**."},{"content":"Click the background of the designer to select the service itself, instead of any of its contents.","pos":[15699,15797]},{"pos":[15807,15955],"content":"Open the context menu for the designer window (if you’re using a pointing device, right-click inside the window), and then choose <bpt id=\"p1\">**</bpt>Add Installer<ept id=\"p1\">**</ept>.","source":"Open the context menu for the designer window (if you’re using a pointing device, right-click inside the window), and then choose **Add Installer**."},{"content":"By default, a component class that contains two installers is added to your project.","pos":[15966,16050]},{"content":"The component is named <bpt id=\"p1\">**</bpt>ProjectInstaller<ept id=\"p1\">**</ept>, and the installers it contains are the installer for your service and the installer for the service's associated process.","pos":[16051,16217],"source":" The component is named **ProjectInstaller**, and the installers it contains are the installer for your service and the installer for the service's associated process."},{"pos":[16227,16378],"content":"In <bpt id=\"p1\">**</bpt>Design<ept id=\"p1\">**</ept> view for <bpt id=\"p2\">**</bpt>ProjectInstaller<ept id=\"p2\">**</ept>, choose <bpt id=\"p3\">**</bpt>serviceInstaller1<ept id=\"p3\">**</ept> for a Visual C# project, or <bpt id=\"p4\">**</bpt>ServiceInstaller1<ept id=\"p4\">**</ept> for a Visual Basic project.","source":"In **Design** view for **ProjectInstaller**, choose **serviceInstaller1** for a Visual C# project, or **ServiceInstaller1** for a Visual Basic project."},{"pos":[16388,16529],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, make sure the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A&gt;</ph> property is set to <bpt id=\"p2\">**</bpt>MyNewService<ept id=\"p2\">**</ept>.","source":"In the **Properties** window, make sure the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> property is set to **MyNewService**."},{"content":"Set the <bpt id=\"p1\">**</bpt>Description<ept id=\"p1\">**</ept> property to some text, such as \"A sample service\".","pos":[16539,16613],"source":"Set the **Description** property to some text, such as \"A sample service\"."},{"content":"This text appears in the Services window and helps the user identify the service and understand what it’s used for.","pos":[16614,16729]},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceInstaller.DisplayName%2A&gt;</ph> property to the text that you want to appear in the Services window in the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> column.","pos":[16739,16899],"source":"Set the <xref:System.ServiceProcess.ServiceInstaller.DisplayName%2A> property to the text that you want to appear in the Services window in the **Name** column."},{"content":"For example, you can enter \"MyNewService Display Name\".","pos":[16900,16955]},{"content":"This name can be different from the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A&gt;</ph> property, which is the name used by the system (for example, when you use the <ph id=\"ph2\">`net start`</ph> command to start your service).","pos":[16956,17174],"source":" This name can be different from the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> property, which is the name used by the system (for example, when you use the `net start` command to start your service)."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceInstaller.StartType%2A&gt;</ph> property to <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceStartMode&gt;</ph>.","pos":[17184,17309],"source":"Set the <xref:System.ServiceProcess.ServiceInstaller.StartType%2A> property to <xref:System.ServiceProcess.ServiceStartMode>."},{"pos":[17320,17489],"content":"<bpt id=\"p1\">![</bpt>Installer Properties for a Windows Service<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../docs/framework/windows-services/media/windowsservice-installerproperties.PNG \"</bpt>WindowsService_InstallerProperties<ept id=\"p2\">\")</ept>","source":"![Installer Properties for a Windows Service](../../../docs/framework/windows-services/media/windowsservice-installerproperties.PNG \"WindowsService_InstallerProperties\")"},{"content":"In the designer, choose <bpt id=\"p1\">**</bpt>serviceProcessInstaller1<ept id=\"p1\">**</ept> for a Visual C# project, or <bpt id=\"p2\">**</bpt>ServiceProcessInstaller1<ept id=\"p2\">**</ept> for a Visual Basic project.","pos":[17498,17635],"source":"In the designer, choose **serviceProcessInstaller1** for a Visual C# project, or **ServiceProcessInstaller1** for a Visual Basic project."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceProcessInstaller.Account%2A&gt;</ph> property to <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceAccount&gt;</ph>.","pos":[17636,17764],"source":" Set the <xref:System.ServiceProcess.ServiceProcessInstaller.Account%2A> property to <xref:System.ServiceProcess.ServiceAccount>."},{"content":"This will cause the service to be installed and to run on a local service account.","pos":[17765,17847]},{"pos":[17859,18462],"content":"[!IMPORTANT]\nThe <xref:System.ServiceProcess.ServiceAccount> account has broad permissions, including the ability to write to the event log. Use this account with caution, because it might increase your risk of attacks from malicious software. For other tasks, consider using the <xref:System.ServiceProcess.ServiceAccount> account, which acts as a non-privileged user on the local computer and presents anonymous credentials to any remote server. This example fails if you try to use the <xref:System.ServiceProcess.ServiceAccount> account, because it needs permission to write to the event log.","leadings":["","    >  "],"nodes":[{"content":"The <xref:System.ServiceProcess.ServiceAccount> account has broad permissions, including the ability to write to the event log. Use this account with caution, because it might increase your risk of attacks from malicious software. For other tasks, consider using the <xref:System.ServiceProcess.ServiceAccount> account, which acts as a non-privileged user on the local computer and presents anonymous credentials to any remote server. This example fails if you try to use the <xref:System.ServiceProcess.ServiceAccount> account, because it needs permission to write to the event log.","pos":[13,596],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceAccount&gt;</ph> account has broad permissions, including the ability to write to the event log.","pos":[0,127],"source":"The <xref:System.ServiceProcess.ServiceAccount> account has broad permissions, including the ability to write to the event log."},{"content":"Use this account with caution, because it might increase your risk of attacks from malicious software.","pos":[128,230]},{"content":"For other tasks, consider using the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceAccount&gt;</ph> account, which acts as a non-privileged user on the local computer and presents anonymous credentials to any remote server.","pos":[231,434],"source":" For other tasks, consider using the <xref:System.ServiceProcess.ServiceAccount> account, which acts as a non-privileged user on the local computer and presents anonymous credentials to any remote server."},{"content":"This example fails if you try to use the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceAccount&gt;</ph> account, because it needs permission to write to the event log.","pos":[435,583],"source":" This example fails if you try to use the <xref:System.ServiceProcess.ServiceAccount> account, because it needs permission to write to the event log."}]}]},{"pos":[18473,18664],"content":"For more information about installers, see <bpt id=\"p1\">[</bpt>How to: Add Installers to Your Service Application<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)</ept>.","source":"For more information about installers, see [How to: Add Installers to Your Service Application](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)."},{"pos":[18712,18734],"content":"Set Startup Parameters","linkify":"Set Startup Parameters","nodes":[{"content":"Set Startup Parameters","pos":[0,22]}]},{"content":"A Windows Service, like any other executable, can accept command-line arguments, or startup parameters.","pos":[18738,18841]},{"content":"When you add code to process startup parameters, users can start your service with their own custom startup parameters by using the Services window in the Windows Control Panel.","pos":[18842,19019]},{"content":"However, these startup parameters are not persisted the next time the service starts.","pos":[19020,19105]},{"content":"To set startup parameters permanently, you can set them in the registry, as shown in this procedure.","pos":[19106,19206]},{"pos":[19214,20074],"content":"[!NOTE]\n Before you decide to add startup parameters, consider whether that is the best way to pass information to your service. Although startup parameters are easy to use and to parse, and users can easily override them, they might be harder for users to discover and use without documentation. Generally, if your service requires more than just a few startup parameters, you should consider using the registry or a configuration file instead. Every Windows Service has an entry in the registry under HKLM\\System\\CurrentControlSet\\services. Under the service's key, you can use the **Parameters** subkey to store information that your service can access. You can use application configuration files for a Windows Service the same way you do for other types of programs. For example code, see <xref:System.Configuration.ConfigurationManager.AppSettings%2A>.","leadings":["","> "],"nodes":[{"content":"Before you decide to add startup parameters, consider whether that is the best way to pass information to your service. Although startup parameters are easy to use and to parse, and users can easily override them, they might be harder for users to discover and use without documentation. Generally, if your service requires more than just a few startup parameters, you should consider using the registry or a configuration file instead. Every Windows Service has an entry in the registry under HKLM\\System\\CurrentControlSet\\services. Under the service's key, you can use the **Parameters** subkey to store information that your service can access. You can use application configuration files for a Windows Service the same way you do for other types of programs. For example code, see <xref:System.Configuration.ConfigurationManager.AppSettings%2A>.","pos":[9,858],"nodes":[{"content":"Before you decide to add startup parameters, consider whether that is the best way to pass information to your service.","pos":[0,119]},{"content":"Although startup parameters are easy to use and to parse, and users can easily override them, they might be harder for users to discover and use without documentation.","pos":[120,287]},{"content":"Generally, if your service requires more than just a few startup parameters, you should consider using the registry or a configuration file instead.","pos":[288,436]},{"content":"Every Windows Service has an entry in the registry under HKLM\\System\\CurrentControlSet\\services.","pos":[437,533]},{"content":"Under the service's key, you can use the <bpt id=\"p1\">**</bpt>Parameters<ept id=\"p1\">**</ept> subkey to store information that your service can access.","pos":[534,647],"source":" Under the service's key, you can use the **Parameters** subkey to store information that your service can access."},{"content":"You can use application configuration files for a Windows Service the same way you do for other types of programs.","pos":[648,762]},{"content":"For example code, see <ph id=\"ph1\">&lt;xref:System.Configuration.ConfigurationManager.AppSettings%2A&gt;</ph>.","pos":[763,849],"source":" For example code, see <xref:System.Configuration.ConfigurationManager.AppSettings%2A>."}]}]},{"pos":[20085,20110],"content":"Adding startup parameters","linkify":"Adding startup parameters","nodes":[{"content":"Adding startup parameters","pos":[0,25]}]},{"pos":[20120,20224],"content":"In the <ph id=\"ph1\">`Main`</ph> method in Program.cs or in MyNewService.Designer.vb, add an argument for the command line:","source":"In the `Main` method in Program.cs or in MyNewService.Designer.vb, add an argument for the command line:"},{"pos":[20817,20866],"content":"Change the <ph id=\"ph1\">`MyNewService`</ph> constructor as follows:","source":"Change the `MyNewService` constructor as follows:"},{"content":"This code sets the event source and log name according to the supplied startup parameters, or uses default values if no arguments are supplied.","pos":[22328,22471]},{"pos":[22481,22621],"content":"To specify the command-line arguments, add the following code to the <ph id=\"ph1\">`ProjectInstaller`</ph> class in ProjectInstaller.cs or ProjectInstaller.vb:","source":"To specify the command-line arguments, add the following code to the `ProjectInstaller` class in ProjectInstaller.cs or ProjectInstaller.vb:"},{"content":"This code modifies the <bpt id=\"p1\">**</bpt>ImagePath<ept id=\"p1\">**</ept> registry key, which typically contains the full path to the executable for the Windows Service, by adding the default parameter values.","pos":[23304,23476],"source":"This code modifies the **ImagePath** registry key, which typically contains the full path to the executable for the Windows Service, by adding the default parameter values."},{"content":"The quotation marks around the path (and around each individual parameter) are required for the service to start up correctly.","pos":[23477,23603]},{"content":"To change the startup parameters for this Windows Service, users can change the parameters given in the <bpt id=\"p1\">**</bpt>ImagePath<ept id=\"p1\">**</ept> registry key, although the better way is to change it programmatically and expose the functionality to users in a friendly way (for example, in a management or configuration utility).","pos":[23604,23905],"source":" To change the startup parameters for this Windows Service, users can change the parameters given in the **ImagePath** registry key, although the better way is to change it programmatically and expose the functionality to users in a friendly way (for example, in a management or configuration utility)."},{"pos":[23941,23961],"content":"Building the Service","linkify":"Building the Service","nodes":[{"content":"Building the Service","pos":[0,20]}]},{"pos":[23972,24001],"content":"To build your service project","linkify":"To build your service project","nodes":[{"content":"To build your service project","pos":[0,29]}]},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, open the context menu for your project, and then choose <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","pos":[24011,24108],"source":"In **Solution Explorer**, open the context menu for your project, and then choose **Properties**."},{"content":"The property pages for your project  appear.","pos":[24109,24153]},{"pos":[24163,24251],"content":"On the Application tab, in the <bpt id=\"p1\">**</bpt>Startup object<ept id=\"p1\">**</ept> list, choose <bpt id=\"p2\">**</bpt>MyNewService.Program<ept id=\"p2\">**</ept>.","source":"On the Application tab, in the **Startup object** list, choose **MyNewService.Program**."},{"pos":[24261,24399],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, open the context menu for your project, and then choose <bpt id=\"p2\">**</bpt>Build<ept id=\"p2\">**</ept> to build the project (Keyboard: Ctrl+Shift+B).","source":"In **Solution Explorer**, open the context menu for your project, and then choose **Build** to build the project (Keyboard: Ctrl+Shift+B)."},{"pos":[24437,24459],"content":"Installing the Service","linkify":"Installing the Service","nodes":[{"content":"Installing the Service","pos":[0,22]}]},{"content":"Now that you've built the Windows service, you can install it.","pos":[24463,24525]},{"content":"To install a Windows service, you must have administrative credentials on the computer on which you're installing it.","pos":[24526,24643]},{"pos":[24654,24682],"content":"To install a Windows Service","linkify":"To install a Windows Service","nodes":[{"content":"To install a Windows Service","pos":[0,28]}]},{"content":"In Windows 7 and Windows Server, open the <bpt id=\"p1\">**</bpt>Developer Command Prompt<ept id=\"p1\">**</ept> under <bpt id=\"p2\">**</bpt>Visual Studio Tools<ept id=\"p2\">**</ept> in the <bpt id=\"p3\">**</bpt>Start<ept id=\"p3\">**</ept> menu.","pos":[24692,24815],"source":"In Windows 7 and Windows Server, open the **Developer Command Prompt** under **Visual Studio Tools** in the **Start** menu."},{"content":"In Windows 8 or Windows 8.1, choose the <bpt id=\"p1\">**</bpt>Visual Studio Tools<ept id=\"p1\">**</ept> tile on the <bpt id=\"p2\">**</bpt>Start<ept id=\"p2\">**</ept> screen, and then run Developer Command Prompt with administrative credentials.","pos":[24816,24980],"source":" In Windows 8 or Windows 8.1, choose the **Visual Studio Tools** tile on the **Start** screen, and then run Developer Command Prompt with administrative credentials."},{"content":"(If you’re using a mouse, right-click on <bpt id=\"p1\">**</bpt>Developer Command Prompt<ept id=\"p1\">**</ept>, and then choose <bpt id=\"p2\">**</bpt>Run as Administrator<ept id=\"p2\">**</ept>.)","pos":[24981,25094],"source":" (If you’re using a mouse, right-click on **Developer Command Prompt**, and then choose **Run as Administrator**.)"},{"content":"In the Command Prompt window, navigate to the folder that contains your project's output.","pos":[25104,25193]},{"content":"For example, under your My Documents folder, navigate to Visual Studio 2013\\Projects\\MyNewService\\bin\\Debug.","pos":[25194,25302]},{"content":"Enter the following command:","pos":[25312,25340]},{"content":"If the service installs successfully, installutil.exe will report success.","pos":[25413,25487]},{"content":"If the system could not find InstallUtil.exe, make sure that it exists on your computer.","pos":[25488,25576]},{"content":"This tool is installed with the .NET Framework to the folder <ph id=\"ph1\">`%WINDIR%\\Microsoft.NET\\Framework[64]\\`</ph><bpt id=\"p1\">*</bpt>framework_version<ept id=\"p1\">*</ept>.","pos":[25577,25697],"source":" This tool is installed with the .NET Framework to the folder `%WINDIR%\\Microsoft.NET\\Framework[64]\\`*framework_version*."},{"content":"For example, the default path for the 32-bit version of the .NET Framework 4, 4.5, 4.5.1, and 4.5.2 is <ph id=\"ph1\">`C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\InstallUtil.exe`</ph>.","pos":[25698,25865],"source":" For example, the default path for the 32-bit version of the .NET Framework 4, 4.5, 4.5.1, and 4.5.2 is `C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\InstallUtil.exe`."},{"content":"If the installutil.exe process reports failure, check the install log to find out why.","pos":[25876,25962]},{"content":"By default the log is in the same folder as the service executable.","pos":[25963,26030]},{"content":"The installation can fail if  the <ph id=\"ph1\">&lt;xref:System.ComponentModel.RunInstallerAttribute&gt;</ph> Class is not present on the <ph id=\"ph2\">`ProjectInstaller`</ph> class, or else the attribute is not set to <ph id=\"ph3\">`true`</ph>, or else the <ph id=\"ph4\">`ProjectInstaller`</ph> class is not <ph id=\"ph5\">`public`</ph>.","pos":[26031,26267],"source":" The installation can fail if  the <xref:System.ComponentModel.RunInstallerAttribute> Class is not present on the `ProjectInstaller` class, or else the attribute is not set to `true`, or else the `ProjectInstaller` class is not `public`."},{"pos":[26278,26428],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Install and Uninstall Services<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md)</ept>.","source":"For more information, see [How to: Install and Uninstall Services](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md)."},{"pos":[26471,26503],"content":"Starting and Running the Service","linkify":"Starting and Running the Service","nodes":[{"content":"Starting and Running the Service","pos":[0,32]}]},{"pos":[26514,26544],"content":"To start and stop your service","linkify":"To start and stop your service","nodes":[{"content":"To start and stop your service","pos":[0,30]}]},{"pos":[26554,26635],"content":"In Windows, open the <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> screen or <bpt id=\"p2\">**</bpt>Start<ept id=\"p2\">**</ept> menu, and type <ph id=\"ph1\">`services.msc`</ph>.","source":"In Windows, open the **Start** screen or **Start** menu, and type `services.msc`."},{"pos":[26646,26716],"content":"You should now see <bpt id=\"p1\">**</bpt>MyNewService<ept id=\"p1\">**</ept> listed in the <bpt id=\"p2\">**</bpt>Services<ept id=\"p2\">**</ept> window.","source":"You should now see **MyNewService** listed in the **Services** window."},{"pos":[26727,26882],"content":"<bpt id=\"p1\">![</bpt>MyNewService in the Services window.<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../docs/framework/windows-services/media/windowsservices-serviceswindow.PNG \"</bpt>WindowsServices_ServicesWindow<ept id=\"p2\">\")</ept>","source":"![MyNewService in the Services window.](../../../docs/framework/windows-services/media/windowsservices-serviceswindow.PNG \"WindowsServices_ServicesWindow\")"},{"pos":[26892,26987],"content":"In the <bpt id=\"p1\">**</bpt>Services<ept id=\"p1\">**</ept> window, open the shortcut menu for your service, and then choose <bpt id=\"p2\">**</bpt>Start<ept id=\"p2\">**</ept>.","source":"In the **Services** window, open the shortcut menu for your service, and then choose **Start**."},{"pos":[26997,27062],"content":"Open the shortcut menu for the service, and then choose <bpt id=\"p1\">**</bpt>Stop<ept id=\"p1\">**</ept>.","source":"Open the shortcut menu for the service, and then choose **Stop**."},{"pos":[27072,27215],"content":"(Optional) From the command line, you can use the commands <ph id=\"ph1\">`net start``ServiceName`</ph> and <ph id=\"ph2\">`net stop``ServiceName`</ph> to start and stop your service.","source":"(Optional) From the command line, you can use the commands `net start``ServiceName` and `net stop``ServiceName` to start and stop your service."},{"pos":[27226,27272],"content":"To verify the event log output of your service","linkify":"To verify the event log output of your service","nodes":[{"content":"To verify the event log output of your service","pos":[0,46]}]},{"pos":[27282,27407],"content":"In Visual Studio, open <bpt id=\"p1\">**</bpt>Server Explorer<ept id=\"p1\">**</ept> (Keyboard: Ctrl+Alt+S), and access the <bpt id=\"p2\">**</bpt>Event Logs<ept id=\"p2\">**</ept> node for the local computer.","source":"In Visual Studio, open **Server Explorer** (Keyboard: Ctrl+Alt+S), and access the **Event Logs** node for the local computer."},{"content":"Locate the listing for <bpt id=\"p1\">**</bpt>MyNewLog<ept id=\"p1\">**</ept> (or <bpt id=\"p2\">**</bpt>MyLogFile1<ept id=\"p2\">**</ept>, if you used the optional procedure to add command-line arguments) and expand it.","pos":[27417,27553],"source":"Locate the listing for **MyNewLog** (or **MyLogFile1**, if you used the optional procedure to add command-line arguments) and expand it."},{"content":"You should see entries for the two actions (start and stop) your service has performed.","pos":[27554,27641]},{"pos":[27652,27815],"content":"<bpt id=\"p1\">![</bpt>Use the Event Viewer to see the event log entries.<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../docs/framework/windows-services/media/windowsservices-eventviewer.PNG \"</bpt>WindowsServices_EventViewer<ept id=\"p2\">\")</ept>","source":"![Use the Event Viewer to see the event log entries.](../../../docs/framework/windows-services/media/windowsservices-eventviewer.PNG \"WindowsServices_EventViewer\")"},{"pos":[27855,27885],"content":"Uninstalling a Windows Service","linkify":"Uninstalling a Windows Service","nodes":[{"content":"Uninstalling a Windows Service","pos":[0,30]}]},{"pos":[27896,27921],"content":"To uninstall your service","linkify":"To uninstall your service","nodes":[{"content":"To uninstall your service","pos":[0,25]}]},{"content":"Open a developer command prompt with administrative credentials.","pos":[27931,27995]},{"content":"In the Command Prompt window, navigate to the folder that contains your project's output.","pos":[28005,28094]},{"content":"For example, under your My Documents folder, navigate to Visual Studio 2013\\Projects\\MyNewService\\bin\\Debug.","pos":[28095,28203]},{"content":"Enter the following command:","pos":[28213,28241]},{"content":"If the service uninstalls successfully, installutil.exe will report that your service was successfully removed.","pos":[28317,28428]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Install and Uninstall Services<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md)</ept>.","pos":[28429,28579],"source":" For more information, see [How to: Install and Uninstall Services](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md)."},{"pos":[28588,28598],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"You can create a standalone setup program that others can use to install your Windows service, but it requires additional steps.","pos":[28602,28730]},{"content":"ClickOnce doesn't support Windows services, so you can't use the Publish Wizard.","pos":[28731,28811]},{"content":"You can use a full edition of InstallShield, which Microsoft doesn't provide.","pos":[28812,28889]},{"content":"For more information about InstallShield, see <bpt id=\"p1\">[</bpt>InstallShield Limited Edition<ept id=\"p1\">](/visualstudio/deployment/installshield-limited-edition)</ept>.","pos":[28890,29024],"source":" For more information about InstallShield, see [InstallShield Limited Edition](/visualstudio/deployment/installshield-limited-edition)."},{"content":"You can also use the <bpt id=\"p1\">[</bpt>Windows Installer XML Toolset<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=249067)</ept> to create an installer for a Windows service.","pos":[29025,29170],"source":" You can also use the [Windows Installer XML Toolset](http://go.microsoft.com/fwlink/?LinkId=249067) to create an installer for a Windows service."},{"content":"You might explore the use of a <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceController&gt;</ph> component, which enables you to send commands to the service you have installed.","pos":[29177,29335],"source":"You might explore the use of a <xref:System.ServiceProcess.ServiceController> component, which enables you to send commands to the service you have installed."},{"content":"You can use an installer to create an event log when the application is installed instead of creating the event log when the application runs.","pos":[29342,29484]},{"content":"Additionally, the event log will be deleted by the installer when the application is uninstalled.","pos":[29485,29582]},{"content":"For more information, see the <ph id=\"ph1\">&lt;xref:System.Diagnostics.EventLogInstaller&gt;</ph> reference page.","pos":[29583,29672],"source":" For more information, see the <xref:System.Diagnostics.EventLogInstaller> reference page."},{"pos":[29681,29689],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Windows Service Applications<ept id=\"p1\">](../../../docs/framework/windows-services/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[29693,29775],"source":"[Windows Service Applications](../../../docs/framework/windows-services/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>Introduction to Windows Service Applications<ept id=\"p1\">](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)</ept><ph id=\"ph1\"> </ph>","pos":[29779,29916],"source":"[Introduction to Windows Service Applications](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Debug Windows Service Applications<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-debug-windows-service-applications.md)</ept><ph id=\"ph1\"> </ph>","pos":[29920,30052],"source":"[How to: Debug Windows Service Applications](../../../docs/framework/windows-services/how-to-debug-windows-service-applications.md) "},{"content":"<bpt id=\"p1\">[</bpt>Services (Windows)<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms685141.aspx)</ept>","pos":[30056,30141],"source":"[Services (Windows)](http://msdn.microsoft.com/library/windows/desktop/ms685141.aspx)"}]}