{"content":"---\ntitle: \"Embedded Expressions in XML (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.XmlEmbeddedExpression\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"embedded expressions [Visual Basic]\"\n  - \"LINQ to XML [Visual Basic], embedded expressions\"\n  - \"XML literals [Visual Basic], embedded expressions\"\nms.assetid: bf2eb779-b751-4b7c-854f-9f2161482352\ncaps.latest.revision: 22\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Embedded Expressions in XML (Visual Basic)\nEmbedded expressions enable you to create XML literals that contain expressions that are evaluated at run time. The syntax for an embedded expression is `<%=` `expression` `%>`, which is the same as the syntax used in [!INCLUDE[vstecasp](../../../../csharp/language-reference/preprocessor-directives/includes/vstecasp_md.md)].  \n  \n For example, you can create an XML element literal, combining embedded expressions with literal text content.  \n  \n [!code-vb[VbXMLSamples#27](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/embedded-expressions-in-xml_1.vb)]  \n  \n If `isbnNumber` contains the integer 12345 and `modifiedDate` contains the date 3/5/2006, when this code executes, the value of `book` is:  \n  \n```  \n<book category=\"fiction\" isbn=\"12345\">  \n  <modifiedDate>3/5/2006</modifiedDate>  \n</book>  \n```  \n  \n## Embedded Expression Location and Validation  \n Embedded expressions can appear only at certain locations within XML literal expressions. The expression location controls which types the expression can return and how `Nothing` is handled. The following table describes the allowed locations and types of embedded expressions.  \n  \n|Location in literal|Type of expression|Handling of `Nothing`|  \n|---|---|---|  \n|XML element name|<xref:System.Xml.Linq.XName>|Error|  \n|XML element content|`Object` or array of `Object`|Ignored|  \n|XML element attribute name|<xref:System.Xml.Linq.XName>|Error, unless the attribute value is also `Nothing`|  \n|XML element attribute value|`Object`|Attribute declaration ignored|  \n|XML element attribute|<xref:System.Xml.Linq.XAttribute> or a collection of <xref:System.Xml.Linq.XAttribute>|Ignored|  \n|XML document root element|<xref:System.Xml.Linq.XElement> or a collection of one <xref:System.Xml.Linq.XElement> object and an arbitrary number of <xref:System.Xml.Linq.XProcessingInstruction> and <xref:System.Xml.Linq.XComment> objects|Ignored|  \n  \n-   Example of an embedded expression in an XML element name:  \n  \n     [!code-vb[VbXMLSamples#32](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/embedded-expressions-in-xml_2.vb)]  \n  \n-   Example of an embedded expression in the content of an XML element:  \n  \n     [!code-vb[VbXMLSamples#33](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/embedded-expressions-in-xml_3.vb)]  \n  \n-   Example of an embedded expression in an XML element attribute name:  \n  \n     [!code-vb[VbXMLSamples#34](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/embedded-expressions-in-xml_4.vb)]  \n  \n-   Example of an embedded expression in an XML element attribute value:  \n  \n     [!code-vb[VbXMLSamples#35](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/embedded-expressions-in-xml_5.vb)]  \n  \n-   Example of an embedded expression in an XML element attribute:  \n  \n     [!code-vb[VbXMLSamples#36](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/embedded-expressions-in-xml_6.vb)]  \n  \n-   Example of an embedded expression in an XML document root element:  \n  \n     [!code-vb[VbXMLSamples#37](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/embedded-expressions-in-xml_7.vb)]  \n  \n If you enable `Option Strict`, the compiler checks that the type of each embedded expression widens to the required type. The only exception is for the root element of an XML document, which is verified when the code runs. If you compile without `Option Strict`, you can embed expressions of type `Object` and their type is verified at run time.  \n  \n In locations where content is optional, embedded expressions that contain `Nothing` are ignored. This means you do not have to check that element content, attribute values, and array elements are not `Nothing` before you use an XML literal. Required values, such as element and attribute names, cannot be `Nothing`.  \n  \n For more information about using an embedded expression in a particular type of literal, see [XML Document Literal](../../../../visual-basic/language-reference/xml-literals/xml-document-literal.md), [XML Element Literal](../../../../visual-basic/language-reference/xml-literals/xml-element-literal.md).  \n  \n## Scoping Rules  \n The compiler converts each XML literal into a constructor call for the appropriate literal type. The literal content and embedded expressions in an XML literal are passed as arguments to the constructor. This means that all [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] programming elements available to an XML literal are also available to its embedded expressions.  \n  \n Within an XML literal, you can access the XML namespace prefixes declared with the `Imports` statement. You can declare a new XML namespace prefix, or shadow an existing XML namespace prefix, in an element by using the `xmlns` attribute. The new namespace is available to the child nodes of that element, but not to XML literals in embedded expressions.  \n  \n> [!NOTE]\n>  When you declare an XML namespace prefix by using the `xmlns` namespace attribute, the attribute value must be a constant string. In this regard, using the `xmlns` attribute is like using the `Imports` statement to declare an XML namespace. You cannot use an embedded expression to specify the XML namespace value.  \n  \n## See Also  \n [Creating XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/creating-xml.md)   \n [XML Document Literal](../../../../visual-basic/language-reference/xml-literals/xml-document-literal.md)   \n [XML Element Literal](../../../../visual-basic/language-reference/xml-literals/xml-element-literal.md)   \n [Option Strict Statement](../../../../visual-basic/language-reference/statements/option-strict-statement.md)   \n [Imports Statement (.NET Namespace and Type)](../../../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md)   \n [XML Literals Overview](../../../../visual-basic/programming-guide/language-features/xml/xml-literals-overview.md)","nodes":[{"pos":[4,774],"embed":true,"restype":"x-metadata","content":"title: \"Embedded Expressions in XML (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.XmlEmbeddedExpression\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"embedded expressions [Visual Basic]\"\n  - \"LINQ to XML [Visual Basic], embedded expressions\"\n  - \"XML literals [Visual Basic], embedded expressions\"\nms.assetid: bf2eb779-b751-4b7c-854f-9f2161482352\ncaps.latest.revision: 22\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","nodes":[{"content":"Embedded Expressions in XML (Visual Basic) | Microsoft Docs","nodes":[{"pos":[0,59],"content":"Embedded Expressions in XML (Visual Basic) | Microsoft Docs","nodes":[{"content":"Embedded Expressions in XML (Visual Basic) | Microsoft Docs","pos":[0,59]}]}],"path":["title"]}],"yml":true},{"pos":[781,823],"content":"Embedded Expressions in XML (Visual Basic)","linkify":"Embedded Expressions in XML (Visual Basic)","nodes":[{"content":"Embedded Expressions in XML (Visual Basic)","pos":[0,42]}]},{"content":"Embedded expressions enable you to create XML literals that contain expressions that are evaluated at run time.","pos":[824,935]},{"content":"The syntax for an embedded expression is <ph id=\"ph1\">`&lt;%=`</ph> <ph id=\"ph2\">`expression`</ph> <ph id=\"ph3\">`%&gt;`</ph>, which is the same as the syntax used in <ph id=\"ph4\">[!INCLUDE[vstecasp](../../../../csharp/language-reference/preprocessor-directives/includes/vstecasp_md.md)]</ph>.","pos":[936,1150],"source":" The syntax for an embedded expression is `<%=` `expression` `%>`, which is the same as the syntax used in [!INCLUDE[vstecasp](../../../../csharp/language-reference/preprocessor-directives/includes/vstecasp_md.md)]."},{"content":"For example, you can create an XML element literal, combining embedded expressions with literal text content.","pos":[1157,1266]},{"pos":[1419,1557],"content":"If <ph id=\"ph1\">`isbnNumber`</ph> contains the integer 12345 and <ph id=\"ph2\">`modifiedDate`</ph> contains the date 3/5/2006, when this code executes, the value of <ph id=\"ph3\">`book`</ph> is:","source":"If `isbnNumber` contains the integer 12345 and `modifiedDate` contains the date 3/5/2006, when this code executes, the value of `book` is:"},{"pos":[1674,1717],"content":"Embedded Expression Location and Validation","linkify":"Embedded Expression Location and Validation","nodes":[{"content":"Embedded Expression Location and Validation","pos":[0,43]}]},{"content":"Embedded expressions can appear only at certain locations within XML literal expressions.","pos":[1721,1810]},{"content":"The expression location controls which types the expression can return and how <ph id=\"ph1\">`Nothing`</ph> is handled.","pos":[1811,1911],"source":" The expression location controls which types the expression can return and how `Nothing` is handled."},{"content":"The following table describes the allowed locations and types of embedded expressions.","pos":[1912,1998]},{"content":"Location in literal","pos":[2005,2024]},{"content":"Type of expression","pos":[2025,2043]},{"pos":[2044,2065],"content":"Handling of <ph id=\"ph1\">`Nothing`</ph>","source":"Handling of `Nothing`"},{"content":"XML element name","pos":[2086,2102]},{"content":"Error","pos":[2132,2137]},{"content":"XML element content","pos":[2142,2161]},{"pos":[2162,2191],"content":"<ph id=\"ph1\">`Object`</ph> or array of <ph id=\"ph2\">`Object`</ph>","source":"`Object` or array of `Object`"},{"content":"Ignored","pos":[2192,2199]},{"content":"XML element attribute name","pos":[2204,2230]},{"pos":[2260,2311],"content":"Error, unless the attribute value is also <ph id=\"ph1\">`Nothing`</ph>","source":"Error, unless the attribute value is also `Nothing`"},{"content":"XML element attribute value","pos":[2316,2343]},{"content":"Attribute declaration ignored","pos":[2353,2382]},{"content":"XML element attribute","pos":[2387,2408]},{"content":"<ph id=\"ph1\">&lt;xref:System.Xml.Linq.XAttribute&gt;</ph> or a collection of <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XAttribute&gt;</ph>","pos":[2409,2495],"source":"<xref:System.Xml.Linq.XAttribute> or a collection of <xref:System.Xml.Linq.XAttribute>"},{"content":"Ignored","pos":[2496,2503]},{"content":"XML document root element","pos":[2508,2533]},{"content":"<ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> or a collection of one <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> object and an arbitrary number of <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XProcessingInstruction&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Xml.Linq.XComment&gt;</ph> objects","pos":[2534,2744],"source":"<xref:System.Xml.Linq.XElement> or a collection of one <xref:System.Xml.Linq.XElement> object and an arbitrary number of <xref:System.Xml.Linq.XProcessingInstruction> and <xref:System.Xml.Linq.XComment> objects"},{"content":"Ignored","pos":[2745,2752]},{"content":"Example of an embedded expression in an XML element name:","pos":[2763,2820]},{"content":"Example of an embedded expression in the content of an XML element:","pos":[2980,3047]},{"content":"Example of an embedded expression in an XML element attribute name:","pos":[3207,3274]},{"content":"Example of an embedded expression in an XML element attribute value:","pos":[3434,3502]},{"content":"Example of an embedded expression in an XML element attribute:","pos":[3662,3724]},{"content":"Example of an embedded expression in an XML document root element:","pos":[3884,3950]},{"content":"If you enable <ph id=\"ph1\">`Option Strict`</ph>, the compiler checks that the type of each embedded expression widens to the required type.","pos":[4107,4228],"source":"If you enable `Option Strict`, the compiler checks that the type of each embedded expression widens to the required type."},{"content":"The only exception is for the root element of an XML document, which is verified when the code runs.","pos":[4229,4329]},{"content":"If you compile without <ph id=\"ph1\">`Option Strict`</ph>, you can embed expressions of type <ph id=\"ph2\">`Object`</ph> and their type is verified at run time.","pos":[4330,4452],"source":" If you compile without `Option Strict`, you can embed expressions of type `Object` and their type is verified at run time."},{"content":"In locations where content is optional, embedded expressions that contain <ph id=\"ph1\">`Nothing`</ph> are ignored.","pos":[4459,4555],"source":"In locations where content is optional, embedded expressions that contain `Nothing` are ignored."},{"content":"This means you do not have to check that element content, attribute values, and array elements are not <ph id=\"ph1\">`Nothing`</ph> before you use an XML literal.","pos":[4556,4699],"source":" This means you do not have to check that element content, attribute values, and array elements are not `Nothing` before you use an XML literal."},{"content":"Required values, such as element and attribute names, cannot be <ph id=\"ph1\">`Nothing`</ph>.","pos":[4700,4774],"source":" Required values, such as element and attribute names, cannot be `Nothing`."},{"pos":[4781,5083],"content":"For more information about using an embedded expression in a particular type of literal, see <bpt id=\"p1\">[</bpt>XML Document Literal<ept id=\"p1\">](../../../../visual-basic/language-reference/xml-literals/xml-document-literal.md)</ept>, <bpt id=\"p2\">[</bpt>XML Element Literal<ept id=\"p2\">](../../../../visual-basic/language-reference/xml-literals/xml-element-literal.md)</ept>.","source":"For more information about using an embedded expression in a particular type of literal, see [XML Document Literal](../../../../visual-basic/language-reference/xml-literals/xml-document-literal.md), [XML Element Literal](../../../../visual-basic/language-reference/xml-literals/xml-element-literal.md)."},{"pos":[5092,5105],"content":"Scoping Rules","linkify":"Scoping Rules","nodes":[{"content":"Scoping Rules","pos":[0,13]}]},{"content":"The compiler converts each XML literal into a constructor call for the appropriate literal type.","pos":[5109,5205]},{"content":"The literal content and embedded expressions in an XML literal are passed as arguments to the constructor.","pos":[5206,5312]},{"content":"This means that all <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> programming elements available to an XML literal are also available to its embedded expressions.","pos":[5313,5522],"source":" This means that all [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] programming elements available to an XML literal are also available to its embedded expressions."},{"content":"Within an XML literal, you can access the XML namespace prefixes declared with the <ph id=\"ph1\">`Imports`</ph> statement.","pos":[5529,5632],"source":"Within an XML literal, you can access the XML namespace prefixes declared with the `Imports` statement."},{"content":"You can declare a new XML namespace prefix, or shadow an existing XML namespace prefix, in an element by using the <ph id=\"ph1\">`xmlns`</ph> attribute.","pos":[5633,5766],"source":" You can declare a new XML namespace prefix, or shadow an existing XML namespace prefix, in an element by using the `xmlns` attribute."},{"content":"The new namespace is available to the child nodes of that element, but not to XML literals in embedded expressions.","pos":[5767,5882]},{"pos":[5890,6215],"content":"[!NOTE]\n When you declare an XML namespace prefix by using the `xmlns` namespace attribute, the attribute value must be a constant string. In this regard, using the `xmlns` attribute is like using the `Imports` statement to declare an XML namespace. You cannot use an embedded expression to specify the XML namespace value.","leadings":["","> "],"nodes":[{"content":"When you declare an XML namespace prefix by using the `xmlns` namespace attribute, the attribute value must be a constant string. In this regard, using the `xmlns` attribute is like using the `Imports` statement to declare an XML namespace. You cannot use an embedded expression to specify the XML namespace value.","pos":[9,323],"nodes":[{"content":"When you declare an XML namespace prefix by using the <ph id=\"ph1\">`xmlns`</ph> namespace attribute, the attribute value must be a constant string.","pos":[0,129],"source":"When you declare an XML namespace prefix by using the `xmlns` namespace attribute, the attribute value must be a constant string."},{"content":"In this regard, using the <ph id=\"ph1\">`xmlns`</ph> attribute is like using the <ph id=\"ph2\">`Imports`</ph> statement to declare an XML namespace.","pos":[130,240],"source":" In this regard, using the `xmlns` attribute is like using the `Imports` statement to declare an XML namespace."},{"content":"You cannot use an embedded expression to specify the XML namespace value.","pos":[241,314]}]}]},{"pos":[6224,6232],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Creating XML in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/creating-xml.md)</ept><ph id=\"ph1\"> </ph>","pos":[6236,6349],"source":"[Creating XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/creating-xml.md) "},{"content":"<bpt id=\"p1\">[</bpt>XML Document Literal<ept id=\"p1\">](../../../../visual-basic/language-reference/xml-literals/xml-document-literal.md)</ept><ph id=\"ph1\"> </ph>","pos":[6353,6458],"source":"[XML Document Literal](../../../../visual-basic/language-reference/xml-literals/xml-document-literal.md) "},{"content":"<bpt id=\"p1\">[</bpt>XML Element Literal<ept id=\"p1\">](../../../../visual-basic/language-reference/xml-literals/xml-element-literal.md)</ept><ph id=\"ph1\"> </ph>","pos":[6462,6565],"source":"[XML Element Literal](../../../../visual-basic/language-reference/xml-literals/xml-element-literal.md) "},{"content":"<bpt id=\"p1\">[</bpt>Option Strict Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/option-strict-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[6569,6678],"source":"[Option Strict Statement](../../../../visual-basic/language-reference/statements/option-strict-statement.md) "},{"content":"<bpt id=\"p1\">[</bpt>Imports Statement (.NET Namespace and Type)<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md)</ept><ph id=\"ph1\"> </ph>","pos":[6682,6828],"source":"[Imports Statement (.NET Namespace and Type)](../../../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md) "},{"content":"<bpt id=\"p1\">[</bpt>XML Literals Overview<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/xml-literals-overview.md)</ept>","pos":[6832,6946],"source":"[XML Literals Overview](../../../../visual-basic/programming-guide/language-features/xml/xml-literals-overview.md)"}]}