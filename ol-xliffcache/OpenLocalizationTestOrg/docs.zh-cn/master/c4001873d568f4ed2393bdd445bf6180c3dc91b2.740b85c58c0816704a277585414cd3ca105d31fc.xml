{"content":"---\ntitle: \"How to: Load Files into the Windows Forms RichTextBox Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"text boxes, displaying files\"\n  - \"examples [Windows Forms], text boxes\"\n  - \".rtf files, opening in RichTextBox control\"\n  - \"RTF files, opening in RichTextBox control\"\n  - \"text files, displaying in RichTextBox control\"\n  - \".rtf files, displaying in RichTextBox control\"\n  - \"RichTextBox control [Windows Forms], opening files\"\n  - \"RTF files, displaying in RichTextBox control\"\nms.assetid: c03451be-f285-4428-a71a-c41e002cc919\ncaps.latest.revision: 13\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Load Files into the Windows Forms RichTextBox Control\nThe Windows Forms <xref:System.Windows.Forms.RichTextBox> control can display a plain-text, Unicode plain-text, or Rich-Text-Format (RTF) file. To do so, call the <xref:System.Windows.Forms.RichTextBox.LoadFile%2A> method. You can also use the <xref:System.Windows.Forms.RichTextBox.LoadFile%2A> method to load data from a stream. For more information, see <xref:System.Windows.Forms.RichTextBox.LoadFile%28System.IO.Stream%2CSystem.Windows.Forms.RichTextBoxStreamType%29>.  \n  \n### To load a file into the RichTextBox control  \n  \n1.  Determine the path of the file to be opened using the <xref:System.Windows.Forms.OpenFileDialog> component. For an overview, see [OpenFileDialog Component Overview](../../../../docs/framework/winforms/controls/openfiledialog-component-overview-windows-forms.md).  \n  \n2.  Call the <xref:System.Windows.Forms.RichTextBox.LoadFile%2A> method of the <xref:System.Windows.Forms.RichTextBox> control, specifying the file to load and optionally a file type. In the example below, the file to load is taken from the <xref:System.Windows.Forms.OpenFileDialog> component's <xref:System.Windows.Forms.FileDialog.FileName%2A> property. If you call the method with a file name as its only argument, the file type will be assumed to be RTF. To specify another file type, call the method with a value of the <xref:System.Windows.Forms.RichTextBoxStreamType> enumeration as its second argument.  \n  \n     In the example below, the <xref:System.Windows.Forms.OpenFileDialog> component is shown when a button is clicked. The file selected is then opened and displayed in the <xref:System.Windows.Forms.RichTextBox> control. This example assumes a form has a button,`btnOpenFile`.  \n  \n    ```vb  \n    Private Sub btnOpenFile_Click(ByVal sender As System.Object, _  \n       ByVal e As System.EventArgs) Handles btnOpenFile.Click  \n         If OpenFileDialog1.ShowDialog() = DialogResult.OK Then  \n           RichTextBox1.LoadFile(OpenFileDialog1.FileName, _  \n              RichTextBoxStreamType.RichText)  \n          End If  \n    End Sub  \n  \n    ```  \n  \n    ```csharp  \n    private void btnOpenFile_Click(object sender, System.EventArgs e)  \n    {  \n       if(openFileDialog1.ShowDialog() == DialogResult.OK)  \n       {  \n         richTextBox1.LoadFile(openFileDialog1.FileName, RichTextBoxStreamType.RichText);  \n       }  \n    }  \n  \n    ```  \n  \n    ```cpp  \n    private:  \n       void btnOpenFile_Click(System::Object ^  sender,  \n          System::EventArgs ^  e)  \n       {  \n          if(openFileDialog1->ShowDialog() == DialogResult::OK)  \n          {  \n             richTextBox1->LoadFile(openFileDialog1->FileName,  \n                RichTextBoxStreamType::RichText);  \n          }  \n       }  \n    ```  \n  \n     ([!INCLUDE[csprcs](../../../../includes/csprcs-md.md)], [!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]) Place the following code in the form's constructor to register the event handler.  \n  \n    ```csharp  \n    this.btnOpenFile.Click += new System.EventHandler(this. btnOpenFile_Click);  \n  \n    ```  \n  \n    ```cpp  \n    this->btnOpenFile->Click += gcnew   \n       System::EventHandler(this, &Form1::btnOpenFile_Click);  \n    ```  \n  \n    > [!IMPORTANT]\n    >  To run this process, your assembly may require a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=fullName> class. If you are running in a partial-trust context, the process might throw an exception because of insufficient privileges. For more information, see [Code Access Security Basics](../../../../docs/framework/misc/code-access-security-basics.md).  \n  \n## See Also  \n <xref:System.Windows.Forms.RichTextBox.LoadFile%2A?displayProperty=fullName>   \n <xref:System.Windows.Forms.RichTextBox>   \n [RichTextBox Control](../../../../docs/framework/winforms/controls/richtextbox-control-windows-forms.md)   \n [Controls to Use on Windows Forms](../../../../docs/framework/winforms/controls/controls-to-use-on-windows-forms.md)","nodes":[{"pos":[4,830],"embed":true,"restype":"x-metadata","content":"title: \"How to: Load Files into the Windows Forms RichTextBox Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"text boxes, displaying files\"\n  - \"examples [Windows Forms], text boxes\"\n  - \".rtf files, opening in RichTextBox control\"\n  - \"RTF files, opening in RichTextBox control\"\n  - \"text files, displaying in RichTextBox control\"\n  - \".rtf files, displaying in RichTextBox control\"\n  - \"RichTextBox control [Windows Forms], opening files\"\n  - \"RTF files, displaying in RichTextBox control\"\nms.assetid: c03451be-f285-4428-a71a-c41e002cc919\ncaps.latest.revision: 13\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"How to: Load Files into the Windows Forms RichTextBox Control | Microsoft Docs","nodes":[{"pos":[0,78],"content":"How to: Load Files into the Windows Forms RichTextBox Control | Microsoft Docs","nodes":[{"content":"How to: Load Files into the Windows Forms RichTextBox Control | Microsoft Docs","pos":[0,78]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[837,898],"content":"How to: Load Files into the Windows Forms RichTextBox Control","linkify":"How to: Load Files into the Windows Forms RichTextBox Control","nodes":[{"content":"How to: Load Files into the Windows Forms RichTextBox Control","pos":[0,61]}]},{"content":"The Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control can display a plain-text, Unicode plain-text, or Rich-Text-Format (RTF) file.","pos":[899,1042],"source":"The Windows Forms <xref:System.Windows.Forms.RichTextBox> control can display a plain-text, Unicode plain-text, or Rich-Text-Format (RTF) file."},{"content":"To do so, call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.LoadFile%2A&gt;</ph> method.","pos":[1043,1121],"source":" To do so, call the <xref:System.Windows.Forms.RichTextBox.LoadFile%2A> method."},{"content":"You can also use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.LoadFile%2A&gt;</ph> method to load data from a stream.","pos":[1122,1229],"source":" You can also use the <xref:System.Windows.Forms.RichTextBox.LoadFile%2A> method to load data from a stream."},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.LoadFile%28System.IO.Stream%2CSystem.Windows.Forms.RichTextBoxStreamType%29&gt;</ph>.","pos":[1230,1372],"source":" For more information, see <xref:System.Windows.Forms.RichTextBox.LoadFile%28System.IO.Stream%2CSystem.Windows.Forms.RichTextBoxStreamType%29>."},{"pos":[1382,1425],"content":"To load a file into the RichTextBox control","linkify":"To load a file into the RichTextBox control","nodes":[{"content":"To load a file into the RichTextBox control","pos":[0,43]}]},{"content":"Determine the path of the file to be opened using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.OpenFileDialog&gt;</ph> component.","pos":[1435,1542],"source":"Determine the path of the file to be opened using the <xref:System.Windows.Forms.OpenFileDialog> component."},{"content":"For an overview, see <bpt id=\"p1\">[</bpt>OpenFileDialog Component Overview<ept id=\"p1\">](../../../../docs/framework/winforms/controls/openfiledialog-component-overview-windows-forms.md)</ept>.","pos":[1543,1697],"source":" For an overview, see [OpenFileDialog Component Overview](../../../../docs/framework/winforms/controls/openfiledialog-component-overview-windows-forms.md)."},{"content":"Call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.LoadFile%2A&gt;</ph> method of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control, specifying the file to load and optionally a file type.","pos":[1707,1886],"source":"Call the <xref:System.Windows.Forms.RichTextBox.LoadFile%2A> method of the <xref:System.Windows.Forms.RichTextBox> control, specifying the file to load and optionally a file type."},{"content":"In the example below, the file to load is taken from the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.OpenFileDialog&gt;</ph> component's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.FileDialog.FileName%2A&gt;</ph> property.","pos":[1887,2059],"source":" In the example below, the file to load is taken from the <xref:System.Windows.Forms.OpenFileDialog> component's <xref:System.Windows.Forms.FileDialog.FileName%2A> property."},{"content":"If you call the method with a file name as its only argument, the file type will be assumed to be RTF.","pos":[2060,2162]},{"content":"To specify another file type, call the method with a value of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBoxStreamType&gt;</ph> enumeration as its second argument.","pos":[2163,2314],"source":" To specify another file type, call the method with a value of the <xref:System.Windows.Forms.RichTextBoxStreamType> enumeration as its second argument."},{"content":"In the example below, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.OpenFileDialog&gt;</ph> component is shown when a button is clicked.","pos":[2325,2438],"source":"In the example below, the <xref:System.Windows.Forms.OpenFileDialog> component is shown when a button is clicked."},{"content":"The file selected is then opened and displayed in the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control.","pos":[2439,2541],"source":" The file selected is then opened and displayed in the <xref:System.Windows.Forms.RichTextBox> control."},{"content":"This example assumes a form has a button,<ph id=\"ph1\">`btnOpenFile`</ph>.","pos":[2542,2597],"source":" This example assumes a form has a button,`btnOpenFile`."},{"pos":[3642,3834],"content":"(<ph id=\"ph1\">[!INCLUDE[csprcs](../../../../includes/csprcs-md.md)]</ph>, <ph id=\"ph2\">[!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]</ph>) Place the following code in the form's constructor to register the event handler.","source":"([!INCLUDE[csprcs](../../../../includes/csprcs-md.md)], [!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]) Place the following code in the form's constructor to register the event handler."},{"pos":[4091,4515],"content":"[!IMPORTANT]\nTo run this process, your assembly may require a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=fullName> class. If you are running in a partial-trust context, the process might throw an exception because of insufficient privileges. For more information, see [Code Access Security Basics](../../../../docs/framework/misc/code-access-security-basics.md).","leadings":["","    >  "],"nodes":[{"content":"To run this process, your assembly may require a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=fullName> class. If you are running in a partial-trust context, the process might throw an exception because of insufficient privileges. For more information, see [Code Access Security Basics](../../../../docs/framework/misc/code-access-security-basics.md).","pos":[13,417],"nodes":[{"content":"To run this process, your assembly may require a privilege level granted by the <ph id=\"ph1\">&lt;xref:System.Security.Permissions.FileIOPermission?displayProperty=fullName&gt;</ph> class.","pos":[0,163],"source":"To run this process, your assembly may require a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=fullName> class."},{"content":"If you are running in a partial-trust context, the process might throw an exception because of insufficient privileges.","pos":[164,283]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Access Security Basics<ept id=\"p1\">](../../../../docs/framework/misc/code-access-security-basics.md)</ept>.","pos":[284,404],"source":" For more information, see [Code Access Security Basics](../../../../docs/framework/misc/code-access-security-basics.md)."}]}]},{"pos":[4524,4532],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>RichTextBox Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/richtextbox-control-windows-forms.md)</ept><ph id=\"ph1\"> </ph>","pos":[4661,4766],"source":"[RichTextBox Control](../../../../docs/framework/winforms/controls/richtextbox-control-windows-forms.md) "},{"content":"<bpt id=\"p1\">[</bpt>Controls to Use on Windows Forms<ept id=\"p1\">](../../../../docs/framework/winforms/controls/controls-to-use-on-windows-forms.md)</ept>","pos":[4770,4886],"source":"[Controls to Use on Windows Forms](../../../../docs/framework/winforms/controls/controls-to-use-on-windows-forms.md)"}]}