{"content":"---\ntitle: \"IMetaDataAssemblyEmit::DefineAssemblyRef Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataAssemblyEmit.DefineAssemblyRef\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataAssemblyEmit::DefineAssemblyRef\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DefineAssemblyRef method [.NET Framework metadata]\"\n  - \"IMetaDataAssemblyEmit::DefineAssemblyRef method [.NET Framework metadata]\"\nms.assetid: 0b284b18-0084-4b3a-912a-5ebe9f29c88b\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 17\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# IMetaDataAssemblyEmit::DefineAssemblyRef Method\nCreates an `AssemblyRef` structure containing metadata for the assembly that this assembly references, and returns the associated metadata token.  \n  \n## Syntax  \n  \n```  \nHRESULT DefineAssemblyRef (  \n    [in]  void                *pbPublicKeyOrToken,  \n    [in]  ULONG               cbPublicKeyOrToken,  \n    [in]  LPCWSTR             szName,  \n    [in]  ASSEMBLYMETADATA    pMetaData,  \n    [in]  void                *pbHashValue,  \n    [in]  ULONG               cbHashValue,  \n    [in]  DWORD               dwAssemblyRefFlags,  \n    [out] mdAssemblyRef       *pmdar  \n);  \n```  \n  \n#### Parameters  \n `pbPublicKeyOrToken`  \n [in] The public key of the publisher of the referenced assembly. The helper function [StrongNameTokenFromAssembly](../../../../docs/framework/unmanaged-api/strong-naming/strongnametokenfromassembly-function.md) can be used to get the hash of the public key to pass as this parameter.  \n  \n `cbPublicKeyOrToken`  \n [in] The size in bytes of `pbPublicKeyOrToken`.  \n  \n `szName`  \n [in] The human-readable text name of the assembly. This value must not exceed 1024 characters.  \n  \n `pMetaData`  \n [in] An ASSEMBLYMETADATA instance that contains the version, platform and locale information of the referenced assembly.  \n  \n `pbHashValue`  \n [in] The hash data associated with the referenced assembly. Optional.  \n  \n `cbHashValue`  \n [in] The size in bytes of `pbHashValue`.  \n  \n `dwAssemblyRefFlags`  \n [in] A bitwise combination of [CorAssemblyFlags](../../../../docs/framework/unmanaged-api/metadata/corassemblyflags-enumeration.md) values that influence the behavior of the execution engine.  \n  \n `pmdar`  \n [out] A pointer to the returned `AssemblyRef` metadata token.  \n  \n## Remarks  \n One `AssemblyRef` metadata structure must be defined for each assembly that this assembly references.  \n  \n At run time, the details of a referenced assembly are passed to the assembly resolver with an indication that they represent the \"as built\" information. The assembly resolver then applies policy.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** Cor.h  \n  \n **Library:** Used as a resource in MsCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See Also  \n [IMetaDataAssemblyEmit Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataassemblyemit-interface.md)","nodes":[{"pos":[4,751],"embed":true,"restype":"x-metadata","content":"title: \"IMetaDataAssemblyEmit::DefineAssemblyRef Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataAssemblyEmit.DefineAssemblyRef\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataAssemblyEmit::DefineAssemblyRef\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DefineAssemblyRef method [.NET Framework metadata]\"\n  - \"IMetaDataAssemblyEmit::DefineAssemblyRef method [.NET Framework metadata]\"\nms.assetid: 0b284b18-0084-4b3a-912a-5ebe9f29c88b\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 17\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","nodes":[{"content":"IMetaDataAssemblyEmit::DefineAssemblyRef Method | Microsoft Docs","nodes":[{"pos":[0,64],"content":"IMetaDataAssemblyEmit::DefineAssemblyRef Method | Microsoft Docs","nodes":[{"content":"IMetaDataAssemblyEmit::DefineAssemblyRef Method | Microsoft Docs","pos":[0,64]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[758,805],"content":"IMetaDataAssemblyEmit::DefineAssemblyRef Method","linkify":"IMetaDataAssemblyEmit::DefineAssemblyRef Method","nodes":[{"content":"IMetaDataAssemblyEmit::DefineAssemblyRef Method","pos":[0,47]}]},{"pos":[806,951],"content":"Creates an <ph id=\"ph1\">`AssemblyRef`</ph> structure containing metadata for the assembly that this assembly references, and returns the associated metadata token.","source":"Creates an `AssemblyRef` structure containing metadata for the assembly that this assembly references, and returns the associated metadata token."},{"pos":[960,966],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1397,1407],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The public key of the publisher of the referenced assembly.","pos":[1435,1499]},{"content":"The helper function <bpt id=\"p1\">[</bpt>StrongNameTokenFromAssembly<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/strong-naming/strongnametokenfromassembly-function.md)</ept> can be used to get the hash of the public key to pass as this parameter.","pos":[1500,1718],"source":" The helper function [StrongNameTokenFromAssembly](../../../../docs/framework/unmanaged-api/strong-naming/strongnametokenfromassembly-function.md) can be used to get the hash of the public key to pass as this parameter."},{"content":"[in] The size in bytes of <ph id=\"ph1\">`pbPublicKeyOrToken`</ph>.","pos":[1749,1796],"source":"[in] The size in bytes of `pbPublicKeyOrToken`."},{"content":"[in] The human-readable text name of the assembly.","pos":[1815,1865]},{"content":"This value must not exceed 1024 characters.","pos":[1866,1909]},{"content":"[in] An ASSEMBLYMETADATA instance that contains the version, platform and locale information of the referenced assembly.","pos":[1931,2051]},{"content":"[in] The hash data associated with the referenced assembly.","pos":[2075,2134]},{"content":"Optional.","pos":[2135,2144]},{"content":"[in] The size in bytes of <ph id=\"ph1\">`pbHashValue`</ph>.","pos":[2168,2208],"source":"[in] The size in bytes of `pbHashValue`."},{"content":"[in] A bitwise combination of <bpt id=\"p1\">[</bpt>CorAssemblyFlags<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/corassemblyflags-enumeration.md)</ept> values that influence the behavior of the execution engine.","pos":[2239,2430],"source":"[in] A bitwise combination of [CorAssemblyFlags](../../../../docs/framework/unmanaged-api/metadata/corassemblyflags-enumeration.md) values that influence the behavior of the execution engine."},{"content":"[out] A pointer to the returned <ph id=\"ph1\">`AssemblyRef`</ph> metadata token.","pos":[2448,2509],"source":"[out] A pointer to the returned `AssemblyRef` metadata token."},{"pos":[2518,2525],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2529,2630],"content":"One <ph id=\"ph1\">`AssemblyRef`</ph> metadata structure must be defined for each assembly that this assembly references.","source":"One `AssemblyRef` metadata structure must be defined for each assembly that this assembly references."},{"content":"At run time, the details of a referenced assembly are passed to the assembly resolver with an indication that they represent the \"as built\" information.","pos":[2637,2789]},{"content":"The assembly resolver then applies policy.","pos":[2790,2832]},{"pos":[2841,2853],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2857,2961],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2968,2985],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> Cor.h","source":"**Header:** Cor.h"},{"pos":[2992,3038],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Used as a resource in MsCorEE.dll","source":"**Library:** Used as a resource in MsCorEE.dll"},{"pos":[3045,3073],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept>","source":"**.NET Framework Versions:**"},{"pos":[3162,3170],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[3174,3293],"content":"<bpt id=\"p1\">[</bpt>IMetaDataAssemblyEmit Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataassemblyemit-interface.md)</ept>","source":"[IMetaDataAssemblyEmit Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataassemblyemit-interface.md)"}]}