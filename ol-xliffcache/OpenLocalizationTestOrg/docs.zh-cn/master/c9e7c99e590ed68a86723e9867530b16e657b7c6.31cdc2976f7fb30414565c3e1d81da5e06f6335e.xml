{"content":"---\ntitle: \"How to: Select Ink from a Custom Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"controls, ink selection\"\n  - \"ink, selecting from custom control\"\n  - \"custom controls, ink selection\"\nms.assetid: 5f3a45c6-6d40-4017-9b47-933f134ceba3\ncaps.latest.revision: 5\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Select Ink from a Custom Control\nBy adding an <xref:System.Windows.Ink.IncrementalLassoHitTester> to your custom control, you can enable your control so that a user can select ink with a lasso tool, similar to the way the <xref:System.Windows.Controls.InkCanvas> selects ink with a lasso.  \n  \n This example assumes you are familiar with creating an ink-enabled custom control.  To create a custom control that accepts ink input, see [Creating an Ink Input Control](../../../../docs/framework/wpf/advanced/creating-an-ink-input-control.md).  \n  \n## Example  \n When the user draws a lasso, the <xref:System.Windows.Ink.IncrementalLassoHitTester> predicts which strokes will be within the lasso path's boundaries after the user completes the lasso.  Strokes that are determined to be within the lasso path's boundaries can be thought of as being selected.  Selected strokes can also become unselected.  For example, if the user reverses direction while drawing the lasso, the <xref:System.Windows.Ink.IncrementalLassoHitTester> may unselect some strokes.  \n  \n The <xref:System.Windows.Ink.IncrementalLassoHitTester> raises the <xref:System.Windows.Ink.IncrementalLassoHitTester.SelectionChanged> event, which enables your custom control to respond while the user is drawing the lasso.  For example, you can change the appearance of strokes as the user selects and unselects them.  \n  \n## Managing the Ink Mode  \n It is helpful to the user if the lasso appears differently than the ink on your control. To accomplish this, your custom control must keep track of whether the user is writing or selecting ink. The easiest way to do this is to declare an enumeration with two values: one to indicate that the user is writing ink and one to indicate that the user is selecting ink.  \n  \n [!code-csharp[HowToSelectInk#2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#2)]\n [!code-vb[HowToSelectInk#2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#2)]  \n  \n Next, add two <xref:System.Windows.Ink.DrawingAttributes> to the class: one to use when the user writes ink, one to use when the user selects ink.  In the constructor, initialize the <xref:System.Windows.Ink.DrawingAttributes> and attach both <xref:System.Windows.Ink.DrawingAttributes.AttributeChanged> events to the same event handler. Then set the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.DrawingAttributes%2A> property of the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer> to the ink <xref:System.Windows.Ink.DrawingAttributes>.  \n  \n [!code-csharp[HowToSelectInk#3](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#3)]\n [!code-vb[HowToSelectInk#3](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#3)]  \n[!code-csharp[HowToSelectInk#4](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#4)]\n[!code-vb[HowToSelectInk#4](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#4)]  \n  \n Add a property that exposes the selection mode. When the user changes the selection mode, set the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.DrawingAttributes%2A> property of the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer> to the appropriate <xref:System.Windows.Ink.DrawingAttributes> object and then reattach the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.RootVisual%2A> Property to the <xref:System.Windows.Controls.InkPresenter>.  \n  \n [!code-csharp[HowToSelectInk#5](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#5)]\n [!code-vb[HowToSelectInk#5](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#5)]  \n  \n Expose the <xref:System.Windows.Ink.DrawingAttributes> as properties so applications can determine the appearance of the ink strokes and selection strokes.  \n  \n [!code-csharp[HowToSelectInk#6](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#6)]\n [!code-vb[HowToSelectInk#6](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#6)]  \n  \n When a property of a <xref:System.Windows.Ink.DrawingAttributes> object changes, the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.RootVisual%2A> must be reattached to the <xref:System.Windows.Controls.InkPresenter>.  In the event handler for the <xref:System.Windows.Ink.DrawingAttributes.AttributeChanged> event, reattach the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.RootVisual%2A> to the <xref:System.Windows.Controls.InkPresenter>.  \n  \n [!code-csharp[HowToSelectInk#7](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#7)]\n [!code-vb[HowToSelectInk#7](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#7)]  \n  \n## Using the IncrementalLassoHitTester  \n Create and initialize a <xref:System.Windows.Ink.StrokeCollection> that contains the selected strokes.  \n  \n [!code-csharp[HowToSelectInk#8](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#8)]\n [!code-vb[HowToSelectInk#8](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#8)]  \n  \n When the user starts to draw a stroke, either ink or the lasso, unselect any selected strokes. Then, if the user is drawing a lasso, create an <xref:System.Windows.Ink.IncrementalLassoHitTester> by calling <xref:System.Windows.Ink.StrokeCollection.GetIncrementalLassoHitTester%2A>, subscribe to the <xref:System.Windows.Ink.IncrementalLassoHitTester.SelectionChanged> event, and call <xref:System.Windows.Ink.IncrementalHitTester.AddPoints%2A>. This code can be a separate method and called from the <xref:System.Windows.UIElement.OnStylusDown%2A> and <xref:System.Windows.UIElement.OnMouseDown%2A> methods.  \n  \n [!code-csharp[HowToSelectInk#9](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#9)]\n [!code-vb[HowToSelectInk#9](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#9)]  \n  \n Add the stylus points to the <xref:System.Windows.Ink.IncrementalLassoHitTester> while the user draws the lasso.  Call the following method from the <xref:System.Windows.UIElement.OnStylusMove%2A>, <xref:System.Windows.UIElement.OnStylusUp%2A>, <xref:System.Windows.UIElement.OnMouseMove%2A>, and <xref:System.Windows.UIElement.OnMouseLeftButtonUp%2A> methods.  \n  \n [!code-csharp[HowToSelectInk#10](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#10)]\n [!code-vb[HowToSelectInk#10](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#10)]  \n  \n Handle the <xref:System.Windows.Ink.IncrementalLassoHitTester.SelectionChanged?displayProperty=fullName> event to respond when the user selects and unselects strokes.  The <xref:System.Windows.Ink.LassoSelectionChangedEventArgs> class has the <xref:System.Windows.Ink.LassoSelectionChangedEventArgs.SelectedStrokes%2A> and <xref:System.Windows.Ink.LassoSelectionChangedEventArgs.DeselectedStrokes%2A> properties that get the strokes that were selected and unselected, respectively.  \n  \n [!code-csharp[HowToSelectInk#11](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#11)]\n [!code-vb[HowToSelectInk#11](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#11)]  \n  \n When the user finishes drawing the lasso, unsubscribe from the <xref:System.Windows.Ink.IncrementalLassoHitTester.SelectionChanged> event and call <xref:System.Windows.Ink.IncrementalHitTester.EndHitTesting%2A>.  \n  \n [!code-csharp[HowToSelectInk#12](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#12)]\n [!code-vb[HowToSelectInk#12](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#12)]  \n  \n## Putting it All Together.  \n The following example is a custom control that enables a user to select ink with a lasso.  \n  \n [!code-csharp[HowToSelectInk#1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#1)]\n [!code-vb[HowToSelectInk#1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#1)]  \n  \n## See Also  \n <xref:System.Windows.Ink.IncrementalLassoHitTester>   \n <xref:System.Windows.Ink.StrokeCollection>   \n <xref:System.Windows.Input.StylusPointCollection>   \n [Creating an Ink Input Control](../../../../docs/framework/wpf/advanced/creating-an-ink-input-control.md)","nodes":[{"pos":[4,499],"nodes":[{"content":"How to: Select Ink from a Custom Control | Microsoft Docs","nodes":[{"pos":[0,57],"content":"How to: Select Ink from a Custom Control | Microsoft Docs","nodes":[{"content":"How to: Select Ink from a Custom Control | Microsoft Docs","pos":[0,57]}]}],"pos":[6,66],"yaml":true}],"content":"title: \"How to: Select Ink from a Custom Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"controls, ink selection\"\n  - \"ink, selecting from custom control\"\n  - \"custom controls, ink selection\"\nms.assetid: 5f3a45c6-6d40-4017-9b47-933f134ceba3\ncaps.latest.revision: 5\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","yamlblock":true},{"pos":[506,546],"content":"How to: Select Ink from a Custom Control","linkify":"How to: Select Ink from a Custom Control","nodes":[{"content":"How to: Select Ink from a Custom Control","pos":[0,40]}]},{"content":"By adding an <ph id=\"ph1\">&lt;xref:System.Windows.Ink.IncrementalLassoHitTester&gt;</ph> to your custom control, you can enable your control so that a user can select ink with a lasso tool, similar to the way the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.InkCanvas&gt;</ph> selects ink with a lasso.","pos":[547,802],"source":"By adding an <xref:System.Windows.Ink.IncrementalLassoHitTester> to your custom control, you can enable your control so that a user can select ink with a lasso tool, similar to the way the <xref:System.Windows.Controls.InkCanvas> selects ink with a lasso."},{"content":"This example assumes you are familiar with creating an ink-enabled custom control.","pos":[809,891]},{"content":"To create a custom control that accepts ink input, see <bpt id=\"p1\">[</bpt>Creating an Ink Input Control<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/creating-an-ink-input-control.md)</ept>.","pos":[893,1054],"source":"  To create a custom control that accepts ink input, see [Creating an Ink Input Control](../../../../docs/framework/wpf/advanced/creating-an-ink-input-control.md)."},{"pos":[1063,1070],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"When the user draws a lasso, the <ph id=\"ph1\">&lt;xref:System.Windows.Ink.IncrementalLassoHitTester&gt;</ph> predicts which strokes will be within the lasso path's boundaries after the user completes the lasso.","pos":[1074,1260],"source":"When the user draws a lasso, the <xref:System.Windows.Ink.IncrementalLassoHitTester> predicts which strokes will be within the lasso path's boundaries after the user completes the lasso."},{"content":"Strokes that are determined to be within the lasso path's boundaries can be thought of as being selected.","pos":[1262,1367]},{"content":"Selected strokes can also become unselected.","pos":[1369,1413]},{"content":"For example, if the user reverses direction while drawing the lasso, the <ph id=\"ph1\">&lt;xref:System.Windows.Ink.IncrementalLassoHitTester&gt;</ph> may unselect some strokes.","pos":[1415,1566],"source":"  For example, if the user reverses direction while drawing the lasso, the <xref:System.Windows.Ink.IncrementalLassoHitTester> may unselect some strokes."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Ink.IncrementalLassoHitTester&gt;</ph> raises the <ph id=\"ph2\">&lt;xref:System.Windows.Ink.IncrementalLassoHitTester.SelectionChanged&gt;</ph> event, which enables your custom control to respond while the user is drawing the lasso.","pos":[1573,1797],"source":"The <xref:System.Windows.Ink.IncrementalLassoHitTester> raises the <xref:System.Windows.Ink.IncrementalLassoHitTester.SelectionChanged> event, which enables your custom control to respond while the user is drawing the lasso."},{"content":"For example, you can change the appearance of strokes as the user selects and unselects them.","pos":[1799,1892]},{"pos":[1901,1922],"content":"Managing the Ink Mode","linkify":"Managing the Ink Mode","nodes":[{"content":"Managing the Ink Mode","pos":[0,21]}]},{"content":"It is helpful to the user if the lasso appears differently than the ink on your control.","pos":[1926,2014]},{"content":"To accomplish this, your custom control must keep track of whether the user is writing or selecting ink.","pos":[2015,2119]},{"content":"The easiest way to do this is to declare an enumeration with two values: one to indicate that the user is writing ink and one to indicate that the user is selecting ink.","pos":[2120,2289]},{"pos":[2296,2552],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToSelectInk#2<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#2)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToSelectInk#2<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#2)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[HowToSelectInk#2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#2)]\n [!code-vb[HowToSelectInk#2](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#2)]"},{"content":"Next, add two <ph id=\"ph1\">&lt;xref:System.Windows.Ink.DrawingAttributes&gt;</ph> to the class: one to use when the user writes ink, one to use when the user selects ink.","pos":[2559,2705],"source":"Next, add two <xref:System.Windows.Ink.DrawingAttributes> to the class: one to use when the user writes ink, one to use when the user selects ink."},{"content":"In the constructor, initialize the <ph id=\"ph1\">&lt;xref:System.Windows.Ink.DrawingAttributes&gt;</ph> and attach both <ph id=\"ph2\">&lt;xref:System.Windows.Ink.DrawingAttributes.AttributeChanged&gt;</ph> events to the same event handler.","pos":[2707,2896],"source":"  In the constructor, initialize the <xref:System.Windows.Ink.DrawingAttributes> and attach both <xref:System.Windows.Ink.DrawingAttributes.AttributeChanged> events to the same event handler."},{"content":"Then set the <ph id=\"ph1\">&lt;xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.DrawingAttributes%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Input.StylusPlugIns.DynamicRenderer&gt;</ph> to the ink <ph id=\"ph3\">&lt;xref:System.Windows.Ink.DrawingAttributes&gt;</ph>.","pos":[2897,3118],"source":" Then set the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.DrawingAttributes%2A> property of the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer> to the ink <xref:System.Windows.Ink.DrawingAttributes>."},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToSelectInk#3<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#3)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToSelectInk#3<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#3)</ept><ept id=\"p3\">]</ept>","pos":[3125,3381],"source":"[!code-csharp[HowToSelectInk#3](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#3)]\n [!code-vb[HowToSelectInk#3](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#3)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToSelectInk#4<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#4)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToSelectInk#4<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#4)</ept><ept id=\"p3\">]</ept>","pos":[3384,3639],"source":"[!code-csharp[HowToSelectInk#4](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#4)]\n[!code-vb[HowToSelectInk#4](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#4)]"},{"content":"Add a property that exposes the selection mode.","pos":[3646,3693]},{"content":"When the user changes the selection mode, set the <ph id=\"ph1\">&lt;xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.DrawingAttributes%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Input.StylusPlugIns.DynamicRenderer&gt;</ph> to the appropriate <ph id=\"ph3\">&lt;xref:System.Windows.Ink.DrawingAttributes&gt;</ph> object and then reattach the <ph id=\"ph4\">&lt;xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.RootVisual%2A&gt;</ph> Property to the <ph id=\"ph5\">&lt;xref:System.Windows.Controls.InkPresenter&gt;</ph>.","pos":[3694,4121],"source":" When the user changes the selection mode, set the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.DrawingAttributes%2A> property of the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer> to the appropriate <xref:System.Windows.Ink.DrawingAttributes> object and then reattach the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.RootVisual%2A> Property to the <xref:System.Windows.Controls.InkPresenter>."},{"pos":[4128,4384],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToSelectInk#5<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#5)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToSelectInk#5<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#5)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[HowToSelectInk#5](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#5)]\n [!code-vb[HowToSelectInk#5](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#5)]"},{"content":"Expose the <ph id=\"ph1\">&lt;xref:System.Windows.Ink.DrawingAttributes&gt;</ph> as properties so applications can determine the appearance of the ink strokes and selection strokes.","pos":[4391,4546],"source":"Expose the <xref:System.Windows.Ink.DrawingAttributes> as properties so applications can determine the appearance of the ink strokes and selection strokes."},{"pos":[4553,4809],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToSelectInk#6<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#6)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToSelectInk#6<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#6)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[HowToSelectInk#6](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#6)]\n [!code-vb[HowToSelectInk#6](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#6)]"},{"content":"When a property of a <ph id=\"ph1\">&lt;xref:System.Windows.Ink.DrawingAttributes&gt;</ph> object changes, the <ph id=\"ph2\">&lt;xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.RootVisual%2A&gt;</ph> must be reattached to the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.InkPresenter&gt;</ph>.","pos":[4816,5043],"source":"When a property of a <xref:System.Windows.Ink.DrawingAttributes> object changes, the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.RootVisual%2A> must be reattached to the <xref:System.Windows.Controls.InkPresenter>."},{"content":"In the event handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Ink.DrawingAttributes.AttributeChanged&gt;</ph> event, reattach the <ph id=\"ph2\">&lt;xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.RootVisual%2A&gt;</ph> to the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.InkPresenter&gt;</ph>.","pos":[5045,5278],"source":"  In the event handler for the <xref:System.Windows.Ink.DrawingAttributes.AttributeChanged> event, reattach the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer.RootVisual%2A> to the <xref:System.Windows.Controls.InkPresenter>."},{"pos":[5285,5541],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToSelectInk#7<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#7)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToSelectInk#7<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#7)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[HowToSelectInk#7](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#7)]\n [!code-vb[HowToSelectInk#7](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#7)]"},{"pos":[5550,5585],"content":"Using the IncrementalLassoHitTester","linkify":"Using the IncrementalLassoHitTester","nodes":[{"content":"Using the IncrementalLassoHitTester","pos":[0,35]}]},{"content":"Create and initialize a <ph id=\"ph1\">&lt;xref:System.Windows.Ink.StrokeCollection&gt;</ph> that contains the selected strokes.","pos":[5589,5691],"source":"Create and initialize a <xref:System.Windows.Ink.StrokeCollection> that contains the selected strokes."},{"pos":[5698,5954],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToSelectInk#8<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#8)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToSelectInk#8<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#8)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[HowToSelectInk#8](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#8)]\n [!code-vb[HowToSelectInk#8](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#8)]"},{"content":"When the user starts to draw a stroke, either ink or the lasso, unselect any selected strokes.","pos":[5961,6055]},{"content":"Then, if the user is drawing a lasso, create an <ph id=\"ph1\">&lt;xref:System.Windows.Ink.IncrementalLassoHitTester&gt;</ph> by calling <ph id=\"ph2\">&lt;xref:System.Windows.Ink.StrokeCollection.GetIncrementalLassoHitTester%2A&gt;</ph>, subscribe to the <ph id=\"ph3\">&lt;xref:System.Windows.Ink.IncrementalLassoHitTester.SelectionChanged&gt;</ph> event, and call <ph id=\"ph4\">&lt;xref:System.Windows.Ink.IncrementalHitTester.AddPoints%2A&gt;</ph>.","pos":[6056,6405],"source":" Then, if the user is drawing a lasso, create an <xref:System.Windows.Ink.IncrementalLassoHitTester> by calling <xref:System.Windows.Ink.StrokeCollection.GetIncrementalLassoHitTester%2A>, subscribe to the <xref:System.Windows.Ink.IncrementalLassoHitTester.SelectionChanged> event, and call <xref:System.Windows.Ink.IncrementalHitTester.AddPoints%2A>."},{"content":"This code can be a separate method and called from the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.OnStylusDown%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.OnMouseDown%2A&gt;</ph> methods.","pos":[6406,6568],"source":" This code can be a separate method and called from the <xref:System.Windows.UIElement.OnStylusDown%2A> and <xref:System.Windows.UIElement.OnMouseDown%2A> methods."},{"pos":[6575,6831],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToSelectInk#9<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#9)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToSelectInk#9<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#9)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[HowToSelectInk#9](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#9)]\n [!code-vb[HowToSelectInk#9](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#9)]"},{"content":"Add the stylus points to the <ph id=\"ph1\">&lt;xref:System.Windows.Ink.IncrementalLassoHitTester&gt;</ph> while the user draws the lasso.","pos":[6838,6950],"source":"Add the stylus points to the <xref:System.Windows.Ink.IncrementalLassoHitTester> while the user draws the lasso."},{"content":"Call the following method from the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.OnStylusMove%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.OnStylusUp%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.UIElement.OnMouseMove%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Windows.UIElement.OnMouseLeftButtonUp%2A&gt;</ph> methods.","pos":[6952,7198],"source":"  Call the following method from the <xref:System.Windows.UIElement.OnStylusMove%2A>, <xref:System.Windows.UIElement.OnStylusUp%2A>, <xref:System.Windows.UIElement.OnMouseMove%2A>, and <xref:System.Windows.UIElement.OnMouseLeftButtonUp%2A> methods."},{"pos":[7205,7465],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToSelectInk#10<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#10)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToSelectInk#10<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#10)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[HowToSelectInk#10](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#10)]\n [!code-vb[HowToSelectInk#10](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#10)]"},{"content":"Handle the <ph id=\"ph1\">&lt;xref:System.Windows.Ink.IncrementalLassoHitTester.SelectionChanged?displayProperty=fullName&gt;</ph> event to respond when the user selects and unselects strokes.","pos":[7472,7638],"source":"Handle the <xref:System.Windows.Ink.IncrementalLassoHitTester.SelectionChanged?displayProperty=fullName> event to respond when the user selects and unselects strokes."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Ink.LassoSelectionChangedEventArgs&gt;</ph> class has the <ph id=\"ph2\">&lt;xref:System.Windows.Ink.LassoSelectionChangedEventArgs.SelectedStrokes%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Ink.LassoSelectionChangedEventArgs.DeselectedStrokes%2A&gt;</ph> properties that get the strokes that were selected and unselected, respectively.","pos":[7640,7953],"source":"  The <xref:System.Windows.Ink.LassoSelectionChangedEventArgs> class has the <xref:System.Windows.Ink.LassoSelectionChangedEventArgs.SelectedStrokes%2A> and <xref:System.Windows.Ink.LassoSelectionChangedEventArgs.DeselectedStrokes%2A> properties that get the strokes that were selected and unselected, respectively."},{"pos":[7960,8220],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToSelectInk#11<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#11)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToSelectInk#11<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#11)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[HowToSelectInk#11](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#11)]\n [!code-vb[HowToSelectInk#11](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#11)]"},{"content":"When the user finishes drawing the lasso, unsubscribe from the <ph id=\"ph1\">&lt;xref:System.Windows.Ink.IncrementalLassoHitTester.SelectionChanged&gt;</ph> event and call <ph id=\"ph2\">&lt;xref:System.Windows.Ink.IncrementalHitTester.EndHitTesting%2A&gt;</ph>.","pos":[8227,8438],"source":"When the user finishes drawing the lasso, unsubscribe from the <xref:System.Windows.Ink.IncrementalLassoHitTester.SelectionChanged> event and call <xref:System.Windows.Ink.IncrementalHitTester.EndHitTesting%2A>."},{"pos":[8445,8705],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToSelectInk#12<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#12)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToSelectInk#12<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#12)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[HowToSelectInk#12](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#12)]\n [!code-vb[HowToSelectInk#12](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#12)]"},{"pos":[8714,8738],"content":"Putting it All Together.","linkify":"Putting it All Together.","nodes":[{"content":"Putting it All Together.","pos":[0,24]}]},{"content":"The following example is a custom control that enables a user to select ink with a lasso.","pos":[8742,8831]},{"pos":[8838,9094],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToSelectInk#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToSelectInk#1<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[HowToSelectInk#1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HowToSelectInk/CSharp/InkSelector.cs#1)]\n [!code-vb[HowToSelectInk#1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HowToSelectInk/VisualBasic/InkSelector.vb#1)]"},{"pos":[9103,9111],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Ink.IncrementalLassoHitTester&gt;</ph>","pos":[9115,9166],"source":"<xref:System.Windows.Ink.IncrementalLassoHitTester> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Ink.StrokeCollection&gt;</ph>","pos":[9171,9213],"source":"<xref:System.Windows.Ink.StrokeCollection> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Input.StylusPointCollection&gt;</ph>","pos":[9218,9267],"source":"<xref:System.Windows.Input.StylusPointCollection> "},{"content":"<bpt id=\"p1\">[</bpt>Creating an Ink Input Control<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/creating-an-ink-input-control.md)</ept>","pos":[9272,9377],"source":"[Creating an Ink Input Control](../../../../docs/framework/wpf/advanced/creating-an-ink-input-control.md)"}]}