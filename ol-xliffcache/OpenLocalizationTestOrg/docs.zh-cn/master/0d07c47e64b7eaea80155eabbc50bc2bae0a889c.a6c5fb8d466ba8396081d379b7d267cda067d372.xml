{"content":"---\ntitle: \"How to: Transform XML by Using LINQ (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"XML [Visual Basic], transforming\"\n  - \"LINQ to XML [Visual Basic], transforming XML\"\nms.assetid: 815687f4-0bc2-4c0b-adc6-d78744aa356f\n---\n# How to: Transform XML by Using LINQ (Visual Basic)\n[XML Literals](../../../../visual-basic/language-reference/xml-literals/index.md) make it easy to read XML from one source and transform it to a new XML format. You can take advantage of LINQ queries to retrieve the content to transform, or change content in an existing document to a new XML format.  \n  \n The example in this topic transforms content from an XML source document to HTML to be viewed in a browser.  \n  \n[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  \n  \n### To transform an XML document  \n  \n1.  In Visual Studio, create a new Visual Basic project in the **Console Application** project template.  \n  \n2.  Double-click the Module1.vb file created in the project to modify the Visual Basic code. Add the following code to the `Sub Main` of the `Module1` module. This code creates the source XML document as an <xref:System.Xml.Linq.XDocument> object.  \n  \n    ```vb  \n    Dim catalog =   \n      <?xml version=\"1.0\"?>  \n        <Catalog>  \n          <Book id=\"bk101\">  \n            <Author>Garghentini, Davide</Author>  \n            <Title>XML Developer's Guide</Title>  \n            <Price>44.95</Price>  \n            <Description>  \n              An in-depth look at creating applications  \n              with <technology>XML</technology>. For   \n              <audience>beginners</audience> or   \n              <audience>advanced</audience> developers.  \n            </Description>  \n          </Book>  \n          <Book id=\"bk331\">  \n            <Author>Spencer, Phil</Author>  \n            <Title>Developing Applications with Visual Basic .NET</Title>  \n            <Price>45.95</Price>  \n            <Description>  \n              Get the expert insights, practical code samples,   \n              and best practices you need   \n              to advance your expertise with <technology>Visual   \n              Basic .NET</technology>.   \n              Learn how to create faster, more reliable applications  \n              based on professional,   \n              pragmatic guidance by today's top <audience>developers</audience>.  \n            </Description>  \n          </Book>  \n        </Catalog>  \n    ```  \n  \n     [How to: Load XML from a File, String, or Stream](../../../../visual-basic/programming-guide/language-features/xml/how-to-load-xml-from-a-file-string-or-stream.md).  \n  \n3.  After the code to create the source XML document, add the following code to retrieve all the \\<Book> elements from the object and transform them into an HTML document. The list of \\<Book> elements is created by using a LINQ query that returns a collection of <xref:System.Xml.Linq.XElement> objects that contain the transformed HTML. You can use embedded expressions to put the values from the source document in the new XML format.  \n  \n     The resulting HTML document is written to a file by using the <xref:System.Xml.Linq.XElement.Save%2A> method.  \n  \n    ```vb  \n    Dim htmlOutput =   \n      <html>  \n        <body>  \n          <%= From book In catalog.<Catalog>.<Book>   \n              Select <div>  \n                       <h1><%= book.<Title>.Value %></h1>  \n                       <h3><%= \"By \" & book.<Author>.Value %></h3>  \n                        <h3><%= \"Price = \" & book.<Price>.Value %></h3>  \n                        <h2>Description</h2>  \n                        <%= TransformDescription(book.<Description>(0)) %>  \n                        <hr/>  \n                      </div> %>  \n        </body>  \n      </html>  \n  \n    htmlOutput.Save(\"BookDescription.html\")  \n    ```  \n  \n4.  After `Sub Main` of `Module1`, add a new method (`Sub`) to transform a \\<Description> node into the specified HTML format. This method is called by the code in the previous step and is used to preserve the format of the \\<Description> elements.  \n  \n     This method replaces sub-elements of the \\<Description> element with HTML. The `ReplaceWith` method is used to preserve the location of the sub-elements. The transformed content of the \\<Description> element is included in an HTML paragraph (\\<p>) element. The <xref:System.Xml.Linq.XContainer.Nodes%2A> property is used to retrieve the transformed content of the \\<Description> element. This ensures that sub-elements are included in the transformed content.  \n  \n     Add the following code after `Sub Main` of `Module1`.  \n  \n    ```vb  \n    Public Function TransformDescription(ByVal desc As XElement) As XElement  \n  \n      ' Replace <technology> elements with <b>.  \n      Dim content = (From element In desc...<technology>).ToList()  \n  \n      If content.Count > 0 Then  \n        For i = 0 To content.Count - 1  \n          content(i).ReplaceWith(<b><%= content(i).Value %></b>)  \n        Next  \n      End If  \n  \n      ' Replace <audience> elements with <i>.  \n      content = (From element In desc...<audience>).ToList()  \n  \n      If content.Count > 0 Then  \n        For i = 0 To content.Count - 1  \n          content(i).ReplaceWith(<i><%= content(i).Value %></i>)  \n        Next  \n      End If  \n  \n      ' Return the updated contents of the <Description> element.  \n      Return <p><%= desc.Nodes %></p>  \n    End Function  \n    ```  \n  \n5.  Save your changes.  \n  \n6.  Press F5 to run the code. The resulting saved document will resemble the following:  \n  \n    ```  \n    <?xml version=\"1.0\"?>  \n    <html>  \n      <body>  \n        <div>  \n          <h1>XML Developer's Guide</h1>  \n          <h3>By Garghentini, Davide</h3>  \n          <h3>Price = 44.95</h3>  \n          <h2>Description</h2>  \n          <p>  \n            An in-depth look at creating applications  \n            with <b>XML</b>. For   \n            <i>beginners</i> or   \n            <i>advanced</i> developers.  \n          </p>  \n          <hr />  \n        </div>  \n        <div>  \n          <h1>Developing Applications with Visual Basic .NET</h1>  \n          <h3>By Spencer, Phil</h3>  \n          <h3>Price = 45.95</h3>  \n          <h2>Description</h2>  \n          <p>  \n            Get the expert insights, practical code   \n            samples, and best practices you need   \n            to advance your expertise with <b>Visual   \n            Basic .NET</b>. Learn how to create faster,  \n            more reliable applications based on  \n            professional, pragmatic guidance by today's   \n            top <i>developers</i>.  \n          </p>  \n          <hr />  \n        </div>  \n      </body>  \n    </html>  \n    ```  \n  \n## See also\n\n- [XML Literals](../../../../visual-basic/language-reference/xml-literals/index.md)\n- [Manipulating XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/manipulating-xml.md)\n- [XML](../../../../visual-basic/programming-guide/language-features/xml/index.md)\n- [How to: Load XML from a File, String, or Stream](../../../../visual-basic/programming-guide/language-features/xml/how-to-load-xml-from-a-file-string-or-stream.md)\n- [LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)\n- [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)\n","nodes":[{"pos":[4,244],"embed":true,"restype":"x-metadata","content":"title: \"How to: Transform XML by Using LINQ (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"XML [Visual Basic], transforming\"\n  - \"LINQ to XML [Visual Basic], transforming XML\"\nms.assetid: 815687f4-0bc2-4c0b-adc6-d78744aa356f","nodes":[{"content":"How to: Transform XML by Using LINQ (Visual Basic)","nodes":[{"pos":[0,50],"content":"How to: Transform XML by Using LINQ (Visual Basic)","nodes":[{"content":"How to: Transform XML by Using LINQ (Visual Basic)","pos":[0,50]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[251,301],"content":"How to: Transform XML by Using LINQ (Visual Basic)","linkify":"How to: Transform XML by Using LINQ (Visual Basic)","nodes":[{"content":"How to: Transform XML by Using LINQ (Visual Basic)","pos":[0,50]}]},{"content":"<bpt id=\"p1\">[</bpt>XML Literals<ept id=\"p1\">](../../../../visual-basic/language-reference/xml-literals/index.md)</ept> make it easy to read XML from one source and transform it to a new XML format.","pos":[302,462],"source":"[XML Literals](../../../../visual-basic/language-reference/xml-literals/index.md) make it easy to read XML from one source and transform it to a new XML format."},{"content":"You can take advantage of LINQ queries to retrieve the content to transform, or change content in an existing document to a new XML format.","pos":[463,602]},{"content":"The example in this topic transforms content from an XML source document to HTML to be viewed in a browser.","pos":[609,716]},{"pos":[805,833],"content":"To transform an XML document","linkify":"To transform an XML document","nodes":[{"content":"To transform an XML document","pos":[0,28]}]},{"pos":[843,943],"content":"In Visual Studio, create a new Visual Basic project in the <bpt id=\"p1\">**</bpt>Console Application<ept id=\"p1\">**</ept> project template.","source":"In Visual Studio, create a new Visual Basic project in the **Console Application** project template."},{"content":"Double-click the Module1.vb file created in the project to modify the Visual Basic code.","pos":[953,1041]},{"content":"Add the following code to the <ph id=\"ph1\">`Sub Main`</ph> of the <ph id=\"ph2\">`Module1`</ph> module.","pos":[1042,1107],"source":" Add the following code to the `Sub Main` of the `Module1` module."},{"content":"This code creates the source XML document as an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph> object.","pos":[1108,1196],"source":" This code creates the source XML document as an <xref:System.Xml.Linq.XDocument> object."},{"pos":[2468,2632],"content":"<bpt id=\"p1\">[</bpt>How to: Load XML from a File, String, or Stream<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/how-to-load-xml-from-a-file-string-or-stream.md)</ept>.","source":"[How to: Load XML from a File, String, or Stream](../../../../visual-basic/programming-guide/language-features/xml/how-to-load-xml-from-a-file-string-or-stream.md)."},{"content":"After the code to create the source XML document, add the following code to retrieve all the <ph id=\"ph1\">\\&lt;</ph>Book&gt; elements from the object and transform them into an HTML document.","pos":[2642,2809],"source":"After the code to create the source XML document, add the following code to retrieve all the \\<Book> elements from the object and transform them into an HTML document."},{"content":"The list of <ph id=\"ph1\">\\&lt;</ph>Book&gt; elements is created by using a LINQ query that returns a collection of <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> objects that contain the transformed HTML.","pos":[2810,2975],"source":" The list of \\<Book> elements is created by using a LINQ query that returns a collection of <xref:System.Xml.Linq.XElement> objects that contain the transformed HTML."},{"content":"You can use embedded expressions to put the values from the source document in the new XML format.","pos":[2976,3074]},{"pos":[3085,3194],"content":"The resulting HTML document is written to a file by using the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement.Save%2A&gt;</ph> method.","source":"The resulting HTML document is written to a file by using the <xref:System.Xml.Linq.XElement.Save%2A> method."},{"content":"After <ph id=\"ph1\">`Sub Main`</ph> of <ph id=\"ph2\">`Module1`</ph>, add a new method (<ph id=\"ph3\">`Sub`</ph>) to transform a <ph id=\"ph4\">\\&lt;</ph>Description&gt; node into the specified HTML format.","pos":[3845,3967],"source":"After `Sub Main` of `Module1`, add a new method (`Sub`) to transform a \\<Description> node into the specified HTML format."},{"content":"This method is called by the code in the previous step and is used to preserve the format of the <ph id=\"ph1\">\\&lt;</ph>Description&gt; elements.","pos":[3968,4089],"source":" This method is called by the code in the previous step and is used to preserve the format of the \\<Description> elements."},{"content":"This method replaces sub-elements of the <ph id=\"ph1\">\\&lt;</ph>Description&gt; element with HTML.","pos":[4100,4174],"source":"This method replaces sub-elements of the \\<Description> element with HTML."},{"content":"The <ph id=\"ph1\">`ReplaceWith`</ph> method is used to preserve the location of the sub-elements.","pos":[4175,4253],"source":" The `ReplaceWith` method is used to preserve the location of the sub-elements."},{"content":"The transformed content of the <ph id=\"ph1\">\\&lt;</ph>Description&gt; element is included in an HTML paragraph (<ph id=\"ph2\">\\&lt;</ph>p&gt;) element.","pos":[4254,4356],"source":" The transformed content of the \\<Description> element is included in an HTML paragraph (\\<p>) element."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XContainer.Nodes%2A&gt;</ph> property is used to retrieve the transformed content of the <ph id=\"ph2\">\\&lt;</ph>Description&gt; element.","pos":[4357,4487],"source":" The <xref:System.Xml.Linq.XContainer.Nodes%2A> property is used to retrieve the transformed content of the \\<Description> element."},{"content":"This ensures that sub-elements are included in the transformed content.","pos":[4488,4559]},{"pos":[4570,4623],"content":"Add the following code after <ph id=\"ph1\">`Sub Main`</ph> of <ph id=\"ph2\">`Module1`</ph>.","source":"Add the following code after `Sub Main` of `Module1`."},{"content":"Save your changes.","pos":[5453,5471]},{"content":"Press F5 to run the code.","pos":[5481,5506]},{"content":"The resulting saved document will resemble the following:","pos":[5507,5564]},{"pos":[6717,6725],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6729,6810],"content":"<bpt id=\"p1\">[</bpt>XML Literals<ept id=\"p1\">](../../../../visual-basic/language-reference/xml-literals/index.md)</ept>","source":"[XML Literals](../../../../visual-basic/language-reference/xml-literals/index.md)"},{"pos":[6813,6933],"content":"<bpt id=\"p1\">[</bpt>Manipulating XML in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/manipulating-xml.md)</ept>","source":"[Manipulating XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/manipulating-xml.md)"},{"pos":[6936,7016],"content":"<bpt id=\"p1\">[</bpt>XML<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/index.md)</ept>","source":"[XML](../../../../visual-basic/programming-guide/language-features/xml/index.md)"},{"pos":[7019,7182],"content":"<bpt id=\"p1\">[</bpt>How to: Load XML from a File, String, or Stream<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/how-to-load-xml-from-a-file-string-or-stream.md)</ept>","source":"[How to: Load XML from a File, String, or Stream](../../../../visual-basic/programming-guide/language-features/xml/how-to-load-xml-from-a-file-string-or-stream.md)"},{"pos":[7185,7267],"content":"<bpt id=\"p1\">[</bpt>LINQ<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/linq/index.md)</ept>","source":"[LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)"},{"pos":[7270,7399],"content":"<bpt id=\"p1\">[</bpt>Introduction to LINQ in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)</ept>","source":"[Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)"}]}