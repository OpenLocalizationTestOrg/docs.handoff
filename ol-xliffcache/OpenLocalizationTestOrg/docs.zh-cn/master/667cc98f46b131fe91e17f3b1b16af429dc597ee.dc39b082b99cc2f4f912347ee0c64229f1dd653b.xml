{"content":"---\ntitle: \"Middle-Tier Client Applications\"\nms.date: \"03/30/2017\"\nms.assetid: f9714a64-d0ae-4a98-bca0-5d370fdbd631\n---\n# Middle-Tier Client Applications\nThis topic discusses various issues specific to middle-tier client applications that use Windows Communication Foundation (WCF).  \n  \n## Increasing Middle-Tier Client Performance  \n Compared to previous communications technologies, such as Web services using [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)], the creation of a WCF client instance can be more complex due to the rich feature set of WCF. For example, when a <xref:System.ServiceModel.ChannelFactory%601> object is opened it can establish a secure session with the service, a procedure that increases the startup time for the client instance. Typically, these additional feature capabilities do not affect client applications greatly since the WCF client makes several calls, and then closes.  \n  \n Middle-tier client applications, however, can create many WCF client objects quickly and, as a result, experience increased initialization requirements. There are two main approaches to increasing the performance of middle-tier applications when calling services:  \n  \n-   Cache the WCF client object and reuse it for subsequent calls where possible.  \n  \n-   Create a <xref:System.ServiceModel.ChannelFactory%601> object and then use that object to create new WCF client channel objects for each call.  \n  \n Issues to consider when using these approaches include:  \n  \n-   If the service is maintaining a client-specific state by using a session, then you cannot reuse the middle-tier WCF client with multiple-client tier requests because the service's state is tied to that of the middle-tier client.  \n  \n-   If the service must perform authentication on a per-client basis, you must create a new client for each incoming request on the middle tier instead of reusing the middle-tier WCF client (or WCF client channel object) because the client credentials of the middle tier cannot be modified after the WCF client (or <xref:System.ServiceModel.ChannelFactory%601>) has been created.  \n  \n-   While channels and clients created by the channels are thread-safe, they might not support writing more than one message to the wire concurrently. If you are sending large messages, particularly if streaming, the send operation might block waiting for another send to complete. This causes two sorts of problems: a lack of concurrency and the possibility of deadlock if the flow of control returns to the service reusing the channel (that is, the shared client calls a service whose code path results in a callback to the shared client). This is true regardless of the type of WCF client you reuse.  \n  \n-   You must handle faulted channels regardless of whether you share the channel. When channels are reused, however, a faulting channel can take down more than one pending request or send.  \n  \n For an example that demonstrates best practices for reusing a client for multiple requests, see [Data Binding in an ASP.NET Client](../../../../docs/framework/wcf/samples/data-binding-in-an-aspnet-client.md).  \n  \n In addition, you can increase the startup performance for those clients that use data types that are serializable using the <xref:System.Xml.Serialization.XmlSerializer> generate and compile serialization code for those data types at runtime, which can result in slow start-up performance. The [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) can improve start-up performance for these applications by generating the necessary serialization code from the compiled assemblies for the application. For more information, see [How to: Improve the Startup Time of WCF Client Applications using the XmlSerializer](../../../../docs/framework/wcf/feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).  \n  \n## See also\n\n- [Accessing Services Using a WCF Client](../../../../docs/framework/wcf/feature-details/accessing-services-using-a-client.md)\n","nodes":[{"pos":[4,115],"embed":true,"restype":"x-metadata","content":"title: \"Middle-Tier Client Applications\"\nms.date: \"03/30/2017\"\nms.assetid: f9714a64-d0ae-4a98-bca0-5d370fdbd631","nodes":[{"content":"Middle-Tier Client Applications","nodes":[{"pos":[0,31],"content":"Middle-Tier Client Applications","nodes":[{"content":"Middle-Tier Client Applications","pos":[0,31]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[122,153],"content":"Middle-Tier Client Applications","linkify":"Middle-Tier Client Applications","nodes":[{"content":"Middle-Tier Client Applications","pos":[0,31]}]},{"content":"This topic discusses various issues specific to middle-tier client applications that use Windows Communication Foundation (WCF).","pos":[154,282]},{"pos":[291,332],"content":"Increasing Middle-Tier Client Performance","linkify":"Increasing Middle-Tier Client Performance","nodes":[{"content":"Increasing Middle-Tier Client Performance","pos":[0,41]}]},{"content":"Compared to previous communications technologies, such as Web services using <ph id=\"ph1\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph>, the creation of a WCF client instance can be more complex due to the rich feature set of WCF.","pos":[336,565],"source":"Compared to previous communications technologies, such as Web services using [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)], the creation of a WCF client instance can be more complex due to the rich feature set of WCF."},{"content":"For example, when a <ph id=\"ph1\">&lt;xref:System.ServiceModel.ChannelFactory%601&gt;</ph> object is opened it can establish a secure session with the service, a procedure that increases the startup time for the client instance.","pos":[566,769],"source":" For example, when a <xref:System.ServiceModel.ChannelFactory%601> object is opened it can establish a secure session with the service, a procedure that increases the startup time for the client instance."},{"content":"Typically, these additional feature capabilities do not affect client applications greatly since the WCF client makes several calls, and then closes.","pos":[770,919]},{"content":"Middle-tier client applications, however, can create many WCF client objects quickly and, as a result, experience increased initialization requirements.","pos":[926,1078]},{"content":"There are two main approaches to increasing the performance of middle-tier applications when calling services:","pos":[1079,1189]},{"content":"Cache the WCF client object and reuse it for subsequent calls where possible.","pos":[1199,1276]},{"pos":[1286,1428],"content":"Create a <ph id=\"ph1\">&lt;xref:System.ServiceModel.ChannelFactory%601&gt;</ph> object and then use that object to create new WCF client channel objects for each call.","source":"Create a <xref:System.ServiceModel.ChannelFactory%601> object and then use that object to create new WCF client channel objects for each call."},{"content":"Issues to consider when using these approaches include:","pos":[1435,1490]},{"content":"If the service is maintaining a client-specific state by using a session, then you cannot reuse the middle-tier WCF client with multiple-client tier requests because the service's state is tied to that of the middle-tier client.","pos":[1500,1728]},{"pos":[1738,2113],"content":"If the service must perform authentication on a per-client basis, you must create a new client for each incoming request on the middle tier instead of reusing the middle-tier WCF client (or WCF client channel object) because the client credentials of the middle tier cannot be modified after the WCF client (or <ph id=\"ph1\">&lt;xref:System.ServiceModel.ChannelFactory%601&gt;</ph>) has been created.","source":"If the service must perform authentication on a per-client basis, you must create a new client for each incoming request on the middle tier instead of reusing the middle-tier WCF client (or WCF client channel object) because the client credentials of the middle tier cannot be modified after the WCF client (or <xref:System.ServiceModel.ChannelFactory%601>) has been created."},{"content":"While channels and clients created by the channels are thread-safe, they might not support writing more than one message to the wire concurrently.","pos":[2123,2269]},{"content":"If you are sending large messages, particularly if streaming, the send operation might block waiting for another send to complete.","pos":[2270,2400]},{"content":"This causes two sorts of problems: a lack of concurrency and the possibility of deadlock if the flow of control returns to the service reusing the channel (that is, the shared client calls a service whose code path results in a callback to the shared client).","pos":[2401,2660]},{"content":"This is true regardless of the type of WCF client you reuse.","pos":[2661,2721]},{"content":"You must handle faulted channels regardless of whether you share the channel.","pos":[2731,2808]},{"content":"When channels are reused, however, a faulting channel can take down more than one pending request or send.","pos":[2809,2915]},{"pos":[2922,3130],"content":"For an example that demonstrates best practices for reusing a client for multiple requests, see <bpt id=\"p1\">[</bpt>Data Binding in an ASP.NET Client<ept id=\"p1\">](../../../../docs/framework/wcf/samples/data-binding-in-an-aspnet-client.md)</ept>.","source":"For an example that demonstrates best practices for reusing a client for multiple requests, see [Data Binding in an ASP.NET Client](../../../../docs/framework/wcf/samples/data-binding-in-an-aspnet-client.md)."},{"content":"In addition, you can increase the startup performance for those clients that use data types that are serializable using the <ph id=\"ph1\">&lt;xref:System.Xml.Serialization.XmlSerializer&gt;</ph> generate and compile serialization code for those data types at runtime, which can result in slow start-up performance.","pos":[3137,3426],"source":"In addition, you can increase the startup performance for those clients that use data types that are serializable using the <xref:System.Xml.Serialization.XmlSerializer> generate and compile serialization code for those data types at runtime, which can result in slow start-up performance."},{"content":"The <bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept> can improve start-up performance for these applications by generating the necessary serialization code from the compiled assemblies for the application.","pos":[3427,3716],"source":" The [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) can improve start-up performance for these applications by generating the necessary serialization code from the compiled assemblies for the application."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Improve the Startup Time of WCF Client Applications using the XmlSerializer<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md)</ept>.","pos":[3717,3944],"source":" For more information, see [How to: Improve the Startup Time of WCF Client Applications using the XmlSerializer](../../../../docs/framework/wcf/feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md)."},{"pos":[3953,3961],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3965,4089],"content":"<bpt id=\"p1\">[</bpt>Accessing Services Using a WCF Client<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/accessing-services-using-a-client.md)</ept>","source":"[Accessing Services Using a WCF Client](../../../../docs/framework/wcf/feature-details/accessing-services-using-a-client.md)"}]}