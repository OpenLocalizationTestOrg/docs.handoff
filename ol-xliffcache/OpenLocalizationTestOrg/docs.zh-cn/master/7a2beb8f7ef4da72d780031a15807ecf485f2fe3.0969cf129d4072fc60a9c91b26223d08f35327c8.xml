{"content":"---\ntitle: \"How to: Call Windows APIs (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"API calls\"\n  - \"Windows API, calling\"\n  - \"API calls, platform invoke\"\n  - \"calls, stored procedures\"\nms.assetid: 27d75f0a-54ab-4ee1-b91d-43513a19b12d\ncaps.latest.revision: 14\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Call Windows APIs (Visual Basic)\nThis example defines and calls the `MessageBox` function in user32.dll and then passes a string to it.  \n  \n## Example  \n [!code-vb[VbVbalrInterop#1](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/how-to-call-windows-apis_1.vb)]  \n  \n## Compiling the Code  \n This example requires:  \n  \n-   A reference to the <xref:System> namespace.  \n  \n## Robust Programming  \n The following conditions may cause an exception:  \n  \n-   The method is not static, is abstract, or has been previously defined. The parent type is an interface, or the length of *name* or *dllName* is zero. (<xref:System.ArgumentException>)  \n  \n-   The *name* or *dllName* is `Nothing`. (<xref:System.ArgumentNullException>)  \n  \n-   The containing type has been previously created using `CreateType`. (<xref:System.InvalidOperationException>)  \n  \n## See Also  \n [A Closer Look at Platform Invoke](http://msdn.microsoft.com/en-us/ba9dd55b-2eaa-45cd-8afd-75cb8d64d243)   \n [Platform Invoke Examples](../../../framework/interop/platform-invoke-examples.md)   \n [Consuming Unmanaged DLL Functions](../../../framework/interop/consuming-unmanaged-dll-functions.md)   \n [Defining a Method with Reflection Emit](http://msdn.microsoft.com/en-us/84fd3bf6-628f-41aa-83d9-b990cf926e81)   \n [Walkthrough: Calling Windows APIs](../../../visual-basic/programming-guide/com-interop/walkthrough-calling-windows-apis.md)   \n [COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)","nodes":[{"pos":[12,69],"content":"How to: Call Windows APIs (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Call Windows APIs (Visual Basic) | Microsoft Docs","pos":[0,57]}]},{"pos":[671,711],"content":"How to: Call Windows APIs (Visual Basic)","linkify":"How to: Call Windows APIs (Visual Basic)","nodes":[{"content":"How to: Call Windows APIs (Visual Basic)","pos":[0,40]}]},{"pos":[712,814],"content":"This example defines and calls the <ph id=\"ph1\">`MessageBox`</ph> function in user32.dll and then passes a string to it.","source":"This example defines and calls the `MessageBox` function in user32.dll and then passes a string to it."},{"pos":[823,830],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[834,969],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrInterop#1<ept id=\"p2\">](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/how-to-call-windows-apis_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrInterop#1](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/how-to-call-windows-apis_1.vb)]"},{"pos":[978,996],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"This example requires:","pos":[1000,1022]},{"content":"A reference to the <ph id=\"ph1\">&lt;xref:System&gt;</ph> namespace.","pos":[1032,1075],"source":"A reference to the <xref:System> namespace."},{"pos":[1084,1102],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"The following conditions may cause an exception:","pos":[1106,1154]},{"content":"The method is not static, is abstract, or has been previously defined.","pos":[1164,1234]},{"content":"The parent type is an interface, or the length of <bpt id=\"p1\">*</bpt>name<ept id=\"p1\">*</ept> or <bpt id=\"p2\">*</bpt>dllName<ept id=\"p2\">*</ept> is zero.","pos":[1235,1313],"source":" The parent type is an interface, or the length of *name* or *dllName* is zero."},{"content":"(<ph id=\"ph1\">&lt;xref:System.ArgumentException&gt;</ph>)","pos":[1314,1347],"source":" (<xref:System.ArgumentException>)"},{"content":"The <bpt id=\"p1\">*</bpt>name<ept id=\"p1\">*</ept> or <bpt id=\"p2\">*</bpt>dllName<ept id=\"p2\">*</ept> is <ph id=\"ph1\">`Nothing`</ph>.","pos":[1357,1394],"source":"The *name* or *dllName* is `Nothing`."},{"content":"(<ph id=\"ph1\">&lt;xref:System.ArgumentNullException&gt;</ph>)","pos":[1395,1432],"source":" (<xref:System.ArgumentNullException>)"},{"content":"The containing type has been previously created using <ph id=\"ph1\">`CreateType`</ph>.","pos":[1442,1509],"source":"The containing type has been previously created using `CreateType`."},{"content":"(<ph id=\"ph1\">&lt;xref:System.InvalidOperationException&gt;</ph>)","pos":[1510,1551],"source":" (<xref:System.InvalidOperationException>)"},{"pos":[1560,1568],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>A Closer Look at Platform Invoke<ept id=\"p1\">](http://msdn.microsoft.com/en-us/ba9dd55b-2eaa-45cd-8afd-75cb8d64d243)</ept><ph id=\"ph1\"> </ph>","pos":[1572,1677],"source":"[A Closer Look at Platform Invoke](http://msdn.microsoft.com/en-us/ba9dd55b-2eaa-45cd-8afd-75cb8d64d243) "},{"content":"<bpt id=\"p1\"> [</bpt>Platform Invoke Examples<ept id=\"p1\">](../../../framework/interop/platform-invoke-examples.md)</ept><ph id=\"ph1\"> </ph>","pos":[1680,1764],"source":" [Platform Invoke Examples](../../../framework/interop/platform-invoke-examples.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Consuming Unmanaged DLL Functions<ept id=\"p1\">](../../../framework/interop/consuming-unmanaged-dll-functions.md)</ept><ph id=\"ph1\"> </ph>","pos":[1767,1869],"source":" [Consuming Unmanaged DLL Functions](../../../framework/interop/consuming-unmanaged-dll-functions.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Defining a Method with Reflection Emit<ept id=\"p1\">](http://msdn.microsoft.com/en-us/84fd3bf6-628f-41aa-83d9-b990cf926e81)</ept><ph id=\"ph1\"> </ph>","pos":[1872,1984],"source":" [Defining a Method with Reflection Emit](http://msdn.microsoft.com/en-us/84fd3bf6-628f-41aa-83d9-b990cf926e81) "},{"content":"<bpt id=\"p1\"> [</bpt>Walkthrough: Calling Windows APIs<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/walkthrough-calling-windows-apis.md)</ept><ph id=\"ph1\"> </ph>","pos":[1987,2113],"source":" [Walkthrough: Calling Windows APIs](../../../visual-basic/programming-guide/com-interop/walkthrough-calling-windows-apis.md) "},{"content":"<bpt id=\"p1\"> [</bpt>COM Interop<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/index.md)</ept>","pos":[2116,2192],"source":" [COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)"}]}