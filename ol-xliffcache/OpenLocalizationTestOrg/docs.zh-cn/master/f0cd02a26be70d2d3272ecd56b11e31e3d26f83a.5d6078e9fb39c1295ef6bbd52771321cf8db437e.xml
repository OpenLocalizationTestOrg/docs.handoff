{"content":"---\ntitle: \"How to: read from fixed-width text Files in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"fixed-width text file\"\n  - \"reading text files, fixed-width\"\n  - \"files, parsing\"\n  - \"text files, tasks\"\n  - \"text files, reading\"\nms.assetid: 99be5692-967a-4e85-993e-cd18139a5a69\ncaps.latest.revision: 24\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: read from fixed-width text files in Visual Basic\nThe `TextFieldParser` object provides a way to easily and efficiently parse structured text files, such as logs.  \n  \n The `TextFieldType` property defines whether the parsed file is a delimited file or one that has fixed-width fields of text. In a fixed-width text file, the field at the end can have a variable width. To specify that the field at the end has a variable width, define it to have a width less than or equal to zero.  \n  \n### To parse a fixed-width text file  \n  \n1.  Create a new `TextFieldParser`. The following code creates the `TextFieldParser` named `Reader` and opens the file `test.log`.  \n  \n     [!code-vb[VbFileIORead#9](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_1.vb)]  \n  \n2.  Define the `TextFieldType` property as `FixedWidth`, defining the width and format. The following code defines the columns of text; the first is 5 characters wide, the second 10, the third 11, and the fourth is of variable width.  \n  \n     [!code-vb[VbFileIORead#10](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_2.vb)]  \n  \n3.  Loop through the fields in the file. If any lines are corrupted, report an error and continue parsing.  \n  \n     [!code-vb[VbFileIORead#11](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_3.vb)]  \n  \n4.  Close the `While` and `Using` blocks with `End While` and `End Using`.  \n  \n     [!code-vb[VbFileIORead#12](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_4.vb)]  \n  \n## Example  \n This example reads from the file `test.log`.  \n  \n [!code-vb[VbFileIORead#13](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_5.vb)]  \n  \n## Robust programming  \n The following conditions may cause an exception:  \n  \n-   A row cannot be parsed using the specified format (<xref:Microsoft.VisualBasic.FileIO.MalformedLineException>). The exception message specifies the line causing the exception, while the <xref:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine%2A> property is assigned to the text contained in the line.  \n  \n-   The specified file does not exist (<xref:System.IO.FileNotFoundException>).  \n  \n-   A partial-trust situation in which the user does not have sufficient permissions to access the file. (<xref:System.Security.SecurityException>).  \n  \n-   The path is too long (<xref:System.IO.PathTooLongException>).  \n  \n-   The user does not have sufficient permissions to access the file (<xref:System.UnauthorizedAccessException>).  \n  \n## See also  \n <xref:Microsoft.VisualBasic.FileIO.TextFieldParser?displayProperty=fullName>   \n [How to: Read From Comma-Delimited Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md)   \n [How to: Read From Text Files with Multiple Formats](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)   \n [Parsing Text Files with the TextFieldParser Object](../../../../visual-basic/developing-apps/programming/drives-directories-files/parsing-text-files-with-the-textfieldparser-object.md)   \n [Walkthrough: Manipulating Files and Directories in Visual Basic](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md)   \n [Troubleshooting: Reading from and Writing to Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md)   \n ","nodes":[{"pos":[4,710],"nodes":[{"content":"How to: read from fixed-width text Files in Visual Basic | Microsoft Docs","nodes":[{"pos":[0,73],"content":"How to: read from fixed-width text Files in Visual Basic | Microsoft Docs","nodes":[{"content":"How to: read from fixed-width text Files in Visual Basic | Microsoft Docs","pos":[0,73]}]}],"pos":[6,82],"yaml":true}],"content":"title: \"How to: read from fixed-width text Files in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"fixed-width text file\"\n  - \"reading text files, fixed-width\"\n  - \"files, parsing\"\n  - \"text files, tasks\"\n  - \"text files, reading\"\nms.assetid: 99be5692-967a-4e85-993e-cd18139a5a69\ncaps.latest.revision: 24\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","yamlblock":true},{"pos":[717,773],"content":"How to: read from fixed-width text files in Visual Basic","linkify":"How to: read from fixed-width text files in Visual Basic","nodes":[{"content":"How to: read from fixed-width text files in Visual Basic","pos":[0,56]}]},{"pos":[774,886],"content":"The <ph id=\"ph1\">`TextFieldParser`</ph> object provides a way to easily and efficiently parse structured text files, such as logs.","source":"The `TextFieldParser` object provides a way to easily and efficiently parse structured text files, such as logs."},{"content":"The <ph id=\"ph1\">`TextFieldType`</ph> property defines whether the parsed file is a delimited file or one that has fixed-width fields of text.","pos":[893,1017],"source":"The `TextFieldType` property defines whether the parsed file is a delimited file or one that has fixed-width fields of text."},{"content":"In a fixed-width text file, the field at the end can have a variable width.","pos":[1018,1093]},{"content":"To specify that the field at the end has a variable width, define it to have a width less than or equal to zero.","pos":[1094,1206]},{"pos":[1216,1248],"content":"To parse a fixed-width text file","linkify":"To parse a fixed-width text file","nodes":[{"content":"To parse a fixed-width text file","pos":[0,32]}]},{"content":"Create a new <ph id=\"ph1\">`TextFieldParser`</ph>.","pos":[1258,1289],"source":"Create a new `TextFieldParser`."},{"content":"The following code creates the <ph id=\"ph1\">`TextFieldParser`</ph> named <ph id=\"ph2\">`Reader`</ph> and opens the file <ph id=\"ph3\">`test.log`</ph>.","pos":[1290,1384],"source":" The following code creates the `TextFieldParser` named `Reader` and opens the file `test.log`."},{"pos":[1395,1569],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbFileIORead#9<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbFileIORead#9](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_1.vb)]"},{"content":"Define the <ph id=\"ph1\">`TextFieldType`</ph> property as <ph id=\"ph2\">`FixedWidth`</ph>, defining the width and format.","pos":[1579,1662],"source":"Define the `TextFieldType` property as `FixedWidth`, defining the width and format."},{"content":"The following code defines the columns of text; the first is 5 characters wide, the second 10, the third 11, and the fourth is of variable width.","pos":[1663,1808]},{"pos":[1819,1994],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbFileIORead#10<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_2.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbFileIORead#10](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_2.vb)]"},{"content":"Loop through the fields in the file.","pos":[2004,2040]},{"content":"If any lines are corrupted, report an error and continue parsing.","pos":[2041,2106]},{"pos":[2117,2292],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbFileIORead#11<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_3.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbFileIORead#11](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_3.vb)]"},{"pos":[2302,2372],"content":"Close the <ph id=\"ph1\">`While`</ph> and <ph id=\"ph2\">`Using`</ph> blocks with <ph id=\"ph3\">`End While`</ph> and <ph id=\"ph4\">`End Using`</ph>.","source":"Close the `While` and `Using` blocks with `End While` and `End Using`."},{"pos":[2383,2558],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbFileIORead#12<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_4.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbFileIORead#12](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_4.vb)]"},{"pos":[2567,2574],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2578,2622],"content":"This example reads from the file <ph id=\"ph1\">`test.log`</ph>.","source":"This example reads from the file `test.log`."},{"pos":[2629,2804],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbFileIORead#13<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_5.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbFileIORead#13](../../../../visual-basic/developing-apps/programming/drives-directories-files/codesnippet/VisualBasic/how-to-read-from-fixed-width-text-files_5.vb)]"},{"pos":[2813,2831],"content":"Robust programming","linkify":"Robust programming","nodes":[{"content":"Robust programming","pos":[0,18]}]},{"content":"The following conditions may cause an exception:","pos":[2835,2883]},{"content":"A row cannot be parsed using the specified format (<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.MalformedLineException&gt;</ph>).","pos":[2893,3004],"source":"A row cannot be parsed using the specified format (<xref:Microsoft.VisualBasic.FileIO.MalformedLineException>)."},{"content":"The exception message specifies the line causing the exception, while the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine%2A&gt;</ph> property is assigned to the text contained in the line.","pos":[3005,3199],"source":" The exception message specifies the line causing the exception, while the <xref:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine%2A> property is assigned to the text contained in the line."},{"content":"The specified file does not exist (<ph id=\"ph1\">&lt;xref:System.IO.FileNotFoundException&gt;</ph>).","pos":[3209,3284],"source":"The specified file does not exist (<xref:System.IO.FileNotFoundException>)."},{"content":"A partial-trust situation in which the user does not have sufficient permissions to access the file.","pos":[3294,3394]},{"content":"(<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","pos":[3395,3438],"source":" (<xref:System.Security.SecurityException>)."},{"content":"The path is too long (<ph id=\"ph1\">&lt;xref:System.IO.PathTooLongException&gt;</ph>).","pos":[3448,3509],"source":"The path is too long (<xref:System.IO.PathTooLongException>)."},{"content":"The user does not have sufficient permissions to access the file (<ph id=\"ph1\">&lt;xref:System.UnauthorizedAccessException&gt;</ph>).","pos":[3519,3628],"source":"The user does not have sufficient permissions to access the file (<xref:System.UnauthorizedAccessException>)."},{"pos":[3637,3645],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.TextFieldParser?displayProperty=fullName&gt;</ph>","pos":[3649,3725],"source":"<xref:Microsoft.VisualBasic.FileIO.TextFieldParser?displayProperty=fullName> "},{"content":"<bpt id=\"p1\">[</bpt>How to: Read From Comma-Delimited Text Files<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md)</ept><ph id=\"ph1\"> </ph>","pos":[3730,3903],"source":"[How to: Read From Comma-Delimited Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Read From Text Files with Multiple Formats<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)</ept><ph id=\"ph1\"> </ph>","pos":[3907,4092],"source":"[How to: Read From Text Files with Multiple Formats](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md) "},{"content":"<bpt id=\"p1\">[</bpt>Parsing Text Files with the TextFieldParser Object<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/parsing-text-files-with-the-textfieldparser-object.md)</ept><ph id=\"ph1\"> </ph>","pos":[4096,4282],"source":"[Parsing Text Files with the TextFieldParser Object](../../../../visual-basic/developing-apps/programming/drives-directories-files/parsing-text-files-with-the-textfieldparser-object.md) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Manipulating Files and Directories in Visual Basic<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md)</ept><ph id=\"ph1\"> </ph>","pos":[4286,4481],"source":"[Walkthrough: Manipulating Files and Directories in Visual Basic](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md) "},{"content":"<bpt id=\"p1\">[</bpt>Troubleshooting: Reading from and Writing to Text Files<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md)</ept>","pos":[4485,4679],"source":"[Troubleshooting: Reading from and Writing to Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md)"}]}