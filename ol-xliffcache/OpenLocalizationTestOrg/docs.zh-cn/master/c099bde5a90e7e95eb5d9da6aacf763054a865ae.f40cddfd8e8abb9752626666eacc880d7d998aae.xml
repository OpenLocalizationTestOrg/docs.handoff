{"content":"---\ntitle: Test a .NET Standard class library with .NET Core in Visual Studio 2017\ndescription: Create a unit test project for your .NET Core class library. Verify that your .NET Core class library works correctly with unit tests.\nauthor: BillWagner\nms.author: wiwagn\nms.date: 08/07/2017\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.custom: \"vs-dotnet, seodoc18\"\n---\n# Test a .NET Standard library with .NET Core in Visual Studio 2017\n\nIn [Build a .NET Standard library with C# and .NET Core in Visual Studio 2017](library-with-visual-studio.md) or [Build a .NET Standard library with Visual Basic and .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md), you created a simple class library that adds an extension method to the <xref:System.String> class. Now, you'll create a unit test to make sure that it works as expected. You'll add your unit test project to the solution you created in the previous article.\n\n## Creating a unit test project\n\nTo create the unit test project, do the following:\n\n# [C#](#tab/csharp)\n1. In **Solution Explorer**, open the context menu for the **ClassLibraryProjects** solution node and select **Add** > **New Project**.\n\n1. In the **Add New Project** dialog, select the **Visual C#** node. Then select the **.NET Core** node followed by the **MSTest Test Project (.NET Core)** project template. In the **Name** text box, enter \"StringLibraryTest\" as the name of the project. Select **OK** to create the unit test project.\n\n   ![Add New Project dialog with unit test project displayed - C#](./media/testing-library-with-visual-studio/create-new-test-project.png)\n\n   > [!NOTE]  \n   > In addition to an MSTest Test project, you can also use Visual Studio to create an xUnit test project for .NET Core.\n\n1. Visual Studio creates the project and opens the *UnitTest1.cs* file in the code window.\n\n   ![Visual Studio code window for the unit test project class and method - C#](./media/testing-library-with-visual-studio/unit-test-editor-window.png)\n\n   The source code created by the unit test template does the following:\n\n   * It imports the <xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=nameWithType> namespace, which contains the types used for unit testing.\n\n   * It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> attribute to the `UnitTest1` class. Each test method in a test class tagged with the \\[TestMethod\\] attribute is executed automatically when the unit test is run.\n\n   * It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute to define `TestMethod1` as a test method for automatic execution when the unit test is run.\n\n1. In **Solution Explorer**, right-click the **Dependencies** node of the **StringLibraryTest** project and select **Add Reference** from the context menu.\n\n   ![Context menu of StringLibraryTest Dependencies - C#](./media/testing-library-with-visual-studio/add-reference-context-menu.png)\n\n1. In the **Reference Manager** dialog, expand the **Projects** node and check the box next to **StringLibrary**. Adding a reference to the `StringLibrary` assembly allows the compiler to find **StringLibrary** methods. Select the **OK** button. This adds a reference to your class library project, `StringLibrary`.\n\n   ![Visual Studio add project reference dialog](./media/testing-library-with-visual-studio/project-reference-manager.png)\n# [Visual Basic](#tab/vb) \n1. In **Solution Explorer**, open the context menu for the **ClassLibraryProjects** solution node and select **Add** > **New Project**.\n\n1. In the **Add New Project** dialog, select the **Visual Basic** node. Then select the **.NET Core** node followed by the **MSTest Test Project (.NET Core)** project template. In the **Name** text box, enter \"StringLibraryTest\" as the name of the project. Select **OK** to create the unit test project.\n\n   ![Add New Project dialog with unit test project displayed - Visual Basic](./media/testing-library-with-visual-studio/vb-create-new-test-project.png)\n\n   > [!NOTE]  \n   > In addition to an MSTest Test project, you can also use Visual Studio to create an xUnit test project for .NET Core.\n\n1. Visual Studio creates the project and opens the *UnitTest1.vb* file in the code window.\n\n   ![Visual Studio code window for the unit test project class and method - Visual Basic](./media/testing-library-with-visual-studio/vb-unit-test-editor-window.png)\n\n   The source code created by the unit test template does the following:\n\n   * It imports the [Microsoft.VisualStudio.TestTools.UnitTesting]<xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=namewithType> namespace, which contains the types used for unit testing.\n\n   * It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute>) attribute to the `UnitTest1` class. Each test method in a test class tagged with the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute is executed automatically when the unit test is run.\n\n   * It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute to define `TestMethod1` as a test method for automatic execution when the unit test is run.\n\n1. In **Solution Explorer**, right-click the **Dependencies** node of the **StringLibraryTest** project and select **Add Reference** from the context menu.\n\n   ![Context menu of StringLibraryTest Dependencies](./media/testing-library-with-visual-studio/add-reference-context-menu.png)\n\n1. In the **Reference Manager** dialog, expand the **Projects** node and check the box next to **StringLibrary**. Adding a reference to the `StringLibrary` assembly allows the compiler to find **StringLibrary** methods. Select the **OK** button. This adds a reference to your class library project, `StringLibrary`.\n\n   ![Visual Studio add project reference dialog - Visual Basic](./media/testing-library-with-visual-studio/project-reference-manager.png)\n---\n\n## Adding and running unit test methods\n\nWhen Visual Studio runs a unit test, it executes each method marked with the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute in a unit test class, the class to which the  <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> attribute is applied. A test method ends when the first failure is encountered or when all tests contained in the method have succeeded.\n\nThe most common tests call members of the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert> class. Many assert methods include at least two parameters, one of which is the expected test result and the other of which is the actual test result. Some of its most frequently called methods are shown in the table below.\n\nAssert methods | Function\n--- | ---\n`Assert.AreEqual` | Verifies that two values or objects are equal. The assert fails if the values or objects are not equal.\n`Assert.AreSame` | Verifies that two object variables refer to the same object. The assert fails if the variables refer to different objects.\n`Assert.IsFalse` | Verifies that a condition is `false`. The assert fails if the condition is `true`.\n`Assert.IsNotNull` | Verifies that an object is not `null`. The assert fails if the object is `null`.\n\nYou can also apply the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.ExpectedExceptionAttribute> attribute to a test method. It indicates the type of exception a test method is expected to throw. The test fails if the specified exception is not thrown.\n\nIn testing the `StringLibrary.StartsWithUpper` method, you want to provide a number of strings that begin with an uppercase character. You expect the method to return `true` in these cases, so you can call the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsTrue%2A> method. Similarly, you want to provide a number of strings that begin with something other than an uppercase character. You expect the method to return `false` in these cases, so you can call the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsFalse%2A> method.\n\nSince your library method handles strings, you also want to make sure that it successfully handles an [empty string (`String.Empty`)](xref:System.String.Empty), a valid string that has no characters and whose <xref:System.String.Length> is 0, and a `null` string that has not been initialized. If `StartsWithUpper` is called as an extension method on a <xref:System.String> instance, it cannot be passed a `null` string. However, you can also call it directly as a static method and pass a single <xref:System.String> argument.\n\nYou'll define three methods, each of which calls its <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert> method repeatedly for each element in a string array. Because the test method fails as soon as it encounters the first failure, you'll call a method overload that allows you to pass a string that indicates the string value used in the method call.\n\nTo create the test methods:\n\n# [C#](#tab/csharp) \n1. In the *UnitTest1.cs* code window, replace the code with the following code:\n\n   [!CODE-csharp[Test#1](../../../samples/snippets/csharp/getting_started/with_visual_studio_2017/testlib1.cs)]\n\n   Note that your test of uppercase characters in the `TestStartsWithUpper` method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the `TestDoesNotStartWithUpper` method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).\n\n1. On the menu bar, select **File** > **Save UnitTest1.cs As**. In the **Save File As** dialog, select the arrow beside the **Save** button, and select **Save with Encoding**.\n\n   ![Visual Studio Save File As dialog - C#](./media/testing-library-with-visual-studio/save-file-as-dialog.png)\n# [Visual Basic](#tab/vb) \n1. In the *UnitTest1.vb* code window, replace the code with the following code:\n\n    [!CODE-vb[Test#1](../../../samples/snippets/core/tutorials/vb-library-with-visual-studio/testlib.vb)]\n\n   Note that your test of uppercase characters in the `TestStartsWithUpper` method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the `TestDoesNotStartWithUpper` method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).\n\n1. On the menu bar, select **File** > **Save UnitTest1.vb As**. In the **Save File As** dialog, select the arrow beside the **Save** button, and select **Save with Encoding**.\n\n   ![Visual Studio Save File As dialog - Visual Basic](./media/testing-library-with-visual-studio/save-file-as-dialog.png)\n---\n\n1. In the **Confirm Save As** dialog, select the **Yes** button to save the file.\n\n1. In the **Advanced Save Options** dialog, select **Unicode (UTF-8 with signature) - Codepage 65001** from the **Encoding** drop-down list and select **OK**.\n\n   ![Visual Studio Advanced Save Options dialog](./media/testing-library-with-visual-studio/advanced-save-options.png)\n\n   If you fail to save your source code as a UTF8-encoded file, Visual Studio may save it as an ASCII file. When that happens, the runtime doesn't accurately decode the UTF8 characters outside of the ASCII range, and the test results won't be accurate.\n\n1. On the menu bar, select **Test** > **Run** > **All Tests**. The **Test Explorer** window opens and shows that the tests ran successfully. The three tests are listed in the **Passed Tests** section, and the **Summary** section reports the result of the test run.\n\n   ![Test Explorer window with passing tests](./media/testing-library-with-visual-studio/test-explorer-window.png)\n\n## Handling test failures\n\nYour test run had no failures, but change it slightly so that one of the test methods fails:\n\n1. Modify the `words` array in the `TestDoesNotStartWithUpper` method to include the string \"Error\". You don't need to save the file because Visual Studio automatically saves open files when a solution is built to run tests.\n\n   ```csharp\n   string[] words = { \"alphabet\", \"Error\", \"zebra\", \"abc\", \"αυτοκινητοβιομηχανία\", \"государство\",\n                      \"1234\", \".\", \";\", \" \" };\n   ```\n   ```vb\n   Dim words() As String = { \"alphabet\", \"Error\", \"zebra\", \"abc\", \"αυτοκινητοβιομηχανία\", \"государство\",\n                      \"1234\", \".\", \";\", \" \" }\n\n   ```\n1. Run the test by selecting **Test** > **Run** > **All Tests** from the menu bar. The **Test Explorer** window indicates that two tests succeeded and one failed.\n\n   ![Test Explorer window with failing tests](./media/testing-library-with-visual-studio/failed-test-window.png)\n\n1. In the **Failed Tests** section, select the failed test, `TestDoesNotStartWith`. The **Test Explorer** window displays the message produced by the assert: \"Assert.IsFalse failed. Expected for 'Error': false; actual: True\". Because of the failure, all strings in the array after \"Error\" were not tested.\n\n   ![Test Explorer window showing the Is False assertion failure](./media/testing-library-with-visual-studio/failed-test-detail.png)\n\n1. Undo the modification you did in step 1 and remove the string \"Error\". Rerun the test and the tests will pass.\n\n## Testing the Release version of the library\n\nYou've been running your tests against the Debug version of the library. Now that your tests have all passed and you've adequately tested your library, you should run the tests an additional time against the Release build of the library. A number of factors, including compiler optimizations, can sometimes produce different behavior between Debug and Release builds.\n\nTo test the Release build:\n\n1. In the Visual Studio toolbar, change the build configuration from **Debug** to **Release**.\n\n   ![Visual Studio toolbar with release build highlighted](./media/testing-library-with-visual-studio/visual-studio-toolbar-release.png)\n\n1. In **Solution Explorer**, right-click the **StringLibrary** project and select **Build** from the context menu to recompile the library.\n\n   ![StringLibrary context menu with build command](./media/testing-library-with-visual-studio/build-library-context-menu.png)\n\n1. Run the unit tests by choosing **Test** > **Run** > **All Tests** from the menu bar. The tests pass.\n\nNow that you've finished testing your library, the next step is to make it available to callers. You can bundle it with one or more applications, or you can distribute it as a NuGet package. For more information, see [Consuming a .NET Standard Class Library](./consuming-library-with-visual-studio.md).\n","nodes":[{"pos":[4,354],"embed":true,"restype":"x-metadata","content":"title: Test a .NET Standard class library with .NET Core in Visual Studio 2017\ndescription: Create a unit test project for your .NET Core class library. Verify that your .NET Core class library works correctly with unit tests.\nauthor: BillWagner\nms.author: wiwagn\nms.date: 08/07/2017\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.custom: \"vs-dotnet, seodoc18\"","nodes":[{"content":"Test a .NET Standard class library with .NET Core in Visual Studio 2017","nodes":[{"pos":[0,71],"content":"Test a .NET Standard class library with .NET Core in Visual Studio 2017","nodes":[{"content":"Test a .NET Standard class library with .NET Core in Visual Studio 2017","pos":[0,71]}]}],"path":["title"],"nosxs":false},{"content":"Create a unit test project for your .NET Core class library. Verify that your .NET Core class library works correctly with unit tests.","nodes":[{"pos":[0,134],"content":"Create a unit test project for your .NET Core class library. Verify that your .NET Core class library works correctly with unit tests.","nodes":[{"content":"Create a unit test project for your .NET Core class library. Verify that your .NET Core class library works correctly with unit tests.","pos":[0,134],"nodes":[{"content":"Create a unit test project for your .NET Core class library.","pos":[0,60]},{"content":"Verify that your .NET Core class library works correctly with unit tests.","pos":[61,134]}]}]}],"path":["description"],"nosxs":false}],"yml":true},{"pos":[361,426],"content":"Test a .NET Standard library with .NET Core in Visual Studio 2017","linkify":"Test a .NET Standard library with .NET Core in Visual Studio 2017","nodes":[{"content":"Test a .NET Standard library with .NET Core in Visual Studio 2017","pos":[0,65]}]},{"content":"In <bpt id=\"p1\">[</bpt>Build a .NET Standard library with C# and .NET Core in Visual Studio 2017<ept id=\"p1\">](library-with-visual-studio.md)</ept> or <bpt id=\"p2\">[</bpt>Build a .NET Standard library with Visual Basic and .NET Core in Visual Studio 2017<ept id=\"p2\">](vb-library-with-visual-studio.md)</ept>, you created a simple class library that adds an extension method to the <ph id=\"ph1\">&lt;xref:System.String&gt;</ph> class.","pos":[428,761],"source":"In [Build a .NET Standard library with C# and .NET Core in Visual Studio 2017](library-with-visual-studio.md) or [Build a .NET Standard library with Visual Basic and .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md), you created a simple class library that adds an extension method to the <xref:System.String> class."},{"content":"Now, you'll create a unit test to make sure that it works as expected.","pos":[762,832]},{"content":"You'll add your unit test project to the solution you created in the previous article.","pos":[833,919]},{"pos":[924,952],"content":"Creating a unit test project","linkify":"Creating a unit test project","nodes":[{"content":"Creating a unit test project","pos":[0,28]}]},{"content":"To create the unit test project, do the following:","pos":[954,1004]},{"pos":[1008,1025],"content":"<bpt id=\"p1\">[</bpt>C#<ept id=\"p1\">](#tab/csharp)</ept>","linkify":"[C#](#tab/csharp)","source":"[C#](#tab/csharp)"},{"pos":[1029,1161],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, open the context menu for the <bpt id=\"p2\">**</bpt>ClassLibraryProjects<ept id=\"p2\">**</ept> solution node and select <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p4\">**</bpt>New Project<ept id=\"p4\">**</ept>.","source":"In **Solution Explorer**, open the context menu for the **ClassLibraryProjects** solution node and select **Add** > **New Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>Add New Project<ept id=\"p1\">**</ept> dialog, select the <bpt id=\"p2\">**</bpt>Visual C#<ept id=\"p2\">**</ept> node.","pos":[1166,1231],"source":"In the **Add New Project** dialog, select the **Visual C#** node."},{"content":"Then select the <bpt id=\"p1\">**</bpt>.NET Core<ept id=\"p1\">**</ept> node followed by the <bpt id=\"p2\">**</bpt>MSTest Test Project (.NET Core)<ept id=\"p2\">**</ept> project template.","pos":[1232,1336],"source":" Then select the **.NET Core** node followed by the **MSTest Test Project (.NET Core)** project template."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> text box, enter \"StringLibraryTest\" as the name of the project.","pos":[1337,1416],"source":" In the **Name** text box, enter \"StringLibraryTest\" as the name of the project."},{"content":"Select <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to create the unit test project.","pos":[1417,1463],"source":" Select **OK** to create the unit test project."},{"content":"Add New Project dialog with unit test project displayed - C#","pos":[1470,1530]},{"pos":[1610,1741],"content":"[!NOTE]  \nIn addition to an MSTest Test project, you can also use Visual Studio to create an xUnit test project for .NET Core.","leadings":["","   > "],"nodes":[{"content":"In addition to an MSTest Test project, you can also use Visual Studio to create an xUnit test project for .NET Core.","pos":[10,126]}]},{"pos":[1746,1833],"content":"Visual Studio creates the project and opens the <bpt id=\"p1\">*</bpt>UnitTest1.cs<ept id=\"p1\">*</ept> file in the code window.","source":"Visual Studio creates the project and opens the *UnitTest1.cs* file in the code window."},{"content":"Visual Studio code window for the unit test project class and method - C#","pos":[1840,1913]},{"content":"The source code created by the unit test template does the following:","pos":[1991,2060]},{"pos":[2067,2221],"content":"It imports the <ph id=\"ph1\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=nameWithType&gt;</ph> namespace, which contains the types used for unit testing.","source":"It imports the <xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=nameWithType> namespace, which contains the types used for unit testing."},{"content":"It applies the <ph id=\"ph1\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute&gt;</ph> attribute to the <ph id=\"ph2\">`UnitTest1`</ph> class.","pos":[2228,2349],"source":"It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> attribute to the `UnitTest1` class."},{"content":"Each test method in a test class tagged with the <ph id=\"ph1\">\\[</ph>TestMethod<ph id=\"ph2\">\\]</ph> attribute is executed automatically when the unit test is run.","pos":[2350,2476],"source":" Each test method in a test class tagged with the \\[TestMethod\\] attribute is executed automatically when the unit test is run."},{"pos":[2483,2671],"content":"It applies the <ph id=\"ph1\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute&gt;</ph> attribute to define <ph id=\"ph2\">`TestMethod1`</ph> as a test method for automatic execution when the unit test is run.","source":"It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute to define `TestMethod1` as a test method for automatic execution when the unit test is run."},{"pos":[2676,2828],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the <bpt id=\"p2\">**</bpt>Dependencies<ept id=\"p2\">**</ept> node of the <bpt id=\"p3\">**</bpt>StringLibraryTest<ept id=\"p3\">**</ept> project and select <bpt id=\"p4\">**</bpt>Add Reference<ept id=\"p4\">**</ept> from the context menu.","source":"In **Solution Explorer**, right-click the **Dependencies** node of the **StringLibraryTest** project and select **Add Reference** from the context menu."},{"content":"Context menu of StringLibraryTest Dependencies - C#","pos":[2835,2886]},{"content":"In the <bpt id=\"p1\">**</bpt>Reference Manager<ept id=\"p1\">**</ept> dialog, expand the <bpt id=\"p2\">**</bpt>Projects<ept id=\"p2\">**</ept> node and check the box next to <bpt id=\"p3\">**</bpt>StringLibrary<ept id=\"p3\">**</ept>.","pos":[2967,3077],"source":"In the **Reference Manager** dialog, expand the **Projects** node and check the box next to **StringLibrary**."},{"content":"Adding a reference to the <ph id=\"ph1\">`StringLibrary`</ph> assembly allows the compiler to find <bpt id=\"p1\">**</bpt>StringLibrary<ept id=\"p1\">**</ept> methods.","pos":[3078,3183],"source":" Adding a reference to the `StringLibrary` assembly allows the compiler to find **StringLibrary** methods."},{"content":"Select the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button.","pos":[3184,3209],"source":" Select the **OK** button."},{"content":"This adds a reference to your class library project, <ph id=\"ph1\">`StringLibrary`</ph>.","pos":[3210,3279],"source":" This adds a reference to your class library project, `StringLibrary`."},{"content":"Visual Studio add project reference dialog","pos":[3286,3328]},{"pos":[3406,3429],"content":"<bpt id=\"p1\">[</bpt>Visual Basic<ept id=\"p1\">](#tab/vb)</ept>","linkify":"[Visual Basic](#tab/vb)","source":"[Visual Basic](#tab/vb)"},{"pos":[3434,3566],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, open the context menu for the <bpt id=\"p2\">**</bpt>ClassLibraryProjects<ept id=\"p2\">**</ept> solution node and select <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p4\">**</bpt>New Project<ept id=\"p4\">**</ept>.","source":"In **Solution Explorer**, open the context menu for the **ClassLibraryProjects** solution node and select **Add** > **New Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>Add New Project<ept id=\"p1\">**</ept> dialog, select the <bpt id=\"p2\">**</bpt>Visual Basic<ept id=\"p2\">**</ept> node.","pos":[3571,3639],"source":"In the **Add New Project** dialog, select the **Visual Basic** node."},{"content":"Then select the <bpt id=\"p1\">**</bpt>.NET Core<ept id=\"p1\">**</ept> node followed by the <bpt id=\"p2\">**</bpt>MSTest Test Project (.NET Core)<ept id=\"p2\">**</ept> project template.","pos":[3640,3744],"source":" Then select the **.NET Core** node followed by the **MSTest Test Project (.NET Core)** project template."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> text box, enter \"StringLibraryTest\" as the name of the project.","pos":[3745,3824],"source":" In the **Name** text box, enter \"StringLibraryTest\" as the name of the project."},{"content":"Select <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to create the unit test project.","pos":[3825,3871],"source":" Select **OK** to create the unit test project."},{"content":"Add New Project dialog with unit test project displayed - Visual Basic","pos":[3878,3948]},{"pos":[4031,4162],"content":"[!NOTE]  \nIn addition to an MSTest Test project, you can also use Visual Studio to create an xUnit test project for .NET Core.","leadings":["","   > "],"nodes":[{"content":"In addition to an MSTest Test project, you can also use Visual Studio to create an xUnit test project for .NET Core.","pos":[10,126]}]},{"pos":[4167,4254],"content":"Visual Studio creates the project and opens the <bpt id=\"p1\">*</bpt>UnitTest1.vb<ept id=\"p1\">*</ept> file in the code window.","source":"Visual Studio creates the project and opens the *UnitTest1.vb* file in the code window."},{"content":"Visual Studio code window for the unit test project class and method - Visual Basic","pos":[4261,4344]},{"content":"The source code created by the unit test template does the following:","pos":[4425,4494]},{"pos":[4501,4701],"content":"It imports the [Microsoft.VisualStudio.TestTools.UnitTesting]<ph id=\"ph1\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=namewithType&gt;</ph> namespace, which contains the types used for unit testing.","source":"It imports the [Microsoft.VisualStudio.TestTools.UnitTesting]<xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=namewithType> namespace, which contains the types used for unit testing."},{"content":"It applies the <ph id=\"ph1\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute&gt;</ph>) attribute to the <ph id=\"ph2\">`UnitTest1`</ph> class.","pos":[4708,4830],"source":"It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute>) attribute to the `UnitTest1` class."},{"content":"Each test method in a test class tagged with the <ph id=\"ph1\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute&gt;</ph> attribute is executed automatically when the unit test is run.","pos":[4831,5014],"source":" Each test method in a test class tagged with the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute is executed automatically when the unit test is run."},{"pos":[5021,5209],"content":"It applies the <ph id=\"ph1\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute&gt;</ph> attribute to define <ph id=\"ph2\">`TestMethod1`</ph> as a test method for automatic execution when the unit test is run.","source":"It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute to define `TestMethod1` as a test method for automatic execution when the unit test is run."},{"pos":[5214,5366],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the <bpt id=\"p2\">**</bpt>Dependencies<ept id=\"p2\">**</ept> node of the <bpt id=\"p3\">**</bpt>StringLibraryTest<ept id=\"p3\">**</ept> project and select <bpt id=\"p4\">**</bpt>Add Reference<ept id=\"p4\">**</ept> from the context menu.","source":"In **Solution Explorer**, right-click the **Dependencies** node of the **StringLibraryTest** project and select **Add Reference** from the context menu."},{"content":"Context menu of StringLibraryTest Dependencies","pos":[5373,5419]},{"content":"In the <bpt id=\"p1\">**</bpt>Reference Manager<ept id=\"p1\">**</ept> dialog, expand the <bpt id=\"p2\">**</bpt>Projects<ept id=\"p2\">**</ept> node and check the box next to <bpt id=\"p3\">**</bpt>StringLibrary<ept id=\"p3\">**</ept>.","pos":[5500,5610],"source":"In the **Reference Manager** dialog, expand the **Projects** node and check the box next to **StringLibrary**."},{"content":"Adding a reference to the <ph id=\"ph1\">`StringLibrary`</ph> assembly allows the compiler to find <bpt id=\"p1\">**</bpt>StringLibrary<ept id=\"p1\">**</ept> methods.","pos":[5611,5716],"source":" Adding a reference to the `StringLibrary` assembly allows the compiler to find **StringLibrary** methods."},{"content":"Select the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button.","pos":[5717,5742],"source":" Select the **OK** button."},{"content":"This adds a reference to your class library project, <ph id=\"ph1\">`StringLibrary`</ph>.","pos":[5743,5812],"source":" This adds a reference to your class library project, `StringLibrary`."},{"content":"Visual Studio add project reference dialog - Visual Basic","pos":[5819,5876]},{"pos":[5960,5996],"content":"Adding and running unit test methods","linkify":"Adding and running unit test methods","nodes":[{"content":"Adding and running unit test methods","pos":[0,36]}]},{"content":"When Visual Studio runs a unit test, it executes each method marked with the <ph id=\"ph1\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute&gt;</ph> attribute in a unit test class, the class to which the  <ph id=\"ph2\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute&gt;</ph> attribute is applied.","pos":[5998,6295],"source":"When Visual Studio runs a unit test, it executes each method marked with the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute in a unit test class, the class to which the  <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> attribute is applied."},{"content":"A test method ends when the first failure is encountered or when all tests contained in the method have succeeded.","pos":[6296,6410]},{"content":"The most common tests call members of the <ph id=\"ph1\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert&gt;</ph> class.","pos":[6412,6519],"source":"The most common tests call members of the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert> class."},{"content":"Many assert methods include at least two parameters, one of which is the expected test result and the other of which is the actual test result.","pos":[6520,6663]},{"content":"Some of its most frequently called methods are shown in the table below.","pos":[6664,6736]},{"content":"Assert methods","pos":[6738,6752]},{"content":"Function","pos":[6755,6763]},{"content":"Verifies that two values or objects are equal.","pos":[6794,6840]},{"content":"The assert fails if the values or objects are not equal.","pos":[6841,6897]},{"content":"Verifies that two object variables refer to the same object.","pos":[6917,6977]},{"content":"The assert fails if the variables refer to different objects.","pos":[6978,7039]},{"content":"Verifies that a condition is <ph id=\"ph1\">`false`</ph>.","pos":[7059,7096],"source":"Verifies that a condition is `false`."},{"content":"The assert fails if the condition is <ph id=\"ph1\">`true`</ph>.","pos":[7097,7141],"source":" The assert fails if the condition is `true`."},{"content":"Verifies that an object is not <ph id=\"ph1\">`null`</ph>.","pos":[7163,7201],"source":"Verifies that an object is not `null`."},{"content":"The assert fails if the object is <ph id=\"ph1\">`null`</ph>.","pos":[7202,7243],"source":" The assert fails if the object is `null`."},{"content":"You can also apply the <ph id=\"ph1\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting.ExpectedExceptionAttribute&gt;</ph> attribute to a test method.","pos":[7245,7374],"source":"You can also apply the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.ExpectedExceptionAttribute> attribute to a test method."},{"content":"It indicates the type of exception a test method is expected to throw.","pos":[7375,7445]},{"content":"The test fails if the specified exception is not thrown.","pos":[7446,7502]},{"content":"In testing the <ph id=\"ph1\">`StringLibrary.StartsWithUpper`</ph> method, you want to provide a number of strings that begin with an uppercase character.","pos":[7504,7638],"source":"In testing the `StringLibrary.StartsWithUpper` method, you want to provide a number of strings that begin with an uppercase character."},{"content":"You expect the method to return <ph id=\"ph1\">`true`</ph> in these cases, so you can call the <ph id=\"ph2\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsTrue%2A&gt;</ph> method.","pos":[7639,7790],"source":" You expect the method to return `true` in these cases, so you can call the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsTrue%2A> method."},{"content":"Similarly, you want to provide a number of strings that begin with something other than an uppercase character.","pos":[7791,7902]},{"content":"You expect the method to return <ph id=\"ph1\">`false`</ph> in these cases, so you can call the <ph id=\"ph2\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsFalse%2A&gt;</ph> method.","pos":[7903,8056],"source":" You expect the method to return `false` in these cases, so you can call the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsFalse%2A> method."},{"content":"Since your library method handles strings, you also want to make sure that it successfully handles an <bpt id=\"p1\">[</bpt>empty string (<ph id=\"ph1\">`String.Empty`</ph>)<ept id=\"p1\">](xref:System.String.Empty)</ept>, a valid string that has no characters and whose <ph id=\"ph2\">&lt;xref:System.String.Length&gt;</ph> is 0, and a <ph id=\"ph3\">`null`</ph> string that has not been initialized.","pos":[8058,8351],"source":"Since your library method handles strings, you also want to make sure that it successfully handles an [empty string (`String.Empty`)](xref:System.String.Empty), a valid string that has no characters and whose <xref:System.String.Length> is 0, and a `null` string that has not been initialized."},{"content":"If <ph id=\"ph1\">`StartsWithUpper`</ph> is called as an extension method on a <ph id=\"ph2\">&lt;xref:System.String&gt;</ph> instance, it cannot be passed a <ph id=\"ph3\">`null`</ph> string.","pos":[8352,8478],"source":" If `StartsWithUpper` is called as an extension method on a <xref:System.String> instance, it cannot be passed a `null` string."},{"content":"However, you can also call it directly as a static method and pass a single <ph id=\"ph1\">&lt;xref:System.String&gt;</ph> argument.","pos":[8479,8585],"source":" However, you can also call it directly as a static method and pass a single <xref:System.String> argument."},{"content":"You'll define three methods, each of which calls its <ph id=\"ph1\">&lt;xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert&gt;</ph> method repeatedly for each element in a string array.","pos":[8587,8752],"source":"You'll define three methods, each of which calls its <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert> method repeatedly for each element in a string array."},{"content":"Because the test method fails as soon as it encounters the first failure, you'll call a method overload that allows you to pass a string that indicates the string value used in the method call.","pos":[8753,8946]},{"content":"To create the test methods:","pos":[8948,8975]},{"pos":[8979,8996],"content":"<bpt id=\"p1\">[</bpt>C#<ept id=\"p1\">](#tab/csharp)</ept>","linkify":"[C#](#tab/csharp)","source":"[C#](#tab/csharp)"},{"pos":[9001,9077],"content":"In the <bpt id=\"p1\">*</bpt>UnitTest1.cs<ept id=\"p1\">*</ept> code window, replace the code with the following code:","source":"In the *UnitTest1.cs* code window, replace the code with the following code:"},{"pos":[9195,9538],"content":"Note that your test of uppercase characters in the <ph id=\"ph1\">`TestStartsWithUpper`</ph> method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the <ph id=\"ph2\">`TestDoesNotStartWithUpper`</ph> method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).","source":"Note that your test of uppercase characters in the `TestStartsWithUpper` method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the `TestDoesNotStartWithUpper` method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433)."},{"content":"On the menu bar, select <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Save UnitTest1.cs As<ept id=\"p2\">**</ept>.","pos":[9543,9603],"source":"On the menu bar, select **File** > **Save UnitTest1.cs As**."},{"content":"In the <bpt id=\"p1\">**</bpt>Save File As<ept id=\"p1\">**</ept> dialog, select the arrow beside the <bpt id=\"p2\">**</bpt>Save<ept id=\"p2\">**</ept> button, and select <bpt id=\"p3\">**</bpt>Save with Encoding<ept id=\"p3\">**</ept>.","pos":[9604,9715],"source":" In the **Save File As** dialog, select the arrow beside the **Save** button, and select **Save with Encoding**."},{"content":"Visual Studio Save File As dialog - C#","pos":[9722,9760]},{"pos":[9832,9855],"content":"<bpt id=\"p1\">[</bpt>Visual Basic<ept id=\"p1\">](#tab/vb)</ept>","linkify":"[Visual Basic](#tab/vb)","source":"[Visual Basic](#tab/vb)"},{"pos":[9860,9936],"content":"In the <bpt id=\"p1\">*</bpt>UnitTest1.vb<ept id=\"p1\">*</ept> code window, replace the code with the following code:","source":"In the *UnitTest1.vb* code window, replace the code with the following code:"},{"pos":[10048,10391],"content":"Note that your test of uppercase characters in the <ph id=\"ph1\">`TestStartsWithUpper`</ph> method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the <ph id=\"ph2\">`TestDoesNotStartWithUpper`</ph> method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).","source":"Note that your test of uppercase characters in the `TestStartsWithUpper` method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the `TestDoesNotStartWithUpper` method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433)."},{"content":"On the menu bar, select <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Save UnitTest1.vb As<ept id=\"p2\">**</ept>.","pos":[10396,10456],"source":"On the menu bar, select **File** > **Save UnitTest1.vb As**."},{"content":"In the <bpt id=\"p1\">**</bpt>Save File As<ept id=\"p1\">**</ept> dialog, select the arrow beside the <bpt id=\"p2\">**</bpt>Save<ept id=\"p2\">**</ept> button, and select <bpt id=\"p3\">**</bpt>Save with Encoding<ept id=\"p3\">**</ept>.","pos":[10457,10568],"source":" In the **Save File As** dialog, select the arrow beside the **Save** button, and select **Save with Encoding**."},{"content":"Visual Studio Save File As dialog - Visual Basic","pos":[10575,10623]},{"pos":[10701,10779],"content":"In the <bpt id=\"p1\">**</bpt>Confirm Save As<ept id=\"p1\">**</ept> dialog, select the <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept> button to save the file.","source":"In the **Confirm Save As** dialog, select the **Yes** button to save the file."},{"pos":[10784,10939],"content":"In the <bpt id=\"p1\">**</bpt>Advanced Save Options<ept id=\"p1\">**</ept> dialog, select <bpt id=\"p2\">**</bpt>Unicode (UTF-8 with signature) - Codepage 65001<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Encoding<ept id=\"p3\">**</ept> drop-down list and select <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept>.","source":"In the **Advanced Save Options** dialog, select **Unicode (UTF-8 with signature) - Codepage 65001** from the **Encoding** drop-down list and select **OK**."},{"content":"Visual Studio Advanced Save Options dialog","pos":[10946,10988]},{"content":"If you fail to save your source code as a UTF8-encoded file, Visual Studio may save it as an ASCII file.","pos":[11064,11168]},{"content":"When that happens, the runtime doesn't accurately decode the UTF8 characters outside of the ASCII range, and the test results won't be accurate.","pos":[11169,11313]},{"content":"On the menu bar, select <bpt id=\"p1\">**</bpt>Test<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p3\">**</bpt>All Tests<ept id=\"p3\">**</ept>.","pos":[11318,11377],"source":"On the menu bar, select **Test** > **Run** > **All Tests**."},{"content":"The <bpt id=\"p1\">**</bpt>Test Explorer<ept id=\"p1\">**</ept> window opens and shows that the tests ran successfully.","pos":[11378,11455],"source":" The **Test Explorer** window opens and shows that the tests ran successfully."},{"content":"The three tests are listed in the <bpt id=\"p1\">**</bpt>Passed Tests<ept id=\"p1\">**</ept> section, and the <bpt id=\"p2\">**</bpt>Summary<ept id=\"p2\">**</ept> section reports the result of the test run.","pos":[11456,11579],"source":" The three tests are listed in the **Passed Tests** section, and the **Summary** section reports the result of the test run."},{"content":"Test Explorer window with passing tests","pos":[11586,11625]},{"pos":[11700,11722],"content":"Handling test failures","linkify":"Handling test failures","nodes":[{"content":"Handling test failures","pos":[0,22]}]},{"content":"Your test run had no failures, but change it slightly so that one of the test methods fails:","pos":[11724,11816]},{"content":"Modify the <ph id=\"ph1\">`words`</ph> array in the <ph id=\"ph2\">`TestDoesNotStartWithUpper`</ph> method to include the string \"Error\".","pos":[11821,11918],"source":"Modify the `words` array in the `TestDoesNotStartWithUpper` method to include the string \"Error\"."},{"content":"You don't need to save the file because Visual Studio automatically saves open files when a solution is built to run tests.","pos":[11919,12042]},{"content":"Run the test by selecting <bpt id=\"p1\">**</bpt>Test<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p3\">**</bpt>All Tests<ept id=\"p3\">**</ept> from the menu bar.","pos":[12380,12459],"source":"Run the test by selecting **Test** > **Run** > **All Tests** from the menu bar."},{"content":"The <bpt id=\"p1\">**</bpt>Test Explorer<ept id=\"p1\">**</ept> window indicates that two tests succeeded and one failed.","pos":[12460,12539],"source":" The **Test Explorer** window indicates that two tests succeeded and one failed."},{"content":"Test Explorer window with failing tests","pos":[12546,12585]},{"content":"In the <bpt id=\"p1\">**</bpt>Failed Tests<ept id=\"p1\">**</ept> section, select the failed test, <ph id=\"ph1\">`TestDoesNotStartWith`</ph>.","pos":[12658,12738],"source":"In the **Failed Tests** section, select the failed test, `TestDoesNotStartWith`."},{"content":"The <bpt id=\"p1\">**</bpt>Test Explorer<ept id=\"p1\">**</ept> window displays the message produced by the assert: \"Assert.IsFalse failed.","pos":[12739,12836],"source":" The **Test Explorer** window displays the message produced by the assert: \"Assert.IsFalse failed."},{"content":"Expected for 'Error': false; actual: True\".","pos":[12837,12880]},{"content":"Because of the failure, all strings in the array after \"Error\" were not tested.","pos":[12881,12960]},{"content":"Test Explorer window showing the Is False assertion failure","pos":[12967,13026]},{"content":"Undo the modification you did in step 1 and remove the string \"Error\".","pos":[13099,13169]},{"content":"Rerun the test and the tests will pass.","pos":[13170,13209]},{"pos":[13214,13256],"content":"Testing the Release version of the library","linkify":"Testing the Release version of the library","nodes":[{"content":"Testing the Release version of the library","pos":[0,42]}]},{"content":"You've been running your tests against the Debug version of the library.","pos":[13258,13330]},{"content":"Now that your tests have all passed and you've adequately tested your library, you should run the tests an additional time against the Release build of the library.","pos":[13331,13495]},{"content":"A number of factors, including compiler optimizations, can sometimes produce different behavior between Debug and Release builds.","pos":[13496,13625]},{"content":"To test the Release build:","pos":[13627,13653]},{"pos":[13658,13749],"content":"In the Visual Studio toolbar, change the build configuration from <bpt id=\"p1\">**</bpt>Debug<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>Release<ept id=\"p2\">**</ept>.","source":"In the Visual Studio toolbar, change the build configuration from **Debug** to **Release**."},{"content":"Visual Studio toolbar with release build highlighted","pos":[13756,13808]},{"pos":[13892,14028],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the <bpt id=\"p2\">**</bpt>StringLibrary<ept id=\"p2\">**</ept> project and select <bpt id=\"p3\">**</bpt>Build<ept id=\"p3\">**</ept> from the context menu to recompile the library.","source":"In **Solution Explorer**, right-click the **StringLibrary** project and select **Build** from the context menu to recompile the library."},{"content":"StringLibrary context menu with build command","pos":[14035,14080]},{"content":"Run the unit tests by choosing <bpt id=\"p1\">**</bpt>Test<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p3\">**</bpt>All Tests<ept id=\"p3\">**</ept> from the menu bar.","pos":[14161,14245],"source":"Run the unit tests by choosing **Test** > **Run** > **All Tests** from the menu bar."},{"content":"The tests pass.","pos":[14246,14261]},{"content":"Now that you've finished testing your library, the next step is to make it available to callers.","pos":[14263,14359]},{"content":"You can bundle it with one or more applications, or you can distribute it as a NuGet package.","pos":[14360,14453]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Consuming a .NET Standard Class Library<ept id=\"p1\">](./consuming-library-with-visual-studio.md)</ept>.","pos":[14454,14565],"source":" For more information, see [Consuming a .NET Standard Class Library](./consuming-library-with-visual-studio.md)."}]}