{"content":"---\ntitle: \"Link Demands\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"security [.NET Framework], demands\"\n  - \"demanded permissions\"\n  - \"permissions [.NET Framework], demands\"\n  - \"granting permissions, demands\"\n  - \"code access security, demands\"\n  - \"user demands for permission\"\n  - \"caller security checks\"\n  - \"link demands\"\nms.assetid: a33fd5f9-2de9-4653-a4f0-d9df25082c4d\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Link Demands\n[!INCLUDE[net_security_note](../../../includes/net-security-note-md.md)]  \n  \n A link demand causes a security check during just-in-time compilation and checks only the immediate calling assembly of your code. Linking occurs when your code is bound to a type reference, including function pointer references and method calls. If the calling assembly does not have sufficient permission to link to your code, the link is not allowed and a runtime exception is thrown when the code is loaded and run. Link demands can be overridden in classes that inherit from your code.  \n  \n Note that a full stack walk is not performed with this type of demand and that your code is still susceptible to luring attacks. For example, if a method in assembly A is protected by a link demand, a direct caller in assembly B is evaluated based on the permissions of Assembly B.  However, the link demand will not evaluate a method in assembly C if it indirectly calls the method in assembly A using the method in assembly B. The link demand specifies only the permissions direct callers in the immediate calling assembly must have to link to your code. It does not specify the permissions all callers must have to run your code.  \n  \n The <xref:System.Security.CodeAccessPermission.Assert%2A>, <xref:System.Security.CodeAccessPermission.Deny%2A>, and <xref:System.Security.CodeAccessPermission.PermitOnly%2A> stack walk modifiers do not affect the evaluation of link demands.  Because link demands do not perform a stack walk, the stack walk modifiers have no effect on link demands.  \n  \n If a method protected by a link demand is accessed through [Reflection](../../../docs/framework/reflection-and-codedom/reflection.md), then a link demand checks the immediate caller of the code accessed through reflection. This is true both for method discovery and for method invocation performed using reflection. For example, suppose code uses reflection to return a <xref:System.Reflection.MethodInfo> object representing a method protected by a link demand and then passes that **MethodInfo** object to some other code that uses the object to invoke the original method. In this case the link demand check occurs twice: once for the code that returns the **MethodInfo** object and once for the code that invokes it.  \n  \n> [!NOTE]\n>  A link demand performed on a static class constructor does not protect the constructor because static constructors are called by the system, outside the application's code execution path. As a result, when a link demand is applied to an entire class, it cannot protect access to a static constructor, although it does protect the rest of the class.  \n  \n The following code fragment declaratively specifies that any code linking to the `ReadData` method must have the `CustomPermission` permission. This permission is a hypothetical custom permission and does not exist in the .NET Framework. The demand is made by passing a **SecurityAction.LinkDemand** flag to the `CustomPermissionAttribute`.  \n  \n```vb  \n<CustomPermissionAttribute(SecurityAction.LinkDemand)> _  \nPublic Shared Function ReadData() As String  \n    ' Access a custom resource.  \nEnd Function    \n```  \n  \n```csharp  \n[CustomPermissionAttribute(SecurityAction.LinkDemand)]  \npublic static string ReadData()  \n{  \n    // Access a custom resource.  \n}  \n```  \n  \n## See also\n\n- [Attributes](../../../docs/standard/attributes/index.md)\n- [Code Access Security](../../../docs/framework/misc/code-access-security.md)\n","nodes":[{"pos":[4,455],"embed":true,"restype":"x-metadata","content":"title: \"Link Demands\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"security [.NET Framework], demands\"\n  - \"demanded permissions\"\n  - \"permissions [.NET Framework], demands\"\n  - \"granting permissions, demands\"\n  - \"code access security, demands\"\n  - \"user demands for permission\"\n  - \"caller security checks\"\n  - \"link demands\"\nms.assetid: a33fd5f9-2de9-4653-a4f0-d9df25082c4d\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Link Demands","nodes":[{"pos":[0,12],"content":"Link Demands","nodes":[{"content":"Link Demands","pos":[0,12]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[462,474],"content":"Link Demands","linkify":"Link Demands","nodes":[{"content":"Link Demands","pos":[0,12]}]},{"content":"A link demand causes a security check during just-in-time compilation and checks only the immediate calling assembly of your code.","pos":[554,684]},{"content":"Linking occurs when your code is bound to a type reference, including function pointer references and method calls.","pos":[685,800]},{"content":"If the calling assembly does not have sufficient permission to link to your code, the link is not allowed and a runtime exception is thrown when the code is loaded and run.","pos":[801,973]},{"content":"Link demands can be overridden in classes that inherit from your code.","pos":[974,1044]},{"content":"Note that a full stack walk is not performed with this type of demand and that your code is still susceptible to luring attacks.","pos":[1051,1179]},{"content":"For example, if a method in assembly A is protected by a link demand, a direct caller in assembly B is evaluated based on the permissions of Assembly B.  However, the link demand will not evaluate a method in assembly C if it indirectly calls the method in assembly A using the method in assembly B. The link demand specifies only the permissions direct callers in the immediate calling assembly must have to link to your code.","pos":[1180,1607]},{"content":"It does not specify the permissions all callers must have to run your code.","pos":[1608,1683]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Security.CodeAccessPermission.Assert%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Security.CodeAccessPermission.Deny%2A&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Security.CodeAccessPermission.PermitOnly%2A&gt;</ph> stack walk modifiers do not affect the evaluation of link demands.","pos":[1690,1930],"source":"The <xref:System.Security.CodeAccessPermission.Assert%2A>, <xref:System.Security.CodeAccessPermission.Deny%2A>, and <xref:System.Security.CodeAccessPermission.PermitOnly%2A> stack walk modifiers do not affect the evaluation of link demands."},{"content":"Because link demands do not perform a stack walk, the stack walk modifiers have no effect on link demands.","pos":[1932,2038]},{"content":"If a method protected by a link demand is accessed through <bpt id=\"p1\">[</bpt>Reflection<ept id=\"p1\">](../../../docs/framework/reflection-and-codedom/reflection.md)</ept>, then a link demand checks the immediate caller of the code accessed through reflection.","pos":[2045,2267],"source":"If a method protected by a link demand is accessed through [Reflection](../../../docs/framework/reflection-and-codedom/reflection.md), then a link demand checks the immediate caller of the code accessed through reflection."},{"content":"This is true both for method discovery and for method invocation performed using reflection.","pos":[2268,2360]},{"content":"For example, suppose code uses reflection to return a <ph id=\"ph1\">&lt;xref:System.Reflection.MethodInfo&gt;</ph> object representing a method protected by a link demand and then passes that <bpt id=\"p1\">**</bpt>MethodInfo<ept id=\"p1\">**</ept> object to some other code that uses the object to invoke the original method.","pos":[2361,2620],"source":" For example, suppose code uses reflection to return a <xref:System.Reflection.MethodInfo> object representing a method protected by a link demand and then passes that **MethodInfo** object to some other code that uses the object to invoke the original method."},{"content":"In this case the link demand check occurs twice: once for the code that returns the <bpt id=\"p1\">**</bpt>MethodInfo<ept id=\"p1\">**</ept> object and once for the code that invokes it.","pos":[2621,2765],"source":" In this case the link demand check occurs twice: once for the code that returns the **MethodInfo** object and once for the code that invokes it."},{"pos":[2773,3132],"content":"[!NOTE]\n A link demand performed on a static class constructor does not protect the constructor because static constructors are called by the system, outside the application's code execution path. As a result, when a link demand is applied to an entire class, it cannot protect access to a static constructor, although it does protect the rest of the class.","leadings":["","> "],"nodes":[{"content":"A link demand performed on a static class constructor does not protect the constructor because static constructors are called by the system, outside the application's code execution path. As a result, when a link demand is applied to an entire class, it cannot protect access to a static constructor, although it does protect the rest of the class.","pos":[9,357],"nodes":[{"content":"A link demand performed on a static class constructor does not protect the constructor because static constructors are called by the system, outside the application's code execution path.","pos":[0,187]},{"content":"As a result, when a link demand is applied to an entire class, it cannot protect access to a static constructor, although it does protect the rest of the class.","pos":[188,348]}]}]},{"content":"The following code fragment declaratively specifies that any code linking to the <ph id=\"ph1\">`ReadData`</ph> method must have the <ph id=\"ph2\">`CustomPermission`</ph> permission.","pos":[3139,3282],"source":"The following code fragment declaratively specifies that any code linking to the `ReadData` method must have the `CustomPermission` permission."},{"content":"This permission is a hypothetical custom permission and does not exist in the .NET Framework.","pos":[3283,3376]},{"content":"The demand is made by passing a <bpt id=\"p1\">**</bpt>SecurityAction.LinkDemand<ept id=\"p1\">**</ept> flag to the <ph id=\"ph1\">`CustomPermissionAttribute`</ph>.","pos":[3377,3479],"source":" The demand is made by passing a **SecurityAction.LinkDemand** flag to the `CustomPermissionAttribute`."},{"pos":[3816,3824],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3828,3884],"content":"<bpt id=\"p1\">[</bpt>Attributes<ept id=\"p1\">](../../../docs/standard/attributes/index.md)</ept>","source":"[Attributes](../../../docs/standard/attributes/index.md)"},{"pos":[3887,3963],"content":"<bpt id=\"p1\">[</bpt>Code Access Security<ept id=\"p1\">](../../../docs/framework/misc/code-access-security.md)</ept>","source":"[Code Access Security](../../../docs/framework/misc/code-access-security.md)"}]}