{"content":"---\ntitle: \"Connection String Syntax\"\nms.date: \"05/22/2018\"\nms.assetid: 0977aeee-04d1-4cce-bbed-750c77fce06e\n---\n# Connection String Syntax\nEach .NET Framework data provider has a `Connection` object that inherits from <xref:System.Data.Common.DbConnection> as well as a provider-specific <xref:System.Data.Common.DbConnection.ConnectionString%2A> property. The specific connection string syntax for each provider is documented in its `ConnectionString` property. The following table lists the four data providers that are included in the .NET Framework.  \n  \n|.NET Framework data provider|Description|  \n|----------------------------------|-----------------|  \n|<xref:System.Data.SqlClient>|Provides data access for Microsoft SQL Server. For more information on connection string syntax, see <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A>.|  \n|<xref:System.Data.OleDb>|Provides data access for data sources exposed using OLE DB. For more information on connection string syntax, see <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A>.|  \n|<xref:System.Data.Odbc>|Provides data access for data sources exposed using ODBC. For more information on connection string syntax, see <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A>.|  \n|<xref:System.Data.OracleClient>|Provides data access for Oracle version 8.1.7 or later. For more information on connection string syntax, see <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>.|  \n  \n## Connection String Builders  \n ADO.NET 2.0 introduced the following connection string builders for the .NET Framework data providers.  \n  \n-   <xref:System.Data.SqlClient.SqlConnectionStringBuilder>  \n  \n-   <xref:System.Data.OleDb.OleDbConnectionStringBuilder>  \n  \n-   <xref:System.Data.Odbc.OdbcConnectionStringBuilder>  \n  \n-   <xref:System.Data.OracleClient.OracleConnectionStringBuilder>  \n  \n The connection string builders allow you to construct syntactically valid connection strings at run time, so you do not have to manually concatenate connection string values in your code. For more information, see [Connection String Builders](../../../../docs/framework/data/adonet/connection-string-builders.md).  \n\n## Windows Authentication  \n We recommend using Windows Authentication (sometimes referred to as *integrated security*) to connect to data sources that support it. The syntax employed in the connection string varies by provider. The following table shows the Windows Authentication syntax used with the .NET Framework data providers.  \n  \n|Provider|Syntax|  \n|--------------|------------|  \n|`SqlClient`|`Integrated Security=true;`<br /><br /> `-- or --`<br /><br /> `Integrated Security=SSPI;`|  \n|`OleDb`|`Integrated Security=SSPI;`|  \n|`Odbc`|`Trusted_Connection=yes;`|  \n|`OracleClient`|`Integrated Security=yes;`|  \n  \n> [!NOTE]\n>  `Integrated Security=true` throws an exception when used with the `OleDb` provider.  \n  \n## SqlClient Connection Strings  \nThe syntax for a <xref:System.Data.SqlClient.SqlConnection> connection string is documented in the <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> property. You can use the <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> property to get or set a connection string for a SQL Server database. If you need to connect to an earlier version of SQL Server, you must use the .NET Framework Data Provider for OleDb (<xref:System.Data.OleDb>). Most connection string keywords also map to properties in the <xref:System.Data.SqlClient.SqlConnectionStringBuilder>.  \n\n> [!IMPORTANT]\n>  The default setting for the `Persist Security Info` keyword is `false`. Setting it to `true` or `yes` allows security-sensitive information, including the user ID and password, to be obtained from the connection after the connection has been opened. Keep `Persist Security Info` set to `false` to ensure that an untrusted source does not have access to sensitive connection string information.  \n\n### Windows authentication with SqlClient \n Each of the following forms of syntax uses Windows Authentication to connect to the **AdventureWorks** database on a local server.  \n  \n```  \n\"Persist Security Info=False;Integrated Security=true;  \n    Initial Catalog=AdventureWorks;Server=MSSQL1\"  \n\"Persist Security Info=False;Integrated Security=SSPI;  \n    database=AdventureWorks;server=(local)\"  \n\"Persist Security Info=False;Trusted_Connection=True;  \n    database=AdventureWorks;server=(local)\"  \n```  \n  \n### SQL Server authentication with SqlClient   \n Windows Authentication is preferred for connecting to SQL Server. However, if SQL Server Authentication is required, use the following syntax to specify a user name and password. In this example, asterisks are used to represent a valid user name and password.  \n  \n```  \n\"Persist Security Info=False;User ID=*****;Password=*****;Initial Catalog=AdventureWorks;Server=MySqlServer\"  \n```  \n\nWhen you connect to Azure SQL Database or to Azure SQL Data Warehouse and provide a login in the format `user@servername`, make sure that the `servername` value in the login matches the value provided for `Server=`.\n\n> [!NOTE]\n>  Windows authentication takes precedence over SQL Server logins. If you specify both Integrated Security=true as well as a user name and password, the user name and password will be ignored and Windows authentication will be used.  \n\n### Connect to a named instance of SQL Server\nTo connect to a named instance of SQL Server, use the *server name\\instance name* syntax.  \n  \n```  \nData Source=MySqlServer\\MSSQL1;\"  \n```  \n \nYou can also set the <xref:System.Data.SqlClient.SqlConnectionStringBuilder.DataSource%2A> property of the `SqlConnectionStringBuilder` to the instance name when building a connection string. The <xref:System.Data.SqlClient.SqlConnection.DataSource%2A> property of a <xref:System.Data.SqlClient.SqlConnection> object is read-only.  \n  \n### Type System Version Changes  \n The `Type System Version` keyword in a <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> specifies the client-side representation of SQL Server types. See <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> for more information about the `Type System Version` keyword.  \n  \n## Connecting and Attaching to SQL Server Express User Instances  \n User instances are a feature in SQL Server Express. They allow a user running on a least-privileged local Windows account to attach and run a SQL Server database without requiring administrative privileges. A user instance executes with the user's Windows credentials, not as a service.  \n  \n For more information on working with user instances, see [SQL Server Express User Instances](../../../../docs/framework/data/adonet/sql/sql-server-express-user-instances.md).  \n  \n## Using TrustServerCertificate  \n The `TrustServerCertificate` keyword is valid only when connecting to a SQL Server instance with a valid certificate. When `TrustServerCertificate` is set to `true`, the transport layer will use SSL to encrypt the channel and bypass walking the certificate chain to validate trust.  \n  \n```  \n\"TrustServerCertificate=true;\"   \n```  \n  \n> [!NOTE]\n>  If `TrustServerCertificate` is set to `true` and encryption is turned on, the encryption level specified on the server will be used even if `Encrypt` is set to `false` in the connection string. The connection will fail otherwise.  \n  \n### Enabling Encryption  \n To enable encryption when a certificate has not been provisioned on the server, the **Force Protocol Encryption** and the **Trust Server Certificate** options must be set in SQL Server Configuration Manager. In this case, encryption will use a self-signed server certificate without validation if no verifiable certificate has been provisioned on the server.  \n  \n Application settings cannot reduce the level of security configured in SQL Server, but can optionally strengthen it. An application can request encryption by setting the `TrustServerCertificate` and `Encrypt` keywords to `true`, guaranteeing that encryption takes place even when a server certificate has not been provisioned and **Force Protocol Encryption** has not been configured for the client. However, if `TrustServerCertificate` is not enabled in the client configuration, a provisioned server certificate is still required.  \n  \n The following table describes all cases.  \n  \n|Force Protocol Encryption client setting|Trust Server Certificate client setting|Encrypt/Use Encryption for Data connection string/attribute|Trust Server Certificate connection string/attribute|Result|  \n|----------------------------------------------|---------------------------------------------|-------------------------------------------------------------------|-----------------------------------------------------------|------------|  \n|No|N/A|No (default)|Ignored|No encryption occurs.|  \n|No|N/A|Yes|No (default)|Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.|  \n|No|N/A|Yes|Yes|Encryption always occurs, but may use a self-signed server certificate.|  \n|Yes|No|Ignored|Ignored|Encryption occurs only if there is a verifiable server certificate; otherwise, the connection attempt fails.|  \n|Yes|Yes|No (default)|Ignored|Encryption always occurs, but may use a self-signed server certificate.|  \n|Yes|Yes|Yes|No (default)|Encryption occurs only if there is a verifiable server certificate; otherwise, the connection attempt fails.|  \n|Yes|Yes|Yes|Yes|Encryption always occurs, but may use a self-signed server certificate.|  \n  \n For more information, see [Using Encryption Without Validation](/sql/relational-databases/native-client/features/using-encryption-without-validation).\n  \n## OleDb Connection Strings  \n The <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A> property of a <xref:System.Data.OleDb.OleDbConnection> allows you to get or set a connection string for an OLE DB data source, such as Microsoft Access. You can also create an `OleDb` connection string at run time by using the <xref:System.Data.OleDb.OleDbConnectionStringBuilder> class.  \n  \n### OleDb Connection String Syntax  \n You must specify a provider name for an <xref:System.Data.OleDb.OleDbConnection> connection string. The following connection string connects to a Microsoft Access database using the Jet provider. Note that the `User ID` and `Password` keywords are optional if the database is unsecured (the default).  \n  \n```   \nProvider=Microsoft.Jet.OLEDB.4.0; Data Source=d:\\Northwind.mdb;User ID=Admin;Password=;   \n```  \n  \n If the Jet database is secured using user-level security, you must provide the location of the workgroup information file (.mdw). The workgroup information file is used to validate the credentials presented in the connection string.  \n  \n```  \nProvider=Microsoft.Jet.OLEDB.4.0;Data Source=d:\\Northwind.mdb;Jet OLEDB:System Database=d:\\NorthwindSystem.mdw;User ID=*****;Password=*****;  \n```  \n  \n> [!IMPORTANT]\n>  It is possible to supply connection information for an **OleDbConnection** in a Universal Data Link (UDL) file; however you should avoid doing so. UDL files are not encrypted, and expose connection string information in clear text. Because a UDL file is an external file-based resource to your application, it cannot be secured using the .NET Framework. UDL files are not supported for **SqlClient**.  \n  \n### Using DataDirectory to Connect to Access/Jet  \n `DataDirectory` is not exclusive to `SqlClient`. It can also be used with the <xref:System.Data.OleDb> and <xref:System.Data.Odbc> .NET data providers. The following sample <xref:System.Data.OleDb.OleDbConnection> string demonstrates the syntax required to connect to the Northwind.mdb located in the application's app_data folder. The system database (System.mdw) is also stored in that location.  \n  \n```  \n\"Provider=Microsoft.Jet.OLEDB.4.0;  \nData Source=|DataDirectory|\\Northwind.mdb;  \nJet OLEDB:System Database=|DataDirectory|\\System.mdw;\"  \n```  \n  \n> [!IMPORTANT]\n>  Specifying the location of the system database in the connection string is not required if the Access/Jet database is unsecured. Security is off by default, with all users connecting as the built-in Admin user with a blank password. Even when user-level security is correctly implemented, a Jet database remains vulnerable to attack. Therefore, storing sensitive information in an Access/Jet database is not recommended because of the inherent weakness of its file-based security scheme.  \n  \n### Connecting to Excel  \n The Microsoft Jet provider is used to connect to an Excel workbook. In the following connection string, the `Extended Properties` keyword sets properties that are specific to Excel. \"HDR=Yes;\" indicates that the first row contains column names, not data, and \"IMEX=1;\" tells the driver to always read \"intermixed\" data columns as text.  \n  \n```  \nProvider=Microsoft.Jet.OLEDB.4.0;Data Source=D:\\MyExcel.xls;Extended Properties=\"\"Excel 8.0;HDR=Yes;IMEX=1\"\"  \n```  \n  \n Note that the double quotation character required for the `Extended Properties` must also be enclosed in double quotation marks.  \n  \n### Data Shape Provider Connection String Syntax  \n Use both the `Provider` and the `Data Provider` keywords when using the Microsoft Data Shape provider. The following example uses the Shape provider to connect to a local instance of SQL Server.  \n  \n```  \n\"Provider=MSDataShape;Data Provider=SQLOLEDB;Data Source=(local);Initial Catalog=pubs;Integrated Security=SSPI;\"   \n```  \n  \n## Odbc Connection Strings  \n The <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A> property of a <xref:System.Data.Odbc.OdbcConnection> allows you to get or set a connection string for an OLE DB data source. Odbc connection strings are also supported by the <xref:System.Data.Odbc.OdbcConnectionStringBuilder>.  \n  \n The following connection string uses the Microsoft Text Driver.  \n  \n```  \nDriver={Microsoft Text Driver (*.txt; *.csv)};DBQ=d:\\bin  \n```  \n  \n### Using DataDirectory to Connect to Visual FoxPro  \n The following <xref:System.Data.Odbc.OdbcConnection> connection string sample demonstrates using `DataDirectory` to connect to a Microsoft Visual FoxPro file.  \n  \n```  \n\"Driver={Microsoft Visual FoxPro Driver};  \nSourceDB=|DataDirectory|\\MyData.DBC;SourceType=DBC;\"  \n```  \n  \n## Oracle Connection Strings  \n The <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> property of a <xref:System.Data.OracleClient.OracleConnection> allows you to get or set a connection string for an OLE DB data source. Oracle connection strings are also supported by the <xref:System.Data.OracleClient.OracleConnectionStringBuilder> .  \n  \n```  \nData Source=Oracle9i;User ID=*****;Password=*****;  \n```  \n  \n For more information on ODBC connection string syntax, see <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>.  \n  \n## See also\n\n- [Connection Strings](../../../../docs/framework/data/adonet/connection-strings.md)\n- [Connecting to a Data Source](../../../../docs/framework/data/adonet/connecting-to-a-data-source.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,108],"embed":true,"restype":"x-metadata","content":"title: \"Connection String Syntax\"\nms.date: \"05/22/2018\"\nms.assetid: 0977aeee-04d1-4cce-bbed-750c77fce06e","nodes":[{"content":"Connection String Syntax","nodes":[{"pos":[0,24],"content":"Connection String Syntax","nodes":[{"content":"Connection String Syntax","pos":[0,24]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[115,139],"content":"Connection String Syntax","linkify":"Connection String Syntax","nodes":[{"content":"Connection String Syntax","pos":[0,24]}]},{"content":"Each .NET Framework data provider has a <ph id=\"ph1\">`Connection`</ph> object that inherits from <ph id=\"ph2\">&lt;xref:System.Data.Common.DbConnection&gt;</ph> as well as a provider-specific <ph id=\"ph3\">&lt;xref:System.Data.Common.DbConnection.ConnectionString%2A&gt;</ph> property.","pos":[140,357],"source":"Each .NET Framework data provider has a `Connection` object that inherits from <xref:System.Data.Common.DbConnection> as well as a provider-specific <xref:System.Data.Common.DbConnection.ConnectionString%2A> property."},{"content":"The specific connection string syntax for each provider is documented in its <ph id=\"ph1\">`ConnectionString`</ph> property.","pos":[358,463],"source":" The specific connection string syntax for each provider is documented in its `ConnectionString` property."},{"content":"The following table lists the four data providers that are included in the .NET Framework.","pos":[464,554]},{"content":".NET Framework data provider","pos":[561,589]},{"content":"Description","pos":[590,601]},{"content":"Provides data access for Microsoft SQL Server.","pos":[692,738]},{"content":"For more information on connection string syntax, see <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A&gt;</ph>.","pos":[739,856],"source":" For more information on connection string syntax, see <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A>."},{"content":"Provides data access for data sources exposed using OLE DB.","pos":[886,945]},{"content":"For more information on connection string syntax, see <ph id=\"ph1\">&lt;xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A&gt;</ph>.","pos":[946,1061],"source":" For more information on connection string syntax, see <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A>."},{"content":"Provides data access for data sources exposed using ODBC.","pos":[1090,1147]},{"content":"For more information on connection string syntax, see <ph id=\"ph1\">&lt;xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A&gt;</ph>.","pos":[1148,1261],"source":" For more information on connection string syntax, see <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A>."},{"content":"Provides data access for Oracle version 8.1.7 or later.","pos":[1298,1353]},{"content":"For more information on connection string syntax, see <ph id=\"ph1\">&lt;xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A&gt;</ph>.","pos":[1354,1477],"source":" For more information on connection string syntax, see <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>."},{"pos":[1487,1513],"content":"Connection String Builders","linkify":"Connection String Builders","nodes":[{"content":"Connection String Builders","pos":[0,26]}]},{"content":"ADO.NET 2.0 introduced the following connection string builders for the .NET Framework data providers.","pos":[1517,1619]},{"content":"The connection string builders allow you to construct syntactically valid connection strings at run time, so you do not have to manually concatenate connection string values in your code.","pos":[1886,2073]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Connection String Builders<ept id=\"p1\">](../../../../docs/framework/data/adonet/connection-string-builders.md)</ept>.","pos":[2074,2199],"source":" For more information, see [Connection String Builders](../../../../docs/framework/data/adonet/connection-string-builders.md)."},{"pos":[2206,2228],"content":"Windows Authentication","linkify":"Windows Authentication","nodes":[{"content":"Windows Authentication","pos":[0,22]}]},{"content":"We recommend using Windows Authentication (sometimes referred to as <bpt id=\"p1\">*</bpt>integrated security<ept id=\"p1\">*</ept>) to connect to data sources that support it.","pos":[2232,2366],"source":"We recommend using Windows Authentication (sometimes referred to as *integrated security*) to connect to data sources that support it."},{"content":"The syntax employed in the connection string varies by provider.","pos":[2367,2431]},{"content":"The following table shows the Windows Authentication syntax used with the .NET Framework data providers.","pos":[2432,2536]},{"content":"Provider","pos":[2543,2551]},{"content":"Syntax","pos":[2552,2558]},{"pos":[2829,2923],"content":"[!NOTE]\n `Integrated Security=true` throws an exception when used with the `OleDb` provider.","leadings":["","> "],"nodes":[{"content":"<ph id=\"ph1\">`Integrated Security=true`</ph> throws an exception when used with the <ph id=\"ph2\">`OleDb`</ph> provider.","pos":[9,92],"source":"`Integrated Security=true` throws an exception when used with the `OleDb` provider."}]},{"pos":[2932,2960],"content":"SqlClient Connection Strings","linkify":"SqlClient Connection Strings","nodes":[{"content":"SqlClient Connection Strings","pos":[0,28]}]},{"content":"The syntax for a <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlConnection&gt;</ph> connection string is documented in the <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType&gt;</ph> property.","pos":[2963,3163],"source":"The syntax for a <xref:System.Data.SqlClient.SqlConnection> connection string is documented in the <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> property."},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A&gt;</ph> property to get or set a connection string for a SQL Server database.","pos":[3164,3312],"source":" You can use the <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> property to get or set a connection string for a SQL Server database."},{"content":"If you need to connect to an earlier version of SQL Server, you must use the .NET Framework Data Provider for OleDb (<ph id=\"ph1\">&lt;xref:System.Data.OleDb&gt;</ph>).","pos":[3313,3456],"source":" If you need to connect to an earlier version of SQL Server, you must use the .NET Framework Data Provider for OleDb (<xref:System.Data.OleDb>)."},{"content":"Most connection string keywords also map to properties in the <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlConnectionStringBuilder&gt;</ph>.","pos":[3457,3575],"source":" Most connection string keywords also map to properties in the <xref:System.Data.SqlClient.SqlConnectionStringBuilder>."},{"pos":[3581,3990],"content":"[!IMPORTANT]\n The default setting for the `Persist Security Info` keyword is `false`. Setting it to `true` or `yes` allows security-sensitive information, including the user ID and password, to be obtained from the connection after the connection has been opened. Keep `Persist Security Info` set to `false` to ensure that an untrusted source does not have access to sensitive connection string information.","leadings":["","> "],"nodes":[{"content":"The default setting for the `Persist Security Info` keyword is `false`. Setting it to `true` or `yes` allows security-sensitive information, including the user ID and password, to be obtained from the connection after the connection has been opened. Keep `Persist Security Info` set to `false` to ensure that an untrusted source does not have access to sensitive connection string information.","pos":[14,407],"nodes":[{"content":"The default setting for the <ph id=\"ph1\">`Persist Security Info`</ph> keyword is <ph id=\"ph2\">`false`</ph>.","pos":[0,71],"source":"The default setting for the `Persist Security Info` keyword is `false`."},{"content":"Setting it to <ph id=\"ph1\">`true`</ph> or <ph id=\"ph2\">`yes`</ph> allows security-sensitive information, including the user ID and password, to be obtained from the connection after the connection has been opened.","pos":[72,249],"source":" Setting it to `true` or `yes` allows security-sensitive information, including the user ID and password, to be obtained from the connection after the connection has been opened."},{"content":"Keep <ph id=\"ph1\">`Persist Security Info`</ph> set to <ph id=\"ph2\">`false`</ph> to ensure that an untrusted source does not have access to sensitive connection string information.","pos":[250,393],"source":" Keep `Persist Security Info` set to `false` to ensure that an untrusted source does not have access to sensitive connection string information."}]}]},{"pos":[3998,4035],"content":"Windows authentication with SqlClient","linkify":"Windows authentication with SqlClient","nodes":[{"content":"Windows authentication with SqlClient","pos":[0,37]}]},{"pos":[4038,4168],"content":"Each of the following forms of syntax uses Windows Authentication to connect to the <bpt id=\"p1\">**</bpt>AdventureWorks<ept id=\"p1\">**</ept> database on a local server.","source":"Each of the following forms of syntax uses Windows Authentication to connect to the **AdventureWorks** database on a local server."},{"pos":[4507,4547],"content":"SQL Server authentication with SqlClient","linkify":"SQL Server authentication with SqlClient","nodes":[{"content":"SQL Server authentication with SqlClient","pos":[0,40]}]},{"content":"Windows Authentication is preferred for connecting to SQL Server.","pos":[4552,4617]},{"content":"However, if SQL Server Authentication is required, use the following syntax to specify a user name and password.","pos":[4618,4730]},{"content":"In this example, asterisks are used to represent a valid user name and password.","pos":[4731,4811]},{"pos":[4941,5156],"content":"When you connect to Azure SQL Database or to Azure SQL Data Warehouse and provide a login in the format <ph id=\"ph1\">`user@servername`</ph>, make sure that the <ph id=\"ph2\">`servername`</ph> value in the login matches the value provided for <ph id=\"ph3\">`Server=`</ph>.","source":"When you connect to Azure SQL Database or to Azure SQL Data Warehouse and provide a login in the format `user@servername`, make sure that the `servername` value in the login matches the value provided for `Server=`."},{"pos":[5160,5400],"content":"[!NOTE]\n Windows authentication takes precedence over SQL Server logins. If you specify both Integrated Security=true as well as a user name and password, the user name and password will be ignored and Windows authentication will be used.","leadings":["","> "],"nodes":[{"content":"Windows authentication takes precedence over SQL Server logins. If you specify both Integrated Security=true as well as a user name and password, the user name and password will be ignored and Windows authentication will be used.","pos":[9,238],"nodes":[{"content":"Windows authentication takes precedence over SQL Server logins.","pos":[0,63]},{"content":"If you specify both Integrated Security=true as well as a user name and password, the user name and password will be ignored and Windows authentication will be used.","pos":[64,229]}]}]},{"pos":[5408,5449],"content":"Connect to a named instance of SQL Server","linkify":"Connect to a named instance of SQL Server","nodes":[{"content":"Connect to a named instance of SQL Server","pos":[0,41]}]},{"pos":[5450,5539],"content":"To connect to a named instance of SQL Server, use the <bpt id=\"p1\">*</bpt>server name\\instance name<ept id=\"p1\">*</ept> syntax.","source":"To connect to a named instance of SQL Server, use the *server name\\instance name* syntax."},{"content":"You can also set the <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlConnectionStringBuilder.DataSource%2A&gt;</ph> property of the <ph id=\"ph2\">`SqlConnectionStringBuilder`</ph> to the instance name when building a connection string.","pos":[5594,5785],"source":"You can also set the <xref:System.Data.SqlClient.SqlConnectionStringBuilder.DataSource%2A> property of the `SqlConnectionStringBuilder` to the instance name when building a connection string."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlConnection.DataSource%2A&gt;</ph> property of a <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlConnection&gt;</ph> object is read-only.","pos":[5786,5924],"source":" The <xref:System.Data.SqlClient.SqlConnection.DataSource%2A> property of a <xref:System.Data.SqlClient.SqlConnection> object is read-only."},{"pos":[5934,5961],"content":"Type System Version Changes","linkify":"Type System Version Changes","nodes":[{"content":"Type System Version Changes","pos":[0,27]}]},{"content":"The <ph id=\"ph1\">`Type System Version`</ph> keyword in a <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType&gt;</ph> specifies the client-side representation of SQL Server types.","pos":[5965,6157],"source":"The `Type System Version` keyword in a <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> specifies the client-side representation of SQL Server types."},{"content":"See <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType&gt;</ph> for more information about the <ph id=\"ph2\">`Type System Version`</ph> keyword.","pos":[6158,6315],"source":" See <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> for more information about the `Type System Version` keyword."},{"pos":[6324,6385],"content":"Connecting and Attaching to SQL Server Express User Instances","linkify":"Connecting and Attaching to SQL Server Express User Instances","nodes":[{"content":"Connecting and Attaching to SQL Server Express User Instances","pos":[0,61]}]},{"content":"User instances are a feature in SQL Server Express.","pos":[6389,6440]},{"content":"They allow a user running on a least-privileged local Windows account to attach and run a SQL Server database without requiring administrative privileges.","pos":[6441,6595]},{"content":"A user instance executes with the user's Windows credentials, not as a service.","pos":[6596,6675]},{"pos":[6682,6856],"content":"For more information on working with user instances, see <bpt id=\"p1\">[</bpt>SQL Server Express User Instances<ept id=\"p1\">](../../../../docs/framework/data/adonet/sql/sql-server-express-user-instances.md)</ept>.","source":"For more information on working with user instances, see [SQL Server Express User Instances](../../../../docs/framework/data/adonet/sql/sql-server-express-user-instances.md)."},{"pos":[6865,6893],"content":"Using TrustServerCertificate","linkify":"Using TrustServerCertificate","nodes":[{"content":"Using TrustServerCertificate","pos":[0,28]}]},{"content":"The <ph id=\"ph1\">`TrustServerCertificate`</ph> keyword is valid only when connecting to a SQL Server instance with a valid certificate.","pos":[6897,7014],"source":"The `TrustServerCertificate` keyword is valid only when connecting to a SQL Server instance with a valid certificate."},{"content":"When <ph id=\"ph1\">`TrustServerCertificate`</ph> is set to <ph id=\"ph2\">`true`</ph>, the transport layer will use SSL to encrypt the channel and bypass walking the certificate chain to validate trust.","pos":[7015,7178],"source":" When `TrustServerCertificate` is set to `true`, the transport layer will use SSL to encrypt the channel and bypass walking the certificate chain to validate trust."},{"pos":[7235,7475],"content":"[!NOTE]\n If `TrustServerCertificate` is set to `true` and encryption is turned on, the encryption level specified on the server will be used even if `Encrypt` is set to `false` in the connection string. The connection will fail otherwise.","leadings":["","> "],"nodes":[{"content":"If `TrustServerCertificate` is set to `true` and encryption is turned on, the encryption level specified on the server will be used even if `Encrypt` is set to `false` in the connection string. The connection will fail otherwise.","pos":[9,238],"nodes":[{"content":"If <ph id=\"ph1\">`TrustServerCertificate`</ph> is set to <ph id=\"ph2\">`true`</ph> and encryption is turned on, the encryption level specified on the server will be used even if <ph id=\"ph3\">`Encrypt`</ph> is set to <ph id=\"ph4\">`false`</ph> in the connection string.","pos":[0,193],"source":"If `TrustServerCertificate` is set to `true` and encryption is turned on, the encryption level specified on the server will be used even if `Encrypt` is set to `false` in the connection string."},{"content":"The connection will fail otherwise.","pos":[194,229]}]}]},{"pos":[7485,7504],"content":"Enabling Encryption","linkify":"Enabling Encryption","nodes":[{"content":"Enabling Encryption","pos":[0,19]}]},{"content":"To enable encryption when a certificate has not been provisioned on the server, the <bpt id=\"p1\">**</bpt>Force Protocol Encryption<ept id=\"p1\">**</ept> and the <bpt id=\"p2\">**</bpt>Trust Server Certificate<ept id=\"p2\">**</ept> options must be set in SQL Server Configuration Manager.","pos":[7508,7715],"source":"To enable encryption when a certificate has not been provisioned on the server, the **Force Protocol Encryption** and the **Trust Server Certificate** options must be set in SQL Server Configuration Manager."},{"content":"In this case, encryption will use a self-signed server certificate without validation if no verifiable certificate has been provisioned on the server.","pos":[7716,7866]},{"content":"Application settings cannot reduce the level of security configured in SQL Server, but can optionally strengthen it.","pos":[7873,7989]},{"content":"An application can request encryption by setting the <ph id=\"ph1\">`TrustServerCertificate`</ph> and <ph id=\"ph2\">`Encrypt`</ph> keywords to <ph id=\"ph3\">`true`</ph>, guaranteeing that encryption takes place even when a server certificate has not been provisioned and <bpt id=\"p1\">**</bpt>Force Protocol Encryption<ept id=\"p1\">**</ept> has not been configured for the client.","pos":[7990,8272],"source":" An application can request encryption by setting the `TrustServerCertificate` and `Encrypt` keywords to `true`, guaranteeing that encryption takes place even when a server certificate has not been provisioned and **Force Protocol Encryption** has not been configured for the client."},{"content":"However, if <ph id=\"ph1\">`TrustServerCertificate`</ph> is not enabled in the client configuration, a provisioned server certificate is still required.","pos":[8273,8405],"source":" However, if `TrustServerCertificate` is not enabled in the client configuration, a provisioned server certificate is still required."},{"content":"The following table describes all cases.","pos":[8412,8452]},{"content":"Force Protocol Encryption client setting","pos":[8459,8499]},{"content":"Trust Server Certificate client setting","pos":[8500,8539]},{"content":"Encrypt/Use Encryption for Data connection string/attribute","pos":[8540,8599]},{"content":"Trust Server Certificate connection string/attribute","pos":[8600,8652]},{"content":"Result","pos":[8653,8659]},{"content":"No","pos":[8902,8904]},{"content":"N/A","pos":[8905,8908]},{"content":"No (default)","pos":[8909,8921]},{"content":"Ignored","pos":[8922,8929]},{"content":"No encryption occurs.","pos":[8930,8951]},{"content":"No","pos":[8956,8958]},{"content":"N/A","pos":[8959,8962]},{"content":"Yes","pos":[8963,8966]},{"content":"No (default)","pos":[8967,8979]},{"content":"Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.","pos":[8980,9087]},{"content":"No","pos":[9092,9094]},{"content":"N/A","pos":[9095,9098]},{"content":"Yes","pos":[9099,9102]},{"content":"Yes","pos":[9103,9106]},{"content":"Encryption always occurs, but may use a self-signed server certificate.","pos":[9107,9178]},{"content":"Yes","pos":[9183,9186]},{"content":"No","pos":[9187,9189]},{"content":"Ignored","pos":[9190,9197]},{"content":"Ignored","pos":[9198,9205]},{"content":"Encryption occurs only if there is a verifiable server certificate; otherwise, the connection attempt fails.","pos":[9206,9314]},{"content":"Yes","pos":[9319,9322]},{"content":"Yes","pos":[9323,9326]},{"content":"No (default)","pos":[9327,9339]},{"content":"Ignored","pos":[9340,9347]},{"content":"Encryption always occurs, but may use a self-signed server certificate.","pos":[9348,9419]},{"content":"Yes","pos":[9424,9427]},{"content":"Yes","pos":[9428,9431]},{"content":"Yes","pos":[9432,9435]},{"content":"No (default)","pos":[9436,9448]},{"content":"Encryption occurs only if there is a verifiable server certificate; otherwise, the connection attempt fails.","pos":[9449,9557]},{"content":"Yes","pos":[9562,9565]},{"content":"Yes","pos":[9566,9569]},{"content":"Yes","pos":[9570,9573]},{"content":"Yes","pos":[9574,9577]},{"content":"Encryption always occurs, but may use a self-signed server certificate.","pos":[9578,9649]},{"pos":[9657,9807],"content":"For more information, see <bpt id=\"p1\">[</bpt>Using Encryption Without Validation<ept id=\"p1\">](/sql/relational-databases/native-client/features/using-encryption-without-validation)</ept>.","source":"For more information, see [Using Encryption Without Validation](/sql/relational-databases/native-client/features/using-encryption-without-validation)."},{"pos":[9814,9838],"content":"OleDb Connection Strings","linkify":"OleDb Connection Strings","nodes":[{"content":"OleDb Connection Strings","pos":[0,24]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A&gt;</ph> property of a <ph id=\"ph2\">&lt;xref:System.Data.OleDb.OleDbConnection&gt;</ph> allows you to get or set a connection string for an OLE DB data source, such as Microsoft Access.","pos":[9842,10059],"source":"The <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A> property of a <xref:System.Data.OleDb.OleDbConnection> allows you to get or set a connection string for an OLE DB data source, such as Microsoft Access."},{"content":"You can also create an <ph id=\"ph1\">`OleDb`</ph> connection string at run time by using the <ph id=\"ph2\">&lt;xref:System.Data.OleDb.OleDbConnectionStringBuilder&gt;</ph> class.","pos":[10060,10194],"source":" You can also create an `OleDb` connection string at run time by using the <xref:System.Data.OleDb.OleDbConnectionStringBuilder> class."},{"pos":[10204,10234],"content":"OleDb Connection String Syntax","linkify":"OleDb Connection String Syntax","nodes":[{"content":"OleDb Connection String Syntax","pos":[0,30]}]},{"content":"You must specify a provider name for an <ph id=\"ph1\">&lt;xref:System.Data.OleDb.OleDbConnection&gt;</ph> connection string.","pos":[10238,10337],"source":"You must specify a provider name for an <xref:System.Data.OleDb.OleDbConnection> connection string."},{"content":"The following connection string connects to a Microsoft Access database using the Jet provider.","pos":[10338,10433]},{"content":"Note that the <ph id=\"ph1\">`User ID`</ph> and <ph id=\"ph2\">`Password`</ph> keywords are optional if the database is unsecured (the default).","pos":[10434,10538],"source":" Note that the `User ID` and `Password` keywords are optional if the database is unsecured (the default)."},{"content":"If the Jet database is secured using user-level security, you must provide the location of the workgroup information file (.mdw).","pos":[10652,10781]},{"content":"The workgroup information file is used to validate the credentials presented in the connection string.","pos":[10782,10884]},{"pos":[11050,11466],"content":"[!IMPORTANT]\n It is possible to supply connection information for an **OleDbConnection** in a Universal Data Link (UDL) file; however you should avoid doing so. UDL files are not encrypted, and expose connection string information in clear text. Because a UDL file is an external file-based resource to your application, it cannot be secured using the .NET Framework. UDL files are not supported for **SqlClient**.","leadings":["","> "],"nodes":[{"content":"It is possible to supply connection information for an **OleDbConnection** in a Universal Data Link (UDL) file; however you should avoid doing so. UDL files are not encrypted, and expose connection string information in clear text. Because a UDL file is an external file-based resource to your application, it cannot be secured using the .NET Framework. UDL files are not supported for **SqlClient**.","pos":[14,414],"nodes":[{"content":"It is possible to supply connection information for an <bpt id=\"p1\">**</bpt>OleDbConnection<ept id=\"p1\">**</ept> in a Universal Data Link (UDL) file; however you should avoid doing so.","pos":[0,146],"source":"It is possible to supply connection information for an **OleDbConnection** in a Universal Data Link (UDL) file; however you should avoid doing so."},{"content":"UDL files are not encrypted, and expose connection string information in clear text.","pos":[147,231]},{"content":"Because a UDL file is an external file-based resource to your application, it cannot be secured using the .NET Framework.","pos":[232,353]},{"content":"UDL files are not supported for <bpt id=\"p1\">**</bpt>SqlClient<ept id=\"p1\">**</ept>.","pos":[354,400],"source":" UDL files are not supported for **SqlClient**."}]}]},{"pos":[11476,11520],"content":"Using DataDirectory to Connect to Access/Jet","linkify":"Using DataDirectory to Connect to Access/Jet","nodes":[{"content":"Using DataDirectory to Connect to Access/Jet","pos":[0,44]}]},{"content":"<ph id=\"ph1\">`DataDirectory`</ph> is not exclusive to <ph id=\"ph2\">`SqlClient`</ph>.","pos":[11524,11572],"source":"`DataDirectory` is not exclusive to `SqlClient`."},{"content":"It can also be used with the <ph id=\"ph1\">&lt;xref:System.Data.OleDb&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Data.Odbc&gt;</ph> .NET data providers.","pos":[11573,11675],"source":" It can also be used with the <xref:System.Data.OleDb> and <xref:System.Data.Odbc> .NET data providers."},{"content":"The following sample <ph id=\"ph1\">&lt;xref:System.Data.OleDb.OleDbConnection&gt;</ph> string demonstrates the syntax required to connect to the Northwind.mdb located in the application's app_data folder.","pos":[11676,11855],"source":" The following sample <xref:System.Data.OleDb.OleDbConnection> string demonstrates the syntax required to connect to the Northwind.mdb located in the application's app_data folder."},{"content":"The system database (System.mdw) is also stored in that location.","pos":[11856,11921]},{"pos":[12083,12586],"content":"[!IMPORTANT]\n Specifying the location of the system database in the connection string is not required if the Access/Jet database is unsecured. Security is off by default, with all users connecting as the built-in Admin user with a blank password. Even when user-level security is correctly implemented, a Jet database remains vulnerable to attack. Therefore, storing sensitive information in an Access/Jet database is not recommended because of the inherent weakness of its file-based security scheme.","leadings":["","> "],"nodes":[{"content":"Specifying the location of the system database in the connection string is not required if the Access/Jet database is unsecured. Security is off by default, with all users connecting as the built-in Admin user with a blank password. Even when user-level security is correctly implemented, a Jet database remains vulnerable to attack. Therefore, storing sensitive information in an Access/Jet database is not recommended because of the inherent weakness of its file-based security scheme.","pos":[14,501],"nodes":[{"content":"Specifying the location of the system database in the connection string is not required if the Access/Jet database is unsecured.","pos":[0,128]},{"content":"Security is off by default, with all users connecting as the built-in Admin user with a blank password.","pos":[129,232]},{"content":"Even when user-level security is correctly implemented, a Jet database remains vulnerable to attack.","pos":[233,333]},{"content":"Therefore, storing sensitive information in an Access/Jet database is not recommended because of the inherent weakness of its file-based security scheme.","pos":[334,487]}]}]},{"pos":[12596,12615],"content":"Connecting to Excel","linkify":"Connecting to Excel","nodes":[{"content":"Connecting to Excel","pos":[0,19]}]},{"content":"The Microsoft Jet provider is used to connect to an Excel workbook.","pos":[12619,12686]},{"content":"In the following connection string, the <ph id=\"ph1\">`Extended Properties`</ph> keyword sets properties that are specific to Excel.","pos":[12687,12800],"source":" In the following connection string, the `Extended Properties` keyword sets properties that are specific to Excel."},{"content":"\"HDR=Yes;\" indicates that the first row contains column names, not data, and \"IMEX=1;\" tells the driver to always read \"intermixed\" data columns as text.","pos":[12801,12954]},{"pos":[13087,13215],"content":"Note that the double quotation character required for the <ph id=\"ph1\">`Extended Properties`</ph> must also be enclosed in double quotation marks.","source":"Note that the double quotation character required for the `Extended Properties` must also be enclosed in double quotation marks."},{"pos":[13225,13269],"content":"Data Shape Provider Connection String Syntax","linkify":"Data Shape Provider Connection String Syntax","nodes":[{"content":"Data Shape Provider Connection String Syntax","pos":[0,44]}]},{"content":"Use both the <ph id=\"ph1\">`Provider`</ph> and the <ph id=\"ph2\">`Data Provider`</ph> keywords when using the Microsoft Data Shape provider.","pos":[13273,13375],"source":"Use both the `Provider` and the `Data Provider` keywords when using the Microsoft Data Shape provider."},{"content":"The following example uses the Shape provider to connect to a local instance of SQL Server.","pos":[13376,13467]},{"pos":[13607,13630],"content":"Odbc Connection Strings","linkify":"Odbc Connection Strings","nodes":[{"content":"Odbc Connection Strings","pos":[0,23]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A&gt;</ph> property of a <ph id=\"ph2\">&lt;xref:System.Data.Odbc.OdbcConnection&gt;</ph> allows you to get or set a connection string for an OLE DB data source.","pos":[13634,13821],"source":"The <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A> property of a <xref:System.Data.Odbc.OdbcConnection> allows you to get or set a connection string for an OLE DB data source."},{"content":"Odbc connection strings are also supported by the <ph id=\"ph1\">&lt;xref:System.Data.Odbc.OdbcConnectionStringBuilder&gt;</ph>.","pos":[13822,13924],"source":" Odbc connection strings are also supported by the <xref:System.Data.Odbc.OdbcConnectionStringBuilder>."},{"content":"The following connection string uses the Microsoft Text Driver.","pos":[13931,13994]},{"pos":[14078,14125],"content":"Using DataDirectory to Connect to Visual FoxPro","linkify":"Using DataDirectory to Connect to Visual FoxPro","nodes":[{"content":"Using DataDirectory to Connect to Visual FoxPro","pos":[0,47]}]},{"pos":[14129,14287],"content":"The following <ph id=\"ph1\">&lt;xref:System.Data.Odbc.OdbcConnection&gt;</ph> connection string sample demonstrates using <ph id=\"ph2\">`DataDirectory`</ph> to connect to a Microsoft Visual FoxPro file.","source":"The following <xref:System.Data.Odbc.OdbcConnection> connection string sample demonstrates using `DataDirectory` to connect to a Microsoft Visual FoxPro file."},{"pos":[14410,14435],"content":"Oracle Connection Strings","linkify":"Oracle Connection Strings","nodes":[{"content":"Oracle Connection Strings","pos":[0,25]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A&gt;</ph> property of a <ph id=\"ph2\">&lt;xref:System.Data.OracleClient.OracleConnection&gt;</ph> allows you to get or set a connection string for an OLE DB data source.","pos":[14439,14646],"source":"The <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> property of a <xref:System.Data.OracleClient.OracleConnection> allows you to get or set a connection string for an OLE DB data source."},{"content":"Oracle connection strings are also supported by the <ph id=\"ph1\">&lt;xref:System.Data.OracleClient.OracleConnectionStringBuilder&gt;</ph> .","pos":[14647,14762],"source":" Oracle connection strings are also supported by the <xref:System.Data.OracleClient.OracleConnectionStringBuilder> ."},{"pos":[14837,14965],"content":"For more information on ODBC connection string syntax, see <ph id=\"ph1\">&lt;xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A&gt;</ph>.","source":"For more information on ODBC connection string syntax, see <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>."},{"pos":[14974,14982],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[14986,15068],"content":"<bpt id=\"p1\">[</bpt>Connection Strings<ept id=\"p1\">](../../../../docs/framework/data/adonet/connection-strings.md)</ept>","source":"[Connection Strings](../../../../docs/framework/data/adonet/connection-strings.md)"},{"pos":[15071,15171],"content":"<bpt id=\"p1\">[</bpt>Connecting to a Data Source<ept id=\"p1\">](../../../../docs/framework/data/adonet/connecting-to-a-data-source.md)</ept>","source":"[Connecting to a Data Source](../../../../docs/framework/data/adonet/connecting-to-a-data-source.md)"},{"pos":[15174,15278],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}