{"content":"---\ntitle: \"How to: Return a LINQ Query Result as a Specific Type (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"queries [LINQ in Visual Basic], specific type returned\"\n  - \"projection [LINQ in Visual Basic]\"\n  - \"anonymous types [Visual Basic]\"\n  - \"querying databases [LINQ]\"\n  - \"queries [LINQ in Visual Basic], how-to topics\"\n  - \"query samples [Visual Basic]\"\nms.assetid: 621bb10a-e5d7-44fb-a025-317964b19d92\n---\n# How to: Return a LINQ Query Result as a Specific Type (Visual Basic)\nLanguage-Integrated Query (LINQ) makes it easy to access database information and execute queries. By default, LINQ queries return a list of objects as an anonymous type. You can also specify that a query return a list of a specific type by using the `Select` clause.  \n  \n The following example shows how to create a new application that performs queries against a SQL Server database and projects the results as a specific named type. For more information, see [Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md) and [Select Clause](../../../../visual-basic/language-reference/queries/select-clause.md).  \n  \n The examples in this topic use the Northwind sample database. If you do not have this database on your development computer, you can download it from the Microsoft Download Center. For instructions, see [Downloading Sample Databases](../../../../framework/data/adonet/sql/linq/downloading-sample-databases.md).  \n  \n[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  \n  \n### To create a connection to a database  \n  \n1.  In Visual Studio, open **Server Explorer**/**Database Explorer** by clicking **Server Explorer**/**Database Explorer** on the **View** menu.  \n  \n2.  Right-click **Data Connections** in **Server Explorer**/**Database Explorer** and then click **Add Connection**.  \n  \n3.  Specify a valid connection to the Northwind sample database.  \n  \n### To add a project that contains a LINQ to SQL file  \n  \n1.  In Visual Studio, on the **File** menu, point to **New** and then click **Project**. Select Visual Basic **Windows Forms Application** as the project type.  \n  \n2.  On the **Project** menu, click **Add New Item**. Select the **LINQ to SQL Classes** item template.  \n  \n3.  Name the file `northwind.dbml`. Click **Add**. The Object Relational Designer (O/R Designer) is opened for the northwind.dbml file.  \n  \n### To add tables to query to the O/R Designer  \n  \n1.  In **Server Explorer**/**Database Explorer**, expand the connection to the Northwind database. Expand the **Tables** folder.  \n  \n     If you have closed the O/R Designer, you can reopen it by double-clicking the northwind.dbml file that you added earlier.  \n  \n2.  Click the Customers table and drag it to the left pane of the designer.  \n  \n     The designer creates a new `Customer` object for your project. You can project a query result as the `Customer` type or as a type that you create. This sample will create a new type in a later procedure and project a query result as that type.  \n  \n3.  Save your changes and close the designer.  \n  \n4.  Save your project.  \n  \n### To add code to query the database and display the results  \n  \n1.  From the **Toolbox**, drag a <xref:System.Windows.Forms.DataGridView> control onto the default Windows Form for your project, Form1.  \n  \n2.  Double-click Form1 to modify the Form1 class.  \n  \n3.  After the `End Class` statement of the Form1 class, add the following code to create a `CustomerInfo` type to hold the query results for this sample.  \n  \n     [!code-vb[VbLINQToSQLHowTos#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQtoSQLHowTos/VB/Form8.vb#16)]  \n  \n4.  When you added tables to the O/R Designer, the designer added a <xref:System.Data.Linq.DataContext> object to your project. This object contains the code that you must have to access those tables, and to access individual objects and collections for each table. The <xref:System.Data.Linq.DataContext> object for your project is named based on the name of your .dbml file. For this project, the <xref:System.Data.Linq.DataContext> object is named `northwindDataContext`.  \n  \n     You can create an instance of the <xref:System.Data.Linq.DataContext> in your code and query the tables specified by the O/R Designer.  \n  \n     In the `Load` event of the Form1 class, add the following code to query the tables that are exposed as properties of your data context. The `Select` clause of the query will create a new `CustomerInfo` type instead of an anonymous type for each item of the query result.  \n  \n     [!code-vb[VbLINQToSQLHowTos#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbLINQtoSQLHowTos/VB/Form8.vb#15)]  \n  \n5.  Press F5 to run your project and view the results.  \n  \n## See also\n\n- [LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)\n- [Queries](../../../../visual-basic/language-reference/queries/index.md)\n- [LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md)\n- [DataContext Methods (O/R Designer)](/visualstudio/data-tools/datacontext-methods-o-r-designer)\n","nodes":[{"pos":[4,429],"embed":true,"restype":"x-metadata","content":"title: \"How to: Return a LINQ Query Result as a Specific Type (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"queries [LINQ in Visual Basic], specific type returned\"\n  - \"projection [LINQ in Visual Basic]\"\n  - \"anonymous types [Visual Basic]\"\n  - \"querying databases [LINQ]\"\n  - \"queries [LINQ in Visual Basic], how-to topics\"\n  - \"query samples [Visual Basic]\"\nms.assetid: 621bb10a-e5d7-44fb-a025-317964b19d92","nodes":[{"content":"How to: Return a LINQ Query Result as a Specific Type (Visual Basic)","nodes":[{"pos":[0,68],"content":"How to: Return a LINQ Query Result as a Specific Type (Visual Basic)","nodes":[{"content":"How to: Return a LINQ Query Result as a Specific Type (Visual Basic)","pos":[0,68]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[436,504],"content":"How to: Return a LINQ Query Result as a Specific Type (Visual Basic)","linkify":"How to: Return a LINQ Query Result as a Specific Type (Visual Basic)","nodes":[{"content":"How to: Return a LINQ Query Result as a Specific Type (Visual Basic)","pos":[0,68]}]},{"content":"Language-Integrated Query (LINQ) makes it easy to access database information and execute queries.","pos":[505,603]},{"content":"By default, LINQ queries return a list of objects as an anonymous type.","pos":[604,675]},{"content":"You can also specify that a query return a list of a specific type by using the <ph id=\"ph1\">`Select`</ph> clause.","pos":[676,772],"source":" You can also specify that a query return a list of a specific type by using the `Select` clause."},{"content":"The following example shows how to create a new application that performs queries against a SQL Server database and projects the results as a specific named type.","pos":[779,941]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Anonymous Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)</ept> and <bpt id=\"p2\">[</bpt>Select Clause<ept id=\"p2\">](../../../../visual-basic/language-reference/queries/select-clause.md)</ept>.","pos":[942,1177],"source":" For more information, see [Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md) and [Select Clause](../../../../visual-basic/language-reference/queries/select-clause.md)."},{"content":"The examples in this topic use the Northwind sample database.","pos":[1184,1245]},{"content":"If you do not have this database on your development computer, you can download it from the Microsoft Download Center.","pos":[1246,1364]},{"content":"For instructions, see <bpt id=\"p1\">[</bpt>Downloading Sample Databases<ept id=\"p1\">](../../../../framework/data/adonet/sql/linq/downloading-sample-databases.md)</ept>.","pos":[1365,1494],"source":" For instructions, see [Downloading Sample Databases](../../../../framework/data/adonet/sql/linq/downloading-sample-databases.md)."},{"pos":[1583,1619],"content":"To create a connection to a database","linkify":"To create a connection to a database","nodes":[{"content":"To create a connection to a database","pos":[0,36]}]},{"pos":[1629,1769],"content":"In Visual Studio, open <bpt id=\"p1\">**</bpt>Server Explorer<ept id=\"p1\">**</ept><ph id=\"ph1\">/</ph><bpt id=\"p2\">**</bpt>Database Explorer<ept id=\"p2\">**</ept> by clicking <bpt id=\"p3\">**</bpt>Server Explorer<ept id=\"p3\">**</ept><ph id=\"ph2\">/</ph><bpt id=\"p4\">**</bpt>Database Explorer<ept id=\"p4\">**</ept> on the <bpt id=\"p5\">**</bpt>View<ept id=\"p5\">**</ept> menu.","source":"In Visual Studio, open **Server Explorer**/**Database Explorer** by clicking **Server Explorer**/**Database Explorer** on the **View** menu."},{"pos":[1779,1891],"content":"Right-click <bpt id=\"p1\">**</bpt>Data Connections<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Server Explorer<ept id=\"p2\">**</ept><ph id=\"ph1\">/</ph><bpt id=\"p3\">**</bpt>Database Explorer<ept id=\"p3\">**</ept> and then click <bpt id=\"p4\">**</bpt>Add Connection<ept id=\"p4\">**</ept>.","source":"Right-click **Data Connections** in **Server Explorer**/**Database Explorer** and then click **Add Connection**."},{"content":"Specify a valid connection to the Northwind sample database.","pos":[1901,1961]},{"pos":[1971,2020],"content":"To add a project that contains a LINQ to SQL file","linkify":"To add a project that contains a LINQ to SQL file","nodes":[{"content":"To add a project that contains a LINQ to SQL file","pos":[0,49]}]},{"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","pos":[2030,2114],"source":"In Visual Studio, on the **File** menu, point to **New** and then click **Project**."},{"content":"Select Visual Basic <bpt id=\"p1\">**</bpt>Windows Forms Application<ept id=\"p1\">**</ept> as the project type.","pos":[2115,2185],"source":" Select Visual Basic **Windows Forms Application** as the project type."},{"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Add New Item<ept id=\"p2\">**</ept>.","pos":[2195,2243],"source":"On the **Project** menu, click **Add New Item**."},{"content":"Select the <bpt id=\"p1\">**</bpt>LINQ to SQL Classes<ept id=\"p1\">**</ept> item template.","pos":[2244,2293],"source":" Select the **LINQ to SQL Classes** item template."},{"content":"Name the file <ph id=\"ph1\">`northwind.dbml`</ph>.","pos":[2303,2334],"source":"Name the file `northwind.dbml`."},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","pos":[2335,2349],"source":" Click **Add**."},{"content":"The Object Relational Designer (O/R Designer) is opened for the northwind.dbml file.","pos":[2350,2434]},{"pos":[2444,2486],"content":"To add tables to query to the O/R Designer","linkify":"To add tables to query to the O/R Designer","nodes":[{"content":"To add tables to query to the O/R Designer","pos":[0,42]}]},{"content":"In <bpt id=\"p1\">**</bpt>Server Explorer<ept id=\"p1\">**</ept><ph id=\"ph1\">/</ph><bpt id=\"p2\">**</bpt>Database Explorer<ept id=\"p2\">**</ept>, expand the connection to the Northwind database.","pos":[2496,2590],"source":"In **Server Explorer**/**Database Explorer**, expand the connection to the Northwind database."},{"content":"Expand the <bpt id=\"p1\">**</bpt>Tables<ept id=\"p1\">**</ept> folder.","pos":[2591,2620],"source":" Expand the **Tables** folder."},{"content":"If you have closed the O/R Designer, you can reopen it by double-clicking the northwind.dbml file that you added earlier.","pos":[2631,2752]},{"content":"Click the Customers table and drag it to the left pane of the designer.","pos":[2762,2833]},{"content":"The designer creates a new <ph id=\"ph1\">`Customer`</ph> object for your project.","pos":[2844,2906],"source":"The designer creates a new `Customer` object for your project."},{"content":"You can project a query result as the <ph id=\"ph1\">`Customer`</ph> type or as a type that you create.","pos":[2907,2990],"source":" You can project a query result as the `Customer` type or as a type that you create."},{"content":"This sample will create a new type in a later procedure and project a query result as that type.","pos":[2991,3087]},{"content":"Save your changes and close the designer.","pos":[3097,3138]},{"content":"Save your project.","pos":[3148,3166]},{"pos":[3176,3233],"content":"To add code to query the database and display the results","linkify":"To add code to query the database and display the results","nodes":[{"content":"To add code to query the database and display the results","pos":[0,57]}]},{"pos":[3243,3375],"content":"From the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, drag a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control onto the default Windows Form for your project, Form1.","source":"From the **Toolbox**, drag a <xref:System.Windows.Forms.DataGridView> control onto the default Windows Form for your project, Form1."},{"content":"Double-click Form1 to modify the Form1 class.","pos":[3385,3430]},{"pos":[3440,3589],"content":"After the <ph id=\"ph1\">`End Class`</ph> statement of the Form1 class, add the following code to create a <ph id=\"ph2\">`CustomerInfo`</ph> type to hold the query results for this sample.","source":"After the `End Class` statement of the Form1 class, add the following code to create a `CustomerInfo` type to hold the query results for this sample."},{"content":"When you added tables to the O/R Designer, the designer added a <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object to your project.","pos":[3728,3851],"source":"When you added tables to the O/R Designer, the designer added a <xref:System.Data.Linq.DataContext> object to your project."},{"content":"This object contains the code that you must have to access those tables, and to access individual objects and collections for each table.","pos":[3852,3989]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object for your project is named based on the name of your .dbml file.","pos":[3990,4100],"source":" The <xref:System.Data.Linq.DataContext> object for your project is named based on the name of your .dbml file."},{"content":"For this project, the <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> object is named <ph id=\"ph2\">`northwindDataContext`</ph>.","pos":[4101,4198],"source":" For this project, the <xref:System.Data.Linq.DataContext> object is named `northwindDataContext`."},{"pos":[4209,4343],"content":"You can create an instance of the <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext&gt;</ph> in your code and query the tables specified by the O/R Designer.","source":"You can create an instance of the <xref:System.Data.Linq.DataContext> in your code and query the tables specified by the O/R Designer."},{"content":"In the <ph id=\"ph1\">`Load`</ph> event of the Form1 class, add the following code to query the tables that are exposed as properties of your data context.","pos":[4354,4489],"source":"In the `Load` event of the Form1 class, add the following code to query the tables that are exposed as properties of your data context."},{"content":"The <ph id=\"ph1\">`Select`</ph> clause of the query will create a new <ph id=\"ph2\">`CustomerInfo`</ph> type instead of an anonymous type for each item of the query result.","pos":[4490,4624],"source":" The `Select` clause of the query will create a new `CustomerInfo` type instead of an anonymous type for each item of the query result."},{"content":"Press F5 to run your project and view the results.","pos":[4763,4813]},{"pos":[4822,4830],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4834,4916],"content":"<bpt id=\"p1\">[</bpt>LINQ<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/linq/index.md)</ept>","source":"[LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)"},{"pos":[4919,4990],"content":"<bpt id=\"p1\">[</bpt>Queries<ept id=\"p1\">](../../../../visual-basic/language-reference/queries/index.md)</ept>","source":"[Queries](../../../../visual-basic/language-reference/queries/index.md)"},{"pos":[4993,5059],"content":"<bpt id=\"p1\">[</bpt>LINQ to SQL<ept id=\"p1\">](../../../../framework/data/adonet/sql/linq/index.md)</ept>","source":"[LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md)"},{"pos":[5062,5157],"content":"<bpt id=\"p1\">[</bpt>DataContext Methods (O/R Designer)<ept id=\"p1\">](/visualstudio/data-tools/datacontext-methods-o-r-designer)</ept>","source":"[DataContext Methods (O/R Designer)](/visualstudio/data-tools/datacontext-methods-o-r-designer)"}]}