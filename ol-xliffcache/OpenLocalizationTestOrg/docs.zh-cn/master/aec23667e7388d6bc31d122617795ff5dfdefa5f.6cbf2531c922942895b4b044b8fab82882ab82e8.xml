{"content":"---\ntitle: \"Consuming OData feeds from a workflow - WF\"\nms.date: \"03/30/2017\"\nms.assetid: 1b26617c-53e9-476a-81af-675c36d95919\n---\n# Consuming OData feeds from a workflow\n\nWCF Data Services is a component of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] that enables you to create services that use the Open Data Protocol (OData) to expose and consume data over the Web or intranet by using the semantics of representational state transfer (REST). OData exposes data as resources that are addressable by URIs. Any application can interact with an OData-based data service if it can send an HTTP request and process the OData feed that a data service returns. In addition, WCF Data Services includes client libraries that provide a richer programming experience when you consume OData feeds from [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] applications. This topic provides an overview of consuming an OData feed in a workflow with and without using the client libraries.\n\n## Using the sample Northwind OData service\n\nThe examples in this topic use the sample Northwind data service located at [http://services.odata.org/Northwind/Northwind.svc/](https://go.microsoft.com/fwlink/?LinkID=187426). This service is provided as part of the [OData SDK](https://go.microsoft.com/fwlink/?LinkID=185248) and provides read-only access to the sample Northwind database. If write access is desired, or if a local WCF Data Service is desired, you can follow the steps of the [WCF Data Services Quickstart](https://go.microsoft.com/fwlink/?LinkID=131076) to create a local OData service that provides access to the Northwind database. If you follow the quickstart, substitute the local URI for the one provided in the example code in this topic.\n\n## Consuming an OData feed using the client libraries\n\nWCF Data Services includes client libraries that enable you to more easily consume an OData feed from [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] and client applications. These libraries simplify sending and receiving HTTP messages. They also translate the message payload into CLR objects that represent entity data. The client libraries feature the two core classes <xref:System.Data.Services.Client.DataServiceContext> and <xref:System.Data.Services.Client.DataServiceQuery%601>. These classes enable you to query a data service and then work with the returned entity data as CLR objects. This section covers two approaches to creating activities that use the client libraries.\n\n### Adding a service reference to the WCF Data service\n\nTo generate the Northwind client libraries, you can use the **Add Service Reference** dialog box in Visual Studio 2012 to add a reference to the Northwind OData service.\n\n![Screenshot that shows the Add Service Reference dialog.](./media/consuming-odata-feeds-from-a-workflow/add-service-reference-dialog.gif)\n\nNote that there are no service operations exposed by the service, and in the **Services** list there are items representing the entities exposed by the Northwind data service. When the service reference is added, classes will be generated for these entities and they can be used in the client code. The examples in this topic use these classes and the `NorthwindEntities` class to perform the queries.\n\n> [!NOTE]\n> For more information, see [Generating the Data Service Client Library (WCF Data Services)](../data/wcf/generating-the-data-service-client-library-wcf-data-services.md).\n\n### Using asynchronous methods\n\nTo address possible latency issues that may occur when accessing resources over the Web, we recommend accessing WCF Data Services asynchronously. The WCF Data Services client libraries include asynchronous methods for invoking queries, and Windows Workflow Foundation (WF) provides the <xref:System.Activities.AsyncCodeActivity> class for authoring asynchronous activities. <xref:System.Activities.AsyncCodeActivity> derived activities can be written to take advantage of [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] classes that have asynchronous methods, or the code to be executed asynchronously can be put into a method and invoked by using a delegate. This section provides two examples of an <xref:System.Activities.AsyncCodeActivity> derived activity; one that uses the asynchronous methods of the WCF Data Services client libraries and one that uses a delegate.\n\n> [!NOTE]\n> For more information, see [Asynchronous Operations (WCF Data Services)](../data/wcf/asynchronous-operations-wcf-data-services.md) and [Creating Asynchronous Activities](creating-asynchronous-activities-in-wf.md).\n\n### Using client library asynchronous methods\n\nThe <xref:System.Data.Services.Client.DataServiceQuery%601> class provides <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> and <xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A> methods for querying an OData service asynchronously. These methods can be called from the <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> and <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> overrides of an <xref:System.Activities.AsyncCodeActivity> derived class. When the <xref:System.Activities.AsyncCodeActivity> <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override returns, the workflow can go idle (but not persist), and when the asynchronous work is completed, <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> is invoked by the runtime.\n\nIn the following example, an `OrdersByCustomer` activity is defined that has two input arguments. The `CustomerId` argument represents the customer who identifies which orders to return, and the `ServiceUri` argument represents the URI of the OData service to be queried. Because the activity derives from `AsyncCodeActivity<IEnumerable<Order>>` there is also a <xref:System.Activities.Activity%601.Result%2A> output argument that is used to return the results of the query. The <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override creates a LINQ query that selects all orders of the specified customer. This query is specified as the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A> of the passed <xref:System.Activities.AsyncCodeActivityContext>, and then the query's <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> method is called. Note that the callback and state that are passed into the query's <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> are the ones that are passed in to the activity's <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> method. When the query has finished executing, the activity's <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> method is invoked. The query is retrieved from the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>, and then the query's <xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A> method is called. This method returns an <xref:System.Collections.Generic.IEnumerable%601> of the specified entity type; in this case `Order`. Since `IEnumerable<Order>` is the generic type of the <xref:System.Activities.AsyncCodeActivity%601>, this <xref:System.Collections.IEnumerable> is set as the <xref:System.Activities.Activity%601.Result%2A> <xref:System.Activities.OutArgument%601> of the activity.\n\n[!code-csharp[CFX_WCFDataServicesActivityExample#100](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#100)]\n\nIn the following example, the `OrdersByCustomer` activity retrieves a list of orders for the specified customer, and then a <xref:System.Activities.Statements.ForEach%601> activity enumerates the returned orders and writes the date of each order to the console.\n\n[!code-csharp[CFX_WCFDataServicesActivityExample#10](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#10)]\n\nWhen this workflow is invoked, the following data is written to the console:\n\n```console\nCalling WCF Data Service...\n8/25/1997\n10/3/1997\n10/13/1997\n1/15/1998\n3/16/1998\n4/9/1998\n```\n\n> [!NOTE]\n> If a connection to the OData server cannot be established, you will get an exception similar to the following exception:\n>\n> Unhandled Exception: System.InvalidOperationException: An error occurred while processing this request. ---> System.Net.WebException: Unable to connect to the remote server ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.\n\nIf any additional processing of the data returned by the query is required, it can be done in the activity's <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> override. Both <xref:System.Activities.AsyncCodeActivity%601.BeginExecute%2A> and <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> are invoked by using the workflow thread, and any code in these overrides does not run asynchronously. If the additional processing is extensive or long-running, or the query results are paged, you should consider the approach discussed in the next section, which uses a delegate to execute the query and perform additional processing asynchronously.\n\n### Using a delegate\n\nIn addition to invoking the asynchronous method of a [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] class, an <xref:System.Activities.AsyncCodeActivity>-based activity can also define the asynchronous logic in one of its methods. This method is specified by using a delegate in the activity's <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override. When the method returns, the runtime invokes the activity's <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> override. When calling an OData service from a workflow, this method can be used to query the service and provide any additional processing.\n\nIn the following example, a `ListCustomers` activity is defined. This activity queries the sample Northwind data service and returns a `List<Customer>` that contains all of the customers in the Northwind database. The asynchronous work is performed by the `GetCustomers` method. This method queries the service for all customers, and then copies them into a `List<Customer>`. It then checks to see if the results are paged. If so, it queries the service for the next page of results, adds them to the list, and continues until all of the customer data has been retrieved.\n\n> [!NOTE]\n> For more information about paging in WCF Data Services, see [How to: Load Paged Results (WCF Data Services)](../data/wcf/how-to-load-paged-results-wcf-data-services.md).\n\nOnce all customers are added, the list is returned. The `GetCustomers` method is specified in the activity's <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override. Since the method has a return value, a `Func<string, List<Customer>>` is created to specify the method.\n\n> [!NOTE]\n> If the method that performs the asynchronous work does not have a return value, an <xref:System.Action> is used instead of a <xref:System.Func%601>. For examples of creating an asynchronous example using both approaches, see [Creating Asynchronous Activities](creating-asynchronous-activities-in-wf.md).\n\nThis <xref:System.Func%601> is assigned to the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>, and then `BeginInvoke` is called. Since the method to be invoked does not have access to the activity's environment of arguments, the value of the `ServiceUri` argument is passed as the first parameter, together with the callback and state that were passed into <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A>. When `GetCustomers` returns, the runtime invokes <xref:System.Activities.AsyncCodeActivity.EndExecute%2A>. The code in <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> retrieves the delegate from the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>, calls `EndInvoke`, and returns the result, which is the list of customers returned from the `GetCustomers` method.\n\n[!code-csharp[CFX_WCFDataServicesActivityExample#200](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#200)]\n\nIn the following example, the `ListCustomers` activity retrieves a list of customers, and then a <xref:System.Activities.Statements.ForEach%601> activity enumerates them and writes the company name and contact name of each customer to the console.\n\n[!code-csharp[CFX_WCFDataServicesActivityExample#20](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#20)]\n\nWhen this workflow is invoked, the following data is written to the console. Since this query returns many customers, only part of the output is displayed here.\n\n```console\nCalling WCF Data Service...\nAlfreds Futterkiste, Contact: Maria Anders\nAna Trujillo Emparedados y helados, Contact: Ana Trujillo\nAntonio Moreno Taquería, Contact: Antonio Moreno\nAround the Horn, Contact: Thomas Hardy\nBerglunds snabbköp, Contact: Christina Berglund\n...\n```\n\n## Consuming an OData feed without using the client libraries\n\nOData exposes data as resources that are addressable by URIs. When you use the client libraries these URIs are created for you, but you do not have to use the client libraries. If desired, OData services can be accessed directly without using the client libraries. When not using the client libraries the location of the service and the desired data are specified by the URI and the results are returned in the response to the HTTP request. This raw data can then be processed or manipulated in the desired manner. One way to retrieve the results of an OData query is by using the <xref:System.Net.WebClient> class. In this example, the contact name for the customer represented by the key ALFKI is retrieved.\n\n[!code-csharp[CFX_WCFDataServicesActivityExample#2](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#2)]\n\nWhen this code is run, the following output is displayed to the console:\n\n```console\nRaw data returned:\n<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>\n<ContactName xmlns=\"http://schemas.microsoft.com/ado/2007/08/dataservices\">Maria Anders</ContactName>\n```\n\nIn a workflow, the code from this example could be incorporated into the <xref:System.Activities.CodeActivity.Execute%2A> override of a <xref:System.Activities.CodeActivity>-based custom activity, but the same functionality can also be accomplished by using the <xref:System.Activities.Expressions.InvokeMethod%601> activity. The <xref:System.Activities.Expressions.InvokeMethod%601> activity enables workflow authors to invoke static and instance methods of a class, and also has an option to invoke the specified method asynchronously. In the following example, an <xref:System.Activities.Expressions.InvokeMethod%601> activity is configured to call the <xref:System.Net.WebClient.DownloadString%2A> method of the <xref:System.Net.WebClient> class and return a list of customers.\n\n[!code-csharp[CFX_WCFDataServicesActivityExample#3](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#3)]\n\n<xref:System.Activities.Expressions.InvokeMethod%601> can call both static and instance methods of a class. Since <xref:System.Net.WebClient.DownloadString%2A> is an instance method of the <xref:System.Net.WebClient> class, a new instance of the <xref:System.Net.WebClient> class is specified for the <xref:System.Activities.Expressions.InvokeMethod%601.TargetObject%2A>. `DownloadString` is specified as the <xref:System.Activities.Expressions.InvokeMethod%601.MethodName%2A>, the URI that contains the query is specified in the <xref:System.Activities.Expressions.InvokeMethod%601.Parameters%2A> collection, and the return value is assigned to the <xref:System.Activities.Activity%601.Result%2A> value. The <xref:System.Activities.Expressions.InvokeMethod%601.RunAsynchronously%2A> value is set to `true`, which means that the method invocation will run asynchronously with regard to the workflow. In the following example, a workflow is constructed that uses the <xref:System.Activities.Expressions.InvokeMethod%601> activity to query the sample Northwind data service for a list of orders for a specific customer, and then the returned data is written to the console.\n\n[!code-csharp[CFX_WCFDataServicesActivityExample#1](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#1)]\n\nWhen this workflow is invoked, the following output is displayed to the console. Since this query returns several orders, only part of the output is displayed here.\n\n```console\nCalling WCF Data Service...\nRaw data returned:\n\n<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>*\n<feed\nxml:base=\"http://services.odata.org/Northwind/Northwind.svc/\"\nxmlns:d=\"http://schemas.microsoft.com/ado/2007/08/dataservices\"\nxmlns:m=\"http://schemas.microsoft.com/ado/2007/08/dataservices/metadata\"\nxmlns=\"http://www.w3.org/2005/Atom\">\n<title type=\"text\">Orders\\</title>\n<id>http://services.odata.org/Northwind/Northwind.svc/Customers('ALFKI')/Orders\\</id>\n<updated>2010-05-19T19:37:07Z\\</updated>\n<link rel=\"self\" title=\"Orders\" href=\"Orders\" />\n<entry>\n<id>http://services.odata.org/Northwind/Northwind.svc/Orders(10643)\\</id>\n<title type=\"text\">\\</title>\n<updated>2010-05-19T19:37:07Z\\</updated>\n<author>\n<name />\n</author>\n<link rel=\"edit\" title=\"Order\" href=\"Orders(10643)\" />\n<link rel=\"http://schemas.microsoft.com/ado/2007/08/dataservices/related/Customer\" type=\"application/atom+xml;type=entry\" title=\"Customer\" href=\"Orders(10643)/Customer\" />\n...\n```\n\nThis example provides one method that workflow application authors can use to consume the raw data returned from an OData service. For more information about accessing WCF Data Services using URIs, see [Accessing Data Service Resources (WCF Data Services)](../data/wcf/accessing-data-service-resources-wcf-data-services.md) and [OData: URI Conventions](https://go.microsoft.com/fwlink/?LinkId=185564).\n","nodes":[{"pos":[4,126],"embed":true,"restype":"x-metadata","content":"title: \"Consuming OData feeds from a workflow - WF\"\nms.date: \"03/30/2017\"\nms.assetid: 1b26617c-53e9-476a-81af-675c36d95919","nodes":[{"content":"Consuming OData feeds from a workflow - WF","nodes":[{"pos":[0,42],"content":"Consuming OData feeds from a workflow - WF","nodes":[{"content":"Consuming OData feeds from a workflow - WF","pos":[0,42]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[133,170],"content":"Consuming OData feeds from a workflow","linkify":"Consuming OData feeds from a workflow","nodes":[{"content":"Consuming OData feeds from a workflow","pos":[0,37]}]},{"content":"WCF Data Services is a component of the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]</ph> that enables you to create services that use the Open Data Protocol (OData) to expose and consume data over the Web or intranet by using the semantics of representational state transfer (REST).","pos":[172,466],"source":"WCF Data Services is a component of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] that enables you to create services that use the Open Data Protocol (OData) to expose and consume data over the Web or intranet by using the semantics of representational state transfer (REST)."},{"content":"OData exposes data as resources that are addressable by URIs.","pos":[467,528]},{"content":"Any application can interact with an OData-based data service if it can send an HTTP request and process the OData feed that a data service returns.","pos":[529,677]},{"content":"In addition, WCF Data Services includes client libraries that provide a richer programming experience when you consume OData feeds from <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]</ph> applications.","pos":[678,888],"source":" In addition, WCF Data Services includes client libraries that provide a richer programming experience when you consume OData feeds from [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] applications."},{"content":"This topic provides an overview of consuming an OData feed in a workflow with and without using the client libraries.","pos":[889,1006]},{"pos":[1011,1051],"content":"Using the sample Northwind OData service","linkify":"Using the sample Northwind OData service","nodes":[{"content":"Using the sample Northwind OData service","pos":[0,40]}]},{"content":"The examples in this topic use the sample Northwind data service located at <bpt id=\"p1\">[</bpt><ph id=\"ph1\">http://services.odata.org/Northwind/Northwind.svc/</ph><ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=187426)</ept>.","pos":[1053,1230],"source":"The examples in this topic use the sample Northwind data service located at [http://services.odata.org/Northwind/Northwind.svc/](https://go.microsoft.com/fwlink/?LinkID=187426)."},{"content":"This service is provided as part of the <bpt id=\"p1\">[</bpt>OData SDK<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=185248)</ept> and provides read-only access to the sample Northwind database.","pos":[1231,1394],"source":" This service is provided as part of the [OData SDK](https://go.microsoft.com/fwlink/?LinkID=185248) and provides read-only access to the sample Northwind database."},{"content":"If write access is desired, or if a local WCF Data Service is desired, you can follow the steps of the <bpt id=\"p1\">[</bpt>WCF Data Services Quickstart<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=131076)</ept> to create a local OData service that provides access to the Northwind database.","pos":[1395,1656],"source":" If write access is desired, or if a local WCF Data Service is desired, you can follow the steps of the [WCF Data Services Quickstart](https://go.microsoft.com/fwlink/?LinkID=131076) to create a local OData service that provides access to the Northwind database."},{"content":"If you follow the quickstart, substitute the local URI for the one provided in the example code in this topic.","pos":[1657,1767]},{"pos":[1772,1822],"content":"Consuming an OData feed using the client libraries","linkify":"Consuming an OData feed using the client libraries","nodes":[{"content":"Consuming an OData feed using the client libraries","pos":[0,50]}]},{"content":"WCF Data Services includes client libraries that enable you to more easily consume an OData feed from <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]</ph> and client applications.","pos":[1824,2011],"source":"WCF Data Services includes client libraries that enable you to more easily consume an OData feed from [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] and client applications."},{"content":"These libraries simplify sending and receiving HTTP messages.","pos":[2012,2073]},{"content":"They also translate the message payload into CLR objects that represent entity data.","pos":[2074,2158]},{"content":"The client libraries feature the two core classes <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph>.","pos":[2159,2323],"source":" The client libraries feature the two core classes <xref:System.Data.Services.Client.DataServiceContext> and <xref:System.Data.Services.Client.DataServiceQuery%601>."},{"content":"These classes enable you to query a data service and then work with the returned entity data as CLR objects.","pos":[2324,2432]},{"content":"This section covers two approaches to creating activities that use the client libraries.","pos":[2433,2521]},{"pos":[2527,2577],"content":"Adding a service reference to the WCF Data service","linkify":"Adding a service reference to the WCF Data service","nodes":[{"content":"Adding a service reference to the WCF Data service","pos":[0,50]}]},{"pos":[2579,2748],"content":"To generate the Northwind client libraries, you can use the <bpt id=\"p1\">**</bpt>Add Service Reference<ept id=\"p1\">**</ept> dialog box in Visual Studio 2012 to add a reference to the Northwind OData service.","source":"To generate the Northwind client libraries, you can use the **Add Service Reference** dialog box in Visual Studio 2012 to add a reference to the Northwind OData service."},{"content":"Screenshot that shows the Add Service Reference dialog.","pos":[2752,2807]},{"content":"Note that there are no service operations exposed by the service, and in the <bpt id=\"p1\">**</bpt>Services<ept id=\"p1\">**</ept> list there are items representing the entities exposed by the Northwind data service.","pos":[2890,3065],"source":"Note that there are no service operations exposed by the service, and in the **Services** list there are items representing the entities exposed by the Northwind data service."},{"content":"When the service reference is added, classes will be generated for these entities and they can be used in the client code.","pos":[3066,3188]},{"content":"The examples in this topic use these classes and the <ph id=\"ph1\">`NorthwindEntities`</ph> class to perform the queries.","pos":[3189,3291],"source":" The examples in this topic use these classes and the `NorthwindEntities` class to perform the queries."},{"pos":[3295,3473],"content":"[!NOTE]\nFor more information, see [Generating the Data Service Client Library (WCF Data Services)](../data/wcf/generating-the-data-service-client-library-wcf-data-services.md).","leadings":["","> "],"nodes":[{"content":"For more information, see <bpt id=\"p1\">[</bpt>Generating the Data Service Client Library (WCF Data Services)<ept id=\"p1\">](../data/wcf/generating-the-data-service-client-library-wcf-data-services.md)</ept>.","pos":[8,176],"source":"For more information, see [Generating the Data Service Client Library (WCF Data Services)](../data/wcf/generating-the-data-service-client-library-wcf-data-services.md)."}]},{"pos":[3479,3505],"content":"Using asynchronous methods","linkify":"Using asynchronous methods","nodes":[{"content":"Using asynchronous methods","pos":[0,26]}]},{"content":"To address possible latency issues that may occur when accessing resources over the Web, we recommend accessing WCF Data Services asynchronously.","pos":[3507,3652]},{"content":"The WCF Data Services client libraries include asynchronous methods for invoking queries, and Windows Workflow Foundation (WF) provides the <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity&gt;</ph> class for authoring asynchronous activities.","pos":[3653,3880],"source":" The WCF Data Services client libraries include asynchronous methods for invoking queries, and Windows Workflow Foundation (WF) provides the <xref:System.Activities.AsyncCodeActivity> class for authoring asynchronous activities."},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity&gt;</ph> derived activities can be written to take advantage of <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]</ph> classes that have asynchronous methods, or the code to be executed asynchronously can be put into a method and invoked by using a delegate.","pos":[3881,4179],"source":"<xref:System.Activities.AsyncCodeActivity> derived activities can be written to take advantage of [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] classes that have asynchronous methods, or the code to be executed asynchronously can be put into a method and invoked by using a delegate."},{"content":"This section provides two examples of an <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity&gt;</ph> derived activity; one that uses the asynchronous methods of the WCF Data Services client libraries and one that uses a delegate.","pos":[4180,4392],"source":" This section provides two examples of an <xref:System.Activities.AsyncCodeActivity> derived activity; one that uses the asynchronous methods of the WCF Data Services client libraries and one that uses a delegate."},{"pos":[4396,4618],"content":"[!NOTE]\nFor more information, see [Asynchronous Operations (WCF Data Services)](../data/wcf/asynchronous-operations-wcf-data-services.md) and [Creating Asynchronous Activities](creating-asynchronous-activities-in-wf.md).","leadings":["","> "],"nodes":[{"content":"For more information, see <bpt id=\"p1\">[</bpt>Asynchronous Operations (WCF Data Services)<ept id=\"p1\">](../data/wcf/asynchronous-operations-wcf-data-services.md)</ept> and <bpt id=\"p2\">[</bpt>Creating Asynchronous Activities<ept id=\"p2\">](creating-asynchronous-activities-in-wf.md)</ept>.","pos":[8,220],"source":"For more information, see [Asynchronous Operations (WCF Data Services)](../data/wcf/asynchronous-operations-wcf-data-services.md) and [Creating Asynchronous Activities](creating-asynchronous-activities-in-wf.md)."}]},{"pos":[4624,4665],"content":"Using client library asynchronous methods","linkify":"Using client library asynchronous methods","nodes":[{"content":"Using client library asynchronous methods","pos":[0,41]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> class provides <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A&gt;</ph> methods for querying an OData service asynchronously.","pos":[4667,4941],"source":"The <xref:System.Data.Services.Client.DataServiceQuery%601> class provides <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> and <xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A> methods for querying an OData service asynchronously."},{"content":"These methods can be called from the <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity.BeginExecute%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivity.EndExecute%2A&gt;</ph> overrides of an <ph id=\"ph3\">&lt;xref:System.Activities.AsyncCodeActivity&gt;</ph> derived class.","pos":[4942,5172],"source":" These methods can be called from the <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> and <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> overrides of an <xref:System.Activities.AsyncCodeActivity> derived class."},{"content":"When the <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity&gt;</ph> <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivity.BeginExecute%2A&gt;</ph> override returns, the workflow can go idle (but not persist), and when the asynchronous work is completed, <ph id=\"ph3\">&lt;xref:System.Activities.AsyncCodeActivity.EndExecute%2A&gt;</ph> is invoked by the runtime.","pos":[5173,5474],"source":" When the <xref:System.Activities.AsyncCodeActivity> <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override returns, the workflow can go idle (but not persist), and when the asynchronous work is completed, <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> is invoked by the runtime."},{"content":"In the following example, an <ph id=\"ph1\">`OrdersByCustomer`</ph> activity is defined that has two input arguments.","pos":[5476,5573],"source":"In the following example, an `OrdersByCustomer` activity is defined that has two input arguments."},{"content":"The <ph id=\"ph1\">`CustomerId`</ph> argument represents the customer who identifies which orders to return, and the <ph id=\"ph2\">`ServiceUri`</ph> argument represents the URI of the OData service to be queried.","pos":[5574,5747],"source":" The `CustomerId` argument represents the customer who identifies which orders to return, and the `ServiceUri` argument represents the URI of the OData service to be queried."},{"content":"Because the activity derives from <ph id=\"ph1\">`AsyncCodeActivity&lt;IEnumerable&lt;Order&gt;&gt;`</ph> there is also a <ph id=\"ph2\">&lt;xref:System.Activities.Activity%601.Result%2A&gt;</ph> output argument that is used to return the results of the query.","pos":[5748,5950],"source":" Because the activity derives from `AsyncCodeActivity<IEnumerable<Order>>` there is also a <xref:System.Activities.Activity%601.Result%2A> output argument that is used to return the results of the query."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity.BeginExecute%2A&gt;</ph> override creates a LINQ query that selects all orders of the specified customer.","pos":[5951,6094],"source":" The <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override creates a LINQ query that selects all orders of the specified customer."},{"content":"This query is specified as the <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivityContext.UserState%2A&gt;</ph> of the passed <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivityContext&gt;</ph>, and then the query's <ph id=\"ph3\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A&gt;</ph> method is called.","pos":[6095,6364],"source":" This query is specified as the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A> of the passed <xref:System.Activities.AsyncCodeActivityContext>, and then the query's <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> method is called."},{"content":"Note that the callback and state that are passed into the query's <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A&gt;</ph> are the ones that are passed in to the activity's <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivity.BeginExecute%2A&gt;</ph> method.","pos":[6365,6619],"source":" Note that the callback and state that are passed into the query's <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> are the ones that are passed in to the activity's <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> method."},{"content":"When the query has finished executing, the activity's <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity.EndExecute%2A&gt;</ph> method is invoked.","pos":[6620,6749],"source":" When the query has finished executing, the activity's <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> method is invoked."},{"content":"The query is retrieved from the <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivityContext.UserState%2A&gt;</ph>, and then the query's <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A&gt;</ph> method is called.","pos":[6750,6954],"source":" The query is retrieved from the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>, and then the query's <xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A> method is called."},{"content":"This method returns an <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> of the specified entity type; in this case <ph id=\"ph2\">`Order`</ph>.","pos":[6955,7079],"source":" This method returns an <xref:System.Collections.Generic.IEnumerable%601> of the specified entity type; in this case `Order`."},{"content":"Since <ph id=\"ph1\">`IEnumerable&lt;Order&gt;`</ph> is the generic type of the <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivity%601&gt;</ph>, this <ph id=\"ph3\">&lt;xref:System.Collections.IEnumerable&gt;</ph> is set as the <ph id=\"ph4\">&lt;xref:System.Activities.Activity%601.Result%2A&gt;</ph> <ph id=\"ph5\">&lt;xref:System.Activities.OutArgument%601&gt;</ph> of the activity.","pos":[7080,7344],"source":" Since `IEnumerable<Order>` is the generic type of the <xref:System.Activities.AsyncCodeActivity%601>, this <xref:System.Collections.IEnumerable> is set as the <xref:System.Activities.Activity%601.Result%2A> <xref:System.Activities.OutArgument%601> of the activity."},{"pos":[7498,7759],"content":"In the following example, the <ph id=\"ph1\">`OrdersByCustomer`</ph> activity retrieves a list of orders for the specified customer, and then a <ph id=\"ph2\">&lt;xref:System.Activities.Statements.ForEach%601&gt;</ph> activity enumerates the returned orders and writes the date of each order to the console.","source":"In the following example, the `OrdersByCustomer` activity retrieves a list of orders for the specified customer, and then a <xref:System.Activities.Statements.ForEach%601> activity enumerates the returned orders and writes the date of each order to the console."},{"content":"When this workflow is invoked, the following data is written to the console:","pos":[7911,7987]},{"pos":[8095,8225],"content":"[!NOTE]\nIf a connection to the OData server cannot be established, you will get an exception similar to the following exception:","leadings":["","> "],"nodes":[{"content":"If a connection to the OData server cannot be established, you will get an exception similar to the following exception:","pos":[8,128]}]},{"content":"Unhandled Exception: System.InvalidOperationException: An error occurred while processing this request.","pos":[8230,8333]},{"content":"---&gt; System.Net.WebException: Unable to connect to the remote server ---&gt; System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.","pos":[8334,8627],"source":" ---> System.Net.WebException: Unable to connect to the remote server ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond."},{"content":"If any additional processing of the data returned by the query is required, it can be done in the activity's <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A&gt;</ph> override.","pos":[8629,8808],"source":"If any additional processing of the data returned by the query is required, it can be done in the activity's <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> override."},{"content":"Both <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity%601.BeginExecute%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A&gt;</ph> are invoked by using the workflow thread, and any code in these overrides does not run asynchronously.","pos":[8809,9044],"source":" Both <xref:System.Activities.AsyncCodeActivity%601.BeginExecute%2A> and <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> are invoked by using the workflow thread, and any code in these overrides does not run asynchronously."},{"content":"If the additional processing is extensive or long-running, or the query results are paged, you should consider the approach discussed in the next section, which uses a delegate to execute the query and perform additional processing asynchronously.","pos":[9045,9292]},{"pos":[9298,9314],"content":"Using a delegate","linkify":"Using a delegate","nodes":[{"content":"Using a delegate","pos":[0,16]}]},{"content":"In addition to invoking the asynchronous method of a <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]</ph> class, an <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivity&gt;</ph>-based activity can also define the asynchronous logic in one of its methods.","pos":[9316,9559],"source":"In addition to invoking the asynchronous method of a [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] class, an <xref:System.Activities.AsyncCodeActivity>-based activity can also define the asynchronous logic in one of its methods."},{"content":"This method is specified by using a delegate in the activity's <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity.BeginExecute%2A&gt;</ph> override.","pos":[9560,9691],"source":" This method is specified by using a delegate in the activity's <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override."},{"content":"When the method returns, the runtime invokes the activity's <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity.EndExecute%2A&gt;</ph> override.","pos":[9692,9818],"source":" When the method returns, the runtime invokes the activity's <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> override."},{"content":"When calling an OData service from a workflow, this method can be used to query the service and provide any additional processing.","pos":[9819,9949]},{"content":"In the following example, a <ph id=\"ph1\">`ListCustomers`</ph> activity is defined.","pos":[9951,10015],"source":"In the following example, a `ListCustomers` activity is defined."},{"content":"This activity queries the sample Northwind data service and returns a <ph id=\"ph1\">`List&lt;Customer&gt;`</ph> that contains all of the customers in the Northwind database.","pos":[10016,10164],"source":" This activity queries the sample Northwind data service and returns a `List<Customer>` that contains all of the customers in the Northwind database."},{"content":"The asynchronous work is performed by the <ph id=\"ph1\">`GetCustomers`</ph> method.","pos":[10165,10229],"source":" The asynchronous work is performed by the `GetCustomers` method."},{"content":"This method queries the service for all customers, and then copies them into a <ph id=\"ph1\">`List&lt;Customer&gt;`</ph>.","pos":[10230,10326],"source":" This method queries the service for all customers, and then copies them into a `List<Customer>`."},{"content":"It then checks to see if the results are paged.","pos":[10327,10374]},{"content":"If so, it queries the service for the next page of results, adds them to the list, and continues until all of the customer data has been retrieved.","pos":[10375,10522]},{"pos":[10526,10705],"content":"[!NOTE]\nFor more information about paging in WCF Data Services, see [How to: Load Paged Results (WCF Data Services)](../data/wcf/how-to-load-paged-results-wcf-data-services.md).","leadings":["","> "],"nodes":[{"content":"For more information about paging in WCF Data Services, see <bpt id=\"p1\">[</bpt>How to: Load Paged Results (WCF Data Services)<ept id=\"p1\">](../data/wcf/how-to-load-paged-results-wcf-data-services.md)</ept>.","pos":[8,177],"source":"For more information about paging in WCF Data Services, see [How to: Load Paged Results (WCF Data Services)](../data/wcf/how-to-load-paged-results-wcf-data-services.md)."}]},{"content":"Once all customers are added, the list is returned.","pos":[10707,10758]},{"content":"The <ph id=\"ph1\">`GetCustomers`</ph> method is specified in the activity's <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivity.BeginExecute%2A&gt;</ph> override.","pos":[10759,10884],"source":" The `GetCustomers` method is specified in the activity's <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override."},{"content":"Since the method has a return value, a <ph id=\"ph1\">`Func&lt;string, List&lt;Customer&gt;&gt;`</ph> is created to specify the method.","pos":[10885,10988],"source":" Since the method has a return value, a `Func<string, List<Customer>>` is created to specify the method."},{"pos":[10992,11305],"content":"[!NOTE]\nIf the method that performs the asynchronous work does not have a return value, an <xref:System.Action> is used instead of a <xref:System.Func%601>. For examples of creating an asynchronous example using both approaches, see [Creating Asynchronous Activities](creating-asynchronous-activities-in-wf.md).","leadings":["","> "],"nodes":[{"content":"If the method that performs the asynchronous work does not have a return value, an <xref:System.Action> is used instead of a <xref:System.Func%601>. For examples of creating an asynchronous example using both approaches, see [Creating Asynchronous Activities](creating-asynchronous-activities-in-wf.md).","pos":[8,311],"nodes":[{"content":"If the method that performs the asynchronous work does not have a return value, an <ph id=\"ph1\">&lt;xref:System.Action&gt;</ph> is used instead of a <ph id=\"ph2\">&lt;xref:System.Func%601&gt;</ph>.","pos":[0,148],"source":"If the method that performs the asynchronous work does not have a return value, an <xref:System.Action> is used instead of a <xref:System.Func%601>."},{"content":"For examples of creating an asynchronous example using both approaches, see <bpt id=\"p1\">[</bpt>Creating Asynchronous Activities<ept id=\"p1\">](creating-asynchronous-activities-in-wf.md)</ept>.","pos":[149,303],"source":" For examples of creating an asynchronous example using both approaches, see [Creating Asynchronous Activities](creating-asynchronous-activities-in-wf.md)."}]}]},{"content":"This <ph id=\"ph1\">&lt;xref:System.Func%601&gt;</ph> is assigned to the <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivityContext.UserState%2A&gt;</ph>, and then <ph id=\"ph3\">`BeginInvoke`</ph> is called.","pos":[11307,11451],"source":"This <xref:System.Func%601> is assigned to the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>, and then `BeginInvoke` is called."},{"content":"Since the method to be invoked does not have access to the activity's environment of arguments, the value of the <ph id=\"ph1\">`ServiceUri`</ph> argument is passed as the first parameter, together with the callback and state that were passed into <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivity.BeginExecute%2A&gt;</ph>.","pos":[11452,11739],"source":" Since the method to be invoked does not have access to the activity's environment of arguments, the value of the `ServiceUri` argument is passed as the first parameter, together with the callback and state that were passed into <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A>."},{"content":"When <ph id=\"ph1\">`GetCustomers`</ph> returns, the runtime invokes <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivity.EndExecute%2A&gt;</ph>.","pos":[11740,11846],"source":" When `GetCustomers` returns, the runtime invokes <xref:System.Activities.AsyncCodeActivity.EndExecute%2A>."},{"content":"The code in <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity.EndExecute%2A&gt;</ph> retrieves the delegate from the <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivityContext.UserState%2A&gt;</ph>, calls <ph id=\"ph3\">`EndInvoke`</ph>, and returns the result, which is the list of customers returned from the <ph id=\"ph4\">`GetCustomers`</ph> method.","pos":[11847,12126],"source":" The code in <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> retrieves the delegate from the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>, calls `EndInvoke`, and returns the result, which is the list of customers returned from the `GetCustomers` method."},{"pos":[12280,12527],"content":"In the following example, the <ph id=\"ph1\">`ListCustomers`</ph> activity retrieves a list of customers, and then a <ph id=\"ph2\">&lt;xref:System.Activities.Statements.ForEach%601&gt;</ph> activity enumerates them and writes the company name and contact name of each customer to the console.","source":"In the following example, the `ListCustomers` activity retrieves a list of customers, and then a <xref:System.Activities.Statements.ForEach%601> activity enumerates them and writes the company name and contact name of each customer to the console."},{"content":"When this workflow is invoked, the following data is written to the console.","pos":[12679,12755]},{"content":"Since this query returns many customers, only part of the output is displayed here.","pos":[12756,12839]},{"pos":[13129,13187],"content":"Consuming an OData feed without using the client libraries","linkify":"Consuming an OData feed without using the client libraries","nodes":[{"content":"Consuming an OData feed without using the client libraries","pos":[0,58]}]},{"content":"OData exposes data as resources that are addressable by URIs.","pos":[13189,13250]},{"content":"When you use the client libraries these URIs are created for you, but you do not have to use the client libraries.","pos":[13251,13365]},{"content":"If desired, OData services can be accessed directly without using the client libraries.","pos":[13366,13453]},{"content":"When not using the client libraries the location of the service and the desired data are specified by the URI and the results are returned in the response to the HTTP request.","pos":[13454,13629]},{"content":"This raw data can then be processed or manipulated in the desired manner.","pos":[13630,13703]},{"content":"One way to retrieve the results of an OData query is by using the <ph id=\"ph1\">&lt;xref:System.Net.WebClient&gt;</ph> class.","pos":[13704,13804],"source":" One way to retrieve the results of an OData query is by using the <xref:System.Net.WebClient> class."},{"content":"In this example, the contact name for the customer represented by the key ALFKI is retrieved.","pos":[13805,13898]},{"content":"When this code is run, the following output is displayed to the console:","pos":[14048,14120]},{"content":"In a workflow, the code from this example could be incorporated into the <ph id=\"ph1\">&lt;xref:System.Activities.CodeActivity.Execute%2A&gt;</ph> override of a <ph id=\"ph2\">&lt;xref:System.Activities.CodeActivity&gt;</ph>-based custom activity, but the same functionality can also be accomplished by using the <ph id=\"ph3\">&lt;xref:System.Activities.Expressions.InvokeMethod%601&gt;</ph> activity.","pos":[14315,14640],"source":"In a workflow, the code from this example could be incorporated into the <xref:System.Activities.CodeActivity.Execute%2A> override of a <xref:System.Activities.CodeActivity>-based custom activity, but the same functionality can also be accomplished by using the <xref:System.Activities.Expressions.InvokeMethod%601> activity."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Activities.Expressions.InvokeMethod%601&gt;</ph> activity enables workflow authors to invoke static and instance methods of a class, and also has an option to invoke the specified method asynchronously.","pos":[14641,14852],"source":" The <xref:System.Activities.Expressions.InvokeMethod%601> activity enables workflow authors to invoke static and instance methods of a class, and also has an option to invoke the specified method asynchronously."},{"content":"In the following example, an <ph id=\"ph1\">&lt;xref:System.Activities.Expressions.InvokeMethod%601&gt;</ph> activity is configured to call the <ph id=\"ph2\">&lt;xref:System.Net.WebClient.DownloadString%2A&gt;</ph> method of the <ph id=\"ph3\">&lt;xref:System.Net.WebClient&gt;</ph> class and return a list of customers.","pos":[14853,15096],"source":" In the following example, an <xref:System.Activities.Expressions.InvokeMethod%601> activity is configured to call the <xref:System.Net.WebClient.DownloadString%2A> method of the <xref:System.Net.WebClient> class and return a list of customers."},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.Expressions.InvokeMethod%601&gt;</ph> can call both static and instance methods of a class.","pos":[15246,15353],"source":"<xref:System.Activities.Expressions.InvokeMethod%601> can call both static and instance methods of a class."},{"content":"Since <ph id=\"ph1\">&lt;xref:System.Net.WebClient.DownloadString%2A&gt;</ph> is an instance method of the <ph id=\"ph2\">&lt;xref:System.Net.WebClient&gt;</ph> class, a new instance of the <ph id=\"ph3\">&lt;xref:System.Net.WebClient&gt;</ph> class is specified for the <ph id=\"ph4\">&lt;xref:System.Activities.Expressions.InvokeMethod%601.TargetObject%2A&gt;</ph>.","pos":[15354,15617],"source":" Since <xref:System.Net.WebClient.DownloadString%2A> is an instance method of the <xref:System.Net.WebClient> class, a new instance of the <xref:System.Net.WebClient> class is specified for the <xref:System.Activities.Expressions.InvokeMethod%601.TargetObject%2A>."},{"content":"<ph id=\"ph1\">`DownloadString`</ph> is specified as the <ph id=\"ph2\">&lt;xref:System.Activities.Expressions.InvokeMethod%601.MethodName%2A&gt;</ph>, the URI that contains the query is specified in the <ph id=\"ph3\">&lt;xref:System.Activities.Expressions.InvokeMethod%601.Parameters%2A&gt;</ph> collection, and the return value is assigned to the <ph id=\"ph4\">&lt;xref:System.Activities.Activity%601.Result%2A&gt;</ph> value.","pos":[15618,15950],"source":"`DownloadString` is specified as the <xref:System.Activities.Expressions.InvokeMethod%601.MethodName%2A>, the URI that contains the query is specified in the <xref:System.Activities.Expressions.InvokeMethod%601.Parameters%2A> collection, and the return value is assigned to the <xref:System.Activities.Activity%601.Result%2A> value."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Activities.Expressions.InvokeMethod%601.RunAsynchronously%2A&gt;</ph> value is set to <ph id=\"ph2\">`true`</ph>, which means that the method invocation will run asynchronously with regard to the workflow.","pos":[15951,16145],"source":" The <xref:System.Activities.Expressions.InvokeMethod%601.RunAsynchronously%2A> value is set to `true`, which means that the method invocation will run asynchronously with regard to the workflow."},{"content":"In the following example, a workflow is constructed that uses the <ph id=\"ph1\">&lt;xref:System.Activities.Expressions.InvokeMethod%601&gt;</ph> activity to query the sample Northwind data service for a list of orders for a specific customer, and then the returned data is written to the console.","pos":[16146,16417],"source":" In the following example, a workflow is constructed that uses the <xref:System.Activities.Expressions.InvokeMethod%601> activity to query the sample Northwind data service for a list of orders for a specific customer, and then the returned data is written to the console."},{"content":"When this workflow is invoked, the following output is displayed to the console.","pos":[16567,16647]},{"content":"Since this query returns several orders, only part of the output is displayed here.","pos":[16648,16731]},{"content":"This example provides one method that workflow application authors can use to consume the raw data returned from an OData service.","pos":[17718,17848]},{"content":"For more information about accessing WCF Data Services using URIs, see <bpt id=\"p1\">[</bpt>Accessing Data Service Resources (WCF Data Services)<ept id=\"p1\">](../data/wcf/accessing-data-service-resources-wcf-data-services.md)</ept> and <bpt id=\"p2\">[</bpt>OData: URI Conventions<ept id=\"p2\">](https://go.microsoft.com/fwlink/?LinkId=185564)</ept>.","pos":[17849,18119],"source":" For more information about accessing WCF Data Services using URIs, see [Accessing Data Service Resources (WCF Data Services)](../data/wcf/accessing-data-service-resources-wcf-data-services.md) and [OData: URI Conventions](https://go.microsoft.com/fwlink/?LinkId=185564)."}]}