{"content":"---\ntitle: \"Drag-and-Drop Functionality in Windows Forms\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"drag and drop [Windows Forms], Windows Forms\"\n  - \"Windows Forms, drag and drop\"\nms.assetid: 65cd2c03-8782-474e-b958-cbe43eeb902c\n---\n# Drag-and-Drop Functionality in Windows Forms\nWindows Forms includes a set of methods, events, and classes that implement drag-and-drop behavior. This topic provides an overview of the drag-and-drop support in Windows Forms.  Also see [Drag-and-Drop Operations and Clipboard Support](./advanced/drag-and-drop-operations-and-clipboard-support.md).  \n  \n## Performing Drag-and-Drop Operations  \n To perform a drag-and-drop operation, use the <xref:System.Windows.Forms.Control.DoDragDrop%2A> method of the <xref:System.Windows.Forms.Control> class. For more information about how a drag-and-drop operation is performed, see <xref:System.Windows.Forms.Control.DoDragDrop%2A>. To get the rectangle that the mouse pointer must be dragged over before a drag-and-drop operation begins, use the <xref:System.Windows.Forms.SystemInformation.DragSize%2A> property of the <xref:System.Windows.Forms.SystemInformation> class.  \n  \n## Events Related to Drag-and-Drop Operations  \n There are two categories of events in a drag and drop operation: events that occur on the current target of the drag-and-drop operation, and events that occur on the source of the drag and drop operation.  \n  \n### Events on the Current Target  \n The following table shows the events that occur on the current target of a drag-and-drop operation.  \n  \n|Mouse Event|Description|  \n|-----------------|-----------------|  \n|<xref:System.Windows.Forms.Control.DragEnter>|This event occurs when an object is dragged into the control's bounds. The handler for this event receives an argument of type <xref:System.Windows.Forms.DragEventArgs>.|  \n|<xref:System.Windows.Forms.Control.DragOver>|This event occurs when an object is dragged while the mouse pointer is within the control's bounds. The handler for this event receives an argument of type <xref:System.Windows.Forms.DragEventArgs>.|  \n|<xref:System.Windows.Forms.Control.DragDrop>|This event occurs when a drag-and-drop operation is completed. The handler for this event receives an argument of type <xref:System.Windows.Forms.DragEventArgs>.|  \n|<xref:System.Windows.Forms.Control.DragLeave>|This event occurs when an object is dragged out of the control's bounds. The handler for this event receives an argument of type <xref:System.EventArgs>.|  \n  \n The <xref:System.Windows.Forms.DragEventArgs> class provides the location of the mouse pointer, the current state of the mouse buttons and modifier keys of the keyboard, the data being dragged, and <xref:System.Windows.Forms.DragDropEffects> values that specify the operations allowed by the source of the drag event and the target drop effect for the operation.  \n  \n### Events on the Source  \n The following table shows the events that occur on the source of the drag-and-drop operation.  \n  \n|Mouse Event|Description|  \n|-----------------|-----------------|  \n|<xref:System.Windows.Forms.Control.GiveFeedback>|This event occurs during a drag operation. It provides an opportunity to give a visual cue to the user that the drag-and-drop operation is occurring, such as changing the mouse pointer. The handler for this event receives an argument of type <xref:System.Windows.Forms.GiveFeedbackEventArgs>.|  \n|<xref:System.Windows.Forms.Control.QueryContinueDrag>|This event is raised during a drag-and-drop operation and enables the drag source to determine whether the drag-and-drop operation should be canceled. The handler for this event receives an argument of type <xref:System.Windows.Forms.QueryContinueDragEventArgs>.|  \n  \n The <xref:System.Windows.Forms.QueryContinueDragEventArgs> class provides the current state of the mouse buttons and modifier keys of the keyboard, a value specifying whether the ESC key was pressed, and a <xref:System.Windows.Forms.DragAction> value that can be set to specify whether the drag-and-drop operation should continue.  \n  \n## See also\n\n- [Mouse Input in a Windows Forms Application](mouse-input-in-a-windows-forms-application.md)\n","nodes":[{"pos":[4,236],"embed":true,"restype":"x-metadata","content":"title: \"Drag-and-Drop Functionality in Windows Forms\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"drag and drop [Windows Forms], Windows Forms\"\n  - \"Windows Forms, drag and drop\"\nms.assetid: 65cd2c03-8782-474e-b958-cbe43eeb902c","nodes":[{"content":"Drag-and-Drop Functionality in Windows Forms","nodes":[{"pos":[0,44],"content":"Drag-and-Drop Functionality in Windows Forms","nodes":[{"content":"Drag-and-Drop Functionality in Windows Forms","pos":[0,44]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[243,287],"content":"Drag-and-Drop Functionality in Windows Forms","linkify":"Drag-and-Drop Functionality in Windows Forms","nodes":[{"content":"Drag-and-Drop Functionality in Windows Forms","pos":[0,44]}]},{"content":"Windows Forms includes a set of methods, events, and classes that implement drag-and-drop behavior.","pos":[288,387]},{"content":"This topic provides an overview of the drag-and-drop support in Windows Forms.","pos":[388,466]},{"content":"Also see <bpt id=\"p1\">[</bpt>Drag-and-Drop Operations and Clipboard Support<ept id=\"p1\">](./advanced/drag-and-drop-operations-and-clipboard-support.md)</ept>.","pos":[468,588],"source":"  Also see [Drag-and-Drop Operations and Clipboard Support](./advanced/drag-and-drop-operations-and-clipboard-support.md)."},{"pos":[597,632],"content":"Performing Drag-and-Drop Operations","linkify":"Performing Drag-and-Drop Operations","nodes":[{"content":"Performing Drag-and-Drop Operations","pos":[0,35]}]},{"content":"To perform a drag-and-drop operation, use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.DoDragDrop%2A&gt;</ph> method of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control&gt;</ph> class.","pos":[636,788],"source":"To perform a drag-and-drop operation, use the <xref:System.Windows.Forms.Control.DoDragDrop%2A> method of the <xref:System.Windows.Forms.Control> class."},{"content":"For more information about how a drag-and-drop operation is performed, see <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.DoDragDrop%2A&gt;</ph>.","pos":[789,914],"source":" For more information about how a drag-and-drop operation is performed, see <xref:System.Windows.Forms.Control.DoDragDrop%2A>."},{"content":"To get the rectangle that the mouse pointer must be dragged over before a drag-and-drop operation begins, use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SystemInformation.DragSize%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.SystemInformation&gt;</ph> class.","pos":[915,1155],"source":" To get the rectangle that the mouse pointer must be dragged over before a drag-and-drop operation begins, use the <xref:System.Windows.Forms.SystemInformation.DragSize%2A> property of the <xref:System.Windows.Forms.SystemInformation> class."},{"pos":[1164,1206],"content":"Events Related to Drag-and-Drop Operations","linkify":"Events Related to Drag-and-Drop Operations","nodes":[{"content":"Events Related to Drag-and-Drop Operations","pos":[0,42]}]},{"content":"There are two categories of events in a drag and drop operation: events that occur on the current target of the drag-and-drop operation, and events that occur on the source of the drag and drop operation.","pos":[1210,1414]},{"pos":[1424,1452],"content":"Events on the Current Target","linkify":"Events on the Current Target","nodes":[{"content":"Events on the Current Target","pos":[0,28]}]},{"content":"The following table shows the events that occur on the current target of a drag-and-drop operation.","pos":[1456,1555]},{"content":"Mouse Event","pos":[1562,1573]},{"content":"Description","pos":[1574,1585]},{"content":"This event occurs when an object is dragged into the control's bounds.","pos":[1676,1746]},{"content":"The handler for this event receives an argument of type <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DragEventArgs&gt;</ph>.","pos":[1747,1845],"source":" The handler for this event receives an argument of type <xref:System.Windows.Forms.DragEventArgs>."},{"content":"This event occurs when an object is dragged while the mouse pointer is within the control's bounds.","pos":[1895,1994]},{"content":"The handler for this event receives an argument of type <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DragEventArgs&gt;</ph>.","pos":[1995,2093],"source":" The handler for this event receives an argument of type <xref:System.Windows.Forms.DragEventArgs>."},{"content":"This event occurs when a drag-and-drop operation is completed.","pos":[2143,2205]},{"content":"The handler for this event receives an argument of type <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DragEventArgs&gt;</ph>.","pos":[2206,2304],"source":" The handler for this event receives an argument of type <xref:System.Windows.Forms.DragEventArgs>."},{"content":"This event occurs when an object is dragged out of the control's bounds.","pos":[2355,2427]},{"content":"The handler for this event receives an argument of type <ph id=\"ph1\">&lt;xref:System.EventArgs&gt;</ph>.","pos":[2428,2508],"source":" The handler for this event receives an argument of type <xref:System.EventArgs>."},{"pos":[2516,2878],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DragEventArgs&gt;</ph> class provides the location of the mouse pointer, the current state of the mouse buttons and modifier keys of the keyboard, the data being dragged, and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DragDropEffects&gt;</ph> values that specify the operations allowed by the source of the drag event and the target drop effect for the operation.","source":"The <xref:System.Windows.Forms.DragEventArgs> class provides the location of the mouse pointer, the current state of the mouse buttons and modifier keys of the keyboard, the data being dragged, and <xref:System.Windows.Forms.DragDropEffects> values that specify the operations allowed by the source of the drag event and the target drop effect for the operation."},{"pos":[2888,2908],"content":"Events on the Source","linkify":"Events on the Source","nodes":[{"content":"Events on the Source","pos":[0,20]}]},{"content":"The following table shows the events that occur on the source of the drag-and-drop operation.","pos":[2912,3005]},{"content":"Mouse Event","pos":[3012,3023]},{"content":"Description","pos":[3024,3035]},{"content":"This event occurs during a drag operation.","pos":[3129,3171]},{"content":"It provides an opportunity to give a visual cue to the user that the drag-and-drop operation is occurring, such as changing the mouse pointer.","pos":[3172,3314]},{"content":"The handler for this event receives an argument of type <ph id=\"ph1\">&lt;xref:System.Windows.Forms.GiveFeedbackEventArgs&gt;</ph>.","pos":[3315,3421],"source":" The handler for this event receives an argument of type <xref:System.Windows.Forms.GiveFeedbackEventArgs>."},{"content":"This event is raised during a drag-and-drop operation and enables the drag source to determine whether the drag-and-drop operation should be canceled.","pos":[3480,3630]},{"content":"The handler for this event receives an argument of type <ph id=\"ph1\">&lt;xref:System.Windows.Forms.QueryContinueDragEventArgs&gt;</ph>.","pos":[3631,3742],"source":" The handler for this event receives an argument of type <xref:System.Windows.Forms.QueryContinueDragEventArgs>."},{"pos":[3750,4080],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.QueryContinueDragEventArgs&gt;</ph> class provides the current state of the mouse buttons and modifier keys of the keyboard, a value specifying whether the ESC key was pressed, and a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DragAction&gt;</ph> value that can be set to specify whether the drag-and-drop operation should continue.","source":"The <xref:System.Windows.Forms.QueryContinueDragEventArgs> class provides the current state of the mouse buttons and modifier keys of the keyboard, a value specifying whether the ESC key was pressed, and a <xref:System.Windows.Forms.DragAction> value that can be set to specify whether the drag-and-drop operation should continue."},{"pos":[4089,4097],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4101,4192],"content":"<bpt id=\"p1\">[</bpt>Mouse Input in a Windows Forms Application<ept id=\"p1\">](mouse-input-in-a-windows-forms-application.md)</ept>","source":"[Mouse Input in a Windows Forms Application](mouse-input-in-a-windows-forms-application.md)"}]}