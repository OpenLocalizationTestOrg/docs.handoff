{"content":"---\ntitle: \"Diagnosing Errors with Managed Debugging Assistants\"\nms.date: 08/14/2018\nf1_keywords:\n  - \"EHMDA\"\nhelpviewer_keywords:\n  - \"run-time error debugging\"\n  - \"managed code, run-time debugging\"\n  - \"resource debugging\"\n  - \"registry, MDAs\"\n  - \"common language runtime, debugging\"\n  - \"MDAs (managed debugging assistants)\"\n  - \"configuration files [.NET Framework], debugging runtime events\"\n  - \"messages, managed debugging assistants\"\n  - \"application configuration files, managed debugging assistants\"\n  - \"debugging [.NET Framework], managed debugging assistants\"\n  - \"environment variables, MDAs\"\n  - \"access violation debugging [.NET Framework]\"\n  - \"diagnostics, managed debugging assistants\"\n  - \"unmanaged code, run-time debugging\"\n  - \"default debug output stream\"\n  - \"memory, debugging\"\n  - \"app.config files, managed debugging assistants\"\n  - \"managed debugging assistants (MDAs)\"\n  - \"debugging [.NET Framework], run-time errors\"\n  - \"trapping events\"\n  - \"runtime, error debugging\"\n  - \"disabling MDAs\"\n  - \"output, managed debugging assistants\"\n  - \"errors [.NET Framework], managed debugging assistants\"\nms.assetid: 76994ee6-9fa9-4059-b813-26578d24427c\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Diagnose Errors with Managed Debugging Assistants\n\nManaged debugging assistants (MDAs) are debugging aids that work in conjunction with the common language runtime (CLR) to provide information on runtime state. The assistants generate informational messages about runtime events that you cannot otherwise trap. You can use MDAs to isolate hard-to-find application bugs that occur when transitioning between managed and unmanaged code.\n\nYou can [enable or disable](#enable-and-disable-mdas) all MDAs by adding a key to the Windows registry or by setting an environment variable. You can enable specific MDAs by using application configuration settings. You can set additional configuration settings for some individual MDAs in the application's configuration file. Because these configuration files are parsed when the runtime is loaded, you must enable the MDA before the managed application starts. You cannot enable it for applications that have already started.\n\nThe following table lists the MDAs that ship with the .NET Framework:\n\n|||\n|-|-|\n|[asynchronousThreadAbort](../../../docs/framework/debug-trace-profile/asynchronousthreadabort-mda.md)|[bindingFailure](../../../docs/framework/debug-trace-profile/bindingfailure-mda.md)|\n|[callbackOnCollectedDelegate](../../../docs/framework/debug-trace-profile/callbackoncollecteddelegate-mda.md)|[contextSwitchDeadlock](../../../docs/framework/debug-trace-profile/contextswitchdeadlock-mda.md)|\n|[dangerousThreadingAPI](../../../docs/framework/debug-trace-profile/dangerousthreadingapi-mda.md)|[dateTimeInvalidLocalFormat](../../../docs/framework/debug-trace-profile/datetimeinvalidlocalformat-mda.md)|\n|[dirtyCastAndCallOnInterface](../../../docs/framework/debug-trace-profile/dirtycastandcalloninterface-mda.md)|[disconnectedContext](../../../docs/framework/debug-trace-profile/disconnectedcontext-mda.md)|\n|[dllMainReturnsFalse](../../../docs/framework/debug-trace-profile/dllmainreturnsfalse-mda.md)|[exceptionSwallowedOnCallFromCom](../../../docs/framework/debug-trace-profile/exceptionswallowedoncallfromcom-mda.md)|\n|[failedQI](../../../docs/framework/debug-trace-profile/failedqi-mda.md)|[fatalExecutionEngineError](../../../docs/framework/debug-trace-profile/fatalexecutionengineerror-mda.md)|\n|[gcManagedToUnmanaged](../../../docs/framework/debug-trace-profile/gcmanagedtounmanaged-mda.md)|[gcUnmanagedToManaged](../../../docs/framework/debug-trace-profile/gcunmanagedtomanaged-mda.md)|\n|[illegalPrepareConstrainedRegion](../../../docs/framework/debug-trace-profile/illegalprepareconstrainedregion-mda.md)|[invalidApartmentStateChange](../../../docs/framework/debug-trace-profile/invalidapartmentstatechange-mda.md)|\n|[invalidCERCall](../../../docs/framework/debug-trace-profile/invalidcercall-mda.md)|[invalidFunctionPointerInDelegate](../../../docs/framework/debug-trace-profile/invalidfunctionpointerindelegate-mda.md)|\n|[invalidGCHandleCookie](../../../docs/framework/debug-trace-profile/invalidgchandlecookie-mda.md)|[invalidIUnknown](../../../docs/framework/debug-trace-profile/invalidiunknown-mda.md)|\n|[invalidMemberDeclaration](../../../docs/framework/debug-trace-profile/invalidmemberdeclaration-mda.md)|[invalidOverlappedToPinvoke](../../../docs/framework/debug-trace-profile/invalidoverlappedtopinvoke-mda.md)|\n|[invalidVariant](../../../docs/framework/debug-trace-profile/invalidvariant-mda.md)|[jitCompilationStart](../../../docs/framework/debug-trace-profile/jitcompilationstart-mda.md)|\n|[loaderLock](../../../docs/framework/debug-trace-profile/loaderlock-mda.md)|[loadFromContext](../../../docs/framework/debug-trace-profile/loadfromcontext-mda.md)|\n|[marshalCleanupError](../../../docs/framework/debug-trace-profile/marshalcleanuperror-mda.md)|[marshaling](../../../docs/framework/debug-trace-profile/marshaling-mda.md)|\n|[memberInfoCacheCreation](../../../docs/framework/debug-trace-profile/memberinfocachecreation-mda.md)|[moduloObjectHashcode](../../../docs/framework/debug-trace-profile/moduloobjecthashcode-mda.md)|\n|[nonComVisibleBaseClass](../../../docs/framework/debug-trace-profile/noncomvisiblebaseclass-mda.md)|[notMarshalable](../../../docs/framework/debug-trace-profile/notmarshalable-mda.md)|\n|[openGenericCERCall](../../../docs/framework/debug-trace-profile/opengenericcercall-mda.md)|[overlappedFreeError](../../../docs/framework/debug-trace-profile/overlappedfreeerror-mda.md)|\n|[pInvokeLog](../../../docs/framework/debug-trace-profile/pinvokelog-mda.md)|[pInvokeStackImbalance](../../../docs/framework/debug-trace-profile/pinvokestackimbalance-mda.md)|\n|[raceOnRCWCleanup](../../../docs/framework/debug-trace-profile/raceonrcwcleanup-mda.md)|[reentrancy](../../../docs/framework/debug-trace-profile/reentrancy-mda.md)|\n|[releaseHandleFailed](../../../docs/framework/debug-trace-profile/releasehandlefailed-mda.md)|[reportAvOnComRelease](../../../docs/framework/debug-trace-profile/reportavoncomrelease-mda.md)|\n|[streamWriterBufferedDataLost](../../../docs/framework/debug-trace-profile/streamwriterbuffereddatalost-mda.md)|[virtualCERCall](../../../docs/framework/debug-trace-profile/virtualcercall-mda.md)|\n\nBy default, the .NET Framework activates a subset of MDAs for all managed debuggers. You can view the default set in Visual Studio by choosing **Windows** > **Exception Settings** on the **Debug** menu, and then expanding the **Managed Debugging Assistants** list.\n\n![Exception Settings window in Visual Studio](media/diagnosing-errors-with-managed-debugging-assistants/exception-settings-mdas.png)\n\n## Enable and Disable MDAs\n\nYou can enable and disable MDAs by using a registry key, an environment variable, and application configuration settings. You must enable either the registry key or the environment variable to use the application configuration settings.\n\n> [!TIP]\n> Instead of disabling MDAs, you can prevent Visual Studio from displaying the MDA dialog box whenever an MDA notification is received. To do that, choose **Windows** > **Exception Settings** on the **Debug** menu, expand the **Managed Debugging Assistants** list, and then select or clear the **Break When Thrown** check box for the individual MDA.\n\n### Registry Key\n\nTo enable MDAs, add the **HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\\.NETFramework\\MDA** subkey (type REG_SZ, value 1) in the Windows registry. Copy the following example into a text file named *MDAEnable.reg*. Open the Windows Registry Editor (RegEdit.exe), and from the **File** menu choose **Import**. Select the *MDAEnable.reg* file to enable MDAs on that computer. Setting the subkey to string value of **1** (not DWORD value of **1**) enables the reading of MDA settings from the *ApplicationName.suffix*.mda.config file. For example, the MDA configuration file for Notepad would be named notepad.exe.mda.config.\n\n```text\nWindows Registry Editor Version 5.00\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework]\n\"MDA\"=\"1\"\n```\n\nIf the computer is running a 32-bit application on a 64-bit operating system, then the MDA key should be set like the following:\n\n```text\nWindows Registry Editor Version 5.00\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\.NETFramework]\n\"MDA\"=\"1\"\n```\n\nSee [Application-Specific Configuration Settings](#application-specific-configuration-settings) for more information. The registry setting can be overridden by the COMPLUS_MDA environment variable. See [Environment Variable](#environment-variable) for more information.\n\nTo disable MDAs, set the MDA subkey to **0** (zero) using the Windows Registry Editor.\n\nBy default, some MDAs are enabled when you run an application that is attached to a debugger, even without adding the registry key. You can disable these assistants by running the *MDADisable.reg* file as described earlier in this section.\n\n### Environment Variable\n\nMDA activation can also controlled by the environment variable COMPLUS_MDA, which overrides the registry key. The COMPLUS_MDA string is a case-insensitive, semicolon-delimited list of MDA names or other special control strings. Starting under a managed or unmanaged debugger enables a set of MDAs by default. This is done by implicitly prepending the semicolon-delimited list of MDAs enabled by default under debuggers to the value of the environment variable or registry key. The special control strings are the following:\n\n- `0` - Deactivates all MDAs.\n\n- `1` - Reads MDA settings from *ApplicationName*.mda.config.\n\n- `managedDebugger` - Explicitly activates all MDAs that are implicitly activated when a managed executable is started under a debugger.\n\n- `unmanagedDebugger` - Explicitly activates all MDAs that are implicitly activated when an unmanaged executable is started under a debugger.\n\nIf there are conflicting settings, the most recent settings override previous settings:\n\n- `COMPLUS_MDA=0` disables all MDAs, including those implicitly enabled under a debugger.\n\n- `COMPLUS_MDA=gcUnmanagedToManaged` enables `gcUnmanagedToManaged` in addition to any MDAs that are implicitly enabled under a debugger.\n\n- `COMPLUS_MDA=0;gcUnmanagedToManaged` enables `gcUnmanagedToManaged` but disables MDAs that would otherwise be implicitly enabled under a debugger.\n\n### Application-Specific Configuration Settings\n\nYou can enable, disable, and configure some assistants individually in the MDA configuration file for the application. To enable the use of an application configuration file for configuring MDAs, either the MDA registry key or the COMPLUS_MDA environment variable must be set. The application configuration file is typically located in the same directory as the application's executable (.exe) file. The file name takes the form *ApplicationName*.mda.config; for example, notepad.exe.mda.config. Assistants that are enabled in the application configuration file may have attributes or elements specifically designed to control that assistant's behavior.\n\nThe following example shows how to enable and configure the [marshaling](../../../docs/framework/debug-trace-profile/marshaling-mda.md):\n\n```xml\n<mdaConfig>\n  <assistants>\n    <marshaling>\n      <methodFilter>\n        <match name=\"*\"/>\n      </methodFilter>\n      <fieldFilter>\n        <match name=\"*\"/>\n      </fieldFilter>\n    </marshaling>\n  </assistants>\n</mdaConfig>\n```\n\nThe `Marshaling` MDA emits information about the managed type that is being marshaled to an unmanaged type for each managed-to-unmanaged transition in the application. The `Marshaling` MDA can also filter the names of the method and structure fields supplied in the **methodFilter** and **fieldFilter** child elements, respectively.\n\nThe following example shows how to enable multiple MDAs by using their default settings:\n\n```xml\n<mdaConfig>\n  <assistants>\n    <illegalPrepareConstrainedRegion />\n    <invalidCERCall />\n    <openGenericCERCall />\n    <virtualCERCall />\n  </assistants>\n</mdaConfig>\n```\n\n> [!IMPORTANT]\n> When you specify more than one assistant in a configuration file, you must list them in alphabetical order. For example, if you want to enable both the `virtualCERCall` and the `invalidCERCall` MDAs, you must add the `<invalidCERCall />` entry before the `<virtualCERCall />` entry. If the entries are not in alphabetical order, an unhandled invalid configuration file exception message is displayed.\n\n## MDA exceptions\n\nWhen an MDA is enabled, it's active even when your code is not executing under a debugger. If an MDA event is raised when a debugger is not present, the event message is presented in an unhandled exception dialog box, although it is not an unhandled exception. To avoid the dialog box, remove the MDA-enabling settings when your code is not executing in a debugging environment.\n\nWhen your code executes in the Visual Studio integrated development environment (IDE), you can avoid the exception dialog box that appears for specific MDA events. To do that, on the **Debug** menu, choose **Windows** > **Exception Settings**. In the **Exception Settings** window, expand the **Managed Debugging Assistants** list, and then clear the **Break When Thrown** check box for the individual MDA. You can also use this dialog box to *enable* the display of MDA exception dialog boxes.\n\n## MDA Output\n\nMDA output is similar to the following example, which shows the output from the `PInvokeStackImbalance` MDA:\n\n**A call to PInvoke function 'MDATest!MDATest.Program::StdCall' has unbalanced the stack. This is likely because the managed PInvoke signature does not match the unmanaged target signature. Check that the calling convention and parameters of the PInvoke signature match the target unmanaged signature.**\n\n## See also\n\n- [Debugging, Tracing, and Profiling](../../../docs/framework/debug-trace-profile/index.md)\n","nodes":[{"pos":[4,1213],"embed":true,"restype":"x-metadata","content":"title: \"Diagnosing Errors with Managed Debugging Assistants\"\nms.date: 08/14/2018\nf1_keywords:\n  - \"EHMDA\"\nhelpviewer_keywords:\n  - \"run-time error debugging\"\n  - \"managed code, run-time debugging\"\n  - \"resource debugging\"\n  - \"registry, MDAs\"\n  - \"common language runtime, debugging\"\n  - \"MDAs (managed debugging assistants)\"\n  - \"configuration files [.NET Framework], debugging runtime events\"\n  - \"messages, managed debugging assistants\"\n  - \"application configuration files, managed debugging assistants\"\n  - \"debugging [.NET Framework], managed debugging assistants\"\n  - \"environment variables, MDAs\"\n  - \"access violation debugging [.NET Framework]\"\n  - \"diagnostics, managed debugging assistants\"\n  - \"unmanaged code, run-time debugging\"\n  - \"default debug output stream\"\n  - \"memory, debugging\"\n  - \"app.config files, managed debugging assistants\"\n  - \"managed debugging assistants (MDAs)\"\n  - \"debugging [.NET Framework], run-time errors\"\n  - \"trapping events\"\n  - \"runtime, error debugging\"\n  - \"disabling MDAs\"\n  - \"output, managed debugging assistants\"\n  - \"errors [.NET Framework], managed debugging assistants\"\nms.assetid: 76994ee6-9fa9-4059-b813-26578d24427c\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Diagnosing Errors with Managed Debugging Assistants","nodes":[{"pos":[0,51],"content":"Diagnosing Errors with Managed Debugging Assistants","nodes":[{"content":"Diagnosing Errors with Managed Debugging Assistants","pos":[0,51]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[1220,1269],"content":"Diagnose Errors with Managed Debugging Assistants","linkify":"Diagnose Errors with Managed Debugging Assistants","nodes":[{"content":"Diagnose Errors with Managed Debugging Assistants","pos":[0,49]}]},{"content":"Managed debugging assistants (MDAs) are debugging aids that work in conjunction with the common language runtime (CLR) to provide information on runtime state.","pos":[1271,1430]},{"content":"The assistants generate informational messages about runtime events that you cannot otherwise trap.","pos":[1431,1530]},{"content":"You can use MDAs to isolate hard-to-find application bugs that occur when transitioning between managed and unmanaged code.","pos":[1531,1654]},{"content":"You can <bpt id=\"p1\">[</bpt>enable or disable<ept id=\"p1\">](#enable-and-disable-mdas)</ept> all MDAs by adding a key to the Windows registry or by setting an environment variable.","pos":[1656,1797],"source":"You can [enable or disable](#enable-and-disable-mdas) all MDAs by adding a key to the Windows registry or by setting an environment variable."},{"content":"You can enable specific MDAs by using application configuration settings.","pos":[1798,1871]},{"content":"You can set additional configuration settings for some individual MDAs in the application's configuration file.","pos":[1872,1983]},{"content":"Because these configuration files are parsed when the runtime is loaded, you must enable the MDA before the managed application starts.","pos":[1984,2119]},{"content":"You cannot enable it for applications that have already started.","pos":[2120,2184]},{"content":"The following table lists the MDAs that ship with the .NET Framework:","pos":[2186,2255]},{"pos":[2268,2369],"content":"<bpt id=\"p1\">[</bpt>asynchronousThreadAbort<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/asynchronousthreadabort-mda.md)</ept>","source":"[asynchronousThreadAbort](../../../docs/framework/debug-trace-profile/asynchronousthreadabort-mda.md)"},{"pos":[2370,2453],"content":"<bpt id=\"p1\">[</bpt>bindingFailure<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/bindingfailure-mda.md)</ept>","source":"[bindingFailure](../../../docs/framework/debug-trace-profile/bindingfailure-mda.md)"},{"pos":[2456,2565],"content":"<bpt id=\"p1\">[</bpt>callbackOnCollectedDelegate<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/callbackoncollecteddelegate-mda.md)</ept>","source":"[callbackOnCollectedDelegate](../../../docs/framework/debug-trace-profile/callbackoncollecteddelegate-mda.md)"},{"pos":[2566,2663],"content":"<bpt id=\"p1\">[</bpt>contextSwitchDeadlock<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/contextswitchdeadlock-mda.md)</ept>","source":"[contextSwitchDeadlock](../../../docs/framework/debug-trace-profile/contextswitchdeadlock-mda.md)"},{"pos":[2666,2763],"content":"<bpt id=\"p1\">[</bpt>dangerousThreadingAPI<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/dangerousthreadingapi-mda.md)</ept>","source":"[dangerousThreadingAPI](../../../docs/framework/debug-trace-profile/dangerousthreadingapi-mda.md)"},{"pos":[2764,2871],"content":"<bpt id=\"p1\">[</bpt>dateTimeInvalidLocalFormat<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/datetimeinvalidlocalformat-mda.md)</ept>","source":"[dateTimeInvalidLocalFormat](../../../docs/framework/debug-trace-profile/datetimeinvalidlocalformat-mda.md)"},{"pos":[2874,2983],"content":"<bpt id=\"p1\">[</bpt>dirtyCastAndCallOnInterface<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/dirtycastandcalloninterface-mda.md)</ept>","source":"[dirtyCastAndCallOnInterface](../../../docs/framework/debug-trace-profile/dirtycastandcalloninterface-mda.md)"},{"pos":[2984,3077],"content":"<bpt id=\"p1\">[</bpt>disconnectedContext<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/disconnectedcontext-mda.md)</ept>","source":"[disconnectedContext](../../../docs/framework/debug-trace-profile/disconnectedcontext-mda.md)"},{"pos":[3080,3173],"content":"<bpt id=\"p1\">[</bpt>dllMainReturnsFalse<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/dllmainreturnsfalse-mda.md)</ept>","source":"[dllMainReturnsFalse](../../../docs/framework/debug-trace-profile/dllmainreturnsfalse-mda.md)"},{"pos":[3174,3291],"content":"<bpt id=\"p1\">[</bpt>exceptionSwallowedOnCallFromCom<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/exceptionswallowedoncallfromcom-mda.md)</ept>","source":"[exceptionSwallowedOnCallFromCom](../../../docs/framework/debug-trace-profile/exceptionswallowedoncallfromcom-mda.md)"},{"pos":[3294,3365],"content":"<bpt id=\"p1\">[</bpt>failedQI<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/failedqi-mda.md)</ept>","source":"[failedQI](../../../docs/framework/debug-trace-profile/failedqi-mda.md)"},{"pos":[3366,3471],"content":"<bpt id=\"p1\">[</bpt>fatalExecutionEngineError<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/fatalexecutionengineerror-mda.md)</ept>","source":"[fatalExecutionEngineError](../../../docs/framework/debug-trace-profile/fatalexecutionengineerror-mda.md)"},{"pos":[3474,3569],"content":"<bpt id=\"p1\">[</bpt>gcManagedToUnmanaged<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/gcmanagedtounmanaged-mda.md)</ept>","source":"[gcManagedToUnmanaged](../../../docs/framework/debug-trace-profile/gcmanagedtounmanaged-mda.md)"},{"pos":[3570,3665],"content":"<bpt id=\"p1\">[</bpt>gcUnmanagedToManaged<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/gcunmanagedtomanaged-mda.md)</ept>","source":"[gcUnmanagedToManaged](../../../docs/framework/debug-trace-profile/gcunmanagedtomanaged-mda.md)"},{"pos":[3668,3785],"content":"<bpt id=\"p1\">[</bpt>illegalPrepareConstrainedRegion<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/illegalprepareconstrainedregion-mda.md)</ept>","source":"[illegalPrepareConstrainedRegion](../../../docs/framework/debug-trace-profile/illegalprepareconstrainedregion-mda.md)"},{"pos":[3786,3895],"content":"<bpt id=\"p1\">[</bpt>invalidApartmentStateChange<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/invalidapartmentstatechange-mda.md)</ept>","source":"[invalidApartmentStateChange](../../../docs/framework/debug-trace-profile/invalidapartmentstatechange-mda.md)"},{"pos":[3898,3981],"content":"<bpt id=\"p1\">[</bpt>invalidCERCall<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/invalidcercall-mda.md)</ept>","source":"[invalidCERCall](../../../docs/framework/debug-trace-profile/invalidcercall-mda.md)"},{"pos":[3982,4101],"content":"<bpt id=\"p1\">[</bpt>invalidFunctionPointerInDelegate<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/invalidfunctionpointerindelegate-mda.md)</ept>","source":"[invalidFunctionPointerInDelegate](../../../docs/framework/debug-trace-profile/invalidfunctionpointerindelegate-mda.md)"},{"pos":[4104,4201],"content":"<bpt id=\"p1\">[</bpt>invalidGCHandleCookie<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/invalidgchandlecookie-mda.md)</ept>","source":"[invalidGCHandleCookie](../../../docs/framework/debug-trace-profile/invalidgchandlecookie-mda.md)"},{"pos":[4202,4287],"content":"<bpt id=\"p1\">[</bpt>invalidIUnknown<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/invalidiunknown-mda.md)</ept>","source":"[invalidIUnknown](../../../docs/framework/debug-trace-profile/invalidiunknown-mda.md)"},{"pos":[4290,4393],"content":"<bpt id=\"p1\">[</bpt>invalidMemberDeclaration<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/invalidmemberdeclaration-mda.md)</ept>","source":"[invalidMemberDeclaration](../../../docs/framework/debug-trace-profile/invalidmemberdeclaration-mda.md)"},{"pos":[4394,4501],"content":"<bpt id=\"p1\">[</bpt>invalidOverlappedToPinvoke<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/invalidoverlappedtopinvoke-mda.md)</ept>","source":"[invalidOverlappedToPinvoke](../../../docs/framework/debug-trace-profile/invalidoverlappedtopinvoke-mda.md)"},{"pos":[4504,4587],"content":"<bpt id=\"p1\">[</bpt>invalidVariant<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/invalidvariant-mda.md)</ept>","source":"[invalidVariant](../../../docs/framework/debug-trace-profile/invalidvariant-mda.md)"},{"pos":[4588,4681],"content":"<bpt id=\"p1\">[</bpt>jitCompilationStart<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/jitcompilationstart-mda.md)</ept>","source":"[jitCompilationStart](../../../docs/framework/debug-trace-profile/jitcompilationstart-mda.md)"},{"pos":[4684,4759],"content":"<bpt id=\"p1\">[</bpt>loaderLock<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/loaderlock-mda.md)</ept>","source":"[loaderLock](../../../docs/framework/debug-trace-profile/loaderlock-mda.md)"},{"pos":[4760,4845],"content":"<bpt id=\"p1\">[</bpt>loadFromContext<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/loadfromcontext-mda.md)</ept>","source":"[loadFromContext](../../../docs/framework/debug-trace-profile/loadfromcontext-mda.md)"},{"pos":[4848,4941],"content":"<bpt id=\"p1\">[</bpt>marshalCleanupError<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/marshalcleanuperror-mda.md)</ept>","source":"[marshalCleanupError](../../../docs/framework/debug-trace-profile/marshalcleanuperror-mda.md)"},{"pos":[4942,5017],"content":"<bpt id=\"p1\">[</bpt>marshaling<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/marshaling-mda.md)</ept>","source":"[marshaling](../../../docs/framework/debug-trace-profile/marshaling-mda.md)"},{"pos":[5020,5121],"content":"<bpt id=\"p1\">[</bpt>memberInfoCacheCreation<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/memberinfocachecreation-mda.md)</ept>","source":"[memberInfoCacheCreation](../../../docs/framework/debug-trace-profile/memberinfocachecreation-mda.md)"},{"pos":[5122,5217],"content":"<bpt id=\"p1\">[</bpt>moduloObjectHashcode<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/moduloobjecthashcode-mda.md)</ept>","source":"[moduloObjectHashcode](../../../docs/framework/debug-trace-profile/moduloobjecthashcode-mda.md)"},{"pos":[5220,5319],"content":"<bpt id=\"p1\">[</bpt>nonComVisibleBaseClass<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/noncomvisiblebaseclass-mda.md)</ept>","source":"[nonComVisibleBaseClass](../../../docs/framework/debug-trace-profile/noncomvisiblebaseclass-mda.md)"},{"pos":[5320,5403],"content":"<bpt id=\"p1\">[</bpt>notMarshalable<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/notmarshalable-mda.md)</ept>","source":"[notMarshalable](../../../docs/framework/debug-trace-profile/notmarshalable-mda.md)"},{"pos":[5406,5497],"content":"<bpt id=\"p1\">[</bpt>openGenericCERCall<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/opengenericcercall-mda.md)</ept>","source":"[openGenericCERCall](../../../docs/framework/debug-trace-profile/opengenericcercall-mda.md)"},{"pos":[5498,5591],"content":"<bpt id=\"p1\">[</bpt>overlappedFreeError<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/overlappedfreeerror-mda.md)</ept>","source":"[overlappedFreeError](../../../docs/framework/debug-trace-profile/overlappedfreeerror-mda.md)"},{"pos":[5594,5669],"content":"<bpt id=\"p1\">[</bpt>pInvokeLog<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/pinvokelog-mda.md)</ept>","source":"[pInvokeLog](../../../docs/framework/debug-trace-profile/pinvokelog-mda.md)"},{"pos":[5670,5767],"content":"<bpt id=\"p1\">[</bpt>pInvokeStackImbalance<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/pinvokestackimbalance-mda.md)</ept>","source":"[pInvokeStackImbalance](../../../docs/framework/debug-trace-profile/pinvokestackimbalance-mda.md)"},{"pos":[5770,5857],"content":"<bpt id=\"p1\">[</bpt>raceOnRCWCleanup<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/raceonrcwcleanup-mda.md)</ept>","source":"[raceOnRCWCleanup](../../../docs/framework/debug-trace-profile/raceonrcwcleanup-mda.md)"},{"pos":[5858,5933],"content":"<bpt id=\"p1\">[</bpt>reentrancy<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/reentrancy-mda.md)</ept>","source":"[reentrancy](../../../docs/framework/debug-trace-profile/reentrancy-mda.md)"},{"pos":[5936,6029],"content":"<bpt id=\"p1\">[</bpt>releaseHandleFailed<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/releasehandlefailed-mda.md)</ept>","source":"[releaseHandleFailed](../../../docs/framework/debug-trace-profile/releasehandlefailed-mda.md)"},{"pos":[6030,6125],"content":"<bpt id=\"p1\">[</bpt>reportAvOnComRelease<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/reportavoncomrelease-mda.md)</ept>","source":"[reportAvOnComRelease](../../../docs/framework/debug-trace-profile/reportavoncomrelease-mda.md)"},{"pos":[6128,6239],"content":"<bpt id=\"p1\">[</bpt>streamWriterBufferedDataLost<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/streamwriterbuffereddatalost-mda.md)</ept>","source":"[streamWriterBufferedDataLost](../../../docs/framework/debug-trace-profile/streamwriterbuffereddatalost-mda.md)"},{"pos":[6240,6323],"content":"<bpt id=\"p1\">[</bpt>virtualCERCall<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/virtualcercall-mda.md)</ept>","source":"[virtualCERCall](../../../docs/framework/debug-trace-profile/virtualcercall-mda.md)"},{"content":"By default, the .NET Framework activates a subset of MDAs for all managed debuggers.","pos":[6326,6410]},{"content":"You can view the default set in Visual Studio by choosing <bpt id=\"p1\">**</bpt>Windows<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Exception Settings<ept id=\"p2\">**</ept> on the <bpt id=\"p3\">**</bpt>Debug<ept id=\"p3\">**</ept> menu, and then expanding the <bpt id=\"p4\">**</bpt>Managed Debugging Assistants<ept id=\"p4\">**</ept> list.","pos":[6411,6590],"source":" You can view the default set in Visual Studio by choosing **Windows** > **Exception Settings** on the **Debug** menu, and then expanding the **Managed Debugging Assistants** list."},{"content":"Exception Settings window in Visual Studio","pos":[6594,6636]},{"pos":[6729,6752],"content":"Enable and Disable MDAs","linkify":"Enable and Disable MDAs","nodes":[{"content":"Enable and Disable MDAs","pos":[0,23]}]},{"content":"You can enable and disable MDAs by using a registry key, an environment variable, and application configuration settings.","pos":[6754,6875]},{"content":"You must enable either the registry key or the environment variable to use the application configuration settings.","pos":[6876,6990]},{"pos":[6994,7350],"content":"[!TIP]\nInstead of disabling MDAs, you can prevent Visual Studio from displaying the MDA dialog box whenever an MDA notification is received. To do that, choose **Windows** > **Exception Settings** on the **Debug** menu, expand the **Managed Debugging Assistants** list, and then select or clear the **Break When Thrown** check box for the individual MDA.","leadings":["","> "],"nodes":[{"content":"Instead of disabling MDAs, you can prevent Visual Studio from displaying the MDA dialog box whenever an MDA notification is received. To do that, choose **Windows** > **Exception Settings** on the **Debug** menu, expand the **Managed Debugging Assistants** list, and then select or clear the **Break When Thrown** check box for the individual MDA.","pos":[7,354],"nodes":[{"content":"Instead of disabling MDAs, you can prevent Visual Studio from displaying the MDA dialog box whenever an MDA notification is received.","pos":[0,133]},{"content":"To do that, choose <bpt id=\"p1\">**</bpt>Windows<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Exception Settings<ept id=\"p2\">**</ept> on the <bpt id=\"p3\">**</bpt>Debug<ept id=\"p3\">**</ept> menu, expand the <bpt id=\"p4\">**</bpt>Managed Debugging Assistants<ept id=\"p4\">**</ept> list, and then select or clear the <bpt id=\"p5\">**</bpt>Break When Thrown<ept id=\"p5\">**</ept> check box for the individual MDA.","pos":[134,347],"source":" To do that, choose **Windows** > **Exception Settings** on the **Debug** menu, expand the **Managed Debugging Assistants** list, and then select or clear the **Break When Thrown** check box for the individual MDA."}]}]},{"pos":[7356,7368],"content":"Registry Key","linkify":"Registry Key","nodes":[{"content":"Registry Key","pos":[0,12]}]},{"content":"To enable MDAs, add the <bpt id=\"p1\">**</bpt>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft<ph id=\"ph1\">\\\\</ph>.NETFramework\\MDA<ept id=\"p1\">**</ept> subkey (type REG_SZ, value 1) in the Windows registry.","pos":[7370,7509],"source":"To enable MDAs, add the **HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\\.NETFramework\\MDA** subkey (type REG_SZ, value 1) in the Windows registry."},{"content":"Copy the following example into a text file named <bpt id=\"p1\">*</bpt>MDAEnable.reg<ept id=\"p1\">*</ept>. Open the Windows Registry Editor (RegEdit.exe), and from the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu choose <bpt id=\"p3\">**</bpt>Import<ept id=\"p3\">**</ept>.","pos":[7510,7670],"source":" Copy the following example into a text file named *MDAEnable.reg*. Open the Windows Registry Editor (RegEdit.exe), and from the **File** menu choose **Import**."},{"content":"Select the <bpt id=\"p1\">*</bpt>MDAEnable.reg<ept id=\"p1\">*</ept> file to enable MDAs on that computer.","pos":[7671,7735],"source":" Select the *MDAEnable.reg* file to enable MDAs on that computer."},{"content":"Setting the subkey to string value of <bpt id=\"p1\">**</bpt>1<ept id=\"p1\">**</ept> (not DWORD value of <bpt id=\"p2\">**</bpt>1<ept id=\"p2\">**</ept>) enables the reading of MDA settings from the <bpt id=\"p3\">*</bpt>ApplicationName.suffix<ept id=\"p3\">*</ept>.mda.config file.","pos":[7736,7893],"source":" Setting the subkey to string value of **1** (not DWORD value of **1**) enables the reading of MDA settings from the *ApplicationName.suffix*.mda.config file."},{"content":"For example, the MDA configuration file for Notepad would be named notepad.exe.mda.config.","pos":[7894,7984]},{"content":"If the computer is running a 32-bit application on a 64-bit operating system, then the MDA key should be set like the following:","pos":[8101,8229]},{"content":"See <bpt id=\"p1\">[</bpt>Application-Specific Configuration Settings<ept id=\"p1\">](#application-specific-configuration-settings)</ept> for more information.","pos":[8358,8475],"source":"See [Application-Specific Configuration Settings](#application-specific-configuration-settings) for more information."},{"content":"The registry setting can be overridden by the COMPLUS_MDA environment variable.","pos":[8476,8555]},{"content":"See <bpt id=\"p1\">[</bpt>Environment Variable<ept id=\"p1\">](#environment-variable)</ept> for more information.","pos":[8556,8627],"source":" See [Environment Variable](#environment-variable) for more information."},{"pos":[8629,8715],"content":"To disable MDAs, set the MDA subkey to <bpt id=\"p1\">**</bpt>0<ept id=\"p1\">**</ept> (zero) using the Windows Registry Editor.","source":"To disable MDAs, set the MDA subkey to **0** (zero) using the Windows Registry Editor."},{"content":"By default, some MDAs are enabled when you run an application that is attached to a debugger, even without adding the registry key.","pos":[8717,8848]},{"content":"You can disable these assistants by running the <bpt id=\"p1\">*</bpt>MDADisable.reg<ept id=\"p1\">*</ept> file as described earlier in this section.","pos":[8849,8956],"source":" You can disable these assistants by running the *MDADisable.reg* file as described earlier in this section."},{"pos":[8962,8982],"content":"Environment Variable","linkify":"Environment Variable","nodes":[{"content":"Environment Variable","pos":[0,20]}]},{"content":"MDA activation can also controlled by the environment variable COMPLUS_MDA, which overrides the registry key.","pos":[8984,9093]},{"content":"The COMPLUS_MDA string is a case-insensitive, semicolon-delimited list of MDA names or other special control strings.","pos":[9094,9211]},{"content":"Starting under a managed or unmanaged debugger enables a set of MDAs by default.","pos":[9212,9292]},{"content":"This is done by implicitly prepending the semicolon-delimited list of MDAs enabled by default under debuggers to the value of the environment variable or registry key.","pos":[9293,9460]},{"content":"The special control strings are the following:","pos":[9461,9507]},{"pos":[9511,9538],"content":"<ph id=\"ph1\">`0`</ph> - Deactivates all MDAs.","source":"`0` - Deactivates all MDAs."},{"pos":[9542,9601],"content":"<ph id=\"ph1\">`1`</ph> - Reads MDA settings from <bpt id=\"p1\">*</bpt>ApplicationName<ept id=\"p1\">*</ept>.mda.config.","source":"`1` - Reads MDA settings from *ApplicationName*.mda.config."},{"pos":[9605,9739],"content":"<ph id=\"ph1\">`managedDebugger`</ph> - Explicitly activates all MDAs that are implicitly activated when a managed executable is started under a debugger.","source":"`managedDebugger` - Explicitly activates all MDAs that are implicitly activated when a managed executable is started under a debugger."},{"pos":[9743,9882],"content":"<ph id=\"ph1\">`unmanagedDebugger`</ph> - Explicitly activates all MDAs that are implicitly activated when an unmanaged executable is started under a debugger.","source":"`unmanagedDebugger` - Explicitly activates all MDAs that are implicitly activated when an unmanaged executable is started under a debugger."},{"content":"If there are conflicting settings, the most recent settings override previous settings:","pos":[9884,9971]},{"pos":[9975,10062],"content":"<ph id=\"ph1\">`COMPLUS_MDA=0`</ph> disables all MDAs, including those implicitly enabled under a debugger.","source":"`COMPLUS_MDA=0` disables all MDAs, including those implicitly enabled under a debugger."},{"pos":[10066,10201],"content":"<ph id=\"ph1\">`COMPLUS_MDA=gcUnmanagedToManaged`</ph> enables <ph id=\"ph2\">`gcUnmanagedToManaged`</ph> in addition to any MDAs that are implicitly enabled under a debugger.","source":"`COMPLUS_MDA=gcUnmanagedToManaged` enables `gcUnmanagedToManaged` in addition to any MDAs that are implicitly enabled under a debugger."},{"pos":[10205,10351],"content":"<ph id=\"ph1\">`COMPLUS_MDA=0;gcUnmanagedToManaged`</ph> enables <ph id=\"ph2\">`gcUnmanagedToManaged`</ph> but disables MDAs that would otherwise be implicitly enabled under a debugger.","source":"`COMPLUS_MDA=0;gcUnmanagedToManaged` enables `gcUnmanagedToManaged` but disables MDAs that would otherwise be implicitly enabled under a debugger."},{"pos":[10357,10400],"content":"Application-Specific Configuration Settings","linkify":"Application-Specific Configuration Settings","nodes":[{"content":"Application-Specific Configuration Settings","pos":[0,43]}]},{"content":"You can enable, disable, and configure some assistants individually in the MDA configuration file for the application.","pos":[10402,10520]},{"content":"To enable the use of an application configuration file for configuring MDAs, either the MDA registry key or the COMPLUS_MDA environment variable must be set.","pos":[10521,10678]},{"content":"The application configuration file is typically located in the same directory as the application's executable (.exe) file.","pos":[10679,10801]},{"content":"The file name takes the form <bpt id=\"p1\">*</bpt>ApplicationName<ept id=\"p1\">*</ept>.mda.config; for example, notepad.exe.mda.config. Assistants that are enabled in the application configuration file may have attributes or elements specifically designed to control that assistant's behavior.","pos":[10802,11055],"source":" The file name takes the form *ApplicationName*.mda.config; for example, notepad.exe.mda.config. Assistants that are enabled in the application configuration file may have attributes or elements specifically designed to control that assistant's behavior."},{"pos":[11057,11193],"content":"The following example shows how to enable and configure the <bpt id=\"p1\">[</bpt>marshaling<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/marshaling-mda.md)</ept>:","source":"The following example shows how to enable and configure the [marshaling](../../../docs/framework/debug-trace-profile/marshaling-mda.md):"},{"content":"The <ph id=\"ph1\">`Marshaling`</ph> MDA emits information about the managed type that is being marshaled to an unmanaged type for each managed-to-unmanaged transition in the application.","pos":[11434,11601],"source":"The `Marshaling` MDA emits information about the managed type that is being marshaled to an unmanaged type for each managed-to-unmanaged transition in the application."},{"content":"The <ph id=\"ph1\">`Marshaling`</ph> MDA can also filter the names of the method and structure fields supplied in the <bpt id=\"p1\">**</bpt>methodFilter<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>fieldFilter<ept id=\"p2\">**</ept> child elements, respectively.","pos":[11602,11766],"source":" The `Marshaling` MDA can also filter the names of the method and structure fields supplied in the **methodFilter** and **fieldFilter** child elements, respectively."},{"content":"The following example shows how to enable multiple MDAs by using their default settings:","pos":[11768,11856]},{"pos":[12041,12456],"content":"[!IMPORTANT]\nWhen you specify more than one assistant in a configuration file, you must list them in alphabetical order. For example, if you want to enable both the `virtualCERCall` and the `invalidCERCall` MDAs, you must add the `<invalidCERCall />` entry before the `<virtualCERCall />` entry. If the entries are not in alphabetical order, an unhandled invalid configuration file exception message is displayed.","leadings":["","> "],"nodes":[{"content":"When you specify more than one assistant in a configuration file, you must list them in alphabetical order. For example, if you want to enable both the `virtualCERCall` and the `invalidCERCall` MDAs, you must add the `<invalidCERCall />` entry before the `<virtualCERCall />` entry. If the entries are not in alphabetical order, an unhandled invalid configuration file exception message is displayed.","pos":[13,413],"nodes":[{"content":"When you specify more than one assistant in a configuration file, you must list them in alphabetical order.","pos":[0,107]},{"content":"For example, if you want to enable both the <ph id=\"ph1\">`virtualCERCall`</ph> and the <ph id=\"ph2\">`invalidCERCall`</ph> MDAs, you must add the <ph id=\"ph3\">`&lt;invalidCERCall /&gt;`</ph> entry before the <ph id=\"ph4\">`&lt;virtualCERCall /&gt;`</ph> entry.","pos":[108,282],"source":" For example, if you want to enable both the `virtualCERCall` and the `invalidCERCall` MDAs, you must add the `<invalidCERCall />` entry before the `<virtualCERCall />` entry."},{"content":"If the entries are not in alphabetical order, an unhandled invalid configuration file exception message is displayed.","pos":[283,400]}]}]},{"pos":[12461,12475],"content":"MDA exceptions","linkify":"MDA exceptions","nodes":[{"content":"MDA exceptions","pos":[0,14]}]},{"content":"When an MDA is enabled, it's active even when your code is not executing under a debugger.","pos":[12477,12567]},{"content":"If an MDA event is raised when a debugger is not present, the event message is presented in an unhandled exception dialog box, although it is not an unhandled exception.","pos":[12568,12737]},{"content":"To avoid the dialog box, remove the MDA-enabling settings when your code is not executing in a debugging environment.","pos":[12738,12855]},{"content":"When your code executes in the Visual Studio integrated development environment (IDE), you can avoid the exception dialog box that appears for specific MDA events.","pos":[12857,13020]},{"content":"To do that, on the <bpt id=\"p1\">**</bpt>Debug<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Windows<ept id=\"p2\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p3\">**</bpt>Exception Settings<ept id=\"p3\">**</ept>.","pos":[13021,13100],"source":" To do that, on the **Debug** menu, choose **Windows** > **Exception Settings**."},{"content":"In the <bpt id=\"p1\">**</bpt>Exception Settings<ept id=\"p1\">**</ept> window, expand the <bpt id=\"p2\">**</bpt>Managed Debugging Assistants<ept id=\"p2\">**</ept> list, and then clear the <bpt id=\"p3\">**</bpt>Break When Thrown<ept id=\"p3\">**</ept> check box for the individual MDA.","pos":[13101,13263],"source":" In the **Exception Settings** window, expand the **Managed Debugging Assistants** list, and then clear the **Break When Thrown** check box for the individual MDA."},{"content":"You can also use this dialog box to <bpt id=\"p1\">*</bpt>enable<ept id=\"p1\">*</ept> the display of MDA exception dialog boxes.","pos":[13264,13351],"source":" You can also use this dialog box to *enable* the display of MDA exception dialog boxes."},{"pos":[13356,13366],"content":"MDA Output","linkify":"MDA Output","nodes":[{"content":"MDA Output","pos":[0,10]}]},{"pos":[13368,13476],"content":"MDA output is similar to the following example, which shows the output from the <ph id=\"ph1\">`PInvokeStackImbalance`</ph> MDA:","source":"MDA output is similar to the following example, which shows the output from the `PInvokeStackImbalance` MDA:"},{"pos":[13478,13781],"content":"<bpt id=\"p1\">**</bpt>A call to PInvoke function 'MDATest!MDATest.Program::StdCall' has unbalanced the stack. This is likely because the managed PInvoke signature does not match the unmanaged target signature. Check that the calling convention and parameters of the PInvoke signature match the target unmanaged signature.<ept id=\"p1\">**</ept>","source":"**A call to PInvoke function 'MDATest!MDATest.Program::StdCall' has unbalanced the stack. This is likely because the managed PInvoke signature does not match the unmanaged target signature. Check that the calling convention and parameters of the PInvoke signature match the target unmanaged signature.**"},{"pos":[13786,13794],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[13798,13887],"content":"<bpt id=\"p1\">[</bpt>Debugging, Tracing, and Profiling<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/index.md)</ept>","source":"[Debugging, Tracing, and Profiling](../../../docs/framework/debug-trace-profile/index.md)"}]}