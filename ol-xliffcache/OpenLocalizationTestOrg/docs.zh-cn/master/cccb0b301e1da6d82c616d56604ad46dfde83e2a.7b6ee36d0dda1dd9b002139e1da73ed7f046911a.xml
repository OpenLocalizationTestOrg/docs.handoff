{"content":"---\ntitle: \"How to: Execute Expression Trees (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 9dfb5ab3-f48f-417e-975f-f8f6f1cdc18d\n---\n# How to: Execute Expression Trees (Visual Basic)\nThis topic shows you how to execute an expression tree. Executing an expression tree may return a value, or it may just perform an action such as calling a method.  \n  \n Only expression trees that represent lambda expressions can be executed. Expression trees that represent lambda expressions are of type <xref:System.Linq.Expressions.LambdaExpression> or <xref:System.Linq.Expressions.Expression%601>. To execute these expression trees, call the <xref:System.Linq.Expressions.LambdaExpression.Compile%2A> method to create an executable delegate, and then invoke the delegate.  \n  \n> [!NOTE]\n>  If the type of the delegate is not known, that is, the lambda expression is of type <xref:System.Linq.Expressions.LambdaExpression> and not <xref:System.Linq.Expressions.Expression%601>, you must call the <xref:System.Delegate.DynamicInvoke%2A> method on the delegate instead of invoking it directly.  \n  \n If an expression tree does not represent a lambda expression, you can create a new lambda expression that has the original expression tree as its body, by calling the <xref:System.Linq.Expressions.Expression.Lambda%60%601%28System.Linq.Expressions.Expression%2CSystem.Collections.Generic.IEnumerable%7BSystem.Linq.Expressions.ParameterExpression%7D%29> method. Then, you can execute the lambda expression as described earlier in this section.  \n  \n## Example  \n The following code example demonstrates how to execute an expression tree that represents raising a number to a power by creating a lambda expression and executing it. The result, which represents the number raised to the power, is displayed.  \n  \n```vb  \n' The expression tree to execute.  \nDim be As BinaryExpression = Expression.Power(Expression.Constant(2.0R), Expression.Constant(3.0R))  \n  \n' Create a lambda expression.  \nDim le As Expression(Of Func(Of Double)) = Expression.Lambda(Of Func(Of Double))(be)  \n  \n' Compile the lambda expression.  \nDim compiledExpression As Func(Of Double) = le.Compile()  \n  \n' Execute the lambda expression.  \nDim result As Double = compiledExpression()  \n  \n' Display the result.  \nMsgBox(result)  \n  \n' This code produces the following output:  \n' 8  \n```  \n  \n## Compiling the Code  \n  \n-   Add a project reference to System.Core.dll if it is not already referenced.  \n  \n-   Include the System.Linq.Expressions namespace.  \n  \n## See also\n\n- [Expression Trees (Visual Basic)](../../../../visual-basic/programming-guide/concepts/expression-trees/index.md)\n- [How to: Modify Expression Trees (Visual Basic)](../../../../visual-basic/programming-guide/concepts/expression-trees/how-to-modify-expression-trees.md)\n","nodes":[{"pos":[4,129],"embed":true,"restype":"x-metadata","content":"title: \"How to: Execute Expression Trees (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 9dfb5ab3-f48f-417e-975f-f8f6f1cdc18d","nodes":[{"content":"How to: Execute Expression Trees (Visual Basic)","nodes":[{"pos":[0,47],"content":"How to: Execute Expression Trees (Visual Basic)","nodes":[{"content":"How to: Execute Expression Trees (Visual Basic)","pos":[0,47]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[136,183],"content":"How to: Execute Expression Trees (Visual Basic)","linkify":"How to: Execute Expression Trees (Visual Basic)","nodes":[{"content":"How to: Execute Expression Trees (Visual Basic)","pos":[0,47]}]},{"content":"This topic shows you how to execute an expression tree.","pos":[184,239]},{"content":"Executing an expression tree may return a value, or it may just perform an action such as calling a method.","pos":[240,347]},{"content":"Only expression trees that represent lambda expressions can be executed.","pos":[354,426]},{"content":"Expression trees that represent lambda expressions are of type <ph id=\"ph1\">&lt;xref:System.Linq.Expressions.LambdaExpression&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Linq.Expressions.Expression%601&gt;</ph>.","pos":[427,587],"source":" Expression trees that represent lambda expressions are of type <xref:System.Linq.Expressions.LambdaExpression> or <xref:System.Linq.Expressions.Expression%601>."},{"content":"To execute these expression trees, call the <ph id=\"ph1\">&lt;xref:System.Linq.Expressions.LambdaExpression.Compile%2A&gt;</ph> method to create an executable delegate, and then invoke the delegate.","pos":[588,761],"source":" To execute these expression trees, call the <xref:System.Linq.Expressions.LambdaExpression.Compile%2A> method to create an executable delegate, and then invoke the delegate."},{"pos":[769,1080],"content":"[!NOTE]\n If the type of the delegate is not known, that is, the lambda expression is of type <xref:System.Linq.Expressions.LambdaExpression> and not <xref:System.Linq.Expressions.Expression%601>, you must call the <xref:System.Delegate.DynamicInvoke%2A> method on the delegate instead of invoking it directly.","leadings":["","> "],"nodes":[{"content":"If the type of the delegate is not known, that is, the lambda expression is of type <ph id=\"ph1\">&lt;xref:System.Linq.Expressions.LambdaExpression&gt;</ph> and not <ph id=\"ph2\">&lt;xref:System.Linq.Expressions.Expression%601&gt;</ph>, you must call the <ph id=\"ph3\">&lt;xref:System.Delegate.DynamicInvoke%2A&gt;</ph> method on the delegate instead of invoking it directly.","pos":[9,309],"source":"If the type of the delegate is not known, that is, the lambda expression is of type <xref:System.Linq.Expressions.LambdaExpression> and not <xref:System.Linq.Expressions.Expression%601>, you must call the <xref:System.Delegate.DynamicInvoke%2A> method on the delegate instead of invoking it directly."}]},{"content":"If an expression tree does not represent a lambda expression, you can create a new lambda expression that has the original expression tree as its body, by calling the <ph id=\"ph1\">&lt;xref:System.Linq.Expressions.Expression.Lambda%60%601%28System.Linq.Expressions.Expression%2CSystem.Collections.Generic.IEnumerable%7BSystem.Linq.Expressions.ParameterExpression%7D%29&gt;</ph> method.","pos":[1087,1447],"source":"If an expression tree does not represent a lambda expression, you can create a new lambda expression that has the original expression tree as its body, by calling the <xref:System.Linq.Expressions.Expression.Lambda%60%601%28System.Linq.Expressions.Expression%2CSystem.Collections.Generic.IEnumerable%7BSystem.Linq.Expressions.ParameterExpression%7D%29> method."},{"content":"Then, you can execute the lambda expression as described earlier in this section.","pos":[1448,1529]},{"pos":[1538,1545],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example demonstrates how to execute an expression tree that represents raising a number to a power by creating a lambda expression and executing it.","pos":[1549,1716]},{"content":"The result, which represents the number raised to the power, is displayed.","pos":[1717,1791]},{"pos":[2356,2374],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"Add a project reference to System.Core.dll if it is not already referenced.","pos":[2384,2459]},{"content":"Include the System.Linq.Expressions namespace.","pos":[2469,2515]},{"pos":[2524,2532],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2536,2648],"content":"<bpt id=\"p1\">[</bpt>Expression Trees (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/expression-trees/index.md)</ept>","source":"[Expression Trees (Visual Basic)](../../../../visual-basic/programming-guide/concepts/expression-trees/index.md)"},{"pos":[2651,2803],"content":"<bpt id=\"p1\">[</bpt>How to: Modify Expression Trees (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/expression-trees/how-to-modify-expression-trees.md)</ept>","source":"[How to: Modify Expression Trees (Visual Basic)](../../../../visual-basic/programming-guide/concepts/expression-trees/how-to-modify-expression-trees.md)"}]}