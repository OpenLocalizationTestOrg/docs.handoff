{"content":"---\ntitle: \"ICorProfilerCallback3::ProfilerDetachSucceeded Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICorProfilerCallback3.ProfilerDetachSucceeded Method\"\napi_location: \n  - \"mscorwks.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICorProfilerCallback3::ProfilerDetachSucceeded\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ProfilerDetachSucceeded method [.NET Framework profiling]\"\n  - \"ICorProfilerCallback3::ProfilerDetachSucceeded method [.NET Framework profiling]\"\nms.assetid: 05164966-16ce-4cc9-a530-43a640c00711\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 11\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# ICorProfilerCallback3::ProfilerDetachSucceeded Method\nNotifies the profiler that the common language runtime (CLR) is about to unload the profiler DLL.  \n  \n## Syntax  \n  \n```  \nHRESULT ProfilerDetachSucceeded();  \n```  \n  \n## Return Value  \n The return value from this callback is ignored.  \n  \n## Remarks  \n The `ProfilerDetachSucceeded` callback is issued after all threads have exited the profiler's code. When this method is called, the profiler should perform any last-minute tasks that are not appropriate for its destructor, such as notifying its UI or logging component. However, the profiler must not call functions on interfaces that are provided by the CLR during this callback (such as the [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) or `IMetaData*` interfaces).  \n  \n The CLR creates an entry in the Windows Application event log to indicate that the detach operation is successful.  \n  \n After the profiler returns from this callback, the CLR releases the profiler object and unloads the profiler DLL. Therefore, the profiler must not perform any actions that would cause execution to occur inside the profiler DLL after it returns from this callback. For example, it must not create threads or register timer callbacks.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** CorProf.idl, CorProf.h  \n  \n **Library:** CorGuids.lib  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See Also  \n [Metadata Interfaces](../../../../docs/framework/unmanaged-api/metadata/metadata-interfaces.md)   \n [ICorProfilerInfo3 Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-interface.md)   \n [Profiling Interfaces](../../../../docs/framework/unmanaged-api/profiling/profiling-interfaces.md)   \n [Profiling](../../../../docs/framework/unmanaged-api/profiling/index.md)","nodes":[{"pos":[12,82],"content":"ICorProfilerCallback3::ProfilerDetachSucceeded Method | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ICorProfilerCallback3::ProfilerDetachSucceeded Method | Microsoft Docs","pos":[0,70]}]},{"pos":[798,851],"content":"ICorProfilerCallback3::ProfilerDetachSucceeded Method","linkify":"ICorProfilerCallback3::ProfilerDetachSucceeded Method","nodes":[{"content":"ICorProfilerCallback3::ProfilerDetachSucceeded Method","pos":[0,53]}]},{"content":"Notifies the profiler that the common language runtime (CLR) is about to unload the profiler DLL.","pos":[852,949]},{"pos":[958,964],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1025,1037],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The return value from this callback is ignored.","pos":[1041,1088]},{"pos":[1097,1104],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`ProfilerDetachSucceeded`</ph> callback is issued after all threads have exited the profiler's code.","pos":[1108,1207],"source":"The `ProfilerDetachSucceeded` callback is issued after all threads have exited the profiler's code."},{"content":"When this method is called, the profiler should perform any last-minute tasks that are not appropriate for its destructor, such as notifying its UI or logging component.","pos":[1208,1377]},{"content":"However, the profiler must not call functions on interfaces that are provided by the CLR during this callback (such as the <bpt id=\"p1\">[</bpt>ICorProfilerInfo<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md)</ept> or <ph id=\"ph1\">`IMetaData*`</ph> interfaces).","pos":[1378,1630],"source":" However, the profiler must not call functions on interfaces that are provided by the CLR during this callback (such as the [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) or `IMetaData*` interfaces)."},{"content":"The CLR creates an entry in the Windows Application event log to indicate that the detach operation is successful.","pos":[1637,1751]},{"content":"After the profiler returns from this callback, the CLR releases the profiler object and unloads the profiler DLL.","pos":[1758,1871]},{"content":"Therefore, the profiler must not perform any actions that would cause execution to occur inside the profiler DLL after it returns from this callback.","pos":[1872,2021]},{"content":"For example, it must not create threads or register timer callbacks.","pos":[2022,2090]},{"pos":[2099,2111],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2115,2219],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2226,2260],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> CorProf.idl, CorProf.h","source":"**Header:** CorProf.idl, CorProf.h"},{"pos":[2267,2292],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> CorGuids.lib","source":"**Library:** CorGuids.lib"},{"pos":[2299,2407],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[2416,2424],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Metadata Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/metadata-interfaces.md)</ept><ph id=\"ph1\"> </ph>","pos":[2428,2524],"source":"[Metadata Interfaces](../../../../docs/framework/unmanaged-api/metadata/metadata-interfaces.md) "},{"content":"<bpt id=\"p1\"> [</bpt>ICorProfilerInfo3 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[2527,2641],"source":" [ICorProfilerInfo3 Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo3-interface.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Profiling Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/profiling-interfaces.md)</ept><ph id=\"ph1\"> </ph>","pos":[2644,2744],"source":" [Profiling Interfaces](../../../../docs/framework/unmanaged-api/profiling/profiling-interfaces.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Profiling<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/index.md)</ept>","pos":[2747,2820],"source":" [Profiling](../../../../docs/framework/unmanaged-api/profiling/index.md)"}]}