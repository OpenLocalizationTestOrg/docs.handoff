{"content":"---\ntitle: \"How to: Hook Up a Command to a Control with Command Support\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"Control class [WPF], attaching a RoutedCommand\"\n  - \"classes [WPF], Control [WPF], attaching a RoutedCommand\"\n  - \"RoutedCommand class [WPF], attaching to a Control\"\n  - \"classes [WPF], RoutedCommand [WPF], attaching to a Control\"\nms.assetid: 8d8592ae-0c91-469e-a1cd-d179c4544548\n---\n# How to: Hook Up a Command to a Control with Command Support\nThe following example shows how to hook up a <xref:System.Windows.Input.RoutedCommand> to a <xref:System.Windows.Controls.Control> which has built in support for the command.  For a complete sample which hooks up commands to multiple sources, see the [Create a Custom RoutedCommand Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand) sample.  \n  \n## Example  \n [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides a library of common commands which application programmers encounter regularly.  The classes which comprise the command library are: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.ComponentCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, and <xref:System.Windows.Documents.EditingCommands>.  \n  \n The static <xref:System.Windows.Input.RoutedCommand> objects which make up these classes do not supply command logic.  The logic for the command is associated with the command with a <xref:System.Windows.Input.CommandBinding>.  Some controls have built in CommandBindings for some commands.  This mechanism allows the semantics of a command to stay the same, while the actual implementation is can change.  A <xref:System.Windows.Controls.TextBox>, for example, handles the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command differently than a control designed to support images, but the basic idea of what it means to paste something stays the same.  The command logic cannot be supplied by the command, but rather must be supplied by the control or the application.  \n  \n Many controls in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] do have built in support for some of the commands in the command library.  <xref:System.Windows.Controls.TextBox>, for example, supports many of the application edit commands such as <xref:System.Windows.Input.ApplicationCommands.Paste%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Redo%2A>, and <xref:System.Windows.Input.ApplicationCommands.Undo%2A>.  The application developer does not have to do anything special to get these commands to work with these controls.  If the <xref:System.Windows.Controls.TextBox> is the command target when the command is executed, it will handle the command using the <xref:System.Windows.Input.CommandBinding> that is built into the control.  \n  \n The following shows how to use a <xref:System.Windows.Controls.MenuItem> as the command source for the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command, where a <xref:System.Windows.Controls.TextBox> is the target of the command.  All the logic that defines how the <xref:System.Windows.Controls.TextBox> performs the paste is built into the <xref:System.Windows.Controls.TextBox> control.  \n  \n A <xref:System.Windows.Controls.MenuItem> is created and it's <xref:System.Windows.Controls.MenuItem.Command%2A> property is set to the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command.  The <xref:System.Windows.Controls.MenuItem.CommandTarget%2A> is not explicitly set to the <xref:System.Windows.Controls.TextBox> object.  When the  <xref:System.Windows.Controls.MenuItem.CommandTarget%2A> is not set, the target for the command is the element which has keyboard focus.  If the element which has keyboard focus does not support the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command or cannot currently execute the paste command (the clipboard is empty, for example) then the <xref:System.Windows.Controls.MenuItem> would be grayed out.  \n  \n [!code-xaml[MenuItemCommandTask_XAML#MenuItemCommanding](~/samples/snippets/csharp/VS_Snippets_Wpf/MenuItemCommandTask_XAML/CS/Window1.xaml#menuitemcommanding)]  \n  \n [!code-csharp[MenuItemCommandTask#MenuItemCommandingCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/MenuItemCommandTask/CSharp/Window1.xaml.cs#menuitemcommandingcodebehind)]\n [!code-vb[MenuItemCommandTask#MenuItemCommandingCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/MenuItemCommandTask/VisualBasic/Window1.xaml.vb#menuitemcommandingcodebehind)]  \n  \n## See also\n\n- [Commanding Overview](commanding-overview.md)\n- [Hook Up a Command to a Control with No Command Support](how-to-hook-up-a-command-to-a-control-with-no-command-support.md)\n","nodes":[{"pos":[4,435],"embed":true,"restype":"x-metadata","content":"title: \"How to: Hook Up a Command to a Control with Command Support\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"Control class [WPF], attaching a RoutedCommand\"\n  - \"classes [WPF], Control [WPF], attaching a RoutedCommand\"\n  - \"RoutedCommand class [WPF], attaching to a Control\"\n  - \"classes [WPF], RoutedCommand [WPF], attaching to a Control\"\nms.assetid: 8d8592ae-0c91-469e-a1cd-d179c4544548","nodes":[{"content":"How to: Hook Up a Command to a Control with Command Support","nodes":[{"pos":[0,59],"content":"How to: Hook Up a Command to a Control with Command Support","nodes":[{"content":"How to: Hook Up a Command to a Control with Command Support","pos":[0,59]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[442,501],"content":"How to: Hook Up a Command to a Control with Command Support","linkify":"How to: Hook Up a Command to a Control with Command Support","nodes":[{"content":"How to: Hook Up a Command to a Control with Command Support","pos":[0,59]}]},{"content":"The following example shows how to hook up a <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> to a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Control&gt;</ph> which has built in support for the command.","pos":[502,676],"source":"The following example shows how to hook up a <xref:System.Windows.Input.RoutedCommand> to a <xref:System.Windows.Controls.Control> which has built in support for the command."},{"content":"For a complete sample which hooks up commands to multiple sources, see the <bpt id=\"p1\">[</bpt>Create a Custom RoutedCommand Sample<ept id=\"p1\">](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand)</ept> sample.","pos":[678,896],"source":"  For a complete sample which hooks up commands to multiple sources, see the [Create a Custom RoutedCommand Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand) sample."},{"pos":[905,912],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> provides a library of common commands which application programmers encounter regularly.","pos":[916,1084],"source":"[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides a library of common commands which application programmers encounter regularly."},{"content":"The classes which comprise the command library are: <ph id=\"ph1\">&lt;xref:System.Windows.Input.ApplicationCommands&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Input.ComponentCommands&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Input.NavigationCommands&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Input.MediaCommands&gt;</ph>, and <ph id=\"ph5\">&lt;xref:System.Windows.Documents.EditingCommands&gt;</ph>.","pos":[1086,1377],"source":"  The classes which comprise the command library are: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.ComponentCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, and <xref:System.Windows.Documents.EditingCommands>."},{"content":"The static <ph id=\"ph1\">&lt;xref:System.Windows.Input.RoutedCommand&gt;</ph> objects which make up these classes do not supply command logic.","pos":[1384,1501],"source":"The static <xref:System.Windows.Input.RoutedCommand> objects which make up these classes do not supply command logic."},{"content":"The logic for the command is associated with the command with a <ph id=\"ph1\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph>.","pos":[1503,1610],"source":"  The logic for the command is associated with the command with a <xref:System.Windows.Input.CommandBinding>."},{"content":"Some controls have built in CommandBindings for some commands.","pos":[1612,1674]},{"content":"This mechanism allows the semantics of a command to stay the same, while the actual implementation is can change.","pos":[1676,1789]},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph>, for example, handles the <ph id=\"ph2\">&lt;xref:System.Windows.Input.ApplicationCommands.Paste%2A&gt;</ph> command differently than a control designed to support images, but the basic idea of what it means to paste something stays the same.","pos":[1791,2048],"source":"  A <xref:System.Windows.Controls.TextBox>, for example, handles the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command differently than a control designed to support images, but the basic idea of what it means to paste something stays the same."},{"content":"The command logic cannot be supplied by the command, but rather must be supplied by the control or the application.","pos":[2050,2165]},{"content":"Many controls in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> do have built in support for some of the commands in the command library.","pos":[2172,2344],"source":"Many controls in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] do have built in support for some of the commands in the command library."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph>, for example, supports many of the application edit commands such as <ph id=\"ph2\">&lt;xref:System.Windows.Input.ApplicationCommands.Paste%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Input.ApplicationCommands.Copy%2A&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Windows.Input.ApplicationCommands.Cut%2A&gt;</ph>, <ph id=\"ph5\">&lt;xref:System.Windows.Input.ApplicationCommands.Redo%2A&gt;</ph>, and <ph id=\"ph6\">&lt;xref:System.Windows.Input.ApplicationCommands.Undo%2A&gt;</ph>.","pos":[2346,2742],"source":"<xref:System.Windows.Controls.TextBox>, for example, supports many of the application edit commands such as <xref:System.Windows.Input.ApplicationCommands.Paste%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Redo%2A>, and <xref:System.Windows.Input.ApplicationCommands.Undo%2A>."},{"content":"The application developer does not have to do anything special to get these commands to work with these controls.","pos":[2744,2857]},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> is the command target when the command is executed, it will handle the command using the <ph id=\"ph2\">&lt;xref:System.Windows.Input.CommandBinding&gt;</ph> that is built into the control.","pos":[2859,3068],"source":"  If the <xref:System.Windows.Controls.TextBox> is the command target when the command is executed, it will handle the command using the <xref:System.Windows.Input.CommandBinding> that is built into the control."},{"content":"The following shows how to use a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph> as the command source for the <ph id=\"ph2\">&lt;xref:System.Windows.Input.ApplicationCommands.Paste%2A&gt;</ph> command, where a <ph id=\"ph3\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> is the target of the command.","pos":[3075,3320],"source":"The following shows how to use a <xref:System.Windows.Controls.MenuItem> as the command source for the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command, where a <xref:System.Windows.Controls.TextBox> is the target of the command."},{"content":"All the logic that defines how the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> performs the paste is built into the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> control.","pos":[3322,3480],"source":"  All the logic that defines how the <xref:System.Windows.Controls.TextBox> performs the paste is built into the <xref:System.Windows.Controls.TextBox> control."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph> is created and it's <ph id=\"ph2\">&lt;xref:System.Windows.Controls.MenuItem.Command%2A&gt;</ph> property is set to the <ph id=\"ph3\">&lt;xref:System.Windows.Input.ApplicationCommands.Paste%2A&gt;</ph> command.","pos":[3487,3688],"source":"A <xref:System.Windows.Controls.MenuItem> is created and it's <xref:System.Windows.Controls.MenuItem.Command%2A> property is set to the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem.CommandTarget%2A&gt;</ph> is not explicitly set to the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> object.","pos":[3690,3826],"source":"  The <xref:System.Windows.Controls.MenuItem.CommandTarget%2A> is not explicitly set to the <xref:System.Windows.Controls.TextBox> object."},{"content":"When the  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.MenuItem.CommandTarget%2A&gt;</ph> is not set, the target for the command is the element which has keyboard focus.","pos":[3828,3974],"source":"  When the  <xref:System.Windows.Controls.MenuItem.CommandTarget%2A> is not set, the target for the command is the element which has keyboard focus."},{"content":"If the element which has keyboard focus does not support the <ph id=\"ph1\">&lt;xref:System.Windows.Input.ApplicationCommands.Paste%2A&gt;</ph> command or cannot currently execute the paste command (the clipboard is empty, for example) then the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.MenuItem&gt;</ph> would be grayed out.","pos":[3976,4255],"source":"  If the element which has keyboard focus does not support the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command or cannot currently execute the paste command (the clipboard is empty, for example) then the <xref:System.Windows.Controls.MenuItem> would be grayed out."},{"pos":[4804,4812],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4816,4861],"content":"<bpt id=\"p1\">[</bpt>Commanding Overview<ept id=\"p1\">](commanding-overview.md)</ept>","source":"[Commanding Overview](commanding-overview.md)"},{"pos":[4864,4986],"content":"<bpt id=\"p1\">[</bpt>Hook Up a Command to a Control with No Command Support<ept id=\"p1\">](how-to-hook-up-a-command-to-a-control-with-no-command-support.md)</ept>","source":"[Hook Up a Command to a Control with No Command Support](how-to-hook-up-a-command-to-a-control-with-no-command-support.md)"}]}