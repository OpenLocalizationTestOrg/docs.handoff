{"content":"---\ntitle: \"How to: Create a Copy of a File in a Different Directory in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"My.Computer.FileSystem.CopyFile method, copying files [Visual Basic]\"\n  - \"files [Visual Basic], copying\"\n  - \"CopyFile method [Visual Basic], copying files in Visual Basic\"\n  - \"I/O [Visual Basic], copying files\"\nms.assetid: 88e2145c-d414-45a5-ad03-6f5d58ecca26\n---\n# How to: Create a Copy of a File in a Different Directory in Visual Basic\nThe `My.Computer.FileSystem.CopyFile` method allows you to copy files. Its parameters provide the ability to overwrite existing files, rename the file, show the progress of the operation, and allow the user to cancel the operation.  \n  \n### To copy a text file to another folder  \n  \n-   Use the `CopyFile` method to copy a file, specifying a source file and the target directory. The `overwrite` parameter allows you to specify whether or not to overwrite existing files. The following code examples demonstrate how to use `CopyFile`.  \n  \n     [!code-vb[VbFileIOMisc#24](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbFileIOMisc/VB/Class1.vb#24)]  \n  \n## Robust Programming  \n The following conditions may cause an exception to be thrown:  \n  \n-   The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with \\\\\\\\.\\\\) (<xref:System.ArgumentException>).  \n  \n-   The system could not retrieve the absolute path (<xref:System.ArgumentException>).  \n  \n-   The path is not valid because it is `Nothing` (<xref:System.ArgumentNullException>).  \n  \n-   The source file is not valid or does not exist (<xref:System.IO.FileNotFoundException>).  \n  \n-   The combined path points to an existing directory (<xref:System.IO.IOException>).  \n  \n-   The destination file exists and `overwrite` is set to `False` (<xref:System.IO.IOException>).  \n  \n-   The user does not have sufficient permissions to access the file (<xref:System.IO.IOException>).  \n  \n-   A file in the target folder with the same name is in use (<xref:System.IO.IOException>).  \n  \n-   A file or folder name in the path contains a colon (:) or is in an invalid format (<xref:System.NotSupportedException>).  \n  \n-   `ShowUI` is set to `True`, `onUserCancel` is set to `ThrowException`, and the user has cancelled the operation (<xref:System.OperationCanceledException>).  \n  \n-   `ShowUI` is set to `True`, `onUserCancel` is set to `ThrowException`, and an unspecified I/O error occurs (<xref:System.OperationCanceledException>).  \n  \n-   The path exceeds the system-defined maximum length (<xref:System.IO.PathTooLongException>).  \n  \n-   The user does not have required permission (<xref:System.UnauthorizedAccessException>).  \n  \n-   The user lacks necessary permissions to view the path (<xref:System.Security.SecurityException>).  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.FileIO.FileSystem>\n- <xref:Microsoft.VisualBasic.FileIO.FileSystem.CopyFile%2A>\n- <xref:Microsoft.VisualBasic.FileIO.UICancelOption>\n- [How to: Copy Files with a Specific Pattern to a Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory.md)\n- [How to: Create a Copy of a File in the Same Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md)\n- [How to: Copy a Directory to Another Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md)\n- [How to: Rename a File](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md)\n","nodes":[{"pos":[4,395],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create a Copy of a File in a Different Directory in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"My.Computer.FileSystem.CopyFile method, copying files [Visual Basic]\"\n  - \"files [Visual Basic], copying\"\n  - \"CopyFile method [Visual Basic], copying files in Visual Basic\"\n  - \"I/O [Visual Basic], copying files\"\nms.assetid: 88e2145c-d414-45a5-ad03-6f5d58ecca26","nodes":[{"content":"How to: Create a Copy of a File in a Different Directory in Visual Basic","nodes":[{"pos":[0,72],"content":"How to: Create a Copy of a File in a Different Directory in Visual Basic","nodes":[{"content":"How to: Create a Copy of a File in a Different Directory in Visual Basic","pos":[0,72]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[402,474],"content":"How to: Create a Copy of a File in a Different Directory in Visual Basic","linkify":"How to: Create a Copy of a File in a Different Directory in Visual Basic","nodes":[{"content":"How to: Create a Copy of a File in a Different Directory in Visual Basic","pos":[0,72]}]},{"content":"The <ph id=\"ph1\">`My.Computer.FileSystem.CopyFile`</ph> method allows you to copy files.","pos":[475,545],"source":"The `My.Computer.FileSystem.CopyFile` method allows you to copy files."},{"content":"Its parameters provide the ability to overwrite existing files, rename the file, show the progress of the operation, and allow the user to cancel the operation.","pos":[546,706]},{"pos":[716,753],"content":"To copy a text file to another folder","linkify":"To copy a text file to another folder","nodes":[{"content":"To copy a text file to another folder","pos":[0,37]}]},{"content":"Use the <ph id=\"ph1\">`CopyFile`</ph> method to copy a file, specifying a source file and the target directory.","pos":[763,855],"source":"Use the `CopyFile` method to copy a file, specifying a source file and the target directory."},{"content":"The <ph id=\"ph1\">`overwrite`</ph> parameter allows you to specify whether or not to overwrite existing files.","pos":[856,947],"source":" The `overwrite` parameter allows you to specify whether or not to overwrite existing files."},{"content":"The following code examples demonstrate how to use <ph id=\"ph1\">`CopyFile`</ph>.","pos":[948,1010],"source":" The following code examples demonstrate how to use `CopyFile`."},{"pos":[1139,1157],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"The following conditions may cause an exception to be thrown:","pos":[1161,1222]},{"pos":[1232,1457],"content":"The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with <ph id=\"ph1\">\\\\</ph><ph id=\"ph2\">\\\\</ph>.<ph id=\"ph3\">\\\\</ph>) (<ph id=\"ph4\">&lt;xref:System.ArgumentException&gt;</ph>).","source":"The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with \\\\\\\\.\\\\) (<xref:System.ArgumentException>)."},{"pos":[1467,1549],"content":"The system could not retrieve the absolute path (<ph id=\"ph1\">&lt;xref:System.ArgumentException&gt;</ph>).","source":"The system could not retrieve the absolute path (<xref:System.ArgumentException>)."},{"pos":[1559,1643],"content":"The path is not valid because it is <ph id=\"ph1\">`Nothing`</ph> (<ph id=\"ph2\">&lt;xref:System.ArgumentNullException&gt;</ph>).","source":"The path is not valid because it is `Nothing` (<xref:System.ArgumentNullException>)."},{"pos":[1653,1741],"content":"The source file is not valid or does not exist (<ph id=\"ph1\">&lt;xref:System.IO.FileNotFoundException&gt;</ph>).","source":"The source file is not valid or does not exist (<xref:System.IO.FileNotFoundException>)."},{"pos":[1751,1832],"content":"The combined path points to an existing directory (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"The combined path points to an existing directory (<xref:System.IO.IOException>)."},{"pos":[1842,1935],"content":"The destination file exists and <ph id=\"ph1\">`overwrite`</ph> is set to <ph id=\"ph2\">`False`</ph> (<ph id=\"ph3\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"The destination file exists and `overwrite` is set to `False` (<xref:System.IO.IOException>)."},{"pos":[1945,2041],"content":"The user does not have sufficient permissions to access the file (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"The user does not have sufficient permissions to access the file (<xref:System.IO.IOException>)."},{"pos":[2051,2139],"content":"A file in the target folder with the same name is in use (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"A file in the target folder with the same name is in use (<xref:System.IO.IOException>)."},{"pos":[2149,2269],"content":"A file or folder name in the path contains a colon (:) or is in an invalid format (<ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph>).","source":"A file or folder name in the path contains a colon (:) or is in an invalid format (<xref:System.NotSupportedException>)."},{"pos":[2279,2433],"content":"<ph id=\"ph1\">`ShowUI`</ph> is set to <ph id=\"ph2\">`True`</ph>, <ph id=\"ph3\">`onUserCancel`</ph> is set to <ph id=\"ph4\">`ThrowException`</ph>, and the user has cancelled the operation (<ph id=\"ph5\">&lt;xref:System.OperationCanceledException&gt;</ph>).","source":"`ShowUI` is set to `True`, `onUserCancel` is set to `ThrowException`, and the user has cancelled the operation (<xref:System.OperationCanceledException>)."},{"pos":[2443,2592],"content":"<ph id=\"ph1\">`ShowUI`</ph> is set to <ph id=\"ph2\">`True`</ph>, <ph id=\"ph3\">`onUserCancel`</ph> is set to <ph id=\"ph4\">`ThrowException`</ph>, and an unspecified I/O error occurs (<ph id=\"ph5\">&lt;xref:System.OperationCanceledException&gt;</ph>).","source":"`ShowUI` is set to `True`, `onUserCancel` is set to `ThrowException`, and an unspecified I/O error occurs (<xref:System.OperationCanceledException>)."},{"pos":[2602,2693],"content":"The path exceeds the system-defined maximum length (<ph id=\"ph1\">&lt;xref:System.IO.PathTooLongException&gt;</ph>).","source":"The path exceeds the system-defined maximum length (<xref:System.IO.PathTooLongException>)."},{"pos":[2703,2790],"content":"The user does not have required permission (<ph id=\"ph1\">&lt;xref:System.UnauthorizedAccessException&gt;</ph>).","source":"The user does not have required permission (<xref:System.UnauthorizedAccessException>)."},{"pos":[2800,2897],"content":"The user lacks necessary permissions to view the path (<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","source":"The user lacks necessary permissions to view the path (<xref:System.Security.SecurityException>)."},{"pos":[2906,2914],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3081,3279],"content":"<bpt id=\"p1\">[</bpt>How to: Copy Files with a Specific Pattern to a Directory<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory.md)</ept>","source":"[How to: Copy Files with a Specific Pattern to a Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory.md)"},{"pos":[3282,3472],"content":"<bpt id=\"p1\">[</bpt>How to: Create a Copy of a File in the Same Directory<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md)</ept>","source":"[How to: Create a Copy of a File in the Same Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md)"},{"pos":[3475,3649],"content":"<bpt id=\"p1\">[</bpt>How to: Copy a Directory to Another Directory<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md)</ept>","source":"[How to: Copy a Directory to Another Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md)"},{"pos":[3652,3778],"content":"<bpt id=\"p1\">[</bpt>How to: Rename a File<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md)</ept>","source":"[How to: Rename a File](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md)"}]}