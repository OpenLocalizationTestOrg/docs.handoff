{"content":"---\ntitle: \"XDocument Class Overview (C#)\"\nms.date: 07/20/2015\nms.assetid: 63305603-ab54-49fc-84e4-f76eecc59549\n---\n# XDocument Class Overview (C#)\nThis topic introduces the <xref:System.Xml.Linq.XDocument> class.  \n  \n## Overview of the XDocument class  \n The <xref:System.Xml.Linq.XDocument> class contains the information necessary for a valid XML document. This includes an XML declaration, processing instructions, and comments.  \n  \n Note that you only have to create <xref:System.Xml.Linq.XDocument> objects if you require the specific functionality provided by the <xref:System.Xml.Linq.XDocument> class. In many circumstances, you can work directly with <xref:System.Xml.Linq.XElement>. Working directly with <xref:System.Xml.Linq.XElement> is a simpler programming model.  \n  \n <xref:System.Xml.Linq.XDocument> derives from <xref:System.Xml.Linq.XContainer>. Therefore, it can contain child nodes. However, <xref:System.Xml.Linq.XDocument> objects can have only one child <xref:System.Xml.Linq.XElement> node. This reflects the XML standard that there can be only one root element in an XML document.  \n  \n## Components of XDocument  \n An <xref:System.Xml.Linq.XDocument> can contain the following elements:  \n  \n-   One <xref:System.Xml.Linq.XDeclaration> object. <xref:System.Xml.Linq.XDeclaration> enables you to specify the pertinent parts of an XML declaration: the XML version, the encoding of the document, and whether the XML document is stand-alone.  \n  \n-   One <xref:System.Xml.Linq.XElement> object. This is the root node of the XML document.  \n  \n-   Any number of <xref:System.Xml.Linq.XProcessingInstruction> objects. A processing instruction communicates information to an application that processes the XML.  \n  \n-   Any number of <xref:System.Xml.Linq.XComment> objects. The comments will be siblings to the root element. The <xref:System.Xml.Linq.XComment> object cannot be the first argument in the list, because it is not valid for an XML document to start with a comment.  \n  \n-   One <xref:System.Xml.Linq.XDocumentType> for the DTD.  \n  \n When you serialize an <xref:System.Xml.Linq.XDocument>, even if `XDocument.Declaration` is `null`, the output will have an XML declaration if the writer has `Writer.Settings.OmitXmlDeclaration` set to `false` (the default).  \n  \n By default, [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] sets the version to \"1.0\", and sets the encoding to \"utf-8\".  \n  \n## Using XElement without XDocument  \n As previously mentioned, the <xref:System.Xml.Linq.XElement> class is the main class in the [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] programming interface. In many cases, your application will not require that you create a document. By using the <xref:System.Xml.Linq.XElement> class, you can create an XML tree, add other XML trees to it, modify the XML tree, and save it.  \n  \n## Using XDocument  \n To construct an <xref:System.Xml.Linq.XDocument>, use functional construction, just like you do to construct <xref:System.Xml.Linq.XElement> objects.  \n  \n The following code creates an <xref:System.Xml.Linq.XDocument> object and its associated contained objects.  \n  \n```csharp  \nXDocument d = new XDocument(  \n    new XComment(\"This is a comment.\"),  \n    new XProcessingInstruction(\"xml-stylesheet\",  \n        \"href='mystyle.css' title='Compact' type='text/css'\"),  \n    new XElement(\"Pubs\",  \n        new XElement(\"Book\",  \n            new XElement(\"Title\", \"Artifacts of Roman Civilization\"),  \n            new XElement(\"Author\", \"Moreno, Jordao\")  \n        ),  \n        new XElement(\"Book\",  \n            new XElement(\"Title\", \"Midieval Tools and Implements\"),  \n            new XElement(\"Author\", \"Gazit, Inbar\")  \n        )  \n    ),  \n    new XComment(\"This is another comment.\")  \n);  \nd.Declaration = new XDeclaration(\"1.0\", \"utf-8\", \"true\");  \nConsole.WriteLine(d);  \n  \nd.Save(\"test.xml\");  \n```  \n  \n When you examine the file test.xml, you get the following output:  \n  \n```xml  \n<?xml version=\"1.0\" encoding=\"utf-8\"?>  \n<!--This is a comment.-->  \n<?xml-stylesheet href='mystyle.css' title='Compact' type='text/css'?>  \n<Pubs>  \n  <Book>  \n    <Title>Artifacts of Roman Civilization</Title>  \n    <Author>Moreno, Jordao</Author>  \n  </Book>  \n  <Book>  \n    <Title>Midieval Tools and Implements</Title>  \n    <Author>Gazit, Inbar</Author>  \n  </Book>  \n</Pubs>  \n<!--This is another comment.-->  \n```  \n  \n## See also\n\n- [LINQ to XML Programming Overview (C#)](../../../../csharp/programming-guide/concepts/linq/linq-to-xml-programming-overview.md)\n","nodes":[{"pos":[4,111],"embed":true,"restype":"x-metadata","content":"title: \"XDocument Class Overview (C#)\"\nms.date: 07/20/2015\nms.assetid: 63305603-ab54-49fc-84e4-f76eecc59549","nodes":[{"content":"XDocument Class Overview (C#)","nodes":[{"pos":[0,29],"content":"XDocument Class Overview (C#)","nodes":[{"content":"XDocument Class Overview (C#)","pos":[0,29]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[118,147],"content":"XDocument Class Overview (C#)","linkify":"XDocument Class Overview (C#)","nodes":[{"content":"XDocument Class Overview (C#)","pos":[0,29]}]},{"pos":[148,213],"content":"This topic introduces the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph> class.","source":"This topic introduces the <xref:System.Xml.Linq.XDocument> class."},{"pos":[222,253],"content":"Overview of the XDocument class","linkify":"Overview of the XDocument class","nodes":[{"content":"Overview of the XDocument class","pos":[0,31]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph> class contains the information necessary for a valid XML document.","pos":[257,360],"source":"The <xref:System.Xml.Linq.XDocument> class contains the information necessary for a valid XML document."},{"content":"This includes an XML declaration, processing instructions, and comments.","pos":[361,433]},{"content":"Note that you only have to create <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph> objects if you require the specific functionality provided by the <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph> class.","pos":[440,612],"source":"Note that you only have to create <xref:System.Xml.Linq.XDocument> objects if you require the specific functionality provided by the <xref:System.Xml.Linq.XDocument> class."},{"content":"In many circumstances, you can work directly with <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph>.","pos":[613,695],"source":" In many circumstances, you can work directly with <xref:System.Xml.Linq.XElement>."},{"content":"Working directly with <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> is a simpler programming model.","pos":[696,781],"source":" Working directly with <xref:System.Xml.Linq.XElement> is a simpler programming model."},{"content":"<ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph> derives from <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XContainer&gt;</ph>.","pos":[788,868],"source":"<xref:System.Xml.Linq.XDocument> derives from <xref:System.Xml.Linq.XContainer>."},{"content":"Therefore, it can contain child nodes.","pos":[869,907]},{"content":"However, <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph> objects can have only one child <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> node.","pos":[908,1019],"source":" However, <xref:System.Xml.Linq.XDocument> objects can have only one child <xref:System.Xml.Linq.XElement> node."},{"content":"This reflects the XML standard that there can be only one root element in an XML document.","pos":[1020,1110]},{"pos":[1119,1142],"content":"Components of XDocument","linkify":"Components of XDocument","nodes":[{"content":"Components of XDocument","pos":[0,23]}]},{"pos":[1146,1217],"content":"An <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph> can contain the following elements:","source":"An <xref:System.Xml.Linq.XDocument> can contain the following elements:"},{"content":"One <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDeclaration&gt;</ph> object.","pos":[1227,1274],"source":"One <xref:System.Xml.Linq.XDeclaration> object."},{"content":"<ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDeclaration&gt;</ph> enables you to specify the pertinent parts of an XML declaration: the XML version, the encoding of the document, and whether the XML document is stand-alone.","pos":[1275,1468],"source":"<xref:System.Xml.Linq.XDeclaration> enables you to specify the pertinent parts of an XML declaration: the XML version, the encoding of the document, and whether the XML document is stand-alone."},{"content":"One <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> object.","pos":[1478,1521],"source":"One <xref:System.Xml.Linq.XElement> object."},{"content":"This is the root node of the XML document.","pos":[1522,1564]},{"content":"Any number of <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XProcessingInstruction&gt;</ph> objects.","pos":[1574,1642],"source":"Any number of <xref:System.Xml.Linq.XProcessingInstruction> objects."},{"content":"A processing instruction communicates information to an application that processes the XML.","pos":[1643,1734]},{"content":"Any number of <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XComment&gt;</ph> objects.","pos":[1744,1798],"source":"Any number of <xref:System.Xml.Linq.XComment> objects."},{"content":"The comments will be siblings to the root element.","pos":[1799,1849]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XComment&gt;</ph> object cannot be the first argument in the list, because it is not valid for an XML document to start with a comment.","pos":[1850,2003],"source":" The <xref:System.Xml.Linq.XComment> object cannot be the first argument in the list, because it is not valid for an XML document to start with a comment."},{"pos":[2013,2066],"content":"One <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocumentType&gt;</ph> for the DTD.","source":"One <xref:System.Xml.Linq.XDocumentType> for the DTD."},{"pos":[2073,2296],"content":"When you serialize an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph>, even if <ph id=\"ph2\">`XDocument.Declaration`</ph> is <ph id=\"ph3\">`null`</ph>, the output will have an XML declaration if the writer has <ph id=\"ph4\">`Writer.Settings.OmitXmlDeclaration`</ph> set to <ph id=\"ph5\">`false`</ph> (the default).","source":"When you serialize an <xref:System.Xml.Linq.XDocument>, even if `XDocument.Declaration` is `null`, the output will have an XML declaration if the writer has `Writer.Settings.OmitXmlDeclaration` set to `false` (the default)."},{"pos":[2303,2429],"content":"By default, <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> sets the version to \"1.0\", and sets the encoding to \"utf-8\".","source":"By default, [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] sets the version to \"1.0\", and sets the encoding to \"utf-8\"."},{"pos":[2438,2470],"content":"Using XElement without XDocument","linkify":"Using XElement without XDocument","nodes":[{"content":"Using XElement without XDocument","pos":[0,32]}]},{"content":"As previously mentioned, the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> class is the main class in the <ph id=\"ph2\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> programming interface.","pos":[2474,2642],"source":"As previously mentioned, the <xref:System.Xml.Linq.XElement> class is the main class in the [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] programming interface."},{"content":"In many cases, your application will not require that you create a document.","pos":[2643,2719]},{"content":"By using the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> class, you can create an XML tree, add other XML trees to it, modify the XML tree, and save it.","pos":[2720,2860],"source":" By using the <xref:System.Xml.Linq.XElement> class, you can create an XML tree, add other XML trees to it, modify the XML tree, and save it."},{"pos":[2869,2884],"content":"Using XDocument","linkify":"Using XDocument","nodes":[{"content":"Using XDocument","pos":[0,15]}]},{"pos":[2888,3037],"content":"To construct an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph>, use functional construction, just like you do to construct <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> objects.","source":"To construct an <xref:System.Xml.Linq.XDocument>, use functional construction, just like you do to construct <xref:System.Xml.Linq.XElement> objects."},{"pos":[3044,3151],"content":"The following code creates an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph> object and its associated contained objects.","source":"The following code creates an <xref:System.Xml.Linq.XDocument> object and its associated contained objects."},{"content":"When you examine the file test.xml, you get the following output:","pos":[3902,3967]},{"pos":[4412,4420],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4424,4551],"content":"<bpt id=\"p1\">[</bpt>LINQ to XML Programming Overview (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/linq-to-xml-programming-overview.md)</ept>","source":"[LINQ to XML Programming Overview (C#)](../../../../csharp/programming-guide/concepts/linq/linq-to-xml-programming-overview.md)"}]}