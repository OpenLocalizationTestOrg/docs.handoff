{"content":"---\ntitle: \"How to: Add an Event Handler Using Code\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"event handlers [WPF], adding\"\n  - \"XAML [WPF], adding event handlers\"\nms.assetid: 269c61e0-6bd9-4291-9bed-1c5ee66da486\n---\n# How to: Add an Event Handler Using Code\nThis example shows how to add an event handler to an element by using code.  \n  \n If you want to add an event handler to a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] element, and the markup page that contains the element has already been loaded, you must add the handler using code. Alternatively, if you are building up the element tree for an application entirely using code and not declaring any elements using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can call specific methods to add event handlers to the constructed element tree.  \n  \n## Example  \n The following example adds a new <xref:System.Windows.Controls.Button> to an existing page that is initially defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]. A code-behind file implements an event handler method and then adds that method as a new event handler on the <xref:System.Windows.Controls.Button>.  \n  \n The C# example uses the `+=` operator to assign a handler to an event. This is the same operator that is used to assign a handler in the [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] event handling model. Microsoft Visual Basic does not support this operator as a means of adding event handlers. It instead requires one of two techniques:  \n  \n-   Use the <xref:System.Windows.UIElement.AddHandler%2A> method, together with an `AddressOf` operator, to reference the event handler implementation.  \n  \n-   Use the `Handles` keyword as part of the event handler definition. This technique is not shown here; see [Visual Basic and WPF Event Handling](visual-basic-and-wpf-event-handling.md).  \n  \n [!code-xaml[RoutedEventAddRemoveHandler#XAML](~/samples/snippets/csharp/VS_Snippets_Wpf/RoutedEventAddRemoveHandler/CSharp/default.xaml#xaml)]  \n  \n [!code-csharp[RoutedEventAddRemoveHandler#Handler](~/samples/snippets/csharp/VS_Snippets_Wpf/RoutedEventAddRemoveHandler/CSharp/default.xaml.cs#handler)]\n [!code-vb[RoutedEventAddRemoveHandler#Handler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/RoutedEventAddRemoveHandler/VisualBasic/default.xaml.vb#handler)]  \n  \n> [!NOTE]\n>  Adding an event handler in the initially parsed [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] page is much simpler. Within the object element where you want to add the event handler, add an attribute that matches the name of the event that you want to handle. Then specify the value of that attribute as the name of the event handler method that you defined in the code-behind file of the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] page. For more information, see [XAML Overview (WPF)](xaml-overview-wpf.md) or [Routed Events Overview](routed-events-overview.md).  \n  \n## See also\n\n- [Routed Events Overview](routed-events-overview.md)\n- [How-to Topics](events-how-to-topics.md)\n","nodes":[{"pos":[4,254],"embed":true,"restype":"x-metadata","content":"title: \"How to: Add an Event Handler Using Code\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"event handlers [WPF], adding\"\n  - \"XAML [WPF], adding event handlers\"\nms.assetid: 269c61e0-6bd9-4291-9bed-1c5ee66da486","nodes":[{"content":"How to: Add an Event Handler Using Code","nodes":[{"pos":[0,39],"content":"How to: Add an Event Handler Using Code","nodes":[{"content":"How to: Add an Event Handler Using Code","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[261,300],"content":"How to: Add an Event Handler Using Code","linkify":"How to: Add an Event Handler Using Code","nodes":[{"content":"How to: Add an Event Handler Using Code","pos":[0,39]}]},{"content":"This example shows how to add an event handler to an element by using code.","pos":[301,376]},{"content":"If you want to add an event handler to a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> element, and the markup page that contains the element has already been loaded, you must add the handler using code.","pos":[383,612],"source":"If you want to add an event handler to a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] element, and the markup page that contains the element has already been loaded, you must add the handler using code."},{"content":"Alternatively, if you are building up the element tree for an application entirely using code and not declaring any elements using <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph>, you can call specific methods to add event handlers to the constructed element tree.","pos":[613,901],"source":" Alternatively, if you are building up the element tree for an application entirely using code and not declaring any elements using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can call specific methods to add event handlers to the constructed element tree."},{"pos":[910,917],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example adds a new <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button&gt;</ph> to an existing page that is initially defined in <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph>.","pos":[921,1113],"source":"The following example adds a new <xref:System.Windows.Controls.Button> to an existing page that is initially defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]."},{"content":"A code-behind file implements an event handler method and then adds that method as a new event handler on the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button&gt;</ph>.","pos":[1114,1262],"source":" A code-behind file implements an event handler method and then adds that method as a new event handler on the <xref:System.Windows.Controls.Button>."},{"content":"The C# example uses the <ph id=\"ph1\">`+=`</ph> operator to assign a handler to an event.","pos":[1269,1339],"source":"The C# example uses the `+=` operator to assign a handler to an event."},{"content":"This is the same operator that is used to assign a handler in the <ph id=\"ph1\">[!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)]</ph> event handling model.","pos":[1340,1495],"source":" This is the same operator that is used to assign a handler in the [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] event handling model."},{"content":"Microsoft Visual Basic does not support this operator as a means of adding event handlers.","pos":[1496,1586]},{"content":"It instead requires one of two techniques:","pos":[1587,1629]},{"pos":[1639,1786],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.AddHandler%2A&gt;</ph> method, together with an <ph id=\"ph2\">`AddressOf`</ph> operator, to reference the event handler implementation.","source":"Use the <xref:System.Windows.UIElement.AddHandler%2A> method, together with an `AddressOf` operator, to reference the event handler implementation."},{"content":"Use the <ph id=\"ph1\">`Handles`</ph> keyword as part of the event handler definition.","pos":[1796,1862],"source":"Use the `Handles` keyword as part of the event handler definition."},{"content":"This technique is not shown here; see <bpt id=\"p1\">[</bpt>Visual Basic and WPF Event Handling<ept id=\"p1\">](visual-basic-and-wpf-event-handling.md)</ept>.","pos":[1863,1979],"source":" This technique is not shown here; see [Visual Basic and WPF Event Handling](visual-basic-and-wpf-event-handling.md)."},{"pos":[2135,2449],"content":"[!code-csharp[RoutedEventAddRemoveHandler#Handler](~/samples/snippets/csharp/VS_Snippets_Wpf/RoutedEventAddRemoveHandler/CSharp/default.xaml.cs#handler)]\n[!code-vb[RoutedEventAddRemoveHandler#Handler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/RoutedEventAddRemoveHandler/VisualBasic/default.xaml.vb#handler)]","leadings":[""," "],"nodes":[]},{"pos":[2457,3086],"content":"[!NOTE]\n Adding an event handler in the initially parsed [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] page is much simpler. Within the object element where you want to add the event handler, add an attribute that matches the name of the event that you want to handle. Then specify the value of that attribute as the name of the event handler method that you defined in the code-behind file of the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] page. For more information, see [XAML Overview (WPF)](xaml-overview-wpf.md) or [Routed Events Overview](routed-events-overview.md).","leadings":["","> "],"nodes":[{"content":"Adding an event handler in the initially parsed [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] page is much simpler. Within the object element where you want to add the event handler, add an attribute that matches the name of the event that you want to handle. Then specify the value of that attribute as the name of the event handler method that you defined in the code-behind file of the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] page. For more information, see [XAML Overview (WPF)](xaml-overview-wpf.md) or [Routed Events Overview](routed-events-overview.md).","pos":[9,627],"nodes":[{"content":"Adding an event handler in the initially parsed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> page is much simpler.","pos":[0,141],"source":"Adding an event handler in the initially parsed [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] page is much simpler."},{"content":"Within the object element where you want to add the event handler, add an attribute that matches the name of the event that you want to handle.","pos":[142,285]},{"content":"Then specify the value of that attribute as the name of the event handler method that you defined in the code-behind file of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> page.","pos":[286,492],"source":" Then specify the value of that attribute as the name of the event handler method that you defined in the code-behind file of the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] page."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>XAML Overview (WPF)<ept id=\"p1\">](xaml-overview-wpf.md)</ept> or <bpt id=\"p2\">[</bpt>Routed Events Overview<ept id=\"p2\">](routed-events-overview.md)</ept>.","pos":[493,618],"source":" For more information, see [XAML Overview (WPF)](xaml-overview-wpf.md) or [Routed Events Overview](routed-events-overview.md)."}]}]},{"pos":[3095,3103],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3107,3158],"content":"<bpt id=\"p1\">[</bpt>Routed Events Overview<ept id=\"p1\">](routed-events-overview.md)</ept>","source":"[Routed Events Overview](routed-events-overview.md)"},{"pos":[3161,3201],"content":"<bpt id=\"p1\">[</bpt>How-to Topics<ept id=\"p1\">](events-how-to-topics.md)</ept>","source":"[How-to Topics](events-how-to-topics.md)"}]}