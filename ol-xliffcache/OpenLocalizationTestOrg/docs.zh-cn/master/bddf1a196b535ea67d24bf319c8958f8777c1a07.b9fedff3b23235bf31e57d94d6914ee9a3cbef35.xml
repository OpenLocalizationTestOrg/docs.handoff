{"content":"---\ntitle: \"How to: Implement a Provider | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"observer design pattern [.NET Framework], implementing providers\"\n  - \"providers [.NET Framework], in observer design pattern\"\n  - \"observables [.NET Framework], in observer design pattern\"\nms.assetid: 790b5d8b-d546-40a6-beeb-151b574e5ee5\ncaps.latest.revision: 8\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# How to: Implement a Provider\nThe observer design pattern requires a division between a provider, which monitors data and sends notifications, and one or more observers, which receive notifications (callbacks) from the provider. This topic discusses how to create a provider. A related topic, [How to: Implement an Observer](../../../docs/standard/events/how-to-implement-an-observer.md), discusses how to create an observer.  \n  \n### To create a provider  \n  \n1.  Define the data that the provider is responsible for sending to observers. Although the provider and the data that it sends to observers can be a single type, they are generally represented by different types. For example, in a temperature monitoring application, the `Temperature` structure defines the data that the provider (which is represented by the `TemperatureMonitor` class defined in the next step) monitors and to which observers subscribe.  \n  \n     [!code-csharp[Conceptual.ObserverDesign.HowTo#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/data.cs#1)]\n     [!code-vb[Conceptual.ObserverDesign.HowTo#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/data.vb#1)]  \n  \n2.  Define the data provider, which is a type that implements the <xref:System.IObservable%601?displayProperty=fullName> interface. The provider's generic type argument is the type that the provider sends to observers. The following example defines a `TemperatureMonitor` class, which is a constructed <xref:System.IObservable%601?displayProperty=fullName> implementation with a generic type argument of `Temperature`.  \n  \n     [!code-csharp[Conceptual.ObserverDesign.HowTo#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/provider.cs#2)]\n     [!code-vb[Conceptual.ObserverDesign.HowTo#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/provider.vb#2)]  \n  \n3.  Determine how the provider will store references to observers so that each observer can be notified when appropriate. Most commonly, a collection object such as a generic <xref:System.Collections.Generic.List%601> object is used for this purpose. The following example defines a private <xref:System.Collections.Generic.List%601> object that is instantiated in the `TemperatureMonitor` class constructor.  \n  \n     [!code-csharp[Conceptual.ObserverDesign.HowTo#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/provider.cs#3)]\n     [!code-vb[Conceptual.ObserverDesign.HowTo#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/provider.vb#3)]  \n  \n4.  Define an <xref:System.IDisposable> implementation that the provider can return to subscribers so that they can stop receiving notifications at any time. The following example defines a nested `Unsubscriber` class that is passed a reference to the subscribers collection and to the subscriber when the class is instantiated. This code enables the subscriber to call the object's <xref:System.IDisposable.Dispose%2A?displayProperty=fullName> implementation to remove itself from the subscribers collection.  \n  \n     [!code-csharp[Conceptual.ObserverDesign.HowTo#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/provider.cs#4)]\n     [!code-vb[Conceptual.ObserverDesign.HowTo#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/provider.vb#4)]  \n  \n5.  Implement the <xref:System.IObservable%601.Subscribe%2A?displayProperty=fullName> method. The method is passed a reference to the <xref:System.IObserver%601?displayProperty=fullName> interface and should be stored in the object designed for that purpose in step 3. The method should then return the <xref:System.IDisposable> implementation developed in step 4. The following example shows the implementation of the <xref:System.IObservable%601.Subscribe%2A> method in the `TemperatureMonitor` class.  \n  \n     [!code-csharp[Conceptual.ObserverDesign.HowTo#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/provider.cs#5)]\n     [!code-vb[Conceptual.ObserverDesign.HowTo#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/provider.vb#5)]  \n  \n6.  Notify observers as appropriate by calling their <xref:System.IObserver%601.OnNext%2A?displayProperty=fullName>, <xref:System.IObserver%601.OnError%2A?displayProperty=fullName>, and <xref:System.IObserver%601.OnCompleted%2A?displayProperty=fullName> implementations. In some cases, a provider may not call the <xref:System.IObserver%601.OnError%2A> method when an error occurs. For example, the following `GetTemperature` method simulates a monitor that reads temperature data every five seconds and notifies observers if the temperature has changed by at least .1 degree since the previous reading. If the device does not report a temperature (that is, if its value is null), the provider notifies observers that the transmission is complete. Note that, in addition to calling each observer's <xref:System.IObserver%601.OnCompleted%2A> method, the `GetTemperature` method clears the <xref:System.Collections.Generic.List%601> collection. In this case, the provider makes no calls to the <xref:System.IObserver%601.OnError%2A> method of its observers.  \n  \n     [!code-csharp[Conceptual.ObserverDesign.HowTo#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/provider.cs#6)]\n     [!code-vb[Conceptual.ObserverDesign.HowTo#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/provider.vb#6)]  \n  \n## Example  \n The following example contains the complete source code for defining an <xref:System.IObservable%601> implementation for a temperature monitoring application. It includes the `Temperature` structure, which is the data sent to observers, and the `TemperatureMonitor` class, which is the <xref:System.IObservable%601> implementation.  \n  \n [!code-csharp[Conceptual.ObserverDesign.HowTo#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/provider.cs#7)]\n [!code-vb[Conceptual.ObserverDesign.HowTo#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/provider.vb#7)]  \n  \n## See Also  \n <xref:System.IObservable%601>   \n [Observer Design Pattern](../../../docs/standard/events/observer-design-pattern.md)   \n [How to: Implement an Observer](../../../docs/standard/events/how-to-implement-an-observer.md)   \n [Observer Design Pattern Best Practices](../../../docs/standard/events/observer-design-pattern-best-practices.md)","nodes":[{"pos":[4,558],"embed":true,"restype":"x-metadata","content":"title: \"How to: Implement a Provider | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"observer design pattern [.NET Framework], implementing providers\"\n  - \"providers [.NET Framework], in observer design pattern\"\n  - \"observables [.NET Framework], in observer design pattern\"\nms.assetid: 790b5d8b-d546-40a6-beeb-151b574e5ee5\ncaps.latest.revision: 8\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"How to: Implement a Provider | Microsoft Docs","nodes":[{"pos":[0,45],"content":"How to: Implement a Provider | Microsoft Docs","nodes":[{"content":"How to: Implement a Provider | Microsoft Docs","pos":[0,45]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[565,593],"content":"How to: Implement a Provider","linkify":"How to: Implement a Provider","nodes":[{"content":"How to: Implement a Provider","pos":[0,28]}]},{"content":"The observer design pattern requires a division between a provider, which monitors data and sends notifications, and one or more observers, which receive notifications (callbacks) from the provider.","pos":[594,792]},{"content":"This topic discusses how to create a provider.","pos":[793,839]},{"content":"A related topic, <bpt id=\"p1\">[</bpt>How to: Implement an Observer<ept id=\"p1\">](../../../docs/standard/events/how-to-implement-an-observer.md)</ept>, discusses how to create an observer.","pos":[840,989],"source":" A related topic, [How to: Implement an Observer](../../../docs/standard/events/how-to-implement-an-observer.md), discusses how to create an observer."},{"pos":[999,1019],"content":"To create a provider","linkify":"To create a provider","nodes":[{"content":"To create a provider","pos":[0,20]}]},{"content":"Define the data that the provider is responsible for sending to observers.","pos":[1029,1103]},{"content":"Although the provider and the data that it sends to observers can be a single type, they are generally represented by different types.","pos":[1104,1238]},{"content":"For example, in a temperature monitoring application, the <ph id=\"ph1\">`Temperature`</ph> structure defines the data that the provider (which is represented by the <ph id=\"ph2\">`TemperatureMonitor`</ph> class defined in the next step) monitors and to which observers subscribe.","pos":[1239,1480],"source":" For example, in a temperature monitoring application, the `Temperature` structure defines the data that the provider (which is represented by the `TemperatureMonitor` class defined in the next step) monitors and to which observers subscribe."},{"pos":[1491,1786],"content":"[!code-csharp[Conceptual.ObserverDesign.HowTo#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/data.cs#1)]\n [!code-vb[Conceptual.ObserverDesign.HowTo#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/data.vb#1)]","leadings":["","    "],"nodes":[]},{"content":"Define the data provider, which is a type that implements the <ph id=\"ph1\">&lt;xref:System.IObservable%601?displayProperty=fullName&gt;</ph> interface.","pos":[1796,1923],"source":"Define the data provider, which is a type that implements the <xref:System.IObservable%601?displayProperty=fullName> interface."},{"content":"The provider's generic type argument is the type that the provider sends to observers.","pos":[1924,2010]},{"content":"The following example defines a <ph id=\"ph1\">`TemperatureMonitor`</ph> class, which is a constructed <ph id=\"ph2\">&lt;xref:System.IObservable%601?displayProperty=fullName&gt;</ph> implementation with a generic type argument of <ph id=\"ph3\">`Temperature`</ph>.","pos":[2011,2210],"source":" The following example defines a `TemperatureMonitor` class, which is a constructed <xref:System.IObservable%601?displayProperty=fullName> implementation with a generic type argument of `Temperature`."},{"pos":[2221,2524],"content":"[!code-csharp[Conceptual.ObserverDesign.HowTo#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/provider.cs#2)]\n [!code-vb[Conceptual.ObserverDesign.HowTo#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/provider.vb#2)]","leadings":["","    "],"nodes":[]},{"content":"Determine how the provider will store references to observers so that each observer can be notified when appropriate.","pos":[2534,2651]},{"content":"Most commonly, a collection object such as a generic <ph id=\"ph1\">&lt;xref:System.Collections.Generic.List%601&gt;</ph> object is used for this purpose.","pos":[2652,2780],"source":" Most commonly, a collection object such as a generic <xref:System.Collections.Generic.List%601> object is used for this purpose."},{"content":"The following example defines a private <ph id=\"ph1\">&lt;xref:System.Collections.Generic.List%601&gt;</ph> object that is instantiated in the <ph id=\"ph2\">`TemperatureMonitor`</ph> class constructor.","pos":[2781,2938],"source":" The following example defines a private <xref:System.Collections.Generic.List%601> object that is instantiated in the `TemperatureMonitor` class constructor."},{"pos":[2949,3252],"content":"[!code-csharp[Conceptual.ObserverDesign.HowTo#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/provider.cs#3)]\n [!code-vb[Conceptual.ObserverDesign.HowTo#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/provider.vb#3)]","leadings":["","    "],"nodes":[]},{"content":"Define an <ph id=\"ph1\">&lt;xref:System.IDisposable&gt;</ph> implementation that the provider can return to subscribers so that they can stop receiving notifications at any time.","pos":[3262,3415],"source":"Define an <xref:System.IDisposable> implementation that the provider can return to subscribers so that they can stop receiving notifications at any time."},{"content":"The following example defines a nested <ph id=\"ph1\">`Unsubscriber`</ph> class that is passed a reference to the subscribers collection and to the subscriber when the class is instantiated.","pos":[3416,3586],"source":" The following example defines a nested `Unsubscriber` class that is passed a reference to the subscribers collection and to the subscriber when the class is instantiated."},{"content":"This code enables the subscriber to call the object's <ph id=\"ph1\">&lt;xref:System.IDisposable.Dispose%2A?displayProperty=fullName&gt;</ph> implementation to remove itself from the subscribers collection.","pos":[3587,3767],"source":" This code enables the subscriber to call the object's <xref:System.IDisposable.Dispose%2A?displayProperty=fullName> implementation to remove itself from the subscribers collection."},{"pos":[3778,4081],"content":"[!code-csharp[Conceptual.ObserverDesign.HowTo#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/provider.cs#4)]\n [!code-vb[Conceptual.ObserverDesign.HowTo#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/provider.vb#4)]","leadings":["","    "],"nodes":[]},{"content":"Implement the <ph id=\"ph1\">&lt;xref:System.IObservable%601.Subscribe%2A?displayProperty=fullName&gt;</ph> method.","pos":[4091,4180],"source":"Implement the <xref:System.IObservable%601.Subscribe%2A?displayProperty=fullName> method."},{"content":"The method is passed a reference to the <ph id=\"ph1\">&lt;xref:System.IObserver%601?displayProperty=fullName&gt;</ph> interface and should be stored in the object designed for that purpose in step 3.","pos":[4181,4355],"source":" The method is passed a reference to the <xref:System.IObserver%601?displayProperty=fullName> interface and should be stored in the object designed for that purpose in step 3."},{"content":"The method should then return the <ph id=\"ph1\">&lt;xref:System.IDisposable&gt;</ph> implementation developed in step 4.","pos":[4356,4451],"source":" The method should then return the <xref:System.IDisposable> implementation developed in step 4."},{"content":"The following example shows the implementation of the <ph id=\"ph1\">&lt;xref:System.IObservable%601.Subscribe%2A&gt;</ph> method in the <ph id=\"ph2\">`TemperatureMonitor`</ph> class.","pos":[4452,4590],"source":" The following example shows the implementation of the <xref:System.IObservable%601.Subscribe%2A> method in the `TemperatureMonitor` class."},{"pos":[4601,4904],"content":"[!code-csharp[Conceptual.ObserverDesign.HowTo#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/provider.cs#5)]\n [!code-vb[Conceptual.ObserverDesign.HowTo#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/provider.vb#5)]","leadings":["","    "],"nodes":[]},{"content":"Notify observers as appropriate by calling their <ph id=\"ph1\">&lt;xref:System.IObserver%601.OnNext%2A?displayProperty=fullName&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.IObserver%601.OnError%2A?displayProperty=fullName&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.IObserver%601.OnCompleted%2A?displayProperty=fullName&gt;</ph> implementations.","pos":[4914,5180],"source":"Notify observers as appropriate by calling their <xref:System.IObserver%601.OnNext%2A?displayProperty=fullName>, <xref:System.IObserver%601.OnError%2A?displayProperty=fullName>, and <xref:System.IObserver%601.OnCompleted%2A?displayProperty=fullName> implementations."},{"content":"In some cases, a provider may not call the <ph id=\"ph1\">&lt;xref:System.IObserver%601.OnError%2A&gt;</ph> method when an error occurs.","pos":[5181,5291],"source":" In some cases, a provider may not call the <xref:System.IObserver%601.OnError%2A> method when an error occurs."},{"content":"For example, the following <ph id=\"ph1\">`GetTemperature`</ph> method simulates a monitor that reads temperature data every five seconds and notifies observers if the temperature has changed by at least .1 degree since the previous reading.","pos":[5292,5513],"source":" For example, the following `GetTemperature` method simulates a monitor that reads temperature data every five seconds and notifies observers if the temperature has changed by at least .1 degree since the previous reading."},{"content":"If the device does not report a temperature (that is, if its value is null), the provider notifies observers that the transmission is complete.","pos":[5514,5657]},{"content":"Note that, in addition to calling each observer's <ph id=\"ph1\">&lt;xref:System.IObserver%601.OnCompleted%2A&gt;</ph> method, the <ph id=\"ph2\">`GetTemperature`</ph> method clears the <ph id=\"ph3\">&lt;xref:System.Collections.Generic.List%601&gt;</ph> collection.","pos":[5658,5852],"source":" Note that, in addition to calling each observer's <xref:System.IObserver%601.OnCompleted%2A> method, the `GetTemperature` method clears the <xref:System.Collections.Generic.List%601> collection."},{"content":"In this case, the provider makes no calls to the <ph id=\"ph1\">&lt;xref:System.IObserver%601.OnError%2A&gt;</ph> method of its observers.","pos":[5853,5965],"source":" In this case, the provider makes no calls to the <xref:System.IObserver%601.OnError%2A> method of its observers."},{"pos":[5976,6279],"content":"[!code-csharp[Conceptual.ObserverDesign.HowTo#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesign.howto/cs/provider.cs#6)]\n [!code-vb[Conceptual.ObserverDesign.HowTo#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesign.howto/vb/provider.vb#6)]","leadings":["","    "],"nodes":[]},{"pos":[6288,6295],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example contains the complete source code for defining an <ph id=\"ph1\">&lt;xref:System.IObservable%601&gt;</ph> implementation for a temperature monitoring application.","pos":[6299,6457],"source":"The following example contains the complete source code for defining an <xref:System.IObservable%601> implementation for a temperature monitoring application."},{"content":"It includes the <ph id=\"ph1\">`Temperature`</ph> structure, which is the data sent to observers, and the <ph id=\"ph2\">`TemperatureMonitor`</ph> class, which is the <ph id=\"ph3\">&lt;xref:System.IObservable%601&gt;</ph> implementation.","pos":[6458,6630],"source":" It includes the `Temperature` structure, which is the data sent to observers, and the `TemperatureMonitor` class, which is the <xref:System.IObservable%601> implementation."},{"pos":[6945,6953],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Observer Design Pattern<ept id=\"p1\">](../../../docs/standard/events/observer-design-pattern.md)</ept><ph id=\"ph1\"> </ph>","pos":[6991,7075],"source":"[Observer Design Pattern](../../../docs/standard/events/observer-design-pattern.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Implement an Observer<ept id=\"p1\">](../../../docs/standard/events/how-to-implement-an-observer.md)</ept><ph id=\"ph1\"> </ph>","pos":[7079,7174],"source":"[How to: Implement an Observer](../../../docs/standard/events/how-to-implement-an-observer.md) "},{"content":"<bpt id=\"p1\">[</bpt>Observer Design Pattern Best Practices<ept id=\"p1\">](../../../docs/standard/events/observer-design-pattern-best-practices.md)</ept>","pos":[7178,7291],"source":"[Observer Design Pattern Best Practices](../../../docs/standard/events/observer-design-pattern-best-practices.md)"}]}