{"content":"---\ntitle: \"openGenericCERCall MDA\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"MDAs (managed debugging assistants), CER calls\"\n  - \"open generic CER calls\"\n  - \"constrained execution regions\"\n  - \"openGenericCERCall MDA\"\n  - \"CER calls\"\n  - \"managed debugging assistants (MDAs), CER calls\"\n  - \"generics [.NET Framework], open generic CER calls\"\nms.assetid: da3e4ff3-2e67-4668-9720-fa776c97407e\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# openGenericCERCall MDA\nThe `openGenericCERCall` managed debugging assistant is activated to warn that a constrained execution region (CER) graph with generic type variables at the root method is being processed at JIT-compilation or native image generation time and at least one of the generic type variables is an object reference type.  \n  \n## Symptoms  \n CER code does not run when a thread is aborted or when an application domain is unloaded.  \n  \n## Cause  \n At JIT-compilation time, an instantiation containing an object reference type is only representative because the resultant code is shared, and each of the object reference type variables might be any object reference type. This can prevent the preparation of some run-time resources ahead of time.  \n  \n In particular, methods with generic type variables can lazily allocate resources in the background. These are referred to as generic dictionary entries. For instance, for the statement `List<T> list = new List<T>();` where `T` is a generic type variable the runtime must look up and possibly create the exact instantiation at run time, for example, `List<Object>, List<String>`,and so forth. This can fail for a variety of reasons beyond the developer's control, such as running out of memory.  \n  \n This MDA should only be activated at JIT-compilation time, not when there is an exact instantiation.  \n  \n When this MDA is activated, the likely symptoms are that CERs are not functional for the bad instantiations. In fact, the runtime has not attempted to implement a CER under the circumstances that caused the MDA to be activated. So if the developer uses a shared instantiation of the CER, then JIT-compilation errors, generics type loading errors, or thread aborts within the region of the intended CER are not caught.  \n  \n## Resolution  \n Do not use generic type variables that are of object reference type for methods that may contain a CER.  \n  \n## Effect on the Runtime  \n This MDA has no effect on the CLR.  \n  \n## Output  \n The following is a sample of output from this MDA.  \n  \n `Method 'GenericMethodWithCer', which contains at least one constrained execution region, cannot be prepared automatically since it has one or more unbound generic type parameters.`  \n  \n `The caller must ensure this method is prepared explicitly at run time prior to execution.`  \n  \n `method name=\"GenericMethodWithCer\"`  \n  \n `declaringType name=\"OpenGenericCERCall\"`  \n  \n## Configuration  \n  \n```xml  \n<mdaConfig>  \n  <assistants>  \n    <openGenericCERCall/>  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## Example  \n The CER code is not executed.  \n  \n```csharp\nusing System;  \nusing System.Collections.Generic;  \nusing System.Runtime.CompilerServices;  \n  \nclass Program  \n{  \n    static void Main(string[] args)  \n    {  \n        CallGenericMethods();  \n    }  \n    static void CallGenericMethods()  \n    {  \n        // This call is correct. The instantiation of the method  \n        // contains only nonreference types.  \n        MyClass.GenericMethodWithCer<int>();  \n  \n        // This call is incorrect. A shared version of the method that  \n        // cannot be completely analyzed will be JIT-compiled. The   \n        // MDA will be activated at JIT-compile time, not at run time.  \n        MyClass.GenericMethodWithCer<String>();  \n    }  \n}  \n  \n    class MyClass  \n{  \n    public static void GenericMethodWithCer<T>()  \n    {  \n        RuntimeHelpers.PrepareConstrainedRegions();  \n        try  \n        {  \n  \n        }  \n        finally  \n        {  \n            // This is the start of the CER.  \n            Console.WriteLine(\"In finally block.\");  \n        }  \n    }  \n}  \n```  \n  \n## See also\n\n- <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareMethod%2A>\n- <xref:System.Runtime.ConstrainedExecution>\n- [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)\n","nodes":[{"pos":[4,437],"embed":true,"restype":"x-metadata","content":"title: \"openGenericCERCall MDA\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"MDAs (managed debugging assistants), CER calls\"\n  - \"open generic CER calls\"\n  - \"constrained execution regions\"\n  - \"openGenericCERCall MDA\"\n  - \"CER calls\"\n  - \"managed debugging assistants (MDAs), CER calls\"\n  - \"generics [.NET Framework], open generic CER calls\"\nms.assetid: da3e4ff3-2e67-4668-9720-fa776c97407e\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"openGenericCERCall MDA","nodes":[{"pos":[0,22],"content":"openGenericCERCall MDA","nodes":[{"content":"openGenericCERCall MDA","pos":[0,22]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[444,466],"content":"openGenericCERCall MDA","linkify":"openGenericCERCall MDA","nodes":[{"content":"openGenericCERCall MDA","pos":[0,22]}]},{"pos":[467,781],"content":"The <ph id=\"ph1\">`openGenericCERCall`</ph> managed debugging assistant is activated to warn that a constrained execution region (CER) graph with generic type variables at the root method is being processed at JIT-compilation or native image generation time and at least one of the generic type variables is an object reference type.","source":"The `openGenericCERCall` managed debugging assistant is activated to warn that a constrained execution region (CER) graph with generic type variables at the root method is being processed at JIT-compilation or native image generation time and at least one of the generic type variables is an object reference type."},{"pos":[790,798],"content":"Symptoms","linkify":"Symptoms","nodes":[{"content":"Symptoms","pos":[0,8]}]},{"content":"CER code does not run when a thread is aborted or when an application domain is unloaded.","pos":[802,891]},{"pos":[900,905],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"content":"At JIT-compilation time, an instantiation containing an object reference type is only representative because the resultant code is shared, and each of the object reference type variables might be any object reference type.","pos":[909,1131]},{"content":"This can prevent the preparation of some run-time resources ahead of time.","pos":[1132,1206]},{"content":"In particular, methods with generic type variables can lazily allocate resources in the background.","pos":[1213,1312]},{"content":"These are referred to as generic dictionary entries.","pos":[1313,1365]},{"content":"For instance, for the statement <ph id=\"ph1\">`List&lt;T&gt; list = new List&lt;T&gt;();`</ph> where <ph id=\"ph2\">`T`</ph> is a generic type variable the runtime must look up and possibly create the exact instantiation at run time, for example, <ph id=\"ph3\">`List&lt;Object&gt;, List&lt;String&gt;`</ph>,and so forth.","pos":[1366,1604],"source":" For instance, for the statement `List<T> list = new List<T>();` where `T` is a generic type variable the runtime must look up and possibly create the exact instantiation at run time, for example, `List<Object>, List<String>`,and so forth."},{"content":"This can fail for a variety of reasons beyond the developer's control, such as running out of memory.","pos":[1605,1706]},{"content":"This MDA should only be activated at JIT-compilation time, not when there is an exact instantiation.","pos":[1713,1813]},{"content":"When this MDA is activated, the likely symptoms are that CERs are not functional for the bad instantiations.","pos":[1820,1928]},{"content":"In fact, the runtime has not attempted to implement a CER under the circumstances that caused the MDA to be activated.","pos":[1929,2047]},{"content":"So if the developer uses a shared instantiation of the CER, then JIT-compilation errors, generics type loading errors, or thread aborts within the region of the intended CER are not caught.","pos":[2048,2237]},{"pos":[2246,2256],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"content":"Do not use generic type variables that are of object reference type for methods that may contain a CER.","pos":[2260,2363]},{"pos":[2372,2393],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"content":"This MDA has no effect on the CLR.","pos":[2397,2431]},{"pos":[2440,2446],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"The following is a sample of output from this MDA.","pos":[2450,2500]},{"pos":[2886,2899],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[3018,3025],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The CER code is not executed.","pos":[3029,3058]},{"pos":[4113,4121],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4243,4396],"content":"<bpt id=\"p1\">[</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept>","source":"[Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)"}]}