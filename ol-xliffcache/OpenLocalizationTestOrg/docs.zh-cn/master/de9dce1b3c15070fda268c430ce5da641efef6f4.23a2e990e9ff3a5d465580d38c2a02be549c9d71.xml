{"content":"---\ntitle: \"How to: Set JPEG Compression Level\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"images [Windows Forms], changing encoder parameters\"\n  - \"JPEG images [Windows Forms], setting quality level\"\nms.assetid: 4b9a74e3-9504-43c1-9f28-ace651d0772e\n---\n# How to: Set JPEG Compression Level\nYou may want to modify the parameters of an image when you save the image to disk to minimize the file size or improve its quality. You can adjust the quality of a JPEG image by modifying its compression level. To specify the compression level when you save a JPEG image, you must create an <xref:System.Drawing.Imaging.EncoderParameters> object and pass it to the <xref:System.Drawing.Image.Save%2A> method of the <xref:System.Drawing.Image> class. Initialize the <xref:System.Drawing.Imaging.EncoderParameters> object so that it has an array that consists of one <xref:System.Drawing.Imaging.EncoderParameter>. When you create the <xref:System.Drawing.Imaging.EncoderParameter>, specify the <xref:System.Drawing.Imaging.Encoder.Quality> encoder, and the desired compression level.  \n  \n## Example  \n The following example code creates an <xref:System.Drawing.Imaging.EncoderParameter> object and saves three JPEG images. Each JPEG image is saved with a different quality level, by modifying the `long` value passed to the <xref:System.Drawing.Imaging.EncoderParameter> constructor. A quality level of 0 corresponds to the greatest compression, and a quality level of 100 corresponds to the least compression.  \n  \n```csharp  \nprivate void VaryQualityLevel()  \n    {  \n        // Get a bitmap. The using statement ensures objects  \n        // are automatically disposed from memory after use.  \n        using (Bitmap bmp1 = new Bitmap(@\"C:\\TestPhoto.jpg\"))  \n        {  \n            ImageCodecInfo jpgEncoder = GetEncoder(ImageFormat.Jpeg);  \n  \n            // Create an Encoder object based on the GUID  \n            // for the Quality parameter category.  \n            System.Drawing.Imaging.Encoder myEncoder =  \n                System.Drawing.Imaging.Encoder.Quality;  \n  \n            // Create an EncoderParameters object.  \n            // An EncoderParameters object has an array of EncoderParameter  \n            // objects. In this case, there is only one  \n            // EncoderParameter object in the array.  \n            EncoderParameters myEncoderParameters = new EncoderParameters(1);  \n  \n            EncoderParameter myEncoderParameter = new EncoderParameter(myEncoder, 50L);  \n            myEncoderParameters.Param[0] = myEncoderParameter;  \n            bmp1.Save(@\"c:\\TestPhotoQualityFifty.jpg\", jpgEncoder, myEncoderParameters);  \n  \n            myEncoderParameter = new EncoderParameter(myEncoder, 100L);  \n            myEncoderParameters.Param[0] = myEncoderParameter;  \n            bmp1.Save(@\"C:\\TestPhotoQualityHundred.jpg\", jpgEncoder, myEncoderParameters);  \n  \n            // Save the bitmap as a JPG file with zero quality level compression.  \n            myEncoderParameter = new EncoderParameter(myEncoder, 0L);  \n            myEncoderParameters.Param[0] = myEncoderParameter;  \n            bmp1.Save(@\"C:\\TestPhotoQualityZero.jpg\", jpgEncoder, myEncoderParameters);  \n        }  \n    }  \n```  \n  \n```vb  \nPrivate Sub VaryQualityLevel()  \n    ' Get a bitmap. The Using statement ensures objects  \n    ' are automatically disposed from memory after use.  \n    Using bmp1 As New Bitmap(\"C:\\test\\TestPhoto.jpg\")  \n        Dim jpgEncoder As ImageCodecInfo = GetEncoder(ImageFormat.Jpeg)  \n  \n        ' Create an Encoder object based on the GUID  \n        ' for the Quality parameter category.  \n        Dim myEncoder As System.Drawing.Imaging.Encoder = System.Drawing.Imaging.Encoder.Quality  \n  \n        ' Create an EncoderParameters object.  \n        ' An EncoderParameters object has an array of EncoderParameter  \n        ' objects. In this case, there is only one  \n        ' EncoderParameter object in the array.  \n        Dim myEncoderParameters As New EncoderParameters(1)  \n  \n        Dim myEncoderParameter As New EncoderParameter(myEncoder, 50L)  \n        myEncoderParameters.Param(0) = myEncoderParameter  \n        bmp1.Save(\"c:\\test\\TestPhotoQualityFifty.jpg\", jpgEncoder, myEncoderParameters)  \n  \n        myEncoderParameter = New EncoderParameter(myEncoder, 100L)  \n        myEncoderParameters.Param(0) = myEncoderParameter  \n        bmp1.Save(\"C:\\test\\TestPhotoQualityHundred.jpg\", jpgEncoder, myEncoderParameters)  \n  \n        ' Save the bitmap as a JPG file with zero quality level compression.  \n        myEncoderParameter = New EncoderParameter(myEncoder, 0L)  \n        myEncoderParameters.Param(0) = myEncoderParameter  \n        bmp1.Save(\"C:\\test\\TestPhotoQualityZero.jpg\", jpgEncoder, myEncoderParameters)  \n    End Using  \nEnd Sub  \n```  \n  \n```csharp  \nprivate ImageCodecInfo GetEncoder(ImageFormat format)  \n{  \n    ImageCodecInfo[] codecs = ImageCodecInfo.GetImageDecoders();  \n    foreach (ImageCodecInfo codec in codecs)  \n    {  \n        if (codec.FormatID == format.Guid)  \n        {  \n            return codec;  \n        }  \n    }  \n    return null;  \n}  \n```  \n  \n```vb  \nPrivate Function GetEncoder(ByVal format As ImageFormat) As ImageCodecInfo  \n  \n    Dim codecs As ImageCodecInfo() = ImageCodecInfo.GetImageDecoders()  \n    Dim codec As ImageCodecInfo  \n    For Each codec In codecs  \n        If codec.FormatID = format.Guid Then  \n            Return codec  \n        End If  \n    Next codec  \n    Return Nothing  \n  \nEnd Function  \n```  \n  \n## Compiling the Code  \n This example requires:  \n  \n-   A Windows Forms application.  \n  \n-   A <xref:System.Windows.Forms.PaintEventArgs>, which is a parameter of <xref:System.Windows.Forms.PaintEventHandler>.  \n  \n-   An image file that is named `TestPhoto.jpg` and located at **c:\\\\**.  \n  \n## See also\n\n- [How to: Determine the Parameters Supported by an Encoder](how-to-determine-the-parameters-supported-by-an-encoder.md)\n- [Types of Bitmaps](types-of-bitmaps.md)\n- [Using Image Encoders and Decoders in Managed GDI+](using-image-encoders-and-decoders-in-managed-gdi.md)\n","nodes":[{"pos":[4,289],"embed":true,"restype":"x-metadata","content":"title: \"How to: Set JPEG Compression Level\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"images [Windows Forms], changing encoder parameters\"\n  - \"JPEG images [Windows Forms], setting quality level\"\nms.assetid: 4b9a74e3-9504-43c1-9f28-ace651d0772e","nodes":[{"content":"How to: Set JPEG Compression Level","nodes":[{"pos":[0,34],"content":"How to: Set JPEG Compression Level","nodes":[{"content":"How to: Set JPEG Compression Level","pos":[0,34]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[296,330],"content":"How to: Set JPEG Compression Level","linkify":"How to: Set JPEG Compression Level","nodes":[{"content":"How to: Set JPEG Compression Level","pos":[0,34]}]},{"content":"You may want to modify the parameters of an image when you save the image to disk to minimize the file size or improve its quality.","pos":[331,462]},{"content":"You can adjust the quality of a JPEG image by modifying its compression level.","pos":[463,541]},{"content":"To specify the compression level when you save a JPEG image, you must create an <ph id=\"ph1\">&lt;xref:System.Drawing.Imaging.EncoderParameters&gt;</ph> object and pass it to the <ph id=\"ph2\">&lt;xref:System.Drawing.Image.Save%2A&gt;</ph> method of the <ph id=\"ph3\">&lt;xref:System.Drawing.Image&gt;</ph> class.","pos":[542,780],"source":" To specify the compression level when you save a JPEG image, you must create an <xref:System.Drawing.Imaging.EncoderParameters> object and pass it to the <xref:System.Drawing.Image.Save%2A> method of the <xref:System.Drawing.Image> class."},{"content":"Initialize the <ph id=\"ph1\">&lt;xref:System.Drawing.Imaging.EncoderParameters&gt;</ph> object so that it has an array that consists of one <ph id=\"ph2\">&lt;xref:System.Drawing.Imaging.EncoderParameter&gt;</ph>.","pos":[781,943],"source":" Initialize the <xref:System.Drawing.Imaging.EncoderParameters> object so that it has an array that consists of one <xref:System.Drawing.Imaging.EncoderParameter>."},{"content":"When you create the <ph id=\"ph1\">&lt;xref:System.Drawing.Imaging.EncoderParameter&gt;</ph>, specify the <ph id=\"ph2\">&lt;xref:System.Drawing.Imaging.Encoder.Quality&gt;</ph> encoder, and the desired compression level.","pos":[944,1113],"source":" When you create the <xref:System.Drawing.Imaging.EncoderParameter>, specify the <xref:System.Drawing.Imaging.Encoder.Quality> encoder, and the desired compression level."},{"pos":[1122,1129],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example code creates an <ph id=\"ph1\">&lt;xref:System.Drawing.Imaging.EncoderParameter&gt;</ph> object and saves three JPEG images.","pos":[1133,1253],"source":"The following example code creates an <xref:System.Drawing.Imaging.EncoderParameter> object and saves three JPEG images."},{"content":"Each JPEG image is saved with a different quality level, by modifying the <ph id=\"ph1\">`long`</ph> value passed to the <ph id=\"ph2\">&lt;xref:System.Drawing.Imaging.EncoderParameter&gt;</ph> constructor.","pos":[1254,1414],"source":" Each JPEG image is saved with a different quality level, by modifying the `long` value passed to the <xref:System.Drawing.Imaging.EncoderParameter> constructor."},{"content":"A quality level of 0 corresponds to the greatest compression, and a quality level of 100 corresponds to the least compression.","pos":[1415,1541]},{"pos":[5540,5558],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"This example requires:","pos":[5562,5584]},{"content":"A Windows Forms application.","pos":[5594,5622]},{"pos":[5632,5748],"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Forms.PaintEventArgs&gt;</ph>, which is a parameter of <ph id=\"ph2\">&lt;xref:System.Windows.Forms.PaintEventHandler&gt;</ph>.","source":"A <xref:System.Windows.Forms.PaintEventArgs>, which is a parameter of <xref:System.Windows.Forms.PaintEventHandler>."},{"pos":[5758,5826],"content":"An image file that is named <ph id=\"ph1\">`TestPhoto.jpg`</ph> and located at <bpt id=\"p1\">**</bpt>c:<ph id=\"ph2\">\\\\</ph><ept id=\"p1\">**</ept>.","source":"An image file that is named `TestPhoto.jpg` and located at **c:\\\\**."},{"pos":[5835,5843],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5847,5965],"content":"<bpt id=\"p1\">[</bpt>How to: Determine the Parameters Supported by an Encoder<ept id=\"p1\">](how-to-determine-the-parameters-supported-by-an-encoder.md)</ept>","source":"[How to: Determine the Parameters Supported by an Encoder](how-to-determine-the-parameters-supported-by-an-encoder.md)"},{"pos":[5968,6007],"content":"<bpt id=\"p1\">[</bpt>Types of Bitmaps<ept id=\"p1\">](types-of-bitmaps.md)</ept>","source":"[Types of Bitmaps](types-of-bitmaps.md)"},{"pos":[6010,6114],"content":"<bpt id=\"p1\">[</bpt>Using Image Encoders and Decoders in Managed GDI+<ept id=\"p1\">](using-image-encoders-and-decoders-in-managed-gdi.md)</ept>","source":"[Using Image Encoders and Decoders in Managed GDI+](using-image-encoders-and-decoders-in-managed-gdi.md)"}]}