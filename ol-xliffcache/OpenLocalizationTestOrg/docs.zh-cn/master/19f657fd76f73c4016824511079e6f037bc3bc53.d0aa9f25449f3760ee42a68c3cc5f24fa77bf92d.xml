{"content":"---\ntitle: PutInstanceWmi function (Unmanaged API Reference)\ndescription: The PutInstanceWmi function creates or updates an instance of an existing class.\nms.date: \"11/06/2017\"\napi_name:\n  - \"PutInstanceWmi\"\napi_location:\n  - \"WMINet_Utils.dll\"\napi_type:\n  - \"DLLExport\"\nf1_keywords:\n  - \"PutInstanceWmi\"\nhelpviewer_keywords:\n  - \"PutInstanceWmi function [.NET WMI and performance counters]\"\ntopic_type:\n  - \"Reference\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n\n# PutInstanceWmi function\n\nCreates or updates an instance of an existing class. The instance is written to the WMI repository.\n\n[!INCLUDE[internalonly-unmanaged](../../../../includes/internalonly-unmanaged.md)]\n\n## Syntax\n\n```cpp\nHRESULT PutInstanceWmi (\n   [in] IWbemClassObject*    pInst,\n   [in] long                 lFlags,\n   [in] IWbemContext*        pCtx,\n   [out] IWbemCallResult**   ppCallResult\n);\n```\n\n## Parameters\n\n`pInst`\\\n[in] A pointer to the instance to be written.\n\n`lFlags`\\\n[in] A combination of flags that affect the behavior of this function. The following values are defined in the *WbemCli.h* header file, or you can define them as constants in your code:\n\n|Constant  |Value  |Description  |\n|---------|---------|---------|\n| `WBEM_FLAG_USE_AMENDED_QUALIFIERS` | 0x20000 | If set, WMI does not store any qualifiers with the **Amended** flavor. <br> If not set, it is assumed that this object is not localized, and all qualifiers are stored with this instance. |\n| `WBEM_FLAG_CREATE_OR_UPDATE` | 0 | Create the instance if it does not exist, or overwrite it if it exists already. |\n| `WBEM_FLAG_UPDATE_ONLY` | 1 | Update the instance. The instance must exist for the call to be successful. |\n| `WBEM_FLAG_CREATE_ONLY` | 2 | Create the instance. The call fails if the instance already exists. |\n| `WBEM_FLAG_RETURN_IMMEDIATELY` | 0x10 | The flag causes a semisynchronous call. |\n\n`pCtx`\\\n[in] Typically, this value is `null`. Otherwise, it is a pointer to an [IWbemContext](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcontext) instance that can be used by the provider that is providing the requested classes.\n\n`ppCallResult`\\\n[out] If `null`, this parameter is unused. If `lFlags` contains `WBEM_FLAG_RETURN_IMMEDIATELY`, the function returns immediately with `WBEM_S_NO_ERROR`. The `ppCallResult` parameter receives a pointer to a new [IWbemCallResult](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcallresult) object.\n\n## Return value\n\nThe following values returned by this function are defined in the *WbemCli.h* header file, or you can define them as constants in your code:\n\n|Constant  |Value  |Description  |\n|---------|---------|---------|\n| `WBEM_E_ACCESS_DENIED` | 0x80041003 | The user does not have permission to update an instance of the specified class. |\n| `WBEM_E_FAILED` | 0x80041001 | An unspecified error has occurred. |\n| `WBEM_E_INVALID_CLASS` | 0x80041010 | The class supporting this instance is not valid. |\n| `WBEM_E_ILLEGAL_NULL` | 0x80041028 | a `null` was specified for a property that cannot be `null`, such as one that is marked by an **Indexed** or **Not_Null** qualifier. |\n| `WBEM_E_INVALID_OBJECT` | 0x8004100f | The specified instance is not valid. (For example, calling `PutInstanceWmi` with a class returns this value.) |\n| `WBEM_E_INVALID_PARAMETER` | 0x80041008 | A parameter is not valid. |\n| `WBEM_E_ALREADY_EXISTS` | 0x80041019 | The `WBEM_FLAG_CREATE_ONLY` flag was specified, but the instance already exists. |\n| `WBEM_E_NOT_FOUND` | 0x80041002 | `WBEM_FLAG_UPDATE_ONLY` was specified in `lFlags`, but the instance does not exist. |\n| `WBEM_E_OUT_OF_MEMORY` | 0x80041006 | Not enough memory is available to complete the operation. |\n| `WBEM_E_SHUTTING_DOWN` | 0x80041033 | WMI was probably stopped and restarting. Call [ConnectServerWmi](connectserverwmi.md) again. |\n| `WBEM_E_TRANSPORT_FAILURE` | 0x80041015 | The remote procedure call (RPC) link between the current process and WMI has failed. |\n| `WBEM_S_NO_ERROR` | 0 | The function call was successful. |\n\n## Remarks\n\nThis function wraps a call to the [IWbemServices::PutInstance](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemservices-putinstance) method.\n\nThe `PutInstanceWmi` function supports creating instances and updating instances of existing classes only.  Depending on how the `pCtx` parameter is set, either some or all of the properties of the instance are updated.\n\nWhen the instance pointed to by `pInst` belongs to a subclass, Windows Management calls all the providers responsible for the classes from which the subclass derives. All of these providers must succeed for the original `PutInstanceWmi` request to succeed. The provider supporting the topmost class in the hierarchy is called first. The calling order continues with the subclass of the topmost class and proceeds from top to bottom until Windows Management reaches the provider for the class owning the instance pointed to by `pInst`.\nWindows Management does not call the providers for any of the child classes of an instance.\n\nWhen an application must update an instance that belongs to a class hierarchy, the `pInst` parameter must point to the instance containing the properties to be modified. That is, consider a target instance that belongs to **ClassB**. The **ClassB** instance derives from **ClassA**, and **ClassA** defines the property **PropA**. If an application wants to make a change to the value of **PropA** in the **ClassB** instance, it must set `pInst` to that instance rather than an instance of **ClassA**.\n\nCalling `PutInstanceWmi` on an instance of an abstract class is not allowed.\n\nIf the function call fails, you can obtain additional error information by calling the [GetErrorInfo](geterrorinfo.md) function.\n\n## Requirements\n\n**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).\n\n**Header:** WMINet_Utils.idl\n\n**.NET Framework Versions:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]\n\n## See also\n\n- [WMI and Performance Counters (Unmanaged API Reference)](index.md)","nodes":[{"pos":[4,459],"embed":true,"restype":"x-metadata","content":"title: PutInstanceWmi function (Unmanaged API Reference)\ndescription: The PutInstanceWmi function creates or updates an instance of an existing class.\nms.date: \"11/06/2017\"\napi_name:\n  - \"PutInstanceWmi\"\napi_location:\n  - \"WMINet_Utils.dll\"\napi_type:\n  - \"DLLExport\"\nf1_keywords:\n  - \"PutInstanceWmi\"\nhelpviewer_keywords:\n  - \"PutInstanceWmi function [.NET WMI and performance counters]\"\ntopic_type:\n  - \"Reference\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"PutInstanceWmi function (Unmanaged API Reference)","nodes":[{"pos":[0,49],"content":"PutInstanceWmi function (Unmanaged API Reference)","nodes":[{"content":"PutInstanceWmi function (Unmanaged API Reference)","pos":[0,49]}]}],"path":["title"],"nosxs":false},{"content":"The PutInstanceWmi function creates or updates an instance of an existing class.","nodes":[{"pos":[0,80],"content":"The PutInstanceWmi function creates or updates an instance of an existing class.","nodes":[{"content":"The PutInstanceWmi function creates or updates an instance of an existing class.","pos":[0,80]}]}],"path":["description"],"nosxs":false}],"yml":true},{"pos":[467,490],"content":"PutInstanceWmi function","linkify":"PutInstanceWmi function","nodes":[{"content":"PutInstanceWmi function","pos":[0,23]}]},{"content":"Creates or updates an instance of an existing class.","pos":[492,544]},{"content":"The instance is written to the WMI repository.","pos":[545,591]},{"pos":[680,686],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[881,891],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A pointer to the instance to be written.","pos":[902,947]},{"content":"[in] A combination of flags that affect the behavior of this function.","pos":[959,1029]},{"content":"The following values are defined in the <bpt id=\"p1\">*</bpt>WbemCli.h<ept id=\"p1\">*</ept> header file, or you can define them as constants in your code:","pos":[1030,1144],"source":" The following values are defined in the *WbemCli.h* header file, or you can define them as constants in your code:"},{"content":"Constant","pos":[1147,1155]},{"content":"Value","pos":[1158,1163]},{"content":"Description","pos":[1166,1177]},{"content":"0x20000","pos":[1252,1259]},{"content":"If set, WMI does not store any qualifiers with the <bpt id=\"p1\">**</bpt>Amended<ept id=\"p1\">**</ept> flavor.","pos":[1262,1332],"source":"If set, WMI does not store any qualifiers with the **Amended** flavor."},{"content":"If not set, it is assumed that this object is not localized, and all qualifiers are stored with this instance.","pos":[1338,1448]},{"content":"0","pos":[1484,1485]},{"content":"Create the instance if it does not exist, or overwrite it if it exists already.","pos":[1488,1567]},{"content":"1","pos":[1598,1599]},{"content":"Update the instance.","pos":[1602,1622]},{"content":"The instance must exist for the call to be successful.","pos":[1623,1677]},{"content":"2","pos":[1708,1709]},{"content":"Create the instance.","pos":[1712,1732]},{"content":"The call fails if the instance already exists.","pos":[1733,1779]},{"content":"0x10","pos":[1817,1821]},{"content":"The flag causes a semisynchronous call.","pos":[1824,1863]},{"content":"[in] Typically, this value is <ph id=\"ph1\">`null`</ph>.","pos":[1875,1912],"source":"[in] Typically, this value is `null`."},{"content":"Otherwise, it is a pointer to an <bpt id=\"p1\">[</bpt>IWbemContext<ept id=\"p1\">](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcontext)</ept> instance that can be used by the provider that is providing the requested classes.","pos":[1913,2097],"source":" Otherwise, it is a pointer to an [IWbemContext](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcontext) instance that can be used by the provider that is providing the requested classes."},{"content":"[out] If <ph id=\"ph1\">`null`</ph>, this parameter is unused.","pos":[2115,2157],"source":"[out] If `null`, this parameter is unused."},{"content":"If <ph id=\"ph1\">`lFlags`</ph> contains <ph id=\"ph2\">`WBEM_FLAG_RETURN_IMMEDIATELY`</ph>, the function returns immediately with <ph id=\"ph3\">`WBEM_S_NO_ERROR`</ph>.","pos":[2158,2267],"source":" If `lFlags` contains `WBEM_FLAG_RETURN_IMMEDIATELY`, the function returns immediately with `WBEM_S_NO_ERROR`."},{"content":"The <ph id=\"ph1\">`ppCallResult`</ph> parameter receives a pointer to a new <bpt id=\"p1\">[</bpt>IWbemCallResult<ept id=\"p1\">](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcallresult)</ept> object.","pos":[2268,2407],"source":" The `ppCallResult` parameter receives a pointer to a new [IWbemCallResult](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcallresult) object."},{"pos":[2412,2424],"content":"Return value","linkify":"Return value","nodes":[{"content":"Return value","pos":[0,12]}]},{"pos":[2426,2566],"content":"The following values returned by this function are defined in the <bpt id=\"p1\">*</bpt>WbemCli.h<ept id=\"p1\">*</ept> header file, or you can define them as constants in your code:","source":"The following values returned by this function are defined in the *WbemCli.h* header file, or you can define them as constants in your code:"},{"content":"Constant","pos":[2569,2577]},{"content":"Value","pos":[2580,2585]},{"content":"Description","pos":[2588,2599]},{"content":"0x80041003","pos":[2662,2672]},{"content":"The user does not have permission to update an instance of the specified class.","pos":[2675,2754]},{"content":"0x80041001","pos":[2777,2787]},{"content":"An unspecified error has occurred.","pos":[2790,2824]},{"content":"0x80041010","pos":[2854,2864]},{"content":"The class supporting this instance is not valid.","pos":[2867,2915]},{"content":"0x80041028","pos":[2944,2954]},{"pos":[2957,3089],"content":"a <ph id=\"ph1\">`null`</ph> was specified for a property that cannot be <ph id=\"ph2\">`null`</ph>, such as one that is marked by an <bpt id=\"p1\">**</bpt>Indexed<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Not_Null<ept id=\"p2\">**</ept> qualifier.","source":"a `null` was specified for a property that cannot be `null`, such as one that is marked by an **Indexed** or **Not_Null** qualifier."},{"content":"0x8004100f","pos":[3120,3130]},{"content":"The specified instance is not valid.","pos":[3133,3169]},{"content":"(For example, calling <ph id=\"ph1\">`PutInstanceWmi`</ph> with a class returns this value.)","pos":[3170,3242],"source":" (For example, calling `PutInstanceWmi` with a class returns this value.)"},{"content":"0x80041008","pos":[3276,3286]},{"content":"A parameter is not valid.","pos":[3289,3314]},{"content":"0x80041019","pos":[3345,3355]},{"pos":[3358,3438],"content":"The <ph id=\"ph1\">`WBEM_FLAG_CREATE_ONLY`</ph> flag was specified, but the instance already exists.","source":"The `WBEM_FLAG_CREATE_ONLY` flag was specified, but the instance already exists."},{"content":"0x80041002","pos":[3464,3474]},{"pos":[3477,3560],"content":"<ph id=\"ph1\">`WBEM_FLAG_UPDATE_ONLY`</ph> was specified in <ph id=\"ph2\">`lFlags`</ph>, but the instance does not exist.","source":"`WBEM_FLAG_UPDATE_ONLY` was specified in `lFlags`, but the instance does not exist."},{"content":"0x80041006","pos":[3590,3600]},{"content":"Not enough memory is available to complete the operation.","pos":[3603,3660]},{"content":"0x80041033","pos":[3690,3700]},{"content":"WMI was probably stopped and restarting.","pos":[3703,3743]},{"content":"Call <bpt id=\"p1\">[</bpt>ConnectServerWmi<ept id=\"p1\">](connectserverwmi.md)</ept> again.","pos":[3744,3795],"source":" Call [ConnectServerWmi](connectserverwmi.md) again."},{"content":"0x80041015","pos":[3829,3839]},{"content":"The remote procedure call (RPC) link between the current process and WMI has failed.","pos":[3842,3926]},{"content":"0","pos":[3951,3952]},{"content":"The function call was successful.","pos":[3955,3988]},{"pos":[3995,4002],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4004,4141],"content":"This function wraps a call to the <bpt id=\"p1\">[</bpt>IWbemServices::PutInstance<ept id=\"p1\">](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemservices-putinstance)</ept> method.","source":"This function wraps a call to the [IWbemServices::PutInstance](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemservices-putinstance) method."},{"content":"The <ph id=\"ph1\">`PutInstanceWmi`</ph> function supports creating instances and updating instances of existing classes only.","pos":[4143,4249],"source":"The `PutInstanceWmi` function supports creating instances and updating instances of existing classes only."},{"content":"Depending on how the <ph id=\"ph1\">`pCtx`</ph> parameter is set, either some or all of the properties of the instance are updated.","pos":[4251,4362],"source":"  Depending on how the `pCtx` parameter is set, either some or all of the properties of the instance are updated."},{"content":"When the instance pointed to by <ph id=\"ph1\">`pInst`</ph> belongs to a subclass, Windows Management calls all the providers responsible for the classes from which the subclass derives.","pos":[4364,4530],"source":"When the instance pointed to by `pInst` belongs to a subclass, Windows Management calls all the providers responsible for the classes from which the subclass derives."},{"content":"All of these providers must succeed for the original <ph id=\"ph1\">`PutInstanceWmi`</ph> request to succeed.","pos":[4531,4620],"source":" All of these providers must succeed for the original `PutInstanceWmi` request to succeed."},{"content":"The provider supporting the topmost class in the hierarchy is called first.","pos":[4621,4696]},{"content":"The calling order continues with the subclass of the topmost class and proceeds from top to bottom until Windows Management reaches the provider for the class owning the instance pointed to by <ph id=\"ph1\">`pInst`</ph>.","pos":[4697,4898],"source":" The calling order continues with the subclass of the topmost class and proceeds from top to bottom until Windows Management reaches the provider for the class owning the instance pointed to by `pInst`."},{"content":"Windows Management does not call the providers for any of the child classes of an instance.","pos":[4899,4990],"source":"\nWindows Management does not call the providers for any of the child classes of an instance."},{"content":"When an application must update an instance that belongs to a class hierarchy, the <ph id=\"ph1\">`pInst`</ph> parameter must point to the instance containing the properties to be modified.","pos":[4992,5161],"source":"When an application must update an instance that belongs to a class hierarchy, the `pInst` parameter must point to the instance containing the properties to be modified."},{"content":"That is, consider a target instance that belongs to <bpt id=\"p1\">**</bpt>ClassB<ept id=\"p1\">**</ept>.","pos":[5162,5225],"source":" That is, consider a target instance that belongs to **ClassB**."},{"content":"The <bpt id=\"p1\">**</bpt>ClassB<ept id=\"p1\">**</ept> instance derives from <bpt id=\"p2\">**</bpt>ClassA<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>ClassA<ept id=\"p3\">**</ept> defines the property <bpt id=\"p4\">**</bpt>PropA<ept id=\"p4\">**</ept>.","pos":[5226,5321],"source":" The **ClassB** instance derives from **ClassA**, and **ClassA** defines the property **PropA**."},{"content":"If an application wants to make a change to the value of <bpt id=\"p1\">**</bpt>PropA<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>ClassB<ept id=\"p2\">**</ept> instance, it must set <ph id=\"ph1\">`pInst`</ph> to that instance rather than an instance of <bpt id=\"p3\">**</bpt>ClassA<ept id=\"p3\">**</ept>.","pos":[5322,5492],"source":" If an application wants to make a change to the value of **PropA** in the **ClassB** instance, it must set `pInst` to that instance rather than an instance of **ClassA**."},{"pos":[5494,5570],"content":"Calling <ph id=\"ph1\">`PutInstanceWmi`</ph> on an instance of an abstract class is not allowed.","source":"Calling `PutInstanceWmi` on an instance of an abstract class is not allowed."},{"pos":[5572,5700],"content":"If the function call fails, you can obtain additional error information by calling the <bpt id=\"p1\">[</bpt>GetErrorInfo<ept id=\"p1\">](geterrorinfo.md)</ept> function.","source":"If the function call fails, you can obtain additional error information by calling the [GetErrorInfo](geterrorinfo.md) function."},{"pos":[5705,5717],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[5719,5823],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[5825,5853],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> WMINet_Utils.idl","source":"**Header:** WMINet_Utils.idl"},{"pos":[5855,5962],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]"},{"pos":[5967,5975],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5979,6045],"content":"<bpt id=\"p1\">[</bpt>WMI and Performance Counters (Unmanaged API Reference)<ept id=\"p1\">](index.md)</ept>","source":"[WMI and Performance Counters (Unmanaged API Reference)](index.md)"}]}