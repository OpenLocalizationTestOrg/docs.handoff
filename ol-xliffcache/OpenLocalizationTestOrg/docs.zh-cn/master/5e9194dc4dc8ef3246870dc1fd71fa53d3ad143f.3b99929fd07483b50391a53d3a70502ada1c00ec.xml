{"content":"---\ntitle: \"What's New in WPF Version 4.5\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"Windows Presentation Foundation [WPF], what's new\"\n  - \"WPF [WPF], what's new\"\nms.assetid: db086ae4-70bb-4862-95db-2eaca5216bc3\n---\n# What's New in WPF Version 4.5\n<a name=\"introduction\"></a> This topic contains information about new and enhanced features in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] version 4.5.  \n  \n This topic contains the following sections:  \n  \n-   [Ribbon control](#ribbon_control)  \n  \n-   [Improved performance when displaying large sets of grouped data](#grouped_virtualization)  \n  \n-   [New features for the VirtualizingPanel](#VirtualizingPanel)  \n  \n-   [Binding to static properties](#static_properties)  \n  \n-   [Accessing collections on non-UI Threads](#xthread_access)  \n  \n-   [Synchronously and Asynchronously validating data](#INotifyDataErrorInfo)  \n  \n-   [Automatically updating the source of a data binding](#delay)  \n  \n-   [Binding to types that Implement ICustomTypeProvider](#ICustomTypeProvider)  \n  \n-   [Retrieving data binding information from a binding expression](#binding_state)  \n  \n-   [Checking for a valid DataContext object](#DisconnectedSource)  \n  \n-   [Repositioning data as the data's values change (Live shaping)](#live_shaping)  \n  \n-   [Improved Support for Establishing a Weak Reference to an Event](#weak_event_pattern)  \n  \n-   [New methods for the Dispatcher class](#async)  \n  \n-   [Markup Extensions for Events](#events_markup_extenions)  \n  \n<a name=\"ribbon_control\"></a>   \n## Ribbon control  \n WPF 4.5 ships with a <xref:System.Windows.Controls.Ribbon.Ribbon> control that hosts a Quick Access Toolbar, Application Menu, and tabs.  For more information, see the [Ribbon Overview](/visualstudio/vsto/ribbon-overview).  \n  \n<a name=\"grouped_virtualization\"></a>   \n## Improved performance when displaying large sets of grouped data  \n UI virtualization occurs when  a subset of user interface (UI) elements are generated from a larger number of data items based on which items are visible on the screen. The <xref:System.Windows.Controls.VirtualizingPanel> defines the <xref:System.Windows.Controls.VirtualizingPanel.IsVirtualizingWhenGrouping%2A> attached property that enables UI Virtualization for grouped data.  For more information about grouping data, see How to: Sort and Group Data Using a View in XAML.  For more information about virtualizing grouped data, see the <xref:System.Windows.Controls.VirtualizingPanel.IsVirtualizingWhenGrouping%2A> attached property.  \n  \n<a name=\"VirtualizingPanel\"></a>   \n## New features for the VirtualizingPanel  \n  \n1.  You can specify whether a <xref:System.Windows.Controls.VirtualizingPanel>, such as the <xref:System.Windows.Controls.VirtualizingStackPanel>, displays partial items by using the <xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A> attached property. If <xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A> is set to <xref:System.Windows.Controls.ScrollUnit.Item>, the <xref:System.Windows.Controls.VirtualizingPanel> will only display items that are completely visible. If <xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A> is set to <xref:System.Windows.Controls.ScrollUnit.Pixel>, the <xref:System.Windows.Controls.VirtualizingPanel> can display partially visible items.  \n  \n2.  You can specify the  size of the cache before and after the viewport when the <xref:System.Windows.Controls.VirtualizingPanel> is virtualizing by using the <xref:System.Windows.Controls.VirtualizingPanel.CacheLength%2A> attached property.  The cache is the amount of space above or below the viewport in which items are not virtualized.  Using a cache to avoid generating UI elements as theyâ€™re scrolled into view can improve performance. The cache is populated at a lower priority so that the application does not become unresponsive during the operation. The <xref:System.Windows.Controls.VirtualizingPanel.CacheLengthUnit%2A?displayProperty=nameWithType> property determines the unit of measurement that is used by <xref:System.Windows.Controls.VirtualizingPanel.CacheLength%2A?displayProperty=nameWithType>.  \n  \n<a name=\"static_properties\"></a>   \n## Binding to static properties  \n You can use static properties as the source of a data binding. The data binding engine recognizes when the property's value changes if a static event is raised.  For example, if the class `SomeClass` defines a static property called `MyProperty`, `SomeClass` can define a static event that is raised when the value of `MyProperty` changes.  The static event can use either of the following signatures.  \n  \n-   `public static event EventHandler MyPropertyChanged;`  \n  \n-   `public static event EventHandler<PropertyChangedEventArgs> StaticPropertyChanged;`  \n  \n Note that in the first case, the class exposes a static event named *PropertyName*`Changed` that passes <xref:System.EventArgs> to the event handler.  In the second case, the class exposes a static event named `StaticPropertyChanged` that passes <xref:System.ComponentModel.PropertyChangedEventArgs> to the event handler. A class that implements the static property can choose to raise property-change notifications using either method.  \n  \n<a name=\"xthread_access\"></a>   \n## Accessing collections on non-UI Threads  \n WPF enables you to access and modify data collections on threads other than the one that created the collection.  This enables you to use a background thread to receive data from an external source, such as a database, and display the data on the UI thread.  By using another thread to modify the collection, your user interface remains responsive to user interaction.  \n  \n<a name=\"INotifyDataErrorInfo\"></a>   \n## Synchronously and Asynchronously validating data  \n The <xref:System.ComponentModel.INotifyDataErrorInfo> interface enables data entity classes to implement custom validation rules and expose validation results asynchronously. This interface also supports custom error objects, multiple errors per property, cross-property errors, and entity-level errors.  For more information, see <xref:System.ComponentModel.INotifyDataErrorInfo>.  \n  \n<a name=\"delay\"></a>   \n## Automatically updating the source of a data binding  \n If you use a data binding to update a data source, you can use the <xref:System.Windows.Data.BindingBase.Delay%2A> property to specify an amount of time to pass after the property changes on the target before the source updates.  For example, suppose that you have a <xref:System.Windows.Controls.Slider> that has its <xref:System.Windows.Controls.Primitives.RangeBase.Value%2A> property data two-way bound to a property of a data object and the <xref:System.Windows.Data.Binding.UpdateSourceTrigger%2A> property is set to <xref:System.Windows.Data.UpdateSourceTrigger.PropertyChanged>.  In this example, when the user moves the <xref:System.Windows.Controls.Slider>, the source updates for each pixel that the <xref:System.Windows.Controls.Slider> moves.  The source object typically needs the value of the slider only when the slider's <xref:System.Windows.Controls.Primitives.RangeBase.Value%2A> stops changing.  To prevent updating the source too often, use <xref:System.Windows.Data.BindingBase.Delay%2A> to specify that the source should not be updated until a certain amount of time elapses after the thumb stops moving.  \n  \n<a name=\"ICustomTypeProvider\"></a>   \n## Binding to types that Implement ICustomTypeProvider  \n WPF supports data binding to objects that implement <xref:System.Reflection.ICustomTypeProvider>, also known as custom types.  You can use custom types in the following cases.  \n  \n1.  As a <xref:System.Windows.PropertyPath> in a data binding. For example, the <xref:System.Windows.Data.Binding.Path%2A> property of a <xref:System.Windows.Data.Binding> can reference a property of a custom type.  \n  \n2.  As the value of the <xref:System.Windows.DataTemplate.DataType%2A> property.  \n  \n3.  As a type that determines the automatically generated columns in a <xref:System.Windows.Controls.DataGrid>.  \n  \n<a name=\"binding_state\"></a>   \n## Retrieving data binding information from a binding expression  \n In certain cases, you might get the <xref:System.Windows.Data.BindingExpression> of a <xref:System.Windows.Data.Binding> and need information about the source and target objects of the binding.  New APIs have been added to enable you to get the source or target object or the associated property.  When you have a <xref:System.Windows.Data.BindingExpression>, use the following APIs to get information about the target and source.  \n  \n|To find this value of the binding|Use this API|  \n|---------------------------------------|------------------|  \n|The target object|<xref:System.Windows.Data.BindingExpressionBase.Target%2A?displayProperty=nameWithType>|  \n|The target property|<xref:System.Windows.Data.BindingExpressionBase.TargetProperty%2A?displayProperty=nameWithType>|  \n|The source object|<xref:System.Windows.Data.BindingExpression.ResolvedSource%2A?displayProperty=nameWithType>|  \n|The source property|<xref:System.Windows.Data.BindingExpression.ResolvedSourcePropertyName%2A?displayProperty=nameWithType>|  \n|Whether the <xref:System.Windows.Data.BindingExpression> belongs to a <xref:System.Windows.Data.BindingGroup>|<xref:System.Windows.Data.BindingExpressionBase.BindingGroup%2A?displayProperty=nameWithType>|  \n|The owner of a <xref:System.Windows.Data.BindingGroup>|<xref:System.Windows.Data.BindingGroup.Owner%2A>|  \n  \n<a name=\"DisconnectedSource\"></a>   \n## Checking for a valid DataContext object  \n There are cases where the <xref:System.Windows.FrameworkElement.DataContext%2A> of an item container in an <xref:System.Windows.Controls.ItemsControl> becomes disconnected.  An item container is the UI element that displays an item in an <xref:System.Windows.Controls.ItemsControl>.  When an <xref:System.Windows.Controls.ItemsControl> is data bound to a collection, an item container is generated for each item. In some cases, item containers are removed from the visual tree. Two typical cases where an item container is removed are when an item is removed from the underlying collection and when virtualization is enabled on the <xref:System.Windows.Controls.ItemsControl>. In these cases, the <xref:System.Windows.FrameworkElement.DataContext%2A> property of the item container will be set to the sentinel object that is returned by the <xref:System.Windows.Data.BindingOperations.DisconnectedSource%2A?displayProperty=nameWithType> static property.  You should check whether the <xref:System.Windows.FrameworkElement.DataContext%2A> is equal to the <xref:System.Windows.Data.BindingOperations.DisconnectedSource%2A> object before accessing the <xref:System.Windows.FrameworkElement.DataContext%2A> of an item container.  \n  \n<a name=\"live_shaping\"></a>   \n## Repositioning data as the data's values change (Live shaping)  \n A collection of data can be grouped, sorted, or filtered. WPF 4.5 enables the data to be rearranged when the data is modified. For example, suppose that an application uses a <xref:System.Windows.Controls.DataGrid> to list stocks in a stock market and the stocks are sorted by stock value. If live sorting is enabled on the stocks' <xref:System.Windows.Data.CollectionView>, a stock's position in the <xref:System.Windows.Controls.DataGrid> moves when the value of the stock becomes greater or less than another stock's value.   For more information, see the <xref:System.ComponentModel.ICollectionViewLiveShaping> interface.  \n  \n<a name=\"weak_event_pattern\"></a>   \n## Improved Support for Establishing a Weak Reference to an Event  \n Implementing the weak event pattern is now easier because subscribers to events can participate in it without implementing an extra interface.  The generic <xref:System.Windows.WeakEventManager> class also enables subscribers to participate in the weak event pattern if a dedicated <xref:System.Windows.WeakEventManager> does not exist for a certain event.  For more information, see [Weak Event Patterns](../advanced/weak-event-patterns.md).  \n  \n<a name=\"async\"></a>   \n## New methods for the Dispatcher class  \n The Dispatcher class defines new methods for synchronous and asynchronous operations.  The synchronous <xref:System.Windows.Threading.Dispatcher.Invoke%2A> method defines overloads that take an <xref:System.Action> or <xref:System.Func%601> parameter. The new asynchronous method, <xref:System.Windows.Threading.Dispatcher.InvokeAsync%2A>, also takes an <xref:System.Action> or <xref:System.Func%601> as the callback parameter and returns a <xref:System.Windows.Threading.DispatcherOperation> or <xref:System.Windows.Threading.DispatcherOperation%601>.   The <xref:System.Windows.Threading.DispatcherOperation> and <xref:System.Windows.Threading.DispatcherOperation%601> classes define a <xref:System.Threading.Tasks.Task> property.  When you call <xref:System.Windows.Threading.Dispatcher.InvokeAsync%2A>, you can use the `await` keyword with either the <xref:System.Windows.Threading.DispatcherOperation> or the associated <xref:System.Threading.Tasks.Task>. If you need to wait synchronously for the <xref:System.Threading.Tasks.Task> that is returned by a <xref:System.Windows.Threading.DispatcherOperation> or <xref:System.Windows.Threading.DispatcherOperation%601>, call the <xref:System.Windows.Threading.TaskExtensions.DispatcherOperationWait%2A> extension method. Calling <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> will result in a deadlock if the operation is queued on a calling thread. For more information about using a <xref:System.Threading.Tasks.Task> to perform asynchronous operations, see [Task Parallelism (Task Parallel Library)](../../../standard/parallel-programming/task-based-asynchronous-programming.md).  \n  \n<a name=\"events_markup_extenions\"></a>   \n## Markup Extensions for Events  \n WPF 4.5 supports markup extensions for events.  While WPF does not define a markup extension to be used for events, third parties are able to create a markup extension that can be used with events.  \n  \n## See also\n\n- [What's New in the .NET Framework](../../whats-new/index.md)\n","nodes":[{"pos":[4,219],"embed":true,"restype":"x-metadata","content":"title: \"What's New in WPF Version 4.5\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"Windows Presentation Foundation [WPF], what's new\"\n  - \"WPF [WPF], what's new\"\nms.assetid: db086ae4-70bb-4862-95db-2eaca5216bc3","nodes":[{"content":"What's New in WPF Version 4.5","nodes":[{"pos":[0,29],"content":"What's New in WPF Version 4.5","nodes":[{"content":"What's New in WPF Version 4.5","pos":[0,29]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[226,255],"content":"What's New in WPF Version 4.5","linkify":"What's New in WPF Version 4.5","nodes":[{"content":"What's New in WPF Version 4.5","pos":[0,29]}]},{"pos":[256,443],"content":"<bpt id=\"p1\">&lt;a name=\"introduction\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> This topic contains information about new and enhanced features in <ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> version 4.5.","source":"<a name=\"introduction\"></a> This topic contains information about new and enhanced features in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] version 4.5."},{"content":"This topic contains the following sections:","pos":[450,493]},{"pos":[503,536],"content":"<bpt id=\"p1\">[</bpt>Ribbon control<ept id=\"p1\">](#ribbon_control)</ept>","source":"[Ribbon control](#ribbon_control)"},{"pos":[546,636],"content":"<bpt id=\"p1\">[</bpt>Improved performance when displaying large sets of grouped data<ept id=\"p1\">](#grouped_virtualization)</ept>","source":"[Improved performance when displaying large sets of grouped data](#grouped_virtualization)"},{"pos":[646,706],"content":"<bpt id=\"p1\">[</bpt>New features for the VirtualizingPanel<ept id=\"p1\">](#VirtualizingPanel)</ept>","source":"[New features for the VirtualizingPanel](#VirtualizingPanel)"},{"pos":[716,766],"content":"<bpt id=\"p1\">[</bpt>Binding to static properties<ept id=\"p1\">](#static_properties)</ept>","source":"[Binding to static properties](#static_properties)"},{"pos":[776,834],"content":"<bpt id=\"p1\">[</bpt>Accessing collections on non-UI Threads<ept id=\"p1\">](#xthread_access)</ept>","source":"[Accessing collections on non-UI Threads](#xthread_access)"},{"pos":[844,917],"content":"<bpt id=\"p1\">[</bpt>Synchronously and Asynchronously validating data<ept id=\"p1\">](#INotifyDataErrorInfo)</ept>","source":"[Synchronously and Asynchronously validating data](#INotifyDataErrorInfo)"},{"pos":[927,988],"content":"<bpt id=\"p1\">[</bpt>Automatically updating the source of a data binding<ept id=\"p1\">](#delay)</ept>","source":"[Automatically updating the source of a data binding](#delay)"},{"pos":[998,1073],"content":"<bpt id=\"p1\">[</bpt>Binding to types that Implement ICustomTypeProvider<ept id=\"p1\">](#ICustomTypeProvider)</ept>","source":"[Binding to types that Implement ICustomTypeProvider](#ICustomTypeProvider)"},{"pos":[1083,1162],"content":"<bpt id=\"p1\">[</bpt>Retrieving data binding information from a binding expression<ept id=\"p1\">](#binding_state)</ept>","source":"[Retrieving data binding information from a binding expression](#binding_state)"},{"pos":[1172,1234],"content":"<bpt id=\"p1\">[</bpt>Checking for a valid DataContext object<ept id=\"p1\">](#DisconnectedSource)</ept>","source":"[Checking for a valid DataContext object](#DisconnectedSource)"},{"pos":[1244,1322],"content":"<bpt id=\"p1\">[</bpt>Repositioning data as the data's values change (Live shaping)<ept id=\"p1\">](#live_shaping)</ept>","source":"[Repositioning data as the data's values change (Live shaping)](#live_shaping)"},{"pos":[1332,1417],"content":"<bpt id=\"p1\">[</bpt>Improved Support for Establishing a Weak Reference to an Event<ept id=\"p1\">](#weak_event_pattern)</ept>","source":"[Improved Support for Establishing a Weak Reference to an Event](#weak_event_pattern)"},{"pos":[1427,1473],"content":"<bpt id=\"p1\">[</bpt>New methods for the Dispatcher class<ept id=\"p1\">](#async)</ept>","source":"[New methods for the Dispatcher class](#async)"},{"pos":[1483,1539],"content":"<bpt id=\"p1\">[</bpt>Markup Extensions for Events<ept id=\"p1\">](#events_markup_extenions)</ept>","source":"[Markup Extensions for Events](#events_markup_extenions)"},{"pos":[1581,1595],"content":"Ribbon control","linkify":"Ribbon control","nodes":[{"content":"Ribbon control","pos":[0,14]}]},{"content":"WPF 4.5 ships with a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Ribbon.Ribbon&gt;</ph> control that hosts a Quick Access Toolbar, Application Menu, and tabs.","pos":[1599,1735],"source":"WPF 4.5 ships with a <xref:System.Windows.Controls.Ribbon.Ribbon> control that hosts a Quick Access Toolbar, Application Menu, and tabs."},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>Ribbon Overview<ept id=\"p1\">](/visualstudio/vsto/ribbon-overview)</ept>.","pos":[1737,1821],"source":"  For more information, see the [Ribbon Overview](/visualstudio/vsto/ribbon-overview)."},{"pos":[1871,1934],"content":"Improved performance when displaying large sets of grouped data","linkify":"Improved performance when displaying large sets of grouped data","nodes":[{"content":"Improved performance when displaying large sets of grouped data","pos":[0,63]}]},{"content":"UI virtualization occurs when  a subset of user interface (UI) elements are generated from a larger number of data items based on which items are visible on the screen.","pos":[1938,2106]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.VirtualizingPanel&gt;</ph> defines the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.VirtualizingPanel.IsVirtualizingWhenGrouping%2A&gt;</ph> attached property that enables UI Virtualization for grouped data.","pos":[2107,2317],"source":" The <xref:System.Windows.Controls.VirtualizingPanel> defines the <xref:System.Windows.Controls.VirtualizingPanel.IsVirtualizingWhenGrouping%2A> attached property that enables UI Virtualization for grouped data."},{"content":"For more information about grouping data, see How to: Sort and Group Data Using a View in XAML.","pos":[2319,2414]},{"content":"For more information about virtualizing grouped data, see the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.VirtualizingPanel.IsVirtualizingWhenGrouping%2A&gt;</ph> attached property.","pos":[2416,2575],"source":"  For more information about virtualizing grouped data, see the <xref:System.Windows.Controls.VirtualizingPanel.IsVirtualizingWhenGrouping%2A> attached property."},{"pos":[2620,2658],"content":"New features for the VirtualizingPanel","linkify":"New features for the VirtualizingPanel","nodes":[{"content":"New features for the VirtualizingPanel","pos":[0,38]}]},{"content":"You can specify whether a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.VirtualizingPanel&gt;</ph>, such as the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.VirtualizingStackPanel&gt;</ph>, displays partial items by using the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A&gt;</ph> attached property.","pos":[2668,2928],"source":"You can specify whether a <xref:System.Windows.Controls.VirtualizingPanel>, such as the <xref:System.Windows.Controls.VirtualizingStackPanel>, displays partial items by using the <xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A> attached property."},{"content":"If <ph id=\"ph1\">&lt;xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A&gt;</ph> is set to <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ScrollUnit.Item&gt;</ph>, the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.VirtualizingPanel&gt;</ph> will only display items that are completely visible.","pos":[2929,3158],"source":" If <xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A> is set to <xref:System.Windows.Controls.ScrollUnit.Item>, the <xref:System.Windows.Controls.VirtualizingPanel> will only display items that are completely visible."},{"content":"If <ph id=\"ph1\">&lt;xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A&gt;</ph> is set to <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ScrollUnit.Pixel&gt;</ph>, the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.VirtualizingPanel&gt;</ph> can display partially visible items.","pos":[3159,3373],"source":" If <xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A> is set to <xref:System.Windows.Controls.ScrollUnit.Pixel>, the <xref:System.Windows.Controls.VirtualizingPanel> can display partially visible items."},{"content":"You can specify the  size of the cache before and after the viewport when the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.VirtualizingPanel&gt;</ph> is virtualizing by using the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.VirtualizingPanel.CacheLength%2A&gt;</ph> attached property.","pos":[3383,3621],"source":"You can specify the  size of the cache before and after the viewport when the <xref:System.Windows.Controls.VirtualizingPanel> is virtualizing by using the <xref:System.Windows.Controls.VirtualizingPanel.CacheLength%2A> attached property."},{"content":"The cache is the amount of space above or below the viewport in which items are not virtualized.","pos":[3623,3719]},{"content":"Using a cache to avoid generating UI elements as theyâ€™re scrolled into view can improve performance.","pos":[3721,3821]},{"content":"The cache is populated at a lower priority so that the application does not become unresponsive during the operation.","pos":[3822,3939]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.VirtualizingPanel.CacheLengthUnit%2A?displayProperty=nameWithType&gt;</ph> property determines the unit of measurement that is used by <ph id=\"ph2\">&lt;xref:System.Windows.Controls.VirtualizingPanel.CacheLength%2A?displayProperty=nameWithType&gt;</ph>.","pos":[3940,4194],"source":" The <xref:System.Windows.Controls.VirtualizingPanel.CacheLengthUnit%2A?displayProperty=nameWithType> property determines the unit of measurement that is used by <xref:System.Windows.Controls.VirtualizingPanel.CacheLength%2A?displayProperty=nameWithType>."},{"pos":[4239,4267],"content":"Binding to static properties","linkify":"Binding to static properties","nodes":[{"content":"Binding to static properties","pos":[0,28]}]},{"content":"You can use static properties as the source of a data binding.","pos":[4271,4333]},{"content":"The data binding engine recognizes when the property's value changes if a static event is raised.","pos":[4334,4431]},{"content":"For example, if the class <ph id=\"ph1\">`SomeClass`</ph> defines a static property called <ph id=\"ph2\">`MyProperty`</ph>, <ph id=\"ph3\">`SomeClass`</ph> can define a static event that is raised when the value of <ph id=\"ph4\">`MyProperty`</ph> changes.","pos":[4433,4610],"source":"  For example, if the class `SomeClass` defines a static property called `MyProperty`, `SomeClass` can define a static event that is raised when the value of `MyProperty` changes."},{"content":"The static event can use either of the following signatures.","pos":[4612,4672]},{"content":"Note that in the first case, the class exposes a static event named <bpt id=\"p1\">*</bpt>PropertyName<ept id=\"p1\">*</ept><ph id=\"ph1\">`Changed`</ph> that passes <ph id=\"ph2\">&lt;xref:System.EventArgs&gt;</ph> to the event handler.","pos":[4835,4984],"source":"Note that in the first case, the class exposes a static event named *PropertyName*`Changed` that passes <xref:System.EventArgs> to the event handler."},{"content":"In the second case, the class exposes a static event named <ph id=\"ph1\">`StaticPropertyChanged`</ph> that passes <ph id=\"ph2\">&lt;xref:System.ComponentModel.PropertyChangedEventArgs&gt;</ph> to the event handler.","pos":[4986,5156],"source":"  In the second case, the class exposes a static event named `StaticPropertyChanged` that passes <xref:System.ComponentModel.PropertyChangedEventArgs> to the event handler."},{"content":"A class that implements the static property can choose to raise property-change notifications using either method.","pos":[5157,5271]},{"pos":[5313,5352],"content":"Accessing collections on non-UI Threads","linkify":"Accessing collections on non-UI Threads","nodes":[{"content":"Accessing collections on non-UI Threads","pos":[0,39]}]},{"content":"WPF enables you to access and modify data collections on threads other than the one that created the collection.","pos":[5356,5468]},{"content":"This enables you to use a background thread to receive data from an external source, such as a database, and display the data on the UI thread.","pos":[5470,5613]},{"content":"By using another thread to modify the collection, your user interface remains responsive to user interaction.","pos":[5615,5724]},{"pos":[5772,5820],"content":"Synchronously and Asynchronously validating data","linkify":"Synchronously and Asynchronously validating data","nodes":[{"content":"Synchronously and Asynchronously validating data","pos":[0,48]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.INotifyDataErrorInfo&gt;</ph> interface enables data entity classes to implement custom validation rules and expose validation results asynchronously.","pos":[5824,5998],"source":"The <xref:System.ComponentModel.INotifyDataErrorInfo> interface enables data entity classes to implement custom validation rules and expose validation results asynchronously."},{"content":"This interface also supports custom error objects, multiple errors per property, cross-property errors, and entity-level errors.","pos":[5999,6127]},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.ComponentModel.INotifyDataErrorInfo&gt;</ph>.","pos":[6129,6205],"source":"  For more information, see <xref:System.ComponentModel.INotifyDataErrorInfo>."},{"pos":[6238,6289],"content":"Automatically updating the source of a data binding","linkify":"Automatically updating the source of a data binding","nodes":[{"content":"Automatically updating the source of a data binding","pos":[0,51]}]},{"content":"If you use a data binding to update a data source, you can use the <ph id=\"ph1\">&lt;xref:System.Windows.Data.BindingBase.Delay%2A&gt;</ph> property to specify an amount of time to pass after the property changes on the target before the source updates.","pos":[6293,6521],"source":"If you use a data binding to update a data source, you can use the <xref:System.Windows.Data.BindingBase.Delay%2A> property to specify an amount of time to pass after the property changes on the target before the source updates."},{"content":"For example, suppose that you have a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Slider&gt;</ph> that has its <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Primitives.RangeBase.Value%2A&gt;</ph> property data two-way bound to a property of a data object and the <ph id=\"ph3\">&lt;xref:System.Windows.Data.Binding.UpdateSourceTrigger%2A&gt;</ph> property is set to <ph id=\"ph4\">&lt;xref:System.Windows.Data.UpdateSourceTrigger.PropertyChanged&gt;</ph>.","pos":[6523,6879],"source":"  For example, suppose that you have a <xref:System.Windows.Controls.Slider> that has its <xref:System.Windows.Controls.Primitives.RangeBase.Value%2A> property data two-way bound to a property of a data object and the <xref:System.Windows.Data.Binding.UpdateSourceTrigger%2A> property is set to <xref:System.Windows.Data.UpdateSourceTrigger.PropertyChanged>."},{"content":"In this example, when the user moves the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Slider&gt;</ph>, the source updates for each pixel that the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Slider&gt;</ph> moves.","pos":[6881,7048],"source":"  In this example, when the user moves the <xref:System.Windows.Controls.Slider>, the source updates for each pixel that the <xref:System.Windows.Controls.Slider> moves."},{"content":"The source object typically needs the value of the slider only when the slider's <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.RangeBase.Value%2A&gt;</ph> stops changing.","pos":[7050,7207],"source":"  The source object typically needs the value of the slider only when the slider's <xref:System.Windows.Controls.Primitives.RangeBase.Value%2A> stops changing."},{"content":"To prevent updating the source too often, use <ph id=\"ph1\">&lt;xref:System.Windows.Data.BindingBase.Delay%2A&gt;</ph> to specify that the source should not be updated until a certain amount of time elapses after the thumb stops moving.","pos":[7209,7420],"source":"  To prevent updating the source too often, use <xref:System.Windows.Data.BindingBase.Delay%2A> to specify that the source should not be updated until a certain amount of time elapses after the thumb stops moving."},{"pos":[7467,7518],"content":"Binding to types that Implement ICustomTypeProvider","linkify":"Binding to types that Implement ICustomTypeProvider","nodes":[{"content":"Binding to types that Implement ICustomTypeProvider","pos":[0,51]}]},{"content":"WPF supports data binding to objects that implement <ph id=\"ph1\">&lt;xref:System.Reflection.ICustomTypeProvider&gt;</ph>, also known as custom types.","pos":[7522,7647],"source":"WPF supports data binding to objects that implement <xref:System.Reflection.ICustomTypeProvider>, also known as custom types."},{"content":"You can use custom types in the following cases.","pos":[7649,7697]},{"content":"As a <ph id=\"ph1\">&lt;xref:System.Windows.PropertyPath&gt;</ph> in a data binding.","pos":[7707,7765],"source":"As a <xref:System.Windows.PropertyPath> in a data binding."},{"content":"For example, the <ph id=\"ph1\">&lt;xref:System.Windows.Data.Binding.Path%2A&gt;</ph> property of a <ph id=\"ph2\">&lt;xref:System.Windows.Data.Binding&gt;</ph> can reference a property of a custom type.","pos":[7766,7917],"source":" For example, the <xref:System.Windows.Data.Binding.Path%2A> property of a <xref:System.Windows.Data.Binding> can reference a property of a custom type."},{"pos":[7927,8003],"content":"As the value of the <ph id=\"ph1\">&lt;xref:System.Windows.DataTemplate.DataType%2A&gt;</ph> property.","source":"As the value of the <xref:System.Windows.DataTemplate.DataType%2A> property."},{"pos":[8013,8120],"content":"As a type that determines the automatically generated columns in a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph>.","source":"As a type that determines the automatically generated columns in a <xref:System.Windows.Controls.DataGrid>."},{"pos":[8161,8222],"content":"Retrieving data binding information from a binding expression","linkify":"Retrieving data binding information from a binding expression","nodes":[{"content":"Retrieving data binding information from a binding expression","pos":[0,61]}]},{"content":"In certain cases, you might get the <ph id=\"ph1\">&lt;xref:System.Windows.Data.BindingExpression&gt;</ph> of a <ph id=\"ph2\">&lt;xref:System.Windows.Data.Binding&gt;</ph> and need information about the source and target objects of the binding.","pos":[8226,8419],"source":"In certain cases, you might get the <xref:System.Windows.Data.BindingExpression> of a <xref:System.Windows.Data.Binding> and need information about the source and target objects of the binding."},{"content":"New APIs have been added to enable you to get the source or target object or the associated property.","pos":[8421,8522]},{"content":"When you have a <ph id=\"ph1\">&lt;xref:System.Windows.Data.BindingExpression&gt;</ph>, use the following APIs to get information about the target and source.","pos":[8524,8656],"source":"  When you have a <xref:System.Windows.Data.BindingExpression>, use the following APIs to get information about the target and source."},{"content":"To find this value of the binding","pos":[8663,8696]},{"content":"Use this API","pos":[8697,8709]},{"content":"The target object","pos":[8777,8794]},{"content":"The target property","pos":[8887,8906]},{"content":"The source object","pos":[9007,9024]},{"content":"The source property","pos":[9121,9140]},{"pos":[9249,9358],"content":"Whether the <ph id=\"ph1\">&lt;xref:System.Windows.Data.BindingExpression&gt;</ph> belongs to a <ph id=\"ph2\">&lt;xref:System.Windows.Data.BindingGroup&gt;</ph>","source":"Whether the <xref:System.Windows.Data.BindingExpression> belongs to a <xref:System.Windows.Data.BindingGroup>"},{"pos":[9457,9511],"content":"The owner of a <ph id=\"ph1\">&lt;xref:System.Windows.Data.BindingGroup&gt;</ph>","source":"The owner of a <xref:System.Windows.Data.BindingGroup>"},{"pos":[9607,9646],"content":"Checking for a valid DataContext object","linkify":"Checking for a valid DataContext object","nodes":[{"content":"Checking for a valid DataContext object","pos":[0,39]}]},{"content":"There are cases where the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.DataContext%2A&gt;</ph> of an item container in an <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ItemsControl&gt;</ph> becomes disconnected.","pos":[9650,9822],"source":"There are cases where the <xref:System.Windows.FrameworkElement.DataContext%2A> of an item container in an <xref:System.Windows.Controls.ItemsControl> becomes disconnected."},{"content":"An item container is the UI element that displays an item in an <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ItemsControl&gt;</ph>.","pos":[9824,9932],"source":"  An item container is the UI element that displays an item in an <xref:System.Windows.Controls.ItemsControl>."},{"content":"When an <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ItemsControl&gt;</ph> is data bound to a collection, an item container is generated for each item.","pos":[9934,10062],"source":"  When an <xref:System.Windows.Controls.ItemsControl> is data bound to a collection, an item container is generated for each item."},{"content":"In some cases, item containers are removed from the visual tree.","pos":[10063,10127]},{"content":"Two typical cases where an item container is removed are when an item is removed from the underlying collection and when virtualization is enabled on the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ItemsControl&gt;</ph>.","pos":[10128,10326],"source":" Two typical cases where an item container is removed are when an item is removed from the underlying collection and when virtualization is enabled on the <xref:System.Windows.Controls.ItemsControl>."},{"content":"In these cases, the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.DataContext%2A&gt;</ph> property of the item container will be set to the sentinel object that is returned by the <ph id=\"ph2\">&lt;xref:System.Windows.Data.BindingOperations.DisconnectedSource%2A?displayProperty=nameWithType&gt;</ph> static property.","pos":[10327,10603],"source":" In these cases, the <xref:System.Windows.FrameworkElement.DataContext%2A> property of the item container will be set to the sentinel object that is returned by the <xref:System.Windows.Data.BindingOperations.DisconnectedSource%2A?displayProperty=nameWithType> static property."},{"content":"You should check whether the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.DataContext%2A&gt;</ph> is equal to the <ph id=\"ph2\">&lt;xref:System.Windows.Data.BindingOperations.DisconnectedSource%2A&gt;</ph> object before accessing the <ph id=\"ph3\">&lt;xref:System.Windows.FrameworkElement.DataContext%2A&gt;</ph> of an item container.","pos":[10605,10874],"source":"  You should check whether the <xref:System.Windows.FrameworkElement.DataContext%2A> is equal to the <xref:System.Windows.Data.BindingOperations.DisconnectedSource%2A> object before accessing the <xref:System.Windows.FrameworkElement.DataContext%2A> of an item container."},{"pos":[10914,10975],"content":"Repositioning data as the data's values change (Live shaping)","linkify":"Repositioning data as the data's values change (Live shaping)","nodes":[{"content":"Repositioning data as the data's values change (Live shaping)","pos":[0,61]}]},{"content":"A collection of data can be grouped, sorted, or filtered.","pos":[10979,11036]},{"content":"WPF 4.5 enables the data to be rearranged when the data is modified.","pos":[11037,11105]},{"content":"For example, suppose that an application uses a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> to list stocks in a stock market and the stocks are sorted by stock value.","pos":[11106,11268],"source":" For example, suppose that an application uses a <xref:System.Windows.Controls.DataGrid> to list stocks in a stock market and the stocks are sorted by stock value."},{"content":"If live sorting is enabled on the stocks' <ph id=\"ph1\">&lt;xref:System.Windows.Data.CollectionView&gt;</ph>, a stock's position in the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> moves when the value of the stock becomes greater or less than another stock's value.","pos":[11269,11505],"source":" If live sorting is enabled on the stocks' <xref:System.Windows.Data.CollectionView>, a stock's position in the <xref:System.Windows.Controls.DataGrid> moves when the value of the stock becomes greater or less than another stock's value."},{"content":"For more information, see the <ph id=\"ph1\">&lt;xref:System.ComponentModel.ICollectionViewLiveShaping&gt;</ph> interface.","pos":[11508,11604],"source":"   For more information, see the <xref:System.ComponentModel.ICollectionViewLiveShaping> interface."},{"pos":[11650,11712],"content":"Improved Support for Establishing a Weak Reference to an Event","linkify":"Improved Support for Establishing a Weak Reference to an Event","nodes":[{"content":"Improved Support for Establishing a Weak Reference to an Event","pos":[0,62]}]},{"content":"Implementing the weak event pattern is now easier because subscribers to events can participate in it without implementing an extra interface.","pos":[11716,11858]},{"content":"The generic <ph id=\"ph1\">&lt;xref:System.Windows.WeakEventManager&gt;</ph> class also enables subscribers to participate in the weak event pattern if a dedicated <ph id=\"ph2\">&lt;xref:System.Windows.WeakEventManager&gt;</ph> does not exist for a certain event.","pos":[11860,12072],"source":"  The generic <xref:System.Windows.WeakEventManager> class also enables subscribers to participate in the weak event pattern if a dedicated <xref:System.Windows.WeakEventManager> does not exist for a certain event."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Weak Event Patterns<ept id=\"p1\">](../advanced/weak-event-patterns.md)</ept>.","pos":[12074,12158],"source":"  For more information, see [Weak Event Patterns](../advanced/weak-event-patterns.md)."},{"pos":[12191,12227],"content":"New methods for the Dispatcher class","linkify":"New methods for the Dispatcher class","nodes":[{"content":"New methods for the Dispatcher class","pos":[0,36]}]},{"content":"The Dispatcher class defines new methods for synchronous and asynchronous operations.","pos":[12231,12316]},{"content":"The synchronous <ph id=\"ph1\">&lt;xref:System.Windows.Threading.Dispatcher.Invoke%2A&gt;</ph> method defines overloads that take an <ph id=\"ph2\">&lt;xref:System.Action&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Func%601&gt;</ph> parameter.","pos":[12318,12482],"source":"  The synchronous <xref:System.Windows.Threading.Dispatcher.Invoke%2A> method defines overloads that take an <xref:System.Action> or <xref:System.Func%601> parameter."},{"content":"The new asynchronous method, <ph id=\"ph1\">&lt;xref:System.Windows.Threading.Dispatcher.InvokeAsync%2A&gt;</ph>, also takes an <ph id=\"ph2\">&lt;xref:System.Action&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Func%601&gt;</ph> as the callback parameter and returns a <ph id=\"ph4\">&lt;xref:System.Windows.Threading.DispatcherOperation&gt;</ph> or <ph id=\"ph5\">&lt;xref:System.Windows.Threading.DispatcherOperation%601&gt;</ph>.","pos":[12483,12783],"source":" The new asynchronous method, <xref:System.Windows.Threading.Dispatcher.InvokeAsync%2A>, also takes an <xref:System.Action> or <xref:System.Func%601> as the callback parameter and returns a <xref:System.Windows.Threading.DispatcherOperation> or <xref:System.Windows.Threading.DispatcherOperation%601>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Threading.DispatcherOperation&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Threading.DispatcherOperation%601&gt;</ph> classes define a <ph id=\"ph3\">&lt;xref:System.Threading.Tasks.Task&gt;</ph> property.","pos":[12786,12963],"source":"   The <xref:System.Windows.Threading.DispatcherOperation> and <xref:System.Windows.Threading.DispatcherOperation%601> classes define a <xref:System.Threading.Tasks.Task> property."},{"content":"When you call <ph id=\"ph1\">&lt;xref:System.Windows.Threading.Dispatcher.InvokeAsync%2A&gt;</ph>, you can use the <ph id=\"ph2\">`await`</ph> keyword with either the <ph id=\"ph3\">&lt;xref:System.Windows.Threading.DispatcherOperation&gt;</ph> or the associated <ph id=\"ph4\">&lt;xref:System.Threading.Tasks.Task&gt;</ph>.","pos":[12965,13191],"source":"  When you call <xref:System.Windows.Threading.Dispatcher.InvokeAsync%2A>, you can use the `await` keyword with either the <xref:System.Windows.Threading.DispatcherOperation> or the associated <xref:System.Threading.Tasks.Task>."},{"content":"If you need to wait synchronously for the <ph id=\"ph1\">&lt;xref:System.Threading.Tasks.Task&gt;</ph> that is returned by a <ph id=\"ph2\">&lt;xref:System.Windows.Threading.DispatcherOperation&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Windows.Threading.DispatcherOperation%601&gt;</ph>, call the <ph id=\"ph4\">&lt;xref:System.Windows.Threading.TaskExtensions.DispatcherOperationWait%2A&gt;</ph> extension method.","pos":[13192,13503],"source":" If you need to wait synchronously for the <xref:System.Threading.Tasks.Task> that is returned by a <xref:System.Windows.Threading.DispatcherOperation> or <xref:System.Windows.Threading.DispatcherOperation%601>, call the <xref:System.Windows.Threading.TaskExtensions.DispatcherOperationWait%2A> extension method."},{"content":"Calling <ph id=\"ph1\">&lt;xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType&gt;</ph> will result in a deadlock if the operation is queued on a calling thread.","pos":[13504,13657],"source":" Calling <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> will result in a deadlock if the operation is queued on a calling thread."},{"content":"For more information about using a <ph id=\"ph1\">&lt;xref:System.Threading.Tasks.Task&gt;</ph> to perform asynchronous operations, see <bpt id=\"p1\">[</bpt>Task Parallelism (Task Parallel Library)<ept id=\"p1\">](../../../standard/parallel-programming/task-based-asynchronous-programming.md)</ept>.","pos":[13658,13890],"source":" For more information about using a <xref:System.Threading.Tasks.Task> to perform asynchronous operations, see [Task Parallelism (Task Parallel Library)](../../../standard/parallel-programming/task-based-asynchronous-programming.md)."},{"pos":[13941,13969],"content":"Markup Extensions for Events","linkify":"Markup Extensions for Events","nodes":[{"content":"Markup Extensions for Events","pos":[0,28]}]},{"content":"WPF 4.5 supports markup extensions for events.","pos":[13973,14019]},{"content":"While WPF does not define a markup extension to be used for events, third parties are able to create a markup extension that can be used with events.","pos":[14021,14170]},{"pos":[14179,14187],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[14191,14251],"content":"<bpt id=\"p1\">[</bpt>What's New in the .NET Framework<ept id=\"p1\">](../../whats-new/index.md)</ept>","source":"[What's New in the .NET Framework](../../whats-new/index.md)"}]}