{"content":"---\ntitle: \"How to: Print in Windows Forms Using Print Preview\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"printing [Windows Forms], using print preview\"\n  - \"printing [Windows Forms], with print preview\"\n  - \"print preview\"\nms.assetid: 4a16f7e2-ae10-4485-b0ae-3d558334d0fe\n---\n# How to: Print in Windows Forms Using Print Preview\nIt is very common in Windows Forms programming to offer print preview in addition to printing services. An easy way to add print preview services to your application is to use a <xref:System.Windows.Forms.PrintPreviewDialog> control in combination with the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event-handling logic for printing a file.  \n  \n### To preview a text document with a PrintPreviewDialog control  \n  \n1.  Add a <xref:System.Windows.Forms.PrintPreviewDialog>, <xref:System.Drawing.Printing.PrintDocument>, and two strings to your form.  \n  \n     [!code-csharp[System.Drawing.Printing.PrintPreviewExample#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/CS/Form1.cs#1)]\n     [!code-vb[System.Drawing.Printing.PrintPreviewExample#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/VB/Form1.vb#1)]  \n  \n2.  Set the <xref:System.Drawing.Printing.PrintDocument.DocumentName%2A> property to the document you wish to print, and open and read the document's contents to the string you added previously.  \n  \n     [!code-csharp[System.Drawing.Printing.PrintPreviewExample#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/CS/Form1.cs#2)]\n     [!code-vb[System.Drawing.Printing.PrintPreviewExample#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/VB/Form1.vb#2)]  \n  \n3.  As you would for printing the document, in the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event handler, use the <xref:System.Drawing.Printing.PrintPageEventArgs.Graphics%2A> property of the <xref:System.Drawing.Printing.PrintPageEventArgs> class and the file contents to calculate lines per page and render the document's contents. After each page is drawn, check to see if it is the last page, and set the <xref:System.Drawing.Printing.PrintPageEventArgs.HasMorePages%2A> property of the <xref:System.Drawing.Printing.PrintPageEventArgs> accordingly. The <xref:System.Drawing.Printing.PrintDocument.PrintPage> event is raised until <xref:System.Drawing.Printing.PrintPageEventArgs.HasMorePages%2A> is `false`. When the document has finished rendering, reset the string to be rendered. Also, make sure the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event is associated with its event-handling method.  \n  \n    > [!NOTE]\n    >  You may have already completed steps 2 and 3 if you have implemented printing in your application.  \n  \n     In the following code example, the event handler is used to print the \"testPage.txt\" file in the same font used on the form.  \n  \n     [!code-csharp[System.Drawing.Printing.PrintPreviewExample#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/CS/Form1.cs#3)]\n     [!code-vb[System.Drawing.Printing.PrintPreviewExample#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/VB/Form1.vb#3)]  \n  \n4.  Set the <xref:System.Windows.Forms.PrintPreviewDialog.Document%2A> property of the <xref:System.Windows.Forms.PrintPreviewDialog> control to the <xref:System.Drawing.Printing.PrintDocument> component on the form.  \n  \n     [!code-csharp[System.Drawing.Printing.PrintPreviewExample#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/CS/Form1.cs#5)]\n     [!code-vb[System.Drawing.Printing.PrintPreviewExample#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/VB/Form1.vb#5)]  \n  \n5.  Call the <xref:System.Windows.Forms.CommonDialog.ShowDialog%2A> method on the <xref:System.Windows.Forms.PrintPreviewDialog> control. You would typically call <xref:System.Windows.Forms.CommonDialog.ShowDialog%2A> from the <xref:System.Windows.Forms.Control.Click> event-handling method of a button. Calling <xref:System.Windows.Forms.CommonDialog.ShowDialog%2A> raises the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event and renders the output to the <xref:System.Windows.Forms.PrintPreviewDialog> control. When the user clicks the print icon on the dialog, the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event is raised again, sending the output to the printer instead of the preview dialog. This is why the string is reset at the end of the rendering process in step 3.  \n  \n     The following code example shows the <xref:System.Windows.Forms.Control.Click> event-handling method for a button on the form. This event-handling method calls the methods to read the document and show the print preview dialog.  \n  \n     [!code-csharp[System.Drawing.Printing.PrintPreviewExample#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/CS/Form1.cs#4)]\n     [!code-vb[System.Drawing.Printing.PrintPreviewExample#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/VB/Form1.vb#4)]  \n  \n## Example  \n [!code-csharp[System.Drawing.Printing.PrintPreviewExample#0](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/CS/Form1.cs#0)]\n [!code-vb[System.Drawing.Printing.PrintPreviewExample#0](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/VB/Form1.vb#0)]  \n  \n## Compiling the Code  \n This example requires:  \n  \n-   References to the System, System.Windows.Forms, System.Drawing assemblies.  \n  \n-   For information about building this example from the command line for Visual Basic or Visual C#, see [Building from the Command Line](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md). You can also build this example in Visual Studio by pasting the code into a new project.  \n  \n## See also\n\n- [How to: Print a Multi-Page Text File in Windows Forms](how-to-print-a-multi-page-text-file-in-windows-forms.md)\n- [Windows Forms Print Support](windows-forms-print-support.md)\n- [More Secure Printing in Windows Forms](../more-secure-printing-in-windows-forms.md)\n","nodes":[{"pos":[4,313],"embed":true,"restype":"x-metadata","content":"title: \"How to: Print in Windows Forms Using Print Preview\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"printing [Windows Forms], using print preview\"\n  - \"printing [Windows Forms], with print preview\"\n  - \"print preview\"\nms.assetid: 4a16f7e2-ae10-4485-b0ae-3d558334d0fe","nodes":[{"content":"How to: Print in Windows Forms Using Print Preview","nodes":[{"pos":[0,50],"content":"How to: Print in Windows Forms Using Print Preview","nodes":[{"content":"How to: Print in Windows Forms Using Print Preview","pos":[0,50]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[320,370],"content":"How to: Print in Windows Forms Using Print Preview","linkify":"How to: Print in Windows Forms Using Print Preview","nodes":[{"content":"How to: Print in Windows Forms Using Print Preview","pos":[0,50]}]},{"content":"It is very common in Windows Forms programming to offer print preview in addition to printing services.","pos":[371,474]},{"content":"An easy way to add print preview services to your application is to use a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.PrintPreviewDialog&gt;</ph> control in combination with the <ph id=\"ph2\">&lt;xref:System.Drawing.Printing.PrintDocument.PrintPage&gt;</ph> event-handling logic for printing a file.","pos":[475,724],"source":" An easy way to add print preview services to your application is to use a <xref:System.Windows.Forms.PrintPreviewDialog> control in combination with the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event-handling logic for printing a file."},{"pos":[734,794],"content":"To preview a text document with a PrintPreviewDialog control","linkify":"To preview a text document with a PrintPreviewDialog control","nodes":[{"content":"To preview a text document with a PrintPreviewDialog control","pos":[0,60]}]},{"pos":[804,933],"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.PrintPreviewDialog&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Drawing.Printing.PrintDocument&gt;</ph>, and two strings to your form.","source":"Add a <xref:System.Windows.Forms.PrintPreviewDialog>, <xref:System.Drawing.Printing.PrintDocument>, and two strings to your form."},{"pos":[944,1285],"content":"[!code-csharp[System.Drawing.Printing.PrintPreviewExample#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/CS/Form1.cs#1)]\n [!code-vb[System.Drawing.Printing.PrintPreviewExample#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/VB/Form1.vb#1)]","leadings":["","    "],"nodes":[]},{"pos":[1295,1485],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintDocument.DocumentName%2A&gt;</ph> property to the document you wish to print, and open and read the document's contents to the string you added previously.","source":"Set the <xref:System.Drawing.Printing.PrintDocument.DocumentName%2A> property to the document you wish to print, and open and read the document's contents to the string you added previously."},{"pos":[1496,1837],"content":"[!code-csharp[System.Drawing.Printing.PrintPreviewExample#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/CS/Form1.cs#2)]\n [!code-vb[System.Drawing.Printing.PrintPreviewExample#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/VB/Form1.vb#2)]","leadings":["","    "],"nodes":[]},{"content":"As you would for printing the document, in the <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintDocument.PrintPage&gt;</ph> event handler, use the <ph id=\"ph2\">&lt;xref:System.Drawing.Printing.PrintPageEventArgs.Graphics%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.Drawing.Printing.PrintPageEventArgs&gt;</ph> class and the file contents to calculate lines per page and render the document's contents.","pos":[1847,2191],"source":"As you would for printing the document, in the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event handler, use the <xref:System.Drawing.Printing.PrintPageEventArgs.Graphics%2A> property of the <xref:System.Drawing.Printing.PrintPageEventArgs> class and the file contents to calculate lines per page and render the document's contents."},{"content":"After each page is drawn, check to see if it is the last page, and set the <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintPageEventArgs.HasMorePages%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Drawing.Printing.PrintPageEventArgs&gt;</ph> accordingly.","pos":[2192,2411],"source":" After each page is drawn, check to see if it is the last page, and set the <xref:System.Drawing.Printing.PrintPageEventArgs.HasMorePages%2A> property of the <xref:System.Drawing.Printing.PrintPageEventArgs> accordingly."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintDocument.PrintPage&gt;</ph> event is raised until <ph id=\"ph2\">&lt;xref:System.Drawing.Printing.PrintPageEventArgs.HasMorePages%2A&gt;</ph> is <ph id=\"ph3\">`false`</ph>.","pos":[2412,2570],"source":" The <xref:System.Drawing.Printing.PrintDocument.PrintPage> event is raised until <xref:System.Drawing.Printing.PrintPageEventArgs.HasMorePages%2A> is `false`."},{"content":"When the document has finished rendering, reset the string to be rendered.","pos":[2571,2645]},{"content":"Also, make sure the <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintDocument.PrintPage&gt;</ph> event is associated with its event-handling method.","pos":[2646,2772],"source":" Also, make sure the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event is associated with its event-handling method."},{"pos":[2784,2897],"content":"[!NOTE]\nYou may have already completed steps 2 and 3 if you have implemented printing in your application.","leadings":["","    >  "],"nodes":[{"content":"You may have already completed steps 2 and 3 if you have implemented printing in your application.","pos":[8,106]}]},{"content":"In the following code example, the event handler is used to print the \"testPage.txt\" file in the same font used on the form.","pos":[2908,3032]},{"pos":[3043,3384],"content":"[!code-csharp[System.Drawing.Printing.PrintPreviewExample#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/CS/Form1.cs#3)]\n [!code-vb[System.Drawing.Printing.PrintPreviewExample#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/VB/Form1.vb#3)]","leadings":["","    "],"nodes":[]},{"pos":[3394,3606],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.PrintPreviewDialog.Document%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.PrintPreviewDialog&gt;</ph> control to the <ph id=\"ph3\">&lt;xref:System.Drawing.Printing.PrintDocument&gt;</ph> component on the form.","source":"Set the <xref:System.Windows.Forms.PrintPreviewDialog.Document%2A> property of the <xref:System.Windows.Forms.PrintPreviewDialog> control to the <xref:System.Drawing.Printing.PrintDocument> component on the form."},{"pos":[3617,3958],"content":"[!code-csharp[System.Drawing.Printing.PrintPreviewExample#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/CS/Form1.cs#5)]\n [!code-vb[System.Drawing.Printing.PrintPreviewExample#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/VB/Form1.vb#5)]","leadings":["","    "],"nodes":[]},{"content":"Call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.CommonDialog.ShowDialog%2A&gt;</ph> method on the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.PrintPreviewDialog&gt;</ph> control.","pos":[3968,4101],"source":"Call the <xref:System.Windows.Forms.CommonDialog.ShowDialog%2A> method on the <xref:System.Windows.Forms.PrintPreviewDialog> control."},{"content":"You would typically call <ph id=\"ph1\">&lt;xref:System.Windows.Forms.CommonDialog.ShowDialog%2A&gt;</ph> from the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event-handling method of a button.","pos":[4102,4267],"source":" You would typically call <xref:System.Windows.Forms.CommonDialog.ShowDialog%2A> from the <xref:System.Windows.Forms.Control.Click> event-handling method of a button."},{"content":"Calling <ph id=\"ph1\">&lt;xref:System.Windows.Forms.CommonDialog.ShowDialog%2A&gt;</ph> raises the <ph id=\"ph2\">&lt;xref:System.Drawing.Printing.PrintDocument.PrintPage&gt;</ph> event and renders the output to the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.PrintPreviewDialog&gt;</ph> control.","pos":[4268,4488],"source":" Calling <xref:System.Windows.Forms.CommonDialog.ShowDialog%2A> raises the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event and renders the output to the <xref:System.Windows.Forms.PrintPreviewDialog> control."},{"content":"When the user clicks the print icon on the dialog, the <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintDocument.PrintPage&gt;</ph> event is raised again, sending the output to the printer instead of the preview dialog.","pos":[4489,4686],"source":" When the user clicks the print icon on the dialog, the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event is raised again, sending the output to the printer instead of the preview dialog."},{"content":"This is why the string is reset at the end of the rendering process in step 3.","pos":[4687,4765]},{"content":"The following code example shows the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event-handling method for a button on the form.","pos":[4776,4902],"source":"The following code example shows the <xref:System.Windows.Forms.Control.Click> event-handling method for a button on the form."},{"content":"This event-handling method calls the methods to read the document and show the print preview dialog.","pos":[4903,5003]},{"pos":[5014,5355],"content":"[!code-csharp[System.Drawing.Printing.PrintPreviewExample#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/CS/Form1.cs#4)]\n [!code-vb[System.Drawing.Printing.PrintPreviewExample#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintPreviewExample/VB/Form1.vb#4)]","leadings":["","    "],"nodes":[]},{"pos":[5364,5371],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5721,5739],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"This example requires:","pos":[5743,5765]},{"content":"References to the System, System.Windows.Forms, System.Drawing assemblies.","pos":[5775,5849]},{"content":"For information about building this example from the command line for Visual Basic or Visual C#, see <bpt id=\"p1\">[</bpt>Building from the Command Line<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md)</ept> or <bpt id=\"p2\">[</bpt>Command-line Building With csc.exe<ept id=\"p2\">](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)</ept>.","pos":[5859,6213],"source":"For information about building this example from the command line for Visual Basic or Visual C#, see [Building from the Command Line](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)."},{"content":"You can also build this example in Visual Studio by pasting the code into a new project.","pos":[6214,6302]},{"pos":[6311,6319],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6323,6435],"content":"<bpt id=\"p1\">[</bpt>How to: Print a Multi-Page Text File in Windows Forms<ept id=\"p1\">](how-to-print-a-multi-page-text-file-in-windows-forms.md)</ept>","source":"[How to: Print a Multi-Page Text File in Windows Forms](how-to-print-a-multi-page-text-file-in-windows-forms.md)"},{"pos":[6438,6499],"content":"<bpt id=\"p1\">[</bpt>Windows Forms Print Support<ept id=\"p1\">](windows-forms-print-support.md)</ept>","source":"[Windows Forms Print Support](windows-forms-print-support.md)"},{"pos":[6502,6586],"content":"<bpt id=\"p1\">[</bpt>More Secure Printing in Windows Forms<ept id=\"p1\">](../more-secure-printing-in-windows-forms.md)</ept>","source":"[More Secure Printing in Windows Forms](../more-secure-printing-in-windows-forms.md)"}]}