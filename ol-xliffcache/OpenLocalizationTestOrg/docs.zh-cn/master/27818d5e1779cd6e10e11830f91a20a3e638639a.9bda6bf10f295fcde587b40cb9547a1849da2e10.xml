{"content":"---\ntitle: \"Security and User Input\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"security [.NET Framework], user input\"\n  - \"user input, security\"\n  - \"secure coding, user input\"\n  - \"code security, user input\"\nms.assetid: 9141076a-96c9-4b01-93de-366bb1d858bc\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Security and User Input\nUser data, which is any kind of input (data from a Web request or URL, input to controls of a Microsoft Windows Forms application, and so on), can adversely influence code because often that data is used directly as parameters to call other code. This situation is analogous to malicious code calling your code with strange parameters, and the same precautions should be taken. User input is actually harder to make safe because there is no stack frame to trace the presence of the potentially untrusted data.  \n  \n These are among the subtlest and hardest security bugs to find because, although they can exist in code that is seemingly unrelated to security, they are a gateway to pass bad data through to other code. To look for these bugs, follow any kind of input data, imagine what the range of possible values might be, and consider whether the code seeing this data can handle all those cases. You can fix these bugs through range checking and rejecting any input the code cannot handle.  \n  \n Some important considerations involving user data include the following:  \n  \n-   Any user data in a server response runs in the context of the server's site on the client. If your Web server takes user data and inserts it into the returned Web page, it might, for example, include a **\\<script>** tag and run as if from the server.  \n  \n-   Remember that the client can request any URL.  \n  \n-   Consider tricky or invalid paths:  \n  \n    -   ..\\ , extremely long paths.  \n  \n    -   Use of wild card characters (*).  \n  \n    -   Token expansion (%token%).  \n  \n    -   Strange forms of paths with special meaning.  \n  \n    -   Alternate file system stream names such as `filename::$DATA`.  \n  \n    -   Short versions of file names such as `longfi~1` for `longfilename`.  \n  \n-   Remember that Eval(userdata) can do anything.  \n  \n-   Be wary of late binding to a name that includes some user data.  \n  \n-   If you are dealing with Web data, consider the various forms of escapes that are permissible, including:  \n  \n    -   Hexadecimal escapes (%nn).  \n  \n    -   Unicode escapes (%nnn).  \n  \n    -   Overlong UTF-8 escapes (%nn%nn).  \n  \n    -   Double escapes (%nn becomes %mmnn, where %mm is the escape for '%').  \n  \n-   Be wary of user names that might have more than one canonical format. For example, you can often use either the MYDOMAIN\\\\*username* form or the *username*@mydomain.example.com form.  \n  \n## See also\n\n- [Secure Coding Guidelines](../../../docs/standard/security/secure-coding-guidelines.md)\n","nodes":[{"pos":[4,332],"embed":true,"restype":"x-metadata","content":"title: \"Security and User Input\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"security [.NET Framework], user input\"\n  - \"user input, security\"\n  - \"secure coding, user input\"\n  - \"code security, user input\"\nms.assetid: 9141076a-96c9-4b01-93de-366bb1d858bc\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Security and User Input","nodes":[{"pos":[0,23],"content":"Security and User Input","nodes":[{"content":"Security and User Input","pos":[0,23]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[339,362],"content":"Security and User Input","linkify":"Security and User Input","nodes":[{"content":"Security and User Input","pos":[0,23]}]},{"content":"User data, which is any kind of input (data from a Web request or URL, input to controls of a Microsoft Windows Forms application, and so on), can adversely influence code because often that data is used directly as parameters to call other code.","pos":[363,609]},{"content":"This situation is analogous to malicious code calling your code with strange parameters, and the same precautions should be taken.","pos":[610,740]},{"content":"User input is actually harder to make safe because there is no stack frame to trace the presence of the potentially untrusted data.","pos":[741,872]},{"content":"These are among the subtlest and hardest security bugs to find because, although they can exist in code that is seemingly unrelated to security, they are a gateway to pass bad data through to other code.","pos":[879,1082]},{"content":"To look for these bugs, follow any kind of input data, imagine what the range of possible values might be, and consider whether the code seeing this data can handle all those cases.","pos":[1083,1264]},{"content":"You can fix these bugs through range checking and rejecting any input the code cannot handle.","pos":[1265,1358]},{"content":"Some important considerations involving user data include the following:","pos":[1365,1437]},{"content":"Any user data in a server response runs in the context of the server's site on the client.","pos":[1447,1537]},{"content":"If your Web server takes user data and inserts it into the returned Web page, it might, for example, include a <bpt id=\"p1\">**</bpt><ph id=\"ph1\">\\&lt;</ph>script&gt;<ept id=\"p1\">**</ept> tag and run as if from the server.","pos":[1538,1697],"source":" If your Web server takes user data and inserts it into the returned Web page, it might, for example, include a **\\<script>** tag and run as if from the server."},{"content":"Remember that the client can request any URL.","pos":[1707,1752]},{"content":"Consider tricky or invalid paths:","pos":[1762,1795]},{"content":"..\\ , extremely long paths.","pos":[1809,1836]},{"content":"Use of wild card characters (*).","pos":[1850,1882]},{"content":"Token expansion (%token%).","pos":[1896,1922]},{"content":"Strange forms of paths with special meaning.","pos":[1936,1980]},{"pos":[1994,2055],"content":"Alternate file system stream names such as <ph id=\"ph1\">`filename::$DATA`</ph>.","source":"Alternate file system stream names such as `filename::$DATA`."},{"pos":[2069,2136],"content":"Short versions of file names such as <ph id=\"ph1\">`longfi~1`</ph> for <ph id=\"ph2\">`longfilename`</ph>.","source":"Short versions of file names such as `longfi~1` for `longfilename`."},{"content":"Remember that Eval(userdata) can do anything.","pos":[2146,2191]},{"content":"Be wary of late binding to a name that includes some user data.","pos":[2201,2264]},{"content":"If you are dealing with Web data, consider the various forms of escapes that are permissible, including:","pos":[2274,2378]},{"content":"Hexadecimal escapes (%nn).","pos":[2392,2418]},{"content":"Unicode escapes (%nnn).","pos":[2432,2455]},{"content":"Overlong UTF-8 escapes (%nn%nn).","pos":[2469,2501]},{"content":"Double escapes (%nn becomes %mmnn, where %mm is the escape for '%').","pos":[2515,2583]},{"content":"Be wary of user names that might have more than one canonical format.","pos":[2593,2662]},{"content":"For example, you can often use either the MYDOMAIN<ph id=\"ph1\">\\\\</ph><bpt id=\"p1\">*</bpt>username<ept id=\"p1\">*</ept> form or the <bpt id=\"p2\">*</bpt>username<ept id=\"p2\">*</ept><ph id=\"ph2\">@mydomain.example.com</ph> form.","pos":[2663,2775],"source":" For example, you can often use either the MYDOMAIN\\\\*username* form or the *username*@mydomain.example.com form."},{"pos":[2784,2792],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2796,2883],"content":"<bpt id=\"p1\">[</bpt>Secure Coding Guidelines<ept id=\"p1\">](../../../docs/standard/security/secure-coding-guidelines.md)</ept>","source":"[Secure Coding Guidelines](../../../docs/standard/security/secure-coding-guidelines.md)"}]}