{"content":"---\ntitle: \"Reflection in the .NET Framework for Windows Store Apps\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"reflection, Windows Store apps\"\n  - \".NET for Windows Store apps, TypeInfo class\"\nms.assetid: 0d07090c-9b47-4ecc-81d1-29d539603c9b\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Reflection in the .NET Framework for Windows Store Apps\nStarting with the [!INCLUDE[net_v45](../../../includes/net-v45-md.md)], the .NET Framework includes a set of reflection types and members for use in [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] apps. These types and members are available in the full .NET Framework as well as in the [.NET for Windows Store apps](https://go.microsoft.com/fwlink/?LinkID=225700). This document explains the major differences between these and their counterparts in the .NET Framework 4 and earlier versions.  \n  \n If you are creating a [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] app, you must use the reflection types and members in the [!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)]. These types and members are also available, but not required, for use in desktop apps, so you can use the same code for both types of apps.  \n  \n## TypeInfo and Assembly Loading  \n In the [!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)], the <xref:System.Reflection.TypeInfo> class contains some of the functionality of the .NET Framework 4 <xref:System.Type> class. A <xref:System.Type> object represents a reference to a type definition, whereas a <xref:System.Reflection.TypeInfo> object represents the type definition itself. This enables you to manipulate <xref:System.Type> objects without necessarily requiring the runtime to load the assembly they reference. Getting the associated <xref:System.Reflection.TypeInfo> object forces the assembly to load.  \n  \n <xref:System.Reflection.TypeInfo> contains many of the members available on <xref:System.Type>, and many of the reflection properties in the [!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)] return collections of <xref:System.Reflection.TypeInfo> objects. To get a <xref:System.Reflection.TypeInfo> object from a <xref:System.Type> object, use the <xref:System.Reflection.IReflectableType.GetTypeInfo%2A> method.  \n  \n## Query Methods  \n In the [!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)], you use the reflection properties that return <xref:System.Collections.Generic.IEnumerable%601> collections instead of methods that return arrays. Reflection contexts can implement lazy traversal of these collections for large assemblies or types.  \n  \n The reflection properties return only the declared methods on a particular object instead of traversing the inheritance tree. Moreover, they do not use <xref:System.Reflection.BindingFlags> parameters for filtering. Instead, filtering takes place in user code, by using LINQ queries on the returned collections. For reflection objects that originate with the runtime (for example, as the result of `typeof(Object)`), traversing the inheritance tree is best accomplished by using the helper methods of the <xref:System.Reflection.RuntimeReflectionExtensions> class. Consumers of objects from customized reflection contexts cannot use these methods, and must traverse the inheritance tree themselves.  \n  \n## Restrictions  \n In a [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] app, access to some .NET Framework types and members is restricted. For example, you cannot call .NET Framework methods that are not included in [!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)], by using a <xref:System.Reflection.MethodInfo> object. In addition, certain types and members that are not considered safe within the context of a [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] app are blocked, as are <xref:System.Runtime.InteropServices.Marshal> and <xref:System.Runtime.InteropServices.WindowsRuntime.WindowsRuntimeMarshal> members. This restriction affects only .NET Framework types and members; you can call your code or third-party code as you normally would.  \n  \n## Example  \n This example uses the reflection types and members in the [!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)] to retrieve the methods and properties of the <xref:System.Globalization.Calendar> type, including inherited methods and properties. To run this code, paste it into the code file for a [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] page that contains a <xref:Windows.UI.Xaml.Controls.TextBlock?displayProperty=nameWithType> control named `textblock1` in a project named Reflection. If you paste this code inside a project with a different name, just make sure you change the namespace name to match your project.  \n  \n [!code-csharp[System.ReflectionWinStoreApp#1](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.reflectionwinstoreapp/cs/mainpage.xaml.cs#1)]\n [!code-vb[System.ReflectionWinStoreApp#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.reflectionwinstoreapp/vb/mainpage.xaml.vb#1)]  \n  \n## See also\n\n- [Reflection](../../../docs/framework/reflection-and-codedom/reflection.md)\n- [.NET for Windows Store apps – supported APIs](https://go.microsoft.com/fwlink/?LinkID=225700)\n","nodes":[{"pos":[4,319],"embed":true,"restype":"x-metadata","content":"title: \"Reflection in the .NET Framework for Windows Store Apps\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"reflection, Windows Store apps\"\n  - \".NET for Windows Store apps, TypeInfo class\"\nms.assetid: 0d07090c-9b47-4ecc-81d1-29d539603c9b\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Reflection in the .NET Framework for Windows Store Apps","nodes":[{"pos":[0,55],"content":"Reflection in the .NET Framework for Windows Store Apps","nodes":[{"content":"Reflection in the .NET Framework for Windows Store Apps","pos":[0,55]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[326,381],"content":"Reflection in the .NET Framework for Windows Store Apps","linkify":"Reflection in the .NET Framework for Windows Store Apps","nodes":[{"content":"Reflection in the .NET Framework for Windows Store Apps","pos":[0,55]}]},{"content":"Starting with the <ph id=\"ph1\">[!INCLUDE[net_v45](../../../includes/net-v45-md.md)]</ph>, the .NET Framework includes a set of reflection types and members for use in <ph id=\"ph2\">[!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)]</ph> apps.","pos":[382,609],"source":"Starting with the [!INCLUDE[net_v45](../../../includes/net-v45-md.md)], the .NET Framework includes a set of reflection types and members for use in [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] apps."},{"content":"These types and members are available in the full .NET Framework as well as in the <bpt id=\"p1\">[</bpt>.NET for Windows Store apps<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=225700)</ept>.","pos":[610,771],"source":" These types and members are available in the full .NET Framework as well as in the [.NET for Windows Store apps](https://go.microsoft.com/fwlink/?LinkID=225700)."},{"content":"This document explains the major differences between these and their counterparts in the .NET Framework 4 and earlier versions.","pos":[772,899]},{"content":"If you are creating a <ph id=\"ph1\">[!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)]</ph> app, you must use the reflection types and members in the <ph id=\"ph2\">[!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)]</ph>.","pos":[906,1130],"source":"If you are creating a [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] app, you must use the reflection types and members in the [!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)]."},{"content":"These types and members are also available, but not required, for use in desktop apps, so you can use the same code for both types of apps.","pos":[1131,1270]},{"pos":[1279,1308],"content":"TypeInfo and Assembly Loading","linkify":"TypeInfo and Assembly Loading","nodes":[{"content":"TypeInfo and Assembly Loading","pos":[0,29]}]},{"content":"In the <ph id=\"ph1\">[!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)]</ph>, the <ph id=\"ph2\">&lt;xref:System.Reflection.TypeInfo&gt;</ph> class contains some of the functionality of the .NET Framework 4 <ph id=\"ph3\">&lt;xref:System.Type&gt;</ph> class.","pos":[1312,1519],"source":"In the [!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)], the <xref:System.Reflection.TypeInfo> class contains some of the functionality of the .NET Framework 4 <xref:System.Type> class."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Type&gt;</ph> object represents a reference to a type definition, whereas a <ph id=\"ph2\">&lt;xref:System.Reflection.TypeInfo&gt;</ph> object represents the type definition itself.","pos":[1520,1682],"source":" A <xref:System.Type> object represents a reference to a type definition, whereas a <xref:System.Reflection.TypeInfo> object represents the type definition itself."},{"content":"This enables you to manipulate <ph id=\"ph1\">&lt;xref:System.Type&gt;</ph> objects without necessarily requiring the runtime to load the assembly they reference.","pos":[1683,1819],"source":" This enables you to manipulate <xref:System.Type> objects without necessarily requiring the runtime to load the assembly they reference."},{"content":"Getting the associated <ph id=\"ph1\">&lt;xref:System.Reflection.TypeInfo&gt;</ph> object forces the assembly to load.","pos":[1820,1912],"source":" Getting the associated <xref:System.Reflection.TypeInfo> object forces the assembly to load."},{"content":"<ph id=\"ph1\">&lt;xref:System.Reflection.TypeInfo&gt;</ph> contains many of the members available on <ph id=\"ph2\">&lt;xref:System.Type&gt;</ph>, and many of the reflection properties in the <ph id=\"ph3\">[!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)]</ph> return collections of <ph id=\"ph4\">&lt;xref:System.Reflection.TypeInfo&gt;</ph> objects.","pos":[1919,2195],"source":"<xref:System.Reflection.TypeInfo> contains many of the members available on <xref:System.Type>, and many of the reflection properties in the [!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)] return collections of <xref:System.Reflection.TypeInfo> objects."},{"content":"To get a <ph id=\"ph1\">&lt;xref:System.Reflection.TypeInfo&gt;</ph> object from a <ph id=\"ph2\">&lt;xref:System.Type&gt;</ph> object, use the <ph id=\"ph3\">&lt;xref:System.Reflection.IReflectableType.GetTypeInfo%2A&gt;</ph> method.","pos":[2196,2352],"source":" To get a <xref:System.Reflection.TypeInfo> object from a <xref:System.Type> object, use the <xref:System.Reflection.IReflectableType.GetTypeInfo%2A> method."},{"pos":[2361,2374],"content":"Query Methods","linkify":"Query Methods","nodes":[{"content":"Query Methods","pos":[0,13]}]},{"content":"In the <ph id=\"ph1\">[!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)]</ph>, you use the reflection properties that return <ph id=\"ph2\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> collections instead of methods that return arrays.","pos":[2378,2603],"source":"In the [!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)], you use the reflection properties that return <xref:System.Collections.Generic.IEnumerable%601> collections instead of methods that return arrays."},{"content":"Reflection contexts can implement lazy traversal of these collections for large assemblies or types.","pos":[2604,2704]},{"content":"The reflection properties return only the declared methods on a particular object instead of traversing the inheritance tree.","pos":[2711,2836]},{"content":"Moreover, they do not use <ph id=\"ph1\">&lt;xref:System.Reflection.BindingFlags&gt;</ph> parameters for filtering.","pos":[2837,2926],"source":" Moreover, they do not use <xref:System.Reflection.BindingFlags> parameters for filtering."},{"content":"Instead, filtering takes place in user code, by using LINQ queries on the returned collections.","pos":[2927,3022]},{"content":"For reflection objects that originate with the runtime (for example, as the result of <ph id=\"ph1\">`typeof(Object)`</ph>), traversing the inheritance tree is best accomplished by using the helper methods of the <ph id=\"ph2\">&lt;xref:System.Reflection.RuntimeReflectionExtensions&gt;</ph> class.","pos":[3023,3275],"source":" For reflection objects that originate with the runtime (for example, as the result of `typeof(Object)`), traversing the inheritance tree is best accomplished by using the helper methods of the <xref:System.Reflection.RuntimeReflectionExtensions> class."},{"content":"Consumers of objects from customized reflection contexts cannot use these methods, and must traverse the inheritance tree themselves.","pos":[3276,3409]},{"pos":[3418,3430],"content":"Restrictions","linkify":"Restrictions","nodes":[{"content":"Restrictions","pos":[0,12]}]},{"content":"In a <ph id=\"ph1\">[!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)]</ph> app, access to some .NET Framework types and members is restricted.","pos":[3434,3579],"source":"In a [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] app, access to some .NET Framework types and members is restricted."},{"content":"For example, you cannot call .NET Framework methods that are not included in <ph id=\"ph1\">[!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)]</ph>, by using a <ph id=\"ph2\">&lt;xref:System.Reflection.MethodInfo&gt;</ph> object.","pos":[3580,3783],"source":" For example, you cannot call .NET Framework methods that are not included in [!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)], by using a <xref:System.Reflection.MethodInfo> object."},{"content":"In addition, certain types and members that are not considered safe within the context of a <ph id=\"ph1\">[!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)]</ph> app are blocked, as are <ph id=\"ph2\">&lt;xref:System.Runtime.InteropServices.Marshal&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Runtime.InteropServices.WindowsRuntime.WindowsRuntimeMarshal&gt;</ph> members.","pos":[3784,4106],"source":" In addition, certain types and members that are not considered safe within the context of a [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] app are blocked, as are <xref:System.Runtime.InteropServices.Marshal> and <xref:System.Runtime.InteropServices.WindowsRuntime.WindowsRuntimeMarshal> members."},{"content":"This restriction affects only .NET Framework types and members; you can call your code or third-party code as you normally would.","pos":[4107,4236]},{"pos":[4245,4252],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example uses the reflection types and members in the <ph id=\"ph1\">[!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)]</ph> to retrieve the methods and properties of the <ph id=\"ph2\">&lt;xref:System.Globalization.Calendar&gt;</ph> type, including inherited methods and properties.","pos":[4256,4517],"source":"This example uses the reflection types and members in the [!INCLUDE[net_win8_profile](../../../includes/net-win8-profile-md.md)] to retrieve the methods and properties of the <xref:System.Globalization.Calendar> type, including inherited methods and properties."},{"content":"To run this code, paste it into the code file for a <ph id=\"ph1\">[!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)]</ph> page that contains a <ph id=\"ph2\">&lt;xref:Windows.UI.Xaml.Controls.TextBlock?displayProperty=nameWithType&gt;</ph> control named <ph id=\"ph3\">`textblock1`</ph> in a project named Reflection.","pos":[4518,4792],"source":" To run this code, paste it into the code file for a [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] page that contains a <xref:Windows.UI.Xaml.Controls.TextBlock?displayProperty=nameWithType> control named `textblock1` in a project named Reflection."},{"content":"If you paste this code inside a project with a different name, just make sure you change the namespace name to match your project.","pos":[4793,4923]},{"pos":[5250,5258],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5262,5336],"content":"<bpt id=\"p1\">[</bpt>Reflection<ept id=\"p1\">](../../../docs/framework/reflection-and-codedom/reflection.md)</ept>","source":"[Reflection](../../../docs/framework/reflection-and-codedom/reflection.md)"},{"pos":[5339,5433],"content":"<bpt id=\"p1\">[</bpt>.NET for Windows Store apps – supported APIs<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=225700)</ept>","source":"[.NET for Windows Store apps – supported APIs](https://go.microsoft.com/fwlink/?LinkID=225700)"}]}