{"content":"---\ntitle: \"Querying an XDocument vs. Querying an XElement (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 2d111f84-0ded-4cde-8d93-5440557a726d\n---\n# Querying an XDocument vs. Querying an XElement (Visual Basic)\nWhen you load a document via <xref:System.Xml.Linq.XDocument.Load%2A?displayProperty=nameWithType>, you will notice that you have to write queries slightly differently than when you load via <xref:System.Xml.Linq.XElement.Load%2A?displayProperty=nameWithType>.  \n  \n## Comparison of XDocument.Load and XElement.Load  \n When you load an XML document into an <xref:System.Xml.Linq.XElement> via <xref:System.Xml.Linq.XElement.Load%2A?displayProperty=nameWithType>, the <xref:System.Xml.Linq.XElement> at the root of the XML tree contains the root element of the loaded document. However, when you load the same XML document into an <xref:System.Xml.Linq.XDocument> via <xref:System.Xml.Linq.XDocument.Load%2A?displayProperty=nameWithType>, the root of the tree is an <xref:System.Xml.Linq.XDocument> node, and the root element of the loaded document is the one allowed child <xref:System.Xml.Linq.XElement> node of the <xref:System.Xml.Linq.XDocument>. The [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] axes operate relative to the root node.  \n  \n This first example loads an XML tree using <xref:System.Xml.Linq.XElement.Load%2A>. It then queries for the child elements of the root of the tree.  \n  \n```vb  \n' Create a simple document and  write it to a file  \nFile.WriteAllText(\"Test.xml\", \"<Root>\" + Environment.NewLine + _  \n    \"    <Child1>1</Child1>\" + Environment.NewLine + _  \n    \"    <Child2>2</Child2>\" + Environment.NewLine + _  \n    \"    <Child3>3</Child3>\" + Environment.NewLine + _  \n    \"</Root>\")  \n  \nConsole.WriteLine(\"Querying tree loaded with XElement.Load\")  \nConsole.WriteLine(\"----\")  \nDim doc As XElement = XElement.Load(\"Test.xml\")  \nDim childList As IEnumerable(Of XElement) = _  \n        From el In doc.Elements() _  \n        Select el  \nFor Each e As XElement In childList  \n    Console.WriteLine(e)  \nNext  \n```  \n  \n As expected, this example produces the following output:  \n  \n```  \nQuerying tree loaded with XElement.Load  \n----  \n<Child1>1</Child1>  \n<Child2>2</Child2>  \n<Child3>3</Child3>  \n```  \n  \n The following example is the same as the one above, with the exception that the XML tree is loaded into an <xref:System.Xml.Linq.XDocument> instead of an <xref:System.Xml.Linq.XElement>.  \n  \n```vb  \n' Create a simple document and  write it to a file  \nFile.WriteAllText(\"Test.xml\", \"<Root>\" + Environment.NewLine + _  \n    \"    <Child1>1</Child1>\" + Environment.NewLine + _  \n    \"    <Child2>2</Child2>\" + Environment.NewLine + _  \n    \"    <Child3>3</Child3>\" + Environment.NewLine + _  \n    \"</Root>\")  \n  \nConsole.WriteLine(\"Querying tree loaded with XDocument.Load\")  \nConsole.WriteLine(\"----\")  \nDim doc As XDocument = XDocument.Load(\"Test.xml\")  \nDim childList As IEnumerable(Of XElement) = _  \n        From el In doc.Elements() _  \n        Select el  \nFor Each e As XElement In childList  \n    Console.WriteLine(e)  \nNext  \n```  \n  \n This example produces the following output:  \n  \n```  \nQuerying tree loaded with XDocument.Load  \n----  \n<Root>  \n  <Child1>1</Child1>  \n  <Child2>2</Child2>  \n  <Child3>3</Child3>  \n</Root>  \n```  \n  \n Notice that the same query returned the one `Root` node instead of the three child nodes.  \n  \n One approach to dealing with this is to use the <xref:System.Xml.Linq.XDocument.Root%2A> property before accessing the axes methods, as follows:  \n  \n```vb  \n' Create a simple document and  write it to a file  \nFile.WriteAllText(\"Test.xml\", \"<Root>\" + Environment.NewLine + _  \n    \"    <Child1>1</Child1>\" + Environment.NewLine + _  \n    \"    <Child2>2</Child2>\" + Environment.NewLine + _  \n    \"    <Child3>3</Child3>\" + Environment.NewLine + _  \n    \"</Root>\")  \n  \nConsole.WriteLine(\"Querying tree loaded with XDocument.Load\")  \nConsole.WriteLine(\"----\")  \nDim doc As XDocument = XDocument.Load(\"Test.xml\")  \nDim childList As IEnumerable(Of XElement) = _  \n        From el In doc.Root.Elements() _  \n        Select el  \nFor Each e As XElement In childList  \n    Console.WriteLine(e)  \nNext  \n```  \n  \n This query now performs in the same way as the query on the tree rooted in <xref:System.Xml.Linq.XElement>. The example produces the following output:  \n  \n```  \nQuerying tree loaded with XDocument.Load  \n----  \n<Child1>1</Child1>  \n<Child2>2</Child2>  \n<Child3>3</Child3>  \n```  \n  \n## See also\n\n- [Basic Queries (LINQ to XML) (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/basic-queries-linq-to-xml.md)\n","nodes":[{"pos":[4,143],"embed":true,"restype":"x-metadata","content":"title: \"Querying an XDocument vs. Querying an XElement (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 2d111f84-0ded-4cde-8d93-5440557a726d","nodes":[{"content":"Querying an XDocument vs. Querying an XElement (Visual Basic)","nodes":[{"pos":[0,61],"content":"Querying an XDocument vs. Querying an XElement (Visual Basic)","nodes":[{"content":"Querying an XDocument vs. Querying an XElement (Visual Basic)","pos":[0,61]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[150,211],"content":"Querying an XDocument vs. Querying an XElement (Visual Basic)","linkify":"Querying an XDocument vs. Querying an XElement (Visual Basic)","nodes":[{"content":"Querying an XDocument vs. Querying an XElement (Visual Basic)","pos":[0,61]}]},{"pos":[212,472],"content":"When you load a document via <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument.Load%2A?displayProperty=nameWithType&gt;</ph>, you will notice that you have to write queries slightly differently than when you load via <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement.Load%2A?displayProperty=nameWithType&gt;</ph>.","source":"When you load a document via <xref:System.Xml.Linq.XDocument.Load%2A?displayProperty=nameWithType>, you will notice that you have to write queries slightly differently than when you load via <xref:System.Xml.Linq.XElement.Load%2A?displayProperty=nameWithType>."},{"pos":[481,527],"content":"Comparison of XDocument.Load and XElement.Load","linkify":"Comparison of XDocument.Load and XElement.Load","nodes":[{"content":"Comparison of XDocument.Load and XElement.Load","pos":[0,46]}]},{"content":"When you load an XML document into an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> via <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement.Load%2A?displayProperty=nameWithType&gt;</ph>, the <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> at the root of the XML tree contains the root element of the loaded document.","pos":[531,788],"source":"When you load an XML document into an <xref:System.Xml.Linq.XElement> via <xref:System.Xml.Linq.XElement.Load%2A?displayProperty=nameWithType>, the <xref:System.Xml.Linq.XElement> at the root of the XML tree contains the root element of the loaded document."},{"content":"However, when you load the same XML document into an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph> via <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XDocument.Load%2A?displayProperty=nameWithType&gt;</ph>, the root of the tree is an <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph> node, and the root element of the loaded document is the one allowed child <ph id=\"ph4\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> node of the <ph id=\"ph5\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph>.","pos":[789,1162],"source":" However, when you load the same XML document into an <xref:System.Xml.Linq.XDocument> via <xref:System.Xml.Linq.XDocument.Load%2A?displayProperty=nameWithType>, the root of the tree is an <xref:System.Xml.Linq.XDocument> node, and the root element of the loaded document is the one allowed child <xref:System.Xml.Linq.XElement> node of the <xref:System.Xml.Linq.XDocument>."},{"content":"The <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> axes operate relative to the root node.","pos":[1163,1260],"source":" The [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] axes operate relative to the root node."},{"content":"This first example loads an XML tree using <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement.Load%2A&gt;</ph>.","pos":[1267,1350],"source":"This first example loads an XML tree using <xref:System.Xml.Linq.XElement.Load%2A>."},{"content":"It then queries for the child elements of the root of the tree.","pos":[1351,1414]},{"content":"As expected, this example produces the following output:","pos":[2068,2124]},{"pos":[2258,2444],"content":"The following example is the same as the one above, with the exception that the XML tree is loaded into an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph> instead of an <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement&gt;</ph>.","source":"The following example is the same as the one above, with the exception that the XML tree is loaded into an <xref:System.Xml.Linq.XDocument> instead of an <xref:System.Xml.Linq.XElement>."},{"content":"This example produces the following output:","pos":[3101,3144]},{"pos":[3304,3393],"content":"Notice that the same query returned the one <ph id=\"ph1\">`Root`</ph> node instead of the three child nodes.","source":"Notice that the same query returned the one `Root` node instead of the three child nodes."},{"pos":[3400,3544],"content":"One approach to dealing with this is to use the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument.Root%2A&gt;</ph> property before accessing the axes methods, as follows:","source":"One approach to dealing with this is to use the <xref:System.Xml.Linq.XDocument.Root%2A> property before accessing the axes methods, as follows:"},{"content":"This query now performs in the same way as the query on the tree rooted in <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph>.","pos":[4206,4313],"source":"This query now performs in the same way as the query on the tree rooted in <xref:System.Xml.Linq.XElement>."},{"content":"The example produces the following output:","pos":[4314,4356]},{"pos":[4493,4501],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4505,4636],"content":"<bpt id=\"p1\">[</bpt>Basic Queries (LINQ to XML) (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/basic-queries-linq-to-xml.md)</ept>","source":"[Basic Queries (LINQ to XML) (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/basic-queries-linq-to-xml.md)"}]}