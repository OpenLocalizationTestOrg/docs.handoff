{"content":"---\ntitle: \"How to: Create a Windows Forms Control That Shows Progress | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"controls [Windows Forms], progress tracking\"\n  - \"controls [Windows Forms], creating\"\n  - \"progress, reporting [Windows Forms]\"\n  - \"FlashTrackBar custom control\"\nms.assetid: 24c5a2e3-058c-4b8d-a217-c06e6a130c2f\ncaps.latest.revision: 6\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Create a Windows Forms Control That Shows Progress\nThe following code example shows a custom control called `FlashTrackBar` that can be used to show the user the level or the progress of an application. It uses a gradient to visually represent progress.  \n  \n The `FlashTrackBar` control illustrates the following concepts:  \n  \n-   Defining custom properties.  \n  \n-   Defining custom events. (`FlashTrackBar` defines the `ValueChanged` event.)  \n  \n-   Overriding the <xref:System.Windows.Forms.Control.OnPaint%2A> method to provide logic to draw the control.  \n  \n-   Computing the area available for drawing the control by using its <xref:System.Windows.Forms.Control.ClientRectangle%2A> property. `FlashTrackBar` does this in its `OptimizedInvalidate` method.  \n  \n-   Implementing serialization or persistence for a property when it is changed in the Windows Forms Designer. `FlashTrackBar` defines the `ShouldSerializeStartColor` and `ShouldSerializeEndColor` methods for serializing its `StartColor` and `EndColor` properties.  \n  \n The following table shows the custom properties defined by `FlashTrackBar`.  \n  \n|Property|Description|  \n|--------------|-----------------|  \n|`AllowUserEdit`|Indicates whether the user can change the value of the flash track bar by clicking and dragging it.|  \n|`EndColor`|Specifies the ending color of the track bar.|  \n|`DarkenBy`|Specifies how much to darken the background with respect to the foreground gradient.|  \n|`Max`|Specifies the maximum value of the track bar.|  \n|`Min`|Specifies the minimum value of the track bar.|  \n|`StartColor`|Specifies the starting color of the gradient.|  \n|`ShowPercentage`|Indicates whether to display a percentage over the gradient.|  \n|`ShowValue`|Indicates whether to display the current value over the gradient.|  \n|`ShowGradient`|Indicates whether the track bar should display a color gradient showing the current value.|  \n|-   `Value`|Specifies the current value of the track bar.|  \n  \n The following table shows additional members defined by `FlashTrackBar:` the property-changed event and the method that raises the event.  \n  \n|Member|Description|  \n|------------|-----------------|  \n|`ValueChanged`|The event that is raised when the `Value` property of the track bar changes.|  \n|`OnValueChanged`|The method that raises the `ValueChanged` event.|  \n  \n> [!NOTE]\n>  `FlashTrackBar` uses the <xref:System.EventArgs> class for event data and <xref:System.EventHandler> for the event delegate.  \n  \n To handle the corresponding *EventName* events, `FlashTrackBar` overrides the following methods that it inherits from <xref:System.Windows.Forms.Control?displayProperty=fullName>:  \n  \n-   <xref:System.Windows.Forms.Control.OnPaint%2A>  \n  \n-   <xref:System.Windows.Forms.Control.OnMouseDown%2A>  \n  \n-   <xref:System.Windows.Forms.Control.OnMouseMove%2A>  \n  \n-   <xref:System.Windows.Forms.Control.OnMouseUp%2A>  \n  \n-   <xref:System.Windows.Forms.Control.OnResize%2A>  \n  \n To handle the corresponding property-changed events, `FlashTrackBar` overrides the following methods that it inherits from <xref:System.Windows.Forms.Control?displayProperty=fullName>:  \n  \n-   <xref:System.Windows.Forms.Control.OnBackColorChanged%2A>  \n  \n-   <xref:System.Windows.Forms.Control.OnBackgroundImageChanged%2A>  \n  \n-   <xref:System.Windows.Forms.Control.OnTextChanged%2A>  \n  \n## Example  \n The `FlashTrackBar` control defines two UI type editors, `FlashTrackBarValueEditor` and `FlashTrackBarDarkenByEditor`, which are shown in the following code listings. The `HostApp` class uses the `FlashTrackBar` control on a Windows Form.  \n  \n [!code-csharp[System.Windows.Forms.FlashTrackBar#1](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/FlashTrackBar.cs#1)]\n [!code-vb[System.Windows.Forms.FlashTrackBar#1](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/FlashTrackBar.vb#1)]  \n  \n [!code-csharp[System.Windows.Forms.FlashTrackBar#10](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/FlashTrackBarDarkenByEditor.cs#10)]\n [!code-vb[System.Windows.Forms.FlashTrackBar#10](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/FlashTrackBarDarkenByEditor.vb#10)]  \n  \n [!code-csharp[System.Windows.Forms.FlashTrackBar#20](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/FlashTrackBarValueEditor.cs#20)]\n [!code-vb[System.Windows.Forms.FlashTrackBar#20](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/FlashTrackBarValueEditor.vb#20)]  \n  \n [!code-csharp[System.Windows.Forms.FlashTrackBar#30](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/HostApp.cs#30)]\n [!code-vb[System.Windows.Forms.FlashTrackBar#30](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/HostApp.vb#30)]  \n  \n## See Also  \n [Extending Design-Time Support](http://msdn.microsoft.com/library/d6ac8a6a-42fd-4bc8-bf33-b212811297e2)   \n [Windows Forms Control Development Basics](../../../../docs/framework/winforms/controls/windows-forms-control-development-basics.md)","nodes":[{"pos":[12,87],"content":"How to: Create a Windows Forms Control That Shows Progress | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Create a Windows Forms Control That Shows Progress | Microsoft Docs","pos":[0,75]}]},{"pos":[614,672],"content":"How to: Create a Windows Forms Control That Shows Progress","linkify":"How to: Create a Windows Forms Control That Shows Progress","nodes":[{"content":"How to: Create a Windows Forms Control That Shows Progress","pos":[0,58]}]},{"content":"The following code example shows a custom control called <ph id=\"ph1\">`FlashTrackBar`</ph> that can be used to show the user the level or the progress of an application.","pos":[673,824],"source":"The following code example shows a custom control called `FlashTrackBar` that can be used to show the user the level or the progress of an application."},{"content":"It uses a gradient to visually represent progress.","pos":[825,875]},{"pos":[882,945],"content":"The <ph id=\"ph1\">`FlashTrackBar`</ph> control illustrates the following concepts:","source":"The `FlashTrackBar` control illustrates the following concepts:"},{"content":"Defining custom properties.","pos":[955,982]},{"content":"Defining custom events.","pos":[992,1015]},{"content":"(<ph id=\"ph1\">`FlashTrackBar`</ph> defines the <ph id=\"ph2\">`ValueChanged`</ph> event.)","pos":[1016,1067],"source":" (`FlashTrackBar` defines the `ValueChanged` event.)"},{"content":"Overriding the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.OnPaint%2A&gt;</ph> method to provide logic to draw the control.","pos":[1077,1183],"source":"Overriding the <xref:System.Windows.Forms.Control.OnPaint%2A> method to provide logic to draw the control."},{"content":"Computing the area available for drawing the control by using its <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.ClientRectangle%2A&gt;</ph> property.","pos":[1193,1323],"source":"Computing the area available for drawing the control by using its <xref:System.Windows.Forms.Control.ClientRectangle%2A> property."},{"content":"<ph id=\"ph1\">`FlashTrackBar`</ph> does this in its <ph id=\"ph2\">`OptimizedInvalidate`</ph> method.","pos":[1324,1386],"source":"`FlashTrackBar` does this in its `OptimizedInvalidate` method."},{"content":"Implementing serialization or persistence for a property when it is changed in the Windows Forms Designer.","pos":[1396,1502]},{"content":"<ph id=\"ph1\">`FlashTrackBar`</ph> defines the <ph id=\"ph2\">`ShouldSerializeStartColor`</ph> and <ph id=\"ph3\">`ShouldSerializeEndColor`</ph> methods for serializing its <ph id=\"ph4\">`StartColor`</ph> and <ph id=\"ph5\">`EndColor`</ph> properties.","pos":[1503,1656],"source":"`FlashTrackBar` defines the `ShouldSerializeStartColor` and `ShouldSerializeEndColor` methods for serializing its `StartColor` and `EndColor` properties."},{"pos":[1663,1738],"content":"The following table shows the custom properties defined by <ph id=\"ph1\">`FlashTrackBar`</ph>.","source":"The following table shows the custom properties defined by `FlashTrackBar`."},{"content":"Property","pos":[1745,1753]},{"content":"Description","pos":[1754,1765]},{"content":"Indicates whether the user can change the value of the flash track bar by clicking and dragging it.","pos":[1823,1922]},{"content":"Specifies the ending color of the track bar.","pos":[1938,1982]},{"content":"Specifies how much to darken the background with respect to the foreground gradient.","pos":[1998,2082]},{"content":"Specifies the maximum value of the track bar.","pos":[2093,2138]},{"content":"Specifies the minimum value of the track bar.","pos":[2149,2194]},{"content":"Specifies the starting color of the gradient.","pos":[2212,2257]},{"content":"Indicates whether to display a percentage over the gradient.","pos":[2279,2339]},{"content":"Indicates whether to display the current value over the gradient.","pos":[2356,2421]},{"content":"Indicates whether the track bar should display a color gradient showing the current value.","pos":[2441,2531]},{"content":"Specifies the current value of the track bar.","pos":[2548,2593]},{"pos":[2601,2738],"content":"The following table shows additional members defined by <ph id=\"ph1\">`FlashTrackBar:`</ph> the property-changed event and the method that raises the event.","source":"The following table shows additional members defined by `FlashTrackBar:` the property-changed event and the method that raises the event."},{"content":"Member","pos":[2745,2751]},{"content":"Description","pos":[2752,2763]},{"pos":[2818,2894],"content":"The event that is raised when the <ph id=\"ph1\">`Value`</ph> property of the track bar changes.","source":"The event that is raised when the `Value` property of the track bar changes."},{"pos":[2916,2964],"content":"The method that raises the <ph id=\"ph1\">`ValueChanged`</ph> event.","source":"The method that raises the `ValueChanged` event."},{"pos":[2973,3108],"content":"[!NOTE]\n `FlashTrackBar` uses the <xref:System.EventArgs> class for event data and <xref:System.EventHandler> for the event delegate.","leadings":["","> "],"nodes":[{"content":"<ph id=\"ph1\"> `FlashTrackBar`</ph> uses the <ph id=\"ph2\">&lt;xref:System.EventArgs&gt;</ph> class for event data and <ph id=\"ph3\">&lt;xref:System.EventHandler&gt;</ph> for the event delegate.","pos":[8,133],"source":" `FlashTrackBar` uses the <xref:System.EventArgs> class for event data and <xref:System.EventHandler> for the event delegate."}]},{"pos":[3115,3294],"content":"To handle the corresponding <bpt id=\"p1\">*</bpt>EventName<ept id=\"p1\">*</ept> events, <ph id=\"ph1\">`FlashTrackBar`</ph> overrides the following methods that it inherits from <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control?displayProperty=fullName&gt;</ph>:","source":"To handle the corresponding *EventName* events, `FlashTrackBar` overrides the following methods that it inherits from <xref:System.Windows.Forms.Control?displayProperty=fullName>:"},{"pos":[3592,3776],"content":"To handle the corresponding property-changed events, <ph id=\"ph1\">`FlashTrackBar`</ph> overrides the following methods that it inherits from <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control?displayProperty=fullName&gt;</ph>:","source":"To handle the corresponding property-changed events, `FlashTrackBar` overrides the following methods that it inherits from <xref:System.Windows.Forms.Control?displayProperty=fullName>:"},{"pos":[3987,3994],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`FlashTrackBar`</ph> control defines two UI type editors, <ph id=\"ph2\">`FlashTrackBarValueEditor`</ph> and <ph id=\"ph3\">`FlashTrackBarDarkenByEditor`</ph>, which are shown in the following code listings.","pos":[3998,4164],"source":"The `FlashTrackBar` control defines two UI type editors, `FlashTrackBarValueEditor` and `FlashTrackBarDarkenByEditor`, which are shown in the following code listings."},{"content":"The <ph id=\"ph1\">`HostApp`</ph> class uses the <ph id=\"ph2\">`FlashTrackBar`</ph> control on a Windows Form.","pos":[4165,4236],"source":" The `HostApp` class uses the `FlashTrackBar` control on a Windows Form."},{"pos":[4243,4580],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.FlashTrackBar#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/FlashTrackBar.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.FlashTrackBar#1<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/FlashTrackBar.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.Windows.Forms.FlashTrackBar#1](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/FlashTrackBar.cs#1)]\n [!code-vb[System.Windows.Forms.FlashTrackBar#1](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/FlashTrackBar.vb#1)]"},{"pos":[4587,4956],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.FlashTrackBar#10<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/FlashTrackBarDarkenByEditor.cs#10)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.FlashTrackBar#10<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/FlashTrackBarDarkenByEditor.vb#10)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.Windows.Forms.FlashTrackBar#10](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/FlashTrackBarDarkenByEditor.cs#10)]\n [!code-vb[System.Windows.Forms.FlashTrackBar#10](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/FlashTrackBarDarkenByEditor.vb#10)]"},{"pos":[4963,5326],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.FlashTrackBar#20<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/FlashTrackBarValueEditor.cs#20)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.FlashTrackBar#20<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/FlashTrackBarValueEditor.vb#20)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.Windows.Forms.FlashTrackBar#20](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/FlashTrackBarValueEditor.cs#20)]\n [!code-vb[System.Windows.Forms.FlashTrackBar#20](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/FlashTrackBarValueEditor.vb#20)]"},{"pos":[5333,5662],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.FlashTrackBar#30<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/HostApp.cs#30)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.FlashTrackBar#30<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/HostApp.vb#30)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[System.Windows.Forms.FlashTrackBar#30](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/CS/HostApp.cs#30)]\n [!code-vb[System.Windows.Forms.FlashTrackBar#30](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.FlashTrackBar/VB/HostApp.vb#30)]"},{"pos":[5671,5679],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Extending Design-Time Support<ept id=\"p1\">](http://msdn.microsoft.com/library/d6ac8a6a-42fd-4bc8-bf33-b212811297e2)</ept><ph id=\"ph1\"> </ph>","pos":[5683,5787],"source":"[Extending Design-Time Support](http://msdn.microsoft.com/library/d6ac8a6a-42fd-4bc8-bf33-b212811297e2) "},{"content":"<bpt id=\"p1\"> [</bpt>Windows Forms Control Development Basics<ept id=\"p1\">](../../../../docs/framework/winforms/controls/windows-forms-control-development-basics.md)</ept>","pos":[5790,5923],"source":" [Windows Forms Control Development Basics](../../../../docs/framework/winforms/controls/windows-forms-control-development-basics.md)"}]}