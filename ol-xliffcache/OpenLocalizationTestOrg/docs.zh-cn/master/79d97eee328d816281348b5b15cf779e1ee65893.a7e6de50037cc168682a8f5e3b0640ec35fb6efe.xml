{"content":"---\ntitle: \"ServiceModel Transaction Attributes\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"transactions [WCF], ServiceModel attributes\"\nms.assetid: 1e0d2436-6ae5-439b-9765-a448d6f60000\n---\n# ServiceModel Transaction Attributes\nWindows Communication Foundation (WCF) provides properties on three standard <xref:System.ServiceModel> attributes that enable you to configure the behavior of transactions for a WCF service:  \n  \n-   <xref:System.ServiceModel.TransactionFlowAttribute>  \n  \n-   <xref:System.ServiceModel.ServiceBehaviorAttribute>  \n  \n-   <xref:System.ServiceModel.OperationBehaviorAttribute>  \n  \n## TransactionFlowAttribute  \n The <xref:System.ServiceModel.TransactionFlowAttribute> attribute specifies the willingness of an operation in a service contract to accept incoming transactions from a client. The attribute provides this control with the following property: Transactions use the <xref:System.ServiceModel.TransactionFlowOption> enumeration to specify whether an incoming transaction is <xref:System.ServiceModel.TransactionFlowOption.Mandatory>, <xref:System.ServiceModel.TransactionFlowOption.Allowed>, or <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>.  \n  \n This is the only attribute that relates service operations to external interactions with a client. The attributes described in the following sections relate to the use of transactions within the execution of the operation.  \n  \n## ServiceBehaviorAttribute  \n The <xref:System.ServiceModel.ServiceBehaviorAttribute> attribute specifies the internal execution behavior of a service contract implementation. Transaction-specific properties of this attribute include:  \n  \n-   <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> specifies whether to complete an uncompleted transaction when the session closes. The default value for this property is `false`. If this property is `true`, and the incoming session was gracefully shut down instead of closing due to network or client faults, any uncompleted transaction is successfully completed. Otherwise, if this property is `false` or if the session was not gracefully closed, any uncompleted transaction is rolled back when the session closes. If this property is `true`, the incoming channel must be session-based.  \n  \n-   <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A> specifies whether the underlying service instance is released when a transaction completes. The default value for this property is `true`. The next inbound message causes a new underlying instance to be created, discarding any per-transaction state that the previous instance might have held. Releasing a service instance is an internal action the service takes and has no impact on any existing connections or sessions that clients might have established. This functionality is equivalent to the just-in-time activation feature COM+ provides. If the property is `true`, <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> must be equal to <xref:System.ServiceModel.ConcurrencyMode.Single>. Otherwise, the service throws an invalid configuration validation exception during startup.  \n  \n-   <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionIsolationLevel%2A> specifies the isolation level to use for transactions within the service; this property takes one of the <xref:System.Transactions.IsolationLevel> values. If the local isolation level property is anything other than <xref:System.Transactions.IsolationLevel.Unspecified>, the isolation level of an incoming transaction must match the setting of this local property. Otherwise, the incoming transaction is rejected, and a fault is sent back to the client. If <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> is `true`, and no transaction is flowed, this property determines the <xref:System.Transactions.IsolationLevel> value to use for the locally created transaction. If <xref:System.Transactions.IsolationLevel> is set to <xref:System.Transactions.IsolationLevel.Unspecified>, <xref:System.Transactions.IsolationLevel><xref:System.Transactions.IsolationLevel.Serializable> is used.  \n  \n-   <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> specifies the time period within which a new transaction created at the service must complete. If this time is reached and the transaction has not been completed, it will abort. The <xref:System.TimeSpan> is used as the <xref:System.Transactions.TransactionScope> time-out for any operations that have <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> set to `true` and for which a new transaction was created. The time-out is the maximum allowed duration from the creation of the transaction to the completion of phase 1 in the two-phase commit protocol. The time-out value used is always the lower value between the <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> property and the `transactionTimeout` configuration setting.  \n  \n## OperationBehaviorAttribute  \n The <xref:System.ServiceModel.OperationBehaviorAttribute> attribute specifies the behaviors of the methods in the service implementation. You can use it to indicate the operation's specific execution behavior. Properties of this attribute do not affect the Web Service Description Language (WSDL) description of the service contract, and are purely elements of the WCF programming model that enable common features that developers otherwise have to implement themselves.  \n  \n This attribute has the following transaction-specific properties:  \n  \n-   <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> specifies whether a method must execute within an active transaction scope. The default is `false`. If the <xref:System.ServiceModel.OperationBehaviorAttribute> attribute is not set for a method, it also implies that the method will not execute in a transaction. If a transaction scope is not required for an operation, any transaction that is present within the message header is not activated and remains as an element of the <xref:System.ServiceModel.OperationContext.IncomingMessageProperties%2A> of the <xref:System.ServiceModel.OperationContext>. If a transaction scope is required for an operation, the source for the transaction is derived from one of the following:  \n  \n    -   If a transaction is flowed from the client, the method is executed under a transaction scope created using that distributed transaction.  \n  \n    -   With a queued transport, the transaction used to dequeue the message is used. Note that the transaction used is not a flowed transaction, in that it was not provided by the original sender of the message.  \n  \n    -   A custom transport can provide a transaction through the use of the `TransportTransactionProperty`.  \n  \n    -   If none of the above provides an external source for a transaction, a new <xref:System.Transactions.Transaction> instance is created immediately prior to calling the method.  \n  \n-   <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionAutoComplete%2A> specifies whether the transaction in which the method executes is automatically completed if no unhandled exceptions are thrown. If this property is `true`, the calling infrastructure automatically marks the transaction as \"completed\" if the user method returns without throwing an exception. If this property is `false`, the transaction is attached to the instance, and is only marked as \"completed\" if the client calls a subsequent method that is marked with this property equal to `true`, or if a subsequent method explicitly calls <xref:System.ServiceModel.OperationContext.SetTransactionComplete%2A>. Failure to perform either of these results in the transaction never being \"completed,\" and the contained work is not committed, unless the <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> property is set to `true`. If this property is set to `true`, you must use a channel with a session, and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> must be set to <xref:System.ServiceModel.InstanceContextMode.PerSession>.\n","nodes":[{"pos":[4,191],"embed":true,"restype":"x-metadata","content":"title: \"ServiceModel Transaction Attributes\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"transactions [WCF], ServiceModel attributes\"\nms.assetid: 1e0d2436-6ae5-439b-9765-a448d6f60000","nodes":[{"content":"ServiceModel Transaction Attributes","nodes":[{"pos":[0,35],"content":"ServiceModel Transaction Attributes","nodes":[{"content":"ServiceModel Transaction Attributes","pos":[0,35]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[198,233],"content":"ServiceModel Transaction Attributes","linkify":"ServiceModel Transaction Attributes","nodes":[{"content":"ServiceModel Transaction Attributes","pos":[0,35]}]},{"pos":[234,425],"content":"Windows Communication Foundation (WCF) provides properties on three standard <ph id=\"ph1\">&lt;xref:System.ServiceModel&gt;</ph> attributes that enable you to configure the behavior of transactions for a WCF service:","source":"Windows Communication Foundation (WCF) provides properties on three standard <xref:System.ServiceModel> attributes that enable you to configure the behavior of transactions for a WCF service:"},{"pos":[619,643],"content":"TransactionFlowAttribute","linkify":"TransactionFlowAttribute","nodes":[{"content":"TransactionFlowAttribute","pos":[0,24]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.TransactionFlowAttribute&gt;</ph> attribute specifies the willingness of an operation in a service contract to accept incoming transactions from a client.","pos":[647,823],"source":"The <xref:System.ServiceModel.TransactionFlowAttribute> attribute specifies the willingness of an operation in a service contract to accept incoming transactions from a client."},{"content":"The attribute provides this control with the following property: Transactions use the <ph id=\"ph1\">&lt;xref:System.ServiceModel.TransactionFlowOption&gt;</ph> enumeration to specify whether an incoming transaction is <ph id=\"ph2\">&lt;xref:System.ServiceModel.TransactionFlowOption.Mandatory&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.ServiceModel.TransactionFlowOption.Allowed&gt;</ph>, or <ph id=\"ph4\">&lt;xref:System.ServiceModel.TransactionFlowOption.NotAllowed&gt;</ph>.","pos":[824,1198],"source":" The attribute provides this control with the following property: Transactions use the <xref:System.ServiceModel.TransactionFlowOption> enumeration to specify whether an incoming transaction is <xref:System.ServiceModel.TransactionFlowOption.Mandatory>, <xref:System.ServiceModel.TransactionFlowOption.Allowed>, or <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>."},{"content":"This is the only attribute that relates service operations to external interactions with a client.","pos":[1205,1303]},{"content":"The attributes described in the following sections relate to the use of transactions within the execution of the operation.","pos":[1304,1427]},{"pos":[1436,1460],"content":"ServiceBehaviorAttribute","linkify":"ServiceBehaviorAttribute","nodes":[{"content":"ServiceBehaviorAttribute","pos":[0,24]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute&gt;</ph> attribute specifies the internal execution behavior of a service contract implementation.","pos":[1464,1609],"source":"The <xref:System.ServiceModel.ServiceBehaviorAttribute> attribute specifies the internal execution behavior of a service contract implementation."},{"content":"Transaction-specific properties of this attribute include:","pos":[1610,1668]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A&gt;</ph> specifies whether to complete an uncompleted transaction when the session closes.","pos":[1678,1852],"source":"<xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> specifies whether to complete an uncompleted transaction when the session closes."},{"content":"The default value for this property is <ph id=\"ph1\">`false`</ph>.","pos":[1853,1900],"source":" The default value for this property is `false`."},{"content":"If this property is <ph id=\"ph1\">`true`</ph>, and the incoming session was gracefully shut down instead of closing due to network or client faults, any uncompleted transaction is successfully completed.","pos":[1901,2085],"source":" If this property is `true`, and the incoming session was gracefully shut down instead of closing due to network or client faults, any uncompleted transaction is successfully completed."},{"content":"Otherwise, if this property is <ph id=\"ph1\">`false`</ph> or if the session was not gracefully closed, any uncompleted transaction is rolled back when the session closes.","pos":[2086,2237],"source":" Otherwise, if this property is `false` or if the session was not gracefully closed, any uncompleted transaction is rolled back when the session closes."},{"content":"If this property is <ph id=\"ph1\">`true`</ph>, the incoming channel must be session-based.","pos":[2238,2309],"source":" If this property is `true`, the incoming channel must be session-based."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A&gt;</ph> specifies whether the underlying service instance is released when a transaction completes.","pos":[2319,2509],"source":"<xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A> specifies whether the underlying service instance is released when a transaction completes."},{"content":"The default value for this property is <ph id=\"ph1\">`true`</ph>.","pos":[2510,2556],"source":" The default value for this property is `true`."},{"content":"The next inbound message causes a new underlying instance to be created, discarding any per-transaction state that the previous instance might have held.","pos":[2557,2710]},{"content":"Releasing a service instance is an internal action the service takes and has no impact on any existing connections or sessions that clients might have established.","pos":[2711,2874]},{"content":"This functionality is equivalent to the just-in-time activation feature COM+ provides.","pos":[2875,2961]},{"content":"If the property is <ph id=\"ph1\">`true`</ph>, <ph id=\"ph2\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A&gt;</ph> must be equal to <ph id=\"ph3\">&lt;xref:System.ServiceModel.ConcurrencyMode.Single&gt;</ph>.","pos":[2962,3127],"source":" If the property is `true`, <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> must be equal to <xref:System.ServiceModel.ConcurrencyMode.Single>."},{"content":"Otherwise, the service throws an invalid configuration validation exception during startup.","pos":[3128,3219]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionIsolationLevel%2A&gt;</ph> specifies the isolation level to use for transactions within the service; this property takes one of the <ph id=\"ph2\">&lt;xref:System.Transactions.IsolationLevel&gt;</ph> values.","pos":[3229,3464],"source":"<xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionIsolationLevel%2A> specifies the isolation level to use for transactions within the service; this property takes one of the <xref:System.Transactions.IsolationLevel> values."},{"content":"If the local isolation level property is anything other than <ph id=\"ph1\">&lt;xref:System.Transactions.IsolationLevel.Unspecified&gt;</ph>, the isolation level of an incoming transaction must match the setting of this local property.","pos":[3465,3674],"source":" If the local isolation level property is anything other than <xref:System.Transactions.IsolationLevel.Unspecified>, the isolation level of an incoming transaction must match the setting of this local property."},{"content":"Otherwise, the incoming transaction is rejected, and a fault is sent back to the client.","pos":[3675,3763]},{"content":"If <ph id=\"ph1\">&lt;xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A&gt;</ph> is <ph id=\"ph2\">`true`</ph>, and no transaction is flowed, this property determines the <ph id=\"ph3\">&lt;xref:System.Transactions.IsolationLevel&gt;</ph> value to use for the locally created transaction.","pos":[3764,4010],"source":" If <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> is `true`, and no transaction is flowed, this property determines the <xref:System.Transactions.IsolationLevel> value to use for the locally created transaction."},{"content":"If <ph id=\"ph1\">&lt;xref:System.Transactions.IsolationLevel&gt;</ph> is set to <ph id=\"ph2\">&lt;xref:System.Transactions.IsolationLevel.Unspecified&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Transactions.IsolationLevel&gt;</ph><ph id=\"ph4\">&lt;xref:System.Transactions.IsolationLevel.Serializable&gt;</ph> is used.","pos":[4011,4225],"source":" If <xref:System.Transactions.IsolationLevel> is set to <xref:System.Transactions.IsolationLevel.Unspecified>, <xref:System.Transactions.IsolationLevel><xref:System.Transactions.IsolationLevel.Serializable> is used."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A&gt;</ph> specifies the time period within which a new transaction created at the service must complete.","pos":[4235,4403],"source":"<xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> specifies the time period within which a new transaction created at the service must complete."},{"content":"If this time is reached and the transaction has not been completed, it will abort.","pos":[4404,4486]},{"content":"The <ph id=\"ph1\">&lt;xref:System.TimeSpan&gt;</ph> is used as the <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> time-out for any operations that have <ph id=\"ph3\">&lt;xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A&gt;</ph> set to <ph id=\"ph4\">`true`</ph> and for which a new transaction was created.","pos":[4487,4751],"source":" The <xref:System.TimeSpan> is used as the <xref:System.Transactions.TransactionScope> time-out for any operations that have <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> set to `true` and for which a new transaction was created."},{"content":"The time-out is the maximum allowed duration from the creation of the transaction to the completion of phase 1 in the two-phase commit protocol.","pos":[4752,4896]},{"content":"The time-out value used is always the lower value between the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A&gt;</ph> property and the <ph id=\"ph2\">`transactionTimeout`</ph> configuration setting.","pos":[4897,5093],"source":" The time-out value used is always the lower value between the <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> property and the `transactionTimeout` configuration setting."},{"pos":[5102,5128],"content":"OperationBehaviorAttribute","linkify":"OperationBehaviorAttribute","nodes":[{"content":"OperationBehaviorAttribute","pos":[0,26]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.OperationBehaviorAttribute&gt;</ph> attribute specifies the behaviors of the methods in the service implementation.","pos":[5132,5269],"source":"The <xref:System.ServiceModel.OperationBehaviorAttribute> attribute specifies the behaviors of the methods in the service implementation."},{"content":"You can use it to indicate the operation's specific execution behavior.","pos":[5270,5341]},{"content":"Properties of this attribute do not affect the Web Service Description Language (WSDL) description of the service contract, and are purely elements of the WCF programming model that enable common features that developers otherwise have to implement themselves.","pos":[5342,5602]},{"content":"This attribute has the following transaction-specific properties:","pos":[5609,5674]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A&gt;</ph> specifies whether a method must execute within an active transaction scope.","pos":[5684,5841],"source":"<xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> specifies whether a method must execute within an active transaction scope."},{"content":"The default is <ph id=\"ph1\">`false`</ph>.","pos":[5842,5865],"source":" The default is `false`."},{"content":"If the <ph id=\"ph1\">&lt;xref:System.ServiceModel.OperationBehaviorAttribute&gt;</ph> attribute is not set for a method, it also implies that the method will not execute in a transaction.","pos":[5866,6028],"source":" If the <xref:System.ServiceModel.OperationBehaviorAttribute> attribute is not set for a method, it also implies that the method will not execute in a transaction."},{"content":"If a transaction scope is not required for an operation, any transaction that is present within the message header is not activated and remains as an element of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.OperationContext.IncomingMessageProperties%2A&gt;</ph> of the <ph id=\"ph2\">&lt;xref:System.ServiceModel.OperationContext&gt;</ph>.","pos":[6029,6318],"source":" If a transaction scope is not required for an operation, any transaction that is present within the message header is not activated and remains as an element of the <xref:System.ServiceModel.OperationContext.IncomingMessageProperties%2A> of the <xref:System.ServiceModel.OperationContext>."},{"content":"If a transaction scope is required for an operation, the source for the transaction is derived from one of the following:","pos":[6319,6440]},{"content":"If a transaction is flowed from the client, the method is executed under a transaction scope created using that distributed transaction.","pos":[6454,6590]},{"content":"With a queued transport, the transaction used to dequeue the message is used.","pos":[6604,6681]},{"content":"Note that the transaction used is not a flowed transaction, in that it was not provided by the original sender of the message.","pos":[6682,6808]},{"pos":[6822,6921],"content":"A custom transport can provide a transaction through the use of the <ph id=\"ph1\">`TransportTransactionProperty`</ph>.","source":"A custom transport can provide a transaction through the use of the `TransportTransactionProperty`."},{"pos":[6935,7108],"content":"If none of the above provides an external source for a transaction, a new <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction&gt;</ph> instance is created immediately prior to calling the method.","source":"If none of the above provides an external source for a transaction, a new <xref:System.Transactions.Transaction> instance is created immediately prior to calling the method."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.OperationBehaviorAttribute.TransactionAutoComplete%2A&gt;</ph> specifies whether the transaction in which the method executes is automatically completed if no unhandled exceptions are thrown.","pos":[7118,7327],"source":"<xref:System.ServiceModel.OperationBehaviorAttribute.TransactionAutoComplete%2A> specifies whether the transaction in which the method executes is automatically completed if no unhandled exceptions are thrown."},{"content":"If this property is <ph id=\"ph1\">`true`</ph>, the calling infrastructure automatically marks the transaction as \"completed\" if the user method returns without throwing an exception.","pos":[7328,7491],"source":" If this property is `true`, the calling infrastructure automatically marks the transaction as \"completed\" if the user method returns without throwing an exception."},{"content":"If this property is <ph id=\"ph1\">`false`</ph>, the transaction is attached to the instance, and is only marked as \"completed\" if the client calls a subsequent method that is marked with this property equal to <ph id=\"ph2\">`true`</ph>, or if a subsequent method explicitly calls <ph id=\"ph3\">&lt;xref:System.ServiceModel.OperationContext.SetTransactionComplete%2A&gt;</ph>.","pos":[7492,7804],"source":" If this property is `false`, the transaction is attached to the instance, and is only marked as \"completed\" if the client calls a subsequent method that is marked with this property equal to `true`, or if a subsequent method explicitly calls <xref:System.ServiceModel.OperationContext.SetTransactionComplete%2A>."},{"content":"Failure to perform either of these results in the transaction never being \"completed,\" and the contained work is not committed, unless the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A&gt;</ph> property is set to <ph id=\"ph2\">`true`</ph>.","pos":[7805,8063],"source":" Failure to perform either of these results in the transaction never being \"completed,\" and the contained work is not committed, unless the <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> property is set to `true`."},{"content":"If this property is set to <ph id=\"ph1\">`true`</ph>, you must use a channel with a session, and the <ph id=\"ph2\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A&gt;</ph> must be set to <ph id=\"ph3\">&lt;xref:System.ServiceModel.InstanceContextMode.PerSession&gt;</ph>.","pos":[8064,8294],"source":" If this property is set to `true`, you must use a channel with a session, and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> must be set to <xref:System.ServiceModel.InstanceContextMode.PerSession>."}]}