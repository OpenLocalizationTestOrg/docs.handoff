{"content":"---\ntitle: \"Scope of Default Namespaces in Visual Basic\"\nms.date: 07/20/2015\nms.assetid: d4cce80c-342f-4097-be8b-40ab0bfa90ba\n---\n# Scope of Default Namespaces in Visual Basic\nDefault namespaces as represented in the XML tree are not in scope for queries. If you have XML that is in a default namespace, you still must declare an <xref:System.Xml.Linq.XNamespace> variable, and combine it with the local name to make a qualified name to be used in the query.  \n  \n One of the most common problems when querying XML trees is that if the XML tree has a default namespace, the developer sometimes writes the query as though the XML were not in a namespace.  \n  \n The first set of examples in this topic shows a typical way that XML in a default namespace is loaded, but is queried improperly.  \n  \n The second set of examples show the necessary corrections so that you can query XML in a namespace.  \n  \n## Example  \n This example shows the creation of XML in a namespace, and a query that returns an empty result set.  \n  \n### Code  \n  \n```vb  \nModule Module1  \n    Sub Main()  \n        Dim root As XElement = _  \n            <Root xmlns='http://www.adventure-works.com'>  \n                <Child>1</Child>  \n                <Child>2</Child>  \n                <Child>3</Child>  \n                <AnotherChild>4</AnotherChild>  \n                <AnotherChild>5</AnotherChild>  \n                <AnotherChild>6</AnotherChild>  \n            </Root>  \n        Dim c1 As IEnumerable(Of XElement) = _  \n                From el In root.<Child> _  \n                Select el  \n        Console.WriteLine(\"Result set follows:\")  \n        For Each el As XElement In c1  \n            Console.WriteLine(CInt(el))  \n        Next  \n        Console.WriteLine(\"End of result set\")  \n    End Sub  \nEnd Module  \n```  \n  \n### Comments  \n This example produces the following result:  \n  \n```  \nResult set follows:  \nEnd of result set  \n```  \n  \n## Example  \n This example shows the creation of XML in a namespace, and a query that is coded properly.  \n  \n In contrast to the incorrectly coded example above, the correct approach when using Visual Basic is to declare and initialize a global default namespace. This places all XML properties in the default namespace. No other modifications are required to the example to make it work properly.  \n  \n### Code  \n  \n```vb  \nImports <xmlns=\"http://www.adventure-works.com\">  \n  \nModule Module1  \n    Sub Main()  \n        Dim root As XElement = _  \n            <Root xmlns='http://www.adventure-works.com'>  \n                <Child>1</Child>  \n                <Child>2</Child>  \n                <Child>3</Child>  \n                <AnotherChild>4</AnotherChild>  \n                <AnotherChild>5</AnotherChild>  \n                <AnotherChild>6</AnotherChild>  \n            </Root>  \n        Dim c1 As IEnumerable(Of XElement) = _  \n                From el In root.<Child> _  \n                Select el  \n        Console.WriteLine(\"Result set follows:\")  \n        For Each el As XElement In c1  \n            Console.WriteLine(el.Value)  \n        Next  \n        Console.WriteLine(\"End of result set\")  \n    End Sub  \nEnd Module  \n```  \n  \n### Comments  \n This example produces the following result:  \n  \n```  \nResult set follows:  \n1  \n2  \n3  \nEnd of result set  \n```  \n  \n## See also\n\n- [Working with XML Namespaces (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/working-with-xml-namespaces.md)\n","nodes":[{"pos":[4,125],"embed":true,"restype":"x-metadata","content":"title: \"Scope of Default Namespaces in Visual Basic\"\nms.date: 07/20/2015\nms.assetid: d4cce80c-342f-4097-be8b-40ab0bfa90ba","nodes":[{"content":"Scope of Default Namespaces in Visual Basic","nodes":[{"pos":[0,43],"content":"Scope of Default Namespaces in Visual Basic","nodes":[{"content":"Scope of Default Namespaces in Visual Basic","pos":[0,43]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[132,175],"content":"Scope of Default Namespaces in Visual Basic","linkify":"Scope of Default Namespaces in Visual Basic","nodes":[{"content":"Scope of Default Namespaces in Visual Basic","pos":[0,43]}]},{"content":"Default namespaces as represented in the XML tree are not in scope for queries.","pos":[176,255]},{"content":"If you have XML that is in a default namespace, you still must declare an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XNamespace&gt;</ph> variable, and combine it with the local name to make a qualified name to be used in the query.","pos":[256,458],"source":" If you have XML that is in a default namespace, you still must declare an <xref:System.Xml.Linq.XNamespace> variable, and combine it with the local name to make a qualified name to be used in the query."},{"content":"One of the most common problems when querying XML trees is that if the XML tree has a default namespace, the developer sometimes writes the query as though the XML were not in a namespace.","pos":[465,653]},{"content":"The first set of examples in this topic shows a typical way that XML in a default namespace is loaded, but is queried improperly.","pos":[660,789]},{"content":"The second set of examples show the necessary corrections so that you can query XML in a namespace.","pos":[796,895]},{"pos":[904,911],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example shows the creation of XML in a namespace, and a query that returns an empty result set.","pos":[915,1015]},{"pos":[1025,1029],"content":"Code","linkify":"Code","nodes":[{"content":"Code","pos":[0,4]}]},{"pos":[1804,1812],"content":"Comments","linkify":"Comments","nodes":[{"content":"Comments","pos":[0,8]}]},{"content":"This example produces the following result:","pos":[1816,1859]},{"pos":[1925,1932],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example shows the creation of XML in a namespace, and a query that is coded properly.","pos":[1936,2026]},{"content":"In contrast to the incorrectly coded example above, the correct approach when using Visual Basic is to declare and initialize a global default namespace.","pos":[2033,2186]},{"content":"This places all XML properties in the default namespace.","pos":[2187,2243]},{"content":"No other modifications are required to the example to make it work properly.","pos":[2244,2320]},{"pos":[2330,2334],"content":"Code","linkify":"Code","nodes":[{"content":"Code","pos":[0,4]}]},{"pos":[3163,3171],"content":"Comments","linkify":"Comments","nodes":[{"content":"Comments","pos":[0,8]}]},{"content":"This example produces the following result:","pos":[3175,3218]},{"pos":[3296,3304],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3308,3441],"content":"<bpt id=\"p1\">[</bpt>Working with XML Namespaces (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/working-with-xml-namespaces.md)</ept>","source":"[Working with XML Namespaces (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/working-with-xml-namespaces.md)"}]}