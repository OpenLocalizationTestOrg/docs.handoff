{"content":"---\ntitle: \"How to: Implement Two-Way Communication Between DHTML Code and Client Application Code | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"WebBrowser.ObjectForScripting\"\n  - \"WebBrowser.Document\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"WebBrowser control [Windows Forms], examples\"\n  - \"communications, DHTML and client applications\"\n  - \"examples [Windows Forms], WebBrowser control\"\n  - \"WebBrowser control [Windows Forms], communication between DHTML and client application\"\n  - \"DHTML, embedding in Windows Forms\"\nms.assetid: 55353a32-b09e-4479-a521-ff3a5ff9a708\ncaps.latest.revision: 18\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Implement Two-Way Communication Between DHTML Code and Client Application Code\nYou can use the <xref:System.Windows.Forms.WebBrowser> control to add existing dynamic HTML (DHTML) Web application code to your Windows Forms client applications. This is useful when you have invested significant development time in creating DHTML-based controls and you want to take advantage of the rich user interface capabilities of Windows Forms without having to rewrite existing code.  \n  \n The <xref:System.Windows.Forms.WebBrowser> control lets you implement two-way communication between your client application code and your Web page scripting code through the <xref:System.Windows.Forms.WebBrowser.ObjectForScripting%2A> and <xref:System.Windows.Forms.WebBrowser.Document%2A> properties. Additionally, you can configure the <xref:System.Windows.Forms.WebBrowser> control so that your Web controls blend seamlessly with other controls on your application form, hiding their DHTML implementation. To seamlessly blend the controls, format the page displayed so that its background color and visual style match the rest of the form, and use the <xref:System.Windows.Forms.WebBrowser.AllowWebBrowserDrop%2A>, <xref:System.Windows.Forms.WebBrowser.IsWebBrowserContextMenuEnabled%2A>, and <xref:System.Windows.Forms.WebBrowser.WebBrowserShortcutsEnabled%2A> properties to disable standard browser features.  \n  \n### To embed DHTML in your Windows Forms application  \n  \n1.  Set the <xref:System.Windows.Forms.WebBrowser> control's <xref:System.Windows.Forms.WebBrowser.AllowWebBrowserDrop%2A> property to `false` to prevent the <xref:System.Windows.Forms.WebBrowser> control from opening files dropped onto it.  \n  \n     [!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#1](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#1)]\n     [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#1](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#1)]  \n  \n2.  Set the control's <xref:System.Windows.Forms.WebBrowser.IsWebBrowserContextMenuEnabled%2A> property to `false` to prevent the <xref:System.Windows.Forms.WebBrowser> control from displaying its shortcut menu when the user right-clicks it.  \n  \n     [!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#2](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#2)]\n     [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#2](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#2)]  \n  \n3.  Set the control's <xref:System.Windows.Forms.WebBrowser.WebBrowserShortcutsEnabled%2A> property to `false` to prevent the <xref:System.Windows.Forms.WebBrowser> control from responding to shortcut keys.  \n  \n     [!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#3](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#3)]\n     [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#3](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#3)]  \n  \n4.  Set the <xref:System.Windows.Forms.WebBrowser.ObjectForScripting%2A> property in the form's constructor or a <xref:System.Windows.Forms.Form.Load> event handler.  \n  \n     The following code uses the form class itself for the scripting object.  \n  \n    > [!NOTE]\n    >  Component Object Model (COM) must be able to access the scripting object. To make your form visible to COM, add the <xref:System.Runtime.InteropServices.ComVisibleAttribute> attribute to your form class.  \n  \n     [!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#4](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#4)]\n     [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#4](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#4)]  \n  \n5.  Implement public properties or methods in your application code that your script code will use.  \n  \n     For example, if you use the form class for the scripting object, add the following code to your form class.  \n  \n     [!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#5](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#5)]\n     [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#5](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#5)]  \n  \n6.  Use the `window.external` object in your scripting code to access public properties and methods of the specified object.  \n  \n     The following HTML code demonstrates how to call a method on the scripting object from a button click. Copy this code into the BODY element of an HTML document that you load using the control's <xref:System.Windows.Forms.WebBrowser.Navigate%2A> method or that you assign to the control's <xref:System.Windows.Forms.WebBrowser.DocumentText%2A> property.  \n  \n    ```  \n    <button onclick=\"window.external.Test('called from script code')\">  \n        call client code from script code  \n    </button>  \n    ```  \n  \n7.  Implement functions in your script code that your application code will use.  \n  \n     The following HTML SCRIPT element provides an example function. Copy this code into the HEAD element of an HTML document that you load using the control's <xref:System.Windows.Forms.WebBrowser.Navigate%2A> method or that you assign to the control's <xref:System.Windows.Forms.WebBrowser.DocumentText%2A> property.  \n  \n    ```  \n    <script>  \n    function test(message) {   \n        alert(message);   \n    }  \n    </script>  \n    ```  \n  \n8.  Use the <xref:System.Windows.Forms.WebBrowser.Document%2A> property to access the script code from your client application code.  \n  \n     For example, add the following code to a button <xref:System.Windows.Forms.Control.Click> event handler.  \n  \n     [!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#8](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#8)]\n     [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#8](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#8)]  \n  \n9. When you are finished debugging your DHTML, set the control's <xref:System.Windows.Forms.WebBrowser.ScriptErrorsSuppressed%2A> property to `true` to prevent the <xref:System.Windows.Forms.WebBrowser> control from displaying error messages for script code problems.  \n  \n     [!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#9](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#9)]\n     [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#9](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#9)]  \n  \n## Example  \n The following complete code example provides a demonstration application that you can use to understand this feature. The HTML code is loaded into the <xref:System.Windows.Forms.WebBrowser> control through the <xref:System.Windows.Forms.WebBrowser.DocumentText%2A> property instead of being loaded from a separate HTML file.  \n  \n [!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#0](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#0)]\n [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#0](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#0)]  \n  \n## Compiling the Code  \n This code requires:  \n  \n-   References to the System and System.Windows.Forms assemblies.  \n  \n For information about building this example from the command line for [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)] or [!INCLUDE[csprcs](../../../../includes/csprcs-md.md)], see [Building from the Command Line](~/docs/visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md). You can also build this example in [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] by pasting the code into a new project.  Also see [How to: Compile and Run a Complete Windows Forms Code Example Using Visual Studio](http://msdn.microsoft.com/library/Bb129228\\(v=vs.110\\)).  \n  \n## See Also  \n <xref:System.Windows.Forms.WebBrowser>   \n <xref:System.Windows.Forms.WebBrowser.Document%2A?displayProperty=fullName>   \n <xref:System.Windows.Forms.WebBrowser.ObjectForScripting%2A?displayProperty=fullName>   \n [WebBrowser Control](../../../../docs/framework/winforms/controls/webbrowser-control-windows-forms.md)","nodes":[{"pos":[4,831],"embed":true,"restype":"x-metadata","content":"title: \"How to: Implement Two-Way Communication Between DHTML Code and Client Application Code | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"WebBrowser.ObjectForScripting\"\n  - \"WebBrowser.Document\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"WebBrowser control [Windows Forms], examples\"\n  - \"communications, DHTML and client applications\"\n  - \"examples [Windows Forms], WebBrowser control\"\n  - \"WebBrowser control [Windows Forms], communication between DHTML and client application\"\n  - \"DHTML, embedding in Windows Forms\"\nms.assetid: 55353a32-b09e-4479-a521-ff3a5ff9a708\ncaps.latest.revision: 18\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"How to: Implement Two-Way Communication Between DHTML Code and Client Application Code | Microsoft Docs","nodes":[{"pos":[0,103],"content":"How to: Implement Two-Way Communication Between DHTML Code and Client Application Code | Microsoft Docs","nodes":[{"content":"How to: Implement Two-Way Communication Between DHTML Code and Client Application Code | Microsoft Docs","pos":[0,103]}]}],"path":["title"]}],"yml":true},{"pos":[838,924],"content":"How to: Implement Two-Way Communication Between DHTML Code and Client Application Code","linkify":"How to: Implement Two-Way Communication Between DHTML Code and Client Application Code","nodes":[{"content":"How to: Implement Two-Way Communication Between DHTML Code and Client Application Code","pos":[0,86]}]},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control to add existing dynamic HTML (DHTML) Web application code to your Windows Forms client applications.","pos":[925,1088],"source":"You can use the <xref:System.Windows.Forms.WebBrowser> control to add existing dynamic HTML (DHTML) Web application code to your Windows Forms client applications."},{"content":"This is useful when you have invested significant development time in creating DHTML-based controls and you want to take advantage of the rich user interface capabilities of Windows Forms without having to rewrite existing code.","pos":[1089,1317]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control lets you implement two-way communication between your client application code and your Web page scripting code through the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.WebBrowser.ObjectForScripting%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Forms.WebBrowser.Document%2A&gt;</ph> properties.","pos":[1324,1625],"source":"The <xref:System.Windows.Forms.WebBrowser> control lets you implement two-way communication between your client application code and your Web page scripting code through the <xref:System.Windows.Forms.WebBrowser.ObjectForScripting%2A> and <xref:System.Windows.Forms.WebBrowser.Document%2A> properties."},{"content":"Additionally, you can configure the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control so that your Web controls blend seamlessly with other controls on your application form, hiding their DHTML implementation.","pos":[1626,1832],"source":" Additionally, you can configure the <xref:System.Windows.Forms.WebBrowser> control so that your Web controls blend seamlessly with other controls on your application form, hiding their DHTML implementation."},{"content":"To seamlessly blend the controls, format the page displayed so that its background color and visual style match the rest of the form, and use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.AllowWebBrowserDrop%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Forms.WebBrowser.IsWebBrowserContextMenuEnabled%2A&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Windows.Forms.WebBrowser.WebBrowserShortcutsEnabled%2A&gt;</ph> properties to disable standard browser features.","pos":[1833,2237],"source":" To seamlessly blend the controls, format the page displayed so that its background color and visual style match the rest of the form, and use the <xref:System.Windows.Forms.WebBrowser.AllowWebBrowserDrop%2A>, <xref:System.Windows.Forms.WebBrowser.IsWebBrowserContextMenuEnabled%2A>, and <xref:System.Windows.Forms.WebBrowser.WebBrowserShortcutsEnabled%2A> properties to disable standard browser features."},{"pos":[2247,2295],"content":"To embed DHTML in your Windows Forms application","linkify":"To embed DHTML in your Windows Forms application","nodes":[{"content":"To embed DHTML in your Windows Forms application","pos":[0,48]}]},{"pos":[2305,2541],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.WebBrowser.AllowWebBrowserDrop%2A&gt;</ph> property to <ph id=\"ph3\">`false`</ph> to prevent the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control from opening files dropped onto it.","source":"Set the <xref:System.Windows.Forms.WebBrowser> control's <xref:System.Windows.Forms.WebBrowser.AllowWebBrowserDrop%2A> property to `false` to prevent the <xref:System.Windows.Forms.WebBrowser> control from opening files dropped onto it."},{"pos":[2552,2941],"content":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#1](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#1)]\n [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#1](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#1)]","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#1)</ept><ept id=\"p1\">]</ept>","pos":[0,191],"source":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#1](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#1)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#1<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#1)</ept><ept id=\"p1\">]</ept>","pos":[193,385],"source":"[!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#1](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#1)]"}]},{"pos":[2951,3188],"content":"Set the control's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.IsWebBrowserContextMenuEnabled%2A&gt;</ph> property to <ph id=\"ph2\">`false`</ph> to prevent the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control from displaying its shortcut menu when the user right-clicks it.","source":"Set the control's <xref:System.Windows.Forms.WebBrowser.IsWebBrowserContextMenuEnabled%2A> property to `false` to prevent the <xref:System.Windows.Forms.WebBrowser> control from displaying its shortcut menu when the user right-clicks it."},{"pos":[3199,3588],"content":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#2](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#2)]\n [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#2](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#2)]","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#2<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#2)</ept><ept id=\"p1\">]</ept>","pos":[0,191],"source":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#2](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#2)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#2<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#2)</ept><ept id=\"p1\">]</ept>","pos":[193,385],"source":"[!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#2](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#2)]"}]},{"pos":[3598,3800],"content":"Set the control's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.WebBrowserShortcutsEnabled%2A&gt;</ph> property to <ph id=\"ph2\">`false`</ph> to prevent the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control from responding to shortcut keys.","source":"Set the control's <xref:System.Windows.Forms.WebBrowser.WebBrowserShortcutsEnabled%2A> property to `false` to prevent the <xref:System.Windows.Forms.WebBrowser> control from responding to shortcut keys."},{"pos":[3811,4200],"content":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#3](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#3)]\n [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#3](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#3)]","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#3<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#3)</ept><ept id=\"p1\">]</ept>","pos":[0,191],"source":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#3](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#3)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#3<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#3)</ept><ept id=\"p1\">]</ept>","pos":[193,385],"source":"[!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#3](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#3)]"}]},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.ObjectForScripting%2A&gt;</ph> property in the form's constructor or a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Form.Load&gt;</ph> event handler.","pos":[4210,4371],"source":"Set the <xref:System.Windows.Forms.WebBrowser.ObjectForScripting%2A> property in the form's constructor or a <xref:System.Windows.Forms.Form.Load> event handler."},{"content":"The following code uses the form class itself for the scripting object.","pos":[4382,4453]},{"pos":[4465,4683],"content":"[!NOTE]\nComponent Object Model (COM) must be able to access the scripting object. To make your form visible to COM, add the <xref:System.Runtime.InteropServices.ComVisibleAttribute> attribute to your form class.","leadings":["","    >  "],"nodes":[{"content":"Component Object Model (COM) must be able to access the scripting object. To make your form visible to COM, add the <xref:System.Runtime.InteropServices.ComVisibleAttribute> attribute to your form class.","pos":[8,211],"nodes":[{"content":"Component Object Model (COM) must be able to access the scripting object.","pos":[0,73]},{"content":"To make your form visible to COM, add the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.ComVisibleAttribute&gt;</ph> attribute to your form class.","pos":[74,203],"source":" To make your form visible to COM, add the <xref:System.Runtime.InteropServices.ComVisibleAttribute> attribute to your form class."}]}]},{"pos":[4694,5083],"content":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#4](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#4)]\n [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#4](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#4)]","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#4<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#4)</ept><ept id=\"p1\">]</ept>","pos":[0,191],"source":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#4](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#4)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#4<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#4)</ept><ept id=\"p1\">]</ept>","pos":[193,385],"source":"[!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#4](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#4)]"}]},{"content":"Implement public properties or methods in your application code that your script code will use.","pos":[5093,5188]},{"content":"For example, if you use the form class for the scripting object, add the following code to your form class.","pos":[5199,5306]},{"pos":[5317,5706],"content":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#5](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#5)]\n [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#5](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#5)]","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#5<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#5)</ept><ept id=\"p1\">]</ept>","pos":[0,191],"source":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#5](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#5)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#5<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#5)</ept><ept id=\"p1\">]</ept>","pos":[193,385],"source":"[!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#5](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#5)]"}]},{"pos":[5716,5836],"content":"Use the <ph id=\"ph1\">`window.external`</ph> object in your scripting code to access public properties and methods of the specified object.","source":"Use the `window.external` object in your scripting code to access public properties and methods of the specified object."},{"content":"The following HTML code demonstrates how to call a method on the scripting object from a button click.","pos":[5847,5949]},{"content":"Copy this code into the BODY element of an HTML document that you load using the control's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.Navigate%2A&gt;</ph> method or that you assign to the control's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.WebBrowser.DocumentText%2A&gt;</ph> property.","pos":[5950,6199],"source":" Copy this code into the BODY element of an HTML document that you load using the control's <xref:System.Windows.Forms.WebBrowser.Navigate%2A> method or that you assign to the control's <xref:System.Windows.Forms.WebBrowser.DocumentText%2A> property."},{"content":"Implement functions in your script code that your application code will use.","pos":[6365,6441]},{"content":"The following HTML SCRIPT element provides an example function.","pos":[6452,6515]},{"content":"Copy this code into the HEAD element of an HTML document that you load using the control's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.Navigate%2A&gt;</ph> method or that you assign to the control's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.WebBrowser.DocumentText%2A&gt;</ph> property.","pos":[6516,6765],"source":" Copy this code into the HEAD element of an HTML document that you load using the control's <xref:System.Windows.Forms.WebBrowser.Navigate%2A> method or that you assign to the control's <xref:System.Windows.Forms.WebBrowser.DocumentText%2A> property."},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.Document%2A&gt;</ph> property to access the script code from your client application code.","pos":[6896,7024],"source":"Use the <xref:System.Windows.Forms.WebBrowser.Document%2A> property to access the script code from your client application code."},{"content":"For example, add the following code to a button <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler.","pos":[7035,7139],"source":"For example, add the following code to a button <xref:System.Windows.Forms.Control.Click> event handler."},{"pos":[7150,7539],"content":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#8](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#8)]\n [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#8](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#8)]","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#8<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#8)</ept><ept id=\"p1\">]</ept>","pos":[0,191],"source":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#8](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#8)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#8<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#8)</ept><ept id=\"p1\">]</ept>","pos":[193,385],"source":"[!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#8](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#8)]"}]},{"pos":[7548,7812],"content":"When you are finished debugging your DHTML, set the control's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.ScriptErrorsSuppressed%2A&gt;</ph> property to <ph id=\"ph2\">`true`</ph> to prevent the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control from displaying error messages for script code problems.","source":"When you are finished debugging your DHTML, set the control's <xref:System.Windows.Forms.WebBrowser.ScriptErrorsSuppressed%2A> property to `true` to prevent the <xref:System.Windows.Forms.WebBrowser> control from displaying error messages for script code problems."},{"pos":[7823,8212],"content":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#9](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#9)]\n  [!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#9](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#9)]","leadings":["","   "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#9<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#9)</ept><ept id=\"p1\">]</ept>","pos":[0,191],"source":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#9](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#9)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#9<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#9)</ept><ept id=\"p1\">]</ept>","pos":[194,386],"source":"[!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#9](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#9)]"}]},{"pos":[8221,8228],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following complete code example provides a demonstration application that you can use to understand this feature.","pos":[8232,8349]},{"content":"The HTML code is loaded into the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph> control through the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.WebBrowser.DocumentText%2A&gt;</ph> property instead of being loaded from a separate HTML file.","pos":[8350,8556],"source":" The HTML code is loaded into the <xref:System.Windows.Forms.WebBrowser> control through the <xref:System.Windows.Forms.WebBrowser.DocumentText%2A> property instead of being loaded from a separate HTML file."},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#0<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#0)</ept><ept id=\"p1\">]</ept>","pos":[8563,8754],"source":"[!code-csharp[System.Windows.Forms.WebBrowser.ObjectForScripting#0](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/CS/form1.cs#0)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.WebBrowser.ObjectForScripting#0<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#0)</ept><ept id=\"p1\">]</ept>","pos":[8756,8948],"source":"[!code-vb[System.Windows.Forms.WebBrowser.ObjectForScripting#0](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.WebBrowser.ObjectForScripting/vb/form1.vb#0)]"},{"pos":[8957,8975],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"This code requires:","pos":[8979,8998]},{"content":"References to the System and System.Windows.Forms assemblies.","pos":[9008,9069]},{"content":"For information about building this example from the command line for <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]</ph> or <ph id=\"ph2\">[!INCLUDE[csprcs](../../../../includes/csprcs-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Building from the Command Line<ept id=\"p1\">](~/docs/visual-basic/reference/command-line-compiler/building-from-the-command-line.md)</ept> or <bpt id=\"p2\">[</bpt>Command-line Building With csc.exe<ept id=\"p2\">](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)</ept>.","pos":[9076,9511],"source":"For information about building this example from the command line for [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)] or [!INCLUDE[csprcs](../../../../includes/csprcs-md.md)], see [Building from the Command Line](~/docs/visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)."},{"content":"You can also build this example in <ph id=\"ph1\">[!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)]</ph> by pasting the code into a new project.","pos":[9512,9640],"source":" You can also build this example in [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] by pasting the code into a new project."},{"content":"Also see <bpt id=\"p1\">[</bpt>How to: Compile and Run a Complete Windows Forms Code Example Using Visual Studio<ept id=\"p1\">](http://msdn.microsoft.com/library/Bb129228\\(v=vs.110\\))</ept>.","pos":[9642,9791],"source":"  Also see [How to: Compile and Run a Complete Windows Forms Code Example Using Visual Studio](http://msdn.microsoft.com/library/Bb129228\\(v=vs.110\\))."},{"pos":[9800,9808],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser&gt;</ph>","pos":[9812,9850],"source":"<xref:System.Windows.Forms.WebBrowser> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.Document%2A?displayProperty=fullName&gt;</ph>","pos":[9855,9930],"source":"<xref:System.Windows.Forms.WebBrowser.Document%2A?displayProperty=fullName> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.WebBrowser.ObjectForScripting%2A?displayProperty=fullName&gt;</ph>","pos":[9935,10020],"source":"<xref:System.Windows.Forms.WebBrowser.ObjectForScripting%2A?displayProperty=fullName> "},{"content":"<bpt id=\"p1\">[</bpt>WebBrowser Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/webbrowser-control-windows-forms.md)</ept>","pos":[10025,10127],"source":"[WebBrowser Control](../../../../docs/framework/winforms/controls/webbrowser-control-windows-forms.md)"}]}