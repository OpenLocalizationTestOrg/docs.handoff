{"content":"---\ntitle: \"ICorProfilerCallback2::RootReferences2 Method\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"ICorProfilerCallback2.RootReferences2\"\napi_location: \n  - \"mscorwks.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICorProfilerCallback2::RootReferences2\"\nhelpviewer_keywords: \n  - \"RootReferences2 method [.NET Framework profiling]\"\n  - \"ICorProfilerCallback2::RootReferences2 method [.NET Framework profiling]\"\nms.assetid: 55a2f907-d216-42eb-8f2f-e5d59c2eebd6\ntopic_type: \n  - \"apiref\"\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# ICorProfilerCallback2::RootReferences2 Method\nNotifies the profiler about root references after a garbage collection has occurred. This method is an extension of the [ICorProfilerCallback::RootReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-rootreferences-method.md) method.  \n  \n## Syntax  \n  \n```  \nHRESULT RootReferences2(  \n    [in] ULONG  cRootRefs,  \n    [in, size_is(cRootRefs)] ObjectID rootRefIds[],  \n    [in, size_is(cRootRefs)] COR_PRF_GC_ROOT_KIND rootKinds[],  \n    [in, size_is(cRootRefs)] COR_PRF_GC_ROOT_FLAGS rootFlags[],  \n    [in, size_is(cRootRefs)] UINT_PTR rootIds[]);  \n```  \n  \n## Parameters  \n `cRootRefs`  \n [in] The number of elements in the `rootRefIds`, `rootKinds`, `rootFlags`, and `rootIds` arrays.  \n  \n `rootRefIds`  \n [in] An array of object IDs, each of which references either a static object or an object on the stack. Elements in the `rootKinds` array provide information to classify corresponding elements in the `rootRefIds` array.  \n  \n `rootKinds`  \n [in] An array of [COR_PRF_GC_ROOT_KIND](../../../../docs/framework/unmanaged-api/profiling/cor-prf-gc-root-kind-enumeration.md) values that indicate the type of the garbage collection root.  \n  \n `rootFlags`  \n [in] An array of [COR_PRF_GC_ROOT_FLAGS](../../../../docs/framework/unmanaged-api/profiling/cor-prf-gc-root-flags-enumeration.md) values that describe the properties of a garbage collection root.  \n  \n `rootIds`  \n [in] An array of UINT_PTR values that point to an integer that contains additional information about the garbage collection root, depending on the value of the `rootKinds` parameter.  \n  \n If the type of the root is a stack, the root ID is for the function that contains the variable. If that root ID is 0, the function is an unnamed function that is internal to the CLR. If the type of the root is a handle, the root ID is for the garbage collection handle. For the other root types, the ID is an opaque value and should be ignored.  \n  \n## Remarks  \n The `rootRefIds`, `rootKinds`, `rootFlags`, and `rootIds` arrays are parallel arrays. That is, `rootRefIds[i]`, `rootKinds[i]`, `rootFlags[i]`, and `rootIds[i]` all concern the same root.  \n  \n Both `RootReferences` and `RootReferences2` are called to notify the profiler. Profilers will normally implement one method or the other, but not both, because the information passed in `RootReferences2` is a superset of that passed in `RootReferences`.  \n  \n It is possible for entries in `rootRefIds` to be zero, which implies that the corresponding root reference is null and does not refer to an object on the managed heap.  \n  \n The object IDs returned by `RootReferences2` are not valid during the callback itself, because the garbage collection might be in the middle of moving objects from old addresses to new addresses. Therefore, profilers should not attempt to inspect objects during a `RootReferences2` call. When [ICorProfilerCallback2::GarbageCollectionFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-garbagecollectionfinished-method.md) is called, all objects have been moved to their new locations and can be safely inspected.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** CorProf.idl, CorProf.h  \n  \n **Library:** CorGuids.lib  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See also\n\n- [ICorProfilerCallback Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md)\n- [ICorProfilerCallback2 Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md)\n","nodes":[{"pos":[4,518],"embed":true,"restype":"x-metadata","content":"title: \"ICorProfilerCallback2::RootReferences2 Method\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"ICorProfilerCallback2.RootReferences2\"\napi_location: \n  - \"mscorwks.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICorProfilerCallback2::RootReferences2\"\nhelpviewer_keywords: \n  - \"RootReferences2 method [.NET Framework profiling]\"\n  - \"ICorProfilerCallback2::RootReferences2 method [.NET Framework profiling]\"\nms.assetid: 55a2f907-d216-42eb-8f2f-e5d59c2eebd6\ntopic_type: \n  - \"apiref\"\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"ICorProfilerCallback2::RootReferences2 Method","nodes":[{"pos":[0,45],"content":"ICorProfilerCallback2::RootReferences2 Method","nodes":[{"content":"ICorProfilerCallback2::RootReferences2 Method","pos":[0,45]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[525,570],"content":"ICorProfilerCallback2::RootReferences2 Method","linkify":"ICorProfilerCallback2::RootReferences2 Method","nodes":[{"content":"ICorProfilerCallback2::RootReferences2 Method","pos":[0,45]}]},{"content":"Notifies the profiler about root references after a garbage collection has occurred.","pos":[571,655]},{"content":"This method is an extension of the <bpt id=\"p1\">[</bpt>ICorProfilerCallback::RootReferences<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-rootreferences-method.md)</ept> method.","pos":[656,835],"source":" This method is an extension of the [ICorProfilerCallback::RootReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-rootreferences-method.md) method."},{"pos":[844,850],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1167,1177],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The number of elements in the <ph id=\"ph1\">`rootRefIds`</ph>, <ph id=\"ph2\">`rootKinds`</ph>, <ph id=\"ph3\">`rootFlags`</ph>, and <ph id=\"ph4\">`rootIds`</ph> arrays.","pos":[1196,1292],"source":"[in] The number of elements in the `rootRefIds`, `rootKinds`, `rootFlags`, and `rootIds` arrays."},{"content":"[in] An array of object IDs, each of which references either a static object or an object on the stack.","pos":[1315,1418]},{"content":"Elements in the <ph id=\"ph1\">`rootKinds`</ph> array provide information to classify corresponding elements in the <ph id=\"ph2\">`rootRefIds`</ph> array.","pos":[1419,1534],"source":" Elements in the `rootKinds` array provide information to classify corresponding elements in the `rootRefIds` array."},{"content":"[in] An array of <bpt id=\"p1\">[</bpt>COR_PRF_GC_ROOT_KIND<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/cor-prf-gc-root-kind-enumeration.md)</ept> values that indicate the type of the garbage collection root.","pos":[1556,1745],"source":"[in] An array of [COR_PRF_GC_ROOT_KIND](../../../../docs/framework/unmanaged-api/profiling/cor-prf-gc-root-kind-enumeration.md) values that indicate the type of the garbage collection root."},{"content":"[in] An array of <bpt id=\"p1\">[</bpt>COR_PRF_GC_ROOT_FLAGS<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/cor-prf-gc-root-flags-enumeration.md)</ept> values that describe the properties of a garbage collection root.","pos":[1767,1962],"source":"[in] An array of [COR_PRF_GC_ROOT_FLAGS](../../../../docs/framework/unmanaged-api/profiling/cor-prf-gc-root-flags-enumeration.md) values that describe the properties of a garbage collection root."},{"content":"[in] An array of UINT_PTR values that point to an integer that contains additional information about the garbage collection root, depending on the value of the <ph id=\"ph1\">`rootKinds`</ph> parameter.","pos":[1982,2164],"source":"[in] An array of UINT_PTR values that point to an integer that contains additional information about the garbage collection root, depending on the value of the `rootKinds` parameter."},{"content":"If the type of the root is a stack, the root ID is for the function that contains the variable.","pos":[2171,2266]},{"content":"If that root ID is 0, the function is an unnamed function that is internal to the CLR.","pos":[2267,2353]},{"content":"If the type of the root is a handle, the root ID is for the garbage collection handle.","pos":[2354,2440]},{"content":"For the other root types, the ID is an opaque value and should be ignored.","pos":[2441,2515]},{"pos":[2524,2531],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`rootRefIds`</ph>, <ph id=\"ph2\">`rootKinds`</ph>, <ph id=\"ph3\">`rootFlags`</ph>, and <ph id=\"ph4\">`rootIds`</ph> arrays are parallel arrays.","pos":[2535,2620],"source":"The `rootRefIds`, `rootKinds`, `rootFlags`, and `rootIds` arrays are parallel arrays."},{"content":"That is, <ph id=\"ph1\">`rootRefIds[i]`</ph>, <ph id=\"ph2\">`rootKinds[i]`</ph>, <ph id=\"ph3\">`rootFlags[i]`</ph>, and <ph id=\"ph4\">`rootIds[i]`</ph> all concern the same root.","pos":[2621,2722],"source":" That is, `rootRefIds[i]`, `rootKinds[i]`, `rootFlags[i]`, and `rootIds[i]` all concern the same root."},{"content":"Both <ph id=\"ph1\">`RootReferences`</ph> and <ph id=\"ph2\">`RootReferences2`</ph> are called to notify the profiler.","pos":[2729,2807],"source":"Both `RootReferences` and `RootReferences2` are called to notify the profiler."},{"content":"Profilers will normally implement one method or the other, but not both, because the information passed in <ph id=\"ph1\">`RootReferences2`</ph> is a superset of that passed in <ph id=\"ph2\">`RootReferences`</ph>.","pos":[2808,2982],"source":" Profilers will normally implement one method or the other, but not both, because the information passed in `RootReferences2` is a superset of that passed in `RootReferences`."},{"pos":[2989,3156],"content":"It is possible for entries in <ph id=\"ph1\">`rootRefIds`</ph> to be zero, which implies that the corresponding root reference is null and does not refer to an object on the managed heap.","source":"It is possible for entries in `rootRefIds` to be zero, which implies that the corresponding root reference is null and does not refer to an object on the managed heap."},{"content":"The object IDs returned by <ph id=\"ph1\">`RootReferences2`</ph> are not valid during the callback itself, because the garbage collection might be in the middle of moving objects from old addresses to new addresses.","pos":[3163,3358],"source":"The object IDs returned by `RootReferences2` are not valid during the callback itself, because the garbage collection might be in the middle of moving objects from old addresses to new addresses."},{"content":"Therefore, profilers should not attempt to inspect objects during a <ph id=\"ph1\">`RootReferences2`</ph> call.","pos":[3359,3450],"source":" Therefore, profilers should not attempt to inspect objects during a `RootReferences2` call."},{"content":"When <bpt id=\"p1\">[</bpt>ICorProfilerCallback2::GarbageCollectionFinished<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-garbagecollectionfinished-method.md)</ept> is called, all objects have been moved to their new locations and can be safely inspected.","pos":[3451,3707],"source":" When [ICorProfilerCallback2::GarbageCollectionFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-garbagecollectionfinished-method.md) is called, all objects have been moved to their new locations and can be safely inspected."},{"pos":[3716,3728],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3732,3836],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3843,3877],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> CorProf.idl, CorProf.h","source":"**Header:** CorProf.idl, CorProf.h"},{"pos":[3884,3909],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> CorGuids.lib","source":"**Library:** CorGuids.lib"},{"pos":[3916,4024],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[4033,4041],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4045,4163],"content":"<bpt id=\"p1\">[</bpt>ICorProfilerCallback Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md)</ept>","source":"[ICorProfilerCallback Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md)"},{"pos":[4166,4286],"content":"<bpt id=\"p1\">[</bpt>ICorProfilerCallback2 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md)</ept>","source":"[ICorProfilerCallback2 Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md)"}]}