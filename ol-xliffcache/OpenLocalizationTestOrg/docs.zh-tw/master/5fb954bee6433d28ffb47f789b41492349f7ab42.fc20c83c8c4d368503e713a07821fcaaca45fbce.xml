{"content":"---\ntitle: \"How to: Join Content from Dissimilar Files (LINQ) (C#)\"\nms.date: 06/27/2018\nms.assetid: aa2d12a6-70a9-492f-a6db-b2b850d46811\n---\n# How to: Join Content from Dissimilar Files (LINQ) (C#)\n\nThis example shows how to join data from two comma-delimited files that share a common value that is used as a matching key. This technique can be useful if you have to combine data from two spreadsheets, or from a spreadsheet and from a file that has another format, into a new file. You can modify the example to work with any kind of structured text.  \n  \n## To create the data files\n  \n1.  Copy the following lines into a file that is named *scores.csv* and save it to your project folder. The file represents spreadsheet data. Column 1 is the student's ID, and columns 2 through 5 are test scores.  \n  \n    ```  \n    111, 97, 92, 81, 60  \n    112, 75, 84, 91, 39  \n    113, 88, 94, 65, 91  \n    114, 97, 89, 85, 82  \n    115, 35, 72, 91, 70  \n    116, 99, 86, 90, 94  \n    117, 93, 92, 80, 87  \n    118, 92, 90, 83, 78  \n    119, 68, 79, 88, 92  \n    120, 99, 82, 81, 79  \n    121, 96, 85, 91, 60  \n    122, 94, 92, 91, 91  \n    ```  \n  \n2.  Copy the following lines into a file that is named *names.csv* and save it to your project folder. The file represents a spreadsheet that contains the student's last name, first name, and student ID.  \n  \n    ```  \n    Omelchenko,Svetlana,111  \n    O'Donnell,Claire,112  \n    Mortensen,Sven,113  \n    Garcia,Cesar,114  \n    Garcia,Debra,115  \n    Fakhouri,Fadi,116  \n    Feng,Hanying,117  \n    Garcia,Hugo,118  \n    Tucker,Lance,119  \n    Adams,Terry,120  \n    Zabokritski,Eugene,121  \n    Tucker,Michael,122  \n    ```  \n  \n## Example  \n\n```csharp\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\n\nclass JoinStrings  \n{  \n    static void Main()  \n    {  \n        // Join content from dissimilar files that contain  \n        // related information. File names.csv contains the student  \n        // name plus an ID number. File scores.csv contains the ID   \n        // and a set of four test scores. The following query joins  \n        // the scores to the student names by using ID as a  \n        // matching key.  \n  \n        string[] names = System.IO.File.ReadAllLines(@\"../../../names.csv\");  \n        string[] scores = System.IO.File.ReadAllLines(@\"../../../scores.csv\");  \n  \n        // Name:    Last[0],       First[1],  ID[2]  \n        //          Omelchenko,    Svetlana,  11  \n        // Score:   StudentID[0],  Exam1[1]   Exam2[2],  Exam3[3],  Exam4[4]  \n        //          111,           97,        92,        81,        60  \n  \n        // This query joins two dissimilar spreadsheets based on common ID value.  \n        // Multiple from clauses are used instead of a join clause  \n        // in order to store results of id.Split.  \n        IEnumerable<string> scoreQuery1 =  \n            from name in names  \n            let nameFields = name.Split(',')  \n            from id in scores  \n            let scoreFields = id.Split(',')  \n            where Convert.ToInt32(nameFields[2]) == Convert.ToInt32(scoreFields[0])\n            select nameFields[0] + \",\" + scoreFields[1] + \",\" + scoreFields[2]   \n                   + \",\" + scoreFields[3] + \",\" + scoreFields[4];  \n  \n        // Pass a query variable to a method and execute it  \n        // in the method. The query itself is unchanged.  \n        OutputQueryResults(scoreQuery1, \"Merge two spreadsheets:\");  \n  \n        // Keep console window open in debug mode.  \n        Console.WriteLine(\"Press any key to exit\");  \n        Console.ReadKey();  \n    }  \n  \n    static void OutputQueryResults(IEnumerable<string> query, string message)  \n    {  \n        Console.WriteLine(System.Environment.NewLine + message);  \n        foreach (string item in query)  \n        {  \n            Console.WriteLine(item);  \n        }  \n        Console.WriteLine(\"{0} total names in list\", query.Count());  \n    }  \n}  \n/* Output:  \nMerge two spreadsheets:\nOmelchenko, 97, 92, 81, 60\nO'Donnell, 75, 84, 91, 39\nMortensen, 88, 94, 65, 91\nGarcia, 97, 89, 85, 82\nGarcia, 35, 72, 91, 70\nFakhouri, 99, 86, 90, 94\nFeng, 93, 92, 80, 87\nGarcia, 92, 90, 83, 78\nTucker, 68, 79, 88, 92\nAdams, 99, 82, 81, 79\nZabokritski, 96, 85, 91, 60\nTucker, 94, 92, 91, 91\n12 total names in list\n */  \n```\n\n## Compiling the code\n\nCreate and compile a project that targets one of the following options:\n\n- .NET Framework version 3.5 with a reference to System.Core.dll.\n- .NET Framework version 4.0 or higher.\n- .NET Core version 1.0 or higher.\n  \n## See also\n\n- [LINQ and Strings (C#)](../../../../csharp/programming-guide/concepts/linq/linq-and-strings.md)\n- [LINQ and File Directories (C#)](../../../../csharp/programming-guide/concepts/linq/linq-and-file-directories.md)\n","nodes":[{"pos":[4,136],"embed":true,"restype":"x-metadata","content":"title: \"How to: Join Content from Dissimilar Files (LINQ) (C#)\"\nms.date: 06/27/2018\nms.assetid: aa2d12a6-70a9-492f-a6db-b2b850d46811","nodes":[{"content":"How to: Join Content from Dissimilar Files (LINQ) (C#)","nodes":[{"pos":[0,54],"content":"How to: Join Content from Dissimilar Files (LINQ) (C#)","nodes":[{"content":"How to: Join Content from Dissimilar Files (LINQ) (C#)","pos":[0,54]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[143,197],"content":"How to: Join Content from Dissimilar Files (LINQ) (C#)","linkify":"How to: Join Content from Dissimilar Files (LINQ) (C#)","nodes":[{"content":"How to: Join Content from Dissimilar Files (LINQ) (C#)","pos":[0,54]}]},{"content":"This example shows how to join data from two comma-delimited files that share a common value that is used as a matching key.","pos":[199,323]},{"content":"This technique can be useful if you have to combine data from two spreadsheets, or from a spreadsheet and from a file that has another format, into a new file.","pos":[324,483]},{"content":"You can modify the example to work with any kind of structured text.","pos":[484,552]},{"pos":[561,585],"content":"To create the data files","linkify":"To create the data files","nodes":[{"content":"To create the data files","pos":[0,24]}]},{"content":"Copy the following lines into a file that is named <bpt id=\"p1\">*</bpt>scores.csv<ept id=\"p1\">*</ept> and save it to your project folder.","pos":[593,692],"source":"Copy the following lines into a file that is named *scores.csv* and save it to your project folder."},{"content":"The file represents spreadsheet data.","pos":[693,730]},{"content":"Column 1 is the student's ID, and columns 2 through 5 are test scores.","pos":[731,801]},{"content":"Copy the following lines into a file that is named <bpt id=\"p1\">*</bpt>names.csv<ept id=\"p1\">*</ept> and save it to your project folder.","pos":[1146,1244],"source":"Copy the following lines into a file that is named *names.csv* and save it to your project folder."},{"content":"The file represents a spreadsheet that contains the student's last name, first name, and student ID.","pos":[1245,1345]},{"pos":[1673,1680],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4296,4314],"content":"Compiling the code","linkify":"Compiling the code","nodes":[{"content":"Compiling the code","pos":[0,18]}]},{"content":"Create and compile a project that targets one of the following options:","pos":[4316,4387]},{"content":".NET Framework version 3.5 with a reference to System.Core.dll.","pos":[4391,4454]},{"content":".NET Framework version 4.0 or higher.","pos":[4457,4494]},{"content":".NET Core version 1.0 or higher.","pos":[4497,4529]},{"pos":[4536,4544],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4548,4643],"content":"<bpt id=\"p1\">[</bpt>LINQ and Strings (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/linq-and-strings.md)</ept>","source":"[LINQ and Strings (C#)](../../../../csharp/programming-guide/concepts/linq/linq-and-strings.md)"},{"pos":[4646,4759],"content":"<bpt id=\"p1\">[</bpt>LINQ and File Directories (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/linq-and-file-directories.md)</ept>","source":"[LINQ and File Directories (C#)](../../../../csharp/programming-guide/concepts/linq/linq-and-file-directories.md)"}]}