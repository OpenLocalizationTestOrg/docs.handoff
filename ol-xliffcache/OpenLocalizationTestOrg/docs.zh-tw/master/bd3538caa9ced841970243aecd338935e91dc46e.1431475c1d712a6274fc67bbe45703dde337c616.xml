{"content":"---\ntitle: \"Binding a custom activity property to a designer control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 2e8061ea-10f5-407c-a31f-d0d74ce12f27\ncaps.latest.revision: 5\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Binding a custom activity property to a designer control\nBinding a text box designer control to an activity argument is fairly straightforward; binding a complex designer control (such as a combo box) to an activity argument may present challenges, however. This topic discusses how to bind an activity argument to a combo box control on a custom activity designer.  \n  \n#### Creating the combo box item converter  \n  \n1.  Create a new empty solution in Visual Studio called CustomProperty.  \n  \n2.  Create a new class called ComboBoxItemConverter. Add a reference to System.Windows.Data, and have the class derive from <xref:System.Windows.Data.IValueConverter>. Have Visual Studio implement the interface to generate stubs for `Convert` and `ConvertBack`.  \n  \n3.  Add the following code to the `Convert` method. This code converts the activity's <xref:System.Activities.InArgument%601> of type <xref:System.String> to the value to be placed in the designer.  \n  \n    ```  \n    ModelItem modelItem = value as ModelItem;  \n    if (value != null)  \n    {  \n        InArgument<string> inArgument = modelItem.GetCurrentValue() as InArgument<string>;  \n  \n        if (inArgument != null)  \n        {  \n            Activity<string> expression = inArgument.Expression;  \n            VisualBasicValue<string> vbexpression = expression as VisualBasicValue<string>;  \n            Literal<string> literal = expression as Literal<string>;  \n  \n            if (literal != null)  \n            {  \n                return \"\\\"\" + literal.Value + \"\\\"\";  \n            }  \n            else if (vbexpression != null)  \n            {  \n                return vbexpression.ExpressionText;  \n            }  \n        }  \n    }  \n    return null;  \n  \n    ```  \n  \n     The expression in the above code snippet can also be created using <xref:Microsoft.CSharp.Activities.CSharpValue%601> instead of <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601>.  \n  \n    ```  \n    ModelItem modelItem = value as ModelItem;  \n    if (value != null)  \n    {  \n        InArgument<string> inArgument = modelItem.GetCurrentValue() as InArgument<string>;  \n  \n        if (inArgument != null)  \n        {  \n            Activity<string> expression = inArgument.Expression;  \n            CSharpValue<string> csexpression = expression as CSharpValue<string>;  \n            Literal<string> literal = expression as Literal<string>;  \n  \n            if (literal != null)  \n            {  \n                return \"\\\"\" + literal.Value + \"\\\"\";  \n            }  \n            else if (csexpression != null)  \n            {  \n                return csexpression.ExpressionText;  \n            }  \n        }  \n    }  \n    return null;  \n  \n    ```  \n  \n4.  Add the following code to the `ConvertBack` method. This code converts the incoming combo box item back to an <xref:System.Activities.InArgument%601>.  \n  \n    ```  \n    // Convert combo box value to InArgument<string>  \n                string itemContent = (string)((ComboBoxItem)value).Content;  \n                VisualBasicValue<string> vbArgument = new VisualBasicValue<string>(itemContent);  \n                InArgument<string> inArgument = new InArgument<string>(vbArgument);  \n                return inArgument;  \n  \n    ```  \n  \n     The expression in the above code snippet can also be created using <xref:Microsoft.CSharp.Activities.CSharpValue%601> instead of <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601>.  \n  \n    ```  \n    // Convert combo box value to InArgument<string>  \n                string itemContent = (string)((ComboBoxItem)value).Content;  \n                CSharpValue<string> csArgument = new CSharpValue<string>(itemContent);  \n                InArgument<string> inArgument = new InArgument<string>(csArgument);  \n                return inArgument;  \n  \n    ```  \n  \n#### Adding the ComboBoxItemConverter to the custom designer of an activity  \n  \n1.  Add a new item to the project. In the New Item dialog, select the Workflow node and select Activity Designer as the type of the new item. Name the item CustomPropertyDesigner.  \n  \n2.  Add a Combo Box to the new designer. In the Items property, add a couple of items to the combo box, with Content values of \"Item1\" and 'Item2\".  \n  \n3.  Modify the XAML of the combo box to add the new item converter as the item converter to be used for the combo box. The converter is added as a resource in the ActivityDesigner.Resources segment, and specifies the converter in the Converter attribute for the <xref:System.Windows.Controls.ComboBox>. Note that the namespace of the project is specified in the namespaces attributes for the activity designer; if the designer is to be used in a different project, this namespace will need to be changed.  \n  \n    ```  \n    <sap:ActivityDesigner x:Class=\"CustomProperty.CustomPropertyDesigner\"  \n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"  \n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"  \n        xmlns:c=\"clr-namespace:CustomProperty\"  \n        xmlns:sap=\"clr-namespace:System.Activities.Presentation;assembly=System.Activities.Presentation\"  \n        xmlns:sapv=\"clr-namespace:System.Activities.Presentation.View;assembly=System.Activities.Presentation\">  \n  \n        <sap:ActivityDesigner.Resources>  \n            <ResourceDictionary>  \n                <c:ComboBoxItemConverter x:Key=\"comboBoxItemConverter\"/>  \n            </ResourceDictionary>  \n        </sap:ActivityDesigner.Resources>  \n        <Grid>  \n            <ComboBox SelectedValue=\"{Binding Path=ModelItem.Text, Mode=TwoWay, Converter={StaticResource comboBoxItemConverter}}\"  Height=\"23\" HorizontalAlignment=\"Left\" Margin=\"132,5,0,0\" Name=\"comboBox1\" VerticalAlignment=\"Top\" Width=\"120\" ItemsSource=\"{Binding}\">  \n                <ComboBoxItem>item1</ComboBoxItem>  \n                <ComboBoxItem>item2</ComboBoxItem>  \n            </ComboBox>  \n        </Grid>  \n    </sap:ActivityDesigner>  \n  \n    ```  \n  \n4.  Create a new item of type <xref:System.Activities.CodeActivity>. The default code created by the IDE for the activity will be sufficient for this example.  \n  \n5.  Add the following attribute to the class definition:  \n  \n    ```  \n    [Designer(typeof(CustomPropertyDesigner))]  \n  \n    ```  \n  \n     This line associates the new designer with the new class.  \n  \n The new activity should now be associated with the designer. To test the new activity, add it to a workflow, and set the combo box to the two values. The properties window should update to reflect the combo box value.","nodes":[{"pos":[12,85],"content":"Binding a custom activity property to a designer control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Binding a custom activity property to a designer control | Microsoft Docs","pos":[0,73]}]},{"pos":[350,406],"content":"Binding a custom activity property to a designer control","linkify":"Binding a custom activity property to a designer control","nodes":[{"content":"Binding a custom activity property to a designer control","pos":[0,56]}]},{"content":"Binding a text box designer control to an activity argument is fairly straightforward; binding a complex designer control (such as a combo box) to an activity argument may present challenges, however.","pos":[407,607]},{"content":"This topic discusses how to bind an activity argument to a combo box control on a custom activity designer.","pos":[608,715]},{"pos":[726,763],"content":"Creating the combo box item converter","linkify":"Creating the combo box item converter","nodes":[{"content":"Creating the combo box item converter","pos":[0,37]}]},{"content":"Create a new empty solution in Visual Studio called CustomProperty.","pos":[773,840]},{"content":"Create a new class called ComboBoxItemConverter.","pos":[850,898]},{"content":"Add a reference to System.Windows.Data, and have the class derive from <ph id=\"ph1\">&lt;xref:System.Windows.Data.IValueConverter&gt;</ph>.","pos":[899,1013],"source":" Add a reference to System.Windows.Data, and have the class derive from <xref:System.Windows.Data.IValueConverter>."},{"content":"Have Visual Studio implement the interface to generate stubs for <ph id=\"ph1\">`Convert`</ph> and <ph id=\"ph2\">`ConvertBack`</ph>.","pos":[1014,1107],"source":" Have Visual Studio implement the interface to generate stubs for `Convert` and `ConvertBack`."},{"content":"Add the following code to the <ph id=\"ph1\">`Convert`</ph> method.","pos":[1117,1164],"source":"Add the following code to the `Convert` method."},{"content":"This code converts the activity's <ph id=\"ph1\">&lt;xref:System.Activities.InArgument%601&gt;</ph> of type <ph id=\"ph2\">&lt;xref:System.String&gt;</ph> to the value to be placed in the designer.","pos":[1165,1310],"source":" This code converts the activity's <xref:System.Activities.InArgument%601> of type <xref:System.String> to the value to be placed in the designer."},{"content":"The expression in the above code snippet can also be created using <ph id=\"ph1\">&lt;xref:Microsoft.CSharp.Activities.CSharpValue%601&gt;</ph> instead of <ph id=\"ph2\">&lt;xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601&gt;</ph>.","pos":[2096,2286],"source":"The expression in the above code snippet can also be created using <xref:Microsoft.CSharp.Activities.CSharpValue%601> instead of <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601>."},{"content":"Add the following code to the <ph id=\"ph1\">`ConvertBack`</ph> method.","pos":[3061,3112],"source":"Add the following code to the `ConvertBack` method."},{"content":"This code converts the incoming combo box item back to an <ph id=\"ph1\">&lt;xref:System.Activities.InArgument%601&gt;</ph>.","pos":[3113,3211],"source":" This code converts the incoming combo box item back to an <xref:System.Activities.InArgument%601>."},{"content":"The expression in the above code snippet can also be created using <ph id=\"ph1\">&lt;xref:Microsoft.CSharp.Activities.CSharpValue%601&gt;</ph> instead of <ph id=\"ph2\">&lt;xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601&gt;</ph>.","pos":[3603,3793],"source":"The expression in the above code snippet can also be created using <xref:Microsoft.CSharp.Activities.CSharpValue%601> instead of <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601>."},{"pos":[4175,4245],"content":"Adding the ComboBoxItemConverter to the custom designer of an activity","linkify":"Adding the ComboBoxItemConverter to the custom designer of an activity","nodes":[{"content":"Adding the ComboBoxItemConverter to the custom designer of an activity","pos":[0,70]}]},{"content":"Add a new item to the project.","pos":[4255,4285]},{"content":"In the New Item dialog, select the Workflow node and select Activity Designer as the type of the new item.","pos":[4286,4392]},{"content":"Name the item CustomPropertyDesigner.","pos":[4393,4430]},{"content":"Add a Combo Box to the new designer.","pos":[4440,4476]},{"content":"In the Items property, add a couple of items to the combo box, with Content values of \"Item1\" and 'Item2\".","pos":[4477,4583]},{"content":"Modify the XAML of the combo box to add the new item converter as the item converter to be used for the combo box.","pos":[4593,4707]},{"content":"The converter is added as a resource in the ActivityDesigner.Resources segment, and specifies the converter in the Converter attribute for the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ComboBox&gt;</ph>.","pos":[4708,4891],"source":" The converter is added as a resource in the ActivityDesigner.Resources segment, and specifies the converter in the Converter attribute for the <xref:System.Windows.Controls.ComboBox>."},{"content":"Note that the namespace of the project is specified in the namespaces attributes for the activity designer; if the designer is to be used in a different project, this namespace will need to be changed.","pos":[4892,5093]},{"content":"Create a new item of type <ph id=\"ph1\">&lt;xref:System.Activities.CodeActivity&gt;</ph>.","pos":[6319,6383],"source":"Create a new item of type <xref:System.Activities.CodeActivity>."},{"content":"The default code created by the IDE for the activity will be sufficient for this example.","pos":[6384,6473]},{"content":"Add the following attribute to the class definition:","pos":[6483,6535]},{"content":"This line associates the new designer with the new class.","pos":[6621,6678]},{"content":"The new activity should now be associated with the designer.","pos":[6685,6745]},{"content":"To test the new activity, add it to a workflow, and set the combo box to the two values.","pos":[6746,6834]},{"content":"The properties window should update to reflect the combo box value.","pos":[6835,6902]}]}