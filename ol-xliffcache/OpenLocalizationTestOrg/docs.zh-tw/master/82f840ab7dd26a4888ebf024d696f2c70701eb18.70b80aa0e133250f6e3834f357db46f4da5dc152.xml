{"content":"---\ntitle: \"The Load Method\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"vb\"\nms.assetid: e22e5812-89c6-41f0-9302-bb899a46dbff\n---\n# The Load Method\nYou can use the <xref:System.Data.DataTable.Load%2A> method to load a <xref:System.Data.DataTable> with rows from a data source. This is an overloaded method which, in its simplest form, accepts a single parameter, a **DataReader**. In this form, it simply loads the **DataTable** with rows. Optionally, you can specify the **LoadOption** parameter to control how data is added to the **DataTable**.  \n  \n The **LoadOption** parameter is particularly useful in cases where the **DataTable** already contains rows of data, because it describes how incoming data from the data source will be combined with the data already in the table. For example, **PreserveCurrentValues** (the default) specifies that in cases where a row is marked as **Added** in the **DataTable**, the **Original** value or each column is set to the contents of the matching row from the data source. The **Current** value will retain the values assigned when the row was added, and the **RowState** of the row will be set to **Changed**.  \n  \n The following table gives a short description of the <xref:System.Data.LoadOption> enumeration values.  \n  \n|LoadOption value|Description|  \n|----------------------|-----------------|  \n|**OverwriteRow**|If incoming rows have the same **PrimaryKey** value as a row already in the **DataTable**, the **Original** and **Current** values of each column are replaced with the values in the incoming row, and the **RowState** property is set to **Unchanged**.<br /><br /> Rows from the data source that do not already exist in the **DataTable** are added with a **RowState** value of **Unchanged**.<br /><br /> This option in effect refreshes the contents of the **DataTable** so that it matches the contents of the data source.|  \n|**PreserveCurrentValues (default)**|If incoming rows have the same **PrimaryKey** value as a row already in the **DataTable**, the **Original** value is set to the contents of the incoming row, and the **Current** value is not changed.<br /><br /> If the **RowState** is **Added** or **Modified**, it is set to **Modified**.<br /><br /> If the **RowState** was **Deleted**, it remains **Deleted**.<br /><br /> Rows from the data source that do not already exist in the **DataTable** are added, and the **RowState** is set to **Unchanged**.|  \n|**UpdateCurrentValues**|If incoming rows have the same **PrimaryKey** value as the row already in the **DataTable**, the **Current** value is copied to the **Original** value, and the **Current** value is then set to the contents of the incoming row.<br /><br /> If the **RowState** in the **DataTable** was **Added**, the **RowState** remains **Added**. For rows marked as **Modified** or **Deleted**, the **RowState** is **Modified**.<br /><br /> Rows from the data source that do not already exist in the **DataTable** are added, and the **RowState** is set to **Added**.|  \n  \n The following sample uses the **Load** method to display a list of birthdays for the employees in the **Northwind** database.  \n  \n```vb  \nPrivate Sub LoadBirthdays(ByVal connectionString As String)  \n    ' Assumes that connectionString is a valid connection string  \n    ' to the Northwind database on SQL Server.  \n    Dim queryString As String = _  \n    \"SELECT LastName, FirstName, BirthDate \" & _  \n      \" FROM dbo.Employees \" & _  \n      \"ORDER BY BirthDate, LastName, FirstName\"  \n  \n    ' Open and fill a DataSet.   \n    Dim adapter As SqlDataAdapter = New SqlDataAdapter( _  \n        queryString, connectionString)  \n    Dim employees As New DataSet  \n    adapter.Fill(employees, \"Employees\")  \n  \n    ' Create a SqlDataReader for use with the Load Method.  \n    Dim reader As DataTableReader = employees.GetDataReader()  \n  \n    ' Create an instance of DataTable and assign the first  \n    ' DataTable in the DataSet.Tables collection to it.  \n    Dim dataTableEmp As DataTable = employees.Tables(0)  \n  \n    ' Fill the DataTable with data by calling Load and  \n    ' passing the SqlDataReader.  \n    dataTableEmp.Load(reader, LoadOption.OverwriteRow)  \n  \n    ' Loop through the rows collection and display the values  \n    ' in the console window.  \n    Dim employeeRow As DataRow  \n    For Each employeeRow In dataTableEmp.Rows  \n        Console.WriteLine(\"{0:MM\\\\dd\\\\yyyy}\" & ControlChars.Tab & _  \n          \"{1}, {2}\", _  \n          employeeRow(\"BirthDate\"), _  \n          employeeRow(\"LastName\"), _  \n          employeeRow(\"FirstName\"))  \n    Next employeeRow  \n  \n    ' Keep the window opened to view the contents.  \n    Console.ReadLine()  \nEnd Sub  \n```  \n  \n## See also\n\n- [Manipulating Data in a DataTable](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/manipulating-data-in-a-datatable.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,120],"embed":true,"restype":"x-metadata","content":"title: \"The Load Method\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"vb\"\nms.assetid: e22e5812-89c6-41f0-9302-bb899a46dbff","nodes":[{"content":"The Load Method","nodes":[{"pos":[0,15],"content":"The Load Method","nodes":[{"content":"The Load Method","pos":[0,15]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[127,142],"content":"The Load Method","linkify":"The Load Method","nodes":[{"content":"The Load Method","pos":[0,15]}]},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Data.DataTable.Load%2A&gt;</ph> method to load a <ph id=\"ph2\">&lt;xref:System.Data.DataTable&gt;</ph> with rows from a data source.","pos":[143,271],"source":"You can use the <xref:System.Data.DataTable.Load%2A> method to load a <xref:System.Data.DataTable> with rows from a data source."},{"content":"This is an overloaded method which, in its simplest form, accepts a single parameter, a <bpt id=\"p1\">**</bpt>DataReader<ept id=\"p1\">**</ept>.","pos":[272,375],"source":" This is an overloaded method which, in its simplest form, accepts a single parameter, a **DataReader**."},{"content":"In this form, it simply loads the <bpt id=\"p1\">**</bpt>DataTable<ept id=\"p1\">**</ept> with rows.","pos":[376,434],"source":" In this form, it simply loads the **DataTable** with rows."},{"content":"Optionally, you can specify the <bpt id=\"p1\">**</bpt>LoadOption<ept id=\"p1\">**</ept> parameter to control how data is added to the <bpt id=\"p2\">**</bpt>DataTable<ept id=\"p2\">**</ept>.","pos":[435,542],"source":" Optionally, you can specify the **LoadOption** parameter to control how data is added to the **DataTable**."},{"content":"The <bpt id=\"p1\">**</bpt>LoadOption<ept id=\"p1\">**</ept> parameter is particularly useful in cases where the <bpt id=\"p2\">**</bpt>DataTable<ept id=\"p2\">**</ept> already contains rows of data, because it describes how incoming data from the data source will be combined with the data already in the table.","pos":[549,777],"source":"The **LoadOption** parameter is particularly useful in cases where the **DataTable** already contains rows of data, because it describes how incoming data from the data source will be combined with the data already in the table."},{"content":"For example, <bpt id=\"p1\">**</bpt>PreserveCurrentValues<ept id=\"p1\">**</ept> (the default) specifies that in cases where a row is marked as <bpt id=\"p2\">**</bpt>Added<ept id=\"p2\">**</ept> in the <bpt id=\"p3\">**</bpt>DataTable<ept id=\"p3\">**</ept>, the <bpt id=\"p4\">**</bpt>Original<ept id=\"p4\">**</ept> value or each column is set to the contents of the matching row from the data source.","pos":[778,1014],"source":" For example, **PreserveCurrentValues** (the default) specifies that in cases where a row is marked as **Added** in the **DataTable**, the **Original** value or each column is set to the contents of the matching row from the data source."},{"content":"The <bpt id=\"p1\">**</bpt>Current<ept id=\"p1\">**</ept> value will retain the values assigned when the row was added, and the <bpt id=\"p2\">**</bpt>RowState<ept id=\"p2\">**</ept> of the row will be set to <bpt id=\"p3\">**</bpt>Changed<ept id=\"p3\">**</ept>.","pos":[1015,1152],"source":" The **Current** value will retain the values assigned when the row was added, and the **RowState** of the row will be set to **Changed**."},{"pos":[1159,1261],"content":"The following table gives a short description of the <ph id=\"ph1\">&lt;xref:System.Data.LoadOption&gt;</ph> enumeration values.","source":"The following table gives a short description of the <xref:System.Data.LoadOption> enumeration values."},{"content":"LoadOption value","pos":[1268,1284]},{"content":"Description","pos":[1285,1296]},{"pos":[1346,1362],"content":"<bpt id=\"p1\">**</bpt>OverwriteRow<ept id=\"p1\">**</ept>","source":"**OverwriteRow**"},{"content":"If incoming rows have the same <bpt id=\"p1\">**</bpt>PrimaryKey<ept id=\"p1\">**</ept> value as a row already in the <bpt id=\"p2\">**</bpt>DataTable<ept id=\"p2\">**</ept>, the <bpt id=\"p3\">**</bpt>Original<ept id=\"p3\">**</ept> and <bpt id=\"p4\">**</bpt>Current<ept id=\"p4\">**</ept> values of each column are replaced with the values in the incoming row, and the <bpt id=\"p5\">**</bpt>RowState<ept id=\"p5\">**</ept> property is set to <bpt id=\"p6\">**</bpt>Unchanged<ept id=\"p6\">**</ept>.","pos":[1363,1613],"source":"If incoming rows have the same **PrimaryKey** value as a row already in the **DataTable**, the **Original** and **Current** values of each column are replaced with the values in the incoming row, and the **RowState** property is set to **Unchanged**."},{"content":"Rows from the data source that do not already exist in the <bpt id=\"p1\">**</bpt>DataTable<ept id=\"p1\">**</ept> are added with a <bpt id=\"p2\">**</bpt>RowState<ept id=\"p2\">**</ept> value of <bpt id=\"p3\">**</bpt>Unchanged<ept id=\"p3\">**</ept>.","pos":[1626,1752],"source":"Rows from the data source that do not already exist in the **DataTable** are added with a **RowState** value of **Unchanged**."},{"content":"This option in effect refreshes the contents of the <bpt id=\"p1\">**</bpt>DataTable<ept id=\"p1\">**</ept> so that it matches the contents of the data source.","pos":[1765,1882],"source":"This option in effect refreshes the contents of the **DataTable** so that it matches the contents of the data source."},{"pos":[1887,1922],"content":"<bpt id=\"p1\">**</bpt>PreserveCurrentValues (default)<ept id=\"p1\">**</ept>","source":"**PreserveCurrentValues (default)**"},{"content":"If incoming rows have the same <bpt id=\"p1\">**</bpt>PrimaryKey<ept id=\"p1\">**</ept> value as a row already in the <bpt id=\"p2\">**</bpt>DataTable<ept id=\"p2\">**</ept>, the <bpt id=\"p3\">**</bpt>Original<ept id=\"p3\">**</ept> value is set to the contents of the incoming row, and the <bpt id=\"p4\">**</bpt>Current<ept id=\"p4\">**</ept> value is not changed.","pos":[1923,2122],"source":"If incoming rows have the same **PrimaryKey** value as a row already in the **DataTable**, the **Original** value is set to the contents of the incoming row, and the **Current** value is not changed."},{"content":"If the <bpt id=\"p1\">**</bpt>RowState<ept id=\"p1\">**</ept> is <bpt id=\"p2\">**</bpt>Added<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>Modified<ept id=\"p3\">**</ept>, it is set to <bpt id=\"p4\">**</bpt>Modified<ept id=\"p4\">**</ept>.","pos":[2135,2211],"source":"If the **RowState** is **Added** or **Modified**, it is set to **Modified**."},{"content":"If the <bpt id=\"p1\">**</bpt>RowState<ept id=\"p1\">**</ept> was <bpt id=\"p2\">**</bpt>Deleted<ept id=\"p2\">**</ept>, it remains <bpt id=\"p3\">**</bpt>Deleted<ept id=\"p3\">**</ept>.","pos":[2224,2284],"source":"If the **RowState** was **Deleted**, it remains **Deleted**."},{"content":"Rows from the data source that do not already exist in the <bpt id=\"p1\">**</bpt>DataTable<ept id=\"p1\">**</ept> are added, and the <bpt id=\"p2\">**</bpt>RowState<ept id=\"p2\">**</ept> is set to <bpt id=\"p3\">**</bpt>Unchanged<ept id=\"p3\">**</ept>.","pos":[2297,2426],"source":"Rows from the data source that do not already exist in the **DataTable** are added, and the **RowState** is set to **Unchanged**."},{"pos":[2431,2454],"content":"<bpt id=\"p1\">**</bpt>UpdateCurrentValues<ept id=\"p1\">**</ept>","source":"**UpdateCurrentValues**"},{"content":"If incoming rows have the same <bpt id=\"p1\">**</bpt>PrimaryKey<ept id=\"p1\">**</ept> value as the row already in the <bpt id=\"p2\">**</bpt>DataTable<ept id=\"p2\">**</ept>, the <bpt id=\"p3\">**</bpt>Current<ept id=\"p3\">**</ept> value is copied to the <bpt id=\"p4\">**</bpt>Original<ept id=\"p4\">**</ept> value, and the <bpt id=\"p5\">**</bpt>Current<ept id=\"p5\">**</ept> value is then set to the contents of the incoming row.","pos":[2455,2681],"source":"If incoming rows have the same **PrimaryKey** value as the row already in the **DataTable**, the **Current** value is copied to the **Original** value, and the **Current** value is then set to the contents of the incoming row."},{"content":"If the <bpt id=\"p1\">**</bpt>RowState<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>DataTable<ept id=\"p2\">**</ept> was <bpt id=\"p3\">**</bpt>Added<ept id=\"p3\">**</ept>, the <bpt id=\"p4\">**</bpt>RowState<ept id=\"p4\">**</ept> remains <bpt id=\"p5\">**</bpt>Added<ept id=\"p5\">**</ept>.","pos":[2694,2785],"source":"If the **RowState** in the **DataTable** was **Added**, the **RowState** remains **Added**."},{"content":"For rows marked as <bpt id=\"p1\">**</bpt>Modified<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Deleted<ept id=\"p2\">**</ept>, the <bpt id=\"p3\">**</bpt>RowState<ept id=\"p3\">**</ept> is <bpt id=\"p4\">**</bpt>Modified<ept id=\"p4\">**</ept>.","pos":[2786,2867],"source":" For rows marked as **Modified** or **Deleted**, the **RowState** is **Modified**."},{"content":"Rows from the data source that do not already exist in the <bpt id=\"p1\">**</bpt>DataTable<ept id=\"p1\">**</ept> are added, and the <bpt id=\"p2\">**</bpt>RowState<ept id=\"p2\">**</ept> is set to <bpt id=\"p3\">**</bpt>Added<ept id=\"p3\">**</ept>.","pos":[2880,3005],"source":"Rows from the data source that do not already exist in the **DataTable** are added, and the **RowState** is set to **Added**."},{"pos":[3013,3138],"content":"The following sample uses the <bpt id=\"p1\">**</bpt>Load<ept id=\"p1\">**</ept> method to display a list of birthdays for the employees in the <bpt id=\"p2\">**</bpt>Northwind<ept id=\"p2\">**</ept> database.","source":"The following sample uses the **Load** method to display a list of birthdays for the employees in the **Northwind** database."},{"pos":[4696,4704],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4708,4848],"content":"<bpt id=\"p1\">[</bpt>Manipulating Data in a DataTable<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/manipulating-data-in-a-datatable.md)</ept>","source":"[Manipulating Data in a DataTable](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/manipulating-data-in-a-datatable.md)"},{"pos":[4851,4955],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}