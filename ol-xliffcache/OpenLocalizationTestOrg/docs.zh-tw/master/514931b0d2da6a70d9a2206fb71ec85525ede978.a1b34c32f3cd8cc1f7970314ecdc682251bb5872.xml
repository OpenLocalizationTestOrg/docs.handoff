{"content":"---\ntitle: \"How to: Ensure the Selected Row in a Child Table Remains at the Correct Position\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"master-details view\"\n  - \"row position [Windows Forms]\"\n  - \"parent/child view [Windows Forms]\"\n  - \"resetting child position\"\n  - \"data binding [.NET Framework], row selection\"\n  - \"caching [.NET Framework], child position\"\n  - \"child position\"\n  - \"master/details view [Windows Forms]\"\n  - \"child tables row selection\"\n  - \"current child position\"\nms.assetid: c5fa2562-43a4-46fa-a604-52d8526a87bd\n---\n# How to: Ensure the Selected Row in a Child Table Remains at the Correct Position\nOftentimes when you work with data binding in Windows Forms, you will display data in what is called a parent/child or master/details view. This refers to a data-binding scenario where data from the same source is displayed in two controls. Changing the selection in one control causes the data displayed in the second control to change. For example, the first control might contain a list of customers and the second a list of orders related to the selected customer in the first control.  \n  \n Starting with the .NET Framework version 2.0, when you display data in a parent/child view you might have to take extra steps to make sure that the currently selected row in the child table is not reset to the first row of the table. In order to do this, you will have to cache the child table position and reset it after the parent table changes. Typically the child reset occurs the first time a field in a row of the parent table changes.  \n  \n### To Cache the Current Child Position  \n  \n1.  Declare an integer variable to store the child list position and a Boolean variable to store whether to cache the child position.  \n  \n     [!code-csharp[System.Windows.Forms.CurrencyManagerReset#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/CS/Form1.cs#4)]\n     [!code-vb[System.Windows.Forms.CurrencyManagerReset#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/VB/Form1.vb#4)]  \n  \n2.  Handle the <xref:System.Windows.Forms.CurrencyManager.ListChanged> event for the binding's <xref:System.Windows.Forms.CurrencyManager> and check for a <xref:System.ComponentModel.ListChangedType> of <xref:System.ComponentModel.ListChangedType.Reset>.  \n  \n3.  Check the current position of the <xref:System.Windows.Forms.CurrencyManager>. If it is greater than first entry in the list (typically 0), save it to a variable.  \n  \n     [!code-csharp[System.Windows.Forms.CurrencyManagerReset#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/CS/Form1.cs#2)]\n     [!code-vb[System.Windows.Forms.CurrencyManagerReset#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/VB/Form1.vb#2)]  \n  \n4.  Handle the parent list's <xref:System.Windows.Forms.BindingManagerBase.CurrentChanged> event for the parent currency manager. In the handler, set the Boolean value to indicate it is not a caching scenario. If the <xref:System.Windows.Forms.BindingManagerBase.CurrentChanged> occurs, the change to the parent is a list position change and not an item value change.  \n  \n     [!code-csharp[System.Windows.Forms.CurrencyManagerReset#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/CS/Form1.cs#5)]\n     [!code-vb[System.Windows.Forms.CurrencyManagerReset#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/VB/Form1.vb#5)]  \n  \n### To Reset the Child Position  \n  \n1.  Handle the <xref:System.Windows.Forms.BindingManagerBase.PositionChanged> event for the child binding's <xref:System.Windows.Forms.CurrencyManager>.  \n  \n2.  Reset the child table position to the cached position saved in the previous procedure.  \n  \n     [!code-csharp[System.Windows.Forms.CurrencyManagerReset#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/CS/Form1.cs#3)]\n     [!code-vb[System.Windows.Forms.CurrencyManagerReset#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/VB/Form1.vb#3)]  \n  \n## Example  \n The following example demonstrates how to save the current position on the <xref:System.Windows.Forms.CurrencyManager>.for a child table and reset the position after an edit is completed on the parent table. This example contains two <xref:System.Windows.Forms.DataGridView> controls bound to two tables in a <xref:System.Data.DataSet> using a <xref:System.Windows.Forms.BindingSource> component. A relation is established between the two tables and the relation is added to the <xref:System.Data.DataSet>. The position in the child table is initially set to the third row for demonstration purposes.  \n  \n [!code-csharp[System.Windows.Forms.CurrencyManagerReset#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/CS/Form1.cs#1)]\n [!code-vb[System.Windows.Forms.CurrencyManagerReset#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/VB/Form1.vb#1)]  \n  \n To test the code example, perform the following steps:  \n  \n1.  Run the example.  \n  \n2.  Make sure the **Cache and reset position** check box is selected.  \n  \n3.  Click the **Clear parent field** button to cause a change in a field of the parent table. Notice that the selected row in the child table does not change.  \n  \n4.  Close and run the example again. You need to do this because the reset behavior occurs only on the first change in the parent row.  \n  \n5.  Clear the **Cache and reset position** check box.  \n  \n6.  Click the **Clear parent field** button. Notice that the selected row in the child table changes to the first row.  \n  \n## Compiling the Code  \n This example requires:  \n  \n-   References to the System, System.Data, System.Drawing, System.Windows.Forms, and System.XML assemblies.  \n  \n For information about how to build this example from the command line for Visual Basic or Visual C#, see [Building from the Command Line](../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md). You can also build this example in Visual Studio by pasting the code into a new project.  \n  \n## See also\n\n- [How to: Ensure Multiple Controls Bound to the Same Data Source Remain Synchronized](multiple-controls-bound-to-data-source-synchronized.md)\n- [BindingSource Component](./controls/bindingsource-component.md)\n- [Data Binding and Windows Forms](data-binding-and-windows-forms.md)\n","nodes":[{"pos":[4,575],"embed":true,"restype":"x-metadata","content":"title: \"How to: Ensure the Selected Row in a Child Table Remains at the Correct Position\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"master-details view\"\n  - \"row position [Windows Forms]\"\n  - \"parent/child view [Windows Forms]\"\n  - \"resetting child position\"\n  - \"data binding [.NET Framework], row selection\"\n  - \"caching [.NET Framework], child position\"\n  - \"child position\"\n  - \"master/details view [Windows Forms]\"\n  - \"child tables row selection\"\n  - \"current child position\"\nms.assetid: c5fa2562-43a4-46fa-a604-52d8526a87bd","nodes":[{"content":"How to: Ensure the Selected Row in a Child Table Remains at the Correct Position","nodes":[{"pos":[0,80],"content":"How to: Ensure the Selected Row in a Child Table Remains at the Correct Position","nodes":[{"content":"How to: Ensure the Selected Row in a Child Table Remains at the Correct Position","pos":[0,80]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[582,662],"content":"How to: Ensure the Selected Row in a Child Table Remains at the Correct Position","linkify":"How to: Ensure the Selected Row in a Child Table Remains at the Correct Position","nodes":[{"content":"How to: Ensure the Selected Row in a Child Table Remains at the Correct Position","pos":[0,80]}]},{"content":"Oftentimes when you work with data binding in Windows Forms, you will display data in what is called a parent/child or master/details view.","pos":[663,802]},{"content":"This refers to a data-binding scenario where data from the same source is displayed in two controls.","pos":[803,903]},{"content":"Changing the selection in one control causes the data displayed in the second control to change.","pos":[904,1000]},{"content":"For example, the first control might contain a list of customers and the second a list of orders related to the selected customer in the first control.","pos":[1001,1152]},{"content":"Starting with the .NET Framework version 2.0, when you display data in a parent/child view you might have to take extra steps to make sure that the currently selected row in the child table is not reset to the first row of the table.","pos":[1159,1392]},{"content":"In order to do this, you will have to cache the child table position and reset it after the parent table changes.","pos":[1393,1506]},{"content":"Typically the child reset occurs the first time a field in a row of the parent table changes.","pos":[1507,1600]},{"pos":[1610,1645],"content":"To Cache the Current Child Position","linkify":"To Cache the Current Child Position","nodes":[{"content":"To Cache the Current Child Position","pos":[0,35]}]},{"content":"Declare an integer variable to store the child list position and a Boolean variable to store whether to cache the child position.","pos":[1655,1784]},{"pos":[1795,2128],"content":"[!code-csharp[System.Windows.Forms.CurrencyManagerReset#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/CS/Form1.cs#4)]\n [!code-vb[System.Windows.Forms.CurrencyManagerReset#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/VB/Form1.vb#4)]","leadings":["","    "],"nodes":[]},{"pos":[2138,2388],"content":"Handle the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.CurrencyManager.ListChanged&gt;</ph> event for the binding's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.CurrencyManager&gt;</ph> and check for a <ph id=\"ph3\">&lt;xref:System.ComponentModel.ListChangedType&gt;</ph> of <ph id=\"ph4\">&lt;xref:System.ComponentModel.ListChangedType.Reset&gt;</ph>.","source":"Handle the <xref:System.Windows.Forms.CurrencyManager.ListChanged> event for the binding's <xref:System.Windows.Forms.CurrencyManager> and check for a <xref:System.ComponentModel.ListChangedType> of <xref:System.ComponentModel.ListChangedType.Reset>."},{"content":"Check the current position of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.CurrencyManager&gt;</ph>.","pos":[2398,2476],"source":"Check the current position of the <xref:System.Windows.Forms.CurrencyManager>."},{"content":"If it is greater than first entry in the list (typically 0), save it to a variable.","pos":[2477,2560]},{"pos":[2571,2904],"content":"[!code-csharp[System.Windows.Forms.CurrencyManagerReset#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/CS/Form1.cs#2)]\n [!code-vb[System.Windows.Forms.CurrencyManagerReset#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/VB/Form1.vb#2)]","leadings":["","    "],"nodes":[]},{"content":"Handle the parent list's <ph id=\"ph1\">&lt;xref:System.Windows.Forms.BindingManagerBase.CurrentChanged&gt;</ph> event for the parent currency manager.","pos":[2914,3039],"source":"Handle the parent list's <xref:System.Windows.Forms.BindingManagerBase.CurrentChanged> event for the parent currency manager."},{"content":"In the handler, set the Boolean value to indicate it is not a caching scenario.","pos":[3040,3119]},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.BindingManagerBase.CurrentChanged&gt;</ph> occurs, the change to the parent is a list position change and not an item value change.","pos":[3120,3277],"source":" If the <xref:System.Windows.Forms.BindingManagerBase.CurrentChanged> occurs, the change to the parent is a list position change and not an item value change."},{"pos":[3288,3621],"content":"[!code-csharp[System.Windows.Forms.CurrencyManagerReset#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/CS/Form1.cs#5)]\n [!code-vb[System.Windows.Forms.CurrencyManagerReset#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/VB/Form1.vb#5)]","leadings":["","    "],"nodes":[]},{"pos":[3631,3658],"content":"To Reset the Child Position","linkify":"To Reset the Child Position","nodes":[{"content":"To Reset the Child Position","pos":[0,27]}]},{"pos":[3668,3816],"content":"Handle the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.BindingManagerBase.PositionChanged&gt;</ph> event for the child binding's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.CurrencyManager&gt;</ph>.","source":"Handle the <xref:System.Windows.Forms.BindingManagerBase.PositionChanged> event for the child binding's <xref:System.Windows.Forms.CurrencyManager>."},{"content":"Reset the child table position to the cached position saved in the previous procedure.","pos":[3826,3912]},{"pos":[3923,4256],"content":"[!code-csharp[System.Windows.Forms.CurrencyManagerReset#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/CS/Form1.cs#3)]\n [!code-vb[System.Windows.Forms.CurrencyManagerReset#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.CurrencyManagerReset/VB/Form1.vb#3)]","leadings":["","    "],"nodes":[]},{"pos":[4265,4272],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example demonstrates how to save the current position on the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.CurrencyManager&gt;</ph>.for a child table and reset the position after an edit is completed on the parent table.","pos":[4276,4483],"source":"The following example demonstrates how to save the current position on the <xref:System.Windows.Forms.CurrencyManager>.for a child table and reset the position after an edit is completed on the parent table."},{"content":"This example contains two <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> controls bound to two tables in a <ph id=\"ph2\">&lt;xref:System.Data.DataSet&gt;</ph> using a <ph id=\"ph3\">&lt;xref:System.Windows.Forms.BindingSource&gt;</ph> component.","pos":[4484,4672],"source":" This example contains two <xref:System.Windows.Forms.DataGridView> controls bound to two tables in a <xref:System.Data.DataSet> using a <xref:System.Windows.Forms.BindingSource> component."},{"content":"A relation is established between the two tables and the relation is added to the <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph>.","pos":[4673,4782],"source":" A relation is established between the two tables and the relation is added to the <xref:System.Data.DataSet>."},{"content":"The position in the child table is initially set to the third row for demonstration purposes.","pos":[4783,4876]},{"content":"To test the code example, perform the following steps:","pos":[5219,5273]},{"content":"Run the example.","pos":[5283,5299]},{"pos":[5309,5374],"content":"Make sure the <bpt id=\"p1\">**</bpt>Cache and reset position<ept id=\"p1\">**</ept> check box is selected.","source":"Make sure the **Cache and reset position** check box is selected."},{"content":"Click the <bpt id=\"p1\">**</bpt>Clear parent field<ept id=\"p1\">**</ept> button to cause a change in a field of the parent table.","pos":[5384,5473],"source":"Click the **Clear parent field** button to cause a change in a field of the parent table."},{"content":"Notice that the selected row in the child table does not change.","pos":[5474,5538]},{"content":"Close and run the example again.","pos":[5548,5580]},{"content":"You need to do this because the reset behavior occurs only on the first change in the parent row.","pos":[5581,5678]},{"pos":[5688,5737],"content":"Clear the <bpt id=\"p1\">**</bpt>Cache and reset position<ept id=\"p1\">**</ept> check box.","source":"Clear the **Cache and reset position** check box."},{"content":"Click the <bpt id=\"p1\">**</bpt>Clear parent field<ept id=\"p1\">**</ept> button.","pos":[5747,5787],"source":"Click the **Clear parent field** button."},{"content":"Notice that the selected row in the child table changes to the first row.","pos":[5788,5861]},{"pos":[5870,5888],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"This example requires:","pos":[5892,5914]},{"content":"References to the System, System.Data, System.Drawing, System.Windows.Forms, and System.XML assemblies.","pos":[5924,6027]},{"content":"For information about how to build this example from the command line for Visual Basic or Visual C#, see <bpt id=\"p1\">[</bpt>Building from the Command Line<ept id=\"p1\">](../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md)</ept> or <bpt id=\"p2\">[</bpt>Command-line Building With csc.exe<ept id=\"p2\">](../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)</ept>.","pos":[6034,6386],"source":"For information about how to build this example from the command line for Visual Basic or Visual C#, see [Building from the Command Line](../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)."},{"content":"You can also build this example in Visual Studio by pasting the code into a new project.","pos":[6387,6475]},{"pos":[6484,6492],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6496,6636],"content":"<bpt id=\"p1\">[</bpt>How to: Ensure Multiple Controls Bound to the Same Data Source Remain Synchronized<ept id=\"p1\">](multiple-controls-bound-to-data-source-synchronized.md)</ept>","source":"[How to: Ensure Multiple Controls Bound to the Same Data Source Remain Synchronized](multiple-controls-bound-to-data-source-synchronized.md)"},{"pos":[6639,6703],"content":"<bpt id=\"p1\">[</bpt>BindingSource Component<ept id=\"p1\">](./controls/bindingsource-component.md)</ept>","source":"[BindingSource Component](./controls/bindingsource-component.md)"},{"pos":[6706,6773],"content":"<bpt id=\"p1\">[</bpt>Data Binding and Windows Forms<ept id=\"p1\">](data-binding-and-windows-forms.md)</ept>","source":"[Data Binding and Windows Forms](data-binding-and-windows-forms.md)"}]}