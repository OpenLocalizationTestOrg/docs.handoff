{"content":"---\ntitle: \"How to: Perform an XSLT Transformation by Using an Assembly | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nms.assetid: 76ee440b-d134-4f8f-8262-b917ad6dcbf6\ncaps.latest.revision: 2\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# How to: Perform an XSLT Transformation by Using an Assembly\nThe XSLT compiler (xsltc.exe) compiles XSLT style sheets and generates an assembly. The assembly can be passed directly into the <xref:System.Xml.Xsl.XslCompiledTransform.Load%28System.Type%29?displayProperty=fullName> method.  \n  \n### To copy the XML and XSLT files to your local computer  \n  \n-   Copy the XSLT file to your local computer and name it Transform.xsl.  \n  \n    ```  \n    <xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"  \n      xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"  \n      xmlns:user=\"urn:my-scripts\">  \n      <msxsl:script language=\"C#\" implements-prefix=\"user\">  \n        <![CDATA[  \n      public string discount(string price){  \n        char[] trimChars = { '$' };  \n        //trim leading $, convert price to type double  \n        double discount_value = Convert.ToDouble(price.TrimStart(trimChars));  \n        //apply 10% discount and round appropriately  \n        discount_value = .9*discount_value;  \n        //convert value to decimal and format as currency  \n        string discount_price = discount_value.ToString(\"C\");  \n        return discount_price;  \n      }  \n      ]]>  \n      </msxsl:script>  \n      <xsl:template match=\"catalog\">  \n        <html>  \n          <head></head>  \n          <body>  \n            <table border=\"1\">  \n              <tr>  \n                <th align=\"left\">Title</th>  \n                <th align=\"left\">Author</th>  \n                <th align=\"left\">Genre</th>  \n                <th align=\"left\">Publish Date</th>  \n                <th align=\"left\">Price</th>  \n              </tr>  \n              <xsl:for-each select=\"book\">  \n                <tr>  \n                  <td>  \n                    <xsl:value-of select=\"title\"/>  \n                  </td>  \n                  <td>  \n                    <xsl:value-of select=\"author\"/>  \n                  </td>  \n                  <td>  \n                    <xsl:value-of select=\"genre\"/>  \n                  </td>  \n                  <td>  \n                    <xsl:value-of select=\"publish_date\"/>  \n                  </td>  \n                  <xsl:choose>  \n                    <xsl:when test=\"genre = 'Fantasy'\">  \n                      <td>  \n                        <xsl:value-of select=\"user:discount(price)\"/>  \n                      </td>  \n                    </xsl:when>  \n                    <xsl:otherwise>  \n                      <td>  \n                        <xsl:value-of select=\"price\"/>  \n                      </td>  \n                    </xsl:otherwise>  \n                  </xsl:choose>  \n                </tr>  \n              </xsl:for-each>  \n            </table>  \n          </body>  \n        </html>  \n      </xsl:template>  \n    </xsl:stylesheet>  \n    ```  \n  \n-   Copy the XML file to your local computer and name it `books.xml`.  \n  \n    ```  \n    <?xml version=\"1.0\"?>  \n    <catalog>  \n       <book id=\"bk101\">  \n          <author>Gambardella, Matthew</author>  \n          <title>XML Developer's Guide</title>  \n          <genre>Computer</genre>  \n          <price>$44.95</price>  \n          <publish_date>2000-10-01</publish_date>  \n       </book>  \n       <book id=\"bk102\">  \n          <author>Ralls, Kim</author>  \n          <title>Midnight Rain</title>  \n          <genre>Fantasy</genre>  \n          <price>$5.95</price>  \n          <publish_date>2000-12-16</publish_date>  \n       </book>  \n       <book id=\"bk103\">  \n          <author>Corets, Eva</author>  \n          <title>Maeve Ascendant</title>  \n          <genre>Fantasy</genre>  \n          <price>$5.95</price>  \n          <publish_date>2000-11-17</publish_date>  \n       </book>  \n       <book id=\"bk106\">  \n          <author>Randall, Cynthia</author>  \n          <title>Lover Birds</title>  \n          <genre>Romance</genre>  \n          <price>$4.95</price>  \n          <publish_date>2000-09-02</publish_date>  \n       </book>  \n       <book id=\"bk107\">  \n          <author>Thurman, Paula</author>  \n          <title>Splish Splash</title>  \n          <genre>Romance</genre>  \n          <price>$4.95</price>  \n          <publish_date>2000-11-02</publish_date>  \n       </book>  \n    </catalog>  \n    ```  \n  \n### To compile the style sheet with the script enabled.  \n  \n1.  Executing the following command from the command line creates two assemblies named `Transform.dll` and `Transform_Script1.dll` (This is the default behavior. Unless otherwise specified, the name of the class and the assembly defaults to the name of the main style sheet):  \n  \n    ```  \n    xsltc /settings:script+ Transform.xsl  \n    ```  \n  \n The following command explicitly sets the class name to Transform:  \n  \n```  \nxsltc /settings:script+ /class:Transform Transform.xsl  \n```  \n  \n### To include the compiled assembly as a reference when you compile your code.  \n  \n1.  You can include an assembly in Visual Studio by adding a reference in the Solution Explorer, or from the command line.  \n  \n2.  For the command line with C#, use the following:  \n  \n    ```  \n    csc myCode.cs /r:system.dll;system.xml.dll;Transform.dll  \n    ```  \n  \n3.  For the command line with Visual Basic, use the following  \n  \n    ```  \n    vbc myCode.vb /r:system.dll;system.xml.dll;Transform.dll  \n    ```  \n  \n### To use the compiled assembly in your code.  \n  \n1.  The following example shows how to execute the XSLT transformation by using the compiled style sheet.  \n  \n [!code-csharp[XslTransform_XSLTC#1](../../../../samples/snippets/csharp/VS_Snippets_Data/XslTransform_XSLTC/CS/XslTransform_XSLTC.cs#1)]\n [!code-vb[XslTransform_XSLTC#1](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XslTransform_XSLTC/VB/XslTransform_XSLTC.vb#1)]  \n  \n To dynamically link to the compiled assembly, replace  \n  \n```  \nxslt.Load(typeof(Transform))  \n```  \n  \n with  \n  \n```  \nxslt.Load(System.Reflection.Assembly.Load(\"Transform\").GetType(\"Transform\"))  \n```  \n  \n in the example above. For more information on the Assembly.Load method, see <xref:System.Reflection.Assembly.Load%2A>  \n  \n## See Also  \n <xref:System.Xml.Xsl.XslCompiledTransform>   \n [XSLT Compiler (xsltc.exe)](../../../../docs/standard/data/xml/xslt-compiler-xsltc-exe.md)   \n [XSLT Transformations](../../../../docs/standard/data/xml/xslt-transformations.md)   \n [Command-line Building With csc.exe](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)","nodes":[{"pos":[4,426],"embed":true,"restype":"x-metadata","content":"title: \"How to: Perform an XSLT Transformation by Using an Assembly | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nms.assetid: 76ee440b-d134-4f8f-8262-b917ad6dcbf6\ncaps.latest.revision: 2\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","nodes":[{"content":"How to: Perform an XSLT Transformation by Using an Assembly | Microsoft Docs","nodes":[{"pos":[0,76],"content":"How to: Perform an XSLT Transformation by Using an Assembly | Microsoft Docs","nodes":[{"content":"How to: Perform an XSLT Transformation by Using an Assembly | Microsoft Docs","pos":[0,76]}]}],"path":["title"]}],"yml":true},{"pos":[433,492],"content":"How to: Perform an XSLT Transformation by Using an Assembly","linkify":"How to: Perform an XSLT Transformation by Using an Assembly","nodes":[{"content":"How to: Perform an XSLT Transformation by Using an Assembly","pos":[0,59]}]},{"content":"The XSLT compiler (xsltc.exe) compiles XSLT style sheets and generates an assembly.","pos":[493,576]},{"content":"The assembly can be passed directly into the <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform.Load%28System.Type%29?displayProperty=fullName&gt;</ph> method.","pos":[577,719],"source":" The assembly can be passed directly into the <xref:System.Xml.Xsl.XslCompiledTransform.Load%28System.Type%29?displayProperty=fullName> method."},{"pos":[729,782],"content":"To copy the XML and XSLT files to your local computer","linkify":"To copy the XML and XSLT files to your local computer","nodes":[{"content":"To copy the XML and XSLT files to your local computer","pos":[0,53]}]},{"content":"Copy the XSLT file to your local computer and name it Transform.xsl.","pos":[792,860]},{"pos":[3230,3295],"content":"Copy the XML file to your local computer and name it <ph id=\"ph1\">`books.xml`</ph>.","source":"Copy the XML file to your local computer and name it `books.xml`."},{"pos":[4645,4696],"content":"To compile the style sheet with the script enabled.","linkify":"To compile the style sheet with the script enabled.","nodes":[{"content":"To compile the style sheet with the script enabled.","pos":[0,51]}]},{"content":"Executing the following command from the command line creates two assemblies named <ph id=\"ph1\">`Transform.dll`</ph> and <ph id=\"ph2\">`Transform_Script1.dll`</ph> (This is the default behavior.","pos":[4706,4863],"source":"Executing the following command from the command line creates two assemblies named `Transform.dll` and `Transform_Script1.dll` (This is the default behavior."},{"content":"Unless otherwise specified, the name of the class and the assembly defaults to the name of the main style sheet):","pos":[4864,4977]},{"content":"The following command explicitly sets the class name to Transform:","pos":[5051,5117]},{"pos":[5199,5274],"content":"To include the compiled assembly as a reference when you compile your code.","linkify":"To include the compiled assembly as a reference when you compile your code.","nodes":[{"content":"To include the compiled assembly as a reference when you compile your code.","pos":[0,75]}]},{"content":"You can include an assembly in Visual Studio by adding a reference in the Solution Explorer, or from the command line.","pos":[5284,5402]},{"content":"For the command line with C#, use the following:","pos":[5412,5460]},{"content":"For the command line with Visual Basic, use the following","pos":[5556,5613]},{"pos":[5709,5751],"content":"To use the compiled assembly in your code.","linkify":"To use the compiled assembly in your code.","nodes":[{"content":"To use the compiled assembly in your code.","pos":[0,42]}]},{"content":"The following example shows how to execute the XSLT transformation by using the compiled style sheet.","pos":[5761,5862]},{"pos":[5869,6144],"content":"[!code-csharp[XslTransform_XSLTC#1](../../../../samples/snippets/csharp/VS_Snippets_Data/XslTransform_XSLTC/CS/XslTransform_XSLTC.cs#1)]\n[!code-vb[XslTransform_XSLTC#1](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XslTransform_XSLTC/VB/XslTransform_XSLTC.vb#1)]","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>XslTransform_XSLTC#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Data/XslTransform_XSLTC/CS/XslTransform_XSLTC.cs#1)</ept><ept id=\"p1\">]</ept>","pos":[0,136],"source":"[!code-csharp[XslTransform_XSLTC#1](../../../../samples/snippets/csharp/VS_Snippets_Data/XslTransform_XSLTC/CS/XslTransform_XSLTC.cs#1)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>XslTransform_XSLTC#1<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XslTransform_XSLTC/VB/XslTransform_XSLTC.vb#1)</ept><ept id=\"p1\">]</ept>","pos":[137,274],"source":"[!code-vb[XslTransform_XSLTC#1](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XslTransform_XSLTC/VB/XslTransform_XSLTC.vb#1)]"}]},{"content":"To dynamically link to the compiled assembly, replace","pos":[6151,6204]},{"content":"with","pos":[6257,6261]},{"content":"in the example above.","pos":[6362,6383]},{"content":"For more information on the Assembly.Load method, see <ph id=\"ph1\">&lt;xref:System.Reflection.Assembly.Load%2A&gt;</ph>","pos":[6384,6479],"source":" For more information on the Assembly.Load method, see <xref:System.Reflection.Assembly.Load%2A>"},{"pos":[6488,6496],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph>","pos":[6500,6542],"source":"<xref:System.Xml.Xsl.XslCompiledTransform> "},{"content":"<bpt id=\"p1\">[</bpt>XSLT Compiler (xsltc.exe)<ept id=\"p1\">](../../../../docs/standard/data/xml/xslt-compiler-xsltc-exe.md)</ept><ph id=\"ph1\"> </ph>","pos":[6547,6638],"source":"[XSLT Compiler (xsltc.exe)](../../../../docs/standard/data/xml/xslt-compiler-xsltc-exe.md) "},{"content":"<bpt id=\"p1\">[</bpt>XSLT Transformations<ept id=\"p1\">](../../../../docs/standard/data/xml/xslt-transformations.md)</ept><ph id=\"ph1\"> </ph>","pos":[6642,6725],"source":"[XSLT Transformations](../../../../docs/standard/data/xml/xslt-transformations.md) "},{"content":"<bpt id=\"p1\">[</bpt>Command-line Building With csc.exe<ept id=\"p1\">](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)</ept>","pos":[6729,6854],"source":"[Command-line Building With csc.exe](~/docs/csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)"}]}