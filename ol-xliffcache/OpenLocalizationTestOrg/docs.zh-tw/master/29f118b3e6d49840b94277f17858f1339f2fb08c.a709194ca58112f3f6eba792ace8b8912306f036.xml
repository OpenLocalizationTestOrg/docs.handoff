{"content":"---\ntitle: \"Deferred Execution Example (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 9a22bea1-c755-4aac-800a-fcd9e5107ace\n---\n# Deferred Execution Example (Visual Basic)\nThis topic shows how deferred execution and lazy evaluation affect the execution of your LINQ to XML queries.  \n  \n## Example  \n The following example shows the order of execution when using an extension method that uses deferred execution. The example declares an array of three strings. It then iterates through the collection returned by `ConvertCollectionToUpperCase`.  \n  \n```vb  \nImports System.Runtime.CompilerServices  \n  \nModule Module1  \n  \n    <Extension()>  \n    Private Iterator Function ConvertCollectionToUpperCase(  \n    ByVal source As IEnumerable(Of String)) _  \n    As IEnumerable(Of String)   \n        For Each str As String In source  \n            Console.WriteLine(\"ToUpper: source {0}\", str)   \n            Yield str.ToUpper()  \n        Next  \n    End Function  \n  \n    Sub Main()  \n        Dim stringArray = New String() {\"abc\", \"def\", \"ghi\"}  \n  \n        Dim q = From str In stringArray.ConvertCollectionToUpperCase()  \n                Select str  \n  \n        For Each Str As String In q  \n            Console.WriteLine(\"Main: str {0}\", Str)   \n        Next  \n    End Sub  \n  \nEnd Module  \n```  \n  \n This example produces the following output:  \n  \n```  \nToUpper: source abc  \nMain: str ABC  \nToUpper: source def  \nMain: str DEF  \nToUpper: source ghi  \nMain: str GHI  \n```  \n  \n Notice that when iterating through the collection returned by `ConvertCollectionToUpperCase`, each item is retrieved from the source string array and converted to uppercase before the next item is retrieved from the source string array.  \n  \n You can see that the entire array of strings is not converted to uppercase before each item in the returned collection is processed in the `foreach` loop in `Main`.  \n  \n## See also\n\n- [Tutorial: Deferred Execution (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/tutorial-deferred-execution.md)\n","nodes":[{"pos":[4,123],"embed":true,"restype":"x-metadata","content":"title: \"Deferred Execution Example (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 9a22bea1-c755-4aac-800a-fcd9e5107ace","nodes":[{"content":"Deferred Execution Example (Visual Basic)","nodes":[{"pos":[0,41],"content":"Deferred Execution Example (Visual Basic)","nodes":[{"content":"Deferred Execution Example (Visual Basic)","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[130,171],"content":"Deferred Execution Example (Visual Basic)","linkify":"Deferred Execution Example (Visual Basic)","nodes":[{"content":"Deferred Execution Example (Visual Basic)","pos":[0,41]}]},{"content":"This topic shows how deferred execution and lazy evaluation affect the execution of your LINQ to XML queries.","pos":[172,281]},{"pos":[290,297],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows the order of execution when using an extension method that uses deferred execution.","pos":[301,412]},{"content":"The example declares an array of three strings.","pos":[413,460]},{"content":"It then iterates through the collection returned by <ph id=\"ph1\">`ConvertCollectionToUpperCase`</ph>.","pos":[461,544],"source":" It then iterates through the collection returned by `ConvertCollectionToUpperCase`."},{"content":"This example produces the following output:","pos":[1297,1340]},{"pos":[1476,1712],"content":"Notice that when iterating through the collection returned by <ph id=\"ph1\">`ConvertCollectionToUpperCase`</ph>, each item is retrieved from the source string array and converted to uppercase before the next item is retrieved from the source string array.","source":"Notice that when iterating through the collection returned by `ConvertCollectionToUpperCase`, each item is retrieved from the source string array and converted to uppercase before the next item is retrieved from the source string array."},{"pos":[1719,1883],"content":"You can see that the entire array of strings is not converted to uppercase before each item in the returned collection is processed in the <ph id=\"ph1\">`foreach`</ph> loop in <ph id=\"ph2\">`Main`</ph>.","source":"You can see that the entire array of strings is not converted to uppercase before each item in the returned collection is processed in the `foreach` loop in `Main`."},{"pos":[1892,1900],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1904,2038],"content":"<bpt id=\"p1\">[</bpt>Tutorial: Deferred Execution (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/tutorial-deferred-execution.md)</ept>","source":"[Tutorial: Deferred Execution (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/tutorial-deferred-execution.md)"}]}