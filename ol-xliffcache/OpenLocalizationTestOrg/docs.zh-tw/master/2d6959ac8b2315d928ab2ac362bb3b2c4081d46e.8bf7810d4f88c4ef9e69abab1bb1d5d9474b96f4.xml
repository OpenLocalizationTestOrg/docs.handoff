{"content":"---\ntitle: \"How to: Create Wrappers Manually\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"wrappers, creating manually\"\nms.assetid: cc2a70d8-6a58-4071-a8cf-ce28c018c09b\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# How to: Create Wrappers Manually\nIf you decide to declare COM types manually in managed source code, the best place to start is with an existing Interface Definition Language (IDL) file or type library. When you do not have the IDL file or cannot generate a type library file, you can simulate the COM types by creating managed declarations and exporting the resulting assembly to a type library.  \n  \n### To simulate COM types from managed source  \n  \n1.  Declare the types in a language that is compliant with the Common Language Specification (CLS) and compile the file.  \n  \n2.  Export the assembly containing the types with the [Type Library Exporter (Tlbexp.exe)](../tools/tlbexp-exe-type-library-exporter.md).  \n  \n3.  Use the exported COM type library as a basis for declaring COM-oriented managed types.  \n  \n### To create a runtime callable wrapper (RCW)  \n  \n1.  Assuming that you have an IDL file or type library file, decide which classes and interfaces you want to include in the custom RCW. You can exclude any types that you do not intend to use directly or indirectly in your application.  \n  \n2.  Create a source file in a CLS-compliant language and declare the types. See [Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)) for a complete description of the import conversion process. Effectively, when you create a custom RCW, you are manually performing the type conversion activity provided by the [Type Library Importer (Tlbimp.exe)](../tools/tlbimp-exe-type-library-importer.md). The example in the next section shows types in an IDL or type library file and their corresponding types in C# code.  \n  \n3.  When the declarations are complete, compile the file as you compile any other managed source code.  \n  \n4.  As with the types imported with Tlbimp.exe, some require additional information, which you can add directly to your code. For details, see [How to: Edit Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/8zbc969t(v=vs.100)).  \n  \n## Example  \n The following code shows an example of the `ISATest` interface and `SATest` class in IDL and the corresponding types in C# source code.  \n  \n **IDL or type library file**  \n  \n```  \n [  \nobject,  \nuuid(40A8C65D-2448-447A-B786-64682CBEF133),  \ndual,  \nhelpstring(\"ISATest Interface\"),  \npointer_default(unique)  \n ]  \ninterface ISATest : IDispatch  \n {  \n[id(1), helpstring(\"method InSArray\")]   \nHRESULT InSArray([in] SAFEARRAY(int) *ppsa, [out,retval] int *pSum);  \n };  \n [  \nuuid(116CCA1E-7E39-4515-9849-90790DA6431E),  \nhelpstring(\"SATest Class\")  \n ]  \ncoclass SATest  \n {  \n  [default] interface ISATest;  \n };  \n```  \n  \n **Wrapper in managed source code**  \n  \n```csharp  \nusing System;  \nusing System.Runtime.InteropServices;  \nusing System.Runtime.CompilerServices;  \n  \n[assembly:Guid(\"E4A992B8-6F5C-442C-96E7-C4778924C753\")]  \n[assembly:ImportedFromTypeLib(\"SAServerLib\")]  \nnamespace SAServer  \n{  \n [ComImport]  \n [Guid(\"40A8C65D-2448-447A-B786-64682CBEF133\")]  \n [TypeLibType(TypeLibTypeFlags.FLicensed)]  \n public interface ISATest  \n {  \n  [DispId(1)]  \n  //[MethodImpl(MethodImplOptions.InternalCall,  \n  // MethodCodeType=MethodCodeType.Runtime)]  \n  int InSArray( [MarshalAs(UnmanagedType.SafeArray,  \n      SafeArraySubType=VarEnum.VT_I4)] ref int[] param );  \n }   \n [ComImport]  \n [Guid(\"116CCA1E-7E39-4515-9849-90790DA6431E\")]  \n [ClassInterface(ClassInterfaceType.None)]  \n [TypeLibType(TypeLibTypeFlags.FCanCreate)]  \n public class SATest : ISATest  \n {  \n  [DispId(1)]  \n  [MethodImpl(MethodImplOptions.InternalCall,   \n  MethodCodeType=MethodCodeType.Runtime)]  \n  extern int ISATest.InSArray( [MarshalAs(UnmanagedType.SafeArray,   \n  SafeArraySubType=VarEnum.VT_I4)] ref int[] param );  \n }  \n}  \n```  \n  \n## See also\n\n- [Customizing Runtime Callable Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/e753eftz(v=vs.100))\n- [COM Data Types](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/sak564ww(v=vs.100))\n- [How to: Edit Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/8zbc969t(v=vs.100))\n- [Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))\n- [Tlbimp.exe (Type Library Importer)](../tools/tlbimp-exe-type-library-importer.md)\n- [Tlbexp.exe (Type Library Exporter)](../tools/tlbexp-exe-type-library-exporter.md)\n","nodes":[{"pos":[4,212],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create Wrappers Manually\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"wrappers, creating manually\"\nms.assetid: cc2a70d8-6a58-4071-a8cf-ce28c018c09b\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"How to: Create Wrappers Manually","nodes":[{"pos":[0,32],"content":"How to: Create Wrappers Manually","nodes":[{"content":"How to: Create Wrappers Manually","pos":[0,32]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[219,251],"content":"How to: Create Wrappers Manually","linkify":"How to: Create Wrappers Manually","nodes":[{"content":"How to: Create Wrappers Manually","pos":[0,32]}]},{"content":"If you decide to declare COM types manually in managed source code, the best place to start is with an existing Interface Definition Language (IDL) file or type library.","pos":[252,421]},{"content":"When you do not have the IDL file or cannot generate a type library file, you can simulate the COM types by creating managed declarations and exporting the resulting assembly to a type library.","pos":[422,615]},{"pos":[625,666],"content":"To simulate COM types from managed source","linkify":"To simulate COM types from managed source","nodes":[{"content":"To simulate COM types from managed source","pos":[0,41]}]},{"content":"Declare the types in a language that is compliant with the Common Language Specification (CLS) and compile the file.","pos":[676,792]},{"pos":[802,935],"content":"Export the assembly containing the types with the <bpt id=\"p1\">[</bpt>Type Library Exporter (Tlbexp.exe)<ept id=\"p1\">](../tools/tlbexp-exe-type-library-exporter.md)</ept>.","source":"Export the assembly containing the types with the [Type Library Exporter (Tlbexp.exe)](../tools/tlbexp-exe-type-library-exporter.md)."},{"content":"Use the exported COM type library as a basis for declaring COM-oriented managed types.","pos":[945,1031]},{"pos":[1041,1083],"content":"To create a runtime callable wrapper (RCW)","linkify":"To create a runtime callable wrapper (RCW)","nodes":[{"content":"To create a runtime callable wrapper (RCW)","pos":[0,42]}]},{"content":"Assuming that you have an IDL file or type library file, decide which classes and interfaces you want to include in the custom RCW.","pos":[1093,1224]},{"content":"You can exclude any types that you do not intend to use directly or indirectly in your application.","pos":[1225,1324]},{"content":"Create a source file in a CLS-compliant language and declare the types.","pos":[1334,1405]},{"content":"See <bpt id=\"p1\">[</bpt>Type Library to Assembly Conversion Summary<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</ept> for a complete description of the import conversion process.","pos":[1406,1605],"source":" See [Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)) for a complete description of the import conversion process."},{"content":"Effectively, when you create a custom RCW, you are manually performing the type conversion activity provided by the <bpt id=\"p1\">[</bpt>Type Library Importer (Tlbimp.exe)<ept id=\"p1\">](../tools/tlbimp-exe-type-library-importer.md)</ept>.","pos":[1606,1805],"source":" Effectively, when you create a custom RCW, you are manually performing the type conversion activity provided by the [Type Library Importer (Tlbimp.exe)](../tools/tlbimp-exe-type-library-importer.md)."},{"content":"The example in the next section shows types in an IDL or type library file and their corresponding types in C# code.","pos":[1806,1922]},{"content":"When the declarations are complete, compile the file as you compile any other managed source code.","pos":[1932,2030]},{"content":"As with the types imported with Tlbimp.exe, some require additional information, which you can add directly to your code.","pos":[2040,2161]},{"content":"For details, see <bpt id=\"p1\">[</bpt>How to: Edit Interop Assemblies<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/8zbc969t(v=vs.100))</ept>.","pos":[2162,2302],"source":" For details, see [How to: Edit Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/8zbc969t(v=vs.100))."},{"pos":[2311,2318],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2322,2457],"content":"The following code shows an example of the <ph id=\"ph1\">`ISATest`</ph> interface and <ph id=\"ph2\">`SATest`</ph> class in IDL and the corresponding types in C# source code.","source":"The following code shows an example of the `ISATest` interface and `SATest` class in IDL and the corresponding types in C# source code."},{"pos":[2464,2492],"content":"<bpt id=\"p1\">**</bpt>IDL or type library file<ept id=\"p1\">**</ept>","source":"**IDL or type library file**"},{"pos":[2951,2985],"content":"<bpt id=\"p1\">**</bpt>Wrapper in managed source code<ept id=\"p1\">**</ept>","source":"**Wrapper in managed source code**"},{"pos":[4060,4068],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4072,4200],"content":"<bpt id=\"p1\">[</bpt>Customizing Runtime Callable Wrappers<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/e753eftz(v=vs.100))</ept>","source":"[Customizing Runtime Callable Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/e753eftz(v=vs.100))"},{"pos":[4203,4308],"content":"<bpt id=\"p1\">[</bpt>COM Data Types<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/sak564ww(v=vs.100))</ept>","source":"[COM Data Types](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/sak564ww(v=vs.100))"},{"pos":[4311,4433],"content":"<bpt id=\"p1\">[</bpt>How to: Edit Interop Assemblies<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/8zbc969t(v=vs.100))</ept>","source":"[How to: Edit Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/8zbc969t(v=vs.100))"},{"pos":[4436,4570],"content":"<bpt id=\"p1\">[</bpt>Type Library to Assembly Conversion Summary<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</ept>","source":"[Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))"},{"pos":[4573,4655],"content":"<bpt id=\"p1\">[</bpt>Tlbimp.exe (Type Library Importer)<ept id=\"p1\">](../tools/tlbimp-exe-type-library-importer.md)</ept>","source":"[Tlbimp.exe (Type Library Importer)](../tools/tlbimp-exe-type-library-importer.md)"},{"pos":[4658,4740],"content":"<bpt id=\"p1\">[</bpt>Tlbexp.exe (Type Library Exporter)<ept id=\"p1\">](../tools/tlbexp-exe-type-library-exporter.md)</ept>","source":"[Tlbexp.exe (Type Library Exporter)](../tools/tlbexp-exe-type-library-exporter.md)"}]}