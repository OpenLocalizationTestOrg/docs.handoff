{"content":"---\ntitle: \"XPathNavigator in Transformations\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 118f97d1-7110-4d1b-b0bd-4143252c0bb0\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# XPathNavigator in Transformations\nThe <xref:System.Xml.XPath.XPathNavigator> class provides read-only random access to data and is designed for use as an input to Extensible Stylesheet Language for Transformations (XSLT). It is implemented on the <xref:System.Xml.XPath.XPathDocument>, <xref:System.Xml.XmlDataDocument>, and <xref:System.Xml.XmlDocument>. The <xref:System.Xml.XPath.XPathNavigator> is based upon the World Wide Web Consortium (W3C) Data Model as described in section 5 of the XML Path Language (XPath) recommendation.  \n  \n The <xref:System.Xml.XPath.XPathNavigator> defines a cursor model over any store and provides fast, read-only XPath queries over any data store. The <xref:System.Xml.XPath.XPathNavigator> is also the class to use for iterating over result tree fragments.  \n  \n The API enables you to get information from the current node in the store and move to connected nodes. The <xref:System.Xml.XPath.XPathNavigator> is a cursor style model that performs traversal over a store using a set of **Move** methods. The <xref:System.Xml.XPath.XPathNavigator> is always positioned on a node. Any **Move** method that fails leaves the <xref:System.Xml.XPath.XPathNavigator> unchanged.  \n  \n The <xref:System.Xml.XPath.XPathNavigator> is the class to use for iterating over result tree fragments. The following code sample creates a result tree fragment within a style sheet by calling the function with the parameter, `fragment`, which contains XML.  \n  \n## test.xsl  \n  \n```xml  \n<xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"  \n                xmlns:msxsl =\"urn:schemas-microsoft-com:xslt\"  \n                xmlns:user=\"http://www.adventure-works.com\"  \n                version=\"1.0\">  \n  \n<xsl:variable name=\"fragment\">  \n    <authorlist>  \n       <author>Joe</author>  \n    </authorlist>  \n</xsl:variable>  \n  \n<msxsl:script language=\"C#\" implements-prefix=\"user\">  \n<![CDATA[  \n   string NodeFragment(XPathNavigator nav)  \n   {  \n      if (nav.HasChildren)  \n        return nav.Value;  \n      else  \n        return \"\";  \n   }  \n]]>  \n</msxsl:script>  \n  \n<xsl:template match=\"/\">  \n     <xsl:value-of select=\"user:NodeFragment($fragment)\"/>  \n</xsl:template>  \n  \n</xsl:stylesheet>  \n```  \n  \n## test.xml  \n  \n```xml  \n<root>Some text</root>  \n```  \n  \n The following code uses the **test.xsl** style sheet and **test.xml** input data.  \n  \n```vb  \nImports System  \nImports System.IO  \nImports System.Xml  \nImports System.Xml.Xsl  \nImports System.Xml.XPath  \nImports System.Text  \nPublic Class sample  \n  \n    Public Shared Sub Main()  \n        Dim xslt As New XslTransform()  \n        xslt.Load(\"test.xsl\")  \n  \n        Dim xd As New XPathDocument(\"test.xml\")  \n  \n        Dim strmTemp = New FileStream(\"out.xml\", FileMode.Create, FileAccess.ReadWrite)  \n        xslt.Transform(xd, Nothing, strmTemp, Nothing)  \n    End Sub 'Main  \nEnd Class 'sample  \n```  \n  \n```csharp  \nusing System;  \nusing System.IO;  \nusing System.Xml;  \nusing System.Xml.Xsl;  \nusing System.Xml.XPath;  \nusing System.Text;  \n  \npublic class sample  \n{  \n    public static void Main()  \n    {  \n        XslTransform xslt = new XslTransform();  \n        xslt.Load(\"test.xsl\");  \n  \n        XPathDocument xd = new XPathDocument(\"test.xml\");  \n  \n        Stream strmTemp = new FileStream(\"out.xml\", FileMode.Create, FileAccess.ReadWrite);  \n        xslt.Transform(xd, null, strmTemp, null);  \n    }  \n}  \n```  \n  \n## Output  \n The result of the transformation is found in the file **out.xml**:  \n  \n```xml  \n<?xml version=\"1.0\" encoding=\"utf-8\"?>Joe  \n```  \n  \n## See also\n\n- [XslTransform Class Implements the XSLT Processor](../../../../docs/standard/data/xml/xsltransform-class-implements-the-xslt-processor.md)\n","nodes":[{"pos":[4,219],"embed":true,"restype":"x-metadata","content":"title: \"XPathNavigator in Transformations\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 118f97d1-7110-4d1b-b0bd-4143252c0bb0\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"XPathNavigator in Transformations","nodes":[{"pos":[0,33],"content":"XPathNavigator in Transformations","nodes":[{"content":"XPathNavigator in Transformations","pos":[0,33]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[226,259],"content":"XPathNavigator in Transformations","linkify":"XPathNavigator in Transformations","nodes":[{"content":"XPathNavigator in Transformations","pos":[0,33]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class provides read-only random access to data and is designed for use as an input to Extensible Stylesheet Language for Transformations (XSLT).","pos":[260,447],"source":"The <xref:System.Xml.XPath.XPathNavigator> class provides read-only random access to data and is designed for use as an input to Extensible Stylesheet Language for Transformations (XSLT)."},{"content":"It is implemented on the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Xml.XmlDataDocument&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Xml.XmlDocument&gt;</ph>.","pos":[448,581],"source":" It is implemented on the <xref:System.Xml.XPath.XPathDocument>, <xref:System.Xml.XmlDataDocument>, and <xref:System.Xml.XmlDocument>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> is based upon the World Wide Web Consortium (W3C) Data Model as described in section 5 of the XML Path Language (XPath) recommendation.","pos":[582,760],"source":" The <xref:System.Xml.XPath.XPathNavigator> is based upon the World Wide Web Consortium (W3C) Data Model as described in section 5 of the XML Path Language (XPath) recommendation."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> defines a cursor model over any store and provides fast, read-only XPath queries over any data store.","pos":[767,911],"source":"The <xref:System.Xml.XPath.XPathNavigator> defines a cursor model over any store and provides fast, read-only XPath queries over any data store."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> is also the class to use for iterating over result tree fragments.","pos":[912,1021],"source":" The <xref:System.Xml.XPath.XPathNavigator> is also the class to use for iterating over result tree fragments."},{"content":"The API enables you to get information from the current node in the store and move to connected nodes.","pos":[1028,1130]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> is a cursor style model that performs traversal over a store using a set of <bpt id=\"p1\">**</bpt>Move<ept id=\"p1\">**</ept> methods.","pos":[1131,1267],"source":" The <xref:System.Xml.XPath.XPathNavigator> is a cursor style model that performs traversal over a store using a set of **Move** methods."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> is always positioned on a node.","pos":[1268,1342],"source":" The <xref:System.Xml.XPath.XPathNavigator> is always positioned on a node."},{"content":"Any <bpt id=\"p1\">**</bpt>Move<ept id=\"p1\">**</ept> method that fails leaves the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> unchanged.","pos":[1343,1434],"source":" Any **Move** method that fails leaves the <xref:System.Xml.XPath.XPathNavigator> unchanged."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> is the class to use for iterating over result tree fragments.","pos":[1441,1545],"source":"The <xref:System.Xml.XPath.XPathNavigator> is the class to use for iterating over result tree fragments."},{"content":"The following code sample creates a result tree fragment within a style sheet by calling the function with the parameter, <ph id=\"ph1\">`fragment`</ph>, which contains XML.","pos":[1546,1699],"source":" The following code sample creates a result tree fragment within a style sheet by calling the function with the parameter, `fragment`, which contains XML."},{"pos":[1708,1716],"content":"test.xsl","linkify":"test.xsl","nodes":[{"content":"test.xsl","pos":[0,8]}]},{"pos":[2469,2477],"content":"test.xml","linkify":"test.xml","nodes":[{"content":"test.xml","pos":[0,8]}]},{"pos":[2527,2608],"content":"The following code uses the <bpt id=\"p1\">**</bpt>test.xsl<ept id=\"p1\">**</ept> style sheet and <bpt id=\"p2\">**</bpt>test.xml<ept id=\"p2\">**</ept> input data.","source":"The following code uses the **test.xsl** style sheet and **test.xml** input data."},{"pos":[3661,3667],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"pos":[3671,3737],"content":"The result of the transformation is found in the file <bpt id=\"p1\">**</bpt>out.xml<ept id=\"p1\">**</ept>:","source":"The result of the transformation is found in the file **out.xml**:"},{"pos":[3808,3816],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3820,3958],"content":"<bpt id=\"p1\">[</bpt>XslTransform Class Implements the XSLT Processor<ept id=\"p1\">](../../../../docs/standard/data/xml/xsltransform-class-implements-the-xslt-processor.md)</ept>","source":"[XslTransform Class Implements the XSLT Processor](../../../../docs/standard/data/xml/xsltransform-class-implements-the-xslt-processor.md)"}]}