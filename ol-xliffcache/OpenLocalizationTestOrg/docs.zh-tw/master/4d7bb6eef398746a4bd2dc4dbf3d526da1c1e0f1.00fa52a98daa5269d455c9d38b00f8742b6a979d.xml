{"content":"---\ntitle: \"Extending the My Namespace in Visual Basic\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.AddingMyExtensions\"\nhelpviewer_keywords: \n  - \"My namespace [Visual Basic], customizing\"\n  - \"My namespace\"\n  - \"My namespace [Visual Basic], extending\"\nms.assetid: 808e8617-b01c-4135-8b21-babe87389e8e\n---\n# Extending the My Namespace in Visual Basic\nThe `My` namespace in Visual Basic exposes properties and methods that enable you to easily take advantage of the power of the .NET Framework. The `My` namespace simplifies common programming problems, often reducing a difficult task to a single line of code. Additionally, the `My` namespace is fully extensible so that you can customize the behavior of `My` and add new services to its hierarchy to adapt to specific application needs. This topic discusses both how to customize existing members of the `My` namespace and how to add your own custom classes to the `My` namespace.  \n  \n **Topic Contents**  \n  \n-   [Customizing Existing My Namespace Members](#customizing)  \n  \n-   [Adding Members to My Objects](#addingtoobjects)  \n  \n-   [Adding Custom Objects to the My Namespace](#addingcustom)  \n  \n-   [Adding Members to the My Namespace](#addingtonamespace)  \n  \n-   [Adding Events to Custom My Objects](#addingevents)  \n  \n-   [Design Guidelines](#design)  \n  \n-   [Designing Class Libraries for My](#designing)  \n  \n-   [Packaging and Deploying Extensions](#packaging)  \n  \n## <a name=\"customizing\"></a> Customizing Existing My Namespace Members  \n The `My` namespace in Visual Basic exposes frequently used information about your application, your computer, and more. For a complete list of the objects in the `My` namespace, see [My Reference](../../../visual-basic/language-reference/keywords/my-reference.md). You may have to customize existing members of the `My` namespace so that they better match the needs of your application. Any property of an object in the `My` namespace that is not read-only can be set to a custom value.  \n  \n For example, assume that you frequently use the `My.User` object to access the current security context for the user running your application. However, your company uses a custom user object to expose additional information and capabilities for users within the company. In this scenario, you can replace the default value of the `My.User.CurrentPrincipal` property with an instance of your own custom principal object, as shown in the following example.  \n  \n [!code-vb[VbVbcnExtendingMy#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#1)]  \n  \n Setting the `CurrentPrincipal` property on the `My.User` object changes the identity under which the application runs. The `My.User` object, in turn, returns information about the newly specified user.  \n  \n## <a name=\"addingtoobjects\"></a> Adding Members to My Objects  \n The types returned from `My.Application` and `My.Computer` are defined as `Partial` classes. Therefore, you can extend the `My.Application` and `My.Computer` objects by creating a `Partial` class named `MyApplication` or `MyComputer`. The class cannot be a `Private` class. If you specify the class as part of the `My` namespace, you can add properties and methods that will be included with the `My.Application` or `My.Computer` objects.  \n  \n For example, the following example adds a property named `DnsServerIPAddresses` to the `My.Computer` object.  \n  \n [!code-vb[VbVbcnExtendingMy#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class2.vb#2)]  \n  \n## <a name=\"addingcustom\"></a> Adding Custom Objects to the My Namespace  \n Although the `My` namespace provides solutions for many common programming tasks, you may encounter tasks that the `My` namespace does not address. For example, your application might access custom directory services for user data, or your application might use assemblies that are not installed by default with Visual Basic. You can extend the `My` namespace to include custom solutions to common tasks that are specific to your environment. The `My` namespace can easily be extended to add new members to meet growing application needs. Additionally, you can deploy your `My` namespace extensions to other developers as a Visual Basic template.  \n  \n### <a name=\"addingtonamespace\"></a> Adding Members to the My Namespace  \n Because `My` is a namespace like any other namespace, you can add top-level properties to it by just adding a module and specifying a `Namespace` of `My`. Annotate the module with the `HideModuleName` attribute as shown in the following example. The `HideModuleName` attribute ensures that IntelliSense will not display the module name when it displays the members of the `My` namespace.  \n  \n [!code-vb[VbVbcnExtendingMy#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#3)]  \n  \n To add members to the `My` namespace, add properties as needed to the module. For each property added to the `My` namespace, add a private field of type `ThreadSafeObjectProvider(Of T)`, where the type is the type returned by your custom property. This field is used to create thread-safe object instances to be returned by the property by calling the `GetInstance` method. As a result, each thread that is accessing the extended property receives its own instance of the returned type. The following example adds a property named `SampleExtension` that is of type `SampleExtension` to the `My` namespace:  \n  \n [!code-vb[VbVbcnExtendingMy#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#4)]  \n  \n## <a name=\"addingevents\"></a> Adding Events to Custom My Objects  \n You can use the `My.Application` object to expose events for your custom `My` objects by extending the `MyApplication` partial class in the `My` namespace. For Windows-based projects, you can double-click the **My Project** node in for your project in **Solution Explorer**. In the Visual Basic **Project Designer**, click the `Application` tab and then click the `View Application Events` button. A new file that is named ApplicationEvents.vb will be created. It contains the following code for extending the `MyApplication` class.  \n  \n [!code-vb[VbVbcnExtendingMy#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#5)]  \n  \n You can add event handlers for your custom `My` objects by adding custom event handlers to the `MyApplication` class. Custom events enable you to add code that will execute when an event handler is added, removed, or the event is raised. Note that the `AddHandler` code for a custom event runs only if code is added by a user to handle the event. For example, consider that the `SampleExtension` object from the previous section has a `Load` event that you want to add a custom event handler for. The following code example shows a custom event handler named `SampleExtensionLoad` that will be invoked when the `My.SampleExtension.Load` event occurs. When code is added to handle the new `My.SampleExtensionLoad` event, the `AddHandler` part of this custom event code is executed. The `MyApplication_SampleExtensionLoad` method is included in the code example to show an example of an event handler that handles the `My.SampleExtensionLoad` event. Note that the `SampleExtensionLoad` event will be available when you select the **My Application Events** option in the left drop-down list above the Code Editor when you are editing the ApplicationEvents.vb file.  \n  \n [!code-vb[VbVbcnExtendingMy#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#6)]  \n  \n## <a name=\"design\"></a> Design Guidelines  \n When you develop extensions to the `My` namespace, use the following guidelines to help minimize the maintenance costs of your extension components.  \n  \n-   **Include only the extension logic.** The logic included in the `My` namespace extension should include only the code that is needed to expose the required functionality in the `My` namespace. Because your extension will reside in user projects as source code, updating the extension component incurs a high maintenance cost and should be avoided if possible.  \n  \n-   **Minimize project assumptions.** When you create your extensions of the `My` namespace, do not assume a set of references, project-level imports, or specific compiler settings (for example, `Option Strict` off). Instead, minimize dependencies and fully qualify all type references by using the `Global` keyword. Also, ensure that the extension compiles with `Option Strict` on to minimize errors in the extension.  \n  \n-   **Isolate the extension code.** Placing the code in a single file makes your extension easily deployable as a Visual Studio item template. For more information, see \"Packaging and Deploying Extensions\" later in this topic. Placing all the `My` namespace extension code in a single file or a separate folder in a project will also help users locate the `My` namespace extension.  \n  \n## <a name=\"designing\"></a> Designing Class Libraries for My  \n As is the case with most object models, some design patterns work well in the `My` namespace and others do not. When designing an extension to the `My` namespace, consider the following principles:  \n  \n-   **Stateless methods.** Methods in the `My` namespace should provide a complete solution to a specific task. Ensure that the parameter values that are passed to the method provide all the input required to complete the particular task. Avoid creating methods that rely on prior state, such as open connections to resources.  \n  \n-   **Global instances.** The only state that is maintained in the `My` namespace is global to the project. For example, `My.Application.Info` encapsulates state that is shared throughout the application.  \n  \n-   **Simple parameter types.** Keep things simple by avoiding complex parameter types. Instead, create methods that either take no parameter input or that take simple input types such as strings, primitive types, and so on.  \n  \n-   **Factory methods.** Some types are necessarily difficult to instantiate. Providing factory methods as extensions to the `My` namespace enables you to more easily discover and consume types that fall into this category. An example of a factory method that works well is `My.Computer.FileSystem.OpenTextFileReader`. There are several stream types available in the .NET Framework. By specifying text files specifically, the `OpenTextFileReader` helps the user understand which stream to use.  \n  \n These guidelines do not preclude general design principles for class libraries. Rather, they are recommendations that are optimized for developers who are using Visual Basic and the `My` namespace. For general design principles for creating class libraries, see [Framework Design Guidelines](../../../standard/design-guidelines/index.md).  \n  \n## <a name=\"packaging\"></a> Packaging and Deploying Extensions  \n You can include `My` namespace extensions in a Visual Studio project template, or you can package your extensions and deploy them as a Visual Studio item template. When you package your `My` namespace extensions as a Visual Studio item template, you can take advantage of additional capabilities provided by Visual Basic. These capabilities enable you to include an extension when a project references a particular assembly, or enable users to explicitly add your `My` namespace extension by using the **My Extensions** page of the Visual Basic Project Designer.  \n  \n For details about how to deploy `My` namespace extensions, see [Packaging and Deploying Custom My Extensions](../../../visual-basic/developing-apps/customizing-extending-my/packaging-and-deploying-custom-my-extensions.md).  \n  \n## See also\n\n- [Packaging and Deploying Custom My Extensions](../../../visual-basic/developing-apps/customizing-extending-my/packaging-and-deploying-custom-my-extensions.md)\n- [Extending the Visual Basic Application Model](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-visual-basic-application-model.md)\n- [Customizing Which Objects are Available in My](../../../visual-basic/developing-apps/customizing-extending-my/customizing-which-objects-are-available-in-my.md)\n- [My Extensions Page, Project Designer](/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic)\n- [Application Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/application-page-project-designer-visual-basic)\n- [Partial](../../../visual-basic/language-reference/modifiers/partial.md)\n","nodes":[{"pos":[4,299],"embed":true,"restype":"x-metadata","content":"title: \"Extending the My Namespace in Visual Basic\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.AddingMyExtensions\"\nhelpviewer_keywords: \n  - \"My namespace [Visual Basic], customizing\"\n  - \"My namespace\"\n  - \"My namespace [Visual Basic], extending\"\nms.assetid: 808e8617-b01c-4135-8b21-babe87389e8e","nodes":[{"content":"Extending the My Namespace in Visual Basic","nodes":[{"pos":[0,42],"content":"Extending the My Namespace in Visual Basic","nodes":[{"content":"Extending the My Namespace in Visual Basic","pos":[0,42]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[306,348],"content":"Extending the My Namespace in Visual Basic","linkify":"Extending the My Namespace in Visual Basic","nodes":[{"content":"Extending the My Namespace in Visual Basic","pos":[0,42]}]},{"content":"The <ph id=\"ph1\">`My`</ph> namespace in Visual Basic exposes properties and methods that enable you to easily take advantage of the power of the .NET Framework.","pos":[349,491],"source":"The `My` namespace in Visual Basic exposes properties and methods that enable you to easily take advantage of the power of the .NET Framework."},{"content":"The <ph id=\"ph1\">`My`</ph> namespace simplifies common programming problems, often reducing a difficult task to a single line of code.","pos":[492,608],"source":" The `My` namespace simplifies common programming problems, often reducing a difficult task to a single line of code."},{"content":"Additionally, the <ph id=\"ph1\">`My`</ph> namespace is fully extensible so that you can customize the behavior of <ph id=\"ph2\">`My`</ph> and add new services to its hierarchy to adapt to specific application needs.","pos":[609,786],"source":" Additionally, the `My` namespace is fully extensible so that you can customize the behavior of `My` and add new services to its hierarchy to adapt to specific application needs."},{"content":"This topic discusses both how to customize existing members of the <ph id=\"ph1\">`My`</ph> namespace and how to add your own custom classes to the <ph id=\"ph2\">`My`</ph> namespace.","pos":[787,930],"source":" This topic discusses both how to customize existing members of the `My` namespace and how to add your own custom classes to the `My` namespace."},{"pos":[937,955],"content":"<bpt id=\"p1\">**</bpt>Topic Contents<ept id=\"p1\">**</ept>","source":"**Topic Contents**"},{"pos":[965,1022],"content":"<bpt id=\"p1\">[</bpt>Customizing Existing My Namespace Members<ept id=\"p1\">](#customizing)</ept>","source":"[Customizing Existing My Namespace Members](#customizing)"},{"pos":[1032,1080],"content":"<bpt id=\"p1\">[</bpt>Adding Members to My Objects<ept id=\"p1\">](#addingtoobjects)</ept>","source":"[Adding Members to My Objects](#addingtoobjects)"},{"pos":[1090,1148],"content":"<bpt id=\"p1\">[</bpt>Adding Custom Objects to the My Namespace<ept id=\"p1\">](#addingcustom)</ept>","source":"[Adding Custom Objects to the My Namespace](#addingcustom)"},{"pos":[1158,1214],"content":"<bpt id=\"p1\">[</bpt>Adding Members to the My Namespace<ept id=\"p1\">](#addingtonamespace)</ept>","source":"[Adding Members to the My Namespace](#addingtonamespace)"},{"pos":[1224,1275],"content":"<bpt id=\"p1\">[</bpt>Adding Events to Custom My Objects<ept id=\"p1\">](#addingevents)</ept>","source":"[Adding Events to Custom My Objects](#addingevents)"},{"pos":[1285,1313],"content":"<bpt id=\"p1\">[</bpt>Design Guidelines<ept id=\"p1\">](#design)</ept>","source":"[Design Guidelines](#design)"},{"pos":[1323,1369],"content":"<bpt id=\"p1\">[</bpt>Designing Class Libraries for My<ept id=\"p1\">](#designing)</ept>","source":"[Designing Class Libraries for My](#designing)"},{"pos":[1379,1427],"content":"<bpt id=\"p1\">[</bpt>Packaging and Deploying Extensions<ept id=\"p1\">](#packaging)</ept>","source":"[Packaging and Deploying Extensions](#packaging)"},{"pos":[1436,1504],"content":"<bpt id=\"p1\">&lt;a name=\"customizing\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Customizing Existing My Namespace Members","linkify":"<a name=\"customizing\"></a> Customizing Existing My Namespace Members","source":"<a name=\"customizing\"></a> Customizing Existing My Namespace Members"},{"content":"The <ph id=\"ph1\">`My`</ph> namespace in Visual Basic exposes frequently used information about your application, your computer, and more.","pos":[1508,1627],"source":"The `My` namespace in Visual Basic exposes frequently used information about your application, your computer, and more."},{"content":"For a complete list of the objects in the <ph id=\"ph1\">`My`</ph> namespace, see <bpt id=\"p1\">[</bpt>My Reference<ept id=\"p1\">](../../../visual-basic/language-reference/keywords/my-reference.md)</ept>.","pos":[1628,1772],"source":" For a complete list of the objects in the `My` namespace, see [My Reference](../../../visual-basic/language-reference/keywords/my-reference.md)."},{"content":"You may have to customize existing members of the <ph id=\"ph1\">`My`</ph> namespace so that they better match the needs of your application.","pos":[1773,1894],"source":" You may have to customize existing members of the `My` namespace so that they better match the needs of your application."},{"content":"Any property of an object in the <ph id=\"ph1\">`My`</ph> namespace that is not read-only can be set to a custom value.","pos":[1895,1994],"source":" Any property of an object in the `My` namespace that is not read-only can be set to a custom value."},{"content":"For example, assume that you frequently use the <ph id=\"ph1\">`My.User`</ph> object to access the current security context for the user running your application.","pos":[2001,2143],"source":"For example, assume that you frequently use the `My.User` object to access the current security context for the user running your application."},{"content":"However, your company uses a custom user object to expose additional information and capabilities for users within the company.","pos":[2144,2271]},{"content":"In this scenario, you can replace the default value of the <ph id=\"ph1\">`My.User.CurrentPrincipal`</ph> property with an instance of your own custom principal object, as shown in the following example.","pos":[2272,2455],"source":" In this scenario, you can replace the default value of the `My.User.CurrentPrincipal` property with an instance of your own custom principal object, as shown in the following example."},{"content":"Setting the <ph id=\"ph1\">`CurrentPrincipal`</ph> property on the <ph id=\"ph2\">`My.User`</ph> object changes the identity under which the application runs.","pos":[2586,2704],"source":"Setting the `CurrentPrincipal` property on the `My.User` object changes the identity under which the application runs."},{"content":"The <ph id=\"ph1\">`My.User`</ph> object, in turn, returns information about the newly specified user.","pos":[2705,2787],"source":" The `My.User` object, in turn, returns information about the newly specified user."},{"pos":[2796,2855],"content":"<bpt id=\"p1\">&lt;a name=\"addingtoobjects\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Adding Members to My Objects","linkify":"<a name=\"addingtoobjects\"></a> Adding Members to My Objects","source":"<a name=\"addingtoobjects\"></a> Adding Members to My Objects"},{"content":"The types returned from <ph id=\"ph1\">`My.Application`</ph> and <ph id=\"ph2\">`My.Computer`</ph> are defined as <ph id=\"ph3\">`Partial`</ph> classes.","pos":[2859,2951],"source":"The types returned from `My.Application` and `My.Computer` are defined as `Partial` classes."},{"content":"Therefore, you can extend the <ph id=\"ph1\">`My.Application`</ph> and <ph id=\"ph2\">`My.Computer`</ph> objects by creating a <ph id=\"ph3\">`Partial`</ph> class named <ph id=\"ph4\">`MyApplication`</ph> or <ph id=\"ph5\">`MyComputer`</ph>.","pos":[2952,3093],"source":" Therefore, you can extend the `My.Application` and `My.Computer` objects by creating a `Partial` class named `MyApplication` or `MyComputer`."},{"content":"The class cannot be a <ph id=\"ph1\">`Private`</ph> class.","pos":[3094,3132],"source":" The class cannot be a `Private` class."},{"content":"If you specify the class as part of the <ph id=\"ph1\">`My`</ph> namespace, you can add properties and methods that will be included with the <ph id=\"ph2\">`My.Application`</ph> or <ph id=\"ph3\">`My.Computer`</ph> objects.","pos":[3133,3297],"source":" If you specify the class as part of the `My` namespace, you can add properties and methods that will be included with the `My.Application` or `My.Computer` objects."},{"pos":[3304,3412],"content":"For example, the following example adds a property named <ph id=\"ph1\">`DnsServerIPAddresses`</ph> to the <ph id=\"ph2\">`My.Computer`</ph> object.","source":"For example, the following example adds a property named `DnsServerIPAddresses` to the `My.Computer` object."},{"pos":[3545,3614],"content":"<bpt id=\"p1\">&lt;a name=\"addingcustom\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Adding Custom Objects to the My Namespace","linkify":"<a name=\"addingcustom\"></a> Adding Custom Objects to the My Namespace","source":"<a name=\"addingcustom\"></a> Adding Custom Objects to the My Namespace"},{"content":"Although the <ph id=\"ph1\">`My`</ph> namespace provides solutions for many common programming tasks, you may encounter tasks that the <ph id=\"ph2\">`My`</ph> namespace does not address.","pos":[3618,3765],"source":"Although the `My` namespace provides solutions for many common programming tasks, you may encounter tasks that the `My` namespace does not address."},{"content":"For example, your application might access custom directory services for user data, or your application might use assemblies that are not installed by default with Visual Basic.","pos":[3766,3943]},{"content":"You can extend the <ph id=\"ph1\">`My`</ph> namespace to include custom solutions to common tasks that are specific to your environment.","pos":[3944,4060],"source":" You can extend the `My` namespace to include custom solutions to common tasks that are specific to your environment."},{"content":"The <ph id=\"ph1\">`My`</ph> namespace can easily be extended to add new members to meet growing application needs.","pos":[4061,4156],"source":" The `My` namespace can easily be extended to add new members to meet growing application needs."},{"content":"Additionally, you can deploy your <ph id=\"ph1\">`My`</ph> namespace extensions to other developers as a Visual Basic template.","pos":[4157,4264],"source":" Additionally, you can deploy your `My` namespace extensions to other developers as a Visual Basic template."},{"pos":[4274,4341],"content":"<bpt id=\"p1\">&lt;a name=\"addingtonamespace\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Adding Members to the My Namespace","linkify":"<a name=\"addingtonamespace\"></a> Adding Members to the My Namespace","source":"<a name=\"addingtonamespace\"></a> Adding Members to the My Namespace"},{"content":"Because <ph id=\"ph1\">`My`</ph> is a namespace like any other namespace, you can add top-level properties to it by just adding a module and specifying a <ph id=\"ph2\">`Namespace`</ph> of <ph id=\"ph3\">`My`</ph>.","pos":[4345,4499],"source":"Because `My` is a namespace like any other namespace, you can add top-level properties to it by just adding a module and specifying a `Namespace` of `My`."},{"content":"Annotate the module with the <ph id=\"ph1\">`HideModuleName`</ph> attribute as shown in the following example.","pos":[4500,4590],"source":" Annotate the module with the `HideModuleName` attribute as shown in the following example."},{"content":"The <ph id=\"ph1\">`HideModuleName`</ph> attribute ensures that IntelliSense will not display the module name when it displays the members of the <ph id=\"ph2\">`My`</ph> namespace.","pos":[4591,4732],"source":" The `HideModuleName` attribute ensures that IntelliSense will not display the module name when it displays the members of the `My` namespace."},{"content":"To add members to the <ph id=\"ph1\">`My`</ph> namespace, add properties as needed to the module.","pos":[4863,4940],"source":"To add members to the `My` namespace, add properties as needed to the module."},{"content":"For each property added to the <ph id=\"ph1\">`My`</ph> namespace, add a private field of type <ph id=\"ph2\">`ThreadSafeObjectProvider(Of T)`</ph>, where the type is the type returned by your custom property.","pos":[4941,5110],"source":" For each property added to the `My` namespace, add a private field of type `ThreadSafeObjectProvider(Of T)`, where the type is the type returned by your custom property."},{"content":"This field is used to create thread-safe object instances to be returned by the property by calling the <ph id=\"ph1\">`GetInstance`</ph> method.","pos":[5111,5236],"source":" This field is used to create thread-safe object instances to be returned by the property by calling the `GetInstance` method."},{"content":"As a result, each thread that is accessing the extended property receives its own instance of the returned type.","pos":[5237,5349]},{"content":"The following example adds a property named <ph id=\"ph1\">`SampleExtension`</ph> that is of type <ph id=\"ph2\">`SampleExtension`</ph> to the <ph id=\"ph3\">`My`</ph> namespace:","pos":[5350,5468],"source":" The following example adds a property named `SampleExtension` that is of type `SampleExtension` to the `My` namespace:"},{"pos":[5601,5663],"content":"<bpt id=\"p1\">&lt;a name=\"addingevents\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Adding Events to Custom My Objects","linkify":"<a name=\"addingevents\"></a> Adding Events to Custom My Objects","source":"<a name=\"addingevents\"></a> Adding Events to Custom My Objects"},{"content":"You can use the <ph id=\"ph1\">`My.Application`</ph> object to expose events for your custom <ph id=\"ph2\">`My`</ph> objects by extending the <ph id=\"ph3\">`MyApplication`</ph> partial class in the <ph id=\"ph4\">`My`</ph> namespace.","pos":[5667,5822],"source":"You can use the `My.Application` object to expose events for your custom `My` objects by extending the `MyApplication` partial class in the `My` namespace."},{"content":"For Windows-based projects, you can double-click the <bpt id=\"p1\">**</bpt>My Project<ept id=\"p1\">**</ept> node in for your project in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept>.","pos":[5823,5941],"source":" For Windows-based projects, you can double-click the **My Project** node in for your project in **Solution Explorer**."},{"content":"In the Visual Basic <bpt id=\"p1\">**</bpt>Project Designer<ept id=\"p1\">**</ept>, click the <ph id=\"ph1\">`Application`</ph> tab and then click the <ph id=\"ph2\">`View Application Events`</ph> button.","pos":[5942,6064],"source":" In the Visual Basic **Project Designer**, click the `Application` tab and then click the `View Application Events` button."},{"content":"A new file that is named ApplicationEvents.vb will be created.","pos":[6065,6127]},{"content":"It contains the following code for extending the <ph id=\"ph1\">`MyApplication`</ph> class.","pos":[6128,6199],"source":" It contains the following code for extending the `MyApplication` class."},{"content":"You can add event handlers for your custom <ph id=\"ph1\">`My`</ph> objects by adding custom event handlers to the <ph id=\"ph2\">`MyApplication`</ph> class.","pos":[6330,6447],"source":"You can add event handlers for your custom `My` objects by adding custom event handlers to the `MyApplication` class."},{"content":"Custom events enable you to add code that will execute when an event handler is added, removed, or the event is raised.","pos":[6448,6567]},{"content":"Note that the <ph id=\"ph1\">`AddHandler`</ph> code for a custom event runs only if code is added by a user to handle the event.","pos":[6568,6676],"source":" Note that the `AddHandler` code for a custom event runs only if code is added by a user to handle the event."},{"content":"For example, consider that the <ph id=\"ph1\">`SampleExtension`</ph> object from the previous section has a <ph id=\"ph2\">`Load`</ph> event that you want to add a custom event handler for.","pos":[6677,6826],"source":" For example, consider that the `SampleExtension` object from the previous section has a `Load` event that you want to add a custom event handler for."},{"content":"The following code example shows a custom event handler named <ph id=\"ph1\">`SampleExtensionLoad`</ph> that will be invoked when the <ph id=\"ph2\">`My.SampleExtension.Load`</ph> event occurs.","pos":[6827,6980],"source":" The following code example shows a custom event handler named `SampleExtensionLoad` that will be invoked when the `My.SampleExtension.Load` event occurs."},{"content":"When code is added to handle the new <ph id=\"ph1\">`My.SampleExtensionLoad`</ph> event, the <ph id=\"ph2\">`AddHandler`</ph> part of this custom event code is executed.","pos":[6981,7110],"source":" When code is added to handle the new `My.SampleExtensionLoad` event, the `AddHandler` part of this custom event code is executed."},{"content":"The <ph id=\"ph1\">`MyApplication_SampleExtensionLoad`</ph> method is included in the code example to show an example of an event handler that handles the <ph id=\"ph2\">`My.SampleExtensionLoad`</ph> event.","pos":[7111,7277],"source":" The `MyApplication_SampleExtensionLoad` method is included in the code example to show an example of an event handler that handles the `My.SampleExtensionLoad` event."},{"content":"Note that the <ph id=\"ph1\">`SampleExtensionLoad`</ph> event will be available when you select the <bpt id=\"p1\">**</bpt>My Application Events<ept id=\"p1\">**</ept> option in the left drop-down list above the Code Editor when you are editing the ApplicationEvents.vb file.","pos":[7278,7491],"source":" Note that the `SampleExtensionLoad` event will be available when you select the **My Application Events** option in the left drop-down list above the Code Editor when you are editing the ApplicationEvents.vb file."},{"pos":[7624,7663],"content":"<bpt id=\"p1\">&lt;a name=\"design\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Design Guidelines","linkify":"<a name=\"design\"></a> Design Guidelines","source":"<a name=\"design\"></a> Design Guidelines"},{"pos":[7667,7815],"content":"When you develop extensions to the <ph id=\"ph1\">`My`</ph> namespace, use the following guidelines to help minimize the maintenance costs of your extension components.","source":"When you develop extensions to the `My` namespace, use the following guidelines to help minimize the maintenance costs of your extension components."},{"content":"<bpt id=\"p1\">**</bpt>Include only the extension logic.<ept id=\"p1\">**</ept>","pos":[7825,7862],"source":"**Include only the extension logic.**"},{"content":"The logic included in the <ph id=\"ph1\">`My`</ph> namespace extension should include only the code that is needed to expose the required functionality in the <ph id=\"ph2\">`My`</ph> namespace.","pos":[7863,8017],"source":" The logic included in the `My` namespace extension should include only the code that is needed to expose the required functionality in the `My` namespace."},{"content":"Because your extension will reside in user projects as source code, updating the extension component incurs a high maintenance cost and should be avoided if possible.","pos":[8018,8184]},{"content":"<bpt id=\"p1\">**</bpt>Minimize project assumptions.<ept id=\"p1\">**</ept>","pos":[8194,8227],"source":"**Minimize project assumptions.**"},{"content":"When you create your extensions of the <ph id=\"ph1\">`My`</ph> namespace, do not assume a set of references, project-level imports, or specific compiler settings (for example, <ph id=\"ph2\">`Option Strict`</ph> off).","pos":[8228,8406],"source":" When you create your extensions of the `My` namespace, do not assume a set of references, project-level imports, or specific compiler settings (for example, `Option Strict` off)."},{"content":"Instead, minimize dependencies and fully qualify all type references by using the <ph id=\"ph1\">`Global`</ph> keyword.","pos":[8407,8506],"source":" Instead, minimize dependencies and fully qualify all type references by using the `Global` keyword."},{"content":"Also, ensure that the extension compiles with <ph id=\"ph1\">`Option Strict`</ph> on to minimize errors in the extension.","pos":[8507,8608],"source":" Also, ensure that the extension compiles with `Option Strict` on to minimize errors in the extension."},{"content":"<bpt id=\"p1\">**</bpt>Isolate the extension code.<ept id=\"p1\">**</ept>","pos":[8618,8649],"source":"**Isolate the extension code.**"},{"content":"Placing the code in a single file makes your extension easily deployable as a Visual Studio item template.","pos":[8650,8756]},{"content":"For more information, see \"Packaging and Deploying Extensions\" later in this topic.","pos":[8757,8840]},{"content":"Placing all the <ph id=\"ph1\">`My`</ph> namespace extension code in a single file or a separate folder in a project will also help users locate the <ph id=\"ph2\">`My`</ph> namespace extension.","pos":[8841,8995],"source":" Placing all the `My` namespace extension code in a single file or a separate folder in a project will also help users locate the `My` namespace extension."},{"pos":[9004,9061],"content":"<bpt id=\"p1\">&lt;a name=\"designing\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Designing Class Libraries for My","linkify":"<a name=\"designing\"></a> Designing Class Libraries for My","source":"<a name=\"designing\"></a> Designing Class Libraries for My"},{"content":"As is the case with most object models, some design patterns work well in the <ph id=\"ph1\">`My`</ph> namespace and others do not.","pos":[9065,9176],"source":"As is the case with most object models, some design patterns work well in the `My` namespace and others do not."},{"content":"When designing an extension to the <ph id=\"ph1\">`My`</ph> namespace, consider the following principles:","pos":[9177,9262],"source":" When designing an extension to the `My` namespace, consider the following principles:"},{"content":"<bpt id=\"p1\">**</bpt>Stateless methods.<ept id=\"p1\">**</ept>","pos":[9272,9294],"source":"**Stateless methods.**"},{"content":"Methods in the <ph id=\"ph1\">`My`</ph> namespace should provide a complete solution to a specific task.","pos":[9295,9379],"source":" Methods in the `My` namespace should provide a complete solution to a specific task."},{"content":"Ensure that the parameter values that are passed to the method provide all the input required to complete the particular task.","pos":[9380,9506]},{"content":"Avoid creating methods that rely on prior state, such as open connections to resources.","pos":[9507,9594]},{"content":"<bpt id=\"p1\">**</bpt>Global instances.<ept id=\"p1\">**</ept>","pos":[9604,9625],"source":"**Global instances.**"},{"content":"The only state that is maintained in the <ph id=\"ph1\">`My`</ph> namespace is global to the project.","pos":[9626,9707],"source":" The only state that is maintained in the `My` namespace is global to the project."},{"content":"For example, <ph id=\"ph1\">`My.Application.Info`</ph> encapsulates state that is shared throughout the application.","pos":[9708,9804],"source":" For example, `My.Application.Info` encapsulates state that is shared throughout the application."},{"content":"<bpt id=\"p1\">**</bpt>Simple parameter types.<ept id=\"p1\">**</ept>","pos":[9814,9841],"source":"**Simple parameter types.**"},{"content":"Keep things simple by avoiding complex parameter types.","pos":[9842,9897]},{"content":"Instead, create methods that either take no parameter input or that take simple input types such as strings, primitive types, and so on.","pos":[9898,10034]},{"content":"<bpt id=\"p1\">**</bpt>Factory methods.<ept id=\"p1\">**</ept>","pos":[10044,10064],"source":"**Factory methods.**"},{"content":"Some types are necessarily difficult to instantiate.","pos":[10065,10117]},{"content":"Providing factory methods as extensions to the <ph id=\"ph1\">`My`</ph> namespace enables you to more easily discover and consume types that fall into this category.","pos":[10118,10263],"source":" Providing factory methods as extensions to the `My` namespace enables you to more easily discover and consume types that fall into this category."},{"content":"An example of a factory method that works well is <ph id=\"ph1\">`My.Computer.FileSystem.OpenTextFileReader`</ph>.","pos":[10264,10358],"source":" An example of a factory method that works well is `My.Computer.FileSystem.OpenTextFileReader`."},{"content":"There are several stream types available in the .NET Framework.","pos":[10359,10422]},{"content":"By specifying text files specifically, the <ph id=\"ph1\">`OpenTextFileReader`</ph> helps the user understand which stream to use.","pos":[10423,10533],"source":" By specifying text files specifically, the `OpenTextFileReader` helps the user understand which stream to use."},{"content":"These guidelines do not preclude general design principles for class libraries.","pos":[10540,10619]},{"content":"Rather, they are recommendations that are optimized for developers who are using Visual Basic and the <ph id=\"ph1\">`My`</ph> namespace.","pos":[10620,10737],"source":" Rather, they are recommendations that are optimized for developers who are using Visual Basic and the `My` namespace."},{"content":"For general design principles for creating class libraries, see <bpt id=\"p1\">[</bpt>Framework Design Guidelines<ept id=\"p1\">](../../../standard/design-guidelines/index.md)</ept>.","pos":[10738,10878],"source":" For general design principles for creating class libraries, see [Framework Design Guidelines](../../../standard/design-guidelines/index.md)."},{"pos":[10887,10946],"content":"<bpt id=\"p1\">&lt;a name=\"packaging\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Packaging and Deploying Extensions","linkify":"<a name=\"packaging\"></a> Packaging and Deploying Extensions","source":"<a name=\"packaging\"></a> Packaging and Deploying Extensions"},{"content":"You can include <ph id=\"ph1\">`My`</ph> namespace extensions in a Visual Studio project template, or you can package your extensions and deploy them as a Visual Studio item template.","pos":[10950,11113],"source":"You can include `My` namespace extensions in a Visual Studio project template, or you can package your extensions and deploy them as a Visual Studio item template."},{"content":"When you package your <ph id=\"ph1\">`My`</ph> namespace extensions as a Visual Studio item template, you can take advantage of additional capabilities provided by Visual Basic.","pos":[11114,11271],"source":" When you package your `My` namespace extensions as a Visual Studio item template, you can take advantage of additional capabilities provided by Visual Basic."},{"content":"These capabilities enable you to include an extension when a project references a particular assembly, or enable users to explicitly add your <ph id=\"ph1\">`My`</ph> namespace extension by using the <bpt id=\"p1\">**</bpt>My Extensions<ept id=\"p1\">**</ept> page of the Visual Basic Project Designer.","pos":[11272,11512],"source":" These capabilities enable you to include an extension when a project references a particular assembly, or enable users to explicitly add your `My` namespace extension by using the **My Extensions** page of the Visual Basic Project Designer."},{"pos":[11519,11741],"content":"For details about how to deploy <ph id=\"ph1\">`My`</ph> namespace extensions, see <bpt id=\"p1\">[</bpt>Packaging and Deploying Custom My Extensions<ept id=\"p1\">](../../../visual-basic/developing-apps/customizing-extending-my/packaging-and-deploying-custom-my-extensions.md)</ept>.","source":"For details about how to deploy `My` namespace extensions, see [Packaging and Deploying Custom My Extensions](../../../visual-basic/developing-apps/customizing-extending-my/packaging-and-deploying-custom-my-extensions.md)."},{"pos":[11750,11758],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[11762,11920],"content":"<bpt id=\"p1\">[</bpt>Packaging and Deploying Custom My Extensions<ept id=\"p1\">](../../../visual-basic/developing-apps/customizing-extending-my/packaging-and-deploying-custom-my-extensions.md)</ept>","source":"[Packaging and Deploying Custom My Extensions](../../../visual-basic/developing-apps/customizing-extending-my/packaging-and-deploying-custom-my-extensions.md)"},{"pos":[11923,12081],"content":"<bpt id=\"p1\">[</bpt>Extending the Visual Basic Application Model<ept id=\"p1\">](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-visual-basic-application-model.md)</ept>","source":"[Extending the Visual Basic Application Model](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-visual-basic-application-model.md)"},{"pos":[12084,12244],"content":"<bpt id=\"p1\">[</bpt>Customizing Which Objects are Available in My<ept id=\"p1\">](../../../visual-basic/developing-apps/customizing-extending-my/customizing-which-objects-are-available-in-my.md)</ept>","source":"[Customizing Which Objects are Available in My](../../../visual-basic/developing-apps/customizing-extending-my/customizing-which-objects-are-available-in-my.md)"},{"pos":[12247,12363],"content":"<bpt id=\"p1\">[</bpt>My Extensions Page, Project Designer<ept id=\"p1\">](/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic)</ept>","source":"[My Extensions Page, Project Designer](/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic)"},{"pos":[12366,12493],"content":"<bpt id=\"p1\">[</bpt>Application Page, Project Designer (Visual Basic)<ept id=\"p1\">](/visualstudio/ide/reference/application-page-project-designer-visual-basic)</ept>","source":"[Application Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/application-page-project-designer-visual-basic)"},{"pos":[12496,12568],"content":"<bpt id=\"p1\">[</bpt>Partial<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/partial.md)</ept>","source":"[Partial](../../../visual-basic/language-reference/modifiers/partial.md)"}]}