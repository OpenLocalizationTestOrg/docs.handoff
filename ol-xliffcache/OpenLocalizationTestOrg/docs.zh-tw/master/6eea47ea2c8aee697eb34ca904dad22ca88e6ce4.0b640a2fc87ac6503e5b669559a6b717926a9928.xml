{"content":"---\ntitle: \"How to: Declare Custom Events To Avoid Blocking (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"declaring events [Visual Basic], custom\"\n  - \"events [Visual Basic], custom\"\n  - \"custom events [Visual Basic]\"\nms.assetid: 998b6a90-67c5-4d2c-8b11-366d3e355505\n---\n# How to: Declare Custom Events To Avoid Blocking (Visual Basic)\nThere are several circumstances when it is important that one event handler not block subsequent event handlers. Custom events allow the event to call its event handlers asynchronously.  \n  \n By default, the backing-store field for an event declaration is a multicast delegate that serially combines all the event handlers. This means that if one handler takes a long time to complete, it blocks the other handlers until it completes. (Well-behaved event handlers should never perform lengthy or potentially blocking operations.)  \n  \n Instead of using the default implementation of events that Visual Basic provides, you can use a custom event to execute the event handlers asynchronously.  \n  \n## Example  \n In this example, the `AddHandler` accessor adds the delegate for each handler of the `Click` event to an <xref:System.Collections.ArrayList> stored in the `EventHandlerList` field.  \n  \n When code raises the `Click` event, the `RaiseEvent` accessor invokes all the event handler delegates asynchronously using the <xref:System.Web.Services.Protocols.LogicalMethodInfo.BeginInvoke%2A> method. That method invokes each handler on a worker thread and returns immediately, so handlers cannot block one another.  \n  \n [!code-vb[VbVbalrEvents#27](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class1.vb#27)]  \n  \n## See also\n\n- <xref:System.Collections.ArrayList>\n- <xref:System.Web.Services.Protocols.LogicalMethodInfo.BeginInvoke%2A>\n- [Events](../../../../visual-basic/programming-guide/language-features/events/index.md)\n- [How to: Declare Custom Events To Conserve Memory](../../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md)\n","nodes":[{"pos":[4,283],"embed":true,"restype":"x-metadata","content":"title: \"How to: Declare Custom Events To Avoid Blocking (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"declaring events [Visual Basic], custom\"\n  - \"events [Visual Basic], custom\"\n  - \"custom events [Visual Basic]\"\nms.assetid: 998b6a90-67c5-4d2c-8b11-366d3e355505","nodes":[{"content":"How to: Declare Custom Events To Avoid Blocking (Visual Basic)","nodes":[{"pos":[0,62],"content":"How to: Declare Custom Events To Avoid Blocking (Visual Basic)","nodes":[{"content":"How to: Declare Custom Events To Avoid Blocking (Visual Basic)","pos":[0,62]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[290,352],"content":"How to: Declare Custom Events To Avoid Blocking (Visual Basic)","linkify":"How to: Declare Custom Events To Avoid Blocking (Visual Basic)","nodes":[{"content":"How to: Declare Custom Events To Avoid Blocking (Visual Basic)","pos":[0,62]}]},{"content":"There are several circumstances when it is important that one event handler not block subsequent event handlers.","pos":[353,465]},{"content":"Custom events allow the event to call its event handlers asynchronously.","pos":[466,538]},{"content":"By default, the backing-store field for an event declaration is a multicast delegate that serially combines all the event handlers.","pos":[545,676]},{"content":"This means that if one handler takes a long time to complete, it blocks the other handlers until it completes.","pos":[677,787]},{"content":"(Well-behaved event handlers should never perform lengthy or potentially blocking operations.)","pos":[788,882]},{"content":"Instead of using the default implementation of events that Visual Basic provides, you can use a custom event to execute the event handlers asynchronously.","pos":[889,1043]},{"pos":[1052,1059],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1063,1243],"content":"In this example, the <ph id=\"ph1\">`AddHandler`</ph> accessor adds the delegate for each handler of the <ph id=\"ph2\">`Click`</ph> event to an <ph id=\"ph3\">&lt;xref:System.Collections.ArrayList&gt;</ph> stored in the <ph id=\"ph4\">`EventHandlerList`</ph> field.","source":"In this example, the `AddHandler` accessor adds the delegate for each handler of the `Click` event to an <xref:System.Collections.ArrayList> stored in the `EventHandlerList` field."},{"content":"When code raises the <ph id=\"ph1\">`Click`</ph> event, the <ph id=\"ph2\">`RaiseEvent`</ph> accessor invokes all the event handler delegates asynchronously using the <ph id=\"ph3\">&lt;xref:System.Web.Services.Protocols.LogicalMethodInfo.BeginInvoke%2A&gt;</ph> method.","pos":[1250,1454],"source":"When code raises the `Click` event, the `RaiseEvent` accessor invokes all the event handler delegates asynchronously using the <xref:System.Web.Services.Protocols.LogicalMethodInfo.BeginInvoke%2A> method."},{"content":"That method invokes each handler on a worker thread and returns immediately, so handlers cannot block one another.","pos":[1455,1569]},{"pos":[1696,1704],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1818,1904],"content":"<bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/events/index.md)</ept>","source":"[Events](../../../../visual-basic/programming-guide/language-features/events/index.md)"},{"pos":[1907,2077],"content":"<bpt id=\"p1\">[</bpt>How to: Declare Custom Events To Conserve Memory<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md)</ept>","source":"[How to: Declare Custom Events To Conserve Memory](../../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md)"}]}