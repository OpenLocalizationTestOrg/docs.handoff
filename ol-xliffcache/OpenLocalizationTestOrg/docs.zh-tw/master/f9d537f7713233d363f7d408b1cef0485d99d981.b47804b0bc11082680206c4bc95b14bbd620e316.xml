{"content":"---\ntitle: PutClassWmi function (Unmanaged API Reference)\ndescription: The PutClassWmi function creates a new class or updates an existing one.\nms.date: \"11/06/2017\"\napi_name:\n  - \"PutClassWmi\"\napi_location:\n  - \"WMINet_Utils.dll\"\napi_type:\n  - \"DLLExport\"\nf1_keywords:\n  - \"PutClassWmi\"\nhelpviewer_keywords:\n  - \"PutClassWmi function [.NET WMI and performance counters]\"\ntopic_type:\n  - \"Reference\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n\n# PutClassWmi function\n\nCreates a new class or updates an existing one.\n\n[!INCLUDE[internalonly-unmanaged](../../../../includes/internalonly-unmanaged.md)]\n\n## Syntax\n\n```cpp\nHRESULT PutClassWmi (\n   [in] IWbemClassObject*    pObject,\n   [in] long                 lFlags,\n   [in] IWbemContext*        pCtx,\n   [out] IWbemCallResult**   ppCallResult\n);\n```\n\n## Parameters\n\n`pObject`\\\n[in] A pointer to a valid class definition. It must be correctly initialized with all the required property values.\n\n`lFlags`\\\n[in] A combination of flags that affect the behavior of this function. The following values are defined in the *WbemCli.h* header file, or you can define them as constants in your code:\n\n|Constant  |Value  |Description  |\n|---------|---------|---------|\n| `WBEM_FLAG_USE_AMENDED_QUALIFIERS` | 0x20000 | If set, WMI does not store any qualifiers with the amended flavor. <br> If not set, it is assumed that this object is not localized, and all qualifiers are stored with this instance. |\n| `WBEM_FLAG_CREATE_OR_UPDATE` | 0 | Create the class if it does not exist, or overwrite it if it exists already. |\n| `WBEM_FLAG_UPDATE_ONLY` | 1 | Update the class. The class must exist for the call to be successful. |\n| `WBEM_FLAG_CREATE_ONLY` | 2 | Create the class. The call fails if the class already exists. |\n| `WBEM_FLAG_RETURN_IMMEDIATELY` | 0x10 | The flag causes a semisynchronous call. |\n| `WBEM_FLAG_OWNER_UPDATE` | 0x10000 | Push providers must specify this flag when calling `PutClassWmi` to indicate that this class has changed. |\n| `WBEM_FLAG_UPDATE_COMPATIBLE` | 0 | Allows a class to be updated if there are no derived classes and no instances of that class. It also allows updates in all cases if the change is just to unimportant qualifiers, such as the Description qualifier. If the class has instances or changes are to important qualifiers, the update fails. |\n| `WBEM_FLAG_UPDATE_SAFE_MODE` | 0x20 | Allows updates of classes even if there are child classes as long as the change does not cause any conflicts with child classes. For example, this flag allows a new property to be added to the base class that was not previously mentioned in any of the child classes. If the class has instances, the update fails. |\n| `WBEM_FLAG_UPDATE_FORCE_MODE` | 0x40 | forces updates of classes when conflicting child classes exist. For example, this flag forces an update if a class qualifier is defined in a child class, and the base class tries to add the same qualifier which conflicts with the existing one. In force mode, tis conflict is resolved by deleting the conflicting qualifier in the child class. |\n\n`pCtx`\\\n[in] Typically, this value is `null`. Otherwise, it is a pointer to an [IWbemContext](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcontext) instance that can be used by the provider that is providing the requested classes.\n\n`ppCallResult`\\\n[out] If `null`, this parameter is unused. If `lFlags` contains `WBEM_FLAG_RETURN_IMMEDIATELY`, the function returns immediately with `WBEM_S_NO_ERROR`. The `ppCallResult` parameter receives a pointer to a new [IWbemCallResult](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcallresult) object.\n\n## Return value\n\nThe following values returned by this function are defined in the *WbemCli.h* header file, or you can define them as constants in your code:\n\n|Constant  |Value  |Description  |\n|---------|---------|---------|\n| `WBEM_E_ACCESS_DENIED` | 0x80041003 | The user does not have permission to create or modify classes. |\n| `WBEM_E_FAILED` | 0x80041001 | An unspecified error has occurred. |\n| `WBEM_E_INVALID_CLASS` | 0x80041010 | The specified class is not valid. Typically, this indicates that `pObject` specifies an instance object. |\n| `WBEM_E_INVALID_PARAMETER` | 0x80041008 | A parameter is not valid. |\n| `WBEM_E_INVALID OPERATION` | 0x80041016 | The specified class name is not valid. |\n| `WBEM_E_CLASS_HAS_CHILDREN` | 0x80041025 | An attempt was made to make a change that would invalidate a subclass. |\n| `WBEM_E_ALREADY_EXISTS` | 0x80041019 | The `WBEM_FLAG_CREATE_ONLY` flag was specified, but the class already exists. |\n| `WBEM_E_NOT_FOUND` | 0x80041002 | `WBEM_FLAG_UPDATE_ONLY` was specified in `lFlags`, and the class was not found. |\n| `WBEM_E_INCOMPLETE_CLASS` | 0x80041020 | The required properties for classes have not all been set. |\n| `WBEM_E_OUT_OF_MEMORY` | 0x80041006 | Not enough memory is available to complete the operation. |\n| `WBEM_E_SHUTTING_DOWN` | 0x80041033 | WMI was probably stopped and restarting. Call [ConnectServerWmi](connectserverwmi.md) again. |\n| `WBEM_E_TRANSPORT_FAILURE` | 0x80041015 | The remote procedure call (RPC) link between the current process and WMI has failed. |\n| `WBEM_S_NO_ERROR` | 0 | The function call was successful.  |\n\n## Remarks\n\nThis function wraps a call to the [IWbemServices::PutClass](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemservices-putclass) method.\n\nThe user may not create classes with names that begin or end with an underscore character.\n\nIf the function call fails, you can obtain additional error information by calling the [GetErrorInfo](geterrorinfo.md) function.\n\n## Requirements\n\n**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).\n\n**Header:** WMINet_Utils.idl\n\n**.NET Framework Versions:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]\n\n## See also\n\n- [WMI and Performance Counters (Unmanaged API Reference)](index.md)","nodes":[{"pos":[4,439],"embed":true,"restype":"x-metadata","content":"title: PutClassWmi function (Unmanaged API Reference)\ndescription: The PutClassWmi function creates a new class or updates an existing one.\nms.date: \"11/06/2017\"\napi_name:\n  - \"PutClassWmi\"\napi_location:\n  - \"WMINet_Utils.dll\"\napi_type:\n  - \"DLLExport\"\nf1_keywords:\n  - \"PutClassWmi\"\nhelpviewer_keywords:\n  - \"PutClassWmi function [.NET WMI and performance counters]\"\ntopic_type:\n  - \"Reference\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"PutClassWmi function (Unmanaged API Reference)","nodes":[{"pos":[0,46],"content":"PutClassWmi function (Unmanaged API Reference)","nodes":[{"content":"PutClassWmi function (Unmanaged API Reference)","pos":[0,46]}]}],"path":["title"],"nosxs":false},{"content":"The PutClassWmi function creates a new class or updates an existing one.","nodes":[{"pos":[0,72],"content":"The PutClassWmi function creates a new class or updates an existing one.","nodes":[{"content":"The PutClassWmi function creates a new class or updates an existing one.","pos":[0,72]}]}],"path":["description"],"nosxs":false}],"yml":true},{"pos":[447,467],"content":"PutClassWmi function","linkify":"PutClassWmi function","nodes":[{"content":"PutClassWmi function","pos":[0,20]}]},{"content":"Creates a new class or updates an existing one.","pos":[469,516]},{"pos":[605,611],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[805,815],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A pointer to a valid class definition.","pos":[828,871]},{"content":"It must be correctly initialized with all the required property values.","pos":[872,943]},{"content":"[in] A combination of flags that affect the behavior of this function.","pos":[955,1025]},{"content":"The following values are defined in the <bpt id=\"p1\">*</bpt>WbemCli.h<ept id=\"p1\">*</ept> header file, or you can define them as constants in your code:","pos":[1026,1140],"source":" The following values are defined in the *WbemCli.h* header file, or you can define them as constants in your code:"},{"content":"Constant","pos":[1143,1151]},{"content":"Value","pos":[1154,1159]},{"content":"Description","pos":[1162,1173]},{"content":"0x20000","pos":[1248,1255]},{"content":"If set, WMI does not store any qualifiers with the amended flavor.","pos":[1258,1324]},{"content":"If not set, it is assumed that this object is not localized, and all qualifiers are stored with this instance.","pos":[1330,1440]},{"content":"0","pos":[1476,1477]},{"content":"Create the class if it does not exist, or overwrite it if it exists already.","pos":[1480,1556]},{"content":"1","pos":[1587,1588]},{"content":"Update the class.","pos":[1591,1608]},{"content":"The class must exist for the call to be successful.","pos":[1609,1660]},{"content":"2","pos":[1691,1692]},{"content":"Create the class.","pos":[1695,1712]},{"content":"The call fails if the class already exists.","pos":[1713,1756]},{"content":"0x10","pos":[1794,1798]},{"content":"The flag causes a semisynchronous call.","pos":[1801,1840]},{"content":"0x10000","pos":[1872,1879]},{"pos":[1882,1987],"content":"Push providers must specify this flag when calling <ph id=\"ph1\">`PutClassWmi`</ph> to indicate that this class has changed.","source":"Push providers must specify this flag when calling `PutClassWmi` to indicate that this class has changed."},{"content":"0","pos":[2024,2025]},{"content":"Allows a class to be updated if there are no derived classes and no instances of that class.","pos":[2028,2120]},{"content":"It also allows updates in all cases if the change is just to unimportant qualifiers, such as the Description qualifier.","pos":[2121,2240]},{"content":"If the class has instances or changes are to important qualifiers, the update fails.","pos":[2241,2325]},{"content":"0x20","pos":[2361,2365]},{"content":"Allows updates of classes even if there are child classes as long as the change does not cause any conflicts with child classes.","pos":[2368,2496]},{"content":"For example, this flag allows a new property to be added to the base class that was not previously mentioned in any of the child classes.","pos":[2497,2634]},{"content":"If the class has instances, the update fails.","pos":[2635,2680]},{"content":"0x40","pos":[2717,2721]},{"content":"forces updates of classes when conflicting child classes exist.","pos":[2724,2787]},{"content":"For example, this flag forces an update if a class qualifier is defined in a child class, and the base class tries to add the same qualifier which conflicts with the existing one.","pos":[2788,2967]},{"content":"In force mode, tis conflict is resolved by deleting the conflicting qualifier in the child class.","pos":[2968,3065]},{"content":"[in] Typically, this value is <ph id=\"ph1\">`null`</ph>.","pos":[3077,3114],"source":"[in] Typically, this value is `null`."},{"content":"Otherwise, it is a pointer to an <bpt id=\"p1\">[</bpt>IWbemContext<ept id=\"p1\">](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcontext)</ept> instance that can be used by the provider that is providing the requested classes.","pos":[3115,3299],"source":" Otherwise, it is a pointer to an [IWbemContext](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcontext) instance that can be used by the provider that is providing the requested classes."},{"content":"[out] If <ph id=\"ph1\">`null`</ph>, this parameter is unused.","pos":[3317,3359],"source":"[out] If `null`, this parameter is unused."},{"content":"If <ph id=\"ph1\">`lFlags`</ph> contains <ph id=\"ph2\">`WBEM_FLAG_RETURN_IMMEDIATELY`</ph>, the function returns immediately with <ph id=\"ph3\">`WBEM_S_NO_ERROR`</ph>.","pos":[3360,3469],"source":" If `lFlags` contains `WBEM_FLAG_RETURN_IMMEDIATELY`, the function returns immediately with `WBEM_S_NO_ERROR`."},{"content":"The <ph id=\"ph1\">`ppCallResult`</ph> parameter receives a pointer to a new <bpt id=\"p1\">[</bpt>IWbemCallResult<ept id=\"p1\">](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcallresult)</ept> object.","pos":[3470,3609],"source":" The `ppCallResult` parameter receives a pointer to a new [IWbemCallResult](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcallresult) object."},{"pos":[3614,3626],"content":"Return value","linkify":"Return value","nodes":[{"content":"Return value","pos":[0,12]}]},{"pos":[3628,3768],"content":"The following values returned by this function are defined in the <bpt id=\"p1\">*</bpt>WbemCli.h<ept id=\"p1\">*</ept> header file, or you can define them as constants in your code:","source":"The following values returned by this function are defined in the *WbemCli.h* header file, or you can define them as constants in your code:"},{"content":"Constant","pos":[3771,3779]},{"content":"Value","pos":[3782,3787]},{"content":"Description","pos":[3790,3801]},{"content":"0x80041003","pos":[3864,3874]},{"content":"The user does not have permission to create or modify classes.","pos":[3877,3939]},{"content":"0x80041001","pos":[3962,3972]},{"content":"An unspecified error has occurred.","pos":[3975,4009]},{"content":"0x80041010","pos":[4039,4049]},{"content":"The specified class is not valid.","pos":[4052,4085]},{"content":"Typically, this indicates that <ph id=\"ph1\">`pObject`</ph> specifies an instance object.","pos":[4086,4156],"source":" Typically, this indicates that `pObject` specifies an instance object."},{"content":"0x80041008","pos":[4190,4200]},{"content":"A parameter is not valid.","pos":[4203,4228]},{"content":"0x80041016","pos":[4262,4272]},{"content":"The specified class name is not valid.","pos":[4275,4313]},{"content":"0x80041025","pos":[4348,4358]},{"content":"An attempt was made to make a change that would invalidate a subclass.","pos":[4361,4431]},{"content":"0x80041019","pos":[4462,4472]},{"pos":[4475,4552],"content":"The <ph id=\"ph1\">`WBEM_FLAG_CREATE_ONLY`</ph> flag was specified, but the class already exists.","source":"The `WBEM_FLAG_CREATE_ONLY` flag was specified, but the class already exists."},{"content":"0x80041002","pos":[4578,4588]},{"pos":[4591,4670],"content":"<ph id=\"ph1\">`WBEM_FLAG_UPDATE_ONLY`</ph> was specified in <ph id=\"ph2\">`lFlags`</ph>, and the class was not found.","source":"`WBEM_FLAG_UPDATE_ONLY` was specified in `lFlags`, and the class was not found."},{"content":"0x80041020","pos":[4703,4713]},{"content":"The required properties for classes have not all been set.","pos":[4716,4774]},{"content":"0x80041006","pos":[4804,4814]},{"content":"Not enough memory is available to complete the operation.","pos":[4817,4874]},{"content":"0x80041033","pos":[4904,4914]},{"content":"WMI was probably stopped and restarting.","pos":[4917,4957]},{"content":"Call <bpt id=\"p1\">[</bpt>ConnectServerWmi<ept id=\"p1\">](connectserverwmi.md)</ept> again.","pos":[4958,5009],"source":" Call [ConnectServerWmi](connectserverwmi.md) again."},{"content":"0x80041015","pos":[5043,5053]},{"content":"The remote procedure call (RPC) link between the current process and WMI has failed.","pos":[5056,5140]},{"content":"0","pos":[5165,5166]},{"content":"The function call was successful.","pos":[5169,5202]},{"pos":[5210,5217],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5219,5350],"content":"This function wraps a call to the <bpt id=\"p1\">[</bpt>IWbemServices::PutClass<ept id=\"p1\">](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemservices-putclass)</ept> method.","source":"This function wraps a call to the [IWbemServices::PutClass](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemservices-putclass) method."},{"content":"The user may not create classes with names that begin or end with an underscore character.","pos":[5352,5442]},{"pos":[5444,5572],"content":"If the function call fails, you can obtain additional error information by calling the <bpt id=\"p1\">[</bpt>GetErrorInfo<ept id=\"p1\">](geterrorinfo.md)</ept> function.","source":"If the function call fails, you can obtain additional error information by calling the [GetErrorInfo](geterrorinfo.md) function."},{"pos":[5577,5589],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[5591,5695],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[5697,5725],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> WMINet_Utils.idl","source":"**Header:** WMINet_Utils.idl"},{"pos":[5727,5834],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]"},{"pos":[5839,5847],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5851,5917],"content":"<bpt id=\"p1\">[</bpt>WMI and Performance Counters (Unmanaged API Reference)<ept id=\"p1\">](index.md)</ept>","source":"[WMI and Performance Counters (Unmanaged API Reference)](index.md)"}]}