{"content":"---\ntitle: \"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"cpp\"\napi_name: \n  - \"ICorProfilerAssemblyReferenceProvider.AddAssemblyReference\"\napi_location: \n  - \"mscorwks.dll\"\napi_type: \n  - \"COM\"\nms.assetid: 3d5af8e7-c337-48f4-9fa6-97c83878b9b1\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method\n[Supported in the .NET Framework 4.5.2 and later versions]  \n  \n Informs the common language runtime (CLR) of an assembly reference that the profiler plans to add in the [ICorProfilerCallback::ModuleLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md) callback.  \n  \n## Syntax  \n  \n```cpp\nHRESULT AddAssemblyReference(  \n        const COR_PRF_ASSEMBLY_REFERENCE_INFO* pAssemblyRefInfo  \n);  \n```  \n  \n## Parameters  \n pAssemblyRefInfo  \n A pointer to a [COR_PRF_ASSEMBLY_REFERENCE_INFO](../../../../docs/framework/unmanaged-api/profiling/cor-prf-assembly-reference-info-structure.md) structure that provides the CLR with information about an assembly reference that it should consider when performing an assembly reference closure walk.  \n  \n## Remarks  \n The profiler calls this method for each target assembly it plans to reference from the assembly specified in the `wszAssemblyPath` argument of the [ICorProfilerCallback6::GetAssemblyReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) callback. The [ICorProfilerAssemblyReferenceProvider](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-interface.md) interface object is passed to the profiler's [ICorProfilerCallback6::GetAssemblyReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) callback, along with the assembly path and name in the `wszAssemblyPath` argument.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** CorProf.idl, CorProf.h  \n  \n **Library:** CorGuids.lib  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v452plus](../../../../includes/net-current-v452plus-md.md)]  \n  \n## See also\n\n- [ICorProfilerAssemblyReferenceProvider Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-interface.md)\n- [GetAssemblyReferences Method](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md)\n- [ModuleLoadFinished Method](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md)\n","nodes":[{"pos":[4,369],"embed":true,"restype":"x-metadata","content":"title: \"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"cpp\"\napi_name: \n  - \"ICorProfilerAssemblyReferenceProvider.AddAssemblyReference\"\napi_location: \n  - \"mscorwks.dll\"\napi_type: \n  - \"COM\"\nms.assetid: 3d5af8e7-c337-48f4-9fa6-97c83878b9b1\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method","nodes":[{"pos":[0,66],"content":"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method","nodes":[{"content":"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method","pos":[0,66]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[376,442],"content":"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method","linkify":"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method","nodes":[{"content":"ICorProfilerAssemblyReferenceProvider::AddAssemblyReference Method","pos":[0,66]}]},{"content":"[Supported in the .NET Framework 4.5.2 and later versions]","pos":[443,501]},{"pos":[508,767],"content":"Informs the common language runtime (CLR) of an assembly reference that the profiler plans to add in the <bpt id=\"p1\">[</bpt>ICorProfilerCallback::ModuleLoadFinished<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md)</ept> callback.","source":"Informs the common language runtime (CLR) of an assembly reference that the profiler plans to add in the [ICorProfilerCallback::ModuleLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md) callback."},{"pos":[776,782],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[910,920],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"pAssemblyRefInfo","pos":[924,940]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>COR_PRF_ASSEMBLY_REFERENCE_INFO<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/cor-prf-assembly-reference-info-structure.md)</ept> structure that provides the CLR with information about an assembly reference that it should consider when performing an assembly reference closure walk.","pos":[944,1242],"source":"A pointer to a [COR_PRF_ASSEMBLY_REFERENCE_INFO](../../../../docs/framework/unmanaged-api/profiling/cor-prf-assembly-reference-info-structure.md) structure that provides the CLR with information about an assembly reference that it should consider when performing an assembly reference closure walk."},{"pos":[1251,1258],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The profiler calls this method for each target assembly it plans to reference from the assembly specified in the <ph id=\"ph1\">`wszAssemblyPath`</ph> argument of the <bpt id=\"p1\">[</bpt>ICorProfilerCallback6::GetAssemblyReferences<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md)</ept> callback.","pos":[1262,1571],"source":"The profiler calls this method for each target assembly it plans to reference from the assembly specified in the `wszAssemblyPath` argument of the [ICorProfilerCallback6::GetAssemblyReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) callback."},{"content":"The <bpt id=\"p1\">[</bpt>ICorProfilerAssemblyReferenceProvider<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-interface.md)</ept> interface object is passed to the profiler's <bpt id=\"p2\">[</bpt>ICorProfilerCallback6::GetAssemblyReferences<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md)</ept> callback, along with the assembly path and name in the <ph id=\"ph1\">`wszAssemblyPath`</ph> argument.","pos":[1572,1999],"source":" The [ICorProfilerAssemblyReferenceProvider](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-interface.md) interface object is passed to the profiler's [ICorProfilerCallback6::GetAssemblyReferences](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md) callback, along with the assembly path and name in the `wszAssemblyPath` argument."},{"pos":[2008,2020],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2024,2128],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2135,2169],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> CorProf.idl, CorProf.h","source":"**Header:** CorProf.idl, CorProf.h"},{"pos":[2176,2201],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> CorGuids.lib","source":"**Library:** CorGuids.lib"},{"pos":[2208,2318],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v452plus](../../../../includes/net-current-v452plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v452plus](../../../../includes/net-current-v452plus-md.md)]"},{"pos":[2327,2335],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2339,2491],"content":"<bpt id=\"p1\">[</bpt>ICorProfilerAssemblyReferenceProvider Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-interface.md)</ept>","source":"[ICorProfilerAssemblyReferenceProvider Interface](../../../../docs/framework/unmanaged-api/profiling/icorprofilerassemblyreferenceprovider-interface.md)"},{"pos":[2494,2630],"content":"<bpt id=\"p1\">[</bpt>GetAssemblyReferences Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md)</ept>","source":"[GetAssemblyReferences Method](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback6-getassemblyreferences-method.md)"},{"pos":[2633,2762],"content":"<bpt id=\"p1\">[</bpt>ModuleLoadFinished Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md)</ept>","source":"[ModuleLoadFinished Method](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-moduleloadfinished-method.md)"}]}