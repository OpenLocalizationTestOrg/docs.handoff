{"content":"---\ntitle: \"How to: Host Multiple Versions of a Workflow Side-by-Side | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 09c575df-e0a3-4f3b-9e01-a7ac59d65287\ncaps.latest.revision: 10\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Host Multiple Versions of a Workflow Side-by-Side\n`WorkflowIdentity` provides a way for workflow application developers to associate a name and a version with a workflow definition, and for this information to be associated with a persisted workflow instance. This identity information can be used by workflow application developers to enable scenarios such as side-by-side execution of multiple versions of a workflow definition, and provides the cornerstone for other functionality such as dynamic update. This step in the tutorial demonstrates how to use `WorkflowIdentity` to host multiple versions of a workflow at the same time.  \n  \n> [!NOTE]\n>  To download a completed version or view a video walkthrough of the tutorial, see [Windows Workflow Foundation (WF45) - Getting Started Tutorial](http://go.microsoft.com/fwlink/?LinkID=248976).  \n  \n## In this topic  \n In this step of the tutorial, the `WriteLine` activities in the workflow are modified to provide additional information, and a new `WriteLine` activity is added. A copy of the original workflow assembly is stored, and the host application is updated so that it can run both the original and the updated workflows at the same time.  \n  \n-   [To make a copy of the NumberGuessWorkflowActivities project](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_BackupCopy)  \n  \n-   [To update the workflows](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateWorkflows)  \n  \n    -   [To update the StateMachine workflow](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateStateMachine)  \n  \n    -   [To update the Flowchart workflow](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateFlowchart)  \n  \n    -   [To update the Sequential workflow](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateSequential)  \n  \n-   [To update WorkflowVersionMap to include the previous workflow versions](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateWorkflowVersionMap)  \n  \n-   [To build and run the application](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_BuildAndRun)  \n  \n> [!NOTE]\n>  Before following the steps in this topic, run the application, start several workflows of each type, and making one or two guesses for each one. These persisted workflows are used in this step and the following step, [How to: Update the Definition of a Running Workflow Instance](../../../docs/framework/windows-workflow-foundation/how-to-update-the-definition-of-a-running-workflow-instance.md).  \n  \n> [!NOTE]\n>  Each step in the Getting Started tutorial depends on the previous steps. If you did not complete the previous steps you can download a completed version of the tutorial from [Windows Workflow Foundation (WF45) - Getting Started Tutorial](http://go.microsoft.com/fwlink/?LinkID=248976).  \n  \n###  <a name=\"BKMK_BackupCopy\"></a> To make a copy of the NumberGuessWorkflowActivities project  \n  \n1.  Open the **WF45GettingStartedTutorial** solution in [!INCLUDE[vs_current_long](../../../includes/vs-current-long-md.md)] if it is not open.  \n  \n2.  Press CTRL+SHIFT+B to build the solution.  \n  \n3.  Close the **WF45GettingStartedTutorial** solution.  \n  \n4.  Open Windows Explorer and navigate to the folder where the tutorial solution file and the project folders are located.  \n  \n5.  Create a new folder named **PreviousVersions** in the same folder as **NumberGuessWorkflowHost** and **NumberGuessWorkflowActivities**. This folder is used to contain the assemblies that contain the different versions of the workflows used in the subsequent tutorial steps.  \n  \n6.  Navigate to the **NumberGuessWorkflowActivities\\bin\\debug** folder (or **bin\\release** depending on your project settings). Copy **NumberGuessWorkflowActivities.dll** and paste it into the **PreviousVersions** folder.  \n  \n7.  Rename **NumberGuessWorkflowActivities.dll** in the **PreviousVersions** folder to **NumberGuessWorkflowActivities_v1.dll**.  \n  \n    > [!NOTE]\n    >  The steps in this topic demonstrate one way to manage the assemblies used to contain multiple versions of the workflows. Other methods such as strong naming the assemblies and registering them in the global assembly cache could also be used.  \n  \n8.  Create a new folder named **NumberGuessWorkflowActivities_du** in the same folder as **NumberGuessWorkflowHost**, **NumberGuessWorkflowActivities**, and the newly added **PreviousVersions** folder, and copy all of the files and subfolders from the **NumberGuessWorkflowActivities** folder into the new **NumberGuessWorkflowActivities_du** folder. This backup copy of the project for the initial version of the activities is used in [How to: Update the Definition of a Running Workflow Instance](../../../docs/framework/windows-workflow-foundation/how-to-update-the-definition-of-a-running-workflow-instance.md).  \n  \n9. Re-open the **WF45GettingStartedTutorial** solution in [!INCLUDE[vs_current_long](../../../includes/vs-current-long-md.md)].  \n  \n###  <a name=\"BKMK_UpdateWorkflows\"></a> To update the workflows  \n In this section, the workflow definitions are updated. The two `WriteLine` activities that give feedback on the user's guess are updated, and a new `WriteLine` activity is added that provides additional information about the game once the number is guessed.  \n  \n####  <a name=\"BKMK_UpdateStateMachine\"></a> To update the StateMachine workflow  \n  \n1.  In **Solution Explorer**, under the **NumberGuessWorkflowActivities** project, double-click **StateMachineNumberGuessWorkflow.xaml**.  \n  \n2.  Double-click the **Guess Incorrect** transition on the state machine.  \n  \n3.  Update the `Text` of the left-most `WriteLine` in the `If` activity.  \n  \n    ```vb  \n    Guess & \" is too low.\"  \n    ```  \n  \n    ```csharp  \n    Guess + \" is too low.\"  \n    ```  \n  \n4.  Update the `Text` of the right-most `WriteLine` in the `If` activity.  \n  \n    ```vb  \n    Guess & \" is too high.\"  \n    ```  \n  \n    ```csharp  \n    Guess + \" is too high.\"  \n    ```  \n  \n5.  Return to the overall state machine view in the workflow designer by clicking **StateMachine** in the breadcrumb display at the top of the workflow designer.  \n  \n6.  Double-click the **Guess Correct** transition on the state machine.  \n  \n7.  Drag a **WriteLine** activity from the **Primitives** section of the **Toolbox** and drop it on the **Drop Action activity here** label of the transition.  \n  \n8.  Type the following expression into the `Text` property box.  \n  \n    ```vb  \n    Guess & \" is correct. You guessed it in \" & Turns & \" turns.\"  \n    ```  \n  \n    ```csharp  \n    Guess + \" is correct. You guessed it in \" + Turns + \" turns.\"  \n    ```  \n  \n####  <a name=\"BKMK_UpdateFlowchart\"></a> To update the Flowchart workflow  \n  \n1.  In **Solution Explorer**, under the **NumberGuessWorkflowActivities** project, double-click **FlowchartNumberGuessWorkflow.xaml**.  \n  \n2.  Update the `Text` of the left-most `WriteLine` activity.  \n  \n    ```vb  \n    Guess & \" is too low.\"  \n    ```  \n  \n    ```csharp  \n    Guess + \" is too low.\"  \n    ```  \n  \n3.  Update the `Text` of the right-most `WriteLine` activity.  \n  \n    ```vb  \n    Guess & \" is too high.\"  \n    ```  \n  \n    ```csharp  \n    Guess + \" is too high.\"  \n    ```  \n  \n4.  Drag a **WriteLine** activity from the **Primitives** section of the **Toolbox** and drop it on the drop point of the `True` action of the topmost `FlowDecision`. The `WriteLine` activity is added to the flowchart and linked to the `True` action of the `FlowDecision`.  \n  \n5.  Type the following expression into the `Text` property box.  \n  \n    ```vb  \n    Guess & \" is correct. You guessed it in \" & Turns & \" turns.\"  \n    ```  \n  \n    ```csharp  \n    Guess + \" is correct. You guessed it in \" + Turns + \" turns.\"  \n    ```  \n  \n####  <a name=\"BKMK_UpdateSequential\"></a> To update the Sequential workflow  \n  \n1.  In **Solution Explorer**, under the **NumberGuessWorkflowActivities** project, double-click **SequentialNumberGuessWorkflow.xaml**.  \n  \n2.  Update the `Text` of the left-most `WriteLine` in the `If` activity.  \n  \n    ```vb  \n    Guess & \" is too low.\"  \n    ```  \n  \n    ```csharp  \n    Guess + \" is too low.\"  \n    ```  \n  \n3.  Update the `Text` of the right-most `WriteLine` activity in the `If` activity.  \n  \n    ```vb  \n    Guess & \" is too high.\"  \n    ```  \n  \n    ```csharp  \n    Guess + \" is too high.\"  \n    ```  \n  \n4.  Drag a **WriteLine** activity from the **Primitives** section of the **Toolbox** and drop it after the **DoWhile** activity so that the **WriteLine** is the final activity in the root `Sequence` activity.  \n  \n5.  Type the following expression into the `Text` property box.  \n  \n    ```vb  \n    Guess & \" is correct. You guessed it in \" & Turns & \" turns.\"  \n    ```  \n  \n    ```csharp  \n    Guess + \" is correct. You guessed it in \" + Turns + \" turns.\"  \n    ```  \n  \n###  <a name=\"BKMK_UpdateWorkflowVersionMap\"></a> To update WorkflowVersionMap to include the previous workflow versions  \n  \n1.  Double-click **WorkflowVersionMap.cs** (or **WorkflowVersionMap.vb**) under the **NumberGuessWorkflowHost** project to open it.  \n  \n2.  Add the following `using` (or `Imports`) statements to the top of the file with the other `using` (or `Imports`) statements.  \n  \n    ```vb  \n    Imports System.Reflection  \n    Imports System.IO  \n    ```  \n  \n    ```csharp  \n    using System.Reflection;  \n    using System.IO;  \n    ```  \n  \n3.  Add three new workflow identities just below the three existing workflow identity declarations. These new `v1` workflow identities will be used provide the correct workflow definition to workflows started before the updates were made.  \n  \n    ```vb  \n    'Current version identities.  \n    Public StateMachineNumberGuessIdentity As WorkflowIdentity  \n    Public FlowchartNumberGuessIdentity As WorkflowIdentity  \n    Public SequentialNumberGuessIdentity As WorkflowIdentity  \n  \n    'v1 Identities.  \n    Public StateMachineNumberGuessIdentity_v1 As WorkflowIdentity  \n    Public FlowchartNumberGuessIdentity_v1 As WorkflowIdentity  \n    Public SequentialNumberGuessIdentity_v1 As WorkflowIdentity  \n    ```  \n  \n    ```csharp  \n    // Current version identities.  \n    static public WorkflowIdentity StateMachineNumberGuessIdentity;  \n    static public WorkflowIdentity FlowchartNumberGuessIdentity;  \n    static public WorkflowIdentity SequentialNumberGuessIdentity;  \n  \n    // v1 identities.  \n    static public WorkflowIdentity StateMachineNumberGuessIdentity_v1;  \n    static public WorkflowIdentity FlowchartNumberGuessIdentity_v1;  \n    static public WorkflowIdentity SequentialNumberGuessIdentity_v1;  \n    ```  \n  \n4.  In the `WorkflowVersionMap` constructor, update the `Version` property of the three current workflow identities to `2.0.0.0`.  \n  \n    ```vb  \n    'Add the current workflow version identities.  \n    StateMachineNumberGuessIdentity = New WorkflowIdentity With  \n    {  \n        .Name = \"StateMachineNumberGuessWorkflow\",  \n        .Version = New Version(2, 0, 0, 0)  \n    }  \n  \n    FlowchartNumberGuessIdentity = New WorkflowIdentity With  \n    {  \n        .Name = \"FlowchartNumberGuessWorkflow\",  \n        .Version = New Version(2, 0, 0, 0)  \n    }  \n  \n    SequentialNumberGuessIdentity = New WorkflowIdentity With  \n    {  \n        .Name = \"SequentialNumberGuessWorkflow\",  \n        .Version = New Version(2, 0, 0, 0)  \n    }  \n  \n    map.Add(StateMachineNumberGuessIdentity, New StateMachineNumberGuessWorkflow())  \n    map.Add(FlowchartNumberGuessIdentity, New FlowchartNumberGuessWorkflow())  \n    map.Add(SequentialNumberGuessIdentity, New SequentialNumberGuessWorkflow())  \n    ```  \n  \n    ```csharp  \n    // Add the current workflow version identities.  \n    StateMachineNumberGuessIdentity = new WorkflowIdentity  \n    {  \n        Name = \"StateMachineNumberGuessWorkflow\",  \n        // Version = new Version(1, 0, 0, 0),  \n        Version = new Version(2, 0, 0, 0)  \n    };  \n  \n    FlowchartNumberGuessIdentity = new WorkflowIdentity  \n    {  \n        Name = \"FlowchartNumberGuessWorkflow\",  \n        // Version = new Version(1, 0, 0, 0),  \n        Version = new Version(2, 0, 0, 0)  \n    };  \n  \n    SequentialNumberGuessIdentity = new WorkflowIdentity  \n    {  \n        Name = \"SequentialNumberGuessWorkflow\",  \n        // Version = new Version(1, 0, 0, 0),  \n        Version = new Version(2, 0, 0, 0)  \n    };  \n  \n    map.Add(StateMachineNumberGuessIdentity, new StateMachineNumberGuessWorkflow());  \n    map.Add(FlowchartNumberGuessIdentity, new FlowchartNumberGuessWorkflow());  \n    map.Add(SequentialNumberGuessIdentity, new SequentialNumberGuessWorkflow());  \n    ```  \n  \n     The code in that adds the current versions of the workflows to the dictionary uses the current versions that are referenced in the project, so the code that initializes the workflow definitions does not need to be updated.  \n  \n5.  Add the following code in the constructor just after the code that adds the current versions to the dictionary.  \n  \n    ```vb  \n    'Initialize the previous workflow version identities.  \n    StateMachineNumberGuessIdentity_v1 = New WorkflowIdentity With  \n    {  \n        .Name = \"StateMachineNumberGuessWorkflow\",  \n        .Version = New Version(1, 0, 0, 0)  \n    }  \n  \n    FlowchartNumberGuessIdentity_v1 = New WorkflowIdentity With  \n    {  \n        .Name = \"FlowchartNumberGuessWorkflow\",  \n        .Version = New Version(1, 0, 0, 0)  \n    }  \n  \n    SequentialNumberGuessIdentity_v1 = New WorkflowIdentity With  \n    {  \n        .Name = \"SequentialNumberGuessWorkflow\",  \n        .Version = New Version(1, 0, 0, 0)  \n    }  \n    ```  \n  \n    ```csharp  \n    // Initialize the previous workflow version identities.  \n    StateMachineNumberGuessIdentity_v1 = new WorkflowIdentity  \n    {  \n        Name = \"StateMachineNumberGuessWorkflow\",  \n        Version = new Version(1, 0, 0, 0)  \n    };  \n  \n    FlowchartNumberGuessIdentity_v1 = new WorkflowIdentity  \n    {  \n        Name = \"FlowchartNumberGuessWorkflow\",  \n        Version = new Version(1, 0, 0, 0)  \n    };  \n  \n    SequentialNumberGuessIdentity_v1 = new WorkflowIdentity  \n    {  \n        Name = \"SequentialNumberGuessWorkflow\",  \n        Version = new Version(1, 0, 0, 0)  \n    };  \n    ```  \n  \n     These workflow identities are associated with the initial versions of the corresponding workflow definitions.  \n  \n6.  Next, load the assembly that contains the initial version of the workflow definitions, and create and add the corresponding workflow definitions to the dictionary.  \n  \n    ```vb  \n    'Add the previous version workflow identities to the dictionary along with  \n    'the corresponding workflow definitions loaded from the v1 assembly.  \n    'Assembly.LoadFile requires an absolute path so convert this relative path  \n    'to an absolute path.  \n    Dim v1AssemblyPath As String = \"..\\..\\..\\PreviousVersions\\NumberGuessWorkflowActivities_v1.dll\"  \n    v1AssemblyPath = Path.GetFullPath(v1AssemblyPath)  \n    Dim v1Assembly As Assembly = Assembly.LoadFile(v1AssemblyPath)  \n  \n    map.Add(StateMachineNumberGuessIdentity_v1,  \n        v1Assembly.CreateInstance(\"NumberGuessWorkflowActivities.StateMachineNumberGuessWorkflow\"))  \n  \n    map.Add(SequentialNumberGuessIdentity_v1,  \n        v1Assembly.CreateInstance(\"NumberGuessWorkflowActivities.SequentialNumberGuessWorkflow\"))  \n  \n    map.Add(FlowchartNumberGuessIdentity_v1,  \n        v1Assembly.CreateInstance(\"NumberGuessWorkflowActivities.FlowchartNumberGuessWorkflow\"))  \n    ```  \n  \n    ```csharp  \n    // Add the previous version workflow identities to the dictionary along with  \n    // the corresponding workflow definitions loaded from the v1 assembly.  \n    // Assembly.LoadFile requires an absolute path so convert this relative path  \n    // to an absolute path.  \n    string v1AssemblyPath = @\"..\\..\\..\\PreviousVersions\\NumberGuessWorkflowActivities_v1.dll\";  \n    v1AssemblyPath = Path.GetFullPath(v1AssemblyPath);  \n    Assembly v1Assembly = Assembly.LoadFile(v1AssemblyPath);  \n  \n    map.Add(StateMachineNumberGuessIdentity_v1,  \n        v1Assembly.CreateInstance(\"NumberGuessWorkflowActivities.StateMachineNumberGuessWorkflow\") as Activity);  \n  \n    map.Add(SequentialNumberGuessIdentity_v1,  \n        v1Assembly.CreateInstance(\"NumberGuessWorkflowActivities.SequentialNumberGuessWorkflow\") as Activity);  \n  \n    map.Add(FlowchartNumberGuessIdentity_v1,  \n        v1Assembly.CreateInstance(\"NumberGuessWorkflowActivities.FlowchartNumberGuessWorkflow\") as Activity);  \n  \n    ```  \n  \n     The following example is the complete listing for the updated `WorkflowVersionMap` class.  \n  \n    ```vb  \n    Public Module WorkflowVersionMap  \n        Dim map As Dictionary(Of WorkflowIdentity, Activity)  \n  \n        'Current version identities.  \n        Public StateMachineNumberGuessIdentity As WorkflowIdentity  \n        Public FlowchartNumberGuessIdentity As WorkflowIdentity  \n        Public SequentialNumberGuessIdentity As WorkflowIdentity  \n  \n        'v1 Identities.  \n        Public StateMachineNumberGuessIdentity_v1 As WorkflowIdentity  \n        Public FlowchartNumberGuessIdentity_v1 As WorkflowIdentity  \n        Public SequentialNumberGuessIdentity_v1 As WorkflowIdentity  \n  \n        Sub New()  \n            map = New Dictionary(Of WorkflowIdentity, Activity)  \n  \n            'Add the current workflow version identities.  \n            StateMachineNumberGuessIdentity = New WorkflowIdentity With  \n            {  \n                .Name = \"StateMachineNumberGuessWorkflow\",  \n                .Version = New Version(2, 0, 0, 0)  \n            }  \n  \n            FlowchartNumberGuessIdentity = New WorkflowIdentity With  \n            {  \n                .Name = \"FlowchartNumberGuessWorkflow\",  \n                .Version = New Version(2, 0, 0, 0)  \n            }  \n  \n            SequentialNumberGuessIdentity = New WorkflowIdentity With  \n            {  \n                .Name = \"SequentialNumberGuessWorkflow\",  \n                .Version = New Version(2, 0, 0, 0)  \n            }  \n  \n            map.Add(StateMachineNumberGuessIdentity, New StateMachineNumberGuessWorkflow())  \n            map.Add(FlowchartNumberGuessIdentity, New FlowchartNumberGuessWorkflow())  \n            map.Add(SequentialNumberGuessIdentity, New SequentialNumberGuessWorkflow())  \n  \n            'Initialize the previous workflow version identities.  \n            StateMachineNumberGuessIdentity_v1 = New WorkflowIdentity With  \n            {  \n                .Name = \"StateMachineNumberGuessWorkflow\",  \n                .Version = New Version(1, 0, 0, 0)  \n            }  \n  \n            FlowchartNumberGuessIdentity_v1 = New WorkflowIdentity With  \n            {  \n                .Name = \"FlowchartNumberGuessWorkflow\",  \n                .Version = New Version(1, 0, 0, 0)  \n            }  \n  \n            SequentialNumberGuessIdentity_v1 = New WorkflowIdentity With  \n            {  \n                .Name = \"SequentialNumberGuessWorkflow\",  \n                .Version = New Version(1, 0, 0, 0)  \n            }  \n  \n            'Add the previous version workflow identities to the dictionary along with  \n            'the corresponding workflow definitions loaded from the v1 assembly.  \n            'Assembly.LoadFile requires an absolute path so convert this relative path  \n            'to an absolute path.  \n            Dim v1AssemblyPath As String = \"..\\..\\..\\PreviousVersions\\NumberGuessWorkflowActivities_v1.dll\"  \n            v1AssemblyPath = Path.GetFullPath(v1AssemblyPath)  \n            Dim v1Assembly As Assembly = Assembly.LoadFile(v1AssemblyPath)  \n  \n            map.Add(StateMachineNumberGuessIdentity_v1,  \n                v1Assembly.CreateInstance(\"NumberGuessWorkflowActivities.StateMachineNumberGuessWorkflow\"))  \n  \n            map.Add(SequentialNumberGuessIdentity_v1,  \n                v1Assembly.CreateInstance(\"NumberGuessWorkflowActivities.SequentialNumberGuessWorkflow\"))  \n  \n            map.Add(FlowchartNumberGuessIdentity_v1,  \n                v1Assembly.CreateInstance(\"NumberGuessWorkflowActivities.FlowchartNumberGuessWorkflow\"))  \n        End Sub  \n  \n        Public Function GetWorkflowDefinition(identity As WorkflowIdentity) As Activity  \n            Return map(identity)  \n        End Function  \n  \n        Public Function GetIdentityDescription(identity As WorkflowIdentity) As String  \n            Return identity.ToString()  \n        End Function  \n    End Module  \n    ```  \n  \n    ```csharp  \n    public static class WorkflowVersionMap  \n    {  \n        static Dictionary<WorkflowIdentity, Activity> map;  \n  \n        // Current version identities.  \n        static public WorkflowIdentity StateMachineNumberGuessIdentity;  \n        static public WorkflowIdentity FlowchartNumberGuessIdentity;  \n        static public WorkflowIdentity SequentialNumberGuessIdentity;  \n  \n        // v1 identities.  \n        static public WorkflowIdentity StateMachineNumberGuessIdentity_v1;  \n        static public WorkflowIdentity FlowchartNumberGuessIdentity_v1;  \n        static public WorkflowIdentity SequentialNumberGuessIdentity_v1;  \n  \n        static WorkflowVersionMap()  \n        {  \n            map = new Dictionary<WorkflowIdentity, Activity>();  \n  \n            // Add the current workflow version identities.  \n            StateMachineNumberGuessIdentity = new WorkflowIdentity  \n            {  \n                Name = \"StateMachineNumberGuessWorkflow\",  \n                // Version = new Version(1, 0, 0, 0),  \n                Version = new Version(2, 0, 0, 0)  \n            };  \n  \n            FlowchartNumberGuessIdentity = new WorkflowIdentity  \n            {  \n                Name = \"FlowchartNumberGuessWorkflow\",  \n                // Version = new Version(1, 0, 0, 0),  \n                Version = new Version(2, 0, 0, 0)  \n            };  \n  \n            SequentialNumberGuessIdentity = new WorkflowIdentity  \n            {  \n                Name = \"SequentialNumberGuessWorkflow\",  \n                // Version = new Version(1, 0, 0, 0),  \n                Version = new Version(2, 0, 0, 0)  \n            };  \n  \n            map.Add(StateMachineNumberGuessIdentity, new StateMachineNumberGuessWorkflow());  \n            map.Add(FlowchartNumberGuessIdentity, new FlowchartNumberGuessWorkflow());  \n            map.Add(SequentialNumberGuessIdentity, new SequentialNumberGuessWorkflow());  \n  \n            // Initialize the previous workflow version identities.  \n            StateMachineNumberGuessIdentity_v1 = new WorkflowIdentity  \n            {  \n                Name = \"StateMachineNumberGuessWorkflow\",  \n                Version = new Version(1, 0, 0, 0)  \n            };  \n  \n            FlowchartNumberGuessIdentity_v1 = new WorkflowIdentity  \n            {  \n                Name = \"FlowchartNumberGuessWorkflow\",  \n                Version = new Version(1, 0, 0, 0)  \n            };  \n  \n            SequentialNumberGuessIdentity_v1 = new WorkflowIdentity  \n            {  \n                Name = \"SequentialNumberGuessWorkflow\",  \n                Version = new Version(1, 0, 0, 0)  \n            };  \n  \n            // Add the previous version workflow identities to the dictionary along with  \n            // the corresponding workflow definitions loaded from the v1 assembly.  \n            // Assembly.LoadFile requires an absolute path so convert this relative path  \n            // to an absolute path.  \n            string v1AssemblyPath = @\"..\\..\\..\\PreviousVersions\\NumberGuessWorkflowActivities_v1.dll\";  \n            v1AssemblyPath = Path.GetFullPath(v1AssemblyPath);  \n            Assembly v1Assembly = Assembly.LoadFile(v1AssemblyPath);  \n  \n            map.Add(StateMachineNumberGuessIdentity_v1,  \n                v1Assembly.CreateInstance(\"NumberGuessWorkflowActivities.StateMachineNumberGuessWorkflow\") as Activity);  \n  \n            map.Add(SequentialNumberGuessIdentity_v1,  \n                v1Assembly.CreateInstance(\"NumberGuessWorkflowActivities.SequentialNumberGuessWorkflow\") as Activity);  \n  \n            map.Add(FlowchartNumberGuessIdentity_v1,  \n                v1Assembly.CreateInstance(\"NumberGuessWorkflowActivities.FlowchartNumberGuessWorkflow\") as Activity);  \n        }  \n  \n        public static Activity GetWorkflowDefinition(WorkflowIdentity identity)  \n        {  \n            return map[identity];  \n        }  \n  \n        public static string GetIdentityDescription(WorkflowIdentity identity)  \n        {  \n            return identity.ToString();  \n        }  \n    }  \n    ```  \n  \n###  <a name=\"BKMK_BuildAndRun\"></a> To build and run the application  \n  \n1.  Press CTRL+SHIFT+B to build the application, and then CTRL+F5 to start.  \n  \n2.  Start a new workflow by clicking **New Game**. The version of the workflow is displayed under the status window and reflects the updated version from the associated `WorkflowIdentity`. Make a note of the `InstanceId` so you can view the tracking file for the workflow when it completes, and then enter guesses until the game is complete. Note how the user's guess is displayed in the information displayed in the status window based on the updates to the `WriteLine` activities.  \n  \n **Please enter a number between 1 and 10**   \n**5 is too high.**   \n**Please enter a number between 1 and 10**   \n**3 is too high.**   \n**Please enter a number between 1 and 10**   \n**1 is too low.**   \n**Please enter a number between 1 and 10**   \n**Congratulations, you guessed the number in 4 turns.**    \n    > [!NOTE]\n    >  The updated text from the `WriteLine` activities is displayed, but the output of the final `WriteLine` activity that was added in this topic is not. That is because the status window is updated by the `PersistableIdle` handler. Because the workflow completes and does not go idle after the final activity, the `PersistableIdle` handler is not called. However, a similar message is displayed in the status window by the `Completed` handler. If desired, code could be added to the `Completed` handler to extract the text from the `StringWriter` and display it to the status window.  \n  \n3.  Open Windows Explorer and navigate to the **NumberGuessWorkflowHost\\bin\\debug** folder (or **bin\\release** depending on your project settings) and open the tracking file using Notepad that corresponds to the completed workflow. If you did not make a note of the `InstanceId`, you can identify the correct tracking file by using the **Date modified** information in Windows Explorer.  \n  \n **Please enter a number between 1 and 10**   \n**5 is too high.**   \n**Please enter a number between 1 and 10**   \n**3 is too high.**   \n**Please enter a number between 1 and 10**   \n**1 is too low.**   \n**Please enter a number between 1 and 10**   \n**2 is correct. You guessed it in 4 turns.**      The updated `WriteLine` output is contained within the tracking file, including the output of the `WriteLine` that was added in this topic.  \n  \n4.  Switch back to the number guessing application and select one of the workflows that was started before the updates were made. You can identify the version of the currently selected workflow by looking at the version information that is displayed below the status window. Enter some guesses and note that the status updates match the `WriteLine` activity output from the previous version, and do not include the user's guess. That is because these workflows are using the previous workflow definition that does not have the `WriteLine` updates.  \n  \n     In the next step, [How to: Update the Definition of a Running Workflow Instance](../../../docs/framework/windows-workflow-foundation/how-to-update-the-definition-of-a-running-workflow-instance.md), the running `v1` workflow instances are updated so they contain the new functionality as the `v2` instances.","nodes":[{"pos":[12,86],"content":"How to: Host Multiple Versions of a Workflow Side-by-Side | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Host Multiple Versions of a Workflow Side-by-Side | Microsoft Docs","pos":[0,74]}]},{"pos":[352,409],"content":"How to: Host Multiple Versions of a Workflow Side-by-Side","linkify":"How to: Host Multiple Versions of a Workflow Side-by-Side","nodes":[{"content":"How to: Host Multiple Versions of a Workflow Side-by-Side","pos":[0,57]}]},{"content":"<ph id=\"ph1\">`WorkflowIdentity`</ph> provides a way for workflow application developers to associate a name and a version with a workflow definition, and for this information to be associated with a persisted workflow instance.","pos":[410,619],"source":"`WorkflowIdentity` provides a way for workflow application developers to associate a name and a version with a workflow definition, and for this information to be associated with a persisted workflow instance."},{"content":"This identity information can be used by workflow application developers to enable scenarios such as side-by-side execution of multiple versions of a workflow definition, and provides the cornerstone for other functionality such as dynamic update.","pos":[620,867]},{"content":"This step in the tutorial demonstrates how to use <ph id=\"ph1\">`WorkflowIdentity`</ph> to host multiple versions of a workflow at the same time.","pos":[868,994],"source":" This step in the tutorial demonstrates how to use `WorkflowIdentity` to host multiple versions of a workflow at the same time."},{"pos":[1002,1205],"content":"[!NOTE]\n To download a completed version or view a video walkthrough of the tutorial, see [Windows Workflow Foundation (WF45) - Getting Started Tutorial](http://go.microsoft.com/fwlink/?LinkID=248976).","leadings":["","> "],"nodes":[{"content":"To download a completed version or view a video walkthrough of the tutorial, see <bpt id=\"p1\">[</bpt>Windows Workflow Foundation (WF45) - Getting Started Tutorial<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=248976)</ept>.","pos":[9,201],"source":" To download a completed version or view a video walkthrough of the tutorial, see [Windows Workflow Foundation (WF45) - Getting Started Tutorial](http://go.microsoft.com/fwlink/?LinkID=248976)."}]},{"pos":[1214,1227],"content":"In this topic","linkify":"In this topic","nodes":[{"content":"In this topic","pos":[0,13]}]},{"content":"In this step of the tutorial, the <ph id=\"ph1\">`WriteLine`</ph> activities in the workflow are modified to provide additional information, and a new <ph id=\"ph2\">`WriteLine`</ph> activity is added.","pos":[1231,1392],"source":"In this step of the tutorial, the `WriteLine` activities in the workflow are modified to provide additional information, and a new `WriteLine` activity is added."},{"content":"A copy of the original workflow assembly is stored, and the host application is updated so that it can run both the original and the updated workflows at the same time.","pos":[1393,1561]},{"pos":[1571,1761],"content":"<bpt id=\"p1\">[</bpt>To make a copy of the NumberGuessWorkflowActivities project<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_BackupCopy)</ept>","source":"[To make a copy of the NumberGuessWorkflowActivities project](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_BackupCopy)"},{"pos":[1771,1930],"content":"<bpt id=\"p1\">[</bpt>To update the workflows<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateWorkflows)</ept>","source":"[To update the workflows](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateWorkflows)"},{"pos":[1944,2118],"content":"<bpt id=\"p1\">[</bpt>To update the StateMachine workflow<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateStateMachine)</ept>","source":"[To update the StateMachine workflow](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateStateMachine)"},{"pos":[2132,2300],"content":"<bpt id=\"p1\">[</bpt>To update the Flowchart workflow<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateFlowchart)</ept>","source":"[To update the Flowchart workflow](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateFlowchart)"},{"pos":[2314,2484],"content":"<bpt id=\"p1\">[</bpt>To update the Sequential workflow<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateSequential)</ept>","source":"[To update the Sequential workflow](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateSequential)"},{"pos":[2494,2709],"content":"<bpt id=\"p1\">[</bpt>To update WorkflowVersionMap to include the previous workflow versions<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateWorkflowVersionMap)</ept>","source":"[To update WorkflowVersionMap to include the previous workflow versions](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_UpdateWorkflowVersionMap)"},{"pos":[2719,2883],"content":"<bpt id=\"p1\">[</bpt>To build and run the application<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_BuildAndRun)</ept>","source":"[To build and run the application](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md#BKMK_BuildAndRun)"},{"pos":[2891,3298],"content":"[!NOTE]\n Before following the steps in this topic, run the application, start several workflows of each type, and making one or two guesses for each one. These persisted workflows are used in this step and the following step, [How to: Update the Definition of a Running Workflow Instance](../../../docs/framework/windows-workflow-foundation/how-to-update-the-definition-of-a-running-workflow-instance.md).","leadings":["","> "],"nodes":[{"content":" Before following the steps in this topic, run the application, start several workflows of each type, and making one or two guesses for each one. These persisted workflows are used in this step and the following step, [How to: Update the Definition of a Running Workflow Instance](../../../docs/framework/windows-workflow-foundation/how-to-update-the-definition-of-a-running-workflow-instance.md).","pos":[8,405],"nodes":[{"content":"Before following the steps in this topic, run the application, start several workflows of each type, and making one or two guesses for each one.","pos":[1,145]},{"content":"These persisted workflows are used in this step and the following step, <bpt id=\"p1\">[</bpt>How to: Update the Definition of a Running Workflow Instance<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-update-the-definition-of-a-running-workflow-instance.md)</ept>.","pos":[146,397],"source":" These persisted workflows are used in this step and the following step, [How to: Update the Definition of a Running Workflow Instance](../../../docs/framework/windows-workflow-foundation/how-to-update-the-definition-of-a-running-workflow-instance.md)."}]}]},{"pos":[3306,3602],"content":"[!NOTE]\n Each step in the Getting Started tutorial depends on the previous steps. If you did not complete the previous steps you can download a completed version of the tutorial from [Windows Workflow Foundation (WF45) - Getting Started Tutorial](http://go.microsoft.com/fwlink/?LinkID=248976).","leadings":["","> "],"nodes":[{"content":" Each step in the Getting Started tutorial depends on the previous steps. If you did not complete the previous steps you can download a completed version of the tutorial from [Windows Workflow Foundation (WF45) - Getting Started Tutorial](http://go.microsoft.com/fwlink/?LinkID=248976).","pos":[8,294],"nodes":[{"content":"Each step in the Getting Started tutorial depends on the previous steps.","pos":[1,73]},{"content":"If you did not complete the previous steps you can download a completed version of the tutorial from <bpt id=\"p1\">[</bpt>Windows Workflow Foundation (WF45) - Getting Started Tutorial<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=248976)</ept>.","pos":[74,286],"source":" If you did not complete the previous steps you can download a completed version of the tutorial from [Windows Workflow Foundation (WF45) - Getting Started Tutorial](http://go.microsoft.com/fwlink/?LinkID=248976)."}]}]},{"pos":[3613,3703],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_BackupCopy\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> To make a copy of the NumberGuessWorkflowActivities project","linkify":"<a name=\"BKMK_BackupCopy\"></a> To make a copy of the NumberGuessWorkflowActivities project","source":"<a name=\"BKMK_BackupCopy\"></a> To make a copy of the NumberGuessWorkflowActivities project"},{"pos":[3713,3852],"content":"Open the <bpt id=\"p1\">**</bpt>WF45GettingStartedTutorial<ept id=\"p1\">**</ept> solution in <ph id=\"ph1\">[!INCLUDE[vs_current_long](../../../includes/vs-current-long-md.md)]</ph> if it is not open.","source":"Open the **WF45GettingStartedTutorial** solution in [!INCLUDE[vs_current_long](../../../includes/vs-current-long-md.md)] if it is not open."},{"content":"Press CTRL+SHIFT+B to build the solution.","pos":[3862,3903]},{"pos":[3913,3963],"content":"Close the <bpt id=\"p1\">**</bpt>WF45GettingStartedTutorial<ept id=\"p1\">**</ept> solution.","source":"Close the **WF45GettingStartedTutorial** solution."},{"content":"Open Windows Explorer and navigate to the folder where the tutorial solution file and the project folders are located.","pos":[3973,4091]},{"content":"Create a new folder named <bpt id=\"p1\">**</bpt>PreviousVersions<ept id=\"p1\">**</ept> in the same folder as <bpt id=\"p2\">**</bpt>NumberGuessWorkflowHost<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>NumberGuessWorkflowActivities<ept id=\"p3\">**</ept>.","pos":[4101,4236],"source":"Create a new folder named **PreviousVersions** in the same folder as **NumberGuessWorkflowHost** and **NumberGuessWorkflowActivities**."},{"content":"This folder is used to contain the assemblies that contain the different versions of the workflows used in the subsequent tutorial steps.","pos":[4237,4374]},{"content":"Navigate to the <bpt id=\"p1\">**</bpt>NumberGuessWorkflowActivities\\bin\\debug<ept id=\"p1\">**</ept> folder (or <bpt id=\"p2\">**</bpt>bin\\release<ept id=\"p2\">**</ept> depending on your project settings).","pos":[4384,4507],"source":"Navigate to the **NumberGuessWorkflowActivities\\bin\\debug** folder (or **bin\\release** depending on your project settings)."},{"content":"Copy <bpt id=\"p1\">**</bpt>NumberGuessWorkflowActivities.dll<ept id=\"p1\">**</ept> and paste it into the <bpt id=\"p2\">**</bpt>PreviousVersions<ept id=\"p2\">**</ept> folder.","pos":[4508,4601],"source":" Copy **NumberGuessWorkflowActivities.dll** and paste it into the **PreviousVersions** folder."},{"pos":[4611,4735],"content":"Rename <bpt id=\"p1\">**</bpt>NumberGuessWorkflowActivities.dll<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>PreviousVersions<ept id=\"p2\">**</ept> folder to <bpt id=\"p3\">**</bpt>NumberGuessWorkflowActivities_v1.dll<ept id=\"p3\">**</ept>.","source":"Rename **NumberGuessWorkflowActivities.dll** in the **PreviousVersions** folder to **NumberGuessWorkflowActivities_v1.dll**."},{"pos":[4747,5003],"content":"[!NOTE]\nThe steps in this topic demonstrate one way to manage the assemblies used to contain multiple versions of the workflows. Other methods such as strong naming the assemblies and registering them in the global assembly cache could also be used.","leadings":["","    >  "],"nodes":[{"content":"The steps in this topic demonstrate one way to manage the assemblies used to contain multiple versions of the workflows. Other methods such as strong naming the assemblies and registering them in the global assembly cache could also be used.","pos":[8,249],"nodes":[{"content":"The steps in this topic demonstrate one way to manage the assemblies used to contain multiple versions of the workflows.","pos":[0,120]},{"content":"Other methods such as strong naming the assemblies and registering them in the global assembly cache could also be used.","pos":[121,241]}]}]},{"content":"Create a new folder named <bpt id=\"p1\">**</bpt>NumberGuessWorkflowActivities_du<ept id=\"p1\">**</ept> in the same folder as <bpt id=\"p2\">**</bpt>NumberGuessWorkflowHost<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>NumberGuessWorkflowActivities<ept id=\"p3\">**</ept>, and the newly added <bpt id=\"p4\">**</bpt>PreviousVersions<ept id=\"p4\">**</ept> folder, and copy all of the files and subfolders from the <bpt id=\"p5\">**</bpt>NumberGuessWorkflowActivities<ept id=\"p5\">**</ept> folder into the new <bpt id=\"p6\">**</bpt>NumberGuessWorkflowActivities_du<ept id=\"p6\">**</ept> folder.","pos":[5013,5359],"source":"Create a new folder named **NumberGuessWorkflowActivities_du** in the same folder as **NumberGuessWorkflowHost**, **NumberGuessWorkflowActivities**, and the newly added **PreviousVersions** folder, and copy all of the files and subfolders from the **NumberGuessWorkflowActivities** folder into the new **NumberGuessWorkflowActivities_du** folder."},{"content":"This backup copy of the project for the initial version of the activities is used in <bpt id=\"p1\">[</bpt>How to: Update the Definition of a Running Workflow Instance<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-update-the-definition-of-a-running-workflow-instance.md)</ept>.","pos":[5360,5624],"source":" This backup copy of the project for the initial version of the activities is used in [How to: Update the Definition of a Running Workflow Instance](../../../docs/framework/windows-workflow-foundation/how-to-update-the-definition-of-a-running-workflow-instance.md)."},{"pos":[5633,5757],"content":"Re-open the <bpt id=\"p1\">**</bpt>WF45GettingStartedTutorial<ept id=\"p1\">**</ept> solution in <ph id=\"ph1\">[!INCLUDE[vs_current_long](../../../includes/vs-current-long-md.md)]</ph>.","source":"Re-open the **WF45GettingStartedTutorial** solution in [!INCLUDE[vs_current_long](../../../includes/vs-current-long-md.md)]."},{"pos":[5768,5827],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_UpdateWorkflows\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> To update the workflows","linkify":"<a name=\"BKMK_UpdateWorkflows\"></a> To update the workflows","source":"<a name=\"BKMK_UpdateWorkflows\"></a> To update the workflows"},{"content":"In this section, the workflow definitions are updated.","pos":[5831,5885]},{"content":"The two <ph id=\"ph1\">`WriteLine`</ph> activities that give feedback on the user's guess are updated, and a new <ph id=\"ph2\">`WriteLine`</ph> activity is added that provides additional information about the game once the number is guessed.","pos":[5886,6088],"source":" The two `WriteLine` activities that give feedback on the user's guess are updated, and a new `WriteLine` activity is added that provides additional information about the game once the number is guessed."},{"pos":[6100,6174],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_UpdateStateMachine\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> To update the StateMachine workflow","linkify":"<a name=\"BKMK_UpdateStateMachine\"></a> To update the StateMachine workflow","source":"<a name=\"BKMK_UpdateStateMachine\"></a> To update the StateMachine workflow"},{"pos":[6184,6317],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, under the <bpt id=\"p2\">**</bpt>NumberGuessWorkflowActivities<ept id=\"p2\">**</ept> project, double-click <bpt id=\"p3\">**</bpt>StateMachineNumberGuessWorkflow.xaml<ept id=\"p3\">**</ept>.","source":"In **Solution Explorer**, under the **NumberGuessWorkflowActivities** project, double-click **StateMachineNumberGuessWorkflow.xaml**."},{"pos":[6327,6396],"content":"Double-click the <bpt id=\"p1\">**</bpt>Guess Incorrect<ept id=\"p1\">**</ept> transition on the state machine.","source":"Double-click the **Guess Incorrect** transition on the state machine."},{"pos":[6406,6474],"content":"Update the <ph id=\"ph1\">`Text`</ph> of the left-most <ph id=\"ph2\">`WriteLine`</ph> in the <ph id=\"ph3\">`If`</ph> activity.","source":"Update the `Text` of the left-most `WriteLine` in the `If` activity."},{"pos":[6596,6665],"content":"Update the <ph id=\"ph1\">`Text`</ph> of the right-most <ph id=\"ph2\">`WriteLine`</ph> in the <ph id=\"ph3\">`If`</ph> activity.","source":"Update the `Text` of the right-most `WriteLine` in the `If` activity."},{"pos":[6789,6946],"content":"Return to the overall state machine view in the workflow designer by clicking <bpt id=\"p1\">**</bpt>StateMachine<ept id=\"p1\">**</ept> in the breadcrumb display at the top of the workflow designer.","source":"Return to the overall state machine view in the workflow designer by clicking **StateMachine** in the breadcrumb display at the top of the workflow designer."},{"pos":[6956,7023],"content":"Double-click the <bpt id=\"p1\">**</bpt>Guess Correct<ept id=\"p1\">**</ept> transition on the state machine.","source":"Double-click the **Guess Correct** transition on the state machine."},{"pos":[7033,7187],"content":"Drag a <bpt id=\"p1\">**</bpt>WriteLine<ept id=\"p1\">**</ept> activity from the <bpt id=\"p2\">**</bpt>Primitives<ept id=\"p2\">**</ept> section of the <bpt id=\"p3\">**</bpt>Toolbox<ept id=\"p3\">**</ept> and drop it on the <bpt id=\"p4\">**</bpt>Drop Action activity here<ept id=\"p4\">**</ept> label of the transition.","source":"Drag a **WriteLine** activity from the **Primitives** section of the **Toolbox** and drop it on the **Drop Action activity here** label of the transition."},{"pos":[7197,7256],"content":"Type the following expression into the <ph id=\"ph1\">`Text`</ph> property box.","source":"Type the following expression into the `Text` property box."},{"pos":[7458,7526],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_UpdateFlowchart\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> To update the Flowchart workflow","linkify":"<a name=\"BKMK_UpdateFlowchart\"></a> To update the Flowchart workflow","source":"<a name=\"BKMK_UpdateFlowchart\"></a> To update the Flowchart workflow"},{"pos":[7536,7666],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, under the <bpt id=\"p2\">**</bpt>NumberGuessWorkflowActivities<ept id=\"p2\">**</ept> project, double-click <bpt id=\"p3\">**</bpt>FlowchartNumberGuessWorkflow.xaml<ept id=\"p3\">**</ept>.","source":"In **Solution Explorer**, under the **NumberGuessWorkflowActivities** project, double-click **FlowchartNumberGuessWorkflow.xaml**."},{"pos":[7676,7732],"content":"Update the <ph id=\"ph1\">`Text`</ph> of the left-most <ph id=\"ph2\">`WriteLine`</ph> activity.","source":"Update the `Text` of the left-most `WriteLine` activity."},{"pos":[7854,7911],"content":"Update the <ph id=\"ph1\">`Text`</ph> of the right-most <ph id=\"ph2\">`WriteLine`</ph> activity.","source":"Update the `Text` of the right-most `WriteLine` activity."},{"content":"Drag a <bpt id=\"p1\">**</bpt>WriteLine<ept id=\"p1\">**</ept> activity from the <bpt id=\"p2\">**</bpt>Primitives<ept id=\"p2\">**</ept> section of the <bpt id=\"p3\">**</bpt>Toolbox<ept id=\"p3\">**</ept> and drop it on the drop point of the <ph id=\"ph1\">`True`</ph> action of the topmost <ph id=\"ph2\">`FlowDecision`</ph>.","pos":[8035,8197],"source":"Drag a **WriteLine** activity from the **Primitives** section of the **Toolbox** and drop it on the drop point of the `True` action of the topmost `FlowDecision`."},{"content":"The <ph id=\"ph1\">`WriteLine`</ph> activity is added to the flowchart and linked to the <ph id=\"ph2\">`True`</ph> action of the <ph id=\"ph3\">`FlowDecision`</ph>.","pos":[8198,8303],"source":" The `WriteLine` activity is added to the flowchart and linked to the `True` action of the `FlowDecision`."},{"pos":[8313,8372],"content":"Type the following expression into the <ph id=\"ph1\">`Text`</ph> property box.","source":"Type the following expression into the `Text` property box."},{"pos":[8574,8644],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_UpdateSequential\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> To update the Sequential workflow","linkify":"<a name=\"BKMK_UpdateSequential\"></a> To update the Sequential workflow","source":"<a name=\"BKMK_UpdateSequential\"></a> To update the Sequential workflow"},{"pos":[8654,8785],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, under the <bpt id=\"p2\">**</bpt>NumberGuessWorkflowActivities<ept id=\"p2\">**</ept> project, double-click <bpt id=\"p3\">**</bpt>SequentialNumberGuessWorkflow.xaml<ept id=\"p3\">**</ept>.","source":"In **Solution Explorer**, under the **NumberGuessWorkflowActivities** project, double-click **SequentialNumberGuessWorkflow.xaml**."},{"pos":[8795,8863],"content":"Update the <ph id=\"ph1\">`Text`</ph> of the left-most <ph id=\"ph2\">`WriteLine`</ph> in the <ph id=\"ph3\">`If`</ph> activity.","source":"Update the `Text` of the left-most `WriteLine` in the `If` activity."},{"pos":[8985,9063],"content":"Update the <ph id=\"ph1\">`Text`</ph> of the right-most <ph id=\"ph2\">`WriteLine`</ph> activity in the <ph id=\"ph3\">`If`</ph> activity.","source":"Update the `Text` of the right-most `WriteLine` activity in the `If` activity."},{"pos":[9187,9391],"content":"Drag a <bpt id=\"p1\">**</bpt>WriteLine<ept id=\"p1\">**</ept> activity from the <bpt id=\"p2\">**</bpt>Primitives<ept id=\"p2\">**</ept> section of the <bpt id=\"p3\">**</bpt>Toolbox<ept id=\"p3\">**</ept> and drop it after the <bpt id=\"p4\">**</bpt>DoWhile<ept id=\"p4\">**</ept> activity so that the <bpt id=\"p5\">**</bpt>WriteLine<ept id=\"p5\">**</ept> is the final activity in the root <ph id=\"ph1\">`Sequence`</ph> activity.","source":"Drag a **WriteLine** activity from the **Primitives** section of the **Toolbox** and drop it after the **DoWhile** activity so that the **WriteLine** is the final activity in the root `Sequence` activity."},{"pos":[9401,9460],"content":"Type the following expression into the <ph id=\"ph1\">`Text`</ph> property box.","source":"Type the following expression into the `Text` property box."},{"pos":[9661,9776],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_UpdateWorkflowVersionMap\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> To update WorkflowVersionMap to include the previous workflow versions","linkify":"<a name=\"BKMK_UpdateWorkflowVersionMap\"></a> To update WorkflowVersionMap to include the previous workflow versions","source":"<a name=\"BKMK_UpdateWorkflowVersionMap\"></a> To update WorkflowVersionMap to include the previous workflow versions"},{"pos":[9786,9913],"content":"Double-click <bpt id=\"p1\">**</bpt>WorkflowVersionMap.cs<ept id=\"p1\">**</ept> (or <bpt id=\"p2\">**</bpt>WorkflowVersionMap.vb<ept id=\"p2\">**</ept>) under the <bpt id=\"p3\">**</bpt>NumberGuessWorkflowHost<ept id=\"p3\">**</ept> project to open it.","source":"Double-click **WorkflowVersionMap.cs** (or **WorkflowVersionMap.vb**) under the **NumberGuessWorkflowHost** project to open it."},{"pos":[9923,10047],"content":"Add the following <ph id=\"ph1\">`using`</ph> (or <ph id=\"ph2\">`Imports`</ph>) statements to the top of the file with the other <ph id=\"ph3\">`using`</ph> (or <ph id=\"ph4\">`Imports`</ph>) statements.","source":"Add the following `using` (or `Imports`) statements to the top of the file with the other `using` (or `Imports`) statements."},{"content":"Add three new workflow identities just below the three existing workflow identity declarations.","pos":[10221,10316]},{"content":"These new <ph id=\"ph1\">`v1`</ph> workflow identities will be used provide the correct workflow definition to workflows started before the updates were made.","pos":[10317,10455],"source":" These new `v1` workflow identities will be used provide the correct workflow definition to workflows started before the updates were made."},{"pos":[11451,11576],"content":"In the <ph id=\"ph1\">`WorkflowVersionMap`</ph> constructor, update the <ph id=\"ph2\">`Version`</ph> property of the three current workflow identities to <ph id=\"ph3\">`2.0.0.0`</ph>.","source":"In the `WorkflowVersionMap` constructor, update the `Version` property of the three current workflow identities to `2.0.0.0`."},{"content":"The code in that adds the current versions of the workflows to the dictionary uses the current versions that are referenced in the project, so the code that initializes the workflow definitions does not need to be updated.","pos":[13450,13672]},{"content":"Add the following code in the constructor just after the code that adds the current versions to the dictionary.","pos":[13682,13793]},{"content":"These workflow identities are associated with the initial versions of the corresponding workflow definitions.","pos":[15052,15161]},{"content":"Next, load the assembly that contains the initial version of the workflow definitions, and create and add the corresponding workflow definitions to the dictionary.","pos":[15171,15334]},{"pos":[17333,17422],"content":"The following example is the complete listing for the updated <ph id=\"ph1\">`WorkflowVersionMap`</ph> class.","source":"The following example is the complete listing for the updated `WorkflowVersionMap` class."},{"pos":[25314,25378],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_BuildAndRun\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> To build and run the application","linkify":"<a name=\"BKMK_BuildAndRun\"></a> To build and run the application","source":"<a name=\"BKMK_BuildAndRun\"></a> To build and run the application"},{"content":"Press CTRL+SHIFT+B to build the application, and then CTRL+F5 to start.","pos":[25388,25459]},{"content":"Start a new workflow by clicking <bpt id=\"p1\">**</bpt>New Game<ept id=\"p1\">**</ept>.","pos":[25469,25515],"source":"Start a new workflow by clicking **New Game**."},{"content":"The version of the workflow is displayed under the status window and reflects the updated version from the associated <ph id=\"ph1\">`WorkflowIdentity`</ph>.","pos":[25516,25653],"source":" The version of the workflow is displayed under the status window and reflects the updated version from the associated `WorkflowIdentity`."},{"content":"Make a note of the <ph id=\"ph1\">`InstanceId`</ph> so you can view the tracking file for the workflow when it completes, and then enter guesses until the game is complete.","pos":[25654,25806],"source":" Make a note of the `InstanceId` so you can view the tracking file for the workflow when it completes, and then enter guesses until the game is complete."},{"content":"Note how the user's guess is displayed in the information displayed in the status window based on the updates to the <ph id=\"ph1\">`WriteLine`</ph> activities.","pos":[25807,25947],"source":" Note how the user's guess is displayed in the information displayed in the status window based on the updates to the `WriteLine` activities."},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[25954,25997],"source":"**Please enter a number between 1 and 10** "},{"content":"<bpt id=\"p1\">**</bpt>5 is too high.<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[26000,26019],"source":"**5 is too high.** "},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[26022,26065],"source":"**Please enter a number between 1 and 10** "},{"content":"<bpt id=\"p1\">**</bpt>3 is too high.<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[26068,26087],"source":"**3 is too high.** "},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[26090,26133],"source":"**Please enter a number between 1 and 10** "},{"content":"<bpt id=\"p1\">**</bpt>1 is too low.<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[26136,26154],"source":"**1 is too low.** "},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[26157,26200],"source":"**Please enter a number between 1 and 10** "},{"content":"<bpt id=\"p1\">**</bpt>Congratulations, you guessed the number in 4 turns.<ept id=\"p1\">**</ept>","pos":[26203,26258],"source":"**Congratulations, you guessed the number in 4 turns.**"},{"pos":[26269,26863],"content":"[!NOTE]\nThe updated text from the `WriteLine` activities is displayed, but the output of the final `WriteLine` activity that was added in this topic is not. That is because the status window is updated by the `PersistableIdle` handler. Because the workflow completes and does not go idle after the final activity, the `PersistableIdle` handler is not called. However, a similar message is displayed in the status window by the `Completed` handler. If desired, code could be added to the `Completed` handler to extract the text from the `StringWriter` and display it to the status window.","leadings":["","    >  "],"nodes":[{"content":"The updated text from the `WriteLine` activities is displayed, but the output of the final `WriteLine` activity that was added in this topic is not. That is because the status window is updated by the `PersistableIdle` handler. Because the workflow completes and does not go idle after the final activity, the `PersistableIdle` handler is not called. However, a similar message is displayed in the status window by the `Completed` handler. If desired, code could be added to the `Completed` handler to extract the text from the `StringWriter` and display it to the status window.","pos":[8,587],"nodes":[{"content":"The updated text from the <ph id=\"ph1\">`WriteLine`</ph> activities is displayed, but the output of the final <ph id=\"ph2\">`WriteLine`</ph> activity that was added in this topic is not.","pos":[0,148],"source":"The updated text from the `WriteLine` activities is displayed, but the output of the final `WriteLine` activity that was added in this topic is not."},{"content":"That is because the status window is updated by the <ph id=\"ph1\">`PersistableIdle`</ph> handler.","pos":[149,227],"source":" That is because the status window is updated by the `PersistableIdle` handler."},{"content":"Because the workflow completes and does not go idle after the final activity, the <ph id=\"ph1\">`PersistableIdle`</ph> handler is not called.","pos":[228,350],"source":" Because the workflow completes and does not go idle after the final activity, the `PersistableIdle` handler is not called."},{"content":"However, a similar message is displayed in the status window by the <ph id=\"ph1\">`Completed`</ph> handler.","pos":[351,439],"source":" However, a similar message is displayed in the status window by the `Completed` handler."},{"content":"If desired, code could be added to the <ph id=\"ph1\">`Completed`</ph> handler to extract the text from the <ph id=\"ph2\">`StringWriter`</ph> and display it to the status window.","pos":[440,579],"source":" If desired, code could be added to the `Completed` handler to extract the text from the `StringWriter` and display it to the status window."}]}]},{"content":"Open Windows Explorer and navigate to the <bpt id=\"p1\">**</bpt>NumberGuessWorkflowHost\\bin\\debug<ept id=\"p1\">**</ept> folder (or <bpt id=\"p2\">**</bpt>bin\\release<ept id=\"p2\">**</ept> depending on your project settings) and open the tracking file using Notepad that corresponds to the completed workflow.","pos":[26873,27100],"source":"Open Windows Explorer and navigate to the **NumberGuessWorkflowHost\\bin\\debug** folder (or **bin\\release** depending on your project settings) and open the tracking file using Notepad that corresponds to the completed workflow."},{"content":"If you did not make a note of the <ph id=\"ph1\">`InstanceId`</ph>, you can identify the correct tracking file by using the <bpt id=\"p1\">**</bpt>Date modified<ept id=\"p1\">**</ept> information in Windows Explorer.","pos":[27101,27255],"source":" If you did not make a note of the `InstanceId`, you can identify the correct tracking file by using the **Date modified** information in Windows Explorer."},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[27262,27305],"source":"**Please enter a number between 1 and 10** "},{"content":"<bpt id=\"p1\">**</bpt>5 is too high.<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[27308,27327],"source":"**5 is too high.** "},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[27330,27373],"source":"**Please enter a number between 1 and 10** "},{"content":"<bpt id=\"p1\">**</bpt>3 is too high.<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[27376,27395],"source":"**3 is too high.** "},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[27398,27441],"source":"**Please enter a number between 1 and 10** "},{"content":"<bpt id=\"p1\">**</bpt>1 is too low.<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[27444,27462],"source":"**1 is too low.** "},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[27465,27508],"source":"**Please enter a number between 1 and 10** "},{"content":"<bpt id=\"p1\">**</bpt>2 is correct. You guessed it in 4 turns.<ept id=\"p1\">**</ept>","pos":[27511,27555],"source":"**2 is correct. You guessed it in 4 turns.**"},{"content":"The updated <ph id=\"ph1\">`WriteLine`</ph> output is contained within the tracking file, including the output of the <ph id=\"ph2\">`WriteLine`</ph> that was added in this topic.","pos":[27561,27700],"source":"      The updated `WriteLine` output is contained within the tracking file, including the output of the `WriteLine` that was added in this topic."},{"content":"Switch back to the number guessing application and select one of the workflows that was started before the updates were made.","pos":[27710,27835]},{"content":"You can identify the version of the currently selected workflow by looking at the version information that is displayed below the status window.","pos":[27836,27980]},{"content":"Enter some guesses and note that the status updates match the <ph id=\"ph1\">`WriteLine`</ph> activity output from the previous version, and do not include the user's guess.","pos":[27981,28134],"source":" Enter some guesses and note that the status updates match the `WriteLine` activity output from the previous version, and do not include the user's guess."},{"content":"That is because these workflows are using the previous workflow definition that does not have the <ph id=\"ph1\">`WriteLine`</ph> updates.","pos":[28135,28253],"source":" That is because these workflows are using the previous workflow definition that does not have the `WriteLine` updates."},{"pos":[28264,28570],"content":"In the next step, <bpt id=\"p1\">[</bpt>How to: Update the Definition of a Running Workflow Instance<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-update-the-definition-of-a-running-workflow-instance.md)</ept>, the running <ph id=\"ph1\">`v1`</ph> workflow instances are updated so they contain the new functionality as the <ph id=\"ph2\">`v2`</ph> instances.","source":"In the next step, [How to: Update the Definition of a Running Workflow Instance](../../../docs/framework/windows-workflow-foundation/how-to-update-the-definition-of-a-running-workflow-instance.md), the running `v1` workflow instances are updated so they contain the new functionality as the `v2` instances."}]}