{"content":"---\ntitle: \"&lt;add&gt; | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 4712a888-f154-4395-8887-ef14a88a6497\ncaps.latest.revision: 7\nauthor: \"BrucePerlerMS\"\nms.author: \"bruceper\"\nmanager: \"mbaldwin\"\n---\n# &lt;add&gt;\nAdds the specified security token handler to the token handler collection.  \n  \n \\<system.identityModel>  \n\\<identityConfiguration>  \n\\<securityTokenHandlers>  \n\\<add>  \n  \n## Syntax  \n  \n```  \n<system.identityModel>  \n  <identityConfiguration>  \n    <securityTokenHandlers>  \n      <add type=xs:string>  \n        <optionalConfigurationElement>  \n        </optionalConfigurationElement>  \n      </add>  \n    </securityTokenHandlers>  \n  </identityConfiguration>  \n</system.identityModel>  \n```  \n  \n## Attributes and Elements  \n The following sections describe attributes, child elements, and parent elements.  \n  \n### Attributes  \n  \n|Attribute|Description|  \n|---------------|-----------------|  \n|type|The CLR type name of the token handler to be added. For more information about how to specify the `type` attribute, see [Custom Type References](http://msdn.microsoft.com/en-us/7286d2e3-c63d-49fd-abdc-ce2705f22c24).|  \n  \n### Child Elements  \n  \n|Element|Description|  \n|-------------|-----------------|  \n|[\\<samlSecurityTokenRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/samlsecuritytokenrequirement.md)|Provides configuration for the <xref:System.IdentityModel.Tokens.SamlSecurityTokenHandler> class, the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler> class, or a derived class of either of these classes.|  \n|[\\<sessionTokenRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/sessiontokenrequirement.md)|Provides configuration for the <xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler> class or derived classes.|  \n|[\\<userNameSecurityTokenHandlerRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/usernamesecuritytokenhandlerrequirement.md)|Provides configuration for the <xref:System.IdentityModel.Services.Tokens.MembershipUserNameSecurityTokenHandler> class or derived classes.|  \n|[\\<x509SecurityTokenHandlerRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/x509securitytokenhandlerrequirement.md)|Provides optional configuration for the <xref:System.IdentityModel.Tokens.X509SecurityTokenHandler> class or derived classes.|  \n  \n### Parent Elements  \n  \n|Element|Description|  \n|-------------|-----------------|  \n|[\\<securityTokenHandlers>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/securitytokenhandlers.md)|Specifies a collection of security token handlers that are registered with the endpoint.|  \n  \n## Remarks  \n The `<add>` element can take a single child element that specifies the configuration for the token handler. This is dependent on whether the handler class referenced through the `type` attribute of the `<add>` element provides support for this feature. Token handler classes that provide this feature must expose a constructor that takes an <xref:System.Xml.XmlElement> object.  \n  \n```  \npublic class CustomTokenHandler : Microsoft.IdentityModel.Tokens.SecurityTokenHandler  \n{  \n    public CustomTokenHandler( XmlElement customConfig )  \n    {  \n    }  \n}  \n```  \n  \n Several of the built-in security token handler classes do provide this functionality. These classes are <xref:System.IdentityModel.Tokens.SamlSecurityTokenHandler>, <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler>, <xref:System.IdentityModel.Services.Tokens.MembershipUserNameSecurityTokenHandler>, <xref:System.IdentityModel.Tokens.X509SecurityTokenHandler>, and <xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler>.  \n  \n> [!IMPORTANT]\n>  The token handler collection can only contain a single handler of any given type. This means, for example, that if you want to add a handler that is derived from the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler> class to the collection, you must first remove the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler>, which is present by default, from the collection. You can use the [\\<remove>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/remove.md) element to remove a single handler from the collection or use the [\\<clear>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/clear.md) element to remove all handlers from the collection.  \n  \n Settings specified on a handler override equivalent settings specified on the token handler collection under the [\\<securityTokenHandlerConfiguration>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/securitytokenhandlerconfiguration.md) element and those specified at the service-level under the [\\<identityConfiguration>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/identityconfiguration.md) element.  \n  \n## Example  \n The following XML shows the use of the `<add>` and `<remove>` elements to replace the default session token handler with a custom session token handler. The XML is taken from the `ClaimsAwareWebFarm` sample.  \n  \n```  \n<securityTokenHandlers>  \n  <remove type=\"System.IdentityModel.Tokens.SessionSecurityTokenHandler, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" />  \n  <add type=\"System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" />  \n</securityTokenHandlers>  \n```\n","nodes":[{"pos":[12,40],"content":"&lt;add&gt; | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"<ph id=\"ph1\">&amp;lt;</ph>add<ph id=\"ph2\">&amp;gt;</ph> | Microsoft Docs","pos":[0,28],"source":"&lt;add&gt; | Microsoft Docs"}]},{"pos":[349,360],"content":"&lt;add&gt;","linkify":"&lt;add&gt;","nodes":[{"content":"<ph id=\"ph1\">&amp;lt;</ph>add<ph id=\"ph2\">&amp;gt;</ph>","pos":[0,11],"source":"&lt;add&gt;"}]},{"content":"Adds the specified security token handler to the token handler collection.","pos":[361,435]},{"content":"<ph id=\"ph1\">\\&lt;</ph>system.identityModel&gt;","pos":[442,465],"source":"\\<system.identityModel>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>identityConfiguration&gt;","pos":[468,492],"source":"\\<identityConfiguration>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>securityTokenHandlers&gt;","pos":[495,519],"source":"\\<securityTokenHandlers>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>add&gt;","pos":[522,528],"source":"\\<add>"},{"pos":[537,543],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[863,886],"content":"Attributes and Elements","linkify":"Attributes and Elements","nodes":[{"content":"Attributes and Elements","pos":[0,23]}]},{"content":"The following sections describe attributes, child elements, and parent elements.","pos":[890,970]},{"pos":[980,990],"content":"Attributes","linkify":"Attributes","nodes":[{"content":"Attributes","pos":[0,10]}]},{"content":"Attribute","pos":[997,1006]},{"content":"Description","pos":[1007,1018]},{"content":"type","pos":[1061,1065]},{"content":"The CLR type name of the token handler to be added.","pos":[1066,1117]},{"content":"For more information about how to specify the <ph id=\"ph1\">`type`</ph> attribute, see <bpt id=\"p1\">[</bpt>Custom Type References<ept id=\"p1\">](http://msdn.microsoft.com/en-us/7286d2e3-c63d-49fd-abdc-ce2705f22c24)</ept>.","pos":[1118,1281],"source":" For more information about how to specify the `type` attribute, see [Custom Type References](http://msdn.microsoft.com/en-us/7286d2e3-c63d-49fd-abdc-ce2705f22c24)."},{"pos":[1292,1306],"content":"Child Elements","linkify":"Child Elements","nodes":[{"content":"Child Elements","pos":[0,14]}]},{"content":"Element","pos":[1313,1320]},{"content":"Description","pos":[1321,1332]},{"pos":[1373,1524],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>samlSecurityTokenRequirement&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/samlsecuritytokenrequirement.md)</ept>","source":"[\\<samlSecurityTokenRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/samlsecuritytokenrequirement.md)"},{"content":"Provides configuration for the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Tokens.SamlSecurityTokenHandler&gt;</ph> class, the <ph id=\"ph2\">&lt;xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler&gt;</ph> class, or a derived class of either of these classes.","pos":[1525,1741],"source":"Provides configuration for the <xref:System.IdentityModel.Tokens.SamlSecurityTokenHandler> class, the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler> class, or a derived class of either of these classes."},{"pos":[1746,1887],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>sessionTokenRequirement&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/sessiontokenrequirement.md)</ept>","source":"[\\<sessionTokenRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/sessiontokenrequirement.md)"},{"content":"Provides configuration for the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler&gt;</ph> class or derived classes.","pos":[1888,2007],"source":"Provides configuration for the <xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler> class or derived classes."},{"pos":[2012,2185],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>userNameSecurityTokenHandlerRequirement&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/usernamesecuritytokenhandlerrequirement.md)</ept>","source":"[\\<userNameSecurityTokenHandlerRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/usernamesecuritytokenhandlerrequirement.md)"},{"content":"Provides configuration for the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Services.Tokens.MembershipUserNameSecurityTokenHandler&gt;</ph> class or derived classes.","pos":[2186,2325],"source":"Provides configuration for the <xref:System.IdentityModel.Services.Tokens.MembershipUserNameSecurityTokenHandler> class or derived classes."},{"pos":[2330,2495],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>x509SecurityTokenHandlerRequirement&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/x509securitytokenhandlerrequirement.md)</ept>","source":"[\\<x509SecurityTokenHandlerRequirement>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/x509securitytokenhandlerrequirement.md)"},{"content":"Provides optional configuration for the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Tokens.X509SecurityTokenHandler&gt;</ph> class or derived classes.","pos":[2496,2621],"source":"Provides optional configuration for the <xref:System.IdentityModel.Tokens.X509SecurityTokenHandler> class or derived classes."},{"pos":[2632,2647],"content":"Parent Elements","linkify":"Parent Elements","nodes":[{"content":"Parent Elements","pos":[0,15]}]},{"content":"Element","pos":[2654,2661]},{"content":"Description","pos":[2662,2673]},{"pos":[2714,2851],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>securityTokenHandlers&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/securitytokenhandlers.md)</ept>","source":"[\\<securityTokenHandlers>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/securitytokenhandlers.md)"},{"content":"Specifies a collection of security token handlers that are registered with the endpoint.","pos":[2852,2940]},{"pos":[2950,2957],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`&lt;add&gt;`</ph> element can take a single child element that specifies the configuration for the token handler.","pos":[2961,3068],"source":"The `<add>` element can take a single child element that specifies the configuration for the token handler."},{"content":"This is dependent on whether the handler class referenced through the <ph id=\"ph1\">`type`</ph> attribute of the <ph id=\"ph2\">`&lt;add&gt;`</ph> element provides support for this feature.","pos":[3069,3213],"source":" This is dependent on whether the handler class referenced through the `type` attribute of the `<add>` element provides support for this feature."},{"content":"Token handler classes that provide this feature must expose a constructor that takes an <ph id=\"ph1\">&lt;xref:System.Xml.XmlElement&gt;</ph> object.","pos":[3214,3338],"source":" Token handler classes that provide this feature must expose a constructor that takes an <xref:System.Xml.XmlElement> object."},{"content":"Several of the built-in security token handler classes do provide this functionality.","pos":[3531,3616]},{"content":"These classes are <ph id=\"ph1\">&lt;xref:System.IdentityModel.Tokens.SamlSecurityTokenHandler&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.IdentityModel.Services.Tokens.MembershipUserNameSecurityTokenHandler&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.IdentityModel.Tokens.X509SecurityTokenHandler&gt;</ph>, and <ph id=\"ph5\">&lt;xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler&gt;</ph>.","pos":[3617,3970],"source":" These classes are <xref:System.IdentityModel.Tokens.SamlSecurityTokenHandler>, <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler>, <xref:System.IdentityModel.Services.Tokens.MembershipUserNameSecurityTokenHandler>, <xref:System.IdentityModel.Tokens.X509SecurityTokenHandler>, and <xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler>."},{"pos":[3978,4731],"content":"[!IMPORTANT]\n The token handler collection can only contain a single handler of any given type. This means, for example, that if you want to add a handler that is derived from the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler> class to the collection, you must first remove the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler>, which is present by default, from the collection. You can use the [\\<remove>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/remove.md) element to remove a single handler from the collection or use the [\\<clear>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/clear.md) element to remove all handlers from the collection.","leadings":["","> "],"nodes":[{"content":" The token handler collection can only contain a single handler of any given type. This means, for example, that if you want to add a handler that is derived from the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler> class to the collection, you must first remove the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler>, which is present by default, from the collection. You can use the [\\<remove>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/remove.md) element to remove a single handler from the collection or use the [\\<clear>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/clear.md) element to remove all handlers from the collection.","pos":[13,751],"nodes":[{"content":"The token handler collection can only contain a single handler of any given type.","pos":[1,82]},{"content":"This means, for example, that if you want to add a handler that is derived from the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler&gt;</ph> class to the collection, you must first remove the <ph id=\"ph2\">&lt;xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler&gt;</ph>, which is present by default, from the collection.","pos":[83,390],"source":" This means, for example, that if you want to add a handler that is derived from the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler> class to the collection, you must first remove the <xref:System.IdentityModel.Tokens.Saml2SecurityTokenHandler>, which is present by default, from the collection."},{"content":"You can use the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>remove&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/remove.md)</ept> element to remove a single handler from the collection or use the <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>clear&gt;<ept id=\"p2\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/clear.md)</ept> element to remove all handlers from the collection.","pos":[391,738],"source":" You can use the [\\<remove>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/remove.md) element to remove a single handler from the collection or use the [\\<clear>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/clear.md) element to remove all handlers from the collection."}]}]},{"pos":[4738,5218],"content":"Settings specified on a handler override equivalent settings specified on the token handler collection under the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>securityTokenHandlerConfiguration&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/securitytokenhandlerconfiguration.md)</ept> element and those specified at the service-level under the <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>identityConfiguration&gt;<ept id=\"p2\">](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/identityconfiguration.md)</ept> element.","source":"Settings specified on a handler override equivalent settings specified on the token handler collection under the [\\<securityTokenHandlerConfiguration>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/securitytokenhandlerconfiguration.md) element and those specified at the service-level under the [\\<identityConfiguration>](../../../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/identityconfiguration.md) element."},{"pos":[5227,5234],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following XML shows the use of the <ph id=\"ph1\">`&lt;add&gt;`</ph> and <ph id=\"ph2\">`&lt;remove&gt;`</ph> elements to replace the default session token handler with a custom session token handler.","pos":[5238,5390],"source":"The following XML shows the use of the `<add>` and `<remove>` elements to replace the default session token handler with a custom session token handler."},{"content":"The XML is taken from the <ph id=\"ph1\">`ClaimsAwareWebFarm`</ph> sample.","pos":[5391,5445],"source":" The XML is taken from the `ClaimsAwareWebFarm` sample."}]}