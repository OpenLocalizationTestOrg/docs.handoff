{"content":"---\ntitle: \"Lambda expression will not be removed from this event handler\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"bc42326\"\n  - \"vbc42326\"\nhelpviewer_keywords: \n  - \"BC42326\"\nms.assetid: 63214dc6-0112-4245-8ebf-7c9e8f5a5782\n---\n# Lambda expression will not be removed from this event handler\nLambda expression will not be removed from this event handler. Assign the lambda expression to a variable and use the variable to add and remove the event.  \n  \n When lambda expressions are used with event handlers, you may not see the behavior you expect. The compiler generates a new method for each lambda expression definition, even if they are identical. Therefore, the following code displays `False`.  \n  \n```vb  \nModule Module1  \n  \n    Sub Main()  \n        Dim fun1 As ChangeInteger = Function(p As Integer) p + 1  \n        Dim fun2 As ChangeInteger = Function(p As Integer) p + 1  \n        Console.WriteLine(fun1 = fun2)  \n    End Sub  \n  \n    Delegate Function ChangeInteger(ByVal x As Integer) As Integer  \n  \nEnd Module  \n```  \n  \n When lambda expressions are used with event handlers, this may cause unexpected results. In the following example, the lambda expression added by `AddHandler` is not removed by the `RemoveHandler` statement.  \n  \n```vb  \nModule Module1  \n  \n    Event ProcessInteger(ByVal x As Integer)  \n  \n    Sub Main()  \n  \n        ' The following line adds one listener to the event.  \n        AddHandler ProcessInteger, Function(m As Integer) m  \n  \n        ' The following statement searches the current listeners   \n        ' for a match to remove. However, this lambda is not the same  \n        ' as the previous one, so nothing is removed.  \n        RemoveHandler ProcessInteger, Function(m As Integer) m  \n  \n    End Sub  \nEnd Module  \n```  \n  \n By default, this message is a warning. For more information about how to hide warnings or treat warnings as errors, see [Configuring Warnings in Visual Basic](/visualstudio/ide/configuring-warnings-in-visual-basic).  \n  \n **Error ID:** BC42326  \n  \n## To correct this error  \n  \n-   To avoid the warning and remove the lambda expression, assign the lambda expression to a variable and use the variable in both the `AddHandler` and `RemoveHandler` statements, as shown in the following example.  \n  \n```vb  \nModule Module1  \n  \n    Event ProcessInteger(ByVal x As Integer)  \n  \n    Dim PrintHandler As ProcessIntegerEventHandler  \n  \n    Sub Main()  \n  \n        ' Assign the lambda expression to a variable.  \n        PrintHandler = Function(m As Integer) m  \n  \n        ' Use the variable to add the listener.  \n        AddHandler ProcessInteger, PrintHandler  \n  \n        ' Use the variable again when you want to remove the listener.  \n        RemoveHandler ProcessInteger, PrintHandler  \n  \n    End Sub  \nEnd Module  \n```  \n  \n## See also\n\n- [Lambda Expressions](../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)\n- [Relaxed Delegate Conversion](../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)\n- [Events](../../../visual-basic/programming-guide/language-features/events/index.md)\n","nodes":[{"pos":[4,222],"embed":true,"restype":"x-metadata","content":"title: \"Lambda expression will not be removed from this event handler\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"bc42326\"\n  - \"vbc42326\"\nhelpviewer_keywords: \n  - \"BC42326\"\nms.assetid: 63214dc6-0112-4245-8ebf-7c9e8f5a5782","nodes":[{"content":"Lambda expression will not be removed from this event handler","nodes":[{"pos":[0,61],"content":"Lambda expression will not be removed from this event handler","nodes":[{"content":"Lambda expression will not be removed from this event handler","pos":[0,61]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[229,290],"content":"Lambda expression will not be removed from this event handler","linkify":"Lambda expression will not be removed from this event handler","nodes":[{"content":"Lambda expression will not be removed from this event handler","pos":[0,61]}]},{"content":"Lambda expression will not be removed from this event handler.","pos":[291,353]},{"content":"Assign the lambda expression to a variable and use the variable to add and remove the event.","pos":[354,446]},{"content":"When lambda expressions are used with event handlers, you may not see the behavior you expect.","pos":[453,547]},{"content":"The compiler generates a new method for each lambda expression definition, even if they are identical.","pos":[548,650]},{"content":"Therefore, the following code displays <ph id=\"ph1\">`False`</ph>.","pos":[651,698],"source":" Therefore, the following code displays `False`."},{"content":"When lambda expressions are used with event handlers, this may cause unexpected results.","pos":[1036,1124]},{"content":"In the following example, the lambda expression added by <ph id=\"ph1\">`AddHandler`</ph> is not removed by the <ph id=\"ph2\">`RemoveHandler`</ph> statement.","pos":[1125,1243],"source":" In the following example, the lambda expression added by `AddHandler` is not removed by the `RemoveHandler` statement."},{"content":"By default, this message is a warning.","pos":[1776,1814]},{"content":"For more information about how to hide warnings or treat warnings as errors, see <bpt id=\"p1\">[</bpt>Configuring Warnings in Visual Basic<ept id=\"p1\">](/visualstudio/ide/configuring-warnings-in-visual-basic)</ept>.","pos":[1815,1991],"source":" For more information about how to hide warnings or treat warnings as errors, see [Configuring Warnings in Visual Basic](/visualstudio/ide/configuring-warnings-in-visual-basic)."},{"pos":[1998,2019],"content":"<bpt id=\"p1\">**</bpt>Error ID:<ept id=\"p1\">**</ept> BC42326","source":"**Error ID:** BC42326"},{"pos":[2028,2049],"content":"To correct this error","linkify":"To correct this error","nodes":[{"content":"To correct this error","pos":[0,21]}]},{"pos":[2059,2269],"content":"To avoid the warning and remove the lambda expression, assign the lambda expression to a variable and use the variable in both the <ph id=\"ph1\">`AddHandler`</ph> and <ph id=\"ph2\">`RemoveHandler`</ph> statements, as shown in the following example.","source":"To avoid the warning and remove the lambda expression, assign the lambda expression to a variable and use the variable in both the `AddHandler` and `RemoveHandler` statements, as shown in the following example."},{"pos":[2809,2817],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2821,2933],"content":"<bpt id=\"p1\">[</bpt>Lambda Expressions<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)</ept>","source":"[Lambda Expressions](../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)"},{"pos":[2936,3065],"content":"<bpt id=\"p1\">[</bpt>Relaxed Delegate Conversion<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)</ept>","source":"[Relaxed Delegate Conversion](../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)"},{"pos":[3068,3151],"content":"<bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/events/index.md)</ept>","source":"[Events](../../../visual-basic/programming-guide/language-features/events/index.md)"}]}