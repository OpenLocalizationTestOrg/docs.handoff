{"content":"---\ntitle: \"Struct Design\"\nms.date: \"10/22/2008\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"class library design guidelines [.NET Framework], structures\"\n  - \"deallocating structures\"\n  - \"allocating structures\"\n  - \"value types, structures\"\n  - \"structure design\"\n  - \"type design guidelines, structures\"\n  - \"structures [.NET Framework], design guidelines\"\nms.assetid: 1f48b2d8-608c-4be6-9ba4-d8f203ed9f9f\nauthor: \"KrzysztofCwalina\"\n---\n# Struct Design\nThe general-purpose value type is most often referred to as a struct, its C# keyword. This section provides guidelines for general struct design.  \n  \n **X DO NOT** provide a default constructor for a struct.  \n  \n Following this guideline allows arrays of structs to be created without having to run the constructor on each item of the array. Notice that C# does not allow structs to have default constructors.  \n  \n **X DO NOT** define mutable value types.  \n  \n Mutable value types have several problems. For example, when a property getter returns a value type, the caller receives a copy. Because the copy is created implicitly, developers might not be aware that they are mutating the copy, and not the original value. Also, some languages (dynamic languages, in particular) have problems using mutable value types because even local variables, when dereferenced, cause a copy to be made.  \n  \n **✓ DO** ensure that a state where all instance data is set to zero, false, or null (as appropriate) is valid.  \n  \n This prevents accidental creation of invalid instances when an array of the structs is created.  \n  \n **✓ DO** implement <xref:System.IEquatable%601> on value types.  \n  \n The <xref:System.Object.Equals%2A?displayProperty=nameWithType> method on value types causes boxing, and its default implementation is not very efficient, because it uses reflection. <xref:System.IEquatable%601.Equals%2A> can have much better performance and can be implemented so that it will not cause boxing.  \n  \n **X DO NOT** explicitly extend <xref:System.ValueType>. In fact, most languages prevent this.  \n  \n In general, structs can be very useful but should only be used for small, single, immutable values that will not be boxed frequently.  \n  \n *Portions © 2005, 2009 Microsoft Corporation. All rights reserved.*  \n  \n *Reprinted by permission of Pearson Education, Inc. from [Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619) by Krzysztof Cwalina and Brad Abrams, published Oct 22, 2008 by Addison-Wesley Professional as part of the Microsoft Windows Development Series.*  \n  \n## See also\n\n- [Type Design Guidelines](../../../docs/standard/design-guidelines/type.md)\n- [Framework Design Guidelines](../../../docs/standard/design-guidelines/index.md)\n- [Choosing Between Class and Struct](../../../docs/standard/design-guidelines/choosing-between-class-and-struct.md)\n","nodes":[{"pos":[4,449],"embed":true,"restype":"x-metadata","content":"title: \"Struct Design\"\nms.date: \"10/22/2008\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"class library design guidelines [.NET Framework], structures\"\n  - \"deallocating structures\"\n  - \"allocating structures\"\n  - \"value types, structures\"\n  - \"structure design\"\n  - \"type design guidelines, structures\"\n  - \"structures [.NET Framework], design guidelines\"\nms.assetid: 1f48b2d8-608c-4be6-9ba4-d8f203ed9f9f\nauthor: \"KrzysztofCwalina\"","nodes":[{"content":"Struct Design","nodes":[{"pos":[0,13],"content":"Struct Design","nodes":[{"content":"Struct Design","pos":[0,13]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[456,469],"content":"Struct Design","linkify":"Struct Design","nodes":[{"content":"Struct Design","pos":[0,13]}]},{"content":"The general-purpose value type is most often referred to as a struct, its C# keyword.","pos":[470,555]},{"content":"This section provides guidelines for general struct design.","pos":[556,615]},{"pos":[622,678],"content":"<bpt id=\"p1\">**</bpt>X DO NOT<ept id=\"p1\">**</ept> provide a default constructor for a struct.","source":"**X DO NOT** provide a default constructor for a struct."},{"content":"Following this guideline allows arrays of structs to be created without having to run the constructor on each item of the array.","pos":[685,813]},{"content":"Notice that C# does not allow structs to have default constructors.","pos":[814,881]},{"pos":[888,928],"content":"<bpt id=\"p1\">**</bpt>X DO NOT<ept id=\"p1\">**</ept> define mutable value types.","source":"**X DO NOT** define mutable value types."},{"content":"Mutable value types have several problems.","pos":[935,977]},{"content":"For example, when a property getter returns a value type, the caller receives a copy.","pos":[978,1063]},{"content":"Because the copy is created implicitly, developers might not be aware that they are mutating the copy, and not the original value.","pos":[1064,1194]},{"content":"Also, some languages (dynamic languages, in particular) have problems using mutable value types because even local variables, when dereferenced, cause a copy to be made.","pos":[1195,1364]},{"pos":[1371,1481],"content":"<bpt id=\"p1\">**</bpt>✓ DO<ept id=\"p1\">**</ept> ensure that a state where all instance data is set to zero, false, or null (as appropriate) is valid.","source":"**✓ DO** ensure that a state where all instance data is set to zero, false, or null (as appropriate) is valid."},{"content":"This prevents accidental creation of invalid instances when an array of the structs is created.","pos":[1488,1583]},{"pos":[1590,1653],"content":"<bpt id=\"p1\">**</bpt>✓ DO<ept id=\"p1\">**</ept> implement <ph id=\"ph1\">&lt;xref:System.IEquatable%601&gt;</ph> on value types.","source":"**✓ DO** implement <xref:System.IEquatable%601> on value types."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Object.Equals%2A?displayProperty=nameWithType&gt;</ph> method on value types causes boxing, and its default implementation is not very efficient, because it uses reflection.","pos":[1660,1842],"source":"The <xref:System.Object.Equals%2A?displayProperty=nameWithType> method on value types causes boxing, and its default implementation is not very efficient, because it uses reflection."},{"content":"<ph id=\"ph1\">&lt;xref:System.IEquatable%601.Equals%2A&gt;</ph> can have much better performance and can be implemented so that it will not cause boxing.","pos":[1843,1971],"source":"<xref:System.IEquatable%601.Equals%2A> can have much better performance and can be implemented so that it will not cause boxing."},{"content":"<bpt id=\"p1\">**</bpt>X DO NOT<ept id=\"p1\">**</ept> explicitly extend <ph id=\"ph1\">&lt;xref:System.ValueType&gt;</ph>.","pos":[1978,2033],"source":"**X DO NOT** explicitly extend <xref:System.ValueType>."},{"content":"In fact, most languages prevent this.","pos":[2034,2071]},{"content":"In general, structs can be very useful but should only be used for small, single, immutable values that will not be boxed frequently.","pos":[2078,2211]},{"pos":[2218,2285],"content":"<bpt id=\"p1\">*</bpt>Portions © 2005, 2009 Microsoft Corporation. All rights reserved.<ept id=\"p1\">*</ept>","source":"*Portions © 2005, 2009 Microsoft Corporation. All rights reserved.*"},{"pos":[2292,2697],"content":"<bpt id=\"p1\">*</bpt>Reprinted by permission of Pearson Education, Inc. from <bpt id=\"p2\">[</bpt>Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition<ept id=\"p2\">](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619)</ept> by Krzysztof Cwalina and Brad Abrams, published Oct 22, 2008 by Addison-Wesley Professional as part of the Microsoft Windows Development Series.<ept id=\"p1\">*</ept>","source":"*Reprinted by permission of Pearson Education, Inc. from [Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619) by Krzysztof Cwalina and Brad Abrams, published Oct 22, 2008 by Addison-Wesley Professional as part of the Microsoft Windows Development Series.*"},{"pos":[2706,2714],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2718,2792],"content":"<bpt id=\"p1\">[</bpt>Type Design Guidelines<ept id=\"p1\">](../../../docs/standard/design-guidelines/type.md)</ept>","source":"[Type Design Guidelines](../../../docs/standard/design-guidelines/type.md)"},{"pos":[2795,2875],"content":"<bpt id=\"p1\">[</bpt>Framework Design Guidelines<ept id=\"p1\">](../../../docs/standard/design-guidelines/index.md)</ept>","source":"[Framework Design Guidelines](../../../docs/standard/design-guidelines/index.md)"},{"pos":[2878,2992],"content":"<bpt id=\"p1\">[</bpt>Choosing Between Class and Struct<ept id=\"p1\">](../../../docs/standard/design-guidelines/choosing-between-class-and-struct.md)</ept>","source":"[Choosing Between Class and Struct](../../../docs/standard/design-guidelines/choosing-between-class-and-struct.md)"}]}