{"content":"---\ntitle: \"How to: Force an Argument to Be Passed by Value (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"procedures [Visual Basic], arguments\"\n  - \"procedures [Visual Basic], parameters\"\n  - \"procedure arguments\"\n  - \"Visual Basic code, procedures\"\n  - \"arguments [Visual Basic], ByVal\"\n  - \"arguments [Visual Basic], passing by value\"\n  - \"procedure parameters\"\n  - \"procedures [Visual Basic], calling\"\n  - \"arguments [Visual Basic], in parentheses\"\n  - \"procedure arguments [Visual Basic], in parentheses\"\n  - \"arguments [Visual Basic], changing value\"\nms.assetid: 77b4f2d2-1055-4c2f-a521-874d1db86946\n---\n# How to: Force an Argument to Be Passed by Value (Visual Basic)\nThe procedure declaration determines the passing mechanism. If a parameter is declared [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md), Visual Basic expects to pass the corresponding argument by reference. This allows the procedure to change the value of the programming element underlying the argument in the calling code. If you wish to protect the underlying element against such change, you can override the `ByRef` passing mechanism in the procedure call by enclosing the argument name in parentheses. These parentheses are in addition to the parentheses enclosing the argument list in the call.  \n  \n The calling code cannot override a [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) mechanism.  \n  \n### To force an argument to be passed by value  \n  \n-   If the corresponding parameter is declared `ByVal` in the procedure, you do not need to take any additional steps. Visual Basic already expects to pass the argument by value.  \n  \n-   If the corresponding parameter is declared `ByRef` in the procedure, enclose the argument in parentheses in the procedure call.  \n  \n## Example  \n The following example overrides a `ByRef` parameter declaration. In the call that forces `ByVal`, note the two levels of parentheses.  \n  \n [!code-vb[VbVbcnProcedures#39](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#39)]  \n  \n [!code-vb[VbVbcnProcedures#40](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#40)]  \n  \n When `str` is enclosed in extra parentheses within the argument list, the `setNewString` procedure cannot change its value in the calling code, and `MsgBox` displays \"Cannot be replaced if passed ByVal\". When `str` is not enclosed in extra parentheses, the procedure can change it, and `MsgBox` displays \"This is a new value for the inString argument.\"  \n  \n## Compiling the Code  \n When you pass a variable by reference, you must use the `ByRef` keyword to specify this mechanism.  \n  \n The default in Visual Basic is to pass arguments by value. However, it is good programming practice to include either the [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) or [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md) keyword with every declared parameter. This makes your code easier to read.  \n  \n## Robust Programming  \n If a procedure declares a parameter [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md), the correct execution of the code might depend on being able to change the underlying element in the calling code. If the calling code overrides this calling mechanism by enclosing the argument in parentheses, or if it passes a nonmodifiable argument, the procedure cannot change the underlying element. This might produce unexpected results in the calling code.  \n  \n## .NET Framework Security  \n There is always a potential risk in allowing a procedure to change the value underlying an argument in the calling code. Make sure you expect this value to be changed, and be prepared to check it for validity before using it.  \n  \n## See also\n\n- [Procedures](./index.md)\n- [Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)\n- [How to: Pass Arguments to a Procedure](./how-to-pass-arguments-to-a-procedure.md)\n- [Passing Arguments by Value and by Reference](./passing-arguments-by-value-and-by-reference.md)\n- [Differences Between Modifiable and Nonmodifiable Arguments](./differences-between-modifiable-and-nonmodifiable-arguments.md)\n- [Differences Between Passing an Argument By Value and By Reference](./differences-between-passing-an-argument-by-value-and-by-reference.md)\n- [How to: Change the Value of a Procedure Argument](./how-to-change-the-value-of-a-procedure-argument.md)\n- [How to: Protect a Procedure Argument Against Value Changes](./how-to-protect-a-procedure-argument-against-value-changes.md)\n- [Passing Arguments by Position and by Name](./passing-arguments-by-position-and-by-name.md)\n- [Value Types and Reference Types](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)\n","nodes":[{"pos":[4,621],"embed":true,"restype":"x-metadata","content":"title: \"How to: Force an Argument to Be Passed by Value (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"procedures [Visual Basic], arguments\"\n  - \"procedures [Visual Basic], parameters\"\n  - \"procedure arguments\"\n  - \"Visual Basic code, procedures\"\n  - \"arguments [Visual Basic], ByVal\"\n  - \"arguments [Visual Basic], passing by value\"\n  - \"procedure parameters\"\n  - \"procedures [Visual Basic], calling\"\n  - \"arguments [Visual Basic], in parentheses\"\n  - \"procedure arguments [Visual Basic], in parentheses\"\n  - \"arguments [Visual Basic], changing value\"\nms.assetid: 77b4f2d2-1055-4c2f-a521-874d1db86946","nodes":[{"content":"How to: Force an Argument to Be Passed by Value (Visual Basic)","nodes":[{"pos":[0,62],"content":"How to: Force an Argument to Be Passed by Value (Visual Basic)","nodes":[{"content":"How to: Force an Argument to Be Passed by Value (Visual Basic)","pos":[0,62]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[628,690],"content":"How to: Force an Argument to Be Passed by Value (Visual Basic)","linkify":"How to: Force an Argument to Be Passed by Value (Visual Basic)","nodes":[{"content":"How to: Force an Argument to Be Passed by Value (Visual Basic)","pos":[0,62]}]},{"content":"The procedure declaration determines the passing mechanism.","pos":[691,750]},{"content":"If a parameter is declared <bpt id=\"p1\">[</bpt>ByRef<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byref.md)</ept>, Visual Basic expects to pass the corresponding argument by reference.","pos":[751,920],"source":" If a parameter is declared [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md), Visual Basic expects to pass the corresponding argument by reference."},{"content":"This allows the procedure to change the value of the programming element underlying the argument in the calling code.","pos":[921,1038]},{"content":"If you wish to protect the underlying element against such change, you can override the <ph id=\"ph1\">`ByRef`</ph> passing mechanism in the procedure call by enclosing the argument name in parentheses.","pos":[1039,1221],"source":" If you wish to protect the underlying element against such change, you can override the `ByRef` passing mechanism in the procedure call by enclosing the argument name in parentheses."},{"content":"These parentheses are in addition to the parentheses enclosing the argument list in the call.","pos":[1222,1315]},{"pos":[1322,1439],"content":"The calling code cannot override a <bpt id=\"p1\">[</bpt>ByVal<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byval.md)</ept> mechanism.","source":"The calling code cannot override a [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) mechanism."},{"pos":[1449,1491],"content":"To force an argument to be passed by value","linkify":"To force an argument to be passed by value","nodes":[{"content":"To force an argument to be passed by value","pos":[0,42]}]},{"content":"If the corresponding parameter is declared <ph id=\"ph1\">`ByVal`</ph> in the procedure, you do not need to take any additional steps.","pos":[1501,1615],"source":"If the corresponding parameter is declared `ByVal` in the procedure, you do not need to take any additional steps."},{"content":"Visual Basic already expects to pass the argument by value.","pos":[1616,1675]},{"pos":[1685,1812],"content":"If the corresponding parameter is declared <ph id=\"ph1\">`ByRef`</ph> in the procedure, enclose the argument in parentheses in the procedure call.","source":"If the corresponding parameter is declared `ByRef` in the procedure, enclose the argument in parentheses in the procedure call."},{"pos":[1821,1828],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example overrides a <ph id=\"ph1\">`ByRef`</ph> parameter declaration.","pos":[1832,1896],"source":"The following example overrides a `ByRef` parameter declaration."},{"content":"In the call that forces <ph id=\"ph1\">`ByVal`</ph>, note the two levels of parentheses.","pos":[1897,1965],"source":" In the call that forces `ByVal`, note the two levels of parentheses."},{"content":"When <ph id=\"ph1\">`str`</ph> is enclosed in extra parentheses within the argument list, the <ph id=\"ph2\">`setNewString`</ph> procedure cannot change its value in the calling code, and <ph id=\"ph3\">`MsgBox`</ph> displays \"Cannot be replaced if passed ByVal\".","pos":[2220,2423],"source":"When `str` is enclosed in extra parentheses within the argument list, the `setNewString` procedure cannot change its value in the calling code, and `MsgBox` displays \"Cannot be replaced if passed ByVal\"."},{"content":"When <ph id=\"ph1\">`str`</ph> is not enclosed in extra parentheses, the procedure can change it, and <ph id=\"ph2\">`MsgBox`</ph> displays \"This is a new value for the inString argument.\"","pos":[2424,2572],"source":" When `str` is not enclosed in extra parentheses, the procedure can change it, and `MsgBox` displays \"This is a new value for the inString argument.\""},{"pos":[2581,2599],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[2603,2701],"content":"When you pass a variable by reference, you must use the <ph id=\"ph1\">`ByRef`</ph> keyword to specify this mechanism.","source":"When you pass a variable by reference, you must use the `ByRef` keyword to specify this mechanism."},{"content":"The default in Visual Basic is to pass arguments by value.","pos":[2708,2766]},{"content":"However, it is good programming practice to include either the <bpt id=\"p1\">[</bpt>ByVal<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byval.md)</ept> or <bpt id=\"p2\">[</bpt>ByRef<ept id=\"p2\">](../../../../visual-basic/language-reference/modifiers/byref.md)</ept> keyword with every declared parameter.","pos":[2767,3015],"source":" However, it is good programming practice to include either the [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) or [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md) keyword with every declared parameter."},{"content":"This makes your code easier to read.","pos":[3016,3052]},{"pos":[3061,3079],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"If a procedure declares a parameter <bpt id=\"p1\">[</bpt>ByRef<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byref.md)</ept>, the correct execution of the code might depend on being able to change the underlying element in the calling code.","pos":[3083,3306],"source":"If a procedure declares a parameter [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md), the correct execution of the code might depend on being able to change the underlying element in the calling code."},{"content":"If the calling code overrides this calling mechanism by enclosing the argument in parentheses, or if it passes a nonmodifiable argument, the procedure cannot change the underlying element.","pos":[3307,3495]},{"content":"This might produce unexpected results in the calling code.","pos":[3496,3554]},{"pos":[3563,3586],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"There is always a potential risk in allowing a procedure to change the value underlying an argument in the calling code.","pos":[3590,3710]},{"content":"Make sure you expect this value to be changed, and be prepared to check it for validity before using it.","pos":[3711,3815]},{"pos":[3824,3832],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3836,3860],"content":"<bpt id=\"p1\">[</bpt>Procedures<ept id=\"p1\">](./index.md)</ept>","source":"[Procedures](./index.md)"},{"pos":[3863,3940],"content":"<bpt id=\"p1\">[</bpt>Procedure Parameters and Arguments<ept id=\"p1\">](./procedure-parameters-and-arguments.md)</ept>","source":"[Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)"},{"pos":[3943,4025],"content":"<bpt id=\"p1\">[</bpt>How to: Pass Arguments to a Procedure<ept id=\"p1\">](./how-to-pass-arguments-to-a-procedure.md)</ept>","source":"[How to: Pass Arguments to a Procedure](./how-to-pass-arguments-to-a-procedure.md)"},{"pos":[4028,4123],"content":"<bpt id=\"p1\">[</bpt>Passing Arguments by Value and by Reference<ept id=\"p1\">](./passing-arguments-by-value-and-by-reference.md)</ept>","source":"[Passing Arguments by Value and by Reference](./passing-arguments-by-value-and-by-reference.md)"},{"pos":[4126,4251],"content":"<bpt id=\"p1\">[</bpt>Differences Between Modifiable and Nonmodifiable Arguments<ept id=\"p1\">](./differences-between-modifiable-and-nonmodifiable-arguments.md)</ept>","source":"[Differences Between Modifiable and Nonmodifiable Arguments](./differences-between-modifiable-and-nonmodifiable-arguments.md)"},{"pos":[4254,4393],"content":"<bpt id=\"p1\">[</bpt>Differences Between Passing an Argument By Value and By Reference<ept id=\"p1\">](./differences-between-passing-an-argument-by-value-and-by-reference.md)</ept>","source":"[Differences Between Passing an Argument By Value and By Reference](./differences-between-passing-an-argument-by-value-and-by-reference.md)"},{"pos":[4396,4500],"content":"<bpt id=\"p1\">[</bpt>How to: Change the Value of a Procedure Argument<ept id=\"p1\">](./how-to-change-the-value-of-a-procedure-argument.md)</ept>","source":"[How to: Change the Value of a Procedure Argument](./how-to-change-the-value-of-a-procedure-argument.md)"},{"pos":[4503,4627],"content":"<bpt id=\"p1\">[</bpt>How to: Protect a Procedure Argument Against Value Changes<ept id=\"p1\">](./how-to-protect-a-procedure-argument-against-value-changes.md)</ept>","source":"[How to: Protect a Procedure Argument Against Value Changes](./how-to-protect-a-procedure-argument-against-value-changes.md)"},{"pos":[4630,4721],"content":"<bpt id=\"p1\">[</bpt>Passing Arguments by Position and by Name<ept id=\"p1\">](./passing-arguments-by-position-and-by-name.md)</ept>","source":"[Passing Arguments by Position and by Name](./passing-arguments-by-position-and-by-name.md)"},{"pos":[4724,4865],"content":"<bpt id=\"p1\">[</bpt>Value Types and Reference Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)</ept>","source":"[Value Types and Reference Types](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)"}]}