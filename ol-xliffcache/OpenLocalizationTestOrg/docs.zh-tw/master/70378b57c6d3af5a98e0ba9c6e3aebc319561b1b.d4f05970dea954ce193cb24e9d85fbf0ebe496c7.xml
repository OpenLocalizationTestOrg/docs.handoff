{"content":"---\ntitle: \"How to: Protect a Procedure Argument Against Value Changes (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"procedures [Visual Basic], arguments\"\n  - \"procedures [Visual Basic], parameters\"\n  - \"procedure arguments\"\n  - \"arguments [Visual Basic], passing by reference\"\n  - \"Visual Basic code, procedures\"\n  - \"arguments [Visual Basic], ByVal\"\n  - \"arguments [Visual Basic], passing by value\"\n  - \"procedure parameters\"\n  - \"procedures [Visual Basic], calling\"\n  - \"arguments [Visual Basic], ByRef\"\n  - \"arguments [Visual Basic], changing value\"\nms.assetid: d2b7c766-ce16-4d2c-8d79-3fc0e7ba2227\n---\n# How to: Protect a Procedure Argument Against Value Changes (Visual Basic)\nIf a procedure declares a parameter as [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md), Visual Basic gives the procedure code a direct reference to the programming element underlying the argument in the calling code. This permits the procedure to change the value underlying the argument in the calling code. In some cases the calling code might want to protect against such a change.  \n  \n You can always protect an argument from change by declaring the corresponding parameter [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) in the procedure. If you want to be able to change a given argument in some cases but not others, you can declare it `ByRef` and let the calling code determine the passing mechanism in each call. It does this by enclosing the corresponding argument in parentheses to pass it by value, or not enclosing it in parentheses to pass it by reference. For more information, see [How to: Force an Argument to Be Passed by Value](./how-to-force-an-argument-to-be-passed-by-value.md).  \n  \n## Example  \n The following example shows two procedures that take an array variable and operate on its elements. The `increase` procedure simply adds one to each element. The `replace` procedure assigns a new array to the parameter `a()` and then adds one to each element. However, the reassignment does not affect the underlying array variable in the calling code.  \n  \n [!code-vb[VbVbcnProcedures#35](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#35)]  \n  \n [!code-vb[VbVbcnProcedures#38](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#38)]  \n  \n [!code-vb[VbVbcnProcedures#37](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#37)]  \n  \n The first `MsgBox` call displays \"After increase(n): 11, 21, 31, 41\". Because the array `n` is a reference type, `increase` can change its members, even though the passing mechanism is `ByVal`.  \n  \n The second `MsgBox` call displays \"After replace(n): 11, 21, 31, 41\". Because `n` is passed `ByVal`, `replace` cannot modify the variable `n` in the calling code by assigning a new array to it. When `replace` creates the new array instance `k` and assigns it to the local variable `a`, it loses the reference to `n` passed in by the calling code. When it changes the members of `a`, only the local array `k` is affected. Therefore, `replace` does not increment the values of array `n` in the calling code.  \n  \n## Compiling the Code  \n The default in Visual Basic is to pass arguments by value. However, it is good programming practice to include either the [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) or [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md) keyword with every declared parameter. This makes your code easier to read.  \n  \n## See also\n\n- [Procedures](./index.md)\n- [Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)\n- [How to: Pass Arguments to a Procedure](./how-to-pass-arguments-to-a-procedure.md)\n- [Passing Arguments by Value and by Reference](./passing-arguments-by-value-and-by-reference.md)\n- [Differences Between Modifiable and Nonmodifiable Arguments](./differences-between-modifiable-and-nonmodifiable-arguments.md)\n- [Differences Between Passing an Argument By Value and By Reference](./differences-between-passing-an-argument-by-value-and-by-reference.md)\n- [How to: Change the Value of a Procedure Argument](./how-to-change-the-value-of-a-procedure-argument.md)\n- [How to: Force an Argument to Be Passed by Value](./how-to-force-an-argument-to-be-passed-by-value.md)\n- [Passing Arguments by Position and by Name](./passing-arguments-by-position-and-by-name.md)\n- [Value Types and Reference Types](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)\n","nodes":[{"pos":[4,619],"embed":true,"restype":"x-metadata","content":"title: \"How to: Protect a Procedure Argument Against Value Changes (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"procedures [Visual Basic], arguments\"\n  - \"procedures [Visual Basic], parameters\"\n  - \"procedure arguments\"\n  - \"arguments [Visual Basic], passing by reference\"\n  - \"Visual Basic code, procedures\"\n  - \"arguments [Visual Basic], ByVal\"\n  - \"arguments [Visual Basic], passing by value\"\n  - \"procedure parameters\"\n  - \"procedures [Visual Basic], calling\"\n  - \"arguments [Visual Basic], ByRef\"\n  - \"arguments [Visual Basic], changing value\"\nms.assetid: d2b7c766-ce16-4d2c-8d79-3fc0e7ba2227","nodes":[{"content":"How to: Protect a Procedure Argument Against Value Changes (Visual Basic)","nodes":[{"pos":[0,73],"content":"How to: Protect a Procedure Argument Against Value Changes (Visual Basic)","nodes":[{"content":"How to: Protect a Procedure Argument Against Value Changes (Visual Basic)","pos":[0,73]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[626,699],"content":"How to: Protect a Procedure Argument Against Value Changes (Visual Basic)","linkify":"How to: Protect a Procedure Argument Against Value Changes (Visual Basic)","nodes":[{"content":"How to: Protect a Procedure Argument Against Value Changes (Visual Basic)","pos":[0,73]}]},{"content":"If a procedure declares a parameter as <bpt id=\"p1\">[</bpt>ByRef<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byref.md)</ept>, Visual Basic gives the procedure code a direct reference to the programming element underlying the argument in the calling code.","pos":[700,940],"source":"If a procedure declares a parameter as [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md), Visual Basic gives the procedure code a direct reference to the programming element underlying the argument in the calling code."},{"content":"This permits the procedure to change the value underlying the argument in the calling code.","pos":[941,1032]},{"content":"In some cases the calling code might want to protect against such a change.","pos":[1033,1108]},{"content":"You can always protect an argument from change by declaring the corresponding parameter <bpt id=\"p1\">[</bpt>ByVal<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byval.md)</ept> in the procedure.","pos":[1115,1292],"source":"You can always protect an argument from change by declaring the corresponding parameter [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) in the procedure."},{"content":"If you want to be able to change a given argument in some cases but not others, you can declare it <ph id=\"ph1\">`ByRef`</ph> and let the calling code determine the passing mechanism in each call.","pos":[1293,1470],"source":" If you want to be able to change a given argument in some cases but not others, you can declare it `ByRef` and let the calling code determine the passing mechanism in each call."},{"content":"It does this by enclosing the corresponding argument in parentheses to pass it by value, or not enclosing it in parentheses to pass it by reference.","pos":[1471,1619]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Force an Argument to Be Passed by Value<ept id=\"p1\">](./how-to-force-an-argument-to-be-passed-by-value.md)</ept>.","pos":[1620,1749],"source":" For more information, see [How to: Force an Argument to Be Passed by Value](./how-to-force-an-argument-to-be-passed-by-value.md)."},{"pos":[1758,1765],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows two procedures that take an array variable and operate on its elements.","pos":[1769,1868]},{"content":"The <ph id=\"ph1\">`increase`</ph> procedure simply adds one to each element.","pos":[1869,1926],"source":" The `increase` procedure simply adds one to each element."},{"content":"The <ph id=\"ph1\">`replace`</ph> procedure assigns a new array to the parameter <ph id=\"ph2\">`a()`</ph> and then adds one to each element.","pos":[1927,2028],"source":" The `replace` procedure assigns a new array to the parameter `a()` and then adds one to each element."},{"content":"However, the reassignment does not affect the underlying array variable in the calling code.","pos":[2029,2121]},{"content":"The first <ph id=\"ph1\">`MsgBox`</ph> call displays \"After increase(n): 11, 21, 31, 41\".","pos":[2500,2569],"source":"The first `MsgBox` call displays \"After increase(n): 11, 21, 31, 41\"."},{"content":"Because the array <ph id=\"ph1\">`n`</ph> is a reference type, <ph id=\"ph2\">`increase`</ph> can change its members, even though the passing mechanism is <ph id=\"ph3\">`ByVal`</ph>.","pos":[2570,2693],"source":" Because the array `n` is a reference type, `increase` can change its members, even though the passing mechanism is `ByVal`."},{"content":"The second <ph id=\"ph1\">`MsgBox`</ph> call displays \"After replace(n): 11, 21, 31, 41\".","pos":[2700,2769],"source":"The second `MsgBox` call displays \"After replace(n): 11, 21, 31, 41\"."},{"content":"Because <ph id=\"ph1\">`n`</ph> is passed <ph id=\"ph2\">`ByVal`</ph>, <ph id=\"ph3\">`replace`</ph> cannot modify the variable <ph id=\"ph4\">`n`</ph> in the calling code by assigning a new array to it.","pos":[2770,2893],"source":" Because `n` is passed `ByVal`, `replace` cannot modify the variable `n` in the calling code by assigning a new array to it."},{"content":"When <ph id=\"ph1\">`replace`</ph> creates the new array instance <ph id=\"ph2\">`k`</ph> and assigns it to the local variable <ph id=\"ph3\">`a`</ph>, it loses the reference to <ph id=\"ph4\">`n`</ph> passed in by the calling code.","pos":[2894,3046],"source":" When `replace` creates the new array instance `k` and assigns it to the local variable `a`, it loses the reference to `n` passed in by the calling code."},{"content":"When it changes the members of <ph id=\"ph1\">`a`</ph>, only the local array <ph id=\"ph2\">`k`</ph> is affected.","pos":[3047,3120],"source":" When it changes the members of `a`, only the local array `k` is affected."},{"content":"Therefore, <ph id=\"ph1\">`replace`</ph> does not increment the values of array <ph id=\"ph2\">`n`</ph> in the calling code.","pos":[3121,3205],"source":" Therefore, `replace` does not increment the values of array `n` in the calling code."},{"pos":[3214,3232],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"The default in Visual Basic is to pass arguments by value.","pos":[3236,3294]},{"content":"However, it is good programming practice to include either the <bpt id=\"p1\">[</bpt>ByVal<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/byval.md)</ept> or <bpt id=\"p2\">[</bpt>ByRef<ept id=\"p2\">](../../../../visual-basic/language-reference/modifiers/byref.md)</ept> keyword with every declared parameter.","pos":[3295,3543],"source":" However, it is good programming practice to include either the [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) or [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md) keyword with every declared parameter."},{"content":"This makes your code easier to read.","pos":[3544,3580]},{"pos":[3589,3597],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3601,3625],"content":"<bpt id=\"p1\">[</bpt>Procedures<ept id=\"p1\">](./index.md)</ept>","source":"[Procedures](./index.md)"},{"pos":[3628,3705],"content":"<bpt id=\"p1\">[</bpt>Procedure Parameters and Arguments<ept id=\"p1\">](./procedure-parameters-and-arguments.md)</ept>","source":"[Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)"},{"pos":[3708,3790],"content":"<bpt id=\"p1\">[</bpt>How to: Pass Arguments to a Procedure<ept id=\"p1\">](./how-to-pass-arguments-to-a-procedure.md)</ept>","source":"[How to: Pass Arguments to a Procedure](./how-to-pass-arguments-to-a-procedure.md)"},{"pos":[3793,3888],"content":"<bpt id=\"p1\">[</bpt>Passing Arguments by Value and by Reference<ept id=\"p1\">](./passing-arguments-by-value-and-by-reference.md)</ept>","source":"[Passing Arguments by Value and by Reference](./passing-arguments-by-value-and-by-reference.md)"},{"pos":[3891,4016],"content":"<bpt id=\"p1\">[</bpt>Differences Between Modifiable and Nonmodifiable Arguments<ept id=\"p1\">](./differences-between-modifiable-and-nonmodifiable-arguments.md)</ept>","source":"[Differences Between Modifiable and Nonmodifiable Arguments](./differences-between-modifiable-and-nonmodifiable-arguments.md)"},{"pos":[4019,4158],"content":"<bpt id=\"p1\">[</bpt>Differences Between Passing an Argument By Value and By Reference<ept id=\"p1\">](./differences-between-passing-an-argument-by-value-and-by-reference.md)</ept>","source":"[Differences Between Passing an Argument By Value and By Reference](./differences-between-passing-an-argument-by-value-and-by-reference.md)"},{"pos":[4161,4265],"content":"<bpt id=\"p1\">[</bpt>How to: Change the Value of a Procedure Argument<ept id=\"p1\">](./how-to-change-the-value-of-a-procedure-argument.md)</ept>","source":"[How to: Change the Value of a Procedure Argument](./how-to-change-the-value-of-a-procedure-argument.md)"},{"pos":[4268,4370],"content":"<bpt id=\"p1\">[</bpt>How to: Force an Argument to Be Passed by Value<ept id=\"p1\">](./how-to-force-an-argument-to-be-passed-by-value.md)</ept>","source":"[How to: Force an Argument to Be Passed by Value](./how-to-force-an-argument-to-be-passed-by-value.md)"},{"pos":[4373,4464],"content":"<bpt id=\"p1\">[</bpt>Passing Arguments by Position and by Name<ept id=\"p1\">](./passing-arguments-by-position-and-by-name.md)</ept>","source":"[Passing Arguments by Position and by Name](./passing-arguments-by-position-and-by-name.md)"},{"pos":[4467,4608],"content":"<bpt id=\"p1\">[</bpt>Value Types and Reference Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)</ept>","source":"[Value Types and Reference Types](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)"}]}