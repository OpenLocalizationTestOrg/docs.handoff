{"content":"---\ntitle: \"DiscoveryClient and DynamicEndpoint | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 7cd418f0-0eab-48d1-a493-7eb907867ec3\ncaps.latest.revision: 5\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# DiscoveryClient and DynamicEndpoint\n<xref:System.ServiceModel.Discovery.DiscoveryClient> and <xref:System.ServiceModel.Discovery.DynamicEndpoint> are two classes used on the client side to search for services. <xref:System.ServiceModel.Discovery.DiscoveryClient> provides you with a list of services that match a specific set of criteria and allows you to connect to the services. <xref:System.ServiceModel.Discovery.DynamicEndpoint> performs the same operation and in addition, automatically connects to one of the services that was found. Any endpoint can be made into a <xref:System.ServiceModel.Discovery.DynamicEndpoint>, the search criteria can also be added in configuration, thus <xref:System.ServiceModel.Discovery.DynamicEndpoint> is useful when you need discovery in your solution but do not want to modify the client logic – you only need to modify the endpoints. <xref:System.ServiceModel.Discovery.DiscoveryClient> on the other hand can be used to gain finer control over your search operation. The uses and benefits of each are elaborated below.  \n  \n## DiscoveryClient  \n The <xref:System.ServiceModel.Discovery.DiscoveryClient> defines synchronous and asynchronous Find methods, <xref:System.ServiceModel.Discovery.DiscoveryClient.FindCompleted> and <xref:System.ServiceModel.Discovery.DiscoveryClient.FindProgressChanged> events.  It also defines synchronous and asynchronous Resolve methods and a <xref:System.ServiceModel.Discovery.DiscoveryClient.ResolveCompleted> event. Use the <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> or <xref:System.ServiceModel.Discovery.DiscoveryClient.FindAsync%2A> methods to search for services. Both of these methods take a <xref:System.ServiceModel.Discovery.FindCriteria> instance that allows you to specify contract type names, scopes, maximum number of results requested, and scope matching rules. The <xref:System.ServiceModel.Discovery.DiscoveryClient.FindCompleted> and <xref:System.ServiceModel.Discovery.DiscoveryClient.FindProgressChanged> events can be used when calling the <xref:System.ServiceModel.Discovery.DiscoveryClient.FindAsync%2A> method. <xref:System.ServiceModel.Discovery.DiscoveryClient.FindProgressChanged> is fired whenever the <xref:System.ServiceModel.Discovery.DiscoveryClient> receives a response from a service. It can be used to display a progress bar showing the progress of the find operation. It can also be used to act on find responses as they are received. The <xref:System.ServiceModel.Discovery.DiscoveryClient.FindCompleted> event is fired when the find operation completes. This may happen because the maximum number of responses has been received or if the <xref:System.ServiceModel.Discovery.FindCriteria.Duration%2A> has elapsed. When the find operation completes the results are returned in a <xref:System.ServiceModel.Discovery.FindResponse> instance. The <xref:System.ServiceModel.Discovery.FindResponse> contains a collection of <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> which contains the addresses, contract type names, extensions, listen URIs, and scopes of the matching services. You can then use this information to connect to and call one of the matching services. The following example shows how to call the System.ServiceModel.Discovery.DiscoveryClient.Find(System.ServiceModel.Discovery.FindCriteria) method and use the returned metadata to call the found service. A benefit of using <xref:System.ServiceModel.Discovery.DiscoveryClient> is that you can cache the list of endpoints you’ve found and use them at a later time. With this cache, you can build custom logic to handle various failure conditions.  \n  \n```  \nDiscoveryClient dc = new DiscoveryClient(new UdpDiscoveryEndpoint());  \n  \nFindCriteria criteria = new FindCriteria(typeof(ICalculatorService));  \nFindResponse fr = dc.Find(criteria);  \n  \nif (fr.Endpoints.Count > 0)  \n{  \n   EndpointAddress ep = fr.Endpoints[0].Address;  \n   CalculatorServiceClient client = new CalculatorServiceClient();  \n  \n    // Connect to the discovered service endpoint  \n   client.Endpoint.Address = endpointAddress;  \n   Console.WriteLine(\"Invoking CalculatorService at {0}\", endpointAddress);  \n  \n   double value1 = 100.00D;  \n   double value2 = 15.99D;  \n  \n   // Call the Add service operation.  \n   double result = client.Add(value1, value2);  \n   Console.WriteLine(\"Add({0},{1}) = {2}\", value1, value2, result);  \n}  \nelse  \n   Console.WriteLine(\"No matching endpoints found\");  \n  \n```  \n  \n The following example shows how to perform a find operation asynchronously.  \n  \n```  \nstatic void FindServiceAsync()  \n{  \n   DiscoveryClient dc = new DiscoveryClient(new UdpDiscoveryEndpoint());   \n   dc.FindCompleted += new EventHandler<FindCompletedEventArgs>( discoveryClient_FindCompleted);  \n   dc.FindProgressChanged += new EventHandler<FindProgressChangedEventArgs>(discoveryClient_FindProgressChanged);  \n   dc.FindAsync(new FindCriteria(typeof(ICalculatorService)));   \n}   \nstatic void discoveryClient_FindProgressChanged(object sender, FindProgressChangedEventArgs e)  \n{  \n   Console.WriteLine(\"Found service at: \" + e.EndpointDiscoveryMetadata.Address  \n}   \n  \nstatic void discoveryClient_FindCompleted(object sender, FindCompletedEventArgs e)  \n{    \n      if (e.Result.Endpoints.Count > 0)  \n            {  \n                EndpointAddress ep = e.Result.Endpoints[0].Address;  \n                CalculatorServiceClient client = new CalculatorServiceClient();  \n  \n                // Connect to the discovered service endpoint  \n                client.Endpoint.Address = ep;  \n                Console.WriteLine(\"Invoking CalculatorService at {0}\", ep);  \n  \n                double value1 = 100.00D;  \n                double value2 = 15.99D;  \n  \n                double result = client.Add(value1, value2);  \n                Console.WriteLine(\"Add({0},{1}) = {2}\", value1, value2, result);  \n            }  \n            else  \n                Console.WriteLine(\"No matching endpoints found\");  \n  \n        }  \n  \n```  \n  \n [!INCLUDE[crabout](../../../../includes/crabout-md.md)] making asynchronous find calls, see [Asynchronous Find](../../../../docs/framework/wcf/samples/asynchronous-find-sample.md).  \n  \n Use the <xref:System.ServiceModel.Discovery.DiscoveryClient.Resolve%2A> and <xref:System.ServiceModel.Discovery.DiscoveryClient.ResolveAsync%28System.ServiceModel.Discovery.ResolveCriteria%29> methods to locate a service based on its endpoint address. This is useful when the endpoint address is not network addressable. The Resolve methods take an instance of <xref:System.ServiceModel.Discovery.ResolveCriteria> which allows you to specify the endpoint address of the service you are resolving, the maximum duration of the resolve operation, and a set of extensions. The following example shows how to use the <xref:System.ServiceModel.Discovery.DiscoveryClient.Resolve%2A> method to resolve a service.  \n  \n```  \nDiscoveryClient dc = new DiscoveryClient(new UdpDiscoveryEndpoint());  \nResolveCriteria criteria = new ResolveCriteria(endpointAddress);  \nResolveResponse response = dc.Resolve(criteria);  \nEndpointAddress newEp = response.EndpointDiscoveryMetadata.Address;  \n  \n```  \n  \n## DynamicEndpoint  \n <xref:System.ServiceModel.Discovery.DynamicEndpoint> is a standard endpoint ([!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Standard Endpoints](../../../../docs/framework/wcf/feature-details/standard-endpoints.md)) which performs discovery and automatically selects a matching service. Just create a <xref:System.ServiceModel.Discovery.DynamicEndpoint> passing in the contract to search for and the binding to use and pass the <xref:System.ServiceModel.Discovery.DynamicEndpoint> instance to the WCF client. The following example shows how to create and use a <xref:System.ServiceModel.Discovery.DynamicEndpoint> to call the calculator service. The discovery is performed every time the client is opened. Any endpoint defined in configuration can also be turned into a <xref:System.ServiceModel.Discovery.DynamicEndpoint> by adding the `kind =\"dynamicEndpoint\"` attribute to the endpoint configuration element.  \n  \n```  \n  \nDynamicEndpoint dynamicEndpoint = new DynamicEndpoint(ContractDescription.GetContract(typeof(ICalculatorService)), new WSHttpBinding());  \nCalculatorServiceClient client = new CalculatorServiceClient(dynamicEndpoint);  \n  \nConsole.WriteLine(\"Invoking CalculatorService\");  \nConsole.WriteLine();  \n  \ndouble value1 = 100.00D;  \ndouble value2 = 15.99D;  \n  \ndouble result = client.Add(value1, value2);  \nConsole.WriteLine(\"Add({0},{1}) = {2}\", value1, value2, result);  \n  \n```  \n  \n## See Also  \n [Discovery with Scopes](../../../../docs/framework/wcf/samples/discovery-with-scopes-sample.md)   \n [Asynchronous Find](../../../../docs/framework/wcf/samples/asynchronous-find-sample.md)   \n [Basic](../../../../docs/framework/wcf/samples/basic-sample.md)","nodes":[{"pos":[12,64],"content":"DiscoveryClient and DynamicEndpoint | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"DiscoveryClient and DynamicEndpoint | Microsoft Docs","pos":[0,52]}]},{"pos":[362,397],"content":"DiscoveryClient and DynamicEndpoint","linkify":"DiscoveryClient and DynamicEndpoint","nodes":[{"content":"DiscoveryClient and DynamicEndpoint","pos":[0,35]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> are two classes used on the client side to search for services.","pos":[398,571],"source":"<xref:System.ServiceModel.Discovery.DiscoveryClient> and <xref:System.ServiceModel.Discovery.DynamicEndpoint> are two classes used on the client side to search for services."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient&gt;</ph> provides you with a list of services that match a specific set of criteria and allows you to connect to the services.","pos":[572,742],"source":"<xref:System.ServiceModel.Discovery.DiscoveryClient> provides you with a list of services that match a specific set of criteria and allows you to connect to the services."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> performs the same operation and in addition, automatically connects to one of the services that was found.","pos":[743,902],"source":"<xref:System.ServiceModel.Discovery.DynamicEndpoint> performs the same operation and in addition, automatically connects to one of the services that was found."},{"content":"Any endpoint can be made into a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph>, the search criteria can also be added in configuration, thus <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> is useful when you need discovery in your solution but do not want to modify the client logic – you only need to modify the endpoints.","pos":[903,1237],"source":" Any endpoint can be made into a <xref:System.ServiceModel.Discovery.DynamicEndpoint>, the search criteria can also be added in configuration, thus <xref:System.ServiceModel.Discovery.DynamicEndpoint> is useful when you need discovery in your solution but do not want to modify the client logic – you only need to modify the endpoints."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient&gt;</ph> on the other hand can be used to gain finer control over your search operation.","pos":[1238,1370],"source":"<xref:System.ServiceModel.Discovery.DiscoveryClient> on the other hand can be used to gain finer control over your search operation."},{"content":"The uses and benefits of each are elaborated below.","pos":[1371,1422]},{"pos":[1431,1446],"content":"DiscoveryClient","linkify":"DiscoveryClient","nodes":[{"content":"DiscoveryClient","pos":[0,15]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient&gt;</ph> defines synchronous and asynchronous Find methods, <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.FindCompleted&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.FindProgressChanged&gt;</ph> events.","pos":[1450,1709],"source":"The <xref:System.ServiceModel.Discovery.DiscoveryClient> defines synchronous and asynchronous Find methods, <xref:System.ServiceModel.Discovery.DiscoveryClient.FindCompleted> and <xref:System.ServiceModel.Discovery.DiscoveryClient.FindProgressChanged> events."},{"content":"It also defines synchronous and asynchronous Resolve methods and a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.ResolveCompleted&gt;</ph> event.","pos":[1711,1854],"source":"  It also defines synchronous and asynchronous Resolve methods and a <xref:System.ServiceModel.Discovery.DiscoveryClient.ResolveCompleted> event."},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.FindAsync%2A&gt;</ph> methods to search for services.","pos":[1855,2024],"source":" Use the <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> or <xref:System.ServiceModel.Discovery.DiscoveryClient.FindAsync%2A> methods to search for services."},{"content":"Both of these methods take a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria&gt;</ph> instance that allows you to specify contract type names, scopes, maximum number of results requested, and scope matching rules.","pos":[2025,2231],"source":" Both of these methods take a <xref:System.ServiceModel.Discovery.FindCriteria> instance that allows you to specify contract type names, scopes, maximum number of results requested, and scope matching rules."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.FindCompleted&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.FindProgressChanged&gt;</ph> events can be used when calling the <ph id=\"ph3\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.FindAsync%2A&gt;</ph> method.","pos":[2232,2489],"source":" The <xref:System.ServiceModel.Discovery.DiscoveryClient.FindCompleted> and <xref:System.ServiceModel.Discovery.DiscoveryClient.FindProgressChanged> events can be used when calling the <xref:System.ServiceModel.Discovery.DiscoveryClient.FindAsync%2A> method."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.FindProgressChanged&gt;</ph> is fired whenever the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient&gt;</ph> receives a response from a service.","pos":[2490,2673],"source":"<xref:System.ServiceModel.Discovery.DiscoveryClient.FindProgressChanged> is fired whenever the <xref:System.ServiceModel.Discovery.DiscoveryClient> receives a response from a service."},{"content":"It can be used to display a progress bar showing the progress of the find operation.","pos":[2674,2758]},{"content":"It can also be used to act on find responses as they are received.","pos":[2759,2825]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.FindCompleted&gt;</ph> event is fired when the find operation completes.","pos":[2826,2946],"source":" The <xref:System.ServiceModel.Discovery.DiscoveryClient.FindCompleted> event is fired when the find operation completes."},{"content":"This may happen because the maximum number of responses has been received or if the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindCriteria.Duration%2A&gt;</ph> has elapsed.","pos":[2947,3105],"source":" This may happen because the maximum number of responses has been received or if the <xref:System.ServiceModel.Discovery.FindCriteria.Duration%2A> has elapsed."},{"content":"When the find operation completes the results are returned in a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindResponse&gt;</ph> instance.","pos":[3106,3229],"source":" When the find operation completes the results are returned in a <xref:System.ServiceModel.Discovery.FindResponse> instance."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.FindResponse&gt;</ph> contains a collection of <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata&gt;</ph> which contains the addresses, contract type names, extensions, listen URIs, and scopes of the matching services.","pos":[3230,3484],"source":" The <xref:System.ServiceModel.Discovery.FindResponse> contains a collection of <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> which contains the addresses, contract type names, extensions, listen URIs, and scopes of the matching services."},{"content":"You can then use this information to connect to and call one of the matching services.","pos":[3485,3571]},{"content":"The following example shows how to call the System.ServiceModel.Discovery.DiscoveryClient.Find(System.ServiceModel.Discovery.FindCriteria) method and use the returned metadata to call the found service.","pos":[3572,3774]},{"content":"A benefit of using <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient&gt;</ph> is that you can cache the list of endpoints you’ve found and use them at a later time.","pos":[3775,3933],"source":" A benefit of using <xref:System.ServiceModel.Discovery.DiscoveryClient> is that you can cache the list of endpoints you’ve found and use them at a later time."},{"content":"With this cache, you can build custom logic to handle various failure conditions.","pos":[3934,4015]},{"content":"The following example shows how to perform a find operation asynchronously.","pos":[4854,4929]},{"pos":[6392,6572],"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> making asynchronous find calls, see <bpt id=\"p1\">[</bpt>Asynchronous Find<ept id=\"p1\">](../../../../docs/framework/wcf/samples/asynchronous-find-sample.md)</ept>.","source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] making asynchronous find calls, see [Asynchronous Find](../../../../docs/framework/wcf/samples/asynchronous-find-sample.md)."},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.Resolve%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.ResolveAsync%28System.ServiceModel.Discovery.ResolveCriteria%29&gt;</ph> methods to locate a service based on its endpoint address.","pos":[6579,6830],"source":"Use the <xref:System.ServiceModel.Discovery.DiscoveryClient.Resolve%2A> and <xref:System.ServiceModel.Discovery.DiscoveryClient.ResolveAsync%28System.ServiceModel.Discovery.ResolveCriteria%29> methods to locate a service based on its endpoint address."},{"content":"This is useful when the endpoint address is not network addressable.","pos":[6831,6899]},{"content":"The Resolve methods take an instance of <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.ResolveCriteria&gt;</ph> which allows you to specify the endpoint address of the service you are resolving, the maximum duration of the resolve operation, and a set of extensions.","pos":[6900,7147],"source":" The Resolve methods take an instance of <xref:System.ServiceModel.Discovery.ResolveCriteria> which allows you to specify the endpoint address of the service you are resolving, the maximum duration of the resolve operation, and a set of extensions."},{"content":"The following example shows how to use the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DiscoveryClient.Resolve%2A&gt;</ph> method to resolve a service.","pos":[7148,7283],"source":" The following example shows how to use the <xref:System.ServiceModel.Discovery.DiscoveryClient.Resolve%2A> method to resolve a service."},{"pos":[7570,7585],"content":"DynamicEndpoint","linkify":"DynamicEndpoint","nodes":[{"content":"DynamicEndpoint","pos":[0,15]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> is a standard endpoint (<ph id=\"ph2\">[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]</ph><bpt id=\"p1\">[</bpt>Standard Endpoints<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/standard-endpoints.md)</ept>) which performs discovery and automatically selects a matching service.","pos":[7589,7887],"source":"<xref:System.ServiceModel.Discovery.DynamicEndpoint> is a standard endpoint ([!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Standard Endpoints](../../../../docs/framework/wcf/feature-details/standard-endpoints.md)) which performs discovery and automatically selects a matching service."},{"content":"Just create a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> passing in the contract to search for and the binding to use and pass the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> instance to the WCF client.","pos":[7888,8109],"source":" Just create a <xref:System.ServiceModel.Discovery.DynamicEndpoint> passing in the contract to search for and the binding to use and pass the <xref:System.ServiceModel.Discovery.DynamicEndpoint> instance to the WCF client."},{"content":"The following example shows how to create and use a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> to call the calculator service.","pos":[8110,8246],"source":" The following example shows how to create and use a <xref:System.ServiceModel.Discovery.DynamicEndpoint> to call the calculator service."},{"content":"The discovery is performed every time the client is opened.","pos":[8247,8306]},{"content":"Any endpoint defined in configuration can also be turned into a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Discovery.DynamicEndpoint&gt;</ph> by adding the <ph id=\"ph2\">`kind =\"dynamicEndpoint\"`</ph> attribute to the endpoint configuration element.","pos":[8307,8512],"source":" Any endpoint defined in configuration can also be turned into a <xref:System.ServiceModel.Discovery.DynamicEndpoint> by adding the `kind =\"dynamicEndpoint\"` attribute to the endpoint configuration element."},{"pos":[9011,9019],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Discovery with Scopes<ept id=\"p1\">](../../../../docs/framework/wcf/samples/discovery-with-scopes-sample.md)</ept><ph id=\"ph1\"> </ph>","pos":[9023,9119],"source":"[Discovery with Scopes](../../../../docs/framework/wcf/samples/discovery-with-scopes-sample.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Asynchronous Find<ept id=\"p1\">](../../../../docs/framework/wcf/samples/asynchronous-find-sample.md)</ept><ph id=\"ph1\"> </ph>","pos":[9122,9211],"source":" [Asynchronous Find](../../../../docs/framework/wcf/samples/asynchronous-find-sample.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Basic<ept id=\"p1\">](../../../../docs/framework/wcf/samples/basic-sample.md)</ept>","pos":[9214,9278],"source":" [Basic](../../../../docs/framework/wcf/samples/basic-sample.md)"}]}