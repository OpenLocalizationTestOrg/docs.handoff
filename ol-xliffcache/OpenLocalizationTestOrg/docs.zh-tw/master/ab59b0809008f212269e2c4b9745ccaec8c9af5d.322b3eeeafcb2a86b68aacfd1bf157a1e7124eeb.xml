{"content":"---\ntitle: \"How To: Enable WIF Tracing\"\nms.date: \"03/30/2017\"\nms.assetid: 271b6889-3454-46ff-96ab-9feb15e742ee\nauthor: \"BrucePerlerMS\"\n---\n# How To: Enable WIF Tracing\n## Applies To  \n  \n-   Microsoft® Windows® Identity Foundation (WIF)  \n  \n-   ASP.NET® Web Forms  \n  \n## Summary  \n This How-To provides detailed step-by-step procedures for enabling WIF tracing in an ASP.NET application. It also provides instructions testing the application to verify that the trace listener and log are working correctly. This How-To does not have detailed instructions for creating a Security Token Service (STS), and instead uses the Development STS that comes with the Identity and Access tool. The Development STS does not perform real authentication and is intended for testing purposes only. You will need to install the Identity and Access tool to complete this How-To. It can be downloaded from the following location: [Identity and Access Tool](https://go.microsoft.com/fwlink/?LinkID=245849)  \n  \n> [!IMPORTANT]\n>  Enabling WIF tracing for passive applications, that is, applications that use the WS-Federation protocol, can potentially expose the application to denial of service (DoS) attacks or to information disclosure to a malicious party. This includes both passive RPs and passive STSes. For this reason, we recommend that you not enable WIF tracing for passive RPs or STSes in a production environment.  \n  \n## Contents  \n  \n-   Objectives  \n  \n-   Overview  \n  \n-   Summary of Steps  \n  \n-   Step 1 – Create a Simple ASP.NET Web Forms Application and Enable Tracing  \n  \n-   Step 2 – Test Your Solution  \n  \n## Objectives  \n  \n-   Create a simple ASP.NET application that uses WIF and the Development STS from the Identity and Access Tool  \n  \n-   Enable tracing and verify that it is working  \n  \n## Overview  \n Tracing enables you to debug and troubleshoot many types of issues with WIF, including tokens, cookies, claims, protocol messages, and more. WIF tracing is similar to WCF tracing; for example, you can choose the verbosity of traces to display everything from critical messages to all messages. WIF traces can be generated in **.xml** files or in **.svclog** files that are viewable by using the Service Trace Viewer Tool. This tool is located in the **bin** directory of the Windows SDK install path on your computer, for example: **C:\\Program Files\\Microsoft SDKs\\Windows\\v7.1\\Bin\\SvcTraceViewer.exe**.  \n  \n## Summary of Steps  \n  \n-   Step 1 – Create a Simple ASP.NET Web Forms Application and Enable Tracing  \n  \n-   Step 2 – Test Your Solution  \n  \n## Step 1 – Create a Simple ASP.NET Web Forms Application and Enable Tracing  \n In this step, you will create a new ASP.NET Web Forms application and modify the *Web.config* file to enable tracing.  \n  \n#### To create a simple ASP.NET application  \n  \n1.  Start Visual Studio and click **File**, **New**, and then **Project**.  \n  \n2.  In the **New Project** window, click **ASP.NET Web Forms Application**.  \n  \n3.  In **Name**, enter `TestApp` and press **OK**.  \n  \n4.  Right-click the **TestApp** project under **Solution Explorer**, then select **Identity and Access**.  \n  \n5.  The **Identity and Access** window appears. Under **Providers**, select **Test your application with the Local Development STS**, then click **Apply**.  \n  \n6.  Create a new folder in named **logs** in the root of the **C:** drive, like shown: **C:\\logs**  \n  \n7.  Add the following **\\<system.diagnostics>** element to the *Web.config* configuration file immediately following the closing **\\</configSections>** element, like shown:  \n  \n    ```xml  \n    <configuration>  \n        <configSections>  \n            ...\n        </configSections>  \n        <system.diagnostics>  \n            <sources>  \n                <source name=\"System.IdentityModel\" switchValue=\"Verbose\">  \n                    <listeners>  \n                        <add name=\"xml\" type=\"System.Diagnostics.XmlWriterTraceListener\" initializeData=\"C:\\logs\\WIF.xml\" />  \n                    </listeners>  \n                </source>  \n            </sources>  \n            <trace autoflush=\"true\" />  \n        </system.diagnostics>  \n    ```  \n  \n    > [!NOTE]\n    >  The directory location specified in the **initializeData** attribute must exist before logging can begin. If the location does not exist, no logs will be created.  \n  \n     The configuration settings above will enable **Verbose** tracing for WIF and save the resulting log to the **C:logsWIF.xml** file.  \n  \n## Step 2 – Test Your Solution  \n In this step, you will test your WIF-enabled ASP.NET application to verify that logs are being recorded.  \n  \n#### To test your WIF-enabled ASP.NET application for successful tracing  \n  \n1.  Run the solution by pressing the **F5** key. You should be presented with the default ASP.NET Home Page and automatically authenticated with the username *Terry*, which is the default user that is returned by the Development STS.  \n  \n2.  Close the browser window and then navigate to the **C:\\logs** folder. Open the **C:\\logs\\WIF.xml** file using a text editor.  \n  \n3.  Inspect the **WIF.xml** file and verify that it contains entries starting with **\\<E2ETraceEvent>**. These traces will contain **\\<TraceRecord>** elements with descriptions for the traced activity, such as **Validating SecurityToken**.\n","nodes":[{"pos":[4,134],"embed":true,"restype":"x-metadata","content":"title: \"How To: Enable WIF Tracing\"\nms.date: \"03/30/2017\"\nms.assetid: 271b6889-3454-46ff-96ab-9feb15e742ee\nauthor: \"BrucePerlerMS\"","nodes":[{"content":"How To: Enable WIF Tracing","nodes":[{"pos":[0,26],"content":"How To: Enable WIF Tracing","nodes":[{"content":"How To: Enable WIF Tracing","pos":[0,26]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[141,167],"content":"How To: Enable WIF Tracing","linkify":"How To: Enable WIF Tracing","nodes":[{"content":"How To: Enable WIF Tracing","pos":[0,26]}]},{"pos":[171,181],"content":"Applies To","linkify":"Applies To","nodes":[{"content":"Applies To","pos":[0,10]}]},{"content":"Microsoft® Windows® Identity Foundation (WIF)","pos":[191,236]},{"content":"ASP.NET® Web Forms","pos":[246,264]},{"pos":[273,280],"content":"Summary","linkify":"Summary","nodes":[{"content":"Summary","pos":[0,7]}]},{"content":"This How-To provides detailed step-by-step procedures for enabling WIF tracing in an ASP.NET application.","pos":[284,389]},{"content":"It also provides instructions testing the application to verify that the trace listener and log are working correctly.","pos":[390,508]},{"content":"This How-To does not have detailed instructions for creating a Security Token Service (STS), and instead uses the Development STS that comes with the Identity and Access tool.","pos":[509,684]},{"content":"The Development STS does not perform real authentication and is intended for testing purposes only.","pos":[685,784]},{"content":"You will need to install the Identity and Access tool to complete this How-To.","pos":[785,863]},{"content":"It can be downloaded from the following location: <bpt id=\"p1\">[</bpt>Identity and Access Tool<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=245849)</ept>","pos":[864,988],"source":" It can be downloaded from the following location: [Identity and Access Tool](https://go.microsoft.com/fwlink/?LinkID=245849)"},{"pos":[996,1408],"content":"[!IMPORTANT]\n Enabling WIF tracing for passive applications, that is, applications that use the WS-Federation protocol, can potentially expose the application to denial of service (DoS) attacks or to information disclosure to a malicious party. This includes both passive RPs and passive STSes. For this reason, we recommend that you not enable WIF tracing for passive RPs or STSes in a production environment.","leadings":["","> "],"nodes":[{"content":"Enabling WIF tracing for passive applications, that is, applications that use the WS-Federation protocol, can potentially expose the application to denial of service (DoS) attacks or to information disclosure to a malicious party. This includes both passive RPs and passive STSes. For this reason, we recommend that you not enable WIF tracing for passive RPs or STSes in a production environment.","pos":[14,410],"nodes":[{"content":"Enabling WIF tracing for passive applications, that is, applications that use the WS-Federation protocol, can potentially expose the application to denial of service (DoS) attacks or to information disclosure to a malicious party.","pos":[0,230]},{"content":"This includes both passive RPs and passive STSes.","pos":[231,280]},{"content":"For this reason, we recommend that you not enable WIF tracing for passive RPs or STSes in a production environment.","pos":[281,396]}]}]},{"pos":[1417,1425],"content":"Contents","linkify":"Contents","nodes":[{"content":"Contents","pos":[0,8]}]},{"content":"Objectives","pos":[1435,1445]},{"content":"Overview","pos":[1455,1463]},{"content":"Summary of Steps","pos":[1473,1489]},{"content":"Step 1 – Create a Simple ASP.NET Web Forms Application and Enable Tracing","pos":[1499,1572]},{"content":"Step 2 – Test Your Solution","pos":[1582,1609]},{"pos":[1618,1628],"content":"Objectives","linkify":"Objectives","nodes":[{"content":"Objectives","pos":[0,10]}]},{"content":"Create a simple ASP.NET application that uses WIF and the Development STS from the Identity and Access Tool","pos":[1638,1745]},{"content":"Enable tracing and verify that it is working","pos":[1755,1799]},{"pos":[1808,1816],"content":"Overview","linkify":"Overview","nodes":[{"content":"Overview","pos":[0,8]}]},{"content":"Tracing enables you to debug and troubleshoot many types of issues with WIF, including tokens, cookies, claims, protocol messages, and more.","pos":[1820,1960]},{"content":"WIF tracing is similar to WCF tracing; for example, you can choose the verbosity of traces to display everything from critical messages to all messages.","pos":[1961,2113]},{"content":"WIF traces can be generated in <bpt id=\"p1\">**</bpt>.xml<ept id=\"p1\">**</ept> files or in <bpt id=\"p2\">**</bpt>.svclog<ept id=\"p2\">**</ept> files that are viewable by using the Service Trace Viewer Tool.","pos":[2114,2241],"source":" WIF traces can be generated in **.xml** files or in **.svclog** files that are viewable by using the Service Trace Viewer Tool."},{"content":"This tool is located in the <bpt id=\"p1\">**</bpt>bin<ept id=\"p1\">**</ept> directory of the Windows SDK install path on your computer, for example: <bpt id=\"p2\">**</bpt>C:\\Program Files\\Microsoft SDKs\\Windows\\v7.1\\Bin\\SvcTraceViewer.exe<ept id=\"p2\">**</ept>.","pos":[2242,2423],"source":" This tool is located in the **bin** directory of the Windows SDK install path on your computer, for example: **C:\\Program Files\\Microsoft SDKs\\Windows\\v7.1\\Bin\\SvcTraceViewer.exe**."},{"pos":[2432,2448],"content":"Summary of Steps","linkify":"Summary of Steps","nodes":[{"content":"Summary of Steps","pos":[0,16]}]},{"content":"Step 1 – Create a Simple ASP.NET Web Forms Application and Enable Tracing","pos":[2458,2531]},{"content":"Step 2 – Test Your Solution","pos":[2541,2568]},{"pos":[2577,2650],"content":"Step 1 – Create a Simple ASP.NET Web Forms Application and Enable Tracing","linkify":"Step 1 – Create a Simple ASP.NET Web Forms Application and Enable Tracing","nodes":[{"content":"Step 1 – Create a Simple ASP.NET Web Forms Application and Enable Tracing","pos":[0,73]}]},{"pos":[2654,2771],"content":"In this step, you will create a new ASP.NET Web Forms application and modify the <bpt id=\"p1\">*</bpt>Web.config<ept id=\"p1\">*</ept> file to enable tracing.","source":"In this step, you will create a new ASP.NET Web Forms application and modify the *Web.config* file to enable tracing."},{"pos":[2782,2820],"content":"To create a simple ASP.NET application","linkify":"To create a simple ASP.NET application","nodes":[{"content":"To create a simple ASP.NET application","pos":[0,38]}]},{"pos":[2830,2900],"content":"Start Visual Studio and click <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>, and then <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"Start Visual Studio and click **File**, **New**, and then **Project**."},{"pos":[2910,2981],"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> window, click <bpt id=\"p2\">**</bpt>ASP.NET Web Forms Application<ept id=\"p2\">**</ept>.","source":"In the **New Project** window, click **ASP.NET Web Forms Application**."},{"pos":[2991,3037],"content":"In <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>, enter <ph id=\"ph1\">`TestApp`</ph> and press <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"In **Name**, enter `TestApp` and press **OK**."},{"pos":[3047,3148],"content":"Right-click the <bpt id=\"p1\">**</bpt>TestApp<ept id=\"p1\">**</ept> project under <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept>, then select <bpt id=\"p3\">**</bpt>Identity and Access<ept id=\"p3\">**</ept>.","source":"Right-click the **TestApp** project under **Solution Explorer**, then select **Identity and Access**."},{"content":"The <bpt id=\"p1\">**</bpt>Identity and Access<ept id=\"p1\">**</ept> window appears.","pos":[3158,3201],"source":"The **Identity and Access** window appears."},{"content":"Under <bpt id=\"p1\">**</bpt>Providers<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Test your application with the Local Development STS<ept id=\"p2\">**</ept>, then click <bpt id=\"p3\">**</bpt>Apply<ept id=\"p3\">**</ept>.","pos":[3202,3309],"source":" Under **Providers**, select **Test your application with the Local Development STS**, then click **Apply**."},{"pos":[3319,3413],"content":"Create a new folder in named <bpt id=\"p1\">**</bpt>logs<ept id=\"p1\">**</ept> in the root of the <bpt id=\"p2\">**</bpt>C:<ept id=\"p2\">**</ept> drive, like shown: <bpt id=\"p3\">**</bpt>C:\\logs<ept id=\"p3\">**</ept>","source":"Create a new folder in named **logs** in the root of the **C:** drive, like shown: **C:\\logs**"},{"pos":[3423,3591],"content":"Add the following <bpt id=\"p1\">**</bpt><ph id=\"ph1\">\\&lt;</ph>system.diagnostics&gt;<ept id=\"p1\">**</ept> element to the <bpt id=\"p2\">*</bpt>Web.config<ept id=\"p2\">*</ept> configuration file immediately following the closing <bpt id=\"p3\">**</bpt><ph id=\"ph2\">\\&lt;</ph>/configSections&gt;<ept id=\"p3\">**</ept> element, like shown:","source":"Add the following **\\<system.diagnostics>** element to the *Web.config* configuration file immediately following the closing **\\</configSections>** element, like shown:"},{"pos":[4176,4353],"content":"[!NOTE]\nThe directory location specified in the **initializeData** attribute must exist before logging can begin. If the location does not exist, no logs will be created.","leadings":["","    >  "],"nodes":[{"content":"The directory location specified in the **initializeData** attribute must exist before logging can begin. If the location does not exist, no logs will be created.","pos":[8,170],"nodes":[{"content":"The directory location specified in the <bpt id=\"p1\">**</bpt>initializeData<ept id=\"p1\">**</ept> attribute must exist before logging can begin.","pos":[0,105],"source":"The directory location specified in the **initializeData** attribute must exist before logging can begin."},{"content":"If the location does not exist, no logs will be created.","pos":[106,162]}]}]},{"pos":[4364,4494],"content":"The configuration settings above will enable <bpt id=\"p1\">**</bpt>Verbose<ept id=\"p1\">**</ept> tracing for WIF and save the resulting log to the <bpt id=\"p2\">**</bpt>C:logsWIF.xml<ept id=\"p2\">**</ept> file.","source":"The configuration settings above will enable **Verbose** tracing for WIF and save the resulting log to the **C:logsWIF.xml** file."},{"pos":[4503,4530],"content":"Step 2 – Test Your Solution","linkify":"Step 2 – Test Your Solution","nodes":[{"content":"Step 2 – Test Your Solution","pos":[0,27]}]},{"content":"In this step, you will test your WIF-enabled ASP.NET application to verify that logs are being recorded.","pos":[4534,4638]},{"pos":[4649,4716],"content":"To test your WIF-enabled ASP.NET application for successful tracing","linkify":"To test your WIF-enabled ASP.NET application for successful tracing","nodes":[{"content":"To test your WIF-enabled ASP.NET application for successful tracing","pos":[0,67]}]},{"content":"Run the solution by pressing the <bpt id=\"p1\">**</bpt>F5<ept id=\"p1\">**</ept> key.","pos":[4726,4770],"source":"Run the solution by pressing the **F5** key."},{"content":"You should be presented with the default ASP.NET Home Page and automatically authenticated with the username <bpt id=\"p1\">*</bpt>Terry<ept id=\"p1\">*</ept>, which is the default user that is returned by the Development STS.","pos":[4771,4955],"source":" You should be presented with the default ASP.NET Home Page and automatically authenticated with the username *Terry*, which is the default user that is returned by the Development STS."},{"content":"Close the browser window and then navigate to the <bpt id=\"p1\">**</bpt>C:\\logs<ept id=\"p1\">**</ept> folder.","pos":[4965,5034],"source":"Close the browser window and then navigate to the **C:\\logs** folder."},{"content":"Open the <bpt id=\"p1\">**</bpt>C:\\logs\\WIF.xml<ept id=\"p1\">**</ept> file using a text editor.","pos":[5035,5089],"source":" Open the **C:\\logs\\WIF.xml** file using a text editor."},{"content":"Inspect the <bpt id=\"p1\">**</bpt>WIF.xml<ept id=\"p1\">**</ept> file and verify that it contains entries starting with <bpt id=\"p2\">**</bpt><ph id=\"ph1\">\\&lt;</ph>E2ETraceEvent&gt;<ept id=\"p2\">**</ept>.","pos":[5099,5199],"source":"Inspect the **WIF.xml** file and verify that it contains entries starting with **\\<E2ETraceEvent>**."},{"content":"These traces will contain <bpt id=\"p1\">**</bpt><ph id=\"ph1\">\\&lt;</ph>TraceRecord&gt;<ept id=\"p1\">**</ept> elements with descriptions for the traced activity, such as <bpt id=\"p2\">**</bpt>Validating SecurityToken<ept id=\"p2\">**</ept>.","pos":[5200,5334],"source":" These traces will contain **\\<TraceRecord>** elements with descriptions for the traced activity, such as **Validating SecurityToken**."}]}