{"content":"---\ntitle: \"Walkthrough: Updating Status Bar Information at Run Time | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"status bars, updating at run time\"\n  - \"status bars, refreshing panels\"\n  - \"StatusBar control [Windows Forms], refreshing panels\"\n  - \"panels, refreshing status bar\"\nms.assetid: cc2abb06-c082-49f7-a5a3-2fd1bbcb58d1\ncaps.latest.revision: 18\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Updating Status Bar Information at Run Time\n> [!IMPORTANT]\n>  The <xref:System.Windows.Forms.StatusStrip> and <xref:System.Windows.Forms.ToolStripStatusLabel> controls replace and add functionality to the <xref:System.Windows.Forms.StatusBar> and <xref:System.Windows.Forms.StatusBarPanel> controls; however, the <xref:System.Windows.Forms.StatusBar> and <xref:System.Windows.Forms.StatusBarPanel> controls are retained for both backward compatibility and future use, if you choose.  \n  \n Often, a program will call for you to update the contents of status bar panels dynamically at run time, based on changes to application state or other user interaction. This is a common way to signal users that keys such as the CAPS LOCK, NUM LOCK, or SCROLL LOCK are enabled, or to provide the date or a clock as a convenient reference.  \n  \n In the following example, you will use an instance of the <xref:System.Windows.Forms.StatusBarPanel> class to host a clock.  \n  \n### To get the status bar ready for updating  \n  \n1.  Create a new Windows form.  \n  \n2.  Add a <xref:System.Windows.Forms.StatusBar> control to your form. For details, see [How to: Add Controls to Windows Forms](../../../../docs/framework/winforms/controls/how-to-add-controls-to-windows-forms.md).  \n  \n3.  Add a status bar panel to your <xref:System.Windows.Forms.StatusBar> control. For details, see [How to: Add Panels to a StatusBar Control](../../../../docs/framework/winforms/controls/how-to-add-panels-to-a-statusbar-control.md).  \n  \n4.  For the <xref:System.Windows.Forms.StatusBar> control you added to your form, set the <xref:System.Windows.Forms.StatusBar.ShowPanels%2A> property to `true`.  \n  \n5.  Add a Windows Forms <xref:System.Windows.Forms.Timer> component to the form.  \n  \n    > [!NOTE]\n    >  The Windows Forms <xref:System.Windows.Forms.Timer?displayProperty=fullName> component is designed for a Windows Forms environment. If you need a timer that is suitable for a server environment, see [Introduction to Server-Based Timers](http://msdn.microsoft.com/en-us/adc0bc0a-a519-4812-bafc-fb9d1a5801fc).  \n  \n6.  Set the <xref:System.Windows.Forms.Timer.Enabled%2A> property to `true`.  \n  \n7.  Set the <xref:System.Windows.Forms.Timer.Interval%2A> property of the <xref:System.Windows.Forms.Timer> to 30000.  \n  \n    > [!NOTE]\n    >  The <xref:System.Windows.Forms.Timer.Interval%2A> property of the <xref:System.Windows.Forms.Timer> component is set to 30 seconds (30,000 milliseconds) to ensure that an accurate time is reflected in the time displayed.  \n  \n### To implement the timer to update the status bar  \n  \n1.  Insert the following code into the event handler of the <xref:System.Windows.Forms.Timer> component to update the panel of the <xref:System.Windows.Forms.StatusBar> control.  \n  \n    ```vb  \n    Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick  \n       StatusBar1.Panels(0).Text = Now.ToShortTimeString  \n    End Sub  \n  \n    ```  \n  \n    ```csharp  \n    private void timer1_Tick(object sender, System.EventArgs e)  \n    {  \n       statusBar1.Panels[0].Text = DateTime.Now.ToShortTimeString();  \n    }  \n  \n    ```  \n  \n    ```cpp  \n    private:  \n      System::Void timer1_Tick(System::Object ^ sender,  \n        System::EventArgs ^ e)  \n      {  \n        statusBar1->Panels[0]->Text =  \n          DateTime::Now.ToShortTimeString();  \n      }  \n    ```  \n  \n     At this point, you are ready to run the application and observe the clock running in the status bar panel.  \n  \n### To test the application  \n  \n1.  Debug the application and press F5 to run it. For details about debugging, see [Debugging in Visual Studio](/visualstudio/debugger/debugging-in-visual-studio).  \n  \n    > [!NOTE]\n    >  It will take approximately 30 seconds for the clock to appear in the status bar. This is to get the most accurate time possible. Conversely, to make the clock appear sooner, you can reduce the value of the <xref:System.Windows.Forms.Timer.Interval%2A> property you set in step 7 in the previous procedure.  \n  \n## See Also  \n <xref:System.Windows.Forms.StatusBar>   \n <xref:System.Windows.Forms.ToolStripStatusLabel>   \n [How to: Add Panels to a StatusBar Control](../../../../docs/framework/winforms/controls/how-to-add-panels-to-a-statusbar-control.md)   \n [How to: Determine Which Panel in the Windows Forms StatusBar Control Was Clicked](../../../../docs/framework/winforms/controls/determine-which-panel-wf-statusbar-control-was-clicked.md)   \n [StatusBar Control Overview](../../../../docs/framework/winforms/controls/statusbar-control-overview-windows-forms.md)","nodes":[{"pos":[4,610],"nodes":[{"content":"Walkthrough: Updating Status Bar Information at Run Time | Microsoft Docs","nodes":[{"pos":[0,73],"content":"Walkthrough: Updating Status Bar Information at Run Time | Microsoft Docs","nodes":[{"content":"Walkthrough: Updating Status Bar Information at Run Time | Microsoft Docs","pos":[0,73]}]}],"pos":[6,82],"yaml":true}],"content":"title: \"Walkthrough: Updating Status Bar Information at Run Time | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"status bars, updating at run time\"\n  - \"status bars, refreshing panels\"\n  - \"StatusBar control [Windows Forms], refreshing panels\"\n  - \"panels, refreshing status bar\"\nms.assetid: cc2abb06-c082-49f7-a5a3-2fd1bbcb58d1\ncaps.latest.revision: 18\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","yamlblock":true},{"pos":[617,673],"content":"Walkthrough: Updating Status Bar Information at Run Time","linkify":"Walkthrough: Updating Status Bar Information at Run Time","nodes":[{"content":"Walkthrough: Updating Status Bar Information at Run Time","pos":[0,56]}]},{"pos":[676,1112],"content":"[!IMPORTANT]\n The <xref:System.Windows.Forms.StatusStrip> and <xref:System.Windows.Forms.ToolStripStatusLabel> controls replace and add functionality to the <xref:System.Windows.Forms.StatusBar> and <xref:System.Windows.Forms.StatusBarPanel> controls; however, the <xref:System.Windows.Forms.StatusBar> and <xref:System.Windows.Forms.StatusBarPanel> controls are retained for both backward compatibility and future use, if you choose.","leadings":["","> "],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.StatusStrip&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolStripStatusLabel&gt;</ph> controls replace and add functionality to the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.StatusBar&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.Forms.StatusBarPanel&gt;</ph> controls; however, the <ph id=\"ph5\">&lt;xref:System.Windows.Forms.StatusBar&gt;</ph> and <ph id=\"ph6\">&lt;xref:System.Windows.Forms.StatusBarPanel&gt;</ph> controls are retained for both backward compatibility and future use, if you choose.","pos":[14,434],"source":"The <xref:System.Windows.Forms.StatusStrip> and <xref:System.Windows.Forms.ToolStripStatusLabel> controls replace and add functionality to the <xref:System.Windows.Forms.StatusBar> and <xref:System.Windows.Forms.StatusBarPanel> controls; however, the <xref:System.Windows.Forms.StatusBar> and <xref:System.Windows.Forms.StatusBarPanel> controls are retained for both backward compatibility and future use, if you choose."}]},{"content":"Often, a program will call for you to update the contents of status bar panels dynamically at run time, based on changes to application state or other user interaction.","pos":[1119,1287]},{"content":"This is a common way to signal users that keys such as the CAPS LOCK, NUM LOCK, or SCROLL LOCK are enabled, or to provide the date or a clock as a convenient reference.","pos":[1288,1456]},{"content":"In the following example, you will use an instance of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.StatusBarPanel&gt;</ph> class to host a clock.","pos":[1463,1586],"source":"In the following example, you will use an instance of the <xref:System.Windows.Forms.StatusBarPanel> class to host a clock."},{"pos":[1596,1636],"content":"To get the status bar ready for updating","linkify":"To get the status bar ready for updating","nodes":[{"content":"To get the status bar ready for updating","pos":[0,40]}]},{"content":"Create a new Windows form.","pos":[1646,1672]},{"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.StatusBar&gt;</ph> control to your form.","pos":[1682,1747],"source":"Add a <xref:System.Windows.Forms.StatusBar> control to your form."},{"content":"For details, see <bpt id=\"p1\">[</bpt>How to: Add Controls to Windows Forms<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-add-controls-to-windows-forms.md)</ept>.","pos":[1748,1891],"source":" For details, see [How to: Add Controls to Windows Forms](../../../../docs/framework/winforms/controls/how-to-add-controls-to-windows-forms.md)."},{"content":"Add a status bar panel to your <ph id=\"ph1\">&lt;xref:System.Windows.Forms.StatusBar&gt;</ph> control.","pos":[1901,1978],"source":"Add a status bar panel to your <xref:System.Windows.Forms.StatusBar> control."},{"content":"For details, see <bpt id=\"p1\">[</bpt>How to: Add Panels to a StatusBar Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-add-panels-to-a-statusbar-control.md)</ept>.","pos":[1979,2130],"source":" For details, see [How to: Add Panels to a StatusBar Control](../../../../docs/framework/winforms/controls/how-to-add-panels-to-a-statusbar-control.md)."},{"pos":[2140,2297],"content":"For the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.StatusBar&gt;</ph> control you added to your form, set the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.StatusBar.ShowPanels%2A&gt;</ph> property to <ph id=\"ph3\">`true`</ph>.","source":"For the <xref:System.Windows.Forms.StatusBar> control you added to your form, set the <xref:System.Windows.Forms.StatusBar.ShowPanels%2A> property to `true`."},{"content":"Add a Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer&gt;</ph> component to the form.","pos":[2307,2383],"source":"Add a Windows Forms <xref:System.Windows.Forms.Timer> component to the form."},{"pos":[2395,2717],"content":"[!NOTE]\nThe Windows Forms <xref:System.Windows.Forms.Timer?displayProperty=fullName> component is designed for a Windows Forms environment. If you need a timer that is suitable for a server environment, see [Introduction to Server-Based Timers](http://msdn.microsoft.com/en-us/adc0bc0a-a519-4812-bafc-fb9d1a5801fc).","leadings":["","    >  "],"nodes":[{"content":"The Windows Forms <xref:System.Windows.Forms.Timer?displayProperty=fullName> component is designed for a Windows Forms environment. If you need a timer that is suitable for a server environment, see [Introduction to Server-Based Timers](http://msdn.microsoft.com/en-us/adc0bc0a-a519-4812-bafc-fb9d1a5801fc).","pos":[8,315],"nodes":[{"content":"The Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer?displayProperty=fullName&gt;</ph> component is designed for a Windows Forms environment.","pos":[0,131],"source":"The Windows Forms <xref:System.Windows.Forms.Timer?displayProperty=fullName> component is designed for a Windows Forms environment."},{"content":"If you need a timer that is suitable for a server environment, see <bpt id=\"p1\">[</bpt>Introduction to Server-Based Timers<ept id=\"p1\">](http://msdn.microsoft.com/en-us/adc0bc0a-a519-4812-bafc-fb9d1a5801fc)</ept>.","pos":[132,307],"source":" If you need a timer that is suitable for a server environment, see [Introduction to Server-Based Timers](http://msdn.microsoft.com/en-us/adc0bc0a-a519-4812-bafc-fb9d1a5801fc)."}]}]},{"pos":[2727,2799],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Enabled%2A&gt;</ph> property to <ph id=\"ph2\">`true`</ph>.","source":"Set the <xref:System.Windows.Forms.Timer.Enabled%2A> property to `true`."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Interval%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Timer&gt;</ph> to 30000.","pos":[2809,2922],"source":"Set the <xref:System.Windows.Forms.Timer.Interval%2A> property of the <xref:System.Windows.Forms.Timer> to 30000."},{"pos":[2934,3169],"content":"[!NOTE]\nThe <xref:System.Windows.Forms.Timer.Interval%2A> property of the <xref:System.Windows.Forms.Timer> component is set to 30 seconds (30,000 milliseconds) to ensure that an accurate time is reflected in the time displayed.","leadings":["","    >  "],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Interval%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Timer&gt;</ph> component is set to 30 seconds (30,000 milliseconds) to ensure that an accurate time is reflected in the time displayed.","pos":[8,228],"source":"The <xref:System.Windows.Forms.Timer.Interval%2A> property of the <xref:System.Windows.Forms.Timer> component is set to 30 seconds (30,000 milliseconds) to ensure that an accurate time is reflected in the time displayed."}]},{"pos":[3179,3226],"content":"To implement the timer to update the status bar","linkify":"To implement the timer to update the status bar","nodes":[{"content":"To implement the timer to update the status bar","pos":[0,47]}]},{"content":"Insert the following code into the event handler of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer&gt;</ph> component to update the panel of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.StatusBar&gt;</ph> control.","pos":[3236,3409],"source":"Insert the following code into the event handler of the <xref:System.Windows.Forms.Timer> component to update the panel of the <xref:System.Windows.Forms.StatusBar> control."},{"content":"At this point, you are ready to run the application and observe the clock running in the status bar panel.","pos":[4055,4161]},{"pos":[4171,4194],"content":"To test the application","linkify":"To test the application","nodes":[{"content":"To test the application","pos":[0,23]}]},{"content":"Debug the application and press F5 to run it.","pos":[4204,4249]},{"content":"For details about debugging, see <bpt id=\"p1\">[</bpt>Debugging in Visual Studio<ept id=\"p1\">](/visualstudio/debugger/debugging-in-visual-studio)</ept>.","pos":[4250,4363],"source":" For details about debugging, see [Debugging in Visual Studio](/visualstudio/debugger/debugging-in-visual-studio)."},{"pos":[4375,4695],"content":"[!NOTE]\nIt will take approximately 30 seconds for the clock to appear in the status bar. This is to get the most accurate time possible. Conversely, to make the clock appear sooner, you can reduce the value of the <xref:System.Windows.Forms.Timer.Interval%2A> property you set in step 7 in the previous procedure.","leadings":["","    >  "],"nodes":[{"content":"It will take approximately 30 seconds for the clock to appear in the status bar. This is to get the most accurate time possible. Conversely, to make the clock appear sooner, you can reduce the value of the <xref:System.Windows.Forms.Timer.Interval%2A> property you set in step 7 in the previous procedure.","pos":[8,313],"nodes":[{"content":"It will take approximately 30 seconds for the clock to appear in the status bar.","pos":[0,80]},{"content":"This is to get the most accurate time possible.","pos":[81,128]},{"content":"Conversely, to make the clock appear sooner, you can reduce the value of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Interval%2A&gt;</ph> property you set in step 7 in the previous procedure.","pos":[129,305],"source":" Conversely, to make the clock appear sooner, you can reduce the value of the <xref:System.Windows.Forms.Timer.Interval%2A> property you set in step 7 in the previous procedure."}]}]},{"pos":[4704,4712],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.StatusBar&gt;</ph>","pos":[4716,4753],"source":"<xref:System.Windows.Forms.StatusBar> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStripStatusLabel&gt;</ph>","pos":[4758,4806],"source":"<xref:System.Windows.Forms.ToolStripStatusLabel> "},{"content":"<bpt id=\"p1\">[</bpt>How to: Add Panels to a StatusBar Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-add-panels-to-a-statusbar-control.md)</ept><ph id=\"ph1\"> </ph>","pos":[4811,4945],"source":"[How to: Add Panels to a StatusBar Control](../../../../docs/framework/winforms/controls/how-to-add-panels-to-a-statusbar-control.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Determine Which Panel in the Windows Forms StatusBar Control Was Clicked<ept id=\"p1\">](../../../../docs/framework/winforms/controls/determine-which-panel-wf-statusbar-control-was-clicked.md)</ept><ph id=\"ph1\"> </ph>","pos":[4949,5136],"source":"[How to: Determine Which Panel in the Windows Forms StatusBar Control Was Clicked](../../../../docs/framework/winforms/controls/determine-which-panel-wf-statusbar-control-was-clicked.md) "},{"content":"<bpt id=\"p1\">[</bpt>StatusBar Control Overview<ept id=\"p1\">](../../../../docs/framework/winforms/controls/statusbar-control-overview-windows-forms.md)</ept>","pos":[5140,5258],"source":"[StatusBar Control Overview](../../../../docs/framework/winforms/controls/statusbar-control-overview-windows-forms.md)"}]}