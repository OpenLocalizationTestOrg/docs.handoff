{"content":"---\ntitle: \"How to: Write Services Programmatically\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"services, creating\"\n  - \"Windows Service applications, creating\"\nms.assetid: 3abbb2ec-78d2-41e6-b9f9-6662d4e2cdc7\nauthor: \"ghogen\"\n---\n# How to: Write Services Programmatically\nIf you choose not to use the Windows Service project template, you can write your own services by setting up the inheritance and other infrastructure elements yourself. When you create a service programmatically, you must perform several steps that the template would otherwise handle for you:  \n  \n-   You must set up your service class to inherit from the <xref:System.ServiceProcess.ServiceBase> class.  \n  \n-   You must create a `Main` method for your service project that defines the services to run and calls the <xref:System.ServiceProcess.ServiceBase.Run%2A> method on them.  \n  \n-   You must override the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> procedures and fill in any code you want them to run.  \n  \n### To write a service programmatically  \n  \n1.  Create an empty project and create a reference to the necessary namespaces by following these steps:  \n  \n    1.  In **Solution Explorer**, right-click the **References** node and click **Add Reference**.  \n  \n    2.  On the **.NET Framework** tab, scroll to **System.dll** and click **Select**.  \n  \n    3.  Scroll to **System.ServiceProcess.dll** and click **Select**.  \n  \n    4.  Click **OK**.  \n  \n2.  Add a class and configure it to inherit from <xref:System.ServiceProcess.ServiceBase>:  \n  \n     [!code-csharp[VbRadconService#7](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#7)]\n     [!code-vb[VbRadconService#7](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#7)]  \n  \n3.  Add the following code to configure your service class:  \n  \n     [!code-csharp[VbRadconService#8](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#8)]\n     [!code-vb[VbRadconService#8](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#8)]  \n  \n4.  Create a `Main` method for your class, and use it to define the service your class will contain; `userService1` is the name of the class:  \n  \n     [!code-csharp[VbRadconService#9](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#9)]\n     [!code-vb[VbRadconService#9](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#9)]  \n  \n5.  Override the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method, and define any processing you want to occur when your service is started.  \n  \n     [!code-csharp[VbRadconService#10](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#10)]\n     [!code-vb[VbRadconService#10](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#10)]  \n  \n6.  Override any other methods you want to define custom processing for, and write code to determine the actions the service should take in each case.  \n  \n7.  Add the necessary installers for your service application. For more information, see [How to: Add Installers to Your Service Application](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md).  \n  \n8.  Build your project by selecting **Build Solution** from the **Build** menu.  \n  \n    > [!NOTE]\n    >  Do not press F5 to run your project — you cannot run a service project in this way.  \n  \n9. Create a setup project and the custom actions to install your service. For an example, see [Walkthrough: Creating a Windows Service Application in the Component Designer](../../../docs/framework/windows-services/walkthrough-creating-a-windows-service-application-in-the-component-designer.md).  \n  \n10. Install the service. For more information, see [How to: Install and Uninstall Services](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md).  \n  \n## See also\n\n- [Introduction to Windows Service Applications](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)\n- [How to: Create Windows Services](../../../docs/framework/windows-services/how-to-create-windows-services.md)\n- [How to: Add Installers to Your Service Application](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)\n- [How to: Log Information About Services](../../../docs/framework/windows-services/how-to-log-information-about-services.md)\n- [Walkthrough: Creating a Windows Service Application in the Component Designer](../../../docs/framework/windows-services/walkthrough-creating-a-windows-service-application-in-the-component-designer.md)\n","nodes":[{"pos":[4,266],"embed":true,"restype":"x-metadata","content":"title: \"How to: Write Services Programmatically\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"services, creating\"\n  - \"Windows Service applications, creating\"\nms.assetid: 3abbb2ec-78d2-41e6-b9f9-6662d4e2cdc7\nauthor: \"ghogen\"","nodes":[{"content":"How to: Write Services Programmatically","nodes":[{"pos":[0,39],"content":"How to: Write Services Programmatically","nodes":[{"content":"How to: Write Services Programmatically","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[273,312],"content":"How to: Write Services Programmatically","linkify":"How to: Write Services Programmatically","nodes":[{"content":"How to: Write Services Programmatically","pos":[0,39]}]},{"content":"If you choose not to use the Windows Service project template, you can write your own services by setting up the inheritance and other infrastructure elements yourself.","pos":[313,481]},{"content":"When you create a service programmatically, you must perform several steps that the template would otherwise handle for you:","pos":[482,606]},{"pos":[616,718],"content":"You must set up your service class to inherit from the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase&gt;</ph> class.","source":"You must set up your service class to inherit from the <xref:System.ServiceProcess.ServiceBase> class."},{"pos":[728,895],"content":"You must create a <ph id=\"ph1\">`Main`</ph> method for your service project that defines the services to run and calls the <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase.Run%2A&gt;</ph> method on them.","source":"You must create a `Main` method for your service project that defines the services to run and calls the <xref:System.ServiceProcess.ServiceBase.Run%2A> method on them."},{"pos":[905,1087],"content":"You must override the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase.OnStop%2A&gt;</ph> procedures and fill in any code you want them to run.","source":"You must override the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> procedures and fill in any code you want them to run."},{"pos":[1097,1132],"content":"To write a service programmatically","linkify":"To write a service programmatically","nodes":[{"content":"To write a service programmatically","pos":[0,35]}]},{"content":"Create an empty project and create a reference to the necessary namespaces by following these steps:","pos":[1142,1242]},{"pos":[1256,1346],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the <bpt id=\"p2\">**</bpt>References<ept id=\"p2\">**</ept> node and click <bpt id=\"p3\">**</bpt>Add Reference<ept id=\"p3\">**</ept>.","source":"In **Solution Explorer**, right-click the **References** node and click **Add Reference**."},{"pos":[1360,1437],"content":"On the <bpt id=\"p1\">**</bpt>.NET Framework<ept id=\"p1\">**</ept> tab, scroll to <bpt id=\"p2\">**</bpt>System.dll<ept id=\"p2\">**</ept> and click <bpt id=\"p3\">**</bpt>Select<ept id=\"p3\">**</ept>.","source":"On the **.NET Framework** tab, scroll to **System.dll** and click **Select**."},{"pos":[1451,1512],"content":"Scroll to <bpt id=\"p1\">**</bpt>System.ServiceProcess.dll<ept id=\"p1\">**</ept> and click <bpt id=\"p2\">**</bpt>Select<ept id=\"p2\">**</ept>.","source":"Scroll to **System.ServiceProcess.dll** and click **Select**."},{"pos":[1526,1539],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"pos":[1549,1635],"content":"Add a class and configure it to inherit from <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase&gt;</ph>:","source":"Add a class and configure it to inherit from <xref:System.ServiceProcess.ServiceBase>:"},{"pos":[1646,1903],"content":"[!code-csharp[VbRadconService#7](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#7)]\n [!code-vb[VbRadconService#7](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#7)]","leadings":["","    "],"nodes":[]},{"content":"Add the following code to configure your service class:","pos":[1913,1968]},{"pos":[1979,2236],"content":"[!code-csharp[VbRadconService#8](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#8)]\n [!code-vb[VbRadconService#8](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#8)]","leadings":["","    "],"nodes":[]},{"pos":[2246,2383],"content":"Create a <ph id=\"ph1\">`Main`</ph> method for your class, and use it to define the service your class will contain; <ph id=\"ph2\">`userService1`</ph> is the name of the class:","source":"Create a `Main` method for your class, and use it to define the service your class will contain; `userService1` is the name of the class:"},{"pos":[2394,2651],"content":"[!code-csharp[VbRadconService#9](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#9)]\n [!code-vb[VbRadconService#9](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#9)]","leadings":["","    "],"nodes":[]},{"pos":[2661,2807],"content":"Override the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> method, and define any processing you want to occur when your service is started.","source":"Override the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> method, and define any processing you want to occur when your service is started."},{"pos":[2818,3079],"content":"[!code-csharp[VbRadconService#10](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#10)]\n [!code-vb[VbRadconService#10](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#10)]","leadings":["","    "],"nodes":[]},{"content":"Override any other methods you want to define custom processing for, and write code to determine the actions the service should take in each case.","pos":[3089,3235]},{"content":"Add the necessary installers for your service application.","pos":[3245,3303]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Add Installers to Your Service Application<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)</ept>.","pos":[3304,3478],"source":" For more information, see [How to: Add Installers to Your Service Application](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)."},{"pos":[3488,3563],"content":"Build your project by selecting <bpt id=\"p1\">**</bpt>Build Solution<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Build<ept id=\"p2\">**</ept> menu.","source":"Build your project by selecting **Build Solution** from the **Build** menu."},{"pos":[3575,3673],"content":"[!NOTE]\nDo not press F5 to run your project — you cannot run a service project in this way.","leadings":["","    >  "],"nodes":[{"content":"Do not press F5 to run your project — you cannot run a service project in this way.","pos":[8,91]}]},{"content":"Create a setup project and the custom actions to install your service.","pos":[3682,3752]},{"content":"For an example, see <bpt id=\"p1\">[</bpt>Walkthrough: Creating a Windows Service Application in the Component Designer<ept id=\"p1\">](../../../docs/framework/windows-services/walkthrough-creating-a-windows-service-application-in-the-component-designer.md)</ept>.","pos":[3753,3975],"source":" For an example, see [Walkthrough: Creating a Windows Service Application in the Component Designer](../../../docs/framework/windows-services/walkthrough-creating-a-windows-service-application-in-the-component-designer.md)."},{"content":"Install the service.","pos":[3985,4005]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Install and Uninstall Services<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md)</ept>.","pos":[4006,4156],"source":" For more information, see [How to: Install and Uninstall Services](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md)."},{"pos":[4165,4173],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4177,4313],"content":"<bpt id=\"p1\">[</bpt>Introduction to Windows Service Applications<ept id=\"p1\">](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)</ept>","source":"[Introduction to Windows Service Applications](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)"},{"pos":[4316,4425],"content":"<bpt id=\"p1\">[</bpt>How to: Create Windows Services<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-create-windows-services.md)</ept>","source":"[How to: Create Windows Services](../../../docs/framework/windows-services/how-to-create-windows-services.md)"},{"pos":[4428,4575],"content":"<bpt id=\"p1\">[</bpt>How to: Add Installers to Your Service Application<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)</ept>","source":"[How to: Add Installers to Your Service Application](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)"},{"pos":[4578,4701],"content":"<bpt id=\"p1\">[</bpt>How to: Log Information About Services<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-log-information-about-services.md)</ept>","source":"[How to: Log Information About Services](../../../docs/framework/windows-services/how-to-log-information-about-services.md)"},{"pos":[4704,4905],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Creating a Windows Service Application in the Component Designer<ept id=\"p1\">](../../../docs/framework/windows-services/walkthrough-creating-a-windows-service-application-in-the-component-designer.md)</ept>","source":"[Walkthrough: Creating a Windows Service Application in the Component Designer](../../../docs/framework/windows-services/walkthrough-creating-a-windows-service-application-in-the-component-designer.md)"}]}