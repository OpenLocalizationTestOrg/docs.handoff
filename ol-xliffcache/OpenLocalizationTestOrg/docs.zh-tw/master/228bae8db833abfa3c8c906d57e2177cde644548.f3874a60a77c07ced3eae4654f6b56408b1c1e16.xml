{"content":"---\ntitle: \"Using User-Filtered Exception Handlers\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"user-filtered exceptions\"\n  - \"exceptions, user-filtered\"\nms.assetid: aa80d155-060d-41b4-a636-1ceb424afee8\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Using User-Filtered Exception Handlers\n\nCurrently, Visual Basic supports user-filtered exceptions. User-filtered exception handlers catch and handle exceptions based on requirements you define for the exception. These handlers use the **Catch** statement with the **When** keyword.  \n  \n This technique is useful when a particular exception object corresponds to multiple errors. In this case, the object typically has a property that contains the specific error code associated with the error. You can use the error code property in the expression to select only the particular error you want to handle in that **Catch** clause.  \n  \n The following Visual Basic example illustrates the **Catch/When** statement.  \n  \n```vb\nTry  \n    'Try statements.  \n    Catch When Err = VBErr_ClassLoadException\n    'Catch statements.\nEnd Try  \n```  \n  \n The expression of the user-filtered clause is not restricted in any way. If an exception occurs during execution of the user-filtered expression, that exception is discarded and the filter expression is considered to have evaluated to false. In this case, the common language runtime continues the search for a handler for the current exception.  \n  \n## Combining the Specific Exception and the User-Filtered Clauses  \n A catch statement can contain both the specific exception and the user-filtered clauses. The runtime tests the specific exception first. If the specific exception succeeds, the runtime executes the user filter. The generic filter can contain a reference to the variable declared in the class filter. Note that the order of the two filter clauses cannot be reversed.  \n  \n The following Visual Basic example shows the specific exception `ClassLoadException` in the **Catch** statement as well as the user-filtered clause using the **When** keyword.  \n  \n```vb\nTry  \n    'Try statements.\n    Catch cle As ClassLoadException When cle.IsRecoverable()  \n    'Catch statements.\nEnd Try  \n```  \n\n## See also\n\n- [Exceptions](index.md)\n","nodes":[{"pos":[4,275],"embed":true,"restype":"x-metadata","content":"title: \"Using User-Filtered Exception Handlers\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"user-filtered exceptions\"\n  - \"exceptions, user-filtered\"\nms.assetid: aa80d155-060d-41b4-a636-1ceb424afee8\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Using User-Filtered Exception Handlers","nodes":[{"pos":[0,38],"content":"Using User-Filtered Exception Handlers","nodes":[{"content":"Using User-Filtered Exception Handlers","pos":[0,38]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[282,320],"content":"Using User-Filtered Exception Handlers","linkify":"Using User-Filtered Exception Handlers","nodes":[{"content":"Using User-Filtered Exception Handlers","pos":[0,38]}]},{"content":"Currently, Visual Basic supports user-filtered exceptions.","pos":[322,380]},{"content":"User-filtered exception handlers catch and handle exceptions based on requirements you define for the exception.","pos":[381,493]},{"content":"These handlers use the <bpt id=\"p1\">**</bpt>Catch<ept id=\"p1\">**</ept> statement with the <bpt id=\"p2\">**</bpt>When<ept id=\"p2\">**</ept> keyword.","pos":[494,563],"source":" These handlers use the **Catch** statement with the **When** keyword."},{"content":"This technique is useful when a particular exception object corresponds to multiple errors.","pos":[570,661]},{"content":"In this case, the object typically has a property that contains the specific error code associated with the error.","pos":[662,776]},{"content":"You can use the error code property in the expression to select only the particular error you want to handle in that <bpt id=\"p1\">**</bpt>Catch<ept id=\"p1\">**</ept> clause.","pos":[777,911],"source":" You can use the error code property in the expression to select only the particular error you want to handle in that **Catch** clause."},{"pos":[918,994],"content":"The following Visual Basic example illustrates the <bpt id=\"p1\">**</bpt>Catch/When<ept id=\"p1\">**</ept> statement.","source":"The following Visual Basic example illustrates the **Catch/When** statement."},{"content":"The expression of the user-filtered clause is not restricted in any way.","pos":[1124,1196]},{"content":"If an exception occurs during execution of the user-filtered expression, that exception is discarded and the filter expression is considered to have evaluated to false.","pos":[1197,1365]},{"content":"In this case, the common language runtime continues the search for a handler for the current exception.","pos":[1366,1469]},{"pos":[1478,1540],"content":"Combining the Specific Exception and the User-Filtered Clauses","linkify":"Combining the Specific Exception and the User-Filtered Clauses","nodes":[{"content":"Combining the Specific Exception and the User-Filtered Clauses","pos":[0,62]}]},{"content":"A catch statement can contain both the specific exception and the user-filtered clauses.","pos":[1544,1632]},{"content":"The runtime tests the specific exception first.","pos":[1633,1680]},{"content":"If the specific exception succeeds, the runtime executes the user filter.","pos":[1681,1754]},{"content":"The generic filter can contain a reference to the variable declared in the class filter.","pos":[1755,1843]},{"content":"Note that the order of the two filter clauses cannot be reversed.","pos":[1844,1909]},{"pos":[1916,2091],"content":"The following Visual Basic example shows the specific exception <ph id=\"ph1\">`ClassLoadException`</ph> in the <bpt id=\"p1\">**</bpt>Catch<ept id=\"p1\">**</ept> statement as well as the user-filtered clause using the <bpt id=\"p2\">**</bpt>When<ept id=\"p2\">**</ept> keyword.","source":"The following Visual Basic example shows the specific exception `ClassLoadException` in the **Catch** statement as well as the user-filtered clause using the **When** keyword."},{"pos":[2236,2244],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2248,2270],"content":"<bpt id=\"p1\">[</bpt>Exceptions<ept id=\"p1\">](index.md)</ept>","source":"[Exceptions](index.md)"}]}