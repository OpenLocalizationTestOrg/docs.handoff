{"content":"---\ntitle: \"How to: Transform the Shape of an XML Tree (C#) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"CSharp\"\nms.assetid: 93c5d426-dea2-4709-a991-60204de42e8f\ncaps.latest.revision: 3\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n\n---\n# How to: Transform the Shape of an XML Tree (C#)\nThe *shape* of an XML document refers to its element names, attribute names, and the characteristics of its hierarchy.  \n  \n Sometimes you will have to change the shape of an XML document. For example, you might have to send an existing XML document to another system that requires different element and attribute names. You could go through the document, deleting and renaming elements as required, but using functional construction results in more readable and maintainable code. For more information about functional construction, see [Functional Construction (LINQ to XML) (C#)](../../../../csharp/programming-guide/concepts/linq/functional-construction-linq-to-xml.md).  \n  \n The first example changes the organization of the XML document. It moves complex elements from one location in the tree to another.  \n  \n The second example in this topic creates an XML document with a different shape than the source document. It changes the casing of the element names, renames some elements, and leaves some elements from the source tree out of the transformed tree.  \n  \n## Example  \n The following code changes the shape of an XML file using embedded query expressions.  \n  \n The source XML document in this example contains a `Customers` element under the `Root` element that contains all customers. It also contains an `Orders` element under the `Root` element that contains all orders. This example creates a new XML tree in which the orders for each customer are contained in an `Orders` element within the `Customer` element. The original document also contains a `CustomerID` element in the `Order` element; this element will be removed from the re-shaped document.  \n  \n This example uses the following XML document: [Sample XML File: Customers and Orders (LINQ to XML)](../../../../csharp/programming-guide/concepts/linq/sample-xml-file-customers-and-orders-linq-to-xml-2.md).  \n  \n```csharp  \nXElement co = XElement.Load(\"CustomersOrders.xml\");  \nXElement newCustOrd =  \n    new XElement(\"Root\",  \n        from cust in co.Element(\"Customers\").Elements(\"Customer\")  \n        select new XElement(\"Customer\",  \n            cust.Attributes(),  \n            cust.Elements(),  \n            new XElement(\"Orders\",  \n                from ord in co.Element(\"Orders\").Elements(\"Order\")  \n                where (string)ord.Element(\"CustomerID\") == (string)cust.Attribute(\"CustomerID\")  \n                select new XElement(\"Order\",  \n                    ord.Attributes(),  \n                    ord.Element(\"EmployeeID\"),  \n                    ord.Element(\"OrderDate\"),  \n                    ord.Element(\"RequiredDate\"),  \n                    ord.Element(\"ShipInfo\")  \n                )  \n            )  \n        )  \n    );  \nConsole.WriteLine(newCustOrd);  \n```  \n  \n This code produces the following output:  \n  \n```xml  \n<Root>  \n  <Customer CustomerID=\"GREAL\">  \n    <CompanyName>Great Lakes Food Market</CompanyName>  \n    <ContactName>Howard Snyder</ContactName>  \n    <ContactTitle>Marketing Manager</ContactTitle>  \n    <Phone>(503) 555-7555</Phone>  \n    <FullAddress>  \n      <Address>2732 Baker Blvd.</Address>  \n      <City>Eugene</City>  \n      <Region>OR</Region>  \n      <PostalCode>97403</PostalCode>  \n      <Country>USA</Country>  \n    </FullAddress>  \n    <Orders />  \n  </Customer>  \n  <Customer CustomerID=\"HUNGC\">  \n    <CompanyName>Hungry Coyote Import Store</CompanyName>  \n    <ContactName>Yoshi Latimer</ContactName>  \n    <ContactTitle>Sales Representative</ContactTitle>  \n    <Phone>(503) 555-6874</Phone>  \n    <Fax>(503) 555-2376</Fax>  \n    <FullAddress>  \n      <Address>City Center Plaza 516 Main St.</Address>  \n      <City>Elgin</City>  \n      <Region>OR</Region>  \n      <PostalCode>97827</PostalCode>  \n      <Country>USA</Country>  \n    </FullAddress>  \n    <Orders />  \n  </Customer>  \n  . . .  \n```  \n  \n## Example  \n This example renames some elements and converts some attributes to elements.  \n  \n The code calls `ConvertAddress`, which returns a list of <xref:System.Xml.Linq.XElement> objects. The argument to the method is a query that determines the `Address` complex element where the `Type` attribute has a value of `\"Shipping\"`.  \n  \n This example uses the following XML document: [Sample XML File: Typical Purchase Order (LINQ to XML)](../../../../csharp/programming-guide/concepts/linq/sample-xml-file-typical-purchase-order-linq-to-xml-1.md).  \n  \n```csharp  \nstatic IEnumerable<XElement> ConvertAddress(XElement add)  \n{  \n    List<XElement> fragment = new List<XElement>() {  \n        new XElement(\"NAME\", (string)add.Element(\"Name\")),  \n        new XElement(\"STREET\", (string)add.Element(\"Street\")),  \n        new XElement(\"CITY\", (string)add.Element(\"City\")),  \n        new XElement(\"ST\", (string)add.Element(\"State\")),  \n        new XElement(\"POSTALCODE\", (string)add.Element(\"Zip\")),  \n        new XElement(\"COUNTRY\", (string)add.Element(\"Country\"))  \n    };  \n    return fragment;  \n}  \n  \nstatic void Main(string[] args)  \n{  \n    XElement po = XElement.Load(\"PurchaseOrder.xml\");  \n    XElement newPo = new XElement(\"PO\",  \n        new XElement(\"ID\", (string)po.Attribute(\"PurchaseOrderNumber\")),  \n        new XElement(\"DATE\", (DateTime)po.Attribute(\"OrderDate\")),  \n        ConvertAddress(  \n            (from el in po.Elements(\"Address\")  \n            where (string)el.Attribute(\"Type\") == \"Shipping\"  \n            select el)  \n            .First()  \n        )  \n    );  \n    Console.WriteLine(newPo);  \n}  \n```  \n  \n This code produces the following output:  \n  \n```xml  \n<PO>  \n  <ID>99503</ID>  \n  <DATE>1999-10-20T00:00:00</DATE>  \n  <NAME>Ellen Adams</NAME>  \n  <STREET>123 Maple Street</STREET>  \n  <CITY>Mill Valley</CITY>  \n  <ST>CA</ST>  \n  <POSTALCODE>10999</POSTALCODE>  \n  <COUNTRY>USA</COUNTRY>  \n</PO>  \n```  \n  \n## See Also  \n [Projections and Transformations (LINQ to XML) (C#)](../../../../csharp/programming-guide/concepts/linq/projections-and-transformations-linq-to-xml.md)","nodes":[{"pos":[12,76],"content":"How to: Transform the Shape of an XML Tree (C#) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Transform the Shape of an XML Tree (C#) | Microsoft Docs","pos":[0,64]}]},{"pos":[361,408],"content":"How to: Transform the Shape of an XML Tree (C#)","linkify":"How to: Transform the Shape of an XML Tree (C#)","nodes":[{"content":"How to: Transform the Shape of an XML Tree (C#)","pos":[0,47]}]},{"pos":[409,527],"content":"The <bpt id=\"p1\">*</bpt>shape<ept id=\"p1\">*</ept> of an XML document refers to its element names, attribute names, and the characteristics of its hierarchy.","source":"The *shape* of an XML document refers to its element names, attribute names, and the characteristics of its hierarchy."},{"content":"Sometimes you will have to change the shape of an XML document.","pos":[534,597]},{"content":"For example, you might have to send an existing XML document to another system that requires different element and attribute names.","pos":[598,729]},{"content":"You could go through the document, deleting and renaming elements as required, but using functional construction results in more readable and maintainable code.","pos":[730,890]},{"content":"For more information about functional construction, see <bpt id=\"p1\">[</bpt>Functional Construction (LINQ to XML) (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/functional-construction-linq-to-xml.md)</ept>.","pos":[891,1083],"source":" For more information about functional construction, see [Functional Construction (LINQ to XML) (C#)](../../../../csharp/programming-guide/concepts/linq/functional-construction-linq-to-xml.md)."},{"content":"The first example changes the organization of the XML document.","pos":[1090,1153]},{"content":"It moves complex elements from one location in the tree to another.","pos":[1154,1221]},{"content":"The second example in this topic creates an XML document with a different shape than the source document.","pos":[1228,1333]},{"content":"It changes the casing of the element names, renames some elements, and leaves some elements from the source tree out of the transformed tree.","pos":[1334,1475]},{"pos":[1484,1491],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code changes the shape of an XML file using embedded query expressions.","pos":[1495,1580]},{"content":"The source XML document in this example contains a <ph id=\"ph1\">`Customers`</ph> element under the <ph id=\"ph2\">`Root`</ph> element that contains all customers.","pos":[1587,1711],"source":"The source XML document in this example contains a `Customers` element under the `Root` element that contains all customers."},{"content":"It also contains an <ph id=\"ph1\">`Orders`</ph> element under the <ph id=\"ph2\">`Root`</ph> element that contains all orders.","pos":[1712,1799],"source":" It also contains an `Orders` element under the `Root` element that contains all orders."},{"content":"This example creates a new XML tree in which the orders for each customer are contained in an <ph id=\"ph1\">`Orders`</ph> element within the <ph id=\"ph2\">`Customer`</ph> element.","pos":[1800,1941],"source":" This example creates a new XML tree in which the orders for each customer are contained in an `Orders` element within the `Customer` element."},{"content":"The original document also contains a <ph id=\"ph1\">`CustomerID`</ph> element in the <ph id=\"ph2\">`Order`</ph> element; this element will be removed from the re-shaped document.","pos":[1942,2082],"source":" The original document also contains a `CustomerID` element in the `Order` element; this element will be removed from the re-shaped document."},{"pos":[2089,2295],"content":"This example uses the following XML document: <bpt id=\"p1\">[</bpt>Sample XML File: Customers and Orders (LINQ to XML)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/sample-xml-file-customers-and-orders-linq-to-xml-2.md)</ept>.","source":"This example uses the following XML document: [Sample XML File: Customers and Orders (LINQ to XML)](../../../../csharp/programming-guide/concepts/linq/sample-xml-file-customers-and-orders-linq-to-xml-2.md)."},{"content":"This code produces the following output:","pos":[3177,3217]},{"pos":[4256,4263],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example renames some elements and converts some attributes to elements.","pos":[4267,4343]},{"content":"The code calls <ph id=\"ph1\">`ConvertAddress`</ph>, which returns a list of <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> objects.","pos":[4350,4447],"source":"The code calls `ConvertAddress`, which returns a list of <xref:System.Xml.Linq.XElement> objects."},{"content":"The argument to the method is a query that determines the <ph id=\"ph1\">`Address`</ph> complex element where the <ph id=\"ph2\">`Type`</ph> attribute has a value of <ph id=\"ph3\">`\"Shipping\"`</ph>.","pos":[4448,4587],"source":" The argument to the method is a query that determines the `Address` complex element where the `Type` attribute has a value of `\"Shipping\"`."},{"pos":[4594,4804],"content":"This example uses the following XML document: <bpt id=\"p1\">[</bpt>Sample XML File: Typical Purchase Order (LINQ to XML)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/sample-xml-file-typical-purchase-order-linq-to-xml-1.md)</ept>.","source":"This example uses the following XML document: [Sample XML File: Typical Purchase Order (LINQ to XML)](../../../../csharp/programming-guide/concepts/linq/sample-xml-file-typical-purchase-order-linq-to-xml-1.md)."},{"content":"This code produces the following output:","pos":[5892,5932]},{"pos":[6204,6212],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[6216,6367],"content":"<bpt id=\"p1\">[</bpt>Projections and Transformations (LINQ to XML) (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/projections-and-transformations-linq-to-xml.md)</ept>","source":"[Projections and Transformations (LINQ to XML) (C#)](../../../../csharp/programming-guide/concepts/linq/projections-and-transformations-linq-to-xml.md)"}]}