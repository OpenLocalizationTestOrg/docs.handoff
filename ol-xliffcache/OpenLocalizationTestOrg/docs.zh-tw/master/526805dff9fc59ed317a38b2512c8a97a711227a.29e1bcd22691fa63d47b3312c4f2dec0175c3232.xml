{"content":"---\ntitle: \"XSLT Security Considerations\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nms.assetid: fea695be-617c-4977-9567-140e820436fc\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# XSLT Security Considerations\nThe XSLT language has a rich set of features that give you a great deal of power and flexibility. It includes many features that, while useful, could also be exploited by outside sources. In order to use XSLT safely, you must understand the types of security issues that arise when using XSLT, and the basic strategies that you can employ to mitigate these risks.  \n  \n## XSLT Extensions  \n Two popular XSLT extensions are style sheet scripting and extension objects. These extensions allow the XSLT processor to execute code.  \n  \n-   Extension objects add programming capabilities to XSL transformations.  \n  \n-   Scripts can be embedded in the style sheet using the `msxsl:script` extension element.  \n  \n### Extension Objects  \n Extension objects are added using the <xref:System.Xml.Xsl.XsltArgumentList.AddExtensionObject%2A> method. The FullTrust permission set is required to support extension objects. This ensures that elevation of permissions does not happen when extension object code is executed. Attempting to call the <xref:System.Xml.Xsl.XsltArgumentList.AddExtensionObject%2A> method without FullTrust permissions results in a security exception being thrown.  \n  \n### Style Sheet Scripts  \n Scripts can be embedded in a style sheet using the `msxsl:script` extension element. Script support is an optional feature on the <xref:System.Xml.Xsl.XslCompiledTransform> class that is disabled by default. Scripting can be enabled by setting the <xref:System.Xml.Xsl.XsltSettings.EnableScript%2A?displayProperty=nameWithType> property to `true` and passing the <xref:System.Xml.Xsl.XsltSettings> object to the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method.  \n  \n#### Guidelines  \n Enable scripting only when the style sheet comes from a trusted source. If you cannot verify the source of the style sheet, or if the style sheet does not come from a trusted source, pass in `null` for the XSLT settings argument.  \n  \n## External Resources  \n The XSLT language has features such as `xsl:import`, `xsl:include`, or the `document()` function, where the processor needs to resolve URI references. The <xref:System.Xml.XmlResolver> class is used to resolve external resources. External resources may need to be resolved in the following two cases:  \n  \n-   When compiling a style sheet, the <xref:System.Xml.XmlResolver> is used for `xsl:import` and `xsl:include` resolution.  \n  \n-   When executing the transformation, the <xref:System.Xml.XmlResolver> is used to resolve the `document()` function.  \n  \n    > [!NOTE]\n    >  The `document()` function is disabled by default on the <xref:System.Xml.Xsl.XslCompiledTransform> class. This feature can be enabled by setting the <xref:System.Xml.Xsl.XsltSettings.EnableDocumentFunction%2A?displayProperty=nameWithType> property to `true` and passing the <xref:System.Xml.Xsl.XsltSettings> object to the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method.  \n  \n The <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> and <xref:System.Xml.Xsl.XslCompiledTransform.Transform%2A> methods each include overloads that accept an <xref:System.Xml.XmlResolver> as one of its arguments. If an <xref:System.Xml.XmlResolver> is not specified, a default <xref:System.Xml.XmlUrlResolver> with no credentials is used.  \n  \n#### Guidelines  \n Enable the `document()` function only when the style sheet comes from a trusted source.  \n  \n The following list describes when you may want to specify an <xref:System.Xml.XmlResolver> object:  \n  \n-   If the XSLT process needs to access a network resource that requires authentication, you can use an <xref:System.Xml.XmlResolver> with the necessary credentials.  \n  \n-   If you want to restrict the resources that the XSLT process can access, you can use an <xref:System.Xml.XmlSecureResolver> with the correct permission set. Use the <xref:System.Xml.XmlSecureResolver> class if you need to open a resource that you do not control, or that is untrusted.  \n  \n-   If you want to customize behavior, you can implement your own <xref:System.Xml.XmlResolver> class and use it to resolve resources.  \n  \n-   If you want to ensure that no external resources are accessed, you can specify `null` for the <xref:System.Xml.XmlResolver> argument.  \n  \n## See also\n\n- [XSLT Transformations](../../../../docs/standard/data/xml/xslt-transformations.md)\n- [Resolving External Resources During XSLT Processing](../../../../docs/standard/data/xml/resolving-external-resources-during-xslt-processing.md)\n- [Code Access Security](../../../../docs/framework/misc/code-access-security.md)\n","nodes":[{"pos":[4,180],"embed":true,"restype":"x-metadata","content":"title: \"XSLT Security Considerations\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nms.assetid: fea695be-617c-4977-9567-140e820436fc\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"XSLT Security Considerations","nodes":[{"pos":[0,28],"content":"XSLT Security Considerations","nodes":[{"content":"XSLT Security Considerations","pos":[0,28]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[187,215],"content":"XSLT Security Considerations","linkify":"XSLT Security Considerations","nodes":[{"content":"XSLT Security Considerations","pos":[0,28]}]},{"content":"The XSLT language has a rich set of features that give you a great deal of power and flexibility.","pos":[216,313]},{"content":"It includes many features that, while useful, could also be exploited by outside sources.","pos":[314,403]},{"content":"In order to use XSLT safely, you must understand the types of security issues that arise when using XSLT, and the basic strategies that you can employ to mitigate these risks.","pos":[404,579]},{"pos":[588,603],"content":"XSLT Extensions","linkify":"XSLT Extensions","nodes":[{"content":"XSLT Extensions","pos":[0,15]}]},{"content":"Two popular XSLT extensions are style sheet scripting and extension objects.","pos":[607,683]},{"content":"These extensions allow the XSLT processor to execute code.","pos":[684,742]},{"content":"Extension objects add programming capabilities to XSL transformations.","pos":[752,822]},{"pos":[832,918],"content":"Scripts can be embedded in the style sheet using the <ph id=\"ph1\">`msxsl:script`</ph> extension element.","source":"Scripts can be embedded in the style sheet using the `msxsl:script` extension element."},{"pos":[928,945],"content":"Extension Objects","linkify":"Extension Objects","nodes":[{"content":"Extension Objects","pos":[0,17]}]},{"content":"Extension objects are added using the <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XsltArgumentList.AddExtensionObject%2A&gt;</ph> method.","pos":[949,1055],"source":"Extension objects are added using the <xref:System.Xml.Xsl.XsltArgumentList.AddExtensionObject%2A> method."},{"content":"The FullTrust permission set is required to support extension objects.","pos":[1056,1126]},{"content":"This ensures that elevation of permissions does not happen when extension object code is executed.","pos":[1127,1225]},{"content":"Attempting to call the <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XsltArgumentList.AddExtensionObject%2A&gt;</ph> method without FullTrust permissions results in a security exception being thrown.","pos":[1226,1392],"source":" Attempting to call the <xref:System.Xml.Xsl.XsltArgumentList.AddExtensionObject%2A> method without FullTrust permissions results in a security exception being thrown."},{"pos":[1402,1421],"content":"Style Sheet Scripts","linkify":"Style Sheet Scripts","nodes":[{"content":"Style Sheet Scripts","pos":[0,19]}]},{"content":"Scripts can be embedded in a style sheet using the <ph id=\"ph1\">`msxsl:script`</ph> extension element.","pos":[1425,1509],"source":"Scripts can be embedded in a style sheet using the `msxsl:script` extension element."},{"content":"Script support is an optional feature on the <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class that is disabled by default.","pos":[1510,1632],"source":" Script support is an optional feature on the <xref:System.Xml.Xsl.XslCompiledTransform> class that is disabled by default."},{"content":"Scripting can be enabled by setting the <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XsltSettings.EnableScript%2A?displayProperty=nameWithType&gt;</ph> property to <ph id=\"ph2\">`true`</ph> and passing the <ph id=\"ph3\">&lt;xref:System.Xml.Xsl.XsltSettings&gt;</ph> object to the <ph id=\"ph4\">&lt;xref:System.Xml.Xsl.XslCompiledTransform.Load%2A&gt;</ph> method.","pos":[1633,1895],"source":" Scripting can be enabled by setting the <xref:System.Xml.Xsl.XsltSettings.EnableScript%2A?displayProperty=nameWithType> property to `true` and passing the <xref:System.Xml.Xsl.XsltSettings> object to the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method."},{"pos":[1906,1916],"content":"Guidelines","linkify":"Guidelines","nodes":[{"content":"Guidelines","pos":[0,10]}]},{"content":"Enable scripting only when the style sheet comes from a trusted source.","pos":[1920,1991]},{"content":"If you cannot verify the source of the style sheet, or if the style sheet does not come from a trusted source, pass in <ph id=\"ph1\">`null`</ph> for the XSLT settings argument.","pos":[1992,2149],"source":" If you cannot verify the source of the style sheet, or if the style sheet does not come from a trusted source, pass in `null` for the XSLT settings argument."},{"pos":[2158,2176],"content":"External Resources","linkify":"External Resources","nodes":[{"content":"External Resources","pos":[0,18]}]},{"content":"The XSLT language has features such as <ph id=\"ph1\">`xsl:import`</ph>, <ph id=\"ph2\">`xsl:include`</ph>, or the <ph id=\"ph3\">`document()`</ph> function, where the processor needs to resolve URI references.","pos":[2180,2330],"source":"The XSLT language has features such as `xsl:import`, `xsl:include`, or the `document()` function, where the processor needs to resolve URI references."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlResolver&gt;</ph> class is used to resolve external resources.","pos":[2331,2409],"source":" The <xref:System.Xml.XmlResolver> class is used to resolve external resources."},{"content":"External resources may need to be resolved in the following two cases:","pos":[2410,2480]},{"pos":[2490,2608],"content":"When compiling a style sheet, the <ph id=\"ph1\">&lt;xref:System.Xml.XmlResolver&gt;</ph> is used for <ph id=\"ph2\">`xsl:import`</ph> and <ph id=\"ph3\">`xsl:include`</ph> resolution.","source":"When compiling a style sheet, the <xref:System.Xml.XmlResolver> is used for `xsl:import` and `xsl:include` resolution."},{"pos":[2618,2732],"content":"When executing the transformation, the <ph id=\"ph1\">&lt;xref:System.Xml.XmlResolver&gt;</ph> is used to resolve the <ph id=\"ph2\">`document()`</ph> function.","source":"When executing the transformation, the <xref:System.Xml.XmlResolver> is used to resolve the `document()` function."},{"pos":[2744,3140],"content":"[!NOTE]\nThe `document()` function is disabled by default on the <xref:System.Xml.Xsl.XslCompiledTransform> class. This feature can be enabled by setting the <xref:System.Xml.Xsl.XsltSettings.EnableDocumentFunction%2A?displayProperty=nameWithType> property to `true` and passing the <xref:System.Xml.Xsl.XsltSettings> object to the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method.","leadings":["","    >  "],"nodes":[{"content":"The `document()` function is disabled by default on the <xref:System.Xml.Xsl.XslCompiledTransform> class. This feature can be enabled by setting the <xref:System.Xml.Xsl.XsltSettings.EnableDocumentFunction%2A?displayProperty=nameWithType> property to `true` and passing the <xref:System.Xml.Xsl.XsltSettings> object to the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method.","pos":[8,389],"nodes":[{"content":"The <ph id=\"ph1\">`document()`</ph> function is disabled by default on the <ph id=\"ph2\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class.","pos":[0,105],"source":"The `document()` function is disabled by default on the <xref:System.Xml.Xsl.XslCompiledTransform> class."},{"content":"This feature can be enabled by setting the <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XsltSettings.EnableDocumentFunction%2A?displayProperty=nameWithType&gt;</ph> property to <ph id=\"ph2\">`true`</ph> and passing the <ph id=\"ph3\">&lt;xref:System.Xml.Xsl.XsltSettings&gt;</ph> object to the <ph id=\"ph4\">&lt;xref:System.Xml.Xsl.XslCompiledTransform.Load%2A&gt;</ph> method.","pos":[106,381],"source":" This feature can be enabled by setting the <xref:System.Xml.Xsl.XsltSettings.EnableDocumentFunction%2A?displayProperty=nameWithType> property to `true` and passing the <xref:System.Xml.Xsl.XsltSettings> object to the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method."}]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform.Load%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.Xsl.XslCompiledTransform.Transform%2A&gt;</ph> methods each include overloads that accept an <ph id=\"ph3\">&lt;xref:System.Xml.XmlResolver&gt;</ph> as one of its arguments.","pos":[3147,3362],"source":"The <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> and <xref:System.Xml.Xsl.XslCompiledTransform.Transform%2A> methods each include overloads that accept an <xref:System.Xml.XmlResolver> as one of its arguments."},{"content":"If an <ph id=\"ph1\">&lt;xref:System.Xml.XmlResolver&gt;</ph> is not specified, a default <ph id=\"ph2\">&lt;xref:System.Xml.XmlUrlResolver&gt;</ph> with no credentials is used.","pos":[3363,3488],"source":" If an <xref:System.Xml.XmlResolver> is not specified, a default <xref:System.Xml.XmlUrlResolver> with no credentials is used."},{"pos":[3499,3509],"content":"Guidelines","linkify":"Guidelines","nodes":[{"content":"Guidelines","pos":[0,10]}]},{"pos":[3513,3600],"content":"Enable the <ph id=\"ph1\">`document()`</ph> function only when the style sheet comes from a trusted source.","source":"Enable the `document()` function only when the style sheet comes from a trusted source."},{"pos":[3607,3705],"content":"The following list describes when you may want to specify an <ph id=\"ph1\">&lt;xref:System.Xml.XmlResolver&gt;</ph> object:","source":"The following list describes when you may want to specify an <xref:System.Xml.XmlResolver> object:"},{"pos":[3715,3876],"content":"If the XSLT process needs to access a network resource that requires authentication, you can use an <ph id=\"ph1\">&lt;xref:System.Xml.XmlResolver&gt;</ph> with the necessary credentials.","source":"If the XSLT process needs to access a network resource that requires authentication, you can use an <xref:System.Xml.XmlResolver> with the necessary credentials."},{"content":"If you want to restrict the resources that the XSLT process can access, you can use an <ph id=\"ph1\">&lt;xref:System.Xml.XmlSecureResolver&gt;</ph> with the correct permission set.","pos":[3886,4041],"source":"If you want to restrict the resources that the XSLT process can access, you can use an <xref:System.Xml.XmlSecureResolver> with the correct permission set."},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Xml.XmlSecureResolver&gt;</ph> class if you need to open a resource that you do not control, or that is untrusted.","pos":[4042,4169],"source":" Use the <xref:System.Xml.XmlSecureResolver> class if you need to open a resource that you do not control, or that is untrusted."},{"pos":[4179,4309],"content":"If you want to customize behavior, you can implement your own <ph id=\"ph1\">&lt;xref:System.Xml.XmlResolver&gt;</ph> class and use it to resolve resources.","source":"If you want to customize behavior, you can implement your own <xref:System.Xml.XmlResolver> class and use it to resolve resources."},{"pos":[4319,4452],"content":"If you want to ensure that no external resources are accessed, you can specify <ph id=\"ph1\">`null`</ph> for the <ph id=\"ph2\">&lt;xref:System.Xml.XmlResolver&gt;</ph> argument.","source":"If you want to ensure that no external resources are accessed, you can specify `null` for the <xref:System.Xml.XmlResolver> argument."},{"pos":[4461,4469],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4473,4555],"content":"<bpt id=\"p1\">[</bpt>XSLT Transformations<ept id=\"p1\">](../../../../docs/standard/data/xml/xslt-transformations.md)</ept>","source":"[XSLT Transformations](../../../../docs/standard/data/xml/xslt-transformations.md)"},{"pos":[4558,4702],"content":"<bpt id=\"p1\">[</bpt>Resolving External Resources During XSLT Processing<ept id=\"p1\">](../../../../docs/standard/data/xml/resolving-external-resources-during-xslt-processing.md)</ept>","source":"[Resolving External Resources During XSLT Processing](../../../../docs/standard/data/xml/resolving-external-resources-during-xslt-processing.md)"},{"pos":[4705,4784],"content":"<bpt id=\"p1\">[</bpt>Code Access Security<ept id=\"p1\">](../../../../docs/framework/misc/code-access-security.md)</ept>","source":"[Code Access Security](../../../../docs/framework/misc/code-access-security.md)"}]}