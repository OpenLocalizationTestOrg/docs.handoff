{"content":"---\ntitle: \"Using Statement (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.using\"\nhelpviewer_keywords: \n  - \"resource disposal\"\n  - \"Try...Catch...Finally statements, equivalent to Using statement\"\n  - \"resources [Visual Basic], disposing\"\n  - \"Using statement [Visual Basic]\"\nms.assetid: 665d1580-dd54-4e96-a9a9-6be2a68948f1\n---\n# Using Statement (Visual Basic)\nDeclares the beginning of a `Using` block and optionally acquires the system resources that the block controls.  \n  \n## Syntax  \n  \n```  \nUsing { resourcelist | resourceexpression }  \n    [ statements ]  \nEnd Using  \n```  \n  \n## Parts  \n  \n|Term|Definition|  \n|---|---|  \n|`resourcelist`|Required if you do not supply `resourceexpression`. List of one or more system resources that this `Using` block controls, separated by commas.|  \n|`resourceexpression`|Required if you do not supply `resourcelist`. Reference variable or expression referring to a system resource to be controlled by this `Using` block.|  \n|`statements`|Optional. Block of statements that the `Using` block runs.|  \n|`End Using`|Required. Terminates the definition of the `Using` block and disposes of all the resources that it controls.|  \n  \n Each resource in the `resourcelist` part has the following syntax and parts:  \n  \n `resourcename As New resourcetype [ ( [ arglist ] ) ]`  \n  \n -or-  \n  \n `resourcename As resourcetype = resourceexpression`  \n  \n## resourcelist Parts  \n  \n|Term|Definition|  \n|---|---|  \n|`resourcename`|Required. Reference variable that refers to a system resource that the `Using` block controls.|  \n|`New`|Required if the `Using` statement acquires the resource. If you have already acquired the resource, use the second syntax alternative.|  \n|`resourcetype`|Required. The class of the resource. The class must implement the <xref:System.IDisposable> interface.|  \n|`arglist`|Optional. List of arguments you are passing to the constructor to create an instance of `resourcetype`. See [Parameter List](../../../visual-basic/language-reference/statements/parameter-list.md).|  \n|`resourceexpression`|Required. Variable or expression referring to a system resource satisfying the requirements of `resourcetype`. If you use the second syntax alternative, you must acquire the resource before passing control to the `Using` statement.|  \n  \n## Remarks  \n Sometimes your code requires an unmanaged resource, such as a file handle, a COM wrapper, or a SQL connection. A `Using` block guarantees the disposal of one or more such resources when your code is finished with them. This makes them available for other code to use.  \n  \n Managed resources are disposed of by the .NET Framework garbage collector (GC) without any extra coding on your part. You do not need a `Using` block for managed resources. However, you can still use a `Using` block to force the disposal of a managed resource instead of waiting for the garbage collector.  \n  \n A `Using` block has three parts: acquisition, usage, and disposal.  \n  \n-   *Acquisition* means creating a variable and initializing it to refer to the system resource. The `Using` statement can acquire one or more resources, or you can acquire exactly one resource before entering the block and supply it to the `Using` statement. If you supply `resourceexpression`, you must acquire the resource before passing control to the `Using` statement.  \n  \n-   *Usage* means accessing the resources and performing actions with them. The statements between `Using` and `End Using` represent the usage of the resources.  \n  \n-   *Disposal* means calling the <xref:System.IDisposable.Dispose%2A> method on the object in `resourcename`. This allows the object to cleanly terminate its resources. The `End Using` statement disposes of the resources under the `Using` block's control.  \n  \n## Behavior  \n A `Using` block behaves like a `Try`...`Finally` construction in which the `Try` block uses the resources and the `Finally` block disposes of them. Because of this, the `Using` block guarantees disposal of the resources, no matter how you exit the block. This is true even in the case of an unhandled exception, except for a <xref:System.StackOverflowException>.  \n  \n The scope of every resource variable acquired by the `Using` statement is limited to the `Using` block.  \n  \n If you specify more than one system resource in the `Using` statement, the effect is the same as if you nested `Using` blocks one within another.  \n  \n If `resourcename` is `Nothing`, no call to <xref:System.IDisposable.Dispose%2A> is made, and no exception is thrown.  \n  \n## Structured Exception Handling Within a Using Block  \n If you need to handle an exception that might occur within the `Using` block, you can add a complete `Try`...`Finally` construction to it. If you need to handle the case where the `Using` statement is not successful in acquiring a resource, you can test to see if `resourcename` is `Nothing`.  \n  \n## Structured Exception Handling Instead of a Using Block  \n If you need finer control over the acquisition of the resources, or you need additional code in the `Finally` block, you can rewrite the `Using` block as a `Try`...`Finally` construction. The following example shows skeleton `Try` and `Using` constructions that are equivalent in the acquisition and disposal of `resource`.  \n  \n```vb  \nUsing resource As New resourceType   \n    ' Insert code to work with resource.  \nEnd Using  \n  \n' For the acquisition and disposal of resource, the following  \n' Try construction is equivalent to the Using block.  \nDim resource As New resourceType  \nTry   \n    ' Insert code to work with resource.  \nFinally   \n    If resource IsNot Nothing Then  \n        resource.Dispose()   \n    End If  \nEnd Try   \n```  \n  \n> [!NOTE]\n>  The code inside the `Using` block should not assign the object in `resourcename` to another variable. When you exit the `Using` block, the resource is disposed, and the other variable cannot access the resource to which it points.  \n  \n## Example  \n The following example creates a file that is named log.txt and writes two lines of text to the file. The example also reads that same file and displays the lines of text.  \n  \n Because the <xref:System.IO.TextWriter> and <xref:System.IO.TextReader> classes implement the <xref:System.IDisposable> interface, the code can use `Using` statements to ensure that the file is correctly closed after the write and read operations.  \n  \n [!code-vb[VbVbalrStatements#50](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class1.vb#50)]  \n  \n## See also\n\n- <xref:System.IDisposable>\n- [Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)\n- [How to: Dispose of a System Resource](../../../visual-basic/programming-guide/language-features/control-flow/how-to-dispose-of-a-system-resource.md)\n","nodes":[{"pos":[4,336],"embed":true,"restype":"x-metadata","content":"title: \"Using Statement (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.using\"\nhelpviewer_keywords: \n  - \"resource disposal\"\n  - \"Try...Catch...Finally statements, equivalent to Using statement\"\n  - \"resources [Visual Basic], disposing\"\n  - \"Using statement [Visual Basic]\"\nms.assetid: 665d1580-dd54-4e96-a9a9-6be2a68948f1","nodes":[{"content":"Using Statement (Visual Basic)","nodes":[{"pos":[0,30],"content":"Using Statement (Visual Basic)","nodes":[{"content":"Using Statement (Visual Basic)","pos":[0,30]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[343,373],"content":"Using Statement (Visual Basic)","linkify":"Using Statement (Visual Basic)","nodes":[{"content":"Using Statement (Visual Basic)","pos":[0,30]}]},{"pos":[374,485],"content":"Declares the beginning of a <ph id=\"ph1\">`Using`</ph> block and optionally acquires the system resources that the block controls.","source":"Declares the beginning of a `Using` block and optionally acquires the system resources that the block controls."},{"pos":[494,500],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[603,608],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"content":"Term","pos":[615,619]},{"content":"Definition","pos":[620,630]},{"content":"Required if you do not supply <ph id=\"ph1\">`resourceexpression`</ph>.","pos":[662,713],"source":"Required if you do not supply `resourceexpression`."},{"content":"List of one or more system resources that this <ph id=\"ph1\">`Using`</ph> block controls, separated by commas.","pos":[714,805],"source":" List of one or more system resources that this `Using` block controls, separated by commas."},{"content":"Required if you do not supply <ph id=\"ph1\">`resourcelist`</ph>.","pos":[831,876],"source":"Required if you do not supply `resourcelist`."},{"content":"Reference variable or expression referring to a system resource to be controlled by this <ph id=\"ph1\">`Using`</ph> block.","pos":[877,980],"source":" Reference variable or expression referring to a system resource to be controlled by this `Using` block."},{"content":"Optional.","pos":[998,1007]},{"content":"Block of statements that the <ph id=\"ph1\">`Using`</ph> block runs.","pos":[1008,1056],"source":" Block of statements that the `Using` block runs."},{"content":"Required.","pos":[1073,1082]},{"content":"Terminates the definition of the <ph id=\"ph1\">`Using`</ph> block and disposes of all the resources that it controls.","pos":[1083,1181],"source":" Terminates the definition of the `Using` block and disposes of all the resources that it controls."},{"pos":[1189,1265],"content":"Each resource in the <ph id=\"ph1\">`resourcelist`</ph> part has the following syntax and parts:","source":"Each resource in the `resourcelist` part has the following syntax and parts:"},{"content":"-or-","pos":[1333,1337]},{"pos":[1404,1422],"content":"resourcelist Parts","linkify":"resourcelist Parts","nodes":[{"content":"resourcelist Parts","pos":[0,18]}]},{"content":"Term","pos":[1429,1433]},{"content":"Definition","pos":[1434,1444]},{"content":"Required.","pos":[1476,1485]},{"content":"Reference variable that refers to a system resource that the <ph id=\"ph1\">`Using`</ph> block controls.","pos":[1486,1570],"source":" Reference variable that refers to a system resource that the `Using` block controls."},{"content":"Required if the <ph id=\"ph1\">`Using`</ph> statement acquires the resource.","pos":[1581,1637],"source":"Required if the `Using` statement acquires the resource."},{"content":"If you have already acquired the resource, use the second syntax alternative.","pos":[1638,1715]},{"content":"Required.","pos":[1735,1744]},{"content":"The class of the resource.","pos":[1745,1771]},{"content":"The class must implement the <ph id=\"ph1\">&lt;xref:System.IDisposable&gt;</ph> interface.","pos":[1772,1837],"source":" The class must implement the <xref:System.IDisposable> interface."},{"content":"Optional.","pos":[1852,1861]},{"content":"List of arguments you are passing to the constructor to create an instance of <ph id=\"ph1\">`resourcetype`</ph>.","pos":[1862,1955],"source":" List of arguments you are passing to the constructor to create an instance of `resourcetype`."},{"content":"See <bpt id=\"p1\">[</bpt>Parameter List<ept id=\"p1\">](../../../visual-basic/language-reference/statements/parameter-list.md)</ept>.","pos":[1956,2048],"source":" See [Parameter List](../../../visual-basic/language-reference/statements/parameter-list.md)."},{"content":"Required.","pos":[2074,2083]},{"content":"Variable or expression referring to a system resource satisfying the requirements of <ph id=\"ph1\">`resourcetype`</ph>.","pos":[2084,2184],"source":" Variable or expression referring to a system resource satisfying the requirements of `resourcetype`."},{"content":"If you use the second syntax alternative, you must acquire the resource before passing control to the <ph id=\"ph1\">`Using`</ph> statement.","pos":[2185,2305],"source":" If you use the second syntax alternative, you must acquire the resource before passing control to the `Using` statement."},{"pos":[2315,2322],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Sometimes your code requires an unmanaged resource, such as a file handle, a COM wrapper, or a SQL connection.","pos":[2326,2436]},{"content":"A <ph id=\"ph1\">`Using`</ph> block guarantees the disposal of one or more such resources when your code is finished with them.","pos":[2437,2544],"source":" A `Using` block guarantees the disposal of one or more such resources when your code is finished with them."},{"content":"This makes them available for other code to use.","pos":[2545,2593]},{"content":"Managed resources are disposed of by the .NET Framework garbage collector (GC) without any extra coding on your part.","pos":[2600,2717]},{"content":"You do not need a <ph id=\"ph1\">`Using`</ph> block for managed resources.","pos":[2718,2772],"source":" You do not need a `Using` block for managed resources."},{"content":"However, you can still use a <ph id=\"ph1\">`Using`</ph> block to force the disposal of a managed resource instead of waiting for the garbage collector.","pos":[2773,2905],"source":" However, you can still use a `Using` block to force the disposal of a managed resource instead of waiting for the garbage collector."},{"pos":[2912,2978],"content":"A <ph id=\"ph1\">`Using`</ph> block has three parts: acquisition, usage, and disposal.","source":"A `Using` block has three parts: acquisition, usage, and disposal."},{"content":"<bpt id=\"p1\">*</bpt>Acquisition<ept id=\"p1\">*</ept> means creating a variable and initializing it to refer to the system resource.","pos":[2988,3080],"source":"*Acquisition* means creating a variable and initializing it to refer to the system resource."},{"content":"The <ph id=\"ph1\">`Using`</ph> statement can acquire one or more resources, or you can acquire exactly one resource before entering the block and supply it to the <ph id=\"ph2\">`Using`</ph> statement.","pos":[3081,3243],"source":" The `Using` statement can acquire one or more resources, or you can acquire exactly one resource before entering the block and supply it to the `Using` statement."},{"content":"If you supply <ph id=\"ph1\">`resourceexpression`</ph>, you must acquire the resource before passing control to the <ph id=\"ph2\">`Using`</ph> statement.","pos":[3244,3358],"source":" If you supply `resourceexpression`, you must acquire the resource before passing control to the `Using` statement."},{"content":"<bpt id=\"p1\">*</bpt>Usage<ept id=\"p1\">*</ept> means accessing the resources and performing actions with them.","pos":[3368,3439],"source":"*Usage* means accessing the resources and performing actions with them."},{"content":"The statements between <ph id=\"ph1\">`Using`</ph> and <ph id=\"ph2\">`End Using`</ph> represent the usage of the resources.","pos":[3440,3524],"source":" The statements between `Using` and `End Using` represent the usage of the resources."},{"content":"<bpt id=\"p1\">*</bpt>Disposal<ept id=\"p1\">*</ept> means calling the <ph id=\"ph1\">&lt;xref:System.IDisposable.Dispose%2A&gt;</ph> method on the object in <ph id=\"ph2\">`resourcename`</ph>.","pos":[3534,3639],"source":"*Disposal* means calling the <xref:System.IDisposable.Dispose%2A> method on the object in `resourcename`."},{"content":"This allows the object to cleanly terminate its resources.","pos":[3640,3698]},{"content":"The <ph id=\"ph1\">`End Using`</ph> statement disposes of the resources under the <ph id=\"ph2\">`Using`</ph> block's control.","pos":[3699,3785],"source":" The `End Using` statement disposes of the resources under the `Using` block's control."},{"pos":[3794,3802],"content":"Behavior","linkify":"Behavior","nodes":[{"content":"Behavior","pos":[0,8]}]},{"content":"A <ph id=\"ph1\">`Using`</ph> block behaves like a <ph id=\"ph2\">`Try`</ph>...<ph id=\"ph3\">`Finally`</ph> construction in which the <ph id=\"ph4\">`Try`</ph> block uses the resources and the <ph id=\"ph5\">`Finally`</ph> block disposes of them.","pos":[3806,3953],"source":"A `Using` block behaves like a `Try`...`Finally` construction in which the `Try` block uses the resources and the `Finally` block disposes of them."},{"content":"Because of this, the <ph id=\"ph1\">`Using`</ph> block guarantees disposal of the resources, no matter how you exit the block.","pos":[3954,4060],"source":" Because of this, the `Using` block guarantees disposal of the resources, no matter how you exit the block."},{"content":"This is true even in the case of an unhandled exception, except for a <ph id=\"ph1\">&lt;xref:System.StackOverflowException&gt;</ph>.","pos":[4061,4168],"source":" This is true even in the case of an unhandled exception, except for a <xref:System.StackOverflowException>."},{"pos":[4175,4278],"content":"The scope of every resource variable acquired by the <ph id=\"ph1\">`Using`</ph> statement is limited to the <ph id=\"ph2\">`Using`</ph> block.","source":"The scope of every resource variable acquired by the `Using` statement is limited to the `Using` block."},{"pos":[4285,4430],"content":"If you specify more than one system resource in the <ph id=\"ph1\">`Using`</ph> statement, the effect is the same as if you nested <ph id=\"ph2\">`Using`</ph> blocks one within another.","source":"If you specify more than one system resource in the `Using` statement, the effect is the same as if you nested `Using` blocks one within another."},{"pos":[4437,4553],"content":"If <ph id=\"ph1\">`resourcename`</ph> is <ph id=\"ph2\">`Nothing`</ph>, no call to <ph id=\"ph3\">&lt;xref:System.IDisposable.Dispose%2A&gt;</ph> is made, and no exception is thrown.","source":"If `resourcename` is `Nothing`, no call to <xref:System.IDisposable.Dispose%2A> is made, and no exception is thrown."},{"pos":[4562,4612],"content":"Structured Exception Handling Within a Using Block","linkify":"Structured Exception Handling Within a Using Block","nodes":[{"content":"Structured Exception Handling Within a Using Block","pos":[0,50]}]},{"content":"If you need to handle an exception that might occur within the <ph id=\"ph1\">`Using`</ph> block, you can add a complete <ph id=\"ph2\">`Try`</ph>...<ph id=\"ph3\">`Finally`</ph> construction to it.","pos":[4616,4754],"source":"If you need to handle an exception that might occur within the `Using` block, you can add a complete `Try`...`Finally` construction to it."},{"content":"If you need to handle the case where the <ph id=\"ph1\">`Using`</ph> statement is not successful in acquiring a resource, you can test to see if <ph id=\"ph2\">`resourcename`</ph> is <ph id=\"ph3\">`Nothing`</ph>.","pos":[4755,4908],"source":" If you need to handle the case where the `Using` statement is not successful in acquiring a resource, you can test to see if `resourcename` is `Nothing`."},{"pos":[4917,4971],"content":"Structured Exception Handling Instead of a Using Block","linkify":"Structured Exception Handling Instead of a Using Block","nodes":[{"content":"Structured Exception Handling Instead of a Using Block","pos":[0,54]}]},{"content":"If you need finer control over the acquisition of the resources, or you need additional code in the <ph id=\"ph1\">`Finally`</ph> block, you can rewrite the <ph id=\"ph2\">`Using`</ph> block as a <ph id=\"ph3\">`Try`</ph>...<ph id=\"ph4\">`Finally`</ph> construction.","pos":[4975,5162],"source":"If you need finer control over the acquisition of the resources, or you need additional code in the `Finally` block, you can rewrite the `Using` block as a `Try`...`Finally` construction."},{"content":"The following example shows skeleton <ph id=\"ph1\">`Try`</ph> and <ph id=\"ph2\">`Using`</ph> constructions that are equivalent in the acquisition and disposal of <ph id=\"ph3\">`resource`</ph>.","pos":[5163,5298],"source":" The following example shows skeleton `Try` and `Using` constructions that are equivalent in the acquisition and disposal of `resource`."},{"pos":[5725,5966],"content":"[!NOTE]\n The code inside the `Using` block should not assign the object in `resourcename` to another variable. When you exit the `Using` block, the resource is disposed, and the other variable cannot access the resource to which it points.","leadings":["","> "],"nodes":[{"content":"The code inside the `Using` block should not assign the object in `resourcename` to another variable. When you exit the `Using` block, the resource is disposed, and the other variable cannot access the resource to which it points.","pos":[9,239],"nodes":[{"content":"The code inside the <ph id=\"ph1\">`Using`</ph> block should not assign the object in <ph id=\"ph2\">`resourcename`</ph> to another variable.","pos":[0,101],"source":"The code inside the `Using` block should not assign the object in `resourcename` to another variable."},{"content":"When you exit the <ph id=\"ph1\">`Using`</ph> block, the resource is disposed, and the other variable cannot access the resource to which it points.","pos":[102,230],"source":" When you exit the `Using` block, the resource is disposed, and the other variable cannot access the resource to which it points."}]}]},{"pos":[5975,5982],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example creates a file that is named log.txt and writes two lines of text to the file.","pos":[5986,6086]},{"content":"The example also reads that same file and displays the lines of text.","pos":[6087,6156]},{"pos":[6163,6410],"content":"Because the <ph id=\"ph1\">&lt;xref:System.IO.TextWriter&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.IO.TextReader&gt;</ph> classes implement the <ph id=\"ph3\">&lt;xref:System.IDisposable&gt;</ph> interface, the code can use <ph id=\"ph4\">`Using`</ph> statements to ensure that the file is correctly closed after the write and read operations.","source":"Because the <xref:System.IO.TextWriter> and <xref:System.IO.TextReader> classes implement the <xref:System.IDisposable> interface, the code can use `Using` statements to ensure that the file is correctly closed after the write and read operations."},{"pos":[6545,6553],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6585,6702],"content":"<bpt id=\"p1\">[</bpt>Try...Catch...Finally Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)</ept>","source":"[Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)"},{"pos":[6705,6854],"content":"<bpt id=\"p1\">[</bpt>How to: Dispose of a System Resource<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/control-flow/how-to-dispose-of-a-system-resource.md)</ept>","source":"[How to: Dispose of a System Resource](../../../visual-basic/programming-guide/language-features/control-flow/how-to-dispose-of-a-system-resource.md)"}]}