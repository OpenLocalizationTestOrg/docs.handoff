{"content":"---\ntitle: \"One-Way\"\nms.date: \"03/30/2017\"\nms.assetid: 74e3e03d-cd15-4191-a6a5-1efa2dcb9e73\n---\n# One-Way\nThis sample demonstrates a service contact with one-way service operations. The client does not wait for service operations to complete as is the case with two-way service operations. This sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md) and uses the `wsHttpBinding` binding. The service in this sample is a self-hosted console application to enable you to observe the service that receives and processes requests. The client is also a console application.  \n  \n> [!NOTE]\n>  The setup procedure and build instructions for this sample are located at the end of this topic.  \n  \n To create a one-way service contract, define your service contract, apply the <xref:System.ServiceModel.OperationContractAttribute> class to each operation, and set <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A> to `true` as shown in the following sample code:  \n  \n```csharp\n[ServiceContract(Namespace=\"http://Microsoft.ServiceModel.Samples\")]  \npublic interface IOneWayCalculator  \n{  \n    [OperationContract(IsOneWay=true)]  \n    void Add(double n1, double n2);  \n    [OperationContract(IsOneWay = true)]  \n    void Subtract(double n1, double n2);  \n    [OperationContract(IsOneWay = true)]  \n    void Multiply(double n1, double n2);  \n    [OperationContract(IsOneWay = true)]  \n    void Divide(double n1, double n2);  \n}  \n```  \n  \n To demonstrate that the client does not wait for the service operations to complete, the service code in this sample implements a five-second delay, as shown in the following sample code:  \n  \n```csharp\n// This service class implements the service contract.  \n// This code writes output to the console window.  \n [ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Multiple,  \n    InstanceContextMode = InstanceContextMode.PerCall)]  \npublic class CalculatorService : IOneWayCalculator  \n{  \n    public void Add(double n1, double n2)  \n    {  \n        Console.WriteLine(\"Received Add({0},{1}) - sleeping\", n1, n2);  \n        System.Threading.Thread.Sleep(1000 * 5);  \n        double result = n1 + n2;  \n        Console.WriteLine(\"Processing Add({0},{1}) - result: {2}\", n1, n2, result);  \n    }  \n    ...  \n}  \n```  \n  \n When the client calls the service, the call returns without waiting for the service operation to complete.  \n  \n When you run the sample, the client and service activities are displayed in both the service and client console windows. You can see the service receive messages from the client. Press ENTER in each console window to shut down both the service and the client.  \n  \n The client finishes ahead of the service, demonstrating that a client does not wait for one-way service operations to complete. The client output is as follows:  \n  \n```console  \nAdd(100,15.99)  \nSubtract(145,76.54)  \nMultiply(9,81.25)  \nDivide(22,7)  \n  \nPress <ENTER> to terminate client.  \n```  \n  \n The following service output is shown:  \n  \n```console  \nThe service is ready.  \nPress <ENTER> to terminate service.  \n  \nReceived Add(100,15.99) - sleeping  \nReceived Subtract(145,76.54) - sleeping  \nReceived Multiply(9,81.25) - sleeping  \nReceived Divide(22,7) - sleeping  \nProcessing Add(100,15.99) - result: 115.99  \nProcessing Subtract(145,76.54) - result: 68.46  \nProcessing Multiply(9,81.25) - result: 731.25  \nProcessing Divide(22,7) - result: 3.14285714285714  \n```  \n  \n> [!NOTE]\n>  HTTP is, by definition, a request/response protocol; when a request is made, a response is returned. This is true even for a one-way service operation that is exposed over HTTP. When the operation is called, the service returns an HTTP status code of 202 before the service operation has executed. This status code means that the request has been accepted for processing, but the processing has not yet been completed. The client that called the operation blocks until it receives the 202 response from the service. This can cause some unexpected behavior when multiple one-way messages are sent using a binding that is configured to use sessions. The `wsHttpBinding` binding used in this sample is configured to use sessions by default to establish a security context. By default, messages in a session are guaranteed to arrive in the order in which they are sent. Because of this, when the second message in a session is sent, it is not processed until the first message has been processed. The result of this is that the client does not receive the 202 response for a message until the processing of the previous message has been completed. The client therefore appears to block on each subsequent operation call. To avoid this behavior, this sample configures the runtime to dispatch messages concurrently to distinct instances for processing. The sample sets <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> to `PerCall` so that each message can be processed by a different instance. <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> is set to `Multiple` to allow more than one thread to dispatch messages at a time.  \n  \n### To set up, build, and run the sample  \n  \n1.  Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md).  \n  \n2.  To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md).  \n  \n3.  To run the sample in a single- or cross-machine configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md).  \n  \n> [!NOTE]\n>  Run the service before you run the client and shut down the client before shutting down the service. This avoids a client exception when the client cannot close the security session cleanly because the service is gone.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\Contract\\Service\\Oneway`  \n","nodes":[{"pos":[4,91],"embed":true,"restype":"x-metadata","content":"title: \"One-Way\"\nms.date: \"03/30/2017\"\nms.assetid: 74e3e03d-cd15-4191-a6a5-1efa2dcb9e73","nodes":[{"content":"One-Way","nodes":[{"pos":[0,7],"content":"One-Way","nodes":[{"content":"One-Way","pos":[0,7]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[98,105],"content":"One-Way","linkify":"One-Way","nodes":[{"content":"One-Way","pos":[0,7]}]},{"content":"This sample demonstrates a service contact with one-way service operations.","pos":[106,181]},{"content":"The client does not wait for service operations to complete as is the case with two-way service operations.","pos":[182,289]},{"content":"This sample is based on the <bpt id=\"p1\">[</bpt>Getting Started<ept id=\"p1\">](../../../../docs/framework/wcf/samples/getting-started-sample.md)</ept> and uses the <ph id=\"ph1\">`wsHttpBinding`</ph> binding.","pos":[290,439],"source":" This sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md) and uses the `wsHttpBinding` binding."},{"content":"The service in this sample is a self-hosted console application to enable you to observe the service that receives and processes requests.","pos":[440,578]},{"content":"The client is also a console application.","pos":[579,620]},{"pos":[628,735],"content":"[!NOTE]\n The setup procedure and build instructions for this sample are located at the end of this topic.","leadings":["","> "],"nodes":[{"content":"The setup procedure and build instructions for this sample are located at the end of this topic.","pos":[9,105]}]},{"pos":[742,1021],"content":"To create a one-way service contract, define your service contract, apply the <ph id=\"ph1\">&lt;xref:System.ServiceModel.OperationContractAttribute&gt;</ph> class to each operation, and set <ph id=\"ph2\">&lt;xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A&gt;</ph> to <ph id=\"ph3\">`true`</ph> as shown in the following sample code:","source":"To create a one-way service contract, define your service contract, apply the <xref:System.ServiceModel.OperationContractAttribute> class to each operation, and set <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A> to `true` as shown in the following sample code:"},{"content":"To demonstrate that the client does not wait for the service operations to complete, the service code in this sample implements a five-second delay, as shown in the following sample code:","pos":[1498,1685]},{"content":"When the client calls the service, the call returns without waiting for the service operation to complete.","pos":[2318,2424]},{"content":"When you run the sample, the client and service activities are displayed in both the service and client console windows.","pos":[2431,2551]},{"content":"You can see the service receive messages from the client.","pos":[2552,2609]},{"content":"Press ENTER in each console window to shut down both the service and the client.","pos":[2610,2690]},{"content":"The client finishes ahead of the service, demonstrating that a client does not wait for one-way service operations to complete.","pos":[2697,2824]},{"content":"The client output is as follows:","pos":[2825,2857]},{"content":"The following service output is shown:","pos":[3000,3038]},{"pos":[3482,5161],"content":"[!NOTE]\n HTTP is, by definition, a request/response protocol; when a request is made, a response is returned. This is true even for a one-way service operation that is exposed over HTTP. When the operation is called, the service returns an HTTP status code of 202 before the service operation has executed. This status code means that the request has been accepted for processing, but the processing has not yet been completed. The client that called the operation blocks until it receives the 202 response from the service. This can cause some unexpected behavior when multiple one-way messages are sent using a binding that is configured to use sessions. The `wsHttpBinding` binding used in this sample is configured to use sessions by default to establish a security context. By default, messages in a session are guaranteed to arrive in the order in which they are sent. Because of this, when the second message in a session is sent, it is not processed until the first message has been processed. The result of this is that the client does not receive the 202 response for a message until the processing of the previous message has been completed. The client therefore appears to block on each subsequent operation call. To avoid this behavior, this sample configures the runtime to dispatch messages concurrently to distinct instances for processing. The sample sets <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> to `PerCall` so that each message can be processed by a different instance. <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> is set to `Multiple` to allow more than one thread to dispatch messages at a time.","leadings":["","> "],"nodes":[{"content":"HTTP is, by definition, a request/response protocol; when a request is made, a response is returned. This is true even for a one-way service operation that is exposed over HTTP. When the operation is called, the service returns an HTTP status code of 202 before the service operation has executed. This status code means that the request has been accepted for processing, but the processing has not yet been completed. The client that called the operation blocks until it receives the 202 response from the service. This can cause some unexpected behavior when multiple one-way messages are sent using a binding that is configured to use sessions. The `wsHttpBinding` binding used in this sample is configured to use sessions by default to establish a security context. By default, messages in a session are guaranteed to arrive in the order in which they are sent. Because of this, when the second message in a session is sent, it is not processed until the first message has been processed. The result of this is that the client does not receive the 202 response for a message until the processing of the previous message has been completed. The client therefore appears to block on each subsequent operation call. To avoid this behavior, this sample configures the runtime to dispatch messages concurrently to distinct instances for processing. The sample sets <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> to `PerCall` so that each message can be processed by a different instance. <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> is set to `Multiple` to allow more than one thread to dispatch messages at a time.","pos":[9,1677],"nodes":[{"content":"HTTP is, by definition, a request/response protocol; when a request is made, a response is returned.","pos":[0,100]},{"content":"This is true even for a one-way service operation that is exposed over HTTP.","pos":[101,177]},{"content":"When the operation is called, the service returns an HTTP status code of 202 before the service operation has executed.","pos":[178,297]},{"content":"This status code means that the request has been accepted for processing, but the processing has not yet been completed.","pos":[298,418]},{"content":"The client that called the operation blocks until it receives the 202 response from the service.","pos":[419,515]},{"content":"This can cause some unexpected behavior when multiple one-way messages are sent using a binding that is configured to use sessions.","pos":[516,647]},{"content":"The <ph id=\"ph1\">`wsHttpBinding`</ph> binding used in this sample is configured to use sessions by default to establish a security context.","pos":[648,769],"source":" The `wsHttpBinding` binding used in this sample is configured to use sessions by default to establish a security context."},{"content":"By default, messages in a session are guaranteed to arrive in the order in which they are sent.","pos":[770,865]},{"content":"Because of this, when the second message in a session is sent, it is not processed until the first message has been processed.","pos":[866,992]},{"content":"The result of this is that the client does not receive the 202 response for a message until the processing of the previous message has been completed.","pos":[993,1143]},{"content":"The client therefore appears to block on each subsequent operation call.","pos":[1144,1216]},{"content":"To avoid this behavior, this sample configures the runtime to dispatch messages concurrently to distinct instances for processing.","pos":[1217,1347]},{"content":"The sample sets <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A&gt;</ph> to <ph id=\"ph2\">`PerCall`</ph> so that each message can be processed by a different instance.","pos":[1348,1514],"source":" The sample sets <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> to `PerCall` so that each message can be processed by a different instance."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A&gt;</ph> is set to <ph id=\"ph2\">`Multiple`</ph> to allow more than one thread to dispatch messages at a time.","pos":[1515,1668],"source":"<xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> is set to `Multiple` to allow more than one thread to dispatch messages at a time."}]}]},{"pos":[5171,5207],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"pos":[5217,5416],"content":"Ensure that you have performed the <bpt id=\"p1\">[</bpt>One-Time Setup Procedure for the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)</ept>.","source":"Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)."},{"pos":[5426,5635],"content":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in <bpt id=\"p1\">[</bpt>Building the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/building-the-samples.md)</ept>.","source":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md)."},{"pos":[5645,5853],"content":"To run the sample in a single- or cross-machine configuration, follow the instructions in <bpt id=\"p1\">[</bpt>Running the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/running-the-samples.md)</ept>.","source":"To run the sample in a single- or cross-machine configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md)."},{"pos":[5861,6090],"content":"[!NOTE]\n Run the service before you run the client and shut down the client before shutting down the service. This avoids a client exception when the client cannot close the security session cleanly because the service is gone.","leadings":["","> "],"nodes":[{"content":"Run the service before you run the client and shut down the client before shutting down the service. This avoids a client exception when the client cannot close the security session cleanly because the service is gone.","pos":[9,227],"nodes":[{"content":"Run the service before you run the client and shut down the client before shutting down the service.","pos":[0,100]},{"content":"This avoids a client exception when the client cannot close the security session cleanly because the service is gone.","pos":[101,218]}]}]},{"pos":[6098,6230],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[14,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[6284,6594],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[6595,6645]}]}