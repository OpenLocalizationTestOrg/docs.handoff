{"content":"---\ntitle: \"How to: Verify that Strings Are in Valid Email Format | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"regular expressions, examples\"\n  - \"user input, examples\"\n  - \"Regex.IsMatch method\"\n  - \"regular expressions [.NET Framework], examples\"\n  - \"examples [Visual Basic], strings\"\n  - \"IsValidEmail\"\n  - \"validation, e-mail strings\"\n  - \"input, checking\"\n  - \"strings [.NET Framework], examples [Visual Basic]\"\n  - \"e-mail [.NET Framework], validating\"\n  - \"IsMatch method\"\nms.assetid: 7536af08-4e86-4953-98a1-a8298623df92\ncaps.latest.revision: 30\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# How to: Verify that Strings Are in Valid Email Format\nThe following example uses a regular expression to verify that a string is in valid email format.  \n  \n## Example  \n The example defines an `IsValidEmail` method, which returns `true` if the string contains a valid email address and `false` if it does not, but takes no other action.  \n  \n To verify that the email address is valid, the `IsValidEmail` method calls the <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%29?displayProperty=fullName> method with the `(@)(.+)$` regular expression pattern to separate the domain name from the email address. The third parameter is a <xref:System.Text.RegularExpressions.MatchEvaluator> delegate that represents the method that processes and replaces the matched text. The regular expression pattern is interpreted as follows.  \n  \n|Pattern|Description|  \n|-------------|-----------------|  \n|`(@)`|Match the @ character. This is the first capturing group.|  \n|`(.+)`|Match one or more occurrences of any character. This is the second capturing group.|  \n|`$`|End the match at the end of the string.|  \n  \n The domain name along with the @ character is passed to the `DomainMapper` method, which uses the <xref:System.Globalization.IdnMapping> class to translate Unicode characters that are outside the US-ASCII character range to Punycode. The method also sets the `invalid` flag to `True` if the <xref:System.Globalization.IdnMapping.GetAscii%2A?displayProperty=fullName> method detects any invalid characters in the domain name. The method returns the Punycode domain name preceded by the @ symbol to the `IsValidEmail` method.  \n  \n The `IsValidEmail` method then calls the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29?displayProperty=fullName> method to verify that the address conforms to a regular expression pattern.  \n  \n Note that the `IsValidEmail` method does not perform authentication to validate the email address. It merely determines whether its format is valid for an email address. In addition, the `IsValidEmail` method does not verify that the top-level domain name is a valid domain name listed at the [IANA Root Zone Database](https://www.iana.org/domains/root/db), which would require a look-up operation. Instead, the regular expression merely verifies that the top-level domain name consists of between two and twenty-four ASCII characters, with alphanumeric first and last characters and the remaining characters being either alphanumeric or a hyphen (-).  \n  \n [!code-csharp[RegularExpressions.Examples.Email#7](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Examples.Email/cs/example4.cs#7)]\n [!code-vb[RegularExpressions.Examples.Email#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Examples.Email/vb/example4.vb#7)]  \n  \n In this example, the regular expression pattern `^(?(\")(\".+?(?<!\\\\)\"@)|(([0-9a-z]((\\.(?!\\.))|[-!#\\$%&'\\*\\+/=\\?\\^`{}|~\\w])*)(?<=[0-9a-z])@))(?([)([(\\d{1,3}.){3}\\d{1,3}])|(([0-9a-z][-\\w]*[0-9a-z]*.)+[a-z0-9][-a-z0-9]{0,22}[a-z0-9]))$` is interpreted as shown in the following table. Note that the regular expression is compiled using the <xref:System.Text.RegularExpressions.RegexOptions?displayProperty=fullName> flag.  \n  \n|Pattern|Description|  \n|-------------|-----------------|  \n|`^`|Begin the match at the start of the string.|  \n|`(?(\")`|Determine whether the first character is a quotation mark. `(?(\")` is the beginning of an alternation construct.|  \n|`(?(\"\")(\"\".+?(?<!\\\\)\"\"@)`|If the first character is a quotation mark, match a beginning quotation mark followed by at least one occurrence of any character, followed by an ending quotation mark. The ending quotation mark must not be preceded by a backslash character (\\\\). `(?<!` is the beginning of a zero-width negative lookbehind assertion. The string should conclude with an at sign (@).|  \n|`&#124;(([0-9a-z]`|If the first character is not a quotation mark, match any alphabetic character from a to z or A to Z (the comparison is case insensitive), or any numeric character from 0 to 9.|  \n|`(\\.(?!\\.))`|If the next character is a period, match it. If it is not a period, look ahead to the next character and continue the match. `(?!\\.)` is a zero-width negative lookahead assertion that prevents two consecutive periods from appearing in the local part of an email address.|  \n|`&#124;[-!#\\$%&'\\*\\+/=\\?\\^`{}\\&#124;~\\w]`|If the next character is not a period, match any word character or one of the following characters: -!#$%'*+=?^`{}&#124;~.|  \n|`((\\.(?!\\.))&#124;[-!#\\$%'\\*\\+/=\\?\\^`{}\\&#124;~\\w])*`|Match the alternation pattern (a period followed by a non-period, or one of a number of characters) zero or more times.|  \n|`@`|Match the @ character.|  \n|`(?<=[0-9a-z])`|Continue the match if the character that precedes the @ character is A through Z, a through z, or 0 through 9. The `(?<=[0-9a-z])` construct defines a zero-width positive lookbehind assertion.|  \n|`(?(\\[)`|Check whether the character that follows @ is an opening bracket.|  \n|`(\\[(\\d{1,3}\\.){3}\\d{1,3}\\])`|If it is an opening bracket, match the opening bracket followed by an IP address (four sets of one to three digits, with each set separated by a period) and a closing bracket.|  \n|`&#124;(([0-9a-z][-\\w]*[0-9a-z]*\\.)+`|If the character that follows @ is not an opening bracket, match one alphanumeric character with a value of A-Z, a-z, or 0-9, followed by zero or more occurrences of a word character or a hyphen, followed by zero or one alphanumeric character with a value of A-Z, a-z, or 0-9, followed by a period. This pattern can be repeated one or more times, and must be followed by the top-level domain name.|  \n|`[a-z0-9][\\-a-z0-9]{0,22}[a-z0-9]))`|The top-level domain name must begin and end with an alphanumeric character (a-z, A-Z, and 0-9). It can also include from zero to 22 ASCII characters that are either alphanumeric or hyphens.|  \n|`$`|End the match at the end of the string.|  \n  \n> [!NOTE]\n>  Instead of using a regular expression to validate an email address, you can use the <xref:System.Net.Mail.MailAddress?displayProperty=fullName> class. To determine whether an email address is valid, pass the email address to the <xref:System.Net.Mail.MailAddress.%23ctor%28System.String%29?displayProperty=fullName> class constructor.  \n  \n## Compiling the Code  \n The `IsValidEmail` and `DomainMapper` methods can be included in a library of regular expression utility methods, or they can be included as private static or instance methods in the application class.  \n  \n To include them in a regular expression library, either copy and paste the code into a Visual Studio Class Library project, or copy and paste it into a text file and compile it from the command line with a command like the following (assuming that the name of the source code file is RegexUtilities.cs or RegexUtilities.vb:  \n  \n```csharp  \ncsc /t:library RegexUtilities.cs  \n```  \n  \n```vb  \nvbc /t:library RegexUtilities.vb  \n```  \n  \n You can also use the <xref:System.Text.RegularExpressions.Regex.CompileToAssembly%2A?displayProperty=fullName> method to include this regular expression in a regular expression library.  \n  \n If they are used in a regular expression library, you can call them by using code such as the following:  \n  \n [!code-csharp[RegularExpressions.Examples.Email#8](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Examples.Email/cs/example4.cs#8)]\n [!code-vb[RegularExpressions.Examples.Email#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Examples.Email/vb/example4.vb#8)]  \n  \n Assuming you've created a class library named RegexUtilities.dll that includes your email validation regular expression, you can compile this example in either of the following ways:  \n  \n-   In Visual Studio, by creating a Console Application and adding a reference to RegexUtilities.dll to your project.  \n  \n-   From the command line, by copying and pasting the source code into a text file and compiling it with a command like the following (assuming that the name of the source code file is Example.cs or Example.vb:  \n  \n    ```csharp  \n    csc Example.cs /r:RegexUtilities.dll  \n    ```  \n  \n    ```vb  \n    vbc Example.vb /r:RegexUtilities.dll  \n    ```  \n  \n## See Also  \n [.NET Framework Regular Expressions](../../../docs/standard/base-types/regular-expressions.md)","nodes":[{"pos":[4,764],"embed":true,"restype":"x-metadata","content":"title: \"How to: Verify that Strings Are in Valid Email Format | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"regular expressions, examples\"\n  - \"user input, examples\"\n  - \"Regex.IsMatch method\"\n  - \"regular expressions [.NET Framework], examples\"\n  - \"examples [Visual Basic], strings\"\n  - \"IsValidEmail\"\n  - \"validation, e-mail strings\"\n  - \"input, checking\"\n  - \"strings [.NET Framework], examples [Visual Basic]\"\n  - \"e-mail [.NET Framework], validating\"\n  - \"IsMatch method\"\nms.assetid: 7536af08-4e86-4953-98a1-a8298623df92\ncaps.latest.revision: 30\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"How to: Verify that Strings Are in Valid Email Format | Microsoft Docs","nodes":[{"pos":[0,70],"content":"How to: Verify that Strings Are in Valid Email Format | Microsoft Docs","nodes":[{"content":"How to: Verify that Strings Are in Valid Email Format | Microsoft Docs","pos":[0,70]}]}],"path":["title"]}],"yml":true},{"pos":[771,824],"content":"How to: Verify that Strings Are in Valid Email Format","linkify":"How to: Verify that Strings Are in Valid Email Format","nodes":[{"content":"How to: Verify that Strings Are in Valid Email Format","pos":[0,53]}]},{"content":"The following example uses a regular expression to verify that a string is in valid email format.","pos":[825,922]},{"pos":[931,938],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[942,1108],"content":"The example defines an <ph id=\"ph1\">`IsValidEmail`</ph> method, which returns <ph id=\"ph2\">`true`</ph> if the string contains a valid email address and <ph id=\"ph3\">`false`</ph> if it does not, but takes no other action.","source":"The example defines an `IsValidEmail` method, which returns `true` if the string contains a valid email address and `false` if it does not, but takes no other action."},{"content":"To verify that the email address is valid, the <ph id=\"ph1\">`IsValidEmail`</ph> method calls the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%29?displayProperty=fullName&gt;</ph> method with the <ph id=\"ph3\">`(@)(.+)$`</ph> regular expression pattern to separate the domain name from the email address.","pos":[1115,1459],"source":"To verify that the email address is valid, the `IsValidEmail` method calls the <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%29?displayProperty=fullName> method with the `(@)(.+)$` regular expression pattern to separate the domain name from the email address."},{"content":"The third parameter is a <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.MatchEvaluator&gt;</ph> delegate that represents the method that processes and replaces the matched text.","pos":[1460,1619],"source":" The third parameter is a <xref:System.Text.RegularExpressions.MatchEvaluator> delegate that represents the method that processes and replaces the matched text."},{"content":"The regular expression pattern is interpreted as follows.","pos":[1620,1677]},{"content":"Pattern","pos":[1684,1691]},{"content":"Description","pos":[1692,1703]},{"content":"Match the @ character.","pos":[1750,1772]},{"content":"This is the first capturing group.","pos":[1773,1807]},{"content":"Match one or more occurrences of any character.","pos":[1819,1866]},{"content":"This is the second capturing group.","pos":[1867,1902]},{"content":"End the match at the end of the string.","pos":[1911,1950]},{"content":"The domain name along with the @ character is passed to the <ph id=\"ph1\">`DomainMapper`</ph> method, which uses the <ph id=\"ph2\">&lt;xref:System.Globalization.IdnMapping&gt;</ph> class to translate Unicode characters that are outside the US-ASCII character range to Punycode.","pos":[1958,2191],"source":"The domain name along with the @ character is passed to the `DomainMapper` method, which uses the <xref:System.Globalization.IdnMapping> class to translate Unicode characters that are outside the US-ASCII character range to Punycode."},{"content":"The method also sets the <ph id=\"ph1\">`invalid`</ph> flag to <ph id=\"ph2\">`True`</ph> if the <ph id=\"ph3\">&lt;xref:System.Globalization.IdnMapping.GetAscii%2A?displayProperty=fullName&gt;</ph> method detects any invalid characters in the domain name.","pos":[2192,2382],"source":" The method also sets the `invalid` flag to `True` if the <xref:System.Globalization.IdnMapping.GetAscii%2A?displayProperty=fullName> method detects any invalid characters in the domain name."},{"content":"The method returns the Punycode domain name preceded by the @ symbol to the <ph id=\"ph1\">`IsValidEmail`</ph> method.","pos":[2383,2481],"source":" The method returns the Punycode domain name preceded by the @ symbol to the `IsValidEmail` method."},{"pos":[2488,2716],"content":"The <ph id=\"ph1\">`IsValidEmail`</ph> method then calls the <ph id=\"ph2\">&lt;xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29?displayProperty=fullName&gt;</ph> method to verify that the address conforms to a regular expression pattern.","source":"The `IsValidEmail` method then calls the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29?displayProperty=fullName> method to verify that the address conforms to a regular expression pattern."},{"content":"Note that the <ph id=\"ph1\">`IsValidEmail`</ph> method does not perform authentication to validate the email address.","pos":[2723,2821],"source":"Note that the `IsValidEmail` method does not perform authentication to validate the email address."},{"content":"It merely determines whether its format is valid for an email address.","pos":[2822,2892]},{"content":"In addition, the <ph id=\"ph1\">`IsValidEmail`</ph> method does not verify that the top-level domain name is a valid domain name listed at the <bpt id=\"p1\">[</bpt>IANA Root Zone Database<ept id=\"p1\">](https://www.iana.org/domains/root/db)</ept>, which would require a look-up operation.","pos":[2893,3121],"source":" In addition, the `IsValidEmail` method does not verify that the top-level domain name is a valid domain name listed at the [IANA Root Zone Database](https://www.iana.org/domains/root/db), which would require a look-up operation."},{"content":"Instead, the regular expression merely verifies that the top-level domain name consists of between two and twenty-four ASCII characters, with alphanumeric first and last characters and the remaining characters being either alphanumeric or a hyphen (-).","pos":[3122,3374]},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>RegularExpressions.Examples.Email#7<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Examples.Email/cs/example4.cs#7)</ept><ept id=\"p1\">]</ept>","pos":[3381,3533],"source":"[!code-csharp[RegularExpressions.Examples.Email#7](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Examples.Email/cs/example4.cs#7)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>RegularExpressions.Examples.Email#7<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Examples.Email/vb/example4.vb#7)</ept><ept id=\"p1\">]</ept>","pos":[3535,3688],"source":"[!code-vb[RegularExpressions.Examples.Email#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Examples.Email/vb/example4.vb#7)]"},{"content":"In this example, the regular expression pattern <ph id=\"ph1\">`^(?(\")(\".+?(?&lt;!\\\\)\"@)|(([0-9a-z]((\\.(?!\\.))|[-!#\\$%&amp;'\\*\\+/=\\?\\^`</ph>{}|~\\w])<bpt id=\"p1\">*</bpt>)(?&lt;=[0-9a-z])@))(?([)([(\\d{1,3}.){3}\\d{1,3}])|(([0-9a-z][-\\w]<ept id=\"p1\">*</ept>[0-9a-z]*.)+[a-z0-9][-a-z0-9]{0,22}[a-z0-9]))$` is interpreted as shown in the following table.","pos":[3695,3975],"source":"In this example, the regular expression pattern `^(?(\")(\".+?(?<!\\\\)\"@)|(([0-9a-z]((\\.(?!\\.))|[-!#\\$%&'\\*\\+/=\\?\\^`{}|~\\w])*)(?<=[0-9a-z])@))(?([)([(\\d{1,3}.){3}\\d{1,3}])|(([0-9a-z][-\\w]*[0-9a-z]*.)+[a-z0-9][-a-z0-9]{0,22}[a-z0-9]))$` is interpreted as shown in the following table."},{"content":"Note that the regular expression is compiled using the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.RegexOptions?displayProperty=fullName&gt;</ph> flag.","pos":[3976,4112],"source":" Note that the regular expression is compiled using the <xref:System.Text.RegularExpressions.RegexOptions?displayProperty=fullName> flag."},{"content":"Pattern","pos":[4119,4126]},{"content":"Description","pos":[4127,4138]},{"content":"Begin the match at the start of the string.","pos":[4183,4226]},{"content":"Determine whether the first character is a quotation mark.","pos":[4239,4297]},{"content":"<ph id=\"ph1\">`(?(\")`</ph> is the beginning of an alternation construct.","pos":[4298,4351],"source":"`(?(\")` is the beginning of an alternation construct."},{"content":"If the first character is a quotation mark, match a beginning quotation mark followed by at least one occurrence of any character, followed by an ending quotation mark.","pos":[4382,4550]},{"content":"The ending quotation mark must not be preceded by a backslash character (<ph id=\"ph1\">\\\\</ph>).","pos":[4551,4628],"source":" The ending quotation mark must not be preceded by a backslash character (\\\\)."},{"content":"<ph id=\"ph1\">`(?&lt;!`</ph> is the beginning of a zero-width negative lookbehind assertion.","pos":[4629,4699],"source":"`(?<!` is the beginning of a zero-width negative lookbehind assertion."},{"content":"The string should conclude with an at sign (@).","pos":[4700,4747]},{"content":"If the first character is not a quotation mark, match any alphabetic character from a to z or A to Z (the comparison is case insensitive), or any numeric character from 0 to 9.","pos":[4771,4947]},{"content":"If the next character is a period, match it.","pos":[4965,5009]},{"content":"If it is not a period, look ahead to the next character and continue the match.","pos":[5010,5089]},{"content":"<ph id=\"ph1\">`(?!\\.)`</ph> is a zero-width negative lookahead assertion that prevents two consecutive periods from appearing in the local part of an email address.","pos":[5090,5235],"source":"`(?!\\.)` is a zero-width negative lookahead assertion that prevents two consecutive periods from appearing in the local part of an email address."},{"pos":[5240,5281],"content":"<ph id=\"ph1\">`&amp;#124;[-!#\\$%&amp;'\\*\\+/=\\?\\^`</ph>{}<ph id=\"ph2\">\\&amp;</ph>#124;~\\w]`","source":"`&#124;[-!#\\$%&'\\*\\+/=\\?\\^`{}\\&#124;~\\w]`"},{"content":"If the next character is not a period, match any word character or one of the following characters: -!#$%'*+=?^`{}&amp;#124;~.","pos":[5282,5404],"source":"If the next character is not a period, match any word character or one of the following characters: -!#$%'*+=?^`{}&#124;~."},{"pos":[5409,5462],"content":"<ph id=\"ph1\">`((\\.(?!\\.))&amp;#124;[-!#\\$%'\\*\\+/=\\?\\^`</ph>{}<ph id=\"ph2\">\\&amp;</ph>#124;~\\w])*`","source":"`((\\.(?!\\.))&#124;[-!#\\$%'\\*\\+/=\\?\\^`{}\\&#124;~\\w])*`"},{"content":"Match the alternation pattern (a period followed by a non-period, or one of a number of characters) zero or more times.","pos":[5463,5582]},{"content":"Match the @ character.","pos":[5591,5613]},{"content":"Continue the match if the character that precedes the @ character is A through Z, a through z, or 0 through 9.","pos":[5634,5744]},{"content":"The <ph id=\"ph1\">`(?&lt;=[0-9a-z])`</ph> construct defines a zero-width positive lookbehind assertion.","pos":[5745,5826],"source":" The `(?<=[0-9a-z])` construct defines a zero-width positive lookbehind assertion."},{"content":"Check whether the character that follows @ is an opening bracket.","pos":[5840,5905]},{"content":"If it is an opening bracket, match the opening bracket followed by an IP address (four sets of one to three digits, with each set separated by a period) and a closing bracket.","pos":[5940,6115]},{"content":"If the character that follows @ is not an opening bracket, match one alphanumeric character with a value of A-Z, a-z, or 0-9, followed by zero or more occurrences of a word character or a hyphen, followed by zero or one alphanumeric character with a value of A-Z, a-z, or 0-9, followed by a period.","pos":[6158,6456]},{"content":"This pattern can be repeated one or more times, and must be followed by the top-level domain name.","pos":[6457,6555]},{"content":"The top-level domain name must begin and end with an alphanumeric character (a-z, A-Z, and 0-9).","pos":[6597,6693]},{"content":"It can also include from zero to 22 ASCII characters that are either alphanumeric or hyphens.","pos":[6694,6787]},{"content":"End the match at the end of the string.","pos":[6796,6835]},{"pos":[6844,7189],"content":"[!NOTE]\n Instead of using a regular expression to validate an email address, you can use the <xref:System.Net.Mail.MailAddress?displayProperty=fullName> class. To determine whether an email address is valid, pass the email address to the <xref:System.Net.Mail.MailAddress.%23ctor%28System.String%29?displayProperty=fullName> class constructor.","leadings":["","> "],"nodes":[{"content":"Instead of using a regular expression to validate an email address, you can use the <xref:System.Net.Mail.MailAddress?displayProperty=fullName> class. To determine whether an email address is valid, pass the email address to the <xref:System.Net.Mail.MailAddress.%23ctor%28System.String%29?displayProperty=fullName> class constructor.","pos":[9,343],"nodes":[{"content":"Instead of using a regular expression to validate an email address, you can use the <ph id=\"ph1\">&lt;xref:System.Net.Mail.MailAddress?displayProperty=fullName&gt;</ph> class.","pos":[0,150],"source":"Instead of using a regular expression to validate an email address, you can use the <xref:System.Net.Mail.MailAddress?displayProperty=fullName> class."},{"content":"To determine whether an email address is valid, pass the email address to the <ph id=\"ph1\">&lt;xref:System.Net.Mail.MailAddress.%23ctor%28System.String%29?displayProperty=fullName&gt;</ph> class constructor.","pos":[151,334],"source":" To determine whether an email address is valid, pass the email address to the <xref:System.Net.Mail.MailAddress.%23ctor%28System.String%29?displayProperty=fullName> class constructor."}]}]},{"pos":[7198,7216],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[7220,7421],"content":"The <ph id=\"ph1\">`IsValidEmail`</ph> and <ph id=\"ph2\">`DomainMapper`</ph> methods can be included in a library of regular expression utility methods, or they can be included as private static or instance methods in the application class.","source":"The `IsValidEmail` and `DomainMapper` methods can be included in a library of regular expression utility methods, or they can be included as private static or instance methods in the application class."},{"content":"To include them in a regular expression library, either copy and paste the code into a Visual Studio Class Library project, or copy and paste it into a text file and compile it from the command line with a command like the following (assuming that the name of the source code file is RegexUtilities.cs or RegexUtilities.vb:","pos":[7428,7751]},{"content":"You can also use the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.Regex.CompileToAssembly%2A?displayProperty=fullName&gt;</ph> method to include this regular expression in a regular expression library.","pos":[7866,8051],"source":"You can also use the <xref:System.Text.RegularExpressions.Regex.CompileToAssembly%2A?displayProperty=fullName> method to include this regular expression in a regular expression library."},{"content":"If they are used in a regular expression library, you can call them by using code such as the following:","pos":[8058,8162]},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>RegularExpressions.Examples.Email#8<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Examples.Email/cs/example4.cs#8)</ept><ept id=\"p1\">]</ept>","pos":[8169,8321],"source":"[!code-csharp[RegularExpressions.Examples.Email#8](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Examples.Email/cs/example4.cs#8)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>RegularExpressions.Examples.Email#8<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Examples.Email/vb/example4.vb#8)</ept><ept id=\"p1\">]</ept>","pos":[8323,8476],"source":"[!code-vb[RegularExpressions.Examples.Email#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Examples.Email/vb/example4.vb#8)]"},{"content":"Assuming you've created a class library named RegexUtilities.dll that includes your email validation regular expression, you can compile this example in either of the following ways:","pos":[8483,8665]},{"content":"In Visual Studio, by creating a Console Application and adding a reference to RegexUtilities.dll to your project.","pos":[8675,8788]},{"content":"From the command line, by copying and pasting the source code into a text file and compiling it with a command like the following (assuming that the name of the source code file is Example.cs or Example.vb:","pos":[8798,9004]},{"pos":[9153,9161],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[9165,9259],"content":"<bpt id=\"p1\">[</bpt>.NET Framework Regular Expressions<ept id=\"p1\">](../../../docs/standard/base-types/regular-expressions.md)</ept>","source":"[.NET Framework Regular Expressions](../../../docs/standard/base-types/regular-expressions.md)"}]}