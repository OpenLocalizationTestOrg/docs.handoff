{"content":"---\ntitle: \"Delay Signing an Assembly | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"deferring assembly signing\"\n  - \"signing assemblies\"\n  - \"assemblies [.NET Framework], signing\"\n  - \"strong-named assemblies, delaying assembly signing\"\n  - \"partial assembly signing\"\nms.assetid: 9d300e17-5bf1-4360-97da-2aa55efd9070\ncaps.latest.revision: 15\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Delay Signing an Assembly\nAn organization can have a closely guarded key pair that developers do not have access to on a daily basis. The public key is often available, but access to the private key is restricted to only a few individuals. When developing assemblies with strong names, each assembly that references the strong-named target assembly contains the token of the public key used to give the target assembly a strong name. This requires that the public key be available during the development process.  \n  \n You can use delayed or partial signing at build time to reserve space in the portable executable (PE) file for the strong name signature, but defer the actual signing until some later stage (typically just before shipping the assembly).  \n  \n The following steps outline the process to delay sign an assembly:  \n  \n1.  Obtain the public key portion of the key pair from the organization that will do the eventual signing. Typically this key is in the form of an .snk file, which can be created using the [Strong Name tool (Sn.exe)](../../../docs/framework/tools/sn-exe-strong-name-tool.md) provided by the [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)].  \n  \n2.  Annotate the source code for the assembly with two custom attributes from <xref:System.Reflection>:  \n  \n    -   <xref:System.Reflection.AssemblyKeyFileAttribute>, which passes the name of the file containing the public key as a parameter to its constructor.  \n  \n    -   <xref:System.Reflection.AssemblyDelaySignAttribute>, which indicates that delay signing is being used by passing **true** as a parameter to its constructor. For example:  \n  \n         [!code-cpp[AssemblyDelaySignAttribute#4](../../../samples/snippets/cpp/VS_Snippets_CLR/AssemblyDelaySignAttribute/cpp/source2.cpp#4)]\n         [!code-csharp[AssemblyDelaySignAttribute#4](../../../samples/snippets/csharp/VS_Snippets_CLR/AssemblyDelaySignAttribute/cs/source2.cs#4)]\n         [!code-vb[AssemblyDelaySignAttribute#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AssemblyDelaySignAttribute/vb/source2.vb#4)]  \n  \n3.  The compiler inserts the public key into the assembly manifest and reserves space in the PE file for the full strong name signature. The real public key must be stored while the assembly is built so that other assemblies that reference this assembly can obtain the key to store in their own assembly reference.  \n  \n4.  Because the assembly does not have a valid strong name signature, the verification of that signature must be turned off. You can do this by using the **–Vr** option with the Strong Name tool.  \n  \n     The following example turns off verification for an assembly called `myAssembly.dll`.  \n  \n    ```  \n    sn –Vr myAssembly.dll  \n    ```  \n  \n     To turn off verification on platforms where you can’t run the Strong Name tool, such as Advanced RISC Machine (ARM) microprocessors, use the **–Vk** option to create a registry file. Import the registry file into the registry on the computer where you want to turn off verification. The following example creates a registry file for `myAssembly.dll`.  \n  \n    ```  \n    sn –Vk myRegFile.reg myAssembly.dll  \n    ```  \n  \n     With either the **–Vr** or **–Vk** option, you can optionally include an .snk file for test key signing.  \n  \n    > [!CAUTION]\n    >  Use the **-Vr** or **–Vk** option only during development. Adding an assembly to the skip verification list creates a security vulnerability. A malicious assembly could use the fully specified assembly name (assembly name, version, culture, and public key token) of the assembly added to the skip verification list to fake its identity. This would allow the malicious assembly to also skip verification.  \n  \n    > [!NOTE]\n    >  If you use delay signing during development with Visual Studio on a 64-bit computer, and you compile an assembly for **Any CPU**, you might have to apply the **-Vr** option twice. (In Visual Studio, **Any CPU** is a value of the **Platform Target** build property; when you compile from the command line, it is the default.) To run your application from the command line or from File Explorer, use the 64-bit version of the [Sn.exe (Strong Name Tool)](../../../docs/framework/tools/sn-exe-strong-name-tool.md) to apply the **-Vr** option to the assembly. To load the assembly into Visual Studio at design time (for example, if the assembly contains components that are used by other assemblies in your application), use the 32-bit version of the strong-name tool. This is because the just-in-time (JIT) compiler compiles the assembly to 64-bit native code when the assembly is run from the command line, and to 32-bit native code when the assembly is loaded into the design-time environment.  \n  \n5.  Later, usually just before shipping, you submit the assembly to your organization's signing authority for the actual strong name signing using the **–R** option with the Strong Name tool.  \n  \n     The following example signs an assembly called `myAssembly.dll` with a strong name using the `sgKey.snk` key pair.  \n  \n    ```  \n    sn -R myAssembly.dll sgKey.snk  \n    ```  \n  \n## See Also  \n [Creating Assemblies](../../../docs/framework/app-domains/create-assemblies.md)   \n [How to: Create a Public-Private Key Pair](../../../docs/framework/app-domains/how-to-create-a-public-private-key-pair.md)   \n [Sn.exe (Strong Name Tool)](../../../docs/framework/tools/sn-exe-strong-name-tool.md)   \n [Programming with Assemblies](../../../docs/framework/app-domains/programming-with-assemblies.md)","nodes":[{"pos":[4,562],"embed":true,"restype":"x-metadata","content":"title: \"Delay Signing an Assembly | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"deferring assembly signing\"\n  - \"signing assemblies\"\n  - \"assemblies [.NET Framework], signing\"\n  - \"strong-named assemblies, delaying assembly signing\"\n  - \"partial assembly signing\"\nms.assetid: 9d300e17-5bf1-4360-97da-2aa55efd9070\ncaps.latest.revision: 15\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"Delay Signing an Assembly | Microsoft Docs","nodes":[{"pos":[0,42],"content":"Delay Signing an Assembly | Microsoft Docs","nodes":[{"content":"Delay Signing an Assembly | Microsoft Docs","pos":[0,42]}]}],"path":["title"]}],"yml":true},{"pos":[569,594],"content":"Delay Signing an Assembly","linkify":"Delay Signing an Assembly","nodes":[{"content":"Delay Signing an Assembly","pos":[0,25]}]},{"content":"An organization can have a closely guarded key pair that developers do not have access to on a daily basis.","pos":[595,702]},{"content":"The public key is often available, but access to the private key is restricted to only a few individuals.","pos":[703,808]},{"content":"When developing assemblies with strong names, each assembly that references the strong-named target assembly contains the token of the public key used to give the target assembly a strong name.","pos":[809,1002]},{"content":"This requires that the public key be available during the development process.","pos":[1003,1081]},{"content":"You can use delayed or partial signing at build time to reserve space in the portable executable (PE) file for the strong name signature, but defer the actual signing until some later stage (typically just before shipping the assembly).","pos":[1088,1324]},{"content":"The following steps outline the process to delay sign an assembly:","pos":[1331,1397]},{"content":"Obtain the public key portion of the key pair from the organization that will do the eventual signing.","pos":[1407,1509]},{"content":"Typically this key is in the form of an .snk file, which can be created using the <bpt id=\"p1\">[</bpt>Strong Name tool (Sn.exe)<ept id=\"p1\">](../../../docs/framework/tools/sn-exe-strong-name-tool.md)</ept> provided by the <ph id=\"ph1\">[!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)]</ph>.","pos":[1510,1753],"source":" Typically this key is in the form of an .snk file, which can be created using the [Strong Name tool (Sn.exe)](../../../docs/framework/tools/sn-exe-strong-name-tool.md) provided by the [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)]."},{"content":"Annotate the source code for the assembly with two custom attributes from <ph id=\"ph1\">&lt;xref:System.Reflection&gt;</ph>:","pos":[1763,1862],"source":"Annotate the source code for the assembly with two custom attributes from <xref:System.Reflection>:"},{"content":"<ph id=\"ph1\">&lt;xref:System.Reflection.AssemblyKeyFileAttribute&gt;</ph>, which passes the name of the file containing the public key as a parameter to its constructor.","pos":[1876,2021],"source":"<xref:System.Reflection.AssemblyKeyFileAttribute>, which passes the name of the file containing the public key as a parameter to its constructor."},{"content":"<ph id=\"ph1\">&lt;xref:System.Reflection.AssemblyDelaySignAttribute&gt;</ph>, which indicates that delay signing is being used by passing <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept> as a parameter to its constructor.","pos":[2035,2191],"source":"<xref:System.Reflection.AssemblyDelaySignAttribute>, which indicates that delay signing is being used by passing **true** as a parameter to its constructor."},{"content":"For example:","pos":[2192,2204]},{"pos":[2219,2647],"content":"[!code-cpp[AssemblyDelaySignAttribute#4](../../../samples/snippets/cpp/VS_Snippets_CLR/AssemblyDelaySignAttribute/cpp/source2.cpp#4)]\n [!code-csharp[AssemblyDelaySignAttribute#4](../../../samples/snippets/csharp/VS_Snippets_CLR/AssemblyDelaySignAttribute/cs/source2.cs#4)]\n [!code-vb[AssemblyDelaySignAttribute#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AssemblyDelaySignAttribute/vb/source2.vb#4)]","leadings":["","        ","        "],"nodes":[{"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>AssemblyDelaySignAttribute#4<ept id=\"p2\">](../../../samples/snippets/cpp/VS_Snippets_CLR/AssemblyDelaySignAttribute/cpp/source2.cpp#4)</ept><ept id=\"p1\">]</ept>","pos":[0,133],"source":"[!code-cpp[AssemblyDelaySignAttribute#4](../../../samples/snippets/cpp/VS_Snippets_CLR/AssemblyDelaySignAttribute/cpp/source2.cpp#4)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>AssemblyDelaySignAttribute#4<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/AssemblyDelaySignAttribute/cs/source2.cs#4)</ept><ept id=\"p1\">]</ept>","pos":[135,272],"source":"[!code-csharp[AssemblyDelaySignAttribute#4](../../../samples/snippets/csharp/VS_Snippets_CLR/AssemblyDelaySignAttribute/cs/source2.cs#4)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>AssemblyDelaySignAttribute#4<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AssemblyDelaySignAttribute/vb/source2.vb#4)</ept><ept id=\"p1\">]</ept>","pos":[274,412],"source":"[!code-vb[AssemblyDelaySignAttribute#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AssemblyDelaySignAttribute/vb/source2.vb#4)]"}]},{"content":"The compiler inserts the public key into the assembly manifest and reserves space in the PE file for the full strong name signature.","pos":[2657,2789]},{"content":"The real public key must be stored while the assembly is built so that other assemblies that reference this assembly can obtain the key to store in their own assembly reference.","pos":[2790,2967]},{"content":"Because the assembly does not have a valid strong name signature, the verification of that signature must be turned off.","pos":[2977,3097]},{"content":"You can do this by using the <bpt id=\"p1\">**</bpt>–Vr<ept id=\"p1\">**</ept> option with the Strong Name tool.","pos":[3098,3168],"source":" You can do this by using the **–Vr** option with the Strong Name tool."},{"pos":[3179,3264],"content":"The following example turns off verification for an assembly called <ph id=\"ph1\">`myAssembly.dll`</ph>.","source":"The following example turns off verification for an assembly called `myAssembly.dll`."},{"content":"To turn off verification on platforms where you can’t run the Strong Name tool, such as Advanced RISC Machine (ARM) microprocessors, use the <bpt id=\"p1\">**</bpt>–Vk<ept id=\"p1\">**</ept> option to create a registry file.","pos":[3326,3508],"source":"To turn off verification on platforms where you can’t run the Strong Name tool, such as Advanced RISC Machine (ARM) microprocessors, use the **–Vk** option to create a registry file."},{"content":"Import the registry file into the registry on the computer where you want to turn off verification.","pos":[3509,3608]},{"content":"The following example creates a registry file for <ph id=\"ph1\">`myAssembly.dll`</ph>.","pos":[3609,3676],"source":" The following example creates a registry file for `myAssembly.dll`."},{"pos":[3752,3856],"content":"With either the <bpt id=\"p1\">**</bpt>–Vr<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>–Vk<ept id=\"p2\">**</ept> option, you can optionally include an .snk file for test key signing.","source":"With either the **–Vr** or **–Vk** option, you can optionally include an .snk file for test key signing."},{"pos":[3868,4289],"content":"[!CAUTION]\nUse the **-Vr** or **–Vk** option only during development. Adding an assembly to the skip verification list creates a security vulnerability. A malicious assembly could use the fully specified assembly name (assembly name, version, culture, and public key token) of the assembly added to the skip verification list to fake its identity. This would allow the malicious assembly to also skip verification.","leadings":["","    >  "],"nodes":[{"content":"Use the **-Vr** or **–Vk** option only during development. Adding an assembly to the skip verification list creates a security vulnerability. A malicious assembly could use the fully specified assembly name (assembly name, version, culture, and public key token) of the assembly added to the skip verification list to fake its identity. This would allow the malicious assembly to also skip verification.","pos":[11,414],"nodes":[{"content":"Use the <bpt id=\"p1\">**</bpt>-Vr<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>–Vk<ept id=\"p2\">**</ept> option only during development.","pos":[0,58],"source":"Use the **-Vr** or **–Vk** option only during development."},{"content":"Adding an assembly to the skip verification list creates a security vulnerability.","pos":[59,141]},{"content":"A malicious assembly could use the fully specified assembly name (assembly name, version, culture, and public key token) of the assembly added to the skip verification list to fake its identity.","pos":[142,336]},{"content":"This would allow the malicious assembly to also skip verification.","pos":[337,403]}]}]},{"pos":[4301,5307],"content":"[!NOTE]\nIf you use delay signing during development with Visual Studio on a 64-bit computer, and you compile an assembly for **Any CPU**, you might have to apply the **-Vr** option twice. (In Visual Studio, **Any CPU** is a value of the **Platform Target** build property; when you compile from the command line, it is the default.) To run your application from the command line or from File Explorer, use the 64-bit version of the [Sn.exe (Strong Name Tool)](../../../docs/framework/tools/sn-exe-strong-name-tool.md) to apply the **-Vr** option to the assembly. To load the assembly into Visual Studio at design time (for example, if the assembly contains components that are used by other assemblies in your application), use the 32-bit version of the strong-name tool. This is because the just-in-time (JIT) compiler compiles the assembly to 64-bit native code when the assembly is run from the command line, and to 32-bit native code when the assembly is loaded into the design-time environment.","leadings":["","    >  "],"nodes":[{"content":"If you use delay signing during development with Visual Studio on a 64-bit computer, and you compile an assembly for **Any CPU**, you might have to apply the **-Vr** option twice. (In Visual Studio, **Any CPU** is a value of the **Platform Target** build property; when you compile from the command line, it is the default.) To run your application from the command line or from File Explorer, use the 64-bit version of the [Sn.exe (Strong Name Tool)](../../../docs/framework/tools/sn-exe-strong-name-tool.md) to apply the **-Vr** option to the assembly. To load the assembly into Visual Studio at design time (for example, if the assembly contains components that are used by other assemblies in your application), use the 32-bit version of the strong-name tool. This is because the just-in-time (JIT) compiler compiles the assembly to 64-bit native code when the assembly is run from the command line, and to 32-bit native code when the assembly is loaded into the design-time environment.","pos":[8,999],"nodes":[{"content":"If you use delay signing during development with Visual Studio on a 64-bit computer, and you compile an assembly for <bpt id=\"p1\">**</bpt>Any CPU<ept id=\"p1\">**</ept>, you might have to apply the <bpt id=\"p2\">**</bpt>-Vr<ept id=\"p2\">**</ept> option twice.","pos":[0,179],"source":"If you use delay signing during development with Visual Studio on a 64-bit computer, and you compile an assembly for **Any CPU**, you might have to apply the **-Vr** option twice."},{"content":"(In Visual Studio, <bpt id=\"p1\">**</bpt>Any CPU<ept id=\"p1\">**</ept> is a value of the <bpt id=\"p2\">**</bpt>Platform Target<ept id=\"p2\">**</ept> build property; when you compile from the command line, it is the default.) To run your application from the command line or from File Explorer, use the 64-bit version of the <bpt id=\"p3\">[</bpt>Sn.exe (Strong Name Tool)<ept id=\"p3\">](../../../docs/framework/tools/sn-exe-strong-name-tool.md)</ept> to apply the <bpt id=\"p4\">**</bpt>-Vr<ept id=\"p4\">**</ept> option to the assembly.","pos":[180,554],"source":" (In Visual Studio, **Any CPU** is a value of the **Platform Target** build property; when you compile from the command line, it is the default.) To run your application from the command line or from File Explorer, use the 64-bit version of the [Sn.exe (Strong Name Tool)](../../../docs/framework/tools/sn-exe-strong-name-tool.md) to apply the **-Vr** option to the assembly."},{"content":"To load the assembly into Visual Studio at design time (for example, if the assembly contains components that are used by other assemblies in your application), use the 32-bit version of the strong-name tool.","pos":[555,763]},{"content":"This is because the just-in-time (JIT) compiler compiles the assembly to 64-bit native code when the assembly is run from the command line, and to 32-bit native code when the assembly is loaded into the design-time environment.","pos":[764,991]}]}]},{"pos":[5317,5504],"content":"Later, usually just before shipping, you submit the assembly to your organization's signing authority for the actual strong name signing using the <bpt id=\"p1\">**</bpt>–R<ept id=\"p1\">**</ept> option with the Strong Name tool.","source":"Later, usually just before shipping, you submit the assembly to your organization's signing authority for the actual strong name signing using the **–R** option with the Strong Name tool."},{"pos":[5515,5629],"content":"The following example signs an assembly called <ph id=\"ph1\">`myAssembly.dll`</ph> with a strong name using the <ph id=\"ph2\">`sgKey.snk`</ph> key pair.","source":"The following example signs an assembly called `myAssembly.dll` with a strong name using the `sgKey.snk` key pair."},{"pos":[5698,5706],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Creating Assemblies<ept id=\"p1\">](../../../docs/framework/app-domains/create-assemblies.md)</ept><ph id=\"ph1\"> </ph>","pos":[5710,5790],"source":"[Creating Assemblies](../../../docs/framework/app-domains/create-assemblies.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Create a Public-Private Key Pair<ept id=\"p1\">](../../../docs/framework/app-domains/how-to-create-a-public-private-key-pair.md)</ept><ph id=\"ph1\"> </ph>","pos":[5794,5917],"source":"[How to: Create a Public-Private Key Pair](../../../docs/framework/app-domains/how-to-create-a-public-private-key-pair.md) "},{"content":"<bpt id=\"p1\">[</bpt>Sn.exe (Strong Name Tool)<ept id=\"p1\">](../../../docs/framework/tools/sn-exe-strong-name-tool.md)</ept><ph id=\"ph1\"> </ph>","pos":[5921,6007],"source":"[Sn.exe (Strong Name Tool)](../../../docs/framework/tools/sn-exe-strong-name-tool.md) "},{"content":"<bpt id=\"p1\">[</bpt>Programming with Assemblies<ept id=\"p1\">](../../../docs/framework/app-domains/programming-with-assemblies.md)</ept>","pos":[6011,6108],"source":"[Programming with Assemblies](../../../docs/framework/app-domains/programming-with-assemblies.md)"}]}