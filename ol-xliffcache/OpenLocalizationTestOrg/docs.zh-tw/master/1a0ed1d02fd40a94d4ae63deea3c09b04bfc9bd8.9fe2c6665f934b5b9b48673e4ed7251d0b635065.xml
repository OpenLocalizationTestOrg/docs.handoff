{"content":"---\ntitle: \"Emitting Dynamic Methods and Assemblies\"\nms.date: \"08/30/2017\"\nhelpviewer_keywords: \n  - \"reflection emit\"\n  - \"dynamic assemblies\"\n  - \"metadata, emit interfaces\"\n  - \"reflection emit, overview\"\n  - \"assemblies [.NET Framework], emitting dynamic assemblies\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# Emitting Dynamic Methods and Assemblies\nThis section describes a set of managed types in the <xref:System.Reflection.Emit> namespace that allow a compiler or tool to emit metadata and Microsoft intermediate language (MSIL) at run time and optionally generate a portable executable (PE) file on disk. Script engines and compilers are the primary users of this namespace. In this section, the functionality provided by the <xref:System.Reflection.Emit> namespace is referred to as reflection emit.  \n  \n Reflection emit provides the following capabilities:  \n  \n-   Define lightweight global methods at run time, using the <xref:System.Reflection.Emit.DynamicMethod> class, and execute them using delegates.  \n  \n-   Define assemblies at run time and then run them and/or save them to disk.  \n  \n-   Define assemblies at run time, run them, and then unload them and allow garbage collection to reclaim their resources.  \n  \n-   Define modules in new assemblies at run time and then run and/or save them to disk.  \n  \n-   Define types in modules at run time, create instances of these types, and invoke their methods.  \n  \n-   Define symbolic information for defined modules that can be used by tools such as debuggers and code profilers.  \n  \n In addition to the managed types in the <xref:System.Reflection.Emit> namespace, there are unmanaged metadata interfaces which are described in the [Metadata Interfaces](../../../docs/framework/unmanaged-api/metadata/metadata-interfaces.md) reference documentation. Managed reflection emit provides stronger semantic error checking and a higher level of abstraction of the metadata than the unmanaged metadata interfaces.  \n  \n Another useful resource for working with metadata and MSIL is the Common Language Infrastructure (CLI) documentation, especially \"Partition II: Metadata Definition and Semantics\" and \"Partition III: CIL Instruction Set\". The documentation is available online on [MSDN](https://go.microsoft.com/fwlink/?LinkID=65555) and at the [Ecma Web site](https://go.microsoft.com/fwlink/?LinkId=116487).  \n  \n## In This Section\n  \n[Security issues in reflection emit](../../../docs/framework/reflection-and-codedom/security-issues-in-reflection-emit.md)  \nDescribes security issues related to creating dynamic assemblies using reflection emit.  \n\n[How to: Define and execute dynamic methods](how-to-define-and-execute-dynamic-methods.md)   \nShows how to execute a simple dynamic method and a dynamic method bound to an instance of a class.\n\n[How to: Define a generic type with reflection emit](how-to-define-a-generic-type-with-reflection-emit.md)   \nShows how to create a simple generic type with two type parameters, how to apply class, interface, and special constraints to the type parameters, and how to create members that use the type parameters of the class as parameter types and return types.\n\n[How to: Define a generic method with reflection emit](how-to-define-a-generic-method-with-reflection-emit.md)   \nShows how to create, emit, and invoke a simple generic method.\n\n[Collectible assemblies for dynamic type generation](collectible-assemblies.md)   \nIntroduces collectible assemblies, which are dynamic assemblies that can be unloaded without unloading the application domain in which they were created.\n  \n## Reference  \n <xref:System.Reflection.Emit.OpCodes>  \n Catalogs the MSIL instruction codes you can use to build method bodies.  \n  \n <xref:System.Reflection.Emit>  \n Contains managed classes used to emit dynamic methods, assemblies, and types.  \n  \n <xref:System.Type>  \n Describes the <xref:System.Type> class, which represents types in managed reflection and reflection emit, and which is key to the use of these technologies.  \n  \n <xref:System.Reflection>  \n Contains managed classes used to explore metadata and managed code.  \n  \n## Related Sections  \n [Reflection](../../../docs/framework/reflection-and-codedom/reflection.md)  \n Explains how to explore metadata and managed code.  \n  \n [Assemblies in the Common Language Runtime](../../../docs/framework/app-domains/assemblies-in-the-common-language-runtime.md)  \n Provides an overview of assemblies in .NET implementations.\n","nodes":[{"pos":[4,310],"embed":true,"restype":"x-metadata","content":"title: \"Emitting Dynamic Methods and Assemblies\"\nms.date: \"08/30/2017\"\nhelpviewer_keywords: \n  - \"reflection emit\"\n  - \"dynamic assemblies\"\n  - \"metadata, emit interfaces\"\n  - \"reflection emit, overview\"\n  - \"assemblies [.NET Framework], emitting dynamic assemblies\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"Emitting Dynamic Methods and Assemblies","nodes":[{"pos":[0,39],"content":"Emitting Dynamic Methods and Assemblies","nodes":[{"content":"Emitting Dynamic Methods and Assemblies","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[317,356],"content":"Emitting Dynamic Methods and Assemblies","linkify":"Emitting Dynamic Methods and Assemblies","nodes":[{"content":"Emitting Dynamic Methods and Assemblies","pos":[0,39]}]},{"content":"This section describes a set of managed types in the <ph id=\"ph1\">&lt;xref:System.Reflection.Emit&gt;</ph> namespace that allow a compiler or tool to emit metadata and Microsoft intermediate language (MSIL) at run time and optionally generate a portable executable (PE) file on disk.","pos":[357,616],"source":"This section describes a set of managed types in the <xref:System.Reflection.Emit> namespace that allow a compiler or tool to emit metadata and Microsoft intermediate language (MSIL) at run time and optionally generate a portable executable (PE) file on disk."},{"content":"Script engines and compilers are the primary users of this namespace.","pos":[617,686]},{"content":"In this section, the functionality provided by the <ph id=\"ph1\">&lt;xref:System.Reflection.Emit&gt;</ph> namespace is referred to as reflection emit.","pos":[687,812],"source":" In this section, the functionality provided by the <xref:System.Reflection.Emit> namespace is referred to as reflection emit."},{"content":"Reflection emit provides the following capabilities:","pos":[819,871]},{"pos":[881,1022],"content":"Define lightweight global methods at run time, using the <ph id=\"ph1\">&lt;xref:System.Reflection.Emit.DynamicMethod&gt;</ph> class, and execute them using delegates.","source":"Define lightweight global methods at run time, using the <xref:System.Reflection.Emit.DynamicMethod> class, and execute them using delegates."},{"content":"Define assemblies at run time and then run them and/or save them to disk.","pos":[1032,1105]},{"content":"Define assemblies at run time, run them, and then unload them and allow garbage collection to reclaim their resources.","pos":[1115,1233]},{"content":"Define modules in new assemblies at run time and then run and/or save them to disk.","pos":[1243,1326]},{"content":"Define types in modules at run time, create instances of these types, and invoke their methods.","pos":[1336,1431]},{"content":"Define symbolic information for defined modules that can be used by tools such as debuggers and code profilers.","pos":[1441,1552]},{"content":"In addition to the managed types in the <ph id=\"ph1\">&lt;xref:System.Reflection.Emit&gt;</ph> namespace, there are unmanaged metadata interfaces which are described in the <bpt id=\"p1\">[</bpt>Metadata Interfaces<ept id=\"p1\">](../../../docs/framework/unmanaged-api/metadata/metadata-interfaces.md)</ept> reference documentation.","pos":[1559,1824],"source":"In addition to the managed types in the <xref:System.Reflection.Emit> namespace, there are unmanaged metadata interfaces which are described in the [Metadata Interfaces](../../../docs/framework/unmanaged-api/metadata/metadata-interfaces.md) reference documentation."},{"content":"Managed reflection emit provides stronger semantic error checking and a higher level of abstraction of the metadata than the unmanaged metadata interfaces.","pos":[1825,1980]},{"content":"Another useful resource for working with metadata and MSIL is the Common Language Infrastructure (CLI) documentation, especially \"Partition II: Metadata Definition and Semantics\" and \"Partition III: CIL Instruction Set\".","pos":[1987,2207]},{"content":"The documentation is available online on <bpt id=\"p1\">[</bpt>MSDN<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=65555)</ept> and at the <bpt id=\"p2\">[</bpt>Ecma Web site<ept id=\"p2\">](https://go.microsoft.com/fwlink/?LinkId=116487)</ept>.","pos":[2208,2378],"source":" The documentation is available online on [MSDN](https://go.microsoft.com/fwlink/?LinkID=65555) and at the [Ecma Web site](https://go.microsoft.com/fwlink/?LinkId=116487)."},{"pos":[2387,2402],"content":"In This Section","linkify":"In This Section","nodes":[{"content":"In This Section","pos":[0,15]}]},{"content":"<bpt id=\"p1\">[</bpt>Security issues in reflection emit<ept id=\"p1\">](../../../docs/framework/reflection-and-codedom/security-issues-in-reflection-emit.md)</ept>","pos":[2406,2528],"source":"[Security issues in reflection emit](../../../docs/framework/reflection-and-codedom/security-issues-in-reflection-emit.md)"},{"content":"Describes security issues related to creating dynamic assemblies using reflection emit.","pos":[2531,2618]},{"content":"<bpt id=\"p1\">[</bpt>How to: Define and execute dynamic methods<ept id=\"p1\">](how-to-define-and-execute-dynamic-methods.md)</ept><ph id=\"ph1\"> </ph>","pos":[2622,2713],"source":"[How to: Define and execute dynamic methods](how-to-define-and-execute-dynamic-methods.md) "},{"content":"Shows how to execute a simple dynamic method and a dynamic method bound to an instance of a class.","pos":[2716,2814]},{"content":"<bpt id=\"p1\">[</bpt>How to: Define a generic type with reflection emit<ept id=\"p1\">](how-to-define-a-generic-type-with-reflection-emit.md)</ept><ph id=\"ph1\"> </ph>","pos":[2816,2923],"source":"[How to: Define a generic type with reflection emit](how-to-define-a-generic-type-with-reflection-emit.md) "},{"content":"Shows how to create a simple generic type with two type parameters, how to apply class, interface, and special constraints to the type parameters, and how to create members that use the type parameters of the class as parameter types and return types.","pos":[2926,3177]},{"content":"<bpt id=\"p1\">[</bpt>How to: Define a generic method with reflection emit<ept id=\"p1\">](how-to-define-a-generic-method-with-reflection-emit.md)</ept><ph id=\"ph1\"> </ph>","pos":[3179,3290],"source":"[How to: Define a generic method with reflection emit](how-to-define-a-generic-method-with-reflection-emit.md) "},{"content":"Shows how to create, emit, and invoke a simple generic method.","pos":[3293,3355]},{"content":"<bpt id=\"p1\">[</bpt>Collectible assemblies for dynamic type generation<ept id=\"p1\">](collectible-assemblies.md)</ept><ph id=\"ph1\"> </ph>","pos":[3357,3437],"source":"[Collectible assemblies for dynamic type generation](collectible-assemblies.md) "},{"content":"Introduces collectible assemblies, which are dynamic assemblies that can be unloaded without unloading the application domain in which they were created.","pos":[3440,3593]},{"pos":[3600,3609],"content":"Reference","linkify":"Reference","nodes":[{"content":"Reference","pos":[0,9]}]},{"content":"Catalogs the MSIL instruction codes you can use to build method bodies.","pos":[3654,3725]},{"content":"Contains managed classes used to emit dynamic methods, assemblies, and types.","pos":[3765,3842]},{"content":"Describes the <ph id=\"ph1\">&lt;xref:System.Type&gt;</ph> class, which represents types in managed reflection and reflection emit, and which is key to the use of these technologies.","pos":[3871,4027],"source":"Describes the <xref:System.Type> class, which represents types in managed reflection and reflection emit, and which is key to the use of these technologies."},{"content":"Contains managed classes used to explore metadata and managed code.","pos":[4062,4129]},{"pos":[4138,4154],"content":"Related Sections","linkify":"Related Sections","nodes":[{"content":"Related Sections","pos":[0,16]}]},{"content":"<bpt id=\"p1\">[</bpt>Reflection<ept id=\"p1\">](../../../docs/framework/reflection-and-codedom/reflection.md)</ept>","pos":[4158,4232],"source":"[Reflection](../../../docs/framework/reflection-and-codedom/reflection.md)"},{"content":"Explains how to explore metadata and managed code.","pos":[4236,4286]},{"content":"<bpt id=\"p1\">[</bpt>Assemblies in the Common Language Runtime<ept id=\"p1\">](../../../docs/framework/app-domains/assemblies-in-the-common-language-runtime.md)</ept>","pos":[4293,4418],"source":"[Assemblies in the Common Language Runtime](../../../docs/framework/app-domains/assemblies-in-the-common-language-runtime.md)"},{"content":"Provides an overview of assemblies in .NET implementations.","pos":[4422,4481]}]}