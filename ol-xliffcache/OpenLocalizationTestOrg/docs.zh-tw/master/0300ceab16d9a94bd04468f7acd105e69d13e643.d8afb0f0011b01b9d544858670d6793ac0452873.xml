{"content":"---\ntitle: \"DataTable Edits\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: f08008a9-042e-4de9-94f3-4f0e502b1eb5\n---\n# DataTable Edits\nWhen you make changes to column values in a <xref:System.Data.DataRow>, the changes are immediately placed in the current state of the row. The <xref:System.Data.DataRowState> is then set to **Modified**, and the changes are accepted or rejected using the <xref:System.Data.DataRow.AcceptChanges%2A> or <xref:System.Data.DataRow.RejectChanges%2A> methods of the **DataRow**. The **DataRow** also provides three methods that you can use to suspend the state of the row while you are editing it. These methods are <xref:System.Data.DataRow.BeginEdit%2A>, <xref:System.Data.DataRow.EndEdit%2A>, and <xref:System.Data.DataRow.CancelEdit%2A>.  \n  \n When you modify column values in a **DataRow** directly, the **DataRow** manages the column values using the **Current**, **Default**, and **Original** row versions. In addition to these row versions, the **BeginEdit**, **EndEdit**, and **CancelEdit** methods use a fourth row version: **Proposed**. For more information about row versions, see [Row States and Row Versions](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md).  \n  \n The **Proposed** row version exists during an edit operation that begins by calling **BeginEdit** and that ends either by using **EndEdit** or **CancelEdit,** or by calling **AcceptChanges** or **RejectChanges**.  \n  \n During the edit operation, you can apply validation logic to individual columns by evaluating the **ProposedValue** in the **ColumnChanged** event of the **DataTable**. The **ColumnChanged** event holds **DataColumnChangeEventArgs** that keep a reference to the column that is changing and to the **ProposedValue**. After you evaluate the proposed value, you can either modify it or cancel the edit. When the edit is ended, the row moves out of the **Proposed** state.  \n  \n You can confirm edits by calling **EndEdit**, or you can cancel them by calling **CancelEdit**. Note that while **EndEdit** does confirm your edits, the **DataSet** does not actually accept the changes until **AcceptChanges** is called. Note also that if you call **AcceptChanges** before you have ended the edit with **EndEdit** or **CancelEdit**, the edit is ended and the **Proposed** row values are accepted for both the **Current** and **Original** row versions. In the same manner, calling **RejectChanges** ends the edit and discards the **Current** and **Proposed** row versions. Calling **EndEdit** or **CancelEdit** after calling **AcceptChanges** or **RejectChanges** has no effect because the edit has already ended.  \n  \n The following example demonstrates how to use **BeginEdit** with **EndEdit** and **CancelEdit**. The example also checks the **ProposedValue** in the **ColumnChanged** event and decides whether to cancel the edit.  \n  \n```vb  \nDim workTable As DataTable = New DataTable  \nworkTable.Columns.Add(\"LastName\", Type.GetType(\"System.String\"))  \n  \nAddHandler workTable.ColumnChanged, _  \n  New DataColumnChangeEventHandler(AddressOf OnColumnChanged)  \n  \nDim workRow As DataRow = workTable.NewRow()  \nworkRow(0) = \"Smith\"  \nworkTable.Rows.Add(workRow)  \n  \nworkRow.BeginEdit()  \n' Causes the ColumnChanged event to write a message and cancel the edit.  \nworkRow(0) = \"\"       \nworkRow.EndEdit()  \n  \n' Displays \"Smith, New\".  \nConsole.WriteLine(\"{0}, {1}\", workRow(0), workRow.RowState)  \n  \nPrivate Shared Sub OnColumnChanged( _  \n  sender As Object, args As DataColumnChangeEventArgs)  \n  If args.Column.ColumnName = \"LastName\" Then  \n    If args.ProposedValue.ToString() = \"\" Then  \n      Console.WriteLine(\"Last Name cannot be blank.  Edit canceled.\")  \n      args.Row.CancelEdit()  \n    End If  \n  End If  \nEnd Sub  \n```  \n  \n```csharp  \nDataTable workTable  = new DataTable();  \nworkTable.Columns.Add(\"LastName\", typeof(String));  \n  \nworkTable.ColumnChanged +=   \n  new DataColumnChangeEventHandler(OnColumnChanged);  \n  \nDataRow workRow = workTable.NewRow();  \nworkRow[0] = \"Smith\";  \nworkTable.Rows.Add(workRow);  \n  \nworkRow.BeginEdit();  \n// Causes the ColumnChanged event to write a message and cancel the edit.  \nworkRow[0] = \"\";       \nworkRow.EndEdit();  \n  \n// Displays \"Smith, New\".  \nConsole.WriteLine(\"{0}, {1}\", workRow[0], workRow.RowState);    \n  \nprotected static void OnColumnChanged(  \n  Object sender, DataColumnChangeEventArgs args)  \n{  \n  if (args.Column.ColumnName == \"LastName\")  \n    if (args.ProposedValue.ToString() == \"\")  \n    {  \n      Console.WriteLine(\"Last Name cannot be blank. Edit canceled.\");  \n      args.Row.CancelEdit();  \n    }  \n}  \n```  \n  \n## See also\n\n- <xref:System.Data.DataRow>\n- <xref:System.Data.DataTable>\n- <xref:System.Data.DataRowVersion>\n- [Manipulating Data in a DataTable](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/manipulating-data-in-a-datatable.md)\n- [Handling DataTable Events](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/handling-datatable-events.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,133],"embed":true,"restype":"x-metadata","content":"title: \"DataTable Edits\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: f08008a9-042e-4de9-94f3-4f0e502b1eb5","nodes":[{"content":"DataTable Edits","nodes":[{"pos":[0,15],"content":"DataTable Edits","nodes":[{"content":"DataTable Edits","pos":[0,15]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[140,155],"content":"DataTable Edits","linkify":"DataTable Edits","nodes":[{"content":"DataTable Edits","pos":[0,15]}]},{"content":"When you make changes to column values in a <ph id=\"ph1\">&lt;xref:System.Data.DataRow&gt;</ph>, the changes are immediately placed in the current state of the row.","pos":[156,295],"source":"When you make changes to column values in a <xref:System.Data.DataRow>, the changes are immediately placed in the current state of the row."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataRowState&gt;</ph> is then set to <bpt id=\"p1\">**</bpt>Modified<ept id=\"p1\">**</ept>, and the changes are accepted or rejected using the <ph id=\"ph2\">&lt;xref:System.Data.DataRow.AcceptChanges%2A&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Data.DataRow.RejectChanges%2A&gt;</ph> methods of the <bpt id=\"p2\">**</bpt>DataRow<ept id=\"p2\">**</ept>.","pos":[296,530],"source":" The <xref:System.Data.DataRowState> is then set to **Modified**, and the changes are accepted or rejected using the <xref:System.Data.DataRow.AcceptChanges%2A> or <xref:System.Data.DataRow.RejectChanges%2A> methods of the **DataRow**."},{"content":"The <bpt id=\"p1\">**</bpt>DataRow<ept id=\"p1\">**</ept> also provides three methods that you can use to suspend the state of the row while you are editing it.","pos":[531,649],"source":" The **DataRow** also provides three methods that you can use to suspend the state of the row while you are editing it."},{"content":"These methods are <ph id=\"ph1\">&lt;xref:System.Data.DataRow.BeginEdit%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Data.DataRow.EndEdit%2A&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Data.DataRow.CancelEdit%2A&gt;</ph>.","pos":[650,793],"source":" These methods are <xref:System.Data.DataRow.BeginEdit%2A>, <xref:System.Data.DataRow.EndEdit%2A>, and <xref:System.Data.DataRow.CancelEdit%2A>."},{"content":"When you modify column values in a <bpt id=\"p1\">**</bpt>DataRow<ept id=\"p1\">**</ept> directly, the <bpt id=\"p2\">**</bpt>DataRow<ept id=\"p2\">**</ept> manages the column values using the <bpt id=\"p3\">**</bpt>Current<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Default<ept id=\"p4\">**</ept>, and <bpt id=\"p5\">**</bpt>Original<ept id=\"p5\">**</ept> row versions.","pos":[800,965],"source":"When you modify column values in a **DataRow** directly, the **DataRow** manages the column values using the **Current**, **Default**, and **Original** row versions."},{"content":"In addition to these row versions, the <bpt id=\"p1\">**</bpt>BeginEdit<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>EndEdit<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>CancelEdit<ept id=\"p3\">**</ept> methods use a fourth row version: <bpt id=\"p4\">**</bpt>Proposed<ept id=\"p4\">**</ept>.","pos":[966,1099],"source":" In addition to these row versions, the **BeginEdit**, **EndEdit**, and **CancelEdit** methods use a fourth row version: **Proposed**."},{"content":"For more information about row versions, see <bpt id=\"p1\">[</bpt>Row States and Row Versions<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)</ept>.","pos":[1100,1276],"source":" For more information about row versions, see [Row States and Row Versions](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)."},{"pos":[1283,1495],"content":"The <bpt id=\"p1\">**</bpt>Proposed<ept id=\"p1\">**</ept> row version exists during an edit operation that begins by calling <bpt id=\"p2\">**</bpt>BeginEdit<ept id=\"p2\">**</ept> and that ends either by using <bpt id=\"p3\">**</bpt>EndEdit<ept id=\"p3\">**</ept> or <bpt id=\"p4\">**</bpt>CancelEdit,<ept id=\"p4\">**</ept> or by calling <bpt id=\"p5\">**</bpt>AcceptChanges<ept id=\"p5\">**</ept> or <bpt id=\"p6\">**</bpt>RejectChanges<ept id=\"p6\">**</ept>.","source":"The **Proposed** row version exists during an edit operation that begins by calling **BeginEdit** and that ends either by using **EndEdit** or **CancelEdit,** or by calling **AcceptChanges** or **RejectChanges**."},{"content":"During the edit operation, you can apply validation logic to individual columns by evaluating the <bpt id=\"p1\">**</bpt>ProposedValue<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>ColumnChanged<ept id=\"p2\">**</ept> event of the <bpt id=\"p3\">**</bpt>DataTable<ept id=\"p3\">**</ept>.","pos":[1502,1670],"source":"During the edit operation, you can apply validation logic to individual columns by evaluating the **ProposedValue** in the **ColumnChanged** event of the **DataTable**."},{"content":"The <bpt id=\"p1\">**</bpt>ColumnChanged<ept id=\"p1\">**</ept> event holds <bpt id=\"p2\">**</bpt>DataColumnChangeEventArgs<ept id=\"p2\">**</ept> that keep a reference to the column that is changing and to the <bpt id=\"p3\">**</bpt>ProposedValue<ept id=\"p3\">**</ept>.","pos":[1671,1817],"source":" The **ColumnChanged** event holds **DataColumnChangeEventArgs** that keep a reference to the column that is changing and to the **ProposedValue**."},{"content":"After you evaluate the proposed value, you can either modify it or cancel the edit.","pos":[1818,1901]},{"content":"When the edit is ended, the row moves out of the <bpt id=\"p1\">**</bpt>Proposed<ept id=\"p1\">**</ept> state.","pos":[1902,1970],"source":" When the edit is ended, the row moves out of the **Proposed** state."},{"content":"You can confirm edits by calling <bpt id=\"p1\">**</bpt>EndEdit<ept id=\"p1\">**</ept>, or you can cancel them by calling <bpt id=\"p2\">**</bpt>CancelEdit<ept id=\"p2\">**</ept>.","pos":[1977,2072],"source":"You can confirm edits by calling **EndEdit**, or you can cancel them by calling **CancelEdit**."},{"content":"Note that while <bpt id=\"p1\">**</bpt>EndEdit<ept id=\"p1\">**</ept> does confirm your edits, the <bpt id=\"p2\">**</bpt>DataSet<ept id=\"p2\">**</ept> does not actually accept the changes until <bpt id=\"p3\">**</bpt>AcceptChanges<ept id=\"p3\">**</ept> is called.","pos":[2073,2213],"source":" Note that while **EndEdit** does confirm your edits, the **DataSet** does not actually accept the changes until **AcceptChanges** is called."},{"content":"Note also that if you call <bpt id=\"p1\">**</bpt>AcceptChanges<ept id=\"p1\">**</ept> before you have ended the edit with <bpt id=\"p2\">**</bpt>EndEdit<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>CancelEdit<ept id=\"p3\">**</ept>, the edit is ended and the <bpt id=\"p4\">**</bpt>Proposed<ept id=\"p4\">**</ept> row values are accepted for both the <bpt id=\"p5\">**</bpt>Current<ept id=\"p5\">**</ept> and <bpt id=\"p6\">**</bpt>Original<ept id=\"p6\">**</ept> row versions.","pos":[2214,2444],"source":" Note also that if you call **AcceptChanges** before you have ended the edit with **EndEdit** or **CancelEdit**, the edit is ended and the **Proposed** row values are accepted for both the **Current** and **Original** row versions."},{"content":"In the same manner, calling <bpt id=\"p1\">**</bpt>RejectChanges<ept id=\"p1\">**</ept> ends the edit and discards the <bpt id=\"p2\">**</bpt>Current<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>Proposed<ept id=\"p3\">**</ept> row versions.","pos":[2445,2564],"source":" In the same manner, calling **RejectChanges** ends the edit and discards the **Current** and **Proposed** row versions."},{"content":"Calling <bpt id=\"p1\">**</bpt>EndEdit<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>CancelEdit<ept id=\"p2\">**</ept> after calling <bpt id=\"p3\">**</bpt>AcceptChanges<ept id=\"p3\">**</ept> or <bpt id=\"p4\">**</bpt>RejectChanges<ept id=\"p4\">**</ept> has no effect because the edit has already ended.","pos":[2565,2705],"source":" Calling **EndEdit** or **CancelEdit** after calling **AcceptChanges** or **RejectChanges** has no effect because the edit has already ended."},{"content":"The following example demonstrates how to use <bpt id=\"p1\">**</bpt>BeginEdit<ept id=\"p1\">**</ept> with <bpt id=\"p2\">**</bpt>EndEdit<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>CancelEdit<ept id=\"p3\">**</ept>.","pos":[2712,2808],"source":"The following example demonstrates how to use **BeginEdit** with **EndEdit** and **CancelEdit**."},{"content":"The example also checks the <bpt id=\"p1\">**</bpt>ProposedValue<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>ColumnChanged<ept id=\"p2\">**</ept> event and decides whether to cancel the edit.","pos":[2809,2925],"source":" The example also checks the **ProposedValue** in the **ColumnChanged** event and decides whether to cancel the edit."},{"pos":[4700,4708],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4808,4948],"content":"<bpt id=\"p1\">[</bpt>Manipulating Data in a DataTable<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/manipulating-data-in-a-datatable.md)</ept>","source":"[Manipulating Data in a DataTable](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/manipulating-data-in-a-datatable.md)"},{"pos":[4951,5077],"content":"<bpt id=\"p1\">[</bpt>Handling DataTable Events<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/handling-datatable-events.md)</ept>","source":"[Handling DataTable Events](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/handling-datatable-events.md)"},{"pos":[5080,5184],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}