<?xml version="1.0"?>
<xliff version="1.2" xmlns="urn:oasis:names:tc:xliff:document:1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xliff:document:1.2 xliff-core-1.2-transitional.xsd">
  <file datatype="xml" original="iclrmetahostpolicy-getrequestedruntime-method.md" source-language="en-US" target-language="zh-tw">
    <header>
      <tool tool-id="mdxliff" tool-name="mdxliff" tool-version="1.0-0a91294" tool-company="Microsoft" />
      <xliffext:olfilehash xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">73d5c98500c510630b1f8d6081b654a6dbd88a5b</xliffext:olfilehash>
      <xliffext:olfilepath xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">docs\framework\unmanaged-api\hosting\iclrmetahostpolicy-getrequestedruntime-method.md</xliffext:olfilepath>
      <xliffext:oltranslationpriority xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">net-lo-mt</xliffext:oltranslationpriority>
      <xliffext:oltranslationtype xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">MT</xliffext:oltranslationtype>
      <xliffext:olskeletonhash xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">3d1e92bec7d24afcedc7103fe19f0608e61f5d2d</xliffext:olskeletonhash>
      <xliffext:olxliffhash xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">3b22d815daa3d5951490ac44b082dc54140e4d4c</xliffext:olxliffhash>
    </header>
    <body>
      <group id="content" extype="content">
        <trans-unit id="101" translate="yes" xml:space="preserve" restype="x-metadata">
          <source>ICLRMetaHostPolicy::GetRequestedRuntime Method</source>
        </trans-unit>
        <trans-unit id="102" translate="yes" xml:space="preserve">
          <source>ICLRMetaHostPolicy::GetRequestedRuntime Method</source>
        </trans-unit>
        <trans-unit id="103" translate="yes" xml:space="preserve">
          <source>Provides an interface to a preferred version of the common language runtime (CLR) based on a hosting policy, managed assembly, version string, and configuration stream.</source>
        </trans-unit>
        <trans-unit id="104" translate="yes" xml:space="preserve">
          <source>This method does not actually load or activate the CLR, but simply returns the <bpt id="p1">[</bpt>ICLRRuntimeInfo<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md)</ept> interface that represents the policy result.</source>
        </trans-unit>
        <trans-unit id="105" translate="yes" xml:space="preserve">
          <source>This method supersedes the <bpt id="p1">[</bpt>GetRequestedRuntimeInfo<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md)</ept>, <bpt id="p2">[</bpt>GetRequestedRuntimeVersion<ept id="p2">](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md)</ept>, <bpt id="p3">[</bpt>CorBindToRuntimeHost<ept id="p3">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimehost-function.md)</ept>, <bpt id="p4">[</bpt>CorBindToRuntimeByCfg<ept id="p4">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimebycfg-function.md)</ept>, and <bpt id="p5">[</bpt>GetCORRequiredVersion<ept id="p5">](../../../../docs/framework/unmanaged-api/hosting/getcorrequiredversion-function.md)</ept> methods.</source>
        </trans-unit>
        <trans-unit id="106" translate="yes" xml:space="preserve">
          <source>Syntax</source>
        </trans-unit>
        <trans-unit id="107" translate="yes" xml:space="preserve">
          <source>Parameters</source>
        </trans-unit>
        <trans-unit id="108" translate="yes" xml:space="preserve">
          <source>Name</source>
        </trans-unit>
        <trans-unit id="109" translate="yes" xml:space="preserve">
          <source>Description</source>
        </trans-unit>
        <trans-unit id="110" translate="yes" xml:space="preserve">
          <source>[in] Required.</source>
        </trans-unit>
        <trans-unit id="111" translate="yes" xml:space="preserve">
          <source>Specifies a member of the <bpt id="p1">[</bpt>METAHOST_POLICY_FLAGS<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept> enumeration, representing a binding policy, and any number of modifiers.</source>
        </trans-unit>
        <trans-unit id="112" translate="yes" xml:space="preserve">
          <source>The only policy that is currently available is <bpt id="p1">[</bpt>METAHOST_POLICY_HIGHCOMPAT<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept>.</source>
        </trans-unit>
        <trans-unit id="113" translate="yes" xml:space="preserve">
          <source>Modifiers include <bpt id="p1">[</bpt>METAHOST_POLICY_EMULATE_EXE_LAUNCH<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept>, <bpt id="p2">[</bpt>METAHOST_POLICY_APPLY_UPGRADE_POLICY<ept id="p2">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept>, <bpt id="p3">[</bpt>METAHOST_POLICY_SHOW_ERROR_DIALOG<ept id="p3">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept>, <bpt id="p4">[</bpt>METAHOST_POLICY_USE_PROCESS_IMAGE_PATH<ept id="p4">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept>, and <bpt id="p5">[</bpt>METAHOST_POLICY_ENSURE_SKU_SUPPORTED<ept id="p5">](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md)</ept>.</source>
        </trans-unit>
        <trans-unit id="114" translate="yes" xml:space="preserve">
          <source>[in] Optional.</source>
        </trans-unit>
        <trans-unit id="115" translate="yes" xml:space="preserve">
          <source>Specifies the assembly file path.</source>
        </trans-unit>
        <trans-unit id="116" translate="yes" xml:space="preserve">
          <source>[in] Optional.</source>
        </trans-unit>
        <trans-unit id="117" translate="yes" xml:space="preserve">
          <source>Specifies the configuration file as a <ph id="ph1">&lt;xref:System.Runtime.InteropServices.ComTypes.IStream?displayProperty=nameWithType&gt;</ph>.</source>
        </trans-unit>
        <trans-unit id="118" translate="yes" xml:space="preserve">
          <source>[in, out] Optional.</source>
        </trans-unit>
        <trans-unit id="119" translate="yes" xml:space="preserve">
          <source>Specifies or returns the preferred CLR version to be loaded.</source>
        </trans-unit>
        <trans-unit id="120" translate="yes" xml:space="preserve">
          <source>[in, out] Required.</source>
        </trans-unit>
        <trans-unit id="121" translate="yes" xml:space="preserve">
          <source>Specifies the expected size of <ph id="ph1">`pwzVersion`</ph> as input, to avoid buffer overruns.</source>
        </trans-unit>
        <trans-unit id="122" translate="yes" xml:space="preserve">
          <source>If <ph id="ph1">`pwzVersion`</ph> is null, <ph id="ph2">`pcchVersion`</ph> contains the expected size of <ph id="ph3">`pwzVersion`</ph> when <ph id="ph4">`GetRequestedRuntime`</ph> returns, to allow pre-allocation; otherwise, <ph id="ph5">`pcchVersion`</ph> contains the number of characters written to <ph id="ph6">`pwzVersion`</ph>.</source>
        </trans-unit>
        <trans-unit id="123" translate="yes" xml:space="preserve">
          <source>[out] Optional.</source>
        </trans-unit>
        <trans-unit id="124" translate="yes" xml:space="preserve">
          <source>When <ph id="ph1">`GetRequestedRuntime`</ph> returns, contains the CLR version corresponding to the <bpt id="p1">[</bpt>ICLRRuntimeInfo<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md)</ept> interface that is returned.</source>
        </trans-unit>
        <trans-unit id="125" translate="yes" xml:space="preserve">
          <source>[in, out] Optional.</source>
        </trans-unit>
        <trans-unit id="126" translate="yes" xml:space="preserve">
          <source>Specifies the size of <ph id="ph1">`pwzImageVersion`</ph> as input to avoid buffer overruns.</source>
        </trans-unit>
        <trans-unit id="127" translate="yes" xml:space="preserve">
          <source>If <ph id="ph1">`pwzImageVersion`</ph> is null, <ph id="ph2">`pcchImageVersion`</ph> contains the required size of <ph id="ph3">`pwzImageVersion`</ph> when <ph id="ph4">`GetRequestedRuntime`</ph> returns, to allow pre-allocation.</source>
        </trans-unit>
        <trans-unit id="128" translate="yes" xml:space="preserve">
          <source>[out] Optional.</source>
        </trans-unit>
        <trans-unit id="129" translate="yes" xml:space="preserve">
          <source>If <ph id="ph1">`GetRequestedRuntime`</ph> uses a configuration file during the binding process, when it returns, <ph id="ph2">`pdwConfigFlags`</ph> contains a <bpt id="p1">[</bpt>METAHOST_CONFIG_FLAGS<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/metahost-config-flags-enumeration.md)</ept> value that indicates whether the <bpt id="p2">[</bpt><ph id="ph3">\&lt;</ph>startup&gt;<ept id="p2">](../../../../docs/framework/configure-apps/file-schema/startup/startup-element.md)</ept> element has the <ph id="ph4">`useLegacyV2RuntimeActivationPolicy`</ph> attribute set, and the value of the attribute.</source>
        </trans-unit>
        <trans-unit id="130" translate="yes" xml:space="preserve">
          <source>Apply the <bpt id="p1">[</bpt>METAHOST_CONFIG_FLAGS_LEGACY_V2_ACTIVATION_POLICY_MASK<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/metahost-config-flags-enumeration.md)</ept> mask to <ph id="ph1">`pdwConfigFlags`</ph> to get the values relevant to <ph id="ph2">`useLegacyV2RuntimeActivationPolicy`</ph>.</source>
        </trans-unit>
        <trans-unit id="131" translate="yes" xml:space="preserve">
          <source>[in] Specifies the interface identifier IID_ICLRRuntimeInfo for the requested <bpt id="p1">[</bpt>ICLRRuntimeInfo<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md)</ept> interface.</source>
        </trans-unit>
        <trans-unit id="132" translate="yes" xml:space="preserve">
          <source>[out] When <ph id="ph1">`GetRequestedRuntime`</ph> returns, contains a pointer to the corresponding <bpt id="p1">[</bpt>ICLRRuntimeInfo<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md)</ept> interface.</source>
        </trans-unit>
        <trans-unit id="133" translate="yes" xml:space="preserve">
          <source>Remarks</source>
        </trans-unit>
        <trans-unit id="134" translate="yes" xml:space="preserve">
          <source>When this method succeeds, it has the side effect of combining additional flags with the current default startup flags of the returned runtime interface, if and only if one or more of the following elements exist in the configuration stream within the <ph id="ph1">`&lt;configuration&gt;&lt;runtime&gt;`</ph> section:</source>
        </trans-unit>
        <trans-unit id="135" translate="yes" xml:space="preserve">
          <source><ph id="ph1">`&lt;gcServer enabled="true"/&gt;`</ph> causes <ph id="ph2">`STARTUP_SERVER_GC`</ph> to be set.</source>
        </trans-unit>
        <trans-unit id="136" translate="yes" xml:space="preserve">
          <source><ph id="ph1">`&lt;etwEnable enabled="true"/&gt;`</ph> causes <ph id="ph2">`STARTUP_ETW`</ph> to be set.</source>
        </trans-unit>
        <trans-unit id="137" translate="yes" xml:space="preserve">
          <source><ph id="ph1">`&lt;appDomainResourceMonitoring enabled="true"/&gt;`</ph> causes <ph id="ph2">`STARTUP_ARM`</ph> to be set.</source>
        </trans-unit>
        <trans-unit id="138" translate="yes" xml:space="preserve">
          <source>The resulting default <ph id="ph1">`STARTUP_FLAGS`</ph> value is the bitwise OR combination of the values that are set from the preceding list with the default startup flags.</source>
        </trans-unit>
        <trans-unit id="139" translate="yes" xml:space="preserve">
          <source>Return Value</source>
        </trans-unit>
        <trans-unit id="140" translate="yes" xml:space="preserve">
          <source>This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.</source>
        </trans-unit>
        <trans-unit id="141" translate="yes" xml:space="preserve">
          <source>HRESULT</source>
        </trans-unit>
        <trans-unit id="142" translate="yes" xml:space="preserve">
          <source>Description</source>
        </trans-unit>
        <trans-unit id="143" translate="yes" xml:space="preserve">
          <source>S_OK</source>
        </trans-unit>
        <trans-unit id="144" translate="yes" xml:space="preserve">
          <source>The method completed successfully.</source>
        </trans-unit>
        <trans-unit id="145" translate="yes" xml:space="preserve">
          <source>E_POINTER</source>
        </trans-unit>
        <trans-unit id="146" translate="yes" xml:space="preserve">
          <source><ph id="ph1">`pwzVersion`</ph> is not null and <ph id="ph2">`pcchVersion`</ph> is null.</source>
        </trans-unit>
        <trans-unit id="147" translate="yes" xml:space="preserve">
          <source>-or-</source>
        </trans-unit>
        <trans-unit id="148" translate="yes" xml:space="preserve">
          <source><ph id="ph1">`pwzImageVersion`</ph> is not null and <ph id="ph2">`pcchImageVersion`</ph> is null.</source>
        </trans-unit>
        <trans-unit id="149" translate="yes" xml:space="preserve">
          <source>E_INVALIDARG</source>
        </trans-unit>
        <trans-unit id="150" translate="yes" xml:space="preserve">
          <source><ph id="ph1">`dwPolicyFlags`</ph> does not specify <ph id="ph2">`METAHOST_POLICY_HIGHCOMPAT`</ph>.</source>
        </trans-unit>
        <trans-unit id="151" translate="yes" xml:space="preserve">
          <source>ERROR_INSUFFICIENT_BUFFER</source>
        </trans-unit>
        <trans-unit id="152" translate="yes" xml:space="preserve">
          <source>The memory allocated to <ph id="ph1">`pwzVersion`</ph> is inadequate.</source>
        </trans-unit>
        <trans-unit id="153" translate="yes" xml:space="preserve">
          <source>-or-</source>
        </trans-unit>
        <trans-unit id="154" translate="yes" xml:space="preserve">
          <source>The memory allocated to <ph id="ph1">`pwzImageVersion`</ph> is inadequate.</source>
        </trans-unit>
        <trans-unit id="155" translate="yes" xml:space="preserve">
          <source>CLR_E_SHIM_RUNTIMELOAD</source>
        </trans-unit>
        <trans-unit id="156" translate="yes" xml:space="preserve">
          <source><ph id="ph1">`dwPolicyFlags`</ph> includes METAHOST_POLICY_APPLY_UPGRADE_POLICY, and both <ph id="ph2">`pwzVersion`</ph> and <ph id="ph3">`pcchVersion`</ph> are null.</source>
        </trans-unit>
        <trans-unit id="157" translate="yes" xml:space="preserve">
          <source>Requirements</source>
        </trans-unit>
        <trans-unit id="158" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Platforms:<ept id="p1">**</ept> See <bpt id="p2">[</bpt>System Requirements<ept id="p2">](../../../../docs/framework/get-started/system-requirements.md)</ept>.</source>
        </trans-unit>
        <trans-unit id="159" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Header:<ept id="p1">**</ept> MetaHost.h</source>
        </trans-unit>
        <trans-unit id="160" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>Library:<ept id="p1">**</ept> Included as a resource in MSCorEE.dll</source>
        </trans-unit>
        <trans-unit id="161" translate="yes" xml:space="preserve">
          <source><bpt id="p1">**</bpt>.NET Framework Versions:<ept id="p1">**</ept> <ph id="ph1">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph></source>
        </trans-unit>
        <trans-unit id="162" translate="yes" xml:space="preserve">
          <source>See also</source>
        </trans-unit>
        <trans-unit id="163" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>ICLRMetaHostPolicy Interface<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/iclrmetahostpolicy-interface.md)</ept></source>
        </trans-unit>
        <trans-unit id="164" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>CLR Hosting Interfaces Added in the .NET Framework 4 and 4.5<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/clr-hosting-interfaces-added-in-the-net-framework-4-and-4-5.md)</ept></source>
        </trans-unit>
        <trans-unit id="165" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Hosting Interfaces<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)</ept></source>
        </trans-unit>
        <trans-unit id="166" translate="yes" xml:space="preserve">
          <source><bpt id="p1">[</bpt>Hosting<ept id="p1">](../../../../docs/framework/unmanaged-api/hosting/index.md)</ept></source>
        </trans-unit>
      </group>
    </body>
  </file>
</xliff>