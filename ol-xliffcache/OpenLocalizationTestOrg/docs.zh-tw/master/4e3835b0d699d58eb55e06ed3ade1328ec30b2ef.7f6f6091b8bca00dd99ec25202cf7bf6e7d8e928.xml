{"content":"---\ntitle: \"How to: Export Custom Policy Assertions\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 99030386-43b0-4f7b-866d-17ea307f5cbd\n---\n# How to: Export Custom Policy Assertions\nPolicy assertions describe the capabilities and requirements of a service endpoint. Service applications can use custom policy assertions in service metadata to communicate endpoint, binding or contract customization information to the client application. You can use Windows Communication Foundation (WCF) to export assertions in policy expressions attached in WSDL bindings at the endpoint, operation, or message subjects, depending upon the capabilities or requirements you are communicating.  \n  \n Custom policy assertions are exported by implementing the <xref:System.ServiceModel.Description.IPolicyExportExtension?displayProperty=nameWithType> interface on a <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType> and either inserting the binding element directly into the binding of the service endpoint or by registering the binding element in your application configuration file. Your policy export implementation should add your custom policy assertion as a <xref:System.Xml.XmlElement?displayProperty=nameWithType> instance to the appropriate <xref:System.ServiceModel.Description.PolicyAssertionCollection?displayProperty=nameWithType> on the <xref:System.ServiceModel.Description.PolicyConversionContext?displayProperty=nameWithType> passed into the <xref:System.ServiceModel.Description.IPolicyExportExtension.ExportPolicy%2A> method.  \n  \n In addition you must check the <xref:System.ServiceModel.Description.MetadataExporter.PolicyVersion%2A> property of the <xref:System.ServiceModel.Description.WsdlExporter> class and export nested policy expressions and policy framework attributes in the correct namespace based on the policy version specified.  \n  \n To import custom policy assertions, see <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> and [How to: Import Custom Policy Assertions](../../../../docs/framework/wcf/extending/how-to-import-custom-policy-assertions.md).  \n  \n### To export custom policy assertions  \n  \n1.  Implement the <xref:System.ServiceModel.Description.IPolicyExportExtension?displayProperty=nameWithType> interface on a <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType>. The following code example shows the implementation of a custom policy assertion at the binding level.  \n  \n     [!code-csharp[CustomPolicySample#14](../../../../samples/snippets/csharp/VS_Snippets_CFX/custompolicysample/cs/policyexporter.cs#14)]\n     [!code-vb[CustomPolicySample#14](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/custompolicysample/vb/policyexporter.vb#14)]  \n  \n2.  Insert the binding element into the endpoint binding either programmatically or using an application configuration file. See the following procedures.  \n  \n### To insert a binding element using an application configuration file  \n  \n1.  Implement <xref:System.ServiceModel.Configuration.BindingElementExtensionElement?displayProperty=nameWithType> for your custom policy assertion binding element.  \n  \n2.  Add the binding element extension to the configuration file using the [\\<bindingElementExtensions>](../../../../docs/framework/configure-apps/file-schema/wcf/bindingelementextensions.md) element.  \n  \n3.  Build a custom binding using the <xref:System.ServiceModel.Channels.CustomBinding?displayProperty=nameWithType>.  \n  \n### To insert a binding element programmatically  \n  \n1.  Create a new <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType> and add it to a <xref:System.ServiceModel.Channels.CustomBinding?displayProperty=nameWithType>.  \n  \n2.  Add the custom binding from step 1. to a new endpoint and add that new service endpoint to the <xref:System.ServiceModel.ServiceHost?displayProperty=nameWithType> by calling the <xref:System.ServiceModel.ServiceHost.AddServiceEndpoint%2A> method.  \n  \n3.  Open the <xref:System.ServiceModel.ServiceHost>. The following code example shows the creation of a custom binding and the programmatic insertion of binding elements.  \n  \n     [!code-csharp[s_imperative#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/s_imperative/cs/service.cs#1)]\n     [!code-vb[s_imperative#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/s_imperative/vb/service.vb#1)]  \n  \n## See also\n\n- <xref:System.ServiceModel.Description.IPolicyImportExtension>\n- <xref:System.ServiceModel.Description.IPolicyExportExtension>\n- [How to: Import Custom Policy Assertions](../../../../docs/framework/wcf/extending/how-to-import-custom-policy-assertions.md)\n","nodes":[{"pos":[4,157],"embed":true,"restype":"x-metadata","content":"title: \"How to: Export Custom Policy Assertions\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 99030386-43b0-4f7b-866d-17ea307f5cbd","nodes":[{"content":"How to: Export Custom Policy Assertions","nodes":[{"pos":[0,39],"content":"How to: Export Custom Policy Assertions","nodes":[{"content":"How to: Export Custom Policy Assertions","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[164,203],"content":"How to: Export Custom Policy Assertions","linkify":"How to: Export Custom Policy Assertions","nodes":[{"content":"How to: Export Custom Policy Assertions","pos":[0,39]}]},{"content":"Policy assertions describe the capabilities and requirements of a service endpoint.","pos":[204,287]},{"content":"Service applications can use custom policy assertions in service metadata to communicate endpoint, binding or contract customization information to the client application.","pos":[288,459]},{"content":"You can use Windows Communication Foundation (WCF) to export assertions in policy expressions attached in WSDL bindings at the endpoint, operation, or message subjects, depending upon the capabilities or requirements you are communicating.","pos":[460,699]},{"content":"Custom policy assertions are exported by implementing the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.IPolicyExportExtension?displayProperty=nameWithType&gt;</ph> interface on a <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType&gt;</ph> and either inserting the binding element directly into the binding of the service endpoint or by registering the binding element in your application configuration file.","pos":[706,1118],"source":"Custom policy assertions are exported by implementing the <xref:System.ServiceModel.Description.IPolicyExportExtension?displayProperty=nameWithType> interface on a <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType> and either inserting the binding element directly into the binding of the service endpoint or by registering the binding element in your application configuration file."},{"content":"Your policy export implementation should add your custom policy assertion as a <ph id=\"ph1\">&lt;xref:System.Xml.XmlElement?displayProperty=nameWithType&gt;</ph> instance to the appropriate <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.PolicyAssertionCollection?displayProperty=nameWithType&gt;</ph> on the <ph id=\"ph3\">&lt;xref:System.ServiceModel.Description.PolicyConversionContext?displayProperty=nameWithType&gt;</ph> passed into the <ph id=\"ph4\">&lt;xref:System.ServiceModel.Description.IPolicyExportExtension.ExportPolicy%2A&gt;</ph> method.","pos":[1119,1578],"source":" Your policy export implementation should add your custom policy assertion as a <xref:System.Xml.XmlElement?displayProperty=nameWithType> instance to the appropriate <xref:System.ServiceModel.Description.PolicyAssertionCollection?displayProperty=nameWithType> on the <xref:System.ServiceModel.Description.PolicyConversionContext?displayProperty=nameWithType> passed into the <xref:System.ServiceModel.Description.IPolicyExportExtension.ExportPolicy%2A> method."},{"pos":[1585,1895],"content":"In addition you must check the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.MetadataExporter.PolicyVersion%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Description.WsdlExporter&gt;</ph> class and export nested policy expressions and policy framework attributes in the correct namespace based on the policy version specified.","source":"In addition you must check the <xref:System.ServiceModel.Description.MetadataExporter.PolicyVersion%2A> property of the <xref:System.ServiceModel.Description.WsdlExporter> class and export nested policy expressions and policy framework attributes in the correct namespace based on the policy version specified."},{"pos":[1902,2163],"content":"To import custom policy assertions, see <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType&gt;</ph> and <bpt id=\"p1\">[</bpt>How to: Import Custom Policy Assertions<ept id=\"p1\">](../../../../docs/framework/wcf/extending/how-to-import-custom-policy-assertions.md)</ept>.","source":"To import custom policy assertions, see <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> and [How to: Import Custom Policy Assertions](../../../../docs/framework/wcf/extending/how-to-import-custom-policy-assertions.md)."},{"pos":[2173,2207],"content":"To export custom policy assertions","linkify":"To export custom policy assertions","nodes":[{"content":"To export custom policy assertions","pos":[0,34]}]},{"content":"Implement the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.IPolicyExportExtension?displayProperty=nameWithType&gt;</ph> interface on a <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType&gt;</ph>.","pos":[2217,2417],"source":"Implement the <xref:System.ServiceModel.Description.IPolicyExportExtension?displayProperty=nameWithType> interface on a <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType>."},{"content":"The following code example shows the implementation of a custom policy assertion at the binding level.","pos":[2418,2520]},{"pos":[2531,2804],"content":"[!code-csharp[CustomPolicySample#14](../../../../samples/snippets/csharp/VS_Snippets_CFX/custompolicysample/cs/policyexporter.cs#14)]\n [!code-vb[CustomPolicySample#14](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/custompolicysample/vb/policyexporter.vb#14)]","leadings":["","    "],"nodes":[]},{"content":"Insert the binding element into the endpoint binding either programmatically or using an application configuration file.","pos":[2814,2934]},{"content":"See the following procedures.","pos":[2935,2964]},{"pos":[2974,3041],"content":"To insert a binding element using an application configuration file","linkify":"To insert a binding element using an application configuration file","nodes":[{"content":"To insert a binding element using an application configuration file","pos":[0,67]}]},{"pos":[3051,3211],"content":"Implement <ph id=\"ph1\">&lt;xref:System.ServiceModel.Configuration.BindingElementExtensionElement?displayProperty=nameWithType&gt;</ph> for your custom policy assertion binding element.","source":"Implement <xref:System.ServiceModel.Configuration.BindingElementExtensionElement?displayProperty=nameWithType> for your custom policy assertion binding element."},{"pos":[3221,3416],"content":"Add the binding element extension to the configuration file using the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>bindingElementExtensions&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/bindingelementextensions.md)</ept> element.","source":"Add the binding element extension to the configuration file using the [\\<bindingElementExtensions>](../../../../docs/framework/configure-apps/file-schema/wcf/bindingelementextensions.md) element."},{"pos":[3426,3538],"content":"Build a custom binding using the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.CustomBinding?displayProperty=nameWithType&gt;</ph>.","source":"Build a custom binding using the <xref:System.ServiceModel.Channels.CustomBinding?displayProperty=nameWithType>."},{"pos":[3548,3592],"content":"To insert a binding element programmatically","linkify":"To insert a binding element programmatically","nodes":[{"content":"To insert a binding element programmatically","pos":[0,44]}]},{"pos":[3602,3790],"content":"Create a new <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType&gt;</ph> and add it to a <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.CustomBinding?displayProperty=nameWithType&gt;</ph>.","source":"Create a new <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType> and add it to a <xref:System.ServiceModel.Channels.CustomBinding?displayProperty=nameWithType>."},{"content":"Add the custom binding from step 1.","pos":[3800,3835]},{"content":"to a new endpoint and add that new service endpoint to the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceHost?displayProperty=nameWithType&gt;</ph> by calling the <ph id=\"ph2\">&lt;xref:System.ServiceModel.ServiceHost.AddServiceEndpoint%2A&gt;</ph> method.","pos":[3836,4046],"source":" to a new endpoint and add that new service endpoint to the <xref:System.ServiceModel.ServiceHost?displayProperty=nameWithType> by calling the <xref:System.ServiceModel.ServiceHost.AddServiceEndpoint%2A> method."},{"content":"Open the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceHost&gt;</ph>.","pos":[4056,4104],"source":"Open the <xref:System.ServiceModel.ServiceHost>."},{"content":"The following code example shows the creation of a custom binding and the programmatic insertion of binding elements.","pos":[4105,4222]},{"pos":[4233,4464],"content":"[!code-csharp[s_imperative#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/s_imperative/cs/service.cs#1)]\n [!code-vb[s_imperative#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/s_imperative/vb/service.vb#1)]","leadings":["","    "],"nodes":[]},{"pos":[4473,4481],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4613,4738],"content":"<bpt id=\"p1\">[</bpt>How to: Import Custom Policy Assertions<ept id=\"p1\">](../../../../docs/framework/wcf/extending/how-to-import-custom-policy-assertions.md)</ept>","source":"[How to: Import Custom Policy Assertions](../../../../docs/framework/wcf/extending/how-to-import-custom-policy-assertions.md)"}]}