{"content":"---\ntitle: \"gcUnmanagedToManaged MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"MDAs (managed debugging assistants), garbage collection\"\n  - \"GC unmanaged to managed\"\n  - \"transitioning threads unmanaged to managed code\"\n  - \"GcUnmanagedToManaged MDA\"\n  - \"threading [.NET Framework], garbage collection\"\n  - \"managed debugging assistants (MDAs), garbage collection\"\n  - \"threading [.NET Framework], managed debugging assistants\"\n  - \"garbage collection, run-time errors\"\n  - \"unmanaged to managed garbage collection\"\nms.assetid: 103eb3a3-1cf0-4406-8a9a-a7798fdc22d1\ncaps.latest.revision: 14\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# gcUnmanagedToManaged MDA\nThe `gcUnmanagedToManaged` managed debugging assistant (MDA) causes a garbage collection whenever a thread transitions from unmanaged to managed code.  \n  \n## Symptoms  \n An application running unmanaged user components using COM and platform invoke is causing a nondeterministic access violation in the CLR.  \n  \n## Cause  \n If an application is running unmanaged user components, then those components might have corrupted the garbage-collected heap. This causes an access violation in the CLR when the garbage collector tries to walk the object graph.  \n  \n## Resolution  \n Enabling this assistant reduces the time between when the unmanaged component corrupts the garbage-collected heap and when the access violation happens by forcing a garbage collection to occur before every managed transition.  \n  \n## Effect on the Runtime  \n Causes a garbage collection whenever a thread transitions from unmanaged to managed code.  \n  \n## Output  \n This MDA produces no output.  \n  \n## Configuration  \n  \n```  \n<mdaConfig>  \n  <assistants>  \n    <gcUnmanagedToManaged/>  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## See Also  \n <xref:System.Runtime.InteropServices.MarshalAsAttribute>   \n [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)   \n [gcManagedToUnmanaged](../../../docs/framework/debug-trace-profile/gcmanagedtounmanaged-mda.md)   \n [Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)","nodes":[{"pos":[4,869],"embed":true,"restype":"x-metadata","content":"title: \"gcUnmanagedToManaged MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"MDAs (managed debugging assistants), garbage collection\"\n  - \"GC unmanaged to managed\"\n  - \"transitioning threads unmanaged to managed code\"\n  - \"GcUnmanagedToManaged MDA\"\n  - \"threading [.NET Framework], garbage collection\"\n  - \"managed debugging assistants (MDAs), garbage collection\"\n  - \"threading [.NET Framework], managed debugging assistants\"\n  - \"garbage collection, run-time errors\"\n  - \"unmanaged to managed garbage collection\"\nms.assetid: 103eb3a3-1cf0-4406-8a9a-a7798fdc22d1\ncaps.latest.revision: 14\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","nodes":[{"content":"gcUnmanagedToManaged MDA | Microsoft Docs","nodes":[{"pos":[0,41],"content":"gcUnmanagedToManaged MDA | Microsoft Docs","nodes":[{"content":"gcUnmanagedToManaged MDA | Microsoft Docs","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[876,900],"content":"gcUnmanagedToManaged MDA","linkify":"gcUnmanagedToManaged MDA","nodes":[{"content":"gcUnmanagedToManaged MDA","pos":[0,24]}]},{"pos":[901,1051],"content":"The <ph id=\"ph1\">`gcUnmanagedToManaged`</ph> managed debugging assistant (MDA) causes a garbage collection whenever a thread transitions from unmanaged to managed code.","source":"The `gcUnmanagedToManaged` managed debugging assistant (MDA) causes a garbage collection whenever a thread transitions from unmanaged to managed code."},{"pos":[1060,1068],"content":"Symptoms","linkify":"Symptoms","nodes":[{"content":"Symptoms","pos":[0,8]}]},{"content":"An application running unmanaged user components using COM and platform invoke is causing a nondeterministic access violation in the CLR.","pos":[1072,1209]},{"pos":[1218,1223],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"content":"If an application is running unmanaged user components, then those components might have corrupted the garbage-collected heap.","pos":[1227,1353]},{"content":"This causes an access violation in the CLR when the garbage collector tries to walk the object graph.","pos":[1354,1455]},{"pos":[1464,1474],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"content":"Enabling this assistant reduces the time between when the unmanaged component corrupts the garbage-collected heap and when the access violation happens by forcing a garbage collection to occur before every managed transition.","pos":[1478,1703]},{"pos":[1712,1733],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"content":"Causes a garbage collection whenever a thread transitions from unmanaged to managed code.","pos":[1737,1826]},{"pos":[1835,1841],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"This MDA produces no output.","pos":[1845,1873]},{"pos":[1882,1895],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[2013,2021],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept><ph id=\"ph1\"> </ph>","pos":[2086,2240],"source":"[Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md) "},{"content":"<bpt id=\"p1\">[</bpt>gcManagedToUnmanaged<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/gcmanagedtounmanaged-mda.md)</ept><ph id=\"ph1\"> </ph>","pos":[2244,2340],"source":"[gcManagedToUnmanaged](../../../docs/framework/debug-trace-profile/gcmanagedtounmanaged-mda.md) "},{"content":"<bpt id=\"p1\">[</bpt>Interop Marshaling<ept id=\"p1\">](../../../docs/framework/interop/interop-marshaling.md)</ept>","pos":[2344,2419],"source":"[Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)"}]}