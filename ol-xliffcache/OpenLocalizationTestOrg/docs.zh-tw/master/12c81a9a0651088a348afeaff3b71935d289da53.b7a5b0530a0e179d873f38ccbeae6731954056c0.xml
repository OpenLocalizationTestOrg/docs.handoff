{"content":"---\ntitle: \"Shared (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.Shared\"\nhelpviewer_keywords: \n  - \"Shared keyword [Visual Basic]\"\n  - \"members [Visual Basic], shared\"\n  - \"shared members\"\n  - \"nonshared\"\n  - \"shared [elements VB]\"\n  - \"elements [Visual Basic], shared\"\nms.assetid: 2bf7cf2c-b0dd-485e-8749-b5d674dab4cd\n---\n# Shared (Visual Basic)\nSpecifies that one or more declared programming elements are associated with a class or structure at large, and not with a specific instance of the class or structure.  \n  \n## Remarks  \n  \n## When to Use Shared  \n Sharing a member of a class or structure makes it available to every instance, rather than *nonshared*, where each instance keeps its own copy. This is useful, for example, if the value of a variable applies to the entire application. If you declare that variable to be `Shared`, then all instances access the same storage location, and if one instance changes the variable's value, all instances access the updated value.  \n  \n Sharing does not alter the access level of a member. For example, a class member can be shared and private (accessible only from within the class), or nonshared and public. For more information, see [Access levels in Visual Basic](../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md).  \n  \n## Rules  \n  \n-   **Declaration Context.** You can use `Shared` only at module level. This means the declaration context for a `Shared` element must be a class or structure, and cannot be a source file, namespace, or procedure.  \n  \n-   **Combined Modifiers.** You cannot specify `Shared` together with [Overrides](../../../visual-basic/language-reference/modifiers/overrides.md), [Overridable](../../../visual-basic/language-reference/modifiers/overridable.md), [NotOverridable](../../../visual-basic/language-reference/modifiers/notoverridable.md), [MustOverride](../../../visual-basic/language-reference/modifiers/mustoverride.md), or [Static](../../../visual-basic/language-reference/modifiers/static.md) in the same declaration.  \n  \n-   **Accessing.** You access a shared element by qualifying it with its class or structure name, not with the variable name of a specific instance of its class or structure. You do not even have to create an instance of a class or structure to access its shared members.  \n  \n     The following example calls the shared procedure <xref:System.Double.IsNaN%2A> exposed by the <xref:System.Double> structure.  \n  \n     `If Double.IsNaN(result) Then MsgBox(\"Result is mathematically undefined.\")`  \n  \n-   **Implicit Sharing.** You cannot use the `Shared` modifier in a [Const Statement](../../../visual-basic/language-reference/statements/const-statement.md), but constants are implicitly shared. Similarly, you cannot declare a member of a module or an interface to be `Shared`, but they are implicitly shared.  \n  \n## Behavior  \n  \n-   **Storage.** A shared variable or event is stored in memory only once, no matter how many or few instances you create of its class or structure. Similarly, a shared procedure or property holds only one set of local variables.  \n  \n-   **Accessing through an Instance Variable.** It is possible to access a shared element by qualifying it with the name of a variable that contains a specific instance of its class or structure. Although this usually works as expected, the compiler generates a warning message and makes the access through the class or structure name instead of the variable.  \n  \n-   **Accessing through an Instance Expression.** If you access a shared element through an expression that returns an instance of its class or structure, the compiler makes the access through the class or structure name instead of evaluating the expression. This produces unexpected results if you intended the expression to perform other actions as well as returning the instance. The following example illustrates this.  \n  \n    ```vb\n    Sub main()  \n        shareTotal.total = 10  \n        ' The preceding line is the preferred way to access total.  \n        Dim instanceVar As New shareTotal  \n        instanceVar.total += 100  \n        ' The preceding line generates a compiler warning message and  \n        ' accesses total through class shareTotal instead of through  \n        ' the variable instanceVar. This works as expected and adds  \n        ' 100 to total.  \n        returnClass().total += 1000  \n        ' The preceding line generates a compiler warning message and  \n        ' accesses total through class shareTotal instead of calling  \n        ' returnClass(). This adds 1000 to total but does not work as  \n        ' expected, because the MsgBox in returnClass() does not run.  \n        MsgBox(\"Value of total is \" & CStr(shareTotal.total))  \n    End Sub  \n    Public Function returnClass() As shareTotal  \n        MsgBox(\"Function returnClass() called\")  \n        Return New shareTotal  \n    End Function  \n    Public Class shareTotal  \n        Public Shared total As Integer  \n    End Class  \n    ```  \n  \n     In the preceding example, the compiler generates a warning message both times the code accesses the shared variable `total` through an instance. In each case it makes the access directly through the class `shareTotal` and does not make use of any instance. In the case of the intended call to the procedure `returnClass`, this means it does not even generate a call to `returnClass`, so the additional action of displaying \"Function returnClass() called\" is not performed.  \n  \n The `Shared` modifier can be used in these contexts:  \n  \n [Dim Statement](../../../visual-basic/language-reference/statements/dim-statement.md)  \n  \n [Event Statement](../../../visual-basic/language-reference/statements/event-statement.md)  \n  \n [Function Statement](../../../visual-basic/language-reference/statements/function-statement.md)  \n  \n [Operator Statement](../../../visual-basic/language-reference/statements/operator-statement.md)  \n  \n [Property Statement](../../../visual-basic/language-reference/statements/property-statement.md)  \n  \n [Sub Statement](../../../visual-basic/language-reference/statements/sub-statement.md)  \n  \n## See also\n\n- [Shadows](../../../visual-basic/language-reference/modifiers/shadows.md)\n- [Static](../../../visual-basic/language-reference/modifiers/static.md)\n- [Lifetime in Visual Basic](../../../visual-basic/programming-guide/language-features/declared-elements/lifetime.md)\n- [Procedures](../../../visual-basic/programming-guide/language-features/procedures/index.md)\n- [Structures](../../../visual-basic/programming-guide/language-features/data-types/structures.md)\n- [Objects and Classes](../../../visual-basic/programming-guide/language-features/objects-and-classes/index.md)\n","nodes":[{"pos":[4,330],"embed":true,"restype":"x-metadata","content":"title: \"Shared (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.Shared\"\nhelpviewer_keywords: \n  - \"Shared keyword [Visual Basic]\"\n  - \"members [Visual Basic], shared\"\n  - \"shared members\"\n  - \"nonshared\"\n  - \"shared [elements VB]\"\n  - \"elements [Visual Basic], shared\"\nms.assetid: 2bf7cf2c-b0dd-485e-8749-b5d674dab4cd","nodes":[{"content":"Shared (Visual Basic)","nodes":[{"pos":[0,21],"content":"Shared (Visual Basic)","nodes":[{"content":"Shared (Visual Basic)","pos":[0,21]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[337,358],"content":"Shared (Visual Basic)","linkify":"Shared (Visual Basic)","nodes":[{"content":"Shared (Visual Basic)","pos":[0,21]}]},{"content":"Specifies that one or more declared programming elements are associated with a class or structure at large, and not with a specific instance of the class or structure.","pos":[359,526]},{"pos":[535,542],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[551,569],"content":"When to Use Shared","linkify":"When to Use Shared","nodes":[{"content":"When to Use Shared","pos":[0,18]}]},{"content":"Sharing a member of a class or structure makes it available to every instance, rather than <bpt id=\"p1\">*</bpt>nonshared<ept id=\"p1\">*</ept>, where each instance keeps its own copy.","pos":[573,716],"source":"Sharing a member of a class or structure makes it available to every instance, rather than *nonshared*, where each instance keeps its own copy."},{"content":"This is useful, for example, if the value of a variable applies to the entire application.","pos":[717,807]},{"content":"If you declare that variable to be <ph id=\"ph1\">`Shared`</ph>, then all instances access the same storage location, and if one instance changes the variable's value, all instances access the updated value.","pos":[808,995],"source":" If you declare that variable to be `Shared`, then all instances access the same storage location, and if one instance changes the variable's value, all instances access the updated value."},{"content":"Sharing does not alter the access level of a member.","pos":[1002,1054]},{"content":"For example, a class member can be shared and private (accessible only from within the class), or nonshared and public.","pos":[1055,1174]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Access levels in Visual Basic<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)</ept>.","pos":[1175,1327],"source":" For more information, see [Access levels in Visual Basic](../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)."},{"pos":[1336,1341],"content":"Rules","linkify":"Rules","nodes":[{"content":"Rules","pos":[0,5]}]},{"content":"<bpt id=\"p1\">**</bpt>Declaration Context.<ept id=\"p1\">**</ept>","pos":[1351,1375],"source":"**Declaration Context.**"},{"content":"You can use <ph id=\"ph1\">`Shared`</ph> only at module level.","pos":[1376,1418],"source":" You can use `Shared` only at module level."},{"content":"This means the declaration context for a <ph id=\"ph1\">`Shared`</ph> element must be a class or structure, and cannot be a source file, namespace, or procedure.","pos":[1419,1560],"source":" This means the declaration context for a `Shared` element must be a class or structure, and cannot be a source file, namespace, or procedure."},{"content":"<bpt id=\"p1\">**</bpt>Combined Modifiers.<ept id=\"p1\">**</ept>","pos":[1570,1593],"source":"**Combined Modifiers.**"},{"content":"You cannot specify <ph id=\"ph1\">`Shared`</ph> together with <bpt id=\"p1\">[</bpt>Overrides<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/overrides.md)</ept>, <bpt id=\"p2\">[</bpt>Overridable<ept id=\"p2\">](../../../visual-basic/language-reference/modifiers/overridable.md)</ept>, <bpt id=\"p3\">[</bpt>NotOverridable<ept id=\"p3\">](../../../visual-basic/language-reference/modifiers/notoverridable.md)</ept>, <bpt id=\"p4\">[</bpt>MustOverride<ept id=\"p4\">](../../../visual-basic/language-reference/modifiers/mustoverride.md)</ept>, or <bpt id=\"p5\">[</bpt>Static<ept id=\"p5\">](../../../visual-basic/language-reference/modifiers/static.md)</ept> in the same declaration.","pos":[1594,2066],"source":" You cannot specify `Shared` together with [Overrides](../../../visual-basic/language-reference/modifiers/overrides.md), [Overridable](../../../visual-basic/language-reference/modifiers/overridable.md), [NotOverridable](../../../visual-basic/language-reference/modifiers/notoverridable.md), [MustOverride](../../../visual-basic/language-reference/modifiers/mustoverride.md), or [Static](../../../visual-basic/language-reference/modifiers/static.md) in the same declaration."},{"content":"<bpt id=\"p1\">**</bpt>Accessing.<ept id=\"p1\">**</ept>","pos":[2076,2090],"source":"**Accessing.**"},{"content":"You access a shared element by qualifying it with its class or structure name, not with the variable name of a specific instance of its class or structure.","pos":[2091,2246]},{"content":"You do not even have to create an instance of a class or structure to access its shared members.","pos":[2247,2343]},{"pos":[2354,2479],"content":"The following example calls the shared procedure <ph id=\"ph1\">&lt;xref:System.Double.IsNaN%2A&gt;</ph> exposed by the <ph id=\"ph2\">&lt;xref:System.Double&gt;</ph> structure.","source":"The following example calls the shared procedure <xref:System.Double.IsNaN%2A> exposed by the <xref:System.Double> structure."},{"content":"<bpt id=\"p1\">**</bpt>Implicit Sharing.<ept id=\"p1\">**</ept>","pos":[2576,2597],"source":"**Implicit Sharing.**"},{"content":"You cannot use the <ph id=\"ph1\">`Shared`</ph> modifier in a <bpt id=\"p1\">[</bpt>Const Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/const-statement.md)</ept>, but constants are implicitly shared.","pos":[2598,2767],"source":" You cannot use the `Shared` modifier in a [Const Statement](../../../visual-basic/language-reference/statements/const-statement.md), but constants are implicitly shared."},{"content":"Similarly, you cannot declare a member of a module or an interface to be <ph id=\"ph1\">`Shared`</ph>, but they are implicitly shared.","pos":[2768,2882],"source":" Similarly, you cannot declare a member of a module or an interface to be `Shared`, but they are implicitly shared."},{"pos":[2891,2899],"content":"Behavior","linkify":"Behavior","nodes":[{"content":"Behavior","pos":[0,8]}]},{"content":"<bpt id=\"p1\">**</bpt>Storage.<ept id=\"p1\">**</ept>","pos":[2909,2921],"source":"**Storage.**"},{"content":"A shared variable or event is stored in memory only once, no matter how many or few instances you create of its class or structure.","pos":[2922,3053]},{"content":"Similarly, a shared procedure or property holds only one set of local variables.","pos":[3054,3134]},{"content":"<bpt id=\"p1\">**</bpt>Accessing through an Instance Variable.<ept id=\"p1\">**</ept>","pos":[3144,3187],"source":"**Accessing through an Instance Variable.**"},{"content":"It is possible to access a shared element by qualifying it with the name of a variable that contains a specific instance of its class or structure.","pos":[3188,3335]},{"content":"Although this usually works as expected, the compiler generates a warning message and makes the access through the class or structure name instead of the variable.","pos":[3336,3499]},{"content":"<bpt id=\"p1\">**</bpt>Accessing through an Instance Expression.<ept id=\"p1\">**</ept>","pos":[3509,3554],"source":"**Accessing through an Instance Expression.**"},{"content":"If you access a shared element through an expression that returns an instance of its class or structure, the compiler makes the access through the class or structure name instead of evaluating the expression.","pos":[3555,3763]},{"content":"This produces unexpected results if you intended the expression to perform other actions as well as returning the instance.","pos":[3764,3887]},{"content":"The following example illustrates this.","pos":[3888,3927]},{"content":"In the preceding example, the compiler generates a warning message both times the code accesses the shared variable <ph id=\"ph1\">`total`</ph> through an instance.","pos":[5038,5182],"source":"In the preceding example, the compiler generates a warning message both times the code accesses the shared variable `total` through an instance."},{"content":"In each case it makes the access directly through the class <ph id=\"ph1\">`shareTotal`</ph> and does not make use of any instance.","pos":[5183,5294],"source":" In each case it makes the access directly through the class `shareTotal` and does not make use of any instance."},{"content":"In the case of the intended call to the procedure <ph id=\"ph1\">`returnClass`</ph>, this means it does not even generate a call to <ph id=\"ph2\">`returnClass`</ph>, so the additional action of displaying \"Function returnClass() called\" is not performed.","pos":[5295,5510],"source":" In the case of the intended call to the procedure `returnClass`, this means it does not even generate a call to `returnClass`, so the additional action of displaying \"Function returnClass() called\" is not performed."},{"pos":[5517,5569],"content":"The <ph id=\"ph1\">`Shared`</ph> modifier can be used in these contexts:","source":"The `Shared` modifier can be used in these contexts:"},{"pos":[5576,5661],"content":"<bpt id=\"p1\">[</bpt>Dim Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/dim-statement.md)</ept>","source":"[Dim Statement](../../../visual-basic/language-reference/statements/dim-statement.md)"},{"pos":[5668,5757],"content":"<bpt id=\"p1\">[</bpt>Event Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/event-statement.md)</ept>","source":"[Event Statement](../../../visual-basic/language-reference/statements/event-statement.md)"},{"pos":[5764,5859],"content":"<bpt id=\"p1\">[</bpt>Function Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/function-statement.md)</ept>","source":"[Function Statement](../../../visual-basic/language-reference/statements/function-statement.md)"},{"pos":[5866,5961],"content":"<bpt id=\"p1\">[</bpt>Operator Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/operator-statement.md)</ept>","source":"[Operator Statement](../../../visual-basic/language-reference/statements/operator-statement.md)"},{"pos":[5968,6063],"content":"<bpt id=\"p1\">[</bpt>Property Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/property-statement.md)</ept>","source":"[Property Statement](../../../visual-basic/language-reference/statements/property-statement.md)"},{"pos":[6070,6155],"content":"<bpt id=\"p1\">[</bpt>Sub Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/sub-statement.md)</ept>","source":"[Sub Statement](../../../visual-basic/language-reference/statements/sub-statement.md)"},{"pos":[6164,6172],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6176,6248],"content":"<bpt id=\"p1\">[</bpt>Shadows<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/shadows.md)</ept>","source":"[Shadows](../../../visual-basic/language-reference/modifiers/shadows.md)"},{"pos":[6251,6321],"content":"<bpt id=\"p1\">[</bpt>Static<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/static.md)</ept>","source":"[Static](../../../visual-basic/language-reference/modifiers/static.md)"},{"pos":[6324,6439],"content":"<bpt id=\"p1\">[</bpt>Lifetime in Visual Basic<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/declared-elements/lifetime.md)</ept>","source":"[Lifetime in Visual Basic](../../../visual-basic/programming-guide/language-features/declared-elements/lifetime.md)"},{"pos":[6442,6533],"content":"<bpt id=\"p1\">[</bpt>Procedures<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/index.md)</ept>","source":"[Procedures](../../../visual-basic/programming-guide/language-features/procedures/index.md)"},{"pos":[6536,6632],"content":"<bpt id=\"p1\">[</bpt>Structures<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/structures.md)</ept>","source":"[Structures](../../../visual-basic/programming-guide/language-features/data-types/structures.md)"},{"pos":[6635,6744],"content":"<bpt id=\"p1\">[</bpt>Objects and Classes<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/objects-and-classes/index.md)</ept>","source":"[Objects and Classes](../../../visual-basic/programming-guide/language-features/objects-and-classes/index.md)"}]}