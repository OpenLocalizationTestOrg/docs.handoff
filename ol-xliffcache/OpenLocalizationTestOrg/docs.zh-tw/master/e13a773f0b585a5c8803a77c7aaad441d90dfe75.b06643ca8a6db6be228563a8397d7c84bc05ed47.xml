{"content":"---\ntitle: \"Key (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.AnonymousKey\"\nhelpviewer_keywords: \n  - \"anonymous types [Visual Basic], key\"\n  - \"Key [Visual Basic]\"\n  - \"Key keyword [Visual Basic]\"\nms.assetid: 7697a928-7d14-4430-a72a-c9e96e8d6c11\n---\n# Key (Visual Basic)\nThe `Key` keyword enables you to specify behavior for properties of anonymous types. Only properties you designate as key properties participate in tests of equality between anonymous type instances, or calculation of hash code values. The values of key properties cannot be changed.  \n  \n You designate a property of an anonymous type as a key property by placing the keyword `Key` in front of its declaration in the initialization list. In the following example, `Airline` and `FlightNo` are key properties, but `Gate` is not.  \n  \n [!code-vb[VbVbalrAnonymousTypes#26](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#26)]  \n  \n When a new anonymous type is created, it inherits directly from <xref:System.Object>. The compiler overrides three inherited members: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>. The override code that is produced for <xref:System.Object.Equals%2A> and <xref:System.Object.GetHashCode%2A> is based on key properties. If there are no key properties in the type, <xref:System.Object.GetHashCode%2A> and <xref:System.Object.Equals%2A> are not overridden.  \n  \n## Equality  \n Two anonymous type instances are equal if they are instances of the same type and if the values of their key properties are equal. In the following examples, `flight2` is equal to `flight1` from the previous example because they are instances of the same anonymous type and they have matching values for their key properties. However, `flight3` is not equal to `flight1` because it has a different value for a key property, `FlightNo`. Instance `flight4` is not the same type as `flight1` because they designate different properties as key properties.  \n  \n [!code-vb[VbVbalrAnonymousTypes#27](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#27)]  \n  \n If two instances are declared with only non-key properties, identical in name, type, order, and value, the two instances are not equal. An instance without key properties is equal only to itself.  \n  \n For more information about the conditions under which two anonymous type instances are instances of the same anonymous type, see [Anonymous Types](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md).  \n  \n## Hash Code Calculation  \n Like <xref:System.Object.Equals%2A>, the hash function that is defined in <xref:System.Object.GetHashCode%2A> for an anonymous type is based on the key properties of the type. The following examples show the interaction between key properties and hash code values.  \n  \n Instances of an anonymous type that have the same values for all key properties have the same hash code value, even if non-key properties do not have matching values. The following statement returns `True`.  \n  \n [!code-vb[VbVbalrAnonymousTypes#37](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#37)]  \n  \n Instances of an anonymous type that have different values for one or more key properties have different hash code values. The following statement returns `False`.  \n  \n [!code-vb[VbVbalrAnonymousTypes#38](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#38)]  \n  \n Instances of anonymous types that designate different properties as key properties are not instances of the same type. They have different hash code values even when the names and values of all properties are the same. The following statement returns `False`.  \n  \n [!code-vb[VbVbalrAnonymousTypes#39](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#39)]  \n  \n## Read-Only Values  \n The values of key properties cannot be changed. For example, in `flight1` in the earlier examples, the `Airline` and `FlightNo` fields are read-only, but `Gate` can be changed.  \n  \n [!code-vb[VbVbalrAnonymousTypes#28](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#28)]  \n  \n## See also\n\n- [Anonymous Type Definition](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)\n- [How to: Infer Property Names and Types in Anonymous Type Declarations](../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)\n- [Anonymous Types](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)\n","nodes":[{"pos":[4,258],"embed":true,"restype":"x-metadata","content":"title: \"Key (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.AnonymousKey\"\nhelpviewer_keywords: \n  - \"anonymous types [Visual Basic], key\"\n  - \"Key [Visual Basic]\"\n  - \"Key keyword [Visual Basic]\"\nms.assetid: 7697a928-7d14-4430-a72a-c9e96e8d6c11","nodes":[{"content":"Key (Visual Basic)","nodes":[{"pos":[0,18],"content":"Key (Visual Basic)","nodes":[{"content":"Key (Visual Basic)","pos":[0,18]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[265,283],"content":"Key (Visual Basic)","linkify":"Key (Visual Basic)","nodes":[{"content":"Key (Visual Basic)","pos":[0,18]}]},{"content":"The <ph id=\"ph1\">`Key`</ph> keyword enables you to specify behavior for properties of anonymous types.","pos":[284,368],"source":"The `Key` keyword enables you to specify behavior for properties of anonymous types."},{"content":"Only properties you designate as key properties participate in tests of equality between anonymous type instances, or calculation of hash code values.","pos":[369,519]},{"content":"The values of key properties cannot be changed.","pos":[520,567]},{"content":"You designate a property of an anonymous type as a key property by placing the keyword <ph id=\"ph1\">`Key`</ph> in front of its declaration in the initialization list.","pos":[574,722],"source":"You designate a property of an anonymous type as a key property by placing the keyword `Key` in front of its declaration in the initialization list."},{"content":"In the following example, <ph id=\"ph1\">`Airline`</ph> and <ph id=\"ph2\">`FlightNo`</ph> are key properties, but <ph id=\"ph3\">`Gate`</ph> is not.","pos":[723,812],"source":" In the following example, `Airline` and `FlightNo` are key properties, but `Gate` is not."},{"content":"When a new anonymous type is created, it inherits directly from <ph id=\"ph1\">&lt;xref:System.Object&gt;</ph>.","pos":[953,1038],"source":"When a new anonymous type is created, it inherits directly from <xref:System.Object>."},{"content":"The compiler overrides three inherited members: <ph id=\"ph1\">&lt;xref:System.Object.Equals%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Object.GetHashCode%2A&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Object.ToString%2A&gt;</ph>.","pos":[1039,1193],"source":" The compiler overrides three inherited members: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>."},{"content":"The override code that is produced for <ph id=\"ph1\">&lt;xref:System.Object.Equals%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Object.GetHashCode%2A&gt;</ph> is based on key properties.","pos":[1194,1331],"source":" The override code that is produced for <xref:System.Object.Equals%2A> and <xref:System.Object.GetHashCode%2A> is based on key properties."},{"content":"If there are no key properties in the type, <ph id=\"ph1\">&lt;xref:System.Object.GetHashCode%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Object.Equals%2A&gt;</ph> are not overridden.","pos":[1332,1466],"source":" If there are no key properties in the type, <xref:System.Object.GetHashCode%2A> and <xref:System.Object.Equals%2A> are not overridden."},{"pos":[1475,1483],"content":"Equality","linkify":"Equality","nodes":[{"content":"Equality","pos":[0,8]}]},{"content":"Two anonymous type instances are equal if they are instances of the same type and if the values of their key properties are equal.","pos":[1487,1617]},{"content":"In the following examples, <ph id=\"ph1\">`flight2`</ph> is equal to <ph id=\"ph2\">`flight1`</ph> from the previous example because they are instances of the same anonymous type and they have matching values for their key properties.","pos":[1618,1812],"source":" In the following examples, `flight2` is equal to `flight1` from the previous example because they are instances of the same anonymous type and they have matching values for their key properties."},{"content":"However, <ph id=\"ph1\">`flight3`</ph> is not equal to <ph id=\"ph2\">`flight1`</ph> because it has a different value for a key property, <ph id=\"ph3\">`FlightNo`</ph>.","pos":[1813,1922],"source":" However, `flight3` is not equal to `flight1` because it has a different value for a key property, `FlightNo`."},{"content":"Instance <ph id=\"ph1\">`flight4`</ph> is not the same type as <ph id=\"ph2\">`flight1`</ph> because they designate different properties as key properties.","pos":[1923,2038],"source":" Instance `flight4` is not the same type as `flight1` because they designate different properties as key properties."},{"content":"If two instances are declared with only non-key properties, identical in name, type, order, and value, the two instances are not equal.","pos":[2179,2314]},{"content":"An instance without key properties is equal only to itself.","pos":[2315,2374]},{"pos":[2381,2626],"content":"For more information about the conditions under which two anonymous type instances are instances of the same anonymous type, see <bpt id=\"p1\">[</bpt>Anonymous Types<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)</ept>.","source":"For more information about the conditions under which two anonymous type instances are instances of the same anonymous type, see [Anonymous Types](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)."},{"pos":[2635,2656],"content":"Hash Code Calculation","linkify":"Hash Code Calculation","nodes":[{"content":"Hash Code Calculation","pos":[0,21]}]},{"content":"Like <ph id=\"ph1\">&lt;xref:System.Object.Equals%2A&gt;</ph>, the hash function that is defined in <ph id=\"ph2\">&lt;xref:System.Object.GetHashCode%2A&gt;</ph> for an anonymous type is based on the key properties of the type.","pos":[2660,2835],"source":"Like <xref:System.Object.Equals%2A>, the hash function that is defined in <xref:System.Object.GetHashCode%2A> for an anonymous type is based on the key properties of the type."},{"content":"The following examples show the interaction between key properties and hash code values.","pos":[2836,2924]},{"content":"Instances of an anonymous type that have the same values for all key properties have the same hash code value, even if non-key properties do not have matching values.","pos":[2931,3097]},{"content":"The following statement returns <ph id=\"ph1\">`True`</ph>.","pos":[3098,3137],"source":" The following statement returns `True`."},{"content":"Instances of an anonymous type that have different values for one or more key properties have different hash code values.","pos":[3278,3399]},{"content":"The following statement returns <ph id=\"ph1\">`False`</ph>.","pos":[3400,3440],"source":" The following statement returns `False`."},{"content":"Instances of anonymous types that designate different properties as key properties are not instances of the same type.","pos":[3581,3699]},{"content":"They have different hash code values even when the names and values of all properties are the same.","pos":[3700,3799]},{"content":"The following statement returns <ph id=\"ph1\">`False`</ph>.","pos":[3800,3840],"source":" The following statement returns `False`."},{"pos":[3983,3999],"content":"Read-Only Values","linkify":"Read-Only Values","nodes":[{"content":"Read-Only Values","pos":[0,16]}]},{"content":"The values of key properties cannot be changed.","pos":[4003,4050]},{"content":"For example, in <ph id=\"ph1\">`flight1`</ph> in the earlier examples, the <ph id=\"ph2\">`Airline`</ph> and <ph id=\"ph3\">`FlightNo`</ph> fields are read-only, but <ph id=\"ph4\">`Gate`</ph> can be changed.","pos":[4051,4179],"source":" For example, in `flight1` in the earlier examples, the `Airline` and `FlightNo` fields are read-only, but `Gate` can be changed."},{"pos":[4322,4330],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4334,4469],"content":"<bpt id=\"p1\">[</bpt>Anonymous Type Definition<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)</ept>","source":"[Anonymous Type Definition](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)"},{"pos":[4472,4694],"content":"<bpt id=\"p1\">[</bpt>How to: Infer Property Names and Types in Anonymous Type Declarations<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)</ept>","source":"[How to: Infer Property Names and Types in Anonymous Type Declarations](../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)"},{"pos":[4697,4812],"content":"<bpt id=\"p1\">[</bpt>Anonymous Types<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)</ept>","source":"[Anonymous Types](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)"}]}