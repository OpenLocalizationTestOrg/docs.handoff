{"content":"---\ntitle: \"How to: Detect Whether the .NET Framework 3.0 Is Installed | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"WinFX Runtime user-agent string\"\n  - \"presence of WPT, detecting\"\n  - \"detecting WPF presence\"\nms.assetid: 7f71d652-1749-4379-945a-aa2e3994cb43\ncaps.latest.revision: 12\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Detect Whether the .NET Framework 3.0 Is Installed\nBefore administrators can deploy [!INCLUDE[TLA#tla_avalonwinfx](../../../../includes/tlasharptla-avalonwinfx-md.md)] applications on a system, they must first confirm that the [!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)] runtime is present. This topic provides a script written in HTML/JavaScript that administrators can use to determine whether [!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)] is present on a system.  \n  \n> [!NOTE]\n>  For more detailed information on installing, deploying, and detecting the [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)], see the discussion in [Deploying Microsoft .NET Framework Version 3.0](http://go.microsoft.com/fwlink/?LinkId=96739).  \n  \n<a name=\"content_expiration\"></a>   \n## Detect the \".NET CLR\" User-Agent String  \n When [!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)] is installed, the MSI adds \".NET CLR\" and the version number to the UserAgent string. The following example shows a script embedded in a simple HTML page. The script searches the UserAgent string to determine whether [!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)] is installed, and displays a status message on the results of the search.  \n  \n```  \n<HTML>  \n  <HEAD>  \n    <TITLE>Test for the .NET Framework 3.0</TITLE>  \n    <META HTTP-EQUIV=\"Content-Type\" CONTENT=\"text/html; charset=utf-8\" />  \n    <SCRIPT LANGUAGE=\"JavaScript\">  \n    <!--  \n    var dotNETRuntimeVersion = \"3.0.04425.00\";  \n  \n    function window::onload()  \n    {  \n      if (HasRuntimeVersion(dotNETRuntimeVersion))  \n      {  \n        result.innerText =   \n          \"This machine has the correct version of the .NET Framework 3.0: \"   \n          + dotNETRuntimeVersion  \n      }   \n      else  \n      {  \n        result.innerText =   \n          \"This machine does not have the correct version of the .NET Framework 3.0.\"  \n      }  \n      result.innerText += \"\\n\\nThis machine's userAgent string is: \" +   \n        navigator.userAgent + \".\";  \n    }  \n  \n    //  \n    // Retrieve the version from the user agent string and   \n    // compare with the specified version.  \n    //  \n    function HasRuntimeVersion(versionToCheck)  \n    {  \n      var userAgentString =   \n        navigator.userAgent.match(/.NET CLR [0-9.]+/g);  \n  \n      if (userAgentString != null)  \n      {  \n        var i;  \n  \n        for (i = 0; i < userAgentString.length; ++i)  \n        {  \n          if (CompareVersions(GetVersion(versionToCheck),   \n            GetVersion(userAgentString[i])) <= 0)  \n            return true;  \n        }  \n      }  \n  \n      return false;  \n    }  \n  \n    //  \n    // Extract the numeric part of the version string.  \n    //  \n    function GetVersion(versionString)  \n    {  \n      var numericString =   \n        versionString.match(/([0-9]+)\\.([0-9]+)\\.([0-9]+)/i);  \n      return numericString.slice(1);  \n    }  \n  \n    //  \n    // Compare the 2 version strings by converting them to numeric format.  \n    //  \n    function CompareVersions(version1, version2)  \n    {  \n      for (i = 0; i < version1.length; ++i)  \n      {  \n        var number1 = new Number(version1[i]);  \n        var number2 = new Number(version2[i]);  \n  \n        if (number1 < number2)  \n          return -1;  \n  \n        if (number1 > number2)  \n          return 1;  \n      }  \n  \n      return 0;  \n    }  \n  \n    -->  \n    </SCRIPT>  \n  </HEAD>  \n  \n  <BODY>  \n    <div id=\"result\" />  \n  </BODY>  \n</HTML>  \n  \n```  \n  \n If the search for the \".NET CLR \" version is successful, the following type of status message appears:  \n  \n `This machine has the correct version of the .NET Framework 3.0: 3.0.04425.00`  \n  \n `This machine's userAgent string is: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; InfoPath.1; .NET CLR 2.0.50727; .NET CLR 3.0.04425.00).`  \n  \n Otherwise, the following type of status message appears:  \n  \n `This machine does not have correct version of the .NET Framework 3.0.`  \n  \n `This machine's userAgent string is: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; InfoPath.1; .NET CLR 2.0.50727).`","nodes":[{"pos":[12,87],"content":"How to: Detect Whether the .NET Framework 3.0 Is Installed | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Detect Whether the .NET Framework 3.0 Is Installed | Microsoft Docs","pos":[0,75]}]},{"pos":[517,575],"content":"How to: Detect Whether the .NET Framework 3.0 Is Installed","linkify":"How to: Detect Whether the .NET Framework 3.0 Is Installed","nodes":[{"content":"How to: Detect Whether the .NET Framework 3.0 Is Installed","pos":[0,58]}]},{"content":"Before administrators can deploy <ph id=\"ph1\">[!INCLUDE[TLA#tla_avalonwinfx](../../../../includes/tlasharptla-avalonwinfx-md.md)]</ph> applications on a system, they must first confirm that the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)]</ph> runtime is present.","pos":[576,857],"source":"Before administrators can deploy [!INCLUDE[TLA#tla_avalonwinfx](../../../../includes/tlasharptla-avalonwinfx-md.md)] applications on a system, they must first confirm that the [!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)] runtime is present."},{"content":"This topic provides a script written in HTML/JavaScript that administrators can use to determine whether <ph id=\"ph1\">[!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)]</ph> is present on a system.","pos":[858,1072],"source":" This topic provides a script written in HTML/JavaScript that administrators can use to determine whether [!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)] is present on a system."},{"pos":[1080,1355],"content":"[!NOTE]\n For more detailed information on installing, deploying, and detecting the [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)], see the discussion in [Deploying Microsoft .NET Framework Version 3.0](http://go.microsoft.com/fwlink/?LinkId=96739).","leadings":["","> "],"nodes":[{"content":"For more detailed information on installing, deploying, and detecting the <ph id=\"ph1\">[!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)]</ph>, see the discussion in <bpt id=\"p1\">[</bpt>Deploying Microsoft .NET Framework Version 3.0<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=96739)</ept>.","pos":[9,273],"source":" For more detailed information on installing, deploying, and detecting the [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)], see the discussion in [Deploying Microsoft .NET Framework Version 3.0](http://go.microsoft.com/fwlink/?LinkId=96739)."}]},{"pos":[1401,1440],"content":"Detect the \".NET CLR\" User-Agent String","linkify":"Detect the \".NET CLR\" User-Agent String","nodes":[{"content":"Detect the \".NET CLR\" User-Agent String","pos":[0,39]}]},{"content":"When <ph id=\"ph1\">[!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)]</ph> is installed, the MSI adds \".NET CLR\" and the version number to the UserAgent string.","pos":[1444,1620],"source":"When [!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)] is installed, the MSI adds \".NET CLR\" and the version number to the UserAgent string."},{"content":"The following example shows a script embedded in a simple HTML page.","pos":[1621,1689]},{"content":"The script searches the UserAgent string to determine whether <ph id=\"ph1\">[!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)]</ph> is installed, and displays a status message on the results of the search.","pos":[1690,1911],"source":" The script searches the UserAgent string to determine whether [!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)] is installed, and displays a status message on the results of the search."},{"content":"If the search for the \".NET CLR \" version is successful, the following type of status message appears:","pos":[4157,4259]},{"content":"Otherwise, the following type of status message appears:","pos":[4521,4577]}]}