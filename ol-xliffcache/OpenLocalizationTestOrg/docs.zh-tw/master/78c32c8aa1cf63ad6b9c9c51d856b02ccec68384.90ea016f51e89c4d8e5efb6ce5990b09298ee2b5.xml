{"content":"---\ntitle: \"Custom Animations Overview\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"custom classes [WPF], animation\"\n  - \"key frames [WPF], custom\"\n  - \"custom key frames [WPF]\"\n  - \"animation [WPF], custom classes\"\n  - \"custom animation classes [WPF]\"\nms.assetid: 9be69d50-3384-4938-886f-08ce00e4a7a6\n---\n# Custom Animations Overview\nThis topic describes how and when to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system by creating custom key frames, animation classes, or by using per-frame callback to bypass it.  \n  \n<a name=\"prerequisites\"></a>   \n## Prerequisites  \n To understand this topic, you should be familiar with the different types of animations provided by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]. For more information, see the From/To/By Animations Overview, the [Key-Frame Animations Overview](key-frame-animations-overview.md), and the [Path Animations Overview](path-animations-overview.md).  \n  \n Because the animation classes inherit from the <xref:System.Windows.Freezable> class, you should be familiar with <xref:System.Windows.Freezable> objects and how to inherit from <xref:System.Windows.Freezable>. For more information, see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md).  \n  \n<a name=\"extendingtheanimationsystem\"></a>   \n## Extending the Animation System  \n There are a number of ways to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system, depending on the level of built-in functionality you want to use.  There are three primary extensibility points in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine:  \n  \n-   Create a custom key frame object by inheriting from one of the *\\<Type>*KeyFrame classes, such as <xref:System.Windows.Media.Animation.DoubleKeyFrame>. This approach uses most of the built-in functionality of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine.  \n  \n-   Create your own animation class by inheriting from <xref:System.Windows.Media.Animation.AnimationTimeline> or one of the *\\<Type>*AnimationBase classes.  \n  \n-   Use per-frame callback to generate animations on a per-frame basis. This approach completely bypasses the animation and timing system.  \n  \n The following table describes some the scenarios for extending the animation system.  \n  \n|When you want to...|Use this approach|  \n|-------------------------|-----------------------|  \n|Customize the interpolation between values of a type that has a corresponding *\\<Type>*AnimationUsingKeyFrames|Create a custom key frame. For more information, see the [Create a Custom Key Frame](#createacustomkeyframe) section.|  \n|Customize more than just the interpolation between values of a type that has a corresponding *\\<Type>*Animation.|Create a custom animation class that inherits from the *\\<Type>*AnimationBase class that corresponds to the type you want to animate. For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section.|  \n|Animate a type that has no corresponding [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation|Use an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> or create a class that inherits from <xref:System.Windows.Media.Animation.AnimationTimeline>. For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section.|  \n|Animate multiple objects with values that are computed each frame and are based on the last set of object interactions|Use per-frame callback. For more information, see the [Create a Use Per-Frame Callback](#useperframecallback) section.|  \n  \n<a name=\"createacustomkeyframe\"></a>   \n## Create a Custom Key Frame  \n Creating a custom key frame class is the simplest way to extend the animation system. Use this approach when you want to a different interpolation method for a key-frame animation.  As described in the [Key-Frame Animations Overview](key-frame-animations-overview.md), a key-frame animation uses key frame objects to generate its output values. Each key frame object performs three functions:  \n  \n-   Specifies a target value using its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property.  \n  \n-   Specifies the time at which that value should be reached using its <xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A> property.  \n  \n-   Interpolates between the value of the previous key frame and its own value by implementing the InterpolateValueCore method.  \n  \n **Implementation Instructions**  \n  \n Derive from the *\\<Type>*KeyFrame abstract class and implement the InterpolateValueCore method. The InterpolateValueCore method returns the current value of the key frame. It takes two parameters: the value of the previous key frame and a progress value that ranges from 0 to 1. A progress of 0 indicates the key frame has just started, and a value of 1 indicates that the key frame has just completed and should return the value specified by its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property.  \n  \n Because the *\\<Type>*KeyFrame classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class. If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.  \n  \n After you've created your custom *\\<Type>*KeyFrame animation, you can use it with the *\\<Type>*AnimationUsingKeyFrames for that type.  \n  \n<a name=\"createacustomanimationtype\"></a>   \n## Create a Custom Animation Class  \n Creating your own animation type gives you more control over how an object in animated. There are two recommended ways to create your own animation type: you can derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class or the *\\<Type>*AnimationBase class. Deriving from the *\\<Type>*Animation or *\\<Type>*AnimationUsingKeyFrames classes is not recommended.  \n  \n### Derive from \\<Type>AnimationBase  \n Deriving from a *\\<Type>*AnimationBase class is the simplest way to create a new animation type. Use this approach when you want to create a new animation for type that already has a corresponding *\\<Type>*AnimationBase class.  \n  \n **Implementation Instructions**  \n  \n Derive from a *\\<Type>*Animation class and implement the GetCurrentValueCore method. The GetCurrentValueCore method returns the current value of the animation. It takes three parameters: a suggested starting value, a suggested ending value, and an <xref:System.Windows.Media.Animation.AnimationClock>, which you use to determine the progress of the animation.  \n  \n Because the *\\<Type>*AnimationBase classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class. If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.  \n  \n For more information, see the GetCurrentValueCore method documentation for the *\\<Type>*AnimationBase class for the type that you want to animate. For an example, see the [Custom Animation Sample](https://go.microsoft.com/fwlink/?LinkID=159981)  \n  \n **Alternative Approaches**  \n  \n If you simply want to change how animation values are interpolated, considering deriving from one of the *\\<Type>*KeyFrame classes. The key frame you create can be used with the corresponding *\\<Type>*AnimationUsingKeyFrames provided by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  \n  \n### Derive from AnimationTimeline  \n Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class when you want to create an animation for a type that doesn't already have a matching [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation, or you want to create an animation that is not strongly typed.  \n  \n **Implementation Instructions**  \n  \n Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class and override the following members:  \n  \n-   <xref:System.Windows.Freezable.CreateInstanceCore%2A> – If your new class is concrete, you must override <xref:System.Windows.Freezable.CreateInstanceCore%2A> to return a new instance of your class.  \n  \n-   <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> – Override this method to return the current value of your animation. It takes three parameters: a default origin value, a default destination value, and an <xref:System.Windows.Media.Animation.AnimationClock>. Use the <xref:System.Windows.Media.Animation.AnimationClock> to obtain the current time or progress for the animation. You can choose whether to use the default origin and destination values.  \n  \n-   <xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> – Override this property to indicate whether your animation uses the default destination value specified by the <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> method.  \n  \n-   <xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> – Override this property to indicate the <xref:System.Type> of output your animation produces.  \n  \n If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.  \n  \n The recommended paradigm (used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animations) is to use two inheritance levels:  \n  \n1.  Create an abstract *\\<Type>*AnimationBase class that derives from <xref:System.Windows.Media.Animation.AnimationTimeline>. This class should override the <xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> method. It should also introduce a new abstract method, GetCurrentValueCore, and override <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> so that it validates the types of the default origin value and default destination value parameters, then calls GetCurrentValueCore.  \n  \n2.  Create another class that inherits from your new *\\<Type>*AnimationBase class and overrides the <xref:System.Windows.Freezable.CreateInstanceCore%2A> method, the GetCurrentValueCore method that you introduced, and the <xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> property.  \n  \n **Alternative Approaches**  \n  \n If you want to animate a type that has no corresponding From/To/By animation or key-frame animation, consider using an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>. Because it is weakly typed, an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> can animate any type of value. The drawback to this approach is that <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> only supports discrete interpolation.  \n  \n<a name=\"useperframecallback\"></a>   \n## Use Per-Frame Callback  \n Use this approach when you need to completely bypass the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system. One scenario for this approach is physics animations, where at each animation step a new direction or position of animated objects needs to be recomputed based on the  last set of object interactions.  \n  \n **Implementation Instructions**  \n  \n Unlike the other approaches described in this overview, to use per-frame callback you don't need to create a custom animation or key frame class.  \n  \n Instead, you register for the <xref:System.Windows.Media.CompositionTarget.Rendering> event of the object that contains the objects you want to animate. This event handler method gets called once per frame. Each time that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] marshals the persisted rendering data in the visual tree across to the composition tree, your event handler method is called.  \n  \n In your event handler, perform your whatever calculations necessary for your animation effect and set the properties of the objects you want to animate with these values.  \n  \n To obtain the presentation time of the current frame, the <xref:System.EventArgs> associated with this event can be cast as <xref:System.Windows.Media.RenderingEventArgs>, which provide a <xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A> property that you can use to obtain the current frame's rendering time.  \n  \n For more information, see the <xref:System.Windows.Media.CompositionTarget.Rendering> page.  \n  \n## See also\n\n- <xref:System.Windows.Media.Animation.AnimationTimeline>\n- <xref:System.Windows.Media.Animation.IKeyFrame>\n- [Property Animation Techniques Overview](property-animation-techniques-overview.md)\n- [Freezable Objects Overview](../advanced/freezable-objects-overview.md)\n- [Key-Frame Animations Overview](key-frame-animations-overview.md)\n- [Path Animations Overview](path-animations-overview.md)\n- [Animation Overview](animation-overview.md)\n- [Animation and Timing System Overview](animation-and-timing-system-overview.md)\n- [Custom Animation Sample](https://go.microsoft.com/fwlink/?LinkID=159981)\n","nodes":[{"pos":[4,306],"embed":true,"restype":"x-metadata","content":"title: \"Custom Animations Overview\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"custom classes [WPF], animation\"\n  - \"key frames [WPF], custom\"\n  - \"custom key frames [WPF]\"\n  - \"animation [WPF], custom classes\"\n  - \"custom animation classes [WPF]\"\nms.assetid: 9be69d50-3384-4938-886f-08ce00e4a7a6","nodes":[{"content":"Custom Animations Overview","nodes":[{"pos":[0,26],"content":"Custom Animations Overview","nodes":[{"content":"Custom Animations Overview","pos":[0,26]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[313,339],"content":"Custom Animations Overview","linkify":"Custom Animations Overview","nodes":[{"content":"Custom Animations Overview","pos":[0,26]}]},{"pos":[340,581],"content":"This topic describes how and when to extend the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> animation system by creating custom key frames, animation classes, or by using per-frame callback to bypass it.","source":"This topic describes how and when to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system by creating custom key frames, animation classes, or by using per-frame callback to bypass it."},{"pos":[622,635],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"To understand this topic, you should be familiar with the different types of animations provided by the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>.","pos":[639,825],"source":"To understand this topic, you should be familiar with the different types of animations provided by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]."},{"content":"For more information, see the From/To/By Animations Overview, the <bpt id=\"p1\">[</bpt>Key-Frame Animations Overview<ept id=\"p1\">](key-frame-animations-overview.md)</ept>, and the <bpt id=\"p2\">[</bpt>Path Animations Overview<ept id=\"p2\">](path-animations-overview.md)</ept>.","pos":[826,1023],"source":" For more information, see the From/To/By Animations Overview, the [Key-Frame Animations Overview](key-frame-animations-overview.md), and the [Path Animations Overview](path-animations-overview.md)."},{"content":"Because the animation classes inherit from the <ph id=\"ph1\">&lt;xref:System.Windows.Freezable&gt;</ph> class, you should be familiar with <ph id=\"ph2\">&lt;xref:System.Windows.Freezable&gt;</ph> objects and how to inherit from <ph id=\"ph3\">&lt;xref:System.Windows.Freezable&gt;</ph>.","pos":[1030,1240],"source":"Because the animation classes inherit from the <xref:System.Windows.Freezable> class, you should be familiar with <xref:System.Windows.Freezable> objects and how to inherit from <xref:System.Windows.Freezable>."},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>Freezable Objects Overview<ept id=\"p1\">](../advanced/freezable-objects-overview.md)</ept>.","pos":[1241,1343],"source":" For more information, see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md)."},{"pos":[1398,1428],"content":"Extending the Animation System","linkify":"Extending the Animation System","nodes":[{"content":"Extending the Animation System","pos":[0,30]}]},{"content":"There are a number of ways to extend the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> animation system, depending on the level of built-in functionality you want to use.","pos":[1432,1638],"source":"There are a number of ways to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system, depending on the level of built-in functionality you want to use."},{"content":"There are three primary extensibility points in the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> animation engine:","pos":[1640,1791],"source":"  There are three primary extensibility points in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine:"},{"content":"Create a custom key frame object by inheriting from one of the <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>KeyFrame classes, such as <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.DoubleKeyFrame&gt;</ph>.","pos":[1801,1952],"source":"Create a custom key frame object by inheriting from one of the *\\<Type>*KeyFrame classes, such as <xref:System.Windows.Media.Animation.DoubleKeyFrame>."},{"content":"This approach uses most of the built-in functionality of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> animation engine.","pos":[1953,2113],"source":" This approach uses most of the built-in functionality of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine."},{"pos":[2123,2275],"content":"Create your own animation class by inheriting from <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline&gt;</ph> or one of the <bpt id=\"p1\">*</bpt><ph id=\"ph2\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>AnimationBase classes.","source":"Create your own animation class by inheriting from <xref:System.Windows.Media.Animation.AnimationTimeline> or one of the *\\<Type>*AnimationBase classes."},{"content":"Use per-frame callback to generate animations on a per-frame basis.","pos":[2285,2352]},{"content":"This approach completely bypasses the animation and timing system.","pos":[2353,2419]},{"content":"The following table describes some the scenarios for extending the animation system.","pos":[2426,2510]},{"content":"When you want to...","pos":[2517,2536]},{"content":"Use this approach","pos":[2537,2554]},{"pos":[2613,2723],"content":"Customize the interpolation between values of a type that has a corresponding <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>AnimationUsingKeyFrames","source":"Customize the interpolation between values of a type that has a corresponding *\\<Type>*AnimationUsingKeyFrames"},{"content":"Create a custom key frame.","pos":[2724,2750]},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>Create a Custom Key Frame<ept id=\"p1\">](#createacustomkeyframe)</ept> section.","pos":[2751,2841],"source":" For more information, see the [Create a Custom Key Frame](#createacustomkeyframe) section."},{"pos":[2846,2958],"content":"Customize more than just the interpolation between values of a type that has a corresponding <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>Animation.","source":"Customize more than just the interpolation between values of a type that has a corresponding *\\<Type>*Animation."},{"content":"Create a custom animation class that inherits from the <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>AnimationBase class that corresponds to the type you want to animate.","pos":[2959,3092],"source":"Create a custom animation class that inherits from the *\\<Type>*AnimationBase class that corresponds to the type you want to animate."},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>Create a Custom Animation Class<ept id=\"p1\">](#createacustomanimationtype)</ept> section.","pos":[3093,3194],"source":" For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section."},{"pos":[3199,3331],"content":"Animate a type that has no corresponding <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> animation","source":"Animate a type that has no corresponding [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation"},{"content":"Use an <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames&gt;</ph> or create a class that inherits from <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline&gt;</ph>.","pos":[3332,3500],"source":"Use an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> or create a class that inherits from <xref:System.Windows.Media.Animation.AnimationTimeline>."},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>Create a Custom Animation Class<ept id=\"p1\">](#createacustomanimationtype)</ept> section.","pos":[3501,3602],"source":" For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section."},{"content":"Animate multiple objects with values that are computed each frame and are based on the last set of object interactions","pos":[3607,3725]},{"content":"Use per-frame callback.","pos":[3726,3749]},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>Create a Use Per-Frame Callback<ept id=\"p1\">](#useperframecallback)</ept> section.","pos":[3750,3844],"source":" For more information, see the [Create a Use Per-Frame Callback](#useperframecallback) section."},{"pos":[3894,3919],"content":"Create a Custom Key Frame","linkify":"Create a Custom Key Frame","nodes":[{"content":"Create a Custom Key Frame","pos":[0,25]}]},{"content":"Creating a custom key frame class is the simplest way to extend the animation system.","pos":[3923,4008]},{"content":"Use this approach when you want to a different interpolation method for a key-frame animation.","pos":[4009,4103]},{"content":"As described in the <bpt id=\"p1\">[</bpt>Key-Frame Animations Overview<ept id=\"p1\">](key-frame-animations-overview.md)</ept>, a key-frame animation uses key frame objects to generate its output values.","pos":[4105,4267],"source":"  As described in the [Key-Frame Animations Overview](key-frame-animations-overview.md), a key-frame animation uses key frame objects to generate its output values."},{"content":"Each key frame object performs three functions:","pos":[4268,4315]},{"pos":[4325,4426],"content":"Specifies a target value using its <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.IKeyFrame.Value%2A&gt;</ph> property.","source":"Specifies a target value using its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property."},{"pos":[4436,4571],"content":"Specifies the time at which that value should be reached using its <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A&gt;</ph> property.","source":"Specifies the time at which that value should be reached using its <xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A> property."},{"content":"Interpolates between the value of the previous key frame and its own value by implementing the InterpolateValueCore method.","pos":[4581,4704]},{"pos":[4711,4742],"content":"<bpt id=\"p1\">**</bpt>Implementation Instructions<ept id=\"p1\">**</ept>","source":"**Implementation Instructions**"},{"content":"Derive from the <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>KeyFrame abstract class and implement the InterpolateValueCore method.","pos":[4749,4844],"source":"Derive from the *\\<Type>*KeyFrame abstract class and implement the InterpolateValueCore method."},{"content":"The InterpolateValueCore method returns the current value of the key frame.","pos":[4845,4920]},{"content":"It takes two parameters: the value of the previous key frame and a progress value that ranges from 0 to 1.","pos":[4921,5027]},{"content":"A progress of 0 indicates the key frame has just started, and a value of 1 indicates that the key frame has just completed and should return the value specified by its <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.IKeyFrame.Value%2A&gt;</ph> property.","pos":[5028,5262],"source":" A progress of 0 indicates the key frame has just started, and a value of 1 indicates that the key frame has just completed and should return the value specified by its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property."},{"content":"Because the <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>KeyFrame classes inherit from the <ph id=\"ph2\">&lt;xref:System.Windows.Freezable&gt;</ph> class, you must also override <ph id=\"ph3\">&lt;xref:System.Windows.Freezable.CreateInstanceCore%2A&gt;</ph> core to return a new instance of your class.","pos":[5269,5484],"source":"Because the *\\<Type>*KeyFrame classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class."},{"content":"If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the <bpt id=\"p1\">[</bpt>Freezable Objects Overview<ept id=\"p1\">](../advanced/freezable-objects-overview.md)</ept> for more information.","pos":[5485,5751],"source":" If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information."},{"pos":[5758,5891],"content":"After you've created your custom <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>KeyFrame animation, you can use it with the <bpt id=\"p2\">*</bpt><ph id=\"ph2\">\\&lt;</ph>Type&gt;<ept id=\"p2\">*</ept>AnimationUsingKeyFrames for that type.","source":"After you've created your custom *\\<Type>*KeyFrame animation, you can use it with the *\\<Type>*AnimationUsingKeyFrames for that type."},{"pos":[5945,5976],"content":"Create a Custom Animation Class","linkify":"Create a Custom Animation Class","nodes":[{"content":"Create a Custom Animation Class","pos":[0,31]}]},{"content":"Creating your own animation type gives you more control over how an object in animated.","pos":[5980,6067]},{"content":"There are two recommended ways to create your own animation type: you can derive from the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline&gt;</ph> class or the <bpt id=\"p1\">*</bpt><ph id=\"ph2\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>AnimationBase class.","pos":[6068,6256],"source":" There are two recommended ways to create your own animation type: you can derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class or the *\\<Type>*AnimationBase class."},{"content":"Deriving from the <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>Animation or <bpt id=\"p2\">*</bpt><ph id=\"ph2\">\\&lt;</ph>Type&gt;<ept id=\"p2\">*</ept>AnimationUsingKeyFrames classes is not recommended.","pos":[6257,6357],"source":" Deriving from the *\\<Type>*Animation or *\\<Type>*AnimationUsingKeyFrames classes is not recommended."},{"pos":[6367,6399],"content":"Derive from \\<Type>AnimationBase","linkify":"Derive from \\<Type>AnimationBase","nodes":[{"content":"Derive from <ph id=\"ph1\">\\&lt;</ph>Type&gt;AnimationBase","pos":[0,32],"source":"Derive from \\<Type>AnimationBase"}]},{"content":"Deriving from a <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>AnimationBase class is the simplest way to create a new animation type.","pos":[6403,6499],"source":"Deriving from a *\\<Type>*AnimationBase class is the simplest way to create a new animation type."},{"content":"Use this approach when you want to create a new animation for type that already has a corresponding <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>AnimationBase class.","pos":[6500,6629],"source":" Use this approach when you want to create a new animation for type that already has a corresponding *\\<Type>*AnimationBase class."},{"pos":[6636,6667],"content":"<bpt id=\"p1\">**</bpt>Implementation Instructions<ept id=\"p1\">**</ept>","source":"**Implementation Instructions**"},{"content":"Derive from a <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>Animation class and implement the GetCurrentValueCore method.","pos":[6674,6758],"source":"Derive from a *\\<Type>*Animation class and implement the GetCurrentValueCore method."},{"content":"The GetCurrentValueCore method returns the current value of the animation.","pos":[6759,6833]},{"content":"It takes three parameters: a suggested starting value, a suggested ending value, and an <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph>, which you use to determine the progress of the animation.","pos":[6834,7033],"source":" It takes three parameters: a suggested starting value, a suggested ending value, and an <xref:System.Windows.Media.Animation.AnimationClock>, which you use to determine the progress of the animation."},{"content":"Because the <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>AnimationBase classes inherit from the <ph id=\"ph2\">&lt;xref:System.Windows.Freezable&gt;</ph> class, you must also override <ph id=\"ph3\">&lt;xref:System.Windows.Freezable.CreateInstanceCore%2A&gt;</ph> core to return a new instance of your class.","pos":[7040,7260],"source":"Because the *\\<Type>*AnimationBase classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class."},{"content":"If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the <bpt id=\"p1\">[</bpt>Freezable Objects Overview<ept id=\"p1\">](../advanced/freezable-objects-overview.md)</ept> for more information.","pos":[7261,7527],"source":" If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information."},{"content":"For more information, see the GetCurrentValueCore method documentation for the <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>AnimationBase class for the type that you want to animate.","pos":[7534,7680],"source":"For more information, see the GetCurrentValueCore method documentation for the *\\<Type>*AnimationBase class for the type that you want to animate."},{"content":"For an example, see the <bpt id=\"p1\">[</bpt>Custom Animation Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159981)</ept>","pos":[7681,7778],"source":" For an example, see the [Custom Animation Sample](https://go.microsoft.com/fwlink/?LinkID=159981)"},{"pos":[7785,7811],"content":"<bpt id=\"p1\">**</bpt>Alternative Approaches<ept id=\"p1\">**</ept>","source":"**Alternative Approaches**"},{"content":"If you simply want to change how animation values are interpolated, considering deriving from one of the <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>KeyFrame classes.","pos":[7818,7949],"source":"If you simply want to change how animation values are interpolated, considering deriving from one of the *\\<Type>*KeyFrame classes."},{"content":"The key frame you create can be used with the corresponding <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>AnimationUsingKeyFrames provided by <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>.","pos":[7950,8137],"source":" The key frame you create can be used with the corresponding *\\<Type>*AnimationUsingKeyFrames provided by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]."},{"pos":[8147,8176],"content":"Derive from AnimationTimeline","linkify":"Derive from AnimationTimeline","nodes":[{"content":"Derive from AnimationTimeline","pos":[0,29]}]},{"pos":[8180,8498],"content":"Derive from the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline&gt;</ph> class when you want to create an animation for a type that doesn't already have a matching <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> animation, or you want to create an animation that is not strongly typed.","source":"Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class when you want to create an animation for a type that doesn't already have a matching [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation, or you want to create an animation that is not strongly typed."},{"pos":[8505,8536],"content":"<bpt id=\"p1\">**</bpt>Implementation Instructions<ept id=\"p1\">**</ept>","source":"**Implementation Instructions**"},{"pos":[8543,8656],"content":"Derive from the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline&gt;</ph> class and override the following members:","source":"Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class and override the following members:"},{"pos":[8666,8864],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Freezable.CreateInstanceCore%2A&gt;</ph> – If your new class is concrete, you must override <ph id=\"ph2\">&lt;xref:System.Windows.Freezable.CreateInstanceCore%2A&gt;</ph> to return a new instance of your class.","source":"<xref:System.Windows.Freezable.CreateInstanceCore%2A> – If your new class is concrete, you must override <xref:System.Windows.Freezable.CreateInstanceCore%2A> to return a new instance of your class."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A&gt;</ph> – Override this method to return the current value of your animation.","pos":[8874,9018],"source":"<xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> – Override this method to return the current value of your animation."},{"content":"It takes three parameters: a default origin value, a default destination value, and an <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph>.","pos":[9019,9159],"source":" It takes three parameters: a default origin value, a default destination value, and an <xref:System.Windows.Media.Animation.AnimationClock>."},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationClock&gt;</ph> to obtain the current time or progress for the animation.","pos":[9160,9278],"source":" Use the <xref:System.Windows.Media.Animation.AnimationClock> to obtain the current time or progress for the animation."},{"content":"You can choose whether to use the default origin and destination values.","pos":[9279,9351]},{"pos":[9361,9635],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A&gt;</ph> – Override this property to indicate whether your animation uses the default destination value specified by the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A&gt;</ph> method.","source":"<xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> – Override this property to indicate whether your animation uses the default destination value specified by the <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> method."},{"pos":[9645,9817],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A&gt;</ph> – Override this property to indicate the <ph id=\"ph2\">&lt;xref:System.Type&gt;</ph> of output your animation produces.","source":"<xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> – Override this property to indicate the <xref:System.Type> of output your animation produces."},{"pos":[9824,10090],"content":"If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the <bpt id=\"p1\">[</bpt>Freezable Objects Overview<ept id=\"p1\">](../advanced/freezable-objects-overview.md)</ept> for more information.","source":"If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information."},{"pos":[10097,10258],"content":"The recommended paradigm (used by <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> animations) is to use two inheritance levels:","source":"The recommended paradigm (used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animations) is to use two inheritance levels:"},{"content":"Create an abstract <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>AnimationBase class that derives from <ph id=\"ph2\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline&gt;</ph>.","pos":[10268,10390],"source":"Create an abstract *\\<Type>*AnimationBase class that derives from <xref:System.Windows.Media.Animation.AnimationTimeline>."},{"content":"This class should override the <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A&gt;</ph> method.","pos":[10391,10507],"source":" This class should override the <xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> method."},{"content":"It should also introduce a new abstract method, GetCurrentValueCore, and override <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A&gt;</ph> so that it validates the types of the default origin value and default destination value parameters, then calls GetCurrentValueCore.","pos":[10508,10797],"source":" It should also introduce a new abstract method, GetCurrentValueCore, and override <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> so that it validates the types of the default origin value and default destination value parameters, then calls GetCurrentValueCore."},{"pos":[10807,11114],"content":"Create another class that inherits from your new <bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>Type&gt;<ept id=\"p1\">*</ept>AnimationBase class and overrides the <ph id=\"ph2\">&lt;xref:System.Windows.Freezable.CreateInstanceCore%2A&gt;</ph> method, the GetCurrentValueCore method that you introduced, and the <ph id=\"ph3\">&lt;xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A&gt;</ph> property.","source":"Create another class that inherits from your new *\\<Type>*AnimationBase class and overrides the <xref:System.Windows.Freezable.CreateInstanceCore%2A> method, the GetCurrentValueCore method that you introduced, and the <xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> property."},{"pos":[11121,11147],"content":"<bpt id=\"p1\">**</bpt>Alternative Approaches<ept id=\"p1\">**</ept>","source":"**Alternative Approaches**"},{"content":"If you want to animate a type that has no corresponding From/To/By animation or key-frame animation, consider using an <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames&gt;</ph>.","pos":[11154,11341],"source":"If you want to animate a type that has no corresponding From/To/By animation or key-frame animation, consider using an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>."},{"content":"Because it is weakly typed, an <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames&gt;</ph> can animate any type of value.","pos":[11342,11471],"source":" Because it is weakly typed, an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> can animate any type of value."},{"content":"The drawback to this approach is that <ph id=\"ph1\">&lt;xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames&gt;</ph> only supports discrete interpolation.","pos":[11472,11615],"source":" The drawback to this approach is that <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> only supports discrete interpolation."},{"pos":[11662,11684],"content":"Use Per-Frame Callback","linkify":"Use Per-Frame Callback","nodes":[{"content":"Use Per-Frame Callback","pos":[0,22]}]},{"content":"Use this approach when you need to completely bypass the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> animation system.","pos":[11688,11844],"source":"Use this approach when you need to completely bypass the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system."},{"content":"One scenario for this approach is physics animations, where at each animation step a new direction or position of animated objects needs to be recomputed based on the  last set of object interactions.","pos":[11845,12045]},{"pos":[12052,12083],"content":"<bpt id=\"p1\">**</bpt>Implementation Instructions<ept id=\"p1\">**</ept>","source":"**Implementation Instructions**"},{"content":"Unlike the other approaches described in this overview, to use per-frame callback you don't need to create a custom animation or key frame class.","pos":[12090,12235]},{"content":"Instead, you register for the <ph id=\"ph1\">&lt;xref:System.Windows.Media.CompositionTarget.Rendering&gt;</ph> event of the object that contains the objects you want to animate.","pos":[12242,12394],"source":"Instead, you register for the <xref:System.Windows.Media.CompositionTarget.Rendering> event of the object that contains the objects you want to animate."},{"content":"This event handler method gets called once per frame.","pos":[12395,12448]},{"content":"Each time that <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> marshals the persisted rendering data in the visual tree across to the composition tree, your event handler method is called.","pos":[12449,12671],"source":" Each time that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] marshals the persisted rendering data in the visual tree across to the composition tree, your event handler method is called."},{"content":"In your event handler, perform your whatever calculations necessary for your animation effect and set the properties of the objects you want to animate with these values.","pos":[12678,12848]},{"pos":[12855,13178],"content":"To obtain the presentation time of the current frame, the <ph id=\"ph1\">&lt;xref:System.EventArgs&gt;</ph> associated with this event can be cast as <ph id=\"ph2\">&lt;xref:System.Windows.Media.RenderingEventArgs&gt;</ph>, which provide a <ph id=\"ph3\">&lt;xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A&gt;</ph> property that you can use to obtain the current frame's rendering time.","source":"To obtain the presentation time of the current frame, the <xref:System.EventArgs> associated with this event can be cast as <xref:System.Windows.Media.RenderingEventArgs>, which provide a <xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A> property that you can use to obtain the current frame's rendering time."},{"pos":[13185,13276],"content":"For more information, see the <ph id=\"ph1\">&lt;xref:System.Windows.Media.CompositionTarget.Rendering&gt;</ph> page.","source":"For more information, see the <xref:System.Windows.Media.CompositionTarget.Rendering> page."},{"pos":[13285,13293],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[13405,13488],"content":"<bpt id=\"p1\">[</bpt>Property Animation Techniques Overview<ept id=\"p1\">](property-animation-techniques-overview.md)</ept>","source":"[Property Animation Techniques Overview](property-animation-techniques-overview.md)"},{"pos":[13491,13562],"content":"<bpt id=\"p1\">[</bpt>Freezable Objects Overview<ept id=\"p1\">](../advanced/freezable-objects-overview.md)</ept>","source":"[Freezable Objects Overview](../advanced/freezable-objects-overview.md)"},{"pos":[13565,13630],"content":"<bpt id=\"p1\">[</bpt>Key-Frame Animations Overview<ept id=\"p1\">](key-frame-animations-overview.md)</ept>","source":"[Key-Frame Animations Overview](key-frame-animations-overview.md)"},{"pos":[13633,13688],"content":"<bpt id=\"p1\">[</bpt>Path Animations Overview<ept id=\"p1\">](path-animations-overview.md)</ept>","source":"[Path Animations Overview](path-animations-overview.md)"},{"pos":[13691,13734],"content":"<bpt id=\"p1\">[</bpt>Animation Overview<ept id=\"p1\">](animation-overview.md)</ept>","source":"[Animation Overview](animation-overview.md)"},{"pos":[13737,13816],"content":"<bpt id=\"p1\">[</bpt>Animation and Timing System Overview<ept id=\"p1\">](animation-and-timing-system-overview.md)</ept>","source":"[Animation and Timing System Overview](animation-and-timing-system-overview.md)"},{"pos":[13819,13892],"content":"<bpt id=\"p1\">[</bpt>Custom Animation Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159981)</ept>","source":"[Custom Animation Sample](https://go.microsoft.com/fwlink/?LinkID=159981)"}]}