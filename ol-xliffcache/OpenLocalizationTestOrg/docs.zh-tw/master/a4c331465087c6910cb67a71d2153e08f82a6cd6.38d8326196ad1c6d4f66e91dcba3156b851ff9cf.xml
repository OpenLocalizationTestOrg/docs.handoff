{"content":"---\ntitle: \"Configuring the Windows Process Activation Service for Use with Windows Communication Foundation\"\nms.date: \"03/30/2017\"\nms.assetid: 1d50712e-53cd-4773-b8bc-a1e1aad66b78\n---\n# Configuring the Windows Process Activation Service for Use with Windows Communication Foundation\nThis topic describes the steps required to set up Windows Process Activation Service (also known as WAS) in [!INCLUDE[wv](../../../../includes/wv-md.md)] to host Windows Communication Foundation (WCF) services that do not communicate over HTTP network protocols. The following sections outline the steps for this configuration:  \n  \n-   Install (or confirm the installation of) the WCF activation components required.  \n  \n-   Create a WAS site with the network protocol bindings you wish to use, or add a new protocol binding to an existing site.  \n  \n-   Create an application to host your services and enable that application to use the required network protocols.  \n  \n-   Build a WCF service that exposes a non-HTTP endpoint.  \n  \n## Configuring a Site with Non-HTTP bindings  \n To use a non-HTTP binding with WAS, the site binding must be added to the WAS configuration. The configuration store for WAS is the applicationHost.config file, located in the %windir%\\system32\\inetsrv\\config directory. This configuration store is shared by both WAS and IIS 7.0.  \n  \n applicationHost.config is an XML text file that can be opened with any standard text editor (such as Notepad). However, the [!INCLUDE[iisver](../../../../includes/iisver-md.md)] command-line configuration tool (appcmd.exe) is the preferred way to add non-HTTP site bindings.  \n  \n The following command adds a net.tcp site binding to the default Web site using appcmd.exe (this command is entered as a single line).  \n  \n```console  \nappcmd.exe set site \"Default Web Site\" -+bindings.[protocol='net.tcp',bindingInformation='808:*']  \n```  \n  \n This command adds the new net.tcp binding to the default Web site by adding the line indicated below to the applicationHost.config file.  \n  \n```xml  \n<sites>  \n    <site name=\"Default Web Site\" id=\"1\">  \n        <bindings>  \n            <binding protocol=\"HTTP\" bindingInformation=\"*:80:\" />  \n            //The following line is added by the command.  \n            <binding protocol=\"net.tcp\" bindingInformation=\"808:*\" />  \n        </bindings>  \n    </site>  \n</sites>  \n```  \n  \n## Enabling an Application to Use Non-HTTP Protocols  \n You can enable or disable individual network protocolsat the application level. The following command illustrates how to enable both the HTTP and net.tcp protocols for an application that runs in the `Default Web Site`.  \n  \n```console  \nappcmd.exe set app \"Default Web Site/appOne\" /enabledProtocols:net.tcp  \n```  \n  \n The list of enabled protocols can also be set in the \\<applicationDefaults> element of the site’s XML configuration stored in ApplicationHost.config.  \n  \n The following XML code from applicationHost.config illustrates a site bound to both HTTP and non-HTTP protocols. The additional configuration required to support non-HTTP protocols is called out with comments.  \n  \n```xml  \n<sites>  \n    <site name=\"Default Web Site\" id=\"1\">  \n    <application path=\"/\">  \n        <virtualDirectory path=\"/\" physicalPath=\"D:\\inetpub\\wwwroot\" />  \n    </application>  \n       <bindings>  \n            //The following two lines are added by the command.  \n            <binding protocol=\"HTTP\" bindingInformation=\"*:80:\" />  \n            <binding protocol=\"net.tcp\" bindingInformation=\"808:*\" />  \n       </bindings>  \n    </site>  \n    <siteDefaults>  \n        <logFile   \n        customLogPluginClsid=\"{FF160663-DE82-11CF-BC0A-00AA006111E0}\"  \n          directory=\"D:\\inetpub\\logs\\LogFiles\" />  \n        <traceFailedRequestsLogging   \n          directory=\"D:\\inetpub\\logs\\FailedReqLogFiles\" />  \n    </siteDefaults>  \n    <applicationDefaults   \n      applicationPool=\"DefaultAppPool\"   \n      //The following line is inserted by the command.  \n      enabledProtocols=\"http, net.tcp\" />  \n    <virtualDirectoryDefaults allowSubDirConfig=\"true\" />  \n</sites>  \n```  \n  \n If you attempt to activate a service using WAS for Non-HTTP activation and you have not installed and configured WAS you may see the following error:  \n  \n```output  \n[InvalidOperationException: The protocol 'net.tcp' does not have an implementation of HostedTransportConfiguration type registered.]   System.ServiceModel.AsyncResult.End(IAsyncResult result) +15778592   System.ServiceModel.Activation.HostedHttpRequestAsyncResult.End(IAsyncResult result) +15698937   System.ServiceModel.Activation.HostedHttpRequestAsyncResult.ExecuteSynchronous(HttpApplication context, Boolean flowContext) +265   System.ServiceModel.Activation.HttpModule.ProcessRequest(Object sender, EventArgs e) +227   System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +80   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +171  \n```  \n  \n If you see this error ensure WAS for Non-HTTP Activation is installed and configured properly. For more information, see [How to: Install and Configure WCF Activation Components](../../../../docs/framework/wcf/feature-details/how-to-install-and-configure-wcf-activation-components.md).  \n  \n## Building a WCF Service That Uses WAS for Non-HTTP activation  \n Once you perform the steps to install and configure WAS (see [How to: Install and Configure WCF Activation Components](../../../../docs/framework/wcf/feature-details/how-to-install-and-configure-wcf-activation-components.md)), configuring a service to use WAS for activation is similar to configuring a service that is hosted in IIS.  \n  \n For detailed instructions about building a WAS-activated WCF service, see [How to: Host a WCF Service in WAS](../../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-was.md).  \n  \n## See also\n\n- [Hosting in Windows Process Activation Service](../../../../docs/framework/wcf/feature-details/hosting-in-windows-process-activation-service.md)\n- [Windows Server App Fabric Hosting Features](https://go.microsoft.com/fwlink/?LinkId=201276)\n","nodes":[{"pos":[4,180],"embed":true,"restype":"x-metadata","content":"title: \"Configuring the Windows Process Activation Service for Use with Windows Communication Foundation\"\nms.date: \"03/30/2017\"\nms.assetid: 1d50712e-53cd-4773-b8bc-a1e1aad66b78","nodes":[{"content":"Configuring the Windows Process Activation Service for Use with Windows Communication Foundation","nodes":[{"pos":[0,96],"content":"Configuring the Windows Process Activation Service for Use with Windows Communication Foundation","nodes":[{"content":"Configuring the Windows Process Activation Service for Use with Windows Communication Foundation","pos":[0,96]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[187,283],"content":"Configuring the Windows Process Activation Service for Use with Windows Communication Foundation","linkify":"Configuring the Windows Process Activation Service for Use with Windows Communication Foundation","nodes":[{"content":"Configuring the Windows Process Activation Service for Use with Windows Communication Foundation","pos":[0,96]}]},{"content":"This topic describes the steps required to set up Windows Process Activation Service (also known as WAS) in <ph id=\"ph1\">[!INCLUDE[wv](../../../../includes/wv-md.md)]</ph> to host Windows Communication Foundation (WCF) services that do not communicate over HTTP network protocols.","pos":[284,546],"source":"This topic describes the steps required to set up Windows Process Activation Service (also known as WAS) in [!INCLUDE[wv](../../../../includes/wv-md.md)] to host Windows Communication Foundation (WCF) services that do not communicate over HTTP network protocols."},{"content":"The following sections outline the steps for this configuration:","pos":[547,611]},{"content":"Install (or confirm the installation of) the WCF activation components required.","pos":[621,701]},{"content":"Create a WAS site with the network protocol bindings you wish to use, or add a new protocol binding to an existing site.","pos":[711,831]},{"content":"Create an application to host your services and enable that application to use the required network protocols.","pos":[841,951]},{"content":"Build a WCF service that exposes a non-HTTP endpoint.","pos":[961,1014]},{"pos":[1023,1064],"content":"Configuring a Site with Non-HTTP bindings","linkify":"Configuring a Site with Non-HTTP bindings","nodes":[{"content":"Configuring a Site with Non-HTTP bindings","pos":[0,41]}]},{"content":"To use a non-HTTP binding with WAS, the site binding must be added to the WAS configuration.","pos":[1068,1160]},{"content":"The configuration store for WAS is the applicationHost.config file, located in the %windir%\\system32\\inetsrv\\config directory.","pos":[1161,1287]},{"content":"This configuration store is shared by both WAS and IIS 7.0.","pos":[1288,1347]},{"content":"applicationHost.config is an XML text file that can be opened with any standard text editor (such as Notepad).","pos":[1354,1464]},{"content":"However, the <ph id=\"ph1\">[!INCLUDE[iisver](../../../../includes/iisver-md.md)]</ph> command-line configuration tool (appcmd.exe) is the preferred way to add non-HTTP site bindings.","pos":[1465,1628],"source":" However, the [!INCLUDE[iisver](../../../../includes/iisver-md.md)] command-line configuration tool (appcmd.exe) is the preferred way to add non-HTTP site bindings."},{"content":"The following command adds a net.tcp site binding to the default Web site using appcmd.exe (this command is entered as a single line).","pos":[1635,1769]},{"content":"This command adds the new net.tcp binding to the default Web site by adding the line indicated below to the applicationHost.config file.","pos":[1898,2034]},{"pos":[2384,2433],"content":"Enabling an Application to Use Non-HTTP Protocols","linkify":"Enabling an Application to Use Non-HTTP Protocols","nodes":[{"content":"Enabling an Application to Use Non-HTTP Protocols","pos":[0,49]}]},{"content":"You can enable or disable individual network protocolsat the application level.","pos":[2437,2516]},{"content":"The following command illustrates how to enable both the HTTP and net.tcp protocols for an application that runs in the <ph id=\"ph1\">`Default Web Site`</ph>.","pos":[2517,2656],"source":" The following command illustrates how to enable both the HTTP and net.tcp protocols for an application that runs in the `Default Web Site`."},{"content":"The list of enabled protocols can also be set in the <ph id=\"ph1\">\\&lt;</ph>applicationDefaults&gt; element of the site’s XML configuration stored in ApplicationHost.config.","pos":[2758,2907],"source":"The list of enabled protocols can also be set in the \\<applicationDefaults> element of the site’s XML configuration stored in ApplicationHost.config."},{"content":"The following XML code from applicationHost.config illustrates a site bound to both HTTP and non-HTTP protocols.","pos":[2914,3026]},{"content":"The additional configuration required to support non-HTTP protocols is called out with comments.","pos":[3027,3123]},{"content":"If you attempt to activate a service using WAS for Non-HTTP activation and you have not installed and configured WAS you may see the following error:","pos":[4117,4266]},{"content":"If you see this error ensure WAS for Non-HTTP Activation is installed and configured properly.","pos":[5011,5105]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Install and Configure WCF Activation Components<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-install-and-configure-wcf-activation-components.md)</ept>.","pos":[5106,5296],"source":" For more information, see [How to: Install and Configure WCF Activation Components](../../../../docs/framework/wcf/feature-details/how-to-install-and-configure-wcf-activation-components.md)."},{"pos":[5305,5365],"content":"Building a WCF Service That Uses WAS for Non-HTTP activation","linkify":"Building a WCF Service That Uses WAS for Non-HTTP activation","nodes":[{"content":"Building a WCF Service That Uses WAS for Non-HTTP activation","pos":[0,60]}]},{"pos":[5369,5702],"content":"Once you perform the steps to install and configure WAS (see <bpt id=\"p1\">[</bpt>How to: Install and Configure WCF Activation Components<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-install-and-configure-wcf-activation-components.md)</ept>), configuring a service to use WAS for activation is similar to configuring a service that is hosted in IIS.","source":"Once you perform the steps to install and configure WAS (see [How to: Install and Configure WCF Activation Components](../../../../docs/framework/wcf/feature-details/how-to-install-and-configure-wcf-activation-components.md)), configuring a service to use WAS for activation is similar to configuring a service that is hosted in IIS."},{"pos":[5709,5903],"content":"For detailed instructions about building a WAS-activated WCF service, see <bpt id=\"p1\">[</bpt>How to: Host a WCF Service in WAS<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-was.md)</ept>.","source":"For detailed instructions about building a WAS-activated WCF service, see [How to: Host a WCF Service in WAS](../../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-was.md)."},{"pos":[5912,5920],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5924,6068],"content":"<bpt id=\"p1\">[</bpt>Hosting in Windows Process Activation Service<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/hosting-in-windows-process-activation-service.md)</ept>","source":"[Hosting in Windows Process Activation Service](../../../../docs/framework/wcf/feature-details/hosting-in-windows-process-activation-service.md)"},{"pos":[6071,6163],"content":"<bpt id=\"p1\">[</bpt>Windows Server App Fabric Hosting Features<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=201276)</ept>","source":"[Windows Server App Fabric Hosting Features](https://go.microsoft.com/fwlink/?LinkId=201276)"}]}