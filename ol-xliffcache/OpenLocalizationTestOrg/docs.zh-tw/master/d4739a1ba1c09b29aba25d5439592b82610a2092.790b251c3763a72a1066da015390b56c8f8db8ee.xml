{"content":"---\ntitle: \"Introduction to LINQ Queries (C#) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"CSharp\"\nhelpviewer_keywords: \n  - \"deferred execution [LINQ]\"\n  - \"LINQ, queries\"\n  - \"LINQ, deferred execution\"\n  - \"queries [LINQ], about LINQ queries\"\nms.assetid: 37895c02-268c-41d5-be39-f7d936fa88a8\ncaps.latest.revision: 47\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Introduction to LINQ Queries (C#)\nA *query* is an expression that retrieves data from a data source. Queries are usually expressed in a specialized query language. Different languages have been developed over time for the various types of data sources, for example SQL for relational databases and XQuery for XML. Therefore, developers have had to learn a new query language for each type of data source or data format that they must support. [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] simplifies this situation by offering a consistent model for working with data across various kinds of data sources and formats. In a [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] query, you are always working with objects. You use the same basic coding patterns to query and transform data in XML documents, SQL databases, [!INCLUDE[vstecado](../../../../csharp/programming-guide/concepts/linq/includes/vstecado_md.md)] Datasets, .NET collections, and any other format for which a [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] provider is available.  \n  \n## Three Parts of a Query Operation  \n All [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] query operations consist of three distinct actions:  \n  \n1.  Obtain the data source.  \n  \n2.  Create the query.  \n  \n3.  Execute the query.  \n  \n The following example shows how the three parts of a query operation are expressed in source code. The example uses an integer array as a data source for convenience; however, the same concepts apply to other data sources also. This example is referred to throughout the rest of this topic.  \n  \n [!code-cs[CsLINQGettingStarted#1](../../../../csharp/programming-guide/concepts/linq/codesnippet/CSharp/introduction-to-linq-queries_1.cs)]  \n  \n The following illustration shows the complete query operation. In [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] the execution of the query is distinct from the query itself; in other words you have not retrieved any data just by creating a query variable.  \n  \n ![Complete LINQ Query Operation](../../../../csharp/programming-guide/concepts/linq/media/linq_query.png \"LINQ_Query\")  \n  \n## The Data Source  \n In the previous example, because the data source is an array, it implicitly supports the generic <xref:System.Collections.Generic.IEnumerable%601> interface. This fact means it can be queried with [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]. A query is executed in a `foreach` statement, and `foreach` requires <xref:System.Collections.IEnumerable> or <xref:System.Collections.Generic.IEnumerable%601>. Types that support <xref:System.Collections.Generic.IEnumerable%601> or a derived interface such as the generic <xref:System.Linq.IQueryable%601> are called *queryable types*.  \n  \n A queryable type requires no modification or special treatment to serve as a [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] data source. If the source data is not already in memory as a queryable type, the [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] provider must represent it as such. For example, [!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)] loads an XML document into a queryable <xref:System.Xml.Linq.XElement> type:  \n  \n [!code-cs[CsLINQGettingStarted#2](../../../../csharp/programming-guide/concepts/linq/codesnippet/CSharp/introduction-to-linq-queries_2.cs)]  \n  \n With [!INCLUDE[vbtecdlinq](../../../../csharp/includes/vbtecdlinq_md.md)], you first create an object-relational mapping at design time either manually or by using the [LINQ to SQL Tools in Visual Studio](https://docs.microsoft.com/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2) in Visual Studio. You write your queries against the objects, and at run-time [!INCLUDE[vbtecdlinq](../../../../csharp/includes/vbtecdlinq_md.md)] handles the communication with the database. In the following example, `Customers` represents a specific table in the database, and the type of the query result, <xref:System.Linq.IQueryable%601>, derives from <xref:System.Collections.Generic.IEnumerable%601>.  \n  \n```csharp  \nNorthwnd db = new Northwnd(@\"c:\\northwnd.mdf\");  \n  \n// Query for customers in London.  \nIQueryable<Customer> custQuery =  \n    from cust in db.Customers  \n    where cust.City == \"London\"  \n    select cust;  \n  \n```  \n  \n For more information about how to create specific types of data sources, see the documentation for the various [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] providers. However, the basic rule is very simple: a [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] data source is any object that supports the generic <xref:System.Collections.Generic.IEnumerable%601> interface, or an interface that inherits from it.  \n  \n> [!NOTE]\n>  Types such as <xref:System.Collections.ArrayList> that support the non-generic <xref:System.Collections.IEnumerable> interface can also be used as a [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] data source. For more information, see [How to: Query an ArrayList with LINQ (C#)](../../../../csharp/programming-guide/concepts/linq/how-to-query-an-arraylist-with-linq.md).  \n  \n##  <a name=\"query\"></a> The Query  \n The query specifies what information to retrieve from the data source or sources. Optionally, a query also specifies how that information should be sorted, grouped, and shaped before it is returned. A query is stored in a query variable and initialized with a query expression. To make it easier to write queries, C# has introduced new query syntax.  \n  \n The query in the previous example returns all the even numbers from the integer array. The query expression contains three clauses: `from`, `where` and `select`. (If you are familiar with SQL, you will have noticed that the ordering of the clauses is reversed from the order in SQL.) The `from` clause specifies the data source, the `where` clause applies the filter, and the `select` clause specifies the type of the returned elements. These and the other query clauses are discussed in detail in the [LINQ Query Expressions](../../../../csharp/programming-guide/linq-query-expressions/index.md) section. For now, the important point is that in [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)], the query variable itself takes no action and returns no data. It just stores the information that is required to produce the results when the query is executed at some later point. For more information about how queries are constructed behind the scenes, see [Standard Query Operators Overview (C#)](../../../../csharp/programming-guide/concepts/linq/standard-query-operators-overview.md).  \n  \n> [!NOTE]\n>  Queries can also be expressed by using method syntax. For more information, see [Query Syntax and Method Syntax in LINQ](../../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md).  \n  \n## Query Execution  \n  \n### Deferred Execution  \n As stated previously, the query variable itself only stores the query commands. The actual execution of the query is deferred until you iterate over the query variable in a `foreach` statement. This concept is referred to as *deferred execution* and is demonstrated in the following example:  \n  \n [!code-cs[csLinqGettingStarted#4](../../../../csharp/programming-guide/concepts/linq/codesnippet/CSharp/introduction-to-linq-queries_3.cs)]  \n  \n The `foreach` statement is also where the query results are retrieved. For example, in the previous query, the iteration variable `num` holds each value (one at a time) in the returned sequence.  \n  \n Because the query variable itself never holds the query results, you can execute it as often as you like. For example, you may have a database that is being updated continually by a separate application. In your application, you could create one query that retrieves the latest data, and you could execute it repeatedly at some interval to retrieve different results every time.  \n  \n### Forcing Immediate Execution  \n Queries that perform aggregation functions over a range of source elements must first iterate over those elements. Examples of such queries are `Count`, `Max`, `Average`, and `First`. These execute without an explicit `foreach` statement because the query itself must use `foreach` in order to return a result. Note also that these types of queries return a single value, not an `IEnumerable` collection. The following query returns a count of the even numbers in the source array:  \n  \n [!code-cs[csLinqGettingStarted#5](../../../../csharp/programming-guide/concepts/linq/codesnippet/CSharp/introduction-to-linq-queries_4.cs)]  \n  \n To force immediate execution of any query and cache its results, you can call the <xref:System.Linq.Enumerable.ToList%2A> or <xref:System.Linq.Enumerable.ToArray%2A> methods.  \n  \n [!code-cs[csLinqGettingStarted#6](../../../../csharp/programming-guide/concepts/linq/codesnippet/CSharp/introduction-to-linq-queries_5.cs)]  \n  \n You can also force execution by putting the `foreach` loop immediately after the query expression. However, by calling `ToList` or `ToArray` you also cache all the data in a single collection object.  \n  \n## See Also  \n [Getting Started with LINQ in C#](../../../../csharp/programming-guide/concepts/linq/getting-started-with-linq.md)   \n [Walkthrough: Writing Queries in C#](../../../../csharp/programming-guide/concepts/linq/walkthrough-writing-queries-linq.md)   \n [Walkthrough: Writing Queries in C#](../../../../csharp/programming-guide/concepts/linq/walkthrough-writing-queries-linq.md)   \n [LINQ Query Expressions](../../../../csharp/programming-guide/linq-query-expressions/index.md)   \n [foreach, in](../../../../csharp/language-reference/keywords/foreach-in.md)   \n [Query Keywords (LINQ)](../../../../csharp/language-reference/keywords/query-keywords.md)\n","nodes":[{"pos":[4,695],"embed":true,"restype":"x-metadata","content":"title: \"Introduction to LINQ Queries (C#) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"CSharp\"\nhelpviewer_keywords: \n  - \"deferred execution [LINQ]\"\n  - \"LINQ, queries\"\n  - \"LINQ, deferred execution\"\n  - \"queries [LINQ], about LINQ queries\"\nms.assetid: 37895c02-268c-41d5-be39-f7d936fa88a8\ncaps.latest.revision: 47\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"","nodes":[{"content":"Introduction to LINQ Queries (C#) | Microsoft Docs","nodes":[{"pos":[0,50],"content":"Introduction to LINQ Queries (C#) | Microsoft Docs","nodes":[{"content":"Introduction to LINQ Queries (C#) | Microsoft Docs","pos":[0,50]}]}],"path":["title"]}],"yml":true},{"pos":[702,735],"content":"Introduction to LINQ Queries (C#)","linkify":"Introduction to LINQ Queries (C#)","nodes":[{"content":"Introduction to LINQ Queries (C#)","pos":[0,33]}]},{"content":"A <bpt id=\"p1\">*</bpt>query<ept id=\"p1\">*</ept> is an expression that retrieves data from a data source.","pos":[736,802],"source":"A *query* is an expression that retrieves data from a data source."},{"content":"Queries are usually expressed in a specialized query language.","pos":[803,865]},{"content":"Different languages have been developed over time for the various types of data sources, for example SQL for relational databases and XQuery for XML.","pos":[866,1015]},{"content":"Therefore, developers have had to learn a new query language for each type of data source or data format that they must support.","pos":[1016,1144]},{"content":"<ph id=\"ph1\">[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]</ph> simplifies this situation by offering a consistent model for working with data across various kinds of data sources and formats.","pos":[1145,1340],"source":"[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] simplifies this situation by offering a consistent model for working with data across various kinds of data sources and formats."},{"content":"In a <ph id=\"ph1\">[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]</ph> query, you are always working with objects.","pos":[1341,1456],"source":" In a [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] query, you are always working with objects."},{"content":"You use the same basic coding patterns to query and transform data in XML documents, SQL databases, <ph id=\"ph1\">[!INCLUDE[vstecado](../../../../csharp/programming-guide/concepts/linq/includes/vstecado_md.md)]</ph> Datasets, .NET collections, and any other format for which a <ph id=\"ph2\">[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]</ph> provider is available.","pos":[1457,1804],"source":" You use the same basic coding patterns to query and transform data in XML documents, SQL databases, [!INCLUDE[vstecado](../../../../csharp/programming-guide/concepts/linq/includes/vstecado_md.md)] Datasets, .NET collections, and any other format for which a [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] provider is available."},{"pos":[1813,1845],"content":"Three Parts of a Query Operation","linkify":"Three Parts of a Query Operation","nodes":[{"content":"Three Parts of a Query Operation","pos":[0,32]}]},{"pos":[1849,1971],"content":"All <ph id=\"ph1\">[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]</ph> query operations consist of three distinct actions:","source":"All [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] query operations consist of three distinct actions:"},{"content":"Obtain the data source.","pos":[1981,2004]},{"content":"Create the query.","pos":[2014,2031]},{"content":"Execute the query.","pos":[2041,2059]},{"content":"The following example shows how the three parts of a query operation are expressed in source code.","pos":[2066,2164]},{"content":"The example uses an integer array as a data source for convenience; however, the same concepts apply to other data sources also.","pos":[2165,2293]},{"content":"This example is referred to throughout the rest of this topic.","pos":[2294,2356]},{"content":"The following illustration shows the complete query operation.","pos":[2509,2571]},{"content":"In <ph id=\"ph1\">[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]</ph> the execution of the query is distinct from the query itself; in other words you have not retrieved any data just by creating a query variable.","pos":[2572,2785],"source":" In [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] the execution of the query is distinct from the query itself; in other words you have not retrieved any data just by creating a query variable."},{"pos":[2792,2910],"content":"<bpt id=\"p1\">![</bpt>Complete LINQ Query Operation<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../csharp/programming-guide/concepts/linq/media/linq_query.png \"</bpt>LINQ_Query<ept id=\"p2\">\")</ept>","source":"![Complete LINQ Query Operation](../../../../csharp/programming-guide/concepts/linq/media/linq_query.png \"LINQ_Query\")"},{"pos":[2919,2934],"content":"The Data Source","linkify":"The Data Source","nodes":[{"content":"The Data Source","pos":[0,15]}]},{"content":"In the previous example, because the data source is an array, it implicitly supports the generic <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> interface.","pos":[2938,3095],"source":"In the previous example, because the data source is an array, it implicitly supports the generic <xref:System.Collections.Generic.IEnumerable%601> interface."},{"content":"This fact means it can be queried with <ph id=\"ph1\">[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]</ph>.","pos":[3096,3202],"source":" This fact means it can be queried with [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]."},{"content":"A query is executed in a <ph id=\"ph1\">`foreach`</ph> statement, and <ph id=\"ph2\">`foreach`</ph> requires <ph id=\"ph3\">&lt;xref:System.Collections.IEnumerable&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph>.","pos":[3203,3363],"source":" A query is executed in a `foreach` statement, and `foreach` requires <xref:System.Collections.IEnumerable> or <xref:System.Collections.Generic.IEnumerable%601>."},{"content":"Types that support <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> or a derived interface such as the generic <ph id=\"ph2\">&lt;xref:System.Linq.IQueryable%601&gt;</ph> are called <bpt id=\"p1\">*</bpt>queryable types<ept id=\"p1\">*</ept>.","pos":[3364,3539],"source":" Types that support <xref:System.Collections.Generic.IEnumerable%601> or a derived interface such as the generic <xref:System.Linq.IQueryable%601> are called *queryable types*."},{"content":"A queryable type requires no modification or special treatment to serve as a <ph id=\"ph1\">[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]</ph> data source.","pos":[3546,3702],"source":"A queryable type requires no modification or special treatment to serve as a [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] data source."},{"content":"If the source data is not already in memory as a queryable type, the <ph id=\"ph1\">[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]</ph> provider must represent it as such.","pos":[3703,3874],"source":" If the source data is not already in memory as a queryable type, the [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] provider must represent it as such."},{"content":"For example, <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)]</ph> loads an XML document into a queryable <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> type:","pos":[3875,4067],"source":" For example, [!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)] loads an XML document into a queryable <xref:System.Xml.Linq.XElement> type:"},{"content":"With <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../csharp/includes/vbtecdlinq_md.md)]</ph>, you first create an object-relational mapping at design time either manually or by using the <bpt id=\"p1\">[</bpt>LINQ to SQL Tools in Visual Studio<ept id=\"p1\">](https://docs.microsoft.com/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)</ept> in Visual Studio.","pos":[4220,4530],"source":"With [!INCLUDE[vbtecdlinq](../../../../csharp/includes/vbtecdlinq_md.md)], you first create an object-relational mapping at design time either manually or by using the [LINQ to SQL Tools in Visual Studio](https://docs.microsoft.com/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2) in Visual Studio."},{"content":"You write your queries against the objects, and at run-time <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../csharp/includes/vbtecdlinq_md.md)]</ph> handles the communication with the database.","pos":[4531,4704],"source":" You write your queries against the objects, and at run-time [!INCLUDE[vbtecdlinq](../../../../csharp/includes/vbtecdlinq_md.md)] handles the communication with the database."},{"content":"In the following example, <ph id=\"ph1\">`Customers`</ph> represents a specific table in the database, and the type of the query result, <ph id=\"ph2\">&lt;xref:System.Linq.IQueryable%601&gt;</ph>, derives from <ph id=\"ph3\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph>.","pos":[4705,4920],"source":" In the following example, `Customers` represents a specific table in the database, and the type of the query result, <xref:System.Linq.IQueryable%601>, derives from <xref:System.Collections.Generic.IEnumerable%601>."},{"content":"For more information about how to create specific types of data sources, see the documentation for the various <ph id=\"ph1\">[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]</ph> providers.","pos":[5160,5348],"source":"For more information about how to create specific types of data sources, see the documentation for the various [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] providers."},{"content":"However, the basic rule is very simple: a <ph id=\"ph1\">[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]</ph> data source is any object that supports the generic <ph id=\"ph2\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> interface, or an interface that inherits from it.","pos":[5349,5609],"source":" However, the basic rule is very simple: a [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] data source is any object that supports the generic <xref:System.Collections.Generic.IEnumerable%601> interface, or an interface that inherits from it."},{"pos":[5617,6018],"content":"[!NOTE]\n Types such as <xref:System.Collections.ArrayList> that support the non-generic <xref:System.Collections.IEnumerable> interface can also be used as a [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] data source. For more information, see [How to: Query an ArrayList with LINQ (C#)](../../../../csharp/programming-guide/concepts/linq/how-to-query-an-arraylist-with-linq.md).","leadings":["","> "],"nodes":[{"content":"Types such as <xref:System.Collections.ArrayList> that support the non-generic <xref:System.Collections.IEnumerable> interface can also be used as a [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] data source. For more information, see [How to: Query an ArrayList with LINQ (C#)](../../../../csharp/programming-guide/concepts/linq/how-to-query-an-arraylist-with-linq.md).","pos":[9,399],"nodes":[{"content":"Types such as <ph id=\"ph1\">&lt;xref:System.Collections.ArrayList&gt;</ph> that support the non-generic <ph id=\"ph2\">&lt;xref:System.Collections.IEnumerable&gt;</ph> interface can also be used as a <ph id=\"ph3\">[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]</ph> data source.","pos":[0,228],"source":"Types such as <xref:System.Collections.ArrayList> that support the non-generic <xref:System.Collections.IEnumerable> interface can also be used as a [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] data source."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Query an ArrayList with LINQ (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/how-to-query-an-arraylist-with-linq.md)</ept>.","pos":[229,390],"source":" For more information, see [How to: Query an ArrayList with LINQ (C#)](../../../../csharp/programming-guide/concepts/linq/how-to-query-an-arraylist-with-linq.md)."}]}]},{"pos":[6028,6058],"content":"<bpt id=\"p1\">&lt;a name=\"query\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> The Query","linkify":"<a name=\"query\"></a> The Query","source":"<a name=\"query\"></a> The Query"},{"content":"The query specifies what information to retrieve from the data source or sources.","pos":[6062,6143]},{"content":"Optionally, a query also specifies how that information should be sorted, grouped, and shaped before it is returned.","pos":[6144,6260]},{"content":"A query is stored in a query variable and initialized with a query expression.","pos":[6261,6339]},{"content":"To make it easier to write queries, C# has introduced new query syntax.","pos":[6340,6411]},{"content":"The query in the previous example returns all the even numbers from the integer array.","pos":[6418,6504]},{"content":"The query expression contains three clauses: <ph id=\"ph1\">`from`</ph>, <ph id=\"ph2\">`where`</ph> and <ph id=\"ph3\">`select`</ph>.","pos":[6505,6579],"source":" The query expression contains three clauses: `from`, `where` and `select`."},{"content":"(If you are familiar with SQL, you will have noticed that the ordering of the clauses is reversed from the order in SQL.) The <ph id=\"ph1\">`from`</ph> clause specifies the data source, the <ph id=\"ph2\">`where`</ph> clause applies the filter, and the <ph id=\"ph3\">`select`</ph> clause specifies the type of the returned elements.","pos":[6580,6854],"source":" (If you are familiar with SQL, you will have noticed that the ordering of the clauses is reversed from the order in SQL.) The `from` clause specifies the data source, the `where` clause applies the filter, and the `select` clause specifies the type of the returned elements."},{"content":"These and the other query clauses are discussed in detail in the <bpt id=\"p1\">[</bpt>LINQ Query Expressions<ept id=\"p1\">](../../../../csharp/programming-guide/linq-query-expressions/index.md)</ept> section.","pos":[6855,7023],"source":" These and the other query clauses are discussed in detail in the [LINQ Query Expressions](../../../../csharp/programming-guide/linq-query-expressions/index.md) section."},{"content":"For now, the important point is that in <ph id=\"ph1\">[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]</ph>, the query variable itself takes no action and returns no data.","pos":[7024,7194],"source":" For now, the important point is that in [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)], the query variable itself takes no action and returns no data."},{"content":"It just stores the information that is required to produce the results when the query is executed at some later point.","pos":[7195,7313]},{"content":"For more information about how queries are constructed behind the scenes, see <bpt id=\"p1\">[</bpt>Standard Query Operators Overview (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/standard-query-operators-overview.md)</ept>.","pos":[7314,7522],"source":" For more information about how queries are constructed behind the scenes, see [Standard Query Operators Overview (C#)](../../../../csharp/programming-guide/concepts/linq/standard-query-operators-overview.md)."},{"pos":[7530,7756],"content":"[!NOTE]\n Queries can also be expressed by using method syntax. For more information, see [Query Syntax and Method Syntax in LINQ](../../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md).","leadings":["","> "],"nodes":[{"content":"Queries can also be expressed by using method syntax. For more information, see [Query Syntax and Method Syntax in LINQ](../../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md).","pos":[9,224],"nodes":[{"content":"Queries can also be expressed by using method syntax.","pos":[0,53]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Query Syntax and Method Syntax in LINQ<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md)</ept>.","pos":[54,215],"source":" For more information, see [Query Syntax and Method Syntax in LINQ](../../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md)."}]}]},{"pos":[7765,7780],"content":"Query Execution","linkify":"Query Execution","nodes":[{"content":"Query Execution","pos":[0,15]}]},{"pos":[7790,7808],"content":"Deferred Execution","linkify":"Deferred Execution","nodes":[{"content":"Deferred Execution","pos":[0,18]}]},{"content":"As stated previously, the query variable itself only stores the query commands.","pos":[7812,7891]},{"content":"The actual execution of the query is deferred until you iterate over the query variable in a <ph id=\"ph1\">`foreach`</ph> statement.","pos":[7892,8005],"source":" The actual execution of the query is deferred until you iterate over the query variable in a `foreach` statement."},{"content":"This concept is referred to as <bpt id=\"p1\">*</bpt>deferred execution<ept id=\"p1\">*</ept> and is demonstrated in the following example:","pos":[8006,8103],"source":" This concept is referred to as *deferred execution* and is demonstrated in the following example:"},{"content":"The <ph id=\"ph1\">`foreach`</ph> statement is also where the query results are retrieved.","pos":[8256,8326],"source":"The `foreach` statement is also where the query results are retrieved."},{"content":"For example, in the previous query, the iteration variable <ph id=\"ph1\">`num`</ph> holds each value (one at a time) in the returned sequence.","pos":[8327,8450],"source":" For example, in the previous query, the iteration variable `num` holds each value (one at a time) in the returned sequence."},{"content":"Because the query variable itself never holds the query results, you can execute it as often as you like.","pos":[8457,8562]},{"content":"For example, you may have a database that is being updated continually by a separate application.","pos":[8563,8660]},{"content":"In your application, you could create one query that retrieves the latest data, and you could execute it repeatedly at some interval to retrieve different results every time.","pos":[8661,8835]},{"pos":[8845,8872],"content":"Forcing Immediate Execution","linkify":"Forcing Immediate Execution","nodes":[{"content":"Forcing Immediate Execution","pos":[0,27]}]},{"content":"Queries that perform aggregation functions over a range of source elements must first iterate over those elements.","pos":[8876,8990]},{"content":"Examples of such queries are <ph id=\"ph1\">`Count`</ph>, <ph id=\"ph2\">`Max`</ph>, <ph id=\"ph3\">`Average`</ph>, and <ph id=\"ph4\">`First`</ph>.","pos":[8991,9059],"source":" Examples of such queries are `Count`, `Max`, `Average`, and `First`."},{"content":"These execute without an explicit <ph id=\"ph1\">`foreach`</ph> statement because the query itself must use <ph id=\"ph2\">`foreach`</ph> in order to return a result.","pos":[9060,9186],"source":" These execute without an explicit `foreach` statement because the query itself must use `foreach` in order to return a result."},{"content":"Note also that these types of queries return a single value, not an <ph id=\"ph1\">`IEnumerable`</ph> collection.","pos":[9187,9280],"source":" Note also that these types of queries return a single value, not an `IEnumerable` collection."},{"content":"The following query returns a count of the even numbers in the source array:","pos":[9281,9357]},{"content":"To force immediate execution of any query and cache its results, you can call the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.ToList%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.ToArray%2A&gt;</ph> methods.","pos":[9510,9684],"source":"To force immediate execution of any query and cache its results, you can call the <xref:System.Linq.Enumerable.ToList%2A> or <xref:System.Linq.Enumerable.ToArray%2A> methods."},{"content":"You can also force execution by putting the <ph id=\"ph1\">`foreach`</ph> loop immediately after the query expression.","pos":[9837,9935],"source":"You can also force execution by putting the `foreach` loop immediately after the query expression."},{"content":"However, by calling <ph id=\"ph1\">`ToList`</ph> or <ph id=\"ph2\">`ToArray`</ph> you also cache all the data in a single collection object.","pos":[9936,10036],"source":" However, by calling `ToList` or `ToArray` you also cache all the data in a single collection object."},{"pos":[10045,10053],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Getting Started with LINQ in C#<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/getting-started-with-linq.md)</ept><ph id=\"ph1\"> </ph>","pos":[10057,10172],"source":"[Getting Started with LINQ in C#](../../../../csharp/programming-guide/concepts/linq/getting-started-with-linq.md) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Writing Queries in C#<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/walkthrough-writing-queries-linq.md)</ept><ph id=\"ph1\"> </ph>","pos":[10176,10301],"source":"[Walkthrough: Writing Queries in C#](../../../../csharp/programming-guide/concepts/linq/walkthrough-writing-queries-linq.md) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Writing Queries in C#<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/walkthrough-writing-queries-linq.md)</ept><ph id=\"ph1\"> </ph>","pos":[10305,10430],"source":"[Walkthrough: Writing Queries in C#](../../../../csharp/programming-guide/concepts/linq/walkthrough-writing-queries-linq.md) "},{"content":"<bpt id=\"p1\">[</bpt>LINQ Query Expressions<ept id=\"p1\">](../../../../csharp/programming-guide/linq-query-expressions/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[10434,10529],"source":"[LINQ Query Expressions](../../../../csharp/programming-guide/linq-query-expressions/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>foreach, in<ept id=\"p1\">](../../../../csharp/language-reference/keywords/foreach-in.md)</ept><ph id=\"ph1\"> </ph>","pos":[10533,10609],"source":"[foreach, in](../../../../csharp/language-reference/keywords/foreach-in.md) "},{"content":"<bpt id=\"p1\">[</bpt>Query Keywords (LINQ)<ept id=\"p1\">](../../../../csharp/language-reference/keywords/query-keywords.md)</ept>","pos":[10613,10702],"source":"[Query Keywords (LINQ)](../../../../csharp/language-reference/keywords/query-keywords.md)"}]}