{"content":"---\ntitle: \"Interoperability with Enterprise Services and COM+ Transactions\"\nms.date: \"03/30/2017\"\nms.assetid: d0fd0d26-fe86-443b-b208-4d57d39fa4aa\n---\n# Interoperability with Enterprise Services and COM+ Transactions\nThe <xref:System.Transactions> namespace supports interoperability between transaction objects created using this namespace and transactions created through COM+.  \n  \n You can use the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration when you create a new <xref:System.Transactions.TransactionScope> instance to specify the level of interoperability with COM+.  \n  \n By default, when your application code checks the static <xref:System.Transactions.Transaction.Current%2A> property, <xref:System.Transactions> attempts to look for a transaction that is otherwise current, or a <xref:System.Transactions.TransactionScope> object that dictates that <xref:System.Transactions.Transaction.Current%2A> is **null**. If it cannot find either one of these, <xref:System.Transactions> queries the COM+ context for a transaction. Note that even though <xref:System.Transactions> may find a transaction from the COM+ context, it still favors transactions that are native to <xref:System.Transactions>.  \n  \n## Interoperability levels  \n The <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration defines the following levels of interoperability—<xref:System.Transactions.EnterpriseServicesInteropOption.None>, <xref:System.Transactions.EnterpriseServicesInteropOption.Full> and <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic>.  \n  \n The <xref:System.Transactions.TransactionScope> class provides constructors that accept <xref:System.Transactions.EnterpriseServicesInteropOption> as a parameter.  \n  \n <xref:System.Transactions.EnterpriseServicesInteropOption.None>, as the name implies, implies that there is no interoperability between <xref:System.EnterpriseServices> contexts and transaction scopes. After creating a <xref:System.Transactions.TransactionScope> object with <xref:System.Transactions.EnterpriseServicesInteropOption.None>, any changes to <xref:System.Transactions.Transaction.Current%2A> are not reflected in the COM+ context. Similarly, changes to the transaction in the COM+ context are not reflected in <xref:System.Transactions.Transaction.Current%2A>. This is the fastest mode of operation for <xref:System.Transactions> because there is no extra synchronization required. <xref:System.Transactions.EnterpriseServicesInteropOption.None> is the default value used by <xref:System.Transactions.TransactionScope> with all constructors that do not accept <xref:System.Transactions.EnterpriseServicesInteropOption> as a parameter.  \n  \n If you do want to combine <xref:System.EnterpriseServices> transactions with your ambient transaction, you need to use either <xref:System.Transactions.EnterpriseServicesInteropOption.Full> or <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic>. Both of these values rely on a feature called services without components, and therefore you should be running on Windows XP Service Pack 2 or Windows Server 2003 when using them.  \n  \n <xref:System.Transactions.EnterpriseServicesInteropOption.Full> specifies that the ambient transactions for <xref:System.Transactions> and <xref:System.EnterpriseServices> are always the same. It results in creating a new <xref:System.EnterpriseServices> transactional context and applying the transaction that is current for the <xref:System.Transactions.TransactionScope> to be current for that context. As such, the transaction in <xref:System.Transactions.Transaction.Current%2A> is completely in synchronization with the transaction in <xref:System.EnterpriseServices.ContextUtil.Transaction%2A>. This value introduces a performance penalty because new COM+ contexts may need to be created.  \n  \n <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic> specifies the following requirements:  \n  \n-   When <xref:System.Transactions.Transaction.Current%2A> is checked, <xref:System.Transactions> should support transactions in the COM+ context if it detects that it is running in a context other than the default context. Note that the default context cannot contain a transaction. Therefore, in the default context, even with <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic>, the transaction stored in the thread local storage used by <xref:System.Transactions> is returned for <xref:System.Transactions.Transaction.Current%2A>.  \n  \n-   If a new <xref:System.Transactions.TransactionScope> object is created and the creation occurs in a context other than the default context, the transaction that is current for the <xref:System.Transactions.TransactionScope> object should be reflected in COM+. In this case, <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic> behaves like <xref:System.Transactions.EnterpriseServicesInteropOption.Full> in that it creates a new COM+ context.  \n  \n In addition when <xref:System.Transactions.Transaction.Current%2A> is set in both <xref:System.Transactions.EnterpriseServicesInteropOption.Full> and <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic>, both of these modes imply that <xref:System.Transactions.Transaction.Current%2A> cannot be set directly.  Any attempt to set <xref:System.Transactions.Transaction.Current%2A> directly other than creating a <xref:System.Transactions.TransactionScope> results in an <xref:System.InvalidOperationException>. The <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration value is inherited by new transaction scopes that do not explicitly specify which value to use. For example, if you create a new <xref:System.Transactions.TransactionScope> object with <xref:System.Transactions.EnterpriseServicesInteropOption.Full>, and then create a second <xref:System.Transactions.TransactionScope> object but do not specify an <xref:System.Transactions.EnterpriseServicesInteropOption> value, the second <xref:System.Transactions.TransactionScope> object also has a <xref:System.Transactions.EnterpriseServicesInteropOption.Full>.  \n  \n In summary, the following rules apply when creating a new transaction scope:  \n  \n1.  <xref:System.Transactions.Transaction.Current%2A> is checked to see if there is a transaction. This check results in:  \n  \n    -   A check to see if there is a scope.  \n  \n    -   If there is a scope, the value of the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration passed in when the scope was initially created is checked.  \n  \n    -   If the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration is set to <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic>, the COM+ transaction (<xref:System.EnterpriseServices> Transaction) takes precedence over the <xref:System.Transactions> transaction in managed thread local storage.  \n  \n         If the value is set to <xref:System.Transactions.EnterpriseServicesInteropOption.None>, the <xref:System.Transactions> transaction in managed thread local storage takes precedence.  \n  \n         If the value is <xref:System.Transactions.EnterpriseServicesInteropOption.Full>, there is only one transaction and it is a COM+ transaction.  \n  \n2.  The value of the <xref:System.Transactions.TransactionScopeOption> enumeration passed in by the <xref:System.Transactions.TransactionScope> constructor is checked. This determines if a new transaction must be created.  \n  \n3.  If a new transaction is to be created, the following values of <xref:System.Transactions.EnterpriseServicesInteropOption> result in:  \n  \n    -   <xref:System.Transactions.EnterpriseServicesInteropOption.Full>:  a transaction associated with a COM+ context is created.  \n  \n    -   <xref:System.Transactions.EnterpriseServicesInteropOption.None>: a <xref:System.Transactions> transaction is created.  \n  \n    -   <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic>: if there is a COM+ context, a transaction is created and attached to the context.  \n  \n The following table illustrates the Enterprise Services (ES) context and a transactional scope that requires a transaction using the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration.  \n  \n|ES Context|None|Automatic|Full|  \n|----------------|----------|---------------|----------|  \n|Default context|Default context|Default context|Create new <br />transactional context|  \n|Non-default context|Maintain client's context|Create new transactional context|Create new transactional context|  \n  \n The following table illustrates what the ambient transaction is, given a particular <xref:System.EnterpriseServices> context, and a transactional scope that requires a transaction using the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration.  \n  \n|ES Context|None|Automatic|Full|  \n|----------------|----------|---------------|----------|  \n|Default context|ST|ST|ES|  \n|Non-default context|ST|ES|ES|  \n  \n In the preceding table:  \n  \n-   ST means that the scope's ambient transaction is managed by <xref:System.Transactions>, separate from any <xref:System.EnterpriseServices> context's transaction that may be present.  \n  \n-   ES means that the scope's ambient transaction is same as the <xref:System.EnterpriseServices> context's transaction.\n","nodes":[{"pos":[4,147],"embed":true,"restype":"x-metadata","content":"title: \"Interoperability with Enterprise Services and COM+ Transactions\"\nms.date: \"03/30/2017\"\nms.assetid: d0fd0d26-fe86-443b-b208-4d57d39fa4aa","nodes":[{"content":"Interoperability with Enterprise Services and COM+ Transactions","nodes":[{"pos":[0,63],"content":"Interoperability with Enterprise Services and COM+ Transactions","nodes":[{"content":"Interoperability with Enterprise Services and COM+ Transactions","pos":[0,63]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[154,217],"content":"Interoperability with Enterprise Services and COM+ Transactions","linkify":"Interoperability with Enterprise Services and COM+ Transactions","nodes":[{"content":"Interoperability with Enterprise Services and COM+ Transactions","pos":[0,63]}]},{"pos":[218,380],"content":"The <ph id=\"ph1\">&lt;xref:System.Transactions&gt;</ph> namespace supports interoperability between transaction objects created using this namespace and transactions created through COM+.","source":"The <xref:System.Transactions> namespace supports interoperability between transaction objects created using this namespace and transactions created through COM+."},{"pos":[387,600],"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration when you create a new <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> instance to specify the level of interoperability with COM+.","source":"You can use the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration when you create a new <xref:System.Transactions.TransactionScope> instance to specify the level of interoperability with COM+."},{"content":"By default, when your application code checks the static <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> property, <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph> attempts to look for a transaction that is otherwise current, or a <ph id=\"ph3\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object that dictates that <ph id=\"ph4\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> is <bpt id=\"p1\">**</bpt>null<ept id=\"p1\">**</ept>.","pos":[607,950],"source":"By default, when your application code checks the static <xref:System.Transactions.Transaction.Current%2A> property, <xref:System.Transactions> attempts to look for a transaction that is otherwise current, or a <xref:System.Transactions.TransactionScope> object that dictates that <xref:System.Transactions.Transaction.Current%2A> is **null**."},{"content":"If it cannot find either one of these, <ph id=\"ph1\">&lt;xref:System.Transactions&gt;</ph> queries the COM+ context for a transaction.","pos":[951,1060],"source":" If it cannot find either one of these, <xref:System.Transactions> queries the COM+ context for a transaction."},{"content":"Note that even though <ph id=\"ph1\">&lt;xref:System.Transactions&gt;</ph> may find a transaction from the COM+ context, it still favors transactions that are native to <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph>.","pos":[1061,1231],"source":" Note that even though <xref:System.Transactions> may find a transaction from the COM+ context, it still favors transactions that are native to <xref:System.Transactions>."},{"pos":[1240,1263],"content":"Interoperability levels","linkify":"Interoperability levels","nodes":[{"content":"Interoperability levels","pos":[0,23]}]},{"pos":[1267,1593],"content":"The <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration defines the following levels of interoperability—<ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.None&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Full&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Automatic&gt;</ph>.","source":"The <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration defines the following levels of interoperability—<xref:System.Transactions.EnterpriseServicesInteropOption.None>, <xref:System.Transactions.EnterpriseServicesInteropOption.Full> and <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic>."},{"pos":[1600,1762],"content":"The <ph id=\"ph1\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> class provides constructors that accept <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> as a parameter.","source":"The <xref:System.Transactions.TransactionScope> class provides constructors that accept <xref:System.Transactions.EnterpriseServicesInteropOption> as a parameter."},{"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.None&gt;</ph>, as the name implies, implies that there is no interoperability between <ph id=\"ph2\">&lt;xref:System.EnterpriseServices&gt;</ph> contexts and transaction scopes.","pos":[1769,1970],"source":"<xref:System.Transactions.EnterpriseServicesInteropOption.None>, as the name implies, implies that there is no interoperability between <xref:System.EnterpriseServices> contexts and transaction scopes."},{"content":"After creating a <ph id=\"ph1\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object with <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.None&gt;</ph>, any changes to <ph id=\"ph3\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> are not reflected in the COM+ context.","pos":[1971,2212],"source":" After creating a <xref:System.Transactions.TransactionScope> object with <xref:System.Transactions.EnterpriseServicesInteropOption.None>, any changes to <xref:System.Transactions.Transaction.Current%2A> are not reflected in the COM+ context."},{"content":"Similarly, changes to the transaction in the COM+ context are not reflected in <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph>.","pos":[2213,2342],"source":" Similarly, changes to the transaction in the COM+ context are not reflected in <xref:System.Transactions.Transaction.Current%2A>."},{"content":"This is the fastest mode of operation for <ph id=\"ph1\">&lt;xref:System.Transactions&gt;</ph> because there is no extra synchronization required.","pos":[2343,2463],"source":" This is the fastest mode of operation for <xref:System.Transactions> because there is no extra synchronization required."},{"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.None&gt;</ph> is the default value used by <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> with all constructors that do not accept <ph id=\"ph3\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> as a parameter.","pos":[2464,2716],"source":"<xref:System.Transactions.EnterpriseServicesInteropOption.None> is the default value used by <xref:System.Transactions.TransactionScope> with all constructors that do not accept <xref:System.Transactions.EnterpriseServicesInteropOption> as a parameter."},{"content":"If you do want to combine <ph id=\"ph1\">&lt;xref:System.EnterpriseServices&gt;</ph> transactions with your ambient transaction, you need to use either <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Full&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Automatic&gt;</ph>.","pos":[2723,2985],"source":"If you do want to combine <xref:System.EnterpriseServices> transactions with your ambient transaction, you need to use either <xref:System.Transactions.EnterpriseServicesInteropOption.Full> or <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic>."},{"content":"Both of these values rely on a feature called services without components, and therefore you should be running on Windows XP Service Pack 2 or Windows Server 2003 when using them.","pos":[2986,3165]},{"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Full&gt;</ph> specifies that the ambient transactions for <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.EnterpriseServices&gt;</ph> are always the same.","pos":[3172,3364],"source":"<xref:System.Transactions.EnterpriseServicesInteropOption.Full> specifies that the ambient transactions for <xref:System.Transactions> and <xref:System.EnterpriseServices> are always the same."},{"content":"It results in creating a new <ph id=\"ph1\">&lt;xref:System.EnterpriseServices&gt;</ph> transactional context and applying the transaction that is current for the <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> to be current for that context.","pos":[3365,3577],"source":" It results in creating a new <xref:System.EnterpriseServices> transactional context and applying the transaction that is current for the <xref:System.Transactions.TransactionScope> to be current for that context."},{"content":"As such, the transaction in <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> is completely in synchronization with the transaction in <ph id=\"ph2\">&lt;xref:System.EnterpriseServices.ContextUtil.Transaction%2A&gt;</ph>.","pos":[3578,3773],"source":" As such, the transaction in <xref:System.Transactions.Transaction.Current%2A> is completely in synchronization with the transaction in <xref:System.EnterpriseServices.ContextUtil.Transaction%2A>."},{"content":"This value introduces a performance penalty because new COM+ contexts may need to be created.","pos":[3774,3867]},{"pos":[3874,3980],"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Automatic&gt;</ph> specifies the following requirements:","source":"<xref:System.Transactions.EnterpriseServicesInteropOption.Automatic> specifies the following requirements:"},{"content":"When <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> is checked, <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph> should support transactions in the COM+ context if it detects that it is running in a context other than the default context.","pos":[3990,4209],"source":"When <xref:System.Transactions.Transaction.Current%2A> is checked, <xref:System.Transactions> should support transactions in the COM+ context if it detects that it is running in a context other than the default context."},{"content":"Note that the default context cannot contain a transaction.","pos":[4210,4269]},{"content":"Therefore, in the default context, even with <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Automatic&gt;</ph>, the transaction stored in the thread local storage used by <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph> is returned for <ph id=\"ph3\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph>.","pos":[4270,4537],"source":" Therefore, in the default context, even with <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic>, the transaction stored in the thread local storage used by <xref:System.Transactions> is returned for <xref:System.Transactions.Transaction.Current%2A>."},{"content":"If a new <ph id=\"ph1\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object is created and the creation occurs in a context other than the default context, the transaction that is current for the <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object should be reflected in COM+.","pos":[4547,4806],"source":"If a new <xref:System.Transactions.TransactionScope> object is created and the creation occurs in a context other than the default context, the transaction that is current for the <xref:System.Transactions.TransactionScope> object should be reflected in COM+."},{"content":"In this case, <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Automatic&gt;</ph> behaves like <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Full&gt;</ph> in that it creates a new COM+ context.","pos":[4807,5005],"source":" In this case, <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic> behaves like <xref:System.Transactions.EnterpriseServicesInteropOption.Full> in that it creates a new COM+ context."},{"content":"In addition when <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> is set in both <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Full&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Automatic&gt;</ph>, both of these modes imply that <ph id=\"ph4\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> cannot be set directly.","pos":[5012,5336],"source":"In addition when <xref:System.Transactions.Transaction.Current%2A> is set in both <xref:System.Transactions.EnterpriseServicesInteropOption.Full> and <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic>, both of these modes imply that <xref:System.Transactions.Transaction.Current%2A> cannot be set directly."},{"content":"Any attempt to set <ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> directly other than creating a <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> results in an <ph id=\"ph3\">&lt;xref:System.InvalidOperationException&gt;</ph>.","pos":[5338,5536],"source":"  Any attempt to set <xref:System.Transactions.Transaction.Current%2A> directly other than creating a <xref:System.Transactions.TransactionScope> results in an <xref:System.InvalidOperationException>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration value is inherited by new transaction scopes that do not explicitly specify which value to use.","pos":[5537,5707],"source":" The <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration value is inherited by new transaction scopes that do not explicitly specify which value to use."},{"content":"For example, if you create a new <ph id=\"ph1\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object with <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Full&gt;</ph>, and then create a second <ph id=\"ph3\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object but do not specify an <ph id=\"ph4\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> value, the second <ph id=\"ph5\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> object also has a <ph id=\"ph6\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Full&gt;</ph>.","pos":[5708,6163],"source":" For example, if you create a new <xref:System.Transactions.TransactionScope> object with <xref:System.Transactions.EnterpriseServicesInteropOption.Full>, and then create a second <xref:System.Transactions.TransactionScope> object but do not specify an <xref:System.Transactions.EnterpriseServicesInteropOption> value, the second <xref:System.Transactions.TransactionScope> object also has a <xref:System.Transactions.EnterpriseServicesInteropOption.Full>."},{"content":"In summary, the following rules apply when creating a new transaction scope:","pos":[6170,6246]},{"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.Transaction.Current%2A&gt;</ph> is checked to see if there is a transaction.","pos":[6256,6350],"source":"<xref:System.Transactions.Transaction.Current%2A> is checked to see if there is a transaction."},{"content":"This check results in:","pos":[6351,6373]},{"content":"A check to see if there is a scope.","pos":[6387,6422]},{"pos":[6436,6603],"content":"If there is a scope, the value of the <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration passed in when the scope was initially created is checked.","source":"If there is a scope, the value of the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration passed in when the scope was initially created is checked."},{"pos":[6617,6940],"content":"If the <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration is set to <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Automatic&gt;</ph>, the COM+ transaction (<ph id=\"ph3\">&lt;xref:System.EnterpriseServices&gt;</ph> Transaction) takes precedence over the <ph id=\"ph4\">&lt;xref:System.Transactions&gt;</ph> transaction in managed thread local storage.","source":"If the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration is set to <xref:System.Transactions.EnterpriseServicesInteropOption.Automatic>, the COM+ transaction (<xref:System.EnterpriseServices> Transaction) takes precedence over the <xref:System.Transactions> transaction in managed thread local storage."},{"pos":[6955,7135],"content":"If the value is set to <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.None&gt;</ph>, the <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph> transaction in managed thread local storage takes precedence.","source":"If the value is set to <xref:System.Transactions.EnterpriseServicesInteropOption.None>, the <xref:System.Transactions> transaction in managed thread local storage takes precedence."},{"pos":[7150,7290],"content":"If the value is <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Full&gt;</ph>, there is only one transaction and it is a COM+ transaction.","source":"If the value is <xref:System.Transactions.EnterpriseServicesInteropOption.Full>, there is only one transaction and it is a COM+ transaction."},{"content":"The value of the <ph id=\"ph1\">&lt;xref:System.Transactions.TransactionScopeOption&gt;</ph> enumeration passed in by the <ph id=\"ph2\">&lt;xref:System.Transactions.TransactionScope&gt;</ph> constructor is checked.","pos":[7300,7463],"source":"The value of the <xref:System.Transactions.TransactionScopeOption> enumeration passed in by the <xref:System.Transactions.TransactionScope> constructor is checked."},{"content":"This determines if a new transaction must be created.","pos":[7464,7517]},{"pos":[7527,7659],"content":"If a new transaction is to be created, the following values of <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> result in:","source":"If a new transaction is to be created, the following values of <xref:System.Transactions.EnterpriseServicesInteropOption> result in:"},{"pos":[7673,7795],"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Full&gt;</ph>:  a transaction associated with a COM+ context is created.","source":"<xref:System.Transactions.EnterpriseServicesInteropOption.Full>:  a transaction associated with a COM+ context is created."},{"pos":[7809,7926],"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.None&gt;</ph>: a <ph id=\"ph2\">&lt;xref:System.Transactions&gt;</ph> transaction is created.","source":"<xref:System.Transactions.EnterpriseServicesInteropOption.None>: a <xref:System.Transactions> transaction is created."},{"pos":[7940,8091],"content":"<ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption.Automatic&gt;</ph>: if there is a COM+ context, a transaction is created and attached to the context.","source":"<xref:System.Transactions.EnterpriseServicesInteropOption.Automatic>: if there is a COM+ context, a transaction is created and attached to the context."},{"pos":[8098,8302],"content":"The following table illustrates the Enterprise Services (ES) context and a transactional scope that requires a transaction using the <ph id=\"ph1\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration.","source":"The following table illustrates the Enterprise Services (ES) context and a transactional scope that requires a transaction using the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration."},{"content":"ES Context","pos":[8309,8319]},{"content":"None","pos":[8320,8324]},{"content":"Automatic","pos":[8325,8334]},{"content":"Full","pos":[8335,8339]},{"content":"Default context","pos":[8403,8418]},{"content":"Default context","pos":[8419,8434]},{"content":"Default context","pos":[8435,8450]},{"content":"Create new","pos":[8451,8461]},{"content":"transactional context","pos":[8468,8489]},{"content":"Non-default context","pos":[8494,8513]},{"content":"Maintain client's context","pos":[8514,8539]},{"content":"Create new transactional context","pos":[8540,8572]},{"content":"Create new transactional context","pos":[8573,8605]},{"pos":[8613,8874],"content":"The following table illustrates what the ambient transaction is, given a particular <ph id=\"ph1\">&lt;xref:System.EnterpriseServices&gt;</ph> context, and a transactional scope that requires a transaction using the <ph id=\"ph2\">&lt;xref:System.Transactions.EnterpriseServicesInteropOption&gt;</ph> enumeration.","source":"The following table illustrates what the ambient transaction is, given a particular <xref:System.EnterpriseServices> context, and a transactional scope that requires a transaction using the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration."},{"content":"ES Context","pos":[8881,8891]},{"content":"None","pos":[8892,8896]},{"content":"Automatic","pos":[8897,8906]},{"content":"Full","pos":[8907,8911]},{"content":"Default context","pos":[8975,8990]},{"content":"ST","pos":[8991,8993]},{"content":"ST","pos":[8994,8996]},{"content":"ES","pos":[8997,8999]},{"content":"Non-default context","pos":[9004,9023]},{"content":"ST","pos":[9024,9026]},{"content":"ES","pos":[9027,9029]},{"content":"ES","pos":[9030,9032]},{"content":"In the preceding table:","pos":[9040,9063]},{"pos":[9073,9254],"content":"ST means that the scope's ambient transaction is managed by <ph id=\"ph1\">&lt;xref:System.Transactions&gt;</ph>, separate from any <ph id=\"ph2\">&lt;xref:System.EnterpriseServices&gt;</ph> context's transaction that may be present.","source":"ST means that the scope's ambient transaction is managed by <xref:System.Transactions>, separate from any <xref:System.EnterpriseServices> context's transaction that may be present."},{"pos":[9264,9380],"content":"ES means that the scope's ambient transaction is same as the <ph id=\"ph1\">&lt;xref:System.EnterpriseServices&gt;</ph> context's transaction.","source":"ES means that the scope's ambient transaction is same as the <xref:System.EnterpriseServices> context's transaction."}]}