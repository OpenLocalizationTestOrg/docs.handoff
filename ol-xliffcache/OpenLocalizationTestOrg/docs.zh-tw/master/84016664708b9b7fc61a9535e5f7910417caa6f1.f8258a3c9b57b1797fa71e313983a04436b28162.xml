{"content":"---\ntitle: \"Mitigation: ClaimsIdentity Constructor | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 946903f1-0fbf-4f67-805b-1eb48352024d\ncaps.latest.revision: 5\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Mitigation: ClaimsIdentity Constructor\nStarting with the [!INCLUDE[net_v462](../../../includes/net-v462-md.md)], there is change in how the <xref:System.Security.Claims.ClaimsIdentity.%23ctor%28System.Security.Principal.IIdentity%29?displayProperty=fullName> constructor sets the <xref:System.Security.Claims.ClaimsIdentity.Actor%2A?displayProperty=fullName> property. If the <xref:System.Security.Principal.IIdentity> argument is a <xref:System.Security.Claims.ClaimsIdentity> object, and the <xref:System.Security.Claims.ClaimsIdentity.Actor%2A> property of that <xref:System.Security.Claims.ClaimsIdentity> object is not `null`, the <xref:System.Security.Claims.ClaimsIdentity.Actor%2A> property is attached by using the <xref:System.Security.Claims.ClaimsIdentity.Clone%2A?displayProperty=fullName> method. In the [!INCLUDE[net_v461](../../../includes/net-v461-md.md)], the <xref:System.Security.Claims.ClaimsIdentity.Actor%2A> property is attached as a  existing reference.  \n  \n## Impact  \n Starting with the [!INCLUDE[net_v462](../../../includes/net-v462-md.md)], the <xref:System.Security.Claims.ClaimsIdentity.Actor%2A?displayProperty=fullName> property of the new <xref:System.Security.Claims.ClaimsIdentity> object is not equal to the <xref:System.Security.Claims.ClaimsIdentity.Actor%2A?displayProperty=fullName> property of the constructor's <xref:System.Security.Principal.IIdentity> argument. In the [!INCLUDE[net_v461](../../../includes/net-v461-md.md)] and earlier versions, it is equal.  \n  \n## Mitigation  \n If this behavior is undesirable, you can restore the previous behavior by setting the `Switch.System.Security.ClaimsIdentity.SetActorAsReferenceWhenCopyingClaimsIdentity` switch in your application configuration file to `true`. This requires that you add the following to  the [\\<runtime>](../../../docs/framework/configure-apps/file-schema/runtime/runtime-element.md) section of your web.config file:  \n  \n```  \n  \n<configuration>  \n   <runtime>  \n      <AppContextSwitchOverrides value=\"Switch.System.Security.ClaimsIdentity.SetActorAsReferenceWhenCopyingClaimsIdentity=true\" />  \n   </runtime>  \n</configuration>  \n  \n```  \n  \n## See Also  \n [Retargeting Changes](../../../docs/framework/migration-guide/retargeting-changes-in-the-net-framework-4-6.md)","nodes":[{"pos":[12,67],"content":"Mitigation: ClaimsIdentity Constructor | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Mitigation: ClaimsIdentity Constructor | Microsoft Docs","pos":[0,55]}]},{"pos":[387,425],"content":"Mitigation: ClaimsIdentity Constructor","linkify":"Mitigation: ClaimsIdentity Constructor","nodes":[{"content":"Mitigation: ClaimsIdentity Constructor","pos":[0,38]}]},{"content":"Starting with the <ph id=\"ph1\">[!INCLUDE[net_v462](../../../includes/net-v462-md.md)]</ph>, there is change in how the <ph id=\"ph2\">&lt;xref:System.Security.Claims.ClaimsIdentity.%23ctor%28System.Security.Principal.IIdentity%29?displayProperty=fullName&gt;</ph> constructor sets the <ph id=\"ph3\">&lt;xref:System.Security.Claims.ClaimsIdentity.Actor%2A?displayProperty=fullName&gt;</ph> property.","pos":[426,755],"source":"Starting with the [!INCLUDE[net_v462](../../../includes/net-v462-md.md)], there is change in how the <xref:System.Security.Claims.ClaimsIdentity.%23ctor%28System.Security.Principal.IIdentity%29?displayProperty=fullName> constructor sets the <xref:System.Security.Claims.ClaimsIdentity.Actor%2A?displayProperty=fullName> property."},{"content":"If the <ph id=\"ph1\">&lt;xref:System.Security.Principal.IIdentity&gt;</ph> argument is a <ph id=\"ph2\">&lt;xref:System.Security.Claims.ClaimsIdentity&gt;</ph> object, and the <ph id=\"ph3\">&lt;xref:System.Security.Claims.ClaimsIdentity.Actor%2A&gt;</ph> property of that <ph id=\"ph4\">&lt;xref:System.Security.Claims.ClaimsIdentity&gt;</ph> object is not <ph id=\"ph5\">`null`</ph>, the <ph id=\"ph6\">&lt;xref:System.Security.Claims.ClaimsIdentity.Actor%2A&gt;</ph> property is attached by using the <ph id=\"ph7\">&lt;xref:System.Security.Claims.ClaimsIdentity.Clone%2A?displayProperty=fullName&gt;</ph> method.","pos":[756,1197],"source":" If the <xref:System.Security.Principal.IIdentity> argument is a <xref:System.Security.Claims.ClaimsIdentity> object, and the <xref:System.Security.Claims.ClaimsIdentity.Actor%2A> property of that <xref:System.Security.Claims.ClaimsIdentity> object is not `null`, the <xref:System.Security.Claims.ClaimsIdentity.Actor%2A> property is attached by using the <xref:System.Security.Claims.ClaimsIdentity.Clone%2A?displayProperty=fullName> method."},{"content":"In the <ph id=\"ph1\">[!INCLUDE[net_v461](../../../includes/net-v461-md.md)]</ph>, the <ph id=\"ph2\">&lt;xref:System.Security.Claims.ClaimsIdentity.Actor%2A&gt;</ph> property is attached as a  existing reference.","pos":[1198,1365],"source":" In the [!INCLUDE[net_v461](../../../includes/net-v461-md.md)], the <xref:System.Security.Claims.ClaimsIdentity.Actor%2A> property is attached as a  existing reference."},{"pos":[1374,1380],"content":"Impact","linkify":"Impact","nodes":[{"content":"Impact","pos":[0,6]}]},{"content":"Starting with the <ph id=\"ph1\">[!INCLUDE[net_v462](../../../includes/net-v462-md.md)]</ph>, the <ph id=\"ph2\">&lt;xref:System.Security.Claims.ClaimsIdentity.Actor%2A?displayProperty=fullName&gt;</ph> property of the new <ph id=\"ph3\">&lt;xref:System.Security.Claims.ClaimsIdentity&gt;</ph> object is not equal to the <ph id=\"ph4\">&lt;xref:System.Security.Claims.ClaimsIdentity.Actor%2A?displayProperty=fullName&gt;</ph> property of the constructor's <ph id=\"ph5\">&lt;xref:System.Security.Principal.IIdentity&gt;</ph> argument.","pos":[1384,1794],"source":"Starting with the [!INCLUDE[net_v462](../../../includes/net-v462-md.md)], the <xref:System.Security.Claims.ClaimsIdentity.Actor%2A?displayProperty=fullName> property of the new <xref:System.Security.Claims.ClaimsIdentity> object is not equal to the <xref:System.Security.Claims.ClaimsIdentity.Actor%2A?displayProperty=fullName> property of the constructor's <xref:System.Security.Principal.IIdentity> argument."},{"content":"In the <ph id=\"ph1\">[!INCLUDE[net_v461](../../../includes/net-v461-md.md)]</ph> and earlier versions, it is equal.","pos":[1795,1891],"source":" In the [!INCLUDE[net_v461](../../../includes/net-v461-md.md)] and earlier versions, it is equal."},{"pos":[1900,1910],"content":"Mitigation","linkify":"Mitigation","nodes":[{"content":"Mitigation","pos":[0,10]}]},{"content":"If this behavior is undesirable, you can restore the previous behavior by setting the <ph id=\"ph1\">`Switch.System.Security.ClaimsIdentity.SetActorAsReferenceWhenCopyingClaimsIdentity`</ph> switch in your application configuration file to <ph id=\"ph2\">`true`</ph>.","pos":[1914,2141],"source":"If this behavior is undesirable, you can restore the previous behavior by setting the `Switch.System.Security.ClaimsIdentity.SetActorAsReferenceWhenCopyingClaimsIdentity` switch in your application configuration file to `true`."},{"content":"This requires that you add the following to  the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>runtime&gt;<ept id=\"p1\">](../../../docs/framework/configure-apps/file-schema/runtime/runtime-element.md)</ept> section of your web.config file:","pos":[2142,2315],"source":" This requires that you add the following to  the [\\<runtime>](../../../docs/framework/configure-apps/file-schema/runtime/runtime-element.md) section of your web.config file:"},{"pos":[2547,2555],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2559,2669],"content":"<bpt id=\"p1\">[</bpt>Retargeting Changes<ept id=\"p1\">](../../../docs/framework/migration-guide/retargeting-changes-in-the-net-framework-4-6.md)</ept>","source":"[Retargeting Changes](../../../docs/framework/migration-guide/retargeting-changes-in-the-net-framework-4-6.md)"}]}