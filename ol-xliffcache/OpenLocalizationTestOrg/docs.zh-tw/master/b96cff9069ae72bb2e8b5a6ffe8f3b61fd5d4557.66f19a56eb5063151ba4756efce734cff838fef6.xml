{"content":"---\ntitle: \"How to: Associate a Shortcut Menu with a Windows Forms NotifyIcon Component | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"context menus, for background processes\"\n  - \"NotifyIcon component, associating shortcut menus\"\n  - \"shortcut menus, for background processes\"\nms.assetid: d68f3926-08d3-4f7d-949f-1981b29cf188\ncaps.latest.revision: 19\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Associate a Shortcut Menu with a Windows Forms NotifyIcon Component\n> [!NOTE]\n>  Although <xref:System.Windows.Forms.MenuStrip> and <xref:System.Windows.Forms.ContextMenuStrip> replace and add functionality to the <xref:System.Windows.Forms.MainMenu> and <xref:System.Windows.Forms.ContextMenu> controls of previous versions, <xref:System.Windows.Forms.MainMenu> and <xref:System.Windows.Forms.ContextMenu> are retained for both backward compatibility and future use if you choose.  \n  \n The <xref:System.Windows.Forms.NotifyIcon> component displays an icon in the status notification area of the taskbar. Commonly, applications enable you to right-click this icon to send commands to the application it represents. By associating a <xref:System.Windows.Forms.ContextMenu> component with the <xref:System.Windows.Forms.NotifyIcon> component, you can add this functionality to your applications.  \n  \n> [!NOTE]\n>  If you want your application to be minimized at startup while displaying an instance of the <xref:System.Windows.Forms.NotifyIcon> component in the taskbar, set the main form's <xref:System.Windows.Forms.Form.WindowState%2A> property to <xref:System.Windows.Forms.FormWindowState> and be sure the <xref:System.Windows.Forms.NotifyIcon> component's <xref:System.Windows.Forms.NotifyIcon.Visible%2A> property is set to `true`.  \n  \n### To associate a shortcut menu with the NotifyIcon component at design time  \n  \n1.  Add a <xref:System.Windows.Forms.NotifyIcon> component to your form, and set the important properties, such as the <xref:System.Windows.Forms.NotifyIcon.Icon%2A> and <xref:System.Windows.Forms.NotifyIcon.Visible%2A> properties.  \n  \n     For more information, see [How to: Add Application Icons to the TaskBar with the Windows Forms NotifyIcon Component](../../../../docs/framework/winforms/controls/app-icons-to-the-taskbar-with-wf-notifyicon.md).  \n  \n2.  Add a <xref:System.Windows.Forms.ContextMenu> component to your Windows Form.  \n  \n     Add menu items to the shortcut menu representing the commands you want to make available at run time. This is also a good time to add menu enhancements to these menu items, such as access keys.  \n  \n3.  Set the <xref:System.Windows.Forms.NotifyIcon.ContextMenu%2A> property of the <xref:System.Windows.Forms.NotifyIcon> component to the shortcut menu that you added.  \n  \n     With this property set, the shortcut menu will be displayed when the icon on the taskbar is clicked.  \n  \n### To associate a shortcut menu with the NotifyIcon component programmatically  \n  \n1.  Create an instance of the <xref:System.Windows.Forms.NotifyIcon> class and a <xref:System.Windows.Forms.ContextMenu> class, with whatever property settings are necessary for the application (<xref:System.Windows.Forms.NotifyIcon.Icon%2A> and <xref:System.Windows.Forms.NotifyIcon.Visible%2A> properties for the <xref:System.Windows.Forms.NotifyIcon> component, menu items for the <xref:System.Windows.Forms.ContextMenu> component).  \n  \n2.  Set the <xref:System.Windows.Forms.NotifyIcon.ContextMenu%2A> property of the <xref:System.Windows.Forms.NotifyIcon> component to the shortcut menu that you added.  \n  \n     With this property set, the shortcut menu will be displayed when the icon on the taskbar is clicked.  \n  \n    > [!NOTE]\n    >  The following code example creates a basic menu structure. You will need to customize the menu choices to those that fit the application you are developing. Additionally, you will want to write code to handle the <xref:System.Windows.Forms.MenuItem.Click> events for these menu items.  \n  \n    ```vb  \n    Public ContextMenu1 As New ContextMenu  \n    Public NotifyIcon1 As New NotifyIcon  \n  \n    Public Sub CreateIconMenuStructure()  \n       ' Add menu items to shortcut menu.  \n       ContextMenu1.MenuItems.Add(\"&Open Application\")  \n       ContextMenu1.MenuItems.Add(\"S&uspend Application\")  \n       ContextMenu1.MenuItems.Add(\"E&xit\")  \n  \n       ' Set properties of NotifyIcon component.  \n       NotifyIcon1.Icon = New System.Drawing.Icon _   \n          (System.Environment.GetFolderPath _   \n          (System.Environment.SpecialFolder.Personal)  _   \n          & \"\\Icon.ico\")  \n       NotifyIcon1.Text = \"Right-click me!\"  \n       NotifyIcon1.Visible = True  \n       NotifyIcon1.ContextMenu = ContextMenu1  \n    End Sub  \n  \n    ```  \n  \n```csharp  \npublic NotifyIcon notifyIcon1 = new NotifyIcon();  \npublic ContextMenu contextMenu1 = new ContextMenu();  \n  \npublic void createIconMenuStructure()  \n{  \n   // Add menu items to shortcut menu.  \n   contextMenu1.MenuItems.Add(\"&Open Application\");  \n   contextMenu1.MenuItems.Add(\"S&uspend Application\");  \n   contextMenu1.MenuItems.Add(\"E&xit\");  \n  \n   // Set properties of NotifyIcon component.  \n   notifyIcon1.Icon = new System.Drawing.Icon  \n      (System.Environment.GetFolderPath  \n      (System.Environment.SpecialFolder.Personal)  \n      + @\"\\Icon.ico\");  \n   notifyIcon1.Visible = true;  \n   notifyIcon1.Text = \"Right-click me!\";  \n   notifyIcon1.Visible = true;  \n   notifyIcon1.ContextMenu = contextMenu1;  \n}  \n  \n```  \n  \n```cpp  \npublic:  \n   System::Windows::Forms::NotifyIcon ^ notifyIcon1;  \n   System::Windows::Forms::ContextMenu ^ contextMenu1;  \n  \n   void createIconMenuStructure()  \n   {  \n      // Add menu items to shortcut menu.  \n      contextMenu1->MenuItems->Add(\"&Open Application\");  \n      contextMenu1->MenuItems->Add(\"S&uspend Application\");  \n      contextMenu1->MenuItems->Add(\"E&xit\");  \n  \n      // Set properties of NotifyIcon component.  \n      notifyIcon1->Icon = gcnew System::Drawing::Icon  \n          (String::Concat(System::Environment::GetFolderPath  \n          (System::Environment::SpecialFolder::Personal),  \n          \"\\\\Icon.ico\"));  \n      notifyIcon1->Text = \"Right-click me!\";  \n      notifyIcon1->Visible = true;  \n      notifyIcon1->ContextMenu = contextMenu1;  \n   }  \n```  \n  \n> [!NOTE]\n>  You must initialize `notifyIcon1` and `contextMenu1,` which you can do by including the following statements in the constructor of your form:  \n  \n```cpp  \nnotifyIcon1 = gcnew System::Windows::Forms::NotifyIcon();  \ncontextMenu1 = gcnew System::Windows::Forms::ContextMenu();  \n```  \n  \n## See Also  \n <xref:System.Windows.Forms.NotifyIcon>   \n <xref:System.Windows.Forms.NotifyIcon.Icon%2A>   \n [How to: Add Application Icons to the TaskBar with the Windows Forms NotifyIcon Component](../../../../docs/framework/winforms/controls/app-icons-to-the-taskbar-with-wf-notifyicon.md)   \n [NotifyIcon Component](../../../../docs/framework/winforms/controls/notifyicon-component-windows-forms.md)   \n [NotifyIcon Component Overview](../../../../docs/framework/winforms/controls/notifyicon-component-overview-windows-forms.md)","nodes":[{"pos":[4,605],"embed":true,"restype":"x-metadata","content":"title: \"How to: Associate a Shortcut Menu with a Windows Forms NotifyIcon Component | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"context menus, for background processes\"\n  - \"NotifyIcon component, associating shortcut menus\"\n  - \"shortcut menus, for background processes\"\nms.assetid: d68f3926-08d3-4f7d-949f-1981b29cf188\ncaps.latest.revision: 19\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"How to: Associate a Shortcut Menu with a Windows Forms NotifyIcon Component | Microsoft Docs","nodes":[{"pos":[0,92],"content":"How to: Associate a Shortcut Menu with a Windows Forms NotifyIcon Component | Microsoft Docs","nodes":[{"content":"How to: Associate a Shortcut Menu with a Windows Forms NotifyIcon Component | Microsoft Docs","pos":[0,92]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[612,687],"content":"How to: Associate a Shortcut Menu with a Windows Forms NotifyIcon Component","linkify":"How to: Associate a Shortcut Menu with a Windows Forms NotifyIcon Component","nodes":[{"content":"How to: Associate a Shortcut Menu with a Windows Forms NotifyIcon Component","pos":[0,75]}]},{"pos":[690,1101],"content":"[!NOTE]\n Although <xref:System.Windows.Forms.MenuStrip> and <xref:System.Windows.Forms.ContextMenuStrip> replace and add functionality to the <xref:System.Windows.Forms.MainMenu> and <xref:System.Windows.Forms.ContextMenu> controls of previous versions, <xref:System.Windows.Forms.MainMenu> and <xref:System.Windows.Forms.ContextMenu> are retained for both backward compatibility and future use if you choose.","leadings":["","> "],"nodes":[{"content":"Although <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MenuStrip&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ContextMenuStrip&gt;</ph> replace and add functionality to the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.MainMenu&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.Forms.ContextMenu&gt;</ph> controls of previous versions, <ph id=\"ph5\">&lt;xref:System.Windows.Forms.MainMenu&gt;</ph> and <ph id=\"ph6\">&lt;xref:System.Windows.Forms.ContextMenu&gt;</ph> are retained for both backward compatibility and future use if you choose.","pos":[9,409],"source":"Although <xref:System.Windows.Forms.MenuStrip> and <xref:System.Windows.Forms.ContextMenuStrip> replace and add functionality to the <xref:System.Windows.Forms.MainMenu> and <xref:System.Windows.Forms.ContextMenu> controls of previous versions, <xref:System.Windows.Forms.MainMenu> and <xref:System.Windows.Forms.ContextMenu> are retained for both backward compatibility and future use if you choose."}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.NotifyIcon&gt;</ph> component displays an icon in the status notification area of the taskbar.","pos":[1108,1225],"source":"The <xref:System.Windows.Forms.NotifyIcon> component displays an icon in the status notification area of the taskbar."},{"content":"Commonly, applications enable you to right-click this icon to send commands to the application it represents.","pos":[1226,1335]},{"content":"By associating a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ContextMenu&gt;</ph> component with the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.NotifyIcon&gt;</ph> component, you can add this functionality to your applications.","pos":[1336,1514],"source":" By associating a <xref:System.Windows.Forms.ContextMenu> component with the <xref:System.Windows.Forms.NotifyIcon> component, you can add this functionality to your applications."},{"pos":[1522,1957],"content":"[!NOTE]\n If you want your application to be minimized at startup while displaying an instance of the <xref:System.Windows.Forms.NotifyIcon> component in the taskbar, set the main form's <xref:System.Windows.Forms.Form.WindowState%2A> property to <xref:System.Windows.Forms.FormWindowState> and be sure the <xref:System.Windows.Forms.NotifyIcon> component's <xref:System.Windows.Forms.NotifyIcon.Visible%2A> property is set to `true`.","leadings":["","> "],"nodes":[{"content":"If you want your application to be minimized at startup while displaying an instance of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.NotifyIcon&gt;</ph> component in the taskbar, set the main form's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Form.WindowState%2A&gt;</ph> property to <ph id=\"ph3\">&lt;xref:System.Windows.Forms.FormWindowState&gt;</ph> and be sure the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.NotifyIcon&gt;</ph> component's <ph id=\"ph5\">&lt;xref:System.Windows.Forms.NotifyIcon.Visible%2A&gt;</ph> property is set to <ph id=\"ph6\">`true`</ph>.","pos":[9,433],"source":"If you want your application to be minimized at startup while displaying an instance of the <xref:System.Windows.Forms.NotifyIcon> component in the taskbar, set the main form's <xref:System.Windows.Forms.Form.WindowState%2A> property to <xref:System.Windows.Forms.FormWindowState> and be sure the <xref:System.Windows.Forms.NotifyIcon> component's <xref:System.Windows.Forms.NotifyIcon.Visible%2A> property is set to `true`."}]},{"pos":[1967,2040],"content":"To associate a shortcut menu with the NotifyIcon component at design time","linkify":"To associate a shortcut menu with the NotifyIcon component at design time","nodes":[{"content":"To associate a shortcut menu with the NotifyIcon component at design time","pos":[0,73]}]},{"pos":[2050,2277],"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.NotifyIcon&gt;</ph> component to your form, and set the important properties, such as the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.NotifyIcon.Icon%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Forms.NotifyIcon.Visible%2A&gt;</ph> properties.","source":"Add a <xref:System.Windows.Forms.NotifyIcon> component to your form, and set the important properties, such as the <xref:System.Windows.Forms.NotifyIcon.Icon%2A> and <xref:System.Windows.Forms.NotifyIcon.Visible%2A> properties."},{"pos":[2288,2498],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Add Application Icons to the TaskBar with the Windows Forms NotifyIcon Component<ept id=\"p1\">](../../../../docs/framework/winforms/controls/app-icons-to-the-taskbar-with-wf-notifyicon.md)</ept>.","source":"For more information, see [How to: Add Application Icons to the TaskBar with the Windows Forms NotifyIcon Component](../../../../docs/framework/winforms/controls/app-icons-to-the-taskbar-with-wf-notifyicon.md)."},{"pos":[2508,2585],"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ContextMenu&gt;</ph> component to your Windows Form.","source":"Add a <xref:System.Windows.Forms.ContextMenu> component to your Windows Form."},{"content":"Add menu items to the shortcut menu representing the commands you want to make available at run time.","pos":[2596,2697]},{"content":"This is also a good time to add menu enhancements to these menu items, such as access keys.","pos":[2698,2789]},{"pos":[2799,2962],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.NotifyIcon.ContextMenu%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.NotifyIcon&gt;</ph> component to the shortcut menu that you added.","source":"Set the <xref:System.Windows.Forms.NotifyIcon.ContextMenu%2A> property of the <xref:System.Windows.Forms.NotifyIcon> component to the shortcut menu that you added."},{"content":"With this property set, the shortcut menu will be displayed when the icon on the taskbar is clicked.","pos":[2973,3073]},{"pos":[3083,3158],"content":"To associate a shortcut menu with the NotifyIcon component programmatically","linkify":"To associate a shortcut menu with the NotifyIcon component programmatically","nodes":[{"content":"To associate a shortcut menu with the NotifyIcon component programmatically","pos":[0,75]}]},{"pos":[3168,3599],"content":"Create an instance of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.NotifyIcon&gt;</ph> class and a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ContextMenu&gt;</ph> class, with whatever property settings are necessary for the application (<ph id=\"ph3\">&lt;xref:System.Windows.Forms.NotifyIcon.Icon%2A&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.Forms.NotifyIcon.Visible%2A&gt;</ph> properties for the <ph id=\"ph5\">&lt;xref:System.Windows.Forms.NotifyIcon&gt;</ph> component, menu items for the <ph id=\"ph6\">&lt;xref:System.Windows.Forms.ContextMenu&gt;</ph> component).","source":"Create an instance of the <xref:System.Windows.Forms.NotifyIcon> class and a <xref:System.Windows.Forms.ContextMenu> class, with whatever property settings are necessary for the application (<xref:System.Windows.Forms.NotifyIcon.Icon%2A> and <xref:System.Windows.Forms.NotifyIcon.Visible%2A> properties for the <xref:System.Windows.Forms.NotifyIcon> component, menu items for the <xref:System.Windows.Forms.ContextMenu> component)."},{"pos":[3609,3772],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.NotifyIcon.ContextMenu%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.NotifyIcon&gt;</ph> component to the shortcut menu that you added.","source":"Set the <xref:System.Windows.Forms.NotifyIcon.ContextMenu%2A> property of the <xref:System.Windows.Forms.NotifyIcon> component to the shortcut menu that you added."},{"content":"With this property set, the shortcut menu will be displayed when the icon on the taskbar is clicked.","pos":[3783,3883]},{"pos":[3895,4194],"content":"[!NOTE]\nThe following code example creates a basic menu structure. You will need to customize the menu choices to those that fit the application you are developing. Additionally, you will want to write code to handle the <xref:System.Windows.Forms.MenuItem.Click> events for these menu items.","leadings":["","    >  "],"nodes":[{"content":"The following code example creates a basic menu structure. You will need to customize the menu choices to those that fit the application you are developing. Additionally, you will want to write code to handle the <xref:System.Windows.Forms.MenuItem.Click> events for these menu items.","pos":[8,292],"nodes":[{"content":"The following code example creates a basic menu structure.","pos":[0,58]},{"content":"You will need to customize the menu choices to those that fit the application you are developing.","pos":[59,156]},{"content":"Additionally, you will want to write code to handle the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MenuItem.Click&gt;</ph> events for these menu items.","pos":[157,284],"source":" Additionally, you will want to write code to handle the <xref:System.Windows.Forms.MenuItem.Click> events for these menu items."}]}]},{"pos":[6506,6658],"content":"[!NOTE]\n You must initialize `notifyIcon1` and `contextMenu1,` which you can do by including the following statements in the constructor of your form:","leadings":["","> "],"nodes":[{"content":"You must initialize <ph id=\"ph1\">`notifyIcon1`</ph> and <ph id=\"ph2\">`contextMenu1,`</ph> which you can do by including the following statements in the constructor of your form:","pos":[9,150],"source":"You must initialize `notifyIcon1` and `contextMenu1,` which you can do by including the following statements in the constructor of your form:"}]},{"pos":[6807,6815],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>How to: Add Application Icons to the TaskBar with the Windows Forms NotifyIcon Component<ept id=\"p1\">](../../../../docs/framework/winforms/controls/app-icons-to-the-taskbar-with-wf-notifyicon.md)</ept><ph id=\"ph1\"> </ph>","pos":[6913,7097],"source":"[How to: Add Application Icons to the TaskBar with the Windows Forms NotifyIcon Component](../../../../docs/framework/winforms/controls/app-icons-to-the-taskbar-with-wf-notifyicon.md) "},{"content":"<bpt id=\"p1\">[</bpt>NotifyIcon Component<ept id=\"p1\">](../../../../docs/framework/winforms/controls/notifyicon-component-windows-forms.md)</ept><ph id=\"ph1\"> </ph>","pos":[7101,7208],"source":"[NotifyIcon Component](../../../../docs/framework/winforms/controls/notifyicon-component-windows-forms.md) "},{"content":"<bpt id=\"p1\">[</bpt>NotifyIcon Component Overview<ept id=\"p1\">](../../../../docs/framework/winforms/controls/notifyicon-component-overview-windows-forms.md)</ept>","pos":[7212,7336],"source":"[NotifyIcon Component Overview](../../../../docs/framework/winforms/controls/notifyicon-component-overview-windows-forms.md)"}]}