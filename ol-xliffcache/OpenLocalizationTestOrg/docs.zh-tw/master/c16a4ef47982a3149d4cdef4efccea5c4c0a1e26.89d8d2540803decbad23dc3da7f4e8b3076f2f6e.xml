{"content":"---\ntitle: \"How to: Register Primary Interop Assemblies | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"registering primary interop assemblies\"\n  - \"primary interop assemblies, registering\"\nms.assetid: 4b2fcf8a-429d-43ce-8334-e026040be8bb\ncaps.latest.revision: 8\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# How to: Register Primary Interop Assemblies\nClasses can be marshaled only by COM interop and are always marshaled as interfaces. In some cases the interface used to marshal the class is known as the class interface. For information about overriding the class interface with an interface of your choice, see [COM Callable Wrapper](../../../docs/framework/interop/com-callable-wrapper.md).  \n  \n Although any developer who wants to use COM types from a .NET Framework application can generate an interop assembly, doing so creates a problem. Each time a developer imports and signs a COM type library, that developer creates a set of unique types that are incompatible with those imported and signed by another developer. The solution to this type incompatibility problem is for each developer to obtain the vendor-supplied and signed primary interop assembly.  \n  \n If you plan to expose third-party COM types to other applications, always use the primary interop assembly provided by the same publisher as the type library it defines. In addition to providing guaranteed type compatibility, primary interop assemblies are often customized by the vendor to enhance interoperability.  \n  \n Even if you do not plan to expose third-party COM types, using the primary interop assembly can ease the task of interoperating with COM components. However, this strategy provides no insulation from changes a vendor might make to types defined in a primary interop assembly. When your application requires such insulation, generate your own interop assembly instead of using the primary interop assembly.  \n  \n You must register all acquired primary interop assemblies on your development computer before you can reference them with [!INCLUDE[vsprvsext](../../../includes/vsprvsext-md.md)]. Visual Studio looks for and uses a primary interop assembly the first time that you reference a type from a COM type library. If Visual Studio cannot locate the primary interop assembly associated with the type library, it prompts you to acquire it or offers to create an interop assembly instead. Likewise, the [Type Library Importer (Tlbimp.exe)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md) also uses the registry to locate primary interop assemblies.  \n  \n Although it is not necessary to register primary interop assemblies unless you plan to use Visual Studio, registration provides two advantages:  \n  \n-   A registered primary interop assembly is clearly marked under the registry key of the original type library. Registration is the best way for you to locate a primary interop assembly on your computer.  \n  \n-   You can avoid accidentally generating and using a new interop assembly if, at some time in the future, you do use Visual Studio to reference a type for which you have an unregistered primary interop assembly.  \n  \n Use the [Assembly Registration Tool (Regasm.exe)](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md) to register a primary interop assembly.  \n  \n### To register a primary interop assembly  \n  \n1.  At the command prompt, type:  \n  \n     **regasm** *assemblyname*  \n  \n     In this command, *assemblyname* is the file name of the assembly that is registered. Regasm.exe adds an entry for the primary interop assembly under the same registry key as the original type library.  \n  \n## Example  \n The following example registers the `CompanyA.UtilLib.dll` primary interop assembly.  \n  \n```  \nregasm CompanyA.UtilLib.dll  \n```  \n  \n## See Also  \n [Programming with Primary Interop Assemblies](http://msdn.microsoft.com/en-us/306fa1d6-0703-4004-9e93-d0a57f1be81e)   \n [Locating Primary Interop Assemblies](http://msdn.microsoft.com/en-us/d6768e4b-cd80-414d-a4f8-05d979eb393b)   \n [Redistributing Primary Interop Assemblies](http://msdn.microsoft.com/en-us/e76384f0-d631-474c-bdbd-13884cba0265)","nodes":[{"pos":[12,72],"content":"How to: Register Primary Interop Assemblies | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Register Primary Interop Assemblies | Microsoft Docs","pos":[0,60]}]},{"pos":[545,588],"content":"How to: Register Primary Interop Assemblies","linkify":"How to: Register Primary Interop Assemblies","nodes":[{"content":"How to: Register Primary Interop Assemblies","pos":[0,43]}]},{"content":"Classes can be marshaled only by COM interop and are always marshaled as interfaces.","pos":[589,673]},{"content":"In some cases the interface used to marshal the class is known as the class interface.","pos":[674,760]},{"content":"For information about overriding the class interface with an interface of your choice, see <bpt id=\"p1\">[</bpt>COM Callable Wrapper<ept id=\"p1\">](../../../docs/framework/interop/com-callable-wrapper.md)</ept>.","pos":[761,932],"source":" For information about overriding the class interface with an interface of your choice, see [COM Callable Wrapper](../../../docs/framework/interop/com-callable-wrapper.md)."},{"content":"Although any developer who wants to use COM types from a .NET Framework application can generate an interop assembly, doing so creates a problem.","pos":[939,1084]},{"content":"Each time a developer imports and signs a COM type library, that developer creates a set of unique types that are incompatible with those imported and signed by another developer.","pos":[1085,1264]},{"content":"The solution to this type incompatibility problem is for each developer to obtain the vendor-supplied and signed primary interop assembly.","pos":[1265,1403]},{"content":"If you plan to expose third-party COM types to other applications, always use the primary interop assembly provided by the same publisher as the type library it defines.","pos":[1410,1579]},{"content":"In addition to providing guaranteed type compatibility, primary interop assemblies are often customized by the vendor to enhance interoperability.","pos":[1580,1726]},{"content":"Even if you do not plan to expose third-party COM types, using the primary interop assembly can ease the task of interoperating with COM components.","pos":[1733,1881]},{"content":"However, this strategy provides no insulation from changes a vendor might make to types defined in a primary interop assembly.","pos":[1882,2008]},{"content":"When your application requires such insulation, generate your own interop assembly instead of using the primary interop assembly.","pos":[2009,2138]},{"content":"You must register all acquired primary interop assemblies on your development computer before you can reference them with <ph id=\"ph1\">[!INCLUDE[vsprvsext](../../../includes/vsprvsext-md.md)]</ph>.","pos":[2145,2324],"source":"You must register all acquired primary interop assemblies on your development computer before you can reference them with [!INCLUDE[vsprvsext](../../../includes/vsprvsext-md.md)]."},{"content":"Visual Studio looks for and uses a primary interop assembly the first time that you reference a type from a COM type library.","pos":[2325,2450]},{"content":"If Visual Studio cannot locate the primary interop assembly associated with the type library, it prompts you to acquire it or offers to create an interop assembly instead.","pos":[2451,2622]},{"content":"Likewise, the <bpt id=\"p1\">[</bpt>Type Library Importer (Tlbimp.exe)<ept id=\"p1\">](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)</ept> also uses the registry to locate primary interop assemblies.","pos":[2623,2801],"source":" Likewise, the [Type Library Importer (Tlbimp.exe)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md) also uses the registry to locate primary interop assemblies."},{"content":"Although it is not necessary to register primary interop assemblies unless you plan to use Visual Studio, registration provides two advantages:","pos":[2808,2951]},{"content":"A registered primary interop assembly is clearly marked under the registry key of the original type library.","pos":[2961,3069]},{"content":"Registration is the best way for you to locate a primary interop assembly on your computer.","pos":[3070,3161]},{"content":"You can avoid accidentally generating and using a new interop assembly if, at some time in the future, you do use Visual Studio to reference a type for which you have an unregistered primary interop assembly.","pos":[3171,3379]},{"pos":[3386,3547],"content":"Use the <bpt id=\"p1\">[</bpt>Assembly Registration Tool (Regasm.exe)<ept id=\"p1\">](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md)</ept> to register a primary interop assembly.","source":"Use the [Assembly Registration Tool (Regasm.exe)](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md) to register a primary interop assembly."},{"pos":[3557,3595],"content":"To register a primary interop assembly","linkify":"To register a primary interop assembly","nodes":[{"content":"To register a primary interop assembly","pos":[0,38]}]},{"content":"At the command prompt, type:","pos":[3605,3633]},{"pos":[3644,3669],"content":"<bpt id=\"p1\">**</bpt>regasm<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>assemblyname<ept id=\"p2\">*</ept>","source":"**regasm** *assemblyname*"},{"content":"In this command, <bpt id=\"p1\">*</bpt>assemblyname<ept id=\"p1\">*</ept> is the file name of the assembly that is registered.","pos":[3680,3764],"source":"In this command, *assemblyname* is the file name of the assembly that is registered."},{"content":"Regasm.exe adds an entry for the primary interop assembly under the same registry key as the original type library.","pos":[3765,3880]},{"pos":[3889,3896],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3900,3984],"content":"The following example registers the <ph id=\"ph1\">`CompanyA.UtilLib.dll`</ph> primary interop assembly.","source":"The following example registers the `CompanyA.UtilLib.dll` primary interop assembly."},{"pos":[4038,4046],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Programming with Primary Interop Assemblies<ept id=\"p1\">](http://msdn.microsoft.com/en-us/306fa1d6-0703-4004-9e93-d0a57f1be81e)</ept><ph id=\"ph1\"> </ph>","pos":[4050,4166],"source":"[Programming with Primary Interop Assemblies](http://msdn.microsoft.com/en-us/306fa1d6-0703-4004-9e93-d0a57f1be81e) "},{"content":"<bpt id=\"p1\"> [</bpt>Locating Primary Interop Assemblies<ept id=\"p1\">](http://msdn.microsoft.com/en-us/d6768e4b-cd80-414d-a4f8-05d979eb393b)</ept><ph id=\"ph1\"> </ph>","pos":[4169,4278],"source":" [Locating Primary Interop Assemblies](http://msdn.microsoft.com/en-us/d6768e4b-cd80-414d-a4f8-05d979eb393b) "},{"content":"<bpt id=\"p1\"> [</bpt>Redistributing Primary Interop Assemblies<ept id=\"p1\">](http://msdn.microsoft.com/en-us/e76384f0-d631-474c-bdbd-13884cba0265)</ept>","pos":[4281,4395],"source":" [Redistributing Primary Interop Assemblies](http://msdn.microsoft.com/en-us/e76384f0-d631-474c-bdbd-13884cba0265)"}]}