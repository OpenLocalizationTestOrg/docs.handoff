{"content":"---\ntitle: \"Saving and Writing a Document\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 097b0cb1-5743-4c3a-86ef-caf5cbe6750d\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Saving and Writing a Document\nWhen you load and save an <xref:System.Xml.XmlDocument>, the saved document may differ from the original in the following ways:  \n  \n-   If the <xref:System.Xml.XmlDocument.PreserveWhitespace%2A> property is set to `true` before the <xref:System.Xml.XmlDocument.Save%2A> method is called, white space in the document is preserved in the output; if this property is `false`, <xref:System.Xml.XmlDocument> auto-indents the output.  \n  \n-   All the white space between attributes is reduced to a single space character.  \n  \n-   The white space between elements is changed. Significant white space is preserved and insignificant white space is not. But when the document is saved, it will use the <xref:System.Xml.XmlTextWriter> **Indenting** mode by default to neatly print the output to make it more readable.  \n  \n-   The quote character used around attribute values is changed to double quote by default. You can use the <xref:System.Xml.XmlTextReader.QuoteChar%2A> property on <xref:System.Xml.XmlTextWriter> to set the quote character to either double quote or single quote.  \n  \n-   By default, numeric character entities like `{` are expanded.  \n  \n-   The byte-order mark found in the input document is not preserved. UCS-2 is saved as UTF-8 unless you explicitly create an XML declaration that specifies a different encoding.  \n  \n-   If you want to write out the <xref:System.Xml.XmlDocument> into a file or stream, the output written out is the same as the content of the document. That is, the <xref:System.Xml.XmlDeclaration> is written out only if there is one contained in the document, and the encoding used when writing out the document is the same encoding given in the declaration node.  \n  \n## Writing an XmlDeclaration  \n The <xref:System.Xml.XmlDocument> and <xref:System.Xml.XmlDeclaration> members of <xref:System.Xml.XmlNode.OuterXml%2A>, <xref:System.Xml.XmlNode.InnerXml%2A>, and <xref:System.Xml.XmlNode.WriteTo%2A>, in addition to the <xref:System.Xml.XmlDocument> methods of <xref:System.Xml.XmlDocument.Save%2A> and <xref:System.Xml.XmlDocument.WriteContentTo%2A>, create an XML declaration.  \n  \n For the <xref:System.Xml.XmlDocument> properties of <xref:System.Xml.XmlNode.OuterXml%2A>, <xref:System.Xml.XmlDocument.InnerXml%2A>, and the <xref:System.Xml.XmlDocument.Save%2A>, <xref:System.Xml.XmlDocument.WriteTo%2A>, and <xref:System.Xml.XmlDocument.WriteContentTo%2A> methods, the encoding written out in the XML declaration is taken from the <xref:System.Xml.XmlDeclaration> node. If there is no <xref:System.Xml.XmlDeclaration> node, <xref:System.Xml.XmlDeclaration> is not written out. If there is no encoding in the <xref:System.Xml.XmlDeclaration> node, encoding is not written out in the XML declaration.  \n  \n The <xref:System.Xml.XmlDocument.Save%2A?displayProperty=nameWithType> and <xref:System.Xml.XmlDocument.Save%2A?displayProperty=nameWithType> methods always write out an <xref:System.Xml.XmlDeclaration>. These methods take the encoding from the writer that it is writing to. That is, the encoding value on the writer overrides the encoding on the document and in the <xref:System.Xml.XmlDeclaration>. For example, the following code does not write an encoding in the XML declaration found in the output file `out.xml`.  \n  \n```vb  \nDim doc As New XmlDocument()  \nDim tw As XmlTextWriter = New XmlTextWriter(\"out.xml\", Nothing)  \ndoc.Load(\"text.xml\")  \ndoc.Save(tw)  \n```  \n  \n```csharp  \nXmlDocument doc = new XmlDocument();  \nXmlTextWriter tw = new XmlTextWriter(\"out.xml\", null);  \ndoc.Load(\"text.xml\");  \ndoc.Save(tw);  \n```  \n  \n For the <xref:System.Xml.XmlDocument.Save%2A> method, the XML declaration is written out using the <xref:System.Xml.XmlWriter.WriteStartDocument%2A> method in the <xref:System.Xml.XmlWriter> class. Therefore, overwriting the <xref:System.Xml.XmlWriter.WriteStartDocument%2A> method changes how the start of the document is written.  \n  \n For the <xref:System.Xml.XmlDeclaration> members of <xref:System.Xml.XmlNode.OuterXml%2A>, <xref:System.Xml.XmlDeclaration.WriteTo%2A>, and <xref:System.Xml.XmlNode.InnerXml%2A>, if the <xref:System.Xml.XmlDeclaration.Encoding%2A> property is not set, no encoding is written out. Otherwise, the encoding written out in the XML declaration is the same as the encoding found in the <xref:System.Xml.XmlDeclaration.Encoding%2A> property.  \n  \n## Writing Document Content Using the OuterXml Property  \n The <xref:System.Xml.XmlNode.OuterXml%2A> property is a Microsoft extension to the World Wide Web Consortium (W3C) XML Document Object Model (DOM) standards. The <xref:System.Xml.XmlNode.OuterXml%2A> property is used to get the markup of the whole XML document, or just the markup of a single node and its child nodes. <xref:System.Xml.XmlNode.OuterXml%2A> returns the markup representing the given node and all its child nodes.  \n  \n The following code sample shows how to save a document in its entirety as a string.  \n  \n```vb  \nDim mydoc As New XmlDocument()  \n' Perform application needs here, like mydoc.Load(\"myfile\");  \n' Now save the entire document to a string variable called \"xml\".  \nDim xml As String = mydoc.OuterXml  \n```  \n  \n```csharp  \nXmlDocument mydoc = new XmlDocument();  \n// Perform application needs here, like mydoc.Load(\"myfile\");  \n// Now save the entire document to a string variable called \"xml\".  \nstring xml = mydoc.OuterXml;  \n```  \n  \n The following code sample shows how to save only the document element.  \n  \n```vb  \n' For the content of the Document Element only.  \nDim xml As String = mydoc.DocumentElement.OuterXml  \n```  \n  \n```csharp  \n// For the content of the Document Element only.  \nstring xml = mydoc.DocumentElement.OuterXml;  \n```  \n  \n In contrast, you can use the <xref:System.Xml.XmlNode.InnerText%2A> property if you want the content of child nodes.  \n  \n## See also\n\n- [XML Document Object Model (DOM)](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)\n","nodes":[{"pos":[4,215],"embed":true,"restype":"x-metadata","content":"title: \"Saving and Writing a Document\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 097b0cb1-5743-4c3a-86ef-caf5cbe6750d\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Saving and Writing a Document","nodes":[{"pos":[0,29],"content":"Saving and Writing a Document","nodes":[{"content":"Saving and Writing a Document","pos":[0,29]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[222,251],"content":"Saving and Writing a Document","linkify":"Saving and Writing a Document","nodes":[{"content":"Saving and Writing a Document","pos":[0,29]}]},{"pos":[252,379],"content":"When you load and save an <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph>, the saved document may differ from the original in the following ways:","source":"When you load and save an <xref:System.Xml.XmlDocument>, the saved document may differ from the original in the following ways:"},{"pos":[389,680],"content":"If the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument.PreserveWhitespace%2A&gt;</ph> property is set to <ph id=\"ph2\">`true`</ph> before the <ph id=\"ph3\">&lt;xref:System.Xml.XmlDocument.Save%2A&gt;</ph> method is called, white space in the document is preserved in the output; if this property is <ph id=\"ph4\">`false`</ph>, <ph id=\"ph5\">&lt;xref:System.Xml.XmlDocument&gt;</ph> auto-indents the output.","source":"If the <xref:System.Xml.XmlDocument.PreserveWhitespace%2A> property is set to `true` before the <xref:System.Xml.XmlDocument.Save%2A> method is called, white space in the document is preserved in the output; if this property is `false`, <xref:System.Xml.XmlDocument> auto-indents the output."},{"content":"All the white space between attributes is reduced to a single space character.","pos":[690,768]},{"content":"The white space between elements is changed.","pos":[778,822]},{"content":"Significant white space is preserved and insignificant white space is not.","pos":[823,897]},{"content":"But when the document is saved, it will use the <ph id=\"ph1\">&lt;xref:System.Xml.XmlTextWriter&gt;</ph> <bpt id=\"p1\">**</bpt>Indenting<ept id=\"p1\">**</ept> mode by default to neatly print the output to make it more readable.","pos":[898,1060],"source":" But when the document is saved, it will use the <xref:System.Xml.XmlTextWriter> **Indenting** mode by default to neatly print the output to make it more readable."},{"content":"The quote character used around attribute values is changed to double quote by default.","pos":[1070,1157]},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Xml.XmlTextReader.QuoteChar%2A&gt;</ph> property on <ph id=\"ph2\">&lt;xref:System.Xml.XmlTextWriter&gt;</ph> to set the quote character to either double quote or single quote.","pos":[1158,1329],"source":" You can use the <xref:System.Xml.XmlTextReader.QuoteChar%2A> property on <xref:System.Xml.XmlTextWriter> to set the quote character to either double quote or single quote."},{"pos":[1339,1400],"content":"By default, numeric character entities like <ph id=\"ph1\">`{`</ph> are expanded.","source":"By default, numeric character entities like `{` are expanded."},{"content":"The byte-order mark found in the input document is not preserved.","pos":[1410,1475]},{"content":"UCS-2 is saved as UTF-8 unless you explicitly create an XML declaration that specifies a different encoding.","pos":[1476,1584]},{"content":"If you want to write out the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> into a file or stream, the output written out is the same as the content of the document.","pos":[1594,1742],"source":"If you want to write out the <xref:System.Xml.XmlDocument> into a file or stream, the output written out is the same as the content of the document."},{"content":"That is, the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDeclaration&gt;</ph> is written out only if there is one contained in the document, and the encoding used when writing out the document is the same encoding given in the declaration node.","pos":[1743,1955],"source":" That is, the <xref:System.Xml.XmlDeclaration> is written out only if there is one contained in the document, and the encoding used when writing out the document is the same encoding given in the declaration node."},{"pos":[1964,1989],"content":"Writing an XmlDeclaration","linkify":"Writing an XmlDeclaration","nodes":[{"content":"Writing an XmlDeclaration","pos":[0,25]}]},{"pos":[1993,2372],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.XmlDeclaration&gt;</ph> members of <ph id=\"ph3\">&lt;xref:System.Xml.XmlNode.OuterXml%2A&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Xml.XmlNode.InnerXml%2A&gt;</ph>, and <ph id=\"ph5\">&lt;xref:System.Xml.XmlNode.WriteTo%2A&gt;</ph>, in addition to the <ph id=\"ph6\">&lt;xref:System.Xml.XmlDocument&gt;</ph> methods of <ph id=\"ph7\">&lt;xref:System.Xml.XmlDocument.Save%2A&gt;</ph> and <ph id=\"ph8\">&lt;xref:System.Xml.XmlDocument.WriteContentTo%2A&gt;</ph>, create an XML declaration.","source":"The <xref:System.Xml.XmlDocument> and <xref:System.Xml.XmlDeclaration> members of <xref:System.Xml.XmlNode.OuterXml%2A>, <xref:System.Xml.XmlNode.InnerXml%2A>, and <xref:System.Xml.XmlNode.WriteTo%2A>, in addition to the <xref:System.Xml.XmlDocument> methods of <xref:System.Xml.XmlDocument.Save%2A> and <xref:System.Xml.XmlDocument.WriteContentTo%2A>, create an XML declaration."},{"content":"For the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> properties of <ph id=\"ph2\">&lt;xref:System.Xml.XmlNode.OuterXml%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Xml.XmlDocument.InnerXml%2A&gt;</ph>, and the <ph id=\"ph4\">&lt;xref:System.Xml.XmlDocument.Save%2A&gt;</ph>, <ph id=\"ph5\">&lt;xref:System.Xml.XmlDocument.WriteTo%2A&gt;</ph>, and <ph id=\"ph6\">&lt;xref:System.Xml.XmlDocument.WriteContentTo%2A&gt;</ph> methods, the encoding written out in the XML declaration is taken from the <ph id=\"ph7\">&lt;xref:System.Xml.XmlDeclaration&gt;</ph> node.","pos":[2379,2767],"source":"For the <xref:System.Xml.XmlDocument> properties of <xref:System.Xml.XmlNode.OuterXml%2A>, <xref:System.Xml.XmlDocument.InnerXml%2A>, and the <xref:System.Xml.XmlDocument.Save%2A>, <xref:System.Xml.XmlDocument.WriteTo%2A>, and <xref:System.Xml.XmlDocument.WriteContentTo%2A> methods, the encoding written out in the XML declaration is taken from the <xref:System.Xml.XmlDeclaration> node."},{"content":"If there is no <ph id=\"ph1\">&lt;xref:System.Xml.XmlDeclaration&gt;</ph> node, <ph id=\"ph2\">&lt;xref:System.Xml.XmlDeclaration&gt;</ph> is not written out. If there is no encoding in the <ph id=\"ph3\">&lt;xref:System.Xml.XmlDeclaration&gt;</ph> node, encoding is not written out in the XML declaration.","pos":[2768,2996],"source":" If there is no <xref:System.Xml.XmlDeclaration> node, <xref:System.Xml.XmlDeclaration> is not written out. If there is no encoding in the <xref:System.Xml.XmlDeclaration> node, encoding is not written out in the XML declaration."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument.Save%2A?displayProperty=nameWithType&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument.Save%2A?displayProperty=nameWithType&gt;</ph> methods always write out an <ph id=\"ph3\">&lt;xref:System.Xml.XmlDeclaration&gt;</ph>.","pos":[3003,3206],"source":"The <xref:System.Xml.XmlDocument.Save%2A?displayProperty=nameWithType> and <xref:System.Xml.XmlDocument.Save%2A?displayProperty=nameWithType> methods always write out an <xref:System.Xml.XmlDeclaration>."},{"content":"These methods take the encoding from the writer that it is writing to.","pos":[3207,3277]},{"content":"That is, the encoding value on the writer overrides the encoding on the document and in the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDeclaration&gt;</ph>.","pos":[3278,3403],"source":" That is, the encoding value on the writer overrides the encoding on the document and in the <xref:System.Xml.XmlDeclaration>."},{"content":"For example, the following code does not write an encoding in the XML declaration found in the output file <ph id=\"ph1\">`out.xml`</ph>.","pos":[3404,3521],"source":" For example, the following code does not write an encoding in the XML declaration found in the output file `out.xml`."},{"content":"For the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument.Save%2A&gt;</ph> method, the XML declaration is written out using the <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter.WriteStartDocument%2A&gt;</ph> method in the <ph id=\"ph3\">&lt;xref:System.Xml.XmlWriter&gt;</ph> class.","pos":[3837,4034],"source":"For the <xref:System.Xml.XmlDocument.Save%2A> method, the XML declaration is written out using the <xref:System.Xml.XmlWriter.WriteStartDocument%2A> method in the <xref:System.Xml.XmlWriter> class."},{"content":"Therefore, overwriting the <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter.WriteStartDocument%2A&gt;</ph> method changes how the start of the document is written.","pos":[4035,4168],"source":" Therefore, overwriting the <xref:System.Xml.XmlWriter.WriteStartDocument%2A> method changes how the start of the document is written."},{"pos":[4175,4609],"content":"For the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDeclaration&gt;</ph> members of <ph id=\"ph2\">&lt;xref:System.Xml.XmlNode.OuterXml%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Xml.XmlDeclaration.WriteTo%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Xml.XmlNode.InnerXml%2A&gt;</ph>, if the <ph id=\"ph5\">&lt;xref:System.Xml.XmlDeclaration.Encoding%2A&gt;</ph> property is not set, no encoding is written out. Otherwise, the encoding written out in the XML declaration is the same as the encoding found in the <ph id=\"ph6\">&lt;xref:System.Xml.XmlDeclaration.Encoding%2A&gt;</ph> property.","source":"For the <xref:System.Xml.XmlDeclaration> members of <xref:System.Xml.XmlNode.OuterXml%2A>, <xref:System.Xml.XmlDeclaration.WriteTo%2A>, and <xref:System.Xml.XmlNode.InnerXml%2A>, if the <xref:System.Xml.XmlDeclaration.Encoding%2A> property is not set, no encoding is written out. Otherwise, the encoding written out in the XML declaration is the same as the encoding found in the <xref:System.Xml.XmlDeclaration.Encoding%2A> property."},{"pos":[4618,4670],"content":"Writing Document Content Using the OuterXml Property","linkify":"Writing Document Content Using the OuterXml Property","nodes":[{"content":"Writing Document Content Using the OuterXml Property","pos":[0,52]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlNode.OuterXml%2A&gt;</ph> property is a Microsoft extension to the World Wide Web Consortium (W3C) XML Document Object Model (DOM) standards.","pos":[4674,4831],"source":"The <xref:System.Xml.XmlNode.OuterXml%2A> property is a Microsoft extension to the World Wide Web Consortium (W3C) XML Document Object Model (DOM) standards."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlNode.OuterXml%2A&gt;</ph> property is used to get the markup of the whole XML document, or just the markup of a single node and its child nodes.","pos":[4832,4992],"source":" The <xref:System.Xml.XmlNode.OuterXml%2A> property is used to get the markup of the whole XML document, or just the markup of a single node and its child nodes."},{"content":"<ph id=\"ph1\">&lt;xref:System.Xml.XmlNode.OuterXml%2A&gt;</ph> returns the markup representing the given node and all its child nodes.","pos":[4993,5102],"source":"<xref:System.Xml.XmlNode.OuterXml%2A> returns the markup representing the given node and all its child nodes."},{"content":"The following code sample shows how to save a document in its entirety as a string.","pos":[5109,5192]},{"content":"The following code sample shows how to save only the document element.","pos":[5643,5713]},{"pos":[5959,6075],"content":"In contrast, you can use the <ph id=\"ph1\">&lt;xref:System.Xml.XmlNode.InnerText%2A&gt;</ph> property if you want the content of child nodes.","source":"In contrast, you can use the <xref:System.Xml.XmlNode.InnerText%2A> property if you want the content of child nodes."},{"pos":[6084,6092],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6096,6198],"content":"<bpt id=\"p1\">[</bpt>XML Document Object Model (DOM)<ept id=\"p1\">](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)</ept>","source":"[XML Document Object Model (DOM)](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)"}]}