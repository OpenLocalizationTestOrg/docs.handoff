{"content":"---\ntitle: \"<performanceCounters> Element\"\nms.date: \"03/30/2017\"\nf1_keywords:\n  - \"http://schemas.microsoft.com/.NetConfiguration/v2.0#configuration/system.diagnostics/performanceCounters\"\n  - \"http://schemas.microsoft.com/.NetConfiguration/v2.0#performanceCounters\"\nhelpviewer_keywords:\n  - \"performanceCounters element\"\n  - \"<performanceCounters> element\"\nms.assetid: a71f605b-c7d9-4501-a5c3-abcbb964a43f\n---\n\n# \\<performanceCounters> Element\n\nSpecifies the size of the global memory shared by performance counters.\n\n \\<configuration>\\\n\\<system.diagnostics>\\\n\\<performanceCounters>\n\n## Syntax\n\n```xml\n<performanceCounters filemappingsize=\"524288\" />\n```\n\n## Attributes and Elements\n\nThe following sections describe attributes, child elements, and parent elements.\n\n### Attributes\n\n|Attribute|Description|\n|---------------|-----------------|\n|filemappingsize|Required attribute.<br /><br /> Specifies the size, in bytes, of the global memory shared by performance counters. The default is 524288.|\n\n### Child Elements\n\nNone.\n\n### Parent Elements\n\n|Element|Description|\n|-------------|-----------------|\n|`Configuration`|The root element in every configuration file used by the common language runtime and .NET Framework applications.|\n|`system.diagnostics`|Specifies the root element for the ASP.NET configuration section.|\n\n## Remarks\n\nPerformance counters use a memory mapped file, or shared memory, to publish performance data.  The size of the shared memory determines how many instances can be used at once.  There are two types of shared memory: global shared memory and separate shared memory.  The global shared memory is used by all performance counter categories installed with the .NET Framework versions 1.0 or 1.1.  Performance counter categories installed with the .NET Framework version 2.0 use separate shared memory, with each performance counter category having its own memory.\n\nThe size of global shared memory can be set only with a configuration file.  The default size is 524,288 byes, the maximum size is 33,554,432 bytes, and the minimum size is 32,768 bytes.  Since the global shared memory is shared by all processes and categories, the first creator specifies the size.  If you define the size in your application configuration file, that size is only used if your application is the first application that causes the performance counters to execute.  Therefore the correct location to specify the `filemappingsize` value is the Machine.config file.  Memory in the global shared memory cannot be released by individual performance counters, so eventually global shared memory is exhausted if a large number of performance counter instances with different names are created.\n\nFor the size of separate shared memory, the DWORD FileMappingSize value in the registry key HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\\\*\\<category name>*\\Performance is referenced first, followed by the value specified for the global shared memory in the configuration file. If the FileMappingSize value does not exist, then the separate shared memory size is set to one fourth (1/4) the global setting in the configuration file.\n\n## See also\n\n- <xref:System.Diagnostics.PerformanceCounter>\n- <xref:System.Diagnostics.PerformanceCounterCategory>\n- <xref:System.Diagnostics.PerformanceCounter.InstanceLifetime%2A>\n- <xref:System.Diagnostics.PerformanceCounterInstanceLifetime>\n","nodes":[{"pos":[4,406],"embed":true,"restype":"x-metadata","content":"title: \"<performanceCounters> Element\"\nms.date: \"03/30/2017\"\nf1_keywords:\n  - \"http://schemas.microsoft.com/.NetConfiguration/v2.0#configuration/system.diagnostics/performanceCounters\"\n  - \"http://schemas.microsoft.com/.NetConfiguration/v2.0#performanceCounters\"\nhelpviewer_keywords:\n  - \"performanceCounters element\"\n  - \"<performanceCounters> element\"\nms.assetid: a71f605b-c7d9-4501-a5c3-abcbb964a43f","nodes":[{"content":"<performanceCounters> Element","nodes":[{"pos":[0,29],"content":"<ph id=\"ph1\">&lt;performanceCounters&gt;</ph> Element","source":"<performanceCounters> Element"}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[414,444],"content":"\\<performanceCounters> Element","linkify":"\\<performanceCounters> Element","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>performanceCounters&gt; Element","pos":[0,30],"source":"\\<performanceCounters> Element"}]},{"content":"Specifies the size of the global memory shared by performance counters.","pos":[446,517]},{"content":"<ph id=\"ph1\">\\&lt;</ph>configuration&gt;\\","pos":[520,537],"source":"\\<configuration>\\"},{"content":"<ph id=\"ph1\">\\&lt;</ph>system.diagnostics&gt;\\","pos":[538,560],"source":"\\<system.diagnostics>\\"},{"content":"<ph id=\"ph1\">\\&lt;</ph>performanceCounters&gt;","pos":[561,583],"source":"\\<performanceCounters>"},{"pos":[588,594],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[660,683],"content":"Attributes and Elements","linkify":"Attributes and Elements","nodes":[{"content":"Attributes and Elements","pos":[0,23]}]},{"content":"The following sections describe attributes, child elements, and parent elements.","pos":[685,765]},{"pos":[771,781],"content":"Attributes","linkify":"Attributes","nodes":[{"content":"Attributes","pos":[0,10]}]},{"content":"Attribute","pos":[784,793]},{"content":"Description","pos":[794,805]},{"content":"filemappingsize","pos":[844,859]},{"content":"Required attribute.","pos":[860,879]},{"content":"Specifies the size, in bytes, of the global memory shared by performance counters.","pos":[892,974]},{"content":"The default is 524288.","pos":[975,997]},{"pos":[1004,1018],"content":"Child Elements","linkify":"Child Elements","nodes":[{"content":"Child Elements","pos":[0,14]}]},{"content":"None.","pos":[1020,1025]},{"pos":[1031,1046],"content":"Parent Elements","linkify":"Parent Elements","nodes":[{"content":"Parent Elements","pos":[0,15]}]},{"content":"Element","pos":[1049,1056]},{"content":"Description","pos":[1057,1068]},{"content":"The root element in every configuration file used by the common language runtime and .NET Framework applications.","pos":[1121,1234]},{"content":"Specifies the root element for the ASP.NET configuration section.","pos":[1258,1323]},{"pos":[1329,1336],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Performance counters use a memory mapped file, or shared memory, to publish performance data.","pos":[1338,1431]},{"content":"The size of the shared memory determines how many instances can be used at once.","pos":[1433,1513]},{"content":"There are two types of shared memory: global shared memory and separate shared memory.","pos":[1515,1601]},{"content":"The global shared memory is used by all performance counter categories installed with the .NET Framework versions 1.0 or 1.1.","pos":[1603,1728]},{"content":"Performance counter categories installed with the .NET Framework version 2.0 use separate shared memory, with each performance counter category having its own memory.","pos":[1730,1896]},{"content":"The size of global shared memory can be set only with a configuration file.","pos":[1898,1973]},{"content":"The default size is 524,288 byes, the maximum size is 33,554,432 bytes, and the minimum size is 32,768 bytes.","pos":[1975,2084]},{"content":"Since the global shared memory is shared by all processes and categories, the first creator specifies the size.","pos":[2086,2197]},{"content":"If you define the size in your application configuration file, that size is only used if your application is the first application that causes the performance counters to execute.","pos":[2199,2378]},{"content":"Therefore the correct location to specify the <ph id=\"ph1\">`filemappingsize`</ph> value is the Machine.config file.","pos":[2380,2477],"source":"  Therefore the correct location to specify the `filemappingsize` value is the Machine.config file."},{"content":"Memory in the global shared memory cannot be released by individual performance counters, so eventually global shared memory is exhausted if a large number of performance counter instances with different names are created.","pos":[2479,2701]},{"content":"For the size of separate shared memory, the DWORD FileMappingSize value in the registry key HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services<ph id=\"ph1\">\\\\</ph><bpt id=\"p1\">*</bpt><ph id=\"ph2\">\\&lt;</ph>category name&gt;<ept id=\"p1\">*</ept>\\Performance is referenced first, followed by the value specified for the global shared memory in the configuration file.","pos":[2703,2988],"source":"For the size of separate shared memory, the DWORD FileMappingSize value in the registry key HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\\\*\\<category name>*\\Performance is referenced first, followed by the value specified for the global shared memory in the configuration file."},{"content":"If the FileMappingSize value does not exist, then the separate shared memory size is set to one fourth (1/4) the global setting in the configuration file.","pos":[2989,3143]},{"pos":[3148,3156],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]}]}