{"content":"---\ntitle: \"How to: Chunk Serialized Data | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"chunking serialized data\"\n  - \"data chunking\"\n  - \"binary serialization, chunking data\"\n  - \"large data set chunking\"\n  - \"serialization, chunking data\"\n  - \"serialization, examples\"\n  - \"binary serialization, examples\"\nms.assetid: 22f1b818-7e0d-428a-8680-f17d6ebdd185\ncaps.latest.revision: 3\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Chunk Serialized Data\nTwo issues that occur when sending large data sets in Web service messages are:  \n  \n1.  A large working set (memory) due to buffering by the serialization engine.  \n  \n2.  Inordinate bandwidth consumption due to 33 percent inflation after Base64 encoding.  \n  \n To solve these problems, implement the <xref:System.Xml.Serialization.IXmlSerializable> interface to control the serialization and deserialization. Specifically, implement the <xref:System.Xml.Serialization.IXmlSerializable.WriteXml%2A> and <xref:System.Xml.Serialization.IXmlSerializable.ReadXml%2A> methods to chunk the data.  \n  \n### To implement server-side chunking  \n  \n1.  On the server machine, the Web method must turn off ASP.NET buffering and return a type that implements <xref:System.Xml.Serialization.IXmlSerializable>.  \n  \n2.  The type that implements <xref:System.Xml.Serialization.IXmlSerializable> chunks the data in the <xref:System.Xml.Serialization.IXmlSerializable.WriteXml%2A> method.  \n  \n### To implement client-side processing  \n  \n1.  Alter the Web method on the client proxy to return the type that implements <xref:System.Xml.Serialization.IXmlSerializable>. You can use a <xref:System.Xml.Serialization.Advanced.SchemaImporterExtension> to do this automatically, but this is not shown here.  \n  \n2.  Implement the <xref:System.Xml.Serialization.IXmlSerializable.ReadXml%2A> method to read the chunked data stream and write the bytes to disk. This implementation also raises progress events that can be used by a graphic control, such as a progress bar.  \n  \n## Example  \n The following code example shows the Web method on the client that turns off ASP.NET buffering. It also shows the client-side implementation of the <xref:System.Xml.Serialization.IXmlSerializable> interface that chunks the data in the <xref:System.Xml.Serialization.IXmlSerializable.WriteXml%2A> method.  \n  \n [!code-csharp[HowToChunkSerializedData#1](../../../samples/snippets/csharp/VS_Snippets_Remoting/HowToChunkSerializedData/CS/SerializationChunk.cs#1)]\n [!code-vb[HowToChunkSerializedData#1](../../../samples/snippets/visualbasic/VS_Snippets_Remoting/HowToChunkSerializedData/VB/SerializationChunk.vb#1)]  \n[!code-csharp[HowToChunkSerializedData#2](../../../samples/snippets/csharp/VS_Snippets_Remoting/HowToChunkSerializedData/CS/SerializationChunk.cs#2)]\n[!code-vb[HowToChunkSerializedData#2](../../../samples/snippets/visualbasic/VS_Snippets_Remoting/HowToChunkSerializedData/VB/SerializationChunk.vb#2)]  \n[!code-csharp[HowToChunkSerializedData#3](../../../samples/snippets/csharp/VS_Snippets_Remoting/HowToChunkSerializedData/CS/SerializationChunk.cs#3)]\n[!code-vb[HowToChunkSerializedData#3](../../../samples/snippets/visualbasic/VS_Snippets_Remoting/HowToChunkSerializedData/VB/SerializationChunk.vb#3)]  \n  \n## Compiling the Code  \n  \n-   The code uses the following namespaces: <xref:System>, <xref:System.Runtime.Serialization>, <xref:System.Web.Services>, <xref:System.Web.Services.Protocols>, <xref:System.Xml>, <xref:System.Xml.Serialization>, and <xref:System.Xml.Schema>.  \n  \n## See Also  \n [Custom Serialization](../../../docs/framework/serialization/custom-serialization.md)","nodes":[{"pos":[4,620],"embed":true,"restype":"x-metadata","content":"title: \"How to: Chunk Serialized Data | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"chunking serialized data\"\n  - \"data chunking\"\n  - \"binary serialization, chunking data\"\n  - \"large data set chunking\"\n  - \"serialization, chunking data\"\n  - \"serialization, examples\"\n  - \"binary serialization, examples\"\nms.assetid: 22f1b818-7e0d-428a-8680-f17d6ebdd185\ncaps.latest.revision: 3\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","nodes":[{"content":"How to: Chunk Serialized Data | Microsoft Docs","nodes":[{"pos":[0,46],"content":"How to: Chunk Serialized Data | Microsoft Docs","nodes":[{"content":"How to: Chunk Serialized Data | Microsoft Docs","pos":[0,46]}]}],"path":["title"]}],"yml":true},{"pos":[627,656],"content":"How to: Chunk Serialized Data","linkify":"How to: Chunk Serialized Data","nodes":[{"content":"How to: Chunk Serialized Data","pos":[0,29]}]},{"content":"Two issues that occur when sending large data sets in Web service messages are:","pos":[657,736]},{"content":"A large working set (memory) due to buffering by the serialization engine.","pos":[746,820]},{"content":"Inordinate bandwidth consumption due to 33 percent inflation after Base64 encoding.","pos":[830,913]},{"content":"To solve these problems, implement the <ph id=\"ph1\">&lt;xref:System.Xml.Serialization.IXmlSerializable&gt;</ph> interface to control the serialization and deserialization.","pos":[920,1067],"source":"To solve these problems, implement the <xref:System.Xml.Serialization.IXmlSerializable> interface to control the serialization and deserialization."},{"content":"Specifically, implement the <ph id=\"ph1\">&lt;xref:System.Xml.Serialization.IXmlSerializable.WriteXml%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.Serialization.IXmlSerializable.ReadXml%2A&gt;</ph> methods to chunk the data.","pos":[1068,1247],"source":" Specifically, implement the <xref:System.Xml.Serialization.IXmlSerializable.WriteXml%2A> and <xref:System.Xml.Serialization.IXmlSerializable.ReadXml%2A> methods to chunk the data."},{"pos":[1257,1290],"content":"To implement server-side chunking","linkify":"To implement server-side chunking","nodes":[{"content":"To implement server-side chunking","pos":[0,33]}]},{"content":"On the server machine, the Web method must turn off ASP.NET buffering and return a type that implements <ph id=\"ph1\">&lt;xref:System.Xml.Serialization.IXmlSerializable&gt;</ph>.","pos":[1300,1453],"source":"On the server machine, the Web method must turn off ASP.NET buffering and return a type that implements <xref:System.Xml.Serialization.IXmlSerializable>."},{"content":"The type that implements <ph id=\"ph1\">&lt;xref:System.Xml.Serialization.IXmlSerializable&gt;</ph> chunks the data in the <ph id=\"ph2\">&lt;xref:System.Xml.Serialization.IXmlSerializable.WriteXml%2A&gt;</ph> method.","pos":[1463,1628],"source":"The type that implements <xref:System.Xml.Serialization.IXmlSerializable> chunks the data in the <xref:System.Xml.Serialization.IXmlSerializable.WriteXml%2A> method."},{"pos":[1638,1673],"content":"To implement client-side processing","linkify":"To implement client-side processing","nodes":[{"content":"To implement client-side processing","pos":[0,35]}]},{"content":"Alter the Web method on the client proxy to return the type that implements <ph id=\"ph1\">&lt;xref:System.Xml.Serialization.IXmlSerializable&gt;</ph>.","pos":[1683,1808],"source":"Alter the Web method on the client proxy to return the type that implements <xref:System.Xml.Serialization.IXmlSerializable>."},{"content":"You can use a <ph id=\"ph1\">&lt;xref:System.Xml.Serialization.Advanced.SchemaImporterExtension&gt;</ph> to do this automatically, but this is not shown here.","pos":[1809,1941],"source":" You can use a <xref:System.Xml.Serialization.Advanced.SchemaImporterExtension> to do this automatically, but this is not shown here."},{"content":"Implement the <ph id=\"ph1\">&lt;xref:System.Xml.Serialization.IXmlSerializable.ReadXml%2A&gt;</ph> method to read the chunked data stream and write the bytes to disk.","pos":[1951,2092],"source":"Implement the <xref:System.Xml.Serialization.IXmlSerializable.ReadXml%2A> method to read the chunked data stream and write the bytes to disk."},{"content":"This implementation also raises progress events that can be used by a graphic control, such as a progress bar.","pos":[2093,2203]},{"pos":[2212,2219],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example shows the Web method on the client that turns off ASP.NET buffering.","pos":[2223,2318]},{"content":"It also shows the client-side implementation of the <ph id=\"ph1\">&lt;xref:System.Xml.Serialization.IXmlSerializable&gt;</ph> interface that chunks the data in the <ph id=\"ph2\">&lt;xref:System.Xml.Serialization.IXmlSerializable.WriteXml%2A&gt;</ph> method.","pos":[2319,2526],"source":" It also shows the client-side implementation of the <xref:System.Xml.Serialization.IXmlSerializable> interface that chunks the data in the <xref:System.Xml.Serialization.IXmlSerializable.WriteXml%2A> method."},{"pos":[3449,3467],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"The code uses the following namespaces: <ph id=\"ph1\">&lt;xref:System&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Runtime.Serialization&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Web.Services&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Web.Services.Protocols&gt;</ph>, <ph id=\"ph5\">&lt;xref:System.Xml&gt;</ph>, <ph id=\"ph6\">&lt;xref:System.Xml.Serialization&gt;</ph>, and <ph id=\"ph7\">&lt;xref:System.Xml.Schema&gt;</ph>.","pos":[3477,3716],"source":"The code uses the following namespaces: <xref:System>, <xref:System.Runtime.Serialization>, <xref:System.Web.Services>, <xref:System.Web.Services.Protocols>, <xref:System.Xml>, <xref:System.Xml.Serialization>, and <xref:System.Xml.Schema>."},{"pos":[3725,3733],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[3737,3822],"content":"<bpt id=\"p1\">[</bpt>Custom Serialization<ept id=\"p1\">](../../../docs/framework/serialization/custom-serialization.md)</ept>","source":"[Custom Serialization](../../../docs/framework/serialization/custom-serialization.md)"}]}