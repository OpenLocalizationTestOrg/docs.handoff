{"content":"---\ntitle: \"Managing the Data Service Context (WCF Data Services)\"\nms.date: \"03/30/2017\"\nms.assetid: 15b19d09-7de7-4638-9556-6ef396cc45ec\n---\n# Managing the Data Service Context (WCF Data Services)\nThe <xref:System.Data.Services.Client.DataServiceContext> class encapsulates operations that are supported against a specified data service. Although [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] services are stateless, the context is not. Therefore, you can use the <xref:System.Data.Services.Client.DataServiceContext> class to maintain state on the client between interactions with the data service in order to support features such as change management. This class also manages identities and tracks changes.  \n  \n## Merge Options and Identity Resolution  \n When a <xref:System.Data.Services.Client.DataServiceQuery%601> is executed, the entities in the response feed are materialized into objects. For more information, see [Object Materialization](../../../../docs/framework/data/wcf/object-materialization-wcf-data-services.md). The way in which entries in a response message are materialized into objects is performed based on identity resolution and depends on the merge option under which the query was executed. When multiple queries or load requests are executed in the scope of a single <xref:System.Data.Services.Client.DataServiceContext>, the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client only tracks a single instance of an object that has a specific key value. This key, which is used to perform identity resolution, uniquely identifies an entity.  \n  \n By default, the client only materializes an entry in the response feed into an object for entities that are not already being tracked by the <xref:System.Data.Services.Client.DataServiceContext>. This means that changes to objects already in the cache are not overwritten. This behavior is controlled by specifying a <xref:System.Data.Services.Client.MergeOption> value for queries and load operations. This option is specified by setting the <xref:System.Data.Services.Client.DataServiceContext.MergeOption%2A> property on the <xref:System.Data.Services.Client.DataServiceContext>. The default merge option value is <xref:System.Data.Services.Client.MergeOption.AppendOnly>. This only materializes objects for entities that are not already being tracked, which means that existing objects are not overwritten. Another way to prevent changes to objects on the client from being overwritten by updates from the data service is to specify <xref:System.Data.Services.Client.MergeOption.PreserveChanges>. When you specify <xref:System.Data.Services.Client.MergeOption.OverwriteChanges>, values of objects on the client are replaced by the latest values from the entries in the response feed, even if changes have already been made to these objects. When a <xref:System.Data.Services.Client.MergeOption.NoTracking> merge option is used, the <xref:System.Data.Services.Client.DataServiceContext> cannot send changes made on client objects to the data service. With this option, changes are always overwritten with values from the data service.  \n  \n## Managing Concurrency  \n [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] supports optimistic concurrency that enables the data service to detect update conflicts. The data service provider can be configured in such a way that the data service checks for changes to entities by using a concurrency token. This token includes one or more properties of an entity type that are validated by the data service to determine whether a resource has changed. Concurrency tokens, which are included in the eTag header of requests to and responses from the data service, are managed for you by the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client. For more information, see [Updating the Data Service](../../../../docs/framework/data/wcf/updating-the-data-service-wcf-data-services.md).  \n  \n The <xref:System.Data.Services.Client.DataServiceContext> tracks changes made to objects that have been reported manually by using <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A>, <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A>, and <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A>, or by a <xref:System.Data.Services.Client.DataServiceCollection%601>. When the <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> method is called, the client sends changes back to the data service. <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> can fail when data changes in the client conflict with changes in the data service. When this occurs, you must query for the entity resource again to receive the update data. To overwrite changes in the data service, execute the query using the <xref:System.Data.Services.Client.MergeOption.PreserveChanges> merge option. When you call <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> again, the changes preserved on the client are persisted to the data service, as long as other changes have not already been made to the resource in the data service.  \n  \n## Saving Changes  \n Changes are tracked in the <xref:System.Data.Services.Client.DataServiceContext> instance but not sent to the server immediately. After you are finished with the required changes for a specified activity, call <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> to submit all the changes to the data service. A <xref:System.Data.Services.Client.DataServiceResponse> object is returned after the <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> operation is complete. The <xref:System.Data.Services.Client.DataServiceResponse> object includes a sequence of <xref:System.Data.Services.Client.OperationResponse> objects that, in turn, contain a sequence of <xref:System.Data.Services.Client.EntityDescriptor> or <xref:System.Data.Services.Client.LinkDescriptor> instances that represent the changes persisted or attempted. When an entity is created or modified in the data service, the <xref:System.Data.Services.Client.EntityDescriptor> includes a reference to the updated entity, including any server-generated property values, such as the generated `ProductID` value in the previous example. The client library automatically updates the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] object to have these new values.  \n  \n For successful insert and update operations, the state property of the <xref:System.Data.Services.Client.EntityDescriptor> or <xref:System.Data.Services.Client.LinkDescriptor> object associated with the operation is set to <xref:System.Data.Services.Client.EntityStates.Unchanged> and the new values are merged by using <xref:System.Data.Services.Client.MergeOption.OverwriteChanges>. When an insert, update, or delete operation fails in the data service, the entity state remains the same as it was before <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> was called, and the <xref:System.Data.Services.Client.OperationResponse.Error%2A> property of the <xref:System.Data.Services.Client.OperationResponse> is set to an <xref:System.Data.Services.Client.DataServiceRequestException> that contains information about the error. For more information, see [Updating the Data Service](../../../../docs/framework/data/wcf/updating-the-data-service-wcf-data-services.md).  \n  \n### Setting the HTTP Method for Updates  \n By default, the .NET Framework client library sends updates to existing entities as MERGE requests. A MERGE request updates selected properties of the entity; however the client always includes all properties in the MERGE request, even properties that have not changed. The [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protocol also supports sending PUT requests to update entities. In a PUT request, an existing entity is essentially replaced with a new instance of the entity with property values from the client. To use PUT requests, set the <xref:System.Data.Services.Client.SaveChangesOptions.ReplaceOnUpdate> flag on the <xref:System.Data.Services.Client.SaveChangesOptions> enumeration when calling <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A>.  \n  \n> [!NOTE]\n>  A PUT request will behave differently than a MERGE request when the client does not know about all properties of the entity. This might occur when projecting an entity type into a new type on the client. It might also occur when new properties have been added to the entity in the service data model and the <xref:System.Data.Services.Client.DataServiceContext.IgnoreMissingProperties%2A> property on the <xref:System.Data.Services.Client.DataServiceContext> is set to `true` to ignore such client mapping errors. In these cases, a PUT request will reset any properties that are unknown to the client to their default values.  \n  \n### POST Tunneling  \n By default, the client library sends create, read, update, and delete requests to an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service by using the corresponding HTTP methods of POST, GET, PUT/MERGE/PATCH, and DELETE. This upholds the basic principles of Representational State Transfer (REST). However, not every Web server implementation supports the full set of HTTP methods. In some cases, the supported methods might be restricted to just GET and POST. This can happen when an intermediary, like a firewall, blocks requests with certain methods. Because the GET and POST methods are most often supported, [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] prescribes a way to execute any unsupported HTTP methods by using a POST request. Known as *method tunneling* or *POST tunneling*, this enables a client to send a POST request with the actual method specified in the custom `X-HTTP-Method` header. To enable POST tunneling for requests, set the <xref:System.Data.Services.Client.DataServiceContext.UsePostTunneling%2A> property on the <xref:System.Data.Services.Client.DataServiceContext> instance to `true`.  \n  \n## See also\n\n- [WCF Data Services Client Library](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)\n- [Updating the Data Service](../../../../docs/framework/data/wcf/updating-the-data-service-wcf-data-services.md)\n- [Asynchronous Operations](../../../../docs/framework/data/wcf/asynchronous-operations-wcf-data-services.md)\n- [Batching Operations](../../../../docs/framework/data/wcf/batching-operations-wcf-data-services.md)\n","nodes":[{"pos":[4,137],"embed":true,"restype":"x-metadata","content":"title: \"Managing the Data Service Context (WCF Data Services)\"\nms.date: \"03/30/2017\"\nms.assetid: 15b19d09-7de7-4638-9556-6ef396cc45ec","nodes":[{"content":"Managing the Data Service Context (WCF Data Services)","nodes":[{"pos":[0,53],"content":"Managing the Data Service Context (WCF Data Services)","nodes":[{"content":"Managing the Data Service Context (WCF Data Services)","pos":[0,53]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[144,197],"content":"Managing the Data Service Context (WCF Data Services)","linkify":"Managing the Data Service Context (WCF Data Services)","nodes":[{"content":"Managing the Data Service Context (WCF Data Services)","pos":[0,53]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph> class encapsulates operations that are supported against a specified data service.","pos":[198,338],"source":"The <xref:System.Data.Services.Client.DataServiceContext> class encapsulates operations that are supported against a specified data service."},{"content":"Although <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> services are stateless, the context is not.","pos":[339,457],"source":" Although [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] services are stateless, the context is not."},{"content":"Therefore, you can use the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph> class to maintain state on the client between interactions with the data service in order to support features such as change management.","pos":[458,675],"source":" Therefore, you can use the <xref:System.Data.Services.Client.DataServiceContext> class to maintain state on the client between interactions with the data service in order to support features such as change management."},{"content":"This class also manages identities and tracks changes.","pos":[676,730]},{"pos":[739,776],"content":"Merge Options and Identity Resolution","linkify":"Merge Options and Identity Resolution","nodes":[{"content":"Merge Options and Identity Resolution","pos":[0,37]}]},{"content":"When a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> is executed, the entities in the response feed are materialized into objects.","pos":[780,920],"source":"When a <xref:System.Data.Services.Client.DataServiceQuery%601> is executed, the entities in the response feed are materialized into objects."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Object Materialization<ept id=\"p1\">](../../../../docs/framework/data/wcf/object-materialization-wcf-data-services.md)</ept>.","pos":[921,1053],"source":" For more information, see [Object Materialization](../../../../docs/framework/data/wcf/object-materialization-wcf-data-services.md)."},{"content":"The way in which entries in a response message are materialized into objects is performed based on identity resolution and depends on the merge option under which the query was executed.","pos":[1054,1240]},{"content":"When multiple queries or load requests are executed in the scope of a single <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph>, the <ph id=\"ph2\">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]</ph> client only tracks a single instance of an object that has a specific key value.","pos":[1241,1517],"source":" When multiple queries or load requests are executed in the scope of a single <xref:System.Data.Services.Client.DataServiceContext>, the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client only tracks a single instance of an object that has a specific key value."},{"content":"This key, which is used to perform identity resolution, uniquely identifies an entity.","pos":[1518,1604]},{"content":"By default, the client only materializes an entry in the response feed into an object for entities that are not already being tracked by the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph>.","pos":[1611,1806],"source":"By default, the client only materializes an entry in the response feed into an object for entities that are not already being tracked by the <xref:System.Data.Services.Client.DataServiceContext>."},{"content":"This means that changes to objects already in the cache are not overwritten.","pos":[1807,1883]},{"content":"This behavior is controlled by specifying a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.MergeOption&gt;</ph> value for queries and load operations.","pos":[1884,2013],"source":" This behavior is controlled by specifying a <xref:System.Data.Services.Client.MergeOption> value for queries and load operations."},{"content":"This option is specified by setting the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext.MergeOption%2A&gt;</ph> property on the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph>.","pos":[2014,2193],"source":" This option is specified by setting the <xref:System.Data.Services.Client.DataServiceContext.MergeOption%2A> property on the <xref:System.Data.Services.Client.DataServiceContext>."},{"content":"The default merge option value is <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.MergeOption.AppendOnly&gt;</ph>.","pos":[2194,2286],"source":" The default merge option value is <xref:System.Data.Services.Client.MergeOption.AppendOnly>."},{"content":"This only materializes objects for entities that are not already being tracked, which means that existing objects are not overwritten.","pos":[2287,2421]},{"content":"Another way to prevent changes to objects on the client from being overwritten by updates from the data service is to specify <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.MergeOption.PreserveChanges&gt;</ph>.","pos":[2422,2611],"source":" Another way to prevent changes to objects on the client from being overwritten by updates from the data service is to specify <xref:System.Data.Services.Client.MergeOption.PreserveChanges>."},{"content":"When you specify <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.MergeOption.OverwriteChanges&gt;</ph>, values of objects on the client are replaced by the latest values from the entries in the response feed, even if changes have already been made to these objects.","pos":[2612,2855],"source":" When you specify <xref:System.Data.Services.Client.MergeOption.OverwriteChanges>, values of objects on the client are replaced by the latest values from the entries in the response feed, even if changes have already been made to these objects."},{"content":"When a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.MergeOption.NoTracking&gt;</ph> merge option is used, the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph> cannot send changes made on client objects to the data service.","pos":[2856,3064],"source":" When a <xref:System.Data.Services.Client.MergeOption.NoTracking> merge option is used, the <xref:System.Data.Services.Client.DataServiceContext> cannot send changes made on client objects to the data service."},{"content":"With this option, changes are always overwritten with values from the data service.","pos":[3065,3148]},{"pos":[3157,3177],"content":"Managing Concurrency","linkify":"Managing Concurrency","nodes":[{"content":"Managing Concurrency","pos":[0,20]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> supports optimistic concurrency that enables the data service to detect update conflicts.","pos":[3181,3336],"source":"[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] supports optimistic concurrency that enables the data service to detect update conflicts."},{"content":"The data service provider can be configured in such a way that the data service checks for changes to entities by using a concurrency token.","pos":[3337,3477]},{"content":"This token includes one or more properties of an entity type that are validated by the data service to determine whether a resource has changed.","pos":[3478,3622]},{"content":"Concurrency tokens, which are included in the eTag header of requests to and responses from the data service, are managed for you by the <ph id=\"ph1\">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]</ph> client.","pos":[3623,3827],"source":" Concurrency tokens, which are included in the eTag header of requests to and responses from the data service, are managed for you by the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Updating the Data Service<ept id=\"p1\">](../../../../docs/framework/data/wcf/updating-the-data-service-wcf-data-services.md)</ept>.","pos":[3828,3966],"source":" For more information, see [Updating the Data Service](../../../../docs/framework/data/wcf/updating-the-data-service-wcf-data-services.md)."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph> tracks changes made to objects that have been reported manually by using <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceContext.AddObject%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A&gt;</ph>, or by a <ph id=\"ph5\">&lt;xref:System.Data.Services.Client.DataServiceCollection%601&gt;</ph>.","pos":[3973,4387],"source":"The <xref:System.Data.Services.Client.DataServiceContext> tracks changes made to objects that have been reported manually by using <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A>, <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A>, and <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A>, or by a <xref:System.Data.Services.Client.DataServiceCollection%601>."},{"content":"When the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A&gt;</ph> method is called, the client sends changes back to the data service.","pos":[4388,4534],"source":" When the <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> method is called, the client sends changes back to the data service."},{"content":"<ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A&gt;</ph> can fail when data changes in the client conflict with changes in the data service.","pos":[4535,4687],"source":"<xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> can fail when data changes in the client conflict with changes in the data service."},{"content":"When this occurs, you must query for the entity resource again to receive the update data.","pos":[4688,4778]},{"content":"To overwrite changes in the data service, execute the query using the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.MergeOption.PreserveChanges&gt;</ph> merge option.","pos":[4779,4925],"source":" To overwrite changes in the data service, execute the query using the <xref:System.Data.Services.Client.MergeOption.PreserveChanges> merge option."},{"content":"When you call <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A&gt;</ph> again, the changes preserved on the client are persisted to the data service, as long as other changes have not already been made to the resource in the data service.","pos":[4926,5175],"source":" When you call <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> again, the changes preserved on the client are persisted to the data service, as long as other changes have not already been made to the resource in the data service."},{"pos":[5184,5198],"content":"Saving Changes","linkify":"Saving Changes","nodes":[{"content":"Saving Changes","pos":[0,14]}]},{"content":"Changes are tracked in the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph> instance but not sent to the server immediately.","pos":[5202,5331],"source":"Changes are tracked in the <xref:System.Data.Services.Client.DataServiceContext> instance but not sent to the server immediately."},{"content":"After you are finished with the required changes for a specified activity, call <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A&gt;</ph> to submit all the changes to the data service.","pos":[5332,5527],"source":" After you are finished with the required changes for a specified activity, call <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> to submit all the changes to the data service."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceResponse&gt;</ph> object is returned after the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A&gt;</ph> operation is complete.","pos":[5528,5705],"source":" A <xref:System.Data.Services.Client.DataServiceResponse> object is returned after the <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> operation is complete."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceResponse&gt;</ph> object includes a sequence of <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.OperationResponse&gt;</ph> objects that, in turn, contain a sequence of <ph id=\"ph3\">&lt;xref:System.Data.Services.Client.EntityDescriptor&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Data.Services.Client.LinkDescriptor&gt;</ph> instances that represent the changes persisted or attempted.","pos":[5706,6058],"source":" The <xref:System.Data.Services.Client.DataServiceResponse> object includes a sequence of <xref:System.Data.Services.Client.OperationResponse> objects that, in turn, contain a sequence of <xref:System.Data.Services.Client.EntityDescriptor> or <xref:System.Data.Services.Client.LinkDescriptor> instances that represent the changes persisted or attempted."},{"content":"When an entity is created or modified in the data service, the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.EntityDescriptor&gt;</ph> includes a reference to the updated entity, including any server-generated property values, such as the generated <ph id=\"ph2\">`ProductID`</ph> value in the previous example.","pos":[6059,6330],"source":" When an entity is created or modified in the data service, the <xref:System.Data.Services.Client.EntityDescriptor> includes a reference to the updated entity, including any server-generated property values, such as the generated `ProductID` value in the previous example."},{"content":"The client library automatically updates the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> object to have these new values.","pos":[6331,6472],"source":" The client library automatically updates the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] object to have these new values."},{"content":"For successful insert and update operations, the state property of the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.EntityDescriptor&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.LinkDescriptor&gt;</ph> object associated with the operation is set to <ph id=\"ph3\">&lt;xref:System.Data.Services.Client.EntityStates.Unchanged&gt;</ph> and the new values are merged by using <ph id=\"ph4\">&lt;xref:System.Data.Services.Client.MergeOption.OverwriteChanges&gt;</ph>.","pos":[6479,6863],"source":"For successful insert and update operations, the state property of the <xref:System.Data.Services.Client.EntityDescriptor> or <xref:System.Data.Services.Client.LinkDescriptor> object associated with the operation is set to <xref:System.Data.Services.Client.EntityStates.Unchanged> and the new values are merged by using <xref:System.Data.Services.Client.MergeOption.OverwriteChanges>."},{"content":"When an insert, update, or delete operation fails in the data service, the entity state remains the same as it was before <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A&gt;</ph> was called, and the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.OperationResponse.Error%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.Data.Services.Client.OperationResponse&gt;</ph> is set to an <ph id=\"ph4\">&lt;xref:System.Data.Services.Client.DataServiceRequestException&gt;</ph> that contains information about the error.","pos":[6864,7324],"source":" When an insert, update, or delete operation fails in the data service, the entity state remains the same as it was before <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> was called, and the <xref:System.Data.Services.Client.OperationResponse.Error%2A> property of the <xref:System.Data.Services.Client.OperationResponse> is set to an <xref:System.Data.Services.Client.DataServiceRequestException> that contains information about the error."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Updating the Data Service<ept id=\"p1\">](../../../../docs/framework/data/wcf/updating-the-data-service-wcf-data-services.md)</ept>.","pos":[7325,7463],"source":" For more information, see [Updating the Data Service](../../../../docs/framework/data/wcf/updating-the-data-service-wcf-data-services.md)."},{"pos":[7473,7508],"content":"Setting the HTTP Method for Updates","linkify":"Setting the HTTP Method for Updates","nodes":[{"content":"Setting the HTTP Method for Updates","pos":[0,35]}]},{"content":"By default, the .NET Framework client library sends updates to existing entities as MERGE requests.","pos":[7512,7611]},{"content":"A MERGE request updates selected properties of the entity; however the client always includes all properties in the MERGE request, even properties that have not changed.","pos":[7612,7781]},{"content":"The <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> protocol also supports sending PUT requests to update entities.","pos":[7782,7915],"source":" The [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protocol also supports sending PUT requests to update entities."},{"content":"In a PUT request, an existing entity is essentially replaced with a new instance of the entity with property values from the client.","pos":[7916,8048]},{"content":"To use PUT requests, set the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.SaveChangesOptions.ReplaceOnUpdate&gt;</ph> flag on the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.SaveChangesOptions&gt;</ph> enumeration when calling <ph id=\"ph3\">&lt;xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A&gt;</ph>.","pos":[8049,8308],"source":" To use PUT requests, set the <xref:System.Data.Services.Client.SaveChangesOptions.ReplaceOnUpdate> flag on the <xref:System.Data.Services.Client.SaveChangesOptions> enumeration when calling <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A>."},{"pos":[8316,8952],"content":"[!NOTE]\n A PUT request will behave differently than a MERGE request when the client does not know about all properties of the entity. This might occur when projecting an entity type into a new type on the client. It might also occur when new properties have been added to the entity in the service data model and the <xref:System.Data.Services.Client.DataServiceContext.IgnoreMissingProperties%2A> property on the <xref:System.Data.Services.Client.DataServiceContext> is set to `true` to ignore such client mapping errors. In these cases, a PUT request will reset any properties that are unknown to the client to their default values.","leadings":["","> "],"nodes":[{"content":"A PUT request will behave differently than a MERGE request when the client does not know about all properties of the entity. This might occur when projecting an entity type into a new type on the client. It might also occur when new properties have been added to the entity in the service data model and the <xref:System.Data.Services.Client.DataServiceContext.IgnoreMissingProperties%2A> property on the <xref:System.Data.Services.Client.DataServiceContext> is set to `true` to ignore such client mapping errors. In these cases, a PUT request will reset any properties that are unknown to the client to their default values.","pos":[9,634],"nodes":[{"content":"A PUT request will behave differently than a MERGE request when the client does not know about all properties of the entity.","pos":[0,124]},{"content":"This might occur when projecting an entity type into a new type on the client.","pos":[125,203]},{"content":"It might also occur when new properties have been added to the entity in the service data model and the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext.IgnoreMissingProperties%2A&gt;</ph> property on the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph> is set to <ph id=\"ph3\">`true`</ph> to ignore such client mapping errors.","pos":[204,513],"source":" It might also occur when new properties have been added to the entity in the service data model and the <xref:System.Data.Services.Client.DataServiceContext.IgnoreMissingProperties%2A> property on the <xref:System.Data.Services.Client.DataServiceContext> is set to `true` to ignore such client mapping errors."},{"content":"In these cases, a PUT request will reset any properties that are unknown to the client to their default values.","pos":[514,625]}]}]},{"pos":[8962,8976],"content":"POST Tunneling","linkify":"POST Tunneling","nodes":[{"content":"POST Tunneling","pos":[0,14]}]},{"content":"By default, the client library sends create, read, update, and delete requests to an <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> service by using the corresponding HTTP methods of POST, GET, PUT/MERGE/PATCH, and DELETE.","pos":[8980,9221],"source":"By default, the client library sends create, read, update, and delete requests to an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service by using the corresponding HTTP methods of POST, GET, PUT/MERGE/PATCH, and DELETE."},{"content":"This upholds the basic principles of Representational State Transfer (REST).","pos":[9222,9298]},{"content":"However, not every Web server implementation supports the full set of HTTP methods.","pos":[9299,9382]},{"content":"In some cases, the supported methods might be restricted to just GET and POST.","pos":[9383,9461]},{"content":"This can happen when an intermediary, like a firewall, blocks requests with certain methods.","pos":[9462,9554]},{"content":"Because the GET and POST methods are most often supported, <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> prescribes a way to execute any unsupported HTTP methods by using a POST request.","pos":[9555,9761],"source":" Because the GET and POST methods are most often supported, [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] prescribes a way to execute any unsupported HTTP methods by using a POST request."},{"content":"Known as <bpt id=\"p1\">*</bpt>method tunneling<ept id=\"p1\">*</ept> or <bpt id=\"p2\">*</bpt>POST tunneling<ept id=\"p2\">*</ept>, this enables a client to send a POST request with the actual method specified in the custom <ph id=\"ph1\">`X-HTTP-Method`</ph> header.","pos":[9762,9926],"source":" Known as *method tunneling* or *POST tunneling*, this enables a client to send a POST request with the actual method specified in the custom `X-HTTP-Method` header."},{"content":"To enable POST tunneling for requests, set the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext.UsePostTunneling%2A&gt;</ph> property on the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph> instance to <ph id=\"ph3\">`true`</ph>.","pos":[9927,10137],"source":" To enable POST tunneling for requests, set the <xref:System.Data.Services.Client.DataServiceContext.UsePostTunneling%2A> property on the <xref:System.Data.Services.Client.DataServiceContext> instance to `true`."},{"pos":[10146,10154],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[10158,10265],"content":"<bpt id=\"p1\">[</bpt>WCF Data Services Client Library<ept id=\"p1\">](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)</ept>","source":"[WCF Data Services Client Library](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)"},{"pos":[10268,10379],"content":"<bpt id=\"p1\">[</bpt>Updating the Data Service<ept id=\"p1\">](../../../../docs/framework/data/wcf/updating-the-data-service-wcf-data-services.md)</ept>","source":"[Updating the Data Service](../../../../docs/framework/data/wcf/updating-the-data-service-wcf-data-services.md)"},{"pos":[10382,10489],"content":"<bpt id=\"p1\">[</bpt>Asynchronous Operations<ept id=\"p1\">](../../../../docs/framework/data/wcf/asynchronous-operations-wcf-data-services.md)</ept>","source":"[Asynchronous Operations](../../../../docs/framework/data/wcf/asynchronous-operations-wcf-data-services.md)"},{"pos":[10492,10591],"content":"<bpt id=\"p1\">[</bpt>Batching Operations<ept id=\"p1\">](../../../../docs/framework/data/wcf/batching-operations-wcf-data-services.md)</ept>","source":"[Batching Operations](../../../../docs/framework/data/wcf/batching-operations-wcf-data-services.md)"}]}