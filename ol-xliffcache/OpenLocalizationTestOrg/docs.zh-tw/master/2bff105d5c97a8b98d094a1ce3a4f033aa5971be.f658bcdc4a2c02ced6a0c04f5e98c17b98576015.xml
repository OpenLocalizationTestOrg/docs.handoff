{"content":"---\ntitle: \"How to: Choose Folders with the Windows Forms FolderBrowserDialog Component\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"directories [Windows Forms], choosing\"\n  - \"FolderBrowserDialog component [Windows Forms], choosing directories\"\n  - \"folders [Windows Forms], selecting\"\n  - \"folders [Windows Forms], choosing\"\n  - \"directories [Windows Forms], selecting\"\nms.assetid: 4593670e-7c7d-4661-b46b-4ffb63258adb\n---\n# How to: Choose Folders with the Windows Forms FolderBrowserDialog Component\nOften, within Windows applications you create, you will have to prompt users to select a folder, most frequently to save a set of files. The Windows Forms <xref:System.Windows.Forms.FolderBrowserDialog> component allows you to easily accomplish this task.  \n  \n### To choose folders with the FolderBrowserDialog component  \n  \n1.  In a procedure, check the <xref:System.Windows.Forms.FolderBrowserDialog> component's <xref:System.Windows.Forms.Form.DialogResult%2A> property to see how the dialog box was closed and get the value of the <xref:System.Windows.Forms.FolderBrowserDialog> component's <xref:System.Windows.Forms.FolderBrowserDialog.SelectedPath%2A> property.  \n  \n2.  If you need to set the top-most folder that will appear within the tree view of the dialog box, set the <xref:System.Windows.Forms.FolderBrowserDialog.RootFolder%2A> property, which takes a member of the <xref:System.Environment.SpecialFolder> enumeration.  \n  \n3.  Additionally, you can set the <xref:System.Windows.Forms.FolderBrowserDialog.Description%2A> property, which specifies the text string that appears at the top of the folder-browser tree view.  \n  \n     In the example below, the <xref:System.Windows.Forms.FolderBrowserDialog> component is used to select a folder, similar to when you create a project in Visual Studio and are prompted to select a folder to save it in. In this example, the folder name is then displayed in a <xref:System.Windows.Forms.TextBox> control on the form. It is a good idea to place the location in an editable area, such as a <xref:System.Windows.Forms.TextBox> control, so that users may edit their selection in case of error or other issues. This example assumes a form with a <xref:System.Windows.Forms.FolderBrowserDialog> component and a <xref:System.Windows.Forms.TextBox> control.  \n  \n    ```vb  \n    Public Sub ChooseFolder()  \n        If FolderBrowserDialog1.ShowDialog() = DialogResult.OK Then  \n            TextBox1.Text = FolderBrowserDialog1.SelectedPath  \n        End If  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    public void ChooseFolder()  \n    {  \n        if (folderBrowserDialog1.ShowDialog() == DialogResult.OK)   \n        {  \n            textBox1.Text = folderBrowserDialog1.SelectedPath;  \n        }  \n    }  \n    ```  \n  \n    ```cpp  \n    public:  \n       void ChooseFolder()  \n       {  \n          if (folderBrowserDialog1->ShowDialog() == DialogResult::OK)  \n          {  \n             textBox1->Text = folderBrowserDialog1->SelectedPath;  \n          }  \n       }  \n    ```  \n  \n    > [!IMPORTANT]\n    >  To use this class, your assembly requires a privilege level granted by the <xref:System.Security.Permissions.FileIOPermissionAttribute.PathDiscovery%2A> property, which is part of the <xref:System.Security.Permissions.FileIOPermissionAccess> enumeration. If you are running in a partial-trust context, the process might throw an exception because of insufficient privileges. For more information, see [Code Access Security Basics](../../misc/code-access-security-basics.md).  \n  \n For information on how to save files, see [How to: Save Files Using the SaveFileDialog Component](how-to-save-files-using-the-savefiledialog-component.md).  \n  \n## See also\n\n- <xref:System.Windows.Forms.FolderBrowserDialog>\n- [FolderBrowserDialog Component Overview (Windows Forms)](folderbrowserdialog-component-overview-windows-forms.md)\n- [FolderBrowserDialog Component](folderbrowserdialog-component-windows-forms.md)\n","nodes":[{"pos":[4,469],"embed":true,"restype":"x-metadata","content":"title: \"How to: Choose Folders with the Windows Forms FolderBrowserDialog Component\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"directories [Windows Forms], choosing\"\n  - \"FolderBrowserDialog component [Windows Forms], choosing directories\"\n  - \"folders [Windows Forms], selecting\"\n  - \"folders [Windows Forms], choosing\"\n  - \"directories [Windows Forms], selecting\"\nms.assetid: 4593670e-7c7d-4661-b46b-4ffb63258adb","nodes":[{"content":"How to: Choose Folders with the Windows Forms FolderBrowserDialog Component","nodes":[{"pos":[0,75],"content":"How to: Choose Folders with the Windows Forms FolderBrowserDialog Component","nodes":[{"content":"How to: Choose Folders with the Windows Forms FolderBrowserDialog Component","pos":[0,75]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[476,551],"content":"How to: Choose Folders with the Windows Forms FolderBrowserDialog Component","linkify":"How to: Choose Folders with the Windows Forms FolderBrowserDialog Component","nodes":[{"content":"How to: Choose Folders with the Windows Forms FolderBrowserDialog Component","pos":[0,75]}]},{"content":"Often, within Windows applications you create, you will have to prompt users to select a folder, most frequently to save a set of files.","pos":[552,688]},{"content":"The Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.FolderBrowserDialog&gt;</ph> component allows you to easily accomplish this task.","pos":[689,807],"source":" The Windows Forms <xref:System.Windows.Forms.FolderBrowserDialog> component allows you to easily accomplish this task."},{"pos":[817,873],"content":"To choose folders with the FolderBrowserDialog component","linkify":"To choose folders with the FolderBrowserDialog component","nodes":[{"content":"To choose folders with the FolderBrowserDialog component","pos":[0,56]}]},{"pos":[883,1222],"content":"In a procedure, check the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.FolderBrowserDialog&gt;</ph> component's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Form.DialogResult%2A&gt;</ph> property to see how the dialog box was closed and get the value of the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.FolderBrowserDialog&gt;</ph> component's <ph id=\"ph4\">&lt;xref:System.Windows.Forms.FolderBrowserDialog.SelectedPath%2A&gt;</ph> property.","source":"In a procedure, check the <xref:System.Windows.Forms.FolderBrowserDialog> component's <xref:System.Windows.Forms.Form.DialogResult%2A> property to see how the dialog box was closed and get the value of the <xref:System.Windows.Forms.FolderBrowserDialog> component's <xref:System.Windows.Forms.FolderBrowserDialog.SelectedPath%2A> property."},{"pos":[1232,1488],"content":"If you need to set the top-most folder that will appear within the tree view of the dialog box, set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.FolderBrowserDialog.RootFolder%2A&gt;</ph> property, which takes a member of the <ph id=\"ph2\">&lt;xref:System.Environment.SpecialFolder&gt;</ph> enumeration.","source":"If you need to set the top-most folder that will appear within the tree view of the dialog box, set the <xref:System.Windows.Forms.FolderBrowserDialog.RootFolder%2A> property, which takes a member of the <xref:System.Environment.SpecialFolder> enumeration."},{"pos":[1498,1689],"content":"Additionally, you can set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.FolderBrowserDialog.Description%2A&gt;</ph> property, which specifies the text string that appears at the top of the folder-browser tree view.","source":"Additionally, you can set the <xref:System.Windows.Forms.FolderBrowserDialog.Description%2A> property, which specifies the text string that appears at the top of the folder-browser tree view."},{"content":"In the example below, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.FolderBrowserDialog&gt;</ph> component is used to select a folder, similar to when you create a project in Visual Studio and are prompted to select a folder to save it in.","pos":[1700,1916],"source":"In the example below, the <xref:System.Windows.Forms.FolderBrowserDialog> component is used to select a folder, similar to when you create a project in Visual Studio and are prompted to select a folder to save it in."},{"content":"In this example, the folder name is then displayed in a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph> control on the form.","pos":[1917,2029],"source":" In this example, the folder name is then displayed in a <xref:System.Windows.Forms.TextBox> control on the form."},{"content":"It is a good idea to place the location in an editable area, such as a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph> control, so that users may edit their selection in case of error or other issues.","pos":[2030,2218],"source":" It is a good idea to place the location in an editable area, such as a <xref:System.Windows.Forms.TextBox> control, so that users may edit their selection in case of error or other issues."},{"content":"This example assumes a form with a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.FolderBrowserDialog&gt;</ph> component and a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph> control.","pos":[2219,2362],"source":" This example assumes a form with a <xref:System.Windows.Forms.FolderBrowserDialog> component and a <xref:System.Windows.Forms.TextBox> control."},{"pos":[3091,3585],"content":"[!IMPORTANT]\nTo use this class, your assembly requires a privilege level granted by the <xref:System.Security.Permissions.FileIOPermissionAttribute.PathDiscovery%2A> property, which is part of the <xref:System.Security.Permissions.FileIOPermissionAccess> enumeration. If you are running in a partial-trust context, the process might throw an exception because of insufficient privileges. For more information, see [Code Access Security Basics](../../misc/code-access-security-basics.md).","leadings":["","    >  "],"nodes":[{"content":"To use this class, your assembly requires a privilege level granted by the <xref:System.Security.Permissions.FileIOPermissionAttribute.PathDiscovery%2A> property, which is part of the <xref:System.Security.Permissions.FileIOPermissionAccess> enumeration. If you are running in a partial-trust context, the process might throw an exception because of insufficient privileges. For more information, see [Code Access Security Basics](../../misc/code-access-security-basics.md).","pos":[13,487],"nodes":[{"content":"To use this class, your assembly requires a privilege level granted by the <ph id=\"ph1\">&lt;xref:System.Security.Permissions.FileIOPermissionAttribute.PathDiscovery%2A&gt;</ph> property, which is part of the <ph id=\"ph2\">&lt;xref:System.Security.Permissions.FileIOPermissionAccess&gt;</ph> enumeration.","pos":[0,254],"source":"To use this class, your assembly requires a privilege level granted by the <xref:System.Security.Permissions.FileIOPermissionAttribute.PathDiscovery%2A> property, which is part of the <xref:System.Security.Permissions.FileIOPermissionAccess> enumeration."},{"content":"If you are running in a partial-trust context, the process might throw an exception because of insufficient privileges.","pos":[255,374]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Access Security Basics<ept id=\"p1\">](../../misc/code-access-security-basics.md)</ept>.","pos":[375,474],"source":" For more information, see [Code Access Security Basics](../../misc/code-access-security-basics.md)."}]}]},{"pos":[3592,3747],"content":"For information on how to save files, see <bpt id=\"p1\">[</bpt>How to: Save Files Using the SaveFileDialog Component<ept id=\"p1\">](how-to-save-files-using-the-savefiledialog-component.md)</ept>.","source":"For information on how to save files, see [How to: Save Files Using the SaveFileDialog Component](how-to-save-files-using-the-savefiledialog-component.md)."},{"pos":[3756,3764],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3818,3931],"content":"<bpt id=\"p1\">[</bpt>FolderBrowserDialog Component Overview (Windows Forms)<ept id=\"p1\">](folderbrowserdialog-component-overview-windows-forms.md)</ept>","source":"[FolderBrowserDialog Component Overview (Windows Forms)](folderbrowserdialog-component-overview-windows-forms.md)"},{"pos":[3934,4013],"content":"<bpt id=\"p1\">[</bpt>FolderBrowserDialog Component<ept id=\"p1\">](folderbrowserdialog-component-windows-forms.md)</ept>","source":"[FolderBrowserDialog Component](folderbrowserdialog-component-windows-forms.md)"}]}