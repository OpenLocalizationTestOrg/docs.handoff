{"content":"---\ntitle: \"Overview of LINQ to XML in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"LINQ to XML [Visual Basic], about LINQ to XML\"\n  - \"LINQ [Visual Basic], LINQ to XML\"\nms.assetid: 01c62a79-6d58-468e-84fb-039c05947701\n---\n# Overview of LINQ to XML in Visual Basic\nVisual Basic provides support for [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] through XML literals and XML axis properties. This enables you to use a familiar, convenient syntax for working with XML in your Visual Basic code. *XML literals* enable you to include XML directly in your code. *XML axis properties* enable you to access child nodes, descendant nodes, and attributes of an XML literal. For more information, see [XML Literals Overview](../../../../visual-basic/programming-guide/language-features/xml/xml-literals-overview.md) and [Accessing XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/accessing-xml.md).  \n  \n [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is an in-memory XML programming API designed specifically to take advantage of [!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)]. Although you can call the [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] APIs directly, only Visual Basic enables you to declare XML literals and directly access XML axis properties.  \n  \n> [!NOTE]\n>  XML literals and XML axis properties are not supported in declarative code in an ASP.NET page. To use Visual Basic XML features, put your code in a code-behind page in your ASP.NET application.  \n  \n ![link to video](../../../../visual-basic/programming-guide/language-features/xml/media/playvideo.gif \"PlayVideo\") For related video demonstrations, see [How Do I Get Started with LINQ to XML?](/aspnet/web-forms/videos/data-access/linq-videos-from-the-vb-team/how-do-i-get-started-with-linq-to-xml) and [How Do I Create Excel Spreadsheets using LINQ to XML?](/aspnet/web-forms/videos/data-access/linq-videos-from-the-vb-team/how-do-i-create-excel-spreadsheets-using-linq-to-xml).  \n  \n## Creating XML  \n There are two ways to create XML trees in Visual Basic. You can declare an XML literal directly in code, or you can use the [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] APIs to create the tree. Both processes enable the code to reflect the final structure of the XML tree. For example, the following code example creates an XML element:  \n  \n [!code-vb[VbXmlSamples#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbXMLSamples/VB/XMLSamples2.vb#5)]  \n  \n For more information, see [Creating XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/creating-xml.md).  \n  \n## Accessing and Navigating XML  \n Visual Basic provides XML axis properties for accessing and navigating XML structures. These properties enable you to access XML elements and attributes by specifying the XML child element names. Alternatively, you can explicitly call the [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] methods for navigating and locating elements and attributes. For example, the following code example uses XML axis properties to refer to the attributes and child elements of an XML element. The code example uses a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query to retrieve child elements and output them as XML elements, effectively performing a transform.  \n  \n [!code-vb[VbXmlSamples#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbXMLSamples/VB/XMLSamples3.vb#8)]  \n  \n For more information, see [Accessing XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/accessing-xml.md).  \n  \n## XML Namespaces  \n Visual Basic enables you to specify an alias to a global XML namespace by using the `Imports` statement. The following example shows how to use the `Imports` statement to import an XML namespace:  \n  \n [!code-vb[VbXMLSamples#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbXMLSamples/VB/XMLSamples1.vb#1)]  \n  \n You can use an XML namespace alias when you access XML axis properties and declare XML literals for XML documents and elements.  \n  \n You can retrieve an <xref:System.Xml.Linq.XNamespace> object for a particular namespace prefix by using the [GetXmlNamespace Operator](../../../../visual-basic/language-reference/operators/getxmlnamespace-operator.md).  \n  \n For more information, see [Imports Statement (XML Namespace)](../../../../visual-basic/language-reference/statements/imports-statement-xml-namespace.md).  \n  \n### Using XML Namespaces in XML Literals  \n The following example shows how to create an <xref:System.Xml.Linq.XElement> object that uses the global namespace `ns`:  \n  \n [!code-vb[VbXMLSamples#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbXMLSamples/VB/XMLSamples1.vb#2)]  \n  \n The Visual Basic compiler translates XML literals that contain XML namespace aliases into equivalent code that uses the XML notation for using XML namespaces, with the `xmlns` attribute. When compiled, the code in the previous section's example produces essentially the same executable code as the following example:  \n  \n [!code-vb[VbXMLSamples#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbXMLSamples/VB/XMLSamples1.vb#3)]  \n  \n### Using XML Namespaces in XML Axis Properties  \n XML namespaces declared in XML literals are not available for use in XML axis properties. However, global namespaces can be used with the XML axis properties. Use a colon to separate the XML namespace prefix from the local element name. Following is an example:  \n  \n [!code-vb[VbXMLSamples#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbXMLSamples/VB/XMLSamples1.vb#4)]  \n  \n## See also\n\n- [XML](../../../../visual-basic/programming-guide/language-features/xml/index.md)\n- [Creating XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/creating-xml.md)\n- [Accessing XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/accessing-xml.md)\n- [Manipulating XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/manipulating-xml.md)\n","nodes":[{"pos":[4,234],"embed":true,"restype":"x-metadata","content":"title: \"Overview of LINQ to XML in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"LINQ to XML [Visual Basic], about LINQ to XML\"\n  - \"LINQ [Visual Basic], LINQ to XML\"\nms.assetid: 01c62a79-6d58-468e-84fb-039c05947701","nodes":[{"content":"Overview of LINQ to XML in Visual Basic","nodes":[{"pos":[0,39],"content":"Overview of LINQ to XML in Visual Basic","nodes":[{"content":"Overview of LINQ to XML in Visual Basic","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[241,280],"content":"Overview of LINQ to XML in Visual Basic","linkify":"Overview of LINQ to XML in Visual Basic","nodes":[{"content":"Overview of LINQ to XML in Visual Basic","pos":[0,39]}]},{"content":"Visual Basic provides support for <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> through XML literals and XML axis properties.","pos":[281,414],"source":"Visual Basic provides support for [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] through XML literals and XML axis properties."},{"content":"This enables you to use a familiar, convenient syntax for working with XML in your Visual Basic code.","pos":[415,516]},{"content":"<bpt id=\"p1\">*</bpt>XML literals<ept id=\"p1\">*</ept> enable you to include XML directly in your code.","pos":[517,580],"source":"*XML literals* enable you to include XML directly in your code."},{"content":"<bpt id=\"p1\">*</bpt>XML axis properties<ept id=\"p1\">*</ept> enable you to access child nodes, descendant nodes, and attributes of an XML literal.","pos":[581,688],"source":"*XML axis properties* enable you to access child nodes, descendant nodes, and attributes of an XML literal."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>XML Literals Overview<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/xml-literals-overview.md)</ept> and <bpt id=\"p2\">[</bpt>Accessing XML in Visual Basic<ept id=\"p2\">](../../../../visual-basic/programming-guide/language-features/xml/accessing-xml.md)</ept>.","pos":[689,949],"source":" For more information, see [XML Literals Overview](../../../../visual-basic/programming-guide/language-features/xml/xml-literals-overview.md) and [Accessing XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/accessing-xml.md)."},{"content":"<ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> is an in-memory XML programming API designed specifically to take advantage of <ph id=\"ph2\">[!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)]</ph>.","pos":[956,1145],"source":"[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is an in-memory XML programming API designed specifically to take advantage of [!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)]."},{"content":"Although you can call the <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> APIs directly, only Visual Basic enables you to declare XML literals and directly access XML axis properties.","pos":[1146,1331],"source":" Although you can call the [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] APIs directly, only Visual Basic enables you to declare XML literals and directly access XML axis properties."},{"pos":[1339,1543],"content":"[!NOTE]\n XML literals and XML axis properties are not supported in declarative code in an ASP.NET page. To use Visual Basic XML features, put your code in a code-behind page in your ASP.NET application.","leadings":["","> "],"nodes":[{"content":"XML literals and XML axis properties are not supported in declarative code in an ASP.NET page. To use Visual Basic XML features, put your code in a code-behind page in your ASP.NET application.","pos":[9,202],"nodes":[{"content":"XML literals and XML axis properties are not supported in declarative code in an ASP.NET page.","pos":[0,94]},{"content":"To use Visual Basic XML features, put your code in a code-behind page in your ASP.NET application.","pos":[95,193]}]}]},{"pos":[1550,2029],"content":"<bpt id=\"p1\">![</bpt>link to video<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../visual-basic/programming-guide/language-features/xml/media/playvideo.gif \"</bpt>PlayVideo<ept id=\"p2\">\")</ept> For related video demonstrations, see <bpt id=\"p3\">[</bpt>How Do I Get Started with LINQ to XML?<ept id=\"p3\">](/aspnet/web-forms/videos/data-access/linq-videos-from-the-vb-team/how-do-i-get-started-with-linq-to-xml)</ept> and <bpt id=\"p4\">[</bpt>How Do I Create Excel Spreadsheets using LINQ to XML?<ept id=\"p4\">](/aspnet/web-forms/videos/data-access/linq-videos-from-the-vb-team/how-do-i-create-excel-spreadsheets-using-linq-to-xml)</ept>.","source":"![link to video](../../../../visual-basic/programming-guide/language-features/xml/media/playvideo.gif \"PlayVideo\") For related video demonstrations, see [How Do I Get Started with LINQ to XML?](/aspnet/web-forms/videos/data-access/linq-videos-from-the-vb-team/how-do-i-get-started-with-linq-to-xml) and [How Do I Create Excel Spreadsheets using LINQ to XML?](/aspnet/web-forms/videos/data-access/linq-videos-from-the-vb-team/how-do-i-create-excel-spreadsheets-using-linq-to-xml)."},{"pos":[2038,2050],"content":"Creating XML","linkify":"Creating XML","nodes":[{"content":"Creating XML","pos":[0,12]}]},{"content":"There are two ways to create XML trees in Visual Basic.","pos":[2054,2109]},{"content":"You can declare an XML literal directly in code, or you can use the <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> APIs to create the tree.","pos":[2110,2252],"source":" You can declare an XML literal directly in code, or you can use the [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] APIs to create the tree."},{"content":"Both processes enable the code to reflect the final structure of the XML tree.","pos":[2253,2331]},{"content":"For example, the following code example creates an XML element:","pos":[2332,2395]},{"pos":[2521,2660],"content":"For more information, see <bpt id=\"p1\">[</bpt>Creating XML in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/creating-xml.md)</ept>.","source":"For more information, see [Creating XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/creating-xml.md)."},{"pos":[2669,2697],"content":"Accessing and Navigating XML","linkify":"Accessing and Navigating XML","nodes":[{"content":"Accessing and Navigating XML","pos":[0,28]}]},{"content":"Visual Basic provides XML axis properties for accessing and navigating XML structures.","pos":[2701,2787]},{"content":"These properties enable you to access XML elements and attributes by specifying the XML child element names.","pos":[2788,2896]},{"content":"Alternatively, you can explicitly call the <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> methods for navigating and locating elements and attributes.","pos":[2897,3050],"source":" Alternatively, you can explicitly call the [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] methods for navigating and locating elements and attributes."},{"content":"For example, the following code example uses XML axis properties to refer to the attributes and child elements of an XML element.","pos":[3051,3180]},{"content":"The code example uses a <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> query to retrieve child elements and output them as XML elements, effectively performing a transform.","pos":[3181,3356],"source":" The code example uses a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query to retrieve child elements and output them as XML elements, effectively performing a transform."},{"pos":[3482,3623],"content":"For more information, see <bpt id=\"p1\">[</bpt>Accessing XML in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/accessing-xml.md)</ept>.","source":"For more information, see [Accessing XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/accessing-xml.md)."},{"pos":[3632,3646],"content":"XML Namespaces","linkify":"XML Namespaces","nodes":[{"content":"XML Namespaces","pos":[0,14]}]},{"content":"Visual Basic enables you to specify an alias to a global XML namespace by using the <ph id=\"ph1\">`Imports`</ph> statement.","pos":[3650,3754],"source":"Visual Basic enables you to specify an alias to a global XML namespace by using the `Imports` statement."},{"content":"The following example shows how to use the <ph id=\"ph1\">`Imports`</ph> statement to import an XML namespace:","pos":[3755,3845],"source":" The following example shows how to use the `Imports` statement to import an XML namespace:"},{"content":"You can use an XML namespace alias when you access XML axis properties and declare XML literals for XML documents and elements.","pos":[3971,4098]},{"pos":[4105,4323],"content":"You can retrieve an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XNamespace&gt;</ph> object for a particular namespace prefix by using the <bpt id=\"p1\">[</bpt>GetXmlNamespace Operator<ept id=\"p1\">](../../../../visual-basic/language-reference/operators/getxmlnamespace-operator.md)</ept>.","source":"You can retrieve an <xref:System.Xml.Linq.XNamespace> object for a particular namespace prefix by using the [GetXmlNamespace Operator](../../../../visual-basic/language-reference/operators/getxmlnamespace-operator.md)."},{"pos":[4330,4483],"content":"For more information, see <bpt id=\"p1\">[</bpt>Imports Statement (XML Namespace)<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/imports-statement-xml-namespace.md)</ept>.","source":"For more information, see [Imports Statement (XML Namespace)](../../../../visual-basic/language-reference/statements/imports-statement-xml-namespace.md)."},{"pos":[4493,4529],"content":"Using XML Namespaces in XML Literals","linkify":"Using XML Namespaces in XML Literals","nodes":[{"content":"Using XML Namespaces in XML Literals","pos":[0,36]}]},{"pos":[4533,4653],"content":"The following example shows how to create an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> object that uses the global namespace <ph id=\"ph2\">`ns`</ph>:","source":"The following example shows how to create an <xref:System.Xml.Linq.XElement> object that uses the global namespace `ns`:"},{"content":"The Visual Basic compiler translates XML literals that contain XML namespace aliases into equivalent code that uses the XML notation for using XML namespaces, with the <ph id=\"ph1\">`xmlns`</ph> attribute.","pos":[4779,4965],"source":"The Visual Basic compiler translates XML literals that contain XML namespace aliases into equivalent code that uses the XML notation for using XML namespaces, with the `xmlns` attribute."},{"content":"When compiled, the code in the previous section's example produces essentially the same executable code as the following example:","pos":[4966,5095]},{"pos":[5224,5267],"content":"Using XML Namespaces in XML Axis Properties","linkify":"Using XML Namespaces in XML Axis Properties","nodes":[{"content":"Using XML Namespaces in XML Axis Properties","pos":[0,43]}]},{"content":"XML namespaces declared in XML literals are not available for use in XML axis properties.","pos":[5271,5360]},{"content":"However, global namespaces can be used with the XML axis properties.","pos":[5361,5429]},{"content":"Use a colon to separate the XML namespace prefix from the local element name.","pos":[5430,5507]},{"content":"Following is an example:","pos":[5508,5532]},{"pos":[5660,5668],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5672,5752],"content":"<bpt id=\"p1\">[</bpt>XML<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/index.md)</ept>","source":"[XML](../../../../visual-basic/programming-guide/language-features/xml/index.md)"},{"pos":[5755,5867],"content":"<bpt id=\"p1\">[</bpt>Creating XML in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/creating-xml.md)</ept>","source":"[Creating XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/creating-xml.md)"},{"pos":[5870,5984],"content":"<bpt id=\"p1\">[</bpt>Accessing XML in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/accessing-xml.md)</ept>","source":"[Accessing XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/accessing-xml.md)"},{"pos":[5987,6107],"content":"<bpt id=\"p1\">[</bpt>Manipulating XML in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/xml/manipulating-xml.md)</ept>","source":"[Manipulating XML in Visual Basic](../../../../visual-basic/programming-guide/language-features/xml/manipulating-xml.md)"}]}