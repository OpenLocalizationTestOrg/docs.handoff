{"content":"---\ntitle: \"The Context Connection | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: e443ca86-9243-4234-a822-ed10a53a9de0\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# The Context Connection\nThe problem of internal data access is a fairly common scenario. That is, you wish to access the same server on which your common language runtime (CLR) stored procedure or function is executing. One option is to create a connection using <xref:System.Data.SqlClient.SqlConnection>, specify a connection string that points to the local server, and open the connection. This requires specifying credentials for logging in. The connection is in a different database session than the stored procedure or function, it may have different `SET` options, it is in a separate transaction, it does not see your temporary tables, and so on. If your managed stored procedure or function code is executing in the SQL Server process, it is because someone connected to that server and executed a SQL statement to invoke it. You probably want the stored procedure or function to execute in the context of that connection, along with its transaction, `SET` options, and so on. This is called the context connection.  \n  \n The context connection lets you execute Transact-SQL statements in the same context that your code was invoked in the first place. For more detailed information, see the version of SQL Server Books Online for the version of SQL Server you are using.  \n  \n **SQL Server Books Online**  \n  \n1.  [The Context Connection](http://go.microsoft.com/fwlink/?LinkId=115395)  \n  \n## See Also  \n [Creating SQL Server 2005 Objects In Managed Code](http://msdn.microsoft.com/en-us/5358a825-e19b-49aa-8214-674ce5fed1da)   \n [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)","nodes":[{"pos":[12,51],"content":"The Context Connection | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"The Context Connection | Microsoft Docs","pos":[0,39]}]},{"pos":[360,382],"content":"The Context Connection","linkify":"The Context Connection","nodes":[{"content":"The Context Connection","pos":[0,22]}]},{"content":"The problem of internal data access is a fairly common scenario.","pos":[383,447]},{"content":"That is, you wish to access the same server on which your common language runtime (CLR) stored procedure or function is executing.","pos":[448,578]},{"content":"One option is to create a connection using <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlConnection&gt;</ph>, specify a connection string that points to the local server, and open the connection.","pos":[579,751],"source":" One option is to create a connection using <xref:System.Data.SqlClient.SqlConnection>, specify a connection string that points to the local server, and open the connection."},{"content":"This requires specifying credentials for logging in.","pos":[752,804]},{"content":"The connection is in a different database session than the stored procedure or function, it may have different <ph id=\"ph1\">`SET`</ph> options, it is in a separate transaction, it does not see your temporary tables, and so on.","pos":[805,1013],"source":" The connection is in a different database session than the stored procedure or function, it may have different `SET` options, it is in a separate transaction, it does not see your temporary tables, and so on."},{"content":"If your managed stored procedure or function code is executing in the SQL Server process, it is because someone connected to that server and executed a SQL statement to invoke it.","pos":[1014,1193]},{"content":"You probably want the stored procedure or function to execute in the context of that connection, along with its transaction, <ph id=\"ph1\">`SET`</ph> options, and so on.","pos":[1194,1344],"source":" You probably want the stored procedure or function to execute in the context of that connection, along with its transaction, `SET` options, and so on."},{"content":"This is called the context connection.","pos":[1345,1383]},{"content":"The context connection lets you execute Transact-SQL statements in the same context that your code was invoked in the first place.","pos":[1390,1520]},{"content":"For more detailed information, see the version of SQL Server Books Online for the version of SQL Server you are using.","pos":[1521,1639]},{"pos":[1646,1673],"content":"<bpt id=\"p1\">**</bpt>SQL Server Books Online<ept id=\"p1\">**</ept>","source":"**SQL Server Books Online**"},{"pos":[1683,1754],"content":"<bpt id=\"p1\">[</bpt>The Context Connection<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=115395)</ept>","source":"[The Context Connection](http://go.microsoft.com/fwlink/?LinkId=115395)"},{"pos":[1763,1771],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Creating SQL Server 2005 Objects In Managed Code<ept id=\"p1\">](http://msdn.microsoft.com/en-us/5358a825-e19b-49aa-8214-674ce5fed1da)</ept><ph id=\"ph1\"> </ph>","pos":[1775,1896],"source":"[Creating SQL Server 2005 Objects In Managed Code](http://msdn.microsoft.com/en-us/5358a825-e19b-49aa-8214-674ce5fed1da) "},{"content":"<bpt id=\"p1\"> [</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=217917)</ept>","pos":[1899,2003],"source":" [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)"}]}