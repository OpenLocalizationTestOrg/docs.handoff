{"content":"---\ntitle: \"<PreferComInsteadOfManagedRemoting> Element\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"<PreferComInsteadOfManagedRemoting> element\"\n  - \"PreferComInsteadOfManagedRemoting element\"\nms.assetid: a279a42a-c415-4e79-88cf-64244ebda613\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# \\<PreferComInsteadOfManagedRemoting> Element\nSpecifies whether the runtime will use COM interop instead of remoting for all calls across application domain boundaries.  \n  \n \\<configuration>  \n\\<runtime>  \n\\<PreferComInsteadOfManagedRemoting>  \n  \n## Syntax  \n  \n```xml  \n<PreferComInsteadOfManagedRemoting enabled=\"true|false\"/>  \n```  \n  \n## Attributes and Elements  \n The following sections describe attributes, child elements, and parent elements.  \n  \n### Attributes  \n  \n|Attribute|Description|  \n|---------------|-----------------|  \n|`enabled`|Required attribute.<br /><br /> Indicates whether the runtime will use COM interop instead of remoting across application domain boundaries.|  \n  \n## enabled Attribute  \n  \n|Value|Description|  \n|-----------|-----------------|  \n|`false`|The runtime will use remoting across application domain boundaries. This is the default.|  \n|`true`|The runtime will use COM interop across application domain boundaries.|  \n  \n### Child Elements  \n None.  \n  \n### Parent Elements  \n  \n|Element|Description|  \n|-------------|-----------------|  \n|`configuration`|The root element in every configuration file used by the common language runtime and .NET Framework applications.|  \n|`runtime`|Contains information about assembly binding and garbage collection.|  \n  \n## Remarks  \n When you set the `enabled` attribute to `true`, the runtime behaves as follows:  \n  \n-   The runtime does not call [IUnknown::QueryInterface](https://go.microsoft.com/fwlink/?LinkID=144867) for an [IManagedObject](../../../../../docs/framework/unmanaged-api/hosting/imanagedobject-interface.md) interface when an [IUnknown](https://go.microsoft.com/fwlink/?LinkId=148003) interface enters the domain through a COM interface. Instead, it constructs a [Runtime Callable Wrapper](../../../../../docs/framework/interop/runtime-callable-wrapper.md) (RCW) around the object.  \n  \n-   The runtime returns E_NOINTERFACE when it receives a `QueryInterface` call for an [IManagedObject](../../../../../docs/framework/unmanaged-api/hosting/imanagedobject-interface.md) interface for any [COM Callable Wrapper](../../../../../docs/framework/interop/com-callable-wrapper.md) (CCW) that has been created in this domain.  \n  \n These two behaviors ensure that all calls over COM interfaces between managed objects across application domain boundaries use COM and COM interop instead of remoting.  \n  \n## Example  \n The following example shows how to specify that the runtime should use COM interop across isolation boundaries:  \n  \n```xml  \n<configuration>  \n  <runtime>  \n    <PreferComInsteadOfManagedRemoting enabled=\"true\"/>  \n  </runtime>  \n</configuration>  \n```  \n  \n## See also\n\n- [Runtime Settings Schema](../../../../../docs/framework/configure-apps/file-schema/runtime/index.md)\n- [Configuration File Schema](../../../../../docs/framework/configure-apps/file-schema/index.md)\n","nodes":[{"pos":[4,287],"embed":true,"restype":"x-metadata","content":"title: \"<PreferComInsteadOfManagedRemoting> Element\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"<PreferComInsteadOfManagedRemoting> element\"\n  - \"PreferComInsteadOfManagedRemoting element\"\nms.assetid: a279a42a-c415-4e79-88cf-64244ebda613\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"<PreferComInsteadOfManagedRemoting> Element","nodes":[{"pos":[0,43],"content":"<ph id=\"ph1\">&lt;PreferComInsteadOfManagedRemoting&gt;</ph> Element","source":"<PreferComInsteadOfManagedRemoting> Element"}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[294,338],"content":"\\<PreferComInsteadOfManagedRemoting> Element","linkify":"\\<PreferComInsteadOfManagedRemoting> Element","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>PreferComInsteadOfManagedRemoting&gt; Element","pos":[0,44],"source":"\\<PreferComInsteadOfManagedRemoting> Element"}]},{"content":"Specifies whether the runtime will use COM interop instead of remoting for all calls across application domain boundaries.","pos":[339,461]},{"content":"<ph id=\"ph1\">\\&lt;</ph>configuration&gt;","pos":[468,484],"source":"\\<configuration>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>runtime&gt;","pos":[487,497],"source":"\\<runtime>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>PreferComInsteadOfManagedRemoting&gt;","pos":[500,536],"source":"\\<PreferComInsteadOfManagedRemoting>"},{"pos":[545,551],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[638,661],"content":"Attributes and Elements","linkify":"Attributes and Elements","nodes":[{"content":"Attributes and Elements","pos":[0,23]}]},{"content":"The following sections describe attributes, child elements, and parent elements.","pos":[665,745]},{"pos":[755,765],"content":"Attributes","linkify":"Attributes","nodes":[{"content":"Attributes","pos":[0,10]}]},{"content":"Attribute","pos":[772,781]},{"content":"Description","pos":[782,793]},{"content":"Required attribute.","pos":[846,865]},{"content":"Indicates whether the runtime will use COM interop instead of remoting across application domain boundaries.","pos":[878,986]},{"pos":[996,1013],"content":"enabled Attribute","linkify":"enabled Attribute","nodes":[{"content":"enabled Attribute","pos":[0,17]}]},{"content":"Value","pos":[1020,1025]},{"content":"Description","pos":[1026,1037]},{"content":"The runtime will use remoting across application domain boundaries.","pos":[1084,1151]},{"content":"This is the default.","pos":[1152,1172]},{"content":"The runtime will use COM interop across application domain boundaries.","pos":[1184,1254]},{"pos":[1265,1279],"content":"Child Elements","linkify":"Child Elements","nodes":[{"content":"Child Elements","pos":[0,14]}]},{"content":"None.","pos":[1283,1288]},{"pos":[1298,1313],"content":"Parent Elements","linkify":"Parent Elements","nodes":[{"content":"Parent Elements","pos":[0,15]}]},{"content":"Element","pos":[1320,1327]},{"content":"Description","pos":[1328,1339]},{"content":"The root element in every configuration file used by the common language runtime and .NET Framework applications.","pos":[1396,1509]},{"content":"Contains information about assembly binding and garbage collection.","pos":[1524,1591]},{"pos":[1601,1608],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[1612,1691],"content":"When you set the <ph id=\"ph1\">`enabled`</ph> attribute to <ph id=\"ph2\">`true`</ph>, the runtime behaves as follows:","source":"When you set the `enabled` attribute to `true`, the runtime behaves as follows:"},{"content":"The runtime does not call <bpt id=\"p1\">[</bpt>IUnknown::QueryInterface<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=144867)</ept> for an <bpt id=\"p2\">[</bpt>IManagedObject<ept id=\"p2\">](../../../../../docs/framework/unmanaged-api/hosting/imanagedobject-interface.md)</ept> interface when an <bpt id=\"p3\">[</bpt>IUnknown<ept id=\"p3\">](https://go.microsoft.com/fwlink/?LinkId=148003)</ept> interface enters the domain through a COM interface.","pos":[1701,2036],"source":"The runtime does not call [IUnknown::QueryInterface](https://go.microsoft.com/fwlink/?LinkID=144867) for an [IManagedObject](../../../../../docs/framework/unmanaged-api/hosting/imanagedobject-interface.md) interface when an [IUnknown](https://go.microsoft.com/fwlink/?LinkId=148003) interface enters the domain through a COM interface."},{"content":"Instead, it constructs a <bpt id=\"p1\">[</bpt>Runtime Callable Wrapper<ept id=\"p1\">](../../../../../docs/framework/interop/runtime-callable-wrapper.md)</ept> (RCW) around the object.","pos":[2037,2180],"source":" Instead, it constructs a [Runtime Callable Wrapper](../../../../../docs/framework/interop/runtime-callable-wrapper.md) (RCW) around the object."},{"pos":[2190,2517],"content":"The runtime returns E_NOINTERFACE when it receives a <ph id=\"ph1\">`QueryInterface`</ph> call for an <bpt id=\"p1\">[</bpt>IManagedObject<ept id=\"p1\">](../../../../../docs/framework/unmanaged-api/hosting/imanagedobject-interface.md)</ept> interface for any <bpt id=\"p2\">[</bpt>COM Callable Wrapper<ept id=\"p2\">](../../../../../docs/framework/interop/com-callable-wrapper.md)</ept> (CCW) that has been created in this domain.","source":"The runtime returns E_NOINTERFACE when it receives a `QueryInterface` call for an [IManagedObject](../../../../../docs/framework/unmanaged-api/hosting/imanagedobject-interface.md) interface for any [COM Callable Wrapper](../../../../../docs/framework/interop/com-callable-wrapper.md) (CCW) that has been created in this domain."},{"content":"These two behaviors ensure that all calls over COM interfaces between managed objects across application domain boundaries use COM and COM interop instead of remoting.","pos":[2524,2691]},{"pos":[2700,2707],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows how to specify that the runtime should use COM interop across isolation boundaries:","pos":[2711,2822]},{"pos":[2973,2981],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2985,3085],"content":"<bpt id=\"p1\">[</bpt>Runtime Settings Schema<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/runtime/index.md)</ept>","source":"[Runtime Settings Schema](../../../../../docs/framework/configure-apps/file-schema/runtime/index.md)"},{"pos":[3088,3182],"content":"<bpt id=\"p1\">[</bpt>Configuration File Schema<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/index.md)</ept>","source":"[Configuration File Schema](../../../../../docs/framework/configure-apps/file-schema/index.md)"}]}