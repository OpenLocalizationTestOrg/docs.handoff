{"content":"---\ntitle: \"&lt;TimeSpan_LegacyFormatMode&gt; Element | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"<TimeSpan_LegacyFormatMode> element\"\n  - \"TimeSpan_LegacyFormatMode element\"\nms.assetid: 865e7207-d050-4442-b574-57ea29d5e2d6\ncaps.latest.revision: 8\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# &lt;TimeSpan_LegacyFormatMode&gt; Element\nDetermines whether the runtime preserves legacy behavior in formatting operations with <xref:System.TimeSpan?displayProperty=fullName> values.  \n  \n \\<configuration>  \n\\<runtime>  \n<TimeSpan_LegacyFormatMode>  \n  \n## Syntax  \n  \n```  \n<TimeSpan_LegacyFormatMode    \n   enabled=\"true|false\"/>  \n```  \n  \n## Attributes and Elements  \n The following sections describe attributes, child elements, and parent elements.  \n  \n### Attributes  \n  \n|Attribute|Description|  \n|---------------|-----------------|  \n|`enabled`|Required attribute.<br /><br /> Specifies whether the runtime uses legacy formatting behavior with <xref:System.TimeSpan?displayProperty=fullName> values.|  \n  \n## enabled Attribute  \n  \n|Value|Description|  \n|-----------|-----------------|  \n|`false`|The runtime does not restore legacy formatting behavior.|  \n|`true`|The runtime restores legacy formatting behavior.|  \n  \n### Child Elements  \n None.  \n  \n### Parent Elements  \n  \n|Element|Description|  \n|-------------|-----------------|  \n|`configuration`|The root element in every configuration file used by the common language runtime and .NET Framework applications.|  \n|`runtime`|Contains information about runtime initialization options.|  \n  \n## Remarks  \n Starting with the [!INCLUDE[net_v40_long](../../../../../includes/net-v40-long-md.md)], the <xref:System.TimeSpan?displayProperty=fullName> structure implements the <xref:System.IFormattable> interface and supports formatting operations with standard and custom format strings. If a parsing method encounters an unsupported format specifier or format string, it throws a <xref:System.FormatException>.  \n  \n In previous versions of the .NET Framework, the <xref:System.TimeSpan> structure did not implement <xref:System.IFormattable> and did not support format strings. However, many developers mistakenly assumed that <xref:System.TimeSpan> did support a set of format strings and used them in [composite formatting operations](../../../../../docs/standard/base-types/composite-formatting.md) with methods such as <xref:System.String.Format%2A?displayProperty=fullName>. Ordinarily, if a type implements <xref:System.IFormattable> and supports format strings, calls to formatting methods with unsupported format strings usually throw a <xref:System.FormatException>. However, because <xref:System.TimeSpan> did not implement <xref:System.IFormattable>, the runtime ignored the format string and instead called the <xref:System.TimeSpan.ToString?displayProperty=fullName> method. This means that, although the format strings had no effect on the formatting operation, their presence did not result in a <xref:System.FormatException>.  \n  \n For cases in which legacy code passes a composite formatting method and an invalid format string, and that code cannot be recompiled, you can use the `<TimeSpan_LegacyFormatMode>` element to restore the legacy <xref:System.TimeSpan> behavior. When you set the `enabled` attribute of this element to `true`, the composite formatting method results in a call to <xref:System.TimeSpan.ToString?displayProperty=fullName> rather than <xref:System.TimeSpan.ToString%28System.String%2CSystem.IFormatProvider%29?displayProperty=fullName>, and a <xref:System.FormatException> is not thrown.  \n  \n## Example  \n The following example instantiates a <xref:System.TimeSpan> object and attempts to format it with the <xref:System.String.Format%28System.String%2CSystem.Object%29?displayProperty=fullName> method by using an unsupported standard format string.  \n  \n [!code-csharp[TimeSpan.BreakingChanges#1](../../../../../samples/snippets/csharp/VS_Snippets_CLR/timespan.breakingchanges/cs/legacyformatmode1.cs#1)]\n [!code-vb[TimeSpan.BreakingChanges#1](../../../../../samples/snippets/visualbasic/VS_Snippets_CLR/timespan.breakingchanges/vb/legacyformatmode1.vb#1)]  \n  \n When you run the example on the [!INCLUDE[net_v35_short](../../../../../includes/net-v35-short-md.md)] or on an earlier version, it displays the following output:  \n  \n```  \n12:30:45  \n```  \n  \n This differs markedly from the output if you run the example on the [!INCLUDE[net_v40_long](../../../../../includes/net-v40-long-md.md)] or later version:  \n  \n```  \nInvalid Format  \n```  \n  \n However, if you add the following configuration file to the example's directory and then run the example on the [!INCLUDE[net_v40_long](../../../../../includes/net-v40-long-md.md)] or later version, the output is identical to that produced by the example when it is run on [!INCLUDE[net_v35_short](../../../../../includes/net-v35-short-md.md)].  \n  \n```  \n<?xml version =\"1.0\"?>  \n<configuration>  \n   <runtime>  \n      <TimeSpan_LegacyFormatMode enabled=\"true\"/>  \n   </runtime>  \n</configuration>  \n```  \n  \n## See Also  \n [Runtime Settings Schema](../../../../../docs/framework/configure-apps/file-schema/runtime/index.md)   \n [Configuration File Schema](../../../../../docs/framework/configure-apps/file-schema/index.md)","nodes":[{"pos":[4,527],"nodes":[{"content":"&lt;TimeSpan_LegacyFormatMode&gt; Element | Microsoft Docs","nodes":[{"pos":[0,58],"content":"&lt;TimeSpan_LegacyFormatMode&gt; Element | Microsoft Docs","nodes":[{"content":"<ph id=\"ph1\">&amp;lt;</ph>TimeSpan_LegacyFormatMode<ph id=\"ph2\">&amp;gt;</ph> Element | Microsoft Docs","pos":[0,58],"source":"&lt;TimeSpan_LegacyFormatMode&gt; Element | Microsoft Docs"}]}],"pos":[6,67],"yaml":true}],"content":"title: \"&lt;TimeSpan_LegacyFormatMode&gt; Element | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"<TimeSpan_LegacyFormatMode> element\"\n  - \"TimeSpan_LegacyFormatMode element\"\nms.assetid: 865e7207-d050-4442-b574-57ea29d5e2d6\ncaps.latest.revision: 8\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[534,575],"content":"&lt;TimeSpan_LegacyFormatMode&gt; Element","linkify":"&lt;TimeSpan_LegacyFormatMode&gt; Element","nodes":[{"content":"<ph id=\"ph1\">&amp;lt;</ph>TimeSpan_LegacyFormatMode<ph id=\"ph2\">&amp;gt;</ph> Element","pos":[0,41],"source":"&lt;TimeSpan_LegacyFormatMode&gt; Element"}]},{"content":"Determines whether the runtime preserves legacy behavior in formatting operations with <ph id=\"ph1\">&lt;xref:System.TimeSpan?displayProperty=fullName&gt;</ph> values.","pos":[576,718],"source":"Determines whether the runtime preserves legacy behavior in formatting operations with <xref:System.TimeSpan?displayProperty=fullName> values."},{"content":"<ph id=\"ph1\">\\&lt;</ph>configuration&gt;","pos":[725,741],"source":"\\<configuration>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>runtime&gt;","pos":[744,754],"source":"\\<runtime>"},{"content":"&lt;TimeSpan_LegacyFormatMode&gt;","pos":[757,784],"source":"<TimeSpan_LegacyFormatMode>"},{"pos":[793,799],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[882,905],"content":"Attributes and Elements","linkify":"Attributes and Elements","nodes":[{"content":"Attributes and Elements","pos":[0,23]}]},{"content":"The following sections describe attributes, child elements, and parent elements.","pos":[909,989]},{"pos":[999,1009],"content":"Attributes","linkify":"Attributes","nodes":[{"content":"Attributes","pos":[0,10]}]},{"content":"Attribute","pos":[1016,1025]},{"content":"Description","pos":[1026,1037]},{"content":"Required attribute.","pos":[1090,1109]},{"content":"Specifies whether the runtime uses legacy formatting behavior with <ph id=\"ph1\">&lt;xref:System.TimeSpan?displayProperty=fullName&gt;</ph> values.","pos":[1122,1244],"source":"Specifies whether the runtime uses legacy formatting behavior with <xref:System.TimeSpan?displayProperty=fullName> values."},{"pos":[1254,1271],"content":"enabled Attribute","linkify":"enabled Attribute","nodes":[{"content":"enabled Attribute","pos":[0,17]}]},{"content":"Value","pos":[1278,1283]},{"content":"Description","pos":[1284,1295]},{"content":"The runtime does not restore legacy formatting behavior.","pos":[1342,1398]},{"content":"The runtime restores legacy formatting behavior.","pos":[1410,1458]},{"pos":[1469,1483],"content":"Child Elements","linkify":"Child Elements","nodes":[{"content":"Child Elements","pos":[0,14]}]},{"content":"None.","pos":[1487,1492]},{"pos":[1502,1517],"content":"Parent Elements","linkify":"Parent Elements","nodes":[{"content":"Parent Elements","pos":[0,15]}]},{"content":"Element","pos":[1524,1531]},{"content":"Description","pos":[1532,1543]},{"content":"The root element in every configuration file used by the common language runtime and .NET Framework applications.","pos":[1600,1713]},{"content":"Contains information about runtime initialization options.","pos":[1728,1786]},{"pos":[1796,1803],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Starting with the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../../includes/net-v40-long-md.md)]</ph>, the <ph id=\"ph2\">&lt;xref:System.TimeSpan?displayProperty=fullName&gt;</ph> structure implements the <ph id=\"ph3\">&lt;xref:System.IFormattable&gt;</ph> interface and supports formatting operations with standard and custom format strings.","pos":[1807,2084],"source":"Starting with the [!INCLUDE[net_v40_long](../../../../../includes/net-v40-long-md.md)], the <xref:System.TimeSpan?displayProperty=fullName> structure implements the <xref:System.IFormattable> interface and supports formatting operations with standard and custom format strings."},{"content":"If a parsing method encounters an unsupported format specifier or format string, it throws a <ph id=\"ph1\">&lt;xref:System.FormatException&gt;</ph>.","pos":[2085,2208],"source":" If a parsing method encounters an unsupported format specifier or format string, it throws a <xref:System.FormatException>."},{"content":"In previous versions of the .NET Framework, the <ph id=\"ph1\">&lt;xref:System.TimeSpan&gt;</ph> structure did not implement <ph id=\"ph2\">&lt;xref:System.IFormattable&gt;</ph> and did not support format strings.","pos":[2215,2376],"source":"In previous versions of the .NET Framework, the <xref:System.TimeSpan> structure did not implement <xref:System.IFormattable> and did not support format strings."},{"content":"However, many developers mistakenly assumed that <ph id=\"ph1\">&lt;xref:System.TimeSpan&gt;</ph> did support a set of format strings and used them in <bpt id=\"p1\">[</bpt>composite formatting operations<ept id=\"p1\">](../../../../../docs/standard/base-types/composite-formatting.md)</ept> with methods such as <ph id=\"ph2\">&lt;xref:System.String.Format%2A?displayProperty=fullName&gt;</ph>.","pos":[2377,2678],"source":" However, many developers mistakenly assumed that <xref:System.TimeSpan> did support a set of format strings and used them in [composite formatting operations](../../../../../docs/standard/base-types/composite-formatting.md) with methods such as <xref:System.String.Format%2A?displayProperty=fullName>."},{"content":"Ordinarily, if a type implements <ph id=\"ph1\">&lt;xref:System.IFormattable&gt;</ph> and supports format strings, calls to formatting methods with unsupported format strings usually throw a <ph id=\"ph2\">&lt;xref:System.FormatException&gt;</ph>.","pos":[2679,2874],"source":" Ordinarily, if a type implements <xref:System.IFormattable> and supports format strings, calls to formatting methods with unsupported format strings usually throw a <xref:System.FormatException>."},{"content":"However, because <ph id=\"ph1\">&lt;xref:System.TimeSpan&gt;</ph> did not implement <ph id=\"ph2\">&lt;xref:System.IFormattable&gt;</ph>, the runtime ignored the format string and instead called the <ph id=\"ph3\">&lt;xref:System.TimeSpan.ToString?displayProperty=fullName&gt;</ph> method.","pos":[2875,3086],"source":" However, because <xref:System.TimeSpan> did not implement <xref:System.IFormattable>, the runtime ignored the format string and instead called the <xref:System.TimeSpan.ToString?displayProperty=fullName> method."},{"content":"This means that, although the format strings had no effect on the formatting operation, their presence did not result in a <ph id=\"ph1\">&lt;xref:System.FormatException&gt;</ph>.","pos":[3087,3240],"source":" This means that, although the format strings had no effect on the formatting operation, their presence did not result in a <xref:System.FormatException>."},{"content":"For cases in which legacy code passes a composite formatting method and an invalid format string, and that code cannot be recompiled, you can use the <ph id=\"ph1\">`&lt;TimeSpan_LegacyFormatMode&gt;`</ph> element to restore the legacy <ph id=\"ph2\">&lt;xref:System.TimeSpan&gt;</ph> behavior.","pos":[3247,3489],"source":"For cases in which legacy code passes a composite formatting method and an invalid format string, and that code cannot be recompiled, you can use the `<TimeSpan_LegacyFormatMode>` element to restore the legacy <xref:System.TimeSpan> behavior."},{"content":"When you set the <ph id=\"ph1\">`enabled`</ph> attribute of this element to <ph id=\"ph2\">`true`</ph>, the composite formatting method results in a call to <ph id=\"ph3\">&lt;xref:System.TimeSpan.ToString?displayProperty=fullName&gt;</ph> rather than <ph id=\"ph4\">&lt;xref:System.TimeSpan.ToString%28System.String%2CSystem.IFormatProvider%29?displayProperty=fullName&gt;</ph>, and a <ph id=\"ph5\">&lt;xref:System.FormatException&gt;</ph> is not thrown.","pos":[3490,3828],"source":" When you set the `enabled` attribute of this element to `true`, the composite formatting method results in a call to <xref:System.TimeSpan.ToString?displayProperty=fullName> rather than <xref:System.TimeSpan.ToString%28System.String%2CSystem.IFormatProvider%29?displayProperty=fullName>, and a <xref:System.FormatException> is not thrown."},{"pos":[3837,3844],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example instantiates a <ph id=\"ph1\">&lt;xref:System.TimeSpan&gt;</ph> object and attempts to format it with the <ph id=\"ph2\">&lt;xref:System.String.Format%28System.String%2CSystem.Object%29?displayProperty=fullName&gt;</ph> method by using an unsupported standard format string.","pos":[3848,4092],"source":"The following example instantiates a <xref:System.TimeSpan> object and attempts to format it with the <xref:System.String.Format%28System.String%2CSystem.Object%29?displayProperty=fullName> method by using an unsupported standard format string."},{"pos":[4099,4400],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>TimeSpan.BreakingChanges#1<ept id=\"p2\">](../../../../../samples/snippets/csharp/VS_Snippets_CLR/timespan.breakingchanges/cs/legacyformatmode1.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>TimeSpan.BreakingChanges#1<ept id=\"p4\">](../../../../../samples/snippets/visualbasic/VS_Snippets_CLR/timespan.breakingchanges/vb/legacyformatmode1.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[TimeSpan.BreakingChanges#1](../../../../../samples/snippets/csharp/VS_Snippets_CLR/timespan.breakingchanges/cs/legacyformatmode1.cs#1)]\n [!code-vb[TimeSpan.BreakingChanges#1](../../../../../samples/snippets/visualbasic/VS_Snippets_CLR/timespan.breakingchanges/vb/legacyformatmode1.vb#1)]"},{"pos":[4407,4569],"content":"When you run the example on the <ph id=\"ph1\">[!INCLUDE[net_v35_short](../../../../../includes/net-v35-short-md.md)]</ph> or on an earlier version, it displays the following output:","source":"When you run the example on the [!INCLUDE[net_v35_short](../../../../../includes/net-v35-short-md.md)] or on an earlier version, it displays the following output:"},{"pos":[4602,4756],"content":"This differs markedly from the output if you run the example on the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../../includes/net-v40-long-md.md)]</ph> or later version:","source":"This differs markedly from the output if you run the example on the [!INCLUDE[net_v40_long](../../../../../includes/net-v40-long-md.md)] or later version:"},{"pos":[4795,5139],"content":"However, if you add the following configuration file to the example's directory and then run the example on the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../../includes/net-v40-long-md.md)]</ph> or later version, the output is identical to that produced by the example when it is run on <ph id=\"ph2\">[!INCLUDE[net_v35_short](../../../../../includes/net-v35-short-md.md)]</ph>.","source":"However, if you add the following configuration file to the example's directory and then run the example on the [!INCLUDE[net_v40_long](../../../../../includes/net-v40-long-md.md)] or later version, the output is identical to that produced by the example when it is run on [!INCLUDE[net_v35_short](../../../../../includes/net-v35-short-md.md)]."},{"pos":[5308,5316],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Runtime Settings Schema<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/runtime/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[5320,5421],"source":"[Runtime Settings Schema](../../../../../docs/framework/configure-apps/file-schema/runtime/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>Configuration File Schema<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/index.md)</ept>","pos":[5425,5519],"source":"[Configuration File Schema](../../../../../docs/framework/configure-apps/file-schema/index.md)"}]}