{"content":"---\ntitle: \"IHostSecurityContext::Capture Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IHostSecurityContext.Capture\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostSecurityContext::Capture\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Capture method [.NET Framework hosting]\"\n  - \"IHostSecurityContext::Capture method [.NET Framework hosting]\"\nms.assetid: ae0836d0-1170-4494-bac5-d0e809df51a2\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# IHostSecurityContext::Capture Method\nGets a clone of the [IHostSecurityContext](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritycontext-interface.md) instance returned from a call to [IHostSecurityManager::GetSecurityContext](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-getsecuritycontext-method.md).  \n  \n## Syntax  \n  \n```  \nHRESULT Capture (  \n    [out] IHostSecurityContext** ppClonedContext  \n);  \n```  \n  \n#### Parameters  \n `ppClonedContext`  \n [out] A pointer to the address of a clone of the `IHostSecurityContext` object to be captured.  \n  \n## Return Value  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|`Capture` returned successfully.|  \n|HOST_E_CLRNOTAVAILABLE|The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.|  \n|HOST_E_TIMEOUT|The call timed out.|  \n|HOST_E_NOT_OWNER|The caller does not own the lock.|  \n|HOST_E_ABANDONED|An event was canceled while a blocked thread or fiber was waiting on it.|  \n|E_FAIL|An unknown catastrophic failure occurred. When a method returns E_FAIL, the CLR is no longer usable within the process. Subsequent calls to hosting methods return HOST_E_CLRNOTAVAILABLE.|  \n  \n## Remarks  \n The interface pointer returned from `Capture` is a clone of the captured context. When this information is moved across an asynchronous code point, its lifetime is separated from that of the pointer against which the call was made. The original pointer can therefore be released.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See Also  \n [IHostSecurityContext Interface](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritycontext-interface.md)   \n [IHostSecurityManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-interface.md)","nodes":[{"pos":[4,698],"embed":true,"restype":"x-metadata","content":"title: \"IHostSecurityContext::Capture Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IHostSecurityContext.Capture\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostSecurityContext::Capture\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Capture method [.NET Framework hosting]\"\n  - \"IHostSecurityContext::Capture method [.NET Framework hosting]\"\nms.assetid: ae0836d0-1170-4494-bac5-d0e809df51a2\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"IHostSecurityContext::Capture Method | Microsoft Docs","nodes":[{"pos":[0,53],"content":"IHostSecurityContext::Capture Method | Microsoft Docs","nodes":[{"content":"IHostSecurityContext::Capture Method | Microsoft Docs","pos":[0,53]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[705,741],"content":"IHostSecurityContext::Capture Method","linkify":"IHostSecurityContext::Capture Method","nodes":[{"content":"IHostSecurityContext::Capture Method","pos":[0,36]}]},{"pos":[742,1045],"content":"Gets a clone of the <bpt id=\"p1\">[</bpt>IHostSecurityContext<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritycontext-interface.md)</ept> instance returned from a call to <bpt id=\"p2\">[</bpt>IHostSecurityManager::GetSecurityContext<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-getsecuritycontext-method.md)</ept>.","source":"Gets a clone of the [IHostSecurityContext](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritycontext-interface.md) instance returned from a call to [IHostSecurityManager::GetSecurityContext](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-getsecuritycontext-method.md)."},{"pos":[1054,1060],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1162,1172],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[out] A pointer to the address of a clone of the <ph id=\"ph1\">`IHostSecurityContext`</ph> object to be captured.","pos":[1197,1291],"source":"[out] A pointer to the address of a clone of the `IHostSecurityContext` object to be captured."},{"pos":[1300,1312],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"HRESULT","pos":[1319,1326]},{"content":"Description","pos":[1327,1338]},{"content":"S_OK","pos":[1379,1383]},{"pos":[1384,1416],"content":"<ph id=\"ph1\">`Capture`</ph> returned successfully.","source":"`Capture` returned successfully."},{"content":"HOST_E_CLRNOTAVAILABLE","pos":[1421,1443]},{"content":"The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.","pos":[1444,1608]},{"content":"HOST_E_TIMEOUT","pos":[1613,1627]},{"content":"The call timed out.","pos":[1628,1647]},{"content":"HOST_E_NOT_OWNER","pos":[1652,1668]},{"content":"The caller does not own the lock.","pos":[1669,1702]},{"content":"HOST_E_ABANDONED","pos":[1707,1723]},{"content":"An event was canceled while a blocked thread or fiber was waiting on it.","pos":[1724,1796]},{"content":"E_FAIL","pos":[1801,1807]},{"content":"An unknown catastrophic failure occurred.","pos":[1808,1849]},{"content":"When a method returns E_FAIL, the CLR is no longer usable within the process.","pos":[1850,1927]},{"content":"Subsequent calls to hosting methods return HOST_E_CLRNOTAVAILABLE.","pos":[1928,1994]},{"pos":[2004,2011],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The interface pointer returned from <ph id=\"ph1\">`Capture`</ph> is a clone of the captured context.","pos":[2015,2096],"source":"The interface pointer returned from `Capture` is a clone of the captured context."},{"content":"When this information is moved across an asynchronous code point, its lifetime is separated from that of the pointer against which the call was made.","pos":[2097,2246]},{"content":"The original pointer can therefore be released.","pos":[2247,2294]},{"pos":[2303,2315],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2319,2423],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2430,2451],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2458,2508],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[2515,2543],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept>","source":"**.NET Framework Versions:**"},{"pos":[2632,2640],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>IHostSecurityContext Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritycontext-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[2644,2761],"source":"[IHostSecurityContext Interface](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritycontext-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>IHostSecurityManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-interface.md)</ept>","pos":[2765,2881],"source":"[IHostSecurityManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihostsecuritymanager-interface.md)"}]}