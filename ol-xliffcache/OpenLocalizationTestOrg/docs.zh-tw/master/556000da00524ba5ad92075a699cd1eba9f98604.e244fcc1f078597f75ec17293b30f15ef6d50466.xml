{"content":"---\ntitle: \"IDENTITY_ATTRIBUTE_BLOB Structure | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IDENTITY_ATTRIBUTE_BLOB\"\napi_location: \n  - \"fusion.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IDENTITY_ATTRIBUTE_BLOB\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IDENTITY_ATTRIBUTE_BLOB structure [.NET Framework fusion]\"\nms.assetid: af14ae5f-d226-47dd-ba90-8fc6e6605d4d\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 14\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# IDENTITY_ATTRIBUTE_BLOB Structure\nContains information about a single attribute in an assembly, and consists of three `DWORD`s. Each `DWORD` is an offset into a character buffer produced by the `CurrentIntoBuffer` method of the [IEnumIDENTITY_ATTRIBUTE](../../../../docs/framework/unmanaged-api/fusion/ienumidentity-attribute-interface.md) interface  \n  \n## Syntax  \n  \n```  \ntypedef struct _IDENTITY_ATTRIBUTE_BLOB {  \n    DWORD  ofsNamespace;  \n    DWORD  ofsName;  \n    DWORD  ofsValue;  \n}   IDENTITY_ATTRIBUTE_BLOB;  \n```  \n  \n## Members  \n  \n|Member|Description|  \n|------------|-----------------|  \n|`ofsNamespace`|The first offset into the character buffer. This offset is not followed by the attribute's namespace, but by a series of null characters. Therefore, it is not used.|  \n|`ofsName`|The second offset into the character buffer. This location marks the start of the attribute's name.|  \n|`ofsValue`|The third offset into the character buffer. This location marks the start of the attribute's value.|  \n  \n## Sample  \n The following example illustrates several basic steps, which eventually result in a populated `IDENTITY_ATTRIBUTE_BLOB` structure:  \n  \n1.  Obtain an [IReferenceIdentity](../../../../docs/framework/unmanaged-api/fusion/ireferenceidentity-interface.md) for the assembly.  \n  \n2.  Call the `IReferenceIdentity::EnumAttributes` method, and obtain an [IEnumIDENTITY_ATTRIBUTE](../../../../docs/framework/unmanaged-api/fusion/ienumidentity-attribute-interface.md).  \n  \n3.  Create a character buffer, and cast it as an `IDENTITY_ATTRIBUTE_BLOB` structure.  \n  \n4.  Call the `CurrentIntoBuffer` method of the `IEnumIDENTITY_ATTRIBUTE` interface. This method copies the attributes `Namespace`, `Name`, and `Value` into the character buffer. The three offsets to those strings will become available in the `IDENTITY_ATTRIBUTE_BLOB` structure.  \n  \n```  \n// EnumAssemblyAttributes.cpp : main project file.  \n  \n#include \"stdafx.h\"  \n  \n#include \"fusion.h\"  \n#include \"windows.h\"  \n#include \"stdio.h\"  \n#include \"mscoree.h\"  \n#include \"isolation.h\"  \n  \ntypedef HRESULT (__stdcall *PFNGETREF)(LPCWSTR pwzFile, REFIID riid, IUnknown **ppUnk);  \ntypedef HRESULT (__stdcall *PFNGETAUTH)(IIdentityAuthority **ppIIdentityAuthority);  \n  \nPFNGETREF                   g_pfnGetAssemblyIdentityFromFile = NULL;  \nPFNGETAUTH                  g_pfnGetIdentityAuthority = NULL;  \nIUnknown                    *g_pUnk = NULL;  \n  \nbool Init()  \n{  \n    HRESULT     hr = S_OK;  \n    DWORD       dwSize = 0;  \n    bool        bRC = false;  \n  \n    hr = CorBindToRuntimeEx(NULL, L\"wks\", 0, CLSID_CorRuntimeHost,  \n                           IID_ICorRuntimeHost, (void **)&g_pUnk);  \n    if(FAILED(hr)) {  \n        printf(\"Error: Failed to initialize CLR runtime! hr = 0x%0x\\n\",  \n                hr);  \n        goto Exit;  \n    }  \n  \n    if (SUCCEEDED(hr)) {  \n        hr = GetRealProcAddress(\"GetAssemblyIdentityFromFile\",  \n                         (VOID **)&g_pfnGetAssemblyIdentityFromFile);  \n    }  \n  \n    if (SUCCEEDED(hr)) {  \n        hr = GetRealProcAddress(\"GetIdentityAuthority\",  \n                                (VOID **)&g_pfnGetIdentityAuthority);  \n    }  \n  \n    if (!g_pfnGetAssemblyIdentityFromFile ||   \n        !g_pfnGetIdentityAuthority)  \n    {  \n        printf(\"Error: Cannot get required APIs from fusion.dll!\\n\");  \n        goto Exit;  \n    }  \n  \n    bRC = true;  \n  \nExit:  \n    return bRC;  \n}  \n  \nvoid Shutdown()  \n{  \n    if(g_pUnk) {  \n        g_pUnk->Release();  \n        g_pUnk = NULL;  \n    }  \n}  \n  \nvoid Usage()  \n{  \n    printf(\"EnumAssemblyAttributes: A tool to enumerate the identity   \n            attributes of a given assembly.\\n\\n\");  \n    printf(\"Usage: EnumAssemblyAttributes AssemblyFilePath\\n\");  \n    printf(\"\\n\");  \n}  \n  \nint _cdecl wmain(int argc, LPCWSTR argv[])  \n{  \n    int     iResult = 1;  \n    IUnknown                    *pUnk  = NULL;  \n    IReferenceIdentity          *pRef  = NULL;  \n    HRESULT                     hr     = S_OK;     \n    IEnumIDENTITY_ATTRIBUTE     *pEnum = NULL;  \n    BYTE                        abData[1024];  \n    DWORD                       cbAvailable;  \n    DWORD                       cbUsed;  \n    IDENTITY_ATTRIBUTE_BLOB     *pBlob;  \n  \n    if(argc != 2) {  \n        Usage();  \n        goto Exit;  \n    }  \n  \n    if(!Init()) {  \n        printf(\"Failure initializing EnumIdAttr.\\n\");  \n        goto Exit;  \n    }  \n  \n    hr = g_pfnGetAssemblyIdentityFromFile(argv[1],   \n                            __uuidof(IReferenceIdentity), &pUnk);  \n  \n    if (FAILED(hr)) {  \n        printf(\"GetAssemblyIdentityFromFile failed with hr = 0x%x\",   \n                hr);  \n        goto Exit;  \n    }  \n  \n    hr = pUnk->QueryInterface(__uuidof(IReferenceIdentity),   \n                              (void**)&pRef);  \n    if (FAILED(hr)) {  \n        goto Exit;  \n    }  \n  \n    hr = pRef->EnumAttributes(&pEnum);  \n    if (FAILED(hr)) {  \n        printf(\"IReferenceIdentity::EnumAttributes failed with hr =   \n                0x%x\", hr);  \n        goto Exit;  \n    }  \n  \n    pBlob = (IDENTITY_ATTRIBUTE_BLOB *)(abData);  \n    while (1) {  \n        cbAvailable = sizeof(abData);  \n        hr = pEnum->CurrentIntoBuffer(cbAvailable, abData, &cbUsed);  \n        if (FAILED(hr)) {  \n            printf(\"IEnumIDENTITY_ATTRIBUTE::CurrentIntoBuffer failed   \n                    with hr = 0x%x\", hr);  \n            goto Exit;  \n        }  \n  \n        if (! cbUsed) {  \n            break;  \n        }  \n  \n        LPWSTR pwzNameSpace = (LPWSTR)(abData + pBlob->ofsNamespace);  \n        LPWSTR pwzName      = (LPWSTR)(abData + pBlob->ofsName);  \n        LPWSTR pwzValue     = (LPWSTR)(abData + pBlob->ofsValue);  \n        printf(\"%ws: %ws = %ws\\n\", pwzNameSpace, pwzName, pwzValue);  \n  \n        hr = pEnum->Skip(1);  \n        if (FAILED(hr)) {  \n            printf(\"IEnumIDENTITY_ATTRIBUTE::Skip failed with hr =   \n                    0x%x\", hr);  \n            goto Exit;  \n        }  \n    }  \n  \n    iResult = 0;  \n  \nExit:  \n  \n    Shutdown();  \n  \n    if (pUnk) {  \n        pUnk->Release();  \n    }  \n  \n    if (pRef) {  \n        pRef->Release();  \n    }  \n  \n    if (pEnum) {  \n        pEnum->Release();  \n    }  \n  \n    return iResult;  \n}  \n```  \n  \n### To run the sample  \n C:\\\\> EnumAssemblyAttributes.exe C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\System.dll  \n  \n### Sample output  \n Culture = neutral  \n  \n name = System  \n  \n processorArchitecture = MSIL  \n  \n PublicKeyToken = b77a5c561934e089  \n  \n Version = 2.0.0.0  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** Isolation.h  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See Also  \n [IReferenceIdentity Interface](../../../../docs/framework/unmanaged-api/fusion/ireferenceidentity-interface.md)   \n [IEnumIDENTITY_ATTRIBUTE Interface](../../../../docs/framework/unmanaged-api/fusion/ienumidentity-attribute-interface.md)   \n [IDENTITY_ATTRIBUTE Structure](../../../../docs/framework/unmanaged-api/fusion/identity-attribute-structure.md)   \n [Fusion Structures](../../../../docs/framework/unmanaged-api/fusion/fusion-structures.md)","nodes":[{"pos":[4,633],"embed":true,"restype":"x-metadata","content":"title: \"IDENTITY_ATTRIBUTE_BLOB Structure | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IDENTITY_ATTRIBUTE_BLOB\"\napi_location: \n  - \"fusion.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IDENTITY_ATTRIBUTE_BLOB\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IDENTITY_ATTRIBUTE_BLOB structure [.NET Framework fusion]\"\nms.assetid: af14ae5f-d226-47dd-ba90-8fc6e6605d4d\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 14\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"IDENTITY_ATTRIBUTE_BLOB Structure | Microsoft Docs","nodes":[{"pos":[0,50],"content":"IDENTITY_ATTRIBUTE_BLOB Structure | Microsoft Docs","nodes":[{"content":"IDENTITY_ATTRIBUTE_BLOB Structure | Microsoft Docs","pos":[0,50]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[640,673],"content":"IDENTITY_ATTRIBUTE_BLOB Structure","linkify":"IDENTITY_ATTRIBUTE_BLOB Structure","nodes":[{"content":"IDENTITY_ATTRIBUTE_BLOB Structure","pos":[0,33]}]},{"content":"Contains information about a single attribute in an assembly, and consists of three <ph id=\"ph1\">`DWORD`</ph>s.","pos":[674,767],"source":"Contains information about a single attribute in an assembly, and consists of three `DWORD`s."},{"content":"Each <ph id=\"ph1\">`DWORD`</ph> is an offset into a character buffer produced by the <ph id=\"ph2\">`CurrentIntoBuffer`</ph> method of the <bpt id=\"p1\">[</bpt>IEnumIDENTITY_ATTRIBUTE<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/fusion/ienumidentity-attribute-interface.md)</ept> interface","pos":[768,989],"source":" Each `DWORD` is an offset into a character buffer produced by the `CurrentIntoBuffer` method of the [IEnumIDENTITY_ATTRIBUTE](../../../../docs/framework/unmanaged-api/fusion/ienumidentity-attribute-interface.md) interface"},{"pos":[998,1004],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1175,1182],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"content":"Member","pos":[1189,1195]},{"content":"Description","pos":[1196,1207]},{"content":"The first offset into the character buffer.","pos":[1262,1305]},{"content":"This offset is not followed by the attribute's namespace, but by a series of null characters.","pos":[1306,1399]},{"content":"Therefore, it is not used.","pos":[1400,1426]},{"content":"The second offset into the character buffer.","pos":[1441,1485]},{"content":"This location marks the start of the attribute's name.","pos":[1486,1540]},{"content":"The third offset into the character buffer.","pos":[1556,1599]},{"content":"This location marks the start of the attribute's value.","pos":[1600,1655]},{"pos":[1665,1671],"content":"Sample","linkify":"Sample","nodes":[{"content":"Sample","pos":[0,6]}]},{"pos":[1675,1805],"content":"The following example illustrates several basic steps, which eventually result in a populated <ph id=\"ph1\">`IDENTITY_ATTRIBUTE_BLOB`</ph> structure:","source":"The following example illustrates several basic steps, which eventually result in a populated `IDENTITY_ATTRIBUTE_BLOB` structure:"},{"pos":[1815,1944],"content":"Obtain an <bpt id=\"p1\">[</bpt>IReferenceIdentity<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/fusion/ireferenceidentity-interface.md)</ept> for the assembly.","source":"Obtain an [IReferenceIdentity](../../../../docs/framework/unmanaged-api/fusion/ireferenceidentity-interface.md) for the assembly."},{"pos":[1954,2134],"content":"Call the <ph id=\"ph1\">`IReferenceIdentity::EnumAttributes`</ph> method, and obtain an <bpt id=\"p1\">[</bpt>IEnumIDENTITY_ATTRIBUTE<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/fusion/ienumidentity-attribute-interface.md)</ept>.","source":"Call the `IReferenceIdentity::EnumAttributes` method, and obtain an [IEnumIDENTITY_ATTRIBUTE](../../../../docs/framework/unmanaged-api/fusion/ienumidentity-attribute-interface.md)."},{"pos":[2144,2225],"content":"Create a character buffer, and cast it as an <ph id=\"ph1\">`IDENTITY_ATTRIBUTE_BLOB`</ph> structure.","source":"Create a character buffer, and cast it as an `IDENTITY_ATTRIBUTE_BLOB` structure."},{"content":"Call the <ph id=\"ph1\">`CurrentIntoBuffer`</ph> method of the <ph id=\"ph2\">`IEnumIDENTITY_ATTRIBUTE`</ph> interface.","pos":[2235,2314],"source":"Call the `CurrentIntoBuffer` method of the `IEnumIDENTITY_ATTRIBUTE` interface."},{"content":"This method copies the attributes <ph id=\"ph1\">`Namespace`</ph>, <ph id=\"ph2\">`Name`</ph>, and <ph id=\"ph3\">`Value`</ph> into the character buffer.","pos":[2315,2408],"source":" This method copies the attributes `Namespace`, `Name`, and `Value` into the character buffer."},{"content":"The three offsets to those strings will become available in the <ph id=\"ph1\">`IDENTITY_ATTRIBUTE_BLOB`</ph> structure.","pos":[2409,2509],"source":" The three offsets to those strings will become available in the `IDENTITY_ATTRIBUTE_BLOB` structure."},{"pos":[6885,6902],"content":"To run the sample","linkify":"To run the sample","nodes":[{"content":"To run the sample","pos":[0,17]}]},{"content":"C:<ph id=\"ph1\">\\\\</ph>&gt; EnumAssemblyAttributes.exe C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\System.dll","pos":[6906,6995],"source":"C:\\\\> EnumAssemblyAttributes.exe C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\System.dll"},{"pos":[7005,7018],"content":"Sample output","linkify":"Sample output","nodes":[{"content":"Sample output","pos":[0,13]}]},{"content":"Culture = neutral","pos":[7022,7039]},{"content":"name = System","pos":[7046,7059]},{"content":"processorArchitecture = MSIL","pos":[7066,7094]},{"content":"PublicKeyToken = b77a5c561934e089","pos":[7101,7134]},{"content":"Version = 2.0.0.0","pos":[7141,7158]},{"pos":[7167,7179],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[7183,7287],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[7294,7317],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> Isolation.h","source":"**Header:** Isolation.h"},{"pos":[7324,7352],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept>","source":"**.NET Framework Versions:**"},{"pos":[7441,7449],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>IReferenceIdentity Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/fusion/ireferenceidentity-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[7453,7565],"source":"[IReferenceIdentity Interface](../../../../docs/framework/unmanaged-api/fusion/ireferenceidentity-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>IEnumIDENTITY_ATTRIBUTE Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/fusion/ienumidentity-attribute-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[7569,7691],"source":"[IEnumIDENTITY_ATTRIBUTE Interface](../../../../docs/framework/unmanaged-api/fusion/ienumidentity-attribute-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>IDENTITY_ATTRIBUTE Structure<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/fusion/identity-attribute-structure.md)</ept><ph id=\"ph1\"> </ph>","pos":[7695,7807],"source":"[IDENTITY_ATTRIBUTE Structure](../../../../docs/framework/unmanaged-api/fusion/identity-attribute-structure.md) "},{"content":"<bpt id=\"p1\">[</bpt>Fusion Structures<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/fusion/fusion-structures.md)</ept>","pos":[7811,7900],"source":"[Fusion Structures](../../../../docs/framework/unmanaged-api/fusion/fusion-structures.md)"}]}