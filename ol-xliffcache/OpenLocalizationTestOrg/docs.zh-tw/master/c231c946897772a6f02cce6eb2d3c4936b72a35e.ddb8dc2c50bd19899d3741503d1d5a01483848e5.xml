{"content":"---\ntitle: \"Creating threads and passing data at start time\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"threading [.NET Framework], creating\"\n  - \"threading [.NET Framework], passing data to threads\"\n  - \"threading [.NET Framework], retrieving data from threads\"\nms.assetid: 52b32222-e185-4f42-91a7-eaca65c0ab6d\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# Creating threads and passing data at start time\n\nWhen an operating-system process is created, the operating system injects a thread to execute code in that process, including any original application domain. From that point on, application domains can be created and destroyed without any operating system threads necessarily being created or destroyed. If the code being executed is managed code, then a <xref:System.Threading.Thread> object for the thread executing in the current application domain can be obtained by retrieving the static <xref:System.Threading.Thread.CurrentThread%2A> property of type <xref:System.Threading.Thread>. This topic describes thread creation and discusses alternatives for passing data to the thread procedure.  \n  \n## Creating a thread\n\n Creating a new <xref:System.Threading.Thread> object creates a new managed thread. The <xref:System.Threading.Thread> class has constructors that take a <xref:System.Threading.ThreadStart> delegate or a <xref:System.Threading.ParameterizedThreadStart> delegate; the delegate wraps the method that is invoked by the new thread when you call the <xref:System.Threading.Thread.Start%2A> method. Calling <xref:System.Threading.Thread.Start%2A> more than once causes a <xref:System.Threading.ThreadStateException> to be thrown.  \n  \n The <xref:System.Threading.Thread.Start%2A> method returns immediately, often before the new thread has actually started. You can use the <xref:System.Threading.Thread.ThreadState%2A> and <xref:System.Threading.Thread.IsAlive%2A> properties to determine the state of the thread at any one moment, but these properties should never be used for synchronizing the activities of threads.  \n  \n> [!NOTE]\n> Once a thread is started, it is not necessary to retain a reference to the <xref:System.Threading.Thread> object. The thread continues to execute until the thread procedure ends.  \n  \n The following code example creates two new threads to call instance and static methods on another object.  \n  \n [!code-cpp[System.Threading.ThreadStart2#2](../../../samples/snippets/cpp/VS_Snippets_CLR_System/system.Threading.ThreadStart2/CPP/source2.cpp#2)]\n [!code-csharp[System.Threading.ThreadStart2#2](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.Threading.ThreadStart2/CS/source2.cs#2)]\n [!code-vb[System.Threading.ThreadStart2#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Threading.ThreadStart2/VB/source2.vb#2)]  \n  \n## Passing data to threads\n\n In the .NET Framework version 2.0, the <xref:System.Threading.ParameterizedThreadStart> delegate provides an easy way to pass an object containing data to a thread when you call the <xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType> method overload. See <xref:System.Threading.ParameterizedThreadStart> for a code example.  \n  \n Using the <xref:System.Threading.ParameterizedThreadStart> delegate is not a type-safe way to pass data, because the <xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType> method overload accepts any object. An alternative is to encapsulate the thread procedure and the data in a helper class and use the <xref:System.Threading.ThreadStart> delegate to execute the thread procedure. The following example demonstrates this technique:\n\n [!code-cpp[System.Threading.ThreadStart2#3](../../../samples/snippets/cpp/VS_Snippets_CLR_System/system.Threading.ThreadStart2/CPP/source3.cpp#3)]\n [!code-csharp[System.Threading.ThreadStart2#3](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.Threading.ThreadStart2/CS/source3.cs#3)]\n [!code-vb[System.Threading.ThreadStart2#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Threading.ThreadStart2/VB/source3.vb#3)]  \n\nNeither <xref:System.Threading.ThreadStart> nor <xref:System.Threading.ParameterizedThreadStart> delegate has a return value, because there is no place to return the data from an asynchronous call. To retrieve the results of a thread method, you can use a callback method, as shown in the next section.\n  \n## Retrieving data from threads with callback methods\n\n The following example demonstrates a callback method that retrieves data from a thread. The constructor for the class that contains the data and the thread method also accepts a delegate representing the callback method; before the thread method ends, it invokes the callback delegate.  \n  \n [!code-cpp[System.Threading.ThreadStart2#4](../../../samples/snippets/cpp/VS_Snippets_CLR_System/system.Threading.ThreadStart2/CPP/source4.cpp#4)]\n [!code-csharp[System.Threading.ThreadStart2#4](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.Threading.ThreadStart2/CS/source4.cs#4)]\n [!code-vb[System.Threading.ThreadStart2#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Threading.ThreadStart2/VB/source4.vb#4)]  \n  \n## See also\n\n- <xref:System.Threading.Thread>\n- <xref:System.Threading.ThreadStart>\n- <xref:System.Threading.ParameterizedThreadStart>\n- <xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType>\n- [Threading](index.md)\n- [Using Threads and Threading](using-threads-and-threading.md)\n","nodes":[{"pos":[4,432],"embed":true,"restype":"x-metadata","content":"title: \"Creating threads and passing data at start time\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"threading [.NET Framework], creating\"\n  - \"threading [.NET Framework], passing data to threads\"\n  - \"threading [.NET Framework], retrieving data from threads\"\nms.assetid: 52b32222-e185-4f42-91a7-eaca65c0ab6d\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"Creating threads and passing data at start time","nodes":[{"pos":[0,47],"content":"Creating threads and passing data at start time","nodes":[{"content":"Creating threads and passing data at start time","pos":[0,47]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[439,486],"content":"Creating threads and passing data at start time","linkify":"Creating threads and passing data at start time","nodes":[{"content":"Creating threads and passing data at start time","pos":[0,47]}]},{"content":"When an operating-system process is created, the operating system injects a thread to execute code in that process, including any original application domain.","pos":[488,646]},{"content":"From that point on, application domains can be created and destroyed without any operating system threads necessarily being created or destroyed.","pos":[647,792]},{"content":"If the code being executed is managed code, then a <ph id=\"ph1\">&lt;xref:System.Threading.Thread&gt;</ph> object for the thread executing in the current application domain can be obtained by retrieving the static <ph id=\"ph2\">&lt;xref:System.Threading.Thread.CurrentThread%2A&gt;</ph> property of type <ph id=\"ph3\">&lt;xref:System.Threading.Thread&gt;</ph>.","pos":[793,1078],"source":" If the code being executed is managed code, then a <xref:System.Threading.Thread> object for the thread executing in the current application domain can be obtained by retrieving the static <xref:System.Threading.Thread.CurrentThread%2A> property of type <xref:System.Threading.Thread>."},{"content":"This topic describes thread creation and discusses alternatives for passing data to the thread procedure.","pos":[1079,1184]},{"pos":[1193,1210],"content":"Creating a thread","linkify":"Creating a thread","nodes":[{"content":"Creating a thread","pos":[0,17]}]},{"content":"Creating a new <ph id=\"ph1\">&lt;xref:System.Threading.Thread&gt;</ph> object creates a new managed thread.","pos":[1213,1295],"source":"Creating a new <xref:System.Threading.Thread> object creates a new managed thread."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Threading.Thread&gt;</ph> class has constructors that take a <ph id=\"ph2\">&lt;xref:System.Threading.ThreadStart&gt;</ph> delegate or a <ph id=\"ph3\">&lt;xref:System.Threading.ParameterizedThreadStart&gt;</ph> delegate; the delegate wraps the method that is invoked by the new thread when you call the <ph id=\"ph4\">&lt;xref:System.Threading.Thread.Start%2A&gt;</ph> method.","pos":[1296,1604],"source":" The <xref:System.Threading.Thread> class has constructors that take a <xref:System.Threading.ThreadStart> delegate or a <xref:System.Threading.ParameterizedThreadStart> delegate; the delegate wraps the method that is invoked by the new thread when you call the <xref:System.Threading.Thread.Start%2A> method."},{"content":"Calling <ph id=\"ph1\">&lt;xref:System.Threading.Thread.Start%2A&gt;</ph> more than once causes a <ph id=\"ph2\">&lt;xref:System.Threading.ThreadStateException&gt;</ph> to be thrown.","pos":[1605,1735],"source":" Calling <xref:System.Threading.Thread.Start%2A> more than once causes a <xref:System.Threading.ThreadStateException> to be thrown."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Threading.Thread.Start%2A&gt;</ph> method returns immediately, often before the new thread has actually started.","pos":[1742,1863],"source":"The <xref:System.Threading.Thread.Start%2A> method returns immediately, often before the new thread has actually started."},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Threading.Thread.ThreadState%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Threading.Thread.IsAlive%2A&gt;</ph> properties to determine the state of the thread at any one moment, but these properties should never be used for synchronizing the activities of threads.","pos":[1864,2125],"source":" You can use the <xref:System.Threading.Thread.ThreadState%2A> and <xref:System.Threading.Thread.IsAlive%2A> properties to determine the state of the thread at any one moment, but these properties should never be used for synchronizing the activities of threads."},{"pos":[2133,2321],"content":"[!NOTE]\nOnce a thread is started, it is not necessary to retain a reference to the <xref:System.Threading.Thread> object. The thread continues to execute until the thread procedure ends.","leadings":["","> "],"nodes":[{"content":"Once a thread is started, it is not necessary to retain a reference to the <xref:System.Threading.Thread> object. The thread continues to execute until the thread procedure ends.","pos":[8,186],"nodes":[{"content":"Once a thread is started, it is not necessary to retain a reference to the <ph id=\"ph1\">&lt;xref:System.Threading.Thread&gt;</ph> object.","pos":[0,113],"source":"Once a thread is started, it is not necessary to retain a reference to the <xref:System.Threading.Thread> object."},{"content":"The thread continues to execute until the thread procedure ends.","pos":[114,178]}]}]},{"content":"The following code example creates two new threads to call instance and static methods on another object.","pos":[2328,2433]},{"pos":[2900,2923],"content":"Passing data to threads","linkify":"Passing data to threads","nodes":[{"content":"Passing data to threads","pos":[0,23]}]},{"content":"In the .NET Framework version 2.0, the <ph id=\"ph1\">&lt;xref:System.Threading.ParameterizedThreadStart&gt;</ph> delegate provides an easy way to pass an object containing data to a thread when you call the <ph id=\"ph2\">&lt;xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType&gt;</ph> method overload.","pos":[2926,3193],"source":"In the .NET Framework version 2.0, the <xref:System.Threading.ParameterizedThreadStart> delegate provides an easy way to pass an object containing data to a thread when you call the <xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType> method overload."},{"content":"See <ph id=\"ph1\">&lt;xref:System.Threading.ParameterizedThreadStart&gt;</ph> for a code example.","pos":[3194,3266],"source":" See <xref:System.Threading.ParameterizedThreadStart> for a code example."},{"content":"Using the <ph id=\"ph1\">&lt;xref:System.Threading.ParameterizedThreadStart&gt;</ph> delegate is not a type-safe way to pass data, because the <ph id=\"ph2\">&lt;xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType&gt;</ph> method overload accepts any object.","pos":[3273,3494],"source":"Using the <xref:System.Threading.ParameterizedThreadStart> delegate is not a type-safe way to pass data, because the <xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType> method overload accepts any object."},{"content":"An alternative is to encapsulate the thread procedure and the data in a helper class and use the <ph id=\"ph1\">&lt;xref:System.Threading.ThreadStart&gt;</ph> delegate to execute the thread procedure.","pos":[3495,3669],"source":" An alternative is to encapsulate the thread procedure and the data in a helper class and use the <xref:System.Threading.ThreadStart> delegate to execute the thread procedure."},{"content":"The following example demonstrates this technique:","pos":[3670,3720]},{"content":"Neither <ph id=\"ph1\">&lt;xref:System.Threading.ThreadStart&gt;</ph> nor <ph id=\"ph2\">&lt;xref:System.Threading.ParameterizedThreadStart&gt;</ph> delegate has a return value, because there is no place to return the data from an asynchronous call.","pos":[4178,4375],"source":"Neither <xref:System.Threading.ThreadStart> nor <xref:System.Threading.ParameterizedThreadStart> delegate has a return value, because there is no place to return the data from an asynchronous call."},{"content":"To retrieve the results of a thread method, you can use a callback method, as shown in the next section.","pos":[4376,4480]},{"pos":[4487,4537],"content":"Retrieving data from threads with callback methods","linkify":"Retrieving data from threads with callback methods","nodes":[{"content":"Retrieving data from threads with callback methods","pos":[0,50]}]},{"content":"The following example demonstrates a callback method that retrieves data from a thread.","pos":[4540,4627]},{"content":"The constructor for the class that contains the data and the thread method also accepts a delegate representing the callback method; before the thread method ends, it invokes the callback delegate.","pos":[4628,4825]},{"pos":[5292,5300],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5497,5518],"content":"<bpt id=\"p1\">[</bpt>Threading<ept id=\"p1\">](index.md)</ept>","source":"[Threading](index.md)"},{"pos":[5521,5582],"content":"<bpt id=\"p1\">[</bpt>Using Threads and Threading<ept id=\"p1\">](using-threads-and-threading.md)</ept>","source":"[Using Threads and Threading](using-threads-and-threading.md)"}]}