{"content":"---\ntitle: \"Property grid extensibility - WF sample\"\nms.date: \"03/30/2017\"\nms.assetid: 3530c3a3-756d-4712-9f10-fb2897414d3a\n---\n# Property grid extensibility\n\nA developer can customize the property grid that is displayed when a given activity is selected within the designer. This can be done to create a rich editing experience. This sample shows how this can be done.\n\n## Demonstrates\n\nWorkflow designer property grid extensibility.\n\n> [!IMPORTANT]\n> The samples may already be installed on your machine. Check for the following (default) directory before continuing.\n>\n> `<InstallDrive>:\\WF_WCF_Samples`\n>\n> If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.\n>\n> `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\Designer\\PropertyGridExtensibility`\n\n## Discussion\n\nTo extend the property grid, a developer has options to customize the inline appearance of a property grid editor or provide a dialog that appears for a more advanced editing surface. There are two different editors demonstrated in this sample; an inline editor and a dialog editor.\n\n## Inline editor\n\nThe inline editor sample demonstrates the following:\n\n- Creates a type that derives from <xref:System.Activities.Presentation.PropertyEditing.PropertyValueEditor>.\n\n- In the constructor, the <xref:System.Activities.Presentation.PropertyEditing.PropertyValueEditor.InlineEditorTemplate%2A> value is set with a Windows Presentation Foundation (WPF) data template. This can be bound to a XAML template, but in this sample, code is used to initialize data binding.\n\n- The data template has a data context of the <xref:System.Activities.Presentation.PropertyEditing.PropertyValue> of the item rendered in the property grid. Note in the following code (from CustomInlineEditor.cs) that this context then binds to the `Value` property.\n\n    ```csharp\n    FrameworkElementFactory stack = new FrameworkElementFactory(typeof(StackPanel));\n    FrameworkElementFactory slider = new FrameworkElementFactory(typeof(Slider));\n    Binding sliderBinding = new Binding(\"Value\");\n    sliderBinding.Mode = BindingMode.TwoWay;\n    slider.SetValue(Slider.MinimumProperty, 0.0);\n    slider.SetValue(Slider.MaximumProperty, 100.0);\n    slider.SetValue(Slider.ValueProperty, sliderBinding);\n    stack.AppendChild(slider);\n    ```\n\n- Because the activity and the designer are in the same assembly, registration of the activity designer attributes are accomplished in the static constructor of the activity itself, as shown in the following example from SimpleCodeActivity.cs.\n\n    ```csharp\n    static SimpleCodeActivity()\n    {\n        AttributeTableBuilder builder = new AttributeTableBuilder();\n        builder.AddCustomAttributes(typeof(SimpleCodeActivity), \"RepeatCount\", new EditorAttribute(typeof(CustomInlineEditor), typeof(PropertyValueEditor)));\n        builder.AddCustomAttributes(typeof(SimpleCodeActivity), \"FileName\", new EditorAttribute(typeof(FilePickerEditor), typeof(DialogPropertyValueEditor)));\n        MetadataStore.AddAttributeTable(builder.CreateTable());\n    }\n    ```\n\n## Dialog editor\n\nThe dialog editor sample demonstrates the following:\n\n1. Creates a type that derives from <xref:System.Activities.Presentation.PropertyEditing.DialogPropertyValueEditor>.\n\n2. Sets the <xref:System.Activities.Presentation.PropertyEditing.PropertyValueEditor.InlineEditorTemplate%2A> value in the constructor with a [!INCLUDE[avalon2](../../../../includes/avalon2-md.md)] data template. This can be created in XAML, but in this sample, this is created in code.\n\n3. The data template has a data context of the <xref:System.Activities.Presentation.PropertyEditing.PropertyValue> of the item rendered in the property grid. In the following code, this then binds to the `Value` property. It is critical to also include an <xref:System.Activities.Presentation.PropertyEditing.EditModeSwitchButton> to provide the button that raises the dialog in FilePickerEditor.cs.\n\n    ```csharp\n    this.InlineEditorTemplate = new DataTemplate();\n\n    FrameworkElementFactory stack = new FrameworkElementFactory(typeof(StackPanel));\n    stack.SetValue(StackPanel.OrientationProperty, Orientation.Horizontal);\n    FrameworkElementFactory label = new FrameworkElementFactory(typeof(Label));\n    Binding labelBinding = new Binding(\"Value\");\n    label.SetValue(Label.ContentProperty, labelBinding);\n    label.SetValue(Label.MaxWidthProperty, 90.0);\n\n    stack.AppendChild(label);\n\n    FrameworkElementFactory editModeSwitch = new FrameworkElementFactory(typeof(EditModeSwitchButton));\n\n    editModeSwitch.SetValue(EditModeSwitchButton.TargetEditModeProperty, PropertyContainerEditMode.Dialog);\n\n    stack.AppendChild(editModeSwitch);\n\n    this.InlineEditorTemplate.VisualTree = stack;\n    ```\n\n4. Overrides the <xref:System.Activities.Presentation.PropertyEditing.DialogPropertyValueEditor.ShowDialog%2A> method in the designer type to handle the display of the dialog. In this sample, a basic <xref:System.Windows.Forms.FileDialog> is shown.\n\n    ```csharp\n    public override void ShowDialog(PropertyValue propertyValue, IInputElement commandSource)\n    {\n        Microsoft.Win32.OpenFileDialog ofd = new Microsoft.Win32.OpenFileDialog();\n        if (ofd.ShowDialog() == true)\n        {\n            propertyValue.Value = ofd.FileName;\n        }\n    }\n    ```\n\n5. Because the activity and the designer are in the same assembly, registration of the activity designer attributes are accomplished in the static constructor of the activity itself, as shown in the following example from SimpleCodeActivity.cs.\n\n    ```csharp\n    static SimpleCodeActivity()\n    {\n        AttributeTableBuilder builder = new AttributeTableBuilder();\n        builder.AddCustomAttributes(typeof(SimpleCodeActivity), \"RepeatCount\", new EditorAttribute(typeof(CustomInlineEditor), typeof(PropertyValueEditor)));\n        builder.AddCustomAttributes(typeof(SimpleCodeActivity), \"FileName\", new EditorAttribute(typeof(FilePickerEditor), typeof(DialogPropertyValueEditor)));\n        MetadataStore.AddAttributeTable(builder.CreateTable());\n    }\n    ```\n\n## To set up, build, and run the sample\n\n1. Build the solution, and then open Workflow1.xaml.\n\n2. Drag a **SimpleCodeActivity** from the toolbox onto the designer canvas.\n\n3. Click the **SimpleCodeActivity** and then open the property grid where there is a slider control and a file picking control.\n\n> [!IMPORTANT]\n> The samples may already be installed on your machine. Check for the following (default) directory before continuing.\n>\n> `<InstallDrive>:\\WF_WCF_Samples`\n>\n> If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.\n>\n> `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\Designer\\PropertyGridExtensibility`","nodes":[{"pos":[4,123],"embed":true,"restype":"x-metadata","content":"title: \"Property grid extensibility - WF sample\"\nms.date: \"03/30/2017\"\nms.assetid: 3530c3a3-756d-4712-9f10-fb2897414d3a","nodes":[{"content":"Property grid extensibility - WF sample","nodes":[{"pos":[0,39],"content":"Property grid extensibility - WF sample","nodes":[{"content":"Property grid extensibility - WF sample","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[130,157],"content":"Property grid extensibility","linkify":"Property grid extensibility","nodes":[{"content":"Property grid extensibility","pos":[0,27]}]},{"content":"A developer can customize the property grid that is displayed when a given activity is selected within the designer.","pos":[159,275]},{"content":"This can be done to create a rich editing experience.","pos":[276,329]},{"content":"This sample shows how this can be done.","pos":[330,369]},{"pos":[374,386],"content":"Demonstrates","linkify":"Demonstrates","nodes":[{"content":"Demonstrates","pos":[0,12]}]},{"content":"Workflow designer property grid extensibility.","pos":[388,434]},{"pos":[438,569],"content":"[!IMPORTANT]\nThe samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,129],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[611,921],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[922,972]},{"pos":[1058,1068],"content":"Discussion","linkify":"Discussion","nodes":[{"content":"Discussion","pos":[0,10]}]},{"content":"To extend the property grid, a developer has options to customize the inline appearance of a property grid editor or provide a dialog that appears for a more advanced editing surface.","pos":[1070,1253]},{"content":"There are two different editors demonstrated in this sample; an inline editor and a dialog editor.","pos":[1254,1352]},{"pos":[1357,1370],"content":"Inline editor","linkify":"Inline editor","nodes":[{"content":"Inline editor","pos":[0,13]}]},{"content":"The inline editor sample demonstrates the following:","pos":[1372,1424]},{"pos":[1428,1535],"content":"Creates a type that derives from <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.PropertyEditing.PropertyValueEditor&gt;</ph>.","source":"Creates a type that derives from <xref:System.Activities.Presentation.PropertyEditing.PropertyValueEditor>."},{"content":"In the constructor, the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.PropertyEditing.PropertyValueEditor.InlineEditorTemplate%2A&gt;</ph> value is set with a Windows Presentation Foundation (WPF) data template.","pos":[1539,1733],"source":"In the constructor, the <xref:System.Activities.Presentation.PropertyEditing.PropertyValueEditor.InlineEditorTemplate%2A> value is set with a Windows Presentation Foundation (WPF) data template."},{"content":"This can be bound to a XAML template, but in this sample, code is used to initialize data binding.","pos":[1734,1832]},{"content":"The data template has a data context of the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.PropertyEditing.PropertyValue&gt;</ph> of the item rendered in the property grid.","pos":[1836,1990],"source":"The data template has a data context of the <xref:System.Activities.Presentation.PropertyEditing.PropertyValue> of the item rendered in the property grid."},{"content":"Note in the following code (from CustomInlineEditor.cs) that this context then binds to the <ph id=\"ph1\">`Value`</ph> property.","pos":[1991,2100],"source":" Note in the following code (from CustomInlineEditor.cs) that this context then binds to the `Value` property."},{"content":"Because the activity and the designer are in the same assembly, registration of the activity designer attributes are accomplished in the static constructor of the activity itself, as shown in the following example from SimpleCodeActivity.cs.","pos":[2580,2821]},{"pos":[3343,3356],"content":"Dialog editor","linkify":"Dialog editor","nodes":[{"content":"Dialog editor","pos":[0,13]}]},{"content":"The dialog editor sample demonstrates the following:","pos":[3358,3410]},{"pos":[3415,3528],"content":"Creates a type that derives from <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.PropertyEditing.DialogPropertyValueEditor&gt;</ph>.","source":"Creates a type that derives from <xref:System.Activities.Presentation.PropertyEditing.DialogPropertyValueEditor>."},{"content":"Sets the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.PropertyEditing.PropertyValueEditor.InlineEditorTemplate%2A&gt;</ph> value in the constructor with a <ph id=\"ph2\">[!INCLUDE[avalon2](../../../../includes/avalon2-md.md)]</ph> data template.","pos":[3533,3742],"source":"Sets the <xref:System.Activities.Presentation.PropertyEditing.PropertyValueEditor.InlineEditorTemplate%2A> value in the constructor with a [!INCLUDE[avalon2](../../../../includes/avalon2-md.md)] data template."},{"content":"This can be created in XAML, but in this sample, this is created in code.","pos":[3743,3816]},{"content":"The data template has a data context of the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.PropertyEditing.PropertyValue&gt;</ph> of the item rendered in the property grid.","pos":[3821,3975],"source":"The data template has a data context of the <xref:System.Activities.Presentation.PropertyEditing.PropertyValue> of the item rendered in the property grid."},{"content":"In the following code, this then binds to the <ph id=\"ph1\">`Value`</ph> property.","pos":[3976,4039],"source":" In the following code, this then binds to the `Value` property."},{"content":"It is critical to also include an <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.PropertyEditing.EditModeSwitchButton&gt;</ph> to provide the button that raises the dialog in FilePickerEditor.cs.","pos":[4040,4217],"source":" It is critical to also include an <xref:System.Activities.Presentation.PropertyEditing.EditModeSwitchButton> to provide the button that raises the dialog in FilePickerEditor.cs."},{"content":"Overrides the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.PropertyEditing.DialogPropertyValueEditor.ShowDialog%2A&gt;</ph> method in the designer type to handle the display of the dialog.","pos":[5031,5203],"source":"Overrides the <xref:System.Activities.Presentation.PropertyEditing.DialogPropertyValueEditor.ShowDialog%2A> method in the designer type to handle the display of the dialog."},{"content":"In this sample, a basic <ph id=\"ph1\">&lt;xref:System.Windows.Forms.FileDialog&gt;</ph> is shown.","pos":[5204,5276],"source":" In this sample, a basic <xref:System.Windows.Forms.FileDialog> is shown."},{"content":"Because the activity and the designer are in the same assembly, registration of the activity designer attributes are accomplished in the static constructor of the activity itself, as shown in the following example from SimpleCodeActivity.cs.","pos":[5599,5840]},{"pos":[6362,6398],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"content":"Build the solution, and then open Workflow1.xaml.","pos":[6403,6452]},{"pos":[6457,6529],"content":"Drag a <bpt id=\"p1\">**</bpt>SimpleCodeActivity<ept id=\"p1\">**</ept> from the toolbox onto the designer canvas.","source":"Drag a **SimpleCodeActivity** from the toolbox onto the designer canvas."},{"pos":[6534,6658],"content":"Click the <bpt id=\"p1\">**</bpt>SimpleCodeActivity<ept id=\"p1\">**</ept> and then open the property grid where there is a slider control and a file picking control.","source":"Click the **SimpleCodeActivity** and then open the property grid where there is a slider control and a file picking control."},{"pos":[6662,6793],"content":"[!IMPORTANT]\nThe samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,129],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[6835,7145],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[7146,7196]}]}