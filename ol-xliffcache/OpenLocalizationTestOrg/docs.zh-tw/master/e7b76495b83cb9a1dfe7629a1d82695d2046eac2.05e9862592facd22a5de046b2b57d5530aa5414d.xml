{"content":"---\ntitle: \"How to: Call Windows APIs (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"API calls [Visual Basic]\"\n  - \"Windows API, calling\"\n  - \"API calls [Visual Basic], platform invoke\"\n  - \"calls [Visual Basic], stored procedures\"\nms.assetid: 27d75f0a-54ab-4ee1-b91d-43513a19b12d\n---\n# How to: Call Windows APIs (Visual Basic)\nThis example defines and calls the `MessageBox` function in user32.dll and then passes a string to it.  \n  \n## Example  \n [!code-vb[VbVbalrInterop#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#1)]  \n  \n## Compiling the Code  \n This example requires:  \n  \n-   A reference to the <xref:System> namespace.  \n  \n## Robust Programming  \n The following conditions may cause an exception:  \n  \n-   The method is not static, is abstract, or has been previously defined. The parent type is an interface, or the length of *name* or *dllName* is zero. (<xref:System.ArgumentException>)  \n  \n-   The *name* or *dllName* is `Nothing`. (<xref:System.ArgumentNullException>)  \n  \n-   The containing type has been previously created using `CreateType`. (<xref:System.InvalidOperationException>)  \n  \n## See also\n\n- [A Closer Look at Platform Invoke](../../../framework/interop/consuming-unmanaged-dll-functions.md#a-closer-look-at-platform-invoke)\n- [Platform Invoke Examples](../../../framework/interop/platform-invoke-examples.md)\n- [Consuming Unmanaged DLL Functions](../../../framework/interop/consuming-unmanaged-dll-functions.md)\n- [Defining a Method with Reflection Emit](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w63y4d4f(v=vs.100))\n- [Walkthrough: Calling Windows APIs](../../../visual-basic/programming-guide/com-interop/walkthrough-calling-windows-apis.md)\n- [COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)\n","nodes":[{"pos":[4,296],"embed":true,"restype":"x-metadata","content":"title: \"How to: Call Windows APIs (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"API calls [Visual Basic]\"\n  - \"Windows API, calling\"\n  - \"API calls [Visual Basic], platform invoke\"\n  - \"calls [Visual Basic], stored procedures\"\nms.assetid: 27d75f0a-54ab-4ee1-b91d-43513a19b12d","nodes":[{"content":"How to: Call Windows APIs (Visual Basic)","nodes":[{"pos":[0,40],"content":"How to: Call Windows APIs (Visual Basic)","nodes":[{"content":"How to: Call Windows APIs (Visual Basic)","pos":[0,40]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[303,343],"content":"How to: Call Windows APIs (Visual Basic)","linkify":"How to: Call Windows APIs (Visual Basic)","nodes":[{"content":"How to: Call Windows APIs (Visual Basic)","pos":[0,40]}]},{"pos":[344,446],"content":"This example defines and calls the <ph id=\"ph1\">`MessageBox`</ph> function in user32.dll and then passes a string to it.","source":"This example defines and calls the `MessageBox` function in user32.dll and then passes a string to it."},{"pos":[455,462],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[586,604],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"This example requires:","pos":[608,630]},{"pos":[640,683],"content":"A reference to the <ph id=\"ph1\">&lt;xref:System&gt;</ph> namespace.","source":"A reference to the <xref:System> namespace."},{"pos":[692,710],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"The following conditions may cause an exception:","pos":[714,762]},{"content":"The method is not static, is abstract, or has been previously defined.","pos":[772,842]},{"content":"The parent type is an interface, or the length of <bpt id=\"p1\">*</bpt>name<ept id=\"p1\">*</ept> or <bpt id=\"p2\">*</bpt>dllName<ept id=\"p2\">*</ept> is zero.","pos":[843,921],"source":" The parent type is an interface, or the length of *name* or *dllName* is zero."},{"content":"(<ph id=\"ph1\">&lt;xref:System.ArgumentException&gt;</ph>)","pos":[922,955],"source":" (<xref:System.ArgumentException>)"},{"content":"The <bpt id=\"p1\">*</bpt>name<ept id=\"p1\">*</ept> or <bpt id=\"p2\">*</bpt>dllName<ept id=\"p2\">*</ept> is <ph id=\"ph1\">`Nothing`</ph>.","pos":[965,1002],"source":"The *name* or *dllName* is `Nothing`."},{"content":"(<ph id=\"ph1\">&lt;xref:System.ArgumentNullException&gt;</ph>)","pos":[1003,1040],"source":" (<xref:System.ArgumentNullException>)"},{"content":"The containing type has been previously created using <ph id=\"ph1\">`CreateType`</ph>.","pos":[1050,1117],"source":"The containing type has been previously created using `CreateType`."},{"content":"(<ph id=\"ph1\">&lt;xref:System.InvalidOperationException&gt;</ph>)","pos":[1118,1159],"source":" (<xref:System.InvalidOperationException>)"},{"pos":[1168,1176],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1180,1312],"content":"<bpt id=\"p1\">[</bpt>A Closer Look at Platform Invoke<ept id=\"p1\">](../../../framework/interop/consuming-unmanaged-dll-functions.md#a-closer-look-at-platform-invoke)</ept>","source":"[A Closer Look at Platform Invoke](../../../framework/interop/consuming-unmanaged-dll-functions.md#a-closer-look-at-platform-invoke)"},{"pos":[1315,1397],"content":"<bpt id=\"p1\">[</bpt>Platform Invoke Examples<ept id=\"p1\">](../../../framework/interop/platform-invoke-examples.md)</ept>","source":"[Platform Invoke Examples](../../../framework/interop/platform-invoke-examples.md)"},{"pos":[1400,1500],"content":"<bpt id=\"p1\">[</bpt>Consuming Unmanaged DLL Functions<ept id=\"p1\">](../../../framework/interop/consuming-unmanaged-dll-functions.md)</ept>","source":"[Consuming Unmanaged DLL Functions](../../../framework/interop/consuming-unmanaged-dll-functions.md)"},{"pos":[1503,1632],"content":"<bpt id=\"p1\">[</bpt>Defining a Method with Reflection Emit<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w63y4d4f(v=vs.100))</ept>","source":"[Defining a Method with Reflection Emit](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w63y4d4f(v=vs.100))"},{"pos":[1635,1759],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Calling Windows APIs<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/walkthrough-calling-windows-apis.md)</ept>","source":"[Walkthrough: Calling Windows APIs](../../../visual-basic/programming-guide/com-interop/walkthrough-calling-windows-apis.md)"},{"pos":[1762,1837],"content":"<bpt id=\"p1\">[</bpt>COM Interop<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/index.md)</ept>","source":"[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)"}]}