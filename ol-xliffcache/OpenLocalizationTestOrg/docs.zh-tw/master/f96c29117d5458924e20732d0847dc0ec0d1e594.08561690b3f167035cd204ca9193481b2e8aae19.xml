{"content":"---\ntitle: \"Walkthrough: Arranging Windows Forms Controls in WPF | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"hybrid applications [WPF interoperability]\"\n  - \"arranging controls\"\nms.assetid: a1db8049-15c7-45d6-ae3d-36a6735cb848\ncaps.latest.revision: 31\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Walkthrough: Arranging Windows Forms Controls in WPF\nThis walkthrough shows you how to use              [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layout features to arrange              [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls in a hybrid application.  \n  \n Tasks illustrated in this walkthrough include:  \n  \n-   Creating the project.  \n  \n-   Using default layout settings.  \n  \n-   Sizing to content.  \n  \n-   Using absolute positioning.  \n  \n-   Specifying size explicitly.  \n  \n-   Setting layout properties.  \n  \n-   Understanding z-order limitations.  \n  \n-   Docking.  \n  \n-   Setting visibility.  \n  \n-   Hosting a control that does not stretch.  \n  \n-   Scaling.  \n  \n-   Rotating.  \n  \n-   Setting padding and margins.  \n  \n-   Using dynamic layout containers.  \n  \n For a complete code listing of the tasks illustrated in this walkthrough,              see              [Arranging Windows Forms Controls in WPF Sample](http://go.microsoft.com/fwlink/?LinkID=159971).  \n  \n When you are finished, you will have an understanding of              [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] layout features in              [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based applications.  \n  \n## Prerequisites  \n You need the following components to complete this walkthrough:  \n  \n-   [!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)].  \n  \n## Creating the Project  \n  \n#### To create and set up the project  \n  \n1.  Create a WPF Application project named                                  `WpfLayoutHostingWf`.  \n  \n2.  In Solution Explorer, add references to the following assemblies.  \n  \n    -   WindowsFormsIntegration  \n  \n    -   System.Windows.Forms  \n  \n    -   System.Drawing  \n  \n3.  Double-click MainWindow.xaml to open it in XAML view.  \n  \n4.  In the                                  <xref:System.Windows.Window> element, add the following                                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] namespace mapping.  \n  \n    ```xaml  \n  \n    xmlns:wf=\"clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms\"  \n  \n    ```  \n  \n5.  In the                                  <xref:System.Windows.Controls.Grid> element set the                                  <xref:System.Windows.Controls.Grid.ShowGridLines%2A> property to                                  `true` and define five rows and three columns.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#2](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#2)]  \n  \n## Using Default Layout Settings  \n By default, the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element handles the layout for the hosted                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control.  \n  \n#### To use default layout settings  \n  \n1.  Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#3](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#3)]  \n  \n2.  Press F5 to build and run the application. The                                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]<xref:System.Windows.Forms.Button?displayProperty=fullName> control appears in the                                  <xref:System.Windows.Controls.Canvas>. The hosted control is sized based on its content, and the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is sized to accommodate the hosted control.  \n  \n## Sizing to Content  \n The                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element ensures that the hosted control is sized to display its content properly.  \n  \n#### To size to content  \n  \n1.  Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#4](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#4)]  \n  \n2.  Press F5 to build and run the application. The two new button controls are sized to display the longer text string and larger font size properly, and the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> elements are resized to accommodate the hosted controls.  \n  \n## Using Absolute Positioning  \n You can use absolute positioning to place the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element anywhere in the user interface (UI).  \n  \n#### To use absolute positioning  \n  \n1.  Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#5](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#5)]  \n  \n2.  Press F5 to build and run the application. The                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is placed 20 pixels from the top side of the grid cell and 20 pixels from the left.  \n  \n## Specifying Size Explicitly  \n You can specify the size of the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element using the                  <xref:System.Windows.FrameworkElement.Width%2A> and                  <xref:System.Windows.FrameworkElement.Height%2A> properties.  \n  \n#### To specify size explicitly  \n  \n1.  Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#6](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#6)]  \n  \n2.  Press F5 to build and run the application. The                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is set to a size of 50 pixels wide by 70 pixels high, which is smaller than the default layout settings. The content of the                                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control is rearranged accordingly.  \n  \n## Setting Layout Properties  \n Always set layout-related properties on the hosted control by using the properties of the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element. Setting layout properties directly on the hosted control will yield unintended results.  \n  \n Setting layout-related properties on the hosted control in                  [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] has no effect.  \n  \n#### To see the effects of setting properties on the hosted control  \n  \n1.  Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#7](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#7)]  \n  \n2.  In Solution Explorer, double-click MainWindow.xaml. vb or MainWindow.xaml.cs to open it in the Code Editor.  \n  \n3.  Copy the following code into the                                  `MainWindow` class definition.  \n  \n     [!code-csharp[WpfLayoutHostingWfWithXaml#101](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml.cs#101)]\n     [!code-vb[WpfLayoutHostingWfWithXaml#101](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/VisualBasic/Window1.xaml.vb#101)]  \n  \n4.  Press F5 to build and run the application.  \n  \n5.  Click the                                  **Click me** button. The                                  `button1_Click` event handler sets the                                  <xref:System.Windows.Forms.Control.Top%2A> and                                  <xref:System.Windows.Forms.Control.Left%2A> properties on the hosted control. This causes the hosted control to be repositioned within the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element.                                  The host maintains the same screen area, but the hosted control is clipped. Instead, the hosted control should always fill the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element.  \n  \n## Understanding Z-Order Limitations  \n By default, visible                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> elements are always drawn on top of other                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements, and they are unaffected by z-order. To enable z-ordering, set the                  <xref:System.Windows.Interop.HwndHost.IsRedirected%2A> property of the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> to true and the                  <xref:System.Windows.Interop.HwndHost.CompositionMode%2A> property to                  <xref:System.Windows.Interop.CompositionMode.Full> or                  <xref:System.Windows.Interop.CompositionMode.OutputOnly>.  \n  \n#### To see the default z-order behavior  \n  \n1.  Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#8](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#8)]  \n  \n2.  Press F5 to build and run the application. The                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is painted over the label element.  \n  \n#### To see the z-order behavior when IsRedirected is true  \n  \n1.  Replace the previous z-order                                  example with the following XAML.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#8b](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/VisualBasic/Window1.xaml#8b)]  \n  \n     Press F5 to build and run the application. The label element is painted over the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element.  \n  \n## Docking  \n <xref:System.Windows.Forms.Integration.WindowsFormsHost> element supports                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] docking. Set the                  <xref:System.Windows.Controls.DockPanel.Dock%2A> attached property to dock the hosted control in a                  <xref:System.Windows.Controls.DockPanel> element.  \n  \n#### To dock a hosted control  \n  \n1.  Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#9](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#9)]  \n  \n2.  Press F5 to build and run the application. The                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is docked to the right side of the                                  <xref:System.Windows.Controls.DockPanel> element.  \n  \n## Setting Visibility  \n You can make your                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control invisible or collapse it by setting the                  <xref:System.Windows.UIElement.Visibility%2A> property on the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element. When a control is invisible, it is not displayed, but it occupies layout space. When a control is collapsed, it is not displayed, nor does it occupy layout space.  \n  \n#### To set the visibility of a hosted control  \n  \n1.  Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#10](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#10)]  \n  \n2.  In MainWindow.xaml.vb or MainWindow.xaml.cs, copy the following code into the class definition.  \n  \n     [!code-csharp[WpfLayoutHostingWfWithXaml#102](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml.cs#102)]\n     [!code-vb[WpfLayoutHostingWfWithXaml#102](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/VisualBasic/Window1.xaml.vb#102)]  \n  \n3.  Press F5 to build and run the application.  \n  \n4.  Click the                                  **Click to make invisible** button to make the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element invisible.  \n  \n5.  Click the                                  **Click to collapse** button to hide the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element from the layout entirely. When the                                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control is collapsed, the surrounding elements are rearranged to occupy its space.  \n  \n## Hosting a Control That Does Not Stretch  \n Some                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls have a fixed size and do not stretch to fill available space in the layout. For example, the                  <xref:System.Windows.Forms.MonthCalendar> control displays a month in a fixed space.  \n  \n#### To host a control that does not stretch  \n  \n1.  Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#11](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#11)]  \n  \n2.  Press F5 to build and run the application. The                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is centered in the grid row, but it is not stretched to fill the available space. If the window is large enough, you may see two or more months displayed by the hosted                                  <xref:System.Windows.Forms.MonthCalendar> control, but these are centered in the row. The                                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layout engine centers elements that cannot be sized to fill the available space.  \n  \n## Scaling  \n Unlike [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements, most [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls are not continuously scalable. By default, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element scales its hosted control when possible.  To enable full-fledged scaling, set the <xref:System.Windows.Interop.HwndHost.IsRedirected%2A> property of the <xref:System.Windows.Forms.Integration.WindowsFormsHost> to true and the <xref:System.Windows.Interop.HwndHost.CompositionMode%2A> property to                  <xref:System.Windows.Interop.CompositionMode.Full> or <xref:System.Windows.Interop.CompositionMode.OutputOnly>.  \n  \n#### To scale a hosted control by using the default behavior  \n  \n1.  Copy the following XAML into the <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#12](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#12)]  \n  \n2.  Press F5 to build and run the application. The hosted control and its surrounding elements are scaled by a factor of 0.5. However, the hosted control's font is not scaled.  \n  \n#### To scale a hosted control by setting IsRedirected to true  \n  \n1.  Replace the previous scaling example with the following XAML.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#12b](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/VisualBasic/Window1.xaml#12b)]  \n  \n2.  Press F5 to build and run the application. The hosted control, its surrounding elements, and the hosted control's font are scaled by a factor of 0.5.  \n  \n## Rotating  \n Unlike                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements,                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls do not support rotation. By default, the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element does not rotate with other                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements when a rotation transformation is applied. Any rotation value other than 180 degrees raises the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost.LayoutError> event.  To enable rotating to any angle, set the                  <xref:System.Windows.Interop.HwndHost.IsRedirected%2A> property of the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> to true and the                  <xref:System.Windows.Interop.HwndHost.CompositionMode%2A> property to                  <xref:System.Windows.Interop.CompositionMode.Full> or                  <xref:System.Windows.Interop.CompositionMode.OutputOnly>.  \n  \n#### To see the effect of rotation in a hybrid application  \n  \n1.  Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#13](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#13)]  \n  \n2.  Press F5 to build and run the application. The hosted control is not rotated, but its surrounding elements are rotated by an angle of 180 degrees. You may have to resize the window to see the elements.  \n  \n#### To see the effect of rotation in a hybrid application when IsRedirected is true  \n  \n1.  Replace the previous rotation example with the following XAML.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#13b](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/VisualBasic/Window1.xaml#13b)]  \n  \n2.  Press F5 to build and run the application. The hosted control is rotated.  Note that the                                  <xref:System.Windows.Media.RotateTransform.Angle%2A> property can be set to any value. You may have to resize the window to see the elements.  \n  \n## Setting Padding and Margins  \n Padding and margins in                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layout are similar to padding and margins in                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]. Simply set the                  <xref:System.Windows.Controls.Control.Padding%2A> and                  <xref:System.Windows.FrameworkElement.Margin%2A> properties on the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element.  \n  \n#### To set padding and margins for a hosted control  \n  \n1.  Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#14](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#14)]  \n    [!code-xml[WpfLayoutHostingWfWithXaml#15](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#15)]  \n  \n2.  Press F5 to build and run the application. The padding and margin settings are applied to the hosted                                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls in the same way they would be applied in                                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)].  \n  \n## Using Dynamic Layout Containers  \n [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] provides two dynamic layout containers,                  <xref:System.Windows.Forms.FlowLayoutPanel> and                  <xref:System.Windows.Forms.TableLayoutPanel>. You can also use these containers in                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layouts.  \n  \n#### To use a dynamic layout container  \n  \n1.  Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element.  \n  \n     [!code-xml[WpfLayoutHostingWfWithXaml#16](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#16)]  \n  \n2.  In MainWindow.xaml.vb or MainWindow.xaml.cs copy the following code into the class definition.  \n  \n     [!code-csharp[WpfLayoutHostingWfWithXaml#103](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml.cs#103)]\n     [!code-vb[WpfLayoutHostingWfWithXaml#103](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/VisualBasic/Window1.xaml.vb#103)]  \n  \n3.  Add a call to the                                  `InitializeFlowLayoutPanel` method in the constructor.  \n  \n     [!code-csharp[WpfLayoutHostingWfWithXaml#104](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml.cs#104)]\n     [!code-vb[WpfLayoutHostingWfWithXaml#104](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/VisualBasic/Window1.xaml.vb#104)]  \n  \n4.  Press F5 to build and run the application. The                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element fills the                                  <xref:System.Windows.Controls.DockPanel>, and                                  <xref:System.Windows.Forms.FlowLayoutPanel> arranges its child controls in the default                                  <xref:System.Windows.Forms.FlowLayoutPanel.FlowDirection%2A>.  \n  \n## See Also  \n <xref:System.Windows.Forms.Integration.ElementHost>   \n <xref:System.Windows.Forms.Integration.WindowsFormsHost>   \n [WPF Designer](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)   \n [Layout Considerations for the WindowsFormsHost Element](../../../../docs/framework/wpf/advanced/layout-considerations-for-the-windowsformshost-element.md)   \n [Arranging Windows Forms Controls in WPF Sample](http://go.microsoft.com/fwlink/?LinkID=159971)   \n [Walkthrough: Hosting a Windows Forms Composite Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)   \n [Walkthrough: Hosting a WPF Composite Control in Windows Forms](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)","nodes":[{"pos":[4,478],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Arranging Windows Forms Controls in WPF | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"hybrid applications [WPF interoperability]\"\n  - \"arranging controls\"\nms.assetid: a1db8049-15c7-45d6-ae3d-36a6735cb848\ncaps.latest.revision: 31\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"Walkthrough: Arranging Windows Forms Controls in WPF | Microsoft Docs","nodes":[{"pos":[0,69],"content":"Walkthrough: Arranging Windows Forms Controls in WPF | Microsoft Docs","nodes":[{"content":"Walkthrough: Arranging Windows Forms Controls in WPF | Microsoft Docs","pos":[0,69]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[485,537],"content":"Walkthrough: Arranging Windows Forms Controls in WPF","linkify":"Walkthrough: Arranging Windows Forms Controls in WPF","nodes":[{"content":"Walkthrough: Arranging Windows Forms Controls in WPF","pos":[0,52]}]},{"pos":[538,822],"content":"This walkthrough shows you how to use              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> layout features to arrange              <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls in a hybrid application.","source":"This walkthrough shows you how to use              [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layout features to arrange              [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls in a hybrid application."},{"content":"Tasks illustrated in this walkthrough include:","pos":[829,875]},{"content":"Creating the project.","pos":[885,906]},{"content":"Using default layout settings.","pos":[916,946]},{"content":"Sizing to content.","pos":[956,974]},{"content":"Using absolute positioning.","pos":[984,1011]},{"content":"Specifying size explicitly.","pos":[1021,1048]},{"content":"Setting layout properties.","pos":[1058,1084]},{"content":"Understanding z-order limitations.","pos":[1094,1128]},{"content":"Docking.","pos":[1138,1146]},{"content":"Setting visibility.","pos":[1156,1175]},{"content":"Hosting a control that does not stretch.","pos":[1185,1225]},{"content":"Scaling.","pos":[1235,1243]},{"content":"Rotating.","pos":[1253,1262]},{"content":"Setting padding and margins.","pos":[1272,1300]},{"content":"Using dynamic layout containers.","pos":[1310,1342]},{"pos":[1349,1549],"content":"For a complete code listing of the tasks illustrated in this walkthrough,              see              <bpt id=\"p1\">[</bpt>Arranging Windows Forms Controls in WPF Sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=159971)</ept>.","source":"For a complete code listing of the tasks illustrated in this walkthrough,              see              [Arranging Windows Forms Controls in WPF Sample](http://go.microsoft.com/fwlink/?LinkID=159971)."},{"pos":[1556,1837],"content":"When you are finished, you will have an understanding of              <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> layout features in              <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph>-based applications.","source":"When you are finished, you will have an understanding of              [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] layout features in              [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based applications."},{"pos":[1846,1859],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to complete this walkthrough:","pos":[1863,1926]},{"pos":[1936,2004],"content":"<ph id=\"ph1\">[!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)]</ph>.","source":"[!INCLUDE[vs_dev10_long](../../../../includes/vs-dev10-long-md.md)]."},{"pos":[2013,2033],"content":"Creating the Project","linkify":"Creating the Project","nodes":[{"content":"Creating the Project","pos":[0,20]}]},{"pos":[2044,2076],"content":"To create and set up the project","linkify":"To create and set up the project","nodes":[{"content":"To create and set up the project","pos":[0,32]}]},{"pos":[2086,2179],"content":"Create a WPF Application project named                                  <ph id=\"ph1\">`WpfLayoutHostingWf`</ph>.","source":"Create a WPF Application project named                                  `WpfLayoutHostingWf`."},{"content":"In Solution Explorer, add references to the following assemblies.","pos":[2189,2254]},{"content":"WindowsFormsIntegration","pos":[2268,2291]},{"content":"System.Windows.Forms","pos":[2305,2325]},{"content":"System.Drawing","pos":[2339,2353]},{"content":"Double-click MainWindow.xaml to open it in XAML view.","pos":[2363,2416]},{"pos":[2426,2651],"content":"In the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> element, add the following                                  <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> namespace mapping.","source":"In the                                  <xref:System.Windows.Window> element, add the following                                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] namespace mapping."},{"pos":[2776,3045],"content":"In the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element set the                                  <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Grid.ShowGridLines%2A&gt;</ph> property to                                  <ph id=\"ph3\">`true`</ph> and define five rows and three columns.","source":"In the                                  <xref:System.Windows.Controls.Grid> element set the                                  <xref:System.Windows.Controls.Grid.ShowGridLines%2A> property to                                  `true` and define five rows and three columns."},{"pos":[3208,3237],"content":"Using Default Layout Settings","linkify":"Using Default Layout Settings","nodes":[{"content":"Using Default Layout Settings","pos":[0,29]}]},{"pos":[3241,3476],"content":"By default, the                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element handles the layout for the hosted                  <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> control.","source":"By default, the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element handles the layout for the hosted                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control."},{"pos":[3487,3517],"content":"To use default layout settings","linkify":"To use default layout settings","nodes":[{"content":"To use default layout settings","pos":[0,30]}]},{"content":"Copy the following XAML into the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[3527,3637],"source":"Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element."},{"content":"Press F5 to build and run the application.","pos":[3801,3843]},{"content":"The                                  <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph><ph id=\"ph2\">&lt;xref:System.Windows.Forms.Button?displayProperty=fullName&gt;</ph> control appears in the                                  <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Canvas&gt;</ph>.","pos":[3844,4112],"source":" The                                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]<xref:System.Windows.Forms.Button?displayProperty=fullName> control appears in the                                  <xref:System.Windows.Controls.Canvas>."},{"content":"The hosted control is sized based on its content, and the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element is sized to accommodate the hosted control.","pos":[4113,4312],"source":" The hosted control is sized based on its content, and the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is sized to accommodate the hosted control."},{"pos":[4321,4338],"content":"Sizing to Content","linkify":"Sizing to Content","nodes":[{"content":"Sizing to Content","pos":[0,17]}]},{"content":"The                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element ensures that the hosted control is sized to display its content properly.","pos":[4342,4501],"source":"The                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element ensures that the hosted control is sized to display its content properly."},{"pos":[4512,4530],"content":"To size to content","linkify":"To size to content","nodes":[{"content":"To size to content","pos":[0,18]}]},{"content":"Copy the following XAML into the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[4540,4650],"source":"Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element."},{"content":"Press F5 to build and run the application.","pos":[4814,4856]},{"content":"The two new button controls are sized to display the longer text string and larger font size properly, and the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> elements are resized to accommodate the hosted controls.","pos":[4857,5114],"source":" The two new button controls are sized to display the longer text string and larger font size properly, and the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> elements are resized to accommodate the hosted controls."},{"pos":[5123,5149],"content":"Using Absolute Positioning","linkify":"Using Absolute Positioning","nodes":[{"content":"Using Absolute Positioning","pos":[0,26]}]},{"content":"You can use absolute positioning to place the                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element anywhere in the user interface (UI).","pos":[5153,5317],"source":"You can use absolute positioning to place the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element anywhere in the user interface (UI)."},{"pos":[5328,5355],"content":"To use absolute positioning","linkify":"To use absolute positioning","nodes":[{"content":"To use absolute positioning","pos":[0,27]}]},{"content":"Copy the following XAML into the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[5365,5475],"source":"Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element."},{"content":"Press F5 to build and run the application.","pos":[5639,5681]},{"content":"The                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element is placed 20 pixels from the top side of the grid cell and 20 pixels from the left.","pos":[5682,5867],"source":" The                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is placed 20 pixels from the top side of the grid cell and 20 pixels from the left."},{"pos":[5876,5902],"content":"Specifying Size Explicitly","linkify":"Specifying Size Explicitly","nodes":[{"content":"Specifying Size Explicitly","pos":[0,26]}]},{"content":"You can specify the size of the                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element using the                  <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement.Width%2A&gt;</ph> and                  <ph id=\"ph3\">&lt;xref:System.Windows.FrameworkElement.Height%2A&gt;</ph> properties.","pos":[5906,6176],"source":"You can specify the size of the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element using the                  <xref:System.Windows.FrameworkElement.Width%2A> and                  <xref:System.Windows.FrameworkElement.Height%2A> properties."},{"pos":[6187,6213],"content":"To specify size explicitly","linkify":"To specify size explicitly","nodes":[{"content":"To specify size explicitly","pos":[0,26]}]},{"content":"Copy the following XAML into the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[6223,6333],"source":"Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element."},{"content":"Press F5 to build and run the application.","pos":[6497,6539]},{"content":"The                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element is set to a size of 50 pixels wide by 70 pixels high, which is smaller than the default layout settings.","pos":[6540,6746],"source":" The                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is set to a size of 50 pixels wide by 70 pixels high, which is smaller than the default layout settings."},{"content":"The content of the                                  <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> control is rearranged accordingly.","pos":[6747,6911],"source":" The content of the                                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control is rearranged accordingly."},{"pos":[6920,6945],"content":"Setting Layout Properties","linkify":"Setting Layout Properties","nodes":[{"content":"Setting Layout Properties","pos":[0,25]}]},{"content":"Always set layout-related properties on the hosted control by using the properties of the                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element.","pos":[6949,7121],"source":"Always set layout-related properties on the hosted control by using the properties of the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element."},{"content":"Setting layout properties directly on the hosted control will yield unintended results.","pos":[7122,7209]},{"pos":[7216,7378],"content":"Setting layout-related properties on the hosted control in                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> has no effect.","source":"Setting layout-related properties on the hosted control in                  [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] has no effect."},{"pos":[7389,7451],"content":"To see the effects of setting properties on the hosted control","linkify":"To see the effects of setting properties on the hosted control","nodes":[{"content":"To see the effects of setting properties on the hosted control","pos":[0,62]}]},{"content":"Copy the following XAML into the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[7461,7571],"source":"Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element."},{"content":"In Solution Explorer, double-click MainWindow.xaml.","pos":[7735,7786]},{"content":"vb or MainWindow.xaml.cs to open it in the Code Editor.","pos":[7787,7842]},{"pos":[7852,7948],"content":"Copy the following code into the                                  <ph id=\"ph1\">`MainWindow`</ph> class definition.","source":"Copy the following code into the                                  `MainWindow` class definition."},{"pos":[7959,8277],"content":"[!code-csharp[WpfLayoutHostingWfWithXaml#101](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml.cs#101)]\n [!code-vb[WpfLayoutHostingWfWithXaml#101](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/VisualBasic/Window1.xaml.vb#101)]","leadings":["","    "],"nodes":[]},{"content":"Press F5 to build and run the application.","pos":[8287,8329]},{"content":"Click the                                  <bpt id=\"p1\">**</bpt>Click me<ept id=\"p1\">**</ept> button.","pos":[8339,8402],"source":"Click the                                  **Click me** button."},{"content":"The                                  <ph id=\"ph1\">`button1_Click`</ph> event handler sets the                                  <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Top%2A&gt;</ph> and                                  <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Control.Left%2A&gt;</ph> properties on the hosted control.","pos":[8403,8669],"source":" The                                  `button1_Click` event handler sets the                                  <xref:System.Windows.Forms.Control.Top%2A> and                                  <xref:System.Windows.Forms.Control.Left%2A> properties on the hosted control."},{"content":"This causes the hosted control to be repositioned within the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element.","pos":[8670,8829],"source":" This causes the hosted control to be repositioned within the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element."},{"content":"The host maintains the same screen area, but the hosted control is clipped.","pos":[8863,8938]},{"content":"Instead, the hosted control should always fill the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element.","pos":[8939,9088],"source":" Instead, the hosted control should always fill the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element."},{"pos":[9097,9130],"content":"Understanding Z-Order Limitations","linkify":"Understanding Z-Order Limitations","nodes":[{"content":"Understanding Z-Order Limitations","pos":[0,33]}]},{"content":"By default, visible                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> elements are always drawn on top of other                  <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> elements, and they are unaffected by z-order.","pos":[9134,9414],"source":"By default, visible                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> elements are always drawn on top of other                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements, and they are unaffected by z-order."},{"content":"To enable z-ordering, set the                  <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndHost.IsRedirected%2A&gt;</ph> property of the                  <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> to true and the                  <ph id=\"ph3\">&lt;xref:System.Windows.Interop.HwndHost.CompositionMode%2A&gt;</ph> property to                  <ph id=\"ph4\">&lt;xref:System.Windows.Interop.CompositionMode.Full&gt;</ph> or                  <ph id=\"ph5\">&lt;xref:System.Windows.Interop.CompositionMode.OutputOnly&gt;</ph>.","pos":[9415,9855],"source":" To enable z-ordering, set the                  <xref:System.Windows.Interop.HwndHost.IsRedirected%2A> property of the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> to true and the                  <xref:System.Windows.Interop.HwndHost.CompositionMode%2A> property to                  <xref:System.Windows.Interop.CompositionMode.Full> or                  <xref:System.Windows.Interop.CompositionMode.OutputOnly>."},{"pos":[9866,9901],"content":"To see the default z-order behavior","linkify":"To see the default z-order behavior","nodes":[{"content":"To see the default z-order behavior","pos":[0,35]}]},{"content":"Copy the following XAML into the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[9911,10021],"source":"Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element."},{"content":"Press F5 to build and run the application.","pos":[10185,10227]},{"content":"The                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element is painted over the label element.","pos":[10228,10364],"source":" The                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is painted over the label element."},{"pos":[10375,10428],"content":"To see the z-order behavior when IsRedirected is true","linkify":"To see the z-order behavior when IsRedirected is true","nodes":[{"content":"To see the z-order behavior when IsRedirected is true","pos":[0,53]}]},{"content":"Replace the previous z-order                                  example with the following XAML.","pos":[10438,10532]},{"content":"Press F5 to build and run the application.","pos":[10709,10751]},{"content":"The label element is painted over the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element.","pos":[10752,10888],"source":" The label element is painted over the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element."},{"pos":[10897,10904],"content":"Docking","linkify":"Docking","nodes":[{"content":"Docking","pos":[0,7]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element supports                  <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> docking.","pos":[10908,11089],"source":"<xref:System.Windows.Forms.Integration.WindowsFormsHost> element supports                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] docking."},{"content":"Set the                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel.Dock%2A&gt;</ph> attached property to dock the hosted control in a                  <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> element.","pos":[11090,11280],"source":" Set the                  <xref:System.Windows.Controls.DockPanel.Dock%2A> attached property to dock the hosted control in a                  <xref:System.Windows.Controls.DockPanel> element."},{"pos":[11291,11315],"content":"To dock a hosted control","linkify":"To dock a hosted control","nodes":[{"content":"To dock a hosted control","pos":[0,24]}]},{"content":"Copy the following XAML into the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[11325,11435],"source":"Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element."},{"content":"Press F5 to build and run the application.","pos":[11599,11641]},{"content":"The                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element is docked to the right side of the                                  <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph> element.","pos":[11642,11861],"source":" The                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is docked to the right side of the                                  <xref:System.Windows.Controls.DockPanel> element."},{"pos":[11870,11888],"content":"Setting Visibility","linkify":"Setting Visibility","nodes":[{"content":"Setting Visibility","pos":[0,18]}]},{"content":"You can make your                  <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> control invisible or collapse it by setting the                  <ph id=\"ph2\">&lt;xref:System.Windows.UIElement.Visibility%2A&gt;</ph> property on the                  <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element.","pos":[11892,12214],"source":"You can make your                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control invisible or collapse it by setting the                  <xref:System.Windows.UIElement.Visibility%2A> property on the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element."},{"content":"When a control is invisible, it is not displayed, but it occupies layout space.","pos":[12215,12294]},{"content":"When a control is collapsed, it is not displayed, nor does it occupy layout space.","pos":[12295,12377]},{"pos":[12388,12429],"content":"To set the visibility of a hosted control","linkify":"To set the visibility of a hosted control","nodes":[{"content":"To set the visibility of a hosted control","pos":[0,41]}]},{"content":"Copy the following XAML into the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[12439,12549],"source":"Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element."},{"content":"In MainWindow.xaml.vb or MainWindow.xaml.cs, copy the following code into the class definition.","pos":[12715,12810]},{"pos":[12821,13139],"content":"[!code-csharp[WpfLayoutHostingWfWithXaml#102](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml.cs#102)]\n [!code-vb[WpfLayoutHostingWfWithXaml#102](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/VisualBasic/Window1.xaml.vb#102)]","leadings":["","    "],"nodes":[]},{"content":"Press F5 to build and run the application.","pos":[13149,13191]},{"pos":[13201,13399],"content":"Click the                                  <bpt id=\"p1\">**</bpt>Click to make invisible<ept id=\"p1\">**</ept> button to make the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element invisible.","source":"Click the                                  **Click to make invisible** button to make the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element invisible."},{"content":"Click the                                  <bpt id=\"p1\">**</bpt>Click to collapse<ept id=\"p1\">**</ept> button to hide the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element from the layout entirely.","pos":[13409,13616],"source":"Click the                                  **Click to collapse** button to hide the                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element from the layout entirely."},{"content":"When the                                  <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> control is collapsed, the surrounding elements are rearranged to occupy its space.","pos":[13617,13819],"source":" When the                                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control is collapsed, the surrounding elements are rearranged to occupy its space."},{"pos":[13828,13867],"content":"Hosting a Control That Does Not Stretch","linkify":"Hosting a Control That Does Not Stretch","nodes":[{"content":"Hosting a Control That Does Not Stretch","pos":[0,39]}]},{"content":"Some                  <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls have a fixed size and do not stretch to fill available space in the layout.","pos":[13871,14055],"source":"Some                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls have a fixed size and do not stretch to fill available space in the layout."},{"content":"For example, the                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MonthCalendar&gt;</ph> control displays a month in a fixed space.","pos":[14056,14174],"source":" For example, the                  <xref:System.Windows.Forms.MonthCalendar> control displays a month in a fixed space."},{"pos":[14185,14224],"content":"To host a control that does not stretch","linkify":"To host a control that does not stretch","nodes":[{"content":"To host a control that does not stretch","pos":[0,39]}]},{"content":"Copy the following XAML into the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[14234,14344],"source":"Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element."},{"content":"Press F5 to build and run the application.","pos":[14510,14552]},{"content":"The                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element is centered in the grid row, but it is not stretched to fill the available space.","pos":[14553,14736],"source":" The                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is centered in the grid row, but it is not stretched to fill the available space."},{"content":"If the window is large enough, you may see two or more months displayed by the hosted                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MonthCalendar&gt;</ph> control, but these are centered in the row.","pos":[14737,14941],"source":" If the window is large enough, you may see two or more months displayed by the hosted                                  <xref:System.Windows.Forms.MonthCalendar> control, but these are centered in the row."},{"content":"The                                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> layout engine centers elements that cannot be sized to fill the available space.","pos":[14942,15141],"source":" The                                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layout engine centers elements that cannot be sized to fill the available space."},{"pos":[15150,15157],"content":"Scaling","linkify":"Scaling","nodes":[{"content":"Scaling","pos":[0,7]}]},{"content":"Unlike <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> elements, most <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls are not continuously scalable.","pos":[15161,15382],"source":"Unlike [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements, most [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls are not continuously scalable."},{"content":"By default, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element scales its hosted control when possible.","pos":[15383,15504],"source":" By default, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element scales its hosted control when possible."},{"content":"To enable full-fledged scaling, set the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndHost.IsRedirected%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> to true and the <ph id=\"ph3\">&lt;xref:System.Windows.Interop.HwndHost.CompositionMode%2A&gt;</ph> property to                  <ph id=\"ph4\">&lt;xref:System.Windows.Interop.CompositionMode.Full&gt;</ph> or <ph id=\"ph5\">&lt;xref:System.Windows.Interop.CompositionMode.OutputOnly&gt;</ph>.","pos":[15506,15888],"source":"  To enable full-fledged scaling, set the <xref:System.Windows.Interop.HwndHost.IsRedirected%2A> property of the <xref:System.Windows.Forms.Integration.WindowsFormsHost> to true and the <xref:System.Windows.Interop.HwndHost.CompositionMode%2A> property to                  <xref:System.Windows.Interop.CompositionMode.Full> or <xref:System.Windows.Interop.CompositionMode.OutputOnly>."},{"pos":[15899,15954],"content":"To scale a hosted control by using the default behavior","linkify":"To scale a hosted control by using the default behavior","nodes":[{"content":"To scale a hosted control by using the default behavior","pos":[0,55]}]},{"content":"Copy the following XAML into the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[15964,16041],"source":"Copy the following XAML into the <xref:System.Windows.Controls.Grid> element."},{"content":"Press F5 to build and run the application.","pos":[16207,16249]},{"content":"The hosted control and its surrounding elements are scaled by a factor of 0.5.","pos":[16250,16328]},{"content":"However, the hosted control's font is not scaled.","pos":[16329,16378]},{"pos":[16389,16446],"content":"To scale a hosted control by setting IsRedirected to true","linkify":"To scale a hosted control by setting IsRedirected to true","nodes":[{"content":"To scale a hosted control by setting IsRedirected to true","pos":[0,57]}]},{"content":"Replace the previous scaling example with the following XAML.","pos":[16456,16517]},{"content":"Press F5 to build and run the application.","pos":[16695,16737]},{"content":"The hosted control, its surrounding elements, and the hosted control's font are scaled by a factor of 0.5.","pos":[16738,16844]},{"pos":[16853,16861],"content":"Rotating","linkify":"Rotating","nodes":[{"content":"Rotating","pos":[0,8]}]},{"content":"Unlike                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> elements,                  <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls do not support rotation.","pos":[16865,17109],"source":"Unlike                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements,                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls do not support rotation."},{"content":"By default, the                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element does not rotate with other                  <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> elements when a rotation transformation is applied.","pos":[17110,17385],"source":" By default, the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element does not rotate with other                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements when a rotation transformation is applied."},{"content":"Any rotation value other than 180 degrees raises the                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost.LayoutError&gt;</ph> event.","pos":[17386,17531],"source":" Any rotation value other than 180 degrees raises the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost.LayoutError> event."},{"content":"To enable rotating to any angle, set the                  <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndHost.IsRedirected%2A&gt;</ph> property of the                  <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> to true and the                  <ph id=\"ph3\">&lt;xref:System.Windows.Interop.HwndHost.CompositionMode%2A&gt;</ph> property to                  <ph id=\"ph4\">&lt;xref:System.Windows.Interop.CompositionMode.Full&gt;</ph> or                  <ph id=\"ph5\">&lt;xref:System.Windows.Interop.CompositionMode.OutputOnly&gt;</ph>.","pos":[17533,17984],"source":"  To enable rotating to any angle, set the                  <xref:System.Windows.Interop.HwndHost.IsRedirected%2A> property of the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> to true and the                  <xref:System.Windows.Interop.HwndHost.CompositionMode%2A> property to                  <xref:System.Windows.Interop.CompositionMode.Full> or                  <xref:System.Windows.Interop.CompositionMode.OutputOnly>."},{"pos":[17995,18048],"content":"To see the effect of rotation in a hybrid application","linkify":"To see the effect of rotation in a hybrid application","nodes":[{"content":"To see the effect of rotation in a hybrid application","pos":[0,53]}]},{"content":"Copy the following XAML into the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[18058,18168],"source":"Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element."},{"content":"Press F5 to build and run the application.","pos":[18334,18376]},{"content":"The hosted control is not rotated, but its surrounding elements are rotated by an angle of 180 degrees.","pos":[18377,18480]},{"content":"You may have to resize the window to see the elements.","pos":[18481,18535]},{"pos":[18546,18625],"content":"To see the effect of rotation in a hybrid application when IsRedirected is true","linkify":"To see the effect of rotation in a hybrid application when IsRedirected is true","nodes":[{"content":"To see the effect of rotation in a hybrid application when IsRedirected is true","pos":[0,79]}]},{"content":"Replace the previous rotation example with the following XAML.","pos":[18635,18697]},{"content":"Press F5 to build and run the application.","pos":[18875,18917]},{"content":"The hosted control is rotated.","pos":[18918,18948]},{"content":"Note that the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Media.RotateTransform.Angle%2A&gt;</ph> property can be set to any value.","pos":[18950,19083],"source":"  Note that the                                  <xref:System.Windows.Media.RotateTransform.Angle%2A> property can be set to any value."},{"content":"You may have to resize the window to see the elements.","pos":[19084,19138]},{"pos":[19147,19174],"content":"Setting Padding and Margins","linkify":"Setting Padding and Margins","nodes":[{"content":"Setting Padding and Margins","pos":[0,27]}]},{"content":"Padding and margins in                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> layout are similar to padding and margins in                  <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph>.","pos":[19178,19440],"source":"Padding and margins in                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layout are similar to padding and margins in                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]."},{"content":"Simply set the                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Control.Padding%2A&gt;</ph> and                  <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement.Margin%2A&gt;</ph> properties on the                  <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element.","pos":[19441,19693],"source":" Simply set the                  <xref:System.Windows.Controls.Control.Padding%2A> and                  <xref:System.Windows.FrameworkElement.Margin%2A> properties on the                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element."},{"pos":[19704,19751],"content":"To set padding and margins for a hosted control","linkify":"To set padding and margins for a hosted control","nodes":[{"content":"To set padding and margins for a hosted control","pos":[0,47]}]},{"content":"Copy the following XAML into the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[19761,19871],"source":"Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element."},{"pos":[19882,20179],"content":"[!code-xml[WpfLayoutHostingWfWithXaml#14](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#14)]  \n[!code-xml[WpfLayoutHostingWfWithXaml#15](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml#15)]","leadings":["","    "],"nodes":[]},{"content":"Press F5 to build and run the application.","pos":[20189,20231]},{"content":"The padding and margin settings are applied to the hosted                                  <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls in the same way they would be applied in                                  <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph>.","pos":[20232,20562],"source":" The padding and margin settings are applied to the hosted                                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls in the same way they would be applied in                                  [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]."},{"pos":[20571,20602],"content":"Using Dynamic Layout Containers","linkify":"Using Dynamic Layout Containers","nodes":[{"content":"Using Dynamic Layout Containers","pos":[0,31]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> provides two dynamic layout containers,                  <ph id=\"ph2\">&lt;xref:System.Windows.Forms.FlowLayoutPanel&gt;</ph> and                  <ph id=\"ph3\">&lt;xref:System.Windows.Forms.TableLayoutPanel&gt;</ph>.","pos":[20606,20851],"source":"[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] provides two dynamic layout containers,                  <xref:System.Windows.Forms.FlowLayoutPanel> and                  <xref:System.Windows.Forms.TableLayoutPanel>."},{"content":"You can also use these containers in                  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> layouts.","pos":[20852,20996],"source":" You can also use these containers in                  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layouts."},{"pos":[21007,21040],"content":"To use a dynamic layout container","linkify":"To use a dynamic layout container","nodes":[{"content":"To use a dynamic layout container","pos":[0,33]}]},{"content":"Copy the following XAML into the                                  <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element.","pos":[21050,21160],"source":"Copy the following XAML into the                                  <xref:System.Windows.Controls.Grid> element."},{"content":"In MainWindow.xaml.vb or MainWindow.xaml.cs copy the following code into the class definition.","pos":[21326,21420]},{"pos":[21431,21749],"content":"[!code-csharp[WpfLayoutHostingWfWithXaml#103](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml.cs#103)]\n [!code-vb[WpfLayoutHostingWfWithXaml#103](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/VisualBasic/Window1.xaml.vb#103)]","leadings":["","    "],"nodes":[]},{"pos":[21759,21864],"content":"Add a call to the                                  <ph id=\"ph1\">`InitializeFlowLayoutPanel`</ph> method in the constructor.","source":"Add a call to the                                  `InitializeFlowLayoutPanel` method in the constructor."},{"pos":[21875,22193],"content":"[!code-csharp[WpfLayoutHostingWfWithXaml#104](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/CSharp/Window1.xaml.cs#104)]\n [!code-vb[WpfLayoutHostingWfWithXaml#104](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WpfLayoutHostingWfWithXaml/VisualBasic/Window1.xaml.vb#104)]","leadings":["","    "],"nodes":[]},{"content":"Press F5 to build and run the application.","pos":[22203,22245]},{"content":"The                                  <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element fills the                                  <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DockPanel&gt;</ph>, and                                  <ph id=\"ph3\">&lt;xref:System.Windows.Forms.FlowLayoutPanel&gt;</ph> arranges its child controls in the default                                  <ph id=\"ph4\">&lt;xref:System.Windows.Forms.FlowLayoutPanel.FlowDirection%2A&gt;</ph>.","pos":[22246,22651],"source":" The                                  <xref:System.Windows.Forms.Integration.WindowsFormsHost> element fills the                                  <xref:System.Windows.Controls.DockPanel>, and                                  <xref:System.Windows.Forms.FlowLayoutPanel> arranges its child controls in the default                                  <xref:System.Windows.Forms.FlowLayoutPanel.FlowDirection%2A>."},{"pos":[22660,22668],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph>","pos":[22672,22723],"source":"<xref:System.Windows.Forms.Integration.ElementHost> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph>","pos":[22728,22784],"source":"<xref:System.Windows.Forms.Integration.WindowsFormsHost> "},{"content":"<bpt id=\"p1\">[</bpt>WPF Designer<ept id=\"p1\">](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26)</ept><ph id=\"ph1\"> </ph>","pos":[22789,22874],"source":"[WPF Designer](http://msdn.microsoft.com/en-us/c6c65214-8411-4e16-b254-163ed4099c26) "},{"content":"<bpt id=\"p1\">[</bpt>Layout Considerations for the WindowsFormsHost Element<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/layout-considerations-for-the-windowsformshost-element.md)</ept><ph id=\"ph1\"> </ph>","pos":[22878,23034],"source":"[Layout Considerations for the WindowsFormsHost Element](../../../../docs/framework/wpf/advanced/layout-considerations-for-the-windowsformshost-element.md) "},{"content":"<bpt id=\"p1\">[</bpt>Arranging Windows Forms Controls in WPF Sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=159971)</ept><ph id=\"ph1\"> </ph>","pos":[23038,23134],"source":"[Arranging Windows Forms Controls in WPF Sample](http://go.microsoft.com/fwlink/?LinkID=159971) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Composite Control in WPF<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)</ept><ph id=\"ph1\"> </ph>","pos":[23138,23307],"source":"[Walkthrough: Hosting a Windows Forms Composite Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md) "},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a WPF Composite Control in Windows Forms<ept id=\"p1\">](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)</ept>","pos":[23311,23479],"source":"[Walkthrough: Hosting a WPF Composite Control in Windows Forms](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)"}]}