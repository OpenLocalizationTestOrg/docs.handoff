{"content":"---\ntitle: \"overlappedFreeError MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"OverlappedFreeError MDA\"\n  - \"overlapped free method call error\"\n  - \"managed debugging assistants (MDAs), overlapped structures\"\n  - \"overlapped structures\"\n  - \"MDAs (managed debugging assistants), overlapped structures\"\n  - \"freeing overlapped structures\"\nms.assetid: b6ab2d48-6eee-4bab-97a3-046b3b0a5470\ncaps.latest.revision: 8\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# overlappedFreeError MDA\nThe `overlappedFreeError` managed debugging assistant (MDA) is activated when the <xref:System.Threading.Overlapped.Free%28System.Threading.NativeOverlapped%2A%29?displayProperty=fullName> method is called before the overlapped operation has completed.  \n  \n## Symptoms  \n Access violations or corruption of the garbage-collected heap.  \n  \n## Cause  \n An overlapped structure was freed before the operation completed. The function that is using the overlapped pointer might write to the structure later, after it has been freed. That can cause heap corruption because another object might now occupy that region.  \n  \n This MDA might not represent an error if the overlapped operation did not start successfully.  \n  \n## Resolution  \n Ensure that the I/O operation using the overlapped structure has completed before calling the <xref:System.Threading.Overlapped.Free%28System.Threading.NativeOverlapped%2A%29> method.  \n  \n## Effect on the Runtime  \n This MDA has no effect on the CLR.  \n  \n## Output  \n The following is sample output for this MDA.  \n  \n `An overlapped pointer (0x00ea3430) that was not allocated on the GC heap was passed via Pinvoke to the win32 function 'WriteFile' in module 'KERNEL32.DLL'. If the AppDomain is shut down, this can cause heap corruption when the async I/O completes. The best solution is to pass a NativeOverlappedStructure retrieved from a call to System.Threading.Overlapped.Pack(). If the AppDomain exits, the CLR will keep this structure alive and pinned until the I/O completes.`  \n  \n## Configuration  \n  \n```  \n<mdaConfig>  \n  <assistants>  \n    <overlappedFreeError/>  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## See Also  \n <xref:System.Runtime.InteropServices.MarshalAsAttribute>   \n [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)   \n [Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)","nodes":[{"pos":[4,688],"nodes":[{"content":"overlappedFreeError MDA | Microsoft Docs","nodes":[{"pos":[0,40],"content":"overlappedFreeError MDA | Microsoft Docs","nodes":[{"content":"overlappedFreeError MDA | Microsoft Docs","pos":[0,40]}]}],"pos":[6,49],"yaml":true}],"content":"title: \"overlappedFreeError MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"OverlappedFreeError MDA\"\n  - \"overlapped free method call error\"\n  - \"managed debugging assistants (MDAs), overlapped structures\"\n  - \"overlapped structures\"\n  - \"MDAs (managed debugging assistants), overlapped structures\"\n  - \"freeing overlapped structures\"\nms.assetid: b6ab2d48-6eee-4bab-97a3-046b3b0a5470\ncaps.latest.revision: 8\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[695,718],"content":"overlappedFreeError MDA","linkify":"overlappedFreeError MDA","nodes":[{"content":"overlappedFreeError MDA","pos":[0,23]}]},{"pos":[719,971],"content":"The <ph id=\"ph1\">`overlappedFreeError`</ph> managed debugging assistant (MDA) is activated when the <ph id=\"ph2\">&lt;xref:System.Threading.Overlapped.Free%28System.Threading.NativeOverlapped%2A%29?displayProperty=fullName&gt;</ph> method is called before the overlapped operation has completed.","source":"The `overlappedFreeError` managed debugging assistant (MDA) is activated when the <xref:System.Threading.Overlapped.Free%28System.Threading.NativeOverlapped%2A%29?displayProperty=fullName> method is called before the overlapped operation has completed."},{"pos":[980,988],"content":"Symptoms","linkify":"Symptoms","nodes":[{"content":"Symptoms","pos":[0,8]}]},{"content":"Access violations or corruption of the garbage-collected heap.","pos":[992,1054]},{"pos":[1063,1068],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"content":"An overlapped structure was freed before the operation completed.","pos":[1072,1137]},{"content":"The function that is using the overlapped pointer might write to the structure later, after it has been freed.","pos":[1138,1248]},{"content":"That can cause heap corruption because another object might now occupy that region.","pos":[1249,1332]},{"content":"This MDA might not represent an error if the overlapped operation did not start successfully.","pos":[1339,1432]},{"pos":[1441,1451],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"content":"Ensure that the I/O operation using the overlapped structure has completed before calling the <ph id=\"ph1\">&lt;xref:System.Threading.Overlapped.Free%28System.Threading.NativeOverlapped%2A%29&gt;</ph> method.","pos":[1455,1638],"source":"Ensure that the I/O operation using the overlapped structure has completed before calling the <xref:System.Threading.Overlapped.Free%28System.Threading.NativeOverlapped%2A%29> method."},{"pos":[1647,1668],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"content":"This MDA has no effect on the CLR.","pos":[1672,1706]},{"pos":[1715,1721],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"The following is sample output for this MDA.","pos":[1725,1769]},{"pos":[2251,2264],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[2381,2389],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.MarshalAsAttribute&gt;</ph>","pos":[2393,2449],"source":"<xref:System.Runtime.InteropServices.MarshalAsAttribute> "},{"content":"<bpt id=\"p1\">[</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept><ph id=\"ph1\"> </ph>","pos":[2454,2608],"source":"[Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md) "},{"content":"<bpt id=\"p1\">[</bpt>Interop Marshaling<ept id=\"p1\">](../../../docs/framework/interop/interop-marshaling.md)</ept>","pos":[2612,2687],"source":"[Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)"}]}