{"content":"---\ntitle: \"How to: Run Procedures at Set Intervals with the Windows Forms Timer Component | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"examples [Windows Forms], timers\"\n  - \"timers, event intervals\"\n  - \"initialization, Timer components\"\n  - \"timers, Windows-based\"\n  - \"Timer component [Windows Forms], initializing\"\n  - \"procedures, specific time intervals\"\nms.assetid: 8025247a-2de4-4d86-b8ab-a8cb8aeab2ea\ncaps.latest.revision: 20\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Run Procedures at Set Intervals with the Windows Forms Timer Component\nYou might sometimes want to create a procedure that runs at specific time intervals until a loop has finished or that runs when a set time interval has elapsed. The <xref:System.Windows.Forms.Timer> component makes such a procedure possible.  \n  \n This component is designed for a Windows Forms environment. If you need a timer that is suitable for a server environment, see [Introduction to Server-Based Timers](http://msdn.microsoft.com/en-us/adc0bc0a-a519-4812-bafc-fb9d1a5801fc).  \n  \n> [!NOTE]\n>  There are some limitations when using the <xref:System.Windows.Forms.Timer> component. For more information, see [Limitations of the Windows Forms Timer Component's Interval Property](../../../../docs/framework/winforms/controls/limitations-of-the-timer-component-interval-property.md).  \n  \n### To run a procedure at set intervals with the Timer component  \n  \n1.  Add a <xref:System.Windows.Forms.Timer> to your form. See the following Example section for an illustration of how to do this programmatically. [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] also has support for adding components to a form. Also see [How to: Add Controls Without a User Interface to Windows Forms](http://msdn.microsoft.com/library/becyw7bz\\(v=vs.110\\)).  \n  \n2.  Set the <xref:System.Windows.Forms.Timer.Interval%2A> property (in milliseconds) for the timer. This property determines how much time will pass before the procedure is run again.  \n  \n    > [!NOTE]\n    >  The more often a timer event occurs, the more processor time is used in responding to the event. This can slow down overall performance. Do not set a smaller interval than you need.  \n  \n3.  Write appropriate code in the <xref:System.Windows.Forms.Timer.Tick> event handler. The code you write in this event will run at the interval specified in the <xref:System.Windows.Forms.Timer.Interval%2A> property.  \n  \n4.  Set the <xref:System.Windows.Forms.Timer.Enabled%2A> property to `true` to start the timer. The <xref:System.Windows.Forms.Timer.Tick> event will begin to occur, running your procedure at the set interval.  \n  \n5.  At the appropriate time, set the <xref:System.Windows.Forms.Timer.Enabled%2A> property to `false` to stop the procedure from running again. Setting the interval to `0` does not cause the timer to stop.  \n  \n## Example  \n This first code example tracks the time of day in one-second increments. It uses a <xref:System.Windows.Forms.Button>, a <xref:System.Windows.Forms.Label>, and a <xref:System.Windows.Forms.Timer> component on a form. The <xref:System.Windows.Forms.Timer.Interval%2A> property is set to 1000 (equal to one second). In the <xref:System.Windows.Forms.Timer.Tick> event, the label's caption is set to the current time. When the button is clicked, the <xref:System.Windows.Forms.Timer.Enabled%2A> property is set to `false`, stopping the timer from updating the label's caption. The following code example requires that you have a form with a <xref:System.Windows.Forms.Button> control named`Button1`, a <xref:System.Windows.Forms.Timer> control named`Timer1`, and a <xref:System.Windows.Forms.Label> control named`Label1`.  \n  \n```vb  \nPrivate Sub InitializeTimer()  \n   ' Run this procedure in an appropriate event.  \n   ' Set to 1 second.  \n   Timer1.Interval = 1000  \n   ' Enable timer.  \n   Timer1.Enabled = True  \n   Button1.Text = \"Enabled\"  \nEnd Sub  \nx  \nPrivate Sub Timer1_Tick(ByVal Sender As Object, ByVal e As EventArgs) Handles Timer1.Tick  \n' Set the caption to the current time.  \n   Label1.Text = DateTime.Now  \nEnd Sub  \n  \nPrivate Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click  \n      If Button1.Text = \"Stop\" Then  \n         Button1.Text = \"Start\"  \n         Timer1.Enabled = False  \n      Else  \n         Button1.Text = \"Stop\"  \n         Timer1.Enabled = True  \n      End If  \nEnd Sub  \n  \n```  \n  \n```csharp  \nprivate void InitializeTimer()  \n{  \n    // Call this procedure when the application starts.  \n    // Set to 1 second.  \n    Timer1.Interval = 1000;  \n    Timer1.Tick += new EventHandler(Timer1_Tick);  \n  \n    // Enable timer.  \n    Timer1.Enabled = true;  \n  \n    Button1.Text = \"Stop\";  \n    Button1.Click += new EventHandler(Button1_Click);  \n}  \n  \nprivate void Timer1_Tick(object Sender, EventArgs e)     \n{  \n   // Set the caption to the current time.  \n   Label1.Text = DateTime.Now.ToString();  \n}  \n  \nprivate void Button1_Click(object sender, EventArgs e)  \n{  \n  if ( Button1.Text == \"Stop\" )  \n  {  \n    Button1.Text = \"Start\";  \n    Timer1.Enabled = false;  \n  }  \n  else  \n  {  \n    Button1.Text = \"Stop\";  \n    Timer1.Enabled = true;  \n  }  \n}  \n  \n```  \n  \n```cpp  \nprivate:  \n   void InitializeTimer()  \n   {  \n      // Run this procedure in an appropriate event.  \n      // Set to 1 second.  \n      timer1->Interval = 1000;  \n      // Enable timer.  \n      timer1->Enabled = true;  \n      this->timer1->Tick += gcnew System::EventHandler(this,    \n                               &Form1::timer1_Tick);  \n  \n      button1->Text = S\"Stop\";  \n      this->button1->Click += gcnew System::EventHandler(this,   \n                               &Form1::button1_Click);  \n   }  \n  \n   void timer1_Tick(System::Object ^ sender,  \n      System::EventArgs ^ e)  \n   {  \n      // Set the caption to the current time.  \n      label1->Text = DateTime::Now.ToString();  \n   }  \n  \n   void button1_Click(System::Object ^ sender,  \n      System::EventArgs ^ e)  \n   {  \n      if ( button1->Text == \"Stop\" )  \n      {  \n         button1->Text = \"Start\";  \n         timer1->Enabled = false;  \n      }  \n      else  \n      {  \n         button1->Text = \"Stop\";  \n         timer1->Enabled = true;  \n      }  \n   }  \n  \n```  \n  \n## Example  \n This second code example runs a procedure every 600 milliseconds until a loop has finished. The following code example requires that you have a form with a <xref:System.Windows.Forms.Button> control named`Button1`, a <xref:System.Windows.Forms.Timer> control named`Timer1`, and a <xref:System.Windows.Forms.Label> control named`Label1`.  \n  \n```vb  \n' This variable will be the loop counter.  \nPrivate counter As Integer  \n  \nPrivate Sub InitializeTimer()  \n   ' Run this procedure in an appropriate event.  \n   counter = 0  \n   Timer1.Interval = 600  \n   Timer1.Enabled = True  \nEnd Sub  \n  \nPrivate Sub Timer1_Tick(ByVal sender As Object, ByVal e As System.EventArgs) Handles Timer1.Tick  \n   If counter => 10 Then  \n      ' Exit loop code.  \n      Timer1.Enabled = False  \n      counter = 0  \n   Else  \n      ' Run your procedure here.  \n      ' Increment counter.  \n      counter = counter + 1  \n      Label1.Text = \"Procedures Run: \" & counter.ToString  \n   End If  \nEnd Sub  \n  \n```  \n  \n```csharp  \n// This variable will be the loop counter.  \nprivate int counter;  \n  \nprivate void InitializeTimer()  \n{  \n   // Run this procedure in an appropriate event.  \n   counter = 0;  \n   timer1.Interval = 600;  \n   timer1.Enabled = true;  \n   // Hook up timer's tick event handler.  \n   this.timer1.Tick += new System.EventHandler(this.timer1_Tick);  \n}  \n  \nprivate void timer1_Tick(object sender, System.EventArgs e)     \n{  \n   if (counter >= 10)   \n   {  \n      // Exit loop code.  \n      timer1.Enabled = false;  \n      counter = 0;  \n   }  \n   else  \n   {  \n      // Run your procedure here.  \n      // Increment counter.  \n      counter = counter + 1;  \n      label1.Text = \"Procedures Run: \" + counter.ToString();  \n      }  \n}  \n  \n```  \n  \n```cpp  \nprivate:  \n   int counter;  \n  \n   void InitializeTimer()  \n   {  \n      // Run this procedure in an appropriate event.  \n      counter = 0;  \n      timer1->Interval = 600;  \n      timer1->Enabled = true;  \n      // Hook up timer's tick event handler.  \n      this->timer1->Tick += gcnew System::EventHandler(this, &Form1::timer1_Tick);  \n   }  \n  \n   void timer1_Tick(System::Object ^ sender,  \n      System::EventArgs ^ e)  \n   {  \n      if (counter >= 10)   \n      {  \n         // Exit loop code.  \n         timer1->Enabled = false;  \n         counter = 0;  \n      }  \n      else  \n      {  \n         // Run your procedure here.  \n         // Increment counter.  \n         counter = counter + 1;  \n         label1->Text = String::Concat(\"Procedures Run: \",  \n            counter.ToString());  \n      }  \n   }  \n```  \n  \n## See Also  \n <xref:System.Windows.Forms.Timer>   \n [Timer Component](../../../../docs/framework/winforms/controls/timer-component-windows-forms.md)   \n [Timer Component Overview](../../../../docs/framework/winforms/controls/timer-component-overview-windows-forms.md)","nodes":[{"pos":[12,107],"content":"How to: Run Procedures at Set Intervals with the Windows Forms Timer Component | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Run Procedures at Set Intervals with the Windows Forms Timer Component | Microsoft Docs","pos":[0,95]}]},{"pos":[697,775],"content":"How to: Run Procedures at Set Intervals with the Windows Forms Timer Component","linkify":"How to: Run Procedures at Set Intervals with the Windows Forms Timer Component","nodes":[{"content":"How to: Run Procedures at Set Intervals with the Windows Forms Timer Component","pos":[0,78]}]},{"content":"You might sometimes want to create a procedure that runs at specific time intervals until a loop has finished or that runs when a set time interval has elapsed.","pos":[776,936]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer&gt;</ph> component makes such a procedure possible.","pos":[937,1017],"source":" The <xref:System.Windows.Forms.Timer> component makes such a procedure possible."},{"content":"This component is designed for a Windows Forms environment.","pos":[1024,1083]},{"content":"If you need a timer that is suitable for a server environment, see <bpt id=\"p1\">[</bpt>Introduction to Server-Based Timers<ept id=\"p1\">](http://msdn.microsoft.com/en-us/adc0bc0a-a519-4812-bafc-fb9d1a5801fc)</ept>.","pos":[1084,1259],"source":" If you need a timer that is suitable for a server environment, see [Introduction to Server-Based Timers](http://msdn.microsoft.com/en-us/adc0bc0a-a519-4812-bafc-fb9d1a5801fc)."},{"pos":[1267,1564],"content":"[!NOTE]\n There are some limitations when using the <xref:System.Windows.Forms.Timer> component. For more information, see [Limitations of the Windows Forms Timer Component's Interval Property](../../../../docs/framework/winforms/controls/limitations-of-the-timer-component-interval-property.md).","leadings":["","> "],"nodes":[{"content":" There are some limitations when using the <xref:System.Windows.Forms.Timer> component. For more information, see [Limitations of the Windows Forms Timer Component's Interval Property](../../../../docs/framework/winforms/controls/limitations-of-the-timer-component-interval-property.md).","pos":[8,295],"nodes":[{"content":"There are some limitations when using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer&gt;</ph> component.","pos":[1,87],"source":" There are some limitations when using the <xref:System.Windows.Forms.Timer> component."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Limitations of the Windows Forms Timer Component's Interval Property<ept id=\"p1\">](../../../../docs/framework/winforms/controls/limitations-of-the-timer-component-interval-property.md)</ept>.","pos":[88,287],"source":" For more information, see [Limitations of the Windows Forms Timer Component's Interval Property](../../../../docs/framework/winforms/controls/limitations-of-the-timer-component-interval-property.md)."}]}]},{"pos":[1574,1634],"content":"To run a procedure at set intervals with the Timer component","linkify":"To run a procedure at set intervals with the Timer component","nodes":[{"content":"To run a procedure at set intervals with the Timer component","pos":[0,60]}]},{"content":"Add a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer&gt;</ph> to your form.","pos":[1644,1697],"source":"Add a <xref:System.Windows.Forms.Timer> to your form."},{"content":"See the following Example section for an illustration of how to do this programmatically.","pos":[1698,1787]},{"content":"<ph id=\"ph1\">[!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)]</ph> also has support for adding components to a form.","pos":[1788,1891],"source":"[!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] also has support for adding components to a form."},{"content":"Also see <bpt id=\"p1\">[</bpt>How to: Add Controls Without a User Interface to Windows Forms<ept id=\"p1\">](http://msdn.microsoft.com/library/becyw7bz\\(v=vs.110\\))</ept>.","pos":[1892,2022],"source":" Also see [How to: Add Controls Without a User Interface to Windows Forms](http://msdn.microsoft.com/library/becyw7bz\\(v=vs.110\\))."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Interval%2A&gt;</ph> property (in milliseconds) for the timer.","pos":[2032,2127],"source":"Set the <xref:System.Windows.Forms.Timer.Interval%2A> property (in milliseconds) for the timer."},{"content":"This property determines how much time will pass before the procedure is run again.","pos":[2128,2211]},{"pos":[2223,2419],"content":"[!NOTE]\nThe more often a timer event occurs, the more processor time is used in responding to the event. This can slow down overall performance. Do not set a smaller interval than you need.","leadings":["","    >  "],"nodes":[{"content":"The more often a timer event occurs, the more processor time is used in responding to the event. This can slow down overall performance. Do not set a smaller interval than you need.","pos":[8,189],"nodes":[{"content":"The more often a timer event occurs, the more processor time is used in responding to the event.","pos":[0,96]},{"content":"This can slow down overall performance.","pos":[97,136]},{"content":"Do not set a smaller interval than you need.","pos":[137,181]}]}]},{"content":"Write appropriate code in the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Tick&gt;</ph> event handler.","pos":[2429,2512],"source":"Write appropriate code in the <xref:System.Windows.Forms.Timer.Tick> event handler."},{"content":"The code you write in this event will run at the interval specified in the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Interval%2A&gt;</ph> property.","pos":[2513,2643],"source":" The code you write in this event will run at the interval specified in the <xref:System.Windows.Forms.Timer.Interval%2A> property."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Enabled%2A&gt;</ph> property to <ph id=\"ph2\">`true`</ph> to start the timer.","pos":[2653,2744],"source":"Set the <xref:System.Windows.Forms.Timer.Enabled%2A> property to `true` to start the timer."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Tick&gt;</ph> event will begin to occur, running your procedure at the set interval.","pos":[2745,2858],"source":" The <xref:System.Windows.Forms.Timer.Tick> event will begin to occur, running your procedure at the set interval."},{"content":"At the appropriate time, set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Enabled%2A&gt;</ph> property to <ph id=\"ph2\">`false`</ph> to stop the procedure from running again.","pos":[2868,3007],"source":"At the appropriate time, set the <xref:System.Windows.Forms.Timer.Enabled%2A> property to `false` to stop the procedure from running again."},{"content":"Setting the interval to <ph id=\"ph1\">`0`</ph> does not cause the timer to stop.","pos":[3008,3069],"source":" Setting the interval to `0` does not cause the timer to stop."},{"pos":[3078,3085],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This first code example tracks the time of day in one-second increments.","pos":[3089,3161]},{"content":"It uses a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph>, a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Label&gt;</ph>, and a <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Timer&gt;</ph> component on a form.","pos":[3162,3305],"source":" It uses a <xref:System.Windows.Forms.Button>, a <xref:System.Windows.Forms.Label>, and a <xref:System.Windows.Forms.Timer> component on a form."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Interval%2A&gt;</ph> property is set to 1000 (equal to one second).","pos":[3306,3402],"source":" The <xref:System.Windows.Forms.Timer.Interval%2A> property is set to 1000 (equal to one second)."},{"content":"In the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Tick&gt;</ph> event, the label's caption is set to the current time.","pos":[3403,3503],"source":" In the <xref:System.Windows.Forms.Timer.Tick> event, the label's caption is set to the current time."},{"content":"When the button is clicked, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer.Enabled%2A&gt;</ph> property is set to <ph id=\"ph2\">`false`</ph>, stopping the timer from updating the label's caption.","pos":[3504,3662],"source":" When the button is clicked, the <xref:System.Windows.Forms.Timer.Enabled%2A> property is set to `false`, stopping the timer from updating the label's caption."},{"content":"The following code example requires that you have a form with a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> control named<ph id=\"ph2\">`Button1`</ph>, a <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Timer&gt;</ph> control named<ph id=\"ph4\">`Timer1`</ph>, and a <ph id=\"ph5\">&lt;xref:System.Windows.Forms.Label&gt;</ph> control named<ph id=\"ph6\">`Label1`</ph>.","pos":[3663,3907],"source":" The following code example requires that you have a form with a <xref:System.Windows.Forms.Button> control named`Button1`, a <xref:System.Windows.Forms.Timer> control named`Timer1`, and a <xref:System.Windows.Forms.Label> control named`Label1`."},{"pos":[6495,6502],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This second code example runs a procedure every 600 milliseconds until a loop has finished.","pos":[6506,6597]},{"content":"The following code example requires that you have a form with a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> control named<ph id=\"ph2\">`Button1`</ph>, a <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Timer&gt;</ph> control named<ph id=\"ph4\">`Timer1`</ph>, and a <ph id=\"ph5\">&lt;xref:System.Windows.Forms.Label&gt;</ph> control named<ph id=\"ph6\">`Label1`</ph>.","pos":[6598,6842],"source":" The following code example requires that you have a form with a <xref:System.Windows.Forms.Button> control named`Button1`, a <xref:System.Windows.Forms.Timer> control named`Timer1`, and a <xref:System.Windows.Forms.Label> control named`Label1`."},{"pos":[9091,9099],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>Timer Component<ept id=\"p1\">](../../../../docs/framework/winforms/controls/timer-component-windows-forms.md)</ept><ph id=\"ph1\"> </ph>","pos":[9140,9238],"source":" [Timer Component](../../../../docs/framework/winforms/controls/timer-component-windows-forms.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Timer Component Overview<ept id=\"p1\">](../../../../docs/framework/winforms/controls/timer-component-overview-windows-forms.md)</ept>","pos":[9241,9356],"source":" [Timer Component Overview](../../../../docs/framework/winforms/controls/timer-component-overview-windows-forms.md)"}]}