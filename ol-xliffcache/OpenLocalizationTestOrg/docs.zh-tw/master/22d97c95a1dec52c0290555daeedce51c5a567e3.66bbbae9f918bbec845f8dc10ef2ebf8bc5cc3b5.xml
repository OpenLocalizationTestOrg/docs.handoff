{"content":"---\ntitle: \"Finding the Default Paragraph Style (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: 9d094a4a-ec8c-41b0-b7ab-a3deb2a01d45\ncaps.latest.revision: 3\nauthor: dotnet-bot\nms.author: dotnetcontent\n\n---\n# Finding the Default Paragraph Style (Visual Basic)\nThe first task in the Manipulating Information in a WordprocessingML Document tutorial is to find the default style of paragraphs in the document.  \n  \n## Example  \n  \n### Description  \n The following example opens an Office Open XML WordprocessingML document, finds the document and style parts of the package, and then executes a query that finds the default style name. For information about Office Open XML document packages, and the parts they consist of, see [Details of Office Open XML WordprocessingML Documents (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/details-of-office-open-xml-wordprocessingml-documents.md).  \n  \n The query finds a node named `w:style` that has an attribute named `w:type` with a value of \"paragraph\", and also has an attribute named `w:default` with a value of \"1\". Because there will be only one XML node with these attributes, the query uses the <xref:System.Linq.Enumerable.First%2A?displayProperty=fullName> operator to convert a collection to a singleton. It then gets the value of the attribute with the name `w:styleId`.  \n  \n This example uses classes from the WindowsBase assembly. It uses types in the <xref:System.IO.Packaging?displayProperty=fullName> namespace.  \n  \n### Code  \n  \n```vb  \nImports <xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">  \n  \nModule Module1  \n  \n    Sub Main()  \n  \n        Const fileName As String = \"SampleDoc.docx\"  \n  \n        Const documentRelationshipType As String = _  \n          \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\"  \n        Const stylesRelationshipType As String = _  \n          \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\"  \n  \n        Dim xDoc As XDocument = Nothing  \n        Dim styleDoc As XDocument = Nothing  \n  \n        Using wdPackage As Package = Package.Open(fileName, FileMode.Open, FileAccess.Read)  \n            Dim docPackageRelationship As PackageRelationship = _  \n              wdPackage.GetRelationshipsByType(documentRelationshipType).FirstOrDefault()  \n            If docPackageRelationship IsNot Nothing Then  \n                Dim documentUri As Uri = PackUriHelper.ResolvePartUri(New Uri(\"/\", UriKind.Relative), _  \n                  docPackageRelationship.TargetUri)  \n                Dim documentPart As PackagePart = wdPackage.GetPart(documentUri)  \n  \n                ' Load the document XML in the part into an XDocument instance.  \n                xDoc = XDocument.Load(XmlReader.Create(documentPart.GetStream()))  \n  \n                ' Find the styles part. There will only be one.  \n                Dim styleRelation As PackageRelationship = _  \n                  documentPart.GetRelationshipsByType(stylesRelationshipType).FirstOrDefault()  \n                If styleRelation IsNot Nothing Then  \n                    Dim styleUri As Uri = _  \n                      PackUriHelper.ResolvePartUri(documentUri, styleRelation.TargetUri)  \n                    Dim stylePart As PackagePart = wdPackage.GetPart(styleUri)  \n  \n                    ' Load the style XML in the part into an XDocument instance.  \n                    styleDoc = XDocument.Load(XmlReader.Create(stylePart.GetStream()))  \n                End If  \n            End If  \n        End Using  \n  \n        ' The following query finds all the paragraphs that have the default style.  \n        Dim defParas As IEnumerable(Of XElement) = _  \n            From style In styleDoc.Root.<w:style> _  \n            Where style.@w:type.Equals(\"paragraph\") And _  \n                   style.@w:default.Equals(\"1\") _  \n            Select style  \n        ' Then find the style of the first.  \n        Dim defaultStyle As String = defParas.First().@w:styleId  \n  \n        Console.WriteLine(\"The default style is: \" & defaultStyle)  \n    End Sub  \nEnd Module  \n```  \n  \n### Comments  \n This example produces the following output:  \n  \n```  \nThe default style is: Normal  \n```  \n  \n## Next Steps  \n In the next example, you'll create a similar query that finds all the paragraphs in a document and their styles:  \n  \n-   [Retrieving the Paragraphs and Their Styles (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/retrieving-the-paragraphs-and-their-styles.md)  \n  \n## See Also  \n [Tutorial: Manipulating Content in a WordprocessingML Document (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/tutorial-manipulating-content-in-a-wordprocessingml-document.md)","nodes":[{"pos":[12,79],"content":"Finding the Default Paragraph Style (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Finding the Default Paragraph Style (Visual Basic) | Microsoft Docs","pos":[0,67]}]},{"pos":[386,436],"content":"Finding the Default Paragraph Style (Visual Basic)","linkify":"Finding the Default Paragraph Style (Visual Basic)","nodes":[{"content":"Finding the Default Paragraph Style (Visual Basic)","pos":[0,50]}]},{"content":"The first task in the Manipulating Information in a WordprocessingML Document tutorial is to find the default style of paragraphs in the document.","pos":[437,583]},{"pos":[592,599],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[609,620],"content":"Description","linkify":"Description","nodes":[{"content":"Description","pos":[0,11]}]},{"content":"The following example opens an Office Open XML WordprocessingML document, finds the document and style parts of the package, and then executes a query that finds the default style name.","pos":[624,809]},{"content":"For information about Office Open XML document packages, and the parts they consist of, see <bpt id=\"p1\">[</bpt>Details of Office Open XML WordprocessingML Documents (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/details-of-office-open-xml-wordprocessingml-documents.md)</ept>.","pos":[810,1088],"source":" For information about Office Open XML document packages, and the parts they consist of, see [Details of Office Open XML WordprocessingML Documents (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/details-of-office-open-xml-wordprocessingml-documents.md)."},{"content":"The query finds a node named <ph id=\"ph1\">`w:style`</ph> that has an attribute named <ph id=\"ph2\">`w:type`</ph> with a value of \"paragraph\", and also has an attribute named <ph id=\"ph3\">`w:default`</ph> with a value of \"1\".","pos":[1095,1264],"source":"The query finds a node named `w:style` that has an attribute named `w:type` with a value of \"paragraph\", and also has an attribute named `w:default` with a value of \"1\"."},{"content":"Because there will be only one XML node with these attributes, the query uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.First%2A?displayProperty=fullName&gt;</ph> operator to convert a collection to a singleton.","pos":[1265,1459],"source":" Because there will be only one XML node with these attributes, the query uses the <xref:System.Linq.Enumerable.First%2A?displayProperty=fullName> operator to convert a collection to a singleton."},{"content":"It then gets the value of the attribute with the name <ph id=\"ph1\">`w:styleId`</ph>.","pos":[1460,1526],"source":" It then gets the value of the attribute with the name `w:styleId`."},{"content":"This example uses classes from the WindowsBase assembly.","pos":[1533,1589]},{"content":"It uses types in the <ph id=\"ph1\">&lt;xref:System.IO.Packaging?displayProperty=fullName&gt;</ph> namespace.","pos":[1590,1673],"source":" It uses types in the <xref:System.IO.Packaging?displayProperty=fullName> namespace."},{"pos":[1683,1687],"content":"Code","linkify":"Code","nodes":[{"content":"Code","pos":[0,4]}]},{"pos":[4301,4309],"content":"Comments","linkify":"Comments","nodes":[{"content":"Comments","pos":[0,8]}]},{"content":"This example produces the following output:","pos":[4313,4356]},{"pos":[4411,4421],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"In the next example, you'll create a similar query that finds all the paragraphs in a document and their styles:","pos":[4425,4537]},{"pos":[4547,4710],"content":"<bpt id=\"p1\">[</bpt>Retrieving the Paragraphs and Their Styles (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/retrieving-the-paragraphs-and-their-styles.md)</ept>","source":"[Retrieving the Paragraphs and Their Styles (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/retrieving-the-paragraphs-and-their-styles.md)"},{"pos":[4719,4727],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[4731,4931],"content":"<bpt id=\"p1\">[</bpt>Tutorial: Manipulating Content in a WordprocessingML Document (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/tutorial-manipulating-content-in-a-wordprocessingml-document.md)</ept>","source":"[Tutorial: Manipulating Content in a WordprocessingML Document (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/tutorial-manipulating-content-in-a-wordprocessingml-document.md)"}]}