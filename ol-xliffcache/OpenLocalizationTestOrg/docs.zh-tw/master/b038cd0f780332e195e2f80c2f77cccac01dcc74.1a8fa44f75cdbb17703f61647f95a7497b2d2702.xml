{"content":"---\ntitle: \"How to: Create a Copy of a File in the Same Directory in Visual Basic\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"File.Copy\"\nhelpviewer_keywords: \n  - \"My.Computer.FileSystem.CopyFile method, copying files [Visual Basic]\"\n  - \"files [Visual Basic], copying\"\n  - \"CopyFile method [Visual Basic], copying files in Visual Basic\"\n  - \"I/O [Visual Basic], copying files\"\nms.assetid: b2fdda86-e666-42c2-9706-9527e9fa68ff\n---\n# How to: Create a Copy of a File in the Same Directory in Visual Basic\nUse the `My.Computer.FileSystem.CopyFile` method to copy files. The parameters allow you to overwrite existing files, rename the file, show the progress of the operation, and allow the user to cancel the operation.  \n  \n### To create a copy of a file in the same folder  \n  \n-   Use the `CopyFile` method, supplying the target file and the location. The following example creates a copy of `test.txt` called `test2.txt`.  \n  \n     [!code-vb[VbVbcnMyFileSystem#51](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#51)]  \n  \n### To create a copy of a file in the same folder, overwriting existing files  \n  \n-   Use the `CopyFile` method, supplying the target file and location, and setting `overwrite` to `True`. The following example creates a copy of `test.txt` called `test2.txt` and overwrites any existing files by that name.  \n  \n     [!code-vb[VbVbcnMyFileSystem#52](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#52)]  \n  \n## Robust Programming  \n The following conditions may cause an exception to be thrown:  \n  \n-   The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with \\\\\\\\.\\\\) (<xref:System.ArgumentException>).  \n  \n-   The system could not retrieve the absolute path (<xref:System.ArgumentException>).  \n  \n-   The path is not valid because it is `Nothing` (<xref:System.ArgumentNullException>).  \n  \n-   The source file is not valid or does not exist (<xref:System.IO.FileNotFoundException>).  \n  \n-   The combined path points to an existing directory (<xref:System.IO.IOException>).  \n  \n-   The destination file exists and `overwrite` is set to `False` (<xref:System.IO.IOException>).  \n  \n-   The user does not have sufficient permissions to access the file (<xref:System.IO.IOException>).  \n  \n-   A file in the target folder with the same name is in use (<xref:System.IO.IOException>).  \n  \n-   A file or folder name in the path contains a colon (:) or is in an invalid format (<xref:System.NotSupportedException>).  \n  \n-   `ShowUI` is set to `True`, `onUserCancel` is set to `ThrowException`, and the user has cancelled the operation (<xref:System.OperationCanceledException>).  \n  \n-   `ShowUI` is set to `True`, `onUserCancel` is set to `ThrowException`, and an unspecified I/O error occurs (<xref:System.OperationCanceledException>).  \n  \n-   The path exceeds the system-defined maximum length (<xref:System.IO.PathTooLongException>).  \n  \n-   The user does not have required permission (<xref:System.UnauthorizedAccessException>).  \n  \n-   The user lacks necessary permissions to view the path (<xref:System.Security.SecurityException>).  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.FileIO.FileSystem>\n- <xref:Microsoft.VisualBasic.FileIO.FileSystem.CopyFile%2A>\n- <xref:Microsoft.VisualBasic.FileIO.UICancelOption>\n- [How to: Copy Files with a Specific Pattern to a Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory.md)\n- [How to: Create a Copy of a File in a Different Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory.md)\n- [How to: Copy a Directory to Another Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md)\n- [How to: Rename a File](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md)\n","nodes":[{"pos":[4,422],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create a Copy of a File in the Same Directory in Visual Basic\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"File.Copy\"\nhelpviewer_keywords: \n  - \"My.Computer.FileSystem.CopyFile method, copying files [Visual Basic]\"\n  - \"files [Visual Basic], copying\"\n  - \"CopyFile method [Visual Basic], copying files in Visual Basic\"\n  - \"I/O [Visual Basic], copying files\"\nms.assetid: b2fdda86-e666-42c2-9706-9527e9fa68ff","nodes":[{"content":"How to: Create a Copy of a File in the Same Directory in Visual Basic","nodes":[{"pos":[0,69],"content":"How to: Create a Copy of a File in the Same Directory in Visual Basic","nodes":[{"content":"How to: Create a Copy of a File in the Same Directory in Visual Basic","pos":[0,69]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[429,498],"content":"How to: Create a Copy of a File in the Same Directory in Visual Basic","linkify":"How to: Create a Copy of a File in the Same Directory in Visual Basic","nodes":[{"content":"How to: Create a Copy of a File in the Same Directory in Visual Basic","pos":[0,69]}]},{"content":"Use the <ph id=\"ph1\">`My.Computer.FileSystem.CopyFile`</ph> method to copy files.","pos":[499,562],"source":"Use the `My.Computer.FileSystem.CopyFile` method to copy files."},{"content":"The parameters allow you to overwrite existing files, rename the file, show the progress of the operation, and allow the user to cancel the operation.","pos":[563,713]},{"pos":[723,768],"content":"To create a copy of a file in the same folder","linkify":"To create a copy of a file in the same folder","nodes":[{"content":"To create a copy of a file in the same folder","pos":[0,45]}]},{"content":"Use the <ph id=\"ph1\">`CopyFile`</ph> method, supplying the target file and the location.","pos":[778,848],"source":"Use the `CopyFile` method, supplying the target file and the location."},{"content":"The following example creates a copy of <ph id=\"ph1\">`test.txt`</ph> called <ph id=\"ph2\">`test2.txt`</ph>.","pos":[849,919],"source":" The following example creates a copy of `test.txt` called `test2.txt`."},{"pos":[1061,1134],"content":"To create a copy of a file in the same folder, overwriting existing files","linkify":"To create a copy of a file in the same folder, overwriting existing files","nodes":[{"content":"To create a copy of a file in the same folder, overwriting existing files","pos":[0,73]}]},{"content":"Use the <ph id=\"ph1\">`CopyFile`</ph> method, supplying the target file and location, and setting <ph id=\"ph2\">`overwrite`</ph> to <ph id=\"ph3\">`True`</ph>.","pos":[1144,1245],"source":"Use the `CopyFile` method, supplying the target file and location, and setting `overwrite` to `True`."},{"content":"The following example creates a copy of <ph id=\"ph1\">`test.txt`</ph> called <ph id=\"ph2\">`test2.txt`</ph> and overwrites any existing files by that name.","pos":[1246,1363],"source":" The following example creates a copy of `test.txt` called `test2.txt` and overwrites any existing files by that name."},{"pos":[1504,1522],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"The following conditions may cause an exception to be thrown:","pos":[1526,1587]},{"pos":[1597,1822],"content":"The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with <ph id=\"ph1\">\\\\</ph><ph id=\"ph2\">\\\\</ph>.<ph id=\"ph3\">\\\\</ph>) (<ph id=\"ph4\">&lt;xref:System.ArgumentException&gt;</ph>).","source":"The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with \\\\\\\\.\\\\) (<xref:System.ArgumentException>)."},{"pos":[1832,1914],"content":"The system could not retrieve the absolute path (<ph id=\"ph1\">&lt;xref:System.ArgumentException&gt;</ph>).","source":"The system could not retrieve the absolute path (<xref:System.ArgumentException>)."},{"pos":[1924,2008],"content":"The path is not valid because it is <ph id=\"ph1\">`Nothing`</ph> (<ph id=\"ph2\">&lt;xref:System.ArgumentNullException&gt;</ph>).","source":"The path is not valid because it is `Nothing` (<xref:System.ArgumentNullException>)."},{"pos":[2018,2106],"content":"The source file is not valid or does not exist (<ph id=\"ph1\">&lt;xref:System.IO.FileNotFoundException&gt;</ph>).","source":"The source file is not valid or does not exist (<xref:System.IO.FileNotFoundException>)."},{"pos":[2116,2197],"content":"The combined path points to an existing directory (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"The combined path points to an existing directory (<xref:System.IO.IOException>)."},{"pos":[2207,2300],"content":"The destination file exists and <ph id=\"ph1\">`overwrite`</ph> is set to <ph id=\"ph2\">`False`</ph> (<ph id=\"ph3\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"The destination file exists and `overwrite` is set to `False` (<xref:System.IO.IOException>)."},{"pos":[2310,2406],"content":"The user does not have sufficient permissions to access the file (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"The user does not have sufficient permissions to access the file (<xref:System.IO.IOException>)."},{"pos":[2416,2504],"content":"A file in the target folder with the same name is in use (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"A file in the target folder with the same name is in use (<xref:System.IO.IOException>)."},{"pos":[2514,2634],"content":"A file or folder name in the path contains a colon (:) or is in an invalid format (<ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph>).","source":"A file or folder name in the path contains a colon (:) or is in an invalid format (<xref:System.NotSupportedException>)."},{"pos":[2644,2798],"content":"<ph id=\"ph1\">`ShowUI`</ph> is set to <ph id=\"ph2\">`True`</ph>, <ph id=\"ph3\">`onUserCancel`</ph> is set to <ph id=\"ph4\">`ThrowException`</ph>, and the user has cancelled the operation (<ph id=\"ph5\">&lt;xref:System.OperationCanceledException&gt;</ph>).","source":"`ShowUI` is set to `True`, `onUserCancel` is set to `ThrowException`, and the user has cancelled the operation (<xref:System.OperationCanceledException>)."},{"pos":[2808,2957],"content":"<ph id=\"ph1\">`ShowUI`</ph> is set to <ph id=\"ph2\">`True`</ph>, <ph id=\"ph3\">`onUserCancel`</ph> is set to <ph id=\"ph4\">`ThrowException`</ph>, and an unspecified I/O error occurs (<ph id=\"ph5\">&lt;xref:System.OperationCanceledException&gt;</ph>).","source":"`ShowUI` is set to `True`, `onUserCancel` is set to `ThrowException`, and an unspecified I/O error occurs (<xref:System.OperationCanceledException>)."},{"pos":[2967,3058],"content":"The path exceeds the system-defined maximum length (<ph id=\"ph1\">&lt;xref:System.IO.PathTooLongException&gt;</ph>).","source":"The path exceeds the system-defined maximum length (<xref:System.IO.PathTooLongException>)."},{"pos":[3068,3155],"content":"The user does not have required permission (<ph id=\"ph1\">&lt;xref:System.UnauthorizedAccessException&gt;</ph>).","source":"The user does not have required permission (<xref:System.UnauthorizedAccessException>)."},{"pos":[3165,3262],"content":"The user lacks necessary permissions to view the path (<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","source":"The user lacks necessary permissions to view the path (<xref:System.Security.SecurityException>)."},{"pos":[3271,3279],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3446,3644],"content":"<bpt id=\"p1\">[</bpt>How to: Copy Files with a Specific Pattern to a Directory<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory.md)</ept>","source":"[How to: Copy Files with a Specific Pattern to a Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory.md)"},{"pos":[3647,3843],"content":"<bpt id=\"p1\">[</bpt>How to: Create a Copy of a File in a Different Directory<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory.md)</ept>","source":"[How to: Create a Copy of a File in a Different Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory.md)"},{"pos":[3846,4020],"content":"<bpt id=\"p1\">[</bpt>How to: Copy a Directory to Another Directory<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md)</ept>","source":"[How to: Copy a Directory to Another Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md)"},{"pos":[4023,4149],"content":"<bpt id=\"p1\">[</bpt>How to: Rename a File<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md)</ept>","source":"[How to: Rename a File](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md)"}]}