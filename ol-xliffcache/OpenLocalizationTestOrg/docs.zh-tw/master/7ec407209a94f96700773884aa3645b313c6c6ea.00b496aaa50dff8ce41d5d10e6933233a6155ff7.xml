{"content":"---\ntitle: \"Custom Binding Transport and Encoding\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 6c0b353d-79ee-4e61-b348-be49ad0e9a16\n---\n# Custom Binding Transport and Encoding\nA custom binding is defined by an ordered list of discrete binding elements. This sample demonstrates how to configure a custom binding with various transport and message encoding elements.  \n  \n> [!NOTE]\n>  The setup procedure and build instructions for this sample are located at the end of this topic.  \n  \n This sample is based on the [Self-Host](../../../../docs/framework/wcf/samples/self-host.md), and has been modified to configure three endpoints to support HTTP, TCP, and NamedPipe transports with custom bindings. The client configuration was similarly modified, and the client code changed to communicate with each of the three endpoints.  \n  \n The sample demonstrates a how to configure a custom binding that supports a particular transport and message encoding. This is accomplished by configuring a transport and a message encoding for the `binding` element. The ordering of binding elements is important in defining a custom binding, because each represents a layer in the channel stack (see [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md)). This sample configures three custom bindings: an HTTP transport with text encoding, a TCP transport with text encoding, and a NamedPipe transport with a binary encoding.  \n  \n The service configuration defines the custom bindings as follows:  \n  \n```xml  \n<bindings>  \n    <customBinding>  \n        <binding name=\"HttpBinding\" >  \n            <textMessageEncoding   \n                messageVersion=\"Soap12Addressing10\"/>  \n            <httpTransport />  \n        </binding>  \n        <binding name=\"TcpBinding\" >  \n            <textMessageEncoding />  \n            <tcpTransport />  \n        </binding>  \n        <binding name=\"NamedPipeBinding\" >  \n            <binaryMessageEncoding />  \n            <namedPipeTransport />  \n        </binding>  \n    </customBinding>  \n</bindings>  \n```  \n  \n When you run the sample, the operation requests and responses are displayed in both the service and client console window. The client communicates with each of the three endpoints, accessing first HTTP, then TCP, and finally NamedPipe. Press ENTER in each console window to shut down the service and client.  \n  \n The `namedPipeTransport` binding does not support machine-to-machine operations. It is used only for communication on the same machine. Therefore, when running the sample in a cross-machine scenario, comment out the following lines in the client code file:  \n  \n```csharp  \nCalculatorClient client = new CalculatorClient(\"default\");  \nConsole.WriteLine(\"Communicate with named pipe endpoint.\");  \n// Call operations.  \nDoCalculations(client);  \n//Closing the client gracefully closes the connection and cleans up resources  \nclient.Close();  \n```  \n  \n```vb  \nDim client As New CalculatorClient(\"default\")  \nConsole.WriteLine(\"Communicate with named pipe endpoint.\")  \n' call operations  \nDoCalculations(client)  \n'Closing the client gracefully closes the connection and cleans up resources  \nclient.Close()  \n```  \n  \n> [!NOTE]\n>  If you use Svcutil.exe to regenerate the configuration for this sample, be sure to modify the endpoint name in the client configuration to match the client code.  \n  \n### To set up, build, and run the sample  \n  \n1.  Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md).  \n  \n2.  To build the C#, C++, or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md).  \n  \n3.  To run the sample in a single- or cross-machine configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md).  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\Binding\\Custom\\Transport`  \n","nodes":[{"pos":[4,155],"embed":true,"restype":"x-metadata","content":"title: \"Custom Binding Transport and Encoding\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 6c0b353d-79ee-4e61-b348-be49ad0e9a16","nodes":[{"content":"Custom Binding Transport and Encoding","nodes":[{"pos":[0,37],"content":"Custom Binding Transport and Encoding","nodes":[{"content":"Custom Binding Transport and Encoding","pos":[0,37]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[162,199],"content":"Custom Binding Transport and Encoding","linkify":"Custom Binding Transport and Encoding","nodes":[{"content":"Custom Binding Transport and Encoding","pos":[0,37]}]},{"content":"A custom binding is defined by an ordered list of discrete binding elements.","pos":[200,276]},{"content":"This sample demonstrates how to configure a custom binding with various transport and message encoding elements.","pos":[277,389]},{"pos":[397,504],"content":"[!NOTE]\n The setup procedure and build instructions for this sample are located at the end of this topic.","leadings":["","> "],"nodes":[{"content":"The setup procedure and build instructions for this sample are located at the end of this topic.","pos":[9,105]}]},{"content":"This sample is based on the <bpt id=\"p1\">[</bpt>Self-Host<ept id=\"p1\">](../../../../docs/framework/wcf/samples/self-host.md)</ept>, and has been modified to configure three endpoints to support HTTP, TCP, and NamedPipe transports with custom bindings.","pos":[511,724],"source":"This sample is based on the [Self-Host](../../../../docs/framework/wcf/samples/self-host.md), and has been modified to configure three endpoints to support HTTP, TCP, and NamedPipe transports with custom bindings."},{"content":"The client configuration was similarly modified, and the client code changed to communicate with each of the three endpoints.","pos":[725,850]},{"content":"The sample demonstrates a how to configure a custom binding that supports a particular transport and message encoding.","pos":[857,975]},{"content":"This is accomplished by configuring a transport and a message encoding for the <ph id=\"ph1\">`binding`</ph> element.","pos":[976,1073],"source":" This is accomplished by configuring a transport and a message encoding for the `binding` element."},{"content":"The ordering of binding elements is important in defining a custom binding, because each represents a layer in the channel stack (see <bpt id=\"p1\">[</bpt>Custom Bindings<ept id=\"p1\">](../../../../docs/framework/wcf/extending/custom-bindings.md)</ept>).","pos":[1074,1288],"source":" The ordering of binding elements is important in defining a custom binding, because each represents a layer in the channel stack (see [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md))."},{"content":"This sample configures three custom bindings: an HTTP transport with text encoding, a TCP transport with text encoding, and a NamedPipe transport with a binary encoding.","pos":[1289,1458]},{"content":"The service configuration defines the custom bindings as follows:","pos":[1465,1530]},{"content":"When you run the sample, the operation requests and responses are displayed in both the service and client console window.","pos":[2084,2206]},{"content":"The client communicates with each of the three endpoints, accessing first HTTP, then TCP, and finally NamedPipe.","pos":[2207,2319]},{"content":"Press ENTER in each console window to shut down the service and client.","pos":[2320,2391]},{"content":"The <ph id=\"ph1\">`namedPipeTransport`</ph> binding does not support machine-to-machine operations.","pos":[2398,2478],"source":"The `namedPipeTransport` binding does not support machine-to-machine operations."},{"content":"It is used only for communication on the same machine.","pos":[2479,2533]},{"content":"Therefore, when running the sample in a cross-machine scenario, comment out the following lines in the client code file:","pos":[2534,2654]},{"pos":[3219,3391],"content":"[!NOTE]\n If you use Svcutil.exe to regenerate the configuration for this sample, be sure to modify the endpoint name in the client configuration to match the client code.","leadings":["","> "],"nodes":[{"content":"If you use Svcutil.exe to regenerate the configuration for this sample, be sure to modify the endpoint name in the client configuration to match the client code.","pos":[9,170]}]},{"pos":[3401,3437],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"pos":[3447,3646],"content":"Ensure that you have performed the <bpt id=\"p1\">[</bpt>One-Time Setup Procedure for the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)</ept>.","source":"Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)."},{"pos":[3656,3871],"content":"To build the C#, C++, or Visual Basic .NET edition of the solution, follow the instructions in <bpt id=\"p1\">[</bpt>Building the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/building-the-samples.md)</ept>.","source":"To build the C#, C++, or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md)."},{"pos":[3881,4089],"content":"To run the sample in a single- or cross-machine configuration, follow the instructions in <bpt id=\"p1\">[</bpt>Running the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/running-the-samples.md)</ept>.","source":"To run the sample in a single- or cross-machine configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md)."},{"pos":[4097,4229],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[14,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[4283,4593],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[4594,4644]}]}