{"content":"---\ntitle: \"How to: Load Files into the Windows Forms RichTextBox Control\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"text boxes [Windows Forms], displaying files\"\n  - \"examples [Windows Forms], text boxes\"\n  - \".rtf files [Windows Forms], opening in RichTextBox control\"\n  - \"RTF files [Windows Forms], opening in RichTextBox control\"\n  - \"text files [Windows Forms], displaying in RichTextBox control\"\n  - \".rtf files [Windows Forms], displaying in RichTextBox control\"\n  - \"RichTextBox control [Windows Forms], opening files\"\n  - \"RTF files [Windows Forms], displaying in RichTextBox control\"\nms.assetid: c03451be-f285-4428-a71a-c41e002cc919\n---\n# How to: Load Files into the Windows Forms RichTextBox Control\nThe Windows Forms <xref:System.Windows.Forms.RichTextBox> control can display a plain-text, Unicode plain-text, or Rich-Text-Format (RTF) file. To do so, call the <xref:System.Windows.Forms.RichTextBox.LoadFile%2A> method. You can also use the <xref:System.Windows.Forms.RichTextBox.LoadFile%2A> method to load data from a stream. For more information, see <xref:System.Windows.Forms.RichTextBox.LoadFile%28System.IO.Stream%2CSystem.Windows.Forms.RichTextBoxStreamType%29>.  \n  \n### To load a file into the RichTextBox control  \n  \n1.  Determine the path of the file to be opened using the <xref:System.Windows.Forms.OpenFileDialog> component. For an overview, see [OpenFileDialog Component Overview](openfiledialog-component-overview-windows-forms.md).  \n  \n2.  Call the <xref:System.Windows.Forms.RichTextBox.LoadFile%2A> method of the <xref:System.Windows.Forms.RichTextBox> control, specifying the file to load and optionally a file type. In the example below, the file to load is taken from the <xref:System.Windows.Forms.OpenFileDialog> component's <xref:System.Windows.Forms.FileDialog.FileName%2A> property. If you call the method with a file name as its only argument, the file type will be assumed to be RTF. To specify another file type, call the method with a value of the <xref:System.Windows.Forms.RichTextBoxStreamType> enumeration as its second argument.  \n  \n     In the example below, the <xref:System.Windows.Forms.OpenFileDialog> component is shown when a button is clicked. The file selected is then opened and displayed in the <xref:System.Windows.Forms.RichTextBox> control. This example assumes a form has a button,`btnOpenFile`.  \n  \n    ```vb  \n    Private Sub btnOpenFile_Click(ByVal sender As System.Object, _  \n       ByVal e As System.EventArgs) Handles btnOpenFile.Click  \n         If OpenFileDialog1.ShowDialog() = DialogResult.OK Then  \n           RichTextBox1.LoadFile(OpenFileDialog1.FileName, _  \n              RichTextBoxStreamType.RichText)  \n          End If  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    private void btnOpenFile_Click(object sender, System.EventArgs e)  \n    {  \n       if(openFileDialog1.ShowDialog() == DialogResult.OK)  \n       {  \n         richTextBox1.LoadFile(openFileDialog1.FileName, RichTextBoxStreamType.RichText);  \n       }  \n    }  \n    ```  \n  \n    ```cpp  \n    private:  \n       void btnOpenFile_Click(System::Object ^  sender,  \n          System::EventArgs ^  e)  \n       {  \n          if(openFileDialog1->ShowDialog() == DialogResult::OK)  \n          {  \n             richTextBox1->LoadFile(openFileDialog1->FileName,  \n                RichTextBoxStreamType::RichText);  \n          }  \n       }  \n    ```  \n  \n     (Visual C#, [!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]) Place the following code in the form's constructor to register the event handler.  \n  \n    ```csharp  \n    this.btnOpenFile.Click += new System.EventHandler(this. btnOpenFile_Click);  \n    ```  \n  \n    ```cpp  \n    this->btnOpenFile->Click += gcnew   \n       System::EventHandler(this, &Form1::btnOpenFile_Click);  \n    ```  \n  \n    > [!IMPORTANT]\n    >  To run this process, your assembly may require a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType> class. If you are running in a partial-trust context, the process might throw an exception because of insufficient privileges. For more information, see [Code Access Security Basics](../../misc/code-access-security-basics.md).  \n  \n## See also\n\n- <xref:System.Windows.Forms.RichTextBox.LoadFile%2A?displayProperty=nameWithType>\n- <xref:System.Windows.Forms.RichTextBox>\n- [RichTextBox Control](richtextbox-control-windows-forms.md)\n- [Controls to Use on Windows Forms](controls-to-use-on-windows-forms.md)\n","nodes":[{"pos":[4,694],"embed":true,"restype":"x-metadata","content":"title: \"How to: Load Files into the Windows Forms RichTextBox Control\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"text boxes [Windows Forms], displaying files\"\n  - \"examples [Windows Forms], text boxes\"\n  - \".rtf files [Windows Forms], opening in RichTextBox control\"\n  - \"RTF files [Windows Forms], opening in RichTextBox control\"\n  - \"text files [Windows Forms], displaying in RichTextBox control\"\n  - \".rtf files [Windows Forms], displaying in RichTextBox control\"\n  - \"RichTextBox control [Windows Forms], opening files\"\n  - \"RTF files [Windows Forms], displaying in RichTextBox control\"\nms.assetid: c03451be-f285-4428-a71a-c41e002cc919","nodes":[{"content":"How to: Load Files into the Windows Forms RichTextBox Control","nodes":[{"pos":[0,61],"content":"How to: Load Files into the Windows Forms RichTextBox Control","nodes":[{"content":"How to: Load Files into the Windows Forms RichTextBox Control","pos":[0,61]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[701,762],"content":"How to: Load Files into the Windows Forms RichTextBox Control","linkify":"How to: Load Files into the Windows Forms RichTextBox Control","nodes":[{"content":"How to: Load Files into the Windows Forms RichTextBox Control","pos":[0,61]}]},{"content":"The Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control can display a plain-text, Unicode plain-text, or Rich-Text-Format (RTF) file.","pos":[763,906],"source":"The Windows Forms <xref:System.Windows.Forms.RichTextBox> control can display a plain-text, Unicode plain-text, or Rich-Text-Format (RTF) file."},{"content":"To do so, call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.LoadFile%2A&gt;</ph> method.","pos":[907,985],"source":" To do so, call the <xref:System.Windows.Forms.RichTextBox.LoadFile%2A> method."},{"content":"You can also use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.LoadFile%2A&gt;</ph> method to load data from a stream.","pos":[986,1093],"source":" You can also use the <xref:System.Windows.Forms.RichTextBox.LoadFile%2A> method to load data from a stream."},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.LoadFile%28System.IO.Stream%2CSystem.Windows.Forms.RichTextBoxStreamType%29&gt;</ph>.","pos":[1094,1236],"source":" For more information, see <xref:System.Windows.Forms.RichTextBox.LoadFile%28System.IO.Stream%2CSystem.Windows.Forms.RichTextBoxStreamType%29>."},{"pos":[1246,1289],"content":"To load a file into the RichTextBox control","linkify":"To load a file into the RichTextBox control","nodes":[{"content":"To load a file into the RichTextBox control","pos":[0,43]}]},{"content":"Determine the path of the file to be opened using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.OpenFileDialog&gt;</ph> component.","pos":[1299,1406],"source":"Determine the path of the file to be opened using the <xref:System.Windows.Forms.OpenFileDialog> component."},{"content":"For an overview, see <bpt id=\"p1\">[</bpt>OpenFileDialog Component Overview<ept id=\"p1\">](openfiledialog-component-overview-windows-forms.md)</ept>.","pos":[1407,1516],"source":" For an overview, see [OpenFileDialog Component Overview](openfiledialog-component-overview-windows-forms.md)."},{"content":"Call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox.LoadFile%2A&gt;</ph> method of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control, specifying the file to load and optionally a file type.","pos":[1526,1705],"source":"Call the <xref:System.Windows.Forms.RichTextBox.LoadFile%2A> method of the <xref:System.Windows.Forms.RichTextBox> control, specifying the file to load and optionally a file type."},{"content":"In the example below, the file to load is taken from the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.OpenFileDialog&gt;</ph> component's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.FileDialog.FileName%2A&gt;</ph> property.","pos":[1706,1878],"source":" In the example below, the file to load is taken from the <xref:System.Windows.Forms.OpenFileDialog> component's <xref:System.Windows.Forms.FileDialog.FileName%2A> property."},{"content":"If you call the method with a file name as its only argument, the file type will be assumed to be RTF.","pos":[1879,1981]},{"content":"To specify another file type, call the method with a value of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBoxStreamType&gt;</ph> enumeration as its second argument.","pos":[1982,2133],"source":" To specify another file type, call the method with a value of the <xref:System.Windows.Forms.RichTextBoxStreamType> enumeration as its second argument."},{"content":"In the example below, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.OpenFileDialog&gt;</ph> component is shown when a button is clicked.","pos":[2144,2257],"source":"In the example below, the <xref:System.Windows.Forms.OpenFileDialog> component is shown when a button is clicked."},{"content":"The file selected is then opened and displayed in the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control.","pos":[2258,2360],"source":" The file selected is then opened and displayed in the <xref:System.Windows.Forms.RichTextBox> control."},{"content":"This example assumes a form has a button,<ph id=\"ph1\">`btnOpenFile`</ph>.","pos":[2361,2416],"source":" This example assumes a form has a button,`btnOpenFile`."},{"pos":[3455,3603],"content":"(Visual C#, <ph id=\"ph1\">[!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]</ph>) Place the following code in the form's constructor to register the event handler.","source":"(Visual C#, [!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]) Place the following code in the form's constructor to register the event handler."},{"pos":[3857,4264],"content":"[!IMPORTANT]\nTo run this process, your assembly may require a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType> class. If you are running in a partial-trust context, the process might throw an exception because of insufficient privileges. For more information, see [Code Access Security Basics](../../misc/code-access-security-basics.md).","leadings":["","    >  "],"nodes":[{"content":"To run this process, your assembly may require a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType> class. If you are running in a partial-trust context, the process might throw an exception because of insufficient privileges. For more information, see [Code Access Security Basics](../../misc/code-access-security-basics.md).","pos":[13,400],"nodes":[{"content":"To run this process, your assembly may require a privilege level granted by the <ph id=\"ph1\">&lt;xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType&gt;</ph> class.","pos":[0,167],"source":"To run this process, your assembly may require a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType> class."},{"content":"If you are running in a partial-trust context, the process might throw an exception because of insufficient privileges.","pos":[168,287]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Access Security Basics<ept id=\"p1\">](../../misc/code-access-security-basics.md)</ept>.","pos":[288,387],"source":" For more information, see [Code Access Security Basics](../../misc/code-access-security-basics.md)."}]}]},{"pos":[4273,4281],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4410,4469],"content":"<bpt id=\"p1\">[</bpt>RichTextBox Control<ept id=\"p1\">](richtextbox-control-windows-forms.md)</ept>","source":"[RichTextBox Control](richtextbox-control-windows-forms.md)"},{"pos":[4472,4543],"content":"<bpt id=\"p1\">[</bpt>Controls to Use on Windows Forms<ept id=\"p1\">](controls-to-use-on-windows-forms.md)</ept>","source":"[Controls to Use on Windows Forms](controls-to-use-on-windows-forms.md)"}]}