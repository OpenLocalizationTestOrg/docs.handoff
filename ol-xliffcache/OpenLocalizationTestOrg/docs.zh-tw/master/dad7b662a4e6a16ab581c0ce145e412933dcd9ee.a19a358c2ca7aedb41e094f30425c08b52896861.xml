{"content":"---\ntitle: \"How to: Add Tables and Columns to the Windows Forms DataGrid Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"columns [Windows Forms], adding to DataGrid control\"\n  - \"tables [Windows Forms], adding to DataGrid control\"\n  - \"DataGrid control [Windows Forms], adding tables and columns\"\nms.assetid: 2fe661b9-aa06-49b9-a314-a0d3cbfdcb4d\ncaps.latest.revision: 15\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Add Tables and Columns to the Windows Forms DataGrid Control\n> [!NOTE]\n>  The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose. For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](../../../../docs/framework/winforms/controls/differences-between-the-windows-forms-datagridview-and-datagrid-controls.md).  \n  \n You can display data in the Windows Forms <xref:System.Windows.Forms.DataGrid> control in tables and columns by creating **DataGridTableStyle** objects and adding them to the **GridTableStylesCollection** object, which is accessed through the <xref:System.Windows.Forms.DataGrid> control's **TableStyles** property. Each table style displays the contents of whatever data table is specified in the **DataGridTableStyle** object's **MappingName** property. By default, a table style with no column styles specified will display all the columns within that data table. You can restrict which columns from the table appear by adding **DataGridColumnStyle** objects to the **GridColumnStylesCollection** object, which is accessed through the **GridColumnStyles** property of each **DataGridTableStyle** object.  \n  \n### To add a table and column to a DataGrid programmatically  \n  \n1.  In order to display data in the table, you must first bind the <xref:System.Windows.Forms.DataGrid> control to a dataset. For more information, see [How to: Bind the Windows Forms DataGrid Control to a Data Source](../../../../docs/framework/winforms/controls/how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md).  \n  \n    > [!CAUTION]\n    >  When programmatically specifying column styles, always create **DataGridColumnStyle** objects and add them to the **GridColumnStylesCollection** object before adding **DataGridTableStyle** objects to the **GridTableStylesCollection** object. When you add an empty **DataGridTableStyle** object to the collection, **DataGridColumnStyle** objects are automatically generated for you. Consequently, an exception will be thrown if you try to add new **DataGridColumnStyle** objects with duplicate **MappingName** values to the **GridColumnStylesCollection** object.  \n  \n2.  Declare a new table style and set its mapping name.  \n  \n    ```vb  \n    Dim ts1 As New DataGridTableStyle()  \n    ts1.MappingName = \"Customers\"  \n  \n    ```  \n  \n    ```csharp  \n    DataGridTableStyle ts1 = new DataGridTableStyle();  \n    ts1.MappingName = \"Customers\";  \n  \n    ```  \n  \n    ```cpp  \n    DataGridTableStyle* ts1 = new DataGridTableStyle();  \n    ts1->MappingName = S\"Customers\";  \n    ```  \n  \n3.  Declare a new column style and set its mapping name and other properties.  \n  \n    ```vb  \n    Dim myDataCol As New DataGridBoolColumn()  \n    myDataCol.HeaderText = \"My New Column\"  \n    myDataCol.MappingName = \"Current\"  \n  \n    ```  \n  \n    ```csharp  \n    DataGridBoolColumn myDataCol = new DataGridBoolColumn();  \n    myDataCol.HeaderText = \"My New Column\";  \n    myDataCol.MappingName = \"Current\";  \n  \n    ```  \n  \n    ```cpp  \n    DataGridBoolColumn^ myDataCol = gcnew DataGridBoolColumn();  \n    myDataCol->HeaderText = \"My New Column\";  \n    myDataCol->MappingName = \"Current\";  \n    ```  \n  \n4.  Call the **Add** method of the **GridColumnStylesCollection** object to add the column to the table style  \n  \n    ```vb  \n    ts1.GridColumnStyles.Add(myDataCol)  \n  \n    ```  \n  \n    ```csharp  \n    ts1.GridColumnStyles.Add(myDataCol);  \n  \n    ```  \n  \n    ```cpp  \n    ts1->GridColumnStyles->Add(myDataCol);  \n    ```  \n  \n5.  Call the **Add** method of the **GridTableStylesCollection** object to add the table style to the data grid.  \n  \n    ```vb  \n    DataGrid1.TableStyles.Add(ts1)  \n  \n    ```  \n  \n    ```csharp  \n    dataGrid1.TableStyles.Add(ts1);  \n  \n    ```  \n  \n    ```cpp  \n    dataGrid1->TableStyles->Add(ts1);  \n    ```  \n  \n## See Also  \n [DataGrid Control](../../../../docs/framework/winforms/controls/datagrid-control-windows-forms.md)   \n [How to: Delete or Hide Columns in the Windows Forms DataGrid Control](../../../../docs/framework/winforms/controls/how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md)","nodes":[{"pos":[12,97],"content":"How to: Add Tables and Columns to the Windows Forms DataGrid Control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Add Tables and Columns to the Windows Forms DataGrid Control | Microsoft Docs","pos":[0,85]}]},{"pos":[638,706],"content":"How to: Add Tables and Columns to the Windows Forms DataGrid Control","linkify":"How to: Add Tables and Columns to the Windows Forms DataGrid Control","nodes":[{"content":"How to: Add Tables and Columns to the Windows Forms DataGrid Control","pos":[0,68]}]},{"pos":[709,1214],"content":"[!NOTE]\n The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose. For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](../../../../docs/framework/winforms/controls/differences-between-the-windows-forms-datagridview-and-datagrid-controls.md).","leadings":["","> "],"nodes":[{"content":" The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose. For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](../../../../docs/framework/winforms/controls/differences-between-the-windows-forms-datagridview-and-datagrid-controls.md).","pos":[8,503],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> control replaces and adds functionality to the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control; however, the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control is retained for both backward compatibility and future use, if you choose.","pos":[1,271],"source":" The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Differences Between the Windows Forms DataGridView and DataGrid Controls<ept id=\"p1\">](../../../../docs/framework/winforms/controls/differences-between-the-windows-forms-datagridview-and-datagrid-controls.md)</ept>.","pos":[272,495],"source":" For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](../../../../docs/framework/winforms/controls/differences-between-the-windows-forms-datagridview-and-datagrid-controls.md)."}]}]},{"content":"You can display data in the Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control in tables and columns by creating <bpt id=\"p1\">**</bpt>DataGridTableStyle<ept id=\"p1\">**</ept> objects and adding them to the <bpt id=\"p2\">**</bpt>GridTableStylesCollection<ept id=\"p2\">**</ept> object, which is accessed through the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control's <bpt id=\"p3\">**</bpt>TableStyles<ept id=\"p3\">**</ept> property.","pos":[1221,1536],"source":"You can display data in the Windows Forms <xref:System.Windows.Forms.DataGrid> control in tables and columns by creating **DataGridTableStyle** objects and adding them to the **GridTableStylesCollection** object, which is accessed through the <xref:System.Windows.Forms.DataGrid> control's **TableStyles** property."},{"content":"Each table style displays the contents of whatever data table is specified in the <bpt id=\"p1\">**</bpt>DataGridTableStyle<ept id=\"p1\">**</ept> object's <bpt id=\"p2\">**</bpt>MappingName<ept id=\"p2\">**</ept> property.","pos":[1537,1676],"source":" Each table style displays the contents of whatever data table is specified in the **DataGridTableStyle** object's **MappingName** property."},{"content":"By default, a table style with no column styles specified will display all the columns within that data table.","pos":[1677,1787]},{"content":"You can restrict which columns from the table appear by adding <bpt id=\"p1\">**</bpt>DataGridColumnStyle<ept id=\"p1\">**</ept> objects to the <bpt id=\"p2\">**</bpt>GridColumnStylesCollection<ept id=\"p2\">**</ept> object, which is accessed through the <bpt id=\"p3\">**</bpt>GridColumnStyles<ept id=\"p3\">**</ept> property of each <bpt id=\"p4\">**</bpt>DataGridTableStyle<ept id=\"p4\">**</ept> object.","pos":[1788,2027],"source":" You can restrict which columns from the table appear by adding **DataGridColumnStyle** objects to the **GridColumnStylesCollection** object, which is accessed through the **GridColumnStyles** property of each **DataGridTableStyle** object."},{"pos":[2037,2093],"content":"To add a table and column to a DataGrid programmatically","linkify":"To add a table and column to a DataGrid programmatically","nodes":[{"content":"To add a table and column to a DataGrid programmatically","pos":[0,56]}]},{"content":"In order to display data in the table, you must first bind the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DataGrid&gt;</ph> control to a dataset.","pos":[2103,2224],"source":"In order to display data in the table, you must first bind the <xref:System.Windows.Forms.DataGrid> control to a dataset."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Bind the Windows Forms DataGrid Control to a Data Source<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)</ept>.","pos":[2225,2431],"source":" For more information, see [How to: Bind the Windows Forms DataGrid Control to a Data Source](../../../../docs/framework/winforms/controls/how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)."},{"pos":[2443,3022],"content":"[!CAUTION]\nWhen programmatically specifying column styles, always create **DataGridColumnStyle** objects and add them to the **GridColumnStylesCollection** object before adding **DataGridTableStyle** objects to the **GridTableStylesCollection** object. When you add an empty **DataGridTableStyle** object to the collection, **DataGridColumnStyle** objects are automatically generated for you. Consequently, an exception will be thrown if you try to add new **DataGridColumnStyle** objects with duplicate **MappingName** values to the **GridColumnStylesCollection** object.","leadings":["","    >  "],"nodes":[{"content":"When programmatically specifying column styles, always create **DataGridColumnStyle** objects and add them to the **GridColumnStylesCollection** object before adding **DataGridTableStyle** objects to the **GridTableStylesCollection** object. When you add an empty **DataGridTableStyle** object to the collection, **DataGridColumnStyle** objects are automatically generated for you. Consequently, an exception will be thrown if you try to add new **DataGridColumnStyle** objects with duplicate **MappingName** values to the **GridColumnStylesCollection** object.","pos":[11,572],"nodes":[{"content":"When programmatically specifying column styles, always create <bpt id=\"p1\">**</bpt>DataGridColumnStyle<ept id=\"p1\">**</ept> objects and add them to the <bpt id=\"p2\">**</bpt>GridColumnStylesCollection<ept id=\"p2\">**</ept> object before adding <bpt id=\"p3\">**</bpt>DataGridTableStyle<ept id=\"p3\">**</ept> objects to the <bpt id=\"p4\">**</bpt>GridTableStylesCollection<ept id=\"p4\">**</ept> object.","pos":[0,241],"source":"When programmatically specifying column styles, always create **DataGridColumnStyle** objects and add them to the **GridColumnStylesCollection** object before adding **DataGridTableStyle** objects to the **GridTableStylesCollection** object."},{"content":"When you add an empty <bpt id=\"p1\">**</bpt>DataGridTableStyle<ept id=\"p1\">**</ept> object to the collection, <bpt id=\"p2\">**</bpt>DataGridColumnStyle<ept id=\"p2\">**</ept> objects are automatically generated for you.","pos":[242,381],"source":" When you add an empty **DataGridTableStyle** object to the collection, **DataGridColumnStyle** objects are automatically generated for you."},{"content":"Consequently, an exception will be thrown if you try to add new <bpt id=\"p1\">**</bpt>DataGridColumnStyle<ept id=\"p1\">**</ept> objects with duplicate <bpt id=\"p2\">**</bpt>MappingName<ept id=\"p2\">**</ept> values to the <bpt id=\"p3\">**</bpt>GridColumnStylesCollection<ept id=\"p3\">**</ept> object.","pos":[382,561],"source":" Consequently, an exception will be thrown if you try to add new **DataGridColumnStyle** objects with duplicate **MappingName** values to the **GridColumnStylesCollection** object."}]}]},{"content":"Declare a new table style and set its mapping name.","pos":[3032,3083]},{"content":"Declare a new column style and set its mapping name and other properties.","pos":[3448,3521]},{"pos":[4055,4160],"content":"Call the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> method of the <bpt id=\"p2\">**</bpt>GridColumnStylesCollection<ept id=\"p2\">**</ept> object to add the column to the table style","source":"Call the **Add** method of the **GridColumnStylesCollection** object to add the column to the table style"},{"pos":[4386,4494],"content":"Call the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> method of the <bpt id=\"p2\">**</bpt>GridTableStylesCollection<ept id=\"p2\">**</ept> object to add the table style to the data grid.","source":"Call the **Add** method of the **GridTableStylesCollection** object to add the table style to the data grid."},{"pos":[4704,4712],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>DataGrid Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/datagrid-control-windows-forms.md)</ept><ph id=\"ph1\"> </ph>","pos":[4716,4815],"source":"[DataGrid Control](../../../../docs/framework/winforms/controls/datagrid-control-windows-forms.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Delete or Hide Columns in the Windows Forms DataGrid Control<ept id=\"p1\">](../../../../docs/framework/winforms/controls/how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md)</ept>","pos":[4818,5006],"source":" [How to: Delete or Hide Columns in the Windows Forms DataGrid Control](../../../../docs/framework/winforms/controls/how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md)"}]}