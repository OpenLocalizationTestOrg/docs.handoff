{"content":"---\ntitle: \"Regular Expression Activities | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: b8f24694-49db-4339-92ec-014e3d4ae63b\ncaps.latest.revision: 9\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Regular Expression Activities\nThis sample demonstrates how to create a set of activities that expose the regular expression functionality of the <xref:System.Text.RegularExpressions> namespace. These custom activities can be used within a workflow application. [!INCLUDE[crabout](../../../../includes/crabout-md.md)]regular expressions, see [N:System.Text.RegularExpressions](http://go.microsoft.com/fwlink/?LinkId=150434) Namespace.  \n  \n The following table details the custom activities in this sample.  \n  \n|Activity|Description|  \n|--------------|-----------------|  \n|IsMatch|Specifies whether the regular expression found a match in the input string.|  \n|Matches|Searches an input string for all occurrences of a regular expression and returns all the successful matches.|  \n|Replace|Within a specified input string, replaces strings that match a regular expression pattern with a specified replacement string.|  \n  \n## IsMatch  \n The `IsMatch` custom activity returns `true` if the `Input` string property finds a match in the regular expression specified in the `Pattern` property. The activity derives from <xref:System.Activities.CodeActivity%601> and within the <xref:System.Activities.CodeActivity%601.Execute%2A> method calls the <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> method.  \n  \n The following table describes the properties and return value for the `IsMatch` custom activity.  \n  \n|Property or Return Value|Description|  \n|------------------------------|-----------------|  \n|Pattern (required)|The regular expression to search with.|  \n|Input (required)|The input string to search.|  \n|RegexOptions|Bitwise OR combination of [RegexOptions](http://go.microsoft.com/fwlink/?LinkId=150446) enumeration values.|  \n|Return value|`true` if the input finds a match in the provided pattern; otherwise `false`.|  \n  \n The following code example demonstrates how to use the `IsMatch` custom activity.  \n  \n```  \nnew IsMatch  \n{  \n    Pattern = new InArgument<string>( @\"^-?\\d+(\\.\\d{2})?$\"),  \n    Input = \"20.00\",  \n};  \n  \n```  \n  \n## Matches  \n The `Matches` custom activity searches an input string for all occurrences of a regular expression and returns all the successful matches. The activity derives from <xref:System.Activities.CodeActivity%601> and within the <xref:System.Activities.CodeActivity%601.Execute%2A> method calls the <xref:System.Text.RegularExpressions.Regex.Matches%2A> method.  \n  \n The following table describes the properties and return value for the `IsMatch` custom activity.  \n  \n|Property or Return Value|Description|  \n|------------------------------|-----------------|  \n|Pattern (required)|The regular expression to search with.|  \n|Input (required)|The input string to search.|  \n|RegexOptions|Bitwise OR combination of [RegexOptions](http://go.microsoft.com/fwlink/?LinkId=150446) enumeration values.|  \n|Return Value|A <xref:System.Text.RegularExpressions.MatchCollection> that contains the collection of successful matches.|  \n  \n The following code example demonstrates how to use the `Matches` custom activity.  \n  \n```  \nnew Matches  \n{  \n    Pattern = @\"\\b(?<word>\\w+)\\s+(\\k<word>)\\b\",  \n    Input = \"The quick brown fox  fox jumped over over the lazy dog dog.\",  \n};  \n  \n```  \n  \n## Replace  \n The `Replace` custom activity searches an input string and replaces all strings that match a specified regular expression with a string. The activity derives from <xref:System.Activities.CodeActivity%601> and within the <xref:System.Activities.CodeActivity%601.Execute%2A> method calls the <xref:System.Text.RegularExpressions.Regex.Replace%2A> method.  \n  \n The following table describes the properties and return value for the `Replace` custom activity.  \n  \n|Property or Return Value|Description|  \n|------------------------------|-----------------|  \n|Pattern (required)|The regular expression to search with.|  \n|Input (required)|The input string to search.|  \n|Replacement|The replacement string.<br /><br /> If a `Replacement` is specified, then the `MatchEvaluator` property is ignored. Either the `Replacement` or `MatchEvaluator` property must be set.|  \n|MatchEvaluator|A custom method that examines each match and returns either the original matched string or a replacement string.<br /><br /> If a `Replacement` is specified, then the `MatchEvaluator` property is ignored. Either the `Replacement` or `MatchEvaluator` property must be set.|  \n|RegexOptions|Bitwise OR combination of [RegexOptions](http://go.microsoft.com/fwlink/?LinkId=150446) enumeration values.|  \n|Return Value|A <xref:System.Text.RegularExpressions.MatchCollection> that contains the collection of successful matches.|  \n  \n The following code example demonstrates how to use the `Replace` custom activity.  \n  \n```  \n// Using the replacement string.  \nnew Replace  \n{  \n    Pattern = @\"\\bWorld\\b\",  \n    Input = \"Hello World! This is a wonderful World\",  \n    Replacement = \"Universe\"  \n};  \n  \n// Using a match evaluator.  \nnew Replace  \n{  \n    Pattern = new InArgument<string>(pattern),  \n    Input = new InArgument<string>(input),  \n    MatchEvaluator = new MatchEvaluator(CapText)                  \n};  \n  \n```  \n  \n#### To use this sample  \n  \n1.  Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the RegexActivities.sln solution file.  \n  \n2.  To build the solution, press CTRL+SHIFT+B.  \n  \n3.  To run the solution, press CTRL+F5.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Scenario\\ActivityLibrary\\Regex`  \n  \n## See Also","nodes":[{"pos":[12,58],"content":"Regular Expression Activities | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Regular Expression Activities | Microsoft Docs","pos":[0,46]}]},{"pos":[323,352],"content":"Regular Expression Activities","linkify":"Regular Expression Activities","nodes":[{"content":"Regular Expression Activities","pos":[0,29]}]},{"content":"This sample demonstrates how to create a set of activities that expose the regular expression functionality of the <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions&gt;</ph> namespace.","pos":[353,516],"source":"This sample demonstrates how to create a set of activities that expose the regular expression functionality of the <xref:System.Text.RegularExpressions> namespace."},{"content":"These custom activities can be used within a workflow application.","pos":[517,583]},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph>regular expressions, see <bpt id=\"p1\">[</bpt>N:System.Text.RegularExpressions<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150434)</ept> Namespace.","pos":[584,756],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)]regular expressions, see [N:System.Text.RegularExpressions](http://go.microsoft.com/fwlink/?LinkId=150434) Namespace."},{"content":"The following table details the custom activities in this sample.","pos":[763,828]},{"content":"Activity","pos":[835,843]},{"content":"Description","pos":[844,855]},{"content":"IsMatch","pos":[897,904]},{"content":"Specifies whether the regular expression found a match in the input string.","pos":[905,980]},{"content":"Matches","pos":[985,992]},{"content":"Searches an input string for all occurrences of a regular expression and returns all the successful matches.","pos":[993,1101]},{"content":"Replace","pos":[1106,1113]},{"content":"Within a specified input string, replaces strings that match a regular expression pattern with a specified replacement string.","pos":[1114,1240]},{"pos":[1250,1257],"content":"IsMatch","linkify":"IsMatch","nodes":[{"content":"IsMatch","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`IsMatch`</ph> custom activity returns <ph id=\"ph2\">`true`</ph> if the <ph id=\"ph3\">`Input`</ph> string property finds a match in the regular expression specified in the <ph id=\"ph4\">`Pattern`</ph> property.","pos":[1261,1413],"source":"The `IsMatch` custom activity returns `true` if the `Input` string property finds a match in the regular expression specified in the `Pattern` property."},{"content":"The activity derives from <ph id=\"ph1\">&lt;xref:System.Activities.CodeActivity%601&gt;</ph> and within the <ph id=\"ph2\">&lt;xref:System.Activities.CodeActivity%601.Execute%2A&gt;</ph> method calls the <ph id=\"ph3\">&lt;xref:System.Text.RegularExpressions.Regex.IsMatch%2A&gt;</ph> method.","pos":[1414,1629],"source":" The activity derives from <xref:System.Activities.CodeActivity%601> and within the <xref:System.Activities.CodeActivity%601.Execute%2A> method calls the <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> method."},{"pos":[1636,1732],"content":"The following table describes the properties and return value for the <ph id=\"ph1\">`IsMatch`</ph> custom activity.","source":"The following table describes the properties and return value for the `IsMatch` custom activity."},{"content":"Property or Return Value","pos":[1739,1763]},{"content":"Description","pos":[1764,1775]},{"content":"Pattern (required)","pos":[1833,1851]},{"content":"The regular expression to search with.","pos":[1852,1890]},{"content":"Input (required)","pos":[1895,1911]},{"content":"The input string to search.","pos":[1912,1939]},{"content":"RegexOptions","pos":[1944,1956]},{"pos":[1957,2064],"content":"Bitwise OR combination of <bpt id=\"p1\">[</bpt>RegexOptions<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150446)</ept> enumeration values.","source":"Bitwise OR combination of [RegexOptions](http://go.microsoft.com/fwlink/?LinkId=150446) enumeration values."},{"content":"Return value","pos":[2069,2081]},{"pos":[2082,2159],"content":"<ph id=\"ph1\">`true`</ph> if the input finds a match in the provided pattern; otherwise <ph id=\"ph2\">`false`</ph>.","source":"`true` if the input finds a match in the provided pattern; otherwise `false`."},{"pos":[2167,2248],"content":"The following code example demonstrates how to use the <ph id=\"ph1\">`IsMatch`</ph> custom activity.","source":"The following code example demonstrates how to use the `IsMatch` custom activity."},{"pos":[2384,2391],"content":"Matches","linkify":"Matches","nodes":[{"content":"Matches","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`Matches`</ph> custom activity searches an input string for all occurrences of a regular expression and returns all the successful matches.","pos":[2395,2533],"source":"The `Matches` custom activity searches an input string for all occurrences of a regular expression and returns all the successful matches."},{"content":"The activity derives from <ph id=\"ph1\">&lt;xref:System.Activities.CodeActivity%601&gt;</ph> and within the <ph id=\"ph2\">&lt;xref:System.Activities.CodeActivity%601.Execute%2A&gt;</ph> method calls the <ph id=\"ph3\">&lt;xref:System.Text.RegularExpressions.Regex.Matches%2A&gt;</ph> method.","pos":[2534,2749],"source":" The activity derives from <xref:System.Activities.CodeActivity%601> and within the <xref:System.Activities.CodeActivity%601.Execute%2A> method calls the <xref:System.Text.RegularExpressions.Regex.Matches%2A> method."},{"pos":[2756,2852],"content":"The following table describes the properties and return value for the <ph id=\"ph1\">`IsMatch`</ph> custom activity.","source":"The following table describes the properties and return value for the `IsMatch` custom activity."},{"content":"Property or Return Value","pos":[2859,2883]},{"content":"Description","pos":[2884,2895]},{"content":"Pattern (required)","pos":[2953,2971]},{"content":"The regular expression to search with.","pos":[2972,3010]},{"content":"Input (required)","pos":[3015,3031]},{"content":"The input string to search.","pos":[3032,3059]},{"content":"RegexOptions","pos":[3064,3076]},{"pos":[3077,3184],"content":"Bitwise OR combination of <bpt id=\"p1\">[</bpt>RegexOptions<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150446)</ept> enumeration values.","source":"Bitwise OR combination of [RegexOptions](http://go.microsoft.com/fwlink/?LinkId=150446) enumeration values."},{"content":"Return Value","pos":[3189,3201]},{"content":"A <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.MatchCollection&gt;</ph> that contains the collection of successful matches.","pos":[3202,3309],"source":"A <xref:System.Text.RegularExpressions.MatchCollection> that contains the collection of successful matches."},{"pos":[3317,3398],"content":"The following code example demonstrates how to use the <ph id=\"ph1\">`Matches`</ph> custom activity.","source":"The following code example demonstrates how to use the `Matches` custom activity."},{"pos":[3575,3582],"content":"Replace","linkify":"Replace","nodes":[{"content":"Replace","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`Replace`</ph> custom activity searches an input string and replaces all strings that match a specified regular expression with a string.","pos":[3586,3722],"source":"The `Replace` custom activity searches an input string and replaces all strings that match a specified regular expression with a string."},{"content":"The activity derives from <ph id=\"ph1\">&lt;xref:System.Activities.CodeActivity%601&gt;</ph> and within the <ph id=\"ph2\">&lt;xref:System.Activities.CodeActivity%601.Execute%2A&gt;</ph> method calls the <ph id=\"ph3\">&lt;xref:System.Text.RegularExpressions.Regex.Replace%2A&gt;</ph> method.","pos":[3723,3938],"source":" The activity derives from <xref:System.Activities.CodeActivity%601> and within the <xref:System.Activities.CodeActivity%601.Execute%2A> method calls the <xref:System.Text.RegularExpressions.Regex.Replace%2A> method."},{"pos":[3945,4041],"content":"The following table describes the properties and return value for the <ph id=\"ph1\">`Replace`</ph> custom activity.","source":"The following table describes the properties and return value for the `Replace` custom activity."},{"content":"Property or Return Value","pos":[4048,4072]},{"content":"Description","pos":[4073,4084]},{"content":"Pattern (required)","pos":[4142,4160]},{"content":"The regular expression to search with.","pos":[4161,4199]},{"content":"Input (required)","pos":[4204,4220]},{"content":"The input string to search.","pos":[4221,4248]},{"content":"Replacement","pos":[4253,4264]},{"content":"The replacement string.","pos":[4265,4288]},{"content":"If a <ph id=\"ph1\">`Replacement`</ph> is specified, then the <ph id=\"ph2\">`MatchEvaluator`</ph> property is ignored.","pos":[4301,4380],"source":" If a `Replacement` is specified, then the `MatchEvaluator` property is ignored."},{"content":"Either the <ph id=\"ph1\">`Replacement`</ph> or <ph id=\"ph2\">`MatchEvaluator`</ph> property must be set.","pos":[4381,4447],"source":" Either the `Replacement` or `MatchEvaluator` property must be set."},{"content":"MatchEvaluator","pos":[4452,4466]},{"content":"A custom method that examines each match and returns either the original matched string or a replacement string.","pos":[4467,4579]},{"content":"If a <ph id=\"ph1\">`Replacement`</ph> is specified, then the <ph id=\"ph2\">`MatchEvaluator`</ph> property is ignored.","pos":[4592,4671],"source":" If a `Replacement` is specified, then the `MatchEvaluator` property is ignored."},{"content":"Either the <ph id=\"ph1\">`Replacement`</ph> or <ph id=\"ph2\">`MatchEvaluator`</ph> property must be set.","pos":[4672,4738],"source":" Either the `Replacement` or `MatchEvaluator` property must be set."},{"content":"RegexOptions","pos":[4743,4755]},{"pos":[4756,4863],"content":"Bitwise OR combination of <bpt id=\"p1\">[</bpt>RegexOptions<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150446)</ept> enumeration values.","source":"Bitwise OR combination of [RegexOptions](http://go.microsoft.com/fwlink/?LinkId=150446) enumeration values."},{"content":"Return Value","pos":[4868,4880]},{"content":"A <ph id=\"ph1\">&lt;xref:System.Text.RegularExpressions.MatchCollection&gt;</ph> that contains the collection of successful matches.","pos":[4881,4988],"source":"A <xref:System.Text.RegularExpressions.MatchCollection> that contains the collection of successful matches."},{"pos":[4996,5077],"content":"The following code example demonstrates how to use the <ph id=\"ph1\">`Replace`</ph> custom activity.","source":"The following code example demonstrates how to use the `Replace` custom activity."},{"pos":[5498,5516],"content":"To use this sample","linkify":"To use this sample","nodes":[{"content":"To use this sample","pos":[0,18]}]},{"pos":[5526,5630],"content":"Using <ph id=\"ph1\">[!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]</ph>, open the RegexActivities.sln solution file.","source":"Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the RegexActivities.sln solution file."},{"content":"To build the solution, press CTRL+SHIFT+B.","pos":[5640,5682]},{"content":"To run the solution, press CTRL+F5.","pos":[5692,5727]},{"pos":[5735,5867],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[5921,6247],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[6248,6298]},{"pos":[6384,6392],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]}]}