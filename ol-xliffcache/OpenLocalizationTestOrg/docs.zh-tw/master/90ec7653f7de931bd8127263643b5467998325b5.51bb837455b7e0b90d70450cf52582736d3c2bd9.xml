{"content":"---\ntitle: \"SqlCommand Execution with a SqlNotificationRequest\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nms.assetid: 1776f48f-9bea-41f6-83a4-c990c7a2c991\n---\n\n# SqlCommand Execution with a SqlNotificationRequest\n\nA <xref:System.Data.SqlClient.SqlCommand> can be configured to generate a notification when data changes after it has been fetched from the server and the result set would be different if the query were executed again. This is useful for scenarios where you want to use custom notification queues on the server or when you do not want to maintain live objects.\n\n## Creating the Notification Request\n\nYou can use a <xref:System.Data.Sql.SqlNotificationRequest> object to create the notification request by binding it to a `SqlCommand` object. Once the request is created, you no longer need the `SqlNotificationRequest` object. You can query the queue for any notifications and respond appropriately. Notifications can occur even if the application is shut down and subsequently restarted.\n\nWhen the command with the associated notification is executed, any changes to the original result set trigger sending a message to the SQL Server queue that was configured in the notification request.\n\nHow you poll the SQL Server queue and interpret the message is specific to your application. The application is responsible for polling the queue and reacting based on the contents of the message.\n\n> [!NOTE]\n> When using SQL Server notification requests with <xref:System.Data.SqlClient.SqlDependency>, create your own queue name instead of using the default service name.\n\nThere are no new client-side security elements for <xref:System.Data.Sql.SqlNotificationRequest>. This is primarily a server feature, and the server has created special privileges that users must have to request a notification.\n\n### Example\n\nThe following code fragment demonstrates how to create a <xref:System.Data.Sql.SqlNotificationRequest> and associate it with a <xref:System.Data.SqlClient.SqlCommand>.\n\n```vb\n' Assume connection is an open SqlConnection.\n' Create a new SqlCommand object.\nDim command As New SqlCommand( _\n  \"SELECT ShipperID, CompanyName, Phone FROM dbo.Shippers\", connection)\n\n' Create a SqlNotificationRequest object.\nDim notifcationRequest As New SqlNotificationRequest()\nnotificationRequest.id = \"NotificationID\"\nnotificationRequest.Service = \"mySSBQueue\"\n\n' Associate the notification request with the command.\ncommand.Notification = notificationRequest\n' Execute the command.\ncommand.ExecuteReader()\n' Process the DataReader.\n' You can use Transact-SQL syntax to periodically poll the\n' SQL Server queue to see if you have a new message.\n```\n\n```csharp\n// Assume connection is an open SqlConnection.\n// Create a new SqlCommand object.\nSqlCommand command=new SqlCommand(\n \"SELECT ShipperID, CompanyName, Phone FROM dbo.Shippers\", connection);\n\n// Create a SqlNotificationRequest object.\nSqlNotificationRequest notificationRequest=new SqlNotificationRequest();\nnotificationRequest.id=\"NotificationID\";\nnotificationRequest.Service=\"mySSBQueue\";\n\n// Associate the notification request with the command.\ncommand.Notification=notificationRequest;\n// Execute the command.\ncommand.ExecuteReader();\n// Process the DataReader.\n// You can use Transact-SQL syntax to periodically poll the\n// SQL Server queue to see if you have a new message.\n```\n\n## See also\n\n- [Query Notifications in SQL Server](../../../../../docs/framework/data/adonet/sql/query-notifications-in-sql-server.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,167],"embed":true,"restype":"x-metadata","content":"title: \"SqlCommand Execution with a SqlNotificationRequest\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nms.assetid: 1776f48f-9bea-41f6-83a4-c990c7a2c991","nodes":[{"content":"SqlCommand Execution with a SqlNotificationRequest","nodes":[{"pos":[0,50],"content":"SqlCommand Execution with a SqlNotificationRequest","nodes":[{"content":"SqlCommand Execution with a SqlNotificationRequest","pos":[0,50]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[175,225],"content":"SqlCommand Execution with a SqlNotificationRequest","linkify":"SqlCommand Execution with a SqlNotificationRequest","nodes":[{"content":"SqlCommand Execution with a SqlNotificationRequest","pos":[0,50]}]},{"content":"A <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlCommand&gt;</ph> can be configured to generate a notification when data changes after it has been fetched from the server and the result set would be different if the query were executed again.","pos":[227,445],"source":"A <xref:System.Data.SqlClient.SqlCommand> can be configured to generate a notification when data changes after it has been fetched from the server and the result set would be different if the query were executed again."},{"content":"This is useful for scenarios where you want to use custom notification queues on the server or when you do not want to maintain live objects.","pos":[446,587]},{"pos":[592,625],"content":"Creating the Notification Request","linkify":"Creating the Notification Request","nodes":[{"content":"Creating the Notification Request","pos":[0,33]}]},{"content":"You can use a <ph id=\"ph1\">&lt;xref:System.Data.Sql.SqlNotificationRequest&gt;</ph> object to create the notification request by binding it to a <ph id=\"ph2\">`SqlCommand`</ph> object.","pos":[627,768],"source":"You can use a <xref:System.Data.Sql.SqlNotificationRequest> object to create the notification request by binding it to a `SqlCommand` object."},{"content":"Once the request is created, you no longer need the <ph id=\"ph1\">`SqlNotificationRequest`</ph> object.","pos":[769,853],"source":" Once the request is created, you no longer need the `SqlNotificationRequest` object."},{"content":"You can query the queue for any notifications and respond appropriately.","pos":[854,926]},{"content":"Notifications can occur even if the application is shut down and subsequently restarted.","pos":[927,1015]},{"content":"When the command with the associated notification is executed, any changes to the original result set trigger sending a message to the SQL Server queue that was configured in the notification request.","pos":[1017,1217]},{"content":"How you poll the SQL Server queue and interpret the message is specific to your application.","pos":[1219,1311]},{"content":"The application is responsible for polling the queue and reacting based on the contents of the message.","pos":[1312,1415]},{"pos":[1419,1591],"content":"[!NOTE]\nWhen using SQL Server notification requests with <xref:System.Data.SqlClient.SqlDependency>, create your own queue name instead of using the default service name.","leadings":["","> "],"nodes":[{"content":"When using SQL Server notification requests with <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlDependency&gt;</ph>, create your own queue name instead of using the default service name.","pos":[8,170],"source":"When using SQL Server notification requests with <xref:System.Data.SqlClient.SqlDependency>, create your own queue name instead of using the default service name."}]},{"content":"There are no new client-side security elements for <ph id=\"ph1\">&lt;xref:System.Data.Sql.SqlNotificationRequest&gt;</ph>.","pos":[1593,1690],"source":"There are no new client-side security elements for <xref:System.Data.Sql.SqlNotificationRequest>."},{"content":"This is primarily a server feature, and the server has created special privileges that users must have to request a notification.","pos":[1691,1820]},{"pos":[1826,1833],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1835,2002],"content":"The following code fragment demonstrates how to create a <ph id=\"ph1\">&lt;xref:System.Data.Sql.SqlNotificationRequest&gt;</ph> and associate it with a <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlCommand&gt;</ph>.","source":"The following code fragment demonstrates how to create a <xref:System.Data.Sql.SqlNotificationRequest> and associate it with a <xref:System.Data.SqlClient.SqlCommand>."},{"pos":[3363,3371],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3375,3494],"content":"<bpt id=\"p1\">[</bpt>Query Notifications in SQL Server<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/query-notifications-in-sql-server.md)</ept>","source":"[Query Notifications in SQL Server](../../../../../docs/framework/data/adonet/sql/query-notifications-in-sql-server.md)"},{"pos":[3497,3601],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}