{"content":"---\ntitle: \"Query Expression Syntax Examples: Aggregate Operators (LINQ to DataSet)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 85dafa07-e102-46e7-ab78-37bf06f257a6\n---\n# Query Expression Syntax Examples: Aggregate Operators (LINQ to DataSet)\nThe examples in this topic demonstrate how to use the <xref:System.Linq.Enumerable.Average%2A>, <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.Max%2A>, <xref:System.Linq.Enumerable.Min%2A>, and <xref:System.Linq.Enumerable.Sum%2A> methods to query a <xref:System.Data.DataSet> and aggregate data using query expression syntax.  \n  \n The `FillDataSet` method used in these examples is specified in [Loading Data Into a DataSet](../../../../docs/framework/data/adonet/loading-data-into-a-dataset.md).  \n  \n The examples in this topic use the Contact, Address, Product, SalesOrderHeader, and SalesOrderDetail tables in the AdventureWorks sample database.  \n  \n The examples in this topic use the following `using`/`Imports` statements:  \n  \n [!code-csharp[DP LINQ to DataSet Examples#ImportsUsing](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#importsusing)]\n [!code-vb[DP LINQ to DataSet Examples#ImportsUsing](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#importsusing)]  \n  \n For more information, see [How to: Create a LINQ to DataSet Project In Visual Studio](../../../../docs/framework/data/adonet/how-to-create-a-linq-to-dataset-project-in-vs.md).  \n  \n## Average  \n  \n### Example  \n This example uses the <xref:System.Linq.Enumerable.Average%2A> method to find the average list price of the products of each style.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#Average2_MQ](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#average2_mq)]\n [!code-vb[DP LINQ to DataSet Examples#Average2_MQ](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#average2_mq)]  \n  \n### Example  \n This example uses <xref:System.Linq.Enumerable.Average%2A> to get the average total due for each contact ID.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#AverageGrouped_MQ](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#averagegrouped_mq)]\n [!code-vb[DP LINQ to DataSet Examples#AverageGrouped_MQ](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#averagegrouped_mq)]  \n  \n### Example  \n This example uses <xref:System.Linq.Enumerable.Average%2A> to get the orders with the average `TotalDue` for each contact.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#AverageElements_MQ](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#averageelements_mq)]\n [!code-vb[DP LINQ to DataSet Examples#AverageElements_MQ](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#averageelements_mq)]  \n  \n## Count  \n  \n### Example  \n This example uses <xref:System.Linq.Enumerable.Count%2A> to return a list of contact IDs and how many orders each has.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#CountNested](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#countnested)]\n [!code-vb[DP LINQ to DataSet Examples#CountNested](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#countnested)]  \n  \n### Example  \n This example groups products by color and uses <xref:System.Linq.Enumerable.Count%2A> to return the number of products in each color group.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#CountGrouped](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#countgrouped)]\n [!code-vb[DP LINQ to DataSet Examples#CountGrouped](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#countgrouped)]  \n  \n## Max  \n  \n### Example  \n This example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the largest total due for each contact ID.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#MaxGrouped_MQ](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#maxgrouped_mq)]\n [!code-vb[DP LINQ to DataSet Examples#MaxGrouped_MQ](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#maxgrouped_mq)]  \n  \n### Example  \n This example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the orders with the largest `TotalDue` for each contact ID.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#MaxElements_MQ](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#maxelements_mq)]\n [!code-vb[DP LINQ to DataSet Examples#MaxElements_MQ](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#maxelements_mq)]  \n  \n## Min  \n  \n### Example  \n This example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the smallest total due for each contact ID.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#MinGrouped_MQ](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#mingrouped_mq)]\n [!code-vb[DP LINQ to DataSet Examples#MinGrouped_MQ](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#mingrouped_mq)]  \n  \n### Example  \n This example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the orders with the smallest total due for each contact.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#MinElements_MQ](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#minelements_mq)]\n [!code-vb[DP LINQ to DataSet Examples#MinElements_MQ](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#minelements_mq)]  \n  \n## Sum  \n  \n### Example  \n This example uses the <xref:System.Linq.Enumerable.Sum%2A> method to get the total due for each contact ID.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#SumGrouped_MQ](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#sumgrouped_mq)]\n [!code-vb[DP LINQ to DataSet Examples#SumGrouped_MQ](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#sumgrouped_mq)]  \n  \n## See also\n\n- [Loading Data Into a DataSet](../../../../docs/framework/data/adonet/loading-data-into-a-dataset.md)\n- [LINQ to DataSet Examples](../../../../docs/framework/data/adonet/linq-to-dataset-examples.md)\n- [Standard Query Operators Overview (C#)](../../../csharp/programming-guide/concepts/linq/standard-query-operators-overview.md)\n- [Standard Query Operators Overview (Visual Basic)](../../../visual-basic/programming-guide/concepts/linq/standard-query-operators-overview.md)\n","nodes":[{"pos":[4,189],"embed":true,"restype":"x-metadata","content":"title: \"Query Expression Syntax Examples: Aggregate Operators (LINQ to DataSet)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 85dafa07-e102-46e7-ab78-37bf06f257a6","nodes":[{"content":"Query Expression Syntax Examples: Aggregate Operators (LINQ to DataSet)","nodes":[{"pos":[0,71],"content":"Query Expression Syntax Examples: Aggregate Operators (LINQ to DataSet)","nodes":[{"content":"Query Expression Syntax Examples: Aggregate Operators (LINQ to DataSet)","pos":[0,71]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[196,267],"content":"Query Expression Syntax Examples: Aggregate Operators (LINQ to DataSet)","linkify":"Query Expression Syntax Examples: Aggregate Operators (LINQ to DataSet)","nodes":[{"content":"Query Expression Syntax Examples: Aggregate Operators (LINQ to DataSet)","pos":[0,71]}]},{"pos":[268,616],"content":"The examples in this topic demonstrate how to use the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.Count%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Linq.Enumerable.Max%2A&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Linq.Enumerable.Min%2A&gt;</ph>, and <ph id=\"ph5\">&lt;xref:System.Linq.Enumerable.Sum%2A&gt;</ph> methods to query a <ph id=\"ph6\">&lt;xref:System.Data.DataSet&gt;</ph> and aggregate data using query expression syntax.","source":"The examples in this topic demonstrate how to use the <xref:System.Linq.Enumerable.Average%2A>, <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.Max%2A>, <xref:System.Linq.Enumerable.Min%2A>, and <xref:System.Linq.Enumerable.Sum%2A> methods to query a <xref:System.Data.DataSet> and aggregate data using query expression syntax."},{"pos":[623,788],"content":"The <ph id=\"ph1\">`FillDataSet`</ph> method used in these examples is specified in <bpt id=\"p1\">[</bpt>Loading Data Into a DataSet<ept id=\"p1\">](../../../../docs/framework/data/adonet/loading-data-into-a-dataset.md)</ept>.","source":"The `FillDataSet` method used in these examples is specified in [Loading Data Into a DataSet](../../../../docs/framework/data/adonet/loading-data-into-a-dataset.md)."},{"content":"The examples in this topic use the Contact, Address, Product, SalesOrderHeader, and SalesOrderDetail tables in the AdventureWorks sample database.","pos":[795,941]},{"pos":[948,1022],"content":"The examples in this topic use the following <ph id=\"ph1\">`using`</ph><ph id=\"ph2\">/</ph><ph id=\"ph3\">`Imports`</ph> statements:","source":"The examples in this topic use the following `using`/`Imports` statements:"},{"pos":[1375,1550],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Create a LINQ to DataSet Project In Visual Studio<ept id=\"p1\">](../../../../docs/framework/data/adonet/how-to-create-a-linq-to-dataset-project-in-vs.md)</ept>.","source":"For more information, see [How to: Create a LINQ to DataSet Project In Visual Studio](../../../../docs/framework/data/adonet/how-to-create-a-linq-to-dataset-project-in-vs.md)."},{"pos":[1559,1566],"content":"Average","linkify":"Average","nodes":[{"content":"Average","pos":[0,7]}]},{"pos":[1576,1583],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1587,1718],"content":"This example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph> method to find the average list price of the products of each style.","source":"This example uses the <xref:System.Linq.Enumerable.Average%2A> method to find the average list price of the products of each style."},{"pos":[2070,2077],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2081,2189],"content":"This example uses <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph> to get the average total due for each contact ID.","source":"This example uses <xref:System.Linq.Enumerable.Average%2A> to get the average total due for each contact ID."},{"pos":[2565,2572],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2576,2698],"content":"This example uses <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph> to get the orders with the average <ph id=\"ph2\">`TotalDue`</ph> for each contact.","source":"This example uses <xref:System.Linq.Enumerable.Average%2A> to get the orders with the average `TotalDue` for each contact."},{"pos":[3077,3082],"content":"Count","linkify":"Count","nodes":[{"content":"Count","pos":[0,5]}]},{"pos":[3092,3099],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3103,3221],"content":"This example uses <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Count%2A&gt;</ph> to return a list of contact IDs and how many orders each has.","source":"This example uses <xref:System.Linq.Enumerable.Count%2A> to return a list of contact IDs and how many orders each has."},{"pos":[3573,3580],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3584,3723],"content":"This example groups products by color and uses <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Count%2A&gt;</ph> to return the number of products in each color group.","source":"This example groups products by color and uses <xref:System.Linq.Enumerable.Count%2A> to return the number of products in each color group."},{"pos":[4078,4081],"content":"Max","linkify":"Max","nodes":[{"content":"Max","pos":[0,3]}]},{"pos":[4091,4098],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4102,4217],"content":"This example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Max%2A&gt;</ph> method to get the largest total due for each contact ID.","source":"This example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the largest total due for each contact ID."},{"pos":[4577,4584],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4588,4720],"content":"This example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Max%2A&gt;</ph> method to get the orders with the largest <ph id=\"ph2\">`TotalDue`</ph> for each contact ID.","source":"This example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the orders with the largest `TotalDue` for each contact ID."},{"pos":[5083,5086],"content":"Min","linkify":"Min","nodes":[{"content":"Min","pos":[0,3]}]},{"pos":[5096,5103],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5107,5223],"content":"This example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Min%2A&gt;</ph> method to get the smallest total due for each contact ID.","source":"This example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the smallest total due for each contact ID."},{"pos":[5583,5590],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5594,5723],"content":"This example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Min%2A&gt;</ph> method to get the orders with the smallest total due for each contact.","source":"This example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the orders with the smallest total due for each contact."},{"pos":[6086,6089],"content":"Sum","linkify":"Sum","nodes":[{"content":"Sum","pos":[0,3]}]},{"pos":[6099,6106],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[6110,6217],"content":"This example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Sum%2A&gt;</ph> method to get the total due for each contact ID.","source":"This example uses the <xref:System.Linq.Enumerable.Sum%2A> method to get the total due for each contact ID."},{"pos":[6576,6584],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6588,6688],"content":"<bpt id=\"p1\">[</bpt>Loading Data Into a DataSet<ept id=\"p1\">](../../../../docs/framework/data/adonet/loading-data-into-a-dataset.md)</ept>","source":"[Loading Data Into a DataSet](../../../../docs/framework/data/adonet/loading-data-into-a-dataset.md)"},{"pos":[6691,6785],"content":"<bpt id=\"p1\">[</bpt>LINQ to DataSet Examples<ept id=\"p1\">](../../../../docs/framework/data/adonet/linq-to-dataset-examples.md)</ept>","source":"[LINQ to DataSet Examples](../../../../docs/framework/data/adonet/linq-to-dataset-examples.md)"},{"pos":[6788,6914],"content":"<bpt id=\"p1\">[</bpt>Standard Query Operators Overview (C#)<ept id=\"p1\">](../../../csharp/programming-guide/concepts/linq/standard-query-operators-overview.md)</ept>","source":"[Standard Query Operators Overview (C#)](../../../csharp/programming-guide/concepts/linq/standard-query-operators-overview.md)"},{"pos":[6917,7059],"content":"<bpt id=\"p1\">[</bpt>Standard Query Operators Overview (Visual Basic)<ept id=\"p1\">](../../../visual-basic/programming-guide/concepts/linq/standard-query-operators-overview.md)</ept>","source":"[Standard Query Operators Overview (Visual Basic)](../../../visual-basic/programming-guide/concepts/linq/standard-query-operators-overview.md)"}]}