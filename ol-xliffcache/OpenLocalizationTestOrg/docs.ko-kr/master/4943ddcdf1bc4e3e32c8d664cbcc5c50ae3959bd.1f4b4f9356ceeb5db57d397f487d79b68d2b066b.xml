{"content":"---\ntitle: \"Virtual Members\"\nms.date: \"10/22/2008\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"overridable members\"\n  - \"virtual members\"\n  - \"members [.NET Framework], virtual\"\nms.assetid: 8ff4eb97-0364-43ec-8a02-934b5cd94d19\nauthor: \"KrzysztofCwalina\"\n---\n# Virtual Members\nVirtual members can be overridden, thus changing the behavior of the subclass. They are quite similar to callbacks in terms of the extensibility they provide, but they are better in terms of execution performance and memory consumption. Also, virtual members feel more natural in scenarios that require creating a special kind of an existing type (specialization).  \n  \n Virtual members perform better than callbacks and events, but do not perform better than non-virtual methods.  \n  \n The main disadvantage of virtual members is that the behavior of a virtual member can only be modified at the time of compilation. The behavior of a callback can be modified at runtime.  \n  \n Virtual members, like callbacks (and maybe more than callbacks), are costly to design, test, and maintain because any call to a virtual member can be overridden in unpredictable ways and can execute arbitrary code. Also, much more effort is usually required to clearly define the contract of virtual members, so the cost of designing and documenting them is higher.  \n  \n **X DO NOT** make members virtual unless you have a good reason to do so and you are aware of all the costs related to designing, testing, and maintaining virtual members.  \n  \n Virtual members are less forgiving in terms of changes that can be made to them without breaking compatibility. Also, they are slower than non-virtual members, mostly because calls to virtual members are not inlined.  \n  \n **✓ CONSIDER** limiting extensibility to only what is absolutely necessary.  \n  \n **✓ DO** prefer protected accessibility over public accessibility for virtual members. Public members should provide extensibility (if required) by calling into a protected virtual member.  \n  \n The public members of a class should provide the right set of functionality for direct consumers of that class. Virtual members are designed to be overridden in subclasses, and protected accessibility is a great way to scope all virtual extensibility points to where they can be used.  \n  \n *Portions © 2005, 2009 Microsoft Corporation. All rights reserved.*  \n  \n *Reprinted by permission of Pearson Education, Inc. from [Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619) by Krzysztof Cwalina and Brad Abrams, published Oct 22, 2008 by Addison-Wesley Professional as part of the Microsoft Windows Development Series.*  \n  \n## See also\n\n- [Framework Design Guidelines](../../../docs/standard/design-guidelines/index.md)\n- [Designing for Extensibility](../../../docs/standard/design-guidelines/designing-for-extensibility.md)\n","nodes":[{"pos":[4,267],"embed":true,"restype":"x-metadata","content":"title: \"Virtual Members\"\nms.date: \"10/22/2008\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"overridable members\"\n  - \"virtual members\"\n  - \"members [.NET Framework], virtual\"\nms.assetid: 8ff4eb97-0364-43ec-8a02-934b5cd94d19\nauthor: \"KrzysztofCwalina\"","nodes":[{"content":"Virtual Members","nodes":[{"pos":[0,15],"content":"Virtual Members","nodes":[{"content":"Virtual Members","pos":[0,15]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[274,289],"content":"Virtual Members","linkify":"Virtual Members","nodes":[{"content":"Virtual Members","pos":[0,15]}]},{"content":"Virtual members can be overridden, thus changing the behavior of the subclass.","pos":[290,368]},{"content":"They are quite similar to callbacks in terms of the extensibility they provide, but they are better in terms of execution performance and memory consumption.","pos":[369,526]},{"content":"Also, virtual members feel more natural in scenarios that require creating a special kind of an existing type (specialization).","pos":[527,654]},{"content":"Virtual members perform better than callbacks and events, but do not perform better than non-virtual methods.","pos":[661,770]},{"content":"The main disadvantage of virtual members is that the behavior of a virtual member can only be modified at the time of compilation.","pos":[777,907]},{"content":"The behavior of a callback can be modified at runtime.","pos":[908,962]},{"content":"Virtual members, like callbacks (and maybe more than callbacks), are costly to design, test, and maintain because any call to a virtual member can be overridden in unpredictable ways and can execute arbitrary code.","pos":[969,1183]},{"content":"Also, much more effort is usually required to clearly define the contract of virtual members, so the cost of designing and documenting them is higher.","pos":[1184,1334]},{"pos":[1341,1512],"content":"<bpt id=\"p1\">**</bpt>X DO NOT<ept id=\"p1\">**</ept> make members virtual unless you have a good reason to do so and you are aware of all the costs related to designing, testing, and maintaining virtual members.","source":"**X DO NOT** make members virtual unless you have a good reason to do so and you are aware of all the costs related to designing, testing, and maintaining virtual members."},{"content":"Virtual members are less forgiving in terms of changes that can be made to them without breaking compatibility.","pos":[1519,1630]},{"content":"Also, they are slower than non-virtual members, mostly because calls to virtual members are not inlined.","pos":[1631,1735]},{"pos":[1742,1817],"content":"<bpt id=\"p1\">**</bpt>✓ CONSIDER<ept id=\"p1\">**</ept> limiting extensibility to only what is absolutely necessary.","source":"**✓ CONSIDER** limiting extensibility to only what is absolutely necessary."},{"content":"<bpt id=\"p1\">**</bpt>✓ DO<ept id=\"p1\">**</ept> prefer protected accessibility over public accessibility for virtual members.","pos":[1824,1910],"source":"**✓ DO** prefer protected accessibility over public accessibility for virtual members."},{"content":"Public members should provide extensibility (if required) by calling into a protected virtual member.","pos":[1911,2012]},{"content":"The public members of a class should provide the right set of functionality for direct consumers of that class.","pos":[2019,2130]},{"content":"Virtual members are designed to be overridden in subclasses, and protected accessibility is a great way to scope all virtual extensibility points to where they can be used.","pos":[2131,2303]},{"pos":[2310,2377],"content":"<bpt id=\"p1\">*</bpt>Portions © 2005, 2009 Microsoft Corporation. All rights reserved.<ept id=\"p1\">*</ept>","source":"*Portions © 2005, 2009 Microsoft Corporation. All rights reserved.*"},{"pos":[2384,2789],"content":"<bpt id=\"p1\">*</bpt>Reprinted by permission of Pearson Education, Inc. from <bpt id=\"p2\">[</bpt>Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition<ept id=\"p2\">](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619)</ept> by Krzysztof Cwalina and Brad Abrams, published Oct 22, 2008 by Addison-Wesley Professional as part of the Microsoft Windows Development Series.<ept id=\"p1\">*</ept>","source":"*Reprinted by permission of Pearson Education, Inc. from [Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619) by Krzysztof Cwalina and Brad Abrams, published Oct 22, 2008 by Addison-Wesley Professional as part of the Microsoft Windows Development Series.*"},{"pos":[2798,2806],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2810,2890],"content":"<bpt id=\"p1\">[</bpt>Framework Design Guidelines<ept id=\"p1\">](../../../docs/standard/design-guidelines/index.md)</ept>","source":"[Framework Design Guidelines](../../../docs/standard/design-guidelines/index.md)"},{"pos":[2893,2995],"content":"<bpt id=\"p1\">[</bpt>Designing for Extensibility<ept id=\"p1\">](../../../docs/standard/design-guidelines/designing-for-extensibility.md)</ept>","source":"[Designing for Extensibility](../../../docs/standard/design-guidelines/designing-for-extensibility.md)"}]}