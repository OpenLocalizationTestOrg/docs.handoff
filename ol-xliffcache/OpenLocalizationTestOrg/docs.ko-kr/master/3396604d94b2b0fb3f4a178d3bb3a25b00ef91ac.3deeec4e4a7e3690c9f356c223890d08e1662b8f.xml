{"content":"---\ntitle: \"Walkthrough: Hosting WPF Content in Win32\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"cpp\"\nhelpviewer_keywords:\n  - \"hosting WPF content in Win32 window [WPF]\"\nms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc\n---\n# Walkthrough: Hosting WPF Content in Win32\n[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides a rich environment for creating applications. However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.  \n  \n This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window. You can extend this sample to host any [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window. Because it involves mixing managed and unmanaged code, the application is written in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].  \n\n<a name=\"requirements\"></a>   \n## Requirements  \n This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming. For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../getting-started/index.md). For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.  \n  \n Because the sample that accompanies this tutorial is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], this tutorial assumes familiarity with the use of [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] to program the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)][!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] plus an understanding of managed code programming. Familiarity with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] is helpful but not essential.  \n  \n> [!NOTE]\n>  This tutorial includes a number of code examples from the associated sample. However, for readability, it does not include the complete sample code. For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004).  \n  \n<a name=\"basic_procedure\"></a>   \n## The Basic Procedure  \n This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window. The remaining sections explain the details of each step.  \n  \n The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class. This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window. The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.  \n  \n1.  Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.  \n  \n2.  Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]. If you are starting with an existing application and unmanaged [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.  \n  \n3.  Set the threading model to single-threaded apartment (STA).  \n  \n4.  Handle the [WM_CREATE](/windows/desktop/winmsg/wm-create)notification in your window procedure and do the following:  \n  \n    1.  Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.  \n  \n    2.  Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.  \n  \n    3.  Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.  \n  \n    4.  Get the HWND for the content. The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND). To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.  \n  \n5.  Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content. This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.  \n  \n6.  Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.  \n  \n7.  Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.  \n  \n8.  Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.  \n  \n> [!NOTE]\n>  You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content. However, you will have to compile it separately as a [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] and reference that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application. The remainder of the procedure is similar to that outlined above.\n\n<a name=\"implementing_the_application\"></a>\n## Implementing the Host Application\n This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application. The content itself is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] as a managed class. For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming. The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).\n\n<a name=\"autoNestedSectionsOUTLINE1\"></a>\n-   [The Basic Application](#the_basic_application)\n\n-   [Hosting the WPF Content](#hosting_the_wpf_page)\n\n-   [Holding a Reference to the WPF Content](#holding_a_reference)\n\n-   [Communicating with the WPF Content](#communicating_with_the_page)\n\n<a name=\"the_basic_application\"></a>\n### The Basic Application\n The starting point for the host application was to create a Visual Studio 2005 template.\n\n1.  Open Visual Studio 2005, and select **New Project** from the **File** menu.\n\n2.  Select **Win32** from the list of [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] project types. If your default language is not [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], you will find these project types under **Other Languages**.\n\n3.  Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.\n\n4.  Accept the wizard's default settings and click **Finish** to start the project.\n\n The template creates a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application, including:\n\n-   An entry point for the application.\n\n-   A window, with an associated window procedure (WndProc).\n\n-   A menu with **File** and **Help** headings. The **File** menu has an **Exit** item that closes the application. The **Help** menu has an **About** item that launches a simple dialog box.\n\n Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.\n\n The first is to compile the project as managed code. By default, the project compiles as unmanaged code. However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.\n\n1.  Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.\n\n2.  Select **Configuration Properties** from the tree view in the left pane.\n\n3.  Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.\n\n4.  Select **Common Language Runtime Support (/clr)** from the drop-down list box.\n\n> [!NOTE]\n>  This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.\n\n [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses the single-threaded apartment (STA) threading model. In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.\n\n [!code-cpp[Win32HostingWPFPage#WinMain](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]\n\n<a name=\"hosting_the_wpf_page\"></a>\n### Hosting the WPF Content\n The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application. It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on. There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**. When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`. When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`. The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.\n\n The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](/windows/desktop/winmsg/wm-create) notification on the host window.\n\n [!code-cpp[Win32HostingWPFPage#WMCreate](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]\n\n The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.\n\n> [!NOTE]\n>  You cannot use a `#using` directive for the `System::Windows::Interop` namespace. Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h. You must instead use fully-qualified names to access the contents of that namespace.\n\n [!code-cpp[Win32HostingWPFPage#GetHwnd](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]\n\n You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window. Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content. This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content. You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is part of your application. The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] child window.\n\n You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object. In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]. You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]. However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)]. You can add a reference to that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.\n\n You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.\n\n The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event. This handler is called when the user clicks the **OK** or **Cancel** button. See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.\n\n The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object. You can use this handle from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code to send messages to the hosted window, although the sample does not do so. The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message. To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.\n\n<a name=\"holding_a_reference\"></a>\n### Holding a Reference to the WPF Content\n For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later. For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content. To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content. The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle. However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure. The customary way to handle this issue with [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications is to use a static or global variable. Unfortunately, you cannot assign a managed object to those types of variables. You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.\n\n The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to. The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user. This is defined in the header.\n\n [!code-cpp[Win32HostingWPFPage#WPFPageHost](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]\n\n The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.\n\n<a name=\"communicating_with_the_page\"></a>\n### Communicating with the WPF Content\n There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content. The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons. The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.\n\n As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event. The application attaches a handler to this event to receive these notifications. If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.\n\n [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]\n\n The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`. The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.\n\n If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class. It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window. Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control. If the **Cancel** button was clicked, the handler clears the data from the static controls.\n\n The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties. The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color. The others are similar, and are not shown. See the complete sample for details and context.\n\n [!code-cpp[Win32HostingWPFPage#WMCommandToBG](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]\n\n To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color. The sample uses three color options: the original color, light green, or light salmon. The original background color is stored as a static field in the `WPFPageHost` class. To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.\n\n<a name=\"implementing_the_wpf_page\"></a>\n## Implementing the WPF Page\n You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation. If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], it could have been built in any [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] language. Following is a brief walkthrough of the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementation that is used in the sample. This section contains the following subsections.\n\n<a name=\"autoNestedSectionsOUTLINE2\"></a>\n-   [Layout](#page_layout)\n\n-   [Returning the Data to the Host Window](#returning_data_to_window)\n\n-   [Setting the WPF Properties](#set_page_properties)\n\n<a name=\"page_layout\"></a>\n### Layout\n The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip. There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**\n\n The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class. Layout is handled with a <xref:System.Windows.Controls.Grid> layout element. The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.\n\n The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly. It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively. This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.\n\n [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]\n\n Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>. The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.\n\n [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]\n\n The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control. Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs. The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell. After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid. The code to add the remaining label/textbox pairs is similar. See the sample code for details.\n\n [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]\n\n The implementation of the two methods is as follows:\n\n [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]\n\n Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.\n\n [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]\n\n<a name=\"returning_data_to_window\"></a>\n### Returning the Data to the Host Window\n When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised. The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls. The sample uses a somewhat less direct approach. It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content. This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host. The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.\n\n The event declaration, in WPFPage.h:\n\n [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]\n\n The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:\n\n [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]\n\n<a name=\"set_page_properties\"></a>\n### Setting the WPF Properties\n The [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties. From the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] side, it is simply a matter of changing the properties. The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls. Instead, the appropriate property for each control is changed in the properties' set accessors. The following example shows the code for the `DefaultFontFamily` property. Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.\n\n From WPFPage.h:\n\n [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]\n\n From WPFPage.cpp:\n\n [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]\n\n## See also\n\n- <xref:System.Windows.Interop.HwndSource>\n- [WPF and Win32 Interoperation](wpf-and-win32-interoperation.md)","nodes":[{"pos":[4,215],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Hosting WPF Content in Win32\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"cpp\"\nhelpviewer_keywords:\n  - \"hosting WPF content in Win32 window [WPF]\"\nms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc","nodes":[{"content":"Walkthrough: Hosting WPF Content in Win32","nodes":[{"pos":[0,41],"content":"Walkthrough: Hosting WPF Content in Win32","nodes":[{"content":"Walkthrough: Hosting WPF Content in Win32","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[222,263],"content":"Walkthrough: Hosting WPF Content in Win32","linkify":"Walkthrough: Hosting WPF Content in Win32","nodes":[{"content":"Walkthrough: Hosting WPF Content in Win32","pos":[0,41]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> provides a rich environment for creating applications.","pos":[264,398],"source":"[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides a rich environment for creating applications."},{"content":"However, when you have a substantial investment in <ph id=\"ph1\">[!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)]</ph> code, it might be more effective to add <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> functionality to your application rather than rewriting your original code.","pos":[399,719],"source":" However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> provides a straightforward mechanism for hosting <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content in a <ph id=\"ph3\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window.","pos":[720,1027],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window."},{"content":"This tutorial describes how to write a sample application, <bpt id=\"p1\">[</bpt>Hosting WPF Content in a Win32 Window Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=160004)</ept>, that hosts <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content in a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window.","pos":[1034,1376],"source":"This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window."},{"content":"You can extend this sample to host any <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window.","pos":[1377,1497],"source":" You can extend this sample to host any [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window."},{"content":"Because it involves mixing managed and unmanaged code, the application is written in <ph id=\"ph1\">[!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]</ph>.","pos":[1498,1657],"source":" Because it involves mixing managed and unmanaged code, the application is written in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]."},{"pos":[1695,1707],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"content":"This tutorial assumes a basic familiarity with both <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> programming.","pos":[1711,1935],"source":"This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming."},{"content":"For a basic introduction to <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> programming, see <bpt id=\"p1\">[</bpt>Getting Started<ept id=\"p1\">](../getting-started/index.md)</ept>.","pos":[1936,2110],"source":" For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../getting-started/index.md)."},{"content":"For an introduction to <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> programming, you should reference any of the numerous books on the subject, in particular <bpt id=\"p1\">*</bpt>Programming Windows<ept id=\"p1\">*</ept> by Charles Petzold.","pos":[2111,2339],"source":" For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold."},{"content":"Because the sample that accompanies this tutorial is implemented in <ph id=\"ph1\">[!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]</ph>, this tutorial assumes familiarity with the use of <ph id=\"ph2\">[!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)]</ph> to program the <ph id=\"ph3\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph><ph id=\"ph4\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> plus an understanding of managed code programming.","pos":[2346,2815],"source":"Because the sample that accompanies this tutorial is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], this tutorial assumes familiarity with the use of [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] to program the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)][!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] plus an understanding of managed code programming."},{"content":"Familiarity with <ph id=\"ph1\">[!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]</ph> is helpful but not essential.","pos":[2816,2936],"source":" Familiarity with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] is helpful but not essential."},{"pos":[2944,3233],"content":"[!NOTE]\n This tutorial includes a number of code examples from the associated sample. However, for readability, it does not include the complete sample code. For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004).","leadings":["","> "],"nodes":[{"content":"This tutorial includes a number of code examples from the associated sample. However, for readability, it does not include the complete sample code. For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004).","pos":[9,287],"nodes":[{"content":"This tutorial includes a number of code examples from the associated sample.","pos":[0,76]},{"content":"However, for readability, it does not include the complete sample code.","pos":[77,148]},{"content":"For the complete sample code, see <bpt id=\"p1\">[</bpt>Hosting WPF Content in a Win32 Window Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=160004)</ept>.","pos":[149,278],"source":" For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004)."}]}]},{"pos":[3276,3295],"content":"The Basic Procedure","linkify":"The Basic Procedure","nodes":[{"content":"The Basic Procedure","pos":[0,19]}]},{"content":"This section outlines the basic procedure you use to host <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content in a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window.","pos":[3299,3533],"source":"This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window."},{"content":"The remaining sections explain the details of each step.","pos":[3534,3590]},{"content":"The key to hosting <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content on a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window is the <ph id=\"ph3\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> class.","pos":[3597,3846],"source":"The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class."},{"content":"This class wraps the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content in a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window, allowing it to be incorporated into your <ph id=\"ph3\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph> as a child window.","pos":[3847,4170],"source":" This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window."},{"content":"The following approach combines the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> in a single application.","pos":[4171,4391],"source":" The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application."},{"pos":[4401,4525],"content":"Implement your <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content as a managed class.","source":"Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class."},{"content":"Implement a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> application with <ph id=\"ph2\">[!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]</ph>.","pos":[4535,4712],"source":"Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]."},{"content":"If you are starting with an existing application and unmanaged <ph id=\"ph1\">[!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)]</ph> code, you can usually enable it to call managed code by changing your project settings to include the <ph id=\"ph2\">`/clr`</ph> compiler flag.","pos":[4713,4967],"source":" If you are starting with an existing application and unmanaged [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag."},{"content":"Set the threading model to single-threaded apartment (STA).","pos":[4977,5036]},{"pos":[5046,5162],"content":"Handle the <bpt id=\"p1\">[</bpt>WM_CREATE<ept id=\"p1\">](/windows/desktop/winmsg/wm-create)</ept>notification in your window procedure and do the following:","source":"Handle the [WM_CREATE](/windows/desktop/winmsg/wm-create)notification in your window procedure and do the following:"},{"pos":[5176,5286],"content":"Create a new <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object with the parent window as its <ph id=\"ph2\">`parent`</ph> parameter.","source":"Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter."},{"pos":[5300,5423],"content":"Create an instance of your <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content class.","source":"Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class."},{"pos":[5437,5679],"content":"Assign a reference to the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content object to the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSource.RootVisual%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph>.","source":"Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>."},{"content":"Get the HWND for the content.","pos":[5693,5722]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource.Handle%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object contains the window handle (HWND).","pos":[5723,5876],"source":" The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND)."},{"content":"To get an HWND that you can use in the unmanaged part of your application, cast <ph id=\"ph1\">`Handle.ToPointer()`</ph> to an HWND.","pos":[5877,5989],"source":" To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND."},{"content":"Implement a managed class that contains a static field to hold a reference to your <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content.","pos":[5999,6172],"source":"Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content."},{"content":"This class allows you to get a reference to the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content from your <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> code.","pos":[6173,6400],"source":" This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code."},{"pos":[6410,6531],"content":"Assign the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content to the static field.","source":"Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field."},{"pos":[6541,6796],"content":"Receive notifications from the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content by attaching a handler to one or more of the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> events.","source":"Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events."},{"pos":[6806,7005],"content":"Communicate with the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content by using the reference that you stored in the static field to set properties, and so on.","source":"Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on."},{"pos":[7013,7592],"content":"[!NOTE]\n You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content. However, you will have to compile it separately as a [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] and reference that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application. The remainder of the procedure is similar to that outlined above.","leadings":["","> "],"nodes":[{"content":"You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content. However, you will have to compile it separately as a [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] and reference that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application. The remainder of the procedure is similar to that outlined above.","pos":[9,577],"nodes":[{"content":"You can also use <ph id=\"ph1\">[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]</ph> to implement your <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content.","pos":[0,195],"source":"You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content."},{"content":"However, you will have to compile it separately as a <ph id=\"ph1\">[!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)]</ph> and reference that <ph id=\"ph2\">[!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)]</ph> from your <ph id=\"ph3\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> application.","pos":[196,502],"source":" However, you will have to compile it separately as a [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] and reference that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application."},{"content":"The remainder of the procedure is similar to that outlined above.","pos":[503,568]}]}]},{"pos":[7641,7674],"content":"Implementing the Host Application","linkify":"Implementing the Host Application","nodes":[{"content":"Implementing the Host Application","pos":[0,33]}]},{"content":"This section describes how to host <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content in a basic <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> application.","pos":[7676,7898],"source":"This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application."},{"content":"The content itself is implemented in <ph id=\"ph1\">[!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]</ph> as a managed class.","pos":[7899,8029],"source":" The content itself is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] as a managed class."},{"content":"For the most part, it is straightforward <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> programming.","pos":[8030,8165],"source":" For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming."},{"content":"The key aspects of the content implementation are discussed in <bpt id=\"p1\">[</bpt>Implementing the WPF Content<ept id=\"p1\">](#implementing_the_wpf_page)</ept>.","pos":[8166,8288],"source":" The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page)."},{"pos":[8336,8383],"content":"<bpt id=\"p1\">[</bpt>The Basic Application<ept id=\"p1\">](#the_basic_application)</ept>","source":"[The Basic Application](#the_basic_application)"},{"pos":[8389,8437],"content":"<bpt id=\"p1\">[</bpt>Hosting the WPF Content<ept id=\"p1\">](#hosting_the_wpf_page)</ept>","source":"[Hosting the WPF Content](#hosting_the_wpf_page)"},{"pos":[8443,8505],"content":"<bpt id=\"p1\">[</bpt>Holding a Reference to the WPF Content<ept id=\"p1\">](#holding_a_reference)</ept>","source":"[Holding a Reference to the WPF Content](#holding_a_reference)"},{"pos":[8511,8577],"content":"<bpt id=\"p1\">[</bpt>Communicating with the WPF Content<ept id=\"p1\">](#communicating_with_the_page)</ept>","source":"[Communicating with the WPF Content](#communicating_with_the_page)"},{"pos":[8620,8641],"content":"The Basic Application","linkify":"The Basic Application","nodes":[{"content":"The Basic Application","pos":[0,21]}]},{"content":"The starting point for the host application was to create a Visual Studio 2005 template.","pos":[8643,8731]},{"pos":[8737,8812],"content":"Open Visual Studio 2005, and select <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu.","source":"Open Visual Studio 2005, and select **New Project** from the **File** menu."},{"content":"Select <bpt id=\"p1\">**</bpt>Win32<ept id=\"p1\">**</ept> from the list of <ph id=\"ph1\">[!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)]</ph> project types.","pos":[8818,8948],"source":"Select **Win32** from the list of [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] project types."},{"content":"If your default language is not <ph id=\"ph1\">[!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)]</ph>, you will find these project types under <bpt id=\"p1\">**</bpt>Other Languages<ept id=\"p1\">**</ept>.","pos":[8949,9112],"source":" If your default language is not [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], you will find these project types under **Other Languages**."},{"pos":[9118,9244],"content":"Select a <bpt id=\"p1\">**</bpt>Win32 Project<ept id=\"p1\">**</ept> template, assign a name to the project and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept> to launch the <bpt id=\"p3\">**</bpt>Win32 Application Wizard<ept id=\"p3\">**</ept>.","source":"Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**."},{"pos":[9250,9329],"content":"Accept the wizard's default settings and click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to start the project.","source":"Accept the wizard's default settings and click **Finish** to start the project."},{"pos":[9332,9458],"content":"The template creates a basic <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> application, including:","source":"The template creates a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application, including:"},{"content":"An entry point for the application.","pos":[9464,9499]},{"content":"A window, with an associated window procedure (WndProc).","pos":[9505,9561]},{"content":"A menu with <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Help<ept id=\"p2\">**</ept> headings.","pos":[9567,9610],"source":"A menu with **File** and **Help** headings."},{"content":"The <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu has an <bpt id=\"p2\">**</bpt>Exit<ept id=\"p2\">**</ept> item that closes the application.","pos":[9611,9678],"source":" The **File** menu has an **Exit** item that closes the application."},{"content":"The <bpt id=\"p1\">**</bpt>Help<ept id=\"p1\">**</ept> menu has an <bpt id=\"p2\">**</bpt>About<ept id=\"p2\">**</ept> item that launches a simple dialog box.","pos":[9679,9753],"source":" The **Help** menu has an **About** item that launches a simple dialog box."},{"pos":[9756,9946],"content":"Before you start writing code to host the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content, you need to make two modifications to the basic template.","source":"Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template."},{"content":"The first is to compile the project as managed code.","pos":[9949,10001]},{"content":"By default, the project compiles as unmanaged code.","pos":[10002,10053]},{"content":"However, because <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> is implemented in managed code, the project must be compiled accordingly.","pos":[10054,10226],"source":" However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly."},{"pos":[10232,10378],"content":"Right-click the project name in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and select <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> from the context menu to launch the <bpt id=\"p3\">**</bpt>Property Pages<ept id=\"p3\">**</ept> dialog box.","source":"Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box."},{"pos":[10384,10456],"content":"Select <bpt id=\"p1\">**</bpt>Configuration Properties<ept id=\"p1\">**</ept> from the tree view in the left pane.","source":"Select **Configuration Properties** from the tree view in the left pane."},{"pos":[10462,10558],"content":"Select <bpt id=\"p1\">**</bpt>Common Language Runtime<ept id=\"p1\">**</ept> support from the <bpt id=\"p2\">**</bpt>Project Defaults<ept id=\"p2\">**</ept> list in the right pane.","source":"Select **Common Language Runtime** support from the **Project Defaults** list in the right pane."},{"pos":[10564,10642],"content":"Select <bpt id=\"p1\">**</bpt>Common Language Runtime Support (/clr)<ept id=\"p1\">**</ept> from the drop-down list box.","source":"Select **Common Language Runtime Support (/clr)** from the drop-down list box."},{"pos":[10646,10781],"content":"[!NOTE]\n This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.","leadings":["","> "],"nodes":[{"content":"This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.","pos":[9,133]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> uses the single-threaded apartment (STA) threading model.","pos":[10784,10923],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses the single-threaded apartment (STA) threading model."},{"content":"In order to work properly with the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content code, you must set the application's threading model to STA by applying an attribute to the entry point.","pos":[10924,11153],"source":" In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point."},{"pos":[11334,11357],"content":"Hosting the WPF Content","linkify":"Hosting the WPF Content","nodes":[{"content":"Hosting the WPF Content","pos":[0,23]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content is a simple address entry application.","pos":[11359,11491],"source":"The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application."},{"content":"It consists of several <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> controls to take user name, address, and so on.","pos":[11492,11601],"source":" It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on."},{"content":"There are also two <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button&gt;</ph> controls, <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept>.","pos":[11602,11691],"source":" There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**."},{"content":"When the user clicks <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>, the button's <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase.Click&gt;</ph> event handler collects the data from the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> controls, assigns it to corresponding properties, and raises a custom event, <ph id=\"ph3\">`OnButtonClicked`</ph>.","pos":[11692,11968],"source":" When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`."},{"content":"When the user clicks <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept>, the handler simply raises <ph id=\"ph1\">`OnButtonClicked`</ph>.","pos":[11969,12046],"source":" When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`."},{"content":"The event argument object for <ph id=\"ph1\">`OnButtonClicked`</ph> contains a Boolean field that indicates which button was clicked.","pos":[12047,12160],"source":" The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked."},{"pos":[12163,12389],"content":"The code to host the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content is implemented in a handler for the <bpt id=\"p1\">[</bpt>WM_CREATE<ept id=\"p1\">](/windows/desktop/winmsg/wm-create)</ept> notification on the host window.","source":"The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](/windows/desktop/winmsg/wm-create) notification on the host window."},{"pos":[12533,12754],"content":"The <ph id=\"ph1\">`GetHwnd`</ph> method takes size and position information plus the parent window handle and returns the window handle of the hosted <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content.","source":"The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content."},{"pos":[12758,13088],"content":"[!NOTE]\n You cannot use a `#using` directive for the `System::Windows::Interop` namespace. Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h. You must instead use fully-qualified names to access the contents of that namespace.","leadings":["","> "],"nodes":[{"content":"You cannot use a `#using` directive for the `System::Windows::Interop` namespace. Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h. You must instead use fully-qualified names to access the contents of that namespace.","pos":[9,328],"nodes":[{"content":"You cannot use a <ph id=\"ph1\">`#using`</ph> directive for the <ph id=\"ph2\">`System::Windows::Interop`</ph> namespace.","pos":[0,81],"source":"You cannot use a `#using` directive for the `System::Windows::Interop` namespace."},{"content":"Doing so creates a name collision between the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.MSG&gt;</ph> structure in that namespace and the MSG structure declared in winuser.h.","pos":[82,234],"source":" Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h."},{"content":"You must instead use fully-qualified names to access the contents of that namespace.","pos":[235,319]}]}]},{"content":"You cannot host the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content directly in your application window.","pos":[13230,13376],"source":"You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window."},{"content":"Instead, you first create an <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object to wrap the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content.","pos":[13377,13556],"source":" Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content."},{"content":"This object is basically a window that is designed to host a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content.","pos":[13557,13708],"source":" This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content."},{"content":"You host the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object in the parent window by creating it as a child of a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> window that is part of your application.","pos":[13709,13936],"source":" You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is part of your application."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> constructor parameters contain much the same information that you would pass to CreateWindow when you create a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> child window.","pos":[13937,14180],"source":" The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] child window."},{"content":"You next create an instance of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content object.","pos":[14183,14315],"source":"You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object."},{"content":"In this case, the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content is implemented as a separate class, <ph id=\"ph2\">`WPFPage`</ph>, using <ph id=\"ph3\">[!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]</ph>.","pos":[14316,14551],"source":" In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]."},{"content":"You could also implement the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content with <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph>.","pos":[14552,14748],"source":" You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]."},{"content":"However, to do so you need to set up a separate project and build the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content as a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)]</ph>.","pos":[14749,14984],"source":" However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)]."},{"content":"You can add a reference to that <ph id=\"ph1\">[!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)]</ph> to your project, and use that reference to create an instance of the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content.","pos":[14985,15246],"source":" You can add a reference to that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content."},{"pos":[15249,15617],"content":"You display the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content in your child window by assigning a reference to the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content to the <ph id=\"ph3\">&lt;xref:System.Windows.Interop.HwndSource.RootVisual%2A&gt;</ph> property of the <ph id=\"ph4\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph>.","source":"You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>."},{"content":"The next line of code attaches an event handler, <ph id=\"ph1\">`WPFButtonClicked`</ph>, to the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content <ph id=\"ph3\">`OnButtonClicked`</ph> event.","pos":[15620,15810],"source":"The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event."},{"content":"This handler is called when the user clicks the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> button.","pos":[15811,15887],"source":" This handler is called when the user clicks the **OK** or **Cancel** button."},{"content":"See <bpt id=\"p1\">[</bpt>communicating_with_the_WPF content<ept id=\"p1\">](#communicating_with_the_page)</ept> for further discussion of this event handler.","pos":[15888,16004],"source":" See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler."},{"content":"The final line of code shown returns the window handle (HWND) that is associated with the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object.","pos":[16007,16145],"source":"The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object."},{"content":"You can use this handle from your <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> code to send messages to the hosted window, although the sample does not do so.","pos":[16146,16333],"source":" You can use this handle from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code to send messages to the hosted window, although the sample does not do so."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object raises an event every time it receives a message.","pos":[16334,16435],"source":" The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message."},{"content":"To process the messages, call the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource.AddHook%2A&gt;</ph> method to attach a message handler and then process the messages in that handler.","pos":[16436,16603],"source":" To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler."},{"pos":[16644,16682],"content":"Holding a Reference to the WPF Content","linkify":"Holding a Reference to the WPF Content","nodes":[{"content":"Holding a Reference to the WPF Content","pos":[0,38]}]},{"content":"For many applications, you will want to communicate with the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content later.","pos":[16684,16841],"source":"For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later."},{"content":"For example, you might want to modify the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content properties, or perhaps have the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object host different <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content.","pos":[16842,17159],"source":" For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content."},{"content":"To do this, you need a reference to the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object or the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content.","pos":[17160,17345],"source":" To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object and its associated <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content remain in memory until you destroy the window handle.","pos":[17346,17560],"source":" The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle."},{"content":"However, the variable you assign to the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object will go out of scope as soon as you return from the window procedure.","pos":[17561,17718],"source":" However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure."},{"content":"The customary way to handle this issue with <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> applications is to use a static or global variable.","pos":[17719,17888],"source":" The customary way to handle this issue with [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications is to use a static or global variable."},{"content":"Unfortunately, you cannot assign a managed object to those types of variables.","pos":[17889,17967]},{"content":"You can assign the window handle associated with <ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph> object to a global or static variable, but that doe not provide access to the object itself.","pos":[17968,18150],"source":" You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself."},{"content":"The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.","pos":[18153,18324]},{"content":"The sample uses the <ph id=\"ph1\">`WPFPageHost`</ph> class to hold a reference to the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content, plus the initial values of a number of its properties that might be changed later by the user.","pos":[18325,18577],"source":" The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user."},{"content":"This is defined in the header.","pos":[18578,18608]},{"pos":[18756,18876],"content":"The latter part of the <ph id=\"ph1\">`GetHwnd`</ph> function assigns values to those fields for later use while <ph id=\"ph2\">`myPage`</ph> is still in scope.","source":"The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope."},{"pos":[18925,18959],"content":"Communicating with the WPF Content","linkify":"Communicating with the WPF Content","nodes":[{"content":"Communicating with the WPF Content","pos":[0,34]}]},{"content":"There are two types of communication with the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content.","pos":[18961,19097],"source":"There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content."},{"content":"The application receives information from the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content when the user clicks the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> buttons.","pos":[19098,19288],"source":" The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons."},{"content":"The application also has a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> that allows the user to change various <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content properties, such as the background color or default font size.","pos":[19289,19575],"source":" The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size."},{"content":"As mentioned above, when the user clicks either button the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content raises an <ph id=\"ph2\">`OnButtonClicked`</ph> event.","pos":[19578,19761],"source":"As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event."},{"content":"The application attaches a handler to this event to receive these notifications.","pos":[19762,19842]},{"content":"If the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button was clicked, the handler gets the user information from the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content and displays it in a set of static controls.","pos":[19843,20058],"source":" If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls."},{"content":"The handler receives a custom event argument object from the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content, <ph id=\"ph2\">`MyPageEventArgs`</ph>.","pos":[20218,20388],"source":"The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`."},{"content":"The object's <ph id=\"ph1\">`IsOK`</ph> property is set to <ph id=\"ph2\">`true`</ph> if the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button was clicked, and <ph id=\"ph3\">`false`</ph> if the <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> button was clicked.","pos":[20389,20518],"source":" The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked."},{"content":"If the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button was clicked, the handler gets a reference to the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content from the container class.","pos":[20521,20706],"source":"If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class."},{"content":"It then collects the user information that is held by the associated <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content properties and uses the static controls to display the information on the parent window.","pos":[20707,20954],"source":" It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window."},{"content":"Because the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content data is in the form of a managed string, it has to be marshaled for use by a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> control.","pos":[20955,21216],"source":" Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control."},{"content":"If the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button was clicked, the handler clears the data from the static controls.","pos":[21217,21308],"source":" If the **Cancel** button was clicked, the handler clears the data from the static controls."},{"content":"The application <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> provides a set of radio buttons that allow the user to modify the background color of the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content, and several font-related properties.","pos":[21311,21612],"source":"The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties."},{"content":"The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.","pos":[21613,21807]},{"content":"The others are similar, and are not shown.","pos":[21808,21850]},{"content":"See the complete sample for details and context.","pos":[21851,21899]},{"content":"To set the background color, get a reference to the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content (<ph id=\"ph2\">`hostedPage`</ph>) from <ph id=\"ph3\">`WPFPageHost`</ph> and set the background color property to the appropriate color.","pos":[22053,22292],"source":"To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color."},{"content":"The sample uses three color options: the original color, light green, or light salmon.","pos":[22293,22379]},{"content":"The original background color is stored as a static field in the <ph id=\"ph1\">`WPFPageHost`</ph> class.","pos":[22380,22465],"source":" The original background color is stored as a static field in the `WPFPageHost` class."},{"content":"To set the other two, you create a new <ph id=\"ph1\">&lt;xref:System.Windows.Media.SolidColorBrush&gt;</ph> object and pass the constructor a static colors value from the <ph id=\"ph2\">&lt;xref:System.Windows.Media.Colors&gt;</ph> object.","pos":[22466,22654],"source":" To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object."},{"pos":[22700,22725],"content":"Implementing the WPF Page","linkify":"Implementing the WPF Page","nodes":[{"content":"Implementing the WPF Page","pos":[0,25]}]},{"content":"You can host and use the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content without any knowledge of the actual implementation.","pos":[22727,22893],"source":"You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation."},{"content":"If the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content had been packaged in a separate <ph id=\"ph2\">[!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)]</ph>, it could have been built in any <ph id=\"ph3\">[!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)]</ph> language.","pos":[22894,23203],"source":" If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], it could have been built in any [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] language."},{"content":"Following is a brief walkthrough of the <ph id=\"ph1\">[!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]</ph> implementation that is used in the sample.","pos":[23204,23360],"source":" Following is a brief walkthrough of the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementation that is used in the sample."},{"content":"This section contains the following subsections.","pos":[23361,23409]},{"pos":[23457,23479],"content":"<bpt id=\"p1\">[</bpt>Layout<ept id=\"p1\">](#page_layout)</ept>","source":"[Layout](#page_layout)"},{"pos":[23485,23551],"content":"<bpt id=\"p1\">[</bpt>Returning the Data to the Host Window<ept id=\"p1\">](#returning_data_to_window)</ept>","source":"[Returning the Data to the Host Window](#returning_data_to_window)"},{"pos":[23557,23607],"content":"<bpt id=\"p1\">[</bpt>Setting the WPF Properties<ept id=\"p1\">](#set_page_properties)</ept>","source":"[Setting the WPF Properties](#set_page_properties)"},{"pos":[23640,23646],"content":"Layout","linkify":"Layout","nodes":[{"content":"Layout","pos":[0,6]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> elements in the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content consist of five <ph id=\"ph3\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> controls, with associated <ph id=\"ph4\">&lt;xref:System.Windows.Controls.Label&gt;</ph> controls: Name, Address, City, State, and Zip.","pos":[23648,23990],"source":"The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip."},{"content":"There are also two <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button&gt;</ph> controls, <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept>","pos":[23991,24079],"source":" There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**"},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content is implemented in the <ph id=\"ph2\">`WPFPage`</ph> class.","pos":[24082,24214],"source":"The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class."},{"content":"Layout is handled with a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> layout element.","pos":[24215,24291],"source":" Layout is handled with a <xref:System.Windows.Controls.Grid> layout element."},{"content":"The class inherits from <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph>, which effectively makes it the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content root element.","pos":[24292,24487],"source":" The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element."},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content constructor takes the required width and height, and sizes the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> accordingly.","pos":[24490,24695],"source":"The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly."},{"content":"It then defines the basic layout by creating a set of <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ColumnDefinition&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Controls.RowDefinition&gt;</ph> objects and adding them to the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> object base <ph id=\"ph4\">&lt;xref:System.Windows.Controls.Grid.ColumnDefinitions%2A&gt;</ph> and <ph id=\"ph5\">&lt;xref:System.Windows.Controls.Grid.RowDefinitions%2A&gt;</ph> collections, respectively.","pos":[24696,25067],"source":" It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively."},{"content":"This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.","pos":[25068,25180]},{"content":"Next, the constructor adds the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> elements to the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Grid&gt;</ph>.","pos":[25336,25487],"source":"Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>."},{"content":"The first element is the title text, which is a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Label&gt;</ph> control that is centered in the first row of the grid.","pos":[25488,25627],"source":" The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid."},{"content":"The next row contains the Name <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Label&gt;</ph> control and its associated <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> control.","pos":[25775,25917],"source":"The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control."},{"content":"Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.","pos":[25918,26061]},{"content":"The methods create the appropriate control, and call the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> class static <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Grid.SetColumn%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Grid.SetRow%2A&gt;</ph> methods to place the controls in the appropriate cell.","pos":[26062,26321],"source":" The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell."},{"content":"After the control is created, the sample calls the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.UIElementCollection.Add%2A&gt;</ph> method on the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Panel.Children%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> to add the control to the grid.","pos":[26322,26577],"source":" After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid."},{"content":"The code to add the remaining label/textbox pairs is similar.","pos":[26578,26639]},{"content":"See the sample code for details.","pos":[26640,26672]},{"content":"The implementation of the two methods is as follows:","pos":[26818,26870]},{"pos":[27026,27190],"content":"Finally, the sample adds the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> buttons and attaches an event handler to their <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase.Click&gt;</ph> events.","source":"Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events."},{"pos":[27397,27434],"content":"Returning the Data to the Host Window","linkify":"Returning the Data to the Host Window","nodes":[{"content":"Returning the Data to the Host Window","pos":[0,37]}]},{"content":"When either button is clicked, its <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase.Click&gt;</ph> event is raised.","pos":[27436,27546],"source":"When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised."},{"content":"The host window could simply attach handlers to these events and get the data directly from the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> controls.","pos":[27547,27691],"source":" The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls."},{"content":"The sample uses a somewhat less direct approach.","pos":[27692,27740]},{"content":"It handles the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase.Click&gt;</ph> within the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content, and then raises a custom event <ph id=\"ph3\">`OnButtonClicked`</ph>, to notify the <ph id=\"ph4\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content.","pos":[27741,28071],"source":" It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content."},{"content":"This allows the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content to do some parameter validation before notifying the host.","pos":[28072,28236],"source":" This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host."},{"content":"The handler gets the text from the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> controls and assigns it to public properties, from which the host can retrieve the information.","pos":[28237,28406],"source":" The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information."},{"content":"The event declaration, in WPFPage.h:","pos":[28409,28445]},{"pos":[28591,28684],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase.Click&gt;</ph> event handler, in WPFPage.cpp:","source":"The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:"},{"pos":[28878,28904],"content":"Setting the WPF Properties","linkify":"Setting the WPF Properties","nodes":[{"content":"Setting the WPF Properties","pos":[0,26]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> host allows the user to change several <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content properties.","pos":[28906,29124],"source":"The [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties."},{"content":"From the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</ph> side, it is simply a matter of changing the properties.","pos":[29125,29263],"source":" From the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] side, it is simply a matter of changing the properties."},{"content":"The implementation in the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.","pos":[29264,29500],"source":" The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls."},{"content":"Instead, the appropriate property for each control is changed in the properties' set accessors.","pos":[29501,29596]},{"content":"The following example shows the code for the <ph id=\"ph1\">`DefaultFontFamily`</ph> property.","pos":[29597,29671],"source":" The following example shows the code for the `DefaultFontFamily` property."},{"content":"Setting the property calls a private method that in turn sets the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Control.FontFamily%2A&gt;</ph> properties for the various controls.","pos":[29672,29827],"source":" Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls."},{"content":"From WPFPage.h:","pos":[29830,29845]},{"content":"From WPFPage.cpp:","pos":[30009,30026]},{"pos":[30184,30192],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[30239,30302],"content":"<bpt id=\"p1\">[</bpt>WPF and Win32 Interoperation<ept id=\"p1\">](wpf-and-win32-interoperation.md)</ept>","source":"[WPF and Win32 Interoperation](wpf-and-win32-interoperation.md)"}]}