{"content":"---\ntitle: \"UI Automation Events for Clients\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"UI Automation, events for clients\"\n  - \"events, UI Automation clients\"\nms.assetid: b909e388-3f24-4997-b6d4-bd9c35c2dc27\n---\n# UI Automation Events for Clients\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This topic describes how [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] events are used by UI Automation clients.  \n  \n [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] allows clients to subscribe to events of interest. This capability improves performance by eliminating the need to continually poll all the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements in the system to see if any information, structure, or state has changed.  \n  \n Efficiency is also improved by the ability to listen for events only within a defined scope. For example, a client can listen for focus change events on all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements in the tree, or on just one element and its descendants.  \n  \n> [!NOTE]\n>  Do not assume that all possible events are raised by a [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] provider. For example, not all property changes cause events to be raised by the standard proxy providers for [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] controls.  \n  \n For a broader view of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events, see [UI Automation Events Overview](../../../docs/framework/ui-automation/ui-automation-events-overview.md).  \n  \n<a name=\"Subscribing_to_Events\"></a>   \n## Subscribing to Events  \n Client applications subscribe to events of a particular kind by registering an event handler, using one of the following methods.  \n  \n|Method|Event Type|Event Arguments Type|Delegate Type|  \n|------------|----------------|--------------------------|-------------------|  \n|<xref:System.Windows.Automation.Automation.AddAutomationFocusChangedEventHandler%2A>|Focus change|<xref:System.Windows.Automation.AutomationFocusChangedEventArgs>|<xref:System.Windows.Automation.AutomationFocusChangedEventHandler>|  \n|<xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A>|Property change|<xref:System.Windows.Automation.AutomationPropertyChangedEventArgs>|<xref:System.Windows.Automation.AutomationPropertyChangedEventHandler>|  \n|<xref:System.Windows.Automation.Automation.AddStructureChangedEventHandler%2A>|Structure change|<xref:System.Windows.Automation.StructureChangedEventArgs>|<xref:System.Windows.Automation.StructureChangedEventHandler>|  \n|<xref:System.Windows.Automation.Automation.AddAutomationEventHandler%2A>|All other events, identified by an <xref:System.Windows.Automation.AutomationEvent>|<xref:System.Windows.Automation.AutomationEventArgs> or <xref:System.Windows.Automation.WindowClosedEventArgs>|<xref:System.Windows.Automation.AutomationEventHandler>|  \n  \n Before calling the method, you must create a delegate method to handle the event. If you prefer, you can handle different kinds of events in a single method, and pass this method in multiple calls to one of the methods in the table. For example, a single <xref:System.Windows.Automation.AutomationEventHandler> can be set up to handle various events differently according to the <xref:System.Windows.Automation.AutomationEventArgs.EventId%2A>.  \n  \n> [!NOTE]\n>  To process window-closed events, cast the argument type that is passed to the event handler as <xref:System.Windows.Automation.WindowClosedEventArgs>. Because the [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] element for the window is no longer valid, you cannot use the `sender` parameter to retrieve information; use <xref:System.Windows.Automation.WindowClosedEventArgs.GetRuntimeId%2A> instead.  \n  \n> [!CAUTION]\n>  If your application might receive events from its own [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], do not use your application's [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] thread to subscribe to events, or to unsubscribe. Doing so might lead to unpredictable behavior. For more information, see [UI Automation Threading Issues](../../../docs/framework/ui-automation/ui-automation-threading-issues.md).  \n  \n On shutdown, or when [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events are no longer of interest to the application, UI Automation clients should call one of the following methods.  \n  \n|Method|Description|  \n|------------|-----------------|  \n|<xref:System.Windows.Automation.Automation.RemoveAutomationEventHandler%2A>|Unregisters an event handler that was registered by using <xref:System.Windows.Automation.Automation.AddAutomationEventHandler%2A>.|  \n|<xref:System.Windows.Automation.Automation.RemoveAutomationFocusChangedEventHandler%2A>|Unregisters an event handler that was registered by using <xref:System.Windows.Automation.Automation.AddAutomationFocusChangedEventHandler%2A>.|  \n|<xref:System.Windows.Automation.Automation.RemoveAutomationPropertyChangedEventHandler%2A>|Unregisters an event handler that was registered by using <xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A>.|  \n|<xref:System.Windows.Automation.Automation.RemoveAllEventHandlers%2A>|Unregisters all registered event handlers.|  \n  \n For example code, see [Subscribe to UI Automation Events](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md).  \n  \n## See also\n\n- [Subscribe to UI Automation Events](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md)\n- [UI Automation Events Overview](../../../docs/framework/ui-automation/ui-automation-events-overview.md)\n- [UI Automation Properties Overview](../../../docs/framework/ui-automation/ui-automation-properties-overview.md)\n- [TrackFocus Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/FocusTracker)\n","nodes":[{"pos":[4,214],"embed":true,"restype":"x-metadata","content":"title: \"UI Automation Events for Clients\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"UI Automation, events for clients\"\n  - \"events, UI Automation clients\"\nms.assetid: b909e388-3f24-4997-b6d4-bd9c35c2dc27","nodes":[{"content":"UI Automation Events for Clients","nodes":[{"pos":[0,32],"content":"UI Automation Events for Clients","nodes":[{"content":"UI Automation Events for Clients","pos":[0,32]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[221,253],"content":"UI Automation Events for Clients","linkify":"UI Automation Events for Clients","nodes":[{"content":"UI Automation Events for Clients","pos":[0,32]}]},{"pos":[256,719],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,461],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"pos":[726,875],"content":"This topic describes how <ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> events are used by UI Automation clients.","source":"This topic describes how [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] events are used by UI Automation clients."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> allows clients to subscribe to events of interest.","pos":[882,1017],"source":"[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] allows clients to subscribe to events of interest."},{"content":"This capability improves performance by eliminating the need to continually poll all the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]</ph> elements in the system to see if any information, structure, or state has changed.","pos":[1018,1254],"source":" This capability improves performance by eliminating the need to continually poll all the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements in the system to see if any information, structure, or state has changed."},{"content":"Efficiency is also improved by the ability to listen for events only within a defined scope.","pos":[1261,1353]},{"content":"For example, a client can listen for focus change events on all <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> elements in the tree, or on just one element and its descendants.","pos":[1354,1568],"source":" For example, a client can listen for focus change events on all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements in the tree, or on just one element and its descendants."},{"pos":[1576,1994],"content":"[!NOTE]\n Do not assume that all possible events are raised by a [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] provider. For example, not all property changes cause events to be raised by the standard proxy providers for [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] controls.","leadings":["","> "],"nodes":[{"content":"Do not assume that all possible events are raised by a [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] provider. For example, not all property changes cause events to be raised by the standard proxy providers for [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] controls.","pos":[9,416],"nodes":[{"content":"Do not assume that all possible events are raised by a <ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> provider.","pos":[0,147],"source":"Do not assume that all possible events are raised by a [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] provider."},{"content":"For example, not all property changes cause events to be raised by the standard proxy providers for <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)]</ph> controls.","pos":[148,407],"source":" For example, not all property changes cause events to be raised by the standard proxy providers for [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] controls."}]}]},{"pos":[2001,2224],"content":"For a broader view of <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> events, see <bpt id=\"p1\">[</bpt>UI Automation Events Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-events-overview.md)</ept>.","source":"For a broader view of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events, see [UI Automation Events Overview](../../../docs/framework/ui-automation/ui-automation-events-overview.md)."},{"pos":[2273,2294],"content":"Subscribing to Events","linkify":"Subscribing to Events","nodes":[{"content":"Subscribing to Events","pos":[0,21]}]},{"content":"Client applications subscribe to events of a particular kind by registering an event handler, using one of the following methods.","pos":[2298,2427]},{"content":"Method","pos":[2434,2440]},{"content":"Event Type","pos":[2441,2451]},{"content":"Event Arguments Type","pos":[2452,2472]},{"content":"Delegate Type","pos":[2473,2486]},{"content":"Focus change","pos":[2657,2669]},{"content":"Property change","pos":[2895,2910]},{"content":"Structure change","pos":[3133,3149]},{"pos":[3348,3431],"content":"All other events, identified by an <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationEvent&gt;</ph>","source":"All other events, identified by an <xref:System.Windows.Automation.AutomationEvent>"},{"pos":[3432,3542],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationEventArgs&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Automation.WindowClosedEventArgs&gt;</ph>","source":"<xref:System.Windows.Automation.AutomationEventArgs> or <xref:System.Windows.Automation.WindowClosedEventArgs>"},{"content":"Before calling the method, you must create a delegate method to handle the event.","pos":[3606,3687]},{"content":"If you prefer, you can handle different kinds of events in a single method, and pass this method in multiple calls to one of the methods in the table.","pos":[3688,3838]},{"content":"For example, a single <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationEventHandler&gt;</ph> can be set up to handle various events differently according to the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationEventArgs.EventId%2A&gt;</ph>.","pos":[3839,4049],"source":" For example, a single <xref:System.Windows.Automation.AutomationEventHandler> can be set up to handle various events differently according to the <xref:System.Windows.Automation.AutomationEventArgs.EventId%2A>."},{"pos":[4057,4503],"content":"[!NOTE]\n To process window-closed events, cast the argument type that is passed to the event handler as <xref:System.Windows.Automation.WindowClosedEventArgs>. Because the [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] element for the window is no longer valid, you cannot use the `sender` parameter to retrieve information; use <xref:System.Windows.Automation.WindowClosedEventArgs.GetRuntimeId%2A> instead.","leadings":["","> "],"nodes":[{"content":"To process window-closed events, cast the argument type that is passed to the event handler as <xref:System.Windows.Automation.WindowClosedEventArgs>. Because the [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] element for the window is no longer valid, you cannot use the `sender` parameter to retrieve information; use <xref:System.Windows.Automation.WindowClosedEventArgs.GetRuntimeId%2A> instead.","pos":[9,444],"nodes":[{"content":"To process window-closed events, cast the argument type that is passed to the event handler as <ph id=\"ph1\">&lt;xref:System.Windows.Automation.WindowClosedEventArgs&gt;</ph>.","pos":[0,150],"source":"To process window-closed events, cast the argument type that is passed to the event handler as <xref:System.Windows.Automation.WindowClosedEventArgs>."},{"content":"Because the <ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> element for the window is no longer valid, you cannot use the <ph id=\"ph2\">`sender`</ph> parameter to retrieve information; use <ph id=\"ph3\">&lt;xref:System.Windows.Automation.WindowClosedEventArgs.GetRuntimeId%2A&gt;</ph> instead.","pos":[151,435],"source":" Because the [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] element for the window is no longer valid, you cannot use the `sender` parameter to retrieve information; use <xref:System.Windows.Automation.WindowClosedEventArgs.GetRuntimeId%2A> instead."}]}]},{"pos":[4511,4969],"content":"[!CAUTION]\n If your application might receive events from its own [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], do not use your application's [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] thread to subscribe to events, or to unsubscribe. Doing so might lead to unpredictable behavior. For more information, see [UI Automation Threading Issues](../../../docs/framework/ui-automation/ui-automation-threading-issues.md).","leadings":["","> "],"nodes":[{"content":"If your application might receive events from its own [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], do not use your application's [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] thread to subscribe to events, or to unsubscribe. Doing so might lead to unpredictable behavior. For more information, see [UI Automation Threading Issues](../../../docs/framework/ui-automation/ui-automation-threading-issues.md).","pos":[12,456],"nodes":[{"content":"If your application might receive events from its own <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]</ph>, do not use your application's <ph id=\"ph2\">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]</ph> thread to subscribe to events, or to unsubscribe.","pos":[0,264],"source":"If your application might receive events from its own [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], do not use your application's [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] thread to subscribe to events, or to unsubscribe."},{"content":"Doing so might lead to unpredictable behavior.","pos":[265,311]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>UI Automation Threading Issues<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-threading-issues.md)</ept>.","pos":[312,444],"source":" For more information, see [UI Automation Threading Issues](../../../docs/framework/ui-automation/ui-automation-threading-issues.md)."}]}]},{"pos":[4976,5198],"content":"On shutdown, or when <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> events are no longer of interest to the application, UI Automation clients should call one of the following methods.","source":"On shutdown, or when [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events are no longer of interest to the application, UI Automation clients should call one of the following methods."},{"content":"Method","pos":[5205,5211]},{"content":"Description","pos":[5212,5223]},{"pos":[5339,5470],"content":"Unregisters an event handler that was registered by using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Automation.AddAutomationEventHandler%2A&gt;</ph>.","source":"Unregisters an event handler that was registered by using <xref:System.Windows.Automation.Automation.AddAutomationEventHandler%2A>."},{"pos":[5563,5706],"content":"Unregisters an event handler that was registered by using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Automation.AddAutomationFocusChangedEventHandler%2A&gt;</ph>.","source":"Unregisters an event handler that was registered by using <xref:System.Windows.Automation.Automation.AddAutomationFocusChangedEventHandler%2A>."},{"pos":[5802,5948],"content":"Unregisters an event handler that was registered by using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A&gt;</ph>.","source":"Unregisters an event handler that was registered by using <xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A>."},{"content":"Unregisters all registered event handlers.","pos":[6023,6065]},{"pos":[6073,6207],"content":"For example code, see <bpt id=\"p1\">[</bpt>Subscribe to UI Automation Events<ept id=\"p1\">](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md)</ept>.","source":"For example code, see [Subscribe to UI Automation Events](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md)."},{"pos":[6216,6224],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6228,6339],"content":"<bpt id=\"p1\">[</bpt>Subscribe to UI Automation Events<ept id=\"p1\">](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md)</ept>","source":"[Subscribe to UI Automation Events](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md)"},{"pos":[6342,6445],"content":"<bpt id=\"p1\">[</bpt>UI Automation Events Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-events-overview.md)</ept>","source":"[UI Automation Events Overview](../../../docs/framework/ui-automation/ui-automation-events-overview.md)"},{"pos":[6448,6559],"content":"<bpt id=\"p1\">[</bpt>UI Automation Properties Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-properties-overview.md)</ept>","source":"[UI Automation Properties Overview](../../../docs/framework/ui-automation/ui-automation-properties-overview.md)"},{"pos":[6562,6662],"content":"<bpt id=\"p1\">[</bpt>TrackFocus Sample<ept id=\"p1\">](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/FocusTracker)</ept>","source":"[TrackFocus Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/FocusTracker)"}]}