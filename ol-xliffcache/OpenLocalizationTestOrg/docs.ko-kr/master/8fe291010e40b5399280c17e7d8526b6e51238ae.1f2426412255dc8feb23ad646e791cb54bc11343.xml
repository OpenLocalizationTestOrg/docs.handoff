{"content":"---\ntitle: \"CorBindToRuntimeHost Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"CorBindToRuntimeHost\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"CorBindToRuntimeHost\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CorBindToRuntimeHost function [.NET Framework hosting]\"\nms.assetid: 5c826ba3-8258-49bc-a417-78807915fcaf\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 28\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# CorBindToRuntimeHost Function\nEnables hosts to load a specified version of the common language runtime (CLR) into a process.  \n  \n This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)].  \n  \n## Syntax  \n  \n```  \nHRESULT CorBindToRuntimeHost (  \n    [in] LPCWSTR       pwszVersion,   \n    [in] LPCWSTR       pwszBuildFlavor,   \n    [in] LPCWSTR       pwszHostConfigFile,   \n    [in] VOID*         pReserved,   \n    [in] DWORD         startupFlags,   \n    [in] REFCLSID      rclsid,   \n    [in] REFIID        riid,   \n    [out] LPVOID FAR  *ppv  \n);  \n```  \n  \n#### Parameters  \n `pwszVersion`  \n [in] A string that describes the version of the CLR you want to load.  \n  \n A version number in the .NET Framework consists of four parts separated by periods: *major.minor.build.revision*. The string passed as `pwszVersion` must start with the character \"v\" followed by the first three parts of the version number (for example, \"v1.0.1529\").  \n  \n Some versions of the CLR are installed with a policy statement that specifies compatibility with previous versions of the CLR. By default, the startup shim evaluates `pwszVersion` against policy statements and loads the latest version of the runtime that is compatible with the version being requested. A host can force the shim to skip policy evaluation and load the exact version specified in `pwszVersion` by passing a value of STARTUP_LOADER_SAFEMODE for the `startupFlags` parameter.  \n  \n If `pwszVersion` is `null,` the method does not load any version of the CLR. Instead, it returns CLR_E_SHIM_RUNTIMELOAD, which indicates that it failed to load the runtime.  \n  \n `pwszBuildFlavor`  \n [in] A string that specifies whether to load the server or the workstation build of the CLR. Valid values are `svr` and `wks`. The server build is optimized to take advantage of multiple processors for garbage collections, and the workstation build is optimized for client applications running on a single-processor machine.  \n  \n If `pwszBuildFlavor`is set to null, the workstation build is loaded. When running on a single-processor machine, the workstation build is always loaded, even if `pwszBuildFlavor`is set to `svr`. However, if `pwszBuildFlavor`is set to `svr` and concurrent garbage collection is specified (see the description of the `startupFlags` parameter), the server build is loaded.  \n  \n> [!NOTE]\n>  Concurrent garbage collection is not supported in applications running the WOW64 x86 emulator on 64-bit systems that implement the Intel Itanium architecture (formerly called IA-64). For more information about using WOW64 on 64-bit Windows systems, see [Running 32-bit Applications](http://msdn.microsoft.com/library/windows/desktop/aa384249.aspx).  \n  \n `pwszHostConfigFile`  \n [in] The name of a host configuration file that specifies the version of the CLR to load. If the file name does not include a fully qualified path, the file is assumed to be in the same directory as the executable that is making the call.  \n  \n `pReserved`  \n [in] Reserved for future extensibility.  \n  \n `startupFlags`  \n [in] A set of flags that controls concurrent garbage collection, domain-neutral code, and the behavior of the `pwszVersion` parameter. The default is single domain if no flag is set. For a list of supported values, see the [STARTUP_FLAGS enumeration](../../../../docs/framework/unmanaged-api/hosting/startup-flags-enumeration.md).  \n  \n `rclsid`  \n [in] The `CLSID` of the coclass that implements either the [ICorRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md) or the [ICLRRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-interface.md) interface. Supported values are CLSID_CorRuntimeHost or CLSID_CLRRuntimeHost.  \n  \n `riid`  \n [in] The `IID` of the interface you are requesting. Supported values are IID_ICorRuntimeHost or IID_ICLRRuntimeHost.  \n  \n `ppv`  \n [out] An interface pointer to the version of the runtime that was loaded.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.idl  \n  \n **Library:** MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See Also  \n [CorBindToCurrentRuntime Function](../../../../docs/framework/unmanaged-api/hosting/corbindtocurrentruntime-function.md)   \n [CorBindToRuntime Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntime-function.md)   \n [CorBindToRuntimeByCfg Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimebycfg-function.md)   \n [CorBindToRuntimeEx Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)   \n [ICorRuntimeHost Interface](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md)   \n [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)","nodes":[{"pos":[4,627],"nodes":[{"content":"CorBindToRuntimeHost Function | Microsoft Docs","nodes":[{"pos":[0,46],"content":"CorBindToRuntimeHost Function | Microsoft Docs","nodes":[{"content":"CorBindToRuntimeHost Function | Microsoft Docs","pos":[0,46]}]}],"pos":[6,55],"yaml":true}],"content":"title: \"CorBindToRuntimeHost Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"CorBindToRuntimeHost\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"CorBindToRuntimeHost\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CorBindToRuntimeHost function [.NET Framework hosting]\"\nms.assetid: 5c826ba3-8258-49bc-a417-78807915fcaf\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 28\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[634,663],"content":"CorBindToRuntimeHost Function","linkify":"CorBindToRuntimeHost Function","nodes":[{"content":"CorBindToRuntimeHost Function","pos":[0,29]}]},{"content":"Enables hosts to load a specified version of the common language runtime (CLR) into a process.","pos":[664,758]},{"pos":[765,872],"content":"This function has been deprecated in the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph>.","source":"This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]."},{"pos":[881,887],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1251,1261],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A string that describes the version of the CLR you want to load.","pos":[1282,1351]},{"content":"A version number in the .NET Framework consists of four parts separated by periods: <bpt id=\"p1\">*</bpt>major.minor.build.revision<ept id=\"p1\">*</ept>.","pos":[1358,1471],"source":"A version number in the .NET Framework consists of four parts separated by periods: *major.minor.build.revision*."},{"content":"The string passed as <ph id=\"ph1\">`pwszVersion`</ph> must start with the character \"v\" followed by the first three parts of the version number (for example, \"v1.0.1529\").","pos":[1472,1624],"source":" The string passed as `pwszVersion` must start with the character \"v\" followed by the first three parts of the version number (for example, \"v1.0.1529\")."},{"content":"Some versions of the CLR are installed with a policy statement that specifies compatibility with previous versions of the CLR.","pos":[1631,1757]},{"content":"By default, the startup shim evaluates <ph id=\"ph1\">`pwszVersion`</ph> against policy statements and loads the latest version of the runtime that is compatible with the version being requested.","pos":[1758,1933],"source":" By default, the startup shim evaluates `pwszVersion` against policy statements and loads the latest version of the runtime that is compatible with the version being requested."},{"content":"A host can force the shim to skip policy evaluation and load the exact version specified in <ph id=\"ph1\">`pwszVersion`</ph> by passing a value of STARTUP_LOADER_SAFEMODE for the <ph id=\"ph2\">`startupFlags`</ph> parameter.","pos":[1934,2119],"source":" A host can force the shim to skip policy evaluation and load the exact version specified in `pwszVersion` by passing a value of STARTUP_LOADER_SAFEMODE for the `startupFlags` parameter."},{"content":"If <ph id=\"ph1\">`pwszVersion`</ph> is <ph id=\"ph2\">`null,`</ph> the method does not load any version of the CLR.","pos":[2126,2202],"source":"If `pwszVersion` is `null,` the method does not load any version of the CLR."},{"content":"Instead, it returns CLR_E_SHIM_RUNTIMELOAD, which indicates that it failed to load the runtime.","pos":[2203,2298]},{"content":"[in] A string that specifies whether to load the server or the workstation build of the CLR.","pos":[2326,2418]},{"content":"Valid values are <ph id=\"ph1\">`svr`</ph> and <ph id=\"ph2\">`wks`</ph>.","pos":[2419,2452],"source":" Valid values are `svr` and `wks`."},{"content":"The server build is optimized to take advantage of multiple processors for garbage collections, and the workstation build is optimized for client applications running on a single-processor machine.","pos":[2453,2650]},{"content":"If <ph id=\"ph1\">`pwszBuildFlavor`</ph>is set to null, the workstation build is loaded.","pos":[2657,2725],"source":"If `pwszBuildFlavor`is set to null, the workstation build is loaded."},{"content":"When running on a single-processor machine, the workstation build is always loaded, even if <ph id=\"ph1\">`pwszBuildFlavor`</ph>is set to <ph id=\"ph2\">`svr`</ph>.","pos":[2726,2851],"source":" When running on a single-processor machine, the workstation build is always loaded, even if `pwszBuildFlavor`is set to `svr`."},{"content":"However, if <ph id=\"ph1\">`pwszBuildFlavor`</ph>is set to <ph id=\"ph2\">`svr`</ph> and concurrent garbage collection is specified (see the description of the <ph id=\"ph3\">`startupFlags`</ph> parameter), the server build is loaded.","pos":[2852,3026],"source":" However, if `pwszBuildFlavor`is set to `svr` and concurrent garbage collection is specified (see the description of the `startupFlags` parameter), the server build is loaded."},{"pos":[3034,3393],"content":"[!NOTE]\n Concurrent garbage collection is not supported in applications running the WOW64 x86 emulator on 64-bit systems that implement the Intel Itanium architecture (formerly called IA-64). For more information about using WOW64 on 64-bit Windows systems, see [Running 32-bit Applications](http://msdn.microsoft.com/library/windows/desktop/aa384249.aspx).","leadings":["","> "],"nodes":[{"content":"Concurrent garbage collection is not supported in applications running the WOW64 x86 emulator on 64-bit systems that implement the Intel Itanium architecture (formerly called IA-64). For more information about using WOW64 on 64-bit Windows systems, see [Running 32-bit Applications](http://msdn.microsoft.com/library/windows/desktop/aa384249.aspx).","pos":[9,357],"nodes":[{"content":"Concurrent garbage collection is not supported in applications running the WOW64 x86 emulator on 64-bit systems that implement the Intel Itanium architecture (formerly called IA-64).","pos":[0,182]},{"content":"For more information about using WOW64 on 64-bit Windows systems, see <bpt id=\"p1\">[</bpt>Running 32-bit Applications<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa384249.aspx)</ept>.","pos":[183,348],"source":" For more information about using WOW64 on 64-bit Windows systems, see [Running 32-bit Applications](http://msdn.microsoft.com/library/windows/desktop/aa384249.aspx)."}]}]},{"content":"[in] The name of a host configuration file that specifies the version of the CLR to load.","pos":[3424,3513]},{"content":"If the file name does not include a fully qualified path, the file is assumed to be in the same directory as the executable that is making the call.","pos":[3514,3662]},{"content":"[in] Reserved for future extensibility.","pos":[3684,3723]},{"content":"[in] A set of flags that controls concurrent garbage collection, domain-neutral code, and the behavior of the <ph id=\"ph1\">`pwszVersion`</ph> parameter.","pos":[3748,3882],"source":"[in] A set of flags that controls concurrent garbage collection, domain-neutral code, and the behavior of the `pwszVersion` parameter."},{"content":"The default is single domain if no flag is set.","pos":[3883,3930]},{"content":"For a list of supported values, see the <bpt id=\"p1\">[</bpt>STARTUP_FLAGS enumeration<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/startup-flags-enumeration.md)</ept>.","pos":[3931,4078],"source":" For a list of supported values, see the [STARTUP_FLAGS enumeration](../../../../docs/framework/unmanaged-api/hosting/startup-flags-enumeration.md)."},{"content":"[in] The <ph id=\"ph1\">`CLSID`</ph> of the coclass that implements either the <bpt id=\"p1\">[</bpt>ICorRuntimeHost<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md)</ept> or the <bpt id=\"p2\">[</bpt>ICLRRuntimeHost<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-interface.md)</ept> interface.","pos":[4097,4367],"source":"[in] The `CLSID` of the coclass that implements either the [ICorRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md) or the [ICLRRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-interface.md) interface."},{"content":"Supported values are CLSID_CorRuntimeHost or CLSID_CLRRuntimeHost.","pos":[4368,4434]},{"content":"[in] The <ph id=\"ph1\">`IID`</ph> of the interface you are requesting.","pos":[4451,4502],"source":"[in] The `IID` of the interface you are requesting."},{"content":"Supported values are IID_ICorRuntimeHost or IID_ICLRRuntimeHost.","pos":[4503,4567]},{"content":"[out] An interface pointer to the version of the runtime that was loaded.","pos":[4583,4656]},{"pos":[4665,4677],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4681,4785],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[4792,4815],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.idl","source":"**Header:** MSCorEE.idl"},{"pos":[4822,4846],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> MSCorEE.dll","source":"**Library:** MSCorEE.dll"},{"pos":[4853,4961],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]"},{"pos":[4970,4978],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CorBindToCurrentRuntime Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtocurrentruntime-function.md)</ept><ph id=\"ph1\"> </ph>","pos":[4982,5103],"source":"[CorBindToCurrentRuntime Function](../../../../docs/framework/unmanaged-api/hosting/corbindtocurrentruntime-function.md) "},{"content":"<bpt id=\"p1\">[</bpt>CorBindToRuntime Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntime-function.md)</ept><ph id=\"ph1\"> </ph>","pos":[5107,5214],"source":"[CorBindToRuntime Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntime-function.md) "},{"content":"<bpt id=\"p1\">[</bpt>CorBindToRuntimeByCfg Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimebycfg-function.md)</ept><ph id=\"ph1\"> </ph>","pos":[5218,5335],"source":"[CorBindToRuntimeByCfg Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimebycfg-function.md) "},{"content":"<bpt id=\"p1\">[</bpt>CorBindToRuntimeEx Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)</ept><ph id=\"ph1\"> </ph>","pos":[5339,5450],"source":"[CorBindToRuntimeEx Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md) "},{"content":"<bpt id=\"p1\">[</bpt>ICorRuntimeHost Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[5454,5561],"source":"[ICorRuntimeHost Interface](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>Deprecated CLR Hosting Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)</ept>","pos":[5565,5685],"source":"[Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)"}]}