{"content":"---\ntitle: \"IHostThreadPoolManager::SetMaxThreads Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IHostThreadPoolManager.SetMaxThreads\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostThreadPoolManager::SetMaxThreads\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IHostThreadPoolManager::SetMaxThreads method [.NET Framework hosting]\"\n  - \"SetMaxThreads method, IHostThreadPoolManager interface [.NET Framework hosting]\"\nms.assetid: 77cfd347-95c2-4425-b807-4ecc2a8d4578\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# IHostThreadPoolManager::SetMaxThreads Method\nSets the maximum number of threads that the host can maintain in the thread pool.  \n  \n## Syntax  \n  \n```  \nHRESULT SetMaxThreads (  \n    [in] DWORD MaxThreads  \n);  \n```  \n  \n#### Parameters  \n `MaxThreads`  \n The maximum number of worker threads in the thread pool.  \n  \n## Return Value  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|`SetMaxThreads` returned successfully.|  \n|HOST_E_CLRNOTAVAILABLE|The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.|  \n|HOST_E_TIMEOUT|The call timed out.|  \n|HOST_E_NOT_OWNER|The caller does not own the lock.|  \n|HOST_E_ABANDONED|An event was canceled while a blocked thread or fiber was waiting on it.|  \n|E_FAIL|An unknown, catastrophic failure occurred. When a method returns E_FAIL, the CLR is no longer usable within the process. Subsequent calls to hosting methods return HOST_E_CLRNOTAVAILABLE.|  \n|E_NOTIMPL|The host does not provide an implementation of `SetMaxThreads`.|  \n  \n## Remarks  \n A host is not required to allow the CLR to configure the size of the thread pool. Some hosts might want exclusive control over the thread pool, for reasons such as implementation, performance, or scalability. In this case, a host should return an HRESULT value of E_NOTIMPL.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See Also  \n <xref:System.Threading.ThreadPool.SetMaxThreads%2A>   \n <xref:System.Threading.ThreadPool>   \n [GetMaxThreads Method](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-getmaxthreads-method.md)   \n [SetMinThreads Method](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-setminthreads-method.md)   \n [IHostThreadPoolManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-interface.md)","nodes":[{"pos":[12,73],"content":"IHostThreadPoolManager::SetMaxThreads Method | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IHostThreadPoolManager::SetMaxThreads Method | Microsoft Docs","pos":[0,61]}]},{"pos":[777,821],"content":"IHostThreadPoolManager::SetMaxThreads Method","linkify":"IHostThreadPoolManager::SetMaxThreads Method","nodes":[{"content":"IHostThreadPoolManager::SetMaxThreads Method","pos":[0,44]}]},{"content":"Sets the maximum number of threads that the host can maintain in the thread pool.","pos":[822,903]},{"pos":[912,918],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1003,1013],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The maximum number of worker threads in the thread pool.","pos":[1033,1089]},{"pos":[1098,1110],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"HRESULT","pos":[1117,1124]},{"content":"Description","pos":[1125,1136]},{"content":"S_OK","pos":[1177,1181]},{"pos":[1182,1220],"content":"<ph id=\"ph1\">`SetMaxThreads`</ph> returned successfully.","source":"`SetMaxThreads` returned successfully."},{"content":"HOST_E_CLRNOTAVAILABLE","pos":[1225,1247]},{"content":"The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.","pos":[1248,1412]},{"content":"HOST_E_TIMEOUT","pos":[1417,1431]},{"content":"The call timed out.","pos":[1432,1451]},{"content":"HOST_E_NOT_OWNER","pos":[1456,1472]},{"content":"The caller does not own the lock.","pos":[1473,1506]},{"content":"HOST_E_ABANDONED","pos":[1511,1527]},{"content":"An event was canceled while a blocked thread or fiber was waiting on it.","pos":[1528,1600]},{"content":"E_FAIL","pos":[1605,1611]},{"content":"An unknown, catastrophic failure occurred.","pos":[1612,1654]},{"content":"When a method returns E_FAIL, the CLR is no longer usable within the process.","pos":[1655,1732]},{"content":"Subsequent calls to hosting methods return HOST_E_CLRNOTAVAILABLE.","pos":[1733,1799]},{"content":"E_NOTIMPL","pos":[1804,1813]},{"pos":[1814,1877],"content":"The host does not provide an implementation of <ph id=\"ph1\">`SetMaxThreads`</ph>.","source":"The host does not provide an implementation of `SetMaxThreads`."},{"pos":[1887,1894],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"A host is not required to allow the CLR to configure the size of the thread pool.","pos":[1898,1979]},{"content":"Some hosts might want exclusive control over the thread pool, for reasons such as implementation, performance, or scalability.","pos":[1980,2106]},{"content":"In this case, a host should return an HRESULT value of E_NOTIMPL.","pos":[2107,2172]},{"pos":[2181,2193],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2197,2301],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2308,2329],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2336,2386],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[2393,2501],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[2510,2518],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Threading.ThreadPool.SetMaxThreads%2A&gt;</ph>","pos":[2522,2573],"source":"<xref:System.Threading.ThreadPool.SetMaxThreads%2A> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Threading.ThreadPool&gt;</ph>","pos":[2578,2612],"source":" <xref:System.Threading.ThreadPool> "},{"content":"<bpt id=\"p1\"> [</bpt>GetMaxThreads Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-getmaxthreads-method.md)</ept><ph id=\"ph1\"> </ph>","pos":[2616,2737],"source":" [GetMaxThreads Method](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-getmaxthreads-method.md) "},{"content":"<bpt id=\"p1\"> [</bpt>SetMinThreads Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-setminthreads-method.md)</ept><ph id=\"ph1\"> </ph>","pos":[2740,2861],"source":" [SetMinThreads Method](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-setminthreads-method.md) "},{"content":"<bpt id=\"p1\"> [</bpt>IHostThreadPoolManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-interface.md)</ept>","pos":[2864,2985],"source":" [IHostThreadPoolManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-interface.md)"}]}