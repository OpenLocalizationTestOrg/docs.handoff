{"content":"---\ntitle: \"Dynamic Reconfiguration | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: b20786ae-cce6-4f91-b6cb-9cae116faf8b\ncaps.latest.revision: 20\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Dynamic Reconfiguration\nThis sample demonstrates the [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] routing service. The routing service is a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] component that makes it easy to include a content-based router in your application. This sample adapts the standard [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] Calculator Sample to communicate using the routing service. This sample shows how the routing service can be dynamically reconfigured during runtime.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your computer. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\RoutingServices\\DynamicReconfiguration`  \n  \n## Sample Details  \n To dynamically reconfigure the routing service during runtime, this sample fires a timer every five seconds that creates a new <xref:System.ServiceModel.Routing.RoutingConfiguration> object and applies it. This configuration references either the regular Calculator endpoint or the Rounding Calculator endpoint. The Calculator Client application has its messages returned from one service or the other, depending on which one the routing service is configured to route to at that time.  \n  \n The routing service’s capabilitiy for dynamic reconfiguration through a custom behavior is used. This custom behavior attaches a service extension, which contains a simple thread timer that fires every five seconds, which results in a callback to the `UpdateRules` method. This callback creates and applies the new routing configuration. In an actual deployment, this callback would likely be accomplished as a result of some other type of event, such as a SQL-Event notification, or a WS-Discovery announcement.  \n  \n#### To use this sample  \n  \n1.  Using [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], open DynamicReconfiguration.sln.  \n  \n2.  To open **Solution Explorer**, select **Solution Explorer** from the **View** menu.  \n  \n3.  Press **F5** or **CTRL+SHIFT+B** in [!INCLUDE[vs_current_short](../../../../includes/vs-current-short-md.md)].  \n  \n    1.  If you would like to auto-launch the necessary projects when you press **F5**, right-click the solution and select **Properties**. Select the **Startup Project** node under **Common Properties** in the left pane. Select the **Multiple Startup Projects**  radio button and set all of the projects to have the **Start** action.  \n  \n    2.  If you build the project with **CTRL+SHIFT+B**, you must start the following applications:  \n  \n        1.  Calculator Client (./CalculatorClient/bin/client.exe)  \n  \n        2.  Calculator Service (./CalculatorService/bin/service.exe)  \n  \n        3.  Routing Calculator Service (./RoundingCalcService/bin/service.exe)  \n  \n        4.  RoutingService (./RoutingService/bin/RoutingService.exe)  \n  \n4.  In the console window of the Calculator Client, press ENTER to start the client and to call the Calculator service operations.  \n  \n     The routing service routes messages to the Rounding Calculator and to the regular Calculator alternately as the routing configuration changes dynamically every five seconds. Depending on which endpoint the routing service is configured to send messages to there are different outputs in the client console window.  \n  \n5.  Continue pressing ENTER repeatedly over more than five seconds and observe the change in the results from the service.  \n  \n    1.  The following is the output returned if the Router Service is configured to route messages to the Rounding Calculator service.  \n  \n        ```Output  \n        Add(100,15.99) = 116  \n        Subtract(145,76.54) = 68.5  \n        Multiply(9,81.25) = 731.2  \n        Divide(22,7) = 3.1  \n  \n        ```  \n  \n    2.  The following is the output returned if the routing service is configured to route messages to the regular Calculator service.  \n  \n        ```Output  \n        Add(100,15.99) = 115.99  \n        Subtract(145,76.54) = 68.46  \n        Multiply(9,81.25) = 731.25  \n        Divide(22,7) = 3.14285714285714  \n  \n        ```  \n  \n6.  The Calculator Service and the Rounding Calculator Service also print out a log of the operations invoked to their respective console windows.  \n  \n7.  In the client console window, type \"quit\" and press ENTER to exit.  \n  \n8.  Press ENTER in the services console windows to terminate the services.  \n  \n## Scenario  \n This sample demonstrates the router acting as a content-based router allowing multiple types or implementation of services to be exposed through one endpoint.  \n  \n### Real World Scenario  \n Contoso wants to virtualize all of their services to expose only one endpoint publicly through which they offer access to multiple different types of services. In this case they utilize the routing service’s content-based routing capabilities to determine where the incoming requests should be sent.  \n  \n## See Also  \n [AppFabric Hosting and Persistence Samples](http://go.microsoft.com/fwlink/?LinkId=193961)","nodes":[{"pos":[12,52],"content":"Dynamic Reconfiguration | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Dynamic Reconfiguration | Microsoft Docs","pos":[0,40]}]},{"pos":[351,374],"content":"Dynamic Reconfiguration","linkify":"Dynamic Reconfiguration","nodes":[{"content":"Dynamic Reconfiguration","pos":[0,23]}]},{"content":"This sample demonstrates the <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> routing service.","pos":[375,476],"source":"This sample demonstrates the [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] routing service."},{"content":"The routing service is a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> component that makes it easy to include a content-based router in your application.","pos":[477,641],"source":" The routing service is a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] component that makes it easy to include a content-based router in your application."},{"content":"This sample adapts the standard <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> Calculator Sample to communicate using the routing service.","pos":[642,789],"source":" This sample adapts the standard [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] Calculator Sample to communicate using the routing service."},{"content":"This sample shows how the routing service can be dynamically reconfigured during runtime.","pos":[790,879]},{"pos":[887,1020],"content":"[!IMPORTANT]\n The samples may already be installed on your computer. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your computer. Check for the following (default) directory before continuing.","pos":[13,131],"nodes":[{"content":"The samples may already be installed on your computer.","pos":[1,55]},{"content":"Check for the following (default) directory before continuing.","pos":[56,118]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[1074,1400],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[1401,1451]},{"pos":[1552,1566],"content":"Sample Details","linkify":"Sample Details","nodes":[{"content":"Sample Details","pos":[0,14]}]},{"content":"To dynamically reconfigure the routing service during runtime, this sample fires a timer every five seconds that creates a new <ph id=\"ph1\">&lt;xref:System.ServiceModel.Routing.RoutingConfiguration&gt;</ph> object and applies it.","pos":[1570,1775],"source":"To dynamically reconfigure the routing service during runtime, this sample fires a timer every five seconds that creates a new <xref:System.ServiceModel.Routing.RoutingConfiguration> object and applies it."},{"content":"This configuration references either the regular Calculator endpoint or the Rounding Calculator endpoint.","pos":[1776,1881]},{"content":"The Calculator Client application has its messages returned from one service or the other, depending on which one the routing service is configured to route to at that time.","pos":[1882,2055]},{"content":"The routing service’s capabilitiy for dynamic reconfiguration through a custom behavior is used.","pos":[2062,2158]},{"content":"This custom behavior attaches a service extension, which contains a simple thread timer that fires every five seconds, which results in a callback to the <ph id=\"ph1\">`UpdateRules`</ph> method.","pos":[2159,2334],"source":" This custom behavior attaches a service extension, which contains a simple thread timer that fires every five seconds, which results in a callback to the `UpdateRules` method."},{"content":"This callback creates and applies the new routing configuration.","pos":[2335,2399]},{"content":"In an actual deployment, this callback would likely be accomplished as a result of some other type of event, such as a SQL-Event notification, or a WS-Discovery announcement.","pos":[2400,2574]},{"pos":[2585,2603],"content":"To use this sample","linkify":"To use this sample","nodes":[{"content":"To use this sample","pos":[0,18]}]},{"pos":[2613,2724],"content":"Using <ph id=\"ph1\">[!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)]</ph>, open DynamicReconfiguration.sln.","source":"Using [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], open DynamicReconfiguration.sln."},{"pos":[2734,2817],"content":"To open <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>View<ept id=\"p3\">**</ept> menu.","source":"To open **Solution Explorer**, select **Solution Explorer** from the **View** menu."},{"pos":[2827,2937],"content":"Press <bpt id=\"p1\">**</bpt>F5<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>CTRL+SHIFT+B<ept id=\"p2\">**</ept> in <ph id=\"ph1\">[!INCLUDE[vs_current_short](../../../../includes/vs-current-short-md.md)]</ph>.","source":"Press **F5** or **CTRL+SHIFT+B** in [!INCLUDE[vs_current_short](../../../../includes/vs-current-short-md.md)]."},{"content":"If you would like to auto-launch the necessary projects when you press <bpt id=\"p1\">**</bpt>F5<ept id=\"p1\">**</ept>, right-click the solution and select <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","pos":[2951,3081],"source":"If you would like to auto-launch the necessary projects when you press **F5**, right-click the solution and select **Properties**."},{"content":"Select the <bpt id=\"p1\">**</bpt>Startup Project<ept id=\"p1\">**</ept> node under <bpt id=\"p2\">**</bpt>Common Properties<ept id=\"p2\">**</ept> in the left pane.","pos":[3082,3163],"source":" Select the **Startup Project** node under **Common Properties** in the left pane."},{"content":"Select the <bpt id=\"p1\">**</bpt>Multiple Startup Projects<ept id=\"p1\">**</ept>  radio button and set all of the projects to have the <bpt id=\"p2\">**</bpt>Start<ept id=\"p2\">**</ept> action.","pos":[3164,3276],"source":" Select the **Multiple Startup Projects**  radio button and set all of the projects to have the **Start** action."},{"pos":[3290,3380],"content":"If you build the project with <bpt id=\"p1\">**</bpt>CTRL+SHIFT+B<ept id=\"p1\">**</ept>, you must start the following applications:","source":"If you build the project with **CTRL+SHIFT+B**, you must start the following applications:"},{"content":"Calculator Client (./CalculatorClient/bin/client.exe)","pos":[3398,3451]},{"content":"Calculator Service (./CalculatorService/bin/service.exe)","pos":[3469,3525]},{"content":"Routing Calculator Service (./RoundingCalcService/bin/service.exe)","pos":[3543,3609]},{"content":"RoutingService (./RoutingService/bin/RoutingService.exe)","pos":[3627,3683]},{"content":"In the console window of the Calculator Client, press ENTER to start the client and to call the Calculator service operations.","pos":[3693,3819]},{"content":"The routing service routes messages to the Rounding Calculator and to the regular Calculator alternately as the routing configuration changes dynamically every five seconds.","pos":[3830,4003]},{"content":"Depending on which endpoint the routing service is configured to send messages to there are different outputs in the client console window.","pos":[4004,4143]},{"content":"Continue pressing ENTER repeatedly over more than five seconds and observe the change in the results from the service.","pos":[4153,4271]},{"content":"The following is the output returned if the Router Service is configured to route messages to the Rounding Calculator service.","pos":[4285,4411]},{"content":"The following is the output returned if the routing service is configured to route messages to the regular Calculator service.","pos":[4598,4724]},{"content":"The Calculator Service and the Rounding Calculator Service also print out a log of the operations invoked to their respective console windows.","pos":[4925,5067]},{"content":"In the client console window, type \"quit\" and press ENTER to exit.","pos":[5077,5143]},{"content":"Press ENTER in the services console windows to terminate the services.","pos":[5153,5223]},{"pos":[5232,5240],"content":"Scenario","linkify":"Scenario","nodes":[{"content":"Scenario","pos":[0,8]}]},{"content":"This sample demonstrates the router acting as a content-based router allowing multiple types or implementation of services to be exposed through one endpoint.","pos":[5244,5402]},{"pos":[5412,5431],"content":"Real World Scenario","linkify":"Real World Scenario","nodes":[{"content":"Real World Scenario","pos":[0,19]}]},{"content":"Contoso wants to virtualize all of their services to expose only one endpoint publicly through which they offer access to multiple different types of services.","pos":[5435,5594]},{"content":"In this case they utilize the routing service’s content-based routing capabilities to determine where the incoming requests should be sent.","pos":[5595,5734]},{"pos":[5743,5751],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[5755,5845],"content":"<bpt id=\"p1\">[</bpt>AppFabric Hosting and Persistence Samples<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=193961)</ept>","source":"[AppFabric Hosting and Persistence Samples](http://go.microsoft.com/fwlink/?LinkId=193961)"}]}