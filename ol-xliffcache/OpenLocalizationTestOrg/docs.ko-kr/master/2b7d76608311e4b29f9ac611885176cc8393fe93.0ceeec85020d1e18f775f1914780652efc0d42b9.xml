{"content":"---\ntitle: \"Arrays in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.Array\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"arrays [Visual Basic]\"\n  - \"Visual Basic, arrays\"\nms.assetid: dbf29737-b589-4443-bee6-a27588d9c67e\ncaps.latest.revision: 47\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Arrays in Visual Basic\nAn array is a set of values that are logically related to each other, such as the number of students in each grade in a grammar school.  If you are looking for help on arrays in Visual Basic for Applications (VBA), see the [language reference](https://msdn.microsoft.com/library/office/gg264383\\(v=office.14\\).aspx).  \n  \n By using an array, you can refer to these related values by the same name, and use a number that’s called an index or subscript to tell them apart. The individual values are called the elements of the array. They’re contiguous from index 0 through the highest index value.  \n  \n In contrast to an array, a variable that contain a single value is called a *scalar* variable.  \n  \n Some quick examples before explanation:  \n  \n```vb  \n  \n'Declare a single-dimension array of 5 values  \nDim numbers(4) As Integer   \n  \n‘Declare a single-dimension array and set array element values  \nDim numbers = New Integer() {1, 2, 4, 8}  \n  \n ‘Redefine the size of an existing array retaining the current values  \nReDim Preserve numbers(15)  \n  \n ‘Redefine the size of an existing array, resetting the values  \nReDim numbers(15)  \n  \n‘Declare a multi-dimensional array  \nDim matrix(5, 5) As Double  \n  \n‘Declare a multi-dimensional array and set array element values  \nDim matrix = New Integer(4, 4) {{1, 2}, {3, 4}, {5, 6}, {7, 8}}  \n  \n ‘Declare a jagged array  \nDim sales()() As Double = New Double(11)() {}  \n```  \n  \n **In this topic**  \n  \n-   [Array Elements in a Simple Array](#BKMK_ArrayElements)  \n  \n-   [Creating an Array](#BKMK_CreatingAnArray)  \n  \n-   [Storing Values in an Array](#BKMK_StoringValues)  \n  \n-   [Populating an Array with Initial Values](#BKMK_Populating)  \n  \n    -   [Nested Array Literals](#BKMK_NestedArrayLiterals)  \n  \n-   [Iterating Through an Array](#BKMK_Iterating)  \n  \n-   [Arrays as Return Values and Parameters](#BKMK_ReturnValues)  \n  \n-   [Jagged Arrays](#BKMK_JaggedArrays)  \n  \n-   [Zero-Length Arrays](#BKMK_ZeroLength)  \n  \n-   [Array Size](#BKMK_ArraySize)  \n  \n-   [Array Types and Other Types](#BKMK_ArrayTypes)  \n  \n-   [Collections as an Alternative to Arrays](#BKMK_Collections)  \n  \n##  <a name=\"BKMK_ArrayElements\"></a> Array Elements in a Simple Array  \n The following example declares an array variable to hold the number of students in each grade in a grammar school.  \n  \n [!code-vb[VbVbalrArrays#2](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_1.vb)]  \n  \n The array `students` in the preceding example contains seven elements. The indexes of the elements range from 0 through 6. Having this array is simpler than declaring seven variables.  \n  \n The following illustration shows the array `students`. For each element of the array:  \n  \n-   The index of the element represents the grade (index 0 represents kindergarten).  \n  \n-   The value that’s contained in the element represents the number of students in that grade.  \n  \n ![Picture of array showing numbers of students](../../../../visual-basic/programming-guide/language-features/arrays/media/arrayexampleschool.gif \"ArrayExampleSchool\")  \nElements of the \"students\" array  \n  \n The following example shows how to refer to the first, second, and last element of the array `students`.  \n  \n [!code-vb[VbVbalrArrays#3](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_2.vb)]  \n  \n You can refer to the array as a whole by using just the array variable name without indexes.  \n  \n The array `students` in the preceding example uses one index and is said to be one-dimensional. An array that uses more than one index or subscript is called multidimensional. For more information, see the rest of this topic and [Array Dimensions in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/array-dimensions.md).  \n  \n##  <a name=\"BKMK_CreatingAnArray\"></a> Creating an Array  \n You can define the size of an array several ways. You can supply the size when the array is declared, as the following example shows.  \n  \n [!code-vb[VbVbalrArrays#12](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_3.vb)]  \n  \n You can also use a `New` clause to supply the size of an array when it’s created, as the following example shows.  \n  \n [!code-vb[VbVbalrArrays#11](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_4.vb)]  \n  \n If you have an existing array, you can redefine its size by using the `Redim` statement. You can specify that the `Redim` statement should keep the values that are in the array, or you can specify that it create an empty array. The following example shows different uses of the `Redim` statement to modify the size of an existing array.  \n  \n [!code-vb[VbVbalrArrays#13](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_5.vb)]  \n  \n For more information, see [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md).  \n  \n##  <a name=\"BKMK_StoringValues\"></a> Storing Values in an Array  \n You can access each location in an array by using an index of type `Integer`. You can store and retrieve values in an array by referencing each array location by using its index enclosed in parentheses. Indexes for multi-dimensional arrays are separated by commas (,). You need one index for each array dimension. The following example shows some statements that store values in arrays.  \n  \n [!code-vb[VbVbalrArrays#5](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_6.vb)]  \n  \n The following example shows some statements that get values from arrays.  \n  \n [!code-vb[VbVbalrArrays#6](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_7.vb)]  \n  \n##  <a name=\"BKMK_Populating\"></a> Populating an Array with Initial Values  \n By using an array literal, you can create an array that contains an initial set of values. An array literal consists of a list of comma-separated values that are enclosed in braces (`{}`).  \n  \n When you create an array by using an array literal, you can either supply the array type or use type inference to determine the array type. The following code shows both options.  \n  \n [!code-vb[VbVbalrCollectionInitializers#3](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_8.vb)]  \n  \n When you use type inference, the type of the array is determined by the dominant type in the list of values that’s supplied for the array literal. The dominant type is a unique type to which all other types in the array literal can widen. If this unique type can’t be determined, the dominant type is the unique type to which all other types in the array can narrow. If neither of these unique types can be determined, the dominant type is `Object`. For example, if the list of values that’s supplied to the array literal contains values of type `Integer`, `Long`, and `Double`, the resulting array is of type `Double`. Both `Integer` and `Long` widen only to `Double`. Therefore, `Double` is the dominant type. For more information, see [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md). These inference rules apply to types that are inferred for arrays that are local variables that are defined in a class member. Although you can use array literals when you create class-level variables, you can’t use type inference at the class level. As a result, array literals that are specified at the class level infer the values that are supplied for the array literal as type `Object`.  \n  \n You can explicitly specify the type of the elements in an array that’s created by using an array literal. In this case, the values in the array literal must widen to the type of the elements of the array. The following code example creates an array of type `Double` from a list of integers.  \n  \n [!code-vb[VbVbalrCollectionInitializers#4](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_9.vb)]  \n  \n###  <a name=\"BKMK_NestedArrayLiterals\"></a> Nested Array Literals  \n You can create a multidimensional array by using nested array literals. Nested array literals must have a dimension and number of dimensions, or rank, that’s consistent with the resulting array. The following code example creates a two-dimensional array of integers by using an array literal.  \n  \n [!code-vb[VbVbalrCollectionInitializers#7](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_10.vb)]  \n  \n In the previous example, an error would occur if the number of elements in the nested array literals didn’t match. An error would also occur if you explicitly declared the array variable to be other than two-dimensional.  \n  \n> [!NOTE]\n>  You can avoid an error when you supply nested array literals of different dimensions by enclosing the inner array literals in parentheses. The parentheses force the array literal expression to be evaluated, and the resulting values are used with the outer array literal, as the following code shows.  \n  \n [!code-vb[VbVbalrCollectionInitializers#11](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_11.vb)]  \n  \n When you create a multidimensional array by using nested array literals, you can use type inference. When you use type inference, the inferred type is the dominant type for all the values in all the array literals for a nesting level. The following code example creates a two-dimensional array of type `Double` from values that are of type `Integer` and `Double`.  \n  \n [!code-vb[VbVbalrCollectionInitializers#8](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_12.vb)]  \n  \n For additional examples, see [How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md).  \n  \n##  <a name=\"BKMK_Iterating\"></a> Iterating Through an Array  \n When you iterate through an array, you access each element in the array from the lowest index to the highest index.  \n  \n The following example iterates through a one-dimensional array by using the [For...Next Statement](../../../../visual-basic/language-reference/statements/for-next-statement.md). The <xref:System.Array.GetUpperBound%2A> method returns the highest value that the index can have. The lowest index value is always 0.  \n  \n [!code-vb[VbVbalrArrays#41](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_13.vb)]  \n  \n The following example iterates through a multidimensional array by using a `For...Next` statement. The <xref:System.Array.GetUpperBound%2A> method has a parameter that specifies the dimension. `GetUpperBound(0)` returns the high index value for the first dimension, and `GetUpperBound(1)` returns the high index value for the second dimension.  \n  \n [!code-vb[VbVbalrArrays#42](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_14.vb)]  \n  \n The following example iterates through a one-dimensional array by using a [For Each...Next Statement](../../../../visual-basic/language-reference/statements/for-each-next-statement.md).  \n  \n [!code-vb[VbVbalrArrays#43](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_15.vb)]  \n  \n The following example iterates through a multidimensional array by using a `For Each...Next` statement. However, you have more control over the elements of a multidimensional array if you use a nested `For…Next` statement, as in a previous example, instead of a `For Each…Next` statement.  \n  \n [!code-vb[VbVbalrArrays#44](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_16.vb)]  \n  \n##  <a name=\"BKMK_ReturnValues\"></a> Arrays as Return Values and Parameters  \n To return an array from a `Function` procedure, specify the array data type and the number of dimensions as the return type of the [Function Statement](../../../../visual-basic/language-reference/statements/function-statement.md). Within the function, declare a local array variable with same data type and number of dimensions. In the [Return Statement](../../../../visual-basic/language-reference/statements/return-statement.md), include the local array variable without parentheses.  \n  \n To specify an array as a parameter to a `Sub` or `Function` procedure, define the parameter as an array with a specified data type and number of dimensions. In the call to the procedure, send an array variable with the same data type and number of dimensions.  \n  \n In the following example, the `GetNumbers` function returns an `Integer()`. This array type is a one dimensional array of type `Integer`. The `ShowNumbers` procedure accepts an `Integer()` argument.  \n  \n [!code-vb[VbVbalrArrays#51](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_17.vb)]  \n  \n In the following example, the `GetNumbersMultiDim` function returns an `Integer(,)`. This array type is a two dimensional array of type `Integer`.  The `ShowNumbersMultiDim` procedure accepts an `Integer(,)` argument.  \n  \n [!code-vb[VbVbalrArrays#52](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_18.vb)]  \n  \n##  <a name=\"BKMK_JaggedArrays\"></a> Jagged Arrays  \n An array that holds other arrays as elements is known as an array of arrays or a jagged array. A jagged array and each element in a jagged array can have one or more dimensions. Sometimes the data structure in your application is two-dimensional but not rectangular.  \n  \n The following example has an array of months, each element of which is an array of days. Because different months have different numbers of days, the elements don’t form a rectangular two-dimensional array. Therefore, a jagged array is used instead of a multidimensional array.  \n  \n [!code-vb[VbVbalrArrays#21](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_19.vb)]  \n  \n##  <a name=\"BKMK_ZeroLength\"></a> Zero-Length Arrays  \n An array that contains no elements is also called a zero-length array. A variable that holds a zero-length array doesn’t have the value `Nothing`. To create an array that has no elements, declare one of the array's dimensions to be -1, as the following example shows.  \n  \n [!code-vb[VbVbalrArrays#14](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_20.vb)]  \n  \n You might need to create a zero-length array under the following circumstances:  \n  \n-   Without risking a <xref:System.NullReferenceException> exception, your code must access members of the <xref:System.Array> class, such as <xref:System.Array.Length%2A> or <xref:System.Array.Rank%2A>, or call a [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] function such as <xref:Microsoft.VisualBasic.Information.UBound%2A>.  \n  \n-   You want to keep the consuming code simpler by not having to check for `Nothing` as a special case.  \n  \n-   Your code interacts with an application programming interface (API) that either requires you to pass a zero-length array to one or more procedures or returns a zero-length array from one or more procedures.  \n  \n##  <a name=\"BKMK_ArraySize\"></a> Array Size  \n The size of an array is the product of the lengths of all its dimensions. It represents the total number of elements currently contained in the array.  \n  \n The following example declares a three-dimensional array.  \n  \n```  \nDim prices(3, 4, 5) As Long  \n```  \n  \n The overall size of the array in variable `prices` is (3 + 1) x (4 + 1) x (5 + 1) = 120.  \n  \n You can find the size of an array by using the <xref:System.Array.Length%2A> property. You can find the length of each dimension of a multi-dimensional array by using the <xref:System.Array.GetLength%2A> method.  \n  \n You can resize an array variable by assigning a new array object to it or by using the `ReDim` statement.  \n  \n There are several things to keep in mind when dealing with the size of an array.  \n  \n|||  \n|---|---|  \n|Dimension Length|The index of each dimension is 0-based, which means it ranges from 0 through its upper bound. Therefore, the length of a given dimension is greater by 1 than the declared upper bound for that dimension.|  \n|Length Limits|The length of every dimension of an array is limited to the maximum value of the `Integer` data type, which is (2 ^ 31) - 1. However, the total size of an array is also limited by the memory available on your system. If you attempt to initialize an array that exceeds the amount of available RAM, the common language runtime throws an <xref:System.OutOfMemoryException> exception.|  \n|Size and Element Size|An array's size is independent of the data type of its elements. The size always represents the total number of elements, not the number of bytes that they consume in storage.|  \n|Memory Consumption|It is not safe to make any assumptions regarding how an array is stored in memory. Storage varies on platforms of different data widths, so the same array can consume more memory on a 64-bit system than on a 32-bit system. Depending on system configuration when you initialize an array, the common language runtime (CLR) can assign storage either to pack elements as close together as possible, or to align them all on natural hardware boundaries. Also, an array requires a storage overhead for its control information, and this overhead increases with each added dimension.|  \n  \n##  <a name=\"BKMK_ArrayTypes\"></a> Array Types and Other Types  \n Every array has a data type, but it differs from the data type of its elements. There is no single data type for all arrays. Instead, the data type of an array is determined by the number of dimensions, or *rank*, of the array, and the data type of the elements in the array. Two array variables are considered to be of the same data type only when they have the same rank and their elements have the same data type. The lengths of the dimensions in an array do not influence the array data type.  \n  \n Every array inherits from the <xref:System.Array?displayProperty=fullName> class, and you can declare a variable to be of type `Array`, but you cannot create an array of type `Array`. Also, the [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md) cannot operate on a variable declared as type `Array`. For these reasons, and for type safety, it is advisable to declare every array as a specific type, such as `Integer` in the preceding example.  \n  \n You can find out the data type of either an array or its elements in several ways.  \n  \n-   You can call the <xref:System.Object.GetType%2A?displayProperty=fullName> method on the variable to receive a <xref:System.Type> object for the run-time type of the variable. The <xref:System.Type> object holds extensive information in its properties and methods.  \n  \n-   You can pass the variable to the <xref:Microsoft.VisualBasic.Information.TypeName%2A> function to receive a `String` containing the name of run-time type.  \n  \n-   You can pass the variable to the <xref:Microsoft.VisualBasic.Information.VarType%2A> function to receive a `VariantType` value representing the type classification of the variable.  \n  \n The following example calls the `TypeName` function to determine the type of the array and the type of the elements in the array. The array type is `Integer(,)` and the elements in the array are of type `Integer`.  \n  \n [!code-vb[VbVbalrArrays#15](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_21.vb)]  \n  \n##  <a name=\"BKMK_Collections\"></a> Collections as an Alternative to Arrays  \n Arrays are most useful for creating and working with a fixed number of strongly typed objects. Collections provide a more flexible way to work with groups of objects. Unlike arrays, the group of objects that you work with can grow and shrink dynamically as the needs of the application change.  \n  \n If you need to change the size of an array, you must use the [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md). When you do this, [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] creates a new array and releases the previous array for disposal. This takes execution time. Therefore, if the number of items you are working with changes frequently, or you cannot predict the maximum number of items you need, you might obtain better performance using a collection.  \n  \n For some collections, you can assign a key to any object that you put into the collection so that you can quickly retrieve the object by using the key.  \n  \n If your collection contains elements of only one data type, you can use one of the classes in the <xref:System.Collections.Generic?displayProperty=fullName> namespace. A generic collection enforces type safety so that no other data type can be added to it. When you retrieve an element from a generic collection, you do not have to determine its data type or convert it.  \n  \n For more information about collections, see [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b).  \n  \n### Example  \n The following example uses the [!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort_md.md)] generic class <xref:System.Collections.Generic.List%601?displayProperty=fullName> to create a list collection of `Customer` objects.  \n  \n [!code-vb[VbVbalrArrays#1](../../../../visual-basic/programming-guide/language-features/arrays/codesnippet/VisualBasic/index_22.vb)]  \n  \n The declaration of the `CustomerFile` collection specifies that it can contain elements only of type `Customer`. It also provides for an initial capacity of 200 elements. The procedure `AddNewCustomer` checks the new element for validity and then adds it to the collection. The procedure `PrintCustomers` uses a `For Each` loop to traverse the collection and display its elements.  \n  \n## Related Topics  \n  \n|Term|Definition|  \n|----------|----------------|  \n|[Array Dimensions in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/array-dimensions.md)|Explains rank and dimensions in arrays.|  \n|[How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)|Describes how to populate arrays with initial values.|  \n|[How to: Sort An Array in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-sort-an-array.md)|Shows how to sort the elements of an array alphabetically.|  \n|[How to: Assign One Array to Another Array](../../../../visual-basic/programming-guide/language-features/arrays/how-to-assign-one-array-to-another-array.md)|Describes the rules and steps for assigning an array to another array variable.|  \n|[Troubleshooting Arrays](../../../../visual-basic/programming-guide/language-features/arrays/troubleshooting-arrays.md)|Discusses some common problems that arise when working with arrays.|  \n  \n## See Also  \n <xref:System.Array>   \n [Dim Statement](../../../../visual-basic/language-reference/statements/dim-statement.md)   \n [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md)","nodes":[{"pos":[4,649],"embed":true,"restype":"x-metadata","content":"title: \"Arrays in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.Array\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"arrays [Visual Basic]\"\n  - \"Visual Basic, arrays\"\nms.assetid: dbf29737-b589-4443-bee6-a27588d9c67e\ncaps.latest.revision: 47\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"","nodes":[{"content":"Arrays in Visual Basic | Microsoft Docs","nodes":[{"pos":[0,39],"content":"Arrays in Visual Basic | Microsoft Docs","nodes":[{"content":"Arrays in Visual Basic | Microsoft Docs","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[656,678],"content":"Arrays in Visual Basic","linkify":"Arrays in Visual Basic","nodes":[{"content":"Arrays in Visual Basic","pos":[0,22]}]},{"content":"An array is a set of values that are logically related to each other, such as the number of students in each grade in a grammar school.","pos":[679,814]},{"content":"If you are looking for help on arrays in Visual Basic for Applications (VBA), see the <bpt id=\"p1\">[</bpt>language reference<ept id=\"p1\">](https://msdn.microsoft.com/library/office/gg264383\\(v=office.14\\).aspx)</ept>.","pos":[816,995],"source":"  If you are looking for help on arrays in Visual Basic for Applications (VBA), see the [language reference](https://msdn.microsoft.com/library/office/gg264383\\(v=office.14\\).aspx)."},{"content":"By using an array, you can refer to these related values by the same name, and use a number that’s called an index or subscript to tell them apart.","pos":[1002,1149]},{"content":"The individual values are called the elements of the array.","pos":[1150,1209]},{"content":"They’re contiguous from index 0 through the highest index value.","pos":[1210,1274]},{"pos":[1281,1375],"content":"In contrast to an array, a variable that contain a single value is called a <bpt id=\"p1\">*</bpt>scalar<ept id=\"p1\">*</ept> variable.","source":"In contrast to an array, a variable that contain a single value is called a *scalar* variable."},{"content":"Some quick examples before explanation:","pos":[1382,1421]},{"pos":[2110,2127],"content":"<bpt id=\"p1\">**</bpt>In this topic<ept id=\"p1\">**</ept>","source":"**In this topic**"},{"pos":[2137,2192],"content":"<bpt id=\"p1\">[</bpt>Array Elements in a Simple Array<ept id=\"p1\">](#BKMK_ArrayElements)</ept>","source":"[Array Elements in a Simple Array](#BKMK_ArrayElements)"},{"pos":[2202,2244],"content":"<bpt id=\"p1\">[</bpt>Creating an Array<ept id=\"p1\">](#BKMK_CreatingAnArray)</ept>","source":"[Creating an Array](#BKMK_CreatingAnArray)"},{"pos":[2254,2303],"content":"<bpt id=\"p1\">[</bpt>Storing Values in an Array<ept id=\"p1\">](#BKMK_StoringValues)</ept>","source":"[Storing Values in an Array](#BKMK_StoringValues)"},{"pos":[2313,2372],"content":"<bpt id=\"p1\">[</bpt>Populating an Array with Initial Values<ept id=\"p1\">](#BKMK_Populating)</ept>","source":"[Populating an Array with Initial Values](#BKMK_Populating)"},{"pos":[2386,2436],"content":"<bpt id=\"p1\">[</bpt>Nested Array Literals<ept id=\"p1\">](#BKMK_NestedArrayLiterals)</ept>","source":"[Nested Array Literals](#BKMK_NestedArrayLiterals)"},{"pos":[2446,2491],"content":"<bpt id=\"p1\">[</bpt>Iterating Through an Array<ept id=\"p1\">](#BKMK_Iterating)</ept>","source":"[Iterating Through an Array](#BKMK_Iterating)"},{"pos":[2501,2561],"content":"<bpt id=\"p1\">[</bpt>Arrays as Return Values and Parameters<ept id=\"p1\">](#BKMK_ReturnValues)</ept>","source":"[Arrays as Return Values and Parameters](#BKMK_ReturnValues)"},{"pos":[2571,2606],"content":"<bpt id=\"p1\">[</bpt>Jagged Arrays<ept id=\"p1\">](#BKMK_JaggedArrays)</ept>","source":"[Jagged Arrays](#BKMK_JaggedArrays)"},{"pos":[2616,2654],"content":"<bpt id=\"p1\">[</bpt>Zero-Length Arrays<ept id=\"p1\">](#BKMK_ZeroLength)</ept>","source":"[Zero-Length Arrays](#BKMK_ZeroLength)"},{"pos":[2664,2693],"content":"<bpt id=\"p1\">[</bpt>Array Size<ept id=\"p1\">](#BKMK_ArraySize)</ept>","source":"[Array Size](#BKMK_ArraySize)"},{"pos":[2703,2750],"content":"<bpt id=\"p1\">[</bpt>Array Types and Other Types<ept id=\"p1\">](#BKMK_ArrayTypes)</ept>","source":"[Array Types and Other Types](#BKMK_ArrayTypes)"},{"pos":[2760,2820],"content":"<bpt id=\"p1\">[</bpt>Collections as an Alternative to Arrays<ept id=\"p1\">](#BKMK_Collections)</ept>","source":"[Collections as an Alternative to Arrays](#BKMK_Collections)"},{"pos":[2830,2896],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_ArrayElements\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Array Elements in a Simple Array","linkify":"<a name=\"BKMK_ArrayElements\"></a> Array Elements in a Simple Array","source":"<a name=\"BKMK_ArrayElements\"></a> Array Elements in a Simple Array"},{"content":"The following example declares an array variable to hold the number of students in each grade in a grammar school.","pos":[2900,3014]},{"content":"The array <ph id=\"ph1\">`students`</ph> in the preceding example contains seven elements.","pos":[3159,3229],"source":"The array `students` in the preceding example contains seven elements."},{"content":"The indexes of the elements range from 0 through 6.","pos":[3230,3281]},{"content":"Having this array is simpler than declaring seven variables.","pos":[3282,3342]},{"content":"The following illustration shows the array <ph id=\"ph1\">`students`</ph>.","pos":[3349,3403],"source":"The following illustration shows the array `students`."},{"content":"For each element of the array:","pos":[3404,3434]},{"content":"The index of the element represents the grade (index 0 represents kindergarten).","pos":[3444,3524]},{"content":"The value that’s contained in the element represents the number of students in that grade.","pos":[3534,3624]},{"content":"<bpt id=\"p1\">![</bpt>Picture of array showing numbers of students<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../visual-basic/programming-guide/language-features/arrays/media/arrayexampleschool.gif \"</bpt>ArrayExampleSchool<ept id=\"p2\">\")</ept>","pos":[3631,3797],"source":"![Picture of array showing numbers of students](../../../../visual-basic/programming-guide/language-features/arrays/media/arrayexampleschool.gif \"ArrayExampleSchool\")"},{"content":"Elements of the \"students\" array","pos":[3800,3832]},{"pos":[3839,3943],"content":"The following example shows how to refer to the first, second, and last element of the array <ph id=\"ph1\">`students`</ph>.","source":"The following example shows how to refer to the first, second, and last element of the array `students`."},{"content":"You can refer to the array as a whole by using just the array variable name without indexes.","pos":[4088,4180]},{"content":"The array <ph id=\"ph1\">`students`</ph> in the preceding example uses one index and is said to be one-dimensional.","pos":[4187,4282],"source":"The array `students` in the preceding example uses one index and is said to be one-dimensional."},{"content":"An array that uses more than one index or subscript is called multidimensional.","pos":[4283,4362]},{"content":"For more information, see the rest of this topic and <bpt id=\"p1\">[</bpt>Array Dimensions in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/array-dimensions.md)</ept>.","pos":[4363,4540],"source":" For more information, see the rest of this topic and [Array Dimensions in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/array-dimensions.md)."},{"pos":[4550,4603],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_CreatingAnArray\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Creating an Array","linkify":"<a name=\"BKMK_CreatingAnArray\"></a> Creating an Array","source":"<a name=\"BKMK_CreatingAnArray\"></a> Creating an Array"},{"content":"You can define the size of an array several ways.","pos":[4607,4656]},{"content":"You can supply the size when the array is declared, as the following example shows.","pos":[4657,4740]},{"pos":[4886,4999],"content":"You can also use a <ph id=\"ph1\">`New`</ph> clause to supply the size of an array when it’s created, as the following example shows.","source":"You can also use a `New` clause to supply the size of an array when it’s created, as the following example shows."},{"content":"If you have an existing array, you can redefine its size by using the <ph id=\"ph1\">`Redim`</ph> statement.","pos":[5145,5233],"source":"If you have an existing array, you can redefine its size by using the `Redim` statement."},{"content":"You can specify that the <ph id=\"ph1\">`Redim`</ph> statement should keep the values that are in the array, or you can specify that it create an empty array.","pos":[5234,5372],"source":" You can specify that the `Redim` statement should keep the values that are in the array, or you can specify that it create an empty array."},{"content":"The following example shows different uses of the <ph id=\"ph1\">`Redim`</ph> statement to modify the size of an existing array.","pos":[5373,5481],"source":" The following example shows different uses of the `Redim` statement to modify the size of an existing array."},{"pos":[5627,5746],"content":"For more information, see <bpt id=\"p1\">[</bpt>ReDim Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/redim-statement.md)</ept>.","source":"For more information, see [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md)."},{"pos":[5756,5816],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_StoringValues\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Storing Values in an Array","linkify":"<a name=\"BKMK_StoringValues\"></a> Storing Values in an Array","source":"<a name=\"BKMK_StoringValues\"></a> Storing Values in an Array"},{"content":"You can access each location in an array by using an index of type <ph id=\"ph1\">`Integer`</ph>.","pos":[5820,5897],"source":"You can access each location in an array by using an index of type `Integer`."},{"content":"You can store and retrieve values in an array by referencing each array location by using its index enclosed in parentheses.","pos":[5898,6022]},{"content":"Indexes for multi-dimensional arrays are separated by commas (,).","pos":[6023,6088]},{"content":"You need one index for each array dimension.","pos":[6089,6133]},{"content":"The following example shows some statements that store values in arrays.","pos":[6134,6206]},{"content":"The following example shows some statements that get values from arrays.","pos":[6351,6423]},{"pos":[6571,6641],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_Populating\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Populating an Array with Initial Values","linkify":"<a name=\"BKMK_Populating\"></a> Populating an Array with Initial Values","source":"<a name=\"BKMK_Populating\"></a> Populating an Array with Initial Values"},{"content":"By using an array literal, you can create an array that contains an initial set of values.","pos":[6645,6735]},{"content":"An array literal consists of a list of comma-separated values that are enclosed in braces (<ph id=\"ph1\">`{}`</ph>).","pos":[6736,6833],"source":" An array literal consists of a list of comma-separated values that are enclosed in braces (`{}`)."},{"content":"When you create an array by using an array literal, you can either supply the array type or use type inference to determine the array type.","pos":[6840,6979]},{"content":"The following code shows both options.","pos":[6980,7018]},{"content":"When you use type inference, the type of the array is determined by the dominant type in the list of values that’s supplied for the array literal.","pos":[7179,7325]},{"content":"The dominant type is a unique type to which all other types in the array literal can widen.","pos":[7326,7417]},{"content":"If this unique type can’t be determined, the dominant type is the unique type to which all other types in the array can narrow.","pos":[7418,7545]},{"content":"If neither of these unique types can be determined, the dominant type is <ph id=\"ph1\">`Object`</ph>.","pos":[7546,7628],"source":" If neither of these unique types can be determined, the dominant type is `Object`."},{"content":"For example, if the list of values that’s supplied to the array literal contains values of type <ph id=\"ph1\">`Integer`</ph>, <ph id=\"ph2\">`Long`</ph>, and <ph id=\"ph3\">`Double`</ph>, the resulting array is of type <ph id=\"ph4\">`Double`</ph>.","pos":[7629,7798],"source":" For example, if the list of values that’s supplied to the array literal contains values of type `Integer`, `Long`, and `Double`, the resulting array is of type `Double`."},{"content":"Both <ph id=\"ph1\">`Integer`</ph> and <ph id=\"ph2\">`Long`</ph> widen only to <ph id=\"ph3\">`Double`</ph>.","pos":[7799,7848],"source":" Both `Integer` and `Long` widen only to `Double`."},{"content":"Therefore, <ph id=\"ph1\">`Double`</ph> is the dominant type.","pos":[7849,7890],"source":" Therefore, `Double` is the dominant type."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Widening and Narrowing Conversions<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)</ept>.","pos":[7891,8065],"source":" For more information, see [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)."},{"content":"These inference rules apply to types that are inferred for arrays that are local variables that are defined in a class member.","pos":[8066,8192]},{"content":"Although you can use array literals when you create class-level variables, you can’t use type inference at the class level.","pos":[8193,8316]},{"content":"As a result, array literals that are specified at the class level infer the values that are supplied for the array literal as type <ph id=\"ph1\">`Object`</ph>.","pos":[8317,8457],"source":" As a result, array literals that are specified at the class level infer the values that are supplied for the array literal as type `Object`."},{"content":"You can explicitly specify the type of the elements in an array that’s created by using an array literal.","pos":[8464,8569]},{"content":"In this case, the values in the array literal must widen to the type of the elements of the array.","pos":[8570,8668]},{"content":"The following code example creates an array of type <ph id=\"ph1\">`Double`</ph> from a list of integers.","pos":[8669,8754],"source":" The following code example creates an array of type `Double` from a list of integers."},{"pos":[8919,8980],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_NestedArrayLiterals\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Nested Array Literals","linkify":"<a name=\"BKMK_NestedArrayLiterals\"></a> Nested Array Literals","source":"<a name=\"BKMK_NestedArrayLiterals\"></a> Nested Array Literals"},{"content":"You can create a multidimensional array by using nested array literals.","pos":[8984,9055]},{"content":"Nested array literals must have a dimension and number of dimensions, or rank, that’s consistent with the resulting array.","pos":[9056,9178]},{"content":"The following code example creates a two-dimensional array of integers by using an array literal.","pos":[9179,9276]},{"content":"In the previous example, an error would occur if the number of elements in the nested array literals didn’t match.","pos":[9438,9552]},{"content":"An error would also occur if you explicitly declared the array variable to be other than two-dimensional.","pos":[9553,9658]},{"pos":[9666,9976],"content":"[!NOTE]\n You can avoid an error when you supply nested array literals of different dimensions by enclosing the inner array literals in parentheses. The parentheses force the array literal expression to be evaluated, and the resulting values are used with the outer array literal, as the following code shows.","leadings":["","> "],"nodes":[{"content":"You can avoid an error when you supply nested array literals of different dimensions by enclosing the inner array literals in parentheses. The parentheses force the array literal expression to be evaluated, and the resulting values are used with the outer array literal, as the following code shows.","pos":[9,308],"nodes":[{"content":"You can avoid an error when you supply nested array literals of different dimensions by enclosing the inner array literals in parentheses.","pos":[0,138]},{"content":"The parentheses force the array literal expression to be evaluated, and the resulting values are used with the outer array literal, as the following code shows.","pos":[139,299]}]}]},{"content":"When you create a multidimensional array by using nested array literals, you can use type inference.","pos":[10139,10239]},{"content":"When you use type inference, the inferred type is the dominant type for all the values in all the array literals for a nesting level.","pos":[10240,10373]},{"content":"The following code example creates a two-dimensional array of type <ph id=\"ph1\">`Double`</ph> from values that are of type <ph id=\"ph2\">`Integer`</ph> and <ph id=\"ph3\">`Double`</ph>.","pos":[10374,10502],"source":" The following code example creates a two-dimensional array of type `Double` from values that are of type `Integer` and `Double`."},{"pos":[10664,10856],"content":"For additional examples, see <bpt id=\"p1\">[</bpt>How to: Initialize an Array Variable in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)</ept>.","source":"For additional examples, see [How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)."},{"pos":[10866,10922],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_Iterating\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Iterating Through an Array","linkify":"<a name=\"BKMK_Iterating\"></a> Iterating Through an Array","source":"<a name=\"BKMK_Iterating\"></a> Iterating Through an Array"},{"content":"When you iterate through an array, you access each element in the array from the lowest index to the highest index.","pos":[10926,11041]},{"content":"The following example iterates through a one-dimensional array by using the <bpt id=\"p1\">[</bpt>For...Next Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/for-next-statement.md)</ept>.","pos":[11048,11225],"source":"The following example iterates through a one-dimensional array by using the [For...Next Statement](../../../../visual-basic/language-reference/statements/for-next-statement.md)."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Array.GetUpperBound%2A&gt;</ph> method returns the highest value that the index can have.","pos":[11226,11324],"source":" The <xref:System.Array.GetUpperBound%2A> method returns the highest value that the index can have."},{"content":"The lowest index value is always 0.","pos":[11325,11360]},{"content":"The following example iterates through a multidimensional array by using a <ph id=\"ph1\">`For...Next`</ph> statement.","pos":[11507,11605],"source":"The following example iterates through a multidimensional array by using a `For...Next` statement."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Array.GetUpperBound%2A&gt;</ph> method has a parameter that specifies the dimension.","pos":[11606,11699],"source":" The <xref:System.Array.GetUpperBound%2A> method has a parameter that specifies the dimension."},{"content":"<ph id=\"ph1\">`GetUpperBound(0)`</ph> returns the high index value for the first dimension, and <ph id=\"ph2\">`GetUpperBound(1)`</ph> returns the high index value for the second dimension.","pos":[11700,11850],"source":"`GetUpperBound(0)` returns the high index value for the first dimension, and `GetUpperBound(1)` returns the high index value for the second dimension."},{"pos":[11997,12182],"content":"The following example iterates through a one-dimensional array by using a <bpt id=\"p1\">[</bpt>For Each...Next Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/for-each-next-statement.md)</ept>.","source":"The following example iterates through a one-dimensional array by using a [For Each...Next Statement](../../../../visual-basic/language-reference/statements/for-each-next-statement.md)."},{"content":"The following example iterates through a multidimensional array by using a <ph id=\"ph1\">`For Each...Next`</ph> statement.","pos":[12329,12432],"source":"The following example iterates through a multidimensional array by using a `For Each...Next` statement."},{"content":"However, you have more control over the elements of a multidimensional array if you use a nested <ph id=\"ph1\">`For…Next`</ph> statement, as in a previous example, instead of a <ph id=\"ph2\">`For Each…Next`</ph> statement.","pos":[12433,12617],"source":" However, you have more control over the elements of a multidimensional array if you use a nested `For…Next` statement, as in a previous example, instead of a `For Each…Next` statement."},{"pos":[12767,12838],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_ReturnValues\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Arrays as Return Values and Parameters","linkify":"<a name=\"BKMK_ReturnValues\"></a> Arrays as Return Values and Parameters","source":"<a name=\"BKMK_ReturnValues\"></a> Arrays as Return Values and Parameters"},{"content":"To return an array from a <ph id=\"ph1\">`Function`</ph> procedure, specify the array data type and the number of dimensions as the return type of the <bpt id=\"p1\">[</bpt>Function Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/function-statement.md)</ept>.","pos":[12842,13072],"source":"To return an array from a `Function` procedure, specify the array data type and the number of dimensions as the return type of the [Function Statement](../../../../visual-basic/language-reference/statements/function-statement.md)."},{"content":"Within the function, declare a local array variable with same data type and number of dimensions.","pos":[13073,13170]},{"content":"In the <bpt id=\"p1\">[</bpt>Return Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/return-statement.md)</ept>, include the local array variable without parentheses.","pos":[13171,13327],"source":" In the [Return Statement](../../../../visual-basic/language-reference/statements/return-statement.md), include the local array variable without parentheses."},{"content":"To specify an array as a parameter to a <ph id=\"ph1\">`Sub`</ph> or <ph id=\"ph2\">`Function`</ph> procedure, define the parameter as an array with a specified data type and number of dimensions.","pos":[13334,13490],"source":"To specify an array as a parameter to a `Sub` or `Function` procedure, define the parameter as an array with a specified data type and number of dimensions."},{"content":"In the call to the procedure, send an array variable with the same data type and number of dimensions.","pos":[13491,13593]},{"content":"In the following example, the <ph id=\"ph1\">`GetNumbers`</ph> function returns an <ph id=\"ph2\">`Integer()`</ph>.","pos":[13600,13675],"source":"In the following example, the `GetNumbers` function returns an `Integer()`."},{"content":"This array type is a one dimensional array of type <ph id=\"ph1\">`Integer`</ph>.","pos":[13676,13737],"source":" This array type is a one dimensional array of type `Integer`."},{"content":"The <ph id=\"ph1\">`ShowNumbers`</ph> procedure accepts an <ph id=\"ph2\">`Integer()`</ph> argument.","pos":[13738,13798],"source":" The `ShowNumbers` procedure accepts an `Integer()` argument."},{"content":"In the following example, the <ph id=\"ph1\">`GetNumbersMultiDim`</ph> function returns an <ph id=\"ph2\">`Integer(,)`</ph>.","pos":[13945,14029],"source":"In the following example, the `GetNumbersMultiDim` function returns an `Integer(,)`."},{"content":"This array type is a two dimensional array of type <ph id=\"ph1\">`Integer`</ph>.","pos":[14030,14091],"source":" This array type is a two dimensional array of type `Integer`."},{"content":"The <ph id=\"ph1\">`ShowNumbersMultiDim`</ph> procedure accepts an <ph id=\"ph2\">`Integer(,)`</ph> argument.","pos":[14093,14162],"source":"  The `ShowNumbersMultiDim` procedure accepts an `Integer(,)` argument."},{"pos":[14312,14358],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_JaggedArrays\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Jagged Arrays","linkify":"<a name=\"BKMK_JaggedArrays\"></a> Jagged Arrays","source":"<a name=\"BKMK_JaggedArrays\"></a> Jagged Arrays"},{"content":"An array that holds other arrays as elements is known as an array of arrays or a jagged array.","pos":[14362,14456]},{"content":"A jagged array and each element in a jagged array can have one or more dimensions.","pos":[14457,14539]},{"content":"Sometimes the data structure in your application is two-dimensional but not rectangular.","pos":[14540,14628]},{"content":"The following example has an array of months, each element of which is an array of days.","pos":[14635,14723]},{"content":"Because different months have different numbers of days, the elements don’t form a rectangular two-dimensional array.","pos":[14724,14841]},{"content":"Therefore, a jagged array is used instead of a multidimensional array.","pos":[14842,14912]},{"pos":[15062,15111],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_ZeroLength\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Zero-Length Arrays","linkify":"<a name=\"BKMK_ZeroLength\"></a> Zero-Length Arrays","source":"<a name=\"BKMK_ZeroLength\"></a> Zero-Length Arrays"},{"content":"An array that contains no elements is also called a zero-length array.","pos":[15115,15185]},{"content":"A variable that holds a zero-length array doesn’t have the value <ph id=\"ph1\">`Nothing`</ph>.","pos":[15186,15261],"source":" A variable that holds a zero-length array doesn’t have the value `Nothing`."},{"content":"To create an array that has no elements, declare one of the array's dimensions to be -1, as the following example shows.","pos":[15262,15382]},{"content":"You might need to create a zero-length array under the following circumstances:","pos":[15529,15608]},{"pos":[15618,15989],"content":"Without risking a <ph id=\"ph1\">&lt;xref:System.NullReferenceException&gt;</ph> exception, your code must access members of the <ph id=\"ph2\">&lt;xref:System.Array&gt;</ph> class, such as <ph id=\"ph3\">&lt;xref:System.Array.Length%2A&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Array.Rank%2A&gt;</ph>, or call a <ph id=\"ph5\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> function such as <ph id=\"ph6\">&lt;xref:Microsoft.VisualBasic.Information.UBound%2A&gt;</ph>.","source":"Without risking a <xref:System.NullReferenceException> exception, your code must access members of the <xref:System.Array> class, such as <xref:System.Array.Length%2A> or <xref:System.Array.Rank%2A>, or call a [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] function such as <xref:Microsoft.VisualBasic.Information.UBound%2A>."},{"pos":[15999,16098],"content":"You want to keep the consuming code simpler by not having to check for <ph id=\"ph1\">`Nothing`</ph> as a special case.","source":"You want to keep the consuming code simpler by not having to check for `Nothing` as a special case."},{"content":"Your code interacts with an application programming interface (API) that either requires you to pass a zero-length array to one or more procedures or returns a zero-length array from one or more procedures.","pos":[16108,16314]},{"pos":[16324,16364],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_ArraySize\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Array Size","linkify":"<a name=\"BKMK_ArraySize\"></a> Array Size","source":"<a name=\"BKMK_ArraySize\"></a> Array Size"},{"content":"The size of an array is the product of the lengths of all its dimensions.","pos":[16368,16441]},{"content":"It represents the total number of elements currently contained in the array.","pos":[16442,16518]},{"content":"The following example declares a three-dimensional array.","pos":[16525,16582]},{"pos":[16634,16722],"content":"The overall size of the array in variable <ph id=\"ph1\">`prices`</ph> is (3 + 1) x (4 + 1) x (5 + 1) = 120.","source":"The overall size of the array in variable `prices` is (3 + 1) x (4 + 1) x (5 + 1) = 120."},{"content":"You can find the size of an array by using the <ph id=\"ph1\">&lt;xref:System.Array.Length%2A&gt;</ph> property.","pos":[16729,16815],"source":"You can find the size of an array by using the <xref:System.Array.Length%2A> property."},{"content":"You can find the length of each dimension of a multi-dimensional array by using the <ph id=\"ph1\">&lt;xref:System.Array.GetLength%2A&gt;</ph> method.","pos":[16816,16940],"source":" You can find the length of each dimension of a multi-dimensional array by using the <xref:System.Array.GetLength%2A> method."},{"pos":[16947,17052],"content":"You can resize an array variable by assigning a new array object to it or by using the <ph id=\"ph1\">`ReDim`</ph> statement.","source":"You can resize an array variable by assigning a new array object to it or by using the `ReDim` statement."},{"content":"There are several things to keep in mind when dealing with the size of an array.","pos":[17059,17139]},{"content":"Dimension Length","pos":[17164,17180]},{"content":"The index of each dimension is 0-based, which means it ranges from 0 through its upper bound.","pos":[17181,17274]},{"content":"Therefore, the length of a given dimension is greater by 1 than the declared upper bound for that dimension.","pos":[17275,17383]},{"content":"Length Limits","pos":[17388,17401]},{"content":"The length of every dimension of an array is limited to the maximum value of the <ph id=\"ph1\">`Integer`</ph> data type, which is (2 ^ 31) - 1.","pos":[17402,17526],"source":"The length of every dimension of an array is limited to the maximum value of the `Integer` data type, which is (2 ^ 31) - 1."},{"content":"However, the total size of an array is also limited by the memory available on your system.","pos":[17527,17618]},{"content":"If you attempt to initialize an array that exceeds the amount of available RAM, the common language runtime throws an <ph id=\"ph1\">&lt;xref:System.OutOfMemoryException&gt;</ph> exception.","pos":[17619,17782],"source":" If you attempt to initialize an array that exceeds the amount of available RAM, the common language runtime throws an <xref:System.OutOfMemoryException> exception."},{"content":"Size and Element Size","pos":[17787,17808]},{"content":"An array's size is independent of the data type of its elements.","pos":[17809,17873]},{"content":"The size always represents the total number of elements, not the number of bytes that they consume in storage.","pos":[17874,17984]},{"content":"Memory Consumption","pos":[17989,18007]},{"content":"It is not safe to make any assumptions regarding how an array is stored in memory.","pos":[18008,18090]},{"content":"Storage varies on platforms of different data widths, so the same array can consume more memory on a 64-bit system than on a 32-bit system.","pos":[18091,18230]},{"content":"Depending on system configuration when you initialize an array, the common language runtime (CLR) can assign storage either to pack elements as close together as possible, or to align them all on natural hardware boundaries.","pos":[18231,18455]},{"content":"Also, an array requires a storage overhead for its control information, and this overhead increases with each added dimension.","pos":[18456,18582]},{"pos":[18593,18651],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_ArrayTypes\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Array Types and Other Types","linkify":"<a name=\"BKMK_ArrayTypes\"></a> Array Types and Other Types","source":"<a name=\"BKMK_ArrayTypes\"></a> Array Types and Other Types"},{"content":"Every array has a data type, but it differs from the data type of its elements.","pos":[18655,18734]},{"content":"There is no single data type for all arrays.","pos":[18735,18779]},{"content":"Instead, the data type of an array is determined by the number of dimensions, or <bpt id=\"p1\">*</bpt>rank<ept id=\"p1\">*</ept>, of the array, and the data type of the elements in the array.","pos":[18780,18930],"source":" Instead, the data type of an array is determined by the number of dimensions, or *rank*, of the array, and the data type of the elements in the array."},{"content":"Two array variables are considered to be of the same data type only when they have the same rank and their elements have the same data type.","pos":[18931,19071]},{"content":"The lengths of the dimensions in an array do not influence the array data type.","pos":[19072,19151]},{"content":"Every array inherits from the <ph id=\"ph1\">&lt;xref:System.Array?displayProperty=fullName&gt;</ph> class, and you can declare a variable to be of type <ph id=\"ph2\">`Array`</ph>, but you cannot create an array of type <ph id=\"ph3\">`Array`</ph>.","pos":[19158,19341],"source":"Every array inherits from the <xref:System.Array?displayProperty=fullName> class, and you can declare a variable to be of type `Array`, but you cannot create an array of type `Array`."},{"content":"Also, the <bpt id=\"p1\">[</bpt>ReDim Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/redim-statement.md)</ept> cannot operate on a variable declared as type <ph id=\"ph1\">`Array`</ph>.","pos":[19342,19499],"source":" Also, the [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md) cannot operate on a variable declared as type `Array`."},{"content":"For these reasons, and for type safety, it is advisable to declare every array as a specific type, such as <ph id=\"ph1\">`Integer`</ph> in the preceding example.","pos":[19500,19642],"source":" For these reasons, and for type safety, it is advisable to declare every array as a specific type, such as `Integer` in the preceding example."},{"content":"You can find out the data type of either an array or its elements in several ways.","pos":[19649,19731]},{"content":"You can call the <ph id=\"ph1\">&lt;xref:System.Object.GetType%2A?displayProperty=fullName&gt;</ph> method on the variable to receive a <ph id=\"ph2\">&lt;xref:System.Type&gt;</ph> object for the run-time type of the variable.","pos":[19741,19915],"source":"You can call the <xref:System.Object.GetType%2A?displayProperty=fullName> method on the variable to receive a <xref:System.Type> object for the run-time type of the variable."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Type&gt;</ph> object holds extensive information in its properties and methods.","pos":[19916,20004],"source":" The <xref:System.Type> object holds extensive information in its properties and methods."},{"pos":[20014,20168],"content":"You can pass the variable to the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.Information.TypeName%2A&gt;</ph> function to receive a <ph id=\"ph2\">`String`</ph> containing the name of run-time type.","source":"You can pass the variable to the <xref:Microsoft.VisualBasic.Information.TypeName%2A> function to receive a `String` containing the name of run-time type."},{"pos":[20178,20358],"content":"You can pass the variable to the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.Information.VarType%2A&gt;</ph> function to receive a <ph id=\"ph2\">`VariantType`</ph> value representing the type classification of the variable.","source":"You can pass the variable to the <xref:Microsoft.VisualBasic.Information.VarType%2A> function to receive a `VariantType` value representing the type classification of the variable."},{"content":"The following example calls the <ph id=\"ph1\">`TypeName`</ph> function to determine the type of the array and the type of the elements in the array.","pos":[20365,20494],"source":"The following example calls the `TypeName` function to determine the type of the array and the type of the elements in the array."},{"content":"The array type is <ph id=\"ph1\">`Integer(,)`</ph> and the elements in the array are of type <ph id=\"ph2\">`Integer`</ph>.","pos":[20495,20578],"source":" The array type is `Integer(,)` and the elements in the array are of type `Integer`."},{"pos":[20728,20799],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_Collections\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> Collections as an Alternative to Arrays","linkify":"<a name=\"BKMK_Collections\"></a> Collections as an Alternative to Arrays","source":"<a name=\"BKMK_Collections\"></a> Collections as an Alternative to Arrays"},{"content":"Arrays are most useful for creating and working with a fixed number of strongly typed objects.","pos":[20803,20897]},{"content":"Collections provide a more flexible way to work with groups of objects.","pos":[20898,20969]},{"content":"Unlike arrays, the group of objects that you work with can grow and shrink dynamically as the needs of the application change.","pos":[20970,21096]},{"content":"If you need to change the size of an array, you must use the <bpt id=\"p1\">[</bpt>ReDim Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/redim-statement.md)</ept>.","pos":[21103,21257],"source":"If you need to change the size of an array, you must use the [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md)."},{"content":"When you do this, <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph> creates a new array and releases the previous array for disposal.","pos":[21258,21434],"source":" When you do this, [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] creates a new array and releases the previous array for disposal."},{"content":"This takes execution time.","pos":[21435,21461]},{"content":"Therefore, if the number of items you are working with changes frequently, or you cannot predict the maximum number of items you need, you might obtain better performance using a collection.","pos":[21462,21652]},{"content":"For some collections, you can assign a key to any object that you put into the collection so that you can quickly retrieve the object by using the key.","pos":[21659,21810]},{"content":"If your collection contains elements of only one data type, you can use one of the classes in the <ph id=\"ph1\">&lt;xref:System.Collections.Generic?displayProperty=fullName&gt;</ph> namespace.","pos":[21817,21984],"source":"If your collection contains elements of only one data type, you can use one of the classes in the <xref:System.Collections.Generic?displayProperty=fullName> namespace."},{"content":"A generic collection enforces type safety so that no other data type can be added to it.","pos":[21985,22073]},{"content":"When you retrieve an element from a generic collection, you do not have to determine its data type or convert it.","pos":[22074,22187]},{"pos":[22194,22324],"content":"For more information about collections, see <bpt id=\"p1\">[</bpt>Collections<ept id=\"p1\">](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)</ept>.","source":"For more information about collections, see [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)."},{"pos":[22334,22341],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[22345,22595],"content":"The following example uses the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort_md.md)]</ph> generic class <ph id=\"ph2\">&lt;xref:System.Collections.Generic.List%601?displayProperty=fullName&gt;</ph> to create a list collection of <ph id=\"ph3\">`Customer`</ph> objects.","source":"The following example uses the [!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort_md.md)] generic class <xref:System.Collections.Generic.List%601?displayProperty=fullName> to create a list collection of `Customer` objects."},{"content":"The declaration of the <ph id=\"ph1\">`CustomerFile`</ph> collection specifies that it can contain elements only of type <ph id=\"ph2\">`Customer`</ph>.","pos":[22741,22853],"source":"The declaration of the `CustomerFile` collection specifies that it can contain elements only of type `Customer`."},{"content":"It also provides for an initial capacity of 200 elements.","pos":[22854,22911]},{"content":"The procedure <ph id=\"ph1\">`AddNewCustomer`</ph> checks the new element for validity and then adds it to the collection.","pos":[22912,23014],"source":" The procedure `AddNewCustomer` checks the new element for validity and then adds it to the collection."},{"content":"The procedure <ph id=\"ph1\">`PrintCustomers`</ph> uses a <ph id=\"ph2\">`For Each`</ph> loop to traverse the collection and display its elements.","pos":[23015,23121],"source":" The procedure `PrintCustomers` uses a `For Each` loop to traverse the collection and display its elements."},{"pos":[23130,23144],"content":"Related Topics","linkify":"Related Topics","nodes":[{"content":"Related Topics","pos":[0,14]}]},{"content":"Term","pos":[23151,23155]},{"content":"Definition","pos":[23156,23166]},{"pos":[23203,23326],"content":"<bpt id=\"p1\">[</bpt>Array Dimensions in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/array-dimensions.md)</ept>","source":"[Array Dimensions in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/array-dimensions.md)"},{"content":"Explains rank and dimensions in arrays.","pos":[23327,23366]},{"pos":[23371,23533],"content":"<bpt id=\"p1\">[</bpt>How to: Initialize an Array Variable in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)</ept>","source":"[How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)"},{"content":"Describes how to populate arrays with initial values.","pos":[23534,23587]},{"pos":[23592,23724],"content":"<bpt id=\"p1\">[</bpt>How to: Sort An Array in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/how-to-sort-an-array.md)</ept>","source":"[How to: Sort An Array in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-sort-an-array.md)"},{"content":"Shows how to sort the elements of an array alphabetically.","pos":[23725,23783]},{"pos":[23788,23944],"content":"<bpt id=\"p1\">[</bpt>How to: Assign One Array to Another Array<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/how-to-assign-one-array-to-another-array.md)</ept>","source":"[How to: Assign One Array to Another Array](../../../../visual-basic/programming-guide/language-features/arrays/how-to-assign-one-array-to-another-array.md)"},{"content":"Describes the rules and steps for assigning an array to another array variable.","pos":[23945,24024]},{"pos":[24029,24148],"content":"<bpt id=\"p1\">[</bpt>Troubleshooting Arrays<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/arrays/troubleshooting-arrays.md)</ept>","source":"[Troubleshooting Arrays](../../../../visual-basic/programming-guide/language-features/arrays/troubleshooting-arrays.md)"},{"content":"Discusses some common problems that arise when working with arrays.","pos":[24149,24216]},{"pos":[24226,24234],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Dim Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/dim-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[24262,24351],"source":"[Dim Statement](../../../../visual-basic/language-reference/statements/dim-statement.md) "},{"content":"<bpt id=\"p1\">[</bpt>ReDim Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/redim-statement.md)</ept>","pos":[24355,24447],"source":"[ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md)"}]}