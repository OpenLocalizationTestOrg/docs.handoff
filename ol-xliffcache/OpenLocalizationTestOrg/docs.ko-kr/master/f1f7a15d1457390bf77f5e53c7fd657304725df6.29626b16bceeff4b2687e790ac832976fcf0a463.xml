{"content":"---\ntitle: \"SAML Tokens and Claims\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"WCF, federation\"\n  - \"federation\"\n  - \"issued tokens\"\n  - \"SAML token\"\nms.assetid: 930b6e34-9eab-4e95-826c-4e06659bb977\n---\n# SAML Tokens and Claims\nSecurity Assertions Markup Language (SAML) *tokens* are XML representations of claims. By default, SAML tokens Windows Communication Foundation (WCF) uses in federated security scenarios are *issued tokens*.  \n  \n SAML tokens carry statements that are sets of claims made by one entity about another entity. For example, in federated security scenarios, the statements are made by a security token service about a user in the system. The security token service signs the SAML token to indicate the veracity of the statements contained in the token. In addition, the SAML token is associated with cryptographic key material that the user of the SAML token proves knowledge of. This proof satisfies the relying party that the SAML token was, in fact, issued to that user. For example, in a typical scenario:  \n  \n1.  A client requests a SAML token from a security token service, authenticating to that security token service by using Windows credentials.  \n  \n2.  The security token service issues a SAML token to the client. The SAML token is signed with a certificate associated with the security token service and contains a proof key encrypted for the target service.  \n  \n3.  The client also receives a copy of the *proof key*. The client then presents the SAML token to the application service (the *relying party*) and signs the message with that proof key.  \n  \n4.  The signature over the SAML token tells the relying party that the security token service issued the token. The message signature created with the proof key tells the relying party that the token was issued to the client.  \n  \n## From Claims to SamlAttributes  \n In WCF, statements in SAML tokens are modeled as <xref:System.IdentityModel.Tokens.SamlAttribute> objects, which can be populated directly from <xref:System.IdentityModel.Claims.Claim> objects, provided the <xref:System.IdentityModel.Claims.Claim> object has a <xref:System.IdentityModel.Claims.Claim.Right%2A> property of <xref:System.IdentityModel.Claims.Rights.PossessProperty%2A> and the <xref:System.IdentityModel.Claims.Claim.Resource%2A> property is of type <xref:System.String>. For example:  \n  \n [!code-csharp[c_CreateSTS#8](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_creatests/cs/source.cs#8)]\n [!code-vb[c_CreateSTS#8](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_creatests/vb/source.vb#8)]  \n  \n> [!NOTE]\n>  When SAML tokens are serialized in messages, either when they are issued by a security token service or when they are presented by clients to services as part of authentication, the maximum message size quota must be sufficiently large to accommodate the SAML token and the other message parts. In normal cases, the default message size quotas are sufficient. However, in cases where a SAML token is large because it contains hundreds of claims, you may need to increase the quotas to accommodate the serialized token. For more information, see [Security Considerations for Data](../../../../docs/framework/wcf/feature-details/security-considerations-for-data.md).  \n  \n## From SamlAttributes to Claims  \n When SAML tokens are received in messages, the various statements in the SAML token are turned into <xref:System.IdentityModel.Policy.IAuthorizationPolicy> objects that are placed into the <xref:System.IdentityModel.Policy.AuthorizationContext>. The claims from each SAML statement are returned by the <xref:System.IdentityModel.Policy.AuthorizationContext.ClaimSets%2A> property of the <xref:System.IdentityModel.Policy.AuthorizationContext> and can be examined to determine whether to authenticate and authorize the user.  \n  \n## See also\n\n- <xref:System.IdentityModel.Policy.AuthorizationContext>\n- <xref:System.IdentityModel.Policy.IAuthorizationPolicy>\n- <xref:System.IdentityModel.Claims.ClaimSet>\n- [Federation](../../../../docs/framework/wcf/feature-details/federation.md)\n- [How to: Create a Federated Client](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)\n- [How to: Configure Credentials on a Federation Service](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)\n- [Managing Claims and Authorization with the Identity Model](../../../../docs/framework/wcf/feature-details/managing-claims-and-authorization-with-the-identity-model.md)\n- [Claims and Tokens](../../../../docs/framework/wcf/feature-details/claims-and-tokens.md)\n- [Claim Creation and Resource Values](../../../../docs/framework/wcf/feature-details/claim-creation-and-resource-values.md)\n- [How to: Create a Custom Claim](../../../../docs/framework/wcf/extending/how-to-create-a-custom-claim.md)\n","nodes":[{"pos":[4,238],"embed":true,"restype":"x-metadata","content":"title: \"SAML Tokens and Claims\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"WCF, federation\"\n  - \"federation\"\n  - \"issued tokens\"\n  - \"SAML token\"\nms.assetid: 930b6e34-9eab-4e95-826c-4e06659bb977","nodes":[{"content":"SAML Tokens and Claims","nodes":[{"pos":[0,22],"content":"SAML Tokens and Claims","nodes":[{"content":"SAML Tokens and Claims","pos":[0,22]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[245,267],"content":"SAML Tokens and Claims","linkify":"SAML Tokens and Claims","nodes":[{"content":"SAML Tokens and Claims","pos":[0,22]}]},{"content":"Security Assertions Markup Language (SAML) <bpt id=\"p1\">*</bpt>tokens<ept id=\"p1\">*</ept> are XML representations of claims.","pos":[268,354],"source":"Security Assertions Markup Language (SAML) *tokens* are XML representations of claims."},{"content":"By default, SAML tokens Windows Communication Foundation (WCF) uses in federated security scenarios are <bpt id=\"p1\">*</bpt>issued tokens<ept id=\"p1\">*</ept>.","pos":[355,475],"source":" By default, SAML tokens Windows Communication Foundation (WCF) uses in federated security scenarios are *issued tokens*."},{"content":"SAML tokens carry statements that are sets of claims made by one entity about another entity.","pos":[482,575]},{"content":"For example, in federated security scenarios, the statements are made by a security token service about a user in the system.","pos":[576,701]},{"content":"The security token service signs the SAML token to indicate the veracity of the statements contained in the token.","pos":[702,816]},{"content":"In addition, the SAML token is associated with cryptographic key material that the user of the SAML token proves knowledge of.","pos":[817,943]},{"content":"This proof satisfies the relying party that the SAML token was, in fact, issued to that user.","pos":[944,1037]},{"content":"For example, in a typical scenario:","pos":[1038,1073]},{"content":"A client requests a SAML token from a security token service, authenticating to that security token service by using Windows credentials.","pos":[1083,1220]},{"content":"The security token service issues a SAML token to the client.","pos":[1230,1291]},{"content":"The SAML token is signed with a certificate associated with the security token service and contains a proof key encrypted for the target service.","pos":[1292,1437]},{"content":"The client also receives a copy of the <bpt id=\"p1\">*</bpt>proof key<ept id=\"p1\">*</ept>.","pos":[1447,1498],"source":"The client also receives a copy of the *proof key*."},{"content":"The client then presents the SAML token to the application service (the <bpt id=\"p1\">*</bpt>relying party<ept id=\"p1\">*</ept>) and signs the message with that proof key.","pos":[1499,1630],"source":" The client then presents the SAML token to the application service (the *relying party*) and signs the message with that proof key."},{"content":"The signature over the SAML token tells the relying party that the security token service issued the token.","pos":[1640,1747]},{"content":"The message signature created with the proof key tells the relying party that the token was issued to the client.","pos":[1748,1861]},{"pos":[1870,1899],"content":"From Claims to SamlAttributes","linkify":"From Claims to SamlAttributes","nodes":[{"content":"From Claims to SamlAttributes","pos":[0,29]}]},{"content":"In WCF, statements in SAML tokens are modeled as <ph id=\"ph1\">&lt;xref:System.IdentityModel.Tokens.SamlAttribute&gt;</ph> objects, which can be populated directly from <ph id=\"ph2\">&lt;xref:System.IdentityModel.Claims.Claim&gt;</ph> objects, provided the <ph id=\"ph3\">&lt;xref:System.IdentityModel.Claims.Claim&gt;</ph> object has a <ph id=\"ph4\">&lt;xref:System.IdentityModel.Claims.Claim.Right%2A&gt;</ph> property of <ph id=\"ph5\">&lt;xref:System.IdentityModel.Claims.Rights.PossessProperty%2A&gt;</ph> and the <ph id=\"ph6\">&lt;xref:System.IdentityModel.Claims.Claim.Resource%2A&gt;</ph> property is of type <ph id=\"ph7\">&lt;xref:System.String&gt;</ph>.","pos":[1903,2389],"source":"In WCF, statements in SAML tokens are modeled as <xref:System.IdentityModel.Tokens.SamlAttribute> objects, which can be populated directly from <xref:System.IdentityModel.Claims.Claim> objects, provided the <xref:System.IdentityModel.Claims.Claim> object has a <xref:System.IdentityModel.Claims.Claim.Right%2A> property of <xref:System.IdentityModel.Claims.Rights.PossessProperty%2A> and the <xref:System.IdentityModel.Claims.Claim.Resource%2A> property is of type <xref:System.String>."},{"content":"For example:","pos":[2390,2402]},{"pos":[2638,3313],"content":"[!NOTE]\n When SAML tokens are serialized in messages, either when they are issued by a security token service or when they are presented by clients to services as part of authentication, the maximum message size quota must be sufficiently large to accommodate the SAML token and the other message parts. In normal cases, the default message size quotas are sufficient. However, in cases where a SAML token is large because it contains hundreds of claims, you may need to increase the quotas to accommodate the serialized token. For more information, see [Security Considerations for Data](../../../../docs/framework/wcf/feature-details/security-considerations-for-data.md).","leadings":["","> "],"nodes":[{"content":"When SAML tokens are serialized in messages, either when they are issued by a security token service or when they are presented by clients to services as part of authentication, the maximum message size quota must be sufficiently large to accommodate the SAML token and the other message parts. In normal cases, the default message size quotas are sufficient. However, in cases where a SAML token is large because it contains hundreds of claims, you may need to increase the quotas to accommodate the serialized token. For more information, see [Security Considerations for Data](../../../../docs/framework/wcf/feature-details/security-considerations-for-data.md).","pos":[9,673],"nodes":[{"content":"When SAML tokens are serialized in messages, either when they are issued by a security token service or when they are presented by clients to services as part of authentication, the maximum message size quota must be sufficiently large to accommodate the SAML token and the other message parts.","pos":[0,294]},{"content":"In normal cases, the default message size quotas are sufficient.","pos":[295,359]},{"content":"However, in cases where a SAML token is large because it contains hundreds of claims, you may need to increase the quotas to accommodate the serialized token.","pos":[360,518]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Security Considerations for Data<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/security-considerations-for-data.md)</ept>.","pos":[519,664],"source":" For more information, see [Security Considerations for Data](../../../../docs/framework/wcf/feature-details/security-considerations-for-data.md)."}]}]},{"pos":[3322,3351],"content":"From SamlAttributes to Claims","linkify":"From SamlAttributes to Claims","nodes":[{"content":"From SamlAttributes to Claims","pos":[0,29]}]},{"content":"When SAML tokens are received in messages, the various statements in the SAML token are turned into <ph id=\"ph1\">&lt;xref:System.IdentityModel.Policy.IAuthorizationPolicy&gt;</ph> objects that are placed into the <ph id=\"ph2\">&lt;xref:System.IdentityModel.Policy.AuthorizationContext&gt;</ph>.","pos":[3355,3600],"source":"When SAML tokens are received in messages, the various statements in the SAML token are turned into <xref:System.IdentityModel.Policy.IAuthorizationPolicy> objects that are placed into the <xref:System.IdentityModel.Policy.AuthorizationContext>."},{"content":"The claims from each SAML statement are returned by the <ph id=\"ph1\">&lt;xref:System.IdentityModel.Policy.AuthorizationContext.ClaimSets%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.IdentityModel.Policy.AuthorizationContext&gt;</ph> and can be examined to determine whether to authenticate and authorize the user.","pos":[3601,3878],"source":" The claims from each SAML statement are returned by the <xref:System.IdentityModel.Policy.AuthorizationContext.ClaimSets%2A> property of the <xref:System.IdentityModel.Policy.AuthorizationContext> and can be examined to determine whether to authenticate and authorize the user."},{"pos":[3887,3895],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4061,4135],"content":"<bpt id=\"p1\">[</bpt>Federation<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/federation.md)</ept>","source":"[Federation](../../../../docs/framework/wcf/feature-details/federation.md)"},{"pos":[4138,4257],"content":"<bpt id=\"p1\">[</bpt>How to: Create a Federated Client<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)</ept>","source":"[How to: Create a Federated Client](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)"},{"pos":[4260,4419],"content":"<bpt id=\"p1\">[</bpt>How to: Configure Credentials on a Federation Service<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)</ept>","source":"[How to: Configure Credentials on a Federation Service](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)"},{"pos":[4422,4590],"content":"<bpt id=\"p1\">[</bpt>Managing Claims and Authorization with the Identity Model<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/managing-claims-and-authorization-with-the-identity-model.md)</ept>","source":"[Managing Claims and Authorization with the Identity Model](../../../../docs/framework/wcf/feature-details/managing-claims-and-authorization-with-the-identity-model.md)"},{"pos":[4593,4681],"content":"<bpt id=\"p1\">[</bpt>Claims and Tokens<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/claims-and-tokens.md)</ept>","source":"[Claims and Tokens](../../../../docs/framework/wcf/feature-details/claims-and-tokens.md)"},{"pos":[4684,4806],"content":"<bpt id=\"p1\">[</bpt>Claim Creation and Resource Values<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/claim-creation-and-resource-values.md)</ept>","source":"[Claim Creation and Resource Values](../../../../docs/framework/wcf/feature-details/claim-creation-and-resource-values.md)"},{"pos":[4809,4914],"content":"<bpt id=\"p1\">[</bpt>How to: Create a Custom Claim<ept id=\"p1\">](../../../../docs/framework/wcf/extending/how-to-create-a-custom-claim.md)</ept>","source":"[How to: Create a Custom Claim](../../../../docs/framework/wcf/extending/how-to-create-a-custom-claim.md)"}]}