{"content":"---\ntitle: \"How to: Overload a Procedure that Takes Optional Parameters (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"procedures [Visual Basic], parameters\"\n  - \"procedure overloading [Visual Basic], optional parameters\"\n  - \"procedures [Visual Basic], defining\"\n  - \"Visual Basic code, procedures\"\n  - \"procedure parameters\"\n  - \"procedures [Visual Basic], overloading\"\n  - \"procedures [Visual Basic], multiple versions\"\nms.assetid: 825f9d56-4cde-43fd-993a-b9171717e2eb\n---\n# How to: Overload a Procedure that Takes Optional Parameters (Visual Basic)\nIf a procedure has one or more [Optional](../../../../visual-basic/language-reference/modifiers/optional.md) parameters, you cannot define an overloaded version matching any of its implicit overloads. For more information, see \"Implicit Overloads for Optional Parameters\" in [Considerations in Overloading Procedures](./considerations-in-overloading-procedures.md).  \n  \n## One Optional Parameter  \n  \n#### To overload a procedure that takes one optional parameter  \n  \n1.  Write a `Sub` or `Function` declaration statement that includes the optional parameter in the parameter list. Do not use the `Optional` keyword in this overloaded version.  \n  \n2.  Precede the `Sub` or `Function` keyword with the [Overloads](../../../../visual-basic/language-reference/modifiers/overloads.md) keyword.  \n  \n3.  Write the procedure code that should execute when the calling code supplies the optional argument.  \n  \n4.  Terminate the procedure with the `End Sub` or `End Function` statement as appropriate.  \n  \n5.  Write a second declaration statement that is identical to the first declaration except that it does not include the optional parameter in the parameter list.  \n  \n6.  Write the procedure code that should execute when the calling code does not supply the optional argument. Terminate the procedure with the `End Sub` or `End Function` statement as appropriate.  \n  \n     The following example shows a procedure defined with an optional parameter,  an equivalent set of two overloaded procedures, and finally examples of both invalid and valid overloaded versions.  \n  \n     [!code-vb[VbVbcnProcedures#59](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#59)]  \n  \n     [!code-vb[VbVbcnProcedures#60](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#60)]  \n  \n     [!code-vb[VbVbcnProcedures#61](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#61)]  \n  \n## Multiple Optional Parameters  \n For a procedure with more than one optional parameter, you normally need more than two overloaded versions. For example, if there are two optional parameters, and the calling code can supply or omit each one independently of the other, you need four overloaded versions, one for each possible combination of supplied arguments.  \n  \n As the number of optional parameters increases, the complexity of the overloading increases. Unless some combinations of supplied arguments are not acceptable, for N optional parameters you need 2 ^ N overloaded versions. Depending on the nature of the procedure, you might find that the clarity of logic justifies the extra effort of defining all the overloaded versions.  \n  \n#### To overload a procedure that takes more than one optional parameter  \n  \n1.  Determine which combinations of supplied optional arguments are acceptable to the logic of the procedure. An unacceptable combination might arise if one optional parameter depends on another. For example, if one parameter accepts a spouse's name and another accepts the spouse's age, a combination of arguments supplying the age but omitting the name is unacceptable.  \n  \n2.  For each acceptable combination of supplied optional arguments, write a `Sub` or `Function` declaration statement that defines the corresponding parameter list. Do not use the `Optional` keyword.  \n  \n3.  In each declaration, precede the `Sub` or `Function` keyword with the [Overloads](../../../../visual-basic/language-reference/modifiers/overloads.md) keyword.  \n  \n4.  Following each declaration, write the procedure code that should execute when the calling code supplies an argument list corresponding to that declaration's parameter list.  \n  \n5.  Terminate each procedure with the `End Sub` or `End Function` statement as appropriate.  \n  \n## See also\n\n- [Procedures](./index.md)\n- [Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)\n- [Optional Parameters](./optional-parameters.md)\n- [Parameter Arrays](./parameter-arrays.md)\n- [Procedure Overloading](./procedure-overloading.md)\n- [Troubleshooting Procedures](./troubleshooting-procedures.md)\n- [How to: Define Multiple Versions of a Procedure](./how-to-define-multiple-versions-of-a-procedure.md)\n- [How to: Call an Overloaded Procedure](./how-to-call-an-overloaded-procedure.md)\n- [How to: Overload a Procedure that Takes an Indefinite Number of Parameters](./how-to-overload-a-procedure-that-takes-an-indefinite-number-of-parameters.md)\n- [Overload Resolution](./overload-resolution.md)\n","nodes":[{"pos":[4,487],"embed":true,"restype":"x-metadata","content":"title: \"How to: Overload a Procedure that Takes Optional Parameters (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"procedures [Visual Basic], parameters\"\n  - \"procedure overloading [Visual Basic], optional parameters\"\n  - \"procedures [Visual Basic], defining\"\n  - \"Visual Basic code, procedures\"\n  - \"procedure parameters\"\n  - \"procedures [Visual Basic], overloading\"\n  - \"procedures [Visual Basic], multiple versions\"\nms.assetid: 825f9d56-4cde-43fd-993a-b9171717e2eb","nodes":[{"content":"How to: Overload a Procedure that Takes Optional Parameters (Visual Basic)","nodes":[{"pos":[0,74],"content":"How to: Overload a Procedure that Takes Optional Parameters (Visual Basic)","nodes":[{"content":"How to: Overload a Procedure that Takes Optional Parameters (Visual Basic)","pos":[0,74]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[494,568],"content":"How to: Overload a Procedure that Takes Optional Parameters (Visual Basic)","linkify":"How to: Overload a Procedure that Takes Optional Parameters (Visual Basic)","nodes":[{"content":"How to: Overload a Procedure that Takes Optional Parameters (Visual Basic)","pos":[0,74]}]},{"content":"If a procedure has one or more <bpt id=\"p1\">[</bpt>Optional<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/optional.md)</ept> parameters, you cannot define an overloaded version matching any of its implicit overloads.","pos":[569,769],"source":"If a procedure has one or more [Optional](../../../../visual-basic/language-reference/modifiers/optional.md) parameters, you cannot define an overloaded version matching any of its implicit overloads."},{"content":"For more information, see \"Implicit Overloads for Optional Parameters\" in <bpt id=\"p1\">[</bpt>Considerations in Overloading Procedures<ept id=\"p1\">](./considerations-in-overloading-procedures.md)</ept>.","pos":[770,934],"source":" For more information, see \"Implicit Overloads for Optional Parameters\" in [Considerations in Overloading Procedures](./considerations-in-overloading-procedures.md)."},{"pos":[943,965],"content":"One Optional Parameter","linkify":"One Optional Parameter","nodes":[{"content":"One Optional Parameter","pos":[0,22]}]},{"pos":[976,1033],"content":"To overload a procedure that takes one optional parameter","linkify":"To overload a procedure that takes one optional parameter","nodes":[{"content":"To overload a procedure that takes one optional parameter","pos":[0,57]}]},{"content":"Write a <ph id=\"ph1\">`Sub`</ph> or <ph id=\"ph2\">`Function`</ph> declaration statement that includes the optional parameter in the parameter list.","pos":[1043,1152],"source":"Write a `Sub` or `Function` declaration statement that includes the optional parameter in the parameter list."},{"content":"Do not use the <ph id=\"ph1\">`Optional`</ph> keyword in this overloaded version.","pos":[1153,1214],"source":" Do not use the `Optional` keyword in this overloaded version."},{"pos":[1224,1361],"content":"Precede the <ph id=\"ph1\">`Sub`</ph> or <ph id=\"ph2\">`Function`</ph> keyword with the <bpt id=\"p1\">[</bpt>Overloads<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/overloads.md)</ept> keyword.","source":"Precede the `Sub` or `Function` keyword with the [Overloads](../../../../visual-basic/language-reference/modifiers/overloads.md) keyword."},{"content":"Write the procedure code that should execute when the calling code supplies the optional argument.","pos":[1371,1469]},{"pos":[1479,1565],"content":"Terminate the procedure with the <ph id=\"ph1\">`End Sub`</ph> or <ph id=\"ph2\">`End Function`</ph> statement as appropriate.","source":"Terminate the procedure with the `End Sub` or `End Function` statement as appropriate."},{"content":"Write a second declaration statement that is identical to the first declaration except that it does not include the optional parameter in the parameter list.","pos":[1575,1732]},{"content":"Write the procedure code that should execute when the calling code does not supply the optional argument.","pos":[1742,1847]},{"content":"Terminate the procedure with the <ph id=\"ph1\">`End Sub`</ph> or <ph id=\"ph2\">`End Function`</ph> statement as appropriate.","pos":[1848,1934],"source":" Terminate the procedure with the `End Sub` or `End Function` statement as appropriate."},{"content":"The following example shows a procedure defined with an optional parameter,  an equivalent set of two overloaded procedures, and finally examples of both invalid and valid overloaded versions.","pos":[1945,2137]},{"pos":[2530,2558],"content":"Multiple Optional Parameters","linkify":"Multiple Optional Parameters","nodes":[{"content":"Multiple Optional Parameters","pos":[0,28]}]},{"content":"For a procedure with more than one optional parameter, you normally need more than two overloaded versions.","pos":[2562,2669]},{"content":"For example, if there are two optional parameters, and the calling code can supply or omit each one independently of the other, you need four overloaded versions, one for each possible combination of supplied arguments.","pos":[2670,2889]},{"content":"As the number of optional parameters increases, the complexity of the overloading increases.","pos":[2896,2988]},{"content":"Unless some combinations of supplied arguments are not acceptable, for N optional parameters you need 2 ^ N overloaded versions.","pos":[2989,3117]},{"content":"Depending on the nature of the procedure, you might find that the clarity of logic justifies the extra effort of defining all the overloaded versions.","pos":[3118,3268]},{"pos":[3279,3346],"content":"To overload a procedure that takes more than one optional parameter","linkify":"To overload a procedure that takes more than one optional parameter","nodes":[{"content":"To overload a procedure that takes more than one optional parameter","pos":[0,67]}]},{"content":"Determine which combinations of supplied optional arguments are acceptable to the logic of the procedure.","pos":[3356,3461]},{"content":"An unacceptable combination might arise if one optional parameter depends on another.","pos":[3462,3547]},{"content":"For example, if one parameter accepts a spouse's name and another accepts the spouse's age, a combination of arguments supplying the age but omitting the name is unacceptable.","pos":[3548,3723]},{"content":"For each acceptable combination of supplied optional arguments, write a <ph id=\"ph1\">`Sub`</ph> or <ph id=\"ph2\">`Function`</ph> declaration statement that defines the corresponding parameter list.","pos":[3733,3893],"source":"For each acceptable combination of supplied optional arguments, write a `Sub` or `Function` declaration statement that defines the corresponding parameter list."},{"content":"Do not use the <ph id=\"ph1\">`Optional`</ph> keyword.","pos":[3894,3928],"source":" Do not use the `Optional` keyword."},{"pos":[3938,4096],"content":"In each declaration, precede the <ph id=\"ph1\">`Sub`</ph> or <ph id=\"ph2\">`Function`</ph> keyword with the <bpt id=\"p1\">[</bpt>Overloads<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/overloads.md)</ept> keyword.","source":"In each declaration, precede the `Sub` or `Function` keyword with the [Overloads](../../../../visual-basic/language-reference/modifiers/overloads.md) keyword."},{"content":"Following each declaration, write the procedure code that should execute when the calling code supplies an argument list corresponding to that declaration's parameter list.","pos":[4106,4278]},{"pos":[4288,4375],"content":"Terminate each procedure with the <ph id=\"ph1\">`End Sub`</ph> or <ph id=\"ph2\">`End Function`</ph> statement as appropriate.","source":"Terminate each procedure with the `End Sub` or `End Function` statement as appropriate."},{"pos":[4384,4392],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4396,4420],"content":"<bpt id=\"p1\">[</bpt>Procedures<ept id=\"p1\">](./index.md)</ept>","source":"[Procedures](./index.md)"},{"pos":[4423,4500],"content":"<bpt id=\"p1\">[</bpt>Procedure Parameters and Arguments<ept id=\"p1\">](./procedure-parameters-and-arguments.md)</ept>","source":"[Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)"},{"pos":[4503,4550],"content":"<bpt id=\"p1\">[</bpt>Optional Parameters<ept id=\"p1\">](./optional-parameters.md)</ept>","source":"[Optional Parameters](./optional-parameters.md)"},{"pos":[4553,4594],"content":"<bpt id=\"p1\">[</bpt>Parameter Arrays<ept id=\"p1\">](./parameter-arrays.md)</ept>","source":"[Parameter Arrays](./parameter-arrays.md)"},{"pos":[4597,4648],"content":"<bpt id=\"p1\">[</bpt>Procedure Overloading<ept id=\"p1\">](./procedure-overloading.md)</ept>","source":"[Procedure Overloading](./procedure-overloading.md)"},{"pos":[4651,4712],"content":"<bpt id=\"p1\">[</bpt>Troubleshooting Procedures<ept id=\"p1\">](./troubleshooting-procedures.md)</ept>","source":"[Troubleshooting Procedures](./troubleshooting-procedures.md)"},{"pos":[4715,4817],"content":"<bpt id=\"p1\">[</bpt>How to: Define Multiple Versions of a Procedure<ept id=\"p1\">](./how-to-define-multiple-versions-of-a-procedure.md)</ept>","source":"[How to: Define Multiple Versions of a Procedure](./how-to-define-multiple-versions-of-a-procedure.md)"},{"pos":[4820,4900],"content":"<bpt id=\"p1\">[</bpt>How to: Call an Overloaded Procedure<ept id=\"p1\">](./how-to-call-an-overloaded-procedure.md)</ept>","source":"[How to: Call an Overloaded Procedure](./how-to-call-an-overloaded-procedure.md)"},{"pos":[4903,5059],"content":"<bpt id=\"p1\">[</bpt>How to: Overload a Procedure that Takes an Indefinite Number of Parameters<ept id=\"p1\">](./how-to-overload-a-procedure-that-takes-an-indefinite-number-of-parameters.md)</ept>","source":"[How to: Overload a Procedure that Takes an Indefinite Number of Parameters](./how-to-overload-a-procedure-that-takes-an-indefinite-number-of-parameters.md)"},{"pos":[5062,5109],"content":"<bpt id=\"p1\">[</bpt>Overload Resolution<ept id=\"p1\">](./overload-resolution.md)</ept>","source":"[Overload Resolution](./overload-resolution.md)"}]}