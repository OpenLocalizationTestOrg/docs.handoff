{"content":"---\ntitle: \"Retrieving Resources in Desktop Apps | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"deploying applications [.NET Framework], resources\"\n  - \"resource files, deploying\"\n  - \"resource files, packaging\"\n  - \"application resources, packaging\"\n  - \"localization\"\n  - \"versioning satellite assemblies\"\n  - \"retrieving localized resources\"\n  - \"application resources, deploying\"\n  - \"packaging application resources\"\n  - \"versioning resources\"\n  - \"translating resources into languages\"\n  - \"localizing resources\"\nms.assetid: eca16922-1c46-4f68-aefe-e7a12283641f\ncaps.latest.revision: 22\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Retrieving Resources in Desktop Apps\nWhen you work with localized resources in .NET Framework desktop apps, you should ideally package the resources for the default or neutral culture with the main assembly and create a separate satellite assembly for each language or culture that your app supports. You can then use the <xref:System.Resources.ResourceManager> class as described in the next section to access named resources. If you choose not to embed your resources in the main assembly and satellite assemblies, you can also access binary .resources files directly, as discussed in the section [Retrieving Resources from .resources files](#from_file) later in this article.  To retrieve resources in [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] apps, see [Creating and retrieving resources in Windows Store apps](http://go.microsoft.com/fwlink/p/?LinkID=241674) in the Windows Dev Center.  \n  \n<a name=\"from_assembly\"></a>   \n## Retrieving Resources from Assemblies  \n The <xref:System.Resources.ResourceManager> class provides access to resources at run time. You use the <xref:System.Resources.ResourceManager.GetString%2A?displayProperty=fullName> method to retrieve string resources and the <xref:System.Resources.ResourceManager.GetObject%2A?displayProperty=fullName> or <xref:System.Resources.ResourceManager.GetStream%2A?displayProperty=fullName> method to retrieve non-string resources. Each method has two overloads:  \n  \n-   An overload whose single parameter is a string that contains the name of the resource. The method attempts to retrieve that resource for the current thread culture. For more information, see the <xref:System.Resources.ResourceManager.GetString%28System.String%29>, <xref:System.Resources.ResourceManager.GetObject%28System.String%29>, and <xref:System.Resources.ResourceManager.GetStream%28System.String%29> methods.  \n  \n-   An overload that has two parameters: a string containing the name of the resource, and a <xref:System.Globalization.CultureInfo> object that represents the culture whose resource is to be retrieved. If a resource set for that culture cannot be found, the resource manager uses fallback rules to retrieve an appropriate resource. For more information, see the <xref:System.Resources.ResourceManager.GetString%28System.String%2CSystem.Globalization.CultureInfo%29>, <xref:System.Resources.ResourceManager.GetObject%28System.String%2CSystem.Globalization.CultureInfo%29>, and <xref:System.Resources.ResourceManager.GetStream%28System.String%2CSystem.Globalization.CultureInfo%29> methods.  \n  \n The resource manager uses the resource fallback process to control how the app retrieves culture-specific resources. For more information, see the \"Resource Fallback Process\" section in [Packaging and Deploying Resources](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md). For information about instantiating a <xref:System.Resources.ResourceManager> object, see the \"Instantiating a ResourceManager Object\" section in the <xref:System.Resources.ResourceManager> class topic.  \n  \n### Retrieving String Data: An Example  \n The following example calls the <xref:System.Resources.ResourceManager.GetString%28System.String%29> method to retrieve the string resources of the current UI culture. It includes a neutral string resource for the English (United States) culture and localized resources for the French (France) and Russian (Russia) cultures. The following English (United States) resource is in a file named Strings.txt:  \n  \n```  \nTimeHeader=The current time is  \n```  \n  \n The French (France) resource is in a file named Strings.fr-FR.txt:  \n  \n```  \nTimeHeader=L'heure actuelle est  \n```  \n  \n The Russian (Russia) resource is in a file named Strings.ru-RU-txt:  \n  \n```  \nTimeHeader=Текущее время —  \n```  \n  \n The source code for this example, which is in a file named GetString.cs for the C# version of the code and GetString.vb for the Visual Basic version, defines a string array that contains the name of four cultures: the three cultures for which resources are available and the Spanish (Spain) culture. A loop that executes five times randomly selects one of these cultures and assigns it to the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> properties. It then calls the <xref:System.Resources.ResourceManager.GetString%28System.String%29> method to retrieve the localized string, which it displays along with the time of day.  \n  \n [!code-csharp[Conceptual.Resources.Retrieving#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/getstring.cs#3)]\n [!code-vb[Conceptual.Resources.Retrieving#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/getstring.vb#3)]  \n  \n The following batch (.bat) file compiles the example and generates satellite assemblies in the appropriate directories. The commands are provided for the C# language and compiler. For Visual Basic, change `csc` to `vbc`, and change `GetString.cs` to `GetString.vb`.  \n  \n```  \n  \nresgen strings.txt  \ncsc GetString.cs /resource:strings.resources  \n  \nresgen strings.fr-FR.txt  \nmd fr-FR  \nal /embed:strings.fr-FR.resources /culture:fr-FR /out:fr-FR\\GetString.resources.dll  \n  \nresgen strings.ru-RU.txt  \nmd ru-RU  \nal /embed:strings.ru-RU.resources /culture:ru-RU /out:ru-RU\\GetString.resources.dll  \n  \n```  \n  \n When the current UI culture is Spanish (Spain), note that the example displays English language resources, because Spanish language resources are unavailable, and English is the example's default culture.  \n  \n### Retrieving Object Data: Two Examples  \n You can use the <xref:System.Resources.ResourceManager.GetObject%2A> and <xref:System.Resources.ResourceManager.GetStream%2A> methods to retrieve object data. This includes primitive data types, serializable objects, and objects that are stored in binary format (such as images).  \n  \n The following example uses the <xref:System.Resources.ResourceManager.GetStream%28System.String%29> method to retrieve a bitmap that is used in an app's opening splash window. The following source code in a file named CreateResources.cs (for C#) or CreateResources.vb (for Visual Basic) generates a .resx file that contains the serialized image. In this case, the image is loaded from a file named SplashScreen.jpg; you can modify the file name to substitute your own image.  \n  \n [!code-csharp[Conceptual.Resources.Retrieving#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/createresources.cs#4)]\n [!code-vb[Conceptual.Resources.Retrieving#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/createresources.vb#4)]  \n  \n The following code retrieves the resource and displays the image in a <xref:System.Windows.Forms.PictureBox> control.  \n  \n [!code-csharp[Conceptual.Resources.Retrieving#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/getstream.cs#5)]\n [!code-vb[Conceptual.Resources.Retrieving#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/getstream.vb#5)]  \n  \n You can use the following batch file to build the C# example. For Visual Basic, change `csc` to `vbc`, and change the extension of the source code file from `.cs` to `.vb`.  \n  \n```  \n  \ncsc CreateResources.cs  \nCreateResources  \n  \nresgen AppResources.resx  \n  \ncsc GetStream.cs /resource:AppResources.resources  \n  \n```  \n  \n The following example uses the <xref:System.Resources.ResourceManager.GetObject%28System.String%29?displayProperty=fullName> method to deserialize a custom object. The example includes a source code file named UIElements.cs (UIElements.vb for Visual Basic) that defines the following structure named `PersonTable`. This structure is intended to be used by a general table display routine that displays the localized names of table columns. Note that the `PersonTable` structure is marked with the <xref:System.SerializableAttribute> attribute.  \n  \n [!code-csharp[Conceptual.Resources.Retrieving#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/example.cs#6)]\n [!code-vb[Conceptual.Resources.Retrieving#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/example.vb#6)]  \n  \n The following code from a file named CreateResources.cs (CreateResources.vb for Visual Basic) creates an XML resource file named UIResources.resx that stores a table title and a `PersonTable` object that contains information for an app that is localized for the English language.  \n  \n [!code-csharp[Conceptual.Resources.Retrieving#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/example1.cs#7)]\n [!code-vb[Conceptual.Resources.Retrieving#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/example.vb#7)]  \n  \n The following code in a source code file named GetObject.cs (GetObject.vb) then retrieves the resources and displays them to the console.  \n  \n [!code-csharp[Conceptual.Resources.Retrieving#8](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/example2.cs#8)]\n [!code-vb[Conceptual.Resources.Retrieving#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/example2.vb#8)]  \n  \n You can build the necessary resource file and assemblies and run the app by executing the following batch file. You must use the `/r` option to supply Resgen.exe with a reference to UIElements.dll so that it can access information about the `PersonTable` structure. If you're using C#, replace the `vbc` compiler name with `csc`, and replace the `.vb` extension with `.cs`.  \n  \n```  \n  \nvbc /t:library UIElements.vb  \nvbc CreateResources.vb /r:UIElements.dll  \nCreateResources  \n  \nresgen UIResources.resx  /r:UIElements.dll  \nvbc GetObject.vb /r:UIElements.dll /resource:UIResources.resources  \n  \nGetObject.exe  \n  \n```  \n  \n## Versioning Support for Satellite Assemblies  \n By default, when the <xref:System.Resources.ResourceManager> object retrieves requested resources, it looks for satellite assemblies that have version numbers that match the version number of the main assembly. After you have deployed an app, you might want to update the main assembly or specific resource satellite assemblies. The .NET Framework provides support for versioning the main assembly and satellite assemblies.  \n  \n The <xref:System.Resources.SatelliteContractVersionAttribute> attribute  provides versioning support for a main assembly. Specifying this attribute on an app's main assembly enables you to update and redeploy a main assembly without updating its satellite assemblies. After you update the main assembly, increment the main assembly's version number but leave the satellite contract version number unchanged. When the resource manager retrieves requested resources, it loads the satellite assembly version specified by this attribute.  \n  \n Publisher policy assemblies provide support for versioning satellite assemblies. You can update and redeploy a satellite assembly without updating the main assembly. After you update a satellite assembly, increment its version number and ship it with a publisher policy assembly. In the publisher policy assembly, specify that your new satellite assembly is backward-compatible with its previous version. The resource manager will use the <xref:System.Resources.SatelliteContractVersionAttribute> attribute to determine the version of the satellite assembly, but the assembly loader will bind to the satellite assembly version specified by the publisher policy. For more information about publisher policy assemblies, see [Creating a Publisher Policy File](../../../docs/framework/configure-apps/how-to-create-a-publisher-policy.md).  \n  \n To enable full assembly versioning support, we recommend that you deploy strong-named assemblies in the [global assembly cache](../../../docs/framework/app-domains/gac.md) and deploy assemblies that don't have strong names in the application directory. If you want to deploy strong-named assemblies in the application directory, you will not be able to increment a satellite assembly's version number when you update the assembly. Instead, you must perform an in-place update where you replace the existing code with the updated code and maintain the same version number. For example, if you want to update version 1.0.0.0 of a satellite assembly with the fully specified assembly name \"myApp.resources, Version=1.0.0.0, Culture=de, PublicKeyToken=b03f5f11d50a3a\", overwrite it with the updated myApp.resources.dll that has been compiled with the same, fully specified assembly name \"myApp.resources, Version=1.0.0.0, Culture=de, PublicKeyToken=b03f5f11d50a3a\". Note that using in-place updates on satellite assembly files makes it difficult for an app to accurately determine the version of a satellite assembly.  \n  \n For more information about assembly versioning, see [Assembly Versioning](../../../docs/framework/app-domains/assembly-versioning.md) and [How the Runtime Locates Assemblies](../../../docs/framework/deployment/how-the-runtime-locates-assemblies.md).  \n  \n<a name=\"from_file\"></a>   \n## Retrieving Resources from .resources Files  \n If you choose not to deploy resources in satellite assemblies, you can still use a <xref:System.Resources.ResourceManager> object to access resources from .resources files directly. To do this, you must deploy the .resources files correctly. Then you use the <xref:System.Resources.ResourceManager.CreateFileBasedResourceManager%2A?displayProperty=fullName> method to instantiate a <xref:System.Resources.ResourceManager> object and specify the directory that contains the standalone .resources files.  \n  \n### Deploying .resources Files  \n When you embed .resources files in an application assembly and satellite assemblies, each satellite assembly has the same file name, but is placed in a subdirectory that reflects the satellite assembly's culture. In contrast, when you access resources from .resources files directly, you can place all the .resources files in a single directory, usually a subdirectory of the application directory. The name of the app's default .resources file consists of a root name only, with no indication of its culture (for example, strings.resources). The resources for each localized culture are stored in a file whose name consists of the root name followed by the culture (for example, strings.ja.resources or strings.de-DE.resources). The following illustration shows where resource files should be located in the directory structure.  \n  \n ![Main directory for your application](../../../docs/framework/resources/media/resappdir.gif \"resappdir\")  \nDirectory structure and naming conventions for .resources files  \n  \n### Using the Resource Manager  \n After you have created your resources and placed them in the appropriate directory, you create a <xref:System.Resources.ResourceManager> object to use the resources by calling the <xref:System.Resources.ResourceManager.CreateFileBasedResourceManager%28System.String%2CSystem.String%2CSystem.Type%29> method. The first parameter specifies the root name of the app's default .resources file (this would be \"strings\" for the example in the previous section). The second parameter specifies the location of the resources (\"Resources\" for the previous example). The third parameter specifies the <xref:System.Resources.ResourceSet> implementation to use. If the third parameter is `null`, the default runtime <xref:System.Resources.ResourceSet> is used.  \n  \n> [!NOTE]\n>  Do not deploy ASP.NET apps using standalone .resources files. This can cause locking issues and breaks XCOPY deployment. We recommend that you deploy ASP.NET resources in satellite assemblies. For more information, see [ASP.NET Web Page Resources Overview](http://msdn.microsoft.com/library/0936b3b2-9e6e-4abe-9c06-364efef9dbbd).  \n  \n After you instantiate the <xref:System.Resources.ResourceManager> object, you use the <xref:System.Resources.ResourceManager.GetString%2A>, <xref:System.Resources.ResourceManager.GetObject%2A>, and <xref:System.Resources.ResourceManager.GetStream%2A> methods as discussed earlier to retrieve the resources. However, the retrieval of resources directly from .resources files differs from the retrieval of embedded resources from assemblies. When you retrieve resources from .resources files, the <xref:System.Resources.ResourceManager.GetString%28System.String%29>, <xref:System.Resources.ResourceManager.GetObject%28System.String%29>, and <xref:System.Resources.ResourceManager.GetStream%28System.String%29> methods always retrieve the default culture's resources regardless of the current culture. To retrieve the resources of the either the app's current culture or a specific culture, you must call the <xref:System.Resources.ResourceManager.GetString%28System.String%2CSystem.Globalization.CultureInfo%29>, <xref:System.Resources.ResourceManager.GetObject%28System.String%2CSystem.Globalization.CultureInfo%29>, or <xref:System.Resources.ResourceManager.GetStream%28System.String%2CSystem.Globalization.CultureInfo%29> method and specify the culture whose resources are to be retrieved. To retrieve the resources of the current culture, specify the value of the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> property as the `culture` argument. If the resource manager cannot retrieve the resources of `culture`, it uses the standard resource fallback rules to retrieve the appropriate resources.  \n  \n### An Example  \n The following example illustrates how the resource manager retrieves resources directly from .resources files. The example consists of three text-based resource files for the English (United States), French (France), and Russian (Russia) cultures. English (United States) is the example's default culture. Its resources are stored in the following file named Strings.txt:  \n  \n```  \nGreeting=Hello  \nPrompt=What is your name?  \n```  \n  \n Resources for the French (France) culture are stored in the following file, which is named Strings.fr-FR.txt:  \n  \n```  \nGreeting=Bon jour  \nPrompt=Comment vous appelez-vous?  \n```  \n  \n Resources for the Russian (Russia) culture are stored in the following file, which is named Strings.ru-RU.txt:  \n  \n```  \nGreeting=Здравствуйте  \nPrompt=Как вас зовут?  \n```  \n  \n The following is the source code for the example. The example instantiates <xref:System.Globalization.CultureInfo> objects for the English (United States), English (Canada), French (France), and Russian (Russia) cultures, and makes each the current culture. The <xref:System.Resources.ResourceManager.GetString%28System.String%2CSystem.Globalization.CultureInfo%29?displayProperty=fullName> method then supplies the value of the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> property as the `culture` argument to retrieve the appropriate culture-specific resources.  \n  \n [!code-csharp[Conceptual.Resources.Retrieving#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/example3.cs#9)]\n [!code-vb[Conceptual.Resources.Retrieving#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/example3.vb#9)]  \n  \n You can compile the C# version of the example by running the following batch file. If you're using Visual Basic, replace `csc` with `vbc`, and replace the `.cs` extension with `.vb`.  \n  \n```  \n  \nMd Resources  \nResgen Strings.txt Resources\\Strings.resources  \nResgen Strings.fr-FR.txt Resources\\Strings.fr-FR.resources  \nResgen Strings.ru-RU.txt Resources\\Strings.ru-RU.resources  \n  \ncsc Example.cs  \n  \n```  \n  \n## See Also  \n <xref:System.Resources.ResourceManager>   \n [Resources in Desktop Apps](../../../docs/framework/resources/index.md)   \n [Packaging and Deploying Resources](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md)   \n [How the Runtime Locates Assemblies](../../../docs/framework/deployment/how-the-runtime-locates-assemblies.md)   \n [Creating and retrieving resources in Windows Store apps](http://go.microsoft.com/fwlink/p/?LinkID=241674)","nodes":[{"pos":[12,65],"content":"Retrieving Resources in Desktop Apps | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Retrieving Resources in Desktop Apps | Microsoft Docs","pos":[0,53]}]},{"pos":[819,855],"content":"Retrieving Resources in Desktop Apps","linkify":"Retrieving Resources in Desktop Apps","nodes":[{"content":"Retrieving Resources in Desktop Apps","pos":[0,36]}]},{"content":"When you work with localized resources in .NET Framework desktop apps, you should ideally package the resources for the default or neutral culture with the main assembly and create a separate satellite assembly for each language or culture that your app supports.","pos":[856,1119]},{"content":"You can then use the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager&gt;</ph> class as described in the next section to access named resources.","pos":[1120,1246],"source":" You can then use the <xref:System.Resources.ResourceManager> class as described in the next section to access named resources."},{"content":"If you choose not to embed your resources in the main assembly and satellite assemblies, you can also access binary .resources files directly, as discussed in the section <bpt id=\"p1\">[</bpt>Retrieving Resources from .resources files<ept id=\"p1\">](#from_file)</ept> later in this article.","pos":[1247,1497],"source":" If you choose not to embed your resources in the main assembly and satellite assemblies, you can also access binary .resources files directly, as discussed in the section [Retrieving Resources from .resources files](#from_file) later in this article."},{"content":"To retrieve resources in <ph id=\"ph1\">[!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)]</ph> apps, see <bpt id=\"p1\">[</bpt>Creating and retrieving resources in Windows Store apps<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkID=241674)</ept> in the Windows Dev Center.","pos":[1499,1740],"source":"  To retrieve resources in [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] apps, see [Creating and retrieving resources in Windows Store apps](http://go.microsoft.com/fwlink/p/?LinkID=241674) in the Windows Dev Center."},{"pos":[1781,1817],"content":"Retrieving Resources from Assemblies","linkify":"Retrieving Resources from Assemblies","nodes":[{"content":"Retrieving Resources from Assemblies","pos":[0,36]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager&gt;</ph> class provides access to resources at run time.","pos":[1821,1912],"source":"The <xref:System.Resources.ResourceManager> class provides access to resources at run time."},{"content":"You use the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager.GetString%2A?displayProperty=fullName&gt;</ph> method to retrieve string resources and the <ph id=\"ph2\">&lt;xref:System.Resources.ResourceManager.GetObject%2A?displayProperty=fullName&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Resources.ResourceManager.GetStream%2A?displayProperty=fullName&gt;</ph> method to retrieve non-string resources.","pos":[1913,2246],"source":" You use the <xref:System.Resources.ResourceManager.GetString%2A?displayProperty=fullName> method to retrieve string resources and the <xref:System.Resources.ResourceManager.GetObject%2A?displayProperty=fullName> or <xref:System.Resources.ResourceManager.GetStream%2A?displayProperty=fullName> method to retrieve non-string resources."},{"content":"Each method has two overloads:","pos":[2247,2277]},{"content":"An overload whose single parameter is a string that contains the name of the resource.","pos":[2287,2373]},{"content":"The method attempts to retrieve that resource for the current thread culture.","pos":[2374,2451]},{"content":"For more information, see the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager.GetString%28System.String%29&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Resources.ResourceManager.GetObject%28System.String%29&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Resources.ResourceManager.GetStream%28System.String%29&gt;</ph> methods.","pos":[2452,2703],"source":" For more information, see the <xref:System.Resources.ResourceManager.GetString%28System.String%29>, <xref:System.Resources.ResourceManager.GetObject%28System.String%29>, and <xref:System.Resources.ResourceManager.GetStream%28System.String%29> methods."},{"content":"An overload that has two parameters: a string containing the name of the resource, and a <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo&gt;</ph> object that represents the culture whose resource is to be retrieved.","pos":[2713,2911],"source":"An overload that has two parameters: a string containing the name of the resource, and a <xref:System.Globalization.CultureInfo> object that represents the culture whose resource is to be retrieved."},{"content":"If a resource set for that culture cannot be found, the resource manager uses fallback rules to retrieve an appropriate resource.","pos":[2912,3041]},{"content":"For more information, see the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager.GetString%28System.String%2CSystem.Globalization.CultureInfo%29&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Resources.ResourceManager.GetObject%28System.String%2CSystem.Globalization.CultureInfo%29&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Resources.ResourceManager.GetStream%28System.String%2CSystem.Globalization.CultureInfo%29&gt;</ph> methods.","pos":[3042,3398],"source":" For more information, see the <xref:System.Resources.ResourceManager.GetString%28System.String%2CSystem.Globalization.CultureInfo%29>, <xref:System.Resources.ResourceManager.GetObject%28System.String%2CSystem.Globalization.CultureInfo%29>, and <xref:System.Resources.ResourceManager.GetStream%28System.String%2CSystem.Globalization.CultureInfo%29> methods."},{"content":"The resource manager uses the resource fallback process to control how the app retrieves culture-specific resources.","pos":[3405,3521]},{"content":"For more information, see the \"Resource Fallback Process\" section in <bpt id=\"p1\">[</bpt>Packaging and Deploying Resources<ept id=\"p1\">](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md)</ept>.","pos":[3522,3715],"source":" For more information, see the \"Resource Fallback Process\" section in [Packaging and Deploying Resources](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md)."},{"content":"For information about instantiating a <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager&gt;</ph> object, see the \"Instantiating a ResourceManager Object\" section in the <ph id=\"ph2\">&lt;xref:System.Resources.ResourceManager&gt;</ph> class topic.","pos":[3716,3918],"source":" For information about instantiating a <xref:System.Resources.ResourceManager> object, see the \"Instantiating a ResourceManager Object\" section in the <xref:System.Resources.ResourceManager> class topic."},{"pos":[3928,3962],"content":"Retrieving String Data: An Example","linkify":"Retrieving String Data: An Example","nodes":[{"content":"Retrieving String Data: An Example","pos":[0,34]}]},{"content":"The following example calls the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager.GetString%28System.String%29&gt;</ph> method to retrieve the string resources of the current UI culture.","pos":[3966,4133],"source":"The following example calls the <xref:System.Resources.ResourceManager.GetString%28System.String%29> method to retrieve the string resources of the current UI culture."},{"content":"It includes a neutral string resource for the English (United States) culture and localized resources for the French (France) and Russian (Russia) cultures.","pos":[4134,4290]},{"content":"The following English (United States) resource is in a file named Strings.txt:","pos":[4291,4369]},{"content":"The French (France) resource is in a file named Strings.fr-FR.txt:","pos":[4424,4490]},{"content":"The Russian (Russia) resource is in a file named Strings.ru-RU-txt:","pos":[4546,4613]},{"content":"The source code for this example, which is in a file named GetString.cs for the C# version of the code and GetString.vb for the Visual Basic version, defines a string array that contains the name of four cultures: the three cultures for which resources are available and the Spanish (Spain) culture.","pos":[4664,4963]},{"content":"A loop that executes five times randomly selects one of these cultures and assigns it to the <ph id=\"ph1\">&lt;xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=fullName&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName&gt;</ph> properties.","pos":[4964,5231],"source":" A loop that executes five times randomly selects one of these cultures and assigns it to the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> properties."},{"content":"It then calls the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager.GetString%28System.String%29&gt;</ph> method to retrieve the localized string, which it displays along with the time of day.","pos":[5232,5405],"source":" It then calls the <xref:System.Resources.ResourceManager.GetString%28System.String%29> method to retrieve the localized string, which it displays along with the time of day."},{"pos":[5412,5713],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>Conceptual.Resources.Retrieving#3<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/getstring.cs#3)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>Conceptual.Resources.Retrieving#3<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/getstring.vb#3)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[Conceptual.Resources.Retrieving#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/getstring.cs#3)]\n [!code-vb[Conceptual.Resources.Retrieving#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/getstring.vb#3)]"},{"content":"The following batch (.bat) file compiles the example and generates satellite assemblies in the appropriate directories.","pos":[5720,5839]},{"content":"The commands are provided for the C# language and compiler.","pos":[5840,5899]},{"content":"For Visual Basic, change <ph id=\"ph1\">`csc`</ph> to <ph id=\"ph2\">`vbc`</ph>, and change <ph id=\"ph3\">`GetString.cs`</ph> to <ph id=\"ph4\">`GetString.vb`</ph>.","pos":[5900,5985],"source":" For Visual Basic, change `csc` to `vbc`, and change `GetString.cs` to `GetString.vb`."},{"content":"When the current UI culture is Spanish (Spain), note that the example displays English language resources, because Spanish language resources are unavailable, and English is the example's default culture.","pos":[6335,6539]},{"pos":[6549,6585],"content":"Retrieving Object Data: Two Examples","linkify":"Retrieving Object Data: Two Examples","nodes":[{"content":"Retrieving Object Data: Two Examples","pos":[0,36]}]},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager.GetObject%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Resources.ResourceManager.GetStream%2A&gt;</ph> methods to retrieve object data.","pos":[6589,6747],"source":"You can use the <xref:System.Resources.ResourceManager.GetObject%2A> and <xref:System.Resources.ResourceManager.GetStream%2A> methods to retrieve object data."},{"content":"This includes primitive data types, serializable objects, and objects that are stored in binary format (such as images).","pos":[6748,6868]},{"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager.GetStream%28System.String%29&gt;</ph> method to retrieve a bitmap that is used in an app's opening splash window.","pos":[6875,7050],"source":"The following example uses the <xref:System.Resources.ResourceManager.GetStream%28System.String%29> method to retrieve a bitmap that is used in an app's opening splash window."},{"content":"The following source code in a file named CreateResources.cs (for C#) or CreateResources.vb (for Visual Basic) generates a .resx file that contains the serialized image.","pos":[7051,7220]},{"content":"In this case, the image is loaded from a file named SplashScreen.jpg; you can modify the file name to substitute your own image.","pos":[7221,7349]},{"pos":[7356,7669],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>Conceptual.Resources.Retrieving#4<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/createresources.cs#4)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>Conceptual.Resources.Retrieving#4<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/createresources.vb#4)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[Conceptual.Resources.Retrieving#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/createresources.cs#4)]\n [!code-vb[Conceptual.Resources.Retrieving#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/createresources.vb#4)]"},{"content":"The following code retrieves the resource and displays the image in a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.PictureBox&gt;</ph> control.","pos":[7676,7793],"source":"The following code retrieves the resource and displays the image in a <xref:System.Windows.Forms.PictureBox> control."},{"pos":[7800,8101],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>Conceptual.Resources.Retrieving#5<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/getstream.cs#5)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>Conceptual.Resources.Retrieving#5<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/getstream.vb#5)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[Conceptual.Resources.Retrieving#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/getstream.cs#5)]\n [!code-vb[Conceptual.Resources.Retrieving#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/getstream.vb#5)]"},{"content":"You can use the following batch file to build the C# example.","pos":[8108,8169]},{"content":"For Visual Basic, change <ph id=\"ph1\">`csc`</ph> to <ph id=\"ph2\">`vbc`</ph>, and change the extension of the source code file from <ph id=\"ph3\">`.cs`</ph> to <ph id=\"ph4\">`.vb`</ph>.","pos":[8170,8280],"source":" For Visual Basic, change `csc` to `vbc`, and change the extension of the source code file from `.cs` to `.vb`."},{"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager.GetObject%28System.String%29?displayProperty=fullName&gt;</ph> method to deserialize a custom object.","pos":[8436,8599],"source":"The following example uses the <xref:System.Resources.ResourceManager.GetObject%28System.String%29?displayProperty=fullName> method to deserialize a custom object."},{"content":"The example includes a source code file named UIElements.cs (UIElements.vb for Visual Basic) that defines the following structure named <ph id=\"ph1\">`PersonTable`</ph>.","pos":[8600,8750],"source":" The example includes a source code file named UIElements.cs (UIElements.vb for Visual Basic) that defines the following structure named `PersonTable`."},{"content":"This structure is intended to be used by a general table display routine that displays the localized names of table columns.","pos":[8751,8875]},{"content":"Note that the <ph id=\"ph1\">`PersonTable`</ph> structure is marked with the <ph id=\"ph2\">&lt;xref:System.SerializableAttribute&gt;</ph> attribute.","pos":[8876,8979],"source":" Note that the `PersonTable` structure is marked with the <xref:System.SerializableAttribute> attribute."},{"pos":[8986,9283],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>Conceptual.Resources.Retrieving#6<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/example.cs#6)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>Conceptual.Resources.Retrieving#6<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/example.vb#6)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[Conceptual.Resources.Retrieving#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/example.cs#6)]\n [!code-vb[Conceptual.Resources.Retrieving#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/example.vb#6)]"},{"pos":[9290,9569],"content":"The following code from a file named CreateResources.cs (CreateResources.vb for Visual Basic) creates an XML resource file named UIResources.resx that stores a table title and a <ph id=\"ph1\">`PersonTable`</ph> object that contains information for an app that is localized for the English language.","source":"The following code from a file named CreateResources.cs (CreateResources.vb for Visual Basic) creates an XML resource file named UIResources.resx that stores a table title and a `PersonTable` object that contains information for an app that is localized for the English language."},{"pos":[9576,9874],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>Conceptual.Resources.Retrieving#7<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/example1.cs#7)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>Conceptual.Resources.Retrieving#7<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/example.vb#7)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[Conceptual.Resources.Retrieving#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/example1.cs#7)]\n [!code-vb[Conceptual.Resources.Retrieving#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/example.vb#7)]"},{"content":"The following code in a source code file named GetObject.cs (GetObject.vb) then retrieves the resources and displays them to the console.","pos":[9881,10018]},{"pos":[10025,10324],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>Conceptual.Resources.Retrieving#8<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/example2.cs#8)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>Conceptual.Resources.Retrieving#8<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/example2.vb#8)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[Conceptual.Resources.Retrieving#8](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/example2.cs#8)]\n [!code-vb[Conceptual.Resources.Retrieving#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/example2.vb#8)]"},{"content":"You can build the necessary resource file and assemblies and run the app by executing the following batch file.","pos":[10331,10442]},{"content":"You must use the <ph id=\"ph1\">`/r`</ph> option to supply Resgen.exe with a reference to UIElements.dll so that it can access information about the <ph id=\"ph2\">`PersonTable`</ph> structure.","pos":[10443,10596],"source":" You must use the `/r` option to supply Resgen.exe with a reference to UIElements.dll so that it can access information about the `PersonTable` structure."},{"content":"If you're using C#, replace the <ph id=\"ph1\">`vbc`</ph> compiler name with <ph id=\"ph2\">`csc`</ph>, and replace the <ph id=\"ph3\">`.vb`</ph> extension with <ph id=\"ph4\">`.cs`</ph>.","pos":[10597,10704],"source":" If you're using C#, replace the `vbc` compiler name with `csc`, and replace the `.vb` extension with `.cs`."},{"pos":[10962,11005],"content":"Versioning Support for Satellite Assemblies","linkify":"Versioning Support for Satellite Assemblies","nodes":[{"content":"Versioning Support for Satellite Assemblies","pos":[0,43]}]},{"content":"By default, when the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager&gt;</ph> object retrieves requested resources, it looks for satellite assemblies that have version numbers that match the version number of the main assembly.","pos":[11009,11219],"source":"By default, when the <xref:System.Resources.ResourceManager> object retrieves requested resources, it looks for satellite assemblies that have version numbers that match the version number of the main assembly."},{"content":"After you have deployed an app, you might want to update the main assembly or specific resource satellite assemblies.","pos":[11220,11337]},{"content":"The .NET Framework provides support for versioning the main assembly and satellite assemblies.","pos":[11338,11432]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Resources.SatelliteContractVersionAttribute&gt;</ph> attribute  provides versioning support for a main assembly.","pos":[11439,11560],"source":"The <xref:System.Resources.SatelliteContractVersionAttribute> attribute  provides versioning support for a main assembly."},{"content":"Specifying this attribute on an app's main assembly enables you to update and redeploy a main assembly without updating its satellite assemblies.","pos":[11561,11706]},{"content":"After you update the main assembly, increment the main assembly's version number but leave the satellite contract version number unchanged.","pos":[11707,11846]},{"content":"When the resource manager retrieves requested resources, it loads the satellite assembly version specified by this attribute.","pos":[11847,11972]},{"content":"Publisher policy assemblies provide support for versioning satellite assemblies.","pos":[11979,12059]},{"content":"You can update and redeploy a satellite assembly without updating the main assembly.","pos":[12060,12144]},{"content":"After you update a satellite assembly, increment its version number and ship it with a publisher policy assembly.","pos":[12145,12258]},{"content":"In the publisher policy assembly, specify that your new satellite assembly is backward-compatible with its previous version.","pos":[12259,12383]},{"content":"The resource manager will use the <ph id=\"ph1\">&lt;xref:System.Resources.SatelliteContractVersionAttribute&gt;</ph> attribute to determine the version of the satellite assembly, but the assembly loader will bind to the satellite assembly version specified by the publisher policy.","pos":[12384,12640],"source":" The resource manager will use the <xref:System.Resources.SatelliteContractVersionAttribute> attribute to determine the version of the satellite assembly, but the assembly loader will bind to the satellite assembly version specified by the publisher policy."},{"content":"For more information about publisher policy assemblies, see <bpt id=\"p1\">[</bpt>Creating a Publisher Policy File<ept id=\"p1\">](../../../docs/framework/configure-apps/how-to-create-a-publisher-policy.md)</ept>.","pos":[12641,12812],"source":" For more information about publisher policy assemblies, see [Creating a Publisher Policy File](../../../docs/framework/configure-apps/how-to-create-a-publisher-policy.md)."},{"content":"To enable full assembly versioning support, we recommend that you deploy strong-named assemblies in the <bpt id=\"p1\">[</bpt>global assembly cache<ept id=\"p1\">](../../../docs/framework/app-domains/gac.md)</ept> and deploy assemblies that don't have strong names in the application directory.","pos":[12819,13071],"source":"To enable full assembly versioning support, we recommend that you deploy strong-named assemblies in the [global assembly cache](../../../docs/framework/app-domains/gac.md) and deploy assemblies that don't have strong names in the application directory."},{"content":"If you want to deploy strong-named assemblies in the application directory, you will not be able to increment a satellite assembly's version number when you update the assembly.","pos":[13072,13249]},{"content":"Instead, you must perform an in-place update where you replace the existing code with the updated code and maintain the same version number.","pos":[13250,13390]},{"content":"For example, if you want to update version 1.0.0.0 of a satellite assembly with the fully specified assembly name \"myApp.resources, Version=1.0.0.0, Culture=de, PublicKeyToken=b03f5f11d50a3a\", overwrite it with the updated myApp.resources.dll that has been compiled with the same, fully specified assembly name \"myApp.resources, Version=1.0.0.0, Culture=de, PublicKeyToken=b03f5f11d50a3a\".","pos":[13391,13780]},{"content":"Note that using in-place updates on satellite assembly files makes it difficult for an app to accurately determine the version of a satellite assembly.","pos":[13781,13932]},{"pos":[13939,14188],"content":"For more information about assembly versioning, see <bpt id=\"p1\">[</bpt>Assembly Versioning<ept id=\"p1\">](../../../docs/framework/app-domains/assembly-versioning.md)</ept> and <bpt id=\"p2\">[</bpt>How the Runtime Locates Assemblies<ept id=\"p2\">](../../../docs/framework/deployment/how-the-runtime-locates-assemblies.md)</ept>.","source":"For more information about assembly versioning, see [Assembly Versioning](../../../docs/framework/app-domains/assembly-versioning.md) and [How the Runtime Locates Assemblies](../../../docs/framework/deployment/how-the-runtime-locates-assemblies.md)."},{"pos":[14225,14267],"content":"Retrieving Resources from .resources Files","linkify":"Retrieving Resources from .resources Files","nodes":[{"content":"Retrieving Resources from .resources Files","pos":[0,42]}]},{"content":"If you choose not to deploy resources in satellite assemblies, you can still use a <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager&gt;</ph> object to access resources from .resources files directly.","pos":[14271,14452],"source":"If you choose not to deploy resources in satellite assemblies, you can still use a <xref:System.Resources.ResourceManager> object to access resources from .resources files directly."},{"content":"To do this, you must deploy the .resources files correctly.","pos":[14453,14512]},{"content":"Then you use the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager.CreateFileBasedResourceManager%2A?displayProperty=fullName&gt;</ph> method to instantiate a <ph id=\"ph2\">&lt;xref:System.Resources.ResourceManager&gt;</ph> object and specify the directory that contains the standalone .resources files.","pos":[14513,14772],"source":" Then you use the <xref:System.Resources.ResourceManager.CreateFileBasedResourceManager%2A?displayProperty=fullName> method to instantiate a <xref:System.Resources.ResourceManager> object and specify the directory that contains the standalone .resources files."},{"pos":[14782,14808],"content":"Deploying .resources Files","linkify":"Deploying .resources Files","nodes":[{"content":"Deploying .resources Files","pos":[0,26]}]},{"content":"When you embed .resources files in an application assembly and satellite assemblies, each satellite assembly has the same file name, but is placed in a subdirectory that reflects the satellite assembly's culture.","pos":[14812,15024]},{"content":"In contrast, when you access resources from .resources files directly, you can place all the .resources files in a single directory, usually a subdirectory of the application directory.","pos":[15025,15210]},{"content":"The name of the app's default .resources file consists of a root name only, with no indication of its culture (for example, strings.resources).","pos":[15211,15354]},{"content":"The resources for each localized culture are stored in a file whose name consists of the root name followed by the culture (for example, strings.ja.resources or strings.de-DE.resources).","pos":[15355,15541]},{"content":"The following illustration shows where resource files should be located in the directory structure.","pos":[15542,15641]},{"content":"<bpt id=\"p1\">![</bpt>Main directory for your application<ept id=\"p1\">](../../../docs/framework/resources/media/resappdir.gif \"resappdir\")</ept>","pos":[15648,15753],"source":"![Main directory for your application](../../../docs/framework/resources/media/resappdir.gif \"resappdir\")"},{"content":"Directory structure and naming conventions for .resources files","pos":[15756,15819]},{"pos":[15829,15855],"content":"Using the Resource Manager","linkify":"Using the Resource Manager","nodes":[{"content":"Using the Resource Manager","pos":[0,26]}]},{"content":"After you have created your resources and placed them in the appropriate directory, you create a <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager&gt;</ph> object to use the resources by calling the <ph id=\"ph2\">&lt;xref:System.Resources.ResourceManager.CreateFileBasedResourceManager%28System.String%2CSystem.String%2CSystem.Type%29&gt;</ph> method.","pos":[15859,16166],"source":"After you have created your resources and placed them in the appropriate directory, you create a <xref:System.Resources.ResourceManager> object to use the resources by calling the <xref:System.Resources.ResourceManager.CreateFileBasedResourceManager%28System.String%2CSystem.String%2CSystem.Type%29> method."},{"content":"The first parameter specifies the root name of the app's default .resources file (this would be \"strings\" for the example in the previous section).","pos":[16167,16314]},{"content":"The second parameter specifies the location of the resources (\"Resources\" for the previous example).","pos":[16315,16415]},{"content":"The third parameter specifies the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceSet&gt;</ph> implementation to use.","pos":[16416,16508],"source":" The third parameter specifies the <xref:System.Resources.ResourceSet> implementation to use."},{"content":"If the third parameter is <ph id=\"ph1\">`null`</ph>, the default runtime <ph id=\"ph2\">&lt;xref:System.Resources.ResourceSet&gt;</ph> is used.","pos":[16509,16607],"source":" If the third parameter is `null`, the default runtime <xref:System.Resources.ResourceSet> is used."},{"pos":[16615,16955],"content":"[!NOTE]\n Do not deploy ASP.NET apps using standalone .resources files. This can cause locking issues and breaks XCOPY deployment. We recommend that you deploy ASP.NET resources in satellite assemblies. For more information, see [ASP.NET Web Page Resources Overview](http://msdn.microsoft.com/library/0936b3b2-9e6e-4abe-9c06-364efef9dbbd).","leadings":["","> "],"nodes":[{"content":" Do not deploy ASP.NET apps using standalone .resources files. This can cause locking issues and breaks XCOPY deployment. We recommend that you deploy ASP.NET resources in satellite assemblies. For more information, see [ASP.NET Web Page Resources Overview](http://msdn.microsoft.com/library/0936b3b2-9e6e-4abe-9c06-364efef9dbbd).","pos":[8,338],"nodes":[{"content":"Do not deploy ASP.NET apps using standalone .resources files.","pos":[1,62]},{"content":"This can cause locking issues and breaks XCOPY deployment.","pos":[63,121]},{"content":"We recommend that you deploy ASP.NET resources in satellite assemblies.","pos":[122,193]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>ASP.NET Web Page Resources Overview<ept id=\"p1\">](http://msdn.microsoft.com/library/0936b3b2-9e6e-4abe-9c06-364efef9dbbd)</ept>.","pos":[194,330],"source":" For more information, see [ASP.NET Web Page Resources Overview](http://msdn.microsoft.com/library/0936b3b2-9e6e-4abe-9c06-364efef9dbbd)."}]}]},{"content":"After you instantiate the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager&gt;</ph> object, you use the <ph id=\"ph2\">&lt;xref:System.Resources.ResourceManager.GetString%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Resources.ResourceManager.GetObject%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Resources.ResourceManager.GetStream%2A&gt;</ph> methods as discussed earlier to retrieve the resources.","pos":[16962,17268],"source":"After you instantiate the <xref:System.Resources.ResourceManager> object, you use the <xref:System.Resources.ResourceManager.GetString%2A>, <xref:System.Resources.ResourceManager.GetObject%2A>, and <xref:System.Resources.ResourceManager.GetStream%2A> methods as discussed earlier to retrieve the resources."},{"content":"However, the retrieval of resources directly from .resources files differs from the retrieval of embedded resources from assemblies.","pos":[17269,17401]},{"content":"When you retrieve resources from .resources files, the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager.GetString%28System.String%29&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Resources.ResourceManager.GetObject%28System.String%29&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Resources.ResourceManager.GetStream%28System.String%29&gt;</ph> methods always retrieve the default culture's resources regardless of the current culture.","pos":[17402,17760],"source":" When you retrieve resources from .resources files, the <xref:System.Resources.ResourceManager.GetString%28System.String%29>, <xref:System.Resources.ResourceManager.GetObject%28System.String%29>, and <xref:System.Resources.ResourceManager.GetStream%28System.String%29> methods always retrieve the default culture's resources regardless of the current culture."},{"content":"To retrieve the resources of the either the app's current culture or a specific culture, you must call the <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager.GetString%28System.String%2CSystem.Globalization.CultureInfo%29&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Resources.ResourceManager.GetObject%28System.String%2CSystem.Globalization.CultureInfo%29&gt;</ph>, or <ph id=\"ph3\">&lt;xref:System.Resources.ResourceManager.GetStream%28System.String%2CSystem.Globalization.CultureInfo%29&gt;</ph> method and specify the culture whose resources are to be retrieved.","pos":[17761,18252],"source":" To retrieve the resources of the either the app's current culture or a specific culture, you must call the <xref:System.Resources.ResourceManager.GetString%28System.String%2CSystem.Globalization.CultureInfo%29>, <xref:System.Resources.ResourceManager.GetObject%28System.String%2CSystem.Globalization.CultureInfo%29>, or <xref:System.Resources.ResourceManager.GetStream%28System.String%2CSystem.Globalization.CultureInfo%29> method and specify the culture whose resources are to be retrieved."},{"content":"To retrieve the resources of the current culture, specify the value of the <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName&gt;</ph> property as the <ph id=\"ph2\">`culture`</ph> argument.","pos":[18253,18446],"source":" To retrieve the resources of the current culture, specify the value of the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> property as the `culture` argument."},{"content":"If the resource manager cannot retrieve the resources of <ph id=\"ph1\">`culture`</ph>, it uses the standard resource fallback rules to retrieve the appropriate resources.","pos":[18447,18598],"source":" If the resource manager cannot retrieve the resources of `culture`, it uses the standard resource fallback rules to retrieve the appropriate resources."},{"pos":[18608,18618],"content":"An Example","linkify":"An Example","nodes":[{"content":"An Example","pos":[0,10]}]},{"content":"The following example illustrates how the resource manager retrieves resources directly from .resources files.","pos":[18622,18732]},{"content":"The example consists of three text-based resource files for the English (United States), French (France), and Russian (Russia) cultures.","pos":[18733,18869]},{"content":"English (United States) is the example's default culture.","pos":[18870,18927]},{"content":"Its resources are stored in the following file named Strings.txt:","pos":[18928,18993]},{"content":"Resources for the French (France) culture are stored in the following file, which is named Strings.fr-FR.txt:","pos":[19060,19169]},{"content":"Resources for the Russian (Russia) culture are stored in the following file, which is named Strings.ru-RU.txt:","pos":[19247,19357]},{"content":"The following is the source code for the example.","pos":[19427,19476]},{"content":"The example instantiates <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo&gt;</ph> objects for the English (United States), English (Canada), French (France), and Russian (Russia) cultures, and makes each the current culture.","pos":[19477,19684],"source":" The example instantiates <xref:System.Globalization.CultureInfo> objects for the English (United States), English (Canada), French (France), and Russian (Russia) cultures, and makes each the current culture."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager.GetString%28System.String%2CSystem.Globalization.CultureInfo%29?displayProperty=fullName&gt;</ph> method then supplies the value of the <ph id=\"ph2\">&lt;xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName&gt;</ph> property as the <ph id=\"ph3\">`culture`</ph> argument to retrieve the appropriate culture-specific resources.","pos":[19685,20029],"source":" The <xref:System.Resources.ResourceManager.GetString%28System.String%2CSystem.Globalization.CultureInfo%29?displayProperty=fullName> method then supplies the value of the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> property as the `culture` argument to retrieve the appropriate culture-specific resources."},{"pos":[20036,20335],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>Conceptual.Resources.Retrieving#9<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/example3.cs#9)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>Conceptual.Resources.Retrieving#9<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/example3.vb#9)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[Conceptual.Resources.Retrieving#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.retrieving/cs/example3.cs#9)]\n [!code-vb[Conceptual.Resources.Retrieving#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.retrieving/vb/example3.vb#9)]"},{"content":"You can compile the C# version of the example by running the following batch file.","pos":[20342,20424]},{"content":"If you're using Visual Basic, replace <ph id=\"ph1\">`csc`</ph> with <ph id=\"ph2\">`vbc`</ph>, and replace the <ph id=\"ph3\">`.cs`</ph> extension with <ph id=\"ph4\">`.vb`</ph>.","pos":[20425,20524],"source":" If you're using Visual Basic, replace `csc` with `vbc`, and replace the `.cs` extension with `.vb`."},{"pos":[20760,20768],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Resources.ResourceManager&gt;</ph>","pos":[20772,20811],"source":"<xref:System.Resources.ResourceManager> "},{"content":"<bpt id=\"p1\"> [</bpt>Resources in Desktop Apps<ept id=\"p1\">](../../../docs/framework/resources/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[20815,20888],"source":" [Resources in Desktop Apps](../../../docs/framework/resources/index.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Packaging and Deploying Resources<ept id=\"p1\">](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md)</ept><ph id=\"ph1\"> </ph>","pos":[20891,21016],"source":" [Packaging and Deploying Resources](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How the Runtime Locates Assemblies<ept id=\"p1\">](../../../docs/framework/deployment/how-the-runtime-locates-assemblies.md)</ept><ph id=\"ph1\"> </ph>","pos":[21019,21131],"source":" [How the Runtime Locates Assemblies](../../../docs/framework/deployment/how-the-runtime-locates-assemblies.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Creating and retrieving resources in Windows Store apps<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkID=241674)</ept>","pos":[21134,21241],"source":" [Creating and retrieving resources in Windows Store apps](http://go.microsoft.com/fwlink/p/?LinkID=241674)"}]}