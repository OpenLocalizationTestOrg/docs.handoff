{"content":"---\ntitle: Testing a class library with .NET Core in Visual Studio 2017\ndescription: Learn how to test a class library written in C# using Visual Studio 2017\nkeywords: .NET Core, .NET Standard class library, Visual Studio 2017, unit testing \nauthor: BillWagner\nms.author: wiwagn\nms.date: 11/16/2016\nms.topic: article\nms.prod: .net-core\nms.technology: devlang-csharp\nms.devlang: csharp\nms.assetid: 069ad711-3eaa-45c6-94d7-b40249cc8b99\n---\n\n# Testing a class library with .NET Core in Visual Studio 2017\n\nIn [Building a class library with C# and .NET Core in Visual Studio 2017](library-with-visual-studio.md), you created a simple class library that adds an extension method to the @System.String class. Now, you'll create a unit test to make sure that it works as expected. You'll add your unit test project to the solution you created in the previous topic.\n\n## Creating a unit test project\n\nTo create the unit test project, do the following:\n\n1. In **Solution Explorer**, open the context menu for the **ClassLibraryProject** solution node and select **Add** > **New Project**.\n\n   <!-- Need a VS 2017 version  [!NOTE] In addition to a Unit Test project, you can also use Visual Studio to create an xUnit test project for .NET Core. For a walkthrough that includes an xUnit test project, see [Getting started with .NET Core on Windows, using Visual Studio 2015](../../core/tutorials/using-on-windows.md). --> \n\n1. In the **Add New Project** dialog, select the **.NET Core** node followed by the **Unit Test Project (.NET Core)** project template. In the **Name** text box, enter \"StringLibraryTest\" as the name of the project. Select **OK** to create the unit test project.\n\n   ![Add New Project dialog](./media/testing-library-with-visual-studio/testproject.png)\n\n1. Visual Studio creates the project and opens the *UnitTest1.cs* file in the code window.\n\n   ![Visual Studio code window showing the default unit test project UnitTest1 class and TestMethod1 method](./media/testing-library-with-visual-studio/unittestwindow.png)\n\n   The source code created by the unit test template does the following:\n\n   * It imports the [Microsoft.VisualStudio.TestTools.UnitTesting](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.aspx) namespace, which contains the types used for unit testing.\n\n   * It applies the [\\[TestClass\\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx) attribute to the `UnitTest1` class. Each test method in a test class tagged with the \\[TestMethod\\] attribute is executed automatically when the unit test is run.\n\n   * It applies the [\\[TestMethod\\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx) attribute to define `TestMethod1` as a test method for automatic execution when the unit test is run.\n\n1. In **Solution Explorer**, right-click the **Dependencies** node of the **StringLibraryTest** project and select **Add Reference** from the context menu.\n\n   ![Context menu of StringLibraryTest Dependencies](./media/testing-library-with-visual-studio/addreference.png)\n\n1. In the **Reference Manager** dialog, check the box next to **StringLibrary**. Adding a reference to the `StringLibrary` assembly allows the compiler to find **StringLibrary** methods. Select the **OK** button. This adds a reference to your class library project, `StringLibrary`.\n\n   ![Reference manager](./media/testing-library-with-visual-studio/referencemanager.png)\n\n## Adding and running unit test methods\n\nWhen Visual Studio runs a unit test, it executes each method marked with the [\\[TestMethod\\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx) attribute in a unit test class, the class to which the  [\\[TestClass\\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx) attribute is applied. A test method ends when the first failure is encountered or when all tests contained in the method have succeeded.\n\nThe most common tests call members of the [Assert](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.assert.aspx) class. Many assert methods include at least two parameters, one of which is the expected test result and the other of which is the actual test result. Some of its most frequently called methods are shown in the table below.\n\nAssert methods | Function\n--- | ---\n`Assert.AreEqual` | Verifies that two values or objects are equal. The assert fails if the values or objects are not equal.\n`Assert.AreSame` | Verifies that two object variables refer to the same object. The assert fails if the variables refer to different objects.\n`Assert.IsFalse` | Verifies that a condition is `false`. The assert fails if the condition is `true`.\n`Assert.IsNotNull` | Verifies that an object is not `null`. The assert fails if the object is `null`.\n[\\[ExpectedException\\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.expectedexceptionattribute.aspx) attribute | Indicates the type of exception a test method is expected to throw. The test fails if the specified exception is not thrown.\n\nIn testing the `StringLibrary.StartsWithUpper` method, you want to provide a number of strings that begin with an uppercase character. You expect the method to return `true` in these cases, so you can call the [Assert.IsTrue(Boolean, String)](https://msdn.microsoft.com/library/ms243754.aspx) method. Similarly, you want to provide a number of strings that begin with something other than an uppercase character. You expect the method to return `false` in these cases, so you can call the [Assert.IsFalse(Boolean, String)](https://msdn.microsoft.com/library/ms243805.aspx) method.\n\nSince your library method handles strings, you also want to make sure that it successfully handles an [empty string (`String.Empty`)](xref:System.String.Empty), a valid string that has no characters and whose @System.String.Length is 0 and a `null` string that has not been initialized. If `StartsWithUpper` is called as an extension method on a @System.String instance, it cannot be passed a `null` string. However, you can also call it directly as a static method and pass a single @System.String argument.\n\nYou'll define three methods, each of which calls its [Assert](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.assert.aspx) method repeatedly for each element in a string array. Because the test method fails as soon as it encounters the first failure, you'll call a method overload that allows you to pass a string that indicates the string value used in the method call.\n\nTo create the test methods:\n\n1. In the *UnitTest1.cs* code window, replace the code with the following code:\n\n   [!CODE-csharp[Test#1](../../../samples/snippets/csharp/getting_started/with_visual_studio_2017/testlib1.cs#1)]\n\n   Note that your test of uppercase characters in the `TestStartsWithUpper` method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the `TestDoesNotStartWithUpper` method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).\n\n1. On the menu bar, select **File** > **Save UnitTest1.cs As**. In the **Save File As** dialog, select the arrow beside the **Save** button, and select **Save with Encoding**.\n\n   ![Save File As dialog](./media/testing-library-with-visual-studio/savefileas.png)\n\n1. In the **Confirm Save As** dialog, select the **Yes** button to save the file.\n\n1. In the **Advanced Save Options** dialog, select **Unicode (UTF-8 with signature) - Codepage 65001** from the **Encoding** drop-down list and select **OK**.\n\n   ![Advanced Save Options dialog](./media/testing-library-with-visual-studio/advancedsaveoptions.png)\n\n   If you fail to save your source code as a UTF8-encoded file, Visual Studio may save it as an ASCII file. When that happens, the runtime doesn't accurately decode the UTF8 characters outside of the ASCII range, and the test results won't be accurate.\n\n1. On the menu bar, select **Test** > **Run** > **All Tests**. The **Test Explorer** window opens and shows that the tests run successfully. The three tests are listed in the **Passed Tests** section, and the **Summary** section reports the result of the test run.\n\n   ![Test Explorer window](./media/testing-library-with-visual-studio/firsttest.png)\n\n## Handling test failures\n\nYour test run had no failures, but change it slightly so that one of the test methods fails:\n\n1. Modify the `words` array in the `TestDoesNotStartWithUpper` method to include the string \"Error\". You don't need to save the file because Visual Studio automatically saves open files when a solution is built to run tests.\n\n   ```csharp\n   string[] words = { \"alphabet\", \"Error\", \"zebra\", \"abc\", \"αυτοκινητοβιομηχανία\", \"государство\",\n                      \"1234\", \".\", \";\", \" \" };\n   ```\n\n1. Run the test by selecting **Test** > **Run** > **All Tests** from the menu bar. The **Test Explorer** window indicates that two tests succeeded and one failed.\n\n   ![Test Explorer window](./media/testing-library-with-visual-studio/failedtest.png)\n\n1. In the **Failed Tests** section, select the failed test, `TestDoesNotStartWith`. The **Test Explorer** window displays the message produced by the assert: \"Assert.IsFalse failed. Expected for 'Error': false; actual: True\". Because of the failure, all strings in the array after \"Error\" were not tested.\n\n   ![Test Explorer window showing the Is False assertion failure](./media/testing-library-with-visual-studio/failedtestdetail.png)\n\n1. Remove the code that you added (`\"Error\", `) and rerun the test. The tests will pass.\n\n## Testing the Release version of the library\n\nYou've been running your tests against the Debug version of the library. Now that your tests have all passed and you've adequately tested your library, you should run the tests an additional time against the Release build of the library. A number of factors, including compiler optimizations, can sometimes produce different behavior between Debug and Release builds.\n\nTo test the Release build:\n\n1. In the Visual Studio toolbar, change the build configuration from **Debug** to **Release**.\n\n   ![Visual Studio toolbar](./media/testing-library-with-visual-studio/toolbar.png)\n\n1. In **Solution Explorer**, right-click the **StringLibrary** project and select **Build** from the context menu to recompile the library.\n\n   ![StringLibrary context menu](./media/testing-library-with-visual-studio/buildlibrary.png)\n\n1. Run the unit tests by choosing **Test** > **Run** > **All Tests** from the menu bar. The tests pass.\n\nNow that you've finished testing your library, the next step is to make it available to callers. You can bundle it with one or more applications, or you can distribute it as a NuGet package. For more information, see [Consuming a .NET Standard Class Library](./consuming-library-with-visual-studio.md).\n","nodes":[{"pos":[4,433],"embed":true,"restype":"x-metadata","content":"title: Testing a class library with .NET Core in Visual Studio 2017\ndescription: Learn how to test a class library written in C# using Visual Studio 2017\nkeywords: .NET Core, .NET Standard class library, Visual Studio 2017, unit testing \nauthor: BillWagner\nms.author: wiwagn\nms.date: 11/16/2016\nms.topic: article\nms.prod: .net-core\nms.technology: devlang-csharp\nms.devlang: csharp\nms.assetid: 069ad711-3eaa-45c6-94d7-b40249cc8b99","nodes":[{"content":"Testing a class library with .NET Core in Visual Studio 2017","nodes":[{"pos":[0,60],"content":"Testing a class library with .NET Core in Visual Studio 2017","nodes":[{"content":"Testing a class library with .NET Core in Visual Studio 2017","pos":[0,60]}]}],"path":["title"]},{"content":"Learn how to test a class library written in C# using Visual Studio 2017","nodes":[{"pos":[0,72],"content":"Learn how to test a class library written in C# using Visual Studio 2017","nodes":[{"content":"Learn how to test a class library written in C# using Visual Studio 2017","pos":[0,72]}]}],"path":["description"]},{"content":".NET Core, .NET Standard class library, Visual Studio 2017, unit testing","nodes":[{"pos":[0,72],"content":".NET Core, .NET Standard class library, Visual Studio 2017, unit testing","nodes":[{"content":".NET Core, .NET Standard class library, Visual Studio 2017, unit testing","pos":[0,72]}]}],"path":["keywords"]}],"yml":true},{"pos":[441,501],"content":"Testing a class library with .NET Core in Visual Studio 2017","linkify":"Testing a class library with .NET Core in Visual Studio 2017","nodes":[{"content":"Testing a class library with .NET Core in Visual Studio 2017","pos":[0,60]}]},{"content":"In <bpt id=\"p1\">[</bpt>Building a class library with C# and .NET Core in Visual Studio 2017<ept id=\"p1\">](library-with-visual-studio.md)</ept>, you created a simple class library that adds an extension method to the <ph id=\"ph1\">@System.String</ph> class.","pos":[503,702],"source":"In [Building a class library with C# and .NET Core in Visual Studio 2017](library-with-visual-studio.md), you created a simple class library that adds an extension method to the @System.String class."},{"content":"Now, you'll create a unit test to make sure that it works as expected.","pos":[703,773]},{"content":"You'll add your unit test project to the solution you created in the previous topic.","pos":[774,858]},{"pos":[863,891],"content":"Creating a unit test project","linkify":"Creating a unit test project","nodes":[{"content":"Creating a unit test project","pos":[0,28]}]},{"content":"To create the unit test project, do the following:","pos":[893,943]},{"pos":[948,1079],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, open the context menu for the <bpt id=\"p2\">**</bpt>ClassLibraryProject<ept id=\"p2\">**</ept> solution node and select <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p4\">**</bpt>New Project<ept id=\"p4\">**</ept>.","source":"In **Solution Explorer**, open the context menu for the **ClassLibraryProject** solution node and select **Add** > **New Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>Add New Project<ept id=\"p1\">**</ept> dialog, select the <bpt id=\"p2\">**</bpt>.NET Core<ept id=\"p2\">**</ept> node followed by the <bpt id=\"p3\">**</bpt>Unit Test Project (.NET Core)<ept id=\"p3\">**</ept> project template.","pos":[1416,1548],"source":"In the **Add New Project** dialog, select the **.NET Core** node followed by the **Unit Test Project (.NET Core)** project template."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> text box, enter \"StringLibraryTest\" as the name of the project.","pos":[1549,1628],"source":" In the **Name** text box, enter \"StringLibraryTest\" as the name of the project."},{"content":"Select <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to create the unit test project.","pos":[1629,1675],"source":" Select **OK** to create the unit test project."},{"content":"Add New Project dialog","pos":[1682,1704]},{"pos":[1770,1857],"content":"Visual Studio creates the project and opens the <bpt id=\"p1\">*</bpt>UnitTest1.cs<ept id=\"p1\">*</ept> file in the code window.","source":"Visual Studio creates the project and opens the *UnitTest1.cs* file in the code window."},{"content":"Visual Studio code window showing the default unit test project UnitTest1 class and TestMethod1 method","pos":[1864,1966]},{"content":"The source code created by the unit test template does the following:","pos":[2035,2104]},{"pos":[2111,2317],"content":"It imports the <bpt id=\"p1\">[</bpt>Microsoft.VisualStudio.TestTools.UnitTesting<ept id=\"p1\">](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.aspx)</ept> namespace, which contains the types used for unit testing.","source":"It imports the [Microsoft.VisualStudio.TestTools.UnitTesting](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.aspx) namespace, which contains the types used for unit testing."},{"content":"It applies the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\[</ph>TestClass<ph id=\"ph2\">\\]</ph><ept id=\"p1\">](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx)</ept> attribute to the <ph id=\"ph3\">`UnitTest1`</ph> class.","pos":[2324,2495],"source":"It applies the [\\[TestClass\\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx) attribute to the `UnitTest1` class."},{"content":"Each test method in a test class tagged with the <ph id=\"ph1\">\\[</ph>TestMethod<ph id=\"ph2\">\\]</ph> attribute is executed automatically when the unit test is run.","pos":[2496,2622],"source":" Each test method in a test class tagged with the \\[TestMethod\\] attribute is executed automatically when the unit test is run."},{"pos":[2629,2868],"content":"It applies the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\[</ph>TestMethod<ph id=\"ph2\">\\]</ph><ept id=\"p1\">](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx)</ept> attribute to define <ph id=\"ph3\">`TestMethod1`</ph> as a test method for automatic execution when the unit test is run.","source":"It applies the [\\[TestMethod\\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx) attribute to define `TestMethod1` as a test method for automatic execution when the unit test is run."},{"pos":[2873,3025],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the <bpt id=\"p2\">**</bpt>Dependencies<ept id=\"p2\">**</ept> node of the <bpt id=\"p3\">**</bpt>StringLibraryTest<ept id=\"p3\">**</ept> project and select <bpt id=\"p4\">**</bpt>Add Reference<ept id=\"p4\">**</ept> from the context menu.","source":"In **Solution Explorer**, right-click the **Dependencies** node of the **StringLibraryTest** project and select **Add Reference** from the context menu."},{"content":"Context menu of StringLibraryTest Dependencies","pos":[3032,3078]},{"content":"In the <bpt id=\"p1\">**</bpt>Reference Manager<ept id=\"p1\">**</ept> dialog, check the box next to <bpt id=\"p2\">**</bpt>StringLibrary<ept id=\"p2\">**</ept>.","pos":[3145,3222],"source":"In the **Reference Manager** dialog, check the box next to **StringLibrary**."},{"content":"Adding a reference to the <ph id=\"ph1\">`StringLibrary`</ph> assembly allows the compiler to find <bpt id=\"p1\">**</bpt>StringLibrary<ept id=\"p1\">**</ept> methods.","pos":[3223,3328],"source":" Adding a reference to the `StringLibrary` assembly allows the compiler to find **StringLibrary** methods."},{"content":"Select the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button.","pos":[3329,3354],"source":" Select the **OK** button."},{"content":"This adds a reference to your class library project, <ph id=\"ph1\">`StringLibrary`</ph>.","pos":[3355,3424],"source":" This adds a reference to your class library project, `StringLibrary`."},{"content":"Reference manager","pos":[3431,3448]},{"pos":[3519,3555],"content":"Adding and running unit test methods","linkify":"Adding and running unit test methods","nodes":[{"content":"Adding and running unit test methods","pos":[0,36]}]},{"content":"When Visual Studio runs a unit test, it executes each method marked with the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\[</ph>TestMethod<ph id=\"ph2\">\\]</ph><ept id=\"p1\">](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx)</ept> attribute in a unit test class, the class to which the  <bpt id=\"p2\">[</bpt><ph id=\"ph3\">\\[</ph>TestClass<ph id=\"ph4\">\\]</ph><ept id=\"p2\">](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx)</ept> attribute is applied.","pos":[3557,3955],"source":"When Visual Studio runs a unit test, it executes each method marked with the [\\[TestMethod\\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx) attribute in a unit test class, the class to which the  [\\[TestClass\\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx) attribute is applied."},{"content":"A test method ends when the first failure is encountered or when all tests contained in the method have succeeded.","pos":[3956,4070]},{"content":"The most common tests call members of the <bpt id=\"p1\">[</bpt>Assert<ept id=\"p1\">](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.assert.aspx)</ept> class.","pos":[4072,4222],"source":"The most common tests call members of the [Assert](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.assert.aspx) class."},{"content":"Many assert methods include at least two parameters, one of which is the expected test result and the other of which is the actual test result.","pos":[4223,4366]},{"content":"Some of its most frequently called methods are shown in the table below.","pos":[4367,4439]},{"content":"Assert methods","pos":[4441,4455]},{"content":"Function","pos":[4458,4466]},{"content":"Verifies that two values or objects are equal.","pos":[4497,4543]},{"content":"The assert fails if the values or objects are not equal.","pos":[4544,4600]},{"content":"Verifies that two object variables refer to the same object.","pos":[4620,4680]},{"content":"The assert fails if the variables refer to different objects.","pos":[4681,4742]},{"content":"Verifies that a condition is <ph id=\"ph1\">`false`</ph>.","pos":[4762,4799],"source":"Verifies that a condition is `false`."},{"content":"The assert fails if the condition is <ph id=\"ph1\">`true`</ph>.","pos":[4800,4844],"source":" The assert fails if the condition is `true`."},{"content":"Verifies that an object is not <ph id=\"ph1\">`null`</ph>.","pos":[4866,4904],"source":"Verifies that an object is not `null`."},{"content":"The assert fails if the object is <ph id=\"ph1\">`null`</ph>.","pos":[4905,4946],"source":" The assert fails if the object is `null`."},{"pos":[4947,5093],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\[</ph>ExpectedException<ph id=\"ph2\">\\]</ph><ept id=\"p1\">](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.expectedexceptionattribute.aspx)</ept> attribute","source":"[\\[ExpectedException\\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.expectedexceptionattribute.aspx) attribute"},{"content":"Indicates the type of exception a test method is expected to throw.","pos":[5096,5163]},{"content":"The test fails if the specified exception is not thrown.","pos":[5164,5220]},{"content":"In testing the <ph id=\"ph1\">`StringLibrary.StartsWithUpper`</ph> method, you want to provide a number of strings that begin with an uppercase character.","pos":[5222,5356],"source":"In testing the `StringLibrary.StartsWithUpper` method, you want to provide a number of strings that begin with an uppercase character."},{"content":"You expect the method to return <ph id=\"ph1\">`true`</ph> in these cases, so you can call the <bpt id=\"p1\">[</bpt>Assert.IsTrue(Boolean, String)<ept id=\"p1\">](https://msdn.microsoft.com/library/ms243754.aspx)</ept> method.","pos":[5357,5522],"source":" You expect the method to return `true` in these cases, so you can call the [Assert.IsTrue(Boolean, String)](https://msdn.microsoft.com/library/ms243754.aspx) method."},{"content":"Similarly, you want to provide a number of strings that begin with something other than an uppercase character.","pos":[5523,5634]},{"content":"You expect the method to return <ph id=\"ph1\">`false`</ph> in these cases, so you can call the <bpt id=\"p1\">[</bpt>Assert.IsFalse(Boolean, String)<ept id=\"p1\">](https://msdn.microsoft.com/library/ms243805.aspx)</ept> method.","pos":[5635,5802],"source":" You expect the method to return `false` in these cases, so you can call the [Assert.IsFalse(Boolean, String)](https://msdn.microsoft.com/library/ms243805.aspx) method."},{"content":"Since your library method handles strings, you also want to make sure that it successfully handles an <bpt id=\"p1\">[</bpt>empty string (<ph id=\"ph1\">`String.Empty`</ph>)<ept id=\"p1\">](xref:System.String.Empty)</ept>, a valid string that has no characters and whose <ph id=\"ph2\">@System.String.Length</ph> is 0 and a <ph id=\"ph3\">`null`</ph> string that has not been initialized.","pos":[5804,6090],"source":"Since your library method handles strings, you also want to make sure that it successfully handles an [empty string (`String.Empty`)](xref:System.String.Empty), a valid string that has no characters and whose @System.String.Length is 0 and a `null` string that has not been initialized."},{"content":"If <ph id=\"ph1\">`StartsWithUpper`</ph> is called as an extension method on a <ph id=\"ph2\">@System.String</ph> instance, it cannot be passed a <ph id=\"ph3\">`null`</ph> string.","pos":[6091,6211],"source":" If `StartsWithUpper` is called as an extension method on a @System.String instance, it cannot be passed a `null` string."},{"content":"However, you can also call it directly as a static method and pass a single <ph id=\"ph1\">@System.String</ph> argument.","pos":[6212,6312],"source":" However, you can also call it directly as a static method and pass a single @System.String argument."},{"content":"You'll define three methods, each of which calls its <bpt id=\"p1\">[</bpt>Assert<ept id=\"p1\">](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.assert.aspx)</ept> method repeatedly for each element in a string array.","pos":[6314,6522],"source":"You'll define three methods, each of which calls its [Assert](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.assert.aspx) method repeatedly for each element in a string array."},{"content":"Because the test method fails as soon as it encounters the first failure, you'll call a method overload that allows you to pass a string that indicates the string value used in the method call.","pos":[6523,6716]},{"content":"To create the test methods:","pos":[6718,6745]},{"pos":[6750,6826],"content":"In the <bpt id=\"p1\">*</bpt>UnitTest1.cs<ept id=\"p1\">*</ept> code window, replace the code with the following code:","source":"In the *UnitTest1.cs* code window, replace the code with the following code:"},{"pos":[6946,7289],"content":"Note that your test of uppercase characters in the <ph id=\"ph1\">`TestStartsWithUpper`</ph> method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the <ph id=\"ph2\">`TestDoesNotStartWithUpper`</ph> method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).","source":"Note that your test of uppercase characters in the `TestStartsWithUpper` method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the `TestDoesNotStartWithUpper` method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433)."},{"content":"On the menu bar, select <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Save UnitTest1.cs As<ept id=\"p2\">**</ept>.","pos":[7294,7354],"source":"On the menu bar, select **File** > **Save UnitTest1.cs As**."},{"content":"In the <bpt id=\"p1\">**</bpt>Save File As<ept id=\"p1\">**</ept> dialog, select the arrow beside the <bpt id=\"p2\">**</bpt>Save<ept id=\"p2\">**</ept> button, and select <bpt id=\"p3\">**</bpt>Save with Encoding<ept id=\"p3\">**</ept>.","pos":[7355,7466],"source":" In the **Save File As** dialog, select the arrow beside the **Save** button, and select **Save with Encoding**."},{"content":"Save File As dialog","pos":[7473,7492]},{"pos":[7557,7635],"content":"In the <bpt id=\"p1\">**</bpt>Confirm Save As<ept id=\"p1\">**</ept> dialog, select the <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept> button to save the file.","source":"In the **Confirm Save As** dialog, select the **Yes** button to save the file."},{"pos":[7640,7795],"content":"In the <bpt id=\"p1\">**</bpt>Advanced Save Options<ept id=\"p1\">**</ept> dialog, select <bpt id=\"p2\">**</bpt>Unicode (UTF-8 with signature) - Codepage 65001<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Encoding<ept id=\"p3\">**</ept> drop-down list and select <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept>.","source":"In the **Advanced Save Options** dialog, select **Unicode (UTF-8 with signature) - Codepage 65001** from the **Encoding** drop-down list and select **OK**."},{"content":"Advanced Save Options dialog","pos":[7802,7830]},{"content":"If you fail to save your source code as a UTF8-encoded file, Visual Studio may save it as an ASCII file.","pos":[7904,8008]},{"content":"When that happens, the runtime doesn't accurately decode the UTF8 characters outside of the ASCII range, and the test results won't be accurate.","pos":[8009,8153]},{"content":"On the menu bar, select <bpt id=\"p1\">**</bpt>Test<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p3\">**</bpt>All Tests<ept id=\"p3\">**</ept>.","pos":[8158,8217],"source":"On the menu bar, select **Test** > **Run** > **All Tests**."},{"content":"The <bpt id=\"p1\">**</bpt>Test Explorer<ept id=\"p1\">**</ept> window opens and shows that the tests run successfully.","pos":[8218,8295],"source":" The **Test Explorer** window opens and shows that the tests run successfully."},{"content":"The three tests are listed in the <bpt id=\"p1\">**</bpt>Passed Tests<ept id=\"p1\">**</ept> section, and the <bpt id=\"p2\">**</bpt>Summary<ept id=\"p2\">**</ept> section reports the result of the test run.","pos":[8296,8419],"source":" The three tests are listed in the **Passed Tests** section, and the **Summary** section reports the result of the test run."},{"content":"Test Explorer window","pos":[8426,8446]},{"pos":[8510,8532],"content":"Handling test failures","linkify":"Handling test failures","nodes":[{"content":"Handling test failures","pos":[0,22]}]},{"content":"Your test run had no failures, but change it slightly so that one of the test methods fails:","pos":[8534,8626]},{"content":"Modify the <ph id=\"ph1\">`words`</ph> array in the <ph id=\"ph2\">`TestDoesNotStartWithUpper`</ph> method to include the string \"Error\".","pos":[8631,8728],"source":"Modify the `words` array in the `TestDoesNotStartWithUpper` method to include the string \"Error\"."},{"content":"You don't need to save the file because Visual Studio automatically saves open files when a solution is built to run tests.","pos":[8729,8852]},{"content":"Run the test by selecting <bpt id=\"p1\">**</bpt>Test<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p3\">**</bpt>All Tests<ept id=\"p3\">**</ept> from the menu bar.","pos":[9023,9102],"source":"Run the test by selecting **Test** > **Run** > **All Tests** from the menu bar."},{"content":"The <bpt id=\"p1\">**</bpt>Test Explorer<ept id=\"p1\">**</ept> window indicates that two tests succeeded and one failed.","pos":[9103,9182],"source":" The **Test Explorer** window indicates that two tests succeeded and one failed."},{"content":"Test Explorer window","pos":[9189,9209]},{"content":"In the <bpt id=\"p1\">**</bpt>Failed Tests<ept id=\"p1\">**</ept> section, select the failed test, <ph id=\"ph1\">`TestDoesNotStartWith`</ph>.","pos":[9274,9354],"source":"In the **Failed Tests** section, select the failed test, `TestDoesNotStartWith`."},{"content":"The <bpt id=\"p1\">**</bpt>Test Explorer<ept id=\"p1\">**</ept> window displays the message produced by the assert: \"Assert.IsFalse failed.","pos":[9355,9452],"source":" The **Test Explorer** window displays the message produced by the assert: \"Assert.IsFalse failed."},{"content":"Expected for 'Error': false; actual: True\".","pos":[9453,9496]},{"content":"Because of the failure, all strings in the array after \"Error\" were not tested.","pos":[9497,9576]},{"content":"Test Explorer window showing the Is False assertion failure","pos":[9583,9642]},{"content":"Remove the code that you added (<ph id=\"ph1\">`\"Error\", `</ph>) and rerun the test.","pos":[9713,9777],"source":"Remove the code that you added (`\"Error\", `) and rerun the test."},{"content":"The tests will pass.","pos":[9778,9798]},{"pos":[9803,9845],"content":"Testing the Release version of the library","linkify":"Testing the Release version of the library","nodes":[{"content":"Testing the Release version of the library","pos":[0,42]}]},{"content":"You've been running your tests against the Debug version of the library.","pos":[9847,9919]},{"content":"Now that your tests have all passed and you've adequately tested your library, you should run the tests an additional time against the Release build of the library.","pos":[9920,10084]},{"content":"A number of factors, including compiler optimizations, can sometimes produce different behavior between Debug and Release builds.","pos":[10085,10214]},{"content":"To test the Release build:","pos":[10216,10242]},{"pos":[10247,10338],"content":"In the Visual Studio toolbar, change the build configuration from <bpt id=\"p1\">**</bpt>Debug<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>Release<ept id=\"p2\">**</ept>.","source":"In the Visual Studio toolbar, change the build configuration from **Debug** to **Release**."},{"content":"Visual Studio toolbar","pos":[10345,10366]},{"pos":[10428,10564],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the <bpt id=\"p2\">**</bpt>StringLibrary<ept id=\"p2\">**</ept> project and select <bpt id=\"p3\">**</bpt>Build<ept id=\"p3\">**</ept> from the context menu to recompile the library.","source":"In **Solution Explorer**, right-click the **StringLibrary** project and select **Build** from the context menu to recompile the library."},{"content":"StringLibrary context menu","pos":[10571,10597]},{"content":"Run the unit tests by choosing <bpt id=\"p1\">**</bpt>Test<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p3\">**</bpt>All Tests<ept id=\"p3\">**</ept> from the menu bar.","pos":[10664,10748],"source":"Run the unit tests by choosing **Test** > **Run** > **All Tests** from the menu bar."},{"content":"The tests pass.","pos":[10749,10764]},{"content":"Now that you've finished testing your library, the next step is to make it available to callers.","pos":[10766,10862]},{"content":"You can bundle it with one or more applications, or you can distribute it as a NuGet package.","pos":[10863,10956]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Consuming a .NET Standard Class Library<ept id=\"p1\">](./consuming-library-with-visual-studio.md)</ept>.","pos":[10957,11068],"source":" For more information, see [Consuming a .NET Standard Class Library](./consuming-library-with-visual-studio.md)."}]}