{"content":"---\ntitle: \"Implementing the UI Automation Value Control Pattern | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"control patterns, Value\"\n  - \"UI Automation, Value control pattern\"\n  - \"Value control pattern\"\nms.assetid: b0fcdd87-3add-4345-bca9-e891205e02ba\ncaps.latest.revision: 25\nauthor: \"Xansky\"\nms.author: \"mhopkins\"\nmanager: \"markl\"\n---\n# Implementing the UI Automation Value Control Pattern\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IValueProvider>, including information on events and properties. Links to additional references are listed at the end of the topic.  \n  \n The <xref:System.Windows.Automation.ValuePattern> control pattern is used to support controls that have an intrinsic value not spanning a range and that can be represented as a string. This string can be editable, depending on the control and its settings. For examples of controls that implement this pattern, see [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md).  \n  \n<a name=\"Implementation_Guidelines_and_Conventions\"></a>   \n## Implementation Guidelines and Conventions  \n When implementing the Value control pattern, note the following guidelines and conventions:  \n  \n-   Controls such as <xref:System.Windows.Automation.ControlType.ListItem> and <xref:System.Windows.Automation.ControlType.TreeItem> must support <xref:System.Windows.Automation.ValuePattern> if the value of any of the items is editable, regardless of the current edit mode of the control. The parent control must also support <xref:System.Windows.Automation.ValuePattern> if the child items are editable.  \n  \n ![Editable list item.](../../../docs/framework/ui-automation/media/uia-valuepattern-editable-listitem.PNG \"UIA_ValuePattern_Editable_ListItem\")  \nExample of an Editable List Item  \n  \n-   Single-line edit controls support programmatic access to their contents by implementing <xref:System.Windows.Automation.Provider.IValueProvider>. However, multi-line edit controls do not implement <xref:System.Windows.Automation.Provider.IValueProvider>; instead they provide access to their content by implementing <xref:System.Windows.Automation.Provider.ITextProvider>.  \n  \n-   To retrieve the textual contents of a multi-line edit control, the control must implement <xref:System.Windows.Automation.Provider.ITextProvider>. However, <xref:System.Windows.Automation.Provider.ITextProvider> does not support setting the value of a control.  \n  \n-   <xref:System.Windows.Automation.Provider.IValueProvider> does not support the retrieval of formatting information or substring values. Implement <xref:System.Windows.Automation.Provider.ITextProvider> in these scenarios.  \n  \n-   <xref:System.Windows.Automation.Provider.IValueProvider> must be implemented by controls such as the **Color Picker** selection control from [!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)] (illustrated below), which supports string mapping between a color value (for example, \"yellow\") and an equivalent internal [!INCLUDE[TLA#tla_rgb](../../../includes/tlasharptla-rgb-md.md)] structure.  \n  \n ![Color picker with yellow highlighted.](../../../docs/framework/ui-automation/media/uia-valuepattern-colorpicker.png \"UIA_ValuePattern_ColorPicker\")  \nExample of Color Swatch String Mapping  \n  \n-   A control should have its <xref:System.Windows.Automation.AutomationElement.IsEnabledProperty> set to `true` and its <xref:System.Windows.Automation.ValuePattern.IsReadOnlyProperty> set to `false` before allowing a call to <xref:System.Windows.Automation.Provider.IValueProvider.SetValue%2A>.  \n  \n<a name=\"Required_Members_for_the_IValueProvider_Interface\"></a>   \n## Required Members for IValueProvider  \n The following properties and methods are required for implementing <xref:System.Windows.Automation.Provider.IValueProvider>.  \n  \n|Required members|Member type|Notes|  \n|----------------------|-----------------|-----------|  \n|<xref:System.Windows.Automation.ValuePattern.IsReadOnlyProperty>|Property|None|  \n|<xref:System.Windows.Automation.ValuePattern.ValueProperty>|Property|None|  \n|<xref:System.Windows.Automation.ValuePattern.SetValue%2A>|Method|None|  \n  \n<a name=\"Exceptions\"></a>   \n## Exceptions  \n Providers must throw the following exceptions.  \n  \n|Exception type|Condition|  \n|--------------------|---------------|  \n|<xref:System.InvalidOperationException>|<xref:System.Windows.Automation.ValuePattern.SetValue%2A><br /><br /> -   If locale-specific information is passed to a control in an incorrect format such as an incorrectly formatted date.|  \n|<xref:System.ArgumentException>|<xref:System.Windows.Automation.ValuePattern.SetValue%2A><br /><br /> -   If a new value cannot be converted from a string to a format the control recognizes.|  \n|<xref:System.Windows.Automation.ElementNotEnabledException>|<xref:System.Windows.Automation.ValuePattern.SetValue%2A><br /><br /> -   When an attempt is made to manipulate a control that is not enabled.|  \n  \n## See Also  \n [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)   \n [Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)   \n [UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)   \n [TextPattern Insert Text Sample](http://msdn.microsoft.com/en-us/67353f93-7ee2-42f2-ab76-5c078cf6ca16)   \n [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)   \n [Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)","nodes":[{"pos":[12,81],"content":"Implementing the UI Automation Value Control Pattern | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Implementing the UI Automation Value Control Pattern | Microsoft Docs","pos":[0,69]}]},{"pos":[504,556],"content":"Implementing the UI Automation Value Control Pattern","linkify":"Implementing the UI Automation Value Control Pattern","nodes":[{"content":"Implementing the UI Automation Value Control Pattern","pos":[0,52]}]},{"pos":[559,1021],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":" This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","pos":[8,460],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[1,241],"source":" This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[242,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"content":"This topic introduces guidelines and conventions for implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IValueProvider&gt;</ph>, including information on events and properties.","pos":[1028,1199],"source":"This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IValueProvider>, including information on events and properties."},{"content":"Links to additional references are listed at the end of the topic.","pos":[1200,1266]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Automation.ValuePattern&gt;</ph> control pattern is used to support controls that have an intrinsic value not spanning a range and that can be represented as a string.","pos":[1273,1457],"source":"The <xref:System.Windows.Automation.ValuePattern> control pattern is used to support controls that have an intrinsic value not spanning a range and that can be represented as a string."},{"content":"This string can be editable, depending on the control and its settings.","pos":[1458,1529]},{"content":"For examples of controls that implement this pattern, see <bpt id=\"p1\">[</bpt>Control Pattern Mapping for UI Automation Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)</ept>.","pos":[1530,1732],"source":" For examples of controls that implement this pattern, see [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)."},{"pos":[1801,1842],"content":"Implementation Guidelines and Conventions","linkify":"Implementation Guidelines and Conventions","nodes":[{"content":"Implementation Guidelines and Conventions","pos":[0,41]}]},{"content":"When implementing the Value control pattern, note the following guidelines and conventions:","pos":[1846,1937]},{"content":"Controls such as <ph id=\"ph1\">&lt;xref:System.Windows.Automation.ControlType.ListItem&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Automation.ControlType.TreeItem&gt;</ph> must support <ph id=\"ph3\">&lt;xref:System.Windows.Automation.ValuePattern&gt;</ph> if the value of any of the items is editable, regardless of the current edit mode of the control.","pos":[1947,2232],"source":"Controls such as <xref:System.Windows.Automation.ControlType.ListItem> and <xref:System.Windows.Automation.ControlType.TreeItem> must support <xref:System.Windows.Automation.ValuePattern> if the value of any of the items is editable, regardless of the current edit mode of the control."},{"content":"The parent control must also support <ph id=\"ph1\">&lt;xref:System.Windows.Automation.ValuePattern&gt;</ph> if the child items are editable.","pos":[2233,2348],"source":" The parent control must also support <xref:System.Windows.Automation.ValuePattern> if the child items are editable."},{"content":"<bpt id=\"p1\">![</bpt>Editable list item.<ept id=\"p1\">](../../../docs/framework/ui-automation/media/uia-valuepattern-editable-listitem.PNG \"UIA_ValuePattern_Editable_ListItem\")</ept>","pos":[2355,2498],"source":"![Editable list item.](../../../docs/framework/ui-automation/media/uia-valuepattern-editable-listitem.PNG \"UIA_ValuePattern_Editable_ListItem\")"},{"content":"Example of an Editable List Item","pos":[2501,2533]},{"content":"Single-line edit controls support programmatic access to their contents by implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IValueProvider&gt;</ph>.","pos":[2543,2688],"source":"Single-line edit controls support programmatic access to their contents by implementing <xref:System.Windows.Automation.Provider.IValueProvider>."},{"content":"However, multi-line edit controls do not implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IValueProvider&gt;</ph>; instead they provide access to their content by implementing <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.ITextProvider&gt;</ph>.","pos":[2689,2915],"source":" However, multi-line edit controls do not implement <xref:System.Windows.Automation.Provider.IValueProvider>; instead they provide access to their content by implementing <xref:System.Windows.Automation.Provider.ITextProvider>."},{"content":"To retrieve the textual contents of a multi-line edit control, the control must implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ITextProvider&gt;</ph>.","pos":[2925,3071],"source":"To retrieve the textual contents of a multi-line edit control, the control must implement <xref:System.Windows.Automation.Provider.ITextProvider>."},{"content":"However, <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ITextProvider&gt;</ph> does not support setting the value of a control.","pos":[3072,3185],"source":" However, <xref:System.Windows.Automation.Provider.ITextProvider> does not support setting the value of a control."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IValueProvider&gt;</ph> does not support the retrieval of formatting information or substring values.","pos":[3195,3329],"source":"<xref:System.Windows.Automation.Provider.IValueProvider> does not support the retrieval of formatting information or substring values."},{"content":"Implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ITextProvider&gt;</ph> in these scenarios.","pos":[3330,3415],"source":" Implement <xref:System.Windows.Automation.Provider.ITextProvider> in these scenarios."},{"pos":[3425,3832],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IValueProvider&gt;</ph> must be implemented by controls such as the <bpt id=\"p1\">**</bpt>Color Picker<ept id=\"p1\">**</ept> selection control from <ph id=\"ph2\">[!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)]</ph> (illustrated below), which supports string mapping between a color value (for example, \"yellow\") and an equivalent internal <ph id=\"ph3\">[!INCLUDE[TLA#tla_rgb](../../../includes/tlasharptla-rgb-md.md)]</ph> structure.","source":"<xref:System.Windows.Automation.Provider.IValueProvider> must be implemented by controls such as the **Color Picker** selection control from [!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)] (illustrated below), which supports string mapping between a color value (for example, \"yellow\") and an equivalent internal [!INCLUDE[TLA#tla_rgb](../../../includes/tlasharptla-rgb-md.md)] structure."},{"content":"<bpt id=\"p1\">![</bpt>Color picker with yellow highlighted.<ept id=\"p1\">](../../../docs/framework/ui-automation/media/uia-valuepattern-colorpicker.png \"UIA_ValuePattern_ColorPicker\")</ept>","pos":[3839,3988],"source":"![Color picker with yellow highlighted.](../../../docs/framework/ui-automation/media/uia-valuepattern-colorpicker.png \"UIA_ValuePattern_ColorPicker\")"},{"content":"Example of Color Swatch String Mapping","pos":[3991,4029]},{"pos":[4039,4331],"content":"A control should have its <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.IsEnabledProperty&gt;</ph> set to <ph id=\"ph2\">`true`</ph> and its <ph id=\"ph3\">&lt;xref:System.Windows.Automation.ValuePattern.IsReadOnlyProperty&gt;</ph> set to <ph id=\"ph4\">`false`</ph> before allowing a call to <ph id=\"ph5\">&lt;xref:System.Windows.Automation.Provider.IValueProvider.SetValue%2A&gt;</ph>.","source":"A control should have its <xref:System.Windows.Automation.AutomationElement.IsEnabledProperty> set to `true` and its <xref:System.Windows.Automation.ValuePattern.IsReadOnlyProperty> set to `false` before allowing a call to <xref:System.Windows.Automation.Provider.IValueProvider.SetValue%2A>."},{"pos":[4408,4443],"content":"Required Members for IValueProvider","linkify":"Required Members for IValueProvider","nodes":[{"content":"Required Members for IValueProvider","pos":[0,35]}]},{"content":"The following properties and methods are required for implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IValueProvider&gt;</ph>.","pos":[4447,4571],"source":"The following properties and methods are required for implementing <xref:System.Windows.Automation.Provider.IValueProvider>."},{"content":"Required members","pos":[4578,4594]},{"content":"Member type","pos":[4595,4606]},{"content":"Notes","pos":[4607,4612]},{"content":"Property","pos":[4739,4747]},{"content":"None","pos":[4748,4752]},{"content":"Property","pos":[4817,4825]},{"content":"None","pos":[4826,4830]},{"content":"Method","pos":[4893,4899]},{"content":"None","pos":[4900,4904]},{"pos":[4943,4953],"content":"Exceptions","linkify":"Exceptions","nodes":[{"content":"Exceptions","pos":[0,10]}]},{"content":"Providers must throw the following exceptions.","pos":[4957,5003]},{"content":"Exception type","pos":[5010,5024]},{"content":"Condition","pos":[5025,5034]},{"content":"-   If locale-specific information is passed to a control in an incorrect format such as an incorrectly formatted date.","pos":[5190,5309]},{"content":"-   If a new value cannot be converted from a string to a format the control recognizes.","pos":[5416,5504]},{"content":"-   When an attempt is made to manipulate a control that is not enabled.","pos":[5639,5711]},{"pos":[5721,5729],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[5733,5857],"source":"[UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Support Control Patterns in a UI Automation Provider<ept id=\"p1\">](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)</ept><ph id=\"ph1\"> </ph>","pos":[5860,6011],"source":" [Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md) "},{"content":"<bpt id=\"p1\"> [</bpt>UI Automation Control Patterns for Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)</ept><ph id=\"ph1\"> </ph>","pos":[6014,6145],"source":" [UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md) "},{"content":"<bpt id=\"p1\"> [</bpt>TextPattern Insert Text Sample<ept id=\"p1\">](http://msdn.microsoft.com/en-us/67353f93-7ee2-42f2-ab76-5c078cf6ca16)</ept><ph id=\"ph1\"> </ph>","pos":[6148,6252],"source":" [TextPattern Insert Text Sample](http://msdn.microsoft.com/en-us/67353f93-7ee2-42f2-ab76-5c078cf6ca16) "},{"content":"<bpt id=\"p1\"> [</bpt>UI Automation Tree Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[6255,6356],"source":" [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Use Caching in UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)</ept>","pos":[6359,6461],"source":" [Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)"}]}