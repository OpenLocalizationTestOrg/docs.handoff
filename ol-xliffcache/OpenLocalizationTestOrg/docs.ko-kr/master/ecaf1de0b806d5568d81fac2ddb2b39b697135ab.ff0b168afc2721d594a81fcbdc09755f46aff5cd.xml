{"content":"---\ntitle: \"How To: Build Claims-Aware ASP.NET Application Using Forms-Based Authentication\"\nms.date: \"03/30/2017\"\nms.assetid: 98a3e029-1a9b-4e0c-b5d0-29d3f23f5b15\nauthor: \"BrucePerlerMS\"\n---\n\n# How To: Build Claims-Aware ASP.NET Application Using Forms-Based Authentication\n\n## Applies To\n\n- Microsoft® Windows® Identity Foundation (WIF)\n\n- ASP.NET® Web Forms\n\n## Summary\n\nThis How-To provides detailed step-by-step procedures for creating a simple claims-aware ASP.NET Web Forms application that uses Forms authentication. It also provides instructions for how to test the application to verify that claims are presented when a user signs in with Forms authentication.\n\n## Contents\n\n- Objectives\n\n- Overview\n\n- Summary of Steps\n\n- Step 1 – Create a Simple ASP.NET Web Forms Application\n\n- Step 2 – Configure ASP.NET Web Forms Application for Claims Using Forms Authentication\n\n- Step 3 – Test Your Solution\n\n## Objectives\n\n- Configure an ASP.NET Web Forms application for claims using Forms authentication\n\n- Test the ASP.NET Web Forms application to see if it is working properly\n\n## Overview\n\nIn .NET 4.5, WIF and its claims-based authorization have been included as an integral part of the Framework. Previously, if you wanted claims from an ASP.NET user, you were required to install WIF, and then cast interfaces to Principal objects such as `Thread.CurrentPrincipal` or `HttpContext.Current.User`. Now, claims are served automatically by these Principal objects.\n\nForms authentication has benefited from WIF’s inclusion in .NET 4.5 because all users authenticated by Forms automatically have claims associated with them. You can begin using these claims immediately in an ASP.NET application that uses Forms authentication, as this How-To demonstrates.\n\n## Summary of Steps\n\n- Step 1 – Create a Simple ASP.NET Web Forms Application\n\n- Step 2 – Configure ASP.NET Web Forms Application for Claims Using Forms Authentication\n\n- Step 3 – Test Your Solution\n\n## Step 1 – Create a Simple ASP.NET Web Forms Application\n\nIn this step, you will create a new ASP.NET Web Forms application.\n\n#### To create a simple ASP.NET application\n\n1. Start Visual Studio and click **File**, **New**, and then **Project**.\n\n2. In the **New Project** window, click **ASP.NET Web Forms Application**.\n\n3. In **Name**, enter `TestApp` and press **OK**.\n\n## Step 2 – Configure ASP.NET Web Forms Application for Claims Using Forms Authentication\n\nIn this step you will add a configuration entry to the *Web.config* configuration file and edit the *Default.aspx* file to display claims information for an account.\n\n#### To configure ASP.NET application for claims using Forms authentication\n\n1. In the *Default.aspx* file, replace the existing markup with the following:\n\n    ```aspx\n    <%@ Page Title=\"Home Page\" Language=\"C#\" MasterPageFile=\"~/Site.Master\" AutoEventWireup=\"true\" CodeBehind=\"Default.aspx.cs\" Inherits=\"TestApp._Default\" %>\n\n    <asp:Content runat=\"server\" ID=\"BodyContent\" ContentPlaceHolderID=\"MainContent\">\n        <p>\n            This page displays the claims associated with a Forms authenticated user.\n        </p>\n        <h3>Your Claims</h3>\n        <p>\n            <asp:GridView ID=\"ClaimsGridView\" runat=\"server\" CellPadding=\"3\">\n                <AlternatingRowStyle BackColor=\"White\" />\n                <HeaderStyle BackColor=\"#7AC0DA\" ForeColor=\"White\" />\n            </asp:GridView>\n        </p>\n    </asp:Content>\n    ```\n\n    This step adds a GridView control to your *Default.aspx* page that will be populated with the claims retrieved from Forms authentication.\n\n2. Save the *Default.aspx* file, then open its code-behind file named *Default.aspx.cs*. Replace the existing code with the following:\n\n    ```csharp\n    using System;\n    using System.Web.UI;\n    using System.Security.Claims;\n\n    namespace TestApp\n    {\n        public partial class _Default : Page\n        {\n            protected void Page_Load(object sender, EventArgs e)\n            {\n                ClaimsPrincipal claimsPrincipal = Page.User as ClaimsPrincipal;\n\n                if (claimsPrincipal != null)\n                {\n                    this.ClaimsGridView.DataSource = claimsPrincipal.Claims;\n                    this.ClaimsGridView.DataBind();\n                }\n            }\n        }\n    }\n    ```\n\n    The above code will display claims about an authenticated user, including users identified by Forms authentication.\n\n## Step 3 – Test Your Solution\n\nIn this step you will test your ASP.NET Web Forms application, and verify that claims are presented when a user signs in with Forms authentication.\n\n#### To test your ASP.NET Web Forms application for claims using Forms authentication\n\n1. Press **F5** to build and run the application. You should be presented with *Default.aspx*, which has **Register** and **Log in** links in the top right of the page. Click **Register**.\n\n2. On the **Register** page, create a user account, and then click **Register**. Your account will be created using Forms authentication, and you will be automatically signed in.\n\n3. After you have been redirected to the home page, you should see a table beneath the **Your Claims** heading that includes the **Issuer**, **OriginalIssuer**, **Type**, **Value**, and **ValueType** claims information about your account.\n","nodes":[{"pos":[4,187],"embed":true,"restype":"x-metadata","content":"title: \"How To: Build Claims-Aware ASP.NET Application Using Forms-Based Authentication\"\nms.date: \"03/30/2017\"\nms.assetid: 98a3e029-1a9b-4e0c-b5d0-29d3f23f5b15\nauthor: \"BrucePerlerMS\"","nodes":[{"content":"How To: Build Claims-Aware ASP.NET Application Using Forms-Based Authentication","nodes":[{"pos":[0,79],"content":"How To: Build Claims-Aware ASP.NET Application Using Forms-Based Authentication","nodes":[{"content":"How To: Build Claims-Aware ASP.NET Application Using Forms-Based Authentication","pos":[0,79]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[195,274],"content":"How To: Build Claims-Aware ASP.NET Application Using Forms-Based Authentication","linkify":"How To: Build Claims-Aware ASP.NET Application Using Forms-Based Authentication","nodes":[{"content":"How To: Build Claims-Aware ASP.NET Application Using Forms-Based Authentication","pos":[0,79]}]},{"pos":[279,289],"content":"Applies To","linkify":"Applies To","nodes":[{"content":"Applies To","pos":[0,10]}]},{"content":"Microsoft® Windows® Identity Foundation (WIF)","pos":[293,338]},{"content":"ASP.NET® Web Forms","pos":[342,360]},{"pos":[365,372],"content":"Summary","linkify":"Summary","nodes":[{"content":"Summary","pos":[0,7]}]},{"content":"This How-To provides detailed step-by-step procedures for creating a simple claims-aware ASP.NET Web Forms application that uses Forms authentication.","pos":[374,524]},{"content":"It also provides instructions for how to test the application to verify that claims are presented when a user signs in with Forms authentication.","pos":[525,670]},{"pos":[675,683],"content":"Contents","linkify":"Contents","nodes":[{"content":"Contents","pos":[0,8]}]},{"content":"Objectives","pos":[687,697]},{"content":"Overview","pos":[701,709]},{"content":"Summary of Steps","pos":[713,729]},{"content":"Step 1 – Create a Simple ASP.NET Web Forms Application","pos":[733,787]},{"content":"Step 2 – Configure ASP.NET Web Forms Application for Claims Using Forms Authentication","pos":[791,877]},{"content":"Step 3 – Test Your Solution","pos":[881,908]},{"pos":[913,923],"content":"Objectives","linkify":"Objectives","nodes":[{"content":"Objectives","pos":[0,10]}]},{"content":"Configure an ASP.NET Web Forms application for claims using Forms authentication","pos":[927,1007]},{"content":"Test the ASP.NET Web Forms application to see if it is working properly","pos":[1011,1082]},{"pos":[1087,1095],"content":"Overview","linkify":"Overview","nodes":[{"content":"Overview","pos":[0,8]}]},{"content":"In .NET 4.5, WIF and its claims-based authorization have been included as an integral part of the Framework.","pos":[1097,1205]},{"content":"Previously, if you wanted claims from an ASP.NET user, you were required to install WIF, and then cast interfaces to Principal objects such as <ph id=\"ph1\">`Thread.CurrentPrincipal`</ph> or <ph id=\"ph2\">`HttpContext.Current.User`</ph>.","pos":[1206,1405],"source":" Previously, if you wanted claims from an ASP.NET user, you were required to install WIF, and then cast interfaces to Principal objects such as `Thread.CurrentPrincipal` or `HttpContext.Current.User`."},{"content":"Now, claims are served automatically by these Principal objects.","pos":[1406,1470]},{"content":"Forms authentication has benefited from WIF’s inclusion in .NET 4.5 because all users authenticated by Forms automatically have claims associated with them.","pos":[1472,1628]},{"content":"You can begin using these claims immediately in an ASP.NET application that uses Forms authentication, as this How-To demonstrates.","pos":[1629,1760]},{"pos":[1765,1781],"content":"Summary of Steps","linkify":"Summary of Steps","nodes":[{"content":"Summary of Steps","pos":[0,16]}]},{"content":"Step 1 – Create a Simple ASP.NET Web Forms Application","pos":[1785,1839]},{"content":"Step 2 – Configure ASP.NET Web Forms Application for Claims Using Forms Authentication","pos":[1843,1929]},{"content":"Step 3 – Test Your Solution","pos":[1933,1960]},{"pos":[1965,2019],"content":"Step 1 – Create a Simple ASP.NET Web Forms Application","linkify":"Step 1 – Create a Simple ASP.NET Web Forms Application","nodes":[{"content":"Step 1 – Create a Simple ASP.NET Web Forms Application","pos":[0,54]}]},{"content":"In this step, you will create a new ASP.NET Web Forms application.","pos":[2021,2087]},{"pos":[2094,2132],"content":"To create a simple ASP.NET application","linkify":"To create a simple ASP.NET application","nodes":[{"content":"To create a simple ASP.NET application","pos":[0,38]}]},{"pos":[2137,2207],"content":"Start Visual Studio and click <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>, and then <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"Start Visual Studio and click **File**, **New**, and then **Project**."},{"pos":[2212,2283],"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> window, click <bpt id=\"p2\">**</bpt>ASP.NET Web Forms Application<ept id=\"p2\">**</ept>.","source":"In the **New Project** window, click **ASP.NET Web Forms Application**."},{"pos":[2288,2334],"content":"In <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>, enter <ph id=\"ph1\">`TestApp`</ph> and press <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"In **Name**, enter `TestApp` and press **OK**."},{"pos":[2339,2425],"content":"Step 2 – Configure ASP.NET Web Forms Application for Claims Using Forms Authentication","linkify":"Step 2 – Configure ASP.NET Web Forms Application for Claims Using Forms Authentication","nodes":[{"content":"Step 2 – Configure ASP.NET Web Forms Application for Claims Using Forms Authentication","pos":[0,86]}]},{"pos":[2427,2592],"content":"In this step you will add a configuration entry to the <bpt id=\"p1\">*</bpt>Web.config<ept id=\"p1\">*</ept> configuration file and edit the <bpt id=\"p2\">*</bpt>Default.aspx<ept id=\"p2\">*</ept> file to display claims information for an account.","source":"In this step you will add a configuration entry to the *Web.config* configuration file and edit the *Default.aspx* file to display claims information for an account."},{"pos":[2599,2669],"content":"To configure ASP.NET application for claims using Forms authentication","linkify":"To configure ASP.NET application for claims using Forms authentication","nodes":[{"content":"To configure ASP.NET application for claims using Forms authentication","pos":[0,70]}]},{"pos":[2674,2749],"content":"In the <bpt id=\"p1\">*</bpt>Default.aspx<ept id=\"p1\">*</ept> file, replace the existing markup with the following:","source":"In the *Default.aspx* file, replace the existing markup with the following:"},{"pos":[3439,3576],"content":"This step adds a GridView control to your <bpt id=\"p1\">*</bpt>Default.aspx<ept id=\"p1\">*</ept> page that will be populated with the claims retrieved from Forms authentication.","source":"This step adds a GridView control to your *Default.aspx* page that will be populated with the claims retrieved from Forms authentication."},{"content":"Save the <bpt id=\"p1\">*</bpt>Default.aspx<ept id=\"p1\">*</ept> file, then open its code-behind file named <bpt id=\"p2\">*</bpt>Default.aspx.cs<ept id=\"p2\">*</ept>.","pos":[3581,3666],"source":"Save the *Default.aspx* file, then open its code-behind file named *Default.aspx.cs*."},{"content":"Replace the existing code with the following:","pos":[3667,3712]},{"content":"The above code will display claims about an authenticated user, including users identified by Forms authentication.","pos":[4302,4417]},{"pos":[4422,4449],"content":"Step 3 – Test Your Solution","linkify":"Step 3 – Test Your Solution","nodes":[{"content":"Step 3 – Test Your Solution","pos":[0,27]}]},{"content":"In this step you will test your ASP.NET Web Forms application, and verify that claims are presented when a user signs in with Forms authentication.","pos":[4451,4598]},{"pos":[4605,4685],"content":"To test your ASP.NET Web Forms application for claims using Forms authentication","linkify":"To test your ASP.NET Web Forms application for claims using Forms authentication","nodes":[{"content":"To test your ASP.NET Web Forms application for claims using Forms authentication","pos":[0,80]}]},{"content":"Press <bpt id=\"p1\">**</bpt>F5<ept id=\"p1\">**</ept> to build and run the application.","pos":[4690,4736],"source":"Press **F5** to build and run the application."},{"content":"You should be presented with <bpt id=\"p1\">*</bpt>Default.aspx<ept id=\"p1\">*</ept>, which has <bpt id=\"p2\">**</bpt>Register<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>Log in<ept id=\"p3\">**</ept> links in the top right of the page.","pos":[4737,4855],"source":" You should be presented with *Default.aspx*, which has **Register** and **Log in** links in the top right of the page."},{"content":"Click <bpt id=\"p1\">**</bpt>Register<ept id=\"p1\">**</ept>.","pos":[4856,4875],"source":" Click **Register**."},{"content":"On the <bpt id=\"p1\">**</bpt>Register<ept id=\"p1\">**</ept> page, create a user account, and then click <bpt id=\"p2\">**</bpt>Register<ept id=\"p2\">**</ept>.","pos":[4880,4957],"source":"On the **Register** page, create a user account, and then click **Register**."},{"content":"Your account will be created using Forms authentication, and you will be automatically signed in.","pos":[4958,5055]},{"pos":[5060,5295],"content":"After you have been redirected to the home page, you should see a table beneath the <bpt id=\"p1\">**</bpt>Your Claims<ept id=\"p1\">**</ept> heading that includes the <bpt id=\"p2\">**</bpt>Issuer<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>OriginalIssuer<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Type<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>Value<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>ValueType<ept id=\"p6\">**</ept> claims information about your account.","source":"After you have been redirected to the home page, you should see a table beneath the **Your Claims** heading that includes the **Issuer**, **OriginalIssuer**, **Type**, **Value**, and **ValueType** claims information about your account."}]}