{"content":"---\ntitle: \"OLE DB, ODBC, and Oracle Connection Pooling | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 2bd83b1e-3ea9-43c4-bade-d9cdb9bbbb04\ncaps.latest.revision: 3\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# OLE DB, ODBC, and Oracle Connection Pooling\nPooling connections can significantly enhance the performance and scalability of your application. This section discusses connection pooling for the .NET Framework data providers for OLE DB, ODBC and Oracle.  \n  \n## Connection Pooling for OleDb  \n The .NET Framework Data Provider for OLE DB automatically pools connections using OLE DB session pooling. Connection string arguments can be used to enable or disable OLE DB services including pooling. For example, the following connection string disables OLE DB session pooling and automatic transaction enlistment.  \n  \n```  \nProvider=SQLOLEDB;OLE DB Services=-4;Data Source=localhost;Integrated Security=SSPI;  \n```  \n  \n We recommend that you always close or dispose of a connection when you are finished using it in order to return the connection to the pool. Connections that are not explicitly closed may not get returned to the pool. For example, a connection that has gone out of scope but that has not been explicitly closed will only be returned to the connection pool if the maximum pool size has been reached and the connection is still valid.  \n  \n For more information about OLE DB session or resource pooling, as well as how to disable pooling by overriding OLE DB provider service defaults, see the [OLE DB Programmer's Guide](http://go.microsoft.com/fwlink/?linkid=45232) in the MSDN library.  \n  \n## Connection Pooling for Odbc  \n Connection pooling for the .NET Framework Data Provider for ODBC is managed by the ODBC Driver Manager that is used for the connection, and is not affected by the .NET Framework Data Provider for ODBC.  \n  \n To enable or disable connection pooling, open **ODBC Data Source Administrator** in the Administrative Tools folder of Control Panel. The **Connection Pooling** tab allows you to specify connection pooling parameters for each ODBC driver installed. Note that connection pooling changes for a specific ODBC driver affect all applications that use that ODBC driver.  \n  \n For more information on ODBC connection pooling, see [INFO: Frequently Asked Questions About ODBC Connection Pooling](http://support.microsoft.com/kb/169470) in the MSDN library.  \n  \n## Connection Pooling for OracleClient  \n The .NET Framework Data Provider for Oracle provides connection pooling automatically for your ADO.NET client application. You can also supply several connection string modifiers to control connection pooling behavior (see \"Controlling Connection Pooling with Connection String Keywords,\" later in this topic).  \n  \n### Pool Creation and Assignment  \n When a connection is opened, a connection pool is created based on an exact matching algorithm that associates the pool with the connection string in the connection. Each connection pool is associated with a distinct connection string. When a new connection is opened, if the connection string is not an exact match to an existing pool, a new pool is created.  \n  \n Once created, connection pools are not destroyed until the active process ends. Maintaining inactive or empty pools uses very few system resources.  \n  \n### Connection Addition  \n A connection pool is created for each unique connection string. When a pool is created, multiple connection objects are created and added to the pool so that the minimum pool size requirement is satisfied. Connections are added to the pool as needed, up to the maximum pool size.  \n  \n When an <xref:System.Data.OracleClient.OracleConnection> object is requested, it is obtained from the pool if a usable connection is available. To be usable, the connection must currently be unused, have a matching transaction context or not be associated with any transaction context, and have a valid link to the server.  \n  \n If the maximum pool size has been reached and no usable connection is available, the request is queued. The connection pooler satisfies these requests by reallocating connections as they are released back into the pool. Connections are released back into the pool when they are closed or disposed.  \n  \n### Connection Removal  \n The connection pooler removes a connection from the pool after it has been idle for an extended period of time, or if the pooler detects that the connection with the server has been severed. Note that this can be detected only after attempting to communicate with the server. If a connection is found that is no longer connected to the server, it is marked as invalid. The connection pooler periodically scans connection pools looking for objects that have been released to the pool and are marked as invalid. These connections are then permanently removed.  \n  \n If a connection exists to a server that has disappeared, this connection can be drawn from the pool if the connection pooler has not detected the severed connection and marked it as invalid. When this occurs, an exception is generated. However, you must still close the connection in order to release it back into the pool.  \n  \n Do not call `Close` or `Dispose` on a `Connection`, a `DataReader`, or any other managed object in the `Finalize` method of your class. In a finalizer, only release unmanaged resources that your class owns directly. If your class does not own any unmanaged resources, do not include a `Finalize` method in your class definition. For more information, see [Garbage Collection](../../../../docs/standard/garbage-collection/index.md).  \n  \n### Transaction Support  \n Connections are drawn from the pool and assigned based on transaction context. The context of the requesting thread and the assigned connection must match. Therefore, each connection pool is actually subdivided into connections with no transaction context associated with them, and into *N* subdivisions that each contain connections with a particular transaction context.  \n  \n When a connection is closed, it is released back into the pool and into the appropriate subdivision based on its transaction context. Therefore, you can close the connection without generating an error, even though a distributed transaction is still pending. This allows you to commit or abort the distributed transaction at a later time.  \n  \n### Controlling Connection Pooling with Connection String Keywords  \n The <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> property of the <xref:System.Data.OracleClient.OracleConnection> object supports connection string key/value pairs that can be used to adjust the behavior of the connection pooling logic.  \n  \n The following table describes the <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> values you can use to adjust connection pooling behavior.  \n  \n|Name|Default|Description|  \n|----------|-------------|-----------------|  \n|`Connection Lifetime`|0|When a connection is returned to the pool, its creation time is compared with the current time, and the connection is destroyed if that time span (in seconds) exceeds the value specified by `Connection Lifetime`. This is useful in clustered configurations to force load balancing between a running server and a server just brought online.<br /><br /> A value of zero (0) will cause pooled connections to have the maximum time-out.|  \n|`Enlist`|'true'|When `true`, the pooler automatically enlists the connection in the current transaction context of the creation thread if a transaction context exists.|  \n|`Max Pool Size`|100|The maximum number of connections allowed in the pool.|  \n|`Min Pool Size`|0|The minimum number of connections maintained in the pool.|  \n|`Pooling`|'true'|When `true`, the connection is drawn from the appropriate pool, or if necessary, created and added to the appropriate pool.|  \n  \n## See Also  \n [Connection Pooling](../../../../docs/framework/data/adonet/connection-pooling.md)   \n [Performance Counters](../../../../docs/framework/data/adonet/performance-counters.md)   \n [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)","nodes":[{"pos":[12,72],"content":"OLE DB, ODBC, and Oracle Connection Pooling | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"OLE DB, ODBC, and Oracle Connection Pooling | Microsoft Docs","pos":[0,60]}]},{"pos":[381,424],"content":"OLE DB, ODBC, and Oracle Connection Pooling","linkify":"OLE DB, ODBC, and Oracle Connection Pooling","nodes":[{"content":"OLE DB, ODBC, and Oracle Connection Pooling","pos":[0,43]}]},{"content":"Pooling connections can significantly enhance the performance and scalability of your application.","pos":[425,523]},{"content":"This section discusses connection pooling for the .NET Framework data providers for OLE DB, ODBC and Oracle.","pos":[524,632]},{"pos":[641,669],"content":"Connection Pooling for OleDb","linkify":"Connection Pooling for OleDb","nodes":[{"content":"Connection Pooling for OleDb","pos":[0,28]}]},{"content":"The .NET Framework Data Provider for OLE DB automatically pools connections using OLE DB session pooling.","pos":[673,778]},{"content":"Connection string arguments can be used to enable or disable OLE DB services including pooling.","pos":[779,874]},{"content":"For example, the following connection string disables OLE DB session pooling and automatic transaction enlistment.","pos":[875,989]},{"content":"We recommend that you always close or dispose of a connection when you are finished using it in order to return the connection to the pool.","pos":[1098,1237]},{"content":"Connections that are not explicitly closed may not get returned to the pool.","pos":[1238,1314]},{"content":"For example, a connection that has gone out of scope but that has not been explicitly closed will only be returned to the connection pool if the maximum pool size has been reached and the connection is still valid.","pos":[1315,1529]},{"pos":[1536,1783],"content":"For more information about OLE DB session or resource pooling, as well as how to disable pooling by overriding OLE DB provider service defaults, see the <bpt id=\"p1\">[</bpt>OLE DB Programmer's Guide<ept id=\"p1\">](http://go.microsoft.com/fwlink/?linkid=45232)</ept> in the MSDN library.","source":"For more information about OLE DB session or resource pooling, as well as how to disable pooling by overriding OLE DB provider service defaults, see the [OLE DB Programmer's Guide](http://go.microsoft.com/fwlink/?linkid=45232) in the MSDN library."},{"pos":[1792,1819],"content":"Connection Pooling for Odbc","linkify":"Connection Pooling for Odbc","nodes":[{"content":"Connection Pooling for Odbc","pos":[0,27]}]},{"content":"Connection pooling for the .NET Framework Data Provider for ODBC is managed by the ODBC Driver Manager that is used for the connection, and is not affected by the .NET Framework Data Provider for ODBC.","pos":[1823,2024]},{"content":"To enable or disable connection pooling, open <bpt id=\"p1\">**</bpt>ODBC Data Source Administrator<ept id=\"p1\">**</ept> in the Administrative Tools folder of Control Panel.","pos":[2031,2164],"source":"To enable or disable connection pooling, open **ODBC Data Source Administrator** in the Administrative Tools folder of Control Panel."},{"content":"The <bpt id=\"p1\">**</bpt>Connection Pooling<ept id=\"p1\">**</ept> tab allows you to specify connection pooling parameters for each ODBC driver installed.","pos":[2165,2279],"source":" The **Connection Pooling** tab allows you to specify connection pooling parameters for each ODBC driver installed."},{"content":"Note that connection pooling changes for a specific ODBC driver affect all applications that use that ODBC driver.","pos":[2280,2394]},{"pos":[2401,2579],"content":"For more information on ODBC connection pooling, see <bpt id=\"p1\">[</bpt>INFO: Frequently Asked Questions About ODBC Connection Pooling<ept id=\"p1\">](http://support.microsoft.com/kb/169470)</ept> in the MSDN library.","source":"For more information on ODBC connection pooling, see [INFO: Frequently Asked Questions About ODBC Connection Pooling](http://support.microsoft.com/kb/169470) in the MSDN library."},{"pos":[2588,2623],"content":"Connection Pooling for OracleClient","linkify":"Connection Pooling for OracleClient","nodes":[{"content":"Connection Pooling for OracleClient","pos":[0,35]}]},{"content":"The .NET Framework Data Provider for Oracle provides connection pooling automatically for your ADO.NET client application.","pos":[2627,2749]},{"content":"You can also supply several connection string modifiers to control connection pooling behavior (see \"Controlling Connection Pooling with Connection String Keywords,\" later in this topic).","pos":[2750,2937]},{"pos":[2947,2975],"content":"Pool Creation and Assignment","linkify":"Pool Creation and Assignment","nodes":[{"content":"Pool Creation and Assignment","pos":[0,28]}]},{"content":"When a connection is opened, a connection pool is created based on an exact matching algorithm that associates the pool with the connection string in the connection.","pos":[2979,3144]},{"content":"Each connection pool is associated with a distinct connection string.","pos":[3145,3214]},{"content":"When a new connection is opened, if the connection string is not an exact match to an existing pool, a new pool is created.","pos":[3215,3338]},{"content":"Once created, connection pools are not destroyed until the active process ends.","pos":[3345,3424]},{"content":"Maintaining inactive or empty pools uses very few system resources.","pos":[3425,3492]},{"pos":[3502,3521],"content":"Connection Addition","linkify":"Connection Addition","nodes":[{"content":"Connection Addition","pos":[0,19]}]},{"content":"A connection pool is created for each unique connection string.","pos":[3525,3588]},{"content":"When a pool is created, multiple connection objects are created and added to the pool so that the minimum pool size requirement is satisfied.","pos":[3589,3730]},{"content":"Connections are added to the pool as needed, up to the maximum pool size.","pos":[3731,3804]},{"content":"When an <ph id=\"ph1\">&lt;xref:System.Data.OracleClient.OracleConnection&gt;</ph> object is requested, it is obtained from the pool if a usable connection is available.","pos":[3811,3954],"source":"When an <xref:System.Data.OracleClient.OracleConnection> object is requested, it is obtained from the pool if a usable connection is available."},{"content":"To be usable, the connection must currently be unused, have a matching transaction context or not be associated with any transaction context, and have a valid link to the server.","pos":[3955,4133]},{"content":"If the maximum pool size has been reached and no usable connection is available, the request is queued.","pos":[4140,4243]},{"content":"The connection pooler satisfies these requests by reallocating connections as they are released back into the pool.","pos":[4244,4359]},{"content":"Connections are released back into the pool when they are closed or disposed.","pos":[4360,4437]},{"pos":[4447,4465],"content":"Connection Removal","linkify":"Connection Removal","nodes":[{"content":"Connection Removal","pos":[0,18]}]},{"content":"The connection pooler removes a connection from the pool after it has been idle for an extended period of time, or if the pooler detects that the connection with the server has been severed.","pos":[4469,4659]},{"content":"Note that this can be detected only after attempting to communicate with the server.","pos":[4660,4744]},{"content":"If a connection is found that is no longer connected to the server, it is marked as invalid.","pos":[4745,4837]},{"content":"The connection pooler periodically scans connection pools looking for objects that have been released to the pool and are marked as invalid.","pos":[4838,4978]},{"content":"These connections are then permanently removed.","pos":[4979,5026]},{"content":"If a connection exists to a server that has disappeared, this connection can be drawn from the pool if the connection pooler has not detected the severed connection and marked it as invalid.","pos":[5033,5223]},{"content":"When this occurs, an exception is generated.","pos":[5224,5268]},{"content":"However, you must still close the connection in order to release it back into the pool.","pos":[5269,5356]},{"content":"Do not call <ph id=\"ph1\">`Close`</ph> or <ph id=\"ph2\">`Dispose`</ph> on a <ph id=\"ph3\">`Connection`</ph>, a <ph id=\"ph4\">`DataReader`</ph>, or any other managed object in the <ph id=\"ph5\">`Finalize`</ph> method of your class.","pos":[5363,5498],"source":"Do not call `Close` or `Dispose` on a `Connection`, a `DataReader`, or any other managed object in the `Finalize` method of your class."},{"content":"In a finalizer, only release unmanaged resources that your class owns directly.","pos":[5499,5578]},{"content":"If your class does not own any unmanaged resources, do not include a <ph id=\"ph1\">`Finalize`</ph> method in your class definition.","pos":[5579,5691],"source":" If your class does not own any unmanaged resources, do not include a `Finalize` method in your class definition."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Garbage Collection<ept id=\"p1\">](../../../../docs/standard/garbage-collection/index.md)</ept>.","pos":[5692,5794],"source":" For more information, see [Garbage Collection](../../../../docs/standard/garbage-collection/index.md)."},{"pos":[5804,5823],"content":"Transaction Support","linkify":"Transaction Support","nodes":[{"content":"Transaction Support","pos":[0,19]}]},{"content":"Connections are drawn from the pool and assigned based on transaction context.","pos":[5827,5905]},{"content":"The context of the requesting thread and the assigned connection must match.","pos":[5906,5982]},{"content":"Therefore, each connection pool is actually subdivided into connections with no transaction context associated with them, and into <bpt id=\"p1\">*</bpt>N<ept id=\"p1\">*</ept> subdivisions that each contain connections with a particular transaction context.","pos":[5983,6199],"source":" Therefore, each connection pool is actually subdivided into connections with no transaction context associated with them, and into *N* subdivisions that each contain connections with a particular transaction context."},{"content":"When a connection is closed, it is released back into the pool and into the appropriate subdivision based on its transaction context.","pos":[6206,6339]},{"content":"Therefore, you can close the connection without generating an error, even though a distributed transaction is still pending.","pos":[6340,6464]},{"content":"This allows you to commit or abort the distributed transaction at a later time.","pos":[6465,6544]},{"pos":[6554,6616],"content":"Controlling Connection Pooling with Connection String Keywords","linkify":"Controlling Connection Pooling with Connection String Keywords","nodes":[{"content":"Controlling Connection Pooling with Connection String Keywords","pos":[0,62]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Data.OracleClient.OracleConnection&gt;</ph> object supports connection string key/value pairs that can be used to adjust the behavior of the connection pooling logic.","pos":[6620,6880],"source":"The <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> property of the <xref:System.Data.OracleClient.OracleConnection> object supports connection string key/value pairs that can be used to adjust the behavior of the connection pooling logic."},{"content":"The following table describes the <ph id=\"ph1\">&lt;xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A&gt;</ph> values you can use to adjust connection pooling behavior.","pos":[6887,7047],"source":"The following table describes the <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> values you can use to adjust connection pooling behavior."},{"content":"Name","pos":[7054,7058]},{"content":"Default","pos":[7059,7066]},{"content":"Description","pos":[7067,7078]},{"content":"0","pos":[7152,7153]},{"content":"When a connection is returned to the pool, its creation time is compared with the current time, and the connection is destroyed if that time span (in seconds) exceeds the value specified by <ph id=\"ph1\">`Connection Lifetime`</ph>.","pos":[7154,7366],"source":"When a connection is returned to the pool, its creation time is compared with the current time, and the connection is destroyed if that time span (in seconds) exceeds the value specified by `Connection Lifetime`."},{"content":"This is useful in clustered configurations to force load balancing between a running server and a server just brought online.","pos":[7367,7492]},{"content":"A value of zero (0) will cause pooled connections to have the maximum time-out.","pos":[7505,7584]},{"content":"'true'","pos":[7598,7604]},{"pos":[7605,7756],"content":"When <ph id=\"ph1\">`true`</ph>, the pooler automatically enlists the connection in the current transaction context of the creation thread if a transaction context exists.","source":"When `true`, the pooler automatically enlists the connection in the current transaction context of the creation thread if a transaction context exists."},{"content":"100","pos":[7777,7780]},{"content":"The maximum number of connections allowed in the pool.","pos":[7781,7835]},{"content":"0","pos":[7856,7857]},{"content":"The minimum number of connections maintained in the pool.","pos":[7858,7915]},{"content":"'true'","pos":[7930,7936]},{"pos":[7937,8060],"content":"When <ph id=\"ph1\">`true`</ph>, the connection is drawn from the appropriate pool, or if necessary, created and added to the appropriate pool.","source":"When `true`, the connection is drawn from the appropriate pool, or if necessary, created and added to the appropriate pool."},{"pos":[8070,8078],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Connection Pooling<ept id=\"p1\">](../../../../docs/framework/data/adonet/connection-pooling.md)</ept><ph id=\"ph1\"> </ph>","pos":[8082,8165],"source":"[Connection Pooling](../../../../docs/framework/data/adonet/connection-pooling.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Performance Counters<ept id=\"p1\">](../../../../docs/framework/data/adonet/performance-counters.md)</ept><ph id=\"ph1\"> </ph>","pos":[8168,8256],"source":" [Performance Counters](../../../../docs/framework/data/adonet/performance-counters.md) "},{"content":"<bpt id=\"p1\"> [</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=217917)</ept>","pos":[8259,8363],"source":" [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)"}]}