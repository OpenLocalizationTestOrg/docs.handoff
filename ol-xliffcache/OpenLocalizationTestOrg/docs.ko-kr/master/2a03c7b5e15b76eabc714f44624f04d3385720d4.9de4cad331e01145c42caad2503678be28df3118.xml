{"content":"---\ntitle: \"Workflow Hosting Options\"\nms.date: \"03/30/2017\"\nms.assetid: 37bcd668-9c5c-4e7c-81da-a1f1b3a16514\n---\n# Workflow Hosting Options\nMost of the Windows Workflow Foundation (WF) samples use workflows that are hosted in a console application, but this isn't a realistic scenario for real-world workflows. Workflows in actual business applications will be hosted in persistent processes- either a Windows service authored by the developer, or a server application such as [!INCLUDE[iisver](../../../includes/iisver-md.md)] or AppFabric. The differences between these approaches are as follows.  \n  \n## Hosting workflows in IIS with Windows AppFabric  \n Using IIS with AppFabric is the preferred host for workflows. The host application for workflows using AppFabric is Windows Activation Service, which removes the dependency on HTTP over IIS alone.  \n  \n## Hosting workflows in IIS alone  \n Using [!INCLUDE[iisver](../../../includes/iisver-md.md)] alone is not recommended, as there are management and monitoring tools available with AppFabric that facilitate maintenance of running applications. Workflows should only be hosted in [!INCLUDE[iisver](../../../includes/iisver-md.md)] alone if there are infrastructure concerns with moving to AppFabric.  \n  \n> [!WARNING]\n>  [!INCLUDE[iisver](../../../includes/iisver-md.md)] recycles application pools periodically for various reasons. When an application pool is recycled, IIS stops accepting messages to the old pool, and instantiates a new application pool to accept new requests. If a workflow continues working after sending a response, [!INCLUDE[iisver](../../../includes/iisver-md.md)] will not be aware of the work being done, and may recycle the hosting application pool. If this happens, the workflow will abort, and tracking services will record a [1004 - WorkflowInstanceAborted](1004-workflowinstanceaborted.md) message with an empty Reason field.  \n>   \n>  If persistence is used, the host must explicitly restart aborted instances from the last persistence point.  \n>   \n>  If AppFabric is used, the workflow management service will eventually resume the workflow from the last successful persistence point if persistence is used. If no persistence is used, and the workflow performs operations outside a Request/Response pattern, data will be lost when the workflow aborts.  \n  \n## Hosting a workflow in a custom Windows Service  \n Creating a custom workflow service to host the workflow will require the developer to duplicate a lot of the functionality provided out-of-box by AppFabric, but will allow for more flexibility with custom functionality. This option should only be considered if AppFabric proves to not be an option.\n","nodes":[{"pos":[4,108],"embed":true,"restype":"x-metadata","content":"title: \"Workflow Hosting Options\"\nms.date: \"03/30/2017\"\nms.assetid: 37bcd668-9c5c-4e7c-81da-a1f1b3a16514","nodes":[{"content":"Workflow Hosting Options","nodes":[{"pos":[0,24],"content":"Workflow Hosting Options","nodes":[{"content":"Workflow Hosting Options","pos":[0,24]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[115,139],"content":"Workflow Hosting Options","linkify":"Workflow Hosting Options","nodes":[{"content":"Workflow Hosting Options","pos":[0,24]}]},{"content":"Most of the Windows Workflow Foundation (WF) samples use workflows that are hosted in a console application, but this isn't a realistic scenario for real-world workflows.","pos":[140,310]},{"content":"Workflows in actual business applications will be hosted in persistent processes- either a Windows service authored by the developer, or a server application such as <ph id=\"ph1\">[!INCLUDE[iisver](../../../includes/iisver-md.md)]</ph> or AppFabric.","pos":[311,541],"source":" Workflows in actual business applications will be hosted in persistent processes- either a Windows service authored by the developer, or a server application such as [!INCLUDE[iisver](../../../includes/iisver-md.md)] or AppFabric."},{"content":"The differences between these approaches are as follows.","pos":[542,598]},{"pos":[607,654],"content":"Hosting workflows in IIS with Windows AppFabric","linkify":"Hosting workflows in IIS with Windows AppFabric","nodes":[{"content":"Hosting workflows in IIS with Windows AppFabric","pos":[0,47]}]},{"content":"Using IIS with AppFabric is the preferred host for workflows.","pos":[658,719]},{"content":"The host application for workflows using AppFabric is Windows Activation Service, which removes the dependency on HTTP over IIS alone.","pos":[720,854]},{"pos":[863,893],"content":"Hosting workflows in IIS alone","linkify":"Hosting workflows in IIS alone","nodes":[{"content":"Hosting workflows in IIS alone","pos":[0,30]}]},{"content":"Using <ph id=\"ph1\">[!INCLUDE[iisver](../../../includes/iisver-md.md)]</ph> alone is not recommended, as there are management and monitoring tools available with AppFabric that facilitate maintenance of running applications.","pos":[897,1102],"source":"Using [!INCLUDE[iisver](../../../includes/iisver-md.md)] alone is not recommended, as there are management and monitoring tools available with AppFabric that facilitate maintenance of running applications."},{"content":"Workflows should only be hosted in <ph id=\"ph1\">[!INCLUDE[iisver](../../../includes/iisver-md.md)]</ph> alone if there are infrastructure concerns with moving to AppFabric.","pos":[1103,1257],"source":" Workflows should only be hosted in [!INCLUDE[iisver](../../../includes/iisver-md.md)] alone if there are infrastructure concerns with moving to AppFabric."},{"pos":[1265,1915],"content":"[!WARNING]\n [!INCLUDE[iisver](../../../includes/iisver-md.md)] recycles application pools periodically for various reasons. When an application pool is recycled, IIS stops accepting messages to the old pool, and instantiates a new application pool to accept new requests. If a workflow continues working after sending a response, [!INCLUDE[iisver](../../../includes/iisver-md.md)] will not be aware of the work being done, and may recycle the hosting application pool. If this happens, the workflow will abort, and tracking services will record a [1004 - WorkflowInstanceAborted](1004-workflowinstanceaborted.md) message with an empty Reason field.","leadings":["","> "],"nodes":[{"content":"[!INCLUDE[iisver](../../../includes/iisver-md.md)] recycles application pools periodically for various reasons. When an application pool is recycled, IIS stops accepting messages to the old pool, and instantiates a new application pool to accept new requests. If a workflow continues working after sending a response, [!INCLUDE[iisver](../../../includes/iisver-md.md)] will not be aware of the work being done, and may recycle the hosting application pool. If this happens, the workflow will abort, and tracking services will record a [1004 - WorkflowInstanceAborted](1004-workflowinstanceaborted.md) message with an empty Reason field.","pos":[12,648],"nodes":[{"content":"<ph id=\"ph1\">[!INCLUDE[iisver](../../../includes/iisver-md.md)]</ph> recycles application pools periodically for various reasons.","pos":[0,111],"source":"[!INCLUDE[iisver](../../../includes/iisver-md.md)] recycles application pools periodically for various reasons."},{"content":"When an application pool is recycled, IIS stops accepting messages to the old pool, and instantiates a new application pool to accept new requests.","pos":[112,259]},{"content":"If a workflow continues working after sending a response, <ph id=\"ph1\">[!INCLUDE[iisver](../../../includes/iisver-md.md)]</ph> will not be aware of the work being done, and may recycle the hosting application pool.","pos":[260,456],"source":" If a workflow continues working after sending a response, [!INCLUDE[iisver](../../../includes/iisver-md.md)] will not be aware of the work being done, and may recycle the hosting application pool."},{"content":"If this happens, the workflow will abort, and tracking services will record a <bpt id=\"p1\">[</bpt>1004 - WorkflowInstanceAborted<ept id=\"p1\">](1004-workflowinstanceaborted.md)</ept> message with an empty Reason field.","pos":[457,636],"source":" If this happens, the workflow will abort, and tracking services will record a [1004 - WorkflowInstanceAborted](1004-workflowinstanceaborted.md) message with an empty Reason field."}]}]},{"content":"If persistence is used, the host must explicitly restart aborted instances from the last persistence point.","pos":[1926,2033]},{"content":"If AppFabric is used, the workflow management service will eventually resume the workflow from the last successful persistence point if persistence is used.","pos":[2044,2200]},{"content":"If no persistence is used, and the workflow performs operations outside a Request/Response pattern, data will be lost when the workflow aborts.","pos":[2201,2344]},{"pos":[2353,2399],"content":"Hosting a workflow in a custom Windows Service","linkify":"Hosting a workflow in a custom Windows Service","nodes":[{"content":"Hosting a workflow in a custom Windows Service","pos":[0,46]}]},{"content":"Creating a custom workflow service to host the workflow will require the developer to duplicate a lot of the functionality provided out-of-box by AppFabric, but will allow for more flexibility with custom functionality.","pos":[2403,2622]},{"content":"This option should only be considered if AppFabric proves to not be an option.","pos":[2623,2701]}]}