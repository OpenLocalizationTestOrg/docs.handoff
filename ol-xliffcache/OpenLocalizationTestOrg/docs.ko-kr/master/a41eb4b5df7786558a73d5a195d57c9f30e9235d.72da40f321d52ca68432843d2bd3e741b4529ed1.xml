{"content":"---\ntitle: \"LINQ Considerations (WCF Data Services)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"WCF Data Services, LINQ\"\n  - \"querying the data service [WCF Data Services]\"\n  - \"WCF Data Services, querying\"\nms.assetid: cc4ec9e9-348f-42a6-a78e-1cd40e370656\n---\n# LINQ Considerations (WCF Data Services)\nThis topic provides information about the way in which LINQ queries are composed and executed when you are using the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client and limitations of using LINQ to query a data service that implements the [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)]. For more information about composing and executing queries against an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]-based data service, see [Querying the Data Service](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md).  \n  \n## Composing LINQ Queries  \n LINQ enables you to compose queries against a collection of objects that implements <xref:System.Collections.Generic.IEnumerable%601>. Both the **Add Service Reference** dialog box in Visual Studio and the DataSvcUtil.exe tool are used to generate a representation of an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service as an entity container class that inherits from <xref:System.Data.Services.Client.DataServiceContext>, as well as objects that represent the entities returned in feeds. These tools also generate properties on the entity container class for the collections that are exposed as feeds by the service. Each of these properties of the class that encapsulates the data service return a <xref:System.Data.Services.Client.DataServiceQuery%601>. Because the <xref:System.Data.Services.Client.DataServiceQuery%601> class implements the <xref:System.Linq.IQueryable%601> interface defined by LINQ, you can compose a LINQ query against feeds exposed by the data service, which are translated by the client library into a query request URI that is sent to the data service on execution.  \n  \n> [!IMPORTANT]\n>  The set of queries expressible in the LINQ syntax is broader than those enabled in the URI syntax that is used by [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] data services. A <xref:System.NotSupportedException> is raised when the query cannot be mapped to a URI in the target data service. For more information, see the [Unsupported LINQ Methods](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md#unsupportedMethods) in this topic.  \n  \n The following example is a LINQ query that returns `Orders` that have a freight cost of more than $30 and sorts the results by the shipping date, starting with the latest ship date:  \n  \n[!code-csharp[Astoria Northwind Client#AddQueryOptionsLinqSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#addqueryoptionslinqspecific)]      \n[!code-vb[Astoria Northwind Client#AddQueryOptionsLinqSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#addqueryoptionslinqspecific)]    \n  \n This LINQ query is translated into the following query URI that is executed against the Northwind-based [quickstart](../../../../docs/framework/data/wcf/quickstart-wcf-data-services.md) data service:  \n  \n```  \nhttp://localhost:12345/Northwind.svc/Orders?Orderby=ShippedDate&?filter=Freight gt 30  \n```  \n  \n For more general information about LINQ, see [Language-Integrated Query (LINQ) - C#](../../../csharp/programming-guide/concepts/linq/index.md) or [Language-Integrated Query (LINQ) - Visual Basic](../../../visual-basic/programming-guide/concepts/linq/index.md).  \n  \n LINQ enables you to compose queries by using both the language-specific declarative query syntax, shown in the previous example, as well as a set of query methods known as standard query operators. An equivalent query to the previous example can be composed by using only the method-based syntax, as shown the following example:  \n  \n[!code-csharp[Astoria Northwind Client#AddQueryOptionsLinqExpressionSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#addqueryoptionslinqexpressionspecific)]      \n[!code-vb[Astoria Northwind Client#AddQueryOptionsLinqExpressionSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#addqueryoptionslinqexpressionspecific)]    \n  \n The [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client is able to translate both kinds of composed queries into a query URI, and you can extend a LINQ query by appending query methods to a query expression. When you compose LINQ queries by appending method syntax to a query expression or a <xref:System.Data.Services.Client.DataServiceQuery%601>, the operations are added to the query URI in the order in which methods are called. This is equivalent to calling the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method to add each query option to the query URI.  \n  \n## Executing LINQ Queries  \n Certain LINQ query methods, such as <xref:System.Linq.Enumerable.First%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%29> or <xref:System.Linq.Enumerable.Single%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%29>, when appended to the query, cause the query to be executed. A query is also executed when results are enumerated implicitly, such as during a `foreach` loop or when the query is assigned to a `List` collection. For more information, see [Querying the Data Service](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md).  \n  \n The client executes a LINQ query in two parts. Whenever possible, LINQ expressions in a query are first evaluated on the client, and then a URI-based query is generated and sent to the data service for evaluation against data in the service. For more information, see the section [Client versus Server Execution](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md#executingQueries) in [Querying the Data Service](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md).  \n  \n When a LINQ query cannot be translated in an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]-compliant query URI, an exception is raised when execution is attempted. For more information, see [Querying the Data Service](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md).  \n  \n## LINQ Query Examples  \n The examples in the following sections demonstrate the kinds of LINQ queries that can be executed against an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service.  \n  \n<a name=\"filtering\"></a>   \n### Filtering  \n The LINQ query examples in this section filter data in the feed returned by the service.  \n  \n The following examples are equivalent queries that filter the returned `Orders` entities so that only orders with a freight cost greater than $30 are returned:  \n  \n-   Using LINQ query syntax:  \n  \n[!code-csharp[Astoria Northwind Client#LinqWhereClauseSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#linqwhereclausespecific)]      \n[!code-vb[Astoria Northwind Client#LinqWhereClauseSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#linqwhereclausespecific)]     \n  \n-   Using LINQ query methods:  \n  \n[!code-csharp[Astoria Northwind Client#LinqWhereMethodSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#linqwheremethodspecific)]      \n[!code-vb[Astoria Northwind Client#LinqWhereMethodSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#linqwheremethodspecific)]       \n  \n-   The URI query string `$filter` option:  \n  \n[!code-csharp[Astoria Northwind Client#ExplicitQueryWhereMethodSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#explicitquerywheremethodspecific)]      \n[!code-vb[Astoria Northwind Client#ExplicitQueryWhereMethodSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#explicitquerywheremethodspecific)]       \n  \n All of the previous examples are translated to the query URI: `http://localhost:12345/northwind.svc/Orders()?$filter=Freight gt 30M`.  \n  \n<a name=\"sorting\"></a>   \n### Sorting  \n The following examples show equivalent queries that sort returned data both by the company name and by postal code, descending:  \n  \n-   Using LINQ query syntax:  \n  \n[!code-csharp[Astoria Northwind Client#LinqOrderByClauseSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#linqorderbyclausespecific)]      \n[!code-vb[Astoria Northwind Client#LinqOrderByClauseSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#linqorderbyclausespecific)]        \n  \n-   Using LINQ query methods:  \n  \n[!code-csharp[Astoria Northwind Client#LinqOrderByMethodSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#linqorderbymethodspecific)]      \n[!code-vb[Astoria Northwind Client#LinqOrderByMethodSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#linqorderbymethodspecific)]        \n  \n-   URI query string `$orderby` option):  \n  \n[!code-csharp[Astoria Northwind Client#ExplicitQueryOrderByMethodSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#explicitqueryorderbymethodspecific)]      \n[!code-vb[Astoria Northwind Client#ExplicitQueryOrderByMethodSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#explicitqueryorderbymethodspecific)]         \n  \n All of the previous examples are translated to the query URI: `http://localhost:12345/northwind.svc/Customers()?$orderby=CompanyName,PostalCode desc`.  \n  \n<a name=\"projection\"></a>   \n### Projection  \n The following examples show equivalent queries that project returned data into the narrower `CustomerAddress` type:  \n  \n-   Using LINQ query syntax:  \n  \n[!code-csharp[Astoria Northwind Client#LinqSelectClauseSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#linqselectclausespecific)]      \n[!code-vb[Astoria Northwind Client#LinqSelectClauseSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#linqselectclausespecific)]         \n  \n-   Using LINQ query methods:  \n  \n[!code-csharp[Astoria Northwind Client#LinqSelectMethodSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#linqselectmethodspecific)]      \n[!code-vb[Astoria Northwind Client#LinqSelectMethodSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#linqselectmethodspecific)]         \n\n> [!NOTE]\n>  The `$select` query option cannot be added to a query URI by using the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method. We recommend that you use the LINQ <xref:System.Linq.Enumerable.Select%2A> method to have the client generate the `$select` query option in the request URI.  \n  \n Both of the previous examples are translated to the query URI: `\"http://localhost:12345/northwind.svc/Customers()?$filter=Country eq 'GerGerm'&$select=CustomerID,Address,City,Region,PostalCode,Country\"`.  \n  \n<a name=\"paging\"></a>   \n### Client Paging  \n The following examples show equivalent queries that request a page of sorted order entities that includes 25 orders, skipping the first 50 orders:  \n  \n-   Applying query methods to a LINQ query:  \n  \n[!code-csharp[Astoria Northwind Client#LinqSkipTakeMethodSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#linqskiptakemethodspecific)]      \n[!code-vb[Astoria Northwind Client#LinqSkipTakeMethodSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#linqskiptakemethodspecific)]     \n  \n-   URI query string `$skip` and `$top` options):  \n  \n[!code-csharp[Astoria Northwind Client#ExplicitQuerySkipTakeMethodSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#explicitqueryskiptakemethodspecific)]      \n[!code-vb[Astoria Northwind Client#ExplicitQuerySkipTakeMethodSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#explicitqueryskiptakemethodspecific)]     \n  \n Both of the previous examples are translated to the query URI: `http://localhost:12345/northwind.svc/Orders()?$orderby=OrderDate desc&$skip=50&$top=25`.  \n  \n<a name=\"expand\"></a>   \n### Expand  \n When you query an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] data service, you can request that entities related to the entity targeted by the query be included the returned feed. The <xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A> method is called on the <xref:System.Data.Services.Client.DataServiceQuery%601> for the entity set targeted by the LINQ query, with the related entity set name supplied as the `path` parameter. For more information, see [Loading Deferred Content](../../../../docs/framework/data/wcf/loading-deferred-content-wcf-data-services.md).  \n  \n The following examples show equivalent ways to use the <xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A> method in a query:  \n  \n-   In LINQ query syntax:  \n  \n[!code-csharp[Astoria Northwind Client#LinqQueryExpandSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#linqqueryexpandspecific)]      \n[!code-vb[Astoria Northwind Client#LinqQueryExpandSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#linqqueryexpandspecific)]  \n  \n-   With LINQ query methods:  \n\n[!code-csharp[Astoria Northwind Client#LinqQueryExpandMethodSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#linqqueryexpandmethodspecific)]       \n[!code-vb[Astoria Northwind Client#LinqQueryExpandMethodSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#linqqueryexpandmethodspecific)]       \n\n Both of the previous examples are translated to the query URI: `http://localhost:12345/northwind.svc/Orders()?$filter=CustomerID eq 'ALFKI'&$expand=Order_Details`.  \n  \n<a name=\"unsupportedMethods\"></a>   \n## Unsupported LINQ Methods  \n The following table contains the classes of LINQ methods are not supported and cannot be included in a query executed against an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service:  \n  \n|Operation Type|Unsupported Method|  \n|--------------------|------------------------|  \n|Set operators|All set operators are unsupported against a <xref:System.Data.Services.Client.DataServiceQuery%601>, which included the following:<br /><br /> -   <xref:System.Linq.Enumerable.All%2A><br />-   <xref:System.Linq.Enumerable.Any%2A><br />-   <xref:System.Linq.Enumerable.Concat%2A><br />-   <xref:System.Linq.Enumerable.DefaultIfEmpty%2A><br />-   <xref:System.Linq.Enumerable.Distinct%2A><br />-   <xref:System.Linq.Enumerable.Except%2A><br />-   <xref:System.Linq.Enumerable.Intersect%2A><br />-   <xref:System.Linq.Enumerable.Union%2A><br />-   <xref:System.Linq.Enumerable.Zip%2A>|  \n|Ordering operators|The following ordering operators that require <xref:System.Collections.Generic.IComparer%601> are unsupported against a <xref:System.Data.Services.Client.DataServiceQuery%601>:<br /><br /> -   <xref:System.Linq.Enumerable.OrderBy%60%602%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2C%60%601%7D%2CSystem.Collections.Generic.IComparer%7B%60%601%7D%29><br />-   <xref:System.Linq.Enumerable.OrderByDescending%60%602%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2C%60%601%7D%2CSystem.Collections.Generic.IComparer%7B%60%601%7D%29><br />-   <xref:System.Linq.Enumerable.ThenBy%60%602%28System.Linq.IOrderedEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2C%60%601%7D%2CSystem.Collections.Generic.IComparer%7B%60%601%7D%29><br />-   <xref:System.Linq.Enumerable.ThenByDescending%60%602%28System.Linq.IOrderedEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2C%60%601%7D%2CSystem.Collections.Generic.IComparer%7B%60%601%7D%29>|  \n|Projection and filtering operators|The following projection and filtering operators that accept a positional argument are unsupported against a <xref:System.Data.Services.Client.DataServiceQuery%601>:<br /><br /> -   <xref:System.Linq.Enumerable.Join%60%604%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Collections.Generic.IEnumerable%7B%60%601%7D%2CSystem.Func%7B%60%600%2C%60%602%7D%2CSystem.Func%7B%60%601%2C%60%602%7D%2CSystem.Func%7B%60%600%2C%60%601%2C%60%603%7D%2CSystem.Collections.Generic.IEqualityComparer%7B%60%602%7D%29><br />-   <xref:System.Linq.Enumerable.Select%60%602%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Int32%2C%60%601%7D%29><br />-   <xref:System.Linq.Enumerable.SelectMany%60%602%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Collections.Generic.IEnumerable%7B%60%601%7D%7D%29><br />-   <xref:System.Linq.Enumerable.SelectMany%60%602%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Int32%2CSystem.Collections.Generic.IEnumerable%7B%60%601%7D%7D%29><br />-   <xref:System.Linq.Enumerable.SelectMany%60%603%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Collections.Generic.IEnumerable%7B%60%601%7D%7D%2CSystem.Func%7B%60%600%2C%60%601%2C%60%602%7D%29><br />-   <xref:System.Linq.Enumerable.SelectMany%60%603%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Int32%2CSystem.Collections.Generic.IEnumerable%7B%60%601%7D%7D%2CSystem.Func%7B%60%600%2C%60%601%2C%60%602%7D%29><br />-   <xref:System.Linq.Enumerable.Where%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Int32%2CSystem.Boolean%7D%29>|  \n|Grouping operators|All grouping operators are unsupported against a <xref:System.Data.Services.Client.DataServiceQuery%601>, including the following:<br /><br /> -   <xref:System.Linq.Enumerable.GroupBy%2A><br />-   <xref:System.Linq.Enumerable.GroupJoin%2A><br /><br /> Grouping operations must be performed on the client.|  \n|Aggregate operators|All aggregate operations are unsupported against a <xref:System.Data.Services.Client.DataServiceQuery%601>, including the following:<br /><br /> -   <xref:System.Linq.Enumerable.Aggregate%2A><br />-   <xref:System.Linq.Enumerable.Average%2A><br />-   <xref:System.Linq.Enumerable.Count%2A><br />-   <xref:System.Linq.Enumerable.LongCount%2A><br />-   <xref:System.Linq.Enumerable.Max%2A><br />-   <xref:System.Linq.Enumerable.Min%2A><br />-   <xref:System.Linq.Enumerable.Sum%2A><br /><br /> Aggregate operations must either be performed on the client or be encapsulated by a service operation.|  \n|Paging operators|The following paging operators are not supported against a <xref:System.Data.Services.Client.DataServiceQuery%601>:<br /><br /> -   <xref:System.Linq.Enumerable.ElementAt%2A><br />-   <xref:System.Linq.Enumerable.Last%2A><br />-   <xref:System.Linq.Enumerable.LastOrDefault%2A><br />-   <xref:System.Linq.Enumerable.SkipWhile%2A><br />-   <xref:System.Linq.Enumerable.TakeWhile%2A> **Note:**  Paging operators that are executed on an empty sequence return null.|  \n|Other operators|The following other operators are not supported against a <xref:System.Data.Services.Client.DataServiceQuery%601>:<br /><br /> 1.  <xref:System.Linq.Enumerable.Empty%2A><br />2.  <xref:System.Linq.Enumerable.Range%2A><br />3.  <xref:System.Linq.Enumerable.Repeat%2A><br />4.  <xref:System.Linq.Enumerable.ToDictionary%2A><br />5.  <xref:System.Linq.Enumerable.ToLookup%2A>|  \n  \n<a name=\"supportedExpressions\"></a>   \n## Supported Expression Functions  \n The following common-language runtime (CLR) methods and properties are supported because they can be translated in a query expression for inclusion in the request URI to an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service:  \n  \n|<xref:System.String> Member|Supported [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] Function|  \n|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|  \n|<xref:System.String.Concat%28System.String%2CSystem.String%29>|`string concat(string p0, string p1)`|  \n|<xref:System.String.Contains%28System.String%29>|`bool substringof(string p0, string p1)`|  \n|<xref:System.String.EndsWith%28System.String%29>|`bool endswith(string p0, string p1)`|  \n|<xref:System.String.IndexOf%28System.String%2CSystem.Int32%29>|`int indexof(string p0, string p1)`|  \n|<xref:System.String.Length>|`int length(string p0)`|  \n|<xref:System.String.Replace%28System.String%2CSystem.String%29>|`string replace(string p0, string find, string replace)`|  \n|<xref:System.String.Substring%28System.Int32%29>|`string substring(string p0, int pos)`|  \n|<xref:System.String.Substring%28System.Int32%2CSystem.Int32%29>|`string substring(string p0, int pos, int length)`|  \n|<xref:System.String.ToLower>|`string tolower(string p0)`|  \n|<xref:System.String.ToUpper>|`string toupper(string p0)`|  \n|<xref:System.String.Trim>|`string trim(string p0)`|  \n  \n|<xref:System.DateTime> Member<sup>1</sup>|Supported [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] Function|  \n|-------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|  \n|<xref:System.DateTime.Day>|`int day(DateTime p0)`|  \n|<xref:System.DateTime.Hour>|`int hour(DateTime p0)`|  \n|<xref:System.DateTime.Minute>|`int minute(DateTime p0)`|  \n|<xref:System.DateTime.Month>|`int month(DateTime p0)`|  \n|<xref:System.DateTime.Second>|`int second(DateTime p0)`|  \n|<xref:System.DateTime.Year>|`int year(DateTime p0)`|  \n  \n <sup>1</sup>The equivalent date and time properties of <xref:Microsoft.VisualBasic.DateAndTime?displayProperty=nameWithType>, as well as the <xref:Microsoft.VisualBasic.DateAndTime.DatePart%2A> method in Visual Basic are also supported.  \n  \n|<xref:System.Math> Member|Supported [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] Function|  \n|---------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|  \n|<xref:System.Math.Ceiling%28System.Decimal%29>|`decimal ceiling(decimal p0)`|  \n|<xref:System.Math.Ceiling%28System.Double%29>|`double ceiling(double p0)`|  \n|<xref:System.Math.Floor%28System.Decimal%29>|`decimal floor(decimal p0)`|  \n|<xref:System.Math.Floor%28System.Double%29>|`double floor(double p0)`|  \n|<xref:System.Math.Round%28System.Decimal%29>|`decimal round(decimal p0)`|  \n|<xref:System.Math.Round%28System.Double%29>|`double round(double p0)`|  \n  \n|<xref:System.Linq.Expressions.Expression> Member|Supported [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] Function|  \n|---------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|  \n|<xref:System.Linq.Expressions.Expression.TypeIs%28System.Linq.Expressions.Expression%2CSystem.Type%29>|`bool isof(type p0)`|  \n  \n The client may also be able to evaluate additional CLR functions on the client. A <xref:System.NotSupportedException> is raised for any expression that cannot be evaluated on the client and cannot be translated into a valid request URI for evaluation on the server.  \n  \n## See also\n\n- [Querying the Data Service](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)\n- [Query Projections](../../../../docs/framework/data/wcf/query-projections-wcf-data-services.md)\n- [Object Materialization](../../../../docs/framework/data/wcf/object-materialization-wcf-data-services.md)\n- [OData: URI Conventions](https://go.microsoft.com/fwlink/?LinkID=185564)\n","nodes":[{"pos":[4,295],"embed":true,"restype":"x-metadata","content":"title: \"LINQ Considerations (WCF Data Services)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"WCF Data Services, LINQ\"\n  - \"querying the data service [WCF Data Services]\"\n  - \"WCF Data Services, querying\"\nms.assetid: cc4ec9e9-348f-42a6-a78e-1cd40e370656","nodes":[{"content":"LINQ Considerations (WCF Data Services)","nodes":[{"pos":[0,39],"content":"LINQ Considerations (WCF Data Services)","nodes":[{"content":"LINQ Considerations (WCF Data Services)","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[302,341],"content":"LINQ Considerations (WCF Data Services)","linkify":"LINQ Considerations (WCF Data Services)","nodes":[{"content":"LINQ Considerations (WCF Data Services)","pos":[0,39]}]},{"content":"This topic provides information about the way in which LINQ queries are composed and executed when you are using the <ph id=\"ph1\">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]</ph> client and limitations of using LINQ to query a data service that implements the <ph id=\"ph2\">[!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)]</ph>.","pos":[342,664],"source":"This topic provides information about the way in which LINQ queries are composed and executed when you are using the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client and limitations of using LINQ to query a data service that implements the [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)]."},{"content":"For more information about composing and executing queries against an <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph>-based data service, see <bpt id=\"p1\">[</bpt>Querying the Data Service<ept id=\"p1\">](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)</ept>.","pos":[665,937],"source":" For more information about composing and executing queries against an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]-based data service, see [Querying the Data Service](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)."},{"pos":[946,968],"content":"Composing LINQ Queries","linkify":"Composing LINQ Queries","nodes":[{"content":"Composing LINQ Queries","pos":[0,22]}]},{"content":"LINQ enables you to compose queries against a collection of objects that implements <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph>.","pos":[972,1106],"source":"LINQ enables you to compose queries against a collection of objects that implements <xref:System.Collections.Generic.IEnumerable%601>."},{"content":"Both the <bpt id=\"p1\">**</bpt>Add Service Reference<ept id=\"p1\">**</ept> dialog box in Visual Studio and the DataSvcUtil.exe tool are used to generate a representation of an <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> service as an entity container class that inherits from <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph>, as well as objects that represent the entities returned in feeds.","pos":[1107,1485],"source":" Both the **Add Service Reference** dialog box in Visual Studio and the DataSvcUtil.exe tool are used to generate a representation of an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service as an entity container class that inherits from <xref:System.Data.Services.Client.DataServiceContext>, as well as objects that represent the entities returned in feeds."},{"content":"These tools also generate properties on the entity container class for the collections that are exposed as feeds by the service.","pos":[1486,1614]},{"content":"Each of these properties of the class that encapsulates the data service return a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph>.","pos":[1615,1753],"source":" Each of these properties of the class that encapsulates the data service return a <xref:System.Data.Services.Client.DataServiceQuery%601>."},{"content":"Because the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> class implements the <ph id=\"ph2\">&lt;xref:System.Linq.IQueryable%601&gt;</ph> interface defined by LINQ, you can compose a LINQ query against feeds exposed by the data service, which are translated by the client library into a query request URI that is sent to the data service on execution.","pos":[1754,2090],"source":" Because the <xref:System.Data.Services.Client.DataServiceQuery%601> class implements the <xref:System.Linq.IQueryable%601> interface defined by LINQ, you can compose a LINQ query against feeds exposed by the data service, which are translated by the client library into a query request URI that is sent to the data service on execution."},{"pos":[2098,2594],"content":"[!IMPORTANT]\n The set of queries expressible in the LINQ syntax is broader than those enabled in the URI syntax that is used by [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] data services. A <xref:System.NotSupportedException> is raised when the query cannot be mapped to a URI in the target data service. For more information, see the [Unsupported LINQ Methods](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md#unsupportedMethods) in this topic.","leadings":["","> "],"nodes":[{"content":"The set of queries expressible in the LINQ syntax is broader than those enabled in the URI syntax that is used by [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] data services. A <xref:System.NotSupportedException> is raised when the query cannot be mapped to a URI in the target data service. For more information, see the [Unsupported LINQ Methods](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md#unsupportedMethods) in this topic.","pos":[14,494],"nodes":[{"content":"The set of queries expressible in the LINQ syntax is broader than those enabled in the URI syntax that is used by <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> data services.","pos":[0,194],"source":"The set of queries expressible in the LINQ syntax is broader than those enabled in the URI syntax that is used by [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] data services."},{"content":"A <ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph> is raised when the query cannot be mapped to a URI in the target data service.","pos":[195,311],"source":" A <xref:System.NotSupportedException> is raised when the query cannot be mapped to a URI in the target data service."},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>Unsupported LINQ Methods<ept id=\"p1\">](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md#unsupportedMethods)</ept> in this topic.","pos":[312,480],"source":" For more information, see the [Unsupported LINQ Methods](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md#unsupportedMethods) in this topic."}]}]},{"pos":[2601,2782],"content":"The following example is a LINQ query that returns <ph id=\"ph1\">`Orders`</ph> that have a freight cost of more than $30 and sorts the results by the shipping date, starting with the latest ship date:","source":"The following example is a LINQ query that returns `Orders` that have a freight cost of more than $30 and sorts the results by the shipping date, starting with the latest ship date:"},{"pos":[3181,3380],"content":"This LINQ query is translated into the following query URI that is executed against the Northwind-based <bpt id=\"p1\">[</bpt>quickstart<ept id=\"p1\">](../../../../docs/framework/data/wcf/quickstart-wcf-data-services.md)</ept> data service:","source":"This LINQ query is translated into the following query URI that is executed against the Northwind-based [quickstart](../../../../docs/framework/data/wcf/quickstart-wcf-data-services.md) data service:"},{"pos":[3490,3750],"content":"For more general information about LINQ, see <bpt id=\"p1\">[</bpt>Language-Integrated Query (LINQ) - C#<ept id=\"p1\">](../../../csharp/programming-guide/concepts/linq/index.md)</ept> or <bpt id=\"p2\">[</bpt>Language-Integrated Query (LINQ) - Visual Basic<ept id=\"p2\">](../../../visual-basic/programming-guide/concepts/linq/index.md)</ept>.","source":"For more general information about LINQ, see [Language-Integrated Query (LINQ) - C#](../../../csharp/programming-guide/concepts/linq/index.md) or [Language-Integrated Query (LINQ) - Visual Basic](../../../visual-basic/programming-guide/concepts/linq/index.md)."},{"content":"LINQ enables you to compose queries by using both the language-specific declarative query syntax, shown in the previous example, as well as a set of query methods known as standard query operators.","pos":[3757,3954]},{"content":"An equivalent query to the previous example can be composed by using only the method-based syntax, as shown the following example:","pos":[3955,4085]},{"content":"The <ph id=\"ph1\">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]</ph> client is able to translate both kinds of composed queries into a query URI, and you can extend a LINQ query by appending query methods to a query expression.","pos":[4524,4746],"source":"The [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client is able to translate both kinds of composed queries into a query URI, and you can extend a LINQ query by appending query methods to a query expression."},{"content":"When you compose LINQ queries by appending method syntax to a query expression or a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph>, the operations are added to the query URI in the order in which methods are called.","pos":[4747,4971],"source":" When you compose LINQ queries by appending method syntax to a query expression or a <xref:System.Data.Services.Client.DataServiceQuery%601>, the operations are added to the query URI in the order in which methods are called."},{"content":"This is equivalent to calling the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A&gt;</ph> method to add each query option to the query URI.","pos":[4972,5129],"source":" This is equivalent to calling the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method to add each query option to the query URI."},{"pos":[5138,5160],"content":"Executing LINQ Queries","linkify":"Executing LINQ Queries","nodes":[{"content":"Executing LINQ Queries","pos":[0,22]}]},{"content":"Certain LINQ query methods, such as <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.First%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%29&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.Single%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%29&gt;</ph>, when appended to the query, cause the query to be executed.","pos":[5164,5464],"source":"Certain LINQ query methods, such as <xref:System.Linq.Enumerable.First%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%29> or <xref:System.Linq.Enumerable.Single%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%29>, when appended to the query, cause the query to be executed."},{"content":"A query is also executed when results are enumerated implicitly, such as during a <ph id=\"ph1\">`foreach`</ph> loop or when the query is assigned to a <ph id=\"ph2\">`List`</ph> collection.","pos":[5465,5615],"source":" A query is also executed when results are enumerated implicitly, such as during a `foreach` loop or when the query is assigned to a `List` collection."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Querying the Data Service<ept id=\"p1\">](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)</ept>.","pos":[5616,5754],"source":" For more information, see [Querying the Data Service](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)."},{"content":"The client executes a LINQ query in two parts.","pos":[5761,5807]},{"content":"Whenever possible, LINQ expressions in a query are first evaluated on the client, and then a URI-based query is generated and sent to the data service for evaluation against data in the service.","pos":[5808,6002]},{"content":"For more information, see the section <bpt id=\"p1\">[</bpt>Client versus Server Execution<ept id=\"p1\">](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md#executingQueries)</ept> in <bpt id=\"p2\">[</bpt>Querying the Data Service<ept id=\"p2\">](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)</ept>.","pos":[6003,6290],"source":" For more information, see the section [Client versus Server Execution](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md#executingQueries) in [Querying the Data Service](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)."},{"content":"When a LINQ query cannot be translated in an <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph>-compliant query URI, an exception is raised when execution is attempted.","pos":[6297,6480],"source":"When a LINQ query cannot be translated in an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]-compliant query URI, an exception is raised when execution is attempted."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Querying the Data Service<ept id=\"p1\">](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)</ept>.","pos":[6481,6619],"source":" For more information, see [Querying the Data Service](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)."},{"pos":[6628,6647],"content":"LINQ Query Examples","linkify":"LINQ Query Examples","nodes":[{"content":"LINQ Query Examples","pos":[0,19]}]},{"pos":[6651,6834],"content":"The examples in the following sections demonstrate the kinds of LINQ queries that can be executed against an <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> service.","source":"The examples in the following sections demonstrate the kinds of LINQ queries that can be executed against an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service."},{"pos":[6872,6881],"content":"Filtering","linkify":"Filtering","nodes":[{"content":"Filtering","pos":[0,9]}]},{"content":"The LINQ query examples in this section filter data in the feed returned by the service.","pos":[6885,6973]},{"pos":[6980,7139],"content":"The following examples are equivalent queries that filter the returned <ph id=\"ph1\">`Orders`</ph> entities so that only orders with a freight cost greater than $30 are returned:","source":"The following examples are equivalent queries that filter the returned `Orders` entities so that only orders with a freight cost greater than $30 are returned:"},{"content":"Using LINQ query syntax:","pos":[7149,7173]},{"content":"Using LINQ query methods:","pos":[7560,7585]},{"pos":[7974,8012],"content":"The URI query string <ph id=\"ph1\">`$filter`</ph> option:","source":"The URI query string `$filter` option:"},{"pos":[8434,8567],"content":"All of the previous examples are translated to the query URI: <ph id=\"ph1\">`http://localhost:12345/northwind.svc/Orders()?$filter=Freight gt 30M`</ph>.","source":"All of the previous examples are translated to the query URI: `http://localhost:12345/northwind.svc/Orders()?$filter=Freight gt 30M`."},{"pos":[8603,8610],"content":"Sorting","linkify":"Sorting","nodes":[{"content":"Sorting","pos":[0,7]}]},{"content":"The following examples show equivalent queries that sort returned data both by the company name and by postal code, descending:","pos":[8614,8741]},{"content":"Using LINQ query syntax:","pos":[8751,8775]},{"content":"Using LINQ query methods:","pos":[9173,9198]},{"pos":[9596,9632],"content":"URI query string <ph id=\"ph1\">`$orderby`</ph> option):","source":"URI query string `$orderby` option):"},{"pos":[10064,10214],"content":"All of the previous examples are translated to the query URI: <ph id=\"ph1\">`http://localhost:12345/northwind.svc/Customers()?$orderby=CompanyName,PostalCode desc`</ph>.","source":"All of the previous examples are translated to the query URI: `http://localhost:12345/northwind.svc/Customers()?$orderby=CompanyName,PostalCode desc`."},{"pos":[10253,10263],"content":"Projection","linkify":"Projection","nodes":[{"content":"Projection","pos":[0,10]}]},{"pos":[10267,10382],"content":"The following examples show equivalent queries that project returned data into the narrower <ph id=\"ph1\">`CustomerAddress`</ph> type:","source":"The following examples show equivalent queries that project returned data into the narrower `CustomerAddress` type:"},{"content":"Using LINQ query syntax:","pos":[10392,10416]},{"content":"Using LINQ query methods:","pos":[10811,10836]},{"pos":[11227,11547],"content":"[!NOTE]\n The `$select` query option cannot be added to a query URI by using the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method. We recommend that you use the LINQ <xref:System.Linq.Enumerable.Select%2A> method to have the client generate the `$select` query option in the request URI.","leadings":["","> "],"nodes":[{"content":"The `$select` query option cannot be added to a query URI by using the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method. We recommend that you use the LINQ <xref:System.Linq.Enumerable.Select%2A> method to have the client generate the `$select` query option in the request URI.","pos":[9,318],"nodes":[{"content":"The <ph id=\"ph1\">`$select`</ph> query option cannot be added to a query URI by using the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A&gt;</ph> method.","pos":[0,152],"source":"The `$select` query option cannot be added to a query URI by using the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method."},{"content":"We recommend that you use the LINQ <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Select%2A&gt;</ph> method to have the client generate the <ph id=\"ph2\">`$select`</ph> query option in the request URI.","pos":[153,309],"source":" We recommend that you use the LINQ <xref:System.Linq.Enumerable.Select%2A> method to have the client generate the `$select` query option in the request URI."}]}]},{"pos":[11554,11757],"content":"Both of the previous examples are translated to the query URI: <ph id=\"ph1\">`\"http://localhost:12345/northwind.svc/Customers()?$filter=Country eq 'GerGerm'&amp;$select=CustomerID,Address,City,Region,PostalCode,Country\"`</ph>.","source":"Both of the previous examples are translated to the query URI: `\"http://localhost:12345/northwind.svc/Customers()?$filter=Country eq 'GerGerm'&$select=CustomerID,Address,City,Region,PostalCode,Country\"`."},{"pos":[11792,11805],"content":"Client Paging","linkify":"Client Paging","nodes":[{"content":"Client Paging","pos":[0,13]}]},{"content":"The following examples show equivalent queries that request a page of sorted order entities that includes 25 orders, skipping the first 50 orders:","pos":[11809,11955]},{"content":"Applying query methods to a LINQ query:","pos":[11965,12004]},{"pos":[12403,12448],"content":"URI query string <ph id=\"ph1\">`$skip`</ph> and <ph id=\"ph2\">`$top`</ph> options):","source":"URI query string `$skip` and `$top` options):"},{"pos":[12880,13032],"content":"Both of the previous examples are translated to the query URI: <ph id=\"ph1\">`http://localhost:12345/northwind.svc/Orders()?$orderby=OrderDate desc&amp;$skip=50&amp;$top=25`</ph>.","source":"Both of the previous examples are translated to the query URI: `http://localhost:12345/northwind.svc/Orders()?$orderby=OrderDate desc&$skip=50&$top=25`."},{"pos":[13067,13073],"content":"Expand","linkify":"Expand","nodes":[{"content":"Expand","pos":[0,6]}]},{"content":"When you query an <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> data service, you can request that entities related to the entity targeted by the query be included the returned feed.","pos":[13077,13279],"source":"When you query an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] data service, you can request that entities related to the entity targeted by the query be included the returned feed."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A&gt;</ph> method is called on the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> for the entity set targeted by the LINQ query, with the related entity set name supplied as the <ph id=\"ph3\">`path`</ph> parameter.","pos":[13280,13543],"source":" The <xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A> method is called on the <xref:System.Data.Services.Client.DataServiceQuery%601> for the entity set targeted by the LINQ query, with the related entity set name supplied as the `path` parameter."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Loading Deferred Content<ept id=\"p1\">](../../../../docs/framework/data/wcf/loading-deferred-content-wcf-data-services.md)</ept>.","pos":[13544,13680],"source":" For more information, see [Loading Deferred Content](../../../../docs/framework/data/wcf/loading-deferred-content-wcf-data-services.md)."},{"pos":[13687,13826],"content":"The following examples show equivalent ways to use the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A&gt;</ph> method in a query:","source":"The following examples show equivalent ways to use the <xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A> method in a query:"},{"content":"In LINQ query syntax:","pos":[13836,13857]},{"content":"With LINQ query methods:","pos":[14241,14265]},{"pos":[14672,14835],"content":"Both of the previous examples are translated to the query URI: <ph id=\"ph1\">`http://localhost:12345/northwind.svc/Orders()?$filter=CustomerID eq 'ALFKI'&amp;$expand=Order_Details`</ph>.","source":"Both of the previous examples are translated to the query URI: `http://localhost:12345/northwind.svc/Orders()?$filter=CustomerID eq 'ALFKI'&$expand=Order_Details`."},{"pos":[14881,14905],"content":"Unsupported LINQ Methods","linkify":"Unsupported LINQ Methods","nodes":[{"content":"Unsupported LINQ Methods","pos":[0,24]}]},{"pos":[14909,15112],"content":"The following table contains the classes of LINQ methods are not supported and cannot be included in a query executed against an <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> service:","source":"The following table contains the classes of LINQ methods are not supported and cannot be included in a query executed against an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service:"},{"content":"Operation Type","pos":[15119,15133]},{"content":"Unsupported Method","pos":[15134,15152]},{"content":"Set operators","pos":[15207,15220]},{"content":"All set operators are unsupported against a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph>, which included the following:","pos":[15221,15351],"source":"All set operators are unsupported against a <xref:System.Data.Services.Client.DataServiceQuery%601>, which included the following:"},{"content":"Ordering operators","pos":[15807,15825]},{"content":"The following ordering operators that require <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IComparer%601&gt;</ph> are unsupported against a <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph>:","pos":[15826,16002],"source":"The following ordering operators that require <xref:System.Collections.Generic.IComparer%601> are unsupported against a <xref:System.Data.Services.Client.DataServiceQuery%601>:"},{"content":"Projection and filtering operators","pos":[16816,16850]},{"content":"The following projection and filtering operators that accept a positional argument are unsupported against a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph>:","pos":[16851,17016],"source":"The following projection and filtering operators that accept a positional argument are unsupported against a <xref:System.Data.Services.Client.DataServiceQuery%601>:"},{"content":"Grouping operators","pos":[18605,18623]},{"content":"All grouping operators are unsupported against a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph>, including the following:","pos":[18624,18754],"source":"All grouping operators are unsupported against a <xref:System.Data.Services.Client.DataServiceQuery%601>, including the following:"},{"content":"Grouping operations must be performed on the client.","pos":[18876,18928]},{"content":"Aggregate operators","pos":[18933,18952]},{"content":"All aggregate operations are unsupported against a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph>, including the following:","pos":[18953,19085],"source":"All aggregate operations are unsupported against a <xref:System.Data.Services.Client.DataServiceQuery%601>, including the following:"},{"content":"Aggregate operations must either be performed on the client or be encapsulated by a service operation.","pos":[19445,19547]},{"content":"Paging operators","pos":[19552,19568]},{"content":"The following paging operators are not supported against a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph>:","pos":[19569,19684],"source":"The following paging operators are not supported against a <xref:System.Data.Services.Client.DataServiceQuery%601>:"},{"content":"<ph id=\"ph1\">-   </ph><ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.TakeWhile%2A&gt;</ph> <bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  Paging operators that are executed on an empty sequence return null.","pos":[19904,20030],"source":"-   <xref:System.Linq.Enumerable.TakeWhile%2A> **Note:**  Paging operators that are executed on an empty sequence return null."},{"content":"Other operators","pos":[20035,20050]},{"content":"The following other operators are not supported against a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph>:","pos":[20051,20165],"source":"The following other operators are not supported against a <xref:System.Data.Services.Client.DataServiceQuery%601>:"},{"content":"1.  <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Empty%2A&gt;</ph>","pos":[20178,20220],"source":"1.  <xref:System.Linq.Enumerable.Empty%2A>"},{"content":"2.  <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Range%2A&gt;</ph>","pos":[20226,20268],"source":"2.  <xref:System.Linq.Enumerable.Range%2A>"},{"content":"3.  <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Repeat%2A&gt;</ph>","pos":[20274,20317],"source":"3.  <xref:System.Linq.Enumerable.Repeat%2A>"},{"content":"4.  <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.ToDictionary%2A&gt;</ph>","pos":[20323,20372],"source":"4.  <xref:System.Linq.Enumerable.ToDictionary%2A>"},{"content":"5.  <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.ToLookup%2A&gt;</ph>","pos":[20378,20423],"source":"5.  <xref:System.Linq.Enumerable.ToLookup%2A>"},{"pos":[20472,20502],"content":"Supported Expression Functions","linkify":"Supported Expression Functions","nodes":[{"content":"Supported Expression Functions","pos":[0,30]}]},{"pos":[20506,20753],"content":"The following common-language runtime (CLR) methods and properties are supported because they can be translated in a query expression for inclusion in the request URI to an <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> service:","source":"The following common-language runtime (CLR) methods and properties are supported because they can be translated in a query expression for inclusion in the request URI to an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service:"},{"pos":[20760,20787],"content":"<ph id=\"ph1\">&lt;xref:System.String&gt;</ph> Member","source":"<xref:System.String> Member"},{"pos":[20788,20872],"content":"Supported <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> Function","source":"Supported [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] Function"},{"pos":[22064,22105],"content":"<ph id=\"ph1\">&lt;xref:System.DateTime&gt;</ph> Member<bpt id=\"p1\">&lt;sup&gt;</bpt>1<ept id=\"p1\">&lt;/sup&gt;</ept>","source":"<xref:System.DateTime> Member<sup>1</sup>"},{"pos":[22106,22190],"content":"Supported <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> Function","source":"Supported [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] Function"},{"pos":[22778,23014],"content":"<bpt id=\"p1\">&lt;sup&gt;</bpt>1<ept id=\"p1\">&lt;/sup&gt;</ept>The equivalent date and time properties of <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.DateAndTime?displayProperty=nameWithType&gt;</ph>, as well as the <ph id=\"ph2\">&lt;xref:Microsoft.VisualBasic.DateAndTime.DatePart%2A&gt;</ph> method in Visual Basic are also supported.","source":"<sup>1</sup>The equivalent date and time properties of <xref:Microsoft.VisualBasic.DateAndTime?displayProperty=nameWithType>, as well as the <xref:Microsoft.VisualBasic.DateAndTime.DatePart%2A> method in Visual Basic are also supported."},{"pos":[23021,23046],"content":"<ph id=\"ph1\">&lt;xref:System.Math&gt;</ph> Member","source":"<xref:System.Math> Member"},{"pos":[23047,23131],"content":"Supported <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> Function","source":"Supported [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] Function"},{"pos":[23820,23868],"content":"<ph id=\"ph1\">&lt;xref:System.Linq.Expressions.Expression&gt;</ph> Member","source":"<xref:System.Linq.Expressions.Expression> Member"},{"pos":[23869,23953],"content":"Supported <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> Function","source":"Supported [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] Function"},{"content":"The client may also be able to evaluate additional CLR functions on the client.","pos":[24333,24412]},{"content":"A <ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph> is raised for any expression that cannot be evaluated on the client and cannot be translated into a valid request URI for evaluation on the server.","pos":[24413,24598],"source":" A <xref:System.NotSupportedException> is raised for any expression that cannot be evaluated on the client and cannot be translated into a valid request URI for evaluation on the server."},{"pos":[24607,24615],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[24619,24730],"content":"<bpt id=\"p1\">[</bpt>Querying the Data Service<ept id=\"p1\">](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)</ept>","source":"[Querying the Data Service](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)"},{"pos":[24733,24828],"content":"<bpt id=\"p1\">[</bpt>Query Projections<ept id=\"p1\">](../../../../docs/framework/data/wcf/query-projections-wcf-data-services.md)</ept>","source":"[Query Projections](../../../../docs/framework/data/wcf/query-projections-wcf-data-services.md)"},{"pos":[24831,24936],"content":"<bpt id=\"p1\">[</bpt>Object Materialization<ept id=\"p1\">](../../../../docs/framework/data/wcf/object-materialization-wcf-data-services.md)</ept>","source":"[Object Materialization](../../../../docs/framework/data/wcf/object-materialization-wcf-data-services.md)"},{"pos":[24939,25011],"content":"<bpt id=\"p1\">[</bpt>OData: URI Conventions<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=185564)</ept>","source":"[OData: URI Conventions](https://go.microsoft.com/fwlink/?LinkID=185564)"}]}