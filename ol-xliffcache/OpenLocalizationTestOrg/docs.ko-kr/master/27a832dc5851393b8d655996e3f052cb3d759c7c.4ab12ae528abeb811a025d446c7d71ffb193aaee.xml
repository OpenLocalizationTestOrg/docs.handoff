{"content":"---\ntitle: \"How to: read from comma-delimited text files in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"files [Visual Basic], parsing\"\n  - \"text files [Visual Basic], tasks\"\n  - \"reading text files [Visual Basic], comma-delimited\"\n  - \"text files [Visual Basic], reading\"\nms.assetid: a8413fe4-0dba-49c8-8692-44fb67a9ec4f\n---\n# How to: read from comma-delimited text files in Visual Basic\nThe `TextFieldParser` object provides a way to easily and efficiently parse structured text files, such as logs. The `TextFieldType` property defines whether it is a delimited file or one with fixed-width fields of text.  \n  \n### To parse a comma delimited text file  \n  \n1.  Create a new `TextFieldParser`. The following code creates the `TextFieldParser` named `MyReader` and opens the file `test.txt`.  \n  \n     [!code-vb[VbFileIORead#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbFileIORead/VB/Class1.vb#15)]  \n  \n2.  Define the `TextField` type and delimiter. The following code defines the `TextFieldType` property as `Delimited` and the delimiter as \",\".  \n  \n     [!code-vb[VbFileIORead#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbFileIORead/VB/Class1.vb#16)]  \n  \n3.  Loop through the fields in the file. If any lines are corrupt, report an error and continue parsing. The following code loops through the file, displaying each field in turn and reporting any fields that are formatted incorrectly.  \n  \n     [!code-vb[VbFileIORead#17](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbFileIORead/VB/Class1.vb#17)]  \n  \n4.  Close the `While` and `Using` blocks with `End While` and `End Using`.  \n  \n     [!code-vb[VbFileIORead#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbFileIORead/VB/Class1.vb#18)]  \n  \n## Example  \n This example reads from the file `test.txt`.  \n  \n [!code-vb[VbFileIORead#19](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbFileIORead/VB/Class1.vb#19)]  \n  \n## Robust programming  \n The following conditions may cause an exception:  \n  \n-   A row cannot be parsed using the specified format (<xref:Microsoft.VisualBasic.FileIO.MalformedLineException>). The exception message specifies the line causing the exception, while the <xref:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine%2A> property is assigned the text contained in the line.  \n  \n-   The specified file does not exist (<xref:System.IO.FileNotFoundException>).  \n  \n-   A partial-trust situation in which the user does not have sufficient permissions to access the file. (<xref:System.Security.SecurityException>).  \n  \n-   The path is too long (<xref:System.IO.PathTooLongException>).  \n  \n-   The user does not have sufficient permissions to access the file (<xref:System.UnauthorizedAccessException>).  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.FileIO.TextFieldParser?displayProperty=nameWithType>\n- [How to: Read From Fixed-width Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md)\n- [How to: Read From Text Files with Multiple Formats](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)\n- [Parsing Text Files with the TextFieldParser Object](../../../../visual-basic/developing-apps/programming/drives-directories-files/parsing-text-files-with-the-textfieldparser-object.md)\n- [Walkthrough: Manipulating Files and Directories in Visual Basic](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md)\n- [Troubleshooting: Reading from and Writing to Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md)\n","nodes":[{"pos":[4,337],"embed":true,"restype":"x-metadata","content":"title: \"How to: read from comma-delimited text files in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"files [Visual Basic], parsing\"\n  - \"text files [Visual Basic], tasks\"\n  - \"reading text files [Visual Basic], comma-delimited\"\n  - \"text files [Visual Basic], reading\"\nms.assetid: a8413fe4-0dba-49c8-8692-44fb67a9ec4f","nodes":[{"content":"How to: read from comma-delimited text files in Visual Basic","nodes":[{"pos":[0,60],"content":"How to: read from comma-delimited text files in Visual Basic","nodes":[{"content":"How to: read from comma-delimited text files in Visual Basic","pos":[0,60]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[344,404],"content":"How to: read from comma-delimited text files in Visual Basic","linkify":"How to: read from comma-delimited text files in Visual Basic","nodes":[{"content":"How to: read from comma-delimited text files in Visual Basic","pos":[0,60]}]},{"content":"The <ph id=\"ph1\">`TextFieldParser`</ph> object provides a way to easily and efficiently parse structured text files, such as logs.","pos":[405,517],"source":"The `TextFieldParser` object provides a way to easily and efficiently parse structured text files, such as logs."},{"content":"The <ph id=\"ph1\">`TextFieldType`</ph> property defines whether it is a delimited file or one with fixed-width fields of text.","pos":[518,625],"source":" The `TextFieldType` property defines whether it is a delimited file or one with fixed-width fields of text."},{"pos":[635,671],"content":"To parse a comma delimited text file","linkify":"To parse a comma delimited text file","nodes":[{"content":"To parse a comma delimited text file","pos":[0,36]}]},{"content":"Create a new <ph id=\"ph1\">`TextFieldParser`</ph>.","pos":[681,712],"source":"Create a new `TextFieldParser`."},{"content":"The following code creates the <ph id=\"ph1\">`TextFieldParser`</ph> named <ph id=\"ph2\">`MyReader`</ph> and opens the file <ph id=\"ph3\">`test.txt`</ph>.","pos":[713,809],"source":" The following code creates the `TextFieldParser` named `MyReader` and opens the file `test.txt`."},{"content":"Define the <ph id=\"ph1\">`TextField`</ph> type and delimiter.","pos":[939,981],"source":"Define the `TextField` type and delimiter."},{"content":"The following code defines the <ph id=\"ph1\">`TextFieldType`</ph> property as <ph id=\"ph2\">`Delimited`</ph> and the delimiter as \",\".","pos":[982,1078],"source":" The following code defines the `TextFieldType` property as `Delimited` and the delimiter as \",\"."},{"content":"Loop through the fields in the file.","pos":[1208,1244]},{"content":"If any lines are corrupt, report an error and continue parsing.","pos":[1245,1308]},{"content":"The following code loops through the file, displaying each field in turn and reporting any fields that are formatted incorrectly.","pos":[1309,1438]},{"pos":[1568,1638],"content":"Close the <ph id=\"ph1\">`While`</ph> and <ph id=\"ph2\">`Using`</ph> blocks with <ph id=\"ph3\">`End While`</ph> and <ph id=\"ph4\">`End Using`</ph>.","source":"Close the `While` and `Using` blocks with `End While` and `End Using`."},{"pos":[1767,1774],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1778,1822],"content":"This example reads from the file <ph id=\"ph1\">`test.txt`</ph>.","source":"This example reads from the file `test.txt`."},{"pos":[1947,1965],"content":"Robust programming","linkify":"Robust programming","nodes":[{"content":"Robust programming","pos":[0,18]}]},{"content":"The following conditions may cause an exception:","pos":[1969,2017]},{"content":"A row cannot be parsed using the specified format (<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.MalformedLineException&gt;</ph>).","pos":[2027,2138],"source":"A row cannot be parsed using the specified format (<xref:Microsoft.VisualBasic.FileIO.MalformedLineException>)."},{"content":"The exception message specifies the line causing the exception, while the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine%2A&gt;</ph> property is assigned the text contained in the line.","pos":[2139,2330],"source":" The exception message specifies the line causing the exception, while the <xref:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine%2A> property is assigned the text contained in the line."},{"pos":[2340,2415],"content":"The specified file does not exist (<ph id=\"ph1\">&lt;xref:System.IO.FileNotFoundException&gt;</ph>).","source":"The specified file does not exist (<xref:System.IO.FileNotFoundException>)."},{"content":"A partial-trust situation in which the user does not have sufficient permissions to access the file.","pos":[2425,2525]},{"content":"(<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","pos":[2526,2569],"source":" (<xref:System.Security.SecurityException>)."},{"pos":[2579,2640],"content":"The path is too long (<ph id=\"ph1\">&lt;xref:System.IO.PathTooLongException&gt;</ph>).","source":"The path is too long (<xref:System.IO.PathTooLongException>)."},{"pos":[2650,2759],"content":"The user does not have sufficient permissions to access the file (<ph id=\"ph1\">&lt;xref:System.UnauthorizedAccessException&gt;</ph>).","source":"The user does not have sufficient permissions to access the file (<xref:System.UnauthorizedAccessException>)."},{"pos":[2768,2776],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2863,3027],"content":"<bpt id=\"p1\">[</bpt>How to: Read From Fixed-width Text Files<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md)</ept>","source":"[How to: Read From Fixed-width Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md)"},{"pos":[3030,3214],"content":"<bpt id=\"p1\">[</bpt>How to: Read From Text Files with Multiple Formats<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)</ept>","source":"[How to: Read From Text Files with Multiple Formats](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)"},{"pos":[3217,3402],"content":"<bpt id=\"p1\">[</bpt>Parsing Text Files with the TextFieldParser Object<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/parsing-text-files-with-the-textfieldparser-object.md)</ept>","source":"[Parsing Text Files with the TextFieldParser Object](../../../../visual-basic/developing-apps/programming/drives-directories-files/parsing-text-files-with-the-textfieldparser-object.md)"},{"pos":[3405,3599],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Manipulating Files and Directories in Visual Basic<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md)</ept>","source":"[Walkthrough: Manipulating Files and Directories in Visual Basic](../../../../visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md)"},{"pos":[3602,3796],"content":"<bpt id=\"p1\">[</bpt>Troubleshooting: Reading from and Writing to Text Files<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md)</ept>","source":"[Troubleshooting: Reading from and Writing to Text Files](../../../../visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md)"}]}