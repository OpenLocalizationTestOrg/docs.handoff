{"content":"---\ntitle: \"How to: Add Bounding and Blocking Functionality to a Collection\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"thread-safe collections, custom blocking collections\"\nms.assetid: 4c2492de-3876-4873-b5a1-000bb404d770\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# How to: Add Bounding and Blocking Functionality to a Collection\nThis example shows how to add bounding and blocking functionality to a custom collection class by implementing the <xref:System.Collections.Concurrent.IProducerConsumerCollection%601?displayProperty=nameWithType> interface in the class, and then using a class instance as the internal storage mechanism for a <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType>. For more information about bounding and blocking, see [BlockingCollection Overview](../../../../docs/standard/collections/thread-safe/blockingcollection-overview.md).  \n  \n## Example  \n The custom collection class is a basic priority queue in which the priority levels are represented as an array of <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType> objects. No additional ordering is performed within each queue.  \n  \n In the client code, three tasks are started. The first task just polls for keyboard strokes to enable cancellation at any point during execution. The second task is the producer thread; it adds new items to the blocking collection and gives each item a priority based on a random value. The third task removes items from the collection as they become available.  \n  \n You can adjust the behavior of the application by making one of the threads run faster than the other. If the producer runs faster, you will notice the bounding functionality as the blocking collection prevents items from being added if it already contains the number of items that is specified in the constructor. If the consumer runs faster, you will notice the blocking functionality as the consumer waits for a new item to be added.  \n  \n [!code-csharp[CDS_BlockingCollection#06](../../../../samples/snippets/csharp/VS_Snippets_Misc/cds_blockingcollection/cs/prodcon.cs#06)]  \n  \n By default, the storage for a <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType> is <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType>.  \n  \n## See also\n\n- [Thread-Safe Collections](../../../../docs/standard/collections/thread-safe/index.md)\n","nodes":[{"pos":[4,296],"embed":true,"restype":"x-metadata","content":"title: \"How to: Add Bounding and Blocking Functionality to a Collection\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"thread-safe collections, custom blocking collections\"\nms.assetid: 4c2492de-3876-4873-b5a1-000bb404d770\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"How to: Add Bounding and Blocking Functionality to a Collection","nodes":[{"pos":[0,63],"content":"How to: Add Bounding and Blocking Functionality to a Collection","nodes":[{"content":"How to: Add Bounding and Blocking Functionality to a Collection","pos":[0,63]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[303,366],"content":"How to: Add Bounding and Blocking Functionality to a Collection","linkify":"How to: Add Bounding and Blocking Functionality to a Collection","nodes":[{"content":"How to: Add Bounding and Blocking Functionality to a Collection","pos":[0,63]}]},{"content":"This example shows how to add bounding and blocking functionality to a custom collection class by implementing the <ph id=\"ph1\">&lt;xref:System.Collections.Concurrent.IProducerConsumerCollection%601?displayProperty=nameWithType&gt;</ph> interface in the class, and then using a class instance as the internal storage mechanism for a <ph id=\"ph2\">&lt;xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType&gt;</ph>.","pos":[367,765],"source":"This example shows how to add bounding and blocking functionality to a custom collection class by implementing the <xref:System.Collections.Concurrent.IProducerConsumerCollection%601?displayProperty=nameWithType> interface in the class, and then using a class instance as the internal storage mechanism for a <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType>."},{"content":"For more information about bounding and blocking, see <bpt id=\"p1\">[</bpt>BlockingCollection Overview<ept id=\"p1\">](../../../../docs/standard/collections/thread-safe/blockingcollection-overview.md)</ept>.","pos":[766,932],"source":" For more information about bounding and blocking, see [BlockingCollection Overview](../../../../docs/standard/collections/thread-safe/blockingcollection-overview.md)."},{"pos":[941,948],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The custom collection class is a basic priority queue in which the priority levels are represented as an array of <ph id=\"ph1\">&lt;xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType&gt;</ph> objects.","pos":[952,1160],"source":"The custom collection class is a basic priority queue in which the priority levels are represented as an array of <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType> objects."},{"content":"No additional ordering is performed within each queue.","pos":[1161,1215]},{"content":"In the client code, three tasks are started.","pos":[1222,1266]},{"content":"The first task just polls for keyboard strokes to enable cancellation at any point during execution.","pos":[1267,1367]},{"content":"The second task is the producer thread; it adds new items to the blocking collection and gives each item a priority based on a random value.","pos":[1368,1508]},{"content":"The third task removes items from the collection as they become available.","pos":[1509,1583]},{"content":"You can adjust the behavior of the application by making one of the threads run faster than the other.","pos":[1590,1692]},{"content":"If the producer runs faster, you will notice the bounding functionality as the blocking collection prevents items from being added if it already contains the number of items that is specified in the constructor.","pos":[1693,1904]},{"content":"If the consumer runs faster, you will notice the blocking functionality as the consumer waits for a new item to be added.","pos":[1905,2026]},{"pos":[2175,2383],"content":"By default, the storage for a <ph id=\"ph1\">&lt;xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType&gt;</ph> is <ph id=\"ph2\">&lt;xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType&gt;</ph>.","source":"By default, the storage for a <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType> is <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType>."},{"pos":[2392,2400],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2404,2489],"content":"<bpt id=\"p1\">[</bpt>Thread-Safe Collections<ept id=\"p1\">](../../../../docs/standard/collections/thread-safe/index.md)</ept>","source":"[Thread-Safe Collections](../../../../docs/standard/collections/thread-safe/index.md)"}]}