{"content":"---\ntitle: \"Sub Statement (Visual Basic)\"\nms.date: 05/12/2018\nf1_keywords: \n  - \"vb.Sub\"\nhelpviewer_keywords: \n  - \"Public keyword [Visual Basic], Sub statements\"\n  - \"procedures [Visual Basic], creating\"\n  - \"declaring procedures [Visual Basic], Sub statement\"\n  - \"arguments [Visual Basic], Sub procedures\"\n  - \"As keyword [Visual Basic], Sub statements\"\n  - \"Optional keyword [Visual Basic], Sub statements\"\n  - \"declarations [Visual Basic], procedures\"\n  - \"Sub keyword [Visual Basic]\"\n  - \"Handles keyword [Visual Basic], Sub statements\"\n  - \"Protected Friend keyword [Visual Basic]\"\n  - \"ParamArray keyword [Visual Basic], Sub statements\"\n  - \"Implements keyword [Visual Basic], Sub statements\"\n  - \"Sub statement [Visual Basic]\"\n  - \"subroutines\"\n  - \"ByRef keyword [Visual Basic], Sub statements\"\n  - \"Sub procedures [Visual Basic], Sub statement\"\n  - \"recursive procedures\"\n  - \"Private keyword [Visual Basic], Sub statements\"\n  - \"Friend keyword [Visual Basic], Sub statements\"\n  - \"Exit statement [Visual Basic], Sub statements\"\n  - \"procedures [Visual Basic], Sub\"\n  - \"End keyword [Visual Basic], Sub statements\"\n  - \"ByVal keyword [Visual Basic], Sub statements\"\n  - \"Visual Basic code, Sub procedures\"\nms.assetid: e347d700-d06c-405b-b302-e9b1edb57dfc\n---\n# Sub Statement (Visual Basic)\nDeclares the name, parameters, and code that define a `Sub` procedure.  \n  \n## Syntax  \n  \n```  \n[ <attributelist> ] [ Partial ] [ accessmodifier ] [ proceduremodifiers ] [ Shared ] [ Shadows ] [ Async ]  \nSub name [ (Of typeparamlist) ] [ (parameterlist) ] [ Implements implementslist | Handles eventlist ]  \n    [ statements ]  \n    [ Exit Sub ]  \n    [ statements ]  \nEnd Sub  \n```  \n  \n## Parts  \n  \n-   `attributelist`  \n  \n     Optional. See [Attribute List](attribute-list.md).  \n  \n-   `Partial`  \n  \n     Optional. Indicates definition of a partial method. See [Partial Methods](../../../visual-basic/programming-guide/language-features/procedures/partial-methods.md).  \n  \n-   `accessmodifier`  \n  \n     Optional. Can be one of the following:  \n  \n    -   [Public](../modifiers/public.md)  \n  \n    -   [Protected](../modifiers/protected.md)  \n  \n    -   [Friend](../modifiers/friend.md)  \n  \n    -   [Private](../modifiers/private.md)  \n  \n    - [Protected Friend](../../language-reference/modifiers/protected-friend.md)\n\n    - [Private Protected](../../language-reference/modifiers/private-protected.md)\n  \n     See [Access levels in Visual Basic](../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md).  \n  \n-   `proceduremodifiers`  \n  \n     Optional. Can be one of the following:  \n  \n    -   [Overloads](../modifiers/overloads.md)  \n  \n    -   [Overrides](../modifiers/overrides.md)  \n  \n    -   [Overridable](../modifiers/overridable.md)  \n  \n    -   [NotOverridable](../modifiers/notoverridable.md)  \n  \n    -   [MustOverride](../modifiers/mustoverride.md)  \n  \n    -   `MustOverride Overrides`  \n  \n    -   `NotOverridable Overrides`  \n  \n-   `Shared`  \n  \n     Optional. See [Shared](../modifiers/shared.md).  \n  \n-   `Shadows`  \n  \n     Optional. See [Shadows](../modifiers/shadows.md).  \n  \n-   `Async`  \n  \n     Optional. See [Async](../modifiers/async.md).  \n  \n-   `name`  \n  \n     Required. Name of the procedure. See [Declared Element Names](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md). To create a constructor procedure for a class, set the name of a `Sub` procedure to the `New` keyword. For more information, see [Object Lifetime: How Objects Are Created and Destroyed](../../../visual-basic/programming-guide/language-features/objects-and-classes/object-lifetime-how-objects-are-created-and-destroyed.md).  \n  \n-   `typeparamlist`  \n  \n     Optional. List of type parameters for a generic procedure. See [Type List](type-list.md).  \n  \n-   `parameterlist`  \n  \n     Optional. List of local variable names representing the parameters of this procedure. See [Parameter List](parameter-list.md).  \n  \n-   `Implements`  \n  \n     Optional. Indicates that this procedure implements one or more `Sub` procedures, each one defined in an interface implemented by this procedure's containing class or structure. See [Implements Statement](implements-statement.md).  \n  \n-   `implementslist`  \n  \n     Required if `Implements` is supplied. List of `Sub` procedures being implemented.  \n  \n     `implementedprocedure [ , implementedprocedure ... ]`  \n  \n     Each `implementedprocedure` has the following syntax and parts:  \n  \n     `interface.definedname`  \n  \n    |Part|Description|  \n    |---|---|  \n    |`interface`|Required. Name of an interface implemented by this procedure's containing class or structure.|  \n    |`definedname`|Required. Name by which the procedure is defined in `interface`.|  \n  \n-   `Handles`  \n  \n     Optional. Indicates that this procedure can handle one or more specific events. See [Handles](handles-clause.md).  \n  \n-   `eventlist`  \n  \n     Required if `Handles` is supplied. List of events this procedure handles.  \n  \n     `eventspecifier [ , eventspecifier ... ]`  \n  \n     Each `eventspecifier` has the following syntax and parts:  \n  \n     `eventvariable.event`  \n  \n    |Part|Description|  \n    |---|---|  \n    |`eventvariable`|Required. Object variable declared with the data type of the class or structure that raises the event.|  \n    |`event`|Required. Name of the event this procedure handles.|  \n  \n-   `statements`  \n  \n     Optional. Block of statements to run within this procedure.  \n  \n-   `End Sub`  \n  \n     Terminates the definition of this procedure.  \n  \n## Remarks  \n All executable code must be inside a procedure. Use a `Sub` procedure when you don't want to return a value to the calling code. Use a `Function` procedure when you want to return a value.  \n  \n## Defining a Sub Procedure  \n You can define a `Sub` procedure only at the module level. The declaration context for a sub procedure must, therefore, be a class, a structure, a module, or an interface and can't be a source file, a namespace, a procedure, or a block. For more information, see [Declaration Contexts and Default Access Levels](declaration-contexts-and-default-access-levels.md).  \n  \n `Sub` procedures default to public access. You can adjust their access levels by using the access modifiers.  \n  \n If the procedure uses the `Implements` keyword, the containing class or structure must have an `Implements` statement that immediately follows its `Class` or `Structure` statement. The `Implements` statement must include each interface that's specified in `implementslist`. However, the name by which an interface defines the `Sub` (in `definedname`) doesn't have to match the name of this procedure (in `name`).  \n  \n## Returning from a Sub Procedure  \n When a `Sub` procedure returns to the calling code, execution continues with the statement after the statement that called it.  \n  \n The following example shows a return from a `Sub` procedure.  \n  \n```vb  \nSub mySub(ByVal q As String)  \n    Return  \nEnd Sub   \n```  \n  \n The `Exit Sub` and `Return` statements cause an immediate exit from a `Sub` procedure. Any number of `Exit Sub` and `Return` statements can appear anywhere in the procedure, and you can mix `Exit Sub` and `Return` statements.  \n  \n## Calling a Sub Procedure  \n You call a `Sub` procedure by using the procedure name in a statement and then following that name with its argument list in parentheses. You can omit the parentheses only if you don't supply any arguments. However, your code is more readable if you always include the parentheses.  \n  \n A `Sub` procedure and a `Function` procedure  can have parameters and perform a series of statements. However, a `Function` procedure returns a value, and a `Sub` procedure doesn't. Therefore, you can't use a `Sub` procedure in an expression.  \n  \n You can use the `Call` keyword when you call a `Sub` procedure, but that keyword isn't recommended for most uses. For more information, see [Call Statement](call-statement.md).  \n  \n Visual Basic sometimes rearranges arithmetic expressions to increase internal efficiency. For that reason, if your argument list includes expressions that call other procedures, you shouldn't assume that those expressions will be called in a particular order.  \n  \n## Async Sub Procedures  \n By using the Async feature, you can invoke asynchronous functions without using explicit callbacks or manually splitting your code across multiple functions or lambda expressions.  \n  \n If you mark a procedure with the [Async](../modifiers/async.md) modifier, you can use the [Await](../../../visual-basic/language-reference/operators/await-operator.md) operator in the procedure. When control reaches an `Await` expression in the `Async` procedure, control returns to the caller, and progress in the procedure is suspended until the awaited task completes. When the task is complete, execution can resume in the procedure.  \n  \n> [!NOTE]\n>  An `Async` procedure returns to the caller when either the first awaited object that’s not yet complete is encountered or the end of the `Async` procedure is reached, whichever occurs first.  \n  \n You can also mark a [Function Statement](function-statement.md) with the `Async` modifier. An `Async` function can have a return type of <xref:System.Threading.Tasks.Task%601> or <xref:System.Threading.Tasks.Task>. An example later in this topic shows an `Async` function that has a return type of <xref:System.Threading.Tasks.Task%601>.  \n  \n `Async` `Sub` procedures are primarily used for event handlers, where a value can't be returned. An `Async` `Sub` procedure can't be awaited, and the caller of an `Async` `Sub` procedure can't catch exceptions that the `Sub` procedure throws.  \n  \n An `Async` procedure can't declare any [ByRef](../modifiers/byref.md) parameters.  \n  \n For more information about `Async` procedures, see [Asynchronous Programming with Async and Await](../../../visual-basic/programming-guide/concepts/async/index.md), [Control Flow in Async Programs](../../../visual-basic/programming-guide/concepts/async/control-flow-in-async-programs.md), and [Async Return Types](../../../visual-basic/programming-guide/concepts/async/async-return-types.md).  \n  \n## Example  \n The following example uses the `Sub` statement to define the name, parameters, and code that form the body of a `Sub` procedure.  \n  \n [!code-vb[VbVbalrStatements#58](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class1.vb#58)]  \n  \n## Example  \n In the following example, `DelayAsync` is an `Async` `Function` that has a return type of <xref:System.Threading.Tasks.Task%601>. `DelayAsync` has a `Return` statement that returns an integer. Therefore, the function declaration of `DelayAsync` must have a return type of `Task(Of Integer)`. Because the return type is `Task(Of Integer)`, the evaluation of the `Await` expression in `DoSomethingAsync` produces an integer, as the following statement shows: `Dim result As Integer = Await delayTask`.  \n  \n The `startButton_Click` procedure is an example of an `Async Sub` procedure. Because `DoSomethingAsync` is an `Async` function, the task for the call to `DoSomethingAsync` must be awaited, as the following statement shows: `Await DoSomethingAsync()`. The `startButton_Click` `Sub` procedure must be defined with the `Async` modifier because it has an `Await` expression.  \n  \n [!code-vb[csAsyncMethod#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/csasyncmethod/vb/mainwindow.xaml.vb#1)]  \n  \n## See also\n\n- [Implements Statement](implements-statement.md)\n- [Function Statement](function-statement.md)\n- [Parameter List](parameter-list.md)\n- [Dim Statement](dim-statement.md)\n- [Call Statement](call-statement.md)\n- [Of](of-clause.md)\n- [Parameter Arrays](../../../visual-basic/programming-guide/language-features/procedures/parameter-arrays.md)\n- [How to: Use a Generic Class](../../../visual-basic/programming-guide/language-features/data-types/how-to-use-a-generic-class.md)\n- [Troubleshooting Procedures](../../../visual-basic/programming-guide/language-features/procedures/troubleshooting-procedures.md)\n- [Partial Methods](../../../visual-basic/programming-guide/language-features/procedures/partial-methods.md)\n","nodes":[{"pos":[4,1265],"embed":true,"restype":"x-metadata","content":"title: \"Sub Statement (Visual Basic)\"\nms.date: 05/12/2018\nf1_keywords: \n  - \"vb.Sub\"\nhelpviewer_keywords: \n  - \"Public keyword [Visual Basic], Sub statements\"\n  - \"procedures [Visual Basic], creating\"\n  - \"declaring procedures [Visual Basic], Sub statement\"\n  - \"arguments [Visual Basic], Sub procedures\"\n  - \"As keyword [Visual Basic], Sub statements\"\n  - \"Optional keyword [Visual Basic], Sub statements\"\n  - \"declarations [Visual Basic], procedures\"\n  - \"Sub keyword [Visual Basic]\"\n  - \"Handles keyword [Visual Basic], Sub statements\"\n  - \"Protected Friend keyword [Visual Basic]\"\n  - \"ParamArray keyword [Visual Basic], Sub statements\"\n  - \"Implements keyword [Visual Basic], Sub statements\"\n  - \"Sub statement [Visual Basic]\"\n  - \"subroutines\"\n  - \"ByRef keyword [Visual Basic], Sub statements\"\n  - \"Sub procedures [Visual Basic], Sub statement\"\n  - \"recursive procedures\"\n  - \"Private keyword [Visual Basic], Sub statements\"\n  - \"Friend keyword [Visual Basic], Sub statements\"\n  - \"Exit statement [Visual Basic], Sub statements\"\n  - \"procedures [Visual Basic], Sub\"\n  - \"End keyword [Visual Basic], Sub statements\"\n  - \"ByVal keyword [Visual Basic], Sub statements\"\n  - \"Visual Basic code, Sub procedures\"\nms.assetid: e347d700-d06c-405b-b302-e9b1edb57dfc","nodes":[{"content":"Sub Statement (Visual Basic)","nodes":[{"pos":[0,28],"content":"Sub Statement (Visual Basic)","nodes":[{"content":"Sub Statement (Visual Basic)","pos":[0,28]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[1272,1300],"content":"Sub Statement (Visual Basic)","linkify":"Sub Statement (Visual Basic)","nodes":[{"content":"Sub Statement (Visual Basic)","pos":[0,28]}]},{"pos":[1301,1371],"content":"Declares the name, parameters, and code that define a <ph id=\"ph1\">`Sub`</ph> procedure.","source":"Declares the name, parameters, and code that define a `Sub` procedure."},{"pos":[1380,1386],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1694,1699],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"content":"Optional.","pos":[1735,1744]},{"content":"See <bpt id=\"p1\">[</bpt>Attribute List<ept id=\"p1\">](attribute-list.md)</ept>.","pos":[1745,1785],"source":" See [Attribute List](attribute-list.md)."},{"content":"Optional.","pos":[1815,1824]},{"content":"Indicates definition of a partial method.","pos":[1825,1866]},{"content":"See <bpt id=\"p1\">[</bpt>Partial Methods<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/partial-methods.md)</ept>.","pos":[1867,1978],"source":" See [Partial Methods](../../../visual-basic/programming-guide/language-features/procedures/partial-methods.md)."},{"content":"Optional.","pos":[2015,2024]},{"content":"Can be one of the following:","pos":[2025,2053]},{"pos":[2067,2099],"content":"<bpt id=\"p1\">[</bpt>Public<ept id=\"p1\">](../modifiers/public.md)</ept>","source":"[Public](../modifiers/public.md)"},{"pos":[2113,2151],"content":"<bpt id=\"p1\">[</bpt>Protected<ept id=\"p1\">](../modifiers/protected.md)</ept>","source":"[Protected](../modifiers/protected.md)"},{"pos":[2165,2197],"content":"<bpt id=\"p1\">[</bpt>Friend<ept id=\"p1\">](../modifiers/friend.md)</ept>","source":"[Friend](../modifiers/friend.md)"},{"pos":[2211,2245],"content":"<bpt id=\"p1\">[</bpt>Private<ept id=\"p1\">](../modifiers/private.md)</ept>","source":"[Private](../modifiers/private.md)"},{"pos":[2257,2331],"content":"<bpt id=\"p1\">[</bpt>Protected Friend<ept id=\"p1\">](../../language-reference/modifiers/protected-friend.md)</ept>","source":"[Protected Friend](../../language-reference/modifiers/protected-friend.md)"},{"pos":[2339,2415],"content":"<bpt id=\"p1\">[</bpt>Private Protected<ept id=\"p1\">](../../language-reference/modifiers/private-protected.md)</ept>","source":"[Private Protected](../../language-reference/modifiers/private-protected.md)"},{"pos":[2424,2554],"content":"See <bpt id=\"p1\">[</bpt>Access levels in Visual Basic<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)</ept>.","source":"See [Access levels in Visual Basic](../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)."},{"content":"Optional.","pos":[2595,2604]},{"content":"Can be one of the following:","pos":[2605,2633]},{"pos":[2647,2685],"content":"<bpt id=\"p1\">[</bpt>Overloads<ept id=\"p1\">](../modifiers/overloads.md)</ept>","source":"[Overloads](../modifiers/overloads.md)"},{"pos":[2699,2737],"content":"<bpt id=\"p1\">[</bpt>Overrides<ept id=\"p1\">](../modifiers/overrides.md)</ept>","source":"[Overrides](../modifiers/overrides.md)"},{"pos":[2751,2793],"content":"<bpt id=\"p1\">[</bpt>Overridable<ept id=\"p1\">](../modifiers/overridable.md)</ept>","source":"[Overridable](../modifiers/overridable.md)"},{"pos":[2807,2855],"content":"<bpt id=\"p1\">[</bpt>NotOverridable<ept id=\"p1\">](../modifiers/notoverridable.md)</ept>","source":"[NotOverridable](../modifiers/notoverridable.md)"},{"pos":[2869,2913],"content":"<bpt id=\"p1\">[</bpt>MustOverride<ept id=\"p1\">](../modifiers/mustoverride.md)</ept>","source":"[MustOverride](../modifiers/mustoverride.md)"},{"content":"Optional.","pos":[3020,3029]},{"content":"See <bpt id=\"p1\">[</bpt>Shared<ept id=\"p1\">](../modifiers/shared.md)</ept>.","pos":[3030,3067],"source":" See [Shared](../modifiers/shared.md)."},{"content":"Optional.","pos":[3097,3106]},{"content":"See <bpt id=\"p1\">[</bpt>Shadows<ept id=\"p1\">](../modifiers/shadows.md)</ept>.","pos":[3107,3146],"source":" See [Shadows](../modifiers/shadows.md)."},{"content":"Optional.","pos":[3174,3183]},{"content":"See <bpt id=\"p1\">[</bpt>Async<ept id=\"p1\">](../modifiers/async.md)</ept>.","pos":[3184,3219],"source":" See [Async](../modifiers/async.md)."},{"content":"Required.","pos":[3246,3255]},{"content":"Name of the procedure.","pos":[3256,3278]},{"content":"See <bpt id=\"p1\">[</bpt>Declared Element Names<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)</ept>.","pos":[3279,3411],"source":" See [Declared Element Names](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)."},{"content":"To create a constructor procedure for a class, set the name of a <ph id=\"ph1\">`Sub`</ph> procedure to the <ph id=\"ph2\">`New`</ph> keyword.","pos":[3412,3514],"source":" To create a constructor procedure for a class, set the name of a `Sub` procedure to the `New` keyword."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Object Lifetime: How Objects Are Created and Destroyed<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/objects-and-classes/object-lifetime-how-objects-are-created-and-destroyed.md)</ept>.","pos":[3515,3734],"source":" For more information, see [Object Lifetime: How Objects Are Created and Destroyed](../../../visual-basic/programming-guide/language-features/objects-and-classes/object-lifetime-how-objects-are-created-and-destroyed.md)."},{"content":"Optional.","pos":[3770,3779]},{"content":"List of type parameters for a generic procedure.","pos":[3780,3828]},{"content":"See <bpt id=\"p1\">[</bpt>Type List<ept id=\"p1\">](type-list.md)</ept>.","pos":[3829,3859],"source":" See [Type List](type-list.md)."},{"content":"Optional.","pos":[3895,3904]},{"content":"List of local variable names representing the parameters of this procedure.","pos":[3905,3980]},{"content":"See <bpt id=\"p1\">[</bpt>Parameter List<ept id=\"p1\">](parameter-list.md)</ept>.","pos":[3981,4021],"source":" See [Parameter List](parameter-list.md)."},{"content":"Optional.","pos":[4054,4063]},{"content":"Indicates that this procedure implements one or more <ph id=\"ph1\">`Sub`</ph> procedures, each one defined in an interface implemented by this procedure's containing class or structure.","pos":[4064,4230],"source":" Indicates that this procedure implements one or more `Sub` procedures, each one defined in an interface implemented by this procedure's containing class or structure."},{"content":"See <bpt id=\"p1\">[</bpt>Implements Statement<ept id=\"p1\">](implements-statement.md)</ept>.","pos":[4231,4283],"source":" See [Implements Statement](implements-statement.md)."},{"content":"Required if <ph id=\"ph1\">`Implements`</ph> is supplied.","pos":[4320,4357],"source":"Required if `Implements` is supplied."},{"content":"List of <ph id=\"ph1\">`Sub`</ph> procedures being implemented.","pos":[4358,4401],"source":" List of `Sub` procedures being implemented."},{"pos":[4476,4539],"content":"Each <ph id=\"ph1\">`implementedprocedure`</ph> has the following syntax and parts:","source":"Each `implementedprocedure` has the following syntax and parts:"},{"content":"Part","pos":[4584,4588]},{"content":"Description","pos":[4589,4600]},{"content":"Required.","pos":[4637,4646]},{"content":"Name of an interface implemented by this procedure's containing class or structure.","pos":[4647,4730]},{"content":"Required.","pos":[4753,4762]},{"content":"Name by which the procedure is defined in <ph id=\"ph1\">`interface`</ph>.","pos":[4763,4817],"source":" Name by which the procedure is defined in `interface`."},{"content":"Optional.","pos":[4848,4857]},{"content":"Indicates that this procedure can handle one or more specific events.","pos":[4858,4927]},{"content":"See <bpt id=\"p1\">[</bpt>Handles<ept id=\"p1\">](handles-clause.md)</ept>.","pos":[4928,4961],"source":" See [Handles](handles-clause.md)."},{"content":"Required if <ph id=\"ph1\">`Handles`</ph> is supplied.","pos":[4993,5027],"source":"Required if `Handles` is supplied."},{"content":"List of events this procedure handles.","pos":[5028,5066]},{"pos":[5129,5186],"content":"Each <ph id=\"ph1\">`eventspecifier`</ph> has the following syntax and parts:","source":"Each `eventspecifier` has the following syntax and parts:"},{"content":"Part","pos":[5229,5233]},{"content":"Description","pos":[5234,5245]},{"content":"Required.","pos":[5286,5295]},{"content":"Object variable declared with the data type of the class or structure that raises the event.","pos":[5296,5388]},{"content":"Required.","pos":[5405,5414]},{"content":"Name of the event this procedure handles.","pos":[5415,5456]},{"content":"Optional.","pos":[5490,5499]},{"content":"Block of statements to run within this procedure.","pos":[5500,5549]},{"content":"Terminates the definition of this procedure.","pos":[5579,5623]},{"pos":[5632,5639],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"All executable code must be inside a procedure.","pos":[5643,5690]},{"content":"Use a <ph id=\"ph1\">`Sub`</ph> procedure when you don't want to return a value to the calling code.","pos":[5691,5771],"source":" Use a `Sub` procedure when you don't want to return a value to the calling code."},{"content":"Use a <ph id=\"ph1\">`Function`</ph> procedure when you want to return a value.","pos":[5772,5831],"source":" Use a `Function` procedure when you want to return a value."},{"pos":[5840,5864],"content":"Defining a Sub Procedure","linkify":"Defining a Sub Procedure","nodes":[{"content":"Defining a Sub Procedure","pos":[0,24]}]},{"content":"You can define a <ph id=\"ph1\">`Sub`</ph> procedure only at the module level.","pos":[5868,5926],"source":"You can define a `Sub` procedure only at the module level."},{"content":"The declaration context for a sub procedure must, therefore, be a class, a structure, a module, or an interface and can't be a source file, a namespace, a procedure, or a block.","pos":[5927,6104]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Declaration Contexts and Default Access Levels<ept id=\"p1\">](declaration-contexts-and-default-access-levels.md)</ept>.","pos":[6105,6231],"source":" For more information, see [Declaration Contexts and Default Access Levels](declaration-contexts-and-default-access-levels.md)."},{"content":"<ph id=\"ph1\">`Sub`</ph> procedures default to public access.","pos":[6238,6280],"source":"`Sub` procedures default to public access."},{"content":"You can adjust their access levels by using the access modifiers.","pos":[6281,6346]},{"content":"If the procedure uses the <ph id=\"ph1\">`Implements`</ph> keyword, the containing class or structure must have an <ph id=\"ph2\">`Implements`</ph> statement that immediately follows its <ph id=\"ph3\">`Class`</ph> or <ph id=\"ph4\">`Structure`</ph> statement.","pos":[6353,6533],"source":"If the procedure uses the `Implements` keyword, the containing class or structure must have an `Implements` statement that immediately follows its `Class` or `Structure` statement."},{"content":"The <ph id=\"ph1\">`Implements`</ph> statement must include each interface that's specified in <ph id=\"ph2\">`implementslist`</ph>.","pos":[6534,6626],"source":" The `Implements` statement must include each interface that's specified in `implementslist`."},{"content":"However, the name by which an interface defines the <ph id=\"ph1\">`Sub`</ph> (in <ph id=\"ph2\">`definedname`</ph>) doesn't have to match the name of this procedure (in <ph id=\"ph3\">`name`</ph>).","pos":[6627,6765],"source":" However, the name by which an interface defines the `Sub` (in `definedname`) doesn't have to match the name of this procedure (in `name`)."},{"pos":[6774,6804],"content":"Returning from a Sub Procedure","linkify":"Returning from a Sub Procedure","nodes":[{"content":"Returning from a Sub Procedure","pos":[0,30]}]},{"pos":[6808,6934],"content":"When a <ph id=\"ph1\">`Sub`</ph> procedure returns to the calling code, execution continues with the statement after the statement that called it.","source":"When a `Sub` procedure returns to the calling code, execution continues with the statement after the statement that called it."},{"pos":[6941,7001],"content":"The following example shows a return from a <ph id=\"ph1\">`Sub`</ph> procedure.","source":"The following example shows a return from a `Sub` procedure."},{"content":"The <ph id=\"ph1\">`Exit Sub`</ph> and <ph id=\"ph2\">`Return`</ph> statements cause an immediate exit from a <ph id=\"ph3\">`Sub`</ph> procedure.","pos":[7080,7166],"source":"The `Exit Sub` and `Return` statements cause an immediate exit from a `Sub` procedure."},{"content":"Any number of <ph id=\"ph1\">`Exit Sub`</ph> and <ph id=\"ph2\">`Return`</ph> statements can appear anywhere in the procedure, and you can mix <ph id=\"ph3\">`Exit Sub`</ph> and <ph id=\"ph4\">`Return`</ph> statements.","pos":[7167,7305],"source":" Any number of `Exit Sub` and `Return` statements can appear anywhere in the procedure, and you can mix `Exit Sub` and `Return` statements."},{"pos":[7314,7337],"content":"Calling a Sub Procedure","linkify":"Calling a Sub Procedure","nodes":[{"content":"Calling a Sub Procedure","pos":[0,23]}]},{"content":"You call a <ph id=\"ph1\">`Sub`</ph> procedure by using the procedure name in a statement and then following that name with its argument list in parentheses.","pos":[7341,7478],"source":"You call a `Sub` procedure by using the procedure name in a statement and then following that name with its argument list in parentheses."},{"content":"You can omit the parentheses only if you don't supply any arguments.","pos":[7479,7547]},{"content":"However, your code is more readable if you always include the parentheses.","pos":[7548,7622]},{"content":"A <ph id=\"ph1\">`Sub`</ph> procedure and a <ph id=\"ph2\">`Function`</ph> procedure  can have parameters and perform a series of statements.","pos":[7629,7730],"source":"A `Sub` procedure and a `Function` procedure  can have parameters and perform a series of statements."},{"content":"However, a <ph id=\"ph1\">`Function`</ph> procedure returns a value, and a <ph id=\"ph2\">`Sub`</ph> procedure doesn't.","pos":[7731,7810],"source":" However, a `Function` procedure returns a value, and a `Sub` procedure doesn't."},{"content":"Therefore, you can't use a <ph id=\"ph1\">`Sub`</ph> procedure in an expression.","pos":[7811,7871],"source":" Therefore, you can't use a `Sub` procedure in an expression."},{"content":"You can use the <ph id=\"ph1\">`Call`</ph> keyword when you call a <ph id=\"ph2\">`Sub`</ph> procedure, but that keyword isn't recommended for most uses.","pos":[7878,7991],"source":"You can use the `Call` keyword when you call a `Sub` procedure, but that keyword isn't recommended for most uses."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Call Statement<ept id=\"p1\">](call-statement.md)</ept>.","pos":[7992,8054],"source":" For more information, see [Call Statement](call-statement.md)."},{"content":"Visual Basic sometimes rearranges arithmetic expressions to increase internal efficiency.","pos":[8061,8150]},{"content":"For that reason, if your argument list includes expressions that call other procedures, you shouldn't assume that those expressions will be called in a particular order.","pos":[8151,8320]},{"pos":[8329,8349],"content":"Async Sub Procedures","linkify":"Async Sub Procedures","nodes":[{"content":"Async Sub Procedures","pos":[0,20]}]},{"content":"By using the Async feature, you can invoke asynchronous functions without using explicit callbacks or manually splitting your code across multiple functions or lambda expressions.","pos":[8353,8532]},{"content":"If you mark a procedure with the <bpt id=\"p1\">[</bpt>Async<ept id=\"p1\">](../modifiers/async.md)</ept> modifier, you can use the <bpt id=\"p2\">[</bpt>Await<ept id=\"p2\">](../../../visual-basic/language-reference/operators/await-operator.md)</ept> operator in the procedure.","pos":[8539,8733],"source":"If you mark a procedure with the [Async](../modifiers/async.md) modifier, you can use the [Await](../../../visual-basic/language-reference/operators/await-operator.md) operator in the procedure."},{"content":"When control reaches an <ph id=\"ph1\">`Await`</ph> expression in the <ph id=\"ph2\">`Async`</ph> procedure, control returns to the caller, and progress in the procedure is suspended until the awaited task completes.","pos":[8734,8910],"source":" When control reaches an `Await` expression in the `Async` procedure, control returns to the caller, and progress in the procedure is suspended until the awaited task completes."},{"content":"When the task is complete, execution can resume in the procedure.","pos":[8911,8976]},{"pos":[8984,9185],"content":"[!NOTE]\n An `Async` procedure returns to the caller when either the first awaited object that’s not yet complete is encountered or the end of the `Async` procedure is reached, whichever occurs first.","leadings":["","> "],"nodes":[{"content":"An <ph id=\"ph1\">`Async`</ph> procedure returns to the caller when either the first awaited object that’s not yet complete is encountered or the end of the <ph id=\"ph2\">`Async`</ph> procedure is reached, whichever occurs first.","pos":[9,199],"source":"An `Async` procedure returns to the caller when either the first awaited object that’s not yet complete is encountered or the end of the `Async` procedure is reached, whichever occurs first."}]},{"content":"You can also mark a <bpt id=\"p1\">[</bpt>Function Statement<ept id=\"p1\">](function-statement.md)</ept> with the <ph id=\"ph1\">`Async`</ph> modifier.","pos":[9192,9282],"source":"You can also mark a [Function Statement](function-statement.md) with the `Async` modifier."},{"content":"An <ph id=\"ph1\">`Async`</ph> function can have a return type of <ph id=\"ph2\">&lt;xref:System.Threading.Tasks.Task%601&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Threading.Tasks.Task&gt;</ph>.","pos":[9283,9406],"source":" An `Async` function can have a return type of <xref:System.Threading.Tasks.Task%601> or <xref:System.Threading.Tasks.Task>."},{"content":"An example later in this topic shows an <ph id=\"ph1\">`Async`</ph> function that has a return type of <ph id=\"ph2\">&lt;xref:System.Threading.Tasks.Task%601&gt;</ph>.","pos":[9407,9529],"source":" An example later in this topic shows an `Async` function that has a return type of <xref:System.Threading.Tasks.Task%601>."},{"content":"<ph id=\"ph1\">`Async`</ph> <ph id=\"ph2\">`Sub`</ph> procedures are primarily used for event handlers, where a value can't be returned.","pos":[9536,9632],"source":"`Async` `Sub` procedures are primarily used for event handlers, where a value can't be returned."},{"content":"An <ph id=\"ph1\">`Async`</ph> <ph id=\"ph2\">`Sub`</ph> procedure can't be awaited, and the caller of an <ph id=\"ph3\">`Async`</ph> <ph id=\"ph4\">`Sub`</ph> procedure can't catch exceptions that the <ph id=\"ph5\">`Sub`</ph> procedure throws.","pos":[9633,9778],"source":" An `Async` `Sub` procedure can't be awaited, and the caller of an `Async` `Sub` procedure can't catch exceptions that the `Sub` procedure throws."},{"pos":[9785,9866],"content":"An <ph id=\"ph1\">`Async`</ph> procedure can't declare any <bpt id=\"p1\">[</bpt>ByRef<ept id=\"p1\">](../modifiers/byref.md)</ept> parameters.","source":"An `Async` procedure can't declare any [ByRef](../modifiers/byref.md) parameters."},{"pos":[9873,10265],"content":"For more information about <ph id=\"ph1\">`Async`</ph> procedures, see <bpt id=\"p1\">[</bpt>Asynchronous Programming with Async and Await<ept id=\"p1\">](../../../visual-basic/programming-guide/concepts/async/index.md)</ept>, <bpt id=\"p2\">[</bpt>Control Flow in Async Programs<ept id=\"p2\">](../../../visual-basic/programming-guide/concepts/async/control-flow-in-async-programs.md)</ept>, and <bpt id=\"p3\">[</bpt>Async Return Types<ept id=\"p3\">](../../../visual-basic/programming-guide/concepts/async/async-return-types.md)</ept>.","source":"For more information about `Async` procedures, see [Asynchronous Programming with Async and Await](../../../visual-basic/programming-guide/concepts/async/index.md), [Control Flow in Async Programs](../../../visual-basic/programming-guide/concepts/async/control-flow-in-async-programs.md), and [Async Return Types](../../../visual-basic/programming-guide/concepts/async/async-return-types.md)."},{"pos":[10274,10281],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[10285,10413],"content":"The following example uses the <ph id=\"ph1\">`Sub`</ph> statement to define the name, parameters, and code that form the body of a <ph id=\"ph2\">`Sub`</ph> procedure.","source":"The following example uses the `Sub` statement to define the name, parameters, and code that form the body of a `Sub` procedure."},{"pos":[10548,10555],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In the following example, <ph id=\"ph1\">`DelayAsync`</ph> is an <ph id=\"ph2\">`Async`</ph> <ph id=\"ph3\">`Function`</ph> that has a return type of <ph id=\"ph4\">&lt;xref:System.Threading.Tasks.Task%601&gt;</ph>.","pos":[10559,10688],"source":"In the following example, `DelayAsync` is an `Async` `Function` that has a return type of <xref:System.Threading.Tasks.Task%601>."},{"content":"<ph id=\"ph1\">`DelayAsync`</ph> has a <ph id=\"ph2\">`Return`</ph> statement that returns an integer.","pos":[10689,10751],"source":"`DelayAsync` has a `Return` statement that returns an integer."},{"content":"Therefore, the function declaration of <ph id=\"ph1\">`DelayAsync`</ph> must have a return type of <ph id=\"ph2\">`Task(Of Integer)`</ph>.","pos":[10752,10850],"source":" Therefore, the function declaration of `DelayAsync` must have a return type of `Task(Of Integer)`."},{"content":"Because the return type is <ph id=\"ph1\">`Task(Of Integer)`</ph>, the evaluation of the <ph id=\"ph2\">`Await`</ph> expression in <ph id=\"ph3\">`DoSomethingAsync`</ph> produces an integer, as the following statement shows: <ph id=\"ph4\">`Dim result As Integer = Await delayTask`</ph>.","pos":[10851,11058],"source":" Because the return type is `Task(Of Integer)`, the evaluation of the `Await` expression in `DoSomethingAsync` produces an integer, as the following statement shows: `Dim result As Integer = Await delayTask`."},{"content":"The <ph id=\"ph1\">`startButton_Click`</ph> procedure is an example of an <ph id=\"ph2\">`Async Sub`</ph> procedure.","pos":[11065,11141],"source":"The `startButton_Click` procedure is an example of an `Async Sub` procedure."},{"content":"Because <ph id=\"ph1\">`DoSomethingAsync`</ph> is an <ph id=\"ph2\">`Async`</ph> function, the task for the call to <ph id=\"ph3\">`DoSomethingAsync`</ph> must be awaited, as the following statement shows: <ph id=\"ph4\">`Await DoSomethingAsync()`</ph>.","pos":[11142,11315],"source":" Because `DoSomethingAsync` is an `Async` function, the task for the call to `DoSomethingAsync` must be awaited, as the following statement shows: `Await DoSomethingAsync()`."},{"content":"The <ph id=\"ph1\">`startButton_Click`</ph> <ph id=\"ph2\">`Sub`</ph> procedure must be defined with the <ph id=\"ph3\">`Async`</ph> modifier because it has an <ph id=\"ph4\">`Await`</ph> expression.","pos":[11316,11435],"source":" The `startButton_Click` `Sub` procedure must be defined with the `Async` modifier because it has an `Await` expression."},{"pos":[11569,11577],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[11581,11628],"content":"<bpt id=\"p1\">[</bpt>Implements Statement<ept id=\"p1\">](implements-statement.md)</ept>","source":"[Implements Statement](implements-statement.md)"},{"pos":[11631,11674],"content":"<bpt id=\"p1\">[</bpt>Function Statement<ept id=\"p1\">](function-statement.md)</ept>","source":"[Function Statement](function-statement.md)"},{"pos":[11677,11712],"content":"<bpt id=\"p1\">[</bpt>Parameter List<ept id=\"p1\">](parameter-list.md)</ept>","source":"[Parameter List](parameter-list.md)"},{"pos":[11715,11748],"content":"<bpt id=\"p1\">[</bpt>Dim Statement<ept id=\"p1\">](dim-statement.md)</ept>","source":"[Dim Statement](dim-statement.md)"},{"pos":[11751,11786],"content":"<bpt id=\"p1\">[</bpt>Call Statement<ept id=\"p1\">](call-statement.md)</ept>","source":"[Call Statement](call-statement.md)"},{"pos":[11789,11807],"content":"<bpt id=\"p1\">[</bpt>Of<ept id=\"p1\">](of-clause.md)</ept>","source":"[Of](of-clause.md)"},{"pos":[11810,11918],"content":"<bpt id=\"p1\">[</bpt>Parameter Arrays<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/parameter-arrays.md)</ept>","source":"[Parameter Arrays](../../../visual-basic/programming-guide/language-features/procedures/parameter-arrays.md)"},{"pos":[11921,12050],"content":"<bpt id=\"p1\">[</bpt>How to: Use a Generic Class<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/how-to-use-a-generic-class.md)</ept>","source":"[How to: Use a Generic Class](../../../visual-basic/programming-guide/language-features/data-types/how-to-use-a-generic-class.md)"},{"pos":[12053,12181],"content":"<bpt id=\"p1\">[</bpt>Troubleshooting Procedures<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/troubleshooting-procedures.md)</ept>","source":"[Troubleshooting Procedures](../../../visual-basic/programming-guide/language-features/procedures/troubleshooting-procedures.md)"},{"pos":[12184,12290],"content":"<bpt id=\"p1\">[</bpt>Partial Methods<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/partial-methods.md)</ept>","source":"[Partial Methods](../../../visual-basic/programming-guide/language-features/procedures/partial-methods.md)"}]}