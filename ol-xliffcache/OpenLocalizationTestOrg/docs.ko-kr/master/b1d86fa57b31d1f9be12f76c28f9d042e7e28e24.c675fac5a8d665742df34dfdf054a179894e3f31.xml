{"content":"---\ntitle: \"WS-AtomicTransaction Configuration MMC Snap-in\"\nms.date: \"03/30/2017\"\nms.assetid: 23592973-1d51-44cc-b887-bf8b0d801e9e\n---\n# WS-AtomicTransaction Configuration MMC Snap-in\nThe WS-AtomicTransaction Configuration MMC Snap-in is used to configure a portion of the WS-AtomicTransaction settings on both local and remote machines.  \n  \n## Remarks  \n If you are running [!INCLUDE[wxp](../../../includes/wxp-md.md)] or [!INCLUDE[ws2003](../../../includes/ws2003-md.md)], the MMC snap-in can be found by navigating to **Control Panel/Administrative Tools/Component Services/**, right-clicking **My Computer**, and selecting **Properties**. This is the same location where you can configure the MSDTC. Options available for configuration are grouped under the **WS-AT** tab.  \n  \n If you are running Windows Vista or [!INCLUDE[lserver](../../../includes/lserver-md.md)], MMC snap-in can be found by clicking the **Start** button, and typing in `dcomcnfg.exe` in the **Search** box. When the MMC is opened, navigate to the **My Computer\\Distributed Transaction Coordinator\\Local DTC** node, right click and select **Properties**. Options available for configuration are grouped under the **WS-AT** tab.  \n  \n The previous steps are used to launch the snap-in for configuring a local machine. If you want to configure a remote machine, you should locate the remote machine's name in **Control Panel/Administrative Tools/Component Services/**, and perform similar steps if you are running [!INCLUDE[wxp](../../../includes/wxp-md.md)] or [!INCLUDE[ws2003](../../../includes/ws2003-md.md)]. If you are running Windows Vista or [!INCLUDE[lserver](../../../includes/lserver-md.md)], follow the previous steps for Vista and [!INCLUDE[lserver](../../../includes/lserver-md.md)], but use the **Distributed Transaction Coordinator\\Local DTC** node under the remote computer's node.  \n  \n To use the user interface provided by the tool, you have to register the WsatUI.dll file, which is located at the following path,  \n  \n **%PROGRAMFILES%\\Microsoft SDKs\\Windows\\v6.0\\Bin\\WsatUI.dll**  \n  \n The registration can be done by the following command.  \n  \n```Output  \nregasm.exe /codebase WsatUI.dll  \n```  \n  \n You can use this tool to modify the basic WS-AtomicTransaction settings. For example, you can enable and disable the WS-AtomicTransaction protocol support, configure the HTTP ports for WS-AT, bind an SSL Certificate to the HTTP port, configure certificates by specifying certificate subject names, select the Tracing mode and set default and maximum timeouts.  \n  \n If you must configure WS-AtomicTransaction support on the local machine only, you can use the command line version of this tool. For more information about the command line tool, see the [WS-AtomicTransaction Configuration Utility (wsatConfig.exe)](../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md) topic.  \n  \n You should be aware that both the MMC Snap-in and the command-line tool do not support configuring all WS-AT settings. These settings can be edited only by modifying the registry directly. For more information about these registry settings, see [Configuring WS-Atomic Transaction Support](../../../docs/framework/wcf/feature-details/configuring-ws-atomic-transaction-support.md).  \n  \n### User Interface Description  \n **Enable WS-Atomic Transaction Network Support**:  \n  \n Toggling this checkbox enables or disables all the GUI components of this snap-in.  \n  \n Before you check this box, you should make sure that Network DTC Access is enabled with inbound or outbound communication, or both. This value can be verified in the **Security** Tab of the MSDTC snap-in.  \n  \n#### Network Group Box  \n You can specify the HTTPS port and additional security settings such as SSL encryption in the Network group. This group is disabled (grayed out) if DTC Network Transactions are not enabled.  \n  \n **HTTPS Port**  \n  \n This is the value of the HTTPS port used for WS-AT. The value must be a number in the range 1-65535 (as to represent a valid port). Changing the HTTP Port modifies the HTTP Service Configuration, which means that the previously used WS-AT Service Address is released, and a new WS-AT Service Address is registered based on the new port. In addition, the newly selected port is encrypted with the currently selected certificate for SSL Encryption.  \n  \n> [!NOTE]\n>  If you have already enabled the firewall before running this tool, the port is automatically registered in the exception list. If the firewall is disabled before running this tool, nothing additional is configured regarding the firewall.  \n  \n If you enable the firewall after configuring WS-AT, you must run this tool again and supply the port number using this parameter. If you disable the firewall after configuring, WS-AT continues to work without additional input.  \n  \n **Endpoint Certificate**  \n  \n Clicking the **Select** button displays a list with the currently available certificates on the Local Machine, allowing the user to select the certificate that can be used for SSL encryption. The certificates must have a private key. Otherwise, you receive an error message.  \n  \n> [!NOTE]\n>  When you set an SSL certificate for a selected port, you overwrite the original SSL certificate associated with that port if one exists.  \n  \n **Authorized Accounts**  \n  \n Clicking the **Select** button invokes the Windows Access Control List editor, where you can specify the user or group that can participate in WS-Atomic transactions by checking the **Allow** or **Deny** box in the **Participate** permission group.  \n  \n **Authorized Certificates**  \n  \n Clicking the **Select** button displays a list of currently available certificates on the LocalMachine. You can then select which certificate identities are allowed to participate in WS-Atomic transactions.  \n  \n#### Timeout Group Box  \n The **Timeout** group box allows you to specify the default and maximum timeout for a WS-Atomic transaction. A valid value for outgoing timeout is between 1 and 3600. A valid value for incoming timeout is between 0 and 3600.  \n  \n#### Tracing and Logging Group Box  \n The **Tracing and Logging** group Box allows you to configure the desired tracing and logging level.  \n  \n Clicking the **Options** button invokes a page where you can specify additional settings.  \n  \n The **Trace Level** combination box allows you to choose from any valid value of the <xref:System.Diagnostics.TraceLevel> enumeration. You can also use the checkboxes to specify if you want to perform activity tracing, activity propagation or collect personal identifiable information.  \n  \n You can also specify logging sessions in the **Logging Session** group box.  \n  \n> [!NOTE]\n>  When another trace consumer is using the WS-AT trace provider, you cannot create a new logging session for trace events. Any attempt to configure logging during this time results in the error message \"Failed to enable provider. Error code: 1\".  \n  \n For more information about tracing and logging, see [Administration and Diagnostics](../../../docs/framework/wcf/diagnostics/index.md).  \n  \n## See also\n\n- [Configuring WS-Atomic Transaction Support](../../../docs/framework/wcf/feature-details/configuring-ws-atomic-transaction-support.md)\n- [WS-AtomicTransaction Configuration Utility (wsatConfig.exe)](../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md)\n- [Administration and Diagnostics](../../../docs/framework/wcf/diagnostics/index.md)\n","nodes":[{"pos":[4,130],"embed":true,"restype":"x-metadata","content":"title: \"WS-AtomicTransaction Configuration MMC Snap-in\"\nms.date: \"03/30/2017\"\nms.assetid: 23592973-1d51-44cc-b887-bf8b0d801e9e","nodes":[{"content":"WS-AtomicTransaction Configuration MMC Snap-in","nodes":[{"pos":[0,46],"content":"WS-AtomicTransaction Configuration MMC Snap-in","nodes":[{"content":"WS-AtomicTransaction Configuration MMC Snap-in","pos":[0,46]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[137,183],"content":"WS-AtomicTransaction Configuration MMC Snap-in","linkify":"WS-AtomicTransaction Configuration MMC Snap-in","nodes":[{"content":"WS-AtomicTransaction Configuration MMC Snap-in","pos":[0,46]}]},{"content":"The WS-AtomicTransaction Configuration MMC Snap-in is used to configure a portion of the WS-AtomicTransaction settings on both local and remote machines.","pos":[184,337]},{"pos":[346,353],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If you are running <ph id=\"ph1\">[!INCLUDE[wxp](../../../includes/wxp-md.md)]</ph> or <ph id=\"ph2\">[!INCLUDE[ws2003](../../../includes/ws2003-md.md)]</ph>, the MMC snap-in can be found by navigating to <bpt id=\"p1\">**</bpt>Control Panel/Administrative Tools/Component Services/<ept id=\"p1\">**</ept>, right-clicking <bpt id=\"p2\">**</bpt>My Computer<ept id=\"p2\">**</ept>, and selecting <bpt id=\"p3\">**</bpt>Properties<ept id=\"p3\">**</ept>.","pos":[357,643],"source":"If you are running [!INCLUDE[wxp](../../../includes/wxp-md.md)] or [!INCLUDE[ws2003](../../../includes/ws2003-md.md)], the MMC snap-in can be found by navigating to **Control Panel/Administrative Tools/Component Services/**, right-clicking **My Computer**, and selecting **Properties**."},{"content":"This is the same location where you can configure the MSDTC.","pos":[644,704]},{"content":"Options available for configuration are grouped under the <bpt id=\"p1\">**</bpt>WS-AT<ept id=\"p1\">**</ept> tab.","pos":[705,777],"source":" Options available for configuration are grouped under the **WS-AT** tab."},{"content":"If you are running Windows Vista or <ph id=\"ph1\">[!INCLUDE[lserver](../../../includes/lserver-md.md)]</ph>, MMC snap-in can be found by clicking the <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> button, and typing in <ph id=\"ph2\">`dcomcnfg.exe`</ph> in the <bpt id=\"p2\">**</bpt>Search<ept id=\"p2\">**</ept> box.","pos":[784,984],"source":"If you are running Windows Vista or [!INCLUDE[lserver](../../../includes/lserver-md.md)], MMC snap-in can be found by clicking the **Start** button, and typing in `dcomcnfg.exe` in the **Search** box."},{"content":"When the MMC is opened, navigate to the <bpt id=\"p1\">**</bpt>My Computer\\Distributed Transaction Coordinator\\Local DTC<ept id=\"p1\">**</ept> node, right click and select <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","pos":[985,1131],"source":" When the MMC is opened, navigate to the **My Computer\\Distributed Transaction Coordinator\\Local DTC** node, right click and select **Properties**."},{"content":"Options available for configuration are grouped under the <bpt id=\"p1\">**</bpt>WS-AT<ept id=\"p1\">**</ept> tab.","pos":[1132,1204],"source":" Options available for configuration are grouped under the **WS-AT** tab."},{"content":"The previous steps are used to launch the snap-in for configuring a local machine.","pos":[1211,1293]},{"content":"If you want to configure a remote machine, you should locate the remote machine's name in <bpt id=\"p1\">**</bpt>Control Panel/Administrative Tools/Component Services/<ept id=\"p1\">**</ept>, and perform similar steps if you are running <ph id=\"ph1\">[!INCLUDE[wxp](../../../includes/wxp-md.md)]</ph> or <ph id=\"ph2\">[!INCLUDE[ws2003](../../../includes/ws2003-md.md)]</ph>.","pos":[1294,1588],"source":" If you want to configure a remote machine, you should locate the remote machine's name in **Control Panel/Administrative Tools/Component Services/**, and perform similar steps if you are running [!INCLUDE[wxp](../../../includes/wxp-md.md)] or [!INCLUDE[ws2003](../../../includes/ws2003-md.md)]."},{"content":"If you are running Windows Vista or <ph id=\"ph1\">[!INCLUDE[lserver](../../../includes/lserver-md.md)]</ph>, follow the previous steps for Vista and <ph id=\"ph2\">[!INCLUDE[lserver](../../../includes/lserver-md.md)]</ph>, but use the <bpt id=\"p1\">**</bpt>Distributed Transaction Coordinator\\Local DTC<ept id=\"p1\">**</ept> node under the remote computer's node.","pos":[1589,1873],"source":" If you are running Windows Vista or [!INCLUDE[lserver](../../../includes/lserver-md.md)], follow the previous steps for Vista and [!INCLUDE[lserver](../../../includes/lserver-md.md)], but use the **Distributed Transaction Coordinator\\Local DTC** node under the remote computer's node."},{"content":"To use the user interface provided by the tool, you have to register the WsatUI.dll file, which is located at the following path,","pos":[1880,2009]},{"pos":[2016,2077],"content":"<bpt id=\"p1\">**</bpt>%PROGRAMFILES%\\Microsoft SDKs\\Windows\\v6.0\\Bin\\WsatUI.dll<ept id=\"p1\">**</ept>","source":"**%PROGRAMFILES%\\Microsoft SDKs\\Windows\\v6.0\\Bin\\WsatUI.dll**"},{"content":"The registration can be done by the following command.","pos":[2084,2138]},{"content":"You can use this tool to modify the basic WS-AtomicTransaction settings.","pos":[2200,2272]},{"content":"For example, you can enable and disable the WS-AtomicTransaction protocol support, configure the HTTP ports for WS-AT, bind an SSL Certificate to the HTTP port, configure certificates by specifying certificate subject names, select the Tracing mode and set default and maximum timeouts.","pos":[2273,2559]},{"content":"If you must configure WS-AtomicTransaction support on the local machine only, you can use the command line version of this tool.","pos":[2566,2694]},{"content":"For more information about the command line tool, see the <bpt id=\"p1\">[</bpt>WS-AtomicTransaction Configuration Utility (wsatConfig.exe)<ept id=\"p1\">](../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md)</ept> topic.","pos":[2695,2911],"source":" For more information about the command line tool, see the [WS-AtomicTransaction Configuration Utility (wsatConfig.exe)](../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md) topic."},{"content":"You should be aware that both the MMC Snap-in and the command-line tool do not support configuring all WS-AT settings.","pos":[2918,3036]},{"content":"These settings can be edited only by modifying the registry directly.","pos":[3037,3106]},{"content":"For more information about these registry settings, see <bpt id=\"p1\">[</bpt>Configuring WS-Atomic Transaction Support<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/configuring-ws-atomic-transaction-support.md)</ept>.","pos":[3107,3297],"source":" For more information about these registry settings, see [Configuring WS-Atomic Transaction Support](../../../docs/framework/wcf/feature-details/configuring-ws-atomic-transaction-support.md)."},{"pos":[3307,3333],"content":"User Interface Description","linkify":"User Interface Description","nodes":[{"content":"User Interface Description","pos":[0,26]}]},{"pos":[3337,3386],"content":"<bpt id=\"p1\">**</bpt>Enable WS-Atomic Transaction Network Support<ept id=\"p1\">**</ept>:","source":"**Enable WS-Atomic Transaction Network Support**:"},{"content":"Toggling this checkbox enables or disables all the GUI components of this snap-in.","pos":[3393,3475]},{"content":"Before you check this box, you should make sure that Network DTC Access is enabled with inbound or outbound communication, or both.","pos":[3482,3613]},{"content":"This value can be verified in the <bpt id=\"p1\">**</bpt>Security<ept id=\"p1\">**</ept> Tab of the MSDTC snap-in.","pos":[3614,3686],"source":" This value can be verified in the **Security** Tab of the MSDTC snap-in."},{"pos":[3697,3714],"content":"Network Group Box","linkify":"Network Group Box","nodes":[{"content":"Network Group Box","pos":[0,17]}]},{"content":"You can specify the HTTPS port and additional security settings such as SSL encryption in the Network group.","pos":[3718,3826]},{"content":"This group is disabled (grayed out) if DTC Network Transactions are not enabled.","pos":[3827,3907]},{"pos":[3914,3928],"content":"<bpt id=\"p1\">**</bpt>HTTPS Port<ept id=\"p1\">**</ept>","source":"**HTTPS Port**"},{"content":"This is the value of the HTTPS port used for WS-AT.","pos":[3935,3986]},{"content":"The value must be a number in the range 1-65535 (as to represent a valid port).","pos":[3987,4066]},{"content":"Changing the HTTP Port modifies the HTTP Service Configuration, which means that the previously used WS-AT Service Address is released, and a new WS-AT Service Address is registered based on the new port.","pos":[4067,4271]},{"content":"In addition, the newly selected port is encrypted with the currently selected certificate for SSL Encryption.","pos":[4272,4381]},{"pos":[4389,4637],"content":"[!NOTE]\n If you have already enabled the firewall before running this tool, the port is automatically registered in the exception list. If the firewall is disabled before running this tool, nothing additional is configured regarding the firewall.","leadings":["","> "],"nodes":[{"content":"If you have already enabled the firewall before running this tool, the port is automatically registered in the exception list. If the firewall is disabled before running this tool, nothing additional is configured regarding the firewall.","pos":[9,246],"nodes":[{"content":"If you have already enabled the firewall before running this tool, the port is automatically registered in the exception list.","pos":[0,126]},{"content":"If the firewall is disabled before running this tool, nothing additional is configured regarding the firewall.","pos":[127,237]}]}]},{"content":"If you enable the firewall after configuring WS-AT, you must run this tool again and supply the port number using this parameter.","pos":[4644,4773]},{"content":"If you disable the firewall after configuring, WS-AT continues to work without additional input.","pos":[4774,4870]},{"pos":[4877,4901],"content":"<bpt id=\"p1\">**</bpt>Endpoint Certificate<ept id=\"p1\">**</ept>","source":"**Endpoint Certificate**"},{"content":"Clicking the <bpt id=\"p1\">**</bpt>Select<ept id=\"p1\">**</ept> button displays a list with the currently available certificates on the Local Machine, allowing the user to select the certificate that can be used for SSL encryption.","pos":[4908,5099],"source":"Clicking the **Select** button displays a list with the currently available certificates on the Local Machine, allowing the user to select the certificate that can be used for SSL encryption."},{"content":"The certificates must have a private key.","pos":[5100,5141]},{"content":"Otherwise, you receive an error message.","pos":[5142,5182]},{"pos":[5190,5337],"content":"[!NOTE]\n When you set an SSL certificate for a selected port, you overwrite the original SSL certificate associated with that port if one exists.","leadings":["","> "],"nodes":[{"content":"When you set an SSL certificate for a selected port, you overwrite the original SSL certificate associated with that port if one exists.","pos":[9,145]}]},{"pos":[5344,5367],"content":"<bpt id=\"p1\">**</bpt>Authorized Accounts<ept id=\"p1\">**</ept>","source":"**Authorized Accounts**"},{"pos":[5374,5622],"content":"Clicking the <bpt id=\"p1\">**</bpt>Select<ept id=\"p1\">**</ept> button invokes the Windows Access Control List editor, where you can specify the user or group that can participate in WS-Atomic transactions by checking the <bpt id=\"p2\">**</bpt>Allow<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>Deny<ept id=\"p3\">**</ept> box in the <bpt id=\"p4\">**</bpt>Participate<ept id=\"p4\">**</ept> permission group.","source":"Clicking the **Select** button invokes the Windows Access Control List editor, where you can specify the user or group that can participate in WS-Atomic transactions by checking the **Allow** or **Deny** box in the **Participate** permission group."},{"pos":[5629,5656],"content":"<bpt id=\"p1\">**</bpt>Authorized Certificates<ept id=\"p1\">**</ept>","source":"**Authorized Certificates**"},{"content":"Clicking the <bpt id=\"p1\">**</bpt>Select<ept id=\"p1\">**</ept> button displays a list of currently available certificates on the LocalMachine.","pos":[5663,5766],"source":"Clicking the **Select** button displays a list of currently available certificates on the LocalMachine."},{"content":"You can then select which certificate identities are allowed to participate in WS-Atomic transactions.","pos":[5767,5869]},{"pos":[5880,5897],"content":"Timeout Group Box","linkify":"Timeout Group Box","nodes":[{"content":"Timeout Group Box","pos":[0,17]}]},{"content":"The <bpt id=\"p1\">**</bpt>Timeout<ept id=\"p1\">**</ept> group box allows you to specify the default and maximum timeout for a WS-Atomic transaction.","pos":[5901,6009],"source":"The **Timeout** group box allows you to specify the default and maximum timeout for a WS-Atomic transaction."},{"content":"A valid value for outgoing timeout is between 1 and 3600.","pos":[6010,6067]},{"content":"A valid value for incoming timeout is between 0 and 3600.","pos":[6068,6125]},{"pos":[6136,6165],"content":"Tracing and Logging Group Box","linkify":"Tracing and Logging Group Box","nodes":[{"content":"Tracing and Logging Group Box","pos":[0,29]}]},{"pos":[6169,6269],"content":"The <bpt id=\"p1\">**</bpt>Tracing and Logging<ept id=\"p1\">**</ept> group Box allows you to configure the desired tracing and logging level.","source":"The **Tracing and Logging** group Box allows you to configure the desired tracing and logging level."},{"pos":[6276,6365],"content":"Clicking the <bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> button invokes a page where you can specify additional settings.","source":"Clicking the **Options** button invokes a page where you can specify additional settings."},{"content":"The <bpt id=\"p1\">**</bpt>Trace Level<ept id=\"p1\">**</ept> combination box allows you to choose from any valid value of the <ph id=\"ph1\">&lt;xref:System.Diagnostics.TraceLevel&gt;</ph> enumeration.","pos":[6372,6506],"source":"The **Trace Level** combination box allows you to choose from any valid value of the <xref:System.Diagnostics.TraceLevel> enumeration."},{"content":"You can also use the checkboxes to specify if you want to perform activity tracing, activity propagation or collect personal identifiable information.","pos":[6507,6657]},{"pos":[6664,6739],"content":"You can also specify logging sessions in the <bpt id=\"p1\">**</bpt>Logging Session<ept id=\"p1\">**</ept> group box.","source":"You can also specify logging sessions in the **Logging Session** group box."},{"pos":[6747,7001],"content":"[!NOTE]\n When another trace consumer is using the WS-AT trace provider, you cannot create a new logging session for trace events. Any attempt to configure logging during this time results in the error message \"Failed to enable provider. Error code: 1\".","leadings":["","> "],"nodes":[{"content":"When another trace consumer is using the WS-AT trace provider, you cannot create a new logging session for trace events. Any attempt to configure logging during this time results in the error message \"Failed to enable provider. Error code: 1\".","pos":[9,252],"nodes":[{"content":"When another trace consumer is using the WS-AT trace provider, you cannot create a new logging session for trace events.","pos":[0,120]},{"content":"Any attempt to configure logging during this time results in the error message \"Failed to enable provider.","pos":[121,227]},{"content":"Error code: 1\".","pos":[228,243]}]}]},{"pos":[7008,7143],"content":"For more information about tracing and logging, see <bpt id=\"p1\">[</bpt>Administration and Diagnostics<ept id=\"p1\">](../../../docs/framework/wcf/diagnostics/index.md)</ept>.","source":"For more information about tracing and logging, see [Administration and Diagnostics](../../../docs/framework/wcf/diagnostics/index.md)."},{"pos":[7152,7160],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7164,7297],"content":"<bpt id=\"p1\">[</bpt>Configuring WS-Atomic Transaction Support<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/configuring-ws-atomic-transaction-support.md)</ept>","source":"[Configuring WS-Atomic Transaction Support](../../../docs/framework/wcf/feature-details/configuring-ws-atomic-transaction-support.md)"},{"pos":[7300,7451],"content":"<bpt id=\"p1\">[</bpt>WS-AtomicTransaction Configuration Utility (wsatConfig.exe)<ept id=\"p1\">](../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md)</ept>","source":"[WS-AtomicTransaction Configuration Utility (wsatConfig.exe)](../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md)"},{"pos":[7454,7536],"content":"<bpt id=\"p1\">[</bpt>Administration and Diagnostics<ept id=\"p1\">](../../../docs/framework/wcf/diagnostics/index.md)</ept>","source":"[Administration and Diagnostics](../../../docs/framework/wcf/diagnostics/index.md)"}]}