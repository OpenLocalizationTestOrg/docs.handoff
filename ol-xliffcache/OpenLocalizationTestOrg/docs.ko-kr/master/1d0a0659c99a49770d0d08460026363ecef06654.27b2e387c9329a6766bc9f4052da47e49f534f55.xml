{"content":"---\ntitle: \"Writing Custom Attributes\"\nms.date: \"07/17/2018\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"multiple attribute instances\"\n  - \"AttributeTargets enumeration\"\n  - \"attributes [.NET Framework], custom\"\n  - \"AllowMultiple property\"\n  - \"custom attributes\"\n  - \"AttributeUsageAttribute class, custom attributes\"\n  - \"Inherited property\"\n  - \"attribute classes, declaring\"\nms.assetid: 97216f69-bde8-49fd-ac40-f18c500ef5dc\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# Writing Custom Attributes\nTo design your own custom attributes, you do not need to master many new concepts. If you are familiar with object-oriented programming and know how to design classes, you already have most of the knowledge needed. Custom attributes are essentially traditional classes that derive directly or indirectly from <xref:System.Attribute?displayProperty=nameWithType>. Just like traditional classes, custom attributes contain methods that store and retrieve data.  \n  \n The primary steps to properly design custom attribute classes are as follows:  \n  \n- [Applying the AttributeUsageAttribute](#applying-the-attributeusageattribute)  \n  \n- [Declaring the attribute class](#declaring-the-attribute-class)  \n  \n- [Declaring constructors](#declaring-constructors)  \n  \n- [Declaring properties](#declaring-properties)  \n  \n This section describes each of these steps and concludes with a [custom attribute example](#custom-attribute-example).  \n  \n## Applying the AttributeUsageAttribute  \n A custom attribute declaration begins with the <xref:System.AttributeUsageAttribute?displayProperty=nameWithType>, which defines some of the key characteristics of your attribute class. For example, you can specify whether your attribute can be inherited by other classes or specify which elements the attribute can be applied to. The following code fragment demonstrates how to use the <xref:System.AttributeUsageAttribute>.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#5](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#5)]\n [!code-csharp[Conceptual.Attributes.Usage#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#5)]\n [!code-vb[Conceptual.Attributes.Usage#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#5)]  \n  \n The <xref:System.AttributeUsageAttribute> has three members that are important for the creation of custom attributes: [AttributeTargets](#attributetargets-member), [Inherited](#inherited-property), and [AllowMultiple](#allowmultiple-property).  \n  \n### AttributeTargets Member  \n In the previous example, <xref:System.AttributeTargets.All?displayProperty=nameWithType> is specified, indicating that this attribute can be applied to all program elements. Alternatively, you can specify <xref:System.AttributeTargets.Class?displayProperty=nameWithType>, indicating that your attribute can be applied only to a class, or <xref:System.AttributeTargets.Method?displayProperty=nameWithType>, indicating that your attribute can be applied only to a method. All program elements can be marked for description by a custom attribute in this manner.  \n  \n You can also pass multiple <xref:System.AttributeTargets> values. The following code fragment specifies that a custom attribute can be applied to any class or method.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#6](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#6)]\n [!code-csharp[Conceptual.Attributes.Usage#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#6)]\n [!code-vb[Conceptual.Attributes.Usage#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#6)]  \n  \n### Inherited Property  \n The <xref:System.AttributeUsageAttribute.Inherited%2A?displayProperty=nameWithType> property indicates whether your attribute can be inherited by classes that are derived from the classes to which your attribute is applied. This property takes either a `true` (the default) or `false` flag. In the following example, `MyAttribute` has a default <xref:System.AttributeUsageAttribute.Inherited%2A> value of `true`, while `YourAttribute` has an <xref:System.AttributeUsageAttribute.Inherited%2A> value of `false`.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#7](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#7)]\n [!code-csharp[Conceptual.Attributes.Usage#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#7)]\n [!code-vb[Conceptual.Attributes.Usage#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#7)]  \n  \n The two attributes are then applied to a method in the base class `MyClass`.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#9](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#9)]\n [!code-csharp[Conceptual.Attributes.Usage#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#9)]\n [!code-vb[Conceptual.Attributes.Usage#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#9)]  \n  \n Finally, the class `YourClass` is inherited from the base class `MyClass`. The method `MyMethod` shows `MyAttribute`, but not `YourAttribute`.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#10](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#10)]\n [!code-csharp[Conceptual.Attributes.Usage#10](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#10)]\n [!code-vb[Conceptual.Attributes.Usage#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#10)]  \n  \n### AllowMultiple Property  \n The <xref:System.AttributeUsageAttribute.AllowMultiple%2A?displayProperty=nameWithType> property indicates whether multiple instances of your attribute can exist on an element. If set to `true`, multiple instances are allowed; if set to `false` (the default), only one instance is allowed.  \n  \n In the following example, `MyAttribute` has a default <xref:System.AttributeUsageAttribute.AllowMultiple%2A> value of `false`, while `YourAttribute` has a value of `true`.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#11](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#11)]\n [!code-csharp[Conceptual.Attributes.Usage#11](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#11)]\n [!code-vb[Conceptual.Attributes.Usage#11](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#11)]  \n  \n When multiple instances of these attributes are applied, `MyAttribute` produces a compiler error. The following code example shows the valid use of `YourAttribute` and the invalid use of `MyAttribute`.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#13](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#13)]\n [!code-csharp[Conceptual.Attributes.Usage#13](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#13)]\n [!code-vb[Conceptual.Attributes.Usage#13](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#13)]  \n  \n If both the <xref:System.AttributeUsageAttribute.AllowMultiple%2A> property and the <xref:System.AttributeUsageAttribute.Inherited%2A> property are set to `true`, a class that is inherited from another class can inherit an attribute and have another instance of the same attribute applied in the same child class. If <xref:System.AttributeUsageAttribute.AllowMultiple%2A> is set to `false`, the values of any attributes in the parent class will be overwritten by new instances of the same attribute in the child class.  \n  \n## Declaring the Attribute Class  \n After you apply the <xref:System.AttributeUsageAttribute>, you can begin to define the specifics of your attribute. The declaration of an attribute class looks similar to the declaration of a traditional class, as demonstrated by the following code.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#14](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#14)]\n [!code-csharp[Conceptual.Attributes.Usage#14](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#14)]\n [!code-vb[Conceptual.Attributes.Usage#14](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#14)]  \n  \n This attribute definition demonstrates the following points:  \n  \n- Attribute classes must be declared as public classes.  \n  \n- By convention, the name of the attribute class ends with the word **Attribute**. While not required, this convention is recommended for readability. When the attribute is applied, the inclusion of the word Attribute is optional.  \n  \n- All attribute classes must inherit directly or indirectly from <xref:System.Attribute?displayProperty=nameWithType>.  \n  \n- In Microsoft Visual Basic, all custom attribute classes must have the <xref:System.AttributeUsageAttribute?displayProperty=nameWithType> attribute.  \n  \n## Declaring Constructors  \n Attributes are initialized with constructors in the same way as traditional classes. The following code fragment illustrates a typical attribute constructor. This public constructor takes a parameter and sets a member variable equal to its value.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#15](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#15)]\n [!code-csharp[Conceptual.Attributes.Usage#15](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#15)]\n [!code-vb[Conceptual.Attributes.Usage#15](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#15)]  \n  \n You can overload the constructor to accommodate different combinations of values. If you also define a [property](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/65zdfbdt(v=vs.120)) for your custom attribute class, you can use a combination of named and positional parameters when initializing the attribute. Typically, you define all required parameters as positional and all optional parameters as named. In this case, the attribute cannot be initialized without the required parameter. All other parameters are optional. Note that in Visual Basic, constructors for an attribute class should not use a ParamArray argument.  \n  \n The following code example shows how an attribute that uses the previous constructor can be applied using optional and required parameters. It assumes that the attribute has one required Boolean value and one optional string property.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#17](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#17)]\n [!code-csharp[Conceptual.Attributes.Usage#17](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#17)]\n [!code-vb[Conceptual.Attributes.Usage#17](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#17)]  \n  \n## Declaring Properties  \n If you want to define a named parameter or provide an easy way to return the values stored by your attribute, declare a [property](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/65zdfbdt(v=vs.120)). Attribute properties should be declared as public entities with a description of the data type that will be returned. Define the variable that will hold the value of your property and associate it with the **get** and **set** methods. The following code example demonstrates how to implement a simple property in your attribute.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#16](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#16)]\n [!code-csharp[Conceptual.Attributes.Usage#16](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#16)]\n [!code-vb[Conceptual.Attributes.Usage#16](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#16)]  \n  \n## Custom Attribute Example  \n This section incorporates the previous information and shows how to design a simple attribute that documents information about the author of a section of code. The attribute in this example stores the name and level of the programmer, and whether the code has been reviewed. It uses three private variables to store the actual values to save. Each variable is represented by a public property that gets and sets the values. Finally, the constructor is defined with two required parameters.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#4](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#4)]\n [!code-csharp[Conceptual.Attributes.Usage#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#4)]\n [!code-vb[Conceptual.Attributes.Usage#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#4)]  \n  \n You can apply this attribute using the full name, `DeveloperAttribute`, or using the abbreviated name, `Developer`, in one of the following ways.  \n  \n [!code-cpp[Conceptual.Attributes.Usage#12](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#12)]\n [!code-csharp[Conceptual.Attributes.Usage#12](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#12)]\n [!code-vb[Conceptual.Attributes.Usage#12](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#12)]  \n  \n The first example shows the attribute applied with only the required named parameters, while the second example shows the attribute applied with both the required and optional parameters.  \n  \n## See also\n\n- <xref:System.Attribute?displayProperty=nameWithType>\n- <xref:System.AttributeUsageAttribute?displayProperty=nameWithType>\n- [Attributes](../../../docs/standard/attributes/index.md)\n","nodes":[{"pos":[4,526],"embed":true,"restype":"x-metadata","content":"title: \"Writing Custom Attributes\"\nms.date: \"07/17/2018\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"multiple attribute instances\"\n  - \"AttributeTargets enumeration\"\n  - \"attributes [.NET Framework], custom\"\n  - \"AllowMultiple property\"\n  - \"custom attributes\"\n  - \"AttributeUsageAttribute class, custom attributes\"\n  - \"Inherited property\"\n  - \"attribute classes, declaring\"\nms.assetid: 97216f69-bde8-49fd-ac40-f18c500ef5dc\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"Writing Custom Attributes","nodes":[{"pos":[0,25],"content":"Writing Custom Attributes","nodes":[{"content":"Writing Custom Attributes","pos":[0,25]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[533,558],"content":"Writing Custom Attributes","linkify":"Writing Custom Attributes","nodes":[{"content":"Writing Custom Attributes","pos":[0,25]}]},{"content":"To design your own custom attributes, you do not need to master many new concepts.","pos":[559,641]},{"content":"If you are familiar with object-oriented programming and know how to design classes, you already have most of the knowledge needed.","pos":[642,773]},{"content":"Custom attributes are essentially traditional classes that derive directly or indirectly from <ph id=\"ph1\">&lt;xref:System.Attribute?displayProperty=nameWithType&gt;</ph>.","pos":[774,921],"source":" Custom attributes are essentially traditional classes that derive directly or indirectly from <xref:System.Attribute?displayProperty=nameWithType>."},{"content":"Just like traditional classes, custom attributes contain methods that store and retrieve data.","pos":[922,1016]},{"content":"The primary steps to properly design custom attribute classes are as follows:","pos":[1023,1100]},{"pos":[1108,1185],"content":"<bpt id=\"p1\">[</bpt>Applying the AttributeUsageAttribute<ept id=\"p1\">](#applying-the-attributeusageattribute)</ept>","source":"[Applying the AttributeUsageAttribute](#applying-the-attributeusageattribute)"},{"pos":[1193,1256],"content":"<bpt id=\"p1\">[</bpt>Declaring the attribute class<ept id=\"p1\">](#declaring-the-attribute-class)</ept>","source":"[Declaring the attribute class](#declaring-the-attribute-class)"},{"pos":[1264,1313],"content":"<bpt id=\"p1\">[</bpt>Declaring constructors<ept id=\"p1\">](#declaring-constructors)</ept>","source":"[Declaring constructors](#declaring-constructors)"},{"pos":[1321,1366],"content":"<bpt id=\"p1\">[</bpt>Declaring properties<ept id=\"p1\">](#declaring-properties)</ept>","source":"[Declaring properties](#declaring-properties)"},{"pos":[1373,1491],"content":"This section describes each of these steps and concludes with a <bpt id=\"p1\">[</bpt>custom attribute example<ept id=\"p1\">](#custom-attribute-example)</ept>.","source":"This section describes each of these steps and concludes with a [custom attribute example](#custom-attribute-example)."},{"pos":[1500,1536],"content":"Applying the AttributeUsageAttribute","linkify":"Applying the AttributeUsageAttribute","nodes":[{"content":"Applying the AttributeUsageAttribute","pos":[0,36]}]},{"content":"A custom attribute declaration begins with the <ph id=\"ph1\">&lt;xref:System.AttributeUsageAttribute?displayProperty=nameWithType&gt;</ph>, which defines some of the key characteristics of your attribute class.","pos":[1540,1725],"source":"A custom attribute declaration begins with the <xref:System.AttributeUsageAttribute?displayProperty=nameWithType>, which defines some of the key characteristics of your attribute class."},{"content":"For example, you can specify whether your attribute can be inherited by other classes or specify which elements the attribute can be applied to.","pos":[1726,1870]},{"content":"The following code fragment demonstrates how to use the <ph id=\"ph1\">&lt;xref:System.AttributeUsageAttribute&gt;</ph>.","pos":[1871,1965],"source":" The following code fragment demonstrates how to use the <xref:System.AttributeUsageAttribute>."},{"pos":[2397,2640],"content":"The <ph id=\"ph1\">&lt;xref:System.AttributeUsageAttribute&gt;</ph> has three members that are important for the creation of custom attributes: <bpt id=\"p1\">[</bpt>AttributeTargets<ept id=\"p1\">](#attributetargets-member)</ept>, <bpt id=\"p2\">[</bpt>Inherited<ept id=\"p2\">](#inherited-property)</ept>, and <bpt id=\"p3\">[</bpt>AllowMultiple<ept id=\"p3\">](#allowmultiple-property)</ept>.","source":"The <xref:System.AttributeUsageAttribute> has three members that are important for the creation of custom attributes: [AttributeTargets](#attributetargets-member), [Inherited](#inherited-property), and [AllowMultiple](#allowmultiple-property)."},{"pos":[2650,2673],"content":"AttributeTargets Member","linkify":"AttributeTargets Member","nodes":[{"content":"AttributeTargets Member","pos":[0,23]}]},{"content":"In the previous example, <ph id=\"ph1\">&lt;xref:System.AttributeTargets.All?displayProperty=nameWithType&gt;</ph> is specified, indicating that this attribute can be applied to all program elements.","pos":[2677,2850],"source":"In the previous example, <xref:System.AttributeTargets.All?displayProperty=nameWithType> is specified, indicating that this attribute can be applied to all program elements."},{"content":"Alternatively, you can specify <ph id=\"ph1\">&lt;xref:System.AttributeTargets.Class?displayProperty=nameWithType&gt;</ph>, indicating that your attribute can be applied only to a class, or <ph id=\"ph2\">&lt;xref:System.AttributeTargets.Method?displayProperty=nameWithType&gt;</ph>, indicating that your attribute can be applied only to a method.","pos":[2851,3146],"source":" Alternatively, you can specify <xref:System.AttributeTargets.Class?displayProperty=nameWithType>, indicating that your attribute can be applied only to a class, or <xref:System.AttributeTargets.Method?displayProperty=nameWithType>, indicating that your attribute can be applied only to a method."},{"content":"All program elements can be marked for description by a custom attribute in this manner.","pos":[3147,3235]},{"content":"You can also pass multiple <ph id=\"ph1\">&lt;xref:System.AttributeTargets&gt;</ph> values.","pos":[3242,3307],"source":"You can also pass multiple <xref:System.AttributeTargets> values."},{"content":"The following code fragment specifies that a custom attribute can be applied to any class or method.","pos":[3308,3408]},{"pos":[3843,3861],"content":"Inherited Property","linkify":"Inherited Property","nodes":[{"content":"Inherited Property","pos":[0,18]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.AttributeUsageAttribute.Inherited%2A?displayProperty=nameWithType&gt;</ph> property indicates whether your attribute can be inherited by classes that are derived from the classes to which your attribute is applied.","pos":[3865,4088],"source":"The <xref:System.AttributeUsageAttribute.Inherited%2A?displayProperty=nameWithType> property indicates whether your attribute can be inherited by classes that are derived from the classes to which your attribute is applied."},{"content":"This property takes either a <ph id=\"ph1\">`true`</ph> (the default) or <ph id=\"ph2\">`false`</ph> flag.","pos":[4089,4155],"source":" This property takes either a `true` (the default) or `false` flag."},{"content":"In the following example, <ph id=\"ph1\">`MyAttribute`</ph> has a default <ph id=\"ph2\">&lt;xref:System.AttributeUsageAttribute.Inherited%2A&gt;</ph> value of <ph id=\"ph3\">`true`</ph>, while <ph id=\"ph4\">`YourAttribute`</ph> has an <ph id=\"ph5\">&lt;xref:System.AttributeUsageAttribute.Inherited%2A&gt;</ph> value of <ph id=\"ph6\">`false`</ph>.","pos":[4156,4375],"source":" In the following example, `MyAttribute` has a default <xref:System.AttributeUsageAttribute.Inherited%2A> value of `true`, while `YourAttribute` has an <xref:System.AttributeUsageAttribute.Inherited%2A> value of `false`."},{"pos":[4807,4883],"content":"The two attributes are then applied to a method in the base class <ph id=\"ph1\">`MyClass`</ph>.","source":"The two attributes are then applied to a method in the base class `MyClass`."},{"content":"Finally, the class <ph id=\"ph1\">`YourClass`</ph> is inherited from the base class <ph id=\"ph2\">`MyClass`</ph>.","pos":[5315,5389],"source":"Finally, the class `YourClass` is inherited from the base class `MyClass`."},{"content":"The method <ph id=\"ph1\">`MyMethod`</ph> shows <ph id=\"ph2\">`MyAttribute`</ph>, but not <ph id=\"ph3\">`YourAttribute`</ph>.","pos":[5390,5457],"source":" The method `MyMethod` shows `MyAttribute`, but not `YourAttribute`."},{"pos":[5898,5920],"content":"AllowMultiple Property","linkify":"AllowMultiple Property","nodes":[{"content":"AllowMultiple Property","pos":[0,22]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.AttributeUsageAttribute.AllowMultiple%2A?displayProperty=nameWithType&gt;</ph> property indicates whether multiple instances of your attribute can exist on an element.","pos":[5924,6100],"source":"The <xref:System.AttributeUsageAttribute.AllowMultiple%2A?displayProperty=nameWithType> property indicates whether multiple instances of your attribute can exist on an element."},{"content":"If set to <ph id=\"ph1\">`true`</ph>, multiple instances are allowed; if set to <ph id=\"ph2\">`false`</ph> (the default), only one instance is allowed.","pos":[6101,6213],"source":" If set to `true`, multiple instances are allowed; if set to `false` (the default), only one instance is allowed."},{"pos":[6220,6391],"content":"In the following example, <ph id=\"ph1\">`MyAttribute`</ph> has a default <ph id=\"ph2\">&lt;xref:System.AttributeUsageAttribute.AllowMultiple%2A&gt;</ph> value of <ph id=\"ph3\">`false`</ph>, while <ph id=\"ph4\">`YourAttribute`</ph> has a value of <ph id=\"ph5\">`true`</ph>.","source":"In the following example, `MyAttribute` has a default <xref:System.AttributeUsageAttribute.AllowMultiple%2A> value of `false`, while `YourAttribute` has a value of `true`."},{"content":"When multiple instances of these attributes are applied, <ph id=\"ph1\">`MyAttribute`</ph> produces a compiler error.","pos":[6829,6926],"source":"When multiple instances of these attributes are applied, `MyAttribute` produces a compiler error."},{"content":"The following code example shows the valid use of <ph id=\"ph1\">`YourAttribute`</ph> and the invalid use of <ph id=\"ph2\">`MyAttribute`</ph>.","pos":[6927,7030],"source":" The following code example shows the valid use of `YourAttribute` and the invalid use of `MyAttribute`."},{"content":"If both the <ph id=\"ph1\">&lt;xref:System.AttributeUsageAttribute.AllowMultiple%2A&gt;</ph> property and the <ph id=\"ph2\">&lt;xref:System.AttributeUsageAttribute.Inherited%2A&gt;</ph> property are set to <ph id=\"ph3\">`true`</ph>, a class that is inherited from another class can inherit an attribute and have another instance of the same attribute applied in the same child class.","pos":[7468,7781],"source":"If both the <xref:System.AttributeUsageAttribute.AllowMultiple%2A> property and the <xref:System.AttributeUsageAttribute.Inherited%2A> property are set to `true`, a class that is inherited from another class can inherit an attribute and have another instance of the same attribute applied in the same child class."},{"content":"If <ph id=\"ph1\">&lt;xref:System.AttributeUsageAttribute.AllowMultiple%2A&gt;</ph> is set to <ph id=\"ph2\">`false`</ph>, the values of any attributes in the parent class will be overwritten by new instances of the same attribute in the child class.","pos":[7782,7986],"source":" If <xref:System.AttributeUsageAttribute.AllowMultiple%2A> is set to `false`, the values of any attributes in the parent class will be overwritten by new instances of the same attribute in the child class."},{"pos":[7995,8024],"content":"Declaring the Attribute Class","linkify":"Declaring the Attribute Class","nodes":[{"content":"Declaring the Attribute Class","pos":[0,29]}]},{"content":"After you apply the <ph id=\"ph1\">&lt;xref:System.AttributeUsageAttribute&gt;</ph>, you can begin to define the specifics of your attribute.","pos":[8028,8143],"source":"After you apply the <xref:System.AttributeUsageAttribute>, you can begin to define the specifics of your attribute."},{"content":"The declaration of an attribute class looks similar to the declaration of a traditional class, as demonstrated by the following code.","pos":[8144,8277]},{"content":"This attribute definition demonstrates the following points:","pos":[8715,8775]},{"content":"Attribute classes must be declared as public classes.","pos":[8783,8836]},{"content":"By convention, the name of the attribute class ends with the word <bpt id=\"p1\">**</bpt>Attribute<ept id=\"p1\">**</ept>.","pos":[8844,8924],"source":"By convention, the name of the attribute class ends with the word **Attribute**."},{"content":"While not required, this convention is recommended for readability.","pos":[8925,8992]},{"content":"When the attribute is applied, the inclusion of the word Attribute is optional.","pos":[8993,9072]},{"pos":[9080,9196],"content":"All attribute classes must inherit directly or indirectly from <ph id=\"ph1\">&lt;xref:System.Attribute?displayProperty=nameWithType&gt;</ph>.","source":"All attribute classes must inherit directly or indirectly from <xref:System.Attribute?displayProperty=nameWithType>."},{"pos":[9204,9351],"content":"In Microsoft Visual Basic, all custom attribute classes must have the <ph id=\"ph1\">&lt;xref:System.AttributeUsageAttribute?displayProperty=nameWithType&gt;</ph> attribute.","source":"In Microsoft Visual Basic, all custom attribute classes must have the <xref:System.AttributeUsageAttribute?displayProperty=nameWithType> attribute."},{"pos":[9360,9382],"content":"Declaring Constructors","linkify":"Declaring Constructors","nodes":[{"content":"Declaring Constructors","pos":[0,22]}]},{"content":"Attributes are initialized with constructors in the same way as traditional classes.","pos":[9386,9470]},{"content":"The following code fragment illustrates a typical attribute constructor.","pos":[9471,9543]},{"content":"This public constructor takes a parameter and sets a member variable equal to its value.","pos":[9544,9632]},{"content":"You can overload the constructor to accommodate different combinations of values.","pos":[10070,10151]},{"content":"If you also define a <bpt id=\"p1\">[</bpt>property<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/65zdfbdt(v=vs.120))</ept> for your custom attribute class, you can use a combination of named and positional parameters when initializing the attribute.","pos":[10152,10407],"source":" If you also define a [property](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/65zdfbdt(v=vs.120)) for your custom attribute class, you can use a combination of named and positional parameters when initializing the attribute."},{"content":"Typically, you define all required parameters as positional and all optional parameters as named.","pos":[10408,10505]},{"content":"In this case, the attribute cannot be initialized without the required parameter.","pos":[10506,10587]},{"content":"All other parameters are optional.","pos":[10588,10622]},{"content":"Note that in Visual Basic, constructors for an attribute class should not use a ParamArray argument.","pos":[10623,10723]},{"content":"The following code example shows how an attribute that uses the previous constructor can be applied using optional and required parameters.","pos":[10730,10869]},{"content":"It assumes that the attribute has one required Boolean value and one optional string property.","pos":[10870,10964]},{"pos":[11404,11424],"content":"Declaring Properties","linkify":"Declaring Properties","nodes":[{"content":"Declaring Properties","pos":[0,20]}]},{"content":"If you want to define a named parameter or provide an easy way to return the values stored by your attribute, declare a <bpt id=\"p1\">[</bpt>property<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/65zdfbdt(v=vs.120))</ept>.","pos":[11428,11656],"source":"If you want to define a named parameter or provide an easy way to return the values stored by your attribute, declare a [property](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/65zdfbdt(v=vs.120))."},{"content":"Attribute properties should be declared as public entities with a description of the data type that will be returned.","pos":[11657,11774]},{"content":"Define the variable that will hold the value of your property and associate it with the <bpt id=\"p1\">**</bpt>get<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>set<ept id=\"p2\">**</ept> methods.","pos":[11775,11891],"source":" Define the variable that will hold the value of your property and associate it with the **get** and **set** methods."},{"content":"The following code example demonstrates how to implement a simple property in your attribute.","pos":[11892,11985]},{"pos":[12425,12449],"content":"Custom Attribute Example","linkify":"Custom Attribute Example","nodes":[{"content":"Custom Attribute Example","pos":[0,24]}]},{"content":"This section incorporates the previous information and shows how to design a simple attribute that documents information about the author of a section of code.","pos":[12453,12612]},{"content":"The attribute in this example stores the name and level of the programmer, and whether the code has been reviewed.","pos":[12613,12727]},{"content":"It uses three private variables to store the actual values to save.","pos":[12728,12795]},{"content":"Each variable is represented by a public property that gets and sets the values.","pos":[12796,12876]},{"content":"Finally, the constructor is defined with two required parameters.","pos":[12877,12942]},{"pos":[13374,13519],"content":"You can apply this attribute using the full name, <ph id=\"ph1\">`DeveloperAttribute`</ph>, or using the abbreviated name, <ph id=\"ph2\">`Developer`</ph>, in one of the following ways.","source":"You can apply this attribute using the full name, `DeveloperAttribute`, or using the abbreviated name, `Developer`, in one of the following ways."},{"content":"The first example shows the attribute applied with only the required named parameters, while the second example shows the attribute applied with both the required and optional parameters.","pos":[13957,14144]},{"pos":[14153,14161],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[14289,14345],"content":"<bpt id=\"p1\">[</bpt>Attributes<ept id=\"p1\">](../../../docs/standard/attributes/index.md)</ept>","source":"[Attributes](../../../docs/standard/attributes/index.md)"}]}