{"content":"---\ntitle: \"Known Issues and Considerations in LINQ to Entities\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: acd71129-5ff0-4b4e-b266-c72cc0c53601\n---\n# Known Issues and Considerations in LINQ to Entities\nThis section provides information about known issues with [!INCLUDE[linq_entities](../../../../../../includes/linq-entities-md.md)] queries.  \n  \n-   [LINQ Queries That cannot be Cached](#LINQQueriesThatAreNotCached)  \n  \n-   [Ordering Information Lost](#OrderingInfoLost)  \n  \n-   [Unsigned Integers Not Supported](#UnsignedIntsUnsupported)  \n  \n-   [Type Conversion Errors](#TypeConversionErrors)  \n  \n-   [Referencing Non-Scalar Variables Not Supported](#RefNonScalarClosures)  \n  \n-   [Nested Queries May Fail with SQL Server 2000](#NestedQueriesSQL2000)  \n  \n-   [Projecting to an Anonymous Type](#ProjectToAnonymousType)  \n  \n<a name=\"LINQQueriesThatAreNotCached\"></a>   \n## LINQ Queries That cannot be Cached  \n Starting with .NET Framework 4.5, LINQ to Entities queries are automatically cached. However, LINQ to Entities queries that apply the `Enumerable.Contains` operator to in-memory collections are not automatically cached. Also parameterizing in-memory collections in compiled LINQ queries is not allowed.  \n  \n<a name=\"OrderingInfoLost\"></a>   \n## Ordering Information Lost  \n Projecting columns into an anonymous type will cause ordering information to be lost in some queries that are executed against a [!INCLUDE[ssVersion2005](../../../../../../includes/ssversion2005-md.md)] database set to a compatibility level of \"80\".  This occurs when a column name in the order-by list matches a column name in the selector, as shown in the following example:  \n  \n [!code-csharp[DP L2E Conceptual Examples#SBUDT543840](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#sbudt543840)]\n [!code-vb[DP L2E Conceptual Examples#SBUDT543840](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#sbudt543840)]  \n  \n<a name=\"UnsignedIntsUnsupported\"></a>   \n## Unsigned Integers Not Supported  \n Specifying an unsigned integer type in a [!INCLUDE[linq_entities](../../../../../../includes/linq-entities-md.md)] query is not supported because the [!INCLUDE[adonet_ef](../../../../../../includes/adonet-ef-md.md)] does not support unsigned integers. If you specify an unsigned integer, an <xref:System.ArgumentException> exception will be thrown during the query expression translation, as shown in the following example. This example queries for an order with ID 48000.  \n  \n [!code-csharp[DP L2E Conceptual Examples#UIntAsQueryParam](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#uintasqueryparam)]\n [!code-vb[DP L2E Conceptual Examples#UIntAsQueryParam](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#uintasqueryparam)]  \n  \n<a name=\"TypeConversionErrors\"></a>   \n## Type Conversion Errors  \n In Visual Basic, when a property is mapped to a column of SQL Server bit type with a value of 1 using the `CByte` function, a <xref:System.Data.SqlClient.SqlException> is thrown with an \"Arithmetic overflow error\" message. The following example queries the `Product.MakeFlag` column in the AdventureWorks sample database and an exception is thrown when the query results are iterated over.  \n  \n [!code-vb[DP L2E Conceptual Examples#SBUDT544355](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#sbudt544355)]  \n  \n<a name=\"RefNonScalarClosures\"></a>   \n## Referencing Non-Scalar Variables Not Supported  \n Referencing a non-scalar variables, such as an entity, in a query is not supported. When such a query executes, a <xref:System.NotSupportedException> exception is thrown with a message that states \"Unable to create a constant value of type `EntityType`. Only primitive types ('such as Int32, String, and Guid') are supported in this context.\"  \n  \n> [!NOTE]\n>  Referencing a collection of scalar variables is supported.  \n  \n [!code-csharp[DP L2E Conceptual Examples#SBUDT555877](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#sbudt555877)]\n [!code-vb[DP L2E Conceptual Examples#SBUDT555877](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#sbudt555877)]  \n  \n<a name=\"NestedQueriesSQL2000\"></a>   \n## Nested Queries May Fail with SQL Server 2000  \n With SQL Server 2000, LINQ to Entities queries may fail if they produce nested Transact-SQL queries that are three or more levels deep.  \n  \n<a name=\"ProjectToAnonymousType\"></a>   \n## Projecting to an Anonymous Type  \n If you define your initial query path to include related objects by using the <xref:System.Data.Objects.ObjectQuery%601.Include%2A> method on the <xref:System.Data.Objects.ObjectQuery%601> and then use LINQ to project the returned objects to an anonymous type, the objects specified in the include method are not included in the query results.  \n  \n [!code-csharp[DP L2E Conceptual Examples#ProjToAnonType1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#projtoanontype1)]\n [!code-vb[DP L2E Conceptual Examples#ProjToAnonType1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#projtoanontype1)]  \n  \n To get related objects, do not project returned types to an anonymous type.  \n  \n [!code-csharp[DP L2E Conceptual Examples#ProjToAnonType2](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#projtoanontype2)]\n [!code-vb[DP L2E Conceptual Examples#ProjToAnonType2](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#projtoanontype2)]  \n  \n## See also\n\n- [LINQ to Entities](../../../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)\n","nodes":[{"pos":[4,169],"embed":true,"restype":"x-metadata","content":"title: \"Known Issues and Considerations in LINQ to Entities\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: acd71129-5ff0-4b4e-b266-c72cc0c53601","nodes":[{"content":"Known Issues and Considerations in LINQ to Entities","nodes":[{"pos":[0,51],"content":"Known Issues and Considerations in LINQ to Entities","nodes":[{"content":"Known Issues and Considerations in LINQ to Entities","pos":[0,51]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[176,227],"content":"Known Issues and Considerations in LINQ to Entities","linkify":"Known Issues and Considerations in LINQ to Entities","nodes":[{"content":"Known Issues and Considerations in LINQ to Entities","pos":[0,51]}]},{"pos":[228,368],"content":"This section provides information about known issues with <ph id=\"ph1\">[!INCLUDE[linq_entities](../../../../../../includes/linq-entities-md.md)]</ph> queries.","source":"This section provides information about known issues with [!INCLUDE[linq_entities](../../../../../../includes/linq-entities-md.md)] queries."},{"pos":[378,444],"content":"<bpt id=\"p1\">[</bpt>LINQ Queries That cannot be Cached<ept id=\"p1\">](#LINQQueriesThatAreNotCached)</ept>","source":"[LINQ Queries That cannot be Cached](#LINQQueriesThatAreNotCached)"},{"pos":[454,500],"content":"<bpt id=\"p1\">[</bpt>Ordering Information Lost<ept id=\"p1\">](#OrderingInfoLost)</ept>","source":"[Ordering Information Lost](#OrderingInfoLost)"},{"pos":[510,569],"content":"<bpt id=\"p1\">[</bpt>Unsigned Integers Not Supported<ept id=\"p1\">](#UnsignedIntsUnsupported)</ept>","source":"[Unsigned Integers Not Supported](#UnsignedIntsUnsupported)"},{"pos":[579,626],"content":"<bpt id=\"p1\">[</bpt>Type Conversion Errors<ept id=\"p1\">](#TypeConversionErrors)</ept>","source":"[Type Conversion Errors](#TypeConversionErrors)"},{"pos":[636,707],"content":"<bpt id=\"p1\">[</bpt>Referencing Non-Scalar Variables Not Supported<ept id=\"p1\">](#RefNonScalarClosures)</ept>","source":"[Referencing Non-Scalar Variables Not Supported](#RefNonScalarClosures)"},{"pos":[717,786],"content":"<bpt id=\"p1\">[</bpt>Nested Queries May Fail with SQL Server 2000<ept id=\"p1\">](#NestedQueriesSQL2000)</ept>","source":"[Nested Queries May Fail with SQL Server 2000](#NestedQueriesSQL2000)"},{"pos":[796,854],"content":"<bpt id=\"p1\">[</bpt>Projecting to an Anonymous Type<ept id=\"p1\">](#ProjectToAnonymousType)</ept>","source":"[Projecting to an Anonymous Type](#ProjectToAnonymousType)"},{"pos":[909,943],"content":"LINQ Queries That cannot be Cached","linkify":"LINQ Queries That cannot be Cached","nodes":[{"content":"LINQ Queries That cannot be Cached","pos":[0,34]}]},{"content":"Starting with .NET Framework 4.5, LINQ to Entities queries are automatically cached.","pos":[947,1031]},{"content":"However, LINQ to Entities queries that apply the <ph id=\"ph1\">`Enumerable.Contains`</ph> operator to in-memory collections are not automatically cached.","pos":[1032,1166],"source":" However, LINQ to Entities queries that apply the `Enumerable.Contains` operator to in-memory collections are not automatically cached."},{"content":"Also parameterizing in-memory collections in compiled LINQ queries is not allowed.","pos":[1167,1249]},{"pos":[1293,1318],"content":"Ordering Information Lost","linkify":"Ordering Information Lost","nodes":[{"content":"Ordering Information Lost","pos":[0,25]}]},{"content":"Projecting columns into an anonymous type will cause ordering information to be lost in some queries that are executed against a <ph id=\"ph1\">[!INCLUDE[ssVersion2005](../../../../../../includes/ssversion2005-md.md)]</ph> database set to a compatibility level of \"80\".","pos":[1322,1571],"source":"Projecting columns into an anonymous type will cause ordering information to be lost in some queries that are executed against a [!INCLUDE[ssVersion2005](../../../../../../includes/ssversion2005-md.md)] database set to a compatibility level of \"80\"."},{"content":"This occurs when a column name in the order-by list matches a column name in the selector, as shown in the following example:","pos":[1573,1698]},{"pos":[2093,2124],"content":"Unsigned Integers Not Supported","linkify":"Unsigned Integers Not Supported","nodes":[{"content":"Unsigned Integers Not Supported","pos":[0,31]}]},{"content":"Specifying an unsigned integer type in a <ph id=\"ph1\">[!INCLUDE[linq_entities](../../../../../../includes/linq-entities-md.md)]</ph> query is not supported because the <ph id=\"ph2\">[!INCLUDE[adonet_ef](../../../../../../includes/adonet-ef-md.md)]</ph> does not support unsigned integers.","pos":[2128,2379],"source":"Specifying an unsigned integer type in a [!INCLUDE[linq_entities](../../../../../../includes/linq-entities-md.md)] query is not supported because the [!INCLUDE[adonet_ef](../../../../../../includes/adonet-ef-md.md)] does not support unsigned integers."},{"content":"If you specify an unsigned integer, an <ph id=\"ph1\">&lt;xref:System.ArgumentException&gt;</ph> exception will be thrown during the query expression translation, as shown in the following example.","pos":[2380,2551],"source":" If you specify an unsigned integer, an <xref:System.ArgumentException> exception will be thrown during the query expression translation, as shown in the following example."},{"content":"This example queries for an order with ID 48000.","pos":[2552,2600]},{"pos":[3012,3034],"content":"Type Conversion Errors","linkify":"Type Conversion Errors","nodes":[{"content":"Type Conversion Errors","pos":[0,22]}]},{"content":"In Visual Basic, when a property is mapped to a column of SQL Server bit type with a value of 1 using the <ph id=\"ph1\">`CByte`</ph> function, a <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlException&gt;</ph> is thrown with an \"Arithmetic overflow error\" message.","pos":[3038,3260],"source":"In Visual Basic, when a property is mapped to a column of SQL Server bit type with a value of 1 using the `CByte` function, a <xref:System.Data.SqlClient.SqlException> is thrown with an \"Arithmetic overflow error\" message."},{"content":"The following example queries the <ph id=\"ph1\">`Product.MakeFlag`</ph> column in the AdventureWorks sample database and an exception is thrown when the query results are iterated over.","pos":[3261,3427],"source":" The following example queries the `Product.MakeFlag` column in the AdventureWorks sample database and an exception is thrown when the query results are iterated over."},{"pos":[3650,3696],"content":"Referencing Non-Scalar Variables Not Supported","linkify":"Referencing Non-Scalar Variables Not Supported","nodes":[{"content":"Referencing Non-Scalar Variables Not Supported","pos":[0,46]}]},{"content":"Referencing a non-scalar variables, such as an entity, in a query is not supported.","pos":[3700,3783]},{"content":"When such a query executes, a <ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph> exception is thrown with a message that states \"Unable to create a constant value of type <ph id=\"ph2\">`EntityType`</ph>.","pos":[3784,3953],"source":" When such a query executes, a <xref:System.NotSupportedException> exception is thrown with a message that states \"Unable to create a constant value of type `EntityType`."},{"content":"Only primitive types ('such as Int32, String, and Guid') are supported in this context.\"","pos":[3954,4042]},{"pos":[4050,4119],"content":"[!NOTE]\n Referencing a collection of scalar variables is supported.","leadings":["","> "],"nodes":[{"content":"Referencing a collection of scalar variables is supported.","pos":[9,67]}]},{"pos":[4511,4555],"content":"Nested Queries May Fail with SQL Server 2000","linkify":"Nested Queries May Fail with SQL Server 2000","nodes":[{"content":"Nested Queries May Fail with SQL Server 2000","pos":[0,44]}]},{"content":"With SQL Server 2000, LINQ to Entities queries may fail if they produce nested Transact-SQL queries that are three or more levels deep.","pos":[4559,4694]},{"pos":[4744,4775],"content":"Projecting to an Anonymous Type","linkify":"Projecting to an Anonymous Type","nodes":[{"content":"Projecting to an Anonymous Type","pos":[0,31]}]},{"pos":[4779,5122],"content":"If you define your initial query path to include related objects by using the <ph id=\"ph1\">&lt;xref:System.Data.Objects.ObjectQuery%601.Include%2A&gt;</ph> method on the <ph id=\"ph2\">&lt;xref:System.Data.Objects.ObjectQuery%601&gt;</ph> and then use LINQ to project the returned objects to an anonymous type, the objects specified in the include method are not included in the query results.","source":"If you define your initial query path to include related objects by using the <xref:System.Data.Objects.ObjectQuery%601.Include%2A> method on the <xref:System.Data.Objects.ObjectQuery%601> and then use LINQ to project the returned objects to an anonymous type, the objects specified in the include method are not included in the query results."},{"content":"To get related objects, do not project returned types to an anonymous type.","pos":[5489,5564]},{"pos":[5933,5941],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5945,6051],"content":"<bpt id=\"p1\">[</bpt>LINQ to Entities<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)</ept>","source":"[LINQ to Entities](../../../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)"}]}