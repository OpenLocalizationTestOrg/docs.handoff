{"content":"---\ntitle: \"Creating Expression Columns\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 0af3bd64-92a2-4b47-ae62-f5df35f131a6\n---\n# Creating Expression Columns\nYou can define an expression for a column, enabling it to contain a value calculated from other column values in the same row or from the column values of multiple rows in the table. To define the expression to be evaluated, use the <xref:System.Data.DataColumn.Expression%2A> property of the target column, and use the <xref:System.Data.DataColumn.ColumnName%2A> property to refer to other columns in the expression. The <xref:System.Data.DataColumn.DataType%2A> for the expression column must be appropriate for the value that the expression returns.  \n  \n The following table lists several possible uses for expression columns in a table.  \n  \n|Expression type|Example|  \n|---------------------|-------------|  \n|Comparison|\"Total >= 500\"|  \n|Computation|\"UnitPrice * Quantity\"|  \n|Aggregation|Sum(Price)|  \n  \n You can set the **Expression** property on an existing **DataColumn** object, or you can include the property as the third argument passed to the <xref:System.Data.DataColumn> constructor, as shown in the following example.  \n  \n```vb  \nworkTable.Columns.Add(\"Total\",Type.GetType(\"System.Double\"))  \nworkTable.Columns.Add(\"SalesTax\", Type.GetType(\"System.Double\"), _  \n  \"Total * 0.086\")  \n```  \n  \n```csharp  \nworkTable.Columns.Add(\"Total\", typeof(Double));  \nworkTable.Columns.Add(\"SalesTax\", typeof(Double), \"Total * 0.086\");  \n```  \n  \n Expressions can reference other expression columns; however, a circular reference, in which two expressions reference each other, will generate an exception. For rules about writing expressions, see the <xref:System.Data.DataColumn.Expression%2A> property of the **DataColumn** class.  \n  \n## See also\n\n- <xref:System.Data.DataColumn>\n- <xref:System.Data.DataSet>\n- <xref:System.Data.DataTable>\n- [DataTable Schema Definition](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatable-schema-definition.md)\n- [DataTables](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatables.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,145],"embed":true,"restype":"x-metadata","content":"title: \"Creating Expression Columns\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 0af3bd64-92a2-4b47-ae62-f5df35f131a6","nodes":[{"content":"Creating Expression Columns","nodes":[{"pos":[0,27],"content":"Creating Expression Columns","nodes":[{"content":"Creating Expression Columns","pos":[0,27]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[152,179],"content":"Creating Expression Columns","linkify":"Creating Expression Columns","nodes":[{"content":"Creating Expression Columns","pos":[0,27]}]},{"content":"You can define an expression for a column, enabling it to contain a value calculated from other column values in the same row or from the column values of multiple rows in the table.","pos":[180,362]},{"content":"To define the expression to be evaluated, use the <ph id=\"ph1\">&lt;xref:System.Data.DataColumn.Expression%2A&gt;</ph> property of the target column, and use the <ph id=\"ph2\">&lt;xref:System.Data.DataColumn.ColumnName%2A&gt;</ph> property to refer to other columns in the expression.","pos":[363,597],"source":" To define the expression to be evaluated, use the <xref:System.Data.DataColumn.Expression%2A> property of the target column, and use the <xref:System.Data.DataColumn.ColumnName%2A> property to refer to other columns in the expression."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataColumn.DataType%2A&gt;</ph> for the expression column must be appropriate for the value that the expression returns.","pos":[598,732],"source":" The <xref:System.Data.DataColumn.DataType%2A> for the expression column must be appropriate for the value that the expression returns."},{"content":"The following table lists several possible uses for expression columns in a table.","pos":[739,821]},{"content":"Expression type","pos":[828,843]},{"content":"Example","pos":[844,851]},{"content":"Comparison","pos":[896,906]},{"content":"\"Total &gt;= 500\"","pos":[907,921],"source":"\"Total >= 500\""},{"content":"Computation","pos":[926,937]},{"content":"\"UnitPrice * Quantity\"","pos":[938,960]},{"content":"Aggregation","pos":[965,976]},{"content":"Sum(Price)","pos":[977,987]},{"pos":[995,1218],"content":"You can set the <bpt id=\"p1\">**</bpt>Expression<ept id=\"p1\">**</ept> property on an existing <bpt id=\"p2\">**</bpt>DataColumn<ept id=\"p2\">**</ept> object, or you can include the property as the third argument passed to the <ph id=\"ph1\">&lt;xref:System.Data.DataColumn&gt;</ph> constructor, as shown in the following example.","source":"You can set the **Expression** property on an existing **DataColumn** object, or you can include the property as the third argument passed to the <xref:System.Data.DataColumn> constructor, as shown in the following example."},{"content":"Expressions can reference other expression columns; however, a circular reference, in which two expressions reference each other, will generate an exception.","pos":[1536,1693]},{"content":"For rules about writing expressions, see the <ph id=\"ph1\">&lt;xref:System.Data.DataColumn.Expression%2A&gt;</ph> property of the <bpt id=\"p1\">**</bpt>DataColumn<ept id=\"p1\">**</ept> class.","pos":[1694,1820],"source":" For rules about writing expressions, see the <xref:System.Data.DataColumn.Expression%2A> property of the **DataColumn** class."},{"pos":[1829,1837],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1933,2063],"content":"<bpt id=\"p1\">[</bpt>DataTable Schema Definition<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatable-schema-definition.md)</ept>","source":"[DataTable Schema Definition](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatable-schema-definition.md)"},{"pos":[2066,2162],"content":"<bpt id=\"p1\">[</bpt>DataTables<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatables.md)</ept>","source":"[DataTables](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatables.md)"},{"pos":[2165,2269],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}