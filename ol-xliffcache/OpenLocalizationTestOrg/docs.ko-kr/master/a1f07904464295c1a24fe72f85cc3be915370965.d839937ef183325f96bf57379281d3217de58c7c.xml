{"content":"---\ntitle: \"Creating User-Defined Bindings | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"user-defined bindings [WCF]\"\nms.assetid: c4960675-d701-4bc9-b400-36a752fdd08b\ncaps.latest.revision: 19\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Creating User-Defined Bindings\nThere are several ways to create bindings not provided by the system:  \n  \n-   Create a custom binding, based on the <xref:System.ServiceModel.Channels.CustomBinding> class, which is a container that you fill with binding elements. The custom binding is then added to a service endpoint. You can create the custom binding either programmatically or in an application configuration file. To use a binding element from an application configuration file, the binding element must extend <xref:System.ServiceModel.Configuration.BindingElementExtensionElement>. [!INCLUDE[crabout](../../../../includes/crabout-md.md)] custom bindings, see [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md) and <xref:System.ServiceModel.Channels.CustomBinding>.  \n  \n-   You can create a class that derives from a standard binding. For example, you can derive a class from <xref:System.ServiceModel.WSHttpBinding> and override <xref:System.ServiceModel.Channels.CustomBinding.CreateBindingElements%2A> method to obtain the binding elements and insert a custom binding element or establish a particular value for security.  \n  \n-   You can create a new <xref:System.ServiceModel.Channels.Binding> type to completely control the entire binding implementation.  \n  \n## The Order of Binding Elements  \n Each binding element represents a processing step when sending or receiving messages. At runtime, binding elements create the channels and listeners necessary to build outgoing and incoming channel stacks.  \n  \n There are three main types of binding elements: Protocol Binding Elements, Encoding Binding Elements and Transport Binding Elements.  \n  \n Protocol Binding Elements – These elements represent higher-level processing steps that act on messages. Channels and listeners created by these binding elements can add, remove, or modify the message content. A given binding may have an arbitrary number of protocol binding elements, each inheriting from <xref:System.ServiceModel.Channels.BindingElement>. [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] includes several protocol binding elements, including the <xref:System.ServiceModel.Channels.ReliableSessionBindingElement> and the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement>.  \n  \n Encoding Binding Element – These elements represent transformations between a message and an encoding ready for transmission on the wire. Typical [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] bindings include exactly one encoding binding element. Examples of encoding binding elements include the <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>, the <xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>, and the <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>. If an encoding binding element is not specified for a binding, a default encoding is used. The default is text when the transport is HTTP and binary otherwise.  \n  \n Transport Binding Element – These elements represent the transmission of an encoding message on a transport protocol. Typical [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] bindings include exactly one transport binding element, which inherits from <xref:System.ServiceModel.Channels.TransportBindingElement>. Examples of transport binding elements include the <xref:System.ServiceModel.Channels.TcpTransportBindingElement>, the <xref:System.ServiceModel.Channels.HttpTransportBindingElement>, and the <xref:System.ServiceModel.Channels.NamedPipeTransportBindingElement>.  \n  \n When creating new bindings, the order of the added binding elements is important. Always add binding elements in the following order:  \n  \n|Layer|Options|Required|  \n|-----------|-------------|--------------|  \n|Transaction Flow|<xref:System.ServiceModel.Channels.TransactionFlowBindingElement?displayProperty=fullName>|No|  \n|Reliability|<xref:System.ServiceModel.Channels.ReliableSessionBindingElement?displayProperty=fullName>|No|  \n|Security|<xref:System.ServiceModel.Channels.SecurityBindingElement?displayProperty=fullName>|No|  \n|Composite Duplex|<xref:System.ServiceModel.Channels.CompositeDuplexBindingElement?displayProperty=fullName>|No|  \n|Encoding|Text, Binary, MTOM, Custom|Yes*|  \n|Transport|TCP, Named Pipes, HTTP, HTTPS, MSMQ, Custom|Yes|  \n  \n *Because an encoding is required for each binding, if an encoding is not specified, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] adds a default encoding for you. The default is Text/XML for the HTTP and HTTPS transports, and Binary otherwise.  \n  \n## Creating a new Binding Element  \n In addition to the types derived from <xref:System.ServiceModel.Channels.BindingElement> that are provided by [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], you can create your own binding elements. This lets you customize the way the stack of bindings is created and the components that go in it by creating your own <xref:System.ServiceModel.Channels.BindingElement> that can be composed with the other system-provided types in the stack.  \n  \n For example, if you implement a `LoggingBindingElement` that provides the ability to log the message to a database, you must place it above a transport channel in the channel stack. In this case, the application creates a custom binding that composed the `LoggingBindingElement` with `TcpTransportBindingElement`, as in the following example.  \n  \n```csharp  \nBinding customBinding = new CustomBinding(  \n  new LoggingBindingElement(),   \n  new TcpTransportBindingElement()  \n);  \n```  \n  \n How you write your new binding element depends on its exact functionality. One of the samples, [Transport: UDP](../../../../docs/framework/wcf/samples/transport-udp.md), provides a detailed description of how to implement one kind of binding element.  \n  \n## Creating a New Binding  \n A user-created binding element can be used in two ways. The previous section illustrates the first way: through a custom binding. A custom binding allows the user to create their own binding based on an arbitrary set of binding elements, including user-created ones.  \n  \n If you use the binding in more than one application, create your own binding and extend the <xref:System.ServiceModel.Channels.Binding>. This avoids manually creating a custom binding every time you want to use it. A user-defined binding allows you to define the binding’s behavior and include user-defined binding elements. And it is *pre-packaged*: you do not have to rebuild the binding every time you use it.  \n  \n At a minimum, a user-defined binding must implement the <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> method and the <xref:System.ServiceModel.Channels.Binding.Scheme%2A> property.  \n  \n The <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> method returns a new <xref:System.ServiceModel.Channels.BindingElementCollection> that contains the binding elements for the binding. The collection is ordered, and should contain the protocol binding elements first, followed by the encoding binding element, followed by the transport binding element. When using the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] system-provided binding elements, you must follow the binding element ordering rules specified in [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md). This collection should never reference objects referenced within the user-defined binding class; consequently, binding authors must return a `Clone()` of the <xref:System.ServiceModel.Channels.BindingElementCollection> on each call to <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A>.  \n  \n The <xref:System.ServiceModel.Channels.Binding.Scheme%2A> property represents the URI scheme for the transport protocol in use on the binding. For example, the *WSHttpBinding* and the *NetTcpBinding* return \"http\" and \"net.tcp\" from their respective <xref:System.ServiceModel.Channels.Binding.Scheme%2A> properties.  \n  \n For a complete list of optional methods and properties for user-defined bindings, see <xref:System.ServiceModel.Channels.Binding>.  \n  \n### Example  \n This example implements profile binding in `SampleProfileUdpBinding`, which derives from <xref:System.ServiceModel.Channels.Binding>. The `SampleProfileUdpBinding` contains up to four binding elements within it: one user-created `UdpTransportBindingElement`; and three system-provided: `TextMessageEncodingBindingElement`, `CompositeDuplexBindingElement`, and `ReliableSessionBindingElement`.  \n  \n```  \npublic override BindingElementCollection CreateBindingElements()  \n{     \n    BindingElementCollection bindingElements = new BindingElementCollection();  \n    if (ReliableSessionEnabled)  \n    {  \n        bindingElements.Add(session);  \n        bindingElements.Add(compositeDuplex);  \n    }  \n    bindingElements.Add(encoding);  \n    bindingElements.Add(transport);  \n    return bindingElements.Clone();  \n}  \n```  \n  \n## Security Restrictions with Duplex Contracts  \n Not all binding elements are compatible with each other. In particular, there are some restrictions on security binding elements when used with duplex contracts.  \n  \n### One-Shot Security  \n You can implement \"one-shot\" security, where all the necessary security credentials are sent in a single message, by setting the `negotiateServiceCredential` attribute of the \\<message> configuration element to `false`.  \n  \n One-shot authentication does not work with duplex contracts.  \n  \n For Request-Reply contracts, one-shot authentication works only if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel> instances.  \n  \n For one-way contracts, one-shot authentication works if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IRequestChannel>, <xref:System.ServiceModel.Channels.IRequestSessionChannel>, <xref:System.ServiceModel.Channels.IOutputChannel> or <xref:System.ServiceModel.Channels.IOutputSessionChannel> instances.  \n  \n### Cookie-mode Security Context Tokens  \n Cookie mode security context tokens cannot be used with duplex contracts.  \n  \n For Request-Reply contracts, cookie-mode security context tokens work only if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel> instances.  \n  \n For one-way contracts, cookie-mode security context tokens works if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel> instances.  \n  \n### Session-mode Security Context Tokens  \n Session mode SCT works for duplex contracts if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IDuplexChannel> or <xref:System.ServiceModel.Channels.IDuplexSessionChannel> instances.  \n  \n Session mode SCT works for Request-Reply contracts if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IDuplexChannel>, <xref:System.ServiceModel.Channels.IDuplexSessionChannel>, <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel>, instances.  \n  \n Session mode SCT works for 1-way contracts if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IDuplexChannel>, <xref:System.ServiceModel.Channels.IDuplexSessionChannel>, <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel> instances.  \n  \n## Deriving from a Standard Binding  \n Instead of creating an entirely new binding class, it may be possible for you to extend one of the existing system-provided bindings. Much like the preceding case, you must override the <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> method and the <xref:System.ServiceModel.Channels.Binding.Scheme%2A> property.  \n  \n## See Also  \n <xref:System.ServiceModel.Channels.Binding>   \n [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md)","nodes":[{"pos":[12,59],"content":"Creating User-Defined Bindings | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Creating User-Defined Bindings | Microsoft Docs","pos":[0,47]}]},{"pos":[414,444],"content":"Creating User-Defined Bindings","linkify":"Creating User-Defined Bindings","nodes":[{"content":"Creating User-Defined Bindings","pos":[0,30]}]},{"content":"There are several ways to create bindings not provided by the system:","pos":[445,514]},{"content":"Create a custom binding, based on the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.CustomBinding&gt;</ph> class, which is a container that you fill with binding elements.","pos":[524,676],"source":"Create a custom binding, based on the <xref:System.ServiceModel.Channels.CustomBinding> class, which is a container that you fill with binding elements."},{"content":"The custom binding is then added to a service endpoint.","pos":[677,732]},{"content":"You can create the custom binding either programmatically or in an application configuration file.","pos":[733,831]},{"content":"To use a binding element from an application configuration file, the binding element must extend <ph id=\"ph1\">&lt;xref:System.ServiceModel.Configuration.BindingElementExtensionElement&gt;</ph>.","pos":[832,1001],"source":" To use a binding element from an application configuration file, the binding element must extend <xref:System.ServiceModel.Configuration.BindingElementExtensionElement>."},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> custom bindings, see <bpt id=\"p1\">[</bpt>Custom Bindings<ept id=\"p1\">](../../../../docs/framework/wcf/extending/custom-bindings.md)</ept> and <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.CustomBinding&gt;</ph>.","pos":[1002,1212],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] custom bindings, see [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md) and <xref:System.ServiceModel.Channels.CustomBinding>."},{"content":"You can create a class that derives from a standard binding.","pos":[1222,1282]},{"content":"For example, you can derive a class from <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> and override <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.CustomBinding.CreateBindingElements%2A&gt;</ph> method to obtain the binding elements and insert a custom binding element or establish a particular value for security.","pos":[1283,1572],"source":" For example, you can derive a class from <xref:System.ServiceModel.WSHttpBinding> and override <xref:System.ServiceModel.Channels.CustomBinding.CreateBindingElements%2A> method to obtain the binding elements and insert a custom binding element or establish a particular value for security."},{"content":"You can create a new <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Binding&gt;</ph> type to completely control the entire binding implementation.","pos":[1582,1708],"source":"You can create a new <xref:System.ServiceModel.Channels.Binding> type to completely control the entire binding implementation."},{"pos":[1717,1746],"content":"The Order of Binding Elements","linkify":"The Order of Binding Elements","nodes":[{"content":"The Order of Binding Elements","pos":[0,29]}]},{"content":"Each binding element represents a processing step when sending or receiving messages.","pos":[1750,1835]},{"content":"At runtime, binding elements create the channels and listeners necessary to build outgoing and incoming channel stacks.","pos":[1836,1955]},{"content":"There are three main types of binding elements: Protocol Binding Elements, Encoding Binding Elements and Transport Binding Elements.","pos":[1962,2094]},{"content":"Protocol Binding Elements – These elements represent higher-level processing steps that act on messages.","pos":[2101,2205]},{"content":"Channels and listeners created by these binding elements can add, remove, or modify the message content.","pos":[2206,2310]},{"content":"A given binding may have an arbitrary number of protocol binding elements, each inheriting from <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.BindingElement&gt;</ph>.","pos":[2311,2458],"source":" A given binding may have an arbitrary number of protocol binding elements, each inheriting from <xref:System.ServiceModel.Channels.BindingElement>."},{"content":"<ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> includes several protocol binding elements, including the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.ReliableSessionBindingElement&gt;</ph> and the <ph id=\"ph3\">&lt;xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement&gt;</ph>.","pos":[2459,2715],"source":"[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] includes several protocol binding elements, including the <xref:System.ServiceModel.Channels.ReliableSessionBindingElement> and the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement>."},{"content":"Encoding Binding Element – These elements represent transformations between a message and an encoding ready for transmission on the wire.","pos":[2722,2859]},{"content":"Typical <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> bindings include exactly one encoding binding element.","pos":[2860,2978],"source":" Typical [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] bindings include exactly one encoding binding element."},{"content":"Examples of encoding binding elements include the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement&gt;</ph>, the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement&gt;</ph>, and the <ph id=\"ph3\">&lt;xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement&gt;</ph>.","pos":[2979,3255],"source":" Examples of encoding binding elements include the <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>, the <xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>, and the <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>."},{"content":"If an encoding binding element is not specified for a binding, a default encoding is used.","pos":[3256,3346]},{"content":"The default is text when the transport is HTTP and binary otherwise.","pos":[3347,3415]},{"content":"Transport Binding Element – These elements represent the transmission of an encoding message on a transport protocol.","pos":[3422,3539]},{"content":"Typical <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> bindings include exactly one transport binding element, which inherits from <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.TransportBindingElement&gt;</ph>.","pos":[3540,3740],"source":" Typical [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] bindings include exactly one transport binding element, which inherits from <xref:System.ServiceModel.Channels.TransportBindingElement>."},{"content":"Examples of transport binding elements include the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.TcpTransportBindingElement&gt;</ph>, the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.HttpTransportBindingElement&gt;</ph>, and the <ph id=\"ph3\">&lt;xref:System.ServiceModel.Channels.NamedPipeTransportBindingElement&gt;</ph>.","pos":[3741,4002],"source":" Examples of transport binding elements include the <xref:System.ServiceModel.Channels.TcpTransportBindingElement>, the <xref:System.ServiceModel.Channels.HttpTransportBindingElement>, and the <xref:System.ServiceModel.Channels.NamedPipeTransportBindingElement>."},{"content":"When creating new bindings, the order of the added binding elements is important.","pos":[4009,4090]},{"content":"Always add binding elements in the following order:","pos":[4091,4142]},{"content":"Layer","pos":[4149,4154]},{"content":"Options","pos":[4155,4162]},{"content":"Required","pos":[4163,4171]},{"content":"Transaction Flow","pos":[4221,4237]},{"content":"No","pos":[4329,4331]},{"content":"Reliability","pos":[4336,4347]},{"content":"No","pos":[4439,4441]},{"content":"Security","pos":[4446,4454]},{"content":"No","pos":[4539,4541]},{"content":"Composite Duplex","pos":[4546,4562]},{"content":"No","pos":[4654,4656]},{"content":"Encoding","pos":[4661,4669]},{"content":"Text, Binary, MTOM, Custom","pos":[4670,4696]},{"content":"Yes*","pos":[4697,4701]},{"content":"Transport","pos":[4706,4715]},{"content":"TCP, Named Pipes, HTTP, HTTPS, MSMQ, Custom","pos":[4716,4759]},{"content":"Yes","pos":[4760,4763]},{"content":"*Because an encoding is required for each binding, if an encoding is not specified, <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> adds a default encoding for you.","pos":[4771,4943],"source":"*Because an encoding is required for each binding, if an encoding is not specified, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] adds a default encoding for you."},{"content":"The default is Text/XML for the HTTP and HTTPS transports, and Binary otherwise.","pos":[4944,5024]},{"pos":[5033,5063],"content":"Creating a new Binding Element","linkify":"Creating a new Binding Element","nodes":[{"content":"Creating a new Binding Element","pos":[0,30]}]},{"content":"In addition to the types derived from <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.BindingElement&gt;</ph> that are provided by <ph id=\"ph2\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph>, you can create your own binding elements.","pos":[5067,5275],"source":"In addition to the types derived from <xref:System.ServiceModel.Channels.BindingElement> that are provided by [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], you can create your own binding elements."},{"content":"This lets you customize the way the stack of bindings is created and the components that go in it by creating your own <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.BindingElement&gt;</ph> that can be composed with the other system-provided types in the stack.","pos":[5276,5517],"source":" This lets you customize the way the stack of bindings is created and the components that go in it by creating your own <xref:System.ServiceModel.Channels.BindingElement> that can be composed with the other system-provided types in the stack."},{"content":"For example, if you implement a <ph id=\"ph1\">`LoggingBindingElement`</ph> that provides the ability to log the message to a database, you must place it above a transport channel in the channel stack.","pos":[5524,5705],"source":"For example, if you implement a `LoggingBindingElement` that provides the ability to log the message to a database, you must place it above a transport channel in the channel stack."},{"content":"In this case, the application creates a custom binding that composed the <ph id=\"ph1\">`LoggingBindingElement`</ph> with <ph id=\"ph2\">`TcpTransportBindingElement`</ph>, as in the following example.","pos":[5706,5866],"source":" In this case, the application creates a custom binding that composed the `LoggingBindingElement` with `TcpTransportBindingElement`, as in the following example."},{"content":"How you write your new binding element depends on its exact functionality.","pos":[6015,6089]},{"content":"One of the samples, <bpt id=\"p1\">[</bpt>Transport: UDP<ept id=\"p1\">](../../../../docs/framework/wcf/samples/transport-udp.md)</ept>, provides a detailed description of how to implement one kind of binding element.","pos":[6090,6265],"source":" One of the samples, [Transport: UDP](../../../../docs/framework/wcf/samples/transport-udp.md), provides a detailed description of how to implement one kind of binding element."},{"pos":[6274,6296],"content":"Creating a New Binding","linkify":"Creating a New Binding","nodes":[{"content":"Creating a New Binding","pos":[0,22]}]},{"content":"A user-created binding element can be used in two ways.","pos":[6300,6355]},{"content":"The previous section illustrates the first way: through a custom binding.","pos":[6356,6429]},{"content":"A custom binding allows the user to create their own binding based on an arbitrary set of binding elements, including user-created ones.","pos":[6430,6566]},{"content":"If you use the binding in more than one application, create your own binding and extend the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Binding&gt;</ph>.","pos":[6573,6709],"source":"If you use the binding in more than one application, create your own binding and extend the <xref:System.ServiceModel.Channels.Binding>."},{"content":"This avoids manually creating a custom binding every time you want to use it.","pos":[6710,6787]},{"content":"A user-defined binding allows you to define the binding’s behavior and include user-defined binding elements.","pos":[6788,6897]},{"content":"And it is <bpt id=\"p1\">*</bpt>pre-packaged<ept id=\"p1\">*</ept>: you do not have to rebuild the binding every time you use it.","pos":[6898,6985],"source":" And it is *pre-packaged*: you do not have to rebuild the binding every time you use it."},{"content":"At a minimum, a user-defined binding must implement the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A&gt;</ph> method and the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.Binding.Scheme%2A&gt;</ph> property.","pos":[6992,7195],"source":"At a minimum, a user-defined binding must implement the <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> method and the <xref:System.ServiceModel.Channels.Binding.Scheme%2A> property."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A&gt;</ph> method returns a new <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.BindingElementCollection&gt;</ph> that contains the binding elements for the binding.","pos":[7202,7408],"source":"The <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> method returns a new <xref:System.ServiceModel.Channels.BindingElementCollection> that contains the binding elements for the binding."},{"content":"The collection is ordered, and should contain the protocol binding elements first, followed by the encoding binding element, followed by the transport binding element.","pos":[7409,7576]},{"content":"When using the <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> system-provided binding elements, you must follow the binding element ordering rules specified in <bpt id=\"p1\">[</bpt>Custom Bindings<ept id=\"p1\">](../../../../docs/framework/wcf/extending/custom-bindings.md)</ept>.","pos":[7577,7825],"source":" When using the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] system-provided binding elements, you must follow the binding element ordering rules specified in [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md)."},{"content":"This collection should never reference objects referenced within the user-defined binding class; consequently, binding authors must return a <ph id=\"ph1\">`Clone()`</ph> of the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.BindingElementCollection&gt;</ph> on each call to <ph id=\"ph3\">&lt;xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A&gt;</ph>.","pos":[7826,8130],"source":" This collection should never reference objects referenced within the user-defined binding class; consequently, binding authors must return a `Clone()` of the <xref:System.ServiceModel.Channels.BindingElementCollection> on each call to <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Binding.Scheme%2A&gt;</ph> property represents the URI scheme for the transport protocol in use on the binding.","pos":[8137,8279],"source":"The <xref:System.ServiceModel.Channels.Binding.Scheme%2A> property represents the URI scheme for the transport protocol in use on the binding."},{"content":"For example, the <bpt id=\"p1\">*</bpt>WSHttpBinding<ept id=\"p1\">*</ept> and the <bpt id=\"p2\">*</bpt>NetTcpBinding<ept id=\"p2\">*</ept> return \"http\" and \"net.tcp\" from their respective <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Binding.Scheme%2A&gt;</ph> properties.","pos":[8280,8452],"source":" For example, the *WSHttpBinding* and the *NetTcpBinding* return \"http\" and \"net.tcp\" from their respective <xref:System.ServiceModel.Channels.Binding.Scheme%2A> properties."},{"content":"For a complete list of optional methods and properties for user-defined bindings, see <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Binding&gt;</ph>.","pos":[8459,8589],"source":"For a complete list of optional methods and properties for user-defined bindings, see <xref:System.ServiceModel.Channels.Binding>."},{"pos":[8599,8606],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example implements profile binding in <ph id=\"ph1\">`SampleProfileUdpBinding`</ph>, which derives from <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.Binding&gt;</ph>.","pos":[8610,8743],"source":"This example implements profile binding in `SampleProfileUdpBinding`, which derives from <xref:System.ServiceModel.Channels.Binding>."},{"content":"The <ph id=\"ph1\">`SampleProfileUdpBinding`</ph> contains up to four binding elements within it: one user-created <ph id=\"ph2\">`UdpTransportBindingElement`</ph>; and three system-provided: <ph id=\"ph3\">`TextMessageEncodingBindingElement`</ph>, <ph id=\"ph4\">`CompositeDuplexBindingElement`</ph>, and <ph id=\"ph5\">`ReliableSessionBindingElement`</ph>.","pos":[8744,9002],"source":" The `SampleProfileUdpBinding` contains up to four binding elements within it: one user-created `UdpTransportBindingElement`; and three system-provided: `TextMessageEncodingBindingElement`, `CompositeDuplexBindingElement`, and `ReliableSessionBindingElement`."},{"pos":[9436,9479],"content":"Security Restrictions with Duplex Contracts","linkify":"Security Restrictions with Duplex Contracts","nodes":[{"content":"Security Restrictions with Duplex Contracts","pos":[0,43]}]},{"content":"Not all binding elements are compatible with each other.","pos":[9483,9539]},{"content":"In particular, there are some restrictions on security binding elements when used with duplex contracts.","pos":[9540,9644]},{"pos":[9654,9671],"content":"One-Shot Security","linkify":"One-Shot Security","nodes":[{"content":"One-Shot Security","pos":[0,17]}]},{"pos":[9675,9894],"content":"You can implement \"one-shot\" security, where all the necessary security credentials are sent in a single message, by setting the <ph id=\"ph1\">`negotiateServiceCredential`</ph> attribute of the <ph id=\"ph2\">\\&lt;</ph>message&gt; configuration element to <ph id=\"ph3\">`false`</ph>.","source":"You can implement \"one-shot\" security, where all the necessary security credentials are sent in a single message, by setting the `negotiateServiceCredential` attribute of the \\<message> configuration element to `false`."},{"content":"One-shot authentication does not work with duplex contracts.","pos":[9901,9961]},{"content":"For Request-Reply contracts, one-shot authentication works only if the binding stack below the security binding element supports creating <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.IRequestChannel&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.IRequestSessionChannel&gt;</ph> instances.","pos":[9968,10230],"source":"For Request-Reply contracts, one-shot authentication works only if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel> instances."},{"content":"For one-way contracts, one-shot authentication works if the binding stack below the security binding element supports creating <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.IRequestChannel&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.IRequestSessionChannel&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.ServiceModel.Channels.IOutputChannel&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.ServiceModel.Channels.IOutputSessionChannel&gt;</ph> instances.","pos":[10237,10599],"source":"For one-way contracts, one-shot authentication works if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IRequestChannel>, <xref:System.ServiceModel.Channels.IRequestSessionChannel>, <xref:System.ServiceModel.Channels.IOutputChannel> or <xref:System.ServiceModel.Channels.IOutputSessionChannel> instances."},{"pos":[10609,10644],"content":"Cookie-mode Security Context Tokens","linkify":"Cookie-mode Security Context Tokens","nodes":[{"content":"Cookie-mode Security Context Tokens","pos":[0,35]}]},{"content":"Cookie mode security context tokens cannot be used with duplex contracts.","pos":[10648,10721]},{"content":"For Request-Reply contracts, cookie-mode security context tokens work only if the binding stack below the security binding element supports creating <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.IRequestChannel&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.IRequestSessionChannel&gt;</ph> instances.","pos":[10728,11001],"source":"For Request-Reply contracts, cookie-mode security context tokens work only if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel> instances."},{"content":"For one-way contracts, cookie-mode security context tokens works if the binding stack below the security binding element supports creating <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.IRequestChannel&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.IRequestSessionChannel&gt;</ph> instances.","pos":[11008,11271],"source":"For one-way contracts, cookie-mode security context tokens works if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel> instances."},{"pos":[11281,11317],"content":"Session-mode Security Context Tokens","linkify":"Session-mode Security Context Tokens","nodes":[{"content":"Session-mode Security Context Tokens","pos":[0,36]}]},{"content":"Session mode SCT works for duplex contracts if the binding stack below the security binding element supports creating <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.IDuplexChannel&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.IDuplexSessionChannel&gt;</ph> instances.","pos":[11321,11561],"source":"Session mode SCT works for duplex contracts if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IDuplexChannel> or <xref:System.ServiceModel.Channels.IDuplexSessionChannel> instances."},{"content":"Session mode SCT works for Request-Reply contracts if the binding stack below the security binding element supports creating <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.IDuplexChannel&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.IDuplexSessionChannel&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.ServiceModel.Channels.IRequestChannel&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.ServiceModel.Channels.IRequestSessionChannel&gt;</ph>, instances.","pos":[11568,11929],"source":"Session mode SCT works for Request-Reply contracts if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IDuplexChannel>, <xref:System.ServiceModel.Channels.IDuplexSessionChannel>, <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel>, instances."},{"content":"Session mode SCT works for 1-way contracts if the binding stack below the security binding element supports creating <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.IDuplexChannel&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.IDuplexSessionChannel&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.ServiceModel.Channels.IRequestChannel&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.ServiceModel.Channels.IRequestSessionChannel&gt;</ph> instances.","pos":[11936,12288],"source":"Session mode SCT works for 1-way contracts if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IDuplexChannel>, <xref:System.ServiceModel.Channels.IDuplexSessionChannel>, <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel> instances."},{"pos":[12297,12329],"content":"Deriving from a Standard Binding","linkify":"Deriving from a Standard Binding","nodes":[{"content":"Deriving from a Standard Binding","pos":[0,32]}]},{"content":"Instead of creating an entirely new binding class, it may be possible for you to extend one of the existing system-provided bindings.","pos":[12333,12466]},{"content":"Much like the preceding case, you must override the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A&gt;</ph> method and the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.Binding.Scheme%2A&gt;</ph> property.","pos":[12467,12666],"source":" Much like the preceding case, you must override the <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> method and the <xref:System.ServiceModel.Channels.Binding.Scheme%2A> property."},{"pos":[12675,12683],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>Custom Bindings<ept id=\"p1\">](../../../../docs/framework/wcf/extending/custom-bindings.md)</ept>","pos":[12734,12813],"source":" [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md)"}]}