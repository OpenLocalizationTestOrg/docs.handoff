{"content":"---\ntitle: \"Filling a DataSet Using One or More REF CURSORs | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 99863e79-5b00-467e-a105-4ffa42de3ff7\ncaps.latest.revision: 3\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Filling a DataSet Using One or More REF CURSORs\nThis Microsoft Visual Basic example executes a PL/SQL stored procedure that returns two REF CURSOR parameters, and fills a <xref:System.Data.DataSet> with the rows that are returned.  \n  \n```vb  \nPrivate Sub Button1_Click(ByVal sender As Object, _  \n  ByVal e As System.EventArgs) Handles Button1.Click  \n  \n  Dim connString As New String(_  \n    \"Data Source=Oracle9i;User ID=scott;Password=tiger;\")  \n  Dim ds As New DataSet()  \n    Using conn As New OracleConnection(connString)  \n    Dim cmd As New OracleCommand()  \n  \n    cmd.Connection = conn  \n    cmd.CommandText = \"CURSPKG.OPEN_TWO_CURSORS\"  \n    cmd.CommandType = CommandType.StoredProcedure  \n    cmd.Parameters.Add(New OracleParameter( _  \n      \"EMPCURSOR\", OracleType.Cursor)).Direction = _  \n      ParameterDirection.Output  \n    cmd.Parameters.Add(New OracleParameter( _  \n      \"DEPTCURSOR\", OracleType.Cursor)).Direction = _  \n       ParameterDirection.Output  \n  \n    Dim da As New OracleDataAdapter(cmd)  \n    da.TableMappings.Add(\"Table\", \"Emp\")  \n    da.TableMappings.Add(\"Table1\", \"Dept\")  \n    da.Fill(ds)  \n  \n    ds.Relations.Add(\"EmpDept\", ds.Tables(\"Dept\").Columns(\"Deptno\"), _  \n      ds.Tables(\"Emp\").Columns(\"Deptno\"), False)  \n  \n    DataGrid1.DataSource = ds.Tables(\"Dept\")  \n  End Using  \n```  \n  \n## See Also  \n [Oracle REF CURSORs](../../../../docs/framework/data/adonet/oracle-ref-cursors.md)   \n [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)","nodes":[{"pos":[4,378],"nodes":[{"content":"Filling a DataSet Using One or More REF CURSORs | Microsoft Docs","nodes":[{"pos":[0,64],"content":"Filling a DataSet Using One or More REF CURSORs | Microsoft Docs","nodes":[{"content":"Filling a DataSet Using One or More REF CURSORs | Microsoft Docs","pos":[0,64]}]}],"pos":[6,73],"yaml":true}],"content":"title: \"Filling a DataSet Using One or More REF CURSORs | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 99863e79-5b00-467e-a105-4ffa42de3ff7\ncaps.latest.revision: 3\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","yamlblock":true},{"pos":[385,432],"content":"Filling a DataSet Using One or More REF CURSORs","linkify":"Filling a DataSet Using One or More REF CURSORs","nodes":[{"content":"Filling a DataSet Using One or More REF CURSORs","pos":[0,47]}]},{"content":"This Microsoft Visual Basic example executes a PL/SQL stored procedure that returns two REF CURSOR parameters, and fills a <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> with the rows that are returned.","pos":[433,615],"source":"This Microsoft Visual Basic example executes a PL/SQL stored procedure that returns two REF CURSOR parameters, and fills a <xref:System.Data.DataSet> with the rows that are returned."},{"pos":[1719,1727],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Oracle REF CURSORs<ept id=\"p1\">](../../../../docs/framework/data/adonet/oracle-ref-cursors.md)</ept><ph id=\"ph1\"> </ph>","pos":[1731,1814],"source":"[Oracle REF CURSORs](../../../../docs/framework/data/adonet/oracle-ref-cursors.md) "},{"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=217917)</ept>","pos":[1818,1921],"source":"[ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)"}]}