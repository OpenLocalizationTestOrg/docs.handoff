{"content":"---\ntitle: \"Walkthrough: Using Only Stored Procedures (C#) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: ecde4bf2-fa4d-4252-b5e4-96a46b9e097d\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Walkthrough: Using Only Stored Procedures (C#)\nThis walkthrough provides a basic end-to-end [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] scenario for accessing data by executing stored procedures only. This approach is often used by database administrators to limit how the datastore is accessed.  \n  \n> [!NOTE]\n>  You can also use stored procedures in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] applications to override default behavior, especially for `Create`, `Update`, and `Delete` processes. For more information, see [Customizing Insert, Update, and Delete Operations](../../../../../../docs/framework/data/adonet/sql/linq/customizing-insert-update-and-delete-operations.md).  \n  \n For purposes of this walkthrough, you will use two methods that have been mapped to stored procedures in the Northwind sample database: CustOrdersDetail and CustOrderHist. The mapping occurs when you run the SqlMetal command-line tool to generate a C# file. For more information, see the Prerequisites section later in this walkthrough.  \n  \n This walkthrough does not rely on the [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)]. Developers using [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)] can also use the [!INCLUDE[vs_ordesigner_short](../../../../../../includes/vs-ordesigner-short-md.md)] to implement stored procedure functionality. See [LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2).  \n  \n [!INCLUDE[note_settings_general](../../../../../../includes/note-settings-general-md.md)]  \n  \n This walkthrough was written by using Visual C# Development Settings.  \n  \n## Prerequisites  \n This walkthrough requires the following:  \n  \n-   This walkthrough uses a dedicated folder (\"c:\\linqtest7\") to hold files. Create this folder before you begin the walkthrough.  \n  \n-   The Northwind sample database.  \n  \n     If you do not have this database on your development computer, you can download it from the Microsoft download site. For instructions, see [Downloading Sample Databases](../../../../../../docs/framework/data/adonet/sql/linq/downloading-sample-databases.md). After you have downloaded the database, copy the northwnd.mdf file to the c:\\linqtest7 folder.  \n  \n-   A C# code file generated from the Northwind database.  \n  \n     This walkthrough was written by using the SqlMetal tool with the following command line:  \n  \n     **sqlmetal /code:\"c:\\linqtest7\\northwind.cs\" /language:csharp \"c:\\linqtest7\\northwnd.mdf\" /sprocs /functions /pluralize**  \n  \n     For more information, see [SqlMetal.exe (Code Generation Tool)](../../../../../../docs/framework/tools/sqlmetal-exe-code-generation-tool.md).  \n  \n## Overview  \n This walkthrough consists of six main tasks:  \n  \n-   Setting up the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] solution in [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)].  \n  \n-   Adding the System.Data.Linq assembly to the project.  \n  \n-   Adding the database code file to the project.  \n  \n-   Creating a connection with the database.  \n  \n-   Setting up the user interface.  \n  \n-   Running and testing the application.  \n  \n## Creating a LINQ to SQL Solution  \n In this first task, you create a [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)] solution that contains the necessary references to build and run a [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] project.  \n  \n#### To create a LINQ to SQL solution  \n  \n1.  On the [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)] **File** menu, point to **New**, and then click **Project**.  \n  \n2.  In the **Project types** pane in the **New Project** dialog box, click **Visual C#**.  \n  \n3.  In the **Templates** pane, click **Windows Forms Application**.  \n  \n4.  In the **Name** box, type **SprocOnlyApp**.  \n  \n5.  In the **Location** box, verify where you want to store your project files.  \n  \n6.  Click **OK**.  \n  \n     The Windows Forms Designer opens.  \n  \n## Adding the LINQ to SQL Assembly Reference  \n The [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] assembly is not included in the standard Windows Forms Application template. You will have to add the assembly yourself, as explained in the following steps:  \n  \n#### To add System.Data.Linq.dll  \n  \n1.  In **Solution Explorer**, right-click **References**, and then click **Add Reference**.  \n  \n2.  In the **Add Reference** dialog box, click **.NET**, click the System.Data.Linq assembly, and then click **OK**.  \n  \n     The assembly is added to the project.  \n  \n## Adding the Northwind Code File to the Project  \n This step assumes that you have used the SqlMetal tool to generate a code file from the Northwind sample database. For more information, see the Prerequisites section earlier in this walkthrough.  \n  \n#### To add the northwind code file to the project  \n  \n1.  On the **Project** menu, click **Add Existing Item**.  \n  \n2.  In the **Add Existing Item** dialog box, move to c:\\linqtest7\\northwind.cs, and then click **Add**.  \n  \n     The northwind.cs file is added to the project.  \n  \n## Creating a Database Connection  \n In this step, you define the connection to the Northwind sample database. This walkthrough uses \"c:\\linqtest7\\northwnd.mdf\" as the path.  \n  \n#### To create the database connection  \n  \n1.  In **Solution Explorer**, right-click **Form1.cs**, and then click **View Code**.  \n  \n2.  Type the following code into the `Form1` class:  \n  \n     [!code-csharp[DLinqWalk4CS#1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqWalk4CS/cs/Form1.cs#1)]  \n  \n## Setting up the User Interface  \n In this task you set up an interface so that users can execute stored procedures to access data in the database. In the applications that you are developing with this walkthrough, users can access data in the database only by using the stored procedures embedded in the application.  \n  \n#### To set up the user interface  \n  \n1.  Return to the Windows Forms Designer (**Form1.cs[Design]**).  \n  \n2.  On the **View** menu, click **Toolbox**.  \n  \n     The toolbox opens.  \n  \n    > [!NOTE]\n    >  Click the **AutoHide** pushpin to keep the toolbox open while you perform the remaining steps in this section.  \n  \n3.  Drag two buttons, two text boxes, and two labels from the toolbox onto **Form1**.  \n  \n     Arrange the controls as in the accompanying illustration. Expand **Form1** so that the controls fit easily.  \n  \n4.  Right-click **label1**, and then click **Properties**.  \n  \n5.  Change the **Text** property from **label1** to **Enter OrderID:**.  \n  \n6.  In the same way for **label2**, change the **Text** property from **label2** to **Enter CustomerID:**.  \n  \n7.  In the same way, change the **Text** property for **button1** to **Order Details**.  \n  \n8.  Change the **Text** property for **button2** to **Order History**.  \n  \n     Widen the button controls so that all the text is visible.  \n  \n#### To handle button clicks  \n  \n1.  Double-click **Order Details** on **Form1** to open the button1 event handler in the code editor.  \n  \n2.  Type the following code into the `button1` handler:  \n  \n     [!code-csharp[DLinqWalk4CS#2](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqWalk4CS/cs/Form1.cs#2)]  \n  \n3.  Now double-click **button2** on **Form1** to open the `button2` handler  \n  \n4.  Type the following code into the `button2` handler:  \n  \n     [!code-csharp[DLinqWalk4CS#3](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqWalk4CS/cs/Form1.cs#3)]  \n  \n## Testing the Application  \n Now it is time to test your application. Note that your contact with the datastore is limited to whatever actions the two stored procedures can take. Those actions are to return the products included for any orderID you enter, or to return a history of products ordered for any CustomerID you enter.  \n  \n#### To test the application  \n  \n1.  Press F5 to start debugging.  \n  \n     Form1 appears.  \n  \n2.  In the **Enter OrderID** box, type `10249`, and then click **Order Details**.  \n  \n     A message box lists the products included in order 10249.  \n  \n     Click **OK** to close the message box.  \n  \n3.  In the **Enter CustomerID** box, type `ALFKI`, and then click **Order History**.  \n  \n     A message box appears that lists the order history for customer ALFKI.  \n  \n     Click **OK** to close the message box.  \n  \n4.  In the **Enter OrderID** box, type `123`, and then click **Order Details**.  \n  \n     A message box appears that displays \"No results.\"  \n  \n     Click **OK** to close the message box.  \n  \n5.  On the **Debug** menu, click **Stop debugging**.  \n  \n     The debug session closes.  \n  \n6.  If you have finished experimenting, you can click **Close Project** on the **File** menu, and save your project when you are prompted.  \n  \n## Next Steps  \n You can enhance this project by making some changes. For example, you could list available stored procedures in a list box and have the user select which procedures to execute. You could also stream the output of the reports to a text file.  \n  \n## See Also  \n [Learning by Walkthroughs](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md)   \n [Stored Procedures](../../../../../../docs/framework/data/adonet/sql/linq/stored-procedures.md)","nodes":[{"pos":[4,377],"nodes":[{"content":"Walkthrough: Using Only Stored Procedures (C#) | Microsoft Docs","nodes":[{"pos":[0,63],"content":"Walkthrough: Using Only Stored Procedures (C#) | Microsoft Docs","nodes":[{"content":"Walkthrough: Using Only Stored Procedures (C#) | Microsoft Docs","pos":[0,63]}]}],"pos":[6,72],"yaml":true}],"content":"title: \"Walkthrough: Using Only Stored Procedures (C#) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: ecde4bf2-fa4d-4252-b5e4-96a46b9e097d\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","yamlblock":true},{"pos":[384,430],"content":"Walkthrough: Using Only Stored Procedures (C#)","linkify":"Walkthrough: Using Only Stored Procedures (C#)","nodes":[{"content":"Walkthrough: Using Only Stored Procedures (C#)","pos":[0,46]}]},{"content":"This walkthrough provides a basic end-to-end <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> scenario for accessing data by executing stored procedures only.","pos":[431,608],"source":"This walkthrough provides a basic end-to-end [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] scenario for accessing data by executing stored procedures only."},{"content":"This approach is often used by database administrators to limit how the datastore is accessed.","pos":[609,703]},{"pos":[711,1114],"content":"[!NOTE]\n You can also use stored procedures in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] applications to override default behavior, especially for `Create`, `Update`, and `Delete` processes. For more information, see [Customizing Insert, Update, and Delete Operations](../../../../../../docs/framework/data/adonet/sql/linq/customizing-insert-update-and-delete-operations.md).","leadings":["","> "],"nodes":[{"content":"You can also use stored procedures in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] applications to override default behavior, especially for `Create`, `Update`, and `Delete` processes. For more information, see [Customizing Insert, Update, and Delete Operations](../../../../../../docs/framework/data/adonet/sql/linq/customizing-insert-update-and-delete-operations.md).","pos":[9,401],"nodes":[{"content":"You can also use stored procedures in <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> applications to override default behavior, especially for <ph id=\"ph2\">`Create`</ph>, <ph id=\"ph3\">`Update`</ph>, and <ph id=\"ph4\">`Delete`</ph> processes.","pos":[0,207],"source":"You can also use stored procedures in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] applications to override default behavior, especially for `Create`, `Update`, and `Delete` processes."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Customizing Insert, Update, and Delete Operations<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/customizing-insert-update-and-delete-operations.md)</ept>.","pos":[208,392],"source":" For more information, see [Customizing Insert, Update, and Delete Operations](../../../../../../docs/framework/data/adonet/sql/linq/customizing-insert-update-and-delete-operations.md)."}]}]},{"content":"For purposes of this walkthrough, you will use two methods that have been mapped to stored procedures in the Northwind sample database: CustOrdersDetail and CustOrderHist.","pos":[1121,1292]},{"content":"The mapping occurs when you run the SqlMetal command-line tool to generate a C# file.","pos":[1293,1378]},{"content":"For more information, see the Prerequisites section later in this walkthrough.","pos":[1379,1457]},{"content":"This walkthrough does not rely on the <ph id=\"ph1\">[!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)]</ph>.","pos":[1464,1586],"source":"This walkthrough does not rely on the [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)]."},{"content":"Developers using <ph id=\"ph1\">[!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)]</ph> can also use the <ph id=\"ph2\">[!INCLUDE[vs_ordesigner_short](../../../../../../includes/vs-ordesigner-short-md.md)]</ph> to implement stored procedure functionality.","pos":[1587,1831],"source":" Developers using [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)] can also use the [!INCLUDE[vs_ordesigner_short](../../../../../../includes/vs-ordesigner-short-md.md)] to implement stored procedure functionality."},{"content":"See <bpt id=\"p1\">[</bpt>LINQ to SQL Tools in Visual Studio<ept id=\"p1\">](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)</ept>.","pos":[1832,1935],"source":" See [LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)."},{"content":"This walkthrough was written by using Visual C# Development Settings.","pos":[2038,2107]},{"pos":[2116,2129],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"This walkthrough requires the following:","pos":[2133,2173]},{"content":"This walkthrough uses a dedicated folder (\"c:\\linqtest7\") to hold files.","pos":[2183,2255]},{"content":"Create this folder before you begin the walkthrough.","pos":[2256,2308]},{"content":"The Northwind sample database.","pos":[2318,2348]},{"content":"If you do not have this database on your development computer, you can download it from the Microsoft download site.","pos":[2359,2475]},{"content":"For instructions, see <bpt id=\"p1\">[</bpt>Downloading Sample Databases<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/downloading-sample-databases.md)</ept>.","pos":[2476,2616],"source":" For instructions, see [Downloading Sample Databases](../../../../../../docs/framework/data/adonet/sql/linq/downloading-sample-databases.md)."},{"content":"After you have downloaded the database, copy the northwnd.mdf file to the c:\\linqtest7 folder.","pos":[2617,2711]},{"content":"A C# code file generated from the Northwind database.","pos":[2721,2774]},{"content":"This walkthrough was written by using the SqlMetal tool with the following command line:","pos":[2785,2873]},{"pos":[2884,3005],"content":"<bpt id=\"p1\">**</bpt>sqlmetal /code:\"c:\\linqtest7\\northwind.cs\" /language:csharp \"c:\\linqtest7\\northwnd.mdf\" /sprocs /functions /pluralize<ept id=\"p1\">**</ept>","source":"**sqlmetal /code:\"c:\\linqtest7\\northwind.cs\" /language:csharp \"c:\\linqtest7\\northwnd.mdf\" /sprocs /functions /pluralize**"},{"pos":[3016,3157],"content":"For more information, see <bpt id=\"p1\">[</bpt>SqlMetal.exe (Code Generation Tool)<ept id=\"p1\">](../../../../../../docs/framework/tools/sqlmetal-exe-code-generation-tool.md)</ept>.","source":"For more information, see [SqlMetal.exe (Code Generation Tool)](../../../../../../docs/framework/tools/sqlmetal-exe-code-generation-tool.md)."},{"pos":[3166,3174],"content":"Overview","linkify":"Overview","nodes":[{"content":"Overview","pos":[0,8]}]},{"content":"This walkthrough consists of six main tasks:","pos":[3178,3222]},{"pos":[3232,3407],"content":"Setting up the <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> solution in <ph id=\"ph2\">[!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)]</ph>.","source":"Setting up the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] solution in [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)]."},{"content":"Adding the System.Data.Linq assembly to the project.","pos":[3417,3469]},{"content":"Adding the database code file to the project.","pos":[3479,3524]},{"content":"Creating a connection with the database.","pos":[3534,3574]},{"content":"Setting up the user interface.","pos":[3584,3614]},{"content":"Running and testing the application.","pos":[3624,3660]},{"pos":[3669,3700],"content":"Creating a LINQ to SQL Solution","linkify":"Creating a LINQ to SQL Solution","nodes":[{"content":"Creating a LINQ to SQL Solution","pos":[0,31]}]},{"pos":[3704,3960],"content":"In this first task, you create a <ph id=\"ph1\">[!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)]</ph> solution that contains the necessary references to build and run a <ph id=\"ph2\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> project.","source":"In this first task, you create a [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)] solution that contains the necessary references to build and run a [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] project."},{"pos":[3971,4003],"content":"To create a LINQ to SQL solution","linkify":"To create a LINQ to SQL solution","nodes":[{"content":"To create a LINQ to SQL solution","pos":[0,32]}]},{"pos":[4013,4160],"content":"On the <ph id=\"ph1\">[!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)]</ph> <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"On the [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)] **File** menu, point to **New**, and then click **Project**."},{"pos":[4170,4255],"content":"In the <bpt id=\"p1\">**</bpt>Project types<ept id=\"p1\">**</ept> pane in the <bpt id=\"p2\">**</bpt>New Project<ept id=\"p2\">**</ept> dialog box, click <bpt id=\"p3\">**</bpt>Visual C#<ept id=\"p3\">**</ept>.","source":"In the **Project types** pane in the **New Project** dialog box, click **Visual C#**."},{"pos":[4265,4328],"content":"In the <bpt id=\"p1\">**</bpt>Templates<ept id=\"p1\">**</ept> pane, click <bpt id=\"p2\">**</bpt>Windows Forms Application<ept id=\"p2\">**</ept>.","source":"In the **Templates** pane, click **Windows Forms Application**."},{"pos":[4338,4381],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>SprocOnlyApp<ept id=\"p2\">**</ept>.","source":"In the **Name** box, type **SprocOnlyApp**."},{"pos":[4391,4466],"content":"In the <bpt id=\"p1\">**</bpt>Location<ept id=\"p1\">**</ept> box, verify where you want to store your project files.","source":"In the **Location** box, verify where you want to store your project files."},{"pos":[4476,4489],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"content":"The Windows Forms Designer opens.","pos":[4500,4533]},{"pos":[4542,4583],"content":"Adding the LINQ to SQL Assembly Reference","linkify":"Adding the LINQ to SQL Assembly Reference","nodes":[{"content":"Adding the LINQ to SQL Assembly Reference","pos":[0,41]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> assembly is not included in the standard Windows Forms Application template.","pos":[4587,4735],"source":"The [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] assembly is not included in the standard Windows Forms Application template."},{"content":"You will have to add the assembly yourself, as explained in the following steps:","pos":[4736,4816]},{"pos":[4827,4854],"content":"To add System.Data.Linq.dll","linkify":"To add System.Data.Linq.dll","nodes":[{"content":"To add System.Data.Linq.dll","pos":[0,27]}]},{"pos":[4864,4951],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click <bpt id=\"p2\">**</bpt>References<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Add Reference<ept id=\"p3\">**</ept>.","source":"In **Solution Explorer**, right-click **References**, and then click **Add Reference**."},{"pos":[4961,5073],"content":"In the <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>.NET<ept id=\"p2\">**</ept>, click the System.Data.Linq assembly, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","source":"In the **Add Reference** dialog box, click **.NET**, click the System.Data.Linq assembly, and then click **OK**."},{"content":"The assembly is added to the project.","pos":[5084,5121]},{"pos":[5130,5175],"content":"Adding the Northwind Code File to the Project","linkify":"Adding the Northwind Code File to the Project","nodes":[{"content":"Adding the Northwind Code File to the Project","pos":[0,45]}]},{"content":"This step assumes that you have used the SqlMetal tool to generate a code file from the Northwind sample database.","pos":[5179,5293]},{"content":"For more information, see the Prerequisites section earlier in this walkthrough.","pos":[5294,5374]},{"pos":[5385,5430],"content":"To add the northwind code file to the project","linkify":"To add the northwind code file to the project","nodes":[{"content":"To add the northwind code file to the project","pos":[0,45]}]},{"pos":[5440,5493],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Add Existing Item<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, click **Add Existing Item**."},{"pos":[5503,5602],"content":"In the <bpt id=\"p1\">**</bpt>Add Existing Item<ept id=\"p1\">**</ept> dialog box, move to c:\\linqtest7\\northwind.cs, and then click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>.","source":"In the **Add Existing Item** dialog box, move to c:\\linqtest7\\northwind.cs, and then click **Add**."},{"content":"The northwind.cs file is added to the project.","pos":[5613,5659]},{"pos":[5668,5698],"content":"Creating a Database Connection","linkify":"Creating a Database Connection","nodes":[{"content":"Creating a Database Connection","pos":[0,30]}]},{"content":"In this step, you define the connection to the Northwind sample database.","pos":[5702,5775]},{"content":"This walkthrough uses \"c:\\linqtest7\\northwnd.mdf\" as the path.","pos":[5776,5838]},{"pos":[5849,5882],"content":"To create the database connection","linkify":"To create the database connection","nodes":[{"content":"To create the database connection","pos":[0,33]}]},{"pos":[5892,5973],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click <bpt id=\"p2\">**</bpt>Form1.cs<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>View Code<ept id=\"p3\">**</ept>.","source":"In **Solution Explorer**, right-click **Form1.cs**, and then click **View Code**."},{"pos":[5983,6030],"content":"Type the following code into the <ph id=\"ph1\">`Form1`</ph> class:","source":"Type the following code into the `Form1` class:"},{"pos":[6041,6158],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DLinqWalk4CS#1<ept id=\"p2\">](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqWalk4CS/cs/Form1.cs#1)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[DLinqWalk4CS#1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqWalk4CS/cs/Form1.cs#1)]"},{"pos":[6167,6196],"content":"Setting up the User Interface","linkify":"Setting up the User Interface","nodes":[{"content":"Setting up the User Interface","pos":[0,29]}]},{"content":"In this task you set up an interface so that users can execute stored procedures to access data in the database.","pos":[6200,6312]},{"content":"In the applications that you are developing with this walkthrough, users can access data in the database only by using the stored procedures embedded in the application.","pos":[6313,6482]},{"pos":[6493,6521],"content":"To set up the user interface","linkify":"To set up the user interface","nodes":[{"content":"To set up the user interface","pos":[0,28]}]},{"pos":[6531,6591],"content":"Return to the Windows Forms Designer (<bpt id=\"p1\">**</bpt>Form1.cs[Design]<ept id=\"p1\">**</ept>).","source":"Return to the Windows Forms Designer (**Form1.cs[Design]**)."},{"pos":[6601,6641],"content":"On the <bpt id=\"p1\">**</bpt>View<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Toolbox<ept id=\"p2\">**</ept>.","source":"On the **View** menu, click **Toolbox**."},{"content":"The toolbox opens.","pos":[6652,6670]},{"pos":[6682,6807],"content":"[!NOTE]\nClick the **AutoHide** pushpin to keep the toolbox open while you perform the remaining steps in this section.","leadings":["","    >  "],"nodes":[{"content":"Click the <bpt id=\"p1\">**</bpt>AutoHide<ept id=\"p1\">**</ept> pushpin to keep the toolbox open while you perform the remaining steps in this section.","pos":[8,118],"source":"Click the **AutoHide** pushpin to keep the toolbox open while you perform the remaining steps in this section."}]},{"pos":[6817,6898],"content":"Drag two buttons, two text boxes, and two labels from the toolbox onto <bpt id=\"p1\">**</bpt>Form1<ept id=\"p1\">**</ept>.","source":"Drag two buttons, two text boxes, and two labels from the toolbox onto **Form1**."},{"content":"Arrange the controls as in the accompanying illustration.","pos":[6909,6966]},{"content":"Expand <bpt id=\"p1\">**</bpt>Form1<ept id=\"p1\">**</ept> so that the controls fit easily.","pos":[6967,7016],"source":" Expand **Form1** so that the controls fit easily."},{"pos":[7026,7080],"content":"Right-click <bpt id=\"p1\">**</bpt>label1<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","source":"Right-click **label1**, and then click **Properties**."},{"pos":[7090,7157],"content":"Change the <bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept> property from <bpt id=\"p2\">**</bpt>label1<ept id=\"p2\">**</ept> to <bpt id=\"p3\">**</bpt>Enter OrderID:<ept id=\"p3\">**</ept>.","source":"Change the **Text** property from **label1** to **Enter OrderID:**."},{"pos":[7167,7269],"content":"In the same way for <bpt id=\"p1\">**</bpt>label2<ept id=\"p1\">**</ept>, change the <bpt id=\"p2\">**</bpt>Text<ept id=\"p2\">**</ept> property from <bpt id=\"p3\">**</bpt>label2<ept id=\"p3\">**</ept> to <bpt id=\"p4\">**</bpt>Enter CustomerID:<ept id=\"p4\">**</ept>.","source":"In the same way for **label2**, change the **Text** property from **label2** to **Enter CustomerID:**."},{"pos":[7279,7362],"content":"In the same way, change the <bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept> property for <bpt id=\"p2\">**</bpt>button1<ept id=\"p2\">**</ept> to <bpt id=\"p3\">**</bpt>Order Details<ept id=\"p3\">**</ept>.","source":"In the same way, change the **Text** property for **button1** to **Order Details**."},{"pos":[7372,7438],"content":"Change the <bpt id=\"p1\">**</bpt>Text<ept id=\"p1\">**</ept> property for <bpt id=\"p2\">**</bpt>button2<ept id=\"p2\">**</ept> to <bpt id=\"p3\">**</bpt>Order History<ept id=\"p3\">**</ept>.","source":"Change the **Text** property for **button2** to **Order History**."},{"content":"Widen the button controls so that all the text is visible.","pos":[7449,7507]},{"pos":[7518,7541],"content":"To handle button clicks","linkify":"To handle button clicks","nodes":[{"content":"To handle button clicks","pos":[0,23]}]},{"pos":[7551,7648],"content":"Double-click <bpt id=\"p1\">**</bpt>Order Details<ept id=\"p1\">**</ept> on <bpt id=\"p2\">**</bpt>Form1<ept id=\"p2\">**</ept> to open the button1 event handler in the code editor.","source":"Double-click **Order Details** on **Form1** to open the button1 event handler in the code editor."},{"pos":[7658,7709],"content":"Type the following code into the <ph id=\"ph1\">`button1`</ph> handler:","source":"Type the following code into the `button1` handler:"},{"pos":[7720,7837],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DLinqWalk4CS#2<ept id=\"p2\">](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqWalk4CS/cs/Form1.cs#2)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[DLinqWalk4CS#2](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqWalk4CS/cs/Form1.cs#2)]"},{"pos":[7847,7918],"content":"Now double-click <bpt id=\"p1\">**</bpt>button2<ept id=\"p1\">**</ept> on <bpt id=\"p2\">**</bpt>Form1<ept id=\"p2\">**</ept> to open the <ph id=\"ph1\">`button2`</ph> handler","source":"Now double-click **button2** on **Form1** to open the `button2` handler"},{"pos":[7928,7979],"content":"Type the following code into the <ph id=\"ph1\">`button2`</ph> handler:","source":"Type the following code into the `button2` handler:"},{"pos":[7990,8107],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DLinqWalk4CS#3<ept id=\"p2\">](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqWalk4CS/cs/Form1.cs#3)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[DLinqWalk4CS#3](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqWalk4CS/cs/Form1.cs#3)]"},{"pos":[8116,8139],"content":"Testing the Application","linkify":"Testing the Application","nodes":[{"content":"Testing the Application","pos":[0,23]}]},{"content":"Now it is time to test your application.","pos":[8143,8183]},{"content":"Note that your contact with the datastore is limited to whatever actions the two stored procedures can take.","pos":[8184,8292]},{"content":"Those actions are to return the products included for any orderID you enter, or to return a history of products ordered for any CustomerID you enter.","pos":[8293,8442]},{"pos":[8453,8476],"content":"To test the application","linkify":"To test the application","nodes":[{"content":"To test the application","pos":[0,23]}]},{"content":"Press F5 to start debugging.","pos":[8486,8514]},{"content":"Form1 appears.","pos":[8525,8539]},{"pos":[8549,8626],"content":"In the <bpt id=\"p1\">**</bpt>Enter OrderID<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`10249`</ph>, and then click <bpt id=\"p2\">**</bpt>Order Details<ept id=\"p2\">**</ept>.","source":"In the **Enter OrderID** box, type `10249`, and then click **Order Details**."},{"content":"A message box lists the products included in order 10249.","pos":[8637,8694]},{"pos":[8705,8743],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to close the message box.","source":"Click **OK** to close the message box."},{"pos":[8753,8833],"content":"In the <bpt id=\"p1\">**</bpt>Enter CustomerID<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`ALFKI`</ph>, and then click <bpt id=\"p2\">**</bpt>Order History<ept id=\"p2\">**</ept>.","source":"In the **Enter CustomerID** box, type `ALFKI`, and then click **Order History**."},{"content":"A message box appears that lists the order history for customer ALFKI.","pos":[8844,8914]},{"pos":[8925,8963],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to close the message box.","source":"Click **OK** to close the message box."},{"pos":[8973,9048],"content":"In the <bpt id=\"p1\">**</bpt>Enter OrderID<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`123`</ph>, and then click <bpt id=\"p2\">**</bpt>Order Details<ept id=\"p2\">**</ept>.","source":"In the **Enter OrderID** box, type `123`, and then click **Order Details**."},{"content":"A message box appears that displays \"No results.\"","pos":[9059,9108]},{"pos":[9119,9157],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to close the message box.","source":"Click **OK** to close the message box."},{"pos":[9167,9215],"content":"On the <bpt id=\"p1\">**</bpt>Debug<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Stop debugging<ept id=\"p2\">**</ept>.","source":"On the **Debug** menu, click **Stop debugging**."},{"content":"The debug session closes.","pos":[9226,9251]},{"pos":[9261,9395],"content":"If you have finished experimenting, you can click <bpt id=\"p1\">**</bpt>Close Project<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu, and save your project when you are prompted.","source":"If you have finished experimenting, you can click **Close Project** on the **File** menu, and save your project when you are prompted."},{"pos":[9404,9414],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"You can enhance this project by making some changes.","pos":[9418,9470]},{"content":"For example, you could list available stored procedures in a list box and have the user select which procedures to execute.","pos":[9471,9594]},{"content":"You could also stream the output of the reports to a text file.","pos":[9595,9658]},{"pos":[9667,9675],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Learning by Walkthroughs<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md)</ept><ph id=\"ph1\"> </ph>","pos":[9679,9789],"source":"[Learning by Walkthroughs](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md) "},{"content":"<bpt id=\"p1\">[</bpt>Stored Procedures<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/stored-procedures.md)</ept>","pos":[9793,9888],"source":"[Stored Procedures](../../../../../../docs/framework/data/adonet/sql/linq/stored-procedures.md)"}]}