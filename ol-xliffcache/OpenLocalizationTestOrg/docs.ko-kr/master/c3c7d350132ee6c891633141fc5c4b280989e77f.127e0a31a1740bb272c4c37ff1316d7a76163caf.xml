{"content":"---\ntitle: \"How to: Write to an Application Event Log (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords:\n  - \"Computer.EventLog element\"\n  - \"WriteEntry method [Visual Basic]\"\n  - \"My.Computer.EventLog element\"\n  - \"event logs, writing to\"\nms.assetid: cadbc8c1-87af-4746-934e-55b79a4f6e2b\n---\n\n# How to: Write to an Application Event Log (Visual Basic)\n\nYou can use the `My.Application.Log` and `My.Log` objects to write information about events that occur in your application. This example shows how to configure an event log listener so `My.Application.Log` writes tracing information to the Application event log.\n\nYou cannot write to the Security log. In order to write to the System log, you must be a member of the LocalSystem or Administrator account.\n\nTo view an event log, you can use **Server Explorer** or **Windows Event Viewer**. For more information, see [ETW Events in the .NET Framework](../../../../framework/performance/etw-events.md).\n\n### To add and configure the event log listener\n\n1. Right-click app.config in **Solution Explorer** and choose **Open**.\n\n    \\- or -\n\n    If there is no app.config file,\n\n    1. On the **Project** menu, choose **Add New Item**.\n\n    2. From the **Add New Item** dialog box, choose **Application Configuration File**.\n\n    3. Click **Add**.\n\n2. Locate the `<listeners>` section in the application configuration file.\n\n    You will find the `<listeners>` section in the `<source>` section with the name attribute \"DefaultSource\", which is nested under the `<system.diagnostics>` section, which is nested under the top-level `<configuration>` section.\n\n3. Add this element to that `<listeners>` section:\n\n    ```xml\n    <add name=\"EventLog\"/>\n    ```\n\n4. Locate the `<sharedListeners>` section, in the `<system.diagnostics>` section, in the top-level `<configuration>` section.\n\n5. Add this element to that `<sharedListeners>` section:\n\n    ```xml\n    <add name=\"EventLog\"\n        type=\"System.Diagnostics.EventLogTraceListener, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\n         initializeData=\"APPLICATION_NAME\"/>\n    ```\n\n    Replace `APPLICATION_NAME` with the name of your application.\n\n    > [!NOTE]\n    > Typically, an application writes only errors to the event log. For information on filtering log output, see [Walkthrough: Filtering My.Application.Log Output](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md).\n\n### To write event information to the event log\n\n- Use the `My.Application.Log.WriteEntry` or `My.Application.Log.WriteException` method to write information to the event log. For more information, see [How to: Write Log Messages](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md) and [How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md).\n\n    After you configure the event log listener for an assembly, it receives all messages that `My.Application.Log` writes from that assembly.\n\n## See also\n\n- <xref:Microsoft.VisualBasic.Logging.Log?displayProperty=nameWithType>\n- <xref:Microsoft.VisualBasic.Logging.Log.WriteEntry%2A>\n- <xref:Microsoft.VisualBasic.Logging.Log.WriteException%2A>\n- [Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)\n- [How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)\n- [Walkthrough: Determining Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)\n","nodes":[{"pos":[4,294],"embed":true,"restype":"x-metadata","content":"title: \"How to: Write to an Application Event Log (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords:\n  - \"Computer.EventLog element\"\n  - \"WriteEntry method [Visual Basic]\"\n  - \"My.Computer.EventLog element\"\n  - \"event logs, writing to\"\nms.assetid: cadbc8c1-87af-4746-934e-55b79a4f6e2b","nodes":[{"content":"How to: Write to an Application Event Log (Visual Basic)","nodes":[{"pos":[0,56],"content":"How to: Write to an Application Event Log (Visual Basic)","nodes":[{"content":"How to: Write to an Application Event Log (Visual Basic)","pos":[0,56]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[302,358],"content":"How to: Write to an Application Event Log (Visual Basic)","linkify":"How to: Write to an Application Event Log (Visual Basic)","nodes":[{"content":"How to: Write to an Application Event Log (Visual Basic)","pos":[0,56]}]},{"content":"You can use the <ph id=\"ph1\">`My.Application.Log`</ph> and <ph id=\"ph2\">`My.Log`</ph> objects to write information about events that occur in your application.","pos":[360,483],"source":"You can use the `My.Application.Log` and `My.Log` objects to write information about events that occur in your application."},{"content":"This example shows how to configure an event log listener so <ph id=\"ph1\">`My.Application.Log`</ph> writes tracing information to the Application event log.","pos":[484,622],"source":" This example shows how to configure an event log listener so `My.Application.Log` writes tracing information to the Application event log."},{"content":"You cannot write to the Security log.","pos":[624,661]},{"content":"In order to write to the System log, you must be a member of the LocalSystem or Administrator account.","pos":[662,764]},{"content":"To view an event log, you can use <bpt id=\"p1\">**</bpt>Server Explorer<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Windows Event Viewer<ept id=\"p2\">**</ept>.","pos":[766,848],"source":"To view an event log, you can use **Server Explorer** or **Windows Event Viewer**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>ETW Events in the .NET Framework<ept id=\"p1\">](../../../../framework/performance/etw-events.md)</ept>.","pos":[849,959],"source":" For more information, see [ETW Events in the .NET Framework](../../../../framework/performance/etw-events.md)."},{"pos":[965,1008],"content":"To add and configure the event log listener","linkify":"To add and configure the event log listener","nodes":[{"content":"To add and configure the event log listener","pos":[0,43]}]},{"pos":[1013,1081],"content":"Right-click app.config in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and choose <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","source":"Right-click app.config in **Solution Explorer** and choose **Open**."},{"content":"<ph id=\"ph1\">\\-</ph> or -","pos":[1087,1094],"source":"\\- or -"},{"content":"If there is no app.config file,","pos":[1100,1131]},{"pos":[1140,1189],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Add New Item<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, choose **Add New Item**."},{"pos":[1198,1278],"content":"From the <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> dialog box, choose <bpt id=\"p2\">**</bpt>Application Configuration File<ept id=\"p2\">**</ept>.","source":"From the **Add New Item** dialog box, choose **Application Configuration File**."},{"pos":[1287,1301],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","source":"Click **Add**."},{"pos":[1306,1377],"content":"Locate the <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section in the application configuration file.","source":"Locate the `<listeners>` section in the application configuration file."},{"pos":[1383,1610],"content":"You will find the <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section in the <ph id=\"ph2\">`&lt;source&gt;`</ph> section with the name attribute \"DefaultSource\", which is nested under the <ph id=\"ph3\">`&lt;system.diagnostics&gt;`</ph> section, which is nested under the top-level <ph id=\"ph4\">`&lt;configuration&gt;`</ph> section.","source":"You will find the `<listeners>` section in the `<source>` section with the name attribute \"DefaultSource\", which is nested under the `<system.diagnostics>` section, which is nested under the top-level `<configuration>` section."},{"pos":[1615,1662],"content":"Add this element to that <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section:","source":"Add this element to that `<listeners>` section:"},{"pos":[1714,1836],"content":"Locate the <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> section, in the <ph id=\"ph2\">`&lt;system.diagnostics&gt;`</ph> section, in the top-level <ph id=\"ph3\">`&lt;configuration&gt;`</ph> section.","source":"Locate the `<sharedListeners>` section, in the `<system.diagnostics>` section, in the top-level `<configuration>` section."},{"pos":[1841,1894],"content":"Add this element to that <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> section:","source":"Add this element to that `<sharedListeners>` section:"},{"pos":[2121,2182],"content":"Replace <ph id=\"ph1\">`APPLICATION_NAME`</ph> with the name of your application.","source":"Replace `APPLICATION_NAME` with the name of your application."},{"pos":[2190,2477],"content":"[!NOTE]\nTypically, an application writes only errors to the event log. For information on filtering log output, see [Walkthrough: Filtering My.Application.Log Output](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md).","leadings":["","    > "],"nodes":[{"content":"Typically, an application writes only errors to the event log. For information on filtering log output, see [Walkthrough: Filtering My.Application.Log Output](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md).","pos":[8,281],"nodes":[{"content":"Typically, an application writes only errors to the event log.","pos":[0,62]},{"content":"For information on filtering log output, see <bpt id=\"p1\">[</bpt>Walkthrough: Filtering My.Application.Log Output<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md)</ept>.","pos":[63,273],"source":" For information on filtering log output, see [Walkthrough: Filtering My.Application.Log Output](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-filtering-my-application-log-output.md)."}]}]},{"pos":[2483,2526],"content":"To write event information to the event log","linkify":"To write event information to the event log","nodes":[{"content":"To write event information to the event log","pos":[0,43]}]},{"content":"Use the <ph id=\"ph1\">`My.Application.Log.WriteEntry`</ph> or <ph id=\"ph2\">`My.Application.Log.WriteException`</ph> method to write information to the event log.","pos":[2530,2654],"source":"Use the `My.Application.Log.WriteEntry` or `My.Application.Log.WriteException` method to write information to the event log."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Write Log Messages<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Log Exceptions<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)</ept>.","pos":[2655,2919],"source":" For more information, see [How to: Write Log Messages](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md) and [How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)."},{"pos":[2925,3062],"content":"After you configure the event log listener for an assembly, it receives all messages that <ph id=\"ph1\">`My.Application.Log`</ph> writes from that assembly.","source":"After you configure the event log listener for an assembly, it receives all messages that `My.Application.Log` writes from that assembly."},{"pos":[3067,3075],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3269,3396],"content":"<bpt id=\"p1\">[</bpt>Working with Application Logs<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)</ept>","source":"[Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)"},{"pos":[3399,3511],"content":"<bpt id=\"p1\">[</bpt>How to: Log Exceptions<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)</ept>","source":"[How to: Log Exceptions](../../../../visual-basic/developing-apps/programming/log-info/how-to-log-exceptions.md)"},{"pos":[3514,3718],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Determining Where My.Application.Log Writes Information<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)</ept>","source":"[Walkthrough: Determining Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)"}]}