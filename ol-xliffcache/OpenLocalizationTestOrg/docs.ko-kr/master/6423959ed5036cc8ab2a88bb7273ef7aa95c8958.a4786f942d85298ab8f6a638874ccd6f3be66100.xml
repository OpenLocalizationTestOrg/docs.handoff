{"content":"---\ntitle: \"How to: Directly Execute SQL Queries\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: e491b9bf-741a-4296-9f51-76c25ddf6a82\n---\n# How to: Directly Execute SQL Queries\n[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] translates the queries you write into parameterized SQL queries (in text form) and sends them to the SQL server for processing.  \n  \n SQL cannot execute the variety of methods that might be locally available to your application. [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] tries to convert these local methods to equivalent operations and functions that are available inside the SQL environment. Most methods and operators on [!INCLUDE[dnprdnshort](../../../../../../includes/dnprdnshort-md.md)] built-in types have direct translations to SQL commands. Some can be produced from the functions that are available. Those that cannot be produced generate run-time exceptions. For more information, see [SQL-CLR Type Mapping](../../../../../../docs/framework/data/adonet/sql/linq/sql-clr-type-mapping.md).  \n  \n In cases where a [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] query is insufficient for a specialized task, you can use the <xref:System.Data.Linq.DataContext.ExecuteQuery%2A> method to execute a SQL query, and then convert the result of your query directly into objects.  \n  \n## Example  \n In the following example, assume that the data for the `Customer` class is spread over two tables (customer1 and customer2). The query returns a sequence of `Customer` objects.  \n  \n [!code-csharp[DLinqQuerying#4](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#4)]\n [!code-vb[DLinqQuerying#4](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#4)]  \n  \n As long as the column names in the tabular results match column properties of your entity class, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] creates your objects out of any SQL query.  \n  \n## Example  \n The <xref:System.Data.Linq.DataContext.ExecuteQuery%2A> method also allows for parameters. Use code such as the following to execute a parameterized query.  \n  \n [!code-csharp[DLinqQuerying#5](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#5)]\n [!code-vb[DLinqQuerying#5](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#5)]  \n  \n The parameters are expressed in the query text by using the same curly notation used by `Console.WriteLine()` and `String.Format()`. In fact, `String.Format()` is actually called on the query string you provide, substituting the curly braced parameters with generated parameter names such as @p0, @p1 …, @p(n).  \n  \n## See also\n\n- [Background Information](../../../../../../docs/framework/data/adonet/sql/linq/background-information.md)\n- [Querying the Database](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)\n","nodes":[{"pos":[4,154],"embed":true,"restype":"x-metadata","content":"title: \"How to: Directly Execute SQL Queries\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: e491b9bf-741a-4296-9f51-76c25ddf6a82","nodes":[{"content":"How to: Directly Execute SQL Queries","nodes":[{"pos":[0,36],"content":"How to: Directly Execute SQL Queries","nodes":[{"content":"How to: Directly Execute SQL Queries","pos":[0,36]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[161,197],"content":"How to: Directly Execute SQL Queries","linkify":"How to: Directly Execute SQL Queries","nodes":[{"content":"How to: Directly Execute SQL Queries","pos":[0,36]}]},{"pos":[198,393],"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> translates the queries you write into parameterized SQL queries (in text form) and sends them to the SQL server for processing.","source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] translates the queries you write into parameterized SQL queries (in text form) and sends them to the SQL server for processing."},{"content":"SQL cannot execute the variety of methods that might be locally available to your application.","pos":[400,494]},{"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> tries to convert these local methods to equivalent operations and functions that are available inside the SQL environment.","pos":[495,685],"source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] tries to convert these local methods to equivalent operations and functions that are available inside the SQL environment."},{"content":"Most methods and operators on <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../../../includes/dnprdnshort-md.md)]</ph> built-in types have direct translations to SQL commands.","pos":[686,842],"source":" Most methods and operators on [!INCLUDE[dnprdnshort](../../../../../../includes/dnprdnshort-md.md)] built-in types have direct translations to SQL commands."},{"content":"Some can be produced from the functions that are available.","pos":[843,902]},{"content":"Those that cannot be produced generate run-time exceptions.","pos":[903,962]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>SQL-CLR Type Mapping<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/sql-clr-type-mapping.md)</ept>.","pos":[963,1091],"source":" For more information, see [SQL-CLR Type Mapping](../../../../../../docs/framework/data/adonet/sql/linq/sql-clr-type-mapping.md)."},{"pos":[1098,1392],"content":"In cases where a <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> query is insufficient for a specialized task, you can use the <ph id=\"ph2\">&lt;xref:System.Data.Linq.DataContext.ExecuteQuery%2A&gt;</ph> method to execute a SQL query, and then convert the result of your query directly into objects.","source":"In cases where a [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] query is insufficient for a specialized task, you can use the <xref:System.Data.Linq.DataContext.ExecuteQuery%2A> method to execute a SQL query, and then convert the result of your query directly into objects."},{"pos":[1401,1408],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In the following example, assume that the data for the <ph id=\"ph1\">`Customer`</ph> class is spread over two tables (customer1 and customer2).","pos":[1412,1536],"source":"In the following example, assume that the data for the `Customer` class is spread over two tables (customer1 and customer2)."},{"content":"The query returns a sequence of <ph id=\"ph1\">`Customer`</ph> objects.","pos":[1537,1588],"source":" The query returns a sequence of `Customer` objects."},{"pos":[1847,2054],"content":"As long as the column names in the tabular results match column properties of your entity class, <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> creates your objects out of any SQL query.","source":"As long as the column names in the tabular results match column properties of your entity class, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] creates your objects out of any SQL query."},{"pos":[2063,2070],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext.ExecuteQuery%2A&gt;</ph> method also allows for parameters.","pos":[2074,2164],"source":"The <xref:System.Data.Linq.DataContext.ExecuteQuery%2A> method also allows for parameters."},{"content":"Use code such as the following to execute a parameterized query.","pos":[2165,2229]},{"content":"The parameters are expressed in the query text by using the same curly notation used by <ph id=\"ph1\">`Console.WriteLine()`</ph> and <ph id=\"ph2\">`String.Format()`</ph>.","pos":[2488,2620],"source":"The parameters are expressed in the query text by using the same curly notation used by `Console.WriteLine()` and `String.Format()`."},{"content":"In fact, <ph id=\"ph1\">`String.Format()`</ph> is actually called on the query string you provide, substituting the curly braced parameters with generated parameter names such as <ph id=\"ph2\">@p0</ph>, <ph id=\"ph3\">@p1</ph> …, <ph id=\"ph4\">@p</ph>(n).","pos":[2621,2798],"source":" In fact, `String.Format()` is actually called on the query string you provide, substituting the curly braced parameters with generated parameter names such as @p0, @p1 …, @p(n)."},{"pos":[2807,2815],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2819,2924],"content":"<bpt id=\"p1\">[</bpt>Background Information<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/background-information.md)</ept>","source":"[Background Information](../../../../../../docs/framework/data/adonet/sql/linq/background-information.md)"},{"pos":[2927,3030],"content":"<bpt id=\"p1\">[</bpt>Querying the Database<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)</ept>","source":"[Querying the Database](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)"}]}