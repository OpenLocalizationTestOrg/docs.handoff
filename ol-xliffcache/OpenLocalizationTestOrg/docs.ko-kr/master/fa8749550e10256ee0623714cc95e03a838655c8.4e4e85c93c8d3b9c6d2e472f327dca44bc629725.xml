{"content":"---\ntitle: \"Viewing Data in a DataTable\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nms.assetid: 1d26e0fb-f6e0-4afa-9a9c-b8d55b8f20dc\n---\n\n# Viewing Data in a DataTable\n\nYou can access the contents of a <xref:System.Data.DataTable> by using the **Rows** and **Columns** collections of the **DataTable**. You can also use the <xref:System.Data.DataTable.Select%2A> method to return subsets of the data in a **DataTable** according to criteria including search criteria, sort order, and row state. Additionally, you can use the <xref:System.Data.DataRowCollection.Find%2A> method of the **DataRowCollection** when searching for a particular row using a primary key value.\n\nThe **Select** method of the **DataTable** object returns a set of <xref:System.Data.DataRow> objects that match the specified criteria. **Select** takes optional arguments of a filter expression, sort expression, and **DataViewRowState**. The filter expression identifies which rows to return based on **DataColumn** values, such as `LastName = 'Smith'`. The sort expression follows standard SQL conventions for ordering columns, for example `LastName ASC, FirstName ASC`. For rules about writing expressions, see the <xref:System.Data.DataColumn.Expression%2A> property of the **DataColumn** class.\n\n> [!TIP]\n> If you are performing a number of calls to the **Select** method of a **DataTable**, you can increase performance by first creating a <xref:System.Data.DataView> for the **DataTable**. Creating the **DataView** indexes the rows of the table. The **Select** method then uses that index, significantly reducing the time to generate the query result. For information about creating a **DataView** for a **DataTable**, see [DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataviews.md).\n\nThe **Select** method determines which version of the rows to view or manipulate based on a <xref:System.Data.DataViewRowState>. The following table describes the possible **DataViewRowState** enumeration values.\n\n|DataViewRowState value|Description|\n|----------------------------|-----------------|\n|**CurrentRows**|Current rows including unchanged, added, and modified rows.|\n|**Deleted**|A deleted row.|\n|**ModifiedCurrent**|A current version, which is a modified version of original data. (See **ModifiedOriginal**.)|\n|**ModifiedOriginal**|The original version of all modified rows. The current version is available using **ModifiedCurrent**.|\n|**Added**|A new row.|\n|**None**|None.|\n|**OriginalRows**|Original rows, including unchanged and deleted rows.|\n|**Unchanged**|An unchanged row.|\n\nIn the following example, the **DataSet** object is filtered so that you are only working with rows whose **DataViewRowState** is set to **CurrentRows**.\n\n```vb\nDim column As DataColumn\nDim row As DataRow\n\nDim currentRows() As DataRow = _\n    workTable.Select(Nothing, Nothing, DataViewRowState.CurrentRows)\n\nIf (currentRows.Length < 1 ) Then\n  Console.WriteLine(\"No Current Rows Found\")\nElse\n  For Each column in workTable.Columns\n    Console.Write(vbTab & column.ColumnName)\n  Next\n\n  Console.WriteLine(vbTab & \"RowState\")\n\n  For Each row In currentRows\n    For Each column In workTable.Columns\n      Console.Write(vbTab & row(column).ToString())\n    Next\n\n    Dim rowState As String = _\n        System.Enum.GetName(row.RowState.GetType(), row.RowState)\n    Console.WriteLine(vbTab & rowState)\n  Next\nEnd If\n```\n\n```csharp\nDataRow[] currentRows = workTable.Select(\n    null, null, DataViewRowState.CurrentRows);\n\nif (currentRows.Length < 1 )\n  Console.WriteLine(\"No Current Rows Found\");\nelse\n{\n  foreach (DataColumn column in workTable.Columns)\n    Console.Write(\"\\t{0}\", column.ColumnName);\n\n  Console.WriteLine(\"\\tRowState\");\n\n  foreach (DataRow row in currentRows)\n  {\n    foreach (DataColumn column in workTable.Columns)\n      Console.Write(\"\\t{0}\", row[column]);\n\n    Console.WriteLine(\"\\t\" + row.RowState);\n  }\n}\n```\n\nThe **Select** method can be used to return rows with differing **RowState** values or field values. The following example returns a **DataRow** array that references all rows that have been deleted, and returns another **DataRow** array that references all rows, ordered by **CustLName**, where the **CustID** column is greater than 5. For information about how to view the information in the **Deleted** row, see [Row States and Row Versions](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md).\n\n```vb\n' Retrieve all deleted rows.\nDim deletedRows() As DataRow = workTable.Select(Nothing, Nothing, DataViewRowState.Deleted)\n\n' Retrieve rows where CustID > 5, and order by CustLName.\nDim custRows() As DataRow = workTable.Select( _\n    \"CustID > 5\", \"CustLName ASC\")\n```\n\n```csharp\n// Retrieve all deleted rows.\nDataRow[] deletedRows = workTable.Select(\n    null, null, DataViewRowState.Deleted);\n\n// Retrieve rows where CustID > 5, and order by CustLName.\nDataRow[] custRows = workTable.Select(\"CustID > 5\", \"CustLName ASC\");\n```\n\n## See also\n\n- <xref:System.Data.DataRow>\n- <xref:System.Data.DataSet>\n- <xref:System.Data.DataTable>\n- <xref:System.Data.DataViewRowState>\n- [Manipulating Data in a DataTable](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/manipulating-data-in-a-datatable.md)\n- [Row States and Row Versions](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,144],"embed":true,"restype":"x-metadata","content":"title: \"Viewing Data in a DataTable\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nms.assetid: 1d26e0fb-f6e0-4afa-9a9c-b8d55b8f20dc","nodes":[{"content":"Viewing Data in a DataTable","nodes":[{"pos":[0,27],"content":"Viewing Data in a DataTable","nodes":[{"content":"Viewing Data in a DataTable","pos":[0,27]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[152,179],"content":"Viewing Data in a DataTable","linkify":"Viewing Data in a DataTable","nodes":[{"content":"Viewing Data in a DataTable","pos":[0,27]}]},{"content":"You can access the contents of a <ph id=\"ph1\">&lt;xref:System.Data.DataTable&gt;</ph> by using the <bpt id=\"p1\">**</bpt>Rows<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Columns<ept id=\"p2\">**</ept> collections of the <bpt id=\"p3\">**</bpt>DataTable<ept id=\"p3\">**</ept>.","pos":[181,314],"source":"You can access the contents of a <xref:System.Data.DataTable> by using the **Rows** and **Columns** collections of the **DataTable**."},{"content":"You can also use the <ph id=\"ph1\">&lt;xref:System.Data.DataTable.Select%2A&gt;</ph> method to return subsets of the data in a <bpt id=\"p1\">**</bpt>DataTable<ept id=\"p1\">**</ept> according to criteria including search criteria, sort order, and row state.","pos":[315,506],"source":" You can also use the <xref:System.Data.DataTable.Select%2A> method to return subsets of the data in a **DataTable** according to criteria including search criteria, sort order, and row state."},{"content":"Additionally, you can use the <ph id=\"ph1\">&lt;xref:System.Data.DataRowCollection.Find%2A&gt;</ph> method of the <bpt id=\"p1\">**</bpt>DataRowCollection<ept id=\"p1\">**</ept> when searching for a particular row using a primary key value.","pos":[507,680],"source":" Additionally, you can use the <xref:System.Data.DataRowCollection.Find%2A> method of the **DataRowCollection** when searching for a particular row using a primary key value."},{"content":"The <bpt id=\"p1\">**</bpt>Select<ept id=\"p1\">**</ept> method of the <bpt id=\"p2\">**</bpt>DataTable<ept id=\"p2\">**</ept> object returns a set of <ph id=\"ph1\">&lt;xref:System.Data.DataRow&gt;</ph> objects that match the specified criteria.","pos":[682,818],"source":"The **Select** method of the **DataTable** object returns a set of <xref:System.Data.DataRow> objects that match the specified criteria."},{"content":"<bpt id=\"p1\">**</bpt>Select<ept id=\"p1\">**</ept> takes optional arguments of a filter expression, sort expression, and <bpt id=\"p2\">**</bpt>DataViewRowState<ept id=\"p2\">**</ept>.","pos":[819,921],"source":"**Select** takes optional arguments of a filter expression, sort expression, and **DataViewRowState**."},{"content":"The filter expression identifies which rows to return based on <bpt id=\"p1\">**</bpt>DataColumn<ept id=\"p1\">**</ept> values, such as <ph id=\"ph1\">`LastName = 'Smith'`</ph>.","pos":[922,1037],"source":" The filter expression identifies which rows to return based on **DataColumn** values, such as `LastName = 'Smith'`."},{"content":"The sort expression follows standard SQL conventions for ordering columns, for example <ph id=\"ph1\">`LastName ASC, FirstName ASC`</ph>.","pos":[1038,1155],"source":" The sort expression follows standard SQL conventions for ordering columns, for example `LastName ASC, FirstName ASC`."},{"content":"For rules about writing expressions, see the <ph id=\"ph1\">&lt;xref:System.Data.DataColumn.Expression%2A&gt;</ph> property of the <bpt id=\"p1\">**</bpt>DataColumn<ept id=\"p1\">**</ept> class.","pos":[1156,1282],"source":" For rules about writing expressions, see the <xref:System.Data.DataColumn.Expression%2A> property of the **DataColumn** class."},{"pos":[1286,1809],"content":"[!TIP]\nIf you are performing a number of calls to the **Select** method of a **DataTable**, you can increase performance by first creating a <xref:System.Data.DataView> for the **DataTable**. Creating the **DataView** indexes the rows of the table. The **Select** method then uses that index, significantly reducing the time to generate the query result. For information about creating a **DataView** for a **DataTable**, see [DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataviews.md).","leadings":["","> "],"nodes":[{"content":"If you are performing a number of calls to the **Select** method of a **DataTable**, you can increase performance by first creating a <xref:System.Data.DataView> for the **DataTable**. Creating the **DataView** indexes the rows of the table. The **Select** method then uses that index, significantly reducing the time to generate the query result. For information about creating a **DataView** for a **DataTable**, see [DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataviews.md).","pos":[7,521],"nodes":[{"content":"If you are performing a number of calls to the <bpt id=\"p1\">**</bpt>Select<ept id=\"p1\">**</ept> method of a <bpt id=\"p2\">**</bpt>DataTable<ept id=\"p2\">**</ept>, you can increase performance by first creating a <ph id=\"ph1\">&lt;xref:System.Data.DataView&gt;</ph> for the <bpt id=\"p3\">**</bpt>DataTable<ept id=\"p3\">**</ept>.","pos":[0,184],"source":"If you are performing a number of calls to the **Select** method of a **DataTable**, you can increase performance by first creating a <xref:System.Data.DataView> for the **DataTable**."},{"content":"Creating the <bpt id=\"p1\">**</bpt>DataView<ept id=\"p1\">**</ept> indexes the rows of the table.","pos":[185,241],"source":" Creating the **DataView** indexes the rows of the table."},{"content":"The <bpt id=\"p1\">**</bpt>Select<ept id=\"p1\">**</ept> method then uses that index, significantly reducing the time to generate the query result.","pos":[242,347],"source":" The **Select** method then uses that index, significantly reducing the time to generate the query result."},{"content":"For information about creating a <bpt id=\"p1\">**</bpt>DataView<ept id=\"p1\">**</ept> for a <bpt id=\"p2\">**</bpt>DataTable<ept id=\"p2\">**</ept>, see <bpt id=\"p3\">[</bpt>DataViews<ept id=\"p3\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataviews.md)</ept>.","pos":[348,514],"source":" For information about creating a **DataView** for a **DataTable**, see [DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataviews.md)."}]}]},{"content":"The <bpt id=\"p1\">**</bpt>Select<ept id=\"p1\">**</ept> method determines which version of the rows to view or manipulate based on a <ph id=\"ph1\">&lt;xref:System.Data.DataViewRowState&gt;</ph>.","pos":[1811,1939],"source":"The **Select** method determines which version of the rows to view or manipulate based on a <xref:System.Data.DataViewRowState>."},{"content":"The following table describes the possible <bpt id=\"p1\">**</bpt>DataViewRowState<ept id=\"p1\">**</ept> enumeration values.","pos":[1940,2023],"source":" The following table describes the possible **DataViewRowState** enumeration values."},{"content":"DataViewRowState value","pos":[2026,2048]},{"content":"Description","pos":[2049,2060]},{"pos":[2112,2127],"content":"<bpt id=\"p1\">**</bpt>CurrentRows<ept id=\"p1\">**</ept>","source":"**CurrentRows**"},{"content":"Current rows including unchanged, added, and modified rows.","pos":[2128,2187]},{"pos":[2190,2201],"content":"<bpt id=\"p1\">**</bpt>Deleted<ept id=\"p1\">**</ept>","source":"**Deleted**"},{"content":"A deleted row.","pos":[2202,2216]},{"pos":[2219,2238],"content":"<bpt id=\"p1\">**</bpt>ModifiedCurrent<ept id=\"p1\">**</ept>","source":"**ModifiedCurrent**"},{"content":"A current version, which is a modified version of original data.","pos":[2239,2303]},{"content":"(See <bpt id=\"p1\">**</bpt>ModifiedOriginal<ept id=\"p1\">**</ept>.)","pos":[2304,2331],"source":" (See **ModifiedOriginal**.)"},{"pos":[2334,2354],"content":"<bpt id=\"p1\">**</bpt>ModifiedOriginal<ept id=\"p1\">**</ept>","source":"**ModifiedOriginal**"},{"content":"The original version of all modified rows.","pos":[2355,2397]},{"content":"The current version is available using <bpt id=\"p1\">**</bpt>ModifiedCurrent<ept id=\"p1\">**</ept>.","pos":[2398,2457],"source":" The current version is available using **ModifiedCurrent**."},{"pos":[2460,2469],"content":"<bpt id=\"p1\">**</bpt>Added<ept id=\"p1\">**</ept>","source":"**Added**"},{"content":"A new row.","pos":[2470,2480]},{"pos":[2483,2491],"content":"<bpt id=\"p1\">**</bpt>None<ept id=\"p1\">**</ept>","source":"**None**"},{"content":"None.","pos":[2492,2497]},{"pos":[2500,2516],"content":"<bpt id=\"p1\">**</bpt>OriginalRows<ept id=\"p1\">**</ept>","source":"**OriginalRows**"},{"content":"Original rows, including unchanged and deleted rows.","pos":[2517,2569]},{"pos":[2572,2585],"content":"<bpt id=\"p1\">**</bpt>Unchanged<ept id=\"p1\">**</ept>","source":"**Unchanged**"},{"content":"An unchanged row.","pos":[2586,2603]},{"pos":[2606,2759],"content":"In the following example, the <bpt id=\"p1\">**</bpt>DataSet<ept id=\"p1\">**</ept> object is filtered so that you are only working with rows whose <bpt id=\"p2\">**</bpt>DataViewRowState<ept id=\"p2\">**</ept> is set to <bpt id=\"p3\">**</bpt>CurrentRows<ept id=\"p3\">**</ept>.","source":"In the following example, the **DataSet** object is filtered so that you are only working with rows whose **DataViewRowState** is set to **CurrentRows**."},{"content":"The <bpt id=\"p1\">**</bpt>Select<ept id=\"p1\">**</ept> method can be used to return rows with differing <bpt id=\"p2\">**</bpt>RowState<ept id=\"p2\">**</ept> values or field values.","pos":[3933,4033],"source":"The **Select** method can be used to return rows with differing **RowState** values or field values."},{"content":"The following example returns a <bpt id=\"p1\">**</bpt>DataRow<ept id=\"p1\">**</ept> array that references all rows that have been deleted, and returns another <bpt id=\"p2\">**</bpt>DataRow<ept id=\"p2\">**</ept> array that references all rows, ordered by <bpt id=\"p3\">**</bpt>CustLName<ept id=\"p3\">**</ept>, where the <bpt id=\"p4\">**</bpt>CustID<ept id=\"p4\">**</ept> column is greater than 5.","pos":[4034,4269],"source":" The following example returns a **DataRow** array that references all rows that have been deleted, and returns another **DataRow** array that references all rows, ordered by **CustLName**, where the **CustID** column is greater than 5."},{"content":"For information about how to view the information in the <bpt id=\"p1\">**</bpt>Deleted<ept id=\"p1\">**</ept> row, see <bpt id=\"p2\">[</bpt>Row States and Row Versions<ept id=\"p2\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)</ept>.","pos":[4270,4479],"source":" For information about how to view the information in the **Deleted** row, see [Row States and Row Versions](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)."},{"pos":[5018,5026],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5157,5297],"content":"<bpt id=\"p1\">[</bpt>Manipulating Data in a DataTable<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/manipulating-data-in-a-datatable.md)</ept>","source":"[Manipulating Data in a DataTable](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/manipulating-data-in-a-datatable.md)"},{"pos":[5300,5430],"content":"<bpt id=\"p1\">[</bpt>Row States and Row Versions<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)</ept>","source":"[Row States and Row Versions](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)"},{"pos":[5433,5537],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}