{"content":"---\ntitle: Perform inner joins (LINQ in C#)\ndescription: Learn how to perform inner joins using LINQ in C#.\nms.date: 12/01/2016\nms.assetid: 45bceed6-f549-4114-a9b1-b44feb497742\n---\n# Perform inner joins\n\nIn relational database terms, an *inner join* produces a result set in which each element of the first collection appears one time for every matching element in the second collection. If an element in the first collection has no matching elements, it does not appear in the result set. The <xref:System.Linq.Enumerable.Join%2A> method, which is called by the `join` clause in C#, implements an inner join.\n\nThis article shows you how to perform four variations of an inner join:\n\n- A simple inner join that correlates elements from two data sources based on a simple key.\n\n- An inner join that correlates elements from two data sources based on a *composite* key. A composite key, which is a key that consists of more than one value, enables you to correlate elements based on more than one property.\n\n- A *multiple join* in which successive join operations are appended to each other.\n\n- An inner join that is implemented by using a group join.\n\n## Example - Simple key join\n\nThe following example creates two collections that contain objects of two user-defined types, `Person` and `Pet`. The query uses the `join` clause in C# to match `Person` objects with `Pet` objects whose `Owner` is that `Person`. The `select` clause in C# defines how the resulting objects will look. In this example the resulting objects are anonymous types that consist of the owner's first name and the pet's name.\n\n[!code-csharp[CsLINQProgJoining#1](~/samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_1.cs)]\n\nNote that the `Person` object whose `LastName` is \"Huff\" does not appear in the result set because there is no `Pet` object that has `Pet.Owner` equal to that `Person`.\n\n## Example - Composite key join\n\nInstead of correlating elements based on just one property, you can use a composite key to compare elements based on multiple properties. To do this, specify the key selector function for each collection to return an anonymous type that consists of the properties you want to compare. If you label the properties, they must have the same label in each key's anonymous type. The properties must also appear in the same order.\n\nThe following example uses a list of `Employee` objects and a list of `Student` objects to determine which employees are also students. Both of these types have a `FirstName` and a `LastName` property of type <xref:System.String>. The functions that create the join keys from each list's elements return an anonymous type that consists of the `FirstName` and `LastName` properties of each element. The join operation compares these composite keys for equality and returns pairs of objects from each list where both the first name and the last name match.\n\n[!code-csharp[CsLINQProgJoining#2](~/samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_2.cs)]\n\n## Example - Multiple join\n\nAny number of join operations can be appended to each other to perform a multiple join. Each `join` clause in C# correlates a specified data source with the results of the previous join.\n\nThe following example creates three collections: a list of `Person` objects, a list of `Cat` objects, and a list of `Dog` objects.\n\nThe first `join` clause in C# matches people and cats based on a `Person` object matching `Cat.Owner`. It returns a sequence of anonymous types that contain the `Person` object and `Cat.Name`.\n\nThe second `join` clause in C# correlates the anonymous types returned by the first join with `Dog` objects in the supplied list of dogs, based on a composite key that consists of the `Owner` property of type `Person`, and the first letter of the animal's name. It returns a sequence of anonymous types that contain the `Cat.Name` and `Dog.Name` properties from each matching pair. Because this is an inner join, only those objects from the first data source that have a match in the second data source are returned.\n\n[!code-csharp[CsLINQProgJoining#3](~/samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_3.cs)]\n\n## Example - Inner join by using grouped join\n\nThe following example shows you how to implement an inner join by using a group join.\n\nIn `query1`, the list of `Person` objects is group-joined to the list of `Pet` objects based on the `Person` matching the `Pet.Owner` property. The group join creates a collection of intermediate groups, where each group consists of a `Person` object and a sequence of matching `Pet` objects.\n\nBy adding a second `from` clause to the query, this sequence of sequences is combined (or flattened) into one longer sequence. The type of the elements of the final sequence is specified by the `select` clause. In this example, that type is an anonymous type that consists of the `Person.FirstName` and `Pet.Name` properties for each matching pair.\n\nThe result of `query1` is equivalent to the result set that would have been obtained by using the `join` clause without the `into` clause to perform an inner join. The `query2` variable demonstrates this equivalent query.\n\n[!code-csharp[CsLINQProgJoining#4](~/samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_4.cs)]\n\n## See also\n\n- <xref:System.Linq.Enumerable.Join%2A>\n- <xref:System.Linq.Enumerable.GroupJoin%2A>\n- [Perform grouped joins](perform-grouped-joins.md)\n- [Perform left outer joins](perform-left-outer-joins.md)\n- [Anonymous types](../programming-guide/classes-and-structs/anonymous-types.md)\n","nodes":[{"pos":[4,176],"embed":true,"restype":"x-metadata","content":"title: Perform inner joins (LINQ in C#)\ndescription: Learn how to perform inner joins using LINQ in C#.\nms.date: 12/01/2016\nms.assetid: 45bceed6-f549-4114-a9b1-b44feb497742","nodes":[{"content":"Perform inner joins (LINQ in C#)","nodes":[{"pos":[0,32],"content":"Perform inner joins (LINQ in C#)","nodes":[{"content":"Perform inner joins (LINQ in C#)","pos":[0,32]}]}],"path":["title"],"nosxs":false},{"content":"Learn how to perform inner joins using LINQ in C#.","nodes":[{"pos":[0,50],"content":"Learn how to perform inner joins using LINQ in C#.","nodes":[{"content":"Learn how to perform inner joins using LINQ in C#.","pos":[0,50]}]}],"path":["description"],"nosxs":false}],"yml":true},{"pos":[183,202],"content":"Perform inner joins","linkify":"Perform inner joins","nodes":[{"content":"Perform inner joins","pos":[0,19]}]},{"content":"In relational database terms, an <bpt id=\"p1\">*</bpt>inner join<ept id=\"p1\">*</ept> produces a result set in which each element of the first collection appears one time for every matching element in the second collection.","pos":[204,387],"source":"In relational database terms, an *inner join* produces a result set in which each element of the first collection appears one time for every matching element in the second collection."},{"content":"If an element in the first collection has no matching elements, it does not appear in the result set.","pos":[388,489]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Join%2A&gt;</ph> method, which is called by the <ph id=\"ph2\">`join`</ph> clause in C#, implements an inner join.","pos":[490,609],"source":" The <xref:System.Linq.Enumerable.Join%2A> method, which is called by the `join` clause in C#, implements an inner join."},{"content":"This article shows you how to perform four variations of an inner join:","pos":[611,682]},{"content":"A simple inner join that correlates elements from two data sources based on a simple key.","pos":[686,775]},{"content":"An inner join that correlates elements from two data sources based on a <bpt id=\"p1\">*</bpt>composite<ept id=\"p1\">*</ept> key.","pos":[779,867],"source":"An inner join that correlates elements from two data sources based on a *composite* key."},{"content":"A composite key, which is a key that consists of more than one value, enables you to correlate elements based on more than one property.","pos":[868,1004]},{"pos":[1008,1089],"content":"A <bpt id=\"p1\">*</bpt>multiple join<ept id=\"p1\">*</ept> in which successive join operations are appended to each other.","source":"A *multiple join* in which successive join operations are appended to each other."},{"content":"An inner join that is implemented by using a group join.","pos":[1093,1149]},{"pos":[1154,1179],"content":"Example - Simple key join","linkify":"Example - Simple key join","nodes":[{"content":"Example - Simple key join","pos":[0,25]}]},{"content":"The following example creates two collections that contain objects of two user-defined types, <ph id=\"ph1\">`Person`</ph> and <ph id=\"ph2\">`Pet`</ph>.","pos":[1181,1294],"source":"The following example creates two collections that contain objects of two user-defined types, `Person` and `Pet`."},{"content":"The query uses the <ph id=\"ph1\">`join`</ph> clause in C# to match <ph id=\"ph2\">`Person`</ph> objects with <ph id=\"ph3\">`Pet`</ph> objects whose <ph id=\"ph4\">`Owner`</ph> is that <ph id=\"ph5\">`Person`</ph>.","pos":[1295,1410],"source":" The query uses the `join` clause in C# to match `Person` objects with `Pet` objects whose `Owner` is that `Person`."},{"content":"The <ph id=\"ph1\">`select`</ph> clause in C# defines how the resulting objects will look.","pos":[1411,1481],"source":" The `select` clause in C# defines how the resulting objects will look."},{"content":"In this example the resulting objects are anonymous types that consist of the owner's first name and the pet's name.","pos":[1482,1598]},{"pos":[1710,1878],"content":"Note that the <ph id=\"ph1\">`Person`</ph> object whose <ph id=\"ph2\">`LastName`</ph> is \"Huff\" does not appear in the result set because there is no <ph id=\"ph3\">`Pet`</ph> object that has <ph id=\"ph4\">`Pet.Owner`</ph> equal to that <ph id=\"ph5\">`Person`</ph>.","source":"Note that the `Person` object whose `LastName` is \"Huff\" does not appear in the result set because there is no `Pet` object that has `Pet.Owner` equal to that `Person`."},{"pos":[1883,1911],"content":"Example - Composite key join","linkify":"Example - Composite key join","nodes":[{"content":"Example - Composite key join","pos":[0,28]}]},{"content":"Instead of correlating elements based on just one property, you can use a composite key to compare elements based on multiple properties.","pos":[1913,2050]},{"content":"To do this, specify the key selector function for each collection to return an anonymous type that consists of the properties you want to compare.","pos":[2051,2197]},{"content":"If you label the properties, they must have the same label in each key's anonymous type.","pos":[2198,2286]},{"content":"The properties must also appear in the same order.","pos":[2287,2337]},{"content":"The following example uses a list of <ph id=\"ph1\">`Employee`</ph> objects and a list of <ph id=\"ph2\">`Student`</ph> objects to determine which employees are also students.","pos":[2339,2474],"source":"The following example uses a list of `Employee` objects and a list of `Student` objects to determine which employees are also students."},{"content":"Both of these types have a <ph id=\"ph1\">`FirstName`</ph> and a <ph id=\"ph2\">`LastName`</ph> property of type <ph id=\"ph3\">&lt;xref:System.String&gt;</ph>.","pos":[2475,2569],"source":" Both of these types have a `FirstName` and a `LastName` property of type <xref:System.String>."},{"content":"The functions that create the join keys from each list's elements return an anonymous type that consists of the <ph id=\"ph1\">`FirstName`</ph> and <ph id=\"ph2\">`LastName`</ph> properties of each element.","pos":[2570,2736],"source":" The functions that create the join keys from each list's elements return an anonymous type that consists of the `FirstName` and `LastName` properties of each element."},{"content":"The join operation compares these composite keys for equality and returns pairs of objects from each list where both the first name and the last name match.","pos":[2737,2893]},{"pos":[3008,3031],"content":"Example - Multiple join","linkify":"Example - Multiple join","nodes":[{"content":"Example - Multiple join","pos":[0,23]}]},{"content":"Any number of join operations can be appended to each other to perform a multiple join.","pos":[3033,3120]},{"content":"Each <ph id=\"ph1\">`join`</ph> clause in C# correlates a specified data source with the results of the previous join.","pos":[3121,3219],"source":" Each `join` clause in C# correlates a specified data source with the results of the previous join."},{"pos":[3221,3351],"content":"The following example creates three collections: a list of <ph id=\"ph1\">`Person`</ph> objects, a list of <ph id=\"ph2\">`Cat`</ph> objects, and a list of <ph id=\"ph3\">`Dog`</ph> objects.","source":"The following example creates three collections: a list of `Person` objects, a list of `Cat` objects, and a list of `Dog` objects."},{"content":"The first <ph id=\"ph1\">`join`</ph> clause in C# matches people and cats based on a <ph id=\"ph2\">`Person`</ph> object matching <ph id=\"ph3\">`Cat.Owner`</ph>.","pos":[3353,3455],"source":"The first `join` clause in C# matches people and cats based on a `Person` object matching `Cat.Owner`."},{"content":"It returns a sequence of anonymous types that contain the <ph id=\"ph1\">`Person`</ph> object and <ph id=\"ph2\">`Cat.Name`</ph>.","pos":[3456,3545],"source":" It returns a sequence of anonymous types that contain the `Person` object and `Cat.Name`."},{"content":"The second <ph id=\"ph1\">`join`</ph> clause in C# correlates the anonymous types returned by the first join with <ph id=\"ph2\">`Dog`</ph> objects in the supplied list of dogs, based on a composite key that consists of the <ph id=\"ph3\">`Owner`</ph> property of type <ph id=\"ph4\">`Person`</ph>, and the first letter of the animal's name.","pos":[3547,3808],"source":"The second `join` clause in C# correlates the anonymous types returned by the first join with `Dog` objects in the supplied list of dogs, based on a composite key that consists of the `Owner` property of type `Person`, and the first letter of the animal's name."},{"content":"It returns a sequence of anonymous types that contain the <ph id=\"ph1\">`Cat.Name`</ph> and <ph id=\"ph2\">`Dog.Name`</ph> properties from each matching pair.","pos":[3809,3928],"source":" It returns a sequence of anonymous types that contain the `Cat.Name` and `Dog.Name` properties from each matching pair."},{"content":"Because this is an inner join, only those objects from the first data source that have a match in the second data source are returned.","pos":[3929,4063]},{"pos":[4178,4220],"content":"Example - Inner join by using grouped join","linkify":"Example - Inner join by using grouped join","nodes":[{"content":"Example - Inner join by using grouped join","pos":[0,42]}]},{"content":"The following example shows you how to implement an inner join by using a group join.","pos":[4222,4307]},{"content":"In <ph id=\"ph1\">`query1`</ph>, the list of <ph id=\"ph2\">`Person`</ph> objects is group-joined to the list of <ph id=\"ph3\">`Pet`</ph> objects based on the <ph id=\"ph4\">`Person`</ph> matching the <ph id=\"ph5\">`Pet.Owner`</ph> property.","pos":[4309,4452],"source":"In `query1`, the list of `Person` objects is group-joined to the list of `Pet` objects based on the `Person` matching the `Pet.Owner` property."},{"content":"The group join creates a collection of intermediate groups, where each group consists of a <ph id=\"ph1\">`Person`</ph> object and a sequence of matching <ph id=\"ph2\">`Pet`</ph> objects.","pos":[4453,4601],"source":" The group join creates a collection of intermediate groups, where each group consists of a `Person` object and a sequence of matching `Pet` objects."},{"content":"By adding a second <ph id=\"ph1\">`from`</ph> clause to the query, this sequence of sequences is combined (or flattened) into one longer sequence.","pos":[4603,4729],"source":"By adding a second `from` clause to the query, this sequence of sequences is combined (or flattened) into one longer sequence."},{"content":"The type of the elements of the final sequence is specified by the <ph id=\"ph1\">`select`</ph> clause.","pos":[4730,4813],"source":" The type of the elements of the final sequence is specified by the `select` clause."},{"content":"In this example, that type is an anonymous type that consists of the <ph id=\"ph1\">`Person.FirstName`</ph> and <ph id=\"ph2\">`Pet.Name`</ph> properties for each matching pair.","pos":[4814,4951],"source":" In this example, that type is an anonymous type that consists of the `Person.FirstName` and `Pet.Name` properties for each matching pair."},{"content":"The result of <ph id=\"ph1\">`query1`</ph> is equivalent to the result set that would have been obtained by using the <ph id=\"ph2\">`join`</ph> clause without the <ph id=\"ph3\">`into`</ph> clause to perform an inner join.","pos":[4953,5116],"source":"The result of `query1` is equivalent to the result set that would have been obtained by using the `join` clause without the `into` clause to perform an inner join."},{"content":"The <ph id=\"ph1\">`query2`</ph> variable demonstrates this equivalent query.","pos":[5117,5174],"source":" The `query2` variable demonstrates this equivalent query."},{"pos":[5289,5297],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5386,5435],"content":"<bpt id=\"p1\">[</bpt>Perform grouped joins<ept id=\"p1\">](perform-grouped-joins.md)</ept>","source":"[Perform grouped joins](perform-grouped-joins.md)"},{"pos":[5438,5493],"content":"<bpt id=\"p1\">[</bpt>Perform left outer joins<ept id=\"p1\">](perform-left-outer-joins.md)</ept>","source":"[Perform left outer joins](perform-left-outer-joins.md)"},{"pos":[5496,5574],"content":"<bpt id=\"p1\">[</bpt>Anonymous types<ept id=\"p1\">](../programming-guide/classes-and-structs/anonymous-types.md)</ept>","source":"[Anonymous types](../programming-guide/classes-and-structs/anonymous-types.md)"}]}