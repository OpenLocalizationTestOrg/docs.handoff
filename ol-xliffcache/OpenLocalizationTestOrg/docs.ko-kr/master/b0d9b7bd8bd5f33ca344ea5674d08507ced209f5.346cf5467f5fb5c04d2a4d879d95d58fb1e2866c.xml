{"content":"---\ntitle: \"Partial Trust Feature Compatibility\"\nms.date: \"03/30/2017\"\nms.assetid: a36a540b-1606-4e63-88e0-b7c59e0e6ab7\n---\n# Partial Trust Feature Compatibility\nWindows Communication Foundation (WCF) supports a limited subset of functionality when running in a partially-trusted environment. The features supported in partial trust are designed around a specific set of scenarios as described in the [Supported Deployment Scenarios](../../../../docs/framework/wcf/feature-details/supported-deployment-scenarios.md) topic.  \n  \n## Minimum Permission Requirements  \n WCF supports a subset of features in applications running under either of the following standard named permission sets:  \n  \n-   Medium Trust permissions  \n  \n-   Internet Zone permissions  \n  \n Attempting to use WCF in partially-trusted applications with more restrictive permissions may result in security exceptions at runtime.  \n  \n## Contracts  \n Contracts are subject to the following restrictions when running under partial trust:  \n  \n-   The service class that implements the `[ServiceContract]` interface must be `public` and have a `public` constructor. If it defines `[OperationContract]` methods, these must be `public`. If it instead implements a `[ServiceContract]` interface, those method implementations can be explicit or `private`, provided that the `[ServiceContract]` interface is `public`.  \n  \n-   When using the `[ServiceKnownType]` attribute, the method specified must be `public`.  \n  \n-   `[MessageContract]` classes and their members can be `public`. If the `[MessageContract]` class is defined in the application assembly it can be `internal` and have `internal` members.  \n  \n## System-Provided Bindings  \n The <xref:System.ServiceModel.BasicHttpBinding> and <xref:System.ServiceModel.WebHttpBinding> are fully supported in a partial trust environment. The <xref:System.ServiceModel.WSHttpBinding> is supported for Transport security mode only.  \n  \n Bindings that use transports other than HTTP, such as the <xref:System.ServiceModel.NetTcpBinding>, the <xref:System.ServiceModel.NetNamedPipeBinding>, or the <xref:System.ServiceModel.NetMsmqBinding>, are not supported when running in a partial trust environment.  \n  \n## Custom Bindings  \n Custom bindings can be created and used in a partial trust environment, but must follow the restrictions specified in this section.  \n  \n### Transports  \n The only allowed transport binding elements are <xref:System.ServiceModel.Channels.HttpTransportBindingElement> and <xref:System.ServiceModel.Channels.HttpsTransportBindingElement>.  \n  \n### Encoders  \n The following encoders are allowed:  \n  \n-   The text encoder (<xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>).  \n  \n-   The binary encoder (<xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>).  \n  \n-   The Web Message encoder (<xref:System.ServiceModel.Channels.WebMessageEncodingBindingElement>).  \n  \n The Message Transmission Optimization Mechanism (MTOM) encoders are not supported.  \n  \n### Security  \n Partially-trusted applications can use WCF's transport-level security features for securing their communication. Message-level security is not supported. Configuring a binding to use message-level security results in an exception at runtime.  \n  \n### Unsupported Bindings  \n Bindings that use reliable messaging, transactions, or message-level security are not supported.  \n  \n## Serialization  \n Both the <xref:System.Runtime.Serialization.DataContractSerializer> and the <xref:System.Xml.Serialization.XmlSerializer> are supported in a partial trust environment. However, use of the <xref:System.Runtime.Serialization.DataContractSerializer> is subject to the following conditions:  \n  \n-   All serializable `[DataContract]` types must be `public`.  \n  \n-   All serializable `[DataMember]` fields or properties in a `[DataContract]` type must be public and read/write. The serialization and deserialization of [readonly](https://go.microsoft.com/fwlink/?LinkID=98854) fields is not supported when running WCF in a partially-trusted application.  \n  \n-   The `[Serializable]`/ISerializable programming model is not supported in a partial trust environment.  \n  \n-   Known types must be specified in code or machine-level configuration (machine.config). Known types cannot be specified in application-level configuration for security reasons.  \n  \n-   Types that implement <xref:System.Runtime.Serialization.IObjectReference> throw an exception in a partially-trusted environment.  \n  \n See the Serialization section in [Partial Trust Best Practices](../../../../docs/framework/wcf/feature-details/partial-trust-best-practices.md) for more information about security when using <xref:System.Runtime.Serialization.DataContractSerializer> safely in a partially-trusted application.  \n  \n### Collection Types  \n Some collection types implement both <xref:System.Collections.Generic.IEnumerable%601> and <xref:System.Collections.IEnumerable>. Examples include types that implement <xref:System.Collections.Generic.ICollection%601>. Such types can implement a `public` implementation of `GetEnumerator()`, and an explicit implementation of `GetEnumerator()`. In this case, <xref:System.Runtime.Serialization.DataContractSerializer> invokes the `public` implementation of `GetEnumerator()`, and not the explicit implementation of `GetEnumerator()`. If none of the `GetEnumerator()` implementations are `public` and all are explicit implementations, then <xref:System.Runtime.Serialization.DataContractSerializer> invokes `IEnumerable.GetEnumerator()`.  \n  \n For collection types when WCF is running in a partial trust environment, if none of the `GetEnumerator()` implementations are `public`, or none of them are explicit interface implementations, then a security exception is thrown.  \n  \n### NetDataContractSerializer  \n Many .NET Framework collection types such as <xref:System.Collections.Generic.List%601>, <xref:System.Collections.ArrayList>, <xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.Hashtable> are not supported by the <xref:System.Runtime.Serialization.NetDataContractSerializer> in partial trust. These types have the `[Serializable]` attribute set, and as stated previously in the Serialization section, this attribute is not supported in partial trust. The <xref:System.Runtime.Serialization.DataContractSerializer> treats collections in a special way and is thus able to get around this restriction, but the <xref:System.Runtime.Serialization.NetDataContractSerializer> has no such mechanism to circumvent this restriction.  \n  \n The <xref:System.DateTimeOffset> type is not supported by the <xref:System.Runtime.Serialization.NetDataContractSerializer> in partial trust.  \n  \n A surrogate cannot be used with the <xref:System.Runtime.Serialization.NetDataContractSerializer> (using the <xref:System.Runtime.Serialization.SurrogateSelector> mechanism) when running in partial trust. Note that this restriction applies to using a surrogate, not to serializing it.  \n  \n## Enabling Common Behaviors to Run  \n Service or endpoint behaviors not marked with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute (APTCA) that are added to the [\\<commonBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/commonbehaviors.md) section of a configuration file are not run when the application runs in a partial trust environment and no exception is thrown when this occurs. To enforce the running of common behaviors, you must do one of the following options:  \n  \n-   Mark your common behavior with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute so that it can run when deployed as a partial trust application. Note that a registry entry can be set on the computer to prevent APTCA-marked assemblies from running. .  \n  \n-   Ensure that if the application is deployed as a fully-trusted application that users cannot modify the code-access security settings to run the application in a partial trust environment. If they can do so, the behavior does not run and no exception is thrown. To ensure this, see the **levelfinal** option using [Caspol.exe (Code Access Security Policy Tool)](../../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md).  \n  \n For an example of a common behavior, see [How to: Lock Down Endpoints in the Enterprise](../../../../docs/framework/wcf/extending/how-to-lock-down-endpoints-in-the-enterprise.md).  \n  \n## Configuration  \n With one exception, partially-trusted code can only load WCF configuration sections in the local `app.config` file. To load WCF configuration sections that reference WCF sections in machine.config or in a root web.config file requires ConfigurationPermission(Unrestricted). Without this permission, references to WCF configuration sections (behaviors, bindings) outside of the local configuration file results in an exception when the configuration is loaded.  \n  \n The one exception is known-type configuration for serialization, as described in the Serialization section of this topic.  \n  \n> [!IMPORTANT]\n>  Configuration extensions are only supported when running under Full Trust.  \n  \n## Diagnostics  \n  \n### Event Logging  \n Limited event logging is supported under partial trust. Only service activation faults and tracing/message logging failures are logged to the Event Log. The maximum number of events that can be logged by a process is 5, to avoid writing excessive messages to the Event Log.  \n  \n### Message Logging  \n Message logging does not work when WCF is run in a partial trust environment. If enabled under partial trust, it does not fail service activation, but no message is logged.  \n  \n### Tracing  \n Restricted tracing functionality is available when running in a partial trust environment. In the <`listeners`> element in the configuration file, the only types that you can add are <xref:System.Diagnostics.TextWriterTraceListener> and the new <xref:System.Diagnostics.EventSchemaTraceListener>. Use of the standard <xref:System.Diagnostics.XmlWriterTraceListener> may result in incomplete or incorrect logs.  \n  \n Supported trace sources are:  \n  \n-   <xref:System.ServiceModel>  \n  \n-   <xref:System.Runtime.Serialization>  \n  \n-   <xref:System.IdentityModel.Claims>, <xref:System.IdentityModel.Policy>, <xref:System.IdentityModel.Selectors>, and <xref:System.IdentityModel.Tokens>.  \n  \n The following trace sources are not supported:  \n  \n-   CardSpace  \n  \n-   <xref:System.IO.Log>  \n\n-   [System.ServiceModel.Internal.TransactionBridge](https://docs.microsoft.com/previous-versions/aa346556(v=vs.110))]\n  \n The following members of the <xref:System.Diagnostics.TraceOptions> enumeration should not be specified:  \n  \n-   <xref:System.Diagnostics.TraceOptions.Callstack?displayProperty=nameWithType>  \n  \n-   <xref:System.Diagnostics.TraceOptions.ProcessId?displayProperty=nameWithType>  \n  \n When using tracing in a partial trust environment, ensure that the application has sufficient permissions to store the output of the trace listener. For example, when using the <xref:System.Diagnostics.TextWriterTraceListener> to write trace output to a text file, ensure that the application has the necessary FileIOPermission required to successfully write to the trace file.  \n  \n> [!NOTE]\n>  To avoid flooding the trace files with duplicate errors, WCF disables tracing of the resource or action after the first security failure. There is one exception trace for each failed resource access, the first time an attempt is made to access the resource or perform the action.  \n  \n## WCF Service Host  \n WCF service host does not support partial trust. If you want to use a WCF service in partial trust, do not use the WCF Service Library Project template in Visual Studio to build your service. Instead, create a new Web site in Visual Studio by choosing the WCF service Web site template, which can host the service in a Web server on which WCF partial trust is supported.  \n  \n## Other Limitations  \n WCF is generally limited to the security considerations imposed upon it by the hosting application. For example, if WCF is hosted in a XAML Browser Application (XBAP), it is subject to XBAP limitations, as described in [Windows Presentation Foundation Partial Trust Security](https://go.microsoft.com/fwlink/?LinkId=89138).  \n  \n The following additional features are not enabled when running indigo2 in a partial trust environment:  \n  \n-   Windows Management Instrumentation (WMI)  \n  \n-   Event logging is only partially enabled (see discussion in **Diagnostics** section).  \n  \n-   Performance counters  \n  \n Use of WCF features that are not supported in a partial trust environment may result in exceptions at runtime.  \n  \n## Unlisted Features  \n The best way to discover that a piece of information or action is unavailable when running in a partial trust environment is to try to access the resource or do the action inside of a `try` block, and then `catch` the failure. To avoid flooding the trace files with duplicate errors, WCF disables tracing of the resource or action after the first security failure. There is one exception trace for each failed resource access, the first time an attempt is made to access the resource or perform the action.  \n  \n## See also\n\n- <xref:System.ServiceModel.Channels.HttpTransportBindingElement>\n- <xref:System.ServiceModel.Channels.HttpsTransportBindingElement>\n- <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>\n- <xref:System.ServiceModel.Channels.WebMessageEncodingBindingElement>\n- [Supported Deployment Scenarios](../../../../docs/framework/wcf/feature-details/supported-deployment-scenarios.md)\n- [Partial Trust Best Practices](../../../../docs/framework/wcf/feature-details/partial-trust-best-practices.md)\n","nodes":[{"pos":[4,119],"embed":true,"restype":"x-metadata","content":"title: \"Partial Trust Feature Compatibility\"\nms.date: \"03/30/2017\"\nms.assetid: a36a540b-1606-4e63-88e0-b7c59e0e6ab7","nodes":[{"content":"Partial Trust Feature Compatibility","nodes":[{"pos":[0,35],"content":"Partial Trust Feature Compatibility","nodes":[{"content":"Partial Trust Feature Compatibility","pos":[0,35]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[126,161],"content":"Partial Trust Feature Compatibility","linkify":"Partial Trust Feature Compatibility","nodes":[{"content":"Partial Trust Feature Compatibility","pos":[0,35]}]},{"content":"Windows Communication Foundation (WCF) supports a limited subset of functionality when running in a partially-trusted environment.","pos":[162,292]},{"content":"The features supported in partial trust are designed around a specific set of scenarios as described in the <bpt id=\"p1\">[</bpt>Supported Deployment Scenarios<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/supported-deployment-scenarios.md)</ept> topic.","pos":[293,522],"source":" The features supported in partial trust are designed around a specific set of scenarios as described in the [Supported Deployment Scenarios](../../../../docs/framework/wcf/feature-details/supported-deployment-scenarios.md) topic."},{"pos":[531,562],"content":"Minimum Permission Requirements","linkify":"Minimum Permission Requirements","nodes":[{"content":"Minimum Permission Requirements","pos":[0,31]}]},{"content":"WCF supports a subset of features in applications running under either of the following standard named permission sets:","pos":[566,685]},{"content":"Medium Trust permissions","pos":[695,719]},{"content":"Internet Zone permissions","pos":[729,754]},{"content":"Attempting to use WCF in partially-trusted applications with more restrictive permissions may result in security exceptions at runtime.","pos":[761,896]},{"pos":[905,914],"content":"Contracts","linkify":"Contracts","nodes":[{"content":"Contracts","pos":[0,9]}]},{"content":"Contracts are subject to the following restrictions when running under partial trust:","pos":[918,1003]},{"content":"The service class that implements the <ph id=\"ph1\">`[ServiceContract]`</ph> interface must be <ph id=\"ph2\">`public`</ph> and have a <ph id=\"ph3\">`public`</ph> constructor.","pos":[1013,1130],"source":"The service class that implements the `[ServiceContract]` interface must be `public` and have a `public` constructor."},{"content":"If it defines <ph id=\"ph1\">`[OperationContract]`</ph> methods, these must be <ph id=\"ph2\">`public`</ph>.","pos":[1131,1199],"source":" If it defines `[OperationContract]` methods, these must be `public`."},{"content":"If it instead implements a <ph id=\"ph1\">`[ServiceContract]`</ph> interface, those method implementations can be explicit or <ph id=\"ph2\">`private`</ph>, provided that the <ph id=\"ph3\">`[ServiceContract]`</ph> interface is <ph id=\"ph4\">`public`</ph>.","pos":[1200,1377],"source":" If it instead implements a `[ServiceContract]` interface, those method implementations can be explicit or `private`, provided that the `[ServiceContract]` interface is `public`."},{"pos":[1387,1472],"content":"When using the <ph id=\"ph1\">`[ServiceKnownType]`</ph> attribute, the method specified must be <ph id=\"ph2\">`public`</ph>.","source":"When using the `[ServiceKnownType]` attribute, the method specified must be `public`."},{"content":"<ph id=\"ph1\">`[MessageContract]`</ph> classes and their members can be <ph id=\"ph2\">`public`</ph>.","pos":[1482,1544],"source":"`[MessageContract]` classes and their members can be `public`."},{"content":"If the <ph id=\"ph1\">`[MessageContract]`</ph> class is defined in the application assembly it can be <ph id=\"ph2\">`internal`</ph> and have <ph id=\"ph3\">`internal`</ph> members.","pos":[1545,1666],"source":" If the `[MessageContract]` class is defined in the application assembly it can be `internal` and have `internal` members."},{"pos":[1675,1699],"content":"System-Provided Bindings","linkify":"System-Provided Bindings","nodes":[{"content":"System-Provided Bindings","pos":[0,24]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.BasicHttpBinding&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceModel.WebHttpBinding&gt;</ph> are fully supported in a partial trust environment.","pos":[1703,1848],"source":"The <xref:System.ServiceModel.BasicHttpBinding> and <xref:System.ServiceModel.WebHttpBinding> are fully supported in a partial trust environment."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> is supported for Transport security mode only.","pos":[1849,1940],"source":" The <xref:System.ServiceModel.WSHttpBinding> is supported for Transport security mode only."},{"pos":[1947,2211],"content":"Bindings that use transports other than HTTP, such as the <ph id=\"ph1\">&lt;xref:System.ServiceModel.NetTcpBinding&gt;</ph>, the <ph id=\"ph2\">&lt;xref:System.ServiceModel.NetNamedPipeBinding&gt;</ph>, or the <ph id=\"ph3\">&lt;xref:System.ServiceModel.NetMsmqBinding&gt;</ph>, are not supported when running in a partial trust environment.","source":"Bindings that use transports other than HTTP, such as the <xref:System.ServiceModel.NetTcpBinding>, the <xref:System.ServiceModel.NetNamedPipeBinding>, or the <xref:System.ServiceModel.NetMsmqBinding>, are not supported when running in a partial trust environment."},{"pos":[2220,2235],"content":"Custom Bindings","linkify":"Custom Bindings","nodes":[{"content":"Custom Bindings","pos":[0,15]}]},{"content":"Custom bindings can be created and used in a partial trust environment, but must follow the restrictions specified in this section.","pos":[2239,2370]},{"pos":[2380,2390],"content":"Transports","linkify":"Transports","nodes":[{"content":"Transports","pos":[0,10]}]},{"pos":[2394,2575],"content":"The only allowed transport binding elements are <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.HttpTransportBindingElement&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.HttpsTransportBindingElement&gt;</ph>.","source":"The only allowed transport binding elements are <xref:System.ServiceModel.Channels.HttpTransportBindingElement> and <xref:System.ServiceModel.Channels.HttpsTransportBindingElement>."},{"pos":[2585,2593],"content":"Encoders","linkify":"Encoders","nodes":[{"content":"Encoders","pos":[0,8]}]},{"content":"The following encoders are allowed:","pos":[2597,2632]},{"pos":[2642,2731],"content":"The text encoder (<ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement&gt;</ph>).","source":"The text encoder (<xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>)."},{"pos":[2741,2834],"content":"The binary encoder (<ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement&gt;</ph>).","source":"The binary encoder (<xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>)."},{"pos":[2844,2939],"content":"The Web Message encoder (<ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.WebMessageEncodingBindingElement&gt;</ph>).","source":"The Web Message encoder (<xref:System.ServiceModel.Channels.WebMessageEncodingBindingElement>)."},{"content":"The Message Transmission Optimization Mechanism (MTOM) encoders are not supported.","pos":[2946,3028]},{"pos":[3038,3046],"content":"Security","linkify":"Security","nodes":[{"content":"Security","pos":[0,8]}]},{"content":"Partially-trusted applications can use WCF's transport-level security features for securing their communication.","pos":[3050,3162]},{"content":"Message-level security is not supported.","pos":[3163,3203]},{"content":"Configuring a binding to use message-level security results in an exception at runtime.","pos":[3204,3291]},{"pos":[3301,3321],"content":"Unsupported Bindings","linkify":"Unsupported Bindings","nodes":[{"content":"Unsupported Bindings","pos":[0,20]}]},{"content":"Bindings that use reliable messaging, transactions, or message-level security are not supported.","pos":[3325,3421]},{"pos":[3430,3443],"content":"Serialization","linkify":"Serialization","nodes":[{"content":"Serialization","pos":[0,13]}]},{"content":"Both the <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataContractSerializer&gt;</ph> and the <ph id=\"ph2\">&lt;xref:System.Xml.Serialization.XmlSerializer&gt;</ph> are supported in a partial trust environment.","pos":[3447,3614],"source":"Both the <xref:System.Runtime.Serialization.DataContractSerializer> and the <xref:System.Xml.Serialization.XmlSerializer> are supported in a partial trust environment."},{"content":"However, use of the <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataContractSerializer&gt;</ph> is subject to the following conditions:","pos":[3615,3733],"source":" However, use of the <xref:System.Runtime.Serialization.DataContractSerializer> is subject to the following conditions:"},{"pos":[3743,3800],"content":"All serializable <ph id=\"ph1\">`[DataContract]`</ph> types must be <ph id=\"ph2\">`public`</ph>.","source":"All serializable `[DataContract]` types must be `public`."},{"content":"All serializable <ph id=\"ph1\">`[DataMember]`</ph> fields or properties in a <ph id=\"ph2\">`[DataContract]`</ph> type must be public and read/write.","pos":[3810,3920],"source":"All serializable `[DataMember]` fields or properties in a `[DataContract]` type must be public and read/write."},{"content":"The serialization and deserialization of <bpt id=\"p1\">[</bpt>readonly<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=98854)</ept> fields is not supported when running WCF in a partially-trusted application.","pos":[3921,4096],"source":" The serialization and deserialization of [readonly](https://go.microsoft.com/fwlink/?LinkID=98854) fields is not supported when running WCF in a partially-trusted application."},{"pos":[4106,4207],"content":"The <ph id=\"ph1\">`[Serializable]`</ph>/ISerializable programming model is not supported in a partial trust environment.","source":"The `[Serializable]`/ISerializable programming model is not supported in a partial trust environment."},{"content":"Known types must be specified in code or machine-level configuration (machine.config).","pos":[4217,4303]},{"content":"Known types cannot be specified in application-level configuration for security reasons.","pos":[4304,4392]},{"pos":[4402,4530],"content":"Types that implement <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.IObjectReference&gt;</ph> throw an exception in a partially-trusted environment.","source":"Types that implement <xref:System.Runtime.Serialization.IObjectReference> throw an exception in a partially-trusted environment."},{"pos":[4537,4829],"content":"See the Serialization section in <bpt id=\"p1\">[</bpt>Partial Trust Best Practices<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/partial-trust-best-practices.md)</ept> for more information about security when using <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataContractSerializer&gt;</ph> safely in a partially-trusted application.","source":"See the Serialization section in [Partial Trust Best Practices](../../../../docs/framework/wcf/feature-details/partial-trust-best-practices.md) for more information about security when using <xref:System.Runtime.Serialization.DataContractSerializer> safely in a partially-trusted application."},{"pos":[4839,4855],"content":"Collection Types","linkify":"Collection Types","nodes":[{"content":"Collection Types","pos":[0,16]}]},{"content":"Some collection types implement both <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Collections.IEnumerable&gt;</ph>.","pos":[4859,4988],"source":"Some collection types implement both <xref:System.Collections.Generic.IEnumerable%601> and <xref:System.Collections.IEnumerable>."},{"content":"Examples include types that implement <ph id=\"ph1\">&lt;xref:System.Collections.Generic.ICollection%601&gt;</ph>.","pos":[4989,5077],"source":" Examples include types that implement <xref:System.Collections.Generic.ICollection%601>."},{"content":"Such types can implement a <ph id=\"ph1\">`public`</ph> implementation of <ph id=\"ph2\">`GetEnumerator()`</ph>, and an explicit implementation of <ph id=\"ph3\">`GetEnumerator()`</ph>.","pos":[5078,5203],"source":" Such types can implement a `public` implementation of `GetEnumerator()`, and an explicit implementation of `GetEnumerator()`."},{"content":"In this case, <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataContractSerializer&gt;</ph> invokes the <ph id=\"ph2\">`public`</ph> implementation of <ph id=\"ph3\">`GetEnumerator()`</ph>, and not the explicit implementation of <ph id=\"ph4\">`GetEnumerator()`</ph>.","pos":[5204,5392],"source":" In this case, <xref:System.Runtime.Serialization.DataContractSerializer> invokes the `public` implementation of `GetEnumerator()`, and not the explicit implementation of `GetEnumerator()`."},{"content":"If none of the <ph id=\"ph1\">`GetEnumerator()`</ph> implementations are <ph id=\"ph2\">`public`</ph> and all are explicit implementations, then <ph id=\"ph3\">&lt;xref:System.Runtime.Serialization.DataContractSerializer&gt;</ph> invokes <ph id=\"ph4\">`IEnumerable.GetEnumerator()`</ph>.","pos":[5393,5595],"source":" If none of the `GetEnumerator()` implementations are `public` and all are explicit implementations, then <xref:System.Runtime.Serialization.DataContractSerializer> invokes `IEnumerable.GetEnumerator()`."},{"pos":[5602,5830],"content":"For collection types when WCF is running in a partial trust environment, if none of the <ph id=\"ph1\">`GetEnumerator()`</ph> implementations are <ph id=\"ph2\">`public`</ph>, or none of them are explicit interface implementations, then a security exception is thrown.","source":"For collection types when WCF is running in a partial trust environment, if none of the `GetEnumerator()` implementations are `public`, or none of them are explicit interface implementations, then a security exception is thrown."},{"pos":[5840,5865],"content":"NetDataContractSerializer","linkify":"NetDataContractSerializer","nodes":[{"content":"NetDataContractSerializer","pos":[0,25]}]},{"content":"Many .NET Framework collection types such as <ph id=\"ph1\">&lt;xref:System.Collections.Generic.List%601&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Collections.ArrayList&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Collections.Generic.Dictionary%602&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Collections.Hashtable&gt;</ph> are not supported by the <ph id=\"ph5\">&lt;xref:System.Runtime.Serialization.NetDataContractSerializer&gt;</ph> in partial trust.","pos":[5869,6188],"source":"Many .NET Framework collection types such as <xref:System.Collections.Generic.List%601>, <xref:System.Collections.ArrayList>, <xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.Hashtable> are not supported by the <xref:System.Runtime.Serialization.NetDataContractSerializer> in partial trust."},{"content":"These types have the <ph id=\"ph1\">`[Serializable]`</ph> attribute set, and as stated previously in the Serialization section, this attribute is not supported in partial trust.","pos":[6189,6346],"source":" These types have the `[Serializable]` attribute set, and as stated previously in the Serialization section, this attribute is not supported in partial trust."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataContractSerializer&gt;</ph> treats collections in a special way and is thus able to get around this restriction, but the <ph id=\"ph2\">&lt;xref:System.Runtime.Serialization.NetDataContractSerializer&gt;</ph> has no such mechanism to circumvent this restriction.","pos":[6347,6618],"source":" The <xref:System.Runtime.Serialization.DataContractSerializer> treats collections in a special way and is thus able to get around this restriction, but the <xref:System.Runtime.Serialization.NetDataContractSerializer> has no such mechanism to circumvent this restriction."},{"pos":[6625,6766],"content":"The <ph id=\"ph1\">&lt;xref:System.DateTimeOffset&gt;</ph> type is not supported by the <ph id=\"ph2\">&lt;xref:System.Runtime.Serialization.NetDataContractSerializer&gt;</ph> in partial trust.","source":"The <xref:System.DateTimeOffset> type is not supported by the <xref:System.Runtime.Serialization.NetDataContractSerializer> in partial trust."},{"content":"A surrogate cannot be used with the <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.NetDataContractSerializer&gt;</ph> (using the <ph id=\"ph2\">&lt;xref:System.Runtime.Serialization.SurrogateSelector&gt;</ph> mechanism) when running in partial trust.","pos":[6773,6977],"source":"A surrogate cannot be used with the <xref:System.Runtime.Serialization.NetDataContractSerializer> (using the <xref:System.Runtime.Serialization.SurrogateSelector> mechanism) when running in partial trust."},{"content":"Note that this restriction applies to using a surrogate, not to serializing it.","pos":[6978,7057]},{"pos":[7066,7098],"content":"Enabling Common Behaviors to Run","linkify":"Enabling Common Behaviors to Run","nodes":[{"content":"Enabling Common Behaviors to Run","pos":[0,32]}]},{"content":"Service or endpoint behaviors not marked with the <ph id=\"ph1\">&lt;xref:System.Security.AllowPartiallyTrustedCallersAttribute&gt;</ph> attribute (APTCA) that are added to the <bpt id=\"p1\">[</bpt><ph id=\"ph2\">\\&lt;</ph>commonBehaviors&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/commonbehaviors.md)</ept> section of a configuration file are not run when the application runs in a partial trust environment and no exception is thrown when this occurs.","pos":[7102,7497],"source":"Service or endpoint behaviors not marked with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute (APTCA) that are added to the [\\<commonBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/commonbehaviors.md) section of a configuration file are not run when the application runs in a partial trust environment and no exception is thrown when this occurs."},{"content":"To enforce the running of common behaviors, you must do one of the following options:","pos":[7498,7583]},{"content":"Mark your common behavior with the <ph id=\"ph1\">&lt;xref:System.Security.AllowPartiallyTrustedCallersAttribute&gt;</ph> attribute so that it can run when deployed as a partial trust application.","pos":[7593,7763],"source":"Mark your common behavior with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute so that it can run when deployed as a partial trust application."},{"content":"Note that a registry entry can be set on the computer to prevent APTCA-marked assemblies from running.","pos":[7764,7866]},{"content":".","pos":[7867,7868]},{"content":"Ensure that if the application is deployed as a fully-trusted application that users cannot modify the code-access security settings to run the application in a partial trust environment.","pos":[7878,8065]},{"content":"If they can do so, the behavior does not run and no exception is thrown.","pos":[8066,8138]},{"content":"To ensure this, see the <bpt id=\"p1\">**</bpt>levelfinal<ept id=\"p1\">**</ept> option using <bpt id=\"p2\">[</bpt>Caspol.exe (Code Access Security Policy Tool)<ept id=\"p2\">](../../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md)</ept>.","pos":[8139,8320],"source":" To ensure this, see the **levelfinal** option using [Caspol.exe (Code Access Security Policy Tool)](../../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md)."},{"pos":[8327,8506],"content":"For an example of a common behavior, see <bpt id=\"p1\">[</bpt>How to: Lock Down Endpoints in the Enterprise<ept id=\"p1\">](../../../../docs/framework/wcf/extending/how-to-lock-down-endpoints-in-the-enterprise.md)</ept>.","source":"For an example of a common behavior, see [How to: Lock Down Endpoints in the Enterprise](../../../../docs/framework/wcf/extending/how-to-lock-down-endpoints-in-the-enterprise.md)."},{"pos":[8515,8528],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"content":"With one exception, partially-trusted code can only load WCF configuration sections in the local <ph id=\"ph1\">`app.config`</ph> file.","pos":[8532,8647],"source":"With one exception, partially-trusted code can only load WCF configuration sections in the local `app.config` file."},{"content":"To load WCF configuration sections that reference WCF sections in machine.config or in a root web.config file requires ConfigurationPermission(Unrestricted).","pos":[8648,8805]},{"content":"Without this permission, references to WCF configuration sections (behaviors, bindings) outside of the local configuration file results in an exception when the configuration is loaded.","pos":[8806,8991]},{"content":"The one exception is known-type configuration for serialization, as described in the Serialization section of this topic.","pos":[8998,9119]},{"pos":[9127,9217],"content":"[!IMPORTANT]\n Configuration extensions are only supported when running under Full Trust.","leadings":["","> "],"nodes":[{"content":"Configuration extensions are only supported when running under Full Trust.","pos":[14,88]}]},{"pos":[9226,9237],"content":"Diagnostics","linkify":"Diagnostics","nodes":[{"content":"Diagnostics","pos":[0,11]}]},{"pos":[9247,9260],"content":"Event Logging","linkify":"Event Logging","nodes":[{"content":"Event Logging","pos":[0,13]}]},{"content":"Limited event logging is supported under partial trust.","pos":[9264,9319]},{"content":"Only service activation faults and tracing/message logging failures are logged to the Event Log.","pos":[9320,9416]},{"content":"The maximum number of events that can be logged by a process is 5, to avoid writing excessive messages to the Event Log.","pos":[9417,9537]},{"pos":[9547,9562],"content":"Message Logging","linkify":"Message Logging","nodes":[{"content":"Message Logging","pos":[0,15]}]},{"content":"Message logging does not work when WCF is run in a partial trust environment.","pos":[9566,9643]},{"content":"If enabled under partial trust, it does not fail service activation, but no message is logged.","pos":[9644,9738]},{"pos":[9748,9755],"content":"Tracing","linkify":"Tracing","nodes":[{"content":"Tracing","pos":[0,7]}]},{"content":"Restricted tracing functionality is available when running in a partial trust environment.","pos":[9759,9849]},{"content":"In the &lt;<ph id=\"ph1\">`listeners`</ph>&gt; element in the configuration file, the only types that you can add are <ph id=\"ph2\">&lt;xref:System.Diagnostics.TextWriterTraceListener&gt;</ph> and the new <ph id=\"ph3\">&lt;xref:System.Diagnostics.EventSchemaTraceListener&gt;</ph>.","pos":[9850,10055],"source":" In the <`listeners`> element in the configuration file, the only types that you can add are <xref:System.Diagnostics.TextWriterTraceListener> and the new <xref:System.Diagnostics.EventSchemaTraceListener>."},{"content":"Use of the standard <ph id=\"ph1\">&lt;xref:System.Diagnostics.XmlWriterTraceListener&gt;</ph> may result in incomplete or incorrect logs.","pos":[10056,10168],"source":" Use of the standard <xref:System.Diagnostics.XmlWriterTraceListener> may result in incomplete or incorrect logs."},{"content":"Supported trace sources are:","pos":[10175,10203]},{"pos":[10294,10444],"content":"<ph id=\"ph1\">&lt;xref:System.IdentityModel.Claims&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.IdentityModel.Policy&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.IdentityModel.Selectors&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.IdentityModel.Tokens&gt;</ph>.","source":"<xref:System.IdentityModel.Claims>, <xref:System.IdentityModel.Policy>, <xref:System.IdentityModel.Selectors>, and <xref:System.IdentityModel.Tokens>."},{"content":"The following trace sources are not supported:","pos":[10451,10497]},{"content":"CardSpace","pos":[10507,10516]},{"pos":[10554,10668],"content":"<bpt id=\"p1\">[</bpt>System.ServiceModel.Internal.TransactionBridge<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/aa346556(v=vs.110))</ept>]","source":"[System.ServiceModel.Internal.TransactionBridge](https://docs.microsoft.com/previous-versions/aa346556(v=vs.110))]"},{"pos":[10673,10777],"content":"The following members of the <ph id=\"ph1\">&lt;xref:System.Diagnostics.TraceOptions&gt;</ph> enumeration should not be specified:","source":"The following members of the <xref:System.Diagnostics.TraceOptions> enumeration should not be specified:"},{"content":"When using tracing in a partial trust environment, ensure that the application has sufficient permissions to store the output of the trace listener.","pos":[10958,11106]},{"content":"For example, when using the <ph id=\"ph1\">&lt;xref:System.Diagnostics.TextWriterTraceListener&gt;</ph> to write trace output to a text file, ensure that the application has the necessary FileIOPermission required to successfully write to the trace file.","pos":[11107,11335],"source":" For example, when using the <xref:System.Diagnostics.TextWriterTraceListener> to write trace output to a text file, ensure that the application has the necessary FileIOPermission required to successfully write to the trace file."},{"pos":[11343,11633],"content":"[!NOTE]\n To avoid flooding the trace files with duplicate errors, WCF disables tracing of the resource or action after the first security failure. There is one exception trace for each failed resource access, the first time an attempt is made to access the resource or perform the action.","leadings":["","> "],"nodes":[{"content":"To avoid flooding the trace files with duplicate errors, WCF disables tracing of the resource or action after the first security failure. There is one exception trace for each failed resource access, the first time an attempt is made to access the resource or perform the action.","pos":[9,288],"nodes":[{"content":"To avoid flooding the trace files with duplicate errors, WCF disables tracing of the resource or action after the first security failure.","pos":[0,137]},{"content":"There is one exception trace for each failed resource access, the first time an attempt is made to access the resource or perform the action.","pos":[138,279]}]}]},{"pos":[11642,11658],"content":"WCF Service Host","linkify":"WCF Service Host","nodes":[{"content":"WCF Service Host","pos":[0,16]}]},{"content":"WCF service host does not support partial trust.","pos":[11662,11710]},{"content":"If you want to use a WCF service in partial trust, do not use the WCF Service Library Project template in Visual Studio to build your service.","pos":[11711,11853]},{"content":"Instead, create a new Web site in Visual Studio by choosing the WCF service Web site template, which can host the service in a Web server on which WCF partial trust is supported.","pos":[11854,12032]},{"pos":[12041,12058],"content":"Other Limitations","linkify":"Other Limitations","nodes":[{"content":"Other Limitations","pos":[0,17]}]},{"content":"WCF is generally limited to the security considerations imposed upon it by the hosting application.","pos":[12062,12161]},{"content":"For example, if WCF is hosted in a XAML Browser Application (XBAP), it is subject to XBAP limitations, as described in <bpt id=\"p1\">[</bpt>Windows Presentation Foundation Partial Trust Security<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=89138)</ept>.","pos":[12162,12385],"source":" For example, if WCF is hosted in a XAML Browser Application (XBAP), it is subject to XBAP limitations, as described in [Windows Presentation Foundation Partial Trust Security](https://go.microsoft.com/fwlink/?LinkId=89138)."},{"content":"The following additional features are not enabled when running indigo2 in a partial trust environment:","pos":[12392,12494]},{"content":"Windows Management Instrumentation (WMI)","pos":[12504,12544]},{"pos":[12554,12638],"content":"Event logging is only partially enabled (see discussion in <bpt id=\"p1\">**</bpt>Diagnostics<ept id=\"p1\">**</ept> section).","source":"Event logging is only partially enabled (see discussion in **Diagnostics** section)."},{"content":"Performance counters","pos":[12648,12668]},{"content":"Use of WCF features that are not supported in a partial trust environment may result in exceptions at runtime.","pos":[12675,12785]},{"pos":[12794,12811],"content":"Unlisted Features","linkify":"Unlisted Features","nodes":[{"content":"Unlisted Features","pos":[0,17]}]},{"content":"The best way to discover that a piece of information or action is unavailable when running in a partial trust environment is to try to access the resource or do the action inside of a <ph id=\"ph1\">`try`</ph> block, and then <ph id=\"ph2\">`catch`</ph> the failure.","pos":[12815,13041],"source":"The best way to discover that a piece of information or action is unavailable when running in a partial trust environment is to try to access the resource or do the action inside of a `try` block, and then `catch` the failure."},{"content":"To avoid flooding the trace files with duplicate errors, WCF disables tracing of the resource or action after the first security failure.","pos":[13042,13179]},{"content":"There is one exception trace for each failed resource access, the first time an attempt is made to access the resource or perform the action.","pos":[13180,13321]},{"pos":[13330,13338],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[13618,13732],"content":"<bpt id=\"p1\">[</bpt>Supported Deployment Scenarios<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/supported-deployment-scenarios.md)</ept>","source":"[Supported Deployment Scenarios](../../../../docs/framework/wcf/feature-details/supported-deployment-scenarios.md)"},{"pos":[13735,13845],"content":"<bpt id=\"p1\">[</bpt>Partial Trust Best Practices<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/partial-trust-best-practices.md)</ept>","source":"[Partial Trust Best Practices](../../../../docs/framework/wcf/feature-details/partial-trust-best-practices.md)"}]}