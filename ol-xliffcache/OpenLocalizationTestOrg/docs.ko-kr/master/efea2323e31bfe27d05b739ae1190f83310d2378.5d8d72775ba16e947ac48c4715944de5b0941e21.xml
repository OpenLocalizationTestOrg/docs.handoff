{"content":"---\ntitle: \"How to: Secure a Service with Windows Credentials | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"WCF, security\"\nms.assetid: d171b5ca-96ef-47ff-800c-c138023cf76e\ncaps.latest.revision: 26\nauthor: \"BrucePerlerMS\"\nms.author: \"bruceper\"\nmanager: \"mbaldwin\"\n---\n# How to: Secure a Service with Windows Credentials\nThis topic shows how to enable transfer security on a [!INCLUDE[indigo1](../../../includes/indigo1-md.md)] service that resides in a Windows domain and is called by clients in the same domain. [!INCLUDE[crabout](../../../includes/crabout-md.md)] this scenario, see [Transport Security with Windows Authentication](../../../docs/framework/wcf/feature-details/transport-security-with-windows-authentication.md). For a sample application, see the [WSHttpBinding](../../../docs/framework/wcf/samples/wshttpbinding.md) sample.  \n  \n This topic assumes you have an existing contract interface and implementation already defined, and adds on to that. You can also modify an existing service and client.  \n  \n You can secure a service with Windows credentials completely in code. Alternatively, you can omit some of the code by using a configuration file. This topic shows both ways. Be sure you only use one of the ways, not both.  \n  \n The first three procedures show how to secure the service using code. The fourth and fifth procedure shows how to do it with a configuration file.  \n  \n## Using Code  \n The complete code for the service and the client is in the Example section at the end of this topic.  \n  \n The first procedure walks through creating and configuring a <xref:System.ServiceModel.WSHttpBinding> class in code. The binding uses the HTTP transport. The same binding is used on the client.  \n  \n#### To create a WSHttpBinding that uses Windows credentials and message security  \n  \n1.  This procedure's code is inserted at the beginning of the `Run` method of the `Test` class in the service code in the Example section.  \n  \n2.  Create an instance of the <xref:System.ServiceModel.WSHttpBinding> class.  \n  \n3.  Set the <xref:System.ServiceModel.WSHttpSecurity.Mode%2A> property of the <xref:System.ServiceModel.WSHttpSecurity> class to <xref:System.ServiceModel.SecurityMode>.  \n  \n4.  Set the <xref:System.ServiceModel.MessageSecurityOverHttp.ClientCredentialType%2A> property of the <xref:System.ServiceModel.MessageSecurityOverHttp> class to <xref:System.ServiceModel.MessageCredentialType>.  \n  \n5.  The code for this procedure is as follows:  \n  \n     [!code-csharp[c_SecureWindowsService#1](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsservice/cs/secureservice.cs#1)]\n     [!code-vb[c_SecureWindowsService#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsservice/vb/secureservice.vb#1)]  \n  \n### Using the Binding in a Service  \n This is the second procedure, which shows how to use the binding in a self-hosted service. [!INCLUDE[crabout](../../../includes/crabout-md.md)] hosting services see [Hosting Services](../../../docs/framework/wcf/hosting-services.md).  \n  \n##### To use a binding in a service  \n  \n1.  Insert this procedure's code after the code from the preceding procedure.  \n  \n2.  Create a <xref:System.Type> variable named `contractType` and assign it the type of the interface (`ICalculator`). When using [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)], use the `GetType` operator; when using C#, use the `typeof` keyword.  \n  \n3.  Create a second `Type` variable named `serviceType` and assign it the type of the implemented contract (`Calculator`).  \n  \n4.  Create an instance of the <xref:System.Uri> class named `baseAddress` with the base address of the service. The base address must have a scheme that matches the transport. In this case, the transport scheme is HTTP, and the address includes the special Uniform Resource Identifier (URI) \"localhost\" and a port number (8036) as well as a base endpoint address (\"serviceModelSamples/): http://localhost:8036/serviceModelSamples/.  \n  \n5.  Create an instance of the <xref:System.ServiceModel.ServiceHost> class with the `serviceType` and `baseAddress` variables.  \n  \n6.  Add an endpoint to the service using the `contractType`, binding, and an endpoint name (secureCalculator). A client must concatenate the base address and the endpoint name when initiating a call to the service.  \n  \n7.  Call the <xref:System.ServiceModel.Channels.CommunicationObject.Open%2A> method to start the service. The code for this procedure is shown here:  \n  \n     [!code-csharp[c_SecureWindowsService#2](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsservice/cs/secureservice.cs#2)]\n     [!code-vb[c_SecureWindowsService#2](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsservice/vb/secureservice.vb#2)]  \n  \n### Using the Binding in a Client  \n This procedure shows how to generate a proxy that communicates with the service. The proxy is generated with the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) which uses the service metadata to create the proxy.  \n  \n This procedure also creates an instance of the <xref:System.ServiceModel.WSHttpBinding> class to communicate with the service, and then calls the service.  \n  \n This example uses only code to create the client. As an alternative, you can use a configuration file, which is shown in the section following this procedure.  \n  \n##### To use a binding in a client with code  \n  \n1.  Use the SvcUtil.exe tool to generate the proxy code from the service's metadata. [!INCLUDE[crdefault](../../../includes/crdefault-md.md)] [How to: Create a Client](../../../docs/framework/wcf/how-to-create-a-wcf-client.md). The generated proxy code inherits from the <xref:System.ServiceModel.ClientBase%601> class, which ensures that every client has the necessary constructors, methods, and properties to communicate with a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service. In this example, the generated code includes the `CalculatorClient` class, which implements the `ICalculator` interface, enabling compatibility with the service code.  \n  \n2.  This procedure's code is inserted at the beginning of the `Main` method of the client program.  \n  \n3.  Create an instance of the <xref:System.ServiceModel.WSHttpBinding> class and set its security mode to `Message` and its client credential type to `Windows`. The example names the variable `clientBinding`.  \n  \n4.  Create an instance of the <xref:System.ServiceModel.EndpointAddress> class named `serviceAddress`. Initialize the instance with the base address concatenated with the endpoint name.  \n  \n5.  Create an instance of the generated client class with the `serviceAddress` and the `clientBinding` variables.  \n  \n6.  Call the <xref:System.ServiceModel.ClientBase%601.Open%2A> method, as shown in the following code.  \n  \n7.  Call the service and display the results.  \n  \n     [!code-csharp[c_secureWindowsClient#1](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsclient/cs/secureclient.cs#1)]\n     [!code-vb[c_secureWindowsClient#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsclient/vb/secureclient.vb#1)]  \n  \n## Using the Configuration File  \n Instead of creating the binding with procedural code, you can use the following code shown for the bindings section of the configuration file.  \n  \n If you do not already have a service defined, see [Designing and Implementing Services](../../../docs/framework/wcf/designing-and-implementing-services.md), and [Configuring Services](../../../docs/framework/wcf/configuring-services.md).  \n  \n **Note** This configuration code is used in both the service and client configuration files.  \n  \n#### To enable transfer security on a service in a Windows domain using configuration  \n  \n1.  Add a [\\<wsHttpBinding>](../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md) element to the [\\<bindings>](../../../docs/framework/configure-apps/file-schema/wcf/bindings.md) element section of the configuration file.  \n  \n2.  Add a <`binding`> element to the <`WSHttpBinding`> element and set the `configurationName` attribute to a value appropriate to your application.  \n  \n3.  Add a <`security`> element and set the `mode` attribute to Message.  \n  \n4.  Add a <`message`> element and set the `clientCredentialType` attribute to Windows.  \n  \n5.  In the service's configuration file, replace the `<bindings>` section with the following code. If you do not already have a service configuration file, see [Using Bindings to Configure Services and Clients](../../../docs/framework/wcf/using-bindings-to-configure-services-and-clients.md).  \n  \n    ```  \n    <bindings>  \n      <wsHttpBinding>  \n       <binding name = \"wsHttpBinding_Calculator\">  \n         <security mode=\"Message\">  \n           <message clientCredentialType=\"Windows\"/>  \n         </security>  \n        </binding>  \n      </wsHttpBinding>  \n    </bindings>  \n    ```  \n  \n### Using the Binding in a Client  \n This procedure shows how to generate two files: a proxy that communicates with the service and a configuration file. It also describes changes to the client program, which is the third file used on the client.  \n  \n##### To use a binding in a client with configuration  \n  \n1.  Use the SvcUtil.exe tool to generate the proxy code and configuration file from the service's metadata. [!INCLUDE[crdefault](../../../includes/crdefault-md.md)][How to: Create a Client](../../../docs/framework/wcf/how-to-create-a-wcf-client.md).  \n  \n2.  Replace the [\\<bindings>](../../../docs/framework/configure-apps/file-schema/wcf/bindings.md) section of the generated configuration file with the configuration code from the preceding section.  \n  \n3.  Procedural code is inserted at the beginning of the `Main` method of the client program.  \n  \n4.  Create an instance of the generated client class passing the name of the binding in the configuration file as an input parameter.  \n  \n5.  Call the <xref:System.ServiceModel.ClientBase%601.Open%2A> method, as shown in the following code.  \n  \n6.  Call the service and display the results.  \n  \n     [!code-csharp[c_secureWindowsClient#2](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsclient/cs/secureclient.cs#2)]  \n  \n## Example  \n [!code-csharp[c_SecureWindowsService#0](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsservice/cs/secureservice.cs#0)]  \n  \n [!code-csharp[c_SecureWindowsClient#0](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsclient/cs/secureclient.cs#0)] \n [!code-vb[c_SecureWindowsClient#0](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsclient/vb/secureclient.vb#0)]      \n  \n## See Also  \n <xref:System.ServiceModel.WSHttpBinding>   \n [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)   \n [How to: Create a Client](../../../docs/framework/wcf/how-to-create-a-wcf-client.md)   \n [Securing Services](../../../docs/framework/wcf/securing-services.md)   \n [Security Overview](../../../docs/framework/wcf/feature-details/security-overview.md)","nodes":[{"pos":[4,423],"embed":true,"restype":"x-metadata","content":"title: \"How to: Secure a Service with Windows Credentials | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"WCF, security\"\nms.assetid: d171b5ca-96ef-47ff-800c-c138023cf76e\ncaps.latest.revision: 26\nauthor: \"BrucePerlerMS\"\nms.author: \"bruceper\"\nmanager: \"mbaldwin\"","nodes":[{"content":"How to: Secure a Service with Windows Credentials | Microsoft Docs","nodes":[{"pos":[0,66],"content":"How to: Secure a Service with Windows Credentials | Microsoft Docs","nodes":[{"content":"How to: Secure a Service with Windows Credentials | Microsoft Docs","pos":[0,66]}]}],"path":["title"]}],"yml":true},{"pos":[430,479],"content":"How to: Secure a Service with Windows Credentials","linkify":"How to: Secure a Service with Windows Credentials","nodes":[{"content":"How to: Secure a Service with Windows Credentials","pos":[0,49]}]},{"content":"This topic shows how to enable transfer security on a <ph id=\"ph1\">[!INCLUDE[indigo1](../../../includes/indigo1-md.md)]</ph> service that resides in a Windows domain and is called by clients in the same domain.","pos":[480,672],"source":"This topic shows how to enable transfer security on a [!INCLUDE[indigo1](../../../includes/indigo1-md.md)] service that resides in a Windows domain and is called by clients in the same domain."},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../includes/crabout-md.md)]</ph> this scenario, see <bpt id=\"p1\">[</bpt>Transport Security with Windows Authentication<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/transport-security-with-windows-authentication.md)</ept>.","pos":[673,889],"source":"[!INCLUDE[crabout](../../../includes/crabout-md.md)] this scenario, see [Transport Security with Windows Authentication](../../../docs/framework/wcf/feature-details/transport-security-with-windows-authentication.md)."},{"content":"For a sample application, see the <bpt id=\"p1\">[</bpt>WSHttpBinding<ept id=\"p1\">](../../../docs/framework/wcf/samples/wshttpbinding.md)</ept> sample.","pos":[890,1001],"source":" For a sample application, see the [WSHttpBinding](../../../docs/framework/wcf/samples/wshttpbinding.md) sample."},{"content":"This topic assumes you have an existing contract interface and implementation already defined, and adds on to that.","pos":[1008,1123]},{"content":"You can also modify an existing service and client.","pos":[1124,1175]},{"content":"You can secure a service with Windows credentials completely in code.","pos":[1182,1251]},{"content":"Alternatively, you can omit some of the code by using a configuration file.","pos":[1252,1327]},{"content":"This topic shows both ways.","pos":[1328,1355]},{"content":"Be sure you only use one of the ways, not both.","pos":[1356,1403]},{"content":"The first three procedures show how to secure the service using code.","pos":[1410,1479]},{"content":"The fourth and fifth procedure shows how to do it with a configuration file.","pos":[1480,1556]},{"pos":[1565,1575],"content":"Using Code","linkify":"Using Code","nodes":[{"content":"Using Code","pos":[0,10]}]},{"content":"The complete code for the service and the client is in the Example section at the end of this topic.","pos":[1579,1679]},{"content":"The first procedure walks through creating and configuring a <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> class in code.","pos":[1686,1802],"source":"The first procedure walks through creating and configuring a <xref:System.ServiceModel.WSHttpBinding> class in code."},{"content":"The binding uses the HTTP transport.","pos":[1803,1839]},{"content":"The same binding is used on the client.","pos":[1840,1879]},{"pos":[1890,1966],"content":"To create a WSHttpBinding that uses Windows credentials and message security","linkify":"To create a WSHttpBinding that uses Windows credentials and message security","nodes":[{"content":"To create a WSHttpBinding that uses Windows credentials and message security","pos":[0,76]}]},{"pos":[1976,2110],"content":"This procedure's code is inserted at the beginning of the <ph id=\"ph1\">`Run`</ph> method of the <ph id=\"ph2\">`Test`</ph> class in the service code in the Example section.","source":"This procedure's code is inserted at the beginning of the `Run` method of the `Test` class in the service code in the Example section."},{"content":"Create an instance of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> class.","pos":[2120,2193],"source":"Create an instance of the <xref:System.ServiceModel.WSHttpBinding> class."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpSecurity.Mode%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.ServiceModel.WSHttpSecurity&gt;</ph> class to <ph id=\"ph3\">&lt;xref:System.ServiceModel.SecurityMode&gt;</ph>.","pos":[2203,2368],"source":"Set the <xref:System.ServiceModel.WSHttpSecurity.Mode%2A> property of the <xref:System.ServiceModel.WSHttpSecurity> class to <xref:System.ServiceModel.SecurityMode>."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.ServiceModel.MessageSecurityOverHttp.ClientCredentialType%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.ServiceModel.MessageSecurityOverHttp&gt;</ph> class to <ph id=\"ph3\">&lt;xref:System.ServiceModel.MessageCredentialType&gt;</ph>.","pos":[2378,2586],"source":"Set the <xref:System.ServiceModel.MessageSecurityOverHttp.ClientCredentialType%2A> property of the <xref:System.ServiceModel.MessageSecurityOverHttp> class to <xref:System.ServiceModel.MessageCredentialType>."},{"content":"The code for this procedure is as follows:","pos":[2596,2638]},{"pos":[2649,2926],"content":"[!code-csharp[c_SecureWindowsService#1](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsservice/cs/secureservice.cs#1)]\n [!code-vb[c_SecureWindowsService#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsservice/vb/secureservice.vb#1)]","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>c_SecureWindowsService#1<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsservice/cs/secureservice.cs#1)</ept><ept id=\"p1\">]</ept>","pos":[0,135],"source":"[!code-csharp[c_SecureWindowsService#1](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsservice/cs/secureservice.cs#1)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>c_SecureWindowsService#1<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsservice/vb/secureservice.vb#1)</ept><ept id=\"p1\">]</ept>","pos":[137,273],"source":"[!code-vb[c_SecureWindowsService#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsservice/vb/secureservice.vb#1)]"}]},{"pos":[2936,2966],"content":"Using the Binding in a Service","linkify":"Using the Binding in a Service","nodes":[{"content":"Using the Binding in a Service","pos":[0,30]}]},{"content":"This is the second procedure, which shows how to use the binding in a self-hosted service.","pos":[2970,3060]},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../includes/crabout-md.md)]</ph> hosting services see <bpt id=\"p1\">[</bpt>Hosting Services<ept id=\"p1\">](../../../docs/framework/wcf/hosting-services.md)</ept>.","pos":[3061,3203],"source":"[!INCLUDE[crabout](../../../includes/crabout-md.md)] hosting services see [Hosting Services](../../../docs/framework/wcf/hosting-services.md)."},{"pos":[3215,3244],"content":"To use a binding in a service","linkify":"To use a binding in a service","nodes":[{"content":"To use a binding in a service","pos":[0,29]}]},{"content":"Insert this procedure's code after the code from the preceding procedure.","pos":[3254,3327]},{"content":"Create a <ph id=\"ph1\">&lt;xref:System.Type&gt;</ph> variable named <ph id=\"ph2\">`contractType`</ph> and assign it the type of the interface (<ph id=\"ph3\">`ICalculator`</ph>).","pos":[3337,3451],"source":"Create a <xref:System.Type> variable named `contractType` and assign it the type of the interface (`ICalculator`)."},{"content":"When using <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)]</ph>, use the <ph id=\"ph2\">`GetType`</ph> operator; when using C#, use the <ph id=\"ph3\">`typeof`</ph> keyword.","pos":[3452,3583],"source":" When using [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)], use the `GetType` operator; when using C#, use the `typeof` keyword."},{"pos":[3593,3711],"content":"Create a second <ph id=\"ph1\">`Type`</ph> variable named <ph id=\"ph2\">`serviceType`</ph> and assign it the type of the implemented contract (<ph id=\"ph3\">`Calculator`</ph>).","source":"Create a second `Type` variable named `serviceType` and assign it the type of the implemented contract (`Calculator`)."},{"content":"Create an instance of the <ph id=\"ph1\">&lt;xref:System.Uri&gt;</ph> class named <ph id=\"ph2\">`baseAddress`</ph> with the base address of the service.","pos":[3721,3828],"source":"Create an instance of the <xref:System.Uri> class named `baseAddress` with the base address of the service."},{"content":"The base address must have a scheme that matches the transport.","pos":[3829,3892]},{"content":"In this case, the transport scheme is HTTP, and the address includes the special Uniform Resource Identifier (URI) \"localhost\" and a port number (8036) as well as a base endpoint address (\"serviceModelSamples/): http://localhost:8036/serviceModelSamples/.","pos":[3893,4148]},{"pos":[4158,4280],"content":"Create an instance of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ServiceHost&gt;</ph> class with the <ph id=\"ph2\">`serviceType`</ph> and <ph id=\"ph3\">`baseAddress`</ph> variables.","source":"Create an instance of the <xref:System.ServiceModel.ServiceHost> class with the `serviceType` and `baseAddress` variables."},{"content":"Add an endpoint to the service using the <ph id=\"ph1\">`contractType`</ph>, binding, and an endpoint name (secureCalculator).","pos":[4290,4396],"source":"Add an endpoint to the service using the `contractType`, binding, and an endpoint name (secureCalculator)."},{"content":"A client must concatenate the base address and the endpoint name when initiating a call to the service.","pos":[4397,4500]},{"content":"Call the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.CommunicationObject.Open%2A&gt;</ph> method to start the service.","pos":[4510,4611],"source":"Call the <xref:System.ServiceModel.Channels.CommunicationObject.Open%2A> method to start the service."},{"content":"The code for this procedure is shown here:","pos":[4612,4654]},{"pos":[4665,4942],"content":"[!code-csharp[c_SecureWindowsService#2](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsservice/cs/secureservice.cs#2)]\n [!code-vb[c_SecureWindowsService#2](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsservice/vb/secureservice.vb#2)]","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>c_SecureWindowsService#2<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsservice/cs/secureservice.cs#2)</ept><ept id=\"p1\">]</ept>","pos":[0,135],"source":"[!code-csharp[c_SecureWindowsService#2](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsservice/cs/secureservice.cs#2)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>c_SecureWindowsService#2<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsservice/vb/secureservice.vb#2)</ept><ept id=\"p1\">]</ept>","pos":[137,273],"source":"[!code-vb[c_SecureWindowsService#2](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsservice/vb/secureservice.vb#2)]"}]},{"pos":[4952,4981],"content":"Using the Binding in a Client","linkify":"Using the Binding in a Client","nodes":[{"content":"Using the Binding in a Client","pos":[0,29]}]},{"content":"This procedure shows how to generate a proxy that communicates with the service.","pos":[4985,5065]},{"content":"The proxy is generated with the <bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept> which uses the service metadata to create the proxy.","pos":[5066,5280],"source":" The proxy is generated with the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) which uses the service metadata to create the proxy."},{"content":"This procedure also creates an instance of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> class to communicate with the service, and then calls the service.","pos":[5287,5441],"source":"This procedure also creates an instance of the <xref:System.ServiceModel.WSHttpBinding> class to communicate with the service, and then calls the service."},{"content":"This example uses only code to create the client.","pos":[5448,5497]},{"content":"As an alternative, you can use a configuration file, which is shown in the section following this procedure.","pos":[5498,5606]},{"pos":[5618,5656],"content":"To use a binding in a client with code","linkify":"To use a binding in a client with code","nodes":[{"content":"To use a binding in a client with code","pos":[0,38]}]},{"content":"Use the SvcUtil.exe tool to generate the proxy code from the service's metadata.","pos":[5666,5746]},{"content":"<ph id=\"ph1\">[!INCLUDE[crdefault](../../../includes/crdefault-md.md)]</ph> <bpt id=\"p1\">[</bpt>How to: Create a Client<ept id=\"p1\">](../../../docs/framework/wcf/how-to-create-a-wcf-client.md)</ept>.","pos":[5747,5889],"source":"[!INCLUDE[crdefault](../../../includes/crdefault-md.md)] [How to: Create a Client](../../../docs/framework/wcf/how-to-create-a-wcf-client.md)."},{"content":"The generated proxy code inherits from the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ClientBase%601&gt;</ph> class, which ensures that every client has the necessary constructors, methods, and properties to communicate with a <ph id=\"ph2\">[!INCLUDE[indigo2](../../../includes/indigo2-md.md)]</ph> service.","pos":[5890,6153],"source":" The generated proxy code inherits from the <xref:System.ServiceModel.ClientBase%601> class, which ensures that every client has the necessary constructors, methods, and properties to communicate with a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service."},{"content":"In this example, the generated code includes the <ph id=\"ph1\">`CalculatorClient`</ph> class, which implements the <ph id=\"ph2\">`ICalculator`</ph> interface, enabling compatibility with the service code.","pos":[6154,6320],"source":" In this example, the generated code includes the `CalculatorClient` class, which implements the `ICalculator` interface, enabling compatibility with the service code."},{"pos":[6330,6424],"content":"This procedure's code is inserted at the beginning of the <ph id=\"ph1\">`Main`</ph> method of the client program.","source":"This procedure's code is inserted at the beginning of the `Main` method of the client program."},{"content":"Create an instance of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> class and set its security mode to <ph id=\"ph2\">`Message`</ph> and its client credential type to <ph id=\"ph3\">`Windows`</ph>.","pos":[6434,6590],"source":"Create an instance of the <xref:System.ServiceModel.WSHttpBinding> class and set its security mode to `Message` and its client credential type to `Windows`."},{"content":"The example names the variable <ph id=\"ph1\">`clientBinding`</ph>.","pos":[6591,6638],"source":" The example names the variable `clientBinding`."},{"content":"Create an instance of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.EndpointAddress&gt;</ph> class named <ph id=\"ph2\">`serviceAddress`</ph>.","pos":[6648,6746],"source":"Create an instance of the <xref:System.ServiceModel.EndpointAddress> class named `serviceAddress`."},{"content":"Initialize the instance with the base address concatenated with the endpoint name.","pos":[6747,6829]},{"pos":[6839,6948],"content":"Create an instance of the generated client class with the <ph id=\"ph1\">`serviceAddress`</ph> and the <ph id=\"ph2\">`clientBinding`</ph> variables.","source":"Create an instance of the generated client class with the `serviceAddress` and the `clientBinding` variables."},{"content":"Call the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ClientBase%601.Open%2A&gt;</ph> method, as shown in the following code.","pos":[6958,7056],"source":"Call the <xref:System.ServiceModel.ClientBase%601.Open%2A> method, as shown in the following code."},{"content":"Call the service and display the results.","pos":[7066,7107]},{"pos":[7118,7389],"content":"[!code-csharp[c_secureWindowsClient#1](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsclient/cs/secureclient.cs#1)]\n [!code-vb[c_secureWindowsClient#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsclient/vb/secureclient.vb#1)]","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>c_secureWindowsClient#1<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsclient/cs/secureclient.cs#1)</ept><ept id=\"p1\">]</ept>","pos":[0,132],"source":"[!code-csharp[c_secureWindowsClient#1](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsclient/cs/secureclient.cs#1)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>c_secureWindowsClient#1<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsclient/vb/secureclient.vb#1)</ept><ept id=\"p1\">]</ept>","pos":[134,267],"source":"[!code-vb[c_secureWindowsClient#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsclient/vb/secureclient.vb#1)]"}]},{"pos":[7398,7426],"content":"Using the Configuration File","linkify":"Using the Configuration File","nodes":[{"content":"Using the Configuration File","pos":[0,28]}]},{"content":"Instead of creating the binding with procedural code, you can use the following code shown for the bindings section of the configuration file.","pos":[7430,7572]},{"pos":[7579,7816],"content":"If you do not already have a service defined, see <bpt id=\"p1\">[</bpt>Designing and Implementing Services<ept id=\"p1\">](../../../docs/framework/wcf/designing-and-implementing-services.md)</ept>, and <bpt id=\"p2\">[</bpt>Configuring Services<ept id=\"p2\">](../../../docs/framework/wcf/configuring-services.md)</ept>.","source":"If you do not already have a service defined, see [Designing and Implementing Services](../../../docs/framework/wcf/designing-and-implementing-services.md), and [Configuring Services](../../../docs/framework/wcf/configuring-services.md)."},{"pos":[7823,7915],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> This configuration code is used in both the service and client configuration files.","source":"**Note** This configuration code is used in both the service and client configuration files."},{"pos":[7926,8006],"content":"To enable transfer security on a service in a Windows domain using configuration","linkify":"To enable transfer security on a service in a Windows domain using configuration","nodes":[{"content":"To enable transfer security on a service in a Windows domain using configuration","pos":[0,80]}]},{"pos":[8016,8253],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>wsHttpBinding&gt;<ept id=\"p1\">](../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md)</ept> element to the <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>bindings&gt;<ept id=\"p2\">](../../../docs/framework/configure-apps/file-schema/wcf/bindings.md)</ept> element section of the configuration file.","source":"Add a [\\<wsHttpBinding>](../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md) element to the [\\<bindings>](../../../docs/framework/configure-apps/file-schema/wcf/bindings.md) element section of the configuration file."},{"pos":[8263,8407],"content":"Add a &lt;<ph id=\"ph1\">`binding`</ph>&gt; element to the &lt;<ph id=\"ph2\">`WSHttpBinding`</ph>&gt; element and set the <ph id=\"ph3\">`configurationName`</ph> attribute to a value appropriate to your application.","source":"Add a <`binding`> element to the <`WSHttpBinding`> element and set the `configurationName` attribute to a value appropriate to your application."},{"pos":[8417,8484],"content":"Add a &lt;<ph id=\"ph1\">`security`</ph>&gt; element and set the <ph id=\"ph2\">`mode`</ph> attribute to Message.","source":"Add a <`security`> element and set the `mode` attribute to Message."},{"pos":[8494,8576],"content":"Add a &lt;<ph id=\"ph1\">`message`</ph>&gt; element and set the <ph id=\"ph2\">`clientCredentialType`</ph> attribute to Windows.","source":"Add a <`message`> element and set the `clientCredentialType` attribute to Windows."},{"content":"In the service's configuration file, replace the <ph id=\"ph1\">`&lt;bindings&gt;`</ph> section with the following code.","pos":[8586,8680],"source":"In the service's configuration file, replace the `<bindings>` section with the following code."},{"content":"If you do not already have a service configuration file, see <bpt id=\"p1\">[</bpt>Using Bindings to Configure Services and Clients<ept id=\"p1\">](../../../docs/framework/wcf/using-bindings-to-configure-services-and-clients.md)</ept>.","pos":[8681,8874],"source":" If you do not already have a service configuration file, see [Using Bindings to Configure Services and Clients](../../../docs/framework/wcf/using-bindings-to-configure-services-and-clients.md)."},{"pos":[9180,9209],"content":"Using the Binding in a Client","linkify":"Using the Binding in a Client","nodes":[{"content":"Using the Binding in a Client","pos":[0,29]}]},{"content":"This procedure shows how to generate two files: a proxy that communicates with the service and a configuration file.","pos":[9213,9329]},{"content":"It also describes changes to the client program, which is the third file used on the client.","pos":[9330,9422]},{"pos":[9434,9481],"content":"To use a binding in a client with configuration","linkify":"To use a binding in a client with configuration","nodes":[{"content":"To use a binding in a client with configuration","pos":[0,47]}]},{"content":"Use the SvcUtil.exe tool to generate the proxy code and configuration file from the service's metadata.","pos":[9491,9594]},{"content":"<ph id=\"ph1\">[!INCLUDE[crdefault](../../../includes/crdefault-md.md)]</ph><bpt id=\"p1\">[</bpt>How to: Create a Client<ept id=\"p1\">](../../../docs/framework/wcf/how-to-create-a-wcf-client.md)</ept>.","pos":[9595,9736],"source":"[!INCLUDE[crdefault](../../../includes/crdefault-md.md)][How to: Create a Client](../../../docs/framework/wcf/how-to-create-a-wcf-client.md)."},{"pos":[9746,9939],"content":"Replace the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>bindings&gt;<ept id=\"p1\">](../../../docs/framework/configure-apps/file-schema/wcf/bindings.md)</ept> section of the generated configuration file with the configuration code from the preceding section.","source":"Replace the [\\<bindings>](../../../docs/framework/configure-apps/file-schema/wcf/bindings.md) section of the generated configuration file with the configuration code from the preceding section."},{"pos":[9949,10037],"content":"Procedural code is inserted at the beginning of the <ph id=\"ph1\">`Main`</ph> method of the client program.","source":"Procedural code is inserted at the beginning of the `Main` method of the client program."},{"content":"Create an instance of the generated client class passing the name of the binding in the configuration file as an input parameter.","pos":[10047,10176]},{"content":"Call the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ClientBase%601.Open%2A&gt;</ph> method, as shown in the following code.","pos":[10186,10284],"source":"Call the <xref:System.ServiceModel.ClientBase%601.Open%2A> method, as shown in the following code."},{"content":"Call the service and display the results.","pos":[10294,10335]},{"pos":[10346,10478],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>c_secureWindowsClient#2<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsclient/cs/secureclient.cs#2)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[c_secureWindowsClient#2](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsclient/cs/secureclient.cs#2)]"},{"pos":[10487,10494],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[10498,10633],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>c_SecureWindowsService#0<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsservice/cs/secureservice.cs#0)</ept><ept id=\"p1\">]</ept>","source":"[!code-csharp[c_SecureWindowsService#0](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsservice/cs/secureservice.cs#0)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>c_SecureWindowsClient#0<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsclient/cs/secureclient.cs#0)</ept><ept id=\"p1\">]</ept>","pos":[10640,10772],"source":"[!code-csharp[c_SecureWindowsClient#0](../../../samples/snippets/csharp/VS_Snippets_CFX/c_securewindowsclient/cs/secureclient.cs#0)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>c_SecureWindowsClient#0<ept id=\"p2\">](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsclient/vb/secureclient.vb#0)</ept><ept id=\"p1\">]</ept>","pos":[10775,10908],"source":"[!code-vb[c_SecureWindowsClient#0](../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_securewindowsclient/vb/secureclient.vb#0)]"},{"pos":[10921,10929],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph>","pos":[10933,10973],"source":"<xref:System.ServiceModel.WSHttpBinding> "},{"content":"<bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept><ph id=\"ph1\"> </ph>","pos":[10978,11108],"source":"[ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Create a Client<ept id=\"p1\">](../../../docs/framework/wcf/how-to-create-a-wcf-client.md)</ept><ph id=\"ph1\"> </ph>","pos":[11112,11197],"source":"[How to: Create a Client](../../../docs/framework/wcf/how-to-create-a-wcf-client.md) "},{"content":"<bpt id=\"p1\">[</bpt>Securing Services<ept id=\"p1\">](../../../docs/framework/wcf/securing-services.md)</ept><ph id=\"ph1\"> </ph>","pos":[11201,11271],"source":"[Securing Services](../../../docs/framework/wcf/securing-services.md) "},{"content":"<bpt id=\"p1\">[</bpt>Security Overview<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/security-overview.md)</ept>","pos":[11275,11360],"source":"[Security Overview](../../../docs/framework/wcf/feature-details/security-overview.md)"}]}