{"content":"---\ntitle: \"For Each...Next Statement (Visual Basic) | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.ForEach\"\n  - \"vb.ForEachNext\"\n  - \"vb.Each\"\n  - \"ForEachNext\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"infinite loops\"\n  - \"Next statement, For Each...Next\"\n  - \"endless loops\"\n  - \"loop structures, For Each...Next\"\n  - \"loops, endless\"\n  - \"Each keyword\"\n  - \"instructions, repeating\"\n  - \"For Each statement\"\n  - \"collections, instruction repetition\"\n  - \"loops, infinite\"\n  - \"For Each...Next statements\"\n  - \"For keyword [Visual Basic], For Each...Next statements\"\n  - \"Exit statement, For Each...Next statements\"\n  - \"iteration\"\nms.assetid: ebce3120-95c3-42b1-b70b-fa7da40c75e2\ncaps.latest.revision: 56\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# For Each...Next Statement (Visual Basic)\nRepeats a group of statements for each element in a collection.  \n  \n## Syntax  \n  \n```  \nFor Each element [ As datatype ] In group  \n    [ statements ]  \n    [ Continue For ]  \n    [ statements ]  \n    [ Exit For ]  \n    [ statements ]  \nNext [ element ]  \n```  \n  \n## Parts  \n  \n|Term|Definition|  \n|---|---|  \n|`element`|Required in the `For Each` statement. Optional in the `Next` statement. Variable. Used to iterate through the elements of the collection.|  \n|`datatype`|Required if `element` isn't already declared. Data type of `element`.|  \n|`group`|Required. A variable with a type that's a collection type or Object. Refers to the collection over which the `statements` are to be repeated.|  \n|`statements`|Optional. One or more statements between `For Each` and `Next` that run on each item in `group`.|  \n|`Continue For`|Optional. Transfers control to the start of the `For Each` loop.|  \n|`Exit For`|Optional. Transfers control out of the `For Each` loop.|  \n|`Next`|Required. Terminates the definition of the `For Each` loop.|  \n  \n## Simple Example  \n Use a `For Each`...`Next` loop when you want to repeat a set of statements for each element of a collection or array.  \n  \n> [!TIP]\n>  A [For...Next Statement](../../../visual-basic/language-reference/statements/for-next-statement.md) works well when you can associate each iteration of a loop with a control variable and determine that variable's initial and final values. However, when you are dealing with a collection, the concept of initial and final values isn't meaningful, and you don't necessarily know how many elements the collection has. In this kind of case, a `For Each`...`Next` loop is often a better choice.  \n  \n In the following example, the `For Each`…`Next` statement iterates through all the elements of a List collection.  \n  \n [!code-vb[VbVbalrStatements#121](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_1.vb)]  \n  \n For more examples, see [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b) and [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md).  \n  \n## Nested Loops  \n You can nest `For Each` loops by putting one loop within another.  \n  \n The following example demonstrates nested `For Each`…`Next` structures.  \n  \n [!code-vb[VbVbalrStatements#122](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_2.vb)]  \n  \n When you nest loops, each loop must have a unique `element` variable.  \n  \n You can also nest different kinds of control structures within each other. For more information, see [Nested Control Structures](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md).  \n  \n## Exit For and Continue For  \n The [Exit For](../../../visual-basic/language-reference/statements/exit-statement.md) statement causes execution to exit the `For`…`Next` loop and transfers control to the statement that follows the `Next` statement.  \n  \n The `Continue For` statement transfers control immediately to the next iteration of the loop. For more information, see [Continue Statement](../../../visual-basic/language-reference/statements/continue-statement.md).  \n  \n The following example shows how to use the `Continue For` and `Exit For` statements.  \n  \n [!code-vb[VbVbalrStatements#123](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_3.vb)]  \n  \n You can put any number of `Exit For` statements in a `For Each` loop. When used within nested `For Each` loops, `Exit For` causes execution to exit the innermost loop and transfers control to the next higher level of nesting.  \n  \n `Exit For` is often used after an evaluation of some condition, for example, in an `If`...`Then`...`Else` structure. You might want to use `Exit For` for the following conditions:  \n  \n-   Continuing to iterate is unnecessary or impossible. This might be caused by an erroneous value or a termination request.  \n  \n-   An exception is caught in a `Try`...`Catch`...`Finally`. You might use `Exit For` at the end of the `Finally` block.  \n  \n-   There an endless loop, which is a loop that could run a large or even infinite number of times. If you detect such a condition, you can use `Exit For` to escape the loop. For more information, see [Do...Loop Statement](../../../visual-basic/language-reference/statements/do-loop-statement.md).  \n  \n## Iterators  \n You use an *iterator* to perform a custom iteration over a collection. An iterator can be a function or a `Get` accessor. It uses a `Yield` statement to return each element of the collection one at a time.  \n  \n You call an iterator by using a `For Each...Next` statement. Each iteration of the `For Each` loop calls the iterator. When a `Yield` statement is reached in the iterator, the expression in the `Yield` statement is returned, and the current location in code is retained. Execution is restarted from that location the next time that the iterator is called.  \n  \n The following example uses an iterator function. The iterator function has a `Yield` statement that's inside a [For…Next](../../../visual-basic/language-reference/statements/for-next-statement.md) loop. In the `ListEvenNumbers` method, each iteration of the `For Each` statement body creates a call to the iterator function, which proceeds to the next `Yield` statement.  \n  \n [!code-vb[VbVbalrStatements#127](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_4.vb)]  \n  \n For more information, see [Iterators](http://msdn.microsoft.com/library/f45331db-d595-46ec-9142-551d3d1eb1a7), [Yield Statement](../../../visual-basic/language-reference/statements/yield-statement.md), and [Iterator](../../../visual-basic/language-reference/modifiers/iterator.md).  \n  \n## Technical Implementation  \n When a `For Each`…`Next` statement runs, Visual Basic evaluates the collection only one time, before the loop starts. If your statement block changes `element` or `group`, these changes don't affect the iteration of the loop.  \n  \n When all the elements in the collection have been successively assigned to `element`, the `For Each` loop stops and control passes to the statement following the `Next` statement.  \n  \n If `element` hasn't been declared outside this loop, you must declare it in the `For Each` statement. You can declare the type of `element` explicitly by using an `As` statement, or you can rely on type inference to assign the type. In either case, the scope of `element` is the body of the loop. However, you cannot declare `element` both outside and inside the loop.  \n  \n You can optionally specify `element` in the `Next` statement. This improves the readability of your program, especially if you have nested `For Each` loops. You must specify the same variable as the one that appears in the corresponding `For Each` statement.  \n  \n You might want to avoid changing the value of `element` inside a loop. Doing this can make it more difficult to read and debug your code. Changing the value of `group` doesn't affect the collection or its elements, which were determined when the loop was first entered.  \n  \n When you're nesting loops, if a `Next` statement of an outer nesting level is encountered before the `Next` of an inner level, the compiler signals an error. However, the compiler can detect this overlapping error only if you specify `element` in every `Next` statement.  \n  \n If your code depends on traversing a collection in a particular order, a `For Each`...`Next` loop isn't the best choice, unless you know the characteristics of the enumerator object the collection exposes. The order of traversal isn't determined by Visual Basic, but by the <xref:System.Collections.IEnumerator.MoveNext%2A> method of the enumerator object. Therefore, you might not be able to predict which element of the collection is the first to be returned in `element`, or which is the next to be returned after a given element. You might achieve more reliable results using a different loop structure, such as `For`...`Next` or `Do`...`Loop`.  \n  \n The data type of `element` must be such that the data type of the elements of `group` can be converted to it.  \n  \n The data type of `group` must be a reference type that refers to a collection or an array that's enumerable. Most commonly this means that `group` refers to an object that implements the <xref:System.Collections.IEnumerable> interface of the `System.Collections` namespace or the <xref:System.Collections.Generic.IEnumerable%601> interface of the `System.Collections.Generic` namespace. `System.Collections.IEnumerable` defines the <xref:System.Collections.IEnumerable.GetEnumerator%2A> method, which returns an enumerator object for the collection. The enumerator object implements the `System.Collections.IEnumerator` interface of the `System.Collections` namespace and exposes the <xref:System.Collections.IEnumerator.Current%2A> property and the <xref:System.Collections.IEnumerator.Reset%2A> and <xref:System.Collections.IEnumerator.MoveNext%2A> methods. Visual Basic uses these to traverse the collection.  \n  \n### Narrowing Conversions  \n When `Option Strict` is set to `On`, narrowing conversions ordinarily cause compiler errors. In a `For Each` statement, however, conversions from the elements in `group` to `element` are evaluated and performed at run time, and compiler errors caused by narrowing conversions are suppressed.  \n  \n In the following example, the assignment of `m` as the initial value for `n` doesn't compile when `Option Strict` is on because the conversion of a `Long` to an `Integer` is a narrowing conversion. In the `For Each` statement, however, no compiler error is reported, even though the assignment to `number` requires the same conversion from `Long` to `Integer`. In the `For Each` statement that contains a large number, a run-time error occurs when <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> is applied to the large number.  \n  \n [!code-vb[VbVbalrStatements#89](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_5.vb)]  \n  \n### IEnumerator Calls  \n When execution of a `For Each`...`Next` loop starts, Visual Basic verifies that `group` refers to a valid collection object. If not, it throws an exception. Otherwise, it calls the <xref:System.Collections.IEnumerator.MoveNext%2A> method and the <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object to return the first element. If `MoveNext` indicates that there is no next element, that is, if the collection is empty, the `For Each` loop stops and control passes to the statement following the `Next` statement. Otherwise, Visual Basic sets `element` to the first element and runs the statement block.  \n  \n Each time Visual Basic encounters the `Next` statement, it returns to the `For Each` statement. Again it calls `MoveNext` and `Current` to return the next element, and again it either runs the block or stops the loop depending on the result. This process continues until `MoveNext` indicates that there is no next element or an `Exit For` statement is encountered.  \n  \n **Modifying the Collection.** The enumerator object returned by <xref:System.Collections.IEnumerable.GetEnumerator%2A> normally doesn't let you change the collection by adding, deleting, replacing, or reordering any elements. If you change the collection after you have initiated a `For Each`...`Next` loop, the enumerator object becomes invalid, and the next attempt to access an element causes an <xref:System.InvalidOperationException> exception.  \n  \n However, this blocking of modification isn't determined by [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)], but rather by the implementation of the <xref:System.Collections.IEnumerable> interface. It is possible to implement `IEnumerable` in a way that allows for modification during iteration. If you are considering doing such dynamic modification, make sure that you understand the characteristics of the `IEnumerable` implementation on the collection you are using.  \n  \n **Modifying Collection Elements.** The <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object is [ReadOnly](../../../visual-basic/language-reference/modifiers/readonly.md), and it returns a local copy of each collection element. This means that you cannot modify the elements themselves in a `For Each`...`Next` loop. Any modification you make affects only the local copy from `Current` and isn't reflected back into the underlying collection. However, if an element is a reference type, you can modify the members of the instance to which it points. The following example modifies the `BackColor` member of each `thisControl` element. You cannot, however, modify `thisControl` itself.  \n  \n```vb  \nSub lightBlueBackground(ByVal thisForm As System.Windows.Forms.Form)  \n    For Each thisControl As System.Windows.Forms.Control In thisForm.Controls  \n        thisControl.BackColor = System.Drawing.Color.LightBlue  \n    Next thisControl  \nEnd Sub  \n```  \n  \n The previous example can modify the `BackColor` member of each `thisControl` element, although it cannot modify `thisControl` itself.  \n  \n **Traversing Arrays.** Because the <xref:System.Array> class implements the <xref:System.Collections.IEnumerable> interface, all arrays expose the <xref:System.Array.GetEnumerator%2A> method. This means that you can iterate through an array with a `For Each`...`Next` loop. However, you can only read the array elements. You cannot change them.  \n  \n## Example  \n The following example lists all the folders in the C:\\ directory by using the <xref:System.IO.DirectoryInfo> class.  \n  \n [!code-vb[VbVbalrStatements#124](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_6.vb)]  \n  \n## Example  \n The following example illustrates a procedure for sorting a collection. The example sorts instances of a `Car` class that are stored in a <xref:System.Collections.Generic.List%601>. The `Car` class implements the <xref:System.IComparable%601> interface, which requires that the <xref:System.IComparable%601.CompareTo%2A> method be implemented.  \n  \n Each call to the <xref:System.IComparable%601.CompareTo%2A> method makes a single comparison that's used for sorting. User-written code in the `CompareTo` method returns a value for each comparison of the current object with another object. The value returned is less than zero if the current object is less than the other object, greater than zero if the current object is greater than the other object, and zero if they are equal. This enables you to define in code the criteria for greater than, less than, and equal.  \n  \n In the `ListCars` method, the `cars.Sort()` statement sorts the list. This call to the <xref:System.Collections.Generic.List%601.Sort%2A> method of the <xref:System.Collections.Generic.List%601> causes the `CompareTo` method to be called automatically for the `Car` objects in the `List`.  \n  \n [!code-vb[VbVbalrStatements#125](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_7.vb)]  \n  \n## See Also  \n [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)   \n [For...Next Statement](../../../visual-basic/language-reference/statements/for-next-statement.md)   \n [Loop Structures](../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md)   \n [While...End While Statement](../../../visual-basic/language-reference/statements/while-end-while-statement.md)   \n [Do...Loop Statement](../../../visual-basic/language-reference/statements/do-loop-statement.md)   \n [Widening and Narrowing Conversions](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)   \n [Object Initializers: Named and Anonymous Types](../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)   \n [Collection Initializers](../../../visual-basic/programming-guide/language-features/collection-initializers/index.md)   \n [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md)\n","nodes":[{"pos":[12,69],"content":"For Each...Next Statement (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"For Each...Next Statement (Visual Basic) | Microsoft Docs","pos":[0,57]}]},{"pos":[1097,1137],"content":"For Each...Next Statement (Visual Basic)","linkify":"For Each...Next Statement (Visual Basic)","nodes":[{"content":"For Each...Next Statement (Visual Basic)","pos":[0,40]}]},{"content":"Repeats a group of statements for each element in a collection.","pos":[1138,1201]},{"pos":[1210,1216],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1408,1413],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"content":"Term","pos":[1420,1424]},{"content":"Definition","pos":[1425,1435]},{"content":"Required in the <ph id=\"ph1\">`For Each`</ph> statement.","pos":[1462,1499],"source":"Required in the `For Each` statement."},{"content":"Optional in the <ph id=\"ph1\">`Next`</ph> statement.","pos":[1500,1533],"source":" Optional in the `Next` statement."},{"content":"Variable.","pos":[1534,1543]},{"content":"Used to iterate through the elements of the collection.","pos":[1544,1599]},{"content":"Required if <ph id=\"ph1\">`element`</ph> isn't already declared.","pos":[1615,1660],"source":"Required if `element` isn't already declared."},{"content":"Data type of <ph id=\"ph1\">`element`</ph>.","pos":[1661,1684],"source":" Data type of `element`."},{"content":"Required.","pos":[1697,1706]},{"content":"A variable with a type that's a collection type or Object.","pos":[1707,1765]},{"content":"Refers to the collection over which the <ph id=\"ph1\">`statements`</ph> are to be repeated.","pos":[1766,1838],"source":" Refers to the collection over which the `statements` are to be repeated."},{"content":"Optional.","pos":[1856,1865]},{"content":"One or more statements between <ph id=\"ph1\">`For Each`</ph> and <ph id=\"ph2\">`Next`</ph> that run on each item in <ph id=\"ph3\">`group`</ph>.","pos":[1866,1952],"source":" One or more statements between `For Each` and `Next` that run on each item in `group`."},{"content":"Optional.","pos":[1972,1981]},{"content":"Transfers control to the start of the <ph id=\"ph1\">`For Each`</ph> loop.","pos":[1982,2036],"source":" Transfers control to the start of the `For Each` loop."},{"content":"Optional.","pos":[2052,2061]},{"content":"Transfers control out of the <ph id=\"ph1\">`For Each`</ph> loop.","pos":[2062,2107],"source":" Transfers control out of the `For Each` loop."},{"content":"Required.","pos":[2119,2128]},{"content":"Terminates the definition of the <ph id=\"ph1\">`For Each`</ph> loop.","pos":[2129,2178],"source":" Terminates the definition of the `For Each` loop."},{"pos":[2188,2202],"content":"Simple Example","linkify":"Simple Example","nodes":[{"content":"Simple Example","pos":[0,14]}]},{"pos":[2206,2323],"content":"Use a <ph id=\"ph1\">`For Each`</ph>...<ph id=\"ph2\">`Next`</ph> loop when you want to repeat a set of statements for each element of a collection or array.","source":"Use a `For Each`...`Next` loop when you want to repeat a set of statements for each element of a collection or array."},{"pos":[2331,2830],"content":"[!TIP]\n A [For...Next Statement](../../../visual-basic/language-reference/statements/for-next-statement.md) works well when you can associate each iteration of a loop with a control variable and determine that variable's initial and final values. However, when you are dealing with a collection, the concept of initial and final values isn't meaningful, and you don't necessarily know how many elements the collection has. In this kind of case, a `For Each`...`Next` loop is often a better choice.","leadings":["","> "],"nodes":[{"content":" A [For...Next Statement](../../../visual-basic/language-reference/statements/for-next-statement.md) works well when you can associate each iteration of a loop with a control variable and determine that variable's initial and final values. However, when you are dealing with a collection, the concept of initial and final values isn't meaningful, and you don't necessarily know how many elements the collection has. In this kind of case, a `For Each`...`Next` loop is often a better choice.","pos":[7,497],"nodes":[{"content":"A <bpt id=\"p1\">[</bpt>For...Next Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/for-next-statement.md)</ept> works well when you can associate each iteration of a loop with a control variable and determine that variable's initial and final values.","pos":[1,239],"source":" A [For...Next Statement](../../../visual-basic/language-reference/statements/for-next-statement.md) works well when you can associate each iteration of a loop with a control variable and determine that variable's initial and final values."},{"content":"However, when you are dealing with a collection, the concept of initial and final values isn't meaningful, and you don't necessarily know how many elements the collection has.","pos":[240,415]},{"content":"In this kind of case, a <ph id=\"ph1\">`For Each`</ph>...<ph id=\"ph2\">`Next`</ph> loop is often a better choice.","pos":[416,490],"source":" In this kind of case, a `For Each`...`Next` loop is often a better choice."}]}]},{"content":"In the following example, the <ph id=\"ph1\">`For Each`</ph>…<ph id=\"ph2\">`Next`</ph>","pos":[2837,2884],"source":"In the following example, the `For Each`…`Next`"},{"content":"statement iterates through all the elements of a List collection.","pos":[2885,2950]},{"pos":[2957,3100],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrStatements#121<ept id=\"p2\">](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrStatements#121](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_1.vb)]"},{"pos":[3107,3304],"content":"For more examples, see <bpt id=\"p1\">[</bpt>Collections<ept id=\"p1\">](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)</ept> and <bpt id=\"p2\">[</bpt>Arrays<ept id=\"p2\">](../../../visual-basic/programming-guide/language-features/arrays/index.md)</ept>.","source":"For more examples, see [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b) and [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md)."},{"pos":[3313,3325],"content":"Nested Loops","linkify":"Nested Loops","nodes":[{"content":"Nested Loops","pos":[0,12]}]},{"pos":[3329,3394],"content":"You can nest <ph id=\"ph1\">`For Each`</ph> loops by putting one loop within another.","source":"You can nest `For Each` loops by putting one loop within another."},{"content":"The following example demonstrates nested <ph id=\"ph1\">`For Each`</ph>…<ph id=\"ph2\">`Next`</ph>","pos":[3401,3460],"source":"The following example demonstrates nested `For Each`…`Next`"},{"content":"structures.","pos":[3461,3472]},{"pos":[3479,3622],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrStatements#122<ept id=\"p2\">](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_2.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrStatements#122](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_2.vb)]"},{"pos":[3629,3698],"content":"When you nest loops, each loop must have a unique <ph id=\"ph1\">`element`</ph> variable.","source":"When you nest loops, each loop must have a unique `element` variable."},{"content":"You can also nest different kinds of control structures within each other.","pos":[3705,3779]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Nested Control Structures<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md)</ept>.","pos":[3780,3935],"source":" For more information, see [Nested Control Structures](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md)."},{"pos":[3944,3969],"content":"Exit For and Continue For","linkify":"Exit For and Continue For","nodes":[{"content":"Exit For and Continue For","pos":[0,25]}]},{"content":"The <bpt id=\"p1\">[</bpt>Exit For<ept id=\"p1\">](../../../visual-basic/language-reference/statements/exit-statement.md)</ept> statement causes execution to exit the <ph id=\"ph1\">`For`</ph>…<ph id=\"ph2\">`Next`</ph>","pos":[3973,4110],"source":"The [Exit For](../../../visual-basic/language-reference/statements/exit-statement.md) statement causes execution to exit the `For`…`Next`"},{"content":"loop and transfers control to the statement that follows the <ph id=\"ph1\">`Next`</ph> statement.","pos":[4111,4189],"source":" loop and transfers control to the statement that follows the `Next` statement."},{"content":"The <ph id=\"ph1\">`Continue For`</ph> statement transfers control immediately to the next iteration of the loop.","pos":[4196,4289],"source":"The `Continue For` statement transfers control immediately to the next iteration of the loop."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Continue Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/continue-statement.md)</ept>.","pos":[4290,4412],"source":" For more information, see [Continue Statement](../../../visual-basic/language-reference/statements/continue-statement.md)."},{"pos":[4419,4503],"content":"The following example shows how to use the <ph id=\"ph1\">`Continue For`</ph> and <ph id=\"ph2\">`Exit For`</ph> statements.","source":"The following example shows how to use the `Continue For` and `Exit For` statements."},{"pos":[4510,4653],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrStatements#123<ept id=\"p2\">](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_3.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrStatements#123](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_3.vb)]"},{"content":"You can put any number of <ph id=\"ph1\">`Exit For`</ph> statements in a <ph id=\"ph2\">`For Each`</ph> loop.","pos":[4660,4729],"source":"You can put any number of `Exit For` statements in a `For Each` loop."},{"content":"When used within nested <ph id=\"ph1\">`For Each`</ph> loops, <ph id=\"ph2\">`Exit For`</ph> causes execution to exit the innermost loop and transfers control to the next higher level of nesting.","pos":[4730,4885],"source":" When used within nested `For Each` loops, `Exit For` causes execution to exit the innermost loop and transfers control to the next higher level of nesting."},{"content":"<ph id=\"ph1\">`Exit For`</ph> is often used after an evaluation of some condition, for example, in an <ph id=\"ph2\">`If`</ph>...<ph id=\"ph3\">`Then`</ph>...<ph id=\"ph4\">`Else`</ph> structure.","pos":[4892,5008],"source":"`Exit For` is often used after an evaluation of some condition, for example, in an `If`...`Then`...`Else` structure."},{"content":"You might want to use <ph id=\"ph1\">`Exit For`</ph> for the following conditions:","pos":[5009,5071],"source":" You might want to use `Exit For` for the following conditions:"},{"content":"Continuing to iterate is unnecessary or impossible.","pos":[5081,5132]},{"content":"This might be caused by an erroneous value or a termination request.","pos":[5133,5201]},{"content":"An exception is caught in a <ph id=\"ph1\">`Try`</ph>...<ph id=\"ph2\">`Catch`</ph>...<ph id=\"ph3\">`Finally`</ph>.","pos":[5211,5267],"source":"An exception is caught in a `Try`...`Catch`...`Finally`."},{"content":"You might use <ph id=\"ph1\">`Exit For`</ph> at the end of the <ph id=\"ph2\">`Finally`</ph> block.","pos":[5268,5327],"source":" You might use `Exit For` at the end of the `Finally` block."},{"content":"There an endless loop, which is a loop that could run a large or even infinite number of times.","pos":[5337,5432]},{"content":"If you detect such a condition, you can use <ph id=\"ph1\">`Exit For`</ph> to escape the loop.","pos":[5433,5507],"source":" If you detect such a condition, you can use `Exit For` to escape the loop."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Do...Loop Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/do-loop-statement.md)</ept>.","pos":[5508,5630],"source":" For more information, see [Do...Loop Statement](../../../visual-basic/language-reference/statements/do-loop-statement.md)."},{"pos":[5639,5648],"content":"Iterators","linkify":"Iterators","nodes":[{"content":"Iterators","pos":[0,9]}]},{"content":"You use an <bpt id=\"p1\">*</bpt>iterator<ept id=\"p1\">*</ept> to perform a custom iteration over a collection.","pos":[5652,5722],"source":"You use an *iterator* to perform a custom iteration over a collection."},{"content":"An iterator can be a function or a <ph id=\"ph1\">`Get`</ph> accessor.","pos":[5723,5773],"source":" An iterator can be a function or a `Get` accessor."},{"content":"It uses a <ph id=\"ph1\">`Yield`</ph> statement to return each element of the collection one at a time.","pos":[5774,5857],"source":" It uses a `Yield` statement to return each element of the collection one at a time."},{"content":"You call an iterator by using a <ph id=\"ph1\">`For Each...Next`</ph> statement.","pos":[5864,5924],"source":"You call an iterator by using a `For Each...Next` statement."},{"content":"Each iteration of the <ph id=\"ph1\">`For Each`</ph> loop calls the iterator.","pos":[5925,5982],"source":" Each iteration of the `For Each` loop calls the iterator."},{"content":"When a <ph id=\"ph1\">`Yield`</ph> statement is reached in the iterator, the expression in the <ph id=\"ph2\">`Yield`</ph> statement is returned, and the current location in code is retained.","pos":[5983,6134],"source":" When a `Yield` statement is reached in the iterator, the expression in the `Yield` statement is returned, and the current location in code is retained."},{"content":"Execution is restarted from that location the next time that the iterator is called.","pos":[6135,6219]},{"content":"The following example uses an iterator function.","pos":[6226,6274]},{"content":"The iterator function has a <ph id=\"ph1\">`Yield`</ph> statement that's inside a <bpt id=\"p1\">[</bpt>For…Next<ept id=\"p1\">](../../../visual-basic/language-reference/statements/for-next-statement.md)</ept> loop.","pos":[6275,6428],"source":" The iterator function has a `Yield` statement that's inside a [For…Next](../../../visual-basic/language-reference/statements/for-next-statement.md) loop."},{"content":"In the <ph id=\"ph1\">`ListEvenNumbers`</ph> method, each iteration of the <ph id=\"ph2\">`For Each`</ph> statement body creates a call to the iterator function, which proceeds to the next <ph id=\"ph3\">`Yield`</ph> statement.","pos":[6429,6596],"source":" In the `ListEvenNumbers` method, each iteration of the `For Each` statement body creates a call to the iterator function, which proceeds to the next `Yield` statement."},{"pos":[6603,6746],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrStatements#127<ept id=\"p2\">](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_4.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrStatements#127](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_4.vb)]"},{"pos":[6753,7034],"content":"For more information, see <bpt id=\"p1\">[</bpt>Iterators<ept id=\"p1\">](http://msdn.microsoft.com/library/f45331db-d595-46ec-9142-551d3d1eb1a7)</ept>, <bpt id=\"p2\">[</bpt>Yield Statement<ept id=\"p2\">](../../../visual-basic/language-reference/statements/yield-statement.md)</ept>, and <bpt id=\"p3\">[</bpt>Iterator<ept id=\"p3\">](../../../visual-basic/language-reference/modifiers/iterator.md)</ept>.","source":"For more information, see [Iterators](http://msdn.microsoft.com/library/f45331db-d595-46ec-9142-551d3d1eb1a7), [Yield Statement](../../../visual-basic/language-reference/statements/yield-statement.md), and [Iterator](../../../visual-basic/language-reference/modifiers/iterator.md)."},{"pos":[7043,7067],"content":"Technical Implementation","linkify":"Technical Implementation","nodes":[{"content":"Technical Implementation","pos":[0,24]}]},{"content":"When a <ph id=\"ph1\">`For Each`</ph>…<ph id=\"ph2\">`Next`</ph>","pos":[7071,7095],"source":"When a `For Each`…`Next`"},{"content":"statement runs, Visual Basic evaluates the collection only one time, before the loop starts.","pos":[7096,7188]},{"content":"If your statement block changes <ph id=\"ph1\">`element`</ph> or <ph id=\"ph2\">`group`</ph>, these changes don't affect the iteration of the loop.","pos":[7189,7296],"source":" If your statement block changes `element` or `group`, these changes don't affect the iteration of the loop."},{"pos":[7303,7482],"content":"When all the elements in the collection have been successively assigned to <ph id=\"ph1\">`element`</ph>, the <ph id=\"ph2\">`For Each`</ph> loop stops and control passes to the statement following the <ph id=\"ph3\">`Next`</ph> statement.","source":"When all the elements in the collection have been successively assigned to `element`, the `For Each` loop stops and control passes to the statement following the `Next` statement."},{"content":"If <ph id=\"ph1\">`element`</ph> hasn't been declared outside this loop, you must declare it in the <ph id=\"ph2\">`For Each`</ph> statement.","pos":[7489,7590],"source":"If `element` hasn't been declared outside this loop, you must declare it in the `For Each` statement."},{"content":"You can declare the type of <ph id=\"ph1\">`element`</ph> explicitly by using an <ph id=\"ph2\">`As`</ph> statement, or you can rely on type inference to assign the type.","pos":[7591,7721],"source":" You can declare the type of `element` explicitly by using an `As` statement, or you can rely on type inference to assign the type."},{"content":"In either case, the scope of <ph id=\"ph1\">`element`</ph> is the body of the loop.","pos":[7722,7785],"source":" In either case, the scope of `element` is the body of the loop."},{"content":"However, you cannot declare <ph id=\"ph1\">`element`</ph> both outside and inside the loop.","pos":[7786,7857],"source":" However, you cannot declare `element` both outside and inside the loop."},{"content":"You can optionally specify <ph id=\"ph1\">`element`</ph> in the <ph id=\"ph2\">`Next`</ph> statement.","pos":[7864,7925],"source":"You can optionally specify `element` in the `Next` statement."},{"content":"This improves the readability of your program, especially if you have nested <ph id=\"ph1\">`For Each`</ph> loops.","pos":[7926,8020],"source":" This improves the readability of your program, especially if you have nested `For Each` loops."},{"content":"You must specify the same variable as the one that appears in the corresponding <ph id=\"ph1\">`For Each`</ph> statement.","pos":[8021,8122],"source":" You must specify the same variable as the one that appears in the corresponding `For Each` statement."},{"content":"You might want to avoid changing the value of <ph id=\"ph1\">`element`</ph> inside a loop.","pos":[8129,8199],"source":"You might want to avoid changing the value of `element` inside a loop."},{"content":"Doing this can make it more difficult to read and debug your code.","pos":[8200,8266]},{"content":"Changing the value of <ph id=\"ph1\">`group`</ph> doesn't affect the collection or its elements, which were determined when the loop was first entered.","pos":[8267,8398],"source":" Changing the value of `group` doesn't affect the collection or its elements, which were determined when the loop was first entered."},{"content":"When you're nesting loops, if a <ph id=\"ph1\">`Next`</ph> statement of an outer nesting level is encountered before the <ph id=\"ph2\">`Next`</ph> of an inner level, the compiler signals an error.","pos":[8405,8562],"source":"When you're nesting loops, if a `Next` statement of an outer nesting level is encountered before the `Next` of an inner level, the compiler signals an error."},{"content":"However, the compiler can detect this overlapping error only if you specify <ph id=\"ph1\">`element`</ph> in every <ph id=\"ph2\">`Next`</ph> statement.","pos":[8563,8675],"source":" However, the compiler can detect this overlapping error only if you specify `element` in every `Next` statement."},{"content":"If your code depends on traversing a collection in a particular order, a <ph id=\"ph1\">`For Each`</ph>...<ph id=\"ph2\">`Next`</ph> loop isn't the best choice, unless you know the characteristics of the enumerator object the collection exposes.","pos":[8682,8887],"source":"If your code depends on traversing a collection in a particular order, a `For Each`...`Next` loop isn't the best choice, unless you know the characteristics of the enumerator object the collection exposes."},{"content":"The order of traversal isn't determined by Visual Basic, but by the <ph id=\"ph1\">&lt;xref:System.Collections.IEnumerator.MoveNext%2A&gt;</ph> method of the enumerator object.","pos":[8888,9038],"source":" The order of traversal isn't determined by Visual Basic, but by the <xref:System.Collections.IEnumerator.MoveNext%2A> method of the enumerator object."},{"content":"Therefore, you might not be able to predict which element of the collection is the first to be returned in <ph id=\"ph1\">`element`</ph>, or which is the next to be returned after a given element.","pos":[9039,9215],"source":" Therefore, you might not be able to predict which element of the collection is the first to be returned in `element`, or which is the next to be returned after a given element."},{"content":"You might achieve more reliable results using a different loop structure, such as <ph id=\"ph1\">`For`</ph>...<ph id=\"ph2\">`Next`</ph> or <ph id=\"ph3\">`Do`</ph>...<ph id=\"ph4\">`Loop`</ph>.","pos":[9216,9330],"source":" You might achieve more reliable results using a different loop structure, such as `For`...`Next` or `Do`...`Loop`."},{"pos":[9337,9446],"content":"The data type of <ph id=\"ph1\">`element`</ph> must be such that the data type of the elements of <ph id=\"ph2\">`group`</ph> can be converted to it.","source":"The data type of `element` must be such that the data type of the elements of `group` can be converted to it."},{"content":"The data type of <ph id=\"ph1\">`group`</ph> must be a reference type that refers to a collection or an array that's enumerable.","pos":[9453,9561],"source":"The data type of `group` must be a reference type that refers to a collection or an array that's enumerable."},{"content":"Most commonly this means that <ph id=\"ph1\">`group`</ph> refers to an object that implements the <ph id=\"ph2\">&lt;xref:System.Collections.IEnumerable&gt;</ph> interface of the <ph id=\"ph3\">`System.Collections`</ph> namespace or the <ph id=\"ph4\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> interface of the <ph id=\"ph5\">`System.Collections.Generic`</ph> namespace.","pos":[9562,9839],"source":" Most commonly this means that `group` refers to an object that implements the <xref:System.Collections.IEnumerable> interface of the `System.Collections` namespace or the <xref:System.Collections.Generic.IEnumerable%601> interface of the `System.Collections.Generic` namespace."},{"content":"<ph id=\"ph1\">`System.Collections.IEnumerable`</ph> defines the <ph id=\"ph2\">&lt;xref:System.Collections.IEnumerable.GetEnumerator%2A&gt;</ph> method, which returns an enumerator object for the collection.","pos":[9840,10002],"source":"`System.Collections.IEnumerable` defines the <xref:System.Collections.IEnumerable.GetEnumerator%2A> method, which returns an enumerator object for the collection."},{"content":"The enumerator object implements the <ph id=\"ph1\">`System.Collections.IEnumerator`</ph> interface of the <ph id=\"ph2\">`System.Collections`</ph> namespace and exposes the <ph id=\"ph3\">&lt;xref:System.Collections.IEnumerator.Current%2A&gt;</ph> property and the <ph id=\"ph4\">&lt;xref:System.Collections.IEnumerator.Reset%2A&gt;</ph> and <ph id=\"ph5\">&lt;xref:System.Collections.IEnumerator.MoveNext%2A&gt;</ph> methods.","pos":[10003,10312],"source":" The enumerator object implements the `System.Collections.IEnumerator` interface of the `System.Collections` namespace and exposes the <xref:System.Collections.IEnumerator.Current%2A> property and the <xref:System.Collections.IEnumerator.Reset%2A> and <xref:System.Collections.IEnumerator.MoveNext%2A> methods."},{"content":"Visual Basic uses these to traverse the collection.","pos":[10313,10364]},{"pos":[10374,10395],"content":"Narrowing Conversions","linkify":"Narrowing Conversions","nodes":[{"content":"Narrowing Conversions","pos":[0,21]}]},{"content":"When <ph id=\"ph1\">`Option Strict`</ph> is set to <ph id=\"ph2\">`On`</ph>, narrowing conversions ordinarily cause compiler errors.","pos":[10399,10491],"source":"When `Option Strict` is set to `On`, narrowing conversions ordinarily cause compiler errors."},{"content":"In a <ph id=\"ph1\">`For Each`</ph> statement, however, conversions from the elements in <ph id=\"ph2\">`group`</ph> to <ph id=\"ph3\">`element`</ph> are evaluated and performed at run time, and compiler errors caused by narrowing conversions are suppressed.","pos":[10492,10690],"source":" In a `For Each` statement, however, conversions from the elements in `group` to `element` are evaluated and performed at run time, and compiler errors caused by narrowing conversions are suppressed."},{"content":"In the following example, the assignment of <ph id=\"ph1\">`m`</ph> as the initial value for <ph id=\"ph2\">`n`</ph> doesn't compile when <ph id=\"ph3\">`Option Strict`</ph> is on because the conversion of a <ph id=\"ph4\">`Long`</ph> to an <ph id=\"ph5\">`Integer`</ph> is a narrowing conversion.","pos":[10697,10894],"source":"In the following example, the assignment of `m` as the initial value for `n` doesn't compile when `Option Strict` is on because the conversion of a `Long` to an `Integer` is a narrowing conversion."},{"content":"In the <ph id=\"ph1\">`For Each`</ph> statement, however, no compiler error is reported, even though the assignment to <ph id=\"ph2\">`number`</ph> requires the same conversion from <ph id=\"ph3\">`Long`</ph> to <ph id=\"ph4\">`Integer`</ph>.","pos":[10895,11057],"source":" In the `For Each` statement, however, no compiler error is reported, even though the assignment to `number` requires the same conversion from `Long` to `Integer`."},{"content":"In the <ph id=\"ph1\">`For Each`</ph> statement that contains a large number, a run-time error occurs when <ph id=\"ph2\">&lt;xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A&gt;</ph> is applied to the large number.","pos":[11058,11247],"source":" In the `For Each` statement that contains a large number, a run-time error occurs when <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> is applied to the large number."},{"pos":[11254,11396],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrStatements#89<ept id=\"p2\">](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_5.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrStatements#89](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_5.vb)]"},{"pos":[11406,11423],"content":"IEnumerator Calls","linkify":"IEnumerator Calls","nodes":[{"content":"IEnumerator Calls","pos":[0,17]}]},{"content":"When execution of a <ph id=\"ph1\">`For Each`</ph>...<ph id=\"ph2\">`Next`</ph> loop starts, Visual Basic verifies that <ph id=\"ph3\">`group`</ph> refers to a valid collection object.","pos":[11427,11551],"source":"When execution of a `For Each`...`Next` loop starts, Visual Basic verifies that `group` refers to a valid collection object."},{"content":"If not, it throws an exception.","pos":[11552,11583]},{"content":"Otherwise, it calls the <ph id=\"ph1\">&lt;xref:System.Collections.IEnumerator.MoveNext%2A&gt;</ph> method and the <ph id=\"ph2\">&lt;xref:System.Collections.IEnumerator.Current%2A&gt;</ph> property of the enumerator object to return the first element.","pos":[11584,11784],"source":" Otherwise, it calls the <xref:System.Collections.IEnumerator.MoveNext%2A> method and the <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object to return the first element."},{"content":"If <ph id=\"ph1\">`MoveNext`</ph> indicates that there is no next element, that is, if the collection is empty, the <ph id=\"ph2\">`For Each`</ph> loop stops and control passes to the statement following the <ph id=\"ph3\">`Next`</ph> statement.","pos":[11785,11970],"source":" If `MoveNext` indicates that there is no next element, that is, if the collection is empty, the `For Each` loop stops and control passes to the statement following the `Next` statement."},{"content":"Otherwise, Visual Basic sets <ph id=\"ph1\">`element`</ph> to the first element and runs the statement block.","pos":[11971,12060],"source":" Otherwise, Visual Basic sets `element` to the first element and runs the statement block."},{"content":"Each time Visual Basic encounters the <ph id=\"ph1\">`Next`</ph> statement, it returns to the <ph id=\"ph2\">`For Each`</ph> statement.","pos":[12067,12162],"source":"Each time Visual Basic encounters the `Next` statement, it returns to the `For Each` statement."},{"content":"Again it calls <ph id=\"ph1\">`MoveNext`</ph> and <ph id=\"ph2\">`Current`</ph> to return the next element, and again it either runs the block or stops the loop depending on the result.","pos":[12163,12308],"source":" Again it calls `MoveNext` and `Current` to return the next element, and again it either runs the block or stops the loop depending on the result."},{"content":"This process continues until <ph id=\"ph1\">`MoveNext`</ph> indicates that there is no next element or an <ph id=\"ph2\">`Exit For`</ph> statement is encountered.","pos":[12309,12431],"source":" This process continues until `MoveNext` indicates that there is no next element or an `Exit For` statement is encountered."},{"content":"<bpt id=\"p1\">**</bpt>Modifying the Collection.<ept id=\"p1\">**</ept>","pos":[12438,12467],"source":"**Modifying the Collection.**"},{"content":"The enumerator object returned by <ph id=\"ph1\">&lt;xref:System.Collections.IEnumerable.GetEnumerator%2A&gt;</ph> normally doesn't let you change the collection by adding, deleting, replacing, or reordering any elements.","pos":[12468,12663],"source":" The enumerator object returned by <xref:System.Collections.IEnumerable.GetEnumerator%2A> normally doesn't let you change the collection by adding, deleting, replacing, or reordering any elements."},{"content":"If you change the collection after you have initiated a <ph id=\"ph1\">`For Each`</ph>...<ph id=\"ph2\">`Next`</ph> loop, the enumerator object becomes invalid, and the next attempt to access an element causes an <ph id=\"ph3\">&lt;xref:System.InvalidOperationException&gt;</ph> exception.","pos":[12664,12887],"source":" If you change the collection after you have initiated a `For Each`...`Next` loop, the enumerator object becomes invalid, and the next attempt to access an element causes an <xref:System.InvalidOperationException> exception."},{"content":"However, this blocking of modification isn't determined by <ph id=\"ph1\">[!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph>, but rather by the implementation of the <ph id=\"ph2\">&lt;xref:System.Collections.IEnumerable&gt;</ph> interface.","pos":[12894,13132],"source":"However, this blocking of modification isn't determined by [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)], but rather by the implementation of the <xref:System.Collections.IEnumerable> interface."},{"content":"It is possible to implement <ph id=\"ph1\">`IEnumerable`</ph> in a way that allows for modification during iteration.","pos":[13133,13230],"source":" It is possible to implement `IEnumerable` in a way that allows for modification during iteration."},{"content":"If you are considering doing such dynamic modification, make sure that you understand the characteristics of the <ph id=\"ph1\">`IEnumerable`</ph> implementation on the collection you are using.","pos":[13231,13405],"source":" If you are considering doing such dynamic modification, make sure that you understand the characteristics of the `IEnumerable` implementation on the collection you are using."},{"content":"<bpt id=\"p1\">**</bpt>Modifying Collection Elements.<ept id=\"p1\">**</ept>","pos":[13412,13446],"source":"**Modifying Collection Elements.**"},{"content":"The <ph id=\"ph1\">&lt;xref:System.Collections.IEnumerator.Current%2A&gt;</ph> property of the enumerator object is <bpt id=\"p1\">[</bpt>ReadOnly<ept id=\"p1\">](../../../visual-basic/language-reference/modifiers/readonly.md)</ept>, and it returns a local copy of each collection element.","pos":[13447,13668],"source":" The <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object is [ReadOnly](../../../visual-basic/language-reference/modifiers/readonly.md), and it returns a local copy of each collection element."},{"content":"This means that you cannot modify the elements themselves in a <ph id=\"ph1\">`For Each`</ph>...<ph id=\"ph2\">`Next`</ph> loop.","pos":[13669,13757],"source":" This means that you cannot modify the elements themselves in a `For Each`...`Next` loop."},{"content":"Any modification you make affects only the local copy from <ph id=\"ph1\">`Current`</ph> and isn't reflected back into the underlying collection.","pos":[13758,13883],"source":" Any modification you make affects only the local copy from `Current` and isn't reflected back into the underlying collection."},{"content":"However, if an element is a reference type, you can modify the members of the instance to which it points.","pos":[13884,13990]},{"content":"The following example modifies the <ph id=\"ph1\">`BackColor`</ph> member of each <ph id=\"ph2\">`thisControl`</ph> element.","pos":[13991,14075],"source":" The following example modifies the `BackColor` member of each `thisControl` element."},{"content":"You cannot, however, modify <ph id=\"ph1\">`thisControl`</ph> itself.","pos":[14076,14125],"source":" You cannot, however, modify `thisControl` itself."},{"pos":[14398,14531],"content":"The previous example can modify the <ph id=\"ph1\">`BackColor`</ph> member of each <ph id=\"ph2\">`thisControl`</ph> element, although it cannot modify <ph id=\"ph3\">`thisControl`</ph> itself.","source":"The previous example can modify the `BackColor` member of each `thisControl` element, although it cannot modify `thisControl` itself."},{"content":"<bpt id=\"p1\">**</bpt>Traversing Arrays.<ept id=\"p1\">**</ept>","pos":[14538,14560],"source":"**Traversing Arrays.**"},{"content":"Because the <ph id=\"ph1\">&lt;xref:System.Array&gt;</ph> class implements the <ph id=\"ph2\">&lt;xref:System.Collections.IEnumerable&gt;</ph> interface, all arrays expose the <ph id=\"ph3\">&lt;xref:System.Array.GetEnumerator%2A&gt;</ph> method.","pos":[14561,14729],"source":" Because the <xref:System.Array> class implements the <xref:System.Collections.IEnumerable> interface, all arrays expose the <xref:System.Array.GetEnumerator%2A> method."},{"content":"This means that you can iterate through an array with a <ph id=\"ph1\">`For Each`</ph>...<ph id=\"ph2\">`Next`</ph> loop.","pos":[14730,14811],"source":" This means that you can iterate through an array with a `For Each`...`Next` loop."},{"content":"However, you can only read the array elements.","pos":[14812,14858]},{"content":"You cannot change them.","pos":[14859,14882]},{"pos":[14891,14898],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example lists all the folders in the C:\\ directory by using the <ph id=\"ph1\">&lt;xref:System.IO.DirectoryInfo&gt;</ph> class.","pos":[14902,15017],"source":"The following example lists all the folders in the C:\\ directory by using the <xref:System.IO.DirectoryInfo> class."},{"pos":[15024,15167],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrStatements#124<ept id=\"p2\">](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_6.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrStatements#124](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_6.vb)]"},{"pos":[15176,15183],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example illustrates a procedure for sorting a collection.","pos":[15187,15258]},{"content":"The example sorts instances of a <ph id=\"ph1\">`Car`</ph> class that are stored in a <ph id=\"ph2\">&lt;xref:System.Collections.Generic.List%601&gt;</ph>.","pos":[15259,15368],"source":" The example sorts instances of a `Car` class that are stored in a <xref:System.Collections.Generic.List%601>."},{"content":"The <ph id=\"ph1\">`Car`</ph> class implements the <ph id=\"ph2\">&lt;xref:System.IComparable%601&gt;</ph> interface, which requires that the <ph id=\"ph3\">&lt;xref:System.IComparable%601.CompareTo%2A&gt;</ph> method be implemented.","pos":[15369,15530],"source":" The `Car` class implements the <xref:System.IComparable%601> interface, which requires that the <xref:System.IComparable%601.CompareTo%2A> method be implemented."},{"content":"Each call to the <ph id=\"ph1\">&lt;xref:System.IComparable%601.CompareTo%2A&gt;</ph> method makes a single comparison that's used for sorting.","pos":[15537,15654],"source":"Each call to the <xref:System.IComparable%601.CompareTo%2A> method makes a single comparison that's used for sorting."},{"content":"User-written code in the <ph id=\"ph1\">`CompareTo`</ph> method returns a value for each comparison of the current object with another object.","pos":[15655,15777],"source":" User-written code in the `CompareTo` method returns a value for each comparison of the current object with another object."},{"content":"The value returned is less than zero if the current object is less than the other object, greater than zero if the current object is greater than the other object, and zero if they are equal.","pos":[15778,15969]},{"content":"This enables you to define in code the criteria for greater than, less than, and equal.","pos":[15970,16057]},{"content":"In the <ph id=\"ph1\">`ListCars`</ph> method, the <ph id=\"ph2\">`cars.Sort()`</ph> statement sorts the list.","pos":[16064,16133],"source":"In the `ListCars` method, the `cars.Sort()` statement sorts the list."},{"content":"This call to the <ph id=\"ph1\">&lt;xref:System.Collections.Generic.List%601.Sort%2A&gt;</ph> method of the <ph id=\"ph2\">&lt;xref:System.Collections.Generic.List%601&gt;</ph> causes the <ph id=\"ph3\">`CompareTo`</ph> method to be called automatically for the <ph id=\"ph4\">`Car`</ph> objects in the <ph id=\"ph5\">`List`</ph>.","pos":[16134,16352],"source":" This call to the <xref:System.Collections.Generic.List%601.Sort%2A> method of the <xref:System.Collections.Generic.List%601> causes the `CompareTo` method to be called automatically for the `Car` objects in the `List`."},{"pos":[16359,16502],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrStatements#125<ept id=\"p2\">](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_7.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrStatements#125](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_7.vb)]"},{"pos":[16511,16519],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Collections<ept id=\"p1\">](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)</ept><ph id=\"ph1\"> </ph>","pos":[16523,16609],"source":"[Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b) "},{"content":"<bpt id=\"p1\"> [</bpt>For...Next Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/for-next-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[16612,16711],"source":" [For...Next Statement](../../../visual-basic/language-reference/statements/for-next-statement.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Loop Structures<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md)</ept><ph id=\"ph1\"> </ph>","pos":[16714,16824],"source":" [Loop Structures](../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md) "},{"content":"<bpt id=\"p1\"> [</bpt>While...End While Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/while-end-while-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[16827,16940],"source":" [While...End While Statement](../../../visual-basic/language-reference/statements/while-end-while-statement.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Do...Loop Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/do-loop-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[16943,17040],"source":" [Do...Loop Statement](../../../visual-basic/language-reference/statements/do-loop-statement.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Widening and Narrowing Conversions<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)</ept><ph id=\"ph1\"> </ph>","pos":[17043,17189],"source":" [Widening and Narrowing Conversions](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Object Initializers: Named and Anonymous Types<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)</ept><ph id=\"ph1\"> </ph>","pos":[17192,17370],"source":" [Object Initializers: Named and Anonymous Types](../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Collection Initializers<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/collection-initializers/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[17373,17492],"source":" [Collection Initializers](../../../visual-basic/programming-guide/language-features/collection-initializers/index.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Arrays<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/arrays/index.md)</ept>","pos":[17495,17579],"source":" [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md)"}]}