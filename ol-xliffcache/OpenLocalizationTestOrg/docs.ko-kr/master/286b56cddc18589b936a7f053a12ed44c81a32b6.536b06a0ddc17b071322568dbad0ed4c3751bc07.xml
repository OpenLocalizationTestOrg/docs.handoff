{"content":"---\ntitle: \"How to: Add or Remove Images with the Windows Forms ImageList Component\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"images [Windows Forms], removing from ImageList component\"\n  - \"images [Windows Forms], storing for controls\"\n  - \"ImageList component [Windows Forms], adding images\"\n  - \"ImageList component [Windows Forms], removing images\"\n  - \"images [Windows Forms], adding to ImageList component\"\n  - \"images [Windows Forms], displaying with controls\"\nms.assetid: c5eacc56-f769-4e2e-bfb7-f756620913db\n---\n# How to: Add or Remove Images with the Windows Forms ImageList Component\nThe Windows Forms <xref:System.Windows.Forms.ImageList> component is typically populated with images before it is associated with a control. However, you can add and remove images after associating the image list with a control.  \n  \n> [!NOTE]\n>  When you remove images, verify that the <xref:System.Windows.Forms.ButtonBase.ImageIndex%2A> property of any associated controls is still valid.  \n  \n### To add images programmatically  \n  \n-   Use the <xref:System.Windows.Forms.ImageList.ImageCollection.Add%2A> method of the image list's <xref:System.Windows.Forms.ImageList.Images%2A> property.  \n  \n     In the following code example, the path set for the location of the image is the **My Documents** folder. This location is used because you can assume that most computers that are running the Windows operating system will include this folder. Choosing this location also lets users who have minimal system access levels more safely run the application. The following code example requires that you have a form with an <xref:System.Windows.Forms.ImageList> control already added.  \n  \n    ```vb  \n    Public Sub LoadImage()  \n       Dim myImage As System.Drawing.Image = _  \n         Image.FromFile _  \n       (System.Environment.GetFolderPath _  \n       (System.Environment.SpecialFolder.Personal) _  \n       & \"\\Image.gif\")  \n       ImageList1.Images.Add(myImage)  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    public void addImage()  \n    {  \n    // Be sure that you use an appropriate escape sequence (such as the   \n    // @) when specifying the location of the file.  \n       System.Drawing.Image myImage =   \n         Image.FromFile  \n       (System.Environment.GetFolderPath  \n       (System.Environment.SpecialFolder.Personal)  \n       + @\"\\Image.gif\");  \n       imageList1.Images.Add(myImage);  \n    }  \n    ```  \n  \n    ```cpp  \n    public:  \n       void addImage()  \n       {  \n       // Replace the bold image in the following sample   \n       // with your own icon.  \n       // Be sure that you use an appropriate escape sequence (such as   \n       // \\\\) when specifying the location of the file.  \n          System::Drawing::Image ^ myImage =   \n             Image::FromFile(String::Concat(  \n             System::Environment::GetFolderPath(  \n             System::Environment::SpecialFolder::Personal),  \n             \"\\\\Image.gif\"));  \n          imageList1->Images->Add(myImage);  \n       }  \n    ```  \n  \n### To add images with a key value.  \n  \n-   Use one of the <xref:System.Windows.Forms.ImageList.ImageCollection.Add%2A> methods of the image list's <xref:System.Windows.Forms.ImageList.Images%2A> property that takes a key value.  \n  \n     In the following code example, the path set for the location of the image is the **My Documents** folder. This location is used because you can assume that most computers that are running the Windows operating system will include this folder. Choosing this location also lets users who have minimal system access levels more safely run the application. The following code example requires that you have a form with an <xref:System.Windows.Forms.ImageList> control already added.  \n  \n    ```vb  \n    Public Sub LoadImage()  \n       Dim myImage As System.Drawing.Image = _  \n         Image.FromFile _  \n       (System.Environment.GetFolderPath _  \n       (System.Environment.SpecialFolder.Personal) _  \n       & \"\\Image.gif\")  \n       ImageList1.Images.Add(\"myPhoto\", myImage)  \n    End Sub  \n    ```  \n  \n```csharp  \npublic void addImage()  \n{  \n// Be sure that you use an appropriate escape sequence (such as the   \n// @) when specifying the location of the file.  \n   System.Drawing.Image myImage =   \n     Image.FromFile  \n   (System.Environment.GetFolderPath  \n   (System.Environment.SpecialFolder.Personal)  \n   + @\"\\Image.gif\");  \n   imageList1.Images.Add(\"myPhoto\", myImage);  \n}  \n```  \n  \n### To remove all images programmatically  \n  \n-   Use the <xref:System.Windows.Forms.ImageList.ImageCollection.Remove%2A> method to remove a single image  \n  \n     ,-or-  \n  \n     Use the <xref:System.Windows.Forms.ImageList.ImageCollection.Clear%2A> method to clear all images in the image list.  \n  \n    ```vb  \n    ' Removes the first image in the image list  \n    ImageList1.Images.Remove(myImage)  \n    ' Clears all images in the image list  \n    ImageList1.Images.Clear()  \n    ```  \n  \n```csharp  \n// Removes the first image in the image list.  \nimageList1.Images.Remove(myImage);  \n// Clears all images in the image list.  \nimageList1.Images.Clear();  \n```  \n  \n### To remove images by key  \n  \n-   Use the <xref:System.Windows.Forms.ImageList.ImageCollection.RemoveByKey%2A> method to remove a single image by its key.  \n  \n    ```vb  \n    ' Removes the image named \"myPhoto\" from the list.  \n    ImageList1.Images.RemoveByKey(\"myPhoto\")  \n    ```  \n  \n```csharp  \n// Removes the image named \"myPhoto\" from the list.  \nimageList1.Images.RemoveByKey(\"myPhoto\");  \n```  \n  \n## See also\n\n- [ImageList Component](imagelist-component-windows-forms.md)\n- [ImageList Component Overview](imagelist-component-overview-windows-forms.md)\n- [Images, Bitmaps, and Metafiles](../advanced/images-bitmaps-and-metafiles.md)\n","nodes":[{"pos":[4,567],"embed":true,"restype":"x-metadata","content":"title: \"How to: Add or Remove Images with the Windows Forms ImageList Component\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"images [Windows Forms], removing from ImageList component\"\n  - \"images [Windows Forms], storing for controls\"\n  - \"ImageList component [Windows Forms], adding images\"\n  - \"ImageList component [Windows Forms], removing images\"\n  - \"images [Windows Forms], adding to ImageList component\"\n  - \"images [Windows Forms], displaying with controls\"\nms.assetid: c5eacc56-f769-4e2e-bfb7-f756620913db","nodes":[{"content":"How to: Add or Remove Images with the Windows Forms ImageList Component","nodes":[{"pos":[0,71],"content":"How to: Add or Remove Images with the Windows Forms ImageList Component","nodes":[{"content":"How to: Add or Remove Images with the Windows Forms ImageList Component","pos":[0,71]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[574,645],"content":"How to: Add or Remove Images with the Windows Forms ImageList Component","linkify":"How to: Add or Remove Images with the Windows Forms ImageList Component","nodes":[{"content":"How to: Add or Remove Images with the Windows Forms ImageList Component","pos":[0,71]}]},{"content":"The Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ImageList&gt;</ph> component is typically populated with images before it is associated with a control.","pos":[646,786],"source":"The Windows Forms <xref:System.Windows.Forms.ImageList> component is typically populated with images before it is associated with a control."},{"content":"However, you can add and remove images after associating the image list with a control.","pos":[787,874]},{"pos":[882,1037],"content":"[!NOTE]\n When you remove images, verify that the <xref:System.Windows.Forms.ButtonBase.ImageIndex%2A> property of any associated controls is still valid.","leadings":["","> "],"nodes":[{"content":"When you remove images, verify that the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ButtonBase.ImageIndex%2A&gt;</ph> property of any associated controls is still valid.","pos":[9,153],"source":"When you remove images, verify that the <xref:System.Windows.Forms.ButtonBase.ImageIndex%2A> property of any associated controls is still valid."}]},{"pos":[1047,1077],"content":"To add images programmatically","linkify":"To add images programmatically","nodes":[{"content":"To add images programmatically","pos":[0,30]}]},{"pos":[1087,1240],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ImageList.ImageCollection.Add%2A&gt;</ph> method of the image list's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ImageList.Images%2A&gt;</ph> property.","source":"Use the <xref:System.Windows.Forms.ImageList.ImageCollection.Add%2A> method of the image list's <xref:System.Windows.Forms.ImageList.Images%2A> property."},{"content":"In the following code example, the path set for the location of the image is the <bpt id=\"p1\">**</bpt>My Documents<ept id=\"p1\">**</ept> folder.","pos":[1251,1356],"source":"In the following code example, the path set for the location of the image is the **My Documents** folder."},{"content":"This location is used because you can assume that most computers that are running the Windows operating system will include this folder.","pos":[1357,1493]},{"content":"Choosing this location also lets users who have minimal system access levels more safely run the application.","pos":[1494,1603]},{"content":"The following code example requires that you have a form with an <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ImageList&gt;</ph> control already added.","pos":[1604,1729],"source":" The following code example requires that you have a form with an <xref:System.Windows.Forms.ImageList> control already added."},{"pos":[3080,3111],"content":"To add images with a key value.","linkify":"To add images with a key value.","nodes":[{"content":"To add images with a key value.","pos":[0,31]}]},{"pos":[3121,3305],"content":"Use one of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ImageList.ImageCollection.Add%2A&gt;</ph> methods of the image list's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ImageList.Images%2A&gt;</ph> property that takes a key value.","source":"Use one of the <xref:System.Windows.Forms.ImageList.ImageCollection.Add%2A> methods of the image list's <xref:System.Windows.Forms.ImageList.Images%2A> property that takes a key value."},{"content":"In the following code example, the path set for the location of the image is the <bpt id=\"p1\">**</bpt>My Documents<ept id=\"p1\">**</ept> folder.","pos":[3316,3421],"source":"In the following code example, the path set for the location of the image is the **My Documents** folder."},{"content":"This location is used because you can assume that most computers that are running the Windows operating system will include this folder.","pos":[3422,3558]},{"content":"Choosing this location also lets users who have minimal system access levels more safely run the application.","pos":[3559,3668]},{"content":"The following code example requires that you have a form with an <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ImageList&gt;</ph> control already added.","pos":[3669,3794],"source":" The following code example requires that you have a form with an <xref:System.Windows.Forms.ImageList> control already added."},{"pos":[4518,4555],"content":"To remove all images programmatically","linkify":"To remove all images programmatically","nodes":[{"content":"To remove all images programmatically","pos":[0,37]}]},{"pos":[4565,4668],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ImageList.ImageCollection.Remove%2A&gt;</ph> method to remove a single image","source":"Use the <xref:System.Windows.Forms.ImageList.ImageCollection.Remove%2A> method to remove a single image"},{"content":",-or-","pos":[4679,4684]},{"pos":[4695,4811],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ImageList.ImageCollection.Clear%2A&gt;</ph> method to clear all images in the image list.","source":"Use the <xref:System.Windows.Forms.ImageList.ImageCollection.Clear%2A> method to clear all images in the image list."},{"pos":[5189,5212],"content":"To remove images by key","linkify":"To remove images by key","nodes":[{"content":"To remove images by key","pos":[0,23]}]},{"pos":[5222,5342],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ImageList.ImageCollection.RemoveByKey%2A&gt;</ph> method to remove a single image by its key.","source":"Use the <xref:System.Windows.Forms.ImageList.ImageCollection.RemoveByKey%2A> method to remove a single image by its key."},{"pos":[5599,5607],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5611,5670],"content":"<bpt id=\"p1\">[</bpt>ImageList Component<ept id=\"p1\">](imagelist-component-windows-forms.md)</ept>","source":"[ImageList Component](imagelist-component-windows-forms.md)"},{"pos":[5673,5750],"content":"<bpt id=\"p1\">[</bpt>ImageList Component Overview<ept id=\"p1\">](imagelist-component-overview-windows-forms.md)</ept>","source":"[ImageList Component Overview](imagelist-component-overview-windows-forms.md)"},{"pos":[5753,5830],"content":"<bpt id=\"p1\">[</bpt>Images, Bitmaps, and Metafiles<ept id=\"p1\">](../advanced/images-bitmaps-and-metafiles.md)</ept>","source":"[Images, Bitmaps, and Metafiles](../advanced/images-bitmaps-and-metafiles.md)"}]}