{"content":"---\ntitle: \"Dialog Boxes Overview\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"modeless dialog boxes [WPF]\"\n  - \"dialog boxes [WPF]\"\n  - \"message boxes [WPF]\"\n  - \"modal dialog boxes [WPF]\"\nms.assetid: 0d23d544-a393-4a02-a3aa-d8cd5d3d6511\n---\n# Dialog Boxes Overview\nStandalone applications typically have a main window that both displays the main data over which the application operates and exposes the functionality to process that data through [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] mechanisms like menu bars, tool bars, and status bars. A non-trivial application may also display additional windows to do the following:  \n  \n-   Display specific information to users.  \n  \n-   Gather information from users.  \n  \n-   Both display and gather information.  \n  \n These types of windows are known as *dialog boxes*, and there are two types: modal and modeless.  \n  \n A *modal* dialog box is displayed by a function when the function needs additional data from a user to continue. Because the function depends on the modal dialog box to gather data, the modal dialog box also prevents a user from activating other windows in the application while it remains open. In most cases, a modal dialog box allows a user to signal when they have finished with the modal dialog box by pressing either an **OK** or **Cancel** button. Pressing the **OK** button indicates that a user has entered data and wants the function to continue processing with that data. Pressing the **Cancel** button indicates that a user wants to stop the function from executing altogether. The most common examples of modal dialog boxes are shown to open, save, and print data.  \n  \n A *modeless* dialog box, on the other hand, does not prevent a user from activating other windows while it is open. For example, if a user wants to find occurrences of a particular word in a document, a main window will often open a dialog box to ask a user what word they are looking for. Since finding a word doesn't prevent a user from editing the document, however, the dialog box doesn't need to be modal. A modeless dialog box at least provides a **Close** button to close the dialog box, and may provide additional buttons to execute specific functions, such as a **Find Next** button to find the next word that matches the find criteria of a word search.  \n  \n Windows Presentation Foundation (WPF) allows you to create several types of dialog boxes, including message boxes, common dialog boxes, and custom dialog boxes. This topic discusses each, and the [Dialog Box Sample](https://go.microsoft.com/fwlink/?LinkID=159984) provides matching examples.  \n\n<a name=\"Message_Boxes\"></a>   \n## Message Boxes  \n A *message box* is a dialog box that can be used to display textual information and to allow users to make decisions with buttons. The following figure shows a message box that displays textual information, asks a question, and provides the user with three buttons to answer the question.  \n  \n ![A Word Processor dialog box asking if you want to save the changes to the document before the application closes.](./media/dialog-boxes-overview/word-processor-dialog.png)  \n  \n To create a message box, you use the <xref:System.Windows.MessageBox> class. <xref:System.Windows.MessageBox> lets you configure the message box text, title, icon, and buttons, using code like the following.  \n  \n [!code-csharp[DialogBoxesOverviewSnippets#MsgBoxConfigureCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxesOverviewSnippets/CSharp/Window1.xaml.cs#msgboxconfigurecodebehind)]\n [!code-vb[DialogBoxesOverviewSnippets#MsgBoxConfigureCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxesOverviewSnippets/VisualBasic/window1.xaml.vb#msgboxconfigurecodebehind)]  \n  \n To show a message box, you call the `static`<xref:System.Windows.MessageBox.Show%2A> method, as demonstrated in the following code.  \n  \n [!code-csharp[DialogBoxesOverviewSnippets#MsgBoxShowCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxesOverviewSnippets/CSharp/Window1.xaml.cs#msgboxshowcodebehind)]\n [!code-vb[DialogBoxesOverviewSnippets#MsgBoxShowCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxesOverviewSnippets/VisualBasic/window1.xaml.vb#msgboxshowcodebehind)]  \n  \n When code that shows a message box needs to detect and process the user's decision (which button was pressed), the code can inspect the message box result, as shown in the following code.  \n  \n [!code-csharp[DialogBoxesOverviewSnippets#MsgBoxShowAndResultCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxesOverviewSnippets/CSharp/Window1.xaml.cs#msgboxshowandresultcodebehind1)]\n [!code-vb[DialogBoxesOverviewSnippets#MsgBoxShowAndResultCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxesOverviewSnippets/VisualBasic/window1.xaml.vb#msgboxshowandresultcodebehind1)]  \n  \n For more information on using message boxes, see <xref:System.Windows.MessageBox>, [MessageBox Sample](https://go.microsoft.com/fwlink/?LinkID=160023), and [Dialog Box Sample](https://go.microsoft.com/fwlink/?LinkID=159984).  \n  \n Although <xref:System.Windows.MessageBox> may offer a simple dialog box user experience, the advantage of using <xref:System.Windows.MessageBox> is that is the only type of window that can be shown by applications that run within a partial trust security sandbox (see [Security](../security-wpf.md)), such as [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)].  \n  \n Most dialog boxes display and gather more complex data than the result of a message box, including text, selection (check boxes), mutually exclusive selection (radio buttons), and list selection (list boxes, combo boxes, drop-down list boxes). For these, Windows Presentation Foundation (WPF) provides several common dialog boxes and allows you to create your own dialog boxes, although the use of either is limited to applications running with full trust.  \n  \n<a name=\"Common_Dialogs\"></a>   \n## Common Dialog Boxes  \n [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] implements a variety of reusable dialog boxes that are common to all applications, including dialog boxes for opening files, saving files, and printing. Since these dialog boxes are implemented by the operating system, they can be shared among all the applications that run on the operating system, which helps user experience consistency; when users are familiar with the use of an operating system-provided dialog box in one application, they don't need to learn how to use that dialog box in other applications. Because these dialog boxes are available to all applications and because they help provide a consistent user experience, they are known as *common dialog boxes*.  \n  \n Windows Presentation Foundation (WPF) encapsulates the open file, save file, and print common dialog boxes and exposes them as managed classes for you to use in standalone applications. This topic provides a brief overview of each.  \n  \n<a name=\"Open_File_Dialog\"></a>   \n### Open File Dialog  \n The open file dialog box, shown in the following figure, is used by file opening functionality to retrieve the name of a file to open.  \n  \n ![An Open dialog box showing the location to retrieve the file.](./media/dialog-boxes-overview/open-file-dialog-box.png)  \n  \n The common open file dialog box is implemented as the <xref:Microsoft.Win32.OpenFileDialog> class and is located in the <xref:Microsoft.Win32> namespace. The following code shows how to create, configure, and show one, and how to process the result.  \n  \n [!code-csharp[DialogBoxesOverviewSnippets#OpenFileDialogBoxCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxesOverviewSnippets/CSharp/Window1.xaml.cs#openfiledialogboxcodebehind)]\n [!code-vb[DialogBoxesOverviewSnippets#OpenFileDialogBoxCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxesOverviewSnippets/VisualBasic/window1.xaml.vb#openfiledialogboxcodebehind)]  \n  \n For more information on the open file dialog box, see <xref:Microsoft.Win32.OpenFileDialog?displayProperty=nameWithType>.  \n  \n> [!NOTE]\n>  <xref:Microsoft.Win32.OpenFileDialog> can be used to safely retrieve file names by applications running with partial trust (see [Security](../security-wpf.md)).  \n  \n<a name=\"Save_File_Dialog\"></a>   \n### Save File Dialog Box  \n The save file dialog box, shown in the following figure, is used by file saving functionality to retrieve the name of a file to save.  \n  \n ![A Save As dialog box showing the location to save the file.](./media/dialog-boxes-overview/save-file-dialog-box.png)  \n  \n The common save file dialog box is implemented as the <xref:Microsoft.Win32.SaveFileDialog> class, and is located in the <xref:Microsoft.Win32> namespace. The following code shows how to create, configure, and show one, and how to process the result.  \n  \n [!code-csharp[DialogBoxesOverviewSnippets#SaveFileDialogBoxCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxesOverviewSnippets/CSharp/Window1.xaml.cs#savefiledialogboxcodebehind)]\n [!code-vb[DialogBoxesOverviewSnippets#SaveFileDialogBoxCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxesOverviewSnippets/VisualBasic/window1.xaml.vb#savefiledialogboxcodebehind)]  \n  \n For more information on the save file dialog box, see <xref:Microsoft.Win32.SaveFileDialog?displayProperty=nameWithType>.  \n  \n<a name=\"Print_Dialog\"></a>   \n### Print Dialog Box  \n The print dialog box, shown in the following figure, is used by printing functionality to choose and configure the printer that a user would like to print data to.  \n  \n ![Screenshot that shows a Print dialog box.](./media/dialog-boxes-overview/print-data-dialog-box.png)  \n  \n The common print dialog box is implemented as the <xref:System.Windows.Controls.PrintDialog> class, and is located in the <xref:System.Windows.Controls> namespace. The following code shows how to create, configure, and show one.  \n  \n [!code-csharp[DialogBoxesOverviewSnippets#PrintDialogBoxCODEBEHIND](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxesOverviewSnippets/CSharp/Window1.xaml.cs#printdialogboxcodebehind)]\n [!code-vb[DialogBoxesOverviewSnippets#PrintDialogBoxCODEBEHIND](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxesOverviewSnippets/VisualBasic/window1.xaml.vb#printdialogboxcodebehind)]  \n  \n For more information on the print dialog box, see <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType>. For detailed discussion of printing in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], see [Printing Overview](../advanced/printing-overview.md).  \n  \n<a name=\"Custom_Dialog_Boxes\"></a>   \n## Custom Dialog Boxes  \n While common dialog boxes are useful, and should be used when possible, they do not support the requirements of domain-specific dialog boxes. In these cases, you need to create your own dialog boxes. As we'll see, a dialog box is a window with special behaviors. <xref:System.Windows.Window> implements those behaviors and, consequently, you use <xref:System.Windows.Window> to create custom modal and modeless dialog boxes.  \n  \n<a name=\"Creating_a_Modal_Custom_Dialog_Box\"></a>   \n### Creating a Modal Custom Dialog Box  \n This topic shows how to use <xref:System.Windows.Window> to create a typical modal dialog box implementation, using the `Margins` dialog box as an example (see [Dialog Box Sample](https://go.microsoft.com/fwlink/?LinkID=159984)). The `Margins` dialog box is shown in the following figure.  \n  \n ![A Margins dialog box with fields to define left margin, top margin, right margin, and bottom margin.](./media/dialog-boxes-overview/margin-size-dialog-box.png)  \n  \n#### Configuring a Modal Dialog Box  \n The user interface for a typical dialog box includes the following:  \n  \n-   The various controls that are required to gather the desired data.  \n  \n-   Showing an **OK** button that users click to close the dialog box, return to the function, and continue processing.  \n  \n-   Showing a **Cancel** button that users click to close the dialog box and stop the function from further processing.  \n  \n-   Showing a **Close** button in the title bar.  \n  \n-   Showing an icon.  \n  \n-   Showing **Minimize**, **Maximize**, and **Restore** buttons.  \n  \n-   Showing a **System** menu to minimize, maximize, restore, and close the dialog box.  \n  \n-   Opening above and in the center of the window that opened the dialog box.  \n  \n-   Dialog boxes should be resizable where possible so, to prevent the dialog box from being too small, and to provide the user with a useful default size, you need to set both default and a minimum dimensions respectively.  \n  \n-   Pressing the ESC key should be configured as a keyboard shortcut that causes the **Cancel** button to be pressed. This is achieved by setting the <xref:System.Windows.Controls.Button.IsCancel%2A> property of the **Cancel** button to `true`.  \n  \n-   Pressing the ENTER (or RETURN) key should be configured as a keyboard shortcut that causes the **OK** button to be pressed. This is achieved by setting the <xref:System.Windows.Controls.Button.IsDefault%2A> property of the **OK** button `true`.  \n  \n The following code demonstrates this configuration.  \n  \n [!code-xaml[DialogBoxSample#MarginsDialogBoxMainBitsMARKUP1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml#marginsdialogboxmainbitsmarkup1)]  \n[!code-xaml[DialogBoxSample#MarginsDialogBoxMainBitsMARKUP2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml#marginsdialogboxmainbitsmarkup2)]  \n  \n [!code-csharp[DialogBoxSample#MarginsDialogBoxMainBitsCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxmainbitscodebehind1)]\n [!code-vb[DialogBoxSample#MarginsDialogBoxMainBitsCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxmainbitscodebehind1)]  \n[!code-csharp[DialogBoxSample#MarginsDialogBoxMainBitsCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxmainbitscodebehind2)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxMainBitsCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxmainbitscodebehind2)]  \n  \n The user experience for a dialog box also extends into the menu bar of the window that opens the dialog box. When a menu item runs a function that requires user interaction through a dialog box before the function can continue, the menu item for the function will have an ellipsis in its header, as shown here.  \n  \n [!code-xaml[DialogBoxSample#MainWindowMarginsDialogBoxMenuItemMARKUP1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml#mainwindowmarginsdialogboxmenuitemmarkup1)]  \n[!code-xaml[DialogBoxSample#MainWindowMarginsDialogBoxMenuItemMARKUP2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml#mainwindowmarginsdialogboxmenuitemmarkup2)]  \n  \n When a menu item runs a function that displays a dialog box which does not require user interaction, such as an About dialog box, an ellipsis is not required.  \n  \n#### Opening a Modal Dialog Box  \n A dialog box is typically shown as a result of a user selecting a menu item to perform a domain-specific function, such as setting the margins of a document in a word processor. Showing a window as a dialog box is similar to showing a normal window, although it requires additional dialog box-specific configuration. The entire process of instantiating, configuring, and opening a dialog box is shown in the following code.  \n  \n [!code-csharp[DialogBoxSample#OpenMarginsDialogCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openmarginsdialogcodebehind1)]\n [!code-vb[DialogBoxSample#OpenMarginsDialogCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openmarginsdialogcodebehind1)]  \n[!code-csharp[DialogBoxSample#OpenMarginsDialogCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openmarginsdialogcodebehind2)]\n[!code-vb[DialogBoxSample#OpenMarginsDialogCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openmarginsdialogcodebehind2)]  \n[!code-csharp[DialogBoxSample#OpenMarginsDialogCODEBEHIND3](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openmarginsdialogcodebehind3)]\n[!code-vb[DialogBoxSample#OpenMarginsDialogCODEBEHIND3](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openmarginsdialogcodebehind3)]  \n[!code-csharp[DialogBoxSample#OpenMarginsDialogCODEBEHIND4](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openmarginsdialogcodebehind4)]\n[!code-vb[DialogBoxSample#OpenMarginsDialogCODEBEHIND4](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openmarginsdialogcodebehind4)]  \n  \n Here, the code is passing default information (the current margins) to the dialog box. It is also setting the <xref:System.Windows.Window.Owner%2A?displayProperty=nameWithType> property with a reference to the window that is showing the dialog box. In general, you should always set the owner for a dialog box to provide window state-related behaviors that are common to all dialog boxes (see [WPF Windows Overview](wpf-windows-overview.md) for more information).  \n  \n> [!NOTE]\n>  You must provide an owner to support [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] automation for dialog boxes (see [UI Automation Overview](../../ui-automation/ui-automation-overview.md)).  \n  \n After the dialog box is configured, it is shown modally by calling the <xref:System.Windows.Window.ShowDialog%2A> method.  \n  \n#### Validating User-Provided Data  \n When a dialog box is opened and the user provides the required data, a dialog box is responsible for ensuring that the provided data is valid for the following reasons:  \n  \n-   From a security perspective, all input should be validated.  \n  \n-   From a domain-specific perspective, data validation prevents erroneous data from being processed by the code, which could potentially throw exceptions.  \n  \n-   From a user-experience perspective, a dialog box can help users by showing them which data they have entered is invalid.  \n  \n-   From a performance perspective, data validation in a multi-tier application can reduce the number of round trips between the client and the application tiers, particularly when the application is composed of Web services or server-based databases.  \n  \n To validate a bound control in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], you need to define a validation rule and associate it with the binding. A validation rule is a custom class that derives from <xref:System.Windows.Controls.ValidationRule>. The following example shows a validation rule, `MarginValidationRule`, which checks that a bound value is a <xref:System.Double> and is within a specified range.  \n  \n [!code-csharp[DialogBoxSample#MarginValidationRuleCODE](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginValidationRule.cs#marginvalidationrulecode)]\n [!code-vb[DialogBoxSample#MarginValidationRuleCODE](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginValidationRule.vb#marginvalidationrulecode)]  \n  \n In this code, the validation logic of a validation rule is implemented by overriding the <xref:System.Windows.Controls.ValidationRule.Validate%2A> method, which validates the data and returns an appropriate <xref:System.Windows.Controls.ValidationResult>.  \n  \n To associate the validation rule with the bound control, you use the following markup.  \n  \n [!code-xaml[DialogBoxSample#MarginsValidationMARKUP1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml#marginsvalidationmarkup1)]  \n[!code-xaml[DialogBoxSample#MarginsValidationMARKUP2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml#marginsvalidationmarkup2)]  \n[!code-xaml[DialogBoxSample#MarginsValidationMARKUP3](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml#marginsvalidationmarkup3)]  \n  \n Once the validation rule is associated, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] will automatically apply it when data is entered into the bound control. When a control contains invalid data, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] will display a red border around the invalid control, as shown in the following figure.  \n  \n ![A Margins dialog box with a red border around the invalid left margin value.](./media/dialog-boxes-overview/invalid-left-margin-dialog.png)  \n  \n [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] does not restrict a user to the invalid control until they have entered valid data. This is good behavior for a dialog box; a user should be able to freely navigate the controls in a dialog box whether or not data is valid. However, this means a user can enter invalid data and press the **OK** button. For this reason, your code also needs to validate all controls in a dialog box when the **OK** button is pressed by handling the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event.  \n  \n [!code-csharp[DialogBoxSample#MarginsDialogBoxValidationCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxvalidationcodebehind1)]\n [!code-vb[DialogBoxSample#MarginsDialogBoxValidationCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxvalidationcodebehind1)]  \n[!code-csharp[DialogBoxSample#MarginsDialogBoxValidationCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxvalidationcodebehind2)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxValidationCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxvalidationcodebehind2)]  \n[!code-csharp[DialogBoxSample#MarginsDialogBoxValidationCODEBEHIND3](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxvalidationcodebehind3)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxValidationCODEBEHIND3](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxvalidationcodebehind3)]  \n  \n This code enumerates all dependency objects on a window and, if any are invalid (as returned by <xref:System.Windows.Controls.Validation.GetHasError%2A>, the invalid control gets the focus, the `IsValid` method returns `false`, and the window is considered invalid.  \n  \n Once a dialog box is valid, it can safely close and return. As part of the return process, it needs to return a result to the calling function.  \n  \n#### Setting the Modal Dialog Result  \n Opening a dialog box using <xref:System.Windows.Window.ShowDialog%2A> is fundamentally like calling a method: the code that opened the dialog box using <xref:System.Windows.Window.ShowDialog%2A> waits until <xref:System.Windows.Window.ShowDialog%2A> returns. When <xref:System.Windows.Window.ShowDialog%2A> returns, the code that called it needs to decide whether to continue processing or stop processing, based on whether the user pressed the **OK** button or the **Cancel** button. To facilitate this decision, the dialog box needs to return the user's choice as a <xref:System.Boolean> value that is returned from the <xref:System.Windows.Window.ShowDialog%2A> method.  \n  \n When the **OK** button is clicked, <xref:System.Windows.Window.ShowDialog%2A> should return `true`. This is achieved by setting the <xref:System.Windows.Window.DialogResult%2A> property of the dialog box when the **OK** button is clicked.  \n  \n [!code-csharp[DialogBoxSample#MarginsDialogBoxOKResultSetCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxokresultsetcodebehind1)]\n [!code-vb[DialogBoxSample#MarginsDialogBoxOKResultSetCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxokresultsetcodebehind1)]  \n[!code-csharp[DialogBoxSample#MarginsDialogBoxOKResultSetCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxokresultsetcodebehind2)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxOKResultSetCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxokresultsetcodebehind2)]  \n[!code-csharp[DialogBoxSample#MarginsDialogBoxOKResultSetCODEBEHIND3](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxokresultsetcodebehind3)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxOKResultSetCODEBEHIND3](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxokresultsetcodebehind3)]  \n[!code-csharp[DialogBoxSample#MarginsDialogBoxOKResultSetCODEBEHIND4](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxokresultsetcodebehind4)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxOKResultSetCODEBEHIND4](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxokresultsetcodebehind4)]  \n  \n Note that setting the <xref:System.Windows.Window.DialogResult%2A> property also causes the window to close automatically, which alleviates the need to explicitly call <xref:System.Windows.Window.Close%2A>.  \n  \n When the **Cancel** button is clicked, <xref:System.Windows.Window.ShowDialog%2A> should return `false`, which also requires setting the <xref:System.Windows.Window.DialogResult%2A> property.  \n  \n [!code-csharp[DialogBoxSample#MarginsDialogBoxCancelResultSetCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxcancelresultsetcodebehind1)]\n [!code-vb[DialogBoxSample#MarginsDialogBoxCancelResultSetCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxcancelresultsetcodebehind1)]  \n[!code-csharp[DialogBoxSample#MarginsDialogBoxCancelResultSetCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxcancelresultsetcodebehind2)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxCancelResultSetCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxcancelresultsetcodebehind2)]  \n[!code-csharp[DialogBoxSample#MarginsDialogBoxCancelResultSetCODEBEHIND3](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxcancelresultsetcodebehind3)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxCancelResultSetCODEBEHIND3](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxcancelresultsetcodebehind3)]  \n  \n When a button's <xref:System.Windows.Controls.Button.IsCancel%2A> property is set to `true` and the user presses either the **Cancel** button or the ESC key, <xref:System.Windows.Window.DialogResult%2A> is automatically set to `false`. The following markup has the same effect as the preceding code, without the need to handle the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event.  \n  \n [!code-xaml[DialogBoxSample#MarginsDialogDefaultCancelMARKUP](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml#marginsdialogdefaultcancelmarkup)]  \n  \n A dialog box automatically returns `false` when a user presses the **Close** button in the title bar or chooses the **Close** menu item from the **System** menu.  \n  \n#### Processing Data Returned from a Modal Dialog Box  \n When <xref:System.Windows.Window.DialogResult%2A> is set by a dialog box, the function that opened it can get the dialog box result by inspecting the <xref:System.Windows.Window.DialogResult%2A> property when <xref:System.Windows.Window.ShowDialog%2A> returns.  \n  \n [!code-csharp[DialogBoxSample#OpenMarginsDialogProcessReturnCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openmarginsdialogprocessreturncodebehind1)]\n [!code-vb[DialogBoxSample#OpenMarginsDialogProcessReturnCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openmarginsdialogprocessreturncodebehind1)]  \n[!code-csharp[DialogBoxSample#OpenMarginsDialogProcessReturnCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openmarginsdialogprocessreturncodebehind2)]\n[!code-vb[DialogBoxSample#OpenMarginsDialogProcessReturnCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openmarginsdialogprocessreturncodebehind2)]  \n[!code-csharp[DialogBoxSample#OpenMarginsDialogProcessReturnCODEBEHIND3](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openmarginsdialogprocessreturncodebehind3)]\n[!code-vb[DialogBoxSample#OpenMarginsDialogProcessReturnCODEBEHIND3](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openmarginsdialogprocessreturncodebehind3)]  \n[!code-csharp[DialogBoxSample#OpenMarginsDialogProcessReturnCODEBEHIND4](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openmarginsdialogprocessreturncodebehind4)]\n[!code-vb[DialogBoxSample#OpenMarginsDialogProcessReturnCODEBEHIND4](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openmarginsdialogprocessreturncodebehind4)]  \n  \n If the dialog result is `true`, the function uses that as a cue to retrieve and process the data provided by the user.  \n  \n> [!NOTE]\n>  After <xref:System.Windows.Window.ShowDialog%2A> has returned, a dialog box cannot be reopened. Instead, you need to create a new instance.  \n  \n If the dialog result is `false`, the function should end processing appropriately.  \n  \n<a name=\"Creating_a_Modeless_Custom_Dialog_Box\"></a>   \n### Creating a Modeless Custom Dialog Box  \n A modeless dialog box, such as the Find Dialog Box shown in the following figure, has the same fundamental appearance as the modal dialog box.  \n  \n ![Screenshot that shows a Find dialog box.](./media/dialog-boxes-overview/find-modeless-dialog-box.png)  \n  \n However, the behavior is slightly different, as described in the following sections.  \n  \n#### Opening a Modeless Dialog Box  \n A modeless dialog box is opened by calling the <xref:System.Windows.Window.Show%2A> method.  \n  \n [!code-xaml[DialogBoxSample#OpenFindDialogMARKUP1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml#openfinddialogmarkup1)]  \n  \n [!code-csharp[DialogBoxSample#OpenFindDialogCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openfinddialogcodebehind1)]\n [!code-vb[DialogBoxSample#OpenFindDialogCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openfinddialogcodebehind1)]  \n[!code-csharp[DialogBoxSample#OpenFindDialogCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openfinddialogcodebehind2)]\n[!code-vb[DialogBoxSample#OpenFindDialogCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openfinddialogcodebehind2)]  \n[!code-csharp[DialogBoxSample#OpenFindDialogCODEBEHIND3](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openfinddialogcodebehind3)]\n[!code-vb[DialogBoxSample#OpenFindDialogCODEBEHIND3](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openfinddialogcodebehind3)]  \n  \n Unlike <xref:System.Windows.Window.ShowDialog%2A>, <xref:System.Windows.Window.Show%2A> returns immediately. Consequently, the calling window cannot tell when the modeless dialog box is closed and, therefore, does not know when to check for a dialog box result or get data from the dialog box for further processing. Instead, the dialog box needs to create an alternative way to return data to the calling window for processing.  \n  \n#### Processing Data Returned from a Modeless Dialog Box  \n In this example, the `FindDialogBox` may return one or more find results to the main window, depending on the text being searched for without any specific frequency. As with a modal dialog box, a modeless dialog box can return results using properties. However, the window that owns the dialog box needs to know when to check those properties. One way to enable this is for the dialog box to implement an event that is raised whenever text is found. `FindDialogBox` implements the `TextFoundEvent` for this purpose, which first requires a delegate.  \n  \n [!code-csharp[DialogBoxSample#TextFoundEventHandlerCODE](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/TextFoundEventHandler.cs#textfoundeventhandlercode)]\n [!code-vb[DialogBoxSample#TextFoundEventHandlerCODE](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/TextFoundEventHandler.vb#textfoundeventhandlercode)]  \n  \n Using the `TextFoundEventHandler` delegate, `FindDialogBox` implements the `TextFoundEvent`.  \n  \n [!code-csharp[DialogBoxSample#TextFoundEventCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/FindDialogBox.xaml.cs#textfoundeventcodebehind1)]\n [!code-vb[DialogBoxSample#TextFoundEventCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/FindDialogBox.xaml.vb#textfoundeventcodebehind1)]  \n[!code-csharp[DialogBoxSample#TextFoundEventCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/FindDialogBox.xaml.cs#textfoundeventcodebehind2)]\n[!code-vb[DialogBoxSample#TextFoundEventCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/FindDialogBox.xaml.vb#textfoundeventcodebehind2)]  \n  \n Consequently, `Find` can raise the event when a search result is found.  \n  \n [!code-csharp[DialogBoxSample#TextFoundEventRaiseCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/FindDialogBox.xaml.cs#textfoundeventraisecodebehind1)]\n [!code-vb[DialogBoxSample#TextFoundEventRaiseCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/FindDialogBox.xaml.vb#textfoundeventraisecodebehind1)]  \n[!code-csharp[DialogBoxSample#TextFoundEventRaiseCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/FindDialogBox.xaml.cs#textfoundeventraisecodebehind2)]\n[!code-vb[DialogBoxSample#TextFoundEventRaiseCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/FindDialogBox.xaml.vb#textfoundeventraisecodebehind2)]  \n[!code-csharp[DialogBoxSample#TextFoundEventRaiseCODEBEHIND3](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/FindDialogBox.xaml.cs#textfoundeventraisecodebehind3)]\n[!code-vb[DialogBoxSample#TextFoundEventRaiseCODEBEHIND3](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/FindDialogBox.xaml.vb#textfoundeventraisecodebehind3)]  \n[!code-csharp[DialogBoxSample#TextFoundEventRaiseCODEBEHIND4](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/FindDialogBox.xaml.cs#textfoundeventraisecodebehind4)]\n[!code-vb[DialogBoxSample#TextFoundEventRaiseCODEBEHIND4](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/FindDialogBox.xaml.vb#textfoundeventraisecodebehind4)]  \n[!code-csharp[DialogBoxSample#TextFoundEventRaiseCODEBEHIND5](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/FindDialogBox.xaml.cs#textfoundeventraisecodebehind5)]\n[!code-vb[DialogBoxSample#TextFoundEventRaiseCODEBEHIND5](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/FindDialogBox.xaml.vb#textfoundeventraisecodebehind5)]  \n  \n The owner window then needs to register with and handle this event.  \n  \n [!code-csharp[DialogBoxSample#OpenFindDialogResultCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openfinddialogresultcodebehind1)]\n [!code-vb[DialogBoxSample#OpenFindDialogResultCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openfinddialogresultcodebehind1)]  \n[!code-csharp[DialogBoxSample#OpenFindDialogResultCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MainWindow.xaml.cs#openfinddialogresultcodebehind2)]\n[!code-vb[DialogBoxSample#OpenFindDialogResultCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MainWindow.xaml.vb#openfinddialogresultcodebehind2)]  \n  \n#### Closing a Modeless Dialog Box  \n Because <xref:System.Windows.Window.DialogResult%2A> does not need to be set, a modeless dialog can be closed using system provide mechanisms, including the following:  \n  \n-   Clicking the **Close** button in the title bar.  \n  \n-   Pressing ALT+F4.  \n  \n-   Choosing **Close** from the **System** menu.  \n  \n Alternatively, your code can call <xref:System.Windows.Window.Close%2A> when the **Close** button is clicked.  \n  \n [!code-csharp[DialogBoxSample#FindDialogCloseCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/FindDialogBox.xaml.cs#finddialogclosecodebehind1)]\n [!code-vb[DialogBoxSample#FindDialogCloseCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/FindDialogBox.xaml.vb#finddialogclosecodebehind1)]  \n[!code-csharp[DialogBoxSample#FindDialogCloseCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/FindDialogBox.xaml.cs#finddialogclosecodebehind2)]\n[!code-vb[DialogBoxSample#FindDialogCloseCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/FindDialogBox.xaml.vb#finddialogclosecodebehind2)]  \n  \n## See also\n\n- [Popup Overview](../controls/popup-overview.md)\n- [Dialog Box Sample](https://go.microsoft.com/fwlink/?LinkID=159984)\n- [ColorPicker Custom Control Sample](https://go.microsoft.com/fwlink/?LinkID=159977)\n","nodes":[{"pos":[4,277],"embed":true,"restype":"x-metadata","content":"title: \"Dialog Boxes Overview\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"modeless dialog boxes [WPF]\"\n  - \"dialog boxes [WPF]\"\n  - \"message boxes [WPF]\"\n  - \"modal dialog boxes [WPF]\"\nms.assetid: 0d23d544-a393-4a02-a3aa-d8cd5d3d6511","nodes":[{"content":"Dialog Boxes Overview","nodes":[{"pos":[0,21],"content":"Dialog Boxes Overview","nodes":[{"content":"Dialog Boxes Overview","pos":[0,21]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[284,305],"content":"Dialog Boxes Overview","linkify":"Dialog Boxes Overview","nodes":[{"content":"Dialog Boxes Overview","pos":[0,21]}]},{"content":"Standalone applications typically have a main window that both displays the main data over which the application operates and exposes the functionality to process that data through <ph id=\"ph1\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph> mechanisms like menu bars, tool bars, and status bars.","pos":[306,607],"source":"Standalone applications typically have a main window that both displays the main data over which the application operates and exposes the functionality to process that data through [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] mechanisms like menu bars, tool bars, and status bars."},{"content":"A non-trivial application may also display additional windows to do the following:","pos":[608,690]},{"content":"Display specific information to users.","pos":[700,738]},{"content":"Gather information from users.","pos":[748,778]},{"content":"Both display and gather information.","pos":[788,824]},{"pos":[831,927],"content":"These types of windows are known as <bpt id=\"p1\">*</bpt>dialog boxes<ept id=\"p1\">*</ept>, and there are two types: modal and modeless.","source":"These types of windows are known as *dialog boxes*, and there are two types: modal and modeless."},{"content":"A <bpt id=\"p1\">*</bpt>modal<ept id=\"p1\">*</ept> dialog box is displayed by a function when the function needs additional data from a user to continue.","pos":[934,1046],"source":"A *modal* dialog box is displayed by a function when the function needs additional data from a user to continue."},{"content":"Because the function depends on the modal dialog box to gather data, the modal dialog box also prevents a user from activating other windows in the application while it remains open.","pos":[1047,1229]},{"content":"In most cases, a modal dialog box allows a user to signal when they have finished with the modal dialog box by pressing either an <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> button.","pos":[1230,1388],"source":" In most cases, a modal dialog box allows a user to signal when they have finished with the modal dialog box by pressing either an **OK** or **Cancel** button."},{"content":"Pressing the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button indicates that a user has entered data and wants the function to continue processing with that data.","pos":[1389,1516],"source":" Pressing the **OK** button indicates that a user has entered data and wants the function to continue processing with that data."},{"content":"Pressing the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button indicates that a user wants to stop the function from executing altogether.","pos":[1517,1623],"source":" Pressing the **Cancel** button indicates that a user wants to stop the function from executing altogether."},{"content":"The most common examples of modal dialog boxes are shown to open, save, and print data.","pos":[1624,1711]},{"content":"A <bpt id=\"p1\">*</bpt>modeless<ept id=\"p1\">*</ept> dialog box, on the other hand, does not prevent a user from activating other windows while it is open.","pos":[1718,1833],"source":"A *modeless* dialog box, on the other hand, does not prevent a user from activating other windows while it is open."},{"content":"For example, if a user wants to find occurrences of a particular word in a document, a main window will often open a dialog box to ask a user what word they are looking for.","pos":[1834,2007]},{"content":"Since finding a word doesn't prevent a user from editing the document, however, the dialog box doesn't need to be modal.","pos":[2008,2128]},{"content":"A modeless dialog box at least provides a <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> button to close the dialog box, and may provide additional buttons to execute specific functions, such as a <bpt id=\"p2\">**</bpt>Find Next<ept id=\"p2\">**</ept> button to find the next word that matches the find criteria of a word search.","pos":[2129,2380],"source":" A modeless dialog box at least provides a **Close** button to close the dialog box, and may provide additional buttons to execute specific functions, such as a **Find Next** button to find the next word that matches the find criteria of a word search."},{"content":"Windows Presentation Foundation (WPF) allows you to create several types of dialog boxes, including message boxes, common dialog boxes, and custom dialog boxes.","pos":[2387,2547]},{"content":"This topic discusses each, and the <bpt id=\"p1\">[</bpt>Dialog Box Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159984)</ept> provides matching examples.","pos":[2548,2678],"source":" This topic discusses each, and the [Dialog Box Sample](https://go.microsoft.com/fwlink/?LinkID=159984) provides matching examples."},{"pos":[2717,2730],"content":"Message Boxes","linkify":"Message Boxes","nodes":[{"content":"Message Boxes","pos":[0,13]}]},{"content":"A <bpt id=\"p1\">*</bpt>message box<ept id=\"p1\">*</ept> is a dialog box that can be used to display textual information and to allow users to make decisions with buttons.","pos":[2734,2864],"source":"A *message box* is a dialog box that can be used to display textual information and to allow users to make decisions with buttons."},{"content":"The following figure shows a message box that displays textual information, asks a question, and provides the user with three buttons to answer the question.","pos":[2865,3022]},{"content":"A Word Processor dialog box asking if you want to save the changes to the document before the application closes.","pos":[3031,3144]},{"content":"To create a message box, you use the <ph id=\"ph1\">&lt;xref:System.Windows.MessageBox&gt;</ph> class.","pos":[3209,3285],"source":"To create a message box, you use the <xref:System.Windows.MessageBox> class."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.MessageBox&gt;</ph> lets you configure the message box text, title, icon, and buttons, using code like the following.","pos":[3286,3416],"source":"<xref:System.Windows.MessageBox> lets you configure the message box text, title, icon, and buttons, using code like the following."},{"pos":[3816,3947],"content":"To show a message box, you call the <ph id=\"ph1\">`static`</ph><ph id=\"ph2\">&lt;xref:System.Windows.MessageBox.Show%2A&gt;</ph> method, as demonstrated in the following code.","source":"To show a message box, you call the `static`<xref:System.Windows.MessageBox.Show%2A> method, as demonstrated in the following code."},{"content":"When code that shows a message box needs to detect and process the user's decision (which button was pressed), the code can inspect the message box result, as shown in the following code.","pos":[4327,4514]},{"pos":[4934,5158],"content":"For more information on using message boxes, see <ph id=\"ph1\">&lt;xref:System.Windows.MessageBox&gt;</ph>, <bpt id=\"p1\">[</bpt>MessageBox Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=160023)</ept>, and <bpt id=\"p2\">[</bpt>Dialog Box Sample<ept id=\"p2\">](https://go.microsoft.com/fwlink/?LinkID=159984)</ept>.","source":"For more information on using message boxes, see <xref:System.Windows.MessageBox>, [MessageBox Sample](https://go.microsoft.com/fwlink/?LinkID=160023), and [Dialog Box Sample](https://go.microsoft.com/fwlink/?LinkID=159984)."},{"pos":[5165,5562],"content":"Although <ph id=\"ph1\">&lt;xref:System.Windows.MessageBox&gt;</ph> may offer a simple dialog box user experience, the advantage of using <ph id=\"ph2\">&lt;xref:System.Windows.MessageBox&gt;</ph> is that is the only type of window that can be shown by applications that run within a partial trust security sandbox (see <bpt id=\"p1\">[</bpt>Security<ept id=\"p1\">](../security-wpf.md)</ept>), such as <ph id=\"ph3\">[!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)]</ph>.","source":"Although <xref:System.Windows.MessageBox> may offer a simple dialog box user experience, the advantage of using <xref:System.Windows.MessageBox> is that is the only type of window that can be shown by applications that run within a partial trust security sandbox (see [Security](../security-wpf.md)), such as [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)]."},{"content":"Most dialog boxes display and gather more complex data than the result of a message box, including text, selection (check boxes), mutually exclusive selection (radio buttons), and list selection (list boxes, combo boxes, drop-down list boxes).","pos":[5569,5812]},{"content":"For these, Windows Presentation Foundation (WPF) provides several common dialog boxes and allows you to create your own dialog boxes, although the use of either is limited to applications running with full trust.","pos":[5813,6025]},{"pos":[6067,6086],"content":"Common Dialog Boxes","linkify":"Common Dialog Boxes","nodes":[{"content":"Common Dialog Boxes","pos":[0,19]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)]</ph> implements a variety of reusable dialog boxes that are common to all applications, including dialog boxes for opening files, saving files, and printing.","pos":[6090,6314],"source":"[!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] implements a variety of reusable dialog boxes that are common to all applications, including dialog boxes for opening files, saving files, and printing."},{"content":"Since these dialog boxes are implemented by the operating system, they can be shared among all the applications that run on the operating system, which helps user experience consistency; when users are familiar with the use of an operating system-provided dialog box in one application, they don't need to learn how to use that dialog box in other applications.","pos":[6315,6676]},{"content":"Because these dialog boxes are available to all applications and because they help provide a consistent user experience, they are known as <bpt id=\"p1\">*</bpt>common dialog boxes<ept id=\"p1\">*</ept>.","pos":[6677,6838],"source":" Because these dialog boxes are available to all applications and because they help provide a consistent user experience, they are known as *common dialog boxes*."},{"content":"Windows Presentation Foundation (WPF) encapsulates the open file, save file, and print common dialog boxes and exposes them as managed classes for you to use in standalone applications.","pos":[6845,7030]},{"content":"This topic provides a brief overview of each.","pos":[7031,7076]},{"pos":[7121,7137],"content":"Open File Dialog","linkify":"Open File Dialog","nodes":[{"content":"Open File Dialog","pos":[0,16]}]},{"content":"The open file dialog box, shown in the following figure, is used by file opening functionality to retrieve the name of a file to open.","pos":[7141,7275]},{"content":"An Open dialog box showing the location to retrieve the file.","pos":[7284,7345]},{"content":"The common open file dialog box is implemented as the <ph id=\"ph1\">&lt;xref:Microsoft.Win32.OpenFileDialog&gt;</ph> class and is located in the <ph id=\"ph2\">&lt;xref:Microsoft.Win32&gt;</ph> namespace.","pos":[7409,7562],"source":"The common open file dialog box is implemented as the <xref:Microsoft.Win32.OpenFileDialog> class and is located in the <xref:Microsoft.Win32> namespace."},{"content":"The following code shows how to create, configure, and show one, and how to process the result.","pos":[7563,7658]},{"pos":[8066,8187],"content":"For more information on the open file dialog box, see <ph id=\"ph1\">&lt;xref:Microsoft.Win32.OpenFileDialog?displayProperty=nameWithType&gt;</ph>.","source":"For more information on the open file dialog box, see <xref:Microsoft.Win32.OpenFileDialog?displayProperty=nameWithType>."},{"pos":[8195,8366],"content":"[!NOTE]\n <xref:Microsoft.Win32.OpenFileDialog> can be used to safely retrieve file names by applications running with partial trust (see [Security](../security-wpf.md)).","leadings":["","> "],"nodes":[{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.Win32.OpenFileDialog&gt;</ph> can be used to safely retrieve file names by applications running with partial trust (see <bpt id=\"p1\">[</bpt>Security<ept id=\"p1\">](../security-wpf.md)</ept>).","pos":[9,169],"source":"<xref:Microsoft.Win32.OpenFileDialog> can be used to safely retrieve file names by applications running with partial trust (see [Security](../security-wpf.md))."}]},{"pos":[8411,8431],"content":"Save File Dialog Box","linkify":"Save File Dialog Box","nodes":[{"content":"Save File Dialog Box","pos":[0,20]}]},{"content":"The save file dialog box, shown in the following figure, is used by file saving functionality to retrieve the name of a file to save.","pos":[8435,8568]},{"content":"A Save As dialog box showing the location to save the file.","pos":[8577,8636]},{"content":"The common save file dialog box is implemented as the <ph id=\"ph1\">&lt;xref:Microsoft.Win32.SaveFileDialog&gt;</ph> class, and is located in the <ph id=\"ph2\">&lt;xref:Microsoft.Win32&gt;</ph> namespace.","pos":[8700,8854],"source":"The common save file dialog box is implemented as the <xref:Microsoft.Win32.SaveFileDialog> class, and is located in the <xref:Microsoft.Win32> namespace."},{"content":"The following code shows how to create, configure, and show one, and how to process the result.","pos":[8855,8950]},{"pos":[9358,9479],"content":"For more information on the save file dialog box, see <ph id=\"ph1\">&lt;xref:Microsoft.Win32.SaveFileDialog?displayProperty=nameWithType&gt;</ph>.","source":"For more information on the save file dialog box, see <xref:Microsoft.Win32.SaveFileDialog?displayProperty=nameWithType>."},{"pos":[9520,9536],"content":"Print Dialog Box","linkify":"Print Dialog Box","nodes":[{"content":"Print Dialog Box","pos":[0,16]}]},{"content":"The print dialog box, shown in the following figure, is used by printing functionality to choose and configure the printer that a user would like to print data to.","pos":[9540,9703]},{"content":"Screenshot that shows a Print dialog box.","pos":[9712,9753]},{"content":"The common print dialog box is implemented as the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.PrintDialog&gt;</ph> class, and is located in the <ph id=\"ph2\">&lt;xref:System.Windows.Controls&gt;</ph> namespace.","pos":[9818,9981],"source":"The common print dialog box is implemented as the <xref:System.Windows.Controls.PrintDialog> class, and is located in the <xref:System.Windows.Controls> namespace."},{"content":"The following code shows how to create, configure, and show one.","pos":[9982,10046]},{"content":"For more information on the print dialog box, see <ph id=\"ph1\">&lt;xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType&gt;</ph>.","pos":[10442,10564],"source":"For more information on the print dialog box, see <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType>."},{"content":"For detailed discussion of printing in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Printing Overview<ept id=\"p1\">](../advanced/printing-overview.md)</ept>.","pos":[10565,10733],"source":" For detailed discussion of printing in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], see [Printing Overview](../advanced/printing-overview.md)."},{"pos":[10780,10799],"content":"Custom Dialog Boxes","linkify":"Custom Dialog Boxes","nodes":[{"content":"Custom Dialog Boxes","pos":[0,19]}]},{"content":"While common dialog boxes are useful, and should be used when possible, they do not support the requirements of domain-specific dialog boxes.","pos":[10803,10944]},{"content":"In these cases, you need to create your own dialog boxes.","pos":[10945,11002]},{"content":"As we'll see, a dialog box is a window with special behaviors.","pos":[11003,11065]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> implements those behaviors and, consequently, you use <ph id=\"ph2\">&lt;xref:System.Windows.Window&gt;</ph> to create custom modal and modeless dialog boxes.","pos":[11066,11227],"source":"<xref:System.Windows.Window> implements those behaviors and, consequently, you use <xref:System.Windows.Window> to create custom modal and modeless dialog boxes."},{"pos":[11290,11324],"content":"Creating a Modal Custom Dialog Box","linkify":"Creating a Modal Custom Dialog Box","nodes":[{"content":"Creating a Modal Custom Dialog Box","pos":[0,34]}]},{"content":"This topic shows how to use <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> to create a typical modal dialog box implementation, using the <ph id=\"ph2\">`Margins`</ph> dialog box as an example (see <bpt id=\"p1\">[</bpt>Dialog Box Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159984)</ept>).","pos":[11328,11557],"source":"This topic shows how to use <xref:System.Windows.Window> to create a typical modal dialog box implementation, using the `Margins` dialog box as an example (see [Dialog Box Sample](https://go.microsoft.com/fwlink/?LinkID=159984))."},{"content":"The <ph id=\"ph1\">`Margins`</ph> dialog box is shown in the following figure.","pos":[11558,11616],"source":" The `Margins` dialog box is shown in the following figure."},{"content":"A Margins dialog box with fields to define left margin, top margin, right margin, and bottom margin.","pos":[11625,11725]},{"pos":[11795,11825],"content":"Configuring a Modal Dialog Box","linkify":"Configuring a Modal Dialog Box","nodes":[{"content":"Configuring a Modal Dialog Box","pos":[0,30]}]},{"content":"The user interface for a typical dialog box includes the following:","pos":[11829,11896]},{"content":"The various controls that are required to gather the desired data.","pos":[11906,11972]},{"pos":[11982,12097],"content":"Showing an <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button that users click to close the dialog box, return to the function, and continue processing.","source":"Showing an **OK** button that users click to close the dialog box, return to the function, and continue processing."},{"pos":[12107,12222],"content":"Showing a <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button that users click to close the dialog box and stop the function from further processing.","source":"Showing a **Cancel** button that users click to close the dialog box and stop the function from further processing."},{"pos":[12232,12276],"content":"Showing a <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> button in the title bar.","source":"Showing a **Close** button in the title bar."},{"content":"Showing an icon.","pos":[12286,12302]},{"pos":[12312,12372],"content":"Showing <bpt id=\"p1\">**</bpt>Minimize<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Maximize<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>Restore<ept id=\"p3\">**</ept> buttons.","source":"Showing **Minimize**, **Maximize**, and **Restore** buttons."},{"pos":[12382,12465],"content":"Showing a <bpt id=\"p1\">**</bpt>System<ept id=\"p1\">**</ept> menu to minimize, maximize, restore, and close the dialog box.","source":"Showing a **System** menu to minimize, maximize, restore, and close the dialog box."},{"content":"Opening above and in the center of the window that opened the dialog box.","pos":[12475,12548]},{"content":"Dialog boxes should be resizable where possible so, to prevent the dialog box from being too small, and to provide the user with a useful default size, you need to set both default and a minimum dimensions respectively.","pos":[12558,12777]},{"content":"Pressing the ESC key should be configured as a keyboard shortcut that causes the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button to be pressed.","pos":[12787,12900],"source":"Pressing the ESC key should be configured as a keyboard shortcut that causes the **Cancel** button to be pressed."},{"content":"This is achieved by setting the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button.IsCancel%2A&gt;</ph> property of the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button to <ph id=\"ph2\">`true`</ph>.","pos":[12901,13027],"source":" This is achieved by setting the <xref:System.Windows.Controls.Button.IsCancel%2A> property of the **Cancel** button to `true`."},{"content":"Pressing the ENTER (or RETURN) key should be configured as a keyboard shortcut that causes the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button to be pressed.","pos":[13037,13160],"source":"Pressing the ENTER (or RETURN) key should be configured as a keyboard shortcut that causes the **OK** button to be pressed."},{"content":"This is achieved by setting the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button.IsDefault%2A&gt;</ph> property of the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button <ph id=\"ph2\">`true`</ph>.","pos":[13161,13281],"source":" This is achieved by setting the <xref:System.Windows.Controls.Button.IsDefault%2A> property of the **OK** button `true`."},{"content":"The following code demonstrates this configuration.","pos":[13288,13339]},{"pos":[13718,14512],"content":"[!code-csharp[DialogBoxSample#MarginsDialogBoxMainBitsCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxmainbitscodebehind1)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxMainBitsCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxmainbitscodebehind1)]  \n[!code-csharp[DialogBoxSample#MarginsDialogBoxMainBitsCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxmainbitscodebehind2)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxMainBitsCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxmainbitscodebehind2)]","leadings":[""," ","",""],"nodes":[]},{"content":"The user experience for a dialog box also extends into the menu bar of the window that opens the dialog box.","pos":[14519,14627]},{"content":"When a menu item runs a function that requires user interaction through a dialog box before the function can continue, the menu item for the function will have an ellipsis in its header, as shown here.","pos":[14628,14829]},{"content":"When a menu item runs a function that displays a dialog box which does not require user interaction, such as an About dialog box, an ellipsis is not required.","pos":[15236,15394]},{"pos":[15405,15431],"content":"Opening a Modal Dialog Box","linkify":"Opening a Modal Dialog Box","nodes":[{"content":"Opening a Modal Dialog Box","pos":[0,26]}]},{"content":"A dialog box is typically shown as a result of a user selecting a menu item to perform a domain-specific function, such as setting the margins of a document in a word processor.","pos":[15435,15612]},{"content":"Showing a window as a dialog box is similar to showing a normal window, although it requires additional dialog box-specific configuration.","pos":[15613,15751]},{"content":"The entire process of instantiating, configuring, and opening a dialog box is shown in the following code.","pos":[15752,15858]},{"content":"Here, the code is passing default information (the current margins) to the dialog box.","pos":[17302,17388]},{"content":"It is also setting the <ph id=\"ph1\">&lt;xref:System.Windows.Window.Owner%2A?displayProperty=nameWithType&gt;</ph> property with a reference to the window that is showing the dialog box.","pos":[17389,17550],"source":" It is also setting the <xref:System.Windows.Window.Owner%2A?displayProperty=nameWithType> property with a reference to the window that is showing the dialog box."},{"content":"In general, you should always set the owner for a dialog box to provide window state-related behaviors that are common to all dialog boxes (see <bpt id=\"p1\">[</bpt>WPF Windows Overview<ept id=\"p1\">](wpf-windows-overview.md)</ept> for more information).","pos":[17551,17765],"source":" In general, you should always set the owner for a dialog box to provide window state-related behaviors that are common to all dialog boxes (see [WPF Windows Overview](wpf-windows-overview.md) for more information)."},{"pos":[17773,17993],"content":"[!NOTE]\n You must provide an owner to support [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] automation for dialog boxes (see [UI Automation Overview](../../ui-automation/ui-automation-overview.md)).","leadings":["","> "],"nodes":[{"content":"You must provide an owner to support <ph id=\"ph1\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph> automation for dialog boxes (see <bpt id=\"p1\">[</bpt>UI Automation Overview<ept id=\"p1\">](../../ui-automation/ui-automation-overview.md)</ept>).","pos":[9,218],"source":"You must provide an owner to support [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] automation for dialog boxes (see [UI Automation Overview](../../ui-automation/ui-automation-overview.md))."}]},{"pos":[18000,18121],"content":"After the dialog box is configured, it is shown modally by calling the <ph id=\"ph1\">&lt;xref:System.Windows.Window.ShowDialog%2A&gt;</ph> method.","source":"After the dialog box is configured, it is shown modally by calling the <xref:System.Windows.Window.ShowDialog%2A> method."},{"pos":[18132,18161],"content":"Validating User-Provided Data","linkify":"Validating User-Provided Data","nodes":[{"content":"Validating User-Provided Data","pos":[0,29]}]},{"content":"When a dialog box is opened and the user provides the required data, a dialog box is responsible for ensuring that the provided data is valid for the following reasons:","pos":[18165,18333]},{"content":"From a security perspective, all input should be validated.","pos":[18343,18402]},{"content":"From a domain-specific perspective, data validation prevents erroneous data from being processed by the code, which could potentially throw exceptions.","pos":[18412,18563]},{"content":"From a user-experience perspective, a dialog box can help users by showing them which data they have entered is invalid.","pos":[18573,18693]},{"content":"From a performance perspective, data validation in a multi-tier application can reduce the number of round trips between the client and the application tiers, particularly when the application is composed of Web services or server-based databases.","pos":[18703,18950]},{"content":"To validate a bound control in <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph>, you need to define a validation rule and associate it with the binding.","pos":[18957,19130],"source":"To validate a bound control in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], you need to define a validation rule and associate it with the binding."},{"content":"A validation rule is a custom class that derives from <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ValidationRule&gt;</ph>.","pos":[19131,19231],"source":" A validation rule is a custom class that derives from <xref:System.Windows.Controls.ValidationRule>."},{"content":"The following example shows a validation rule, <ph id=\"ph1\">`MarginValidationRule`</ph>, which checks that a bound value is a <ph id=\"ph2\">&lt;xref:System.Double&gt;</ph> and is within a specified range.","pos":[19232,19393],"source":" The following example shows a validation rule, `MarginValidationRule`, which checks that a bound value is a <xref:System.Double> and is within a specified range."},{"pos":[19400,19750],"content":"[!code-csharp[DialogBoxSample#MarginValidationRuleCODE](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginValidationRule.cs#marginvalidationrulecode)]\n[!code-vb[DialogBoxSample#MarginValidationRuleCODE](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginValidationRule.vb#marginvalidationrulecode)]","leadings":[""," "],"nodes":[]},{"pos":[19757,20012],"content":"In this code, the validation logic of a validation rule is implemented by overriding the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.ValidationRule.Validate%2A&gt;</ph> method, which validates the data and returns an appropriate <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ValidationResult&gt;</ph>.","source":"In this code, the validation logic of a validation rule is implemented by overriding the <xref:System.Windows.Controls.ValidationRule.Validate%2A> method, which validates the data and returns an appropriate <xref:System.Windows.Controls.ValidationResult>."},{"content":"To associate the validation rule with the bound control, you use the following markup.","pos":[20019,20105]},{"content":"Once the validation rule is associated, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> will automatically apply it when data is entered into the bound control.","pos":[20626,20808],"source":"Once the validation rule is associated, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] will automatically apply it when data is entered into the bound control."},{"content":"When a control contains invalid data, <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> will display a red border around the invalid control, as shown in the following figure.","pos":[20809,21004],"source":" When a control contains invalid data, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] will display a red border around the invalid control, as shown in the following figure."},{"content":"A Margins dialog box with a red border around the invalid left margin value.","pos":[21013,21089]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> does not restrict a user to the invalid control until they have entered valid data.","pos":[21159,21312],"source":"[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] does not restrict a user to the invalid control until they have entered valid data."},{"content":"This is good behavior for a dialog box; a user should be able to freely navigate the controls in a dialog box whether or not data is valid.","pos":[21313,21452]},{"content":"However, this means a user can enter invalid data and press the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button.","pos":[21453,21531],"source":" However, this means a user can enter invalid data and press the **OK** button."},{"content":"For this reason, your code also needs to validate all controls in a dialog box when the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button is pressed by handling the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase.Click&gt;</ph> event.","pos":[21532,21726],"source":" For this reason, your code also needs to validate all controls in a dialog box when the **OK** button is pressed by handling the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event."},{"pos":[21733,22949],"content":"[!code-csharp[DialogBoxSample#MarginsDialogBoxValidationCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxvalidationcodebehind1)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxValidationCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxvalidationcodebehind1)]  \n[!code-csharp[DialogBoxSample#MarginsDialogBoxValidationCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxvalidationcodebehind2)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxValidationCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxvalidationcodebehind2)]  \n[!code-csharp[DialogBoxSample#MarginsDialogBoxValidationCODEBEHIND3](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/MarginsDialogBox.xaml.cs#marginsdialogboxvalidationcodebehind3)]\n[!code-vb[DialogBoxSample#MarginsDialogBoxValidationCODEBEHIND3](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/MarginsDialogBox.xaml.vb#marginsdialogboxvalidationcodebehind3)]","leadings":[""," ","","","",""],"nodes":[]},{"pos":[22956,23221],"content":"This code enumerates all dependency objects on a window and, if any are invalid (as returned by <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Validation.GetHasError%2A&gt;</ph>, the invalid control gets the focus, the <ph id=\"ph2\">`IsValid`</ph> method returns <ph id=\"ph3\">`false`</ph>, and the window is considered invalid.","source":"This code enumerates all dependency objects on a window and, if any are invalid (as returned by <xref:System.Windows.Controls.Validation.GetHasError%2A>, the invalid control gets the focus, the `IsValid` method returns `false`, and the window is considered invalid."},{"content":"Once a dialog box is valid, it can safely close and return.","pos":[23228,23287]},{"content":"As part of the return process, it needs to return a result to the calling function.","pos":[23288,23371]},{"pos":[23382,23413],"content":"Setting the Modal Dialog Result","linkify":"Setting the Modal Dialog Result","nodes":[{"content":"Setting the Modal Dialog Result","pos":[0,31]}]},{"content":"Opening a dialog box using <ph id=\"ph1\">&lt;xref:System.Windows.Window.ShowDialog%2A&gt;</ph> is fundamentally like calling a method: the code that opened the dialog box using <ph id=\"ph2\">&lt;xref:System.Windows.Window.ShowDialog%2A&gt;</ph> waits until <ph id=\"ph3\">&lt;xref:System.Windows.Window.ShowDialog%2A&gt;</ph> returns.","pos":[23417,23675],"source":"Opening a dialog box using <xref:System.Windows.Window.ShowDialog%2A> is fundamentally like calling a method: the code that opened the dialog box using <xref:System.Windows.Window.ShowDialog%2A> waits until <xref:System.Windows.Window.ShowDialog%2A> returns."},{"content":"When <ph id=\"ph1\">&lt;xref:System.Windows.Window.ShowDialog%2A&gt;</ph> returns, the code that called it needs to decide whether to continue processing or stop processing, based on whether the user pressed the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button or the <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> button.","pos":[23676,23901],"source":" When <xref:System.Windows.Window.ShowDialog%2A> returns, the code that called it needs to decide whether to continue processing or stop processing, based on whether the user pressed the **OK** button or the **Cancel** button."},{"content":"To facilitate this decision, the dialog box needs to return the user's choice as a <ph id=\"ph1\">&lt;xref:System.Boolean&gt;</ph> value that is returned from the <ph id=\"ph2\">&lt;xref:System.Windows.Window.ShowDialog%2A&gt;</ph> method.","pos":[23902,24089],"source":" To facilitate this decision, the dialog box needs to return the user's choice as a <xref:System.Boolean> value that is returned from the <xref:System.Windows.Window.ShowDialog%2A> method."},{"content":"When the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button is clicked, <ph id=\"ph1\">&lt;xref:System.Windows.Window.ShowDialog%2A&gt;</ph> should return <ph id=\"ph2\">`true`</ph>.","pos":[24096,24195],"source":"When the **OK** button is clicked, <xref:System.Windows.Window.ShowDialog%2A> should return `true`."},{"content":"This is achieved by setting the <ph id=\"ph1\">&lt;xref:System.Windows.Window.DialogResult%2A&gt;</ph> property of the dialog box when the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button is clicked.","pos":[24196,24334],"source":" This is achieved by setting the <xref:System.Windows.Window.DialogResult%2A> property of the dialog box when the **OK** button is clicked."},{"pos":[25986,26192],"content":"Note that setting the <ph id=\"ph1\">&lt;xref:System.Windows.Window.DialogResult%2A&gt;</ph> property also causes the window to close automatically, which alleviates the need to explicitly call <ph id=\"ph2\">&lt;xref:System.Windows.Window.Close%2A&gt;</ph>.","source":"Note that setting the <xref:System.Windows.Window.DialogResult%2A> property also causes the window to close automatically, which alleviates the need to explicitly call <xref:System.Windows.Window.Close%2A>."},{"pos":[26199,26390],"content":"When the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button is clicked, <ph id=\"ph1\">&lt;xref:System.Windows.Window.ShowDialog%2A&gt;</ph> should return <ph id=\"ph2\">`false`</ph>, which also requires setting the <ph id=\"ph3\">&lt;xref:System.Windows.Window.DialogResult%2A&gt;</ph> property.","source":"When the **Cancel** button is clicked, <xref:System.Windows.Window.ShowDialog%2A> should return `false`, which also requires setting the <xref:System.Windows.Window.DialogResult%2A> property."},{"content":"When a button's <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button.IsCancel%2A&gt;</ph> property is set to <ph id=\"ph2\">`true`</ph> and the user presses either the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button or the ESC key, <ph id=\"ph3\">&lt;xref:System.Windows.Window.DialogResult%2A&gt;</ph> is automatically set to <ph id=\"ph4\">`false`</ph>.","pos":[27680,27915],"source":"When a button's <xref:System.Windows.Controls.Button.IsCancel%2A> property is set to `true` and the user presses either the **Cancel** button or the ESC key, <xref:System.Windows.Window.DialogResult%2A> is automatically set to `false`."},{"content":"The following markup has the same effect as the preceding code, without the need to handle the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase.Click&gt;</ph> event.","pos":[27916,28076],"source":" The following markup has the same effect as the preceding code, without the need to handle the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event."},{"pos":[28273,28434],"content":"A dialog box automatically returns <ph id=\"ph1\">`false`</ph> when a user presses the <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> button in the title bar or chooses the <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept> menu item from the <bpt id=\"p3\">**</bpt>System<ept id=\"p3\">**</ept> menu.","source":"A dialog box automatically returns `false` when a user presses the **Close** button in the title bar or chooses the **Close** menu item from the **System** menu."},{"pos":[28445,28493],"content":"Processing Data Returned from a Modal Dialog Box","linkify":"Processing Data Returned from a Modal Dialog Box","nodes":[{"content":"Processing Data Returned from a Modal Dialog Box","pos":[0,48]}]},{"pos":[28497,28757],"content":"When <ph id=\"ph1\">&lt;xref:System.Windows.Window.DialogResult%2A&gt;</ph> is set by a dialog box, the function that opened it can get the dialog box result by inspecting the <ph id=\"ph2\">&lt;xref:System.Windows.Window.DialogResult%2A&gt;</ph> property when <ph id=\"ph3\">&lt;xref:System.Windows.Window.ShowDialog%2A&gt;</ph> returns.","source":"When <xref:System.Windows.Window.DialogResult%2A> is set by a dialog box, the function that opened it can get the dialog box result by inspecting the <xref:System.Windows.Window.DialogResult%2A> property when <xref:System.Windows.Window.ShowDialog%2A> returns."},{"pos":[30409,30527],"content":"If the dialog result is <ph id=\"ph1\">`true`</ph>, the function uses that as a cue to retrieve and process the data provided by the user.","source":"If the dialog result is `true`, the function uses that as a cue to retrieve and process the data provided by the user."},{"pos":[30535,30685],"content":"[!NOTE]\n After <xref:System.Windows.Window.ShowDialog%2A> has returned, a dialog box cannot be reopened. Instead, you need to create a new instance.","leadings":["","> "],"nodes":[{"content":"After <xref:System.Windows.Window.ShowDialog%2A> has returned, a dialog box cannot be reopened. Instead, you need to create a new instance.","pos":[9,148],"nodes":[{"content":"After <ph id=\"ph1\">&lt;xref:System.Windows.Window.ShowDialog%2A&gt;</ph> has returned, a dialog box cannot be reopened.","pos":[0,95],"source":"After <xref:System.Windows.Window.ShowDialog%2A> has returned, a dialog box cannot be reopened."},{"content":"Instead, you need to create a new instance.","pos":[96,139]}]}]},{"pos":[30692,30774],"content":"If the dialog result is <ph id=\"ph1\">`false`</ph>, the function should end processing appropriately.","source":"If the dialog result is `false`, the function should end processing appropriately."},{"pos":[30840,30877],"content":"Creating a Modeless Custom Dialog Box","linkify":"Creating a Modeless Custom Dialog Box","nodes":[{"content":"Creating a Modeless Custom Dialog Box","pos":[0,37]}]},{"content":"A modeless dialog box, such as the Find Dialog Box shown in the following figure, has the same fundamental appearance as the modal dialog box.","pos":[30881,31023]},{"content":"Screenshot that shows a Find dialog box.","pos":[31032,31072]},{"content":"However, the behavior is slightly different, as described in the following sections.","pos":[31140,31224]},{"pos":[31235,31264],"content":"Opening a Modeless Dialog Box","linkify":"Opening a Modeless Dialog Box","nodes":[{"content":"Opening a Modeless Dialog Box","pos":[0,29]}]},{"pos":[31268,31359],"content":"A modeless dialog box is opened by calling the <ph id=\"ph1\">&lt;xref:System.Windows.Window.Show%2A&gt;</ph> method.","source":"A modeless dialog box is opened by calling the <xref:System.Windows.Window.Show%2A> method."},{"content":"Unlike <ph id=\"ph1\">&lt;xref:System.Windows.Window.ShowDialog%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Window.Show%2A&gt;</ph> returns immediately.","pos":[32571,32679],"source":"Unlike <xref:System.Windows.Window.ShowDialog%2A>, <xref:System.Windows.Window.Show%2A> returns immediately."},{"content":"Consequently, the calling window cannot tell when the modeless dialog box is closed and, therefore, does not know when to check for a dialog box result or get data from the dialog box for further processing.","pos":[32680,32887]},{"content":"Instead, the dialog box needs to create an alternative way to return data to the calling window for processing.","pos":[32888,32999]},{"pos":[33010,33061],"content":"Processing Data Returned from a Modeless Dialog Box","linkify":"Processing Data Returned from a Modeless Dialog Box","nodes":[{"content":"Processing Data Returned from a Modeless Dialog Box","pos":[0,51]}]},{"content":"In this example, the <ph id=\"ph1\">`FindDialogBox`</ph> may return one or more find results to the main window, depending on the text being searched for without any specific frequency.","pos":[33065,33230],"source":"In this example, the `FindDialogBox` may return one or more find results to the main window, depending on the text being searched for without any specific frequency."},{"content":"As with a modal dialog box, a modeless dialog box can return results using properties.","pos":[33231,33317]},{"content":"However, the window that owns the dialog box needs to know when to check those properties.","pos":[33318,33408]},{"content":"One way to enable this is for the dialog box to implement an event that is raised whenever text is found.","pos":[33409,33514]},{"content":"<ph id=\"ph1\">`FindDialogBox`</ph> implements the <ph id=\"ph2\">`TextFoundEvent`</ph> for this purpose, which first requires a delegate.","pos":[33515,33613],"source":"`FindDialogBox` implements the `TextFoundEvent` for this purpose, which first requires a delegate."},{"pos":[33983,34075],"content":"Using the <ph id=\"ph1\">`TextFoundEventHandler`</ph> delegate, <ph id=\"ph2\">`FindDialogBox`</ph> implements the <ph id=\"ph3\">`TextFoundEvent`</ph>.","source":"Using the `TextFoundEventHandler` delegate, `FindDialogBox` implements the `TextFoundEvent`."},{"pos":[34791,34862],"content":"Consequently, <ph id=\"ph1\">`Find`</ph> can raise the event when a search result is found.","source":"Consequently, `Find` can raise the event when a search result is found."},{"content":"The owner window then needs to register with and handle this event.","pos":[36734,36801]},{"pos":[37557,37586],"content":"Closing a Modeless Dialog Box","linkify":"Closing a Modeless Dialog Box","nodes":[{"content":"Closing a Modeless Dialog Box","pos":[0,29]}]},{"pos":[37590,37757],"content":"Because <ph id=\"ph1\">&lt;xref:System.Windows.Window.DialogResult%2A&gt;</ph> does not need to be set, a modeless dialog can be closed using system provide mechanisms, including the following:","source":"Because <xref:System.Windows.Window.DialogResult%2A> does not need to be set, a modeless dialog can be closed using system provide mechanisms, including the following:"},{"pos":[37767,37814],"content":"Clicking the <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> button in the title bar.","source":"Clicking the **Close** button in the title bar."},{"content":"Pressing ALT+F4.","pos":[37824,37840]},{"pos":[37850,37894],"content":"Choosing <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>System<ept id=\"p2\">**</ept> menu.","source":"Choosing **Close** from the **System** menu."},{"pos":[37901,38010],"content":"Alternatively, your code can call <ph id=\"ph1\">&lt;xref:System.Windows.Window.Close%2A&gt;</ph> when the <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> button is clicked.","source":"Alternatively, your code can call <xref:System.Windows.Window.Close%2A> when the **Close** button is clicked."},{"pos":[38017,38727],"content":"[!code-csharp[DialogBoxSample#FindDialogCloseCODEBEHIND1](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/FindDialogBox.xaml.cs#finddialogclosecodebehind1)]\n[!code-vb[DialogBoxSample#FindDialogCloseCODEBEHIND1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/FindDialogBox.xaml.vb#finddialogclosecodebehind1)]  \n[!code-csharp[DialogBoxSample#FindDialogCloseCODEBEHIND2](~/samples/snippets/csharp/VS_Snippets_Wpf/DialogBoxSample/CSharp/FindDialogBox.xaml.cs#finddialogclosecodebehind2)]\n[!code-vb[DialogBoxSample#FindDialogCloseCODEBEHIND2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DialogBoxSample/VisualBasic/FindDialogBox.xaml.vb#finddialogclosecodebehind2)]","leadings":[""," ","",""],"nodes":[]},{"pos":[38736,38744],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[38748,38795],"content":"<bpt id=\"p1\">[</bpt>Popup Overview<ept id=\"p1\">](../controls/popup-overview.md)</ept>","source":"[Popup Overview](../controls/popup-overview.md)"},{"pos":[38798,38865],"content":"<bpt id=\"p1\">[</bpt>Dialog Box Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159984)</ept>","source":"[Dialog Box Sample](https://go.microsoft.com/fwlink/?LinkID=159984)"},{"pos":[38868,38951],"content":"<bpt id=\"p1\">[</bpt>ColorPicker Custom Control Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159977)</ept>","source":"[ColorPicker Custom Control Sample](https://go.microsoft.com/fwlink/?LinkID=159977)"}]}