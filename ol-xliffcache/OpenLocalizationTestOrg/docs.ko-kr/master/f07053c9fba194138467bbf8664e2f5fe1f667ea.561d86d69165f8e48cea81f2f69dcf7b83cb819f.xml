{"content":"---\ntitle: \"Data Binding\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nms.assetid: cbec8b02-a1e8-4ae8-a83b-bb5190413ac5\n---\n\n# Data Binding\n\n[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] supports binding to common controls, such as grid controls. Specifically, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] defines the basic patterns for binding to a data grid and handling master-detail binding, both with regard to display and updating.\n\n## Underlying Principle\n\n[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] translates [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] queries to SQL for execution on a database. The results are strongly typed `IEnumerable`. Because these objects are ordinary common language runtime (CLR) objects, ordinary object data binding can be used to display the results. On the other hand, change operations (inserts, updates, and deletes) require additional steps.\n\n## Operation\n\nImplicitly binding to Windows Forms controls is accomplished by implementing <xref:System.ComponentModel.IListSource>. Data sources generic <xref:System.Data.Linq.Table%601> (`Table<T>` in C# or `Table(Of T)` in Visual Basic) and generic `DataQuery` have been updated to implement <xref:System.ComponentModel.IListSource>. User interface (UI) data-binding engines (Windows Forms and Windows Presentation Foundation) both test whether their data source implements <xref:System.ComponentModel.IListSource>. Therefore, writing a direct affectation of a query to a data source of a control implicitly calls [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] collection generation, as in the following example:\n\n[!code-csharp[DLinqDataBinding#1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqDataBinding/cs/Program.cs#1)]\n[!code-vb[DLinqDataBinding#1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqDataBinding/vb/Module1.vb#1)]\n\nThe same occurs with Windows Presentation Foundation:\n\n[!code-csharp[DLinqDataBinding#2](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqDataBinding/cs/Program.cs#2)]\n[!code-vb[DLinqDataBinding#2](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqDataBinding/vb/Module1.vb#2)]\n\nCollection generations are implemented by generic <xref:System.Data.Linq.Table%601> and generic `DataQuery` in <xref:System.ComponentModel.IListSource.GetList%2A>.\n\n## IListSource Implementation\n\n[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] implements <xref:System.ComponentModel.IListSource> in two locations:\n\n- The data source is a <xref:System.Data.Linq.Table%601>: [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] browses the table to fill a `DataBindingList` collection that keeps a reference on the table.\n\n- The data source is an <xref:System.Linq.IQueryable%601>. There are two scenarios:\n\n    - If [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] finds the underlying <xref:System.Data.Linq.Table%601> from the <xref:System.Linq.IQueryable%601>, the source allows for edition and the situation is the same as in the first bullet point.\n\n    - If [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] cannot find the underlying <xref:System.Data.Linq.Table%601>, the source does not allow for edition (for example, `groupby`). [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] browses the query to fill a generic `SortableBindingList`, which is a simple <xref:System.ComponentModel.BindingList%601> that implements the sorting feature for T entities for a given property.\n\n## Specialized Collections\n\nFor many features described earlier in this document, <xref:System.ComponentModel.BindingList%601> has been specialized to some different classes. These classes are generic `SortableBindingList` and generic `DataBindingList`. Both are declared as internal.\n\n### Generic SortableBindingList\n\nThis class inherits from <xref:System.ComponentModel.BindingList%601>, and is a sortable version of <xref:System.ComponentModel.BindingList%601>. Sorting is an in-memory solution and never contacts the database itself. <xref:System.ComponentModel.BindingList%601> implements <xref:System.ComponentModel.IBindingList> but does not support sorting by default. However, <xref:System.ComponentModel.BindingList%601> implements <xref:System.ComponentModel.IBindingList> with virtual *core* methods. You can easily override these methods. Generic `SortableBindingList` overrides <xref:System.ComponentModel.BindingList%601.SupportsSortingCore%2A>, <xref:System.ComponentModel.BindingList%601.SortPropertyCore%2A>, <xref:System.ComponentModel.BindingList%601.SortDirectionCore%2A>, and <xref:System.ComponentModel.BindingList%601.ApplySortCore%2A>. `ApplySortCore` is called by <xref:System.ComponentModel.IBindingList.ApplySort%2A> and sorts the list of T items for a given property.\n\nAn exception is raised if the property does not belong to T.\n\nTo achieve sorting, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] creates a generic `SortableBindingList.PropertyComparer` class that inherits from generic <xref:System.Collections.Generic.Comparer%601.System%23Collections%23IComparer%23Compare%2A> and implements a default comparer for a given type T, a `PropertyDescriptor`, and a direction. This class dynamically creates a `Comparer` of T where T is the `PropertyType` of the `PropertyDescriptor`. Then, the default comparer is retrieved from the static generic `Comparer`. A default instance is obtained by using reflection.\n\nGeneric `SortableBindingList` is also the base class for `DataBindingList`. Generic `SortableBindingList` offers two virtual methods for suspending or resuming items add/remove tracking. Those two methods can be used for base features such as sorting, but will really be implemented by upper classes like generic `DataBindingList`.\n\n### Generic DataBindingList\n\nThis class inherits from generic `SortableBindingLIst`. Generic `DataBindingList` keeps a reference on the underlying generic `Table` of the generic `IQueryable` used for the initial filling of the collection. Generic `DatabindingList` adds tracking for item add/remove to the collection by overriding `InsertItem`() and `RemoveItem`(). It also implements the abstract suspend/resume tracking feature to make tracking conditional. This feature makes generic `DataBindingList` take advantage of all the polymorphic usage of the tracking feature of the parent classes.\n\n## Binding to EntitySets\n\nBinding to `EntitySet` is a special case because `EntitySet` is already a collection that implements <xref:System.ComponentModel.IBindingList>. [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] adds sorting and canceling (<xref:System.ComponentModel.ICancelAddNew>) support. An `EntitySet` class uses an internal list to store entities. This list is a low-level collection based on a generic array, the generic `ItemList` class.\n\n### Adding a Sorting Feature\n\nArrays offer a sort method (`Array.Sort()`) that you can be used with a `Comparer` of T. [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] uses the generic `SortableBindingList.PropertyComparer` class described earlier in this topic to obtain this `Comparer` for the property and the direction to be sorted on. An `ApplySort` method is added to generic `ItemList` to call this feature.\n\nOn the `EntitySet` side, you now have to declare sorting support:\n\n- <xref:System.ComponentModel.IBindingList.SupportsSorting%2A> returns `true`.\n\n- <xref:System.ComponentModel.IBindingList.ApplySort%2A> calls `entities.ApplySort()` and then `OnListChanged()`.\n\n- <xref:System.ComponentModel.IBindingList.SortDirection%2A> and <xref:System.ComponentModel.IBindingList.SortProperty%2A> properties expose the current sorting definition, which is stored in local members.\n\nWhen you use a System.Windows.Forms.BindingSource and bind an EntitySet\\<TEntity> to the System.Windows.Forms.BindingSource.DataSource, you must call EntitySet\\<TEntity>.GetNewBindingList to update BindingSource.List.\n\nIf you use a System.Windows.Forms.BindingSource and set the BindingSource.DataMember property and set BindingSource.DataSource to a class that has a property named in the BindingSource.DataMember that exposes the EntitySet\\<TEntity>, you don’t have to call EntitySet\\<TEntity>.GetNewBindingList to update the BindingSource.List but you lose Sorting capability.\n\n## Caching\n\n[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] queries implement <xref:System.ComponentModel.IListSource.GetList%2A>. When the Windows Forms BindingSource class meets this interface, it calls GetList() threes time for a single connection. To work around this situation, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] implements a cache per instance to store and always return the same generated collection.\n\n## Cancellation\n\n<xref:System.ComponentModel.IBindingList> defines an <xref:System.ComponentModel.IBindingList.AddNew%2A> method that is used by controls to create a new item from a bound collection. The `DataGridView` control shows this feature very well when the last visible row contains a star in its header. The star shows you that you can add a new item.\n\nIn addition to this feature, a collection can also implement <xref:System.ComponentModel.ICancelAddNew>. This feature allows for the controls to cancel or validate that the new edited item has been validated or not.\n\n<xref:System.ComponentModel.ICancelAddNew> is implemented in all [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] databound collections (generic `SortableBindingList` and generic `EntitySet`). In both implementations the code performs as follows:\n\n- Lets items be inserted and then removed from the collection.\n\n- Does not track changes as long as the UI does not commit the edition.\n\n- Does not track changes as long as the edition is canceled (<xref:System.ComponentModel.ICancelAddNew.CancelNew%2A>).\n\n- Allows tracking when the edition is committed (<xref:System.ComponentModel.ICancelAddNew.EndNew%2A>).\n\n- Lets the collection behave normally if the new item does not come from <xref:System.ComponentModel.IBindingList.AddNew%2A>.\n\n## Troubleshooting\n\nThis section calls out several items that might help troubleshoot your [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] data binding applications.\n\n- You must use properties; using only fields is not sufficient. Windows Forms require this usage.\n\n- By default, `image`, `varbinary`, and `timestamp` database types map to byte array. Because `ToString()` is not supported in this scenario, these objects cannot be displayed.\n\n- A class member mapped to a primary key has a setter, but [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] does not support object identity change. Therefore, the primary/unique key that is used in mapping cannot be updated in the database. A change in the grid causes an exception when you call <xref:System.Data.Linq.DataContext.SubmitChanges%2A>.\n\n- If an entity is bound in two separate grids (for example, one master and another detail), a `Delete` in the master grid is not propagated to the detail grid.\n\n## See also\n\n- [Background Information](../../../../../../docs/framework/data/adonet/sql/linq/background-information.md)\n","nodes":[{"pos":[4,129],"embed":true,"restype":"x-metadata","content":"title: \"Data Binding\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nms.assetid: cbec8b02-a1e8-4ae8-a83b-bb5190413ac5","nodes":[{"content":"Data Binding","nodes":[{"pos":[0,12],"content":"Data Binding","nodes":[{"content":"Data Binding","pos":[0,12]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[137,149],"content":"Data Binding","linkify":"Data Binding","nodes":[{"content":"Data Binding","pos":[0,12]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> supports binding to common controls, such as grid controls.","pos":[151,278],"source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] supports binding to common controls, such as grid controls."},{"content":"Specifically, <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> defines the basic patterns for binding to a data grid and handling master-detail binding, both with regard to display and updating.","pos":[279,492],"source":" Specifically, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] defines the basic patterns for binding to a data grid and handling master-detail binding, both with regard to display and updating."},{"pos":[497,517],"content":"Underlying Principle","linkify":"Underlying Principle","nodes":[{"content":"Underlying Principle","pos":[0,20]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> translates <ph id=\"ph2\">[!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)]</ph> queries to SQL for execution on a database.","pos":[519,707],"source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] translates [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] queries to SQL for execution on a database."},{"content":"The results are strongly typed <ph id=\"ph1\">`IEnumerable`</ph>.","pos":[708,753],"source":" The results are strongly typed `IEnumerable`."},{"content":"Because these objects are ordinary common language runtime (CLR) objects, ordinary object data binding can be used to display the results.","pos":[754,892]},{"content":"On the other hand, change operations (inserts, updates, and deletes) require additional steps.","pos":[893,987]},{"pos":[992,1001],"content":"Operation","linkify":"Operation","nodes":[{"content":"Operation","pos":[0,9]}]},{"content":"Implicitly binding to Windows Forms controls is accomplished by implementing <ph id=\"ph1\">&lt;xref:System.ComponentModel.IListSource&gt;</ph>.","pos":[1003,1121],"source":"Implicitly binding to Windows Forms controls is accomplished by implementing <xref:System.ComponentModel.IListSource>."},{"content":"Data sources generic <ph id=\"ph1\">&lt;xref:System.Data.Linq.Table%601&gt;</ph> (<ph id=\"ph2\">`Table&lt;T&gt;`</ph> in C# or <ph id=\"ph3\">`Table(Of T)`</ph> in Visual Basic) and generic <ph id=\"ph4\">`DataQuery`</ph> have been updated to implement <ph id=\"ph5\">&lt;xref:System.ComponentModel.IListSource&gt;</ph>.","pos":[1122,1325],"source":" Data sources generic <xref:System.Data.Linq.Table%601> (`Table<T>` in C# or `Table(Of T)` in Visual Basic) and generic `DataQuery` have been updated to implement <xref:System.ComponentModel.IListSource>."},{"content":"User interface (UI) data-binding engines (Windows Forms and Windows Presentation Foundation) both test whether their data source implements <ph id=\"ph1\">&lt;xref:System.ComponentModel.IListSource&gt;</ph>.","pos":[1326,1507],"source":" User interface (UI) data-binding engines (Windows Forms and Windows Presentation Foundation) both test whether their data source implements <xref:System.ComponentModel.IListSource>."},{"content":"Therefore, writing a direct affectation of a query to a data source of a control implicitly calls <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> collection generation, as in the following example:","pos":[1508,1725],"source":" Therefore, writing a direct affectation of a query to a data source of a control implicitly calls [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] collection generation, as in the following example:"},{"content":"The same occurs with Windows Presentation Foundation:","pos":[1985,2038]},{"pos":[2298,2461],"content":"Collection generations are implemented by generic <ph id=\"ph1\">&lt;xref:System.Data.Linq.Table%601&gt;</ph> and generic <ph id=\"ph2\">`DataQuery`</ph> in <ph id=\"ph3\">&lt;xref:System.ComponentModel.IListSource.GetList%2A&gt;</ph>.","source":"Collection generations are implemented by generic <xref:System.Data.Linq.Table%601> and generic `DataQuery` in <xref:System.ComponentModel.IListSource.GetList%2A>."},{"pos":[2466,2492],"content":"IListSource Implementation","linkify":"IListSource Implementation","nodes":[{"content":"IListSource Implementation","pos":[0,26]}]},{"pos":[2494,2631],"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> implements <ph id=\"ph2\">&lt;xref:System.ComponentModel.IListSource&gt;</ph> in two locations:","source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] implements <xref:System.ComponentModel.IListSource> in two locations:"},{"pos":[2635,2852],"content":"The data source is a <ph id=\"ph1\">&lt;xref:System.Data.Linq.Table%601&gt;</ph>: <ph id=\"ph2\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> browses the table to fill a <ph id=\"ph3\">`DataBindingList`</ph> collection that keeps a reference on the table.","source":"The data source is a <xref:System.Data.Linq.Table%601>: [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] browses the table to fill a `DataBindingList` collection that keeps a reference on the table."},{"content":"The data source is an <ph id=\"ph1\">&lt;xref:System.Linq.IQueryable%601&gt;</ph>.","pos":[2856,2912],"source":"The data source is an <xref:System.Linq.IQueryable%601>."},{"content":"There are two scenarios:","pos":[2913,2937]},{"pos":[2945,3204],"content":"If <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> finds the underlying <ph id=\"ph2\">&lt;xref:System.Data.Linq.Table%601&gt;</ph> from the <ph id=\"ph3\">&lt;xref:System.Linq.IQueryable%601&gt;</ph>, the source allows for edition and the situation is the same as in the first bullet point.","source":"If [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] finds the underlying <xref:System.Data.Linq.Table%601> from the <xref:System.Linq.IQueryable%601>, the source allows for edition and the situation is the same as in the first bullet point."},{"content":"If <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> cannot find the underlying <ph id=\"ph2\">&lt;xref:System.Data.Linq.Table%601&gt;</ph>, the source does not allow for edition (for example, <ph id=\"ph3\">`groupby`</ph>).","pos":[3212,3408],"source":"If [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] cannot find the underlying <xref:System.Data.Linq.Table%601>, the source does not allow for edition (for example, `groupby`)."},{"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> browses the query to fill a generic <ph id=\"ph2\">`SortableBindingList`</ph>, which is a simple <ph id=\"ph3\">&lt;xref:System.ComponentModel.BindingList%601&gt;</ph> that implements the sorting feature for T entities for a given property.","pos":[3409,3671],"source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] browses the query to fill a generic `SortableBindingList`, which is a simple <xref:System.ComponentModel.BindingList%601> that implements the sorting feature for T entities for a given property."},{"pos":[3676,3699],"content":"Specialized Collections","linkify":"Specialized Collections","nodes":[{"content":"Specialized Collections","pos":[0,23]}]},{"content":"For many features described earlier in this document, <ph id=\"ph1\">&lt;xref:System.ComponentModel.BindingList%601&gt;</ph> has been specialized to some different classes.","pos":[3701,3847],"source":"For many features described earlier in this document, <xref:System.ComponentModel.BindingList%601> has been specialized to some different classes."},{"content":"These classes are generic <ph id=\"ph1\">`SortableBindingList`</ph> and generic <ph id=\"ph2\">`DataBindingList`</ph>.","pos":[3848,3926],"source":" These classes are generic `SortableBindingList` and generic `DataBindingList`."},{"content":"Both are declared as internal.","pos":[3927,3957]},{"pos":[3963,3990],"content":"Generic SortableBindingList","linkify":"Generic SortableBindingList","nodes":[{"content":"Generic SortableBindingList","pos":[0,27]}]},{"content":"This class inherits from <ph id=\"ph1\">&lt;xref:System.ComponentModel.BindingList%601&gt;</ph>, and is a sortable version of <ph id=\"ph2\">&lt;xref:System.ComponentModel.BindingList%601&gt;</ph>.","pos":[3992,4137],"source":"This class inherits from <xref:System.ComponentModel.BindingList%601>, and is a sortable version of <xref:System.ComponentModel.BindingList%601>."},{"content":"Sorting is an in-memory solution and never contacts the database itself.","pos":[4138,4210]},{"content":"<ph id=\"ph1\">&lt;xref:System.ComponentModel.BindingList%601&gt;</ph> implements <ph id=\"ph2\">&lt;xref:System.ComponentModel.IBindingList&gt;</ph> but does not support sorting by default.","pos":[4211,4349],"source":"<xref:System.ComponentModel.BindingList%601> implements <xref:System.ComponentModel.IBindingList> but does not support sorting by default."},{"content":"However, <ph id=\"ph1\">&lt;xref:System.ComponentModel.BindingList%601&gt;</ph> implements <ph id=\"ph2\">&lt;xref:System.ComponentModel.IBindingList&gt;</ph> with virtual <bpt id=\"p1\">*</bpt>core<ept id=\"p1\">*</ept> methods.","pos":[4350,4485],"source":" However, <xref:System.ComponentModel.BindingList%601> implements <xref:System.ComponentModel.IBindingList> with virtual *core* methods."},{"content":"You can easily override these methods.","pos":[4486,4524]},{"content":"Generic <ph id=\"ph1\">`SortableBindingList`</ph> overrides <ph id=\"ph2\">&lt;xref:System.ComponentModel.BindingList%601.SupportsSortingCore%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.ComponentModel.BindingList%601.SortPropertyCore%2A&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.ComponentModel.BindingList%601.SortDirectionCore%2A&gt;</ph>, and <ph id=\"ph5\">&lt;xref:System.ComponentModel.BindingList%601.ApplySortCore%2A&gt;</ph>.","pos":[4525,4833],"source":" Generic `SortableBindingList` overrides <xref:System.ComponentModel.BindingList%601.SupportsSortingCore%2A>, <xref:System.ComponentModel.BindingList%601.SortPropertyCore%2A>, <xref:System.ComponentModel.BindingList%601.SortDirectionCore%2A>, and <xref:System.ComponentModel.BindingList%601.ApplySortCore%2A>."},{"content":"<ph id=\"ph1\">`ApplySortCore`</ph> is called by <ph id=\"ph2\">&lt;xref:System.ComponentModel.IBindingList.ApplySort%2A&gt;</ph> and sorts the list of T items for a given property.","pos":[4834,4969],"source":"`ApplySortCore` is called by <xref:System.ComponentModel.IBindingList.ApplySort%2A> and sorts the list of T items for a given property."},{"content":"An exception is raised if the property does not belong to T.","pos":[4971,5031]},{"content":"To achieve sorting, <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> creates a generic <ph id=\"ph2\">`SortableBindingList.PropertyComparer`</ph> class that inherits from generic <ph id=\"ph3\">&lt;xref:System.Collections.Generic.Comparer%601.System%23Collections%23IComparer%23Compare%2A&gt;</ph> and implements a default comparer for a given type T, a <ph id=\"ph4\">`PropertyDescriptor`</ph>, and a direction.","pos":[5033,5398],"source":"To achieve sorting, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] creates a generic `SortableBindingList.PropertyComparer` class that inherits from generic <xref:System.Collections.Generic.Comparer%601.System%23Collections%23IComparer%23Compare%2A> and implements a default comparer for a given type T, a `PropertyDescriptor`, and a direction."},{"content":"This class dynamically creates a <ph id=\"ph1\">`Comparer`</ph> of T where T is the <ph id=\"ph2\">`PropertyType`</ph> of the <ph id=\"ph3\">`PropertyDescriptor`</ph>.","pos":[5399,5506],"source":" This class dynamically creates a `Comparer` of T where T is the `PropertyType` of the `PropertyDescriptor`."},{"content":"Then, the default comparer is retrieved from the static generic <ph id=\"ph1\">`Comparer`</ph>.","pos":[5507,5582],"source":" Then, the default comparer is retrieved from the static generic `Comparer`."},{"content":"A default instance is obtained by using reflection.","pos":[5583,5634]},{"content":"Generic <ph id=\"ph1\">`SortableBindingList`</ph> is also the base class for <ph id=\"ph2\">`DataBindingList`</ph>.","pos":[5636,5711],"source":"Generic `SortableBindingList` is also the base class for `DataBindingList`."},{"content":"Generic <ph id=\"ph1\">`SortableBindingList`</ph> offers two virtual methods for suspending or resuming items add/remove tracking.","pos":[5712,5822],"source":" Generic `SortableBindingList` offers two virtual methods for suspending or resuming items add/remove tracking."},{"content":"Those two methods can be used for base features such as sorting, but will really be implemented by upper classes like generic <ph id=\"ph1\">`DataBindingList`</ph>.","pos":[5823,5967],"source":" Those two methods can be used for base features such as sorting, but will really be implemented by upper classes like generic `DataBindingList`."},{"pos":[5973,5996],"content":"Generic DataBindingList","linkify":"Generic DataBindingList","nodes":[{"content":"Generic DataBindingList","pos":[0,23]}]},{"content":"This class inherits from generic <ph id=\"ph1\">`SortableBindingLIst`</ph>.","pos":[5998,6053],"source":"This class inherits from generic `SortableBindingLIst`."},{"content":"Generic <ph id=\"ph1\">`DataBindingList`</ph> keeps a reference on the underlying generic <ph id=\"ph2\">`Table`</ph> of the generic <ph id=\"ph3\">`IQueryable`</ph> used for the initial filling of the collection.","pos":[6054,6207],"source":" Generic `DataBindingList` keeps a reference on the underlying generic `Table` of the generic `IQueryable` used for the initial filling of the collection."},{"content":"Generic <ph id=\"ph1\">`DatabindingList`</ph> adds tracking for item add/remove to the collection by overriding <ph id=\"ph2\">`InsertItem`</ph>() and <ph id=\"ph3\">`RemoveItem`</ph>().","pos":[6208,6334],"source":" Generic `DatabindingList` adds tracking for item add/remove to the collection by overriding `InsertItem`() and `RemoveItem`()."},{"content":"It also implements the abstract suspend/resume tracking feature to make tracking conditional.","pos":[6335,6428]},{"content":"This feature makes generic <ph id=\"ph1\">`DataBindingList`</ph> take advantage of all the polymorphic usage of the tracking feature of the parent classes.","pos":[6429,6564],"source":" This feature makes generic `DataBindingList` take advantage of all the polymorphic usage of the tracking feature of the parent classes."},{"pos":[6569,6590],"content":"Binding to EntitySets","linkify":"Binding to EntitySets","nodes":[{"content":"Binding to EntitySets","pos":[0,21]}]},{"content":"Binding to <ph id=\"ph1\">`EntitySet`</ph> is a special case because <ph id=\"ph2\">`EntitySet`</ph> is already a collection that implements <ph id=\"ph3\">&lt;xref:System.ComponentModel.IBindingList&gt;</ph>.","pos":[6592,6735],"source":"Binding to `EntitySet` is a special case because `EntitySet` is already a collection that implements <xref:System.ComponentModel.IBindingList>."},{"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> adds sorting and canceling (<ph id=\"ph2\">&lt;xref:System.ComponentModel.ICancelAddNew&gt;</ph>) support.","pos":[6736,6884],"source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] adds sorting and canceling (<xref:System.ComponentModel.ICancelAddNew>) support."},{"content":"An <ph id=\"ph1\">`EntitySet`</ph> class uses an internal list to store entities.","pos":[6885,6946],"source":" An `EntitySet` class uses an internal list to store entities."},{"content":"This list is a low-level collection based on a generic array, the generic <ph id=\"ph1\">`ItemList`</ph> class.","pos":[6947,7038],"source":" This list is a low-level collection based on a generic array, the generic `ItemList` class."},{"pos":[7044,7068],"content":"Adding a Sorting Feature","linkify":"Adding a Sorting Feature","nodes":[{"content":"Adding a Sorting Feature","pos":[0,24]}]},{"content":"Arrays offer a sort method (<ph id=\"ph1\">`Array.Sort()`</ph>) that you can be used with a <ph id=\"ph2\">`Comparer`</ph> of T. <ph id=\"ph3\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> uses the generic <ph id=\"ph4\">`SortableBindingList.PropertyComparer`</ph> class described earlier in this topic to obtain this <ph id=\"ph5\">`Comparer`</ph> for the property and the direction to be sorted on.","pos":[7070,7398],"source":"Arrays offer a sort method (`Array.Sort()`) that you can be used with a `Comparer` of T. [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] uses the generic `SortableBindingList.PropertyComparer` class described earlier in this topic to obtain this `Comparer` for the property and the direction to be sorted on."},{"content":"An <ph id=\"ph1\">`ApplySort`</ph> method is added to generic <ph id=\"ph2\">`ItemList`</ph> to call this feature.","pos":[7399,7473],"source":" An `ApplySort` method is added to generic `ItemList` to call this feature."},{"pos":[7475,7540],"content":"On the <ph id=\"ph1\">`EntitySet`</ph> side, you now have to declare sorting support:","source":"On the `EntitySet` side, you now have to declare sorting support:"},{"pos":[7544,7620],"content":"<ph id=\"ph1\">&lt;xref:System.ComponentModel.IBindingList.SupportsSorting%2A&gt;</ph> returns <ph id=\"ph2\">`true`</ph>.","source":"<xref:System.ComponentModel.IBindingList.SupportsSorting%2A> returns `true`."},{"pos":[7624,7735],"content":"<ph id=\"ph1\">&lt;xref:System.ComponentModel.IBindingList.ApplySort%2A&gt;</ph> calls <ph id=\"ph2\">`entities.ApplySort()`</ph> and then <ph id=\"ph3\">`OnListChanged()`</ph>.","source":"<xref:System.ComponentModel.IBindingList.ApplySort%2A> calls `entities.ApplySort()` and then `OnListChanged()`."},{"pos":[7739,7943],"content":"<ph id=\"ph1\">&lt;xref:System.ComponentModel.IBindingList.SortDirection%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ComponentModel.IBindingList.SortProperty%2A&gt;</ph> properties expose the current sorting definition, which is stored in local members.","source":"<xref:System.ComponentModel.IBindingList.SortDirection%2A> and <xref:System.ComponentModel.IBindingList.SortProperty%2A> properties expose the current sorting definition, which is stored in local members."},{"content":"When you use a System.Windows.Forms.BindingSource and bind an EntitySet<ph id=\"ph1\">\\&lt;</ph>TEntity&gt; to the System.Windows.Forms.BindingSource.DataSource, you must call EntitySet<ph id=\"ph2\">\\&lt;</ph>TEntity&gt;.GetNewBindingList to update BindingSource.List.","pos":[7945,8162],"source":"When you use a System.Windows.Forms.BindingSource and bind an EntitySet\\<TEntity> to the System.Windows.Forms.BindingSource.DataSource, you must call EntitySet\\<TEntity>.GetNewBindingList to update BindingSource.List."},{"content":"If you use a System.Windows.Forms.BindingSource and set the BindingSource.DataMember property and set BindingSource.DataSource to a class that has a property named in the BindingSource.DataMember that exposes the EntitySet<ph id=\"ph1\">\\&lt;</ph>TEntity&gt;, you don’t have to call EntitySet<ph id=\"ph2\">\\&lt;</ph>TEntity&gt;.GetNewBindingList to update the BindingSource.List but you lose Sorting capability.","pos":[8164,8524],"source":"If you use a System.Windows.Forms.BindingSource and set the BindingSource.DataMember property and set BindingSource.DataSource to a class that has a property named in the BindingSource.DataMember that exposes the EntitySet\\<TEntity>, you don’t have to call EntitySet\\<TEntity>.GetNewBindingList to update the BindingSource.List but you lose Sorting capability."},{"pos":[8529,8536],"content":"Caching","linkify":"Caching","nodes":[{"content":"Caching","pos":[0,7]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> queries implement <ph id=\"ph2\">&lt;xref:System.ComponentModel.IListSource.GetList%2A&gt;</ph>.","pos":[8538,8676],"source":"[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] queries implement <xref:System.ComponentModel.IListSource.GetList%2A>."},{"content":"When the Windows Forms BindingSource class meets this interface, it calls GetList() threes time for a single connection.","pos":[8677,8797]},{"content":"To work around this situation, <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> implements a cache per instance to store and always return the same generated collection.","pos":[8798,8986],"source":" To work around this situation, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] implements a cache per instance to store and always return the same generated collection."},{"pos":[8991,9003],"content":"Cancellation","linkify":"Cancellation","nodes":[{"content":"Cancellation","pos":[0,12]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.ComponentModel.IBindingList&gt;</ph> defines an <ph id=\"ph2\">&lt;xref:System.ComponentModel.IBindingList.AddNew%2A&gt;</ph> method that is used by controls to create a new item from a bound collection.","pos":[9005,9187],"source":"<xref:System.ComponentModel.IBindingList> defines an <xref:System.ComponentModel.IBindingList.AddNew%2A> method that is used by controls to create a new item from a bound collection."},{"content":"The <ph id=\"ph1\">`DataGridView`</ph> control shows this feature very well when the last visible row contains a star in its header.","pos":[9188,9300],"source":" The `DataGridView` control shows this feature very well when the last visible row contains a star in its header."},{"content":"The star shows you that you can add a new item.","pos":[9301,9348]},{"content":"In addition to this feature, a collection can also implement <ph id=\"ph1\">&lt;xref:System.ComponentModel.ICancelAddNew&gt;</ph>.","pos":[9350,9454],"source":"In addition to this feature, a collection can also implement <xref:System.ComponentModel.ICancelAddNew>."},{"content":"This feature allows for the controls to cancel or validate that the new edited item has been validated or not.","pos":[9455,9565]},{"content":"<ph id=\"ph1\">&lt;xref:System.ComponentModel.ICancelAddNew&gt;</ph> is implemented in all <ph id=\"ph2\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> databound collections (generic <ph id=\"ph3\">`SortableBindingList`</ph> and generic <ph id=\"ph4\">`EntitySet`</ph>).","pos":[9567,9778],"source":"<xref:System.ComponentModel.ICancelAddNew> is implemented in all [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] databound collections (generic `SortableBindingList` and generic `EntitySet`)."},{"content":"In both implementations the code performs as follows:","pos":[9779,9832]},{"content":"Lets items be inserted and then removed from the collection.","pos":[9836,9896]},{"content":"Does not track changes as long as the UI does not commit the edition.","pos":[9900,9969]},{"pos":[9973,10089],"content":"Does not track changes as long as the edition is canceled (<ph id=\"ph1\">&lt;xref:System.ComponentModel.ICancelAddNew.CancelNew%2A&gt;</ph>).","source":"Does not track changes as long as the edition is canceled (<xref:System.ComponentModel.ICancelAddNew.CancelNew%2A>)."},{"pos":[10093,10194],"content":"Allows tracking when the edition is committed (<ph id=\"ph1\">&lt;xref:System.ComponentModel.ICancelAddNew.EndNew%2A&gt;</ph>).","source":"Allows tracking when the edition is committed (<xref:System.ComponentModel.ICancelAddNew.EndNew%2A>)."},{"pos":[10198,10321],"content":"Lets the collection behave normally if the new item does not come from <ph id=\"ph1\">&lt;xref:System.ComponentModel.IBindingList.AddNew%2A&gt;</ph>.","source":"Lets the collection behave normally if the new item does not come from <xref:System.ComponentModel.IBindingList.AddNew%2A>."},{"pos":[10326,10341],"content":"Troubleshooting","linkify":"Troubleshooting","nodes":[{"content":"Troubleshooting","pos":[0,15]}]},{"pos":[10343,10508],"content":"This section calls out several items that might help troubleshoot your <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> data binding applications.","source":"This section calls out several items that might help troubleshoot your [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] data binding applications."},{"content":"You must use properties; using only fields is not sufficient.","pos":[10512,10573]},{"content":"Windows Forms require this usage.","pos":[10574,10607]},{"content":"By default, <ph id=\"ph1\">`image`</ph>, <ph id=\"ph2\">`varbinary`</ph>, and <ph id=\"ph3\">`timestamp`</ph> database types map to byte array.","pos":[10611,10694],"source":"By default, `image`, `varbinary`, and `timestamp` database types map to byte array."},{"content":"Because <ph id=\"ph1\">`ToString()`</ph> is not supported in this scenario, these objects cannot be displayed.","pos":[10695,10785],"source":" Because `ToString()` is not supported in this scenario, these objects cannot be displayed."},{"content":"A class member mapped to a primary key has a setter, but <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</ph> does not support object identity change.","pos":[10789,10954],"source":"A class member mapped to a primary key has a setter, but [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] does not support object identity change."},{"content":"Therefore, the primary/unique key that is used in mapping cannot be updated in the database.","pos":[10955,11047]},{"content":"A change in the grid causes an exception when you call <ph id=\"ph1\">&lt;xref:System.Data.Linq.DataContext.SubmitChanges%2A&gt;</ph>.","pos":[11048,11156],"source":" A change in the grid causes an exception when you call <xref:System.Data.Linq.DataContext.SubmitChanges%2A>."},{"pos":[11160,11317],"content":"If an entity is bound in two separate grids (for example, one master and another detail), a <ph id=\"ph1\">`Delete`</ph> in the master grid is not propagated to the detail grid.","source":"If an entity is bound in two separate grids (for example, one master and another detail), a `Delete` in the master grid is not propagated to the detail grid."},{"pos":[11322,11330],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[11334,11439],"content":"<bpt id=\"p1\">[</bpt>Background Information<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/sql/linq/background-information.md)</ept>","source":"[Background Information](../../../../../../docs/framework/data/adonet/sql/linq/background-information.md)"}]}