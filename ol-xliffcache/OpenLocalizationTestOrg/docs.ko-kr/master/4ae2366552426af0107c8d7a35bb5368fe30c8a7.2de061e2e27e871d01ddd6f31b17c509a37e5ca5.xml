{"content":"---\ntitle: \"Optional Parameters (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"parameters [Visual Basic], optional\"\n  - \"Visual Basic code, procedures\"\n  - \"procedures [Visual Basic], optional arguments\"\n  - \"optional arguments\"\n  - \"named arguments [Visual Basic], and optional arguments\"\n  - \"optional parameters\"\n  - \"Optional keyword [Visual Basic], optional arguments\"\n  - \"arguments [Visual Basic], optional\"\n  - \"optional arguments [Visual Basic], and named arguments\"\nms.assetid: 398d2845-1069-4e94-b934-a73b545c8b87\n---\n# Optional Parameters (Visual Basic)\nYou can specify that a procedure parameter is optional and no argument has to be supplied for it when the procedure is called. *Optional parameters* are indicated by the `Optional` keyword in the procedure definition. The following rules apply:  \n  \n-   Every optional parameter in the procedure definition must specify a default value.  \n  \n-   The default value for an optional parameter must be a constant expression.  \n  \n-   Every parameter following an optional parameter in the procedure definition must also be optional.  \n  \n The following syntax shows a procedure declaration with an optional parameter:  \n  \n```vb  \nSub name(ByVal parameter1 As datatype1, Optional ByVal parameter2 As datatype2 = defaultvalue)  \n```  \n  \n## Calling Procedures with Optional Parameters  \n When you call a procedure with an optional parameter, you can choose whether to supply the argument. If you do not, the procedure uses the default value declared for that parameter.  \n  \n When you omit one or more optional arguments in the argument list, you use successive commas to mark their positions. The following example call supplies the first and fourth arguments but not the second or third:  \n  \n```vb  \nSub name(argument 1, , , argument 4)  \n```  \n  \n The following example makes several calls to the `MsgBox` function. `MsgBox` has one required parameter and two optional parameters.  \n  \n The first call to `MsgBox` supplies all three arguments in the order that `MsgBox` defines them. The second call supplies only the required argument. The third and fourth calls supply the first and third arguments. The third call does this by position, and the fourth call does it by name.  \n  \n [!code-vb[VbVbcnProcedures#47](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#47)]  \n  \n## Determining Whether an Optional Argument Is Present  \n A procedure cannot detect at run time whether a given argument has been omitted or the calling code has explicitly supplied the default value. If you need to make this distinction, you can set an unlikely value as the default. The following procedure defines the optional parameter `office`, and tests for its default value, `QJZ`, to see if it has been omitted in the call:  \n  \n [!code-vb[VbVbcnProcedures#46](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#46)]  \n  \n If the optional parameter is a reference type such as a `String`, you can use `Nothing` as the default value, provided this is not an expected value for the argument.  \n  \n## Optional Parameters and Overloading  \n Another way to define a procedure with optional parameters is to use overloading. If you have one optional parameter, you can define two overloaded versions of the procedure, one accepting the parameter and one without it. This approach becomes more complicated as the number of optional parameters increases. However, its advantage is that you can be absolutely sure whether the calling program supplied each optional argument.  \n  \n## See also\n\n- [Procedures](./index.md)\n- [Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)\n- [Passing Arguments by Value and by Reference](./passing-arguments-by-value-and-by-reference.md)\n- [Passing Arguments by Position and by Name](./passing-arguments-by-position-and-by-name.md)\n- [Parameter Arrays](./parameter-arrays.md)\n- [Procedure Overloading](./procedure-overloading.md)\n- [Optional](../../../../visual-basic/language-reference/modifiers/optional.md)\n- [ParamArray](../../../../visual-basic/language-reference/modifiers/paramarray.md)\n","nodes":[{"pos":[4,540],"embed":true,"restype":"x-metadata","content":"title: \"Optional Parameters (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"parameters [Visual Basic], optional\"\n  - \"Visual Basic code, procedures\"\n  - \"procedures [Visual Basic], optional arguments\"\n  - \"optional arguments\"\n  - \"named arguments [Visual Basic], and optional arguments\"\n  - \"optional parameters\"\n  - \"Optional keyword [Visual Basic], optional arguments\"\n  - \"arguments [Visual Basic], optional\"\n  - \"optional arguments [Visual Basic], and named arguments\"\nms.assetid: 398d2845-1069-4e94-b934-a73b545c8b87","nodes":[{"content":"Optional Parameters (Visual Basic)","nodes":[{"pos":[0,34],"content":"Optional Parameters (Visual Basic)","nodes":[{"content":"Optional Parameters (Visual Basic)","pos":[0,34]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[547,581],"content":"Optional Parameters (Visual Basic)","linkify":"Optional Parameters (Visual Basic)","nodes":[{"content":"Optional Parameters (Visual Basic)","pos":[0,34]}]},{"content":"You can specify that a procedure parameter is optional and no argument has to be supplied for it when the procedure is called.","pos":[582,708]},{"content":"<bpt id=\"p1\">*</bpt>Optional parameters<ept id=\"p1\">*</ept> are indicated by the <ph id=\"ph1\">`Optional`</ph> keyword in the procedure definition.","pos":[709,799],"source":"*Optional parameters* are indicated by the `Optional` keyword in the procedure definition."},{"content":"The following rules apply:","pos":[800,826]},{"content":"Every optional parameter in the procedure definition must specify a default value.","pos":[836,918]},{"content":"The default value for an optional parameter must be a constant expression.","pos":[928,1002]},{"content":"Every parameter following an optional parameter in the procedure definition must also be optional.","pos":[1012,1110]},{"content":"The following syntax shows a procedure declaration with an optional parameter:","pos":[1117,1195]},{"pos":[1318,1361],"content":"Calling Procedures with Optional Parameters","linkify":"Calling Procedures with Optional Parameters","nodes":[{"content":"Calling Procedures with Optional Parameters","pos":[0,43]}]},{"content":"When you call a procedure with an optional parameter, you can choose whether to supply the argument.","pos":[1365,1465]},{"content":"If you do not, the procedure uses the default value declared for that parameter.","pos":[1466,1546]},{"content":"When you omit one or more optional arguments in the argument list, you use successive commas to mark their positions.","pos":[1553,1670]},{"content":"The following example call supplies the first and fourth arguments but not the second or third:","pos":[1671,1766]},{"content":"The following example makes several calls to the <ph id=\"ph1\">`MsgBox`</ph> function.","pos":[1829,1896],"source":"The following example makes several calls to the `MsgBox` function."},{"content":"<ph id=\"ph1\">`MsgBox`</ph> has one required parameter and two optional parameters.","pos":[1897,1961],"source":"`MsgBox` has one required parameter and two optional parameters."},{"content":"The first call to <ph id=\"ph1\">`MsgBox`</ph> supplies all three arguments in the order that <ph id=\"ph2\">`MsgBox`</ph> defines them.","pos":[1968,2064],"source":"The first call to `MsgBox` supplies all three arguments in the order that `MsgBox` defines them."},{"content":"The second call supplies only the required argument.","pos":[2065,2117]},{"content":"The third and fourth calls supply the first and third arguments.","pos":[2118,2182]},{"content":"The third call does this by position, and the fourth call does it by name.","pos":[2183,2257]},{"pos":[2390,2441],"content":"Determining Whether an Optional Argument Is Present","linkify":"Determining Whether an Optional Argument Is Present","nodes":[{"content":"Determining Whether an Optional Argument Is Present","pos":[0,51]}]},{"content":"A procedure cannot detect at run time whether a given argument has been omitted or the calling code has explicitly supplied the default value.","pos":[2445,2587]},{"content":"If you need to make this distinction, you can set an unlikely value as the default.","pos":[2588,2671]},{"content":"The following procedure defines the optional parameter <ph id=\"ph1\">`office`</ph>, and tests for its default value, <ph id=\"ph2\">`QJZ`</ph>, to see if it has been omitted in the call:","pos":[2672,2819],"source":" The following procedure defines the optional parameter `office`, and tests for its default value, `QJZ`, to see if it has been omitted in the call:"},{"pos":[2950,3116],"content":"If the optional parameter is a reference type such as a <ph id=\"ph1\">`String`</ph>, you can use <ph id=\"ph2\">`Nothing`</ph> as the default value, provided this is not an expected value for the argument.","source":"If the optional parameter is a reference type such as a `String`, you can use `Nothing` as the default value, provided this is not an expected value for the argument."},{"pos":[3125,3160],"content":"Optional Parameters and Overloading","linkify":"Optional Parameters and Overloading","nodes":[{"content":"Optional Parameters and Overloading","pos":[0,35]}]},{"content":"Another way to define a procedure with optional parameters is to use overloading.","pos":[3164,3245]},{"content":"If you have one optional parameter, you can define two overloaded versions of the procedure, one accepting the parameter and one without it.","pos":[3246,3386]},{"content":"This approach becomes more complicated as the number of optional parameters increases.","pos":[3387,3473]},{"content":"However, its advantage is that you can be absolutely sure whether the calling program supplied each optional argument.","pos":[3474,3592]},{"pos":[3601,3609],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3613,3637],"content":"<bpt id=\"p1\">[</bpt>Procedures<ept id=\"p1\">](./index.md)</ept>","source":"[Procedures](./index.md)"},{"pos":[3640,3717],"content":"<bpt id=\"p1\">[</bpt>Procedure Parameters and Arguments<ept id=\"p1\">](./procedure-parameters-and-arguments.md)</ept>","source":"[Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)"},{"pos":[3720,3815],"content":"<bpt id=\"p1\">[</bpt>Passing Arguments by Value and by Reference<ept id=\"p1\">](./passing-arguments-by-value-and-by-reference.md)</ept>","source":"[Passing Arguments by Value and by Reference](./passing-arguments-by-value-and-by-reference.md)"},{"pos":[3818,3909],"content":"<bpt id=\"p1\">[</bpt>Passing Arguments by Position and by Name<ept id=\"p1\">](./passing-arguments-by-position-and-by-name.md)</ept>","source":"[Passing Arguments by Position and by Name](./passing-arguments-by-position-and-by-name.md)"},{"pos":[3912,3953],"content":"<bpt id=\"p1\">[</bpt>Parameter Arrays<ept id=\"p1\">](./parameter-arrays.md)</ept>","source":"[Parameter Arrays](./parameter-arrays.md)"},{"pos":[3956,4007],"content":"<bpt id=\"p1\">[</bpt>Procedure Overloading<ept id=\"p1\">](./procedure-overloading.md)</ept>","source":"[Procedure Overloading](./procedure-overloading.md)"},{"pos":[4010,4087],"content":"<bpt id=\"p1\">[</bpt>Optional<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/optional.md)</ept>","source":"[Optional](../../../../visual-basic/language-reference/modifiers/optional.md)"},{"pos":[4090,4171],"content":"<bpt id=\"p1\">[</bpt>ParamArray<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/paramarray.md)</ept>","source":"[ParamArray](../../../../visual-basic/language-reference/modifiers/paramarray.md)"}]}