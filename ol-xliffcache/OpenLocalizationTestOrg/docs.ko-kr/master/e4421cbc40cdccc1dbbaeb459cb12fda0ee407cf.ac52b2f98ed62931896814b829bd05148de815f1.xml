{"content":"---\ntitle: \"Introduction to COM Interop (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"interop assemblies\"\n  - \"COM interop [Visual Basic], about COM interop\"\nms.assetid: 8bd62e68-383d-407f-998b-29aa0ce0fd67\n---\n# Introduction to COM Interop (Visual Basic)\nThe Component Object Model (COM) lets an object expose its functionality to other components and to host applications. While COM objects have been fundamental to Windows programming for many years, applications designed for the common language runtime (CLR) offer many advantages.  \n  \n [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] applications will eventually replace those developed with COM. Until then, you may have to use or create COM objects by using Visual Studio. Interoperability with COM, or *COM interop*, enables you to use existing COM objects while transitioning to the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] at your own pace.  \n  \n By using the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] to create COM components, you can use registration-free COM interop. This lets you control which DLL version is enabled when more than one version is installed on a computer, and lets end users use XCOPY or FTP to copy your application to an appropriate directory on their computer where it can be run. For more information, see [Registration-Free COM Interop](../../../framework/interop/registration-free-com-interop.md).  \n  \n## Managed Code and Data  \n Code developed for the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] is referred to as *managed code*, and contains metadata that is used by the CLR. Data used by [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] applications is called *managed data* because the runtime manages data-related tasks such as allocating and reclaiming memory and performing type checking. By default, Visual Basic .NET uses managed code and data, but you can access the unmanaged code and data of COM objects using interop assemblies (described later on this page).  \n  \n## Assemblies  \n An assembly is the primary building block of a [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] application. It is a collection of functionality that is built, versioned, and deployed as a single implementation unit containing one or more files. Each assembly contains an assembly manifest.  \n  \n## Type Libraries and Assembly Manifests  \n Type libraries describe characteristics of COM objects, such as member names and data types. Assembly manifests perform the same function for [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] applications. They include information about the following:  \n  \n-   Assembly identity, version, culture, and digital signature.  \n  \n-   Files that make up the assembly implementation.  \n  \n-   Types and resources that make up the assembly. This includes those that are exported from it.  \n  \n-   Compile-time dependencies on other assemblies.  \n  \n-   Permissions required for the assembly to run correctly.  \n  \n For more information about assemblies and assembly manifests, see [Assemblies in .NET](../../../standard/assembly/index.md).  \n  \n### Importing and Exporting Type Libraries  \n Visual Studio contains a utility, Tlbimp, that lets you import information from a type library into a [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] application. You can generate type libraries from assemblies by using the Tlbexp utility.  \n  \n For information about Tlbimp and Tlbexp, see [Tlbimp.exe (Type Library Importer)](../../../framework/tools/tlbimp-exe-type-library-importer.md) and [Tlbexp.exe (Type Library Exporter)](../../../framework/tools/tlbexp-exe-type-library-exporter.md).  \n  \n## Interop Assemblies  \n Interop assemblies are [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] assemblies that bridge between managed and unmanaged code, mapping COM object members to equivalent [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] managed members. Interop assemblies created by Visual Basic .NET handle many of the details of working with COM objects, such as interoperability marshaling.  \n  \n## Interoperability Marshaling  \n All [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] applications share a set of common types that enable interoperability of objects, regardless of the programming language that is used. The parameters and return values of COM objects sometimes use data types that differ from those used in managed code. *Interoperability marshaling* is the process of packaging parameters and return values into equivalent data types as they move to and from COM objects. For more information, see [Interop Marshaling](../../../framework/interop/interop-marshaling.md).  \n  \n## See also\n\n- [COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)\n- [Walkthrough: Implementing Inheritance with COM Objects](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)\n- [Interoperating with Unmanaged Code](../../../framework/interop/index.md)\n- [Troubleshooting Interoperability](../../../visual-basic/programming-guide/com-interop/troubleshooting-interoperability.md)\n- [Assemblies in .NET](../../../standard/assembly/index.md)\n- [Tlbimp.exe (Type Library Importer)](../../../framework/tools/tlbimp-exe-type-library-importer.md)\n- [Tlbexp.exe (Type Library Exporter)](../../../framework/tools/tlbexp-exe-type-library-exporter.md)\n- [Interop Marshaling](../../../framework/interop/interop-marshaling.md)\n- [Registration-Free COM Interop](../../../framework/interop/registration-free-com-interop.md)\n","nodes":[{"pos":[4,223],"embed":true,"restype":"x-metadata","content":"title: \"Introduction to COM Interop (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"interop assemblies\"\n  - \"COM interop [Visual Basic], about COM interop\"\nms.assetid: 8bd62e68-383d-407f-998b-29aa0ce0fd67","nodes":[{"content":"Introduction to COM Interop (Visual Basic)","nodes":[{"pos":[0,42],"content":"Introduction to COM Interop (Visual Basic)","nodes":[{"content":"Introduction to COM Interop (Visual Basic)","pos":[0,42]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[230,272],"content":"Introduction to COM Interop (Visual Basic)","linkify":"Introduction to COM Interop (Visual Basic)","nodes":[{"content":"Introduction to COM Interop (Visual Basic)","pos":[0,42]}]},{"content":"The Component Object Model (COM) lets an object expose its functionality to other components and to host applications.","pos":[273,391]},{"content":"While COM objects have been fundamental to Windows programming for many years, applications designed for the common language runtime (CLR) offer many advantages.","pos":[392,553]},{"content":"<ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> applications will eventually replace those developed with COM.","pos":[560,676],"source":"[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] applications will eventually replace those developed with COM."},{"content":"Until then, you may have to use or create COM objects by using Visual Studio.","pos":[677,754]},{"content":"Interoperability with COM, or <bpt id=\"p1\">*</bpt>COM interop<ept id=\"p1\">*</ept>, enables you to use existing COM objects while transitioning to the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> at your own pace.","pos":[755,938],"source":" Interoperability with COM, or *COM interop*, enables you to use existing COM objects while transitioning to the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] at your own pace."},{"content":"By using the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> to create COM components, you can use registration-free COM interop.","pos":[945,1080],"source":"By using the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] to create COM components, you can use registration-free COM interop."},{"content":"This lets you control which DLL version is enabled when more than one version is installed on a computer, and lets end users use XCOPY or FTP to copy your application to an appropriate directory on their computer where it can be run.","pos":[1081,1314]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Registration-Free COM Interop<ept id=\"p1\">](../../../framework/interop/registration-free-com-interop.md)</ept>.","pos":[1315,1434],"source":" For more information, see [Registration-Free COM Interop](../../../framework/interop/registration-free-com-interop.md)."},{"pos":[1443,1464],"content":"Managed Code and Data","linkify":"Managed Code and Data","nodes":[{"content":"Managed Code and Data","pos":[0,21]}]},{"content":"Code developed for the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> is referred to as <bpt id=\"p1\">*</bpt>managed code<ept id=\"p1\">*</ept>, and contains metadata that is used by the CLR.","pos":[1468,1625],"source":"Code developed for the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] is referred to as *managed code*, and contains metadata that is used by the CLR."},{"content":"Data used by <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> applications is called <bpt id=\"p1\">*</bpt>managed data<ept id=\"p1\">*</ept> because the runtime manages data-related tasks such as allocating and reclaiming memory and performing type checking.","pos":[1626,1848],"source":" Data used by [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] applications is called *managed data* because the runtime manages data-related tasks such as allocating and reclaiming memory and performing type checking."},{"content":"By default, Visual Basic .NET uses managed code and data, but you can access the unmanaged code and data of COM objects using interop assemblies (described later on this page).","pos":[1849,2025]},{"pos":[2034,2044],"content":"Assemblies","linkify":"Assemblies","nodes":[{"content":"Assemblies","pos":[0,10]}]},{"content":"An assembly is the primary building block of a <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> application.","pos":[2048,2161],"source":"An assembly is the primary building block of a [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] application."},{"content":"It is a collection of functionality that is built, versioned, and deployed as a single implementation unit containing one or more files.","pos":[2162,2298]},{"content":"Each assembly contains an assembly manifest.","pos":[2299,2343]},{"pos":[2352,2389],"content":"Type Libraries and Assembly Manifests","linkify":"Type Libraries and Assembly Manifests","nodes":[{"content":"Type Libraries and Assembly Manifests","pos":[0,37]}]},{"content":"Type libraries describe characteristics of COM objects, such as member names and data types.","pos":[2393,2485]},{"content":"Assembly manifests perform the same function for <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> applications.","pos":[2486,2602],"source":" Assembly manifests perform the same function for [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] applications."},{"content":"They include information about the following:","pos":[2603,2648]},{"content":"Assembly identity, version, culture, and digital signature.","pos":[2658,2717]},{"content":"Files that make up the assembly implementation.","pos":[2727,2774]},{"content":"Types and resources that make up the assembly.","pos":[2784,2830]},{"content":"This includes those that are exported from it.","pos":[2831,2877]},{"content":"Compile-time dependencies on other assemblies.","pos":[2887,2933]},{"content":"Permissions required for the assembly to run correctly.","pos":[2943,2998]},{"pos":[3005,3129],"content":"For more information about assemblies and assembly manifests, see <bpt id=\"p1\">[</bpt>Assemblies in .NET<ept id=\"p1\">](../../../standard/assembly/index.md)</ept>.","source":"For more information about assemblies and assembly manifests, see [Assemblies in .NET](../../../standard/assembly/index.md)."},{"pos":[3139,3177],"content":"Importing and Exporting Type Libraries","linkify":"Importing and Exporting Type Libraries","nodes":[{"content":"Importing and Exporting Type Libraries","pos":[0,38]}]},{"content":"Visual Studio contains a utility, Tlbimp, that lets you import information from a type library into a <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> application.","pos":[3181,3349],"source":"Visual Studio contains a utility, Tlbimp, that lets you import information from a type library into a [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] application."},{"content":"You can generate type libraries from assemblies by using the Tlbexp utility.","pos":[3350,3426]},{"pos":[3433,3680],"content":"For information about Tlbimp and Tlbexp, see <bpt id=\"p1\">[</bpt>Tlbimp.exe (Type Library Importer)<ept id=\"p1\">](../../../framework/tools/tlbimp-exe-type-library-importer.md)</ept> and <bpt id=\"p2\">[</bpt>Tlbexp.exe (Type Library Exporter)<ept id=\"p2\">](../../../framework/tools/tlbexp-exe-type-library-exporter.md)</ept>.","source":"For information about Tlbimp and Tlbexp, see [Tlbimp.exe (Type Library Importer)](../../../framework/tools/tlbimp-exe-type-library-importer.md) and [Tlbexp.exe (Type Library Exporter)](../../../framework/tools/tlbexp-exe-type-library-exporter.md)."},{"pos":[3689,3707],"content":"Interop Assemblies","linkify":"Interop Assemblies","nodes":[{"content":"Interop Assemblies","pos":[0,18]}]},{"content":"Interop assemblies are <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> assemblies that bridge between managed and unmanaged code, mapping COM object members to equivalent <ph id=\"ph2\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> managed members.","pos":[3711,3958],"source":"Interop assemblies are [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] assemblies that bridge between managed and unmanaged code, mapping COM object members to equivalent [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] managed members."},{"content":"Interop assemblies created by Visual Basic .NET handle many of the details of working with COM objects, such as interoperability marshaling.","pos":[3959,4099]},{"pos":[4108,4135],"content":"Interoperability Marshaling","linkify":"Interoperability Marshaling","nodes":[{"content":"Interoperability Marshaling","pos":[0,27]}]},{"content":"All <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> applications share a set of common types that enable interoperability of objects, regardless of the programming language that is used.","pos":[4139,4331],"source":"All [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] applications share a set of common types that enable interoperability of objects, regardless of the programming language that is used."},{"content":"The parameters and return values of COM objects sometimes use data types that differ from those used in managed code.","pos":[4332,4449]},{"content":"<bpt id=\"p1\">*</bpt>Interoperability marshaling<ept id=\"p1\">*</ept> is the process of packaging parameters and return values into equivalent data types as they move to and from COM objects.","pos":[4450,4601],"source":"*Interoperability marshaling* is the process of packaging parameters and return values into equivalent data types as they move to and from COM objects."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Interop Marshaling<ept id=\"p1\">](../../../framework/interop/interop-marshaling.md)</ept>.","pos":[4602,4699],"source":" For more information, see [Interop Marshaling](../../../framework/interop/interop-marshaling.md)."},{"pos":[4708,4716],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4720,4795],"content":"<bpt id=\"p1\">[</bpt>COM Interop<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/index.md)</ept>","source":"[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)"},{"pos":[4798,4964],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Implementing Inheritance with COM Objects<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)</ept>","source":"[Walkthrough: Implementing Inheritance with COM Objects](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)"},{"pos":[4967,5040],"content":"<bpt id=\"p1\">[</bpt>Interoperating with Unmanaged Code<ept id=\"p1\">](../../../framework/interop/index.md)</ept>","source":"[Interoperating with Unmanaged Code](../../../framework/interop/index.md)"},{"pos":[5043,5166],"content":"<bpt id=\"p1\">[</bpt>Troubleshooting Interoperability<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/troubleshooting-interoperability.md)</ept>","source":"[Troubleshooting Interoperability](../../../visual-basic/programming-guide/com-interop/troubleshooting-interoperability.md)"},{"pos":[5169,5226],"content":"<bpt id=\"p1\">[</bpt>Assemblies in .NET<ept id=\"p1\">](../../../standard/assembly/index.md)</ept>","source":"[Assemblies in .NET](../../../standard/assembly/index.md)"},{"pos":[5229,5327],"content":"<bpt id=\"p1\">[</bpt>Tlbimp.exe (Type Library Importer)<ept id=\"p1\">](../../../framework/tools/tlbimp-exe-type-library-importer.md)</ept>","source":"[Tlbimp.exe (Type Library Importer)](../../../framework/tools/tlbimp-exe-type-library-importer.md)"},{"pos":[5330,5428],"content":"<bpt id=\"p1\">[</bpt>Tlbexp.exe (Type Library Exporter)<ept id=\"p1\">](../../../framework/tools/tlbexp-exe-type-library-exporter.md)</ept>","source":"[Tlbexp.exe (Type Library Exporter)](../../../framework/tools/tlbexp-exe-type-library-exporter.md)"},{"pos":[5431,5501],"content":"<bpt id=\"p1\">[</bpt>Interop Marshaling<ept id=\"p1\">](../../../framework/interop/interop-marshaling.md)</ept>","source":"[Interop Marshaling](../../../framework/interop/interop-marshaling.md)"},{"pos":[5504,5596],"content":"<bpt id=\"p1\">[</bpt>Registration-Free COM Interop<ept id=\"p1\">](../../../framework/interop/registration-free-com-interop.md)</ept>","source":"[Registration-Free COM Interop](../../../framework/interop/registration-free-com-interop.md)"}]}