{"content":"---\ntitle: \"Defining an Event in Windows Forms Controls\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"events [Windows Forms], defining within Windows Forms custom controls\"\n  - \"custom controls [Windows Forms], events using code\"\nms.assetid: d89f1096-8061-42e2-a855-a1f053f1940a\n---\n# Defining an Event in Windows Forms Controls\nFor details about defining custom events, see [Events](../../../standard/events/index.md). If you define an event that does not have any associated data, use the base type for event data, <xref:System.EventArgs>, and use <xref:System.EventHandler> as the event delegate. All that remains to do is to define an event member and a protected `On`*EventName* method that raises the event.  \n  \n The following code fragment shows how the `FlashTrackBar` custom control defines a custom event, `ValueChanged`. For the complete code for the `FlashTrackBar` sample, see the [How to: Create a Windows Forms Control That Shows Progress](how-to-create-a-windows-forms-control-that-shows-progress.md).  \n  \n```vb  \nOption Explicit  \nOption Strict  \n  \nImports System  \nImports System.Windows.Forms  \nImports System.Drawing  \n  \nPublic Class FlashTrackBar  \n   Inherits Control  \n  \n   ' The event does not have any data, so EventHandler is adequate   \n   ' as the event delegate.          \n   ' Define the event member using the event keyword.  \n   ' In this case, for efficiency, the event is defined   \n   ' using the event property construct.  \n   Public Event ValueChanged As EventHandler  \n   ' The protected method that raises the ValueChanged   \n   ' event when the value has actually   \n   ' changed. Derived controls can override this method.    \n   Protected Overridable Sub OnValueChanged(e As EventArgs)  \n      RaiseEvent ValueChanged(Me, e)  \n   End Sub  \nEnd Class  \n```  \n  \n```csharp  \nusing System;  \nusing System.Windows.Forms;  \nusing System.Drawing;  \n  \npublic class FlashTrackBar : Control {  \n   // The event does not have any data, so EventHandler is adequate   \n   // as the event delegate.  \n   private EventHandler onValueChanged;  \n   // Define the event member using the event keyword.  \n   // In this case, for efficiency, the event is defined   \n   // using the event property construct.  \n   public event EventHandler ValueChanged {  \n            add {  \n                onValueChanged += value;  \n            }  \n            remove {  \n                onValueChanged -= value;  \n            }  \n        }  \n   // The protected method that raises the ValueChanged  \n   // event when the value has actually   \n   // changed. Derived controls can override this method.    \n   protected virtual void OnValueChanged(EventArgs e) \n   {  \n       ValueChanged?.Invoke(this, e);  \n   }  \n}  \n```  \n  \n## See also\n\n- [Events in Windows Forms Controls](events-in-windows-forms-controls.md)\n- [Events](../../../standard/events/index.md)\n","nodes":[{"pos":[4,316],"embed":true,"restype":"x-metadata","content":"title: \"Defining an Event in Windows Forms Controls\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"events [Windows Forms], defining within Windows Forms custom controls\"\n  - \"custom controls [Windows Forms], events using code\"\nms.assetid: d89f1096-8061-42e2-a855-a1f053f1940a","nodes":[{"content":"Defining an Event in Windows Forms Controls","nodes":[{"pos":[0,43],"content":"Defining an Event in Windows Forms Controls","nodes":[{"content":"Defining an Event in Windows Forms Controls","pos":[0,43]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[323,366],"content":"Defining an Event in Windows Forms Controls","linkify":"Defining an Event in Windows Forms Controls","nodes":[{"content":"Defining an Event in Windows Forms Controls","pos":[0,43]}]},{"content":"For details about defining custom events, see <bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../standard/events/index.md)</ept>.","pos":[367,457],"source":"For details about defining custom events, see [Events](../../../standard/events/index.md)."},{"content":"If you define an event that does not have any associated data, use the base type for event data, <ph id=\"ph1\">&lt;xref:System.EventArgs&gt;</ph>, and use <ph id=\"ph2\">&lt;xref:System.EventHandler&gt;</ph> as the event delegate.","pos":[458,637],"source":" If you define an event that does not have any associated data, use the base type for event data, <xref:System.EventArgs>, and use <xref:System.EventHandler> as the event delegate."},{"content":"All that remains to do is to define an event member and a protected <ph id=\"ph1\">`On`</ph><bpt id=\"p1\">*</bpt>EventName<ept id=\"p1\">*</ept> method that raises the event.","pos":[638,751],"source":" All that remains to do is to define an event member and a protected `On`*EventName* method that raises the event."},{"content":"The following code fragment shows how the <ph id=\"ph1\">`FlashTrackBar`</ph> custom control defines a custom event, <ph id=\"ph2\">`ValueChanged`</ph>.","pos":[758,870],"source":"The following code fragment shows how the `FlashTrackBar` custom control defines a custom event, `ValueChanged`."},{"content":"For the complete code for the <ph id=\"ph1\">`FlashTrackBar`</ph> sample, see the <bpt id=\"p1\">[</bpt>How to: Create a Windows Forms Control That Shows Progress<ept id=\"p1\">](how-to-create-a-windows-forms-control-that-shows-progress.md)</ept>.","pos":[871,1056],"source":" For the complete code for the `FlashTrackBar` sample, see the [How to: Create a Windows Forms Control That Shows Progress](how-to-create-a-windows-forms-control-that-shows-progress.md)."},{"pos":[2784,2792],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2796,2867],"content":"<bpt id=\"p1\">[</bpt>Events in Windows Forms Controls<ept id=\"p1\">](events-in-windows-forms-controls.md)</ept>","source":"[Events in Windows Forms Controls](events-in-windows-forms-controls.md)"},{"pos":[2870,2913],"content":"<bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../standard/events/index.md)</ept>","source":"[Events](../../../standard/events/index.md)"}]}