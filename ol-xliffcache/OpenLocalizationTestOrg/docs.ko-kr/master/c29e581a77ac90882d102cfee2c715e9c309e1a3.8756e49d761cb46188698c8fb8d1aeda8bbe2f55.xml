{"content":"---\ntitle: \"ICorDebugMetaDataLocator::GetMetaData Method\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"ICorDebugMetaDataLocator.GetMetaData\"\napi_location: \n  - \"mscordbi.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICorDebugMetaDataLocator::GetMetaData\"\nhelpviewer_keywords: \n  - \"ICorDebugMetaDataLocator::GetMetaData method [.NET Framework debugging]\"\n  - \"GetMetaData method, ICorDebugMetaDataLocator interface [.NET Framework debugging]\"\nms.assetid: f9b0ff22-54db-45eb-9cc3-508000a3141d\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# ICorDebugMetaDataLocator::GetMetaData Method\nAsks the debugger to return the full path to a module whose metadata is needed to complete an operation the debugger requested.  \n  \n## Syntax  \n  \n```  \nHRESULT GetMetaData(  \n      [in] LPCWSTR wszImagePath,  \n      [in] DWORD   dwImageTimeStamp,  \n      [in] DWORD   dwImageSize,  \n      [in] ULONG32 cchPathBuffer,  \n      [out] ULONG32 * pcchPathBuffer,  \n      [out, size_is(cchPathBuffer), length_is(*pcchPathBuffer)]  \n               WCHAR wszPathBuffer[]  \n      );  \n```  \n  \n## Parameters  \n `wszImagePath`  \n [in] A null-terminated string that represents the full path to the file. If the full path is not available, the name and extension of the file (*filename*.*extension*).  \n  \n `dwImageTimeStamp`  \n [in] The time stamp from the image's PE file headers. This parameter can potentially be used for a symbol server ([SymSrv](/windows/desktop/debug/using-symsrv)) lookup.  \n  \n `dwImageSize`  \n [in] The image size from PE file headers. This parameter can potentially be used for a SymSrv lookup.  \n  \n `cchPathBuffer`  \n [in] The character count in `wszPathBuffer`.  \n  \n `pcchPathBuffer`  \n [out] The count of `WCHAR`s written to `wszPathBuffer`.  \n  \n If the method returns E_NOT_SUFFICIENT_BUFFER, contains the count of `WCHAR`s needed to store the path.  \n  \n `wszPathBuffer`  \n [out] Pointer to a buffer into which the debugger will copy the full path of the file that contains the requested metadata.  \n  \n The `ofReadOnly` flag from the [CorOpenFlags](../../../../docs/framework/unmanaged-api/metadata/coropenflags-enumeration.md) enumeration is used to request read-only access to the metadata in this file.  \n  \n## Return Value  \n This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure. All other failure HRESULTs indicate that the file is not retrievable.  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|The method completed successfully. `wszPathBuffer` contains the full path to the file and is null-terminated.|  \n|E_NOT_SUFFICIENT_BUFFER|The current size of `wszPathBuffer` is not sufficient to hold the full path. In this case, `pcchPathBuffer` contains the needed count of `WCHAR`s, including the terminating null character, and `GetMetaData` is called a second time with the requested buffer size.|  \n  \n## Remarks  \n If `wszImagePath` contains a full path for a module from a dump, it specifies the path from the computer where the dump was collected. The file may not exist at this location, or an incorrect file with the same name may be stored on the path.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** CorDebug.idl, CorDebug.h  \n  \n **Library:** CorGuids.lib  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See also\n\n- [ICorDebugThread4 Interface](../../../../docs/framework/unmanaged-api/debugging/icordebugthread4-interface.md)\n- [Debugging Interfaces](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md)\n- [Debugging](../../../../docs/framework/unmanaged-api/debugging/index.md)\n","nodes":[{"pos":[4,549],"embed":true,"restype":"x-metadata","content":"title: \"ICorDebugMetaDataLocator::GetMetaData Method\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"ICorDebugMetaDataLocator.GetMetaData\"\napi_location: \n  - \"mscordbi.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICorDebugMetaDataLocator::GetMetaData\"\nhelpviewer_keywords: \n  - \"ICorDebugMetaDataLocator::GetMetaData method [.NET Framework debugging]\"\n  - \"GetMetaData method, ICorDebugMetaDataLocator interface [.NET Framework debugging]\"\nms.assetid: f9b0ff22-54db-45eb-9cc3-508000a3141d\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"ICorDebugMetaDataLocator::GetMetaData Method","nodes":[{"pos":[0,44],"content":"ICorDebugMetaDataLocator::GetMetaData Method","nodes":[{"content":"ICorDebugMetaDataLocator::GetMetaData Method","pos":[0,44]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[556,600],"content":"ICorDebugMetaDataLocator::GetMetaData Method","linkify":"ICorDebugMetaDataLocator::GetMetaData Method","nodes":[{"content":"ICorDebugMetaDataLocator::GetMetaData Method","pos":[0,44]}]},{"content":"Asks the debugger to return the full path to a module whose metadata is needed to complete an operation the debugger requested.","pos":[601,728]},{"pos":[737,743],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1090,1100],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A null-terminated string that represents the full path to the file.","pos":[1122,1194]},{"content":"If the full path is not available, the name and extension of the file (<bpt id=\"p1\">*</bpt>filename<ept id=\"p1\">*</ept>.<bpt id=\"p2\">*</bpt>extension<ept id=\"p2\">*</ept>).","pos":[1195,1290],"source":" If the full path is not available, the name and extension of the file (*filename*.*extension*)."},{"content":"[in] The time stamp from the image's PE file headers.","pos":[1319,1372]},{"content":"This parameter can potentially be used for a symbol server (<bpt id=\"p1\">[</bpt>SymSrv<ept id=\"p1\">](/windows/desktop/debug/using-symsrv)</ept>) lookup.","pos":[1373,1487],"source":" This parameter can potentially be used for a symbol server ([SymSrv](/windows/desktop/debug/using-symsrv)) lookup."},{"content":"[in] The image size from PE file headers.","pos":[1511,1552]},{"content":"This parameter can potentially be used for a SymSrv lookup.","pos":[1553,1612]},{"content":"[in] The character count in <ph id=\"ph1\">`wszPathBuffer`</ph>.","pos":[1638,1682],"source":"[in] The character count in `wszPathBuffer`."},{"content":"[out] The count of <ph id=\"ph1\">`WCHAR`</ph>s written to <ph id=\"ph2\">`wszPathBuffer`</ph>.","pos":[1709,1764],"source":"[out] The count of `WCHAR`s written to `wszPathBuffer`."},{"pos":[1771,1874],"content":"If the method returns E_NOT_SUFFICIENT_BUFFER, contains the count of <ph id=\"ph1\">`WCHAR`</ph>s needed to store the path.","source":"If the method returns E_NOT_SUFFICIENT_BUFFER, contains the count of `WCHAR`s needed to store the path."},{"content":"[out] Pointer to a buffer into which the debugger will copy the full path of the file that contains the requested metadata.","pos":[1900,2023]},{"pos":[2030,2232],"content":"The <ph id=\"ph1\">`ofReadOnly`</ph> flag from the <bpt id=\"p1\">[</bpt>CorOpenFlags<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/coropenflags-enumeration.md)</ept> enumeration is used to request read-only access to the metadata in this file.","source":"The `ofReadOnly` flag from the [CorOpenFlags](../../../../docs/framework/unmanaged-api/metadata/coropenflags-enumeration.md) enumeration is used to request read-only access to the metadata in this file."},{"pos":[2241,2253],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.","pos":[2257,2364]},{"content":"All other failure HRESULTs indicate that the file is not retrievable.","pos":[2365,2434]},{"content":"HRESULT","pos":[2441,2448]},{"content":"Description","pos":[2449,2460]},{"content":"S_OK","pos":[2501,2505]},{"content":"The method completed successfully.","pos":[2506,2540]},{"content":"<ph id=\"ph1\">`wszPathBuffer`</ph> contains the full path to the file and is null-terminated.","pos":[2541,2615],"source":"`wszPathBuffer` contains the full path to the file and is null-terminated."},{"content":"E_NOT_SUFFICIENT_BUFFER","pos":[2620,2643]},{"content":"The current size of <ph id=\"ph1\">`wszPathBuffer`</ph> is not sufficient to hold the full path.","pos":[2644,2720],"source":"The current size of `wszPathBuffer` is not sufficient to hold the full path."},{"content":"In this case, <ph id=\"ph1\">`pcchPathBuffer`</ph> contains the needed count of <ph id=\"ph2\">`WCHAR`</ph>s, including the terminating null character, and <ph id=\"ph3\">`GetMetaData`</ph> is called a second time with the requested buffer size.","pos":[2721,2906],"source":" In this case, `pcchPathBuffer` contains the needed count of `WCHAR`s, including the terminating null character, and `GetMetaData` is called a second time with the requested buffer size."},{"pos":[2916,2923],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If <ph id=\"ph1\">`wszImagePath`</ph> contains a full path for a module from a dump, it specifies the path from the computer where the dump was collected.","pos":[2927,3061],"source":"If `wszImagePath` contains a full path for a module from a dump, it specifies the path from the computer where the dump was collected."},{"content":"The file may not exist at this location, or an incorrect file with the same name may be stored on the path.","pos":[3062,3169]},{"pos":[3178,3190],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3194,3298],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3305,3341],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> CorDebug.idl, CorDebug.h","source":"**Header:** CorDebug.idl, CorDebug.h"},{"pos":[3348,3373],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> CorGuids.lib","source":"**Library:** CorGuids.lib"},{"pos":[3380,3488],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[3497,3505],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3509,3619],"content":"<bpt id=\"p1\">[</bpt>ICorDebugThread4 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/icordebugthread4-interface.md)</ept>","source":"[ICorDebugThread4 Interface](../../../../docs/framework/unmanaged-api/debugging/icordebugthread4-interface.md)"},{"pos":[3622,3720],"content":"<bpt id=\"p1\">[</bpt>Debugging Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md)</ept>","source":"[Debugging Interfaces](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md)"},{"pos":[3723,3795],"content":"<bpt id=\"p1\">[</bpt>Debugging<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/index.md)</ept>","source":"[Debugging](../../../../docs/framework/unmanaged-api/debugging/index.md)"}]}