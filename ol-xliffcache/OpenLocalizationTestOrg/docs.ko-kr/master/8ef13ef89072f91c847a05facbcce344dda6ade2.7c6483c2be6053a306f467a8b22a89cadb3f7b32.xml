{"content":"---\ntitle: \"Walkthrough: Hosting a Windows Forms Control in WPF\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"hosting Windows Forms control in WPF [WPF]\"\nms.assetid: 9cb88415-39b0-4c46-80c4-ff325b674286\n---\n# Walkthrough: Hosting a Windows Forms Control in WPF\n\n[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides many controls with a rich feature set. However, you may sometimes want to use [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls on your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pages. For example, you may have a substantial investment in existing [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls, or you may have a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control that provides unique functionality.\n\nThis walkthrough shows you how to host a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] <xref:System.Windows.Forms.MaskedTextBox?displayProperty=nameWithType> control on a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] page by using code.\n\nFor a complete code listing of the tasks shown in this walkthrough, see [Hosting a Windows Forms Control in WPF Sample](https://go.microsoft.com/fwlink/?LinkID=160057).\n\n## Prerequisites\n\nYou need Visual Studio to complete this walkthrough.\n\n## Hosting the Windows Forms Control\n\n### To host the MaskedTextBox control\n\n1.  Create a WPF Application project named `HostingWfInWpf`.\n\n2.  Add references to the following assemblies.\n\n    -   WindowsFormsIntegration\n\n    -   System.Windows.Forms\n\n3.  Open MainWindow.xaml in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)].\n\n4.  Name the <xref:System.Windows.Controls.Grid> element `grid1`.\n\n     [!code-xaml[HostingWfInWPF#1](~/samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWPF/CSharp/HostingWfInWPF/Window1.xaml#1)]\n\n5.  In Design view or XAML view, select the <xref:System.Windows.Window> element.\n\n6.  In the Properties window, click the **Events** tab.\n\n7.  Double-click the <xref:System.Windows.FrameworkElement.Loaded> event.\n\n8.  Insert the following code to handle the <xref:System.Windows.FrameworkElement.Loaded> event.\n\n     [!code-csharp[HostingWfInWPF#10](~/samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWPF/CSharp/HostingWfInWPF/Window1.xaml.cs#10)]\n     [!code-vb[HostingWfInWPF#10](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HostingWfInWPF/VisualBasic/HostingWfInWpf/Window1.xaml.vb#10)]\n\n9. At the top of the file, add the following `Imports` or `using` statement.\n\n     [!code-csharp[HostingWfInWPF#11](~/samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWPF/CSharp/HostingWfInWPF/Window1.xaml.cs#11)]\n     [!code-vb[HostingWfInWPF#11](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HostingWfInWPF/VisualBasic/HostingWfInWpf/Window1.xaml.vb#11)]\n\n10. Press **F5** to build and run the application.\n\n## See also\n\n- <xref:System.Windows.Forms.Integration.ElementHost>\n- <xref:System.Windows.Forms.Integration.WindowsFormsHost>\n- [Design XAML in Visual Studio](/visualstudio/designers/designing-xaml-in-visual-studio)\n- [Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML](walkthrough-hosting-a-windows-forms-control-in-wpf-by-using-xaml.md)\n- [Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)\n- [Walkthrough: Hosting a WPF Composite Control in Windows Forms](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)\n- [Windows Forms Controls and Equivalent WPF Controls](windows-forms-controls-and-equivalent-wpf-controls.md)\n- [Hosting a Windows Forms Control in WPF Sample](https://go.microsoft.com/fwlink/?LinkID=160057)\n","nodes":[{"pos":[4,238],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Hosting a Windows Forms Control in WPF\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"hosting Windows Forms control in WPF [WPF]\"\nms.assetid: 9cb88415-39b0-4c46-80c4-ff325b674286","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Control in WPF","nodes":[{"pos":[0,51],"content":"Walkthrough: Hosting a Windows Forms Control in WPF","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Control in WPF","pos":[0,51]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[245,296],"content":"Walkthrough: Hosting a Windows Forms Control in WPF","linkify":"Walkthrough: Hosting a Windows Forms Control in WPF","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Control in WPF","pos":[0,51]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> provides many controls with a rich feature set.","pos":[298,427],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides many controls with a rich feature set."},{"content":"However, you may sometimes want to use <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls on your <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> pages.","pos":[428,650],"source":" However, you may sometimes want to use [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls on your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pages."},{"content":"For example, you may have a substantial investment in existing <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls, or you may have a <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> control that provides unique functionality.","pos":[651,941],"source":" For example, you may have a substantial investment in existing [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls, or you may have a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control that provides unique functionality."},{"pos":[943,1247],"content":"This walkthrough shows you how to host a <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Forms.MaskedTextBox?displayProperty=nameWithType&gt;</ph> control on a <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> page by using code.","source":"This walkthrough shows you how to host a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] <xref:System.Windows.Forms.MaskedTextBox?displayProperty=nameWithType> control on a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] page by using code."},{"pos":[1249,1417],"content":"For a complete code listing of the tasks shown in this walkthrough, see <bpt id=\"p1\">[</bpt>Hosting a Windows Forms Control in WPF Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=160057)</ept>.","source":"For a complete code listing of the tasks shown in this walkthrough, see [Hosting a Windows Forms Control in WPF Sample](https://go.microsoft.com/fwlink/?LinkID=160057)."},{"pos":[1422,1435],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need Visual Studio to complete this walkthrough.","pos":[1437,1489]},{"pos":[1494,1527],"content":"Hosting the Windows Forms Control","linkify":"Hosting the Windows Forms Control","nodes":[{"content":"Hosting the Windows Forms Control","pos":[0,33]}]},{"pos":[1533,1566],"content":"To host the MaskedTextBox control","linkify":"To host the MaskedTextBox control","nodes":[{"content":"To host the MaskedTextBox control","pos":[0,33]}]},{"pos":[1572,1628],"content":"Create a WPF Application project named <ph id=\"ph1\">`HostingWfInWpf`</ph>.","source":"Create a WPF Application project named `HostingWfInWpf`."},{"content":"Add references to the following assemblies.","pos":[1634,1677]},{"content":"WindowsFormsIntegration","pos":[1687,1710]},{"content":"System.Windows.Forms","pos":[1720,1740]},{"pos":[1746,1866],"content":"Open MainWindow.xaml in the <ph id=\"ph1\">[!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]</ph>.","source":"Open MainWindow.xaml in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]."},{"pos":[1872,1933],"content":"Name the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element <ph id=\"ph2\">`grid1`</ph>.","source":"Name the <xref:System.Windows.Controls.Grid> element `grid1`."},{"pos":[2071,2148],"content":"In Design view or XAML view, select the <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> element.","source":"In Design view or XAML view, select the <xref:System.Windows.Window> element."},{"pos":[2154,2205],"content":"In the Properties window, click the <bpt id=\"p1\">**</bpt>Events<ept id=\"p1\">**</ept> tab.","source":"In the Properties window, click the **Events** tab."},{"pos":[2211,2280],"content":"Double-click the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event.","source":"Double-click the <xref:System.Windows.FrameworkElement.Loaded> event."},{"pos":[2286,2378],"content":"Insert the following code to handle the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event.","source":"Insert the following code to handle the <xref:System.Windows.FrameworkElement.Loaded> event."},{"pos":[2385,2661],"content":"[!code-csharp[HostingWfInWPF#10](~/samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWPF/CSharp/HostingWfInWPF/Window1.xaml.cs#10)]\n [!code-vb[HostingWfInWPF#10](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HostingWfInWPF/VisualBasic/HostingWfInWpf/Window1.xaml.vb#10)]","leadings":["","    "],"nodes":[]},{"pos":[2666,2739],"content":"At the top of the file, add the following <ph id=\"ph1\">`Imports`</ph> or <ph id=\"ph2\">`using`</ph> statement.","source":"At the top of the file, add the following `Imports` or `using` statement."},{"pos":[2746,3022],"content":"[!code-csharp[HostingWfInWPF#11](~/samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWPF/CSharp/HostingWfInWPF/Window1.xaml.cs#11)]\n  [!code-vb[HostingWfInWPF#11](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HostingWfInWPF/VisualBasic/HostingWfInWpf/Window1.xaml.vb#11)]","leadings":["","   "],"nodes":[]},{"pos":[3028,3074],"content":"Press <bpt id=\"p1\">**</bpt>F5<ept id=\"p1\">**</ept> to build and run the application.","source":"Press **F5** to build and run the application."},{"pos":[3079,3087],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3204,3291],"content":"<bpt id=\"p1\">[</bpt>Design XAML in Visual Studio<ept id=\"p1\">](/visualstudio/designers/designing-xaml-in-visual-studio)</ept>","source":"[Design XAML in Visual Studio](/visualstudio/designers/designing-xaml-in-visual-studio)"},{"pos":[3294,3430],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML<ept id=\"p1\">](walkthrough-hosting-a-windows-forms-control-in-wpf-by-using-xaml.md)</ept>","source":"[Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML](walkthrough-hosting-a-windows-forms-control-in-wpf-by-using-xaml.md)"},{"pos":[3433,3561],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Composite Control in WPF<ept id=\"p1\">](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)</ept>","source":"[Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)"},{"pos":[3564,3692],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a WPF Composite Control in Windows Forms<ept id=\"p1\">](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)</ept>","source":"[Walkthrough: Hosting a WPF Composite Control in Windows Forms](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)"},{"pos":[3695,3802],"content":"<bpt id=\"p1\">[</bpt>Windows Forms Controls and Equivalent WPF Controls<ept id=\"p1\">](windows-forms-controls-and-equivalent-wpf-controls.md)</ept>","source":"[Windows Forms Controls and Equivalent WPF Controls](windows-forms-controls-and-equivalent-wpf-controls.md)"},{"pos":[3805,3900],"content":"<bpt id=\"p1\">[</bpt>Hosting a Windows Forms Control in WPF Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=160057)</ept>","source":"[Hosting a Windows Forms Control in WPF Sample](https://go.microsoft.com/fwlink/?LinkID=160057)"}]}