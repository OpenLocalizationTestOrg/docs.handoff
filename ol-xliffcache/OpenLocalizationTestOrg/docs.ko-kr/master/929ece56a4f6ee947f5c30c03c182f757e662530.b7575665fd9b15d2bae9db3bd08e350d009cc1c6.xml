{"content":"---\ntitle: \"Calling a REST-style service from a WCF service | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 77df81d8-7f53-4daf-8d2d-bf7996e94d5a\ncaps.latest.revision: 3\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Calling a REST-style service from a WCF service\nWhen calling a REST-style service from a regular (SOAP-based) WCF service, the operation context on the service method (which contains information about the incoming request) overrides the context which should be used by the outgoing request. This causes HTTP GET requests to change to HTTP POST requests. To force the WCF service to use the right context for calling the REST-style service, create a new <xref:System.ServiceModel.OperationContextScope> and call the REST-style service from inside the operation context scope. This topic will describe how to create a simple sample that illustrates this technique.  \n  \n## Define the REST-style service contract  \n Define a simple  REST-style service contract:  \n  \n```  \n[ServiceContract]  \n        public interface IRestInterface  \n        {  \n            [OperationContract, WebGet]  \n            int Add(int x, int y);  \n            [OperationContract, WebGet]  \n            string Echo(string input);  \n        }  \n```  \n  \n## Implement the REST-style service contract  \n Implement the REST-style service contract:  \n  \n```  \npublic class RestService : IRestInterface  \n        {  \n            public int Add(int x, int y)  \n            {  \n                return x + y;  \n            }  \n  \n            public string Echo(string input)  \n            {  \n                return input;  \n            }  \n        }  \n  \n```  \n  \n## Define the WCF service contract  \n Define a WCF service contract  that will be used to call the REST-style service:  \n  \n```  \n[ServiceContract]  \n public interface INormalInterface  \n {  \n     [OperationContract]  \n     int CallAdd(int x, int y);  \n     [OperationContract]  \n     string CallEcho(string input);  \n }  \n```  \n  \n## Implement the WCF service contract  \n Implement the WCF service contract:  \n  \n```  \npublic class NormalService : INormalInterface  \n        {  \n            static MyRestClient client = new MyRestClient(RestServiceBaseAddress);  \n            public int CallAdd(int x, int y)  \n            {  \n                return client.Add(x, y);  \n            }  \n  \n            public string CallEcho(string input)  \n            {  \n                return client.Echo(input);  \n            }  \n        }  \n```  \n  \n## Create the client proxy for the REST-style service  \n Using <!--zz<xref:System.ServiceModel.ClientBase%60>--> `System.ServiceModel.ClientBase` implement the client proxy. For each method called, a new <xref:System.ServiceModel.OperationContextScope> is created and used to call the operation.  \n  \n```  \npublic class MyRestClient : ClientBase<IRestInterface>, IRestInterface  \n        {  \n            public MyRestClient(string address)  \n                : base(new WebHttpBinding(), new EndpointAddress(address))  \n            {  \n                this.Endpoint.Behaviors.Add(new WebHttpBehavior());  \n            }  \n  \n            public int Add(int x, int y)  \n            {  \n                using (new OperationContextScope(this.InnerChannel))  \n                {  \n                    return base.Channel.Add(x, y);  \n                }  \n            }  \n  \n            public string Echo(string input)  \n            {  \n                using (new OperationContextScope(this.InnerChannel))  \n                {  \n                    return base.Channel.Echo(input);  \n                }  \n            }  \n        }  \n```  \n  \n## Host and call the services  \n Host both services in a console app, adding the needed endpoints and behaviors. And then call the regular WCF service:  \n  \n```  \npublic static void Main()  \n        {  \n            ServiceHost restHost = new ServiceHost(typeof(RestService), new Uri(RestServiceBaseAddress));  \n            restHost.AddServiceEndpoint(typeof(IRestInterface), new WebHttpBinding(), \"\").Behaviors.Add(new WebHttpBehavior());  \n            restHost.Open();  \n  \n            ServiceHost normalHost = new ServiceHost(typeof(NormalService), new Uri(NormalServiceBaseAddress));  \n            normalHost.AddServiceEndpoint(typeof(INormalInterface), new BasicHttpBinding(), \"\");  \n            normalHost.Open();  \n  \n            Console.WriteLine(\"Hosts opened\");  \n  \n            ChannelFactory<INormalInterface> factory = new ChannelFactory<INormalInterface>(new BasicHttpBinding(), new EndpointAddress(NormalServiceBaseAddress));  \n            INormalInterface proxy = factory.CreateChannel();  \n  \n            Console.WriteLine(proxy.CallAdd(123, 456));  \n            Console.WriteLine(proxy.CallEcho(\"Hello world\"));  \n        }  \n```  \n  \n## Complete code listing  \n The following is a complete listing of the sample implemented in this topic:  \n  \n```  \npublic class CallingRESTSample  \n    {  \n        static readonly string RestServiceBaseAddress = \"http://\" + Environment.MachineName + \":8008/Service\";  \n        static readonly string NormalServiceBaseAddress = \"http://\" + Environment.MachineName + \":8000/Service\";  \n  \n        [ServiceContract]  \n        public interface IRestInterface  \n        {  \n            [OperationContract, WebGet]  \n            int Add(int x, int y);  \n            [OperationContract, WebGet]  \n            string Echo(string input);  \n        }  \n  \n        [ServiceContract]  \n        public interface INormalInterface  \n        {  \n            [OperationContract]  \n            int CallAdd(int x, int y);  \n            [OperationContract]  \n            string CallEcho(string input);  \n        }  \n  \n        public class RestService : IRestInterface  \n        {  \n            public int Add(int x, int y)  \n            {  \n                return x + y;  \n            }  \n  \n            public string Echo(string input)  \n            {  \n                return input;  \n            }  \n        }  \n  \n        public class MyRestClient : ClientBase<IRestInterface>, IRestInterface  \n        {  \n            public MyRestClient(string address)  \n                : base(new WebHttpBinding(), new EndpointAddress(address))  \n            {  \n                this.Endpoint.Behaviors.Add(new WebHttpBehavior());  \n            }  \n  \n            public int Add(int x, int y)  \n            {  \n                using (new OperationContextScope(this.InnerChannel))  \n                {  \n                    return base.Channel.Add(x, y);  \n                }  \n            }  \n  \n            public string Echo(string input)  \n            {  \n                using (new OperationContextScope(this.InnerChannel))  \n                {  \n                    return base.Channel.Echo(input);  \n                }  \n            }  \n        }  \n  \n        public class NormalService : INormalInterface  \n        {  \n            static MyRestClient client = new MyRestClient(RestServiceBaseAddress);  \n            public int CallAdd(int x, int y)  \n            {  \n                return client.Add(x, y);  \n            }  \n  \n            public string CallEcho(string input)  \n            {  \n                return client.Echo(input);  \n            }  \n        }  \n        public static void Main()  \n        {  \n            ServiceHost restHost = new ServiceHost(typeof(RestService), new Uri(RestServiceBaseAddress));  \n            restHost.AddServiceEndpoint(typeof(IRestInterface), new WebHttpBinding(), \"\").Behaviors.Add(new WebHttpBehavior());  \n            restHost.Open();  \n  \n            ServiceHost normalHost = new ServiceHost(typeof(NormalService), new Uri(NormalServiceBaseAddress));  \n            normalHost.AddServiceEndpoint(typeof(INormalInterface), new BasicHttpBinding(), \"\");  \n            normalHost.Open();  \n  \n            Console.WriteLine(\"Hosts opened\");  \n  \n            ChannelFactory<INormalInterface> factory = new ChannelFactory<INormalInterface>(new BasicHttpBinding(), new EndpointAddress(NormalServiceBaseAddress));  \n            INormalInterface proxy = factory.CreateChannel();  \n  \n            Console.WriteLine(proxy.CallAdd(123, 456));  \n            Console.WriteLine(proxy.CallEcho(\"Hello world\"));  \n        }  \n    }  \n```  \n  \n## See Also  \n [How to: Create a Basic WCF Web HTTP Service](../../../../docs/framework/wcf/feature-details/how-to-create-a-basic-wcf-web-http-service.md)   \n [WCF Web HTTP Programming Object Model](../../../../docs/framework/wcf/feature-details/wcf-web-http-programming-object-model.md)","nodes":[{"pos":[4,367],"nodes":[{"content":"Calling a REST-style service from a WCF service | Microsoft Docs","nodes":[{"pos":[0,64],"content":"Calling a REST-style service from a WCF service | Microsoft Docs","nodes":[{"content":"Calling a REST-style service from a WCF service | Microsoft Docs","pos":[0,64]}]}],"pos":[6,73],"yaml":true}],"content":"title: \"Calling a REST-style service from a WCF service | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 77df81d8-7f53-4daf-8d2d-bf7996e94d5a\ncaps.latest.revision: 3\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","yamlblock":true},{"pos":[374,421],"content":"Calling a REST-style service from a WCF service","linkify":"Calling a REST-style service from a WCF service","nodes":[{"content":"Calling a REST-style service from a WCF service","pos":[0,47]}]},{"content":"When calling a REST-style service from a regular (SOAP-based) WCF service, the operation context on the service method (which contains information about the incoming request) overrides the context which should be used by the outgoing request.","pos":[422,664]},{"content":"This causes HTTP GET requests to change to HTTP POST requests.","pos":[665,727]},{"content":"To force the WCF service to use the right context for calling the REST-style service, create a new <ph id=\"ph1\">&lt;xref:System.ServiceModel.OperationContextScope&gt;</ph> and call the REST-style service from inside the operation context scope.","pos":[728,948],"source":" To force the WCF service to use the right context for calling the REST-style service, create a new <xref:System.ServiceModel.OperationContextScope> and call the REST-style service from inside the operation context scope."},{"content":"This topic will describe how to create a simple sample that illustrates this technique.","pos":[949,1036]},{"pos":[1045,1083],"content":"Define the REST-style service contract","linkify":"Define the REST-style service contract","nodes":[{"content":"Define the REST-style service contract","pos":[0,38]}]},{"content":"Define a simple  REST-style service contract:","pos":[1087,1132]},{"pos":[1404,1445],"content":"Implement the REST-style service contract","linkify":"Implement the REST-style service contract","nodes":[{"content":"Implement the REST-style service contract","pos":[0,41]}]},{"content":"Implement the REST-style service contract:","pos":[1449,1491]},{"pos":[1807,1838],"content":"Define the WCF service contract","linkify":"Define the WCF service contract","nodes":[{"content":"Define the WCF service contract","pos":[0,31]}]},{"content":"Define a WCF service contract  that will be used to call the REST-style service:","pos":[1842,1922]},{"pos":[2139,2173],"content":"Implement the WCF service contract","linkify":"Implement the WCF service contract","nodes":[{"content":"Implement the WCF service contract","pos":[0,34]}]},{"content":"Implement the WCF service contract:","pos":[2177,2212]},{"pos":[2646,2696],"content":"Create the client proxy for the REST-style service","linkify":"Create the client proxy for the REST-style service","nodes":[{"content":"Create the client proxy for the REST-style service","pos":[0,50]}]},{"content":"Using <ph id=\"ph1\">&lt;!--zz&lt;xref:System.ServiceModel.ClientBase%60&gt;--&gt;</ph> <ph id=\"ph2\">`System.ServiceModel.ClientBase`</ph> implement the client proxy.","pos":[2700,2816],"source":"Using <!--zz<xref:System.ServiceModel.ClientBase%60>--> `System.ServiceModel.ClientBase` implement the client proxy."},{"content":"For each method called, a new <ph id=\"ph1\">&lt;xref:System.ServiceModel.OperationContextScope&gt;</ph> is created and used to call the operation.","pos":[2817,2938],"source":" For each method called, a new <xref:System.ServiceModel.OperationContextScope> is created and used to call the operation."},{"pos":[3778,3804],"content":"Host and call the services","linkify":"Host and call the services","nodes":[{"content":"Host and call the services","pos":[0,26]}]},{"content":"Host both services in a console app, adding the needed endpoints and behaviors.","pos":[3808,3887]},{"content":"And then call the regular WCF service:","pos":[3888,3926]},{"pos":[4930,4951],"content":"Complete code listing","linkify":"Complete code listing","nodes":[{"content":"Complete code listing","pos":[0,21]}]},{"content":"The following is a complete listing of the sample implemented in this topic:","pos":[4955,5031]},{"pos":[8380,8388],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>How to: Create a Basic WCF Web HTTP Service<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-create-a-basic-wcf-web-http-service.md)</ept><ph id=\"ph1\"> </ph>","pos":[8392,8532],"source":"[How to: Create a Basic WCF Web HTTP Service](../../../../docs/framework/wcf/feature-details/how-to-create-a-basic-wcf-web-http-service.md) "},{"content":"<bpt id=\"p1\">[</bpt>WCF Web HTTP Programming Object Model<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/wcf-web-http-programming-object-model.md)</ept>","pos":[8536,8664],"source":"[WCF Web HTTP Programming Object Model](../../../../docs/framework/wcf/feature-details/wcf-web-http-programming-object-model.md)"}]}