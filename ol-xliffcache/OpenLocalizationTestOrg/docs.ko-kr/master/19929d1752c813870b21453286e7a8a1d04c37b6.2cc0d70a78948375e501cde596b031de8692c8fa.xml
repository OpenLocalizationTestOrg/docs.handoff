{"content":"---\ntitle: \"ICLRDomainManager::SetAppDomainManagerType Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICLRDomainManager.SetAppDomainManagerType\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRDomainManager::SetAppDomainManagerType\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"SetAppDomainManagerType method, ICLRDomainManager interface [.NET Framework hosting]\"\n  - \"ICLRDomainManager::SetAppDomainManagerType method [.NET Framework hosting]\"\nms.assetid: ee91abb0-cb74-41dd-927b-e117fb8ffdf4\ncaps.latest.revision: 7\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# ICLRDomainManager::SetAppDomainManagerType Method\nSpecifies the type, derived from the <xref:System.AppDomainManager?displayProperty=fullName> class, of the application domain manager that will be used to initialize the default application domain.  \n  \n## Syntax  \n  \n```  \nHRESULT SetAppDomainManagerType(  \n    [in] LPCWSTR wszAppDomainManagerAssembly,  \n    [in] LPCWSTR wszAppDomainManagerType,  \n    [in] EInitializeNewDomainFlags dwInitializeDomainFlags  \n);  \n```  \n  \n#### Parameters  \n `wszAppDomainManagerAssembly`  \n [in] The display name of the assembly that contains the application domain manager type; for example: \"AdMgrExample, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6856bccf150f00b3\".  \n  \n `wszAppDomainManagerType`  \n [in] The type name of the application domain manager, including the namespace.  \n  \n `dwInitializeDomainFlags`  \n [in] A combination of [EInitializeNewDomainFlags](../../../../docs/framework/unmanaged-api/hosting/einitializenewdomainflags-enumeration.md) enumeration values that provide information about the application domain manager.  \n  \n## Return Value  \n This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|The method completed successfully.|  \n|HOST_E_CLRNOTAVAILABLE|The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.|  \n  \n## Remarks  \n Currently, the only defined value for `dwInitializeDomainFlags` is `eInitializeNewDomainFlags_NoSecurityChanges`, which tells the common language runtime (CLR) that the application domain manager will not modify security settings during the execution of the <xref:System.AppDomainManager.InitializeNewDomain%2A?displayProperty=fullName> method. This allows the CLR to optimize the loading of assemblies that have the conditional <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA) attribute. This can result in a significant improvement in startup time if the transitive closure of this set of assemblies is large.  \n  \n> [!IMPORTANT]\n>  If the host specifies `eInitializeNewDomainFlags_NoSecurityChanges` for the application domain manager, an <xref:System.InvalidOperationException> is thrown if any attempt is made to modify the security of the application domain.  \n  \n Calling the [ICLRControl::SetAppDomainManagerType](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-setappdomainmanagertype-method.md)method is equivalent to calling `ICLRDomainManager::SetAppDomainManagerType`with `eInitializeNewDomainFlags_None`.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MetaHost.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See Also  \n [Hosting](../../../../docs/framework/unmanaged-api/hosting/index.md)   \n [ICLRDomainManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrdomainmanager-interface.md)   \n [EInitializeNewDomainFlags Enumeration](../../../../docs/framework/unmanaged-api/hosting/einitializenewdomainflags-enumeration.md)","nodes":[{"pos":[4,768],"embed":true,"restype":"x-metadata","content":"title: \"ICLRDomainManager::SetAppDomainManagerType Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICLRDomainManager.SetAppDomainManagerType\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRDomainManager::SetAppDomainManagerType\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"SetAppDomainManagerType method, ICLRDomainManager interface [.NET Framework hosting]\"\n  - \"ICLRDomainManager::SetAppDomainManagerType method [.NET Framework hosting]\"\nms.assetid: ee91abb0-cb74-41dd-927b-e117fb8ffdf4\ncaps.latest.revision: 7\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"ICLRDomainManager::SetAppDomainManagerType Method | Microsoft Docs","nodes":[{"pos":[0,66],"content":"ICLRDomainManager::SetAppDomainManagerType Method | Microsoft Docs","nodes":[{"content":"ICLRDomainManager::SetAppDomainManagerType Method | Microsoft Docs","pos":[0,66]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[775,824],"content":"ICLRDomainManager::SetAppDomainManagerType Method","linkify":"ICLRDomainManager::SetAppDomainManagerType Method","nodes":[{"content":"ICLRDomainManager::SetAppDomainManagerType Method","pos":[0,49]}]},{"content":"Specifies the type, derived from the <ph id=\"ph1\">&lt;xref:System.AppDomainManager?displayProperty=fullName&gt;</ph> class, of the application domain manager that will be used to initialize the default application domain.","pos":[825,1022],"source":"Specifies the type, derived from the <xref:System.AppDomainManager?displayProperty=fullName> class, of the application domain manager that will be used to initialize the default application domain."},{"pos":[1031,1037],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1256,1266],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The display name of the assembly that contains the application domain manager type; for example: \"AdMgrExample, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6856bccf150f00b3\".","pos":[1303,1487]},{"content":"[in] The type name of the application domain manager, including the namespace.","pos":[1523,1601]},{"content":"[in] A combination of <bpt id=\"p1\">[</bpt>EInitializeNewDomainFlags<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/einitializenewdomainflags-enumeration.md)</ept> enumeration values that provide information about the application domain manager.","pos":[1637,1859],"source":"[in] A combination of [EInitializeNewDomainFlags](../../../../docs/framework/unmanaged-api/hosting/einitializenewdomainflags-enumeration.md) enumeration values that provide information about the application domain manager."},{"pos":[1868,1880],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.","pos":[1884,1991]},{"content":"HRESULT","pos":[1998,2005]},{"content":"Description","pos":[2006,2017]},{"content":"S_OK","pos":[2058,2062]},{"content":"The method completed successfully.","pos":[2063,2097]},{"content":"HOST_E_CLRNOTAVAILABLE","pos":[2102,2124]},{"content":"The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.","pos":[2125,2289]},{"pos":[2299,2306],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Currently, the only defined value for <ph id=\"ph1\">`dwInitializeDomainFlags`</ph> is <ph id=\"ph2\">`eInitializeNewDomainFlags_NoSecurityChanges`</ph>, which tells the common language runtime (CLR) that the application domain manager will not modify security settings during the execution of the <ph id=\"ph3\">&lt;xref:System.AppDomainManager.InitializeNewDomain%2A?displayProperty=fullName&gt;</ph> method.","pos":[2310,2654],"source":"Currently, the only defined value for `dwInitializeDomainFlags` is `eInitializeNewDomainFlags_NoSecurityChanges`, which tells the common language runtime (CLR) that the application domain manager will not modify security settings during the execution of the <xref:System.AppDomainManager.InitializeNewDomain%2A?displayProperty=fullName> method."},{"content":"This allows the CLR to optimize the loading of assemblies that have the conditional <ph id=\"ph1\">&lt;xref:System.Security.AllowPartiallyTrustedCallersAttribute&gt;</ph> (APTCA) attribute.","pos":[2655,2818],"source":" This allows the CLR to optimize the loading of assemblies that have the conditional <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA) attribute."},{"content":"This can result in a significant improvement in startup time if the transitive closure of this set of assemblies is large.","pos":[2819,2941]},{"pos":[2949,3194],"content":"[!IMPORTANT]\n If the host specifies `eInitializeNewDomainFlags_NoSecurityChanges` for the application domain manager, an <xref:System.InvalidOperationException> is thrown if any attempt is made to modify the security of the application domain.","leadings":["","> "],"nodes":[{"content":"If the host specifies <ph id=\"ph1\">`eInitializeNewDomainFlags_NoSecurityChanges`</ph> for the application domain manager, an <ph id=\"ph2\">&lt;xref:System.InvalidOperationException&gt;</ph> is thrown if any attempt is made to modify the security of the application domain.","pos":[14,243],"source":"If the host specifies `eInitializeNewDomainFlags_NoSecurityChanges` for the application domain manager, an <xref:System.InvalidOperationException> is thrown if any attempt is made to modify the security of the application domain."}]},{"pos":[3201,3461],"content":"Calling the <bpt id=\"p1\">[</bpt>ICLRControl::SetAppDomainManagerType<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-setappdomainmanagertype-method.md)</ept>method is equivalent to calling <ph id=\"ph1\">`ICLRDomainManager::SetAppDomainManagerType`</ph>with <ph id=\"ph2\">`eInitializeNewDomainFlags_None`</ph>.","source":"Calling the [ICLRControl::SetAppDomainManagerType](../../../../docs/framework/unmanaged-api/hosting/iclrcontrol-setappdomainmanagertype-method.md)method is equivalent to calling `ICLRDomainManager::SetAppDomainManagerType`with `eInitializeNewDomainFlags_None`."},{"pos":[3470,3482],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3486,3590],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3597,3619],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MetaHost.h","source":"**Header:** MetaHost.h"},{"pos":[3626,3676],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[3683,3791],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[3800,3808],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Hosting<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[3812,3881],"source":"[Hosting](../../../../docs/framework/unmanaged-api/hosting/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>ICLRDomainManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrdomainmanager-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[3885,3996],"source":"[ICLRDomainManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrdomainmanager-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>EInitializeNewDomainFlags Enumeration<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/einitializenewdomainflags-enumeration.md)</ept>","pos":[4000,4130],"source":"[EInitializeNewDomainFlags Enumeration](../../../../docs/framework/unmanaged-api/hosting/einitializenewdomainflags-enumeration.md)"}]}