{"content":"---\ntitle: \"Anonymous Type Definition (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"anonymous types [Visual Basic], type definition\"\nms.assetid: 7a8a0ddc-55ba-4d67-869e-87a84d938bac\n---\n# Anonymous Type Definition (Visual Basic)\nIn response to the declaration of an instance of an anonymous type, the compiler creates a new class definition that contains the specified properties for the type.  \n  \n## Compiler-Generated Code  \n For the following definition of `product`, the compiler creates a new class definition that contains properties `Name`, `Price`, and `OnHand`.  \n  \n [!code-vb[VbVbalrAnonymousTypes#25](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#25)]  \n  \n The class definition contains property definitions similar to the following. Notice that there is no `Set` method for the key properties. The values of key properties are read-only.  \n  \n```vb  \nPublic Class $Anonymous1  \n    Private _name As String  \n    Private _price As Double  \n    Private _onHand As Integer  \n     Public ReadOnly Property Name() As String  \n        Get  \n            Return _name  \n        End Get  \n    End Property  \n  \n    Public ReadOnly Property Price() As Double  \n        Get  \n            Return _price  \n        End Get  \n    End Property  \n  \n    Public Property OnHand() As Integer  \n        Get  \n            Return _onHand  \n        End Get  \n        Set(ByVal Value As Integer)  \n            _onHand = Value  \n        End Set  \n    End Property  \n  \nEnd Class  \n```  \n  \n In addition, anonymous type definitions contain a default constructor. Constructors that require parameters are not permitted.  \n  \n If an anonymous type declaration contains at least one key property, the type definition overrides three members inherited from <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>. If no key properties are declared, only <xref:System.Object.ToString%2A> is overridden. The overrides provide the following functionality:  \n  \n-   `Equals` returns `True` if two anonymous type instances are the same instance, or if they meet the following conditions:  \n  \n    -   They have the same number of properties.  \n  \n    -   The properties are declared in the same order, with the same names and the same inferred types. Name comparisons are not case-sensitive.  \n  \n    -   At least one of the properties is a key property, and the `Key` keyword is applied to the same properties.  \n  \n    -   Comparison of each corresponding pair of key properties returns `True`.  \n  \n     For example, in the following examples, `Equals` returns `True` only for `employee01` and `employee08`. The comment before each line specifies the reason why the new instance does not match `employee01`.  \n  \n     [!code-vb[VbVbalrAnonymousTypes#24](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#24)]  \n  \n-   `GetHashcode` provides an appropriately unique GetHashCode algorithm. The algorithm uses only the key properties to compute the hash code.  \n  \n-   `ToString` returns a string of concatenated property values, as shown in the following example. Both key and non-key properties are included.  \n  \n     [!code-vb[VbVbalrAnonymousTypes#29](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#29)]  \n  \n Explicitly named properties of an anonymous type cannot conflict with these generated methods. That is, you cannot use `.Equals`, `.GetHashCode`, or `.ToString` to name a property.  \n  \n Anonymous type definitions that include at least one key property also implement the <xref:System.IEquatable%601?displayProperty=nameWithType> interface, where `T` is the type of the anonymous type.  \n  \n> [!NOTE]\n>  Anonymous type declarations create the same anonymous type only if they occur in the same assembly, their properties have the same names and the same inferred types, the properties are declared in the same order, and the same properties are marked as key properties.  \n  \n## See also\n\n- [Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)\n- [How to: Infer Property Names and Types in Anonymous Type Declarations](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)\n","nodes":[{"pos":[4,198],"embed":true,"restype":"x-metadata","content":"title: \"Anonymous Type Definition (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"anonymous types [Visual Basic], type definition\"\nms.assetid: 7a8a0ddc-55ba-4d67-869e-87a84d938bac","nodes":[{"content":"Anonymous Type Definition (Visual Basic)","nodes":[{"pos":[0,40],"content":"Anonymous Type Definition (Visual Basic)","nodes":[{"content":"Anonymous Type Definition (Visual Basic)","pos":[0,40]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[205,245],"content":"Anonymous Type Definition (Visual Basic)","linkify":"Anonymous Type Definition (Visual Basic)","nodes":[{"content":"Anonymous Type Definition (Visual Basic)","pos":[0,40]}]},{"content":"In response to the declaration of an instance of an anonymous type, the compiler creates a new class definition that contains the specified properties for the type.","pos":[246,410]},{"pos":[419,442],"content":"Compiler-Generated Code","linkify":"Compiler-Generated Code","nodes":[{"content":"Compiler-Generated Code","pos":[0,23]}]},{"pos":[446,588],"content":"For the following definition of <ph id=\"ph1\">`product`</ph>, the compiler creates a new class definition that contains properties <ph id=\"ph2\">`Name`</ph>, <ph id=\"ph3\">`Price`</ph>, and <ph id=\"ph4\">`OnHand`</ph>.","source":"For the following definition of `product`, the compiler creates a new class definition that contains properties `Name`, `Price`, and `OnHand`."},{"content":"The class definition contains property definitions similar to the following.","pos":[729,805]},{"content":"Notice that there is no <ph id=\"ph1\">`Set`</ph> method for the key properties.","pos":[806,866],"source":" Notice that there is no `Set` method for the key properties."},{"content":"The values of key properties are read-only.","pos":[867,910]},{"content":"In addition, anonymous type definitions contain a default constructor.","pos":[1539,1609]},{"content":"Constructors that require parameters are not permitted.","pos":[1610,1665]},{"content":"If an anonymous type declaration contains at least one key property, the type definition overrides three members inherited from <ph id=\"ph1\">&lt;xref:System.Object&gt;</ph>: <ph id=\"ph2\">&lt;xref:System.Object.Equals%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Object.GetHashCode%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Object.ToString%2A&gt;</ph>.","pos":[1672,1928],"source":"If an anonymous type declaration contains at least one key property, the type definition overrides three members inherited from <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>."},{"content":"If no key properties are declared, only <ph id=\"ph1\">&lt;xref:System.Object.ToString%2A&gt;</ph> is overridden.","pos":[1929,2016],"source":" If no key properties are declared, only <xref:System.Object.ToString%2A> is overridden."},{"content":"The overrides provide the following functionality:","pos":[2017,2067]},{"pos":[2077,2197],"content":"<ph id=\"ph1\">`Equals`</ph> returns <ph id=\"ph2\">`True`</ph> if two anonymous type instances are the same instance, or if they meet the following conditions:","source":"`Equals` returns `True` if two anonymous type instances are the same instance, or if they meet the following conditions:"},{"content":"They have the same number of properties.","pos":[2211,2251]},{"content":"The properties are declared in the same order, with the same names and the same inferred types.","pos":[2265,2360]},{"content":"Name comparisons are not case-sensitive.","pos":[2361,2401]},{"pos":[2415,2521],"content":"At least one of the properties is a key property, and the <ph id=\"ph1\">`Key`</ph> keyword is applied to the same properties.","source":"At least one of the properties is a key property, and the `Key` keyword is applied to the same properties."},{"pos":[2535,2606],"content":"Comparison of each corresponding pair of key properties returns <ph id=\"ph1\">`True`</ph>.","source":"Comparison of each corresponding pair of key properties returns `True`."},{"content":"For example, in the following examples, <ph id=\"ph1\">`Equals`</ph> returns <ph id=\"ph2\">`True`</ph> only for <ph id=\"ph3\">`employee01`</ph> and <ph id=\"ph4\">`employee08`</ph>.","pos":[2617,2720],"source":"For example, in the following examples, `Equals` returns `True` only for `employee01` and `employee08`."},{"content":"The comment before each line specifies the reason why the new instance does not match <ph id=\"ph1\">`employee01`</ph>.","pos":[2721,2820],"source":" The comment before each line specifies the reason why the new instance does not match `employee01`."},{"content":"<ph id=\"ph1\">`GetHashcode`</ph> provides an appropriately unique GetHashCode algorithm.","pos":[2968,3037],"source":"`GetHashcode` provides an appropriately unique GetHashCode algorithm."},{"content":"The algorithm uses only the key properties to compute the hash code.","pos":[3038,3106]},{"content":"<ph id=\"ph1\">`ToString`</ph> returns a string of concatenated property values, as shown in the following example.","pos":[3116,3211],"source":"`ToString` returns a string of concatenated property values, as shown in the following example."},{"content":"Both key and non-key properties are included.","pos":[3212,3257]},{"content":"Explicitly named properties of an anonymous type cannot conflict with these generated methods.","pos":[3402,3496]},{"content":"That is, you cannot use <ph id=\"ph1\">`.Equals`</ph>, <ph id=\"ph2\">`.GetHashCode`</ph>, or <ph id=\"ph3\">`.ToString`</ph> to name a property.","pos":[3497,3582],"source":" That is, you cannot use `.Equals`, `.GetHashCode`, or `.ToString` to name a property."},{"pos":[3589,3787],"content":"Anonymous type definitions that include at least one key property also implement the <ph id=\"ph1\">&lt;xref:System.IEquatable%601?displayProperty=nameWithType&gt;</ph> interface, where <ph id=\"ph2\">`T`</ph> is the type of the anonymous type.","source":"Anonymous type definitions that include at least one key property also implement the <xref:System.IEquatable%601?displayProperty=nameWithType> interface, where `T` is the type of the anonymous type."},{"pos":[3795,4072],"content":"[!NOTE]\n Anonymous type declarations create the same anonymous type only if they occur in the same assembly, their properties have the same names and the same inferred types, the properties are declared in the same order, and the same properties are marked as key properties.","leadings":["","> "],"nodes":[{"content":"Anonymous type declarations create the same anonymous type only if they occur in the same assembly, their properties have the same names and the same inferred types, the properties are declared in the same order, and the same properties are marked as key properties.","pos":[9,275]}]},{"pos":[4081,4089],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4093,4211],"content":"<bpt id=\"p1\">[</bpt>Anonymous Types<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)</ept>","source":"[Anonymous Types](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)"},{"pos":[4214,4439],"content":"<bpt id=\"p1\">[</bpt>How to: Infer Property Names and Types in Anonymous Type Declarations<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)</ept>","source":"[How to: Infer Property Names and Types in Anonymous Type Declarations](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)"}]}