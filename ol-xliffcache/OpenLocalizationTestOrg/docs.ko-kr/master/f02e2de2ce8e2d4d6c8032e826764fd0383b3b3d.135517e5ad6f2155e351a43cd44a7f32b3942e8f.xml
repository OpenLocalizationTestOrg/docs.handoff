{"content":"---\ntitle: \"Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)\"\nms.date: 07/20/2015\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"dynamic objects [Visual Basic]\"\n  - \"dynamic objects\"\n  - \"dynamic objects [C#]\"\nms.assetid: 568f1645-1305-4906-8625-5d77af81e04f\n---\n# Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)\n\nDynamic objects expose members such as properties and methods at run time, instead of at compile time. This enables you to create objects to work with structures that do not match a static type or format. For example, you can use a dynamic object to reference the HTML Document Object Model (DOM), which can contain any combination of valid HTML markup elements and attributes. Because each HTML document is unique, the members for a particular HTML document are determined at run time. A common method to reference an attribute of an HTML element is to pass the name of the attribute to the `GetProperty` method of the element. To reference the `id` attribute of the HTML element `<div id=\"Div1\">`, you first obtain a reference to the `<div>` element, and then use `divElement.GetProperty(\"id\")`. If you use a dynamic object, you can reference the `id` attribute as `divElement.id`.  \n  \n Dynamic objects also provide convenient access to dynamic languages such as IronPython and IronRuby. You can use a dynamic object to refer to a dynamic script that is interpreted at run time.  \n  \n You reference a dynamic object by using late binding. In C#, you specify the type of a late-bound object as `dynamic`. In Visual Basic, you specify the type of a late-bound object as `Object`. For more information, see [dynamic](../../../csharp/language-reference/keywords/dynamic.md) and [Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).  \n  \n You can create custom dynamic objects by using the classes in the <xref:System.Dynamic?displayProperty=nameWithType> namespace. For example, you can create an <xref:System.Dynamic.ExpandoObject> and specify the members of that object at run time. You can also create your own type that inherits the <xref:System.Dynamic.DynamicObject> class. You can then override the members of the <xref:System.Dynamic.DynamicObject> class to provide run-time dynamic functionality.  \n  \n In this walkthrough you will perform the following tasks:  \n  \n-   Create a custom object that dynamically exposes the contents of a text file as properties of an object.  \n  \n-   Create a project that uses an `IronPython` library.  \n  \n## Prerequisites  \n\nYou need [IronPython](https://ironpython.net/) for .NET to complete this walkthrough. Go to their [Download page](https://ironpython.net/download/) to obtain the latest version.\n  \n[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  \n  \n## Creating a Custom Dynamic Object\n\nThe first project that you create in this walkthrough defines a custom dynamic object that searches the contents of a text file. Text to search for is specified by the name of a dynamic property. For example, if calling code specifies `dynamicFile.Sample`, the dynamic class returns a generic list of strings that contains all of the lines from the file that begin with \"Sample\". The search is case-insensitive. The dynamic class also supports two optional arguments. The first argument is a search option enum value that specifies that the dynamic class should search for matches at the start of the line, the end of the line, or anywhere in the line. The second argument specifies that the dynamic class should trim leading and trailing spaces from each line before searching. For example, if calling code specifies `dynamicFile.Sample(StringSearchOption.Contains)`, the dynamic class searches for \"Sample\" anywhere in a line. If calling code specifies `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, the dynamic class searches for \"Sample\" at the start of each line, and does not remove leading and trailing spaces. The default behavior of the dynamic class is to search for a match at the start of each line and to remove leading and trailing spaces.  \n  \n### To create a custom dynamic class  \n  \n1.  Start Visual Studio.  \n  \n2.  On the **File** menu, point to **New** and then click **Project**.  \n  \n3.  In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected. Select **Console Application** in the **Templates** pane. In the **Name** box, type `DynamicSample`, and then click **OK**. The new project is created.  \n  \n4.  Right-click the DynamicSample project and point to **Add**, and then click **Class**. In the **Name** box, type `ReadOnlyFile`, and then click **OK**. A new file is added that contains the ReadOnlyFile class.  \n  \n5.  At the top of the ReadOnlyFile.cs or ReadOnlyFile.vb file, add the following code to import the <xref:System.IO?displayProperty=nameWithType> and <xref:System.Dynamic?displayProperty=nameWithType> namespaces.  \n\n    [!code-csharp[VbDynamicWalkthrough#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#1)]\n    [!code-vb[VbDynamicWalkthrough#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#1)]  \n\n6.  The custom dynamic object uses an enum to determine the search criteria. Before the class statement, add the following enum definition.  \n  \n    [!code-csharp[VbDynamicWalkthrough#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#2)]\n    [!code-vb[VbDynamicWalkthrough#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#2)]\n  \n7.  Update the class statement to inherit the `DynamicObject` class, as shown in the following code example.  \n  \n    [!code-csharp[VbDynamicWalkthrough#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#3)]\n    [!code-vb[VbDynamicWalkthrough#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#3)]\n\n8.  Add the following code to the `ReadOnlyFile` class to define a private field for the file path and a constructor for the `ReadOnlyFile` class.  \n  \n    [!code-csharp[VbDynamicWalkthrough#4](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#4)]\n    [!code-vb[VbDynamicWalkthrough#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#4)]\n  \n9. Add the following `GetPropertyValue` method to the `ReadOnlyFile` class. The `GetPropertyValue` method takes, as input, search criteria and returns the lines from a text file that match that search criteria. The dynamic methods provided by the `ReadOnlyFile` class call the `GetPropertyValue` method to retrieve their respective results.  \n  \n    [!code-csharp[VbDynamicWalkthrough#5](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#5)]\n    [!code-vb[VbDynamicWalkthrough#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#5)]  \n  \n10. After the `GetPropertyValue` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method of the <xref:System.Dynamic.DynamicObject> class. The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method is called when a member of a dynamic class is requested and no arguments are specified. The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member. The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.  \n  \n    [!code-csharp[VbDynamicWalkthrough#6](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#6)]\n    [!code-vb[VbDynamicWalkthrough#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#6)]\n  \n11. After the `TryGetMember` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method of the <xref:System.Dynamic.DynamicObject> class. The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method is called when a member of a dynamic class is requested with arguments. The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member. The `args` argument contains an array of the arguments that are passed to the member. The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.  \n  \n    The custom version of the `TryInvokeMember` method expects the first argument to be a value from the `StringSearchOption` enum that you defined in a previous step. The `TryInvokeMember` method expects the second argument to be a Boolean value. If one or both arguments are valid values, they are passed to the `GetPropertyValue` method to retrieve the results.  \n  \n    [!code-csharp[VbDynamicWalkthrough#7](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#7)]\n    [!code-vb[VbDynamicWalkthrough#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#7)]\n  \n12. Save and close the file.  \n  \n#### To create a sample text file  \n  \n1.  Right-click the DynamicSample project and point to **Add**, and then click **New Item**. In the **Installed Templates** pane, select **General**, and then select the **Text File** template. Leave the default name of TextFile1.txt in the **Name** box, and then click **Add**. A new text file is added to the project.  \n  \n2.  Copy the following text to the TextFile1.txt file.  \n  \n    ```  \n    List of customers and suppliers  \n  \n    Supplier: Lucerne Publishing (https://www.lucernepublishing.com/)  \n    Customer: Preston, Chris  \n    Customer: Hines, Patrick  \n    Customer: Cameron, Maria  \n    Supplier: Graphic Design Institute (https://www.graphicdesigninstitute.com/)   \n    Supplier: Fabrikam, Inc. (https://www.fabrikam.com/)   \n    Customer: Seubert, Roxanne  \n    Supplier: Proseware, Inc. (http://www.proseware.com/)   \n    Customer: Adolphi, Stephan  \n    Customer: Koch, Paul  \n    ```  \n  \n3.  Save and close the file.  \n  \n#### To create a sample application that uses the custom dynamic object  \n  \n1.  In **Solution Explorer**, double-click the Module1.vb file if you are using Visual Basic or the Program.cs file if you are using Visual C#.  \n  \n2.  Add the following code to the Main procedure to create an instance of the `ReadOnlyFile` class for the TextFile1.txt file. The code uses late binding to call dynamic members and retrieve lines of text that contain the string \"Customer\".  \n  \n     [!code-csharp[VbDynamicWalkthrough#8](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/program.cs#8)]\n     [!code-vb[VbDynamicWalkthrough#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/module1.vb#8)]\n  \n3.  Save the file and press CTRL+F5 to build and run the application.  \n  \n## Calling a Dynamic Language Library  \n\nThe next project that you create in this walkthrough accesses a library that is written in the dynamic language IronPython.\n  \n### To create a custom dynamic class\n  \n1.  In Visual Studio, on the **File** menu, point to **New** and then click **Project**.  \n  \n2.  In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected. Select **Console Application** in the **Templates** pane. In the **Name** box, type `DynamicIronPythonSample`, and then click **OK**. The new project is created.  \n  \n3.  If you are using Visual Basic, right-click the DynamicIronPythonSample project and then click **Properties**. Click the **References** tab. Click the **Add** button. If you are using Visual C#, in **Solution Explorer**, right-click the **References** folder and then click **Add Reference**.  \n  \n4.  On the **Browse** tab, browse to the folder where the IronPython libraries are installed. For example, C:\\Program Files\\IronPython 2.6 for .NET 4.0. Select the **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**, and **Microsoft.Dynamic.dll** libraries. Click **OK**.  \n  \n5.  If you are using Visual Basic, edit the Module1.vb file. If you are using Visual C#, edit the Program.cs file.  \n  \n6.  At the top of the file, add the following code to import the `Microsoft.Scripting.Hosting` and `IronPython.Hosting` namespaces from the IronPython libraries.  \n  \n    [!code-csharp[VbDynamicWalkthroughIronPython#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#1)]\n    [!code-vb[VbDynamicWalkthroughIronPython#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#1)]\n  \n7.  In the Main method, add the following code to create a new `Microsoft.Scripting.Hosting.ScriptRuntime` object to host the IronPython libraries. The `ScriptRuntime` object loads the IronPython library module random.py.  \n  \n     [!code-csharp[VbDynamicWalkthroughIronPython#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#2)]\n     [!code-vb[VbDynamicWalkthroughIronPython#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#2)]\n  \n8.  After the code to load the random.py module, add the following code to create an array of integers. The array is passed to the `shuffle` method of the random.py module, which randomly sorts the values in the array.  \n  \n     [!code-csharp[VbDynamicWalkthroughIronPython#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#3)]\n     [!code-vb[VbDynamicWalkthroughIronPython#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#3)]\n  \n9. Save the file and press CTRL+F5 to build and run the application.  \n  \n## See also\n\n- <xref:System.Dynamic?displayProperty=nameWithType>\n- <xref:System.Dynamic.DynamicObject?displayProperty=nameWithType>\n- [Using Type dynamic](../../../csharp/programming-guide/types/using-type-dynamic.md)\n- [Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md)\n- [dynamic](../../../csharp/language-reference/keywords/dynamic.md)\n- [Implementing Dynamic Interfaces (downloadable PDF from Microsoft TechNet)](https://download.microsoft.com/download/5/4/B/54B83DFE-D7AA-4155-9687-B0CF58FF65D7/implementing-dynamic-interfaces.pdf)\n","nodes":[{"pos":[4,293],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)\"\nms.date: 07/20/2015\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"dynamic objects [Visual Basic]\"\n  - \"dynamic objects\"\n  - \"dynamic objects [C#]\"\nms.assetid: 568f1645-1305-4906-8625-5d77af81e04f","nodes":[{"content":"Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)","nodes":[{"pos":[0,69],"content":"Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)","nodes":[{"content":"Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)","pos":[0,69]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[300,369],"content":"Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)","linkify":"Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)","nodes":[{"content":"Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)","pos":[0,69]}]},{"content":"Dynamic objects expose members such as properties and methods at run time, instead of at compile time.","pos":[371,473]},{"content":"This enables you to create objects to work with structures that do not match a static type or format.","pos":[474,575]},{"content":"For example, you can use a dynamic object to reference the HTML Document Object Model (DOM), which can contain any combination of valid HTML markup elements and attributes.","pos":[576,748]},{"content":"Because each HTML document is unique, the members for a particular HTML document are determined at run time.","pos":[749,857]},{"content":"A common method to reference an attribute of an HTML element is to pass the name of the attribute to the <ph id=\"ph1\">`GetProperty`</ph> method of the element.","pos":[858,999],"source":" A common method to reference an attribute of an HTML element is to pass the name of the attribute to the `GetProperty` method of the element."},{"content":"To reference the <ph id=\"ph1\">`id`</ph> attribute of the HTML element <ph id=\"ph2\">`&lt;div id=\"Div1\"&gt;`</ph>, you first obtain a reference to the <ph id=\"ph3\">`&lt;div&gt;`</ph> element, and then use <ph id=\"ph4\">`divElement.GetProperty(\"id\")`</ph>.","pos":[1000,1168],"source":" To reference the `id` attribute of the HTML element `<div id=\"Div1\">`, you first obtain a reference to the `<div>` element, and then use `divElement.GetProperty(\"id\")`."},{"content":"If you use a dynamic object, you can reference the <ph id=\"ph1\">`id`</ph> attribute as <ph id=\"ph2\">`divElement.id`</ph>.","pos":[1169,1254],"source":" If you use a dynamic object, you can reference the `id` attribute as `divElement.id`."},{"content":"Dynamic objects also provide convenient access to dynamic languages such as IronPython and IronRuby.","pos":[1261,1361]},{"content":"You can use a dynamic object to refer to a dynamic script that is interpreted at run time.","pos":[1362,1452]},{"content":"You reference a dynamic object by using late binding.","pos":[1459,1512]},{"content":"In C#, you specify the type of a late-bound object as <ph id=\"ph1\">`dynamic`</ph>.","pos":[1513,1577],"source":" In C#, you specify the type of a late-bound object as `dynamic`."},{"content":"In Visual Basic, you specify the type of a late-bound object as <ph id=\"ph1\">`Object`</ph>.","pos":[1578,1651],"source":" In Visual Basic, you specify the type of a late-bound object as `Object`."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>dynamic<ept id=\"p1\">](../../../csharp/language-reference/keywords/dynamic.md)</ept> and <bpt id=\"p2\">[</bpt>Early and Late Binding<ept id=\"p2\">](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md)</ept>.","pos":[1652,1860],"source":" For more information, see [dynamic](../../../csharp/language-reference/keywords/dynamic.md) and [Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md)."},{"content":"You can create custom dynamic objects by using the classes in the <ph id=\"ph1\">&lt;xref:System.Dynamic?displayProperty=nameWithType&gt;</ph> namespace.","pos":[1867,1994],"source":"You can create custom dynamic objects by using the classes in the <xref:System.Dynamic?displayProperty=nameWithType> namespace."},{"content":"For example, you can create an <ph id=\"ph1\">&lt;xref:System.Dynamic.ExpandoObject&gt;</ph> and specify the members of that object at run time.","pos":[1995,2113],"source":" For example, you can create an <xref:System.Dynamic.ExpandoObject> and specify the members of that object at run time."},{"content":"You can also create your own type that inherits the <ph id=\"ph1\">&lt;xref:System.Dynamic.DynamicObject&gt;</ph> class.","pos":[2114,2208],"source":" You can also create your own type that inherits the <xref:System.Dynamic.DynamicObject> class."},{"content":"You can then override the members of the <ph id=\"ph1\">&lt;xref:System.Dynamic.DynamicObject&gt;</ph> class to provide run-time dynamic functionality.","pos":[2209,2334],"source":" You can then override the members of the <xref:System.Dynamic.DynamicObject> class to provide run-time dynamic functionality."},{"content":"In this walkthrough you will perform the following tasks:","pos":[2341,2398]},{"content":"Create a custom object that dynamically exposes the contents of a text file as properties of an object.","pos":[2408,2511]},{"pos":[2521,2572],"content":"Create a project that uses an <ph id=\"ph1\">`IronPython`</ph> library.","source":"Create a project that uses an `IronPython` library."},{"pos":[2581,2594],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need <bpt id=\"p1\">[</bpt>IronPython<ept id=\"p1\">](https://ironpython.net/)</ept> for .NET to complete this walkthrough.","pos":[2598,2683],"source":"You need [IronPython](https://ironpython.net/) for .NET to complete this walkthrough."},{"content":"Go to their <bpt id=\"p1\">[</bpt>Download page<ept id=\"p1\">](https://ironpython.net/download/)</ept> to obtain the latest version.","pos":[2684,2775],"source":" Go to their [Download page](https://ironpython.net/download/) to obtain the latest version."},{"pos":[2861,2893],"content":"Creating a Custom Dynamic Object","linkify":"Creating a Custom Dynamic Object","nodes":[{"content":"Creating a Custom Dynamic Object","pos":[0,32]}]},{"content":"The first project that you create in this walkthrough defines a custom dynamic object that searches the contents of a text file.","pos":[2895,3023]},{"content":"Text to search for is specified by the name of a dynamic property.","pos":[3024,3090]},{"content":"For example, if calling code specifies <ph id=\"ph1\">`dynamicFile.Sample`</ph>, the dynamic class returns a generic list of strings that contains all of the lines from the file that begin with \"Sample\".","pos":[3091,3274],"source":" For example, if calling code specifies `dynamicFile.Sample`, the dynamic class returns a generic list of strings that contains all of the lines from the file that begin with \"Sample\"."},{"content":"The search is case-insensitive.","pos":[3275,3306]},{"content":"The dynamic class also supports two optional arguments.","pos":[3307,3362]},{"content":"The first argument is a search option enum value that specifies that the dynamic class should search for matches at the start of the line, the end of the line, or anywhere in the line.","pos":[3363,3547]},{"content":"The second argument specifies that the dynamic class should trim leading and trailing spaces from each line before searching.","pos":[3548,3673]},{"content":"For example, if calling code specifies <ph id=\"ph1\">`dynamicFile.Sample(StringSearchOption.Contains)`</ph>, the dynamic class searches for \"Sample\" anywhere in a line.","pos":[3674,3823],"source":" For example, if calling code specifies `dynamicFile.Sample(StringSearchOption.Contains)`, the dynamic class searches for \"Sample\" anywhere in a line."},{"content":"If calling code specifies <ph id=\"ph1\">`dynamicFile.Sample(StringSearchOption.StartsWith, false)`</ph>, the dynamic class searches for \"Sample\" at the start of each line, and does not remove leading and trailing spaces.","pos":[3824,4025],"source":" If calling code specifies `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, the dynamic class searches for \"Sample\" at the start of each line, and does not remove leading and trailing spaces."},{"content":"The default behavior of the dynamic class is to search for a match at the start of each line and to remove leading and trailing spaces.","pos":[4026,4161]},{"pos":[4171,4203],"content":"To create a custom dynamic class","linkify":"To create a custom dynamic class","nodes":[{"content":"To create a custom dynamic class","pos":[0,32]}]},{"content":"Start Visual Studio.","pos":[4213,4233]},{"pos":[4243,4309],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"On the **File** menu, point to **New** and then click **Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box, in the <bpt id=\"p2\">**</bpt>Project Types<ept id=\"p2\">**</ept> pane, make sure that <bpt id=\"p3\">**</bpt>Windows<ept id=\"p3\">**</ept> is selected.","pos":[4319,4424],"source":"In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected."},{"content":"Select <bpt id=\"p1\">**</bpt>Console Application<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Templates<ept id=\"p2\">**</ept> pane.","pos":[4425,4482],"source":" Select **Console Application** in the **Templates** pane."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`DynamicSample`</ph>, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[4483,4548],"source":" In the **Name** box, type `DynamicSample`, and then click **OK**."},{"content":"The new project is created.","pos":[4549,4576]},{"content":"Right-click the DynamicSample project and point to <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Class<ept id=\"p2\">**</ept>.","pos":[4586,4671],"source":"Right-click the DynamicSample project and point to **Add**, and then click **Class**."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`ReadOnlyFile`</ph>, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[4672,4736],"source":" In the **Name** box, type `ReadOnlyFile`, and then click **OK**."},{"content":"A new file is added that contains the ReadOnlyFile class.","pos":[4737,4794]},{"pos":[4804,5012],"content":"At the top of the ReadOnlyFile.cs or ReadOnlyFile.vb file, add the following code to import the <ph id=\"ph1\">&lt;xref:System.IO?displayProperty=nameWithType&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Dynamic?displayProperty=nameWithType&gt;</ph> namespaces.","source":"At the top of the ReadOnlyFile.cs or ReadOnlyFile.vb file, add the following code to import the <xref:System.IO?displayProperty=nameWithType> and <xref:System.Dynamic?displayProperty=nameWithType> namespaces."},{"pos":[5020,5282],"content":"[!code-csharp[VbDynamicWalkthrough#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#1)]\n[!code-vb[VbDynamicWalkthrough#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#1)]","leadings":["","    "],"nodes":[]},{"content":"The custom dynamic object uses an enum to determine the search criteria.","pos":[5290,5362]},{"content":"Before the class statement, add the following enum definition.","pos":[5363,5425]},{"pos":[5435,5697],"content":"[!code-csharp[VbDynamicWalkthrough#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#2)]\n[!code-vb[VbDynamicWalkthrough#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#2)]","leadings":["","    "],"nodes":[]},{"pos":[5705,5809],"content":"Update the class statement to inherit the <ph id=\"ph1\">`DynamicObject`</ph> class, as shown in the following code example.","source":"Update the class statement to inherit the `DynamicObject` class, as shown in the following code example."},{"pos":[5819,6081],"content":"[!code-csharp[VbDynamicWalkthrough#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#3)]\n[!code-vb[VbDynamicWalkthrough#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#3)]","leadings":["","    "],"nodes":[]},{"pos":[6087,6229],"content":"Add the following code to the <ph id=\"ph1\">`ReadOnlyFile`</ph> class to define a private field for the file path and a constructor for the <ph id=\"ph2\">`ReadOnlyFile`</ph> class.","source":"Add the following code to the `ReadOnlyFile` class to define a private field for the file path and a constructor for the `ReadOnlyFile` class."},{"pos":[6239,6501],"content":"[!code-csharp[VbDynamicWalkthrough#4](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#4)]\n[!code-vb[VbDynamicWalkthrough#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#4)]","leadings":["","    "],"nodes":[]},{"content":"Add the following <ph id=\"ph1\">`GetPropertyValue`</ph> method to the <ph id=\"ph2\">`ReadOnlyFile`</ph> class.","pos":[6508,6580],"source":"Add the following `GetPropertyValue` method to the `ReadOnlyFile` class."},{"content":"The <ph id=\"ph1\">`GetPropertyValue`</ph> method takes, as input, search criteria and returns the lines from a text file that match that search criteria.","pos":[6581,6715],"source":" The `GetPropertyValue` method takes, as input, search criteria and returns the lines from a text file that match that search criteria."},{"content":"The dynamic methods provided by the <ph id=\"ph1\">`ReadOnlyFile`</ph> class call the <ph id=\"ph2\">`GetPropertyValue`</ph> method to retrieve their respective results.","pos":[6716,6845],"source":" The dynamic methods provided by the `ReadOnlyFile` class call the `GetPropertyValue` method to retrieve their respective results."},{"pos":[6855,7117],"content":"[!code-csharp[VbDynamicWalkthrough#5](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#5)]\n [!code-vb[VbDynamicWalkthrough#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#5)]","leadings":["","   "],"nodes":[]},{"content":"After the <ph id=\"ph1\">`GetPropertyValue`</ph> method, add the following code to override the <ph id=\"ph2\">&lt;xref:System.Dynamic.DynamicObject.TryGetMember%2A&gt;</ph> method of the <ph id=\"ph3\">&lt;xref:System.Dynamic.DynamicObject&gt;</ph> class.","pos":[7127,7311],"source":"After the `GetPropertyValue` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method of the <xref:System.Dynamic.DynamicObject> class."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Dynamic.DynamicObject.TryGetMember%2A&gt;</ph> method is called when a member of a dynamic class is requested and no arguments are specified.","pos":[7312,7462],"source":" The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method is called when a member of a dynamic class is requested and no arguments are specified."},{"content":"The <ph id=\"ph1\">`binder`</ph> argument contains information about the referenced member, and the <ph id=\"ph2\">`result`</ph> argument references the result returned for the specified member.","pos":[7463,7617],"source":" The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Dynamic.DynamicObject.TryGetMember%2A&gt;</ph> method returns a Boolean value that returns <ph id=\"ph2\">`true`</ph> if the requested member exists; otherwise it returns <ph id=\"ph3\">`false`</ph>.","pos":[7618,7786],"source":" The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`."},{"pos":[7796,8058],"content":"[!code-csharp[VbDynamicWalkthrough#6](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#6)]\n[!code-vb[VbDynamicWalkthrough#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#6)]","leadings":["","    "],"nodes":[]},{"content":"After the <ph id=\"ph1\">`TryGetMember`</ph> method, add the following code to override the <ph id=\"ph2\">&lt;xref:System.Dynamic.DynamicObject.TryInvokeMember%2A&gt;</ph> method of the <ph id=\"ph3\">&lt;xref:System.Dynamic.DynamicObject&gt;</ph> class.","pos":[8066,8249],"source":"After the `TryGetMember` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method of the <xref:System.Dynamic.DynamicObject> class."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Dynamic.DynamicObject.TryInvokeMember%2A&gt;</ph> method is called when a member of a dynamic class is requested with arguments.","pos":[8250,8387],"source":" The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method is called when a member of a dynamic class is requested with arguments."},{"content":"The <ph id=\"ph1\">`binder`</ph> argument contains information about the referenced member, and the <ph id=\"ph2\">`result`</ph> argument references the result returned for the specified member.","pos":[8388,8542],"source":" The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member."},{"content":"The <ph id=\"ph1\">`args`</ph> argument contains an array of the arguments that are passed to the member.","pos":[8543,8628],"source":" The `args` argument contains an array of the arguments that are passed to the member."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Dynamic.DynamicObject.TryInvokeMember%2A&gt;</ph> method returns a Boolean value that returns <ph id=\"ph2\">`true`</ph> if the requested member exists; otherwise it returns <ph id=\"ph3\">`false`</ph>.","pos":[8629,8800],"source":" The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`."},{"content":"The custom version of the <ph id=\"ph1\">`TryInvokeMember`</ph> method expects the first argument to be a value from the <ph id=\"ph2\">`StringSearchOption`</ph> enum that you defined in a previous step.","pos":[8810,8973],"source":"The custom version of the `TryInvokeMember` method expects the first argument to be a value from the `StringSearchOption` enum that you defined in a previous step."},{"content":"The <ph id=\"ph1\">`TryInvokeMember`</ph> method expects the second argument to be a Boolean value.","pos":[8974,9053],"source":" The `TryInvokeMember` method expects the second argument to be a Boolean value."},{"content":"If one or both arguments are valid values, they are passed to the <ph id=\"ph1\">`GetPropertyValue`</ph> method to retrieve the results.","pos":[9054,9170],"source":" If one or both arguments are valid values, they are passed to the `GetPropertyValue` method to retrieve the results."},{"pos":[9180,9442],"content":"[!code-csharp[VbDynamicWalkthrough#7](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#7)]\n[!code-vb[VbDynamicWalkthrough#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#7)]","leadings":["","    "],"nodes":[]},{"content":"Save and close the file.","pos":[9450,9474]},{"pos":[9485,9513],"content":"To create a sample text file","linkify":"To create a sample text file","nodes":[{"content":"To create a sample text file","pos":[0,28]}]},{"content":"Right-click the DynamicSample project and point to <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>New Item<ept id=\"p2\">**</ept>.","pos":[9523,9611],"source":"Right-click the DynamicSample project and point to **Add**, and then click **New Item**."},{"content":"In the <bpt id=\"p1\">**</bpt>Installed Templates<ept id=\"p1\">**</ept> pane, select <bpt id=\"p2\">**</bpt>General<ept id=\"p2\">**</ept>, and then select the <bpt id=\"p3\">**</bpt>Text File<ept id=\"p3\">**</ept> template.","pos":[9612,9712],"source":" In the **Installed Templates** pane, select **General**, and then select the **Text File** template."},{"content":"Leave the default name of TextFile1.txt in the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, and then click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>.","pos":[9713,9797],"source":" Leave the default name of TextFile1.txt in the **Name** box, and then click **Add**."},{"content":"A new text file is added to the project.","pos":[9798,9838]},{"content":"Copy the following text to the TextFile1.txt file.","pos":[9848,9898]},{"content":"Save and close the file.","pos":[10435,10459]},{"pos":[10470,10536],"content":"To create a sample application that uses the custom dynamic object","linkify":"To create a sample application that uses the custom dynamic object","nodes":[{"content":"To create a sample application that uses the custom dynamic object","pos":[0,66]}]},{"pos":[10546,10685],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, double-click the Module1.vb file if you are using Visual Basic or the Program.cs file if you are using Visual C#.","source":"In **Solution Explorer**, double-click the Module1.vb file if you are using Visual Basic or the Program.cs file if you are using Visual C#."},{"content":"Add the following code to the Main procedure to create an instance of the <ph id=\"ph1\">`ReadOnlyFile`</ph> class for the TextFile1.txt file.","pos":[10695,10817],"source":"Add the following code to the Main procedure to create an instance of the `ReadOnlyFile` class for the TextFile1.txt file."},{"content":"The code uses late binding to call dynamic members and retrieve lines of text that contain the string \"Customer\".","pos":[10818,10931]},{"pos":[10942,11195],"content":"[!code-csharp[VbDynamicWalkthrough#8](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/program.cs#8)]\n [!code-vb[VbDynamicWalkthrough#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/module1.vb#8)]","leadings":["","    "],"nodes":[]},{"content":"Save the file and press CTRL+F5 to build and run the application.","pos":[11203,11268]},{"pos":[11277,11311],"content":"Calling a Dynamic Language Library","linkify":"Calling a Dynamic Language Library","nodes":[{"content":"Calling a Dynamic Language Library","pos":[0,34]}]},{"content":"The next project that you create in this walkthrough accesses a library that is written in the dynamic language IronPython.","pos":[11315,11438]},{"pos":[11446,11478],"content":"To create a custom dynamic class","linkify":"To create a custom dynamic class","nodes":[{"content":"To create a custom dynamic class","pos":[0,32]}]},{"pos":[11486,11570],"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"In Visual Studio, on the **File** menu, point to **New** and then click **Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box, in the <bpt id=\"p2\">**</bpt>Project Types<ept id=\"p2\">**</ept> pane, make sure that <bpt id=\"p3\">**</bpt>Windows<ept id=\"p3\">**</ept> is selected.","pos":[11580,11685],"source":"In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected."},{"content":"Select <bpt id=\"p1\">**</bpt>Console Application<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Templates<ept id=\"p2\">**</ept> pane.","pos":[11686,11743],"source":" Select **Console Application** in the **Templates** pane."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`DynamicIronPythonSample`</ph>, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[11744,11819],"source":" In the **Name** box, type `DynamicIronPythonSample`, and then click **OK**."},{"content":"The new project is created.","pos":[11820,11847]},{"content":"If you are using Visual Basic, right-click the DynamicIronPythonSample project and then click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","pos":[11857,11966],"source":"If you are using Visual Basic, right-click the DynamicIronPythonSample project and then click **Properties**."},{"content":"Click the <bpt id=\"p1\">**</bpt>References<ept id=\"p1\">**</ept> tab. Click the <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept> button.","pos":[11967,12022],"source":" Click the **References** tab. Click the **Add** button."},{"content":"If you are using Visual C#, in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the <bpt id=\"p2\">**</bpt>References<ept id=\"p2\">**</ept> folder and then click <bpt id=\"p3\">**</bpt>Add Reference<ept id=\"p3\">**</ept>.","pos":[12023,12148],"source":" If you are using Visual C#, in **Solution Explorer**, right-click the **References** folder and then click **Add Reference**."},{"content":"On the <bpt id=\"p1\">**</bpt>Browse<ept id=\"p1\">**</ept> tab, browse to the folder where the IronPython libraries are installed.","pos":[12158,12247],"source":"On the **Browse** tab, browse to the folder where the IronPython libraries are installed."},{"content":"For example, C:\\Program Files\\IronPython 2.6 for .NET 4.0.","pos":[12248,12306]},{"content":"Select the <bpt id=\"p1\">**</bpt>IronPython.dll<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>IronPython.Modules.dll<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Microsoft.Scripting.dll<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>Microsoft.Dynamic.dll<ept id=\"p4\">**</ept> libraries.","pos":[12307,12435],"source":" Select the **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**, and **Microsoft.Dynamic.dll** libraries."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[12436,12449],"source":" Click **OK**."},{"content":"If you are using Visual Basic, edit the Module1.vb file.","pos":[12459,12515]},{"content":"If you are using Visual C#, edit the Program.cs file.","pos":[12516,12569]},{"pos":[12579,12736],"content":"At the top of the file, add the following code to import the <ph id=\"ph1\">`Microsoft.Scripting.Hosting`</ph> and <ph id=\"ph2\">`IronPython.Hosting`</ph> namespaces from the IronPython libraries.","source":"At the top of the file, add the following code to import the `Microsoft.Scripting.Hosting` and `IronPython.Hosting` namespaces from the IronPython libraries."},{"pos":[12746,13038],"content":"[!code-csharp[VbDynamicWalkthroughIronPython#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#1)]\n[!code-vb[VbDynamicWalkthroughIronPython#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#1)]","leadings":["","    "],"nodes":[]},{"content":"In the Main method, add the following code to create a new <ph id=\"ph1\">`Microsoft.Scripting.Hosting.ScriptRuntime`</ph> object to host the IronPython libraries.","pos":[13046,13189],"source":"In the Main method, add the following code to create a new `Microsoft.Scripting.Hosting.ScriptRuntime` object to host the IronPython libraries."},{"content":"The <ph id=\"ph1\">`ScriptRuntime`</ph> object loads the IronPython library module random.py.","pos":[13190,13263],"source":" The `ScriptRuntime` object loads the IronPython library module random.py."},{"pos":[13274,13567],"content":"[!code-csharp[VbDynamicWalkthroughIronPython#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#2)]\n [!code-vb[VbDynamicWalkthroughIronPython#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#2)]","leadings":["","    "],"nodes":[]},{"content":"After the code to load the random.py module, add the following code to create an array of integers.","pos":[13575,13674]},{"content":"The array is passed to the <ph id=\"ph1\">`shuffle`</ph> method of the random.py module, which randomly sorts the values in the array.","pos":[13675,13789],"source":" The array is passed to the `shuffle` method of the random.py module, which randomly sorts the values in the array."},{"pos":[13800,14093],"content":"[!code-csharp[VbDynamicWalkthroughIronPython#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#3)]\n [!code-vb[VbDynamicWalkthroughIronPython#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#3)]","leadings":["","    "],"nodes":[]},{"content":"Save the file and press CTRL+F5 to build and run the application.","pos":[14100,14165]},{"pos":[14174,14182],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[14306,14389],"content":"<bpt id=\"p1\">[</bpt>Using Type dynamic<ept id=\"p1\">](../../../csharp/programming-guide/types/using-type-dynamic.md)</ept>","source":"[Using Type dynamic](../../../csharp/programming-guide/types/using-type-dynamic.md)"},{"pos":[14392,14503],"content":"<bpt id=\"p1\">[</bpt>Early and Late Binding<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md)</ept>","source":"[Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md)"},{"pos":[14506,14571],"content":"<bpt id=\"p1\">[</bpt>dynamic<ept id=\"p1\">](../../../csharp/language-reference/keywords/dynamic.md)</ept>","source":"[dynamic](../../../csharp/language-reference/keywords/dynamic.md)"},{"pos":[14574,14769],"content":"<bpt id=\"p1\">[</bpt>Implementing Dynamic Interfaces (downloadable PDF from Microsoft TechNet)<ept id=\"p1\">](https://download.microsoft.com/download/5/4/B/54B83DFE-D7AA-4155-9687-B0CF58FF65D7/implementing-dynamic-interfaces.pdf)</ept>","source":"[Implementing Dynamic Interfaces (downloadable PDF from Microsoft TechNet)](https://download.microsoft.com/download/5/4/B/54B83DFE-D7AA-4155-9687-B0CF58FF65D7/implementing-dynamic-interfaces.pdf)"}]}