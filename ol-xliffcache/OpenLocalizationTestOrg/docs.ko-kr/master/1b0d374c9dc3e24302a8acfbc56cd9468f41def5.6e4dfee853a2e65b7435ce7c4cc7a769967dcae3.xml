{"content":"---\ntitle: \"UI Automation Control Patterns for Clients\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"UI Automation, control patterns for clients\"\n  - \"control patterns, UI Automation clients\"\nms.assetid: 571561d8-5f49-43a9-a054-87735194e013\n---\n# UI Automation Control Patterns for Clients\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This overview introduces control patterns for UI Automation clients. It includes information on how a UI Automation client can use control patterns to access information about the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)].  \n  \n Control patterns provide a way to categorize and expose a control's functionality independent of the control type or the appearance of the control. UI Automation clients can examine an <xref:System.Windows.Automation.AutomationElement> to determine which control patterns are supported and be assured of the behavior of the control.  \n  \n For a complete list of control patterns, see [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md).  \n  \n<a name=\"uiautomation_getting_control_patterns\"></a>   \n## Getting Control Patterns  \n Clients retrieve a control pattern from an <xref:System.Windows.Automation.AutomationElement> by calling either <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A?displayProperty=nameWithType> or <xref:System.Windows.Automation.AutomationElement.GetCurrentPattern%2A?displayProperty=nameWithType>.  \n  \n Clients can use the <xref:System.Windows.Automation.AutomationElement.GetSupportedPatterns%2A> method or an individual `IsPatternAvailable` property (for example, <xref:System.Windows.Automation.AutomationElement.IsTextPatternAvailableProperty>) to determine if a pattern or group of patterns is supported on the <xref:System.Windows.Automation.AutomationElement>. However, it is more efficient to attempt to get the control pattern and test for a `null` reference than to check the supported properties and retrieve the control pattern since it results in fewer cross-process calls.  \n  \n The following example demonstrates how to get a <xref:System.Windows.Automation.TextPattern> control pattern from an <xref:System.Windows.Automation.AutomationElement>.  \n  \n [!code-csharp[UIATextPattern_snip#1037](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIATextPattern_snip/CSharp/SearchWindow.cs#1037)]  \n  \n<a name=\"uiautomation_properties_on_control_patterns\"></a>   \n## Retrieving Properties on Control Patterns  \n Clients can retrieve the property values on control patterns by calling either <xref:System.Windows.Automation.AutomationElement.GetCachedPropertyValue%2A?displayProperty=nameWithType> or <xref:System.Windows.Automation.AutomationElement.GetCurrentPropertyValue%2A?displayProperty=nameWithType> and casting the object returned to an appropriate type. For more information on [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties, see [UI Automation Properties for Clients](../../../docs/framework/ui-automation/ui-automation-properties-for-clients.md).  \n  \n In addition to the `GetPropertyValue` methods, property values can be retrieved through the [!INCLUDE[TLA#tla_clr](../../../includes/tlasharptla-clr-md.md)] accessors to access the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties on a pattern.  \n  \n<a name=\"uiautomation_with_variable_patterns\"></a>   \n## Controls with Variable Patterns  \n Some control types support different patterns depending on their state or the manner in which the control is being used. Examples of controls that can have variable patterns are list views (thumbnails, tiles, icons, list, details), [!INCLUDE[TLA#tla_xl](../../../includes/tlasharptla-xl-md.md)] Charts (Pie, Line, Bar, Cell Value with a formula), [!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)]'s document area (Normal, Web Layout, Outline, Print Layout, Print Preview), and [!INCLUDE[TLA#tla_wmp](../../../includes/tlasharptla-wmp-md.md)] skins.  \n  \n Controls implementing custom control types can have any set of control patterns that are needed to represent their functionality.  \n  \n## See also\n\n- [UI Automation Control Patterns](../../../docs/framework/ui-automation/ui-automation-control-patterns.md)\n- [UI Automation Text Pattern](../../../docs/framework/ui-automation/ui-automation-text-pattern.md)\n- [Invoke a Control Using UI Automation](../../../docs/framework/ui-automation/invoke-a-control-using-ui-automation.md)\n- [Get the Toggle State of a Check Box Using UI Automation](../../../docs/framework/ui-automation/get-the-toggle-state-of-a-check-box-using-ui-automation.md)\n- [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)\n- [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText)\n- [TextPattern Search and Selection Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/FindText)\n- [InvokePattern, ExpandCollapsePattern, and TogglePattern Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InvokePattern)\n","nodes":[{"pos":[4,244],"embed":true,"restype":"x-metadata","content":"title: \"UI Automation Control Patterns for Clients\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"UI Automation, control patterns for clients\"\n  - \"control patterns, UI Automation clients\"\nms.assetid: 571561d8-5f49-43a9-a054-87735194e013","nodes":[{"content":"UI Automation Control Patterns for Clients","nodes":[{"pos":[0,42],"content":"UI Automation Control Patterns for Clients","nodes":[{"content":"UI Automation Control Patterns for Clients","pos":[0,42]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[251,293],"content":"UI Automation Control Patterns for Clients","linkify":"UI Automation Control Patterns for Clients","nodes":[{"content":"UI Automation Control Patterns for Clients","pos":[0,42]}]},{"pos":[296,759],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,461],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"content":"This overview introduces control patterns for UI Automation clients.","pos":[766,834]},{"content":"It includes information on how a UI Automation client can use control patterns to access information about the <ph id=\"ph1\">[!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)]</ph>.","pos":[835,1009],"source":" It includes information on how a UI Automation client can use control patterns to access information about the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)]."},{"content":"Control patterns provide a way to categorize and expose a control's functionality independent of the control type or the appearance of the control.","pos":[1016,1163]},{"content":"UI Automation clients can examine an <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> to determine which control patterns are supported and be assured of the behavior of the control.","pos":[1164,1348],"source":" UI Automation clients can examine an <xref:System.Windows.Automation.AutomationElement> to determine which control patterns are supported and be assured of the behavior of the control."},{"pos":[1355,1524],"content":"For a complete list of control patterns, see <bpt id=\"p1\">[</bpt>UI Automation Control Patterns Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)</ept>.","source":"For a complete list of control patterns, see [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)."},{"pos":[1589,1613],"content":"Getting Control Patterns","linkify":"Getting Control Patterns","nodes":[{"content":"Getting Control Patterns","pos":[0,24]}]},{"pos":[1617,1933],"content":"Clients retrieve a control pattern from an <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> by calling either <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A?displayProperty=nameWithType&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Windows.Automation.AutomationElement.GetCurrentPattern%2A?displayProperty=nameWithType&gt;</ph>.","source":"Clients retrieve a control pattern from an <xref:System.Windows.Automation.AutomationElement> by calling either <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A?displayProperty=nameWithType> or <xref:System.Windows.Automation.AutomationElement.GetCurrentPattern%2A?displayProperty=nameWithType>."},{"content":"Clients can use the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.GetSupportedPatterns%2A&gt;</ph> method or an individual <ph id=\"ph2\">`IsPatternAvailable`</ph> property (for example, <ph id=\"ph3\">&lt;xref:System.Windows.Automation.AutomationElement.IsTextPatternAvailableProperty&gt;</ph>) to determine if a pattern or group of patterns is supported on the <ph id=\"ph4\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph>.","pos":[1940,2304],"source":"Clients can use the <xref:System.Windows.Automation.AutomationElement.GetSupportedPatterns%2A> method or an individual `IsPatternAvailable` property (for example, <xref:System.Windows.Automation.AutomationElement.IsTextPatternAvailableProperty>) to determine if a pattern or group of patterns is supported on the <xref:System.Windows.Automation.AutomationElement>."},{"content":"However, it is more efficient to attempt to get the control pattern and test for a <ph id=\"ph1\">`null`</ph> reference than to check the supported properties and retrieve the control pattern since it results in fewer cross-process calls.","pos":[2305,2523],"source":" However, it is more efficient to attempt to get the control pattern and test for a `null` reference than to check the supported properties and retrieve the control pattern since it results in fewer cross-process calls."},{"pos":[2530,2698],"content":"The following example demonstrates how to get a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> control pattern from an <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph>.","source":"The following example demonstrates how to get a <xref:System.Windows.Automation.TextPattern> control pattern from an <xref:System.Windows.Automation.AutomationElement>."},{"pos":[2914,2955],"content":"Retrieving Properties on Control Patterns","linkify":"Retrieving Properties on Control Patterns","nodes":[{"content":"Retrieving Properties on Control Patterns","pos":[0,41]}]},{"content":"Clients can retrieve the property values on control patterns by calling either <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.GetCachedPropertyValue%2A?displayProperty=nameWithType&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.GetCurrentPropertyValue%2A?displayProperty=nameWithType&gt;</ph> and casting the object returned to an appropriate type.","pos":[2959,3309],"source":"Clients can retrieve the property values on control patterns by calling either <xref:System.Windows.Automation.AutomationElement.GetCachedPropertyValue%2A?displayProperty=nameWithType> or <xref:System.Windows.Automation.AutomationElement.GetCurrentPropertyValue%2A?displayProperty=nameWithType> and casting the object returned to an appropriate type."},{"content":"For more information on <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> properties, see <bpt id=\"p1\">[</bpt>UI Automation Properties for Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-properties-for-clients.md)</ept>.","pos":[3310,3553],"source":" For more information on [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties, see [UI Automation Properties for Clients](../../../docs/framework/ui-automation/ui-automation-properties-for-clients.md)."},{"pos":[3560,3850],"content":"In addition to the <ph id=\"ph1\">`GetPropertyValue`</ph> methods, property values can be retrieved through the <ph id=\"ph2\">[!INCLUDE[TLA#tla_clr](../../../includes/tlasharptla-clr-md.md)]</ph> accessors to access the <ph id=\"ph3\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> properties on a pattern.","source":"In addition to the `GetPropertyValue` methods, property values can be retrieved through the [!INCLUDE[TLA#tla_clr](../../../includes/tlasharptla-clr-md.md)] accessors to access the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties on a pattern."},{"pos":[3913,3944],"content":"Controls with Variable Patterns","linkify":"Controls with Variable Patterns","nodes":[{"content":"Controls with Variable Patterns","pos":[0,31]}]},{"content":"Some control types support different patterns depending on their state or the manner in which the control is being used.","pos":[3948,4068]},{"content":"Examples of controls that can have variable patterns are list views (thumbnails, tiles, icons, list, details), <ph id=\"ph1\">[!INCLUDE[TLA#tla_xl](../../../includes/tlasharptla-xl-md.md)]</ph> Charts (Pie, Line, Bar, Cell Value with a formula), <ph id=\"ph2\">[!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)]</ph>'s document area (Normal, Web Layout, Outline, Print Layout, Print Preview), and <ph id=\"ph3\">[!INCLUDE[TLA#tla_wmp](../../../includes/tlasharptla-wmp-md.md)]</ph> skins.","pos":[4069,4513],"source":" Examples of controls that can have variable patterns are list views (thumbnails, tiles, icons, list, details), [!INCLUDE[TLA#tla_xl](../../../includes/tlasharptla-xl-md.md)] Charts (Pie, Line, Bar, Cell Value with a formula), [!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)]'s document area (Normal, Web Layout, Outline, Print Layout, Print Preview), and [!INCLUDE[TLA#tla_wmp](../../../includes/tlasharptla-wmp-md.md)] skins."},{"content":"Controls implementing custom control types can have any set of control patterns that are needed to represent their functionality.","pos":[4520,4649]},{"pos":[4658,4666],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4670,4775],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns.md)</ept>","source":"[UI Automation Control Patterns](../../../docs/framework/ui-automation/ui-automation-control-patterns.md)"},{"pos":[4778,4875],"content":"<bpt id=\"p1\">[</bpt>UI Automation Text Pattern<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-text-pattern.md)</ept>","source":"[UI Automation Text Pattern](../../../docs/framework/ui-automation/ui-automation-text-pattern.md)"},{"pos":[4878,4995],"content":"<bpt id=\"p1\">[</bpt>Invoke a Control Using UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/invoke-a-control-using-ui-automation.md)</ept>","source":"[Invoke a Control Using UI Automation](../../../docs/framework/ui-automation/invoke-a-control-using-ui-automation.md)"},{"pos":[4998,5153],"content":"<bpt id=\"p1\">[</bpt>Get the Toggle State of a Check Box Using UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/get-the-toggle-state-of-a-check-box-using-ui-automation.md)</ept>","source":"[Get the Toggle State of a Check Box Using UI Automation](../../../docs/framework/ui-automation/get-the-toggle-state-of-a-check-box-using-ui-automation.md)"},{"pos":[5156,5299],"content":"<bpt id=\"p1\">[</bpt>Control Pattern Mapping for UI Automation Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)</ept>","source":"[Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)"},{"pos":[5302,5413],"content":"<bpt id=\"p1\">[</bpt>TextPattern Insert Text Sample<ept id=\"p1\">](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText)</ept>","source":"[TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText)"},{"pos":[5416,5534],"content":"<bpt id=\"p1\">[</bpt>TextPattern Search and Selection Sample<ept id=\"p1\">](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/FindText)</ept>","source":"[TextPattern Search and Selection Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/FindText)"},{"pos":[5537,5683],"content":"<bpt id=\"p1\">[</bpt>InvokePattern, ExpandCollapsePattern, and TogglePattern Sample<ept id=\"p1\">](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InvokePattern)</ept>","source":"[InvokePattern, ExpandCollapsePattern, and TogglePattern Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InvokePattern)"}]}