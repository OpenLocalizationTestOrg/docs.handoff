{"content":"---\ntitle: \"-refonly (Visual Basic)\"\nms.date: 03/16/2018\nf1_keywords: \n  - \"-refonly\"\nhelpviewer_keywords: \n  - \"/refonly compiler option [Visual Basic]\"\n  - \"-refonly compiler option [Visual Basic]\"\n  - \"refonly compiler option [Visual Basic]\"\n---\n\n# -refonly (Visual Basic)\n\nThe **-refonly** option indicates that the primary output of the compilation should be a reference assembly instead of an implementation assembly. The `-refonly` parameter silently disables outputting PDBs, as reference assemblies cannot be executed.\n\n[!INCLUDE[compiler-options](~/includes/compiler-options.md)]\n\n## Syntax\n\n```console\n-refonly\n```\n\n## Remarks\n\nVisual Basic supports the `-refout` switch starting with version 15.3.\n\nReference assemblies are metadata-only assemblies that contain metadata but no implementation code. They include type and member information for everything except anonymous types. The reason for using `throw null` bodies (as opposed to no bodies) is so that PEVerify could run and pass (thus validating the completeness of the metadata).\n\nReference assemblies include an assembly-level [ReferenceAssembly](xref:System.Runtime.CompilerServices.ReferenceAssemblyAttribute) attribute. This attribute may be specified in source (then the compiler won't need to synthesize it). Because of this attribute, runtimes will refuse to load reference assemblies for execution (but they can still be loaded in a reflection-only context). Tools that reflect on assemblies need to ensure they load reference assemblies as reflection-only; otherwise, the runtime throws a <xref:System.BadImageFormatException>.\n\nThe `-refonly` and [`-refout`](refout-compiler-option.md) options are mutually exclusive.\n\n## See also\n\n- [-refout](refout-compiler-option.md)\n- [Visual Basic Command-Line Compiler](index.md)\n- [Sample Compilation Command Lines](sample-compilation-command-lines.md)\n","nodes":[{"pos":[4,244],"embed":true,"restype":"x-metadata","content":"title: \"-refonly (Visual Basic)\"\nms.date: 03/16/2018\nf1_keywords: \n  - \"-refonly\"\nhelpviewer_keywords: \n  - \"/refonly compiler option [Visual Basic]\"\n  - \"-refonly compiler option [Visual Basic]\"\n  - \"refonly compiler option [Visual Basic]\"","nodes":[{"content":"-refonly (Visual Basic)","nodes":[{"pos":[0,23],"content":"-refonly (Visual Basic)","nodes":[{"content":"-refonly (Visual Basic)","pos":[0,23]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[252,275],"content":"-refonly (Visual Basic)","linkify":"-refonly (Visual Basic)","nodes":[{"content":"-refonly (Visual Basic)","pos":[0,23]}]},{"content":"The <bpt id=\"p1\">**</bpt>-refonly<ept id=\"p1\">**</ept> option indicates that the primary output of the compilation should be a reference assembly instead of an implementation assembly.","pos":[277,423],"source":"The **-refonly** option indicates that the primary output of the compilation should be a reference assembly instead of an implementation assembly."},{"content":"The <ph id=\"ph1\">`-refonly`</ph> parameter silently disables outputting PDBs, as reference assemblies cannot be executed.","pos":[424,527],"source":" The `-refonly` parameter silently disables outputting PDBs, as reference assemblies cannot be executed."},{"pos":[594,600],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[630,637],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[639,709],"content":"Visual Basic supports the <ph id=\"ph1\">`-refout`</ph> switch starting with version 15.3.","source":"Visual Basic supports the `-refout` switch starting with version 15.3."},{"content":"Reference assemblies are metadata-only assemblies that contain metadata but no implementation code.","pos":[711,810]},{"content":"They include type and member information for everything except anonymous types.","pos":[811,890]},{"content":"The reason for using <ph id=\"ph1\">`throw null`</ph> bodies (as opposed to no bodies) is so that PEVerify could run and pass (thus validating the completeness of the metadata).","pos":[891,1048],"source":" The reason for using `throw null` bodies (as opposed to no bodies) is so that PEVerify could run and pass (thus validating the completeness of the metadata)."},{"content":"Reference assemblies include an assembly-level <bpt id=\"p1\">[</bpt>ReferenceAssembly<ept id=\"p1\">](xref:System.Runtime.CompilerServices.ReferenceAssemblyAttribute)</ept> attribute.","pos":[1050,1192],"source":"Reference assemblies include an assembly-level [ReferenceAssembly](xref:System.Runtime.CompilerServices.ReferenceAssemblyAttribute) attribute."},{"content":"This attribute may be specified in source (then the compiler won't need to synthesize it).","pos":[1193,1283]},{"content":"Because of this attribute, runtimes will refuse to load reference assemblies for execution (but they can still be loaded in a reflection-only context).","pos":[1284,1435]},{"content":"Tools that reflect on assemblies need to ensure they load reference assemblies as reflection-only; otherwise, the runtime throws a <ph id=\"ph1\">&lt;xref:System.BadImageFormatException&gt;</ph>.","pos":[1436,1605],"source":" Tools that reflect on assemblies need to ensure they load reference assemblies as reflection-only; otherwise, the runtime throws a <xref:System.BadImageFormatException>."},{"pos":[1607,1696],"content":"The <ph id=\"ph1\">`-refonly`</ph> and <bpt id=\"p1\">[</bpt><ph id=\"ph2\">`-refout`</ph><ept id=\"p1\">](refout-compiler-option.md)</ept> options are mutually exclusive.","source":"The `-refonly` and [`-refout`](refout-compiler-option.md) options are mutually exclusive."},{"pos":[1701,1709],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1713,1749],"content":"<bpt id=\"p1\">[</bpt>-refout<ept id=\"p1\">](refout-compiler-option.md)</ept>","source":"[-refout](refout-compiler-option.md)"},{"pos":[1752,1798],"content":"<bpt id=\"p1\">[</bpt>Visual Basic Command-Line Compiler<ept id=\"p1\">](index.md)</ept>","source":"[Visual Basic Command-Line Compiler](index.md)"},{"pos":[1801,1872],"content":"<bpt id=\"p1\">[</bpt>Sample Compilation Command Lines<ept id=\"p1\">](sample-compilation-command-lines.md)</ept>","source":"[Sample Compilation Command Lines](sample-compilation-command-lines.md)"}]}