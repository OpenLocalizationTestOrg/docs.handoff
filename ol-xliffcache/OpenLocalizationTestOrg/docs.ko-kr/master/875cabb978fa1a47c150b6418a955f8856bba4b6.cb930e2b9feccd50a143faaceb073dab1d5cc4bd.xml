{"content":"---\ntitle: \"Using the Interop Activity in a .NET Framework 4 Workflow | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 9bb747f0-eb33-4f70-84cd-317382372dcd\ncaps.latest.revision: 20\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Using the Interop Activity in a .NET Framework 4 Workflow\nActivities created using [!INCLUDE[vstecwinfx](../../../includes/vstecwinfx-md.md)] or [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] can be used in a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow by using the <xref:System.Activities.Statements.Interop> activity. This topic provides an overview of using the <xref:System.Activities.Statements.Interop> activity.  \n  \n> [!NOTE]\n>  The <xref:System.Activities.Statements.Interop> activity does not appear in the workflow designer toolbox unless the workflow's project has its **Target Framework** setting set to **.Net Framework 4** or later.  \n  \n## Using the Interop Activity in .NET Framework 4.5 Workflows  \n In this topic, a [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] activity library is created that contains a `DiscountCalculator` activity. The `DiscountCalculator` calculates a discount based on a purchase amount and consists of a <xref:System.Workflow.Activities.SequenceActivity> that contains a <xref:System.Workflow.Activities.PolicyActivity>.  \n  \n> [!NOTE]\n>  The [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] activity created in this topic uses a <xref:System.Workflow.Activities.PolicyActivity> to implement the logic of the activity. It is not required to use a custom [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] activity or the <xref:System.Activities.Statements.Interop> activity in order to use rules in a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow. For an example of using rules in a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow without using the <xref:System.Activities.Statements.Interop> activity, see the [Policy Activity in .NET Framework 4.5](../../../docs/framework/windows-workflow-foundation/samples/policy-activity-in-net-framework-4-5.md) sample.  \n  \n#### To create the .NET Framework 3.5 activity library project  \n  \n1.  Open [!INCLUDE[vs_current_long](../../../includes/vs-current-long-md.md)] and select **New** and then **Project…** from the **File** menu.  \n  \n2.  Expand the **Other Project Types** node in the **Installed Templates** pane and select **Visual Studio Solutions**.  \n  \n3.  Select **Blank Solution** from the **Visual Studio Solutions** list. Type `PolicyInteropDemo` in the **Name** box and click **OK**.  \n  \n4.  Right-click **PolicyInteropDemo** in **Solution Explorer** and select **Add** and then **New Project…**.  \n  \n    > [!TIP]\n    >  If the **Solution Explorer** window is not visible, select **Solution Explorer** from the **View** menu.  \n  \n5.  In the **Installed Templates** list, select **Visual C#** and then **Workflow**. Select **.NET Framework 3.5** from the .NET Framework version drop-down list, and then select **Workflow Activity Library** from the **Templates** list.  \n  \n6.  Type `PolicyActivityLibrary` in the **Name** box and click **OK**.  \n  \n7.  Right-click **Activity1.cs** in **Solution Explorer** and select **Delete**. Click **OK** to confirm.  \n  \n#### To create the DiscountCalculator activity  \n  \n1.  Right-click **PolicyActivityLibrary** in **Solution Explorer** and select **Add** and then **Activity…**.  \n  \n2.  Select **Activity (with code separation)** from the **Visual C# Items** list. Type `DiscountCalculator` in the **Name** box and click **OK**.  \n  \n3.  Right-click **DiscountCalculator.xoml** in **Solution Explorer** and select **View Code**.  \n  \n4.  Add the following three properties to the `DiscountCalculator` class.  \n  \n    ```csharp  \n    public partial class DiscountCalculator : SequenceActivity  \n    {  \n        public double Subtotal { get; set; }  \n        public double DiscountPercent { get; set; }  \n        public double Total { get; set; }  \n    }  \n    ```  \n  \n5.  Right-click **DiscountCalculator.xoml** in **Solution Explorer** and select **View Designer**.  \n  \n6.  Drag a **Policy** activity from the **Windows Workflow v3.0** section of the **Toolbox** and drop it in the **DiscountCalculator** activity.  \n  \n    > [!TIP]\n    >  If the **Toolbox** window is not visible, select **Toolbox** from the **View** menu.  \n  \n#### To configure the rules  \n  \n1.  Click the newly added **Policy** activity to select it, if it is not already selected.  \n  \n2.  Click the **RuleSetReference** property in the **Properties** window to select it, and click the ellipsis button to the right of the property.  \n  \n    > [!TIP]\n    >  If the **Properties** window is not visible, choose **Properties Window** from the **View** menu.  \n  \n3.  Select **Click New…**.  \n  \n4.  Click **Add Rule**.  \n  \n5.  Type the following expression into the **Condition** box.  \n  \n    ```  \n    this.Subtotal >= 50 && this.Subtotal < 100  \n    ```  \n  \n6.  Type the following expression into the **Then Actions** box.  \n  \n    ```  \n    this.DiscountPercent = 0.075  \n    ```  \n  \n7.  Click **Add Rule**.  \n  \n8.  Type the following expression into the **Condition** box.  \n  \n    ```  \n    this.Subtotal >= 100  \n    ```  \n  \n9. Type the following expression into the **Then Actions** box.  \n  \n    ```  \n    this.DiscountPercent = 0.15  \n    ```  \n  \n10. Click **Add Rule**.  \n  \n11. Type the following expression into the **Condition** box.  \n  \n    ```  \n    this.DiscountPercent > 0  \n    ```  \n  \n12. Type the following expression into the **Then Actions** box.  \n  \n    ```  \n    this.Total = this.Subtotal - this.Subtotal * this.DiscountPercent  \n    ```  \n  \n13. Type the following expression into the **Else Actions** box.  \n  \n    ```  \n    this.Total = this.Subtotal  \n    ```  \n  \n14. Click **OK** to close the **Rule Set Editor** dialog box.  \n  \n15. Ensure that the newly-created <xref:System.Workflow.Activities.Rules.RuleSet> is selected in the **Name** list, and click **OK**.  \n  \n16. Press CTRL+SHIFT+B to build the solution.  \n  \n The rules added to the `DiscountCalculator` activity in this procedure are shown in the following code example.  \n  \n```  \nRule1: IF this.Subtotal >= 50 && this.Subtotal < 100   \n       THEN this.DiscountPercent = 0.075   \n  \nRule2: IF this. Subtotal >= 100   \n       THEN this.DiscountPercent = 0.15   \n  \nRule3: IF this.DiscountPercent > 0   \n       THEN this.Total = this.Subtotal - this.Subtotal * this.DiscountPercent   \n       ELSE this.Total = this.Subtotal  \n```  \n  \n When the <xref:System.Workflow.Activities.PolicyActivity> executes, these three rules evaluate and modify the `Subtotal`, `DiscountPercent`, and `Total` property values of the `DiscountCalculator` activity to calculate the desired discount.  \n  \n## Using the DiscountCalculator Activity with the Interop Activity  \n To use the `DiscountCalculator` activity inside a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow, the <xref:System.Activities.Statements.Interop> activity is used. In this section two workflows are created, one using code and one using the workflow designer, which show how to use the <xref:System.Activities.Statements.Interop> activity with the `DiscountCalculator` activity. The same host application is used for both workflows.  \n  \n#### To create the host application  \n  \n1.  Right-click **PolicyInteropDemo** in **Solution Explorer** and select **Add**, and then **New Project…**.  \n  \n2.  Ensure that **.NET Framework 4.5** is selected in the .NET Framework version drop-down list, and select  **Workflow Console Application** from the **Visual C# Items** list.  \n  \n3.  Type `PolicyInteropHost` into the **Name** box and click **OK**.  \n  \n4.  Right-click **PolicyInteropHost** in **Solution Explorer** and select **Properties**.  \n  \n5.  In the **Target framework** drop-down list, change the selection from **.NET Framework 4 Client Profile** to **.NET Framework 4.5**. Click **Yes** to confirm.  \n  \n6.  Right-click **PolicyInteropHost** in **Solution Explorer** and select **Add Reference…**.  \n  \n7.  Select **PolicyActivityLibrary** from the **Projects** tab and click **OK**.  \n  \n8.  Right-click **PolicyInteropHost** in **Solution Explorer** and select **Add Reference…**.  \n  \n9. Select **System.Workflow.Activities**, **System.Workflow.ComponentModel**, and then **System.Workflow.Runtime** from the **.NET** tab and click **OK**.  \n  \n10. Right-click **PolicyInteropHost** in **Solution Explorer** and select **Set as StartUp Project**.  \n  \n11. Press CTRL+SHIFT+B to build the solution.  \n  \n### Using the Interop Activity in Code  \n In this example, a workflow definition is created using code that contains the <xref:System.Activities.Statements.Interop> activity and the `DiscountCalculator` activity. This workflow is invoked using <xref:System.Activities.WorkflowInvoker> and the results of the rule evaluation are written to the console using a <xref:System.Activities.Statements.WriteLine> activity.  \n  \n##### To use the Interop activity in code  \n  \n1.  Right-click **Program.cs** in **Solution Explorer** and select **View Code**.  \n  \n2.  Add the following `using` statement at the top of the file.  \n  \n    ```csharp  \n    using PolicyActivityLibrary;  \n    ```  \n  \n3.  Remove the contents of the `Main` method and replace with the following code.  \n  \n    ```csharp  \n    static void Main(string[] args)  \n    {  \n        CalculateDiscountUsingCodeWorkflow();  \n    }  \n    ```  \n  \n4.  Create a new method in the `Program` class called `CalculateDiscountUsingCodeWorkflow` that contains the following code.  \n  \n    ```csharp  \n    static void CalculateDiscountUsingCodeWorkflow()  \n    {  \n        Variable<double> Subtotal = new Variable<double>  \n        {  \n            Default = 75.99,  \n            Name = \"Subtotal\"  \n        };  \n  \n        Variable<double> DiscountPercent = new Variable<double>  \n        {  \n            Name = \"DiscountPercent\"  \n        };  \n  \n        Variable<double> Total = new Variable<double>  \n        {  \n            Name = \"Total\"  \n        };  \n  \n        Activity wf = new Sequence  \n        {  \n            Variables = { Subtotal, DiscountPercent, Total },  \n            Activities =   \n            {  \n                new Interop  \n                {  \n                    ActivityType = typeof(DiscountCalculator),  \n                    ActivityProperties =   \n                    {  \n                        { \"Subtotal\", new InArgument<double>(Subtotal) },  \n                        { \"DiscountPercentOut\", new OutArgument<double>(DiscountPercent) },  \n                        { \"TotalOut\", new OutArgument<double>(Total) }  \n                    }  \n                },  \n                new WriteLine  \n                {  \n                    Text =  new InArgument<string>(env =>   \n                        string.Format(\"Subtotal: {0:C}, Discount {1}%, Total {2:C}\",   \n                        Subtotal.Get(env), DiscountPercent.Get(env) * 100, Total.Get(env)))  \n                }  \n            }  \n        };  \n  \n        WorkflowInvoker.Invoke(wf);  \n    }  \n    ```  \n  \n    > [!NOTE]\n    >  The `Subtotal`, `DiscountPercent`, and `Total` properties of the `DiscountCalculator` activity are surfaced as arguments of the <xref:System.Activities.Statements.Interop> activity, and bound to local workflow variables in the <xref:System.Activities.Statements.Interop> activity’s <xref:System.Activities.Statements.Interop.ActivityProperties%2A> collection. `Subtotal` is added as an <xref:System.Activities.ArgumentDirection> argument because the `Subtotal` data flows into the <xref:System.Activities.Statements.Interop> activity, and `DiscountPercent` and `Total` are added as <xref:System.Activities.ArgumentDirection> arguments because their data flows out of the <xref:System.Activities.Statements.Interop> activity. Note that the two <xref:System.Activities.ArgumentDirection> arguments are added with the names `DiscountPercentOut` and `TotalOut` to indicate that they represent <xref:System.Activities.ArgumentDirection> arguments. The `DiscountCalculator` type is specified as the <xref:System.Activities.Statements.Interop> activity’s <xref:System.Activities.Statements.Interop.ActivityType%2A>.  \n  \n5.  Press CTRL+F5 to build and run the application. Substitute different values for the `Subtotal` value to test out the different discount levels provided by the `DiscountCalculator` activity.  \n  \n    ```csharp  \n    Variable<double> Subtotal = new Variable<double>  \n    {  \n        Default = 75.99, // Change this value.  \n        Name = \"Subtotal\"  \n    };  \n    ```  \n  \n### Using the Interop Activity in the Workflow Designer  \n In this example, a workflow is created using the workflow designer. This workflow has the same functionality as the previous example, except than instead of using a <xref:System.Activities.Statements.WriteLine> activity to display the discount, the host application retrieves and displays the discount information when the workflow completes. Also, instead of using local workflow variables to contain the data, arguments are created in the workflow designer and the values are passed in from the host when the workflow is invoked.  \n  \n##### To host the PolicyActivity using a Workflow Designer-created workflow  \n  \n1.  Right-click **Workflow1.xaml** in **Solution Explorer** and select **Delete**. Click **OK** to confirm.  \n  \n2.  Right-click **PolicyInteropHost** in **Solution Explorer** and select **Add**, **New Item…**.  \n  \n3.  Expand the **Visual C# Items** node and select **Workflow**. Select **Activity** from the **Visual C# Items** list.  \n  \n4.  Type `DiscountWorkflow` into the **Name** box and click **Add**.  \n  \n5.  Click the **Arguments** button on the lower left side of the workflow designer to display the **Arguments** pane.  \n  \n6.  Click **Create Argument**.  \n  \n7.  Type `Subtotal` into the **Name** box, select **In** from the **Direction** drop-down, select **Double** from the **Argument type** drop-down, and then press ENTER to save the argument.  \n  \n    > [!NOTE]\n    >  If **Double** is not in the **Argument type** drop-down list, select **Browse for Types …**, type `System.Double` in the **Type Name** box, and click **OK**.  \n  \n8.  Click **Create Argument**.  \n  \n9. Type `DiscountPercent` into the **Name** box, select **Out** from the **Direction** drop-down, select **Double** from the **Argument type** drop-down, and then press ENTER to save the argument.  \n  \n10. Click **Create Argument**.  \n  \n11. Type `Total` into the **Name** box, select **Out** from the **Direction** drop-down, select **Double** from the **Argument type** drop-down, and then press ENTER to save the argument.  \n  \n12. Click the **Arguments** button on the lower left side of the workflow designer to close the **Arguments** pane.  \n  \n13. Drag a **Sequence** activity from the **Control Flow** section of the **Toolbox** and drop it onto the workflow designer surface.  \n  \n14. Drag an **Interop** activity from the **Migration** section of the **Toolbox** and drop it in the **Sequence** activity.  \n  \n15. Click the **Interop** activity on the **Click to browse…** label, type **DiscountCalculator** in the **Type Name** box, and click **OK**.  \n  \n    > [!NOTE]\n    >  When the <xref:System.Activities.Statements.Interop> activity is added to the workflow and the `DiscountCalculator` type is specified as its <xref:System.Activities.Statements.Interop.ActivityType%2A>, the <xref:System.Activities.Statements.Interop> activity exposes three <xref:System.Activities.ArgumentDirection> arguments and three <xref:System.Activities.ArgumentDirection> arguments that represent the three public properties of the `DiscountCalculator` activity. The <xref:System.Activities.ArgumentDirection> arguments have the same name as the three public properties, and the three <xref:System.Activities.ArgumentDirection> arguments have the same names with **Out** appended to the property name. In the following steps, the workflow arguments created in the previous steps are bound to the <xref:System.Activities.Statements.Interop> activity’s arguments.  \n  \n16. Type `DiscountPercent` into the **Enter a VB expression** box to the right of the **DiscountPercentOut** property and press TAB.  \n  \n17. Type `Subtotal` into the **Enter a VB expression** box to the right of the **Subtotal** property and press TAB.  \n  \n18. Type `Total` into the **Enter a VB expression** box to the right of the **TotalOut** property and press TAB.  \n  \n19. Right-click **Program.cs** in **Solution Explorer** and select **View Code**.  \n  \n20. Add the following `using` statement at the top of the file.  \n  \n    ```csharp  \n    using System.Collections.Generic;  \n    ```  \n  \n21. Comment out the call to the `CalculateDiscountInCode` method in the `Main` method and add the following code.  \n  \n    > [!NOTE]\n    >  If you did not follow the previous procedure and the default `Main` code is present, replace the contents of `Main` with the following code.  \n  \n    ```csharp  \n    static void Main(string[] args)  \n    {  \n        CalculateDiscountUsingDesignerWorkflow();  \n        //CalculateDiscountUsingCodeWorkflow();  \n    }  \n    ```  \n  \n22. Create a new method in the `Program` class called `CalculateDiscountUsingDesignerWorkflow` that contains the following code.  \n  \n    ```csharp  \n    static void CalculateDiscountUsingDesignerWorkflow()  \n    {  \n        double SubtotalValue = 125.99;  \n        Dictionary<string, object> wfargs = new Dictionary<string, object>  \n        {  \n            {\"Subtotal\", SubtotalValue}  \n        };  \n  \n        Activity wf = new DiscountWorkflow();  \n  \n        IDictionary<string, object> outputs =  \n            WorkflowInvoker.Invoke(wf, wfargs);  \n  \n        Console.WriteLine(\"Subtotal: {0:C}, Discount {1}%, Total {2:C}\",  \n            SubtotalValue, (double)outputs[\"DiscountPercent\"] * 100,  \n            outputs[\"Total\"]);  \n    }  \n    ```  \n  \n23. Press CTRL+F5 to build and run the application. To specify a different `Subtotal` amount, change the value of `SubtotalValue` in the following code.  \n  \n    ```csharp  \n    double SubtotalValue = 125.99; // Change this value.  \n    ```  \n  \n## Rules Features Overview  \n The [!INCLUDE[wf1](../../../includes/wf1-md.md)] rules engine provides support for processing rules in a priority-based manner with support for forward chaining. Rules can be evaluated for a single item or for items in a collection. For an overview of rules and information on specific rules functionality, please refer to the following table.  \n  \n|Rules Feature|Documentation|  \n|-------------------|-------------------|  \n|Rules Overview|[Introduction to the Windows Workflow Foundation Rules Engine](http://go.microsoft.com/fwlink/?LinkID=152836)|  \n|RuleSet|[Using RuleSets in Workflows](http://go.microsoft.com/fwlink/?LinkId=178516) and <xref:System.Workflow.Activities.Rules.RuleSet>|  \n|Evaluation of Rules|[Rules Evaluation in RuleSets](http://go.microsoft.com/fwlink/?LinkId=178517)|  \n|Rules Chaining|[Forward Chaining Control](http://go.microsoft.com/fwlink/?LinkId=178518) and [Forward Chaining of Rules](http://go.microsoft.com/fwlink/?LinkId=178519)|  \n|Processing Collections in Rules|[Processing Collections in Rules](http://go.microsoft.com/fwlink/?LinkId=178520)|  \n|Using the PolicyActivity|[Using the PolicyActivity Activity](http://go.microsoft.com/fwlink/?LinkId=178521) and <xref:System.Workflow.Activities.PolicyActivity>|  \n  \n Workflows created in [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] do not use all of the rules features provided by [!INCLUDE[wf1](../../../includes/wf1-md.md)], such as declarative activity conditions and conditional activities such as the <xref:System.Workflow.Activities.ConditionedActivityGroup> and <xref:System.Workflow.Activities.ReplicatorActivity>. If required, this functionality is available for workflows created using [!INCLUDE[vstecwinfx](../../../includes/vstecwinfx-md.md)] and [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]. [!INCLUDE[crdefault](../../../includes/crdefault-md.md)][Migration Guidance](../../../docs/framework/windows-workflow-foundation/migration-guidance.md).","nodes":[{"pos":[12,86],"content":"Using the Interop Activity in a .NET Framework 4 Workflow | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Using the Interop Activity in a .NET Framework 4 Workflow | Microsoft Docs","pos":[0,74]}]},{"pos":[352,409],"content":"Using the Interop Activity in a .NET Framework 4 Workflow","linkify":"Using the Interop Activity in a .NET Framework 4 Workflow","nodes":[{"content":"Using the Interop Activity in a .NET Framework 4 Workflow","pos":[0,57]}]},{"content":"Activities created using <ph id=\"ph1\">[!INCLUDE[vstecwinfx](../../../includes/vstecwinfx-md.md)]</ph> or <ph id=\"ph2\">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph> can be used in a <ph id=\"ph3\">[!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)]</ph> workflow by using the <ph id=\"ph4\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity.","pos":[410,731],"source":"Activities created using [!INCLUDE[vstecwinfx](../../../includes/vstecwinfx-md.md)] or [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] can be used in a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow by using the <xref:System.Activities.Statements.Interop> activity."},{"content":"This topic provides an overview of using the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity.","pos":[732,830],"source":" This topic provides an overview of using the <xref:System.Activities.Statements.Interop> activity."},{"pos":[838,1059],"content":"[!NOTE]\n The <xref:System.Activities.Statements.Interop> activity does not appear in the workflow designer toolbox unless the workflow's project has its **Target Framework** setting set to **.Net Framework 4** or later.","leadings":["","> "],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity does not appear in the workflow designer toolbox unless the workflow's project has its <bpt id=\"p1\">**</bpt>Target Framework<ept id=\"p1\">**</ept> setting set to <bpt id=\"p2\">**</bpt>.Net Framework 4<ept id=\"p2\">**</ept> or later.","pos":[9,219],"source":" The <xref:System.Activities.Statements.Interop> activity does not appear in the workflow designer toolbox unless the workflow's project has its **Target Framework** setting set to **.Net Framework 4** or later."}]},{"pos":[1068,1126],"content":"Using the Interop Activity in .NET Framework 4.5 Workflows","linkify":"Using the Interop Activity in .NET Framework 4.5 Workflows","nodes":[{"content":"Using the Interop Activity in .NET Framework 4.5 Workflows","pos":[0,58]}]},{"content":"In this topic, a <ph id=\"ph1\">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph> activity library is created that contains a <ph id=\"ph2\">`DiscountCalculator`</ph> activity.","pos":[1130,1286],"source":"In this topic, a [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] activity library is created that contains a `DiscountCalculator` activity."},{"content":"The <ph id=\"ph1\">`DiscountCalculator`</ph> calculates a discount based on a purchase amount and consists of a <ph id=\"ph2\">&lt;xref:System.Workflow.Activities.SequenceActivity&gt;</ph> that contains a <ph id=\"ph3\">&lt;xref:System.Workflow.Activities.PolicyActivity&gt;</ph>.","pos":[1287,1495],"source":" The `DiscountCalculator` calculates a discount based on a purchase amount and consists of a <xref:System.Workflow.Activities.SequenceActivity> that contains a <xref:System.Workflow.Activities.PolicyActivity>."},{"pos":[1503,2342],"content":"[!NOTE]\n The [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] activity created in this topic uses a <xref:System.Workflow.Activities.PolicyActivity> to implement the logic of the activity. It is not required to use a custom [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] activity or the <xref:System.Activities.Statements.Interop> activity in order to use rules in a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow. For an example of using rules in a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow without using the <xref:System.Activities.Statements.Interop> activity, see the [Policy Activity in .NET Framework 4.5](../../../docs/framework/windows-workflow-foundation/samples/policy-activity-in-net-framework-4-5.md) sample.","leadings":["","> "],"nodes":[{"content":" The [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] activity created in this topic uses a <xref:System.Workflow.Activities.PolicyActivity> to implement the logic of the activity. It is not required to use a custom [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] activity or the <xref:System.Activities.Statements.Interop> activity in order to use rules in a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow. For an example of using rules in a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow without using the <xref:System.Activities.Statements.Interop> activity, see the [Policy Activity in .NET Framework 4.5](../../../docs/framework/windows-workflow-foundation/samples/policy-activity-in-net-framework-4-5.md) sample.","pos":[8,837],"nodes":[{"content":"The <ph id=\"ph1\">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph> activity created in this topic uses a <ph id=\"ph2\">&lt;xref:System.Workflow.Activities.PolicyActivity&gt;</ph> to implement the logic of the activity.","pos":[1,196],"source":" The [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] activity created in this topic uses a <xref:System.Workflow.Activities.PolicyActivity> to implement the logic of the activity."},{"content":"It is not required to use a custom <ph id=\"ph1\">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph> activity or the <ph id=\"ph2\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity in order to use rules in a <ph id=\"ph3\">[!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)]</ph> workflow.","pos":[197,479],"source":" It is not required to use a custom [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] activity or the <xref:System.Activities.Statements.Interop> activity in order to use rules in a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow."},{"content":"For an example of using rules in a <ph id=\"ph1\">[!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)]</ph> workflow without using the <ph id=\"ph2\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity, see the <bpt id=\"p1\">[</bpt>Policy Activity in .NET Framework 4.5<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/samples/policy-activity-in-net-framework-4-5.md)</ept> sample.","pos":[480,829],"source":" For an example of using rules in a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow without using the <xref:System.Activities.Statements.Interop> activity, see the [Policy Activity in .NET Framework 4.5](../../../docs/framework/windows-workflow-foundation/samples/policy-activity-in-net-framework-4-5.md) sample."}]}]},{"pos":[2353,2410],"content":"To create the .NET Framework 3.5 activity library project","linkify":"To create the .NET Framework 3.5 activity library project","nodes":[{"content":"To create the .NET Framework 3.5 activity library project","pos":[0,57]}]},{"content":"Open <ph id=\"ph1\">[!INCLUDE[vs_current_long](../../../includes/vs-current-long-md.md)]</ph> and select <bpt id=\"p1\">**</bpt>New<ept id=\"p1\">**</ept> and then <bpt id=\"p2\">**</bpt>Project…<ept id=\"p2\">**</ept>","pos":[2420,2534],"source":"Open [!INCLUDE[vs_current_long](../../../includes/vs-current-long-md.md)] and select **New** and then **Project…**"},{"content":"from the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu.","pos":[2535,2558],"source":" from the **File** menu."},{"pos":[2568,2683],"content":"Expand the <bpt id=\"p1\">**</bpt>Other Project Types<ept id=\"p1\">**</ept> node in the <bpt id=\"p2\">**</bpt>Installed Templates<ept id=\"p2\">**</ept> pane and select <bpt id=\"p3\">**</bpt>Visual Studio Solutions<ept id=\"p3\">**</ept>.","source":"Expand the **Other Project Types** node in the **Installed Templates** pane and select **Visual Studio Solutions**."},{"content":"Select <bpt id=\"p1\">**</bpt>Blank Solution<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Visual Studio Solutions<ept id=\"p2\">**</ept> list.","pos":[2693,2761],"source":"Select **Blank Solution** from the **Visual Studio Solutions** list."},{"content":"Type <ph id=\"ph1\">`PolicyInteropDemo`</ph> in the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[2762,2824],"source":" Type `PolicyInteropDemo` in the **Name** box and click **OK**."},{"pos":[2834,2938],"content":"Right-click <bpt id=\"p1\">**</bpt>PolicyInteropDemo<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept> and then <bpt id=\"p4\">**</bpt>New Project…<ept id=\"p4\">**</ept>.","source":"Right-click **PolicyInteropDemo** in **Solution Explorer** and select **Add** and then **New Project…**."},{"pos":[2950,3068],"content":"[!TIP]\nIf the **Solution Explorer** window is not visible, select **Solution Explorer** from the **View** menu.","leadings":["","    >  "],"nodes":[{"content":"If the <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> window is not visible, select <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>View<ept id=\"p3\">**</ept> menu.","pos":[7,111],"source":"If the **Solution Explorer** window is not visible, select **Solution Explorer** from the **View** menu."}]},{"content":"In the <bpt id=\"p1\">**</bpt>Installed Templates<ept id=\"p1\">**</ept> list, select <bpt id=\"p2\">**</bpt>Visual C#<ept id=\"p2\">**</ept> and then <bpt id=\"p3\">**</bpt>Workflow<ept id=\"p3\">**</ept>.","pos":[3078,3158],"source":"In the **Installed Templates** list, select **Visual C#** and then **Workflow**."},{"content":"Select <bpt id=\"p1\">**</bpt>.NET Framework 3.5<ept id=\"p1\">**</ept> from the .NET Framework version drop-down list, and then select <bpt id=\"p2\">**</bpt>Workflow Activity Library<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Templates<ept id=\"p3\">**</ept> list.","pos":[3159,3311],"source":" Select **.NET Framework 3.5** from the .NET Framework version drop-down list, and then select **Workflow Activity Library** from the **Templates** list."},{"pos":[3321,3387],"content":"Type <ph id=\"ph1\">`PolicyActivityLibrary`</ph> in the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"Type `PolicyActivityLibrary` in the **Name** box and click **OK**."},{"content":"Right-click <bpt id=\"p1\">**</bpt>Activity1.cs<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Delete<ept id=\"p3\">**</ept>.","pos":[3397,3473],"source":"Right-click **Activity1.cs** in **Solution Explorer** and select **Delete**."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to confirm.","pos":[3474,3498],"source":" Click **OK** to confirm."},{"pos":[3509,3550],"content":"To create the DiscountCalculator activity","linkify":"To create the DiscountCalculator activity","nodes":[{"content":"To create the DiscountCalculator activity","pos":[0,41]}]},{"pos":[3560,3665],"content":"Right-click <bpt id=\"p1\">**</bpt>PolicyActivityLibrary<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept> and then <bpt id=\"p4\">**</bpt>Activity…<ept id=\"p4\">**</ept>.","source":"Right-click **PolicyActivityLibrary** in **Solution Explorer** and select **Add** and then **Activity…**."},{"content":"Select <bpt id=\"p1\">**</bpt>Activity (with code separation)<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Visual C# Items<ept id=\"p2\">**</ept> list.","pos":[3675,3752],"source":"Select **Activity (with code separation)** from the **Visual C# Items** list."},{"content":"Type <ph id=\"ph1\">`DiscountCalculator`</ph> in the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[3753,3816],"source":" Type `DiscountCalculator` in the **Name** box and click **OK**."},{"pos":[3826,3916],"content":"Right-click <bpt id=\"p1\">**</bpt>DiscountCalculator.xoml<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>View Code<ept id=\"p3\">**</ept>.","source":"Right-click **DiscountCalculator.xoml** in **Solution Explorer** and select **View Code**."},{"pos":[3926,3995],"content":"Add the following three properties to the <ph id=\"ph1\">`DiscountCalculator`</ph> class.","source":"Add the following three properties to the `DiscountCalculator` class."},{"pos":[4260,4354],"content":"Right-click <bpt id=\"p1\">**</bpt>DiscountCalculator.xoml<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>View Designer<ept id=\"p3\">**</ept>.","source":"Right-click **DiscountCalculator.xoml** in **Solution Explorer** and select **View Designer**."},{"pos":[4364,4504],"content":"Drag a <bpt id=\"p1\">**</bpt>Policy<ept id=\"p1\">**</ept> activity from the <bpt id=\"p2\">**</bpt>Windows Workflow v3.0<ept id=\"p2\">**</ept> section of the <bpt id=\"p3\">**</bpt>Toolbox<ept id=\"p3\">**</ept> and drop it in the <bpt id=\"p4\">**</bpt>DiscountCalculator<ept id=\"p4\">**</ept> activity.","source":"Drag a **Policy** activity from the **Windows Workflow v3.0** section of the **Toolbox** and drop it in the **DiscountCalculator** activity."},{"pos":[4516,4614],"content":"[!TIP]\nIf the **Toolbox** window is not visible, select **Toolbox** from the **View** menu.","leadings":["","    >  "],"nodes":[{"content":"If the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> window is not visible, select <bpt id=\"p2\">**</bpt>Toolbox<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>View<ept id=\"p3\">**</ept> menu.","pos":[7,91],"source":"If the **Toolbox** window is not visible, select **Toolbox** from the **View** menu."}]},{"pos":[4625,4647],"content":"To configure the rules","linkify":"To configure the rules","nodes":[{"content":"To configure the rules","pos":[0,22]}]},{"pos":[4657,4743],"content":"Click the newly added <bpt id=\"p1\">**</bpt>Policy<ept id=\"p1\">**</ept> activity to select it, if it is not already selected.","source":"Click the newly added **Policy** activity to select it, if it is not already selected."},{"pos":[4753,4895],"content":"Click the <bpt id=\"p1\">**</bpt>RuleSetReference<ept id=\"p1\">**</ept> property in the <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> window to select it, and click the ellipsis button to the right of the property.","source":"Click the **RuleSetReference** property in the **Properties** window to select it, and click the ellipsis button to the right of the property."},{"pos":[4907,5018],"content":"[!TIP]\nIf the **Properties** window is not visible, choose **Properties Window** from the **View** menu.","leadings":["","    >  "],"nodes":[{"content":"If the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window is not visible, choose <bpt id=\"p2\">**</bpt>Properties Window<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>View<ept id=\"p3\">**</ept> menu.","pos":[7,104],"source":"If the **Properties** window is not visible, choose **Properties Window** from the **View** menu."}]},{"pos":[5028,5050],"content":"Select <bpt id=\"p1\">**</bpt>Click New…<ept id=\"p1\">**</ept>.","source":"Select **Click New…**."},{"pos":[5060,5079],"content":"Click <bpt id=\"p1\">**</bpt>Add Rule<ept id=\"p1\">**</ept>.","source":"Click **Add Rule**."},{"pos":[5089,5146],"content":"Type the following expression into the <bpt id=\"p1\">**</bpt>Condition<ept id=\"p1\">**</ept> box.","source":"Type the following expression into the **Condition** box."},{"pos":[5228,5288],"content":"Type the following expression into the <bpt id=\"p1\">**</bpt>Then Actions<ept id=\"p1\">**</ept> box.","source":"Type the following expression into the **Then Actions** box."},{"pos":[5356,5375],"content":"Click <bpt id=\"p1\">**</bpt>Add Rule<ept id=\"p1\">**</ept>.","source":"Click **Add Rule**."},{"pos":[5385,5442],"content":"Type the following expression into the <bpt id=\"p1\">**</bpt>Condition<ept id=\"p1\">**</ept> box.","source":"Type the following expression into the **Condition** box."},{"pos":[5501,5561],"content":"Type the following expression into the <bpt id=\"p1\">**</bpt>Then Actions<ept id=\"p1\">**</ept> box.","source":"Type the following expression into the **Then Actions** box."},{"pos":[5628,5647],"content":"Click <bpt id=\"p1\">**</bpt>Add Rule<ept id=\"p1\">**</ept>.","source":"Click **Add Rule**."},{"pos":[5657,5714],"content":"Type the following expression into the <bpt id=\"p1\">**</bpt>Condition<ept id=\"p1\">**</ept> box.","source":"Type the following expression into the **Condition** box."},{"pos":[5778,5838],"content":"Type the following expression into the <bpt id=\"p1\">**</bpt>Then Actions<ept id=\"p1\">**</ept> box.","source":"Type the following expression into the **Then Actions** box."},{"pos":[5943,6003],"content":"Type the following expression into the <bpt id=\"p1\">**</bpt>Else Actions<ept id=\"p1\">**</ept> box.","source":"Type the following expression into the **Else Actions** box."},{"pos":[6069,6126],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to close the <bpt id=\"p2\">**</bpt>Rule Set Editor<ept id=\"p2\">**</ept> dialog box.","source":"Click **OK** to close the **Rule Set Editor** dialog box."},{"pos":[6136,6265],"content":"Ensure that the newly-created <ph id=\"ph1\">&lt;xref:System.Workflow.Activities.Rules.RuleSet&gt;</ph> is selected in the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> list, and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"Ensure that the newly-created <xref:System.Workflow.Activities.Rules.RuleSet> is selected in the **Name** list, and click **OK**."},{"content":"Press CTRL+SHIFT+B to build the solution.","pos":[6275,6316]},{"pos":[6323,6434],"content":"The rules added to the <ph id=\"ph1\">`DiscountCalculator`</ph> activity in this procedure are shown in the following code example.","source":"The rules added to the `DiscountCalculator` activity in this procedure are shown in the following code example."},{"pos":[6800,7040],"content":"When the <ph id=\"ph1\">&lt;xref:System.Workflow.Activities.PolicyActivity&gt;</ph> executes, these three rules evaluate and modify the <ph id=\"ph2\">`Subtotal`</ph>, <ph id=\"ph3\">`DiscountPercent`</ph>, and <ph id=\"ph4\">`Total`</ph> property values of the <ph id=\"ph5\">`DiscountCalculator`</ph> activity to calculate the desired discount.","source":"When the <xref:System.Workflow.Activities.PolicyActivity> executes, these three rules evaluate and modify the `Subtotal`, `DiscountPercent`, and `Total` property values of the `DiscountCalculator` activity to calculate the desired discount."},{"pos":[7049,7112],"content":"Using the DiscountCalculator Activity with the Interop Activity","linkify":"Using the DiscountCalculator Activity with the Interop Activity","nodes":[{"content":"Using the DiscountCalculator Activity with the Interop Activity","pos":[0,63]}]},{"content":"To use the <ph id=\"ph1\">`DiscountCalculator`</ph> activity inside a <ph id=\"ph2\">[!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)]</ph> workflow, the <ph id=\"ph3\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity is used.","pos":[7116,7318],"source":"To use the `DiscountCalculator` activity inside a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow, the <xref:System.Activities.Statements.Interop> activity is used."},{"content":"In this section two workflows are created, one using code and one using the workflow designer, which show how to use the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity with the <ph id=\"ph2\">`DiscountCalculator`</ph> activity.","pos":[7319,7532],"source":" In this section two workflows are created, one using code and one using the workflow designer, which show how to use the <xref:System.Activities.Statements.Interop> activity with the `DiscountCalculator` activity."},{"content":"The same host application is used for both workflows.","pos":[7533,7586]},{"pos":[7597,7627],"content":"To create the host application","linkify":"To create the host application","nodes":[{"content":"To create the host application","pos":[0,30]}]},{"pos":[7637,7742],"content":"Right-click <bpt id=\"p1\">**</bpt>PolicyInteropDemo<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>, and then <bpt id=\"p4\">**</bpt>New Project…<ept id=\"p4\">**</ept>.","source":"Right-click **PolicyInteropDemo** in **Solution Explorer** and select **Add**, and then **New Project…**."},{"pos":[7752,7924],"content":"Ensure that <bpt id=\"p1\">**</bpt>.NET Framework 4.5<ept id=\"p1\">**</ept> is selected in the .NET Framework version drop-down list, and select  <bpt id=\"p2\">**</bpt>Workflow Console Application<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Visual C# Items<ept id=\"p3\">**</ept> list.","source":"Ensure that **.NET Framework 4.5** is selected in the .NET Framework version drop-down list, and select  **Workflow Console Application** from the **Visual C# Items** list."},{"pos":[7934,7998],"content":"Type <ph id=\"ph1\">`PolicyInteropHost`</ph> into the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"Type `PolicyInteropHost` into the **Name** box and click **OK**."},{"pos":[8008,8093],"content":"Right-click <bpt id=\"p1\">**</bpt>PolicyInteropHost<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Properties<ept id=\"p3\">**</ept>.","source":"Right-click **PolicyInteropHost** in **Solution Explorer** and select **Properties**."},{"content":"In the <bpt id=\"p1\">**</bpt>Target framework<ept id=\"p1\">**</ept> drop-down list, change the selection from <bpt id=\"p2\">**</bpt>.NET Framework 4 Client Profile<ept id=\"p2\">**</ept> to <bpt id=\"p3\">**</bpt>.NET Framework 4.5<ept id=\"p3\">**</ept>.","pos":[8103,8235],"source":"In the **Target framework** drop-down list, change the selection from **.NET Framework 4 Client Profile** to **.NET Framework 4.5**."},{"content":"Click <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept> to confirm.","pos":[8236,8261],"source":" Click **Yes** to confirm."},{"pos":[8271,8360],"content":"Right-click <bpt id=\"p1\">**</bpt>PolicyInteropHost<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Add Reference…<ept id=\"p3\">**</ept>.","source":"Right-click **PolicyInteropHost** in **Solution Explorer** and select **Add Reference…**."},{"pos":[8370,8446],"content":"Select <bpt id=\"p1\">**</bpt>PolicyActivityLibrary<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Projects<ept id=\"p2\">**</ept> tab and click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","source":"Select **PolicyActivityLibrary** from the **Projects** tab and click **OK**."},{"pos":[8456,8545],"content":"Right-click <bpt id=\"p1\">**</bpt>PolicyInteropHost<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Add Reference…<ept id=\"p3\">**</ept>.","source":"Right-click **PolicyInteropHost** in **Solution Explorer** and select **Add Reference…**."},{"pos":[8554,8705],"content":"Select <bpt id=\"p1\">**</bpt>System.Workflow.Activities<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>System.Workflow.ComponentModel<ept id=\"p2\">**</ept>, and then <bpt id=\"p3\">**</bpt>System.Workflow.Runtime<ept id=\"p3\">**</ept> from the <bpt id=\"p4\">**</bpt>.NET<ept id=\"p4\">**</ept> tab and click <bpt id=\"p5\">**</bpt>OK<ept id=\"p5\">**</ept>.","source":"Select **System.Workflow.Activities**, **System.Workflow.ComponentModel**, and then **System.Workflow.Runtime** from the **.NET** tab and click **OK**."},{"pos":[8715,8812],"content":"Right-click <bpt id=\"p1\">**</bpt>PolicyInteropHost<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Set as StartUp Project<ept id=\"p3\">**</ept>.","source":"Right-click **PolicyInteropHost** in **Solution Explorer** and select **Set as StartUp Project**."},{"content":"Press CTRL+SHIFT+B to build the solution.","pos":[8822,8863]},{"pos":[8873,8907],"content":"Using the Interop Activity in Code","linkify":"Using the Interop Activity in Code","nodes":[{"content":"Using the Interop Activity in Code","pos":[0,34]}]},{"content":"In this example, a workflow definition is created using code that contains the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity and the <ph id=\"ph2\">`DiscountCalculator`</ph> activity.","pos":[8911,9081],"source":"In this example, a workflow definition is created using code that contains the <xref:System.Activities.Statements.Interop> activity and the `DiscountCalculator` activity."},{"content":"This workflow is invoked using <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowInvoker&gt;</ph> and the results of the rule evaluation are written to the console using a <ph id=\"ph2\">&lt;xref:System.Activities.Statements.WriteLine&gt;</ph> activity.","pos":[9082,9283],"source":" This workflow is invoked using <xref:System.Activities.WorkflowInvoker> and the results of the rule evaluation are written to the console using a <xref:System.Activities.Statements.WriteLine> activity."},{"pos":[9295,9330],"content":"To use the Interop activity in code","linkify":"To use the Interop activity in code","nodes":[{"content":"To use the Interop activity in code","pos":[0,35]}]},{"pos":[9340,9417],"content":"Right-click <bpt id=\"p1\">**</bpt>Program.cs<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>View Code<ept id=\"p3\">**</ept>.","source":"Right-click **Program.cs** in **Solution Explorer** and select **View Code**."},{"pos":[9427,9486],"content":"Add the following <ph id=\"ph1\">`using`</ph> statement at the top of the file.","source":"Add the following `using` statement at the top of the file."},{"pos":[9560,9637],"content":"Remove the contents of the <ph id=\"ph1\">`Main`</ph> method and replace with the following code.","source":"Remove the contents of the `Main` method and replace with the following code."},{"pos":[9778,9898],"content":"Create a new method in the <ph id=\"ph1\">`Program`</ph> class called <ph id=\"ph2\">`CalculateDiscountUsingCodeWorkflow`</ph> that contains the following code.","source":"Create a new method in the `Program` class called `CalculateDiscountUsingCodeWorkflow` that contains the following code."},{"pos":[11419,12542],"content":"[!NOTE]\nThe `Subtotal`, `DiscountPercent`, and `Total` properties of the `DiscountCalculator` activity are surfaced as arguments of the <xref:System.Activities.Statements.Interop> activity, and bound to local workflow variables in the <xref:System.Activities.Statements.Interop> activity’s <xref:System.Activities.Statements.Interop.ActivityProperties%2A> collection. `Subtotal` is added as an <xref:System.Activities.ArgumentDirection> argument because the `Subtotal` data flows into the <xref:System.Activities.Statements.Interop> activity, and `DiscountPercent` and `Total` are added as <xref:System.Activities.ArgumentDirection> arguments because their data flows out of the <xref:System.Activities.Statements.Interop> activity. Note that the two <xref:System.Activities.ArgumentDirection> arguments are added with the names `DiscountPercentOut` and `TotalOut` to indicate that they represent <xref:System.Activities.ArgumentDirection> arguments. The `DiscountCalculator` type is specified as the <xref:System.Activities.Statements.Interop> activity’s <xref:System.Activities.Statements.Interop.ActivityType%2A>.","leadings":["","    >  "],"nodes":[{"content":"The `Subtotal`, `DiscountPercent`, and `Total` properties of the `DiscountCalculator` activity are surfaced as arguments of the <xref:System.Activities.Statements.Interop> activity, and bound to local workflow variables in the <xref:System.Activities.Statements.Interop> activity’s <xref:System.Activities.Statements.Interop.ActivityProperties%2A> collection. `Subtotal` is added as an <xref:System.Activities.ArgumentDirection> argument because the `Subtotal` data flows into the <xref:System.Activities.Statements.Interop> activity, and `DiscountPercent` and `Total` are added as <xref:System.Activities.ArgumentDirection> arguments because their data flows out of the <xref:System.Activities.Statements.Interop> activity. Note that the two <xref:System.Activities.ArgumentDirection> arguments are added with the names `DiscountPercentOut` and `TotalOut` to indicate that they represent <xref:System.Activities.ArgumentDirection> arguments. The `DiscountCalculator` type is specified as the <xref:System.Activities.Statements.Interop> activity’s <xref:System.Activities.Statements.Interop.ActivityType%2A>.","pos":[8,1116],"nodes":[{"content":"The <ph id=\"ph1\">`Subtotal`</ph>, <ph id=\"ph2\">`DiscountPercent`</ph>, and <ph id=\"ph3\">`Total`</ph> properties of the <ph id=\"ph4\">`DiscountCalculator`</ph> activity are surfaced as arguments of the <ph id=\"ph5\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity, and bound to local workflow variables in the <ph id=\"ph6\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity’s <ph id=\"ph7\">&lt;xref:System.Activities.Statements.Interop.ActivityProperties%2A&gt;</ph> collection.","pos":[0,359],"source":"The `Subtotal`, `DiscountPercent`, and `Total` properties of the `DiscountCalculator` activity are surfaced as arguments of the <xref:System.Activities.Statements.Interop> activity, and bound to local workflow variables in the <xref:System.Activities.Statements.Interop> activity’s <xref:System.Activities.Statements.Interop.ActivityProperties%2A> collection."},{"content":"<ph id=\"ph1\">`Subtotal`</ph> is added as an <ph id=\"ph2\">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> argument because the <ph id=\"ph3\">`Subtotal`</ph> data flows into the <ph id=\"ph4\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity, and <ph id=\"ph5\">`DiscountPercent`</ph> and <ph id=\"ph6\">`Total`</ph> are added as <ph id=\"ph7\">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments because their data flows out of the <ph id=\"ph8\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity.","pos":[360,724],"source":"`Subtotal` is added as an <xref:System.Activities.ArgumentDirection> argument because the `Subtotal` data flows into the <xref:System.Activities.Statements.Interop> activity, and `DiscountPercent` and `Total` are added as <xref:System.Activities.ArgumentDirection> arguments because their data flows out of the <xref:System.Activities.Statements.Interop> activity."},{"content":"Note that the two <ph id=\"ph1\">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments are added with the names <ph id=\"ph2\">`DiscountPercentOut`</ph> and <ph id=\"ph3\">`TotalOut`</ph> to indicate that they represent <ph id=\"ph4\">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments.","pos":[725,942],"source":" Note that the two <xref:System.Activities.ArgumentDirection> arguments are added with the names `DiscountPercentOut` and `TotalOut` to indicate that they represent <xref:System.Activities.ArgumentDirection> arguments."},{"content":"The <ph id=\"ph1\">`DiscountCalculator`</ph> type is specified as the <ph id=\"ph2\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity’s <ph id=\"ph3\">&lt;xref:System.Activities.Statements.Interop.ActivityType%2A&gt;</ph>.","pos":[943,1108],"source":" The `DiscountCalculator` type is specified as the <xref:System.Activities.Statements.Interop> activity’s <xref:System.Activities.Statements.Interop.ActivityType%2A>."}]}]},{"content":"Press CTRL+F5 to build and run the application.","pos":[12552,12599]},{"content":"Substitute different values for the <ph id=\"ph1\">`Subtotal`</ph> value to test out the different discount levels provided by the <ph id=\"ph2\">`DiscountCalculator`</ph> activity.","pos":[12600,12741],"source":" Substitute different values for the `Subtotal` value to test out the different discount levels provided by the `DiscountCalculator` activity."},{"pos":[12929,12980],"content":"Using the Interop Activity in the Workflow Designer","linkify":"Using the Interop Activity in the Workflow Designer","nodes":[{"content":"Using the Interop Activity in the Workflow Designer","pos":[0,51]}]},{"content":"In this example, a workflow is created using the workflow designer.","pos":[12984,13051]},{"content":"This workflow has the same functionality as the previous example, except than instead of using a <ph id=\"ph1\">&lt;xref:System.Activities.Statements.WriteLine&gt;</ph> activity to display the discount, the host application retrieves and displays the discount information when the workflow completes.","pos":[13052,13326],"source":" This workflow has the same functionality as the previous example, except than instead of using a <xref:System.Activities.Statements.WriteLine> activity to display the discount, the host application retrieves and displays the discount information when the workflow completes."},{"content":"Also, instead of using local workflow variables to contain the data, arguments are created in the workflow designer and the values are passed in from the host when the workflow is invoked.","pos":[13327,13515]},{"pos":[13527,13596],"content":"To host the PolicyActivity using a Workflow Designer-created workflow","linkify":"To host the PolicyActivity using a Workflow Designer-created workflow","nodes":[{"content":"To host the PolicyActivity using a Workflow Designer-created workflow","pos":[0,69]}]},{"content":"Right-click <bpt id=\"p1\">**</bpt>Workflow1.xaml<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Delete<ept id=\"p3\">**</ept>.","pos":[13606,13684],"source":"Right-click **Workflow1.xaml** in **Solution Explorer** and select **Delete**."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to confirm.","pos":[13685,13709],"source":" Click **OK** to confirm."},{"pos":[13719,13812],"content":"Right-click <bpt id=\"p1\">**</bpt>PolicyInteropHost<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>New Item…<ept id=\"p4\">**</ept>.","source":"Right-click **PolicyInteropHost** in **Solution Explorer** and select **Add**, **New Item…**."},{"content":"Expand the <bpt id=\"p1\">**</bpt>Visual C# Items<ept id=\"p1\">**</ept> node and select <bpt id=\"p2\">**</bpt>Workflow<ept id=\"p2\">**</ept>.","pos":[13822,13882],"source":"Expand the **Visual C# Items** node and select **Workflow**."},{"content":"Select <bpt id=\"p1\">**</bpt>Activity<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Visual C# Items<ept id=\"p2\">**</ept> list.","pos":[13883,13937],"source":" Select **Activity** from the **Visual C# Items** list."},{"pos":[13947,14011],"content":"Type <ph id=\"ph1\">`DiscountWorkflow`</ph> into the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box and click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>.","source":"Type `DiscountWorkflow` into the **Name** box and click **Add**."},{"pos":[14021,14134],"content":"Click the <bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept> button on the lower left side of the workflow designer to display the <bpt id=\"p2\">**</bpt>Arguments<ept id=\"p2\">**</ept> pane.","source":"Click the **Arguments** button on the lower left side of the workflow designer to display the **Arguments** pane."},{"pos":[14144,14170],"content":"Click <bpt id=\"p1\">**</bpt>Create Argument<ept id=\"p1\">**</ept>.","source":"Click **Create Argument**."},{"pos":[14180,14365],"content":"Type <ph id=\"ph1\">`Subtotal`</ph> into the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, select <bpt id=\"p2\">**</bpt>In<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Direction<ept id=\"p3\">**</ept> drop-down, select <bpt id=\"p4\">**</bpt>Double<ept id=\"p4\">**</ept> from the <bpt id=\"p5\">**</bpt>Argument type<ept id=\"p5\">**</ept> drop-down, and then press ENTER to save the argument.","source":"Type `Subtotal` into the **Name** box, select **In** from the **Direction** drop-down, select **Double** from the **Argument type** drop-down, and then press ENTER to save the argument."},{"pos":[14377,14549],"content":"[!NOTE]\nIf **Double** is not in the **Argument type** drop-down list, select **Browse for Types …**, type `System.Double` in the **Type Name** box, and click **OK**.","leadings":["","    >  "],"nodes":[{"content":"If <bpt id=\"p1\">**</bpt>Double<ept id=\"p1\">**</ept> is not in the <bpt id=\"p2\">**</bpt>Argument type<ept id=\"p2\">**</ept> drop-down list, select <bpt id=\"p3\">**</bpt>Browse for Types …<ept id=\"p3\">**</ept>, type <ph id=\"ph1\">`System.Double`</ph> in the <bpt id=\"p4\">**</bpt>Type Name<ept id=\"p4\">**</ept> box, and click <bpt id=\"p5\">**</bpt>OK<ept id=\"p5\">**</ept>.","pos":[8,165],"source":"If **Double** is not in the **Argument type** drop-down list, select **Browse for Types …**, type `System.Double` in the **Type Name** box, and click **OK**."}]},{"pos":[14559,14585],"content":"Click <bpt id=\"p1\">**</bpt>Create Argument<ept id=\"p1\">**</ept>.","source":"Click **Create Argument**."},{"pos":[14594,14787],"content":"Type <ph id=\"ph1\">`DiscountPercent`</ph> into the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, select <bpt id=\"p2\">**</bpt>Out<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Direction<ept id=\"p3\">**</ept> drop-down, select <bpt id=\"p4\">**</bpt>Double<ept id=\"p4\">**</ept> from the <bpt id=\"p5\">**</bpt>Argument type<ept id=\"p5\">**</ept> drop-down, and then press ENTER to save the argument.","source":"Type `DiscountPercent` into the **Name** box, select **Out** from the **Direction** drop-down, select **Double** from the **Argument type** drop-down, and then press ENTER to save the argument."},{"pos":[14797,14823],"content":"Click <bpt id=\"p1\">**</bpt>Create Argument<ept id=\"p1\">**</ept>.","source":"Click **Create Argument**."},{"pos":[14833,15016],"content":"Type <ph id=\"ph1\">`Total`</ph> into the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, select <bpt id=\"p2\">**</bpt>Out<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Direction<ept id=\"p3\">**</ept> drop-down, select <bpt id=\"p4\">**</bpt>Double<ept id=\"p4\">**</ept> from the <bpt id=\"p5\">**</bpt>Argument type<ept id=\"p5\">**</ept> drop-down, and then press ENTER to save the argument.","source":"Type `Total` into the **Name** box, select **Out** from the **Direction** drop-down, select **Double** from the **Argument type** drop-down, and then press ENTER to save the argument."},{"pos":[15026,15137],"content":"Click the <bpt id=\"p1\">**</bpt>Arguments<ept id=\"p1\">**</ept> button on the lower left side of the workflow designer to close the <bpt id=\"p2\">**</bpt>Arguments<ept id=\"p2\">**</ept> pane.","source":"Click the **Arguments** button on the lower left side of the workflow designer to close the **Arguments** pane."},{"pos":[15147,15276],"content":"Drag a <bpt id=\"p1\">**</bpt>Sequence<ept id=\"p1\">**</ept> activity from the <bpt id=\"p2\">**</bpt>Control Flow<ept id=\"p2\">**</ept> section of the <bpt id=\"p3\">**</bpt>Toolbox<ept id=\"p3\">**</ept> and drop it onto the workflow designer surface.","source":"Drag a **Sequence** activity from the **Control Flow** section of the **Toolbox** and drop it onto the workflow designer surface."},{"pos":[15286,15406],"content":"Drag an <bpt id=\"p1\">**</bpt>Interop<ept id=\"p1\">**</ept> activity from the <bpt id=\"p2\">**</bpt>Migration<ept id=\"p2\">**</ept> section of the <bpt id=\"p3\">**</bpt>Toolbox<ept id=\"p3\">**</ept> and drop it in the <bpt id=\"p4\">**</bpt>Sequence<ept id=\"p4\">**</ept> activity.","source":"Drag an **Interop** activity from the **Migration** section of the **Toolbox** and drop it in the **Sequence** activity."},{"content":"Click the <bpt id=\"p1\">**</bpt>Interop<ept id=\"p1\">**</ept> activity on the <bpt id=\"p2\">**</bpt>Click to browse…<ept id=\"p2\">**</ept>","pos":[15416,15474],"source":"Click the **Interop** activity on the **Click to browse…**"},{"content":"label, type <bpt id=\"p1\">**</bpt>DiscountCalculator<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Type Name<ept id=\"p2\">**</ept> box, and click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","pos":[15475,15553],"source":" label, type **DiscountCalculator** in the **Type Name** box, and click **OK**."},{"pos":[15565,16448],"content":"[!NOTE]\nWhen the <xref:System.Activities.Statements.Interop> activity is added to the workflow and the `DiscountCalculator` type is specified as its <xref:System.Activities.Statements.Interop.ActivityType%2A>, the <xref:System.Activities.Statements.Interop> activity exposes three <xref:System.Activities.ArgumentDirection> arguments and three <xref:System.Activities.ArgumentDirection> arguments that represent the three public properties of the `DiscountCalculator` activity. The <xref:System.Activities.ArgumentDirection> arguments have the same name as the three public properties, and the three <xref:System.Activities.ArgumentDirection> arguments have the same names with **Out** appended to the property name. In the following steps, the workflow arguments created in the previous steps are bound to the <xref:System.Activities.Statements.Interop> activity’s arguments.","leadings":["","    >  "],"nodes":[{"content":"When the <xref:System.Activities.Statements.Interop> activity is added to the workflow and the `DiscountCalculator` type is specified as its <xref:System.Activities.Statements.Interop.ActivityType%2A>, the <xref:System.Activities.Statements.Interop> activity exposes three <xref:System.Activities.ArgumentDirection> arguments and three <xref:System.Activities.ArgumentDirection> arguments that represent the three public properties of the `DiscountCalculator` activity. The <xref:System.Activities.ArgumentDirection> arguments have the same name as the three public properties, and the three <xref:System.Activities.ArgumentDirection> arguments have the same names with **Out** appended to the property name. In the following steps, the workflow arguments created in the previous steps are bound to the <xref:System.Activities.Statements.Interop> activity’s arguments.","pos":[8,876],"nodes":[{"content":"When the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity is added to the workflow and the <ph id=\"ph2\">`DiscountCalculator`</ph> type is specified as its <ph id=\"ph3\">&lt;xref:System.Activities.Statements.Interop.ActivityType%2A&gt;</ph>, the <ph id=\"ph4\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity exposes three <ph id=\"ph5\">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments and three <ph id=\"ph6\">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments that represent the three public properties of the <ph id=\"ph7\">`DiscountCalculator`</ph> activity.","pos":[0,469],"source":"When the <xref:System.Activities.Statements.Interop> activity is added to the workflow and the `DiscountCalculator` type is specified as its <xref:System.Activities.Statements.Interop.ActivityType%2A>, the <xref:System.Activities.Statements.Interop> activity exposes three <xref:System.Activities.ArgumentDirection> arguments and three <xref:System.Activities.ArgumentDirection> arguments that represent the three public properties of the `DiscountCalculator` activity."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments have the same name as the three public properties, and the three <ph id=\"ph2\">&lt;xref:System.Activities.ArgumentDirection&gt;</ph> arguments have the same names with <bpt id=\"p1\">**</bpt>Out<ept id=\"p1\">**</ept> appended to the property name.","pos":[470,708],"source":" The <xref:System.Activities.ArgumentDirection> arguments have the same name as the three public properties, and the three <xref:System.Activities.ArgumentDirection> arguments have the same names with **Out** appended to the property name."},{"content":"In the following steps, the workflow arguments created in the previous steps are bound to the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Interop&gt;</ph> activity’s arguments.","pos":[709,868],"source":" In the following steps, the workflow arguments created in the previous steps are bound to the <xref:System.Activities.Statements.Interop> activity’s arguments."}]}]},{"pos":[16458,16586],"content":"Type <ph id=\"ph1\">`DiscountPercent`</ph> into the <bpt id=\"p1\">**</bpt>Enter a VB expression<ept id=\"p1\">**</ept> box to the right of the <bpt id=\"p2\">**</bpt>DiscountPercentOut<ept id=\"p2\">**</ept> property and press TAB.","source":"Type `DiscountPercent` into the **Enter a VB expression** box to the right of the **DiscountPercentOut** property and press TAB."},{"pos":[16596,16707],"content":"Type <ph id=\"ph1\">`Subtotal`</ph> into the <bpt id=\"p1\">**</bpt>Enter a VB expression<ept id=\"p1\">**</ept> box to the right of the <bpt id=\"p2\">**</bpt>Subtotal<ept id=\"p2\">**</ept> property and press TAB.","source":"Type `Subtotal` into the **Enter a VB expression** box to the right of the **Subtotal** property and press TAB."},{"pos":[16717,16825],"content":"Type <ph id=\"ph1\">`Total`</ph> into the <bpt id=\"p1\">**</bpt>Enter a VB expression<ept id=\"p1\">**</ept> box to the right of the <bpt id=\"p2\">**</bpt>TotalOut<ept id=\"p2\">**</ept> property and press TAB.","source":"Type `Total` into the **Enter a VB expression** box to the right of the **TotalOut** property and press TAB."},{"pos":[16835,16912],"content":"Right-click <bpt id=\"p1\">**</bpt>Program.cs<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>View Code<ept id=\"p3\">**</ept>.","source":"Right-click **Program.cs** in **Solution Explorer** and select **View Code**."},{"pos":[16922,16981],"content":"Add the following <ph id=\"ph1\">`using`</ph> statement at the top of the file.","source":"Add the following `using` statement at the top of the file."},{"pos":[17060,17169],"content":"Comment out the call to the <ph id=\"ph1\">`CalculateDiscountInCode`</ph> method in the <ph id=\"ph2\">`Main`</ph> method and add the following code.","source":"Comment out the call to the `CalculateDiscountInCode` method in the `Main` method and add the following code."},{"pos":[17181,17336],"content":"[!NOTE]\nIf you did not follow the previous procedure and the default `Main` code is present, replace the contents of `Main` with the following code.","leadings":["","    >  "],"nodes":[{"content":"If you did not follow the previous procedure and the default <ph id=\"ph1\">`Main`</ph> code is present, replace the contents of <ph id=\"ph2\">`Main`</ph> with the following code.","pos":[8,148],"source":"If you did not follow the previous procedure and the default `Main` code is present, replace the contents of `Main` with the following code."}]},{"pos":[17531,17655],"content":"Create a new method in the <ph id=\"ph1\">`Program`</ph> class called <ph id=\"ph2\">`CalculateDiscountUsingDesignerWorkflow`</ph> that contains the following code.","source":"Create a new method in the `Program` class called `CalculateDiscountUsingDesignerWorkflow` that contains the following code."},{"content":"Press CTRL+F5 to build and run the application.","pos":[18288,18335]},{"content":"To specify a different <ph id=\"ph1\">`Subtotal`</ph> amount, change the value of <ph id=\"ph2\">`SubtotalValue`</ph> in the following code.","pos":[18336,18436],"source":" To specify a different `Subtotal` amount, change the value of `SubtotalValue` in the following code."},{"pos":[18533,18556],"content":"Rules Features Overview","linkify":"Rules Features Overview","nodes":[{"content":"Rules Features Overview","pos":[0,23]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[wf1](../../../includes/wf1-md.md)]</ph> rules engine provides support for processing rules in a priority-based manner with support for forward chaining.","pos":[18560,18721],"source":"The [!INCLUDE[wf1](../../../includes/wf1-md.md)] rules engine provides support for processing rules in a priority-based manner with support for forward chaining."},{"content":"Rules can be evaluated for a single item or for items in a collection.","pos":[18722,18792]},{"content":"For an overview of rules and information on specific rules functionality, please refer to the following table.","pos":[18793,18903]},{"content":"Rules Feature","pos":[18910,18923]},{"content":"Documentation","pos":[18924,18937]},{"content":"Rules Overview","pos":[18986,19000]},{"pos":[19001,19110],"content":"<bpt id=\"p1\">[</bpt>Introduction to the Windows Workflow Foundation Rules Engine<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=152836)</ept>","source":"[Introduction to the Windows Workflow Foundation Rules Engine](http://go.microsoft.com/fwlink/?LinkID=152836)"},{"content":"RuleSet","pos":[19115,19122]},{"pos":[19123,19251],"content":"<bpt id=\"p1\">[</bpt>Using RuleSets in Workflows<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=178516)</ept> and <ph id=\"ph1\">&lt;xref:System.Workflow.Activities.Rules.RuleSet&gt;</ph>","source":"[Using RuleSets in Workflows](http://go.microsoft.com/fwlink/?LinkId=178516) and <xref:System.Workflow.Activities.Rules.RuleSet>"},{"content":"Evaluation of Rules","pos":[19256,19275]},{"pos":[19276,19353],"content":"<bpt id=\"p1\">[</bpt>Rules Evaluation in RuleSets<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=178517)</ept>","source":"[Rules Evaluation in RuleSets](http://go.microsoft.com/fwlink/?LinkId=178517)"},{"content":"Rules Chaining","pos":[19358,19372]},{"pos":[19373,19525],"content":"<bpt id=\"p1\">[</bpt>Forward Chaining Control<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=178518)</ept> and <bpt id=\"p2\">[</bpt>Forward Chaining of Rules<ept id=\"p2\">](http://go.microsoft.com/fwlink/?LinkId=178519)</ept>","source":"[Forward Chaining Control](http://go.microsoft.com/fwlink/?LinkId=178518) and [Forward Chaining of Rules](http://go.microsoft.com/fwlink/?LinkId=178519)"},{"content":"Processing Collections in Rules","pos":[19530,19561]},{"pos":[19562,19642],"content":"<bpt id=\"p1\">[</bpt>Processing Collections in Rules<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=178520)</ept>","source":"[Processing Collections in Rules](http://go.microsoft.com/fwlink/?LinkId=178520)"},{"content":"Using the PolicyActivity","pos":[19647,19671]},{"pos":[19672,19807],"content":"<bpt id=\"p1\">[</bpt>Using the PolicyActivity Activity<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=178521)</ept> and <ph id=\"ph1\">&lt;xref:System.Workflow.Activities.PolicyActivity&gt;</ph>","source":"[Using the PolicyActivity Activity](http://go.microsoft.com/fwlink/?LinkId=178521) and <xref:System.Workflow.Activities.PolicyActivity>"},{"content":"Workflows created in <ph id=\"ph1\">[!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)]</ph> do not use all of the rules features provided by <ph id=\"ph2\">[!INCLUDE[wf1](../../../includes/wf1-md.md)]</ph>, such as declarative activity conditions and conditional activities such as the <ph id=\"ph3\">&lt;xref:System.Workflow.Activities.ConditionedActivityGroup&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Workflow.Activities.ReplicatorActivity&gt;</ph>.","pos":[19815,20203],"source":"Workflows created in [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] do not use all of the rules features provided by [!INCLUDE[wf1](../../../includes/wf1-md.md)], such as declarative activity conditions and conditional activities such as the <xref:System.Workflow.Activities.ConditionedActivityGroup> and <xref:System.Workflow.Activities.ReplicatorActivity>."},{"content":"If required, this functionality is available for workflows created using <ph id=\"ph1\">[!INCLUDE[vstecwinfx](../../../includes/vstecwinfx-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]</ph>.","pos":[20204,20405],"source":" If required, this functionality is available for workflows created using [!INCLUDE[vstecwinfx](../../../includes/vstecwinfx-md.md)] and [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)]."},{"content":"<ph id=\"ph1\">[!INCLUDE[crdefault](../../../includes/crdefault-md.md)]</ph><bpt id=\"p1\">[</bpt>Migration Guidance<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/migration-guidance.md)</ept>.","pos":[20406,20558],"source":"[!INCLUDE[crdefault](../../../includes/crdefault-md.md)][Migration Guidance](../../../docs/framework/windows-workflow-foundation/migration-guidance.md)."}]}