{"content":"---\ntitle: \"Registering Assemblies with COM | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"COM interop, registering assemblies\"\n  - \"unregistering assemblies\"\n  - \"interoperation with unmanaged code, registering assemblies\"\n  - \"registering assemblies\"\nms.assetid: 87925795-a3ae-4833-b138-125413478551\ncaps.latest.revision: 11\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Registering Assemblies with COM\nYou can run a command-line tool called the [Assembly Registration Tool (Regasm.exe)](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md) to register or unregister an assembly for use with COM. Regasm.exe adds information about the class to the system registry so COM clients can use the .NET Framework class transparently. The <xref:System.Runtime.InteropServices.RegistrationServices> class provides the equivalent functionality.  \n  \n A managed component must be registered in the Windows registry before it can be activated from a COM client. The following table shows the keys that Regasm.exe typically adds to the Windows registry. (000000 indicates the actual GUID value.)  \n  \n|GUID|Description|Registry key|  \n|----------|-----------------|------------------|  \n|CLSID|Class identifier|HKEY_CLASSES_ROOT\\CLSID\\\\{000…000}|  \n|IID|Interface identifier|HKEY_CLASSES_ROOT\\Interface\\\\{000…000}|  \n|LIBID|Library identifier|HKEY_CLASSES_ROOT\\TypeLib\\\\{000…000}|  \n|ProgID|Programmatic identifier|HKEY_CLASSES_ROOT\\000…000|  \n  \n Under the HKCR\\CLSID\\\\{0000…0000} key, the default value is set to the ProgID of the class, and two new named values, Class and Assembly, are added. The runtime reads the Assembly value from the registry and passes it on to the runtime assembly resolver. The assembly resolver attempts to locate the assembly, based on assembly information such as the name and version number. For the assembly resolver to locate an assembly, the assembly has to be in one of the following locations:  \n  \n-   The global assembly cache (must be a strong-named assembly).  \n  \n-   In the application directory. Assemblies loaded from the application path are only accessible from that application.  \n  \n-   Along an file path specified with the **/codebase** option to Regasm.exe.  \n  \n Regasm.exe also creates the InProcServer32 key under the HKCR\\CLSID\\\\{0000…0000} key. The default value for the key is set to the name of the DLL that initializes the common language runtime (Mscoree.dll).  \n  \n## Examining Registry Entries  \n COM interop provides a standard class factory implementation to create an instance of any .NET Framework class. Clients can call **DllGetClassObject** on the managed DLL to get a class factory and create objects, just as they would with any other COM component.  \n  \n For the `InprocServer32` subkey, a reference to Mscoree.dll appears in place of a traditional COM type library to indicate that the common language runtime creates the managed object.  \n  \n## See Also  \n [Exposing .NET Framework Components to COM](../../../docs/framework/interop/exposing-dotnet-components-to-com.md)   \n [How to: Reference .NET Types from COM](../../../docs/framework/interop/how-to-reference-net-types-from-com.md)   \n [Calling a .NET Object](http://msdn.microsoft.com/en-us/40c9626c-aea6-4bad-b8f0-c1de462efd33)   \n [Deploying an Application for COM Access](http://msdn.microsoft.com/en-us/fb63564c-c1b9-4655-a094-a235625882ce)","nodes":[{"pos":[4,603],"nodes":[{"content":"Registering Assemblies with COM | Microsoft Docs","nodes":[{"pos":[0,48],"content":"Registering Assemblies with COM | Microsoft Docs","nodes":[{"content":"Registering Assemblies with COM | Microsoft Docs","pos":[0,48]}]}],"pos":[6,57],"yaml":true}],"content":"title: \"Registering Assemblies with COM | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"COM interop, registering assemblies\"\n  - \"unregistering assemblies\"\n  - \"interoperation with unmanaged code, registering assemblies\"\n  - \"registering assemblies\"\nms.assetid: 87925795-a3ae-4833-b138-125413478551\ncaps.latest.revision: 11\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[610,641],"content":"Registering Assemblies with COM","linkify":"Registering Assemblies with COM","nodes":[{"content":"Registering Assemblies with COM","pos":[0,31]}]},{"content":"You can run a command-line tool called the <bpt id=\"p1\">[</bpt>Assembly Registration Tool (Regasm.exe)<ept id=\"p1\">](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md)</ept> to register or unregister an assembly for use with COM.","pos":[642,854],"source":"You can run a command-line tool called the [Assembly Registration Tool (Regasm.exe)](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md) to register or unregister an assembly for use with COM."},{"content":"Regasm.exe adds information about the class to the system registry so COM clients can use the .NET Framework class transparently.","pos":[855,984]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.RegistrationServices&gt;</ph> class provides the equivalent functionality.","pos":[985,1092],"source":" The <xref:System.Runtime.InteropServices.RegistrationServices> class provides the equivalent functionality."},{"content":"A managed component must be registered in the Windows registry before it can be activated from a COM client.","pos":[1099,1207]},{"content":"The following table shows the keys that Regasm.exe typically adds to the Windows registry.","pos":[1208,1298]},{"content":"(000000 indicates the actual GUID value.)","pos":[1299,1340]},{"content":"GUID","pos":[1347,1351]},{"content":"Description","pos":[1352,1363]},{"content":"Registry key","pos":[1364,1376]},{"content":"CLSID","pos":[1433,1438]},{"content":"Class identifier","pos":[1439,1455]},{"content":"HKEY_CLASSES_ROOT\\CLSID<ph id=\"ph1\">\\\\</ph>{000…000}","pos":[1456,1490],"source":"HKEY_CLASSES_ROOT\\CLSID\\\\{000…000}"},{"content":"IID","pos":[1495,1498]},{"content":"Interface identifier","pos":[1499,1519]},{"content":"HKEY_CLASSES_ROOT\\Interface<ph id=\"ph1\">\\\\</ph>{000…000}","pos":[1520,1558],"source":"HKEY_CLASSES_ROOT\\Interface\\\\{000…000}"},{"content":"LIBID","pos":[1563,1568]},{"content":"Library identifier","pos":[1569,1587]},{"content":"HKEY_CLASSES_ROOT\\TypeLib<ph id=\"ph1\">\\\\</ph>{000…000}","pos":[1588,1624],"source":"HKEY_CLASSES_ROOT\\TypeLib\\\\{000…000}"},{"content":"ProgID","pos":[1629,1635]},{"content":"Programmatic identifier","pos":[1636,1659]},{"content":"HKEY_CLASSES_ROOT\\000…000","pos":[1660,1685]},{"content":"Under the HKCR\\CLSID<ph id=\"ph1\">\\\\</ph>{0000…0000} key, the default value is set to the ProgID of the class, and two new named values, Class and Assembly, are added.","pos":[1693,1841],"source":"Under the HKCR\\CLSID\\\\{0000…0000} key, the default value is set to the ProgID of the class, and two new named values, Class and Assembly, are added."},{"content":"The runtime reads the Assembly value from the registry and passes it on to the runtime assembly resolver.","pos":[1842,1947]},{"content":"The assembly resolver attempts to locate the assembly, based on assembly information such as the name and version number.","pos":[1948,2069]},{"content":"For the assembly resolver to locate an assembly, the assembly has to be in one of the following locations:","pos":[2070,2176]},{"content":"The global assembly cache (must be a strong-named assembly).","pos":[2186,2246]},{"content":"In the application directory.","pos":[2256,2285]},{"content":"Assemblies loaded from the application path are only accessible from that application.","pos":[2286,2372]},{"pos":[2382,2455],"content":"Along an file path specified with the <bpt id=\"p1\">**</bpt>/codebase<ept id=\"p1\">**</ept> option to Regasm.exe.","source":"Along an file path specified with the **/codebase** option to Regasm.exe."},{"content":"Regasm.exe also creates the InProcServer32 key under the HKCR\\CLSID<ph id=\"ph1\">\\\\</ph>{0000…0000} key.","pos":[2462,2547],"source":"Regasm.exe also creates the InProcServer32 key under the HKCR\\CLSID\\\\{0000…0000} key."},{"content":"The default value for the key is set to the name of the DLL that initializes the common language runtime (Mscoree.dll).","pos":[2548,2667]},{"pos":[2676,2702],"content":"Examining Registry Entries","linkify":"Examining Registry Entries","nodes":[{"content":"Examining Registry Entries","pos":[0,26]}]},{"content":"COM interop provides a standard class factory implementation to create an instance of any .NET Framework class.","pos":[2706,2817]},{"content":"Clients can call <bpt id=\"p1\">**</bpt>DllGetClassObject<ept id=\"p1\">**</ept> on the managed DLL to get a class factory and create objects, just as they would with any other COM component.","pos":[2818,2967],"source":" Clients can call **DllGetClassObject** on the managed DLL to get a class factory and create objects, just as they would with any other COM component."},{"pos":[2974,3157],"content":"For the <ph id=\"ph1\">`InprocServer32`</ph> subkey, a reference to Mscoree.dll appears in place of a traditional COM type library to indicate that the common language runtime creates the managed object.","source":"For the `InprocServer32` subkey, a reference to Mscoree.dll appears in place of a traditional COM type library to indicate that the common language runtime creates the managed object."},{"pos":[3166,3174],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Exposing .NET Framework Components to COM<ept id=\"p1\">](../../../docs/framework/interop/exposing-dotnet-components-to-com.md)</ept><ph id=\"ph1\"> </ph>","pos":[3178,3292],"source":"[Exposing .NET Framework Components to COM](../../../docs/framework/interop/exposing-dotnet-components-to-com.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Reference .NET Types from COM<ept id=\"p1\">](../../../docs/framework/interop/how-to-reference-net-types-from-com.md)</ept><ph id=\"ph1\"> </ph>","pos":[3296,3408],"source":"[How to: Reference .NET Types from COM](../../../docs/framework/interop/how-to-reference-net-types-from-com.md) "},{"content":"<bpt id=\"p1\">[</bpt>Calling a .NET Object<ept id=\"p1\">](http://msdn.microsoft.com/en-us/40c9626c-aea6-4bad-b8f0-c1de462efd33)</ept><ph id=\"ph1\"> </ph>","pos":[3412,3506],"source":"[Calling a .NET Object](http://msdn.microsoft.com/en-us/40c9626c-aea6-4bad-b8f0-c1de462efd33) "},{"content":"<bpt id=\"p1\">[</bpt>Deploying an Application for COM Access<ept id=\"p1\">](http://msdn.microsoft.com/en-us/fb63564c-c1b9-4655-a094-a235625882ce)</ept>","pos":[3510,3621],"source":"[Deploying an Application for COM Access](http://msdn.microsoft.com/en-us/fb63564c-c1b9-4655-a094-a235625882ce)"}]}