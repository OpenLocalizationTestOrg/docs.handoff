{"content":"---\ntitle: \"Handling Events (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"event handling [Visual Basic], walkthroughs\"\n  - \"walkthroughs [Visual Basic], event handling\"\n  - \"variables [Visual Basic], WithEvents\"\n  - \"events [Visual Basic], walkthroughs\"\n  - \"WithEvents keyword [Visual Basic], walkthroughs\"\n  - \"event handlers [Visual Basic], walkthroughs\"\nms.assetid: f145b3fc-5ae0-4509-a2aa-1ff6934706bd\n---\n# Walkthrough: Handling Events (Visual Basic)\nThis is the second of two topics that demonstrate how to work with events. The first topic, [Walkthrough: Declaring and Raising Events](../../../../visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md), shows how to declare and raise events. This section uses the form and class from that walkthrough to show how to handle events when they take place.  \n  \n The `Widget` class example uses traditional event-handling statements. Visual Basic provides other techniques for working with events. As an exercise, you can modify this example to use the `AddHandler` and `Handles` statements.  \n  \n### To handle the PercentDone event of the Widget class  \n  \n1.  Place the following code in `Form1`:  \n  \n     [!code-vb[VbVbcnWalkthroughDeclaringAndRaisingEvents#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnWalkthroughDeclaringAndRaisingEvents/VB/Form1.vb#4)]  \n  \n     The `WithEvents` keyword specifies that the variable `mWidget` is used to handle an object's events. You specify the kind of object by supplying the name of the class from which the object will be created.  \n  \n     The variable `mWidget` is declared in `Form1` because `WithEvents` variables must be class-level. This is true regardless of the type of class you place them in.  \n  \n     The variable `mblnCancel` is used to cancel the `LongTask` method.  \n  \n## Writing Code to Handle an Event  \n As soon as you declare a variable using `WithEvents`, the variable name appears in the left drop-down list of the class's **Code Editor**. When you select `mWidget`, the `Widget` class's events appear in the right drop-down list. Selecting an event displays the corresponding event procedure, with the prefix `mWidget` and an underscore. All the event procedures associated with a `WithEvents` variable are given the variable name as a prefix.  \n  \n#### To handle an event  \n  \n1.  Select `mWidget` from the left drop-down list in the **Code Editor**.  \n  \n2.  Select the `PercentDone` event from the right drop-down list. The **Code Editor** opens the `mWidget_PercentDone` event procedure.  \n  \n    > [!NOTE]\n    >  The **Code Editor** is useful, but not required, for inserting new event handlers. In this walkthrough, it is more direct to just copy the event handlers directly into your code.  \n  \n3.  Add the following code to the `mWidget_PercentDone` event handler:  \n  \n     [!code-vb[VbVbcnWalkthroughDeclaringAndRaisingEvents#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnWalkthroughDeclaringAndRaisingEvents/VB/Form1.vb#5)]  \n  \n     Whenever the `PercentDone` event is raised, the event procedure displays the percent complete in a `Label` control. The `DoEvents` method allows the label to repaint, and also gives the user the opportunity to click the **Cancel** button.  \n  \n4.  Add the following code for the `Button2_Click` event handler:  \n  \n     [!code-vb[VbVbcnWalkthroughDeclaringAndRaisingEvents#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnWalkthroughDeclaringAndRaisingEvents/VB/Form1.vb#6)]  \n  \n If the user clicks the **Cancel** button while `LongTask` is running, the `Button2_Click` event is executed as soon as the `DoEvents` statement allows event processing to occur. The class-level variable `mblnCancel` is set to `True`, and the `mWidget_PercentDone` event then tests it and sets the `ByRef Cancel` argument to `True`.  \n  \n## Connecting a WithEvents Variable to an Object  \n `Form1` is now set up to handle a `Widget` object's events. All that remains is to find a `Widget` somewhere.  \n  \n When you declare a variable `WithEvents` at design time, no object is associated with it. A `WithEvents` variable is just like any other object variable. You have to create an object and assign a reference to it with the `WithEvents` variable.  \n  \n#### To create an object and assign a reference to it  \n  \n1.  Select **(Form1 Events)** from the left drop-down list in the **Code Editor**.  \n  \n2.  Select the `Load` event from the right drop-down list. The **Code Editor** opens the `Form1_Load` event procedure.  \n  \n3.  Add the following code for the `Form1_Load` event procedure to create the `Widget`:  \n  \n     [!code-vb[VbVbcnWalkthroughDeclaringAndRaisingEvents#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnWalkthroughDeclaringAndRaisingEvents/VB/Form1.vb#7)]  \n  \n When this code executes, Visual Basic creates a `Widget` object and connects its events to the event procedures associated with `mWidget`. From that point on, whenever the `Widget` raises its `PercentDone` event, the `mWidget_PercentDone` event procedure is executed.  \n  \n#### To call the LongTask method  \n  \n-   Add the following code to the `Button1_Click` event handler:  \n  \n     [!code-vb[VbVbcnWalkthroughDeclaringAndRaisingEvents#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnWalkthroughDeclaringAndRaisingEvents/VB/Form1.vb#8)]  \n  \n Before the `LongTask` method is called, the label that displays the percent complete must be initialized, and the class-level `Boolean` flag for canceling the method must be set to `False`.  \n  \n `LongTask` is called with a task duration of 12.2 seconds. The `PercentDone` event is raised once every one-third of a second. Each time the event is raised, the `mWidget_PercentDone` event procedure is executed.  \n  \n When `LongTask` is done, `mblnCancel` is tested to see if `LongTask` ended normally, or if it stopped because `mblnCancel` was set to `True`. The percent complete is updated only in the former case.  \n  \n#### To run the program  \n  \n1.  Press F5 to put the project in run mode.  \n  \n2.  Click the **Start Task** button. Each time the `PercentDone` event is raised, the label is updated with the percentage of the task that is complete.  \n  \n3.  Click the **Cancel** button to stop the task. Notice that the appearance of the **Cancel** button does not change immediately when you click it. The `Click` event cannot happen until the `My.Application.DoEvents` statement allows event processing.  \n  \n    > [!NOTE]\n    >  The `My.Application.DoEvents` method does not process events in exactly the same way as the form does. For example, in this walkthrough, you must click the **Cancel** button twice. To allow the form to handle the events directly, you can use multithreading. For more information, see [Managed Threading](../../../../standard/threading/index.md).\n  \n You may find it instructive to run the program with F11 and step through the code a line at a time. You can clearly see how execution enters `LongTask`, and then briefly re-enters `Form1` each time the `PercentDone` event is raised.  \n  \n What would happen if, while execution was back in the code of `Form1`, the `LongTask` method were called again? At worst, a stack overflow might occur if `LongTask` were called every time the event was raised.  \n  \n You can cause the variable `mWidget` to handle events for a different `Widget` object by assigning a reference to the new `Widget` to `mWidget`. In fact, you can make the code in `Button1_Click` do this every time you click the button.  \n  \n#### To handle events for a different widget  \n  \n-   Add the following line of code to the `Button1_Click` procedure, immediately preceding the line that reads `mWidget.LongTask(12.2, 0.33)`:  \n  \n     [!code-vb[VbVbcnWalkthroughDeclaringAndRaisingEvents#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnWalkthroughDeclaringAndRaisingEvents/VB/Form1.vb#9)]  \n  \n The code above creates a new `Widget` each time the button is clicked. As soon as the `LongTask` method completes, the reference to the `Widget` is released, and the `Widget` is destroyed.  \n  \n A `WithEvents` variable can contain only one object reference at a time, so if you assign a different `Widget` object to `mWidget`, the previous `Widget` object's events will no longer be handled. If `mWidget` is the only object variable containing a reference to the old `Widget`, the object is destroyed. If you want to handle events from several `Widget` objects, use the `AddHandler` statement to process events from each object separately.  \n  \n> [!NOTE]\n>  You can declare as many `WithEvents` variables as you need, but arrays of `WithEvents` variables are not supported.  \n  \n## See also\n\n- [Walkthrough: Declaring and Raising Events](../../../../visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md)\n- [Events](../../../../visual-basic/programming-guide/language-features/events/index.md)\n","nodes":[{"pos":[4,423],"embed":true,"restype":"x-metadata","content":"title: \"Handling Events (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"event handling [Visual Basic], walkthroughs\"\n  - \"walkthroughs [Visual Basic], event handling\"\n  - \"variables [Visual Basic], WithEvents\"\n  - \"events [Visual Basic], walkthroughs\"\n  - \"WithEvents keyword [Visual Basic], walkthroughs\"\n  - \"event handlers [Visual Basic], walkthroughs\"\nms.assetid: f145b3fc-5ae0-4509-a2aa-1ff6934706bd","nodes":[{"content":"Handling Events (Visual Basic)","nodes":[{"pos":[0,30],"content":"Handling Events (Visual Basic)","nodes":[{"content":"Handling Events (Visual Basic)","pos":[0,30]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[430,473],"content":"Walkthrough: Handling Events (Visual Basic)","linkify":"Walkthrough: Handling Events (Visual Basic)","nodes":[{"content":"Walkthrough: Handling Events (Visual Basic)","pos":[0,43]}]},{"content":"This is the second of two topics that demonstrate how to work with events.","pos":[474,548]},{"content":"The first topic, <bpt id=\"p1\">[</bpt>Walkthrough: Declaring and Raising Events<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md)</ept>, shows how to declare and raise events.","pos":[549,762],"source":" The first topic, [Walkthrough: Declaring and Raising Events](../../../../visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md), shows how to declare and raise events."},{"content":"This section uses the form and class from that walkthrough to show how to handle events when they take place.","pos":[763,872]},{"content":"The <ph id=\"ph1\">`Widget`</ph> class example uses traditional event-handling statements.","pos":[879,949],"source":"The `Widget` class example uses traditional event-handling statements."},{"content":"Visual Basic provides other techniques for working with events.","pos":[950,1013]},{"content":"As an exercise, you can modify this example to use the <ph id=\"ph1\">`AddHandler`</ph> and <ph id=\"ph2\">`Handles`</ph> statements.","pos":[1014,1107],"source":" As an exercise, you can modify this example to use the `AddHandler` and `Handles` statements."},{"pos":[1117,1168],"content":"To handle the PercentDone event of the Widget class","linkify":"To handle the PercentDone event of the Widget class","nodes":[{"content":"To handle the PercentDone event of the Widget class","pos":[0,51]}]},{"pos":[1178,1214],"content":"Place the following code in <ph id=\"ph1\">`Form1`</ph>:","source":"Place the following code in `Form1`:"},{"content":"The <ph id=\"ph1\">`WithEvents`</ph> keyword specifies that the variable <ph id=\"ph2\">`mWidget`</ph> is used to handle an object's events.","pos":[1402,1502],"source":"The `WithEvents` keyword specifies that the variable `mWidget` is used to handle an object's events."},{"content":"You specify the kind of object by supplying the name of the class from which the object will be created.","pos":[1503,1607]},{"content":"The variable <ph id=\"ph1\">`mWidget`</ph> is declared in <ph id=\"ph2\">`Form1`</ph> because <ph id=\"ph3\">`WithEvents`</ph> variables must be class-level.","pos":[1618,1715],"source":"The variable `mWidget` is declared in `Form1` because `WithEvents` variables must be class-level."},{"content":"This is true regardless of the type of class you place them in.","pos":[1716,1779]},{"pos":[1790,1856],"content":"The variable <ph id=\"ph1\">`mblnCancel`</ph> is used to cancel the <ph id=\"ph2\">`LongTask`</ph> method.","source":"The variable `mblnCancel` is used to cancel the `LongTask` method."},{"pos":[1865,1896],"content":"Writing Code to Handle an Event","linkify":"Writing Code to Handle an Event","nodes":[{"content":"Writing Code to Handle an Event","pos":[0,31]}]},{"content":"As soon as you declare a variable using <ph id=\"ph1\">`WithEvents`</ph>, the variable name appears in the left drop-down list of the class's <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept>.","pos":[1900,2038],"source":"As soon as you declare a variable using `WithEvents`, the variable name appears in the left drop-down list of the class's **Code Editor**."},{"content":"When you select <ph id=\"ph1\">`mWidget`</ph>, the <ph id=\"ph2\">`Widget`</ph> class's events appear in the right drop-down list.","pos":[2039,2129],"source":" When you select `mWidget`, the `Widget` class's events appear in the right drop-down list."},{"content":"Selecting an event displays the corresponding event procedure, with the prefix <ph id=\"ph1\">`mWidget`</ph> and an underscore.","pos":[2130,2237],"source":" Selecting an event displays the corresponding event procedure, with the prefix `mWidget` and an underscore."},{"content":"All the event procedures associated with a <ph id=\"ph1\">`WithEvents`</ph> variable are given the variable name as a prefix.","pos":[2238,2343],"source":" All the event procedures associated with a `WithEvents` variable are given the variable name as a prefix."},{"pos":[2354,2372],"content":"To handle an event","linkify":"To handle an event","nodes":[{"content":"To handle an event","pos":[0,18]}]},{"pos":[2382,2451],"content":"Select <ph id=\"ph1\">`mWidget`</ph> from the left drop-down list in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept>.","source":"Select `mWidget` from the left drop-down list in the **Code Editor**."},{"content":"Select the <ph id=\"ph1\">`PercentDone`</ph> event from the right drop-down list.","pos":[2461,2522],"source":"Select the `PercentDone` event from the right drop-down list."},{"content":"The <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept> opens the <ph id=\"ph1\">`mWidget_PercentDone`</ph> event procedure.","pos":[2523,2591],"source":" The **Code Editor** opens the `mWidget_PercentDone` event procedure."},{"pos":[2603,2796],"content":"[!NOTE]\nThe **Code Editor** is useful, but not required, for inserting new event handlers. In this walkthrough, it is more direct to just copy the event handlers directly into your code.","leadings":["","    >  "],"nodes":[{"content":"The **Code Editor** is useful, but not required, for inserting new event handlers. In this walkthrough, it is more direct to just copy the event handlers directly into your code.","pos":[8,186],"nodes":[{"content":"The <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept> is useful, but not required, for inserting new event handlers.","pos":[0,82],"source":"The **Code Editor** is useful, but not required, for inserting new event handlers."},{"content":"In this walkthrough, it is more direct to just copy the event handlers directly into your code.","pos":[83,178]}]}]},{"pos":[2806,2872],"content":"Add the following code to the <ph id=\"ph1\">`mWidget_PercentDone`</ph> event handler:","source":"Add the following code to the `mWidget_PercentDone` event handler:"},{"content":"Whenever the <ph id=\"ph1\">`PercentDone`</ph> event is raised, the event procedure displays the percent complete in a <ph id=\"ph2\">`Label`</ph> control.","pos":[3060,3175],"source":"Whenever the `PercentDone` event is raised, the event procedure displays the percent complete in a `Label` control."},{"content":"The <ph id=\"ph1\">`DoEvents`</ph> method allows the label to repaint, and also gives the user the opportunity to click the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button.","pos":[3176,3298],"source":" The `DoEvents` method allows the label to repaint, and also gives the user the opportunity to click the **Cancel** button."},{"pos":[3308,3369],"content":"Add the following code for the <ph id=\"ph1\">`Button2_Click`</ph> event handler:","source":"Add the following code for the `Button2_Click` event handler:"},{"content":"If the user clicks the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button while <ph id=\"ph1\">`LongTask`</ph> is running, the <ph id=\"ph2\">`Button2_Click`</ph> event is executed as soon as the <ph id=\"ph3\">`DoEvents`</ph> statement allows event processing to occur.","pos":[3553,3730],"source":"If the user clicks the **Cancel** button while `LongTask` is running, the `Button2_Click` event is executed as soon as the `DoEvents` statement allows event processing to occur."},{"content":"The class-level variable <ph id=\"ph1\">`mblnCancel`</ph> is set to <ph id=\"ph2\">`True`</ph>, and the <ph id=\"ph3\">`mWidget_PercentDone`</ph> event then tests it and sets the <ph id=\"ph4\">`ByRef Cancel`</ph> argument to <ph id=\"ph5\">`True`</ph>.","pos":[3731,3884],"source":" The class-level variable `mblnCancel` is set to `True`, and the `mWidget_PercentDone` event then tests it and sets the `ByRef Cancel` argument to `True`."},{"pos":[3893,3938],"content":"Connecting a WithEvents Variable to an Object","linkify":"Connecting a WithEvents Variable to an Object","nodes":[{"content":"Connecting a WithEvents Variable to an Object","pos":[0,45]}]},{"content":"<ph id=\"ph1\">`Form1`</ph> is now set up to handle a <ph id=\"ph2\">`Widget`</ph> object's events.","pos":[3942,4001],"source":"`Form1` is now set up to handle a `Widget` object's events."},{"content":"All that remains is to find a <ph id=\"ph1\">`Widget`</ph> somewhere.","pos":[4002,4051],"source":" All that remains is to find a `Widget` somewhere."},{"content":"When you declare a variable <ph id=\"ph1\">`WithEvents`</ph> at design time, no object is associated with it.","pos":[4058,4147],"source":"When you declare a variable `WithEvents` at design time, no object is associated with it."},{"content":"A <ph id=\"ph1\">`WithEvents`</ph> variable is just like any other object variable.","pos":[4148,4211],"source":" A `WithEvents` variable is just like any other object variable."},{"content":"You have to create an object and assign a reference to it with the <ph id=\"ph1\">`WithEvents`</ph> variable.","pos":[4212,4301],"source":" You have to create an object and assign a reference to it with the `WithEvents` variable."},{"pos":[4312,4360],"content":"To create an object and assign a reference to it","linkify":"To create an object and assign a reference to it","nodes":[{"content":"To create an object and assign a reference to it","pos":[0,48]}]},{"pos":[4370,4448],"content":"Select <bpt id=\"p1\">**</bpt>(Form1 Events)<ept id=\"p1\">**</ept> from the left drop-down list in the <bpt id=\"p2\">**</bpt>Code Editor<ept id=\"p2\">**</ept>.","source":"Select **(Form1 Events)** from the left drop-down list in the **Code Editor**."},{"content":"Select the <ph id=\"ph1\">`Load`</ph> event from the right drop-down list.","pos":[4458,4512],"source":"Select the `Load` event from the right drop-down list."},{"content":"The <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept> opens the <ph id=\"ph1\">`Form1_Load`</ph> event procedure.","pos":[4513,4572],"source":" The **Code Editor** opens the `Form1_Load` event procedure."},{"pos":[4582,4665],"content":"Add the following code for the <ph id=\"ph1\">`Form1_Load`</ph> event procedure to create the <ph id=\"ph2\">`Widget`</ph>:","source":"Add the following code for the `Form1_Load` event procedure to create the `Widget`:"},{"content":"When this code executes, Visual Basic creates a <ph id=\"ph1\">`Widget`</ph> object and connects its events to the event procedures associated with <ph id=\"ph2\">`mWidget`</ph>.","pos":[4849,4987],"source":"When this code executes, Visual Basic creates a `Widget` object and connects its events to the event procedures associated with `mWidget`."},{"content":"From that point on, whenever the <ph id=\"ph1\">`Widget`</ph> raises its <ph id=\"ph2\">`PercentDone`</ph> event, the <ph id=\"ph3\">`mWidget_PercentDone`</ph> event procedure is executed.","pos":[4988,5116],"source":" From that point on, whenever the `Widget` raises its `PercentDone` event, the `mWidget_PercentDone` event procedure is executed."},{"pos":[5127,5154],"content":"To call the LongTask method","linkify":"To call the LongTask method","nodes":[{"content":"To call the LongTask method","pos":[0,27]}]},{"pos":[5164,5224],"content":"Add the following code to the <ph id=\"ph1\">`Button1_Click`</ph> event handler:","source":"Add the following code to the `Button1_Click` event handler:"},{"pos":[5408,5597],"content":"Before the <ph id=\"ph1\">`LongTask`</ph> method is called, the label that displays the percent complete must be initialized, and the class-level <ph id=\"ph2\">`Boolean`</ph> flag for canceling the method must be set to <ph id=\"ph3\">`False`</ph>.","source":"Before the `LongTask` method is called, the label that displays the percent complete must be initialized, and the class-level `Boolean` flag for canceling the method must be set to `False`."},{"content":"<ph id=\"ph1\">`LongTask`</ph> is called with a task duration of 12.2 seconds.","pos":[5604,5662],"source":"`LongTask` is called with a task duration of 12.2 seconds."},{"content":"The <ph id=\"ph1\">`PercentDone`</ph> event is raised once every one-third of a second.","pos":[5663,5730],"source":" The `PercentDone` event is raised once every one-third of a second."},{"content":"Each time the event is raised, the <ph id=\"ph1\">`mWidget_PercentDone`</ph> event procedure is executed.","pos":[5731,5816],"source":" Each time the event is raised, the `mWidget_PercentDone` event procedure is executed."},{"content":"When <ph id=\"ph1\">`LongTask`</ph> is done, <ph id=\"ph2\">`mblnCancel`</ph> is tested to see if <ph id=\"ph3\">`LongTask`</ph> ended normally, or if it stopped because <ph id=\"ph4\">`mblnCancel`</ph> was set to <ph id=\"ph5\">`True`</ph>.","pos":[5823,5964],"source":"When `LongTask` is done, `mblnCancel` is tested to see if `LongTask` ended normally, or if it stopped because `mblnCancel` was set to `True`."},{"content":"The percent complete is updated only in the former case.","pos":[5965,6021]},{"pos":[6032,6050],"content":"To run the program","linkify":"To run the program","nodes":[{"content":"To run the program","pos":[0,18]}]},{"content":"Press F5 to put the project in run mode.","pos":[6060,6100]},{"content":"Click the <bpt id=\"p1\">**</bpt>Start Task<ept id=\"p1\">**</ept> button.","pos":[6110,6142],"source":"Click the **Start Task** button."},{"content":"Each time the <ph id=\"ph1\">`PercentDone`</ph> event is raised, the label is updated with the percentage of the task that is complete.","pos":[6143,6258],"source":" Each time the `PercentDone` event is raised, the label is updated with the percentage of the task that is complete."},{"content":"Click the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button to stop the task.","pos":[6268,6313],"source":"Click the **Cancel** button to stop the task."},{"content":"Notice that the appearance of the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button does not change immediately when you click it.","pos":[6314,6412],"source":" Notice that the appearance of the **Cancel** button does not change immediately when you click it."},{"content":"The <ph id=\"ph1\">`Click`</ph> event cannot happen until the <ph id=\"ph2\">`My.Application.DoEvents`</ph> statement allows event processing.","pos":[6413,6515],"source":" The `Click` event cannot happen until the `My.Application.DoEvents` statement allows event processing."},{"pos":[6527,6887],"content":"[!NOTE]\nThe `My.Application.DoEvents` method does not process events in exactly the same way as the form does. For example, in this walkthrough, you must click the **Cancel** button twice. To allow the form to handle the events directly, you can use multithreading. For more information, see [Managed Threading](../../../../standard/threading/index.md).","leadings":["","    >  "],"nodes":[{"content":"The `My.Application.DoEvents` method does not process events in exactly the same way as the form does. For example, in this walkthrough, you must click the **Cancel** button twice. To allow the form to handle the events directly, you can use multithreading. For more information, see [Managed Threading](../../../../standard/threading/index.md).","pos":[8,353],"nodes":[{"content":"The <ph id=\"ph1\">`My.Application.DoEvents`</ph> method does not process events in exactly the same way as the form does.","pos":[0,102],"source":"The `My.Application.DoEvents` method does not process events in exactly the same way as the form does."},{"content":"For example, in this walkthrough, you must click the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button twice.","pos":[103,180],"source":" For example, in this walkthrough, you must click the **Cancel** button twice."},{"content":"To allow the form to handle the events directly, you can use multithreading.","pos":[181,257]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Managed Threading<ept id=\"p1\">](../../../../standard/threading/index.md)</ept>.","pos":[258,345],"source":" For more information, see [Managed Threading](../../../../standard/threading/index.md)."}]}]},{"content":"You may find it instructive to run the program with F11 and step through the code a line at a time.","pos":[6892,6991]},{"content":"You can clearly see how execution enters <ph id=\"ph1\">`LongTask`</ph>, and then briefly re-enters <ph id=\"ph2\">`Form1`</ph> each time the <ph id=\"ph3\">`PercentDone`</ph> event is raised.","pos":[6992,7124],"source":" You can clearly see how execution enters `LongTask`, and then briefly re-enters `Form1` each time the `PercentDone` event is raised."},{"content":"What would happen if, while execution was back in the code of <ph id=\"ph1\">`Form1`</ph>, the <ph id=\"ph2\">`LongTask`</ph> method were called again?","pos":[7131,7242],"source":"What would happen if, while execution was back in the code of `Form1`, the `LongTask` method were called again?"},{"content":"At worst, a stack overflow might occur if <ph id=\"ph1\">`LongTask`</ph> were called every time the event was raised.","pos":[7243,7340],"source":" At worst, a stack overflow might occur if `LongTask` were called every time the event was raised."},{"content":"You can cause the variable <ph id=\"ph1\">`mWidget`</ph> to handle events for a different <ph id=\"ph2\">`Widget`</ph> object by assigning a reference to the new <ph id=\"ph3\">`Widget`</ph> to <ph id=\"ph4\">`mWidget`</ph>.","pos":[7347,7491],"source":"You can cause the variable `mWidget` to handle events for a different `Widget` object by assigning a reference to the new `Widget` to `mWidget`."},{"content":"In fact, you can make the code in <ph id=\"ph1\">`Button1_Click`</ph> do this every time you click the button.","pos":[7492,7582],"source":" In fact, you can make the code in `Button1_Click` do this every time you click the button."},{"pos":[7593,7632],"content":"To handle events for a different widget","linkify":"To handle events for a different widget","nodes":[{"content":"To handle events for a different widget","pos":[0,39]}]},{"pos":[7642,7780],"content":"Add the following line of code to the <ph id=\"ph1\">`Button1_Click`</ph> procedure, immediately preceding the line that reads <ph id=\"ph2\">`mWidget.LongTask(12.2, 0.33)`</ph>:","source":"Add the following line of code to the `Button1_Click` procedure, immediately preceding the line that reads `mWidget.LongTask(12.2, 0.33)`:"},{"content":"The code above creates a new <ph id=\"ph1\">`Widget`</ph> each time the button is clicked.","pos":[7964,8034],"source":"The code above creates a new `Widget` each time the button is clicked."},{"content":"As soon as the <ph id=\"ph1\">`LongTask`</ph> method completes, the reference to the <ph id=\"ph2\">`Widget`</ph> is released, and the <ph id=\"ph3\">`Widget`</ph> is destroyed.","pos":[8035,8152],"source":" As soon as the `LongTask` method completes, the reference to the `Widget` is released, and the `Widget` is destroyed."},{"content":"A <ph id=\"ph1\">`WithEvents`</ph> variable can contain only one object reference at a time, so if you assign a different <ph id=\"ph2\">`Widget`</ph> object to <ph id=\"ph3\">`mWidget`</ph>, the previous <ph id=\"ph4\">`Widget`</ph> object's events will no longer be handled.","pos":[8159,8355],"source":"A `WithEvents` variable can contain only one object reference at a time, so if you assign a different `Widget` object to `mWidget`, the previous `Widget` object's events will no longer be handled."},{"content":"If <ph id=\"ph1\">`mWidget`</ph> is the only object variable containing a reference to the old <ph id=\"ph2\">`Widget`</ph>, the object is destroyed.","pos":[8356,8465],"source":" If `mWidget` is the only object variable containing a reference to the old `Widget`, the object is destroyed."},{"content":"If you want to handle events from several <ph id=\"ph1\">`Widget`</ph> objects, use the <ph id=\"ph2\">`AddHandler`</ph> statement to process events from each object separately.","pos":[8466,8603],"source":" If you want to handle events from several `Widget` objects, use the `AddHandler` statement to process events from each object separately."},{"pos":[8611,8737],"content":"[!NOTE]\n You can declare as many `WithEvents` variables as you need, but arrays of `WithEvents` variables are not supported.","leadings":["","> "],"nodes":[{"content":"You can declare as many <ph id=\"ph1\">`WithEvents`</ph> variables as you need, but arrays of <ph id=\"ph2\">`WithEvents`</ph> variables are not supported.","pos":[9,124],"source":"You can declare as many `WithEvents` variables as you need, but arrays of `WithEvents` variables are not supported."}]},{"pos":[8746,8754],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8758,8914],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Declaring and Raising Events<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md)</ept>","source":"[Walkthrough: Declaring and Raising Events](../../../../visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md)"},{"pos":[8917,9003],"content":"<bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/events/index.md)</ept>","source":"[Events](../../../../visual-basic/programming-guide/language-features/events/index.md)"}]}