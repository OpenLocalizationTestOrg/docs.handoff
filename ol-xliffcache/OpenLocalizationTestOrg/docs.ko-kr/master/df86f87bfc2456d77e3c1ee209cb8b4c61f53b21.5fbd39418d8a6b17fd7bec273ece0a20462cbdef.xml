{"content":"---\ntitle: \"How to: Use the ASP.NET Membership Provider\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"WCF and ASP.NET\"\n  - \"WCF, authorization\"\n  - \"WCF, security\"\nms.assetid: 322c56e0-938f-4f19-a981-7b6530045b90\n---\n# How to: Use the ASP.NET Membership Provider\nThe [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] membership provider is a feature that enables [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] developers to create Web sites that allow users to create unique user name and password combinations. With this facility, any user can establish an account with the site, and sign in for exclusive access to the site and its services. This is in contrast to Windows security, which requires users to have accounts in a Windows domain. Instead, any user that supplies his or her credentials (the user name/password combination) can use the site and its services.  \n  \n For a sample application, see [Membership and Role Provider](../../../../docs/framework/wcf/samples/membership-and-role-provider.md). For information about using the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] role provider feature, see [How to: Use the ASP.NET Role Provider with a Service](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-role-provider-with-a-service.md).  \n  \n The membership feature requires using a SQL Server database to store the user information. The feature also includes methods for prompting with a question any users who have forgotten their password.  \n  \n Windows Communication Foundation (WCF) developers can take advantage of these features for security purposes. When integrated into an WCF application, users must supply a user name/password combination to the WCF client application. To transfer the data to the WCF service, use a binding that supports user name/password credentials, such as the <xref:System.ServiceModel.WSHttpBinding> (in configuration, the [\\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md)) and set the client credential type to `UserName`. On the service, WCF security authenticates the user based on the user name and password, and also assigns the role specified by the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] role.  \n  \n> [!NOTE]\n>  WCF does not provide methods to populate the database with user name/password combinations or other user information.  \n  \n### To configure the membership provider  \n  \n1.  In the Web.config file, under the <`system.web`> element, create a <`membership`> element.  \n  \n2.  Under the `<membership>` element, create a `<providers>` element.  \n  \n3.  As a child to the <`providers`> element, add a `<clear />` element to flush the collection of providers.  \n  \n4.  Under the `<clear />` element, create an <`add`> element with the following attributes set to appropriate values: `name`, `type`, `connectionStringName`, `applicationName`, `enablePasswordRetrieval`, `enablePasswordReset`, `requiresQuestionAndAnswer`, `requiresUniqueEmail`, and `passwordFormat`. The `name` attribute is used later as a value in the configuration file. The following example sets it to `SqlMembershipProvider`.  \n  \n     The following example shows the configuration section.  \n  \n    ```xml  \n    <!-- Configure the Sql Membership Provider -->  \n    <membership defaultProvider=\"SqlMembershipProvider\" userIsOnlineTimeWindow=\"15\">  \n      <providers>  \n        <clear />  \n          <add   \n            name=\"SqlMembershipProvider\"   \n            type=\"System.Web.Security.SqlMembershipProvider\"   \n            connectionStringName=\"SqlConn\"  \n            applicationName=\"MembershipAndRoleProviderSample\"  \n            enablePasswordRetrieval=\"false\"  \n            enablePasswordReset=\"false\"  \n            requiresQuestionAndAnswer=\"false\"  \n            requiresUniqueEmail=\"true\"  \n            passwordFormat=\"Hashed\" />  \n      </providers>  \n    </membership>  \n    ```  \n  \n### To configure service security to accept the user name/password combination  \n  \n1.  In the configuration file, under the [\\<system.serviceModel>](../../../../docs/framework/configure-apps/file-schema/wcf/system-servicemodel.md) element, add a [\\<bindings>](../../../../docs/framework/configure-apps/file-schema/wcf/bindings.md) element.  \n  \n2.  Add a [\\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md) to the bindings section. For more information about creating an WCF binding element, see [How to: Specify a Service Binding in Configuration](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md).  \n  \n3.  Set the `mode` attribute of the `<security>` element to `Message`.  \n  \n4.  Set the `clientCredentialType` attribute of the <`message`> element to `UserName`. This specifies that a user name/password pair will be used as the client's credential.  \n  \n     The following example shows the configuration code for the binding.  \n  \n    ```xml  \n    <system.serviceModel>  \n    <bindings>  \n      <wsHttpBinding>  \n      <!-- Set up a binding that uses UserName as the client credential type -->  \n        <binding name=\"MembershipBinding\">  \n          <security mode =\"Message\">  \n            <message clientCredentialType =\"UserName\"/>  \n          </security>  \n        </binding>  \n      </wsHttpBinding>  \n    </bindings>  \n    </system.serviceModel>  \n    ```  \n  \n### To configure a service to use the membership provider  \n  \n1.  As a child to the `<system.serviceModel>` element, add a [\\<behaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md) element  \n  \n2.  Add a [\\<serviceBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md) to the <`behaviors`> element.  \n  \n3.  Add a [\\<behavior>](../../../../docs/framework/configure-apps/file-schema/wcf/behavior-of-endpointbehaviors.md) and set the `name` attribute to an appropriate value.  \n  \n4.  Add a [\\<serviceCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md) to the <`behavior`> element.  \n  \n5.  Add a [\\<userNameAuthentication>](../../../../docs/framework/configure-apps/file-schema/wcf/usernameauthentication.md) to the `<serviceCredentials>` element.  \n  \n6.  Set the `userNamePasswordValidationMode` attribute to `MembershipProvider`.  \n  \n    > [!IMPORTANT]\n    >  If the `userNamePasswordValidationMode` value is not set, WCF uses Windows authentication instead of the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] membership provider.  \n  \n7.  Set the `membershipProviderName` attribute to the name of the provider (specified when adding the provider in the first procedure in this topic). The following example shows the `<serviceCredentials>` fragment to this point.  \n  \n    ```xml  \n    <behaviors>  \n       <serviceBehaviors>  \n          <behavior name=\"MyServiceBehavior\">  \n             <serviceCredentials>  \n                <userNameAuthentication   \n                userNamePasswordValidationMode=\"MembershipProvider\"  \n                membershipProviderName=\"SqlMembershipProvider\" />  \n             </serviceCredentials>  \n          </behavior>  \n       </serviceBehaviors>  \n    </behaviors>  \n    ```  \n  \n## Example  \n The following code shows the configuration for a service that uses the ASP membership feature.  \n  \n```xml  \n<?xml version=\"1.0\" encoding=\"utf-8\" ?>  \n<configuration>  \n  <system.serviceModel>  \n    <services>  \n      <service behaviorConfiguration=\"MyServiceBehavior\" name=\"Microsoft.Samples.GettingStarted.CalculatorService\">  \n        <endpoint address=\"http://microsoft.com/WCFservices/Calculator\"  \n          binding=\"wsHttpBinding\" bindingConfiguration=\"MembershipBinding\"  \n          name=\"ASPmemberUserName\" contract=\"Microsoft.Samples.GettingStarted.ICalculator\" />  \n      </service>  \n    </services>  \n    <behaviors>  \n      <serviceBehaviors>  \n        <behavior name=\"MyServiceBehavior\">  \n          <serviceCredentials>  \n            <userNameAuthentication   \n              userNamePasswordValidationMode=\"MembershipProvider\"  \n              membershipProviderName=\"SqlMembershipProvider\" />  \n          </serviceCredentials>  \n        </behavior>  \n          </serviceBehaviors>  \n    </behaviors>  \n    <bindings>  \n      <wsHttpBinding>  \n        <binding name=\"MembershipBinding\">  \n          <security mode=\"Message\">  \n            <message clientCredentialType=\"UserName\" />  \n          </security>  \n        </binding>  \n      </wsHttpBinding>  \n    </bindings>  \n  </system.serviceModel>  \n</configuration>  \n```  \n  \n## See also\n\n- [How to: Use the ASP.NET Role Provider with a Service](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-role-provider-with-a-service.md)\n- [Membership and Role Provider](../../../../docs/framework/wcf/samples/membership-and-role-provider.md)\n","nodes":[{"pos":[4,216],"embed":true,"restype":"x-metadata","content":"title: \"How to: Use the ASP.NET Membership Provider\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"WCF and ASP.NET\"\n  - \"WCF, authorization\"\n  - \"WCF, security\"\nms.assetid: 322c56e0-938f-4f19-a981-7b6530045b90","nodes":[{"content":"How to: Use the ASP.NET Membership Provider","nodes":[{"pos":[0,43],"content":"How to: Use the ASP.NET Membership Provider","nodes":[{"content":"How to: Use the ASP.NET Membership Provider","pos":[0,43]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[223,266],"content":"How to: Use the ASP.NET Membership Provider","linkify":"How to: Use the ASP.NET Membership Provider","nodes":[{"content":"How to: Use the ASP.NET Membership Provider","pos":[0,43]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> membership provider is a feature that enables <ph id=\"ph2\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> developers to create Web sites that allow users to create unique user name and password combinations.","pos":[267,534],"source":"The [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] membership provider is a feature that enables [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] developers to create Web sites that allow users to create unique user name and password combinations."},{"content":"With this facility, any user can establish an account with the site, and sign in for exclusive access to the site and its services.","pos":[535,666]},{"content":"This is in contrast to Windows security, which requires users to have accounts in a Windows domain.","pos":[667,766]},{"content":"Instead, any user that supplies his or her credentials (the user name/password combination) can use the site and its services.","pos":[767,893]},{"content":"For a sample application, see <bpt id=\"p1\">[</bpt>Membership and Role Provider<ept id=\"p1\">](../../../../docs/framework/wcf/samples/membership-and-role-provider.md)</ept>.","pos":[900,1033],"source":"For a sample application, see [Membership and Role Provider](../../../../docs/framework/wcf/samples/membership-and-role-provider.md)."},{"content":"For information about using the <ph id=\"ph1\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> role provider feature, see <bpt id=\"p1\">[</bpt>How to: Use the ASP.NET Role Provider with a Service<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-role-provider-with-a-service.md)</ept>.","pos":[1034,1308],"source":" For information about using the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] role provider feature, see [How to: Use the ASP.NET Role Provider with a Service](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-role-provider-with-a-service.md)."},{"content":"The membership feature requires using a SQL Server database to store the user information.","pos":[1315,1405]},{"content":"The feature also includes methods for prompting with a question any users who have forgotten their password.","pos":[1406,1514]},{"content":"Windows Communication Foundation (WCF) developers can take advantage of these features for security purposes.","pos":[1521,1630]},{"content":"When integrated into an WCF application, users must supply a user name/password combination to the WCF client application.","pos":[1631,1753]},{"content":"To transfer the data to the WCF service, use a binding that supports user name/password credentials, such as the <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> (in configuration, the <bpt id=\"p1\">[</bpt><ph id=\"ph2\">\\&lt;</ph>wsHttpBinding&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md)</ept>) and set the client credential type to <ph id=\"ph3\">`UserName`</ph>.","pos":[1754,2076],"source":" To transfer the data to the WCF service, use a binding that supports user name/password credentials, such as the <xref:System.ServiceModel.WSHttpBinding> (in configuration, the [\\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md)) and set the client credential type to `UserName`."},{"content":"On the service, WCF security authenticates the user based on the user name and password, and also assigns the role specified by the <ph id=\"ph1\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> role.","pos":[2077,2272],"source":" On the service, WCF security authenticates the user based on the user name and password, and also assigns the role specified by the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] role."},{"pos":[2280,2408],"content":"[!NOTE]\n WCF does not provide methods to populate the database with user name/password combinations or other user information.","leadings":["","> "],"nodes":[{"content":"WCF does not provide methods to populate the database with user name/password combinations or other user information.","pos":[9,126]}]},{"pos":[2418,2454],"content":"To configure the membership provider","linkify":"To configure the membership provider","nodes":[{"content":"To configure the membership provider","pos":[0,36]}]},{"pos":[2464,2554],"content":"In the Web.config file, under the &lt;<ph id=\"ph1\">`system.web`</ph>&gt; element, create a &lt;<ph id=\"ph2\">`membership`</ph>&gt; element.","source":"In the Web.config file, under the <`system.web`> element, create a <`membership`> element."},{"pos":[2564,2629],"content":"Under the <ph id=\"ph1\">`&lt;membership&gt;`</ph> element, create a <ph id=\"ph2\">`&lt;providers&gt;`</ph> element.","source":"Under the `<membership>` element, create a `<providers>` element."},{"pos":[2639,2743],"content":"As a child to the &lt;<ph id=\"ph1\">`providers`</ph>&gt; element, add a <ph id=\"ph2\">`&lt;clear /&gt;`</ph> element to flush the collection of providers.","source":"As a child to the <`providers`> element, add a `<clear />` element to flush the collection of providers."},{"content":"Under the <ph id=\"ph1\">`&lt;clear /&gt;`</ph> element, create an &lt;<ph id=\"ph2\">`add`</ph>&gt; element with the following attributes set to appropriate values: <ph id=\"ph3\">`name`</ph>, <ph id=\"ph4\">`type`</ph>, <ph id=\"ph5\">`connectionStringName`</ph>, <ph id=\"ph6\">`applicationName`</ph>, <ph id=\"ph7\">`enablePasswordRetrieval`</ph>, <ph id=\"ph8\">`enablePasswordReset`</ph>, <ph id=\"ph9\">`requiresQuestionAndAnswer`</ph>, <ph id=\"ph10\">`requiresUniqueEmail`</ph>, and <ph id=\"ph11\">`passwordFormat`</ph>.","pos":[2753,3049],"source":"Under the `<clear />` element, create an <`add`> element with the following attributes set to appropriate values: `name`, `type`, `connectionStringName`, `applicationName`, `enablePasswordRetrieval`, `enablePasswordReset`, `requiresQuestionAndAnswer`, `requiresUniqueEmail`, and `passwordFormat`."},{"content":"The <ph id=\"ph1\">`name`</ph> attribute is used later as a value in the configuration file.","pos":[3050,3122],"source":" The `name` attribute is used later as a value in the configuration file."},{"content":"The following example sets it to <ph id=\"ph1\">`SqlMembershipProvider`</ph>.","pos":[3123,3180],"source":" The following example sets it to `SqlMembershipProvider`."},{"content":"The following example shows the configuration section.","pos":[3191,3245]},{"pos":[3955,4029],"content":"To configure service security to accept the user name/password combination","linkify":"To configure service security to accept the user name/password combination","nodes":[{"content":"To configure service security to accept the user name/password combination","pos":[0,74]}]},{"pos":[4039,4291],"content":"In the configuration file, under the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>system.serviceModel&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/system-servicemodel.md)</ept> element, add a <bpt id=\"p2\">[</bpt><ph id=\"ph2\">\\&lt;</ph>bindings&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/bindings.md)</ept> element.","source":"In the configuration file, under the [\\<system.serviceModel>](../../../../docs/framework/configure-apps/file-schema/wcf/system-servicemodel.md) element, add a [\\<bindings>](../../../../docs/framework/configure-apps/file-schema/wcf/bindings.md) element."},{"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>wsHttpBinding&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md)</ept> to the bindings section.","pos":[4301,4426],"source":"Add a [\\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md) to the bindings section."},{"content":"For more information about creating an WCF binding element, see <bpt id=\"p1\">[</bpt>How to: Specify a Service Binding in Configuration<ept id=\"p1\">](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md)</ept>.","pos":[4427,4629],"source":" For more information about creating an WCF binding element, see [How to: Specify a Service Binding in Configuration](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md)."},{"pos":[4639,4705],"content":"Set the <ph id=\"ph1\">`mode`</ph> attribute of the <ph id=\"ph2\">`&lt;security&gt;`</ph> element to <ph id=\"ph3\">`Message`</ph>.","source":"Set the `mode` attribute of the `<security>` element to `Message`."},{"content":"Set the <ph id=\"ph1\">`clientCredentialType`</ph> attribute of the &lt;<ph id=\"ph2\">`message`</ph>&gt; element to <ph id=\"ph3\">`UserName`</ph>.","pos":[4715,4797],"source":"Set the `clientCredentialType` attribute of the <`message`> element to `UserName`."},{"content":"This specifies that a user name/password pair will be used as the client's credential.","pos":[4798,4884]},{"content":"The following example shows the configuration code for the binding.","pos":[4895,4962]},{"pos":[5409,5462],"content":"To configure a service to use the membership provider","linkify":"To configure a service to use the membership provider","nodes":[{"content":"To configure a service to use the membership provider","pos":[0,53]}]},{"pos":[5472,5623],"content":"As a child to the <ph id=\"ph1\">`&lt;system.serviceModel&gt;`</ph> element, add a <bpt id=\"p1\">[</bpt><ph id=\"ph2\">\\&lt;</ph>behaviors&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md)</ept> element","source":"As a child to the `<system.serviceModel>` element, add a [\\<behaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/behaviors.md) element"},{"pos":[5633,5769],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceBehaviors&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md)</ept> to the &lt;<ph id=\"ph2\">`behaviors`</ph>&gt; element.","source":"Add a [\\<serviceBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md) to the <`behaviors`> element."},{"pos":[5779,5944],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>behavior&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/behavior-of-endpointbehaviors.md)</ept> and set the <ph id=\"ph2\">`name`</ph> attribute to an appropriate value.","source":"Add a [\\<behavior>](../../../../docs/framework/configure-apps/file-schema/wcf/behavior-of-endpointbehaviors.md) and set the `name` attribute to an appropriate value."},{"pos":[5954,6093],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceCredentials&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md)</ept> to the &lt;<ph id=\"ph2\">`behavior`</ph>&gt; element.","source":"Add a [\\<serviceCredentials>](../../../../docs/framework/configure-apps/file-schema/wcf/servicecredentials.md) to the <`behavior`> element."},{"pos":[6103,6260],"content":"Add a <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>userNameAuthentication&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/usernameauthentication.md)</ept> to the <ph id=\"ph2\">`&lt;serviceCredentials&gt;`</ph> element.","source":"Add a [\\<userNameAuthentication>](../../../../docs/framework/configure-apps/file-schema/wcf/usernameauthentication.md) to the `<serviceCredentials>` element."},{"pos":[6270,6345],"content":"Set the <ph id=\"ph1\">`userNamePasswordValidationMode`</ph> attribute to <ph id=\"ph2\">`MembershipProvider`</ph>.","source":"Set the `userNamePasswordValidationMode` attribute to `MembershipProvider`."},{"pos":[6357,6560],"content":"[!IMPORTANT]\nIf the `userNamePasswordValidationMode` value is not set, WCF uses Windows authentication instead of the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] membership provider.","leadings":["","    >  "],"nodes":[{"content":"If the <ph id=\"ph1\">`userNamePasswordValidationMode`</ph> value is not set, WCF uses Windows authentication instead of the <ph id=\"ph2\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> membership provider.","pos":[13,196],"source":"If the `userNamePasswordValidationMode` value is not set, WCF uses Windows authentication instead of the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] membership provider."}]},{"content":"Set the <ph id=\"ph1\">`membershipProviderName`</ph> attribute to the name of the provider (specified when adding the provider in the first procedure in this topic).","pos":[6570,6715],"source":"Set the `membershipProviderName` attribute to the name of the provider (specified when adding the provider in the first procedure in this topic)."},{"content":"The following example shows the <ph id=\"ph1\">`&lt;serviceCredentials&gt;`</ph> fragment to this point.","pos":[6716,6794],"source":" The following example shows the `<serviceCredentials>` fragment to this point."},{"pos":[7249,7256],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code shows the configuration for a service that uses the ASP membership feature.","pos":[7260,7354]},{"pos":[8606,8614],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8618,8774],"content":"<bpt id=\"p1\">[</bpt>How to: Use the ASP.NET Role Provider with a Service<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-role-provider-with-a-service.md)</ept>","source":"[How to: Use the ASP.NET Role Provider with a Service](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-role-provider-with-a-service.md)"},{"pos":[8777,8879],"content":"<bpt id=\"p1\">[</bpt>Membership and Role Provider<ept id=\"p1\">](../../../../docs/framework/wcf/samples/membership-and-role-provider.md)</ept>","source":"[Membership and Role Provider](../../../../docs/framework/wcf/samples/membership-and-role-provider.md)"}]}