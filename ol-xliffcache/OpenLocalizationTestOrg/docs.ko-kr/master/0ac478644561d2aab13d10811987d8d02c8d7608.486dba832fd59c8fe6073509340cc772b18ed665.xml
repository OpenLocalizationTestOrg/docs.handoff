{"content":"---\ntitle: \"failedQI MDA\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"failed QueryInterface\"\n  - \"FailedQI MDA\"\n  - \"QueryInterface call failures\"\n  - \"MDAs (managed debugging assistants), failed QueryInterface\"\n  - \"managed debugging assistants (MDAs), failed QueryInterface\"\nms.assetid: 902dc863-34b3-477c-b433-b8a6bb6133c6\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# failedQI MDA\nThe `failedQI` managed debugging assistant (MDA) is activated when the runtime calls `QueryInterface` on a COM interface pointer on behalf of a runtime callable wrapper (RCW), and the `QueryInterface` call fails.  \n  \n## Symptoms  \n A cast on an RCW fails, or a call to COM from an RCW fails unexpectedly.  \n  \n## Cause  \n  \n-   The call is made from the wrong context.  \n  \n-   The registered proxy is failing the `QueryInterface` call because the call was attempted in the wrong context.  \n  \n-   An OLE-owned proxy returned a failure HRESULT.  \n  \n## Resolution  \n See the MSDN documentation on COM rules.  \n  \n## Effect on the Runtime  \n If a `QueryInterface` call fails, the context is switched and the `QueryInterface` call is attempted again to see if an incorrect context was at fault.  \n  \n## Output  \n The managed name of the interface, the GUID of the interface, and the HRESULT of the failure.  \n  \n## Configuration  \n  \n```xml  \n<mdaConfig>  \n  <assistants>  \n    <failedQI/>  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## See also\n\n- <xref:System.Runtime.InteropServices.MarshalAsAttribute>\n- [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)\n- [Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)\n","nodes":[{"pos":[4,367],"embed":true,"restype":"x-metadata","content":"title: \"failedQI MDA\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"failed QueryInterface\"\n  - \"FailedQI MDA\"\n  - \"QueryInterface call failures\"\n  - \"MDAs (managed debugging assistants), failed QueryInterface\"\n  - \"managed debugging assistants (MDAs), failed QueryInterface\"\nms.assetid: 902dc863-34b3-477c-b433-b8a6bb6133c6\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"failedQI MDA","nodes":[{"pos":[0,12],"content":"failedQI MDA","nodes":[{"content":"failedQI MDA","pos":[0,12]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[374,386],"content":"failedQI MDA","linkify":"failedQI MDA","nodes":[{"content":"failedQI MDA","pos":[0,12]}]},{"pos":[387,599],"content":"The <ph id=\"ph1\">`failedQI`</ph> managed debugging assistant (MDA) is activated when the runtime calls <ph id=\"ph2\">`QueryInterface`</ph> on a COM interface pointer on behalf of a runtime callable wrapper (RCW), and the <ph id=\"ph3\">`QueryInterface`</ph> call fails.","source":"The `failedQI` managed debugging assistant (MDA) is activated when the runtime calls `QueryInterface` on a COM interface pointer on behalf of a runtime callable wrapper (RCW), and the `QueryInterface` call fails."},{"pos":[608,616],"content":"Symptoms","linkify":"Symptoms","nodes":[{"content":"Symptoms","pos":[0,8]}]},{"content":"A cast on an RCW fails, or a call to COM from an RCW fails unexpectedly.","pos":[620,692]},{"pos":[701,706],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"content":"The call is made from the wrong context.","pos":[716,756]},{"pos":[766,876],"content":"The registered proxy is failing the <ph id=\"ph1\">`QueryInterface`</ph> call because the call was attempted in the wrong context.","source":"The registered proxy is failing the `QueryInterface` call because the call was attempted in the wrong context."},{"content":"An OLE-owned proxy returned a failure HRESULT.","pos":[886,932]},{"pos":[941,951],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"content":"See the MSDN documentation on COM rules.","pos":[955,995]},{"pos":[1004,1025],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"pos":[1029,1180],"content":"If a <ph id=\"ph1\">`QueryInterface`</ph> call fails, the context is switched and the <ph id=\"ph2\">`QueryInterface`</ph> call is attempted again to see if an incorrect context was at fault.","source":"If a `QueryInterface` call fails, the context is switched and the `QueryInterface` call is attempted again to see if an incorrect context was at fault."},{"pos":[1189,1195],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"The managed name of the interface, the GUID of the interface, and the HRESULT of the failure.","pos":[1199,1292]},{"pos":[1301,1314],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[1423,1431],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1494,1647],"content":"<bpt id=\"p1\">[</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept>","source":"[Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)"},{"pos":[1650,1725],"content":"<bpt id=\"p1\">[</bpt>Interop Marshaling<ept id=\"p1\">](../../../docs/framework/interop/interop-marshaling.md)</ept>","source":"[Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)"}]}