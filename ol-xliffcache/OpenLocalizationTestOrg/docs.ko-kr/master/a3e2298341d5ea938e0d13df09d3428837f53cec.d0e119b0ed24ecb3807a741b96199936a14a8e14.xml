{"content":"---\ntitle: \"Retrieving Data from Multiple REF CURSORs Using an OracleDataReader\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"vb\"\nms.assetid: 361e9bd4-447d-44b7-8629-3c11f1a7ffbb\n---\n# Retrieving Data from Multiple REF CURSORs Using an OracleDataReader\nThis Microsoft Visual Basic example executes a PL/SQL stored procedure that returns two REF CURSOR parameters, and reads the values using an <xref:System.Data.OracleClient.OracleDataReader>.  \n  \n```vb  \nPrivate Sub Button1_Click( _  \n  ByVal sender As Object, ByVal e As System.EventArgs)  _  \n  Handles Button1.Click  \n  \n  Dim connString As New String( _  \n      \"Data Source=Oracle9i;User ID=scott;Password=tiger;\")  \n  Using conn As New OracleConnection(connString)  \n    Dim cmd As New OracleCommand()  \n    Dim rdr As OracleDataReader  \n  \n    conn.Open()  \n    cmd.Connection = conn  \n    cmd.CommandText = \"CURSPKG.OPEN_TWO_CURSORS\"  \n    cmd.CommandType = CommandType.StoredProcedure  \n    cmd.Parameters.Add(New OracleParameter( _  \n      \"EMPCURSOR\", OracleType.Cursor)).Direction = _  \n      ParameterDirection.Output  \n    cmd.Parameters.Add(New OracleParameter(_  \n      \"DEPTCURSOR\", OracleType.Cursor)).Direction = _  \n      ParameterDirection.Output  \n  \n    rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection)  \n    While (rdr.Read())  \n        REM do something with the values from the EMP table   \n    End While  \n  \n    rdr.NextResult()  \n    While (rdr.Read())  \n        REM do something with the values from the DEPT table   \n    End While  \n    rdr.Close()  \n  End Using  \nEnd Sub   \n```  \n  \n## See also\n\n- [Oracle REF CURSORs](../../../../docs/framework/data/adonet/oracle-ref-cursors.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,172],"embed":true,"restype":"x-metadata","content":"title: \"Retrieving Data from Multiple REF CURSORs Using an OracleDataReader\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"vb\"\nms.assetid: 361e9bd4-447d-44b7-8629-3c11f1a7ffbb","nodes":[{"content":"Retrieving Data from Multiple REF CURSORs Using an OracleDataReader","nodes":[{"pos":[0,67],"content":"Retrieving Data from Multiple REF CURSORs Using an OracleDataReader","nodes":[{"content":"Retrieving Data from Multiple REF CURSORs Using an OracleDataReader","pos":[0,67]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[179,246],"content":"Retrieving Data from Multiple REF CURSORs Using an OracleDataReader","linkify":"Retrieving Data from Multiple REF CURSORs Using an OracleDataReader","nodes":[{"content":"Retrieving Data from Multiple REF CURSORs Using an OracleDataReader","pos":[0,67]}]},{"pos":[247,437],"content":"This Microsoft Visual Basic example executes a PL/SQL stored procedure that returns two REF CURSOR parameters, and reads the values using an <ph id=\"ph1\">&lt;xref:System.Data.OracleClient.OracleDataReader&gt;</ph>.","source":"This Microsoft Visual Basic example executes a PL/SQL stored procedure that returns two REF CURSOR parameters, and reads the values using an <xref:System.Data.OracleClient.OracleDataReader>."},{"pos":[1573,1581],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1585,1667],"content":"<bpt id=\"p1\">[</bpt>Oracle REF CURSORs<ept id=\"p1\">](../../../../docs/framework/data/adonet/oracle-ref-cursors.md)</ept>","source":"[Oracle REF CURSORs](../../../../docs/framework/data/adonet/oracle-ref-cursors.md)"},{"pos":[1670,1774],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}