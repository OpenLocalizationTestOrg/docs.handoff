{"content":"---\ntitle: \"How to: Host a non-service workflow in IIS | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: f362562c-767d-401b-8257-916616568fd4\ncaps.latest.revision: 7\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Host a non-service workflow in IIS\nWorkflows that are not workflow services can be hosted under IIS/WAS. This is useful when you need to host a workflow written by somebody else. For example, if you rehost the workflow designer and allow users to create their own workflows.  Hosting non-service workflows in IIS provides support for features like process recycling, idle shutdown, process health monitoring, and message-based activation. Workflow services hosted in IIS contain <xref:System.ServiceModel.Activities.Receive> activities and are activated when a message is received by IIS. Non-service workflows do not contain messaging activities, and by default cannot be activated by sending a message.  You must derive a class from <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint> and define a service contract that contains operations to create an instance of the workflow. This topic will walk you through creating a simple workflow, defining a service contract a client can use to activate the workflow, and deriving a class from <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint> which uses the service contract to listen for workflow creating requests.  \n  \n### Create a simple workflow  \n  \n1.  Create a new [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] empty solution called `CreationEndpointTest`.  \n  \n2.  Add a new WCF Workflow Service Application project called `SimpleWorkflow` to the solution. The workflow designer will open.  \n  \n3.  Delete the ReceiveRequest and SendResponse activities. These activities are what makes a workflow a workflow service. Since we are not working with a workflow service, we no longer need them.  \n  \n4.  Set the DisplayName for the sequence activity to \"Sequential Workflow\".  \n  \n5.  Rename Service1.xamlx to Workflow1.xamlx.  \n  \n6.  Click the designer outside of the sequence activity, and set the Name and ConfigurationName properties to \"Workflow1\"  \n  \n7.  Drag a <xref:System.Activities.Statements.WriteLine> activity into the <xref:System.Activities.Statements.Sequence>. The <xref:System.Activities.Statements.WriteLine> activity can be found in the **Primitives** section of the toolbox. Set the <xref:System.Activities.Statements.WriteLine.Text%2A> property of the <xref:System.Activities.Statements.WriteLine> activity to \"Hello, world\".  \n  \n     The workflow should now look like the following diagram.  \n  \n     ![A simple workflow](../../../../docs/framework/wcf/feature-details/media/simpleworkflow.png \"SimpleWorkflow\")  \n  \n### Create the workflow creation service contract  \n  \n1.  Add a new class library project called `Shared` to the `CreationEndpointTest` solution.  \n  \n2.  Add a reference to System.ServiceModel.dll, System.Configuration, and System.ServiceModel.Activities to the `Shared` project.  \n  \n3.  Rename the Class1.cs file to IWorkflowCreation.cs and the following code to the file.  \n  \n    ```  \n    using System;  \n    using System.Collections.Generic;  \n    using System.Linq;  \n    using System.Text;  \n    using System.ServiceModel;  \n  \n    namespace Shared  \n    {  \n        //service contract exposed from the endpoint  \n        [ServiceContract(Name = \"IWorkflowCreation\")]  \n        public interface IWorkflowCreation  \n        {  \n            [OperationContract(Name = \"Create\")]  \n            Guid Create(IDictionary<string, object> inputs);  \n  \n            [OperationContract(Name = \"CreateWithInstanceId\", IsOneWay = true)]  \n            void CreateWithInstanceId(IDictionary<string, object> inputs, Guid instanceId);  \n        }  \n    }  \n    ```  \n  \n     This contract defines two operations both create a new instance of the non-service workflow you just created. One creates a new instance with a generated instance ID and the other allows you to specify the instance ID for the new workflow instance.  Both methods allow you to pass in parameters to the new workflow instance. This contract will be exposed by the <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint> to allow clients to create new instances of a non-service workflow.  \n  \n### Derive a class from WorkflowHostingEndpoint  \n  \n1.  Add a new class called `CreationEndpoint` derived from <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint> to the `Shared` project.  \n  \n    ```  \n    using System;  \n    using System.Collections.Generic;  \n    using System.Diagnostics;  \n    using System.Globalization;  \n    using System.ServiceModel;  \n    using System.ServiceModel.Activities;  \n    using System.ServiceModel.Channels;  \n  \n    namespace Shared  \n    {  \n        public class CreationEndpoint : WorkflowHostingEndpoint  \n        {  \n        }  \n    }  \n    ```  \n  \n2.  Add a local static <xref:System.Uri> variable called `defaultBaseUri` to the `CreationEndpoint` class.  \n  \n    ```  \n    public class CreationEndpoint : WorkflowHostingEndpoint  \n    {  \n        static Uri defaultBaseUri;  \n    }  \n    ```  \n  \n3.  Add the following constructor to the `CreationEndpoint` class. Notice we specify the `IWorkflowCreation` service contract in the call to the base constructor.  \n  \n    ```  \n    public CreationEndpoint(Binding binding, EndpointAddress address)  \n       : base(typeof(IWorkflowCreation), binding, address)  \n       {  \n       }  \n    ```  \n  \n4.  Add the following default constructor to the `CreationEndpoint` class.  \n  \n    ```  \n    public CreationEndpoint()  \n       : this(GetDefaultBinding(),  \n       new EndpointAddress(new Uri(DefaultBaseUri, new Uri(Guid.NewGuid().ToString(), UriKind.Relative))))  \n       {  \n       }  \n    ```  \n  \n5.  Add a static `DefaultBaseUri` property to the `CreationEndpoint` class. This property will be used to hold a default base URI if one is not provided.  \n  \n    ```  \n    static Uri DefaultBaseUri  \n    {  \n       get  \n       {  \n          if (defaultBaseUri == null)  \n          {  \n             defaultBaseUri = new Uri(string.Format(CultureInfo.InvariantCulture, \"net.pipe://localhost/workflowCreationEndpoint/{0}/{1}\",  \n                Process.GetCurrentProcess().Id,  \n                AppDomain.CurrentDomain.Id));  \n          }  \n          return defaultBaseUri;  \n       }  \n     }  \n    ```  \n  \n6.  Create the following method to get the default binding to use for the creation endpoint.  \n  \n    ```  \n    //defaults to NetNamedPipeBinding  \n    public static Binding GetDefaultBinding()  \n    {  \n       return new NetNamedPipeBinding(NetNamedPipeSecurityMode.None) { TransactionFlow = true };  \n    }  \n    ```  \n  \n7.  Override the <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetInstanceId%2A> method to return the workflow instance ID. If the `Action` header ends with \"Create\" return an empty GUID, if the `Action` header ends with \"CreateWithInstanceId\" return the GUID passed into the method. Otherwise, throw an <xref:System.InvalidOperationException>. These `Action` headers correspond to the two operations defined in the `IWorkflowCreation` service contract.  \n  \n    ```  \n    protected override Guid OnGetInstanceId(object[] inputs, OperationContext operationContext)  \n    {  \n       //Create was called by client  \n       if (operationContext.IncomingMessageHeaders.Action.EndsWith(\"Create\"))  \n       {  \n          return Guid.Empty;  \n       }  \n       //CreateWithInstanceId was called by client  \n       else if (operationContext.IncomingMessageHeaders.Action.EndsWith(\"CreateWithInstanceId\"))  \n       {  \n          return (Guid)inputs[1];  \n       }  \n       else  \n       {  \n          throw new InvalidOperationException(\"Invalid Action: \" + operationContext.IncomingMessageHeaders.Action);  \n       }  \n    }  \n    ```  \n  \n8.  Override the <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetCreationContext%2A> method to create a <xref:System.ServiceModel.Activities.WorkflowCreationContext> and add any arguments for the workflow, send the instance ID to the client, and then return the <xref:System.ServiceModel.Activities.WorkflowCreationContext>.  \n  \n    ```  \n    protected override WorkflowCreationContext OnGetCreationContext(object[] inputs, OperationContext operationContext, Guid instanceId, WorkflowHostingResponseContext responseContext)  \n    {  \n       WorkflowCreationContext creationContext = new WorkflowCreationContext();  \n       if (operationContext.IncomingMessageHeaders.Action.EndsWith(\"Create\") || (operationContext.IncomingMessageHeaders.Action.EndsWith(\"CreateWithInstanceId\")))  \n       {  \n          Dictionary<string, object> arguments = (Dictionary<string, object>)inputs[0];  \n          if (arguments != null && arguments.Count > 0)  \n          {  \n             foreach (KeyValuePair<string, object> pair in arguments)  \n             {  \n                //arguments to pass to the workflow  \n                creationContext.WorkflowArguments.Add(pair.Key, pair.Value);  \n             }  \n          }  \n          //reply to client with instanceId  \n          responseContext.SendResponse(instanceId, null);  \n       }  \n       else  \n       {  \n          throw new InvalidOperationException(\"Invalid Action: \" + operationContext.IncomingMessageHeaders.Action);  \n       }  \n       return creationContext;  \n    }  \n    ```  \n  \n### Create a standard endpoint element to allow you to configure the WorkflowCreationEndpoint  \n  \n1.  Add a reference to Shared in the `CreationEndpoint` project  \n  \n2.  Add a new class called `CreationEndpointElement`, derived from <xref:System.ServiceModel.Configuration.StandardEndpointElement> to the `CreationEndpoint` project. This class will represent a `CreationEndpoint` in a web.config file.  \n  \n    ```  \n    using System;  \n    using System.Configuration;  \n    using System.ServiceModel.Activities;  \n    using System.ServiceModel.Configuration;  \n    using System.ServiceModel.Description;  \n    using Shared;  \n  \n    namespace CreationEndpointTest  \n    {  \n        //config element for CreationEndpoint  \n        public class CreationEndpointElement : StandardEndpointElement  \n        {  \n       }  \n    ```  \n  \n3.  Add a property called `EndpointType` to return the type of the endpoint.  \n  \n    ```  \n    protected override Type EndpointType  \n    {  \n       get { return typeof(CreationEndpoint); }  \n    }  \n    ```  \n  \n4.  Override the <xref:System.ServiceModel.Configuration.StandardEndpointElement.CreateServiceEndpoint%2A> method and return a new `CreationEndpoint`.  \n  \n    ```  \n    protected override ServiceEndpoint CreateServiceEndpoint(ContractDescription contractDescription)  \n    {  \n       return new CreationEndpoint();  \n    }  \n  \n    ```  \n  \n5.  Overload the <xref:System.ServiceModel.Configuration.StandardEndpointElement.OnApplyConfiguration%2A>, <xref:System.ServiceModel.Configuration.StandardEndpointElement.OnApplyConfiguration%2A>, <xref:System.ServiceModel.Configuration.StandardEndpointElement.OnInitializeAndValidate%2A>, and <xref:System.ServiceModel.Configuration.StandardEndpointElement.OnInitializeAndValidate%2A> methods. These methods just need to be defined, you do not need to add any code to them.  \n  \n    ```  \n    protected override void OnApplyConfiguration(ServiceEndpoint endpoint, ChannelEndpointElement channelEndpointElement)  \n    {  \n    }  \n  \n    protected override void OnApplyConfiguration(ServiceEndpoint endpoint, ServiceEndpointElement serviceEndpointElement)  \n    {  \n    }  \n  \n    protected override void OnInitializeAndValidate(ChannelEndpointElement channelEndpointElement)  \n    {  \n    }  \n  \n    protected override void OnInitializeAndValidate(ServiceEndpointElement serviceEndpointElement)  \n    {  \n    }  \n    ```  \n  \n6.  Add the collection class for `CreationEndpoint` to the CreationEndpointElement.cs file in the `CreationEndpoint` project. This class is used by configuration to hold a number of `CreationEndpoint` instances in a web.config file.  \n  \n    ```  \n    public class CreationEndpointCollection : StandardEndpointCollectionElement<CreationEndpoint, CreationEndpointElement>  \n    {  \n    }  \n    ```  \n  \n7.  Build the solution.  \n  \n### Host the workflow in IIS  \n  \n1.  Create a new application called `MyCreationEndpoint` in IIS.  \n  \n2.  Copy the workflow1.xaml file generated by the workflow designer to the application directory and rename it to workflow1.xamlx.  \n  \n3.  Copy the shared.dll and CreationEndpoint.dll files to the application’s bin directory (create the bin directory if it is not present).  \n  \n4.  Replace the contents of the Web.config file in the `CreationEndpoint` project with the following code.  \n  \n    ```xaml  \n    <?xml version=\"1.0\" encoding=\"utf-8\" ?>  \n    <configuration>  \n      <system.web>  \n        <compilation debug=\"true\" targetFramework=\"4.0\" />  \n      </system.web>   \n    </configuration>  \n    ```  \n  \n5.  After the `<system.web>` element, register `CreationEndpoint` by adding the following configuration code.  \n  \n    ```  \n    <system.serviceModel>  \n        <!--register CreationEndpoint-->  \n        <serviceHostingEnvironment multipleSiteBindingsEnabled=\"true\" />  \n        <extensions>  \n          <endpointExtensions>  \n            <add name=\"creationEndpoint\" type=\"CreationEndpointTest.CreationEndpointCollection, CreationEndpoint, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\" />  \n          </endpointExtensions>  \n        </extensions>  \n    </system.serviceModel>  \n  \n    ```  \n  \n     This registers the `CreationEndpointCollection` class so you can configure a `CreationEndpoint` in a web.config file.  \n  \n6.  Add a `<service>` element (after the \\</extensions> tag) with a `CreationEndpoint` which will listen for incoming messages.  \n  \n    ```  \n    <services>  \n          <!-- add endpoint to service-->  \n          <service name=\"Workflow1\" behaviorConfiguration=\"basicConfig\" >  \n            <endpoint kind=\"creationEndpoint\" binding=\"basicHttpBinding\" address=\"\"/>  \n          </service>  \n        </services>  \n  \n    ```  \n  \n7.  Add a \\<behaviors> element (after the \\</services> tag) to enable service metadata.  \n  \n    ```xml  \n    <behaviors>  \n          <serviceBehaviors>  \n            <behavior name=\"basicConfig\">  \n              <serviceMetadata httpGetEnabled=\"true\" />  \n            </behavior>  \n          </serviceBehaviors>  \n        </behaviors>  \n  \n    ```  \n  \n8.  Copy the web.config to your IIS application directory.  \n  \n9. Test to see if the creation endpoint is working by starting Internet Explorer and browsing to http://localhost/MyCreationEndpoint/Workflow1.xamlx. Internet Explorer should display the following screen:  \n  \n     ![Testing the service](../../../../docs/framework/wcf/feature-details/media/testservice.gif \"TestService\")  \n  \n### Create a client that will call the CreationEndpoint.  \n  \n1.  Add a new Console application to the `CreationEndpointTest` solution.  \n  \n2.  Add references to System.ServiceModel.dll, System.ServiceModel.Activities, and the `Shared` project.  \n  \n3.  In the `Main` method create a <xref:System.ServiceModel.ChannelFactory%601> of type `IWorkflowCreation` and call <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A>. This will return a proxy. You can then call `Create` on that proxy to create the workflow instance hosted under IIS:  \n  \n    ```  \n    using System.Text;  \n    using Shared;  \n    using System.ServiceModel;  \n  \n    namespace CreationEndpointClient  \n    {  \n        class Program  \n        {  \n            static void Main(string[] args)  \n            {  \n                try  \n                {  \n                    //client using BasicHttpBinding  \n                    IWorkflowCreation client = new ChannelFactory<IWorkflowCreation>(new BasicHttpBinding(), new EndpointAddress(\"http://localhost/CreationEndpoint/Workflow1.xamlx\")).CreateChannel();  \n  \n                    Console.WriteLine(\"Workflow Instance created using CreationEndpoint added in config. Instance Id: {0}\", client.Create(null));  \n                    Console.WriteLine(\"Press return to exit ...\");  \n                    Console.ReadLine();  \n                }  \n                catch (Exception ex)  \n                {  \n                    Console.WriteLine(ex);  \n                    Console.ReadLine();  \n                }  \n            }  \n        }  \n    }  \n    ```  \n  \n4.  Run the CreationEndpointClient. The output should look like the following:  \n  \n    ```Output  \n    Workflow Instance created using CreationEndpoint added in config. Instance Id: 0875dac0-2b8b-473e-b3cc-abcb235e9693Press return to exit ...  \n    ```  \n  \n    > [!NOTE]\n    >  You will not see the output of the workflow because it is running under IIS which has no console output.  \n  \n## Example  \n The following is the complete code for this sample.  \n  \n```xaml  \n<!-— workflow1.xamlx -->  \n<WorkflowService mc:Ignorable=\"sap\"   \n                 ConfigurationName=\"Workflow1\"   \n                 sap:VirtualizedContainerService.HintSize=\"263,230\"   \n                 Name=\"Workflow1\"   \n                 mva:VisualBasic.Settings=\"Assembly references and imported namespaces serialized as XML namespaces\"   \n                 xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/servicemodel\"   \n                 xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"   \n                 xmlns:mv=\"clr-namespace:Microsoft.VisualBasic;assembly=System\"   \n                 xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\"   \n                 xmlns:p=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\"   \n                 xmlns:s=\"clr-namespace:System;assembly=mscorlib\"   \n                 xmlns:s1=\"clr-namespace:System;assembly=System\"   \n                 xmlns:s2=\"clr-namespace:System;assembly=System.Xml\"   \n                 xmlns:s3=\"clr-namespace:System;assembly=System.Core\"   \n                 xmlns:sad=\"clr-namespace:System.Activities.Debugger;assembly=System.Activities\"   \n                 xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\"   \n                 xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=System\"   \n                 xmlns:scg1=\"clr-namespace:System.Collections.Generic;assembly=System.ServiceModel\"   \n                 xmlns:scg2=\"clr-namespace:System.Collections.Generic;assembly=System.Core\"   \n                 xmlns:scg3=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\"   \n                 xmlns:sd=\"clr-namespace:System.Data;assembly=System.Data\"   \n                 xmlns:sl=\"clr-namespace:System.Linq;assembly=System.Core\"   \n                 xmlns:st=\"clr-namespace:System.Text;assembly=mscorlib\"   \n                 xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\">  \n  <p:Sequence DisplayName=\"Sequential Service\"   \n              sad:XamlDebuggerXmlReader.FileName=\"c:\\projects\\CreationEndpointTest\\CreationEndpoint\\Service1.xamlx\"   \n              sap:VirtualizedContainerService.HintSize=\"233,200\"   \n              mva:VisualBasic.Settings=\"Assembly references and imported namespaces serialized as XML namespaces\">  \n    <p:Sequence.Variables>  \n      <p:Variable x:TypeArguments=\"CorrelationHandle\" Name=\"handle\" />  \n      <p:Variable x:TypeArguments=\"x:Int32\" Name=\"data\" />  \n    </p:Sequence.Variables>  \n    <sap:WorkflowViewStateService.ViewState>  \n      <scg3:Dictionary x:TypeArguments=\"x:String, x:Object\">  \n        <x:Boolean x:Key=\"IsExpanded\">True</x:Boolean>  \n      </scg3:Dictionary>  \n    </sap:WorkflowViewStateService.ViewState>  \n    <p:WriteLine sap:VirtualizedContainerService.HintSize=\"211,61\" Text=\"Hello, world\" />  \n  </p:Sequence>  \n</WorkflowService>  \n  \n```  \n  \n```csharp  \n// CreationEndpointElement.cs  \nusing System;  \nusing System.Configuration;  \nusing System.ServiceModel.Activities;  \nusing System.ServiceModel.Configuration;  \nusing System.ServiceModel.Description;  \nusing Shared;  \n  \nnamespace CreationEndpointTest  \n{  \n    //config element for CreationEndpoint  \n    public class CreationEndpointElement : StandardEndpointElement  \n    {  \n        protected override Type EndpointType  \n        {  \n            get { return typeof(CreationEndpoint); }  \n        }  \n  \n        protected override ConfigurationPropertyCollection Properties  \n        {  \n            get  \n            {  \n                ConfigurationPropertyCollection properties = base.Properties;  \n                properties.Add(new ConfigurationProperty(\"name\", typeof(String), null, ConfigurationPropertyOptions.IsRequired));  \n                return properties;  \n            }  \n        }  \n  \n        protected override ServiceEndpoint CreateServiceEndpoint(ContractDescription contractDescription)  \n        {  \n            return new CreationEndpoint();  \n        }  \n  \n        protected override void OnApplyConfiguration(ServiceEndpoint endpoint, ChannelEndpointElement channelEndpointElement)  \n        {  \n        }  \n  \n        protected override void OnApplyConfiguration(ServiceEndpoint endpoint, ServiceEndpointElement serviceEndpointElement)  \n        {  \n        }  \n  \n        protected override void OnInitializeAndValidate(ChannelEndpointElement channelEndpointElement)  \n        {  \n        }  \n  \n        protected override void OnInitializeAndValidate(ServiceEndpointElement serviceEndpointElement)  \n        {  \n        }  \n    }  \n  \n    public class CreationEndpointCollection : StandardEndpointCollectionElement<CreationEndpoint, CreationEndpointElement>  \n    {  \n    }  \n}  \n  \n```  \n  \n```xml  \n<!-- web.config -->  \n<?xml version=\"1.0\" encoding=\"utf-8\" ?>  \n<configuration>  \n  <system.web>  \n    <compilation debug=\"true\" targetFramework=\"4.0\" />  \n  </system.web>  \n  <system.serviceModel>  \n    <!--register CreationEndpoint-->  \n    <serviceHostingEnvironment multipleSiteBindingsEnabled=\"true\" />  \n    <extensions>  \n      <endpointExtensions>  \n        <add name=\"creationEndpoint\" type=\"CreationEndpointTest.CreationEndpointCollection, Shared, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\" />  \n      </endpointExtensions>  \n    </extensions>  \n    <services>  \n      <!-- add endpoint to service-->  \n      <service name=\"Workflow1\" behaviorConfiguration=\"basicConfig\" >  \n        <endpoint kind=\"creationEndpoint\" binding=\"basicHttpBinding\" address=\"\"/>  \n      </service>  \n    </services>  \n    <behaviors>  \n      <serviceBehaviors>  \n        <behavior name=\"basicConfig\">  \n          <serviceMetadata httpGetEnabled=\"true\" />  \n        </behavior>  \n      </serviceBehaviors>  \n    </behaviors>  \n  </system.serviceModel>  \n</configuration>  \n  \n```  \n  \n```csharp  \n// IWorkflowCreation.cs  \nusing System;  \nusing System.Collections.Generic;  \nusing System.Linq;  \nusing System.Text;  \nusing System.ServiceModel;  \n  \nnamespace Shared  \n{  \n    //service contract exposed from the endpoint  \n    [ServiceContract(Name = \"IWorkflowCreation\")]  \n    public interface IWorkflowCreation  \n    {  \n        [OperationContract(Name = \"Create\")]  \n        Guid Create(IDictionary<string, object> inputs);  \n  \n        [OperationContract(Name = \"CreateWithInstanceId\", IsOneWay = true)]  \n        void CreateWithInstanceId(IDictionary<string, object> inputs, Guid instanceId);  \n    }  \n}  \n  \n```  \n  \n```csharp  \n// CreationEndpoint.cs  \nusing System;  \nusing System.Collections.Generic;  \nusing System.Linq;  \nusing System.Text;  \nusing System.ServiceModel.Activities;  \nusing System.ServiceModel.Channels;  \nusing System.ServiceModel;  \nusing System.Globalization;  \nusing System.Diagnostics;  \n  \nnamespace Shared  \n{  \n    public class CreationEndpoint : WorkflowHostingEndpoint  \n    {  \n        static Uri defaultBaseUri;  \n  \n        public CreationEndpoint(Binding binding, EndpointAddress address)  \n            : base(typeof(IWorkflowCreation), binding, address) { }  \n  \n        public CreationEndpoint()  \n            : this(GetDefaultBinding(),  \n                new EndpointAddress(new Uri(DefaultBaseUri, new Uri(Guid.NewGuid().ToString(), UriKind.Relative)))) { }  \n  \n        static Uri DefaultBaseUri  \n        {  \n            get  \n            {  \n                if (defaultBaseUri == null)  \n                {  \n                    defaultBaseUri = new Uri(string.Format(CultureInfo.InvariantCulture, \"net.pipe://localhost/workflowCreationEndpoint/{0}/{1}\",  \n                        Process.GetCurrentProcess().Id,  \n                        AppDomain.CurrentDomain.Id));  \n                }  \n                return defaultBaseUri;  \n            }  \n        }  \n  \n        //defaults to NetNamedPipeBinding  \n        public static Binding GetDefaultBinding()  \n        {  \n            return new NetNamedPipeBinding(NetNamedPipeSecurityMode.None) { TransactionFlow = true };  \n        }  \n  \n        protected override Guid OnGetInstanceId(object[] inputs, OperationContext operationContext)  \n        {  \n            //Create was called by client  \n            if (operationContext.IncomingMessageHeaders.Action.EndsWith(\"Create\"))  \n            {  \n                return Guid.Empty;  \n            }  \n  \n            //CreateWithInstanceId was called by client  \n            else if (operationContext.IncomingMessageHeaders.Action.EndsWith(\"CreateWithInstanceId\"))  \n            {  \n                return (Guid)inputs[1];  \n            }  \n            else  \n            {  \n                throw new InvalidOperationException(\"Invalid Action: \" + operationContext.IncomingMessageHeaders.Action);  \n            }  \n        }  \n  \n        protected override WorkflowCreationContext OnGetCreationContext(object[] inputs, OperationContext operationContext, Guid instanceId, WorkflowHostingResponseContext responseContext)  \n        {  \n            WorkflowCreationContext creationContext = new WorkflowCreationContext();  \n            if (operationContext.IncomingMessageHeaders.Action.EndsWith(\"Create\"))  \n            {  \n                Dictionary<string, object> arguments = (Dictionary<string, object>)inputs[0];  \n                if (arguments != null && arguments.Count > 0)  \n                {  \n                    foreach (KeyValuePair<string, object> pair in arguments)  \n                    {  \n                        //arguments to pass to the workflow  \n                        creationContext.WorkflowArguments.Add(pair.Key, pair.Value);  \n                    }  \n                }  \n                //reply to client with instanceId  \n                responseContext.SendResponse(instanceId, null);  \n            }  \n            else if (operationContext.IncomingMessageHeaders.Action.EndsWith(\"CreateWithInstanceId\"))  \n            {  \n                Dictionary<string, object> arguments = (Dictionary<string, object>)inputs[0];  \n                if (arguments != null && arguments.Count > 0)  \n                {  \n                    foreach (KeyValuePair<string, object> pair in arguments)  \n                    {  \n                        //arguments to pass to workflow  \n                        creationContext.WorkflowArguments.Add(pair.Key, pair.Value);  \n                    }  \n                }  \n            }  \n            else  \n            {  \n                throw new InvalidOperationException(\"Invalid Action: \" + operationContext.IncomingMessageHeaders.Action);  \n            }  \n            return creationContext;  \n        }  \n    }  \n}  \n  \n```  \n  \n```csharp  \n// CreationEndpointClient.cs  \nusing System;  \nusing System.Collections.Generic;  \nusing System.Linq;  \nusing System.Text;  \nusing Shared;  \nusing System.ServiceModel;  \n  \nnamespace CreationClient  \n{  \n    class Program  \n    {  \n        static void Main(string[] args)  \n        {  \n            try  \n            {  \n                //client using BasicHttpBinding  \n                IWorkflowCreation client = new ChannelFactory<IWorkflowCreation>(new BasicHttpBinding(), new EndpointAddress(\"http://localhost/MyCreationEndpoint/Workflow1.xamlx\")).CreateChannel();  \n  \n                Console.WriteLine(\"Workflow Instance created using CreationEndpoint added in config. Instance Id: {0}\", client.Create(null));  \n                Console.WriteLine(\"Press return to exit ...\");  \n                Console.ReadLine();  \n            }  \n            catch (Exception ex)  \n            {  \n                Console.WriteLine(ex);  \n                Console.ReadLine();  \n            }  \n  \n        }  \n    }  \n  \n}  \n  \n```  \n  \n This example may seem confusing because you never implement a service that implements `IWorkflowCreation`. This is because the `CreationEndpoint` does this for you.  \n  \n## See Also  \n [Workflow Services](../../../../docs/framework/wcf/feature-details/workflow-services.md)   \n [Hosting in Internet Information Services](../../../../docs/framework/wcf/feature-details/hosting-in-internet-information-services.md)   \n [Internet Information Services Hosting Best Practices](../../../../docs/framework/wcf/feature-details/internet-information-services-hosting-best-practices.md)   \n [Internet Information Service Hosting Instructions](../../../../docs/framework/wcf/samples/internet-information-service-hosting-instructions.md)   \n [Windows Workflow Architecture](../../../../docs/framework/windows-workflow-foundation/architecture.md)   \n [WorkflowHostingEndpoint Resume Bookmark](../../../../docs/framework/windows-workflow-foundation/samples/workflowhostingendpoint-resume-bookmark.md)   \n [Rehosting the Workflow Designer](../../../../docs/framework/windows-workflow-foundation/rehosting-the-workflow-designer.md)   \n [Windows Workflow Overview](../../../../docs/framework/windows-workflow-foundation/overview.md)","nodes":[{"pos":[4,362],"nodes":[{"content":"How to: Host a non-service workflow in IIS | Microsoft Docs","nodes":[{"pos":[0,59],"content":"How to: Host a non-service workflow in IIS | Microsoft Docs","nodes":[{"content":"How to: Host a non-service workflow in IIS | Microsoft Docs","pos":[0,59]}]}],"pos":[6,68],"yaml":true}],"content":"title: \"How to: Host a non-service workflow in IIS | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: f362562c-767d-401b-8257-916616568fd4\ncaps.latest.revision: 7\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","yamlblock":true},{"pos":[369,411],"content":"How to: Host a non-service workflow in IIS","linkify":"How to: Host a non-service workflow in IIS","nodes":[{"content":"How to: Host a non-service workflow in IIS","pos":[0,42]}]},{"content":"Workflows that are not workflow services can be hosted under IIS/WAS.","pos":[412,481]},{"content":"This is useful when you need to host a workflow written by somebody else.","pos":[482,555]},{"content":"For example, if you rehost the workflow designer and allow users to create their own workflows.","pos":[556,651]},{"content":"Hosting non-service workflows in IIS provides support for features like process recycling, idle shutdown, process health monitoring, and message-based activation.","pos":[653,815]},{"content":"Workflow services hosted in IIS contain <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.Receive&gt;</ph> activities and are activated when a message is received by IIS.","pos":[816,965],"source":" Workflow services hosted in IIS contain <xref:System.ServiceModel.Activities.Receive> activities and are activated when a message is received by IIS."},{"content":"Non-service workflows do not contain messaging activities, and by default cannot be activated by sending a message.","pos":[966,1081]},{"content":"You must derive a class from <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowHostingEndpoint&gt;</ph> and define a service contract that contains operations to create an instance of the workflow.","pos":[1083,1267],"source":"  You must derive a class from <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint> and define a service contract that contains operations to create an instance of the workflow."},{"content":"This topic will walk you through creating a simple workflow, defining a service contract a client can use to activate the workflow, and deriving a class from <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowHostingEndpoint&gt;</ph> which uses the service contract to listen for workflow creating requests.","pos":[1268,1561],"source":" This topic will walk you through creating a simple workflow, defining a service contract a client can use to activate the workflow, and deriving a class from <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint> which uses the service contract to listen for workflow creating requests."},{"pos":[1571,1595],"content":"Create a simple workflow","linkify":"Create a simple workflow","nodes":[{"content":"Create a simple workflow","pos":[0,24]}]},{"pos":[1605,1735],"content":"Create a new <ph id=\"ph1\">[!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)]</ph> empty solution called <ph id=\"ph2\">`CreationEndpointTest`</ph>.","source":"Create a new [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] empty solution called `CreationEndpointTest`."},{"content":"Add a new WCF Workflow Service Application project called <ph id=\"ph1\">`SimpleWorkflow`</ph> to the solution.","pos":[1745,1836],"source":"Add a new WCF Workflow Service Application project called `SimpleWorkflow` to the solution."},{"content":"The workflow designer will open.","pos":[1837,1869]},{"content":"Delete the ReceiveRequest and SendResponse activities.","pos":[1879,1933]},{"content":"These activities are what makes a workflow a workflow service.","pos":[1934,1996]},{"content":"Since we are not working with a workflow service, we no longer need them.","pos":[1997,2070]},{"content":"Set the DisplayName for the sequence activity to \"Sequential Workflow\".","pos":[2080,2151]},{"content":"Rename Service1.xamlx to Workflow1.xamlx.","pos":[2161,2202]},{"content":"Click the designer outside of the sequence activity, and set the Name and ConfigurationName properties to \"Workflow1\"","pos":[2212,2329]},{"content":"Drag a <ph id=\"ph1\">&lt;xref:System.Activities.Statements.WriteLine&gt;</ph> activity into the <ph id=\"ph2\">&lt;xref:System.Activities.Statements.Sequence&gt;</ph>.","pos":[2339,2455],"source":"Drag a <xref:System.Activities.Statements.WriteLine> activity into the <xref:System.Activities.Statements.Sequence>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Activities.Statements.WriteLine&gt;</ph> activity can be found in the <bpt id=\"p1\">**</bpt>Primitives<ept id=\"p1\">**</ept> section of the toolbox.","pos":[2456,2573],"source":" The <xref:System.Activities.Statements.WriteLine> activity can be found in the **Primitives** section of the toolbox."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Activities.Statements.WriteLine.Text%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Activities.Statements.WriteLine&gt;</ph> activity to \"Hello, world\".","pos":[2574,2725],"source":" Set the <xref:System.Activities.Statements.WriteLine.Text%2A> property of the <xref:System.Activities.Statements.WriteLine> activity to \"Hello, world\"."},{"content":"The workflow should now look like the following diagram.","pos":[2736,2792]},{"pos":[2803,2913],"content":"<bpt id=\"p1\">![</bpt>A simple workflow<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wcf/feature-details/media/simpleworkflow.png \"</bpt>SimpleWorkflow<ept id=\"p2\">\")</ept>","source":"![A simple workflow](../../../../docs/framework/wcf/feature-details/media/simpleworkflow.png \"SimpleWorkflow\")"},{"pos":[2923,2968],"content":"Create the workflow creation service contract","linkify":"Create the workflow creation service contract","nodes":[{"content":"Create the workflow creation service contract","pos":[0,45]}]},{"pos":[2978,3065],"content":"Add a new class library project called <ph id=\"ph1\">`Shared`</ph> to the <ph id=\"ph2\">`CreationEndpointTest`</ph> solution.","source":"Add a new class library project called `Shared` to the `CreationEndpointTest` solution."},{"pos":[3075,3200],"content":"Add a reference to System.ServiceModel.dll, System.Configuration, and System.ServiceModel.Activities to the <ph id=\"ph1\">`Shared`</ph> project.","source":"Add a reference to System.ServiceModel.dll, System.Configuration, and System.ServiceModel.Activities to the `Shared` project."},{"content":"Rename the Class1.cs file to IWorkflowCreation.cs and the following code to the file.","pos":[3210,3295]},{"content":"This contract defines two operations both create a new instance of the non-service workflow you just created.","pos":[3987,4096]},{"content":"One creates a new instance with a generated instance ID and the other allows you to specify the instance ID for the new workflow instance.","pos":[4097,4235]},{"content":"Both methods allow you to pass in parameters to the new workflow instance.","pos":[4237,4311]},{"content":"This contract will be exposed by the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowHostingEndpoint&gt;</ph> to allow clients to create new instances of a non-service workflow.","pos":[4312,4478],"source":" This contract will be exposed by the <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint> to allow clients to create new instances of a non-service workflow."},{"pos":[4488,4531],"content":"Derive a class from WorkflowHostingEndpoint","linkify":"Derive a class from WorkflowHostingEndpoint","nodes":[{"content":"Derive a class from WorkflowHostingEndpoint","pos":[0,43]}]},{"pos":[4541,4682],"content":"Add a new class called <ph id=\"ph1\">`CreationEndpoint`</ph> derived from <ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.WorkflowHostingEndpoint&gt;</ph> to the <ph id=\"ph3\">`Shared`</ph> project.","source":"Add a new class called `CreationEndpoint` derived from <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint> to the `Shared` project."},{"pos":[5092,5194],"content":"Add a local static <ph id=\"ph1\">&lt;xref:System.Uri&gt;</ph> variable called <ph id=\"ph2\">`defaultBaseUri`</ph> to the <ph id=\"ph3\">`CreationEndpoint`</ph> class.","source":"Add a local static <xref:System.Uri> variable called `defaultBaseUri` to the `CreationEndpoint` class."},{"content":"Add the following constructor to the <ph id=\"ph1\">`CreationEndpoint`</ph> class.","pos":[5342,5404],"source":"Add the following constructor to the `CreationEndpoint` class."},{"content":"Notice we specify the <ph id=\"ph1\">`IWorkflowCreation`</ph> service contract in the call to the base constructor.","pos":[5405,5500],"source":" Notice we specify the `IWorkflowCreation` service contract in the call to the base constructor."},{"pos":[5688,5758],"content":"Add the following default constructor to the <ph id=\"ph1\">`CreationEndpoint`</ph> class.","source":"Add the following default constructor to the `CreationEndpoint` class."},{"content":"Add a static <ph id=\"ph1\">`DefaultBaseUri`</ph> property to the <ph id=\"ph2\">`CreationEndpoint`</ph> class.","pos":[5991,6062],"source":"Add a static `DefaultBaseUri` property to the `CreationEndpoint` class."},{"content":"This property will be used to hold a default base URI if one is not provided.","pos":[6063,6140]},{"content":"Create the following method to get the default binding to use for the creation endpoint.","pos":[6599,6687]},{"content":"Override the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetInstanceId%2A&gt;</ph> method to return the workflow instance ID.","pos":[6923,7059],"source":"Override the <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetInstanceId%2A> method to return the workflow instance ID."},{"content":"If the <ph id=\"ph1\">`Action`</ph> header ends with \"Create\" return an empty GUID, if the <ph id=\"ph2\">`Action`</ph> header ends with \"CreateWithInstanceId\" return the GUID passed into the method.","pos":[7060,7219],"source":" If the `Action` header ends with \"Create\" return an empty GUID, if the `Action` header ends with \"CreateWithInstanceId\" return the GUID passed into the method."},{"content":"Otherwise, throw an <ph id=\"ph1\">&lt;xref:System.InvalidOperationException&gt;</ph>.","pos":[7220,7280],"source":" Otherwise, throw an <xref:System.InvalidOperationException>."},{"content":"These <ph id=\"ph1\">`Action`</ph> headers correspond to the two operations defined in the <ph id=\"ph2\">`IWorkflowCreation`</ph> service contract.","pos":[7281,7389],"source":" These `Action` headers correspond to the two operations defined in the `IWorkflowCreation` service contract."},{"content":"Override the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetCreationContext%2A&gt;</ph> method to create a <ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.WorkflowCreationContext&gt;</ph> and add any arguments for the workflow, send the instance ID to the client, and then return the <ph id=\"ph3\">&lt;xref:System.ServiceModel.Activities.WorkflowCreationContext&gt;</ph>.","pos":[8072,8410],"source":"Override the <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetCreationContext%2A> method to create a <xref:System.ServiceModel.Activities.WorkflowCreationContext> and add any arguments for the workflow, send the instance ID to the client, and then return the <xref:System.ServiceModel.Activities.WorkflowCreationContext>."},{"pos":[9623,9712],"content":"Create a standard endpoint element to allow you to configure the WorkflowCreationEndpoint","linkify":"Create a standard endpoint element to allow you to configure the WorkflowCreationEndpoint","nodes":[{"content":"Create a standard endpoint element to allow you to configure the WorkflowCreationEndpoint","pos":[0,89]}]},{"pos":[9722,9781],"content":"Add a reference to Shared in the <ph id=\"ph1\">`CreationEndpoint`</ph> project","source":"Add a reference to Shared in the `CreationEndpoint` project"},{"content":"Add a new class called <ph id=\"ph1\">`CreationEndpointElement`</ph>, derived from <ph id=\"ph2\">&lt;xref:System.ServiceModel.Configuration.StandardEndpointElement&gt;</ph> to the <ph id=\"ph3\">`CreationEndpoint`</ph> project.","pos":[9791,9953],"source":"Add a new class called `CreationEndpointElement`, derived from <xref:System.ServiceModel.Configuration.StandardEndpointElement> to the `CreationEndpoint` project."},{"content":"This class will represent a <ph id=\"ph1\">`CreationEndpoint`</ph> in a web.config file.","pos":[9954,10022],"source":" This class will represent a `CreationEndpoint` in a web.config file."},{"pos":[10457,10529],"content":"Add a property called <ph id=\"ph1\">`EndpointType`</ph> to return the type of the endpoint.","source":"Add a property called `EndpointType` to return the type of the endpoint."},{"pos":[10671,10817],"content":"Override the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Configuration.StandardEndpointElement.CreateServiceEndpoint%2A&gt;</ph> method and return a new <ph id=\"ph2\">`CreationEndpoint`</ph>.","source":"Override the <xref:System.ServiceModel.Configuration.StandardEndpointElement.CreateServiceEndpoint%2A> method and return a new `CreationEndpoint`."},{"content":"Overload the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Configuration.StandardEndpointElement.OnApplyConfiguration%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.ServiceModel.Configuration.StandardEndpointElement.OnApplyConfiguration%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.ServiceModel.Configuration.StandardEndpointElement.OnInitializeAndValidate%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.ServiceModel.Configuration.StandardEndpointElement.OnInitializeAndValidate%2A&gt;</ph> methods.","pos":[11013,11403],"source":"Overload the <xref:System.ServiceModel.Configuration.StandardEndpointElement.OnApplyConfiguration%2A>, <xref:System.ServiceModel.Configuration.StandardEndpointElement.OnApplyConfiguration%2A>, <xref:System.ServiceModel.Configuration.StandardEndpointElement.OnInitializeAndValidate%2A>, and <xref:System.ServiceModel.Configuration.StandardEndpointElement.OnInitializeAndValidate%2A> methods."},{"content":"These methods just need to be defined, you do not need to add any code to them.","pos":[11404,11483]},{"content":"Add the collection class for <ph id=\"ph1\">`CreationEndpoint`</ph> to the CreationEndpointElement.cs file in the <ph id=\"ph2\">`CreationEndpoint`</ph> project.","pos":[12039,12160],"source":"Add the collection class for `CreationEndpoint` to the CreationEndpointElement.cs file in the `CreationEndpoint` project."},{"content":"This class is used by configuration to hold a number of <ph id=\"ph1\">`CreationEndpoint`</ph> instances in a web.config file.","pos":[12161,12267],"source":" This class is used by configuration to hold a number of `CreationEndpoint` instances in a web.config file."},{"content":"Build the solution.","pos":[12441,12460]},{"pos":[12470,12494],"content":"Host the workflow in IIS","linkify":"Host the workflow in IIS","nodes":[{"content":"Host the workflow in IIS","pos":[0,24]}]},{"pos":[12504,12564],"content":"Create a new application called <ph id=\"ph1\">`MyCreationEndpoint`</ph> in IIS.","source":"Create a new application called `MyCreationEndpoint` in IIS."},{"content":"Copy the workflow1.xaml file generated by the workflow designer to the application directory and rename it to workflow1.xamlx.","pos":[12574,12700]},{"content":"Copy the shared.dll and CreationEndpoint.dll files to the application’s bin directory (create the bin directory if it is not present).","pos":[12710,12844]},{"pos":[12854,12956],"content":"Replace the contents of the Web.config file in the <ph id=\"ph1\">`CreationEndpoint`</ph> project with the following code.","source":"Replace the contents of the Web.config file in the `CreationEndpoint` project with the following code."},{"pos":[13189,13294],"content":"After the <ph id=\"ph1\">`&lt;system.web&gt;`</ph> element, register <ph id=\"ph2\">`CreationEndpoint`</ph> by adding the following configuration code.","source":"After the `<system.web>` element, register `CreationEndpoint` by adding the following configuration code."},{"pos":[13794,13911],"content":"This registers the <ph id=\"ph1\">`CreationEndpointCollection`</ph> class so you can configure a <ph id=\"ph2\">`CreationEndpoint`</ph> in a web.config file.","source":"This registers the `CreationEndpointCollection` class so you can configure a `CreationEndpoint` in a web.config file."},{"pos":[13921,14044],"content":"Add a <ph id=\"ph1\">`&lt;service&gt;`</ph> element (after the <ph id=\"ph2\">\\&lt;</ph>/extensions&gt; tag) with a <ph id=\"ph3\">`CreationEndpoint`</ph> which will listen for incoming messages.","source":"Add a `<service>` element (after the \\</extensions> tag) with a `CreationEndpoint` which will listen for incoming messages."},{"content":"Add a <ph id=\"ph1\">\\&lt;</ph>behaviors&gt; element (after the <ph id=\"ph2\">\\&lt;</ph>/services&gt; tag) to enable service metadata.","pos":[14350,14433],"source":"Add a \\<behaviors> element (after the \\</services> tag) to enable service metadata."},{"content":"Copy the web.config to your IIS application directory.","pos":[14704,14758]},{"content":"Test to see if the creation endpoint is working by starting Internet Explorer and browsing to http://localhost/MyCreationEndpoint/Workflow1.xamlx.","pos":[14767,14913]},{"content":"Internet Explorer should display the following screen:","pos":[14914,14968]},{"pos":[14979,15085],"content":"<bpt id=\"p1\">![</bpt>Testing the service<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wcf/feature-details/media/testservice.gif \"</bpt>TestService<ept id=\"p2\">\")</ept>","source":"![Testing the service](../../../../docs/framework/wcf/feature-details/media/testservice.gif \"TestService\")"},{"pos":[15095,15147],"content":"Create a client that will call the CreationEndpoint.","linkify":"Create a client that will call the CreationEndpoint.","nodes":[{"content":"Create a client that will call the CreationEndpoint.","pos":[0,52]}]},{"pos":[15157,15226],"content":"Add a new Console application to the <ph id=\"ph1\">`CreationEndpointTest`</ph> solution.","source":"Add a new Console application to the `CreationEndpointTest` solution."},{"pos":[15236,15336],"content":"Add references to System.ServiceModel.dll, System.ServiceModel.Activities, and the <ph id=\"ph1\">`Shared`</ph> project.","source":"Add references to System.ServiceModel.dll, System.ServiceModel.Activities, and the `Shared` project."},{"content":"In the <ph id=\"ph1\">`Main`</ph> method create a <ph id=\"ph2\">&lt;xref:System.ServiceModel.ChannelFactory%601&gt;</ph> of type <ph id=\"ph3\">`IWorkflowCreation`</ph> and call <ph id=\"ph4\">&lt;xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A&gt;</ph>.","pos":[15346,15522],"source":"In the `Main` method create a <xref:System.ServiceModel.ChannelFactory%601> of type `IWorkflowCreation` and call <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A>."},{"content":"This will return a proxy.","pos":[15523,15548]},{"content":"You can then call <ph id=\"ph1\">`Create`</ph> on that proxy to create the workflow instance hosted under IIS:","pos":[15549,15639],"source":" You can then call `Create` on that proxy to create the workflow instance hosted under IIS:"},{"content":"Run the CreationEndpointClient.","pos":[16680,16711]},{"content":"The output should look like the following:","pos":[16712,16754]},{"pos":[16941,17060],"content":"[!NOTE]\nYou will not see the output of the workflow because it is running under IIS which has no console output.","leadings":["","    >  "],"nodes":[{"content":"You will not see the output of the workflow because it is running under IIS which has no console output.","pos":[8,112]}]},{"pos":[17069,17076],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following is the complete code for this sample.","pos":[17080,17131]},{"content":"This example may seem confusing because you never implement a service that implements <ph id=\"ph1\">`IWorkflowCreation`</ph>.","pos":[28762,28868],"source":"This example may seem confusing because you never implement a service that implements `IWorkflowCreation`."},{"content":"This is because the <ph id=\"ph1\">`CreationEndpoint`</ph> does this for you.","pos":[28869,28926],"source":" This is because the `CreationEndpoint` does this for you."},{"pos":[28935,28943],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Workflow Services<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/workflow-services.md)</ept><ph id=\"ph1\"> </ph>","pos":[28947,29036],"source":"[Workflow Services](../../../../docs/framework/wcf/feature-details/workflow-services.md) "},{"content":"<bpt id=\"p1\">[</bpt>Hosting in Internet Information Services<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/hosting-in-internet-information-services.md)</ept><ph id=\"ph1\"> </ph>","pos":[29040,29175],"source":"[Hosting in Internet Information Services](../../../../docs/framework/wcf/feature-details/hosting-in-internet-information-services.md) "},{"content":"<bpt id=\"p1\">[</bpt>Internet Information Services Hosting Best Practices<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/internet-information-services-hosting-best-practices.md)</ept><ph id=\"ph1\"> </ph>","pos":[29179,29338],"source":"[Internet Information Services Hosting Best Practices](../../../../docs/framework/wcf/feature-details/internet-information-services-hosting-best-practices.md) "},{"content":"<bpt id=\"p1\">[</bpt>Internet Information Service Hosting Instructions<ept id=\"p1\">](../../../../docs/framework/wcf/samples/internet-information-service-hosting-instructions.md)</ept><ph id=\"ph1\"> </ph>","pos":[29342,29487],"source":"[Internet Information Service Hosting Instructions](../../../../docs/framework/wcf/samples/internet-information-service-hosting-instructions.md) "},{"content":"<bpt id=\"p1\">[</bpt>Windows Workflow Architecture<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/architecture.md)</ept><ph id=\"ph1\"> </ph>","pos":[29491,29595],"source":"[Windows Workflow Architecture](../../../../docs/framework/windows-workflow-foundation/architecture.md) "},{"content":"<bpt id=\"p1\">[</bpt>WorkflowHostingEndpoint Resume Bookmark<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/samples/workflowhostingendpoint-resume-bookmark.md)</ept><ph id=\"ph1\"> </ph>","pos":[29599,29748],"source":"[WorkflowHostingEndpoint Resume Bookmark](../../../../docs/framework/windows-workflow-foundation/samples/workflowhostingendpoint-resume-bookmark.md) "},{"content":"<bpt id=\"p1\">[</bpt>Rehosting the Workflow Designer<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/rehosting-the-workflow-designer.md)</ept><ph id=\"ph1\"> </ph>","pos":[29752,29877],"source":"[Rehosting the Workflow Designer](../../../../docs/framework/windows-workflow-foundation/rehosting-the-workflow-designer.md) "},{"content":"<bpt id=\"p1\">[</bpt>Windows Workflow Overview<ept id=\"p1\">](../../../../docs/framework/windows-workflow-foundation/overview.md)</ept>","pos":[29881,29976],"source":"[Windows Workflow Overview](../../../../docs/framework/windows-workflow-foundation/overview.md)"}]}