{"content":"---\ntitle: \"Using Regular Expressions with the MaskedTextBox Control in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"strings [Visual Basic], regular expressions\"\n  - \"strings [Visual Basic], masked edit\"\nms.assetid: 2a048fb0-7053-487d-b2c5-ffa5e22ed6f9\n---\n# Using Regular Expressions with the MaskedTextBox Control in Visual Basic\nThis example demonstrates how to convert simple regular expressions to work with the <xref:System.Windows.Forms.MaskedTextBox> control.  \n  \n## Description of the Masking Language  \n The standard <xref:System.Windows.Forms.MaskedTextBox> masking language is based on the one used by the `Masked Edit` control in Visual Basic 6.0 and should be familiar to users migrating from that platform.  \n  \n The <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property of the <xref:System.Windows.Forms.MaskedTextBox> control specifies what input mask to use. The mask must be a string composed of one or more of the masking elements from the following table.  \n  \n|Masking element|Description|Regular expression element|  \n|---------------------|-----------------|--------------------------------|  \n|0|Any single digit between 0 and 9. Entry required.|\\d|  \n|9|Digit or space. Entry optional.|[ \\d]?|  \n|#|Digit or space. Entry optional. If this position is left blank in the mask, it will be rendered as a space. Plus (+) and minus (-) signs are allowed.|[ \\d+-]?|  \n|L|ASCII letter. Entry required.|[a-zA-Z]|  \n|?|ASCII letter. Entry optional.|[a-zA-Z]?|  \n|&|Character. Entry required.|[\\p{Ll}\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}]|  \n|C|Character. Entry optional.|[\\p{Ll}\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}]?|  \n|A|Alphanumeric. Entry optional.|\\W|  \n|.|Culture-appropriate decimal placeholder.|Not available.|  \n|,|Culture-appropriate thousands placeholder.|Not available.|  \n|:|Culture-appropriate time separator.|Not available.|  \n|/|Culture-appropriate date separator.|Not available.|  \n|$|Culture-appropriate currency symbol.|Not available.|  \n|\\<|Converts all characters that follow to lowercase.|Not available.|  \n|>|Converts all characters that follow to uppercase.|Not available.|  \n|&#124;|Undoes a previous shift up or shift down.|Not available.|  \n|&#92;|Escapes a mask character, turning it into a literal. \"\\\\\\\\\" is the escape sequence for a backslash.|&#92;|  \n|All other characters.|Literals. All non-mask elements will appear as themselves within <xref:System.Windows.Forms.MaskedTextBox>.|All other characters.|  \n  \n The decimal (.), thousandths (,), time (:), date (/), and currency ($) symbols default to displaying those symbols as defined by the application's culture. You can force them to display symbols for another culture by using the <xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A> property.  \n  \n## Regular Expressions and Masks  \n Although you can use regular expressions and masks to validate user input, they are not completely equivalent. Regular expressions can express more complex patterns than masks, but masks can express the same information more succinctly and in a culturally relevant format.  \n  \n The following table compares four regular expressions and the equivalent mask for each.  \n  \n|Regular Expression|Mask|Notes|  \n|------------------------|----------|-----------|  \n|`\\d{2}/\\d{2}/\\d{4}`|`00/00/0000`|The `/` character in the mask is a logical date separator, and it will appear to the user as the date separator appropriate to the application's current culture.|  \n|`\\d{2}-[A-Z][a-z]{2}-\\d{4}`|`00->L<LL-0000`|A date (day, month abbreviation, and year) in United States format in which the three-letter month abbreviation is displayed with an initial uppercase letter followed by two lowercase letters.|  \n|`(\\(\\d{3}\\)-)?\\d{3}-d{4}`|`(999)-000-0000`|United States phone number, area code optional. If the user does not wish to enter the optional characters, she can either enter spaces or place the mouse pointer directly at the position in the mask represented by the first 0.|  \n|`$\\d{6}.00`|`$999,999.00`|A currency value in the range of 0 to 999999. The currency, thousandth, and decimal characters will be replaced at run-time with their culture-specific equivalents.|  \n  \n## See also\n\n- <xref:System.Windows.Forms.MaskedTextBox.Mask%2A>\n- <xref:System.Windows.Forms.MaskedTextBox>\n- [Validating Strings in Visual Basic](../../../../visual-basic/programming-guide/language-features/strings/validating-strings.md)\n- [MaskedTextBox Control](../../../../framework/winforms/controls/maskedtextbox-control-windows-forms.md)\n","nodes":[{"pos":[4,268],"embed":true,"restype":"x-metadata","content":"title: \"Using Regular Expressions with the MaskedTextBox Control in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"strings [Visual Basic], regular expressions\"\n  - \"strings [Visual Basic], masked edit\"\nms.assetid: 2a048fb0-7053-487d-b2c5-ffa5e22ed6f9","nodes":[{"content":"Using Regular Expressions with the MaskedTextBox Control in Visual Basic","nodes":[{"pos":[0,72],"content":"Using Regular Expressions with the MaskedTextBox Control in Visual Basic","nodes":[{"content":"Using Regular Expressions with the MaskedTextBox Control in Visual Basic","pos":[0,72]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[275,347],"content":"Using Regular Expressions with the MaskedTextBox Control in Visual Basic","linkify":"Using Regular Expressions with the MaskedTextBox Control in Visual Basic","nodes":[{"content":"Using Regular Expressions with the MaskedTextBox Control in Visual Basic","pos":[0,72]}]},{"pos":[348,483],"content":"This example demonstrates how to convert simple regular expressions to work with the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph> control.","source":"This example demonstrates how to convert simple regular expressions to work with the <xref:System.Windows.Forms.MaskedTextBox> control."},{"pos":[492,527],"content":"Description of the Masking Language","linkify":"Description of the Masking Language","nodes":[{"content":"Description of the Masking Language","pos":[0,35]}]},{"pos":[531,738],"content":"The standard <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph> masking language is based on the one used by the <ph id=\"ph2\">`Masked Edit`</ph> control in Visual Basic 6.0 and should be familiar to users migrating from that platform.","source":"The standard <xref:System.Windows.Forms.MaskedTextBox> masking language is based on the one used by the `Masked Edit` control in Visual Basic 6.0 and should be familiar to users migrating from that platform."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox.Mask%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph> control specifies what input mask to use.","pos":[745,898],"source":"The <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property of the <xref:System.Windows.Forms.MaskedTextBox> control specifies what input mask to use."},{"content":"The mask must be a string composed of one or more of the masking elements from the following table.","pos":[899,998]},{"content":"Masking element","pos":[1005,1020]},{"content":"Description","pos":[1021,1032]},{"content":"Regular expression element","pos":[1033,1059]},{"content":"0","pos":[1141,1142]},{"content":"Any single digit between 0 and 9.","pos":[1143,1176]},{"content":"Entry required.","pos":[1177,1192]},{"content":"\\d","pos":[1193,1195]},{"content":"9","pos":[1200,1201]},{"content":"Digit or space.","pos":[1202,1217]},{"content":"Entry optional.","pos":[1218,1233]},{"content":"[ \\d]?","pos":[1234,1240]},{"content":"Digit or space.","pos":[1247,1262]},{"content":"Entry optional.","pos":[1263,1278]},{"content":"If this position is left blank in the mask, it will be rendered as a space.","pos":[1279,1354]},{"content":"Plus (+) and minus (-) signs are allowed.","pos":[1355,1396]},{"content":"[ \\d+-]?","pos":[1397,1405]},{"content":"L","pos":[1410,1411]},{"content":"ASCII letter.","pos":[1412,1425]},{"content":"Entry required.","pos":[1426,1441]},{"content":"[a-zA-Z]","pos":[1442,1450]},{"content":"?","pos":[1455,1456]},{"content":"ASCII letter.","pos":[1457,1470]},{"content":"Entry optional.","pos":[1471,1486]},{"content":"[a-zA-Z]?","pos":[1487,1496]},{"content":"Character.","pos":[1503,1513]},{"content":"Entry required.","pos":[1514,1529]},{"content":"[\\p{Ll}\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}]","pos":[1530,1562]},{"content":"C","pos":[1567,1568]},{"content":"Character.","pos":[1569,1579]},{"content":"Entry optional.","pos":[1580,1595]},{"content":"[\\p{Ll}\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}]?","pos":[1596,1629]},{"content":"A","pos":[1634,1635]},{"content":"Alphanumeric.","pos":[1636,1649]},{"content":"Entry optional.","pos":[1650,1665]},{"content":"\\W","pos":[1666,1668]},{"content":".","pos":[1673,1674]},{"content":"Culture-appropriate decimal placeholder.","pos":[1675,1715]},{"content":"Not available.","pos":[1716,1730]},{"content":",","pos":[1735,1736]},{"content":"Culture-appropriate thousands placeholder.","pos":[1737,1779]},{"content":"Not available.","pos":[1780,1794]},{"content":":","pos":[1799,1800]},{"content":"Culture-appropriate time separator.","pos":[1801,1836]},{"content":"Not available.","pos":[1837,1851]},{"content":"Culture-appropriate date separator.","pos":[1858,1893]},{"content":"Not available.","pos":[1894,1908]},{"content":"Culture-appropriate currency symbol.","pos":[1915,1951]},{"content":"Not available.","pos":[1952,1966]},{"content":"Converts all characters that follow to lowercase.","pos":[1974,2023]},{"content":"Not available.","pos":[2024,2038]},{"content":"Converts all characters that follow to uppercase.","pos":[2045,2094]},{"content":"Not available.","pos":[2095,2109]},{"content":"&amp;#124;","pos":[2114,2120],"source":"&#124;"},{"content":"Undoes a previous shift up or shift down.","pos":[2121,2162]},{"content":"Not available.","pos":[2163,2177]},{"content":"&amp;#92;","pos":[2182,2187],"source":"&#92;"},{"content":"Escapes a mask character, turning it into a literal.","pos":[2188,2240]},{"content":"\"<ph id=\"ph1\">\\\\</ph><ph id=\"ph2\">\\\\</ph>\" is the escape sequence for a backslash.","pos":[2241,2287],"source":" \"\\\\\\\\\" is the escape sequence for a backslash."},{"content":"&amp;#92;","pos":[2288,2293],"source":"&#92;"},{"content":"All other characters.","pos":[2298,2319]},{"content":"Literals.","pos":[2320,2329]},{"content":"All non-mask elements will appear as themselves within <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph>.","pos":[2330,2427],"source":" All non-mask elements will appear as themselves within <xref:System.Windows.Forms.MaskedTextBox>."},{"content":"All other characters.","pos":[2428,2449]},{"content":"The decimal (.), thousandths (,), time (:), date (/), and currency ($) symbols default to displaying those symbols as defined by the application's culture.","pos":[2457,2612]},{"content":"You can force them to display symbols for another culture by using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A&gt;</ph> property.","pos":[2613,2753],"source":" You can force them to display symbols for another culture by using the <xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A> property."},{"pos":[2762,2791],"content":"Regular Expressions and Masks","linkify":"Regular Expressions and Masks","nodes":[{"content":"Regular Expressions and Masks","pos":[0,29]}]},{"content":"Although you can use regular expressions and masks to validate user input, they are not completely equivalent.","pos":[2795,2905]},{"content":"Regular expressions can express more complex patterns than masks, but masks can express the same information more succinctly and in a culturally relevant format.","pos":[2906,3067]},{"content":"The following table compares four regular expressions and the equivalent mask for each.","pos":[3074,3161]},{"content":"Regular Expression","pos":[3168,3186]},{"content":"Mask","pos":[3187,3191]},{"content":"Notes","pos":[3192,3197]},{"pos":[3287,3448],"content":"The <ph id=\"ph1\">`/`</ph> character in the mask is a logical date separator, and it will appear to the user as the date separator appropriate to the application's current culture.","source":"The `/` character in the mask is a logical date separator, and it will appear to the user as the date separator appropriate to the application's current culture."},{"content":"A date (day, month abbreviation, and year) in United States format in which the three-letter month abbreviation is displayed with an initial uppercase letter followed by two lowercase letters.","pos":[3497,3689]},{"content":"United States phone number, area code optional.","pos":[3737,3784]},{"content":"If the user does not wish to enter the optional characters, she can either enter spaces or place the mouse pointer directly at the position in the mask represented by the first 0.","pos":[3785,3964]},{"content":"A currency value in the range of 0 to 999999.","pos":[3995,4040]},{"content":"The currency, thousandth, and decimal characters will be replaced at run-time with their culture-specific equivalents.","pos":[4041,4159]},{"pos":[4169,4177],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4277,4405],"content":"<bpt id=\"p1\">[</bpt>Validating Strings in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/strings/validating-strings.md)</ept>","source":"[Validating Strings in Visual Basic](../../../../visual-basic/programming-guide/language-features/strings/validating-strings.md)"},{"pos":[4408,4511],"content":"<bpt id=\"p1\">[</bpt>MaskedTextBox Control<ept id=\"p1\">](../../../../framework/winforms/controls/maskedtextbox-control-windows-forms.md)</ept>","source":"[MaskedTextBox Control](../../../../framework/winforms/controls/maskedtextbox-control-windows-forms.md)"}]}