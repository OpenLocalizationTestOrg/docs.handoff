{"content":"---\ntitle: \"GetRequestedRuntimeInfo Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"GetRequestedRuntimeInfo\"\napi_location: \n  - \"mscoree.dll\"\n  - \"mscoreei.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"GetRequestedRuntimeInfo\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetRequestedRuntimeInfo function [.NET Framework hosting]\"\nms.assetid: 0dfd7cdc-c116-4e25-b56a-ac7b0378c942\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 22\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# GetRequestedRuntimeInfo Function\nGets version and directory information about the common language runtime (CLR) requested by an application.  \n  \n This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)].  \n  \n## Syntax  \n  \n```  \nHRESULT GetRequestedRuntimeInfo (  \n    [in]  LPCWSTR  pExe,   \n    [in]  LPCWSTR  pwszVersion,   \n    [in]  LPCWSTR  pConfigurationFile,   \n    [in]  DWORD    startupFlags,   \n    [in]  DWORD    runtimeInfoFlags,   \n    [out] LPWSTR   pDirectory,   \n    [in]  DWORD    dwDirectory,   \n    [out] DWORD   *dwDirectoryLength,   \n    [out] LPWSTR   pVersion,   \n    [in]  DWORD    cchBuffer,   \n    [out] DWORD   *dwlength  \n);  \n```  \n  \n#### Parameters  \n `pExe`  \n [in] The name of the application.  \n  \n `pwszVersion`  \n [in] A string specifying the version number of the runtime.  \n  \n `pConfigurationFile`  \n [in] The name of the configuration file that is associated with `pExe`.  \n  \n `startupFlags`  \n [in] One or more of the [STARTUP_FLAGS](../../../../docs/framework/unmanaged-api/hosting/startup-flags-enumeration.md) enumeration values.  \n  \n `runtimeInfoFlags`  \n [in] One or more of the [RUNTIME_INFO_FLAGS](../../../../docs/framework/unmanaged-api/hosting/runtime-info-flags-enumeration.md) enumeration values.  \n  \n `pDirectory`  \n [out] A buffer that contains the directory path to the runtime upon successful completion.  \n  \n `dwDirectory`  \n [in] The length of the directory buffer.  \n  \n `dwDirectoryLength`  \n [out] A pointer to the length of the directory path string.  \n  \n `pVersion`  \n [out] A buffer that contains the version number of the runtime upon successful completion.  \n  \n `cchBuffer`  \n [in] The length of the version string buffer.  \n  \n `dwlength`  \n [out] A pointer to the length of the version string.  \n  \n## Return Value  \n This method returns standard Component Object Model (COM) error codes, as defined in WinError.h, in addition to the following values.  \n  \n|Return code|Description|  \n|-----------------|-----------------|  \n|S_OK|The method completed successfully.|  \n|ERROR_INSUFFICIENT_BUFFER|The directory buffer is not large enough to store the directory path.<br /><br /> - or -<br /><br /> The version buffer is not large enough to store the version string.|  \n  \n## Remarks  \n The `GetRequestedRuntimeInfo` method returns run-time information about the version loaded into the process, which is not necessarily the latest version installed on the computer.  \n  \n In the .NET Framework version 2.0, you can get information about the latest installed version by using the `GetRequestedRuntimeInfo` method as follows:  \n  \n-   Specify the `pExe`, `pwszVersion`, and `pConfigurationFile` parameters as null.  \n  \n-   Specify the RUNTIME_INFO_UPGRADE_VERSION flag in the `RUNTIME_INFO_FLAGS` enumerations for the `runtimeInfoFlags` parameter.  \n  \n The `GetRequestedRuntimeInfo` method does not return the latest CLR version in the following circumstances:  \n  \n-   An application configuration file that specifies loading a particular CLR version exists. Note that the .NET Framework will use the configuration file even if you specify null for the `pConfigurationFile` parameter.  \n  \n-   The [CorBindToRuntimeEx](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md) method was called specifying an earlier CLR version.  \n  \n-   An application that was compiled for an earlier CLR version is currently running.  \n  \n For the `runtimeInfoFlags` parameter, you can specify only one of the architecture constants of the `RUNTIME_INFO_FLAGS` enumeration at a time:  \n  \n-   RUNTIME_INFO_REQUEST_IA64  \n  \n-   RUNTIME_INFO_REQUEST_AMD64  \n  \n-   RUNTIME_INFO_REQUEST_X86  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]  \n  \n## See Also  \n [GetRequestedRuntimeVersion Function](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md)   \n [GetVersionFromProcess Function](../../../../docs/framework/unmanaged-api/hosting/getversionfromprocess-function.md)   \n [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)","nodes":[{"pos":[12,61],"content":"GetRequestedRuntimeInfo Function | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"GetRequestedRuntimeInfo Function | Microsoft Docs","pos":[0,49]}]},{"pos":[665,697],"content":"GetRequestedRuntimeInfo Function","linkify":"GetRequestedRuntimeInfo Function","nodes":[{"content":"GetRequestedRuntimeInfo Function","pos":[0,32]}]},{"content":"Gets version and directory information about the common language runtime (CLR) requested by an application.","pos":[698,805]},{"pos":[812,919],"content":"This function has been deprecated in the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph>.","source":"This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]."},{"pos":[928,934],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1387,1397],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The name of the application.","pos":[1411,1444]},{"content":"[in] A string specifying the version number of the runtime.","pos":[1468,1527]},{"content":"[in] The name of the configuration file that is associated with <ph id=\"ph1\">`pExe`</ph>.","pos":[1558,1629],"source":" [in] The name of the configuration file that is associated with `pExe`."},{"content":"[in] One or more of the <bpt id=\"p1\">[</bpt>STARTUP_FLAGS<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/startup-flags-enumeration.md)</ept> enumeration values.","pos":[1654,1792],"source":" [in] One or more of the [STARTUP_FLAGS](../../../../docs/framework/unmanaged-api/hosting/startup-flags-enumeration.md) enumeration values."},{"content":"[in] One or more of the <bpt id=\"p1\">[</bpt>RUNTIME_INFO_FLAGS<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/runtime-info-flags-enumeration.md)</ept> enumeration values.","pos":[1821,1969],"source":" [in] One or more of the [RUNTIME_INFO_FLAGS](../../../../docs/framework/unmanaged-api/hosting/runtime-info-flags-enumeration.md) enumeration values."},{"content":"[out] A buffer that contains the directory path to the runtime upon successful completion.","pos":[1992,2082]},{"content":"[in] The length of the directory buffer.","pos":[2106,2146]},{"content":"[out] A pointer to the length of the directory path string.","pos":[2176,2235]},{"content":"[out] A buffer that contains the version number of the runtime upon successful completion.","pos":[2256,2346]},{"content":"[in] The length of the version string buffer.","pos":[2368,2413]},{"content":"[out] A pointer to the length of the version string.","pos":[2434,2486]},{"pos":[2495,2507],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns standard Component Object Model (COM) error codes, as defined in WinError.h, in addition to the following values.","pos":[2511,2644]},{"content":"Return code","pos":[2651,2662]},{"content":"Description","pos":[2663,2674]},{"content":"S_OK","pos":[2719,2723]},{"content":"The method completed successfully.","pos":[2724,2758]},{"content":"ERROR_INSUFFICIENT_BUFFER","pos":[2763,2788]},{"content":"The directory buffer is not large enough to store the directory path.","pos":[2789,2858]},{"content":"- or -","pos":[2871,2877]},{"content":"The version buffer is not large enough to store the version string.","pos":[2890,2957]},{"pos":[2967,2974],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2978,3157],"content":"The <ph id=\"ph1\">`GetRequestedRuntimeInfo`</ph> method returns run-time information about the version loaded into the process, which is not necessarily the latest version installed on the computer.","source":"The `GetRequestedRuntimeInfo` method returns run-time information about the version loaded into the process, which is not necessarily the latest version installed on the computer."},{"pos":[3164,3315],"content":"In the .NET Framework version 2.0, you can get information about the latest installed version by using the <ph id=\"ph1\">`GetRequestedRuntimeInfo`</ph> method as follows:","source":"In the .NET Framework version 2.0, you can get information about the latest installed version by using the `GetRequestedRuntimeInfo` method as follows:"},{"pos":[3325,3404],"content":"Specify the <ph id=\"ph1\">`pExe`</ph>, <ph id=\"ph2\">`pwszVersion`</ph>, and <ph id=\"ph3\">`pConfigurationFile`</ph> parameters as null.","source":"Specify the `pExe`, `pwszVersion`, and `pConfigurationFile` parameters as null."},{"pos":[3414,3538],"content":"Specify the RUNTIME_INFO_UPGRADE_VERSION flag in the <ph id=\"ph1\">`RUNTIME_INFO_FLAGS`</ph> enumerations for the <ph id=\"ph2\">`runtimeInfoFlags`</ph> parameter.","source":"Specify the RUNTIME_INFO_UPGRADE_VERSION flag in the `RUNTIME_INFO_FLAGS` enumerations for the `runtimeInfoFlags` parameter."},{"pos":[3545,3652],"content":"The <ph id=\"ph1\">`GetRequestedRuntimeInfo`</ph> method does not return the latest CLR version in the following circumstances:","source":"The `GetRequestedRuntimeInfo` method does not return the latest CLR version in the following circumstances:"},{"content":"An application configuration file that specifies loading a particular CLR version exists.","pos":[3662,3751]},{"content":"Note that the .NET Framework will use the configuration file even if you specify null for the <ph id=\"ph1\">`pConfigurationFile`</ph> parameter.","pos":[3752,3877],"source":" Note that the .NET Framework will use the configuration file even if you specify null for the `pConfigurationFile` parameter."},{"pos":[3887,4045],"content":"The <bpt id=\"p1\">[</bpt>CorBindToRuntimeEx<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)</ept> method was called specifying an earlier CLR version.","source":"The [CorBindToRuntimeEx](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md) method was called specifying an earlier CLR version."},{"content":"An application that was compiled for an earlier CLR version is currently running.","pos":[4055,4136]},{"pos":[4143,4286],"content":"For the <ph id=\"ph1\">`runtimeInfoFlags`</ph> parameter, you can specify only one of the architecture constants of the <ph id=\"ph2\">`RUNTIME_INFO_FLAGS`</ph> enumeration at a time:","source":"For the `runtimeInfoFlags` parameter, you can specify only one of the architecture constants of the `RUNTIME_INFO_FLAGS` enumeration at a time:"},{"content":"RUNTIME_INFO_REQUEST_IA64","pos":[4296,4321]},{"content":"RUNTIME_INFO_REQUEST_AMD64","pos":[4331,4357]},{"content":"RUNTIME_INFO_REQUEST_X86","pos":[4367,4391]},{"pos":[4400,4412],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4416,4520],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[4527,4548],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[4555,4579],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> MSCorEE.dll","source":"**Library:** MSCorEE.dll"},{"pos":[4586,4694],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]"},{"pos":[4703,4711],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>GetRequestedRuntimeVersion Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md)</ept><ph id=\"ph1\"> </ph>","pos":[4715,4842],"source":"[GetRequestedRuntimeVersion Function](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md) "},{"content":"<bpt id=\"p1\"> [</bpt>GetVersionFromProcess Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/getversionfromprocess-function.md)</ept><ph id=\"ph1\"> </ph>","pos":[4845,4963],"source":" [GetVersionFromProcess Function](../../../../docs/framework/unmanaged-api/hosting/getversionfromprocess-function.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Deprecated CLR Hosting Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)</ept>","pos":[4966,5087],"source":" [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)"}]}