{"content":"---\ntitle: \"WPF XAML Browser Applications Overview\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"XBAP [WPF], XAML browser application\"\n  - \"WPF XAML browser applications (XBAP)\"\n  - \"XAML browser applications (XBAP)\"\n  - \"browser-hosted applications [WPF]\"\nms.assetid: 3a7a86a8-75d5-4898-96b9-73da151e5e16\n---\n# WPF XAML Browser Applications Overview\n<a name=\"introduction\"></a>\n[!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] combines features of both Web applications and rich-client applications. Like Web applications, XBAPs can be deployed to a Web server and started from Internet Explorer or Firefox. Like rich-client applications, XBAPs can take advantage of the capabilities of WPF. Developing XBAPs is also similar to rich-client development. This topic provides a simple, high-level introduction to XBAP development and describes where XBAP development differs from standard rich-client development.  \n  \n This topic contains the following sections:  \n  \n-   [Creating a New XAML Browser Application (XBAP)](#creating_a_new_xaml_browser_application_xbap)  \n  \n-   [Deploying an XBAP](#deploying_a_xbap)  \n  \n-   [Communicating with the Host Web Page](#communicating_with_the_host_web_page)  \n  \n-   [XBAP Security Considerations](#xbap_security_considerations)  \n  \n-   [XBAP Start Time Performance Considerations](#xbap_start_time_performance_considerations)  \n  \n<a name=\"creating_a_new_xaml_browser_application_xbap\"></a>   \n## Creating a New XAML Browser Application (XBAP)  \n The simplest way to create a new XBAP project is with Microsoft Visual Studio. When creating a new project, select **WPF Browser Application** from the list of templates. For more information, see [How to: Create a New WPF Browser Application Project](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/bb628663(v=vs.100)).  \n  \n When you run the XBAP project, it opens in a browser window instead of a stand-alone window. When you debug the XBAP from Visual Studio, the application runs with Internet zone permission and will therefore throw security exceptions if those permissions are exceeded. For more information, see [Security](../security-wpf.md) and [WPF Partial Trust Security](../wpf-partial-trust-security.md).  \n  \n> [!NOTE]\n>  If you are not developing with Visual Studio or want to learn more about the project files, see [Building a WPF Application](building-a-wpf-application-wpf.md).  \n  \n<a name=\"deploying_a_xbap\"></a>   \n## Deploying an XBAP  \n When you build an XBAP, the output includes the following three files:  \n  \n|File|Description|  \n|----------|-----------------|  \n|Executable (.exe)|This contains the compiled code and has an .exe extension.|  \n|Application manifest (.manifest)|This contains metadata associated with the application and has a .manifest extension.|  \n|Deployment manifest (.xbap)|This file contains the information that ClickOnce uses to deploy the application and has the .xbap extension.|  \n  \n You deploy XBAPs to a Web server, for example [!INCLUDE[TLA#tla_iis50](../../../../includes/tlasharptla-iis50-md.md)] or later versions. You do not have to install the .NET Framework on the Web server, but you do have to register the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA#tla_mime](../../../../includes/tlasharptla-mime-md.md)] types and file name extensions. For more information, see [Configure IIS 5.0 and IIS 6.0 to Deploy WPF Applications](how-to-configure-iis-5-0-and-iis-6-0-to-deploy-wpf-applications.md).  \n  \n To prepare your XBAP for deployment, copy the .exe and the associated manifests to the Web server. Create an HTML page that contains a hyperlink to open the deployment manifest, which is the file that has the .xbap extension. When the user clicks the link to the .xbap file, ClickOnce automatically handles the mechanics of downloading and starting the application. The following example code shows an HTML page that contains a hyperlink that points to an XBAP.  \n  \n```html\n<html>   \n    <head></head>  \n    <body>   \n        <a href=\"XbapEx.xbap\">Click this link to launch the application</a>  \n    </body>   \n</html>  \n```  \n  \n You can also host an XBAP in the frame of a Web page. Create a Web page with one or more frames. Set the source property of a frame to the deployment manifest file. If you want to use the built-in mechanism to communicate between the hosting Web page and the XBAP, you must host the application in a frame. The following example code shows an HTML page with two frames, the source for the second frame is set to an XBAP.  \n  \n```html\n<html>   \n    <head>\n        <title>A page with frames</title>\n    </head>  \n    <frameset cols=\"50%,50%\">   \n        <frame src=\"introduction.htm\">   \n        <frame src=\"XbapEx.xbap\">   \n    </frameset>   \n</html>  \n```  \n  \n### Clearing Cached XBAPs  \n In some situations after rebuilding and starting your XBAP, you may find that an earlier version of the XBAP is opened. For example, this behavior may occur when your XBAP assembly version number is static and you start the XBAP from the command line. In this case, because the version number between the cached version (the version that was previously started) and the new version remains the same, the new version of the XBAP is not downloaded. Instead, the cached version is loaded.  \n  \n In these situations, you can remove the cached version by using the **Mage** command (installed with Visual Studio or the Windows SDK) at the command prompt. The following command clears the application cache.  \n  \n ```console\n Mage.exe -cc\n ```\n  \n This command guarantees that the latest version of your XBAP is started. When you debug your application in Visual Studio, the latest version of your XBAP should be started. In general, you should update your deployment version number with each build. For more information about Mage, see [Mage.exe (Manifest Generation and Editing Tool)](../../tools/mage-exe-manifest-generation-and-editing-tool.md).  \n  \n<a name=\"communicating_with_the_host_web_page\"></a>   \n## Communicating with the Host Web Page  \n When the application is hosted in an HTML frame, you can communicate with the Web page that contains the XBAP. You do this by retrieving the <xref:System.Windows.Interop.BrowserInteropHelper.HostScript%2A> property of <xref:System.Windows.Interop.BrowserInteropHelper>. This property returns a script object that represents the HTML window. You can then access the properties, methods, and events on the [window object](https://go.microsoft.com/fwlink/?LinkId=160274) by using regular dot syntax. You can also access script methods and global variables. The following example shows how to retrieve the script object and close the browser.  \n  \n [!code-csharp[XbapBrowserInterop#10](~/samples/snippets/csharp/VS_Snippets_Wpf/xbapbrowserinterop/cs/page1.xaml.cs#10)]\n [!code-vb[XbapBrowserInterop#10](~/samples/snippets/visualbasic/VS_Snippets_Wpf/xbapbrowserinterop/vb/page1.xaml.vb#10)]  \n  \n### Debugging XBAPs that Use HostScript  \n If your XBAP uses the <xref:System.Windows.Interop.BrowserInteropHelper.HostScript%2A> object to communicate with the HTML window, there are two settings that you must specify to run and debug the application in Visual Studio. The application must have access to its site of origin and you must start the application with the HTML page that contains the XBAP. The following steps describe how to check these two settings:  \n  \n1.  In Visual Studio, open the project properties.  \n  \n2.  On the **Security** tab, click **Advanced**.  \n  \n     The Advanced Security Settings dialog box appears.  \n  \n3.  Make sure that the **Grant the application access to its site of origin** check box is checked and then click **OK**.  \n  \n4.  On the **Debug** tab, select the **Start browser with URL** option and specify the URL for the HTML page that contains the XBAP.  \n  \n5.  In Internet Explorer, click the **Tools** button and then select **Internet Options**.  \n  \n     The Internet Options dialog box appears.  \n  \n6.  Click the **Advanced** tab.  \n  \n7.  In the **Settings** list under **Security**, check the **Allow active content to run in files on My Computer** check box.  \n  \n8.  Click **OK**.  \n  \n     The changes will take effect after you restart Internet Explorer.  \n  \n> [!CAUTION]\n>  Enabling active content in Internet Explorer may put your computer at risk. If you do not want to change your Internet Explorer security settings, you can launch the HTML page from a server and attach the Visual Studio debugger to the process.  \n  \n<a name=\"xbap_security_considerations\"></a>   \n## XBAP Security Considerations  \n XBAPs typically execute in a partial-trust security sandbox that is restricted to the Internet zone permission set. Consequently, your implementation must support the subset of WPF elements that are supported in the Internet zone or you must elevate the permissions of your application. For more information, see [Security](../security-wpf.md).  \n  \n When you use a <xref:System.Windows.Controls.WebBrowser> control in your application, WPF internally instantiates the native WebBrowser ActiveX control. When your application is a partial-trust XBAP running in Internet Explorer, the ActiveX control runs in a dedicated thread of the Internet Explorer process. Therefore, the following limitations apply:  \n  \n-   The <xref:System.Windows.Controls.WebBrowser> control should provide behavior similar to the host browser, including security restrictions. Some of these security restrictions can be controlled through the Internet Explorer security settings. For more information, see [Security](../security-wpf.md).  \n  \n-   An exception is thrown when an XBAP is loaded cross-domain in an HTML page.  \n  \n-   Input is on a separate thread from the WPF <xref:System.Windows.Controls.WebBrowser>, so keyboard input cannot be intercepted and the IME state is not shared.  \n  \n-   The timing or order of navigation may be different due to the ActiveX control running on another thread. For example, navigating to a page is not always cancelled by starting another navigation request.  \n  \n-   A custom ActiveX control may have trouble with communication since the WPF application is running in a separate thread.  \n  \n-   <xref:System.Windows.Interop.HwndHost.MessageHook> does not get raised because <xref:System.Windows.Interop.HwndHost> cannot subclass a window running in another thread or process.  \n  \n### Creating a Full-Trust XBAP  \n If your XBAP requires full trust, you can change your project to enable this permission. The following steps describe how to enable full trust:  \n  \n1.  In Visual Studio, open the project properties.  \n  \n2.  On the **Security** tab, select the **This is a full trust application** option.  \n  \n This setting makes the following changes:  \n  \n-   In the project file, the `<TargetZone>` element value is changed to `Custom`.  \n  \n-   In the application manifest (app.manifest), an `Unrestricted=\"true\"` attribute is added to the `<xref:System.Security.PermissionSet> element.  \n  \n    ```xml\n    <PermissionSet class=\"System.Security.PermissionSet\"   \n                   version=\"1\"   \n                   ID=\"Custom\"   \n                   SameSite=\"site\"   \n                   Unrestricted=\"true\" />  \n    ```  \n  \n### Deploying a Full-Trust XBAP  \n When you deploy a full-trust XBAP that does not follow the ClickOnce Trusted Deployment model, the behavior when the user runs the application will depend on the security zone. In some cases, the user will receive a warning when they attempt to install it. The user can choose to continue or cancel the installation. The following table describes the behavior of the application for each security zone and what you have to do for the application to receive full trust.  \n  \n|Security Zone|Behavior|Getting Full Trust|  \n|-------------------|--------------|------------------------|  \n|Local computer|Automatic full trust|No action is needed.|  \n|Intranet and trusted sites|Prompt for full trust|Sign the XBAP with a certificate so that the user sees the source in the prompt.|  \n|Internet|Fails with \"Trust Not Granted\"|Sign the XBAP with a certificate.|  \n  \n> [!NOTE]\n>  The behavior described in the previous table is for full-trust XBAPs that do not follow the ClickOnce Trusted Deployment model.  \n  \n It is recommended that you use the ClickOnce Trusted Deployment model for deploying a full-trust XBAP. This model allows your XBAP to be granted full trust automatically, regardless of the security zone, so that the user is not prompted. As part of this model, you must sign your application with a certificate from a trusted publisher. For more information, see [Trusted Application Deployment Overview](/visualstudio/deployment/trusted-application-deployment-overview) and [Introduction to Code Signing](https://go.microsoft.com/fwlink/?LinkId=166327).  \n  \n<a name=\"xbap_start_time_performance_considerations\"></a>   \n## XBAP Start Time Performance Considerations  \n An important aspect of XBAP performance is its start time. If an XBAP is the first WPF application to load, the *cold start* time can be ten seconds or more. This is because the progress page is rendered by WPF, and both the CLR and WPF must be cold-started to display the application.  \n  \n Starting in [!INCLUDE[net_v35SP1_short](../../../../includes/net-v35sp1-short-md.md)], XBAP cold-start time is mitigated by displaying an unmanaged progress page early in the deployment cycle. The progress page appears almost immediately after the application is started, because it is displayed by native hosting code and rendered in HTML.  \n  \n In addition, improved concurrency of the ClickOnce download sequence improves start time by up to ten percent. After ClickOnce downloads and validates manifests, the application download starts, and the progress bar starts to update.  \n  \n## See also\n\n- [Configure Visual Studio to Debug a XAML Browser Application to Call a Web Service](configure-vs-to-debug-a-xaml-browser-to-call-a-web-service.md)\n- [Deploying a WPF Application](deploying-a-wpf-application-wpf.md)\n","nodes":[{"pos":[4,343],"embed":true,"restype":"x-metadata","content":"title: \"WPF XAML Browser Applications Overview\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"XBAP [WPF], XAML browser application\"\n  - \"WPF XAML browser applications (XBAP)\"\n  - \"XAML browser applications (XBAP)\"\n  - \"browser-hosted applications [WPF]\"\nms.assetid: 3a7a86a8-75d5-4898-96b9-73da151e5e16","nodes":[{"content":"WPF XAML Browser Applications Overview","nodes":[{"pos":[0,38],"content":"WPF XAML Browser Applications Overview","nodes":[{"content":"WPF XAML Browser Applications Overview","pos":[0,38]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[350,388],"content":"WPF XAML Browser Applications Overview","linkify":"WPF XAML Browser Applications Overview","nodes":[{"content":"WPF XAML Browser Applications Overview","pos":[0,38]}]},{"content":"<bpt id=\"p1\">&lt;a name=\"introduction\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept><ph id=\"ph1\">\n</ph><ph id=\"ph2\">[!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)]</ph> combines features of both Web applications and rich-client applications.","pos":[389,577],"source":"<a name=\"introduction\"></a>\n[!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] combines features of both Web applications and rich-client applications."},{"content":"Like Web applications, XBAPs can be deployed to a Web server and started from Internet Explorer or Firefox.","pos":[578,685]},{"content":"Like rich-client applications, XBAPs can take advantage of the capabilities of WPF.","pos":[686,769]},{"content":"Developing XBAPs is also similar to rich-client development.","pos":[770,830]},{"content":"This topic provides a simple, high-level introduction to XBAP development and describes where XBAP development differs from standard rich-client development.","pos":[831,988]},{"content":"This topic contains the following sections:","pos":[995,1038]},{"pos":[1048,1143],"content":"<bpt id=\"p1\">[</bpt>Creating a New XAML Browser Application (XBAP)<ept id=\"p1\">](#creating_a_new_xaml_browser_application_xbap)</ept>","source":"[Creating a New XAML Browser Application (XBAP)](#creating_a_new_xaml_browser_application_xbap)"},{"pos":[1153,1191],"content":"<bpt id=\"p1\">[</bpt>Deploying an XBAP<ept id=\"p1\">](#deploying_a_xbap)</ept>","source":"[Deploying an XBAP](#deploying_a_xbap)"},{"pos":[1201,1278],"content":"<bpt id=\"p1\">[</bpt>Communicating with the Host Web Page<ept id=\"p1\">](#communicating_with_the_host_web_page)</ept>","source":"[Communicating with the Host Web Page](#communicating_with_the_host_web_page)"},{"pos":[1288,1349],"content":"<bpt id=\"p1\">[</bpt>XBAP Security Considerations<ept id=\"p1\">](#xbap_security_considerations)</ept>","source":"[XBAP Security Considerations](#xbap_security_considerations)"},{"pos":[1359,1448],"content":"<bpt id=\"p1\">[</bpt>XBAP Start Time Performance Considerations<ept id=\"p1\">](#xbap_start_time_performance_considerations)</ept>","source":"[XBAP Start Time Performance Considerations](#xbap_start_time_performance_considerations)"},{"pos":[1520,1566],"content":"Creating a New XAML Browser Application (XBAP)","linkify":"Creating a New XAML Browser Application (XBAP)","nodes":[{"content":"Creating a New XAML Browser Application (XBAP)","pos":[0,46]}]},{"content":"The simplest way to create a new XBAP project is with Microsoft Visual Studio.","pos":[1570,1648]},{"content":"When creating a new project, select <bpt id=\"p1\">**</bpt>WPF Browser Application<ept id=\"p1\">**</ept> from the list of templates.","pos":[1649,1740],"source":" When creating a new project, select **WPF Browser Application** from the list of templates."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Create a New WPF Browser Application Project<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/bb628663(v=vs.100))</ept>.","pos":[1741,1919],"source":" For more information, see [How to: Create a New WPF Browser Application Project](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/bb628663(v=vs.100))."},{"content":"When you run the XBAP project, it opens in a browser window instead of a stand-alone window.","pos":[1926,2018]},{"content":"When you debug the XBAP from Visual Studio, the application runs with Internet zone permission and will therefore throw security exceptions if those permissions are exceeded.","pos":[2019,2193]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Security<ept id=\"p1\">](../security-wpf.md)</ept> and <bpt id=\"p2\">[</bpt>WPF Partial Trust Security<ept id=\"p2\">](../wpf-partial-trust-security.md)</ept>.","pos":[2194,2318],"source":" For more information, see [Security](../security-wpf.md) and [WPF Partial Trust Security](../wpf-partial-trust-security.md)."},{"pos":[2326,2497],"content":"[!NOTE]\n If you are not developing with Visual Studio or want to learn more about the project files, see [Building a WPF Application](building-a-wpf-application-wpf.md).","leadings":["","> "],"nodes":[{"content":"If you are not developing with Visual Studio or want to learn more about the project files, see <bpt id=\"p1\">[</bpt>Building a WPF Application<ept id=\"p1\">](building-a-wpf-application-wpf.md)</ept>.","pos":[9,169],"source":"If you are not developing with Visual Studio or want to learn more about the project files, see [Building a WPF Application](building-a-wpf-application-wpf.md)."}]},{"pos":[2541,2558],"content":"Deploying an XBAP","linkify":"Deploying an XBAP","nodes":[{"content":"Deploying an XBAP","pos":[0,17]}]},{"content":"When you build an XBAP, the output includes the following three files:","pos":[2562,2632]},{"content":"File","pos":[2639,2643]},{"content":"Description","pos":[2644,2655]},{"content":"Executable (.exe)","pos":[2693,2710]},{"content":"This contains the compiled code and has an .exe extension.","pos":[2711,2769]},{"content":"Application manifest (.manifest)","pos":[2774,2806]},{"content":"This contains metadata associated with the application and has a .manifest extension.","pos":[2807,2892]},{"content":"Deployment manifest (.xbap)","pos":[2897,2924]},{"content":"This file contains the information that ClickOnce uses to deploy the application and has the .xbap extension.","pos":[2925,3034]},{"content":"You deploy XBAPs to a Web server, for example <ph id=\"ph1\">[!INCLUDE[TLA#tla_iis50](../../../../includes/tlasharptla-iis50-md.md)]</ph> or later versions.","pos":[3042,3178],"source":"You deploy XBAPs to a Web server, for example [!INCLUDE[TLA#tla_iis50](../../../../includes/tlasharptla-iis50-md.md)] or later versions."},{"content":"You do not have to install the .NET Framework on the Web server, but you do have to register the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> <ph id=\"ph2\">[!INCLUDE[TLA#tla_mime](../../../../includes/tlasharptla-mime-md.md)]</ph> types and file name extensions.","pos":[3179,3447],"source":" You do not have to install the .NET Framework on the Web server, but you do have to register the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA#tla_mime](../../../../includes/tlasharptla-mime-md.md)] types and file name extensions."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Configure IIS 5.0 and IIS 6.0 to Deploy WPF Applications<ept id=\"p1\">](how-to-configure-iis-5-0-and-iis-6-0-to-deploy-wpf-applications.md)</ept>.","pos":[3448,3601],"source":" For more information, see [Configure IIS 5.0 and IIS 6.0 to Deploy WPF Applications](how-to-configure-iis-5-0-and-iis-6-0-to-deploy-wpf-applications.md)."},{"content":"To prepare your XBAP for deployment, copy the .exe and the associated manifests to the Web server.","pos":[3608,3706]},{"content":"Create an HTML page that contains a hyperlink to open the deployment manifest, which is the file that has the .xbap extension.","pos":[3707,3833]},{"content":"When the user clicks the link to the .xbap file, ClickOnce automatically handles the mechanics of downloading and starting the application.","pos":[3834,3973]},{"content":"The following example code shows an HTML page that contains a hyperlink that points to an XBAP.","pos":[3974,4069]},{"content":"You can also host an XBAP in the frame of a Web page.","pos":[4240,4293]},{"content":"Create a Web page with one or more frames.","pos":[4294,4336]},{"content":"Set the source property of a frame to the deployment manifest file.","pos":[4337,4404]},{"content":"If you want to use the built-in mechanism to communicate between the hosting Web page and the XBAP, you must host the application in a frame.","pos":[4405,4546]},{"content":"The following example code shows an HTML page with two frames, the source for the second frame is set to an XBAP.","pos":[4547,4660]},{"pos":[4905,4926],"content":"Clearing Cached XBAPs","linkify":"Clearing Cached XBAPs","nodes":[{"content":"Clearing Cached XBAPs","pos":[0,21]}]},{"content":"In some situations after rebuilding and starting your XBAP, you may find that an earlier version of the XBAP is opened.","pos":[4930,5049]},{"content":"For example, this behavior may occur when your XBAP assembly version number is static and you start the XBAP from the command line.","pos":[5050,5181]},{"content":"In this case, because the version number between the cached version (the version that was previously started) and the new version remains the same, the new version of the XBAP is not downloaded.","pos":[5182,5376]},{"content":"Instead, the cached version is loaded.","pos":[5377,5415]},{"content":"In these situations, you can remove the cached version by using the <bpt id=\"p1\">**</bpt>Mage<ept id=\"p1\">**</ept> command (installed with Visual Studio or the Windows SDK) at the command prompt.","pos":[5422,5579],"source":"In these situations, you can remove the cached version by using the **Mage** command (installed with Visual Studio or the Windows SDK) at the command prompt."},{"content":"The following command clears the application cache.","pos":[5580,5631]},{"content":"This command guarantees that the latest version of your XBAP is started.","pos":[5672,5744]},{"content":"When you debug your application in Visual Studio, the latest version of your XBAP should be started.","pos":[5745,5845]},{"content":"In general, you should update your deployment version number with each build.","pos":[5846,5923]},{"content":"For more information about Mage, see <bpt id=\"p1\">[</bpt>Mage.exe (Manifest Generation and Editing Tool)<ept id=\"p1\">](../../tools/mage-exe-manifest-generation-and-editing-tool.md)</ept>.","pos":[5924,6073],"source":" For more information about Mage, see [Mage.exe (Manifest Generation and Editing Tool)](../../tools/mage-exe-manifest-generation-and-editing-tool.md)."},{"pos":[6137,6173],"content":"Communicating with the Host Web Page","linkify":"Communicating with the Host Web Page","nodes":[{"content":"Communicating with the Host Web Page","pos":[0,36]}]},{"content":"When the application is hosted in an HTML frame, you can communicate with the Web page that contains the XBAP.","pos":[6177,6287]},{"content":"You do this by retrieving the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.BrowserInteropHelper.HostScript%2A&gt;</ph> property of <ph id=\"ph2\">&lt;xref:System.Windows.Interop.BrowserInteropHelper&gt;</ph>.","pos":[6288,6446],"source":" You do this by retrieving the <xref:System.Windows.Interop.BrowserInteropHelper.HostScript%2A> property of <xref:System.Windows.Interop.BrowserInteropHelper>."},{"content":"This property returns a script object that represents the HTML window.","pos":[6447,6517]},{"content":"You can then access the properties, methods, and events on the <bpt id=\"p1\">[</bpt>window object<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=160274)</ept> by using regular dot syntax.","pos":[6518,6673],"source":" You can then access the properties, methods, and events on the [window object](https://go.microsoft.com/fwlink/?LinkId=160274) by using regular dot syntax."},{"content":"You can also access script methods and global variables.","pos":[6674,6730]},{"content":"The following example shows how to retrieve the script object and close the browser.","pos":[6731,6815]},{"pos":[7073,7108],"content":"Debugging XBAPs that Use HostScript","linkify":"Debugging XBAPs that Use HostScript","nodes":[{"content":"Debugging XBAPs that Use HostScript","pos":[0,35]}]},{"content":"If your XBAP uses the <ph id=\"ph1\">&lt;xref:System.Windows.Interop.BrowserInteropHelper.HostScript%2A&gt;</ph> object to communicate with the HTML window, there are two settings that you must specify to run and debug the application in Visual Studio.","pos":[7112,7338],"source":"If your XBAP uses the <xref:System.Windows.Interop.BrowserInteropHelper.HostScript%2A> object to communicate with the HTML window, there are two settings that you must specify to run and debug the application in Visual Studio."},{"content":"The application must have access to its site of origin and you must start the application with the HTML page that contains the XBAP.","pos":[7339,7471]},{"content":"The following steps describe how to check these two settings:","pos":[7472,7533]},{"content":"In Visual Studio, open the project properties.","pos":[7543,7589]},{"pos":[7599,7643],"content":"On the <bpt id=\"p1\">**</bpt>Security<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>Advanced<ept id=\"p2\">**</ept>.","source":"On the **Security** tab, click **Advanced**."},{"content":"The Advanced Security Settings dialog box appears.","pos":[7654,7704]},{"pos":[7714,7831],"content":"Make sure that the <bpt id=\"p1\">**</bpt>Grant the application access to its site of origin<ept id=\"p1\">**</ept> check box is checked and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"Make sure that the **Grant the application access to its site of origin** check box is checked and then click **OK**."},{"pos":[7841,7969],"content":"On the <bpt id=\"p1\">**</bpt>Debug<ept id=\"p1\">**</ept> tab, select the <bpt id=\"p2\">**</bpt>Start browser with URL<ept id=\"p2\">**</ept> option and specify the URL for the HTML page that contains the XBAP.","source":"On the **Debug** tab, select the **Start browser with URL** option and specify the URL for the HTML page that contains the XBAP."},{"pos":[7979,8065],"content":"In Internet Explorer, click the <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept> button and then select <bpt id=\"p2\">**</bpt>Internet Options<ept id=\"p2\">**</ept>.","source":"In Internet Explorer, click the **Tools** button and then select **Internet Options**."},{"content":"The Internet Options dialog box appears.","pos":[8076,8116]},{"pos":[8126,8153],"content":"Click the <bpt id=\"p1\">**</bpt>Advanced<ept id=\"p1\">**</ept> tab.","source":"Click the **Advanced** tab."},{"pos":[8163,8284],"content":"In the <bpt id=\"p1\">**</bpt>Settings<ept id=\"p1\">**</ept> list under <bpt id=\"p2\">**</bpt>Security<ept id=\"p2\">**</ept>, check the <bpt id=\"p3\">**</bpt>Allow active content to run in files on My Computer<ept id=\"p3\">**</ept> check box.","source":"In the **Settings** list under **Security**, check the **Allow active content to run in files on My Computer** check box."},{"pos":[8294,8307],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"content":"The changes will take effect after you restart Internet Explorer.","pos":[8318,8383]},{"pos":[8391,8648],"content":"[!CAUTION]\n Enabling active content in Internet Explorer may put your computer at risk. If you do not want to change your Internet Explorer security settings, you can launch the HTML page from a server and attach the Visual Studio debugger to the process.","leadings":["","> "],"nodes":[{"content":"Enabling active content in Internet Explorer may put your computer at risk. If you do not want to change your Internet Explorer security settings, you can launch the HTML page from a server and attach the Visual Studio debugger to the process.","pos":[12,255],"nodes":[{"content":"Enabling active content in Internet Explorer may put your computer at risk.","pos":[0,75]},{"content":"If you do not want to change your Internet Explorer security settings, you can launch the HTML page from a server and attach the Visual Studio debugger to the process.","pos":[76,243]}]}]},{"pos":[8704,8732],"content":"XBAP Security Considerations","linkify":"XBAP Security Considerations","nodes":[{"content":"XBAP Security Considerations","pos":[0,28]}]},{"content":"XBAPs typically execute in a partial-trust security sandbox that is restricted to the Internet zone permission set.","pos":[8736,8851]},{"content":"Consequently, your implementation must support the subset of WPF elements that are supported in the Internet zone or you must elevate the permissions of your application.","pos":[8852,9022]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Security<ept id=\"p1\">](../security-wpf.md)</ept>.","pos":[9023,9080],"source":" For more information, see [Security](../security-wpf.md)."},{"content":"When you use a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.WebBrowser&gt;</ph> control in your application, WPF internally instantiates the native WebBrowser ActiveX control.","pos":[9087,9239],"source":"When you use a <xref:System.Windows.Controls.WebBrowser> control in your application, WPF internally instantiates the native WebBrowser ActiveX control."},{"content":"When your application is a partial-trust XBAP running in Internet Explorer, the ActiveX control runs in a dedicated thread of the Internet Explorer process.","pos":[9240,9396]},{"content":"Therefore, the following limitations apply:","pos":[9397,9440]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.WebBrowser&gt;</ph> control should provide behavior similar to the host browser, including security restrictions.","pos":[9450,9589],"source":"The <xref:System.Windows.Controls.WebBrowser> control should provide behavior similar to the host browser, including security restrictions."},{"content":"Some of these security restrictions can be controlled through the Internet Explorer security settings.","pos":[9590,9692]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Security<ept id=\"p1\">](../security-wpf.md)</ept>.","pos":[9693,9750],"source":" For more information, see [Security](../security-wpf.md)."},{"content":"An exception is thrown when an XBAP is loaded cross-domain in an HTML page.","pos":[9760,9835]},{"pos":[9845,10003],"content":"Input is on a separate thread from the WPF <ph id=\"ph1\">&lt;xref:System.Windows.Controls.WebBrowser&gt;</ph>, so keyboard input cannot be intercepted and the IME state is not shared.","source":"Input is on a separate thread from the WPF <xref:System.Windows.Controls.WebBrowser>, so keyboard input cannot be intercepted and the IME state is not shared."},{"content":"The timing or order of navigation may be different due to the ActiveX control running on another thread.","pos":[10013,10117]},{"content":"For example, navigating to a page is not always cancelled by starting another navigation request.","pos":[10118,10215]},{"content":"A custom ActiveX control may have trouble with communication since the WPF application is running in a separate thread.","pos":[10225,10344]},{"pos":[10354,10534],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Interop.HwndHost.MessageHook&gt;</ph> does not get raised because <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndHost&gt;</ph> cannot subclass a window running in another thread or process.","source":"<xref:System.Windows.Interop.HwndHost.MessageHook> does not get raised because <xref:System.Windows.Interop.HwndHost> cannot subclass a window running in another thread or process."},{"pos":[10544,10570],"content":"Creating a Full-Trust XBAP","linkify":"Creating a Full-Trust XBAP","nodes":[{"content":"Creating a Full-Trust XBAP","pos":[0,26]}]},{"content":"If your XBAP requires full trust, you can change your project to enable this permission.","pos":[10574,10662]},{"content":"The following steps describe how to enable full trust:","pos":[10663,10717]},{"content":"In Visual Studio, open the project properties.","pos":[10727,10773]},{"pos":[10783,10863],"content":"On the <bpt id=\"p1\">**</bpt>Security<ept id=\"p1\">**</ept> tab, select the <bpt id=\"p2\">**</bpt>This is a full trust application<ept id=\"p2\">**</ept> option.","source":"On the **Security** tab, select the **This is a full trust application** option."},{"content":"This setting makes the following changes:","pos":[10870,10911]},{"pos":[10921,10998],"content":"In the project file, the <ph id=\"ph1\">`&lt;TargetZone&gt;`</ph> element value is changed to <ph id=\"ph2\">`Custom`</ph>.","source":"In the project file, the `<TargetZone>` element value is changed to `Custom`."},{"pos":[11008,11149],"content":"In the application manifest (app.manifest), an <ph id=\"ph1\">`Unrestricted=\"true\"`</ph> attribute is added to the `<ph id=\"ph2\">&lt;xref:System.Security.PermissionSet&gt;</ph> element.","source":"In the application manifest (app.manifest), an `Unrestricted=\"true\"` attribute is added to the `<xref:System.Security.PermissionSet> element."},{"pos":[11393,11420],"content":"Deploying a Full-Trust XBAP","linkify":"Deploying a Full-Trust XBAP","nodes":[{"content":"Deploying a Full-Trust XBAP","pos":[0,27]}]},{"content":"When you deploy a full-trust XBAP that does not follow the ClickOnce Trusted Deployment model, the behavior when the user runs the application will depend on the security zone.","pos":[11424,11600]},{"content":"In some cases, the user will receive a warning when they attempt to install it.","pos":[11601,11680]},{"content":"The user can choose to continue or cancel the installation.","pos":[11681,11740]},{"content":"The following table describes the behavior of the application for each security zone and what you have to do for the application to receive full trust.","pos":[11741,11892]},{"content":"Security Zone","pos":[11899,11912]},{"content":"Behavior","pos":[11913,11921]},{"content":"Getting Full Trust","pos":[11922,11940]},{"content":"Local computer","pos":[12009,12023]},{"content":"Automatic full trust","pos":[12024,12044]},{"content":"No action is needed.","pos":[12045,12065]},{"content":"Intranet and trusted sites","pos":[12070,12096]},{"content":"Prompt for full trust","pos":[12097,12118]},{"content":"Sign the XBAP with a certificate so that the user sees the source in the prompt.","pos":[12119,12199]},{"content":"Internet","pos":[12204,12212]},{"content":"Fails with \"Trust Not Granted\"","pos":[12213,12243]},{"content":"Sign the XBAP with a certificate.","pos":[12244,12277]},{"pos":[12286,12424],"content":"[!NOTE]\n The behavior described in the previous table is for full-trust XBAPs that do not follow the ClickOnce Trusted Deployment model.","leadings":["","> "],"nodes":[{"content":"The behavior described in the previous table is for full-trust XBAPs that do not follow the ClickOnce Trusted Deployment model.","pos":[9,136]}]},{"content":"It is recommended that you use the ClickOnce Trusted Deployment model for deploying a full-trust XBAP.","pos":[12431,12533]},{"content":"This model allows your XBAP to be granted full trust automatically, regardless of the security zone, so that the user is not prompted.","pos":[12534,12668]},{"content":"As part of this model, you must sign your application with a certificate from a trusted publisher.","pos":[12669,12767]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Trusted Application Deployment Overview<ept id=\"p1\">](/visualstudio/deployment/trusted-application-deployment-overview)</ept> and <bpt id=\"p2\">[</bpt>Introduction to Code Signing<ept id=\"p2\">](https://go.microsoft.com/fwlink/?LinkId=166327)</ept>.","pos":[12768,12985],"source":" For more information, see [Trusted Application Deployment Overview](/visualstudio/deployment/trusted-application-deployment-overview) and [Introduction to Code Signing](https://go.microsoft.com/fwlink/?LinkId=166327)."},{"pos":[13055,13097],"content":"XBAP Start Time Performance Considerations","linkify":"XBAP Start Time Performance Considerations","nodes":[{"content":"XBAP Start Time Performance Considerations","pos":[0,42]}]},{"content":"An important aspect of XBAP performance is its start time.","pos":[13101,13159]},{"content":"If an XBAP is the first WPF application to load, the <bpt id=\"p1\">*</bpt>cold start<ept id=\"p1\">*</ept> time can be ten seconds or more.","pos":[13160,13258],"source":" If an XBAP is the first WPF application to load, the *cold start* time can be ten seconds or more."},{"content":"This is because the progress page is rendered by WPF, and both the CLR and WPF must be cold-started to display the application.","pos":[13259,13386]},{"content":"Starting in <ph id=\"ph1\">[!INCLUDE[net_v35SP1_short](../../../../includes/net-v35sp1-short-md.md)]</ph>, XBAP cold-start time is mitigated by displaying an unmanaged progress page early in the deployment cycle.","pos":[13393,13585],"source":"Starting in [!INCLUDE[net_v35SP1_short](../../../../includes/net-v35sp1-short-md.md)], XBAP cold-start time is mitigated by displaying an unmanaged progress page early in the deployment cycle."},{"content":"The progress page appears almost immediately after the application is started, because it is displayed by native hosting code and rendered in HTML.","pos":[13586,13733]},{"content":"In addition, improved concurrency of the ClickOnce download sequence improves start time by up to ten percent.","pos":[13740,13850]},{"content":"After ClickOnce downloads and validates manifests, the application download starts, and the progress bar starts to update.","pos":[13851,13973]},{"pos":[13982,13990],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[13994,14140],"content":"<bpt id=\"p1\">[</bpt>Configure Visual Studio to Debug a XAML Browser Application to Call a Web Service<ept id=\"p1\">](configure-vs-to-debug-a-xaml-browser-to-call-a-web-service.md)</ept>","source":"[Configure Visual Studio to Debug a XAML Browser Application to Call a Web Service](configure-vs-to-debug-a-xaml-browser-to-call-a-web-service.md)"},{"pos":[14143,14208],"content":"<bpt id=\"p1\">[</bpt>Deploying a WPF Application<ept id=\"p1\">](deploying-a-wpf-application-wpf.md)</ept>","source":"[Deploying a WPF Application](deploying-a-wpf-application-wpf.md)"}]}