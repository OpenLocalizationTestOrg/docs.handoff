{"content":"---\ntitle: \"How to: Encrypt XML Elements with X.509 Certificates | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"encryption [.NET Framework], X.509 certificates\"\n  - \"cryptography [.NET Framework], X.509 certificates\"\n  - \"System.Security.Cryptography.EncryptedXml class\"\n  - \"XML encryption\"\n  - \"System.Security.Cryptography.X509Certificate2 class\"\n  - \"X.509 certificates\"\n  - \"certificates, X.509 certificates\"\nms.assetid: 761f1c66-631c-47af-aa86-ad9c50cfa453\ncaps.latest.revision: 15\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# How to: Encrypt XML Elements with X.509 Certificates\nYou can use the classes in the <xref:System.Security.Cryptography.Xml> namespace to encrypt an element within an XML document.  XML Encryption is a standard way to exchange or store encrypted XML data, without worrying about the data being easily read.  For more information about the XML Encryption standard, see the World Wide Web Consortium (W3C) specification for XML Encryption located at http://www.w3.org/TR/xmldsig-core/.  \n  \n You can use XML Encryption to replace any XML element or document with an <`EncryptedData`> element that contains the encrypted XML data. The <`EncryptedData`> element can contain sub elements that include information about the keys and processes used during encryption.  XML Encryption allows a document to contain multiple encrypted elements and allows an element to be encrypted multiple times.  The code example in this procedure shows you how to create an <`EncryptedData`> element along with several other sub elements that you can use later during decryption.  \n  \n This example encrypts an XML element using two keys.  It generates a test X.509 certificate using the [Certificate Creation Tool (Makecert.exe)](https://msdn.microsoft.com/library/windows/desktop/aa386968.aspx) and saves the certificate to a certificate store.  The example then programmatically retrieves the certificate and uses it to encrypt an XML element using the <xref:System.Security.Cryptography.Xml.EncryptedXml.Encrypt%2A> method.  Internally, the <xref:System.Security.Cryptography.Xml.EncryptedXml.Encrypt%2A> method creates a separate session key and uses it to encrypt the XML document. This method encrypts the session key and saves it along with the encrypted XML within a new <`EncryptedData`> element.  \n  \n To decrypt the XML element, simply call the <xref:System.Security.Cryptography.Xml.EncryptedXml.DecryptDocument%2A> method, which automatically retrieves the X.509 certificate from the store and performs the necessary decryption.  For more information about how to decrypt an XML element that was encrypted using this procedure, see [How to: Decrypt XML Elements with X.509 Certificates](../../../docs/standard/security/how-to-decrypt-xml-elements-with-x-509-certificates.md).  \n  \n This example is appropriate for situations where multiple applications need to share encrypted data or where an application needs to save encrypted data between the times that it runs.  \n  \n### To encrypt an XML element with an X.509 certificate  \n  \n1.  Use the [Certificate Creation Tool (Makecert.exe)](https://msdn.microsoft.com/library/windows/desktop/aa386968.aspx) to generate a test X.509 certificate and place it in the local user store.  You must generate an exchange key and you must make the key exportable. Run the following command:  \n  \n    ```  \n    makecert -r -pe -n \"CN=XML_ENC_TEST_CERT\" -b 01/01/2005 -e 01/01/2010 -sky exchange -ss my  \n    ```  \n  \n2.  Create an <xref:System.Security.Cryptography.X509Certificates.X509Store> object and initialize it to open the current user store.  \n  \n     [!code-csharp[HowToEncryptXMLElementX509#2](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#2)]\n     [!code-vb[HowToEncryptXMLElementX509#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#2)]  \n  \n3.  Open the store in read-only mode.  \n  \n     [!code-csharp[HowToEncryptXMLElementX509#3](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#3)]\n     [!code-vb[HowToEncryptXMLElementX509#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#3)]  \n  \n4.  Initialize an <xref:System.Security.Cryptography.X509Certificates.X509Certificate2Collection> with all of the certificates in the store.  \n  \n     [!code-csharp[HowToEncryptXMLElementX509#4](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#4)]\n     [!code-vb[HowToEncryptXMLElementX509#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#4)]  \n  \n5.  Enumerate through the certificates in the store and find the certificate with the appropriate name.  In this example, the certificate is named `\"CN=XML_ENC_TEST_CERT\"`.  \n  \n     [!code-csharp[HowToEncryptXMLElementX509#5](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#5)]\n     [!code-vb[HowToEncryptXMLElementX509#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#5)]  \n  \n6.  Close the store after the certificate is located.  \n  \n     [!code-csharp[HowToEncryptXMLElementX509#6](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#6)]\n     [!code-vb[HowToEncryptXMLElementX509#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#6)]  \n  \n7.  Create an <xref:System.Xml.XmlDocument> object by loading an XML file from disk.  The <xref:System.Xml.XmlDocument> object contains the XML element to encrypt.  \n  \n     [!code-csharp[HowToEncryptXMLElementX509#7](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#7)]\n     [!code-vb[HowToEncryptXMLElementX509#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#7)]  \n  \n8.  Find the specified element in the <xref:System.Xml.XmlDocument> object and create a new <xref:System.Xml.XmlElement> object to represent the element you want to encrypt.  In this example, the `\"creditcard\"` element is encrypted.  \n  \n     [!code-csharp[HowToEncryptXMLElementX509#8](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#8)]\n     [!code-vb[HowToEncryptXMLElementX509#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#8)]  \n  \n9. Create a new instance of the <xref:System.Security.Cryptography.Xml.EncryptedXml> class and use it to encrypt the specified element using the X.509 certificate.  The <xref:System.Security.Cryptography.Xml.EncryptedXml.Encrypt%2A> method returns the encrypted element as an <xref:System.Security.Cryptography.Xml.EncryptedData> object.  \n  \n     [!code-csharp[HowToEncryptXMLElementX509#9](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#9)]\n     [!code-vb[HowToEncryptXMLElementX509#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#9)]  \n  \n10. Replace the element from the original <xref:System.Xml.XmlDocument> object with the <xref:System.Security.Cryptography.Xml.EncryptedData> element.  \n  \n     [!code-csharp[HowToEncryptXMLElementX509#10](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#10)]\n     [!code-vb[HowToEncryptXMLElementX509#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#10)]  \n  \n11. Save the <xref:System.Xml.XmlDocument> object.  \n  \n     [!code-csharp[HowToEncryptXMLElementX509#11](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#11)]\n     [!code-vb[HowToEncryptXMLElementX509#11](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#11)]  \n  \n## Example  \n This example assumes that a file named `\"test.xml\"` exists in the same directory as the compiled program.  It also assumes that `\"test.xml\"` contains a `\"creditcard\"` element.  You can place the following XML into a file called `test.xml` and use it with this example.  \n  \n```  \n<root>  \n    <creditcard>  \n        <number>19834209</number>  \n        <expiry>02/02/2002</expiry>  \n    </creditcard>  \n</root>  \n```  \n  \n [!code-csharp[HowToEncryptXMLElementX509#1](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#1)]\n [!code-vb[HowToEncryptXMLElementX509#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#1)]  \n  \n## Compiling the Code  \n  \n-   To compile this example, you need to include a reference to `System.Security.dll`.  \n  \n-   Include the following namespaces: <xref:System.Xml>, <xref:System.Security.Cryptography>, and <xref:System.Security.Cryptography.Xml>.  \n  \n## .NET Framework Security  \n The X.509 certificate used in this example is for test purposes only.  Applications should use an X.509 certificate generated by a trusted certificate authority or use a certificate generated by the Microsoft Windows Certificate Server.  \n  \n## See Also  \n <xref:System.Security.Cryptography.Xml>   \n [How to: Decrypt XML Elements with X.509 Certificates](../../../docs/standard/security/how-to-decrypt-xml-elements-with-x-509-certificates.md)","nodes":[{"pos":[12,81],"content":"How to: Encrypt XML Elements with X.509 Certificates | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Encrypt XML Elements with X.509 Certificates | Microsoft Docs","pos":[0,69]}]},{"pos":[756,808],"content":"How to: Encrypt XML Elements with X.509 Certificates","linkify":"How to: Encrypt XML Elements with X.509 Certificates","nodes":[{"content":"How to: Encrypt XML Elements with X.509 Certificates","pos":[0,52]}]},{"content":"You can use the classes in the <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.Xml&gt;</ph> namespace to encrypt an element within an XML document.","pos":[809,935],"source":"You can use the classes in the <xref:System.Security.Cryptography.Xml> namespace to encrypt an element within an XML document."},{"content":"XML Encryption is a standard way to exchange or store encrypted XML data, without worrying about the data being easily read.","pos":[937,1061]},{"content":"For more information about the XML Encryption standard, see the World Wide Web Consortium (W3C) specification for XML Encryption located at http://www.w3.org/TR/xmldsig-core/.","pos":[1063,1238]},{"content":"You can use XML Encryption to replace any XML element or document with an &lt;<ph id=\"ph1\">`EncryptedData`</ph>&gt; element that contains the encrypted XML data.","pos":[1245,1382],"source":"You can use XML Encryption to replace any XML element or document with an <`EncryptedData`> element that contains the encrypted XML data."},{"content":"The &lt;<ph id=\"ph1\">`EncryptedData`</ph>&gt; element can contain sub elements that include information about the keys and processes used during encryption.","pos":[1383,1515],"source":" The <`EncryptedData`> element can contain sub elements that include information about the keys and processes used during encryption."},{"content":"XML Encryption allows a document to contain multiple encrypted elements and allows an element to be encrypted multiple times.","pos":[1517,1642]},{"content":"The code example in this procedure shows you how to create an &lt;<ph id=\"ph1\">`EncryptedData`</ph>&gt; element along with several other sub elements that you can use later during decryption.","pos":[1644,1811],"source":"  The code example in this procedure shows you how to create an <`EncryptedData`> element along with several other sub elements that you can use later during decryption."},{"content":"This example encrypts an XML element using two keys.","pos":[1818,1870]},{"content":"It generates a test X.509 certificate using the <bpt id=\"p1\">[</bpt>Certificate Creation Tool (Makecert.exe)<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/aa386968.aspx)</ept> and saves the certificate to a certificate store.","pos":[1872,2078],"source":"  It generates a test X.509 certificate using the [Certificate Creation Tool (Makecert.exe)](https://msdn.microsoft.com/library/windows/desktop/aa386968.aspx) and saves the certificate to a certificate store."},{"content":"The example then programmatically retrieves the certificate and uses it to encrypt an XML element using the <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.Xml.EncryptedXml.Encrypt%2A&gt;</ph> method.","pos":[2080,2259],"source":"  The example then programmatically retrieves the certificate and uses it to encrypt an XML element using the <xref:System.Security.Cryptography.Xml.EncryptedXml.Encrypt%2A> method."},{"content":"Internally, the <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.Xml.EncryptedXml.Encrypt%2A&gt;</ph> method creates a separate session key and uses it to encrypt the XML document.","pos":[2261,2419],"source":"  Internally, the <xref:System.Security.Cryptography.Xml.EncryptedXml.Encrypt%2A> method creates a separate session key and uses it to encrypt the XML document."},{"content":"This method encrypts the session key and saves it along with the encrypted XML within a new &lt;<ph id=\"ph1\">`EncryptedData`</ph>&gt; element.","pos":[2420,2538],"source":" This method encrypts the session key and saves it along with the encrypted XML within a new <`EncryptedData`> element."},{"content":"To decrypt the XML element, simply call the <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.Xml.EncryptedXml.DecryptDocument%2A&gt;</ph> method, which automatically retrieves the X.509 certificate from the store and performs the necessary decryption.","pos":[2545,2774],"source":"To decrypt the XML element, simply call the <xref:System.Security.Cryptography.Xml.EncryptedXml.DecryptDocument%2A> method, which automatically retrieves the X.509 certificate from the store and performs the necessary decryption."},{"content":"For more information about how to decrypt an XML element that was encrypted using this procedure, see <bpt id=\"p1\">[</bpt>How to: Decrypt XML Elements with X.509 Certificates<ept id=\"p1\">](../../../docs/standard/security/how-to-decrypt-xml-elements-with-x-509-certificates.md)</ept>.","pos":[2776,3021],"source":"  For more information about how to decrypt an XML element that was encrypted using this procedure, see [How to: Decrypt XML Elements with X.509 Certificates](../../../docs/standard/security/how-to-decrypt-xml-elements-with-x-509-certificates.md)."},{"content":"This example is appropriate for situations where multiple applications need to share encrypted data or where an application needs to save encrypted data between the times that it runs.","pos":[3028,3212]},{"pos":[3222,3273],"content":"To encrypt an XML element with an X.509 certificate","linkify":"To encrypt an XML element with an X.509 certificate","nodes":[{"content":"To encrypt an XML element with an X.509 certificate","pos":[0,51]}]},{"content":"Use the <bpt id=\"p1\">[</bpt>Certificate Creation Tool (Makecert.exe)<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/aa386968.aspx)</ept> to generate a test X.509 certificate and place it in the local user store.","pos":[3283,3474],"source":"Use the [Certificate Creation Tool (Makecert.exe)](https://msdn.microsoft.com/library/windows/desktop/aa386968.aspx) to generate a test X.509 certificate and place it in the local user store."},{"content":"You must generate an exchange key and you must make the key exportable.","pos":[3476,3547]},{"content":"Run the following command:","pos":[3548,3574]},{"content":"Create an <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.X509Certificates.X509Store&gt;</ph> object and initialize it to open the current user store.","pos":[3704,3833],"source":"Create an <xref:System.Security.Cryptography.X509Certificates.X509Store> object and initialize it to open the current user store."},{"pos":[3844,4123],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToEncryptXMLElementX509#2<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#2)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToEncryptXMLElementX509#2<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#2)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[HowToEncryptXMLElementX509#2](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#2)]\n [!code-vb[HowToEncryptXMLElementX509#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#2)]"},{"content":"Open the store in read-only mode.","pos":[4133,4166]},{"pos":[4177,4456],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToEncryptXMLElementX509#3<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#3)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToEncryptXMLElementX509#3<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#3)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[HowToEncryptXMLElementX509#3](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#3)]\n [!code-vb[HowToEncryptXMLElementX509#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#3)]"},{"content":"Initialize an <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.X509Certificates.X509Certificate2Collection&gt;</ph> with all of the certificates in the store.","pos":[4466,4602],"source":"Initialize an <xref:System.Security.Cryptography.X509Certificates.X509Certificate2Collection> with all of the certificates in the store."},{"pos":[4613,4892],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToEncryptXMLElementX509#4<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#4)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToEncryptXMLElementX509#4<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#4)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[HowToEncryptXMLElementX509#4](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#4)]\n [!code-vb[HowToEncryptXMLElementX509#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#4)]"},{"content":"Enumerate through the certificates in the store and find the certificate with the appropriate name.","pos":[4902,5001]},{"content":"In this example, the certificate is named <ph id=\"ph1\">`\"CN=XML_ENC_TEST_CERT\"`</ph>.","pos":[5003,5070],"source":"  In this example, the certificate is named `\"CN=XML_ENC_TEST_CERT\"`."},{"pos":[5081,5360],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToEncryptXMLElementX509#5<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#5)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToEncryptXMLElementX509#5<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#5)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[HowToEncryptXMLElementX509#5](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#5)]\n [!code-vb[HowToEncryptXMLElementX509#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#5)]"},{"content":"Close the store after the certificate is located.","pos":[5370,5419]},{"pos":[5430,5709],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToEncryptXMLElementX509#6<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#6)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToEncryptXMLElementX509#6<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#6)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[HowToEncryptXMLElementX509#6](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#6)]\n [!code-vb[HowToEncryptXMLElementX509#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#6)]"},{"content":"Create an <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object by loading an XML file from disk.","pos":[5719,5799],"source":"Create an <xref:System.Xml.XmlDocument> object by loading an XML file from disk."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object contains the XML element to encrypt.","pos":[5801,5878],"source":"  The <xref:System.Xml.XmlDocument> object contains the XML element to encrypt."},{"pos":[5889,6168],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToEncryptXMLElementX509#7<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#7)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToEncryptXMLElementX509#7<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#7)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[HowToEncryptXMLElementX509#7](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#7)]\n [!code-vb[HowToEncryptXMLElementX509#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#7)]"},{"content":"Find the specified element in the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object and create a new <ph id=\"ph2\">&lt;xref:System.Xml.XmlElement&gt;</ph> object to represent the element you want to encrypt.","pos":[6178,6347],"source":"Find the specified element in the <xref:System.Xml.XmlDocument> object and create a new <xref:System.Xml.XmlElement> object to represent the element you want to encrypt."},{"content":"In this example, the <ph id=\"ph1\">`\"creditcard\"`</ph> element is encrypted.","pos":[6349,6406],"source":"  In this example, the `\"creditcard\"` element is encrypted."},{"pos":[6417,6696],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToEncryptXMLElementX509#8<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#8)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToEncryptXMLElementX509#8<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#8)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[HowToEncryptXMLElementX509#8](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#8)]\n [!code-vb[HowToEncryptXMLElementX509#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#8)]"},{"content":"Create a new instance of the <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.Xml.EncryptedXml&gt;</ph> class and use it to encrypt the specified element using the X.509 certificate.","pos":[6705,6865],"source":"Create a new instance of the <xref:System.Security.Cryptography.Xml.EncryptedXml> class and use it to encrypt the specified element using the X.509 certificate."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Security.Cryptography.Xml.EncryptedXml.Encrypt%2A&gt;</ph> method returns the encrypted element as an <ph id=\"ph2\">&lt;xref:System.Security.Cryptography.Xml.EncryptedData&gt;</ph> object.","pos":[6867,7039],"source":"  The <xref:System.Security.Cryptography.Xml.EncryptedXml.Encrypt%2A> method returns the encrypted element as an <xref:System.Security.Cryptography.Xml.EncryptedData> object."},{"pos":[7050,7329],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToEncryptXMLElementX509#9<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#9)</ept><ept id=\"p1\">]</ept>   <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToEncryptXMLElementX509#9<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#9)</ept><ept id=\"p3\">]</ept>","leadings":["","   "],"source":"[!code-csharp[HowToEncryptXMLElementX509#9](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#9)]\n  [!code-vb[HowToEncryptXMLElementX509#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#9)]"},{"content":"Replace the element from the original <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object with the <ph id=\"ph2\">&lt;xref:System.Security.Cryptography.Xml.EncryptedData&gt;</ph> element.","pos":[7339,7485],"source":"Replace the element from the original <xref:System.Xml.XmlDocument> object with the <xref:System.Security.Cryptography.Xml.EncryptedData> element."},{"pos":[7496,7779],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToEncryptXMLElementX509#10<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#10)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToEncryptXMLElementX509#10<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#10)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[HowToEncryptXMLElementX509#10](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#10)]\n [!code-vb[HowToEncryptXMLElementX509#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#10)]"},{"content":"Save the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object.","pos":[7789,7835],"source":"Save the <xref:System.Xml.XmlDocument> object."},{"pos":[7846,8129],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToEncryptXMLElementX509#11<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#11)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToEncryptXMLElementX509#11<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#11)</ept><ept id=\"p3\">]</ept>","leadings":["","    "],"source":"[!code-csharp[HowToEncryptXMLElementX509#11](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#11)]\n [!code-vb[HowToEncryptXMLElementX509#11](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#11)]"},{"pos":[8138,8145],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example assumes that a file named <ph id=\"ph1\">`\"test.xml\"`</ph> exists in the same directory as the compiled program.","pos":[8149,8254],"source":"This example assumes that a file named `\"test.xml\"` exists in the same directory as the compiled program."},{"content":"It also assumes that <ph id=\"ph1\">`\"test.xml\"`</ph> contains a <ph id=\"ph2\">`\"creditcard\"`</ph> element.","pos":[8256,8324],"source":"  It also assumes that `\"test.xml\"` contains a `\"creditcard\"` element."},{"content":"You can place the following XML into a file called <ph id=\"ph1\">`test.xml`</ph> and use it with this example.","pos":[8326,8417],"source":"  You can place the following XML into a file called `test.xml` and use it with this example."},{"pos":[8571,8846],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>HowToEncryptXMLElementX509#1<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>HowToEncryptXMLElementX509#1<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[HowToEncryptXMLElementX509#1](../../../samples/snippets/csharp/VS_Snippets_CLR/HowToEncryptXMLElementX509/cs/sample.cs#1)]\n [!code-vb[HowToEncryptXMLElementX509#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/HowToEncryptXMLElementX509/vb/sample.vb#1)]"},{"pos":[8855,8873],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[8883,8965],"content":"To compile this example, you need to include a reference to <ph id=\"ph1\">`System.Security.dll`</ph>.","source":"To compile this example, you need to include a reference to `System.Security.dll`."},{"content":"Include the following namespaces: <ph id=\"ph1\">&lt;xref:System.Xml&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Security.Cryptography&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Security.Cryptography.Xml&gt;</ph>.","pos":[8975,9109],"source":"Include the following namespaces: <xref:System.Xml>, <xref:System.Security.Cryptography>, and <xref:System.Security.Cryptography.Xml>."},{"pos":[9118,9141],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"The X.509 certificate used in this example is for test purposes only.","pos":[9145,9214]},{"content":"Applications should use an X.509 certificate generated by a trusted certificate authority or use a certificate generated by the Microsoft Windows Certificate Server.","pos":[9216,9381]},{"pos":[9390,9398],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Security.Cryptography.Xml&gt;</ph>","pos":[9402,9441],"source":"<xref:System.Security.Cryptography.Xml> "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Decrypt XML Elements with X.509 Certificates<ept id=\"p1\">](../../../docs/standard/security/how-to-decrypt-xml-elements-with-x-509-certificates.md)</ept>","pos":[9445,9588],"source":" [How to: Decrypt XML Elements with X.509 Certificates](../../../docs/standard/security/how-to-decrypt-xml-elements-with-x-509-certificates.md)"}]}