{"content":"---\ntitle: \"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"registry, Visual Basic\"\nms.assetid: 4a0dcce0-c27b-4199-baa8-ee4528da6a56\ncaps.latest.revision: 20\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)\nAlthough `My.Computer.Registry` should cover your basic needs when programming against the registry, you can also use the <xref:Microsoft.Win32.Registry> and <xref:Microsoft.Win32.RegistryKey> classes in the <xref:Microsoft.Win32> namespace of the [!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort_md.md)].  \n  \n## Keys in the Registry Class  \n The <xref:Microsoft.Win32.Registry> class supplies the base registry keys that can be used to access subkeys and their values. The base keys themselves are read-only. The following table lists and describes the seven keys exposed by the <xref:Microsoft.Win32.Registry> class.  \n  \n|**Key**|**Description**|  \n|-------------|---------------------|  \n|<xref:Microsoft.Win32.Registry.ClassesRoot>|Defines the types of documents and the properties associated with those types.|  \n|<xref:Microsoft.Win32.Registry.CurrentConfig>|Contains hardware configuration information that is not user-specific.|  \n|<xref:Microsoft.Win32.Registry.CurrentUser>|Contains information about the current user preferences, such as environmental variables.|  \n|<xref:Microsoft.Win32.Registry.DynData>|Contains dynamic registry data, such as that used by Virtual Device Drivers.|  \n|<xref:Microsoft.Win32.Registry.LocalMachine>|Contains five subkeys (Hardware, SAM, Security, Software, and System) that hold the configuration data for the local computer.|  \n|<xref:Microsoft.Win32.Registry.PerformanceData>|Contains performance information for software components.|  \n|<xref:Microsoft.Win32.Registry.Users>|Contains information about the default user preferences.|  \n  \n> [!IMPORTANT]\n>  It is more secure to write data to the current user (<xref:Microsoft.Win32.Registry.CurrentUser>) than to the local computer (<xref:Microsoft.Win32.Registry.LocalMachine>). A condition that's typically referred to as \"squatting\" occurs when the key you are creating was previously created by another, possibly malicious, process. To prevent this from occurring, use a method, such as <xref:Microsoft.Win32.RegistryKey.GetValue%2A>, that returns `Nothing` if the key does not already exist.  \n  \n## Reading a Value from the Registry  \n The following code shows how to read a string from HKEY_CURRENT_USER.  \n  \n [!code-vb[VbResourceTasks#20](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/reading-from-and-writing-to-the-registry-using-the-microsoft-win32-namespace_1.vb)]  \n  \n The following code reads, increments, and then writes a string to HKEY_CURRENT_USER.  \n  \n [!code-vb[VbResourceTasks#21](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/reading-from-and-writing-to-the-registry-using-the-microsoft-win32-namespace_2.vb)]  \n  \n## See Also  \n <xref:System.SystemException>   \n <xref:System.ApplicationException>   \n <xref:Microsoft.VisualBasic.MyServices.RegistryProxy>   \n [Try...Catch...Finally Statement](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)   \n [Reading from and Writing to the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)   \n [Security and the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/security-and-the-registry.md)","nodes":[{"pos":[12,120],"content":"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic) | Microsoft Docs","pos":[0,108]}]},{"pos":[670,761],"content":"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)","linkify":"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)","nodes":[{"content":"Reading from and Writing to the Registry Using the Microsoft.Win32 Namespace (Visual Basic)","pos":[0,91]}]},{"pos":[762,1097],"content":"Although <ph id=\"ph1\">`My.Computer.Registry`</ph> should cover your basic needs when programming against the registry, you can also use the <ph id=\"ph2\">&lt;xref:Microsoft.Win32.Registry&gt;</ph> and <ph id=\"ph3\">&lt;xref:Microsoft.Win32.RegistryKey&gt;</ph> classes in the <ph id=\"ph4\">&lt;xref:Microsoft.Win32&gt;</ph> namespace of the <ph id=\"ph5\">[!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort_md.md)]</ph>.","source":"Although `My.Computer.Registry` should cover your basic needs when programming against the registry, you can also use the <xref:Microsoft.Win32.Registry> and <xref:Microsoft.Win32.RegistryKey> classes in the <xref:Microsoft.Win32> namespace of the [!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort_md.md)]."},{"pos":[1106,1132],"content":"Keys in the Registry Class","linkify":"Keys in the Registry Class","nodes":[{"content":"Keys in the Registry Class","pos":[0,26]}]},{"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.Win32.Registry&gt;</ph> class supplies the base registry keys that can be used to access subkeys and their values.","pos":[1136,1262],"source":"The <xref:Microsoft.Win32.Registry> class supplies the base registry keys that can be used to access subkeys and their values."},{"content":"The base keys themselves are read-only.","pos":[1263,1302]},{"content":"The following table lists and describes the seven keys exposed by the <ph id=\"ph1\">&lt;xref:Microsoft.Win32.Registry&gt;</ph> class.","pos":[1303,1411],"source":" The following table lists and describes the seven keys exposed by the <xref:Microsoft.Win32.Registry> class."},{"pos":[1418,1425],"content":"<bpt id=\"p1\">**</bpt>Key<ept id=\"p1\">**</ept>","source":"**Key**"},{"pos":[1426,1441],"content":"<bpt id=\"p1\">**</bpt>Description<ept id=\"p1\">**</ept>","source":"**Description**"},{"content":"Defines the types of documents and the properties associated with those types.","pos":[1530,1608]},{"content":"Contains hardware configuration information that is not user-specific.","pos":[1659,1729]},{"content":"Contains information about the current user preferences, such as environmental variables.","pos":[1778,1867]},{"content":"Contains dynamic registry data, such as that used by Virtual Device Drivers.","pos":[1912,1988]},{"content":"Contains five subkeys (Hardware, SAM, Security, Software, and System) that hold the configuration data for the local computer.","pos":[2038,2164]},{"content":"Contains performance information for software components.","pos":[2217,2274]},{"content":"Contains information about the default user preferences.","pos":[2317,2373]},{"pos":[2382,2887],"content":"[!IMPORTANT]\n It is more secure to write data to the current user (<xref:Microsoft.Win32.Registry.CurrentUser>) than to the local computer (<xref:Microsoft.Win32.Registry.LocalMachine>). A condition that's typically referred to as \"squatting\" occurs when the key you are creating was previously created by another, possibly malicious, process. To prevent this from occurring, use a method, such as <xref:Microsoft.Win32.RegistryKey.GetValue%2A>, that returns `Nothing` if the key does not already exist.","leadings":["","> "],"nodes":[{"content":" It is more secure to write data to the current user (<xref:Microsoft.Win32.Registry.CurrentUser>) than to the local computer (<xref:Microsoft.Win32.Registry.LocalMachine>). A condition that's typically referred to as \"squatting\" occurs when the key you are creating was previously created by another, possibly malicious, process. To prevent this from occurring, use a method, such as <xref:Microsoft.Win32.RegistryKey.GetValue%2A>, that returns `Nothing` if the key does not already exist.","pos":[13,503],"nodes":[{"content":"It is more secure to write data to the current user (<ph id=\"ph1\">&lt;xref:Microsoft.Win32.Registry.CurrentUser&gt;</ph>) than to the local computer (<ph id=\"ph2\">&lt;xref:Microsoft.Win32.Registry.LocalMachine&gt;</ph>).","pos":[1,173],"source":" It is more secure to write data to the current user (<xref:Microsoft.Win32.Registry.CurrentUser>) than to the local computer (<xref:Microsoft.Win32.Registry.LocalMachine>)."},{"content":"A condition that's typically referred to as \"squatting\" occurs when the key you are creating was previously created by another, possibly malicious, process.","pos":[174,330]},{"content":"To prevent this from occurring, use a method, such as <ph id=\"ph1\">&lt;xref:Microsoft.Win32.RegistryKey.GetValue%2A&gt;</ph>, that returns <ph id=\"ph2\">`Nothing`</ph> if the key does not already exist.","pos":[331,490],"source":" To prevent this from occurring, use a method, such as <xref:Microsoft.Win32.RegistryKey.GetValue%2A>, that returns `Nothing` if the key does not already exist."}]}]},{"pos":[2896,2929],"content":"Reading a Value from the Registry","linkify":"Reading a Value from the Registry","nodes":[{"content":"Reading a Value from the Registry","pos":[0,33]}]},{"content":"The following code shows how to read a string from HKEY_CURRENT_USER.","pos":[2933,3002]},{"pos":[3009,3218],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbResourceTasks#20<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/reading-from-and-writing-to-the-registry-using-the-microsoft-win32-namespace_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbResourceTasks#20](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/reading-from-and-writing-to-the-registry-using-the-microsoft-win32-namespace_1.vb)]"},{"content":"The following code reads, increments, and then writes a string to HKEY_CURRENT_USER.","pos":[3225,3309]},{"pos":[3316,3525],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbResourceTasks#21<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/reading-from-and-writing-to-the-registry-using-the-microsoft-win32-namespace_2.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbResourceTasks#21](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/reading-from-and-writing-to-the-registry-using-the-microsoft-win32-namespace_2.vb)]"},{"pos":[3534,3542],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.SystemException&gt;</ph>","pos":[3546,3575],"source":"<xref:System.SystemException> "},{"content":"<ph id=\"ph1\">&lt;xref:System.ApplicationException&gt;</ph>","pos":[3580,3614],"source":" <xref:System.ApplicationException> "},{"content":"<ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.MyServices.RegistryProxy&gt;</ph>","pos":[3619,3672],"source":" <xref:Microsoft.VisualBasic.MyServices.RegistryProxy> "},{"content":"<bpt id=\"p1\"> [</bpt>Try...Catch...Finally Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)</ept><ph id=\"ph1\"> </ph>","pos":[3676,3798],"source":" [Try...Catch...Finally Statement](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Reading from and Writing to the Registry<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md)</ept><ph id=\"ph1\"> </ph>","pos":[3801,3962],"source":" [Reading from and Writing to the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Security and the Registry<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/security-and-the-registry.md)</ept>","pos":[3965,4095],"source":" [Security and the Registry](../../../../visual-basic/developing-apps/programming/computer-resources/security-and-the-registry.md)"}]}