{"content":"---\ntitle: \"Sorting and Filtering Data | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: fdd9c753-39df-48cd-9822-2781afe76200\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Sorting and Filtering Data\nThe <xref:System.Data.DataView> provides several ways of sorting and filtering data in a <xref:System.Data.DataTable>:  \n  \n-   You can use the <xref:System.Data.DataView.Sort%2A> property to specify single or multiple column sort orders and include ASC (ascending) and DESC (descending) parameters.  \n  \n-   You can use the <xref:System.Data.DataView.ApplyDefaultSort%2A> property to automatically create a sort order, in ascending order, based on the primary key column or columns of the table. <xref:System.Data.DataView.ApplyDefaultSort%2A> only applies when the **Sort** property is a null reference or an empty string, and when the table has a primary key defined.  \n  \n-   You can use the <xref:System.Data.DataView.RowFilter%2A> property to specify subsets of rows based on their column values. For details about valid expressions for the **RowFilter** property, see the reference information for the <xref:System.Data.DataColumn.Expression%2A> property of the <xref:System.Data.DataColumn> class.  \n  \n     If you want to return the results of a particular query on the data, as opposed to providing a dynamic view of a subset of the data, use the <xref:System.Data.DataView.Find%2A> or <xref:System.Data.DataView.FindRows%2A> methods of the **DataView** to achieve best performance rather than setting the **RowFilter** property. Setting the **RowFilter** property rebuilds the index for the data, adding overhead to your application and decreasing performance. The **RowFilter** property is best used in a data-bound application where a bound control displays filtered results. The **Find** and **FindRows** methods leverage the current index without requiring the index to be rebuilt. For more information about the **Find** and **FindRows** methods, see [Finding Rows](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/finding-rows.md).  \n  \n-   You can use the <xref:System.Data.DataView.RowStateFilter%2A> property to specify which row versions to view. The **DataView** implicitly manages which row version to expose depending upon the **RowState** of the underlying row. For example, if the **RowStateFilter** is set to **DataViewRowState.Deleted**, the **DataView** exposes the **Original** row version of all **Deleted** rows because there is no **Current** row version. You can determine which row version of a row is being exposed by using the **RowVersion** property of the **DataRowView**.  \n  \n     The following table shows the options for **DataViewRowState**.  \n  \n    |DataViewRowState options|Description|  \n    |------------------------------|-----------------|  \n    |**CurrentRows**|The **Current** row version of all **Unchanged**, **Added**, and **Modified** rows. This is the default.|  \n    |**Added**|The **Current** row version of all **Added** rows.|  \n    |**Deleted**|The **Original** row version of all **Deleted** rows.|  \n    |**ModifiedCurrent**|The **Current** row version of all **Modified** rows.|  \n    |**ModifiedOriginal**|The **Original** row version of all **Modified** rows.|  \n    |**None**|No rows.|  \n    |**OriginalRows**|The **Original** row version of all **Unchanged**, **Modified**, and **Deleted** rows.|  \n    |**Unchanged**|The **Current** row version of all **Unchanged** rows.|  \n  \n For more information about row states and row versions, see [Row States and Row Versions](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md).  \n  \n The following code example creates a view that shows all the products where the number of units in stock is less than or equal to the reorder level, sorted first by supplier ID and then by product name.  \n  \n```vb  \nDim prodView As DataView = New DataView(prodDS.Tables(\"Products\"), _  \n   \"UnitsInStock <= ReorderLevel\", _  \n   \"SupplierID, ProductName\", _  \n   DataViewRowState.CurrentRows)  \n  \n```  \n  \n```csharp  \nDataView prodView = new DataView(prodDS.Tables[\"Products\"],  \n   \"UnitsInStock <= ReorderLevel\",  \n   \"SupplierID, ProductName\",  \n   DataViewRowState.CurrentRows);  \n```  \n  \n## See Also  \n <xref:System.Data.DataViewRowState>   \n <xref:System.Data.DataColumn.Expression%2A?displayProperty=fullName>   \n <xref:System.Data.DataTable>   \n <xref:System.Data.DataView>   \n [DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataviews.md)   \n [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)","nodes":[{"pos":[4,357],"nodes":[{"content":"Sorting and Filtering Data | Microsoft Docs","nodes":[{"pos":[0,43],"content":"Sorting and Filtering Data | Microsoft Docs","nodes":[{"content":"Sorting and Filtering Data | Microsoft Docs","pos":[0,43]}]}],"pos":[6,52],"yaml":true}],"content":"title: \"Sorting and Filtering Data | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: fdd9c753-39df-48cd-9822-2781afe76200\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","yamlblock":true},{"pos":[364,390],"content":"Sorting and Filtering Data","linkify":"Sorting and Filtering Data","nodes":[{"content":"Sorting and Filtering Data","pos":[0,26]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataView&gt;</ph> provides several ways of sorting and filtering data in a <ph id=\"ph2\">&lt;xref:System.Data.DataTable&gt;</ph>:","pos":[391,509],"source":"The <xref:System.Data.DataView> provides several ways of sorting and filtering data in a <xref:System.Data.DataTable>:"},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Data.DataView.Sort%2A&gt;</ph> property to specify single or multiple column sort orders and include ASC (ascending) and DESC (descending) parameters.","pos":[519,690],"source":"You can use the <xref:System.Data.DataView.Sort%2A> property to specify single or multiple column sort orders and include ASC (ascending) and DESC (descending) parameters."},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Data.DataView.ApplyDefaultSort%2A&gt;</ph> property to automatically create a sort order, in ascending order, based on the primary key column or columns of the table.","pos":[700,887],"source":"You can use the <xref:System.Data.DataView.ApplyDefaultSort%2A> property to automatically create a sort order, in ascending order, based on the primary key column or columns of the table."},{"content":"<ph id=\"ph1\">&lt;xref:System.Data.DataView.ApplyDefaultSort%2A&gt;</ph> only applies when the <bpt id=\"p1\">**</bpt>Sort<ept id=\"p1\">**</ept> property is a null reference or an empty string, and when the table has a primary key defined.","pos":[888,1061],"source":" <xref:System.Data.DataView.ApplyDefaultSort%2A> only applies when the **Sort** property is a null reference or an empty string, and when the table has a primary key defined."},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Data.DataView.RowFilter%2A&gt;</ph> property to specify subsets of rows based on their column values.","pos":[1071,1193],"source":"You can use the <xref:System.Data.DataView.RowFilter%2A> property to specify subsets of rows based on their column values."},{"content":"For details about valid expressions for the <bpt id=\"p1\">**</bpt>RowFilter<ept id=\"p1\">**</ept> property, see the reference information for the <ph id=\"ph1\">&lt;xref:System.Data.DataColumn.Expression%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Data.DataColumn&gt;</ph> class.","pos":[1194,1396],"source":" For details about valid expressions for the **RowFilter** property, see the reference information for the <xref:System.Data.DataColumn.Expression%2A> property of the <xref:System.Data.DataColumn> class."},{"content":"If you want to return the results of a particular query on the data, as opposed to providing a dynamic view of a subset of the data, use the <ph id=\"ph1\">&lt;xref:System.Data.DataView.Find%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Data.DataView.FindRows%2A&gt;</ph> methods of the <bpt id=\"p1\">**</bpt>DataView<ept id=\"p1\">**</ept> to achieve best performance rather than setting the <bpt id=\"p2\">**</bpt>RowFilter<ept id=\"p2\">**</ept> property.","pos":[1407,1730],"source":"If you want to return the results of a particular query on the data, as opposed to providing a dynamic view of a subset of the data, use the <xref:System.Data.DataView.Find%2A> or <xref:System.Data.DataView.FindRows%2A> methods of the **DataView** to achieve best performance rather than setting the **RowFilter** property."},{"content":"Setting the <bpt id=\"p1\">**</bpt>RowFilter<ept id=\"p1\">**</ept> property rebuilds the index for the data, adding overhead to your application and decreasing performance.","pos":[1731,1862],"source":" Setting the **RowFilter** property rebuilds the index for the data, adding overhead to your application and decreasing performance."},{"content":"The <bpt id=\"p1\">**</bpt>RowFilter<ept id=\"p1\">**</ept> property is best used in a data-bound application where a bound control displays filtered results.","pos":[1863,1979],"source":" The **RowFilter** property is best used in a data-bound application where a bound control displays filtered results."},{"content":"The <bpt id=\"p1\">**</bpt>Find<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>FindRows<ept id=\"p2\">**</ept> methods leverage the current index without requiring the index to be rebuilt.","pos":[1980,2087],"source":" The **Find** and **FindRows** methods leverage the current index without requiring the index to be rebuilt."},{"content":"For more information about the <bpt id=\"p1\">**</bpt>Find<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>FindRows<ept id=\"p2\">**</ept> methods, see <bpt id=\"p3\">[</bpt>Finding Rows<ept id=\"p3\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/finding-rows.md)</ept>.","pos":[2088,2259],"source":" For more information about the **Find** and **FindRows** methods, see [Finding Rows](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/finding-rows.md)."},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Data.DataView.RowStateFilter%2A&gt;</ph> property to specify which row versions to view.","pos":[2269,2378],"source":"You can use the <xref:System.Data.DataView.RowStateFilter%2A> property to specify which row versions to view."},{"content":"The <bpt id=\"p1\">**</bpt>DataView<ept id=\"p1\">**</ept> implicitly manages which row version to expose depending upon the <bpt id=\"p2\">**</bpt>RowState<ept id=\"p2\">**</ept> of the underlying row.","pos":[2379,2497],"source":" The **DataView** implicitly manages which row version to expose depending upon the **RowState** of the underlying row."},{"content":"For example, if the <bpt id=\"p1\">**</bpt>RowStateFilter<ept id=\"p1\">**</ept> is set to <bpt id=\"p2\">**</bpt>DataViewRowState.Deleted<ept id=\"p2\">**</ept>, the <bpt id=\"p3\">**</bpt>DataView<ept id=\"p3\">**</ept> exposes the <bpt id=\"p4\">**</bpt>Original<ept id=\"p4\">**</ept> row version of all <bpt id=\"p5\">**</bpt>Deleted<ept id=\"p5\">**</ept> rows because there is no <bpt id=\"p6\">**</bpt>Current<ept id=\"p6\">**</ept> row version.","pos":[2498,2699],"source":" For example, if the **RowStateFilter** is set to **DataViewRowState.Deleted**, the **DataView** exposes the **Original** row version of all **Deleted** rows because there is no **Current** row version."},{"content":"You can determine which row version of a row is being exposed by using the <bpt id=\"p1\">**</bpt>RowVersion<ept id=\"p1\">**</ept> property of the <bpt id=\"p2\">**</bpt>DataRowView<ept id=\"p2\">**</ept>.","pos":[2700,2822],"source":" You can determine which row version of a row is being exposed by using the **RowVersion** property of the **DataRowView**."},{"pos":[2833,2896],"content":"The following table shows the options for <bpt id=\"p1\">**</bpt>DataViewRowState<ept id=\"p1\">**</ept>.","source":"The following table shows the options for **DataViewRowState**."},{"content":"DataViewRowState options","pos":[2907,2931]},{"content":"Description","pos":[2932,2943]},{"pos":[3009,3024],"content":"<bpt id=\"p1\">**</bpt>CurrentRows<ept id=\"p1\">**</ept>","source":"**CurrentRows**"},{"content":"The <bpt id=\"p1\">**</bpt>Current<ept id=\"p1\">**</ept> row version of all <bpt id=\"p2\">**</bpt>Unchanged<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Added<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>Modified<ept id=\"p4\">**</ept> rows.","pos":[3025,3108],"source":"The **Current** row version of all **Unchanged**, **Added**, and **Modified** rows."},{"content":"This is the default.","pos":[3109,3129]},{"pos":[3138,3147],"content":"<bpt id=\"p1\">**</bpt>Added<ept id=\"p1\">**</ept>","source":"**Added**"},{"pos":[3148,3198],"content":"The <bpt id=\"p1\">**</bpt>Current<ept id=\"p1\">**</ept> row version of all <bpt id=\"p2\">**</bpt>Added<ept id=\"p2\">**</ept> rows.","source":"The **Current** row version of all **Added** rows."},{"pos":[3207,3218],"content":"<bpt id=\"p1\">**</bpt>Deleted<ept id=\"p1\">**</ept>","source":"**Deleted**"},{"pos":[3219,3272],"content":"The <bpt id=\"p1\">**</bpt>Original<ept id=\"p1\">**</ept> row version of all <bpt id=\"p2\">**</bpt>Deleted<ept id=\"p2\">**</ept> rows.","source":"The **Original** row version of all **Deleted** rows."},{"pos":[3281,3300],"content":"<bpt id=\"p1\">**</bpt>ModifiedCurrent<ept id=\"p1\">**</ept>","source":"**ModifiedCurrent**"},{"pos":[3301,3354],"content":"The <bpt id=\"p1\">**</bpt>Current<ept id=\"p1\">**</ept> row version of all <bpt id=\"p2\">**</bpt>Modified<ept id=\"p2\">**</ept> rows.","source":"The **Current** row version of all **Modified** rows."},{"pos":[3363,3383],"content":"<bpt id=\"p1\">**</bpt>ModifiedOriginal<ept id=\"p1\">**</ept>","source":"**ModifiedOriginal**"},{"pos":[3384,3438],"content":"The <bpt id=\"p1\">**</bpt>Original<ept id=\"p1\">**</ept> row version of all <bpt id=\"p2\">**</bpt>Modified<ept id=\"p2\">**</ept> rows.","source":"The **Original** row version of all **Modified** rows."},{"pos":[3447,3455],"content":"<bpt id=\"p1\">**</bpt>None<ept id=\"p1\">**</ept>","source":"**None**"},{"content":"No rows.","pos":[3456,3464]},{"pos":[3473,3489],"content":"<bpt id=\"p1\">**</bpt>OriginalRows<ept id=\"p1\">**</ept>","source":"**OriginalRows**"},{"pos":[3490,3576],"content":"The <bpt id=\"p1\">**</bpt>Original<ept id=\"p1\">**</ept> row version of all <bpt id=\"p2\">**</bpt>Unchanged<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Modified<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>Deleted<ept id=\"p4\">**</ept> rows.","source":"The **Original** row version of all **Unchanged**, **Modified**, and **Deleted** rows."},{"pos":[3585,3598],"content":"<bpt id=\"p1\">**</bpt>Unchanged<ept id=\"p1\">**</ept>","source":"**Unchanged**"},{"pos":[3599,3653],"content":"The <bpt id=\"p1\">**</bpt>Current<ept id=\"p1\">**</ept> row version of all <bpt id=\"p2\">**</bpt>Unchanged<ept id=\"p2\">**</ept> rows.","source":"The **Current** row version of all **Unchanged** rows."},{"pos":[3661,3852],"content":"For more information about row states and row versions, see <bpt id=\"p1\">[</bpt>Row States and Row Versions<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)</ept>.","source":"For more information about row states and row versions, see [Row States and Row Versions](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)."},{"content":"The following code example creates a view that shows all the products where the number of units in stock is less than or equal to the reorder level, sorted first by supplier ID and then by product name.","pos":[3859,4061]},{"pos":[4457,4465],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Data.DataViewRowState&gt;</ph>","pos":[4469,4504],"source":"<xref:System.Data.DataViewRowState> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Data.DataColumn.Expression%2A?displayProperty=fullName&gt;</ph>","pos":[4509,4577],"source":"<xref:System.Data.DataColumn.Expression%2A?displayProperty=fullName> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Data.DataTable&gt;</ph>","pos":[4582,4610],"source":"<xref:System.Data.DataTable> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Data.DataView&gt;</ph>","pos":[4615,4642],"source":"<xref:System.Data.DataView> "},{"content":"<bpt id=\"p1\">[</bpt>DataViews<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataviews.md)</ept><ph id=\"ph1\"> </ph>","pos":[4647,4742],"source":"[DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataviews.md) "},{"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=217917)</ept>","pos":[4746,4849],"source":"[ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)"}]}