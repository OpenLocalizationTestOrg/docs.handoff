{"content":"---\ntitle: \"Filtering My.Application.Log Output (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"My.Log object, filtering output\"\n  - \"My.Application.Log object, filtering output\"\n  - \"application event logs, output filtering\"\nms.assetid: 2c0a457a-38a4-49e1-934d-a51320b7b4ca\n---\n# Walkthrough: Filtering My.Application.Log Output (Visual Basic)\nThis walkthrough demonstrates how to change the default log filtering for the `My.Application.Log` object, to control what information is passed from the `Log` object to the listeners and what information is written by the listeners. You can change the logging behavior even after building the application, because the configuration information is stored in the application's configuration file.  \n  \n## Getting Started  \n Each message that `My.Application.Log` writes has an associated severity level, which filtering mechanisms use to control the log output. This sample application uses `My.Application.Log` methods to write several log messages with different severity levels.  \n  \n#### To build the sample application  \n  \n1.  Open a new Visual Basic Windows Application project.  \n  \n2.  Add a button named Button1 to Form1.  \n  \n3.  In the <xref:System.Windows.Forms.Control.Click> event handler for Button1, add the following code:  \n  \n     [!code-vb[VbVbcnMyApplicationLogFiltering#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyApplicationLogFiltering/VB/Form1.vb#1)]  \n  \n4.  Run the application in the debugger.  \n  \n5.  Press **Button1**.  \n  \n     The application writes the following information to the application's debug output and log file.  \n  \n     `DefaultSource Information: 0 : In Button1_Click`  \n  \n     `DefaultSource Error: 2 : Error in the application.`  \n  \n6.  Close the application.  \n  \n     For information on how to view the application's debug output window, see [Output Window](/visualstudio/ide/reference/output-window). For information on the location of the application's log file, see [Walkthrough: Determining Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md).  \n  \n    > [!NOTE]\n    >  By default, the application flushes the log-file output when the application closes.  \n  \n     In the example above, the second call to the <xref:Microsoft.VisualBasic.Logging.Log.WriteEntry%2A> method and the call to the <xref:Microsoft.VisualBasic.Logging.Log.WriteException%2A> method produces log output, while the first and last calls to the `WriteEntry` method do not. This is because the severity levels of `WriteEntry` and `WriteException` are \"Information\" and \"Error\", both of which are allowed by the `My.Application.Log` object's default log filtering. However, events with \"Start\" and \"Stop\" severity levels are prevented from producing log output.  \n  \n## Filtering for All My.Application.Log Listeners  \n The `My.Application.Log` object uses a <xref:System.Diagnostics.SourceSwitch> named `DefaultSwitch` to control which messages it passes from the `WriteEntry` and `WriteException` methods to the log listeners. You can configure `DefaultSwitch` in the application's configuration file by setting its value to one of the <xref:System.Diagnostics.SourceLevels> enumeration values. By default, its value is \"Information\".  \n  \n This table shows the severity level required for Log to write a message to the listeners, given a particular `DefaultSwitch` setting.  \n  \n|DefaultSwitch Value|Message severity required for output|  \n|---|---| \n|`Critical`|`Critical`|  \n|`Error`|`Critical` or `Error`|  \n|`Warning`|`Critical`, `Error`, or `Warning`|  \n|`Information`|`Critical`, `Error`, `Warning`, or `Information`|  \n|`Verbose`|`Critical`, `Error`, `Warning`, `Information`, or `Verbose`|  \n|`ActivityTracing`|`Start`, `Stop`, `Suspend`, `Resume`, or `Transfer`|  \n|`All`|All messages are allowed.|  \n|`Off`|All messages are blocked.|  \n  \n> [!NOTE]\n>  The `WriteEntry` and `WriteException` methods each have an overload that does not specify a severity level. The implicit severity level for the `WriteEntry` overload is \"Information\", and the implicit severity level for the `WriteException` overload is \"Error\".  \n  \n This table explains the log output shown in the previous example: with the default `DefaultSwitch` setting of \"Information\", only the second call to the `WriteEntry` method and the call to the `WriteException` method produce log output.  \n  \n#### To log only activity tracing events  \n  \n1.  Right-click app.config in the **Solution Explorer** and select **Open**.  \n  \n     -or-  \n  \n     If there is no app.config file:  \n  \n    1.  On the **Project** menu, choose **Add New Item**.  \n  \n    2.  From the **Add New Item** dialog box, choose **Application Configuration File**.  \n  \n    3.  Click **Add**.  \n  \n2.  Locate the `<switches>` section, which is in the `<system.diagnostics>` section, which is in the top-level `<configuration>` section.  \n  \n3.  Find the element that adds `DefaultSwitch` to the collection of switches. It should look similar to this element:  \n  \n     `<add name=\"DefaultSwitch\" value=\"Information\" />`  \n  \n4.  Change the value of the `value` attribute to \"ActivityTracing\".  \n  \n5.  The content of the app.config file should be similar to the following XML:  \n  \n    ```xml  \n    <?xml version=\"1.0\" encoding=\"utf-8\" ?>  \n    <configuration>  \n      <system.diagnostics>  \n        <sources>  \n          <!-- This section configures My.Application.Log -->  \n          <source name=\"DefaultSource\" switchName=\"DefaultSwitch\">  \n            <listeners>  \n              <add name=\"FileLog\"/>  \n            </listeners>  \n          </source>  \n        </sources>  \n        <switches>  \n          <add name=\"DefaultSwitch\" value=\"ActivityTracing\" />  \n        </switches>  \n        <sharedListeners>  \n          <add name=\"FileLog\"  \n               type=\"Microsoft.VisualBasic.Logging.FileLogTraceListener,   \n                     Microsoft.VisualBasic, Version=8.0.0.0,   \n                     Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a,   \n                     processorArchitecture=MSIL\"   \n               initializeData=\"FileLogWriter\"/>  \n        </sharedListeners>  \n      </system.diagnostics>  \n    </configuration>  \n    ```  \n  \n6.  Run the application in the debugger.  \n  \n7.  Press **Button1**.  \n  \n     The application writes the following information to the application's debug output and log file:  \n  \n     `DefaultSource Start: 4 : Entering Button1_Click`  \n  \n     `DefaultSource Stop: 5 : Leaving Button1_Click`  \n  \n8.  Close the application.  \n  \n9. Change the value of the `value` attribute back to \"Information\".  \n  \n    > [!NOTE]\n    >  The `DefaultSwitch` switch setting controls only `My.Application.Log`. It does not change how the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] <xref:System.Diagnostics.Trace?displayProperty=nameWithType> and <xref:System.Diagnostics.Debug?displayProperty=nameWithType> classes behave.  \n  \n## Individual Filtering For My.Application.Log Listeners  \n The previous example shows how to change the filtering for all `My.Application.Log` output. This example demonstrates how to filter an individual log listener. By default, an application has two listeners that write to the application's debug output and the log file.  \n  \n The configuration file controls the behavior of the log listeners by allowing each one to have a filter, which is similar to a switch for `My.Application.Log`. A log listener will output a message only if the message's severity is allowed by both the log's `DefaultSwitch` and the log listener's filter.  \n  \n This example demonstrates how to configure filtering for a new debug listener and add it to the `Log` object. The default debug listener should be removed from the `Log` object, so it is clear that the debug messages come from the new debug listener.  \n  \n#### To log only activity-tracing events  \n  \n1.  Right-click app.config in the **Solution Explorer** and choose **Open**.  \n  \n     -or-  \n  \n     If there is no app.config file:  \n  \n    1.  On the **Project** menu, choose **Add New Item**.  \n  \n    2.  From the **Add New Item** dialog box, choose **Application Configuration File**.  \n  \n    3.  Click **Add**.  \n  \n2.  Right-click app.config in **Solution Explorer**. Choose **Open**.  \n  \n3.  Locate the `<listeners>` section, in the `<source>` section with the `name` attribute \"DefaultSource\", which is under the `<sources>` section. The `<sources>` section is under the `<system.diagnostics>` section, in the top-level `<configuration>` section.  \n  \n4.  Add this element to the `<listeners>` section:  \n  \n    ```xml  \n    <!-- Remove the default debug listener. -->  \n    <remove name=\"Default\"/>  \n    <!-- Add a filterable debug listener. -->  \n    <add name=\"NewDefault\"/>  \n    ```  \n  \n5.  Locate the `<sharedListeners>` section, in the `<system.diagnostics>` section, in the top-level `<configuration>` section.  \n  \n6.  Add this element to that `<sharedListeners>` section:  \n  \n    ```xml  \n    <add name=\"NewDefault\"   \n         type=\"System.Diagnostics.DefaultTraceListener,   \n               System, Version=2.0.0.0, Culture=neutral,   \n               PublicKeyToken=b77a5c561934e089,   \n               processorArchitecture=MSIL\">  \n        <filter type=\"System.Diagnostics.EventTypeFilter\"   \n                initializeData=\"Error\" />  \n    </add>  \n    ```  \n  \n     The <xref:System.Diagnostics.EventTypeFilter> filter takes one of the <xref:System.Diagnostics.SourceLevels> enumeration values as its `initializeData` attribute.  \n  \n7.  The content of the app.config file should be similar to the following XML:  \n  \n    ```xml  \n    <?xml version=\"1.0\" encoding=\"utf-8\" ?>  \n    <configuration>  \n      <system.diagnostics>  \n        <sources>  \n          <!-- This section configures My.Application.Log -->  \n          <source name=\"DefaultSource\" switchName=\"DefaultSwitch\">  \n            <listeners>  \n              <add name=\"FileLog\"/>  \n              <!-- Remove the default debug listener. -->  \n              <remove name=\"Default\"/>  \n              <!-- Add a filterable debug listener. -->  \n              <add name=\"NewDefault\"/>  \n            </listeners>  \n          </source>  \n        </sources>  \n        <switches>  \n          <add name=\"DefaultSwitch\" value=\"Information\" />  \n        </switches>  \n        <sharedListeners>  \n          <add name=\"FileLog\"  \n               type=\"Microsoft.VisualBasic.Logging.FileLogTraceListener,   \n                     Microsoft.VisualBasic, Version=8.0.0.0,   \n                     Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a,   \n                     processorArchitecture=MSIL\"   \n               initializeData=\"FileLogWriter\"/>  \n          <add name=\"NewDefault\"   \n               type=\"System.Diagnostics.DefaultTraceListener,   \n                     System, Version=2.0.0.0, Culture=neutral,   \n                     PublicKeyToken=b77a5c561934e089,   \n                     processorArchitecture=MSIL\">  \n            <filter type=\"System.Diagnostics.EventTypeFilter\"   \n                    initializeData=\"Error\" />  \n          </add>  \n        </sharedListeners>  \n      </system.diagnostics>  \n    </configuration>  \n    ```  \n  \n8.  Run the application in the debugger.  \n  \n9. Press **Button1**.  \n  \n     The application writes the following information to the application's log file:  \n  \n     `Default Information: 0 : In Button1_Click`  \n  \n     `Default Error: 2 : Error in the application.`  \n  \n     The application writes less information to the application's debug output because of the more restrictive filtering.  \n  \n     `Default Error   2   Error`  \n  \n10. Close the application.  \n  \n For more information about changing log settings after deployment, see [Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md).  \n  \n## See also\n\n- [Walkthrough: Determining Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)\n- [Walkthrough: Changing Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-changing-where-my-application-log-writes-information.md)\n- [Walkthrough: Creating Custom Log Listeners](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-creating-custom-log-listeners.md)\n- [How to: Write Log Messages](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md)\n- [Trace Switches](../../../../framework/debug-trace-profile/trace-switches.md)\n- [Logging Information from the Application](../../../../visual-basic/developing-apps/programming/log-info/index.md)\n","nodes":[{"pos":[4,289],"embed":true,"restype":"x-metadata","content":"title: \"Filtering My.Application.Log Output (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"My.Log object, filtering output\"\n  - \"My.Application.Log object, filtering output\"\n  - \"application event logs, output filtering\"\nms.assetid: 2c0a457a-38a4-49e1-934d-a51320b7b4ca","nodes":[{"content":"Filtering My.Application.Log Output (Visual Basic)","nodes":[{"pos":[0,50],"content":"Filtering My.Application.Log Output (Visual Basic)","nodes":[{"content":"Filtering My.Application.Log Output (Visual Basic)","pos":[0,50]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[296,359],"content":"Walkthrough: Filtering My.Application.Log Output (Visual Basic)","linkify":"Walkthrough: Filtering My.Application.Log Output (Visual Basic)","nodes":[{"content":"Walkthrough: Filtering My.Application.Log Output (Visual Basic)","pos":[0,63]}]},{"content":"This walkthrough demonstrates how to change the default log filtering for the <ph id=\"ph1\">`My.Application.Log`</ph> object, to control what information is passed from the <ph id=\"ph2\">`Log`</ph> object to the listeners and what information is written by the listeners.","pos":[360,593],"source":"This walkthrough demonstrates how to change the default log filtering for the `My.Application.Log` object, to control what information is passed from the `Log` object to the listeners and what information is written by the listeners."},{"content":"You can change the logging behavior even after building the application, because the configuration information is stored in the application's configuration file.","pos":[594,755]},{"pos":[764,779],"content":"Getting Started","linkify":"Getting Started","nodes":[{"content":"Getting Started","pos":[0,15]}]},{"content":"Each message that <ph id=\"ph1\">`My.Application.Log`</ph> writes has an associated severity level, which filtering mechanisms use to control the log output.","pos":[783,920],"source":"Each message that `My.Application.Log` writes has an associated severity level, which filtering mechanisms use to control the log output."},{"content":"This sample application uses <ph id=\"ph1\">`My.Application.Log`</ph> methods to write several log messages with different severity levels.","pos":[921,1040],"source":" This sample application uses `My.Application.Log` methods to write several log messages with different severity levels."},{"pos":[1051,1082],"content":"To build the sample application","linkify":"To build the sample application","nodes":[{"content":"To build the sample application","pos":[0,31]}]},{"content":"Open a new Visual Basic Windows Application project.","pos":[1092,1144]},{"content":"Add a button named Button1 to Form1.","pos":[1154,1190]},{"pos":[1200,1299],"content":"In the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler for Button1, add the following code:","source":"In the <xref:System.Windows.Forms.Control.Click> event handler for Button1, add the following code:"},{"content":"Run the application in the debugger.","pos":[1464,1500]},{"pos":[1510,1528],"content":"Press <bpt id=\"p1\">**</bpt>Button1<ept id=\"p1\">**</ept>.","source":"Press **Button1**."},{"content":"The application writes the following information to the application's debug output and log file.","pos":[1539,1635]},{"content":"Close the application.","pos":[1768,1790]},{"content":"For information on how to view the application's debug output window, see <bpt id=\"p1\">[</bpt>Output Window<ept id=\"p1\">](/visualstudio/ide/reference/output-window)</ept>.","pos":[1801,1934],"source":"For information on how to view the application's debug output window, see [Output Window](/visualstudio/ide/reference/output-window)."},{"content":"For information on the location of the application's log file, see <bpt id=\"p1\">[</bpt>Walkthrough: Determining Where My.Application.Log Writes Information<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)</ept>.","pos":[1935,2207],"source":" For information on the location of the application's log file, see [Walkthrough: Determining Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)."},{"pos":[2219,2318],"content":"[!NOTE]\nBy default, the application flushes the log-file output when the application closes.","leadings":["","    >  "],"nodes":[{"content":"By default, the application flushes the log-file output when the application closes.","pos":[8,92]}]},{"content":"In the example above, the second call to the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.Logging.Log.WriteEntry%2A&gt;</ph> method and the call to the <ph id=\"ph2\">&lt;xref:Microsoft.VisualBasic.Logging.Log.WriteException%2A&gt;</ph> method produces log output, while the first and last calls to the <ph id=\"ph3\">`WriteEntry`</ph> method do not.","pos":[2329,2608],"source":"In the example above, the second call to the <xref:Microsoft.VisualBasic.Logging.Log.WriteEntry%2A> method and the call to the <xref:Microsoft.VisualBasic.Logging.Log.WriteException%2A> method produces log output, while the first and last calls to the `WriteEntry` method do not."},{"content":"This is because the severity levels of <ph id=\"ph1\">`WriteEntry`</ph> and <ph id=\"ph2\">`WriteException`</ph> are \"Information\" and \"Error\", both of which are allowed by the <ph id=\"ph3\">`My.Application.Log`</ph> object's default log filtering.","pos":[2609,2798],"source":" This is because the severity levels of `WriteEntry` and `WriteException` are \"Information\" and \"Error\", both of which are allowed by the `My.Application.Log` object's default log filtering."},{"content":"However, events with \"Start\" and \"Stop\" severity levels are prevented from producing log output.","pos":[2799,2895]},{"pos":[2904,2950],"content":"Filtering for All My.Application.Log Listeners","linkify":"Filtering for All My.Application.Log Listeners","nodes":[{"content":"Filtering for All My.Application.Log Listeners","pos":[0,46]}]},{"content":"The <ph id=\"ph1\">`My.Application.Log`</ph> object uses a <ph id=\"ph2\">&lt;xref:System.Diagnostics.SourceSwitch&gt;</ph> named <ph id=\"ph3\">`DefaultSwitch`</ph> to control which messages it passes from the <ph id=\"ph4\">`WriteEntry`</ph> and <ph id=\"ph5\">`WriteException`</ph> methods to the log listeners.","pos":[2954,3162],"source":"The `My.Application.Log` object uses a <xref:System.Diagnostics.SourceSwitch> named `DefaultSwitch` to control which messages it passes from the `WriteEntry` and `WriteException` methods to the log listeners."},{"content":"You can configure <ph id=\"ph1\">`DefaultSwitch`</ph> in the application's configuration file by setting its value to one of the <ph id=\"ph2\">&lt;xref:System.Diagnostics.SourceLevels&gt;</ph> enumeration values.","pos":[3163,3330],"source":" You can configure `DefaultSwitch` in the application's configuration file by setting its value to one of the <xref:System.Diagnostics.SourceLevels> enumeration values."},{"content":"By default, its value is \"Information\".","pos":[3331,3370]},{"pos":[3377,3510],"content":"This table shows the severity level required for Log to write a message to the listeners, given a particular <ph id=\"ph1\">`DefaultSwitch`</ph> setting.","source":"This table shows the severity level required for Log to write a message to the listeners, given a particular `DefaultSwitch` setting."},{"content":"DefaultSwitch Value","pos":[3517,3536]},{"content":"Message severity required for output","pos":[3537,3573]},{"pos":[3623,3644],"content":"<ph id=\"ph1\">`Critical`</ph> or <ph id=\"ph2\">`Error`</ph>","source":"`Critical` or `Error`"},{"pos":[3659,3692],"content":"<ph id=\"ph1\">`Critical`</ph>, <ph id=\"ph2\">`Error`</ph>, or <ph id=\"ph3\">`Warning`</ph>","source":"`Critical`, `Error`, or `Warning`"},{"pos":[3711,3759],"content":"<ph id=\"ph1\">`Critical`</ph>, <ph id=\"ph2\">`Error`</ph>, <ph id=\"ph3\">`Warning`</ph>, or <ph id=\"ph4\">`Information`</ph>","source":"`Critical`, `Error`, `Warning`, or `Information`"},{"pos":[3774,3833],"content":"<ph id=\"ph1\">`Critical`</ph>, <ph id=\"ph2\">`Error`</ph>, <ph id=\"ph3\">`Warning`</ph>, <ph id=\"ph4\">`Information`</ph>, or <ph id=\"ph5\">`Verbose`</ph>","source":"`Critical`, `Error`, `Warning`, `Information`, or `Verbose`"},{"pos":[3856,3907],"content":"<ph id=\"ph1\">`Start`</ph>, <ph id=\"ph2\">`Stop`</ph>, <ph id=\"ph3\">`Suspend`</ph>, <ph id=\"ph4\">`Resume`</ph>, or <ph id=\"ph5\">`Transfer`</ph>","source":"`Start`, `Stop`, `Suspend`, `Resume`, or `Transfer`"},{"content":"All messages are allowed.","pos":[3918,3943]},{"content":"All messages are blocked.","pos":[3954,3979]},{"pos":[3988,4260],"content":"[!NOTE]\n The `WriteEntry` and `WriteException` methods each have an overload that does not specify a severity level. The implicit severity level for the `WriteEntry` overload is \"Information\", and the implicit severity level for the `WriteException` overload is \"Error\".","leadings":["","> "],"nodes":[{"content":"The `WriteEntry` and `WriteException` methods each have an overload that does not specify a severity level. The implicit severity level for the `WriteEntry` overload is \"Information\", and the implicit severity level for the `WriteException` overload is \"Error\".","pos":[9,270],"nodes":[{"content":"The <ph id=\"ph1\">`WriteEntry`</ph> and <ph id=\"ph2\">`WriteException`</ph> methods each have an overload that does not specify a severity level.","pos":[0,107],"source":"The `WriteEntry` and `WriteException` methods each have an overload that does not specify a severity level."},{"content":"The implicit severity level for the <ph id=\"ph1\">`WriteEntry`</ph> overload is \"Information\", and the implicit severity level for the <ph id=\"ph2\">`WriteException`</ph> overload is \"Error\".","pos":[108,261],"source":" The implicit severity level for the `WriteEntry` overload is \"Information\", and the implicit severity level for the `WriteException` overload is \"Error\"."}]}]},{"pos":[4267,4503],"content":"This table explains the log output shown in the previous example: with the default <ph id=\"ph1\">`DefaultSwitch`</ph> setting of \"Information\", only the second call to the <ph id=\"ph2\">`WriteEntry`</ph> method and the call to the <ph id=\"ph3\">`WriteException`</ph> method produce log output.","source":"This table explains the log output shown in the previous example: with the default `DefaultSwitch` setting of \"Information\", only the second call to the `WriteEntry` method and the call to the `WriteException` method produce log output."},{"pos":[4514,4549],"content":"To log only activity tracing events","linkify":"To log only activity tracing events","nodes":[{"content":"To log only activity tracing events","pos":[0,35]}]},{"pos":[4559,4631],"content":"Right-click app.config in the <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and select <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","source":"Right-click app.config in the **Solution Explorer** and select **Open**."},{"content":"-or-","pos":[4642,4646]},{"content":"If there is no app.config file:","pos":[4657,4688]},{"pos":[4702,4751],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Add New Item<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, choose **Add New Item**."},{"pos":[4765,4845],"content":"From the <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> dialog box, choose <bpt id=\"p2\">**</bpt>Application Configuration File<ept id=\"p2\">**</ept>.","source":"From the **Add New Item** dialog box, choose **Application Configuration File**."},{"pos":[4859,4873],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","source":"Click **Add**."},{"pos":[4883,5016],"content":"Locate the <ph id=\"ph1\">`&lt;switches&gt;`</ph> section, which is in the <ph id=\"ph2\">`&lt;system.diagnostics&gt;`</ph> section, which is in the top-level <ph id=\"ph3\">`&lt;configuration&gt;`</ph> section.","source":"Locate the `<switches>` section, which is in the `<system.diagnostics>` section, which is in the top-level `<configuration>` section."},{"content":"Find the element that adds <ph id=\"ph1\">`DefaultSwitch`</ph> to the collection of switches.","pos":[5026,5099],"source":"Find the element that adds `DefaultSwitch` to the collection of switches."},{"content":"It should look similar to this element:","pos":[5100,5139]},{"pos":[5210,5273],"content":"Change the value of the <ph id=\"ph1\">`value`</ph> attribute to \"ActivityTracing\".","source":"Change the value of the `value` attribute to \"ActivityTracing\"."},{"content":"The content of the app.config file should be similar to the following XML:","pos":[5283,5357]},{"content":"Run the application in the debugger.","pos":[6343,6379]},{"pos":[6389,6407],"content":"Press <bpt id=\"p1\">**</bpt>Button1<ept id=\"p1\">**</ept>.","source":"Press **Button1**."},{"content":"The application writes the following information to the application's debug output and log file:","pos":[6418,6514]},{"content":"Close the application.","pos":[6642,6664]},{"pos":[6673,6737],"content":"Change the value of the <ph id=\"ph1\">`value`</ph> attribute back to \"Information\".","source":"Change the value of the `value` attribute back to \"Information\"."},{"pos":[6749,7057],"content":"[!NOTE]\nThe `DefaultSwitch` switch setting controls only `My.Application.Log`. It does not change how the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] <xref:System.Diagnostics.Trace?displayProperty=nameWithType> and <xref:System.Diagnostics.Debug?displayProperty=nameWithType> classes behave.","leadings":["","    >  "],"nodes":[{"content":"The `DefaultSwitch` switch setting controls only `My.Application.Log`. It does not change how the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] <xref:System.Diagnostics.Trace?displayProperty=nameWithType> and <xref:System.Diagnostics.Debug?displayProperty=nameWithType> classes behave.","pos":[8,301],"nodes":[{"content":"The <ph id=\"ph1\">`DefaultSwitch`</ph> switch setting controls only <ph id=\"ph2\">`My.Application.Log`</ph>.","pos":[0,70],"source":"The `DefaultSwitch` switch setting controls only `My.Application.Log`."},{"content":"It does not change how the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> <ph id=\"ph2\">&lt;xref:System.Diagnostics.Trace?displayProperty=nameWithType&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Diagnostics.Debug?displayProperty=nameWithType&gt;</ph> classes behave.","pos":[71,293],"source":" It does not change how the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] <xref:System.Diagnostics.Trace?displayProperty=nameWithType> and <xref:System.Diagnostics.Debug?displayProperty=nameWithType> classes behave."}]}]},{"pos":[7066,7119],"content":"Individual Filtering For My.Application.Log Listeners","linkify":"Individual Filtering For My.Application.Log Listeners","nodes":[{"content":"Individual Filtering For My.Application.Log Listeners","pos":[0,53]}]},{"content":"The previous example shows how to change the filtering for all <ph id=\"ph1\">`My.Application.Log`</ph> output.","pos":[7123,7214],"source":"The previous example shows how to change the filtering for all `My.Application.Log` output."},{"content":"This example demonstrates how to filter an individual log listener.","pos":[7215,7282]},{"content":"By default, an application has two listeners that write to the application's debug output and the log file.","pos":[7283,7390]},{"content":"The configuration file controls the behavior of the log listeners by allowing each one to have a filter, which is similar to a switch for <ph id=\"ph1\">`My.Application.Log`</ph>.","pos":[7397,7556],"source":"The configuration file controls the behavior of the log listeners by allowing each one to have a filter, which is similar to a switch for `My.Application.Log`."},{"content":"A log listener will output a message only if the message's severity is allowed by both the log's <ph id=\"ph1\">`DefaultSwitch`</ph> and the log listener's filter.","pos":[7557,7700],"source":" A log listener will output a message only if the message's severity is allowed by both the log's `DefaultSwitch` and the log listener's filter."},{"content":"This example demonstrates how to configure filtering for a new debug listener and add it to the <ph id=\"ph1\">`Log`</ph> object.","pos":[7707,7816],"source":"This example demonstrates how to configure filtering for a new debug listener and add it to the `Log` object."},{"content":"The default debug listener should be removed from the <ph id=\"ph1\">`Log`</ph> object, so it is clear that the debug messages come from the new debug listener.","pos":[7817,7957],"source":" The default debug listener should be removed from the `Log` object, so it is clear that the debug messages come from the new debug listener."},{"pos":[7968,8003],"content":"To log only activity-tracing events","linkify":"To log only activity-tracing events","nodes":[{"content":"To log only activity-tracing events","pos":[0,35]}]},{"pos":[8013,8085],"content":"Right-click app.config in the <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and choose <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","source":"Right-click app.config in the **Solution Explorer** and choose **Open**."},{"content":"-or-","pos":[8096,8100]},{"content":"If there is no app.config file:","pos":[8111,8142]},{"pos":[8156,8205],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Add New Item<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, choose **Add New Item**."},{"pos":[8219,8299],"content":"From the <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> dialog box, choose <bpt id=\"p2\">**</bpt>Application Configuration File<ept id=\"p2\">**</ept>.","source":"From the **Add New Item** dialog box, choose **Application Configuration File**."},{"pos":[8313,8327],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","source":"Click **Add**."},{"content":"Right-click app.config in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>.","pos":[8337,8385],"source":"Right-click app.config in **Solution Explorer**."},{"content":"Choose <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>.","pos":[8386,8402],"source":" Choose **Open**."},{"content":"Locate the <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section, in the <ph id=\"ph2\">`&lt;source&gt;`</ph> section with the <ph id=\"ph3\">`name`</ph> attribute \"DefaultSource\", which is under the <ph id=\"ph4\">`&lt;sources&gt;`</ph> section.","pos":[8412,8554],"source":"Locate the `<listeners>` section, in the `<source>` section with the `name` attribute \"DefaultSource\", which is under the `<sources>` section."},{"content":"The <ph id=\"ph1\">`&lt;sources&gt;`</ph> section is under the <ph id=\"ph2\">`&lt;system.diagnostics&gt;`</ph> section, in the top-level <ph id=\"ph3\">`&lt;configuration&gt;`</ph> section.","pos":[8555,8667],"source":" The `<sources>` section is under the `<system.diagnostics>` section, in the top-level `<configuration>` section."},{"pos":[8677,8723],"content":"Add this element to the <ph id=\"ph1\">`&lt;listeners&gt;`</ph> section:","source":"Add this element to the `<listeners>` section:"},{"pos":[8919,9041],"content":"Locate the <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> section, in the <ph id=\"ph2\">`&lt;system.diagnostics&gt;`</ph> section, in the top-level <ph id=\"ph3\">`&lt;configuration&gt;`</ph> section.","source":"Locate the `<sharedListeners>` section, in the `<system.diagnostics>` section, in the top-level `<configuration>` section."},{"pos":[9051,9104],"content":"Add this element to that <ph id=\"ph1\">`&lt;sharedListeners&gt;`</ph> section:","source":"Add this element to that `<sharedListeners>` section:"},{"pos":[9505,9667],"content":"The <ph id=\"ph1\">&lt;xref:System.Diagnostics.EventTypeFilter&gt;</ph> filter takes one of the <ph id=\"ph2\">&lt;xref:System.Diagnostics.SourceLevels&gt;</ph> enumeration values as its <ph id=\"ph3\">`initializeData`</ph> attribute.","source":"The <xref:System.Diagnostics.EventTypeFilter> filter takes one of the <xref:System.Diagnostics.SourceLevels> enumeration values as its `initializeData` attribute."},{"content":"The content of the app.config file should be similar to the following XML:","pos":[9677,9751]},{"content":"Run the application in the debugger.","pos":[11341,11377]},{"pos":[11386,11404],"content":"Press <bpt id=\"p1\">**</bpt>Button1<ept id=\"p1\">**</ept>.","source":"Press **Button1**."},{"content":"The application writes the following information to the application's log file:","pos":[11415,11494]},{"content":"The application writes less information to the application's debug output because of the more restrictive filtering.","pos":[11616,11732]},{"content":"Close the application.","pos":[11780,11802]},{"pos":[11809,12008],"content":"For more information about changing log settings after deployment, see <bpt id=\"p1\">[</bpt>Working with Application Logs<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)</ept>.","source":"For more information about changing log settings after deployment, see [Working with Application Logs](../../../../visual-basic/developing-apps/programming/log-info/working-with-application-logs.md)."},{"pos":[12017,12025],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[12029,12233],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Determining Where My.Application.Log Writes Information<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)</ept>","source":"[Walkthrough: Determining Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-determining-where-my-application-log-writes-information.md)"},{"pos":[12236,12434],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Changing Where My.Application.Log Writes Information<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-changing-where-my-application-log-writes-information.md)</ept>","source":"[Walkthrough: Changing Where My.Application.Log Writes Information](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-changing-where-my-application-log-writes-information.md)"},{"pos":[12437,12589],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Creating Custom Log Listeners<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-creating-custom-log-listeners.md)</ept>","source":"[Walkthrough: Creating Custom Log Listeners](../../../../visual-basic/developing-apps/programming/log-info/walkthrough-creating-custom-log-listeners.md)"},{"pos":[12592,12712],"content":"<bpt id=\"p1\">[</bpt>How to: Write Log Messages<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md)</ept>","source":"[How to: Write Log Messages](../../../../visual-basic/developing-apps/programming/log-info/how-to-write-log-messages.md)"},{"pos":[12715,12792],"content":"<bpt id=\"p1\">[</bpt>Trace Switches<ept id=\"p1\">](../../../../framework/debug-trace-profile/trace-switches.md)</ept>","source":"[Trace Switches](../../../../framework/debug-trace-profile/trace-switches.md)"},{"pos":[12795,12909],"content":"<bpt id=\"p1\">[</bpt>Logging Information from the Application<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/log-info/index.md)</ept>","source":"[Logging Information from the Application](../../../../visual-basic/developing-apps/programming/log-info/index.md)"}]}