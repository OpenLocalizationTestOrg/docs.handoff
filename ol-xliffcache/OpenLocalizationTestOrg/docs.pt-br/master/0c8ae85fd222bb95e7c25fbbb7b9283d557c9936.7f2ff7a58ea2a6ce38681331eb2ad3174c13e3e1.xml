{"content":"---\ntitle: \"How to: Create an Add-In That Is a UI | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"creating an add-in that is a UI [WPF]\"\n  - \"add-ins [WPF], UI\"\n  - \"creating UI add-ins [WPF]\"\n  - \"UI add-ins [WPF], creating\"\n  - \"implementing UI add-ins [WPF]\"\n  - \"pipeline segments [WPF], creating add-ins\"\nms.assetid: 86375525-282b-4039-8352-8680051a10ea\ncaps.latest.revision: 8\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Create an Add-In That Is a UI\nThis example shows how to create an add-in that is a              [!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)][!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] which is hosted by a              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] standalone application.  \n  \n The add-in is a              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is a              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] user control. The content of the user control is a single button that, when clicked, displays a message box. The              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] standalone application hosts the add-in              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] as the content of the main application window.  \n  \n **Prerequisites**  \n  \n This example highlights the              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extensions to the              [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model that enable this scenario, and assumes the following:  \n  \n-   Knowledge of the                      [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, including pipeline, add-in, and host development. If you are unfamiliar with these concepts, see                      [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md). For a tutorial that demonstrates the implementation of a pipeline, an add-in, and a host application, see                      [Walkthrough: Creating an Extensible Application](../../../../docs/framework/add-ins/walkthrough-create-extensible-app.md).  \n  \n-   Knowledge of the                      [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extensions to the                      [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, which can be found here:                      [WPF Add-Ins Overview](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md).  \n  \n## Example  \n To create an add-in that is a                      [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)][!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] requires specific code for each pipeline segment, the add-in, and the host application.  \n    \n  \n<a name=\"Contract\"></a>   \n## Implementing the Contract Pipeline Segment  \n When an add-in is a                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the contract for the add-in must implement                              <xref:System.AddIn.Contract.INativeHandleContract>. In the example,                              `IWPFAddInContract` implements                              <xref:System.AddIn.Contract.INativeHandleContract>, as shown in the following code.  \n  \n [!code-csharp[SimpleAddInIsAUISample#ContractCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInIsAUISample/CSharp/Contracts/IWPFAddInContract.cs#contractcode)]  \n  \n<a name=\"AddInViewPipeline\"></a>   \n## Implementing the Add-In View Pipeline Segment  \n Because the add-in is implemented as a subclass of the                              <xref:System.Windows.FrameworkElement> type, the add-in view must also subclass                              <xref:System.Windows.FrameworkElement>. The following code shows the add-in view of the contract, implemented as the                              `WPFAddInView` class.  \n  \n [!code-csharp[SimpleAddInIsAUISample#AddInViewCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInIsAUISample/CSharp/AddInViews/WPFAddInView.cs#addinviewcode)]  \n  \n Here, the add-in view is derived from                              <xref:System.Windows.Controls.UserControl>. Consequently, the add-in                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] should also derive from                              <xref:System.Windows.Controls.UserControl>.  \n  \n<a name=\"AddInSideAdapter\"></a>   \n## Implementing the Add-In-Side Adapter Pipeline Segment  \n While the contract is an                              <xref:System.AddIn.Contract.INativeHandleContract>, the add-in is a                              <xref:System.Windows.FrameworkElement> (as specified by the add-in view pipeline segment). Therefore, the                              <xref:System.Windows.FrameworkElement> must be converted to an                              <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary. This work is performed by the add-in-side adapter by calling                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, as shown in the following code.  \n  \n [!code-csharp[SimpleAddInIsAUISample#AddInSideAdapterCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInIsAUISample/CSharp/AddInSideAdapters/WPFAddIn_ViewToContractAddInSideAdapter.cs#addinsideadaptercode)]  \n  \n In the add-in model where an add-in returns a                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] (see                              [Create an Add-In That Returns a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md)), the add-in adapter converted the                              <xref:System.Windows.FrameworkElement> to an                              <xref:System.AddIn.Contract.INativeHandleContract> by calling                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> must also be called in this model, although you need to implement a method from which to write the code to call it. You do this by overriding                              <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> and implementing the code that calls                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> if the code that is calling                              <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> is expecting an                              <xref:System.AddIn.Contract.INativeHandleContract>. In this case, the caller will be the host-side adapter, which is covered in a subsequent subsection.  \n  \n> [!NOTE]\n>  You also need to override                                  <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> in this model to enable tabbing between host application                                  [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and add-in                                  [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]. For more information, see \"WPF Add-In Limitations\" in                                  [WPF Add-Ins Overview](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md).  \n  \n Because the add-in-side adapter implements an interface that derives from                              <xref:System.AddIn.Contract.INativeHandleContract>, you also need to implement                              <xref:System.AddIn.Contract.INativeHandleContract.GetHandle%2A>, although this is ignored when                              <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> is overridden.  \n  \n<a name=\"HostViewPipeline\"></a>   \n## Implementing the Host View Pipeline Segment  \n In this model, the host application typically expects the host view to be a                              <xref:System.Windows.FrameworkElement> subclass. The host-side adapter must convert the                              <xref:System.AddIn.Contract.INativeHandleContract> to a                              <xref:System.Windows.FrameworkElement> after the                              <xref:System.AddIn.Contract.INativeHandleContract> crosses the isolation boundary. Because a method isn't being called by the host application to get the                              <xref:System.Windows.FrameworkElement>, the host view must \"return\" the                              <xref:System.Windows.FrameworkElement> by containing it. Consequently, the host view must derive from a subclass of                              <xref:System.Windows.FrameworkElement> that can contain other                              [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], such as                              <xref:System.Windows.Controls.UserControl>. The following code shows the host view of the contract, implemented as the                              `WPFAddInHostView` class.  \n  \n  \n  \n<a name=\"HostSideAdapter\"></a>   \n## Implementing the Host-Side Adapter Pipeline Segment  \n While the contract is an                              <xref:System.AddIn.Contract.INativeHandleContract>, the host application expects a                              <xref:System.Windows.Controls.UserControl> (as specified by the host view). Consequently, the                              <xref:System.AddIn.Contract.INativeHandleContract> must be converted to a                              <xref:System.Windows.FrameworkElement> after crossing the isolation boundary, before being set as content of the host view (which derives from                              <xref:System.Windows.Controls.UserControl>).  \n  \n This work is performed by the host-side adapter, as shown in the following code.  \n  \n  \n  \n As you can see, the host-side adapter acquires the                              <xref:System.AddIn.Contract.INativeHandleContract> by calling the add-in-side adapter's                              <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> method (this is the point where the                              <xref:System.AddIn.Contract.INativeHandleContract> crosses the isolation boundary).  \n  \n The host-side adapter then converts the                              <xref:System.AddIn.Contract.INativeHandleContract> to a                              <xref:System.Windows.FrameworkElement> by calling                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>. Finally, the                              <xref:System.Windows.FrameworkElement> is set as the content of the host view.  \n  \n<a name=\"AddIn\"></a>   \n## Implementing the Add-In  \n With the add-in-side adapter and add-in view in place, the add-in can be implemented by deriving from the add-in view, as shown in the following code.  \n  \n  \n  \n  \n  \n From this example, you can see one interesting benefit of this model: add-in developers only need to implement the add-in (since it is the                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] as well), rather than both an add-in class and an add-in                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].  \n  \n<a name=\"HostApp\"></a>   \n## Implementing the Host Application  \n With the host-side adapter and host view created, the host application can use the                              [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to open the pipeline and acquire a host view of the add-in. These steps are shown in the following code.  \n  \n  \n  \n The host application uses typical                              [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model code to activate the add-in, which implicitly returns the host view to the host application. The host application subsequently displays the host view (which is a                              <xref:System.Windows.Controls.UserControl>) from a                              <xref:System.Windows.Controls.Grid>.  \n  \n The code for processing interactions with the add-in                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] runs in the add-in's application domain. These interactions include the following:  \n  \n-   Handling the                                      <xref:System.Windows.Controls.Button><xref:System.Windows.Controls.Primitives.ButtonBase.Click> event.  \n  \n-   Showing the                                      <xref:System.Windows.MessageBox>.  \n  \n This activity is completely isolated from the host application.  \n  \n## See Also  \n [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md)   \n [WPF Add-Ins Overview](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md)","nodes":[{"pos":[4,605],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create an Add-In That Is a UI | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"creating an add-in that is a UI [WPF]\"\n  - \"add-ins [WPF], UI\"\n  - \"creating UI add-ins [WPF]\"\n  - \"UI add-ins [WPF], creating\"\n  - \"implementing UI add-ins [WPF]\"\n  - \"pipeline segments [WPF], creating add-ins\"\nms.assetid: 86375525-282b-4039-8352-8680051a10ea\ncaps.latest.revision: 8\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","nodes":[{"content":"How to: Create an Add-In That Is a UI | Microsoft Docs","nodes":[{"pos":[0,54],"content":"How to: Create an Add-In That Is a UI | Microsoft Docs","nodes":[{"content":"How to: Create an Add-In That Is a UI | Microsoft Docs","pos":[0,54]}]}],"path":["title"]}],"yml":true},{"pos":[612,649],"content":"How to: Create an Add-In That Is a UI","linkify":"How to: Create an Add-In That Is a UI","nodes":[{"content":"How to: Create an Add-In That Is a UI","pos":[0,37]}]},{"pos":[650,976],"content":"This example shows how to create an add-in that is a              <ph id=\"ph1\">[!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)]</ph><ph id=\"ph2\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph> which is hosted by a              <ph id=\"ph3\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> standalone application.","source":"This example shows how to create an add-in that is a              [!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)][!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] which is hosted by a              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] standalone application."},{"content":"The add-in is a              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> that is a              <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> user control.","pos":[983,1186],"source":"The add-in is a              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is a              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] user control."},{"content":"The content of the user control is a single button that, when clicked, displays a message box.","pos":[1187,1281]},{"content":"The              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> standalone application hosts the add-in              <ph id=\"ph2\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> as the content of the main application window.","pos":[1282,1536],"source":" The              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] standalone application hosts the add-in              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] as the content of the main application window."},{"pos":[1543,1560],"content":"<bpt id=\"p1\">**</bpt>Prerequisites<ept id=\"p1\">**</ept>","source":"**Prerequisites**"},{"pos":[1567,1839],"content":"This example highlights the              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> extensions to the              <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> add-in model that enable this scenario, and assumes the following:","source":"This example highlights the              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extensions to the              [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model that enable this scenario, and assumes the following:"},{"content":"Knowledge of the                      <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> add-in model, including pipeline, add-in, and host development.","pos":[1849,2014],"source":"Knowledge of the                      [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, including pipeline, add-in, and host development."},{"content":"If you are unfamiliar with these concepts, see                      <bpt id=\"p1\">[</bpt>Add-ins and Extensibility<ept id=\"p1\">](../../../../docs/framework/add-ins/index.md)</ept>.","pos":[2015,2156],"source":" If you are unfamiliar with these concepts, see                      [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md)."},{"content":"For a tutorial that demonstrates the implementation of a pipeline, an add-in, and a host application, see                      <bpt id=\"p1\">[</bpt>Walkthrough: Creating an Extensible Application<ept id=\"p1\">](../../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)</ept>.","pos":[2157,2407],"source":" For a tutorial that demonstrates the implementation of a pipeline, an add-in, and a host application, see                      [Walkthrough: Creating an Extensible Application](../../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)."},{"pos":[2417,2783],"content":"Knowledge of the                      <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> extensions to the                      <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> add-in model, which can be found here:                      <bpt id=\"p1\">[</bpt>WPF Add-Ins Overview<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md)</ept>.","source":"Knowledge of the                      [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extensions to the                      [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, which can be found here:                      [WPF Add-Ins Overview](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md)."},{"pos":[2792,2799],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2803,3078],"content":"To create an add-in that is a                      <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph><ph id=\"ph2\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> requires specific code for each pipeline segment, the add-in, and the host application.","source":"To create an add-in that is a                      [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)][!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] requires specific code for each pipeline segment, the add-in, and the host application."},{"pos":[3119,3161],"content":"Implementing the Contract Pipeline Segment","linkify":"Implementing the Contract Pipeline Segment","nodes":[{"content":"Implementing the Contract Pipeline Segment","pos":[0,42]}]},{"content":"When an add-in is a                              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph>, the contract for the add-in must implement                              <ph id=\"ph2\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph>.","pos":[3165,3406],"source":"When an add-in is a                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the contract for the add-in must implement                              <xref:System.AddIn.Contract.INativeHandleContract>."},{"content":"In the example,                              <ph id=\"ph1\">`IWPFAddInContract`</ph> implements                              <ph id=\"ph2\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph>, as shown in the following code.","pos":[3407,3595],"source":" In the example,                              `IWPFAddInContract` implements                              <xref:System.AddIn.Contract.INativeHandleContract>, as shown in the following code."},{"pos":[3825,3870],"content":"Implementing the Add-In View Pipeline Segment","linkify":"Implementing the Add-In View Pipeline Segment","nodes":[{"content":"Implementing the Add-In View Pipeline Segment","pos":[0,45]}]},{"content":"Because the add-in is implemented as a subclass of the                              <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> type, the add-in view must also subclass                              <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement&gt;</ph>.","pos":[3874,4106],"source":"Because the add-in is implemented as a subclass of the                              <xref:System.Windows.FrameworkElement> type, the add-in view must also subclass                              <xref:System.Windows.FrameworkElement>."},{"content":"The following code shows the add-in view of the contract, implemented as the                              <ph id=\"ph1\">`WPFAddInView`</ph> class.","pos":[4107,4234],"source":" The following code shows the add-in view of the contract, implemented as the                              `WPFAddInView` class."},{"content":"Here, the add-in view is derived from                              <ph id=\"ph1\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph>.","pos":[4424,4534],"source":"Here, the add-in view is derived from                              <xref:System.Windows.Controls.UserControl>."},{"content":"Consequently, the add-in                              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> should also derive from                              <ph id=\"ph2\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph>.","pos":[4535,4753],"source":" Consequently, the add-in                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] should also derive from                              <xref:System.Windows.Controls.UserControl>."},{"pos":[4797,4850],"content":"Implementing the Add-In-Side Adapter Pipeline Segment","linkify":"Implementing the Add-In-Side Adapter Pipeline Segment","nodes":[{"content":"Implementing the Add-In-Side Adapter Pipeline Segment","pos":[0,53]}]},{"content":"While the contract is an                              <ph id=\"ph1\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph>, the add-in is a                              <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> (as specified by the add-in view pipeline segment).","pos":[4854,5095],"source":"While the contract is an                              <xref:System.AddIn.Contract.INativeHandleContract>, the add-in is a                              <xref:System.Windows.FrameworkElement> (as specified by the add-in view pipeline segment)."},{"content":"Therefore, the                              <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> must be converted to an                              <ph id=\"ph2\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph> before crossing the isolation boundary.","pos":[5096,5322],"source":" Therefore, the                              <xref:System.Windows.FrameworkElement> must be converted to an                              <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary."},{"content":"This work is performed by the add-in-side adapter by calling                              <ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A&gt;</ph>, as shown in the following code.","pos":[5323,5524],"source":" This work is performed by the add-in-side adapter by calling                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, as shown in the following code."},{"content":"In the add-in model where an add-in returns a                              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> (see                              <bpt id=\"p1\">[</bpt>Create an Add-In That Returns a UI<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md)</ept>), the add-in adapter converted the                              <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> to an                              <ph id=\"ph3\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph> by calling                              <ph id=\"ph4\">&lt;xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A&gt;</ph>.","pos":[5762,6377],"source":"In the add-in model where an add-in returns a                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] (see                              [Create an Add-In That Returns a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md)), the add-in adapter converted the                              <xref:System.Windows.FrameworkElement> to an                              <xref:System.AddIn.Contract.INativeHandleContract> by calling                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>."},{"content":"<ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A&gt;</ph> must also be called in this model, although you need to implement a method from which to write the code to call it.","pos":[6407,6601],"source":"                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> must also be called in this model, although you need to implement a method from which to write the code to call it."},{"content":"You do this by overriding                              <ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A&gt;</ph> and implementing the code that calls                              <ph id=\"ph2\">&lt;xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A&gt;</ph> if the code that is calling                              <ph id=\"ph3\">&lt;xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A&gt;</ph> is expecting an                              <ph id=\"ph4\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph>.","pos":[6602,7073],"source":" You do this by overriding                              <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> and implementing the code that calls                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> if the code that is calling                              <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> is expecting an                              <xref:System.AddIn.Contract.INativeHandleContract>."},{"content":"In this case, the caller will be the host-side adapter, which is covered in a subsequent subsection.","pos":[7074,7174]},{"pos":[7182,7764],"content":"[!NOTE]\n You also need to override                                  <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> in this model to enable tabbing between host application                                  [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and add-in                                  [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]. For more information, see \"WPF Add-In Limitations\" in                                  [WPF Add-Ins Overview](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md).","leadings":["","> "],"nodes":[{"content":"You also need to override                                  <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> in this model to enable tabbing between host application                                  [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and add-in                                  [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]. For more information, see \"WPF Add-In Limitations\" in                                  [WPF Add-Ins Overview](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md).","pos":[9,580],"nodes":[{"content":"You also need to override                                  <ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A&gt;</ph> in this model to enable tabbing between host application                                  <ph id=\"ph2\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> and add-in                                  <ph id=\"ph3\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph>.","pos":[0,388],"source":"You also need to override                                  <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> in this model to enable tabbing between host application                                  [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and add-in                                  [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]."},{"content":"For more information, see \"WPF Add-In Limitations\" in                                  <bpt id=\"p1\">[</bpt>WPF Add-Ins Overview<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md)</ept>.","pos":[389,571],"source":" For more information, see \"WPF Add-In Limitations\" in                                  [WPF Add-Ins Overview](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md)."}]}]},{"content":"Because the add-in-side adapter implements an interface that derives from                              <ph id=\"ph1\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph>, you also need to implement                              <ph id=\"ph2\">&lt;xref:System.AddIn.Contract.INativeHandleContract.GetHandle%2A&gt;</ph>, although this is ignored when                              <ph id=\"ph3\">&lt;xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A&gt;</ph> is overridden.","pos":[7771,8179],"source":"Because the add-in-side adapter implements an interface that derives from                              <xref:System.AddIn.Contract.INativeHandleContract>, you also need to implement                              <xref:System.AddIn.Contract.INativeHandleContract.GetHandle%2A>, although this is ignored when                              <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> is overridden."},{"pos":[8223,8266],"content":"Implementing the Host View Pipeline Segment","linkify":"Implementing the Host View Pipeline Segment","nodes":[{"content":"Implementing the Host View Pipeline Segment","pos":[0,43]}]},{"content":"In this model, the host application typically expects the host view to be a                              <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> subclass.","pos":[8270,8423],"source":"In this model, the host application typically expects the host view to be a                              <xref:System.Windows.FrameworkElement> subclass."},{"content":"The host-side adapter must convert the                              <ph id=\"ph1\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph> to a                              <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> after the                              <ph id=\"ph3\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph> crosses the isolation boundary.","pos":[8424,8737],"source":" The host-side adapter must convert the                              <xref:System.AddIn.Contract.INativeHandleContract> to a                              <xref:System.Windows.FrameworkElement> after the                              <xref:System.AddIn.Contract.INativeHandleContract> crosses the isolation boundary."},{"content":"Because a method isn't being called by the host application to get the                              <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement&gt;</ph>, the host view must \"return\" the                              <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> by containing it.","pos":[8738,8995],"source":" Because a method isn't being called by the host application to get the                              <xref:System.Windows.FrameworkElement>, the host view must \"return\" the                              <xref:System.Windows.FrameworkElement> by containing it."},{"content":"Consequently, the host view must derive from a subclass of                              <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> that can contain other                              <ph id=\"ph2\">[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]</ph>, such as                              <ph id=\"ph3\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph>.","pos":[8996,9342],"source":" Consequently, the host view must derive from a subclass of                              <xref:System.Windows.FrameworkElement> that can contain other                              [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], such as                              <xref:System.Windows.Controls.UserControl>."},{"content":"The following code shows the host view of the contract, implemented as the                              <ph id=\"ph1\">`WPFAddInHostView`</ph> class.","pos":[9343,9472],"source":" The following code shows the host view of the contract, implemented as the                              `WPFAddInHostView` class."},{"pos":[9521,9572],"content":"Implementing the Host-Side Adapter Pipeline Segment","linkify":"Implementing the Host-Side Adapter Pipeline Segment","nodes":[{"content":"Implementing the Host-Side Adapter Pipeline Segment","pos":[0,51]}]},{"content":"While the contract is an                              <ph id=\"ph1\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph>, the host application expects a                              <ph id=\"ph2\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> (as specified by the host view).","pos":[9576,9817],"source":"While the contract is an                              <xref:System.AddIn.Contract.INativeHandleContract>, the host application expects a                              <xref:System.Windows.Controls.UserControl> (as specified by the host view)."},{"content":"Consequently, the                              <ph id=\"ph1\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph> must be converted to a                              <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> after crossing the isolation boundary, before being set as content of the host view (which derives from                              <ph id=\"ph3\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph>).","pos":[9818,10184],"source":" Consequently, the                              <xref:System.AddIn.Contract.INativeHandleContract> must be converted to a                              <xref:System.Windows.FrameworkElement> after crossing the isolation boundary, before being set as content of the host view (which derives from                              <xref:System.Windows.Controls.UserControl>)."},{"content":"This work is performed by the host-side adapter, as shown in the following code.","pos":[10191,10271]},{"content":"As you can see, the host-side adapter acquires the                              <ph id=\"ph1\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph> by calling the add-in-side adapter's                              <ph id=\"ph2\">&lt;xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A&gt;</ph> method (this is the point where the                              <ph id=\"ph3\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph> crosses the isolation boundary).","pos":[10284,10688],"source":"As you can see, the host-side adapter acquires the                              <xref:System.AddIn.Contract.INativeHandleContract> by calling the add-in-side adapter's                              <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> method (this is the point where the                              <xref:System.AddIn.Contract.INativeHandleContract> crosses the isolation boundary)."},{"content":"The host-side adapter then converts the                              <ph id=\"ph1\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph> to a                              <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> by calling                              <ph id=\"ph3\">&lt;xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A&gt;</ph>.","pos":[10695,11007],"source":"The host-side adapter then converts the                              <xref:System.AddIn.Contract.INativeHandleContract> to a                              <xref:System.Windows.FrameworkElement> by calling                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>."},{"content":"Finally, the                              <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> is set as the content of the host view.","pos":[11008,11128],"source":" Finally, the                              <xref:System.Windows.FrameworkElement> is set as the content of the host view."},{"pos":[11161,11184],"content":"Implementing the Add-In","linkify":"Implementing the Add-In","nodes":[{"content":"Implementing the Add-In","pos":[0,23]}]},{"content":"With the add-in-side adapter and add-in view in place, the add-in can be implemented by deriving from the add-in view, as shown in the following code.","pos":[11188,11338]},{"pos":[11357,11747],"content":"From this example, you can see one interesting benefit of this model: add-in developers only need to implement the add-in (since it is the                              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> as well), rather than both an add-in class and an add-in                              <ph id=\"ph2\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph>.","source":"From this example, you can see one interesting benefit of this model: add-in developers only need to implement the add-in (since it is the                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] as well), rather than both an add-in class and an add-in                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]."},{"pos":[11782,11815],"content":"Implementing the Host Application","linkify":"Implementing the Host Application","nodes":[{"content":"Implementing the Host Application","pos":[0,33]}]},{"content":"With the host-side adapter and host view created, the host application can use the                              <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> add-in model to open the pipeline and acquire a host view of the add-in.","pos":[11819,12067],"source":"With the host-side adapter and host view created, the host application can use the                              [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to open the pipeline and acquire a host view of the add-in."},{"content":"These steps are shown in the following code.","pos":[12068,12112]},{"content":"The host application uses typical                              <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> add-in model code to activate the add-in, which implicitly returns the host view to the host application.","pos":[12125,12357],"source":"The host application uses typical                              [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model code to activate the add-in, which implicitly returns the host view to the host application."},{"content":"The host application subsequently displays the host view (which is a                              <ph id=\"ph1\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph>) from a                              <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Grid&gt;</ph>.","pos":[12358,12572],"source":" The host application subsequently displays the host view (which is a                              <xref:System.Windows.Controls.UserControl>) from a                              <xref:System.Windows.Controls.Grid>."},{"content":"The code for processing interactions with the add-in                              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> runs in the add-in's application domain.","pos":[12579,12769],"source":"The code for processing interactions with the add-in                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] runs in the add-in's application domain."},{"content":"These interactions include the following:","pos":[12770,12811]},{"content":"Handling the                                      <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Button&gt;</ph><ph id=\"ph2\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase.Click&gt;</ph> event.","pos":[12821,12973],"source":"Handling the                                      <xref:System.Windows.Controls.Button><xref:System.Windows.Controls.Primitives.ButtonBase.Click> event."},{"content":"Showing the                                      <ph id=\"ph1\">&lt;xref:System.Windows.MessageBox&gt;</ph>.","pos":[12983,13065],"source":"Showing the                                      <xref:System.Windows.MessageBox>."},{"content":"This activity is completely isolated from the host application.","pos":[13072,13135]},{"pos":[13144,13152],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Add-ins and Extensibility<ept id=\"p1\">](../../../../docs/framework/add-ins/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[13156,13229],"source":"[Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>WPF Add-Ins Overview<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md)</ept>","pos":[13233,13327],"source":"[WPF Add-Ins Overview](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md)"}]}