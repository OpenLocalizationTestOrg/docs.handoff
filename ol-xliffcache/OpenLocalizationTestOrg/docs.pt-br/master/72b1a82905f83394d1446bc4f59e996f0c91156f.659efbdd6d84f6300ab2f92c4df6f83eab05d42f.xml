{"content":"---\ntitle: \"ICLRDebuggingLibraryProvider::ProvideLibrary Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICLRDebuggingLibraryProvider.ProvideLibrary Method\"\napi_location: \n  - \"mscordbi.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRDebuggingLibraryProvider::ProvideLibrary\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ProvideLibrary method [.NET Framework debugging]\"\n  - \"ICLRDebuggingLibraryProvider::ProvideLibrary method [.NET Framework debugging]\"\nms.assetid: 86f06245-9517-49be-8d8c-ca5deaf34c02\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 8\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# ICLRDebuggingLibraryProvider::ProvideLibrary Method\nGets a library provider callback interface that allows common language runtime (CLR) version-specific debugging libraries to be located and loaded on demand.  \n  \n## Syntax  \n  \n```  \nHRESULT ProvideLibrary(  \n     [in] const WCHAR* pwszFileName,  \n     [in] DWORD dwTimestamp,  \n     [in] DWORD dwSizeOfImage,  \n     [out] HMODULE* hModule);  \n```  \n  \n#### Parameters  \n `pwszFilename`  \n [in] The name of the module being requested .  \n  \n `dwTimestamp`  \n [in] The date time stamp stored in the COFF file header of PE files.  \n  \n `pLibraryProvider`  \n [in] The `SizeOfImage` field stored in the COFF optional file header of PE files.  \n  \n `hModule`  \n [out] The handle to the requested module.  \n  \n## Return Value  \n This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|The method completed successfully.|  \n  \n## Exceptions  \n  \n## Remarks  \n `ProvideLibrary` allows the debugger to provide modules that are needed for debugging specific CLR files such as mscordbi.dll and mscordacwks.dll. The module handles have to remain valid until a call to the [ICLRDebugging::CanUnloadNow](../../../../docs/framework/unmanaged-api/debugging/iclrdebugging-canunloadnow-method.md) method indicates that they may be freed, at which point it is the caller’s responsibility to free the handles.  \n  \n The debugger may use any available means to locate or procure the debugging module.  \n  \n> [!IMPORTANT]\n>  This feature allows the API caller to provide modules that contain executable, and possibly malicious, code. As a security precaution, the caller should not use `ProvideLibrary` to distribute any code that it is not willing to execute itself.  \n>   \n>  If a serious security issue is discovered in an already released library, such as mscordbi.dll or mscordacwks.dll, the shim can be patched to recognize the bad versions of the files. The shim can then issue requests for the patched versions of the files and reject the bad versions if they are provided in response to any request. This can occur only if the user has patched to a new version of the shim. Unpatched versions will remain vulnerable.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** CorDebug.idl, CorDebug.h  \n  \n **Library:** CorGuids.lib  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See Also  \n [Debugging Interfaces](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md)   \n [Debugging](../../../../docs/framework/unmanaged-api/debugging/index.md)","nodes":[{"pos":[4,776],"embed":true,"restype":"x-metadata","content":"title: \"ICLRDebuggingLibraryProvider::ProvideLibrary Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICLRDebuggingLibraryProvider.ProvideLibrary Method\"\napi_location: \n  - \"mscordbi.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRDebuggingLibraryProvider::ProvideLibrary\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ProvideLibrary method [.NET Framework debugging]\"\n  - \"ICLRDebuggingLibraryProvider::ProvideLibrary method [.NET Framework debugging]\"\nms.assetid: 86f06245-9517-49be-8d8c-ca5deaf34c02\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 8\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"ICLRDebuggingLibraryProvider::ProvideLibrary Method | Microsoft Docs","nodes":[{"pos":[0,68],"content":"ICLRDebuggingLibraryProvider::ProvideLibrary Method | Microsoft Docs","nodes":[{"content":"ICLRDebuggingLibraryProvider::ProvideLibrary Method | Microsoft Docs","pos":[0,68]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[783,834],"content":"ICLRDebuggingLibraryProvider::ProvideLibrary Method","linkify":"ICLRDebuggingLibraryProvider::ProvideLibrary Method","nodes":[{"content":"ICLRDebuggingLibraryProvider::ProvideLibrary Method","pos":[0,51]}]},{"content":"Gets a library provider callback interface that allows common language runtime (CLR) version-specific debugging libraries to be located and loaded on demand.","pos":[835,992]},{"pos":[1001,1007],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1194,1204],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The name of the module being requested .","pos":[1226,1271]},{"content":"[in] The date time stamp stored in the COFF file header of PE files.","pos":[1295,1363]},{"content":"[in] The <ph id=\"ph1\">`SizeOfImage`</ph> field stored in the COFF optional file header of PE files.","pos":[1392,1473],"source":"[in] The `SizeOfImage` field stored in the COFF optional file header of PE files."},{"content":"[out] The handle to the requested module.","pos":[1493,1534]},{"pos":[1543,1555],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.","pos":[1559,1666]},{"content":"HRESULT","pos":[1673,1680]},{"content":"Description","pos":[1681,1692]},{"content":"S_OK","pos":[1733,1737]},{"content":"The method completed successfully.","pos":[1738,1772]},{"pos":[1782,1792],"content":"Exceptions","linkify":"Exceptions","nodes":[{"content":"Exceptions","pos":[0,10]}]},{"pos":[1801,1808],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`ProvideLibrary`</ph> allows the debugger to provide modules that are needed for debugging specific CLR files such as mscordbi.dll and mscordacwks.dll.","pos":[1812,1958],"source":"`ProvideLibrary` allows the debugger to provide modules that are needed for debugging specific CLR files such as mscordbi.dll and mscordacwks.dll."},{"content":"The module handles have to remain valid until a call to the <bpt id=\"p1\">[</bpt>ICLRDebugging::CanUnloadNow<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/iclrdebugging-canunloadnow-method.md)</ept> method indicates that they may be freed, at which point it is the caller’s responsibility to free the handles.","pos":[1959,2248],"source":" The module handles have to remain valid until a call to the [ICLRDebugging::CanUnloadNow](../../../../docs/framework/unmanaged-api/debugging/iclrdebugging-canunloadnow-method.md) method indicates that they may be freed, at which point it is the caller’s responsibility to free the handles."},{"content":"The debugger may use any available means to locate or procure the debugging module.","pos":[2255,2338]},{"pos":[2346,2604],"content":"[!IMPORTANT]\n This feature allows the API caller to provide modules that contain executable, and possibly malicious, code. As a security precaution, the caller should not use `ProvideLibrary` to distribute any code that it is not willing to execute itself.","leadings":["","> "],"nodes":[{"content":"This feature allows the API caller to provide modules that contain executable, and possibly malicious, code. As a security precaution, the caller should not use `ProvideLibrary` to distribute any code that it is not willing to execute itself.","pos":[14,256],"nodes":[{"content":"This feature allows the API caller to provide modules that contain executable, and possibly malicious, code.","pos":[0,108]},{"content":"As a security precaution, the caller should not use <ph id=\"ph1\">`ProvideLibrary`</ph> to distribute any code that it is not willing to execute itself.","pos":[109,242],"source":" As a security precaution, the caller should not use `ProvideLibrary` to distribute any code that it is not willing to execute itself."}]}]},{"content":"If a serious security issue is discovered in an already released library, such as mscordbi.dll or mscordacwks.dll, the shim can be patched to recognize the bad versions of the files.","pos":[2615,2797]},{"content":"The shim can then issue requests for the patched versions of the files and reject the bad versions if they are provided in response to any request.","pos":[2798,2945]},{"content":"This can occur only if the user has patched to a new version of the shim.","pos":[2946,3019]},{"content":"Unpatched versions will remain vulnerable.","pos":[3020,3062]},{"pos":[3071,3083],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3087,3191],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3198,3234],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> CorDebug.idl, CorDebug.h","source":"**Header:** CorDebug.idl, CorDebug.h"},{"pos":[3241,3266],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> CorGuids.lib","source":"**Library:** CorGuids.lib"},{"pos":[3273,3381],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[3390,3398],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Debugging Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md)</ept><ph id=\"ph1\"> </ph>","pos":[3402,3501],"source":"[Debugging Interfaces](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md) "},{"content":"<bpt id=\"p1\">[</bpt>Debugging<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/index.md)</ept>","pos":[3505,3577],"source":"[Debugging](../../../../docs/framework/unmanaged-api/debugging/index.md)"}]}