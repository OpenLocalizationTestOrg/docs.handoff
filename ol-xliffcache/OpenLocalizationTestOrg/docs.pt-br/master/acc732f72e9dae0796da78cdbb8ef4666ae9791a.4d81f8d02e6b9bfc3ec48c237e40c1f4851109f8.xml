{"content":"---\ntitle: \"Deciding When to Implement the Event-based Asynchronous Pattern\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"Event-based Asynchronous Pattern\"\n  - \"ProgressChangedEventArgs class\"\n  - \"BackgroundWorker component\"\n  - \"events [.NET Framework], asynchronous\"\n  - \"AsyncOperationManager class\"\n  - \"threading [.NET Framework], asynchronous features\"\n  - \"AsyncOperation class\"\n  - \"AsyncCompletedEventArgs class\"\nms.assetid: a00046aa-785d-4f7f-a8e5-d06475ea50da\n---\n# Deciding When to Implement the Event-based Asynchronous Pattern\nThe Event-based Asynchronous Pattern provides a pattern for exposing the asynchronous behavior of a class. With the introduction of this pattern, the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] defines two patterns for exposing asynchronous behavior: the Asynchronous Pattern based on the <xref:System.IAsyncResult?displayProperty=nameWithType> interface, and the event-based pattern. This topic describes when it is appropriate for you to implement both patterns.  \n  \n For more information about asynchronous programming with the <xref:System.IAsyncResult> interface, see [Asynchronous Programming Model (APM)](../../../docs/standard/asynchronous-programming-patterns/asynchronous-programming-model-apm.md).  \n  \n## General Principles  \n In general, you should expose asynchronous features using the Event-based Asynchronous Pattern whenever possible. However, there are some requirements that the event-based pattern cannot meet. In those cases, you may need to implement the <xref:System.IAsyncResult> pattern in addition to the event-based pattern.  \n  \n> [!NOTE]\n>  It is rare for the <xref:System.IAsyncResult> pattern to be implemented without the event-based pattern also being implemented.  \n  \n## Guidelines  \n The following list describes the guidelines for when you should implement Event-based Asynchronous Pattern:  \n  \n-   Use the event-based pattern as the default API to expose asynchronous behavior for your class.  \n  \n-   Do not expose the <xref:System.IAsyncResult> pattern when your class is primarily used in a client application, for example Windows Forms.  \n  \n-   Only expose the <xref:System.IAsyncResult> pattern when it is necessary for meeting your requirements. For example, compatibility with an existing API may require you to expose the <xref:System.IAsyncResult> pattern.  \n  \n-   Do not expose the <xref:System.IAsyncResult> pattern without also exposing the event-based pattern.  \n  \n-   If you must expose the <xref:System.IAsyncResult> pattern, do so as an advanced option. For example, if you generate a proxy object, generate the event-based pattern by default, with an option to generate the <xref:System.IAsyncResult> pattern.  \n  \n-   Build your event-based pattern implementation on your <xref:System.IAsyncResult> pattern implementation.  \n  \n-   Avoid exposing both the event-based pattern and the <xref:System.IAsyncResult> pattern on the same class. Expose the event-based pattern on \"higher level\" classes and the <xref:System.IAsyncResult> pattern on \"lower level\" classes. For example, compare the event-based pattern on the <xref:System.Net.WebClient> component with the <xref:System.IAsyncResult> pattern on the <xref:System.Web.HttpRequest> class.  \n  \n    -   Expose the event-based pattern and the <xref:System.IAsyncResult> pattern on the same class when compatibility requires it. For example, if you have already released an API that uses the <xref:System.IAsyncResult> pattern, you would need to retain the <xref:System.IAsyncResult> pattern for backward compatibility.  \n  \n    -   Expose the event-based pattern and the <xref:System.IAsyncResult> pattern on the same class if the resulting object model complexity outweighs the benefit of separating the implementations. It is better to expose both patterns on a single class than to avoid exposing the event-based pattern.  \n  \n    -   If you must expose both the event-based pattern and <xref:System.IAsyncResult> pattern on a single class, use <xref:System.ComponentModel.EditorBrowsableAttribute> set to <xref:System.ComponentModel.EditorBrowsableState.Advanced> to mark the <xref:System.IAsyncResult> pattern implementation as an advanced feature. This indicates to design environments, such as Visual Studio IntelliSense, not to display the <xref:System.IAsyncResult> properties and methods. These properties and methods are still fully usable, but the developer working through IntelliSense has a clearer view of the API.  \n  \n## Criteria for Exposing the IAsyncResult Pattern in Addition to the Event-based Pattern  \n While the Event-based Asynchronous Pattern has many benefits under the previously mentioned scenarios, it does have some drawbacks, which you should be aware of if performance is your most important requirement.  \n  \n There are three scenarios that the event-based pattern does not address as well as the <xref:System.IAsyncResult> pattern:  \n  \n-   Blocking wait on one <xref:System.IAsyncResult>  \n  \n-   Blocking wait on many <xref:System.IAsyncResult> objects  \n  \n-   Polling for completion on the <xref:System.IAsyncResult>  \n  \n You can address these scenarios by using the event-based pattern, but doing so is more cumbersome than using the <xref:System.IAsyncResult> pattern.  \n  \n Developers often use the <xref:System.IAsyncResult> pattern for services that typically have very high performance requirements. For example, the polling for completion scenario is a high-performance server technique.  \n  \n Additionally, the event-based pattern is less efficient than the <xref:System.IAsyncResult> pattern because it creates more objects, especially <xref:System.EventArgs>, and because it synchronizes across threads.  \n  \n The following list shows some recommendations to follow if you decide to use the <xref:System.IAsyncResult> pattern:  \n  \n-   Only expose the <xref:System.IAsyncResult> pattern when you specifically require support for <xref:System.Threading.WaitHandle> or <xref:System.IAsyncResult> objects.  \n  \n-   Only expose the <xref:System.IAsyncResult> pattern when you have an existing API that uses the <xref:System.IAsyncResult> pattern.  \n  \n-   If you have an existing API based on the <xref:System.IAsyncResult> pattern, consider also exposing the event-based pattern in your next release.  \n  \n-   Only expose <xref:System.IAsyncResult> pattern if you have high performance requirements which you have verified cannot be met by the event-based pattern but can be met by the <xref:System.IAsyncResult> pattern.  \n  \n## See also\n\n- [How to: Implement a Component That Supports the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md)\n- [Event-based Asynchronous Pattern (EAP)](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-eap.md)\n- [Implementing the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md)\n- [Best Practices for Implementing the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/best-practices-for-implementing-the-event-based-asynchronous-pattern.md)\n- [Event-based Asynchronous Pattern Overview](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md)\n","nodes":[{"pos":[4,506],"embed":true,"restype":"x-metadata","content":"title: \"Deciding When to Implement the Event-based Asynchronous Pattern\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"Event-based Asynchronous Pattern\"\n  - \"ProgressChangedEventArgs class\"\n  - \"BackgroundWorker component\"\n  - \"events [.NET Framework], asynchronous\"\n  - \"AsyncOperationManager class\"\n  - \"threading [.NET Framework], asynchronous features\"\n  - \"AsyncOperation class\"\n  - \"AsyncCompletedEventArgs class\"\nms.assetid: a00046aa-785d-4f7f-a8e5-d06475ea50da","nodes":[{"content":"Deciding When to Implement the Event-based Asynchronous Pattern","nodes":[{"pos":[0,63],"content":"Deciding When to Implement the Event-based Asynchronous Pattern","nodes":[{"content":"Deciding When to Implement the Event-based Asynchronous Pattern","pos":[0,63]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[513,576],"content":"Deciding When to Implement the Event-based Asynchronous Pattern","linkify":"Deciding When to Implement the Event-based Asynchronous Pattern","nodes":[{"content":"Deciding When to Implement the Event-based Asynchronous Pattern","pos":[0,63]}]},{"content":"The Event-based Asynchronous Pattern provides a pattern for exposing the asynchronous behavior of a class.","pos":[577,683]},{"content":"With the introduction of this pattern, the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]</ph> defines two patterns for exposing asynchronous behavior: the Asynchronous Pattern based on the <ph id=\"ph2\">&lt;xref:System.IAsyncResult?displayProperty=nameWithType&gt;</ph> interface, and the event-based pattern.","pos":[684,978],"source":" With the introduction of this pattern, the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] defines two patterns for exposing asynchronous behavior: the Asynchronous Pattern based on the <xref:System.IAsyncResult?displayProperty=nameWithType> interface, and the event-based pattern."},{"content":"This topic describes when it is appropriate for you to implement both patterns.","pos":[979,1058]},{"pos":[1065,1303],"content":"For more information about asynchronous programming with the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> interface, see <bpt id=\"p1\">[</bpt>Asynchronous Programming Model (APM)<ept id=\"p1\">](../../../docs/standard/asynchronous-programming-patterns/asynchronous-programming-model-apm.md)</ept>.","source":"For more information about asynchronous programming with the <xref:System.IAsyncResult> interface, see [Asynchronous Programming Model (APM)](../../../docs/standard/asynchronous-programming-patterns/asynchronous-programming-model-apm.md)."},{"pos":[1312,1330],"content":"General Principles","linkify":"General Principles","nodes":[{"content":"General Principles","pos":[0,18]}]},{"content":"In general, you should expose asynchronous features using the Event-based Asynchronous Pattern whenever possible.","pos":[1334,1447]},{"content":"However, there are some requirements that the event-based pattern cannot meet.","pos":[1448,1526]},{"content":"In those cases, you may need to implement the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern in addition to the event-based pattern.","pos":[1527,1647],"source":" In those cases, you may need to implement the <xref:System.IAsyncResult> pattern in addition to the event-based pattern."},{"pos":[1655,1793],"content":"[!NOTE]\n It is rare for the <xref:System.IAsyncResult> pattern to be implemented without the event-based pattern also being implemented.","leadings":["","> "],"nodes":[{"content":"It is rare for the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern to be implemented without the event-based pattern also being implemented.","pos":[9,136],"source":"It is rare for the <xref:System.IAsyncResult> pattern to be implemented without the event-based pattern also being implemented."}]},{"pos":[1802,1812],"content":"Guidelines","linkify":"Guidelines","nodes":[{"content":"Guidelines","pos":[0,10]}]},{"content":"The following list describes the guidelines for when you should implement Event-based Asynchronous Pattern:","pos":[1816,1923]},{"content":"Use the event-based pattern as the default API to expose asynchronous behavior for your class.","pos":[1933,2027]},{"pos":[2037,2175],"content":"Do not expose the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern when your class is primarily used in a client application, for example Windows Forms.","source":"Do not expose the <xref:System.IAsyncResult> pattern when your class is primarily used in a client application, for example Windows Forms."},{"content":"Only expose the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern when it is necessary for meeting your requirements.","pos":[2185,2287],"source":"Only expose the <xref:System.IAsyncResult> pattern when it is necessary for meeting your requirements."},{"content":"For example, compatibility with an existing API may require you to expose the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern.","pos":[2288,2401],"source":" For example, compatibility with an existing API may require you to expose the <xref:System.IAsyncResult> pattern."},{"pos":[2411,2510],"content":"Do not expose the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern without also exposing the event-based pattern.","source":"Do not expose the <xref:System.IAsyncResult> pattern without also exposing the event-based pattern."},{"content":"If you must expose the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern, do so as an advanced option.","pos":[2520,2607],"source":"If you must expose the <xref:System.IAsyncResult> pattern, do so as an advanced option."},{"content":"For example, if you generate a proxy object, generate the event-based pattern by default, with an option to generate the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern.","pos":[2608,2764],"source":" For example, if you generate a proxy object, generate the event-based pattern by default, with an option to generate the <xref:System.IAsyncResult> pattern."},{"pos":[2774,2878],"content":"Build your event-based pattern implementation on your <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern implementation.","source":"Build your event-based pattern implementation on your <xref:System.IAsyncResult> pattern implementation."},{"content":"Avoid exposing both the event-based pattern and the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern on the same class.","pos":[2888,2993],"source":"Avoid exposing both the event-based pattern and the <xref:System.IAsyncResult> pattern on the same class."},{"content":"Expose the event-based pattern on \"higher level\" classes and the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern on \"lower level\" classes.","pos":[2994,3119],"source":" Expose the event-based pattern on \"higher level\" classes and the <xref:System.IAsyncResult> pattern on \"lower level\" classes."},{"content":"For example, compare the event-based pattern on the <ph id=\"ph1\">&lt;xref:System.Net.WebClient&gt;</ph> component with the <ph id=\"ph2\">&lt;xref:System.IAsyncResult&gt;</ph> pattern on the <ph id=\"ph3\">&lt;xref:System.Web.HttpRequest&gt;</ph> class.","pos":[3120,3297],"source":" For example, compare the event-based pattern on the <xref:System.Net.WebClient> component with the <xref:System.IAsyncResult> pattern on the <xref:System.Web.HttpRequest> class."},{"content":"Expose the event-based pattern and the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern on the same class when compatibility requires it.","pos":[3311,3434],"source":"Expose the event-based pattern and the <xref:System.IAsyncResult> pattern on the same class when compatibility requires it."},{"content":"For example, if you have already released an API that uses the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern, you would need to retain the <ph id=\"ph2\">&lt;xref:System.IAsyncResult&gt;</ph> pattern for backward compatibility.","pos":[3435,3625],"source":" For example, if you have already released an API that uses the <xref:System.IAsyncResult> pattern, you would need to retain the <xref:System.IAsyncResult> pattern for backward compatibility."},{"content":"Expose the event-based pattern and the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern on the same class if the resulting object model complexity outweighs the benefit of separating the implementations.","pos":[3639,3828],"source":"Expose the event-based pattern and the <xref:System.IAsyncResult> pattern on the same class if the resulting object model complexity outweighs the benefit of separating the implementations."},{"content":"It is better to expose both patterns on a single class than to avoid exposing the event-based pattern.","pos":[3829,3931]},{"content":"If you must expose both the event-based pattern and <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern on a single class, use <ph id=\"ph2\">&lt;xref:System.ComponentModel.EditorBrowsableAttribute&gt;</ph> set to <ph id=\"ph3\">&lt;xref:System.ComponentModel.EditorBrowsableState.Advanced&gt;</ph> to mark the <ph id=\"ph4\">&lt;xref:System.IAsyncResult&gt;</ph> pattern implementation as an advanced feature.","pos":[3945,4260],"source":"If you must expose both the event-based pattern and <xref:System.IAsyncResult> pattern on a single class, use <xref:System.ComponentModel.EditorBrowsableAttribute> set to <xref:System.ComponentModel.EditorBrowsableState.Advanced> to mark the <xref:System.IAsyncResult> pattern implementation as an advanced feature."},{"content":"This indicates to design environments, such as Visual Studio IntelliSense, not to display the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> properties and methods.","pos":[4261,4405],"source":" This indicates to design environments, such as Visual Studio IntelliSense, not to display the <xref:System.IAsyncResult> properties and methods."},{"content":"These properties and methods are still fully usable, but the developer working through IntelliSense has a clearer view of the API.","pos":[4406,4536]},{"pos":[4545,4630],"content":"Criteria for Exposing the IAsyncResult Pattern in Addition to the Event-based Pattern","linkify":"Criteria for Exposing the IAsyncResult Pattern in Addition to the Event-based Pattern","nodes":[{"content":"Criteria for Exposing the IAsyncResult Pattern in Addition to the Event-based Pattern","pos":[0,85]}]},{"content":"While the Event-based Asynchronous Pattern has many benefits under the previously mentioned scenarios, it does have some drawbacks, which you should be aware of if performance is your most important requirement.","pos":[4634,4845]},{"pos":[4852,4974],"content":"There are three scenarios that the event-based pattern does not address as well as the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern:","source":"There are three scenarios that the event-based pattern does not address as well as the <xref:System.IAsyncResult> pattern:"},{"pos":[4984,5031],"content":"Blocking wait on one <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph>","source":"Blocking wait on one <xref:System.IAsyncResult>"},{"pos":[5041,5097],"content":"Blocking wait on many <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> objects","source":"Blocking wait on many <xref:System.IAsyncResult> objects"},{"pos":[5107,5163],"content":"Polling for completion on the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph>","source":"Polling for completion on the <xref:System.IAsyncResult>"},{"pos":[5170,5318],"content":"You can address these scenarios by using the event-based pattern, but doing so is more cumbersome than using the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern.","source":"You can address these scenarios by using the event-based pattern, but doing so is more cumbersome than using the <xref:System.IAsyncResult> pattern."},{"content":"Developers often use the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern for services that typically have very high performance requirements.","pos":[5325,5453],"source":"Developers often use the <xref:System.IAsyncResult> pattern for services that typically have very high performance requirements."},{"content":"For example, the polling for completion scenario is a high-performance server technique.","pos":[5454,5542]},{"pos":[5549,5761],"content":"Additionally, the event-based pattern is less efficient than the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern because it creates more objects, especially <ph id=\"ph2\">&lt;xref:System.EventArgs&gt;</ph>, and because it synchronizes across threads.","source":"Additionally, the event-based pattern is less efficient than the <xref:System.IAsyncResult> pattern because it creates more objects, especially <xref:System.EventArgs>, and because it synchronizes across threads."},{"pos":[5768,5884],"content":"The following list shows some recommendations to follow if you decide to use the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern:","source":"The following list shows some recommendations to follow if you decide to use the <xref:System.IAsyncResult> pattern:"},{"pos":[5894,6060],"content":"Only expose the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern when you specifically require support for <ph id=\"ph2\">&lt;xref:System.Threading.WaitHandle&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.IAsyncResult&gt;</ph> objects.","source":"Only expose the <xref:System.IAsyncResult> pattern when you specifically require support for <xref:System.Threading.WaitHandle> or <xref:System.IAsyncResult> objects."},{"pos":[6070,6200],"content":"Only expose the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern when you have an existing API that uses the <ph id=\"ph2\">&lt;xref:System.IAsyncResult&gt;</ph> pattern.","source":"Only expose the <xref:System.IAsyncResult> pattern when you have an existing API that uses the <xref:System.IAsyncResult> pattern."},{"pos":[6210,6355],"content":"If you have an existing API based on the <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern, consider also exposing the event-based pattern in your next release.","source":"If you have an existing API based on the <xref:System.IAsyncResult> pattern, consider also exposing the event-based pattern in your next release."},{"pos":[6365,6576],"content":"Only expose <ph id=\"ph1\">&lt;xref:System.IAsyncResult&gt;</ph> pattern if you have high performance requirements which you have verified cannot be met by the event-based pattern but can be met by the <ph id=\"ph2\">&lt;xref:System.IAsyncResult&gt;</ph> pattern.","source":"Only expose <xref:System.IAsyncResult> pattern if you have high performance requirements which you have verified cannot be met by the event-based pattern but can be met by the <xref:System.IAsyncResult> pattern."},{"pos":[6585,6593],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6597,6801],"content":"<bpt id=\"p1\">[</bpt>How to: Implement a Component That Supports the Event-based Asynchronous Pattern<ept id=\"p1\">](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md)</ept>","source":"[How to: Implement a Component That Supports the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md)"},{"pos":[6804,6942],"content":"<bpt id=\"p1\">[</bpt>Event-based Asynchronous Pattern (EAP)<ept id=\"p1\">](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-eap.md)</ept>","source":"[Event-based Asynchronous Pattern (EAP)](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-eap.md)"},{"pos":[6945,7107],"content":"<bpt id=\"p1\">[</bpt>Implementing the Event-based Asynchronous Pattern<ept id=\"p1\">](../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md)</ept>","source":"[Implementing the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md)"},{"pos":[7110,7310],"content":"<bpt id=\"p1\">[</bpt>Best Practices for Implementing the Event-based Asynchronous Pattern<ept id=\"p1\">](../../../docs/standard/asynchronous-programming-patterns/best-practices-for-implementing-the-event-based-asynchronous-pattern.md)</ept>","source":"[Best Practices for Implementing the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/best-practices-for-implementing-the-event-based-asynchronous-pattern.md)"},{"pos":[7313,7459],"content":"<bpt id=\"p1\">[</bpt>Event-based Asynchronous Pattern Overview<ept id=\"p1\">](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md)</ept>","source":"[Event-based Asynchronous Pattern Overview](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md)"}]}