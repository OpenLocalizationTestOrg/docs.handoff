{"content":"---\ntitle: \"How to: Create an Add-In That Returns a UI | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"creating an add-in that returns a UI [WPF]\"\n  - \"implementing add-in pipeline segments [WPF]\"\n  - \"add-in [WPF], returns a UI\"\nms.assetid: 57f274b7-4c66-4b72-92eb-81939a393776\ncaps.latest.revision: 9\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Create an Add-In That Returns a UI\nThis example shows how to create an add-in that returns a              [!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)][!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] to a host              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] standalone application.  \n  \n The add-in returns a              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is a              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] user control. The content of the user control is a single button that, when clicked, displays a message box. The              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] standalone application hosts the add-in and displays the user control (returned by the add-in) as the content of the main application window.  \n  \n **Prerequisites**  \n  \n This example highlights the              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extensions to the              [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model that enable this scenario, and assumes the following:  \n  \n-   Knowledge of the                      [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, including pipeline, add-in, and host development. If you are unfamiliar with these concepts, see                      [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md). For a tutorial that demonstrates the implementation of a pipeline, an add-in, and a host application, see                      [Walkthrough: Creating an Extensible Application](../../../../docs/framework/add-ins/walkthrough-create-extensible-app.md).  \n  \n-   Knowledge of the                      [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extensions to the                      [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, which can be found here:                      [WPF Add-Ins Overview](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md).  \n  \n## Example  \n To create an add-in that returns a                      [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)][!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] requires specific code for each pipeline segment, the add-in, and the host application.  \n    \n  \n<a name=\"Contract\"></a>   \n## Implementing the Contract Pipeline Segment  \n A method must be defined by the contract for returning a                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], and its return value must be of type                              <xref:System.AddIn.Contract.INativeHandleContract>. This is demonstrated by the                              `GetAddInUI` method of the                              `IWPFAddInContract` contract in the following code.  \n  \n [!code-csharp[SimpleAddInReturnsAUISample#ContractCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/Contracts/IWPFAddInContract.cs#contractcode)]\n [!code-vb[SimpleAddInReturnsAUISample#ContractCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/Contracts/IWPFAddInContract.vb#contractcode)]  \n  \n<a name=\"AddInView\"></a>   \n## Implementing the Add-In View Pipeline Segment  \n Because the add-in implements the                              [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] it provides as subclasses of                              <xref:System.Windows.FrameworkElement>, the method on the add-in view that correlates to                              `IWPFAddInView.GetAddInUI` must return a value of type                              <xref:System.Windows.FrameworkElement>. The following code shows the add-in view of the contract, implemented as an interface.  \n  \n [!code-csharp[SimpleAddInReturnsAUISample#AddInViewCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/AddInViews/IWPFAddInView.cs#addinviewcode)]\n [!code-vb[SimpleAddInReturnsAUISample#AddInViewCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/AddInViews/IWPFAddInView.vb#addinviewcode)]  \n  \n<a name=\"AddInSideAdapter\"></a>   \n## Implementing the Add-In-Side Adapter Pipeline Segment  \n The contract method returns an                              <xref:System.AddIn.Contract.INativeHandleContract>, but the add-in returns a                              <xref:System.Windows.FrameworkElement> (as specified by the add-in view). Consequently, the                              <xref:System.Windows.FrameworkElement> must be converted to an                              <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary. This work is performed by the add-in-side adapter by calling                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, as shown in the following code.  \n  \n [!code-csharp[SimpleAddInReturnsAUISample#AddInSideAdapterCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/AddInSideAdapters/WPFAddIn_ViewToContractAddInSideAdapter.cs#addinsideadaptercode)]\n [!code-vb[SimpleAddInReturnsAUISample#AddInSideAdapterCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/AddInSideAdapters/WPFAddIn_ViewToContractAddInSideAdapter.vb#addinsideadaptercode)]  \n  \n<a name=\"HostView\"></a>   \n## Implementing the Host View Pipeline Segment  \n Because the host application will display a                              <xref:System.Windows.FrameworkElement>, the method on the host view that correlates to                              `IWPFAddInHostView.GetAddInUI` must return a value of type                              <xref:System.Windows.FrameworkElement>. The following code shows the host view of the contract, implemented as an interface.  \n  \n [!code-csharp[SimpleAddInReturnsAUISample#HostViewCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/HostViews/IWPFAddInHostView.cs#hostviewcode)]\n [!code-vb[SimpleAddInReturnsAUISample#HostViewCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/HostViews/IWPFAddInHostView.vb#hostviewcode)]  \n  \n<a name=\"HostSideAdapter\"></a>   \n## Implementing the Host-Side Adapter Pipeline Segment  \n The contract method returns an                              <xref:System.AddIn.Contract.INativeHandleContract>, but the host application expects a                              <xref:System.Windows.FrameworkElement> (as specified by the host view). Consequently, the                              <xref:System.AddIn.Contract.INativeHandleContract> must be converted to a                              <xref:System.Windows.FrameworkElement> after crossing the isolation boundary. This work is performed by the host-side adapter by calling                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, as shown in the following code.  \n  \n [!code-csharp[SimpleAddInReturnsAUISample#HostSideAdapterCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/HostSideAdapters/WPFAddIn_ContractToViewHostSideAdapter.cs#hostsideadaptercode)]\n [!code-vb[SimpleAddInReturnsAUISample#HostSideAdapterCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/HostSideAdapters/WPFAddIn_ContractToViewHostSideAdapter.vb#hostsideadaptercode)]  \n  \n<a name=\"AddIn\"></a>   \n## Implementing the Add-In  \n With the add-in-side adapter and add-in view created, the add-in (                             `WPFAddIn1.AddIn`) must implement the                              `IWPFAddInView.GetAddInUI` method to return a                              <xref:System.Windows.FrameworkElement> object (a                              <xref:System.Windows.Controls.UserControl> in this example). The implementation of the                              <xref:System.Windows.Controls.UserControl>,                              `AddInUI`, is shown by the following code.  \n  \n [!code-xml[SimpleAddInReturnsAUISample#AddInUIMarkup](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/WPFAddIn1/AddInUI.xaml#addinuimarkup)]  \n  \n [!code-csharp[SimpleAddInReturnsAUISample#AddInUICodeBehind](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/WPFAddIn1/AddInUI.xaml.cs#addinuicodebehind)]\n [!code-vb[SimpleAddInReturnsAUISample#AddInUICodeBehind](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/WPFAddIn1/AddInUI.xaml.vb#addinuicodebehind)]  \n  \n The implementation of the                              `IWPFAddInView.GetAddInUI` by the add-in simply needs to return a new instance of                              `AddInUI`, as shown by the following code.  \n  \n [!code-csharp[SimpleAddInReturnsAUISample#AddInCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/WPFAddIn1/AddIn.cs#addincode)]\n [!code-vb[SimpleAddInReturnsAUISample#AddInCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/WPFAddIn1/AddIn.vb#addincode)]  \n  \n<a name=\"App\"></a>   \n## Implementing the Host Application  \n With the host-side adapter and host view created, the host application can use the                              [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to open the pipeline, acquire a host view of the add-in, and call the                              `IWPFAddInHostView.GetAddInUI` method. These steps are shown in the following code.  \n  \n [!code-csharp[SimpleAddInReturnsAUISample#GetUICode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/Host/MainWindow.xaml.cs#getuicode)]\n [!code-vb[SimpleAddInReturnsAUISample#GetUICode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/Host/MainWindow.xaml.vb#getuicode)]  \n  \n## See Also  \n [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md)   \n [WPF Add-Ins Overview](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md)","nodes":[{"pos":[4,525],"nodes":[{"content":"How to: Create an Add-In That Returns a UI | Microsoft Docs","nodes":[{"pos":[0,59],"content":"How to: Create an Add-In That Returns a UI | Microsoft Docs","nodes":[{"content":"How to: Create an Add-In That Returns a UI | Microsoft Docs","pos":[0,59]}]}],"pos":[6,68],"yaml":true}],"content":"title: \"How to: Create an Add-In That Returns a UI | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"creating an add-in that returns a UI [WPF]\"\n  - \"implementing add-in pipeline segments [WPF]\"\n  - \"add-in [WPF], returns a UI\"\nms.assetid: 57f274b7-4c66-4b72-92eb-81939a393776\ncaps.latest.revision: 9\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","yamlblock":true},{"pos":[532,574],"content":"How to: Create an Add-In That Returns a UI","linkify":"How to: Create an Add-In That Returns a UI","nodes":[{"content":"How to: Create an Add-In That Returns a UI","pos":[0,42]}]},{"pos":[575,895],"content":"This example shows how to create an add-in that returns a              <ph id=\"ph1\">[!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)]</ph><ph id=\"ph2\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph> to a host              <ph id=\"ph3\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> standalone application.","source":"This example shows how to create an add-in that returns a              [!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)][!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] to a host              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] standalone application."},{"content":"The add-in returns a              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> that is a              <ph id=\"ph2\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> user control.","pos":[902,1110],"source":"The add-in returns a              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is a              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] user control."},{"content":"The content of the user control is a single button that, when clicked, displays a message box.","pos":[1111,1205]},{"content":"The              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> standalone application hosts the add-in and displays the user control (returned by the add-in) as the content of the main application window.","pos":[1206,1434],"source":" The              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] standalone application hosts the add-in and displays the user control (returned by the add-in) as the content of the main application window."},{"pos":[1441,1458],"content":"<bpt id=\"p1\">**</bpt>Prerequisites<ept id=\"p1\">**</ept>","source":"**Prerequisites**"},{"pos":[1465,1737],"content":"This example highlights the              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> extensions to the              <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> add-in model that enable this scenario, and assumes the following:","source":"This example highlights the              [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extensions to the              [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model that enable this scenario, and assumes the following:"},{"content":"Knowledge of the                      <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> add-in model, including pipeline, add-in, and host development.","pos":[1747,1912],"source":"Knowledge of the                      [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, including pipeline, add-in, and host development."},{"content":"If you are unfamiliar with these concepts, see                      <bpt id=\"p1\">[</bpt>Add-ins and Extensibility<ept id=\"p1\">](../../../../docs/framework/add-ins/index.md)</ept>.","pos":[1913,2054],"source":" If you are unfamiliar with these concepts, see                      [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md)."},{"content":"For a tutorial that demonstrates the implementation of a pipeline, an add-in, and a host application, see                      <bpt id=\"p1\">[</bpt>Walkthrough: Creating an Extensible Application<ept id=\"p1\">](../../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)</ept>.","pos":[2055,2305],"source":" For a tutorial that demonstrates the implementation of a pipeline, an add-in, and a host application, see                      [Walkthrough: Creating an Extensible Application](../../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)."},{"pos":[2315,2681],"content":"Knowledge of the                      <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> extensions to the                      <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> add-in model, which can be found here:                      <bpt id=\"p1\">[</bpt>WPF Add-Ins Overview<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md)</ept>.","source":"Knowledge of the                      [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extensions to the                      [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, which can be found here:                      [WPF Add-Ins Overview](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md)."},{"pos":[2690,2697],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2701,2981],"content":"To create an add-in that returns a                      <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph><ph id=\"ph2\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> requires specific code for each pipeline segment, the add-in, and the host application.","source":"To create an add-in that returns a                      [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)][!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] requires specific code for each pipeline segment, the add-in, and the host application."},{"pos":[3022,3064],"content":"Implementing the Contract Pipeline Segment","linkify":"Implementing the Contract Pipeline Segment","nodes":[{"content":"Implementing the Contract Pipeline Segment","pos":[0,42]}]},{"content":"A method must be defined by the contract for returning a                              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph>, and its return value must be of type                              <ph id=\"ph2\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph>.","pos":[3068,3340],"source":"A method must be defined by the contract for returning a                              [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], and its return value must be of type                              <xref:System.AddIn.Contract.INativeHandleContract>."},{"content":"This is demonstrated by the                              <ph id=\"ph1\">`GetAddInUI`</ph> method of the                              <ph id=\"ph2\">`IWPFAddInContract`</ph> contract in the following code.","pos":[3341,3505],"source":" This is demonstrated by the                              `GetAddInUI` method of the                              `IWPFAddInContract` contract in the following code."},{"pos":[3512,3896],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>SimpleAddInReturnsAUISample#ContractCode<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/Contracts/IWPFAddInContract.cs#contractcode)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>SimpleAddInReturnsAUISample#ContractCode<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/Contracts/IWPFAddInContract.vb#contractcode)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[SimpleAddInReturnsAUISample#ContractCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/Contracts/IWPFAddInContract.cs#contractcode)]\n [!code-vb[SimpleAddInReturnsAUISample#ContractCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/Contracts/IWPFAddInContract.vb#contractcode)]"},{"pos":[3933,3978],"content":"Implementing the Add-In View Pipeline Segment","linkify":"Implementing the Add-In View Pipeline Segment","nodes":[{"content":"Implementing the Add-In View Pipeline Segment","pos":[0,45]}]},{"content":"Because the add-in implements the                              <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]</ph> it provides as subclasses of                              <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement&gt;</ph>, the method on the add-in view that correlates to                              <ph id=\"ph3\">`IWPFAddInView.GetAddInUI`</ph> must return a value of type                              <ph id=\"ph4\">&lt;xref:System.Windows.FrameworkElement&gt;</ph>.","pos":[3982,4430],"source":"Because the add-in implements the                              [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] it provides as subclasses of                              <xref:System.Windows.FrameworkElement>, the method on the add-in view that correlates to                              `IWPFAddInView.GetAddInUI` must return a value of type                              <xref:System.Windows.FrameworkElement>."},{"content":"The following code shows the add-in view of the contract, implemented as an interface.","pos":[4431,4517]},{"pos":[4524,4906],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>SimpleAddInReturnsAUISample#AddInViewCode<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/AddInViews/IWPFAddInView.cs#addinviewcode)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>SimpleAddInReturnsAUISample#AddInViewCode<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/AddInViews/IWPFAddInView.vb#addinviewcode)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[SimpleAddInReturnsAUISample#AddInViewCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/AddInViews/IWPFAddInView.cs#addinviewcode)]\n [!code-vb[SimpleAddInReturnsAUISample#AddInViewCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/AddInViews/IWPFAddInView.vb#addinviewcode)]"},{"pos":[4950,5003],"content":"Implementing the Add-In-Side Adapter Pipeline Segment","linkify":"Implementing the Add-In-Side Adapter Pipeline Segment","nodes":[{"content":"Implementing the Add-In-Side Adapter Pipeline Segment","pos":[0,53]}]},{"content":"The contract method returns an                              <ph id=\"ph1\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph>, but the add-in returns a                              <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> (as specified by the add-in view).","pos":[5007,5246],"source":"The contract method returns an                              <xref:System.AddIn.Contract.INativeHandleContract>, but the add-in returns a                              <xref:System.Windows.FrameworkElement> (as specified by the add-in view)."},{"content":"Consequently, the                              <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> must be converted to an                              <ph id=\"ph2\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph> before crossing the isolation boundary.","pos":[5247,5476],"source":" Consequently, the                              <xref:System.Windows.FrameworkElement> must be converted to an                              <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary."},{"content":"This work is performed by the add-in-side adapter by calling                              <ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A&gt;</ph>, as shown in the following code.","pos":[5477,5678],"source":" This work is performed by the add-in-side adapter by calling                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, as shown in the following code."},{"pos":[5685,6161],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>SimpleAddInReturnsAUISample#AddInSideAdapterCode<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/AddInSideAdapters/WPFAddIn_ViewToContractAddInSideAdapter.cs#addinsideadaptercode)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>SimpleAddInReturnsAUISample#AddInSideAdapterCode<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/AddInSideAdapters/WPFAddIn_ViewToContractAddInSideAdapter.vb#addinsideadaptercode)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[SimpleAddInReturnsAUISample#AddInSideAdapterCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/AddInSideAdapters/WPFAddIn_ViewToContractAddInSideAdapter.cs#addinsideadaptercode)]\n [!code-vb[SimpleAddInReturnsAUISample#AddInSideAdapterCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/AddInSideAdapters/WPFAddIn_ViewToContractAddInSideAdapter.vb#addinsideadaptercode)]"},{"pos":[6197,6240],"content":"Implementing the Host View Pipeline Segment","linkify":"Implementing the Host View Pipeline Segment","nodes":[{"content":"Implementing the Host View Pipeline Segment","pos":[0,43]}]},{"content":"Because the host application will display a                              <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement&gt;</ph>, the method on the host view that correlates to                              <ph id=\"ph2\">`IWPFAddInHostView.GetAddInUI`</ph> must return a value of type                              <ph id=\"ph3\">&lt;xref:System.Windows.FrameworkElement&gt;</ph>.","pos":[6244,6560],"source":"Because the host application will display a                              <xref:System.Windows.FrameworkElement>, the method on the host view that correlates to                              `IWPFAddInHostView.GetAddInUI` must return a value of type                              <xref:System.Windows.FrameworkElement>."},{"content":"The following code shows the host view of the contract, implemented as an interface.","pos":[6561,6645]},{"pos":[6652,7036],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>SimpleAddInReturnsAUISample#HostViewCode<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/HostViews/IWPFAddInHostView.cs#hostviewcode)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>SimpleAddInReturnsAUISample#HostViewCode<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/HostViews/IWPFAddInHostView.vb#hostviewcode)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[SimpleAddInReturnsAUISample#HostViewCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/HostViews/IWPFAddInHostView.cs#hostviewcode)]\n [!code-vb[SimpleAddInReturnsAUISample#HostViewCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/HostViews/IWPFAddInHostView.vb#hostviewcode)]"},{"pos":[7079,7130],"content":"Implementing the Host-Side Adapter Pipeline Segment","linkify":"Implementing the Host-Side Adapter Pipeline Segment","nodes":[{"content":"Implementing the Host-Side Adapter Pipeline Segment","pos":[0,51]}]},{"content":"The contract method returns an                              <ph id=\"ph1\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph>, but the host application expects a                              <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> (as specified by the host view).","pos":[7134,7381],"source":"The contract method returns an                              <xref:System.AddIn.Contract.INativeHandleContract>, but the host application expects a                              <xref:System.Windows.FrameworkElement> (as specified by the host view)."},{"content":"Consequently, the                              <ph id=\"ph1\">&lt;xref:System.AddIn.Contract.INativeHandleContract&gt;</ph> must be converted to a                              <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> after crossing the isolation boundary.","pos":[7382,7609],"source":" Consequently, the                              <xref:System.AddIn.Contract.INativeHandleContract> must be converted to a                              <xref:System.Windows.FrameworkElement> after crossing the isolation boundary."},{"content":"This work is performed by the host-side adapter by calling                              <ph id=\"ph1\">&lt;xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A&gt;</ph>, as shown in the following code.","pos":[7610,7809],"source":" This work is performed by the host-side adapter by calling                              <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, as shown in the following code."},{"pos":[7816,8284],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>SimpleAddInReturnsAUISample#HostSideAdapterCode<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/HostSideAdapters/WPFAddIn_ContractToViewHostSideAdapter.cs#hostsideadaptercode)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>SimpleAddInReturnsAUISample#HostSideAdapterCode<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/HostSideAdapters/WPFAddIn_ContractToViewHostSideAdapter.vb#hostsideadaptercode)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[SimpleAddInReturnsAUISample#HostSideAdapterCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/HostSideAdapters/WPFAddIn_ContractToViewHostSideAdapter.cs#hostsideadaptercode)]\n [!code-vb[SimpleAddInReturnsAUISample#HostSideAdapterCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/HostSideAdapters/WPFAddIn_ContractToViewHostSideAdapter.vb#hostsideadaptercode)]"},{"pos":[8317,8340],"content":"Implementing the Add-In","linkify":"Implementing the Add-In","nodes":[{"content":"Implementing the Add-In","pos":[0,23]}]},{"content":"With the add-in-side adapter and add-in view created, the add-in (                             <ph id=\"ph1\">`WPFAddIn1.AddIn`</ph>) must implement the                              <ph id=\"ph2\">`IWPFAddInView.GetAddInUI`</ph> method to return a                              <ph id=\"ph3\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> object (a                              <ph id=\"ph4\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> in this example).","pos":[8344,8719],"source":"With the add-in-side adapter and add-in view created, the add-in (                             `WPFAddIn1.AddIn`) must implement the                              `IWPFAddInView.GetAddInUI` method to return a                              <xref:System.Windows.FrameworkElement> object (a                              <xref:System.Windows.Controls.UserControl> in this example)."},{"content":"The implementation of the                              <ph id=\"ph1\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph>,                              <ph id=\"ph2\">`AddInUI`</ph>, is shown by the following code.","pos":[8720,8890],"source":" The implementation of the                              <xref:System.Windows.Controls.UserControl>,                              `AddInUI`, is shown by the following code."},{"pos":[8897,9076],"content":"<bpt id=\"p1\">[!code-xml</bpt><bpt id=\"p2\">[</bpt>SimpleAddInReturnsAUISample#AddInUIMarkup<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/WPFAddIn1/AddInUI.xaml#addinuimarkup)</ept><ept id=\"p1\">]</ept>","source":"[!code-xml[SimpleAddInReturnsAUISample#AddInUIMarkup](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/WPFAddIn1/AddInUI.xaml#addinuimarkup)]"},{"pos":[9083,9477],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>SimpleAddInReturnsAUISample#AddInUICodeBehind<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/WPFAddIn1/AddInUI.xaml.cs#addinuicodebehind)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>SimpleAddInReturnsAUISample#AddInUICodeBehind<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/WPFAddIn1/AddInUI.xaml.vb#addinuicodebehind)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[SimpleAddInReturnsAUISample#AddInUICodeBehind](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/WPFAddIn1/AddInUI.xaml.cs#addinuicodebehind)]\n [!code-vb[SimpleAddInReturnsAUISample#AddInUICodeBehind](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/WPFAddIn1/AddInUI.xaml.vb#addinuicodebehind)]"},{"pos":[9484,9692],"content":"The implementation of the                              <ph id=\"ph1\">`IWPFAddInView.GetAddInUI`</ph> by the add-in simply needs to return a new instance of                              <ph id=\"ph2\">`AddInUI`</ph>, as shown by the following code.","source":"The implementation of the                              `IWPFAddInView.GetAddInUI` by the add-in simply needs to return a new instance of                              `AddInUI`, as shown by the following code."},{"pos":[9699,10047],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>SimpleAddInReturnsAUISample#AddInCode<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/WPFAddIn1/AddIn.cs#addincode)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>SimpleAddInReturnsAUISample#AddInCode<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/WPFAddIn1/AddIn.vb#addincode)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[SimpleAddInReturnsAUISample#AddInCode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/WPFAddIn1/AddIn.cs#addincode)]\n [!code-vb[SimpleAddInReturnsAUISample#AddInCode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/WPFAddIn1/AddIn.vb#addincode)]"},{"pos":[10078,10111],"content":"Implementing the Host Application","linkify":"Implementing the Host Application","nodes":[{"content":"Implementing the Host Application","pos":[0,33]}]},{"content":"With the host-side adapter and host view created, the host application can use the                              <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> add-in model to open the pipeline, acquire a host view of the add-in, and call the                              <ph id=\"ph2\">`IWPFAddInHostView.GetAddInUI`</ph> method.","pos":[10115,10441],"source":"With the host-side adapter and host view created, the host application can use the                              [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to open the pipeline, acquire a host view of the add-in, and call the                              `IWPFAddInHostView.GetAddInUI` method."},{"content":"These steps are shown in the following code.","pos":[10442,10486]},{"pos":[10493,10851],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>SimpleAddInReturnsAUISample#GetUICode<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/Host/MainWindow.xaml.cs#getuicode)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>SimpleAddInReturnsAUISample#GetUICode<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/Host/MainWindow.xaml.vb#getuicode)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[SimpleAddInReturnsAUISample#GetUICode](../../../../samples/snippets/csharp/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/CSharp/Host/MainWindow.xaml.cs#getuicode)]\n [!code-vb[SimpleAddInReturnsAUISample#GetUICode](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/SimpleAddInReturnsAUISample/VisualBasic/Host/MainWindow.xaml.vb#getuicode)]"},{"pos":[10860,10868],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Add-ins and Extensibility<ept id=\"p1\">](../../../../docs/framework/add-ins/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[10872,10945],"source":"[Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>WPF Add-Ins Overview<ept id=\"p1\">](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md)</ept>","pos":[10949,11043],"source":"[WPF Add-Ins Overview](../../../../docs/framework/wpf/app-development/wpf-add-ins-overview.md)"}]}