{"content":"---\ntitle: \"<loadFromRemoteSources> Element\"\nms.date: \"05/24/2018\"\nhelpviewer_keywords: \n  - \"loadFromRemoteSources element\"\n  - \"<loadFromRemoteSources> element\"\nms.assetid: 006d1280-2ac3-4db6-a984-a3d4e275046a\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# \\<loadFromRemoteSources> element\nSpecifies whether assemblies loaded from remote sources should be granted full trust in .NET Framework 4 and later.\n  \n> [!NOTE]\n>  If you were directed to this article because of an error message in the Visual Studio project error list or a build error, see [How to: Use an Assembly from the Web in Visual Studio](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/ee890038(v=vs.100)).  \n  \n \\<configuration>  \n\\<runtime>  \n\\<loadFromRemoteSources>  \n  \n## Syntax  \n  \n```xml  \n<loadFromRemoteSources    \n   enabled=\"true|false\"/>  \n```  \n  \n## Attributes and elements\n The following sections describe attributes, child elements, and parent elements.  \n  \n### Attributes  \n  \n|Attribute|Description|  \n|---------------|-----------------|  \n|`enabled`|Required attribute.<br /><br /> Specifies whether an assembly that is loaded from a remote source should be granted full trust.|  \n  \n## enabled attribute  \n  \n|Value|Description|  \n|-----------|-----------------|  \n|`false`|Do not grant full trust to applications from remote sources. This is the default.|  \n|`true`|Grant full trust to applications from remote sources.|  \n  \n### Child elements  \n None.  \n  \n### Parent elements  \n  \n|Element|Description|  \n|-------------|-----------------|  \n|`configuration`|The root element in every configuration file used by the common language runtime and .NET Framework applications.|  \n|`runtime`|Contains information about runtime initialization options.|  \n  \n## Remarks\n\nIn the .NET Framework 3.5 and earlier versions, if you load an assembly from a remote location, code in the assembly runs in partial trust with a grant set that depends on the zone from which it is loaded. For example, if you load an assembly from a website, it is loaded into the Internet zone and granted the Internet permission set. In other words, it executes in an Internet sandbox.\n\nStarting with the .NET Framework 4, code access security (CAS) policy is disabled and assemblies are loaded in full trust. Ordinarily, this would grant full trust to assemblies loaded with the <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> method that previously had been sandboxed. To prevent this, the ability to run code in assemblies loaded from a remote source is disabled by default. By default, if you attempt to load a remote assembly, a <xref:System.IO.FileLoadException> with an exception message like the following is thrown:\n\n```text\nSystem.IO.FileNotFoundException: Could not load file or assembly 'file:assem.dll' or one of its dependencies. Operation is not supported. \n(Exception from HRESULT: 0x80131515)\nFile name: 'file:assem.dll' ---> \nSystem.NotSupportedException: An attempt was made to load an assembly from a network location which would have caused the assembly \nto be sandboxed in previous versions of the .NET Framework. This release of the .NET Framework does not enable CAS policy by default, \nso this load may be dangerous. If this load is not intended to sandbox the assembly, please enable the loadFromRemoteSources switch. \n```\n\nTo load the assembly and execute its code, you must either:\n\n- Explicitly create a sandbox for the assembly (see [How to: Run Partially Trusted Code in a Sandbox](../../../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md)).\n\n- Run the assembly's code in full trust. You do this by configuring the `<loadFromRemoteSources>` element. It lets you specify that the assemblies that run in partial trust in earlier versions of the .NET Framework now run in full trust in the .NET Framework 4 and later versions.\n\n> [!IMPORTANT]\n> If the assembly should not run in full trust, do not set this configuration element. Instead, create a sandboxed <xref:System.AppDomain> in which to load the assembly.\n\nThe `enabled` attribute for the `<loadFromRemoteSources>` element is effective only when code access security (CAS) is disabled. By default, CAS policy is disabled in the .NET Framework 4 and later versions. If you set `enabled` to `true`, remote assemblies are granted full trust.\n\nIf `enabled` is not set to `true`, a <xref:System.IO.FileLoadException> is thrown under the either of the following conditions:\n\n- The sandboxing behavior of the current domain is different from its behavior in the .NET Framework 3.5. This requires CAS policy to be disabled, and the current domain not to be sandboxed.\n\n- The assembly being loaded is not from the `MyComputer` zone.\n\nSetting the `<loadFromRemoteSources>` element to `true` prevents this exception from being thrown. It enables you to specify that you are not relying on the common language runtime to sandbox the loaded assemblies for security, and that they can be allowed to execute in full trust.\n\n## Notes\n\n- In the .NET Framework 4.5 and later versions, assemblies on local network shares run in full trust by default; you do not have to enable the `<loadFromRemoteSources>` element.\n\n- If an application has been copied from the web, it is flagged by Windows as being a web application, even if it resides on the local computer. You can change that designation by changing its file properties, or you can use the `<loadFromRemoteSources>` element to grant the assembly full trust. As an alternative, you can use the <xref:System.Reflection.Assembly.UnsafeLoadFrom%2A> method to load a local assembly that the operating system has flagged as having been loaded from the web.\n\n- You may get a <xref:System.IO.FileLoadException> in an application that is running in a Windows Virtual PC application. This can happen when you try to load a file from linked folders on the hosting computer. It can also occur when you try to load a file from a folder linked over [Remote Desktop Services](https://go.microsoft.com/fwlink/?LinkId=182775) (Terminal Services). To avoid the exception, set `enabled` to `true`.\n\n## Configuration file\n\nThis element is typically used in the application configuration file, but can be used in other configuration files depending upon the context. For more information, see the article [More Implicit Uses of CAS Policy: loadFromRemoteSources](https://go.microsoft.com/fwlink/p/?LinkId=266839) in the .NET Security blog.  \n\n## Example\n\nThe following example shows how to grant full trust to assemblies loaded from remote sources.\n\n```xml\n<configuration>  \n   <runtime>  \n      <loadFromRemoteSources enabled=\"true\"/>  \n   </runtime>  \n</configuration>  \n```\n\n## See also\n\n- [More Implicit Uses of CAS Policy: loadFromRemoteSources](https://go.microsoft.com/fwlink/p/?LinkId=266839)\n- [How to: Run Partially Trusted Code in a Sandbox](../../../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md)\n- [Runtime Settings Schema](../../../../../docs/framework/configure-apps/file-schema/runtime/index.md)\n- [Configuration File Schema](../../../../../docs/framework/configure-apps/file-schema/index.md)\n- <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType>\n","nodes":[{"pos":[4,251],"embed":true,"restype":"x-metadata","content":"title: \"<loadFromRemoteSources> Element\"\nms.date: \"05/24/2018\"\nhelpviewer_keywords: \n  - \"loadFromRemoteSources element\"\n  - \"<loadFromRemoteSources> element\"\nms.assetid: 006d1280-2ac3-4db6-a984-a3d4e275046a\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"<loadFromRemoteSources> Element","nodes":[{"pos":[0,31],"content":"<ph id=\"ph1\">&lt;loadFromRemoteSources&gt;</ph> Element","source":"<loadFromRemoteSources> Element"}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[258,290],"content":"\\<loadFromRemoteSources> element","linkify":"\\<loadFromRemoteSources> element","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>loadFromRemoteSources&gt; element","pos":[0,32],"source":"\\<loadFromRemoteSources> element"}]},{"content":"Specifies whether assemblies loaded from remote sources should be granted full trust in .NET Framework 4 and later.","pos":[291,406]},{"pos":[412,703],"content":"[!NOTE]\n If you were directed to this article because of an error message in the Visual Studio project error list or a build error, see [How to: Use an Assembly from the Web in Visual Studio](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/ee890038(v=vs.100)).","leadings":["","> "],"nodes":[{"content":"If you were directed to this article because of an error message in the Visual Studio project error list or a build error, see <bpt id=\"p1\">[</bpt>How to: Use an Assembly from the Web in Visual Studio<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/ee890038(v=vs.100))</ept>.","pos":[9,289],"source":"If you were directed to this article because of an error message in the Visual Studio project error list or a build error, see [How to: Use an Assembly from the Web in Visual Studio](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/ee890038(v=vs.100))."}]},{"content":"<ph id=\"ph1\">\\&lt;</ph>configuration&gt;","pos":[710,726],"source":"\\<configuration>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>runtime&gt;","pos":[729,739],"source":"\\<runtime>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>loadFromRemoteSources&gt;","pos":[742,766],"source":"\\<loadFromRemoteSources>"},{"pos":[775,781],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[863,886],"content":"Attributes and elements","linkify":"Attributes and elements","nodes":[{"content":"Attributes and elements","pos":[0,23]}]},{"content":"The following sections describe attributes, child elements, and parent elements.","pos":[888,968]},{"pos":[978,988],"content":"Attributes","linkify":"Attributes","nodes":[{"content":"Attributes","pos":[0,10]}]},{"content":"Attribute","pos":[995,1004]},{"content":"Description","pos":[1005,1016]},{"content":"Required attribute.","pos":[1069,1088]},{"content":"Specifies whether an assembly that is loaded from a remote source should be granted full trust.","pos":[1101,1196]},{"pos":[1206,1223],"content":"enabled attribute","linkify":"enabled attribute","nodes":[{"content":"enabled attribute","pos":[0,17]}]},{"content":"Value","pos":[1230,1235]},{"content":"Description","pos":[1236,1247]},{"content":"Do not grant full trust to applications from remote sources.","pos":[1294,1354]},{"content":"This is the default.","pos":[1355,1375]},{"content":"Grant full trust to applications from remote sources.","pos":[1387,1440]},{"pos":[1451,1465],"content":"Child elements","linkify":"Child elements","nodes":[{"content":"Child elements","pos":[0,14]}]},{"content":"None.","pos":[1469,1474]},{"pos":[1484,1499],"content":"Parent elements","linkify":"Parent elements","nodes":[{"content":"Parent elements","pos":[0,15]}]},{"content":"Element","pos":[1506,1513]},{"content":"Description","pos":[1514,1525]},{"content":"The root element in every configuration file used by the common language runtime and .NET Framework applications.","pos":[1582,1695]},{"content":"Contains information about runtime initialization options.","pos":[1710,1768]},{"pos":[1778,1785],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"In the .NET Framework 3.5 and earlier versions, if you load an assembly from a remote location, code in the assembly runs in partial trust with a grant set that depends on the zone from which it is loaded.","pos":[1787,1992]},{"content":"For example, if you load an assembly from a website, it is loaded into the Internet zone and granted the Internet permission set.","pos":[1993,2122]},{"content":"In other words, it executes in an Internet sandbox.","pos":[2123,2174]},{"content":"Starting with the .NET Framework 4, code access security (CAS) policy is disabled and assemblies are loaded in full trust.","pos":[2176,2298]},{"content":"Ordinarily, this would grant full trust to assemblies loaded with the <ph id=\"ph1\">&lt;xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType&gt;</ph> method that previously had been sandboxed.","pos":[2299,2486],"source":" Ordinarily, this would grant full trust to assemblies loaded with the <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> method that previously had been sandboxed."},{"content":"To prevent this, the ability to run code in assemblies loaded from a remote source is disabled by default.","pos":[2487,2593]},{"content":"By default, if you attempt to load a remote assembly, a <ph id=\"ph1\">&lt;xref:System.IO.FileLoadException&gt;</ph> with an exception message like the following is thrown:","pos":[2594,2740],"source":" By default, if you attempt to load a remote assembly, a <xref:System.IO.FileLoadException> with an exception message like the following is thrown:"},{"content":"To load the assembly and execute its code, you must either:","pos":[3366,3425]},{"pos":[3429,3616],"content":"Explicitly create a sandbox for the assembly (see <bpt id=\"p1\">[</bpt>How to: Run Partially Trusted Code in a Sandbox<ept id=\"p1\">](../../../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md)</ept>).","source":"Explicitly create a sandbox for the assembly (see [How to: Run Partially Trusted Code in a Sandbox](../../../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md))."},{"content":"Run the assembly's code in full trust.","pos":[3620,3658]},{"content":"You do this by configuring the <ph id=\"ph1\">`&lt;loadFromRemoteSources&gt;`</ph> element.","pos":[3659,3724],"source":" You do this by configuring the `<loadFromRemoteSources>` element."},{"content":"It lets you specify that the assemblies that run in partial trust in earlier versions of the .NET Framework now run in full trust in the .NET Framework 4 and later versions.","pos":[3725,3898]},{"pos":[3902,4084],"content":"[!IMPORTANT]\nIf the assembly should not run in full trust, do not set this configuration element. Instead, create a sandboxed <xref:System.AppDomain> in which to load the assembly.","leadings":["","> "],"nodes":[{"content":"If the assembly should not run in full trust, do not set this configuration element. Instead, create a sandboxed <xref:System.AppDomain> in which to load the assembly.","pos":[13,180],"nodes":[{"content":"If the assembly should not run in full trust, do not set this configuration element.","pos":[0,84]},{"content":"Instead, create a sandboxed <ph id=\"ph1\">&lt;xref:System.AppDomain&gt;</ph> in which to load the assembly.","pos":[85,167],"source":" Instead, create a sandboxed <xref:System.AppDomain> in which to load the assembly."}]}]},{"content":"The <ph id=\"ph1\">`enabled`</ph> attribute for the <ph id=\"ph2\">`&lt;loadFromRemoteSources&gt;`</ph> element is effective only when code access security (CAS) is disabled.","pos":[4086,4214],"source":"The `enabled` attribute for the `<loadFromRemoteSources>` element is effective only when code access security (CAS) is disabled."},{"content":"By default, CAS policy is disabled in the .NET Framework 4 and later versions.","pos":[4215,4293]},{"content":"If you set <ph id=\"ph1\">`enabled`</ph> to <ph id=\"ph2\">`true`</ph>, remote assemblies are granted full trust.","pos":[4294,4367],"source":" If you set `enabled` to `true`, remote assemblies are granted full trust."},{"pos":[4369,4496],"content":"If <ph id=\"ph1\">`enabled`</ph> is not set to <ph id=\"ph2\">`true`</ph>, a <ph id=\"ph3\">&lt;xref:System.IO.FileLoadException&gt;</ph> is thrown under the either of the following conditions:","source":"If `enabled` is not set to `true`, a <xref:System.IO.FileLoadException> is thrown under the either of the following conditions:"},{"content":"The sandboxing behavior of the current domain is different from its behavior in the .NET Framework 3.5.","pos":[4500,4603]},{"content":"This requires CAS policy to be disabled, and the current domain not to be sandboxed.","pos":[4604,4688]},{"pos":[4692,4752],"content":"The assembly being loaded is not from the <ph id=\"ph1\">`MyComputer`</ph> zone.","source":"The assembly being loaded is not from the `MyComputer` zone."},{"content":"Setting the <ph id=\"ph1\">`&lt;loadFromRemoteSources&gt;`</ph> element to <ph id=\"ph2\">`true`</ph> prevents this exception from being thrown.","pos":[4754,4852],"source":"Setting the `<loadFromRemoteSources>` element to `true` prevents this exception from being thrown."},{"content":"It enables you to specify that you are not relying on the common language runtime to sandbox the loaded assemblies for security, and that they can be allowed to execute in full trust.","pos":[4853,5036]},{"pos":[5041,5046],"content":"Notes","linkify":"Notes","nodes":[{"content":"Notes","pos":[0,5]}]},{"pos":[5050,5225],"content":"In the .NET Framework 4.5 and later versions, assemblies on local network shares run in full trust by default; you do not have to enable the <ph id=\"ph1\">`&lt;loadFromRemoteSources&gt;`</ph> element.","source":"In the .NET Framework 4.5 and later versions, assemblies on local network shares run in full trust by default; you do not have to enable the `<loadFromRemoteSources>` element."},{"content":"If an application has been copied from the web, it is flagged by Windows as being a web application, even if it resides on the local computer.","pos":[5229,5371]},{"content":"You can change that designation by changing its file properties, or you can use the <ph id=\"ph1\">`&lt;loadFromRemoteSources&gt;`</ph> element to grant the assembly full trust.","pos":[5372,5523],"source":" You can change that designation by changing its file properties, or you can use the `<loadFromRemoteSources>` element to grant the assembly full trust."},{"content":"As an alternative, you can use the <ph id=\"ph1\">&lt;xref:System.Reflection.Assembly.UnsafeLoadFrom%2A&gt;</ph> method to load a local assembly that the operating system has flagged as having been loaded from the web.","pos":[5524,5716],"source":" As an alternative, you can use the <xref:System.Reflection.Assembly.UnsafeLoadFrom%2A> method to load a local assembly that the operating system has flagged as having been loaded from the web."},{"content":"You may get a <ph id=\"ph1\">&lt;xref:System.IO.FileLoadException&gt;</ph> in an application that is running in a Windows Virtual PC application.","pos":[5720,5839],"source":"You may get a <xref:System.IO.FileLoadException> in an application that is running in a Windows Virtual PC application."},{"content":"This can happen when you try to load a file from linked folders on the hosting computer.","pos":[5840,5928]},{"content":"It can also occur when you try to load a file from a folder linked over <bpt id=\"p1\">[</bpt>Remote Desktop Services<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=182775)</ept> (Terminal Services).","pos":[5929,6095],"source":" It can also occur when you try to load a file from a folder linked over [Remote Desktop Services](https://go.microsoft.com/fwlink/?LinkId=182775) (Terminal Services)."},{"content":"To avoid the exception, set <ph id=\"ph1\">`enabled`</ph> to <ph id=\"ph2\">`true`</ph>.","pos":[6096,6144],"source":" To avoid the exception, set `enabled` to `true`."},{"pos":[6149,6167],"content":"Configuration file","linkify":"Configuration file","nodes":[{"content":"Configuration file","pos":[0,18]}]},{"content":"This element is typically used in the application configuration file, but can be used in other configuration files depending upon the context.","pos":[6169,6311]},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>More Implicit Uses of CAS Policy: loadFromRemoteSources<ept id=\"p1\">](https://go.microsoft.com/fwlink/p/?LinkId=266839)</ept> in the .NET Security blog.","pos":[6312,6484],"source":" For more information, see the article [More Implicit Uses of CAS Policy: loadFromRemoteSources](https://go.microsoft.com/fwlink/p/?LinkId=266839) in the .NET Security blog."},{"pos":[6491,6498],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows how to grant full trust to assemblies loaded from remote sources.","pos":[6500,6593]},{"pos":[6726,6734],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6738,6845],"content":"<bpt id=\"p1\">[</bpt>More Implicit Uses of CAS Policy: loadFromRemoteSources<ept id=\"p1\">](https://go.microsoft.com/fwlink/p/?LinkId=266839)</ept>","source":"[More Implicit Uses of CAS Policy: loadFromRemoteSources](https://go.microsoft.com/fwlink/p/?LinkId=266839)"},{"pos":[6848,6983],"content":"<bpt id=\"p1\">[</bpt>How to: Run Partially Trusted Code in a Sandbox<ept id=\"p1\">](../../../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md)</ept>","source":"[How to: Run Partially Trusted Code in a Sandbox](../../../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md)"},{"pos":[6986,7086],"content":"<bpt id=\"p1\">[</bpt>Runtime Settings Schema<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/runtime/index.md)</ept>","source":"[Runtime Settings Schema](../../../../../docs/framework/configure-apps/file-schema/runtime/index.md)"},{"pos":[7089,7183],"content":"<bpt id=\"p1\">[</bpt>Configuration File Schema<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/index.md)</ept>","source":"[Configuration File Schema](../../../../../docs/framework/configure-apps/file-schema/index.md)"}]}