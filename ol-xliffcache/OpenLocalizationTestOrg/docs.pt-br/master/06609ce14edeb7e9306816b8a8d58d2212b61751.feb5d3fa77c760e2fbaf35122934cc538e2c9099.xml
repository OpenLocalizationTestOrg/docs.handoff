{"content":"---\ntitle: \"Method-Based Query Syntax Examples: Aggregate Operators\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 0e306067-5720-4782-9719-2286570a7e47\n---\n# Method-Based Query Syntax Examples: Aggregate Operators\nThe examples in this topic demonstrate how to use the <xref:System.Linq.Enumerable.Aggregate%2A>, <xref:System.Linq.Enumerable.Average%2A>, <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.LongCount%2A>, <xref:System.Linq.Enumerable.Max%2A>, <xref:System.Linq.Enumerable.Min%2A>, and <xref:System.Linq.Enumerable.Sum%2A> methods to query the [AdventureWorks Sales Model](https://archive.codeplex.com/?p=msftdbprodsamples) using method-based query syntax. The AdventureWorks Sales Model used in these examples is built from the Contact, Address, Product, SalesOrderHeader, and SalesOrderDetail tables in the AdventureWorks sample database.  \n  \n The examples in this topic use the following `using`/`Imports` statements:  \n  \n [!code-csharp[DP L2E Examples#ImportsUsing](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#importsusing)]\n [!code-vb[DP L2E Examples#ImportsUsing](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#importsusing)]  \n  \n## Average  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Average%2A> method to find the average list price of the products.  \n  \n [!code-csharp[DP L2E Examples#Average_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#average_mq)]\n [!code-vb[DP L2E Examples#Average_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#average_mq)]  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Average%2A> method to find the average list price of the products of each style.  \n  \n [!code-csharp[DP L2E Examples#Average2_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#average2_mq)]\n [!code-vb[DP L2E Examples#Average2_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#average2_mq)]  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Average%2A> method to find the average total due.  \n  \n [!code-csharp[DP L2E Examples#AverageProjection_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#averageprojection_mq)]\n [!code-vb[DP L2E Examples#AverageProjection_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#averageprojection_mq)]  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Average%2A> method to get the average total due for each contact ID.  \n  \n [!code-csharp[DP L2E Examples#AverageGrouped_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#averagegrouped_mq)]\n [!code-vb[DP L2E Examples#AverageGrouped_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#averagegrouped_mq)]  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Average%2A> method to get the orders with the average total due for each contact.  \n  \n [!code-csharp[DP L2E Examples#AverageElements_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#averageelements_mq)]\n [!code-vb[DP L2E Examples#AverageElements_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#averageelements_mq)]  \n  \n## Count  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Count%2A> method to return the number of products in the Product table.  \n  \n [!code-csharp[DP L2E Examples#Count](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#count)]\n [!code-vb[DP L2E Examples#Count](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#count)]  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Count%2A> method to return a list of contact IDs and how many orders each has.  \n  \n [!code-csharp[DP L2E Examples#CountNested](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#countnested)]\n [!code-vb[DP L2E Examples#CountNested](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#countnested)]  \n  \n### Example  \n The following example groups products by color and uses the <xref:System.Linq.Enumerable.Count%2A> method to return the number of products in each color group.  \n  \n [!code-csharp[DP L2E Examples#CountGrouped](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#countgrouped)]\n [!code-vb[DP L2E Examples#CountGrouped](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#countgrouped)]  \n  \n## LongCount  \n  \n### Example  \n The following example gets the contact count as a long integer.  \n  \n [!code-csharp[DP L2E Examples#LongCountSimple](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#longcountsimple)]\n [!code-vb[DP L2E Examples#LongCountSimple](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#longcountsimple)]  \n  \n## Max  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the largest total due.  \n  \n [!code-csharp[DP L2E Examples#MaxProjection_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#maxprojection_mq)]\n [!code-vb[DP L2E Examples#MaxProjection_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#maxprojection_mq)]  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the largest total due for each contact ID.  \n  \n [!code-csharp[DP L2E Examples#MaxGrouped_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#maxgrouped_mq)]\n [!code-vb[DP L2E Examples#MaxGrouped_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#maxgrouped_mq)]  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the orders with the largest total due for each contact ID.  \n  \n [!code-csharp[DP L2E Examples#MaxElements_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#maxelements_mq)]\n [!code-vb[DP L2E Examples#MaxElements_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#maxelements_mq)]  \n  \n## Min  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the smallest total due.  \n  \n [!code-csharp[DP L2E Examples#MinProjection_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#minprojection_mq)]\n [!code-vb[DP L2E Examples#MinProjection_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#minprojection_mq)]  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the smallest total due for each contact ID.  \n  \n [!code-csharp[DP L2E Examples#MinGrouped_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#mingrouped_mq)]\n [!code-vb[DP L2E Examples#MinGrouped_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#mingrouped_mq)]  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the orders with the smallest total due for each contact.  \n  \n [!code-csharp[DP L2E Examples#MinElements_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#minelements_mq)]\n [!code-vb[DP L2E Examples#MinElements_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#minelements_mq)]  \n  \n## Sum  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Sum%2A> method to get the total number of order quantities in the SalesOrderDetail table.  \n  \n [!code-csharp[DP L2E Examples#SumProjection_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#sumprojection_mq)]\n [!code-vb[DP L2E Examples#SumProjection_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#sumprojection_mq)]  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Sum%2A> method to get the total due for each contact ID.  \n  \n [!code-csharp[DP L2E Examples#SumGrouped_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#sumgrouped_mq)]\n [!code-vb[DP L2E Examples#SumGrouped_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#sumgrouped_mq)]  \n  \n## See also\n\n- [Queries in LINQ to Entities](../../../../../../docs/framework/data/adonet/ef/language-reference/queries-in-linq-to-entities.md)\n","nodes":[{"pos":[4,173],"embed":true,"restype":"x-metadata","content":"title: \"Method-Based Query Syntax Examples: Aggregate Operators\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 0e306067-5720-4782-9719-2286570a7e47","nodes":[{"content":"Method-Based Query Syntax Examples: Aggregate Operators","nodes":[{"pos":[0,55],"content":"Method-Based Query Syntax Examples: Aggregate Operators","nodes":[{"content":"Method-Based Query Syntax Examples: Aggregate Operators","pos":[0,55]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[180,235],"content":"Method-Based Query Syntax Examples: Aggregate Operators","linkify":"Method-Based Query Syntax Examples: Aggregate Operators","nodes":[{"content":"Method-Based Query Syntax Examples: Aggregate Operators","pos":[0,55]}]},{"content":"The examples in this topic demonstrate how to use the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Aggregate%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Linq.Enumerable.Count%2A&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Linq.Enumerable.LongCount%2A&gt;</ph>, <ph id=\"ph5\">&lt;xref:System.Linq.Enumerable.Max%2A&gt;</ph>, <ph id=\"ph6\">&lt;xref:System.Linq.Enumerable.Min%2A&gt;</ph>, and <ph id=\"ph7\">&lt;xref:System.Linq.Enumerable.Sum%2A&gt;</ph> methods to query the <bpt id=\"p1\">[</bpt>AdventureWorks Sales Model<ept id=\"p1\">](https://archive.codeplex.com/?p=msftdbprodsamples)</ept> using method-based query syntax.","pos":[236,710],"source":"The examples in this topic demonstrate how to use the <xref:System.Linq.Enumerable.Aggregate%2A>, <xref:System.Linq.Enumerable.Average%2A>, <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.LongCount%2A>, <xref:System.Linq.Enumerable.Max%2A>, <xref:System.Linq.Enumerable.Min%2A>, and <xref:System.Linq.Enumerable.Sum%2A> methods to query the [AdventureWorks Sales Model](https://archive.codeplex.com/?p=msftdbprodsamples) using method-based query syntax."},{"content":"The AdventureWorks Sales Model used in these examples is built from the Contact, Address, Product, SalesOrderHeader, and SalesOrderDetail tables in the AdventureWorks sample database.","pos":[711,894]},{"pos":[901,975],"content":"The examples in this topic use the following <ph id=\"ph1\">`using`</ph><ph id=\"ph2\">/</ph><ph id=\"ph3\">`Imports`</ph> statements:","source":"The examples in this topic use the following `using`/`Imports` statements:"},{"pos":[1288,1295],"content":"Average","linkify":"Average","nodes":[{"content":"Average","pos":[0,7]}]},{"pos":[1305,1312],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1316,1442],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph> method to find the average list price of the products.","source":"The following example uses the <xref:System.Linq.Enumerable.Average%2A> method to find the average list price of the products."},{"pos":[1748,1755],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1759,1899],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph> method to find the average list price of the products of each style.","source":"The following example uses the <xref:System.Linq.Enumerable.Average%2A> method to find the average list price of the products of each style."},{"pos":[2209,2216],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2220,2329],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph> method to find the average total due.","source":"The following example uses the <xref:System.Linq.Enumerable.Average%2A> method to find the average total due."},{"pos":[2675,2682],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2686,2814],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph> method to get the average total due for each contact ID.","source":"The following example uses the <xref:System.Linq.Enumerable.Average%2A> method to get the average total due for each contact ID."},{"pos":[3148,3155],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3159,3300],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph> method to get the orders with the average total due for each contact.","source":"The following example uses the <xref:System.Linq.Enumerable.Average%2A> method to get the orders with the average total due for each contact."},{"pos":[3637,3642],"content":"Count","linkify":"Count","nodes":[{"content":"Count","pos":[0,5]}]},{"pos":[3652,3659],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3663,3794],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Count%2A&gt;</ph> method to return the number of products in the Product table.","source":"The following example uses the <xref:System.Linq.Enumerable.Count%2A> method to return the number of products in the Product table."},{"pos":[4080,4087],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4091,4229],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Count%2A&gt;</ph> method to return a list of contact IDs and how many orders each has.","source":"The following example uses the <xref:System.Linq.Enumerable.Count%2A> method to return a list of contact IDs and how many orders each has."},{"pos":[4539,4546],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4550,4709],"content":"The following example groups products by color and uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Count%2A&gt;</ph> method to return the number of products in each color group.","source":"The following example groups products by color and uses the <xref:System.Linq.Enumerable.Count%2A> method to return the number of products in each color group."},{"pos":[5022,5031],"content":"LongCount","linkify":"LongCount","nodes":[{"content":"LongCount","pos":[0,9]}]},{"pos":[5041,5048],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example gets the contact count as a long integer.","pos":[5052,5115]},{"pos":[5440,5443],"content":"Max","linkify":"Max","nodes":[{"content":"Max","pos":[0,3]}]},{"pos":[5453,5460],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5464,5568],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Max%2A&gt;</ph> method to get the largest total due.","source":"The following example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the largest total due."},{"pos":[5898,5905],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5909,6033],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Max%2A&gt;</ph> method to get the largest total due for each contact ID.","source":"The following example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the largest total due for each contact ID."},{"pos":[6351,6358],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[6362,6502],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Max%2A&gt;</ph> method to get the orders with the largest total due for each contact ID.","source":"The following example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the orders with the largest total due for each contact ID."},{"pos":[6823,6826],"content":"Min","linkify":"Min","nodes":[{"content":"Min","pos":[0,3]}]},{"pos":[6836,6843],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[6847,6952],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Min%2A&gt;</ph> method to get the smallest total due.","source":"The following example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the smallest total due."},{"pos":[7282,7289],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[7293,7418],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Min%2A&gt;</ph> method to get the smallest total due for each contact ID.","source":"The following example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the smallest total due for each contact ID."},{"pos":[7736,7743],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[7747,7885],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Min%2A&gt;</ph> method to get the orders with the smallest total due for each contact.","source":"The following example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the orders with the smallest total due for each contact."},{"pos":[8206,8209],"content":"Sum","linkify":"Sum","nodes":[{"content":"Sum","pos":[0,3]}]},{"pos":[8219,8226],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[8230,8379],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Sum%2A&gt;</ph> method to get the total number of order quantities in the SalesOrderDetail table.","source":"The following example uses the <xref:System.Linq.Enumerable.Sum%2A> method to get the total number of order quantities in the SalesOrderDetail table."},{"pos":[8709,8716],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[8720,8836],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Sum%2A&gt;</ph> method to get the total due for each contact ID.","source":"The following example uses the <xref:System.Linq.Enumerable.Sum%2A> method to get the total due for each contact ID."},{"pos":[9153,9161],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[9165,9293],"content":"<bpt id=\"p1\">[</bpt>Queries in LINQ to Entities<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/language-reference/queries-in-linq-to-entities.md)</ept>","source":"[Queries in LINQ to Entities](../../../../../../docs/framework/data/adonet/ef/language-reference/queries-in-linq-to-entities.md)"}]}