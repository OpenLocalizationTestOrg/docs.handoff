{"content":"---\ntitle: \"How to: Use Platform Invoke to Play a Wave File (C# Programming Guide) | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\n\n\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"CSharp\"\nhelpviewer_keywords: \n  - \"platform invoke, sound files\"\n  - \"interoperability [C#], playing WAV files using pinvoke\"\n  - \"wav files\"\n  - \".wav files\"\nms.assetid: f7f62f53-e026-4c40-b221-3a26adb0c2c5\ncaps.latest.revision: 30\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Use Platform Invoke to Play a Wave File (C# Programming Guide)\nThe following C# code example illustrates how to use platform invoke services to play a wave sound file on the Windows operating system.  \n  \n## Example  \n This example code uses `DllImport` to import `winmm.dll`'s `PlaySound` method entry point as `Form1 PlaySound()`. The example has a simple Windows Form with a button. Clicking the button opens a standard windows <xref:System.Windows.Forms.OpenFileDialog> dialog box so that you can open a file to play. When a wave file is selected, it is played by using the `PlaySound()` method of the winmm.DLL assembly method. For more information about winmm.dll's `PlaySound` method, see [Using the PlaySound function with Waveform-Audio Files](http://go.microsoft.com/fwlink/?LinkId=148553). Browse and select a file that has a .wav extension, and then click **Open** to play the wave file by using platform invoke. A text box shows the full path of the file selected.  \n  \n The **Open Files** dialog box is filtered to show only files that have a .wav extension through the filter settings:  \n  \n [!code-cs[csProgGuideInterop#5](../../../csharp/programming-guide/interop/codesnippet/CSharp/how-to-use-platform-invoke-to-play-a-wave-file_1.cs)]  \n  \n [!code-cs[csProgGuideInterop#3](../../../csharp/programming-guide/interop/codesnippet/CSharp/how-to-use-platform-invoke-to-play-a-wave-file_2.cs)]  \n  \n## Compiling the Code  \n  \n### To compile the code  \n  \n1.  Create a new C# Windows Application project in Visual Studio and name it **WinSound**.  \n  \n2.  Copy the code above, and paste it over the contents of the `Form1.cs` file.  \n  \n3.  Copy the following code, and paste it in the `Form1.Designer.cs` file, in the `InitializeComponent()` method, after any existing code.  \n  \n     [!code-cs[csProgGuideInterop#4](../../../csharp/programming-guide/interop/codesnippet/CSharp/how-to-use-platform-invoke-to-play-a-wave-file_3.cs)]  \n  \n4.  Compile and run the code.  \n  \n## .NET Framework Security  \n For more information, see [.NET Framework Security](http://go.microsoft.com/fwlink/?LinkId=37122).  \n  \n## See Also  \n [C# Programming Guide](../../../csharp/programming-guide/index.md)   \n [Interoperability Overview](../../../csharp/programming-guide/interop/interoperability-overview.md)   \n [Interoperability Overview](../../../csharp/programming-guide/interop/interoperability-overview.md)   \n [A Closer Look at Platform Invoke](http://msdn.microsoft.com/en-us/ba9dd55b-2eaa-45cd-8afd-75cb8d64d243)   \n [Marshaling Data with Platform Invoke](../../../framework/interop/marshaling-data-with-platform-invoke.md)","nodes":[{"pos":[12,99],"content":"How to: Use Platform Invoke to Play a Wave File (C# Programming Guide) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Use Platform Invoke to Play a Wave File (C# Programming Guide) | Microsoft Docs","pos":[0,87]}]},{"pos":[678,748],"content":"How to: Use Platform Invoke to Play a Wave File (C# Programming Guide)","linkify":"How to: Use Platform Invoke to Play a Wave File (C# Programming Guide)","nodes":[{"content":"How to: Use Platform Invoke to Play a Wave File (C# Programming Guide)","pos":[0,70]}]},{"content":"The following C# code example illustrates how to use platform invoke services to play a wave sound file on the Windows operating system.","pos":[749,885]},{"pos":[894,901],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example code uses <ph id=\"ph1\">`DllImport`</ph> to import <ph id=\"ph2\">`winmm.dll`</ph>'s <ph id=\"ph3\">`PlaySound`</ph> method entry point as <ph id=\"ph4\">`Form1 PlaySound()`</ph>.","pos":[905,1018],"source":"This example code uses `DllImport` to import `winmm.dll`'s `PlaySound` method entry point as `Form1 PlaySound()`."},{"content":"The example has a simple Windows Form with a button.","pos":[1019,1071]},{"content":"Clicking the button opens a standard windows <ph id=\"ph1\">&lt;xref:System.Windows.Forms.OpenFileDialog&gt;</ph> dialog box so that you can open a file to play.","pos":[1072,1207],"source":" Clicking the button opens a standard windows <xref:System.Windows.Forms.OpenFileDialog> dialog box so that you can open a file to play."},{"content":"When a wave file is selected, it is played by using the <ph id=\"ph1\">`PlaySound()`</ph> method of the winmm.DLL assembly method.","pos":[1208,1318],"source":" When a wave file is selected, it is played by using the `PlaySound()` method of the winmm.DLL assembly method."},{"content":"For more information about winmm.dll's <ph id=\"ph1\">`PlaySound`</ph> method, see <bpt id=\"p1\">[</bpt>Using the PlaySound function with Waveform-Audio Files<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=148553)</ept>.","pos":[1319,1486],"source":" For more information about winmm.dll's `PlaySound` method, see [Using the PlaySound function with Waveform-Audio Files](http://go.microsoft.com/fwlink/?LinkId=148553)."},{"content":"Browse and select a file that has a .wav extension, and then click <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> to play the wave file by using platform invoke.","pos":[1487,1610],"source":" Browse and select a file that has a .wav extension, and then click **Open** to play the wave file by using platform invoke."},{"content":"A text box shows the full path of the file selected.","pos":[1611,1663]},{"pos":[1670,1786],"content":"The <bpt id=\"p1\">**</bpt>Open Files<ept id=\"p1\">**</ept> dialog box is filtered to show only files that have a .wav extension through the filter settings:","source":"The **Open Files** dialog box is filtered to show only files that have a .wav extension through the filter settings:"},{"pos":[1793,1939],"content":"<bpt id=\"p1\">[!code-cs</bpt><bpt id=\"p2\">[</bpt>csProgGuideInterop#5<ept id=\"p2\">](../../../csharp/programming-guide/interop/codesnippet/CSharp/how-to-use-platform-invoke-to-play-a-wave-file_1.cs)</ept><ept id=\"p1\">]</ept>","source":"[!code-cs[csProgGuideInterop#5](../../../csharp/programming-guide/interop/codesnippet/CSharp/how-to-use-platform-invoke-to-play-a-wave-file_1.cs)]"},{"pos":[1946,2092],"content":"<bpt id=\"p1\">[!code-cs</bpt><bpt id=\"p2\">[</bpt>csProgGuideInterop#3<ept id=\"p2\">](../../../csharp/programming-guide/interop/codesnippet/CSharp/how-to-use-platform-invoke-to-play-a-wave-file_2.cs)</ept><ept id=\"p1\">]</ept>","source":"[!code-cs[csProgGuideInterop#3](../../../csharp/programming-guide/interop/codesnippet/CSharp/how-to-use-platform-invoke-to-play-a-wave-file_2.cs)]"},{"pos":[2101,2119],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[2129,2148],"content":"To compile the code","linkify":"To compile the code","nodes":[{"content":"To compile the code","pos":[0,19]}]},{"pos":[2158,2244],"content":"Create a new C# Windows Application project in Visual Studio and name it <bpt id=\"p1\">**</bpt>WinSound<ept id=\"p1\">**</ept>.","source":"Create a new C# Windows Application project in Visual Studio and name it **WinSound**."},{"pos":[2254,2329],"content":"Copy the code above, and paste it over the contents of the <ph id=\"ph1\">`Form1.cs`</ph> file.","source":"Copy the code above, and paste it over the contents of the `Form1.cs` file."},{"pos":[2339,2473],"content":"Copy the following code, and paste it in the <ph id=\"ph1\">`Form1.Designer.cs`</ph> file, in the <ph id=\"ph2\">`InitializeComponent()`</ph> method, after any existing code.","source":"Copy the following code, and paste it in the `Form1.Designer.cs` file, in the `InitializeComponent()` method, after any existing code."},{"pos":[2484,2630],"content":"<bpt id=\"p1\">[!code-cs</bpt><bpt id=\"p2\">[</bpt>csProgGuideInterop#4<ept id=\"p2\">](../../../csharp/programming-guide/interop/codesnippet/CSharp/how-to-use-platform-invoke-to-play-a-wave-file_3.cs)</ept><ept id=\"p1\">]</ept>","source":"[!code-cs[csProgGuideInterop#4](../../../csharp/programming-guide/interop/codesnippet/CSharp/how-to-use-platform-invoke-to-play-a-wave-file_3.cs)]"},{"content":"Compile and run the code.","pos":[2640,2665]},{"pos":[2674,2697],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"pos":[2701,2799],"content":"For more information, see <bpt id=\"p1\">[</bpt>.NET Framework Security<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=37122)</ept>.","source":"For more information, see [.NET Framework Security](http://go.microsoft.com/fwlink/?LinkId=37122)."},{"pos":[2808,2816],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>C# Programming Guide<ept id=\"p1\">](../../../csharp/programming-guide/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[2820,2887],"source":"[C# Programming Guide](../../../csharp/programming-guide/index.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Interoperability Overview<ept id=\"p1\">](../../../csharp/programming-guide/interop/interoperability-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[2890,2991],"source":" [Interoperability Overview](../../../csharp/programming-guide/interop/interoperability-overview.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Interoperability Overview<ept id=\"p1\">](../../../csharp/programming-guide/interop/interoperability-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[2994,3095],"source":" [Interoperability Overview](../../../csharp/programming-guide/interop/interoperability-overview.md) "},{"content":"<bpt id=\"p1\"> [</bpt>A Closer Look at Platform Invoke<ept id=\"p1\">](http://msdn.microsoft.com/en-us/ba9dd55b-2eaa-45cd-8afd-75cb8d64d243)</ept><ph id=\"ph1\"> </ph>","pos":[3098,3204],"source":" [A Closer Look at Platform Invoke](http://msdn.microsoft.com/en-us/ba9dd55b-2eaa-45cd-8afd-75cb8d64d243) "},{"content":"<bpt id=\"p1\"> [</bpt>Marshaling Data with Platform Invoke<ept id=\"p1\">](../../../framework/interop/marshaling-data-with-platform-invoke.md)</ept>","pos":[3207,3314],"source":" [Marshaling Data with Platform Invoke](../../../framework/interop/marshaling-data-with-platform-invoke.md)"}]}