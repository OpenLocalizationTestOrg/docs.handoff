{"content":"---\ntitle: \"Transport Security with Certificate Authentication | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 3d726b71-4d8b-4581-a3bb-02b9af51d11b\ncaps.latest.revision: 20\nauthor: \"BrucePerlerMS\"\nms.author: \"bruceper\"\nmanager: \"mbaldwin\"\n---\n# Transport Security with Certificate Authentication\nThis topic discusses using X.509 certificates for server and client authentication when using transport security. For more information about X.509 certificates see [X.509 Public Key Certificates](http://msdn.microsoft.com/library/bb540819\\(VS.85\\).aspx). Certificates must be issued by a certification authority, which is often a third-party issuer of certificates. On a Windows Server domain, Active Directory Certificate Services can be used to issue certificates to client computers on the domain. For more information see [Windows 2008 R2 Certificate Services](http://go.microsoft.com/fwlink/?LinkID=209949&clcid=0x409). In this scenario, the service is hosted under Internet Information Services (IIS) which is configured with Secure Sockets Layer (SSL). The service is configured with an SSL (X.509) certificate to allow clients to verify the identity of the server. The client is also configured with an X.509 certificate that allows the service to verify the identity of the client. The server’s certificate must be trusted by the client and the client’s certificate must be trusted by the server. The actual mechanics of how the service and client verifies each other’s identity is beyond the scope of this topic. For more information see [Digital Signature on Wikipedia](http://go.microsoft.com/fwlink/?LinkId=253157).  \n  \n This scenario implements a request/reply message pattern as illustrated by the following diagram.  \n  \n ![Secure transfer using certificates](../../../../docs/framework/wcf/feature-details/media/8f7b8968-899f-4538-a9e8-0eaa872a291c.gif \"8f7b8968-899f-4538-a9e8-0eaa872a291c\")  \n  \n [!INCLUDE[crabout](../../../../includes/crabout-md.md)] using a certificate with a service, see [Working with Certificates](../../../../docs/framework/wcf/feature-details/working-with-certificates.md) and [How to: Configure a Port with an SSL Certificate](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md). The following table describes the various characteristics of the scenario.  \n  \n|Characteristic|Description|  \n|--------------------|-----------------|  \n|Security Mode|Transport|  \n|Interoperability|With existing Web service clients and services.|  \n|Authentication (Server)<br /><br /> Authentication (Client)|Yes (using an SSL certificate)<br /><br /> Yes (using an X.509 certificate)|  \n|Data Integrity|Yes|  \n|Data Confidentiality|Yes|  \n|Transport|HTTPS|  \n|Binding|<xref:System.ServiceModel.WSHttpBinding>|  \n  \n## Configure the Service  \n Since the service in this scenario is hosted under IIS, it is configured with a web.config file. The following web.config shows how to configure the <xref:System.ServiceModel.WSHttpBinding> to use transport security and X.509 client credentials.  \n  \n```xml  \n<configuration>  \n  <system.serviceModel>  \n    <protocolMapping>  \n      <add scheme=\"https\" binding=\"wsHttpBinding\" />  \n    </protocolMapping>  \n    <bindings>  \n      <wsHttpBinding>  \n        <!-- configure wsHttp binding with Transport security mode and clientCredentialType as Certificate -->  \n        <binding>  \n          <security mode=\"Transport\">  \n            <transport clientCredentialType=\"Certificate\"/>              \n          </security>  \n        </binding>  \n      </wsHttpBinding>  \n    </bindings>  \n    <!--For debugging purposes set the includeExceptionDetailInFaults attribute to true-->  \n    <behaviors>  \n      <serviceBehaviors>  \n        <behavior>            \n           <serviceDebug includeExceptionDetailInFaults=\"True\" />  \n        </behavior>  \n      </serviceBehaviors>  \n    </behaviors>  \n  </system.serviceModel>  \n</configuration>  \n  \n```  \n  \n## Configure the Client  \n The client can be configured in code or in an app.config file. The following example shows how to configure the client in code.  \n  \n```vb  \n// Create the binding.  \nWSHttpBinding myBinding = new WSHttpBinding();  \nmyBinding.Security.Mode = SecurityMode.Transport;  \nmyBinding.Security.Transport.ClientCredentialType =  \n   HttpClientCredentialType.Certificate;  \n  \n// Create the endpoint address. Note that the machine name   \n// must match the subject or DNS field of the X.509 certificate  \n// used to authenticate the service.   \nEndpointAddress ea = new  \n   EndpointAddress(\"https://localhost/CalculatorService/service.svc\");  \n  \n// Create the client. The code for the calculator   \n// client is not shown here. See the sample applications  \n// for examples of the calculator code.  \nCalculatorClient cc =  \n   new CalculatorClient(myBinding, ea);  \n  \n// The client must specify a certificate trusted by the server.  \ncc.ClientCredentials.ClientCertificate.SetCertificate(  \n    StoreLocation.CurrentUser,  \n    StoreName.My,  \n    X509FindType.FindBySubjectName,  \n    \"contoso.com\");  \n  \n// Begin using the client.  \nConsole.WriteLine(cc.Add(100, 1111));  \n//...  \ncc.Close();  \n  \n```  \n  \n Alternatively you can configure the client in an App.config file as shown in the following example:  \n  \n```xml  \n<configuration>  \n  <system.serviceModel>  \n    <client>  \n      <!-- this endpoint has an https: address -->  \n      <endpoint address=\" https://localhost/CalculatorService/service.svc \"   \n                behaviorConfiguration=\"endpointCredentialBehavior\"  \n                binding=\"wsHttpBinding\"   \n                bindingConfiguration=\"Binding1\"   \n                contract=\"Microsoft.Samples.TransportSecurity.ICalculator\"/>  \n    </client>  \n    <behaviors>  \n      <endpointBehaviors>  \n        <behavior name=\"endpointCredentialBehavior\">  \n          <clientCredentials>  \n            <clientCertificate findValue=\"contoso.com\"  \n                               storeLocation=\"CurrentUser\"  \n                               storeName=\"My\"  \n                               x509FindType=\"FindBySubjectName\" />  \n          </clientCredentials>  \n        </behavior>  \n      </endpointBehaviors>  \n    </behaviors>  \n    <bindings>  \n      <wsHttpBinding>  \n        <!-- configure wsHttpbinding with Transport security mode  \n                   and clientCredentialType as Certificate -->  \n        <binding name=\"Binding1\">  \n          <security mode=\"Transport\">  \n            <transport clientCredentialType=\"Certificate\"/>  \n          </security>  \n        </binding>  \n      </wsHttpBinding>  \n    </bindings>  \n  </system.serviceModel>  \n  \n<startup><supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.0\"/></startup></configuration>  \n  \n```  \n  \n## See Also  \n [Security Overview](../../../../docs/framework/wcf/feature-details/security-overview.md)   \n [Security Model for Windows Server App Fabric](http://go.microsoft.com/fwlink/?LinkID=201279&clcid=0x409)","nodes":[{"pos":[12,79],"content":"Transport Security with Certificate Authentication | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Transport Security with Certificate Authentication | Microsoft Docs","pos":[0,67]}]},{"pos":[389,439],"content":"Transport Security with Certificate Authentication","linkify":"Transport Security with Certificate Authentication","nodes":[{"content":"Transport Security with Certificate Authentication","pos":[0,50]}]},{"content":"This topic discusses using X.509 certificates for server and client authentication when using transport security.","pos":[440,553]},{"content":"For more information about X.509 certificates see <bpt id=\"p1\">[</bpt>X.509 Public Key Certificates<ept id=\"p1\">](http://msdn.microsoft.com/library/bb540819\\(VS.85\\).aspx)</ept>.","pos":[554,694],"source":" For more information about X.509 certificates see [X.509 Public Key Certificates](http://msdn.microsoft.com/library/bb540819\\(VS.85\\).aspx)."},{"content":"Certificates must be issued by a certification authority, which is often a third-party issuer of certificates.","pos":[695,805]},{"content":"On a Windows Server domain, Active Directory Certificate Services can be used to issue certificates to client computers on the domain.","pos":[806,940]},{"content":"For more information see <bpt id=\"p1\">[</bpt>Windows 2008 R2 Certificate Services<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=209949&amp;clcid=0x409)</ept>.","pos":[941,1064],"source":" For more information see [Windows 2008 R2 Certificate Services](http://go.microsoft.com/fwlink/?LinkID=209949&clcid=0x409)."},{"content":"In this scenario, the service is hosted under Internet Information Services (IIS) which is configured with Secure Sockets Layer (SSL).","pos":[1065,1199]},{"content":"The service is configured with an SSL (X.509) certificate to allow clients to verify the identity of the server.","pos":[1200,1312]},{"content":"The client is also configured with an X.509 certificate that allows the service to verify the identity of the client.","pos":[1313,1430]},{"content":"The server’s certificate must be trusted by the client and the client’s certificate must be trusted by the server.","pos":[1431,1545]},{"content":"The actual mechanics of how the service and client verifies each other’s identity is beyond the scope of this topic.","pos":[1546,1662]},{"content":"For more information see <bpt id=\"p1\">[</bpt>Digital Signature on Wikipedia<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=253157)</ept>.","pos":[1663,1768],"source":" For more information see [Digital Signature on Wikipedia](http://go.microsoft.com/fwlink/?LinkId=253157)."},{"content":"This scenario implements a request/reply message pattern as illustrated by the following diagram.","pos":[1775,1872]},{"pos":[1879,2050],"content":"<bpt id=\"p1\">![</bpt>Secure transfer using certificates<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wcf/feature-details/media/8f7b8968-899f-4538-a9e8-0eaa872a291c.gif \"</bpt>8f7b8968-899f-4538-a9e8-0eaa872a291c<ept id=\"p2\">\")</ept>","source":"![Secure transfer using certificates](../../../../docs/framework/wcf/feature-details/media/8f7b8968-899f-4538-a9e8-0eaa872a291c.gif \"8f7b8968-899f-4538-a9e8-0eaa872a291c\")"},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> using a certificate with a service, see <bpt id=\"p1\">[</bpt>Working with Certificates<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/working-with-certificates.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Configure a Port with an SSL Certificate<ept id=\"p2\">](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md)</ept>.","pos":[2057,2412],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] using a certificate with a service, see [Working with Certificates](../../../../docs/framework/wcf/feature-details/working-with-certificates.md) and [How to: Configure a Port with an SSL Certificate](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md)."},{"content":"The following table describes the various characteristics of the scenario.","pos":[2413,2487]},{"content":"Characteristic","pos":[2494,2508]},{"content":"Description","pos":[2509,2520]},{"content":"Security Mode","pos":[2568,2581]},{"content":"Transport","pos":[2582,2591]},{"content":"Interoperability","pos":[2596,2612]},{"content":"With existing Web service clients and services.","pos":[2613,2660]},{"content":"Authentication (Server)","pos":[2665,2688]},{"content":"Authentication (Client)","pos":[2701,2724]},{"content":"Yes (using an SSL certificate)","pos":[2725,2755]},{"content":"Yes (using an X.509 certificate)","pos":[2768,2800]},{"content":"Data Integrity","pos":[2805,2819]},{"content":"Yes","pos":[2820,2823]},{"content":"Data Confidentiality","pos":[2828,2848]},{"content":"Yes","pos":[2849,2852]},{"content":"Transport","pos":[2857,2866]},{"content":"HTTPS","pos":[2867,2872]},{"content":"Binding","pos":[2877,2884]},{"pos":[2935,2956],"content":"Configure the Service","linkify":"Configure the Service","nodes":[{"content":"Configure the Service","pos":[0,21]}]},{"content":"Since the service in this scenario is hosted under IIS, it is configured with a web.config file.","pos":[2960,3056]},{"content":"The following web.config shows how to configure the <ph id=\"ph1\">&lt;xref:System.ServiceModel.WSHttpBinding&gt;</ph> to use transport security and X.509 client credentials.","pos":[3057,3205],"source":" The following web.config shows how to configure the <xref:System.ServiceModel.WSHttpBinding> to use transport security and X.509 client credentials."},{"pos":[4111,4131],"content":"Configure the Client","linkify":"Configure the Client","nodes":[{"content":"Configure the Client","pos":[0,20]}]},{"content":"The client can be configured in code or in an app.config file.","pos":[4135,4197]},{"content":"The following example shows how to configure the client in code.","pos":[4198,4262]},{"content":"Alternatively you can configure the client in an App.config file as shown in the following example:","pos":[5339,5438]},{"pos":[6923,6931],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Security Overview<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/security-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[6935,7024],"source":"[Security Overview](../../../../docs/framework/wcf/feature-details/security-overview.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Security Model for Windows Server App Fabric<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=201279&amp;clcid=0x409)</ept>","pos":[7027,7133],"source":" [Security Model for Windows Server App Fabric](http://go.microsoft.com/fwlink/?LinkID=201279&clcid=0x409)"}]}