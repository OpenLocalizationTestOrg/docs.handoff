{"content":"---\ntitle: \"Extend Glass Frame Into a WPF Application\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"applications [WPF], extending glass frames into\"\n  - \"graphics [WPF], extending glass frames into applications\"\n  - \"extending glass frames into applications [WPF]\"\n  - \"glass frames [WPF], extending into applications\"\nms.assetid: 74388a3a-4b69-4a9d-ba1f-e107636bd660\n---\n\n# Extend Glass Frame Into a WPF Application\n\nThis topic demonstrates how to extend the [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)] glass frame into the client area of a Windows Presentation Foundation (WPF) application.\n\n> [!NOTE]\n> This example will only work on a [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] machine running the Desktop Window Manager (DWM) with glass enabled. [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] Home Basic edition does not support the transparent glass effect. Areas that would typically render with the transparent glass effect on other editions of [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] are rendered opaque.\n\n## Example\n\nThe following image illustrates the glass frame extended into the address bar of Internet Explorer 7:\n\n![Screenshot showing glass frame extended behind IE7 address bar.](./media/extend-glass-frame-into-a-wpf-application/internet-explorer-glass-frame-extended-address-bar.png)\n\nTo extend the glass frame on a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application, access to unmanaged [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] is needed. The following code example does a Platform Invoke (pinvoke) for the two [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] needed to extend the frame into the client area. Each of these [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] are declared in a class called **NonClientRegionAPI**.\n\n```csharp\n[StructLayout(LayoutKind.Sequential)]\npublic struct MARGINS\n{\n    public int cxLeftWidth;      // width of left border that retains its size\n    public int cxRightWidth;     // width of right border that retains its size\n    public int cyTopHeight;      // height of top border that retains its size\n    public int cyBottomHeight;   // height of bottom border that retains its size\n};\n\n[DllImport(\"DwmApi.dll\")]\npublic static extern int DwmExtendFrameIntoClientArea(\n    IntPtr hwnd,\n    ref MARGINS pMarInset);\n```\n\n```vb\n<StructLayout(LayoutKind.Sequential)>\nPublic Structure MARGINS\n    Public cxLeftWidth As Integer ' width of left border that retains its size\n    Public cxRightWidth As Integer ' width of right border that retains its size\n    Public cyTopHeight As Integer ' height of top border that retains its size\n    Public cyBottomHeight As Integer ' height of bottom border that retains its size\nEnd Structure\n\n<DllImport(\"DwmApi.dll\")>\nPublic Shared Function DwmExtendFrameIntoClientArea(ByVal hwnd As IntPtr, ByRef pMarInset As MARGINS) As Integer\nEnd Function\n```\n\n[DwmExtendFrameIntoClientArea](/windows/desktop/api/dwmapi/nf-dwmapi-dwmextendframeintoclientarea) is the DWM function that extends the frame into the client area. It takes two parameters; a window handle and a [MARGINS](/windows/desktop/api/uxtheme/ns-uxtheme-_margins) structure. [MARGINS](/windows/desktop/api/uxtheme/ns-uxtheme-_margins) is used to tell the DWM how much extra the frame should be extended into the client area.\n\n## Example\n\nTo use the [DwmExtendFrameIntoClientArea](/windows/desktop/api/dwmapi/nf-dwmapi-dwmextendframeintoclientarea) function, a window handle must be obtained. In [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], the window handle can be obtained from the <xref:System.Windows.Interop.HwndSource.Handle%2A> property of an <xref:System.Windows.Interop.HwndSource>. In the following example, the frame is extended into the client area on the <xref:System.Windows.FrameworkElement.Loaded> event of the window.\n\n```csharp\nvoid OnLoaded(object sender, RoutedEventArgs e)\n{\n   try\n   {\n      // Obtain the window handle for WPF application\n      IntPtr mainWindowPtr = new WindowInteropHelper(this).Handle;\n      HwndSource mainWindowSrc = HwndSource.FromHwnd(mainWindowPtr);\n      mainWindowSrc.CompositionTarget.BackgroundColor = Color.FromArgb(0, 0, 0, 0);\n\n      // Get System Dpi\n      System.Drawing.Graphics desktop = System.Drawing.Graphics.FromHwnd(mainWindowPtr);\n      float DesktopDpiX = desktop.DpiX;\n      float DesktopDpiY = desktop.DpiY;\n\n      // Set Margins\n      NonClientRegionAPI.MARGINS margins = new NonClientRegionAPI.MARGINS();\n\n      // Extend glass frame into client area\n      // Note that the default desktop Dpi is 96dpi. The  margins are\n      // adjusted for the system Dpi.\n      margins.cxLeftWidth = Convert.ToInt32(5 * (DesktopDpiX / 96));\n      margins.cxRightWidth = Convert.ToInt32(5 * (DesktopDpiX / 96));\n      margins.cyTopHeight = Convert.ToInt32(((int)topBar.ActualHeight + 5) * (DesktopDpiX / 96));\n      margins.cyBottomHeight = Convert.ToInt32(5 * (DesktopDpiX / 96));\n\n      int hr = NonClientRegionAPI.DwmExtendFrameIntoClientArea(mainWindowSrc.Handle, ref margins);\n      //\n      if (hr < 0)\n      {\n         //DwmExtendFrameIntoClientArea Failed\n      }\n   }\n   // If not Vista, paint background white.\n   catch (DllNotFoundException)\n   {\n      Application.Current.MainWindow.Background = Brushes.White;\n   }\n}\n```\n\n## Example\n\nThe following example shows a simple window in which the frame is extended into the client area. The frame is extended behind the top border that contains the two <xref:System.Windows.Controls.TextBox> objects.\n\n```xaml\n<Window x:Class=\"SDKSample.Window1\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"Extended Glass in WPF\" Height=\"300\" Width=\"400\"\n    Loaded=\"OnLoaded\" Background=\"Transparent\"\n    >\n  <Grid ShowGridLines=\"True\">\n    <DockPanel Name=\"mainDock\">\n      <!-- The border is used to compute the rendered height with margins.\n           topBar contents will be displayed on the extended glass frame.-->\n      <Border Name=\"topBar\" DockPanel.Dock=\"Top\" >\n        <Grid Name=\"grid\">\n          <Grid.ColumnDefinitions>\n            <ColumnDefinition MinWidth=\"100\" Width=\"*\"/>\n            <ColumnDefinition Width=\"Auto\"/>\n          </Grid.ColumnDefinitions>\n          <TextBox Grid.Column=\"0\" MinWidth=\"100\" Margin=\"0,0,10,5\">Path</TextBox>\n          <TextBox Grid.Column=\"1\" MinWidth=\"75\" Margin=\"0,0,0,5\">Search</TextBox>\n        </Grid>\n      </Border>\n      <Grid DockPanel.Dock=\"Top\" >\n        <Grid.ColumnDefinitions>\n          <ColumnDefinition/>\n        </Grid.ColumnDefinitions>\n        <TextBox Grid.Column=\"0\" AcceptsReturn=\"True\"/>\n      </Grid>\n    </DockPanel>\n  </Grid>\n</Window>\n```\n\nThe following image illustrates the glass frame extended into a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application:\n\n![Screenshot showing a glass frame extended into a WPF application.](./media/extend-glass-frame-into-a-wpf-application/glass-frame-extended-wpf-application.png)\n\n## See also\n\n- [Desktop Window Manager Overview](/windows/desktop/dwm/dwm-overview)\n- [Desktop Window Manager Blur Overview](/windows/desktop/dwm/blur-ovw)\n- [DwmExtendFrameIntoClientArea](/windows/desktop/api/dwmapi/nf-dwmapi-dwmextendframeintoclientarea)\n","nodes":[{"pos":[4,403],"embed":true,"restype":"x-metadata","content":"title: \"Extend Glass Frame Into a WPF Application\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"applications [WPF], extending glass frames into\"\n  - \"graphics [WPF], extending glass frames into applications\"\n  - \"extending glass frames into applications [WPF]\"\n  - \"glass frames [WPF], extending into applications\"\nms.assetid: 74388a3a-4b69-4a9d-ba1f-e107636bd660","nodes":[{"content":"Extend Glass Frame Into a WPF Application","nodes":[{"pos":[0,41],"content":"Extend Glass Frame Into a WPF Application","nodes":[{"content":"Extend Glass Frame Into a WPF Application","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[411,452],"content":"Extend Glass Frame Into a WPF Application","linkify":"Extend Glass Frame Into a WPF Application","nodes":[{"content":"Extend Glass Frame Into a WPF Application","pos":[0,41]}]},{"pos":[454,662],"content":"This topic demonstrates how to extend the <ph id=\"ph1\">[!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)]</ph> glass frame into the client area of a Windows Presentation Foundation (WPF) application.","source":"This topic demonstrates how to extend the [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)] glass frame into the client area of a Windows Presentation Foundation (WPF) application."},{"pos":[666,1193],"content":"[!NOTE]\nThis example will only work on a [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] machine running the Desktop Window Manager (DWM) with glass enabled. [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] Home Basic edition does not support the transparent glass effect. Areas that would typically render with the transparent glass effect on other editions of [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] are rendered opaque.","leadings":["","> "],"nodes":[{"content":"This example will only work on a [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] machine running the Desktop Window Manager (DWM) with glass enabled. [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] Home Basic edition does not support the transparent glass effect. Areas that would typically render with the transparent glass effect on other editions of [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] are rendered opaque.","pos":[8,525],"nodes":[{"content":"This example will only work on a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)]</ph> machine running the Desktop Window Manager (DWM) with glass enabled.","pos":[0,181],"source":"This example will only work on a [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] machine running the Desktop Window Manager (DWM) with glass enabled."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)]</ph> Home Basic edition does not support the transparent glass effect.","pos":[182,327],"source":"[!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] Home Basic edition does not support the transparent glass effect."},{"content":"Areas that would typically render with the transparent glass effect on other editions of <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)]</ph> are rendered opaque.","pos":[328,517],"source":" Areas that would typically render with the transparent glass effect on other editions of [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] are rendered opaque."}]}]},{"pos":[1198,1205],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following image illustrates the glass frame extended into the address bar of Internet Explorer 7:","pos":[1207,1308]},{"content":"Screenshot showing glass frame extended behind IE7 address bar.","pos":[1312,1375]},{"content":"To extend the glass frame on a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> application, access to unmanaged <ph id=\"ph2\">[!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)]</ph> is needed.","pos":[1484,1696],"source":"To extend the glass frame on a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application, access to unmanaged [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] is needed."},{"content":"The following code example does a Platform Invoke (pinvoke) for the two <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> needed to extend the frame into the client area.","pos":[1697,1887],"source":" The following code example does a Platform Invoke (pinvoke) for the two [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] needed to extend the frame into the client area."},{"content":"Each of these <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> are declared in a class called <bpt id=\"p1\">**</bpt>NonClientRegionAPI<ept id=\"p1\">**</ept>.","pos":[1888,2026],"source":" Each of these [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] are declared in a class called **NonClientRegionAPI**."},{"content":"<bpt id=\"p1\">[</bpt>DwmExtendFrameIntoClientArea<ept id=\"p1\">](/windows/desktop/api/dwmapi/nf-dwmapi-dwmextendframeintoclientarea)</ept> is the DWM function that extends the frame into the client area.","pos":[3120,3283],"source":"[DwmExtendFrameIntoClientArea](/windows/desktop/api/dwmapi/nf-dwmapi-dwmextendframeintoclientarea) is the DWM function that extends the frame into the client area."},{"content":"It takes two parameters; a window handle and a <bpt id=\"p1\">[</bpt>MARGINS<ept id=\"p1\">](/windows/desktop/api/uxtheme/ns-uxtheme-_margins)</ept> structure.","pos":[3284,3401],"source":" It takes two parameters; a window handle and a [MARGINS](/windows/desktop/api/uxtheme/ns-uxtheme-_margins) structure."},{"content":"<bpt id=\"p1\">[</bpt>MARGINS<ept id=\"p1\">](/windows/desktop/api/uxtheme/ns-uxtheme-_margins)</ept> is used to tell the DWM how much extra the frame should be extended into the client area.","pos":[3402,3551],"source":"[MARGINS](/windows/desktop/api/uxtheme/ns-uxtheme-_margins) is used to tell the DWM how much extra the frame should be extended into the client area."},{"pos":[3556,3563],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"To use the <bpt id=\"p1\">[</bpt>DwmExtendFrameIntoClientArea<ept id=\"p1\">](/windows/desktop/api/dwmapi/nf-dwmapi-dwmextendframeintoclientarea)</ept> function, a window handle must be obtained.","pos":[3565,3718],"source":"To use the [DwmExtendFrameIntoClientArea](/windows/desktop/api/dwmapi/nf-dwmapi-dwmextendframeintoclientarea) function, a window handle must be obtained."},{"content":"In <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph>, the window handle can be obtained from the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSource.Handle%2A&gt;</ph> property of an <ph id=\"ph3\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph>.","pos":[3719,3943],"source":" In [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], the window handle can be obtained from the <xref:System.Windows.Interop.HwndSource.Handle%2A> property of an <xref:System.Windows.Interop.HwndSource>."},{"content":"In the following example, the frame is extended into the client area on the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event of the window.","pos":[3944,4086],"source":" In the following example, the frame is extended into the client area on the <xref:System.Windows.FrameworkElement.Loaded> event of the window."},{"pos":[5546,5553],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows a simple window in which the frame is extended into the client area.","pos":[5555,5651]},{"content":"The frame is extended behind the top border that contains the two <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> objects.","pos":[5652,5765],"source":" The frame is extended behind the top border that contains the two <xref:System.Windows.Controls.TextBox> objects."},{"pos":[6959,7105],"content":"The following image illustrates the glass frame extended into a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> application:","source":"The following image illustrates the glass frame extended into a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application:"},{"content":"Screenshot showing a glass frame extended into a WPF application.","pos":[7109,7174]},{"pos":[7272,7280],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7284,7352],"content":"<bpt id=\"p1\">[</bpt>Desktop Window Manager Overview<ept id=\"p1\">](/windows/desktop/dwm/dwm-overview)</ept>","source":"[Desktop Window Manager Overview](/windows/desktop/dwm/dwm-overview)"},{"pos":[7355,7424],"content":"<bpt id=\"p1\">[</bpt>Desktop Window Manager Blur Overview<ept id=\"p1\">](/windows/desktop/dwm/blur-ovw)</ept>","source":"[Desktop Window Manager Blur Overview](/windows/desktop/dwm/blur-ovw)"},{"pos":[7427,7525],"content":"<bpt id=\"p1\">[</bpt>DwmExtendFrameIntoClientArea<ept id=\"p1\">](/windows/desktop/api/dwmapi/nf-dwmapi-dwmextendframeintoclientarea)</ept>","source":"[DwmExtendFrameIntoClientArea](/windows/desktop/api/dwmapi/nf-dwmapi-dwmextendframeintoclientarea)"}]}