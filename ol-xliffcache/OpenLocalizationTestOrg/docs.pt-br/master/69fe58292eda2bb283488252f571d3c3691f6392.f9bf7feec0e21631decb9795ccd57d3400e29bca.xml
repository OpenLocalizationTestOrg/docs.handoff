{"content":"---\ntitle: \"How to: Print a Multi-Page Text File in Windows Forms\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"printing [Windows Forms], printing multiple pages\"\n  - \"text [Windows Forms], printing Windows Forms\"\n  - \"Windows Forms, printing text\"\n  - \"printing [Windows Forms], text\"\nms.assetid: 362427f8-03d4-4826-b49f-60ab066ad322\n---\n# How to: Print a Multi-Page Text File in Windows Forms\nIt is very common for Windows-based applications to print text. The <xref:System.Drawing.Graphics> class provides methods for drawing objects (graphics or text) to a device, such as a screen or printer.  \n  \n> [!NOTE]\n>  The <xref:System.Windows.Forms.TextRenderer.DrawText%2A> methods of <xref:System.Windows.Forms.TextRenderer> are not supported for printing. You should always use the <xref:System.Drawing.Graphics.DrawString%2A> methods of <xref:System.Drawing.Graphics>, as shown in the following code example, to draw text for printing purposes.  \n  \n### To print text  \n  \n1.  Add a <xref:System.Drawing.Printing.PrintDocument> component and a string to your form.  \n  \n     [!code-csharp[System.Drawing.Printing.PrintExamples#8](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/CS/Form1.cs#8)]\n     [!code-vb[System.Drawing.Printing.PrintExamples#8](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/VB/Form1.vb#8)]  \n  \n2.  If printing a document, set the <xref:System.Drawing.Printing.PrintDocument.DocumentName%2A> property to the document you wish to print, and open and read the documents contents to the string you added previously.  \n  \n     [!code-csharp[System.Drawing.Printing.PrintExamples#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/CS/Form1.cs#1)]\n     [!code-vb[System.Drawing.Printing.PrintExamples#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/VB/Form1.vb#1)]  \n  \n3.  In the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event handler, use the <xref:System.Drawing.Printing.PrintPageEventArgs.Graphics%2A> property of the <xref:System.Drawing.Printing.PrintPageEventArgs> class and the document contents to calculate line length and lines per page. After each page is drawn, check to see if it is the last page, and set the <xref:System.Drawing.Printing.PrintPageEventArgs.HasMorePages%2A> property of the <xref:System.Drawing.Printing.PrintPageEventArgs> accordingly. The <xref:System.Drawing.Printing.PrintDocument.PrintPage> event is raised until <xref:System.Drawing.Printing.PrintPageEventArgs.HasMorePages%2A> is `false`. Also, make sure the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event is associated with its event-handling method.  \n  \n     In the following code example, the event handler is used to print the contents of the \"testPage.txt\" file in the same font as is used on the form.  \n  \n     [!code-csharp[System.Drawing.Printing.PrintExamples#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/CS/Form1.cs#2)]\n     [!code-vb[System.Drawing.Printing.PrintExamples#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/VB/Form1.vb#2)]  \n  \n4.  Call the <xref:System.Drawing.Printing.PrintDocument.Print%2A> method to raise the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event.  \n  \n     [!code-csharp[System.Drawing.Printing.PrintExamples#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/CS/Form1.cs#5)]\n     [!code-vb[System.Drawing.Printing.PrintExamples#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/VB/Form1.vb#5)]  \n  \n## Example  \n [!code-csharp[System.Drawing.Printing.PrintExamples#0](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/CS/Form1.cs#0)]\n [!code-vb[System.Drawing.Printing.PrintExamples#0](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/VB/Form1.vb#0)]  \n  \n## Compiling the Code  \n This example requires:  \n  \n-   A text file named testPage.txt containing the text to print, located in the root of drive C:\\\\. Edit the code to print a different file.  \n  \n-   References to the System, System.Windows.Forms, System.Drawing assemblies.  \n  \n-   For information about building this example from the command line for Visual Basic or Visual C#, see [Building from the Command Line](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md). You can also build this example in Visual Studio by pasting the code into a new project.  \n  \n## See also\n\n- <xref:System.Drawing.Graphics>\n- <xref:System.Drawing.Brush>\n- [Windows Forms Print Support](windows-forms-print-support.md)\n","nodes":[{"pos":[4,372],"embed":true,"restype":"x-metadata","content":"title: \"How to: Print a Multi-Page Text File in Windows Forms\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"printing [Windows Forms], printing multiple pages\"\n  - \"text [Windows Forms], printing Windows Forms\"\n  - \"Windows Forms, printing text\"\n  - \"printing [Windows Forms], text\"\nms.assetid: 362427f8-03d4-4826-b49f-60ab066ad322","nodes":[{"content":"How to: Print a Multi-Page Text File in Windows Forms","nodes":[{"pos":[0,53],"content":"How to: Print a Multi-Page Text File in Windows Forms","nodes":[{"content":"How to: Print a Multi-Page Text File in Windows Forms","pos":[0,53]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[379,432],"content":"How to: Print a Multi-Page Text File in Windows Forms","linkify":"How to: Print a Multi-Page Text File in Windows Forms","nodes":[{"content":"How to: Print a Multi-Page Text File in Windows Forms","pos":[0,53]}]},{"content":"It is very common for Windows-based applications to print text.","pos":[433,496]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Drawing.Graphics&gt;</ph> class provides methods for drawing objects (graphics or text) to a device, such as a screen or printer.","pos":[497,635],"source":" The <xref:System.Drawing.Graphics> class provides methods for drawing objects (graphics or text) to a device, such as a screen or printer."},{"pos":[643,984],"content":"[!NOTE]\n The <xref:System.Windows.Forms.TextRenderer.DrawText%2A> methods of <xref:System.Windows.Forms.TextRenderer> are not supported for printing. You should always use the <xref:System.Drawing.Graphics.DrawString%2A> methods of <xref:System.Drawing.Graphics>, as shown in the following code example, to draw text for printing purposes.","leadings":["","> "],"nodes":[{"content":"The <xref:System.Windows.Forms.TextRenderer.DrawText%2A> methods of <xref:System.Windows.Forms.TextRenderer> are not supported for printing. You should always use the <xref:System.Drawing.Graphics.DrawString%2A> methods of <xref:System.Drawing.Graphics>, as shown in the following code example, to draw text for printing purposes.","pos":[9,339],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.TextRenderer.DrawText%2A&gt;</ph> methods of <ph id=\"ph2\">&lt;xref:System.Windows.Forms.TextRenderer&gt;</ph> are not supported for printing.","pos":[0,140],"source":"The <xref:System.Windows.Forms.TextRenderer.DrawText%2A> methods of <xref:System.Windows.Forms.TextRenderer> are not supported for printing."},{"content":"You should always use the <ph id=\"ph1\">&lt;xref:System.Drawing.Graphics.DrawString%2A&gt;</ph> methods of <ph id=\"ph2\">&lt;xref:System.Drawing.Graphics&gt;</ph>, as shown in the following code example, to draw text for printing purposes.","pos":[141,330],"source":" You should always use the <xref:System.Drawing.Graphics.DrawString%2A> methods of <xref:System.Drawing.Graphics>, as shown in the following code example, to draw text for printing purposes."}]}]},{"pos":[994,1007],"content":"To print text","linkify":"To print text","nodes":[{"content":"To print text","pos":[0,13]}]},{"pos":[1017,1104],"content":"Add a <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintDocument&gt;</ph> component and a string to your form.","source":"Add a <xref:System.Drawing.Printing.PrintDocument> component and a string to your form."},{"pos":[1115,1432],"content":"[!code-csharp[System.Drawing.Printing.PrintExamples#8](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/CS/Form1.cs#8)]\n [!code-vb[System.Drawing.Printing.PrintExamples#8](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/VB/Form1.vb#8)]","leadings":["","    "],"nodes":[]},{"pos":[1442,1655],"content":"If printing a document, set the <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintDocument.DocumentName%2A&gt;</ph> property to the document you wish to print, and open and read the documents contents to the string you added previously.","source":"If printing a document, set the <xref:System.Drawing.Printing.PrintDocument.DocumentName%2A> property to the document you wish to print, and open and read the documents contents to the string you added previously."},{"pos":[1666,1983],"content":"[!code-csharp[System.Drawing.Printing.PrintExamples#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/CS/Form1.cs#1)]\n [!code-vb[System.Drawing.Printing.PrintExamples#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/VB/Form1.vb#1)]","leadings":["","    "],"nodes":[]},{"content":"In the <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintDocument.PrintPage&gt;</ph> event handler, use the <ph id=\"ph2\">&lt;xref:System.Drawing.Printing.PrintPageEventArgs.Graphics%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.Drawing.Printing.PrintPageEventArgs&gt;</ph> class and the document contents to calculate line length and lines per page.","pos":[1993,2282],"source":"In the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event handler, use the <xref:System.Drawing.Printing.PrintPageEventArgs.Graphics%2A> property of the <xref:System.Drawing.Printing.PrintPageEventArgs> class and the document contents to calculate line length and lines per page."},{"content":"After each page is drawn, check to see if it is the last page, and set the <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintPageEventArgs.HasMorePages%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Drawing.Printing.PrintPageEventArgs&gt;</ph> accordingly.","pos":[2283,2502],"source":" After each page is drawn, check to see if it is the last page, and set the <xref:System.Drawing.Printing.PrintPageEventArgs.HasMorePages%2A> property of the <xref:System.Drawing.Printing.PrintPageEventArgs> accordingly."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintDocument.PrintPage&gt;</ph> event is raised until <ph id=\"ph2\">&lt;xref:System.Drawing.Printing.PrintPageEventArgs.HasMorePages%2A&gt;</ph> is <ph id=\"ph3\">`false`</ph>.","pos":[2503,2661],"source":" The <xref:System.Drawing.Printing.PrintDocument.PrintPage> event is raised until <xref:System.Drawing.Printing.PrintPageEventArgs.HasMorePages%2A> is `false`."},{"content":"Also, make sure the <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintDocument.PrintPage&gt;</ph> event is associated with its event-handling method.","pos":[2662,2788],"source":" Also, make sure the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event is associated with its event-handling method."},{"content":"In the following code example, the event handler is used to print the contents of the \"testPage.txt\" file in the same font as is used on the form.","pos":[2799,2945]},{"pos":[2956,3273],"content":"[!code-csharp[System.Drawing.Printing.PrintExamples#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/CS/Form1.cs#2)]\n [!code-vb[System.Drawing.Printing.PrintExamples#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/VB/Form1.vb#2)]","leadings":["","    "],"nodes":[]},{"pos":[3283,3427],"content":"Call the <ph id=\"ph1\">&lt;xref:System.Drawing.Printing.PrintDocument.Print%2A&gt;</ph> method to raise the <ph id=\"ph2\">&lt;xref:System.Drawing.Printing.PrintDocument.PrintPage&gt;</ph> event.","source":"Call the <xref:System.Drawing.Printing.PrintDocument.Print%2A> method to raise the <xref:System.Drawing.Printing.PrintDocument.PrintPage> event."},{"pos":[3438,3755],"content":"[!code-csharp[System.Drawing.Printing.PrintExamples#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/CS/Form1.cs#5)]\n [!code-vb[System.Drawing.Printing.PrintExamples#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.Printing.PrintExamples/VB/Form1.vb#5)]","leadings":["","    "],"nodes":[]},{"pos":[3764,3771],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4097,4115],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"This example requires:","pos":[4119,4141]},{"content":"A text file named testPage.txt containing the text to print, located in the root of drive C:<ph id=\"ph1\">\\\\</ph>.","pos":[4151,4246],"source":"A text file named testPage.txt containing the text to print, located in the root of drive C:\\\\."},{"content":"Edit the code to print a different file.","pos":[4247,4287]},{"content":"References to the System, System.Windows.Forms, System.Drawing assemblies.","pos":[4297,4371]},{"content":"For information about building this example from the command line for Visual Basic or Visual C#, see <bpt id=\"p1\">[</bpt>Building from the Command Line<ept id=\"p1\">](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md)</ept> or <bpt id=\"p2\">[</bpt>Command-line Building With csc.exe<ept id=\"p2\">](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)</ept>.","pos":[4381,4735],"source":"For information about building this example from the command line for Visual Basic or Visual C#, see [Building from the Command Line](../../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) or [Command-line Building With csc.exe](../../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)."},{"content":"You can also build this example in Visual Studio by pasting the code into a new project.","pos":[4736,4824]},{"pos":[4833,4841],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4908,4969],"content":"<bpt id=\"p1\">[</bpt>Windows Forms Print Support<ept id=\"p1\">](windows-forms-print-support.md)</ept>","source":"[Windows Forms Print Support](windows-forms-print-support.md)"}]}