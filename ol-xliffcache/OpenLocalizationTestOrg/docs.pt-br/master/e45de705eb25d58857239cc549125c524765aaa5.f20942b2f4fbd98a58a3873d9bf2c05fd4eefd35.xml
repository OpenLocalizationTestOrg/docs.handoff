{"content":"---\ntitle: \"How to: Copy a Directory to Another Directory in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"I/O [Visual Basic], copying directories\"\n  - \"I/O [Visual Basic], copying folders\"\n  - \"folders [Visual Basic], copying\"\n  - \"directories [Visual Basic], copying\"\nms.assetid: 2a370bd7-10ba-4219-afc4-4519d031eb6c\n---\n# How to: Copy a Directory to Another Directory in Visual Basic\nUse the <xref:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory%2A> method to copy a directory to another directory. This method copies the contents of the directory as well as the directory itself. If the target directory does not exist, it will be created. If a directory with the same name exists in the target location and `overwrite` is set to `False`, the contents of the two directories will be merged. You can specify a new name for the directory during the operation.  \n  \n When copying files within a directory, exceptions may be thrown that are caused by specific file, such as a file existing during a merge while `overwrite` is set to `False`. When such exceptions are thrown, they are consolidated into a single exception, whose `Data` property holds entries in which the file or directory path is the key and the specific exception message is contained in the corresponding value.  \n  \n### To copy a directory to another directory  \n  \n-   Use the `CopyDirectory` method, specifying source and destination directory names. The following example copies the directory named `TestDirectory1` into `TestDirectory2`, overwriting existing files.  \n  \n     [!code-vb[VbVbcnMyFileSystem#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#16)]  \n  \n     This code example is also available as an IntelliSense code snippet. In the code snippet picker, it is located in **File system - Processing Drives, Folders, and Files**. For more information, see [Code Snippets](/visualstudio/ide/code-snippets).  \n  \n## Robust Programming  \n The following conditions may cause an exception:  \n  \n-   The new name specified for the directory contains a colon (:) or slash (\\ or /) (<xref:System.ArgumentException>).  \n  \n-   The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with \\\\\\\\.\\\\) (<xref:System.ArgumentException>).  \n  \n-   The path is not valid because it is `Nothing` (<xref:System.ArgumentNullException>).  \n  \n-   `destinationDirectoryName` is `Nothing` or an empty string (<xref:System.ArgumentNullException>)  \n  \n-   The source directory does not exist (<xref:System.IO.DirectoryNotFoundException>).  \n  \n-   The source directory is a root directory (<xref:System.IO.IOException>).  \n  \n-   The combined path points to an existing file (<xref:System.IO.IOException>).  \n  \n-   The source path and target path are the same (<xref:System.IO.IOException>).  \n  \n-   `ShowUI` is set to `UIOption.AllDialogs` and the user cancels the operation, or one or more files in the directory cannot be copied (<xref:System.OperationCanceledException>).  \n  \n-   The operation is cyclic (<xref:System.InvalidOperationException>).  \n  \n-   The path contains a colon (:) (<xref:System.NotSupportedException>).  \n  \n-   The path exceeds the system-defined maximum length (<xref:System.IO.PathTooLongException>).  \n  \n-   A file or folder name in the path contains a colon (:) or is in an invalid format (<xref:System.NotSupportedException>).  \n  \n-   The user lacks necessary permissions to view the path (<xref:System.Security.SecurityException>).  \n  \n-   A destination file exists but cannot be accessed (<xref:System.UnauthorizedAccessException>).  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory%2A>\n- [How to: Find Subdirectories with a Specific Pattern](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-find-subdirectories-with-a-specific-pattern.md)\n- [How to: Get the Collection of Files in a Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md)\n","nodes":[{"pos":[4,333],"embed":true,"restype":"x-metadata","content":"title: \"How to: Copy a Directory to Another Directory in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"I/O [Visual Basic], copying directories\"\n  - \"I/O [Visual Basic], copying folders\"\n  - \"folders [Visual Basic], copying\"\n  - \"directories [Visual Basic], copying\"\nms.assetid: 2a370bd7-10ba-4219-afc4-4519d031eb6c","nodes":[{"content":"How to: Copy a Directory to Another Directory in Visual Basic","nodes":[{"pos":[0,61],"content":"How to: Copy a Directory to Another Directory in Visual Basic","nodes":[{"content":"How to: Copy a Directory to Another Directory in Visual Basic","pos":[0,61]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[340,401],"content":"How to: Copy a Directory to Another Directory in Visual Basic","linkify":"How to: Copy a Directory to Another Directory in Visual Basic","nodes":[{"content":"How to: Copy a Directory to Another Directory in Visual Basic","pos":[0,61]}]},{"content":"Use the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory%2A&gt;</ph> method to copy a directory to another directory.","pos":[402,522],"source":"Use the <xref:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory%2A> method to copy a directory to another directory."},{"content":"This method copies the contents of the directory as well as the directory itself.","pos":[523,604]},{"content":"If the target directory does not exist, it will be created.","pos":[605,664]},{"content":"If a directory with the same name exists in the target location and <ph id=\"ph1\">`overwrite`</ph> is set to <ph id=\"ph2\">`False`</ph>, the contents of the two directories will be merged.","pos":[665,815],"source":" If a directory with the same name exists in the target location and `overwrite` is set to `False`, the contents of the two directories will be merged."},{"content":"You can specify a new name for the directory during the operation.","pos":[816,882]},{"content":"When copying files within a directory, exceptions may be thrown that are caused by specific file, such as a file existing during a merge while <ph id=\"ph1\">`overwrite`</ph> is set to <ph id=\"ph2\">`False`</ph>.","pos":[889,1062],"source":"When copying files within a directory, exceptions may be thrown that are caused by specific file, such as a file existing during a merge while `overwrite` is set to `False`."},{"content":"When such exceptions are thrown, they are consolidated into a single exception, whose <ph id=\"ph1\">`Data`</ph> property holds entries in which the file or directory path is the key and the specific exception message is contained in the corresponding value.","pos":[1063,1301],"source":" When such exceptions are thrown, they are consolidated into a single exception, whose `Data` property holds entries in which the file or directory path is the key and the specific exception message is contained in the corresponding value."},{"pos":[1311,1351],"content":"To copy a directory to another directory","linkify":"To copy a directory to another directory","nodes":[{"content":"To copy a directory to another directory","pos":[0,40]}]},{"content":"Use the <ph id=\"ph1\">`CopyDirectory`</ph> method, specifying source and destination directory names.","pos":[1361,1443],"source":"Use the `CopyDirectory` method, specifying source and destination directory names."},{"content":"The following example copies the directory named <ph id=\"ph1\">`TestDirectory1`</ph> into <ph id=\"ph2\">`TestDirectory2`</ph>, overwriting existing files.","pos":[1444,1560],"source":" The following example copies the directory named `TestDirectory1` into `TestDirectory2`, overwriting existing files."},{"content":"This code example is also available as an IntelliSense code snippet.","pos":[1703,1771]},{"content":"In the code snippet picker, it is located in <bpt id=\"p1\">**</bpt>File system - Processing Drives, Folders, and Files<ept id=\"p1\">**</ept>.","pos":[1772,1873],"source":" In the code snippet picker, it is located in **File system - Processing Drives, Folders, and Files**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Snippets<ept id=\"p1\">](/visualstudio/ide/code-snippets)</ept>.","pos":[1874,1949],"source":" For more information, see [Code Snippets](/visualstudio/ide/code-snippets)."},{"pos":[1958,1976],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"The following conditions may cause an exception:","pos":[1980,2028]},{"pos":[2038,2152],"content":"The new name specified for the directory contains a colon (:) or slash (\\ or /) (<ph id=\"ph1\">&lt;xref:System.ArgumentException&gt;</ph>).","source":"The new name specified for the directory contains a colon (:) or slash (\\ or /) (<xref:System.ArgumentException>)."},{"pos":[2162,2387],"content":"The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with <ph id=\"ph1\">\\\\</ph><ph id=\"ph2\">\\\\</ph>.<ph id=\"ph3\">\\\\</ph>) (<ph id=\"ph4\">&lt;xref:System.ArgumentException&gt;</ph>).","source":"The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with \\\\\\\\.\\\\) (<xref:System.ArgumentException>)."},{"pos":[2397,2481],"content":"The path is not valid because it is <ph id=\"ph1\">`Nothing`</ph> (<ph id=\"ph2\">&lt;xref:System.ArgumentNullException&gt;</ph>).","source":"The path is not valid because it is `Nothing` (<xref:System.ArgumentNullException>)."},{"pos":[2491,2587],"content":"<ph id=\"ph1\">`destinationDirectoryName`</ph> is <ph id=\"ph2\">`Nothing`</ph> or an empty string (<ph id=\"ph3\">&lt;xref:System.ArgumentNullException&gt;</ph>)","source":"`destinationDirectoryName` is `Nothing` or an empty string (<xref:System.ArgumentNullException>)"},{"pos":[2597,2679],"content":"The source directory does not exist (<ph id=\"ph1\">&lt;xref:System.IO.DirectoryNotFoundException&gt;</ph>).","source":"The source directory does not exist (<xref:System.IO.DirectoryNotFoundException>)."},{"pos":[2689,2761],"content":"The source directory is a root directory (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"The source directory is a root directory (<xref:System.IO.IOException>)."},{"pos":[2771,2847],"content":"The combined path points to an existing file (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"The combined path points to an existing file (<xref:System.IO.IOException>)."},{"pos":[2857,2933],"content":"The source path and target path are the same (<ph id=\"ph1\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"The source path and target path are the same (<xref:System.IO.IOException>)."},{"pos":[2943,3118],"content":"<ph id=\"ph1\">`ShowUI`</ph> is set to <ph id=\"ph2\">`UIOption.AllDialogs`</ph> and the user cancels the operation, or one or more files in the directory cannot be copied (<ph id=\"ph3\">&lt;xref:System.OperationCanceledException&gt;</ph>).","source":"`ShowUI` is set to `UIOption.AllDialogs` and the user cancels the operation, or one or more files in the directory cannot be copied (<xref:System.OperationCanceledException>)."},{"pos":[3128,3194],"content":"The operation is cyclic (<ph id=\"ph1\">&lt;xref:System.InvalidOperationException&gt;</ph>).","source":"The operation is cyclic (<xref:System.InvalidOperationException>)."},{"pos":[3204,3272],"content":"The path contains a colon (:) (<ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph>).","source":"The path contains a colon (:) (<xref:System.NotSupportedException>)."},{"pos":[3282,3373],"content":"The path exceeds the system-defined maximum length (<ph id=\"ph1\">&lt;xref:System.IO.PathTooLongException&gt;</ph>).","source":"The path exceeds the system-defined maximum length (<xref:System.IO.PathTooLongException>)."},{"pos":[3383,3503],"content":"A file or folder name in the path contains a colon (:) or is in an invalid format (<ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph>).","source":"A file or folder name in the path contains a colon (:) or is in an invalid format (<xref:System.NotSupportedException>)."},{"pos":[3513,3610],"content":"The user lacks necessary permissions to view the path (<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","source":"The user lacks necessary permissions to view the path (<xref:System.Security.SecurityException>)."},{"pos":[3620,3713],"content":"A destination file exists but cannot be accessed (<ph id=\"ph1\">&lt;xref:System.UnauthorizedAccessException&gt;</ph>).","source":"A destination file exists but cannot be accessed (<xref:System.UnauthorizedAccessException>)."},{"pos":[3722,3730],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3800,3986],"content":"<bpt id=\"p1\">[</bpt>How to: Find Subdirectories with a Specific Pattern<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-find-subdirectories-with-a-specific-pattern.md)</ept>","source":"[How to: Find Subdirectories with a Specific Pattern](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-find-subdirectories-with-a-specific-pattern.md)"},{"pos":[3989,4173],"content":"<bpt id=\"p1\">[</bpt>How to: Get the Collection of Files in a Directory<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md)</ept>","source":"[How to: Get the Collection of Files in a Directory](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md)"}]}