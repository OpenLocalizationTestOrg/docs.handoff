{"content":"---\ntitle: \"How to: Set Pictures at Run Time (Windows Forms)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"pictures [Windows Forms], setting display\"\n  - \"examples [Windows Forms], PictureBox control\"\n  - \"bitmaps [Windows Forms], displaying in PictureBox control [Windows Forms]\"\n  - \"PictureBox control [Windows Forms], adding images\"\n  - \"images [Windows Forms], adding with PictureBox control [Windows Forms]\"\n  - \"PictureBox control [Windows Forms], adding pictures\"\nms.assetid: 18ca41d0-68a5-4660-985e-a6c1fbc01d76\n---\n# How to: Set Pictures at Run Time (Windows Forms)\nYou can programmatically set the image displayed by a Windows Forms <xref:System.Windows.Forms.PictureBox> control.  \n  \n### To set a picture programmatically  \n  \n-   Set the <xref:System.Windows.Forms.PictureBox.Image%2A> property using the <xref:System.Drawing.Image.FromFile%2A> method of the <xref:System.Drawing.Image> class.  \n  \n     In the example below, the path set for the location of the image is the My Documents folder. This is done, because you can assume that most computers running the Windows operating system will include this directory. This also allows users with minimal system access levels to safely run the application. The example below assumes a form with a <xref:System.Windows.Forms.PictureBox> control already added.  \n  \n    ```vb  \n    Private Sub LoadNewPict()  \n       ' You should replace the bold image   \n       ' in the sample below with an icon of your own choosing.  \n       PictureBox1.Image = Image.FromFile _  \n       (System.Environment.GetFolderPath _  \n       (System.Environment.SpecialFolder.Personal) _  \n       & \"\\Image.gif\")  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    private void LoadNewPict(){  \n       // You should replace the bold image   \n       // in the sample below with an icon of your own choosing.  \n       // Note the escape character used (@) when specifying the path.  \n       pictureBox1.Image = Image.FromFile  \n       (System.Environment.GetFolderPath  \n       (System.Environment.SpecialFolder.Personal)  \n       + @\"\\Image.gif\");  \n    }  \n    ```  \n  \n    ```cpp  \n    private:  \n       void LoadNewPict()  \n       {  \n          // You should replace the bold image   \n          // in the sample below with an icon of your own choosing.  \n          pictureBox1->Image = Image::FromFile(String::Concat(  \n             System::Environment::GetFolderPath(  \n             System::Environment::SpecialFolder::Personal),  \n             \"\\\\Image.gif\"));  \n       }  \n    ```  \n  \n### To clear a graphic  \n  \n-   First, release the memory being used by the image, and then clear the graphic. Garbage collection will free up the memory later if memory management becomes a problem.  \n  \n    ```vb  \n    If Not (PictureBox1.Image Is Nothing) Then  \n       PictureBox1.Image.Dispose()  \n       PictureBox1.Image = Nothing  \n    End If  \n    ```  \n  \n    ```csharp  \n    if (pictureBox1.Image != null)   \n    {  \n       pictureBox1.Image.Dispose();  \n       pictureBox1.Image = null;  \n    }  \n    ```  \n  \n    ```cpp  \n    if (pictureBox1->Image != nullptr)  \n    {  \n       pictureBox1->Image->Dispose();  \n       pictureBox1->Image = nullptr;  \n    }  \n    ```  \n  \n    > [!NOTE]\n    >  For more information on why you should use the <xref:System.Drawing.Image.Dispose%2A> method in this way, see [Cleaning Up Unmanaged Resources](../../../standard/garbage-collection/unmanaged.md).  \n  \n     This code will clear the image even if a graphic was loaded into the control at design time.  \n  \n## See also\n\n- <xref:System.Windows.Forms.PictureBox>\n- <xref:System.Drawing.Image.FromFile%2A?displayProperty=nameWithType>\n- [PictureBox Control Overview](picturebox-control-overview-windows-forms.md)\n- [How to: Load a Picture Using the Designer](how-to-load-a-picture-using-the-designer-windows-forms.md)\n- [How to: Modify the Size or Placement of a Picture at Run Time](how-to-modify-the-size-or-placement-of-a-picture-at-run-time-windows-forms.md)\n- [PictureBox Control](picturebox-control-windows-forms.md)\n","nodes":[{"pos":[4,568],"embed":true,"restype":"x-metadata","content":"title: \"How to: Set Pictures at Run Time (Windows Forms)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"pictures [Windows Forms], setting display\"\n  - \"examples [Windows Forms], PictureBox control\"\n  - \"bitmaps [Windows Forms], displaying in PictureBox control [Windows Forms]\"\n  - \"PictureBox control [Windows Forms], adding images\"\n  - \"images [Windows Forms], adding with PictureBox control [Windows Forms]\"\n  - \"PictureBox control [Windows Forms], adding pictures\"\nms.assetid: 18ca41d0-68a5-4660-985e-a6c1fbc01d76","nodes":[{"content":"How to: Set Pictures at Run Time (Windows Forms)","nodes":[{"pos":[0,48],"content":"How to: Set Pictures at Run Time (Windows Forms)","nodes":[{"content":"How to: Set Pictures at Run Time (Windows Forms)","pos":[0,48]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[575,623],"content":"How to: Set Pictures at Run Time (Windows Forms)","linkify":"How to: Set Pictures at Run Time (Windows Forms)","nodes":[{"content":"How to: Set Pictures at Run Time (Windows Forms)","pos":[0,48]}]},{"pos":[624,739],"content":"You can programmatically set the image displayed by a Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.PictureBox&gt;</ph> control.","source":"You can programmatically set the image displayed by a Windows Forms <xref:System.Windows.Forms.PictureBox> control."},{"pos":[749,782],"content":"To set a picture programmatically","linkify":"To set a picture programmatically","nodes":[{"content":"To set a picture programmatically","pos":[0,33]}]},{"pos":[792,955],"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.PictureBox.Image%2A&gt;</ph> property using the <ph id=\"ph2\">&lt;xref:System.Drawing.Image.FromFile%2A&gt;</ph> method of the <ph id=\"ph3\">&lt;xref:System.Drawing.Image&gt;</ph> class.","source":"Set the <xref:System.Windows.Forms.PictureBox.Image%2A> property using the <xref:System.Drawing.Image.FromFile%2A> method of the <xref:System.Drawing.Image> class."},{"content":"In the example below, the path set for the location of the image is the My Documents folder.","pos":[966,1058]},{"content":"This is done, because you can assume that most computers running the Windows operating system will include this directory.","pos":[1059,1181]},{"content":"This also allows users with minimal system access levels to safely run the application.","pos":[1182,1269]},{"content":"The example below assumes a form with a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.PictureBox&gt;</ph> control already added.","pos":[1270,1371],"source":" The example below assumes a form with a <xref:System.Windows.Forms.PictureBox> control already added."},{"pos":[2581,2599],"content":"To clear a graphic","linkify":"To clear a graphic","nodes":[{"content":"To clear a graphic","pos":[0,18]}]},{"content":"First, release the memory being used by the image, and then clear the graphic.","pos":[2609,2687]},{"content":"Garbage collection will free up the memory later if memory management becomes a problem.","pos":[2688,2776]},{"pos":[3267,3477],"content":"[!NOTE]\nFor more information on why you should use the <xref:System.Drawing.Image.Dispose%2A> method in this way, see [Cleaning Up Unmanaged Resources](../../../standard/garbage-collection/unmanaged.md).","leadings":["","    >  "],"nodes":[{"content":"For more information on why you should use the <ph id=\"ph1\">&lt;xref:System.Drawing.Image.Dispose%2A&gt;</ph> method in this way, see <bpt id=\"p1\">[</bpt>Cleaning Up Unmanaged Resources<ept id=\"p1\">](../../../standard/garbage-collection/unmanaged.md)</ept>.","pos":[8,203],"source":"For more information on why you should use the <xref:System.Drawing.Image.Dispose%2A> method in this way, see [Cleaning Up Unmanaged Resources](../../../standard/garbage-collection/unmanaged.md)."}]},{"content":"This code will clear the image even if a graphic was loaded into the control at design time.","pos":[3488,3580]},{"pos":[3589,3597],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3713,3788],"content":"<bpt id=\"p1\">[</bpt>PictureBox Control Overview<ept id=\"p1\">](picturebox-control-overview-windows-forms.md)</ept>","source":"[PictureBox Control Overview](picturebox-control-overview-windows-forms.md)"},{"pos":[3791,3893],"content":"<bpt id=\"p1\">[</bpt>How to: Load a Picture Using the Designer<ept id=\"p1\">](how-to-load-a-picture-using-the-designer-windows-forms.md)</ept>","source":"[How to: Load a Picture Using the Designer](how-to-load-a-picture-using-the-designer-windows-forms.md)"},{"pos":[3896,4038],"content":"<bpt id=\"p1\">[</bpt>How to: Modify the Size or Placement of a Picture at Run Time<ept id=\"p1\">](how-to-modify-the-size-or-placement-of-a-picture-at-run-time-windows-forms.md)</ept>","source":"[How to: Modify the Size or Placement of a Picture at Run Time](how-to-modify-the-size-or-placement-of-a-picture-at-run-time-windows-forms.md)"},{"pos":[4041,4098],"content":"<bpt id=\"p1\">[</bpt>PictureBox Control<ept id=\"p1\">](picturebox-control-windows-forms.md)</ept>","source":"[PictureBox Control](picturebox-control-windows-forms.md)"}]}