{"content":"---\ntitle: \"Using Collection Activities | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: e1977cf8-1695-4071-b946-7046fe39601e\ncaps.latest.revision: 10\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Using Collection Activities\nThis sample demonstrates how to use the collection activities (<xref:System.Activities.Statements.AddToCollection%601>, <xref:System.Activities.Statements.ClearCollection%601>, <xref:System.Activities.Statements.ExistsInCollection%601>, and <xref:System.Activities.Statements.RemoveFromCollection%601>) with a class that implements the <xref:System.Collections.ICollection> interface and how to create a custom activity that iterates over a collection to print out the contents of each element in the collection. The custom activity, which is named `PrintCollection`, prints to the console the item members of a collection named `Numbers`.  \n  \n The following table describes the four activities that provide collection manipulation for workflows.  \n  \n|Activity name|Description|  \n|-------------------|-----------------|  \n|<xref:System.Activities.Statements.AddToCollection%601>|Adds an item to a collection.|  \n|<xref:System.Activities.Statements.ClearCollection%601>|Clears all items in a collection|  \n|<xref:System.Activities.Statements.ExistsInCollection%601>|Returns `true` if specified item exists in collection.|  \n|<xref:System.Activities.Statements.RemoveFromCollection%601>|Removes an item from a collection.|  \n  \n The sample consists of two solutions, one under the CodedWorkflow directory and the other under the DesignerWorkflow directory. They demonstrate two different ways of using the activities for the same purposes.  \n  \n|Solution|Description|Main Files|  \n|-|-|-|  \n|CodedWorkflow|Sample client application that demonstrates how to invoke the collection activities programmatically.|**PrintCollection.cs**: helper activity to print out to the console every item in a collection.<br /><br /> **Program.cs**: programmatically builds a sequence activity that contains a series of collection activities, and executes it.|  \n|DesignerWorkflow|Sample client application that demonstrates how to use the collection activities declaratively in the workflow designer.|**CollectionWorkflow.xaml**: a workflow created declaratively with the designer that uses the collection activities.<br /><br /> **PrintCollection.cs**: helper activity to print out to the console every item in a collection.<br /><br /> **Program.cs**: invokes the workflow described in CollectionWorkflow.xaml.|  \n  \n In the demonstration, the item members of collection `Numbers` are printed on the console using a custom-defined activity called `PrintCollection`.  \n  \n#### To use this sample  \n  \n1.  Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the Collection.sln solution file.  \n  \n2.  To build the solution, press CTRL+SHIFT+B.  \n  \n3.  To run the solution, press CTRL+F5.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WF\\Basic\\Built-InActivities\\Collection`  \n  \n## See Also","nodes":[{"pos":[12,56],"content":"Using Collection Activities | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Using Collection Activities | Microsoft Docs","pos":[0,44]}]},{"pos":[322,349],"content":"Using Collection Activities","linkify":"Using Collection Activities","nodes":[{"content":"Using Collection Activities","pos":[0,27]}]},{"content":"This sample demonstrates how to use the collection activities (<ph id=\"ph1\">&lt;xref:System.Activities.Statements.AddToCollection%601&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Activities.Statements.ClearCollection%601&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Activities.Statements.ExistsInCollection%601&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Activities.Statements.RemoveFromCollection%601&gt;</ph>) with a class that implements the <ph id=\"ph5\">&lt;xref:System.Collections.ICollection&gt;</ph> interface and how to create a custom activity that iterates over a collection to print out the contents of each element in the collection.","pos":[350,862],"source":"This sample demonstrates how to use the collection activities (<xref:System.Activities.Statements.AddToCollection%601>, <xref:System.Activities.Statements.ClearCollection%601>, <xref:System.Activities.Statements.ExistsInCollection%601>, and <xref:System.Activities.Statements.RemoveFromCollection%601>) with a class that implements the <xref:System.Collections.ICollection> interface and how to create a custom activity that iterates over a collection to print out the contents of each element in the collection."},{"content":"The custom activity, which is named <ph id=\"ph1\">`PrintCollection`</ph>, prints to the console the item members of a collection named <ph id=\"ph2\">`Numbers`</ph>.","pos":[863,989],"source":" The custom activity, which is named `PrintCollection`, prints to the console the item members of a collection named `Numbers`."},{"content":"The following table describes the four activities that provide collection manipulation for workflows.","pos":[996,1097]},{"content":"Activity name","pos":[1104,1117]},{"content":"Description","pos":[1118,1129]},{"content":"Adds an item to a collection.","pos":[1232,1261]},{"content":"Clears all items in a collection","pos":[1322,1354]},{"pos":[1418,1472],"content":"Returns <ph id=\"ph1\">`true`</ph> if specified item exists in collection.","source":"Returns `true` if specified item exists in collection."},{"content":"Removes an item from a collection.","pos":[1538,1572]},{"content":"The sample consists of two solutions, one under the CodedWorkflow directory and the other under the DesignerWorkflow directory.","pos":[1580,1707]},{"content":"They demonstrate two different ways of using the activities for the same purposes.","pos":[1708,1790]},{"content":"Solution","pos":[1797,1805]},{"content":"Description","pos":[1806,1817]},{"content":"Main Files","pos":[1818,1828]},{"content":"CodedWorkflow","pos":[1843,1856]},{"content":"Sample client application that demonstrates how to invoke the collection activities programmatically.","pos":[1857,1958]},{"content":"<bpt id=\"p1\">**</bpt>PrintCollection.cs<ept id=\"p1\">**</ept>: helper activity to print out to the console every item in a collection.","pos":[1959,2054],"source":"**PrintCollection.cs**: helper activity to print out to the console every item in a collection."},{"content":"<bpt id=\"p1\">**</bpt>Program.cs<ept id=\"p1\">**</ept>: programmatically builds a sequence activity that contains a series of collection activities, and executes it.","pos":[2067,2192],"source":"**Program.cs**: programmatically builds a sequence activity that contains a series of collection activities, and executes it."},{"content":"DesignerWorkflow","pos":[2197,2213]},{"content":"Sample client application that demonstrates how to use the collection activities declaratively in the workflow designer.","pos":[2214,2334]},{"content":"<bpt id=\"p1\">**</bpt>CollectionWorkflow.xaml<ept id=\"p1\">**</ept>: a workflow created declaratively with the designer that uses the collection activities.","pos":[2335,2451],"source":"**CollectionWorkflow.xaml**: a workflow created declaratively with the designer that uses the collection activities."},{"content":"<bpt id=\"p1\">**</bpt>PrintCollection.cs<ept id=\"p1\">**</ept>: helper activity to print out to the console every item in a collection.","pos":[2464,2559],"source":"**PrintCollection.cs**: helper activity to print out to the console every item in a collection."},{"content":"<bpt id=\"p1\">**</bpt>Program.cs<ept id=\"p1\">**</ept>: invokes the workflow described in CollectionWorkflow.xaml.","pos":[2572,2646],"source":"**Program.cs**: invokes the workflow described in CollectionWorkflow.xaml."},{"pos":[2654,2801],"content":"In the demonstration, the item members of collection <ph id=\"ph1\">`Numbers`</ph> are printed on the console using a custom-defined activity called <ph id=\"ph2\">`PrintCollection`</ph>.","source":"In the demonstration, the item members of collection `Numbers` are printed on the console using a custom-defined activity called `PrintCollection`."},{"pos":[2812,2830],"content":"To use this sample","linkify":"To use this sample","nodes":[{"content":"To use this sample","pos":[0,18]}]},{"pos":[2840,2939],"content":"Using <ph id=\"ph1\">[!INCLUDE[vs2010](../../../../includes/vs2010-md.md)]</ph>, open the Collection.sln solution file.","source":"Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the Collection.sln solution file."},{"content":"To build the solution, press CTRL+SHIFT+B.","pos":[2949,2991]},{"content":"To run the solution, press CTRL+F5.","pos":[3001,3036]},{"pos":[3044,3176],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":" The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[13,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[1,54]},{"content":"Check for the following (default) directory before continuing.","pos":[55,117]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[3230,3556],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[3557,3607]},{"pos":[3698,3706],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]}]}