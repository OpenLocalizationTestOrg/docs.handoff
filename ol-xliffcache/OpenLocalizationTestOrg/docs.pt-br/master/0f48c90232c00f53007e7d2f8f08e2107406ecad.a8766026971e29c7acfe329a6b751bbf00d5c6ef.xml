{"content":"---\ntitle: \"Declaring and Raising Events (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"declarations [Visual Basic], events\"\n  - \"events [Visual Basic], walkthroughs\"\n  - \"declaring events [Visual Basic], walkthroughs\"\n  - \"events [Visual Basic], declaring\"\n  - \"events [Visual Basic], raising\"\n  - \"raising events [Visual Basic], walkthroughs\"\nms.assetid: 8ffb3be8-097d-4d3c-b71e-04555ebda2a2\n---\n# Walkthrough: Declaring and Raising Events (Visual Basic)\nThis walkthrough demonstrates how to declare and raise events for a class named `Widget`. After you complete the steps, you might want to read the companion topic, [Walkthrough: Handling Events](../../../../visual-basic/programming-guide/language-features/events/walkthrough-handling-events.md), which shows how to use events from `Widget` objects to provide status information in an application.  \n  \n## The Widget Class  \n Assume for the moment that you have a `Widget` class. Your `Widget` class has a method that can take a long time to execute, and you want your application to be able to put up some kind of completion indicator.  \n  \n Of course, you could make the `Widget` object show a percent-complete dialog box, but then you would be stuck with that dialog box in every project in which you used the `Widget` class. A good principle of object design is to let the application that uses an object handle the user interface—unless the whole purpose of the object is to manage a form or dialog box.  \n  \n The purpose of `Widget` is to perform other tasks, so it is better to add a `PercentDone` event and let the procedure that calls `Widget`'s methods handle that event and display status updates. The `PercentDone` event can also provide a mechanism for canceling the task.  \n  \n#### To build the code example for this topic  \n  \n1.  Open a new Visual Basic Windows Application project and create a form named `Form1`.  \n  \n2.  Add two buttons and a label to `Form1`.  \n  \n3.  Name the objects as shown in the following table.  \n  \n    |Object|Property|Setting|  \n    |------------|--------------|-------------|  \n    |`Button1`|`Text`|Start Task|  \n    |`Button2`|`Text`|Cancel|  \n    |`Label`|`(Name)`, `Text`|lblPercentDone, 0|  \n  \n4.  On the **Project** menu, choose **Add Class** to add a class named `Widget.vb` to the project.  \n  \n#### To declare an event for the Widget class  \n  \n-   Use the `Event` keyword to declare an event in the `Widget` class. Note that an event can have `ByVal` and `ByRef` arguments, as `Widget`'s `PercentDone` event demonstrates:  \n  \n     [!code-vb[VbVbcnWalkthroughDeclaringAndRaisingEvents#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnWalkthroughDeclaringAndRaisingEvents/VB/Widget.vb#1)]  \n  \n When the calling object receives a `PercentDone` event, the `Percent` argument contains the percentage of the task that is complete. The `Cancel` argument can be set to `True` to cancel the method that raised the event.  \n  \n> [!NOTE]\n>  You can declare event arguments just as you do arguments of procedures, with the following exceptions: Events cannot have `Optional` or `ParamArray` arguments, and events do not have return values.  \n  \n The `PercentDone` event is raised by the `LongTask` method of the `Widget` class. `LongTask` takes two arguments: the length of time the method pretends to be doing work, and the minimum time interval before `LongTask` pauses to raise the `PercentDone` event.  \n  \n#### To raise the PercentDone event  \n  \n1.  To simplify access to the `Timer` property used by this class, add an `Imports` statement to the top of the declarations section of your class module, above the `Class Widget` statement.  \n  \n     [!code-vb[VbVbcnWalkthroughDeclaringAndRaisingEvents#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnWalkthroughDeclaringAndRaisingEvents/VB/Widget.vb#2)]  \n  \n2.  Add the following code to the `Widget` class:  \n  \n     [!code-vb[VbVbcnWalkthroughDeclaringAndRaisingEvents#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnWalkthroughDeclaringAndRaisingEvents/VB/Widget.vb#3)]  \n  \n When your application calls the `LongTask` method, the `Widget` class raises the `PercentDone` event every `MinimumInterval` seconds. When the event returns, `LongTask` checks to see if the `Cancel` argument was set to `True`.  \n  \n A few disclaimers are necessary here. For simplicity, the `LongTask` procedure assumes you know in advance how long the task will take. This is almost never the case. Dividing tasks into chunks of even size can be difficult, and often what matters most to users is simply the amount of time that passes before they get an indication that something is happening.  \n  \n You may have spotted another flaw in this sample. The `Timer` property returns the number of seconds that have passed since midnight; therefore, the application gets stuck if it is started just before midnight. A more careful approach to measuring time would take boundary conditions such as this into consideration, or avoid them altogether, using properties such as `Now`.  \n  \n Now that the `Widget` class can raise events, you can move to the next walkthrough. [Walkthrough: Handling Events](../../../../visual-basic/programming-guide/language-features/events/walkthrough-handling-events.md) demonstrates how to use `WithEvents` to associate an event handler with the `PercentDone` event.  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.DateAndTime.Timer%2A>\n- <xref:Microsoft.VisualBasic.DateAndTime.Now%2A>\n- [Walkthrough: Handling Events](../../../../visual-basic/programming-guide/language-features/events/walkthrough-handling-events.md)\n- [Events](../../../../visual-basic/programming-guide/language-features/events/index.md)\n","nodes":[{"pos":[4,409],"embed":true,"restype":"x-metadata","content":"title: \"Declaring and Raising Events (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"declarations [Visual Basic], events\"\n  - \"events [Visual Basic], walkthroughs\"\n  - \"declaring events [Visual Basic], walkthroughs\"\n  - \"events [Visual Basic], declaring\"\n  - \"events [Visual Basic], raising\"\n  - \"raising events [Visual Basic], walkthroughs\"\nms.assetid: 8ffb3be8-097d-4d3c-b71e-04555ebda2a2","nodes":[{"content":"Declaring and Raising Events (Visual Basic)","nodes":[{"pos":[0,43],"content":"Declaring and Raising Events (Visual Basic)","nodes":[{"content":"Declaring and Raising Events (Visual Basic)","pos":[0,43]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[416,472],"content":"Walkthrough: Declaring and Raising Events (Visual Basic)","linkify":"Walkthrough: Declaring and Raising Events (Visual Basic)","nodes":[{"content":"Walkthrough: Declaring and Raising Events (Visual Basic)","pos":[0,56]}]},{"content":"This walkthrough demonstrates how to declare and raise events for a class named <ph id=\"ph1\">`Widget`</ph>.","pos":[473,562],"source":"This walkthrough demonstrates how to declare and raise events for a class named `Widget`."},{"content":"After you complete the steps, you might want to read the companion topic, <bpt id=\"p1\">[</bpt>Walkthrough: Handling Events<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/events/walkthrough-handling-events.md)</ept>, which shows how to use events from <ph id=\"ph1\">`Widget`</ph> objects to provide status information in an application.","pos":[563,869],"source":" After you complete the steps, you might want to read the companion topic, [Walkthrough: Handling Events](../../../../visual-basic/programming-guide/language-features/events/walkthrough-handling-events.md), which shows how to use events from `Widget` objects to provide status information in an application."},{"pos":[878,894],"content":"The Widget Class","linkify":"The Widget Class","nodes":[{"content":"The Widget Class","pos":[0,16]}]},{"content":"Assume for the moment that you have a <ph id=\"ph1\">`Widget`</ph> class.","pos":[898,951],"source":"Assume for the moment that you have a `Widget` class."},{"content":"Your <ph id=\"ph1\">`Widget`</ph> class has a method that can take a long time to execute, and you want your application to be able to put up some kind of completion indicator.","pos":[952,1108],"source":" Your `Widget` class has a method that can take a long time to execute, and you want your application to be able to put up some kind of completion indicator."},{"content":"Of course, you could make the <ph id=\"ph1\">`Widget`</ph> object show a percent-complete dialog box, but then you would be stuck with that dialog box in every project in which you used the <ph id=\"ph2\">`Widget`</ph> class.","pos":[1115,1300],"source":"Of course, you could make the `Widget` object show a percent-complete dialog box, but then you would be stuck with that dialog box in every project in which you used the `Widget` class."},{"content":"A good principle of object design is to let the application that uses an object handle the user interface—unless the whole purpose of the object is to manage a form or dialog box.","pos":[1301,1480]},{"content":"The purpose of <ph id=\"ph1\">`Widget`</ph> is to perform other tasks, so it is better to add a <ph id=\"ph2\">`PercentDone`</ph> event and let the procedure that calls <ph id=\"ph3\">`Widget`</ph>'s methods handle that event and display status updates.","pos":[1487,1680],"source":"The purpose of `Widget` is to perform other tasks, so it is better to add a `PercentDone` event and let the procedure that calls `Widget`'s methods handle that event and display status updates."},{"content":"The <ph id=\"ph1\">`PercentDone`</ph> event can also provide a mechanism for canceling the task.","pos":[1681,1757],"source":" The `PercentDone` event can also provide a mechanism for canceling the task."},{"pos":[1768,1808],"content":"To build the code example for this topic","linkify":"To build the code example for this topic","nodes":[{"content":"To build the code example for this topic","pos":[0,40]}]},{"pos":[1818,1902],"content":"Open a new Visual Basic Windows Application project and create a form named <ph id=\"ph1\">`Form1`</ph>.","source":"Open a new Visual Basic Windows Application project and create a form named `Form1`."},{"pos":[1912,1951],"content":"Add two buttons and a label to <ph id=\"ph1\">`Form1`</ph>.","source":"Add two buttons and a label to `Form1`."},{"content":"Name the objects as shown in the following table.","pos":[1961,2010]},{"content":"Object","pos":[2021,2027]},{"content":"Property","pos":[2028,2036]},{"content":"Setting","pos":[2037,2044]},{"content":"Start Task","pos":[2120,2130]},{"content":"Cancel","pos":[2156,2162]},{"pos":[2179,2195],"content":"<ph id=\"ph1\">`(Name)`</ph>, <ph id=\"ph2\">`Text`</ph>","source":"`(Name)`, `Text`"},{"content":"lblPercentDone, 0","pos":[2196,2213]},{"pos":[2224,2318],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Add Class<ept id=\"p2\">**</ept> to add a class named <ph id=\"ph1\">`Widget.vb`</ph> to the project.","source":"On the **Project** menu, choose **Add Class** to add a class named `Widget.vb` to the project."},{"pos":[2329,2369],"content":"To declare an event for the Widget class","linkify":"To declare an event for the Widget class","nodes":[{"content":"To declare an event for the Widget class","pos":[0,40]}]},{"content":"Use the <ph id=\"ph1\">`Event`</ph> keyword to declare an event in the <ph id=\"ph2\">`Widget`</ph> class.","pos":[2379,2445],"source":"Use the `Event` keyword to declare an event in the `Widget` class."},{"content":"Note that an event can have <ph id=\"ph1\">`ByVal`</ph> and <ph id=\"ph2\">`ByRef`</ph> arguments, as <ph id=\"ph3\">`Widget`</ph>'s <ph id=\"ph4\">`PercentDone`</ph> event demonstrates:","pos":[2446,2552],"source":" Note that an event can have `ByVal` and `ByRef` arguments, as `Widget`'s `PercentDone` event demonstrates:"},{"content":"When the calling object receives a <ph id=\"ph1\">`PercentDone`</ph> event, the <ph id=\"ph2\">`Percent`</ph> argument contains the percentage of the task that is complete.","pos":[2737,2869],"source":"When the calling object receives a `PercentDone` event, the `Percent` argument contains the percentage of the task that is complete."},{"content":"The <ph id=\"ph1\">`Cancel`</ph> argument can be set to <ph id=\"ph2\">`True`</ph> to cancel the method that raised the event.","pos":[2870,2956],"source":" The `Cancel` argument can be set to `True` to cancel the method that raised the event."},{"pos":[2964,3172],"content":"[!NOTE]\n You can declare event arguments just as you do arguments of procedures, with the following exceptions: Events cannot have `Optional` or `ParamArray` arguments, and events do not have return values.","leadings":["","> "],"nodes":[{"content":"You can declare event arguments just as you do arguments of procedures, with the following exceptions: Events cannot have <ph id=\"ph1\">`Optional`</ph> or <ph id=\"ph2\">`ParamArray`</ph> arguments, and events do not have return values.","pos":[9,206],"source":"You can declare event arguments just as you do arguments of procedures, with the following exceptions: Events cannot have `Optional` or `ParamArray` arguments, and events do not have return values."}]},{"content":"The <ph id=\"ph1\">`PercentDone`</ph> event is raised by the <ph id=\"ph2\">`LongTask`</ph> method of the <ph id=\"ph3\">`Widget`</ph> class.","pos":[3179,3260],"source":"The `PercentDone` event is raised by the `LongTask` method of the `Widget` class."},{"content":"<ph id=\"ph1\">`LongTask`</ph> takes two arguments: the length of time the method pretends to be doing work, and the minimum time interval before <ph id=\"ph2\">`LongTask`</ph> pauses to raise the <ph id=\"ph3\">`PercentDone`</ph> event.","pos":[3261,3438],"source":"`LongTask` takes two arguments: the length of time the method pretends to be doing work, and the minimum time interval before `LongTask` pauses to raise the `PercentDone` event."},{"pos":[3449,3479],"content":"To raise the PercentDone event","linkify":"To raise the PercentDone event","nodes":[{"content":"To raise the PercentDone event","pos":[0,30]}]},{"pos":[3489,3675],"content":"To simplify access to the <ph id=\"ph1\">`Timer`</ph> property used by this class, add an <ph id=\"ph2\">`Imports`</ph> statement to the top of the declarations section of your class module, above the <ph id=\"ph3\">`Class Widget`</ph> statement.","source":"To simplify access to the `Timer` property used by this class, add an `Imports` statement to the top of the declarations section of your class module, above the `Class Widget` statement."},{"pos":[3863,3908],"content":"Add the following code to the <ph id=\"ph1\">`Widget`</ph> class:","source":"Add the following code to the `Widget` class:"},{"content":"When your application calls the <ph id=\"ph1\">`LongTask`</ph> method, the <ph id=\"ph2\">`Widget`</ph> class raises the <ph id=\"ph3\">`PercentDone`</ph> event every <ph id=\"ph4\">`MinimumInterval`</ph> seconds.","pos":[4093,4226],"source":"When your application calls the `LongTask` method, the `Widget` class raises the `PercentDone` event every `MinimumInterval` seconds."},{"content":"When the event returns, <ph id=\"ph1\">`LongTask`</ph> checks to see if the <ph id=\"ph2\">`Cancel`</ph> argument was set to <ph id=\"ph3\">`True`</ph>.","pos":[4227,4319],"source":" When the event returns, `LongTask` checks to see if the `Cancel` argument was set to `True`."},{"content":"A few disclaimers are necessary here.","pos":[4326,4363]},{"content":"For simplicity, the <ph id=\"ph1\">`LongTask`</ph> procedure assumes you know in advance how long the task will take.","pos":[4364,4461],"source":" For simplicity, the `LongTask` procedure assumes you know in advance how long the task will take."},{"content":"This is almost never the case.","pos":[4462,4492]},{"content":"Dividing tasks into chunks of even size can be difficult, and often what matters most to users is simply the amount of time that passes before they get an indication that something is happening.","pos":[4493,4687]},{"content":"You may have spotted another flaw in this sample.","pos":[4694,4743]},{"content":"The <ph id=\"ph1\">`Timer`</ph> property returns the number of seconds that have passed since midnight; therefore, the application gets stuck if it is started just before midnight.","pos":[4744,4904],"source":" The `Timer` property returns the number of seconds that have passed since midnight; therefore, the application gets stuck if it is started just before midnight."},{"content":"A more careful approach to measuring time would take boundary conditions such as this into consideration, or avoid them altogether, using properties such as <ph id=\"ph1\">`Now`</ph>.","pos":[4905,5068],"source":" A more careful approach to measuring time would take boundary conditions such as this into consideration, or avoid them altogether, using properties such as `Now`."},{"content":"Now that the <ph id=\"ph1\">`Widget`</ph> class can raise events, you can move to the next walkthrough.","pos":[5075,5158],"source":"Now that the `Widget` class can raise events, you can move to the next walkthrough."},{"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Handling Events<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/events/walkthrough-handling-events.md)</ept> demonstrates how to use <ph id=\"ph1\">`WithEvents`</ph> to associate an event handler with the <ph id=\"ph2\">`PercentDone`</ph> event.","pos":[5159,5386],"source":"[Walkthrough: Handling Events](../../../../visual-basic/programming-guide/language-features/events/walkthrough-handling-events.md) demonstrates how to use `WithEvents` to associate an event handler with the `PercentDone` event."},{"pos":[5395,5403],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5509,5639],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Handling Events<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/events/walkthrough-handling-events.md)</ept>","source":"[Walkthrough: Handling Events](../../../../visual-basic/programming-guide/language-features/events/walkthrough-handling-events.md)"},{"pos":[5642,5728],"content":"<bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/events/index.md)</ept>","source":"[Events](../../../../visual-basic/programming-guide/language-features/events/index.md)"}]}