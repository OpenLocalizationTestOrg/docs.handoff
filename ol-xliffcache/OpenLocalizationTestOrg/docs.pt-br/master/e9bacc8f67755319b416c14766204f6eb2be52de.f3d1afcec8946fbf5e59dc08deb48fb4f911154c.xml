{"content":"---\ntitle: \"Deploying an Interop Application\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"deploying applications [.NET Framework], interop\"\n  - \"strong-named assemblies, interop applications\"\n  - \"unsigned assemblies\"\n  - \"private assemblies\"\n  - \"exposing COM components to .NET Framework\"\n  - \"interoperation with unmanaged code, deploying applications\"\n  - \"shared assemblies\"\n  - \"COM interop, deploying applications\"\n  - \"interoperation with unmanaged code, exposing COM components\"\n  - \"signed assemblies\"\n  - \"COM interop, exposing COM components\"\nms.assetid: ea8a403e-ae03-4faa-9d9b-02179ec72992\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# Deploying an Interop Application\nAn interop application typically includes a .NET client assembly, one or more interop assemblies representing distinct COM type libraries, and one or more registered COM components. Visual Studio and the [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)] provide tools to import and convert a type library to an interop assembly, as discussed in [Importing a Type Library as an Assembly](importing-a-type-library-as-an-assembly.md). There are two ways to deploy an interop application:  \n  \n-   By using embedded interop types: Beginning with the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], you can instruct the compiler to embed type information from an interop assembly into your executable. The compiler embeds only the type information that your application uses. You do not have to deploy the interop assembly with your application. This is the recommended technique.  \n  \n-   By deploying interop assemblies: You can create a standard reference to an interop assembly. In this case, the interop assembly must be deployed with your application. If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code. For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).  \n  \n If you use embedded interop types, deployment is simple and straightforward. There is nothing special you need to do. The rest of this article describes the scenarios for deploying interop assemblies with your application.  \n  \n## Deploying Interop Assemblies  \n Assemblies can have strong names. A strong-named assembly includes the publisher's public key, which provides a unique identity. Assemblies that are produced by the [Type Library Importer (Tlbimp.exe)](../tools/tlbimp-exe-type-library-importer.md) can be signed by the publisher by using the **/keyfile** option. You can install signed assemblies into the global assembly cache. Unsigned assemblies must be installed on the user's machine as private assemblies.  \n  \n### Private Assemblies  \n To install an assembly to be used privately, both the application executable and the interop assembly that contains imported COM types must be installed in the same directory structure. The following illustration shows an unsigned interop assembly to be used privately by Client1.exe and Client2.exe, which reside in separate application directories. The interop assembly, which is called LOANLib.dll in this example, is installed twice.  \n  \n ![Directory structure and Windows registry](./media/deploying-an-interop-application/com-private-deployment.gif \"Directory structure and registry entries for a private deployment\")  \n  \n All COM components associated with the application must be installed in the Windows registry. If Client1.exe and Client2.exe in the illustration are installed on different computers, you must register the COM components on both computers.  \n  \n### Shared Assemblies  \n Assemblies that are shared by multiple applications should be installed in a centralized repository called the global assembly cache. .NET clients can access the same copy of the interop assembly, which is signed and installed in the global assembly cache. For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).  \n  \n## See also\n\n- [Exposing COM Components to the .NET Framework](exposing-com-components.md)\n- [Importing a Type Library as an Assembly](importing-a-type-library-as-an-assembly.md)\n- [Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))\n- [Compiling an Interop Project](compiling-an-interop-project.md)\n","nodes":[{"pos":[4,648],"embed":true,"restype":"x-metadata","content":"title: \"Deploying an Interop Application\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"deploying applications [.NET Framework], interop\"\n  - \"strong-named assemblies, interop applications\"\n  - \"unsigned assemblies\"\n  - \"private assemblies\"\n  - \"exposing COM components to .NET Framework\"\n  - \"interoperation with unmanaged code, deploying applications\"\n  - \"shared assemblies\"\n  - \"COM interop, deploying applications\"\n  - \"interoperation with unmanaged code, exposing COM components\"\n  - \"signed assemblies\"\n  - \"COM interop, exposing COM components\"\nms.assetid: ea8a403e-ae03-4faa-9d9b-02179ec72992\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"Deploying an Interop Application","nodes":[{"pos":[0,32],"content":"Deploying an Interop Application","nodes":[{"content":"Deploying an Interop Application","pos":[0,32]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[655,687],"content":"Deploying an Interop Application","linkify":"Deploying an Interop Application","nodes":[{"content":"Deploying an Interop Application","pos":[0,32]}]},{"content":"An interop application typically includes a .NET client assembly, one or more interop assemblies representing distinct COM type libraries, and one or more registered COM components.","pos":[688,869]},{"content":"Visual Studio and the <ph id=\"ph1\">[!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)]</ph> provide tools to import and convert a type library to an interop assembly, as discussed in <bpt id=\"p1\">[</bpt>Importing a Type Library as an Assembly<ept id=\"p1\">](importing-a-type-library-as-an-assembly.md)</ept>.","pos":[870,1128],"source":" Visual Studio and the [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)] provide tools to import and convert a type library to an interop assembly, as discussed in [Importing a Type Library as an Assembly](importing-a-type-library-as-an-assembly.md)."},{"content":"There are two ways to deploy an interop application:","pos":[1129,1181]},{"content":"By using embedded interop types: Beginning with the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)]</ph>, you can instruct the compiler to embed type information from an interop assembly into your executable.","pos":[1191,1409],"source":"By using embedded interop types: Beginning with the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], you can instruct the compiler to embed type information from an interop assembly into your executable."},{"content":"The compiler embeds only the type information that your application uses.","pos":[1410,1483]},{"content":"You do not have to deploy the interop assembly with your application.","pos":[1484,1553]},{"content":"This is the recommended technique.","pos":[1554,1588]},{"content":"By deploying interop assemblies: You can create a standard reference to an interop assembly.","pos":[1598,1690]},{"content":"In this case, the interop assembly must be deployed with your application.","pos":[1691,1765]},{"content":"If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.","pos":[1766,1987]},{"content":"For more information about producing and using primary interop assemblies, see <bpt id=\"p1\">[</bpt>Primary Interop Assemblies<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100))</ept>.","pos":[1988,2185],"source":" For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100))."},{"content":"If you use embedded interop types, deployment is simple and straightforward.","pos":[2192,2268]},{"content":"There is nothing special you need to do.","pos":[2269,2309]},{"content":"The rest of this article describes the scenarios for deploying interop assemblies with your application.","pos":[2310,2414]},{"pos":[2423,2451],"content":"Deploying Interop Assemblies","linkify":"Deploying Interop Assemblies","nodes":[{"content":"Deploying Interop Assemblies","pos":[0,28]}]},{"content":"Assemblies can have strong names.","pos":[2455,2488]},{"content":"A strong-named assembly includes the publisher's public key, which provides a unique identity.","pos":[2489,2583]},{"content":"Assemblies that are produced by the <bpt id=\"p1\">[</bpt>Type Library Importer (Tlbimp.exe)<ept id=\"p1\">](../tools/tlbimp-exe-type-library-importer.md)</ept> can be signed by the publisher by using the <bpt id=\"p2\">**</bpt>/keyfile<ept id=\"p2\">**</ept> option.","pos":[2584,2767],"source":" Assemblies that are produced by the [Type Library Importer (Tlbimp.exe)](../tools/tlbimp-exe-type-library-importer.md) can be signed by the publisher by using the **/keyfile** option."},{"content":"You can install signed assemblies into the global assembly cache.","pos":[2768,2833]},{"content":"Unsigned assemblies must be installed on the user's machine as private assemblies.","pos":[2834,2916]},{"pos":[2926,2944],"content":"Private Assemblies","linkify":"Private Assemblies","nodes":[{"content":"Private Assemblies","pos":[0,18]}]},{"content":"To install an assembly to be used privately, both the application executable and the interop assembly that contains imported COM types must be installed in the same directory structure.","pos":[2948,3133]},{"content":"The following illustration shows an unsigned interop assembly to be used privately by Client1.exe and Client2.exe, which reside in separate application directories.","pos":[3134,3298]},{"content":"The interop assembly, which is called LOANLib.dll in this example, is installed twice.","pos":[3299,3385]},{"pos":[3392,3572],"content":"<bpt id=\"p1\">![</bpt>Directory structure and Windows registry<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/deploying-an-interop-application/com-private-deployment.gif \"</bpt>Directory structure and registry entries for a private deployment<ept id=\"p2\">\")</ept>","source":"![Directory structure and Windows registry](./media/deploying-an-interop-application/com-private-deployment.gif \"Directory structure and registry entries for a private deployment\")"},{"content":"All COM components associated with the application must be installed in the Windows registry.","pos":[3579,3672]},{"content":"If Client1.exe and Client2.exe in the illustration are installed on different computers, you must register the COM components on both computers.","pos":[3673,3817]},{"pos":[3827,3844],"content":"Shared Assemblies","linkify":"Shared Assemblies","nodes":[{"content":"Shared Assemblies","pos":[0,17]}]},{"content":"Assemblies that are shared by multiple applications should be installed in a centralized repository called the global assembly cache.","pos":[3848,3981]},{"content":".NET clients can access the same copy of the interop assembly, which is signed and installed in the global assembly cache.","pos":[3982,4104]},{"content":"For more information about producing and using primary interop assemblies, see <bpt id=\"p1\">[</bpt>Primary Interop Assemblies<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100))</ept>.","pos":[4105,4302],"source":" For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100))."},{"pos":[4311,4319],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4323,4398],"content":"<bpt id=\"p1\">[</bpt>Exposing COM Components to the .NET Framework<ept id=\"p1\">](exposing-com-components.md)</ept>","source":"[Exposing COM Components to the .NET Framework](exposing-com-components.md)"},{"pos":[4401,4486],"content":"<bpt id=\"p1\">[</bpt>Importing a Type Library as an Assembly<ept id=\"p1\">](importing-a-type-library-as-an-assembly.md)</ept>","source":"[Importing a Type Library as an Assembly](importing-a-type-library-as-an-assembly.md)"},{"pos":[4489,4611],"content":"<bpt id=\"p1\">[</bpt>Using COM Types in Managed Code<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</ept>","source":"[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))"},{"pos":[4614,4677],"content":"<bpt id=\"p1\">[</bpt>Compiling an Interop Project<ept id=\"p1\">](compiling-an-interop-project.md)</ept>","source":"[Compiling an Interop Project](compiling-an-interop-project.md)"}]}