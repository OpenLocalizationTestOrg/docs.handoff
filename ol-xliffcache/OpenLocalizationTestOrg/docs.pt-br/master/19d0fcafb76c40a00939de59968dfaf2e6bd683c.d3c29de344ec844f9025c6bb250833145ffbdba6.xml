{"content":"---\ntitle: \"Storing data to and reading from the Clipboard (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"Clipboard, storing data to (My.Computer.Clipboard)\"\n  - \"Clipboard, reading from (My.Computer.Clipboard)\"\n  - \"Clipboard\"\n  - \"My.Computer.Clipboard object, tasks\"\n  - \"data [Visual Basic], Clipboard\"\n  - \"reading data, from Clipboard\"\nms.assetid: f690119a-4378-4f7d-b20e-d9377ef49496\n---\n# Storing data to and reading from the Clipboard (Visual Basic)\nThe Clipboard can be used to store data, such as text and images. Because the Clipboard is shared by all active processes, it can be used to transfer data between them. The `My.Computer.Clipboard` object allows you to easily access the Clipboard and to read from and write to it.  \n  \n## Reading from the Clipboard  \n Use the <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.GetText%2A> method to read the text in the Clipboard. The following code reads the text and displays it in a message box. There must be text stored on the Clipboard for the example to run correctly.  \n  \n [!code-vb[VbVbcnMyClipboard#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyClipboard/VB/Class1.vb#4)]  \n  \n This code example is also available as an IntelliSense code snippet. In the code snippet picker, it is located in **Windows Forms Applications > Clipboard**. For more information, see [Code Snippets](/visualstudio/ide/code-snippets).  \n  \n Use the <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.GetImage%2A> method to retrieve an image from the Clipboard. This example checks to see if there is an image on the Clipboard before retrieving it and assigning it to `PictureBox1`.  \n  \n [!code-vb[VbResourceTasks#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbResourceTasks/VB/Class1.vb#16)]  \n  \n This code example is also available as an IntelliSense code snippet. In the code snippet picker, it is located in **Windows Forms Applications > Clipboard**.For more information, see [Code Snippets](/visualstudio/ide/code-snippets).  \n  \n Items placed on the Clipboard will persist even after the application is shut down.  \n  \n## Determining the type of file stored in the Clipboard  \n Data on the Clipboard may take a number of different forms, such as text, an audio file, or an image. In order to determine what sort of file is on the Clipboard, you can use methods such as <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsAudio%2A>, <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsFileDropList%2A>, <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsImage%2A>, and <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsText%2A>. The <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsData%2A> method can be used if you have a custom format that you want to check.  \n  \n Use the `ContainsImage` function to determine whether the data contained on the Clipboard is an image. The following code checks to see whether the data is an image and reports accordingly.  \n  \n [!code-vb[VbResourceTasks#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbResourceTasks/VB/Class1.vb#13)]  \n  \n## Clearing the Clipboard  \n The <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.Clear%2A> method clears the Clipboard. Because the Clipboard is shared by other processes, clearing it may have an impact on those processes.  \n  \n The following code shows how to use the `Clear` method.  \n  \n [!code-vb[VbVbcnMyClipboard#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyClipboard/VB/Class1.vb#3)]  \n  \n## Writing to the Clipboard  \n Use the <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.SetText%2A> method to write text to the Clipboard. The following code writes the string \"This is a test string\" to the Clipboard.  \n  \n [!code-vb[VbVbcnMyClipboard#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyClipboard/VB/Class1.vb#1)]  \n  \n The `SetText` method can accept a format parameter that contains a type of <xref:System.Windows.Forms.TextDataFormat>. The following code writes the string \"This is a test string\" to the Clipboard as RTF text.  \n  \n [!code-vb[VbVbcnMyClipboard#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyClipboard/VB/Class1.vb#2)]  \n  \n Use the <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.SetData%2A> method to write data to the Clipboard. This example writes the `DataObject` `dataChunk` to the Clipboard in the custom format `specialFormat`.  \n  \n [!code-vb[VbVbcnMyClipboard#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyClipboard/VB/Class1.vb#7)]  \n  \n Use the <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.SetAudio%2A> method to write audio data to the Clipboard. This example creates the byte array `musicReader`, reads the file `cool.wav` into it, and then writes it to the Clipboard.  \n  \n [!code-vb[VbResourceTasks#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbResourceTasks/VB/Class1.vb#5)]  \n  \n> [!IMPORTANT]\n>  Because the Clipboard can be accessed by other users, do not use it to store sensitive information, such as passwords or confidential data.  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy>\n- <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.GetAudioStream%2A>\n- <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.SetDataObject%2A>\n- [How to: Read Object Data from an XML File](../../../programming-guide/concepts/serialization/how-to-read-object-data-from-an-xml-file.md)\n- [How to: Write Object Data to an XML File](../../../programming-guide/concepts/serialization/how-to-write-object-data-to-an-xml-file.md)\n","nodes":[{"pos":[4,406],"embed":true,"restype":"x-metadata","content":"title: \"Storing data to and reading from the Clipboard (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"Clipboard, storing data to (My.Computer.Clipboard)\"\n  - \"Clipboard, reading from (My.Computer.Clipboard)\"\n  - \"Clipboard\"\n  - \"My.Computer.Clipboard object, tasks\"\n  - \"data [Visual Basic], Clipboard\"\n  - \"reading data, from Clipboard\"\nms.assetid: f690119a-4378-4f7d-b20e-d9377ef49496","nodes":[{"content":"Storing data to and reading from the Clipboard (Visual Basic)","nodes":[{"pos":[0,61],"content":"Storing data to and reading from the Clipboard (Visual Basic)","nodes":[{"content":"Storing data to and reading from the Clipboard (Visual Basic)","pos":[0,61]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[413,474],"content":"Storing data to and reading from the Clipboard (Visual Basic)","linkify":"Storing data to and reading from the Clipboard (Visual Basic)","nodes":[{"content":"Storing data to and reading from the Clipboard (Visual Basic)","pos":[0,61]}]},{"content":"The Clipboard can be used to store data, such as text and images.","pos":[475,540]},{"content":"Because the Clipboard is shared by all active processes, it can be used to transfer data between them.","pos":[541,643]},{"content":"The <ph id=\"ph1\">`My.Computer.Clipboard`</ph> object allows you to easily access the Clipboard and to read from and write to it.","pos":[644,754],"source":" The `My.Computer.Clipboard` object allows you to easily access the Clipboard and to read from and write to it."},{"pos":[763,789],"content":"Reading from the Clipboard","linkify":"Reading from the Clipboard","nodes":[{"content":"Reading from the Clipboard","pos":[0,26]}]},{"content":"Use the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.GetText%2A&gt;</ph> method to read the text in the Clipboard.","pos":[793,908],"source":"Use the <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.GetText%2A> method to read the text in the Clipboard."},{"content":"The following code reads the text and displays it in a message box.","pos":[909,976]},{"content":"There must be text stored on the Clipboard for the example to run correctly.","pos":[977,1053]},{"content":"This code example is also available as an IntelliSense code snippet.","pos":[1184,1252]},{"content":"In the code snippet picker, it is located in <bpt id=\"p1\">**</bpt>Windows Forms Applications &gt; Clipboard<ept id=\"p1\">**</ept>.","pos":[1253,1341],"source":" In the code snippet picker, it is located in **Windows Forms Applications > Clipboard**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Snippets<ept id=\"p1\">](/visualstudio/ide/code-snippets)</ept>.","pos":[1342,1417],"source":" For more information, see [Code Snippets](/visualstudio/ide/code-snippets)."},{"content":"Use the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.GetImage%2A&gt;</ph> method to retrieve an image from the Clipboard.","pos":[1424,1546],"source":"Use the <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.GetImage%2A> method to retrieve an image from the Clipboard."},{"content":"This example checks to see if there is an image on the Clipboard before retrieving it and assigning it to <ph id=\"ph1\">`PictureBox1`</ph>.","pos":[1547,1667],"source":" This example checks to see if there is an image on the Clipboard before retrieving it and assigning it to `PictureBox1`."},{"content":"This code example is also available as an IntelliSense code snippet.","pos":[1796,1864]},{"content":"In the code snippet picker, it is located in <bpt id=\"p1\">**</bpt>Windows Forms Applications &gt; Clipboard<ept id=\"p1\">**</ept>.For more information, see <bpt id=\"p2\">[</bpt>Code Snippets<ept id=\"p2\">](/visualstudio/ide/code-snippets)</ept>.","pos":[1865,2028],"source":" In the code snippet picker, it is located in **Windows Forms Applications > Clipboard**.For more information, see [Code Snippets](/visualstudio/ide/code-snippets)."},{"content":"Items placed on the Clipboard will persist even after the application is shut down.","pos":[2035,2118]},{"pos":[2127,2179],"content":"Determining the type of file stored in the Clipboard","linkify":"Determining the type of file stored in the Clipboard","nodes":[{"content":"Determining the type of file stored in the Clipboard","pos":[0,52]}]},{"content":"Data on the Clipboard may take a number of different forms, such as text, an audio file, or an image.","pos":[2183,2284]},{"content":"In order to determine what sort of file is on the Clipboard, you can use methods such as <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsAudio%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsFileDropList%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsImage%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsText%2A&gt;</ph>.","pos":[2285,2675],"source":" In order to determine what sort of file is on the Clipboard, you can use methods such as <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsAudio%2A>, <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsFileDropList%2A>, <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsImage%2A>, and <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsText%2A>."},{"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsData%2A&gt;</ph> method can be used if you have a custom format that you want to check.","pos":[2676,2821],"source":" The <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.ContainsData%2A> method can be used if you have a custom format that you want to check."},{"content":"Use the <ph id=\"ph1\">`ContainsImage`</ph> function to determine whether the data contained on the Clipboard is an image.","pos":[2828,2930],"source":"Use the `ContainsImage` function to determine whether the data contained on the Clipboard is an image."},{"content":"The following code checks to see whether the data is an image and reports accordingly.","pos":[2931,3017]},{"pos":[3148,3170],"content":"Clearing the Clipboard","linkify":"Clearing the Clipboard","nodes":[{"content":"Clearing the Clipboard","pos":[0,22]}]},{"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.Clear%2A&gt;</ph> method clears the Clipboard.","pos":[3174,3270],"source":"The <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.Clear%2A> method clears the Clipboard."},{"content":"Because the Clipboard is shared by other processes, clearing it may have an impact on those processes.","pos":[3271,3373]},{"pos":[3380,3435],"content":"The following code shows how to use the <ph id=\"ph1\">`Clear`</ph> method.","source":"The following code shows how to use the `Clear` method."},{"pos":[3568,3592],"content":"Writing to the Clipboard","linkify":"Writing to the Clipboard","nodes":[{"content":"Writing to the Clipboard","pos":[0,24]}]},{"content":"Use the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.SetText%2A&gt;</ph> method to write text to the Clipboard.","pos":[3596,3708],"source":"Use the <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.SetText%2A> method to write text to the Clipboard."},{"content":"The following code writes the string \"This is a test string\" to the Clipboard.","pos":[3709,3787]},{"content":"The <ph id=\"ph1\">`SetText`</ph> method can accept a format parameter that contains a type of <ph id=\"ph2\">&lt;xref:System.Windows.Forms.TextDataFormat&gt;</ph>.","pos":[3918,4036],"source":"The `SetText` method can accept a format parameter that contains a type of <xref:System.Windows.Forms.TextDataFormat>."},{"content":"The following code writes the string \"This is a test string\" to the Clipboard as RTF text.","pos":[4037,4127]},{"content":"Use the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.SetData%2A&gt;</ph> method to write data to the Clipboard.","pos":[4258,4370],"source":"Use the <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.SetData%2A> method to write data to the Clipboard."},{"content":"This example writes the <ph id=\"ph1\">`DataObject`</ph> <ph id=\"ph2\">`dataChunk`</ph> to the Clipboard in the custom format <ph id=\"ph3\">`specialFormat`</ph>.","pos":[4371,4474],"source":" This example writes the `DataObject` `dataChunk` to the Clipboard in the custom format `specialFormat`."},{"content":"Use the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.SetAudio%2A&gt;</ph> method to write audio data to the Clipboard.","pos":[4605,4724],"source":"Use the <xref:Microsoft.VisualBasic.MyServices.ClipboardProxy.SetAudio%2A> method to write audio data to the Clipboard."},{"content":"This example creates the byte array <ph id=\"ph1\">`musicReader`</ph>, reads the file <ph id=\"ph2\">`cool.wav`</ph> into it, and then writes it to the Clipboard.","pos":[4725,4847],"source":" This example creates the byte array `musicReader`, reads the file `cool.wav` into it, and then writes it to the Clipboard."},{"pos":[4975,5130],"content":"[!IMPORTANT]\n Because the Clipboard can be accessed by other users, do not use it to store sensitive information, such as passwords or confidential data.","leadings":["","> "],"nodes":[{"content":"Because the Clipboard can be accessed by other users, do not use it to store sensitive information, such as passwords or confidential data.","pos":[14,153]}]},{"pos":[5139,5147],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5357,5495],"content":"<bpt id=\"p1\">[</bpt>How to: Read Object Data from an XML File<ept id=\"p1\">](../../../programming-guide/concepts/serialization/how-to-read-object-data-from-an-xml-file.md)</ept>","source":"[How to: Read Object Data from an XML File](../../../programming-guide/concepts/serialization/how-to-read-object-data-from-an-xml-file.md)"},{"pos":[5498,5634],"content":"<bpt id=\"p1\">[</bpt>How to: Write Object Data to an XML File<ept id=\"p1\">](../../../programming-guide/concepts/serialization/how-to-write-object-data-to-an-xml-file.md)</ept>","source":"[How to: Write Object Data to an XML File](../../../programming-guide/concepts/serialization/how-to-write-object-data-to-an-xml-file.md)"}]}