{"content":"---\ntitle: \"Working with Global Namespaces (Visual Basic) (LINQ to XML)\"\nms.date: 07/20/2015\nms.assetid: 0a8064d5-e02f-4315-ad48-6deaa443a2f0\n---\n# Working with Global Namespaces (Visual Basic) (LINQ to XML)\nOne of the key features of XML literals in Visual Basic is the capability to declare XML namespaces by using the `Imports` statement. Using this feature, you can declare an XML namespace that uses a prefix, or you can declare a default XML namespace.  \n  \n This capability is useful in two situations. First, namespaces declared in XML literals do not carry over into embedded expressions. Declaring global namespaces reduces the amount of work that you have to do to use embedded expressions with namespaces. Second, you must declare global namespaces in order to use namespaces with XML properties.  \n  \n You can declare global namespaces at the project level. You can also declare global namespaces at the module level, which overrides the project-level global namespaces. Finally, you can override global namespaces in an XML literal.  \n  \n When using XML literals or XML properties that are in globally-declared namespaces, you can see the expanded name of XML literals or properties by hovering over them in Visual Studio. You will see the expanded name in a tooltip.  \n  \n You can get an <xref:System.Xml.Linq.XNamespace> object that corresponds to a global namespace using the `GetXmlNamespace` method.  \n  \n## Examples of Global Namespaces  \n The following example declares a default global namespace by using the `Imports` statement, and then uses an XML literal to initialize an <xref:System.Xml.Linq.XElement> object in that namespace:  \n  \n```vb  \nImports <xmlns=\"http://www.adventure-works.com\">  \n  \nModule Module1  \n    Sub Main()  \n        Dim root As XElement = <Root/>  \n        Console.WriteLine(root)  \n    End Sub  \nEnd Module  \n```  \n  \n This example produces the following output:  \n  \n```xml  \n<Root xmlns=\"http://www.adventure-works.com\" />  \n```  \n  \n The following example declares a global namespace with a prefix, and then uses an XML literal to initialize an element:  \n  \n```vb  \nImports <xmlns:aw=\"http://www.adventure-works.com\">  \n  \nModule Module1  \n    Sub Main()  \n        Dim root As XElement = <aw:Root/>  \n        Console.WriteLine(root)  \n    End Sub  \nEnd Module  \n```  \n  \n This example produces the following output:  \n  \n```xml  \n<aw:Root xmlns:aw=\"http://www.adventure-works.com\" />  \n```  \n  \n## Global Namespaces and Embedded Expressions  \n Namespaces that are declared in XML literals do not carry over into embedded expressions. The following example declares a default namespace. It then uses an embedded expression for the `Child` element.  \n  \n```vb  \nDim root As XElement = _  \n    <Root xmlns=\"http://www.adventure-works.com\">  \n        <%= <Child/> %>  \n    </Root>  \nConsole.WriteLine(root)  \n```  \n  \n This example produces the following output:  \n  \n```xml  \n<Root xmlns=\"http://www.adventure-works.com\">  \n  <Child xmlns=\"\" />  \n</Root>  \n```  \n  \n As you can see, the resulting XML includes a declaration of a default namespace so that the `Child` element is in no namespace.  \n  \n You could re-declare the namespace in the embedded expression, as follows:  \n  \n```vb  \nDim root As XElement = _  \n    <Root xmlns=\"http://www.adventure-works.com\">  \n        <%= <Child xmlns=\"http://www.adventure-works.com\"/> %>  \n    </Root>  \nConsole.WriteLine(root)  \n```  \n  \n This example produces the following output:  \n  \n```xml  \n<Root xmlns=\"http://www.adventure-works.com\">  \n  <Child xmlns=\"http://www.adventure-works.com\" />  \n</Root>  \n```  \n  \n However, this is more cumbersome to use than the global default namespace, which is a better approach. With the global default namespace, you can use XML literals without declaring namespaces. The resulting XML will be in the globally-declared default namespace.  \n  \n```vb  \nImports <xmlns=\"http://www.adventure-works.com\">  \n  \nModule Module1  \n    Sub Main()  \n        Dim root As XElement = <Root>  \n                                   <%= <Child/> %>  \n                               </Root>  \n        Console.WriteLine(root)  \n    End Sub  \nEnd Module  \n```  \n  \n This example produces the following output:  \n  \n```xml  \n<Root xmlns=\"http://www.adventure-works.com\">  \n  <Child />  \n</Root>  \n```  \n  \n## Using Namespaces with XML Properties  \n If you are working with an XML tree that is in a namespace, and you use XML properties, then you must use a global namespace so that the XML properties will also be in the correct namespace. The following example declares an XML tree in a namespace. It then prints the count of `Child` elements.  \n  \n```vb  \nDim root As XElement = _  \n    <Root xmlns=\"http://www.adventure-works.com\">  \n        <Child>content</Child>  \n    </Root>  \nConsole.WriteLine(root.<Child>.Count())  \n```  \n  \n This example indicates that there are no `Child` elements. It produces the following output:  \n  \n```  \n0  \n```  \n  \n If, however, you declare a default global namespace, then both the XML literal and the XML property are in the default global namespace:  \n  \n```vb  \nImports <xmlns=\"http://www.adventure-works.com\">  \n  \nModule Module1  \n    Sub Main()  \n        Dim root As XElement = _  \n            <Root>  \n                <Child>content</Child>  \n            </Root>  \n        Console.WriteLine(root.<Child>.Count())  \n    End Sub  \nEnd Module  \n```  \n  \n This example indicates that there is one `Child` element. It produces the following output:  \n  \n```  \n1  \n```  \n  \n If you declare a global namespace that has a prefix, you can use the prefix for both XML literals and XML properties:  \n  \n```vb  \nImports <xmlns:aw=\"http://www.adventure-works.com\">  \n  \nModule Module1  \n    Sub Main()  \n        Dim root As XElement = _  \n            <aw:Root>  \n                <aw:Child>content</aw:Child>  \n            </aw:Root>  \n        Console.WriteLine(root.<aw:Child>.Count())  \n    End Sub  \nEnd Module  \n```  \n  \n## XNamespace and Global Namespaces  \n You can get an <xref:System.Xml.Linq.XNamespace> object by using the `GetXmlNamespace` method:  \n  \n```vb  \nImports <xmlns:aw=\"http://www.adventure-works.com\">  \n  \nModule Module1  \n    Sub Main()  \n        Dim root As XElement = <aw:Root/>  \n        Dim xn As XNamespace = GetXmlNamespace(aw)  \n        Console.WriteLine(xn)  \n    End Sub  \nEnd Module  \n```  \n  \n This example produces the following output:  \n  \n```  \nhttp://www.adventure-works.com  \n```  \n  \n## See also\n\n- [Working with XML Namespaces (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/working-with-xml-namespaces.md)\n","nodes":[{"pos":[4,141],"embed":true,"restype":"x-metadata","content":"title: \"Working with Global Namespaces (Visual Basic) (LINQ to XML)\"\nms.date: 07/20/2015\nms.assetid: 0a8064d5-e02f-4315-ad48-6deaa443a2f0","nodes":[{"content":"Working with Global Namespaces (Visual Basic) (LINQ to XML)","nodes":[{"pos":[0,59],"content":"Working with Global Namespaces (Visual Basic) (LINQ to XML)","nodes":[{"content":"Working with Global Namespaces (Visual Basic) (LINQ to XML)","pos":[0,59]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[148,207],"content":"Working with Global Namespaces (Visual Basic) (LINQ to XML)","linkify":"Working with Global Namespaces (Visual Basic) (LINQ to XML)","nodes":[{"content":"Working with Global Namespaces (Visual Basic) (LINQ to XML)","pos":[0,59]}]},{"content":"One of the key features of XML literals in Visual Basic is the capability to declare XML namespaces by using the <ph id=\"ph1\">`Imports`</ph> statement.","pos":[208,341],"source":"One of the key features of XML literals in Visual Basic is the capability to declare XML namespaces by using the `Imports` statement."},{"content":"Using this feature, you can declare an XML namespace that uses a prefix, or you can declare a default XML namespace.","pos":[342,458]},{"content":"This capability is useful in two situations.","pos":[465,509]},{"content":"First, namespaces declared in XML literals do not carry over into embedded expressions.","pos":[510,597]},{"content":"Declaring global namespaces reduces the amount of work that you have to do to use embedded expressions with namespaces.","pos":[598,717]},{"content":"Second, you must declare global namespaces in order to use namespaces with XML properties.","pos":[718,808]},{"content":"You can declare global namespaces at the project level.","pos":[815,870]},{"content":"You can also declare global namespaces at the module level, which overrides the project-level global namespaces.","pos":[871,983]},{"content":"Finally, you can override global namespaces in an XML literal.","pos":[984,1046]},{"content":"When using XML literals or XML properties that are in globally-declared namespaces, you can see the expanded name of XML literals or properties by hovering over them in Visual Studio.","pos":[1053,1236]},{"content":"You will see the expanded name in a tooltip.","pos":[1237,1281]},{"pos":[1288,1418],"content":"You can get an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XNamespace&gt;</ph> object that corresponds to a global namespace using the <ph id=\"ph2\">`GetXmlNamespace`</ph> method.","source":"You can get an <xref:System.Xml.Linq.XNamespace> object that corresponds to a global namespace using the `GetXmlNamespace` method."},{"pos":[1427,1456],"content":"Examples of Global Namespaces","linkify":"Examples of Global Namespaces","nodes":[{"content":"Examples of Global Namespaces","pos":[0,29]}]},{"pos":[1460,1655],"content":"The following example declares a default global namespace by using the <ph id=\"ph1\">`Imports`</ph> statement, and then uses an XML literal to initialize an <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> object in that namespace:","source":"The following example declares a default global namespace by using the `Imports` statement, and then uses an XML literal to initialize an <xref:System.Xml.Linq.XElement> object in that namespace:"},{"content":"This example produces the following output:","pos":[1869,1912]},{"content":"The following example declares a global namespace with a prefix, and then uses an XML literal to initialize an element:","pos":[1987,2106]},{"content":"This example produces the following output:","pos":[2326,2369]},{"pos":[2452,2494],"content":"Global Namespaces and Embedded Expressions","linkify":"Global Namespaces and Embedded Expressions","nodes":[{"content":"Global Namespaces and Embedded Expressions","pos":[0,42]}]},{"content":"Namespaces that are declared in XML literals do not carry over into embedded expressions.","pos":[2498,2587]},{"content":"The following example declares a default namespace.","pos":[2588,2639]},{"content":"It then uses an embedded expression for the <ph id=\"ph1\">`Child`</ph> element.","pos":[2640,2700],"source":" It then uses an embedded expression for the `Child` element."},{"content":"This example produces the following output:","pos":[2869,2912]},{"pos":[3018,3145],"content":"As you can see, the resulting XML includes a declaration of a default namespace so that the <ph id=\"ph1\">`Child`</ph> element is in no namespace.","source":"As you can see, the resulting XML includes a declaration of a default namespace so that the `Child` element is in no namespace."},{"content":"You could re-declare the namespace in the embedded expression, as follows:","pos":[3152,3226]},{"content":"This example produces the following output:","pos":[3434,3477]},{"content":"However, this is more cumbersome to use than the global default namespace, which is a better approach.","pos":[3613,3715]},{"content":"With the global default namespace, you can use XML literals without declaring namespaces.","pos":[3716,3805]},{"content":"The resulting XML will be in the globally-declared default namespace.","pos":[3806,3875]},{"content":"This example produces the following output:","pos":[4182,4225]},{"pos":[4324,4360],"content":"Using Namespaces with XML Properties","linkify":"Using Namespaces with XML Properties","nodes":[{"content":"Using Namespaces with XML Properties","pos":[0,36]}]},{"content":"If you are working with an XML tree that is in a namespace, and you use XML properties, then you must use a global namespace so that the XML properties will also be in the correct namespace.","pos":[4364,4554]},{"content":"The following example declares an XML tree in a namespace.","pos":[4555,4613]},{"content":"It then prints the count of <ph id=\"ph1\">`Child`</ph> elements.","pos":[4614,4659],"source":" It then prints the count of `Child` elements."},{"content":"This example indicates that there are no <ph id=\"ph1\">`Child`</ph> elements.","pos":[4851,4909],"source":"This example indicates that there are no `Child` elements."},{"content":"It produces the following output:","pos":[4910,4943]},{"content":"If, however, you declare a default global namespace, then both the XML literal and the XML property are in the default global namespace:","pos":[4969,5105]},{"content":"This example indicates that there is one <ph id=\"ph1\">`Child`</ph> element.","pos":[5413,5470],"source":"This example indicates that there is one `Child` element."},{"content":"It produces the following output:","pos":[5471,5504]},{"content":"If you declare a global namespace that has a prefix, you can use the prefix for both XML literals and XML properties:","pos":[5530,5647]},{"pos":[5975,6007],"content":"XNamespace and Global Namespaces","linkify":"XNamespace and Global Namespaces","nodes":[{"content":"XNamespace and Global Namespaces","pos":[0,32]}]},{"pos":[6011,6105],"content":"You can get an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XNamespace&gt;</ph> object by using the <ph id=\"ph2\">`GetXmlNamespace`</ph> method:","source":"You can get an <xref:System.Xml.Linq.XNamespace> object by using the `GetXmlNamespace` method:"},{"content":"This example produces the following output:","pos":[6376,6419]},{"pos":[6476,6484],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6488,6621],"content":"<bpt id=\"p1\">[</bpt>Working with XML Namespaces (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/working-with-xml-namespaces.md)</ept>","source":"[Working with XML Namespaces (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/working-with-xml-namespaces.md)"}]}