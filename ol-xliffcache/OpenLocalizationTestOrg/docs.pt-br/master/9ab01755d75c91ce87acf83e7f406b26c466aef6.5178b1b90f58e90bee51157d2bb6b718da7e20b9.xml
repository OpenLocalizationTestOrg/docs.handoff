{"content":"---\ntitle: \"If Operator (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.IfOperator\"\n  - \"IfOperator\"\nhelpviewer_keywords: \n  - \"ternary operators [Visual Basic]\"\n  - \"conditional execution\"\n  - \"If expressions [Visual Basic]\"\n  - \"conditional operator [Visual Basic]\"\n  - \"If Operator [Visual Basic]\"\nms.assetid: dd56c9df-7cd4-442c-9ba6-20c70ee44c8f\n---\n# If Operator (Visual Basic)\nUses short-circuit evaluation to conditionally return one of two values. The `If` operator can be called with three arguments or with two arguments.  \n  \n## Syntax  \n  \n```  \nIf( [argument1,] argument2, argument3 )  \n```  \n  \n## If Operator Called with Three Arguments  \n When `If` is called by using three arguments, the first argument must evaluate to a value that can be cast as a `Boolean`. That `Boolean` value will determine which of the other two arguments is evaluated and returned. The following list applies only when the `If` operator is called by using three arguments.  \n  \n## Parts  \n  \n|Term|Definition|  \n|---|---|  \n|`argument1`|Required. `Boolean`. Determines which of the other arguments to evaluate and return.|  \n|`argument2`|Required. `Object`. Evaluated and returned if `argument1` evaluates to `True`.|  \n|`argument3`|Required. `Object`. Evaluated and returned if `argument1` evaluates to `False` or if `argument1` is a [Nullable](../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md)`Boolean` variable that evaluates to [Nothing](../../../visual-basic/language-reference/nothing.md).|  \n  \n An `If` operator that is called with three arguments works like an `IIf` function except that it uses short-circuit evaluation. An `IIf` function always evaluates all three of its arguments, whereas an `If` operator that has three arguments evaluates only two of them. The first `If` argument is evaluated and the result is cast as a `Boolean` value, `True` or `False`. If the value is `True`, `argument2` is evaluated and its value is returned, but `argument3` is not evaluated. If the value of the `Boolean` expression is `False`, `argument3` is evaluated and its value is returned, but `argument2` is not evaluated. The following examples illustrate the use of `If` when three arguments are used:  \n  \n [!code-vb[VbVbalrOperators#100](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#100)]  \n  \n The following example illustrates the value of short-circuit evaluation. The example shows two attempts to divide variable `number` by variable `divisor` except when `divisor` is zero. In that case, a 0 should be returned, and no attempt should be made to perform the division because a run-time error would result. Because the `If` expression uses short-circuit evaluation, it evaluates either the second or the third argument, depending on the value of the first argument. If the first argument is true, the divisor is not zero and it is safe to evaluate the second argument and perform the division. If the first argument is false, only the third argument is evaluated and a 0 is returned. Therefore, when the divisor is 0, no attempt is made to perform the division and no error results. However, because `IIf` does not use short-circuit evaluation, the second argument is evaluated even when the first argument is false. This causes a run-time divide-by-zero error.  \n  \n [!code-vb[VbVbalrOperators#101](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#101)]  \n  \n## If Operator Called with Two Arguments  \n The first argument to `If` can be omitted. This enables the operator to be called by using only two arguments. The following list applies only when the `If` operator is called with two arguments.  \n  \n## Parts  \n  \n|Term|Definition|  \n|---|---|  \n|`argument2`|Required. `Object`. Must be a reference or nullable type. Evaluated and returned when it evaluates to anything other than `Nothing`.|  \n|`argument3`|Required. `Object`. Evaluated and returned if `argument2` evaluates to `Nothing`.|  \n  \n When the `Boolean` argument is omitted, the first argument must be a reference or nullable type. If the first argument evaluates to `Nothing`, the value of the second argument is returned. In all other cases, the value of the first argument is returned. The following example illustrates how this evaluation works.  \n  \n [!code-vb[VbVbalrOperators#102](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class4.vb#102)]  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.Interaction.IIf%2A>\n- [Nullable Value Types](../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md)\n- [Nothing](../../../visual-basic/language-reference/nothing.md)\n","nodes":[{"pos":[4,359],"embed":true,"restype":"x-metadata","content":"title: \"If Operator (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.IfOperator\"\n  - \"IfOperator\"\nhelpviewer_keywords: \n  - \"ternary operators [Visual Basic]\"\n  - \"conditional execution\"\n  - \"If expressions [Visual Basic]\"\n  - \"conditional operator [Visual Basic]\"\n  - \"If Operator [Visual Basic]\"\nms.assetid: dd56c9df-7cd4-442c-9ba6-20c70ee44c8f","nodes":[{"content":"If Operator (Visual Basic)","nodes":[{"pos":[0,26],"content":"If Operator (Visual Basic)","nodes":[{"content":"If Operator (Visual Basic)","pos":[0,26]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[366,392],"content":"If Operator (Visual Basic)","linkify":"If Operator (Visual Basic)","nodes":[{"content":"If Operator (Visual Basic)","pos":[0,26]}]},{"content":"Uses short-circuit evaluation to conditionally return one of two values.","pos":[393,465]},{"content":"The <ph id=\"ph1\">`If`</ph> operator can be called with three arguments or with two arguments.","pos":[466,541],"source":" The `If` operator can be called with three arguments or with two arguments."},{"pos":[550,556],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[622,661],"content":"If Operator Called with Three Arguments","linkify":"If Operator Called with Three Arguments","nodes":[{"content":"If Operator Called with Three Arguments","pos":[0,39]}]},{"content":"When <ph id=\"ph1\">`If`</ph> is called by using three arguments, the first argument must evaluate to a value that can be cast as a <ph id=\"ph2\">`Boolean`</ph>.","pos":[665,787],"source":"When `If` is called by using three arguments, the first argument must evaluate to a value that can be cast as a `Boolean`."},{"content":"That <ph id=\"ph1\">`Boolean`</ph> value will determine which of the other two arguments is evaluated and returned.","pos":[788,883],"source":" That `Boolean` value will determine which of the other two arguments is evaluated and returned."},{"content":"The following list applies only when the <ph id=\"ph1\">`If`</ph> operator is called by using three arguments.","pos":[884,974],"source":" The following list applies only when the `If` operator is called by using three arguments."},{"pos":[983,988],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"content":"Term","pos":[995,999]},{"content":"Definition","pos":[1000,1010]},{"content":"Required.","pos":[1039,1048]},{"content":"<ph id=\"ph1\">`Boolean`</ph>.","pos":[1049,1059],"source":"`Boolean`."},{"content":"Determines which of the other arguments to evaluate and return.","pos":[1060,1123]},{"content":"Required.","pos":[1140,1149]},{"content":"<ph id=\"ph1\">`Object`</ph>.","pos":[1150,1159],"source":"`Object`."},{"content":"Evaluated and returned if <ph id=\"ph1\">`argument1`</ph> evaluates to <ph id=\"ph2\">`True`</ph>.","pos":[1160,1218],"source":" Evaluated and returned if `argument1` evaluates to `True`."},{"content":"Required.","pos":[1235,1244]},{"content":"<ph id=\"ph1\">`Object`</ph>.","pos":[1245,1254],"source":"`Object`."},{"content":"Evaluated and returned if <ph id=\"ph1\">`argument1`</ph> evaluates to <ph id=\"ph2\">`False`</ph> or if <ph id=\"ph3\">`argument1`</ph> is a <bpt id=\"p1\">[</bpt>Nullable<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md)</ept><ph id=\"ph4\">`Boolean`</ph> variable that evaluates to <bpt id=\"p2\">[</bpt>Nothing<ept id=\"p2\">](../../../visual-basic/language-reference/nothing.md)</ept>.","pos":[1255,1541],"source":" Evaluated and returned if `argument1` evaluates to `False` or if `argument1` is a [Nullable](../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md)`Boolean` variable that evaluates to [Nothing](../../../visual-basic/language-reference/nothing.md)."},{"content":"An <ph id=\"ph1\">`If`</ph> operator that is called with three arguments works like an <ph id=\"ph2\">`IIf`</ph> function except that it uses short-circuit evaluation.","pos":[1549,1676],"source":"An `If` operator that is called with three arguments works like an `IIf` function except that it uses short-circuit evaluation."},{"content":"An <ph id=\"ph1\">`IIf`</ph> function always evaluates all three of its arguments, whereas an <ph id=\"ph2\">`If`</ph> operator that has three arguments evaluates only two of them.","pos":[1677,1817],"source":" An `IIf` function always evaluates all three of its arguments, whereas an `If` operator that has three arguments evaluates only two of them."},{"content":"The first <ph id=\"ph1\">`If`</ph> argument is evaluated and the result is cast as a <ph id=\"ph2\">`Boolean`</ph> value, <ph id=\"ph3\">`True`</ph> or <ph id=\"ph4\">`False`</ph>.","pos":[1818,1918],"source":" The first `If` argument is evaluated and the result is cast as a `Boolean` value, `True` or `False`."},{"content":"If the value is <ph id=\"ph1\">`True`</ph>, <ph id=\"ph2\">`argument2`</ph> is evaluated and its value is returned, but <ph id=\"ph3\">`argument3`</ph> is not evaluated.","pos":[1919,2028],"source":" If the value is `True`, `argument2` is evaluated and its value is returned, but `argument3` is not evaluated."},{"content":"If the value of the <ph id=\"ph1\">`Boolean`</ph> expression is <ph id=\"ph2\">`False`</ph>, <ph id=\"ph3\">`argument3`</ph> is evaluated and its value is returned, but <ph id=\"ph4\">`argument2`</ph> is not evaluated.","pos":[2029,2167],"source":" If the value of the `Boolean` expression is `False`, `argument3` is evaluated and its value is returned, but `argument2` is not evaluated."},{"content":"The following examples illustrate the use of <ph id=\"ph1\">`If`</ph> when three arguments are used:","pos":[2168,2248],"source":" The following examples illustrate the use of `If` when three arguments are used:"},{"content":"The following example illustrates the value of short-circuit evaluation.","pos":[2381,2453]},{"content":"The example shows two attempts to divide variable <ph id=\"ph1\">`number`</ph> by variable <ph id=\"ph2\">`divisor`</ph> except when <ph id=\"ph3\">`divisor`</ph> is zero.","pos":[2454,2565],"source":" The example shows two attempts to divide variable `number` by variable `divisor` except when `divisor` is zero."},{"content":"In that case, a 0 should be returned, and no attempt should be made to perform the division because a run-time error would result.","pos":[2566,2696]},{"content":"Because the <ph id=\"ph1\">`If`</ph> expression uses short-circuit evaluation, it evaluates either the second or the third argument, depending on the value of the first argument.","pos":[2697,2855],"source":" Because the `If` expression uses short-circuit evaluation, it evaluates either the second or the third argument, depending on the value of the first argument."},{"content":"If the first argument is true, the divisor is not zero and it is safe to evaluate the second argument and perform the division.","pos":[2856,2983]},{"content":"If the first argument is false, only the third argument is evaluated and a 0 is returned.","pos":[2984,3073]},{"content":"Therefore, when the divisor is 0, no attempt is made to perform the division and no error results.","pos":[3074,3172]},{"content":"However, because <ph id=\"ph1\">`IIf`</ph> does not use short-circuit evaluation, the second argument is evaluated even when the first argument is false.","pos":[3173,3306],"source":" However, because `IIf` does not use short-circuit evaluation, the second argument is evaluated even when the first argument is false."},{"content":"This causes a run-time divide-by-zero error.","pos":[3307,3351]},{"pos":[3486,3523],"content":"If Operator Called with Two Arguments","linkify":"If Operator Called with Two Arguments","nodes":[{"content":"If Operator Called with Two Arguments","pos":[0,37]}]},{"content":"The first argument to <ph id=\"ph1\">`If`</ph> can be omitted.","pos":[3527,3569],"source":"The first argument to `If` can be omitted."},{"content":"This enables the operator to be called by using only two arguments.","pos":[3570,3637]},{"content":"The following list applies only when the <ph id=\"ph1\">`If`</ph> operator is called with two arguments.","pos":[3638,3722],"source":" The following list applies only when the `If` operator is called with two arguments."},{"pos":[3731,3736],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"content":"Term","pos":[3743,3747]},{"content":"Definition","pos":[3748,3758]},{"content":"Required.","pos":[3787,3796]},{"content":"<ph id=\"ph1\">`Object`</ph>.","pos":[3797,3806],"source":"`Object`."},{"content":"Must be a reference or nullable type.","pos":[3807,3844]},{"content":"Evaluated and returned when it evaluates to anything other than <ph id=\"ph1\">`Nothing`</ph>.","pos":[3845,3919],"source":" Evaluated and returned when it evaluates to anything other than `Nothing`."},{"content":"Required.","pos":[3936,3945]},{"content":"<ph id=\"ph1\">`Object`</ph>.","pos":[3946,3955],"source":"`Object`."},{"content":"Evaluated and returned if <ph id=\"ph1\">`argument2`</ph> evaluates to <ph id=\"ph2\">`Nothing`</ph>.","pos":[3956,4017],"source":" Evaluated and returned if `argument2` evaluates to `Nothing`."},{"content":"When the <ph id=\"ph1\">`Boolean`</ph> argument is omitted, the first argument must be a reference or nullable type.","pos":[4025,4121],"source":"When the `Boolean` argument is omitted, the first argument must be a reference or nullable type."},{"content":"If the first argument evaluates to <ph id=\"ph1\">`Nothing`</ph>, the value of the second argument is returned.","pos":[4122,4213],"source":" If the first argument evaluates to `Nothing`, the value of the second argument is returned."},{"content":"In all other cases, the value of the first argument is returned.","pos":[4214,4278]},{"content":"The following example illustrates how this evaluation works.","pos":[4279,4339]},{"pos":[4474,4482],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4536,4652],"content":"<bpt id=\"p1\">[</bpt>Nullable Value Types<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md)</ept>","source":"[Nullable Value Types](../../../visual-basic/programming-guide/language-features/data-types/nullable-value-types.md)"},{"pos":[4655,4717],"content":"<bpt id=\"p1\">[</bpt>Nothing<ept id=\"p1\">](../../../visual-basic/language-reference/nothing.md)</ept>","source":"[Nothing](../../../visual-basic/language-reference/nothing.md)"}]}