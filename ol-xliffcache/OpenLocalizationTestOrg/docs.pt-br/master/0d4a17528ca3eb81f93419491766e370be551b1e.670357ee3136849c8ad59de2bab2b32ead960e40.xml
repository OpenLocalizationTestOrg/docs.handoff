{"content":"---\ntitle: \"How to: Define an Icon for a ToolBar Button\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"toolbars [Windows Forms], adding icons to buttons\"\n  - \"buttons [Windows Forms], icons\"\n  - \"examples [Windows Forms], toolbars\"\n  - \"images [Windows Forms], toolbar buttons\"\n  - \"icons [Windows Forms], toolbar buttons\"\n  - \"ToolBar control [Windows Forms], adding icons to buttons\"\nms.assetid: 84db98b4-8566-49ce-b2c8-1fd66a5eb3a0\n---\n# How to: Define an Icon for a ToolBar Button\n> [!NOTE]\n>  The <xref:System.Windows.Forms.ToolStrip> control replaces and adds functionality to the <xref:System.Windows.Forms.ToolBar> control; however, the <xref:System.Windows.Forms.ToolBar> control is retained for both backward compatibility and future use, if you choose.  \n  \n <xref:System.Windows.Forms.ToolBar> buttons are able to display icons within them for easy identification by users. This is achieved through adding images to the [ImageList Component](imagelist-component-windows-forms.md) component and then associating the <xref:System.Windows.Forms.ImageList> component with the <xref:System.Windows.Forms.ToolBar> control.  \n  \n### To set an icon for a toolbar button programmatically  \n  \n1.  In a procedure, instantiate an <xref:System.Windows.Forms.ImageList> component and a <xref:System.Windows.Forms.ToolBar> control.  \n  \n2.  In the same procedure, assign an image to the <xref:System.Windows.Forms.ImageList> component.  \n  \n3.  In the same procedure, assign the <xref:System.Windows.Forms.ImageList> control to the <xref:System.Windows.Forms.ToolBar> control and assign the <xref:System.Windows.Forms.ToolBarButton.ImageIndex%2A> property of the individual toolbar buttons.  \n  \n     In the following code example, the path set for the location of the image is the **My Documents** folder. This is done, because you can assume that most computers running the Windows operating system will include this directory. This also allows users with minimal system access levels to safely run the application. The example below assumes a form with a <xref:System.Windows.Forms.PictureBox> control already added.  \n  \n     Following the steps above, you should have written code similar to that displayed below.  \n  \n    ```vb  \n    Public Sub InitializeMyToolBar()  \n    ' Instantiate an ImageList component and a ToolBar control.  \n       Dim ToolBar1 as New ToolBar  \n       Dim ImageList1 as New ImageList  \n    ' Assign an image to the ImageList component.  \n    ' You should replace the bold image  \n    ' in the sample below with an icon of your own choosing.  \n       Dim myImage As System.Drawing.Image = _   \n          Image.FromFile Image.FromFile _  \n          (System.Environment.GetFolderPath _  \n          (System.Environment.SpecialFolder.Personal) _  \n          & \"\\Image.gif\")  \n       ImageList1.Images.Add(myImage)  \n    ' Create a ToolBarButton.  \n       Dim ToolBarButton1 As New ToolBarButton()  \n    ' Add the ToolBarButton to the ToolBar.  \n       ToolBar1.Buttons.Add(toolBarButton1)  \n    ' Assign an ImageList to the ToolBar.  \n       ToolBar1.ImageList = ImageList1  \n    ' Assign the ImageIndex property of the ToolBarButton.  \n       ToolBarButton1.ImageIndex = 0  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    public void InitializeMyToolBar()  \n    {  \n       // Instantiate an ImageList component and a ToolBar control.  \n       ToolBar toolBar1 = new  ToolBar();   \n       ImageList imageList1 = new ImageList();  \n       // Assign an image to the ImageList component.  \n       // You should replace the bold image   \n       // in the sample below with an icon of your own choosing.  \n       // Note the escape character used (@) when specifying the path.  \n       Image myImage = Image.FromFile  \n       (System.Environment.GetFolderPath  \n       (System.Environment.SpecialFolder.Personal)  \n       + @\"\\Image.gif\");  \n       imageList1.Images.Add(myImage);  \n       // Create a ToolBarButton.  \n       ToolBarButton toolBarButton1 = new ToolBarButton();  \n       // Add the ToolBarButton to the ToolBar.  \n       toolBar1.Buttons.Add(toolBarButton1);  \n       // Assign an ImageList to the ToolBar.  \n       toolBar1.ImageList = imageList1;  \n       // Assign ImageIndex property of the ToolBarButton.  \n       toolBarButton1.ImageIndex = 0;  \n    }  \n    ```  \n  \n    ```cpp  \n    public:  \n       void InitializeMyToolBar()  \n       {  \n          // Instantiate an ImageList component and a ToolBar control.  \n          ToolBar ^ toolBar1 = gcnew  ToolBar();   \n          ImageList ^ imageList1 = gcnew ImageList();  \n          // Assign an image to the ImageList component.  \n          // You should replace the bold image   \n          // in the sample below with an icon of your own choosing.  \n          Image ^ myImage = Image::FromFile(String::Concat  \n             (System::Environment::GetFolderPath  \n             (System::Environment::SpecialFolder::Personal),  \n             \"\\\\Image.gif\"));  \n          imageList1->Images->Add(myImage);  \n          // Create a ToolBarButton.  \n          ToolBarButton ^ toolBarButton1 = gcnew ToolBarButton();  \n          // Add the ToolBarButton to the ToolBar.  \n          toolBar1->Buttons->Add(toolBarButton1);  \n          // Assign an ImageList to the ToolBar.  \n          toolBar1->ImageList = imageList1;  \n          // Assign ImageIndex property of the ToolBarButton.  \n          toolBarButton1->ImageIndex = 0;  \n       }  \n    ```  \n  \n## See also\n\n- <xref:System.Windows.Forms.ToolBar>\n- [How to: Trigger Menu Events for Toolbar Buttons](how-to-trigger-menu-events-for-toolbar-buttons.md)\n- [ToolBar Control](toolbar-control-windows-forms.md)\n- [ImageList Component](imagelist-component-windows-forms.md)\n","nodes":[{"pos":[4,481],"embed":true,"restype":"x-metadata","content":"title: \"How to: Define an Icon for a ToolBar Button\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"toolbars [Windows Forms], adding icons to buttons\"\n  - \"buttons [Windows Forms], icons\"\n  - \"examples [Windows Forms], toolbars\"\n  - \"images [Windows Forms], toolbar buttons\"\n  - \"icons [Windows Forms], toolbar buttons\"\n  - \"ToolBar control [Windows Forms], adding icons to buttons\"\nms.assetid: 84db98b4-8566-49ce-b2c8-1fd66a5eb3a0","nodes":[{"content":"How to: Define an Icon for a ToolBar Button","nodes":[{"pos":[0,43],"content":"How to: Define an Icon for a ToolBar Button","nodes":[{"content":"How to: Define an Icon for a ToolBar Button","pos":[0,43]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[488,531],"content":"How to: Define an Icon for a ToolBar Button","linkify":"How to: Define an Icon for a ToolBar Button","nodes":[{"content":"How to: Define an Icon for a ToolBar Button","pos":[0,43]}]},{"pos":[534,810],"content":"[!NOTE]\n The <xref:System.Windows.Forms.ToolStrip> control replaces and adds functionality to the <xref:System.Windows.Forms.ToolBar> control; however, the <xref:System.Windows.Forms.ToolBar> control is retained for both backward compatibility and future use, if you choose.","leadings":["","> "],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolStrip&gt;</ph> control replaces and adds functionality to the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolBar&gt;</ph> control; however, the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ToolBar&gt;</ph> control is retained for both backward compatibility and future use, if you choose.","pos":[9,274],"source":"The <xref:System.Windows.Forms.ToolStrip> control replaces and adds functionality to the <xref:System.Windows.Forms.ToolBar> control; however, the <xref:System.Windows.Forms.ToolBar> control is retained for both backward compatibility and future use, if you choose."}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Forms.ToolBar&gt;</ph> buttons are able to display icons within them for easy identification by users.","pos":[817,932],"source":"<xref:System.Windows.Forms.ToolBar> buttons are able to display icons within them for easy identification by users."},{"content":"This is achieved through adding images to the <bpt id=\"p1\">[</bpt>ImageList Component<ept id=\"p1\">](imagelist-component-windows-forms.md)</ept> component and then associating the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ImageList&gt;</ph> component with the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolBar&gt;</ph> control.","pos":[933,1175],"source":" This is achieved through adding images to the [ImageList Component](imagelist-component-windows-forms.md) component and then associating the <xref:System.Windows.Forms.ImageList> component with the <xref:System.Windows.Forms.ToolBar> control."},{"pos":[1185,1237],"content":"To set an icon for a toolbar button programmatically","linkify":"To set an icon for a toolbar button programmatically","nodes":[{"content":"To set an icon for a toolbar button programmatically","pos":[0,52]}]},{"pos":[1247,1376],"content":"In a procedure, instantiate an <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ImageList&gt;</ph> component and a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolBar&gt;</ph> control.","source":"In a procedure, instantiate an <xref:System.Windows.Forms.ImageList> component and a <xref:System.Windows.Forms.ToolBar> control."},{"pos":[1386,1480],"content":"In the same procedure, assign an image to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ImageList&gt;</ph> component.","source":"In the same procedure, assign an image to the <xref:System.Windows.Forms.ImageList> component."},{"pos":[1490,1735],"content":"In the same procedure, assign the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ImageList&gt;</ph> control to the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ToolBar&gt;</ph> control and assign the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ToolBarButton.ImageIndex%2A&gt;</ph> property of the individual toolbar buttons.","source":"In the same procedure, assign the <xref:System.Windows.Forms.ImageList> control to the <xref:System.Windows.Forms.ToolBar> control and assign the <xref:System.Windows.Forms.ToolBarButton.ImageIndex%2A> property of the individual toolbar buttons."},{"content":"In the following code example, the path set for the location of the image is the <bpt id=\"p1\">**</bpt>My Documents<ept id=\"p1\">**</ept> folder.","pos":[1746,1851],"source":"In the following code example, the path set for the location of the image is the **My Documents** folder."},{"content":"This is done, because you can assume that most computers running the Windows operating system will include this directory.","pos":[1852,1974]},{"content":"This also allows users with minimal system access levels to safely run the application.","pos":[1975,2062]},{"content":"The example below assumes a form with a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.PictureBox&gt;</ph> control already added.","pos":[2063,2164],"source":" The example below assumes a form with a <xref:System.Windows.Forms.PictureBox> control already added."},{"content":"Following the steps above, you should have written code similar to that displayed below.","pos":[2175,2263]},{"pos":[5488,5496],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5538,5638],"content":"<bpt id=\"p1\">[</bpt>How to: Trigger Menu Events for Toolbar Buttons<ept id=\"p1\">](how-to-trigger-menu-events-for-toolbar-buttons.md)</ept>","source":"[How to: Trigger Menu Events for Toolbar Buttons](how-to-trigger-menu-events-for-toolbar-buttons.md)"},{"pos":[5641,5692],"content":"<bpt id=\"p1\">[</bpt>ToolBar Control<ept id=\"p1\">](toolbar-control-windows-forms.md)</ept>","source":"[ToolBar Control](toolbar-control-windows-forms.md)"},{"pos":[5695,5754],"content":"<bpt id=\"p1\">[</bpt>ImageList Component<ept id=\"p1\">](imagelist-component-windows-forms.md)</ept>","source":"[ImageList Component](imagelist-component-windows-forms.md)"}]}