{"content":"---\ntitle: \"Activity Authoring Options in WF\"\nms.date: \"03/30/2017\"\nms.assetid: b9061f5f-12c3-47f0-adbe-1330e2714c94\n---\n# Activity Authoring Options in WF\n[!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] provides several options for creating custom activities. The correct method to use for authoring a given activity depends on what run-time features are required.  \n  \n## Deciding Which Base Activity Class to Use for Authoring Custom Activities  \n The following table lists the features available in the custom activity base classes.  \n  \n|Base activity class|Features available|  \n|-------------------------|------------------------|  \n|<xref:System.Activities.Activity>|Composes groups of system-provided and custom activities into a composite activity.|  \n|<xref:System.Activities.CodeActivity>|Implements imperative functionality by providing an <xref:System.Activities.CodeActivity%601.Execute%2A> method that can be overridden. Also provides access to tracking, variables, and arguments..|  \n|<xref:System.Activities.NativeActivity>|Provides all of the features of <xref:System.Activities.CodeActivity>, plus aborting activity execution, canceling child activity execution, using bookmarks, and scheduling activities, activity actions, and functions.|  \n|<xref:System.Activities.DynamicActivity>|Provides a DOM-like approach to constructing activities that interfaces with the WF designer and the run-time machinery through <xref:System.ComponentModel.ICustomTypeDescriptor>, allowing new activities to be created without defining new types.|  \n  \n## Authoring Activities using Activity  \n Activities that derive from <xref:System.Activities.Activity> compose functionality by assembling other existing activities. These activities can be existing custom activities and activities from the [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] activity library. Assembling these activities is the most basic way to create custom functionality. This approach is most typically taken when using a visual design environment for authoring workflows.  \n  \n## Authoring Activities using CodeActivity or AsyncCodeActivity  \n Activities that derive from <xref:System.Activities.CodeActivity> or <xref:System.Activities.AsyncCodeActivity> can implement imperative functionality by overriding the <xref:System.Activities.CodeActivity%601.Execute%2A> method with custom imperative code. The custom code is executed when the activity is executed by the runtime. While activities created in this way have access to custom functionality, they do not have access to all of the features of the runtime, such as full access to the execution environment, the ability to schedule child activities, bookmark creation, or support for a Cancel or Abort method. When a <xref:System.Activities.CodeActivity> executes, it has access to a reduced version of the execution environment (through the <xref:System.Activities.CodeActivityContext> or <xref:System.Activities.AsyncCodeActivityContext> class). Activities created using <xref:System.Activities.CodeActivity> have access to argument and variable resolution, extensions, and tracking. Asynchronous activity scheduling can be done using <xref:System.Activities.AsyncCodeActivity>.  \n  \n## Authoring Activities using NativeActivity  \n Activities that derive from <xref:System.Activities.NativeActivity>, like those that derive from <xref:System.Activities.CodeActivity>, create imperative functionality by overriding <xref:System.Activities.NativeActivity.Execute%2A>, but also have access to all of the functionality of the workflow runtime through the <xref:System.Activities.NativeActivityContext> that gets passed into the <xref:System.Activities.NativeActivity.Execute%2A> method. This context has support for scheduling and canceling child activities, executing <xref:System.Activities.ActivityAction> and <xref:System.Activities.ActivityFunc%601> objects, flowing transactions into a workflow, invoking asynchronous processes, canceling and aborting execution, access to execution properties and extensions, and bookmarks (handles for resuming paused workflows).  \n  \n## Authoring Activities using DynamicActivity  \n Unlike the other three types of activity, new functionality is not created by deriving new types from <xref:System.Activities.DynamicActivity> (the class is sealed), but instead, by assembling functionality into the <xref:System.Activities.DynamicActivity.Properties%2A> and <xref:System.Activities.DynamicActivity.Implementation%2A> properties using an activity document object model (DOM).  \n  \n## Authoring Activities that Return a Result  \n Many activities must return a result after their execution. Although it is possible to always define a custom <xref:System.Activities.OutArgument%601> on an activity for this purpose, it is suggested to instead use <xref:System.Activities.Activity%601>, or derive from <xref:System.Activities.CodeActivity%601> or <xref:System.Activities.NativeActivity%601>. Each of these base classes has an <xref:System.Activities.OutArgument%601> named Result that your activity can use for its return value. Activities that return a result should only be used if only one result needs to be returned from an activity; if multiple results need to be returned, separate <xref:System.Activities.OutArgument%601> members should be used instead.\n","nodes":[{"pos":[4,116],"embed":true,"restype":"x-metadata","content":"title: \"Activity Authoring Options in WF\"\nms.date: \"03/30/2017\"\nms.assetid: b9061f5f-12c3-47f0-adbe-1330e2714c94","nodes":[{"content":"Activity Authoring Options in WF","nodes":[{"pos":[0,32],"content":"Activity Authoring Options in WF","nodes":[{"content":"Activity Authoring Options in WF","pos":[0,32]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[123,155],"content":"Activity Authoring Options in WF","linkify":"Activity Authoring Options in WF","nodes":[{"content":"Activity Authoring Options in WF","pos":[0,32]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)]</ph> provides several options for creating custom activities.","pos":[156,287],"source":"[!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] provides several options for creating custom activities."},{"content":"The correct method to use for authoring a given activity depends on what run-time features are required.","pos":[288,392]},{"pos":[401,474],"content":"Deciding Which Base Activity Class to Use for Authoring Custom Activities","linkify":"Deciding Which Base Activity Class to Use for Authoring Custom Activities","nodes":[{"content":"Deciding Which Base Activity Class to Use for Authoring Custom Activities","pos":[0,73]}]},{"content":"The following table lists the features available in the custom activity base classes.","pos":[478,563]},{"content":"Base activity class","pos":[570,589]},{"content":"Features available","pos":[590,608]},{"content":"Composes groups of system-provided and custom activities into a composite activity.","pos":[702,785]},{"content":"Implements imperative functionality by providing an <ph id=\"ph1\">&lt;xref:System.Activities.CodeActivity%601.Execute%2A&gt;</ph> method that can be overridden.","pos":[828,963],"source":"Implements imperative functionality by providing an <xref:System.Activities.CodeActivity%601.Execute%2A> method that can be overridden."},{"content":"Also provides access to tracking, variables, and arguments..","pos":[964,1024]},{"pos":[1069,1286],"content":"Provides all of the features of <ph id=\"ph1\">&lt;xref:System.Activities.CodeActivity&gt;</ph>, plus aborting activity execution, canceling child activity execution, using bookmarks, and scheduling activities, activity actions, and functions.","source":"Provides all of the features of <xref:System.Activities.CodeActivity>, plus aborting activity execution, canceling child activity execution, using bookmarks, and scheduling activities, activity actions, and functions."},{"pos":[1332,1577],"content":"Provides a DOM-like approach to constructing activities that interfaces with the WF designer and the run-time machinery through <ph id=\"ph1\">&lt;xref:System.ComponentModel.ICustomTypeDescriptor&gt;</ph>, allowing new activities to be created without defining new types.","source":"Provides a DOM-like approach to constructing activities that interfaces with the WF designer and the run-time machinery through <xref:System.ComponentModel.ICustomTypeDescriptor>, allowing new activities to be created without defining new types."},{"pos":[1587,1622],"content":"Authoring Activities using Activity","linkify":"Authoring Activities using Activity","nodes":[{"content":"Authoring Activities using Activity","pos":[0,35]}]},{"content":"Activities that derive from <ph id=\"ph1\">&lt;xref:System.Activities.Activity&gt;</ph> compose functionality by assembling other existing activities.","pos":[1626,1750],"source":"Activities that derive from <xref:System.Activities.Activity> compose functionality by assembling other existing activities."},{"content":"These activities can be existing custom activities and activities from the <ph id=\"ph1\">[!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)]</ph> activity library.","pos":[1751,1918],"source":" These activities can be existing custom activities and activities from the [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] activity library."},{"content":"Assembling these activities is the most basic way to create custom functionality.","pos":[1919,2000]},{"content":"This approach is most typically taken when using a visual design environment for authoring workflows.","pos":[2001,2102]},{"pos":[2111,2171],"content":"Authoring Activities using CodeActivity or AsyncCodeActivity","linkify":"Authoring Activities using CodeActivity or AsyncCodeActivity","nodes":[{"content":"Authoring Activities using CodeActivity or AsyncCodeActivity","pos":[0,60]}]},{"content":"Activities that derive from <ph id=\"ph1\">&lt;xref:System.Activities.CodeActivity&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Activities.AsyncCodeActivity&gt;</ph> can implement imperative functionality by overriding the <ph id=\"ph3\">&lt;xref:System.Activities.CodeActivity%601.Execute%2A&gt;</ph> method with custom imperative code.","pos":[2175,2432],"source":"Activities that derive from <xref:System.Activities.CodeActivity> or <xref:System.Activities.AsyncCodeActivity> can implement imperative functionality by overriding the <xref:System.Activities.CodeActivity%601.Execute%2A> method with custom imperative code."},{"content":"The custom code is executed when the activity is executed by the runtime.","pos":[2433,2506]},{"content":"While activities created in this way have access to custom functionality, they do not have access to all of the features of the runtime, such as full access to the execution environment, the ability to schedule child activities, bookmark creation, or support for a Cancel or Abort method.","pos":[2507,2795]},{"content":"When a <ph id=\"ph1\">&lt;xref:System.Activities.CodeActivity&gt;</ph> executes, it has access to a reduced version of the execution environment (through the <ph id=\"ph2\">&lt;xref:System.Activities.CodeActivityContext&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Activities.AsyncCodeActivityContext&gt;</ph> class).","pos":[2796,3033],"source":" When a <xref:System.Activities.CodeActivity> executes, it has access to a reduced version of the execution environment (through the <xref:System.Activities.CodeActivityContext> or <xref:System.Activities.AsyncCodeActivityContext> class)."},{"content":"Activities created using <ph id=\"ph1\">&lt;xref:System.Activities.CodeActivity&gt;</ph> have access to argument and variable resolution, extensions, and tracking.","pos":[3034,3171],"source":" Activities created using <xref:System.Activities.CodeActivity> have access to argument and variable resolution, extensions, and tracking."},{"content":"Asynchronous activity scheduling can be done using <ph id=\"ph1\">&lt;xref:System.Activities.AsyncCodeActivity&gt;</ph>.","pos":[3172,3266],"source":" Asynchronous activity scheduling can be done using <xref:System.Activities.AsyncCodeActivity>."},{"pos":[3275,3316],"content":"Authoring Activities using NativeActivity","linkify":"Authoring Activities using NativeActivity","nodes":[{"content":"Authoring Activities using NativeActivity","pos":[0,41]}]},{"content":"Activities that derive from <ph id=\"ph1\">&lt;xref:System.Activities.NativeActivity&gt;</ph>, like those that derive from <ph id=\"ph2\">&lt;xref:System.Activities.CodeActivity&gt;</ph>, create imperative functionality by overriding <ph id=\"ph3\">&lt;xref:System.Activities.NativeActivity.Execute%2A&gt;</ph>, but also have access to all of the functionality of the workflow runtime through the <ph id=\"ph4\">&lt;xref:System.Activities.NativeActivityContext&gt;</ph> that gets passed into the <ph id=\"ph5\">&lt;xref:System.Activities.NativeActivity.Execute%2A&gt;</ph> method.","pos":[3320,3770],"source":"Activities that derive from <xref:System.Activities.NativeActivity>, like those that derive from <xref:System.Activities.CodeActivity>, create imperative functionality by overriding <xref:System.Activities.NativeActivity.Execute%2A>, but also have access to all of the functionality of the workflow runtime through the <xref:System.Activities.NativeActivityContext> that gets passed into the <xref:System.Activities.NativeActivity.Execute%2A> method."},{"content":"This context has support for scheduling and canceling child activities, executing <ph id=\"ph1\">&lt;xref:System.Activities.ActivityAction&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Activities.ActivityFunc%601&gt;</ph> objects, flowing transactions into a workflow, invoking asynchronous processes, canceling and aborting execution, access to execution properties and extensions, and bookmarks (handles for resuming paused workflows).","pos":[3771,4154],"source":" This context has support for scheduling and canceling child activities, executing <xref:System.Activities.ActivityAction> and <xref:System.Activities.ActivityFunc%601> objects, flowing transactions into a workflow, invoking asynchronous processes, canceling and aborting execution, access to execution properties and extensions, and bookmarks (handles for resuming paused workflows)."},{"pos":[4163,4205],"content":"Authoring Activities using DynamicActivity","linkify":"Authoring Activities using DynamicActivity","nodes":[{"content":"Authoring Activities using DynamicActivity","pos":[0,42]}]},{"pos":[4209,4600],"content":"Unlike the other three types of activity, new functionality is not created by deriving new types from <ph id=\"ph1\">&lt;xref:System.Activities.DynamicActivity&gt;</ph> (the class is sealed), but instead, by assembling functionality into the <ph id=\"ph2\">&lt;xref:System.Activities.DynamicActivity.Properties%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Activities.DynamicActivity.Implementation%2A&gt;</ph> properties using an activity document object model (DOM).","source":"Unlike the other three types of activity, new functionality is not created by deriving new types from <xref:System.Activities.DynamicActivity> (the class is sealed), but instead, by assembling functionality into the <xref:System.Activities.DynamicActivity.Properties%2A> and <xref:System.Activities.DynamicActivity.Implementation%2A> properties using an activity document object model (DOM)."},{"pos":[4609,4650],"content":"Authoring Activities that Return a Result","linkify":"Authoring Activities that Return a Result","nodes":[{"content":"Authoring Activities that Return a Result","pos":[0,41]}]},{"content":"Many activities must return a result after their execution.","pos":[4654,4713]},{"content":"Although it is possible to always define a custom <ph id=\"ph1\">&lt;xref:System.Activities.OutArgument%601&gt;</ph> on an activity for this purpose, it is suggested to instead use <ph id=\"ph2\">&lt;xref:System.Activities.Activity%601&gt;</ph>, or derive from <ph id=\"ph3\">&lt;xref:System.Activities.CodeActivity%601&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Activities.NativeActivity%601&gt;</ph>.","pos":[4714,5012],"source":" Although it is possible to always define a custom <xref:System.Activities.OutArgument%601> on an activity for this purpose, it is suggested to instead use <xref:System.Activities.Activity%601>, or derive from <xref:System.Activities.CodeActivity%601> or <xref:System.Activities.NativeActivity%601>."},{"content":"Each of these base classes has an <ph id=\"ph1\">&lt;xref:System.Activities.OutArgument%601&gt;</ph> named Result that your activity can use for its return value.","pos":[5013,5149],"source":" Each of these base classes has an <xref:System.Activities.OutArgument%601> named Result that your activity can use for its return value."},{"content":"Activities that return a result should only be used if only one result needs to be returned from an activity; if multiple results need to be returned, separate <ph id=\"ph1\">&lt;xref:System.Activities.OutArgument%601&gt;</ph> members should be used instead.","pos":[5150,5382],"source":" Activities that return a result should only be used if only one result needs to be returned from an activity; if multiple results need to be returned, separate <xref:System.Activities.OutArgument%601> members should be used instead."}]}