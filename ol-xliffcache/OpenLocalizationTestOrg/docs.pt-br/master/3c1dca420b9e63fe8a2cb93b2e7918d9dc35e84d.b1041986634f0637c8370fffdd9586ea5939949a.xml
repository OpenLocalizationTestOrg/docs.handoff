{"content":"---\ntitle: \"How to: Create Event Handlers at Run Time for Windows Forms\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"Windows Forms, event handling\"\n  - \"event handlers [Windows Forms], creating\"\n  - \"run time [Windows Forms], creating event handlers at\"\n  - \"examples [Windows Forms], event handling\"\n  - \"Button control [Windows Forms], event handlers\"\nms.assetid: 2e7c9e1a-61fe-444d-8113-3c5bacf1c8cb\n---\n# How to: Create Event Handlers at Run Time for Windows Forms\nIn addition to creating events using the Windows Forms Designer, you can also create an event handler at run time. This action allows you to connect event handlers based on conditions in code at run time as opposed to having them connected when the program initially starts.  \n  \n### To create an event handler at run time  \n  \n1.  Open the form in the Code Editor that you want to add an event handler to.  \n  \n2.  Add a method to your form with the method signature for the event that you want to handle.  \n  \n     For example, if you were handling the <xref:System.Windows.Forms.Control.Click> event of a <xref:System.Windows.Forms.Button> control, you would create a method such as the following:  \n  \n    ```vb  \n    Private Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs)  \n       ' Add event handler code here.  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    private void button1_Click(object sender, System.EventArgs e)   \n    {  \n    // Add event handler code here.  \n    }  \n    ```  \n  \n    ```cpp  \n    private:  \n       void button1_Click(System::Object ^ sender,   \n          System::EventArgs ^ e)  \n       {  \n          // Add event handler code here.  \n       }  \n    ```  \n  \n3.  Add code to the event handler as appropriate to your application.  \n  \n4.  Determine which form or control you want to create an event handler for.  \n  \n5.  In a method within your form's class, add code that specifies the event handler to handle the event. For example, the following code specifies the event handler `button1_Click` handles the <xref:System.Windows.Forms.Control.Click> event of a <xref:System.Windows.Forms.Button> control:  \n  \n    ```vb  \n    AddHandler Button1.Click, AddressOf Button1_Click  \n    ```  \n  \n    ```csharp  \n    button1.Click += new EventHandler(button1_Click);  \n    ```  \n  \n    ```cpp  \n    button1->Click += gcnew System::EventHandler(this, &Form1::button1_Click);  \n    ```  \n  \n     The <xref:System.ComponentModel.EventHandlerList.AddHandler%2A> method demonstrated in the Visual Basic code above establishes a click event handler for the button.  \n  \n## See also\n\n- [Creating Event Handlers in Windows Forms](creating-event-handlers-in-windows-forms.md)\n- [Event Handlers Overview](event-handlers-overview-windows-forms.md)\n- [Troubleshooting Inherited Event Handlers in Visual Basic](~/docs/visual-basic/programming-guide/language-features/events/troubleshooting-inherited-event-handlers.md)\n","nodes":[{"pos":[4,451],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create Event Handlers at Run Time for Windows Forms\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"Windows Forms, event handling\"\n  - \"event handlers [Windows Forms], creating\"\n  - \"run time [Windows Forms], creating event handlers at\"\n  - \"examples [Windows Forms], event handling\"\n  - \"Button control [Windows Forms], event handlers\"\nms.assetid: 2e7c9e1a-61fe-444d-8113-3c5bacf1c8cb","nodes":[{"content":"How to: Create Event Handlers at Run Time for Windows Forms","nodes":[{"pos":[0,59],"content":"How to: Create Event Handlers at Run Time for Windows Forms","nodes":[{"content":"How to: Create Event Handlers at Run Time for Windows Forms","pos":[0,59]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[458,517],"content":"How to: Create Event Handlers at Run Time for Windows Forms","linkify":"How to: Create Event Handlers at Run Time for Windows Forms","nodes":[{"content":"How to: Create Event Handlers at Run Time for Windows Forms","pos":[0,59]}]},{"content":"In addition to creating events using the Windows Forms Designer, you can also create an event handler at run time.","pos":[518,632]},{"content":"This action allows you to connect event handlers based on conditions in code at run time as opposed to having them connected when the program initially starts.","pos":[633,792]},{"pos":[802,840],"content":"To create an event handler at run time","linkify":"To create an event handler at run time","nodes":[{"content":"To create an event handler at run time","pos":[0,38]}]},{"content":"Open the form in the Code Editor that you want to add an event handler to.","pos":[850,924]},{"content":"Add a method to your form with the method signature for the event that you want to handle.","pos":[934,1024]},{"pos":[1035,1218],"content":"For example, if you were handling the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event of a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Button&gt;</ph> control, you would create a method such as the following:","source":"For example, if you were handling the <xref:System.Windows.Forms.Control.Click> event of a <xref:System.Windows.Forms.Button> control, you would create a method such as the following:"},{"content":"Add code to the event handler as appropriate to your application.","pos":[1733,1798]},{"content":"Determine which form or control you want to create an event handler for.","pos":[1808,1880]},{"content":"In a method within your form's class, add code that specifies the event handler to handle the event.","pos":[1890,1990]},{"content":"For example, the following code specifies the event handler <ph id=\"ph1\">`button1_Click`</ph> handles the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event of a <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Button&gt;</ph> control:","pos":[1991,2175],"source":" For example, the following code specifies the event handler `button1_Click` handles the <xref:System.Windows.Forms.Control.Click> event of a <xref:System.Windows.Forms.Button> control:"},{"pos":[2459,2623],"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.EventHandlerList.AddHandler%2A&gt;</ph> method demonstrated in the Visual Basic code above establishes a click event handler for the button.","source":"The <xref:System.ComponentModel.EventHandlerList.AddHandler%2A> method demonstrated in the Visual Basic code above establishes a click event handler for the button."},{"pos":[2632,2640],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2644,2731],"content":"<bpt id=\"p1\">[</bpt>Creating Event Handlers in Windows Forms<ept id=\"p1\">](creating-event-handlers-in-windows-forms.md)</ept>","source":"[Creating Event Handlers in Windows Forms](creating-event-handlers-in-windows-forms.md)"},{"pos":[2734,2801],"content":"<bpt id=\"p1\">[</bpt>Event Handlers Overview<ept id=\"p1\">](event-handlers-overview-windows-forms.md)</ept>","source":"[Event Handlers Overview](event-handlers-overview-windows-forms.md)"},{"pos":[2804,2970],"content":"<bpt id=\"p1\">[</bpt>Troubleshooting Inherited Event Handlers in Visual Basic<ept id=\"p1\">](~/docs/visual-basic/programming-guide/language-features/events/troubleshooting-inherited-event-handlers.md)</ept>","source":"[Troubleshooting Inherited Event Handlers in Visual Basic](~/docs/visual-basic/programming-guide/language-features/events/troubleshooting-inherited-event-handlers.md)"}]}