{"content":"---\ntitle: \"LINQ to XML Overview (C#)\"\nms.date: 10/30/2018\nms.assetid: 716b94d3-0091-4de1-8e05-41bc069fa9dd\n---\n# LINQ to XML Overview (C#)\nXML has been widely adopted as a way to format data in many contexts. For example, you can find XML on the Web, in configuration files, in Microsoft Office Word files, and in databases.  \n  \n [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is an up-to-date, redesigned approach to programming with XML. It provides the in-memory document modification capabilities of the Document Object Model (DOM), and supports [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query expressions. Although these query expressions are syntactically different from XPath, they provide similar functionality.  \n  \n## LINQ to XML Developers  \n [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] targets a variety of developers. For an average developer who just wants to get something done, [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] makes XML easier by providing a query experience that is similar to SQL. With just a bit of study, programmers can learn to write succinct and powerful queries in their programming language of choice.  \n  \n Professional developers can use [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] to greatly increase their productivity. With [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], they can write less code that is more expressive, more compact, and more powerful. They can use query expressions from multiple data domains at the same time.  \n  \n## What Is LINQ to XML?  \n [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is a LINQ-enabled, in-memory XML programming interface that enables you to work with XML from within the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] programming languages.  \n  \n [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is like the Document Object Model (DOM) in that it brings the XML document into memory. You can query and modify the document, and after you modify it you can save it to a file or serialize it and send it over the Internet. However, [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] differs from DOM: It provides a new object model that is lighter weight and easier to work with, and that takes advantage of language features in C#.  \n  \n The most important advantage of [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is its integration with [!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)]. This integration enables you to write queries on the in-memory XML document to retrieve collections of elements and attributes. The query capability of [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is comparable in functionality (although not in syntax) to XPath and XQuery. The integration of [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] in C# provides stronger typing, compile-time checking, and improved debugger support.  \n  \n Another advantage of [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is the ability to use query results as parameters to <xref:System.Xml.Linq.XElement> and <xref:System.Xml.Linq.XAttribute> object constructors enables a powerful approach to creating XML trees. This approach, called *functional construction*, enables developers to easily transform XML trees from one shape to another.  \n  \n For example, you might have a typical XML purchase order as described in [Sample XML File: Typical Purchase Order (LINQ to XML)](sample-xml-file-typical-purchase-order-linq-to-xml-1.md). By using [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], you could run the following query to obtain the part number attribute value for every item element in the purchase order:  \n  \n```csharp\n// Load the XML file from our project directory containing the purchase orders\nvar filename = \"PurchaseOrder.xml\";\nvar currentDirectory = Directory.GetCurrentDirectory();\nvar purchaseOrderFilepath = Path.Combine(currentDirectory, filename);\n\nXElement purchaseOrder = XElement.Load($\"{purchaseOrderFilepath}\");\n\nIEnumerable<string> partNos =  from item in purchaseOrder.Descendants(\"Item\")  \n                               select (string) item.Attribute(\"PartNumber\");  \n``` \nThis can be rewritten in method syntax form:\n\n```csharp\nIEnumerable<string> partNos = purchaseOrder.Descendants(\"Item\").Select(x => (string) x.Attribute(\"PartNumber\"));\n```\n\nAs another example, you might want a list, sorted by part number, of the items with a value greater than $100. To obtain this information, you could run the following query:  \n  \n```csharp \n// Load the XML file from our project directory containing the purchase orders\nvar filename = \"PurchaseOrder.xml\";\nvar currentDirectory = Directory.GetCurrentDirectory();\nvar purchaseOrderFilepath = Path.Combine(currentDirectory, filename);\n\nXElement purchaseOrder = XElement.Load($\"{purchaseOrderFilepath}\");\n\nIEnumerable<XElement> pricesByPartNos =  from item in purchaseOrder.Descendants(\"Item\")  \n                                 where (int) item.Element(\"Quantity\") * (decimal) item.Element(\"USPrice\") > 100  \n                                 orderby (string)item.Element(\"PartNumber\")  \n                                 select item;  \n```  \n\nAgain, this can be rewritten in method syntax form:\n\n```csharp\nIEnumerable<XElement> pricesByPartNos = purchaseOrder.Descendants(\"Item\")\n                                        .Where(item => (int)item.Element(\"Quantity\") * (decimal)item.Element(\"USPrice\") > 100)\n                                        .OrderBy(order => order.Element(\"PartNumber\"));\n```\n\n In addition to these [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] capabilities, [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] provides an improved XML programming interface. Using [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], you can:  \n  \n-   Load XML from [files](how-to-load-xml-from-a-file.md) or [streams](how-to-stream-xml-fragments-from-an-xmlreader.md).  \n  \n-   Serialize XML to files or streams.  \n  \n-   Create XML from scratch by using functional construction.  \n  \n-   Query XML using XPath-like axes.  \n  \n-   Manipulate the in-memory XML tree by using methods such as <xref:System.Xml.Linq.XContainer.Add%2A>, <xref:System.Xml.Linq.XNode.Remove%2A>, <xref:System.Xml.Linq.XNode.ReplaceWith%2A>, and <xref:System.Xml.Linq.XElement.SetValue%2A>.  \n  \n-   Validate XML trees using XSD.  \n  \n-   Use a combination of these features to transform XML trees from one shape into another.  \n  \n## Creating XML Trees  \n One of the most significant advantages of programming with [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is that it is easy to create XML trees. For example, to create a small XML tree, you can write code as follows:  \n  \n```csharp  \nXElement contacts =  \nnew XElement(\"Contacts\",  \n    new XElement(\"Contact\",  \n        new XElement(\"Name\", \"Patrick Hines\"),  \n        new XElement(\"Phone\", \"206-555-0144\",   \n            new XAttribute(\"Type\", \"Home\")),  \n        new XElement(\"phone\", \"425-555-0145\",  \n            new XAttribute(\"Type\", \"Work\")),  \n        new XElement(\"Address\",  \n            new XElement(\"Street1\", \"123 Main St\"),  \n            new XElement(\"City\", \"Mercer Island\"),  \n            new XElement(\"State\", \"WA\"),  \n            new XElement(\"Postal\", \"68042\")  \n        )  \n    )  \n);  \n```  \n  \n For more information, see [Creating XML Trees (C#)](../../../../csharp/programming-guide/concepts/linq/creating-xml-trees.md).  \n  \n## See also\n\n- <xref:System.Xml.Linq>\n- [Getting Started (LINQ to XML)](../../../../csharp/programming-guide/concepts/linq/getting-started-linq-to-xml.md)\n","nodes":[{"pos":[4,107],"embed":true,"restype":"x-metadata","content":"title: \"LINQ to XML Overview (C#)\"\nms.date: 10/30/2018\nms.assetid: 716b94d3-0091-4de1-8e05-41bc069fa9dd","nodes":[{"content":"LINQ to XML Overview (C#)","nodes":[{"pos":[0,25],"content":"LINQ to XML Overview (C#)","nodes":[{"content":"LINQ to XML Overview (C#)","pos":[0,25]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[114,139],"content":"LINQ to XML Overview (C#)","linkify":"LINQ to XML Overview (C#)","nodes":[{"content":"LINQ to XML Overview (C#)","pos":[0,25]}]},{"content":"XML has been widely adopted as a way to format data in many contexts.","pos":[140,209]},{"content":"For example, you can find XML on the Web, in configuration files, in Microsoft Office Word files, and in databases.","pos":[210,325]},{"content":"<ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> is an up-to-date, redesigned approach to programming with XML.","pos":[332,448],"source":"[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is an up-to-date, redesigned approach to programming with XML."},{"content":"It provides the in-memory document modification capabilities of the Document Object Model (DOM), and supports <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> query expressions.","pos":[449,627],"source":" It provides the in-memory document modification capabilities of the Document Object Model (DOM), and supports [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query expressions."},{"content":"Although these query expressions are syntactically different from XPath, they provide similar functionality.","pos":[628,736]},{"pos":[745,767],"content":"LINQ to XML Developers","linkify":"LINQ to XML Developers","nodes":[{"content":"LINQ to XML Developers","pos":[0,22]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> targets a variety of developers.","pos":[771,857],"source":"[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] targets a variety of developers."},{"content":"For an average developer who just wants to get something done, <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> makes XML easier by providing a query experience that is similar to SQL.","pos":[858,1047],"source":" For an average developer who just wants to get something done, [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] makes XML easier by providing a query experience that is similar to SQL."},{"content":"With just a bit of study, programmers can learn to write succinct and powerful queries in their programming language of choice.","pos":[1048,1175]},{"content":"Professional developers can use <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> to greatly increase their productivity.","pos":[1182,1307],"source":"Professional developers can use [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] to greatly increase their productivity."},{"content":"With <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph>, they can write less code that is more expressive, more compact, and more powerful.","pos":[1308,1450],"source":" With [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], they can write less code that is more expressive, more compact, and more powerful."},{"content":"They can use query expressions from multiple data domains at the same time.","pos":[1451,1526]},{"pos":[1535,1555],"content":"What Is LINQ to XML?","linkify":"What Is LINQ to XML?","nodes":[{"content":"What Is LINQ to XML?","pos":[0,20]}]},{"pos":[1559,1794],"content":"<ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> is a LINQ-enabled, in-memory XML programming interface that enables you to work with XML from within the <ph id=\"ph2\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph> programming languages.","source":"[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is a LINQ-enabled, in-memory XML programming interface that enables you to work with XML from within the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] programming languages."},{"content":"<ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> is like the Document Object Model (DOM) in that it brings the XML document into memory.","pos":[1801,1942],"source":"[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is like the Document Object Model (DOM) in that it brings the XML document into memory."},{"content":"You can query and modify the document, and after you modify it you can save it to a file or serialize it and send it over the Internet.","pos":[1943,2078]},{"content":"However, <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> differs from DOM: It provides a new object model that is lighter weight and easier to work with, and that takes advantage of language features in C#.","pos":[2079,2291],"source":" However, [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] differs from DOM: It provides a new object model that is lighter weight and easier to work with, and that takes advantage of language features in C#."},{"content":"The most important advantage of <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> is its integration with <ph id=\"ph2\">[!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)]</ph>.","pos":[2298,2464],"source":"The most important advantage of [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is its integration with [!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)]."},{"content":"This integration enables you to write queries on the in-memory XML document to retrieve collections of elements and attributes.","pos":[2465,2592]},{"content":"The query capability of <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> is comparable in functionality (although not in syntax) to XPath and XQuery.","pos":[2593,2747],"source":" The query capability of [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is comparable in functionality (although not in syntax) to XPath and XQuery."},{"content":"The integration of <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> in C# provides stronger typing, compile-time checking, and improved debugger support.","pos":[2748,2902],"source":" The integration of [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] in C# provides stronger typing, compile-time checking, and improved debugger support."},{"content":"Another advantage of <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> is the ability to use query results as parameters to <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XAttribute&gt;</ph> object constructors enables a powerful approach to creating XML trees.","pos":[2909,3177],"source":"Another advantage of [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is the ability to use query results as parameters to <xref:System.Xml.Linq.XElement> and <xref:System.Xml.Linq.XAttribute> object constructors enables a powerful approach to creating XML trees."},{"content":"This approach, called <bpt id=\"p1\">*</bpt>functional construction<ept id=\"p1\">*</ept>, enables developers to easily transform XML trees from one shape to another.","pos":[3178,3302],"source":" This approach, called *functional construction*, enables developers to easily transform XML trees from one shape to another."},{"content":"For example, you might have a typical XML purchase order as described in <bpt id=\"p1\">[</bpt>Sample XML File: Typical Purchase Order (LINQ to XML)<ept id=\"p1\">](sample-xml-file-typical-purchase-order-linq-to-xml-1.md)</ept>.","pos":[3309,3495],"source":"For example, you might have a typical XML purchase order as described in [Sample XML File: Typical Purchase Order (LINQ to XML)](sample-xml-file-typical-purchase-order-linq-to-xml-1.md)."},{"content":"By using <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph>, you could run the following query to obtain the part number attribute value for every item element in the purchase order:","pos":[3496,3681],"source":" By using [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], you could run the following query to obtain the part number attribute value for every item element in the purchase order:"},{"content":"This can be rewritten in method syntax form:","pos":[4172,4216]},{"content":"As another example, you might want a list, sorted by part number, of the items with a value greater than $100.","pos":[4346,4456]},{"content":"To obtain this information, you could run the following query:","pos":[4457,4519]},{"content":"Again, this can be rewritten in method syntax form:","pos":[5184,5235]},{"content":"In addition to these <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> capabilities, <ph id=\"ph2\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> provides an improved XML programming interface.","pos":[5542,5728],"source":"In addition to these [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] capabilities, [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] provides an improved XML programming interface."},{"content":"Using <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph>, you can:","pos":[5729,5798],"source":" Using [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], you can:"},{"pos":[5808,5925],"content":"Load XML from <bpt id=\"p1\">[</bpt>files<ept id=\"p1\">](how-to-load-xml-from-a-file.md)</ept> or <bpt id=\"p2\">[</bpt>streams<ept id=\"p2\">](how-to-stream-xml-fragments-from-an-xmlreader.md)</ept>.","source":"Load XML from [files](how-to-load-xml-from-a-file.md) or [streams](how-to-stream-xml-fragments-from-an-xmlreader.md)."},{"content":"Serialize XML to files or streams.","pos":[5935,5969]},{"content":"Create XML from scratch by using functional construction.","pos":[5979,6036]},{"content":"Query XML using XPath-like axes.","pos":[6046,6078]},{"pos":[6088,6322],"content":"Manipulate the in-memory XML tree by using methods such as <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XContainer.Add%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XNode.Remove%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XNode.ReplaceWith%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Xml.Linq.XElement.SetValue%2A&gt;</ph>.","source":"Manipulate the in-memory XML tree by using methods such as <xref:System.Xml.Linq.XContainer.Add%2A>, <xref:System.Xml.Linq.XNode.Remove%2A>, <xref:System.Xml.Linq.XNode.ReplaceWith%2A>, and <xref:System.Xml.Linq.XElement.SetValue%2A>."},{"content":"Validate XML trees using XSD.","pos":[6332,6361]},{"content":"Use a combination of these features to transform XML trees from one shape into another.","pos":[6371,6458]},{"pos":[6467,6485],"content":"Creating XML Trees","linkify":"Creating XML Trees","nodes":[{"content":"Creating XML Trees","pos":[0,18]}]},{"content":"One of the most significant advantages of programming with <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> is that it is easy to create XML trees.","pos":[6489,6641],"source":"One of the most significant advantages of programming with [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is that it is easy to create XML trees."},{"content":"For example, to create a small XML tree, you can write code as follows:","pos":[6642,6713]},{"pos":[7315,7441],"content":"For more information, see <bpt id=\"p1\">[</bpt>Creating XML Trees (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/creating-xml-trees.md)</ept>.","source":"For more information, see [Creating XML Trees (C#)](../../../../csharp/programming-guide/concepts/linq/creating-xml-trees.md)."},{"pos":[7450,7458],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7487,7601],"content":"<bpt id=\"p1\">[</bpt>Getting Started (LINQ to XML)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/getting-started-linq-to-xml.md)</ept>","source":"[Getting Started (LINQ to XML)](../../../../csharp/programming-guide/concepts/linq/getting-started-linq-to-xml.md)"}]}