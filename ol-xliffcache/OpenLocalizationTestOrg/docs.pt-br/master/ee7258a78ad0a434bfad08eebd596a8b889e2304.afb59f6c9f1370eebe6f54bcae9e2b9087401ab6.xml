{"content":"---\ntitle: \"Walkthrough: Implementing Inheritance with COM Objects (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"inheritance [Visual Basic], COM reusability\"\n  - \"base classes [Visual Basic], COM reusability\"\n  - \"inheritance [Visual Basic], walkthroughs\"\n  - \"derived classes [Visual Basic], COM reusability\"\nms.assetid: f8e7263a-de13-48d1-b67c-ca1adf3544d9\n---\n# Walkthrough: Implementing Inheritance with COM Objects (Visual Basic)\nYou can derive Visual Basic classes from `Public` classes in COM objects, even those created in earlier versions of Visual Basic. The properties and methods of classes inherited from COM objects can be overridden or overloaded just as properties and methods of any other base class can be overridden or overloaded. Inheritance from COM objects is useful when you have an existing class library that you do not want to recompile.  \n  \n The following procedure shows how to use Visual Basic 6.0 to create a COM object that contains a class, and then use it as a base class.  \n  \n[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  \n  \n### To build the COM object that is used in this walkthrough  \n  \n1.  In Visual Basic 6.0, open a new ActiveX DLL project. A project named `Project1` is created. It has a class named `Class1`.  \n  \n2.  In the **Project Explorer**, right-click **Project1**, and then click **Project1 Properties**. The **Project Properties** dialog box is displayed.  \n  \n3.  On the **General** tab of the **Project Properties** dialog box, change the project name by typing `ComObject1` in the **Project Name** field.  \n  \n4.  In the **Project Explorer**, right-click `Class1`, and then click **Properties**. The **Properties** window for the class is displayed.  \n  \n5.  Change the `Name` property to `MathFunctions`.  \n  \n6.  In the **Project Explorer**, right-click `MathFunctions`, and then click **View Code**. The **Code Editor** is displayed.  \n  \n7.  Add a local variable to hold the property value:  \n  \n    ```  \n    ' Local variable to hold property value  \n    Private mvarProp1 As Integer  \n    ```  \n  \n8.  Add Property `Let` and Property `Get` property procedures:  \n  \n    ```  \n    Public Property Let Prop1(ByVal vData As Integer)  \n       'Used when assigning a value to the property.  \n       mvarProp1 = vData  \n    End Property  \n    Public Property Get Prop1() As Integer  \n       'Used when retrieving a property's value.  \n       Prop1 = mvarProp1  \n    End Property  \n    ```  \n  \n9. Add a function:  \n  \n    ```  \n    Function AddNumbers(   \n       ByVal SomeNumber As Integer,   \n       ByVal AnotherNumber As Integer) As Integer  \n  \n       AddNumbers = SomeNumber + AnotherNumber  \n    End Function  \n    ```  \n  \n10. Create and register the COM object by clicking **Make ComObject1.dll** on the **File** menu.  \n  \n    > [!NOTE]\n    >  Although you can also expose a class created with Visual Basic as a COM object, it is not a true COM object and cannot be used in this walkthrough. For details, see [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md).  \n  \n## Interop Assemblies  \n In the following procedure, you will create an interop assembly, which acts as a bridge between unmanaged code (such as a COM object) and the managed code Visual Studio uses. The interop assembly that Visual Basic creates handles many of the details of working with COM objects, such as *interop marshaling*, the process of packaging parameters and return values into equivalent data types as they move to and from COM objects. The reference in the Visual Basic application points to the interop assembly, not the actual COM object.  \n  \n#### To use a COM object with Visual Basic 2005 and later versions  \n  \n1.  Open a new Visual Basic Windows Application project.  \n  \n2.  On the **Project** menu, click **Add Reference**.  \n  \n     The **Add Reference** dialog box is displayed.  \n  \n3.  On the **COM** tab, double-click `ComObject1` in the **Component Name** list and click **OK**.  \n  \n4.  On the **Project** menu, click **Add New Item**.  \n  \n     The **Add New Item** dialog box is displayed.  \n  \n5.  In the **Templates** pane, click **Class**.  \n  \n     The default file name, `Class1.vb`, appears in the **Name** field. Change this field to MathClass.vb and click **Add**. This creates a class named `MathClass`, and displays its code.  \n  \n6.  Add the following code to the top of `MathClass` to inherit from the COM class.  \n  \n     [!code-vb[VbVbalrInterop#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#31)]  \n  \n7.  Overload the public method of the base class by adding the following code to `MathClass`:  \n  \n     [!code-vb[VbVbalrInterop#32](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#32)]  \n  \n8.  Extend the inherited class by adding the following code to `MathClass`:  \n  \n     [!code-vb[VbVbalrInterop#33](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#33)]  \n  \n The new class inherits the properties of the base class in the COM object, overloads a method, and defines a new method to extend the class.  \n  \n#### To test the inherited class  \n  \n1.  Add a button to your startup form, and then double-click it to view its code.  \n  \n2.  In the button's `Click` event handler procedure, add the following code to create an instance of `MathClass` and call the overloaded methods:  \n  \n     [!code-vb[VbVbalrInterop#34](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#34)]  \n  \n3.  Run the project by pressing F5.  \n  \n When you click the button on the form, the `AddNumbers` method is first called with `Short` data type numbers, and Visual Basic chooses the appropriate method from the base class. The second call to `AddNumbers` is directed to the overload method from `MathClass`. The third call calls the `SubtractNumbers` method, which extends the class. The property in the base class is set, and the value is displayed.  \n  \n## Next Steps  \n You may have noticed that the overloaded `AddNumbers` function appears to have the same data type as the method inherited from the base class of the COM object. This is because the arguments and parameters of the base class method are defined as 16-bit integers in Visual Basic 6.0, but they are exposed as 16-bit integers of type `Short` in later versions of Visual Basic. The new function accepts 32-bit integers, and overloads the base class function.  \n  \n When working with COM objects, make sure that you verify the size and data types of parameters. For example, when you are using a COM object that accepts a Visual Basic 6.0 collection object as an argument, you cannot provide a collection from a later version of Visual Basic.  \n  \n Properties and methods inherited from COM classes can be overridden, meaning that you can declare a local property or method that replaces a property or method inherited from a base COM class. The rules for overriding inherited COM properties are similar to the rules for overriding other properties and methods with the following exceptions:  \n  \n-   If you override any property or method inherited from a COM class, you must override all the other inherited properties and methods.  \n  \n-   Properties that use `ByRef` parameters cannot be overridden.  \n  \n## See also\n\n- [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)\n- [Inherits Statement](../../../visual-basic/language-reference/statements/inherits-statement.md)\n- [Short Data Type](../../../visual-basic/language-reference/data-types/short-data-type.md)\n","nodes":[{"pos":[4,375],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Implementing Inheritance with COM Objects (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"inheritance [Visual Basic], COM reusability\"\n  - \"base classes [Visual Basic], COM reusability\"\n  - \"inheritance [Visual Basic], walkthroughs\"\n  - \"derived classes [Visual Basic], COM reusability\"\nms.assetid: f8e7263a-de13-48d1-b67c-ca1adf3544d9","nodes":[{"content":"Walkthrough: Implementing Inheritance with COM Objects (Visual Basic)","nodes":[{"pos":[0,69],"content":"Walkthrough: Implementing Inheritance with COM Objects (Visual Basic)","nodes":[{"content":"Walkthrough: Implementing Inheritance with COM Objects (Visual Basic)","pos":[0,69]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[382,451],"content":"Walkthrough: Implementing Inheritance with COM Objects (Visual Basic)","linkify":"Walkthrough: Implementing Inheritance with COM Objects (Visual Basic)","nodes":[{"content":"Walkthrough: Implementing Inheritance with COM Objects (Visual Basic)","pos":[0,69]}]},{"content":"You can derive Visual Basic classes from <ph id=\"ph1\">`Public`</ph> classes in COM objects, even those created in earlier versions of Visual Basic.","pos":[452,581],"source":"You can derive Visual Basic classes from `Public` classes in COM objects, even those created in earlier versions of Visual Basic."},{"content":"The properties and methods of classes inherited from COM objects can be overridden or overloaded just as properties and methods of any other base class can be overridden or overloaded.","pos":[582,766]},{"content":"Inheritance from COM objects is useful when you have an existing class library that you do not want to recompile.","pos":[767,880]},{"content":"The following procedure shows how to use Visual Basic 6.0 to create a COM object that contains a class, and then use it as a base class.","pos":[887,1023]},{"pos":[1112,1168],"content":"To build the COM object that is used in this walkthrough","linkify":"To build the COM object that is used in this walkthrough","nodes":[{"content":"To build the COM object that is used in this walkthrough","pos":[0,56]}]},{"content":"In Visual Basic 6.0, open a new ActiveX DLL project.","pos":[1178,1230]},{"content":"A project named <ph id=\"ph1\">`Project1`</ph> is created.","pos":[1231,1269],"source":" A project named `Project1` is created."},{"content":"It has a class named <ph id=\"ph1\">`Class1`</ph>.","pos":[1270,1300],"source":" It has a class named `Class1`."},{"content":"In the <bpt id=\"p1\">**</bpt>Project Explorer<ept id=\"p1\">**</ept>, right-click <bpt id=\"p2\">**</bpt>Project1<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Project1 Properties<ept id=\"p3\">**</ept>.","pos":[1310,1404],"source":"In the **Project Explorer**, right-click **Project1**, and then click **Project1 Properties**."},{"content":"The <bpt id=\"p1\">**</bpt>Project Properties<ept id=\"p1\">**</ept> dialog box is displayed.","pos":[1405,1456],"source":" The **Project Properties** dialog box is displayed."},{"pos":[1466,1608],"content":"On the <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> tab of the <bpt id=\"p2\">**</bpt>Project Properties<ept id=\"p2\">**</ept> dialog box, change the project name by typing <ph id=\"ph1\">`ComObject1`</ph> in the <bpt id=\"p3\">**</bpt>Project Name<ept id=\"p3\">**</ept> field.","source":"On the **General** tab of the **Project Properties** dialog box, change the project name by typing `ComObject1` in the **Project Name** field."},{"content":"In the <bpt id=\"p1\">**</bpt>Project Explorer<ept id=\"p1\">**</ept>, right-click <ph id=\"ph1\">`Class1`</ph>, and then click <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","pos":[1618,1699],"source":"In the **Project Explorer**, right-click `Class1`, and then click **Properties**."},{"content":"The <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window for the class is displayed.","pos":[1700,1753],"source":" The **Properties** window for the class is displayed."},{"pos":[1763,1809],"content":"Change the <ph id=\"ph1\">`Name`</ph> property to <ph id=\"ph2\">`MathFunctions`</ph>.","source":"Change the `Name` property to `MathFunctions`."},{"content":"In the <bpt id=\"p1\">**</bpt>Project Explorer<ept id=\"p1\">**</ept>, right-click <ph id=\"ph1\">`MathFunctions`</ph>, and then click <bpt id=\"p2\">**</bpt>View Code<ept id=\"p2\">**</ept>.","pos":[1819,1906],"source":"In the **Project Explorer**, right-click `MathFunctions`, and then click **View Code**."},{"content":"The <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept> is displayed.","pos":[1907,1940],"source":" The **Code Editor** is displayed."},{"content":"Add a local variable to hold the property value:","pos":[1950,1998]},{"pos":[2112,2170],"content":"Add Property <ph id=\"ph1\">`Let`</ph> and Property <ph id=\"ph2\">`Get`</ph> property procedures:","source":"Add Property `Let` and Property `Get` property procedures:"},{"content":"Add a function:","pos":[2501,2516]},{"pos":[2739,2831],"content":"Create and register the COM object by clicking <bpt id=\"p1\">**</bpt>Make ComObject1.dll<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu.","source":"Create and register the COM object by clicking **Make ComObject1.dll** on the **File** menu."},{"pos":[2843,3184],"content":"[!NOTE]\nAlthough you can also expose a class created with Visual Basic as a COM object, it is not a true COM object and cannot be used in this walkthrough. For details, see [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md).","leadings":["","    >  "],"nodes":[{"content":"Although you can also expose a class created with Visual Basic as a COM object, it is not a true COM object and cannot be used in this walkthrough. For details, see [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md).","pos":[8,334],"nodes":[{"content":"Although you can also expose a class created with Visual Basic as a COM object, it is not a true COM object and cannot be used in this walkthrough.","pos":[0,147]},{"content":"For details, see <bpt id=\"p1\">[</bpt>COM Interoperability in .NET Framework Applications<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)</ept>.","pos":[148,326],"source":" For details, see [COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)."}]}]},{"pos":[3193,3211],"content":"Interop Assemblies","linkify":"Interop Assemblies","nodes":[{"content":"Interop Assemblies","pos":[0,18]}]},{"content":"In the following procedure, you will create an interop assembly, which acts as a bridge between unmanaged code (such as a COM object) and the managed code Visual Studio uses.","pos":[3215,3389]},{"content":"The interop assembly that Visual Basic creates handles many of the details of working with COM objects, such as <bpt id=\"p1\">*</bpt>interop marshaling<ept id=\"p1\">*</ept>, the process of packaging parameters and return values into equivalent data types as they move to and from COM objects.","pos":[3390,3642],"source":" The interop assembly that Visual Basic creates handles many of the details of working with COM objects, such as *interop marshaling*, the process of packaging parameters and return values into equivalent data types as they move to and from COM objects."},{"content":"The reference in the Visual Basic application points to the interop assembly, not the actual COM object.","pos":[3643,3747]},{"pos":[3758,3819],"content":"To use a COM object with Visual Basic 2005 and later versions","linkify":"To use a COM object with Visual Basic 2005 and later versions","nodes":[{"content":"To use a COM object with Visual Basic 2005 and later versions","pos":[0,61]}]},{"content":"Open a new Visual Basic Windows Application project.","pos":[3829,3881]},{"pos":[3891,3940],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Add Reference<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, click **Add Reference**."},{"pos":[3951,3997],"content":"The <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept> dialog box is displayed.","source":"The **Add Reference** dialog box is displayed."},{"pos":[4007,4101],"content":"On the <bpt id=\"p1\">**</bpt>COM<ept id=\"p1\">**</ept> tab, double-click <ph id=\"ph1\">`ComObject1`</ph> in the <bpt id=\"p2\">**</bpt>Component Name<ept id=\"p2\">**</ept> list and click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","source":"On the **COM** tab, double-click `ComObject1` in the **Component Name** list and click **OK**."},{"pos":[4111,4159],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Add New Item<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, click **Add New Item**."},{"pos":[4170,4215],"content":"The <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> dialog box is displayed.","source":"The **Add New Item** dialog box is displayed."},{"pos":[4225,4268],"content":"In the <bpt id=\"p1\">**</bpt>Templates<ept id=\"p1\">**</ept> pane, click <bpt id=\"p2\">**</bpt>Class<ept id=\"p2\">**</ept>.","source":"In the **Templates** pane, click **Class**."},{"content":"The default file name, <ph id=\"ph1\">`Class1.vb`</ph>, appears in the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> field.","pos":[4279,4345],"source":"The default file name, `Class1.vb`, appears in the **Name** field."},{"content":"Change this field to MathClass.vb and click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","pos":[4346,4398],"source":" Change this field to MathClass.vb and click **Add**."},{"content":"This creates a class named <ph id=\"ph1\">`MathClass`</ph>, and displays its code.","pos":[4399,4461],"source":" This creates a class named `MathClass`, and displays its code."},{"pos":[4471,4550],"content":"Add the following code to the top of <ph id=\"ph1\">`MathClass`</ph> to inherit from the COM class.","source":"Add the following code to the top of `MathClass` to inherit from the COM class."},{"pos":[4684,4773],"content":"Overload the public method of the base class by adding the following code to <ph id=\"ph1\">`MathClass`</ph>:","source":"Overload the public method of the base class by adding the following code to `MathClass`:"},{"pos":[4907,4978],"content":"Extend the inherited class by adding the following code to <ph id=\"ph1\">`MathClass`</ph>:","source":"Extend the inherited class by adding the following code to `MathClass`:"},{"content":"The new class inherits the properties of the base class in the COM object, overloads a method, and defines a new method to extend the class.","pos":[5109,5249]},{"pos":[5260,5287],"content":"To test the inherited class","linkify":"To test the inherited class","nodes":[{"content":"To test the inherited class","pos":[0,27]}]},{"content":"Add a button to your startup form, and then double-click it to view its code.","pos":[5297,5374]},{"pos":[5384,5525],"content":"In the button's <ph id=\"ph1\">`Click`</ph> event handler procedure, add the following code to create an instance of <ph id=\"ph2\">`MathClass`</ph> and call the overloaded methods:","source":"In the button's `Click` event handler procedure, add the following code to create an instance of `MathClass` and call the overloaded methods:"},{"content":"Run the project by pressing F5.","pos":[5659,5690]},{"content":"When you click the button on the form, the <ph id=\"ph1\">`AddNumbers`</ph> method is first called with <ph id=\"ph2\">`Short`</ph> data type numbers, and Visual Basic chooses the appropriate method from the base class.","pos":[5697,5876],"source":"When you click the button on the form, the `AddNumbers` method is first called with `Short` data type numbers, and Visual Basic chooses the appropriate method from the base class."},{"content":"The second call to <ph id=\"ph1\">`AddNumbers`</ph> is directed to the overload method from <ph id=\"ph2\">`MathClass`</ph>.","pos":[5877,5961],"source":" The second call to `AddNumbers` is directed to the overload method from `MathClass`."},{"content":"The third call calls the <ph id=\"ph1\">`SubtractNumbers`</ph> method, which extends the class.","pos":[5962,6037],"source":" The third call calls the `SubtractNumbers` method, which extends the class."},{"content":"The property in the base class is set, and the value is displayed.","pos":[6038,6104]},{"pos":[6113,6123],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"You may have noticed that the overloaded <ph id=\"ph1\">`AddNumbers`</ph> function appears to have the same data type as the method inherited from the base class of the COM object.","pos":[6127,6287],"source":"You may have noticed that the overloaded `AddNumbers` function appears to have the same data type as the method inherited from the base class of the COM object."},{"content":"This is because the arguments and parameters of the base class method are defined as 16-bit integers in Visual Basic 6.0, but they are exposed as 16-bit integers of type <ph id=\"ph1\">`Short`</ph> in later versions of Visual Basic.","pos":[6288,6500],"source":" This is because the arguments and parameters of the base class method are defined as 16-bit integers in Visual Basic 6.0, but they are exposed as 16-bit integers of type `Short` in later versions of Visual Basic."},{"content":"The new function accepts 32-bit integers, and overloads the base class function.","pos":[6501,6581]},{"content":"When working with COM objects, make sure that you verify the size and data types of parameters.","pos":[6588,6683]},{"content":"For example, when you are using a COM object that accepts a Visual Basic 6.0 collection object as an argument, you cannot provide a collection from a later version of Visual Basic.","pos":[6684,6864]},{"content":"Properties and methods inherited from COM classes can be overridden, meaning that you can declare a local property or method that replaces a property or method inherited from a base COM class.","pos":[6871,7063]},{"content":"The rules for overriding inherited COM properties are similar to the rules for overriding other properties and methods with the following exceptions:","pos":[7064,7213]},{"content":"If you override any property or method inherited from a COM class, you must override all the other inherited properties and methods.","pos":[7223,7355]},{"pos":[7365,7425],"content":"Properties that use <ph id=\"ph1\">`ByRef`</ph> parameters cannot be overridden.","source":"Properties that use `ByRef` parameters cannot be overridden."},{"pos":[7434,7442],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7446,7606],"content":"<bpt id=\"p1\">[</bpt>COM Interoperability in .NET Framework Applications<ept id=\"p1\">](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)</ept>","source":"[COM Interoperability in .NET Framework Applications](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)"},{"pos":[7609,7704],"content":"<bpt id=\"p1\">[</bpt>Inherits Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/inherits-statement.md)</ept>","source":"[Inherits Statement](../../../visual-basic/language-reference/statements/inherits-statement.md)"},{"pos":[7707,7796],"content":"<bpt id=\"p1\">[</bpt>Short Data Type<ept id=\"p1\">](../../../visual-basic/language-reference/data-types/short-data-type.md)</ept>","source":"[Short Data Type](../../../visual-basic/language-reference/data-types/short-data-type.md)"}]}