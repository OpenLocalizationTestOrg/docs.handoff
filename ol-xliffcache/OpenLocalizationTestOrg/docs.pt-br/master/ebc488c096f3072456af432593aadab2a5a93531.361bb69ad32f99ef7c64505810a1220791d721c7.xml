{"content":"---\ntitle: \"Navigating DataRelations | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: e5e673f4-9b44-45ae-aaea-c504d1cc5d3e\ncaps.latest.revision: 3\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Navigating DataRelations\nOne of the primary functions of a <xref:System.Data.DataRelation> is to allow navigation from one <xref:System.Data.DataTable> to another within a <xref:System.Data.DataSet>. This allows you to retrieve all the related <xref:System.Data.DataRow> objects in one **DataTable** when given a single **DataRow** from a related **DataTable**. For example, after establishing a **DataRelation** between a table of customers and a table of orders, you can retrieve all the order rows for a particular customer row using **GetChildRows**.  \n  \n The following code example creates a **DataRelation** between the **Customers** table and the **Orders** table of a **DataSet** and returns all the orders for each customer.  \n  \n [!code-csharp[DataWorks Data.DataTableRelation#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks Data.DataTableRelation/CS/source.cs#1)]\n [!code-vb[DataWorks Data.DataTableRelation#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks Data.DataTableRelation/VB/source.vb#1)]  \n  \n The next example builds on the preceding example, relating four tables together and navigating those relationships. As in the previous example, **CustomerID** relates the **Customers** table to the **Orders** table. For each customer in the **Customers** table, all the child rows in the **Orders** table are determined, in order to return the number of orders a particular customer has and their **OrderID** values.  \n  \n The expanded example also returns the values from the **OrderDetails** and **Products** tables. The **Orders** table is related to the **OrderDetails** table using **OrderID** to determine, for each customer order, what products and quantities were ordered. Because the **OrderDetails** table only contains the **ProductID** of an ordered product, **OrderDetails** is related to **Products** using **ProductID** in order to return the **ProductName**. In this relation, the **Products** table is the parent and the **Order Details** table is the child. As a result, when iterating through the **OrderDetails** table, **GetParentRow** is called to retrieve the related **ProductName** value.  \n  \n Notice that when the **DataRelation** is created for the **Customers** and **Orders** tables, no value is specified for the **createConstraints** flag (the default is **true**). This assumes that all the rows in the **Orders** table have a **CustomerID** value that exists in the parent **Customers** table. If a **CustomerID** exists in the **Orders** table that does not exist in the **Customers** table, a <xref:System.Data.ForeignKeyConstraint> causes an exception to be thrown.  \n  \n When the child column might contain values that the parent column does not contain, set the **createConstraints** flag to **false** when adding the **DataRelation**. In the example, the **createConstraints** flag is set to **false** for the **DataRelation** between the **Orders** table and the **OrderDetails** table. This enables the application to return all the records from the **OrderDetails** table and only a subset of records from the **Orders** table without generating a run-time exception. The expanded sample generates output in the following format.  \n  \n```  \nCustomer ID: NORTS  \n  Order ID: 10517  \n        Order Date: 4/24/1997 12:00:00 AM  \n           Product: Filo Mix  \n          Quantity: 6  \n           Product: Raclette Courdavault  \n          Quantity: 4  \n           Product: Outback Lager  \n          Quantity: 6  \n  Order ID: 11057  \n        Order Date: 4/29/1998 12:00:00 AM  \n           Product: Outback Lager  \n          Quantity: 3  \n```  \n  \n The following code example is an expanded sample where the values from the **OrderDetails** and **Products** tables are returned, with only a subset of the records in the **Orders** table being returned.  \n  \n [!code-csharp[DataWorks Data.DataTableNavigation#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks Data.DataTableNavigation/CS/source.cs#1)]\n [!code-vb[DataWorks Data.DataTableNavigation#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks Data.DataTableNavigation/VB/source.vb#1)]  \n  \n## See Also  \n [DataSets, DataTables, and DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)   \n [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)","nodes":[{"pos":[4,355],"embed":true,"restype":"x-metadata","content":"title: \"Navigating DataRelations | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: e5e673f4-9b44-45ae-aaea-c504d1cc5d3e\ncaps.latest.revision: 3\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","nodes":[{"content":"Navigating DataRelations | Microsoft Docs","nodes":[{"pos":[0,41],"content":"Navigating DataRelations | Microsoft Docs","nodes":[{"content":"Navigating DataRelations | Microsoft Docs","pos":[0,41]}]}],"path":["title"]}],"yml":true},{"pos":[362,386],"content":"Navigating DataRelations","linkify":"Navigating DataRelations","nodes":[{"content":"Navigating DataRelations","pos":[0,24]}]},{"content":"One of the primary functions of a <ph id=\"ph1\">&lt;xref:System.Data.DataRelation&gt;</ph> is to allow navigation from one <ph id=\"ph2\">&lt;xref:System.Data.DataTable&gt;</ph> to another within a <ph id=\"ph3\">&lt;xref:System.Data.DataSet&gt;</ph>.","pos":[387,561],"source":"One of the primary functions of a <xref:System.Data.DataRelation> is to allow navigation from one <xref:System.Data.DataTable> to another within a <xref:System.Data.DataSet>."},{"content":"This allows you to retrieve all the related <ph id=\"ph1\">&lt;xref:System.Data.DataRow&gt;</ph> objects in one <bpt id=\"p1\">**</bpt>DataTable<ept id=\"p1\">**</ept> when given a single <bpt id=\"p2\">**</bpt>DataRow<ept id=\"p2\">**</ept> from a related <bpt id=\"p3\">**</bpt>DataTable<ept id=\"p3\">**</ept>.","pos":[562,723],"source":" This allows you to retrieve all the related <xref:System.Data.DataRow> objects in one **DataTable** when given a single **DataRow** from a related **DataTable**."},{"content":"For example, after establishing a <bpt id=\"p1\">**</bpt>DataRelation<ept id=\"p1\">**</ept> between a table of customers and a table of orders, you can retrieve all the order rows for a particular customer row using <bpt id=\"p2\">**</bpt>GetChildRows<ept id=\"p2\">**</ept>.","pos":[724,916],"source":" For example, after establishing a **DataRelation** between a table of customers and a table of orders, you can retrieve all the order rows for a particular customer row using **GetChildRows**."},{"pos":[923,1096],"content":"The following code example creates a <bpt id=\"p1\">**</bpt>DataRelation<ept id=\"p1\">**</ept> between the <bpt id=\"p2\">**</bpt>Customers<ept id=\"p2\">**</ept> table and the <bpt id=\"p3\">**</bpt>Orders<ept id=\"p3\">**</ept> table of a <bpt id=\"p4\">**</bpt>DataSet<ept id=\"p4\">**</ept> and returns all the orders for each customer.","source":"The following code example creates a **DataRelation** between the **Customers** table and the **Orders** table of a **DataSet** and returns all the orders for each customer."},{"content":"The next example builds on the preceding example, relating four tables together and navigating those relationships.","pos":[1429,1544]},{"content":"As in the previous example, <bpt id=\"p1\">**</bpt>CustomerID<ept id=\"p1\">**</ept> relates the <bpt id=\"p2\">**</bpt>Customers<ept id=\"p2\">**</ept> table to the <bpt id=\"p3\">**</bpt>Orders<ept id=\"p3\">**</ept> table.","pos":[1545,1644],"source":" As in the previous example, **CustomerID** relates the **Customers** table to the **Orders** table."},{"content":"For each customer in the <bpt id=\"p1\">**</bpt>Customers<ept id=\"p1\">**</ept> table, all the child rows in the <bpt id=\"p2\">**</bpt>Orders<ept id=\"p2\">**</ept> table are determined, in order to return the number of orders a particular customer has and their <bpt id=\"p3\">**</bpt>OrderID<ept id=\"p3\">**</ept> values.","pos":[1645,1845],"source":" For each customer in the **Customers** table, all the child rows in the **Orders** table are determined, in order to return the number of orders a particular customer has and their **OrderID** values."},{"content":"The expanded example also returns the values from the <bpt id=\"p1\">**</bpt>OrderDetails<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Products<ept id=\"p2\">**</ept> tables.","pos":[1852,1947],"source":"The expanded example also returns the values from the **OrderDetails** and **Products** tables."},{"content":"The <bpt id=\"p1\">**</bpt>Orders<ept id=\"p1\">**</ept> table is related to the <bpt id=\"p2\">**</bpt>OrderDetails<ept id=\"p2\">**</ept> table using <bpt id=\"p3\">**</bpt>OrderID<ept id=\"p3\">**</ept> to determine, for each customer order, what products and quantities were ordered.","pos":[1948,2109],"source":" The **Orders** table is related to the **OrderDetails** table using **OrderID** to determine, for each customer order, what products and quantities were ordered."},{"content":"Because the <bpt id=\"p1\">**</bpt>OrderDetails<ept id=\"p1\">**</ept> table only contains the <bpt id=\"p2\">**</bpt>ProductID<ept id=\"p2\">**</ept> of an ordered product, <bpt id=\"p3\">**</bpt>OrderDetails<ept id=\"p3\">**</ept> is related to <bpt id=\"p4\">**</bpt>Products<ept id=\"p4\">**</ept> using <bpt id=\"p5\">**</bpt>ProductID<ept id=\"p5\">**</ept> in order to return the <bpt id=\"p6\">**</bpt>ProductName<ept id=\"p6\">**</ept>.","pos":[2110,2303],"source":" Because the **OrderDetails** table only contains the **ProductID** of an ordered product, **OrderDetails** is related to **Products** using **ProductID** in order to return the **ProductName**."},{"content":"In this relation, the <bpt id=\"p1\">**</bpt>Products<ept id=\"p1\">**</ept> table is the parent and the <bpt id=\"p2\">**</bpt>Order Details<ept id=\"p2\">**</ept> table is the child.","pos":[2304,2404],"source":" In this relation, the **Products** table is the parent and the **Order Details** table is the child."},{"content":"As a result, when iterating through the <bpt id=\"p1\">**</bpt>OrderDetails<ept id=\"p1\">**</ept> table, <bpt id=\"p2\">**</bpt>GetParentRow<ept id=\"p2\">**</ept> is called to retrieve the related <bpt id=\"p3\">**</bpt>ProductName<ept id=\"p3\">**</ept> value.","pos":[2405,2542],"source":" As a result, when iterating through the **OrderDetails** table, **GetParentRow** is called to retrieve the related **ProductName** value."},{"content":"Notice that when the <bpt id=\"p1\">**</bpt>DataRelation<ept id=\"p1\">**</ept> is created for the <bpt id=\"p2\">**</bpt>Customers<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>Orders<ept id=\"p3\">**</ept> tables, no value is specified for the <bpt id=\"p4\">**</bpt>createConstraints<ept id=\"p4\">**</ept> flag (the default is <bpt id=\"p5\">**</bpt>true<ept id=\"p5\">**</ept>).","pos":[2549,2726],"source":"Notice that when the **DataRelation** is created for the **Customers** and **Orders** tables, no value is specified for the **createConstraints** flag (the default is **true**)."},{"content":"This assumes that all the rows in the <bpt id=\"p1\">**</bpt>Orders<ept id=\"p1\">**</ept> table have a <bpt id=\"p2\">**</bpt>CustomerID<ept id=\"p2\">**</ept> value that exists in the parent <bpt id=\"p3\">**</bpt>Customers<ept id=\"p3\">**</ept> table.","pos":[2727,2856],"source":" This assumes that all the rows in the **Orders** table have a **CustomerID** value that exists in the parent **Customers** table."},{"content":"If a <bpt id=\"p1\">**</bpt>CustomerID<ept id=\"p1\">**</ept> exists in the <bpt id=\"p2\">**</bpt>Orders<ept id=\"p2\">**</ept> table that does not exist in the <bpt id=\"p3\">**</bpt>Customers<ept id=\"p3\">**</ept> table, a <ph id=\"ph1\">&lt;xref:System.Data.ForeignKeyConstraint&gt;</ph> causes an exception to be thrown.","pos":[2857,3031],"source":" If a **CustomerID** exists in the **Orders** table that does not exist in the **Customers** table, a <xref:System.Data.ForeignKeyConstraint> causes an exception to be thrown."},{"content":"When the child column might contain values that the parent column does not contain, set the <bpt id=\"p1\">**</bpt>createConstraints<ept id=\"p1\">**</ept> flag to <bpt id=\"p2\">**</bpt>false<ept id=\"p2\">**</ept> when adding the <bpt id=\"p3\">**</bpt>DataRelation<ept id=\"p3\">**</ept>.","pos":[3038,3203],"source":"When the child column might contain values that the parent column does not contain, set the **createConstraints** flag to **false** when adding the **DataRelation**."},{"content":"In the example, the <bpt id=\"p1\">**</bpt>createConstraints<ept id=\"p1\">**</ept> flag is set to <bpt id=\"p2\">**</bpt>false<ept id=\"p2\">**</ept> for the <bpt id=\"p3\">**</bpt>DataRelation<ept id=\"p3\">**</ept> between the <bpt id=\"p4\">**</bpt>Orders<ept id=\"p4\">**</ept> table and the <bpt id=\"p5\">**</bpt>OrderDetails<ept id=\"p5\">**</ept> table.","pos":[3204,3356],"source":" In the example, the **createConstraints** flag is set to **false** for the **DataRelation** between the **Orders** table and the **OrderDetails** table."},{"content":"This enables the application to return all the records from the <bpt id=\"p1\">**</bpt>OrderDetails<ept id=\"p1\">**</ept> table and only a subset of records from the <bpt id=\"p2\">**</bpt>Orders<ept id=\"p2\">**</ept> table without generating a run-time exception.","pos":[3357,3539],"source":" This enables the application to return all the records from the **OrderDetails** table and only a subset of records from the **Orders** table without generating a run-time exception."},{"content":"The expanded sample generates output in the following format.","pos":[3540,3601]},{"pos":[4014,4217],"content":"The following code example is an expanded sample where the values from the <bpt id=\"p1\">**</bpt>OrderDetails<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Products<ept id=\"p2\">**</ept> tables are returned, with only a subset of the records in the <bpt id=\"p3\">**</bpt>Orders<ept id=\"p3\">**</ept> table being returned.","source":"The following code example is an expanded sample where the values from the **OrderDetails** and **Products** tables are returned, with only a subset of the records in the **Orders** table being returned."},{"pos":[4560,4568],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>DataSets, DataTables, and DataViews<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[4572,4689],"source":"[DataSets, DataTables, and DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=217917)</ept>","pos":[4693,4796],"source":"[ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)"}]}