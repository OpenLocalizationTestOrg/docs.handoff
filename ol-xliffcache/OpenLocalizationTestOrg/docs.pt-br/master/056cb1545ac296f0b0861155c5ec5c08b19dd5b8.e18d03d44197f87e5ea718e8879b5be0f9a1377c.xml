{"content":"---\ntitle: \"How to: Generate XML from CSV Files (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: fe4dbc87-7b0d-40bf-88c3-5d706ee89a4d\n---\n# How to: Generate XML from CSV Files (Visual Basic)\nThis example shows how to use [!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)] and [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] to generate an XML file from a comma-separated value (CSV) file.  \n  \n## Example  \n The following code performs a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query on an array of strings.  \n  \n```vb  \n      ' Create the text file.  \nDim csvString As String = \"GREAL,Great Lakes Food Market,Howard Snyder,Marketing Manager,(503) 555-7555,2732 Baker Blvd.,Eugene,OR,97403,USA\" & vbCrLf & _  \n    \"HUNGC,Hungry Coyote Import Store,Yoshi Latimer,Sales Representative,(503) 555-6874,City Center Plaza 516 Main St.,Elgin,OR,97827,USA\" & vbCrLf & _  \n    \"LAZYK,Lazy K Kountry Store,John Steel,Marketing Manager,(509) 555-7969,12 Orchestra Terrace,Walla Walla,WA,99362,USA\" & vbCrLf & _  \n    \"LETSS,Let's Stop N Shop,Jaime Yorres,Owner,(415) 555-5938,87 Polk St. Suite 5,San Francisco,CA,94117,USA\"  \nFile.WriteAllText(\"cust.csv\", csvString)  \n  \n' Read into an array of strings.  \nDim source As String() = File.ReadAllLines(\"cust.csv\")  \nDim cust As XElement = _  \n    <Root>  \n        <%= From strs In source _  \n            Let fields = Split(strs, \",\") _  \n            Select _  \n            <Customer CustomerID=<%= fields(0) %>>  \n                <CompanyName><%= fields(1) %></CompanyName>  \n                <ContactName><%= fields(2) %></ContactName>  \n                <ContactTitle><%= fields(3) %></ContactTitle>  \n                <Phone><%= fields(4) %></Phone>  \n                <FullAddress>  \n                    <Address><%= fields(5) %></Address>  \n                    <City><%= fields(6) %></City>  \n                    <Region><%= fields(7) %></Region>  \n                    <PostalCode><%= fields(8) %></PostalCode>  \n                    <Country><%= fields(9) %></Country>  \n                </FullAddress>  \n            </Customer> _  \n        %>  \n    </Root>  \nConsole.WriteLine(cust)  \n```  \n  \n This code produces the following output:  \n  \n```xml  \n<Root>  \n  <Customer CustomerID=\"GREAL\">  \n    <CompanyName>Great Lakes Food Market</CompanyName>  \n    <ContactName>Howard Snyder</ContactName>  \n    <ContactTitle>Marketing Manager</ContactTitle>  \n    <Phone>(503) 555-7555</Phone>  \n    <FullAddress>  \n      <Address>2732 Baker Blvd.</Address>  \n      <City>Eugene</City>  \n      <Region>OR</Region>  \n      <PostalCode>97403</PostalCode>  \n      <Country>USA</Country>  \n    </FullAddress>  \n  </Customer>  \n  <Customer CustomerID=\"HUNGC\">  \n    <CompanyName>Hungry Coyote Import Store</CompanyName>  \n    <ContactName>Yoshi Latimer</ContactName>  \n    <ContactTitle>Sales Representative</ContactTitle>  \n    <Phone>(503) 555-6874</Phone>  \n    <FullAddress>  \n      <Address>City Center Plaza 516 Main St.</Address>  \n      <City>Elgin</City>  \n      <Region>OR</Region>  \n      <PostalCode>97827</PostalCode>  \n      <Country>USA</Country>  \n    </FullAddress>  \n  </Customer>  \n  <Customer CustomerID=\"LAZYK\">  \n    <CompanyName>Lazy K Kountry Store</CompanyName>  \n    <ContactName>John Steel</ContactName>  \n    <ContactTitle>Marketing Manager</ContactTitle>  \n    <Phone>(509) 555-7969</Phone>  \n    <FullAddress>  \n      <Address>12 Orchestra Terrace</Address>  \n      <City>Walla Walla</City>  \n      <Region>WA</Region>  \n      <PostalCode>99362</PostalCode>  \n      <Country>USA</Country>  \n    </FullAddress>  \n  </Customer>  \n  <Customer CustomerID=\"LETSS\">  \n    <CompanyName>Let's Stop N Shop</CompanyName>  \n    <ContactName>Jaime Yorres</ContactName>  \n    <ContactTitle>Owner</ContactTitle>  \n    <Phone>(415) 555-5938</Phone>  \n    <FullAddress>  \n      <Address>87 Polk St. Suite 5</Address>  \n      <City>San Francisco</City>  \n      <Region>CA</Region>  \n      <PostalCode>94117</PostalCode>  \n      <Country>USA</Country>  \n    </FullAddress>  \n  </Customer>  \n</Root>  \n```  \n  \n## See also\n\n- [Projections and Transformations (LINQ to XML) (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/projections-and-transformations-linq-to-xml.md)\n","nodes":[{"pos":[4,132],"embed":true,"restype":"x-metadata","content":"title: \"How to: Generate XML from CSV Files (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: fe4dbc87-7b0d-40bf-88c3-5d706ee89a4d","nodes":[{"content":"How to: Generate XML from CSV Files (Visual Basic)","nodes":[{"pos":[0,50],"content":"How to: Generate XML from CSV Files (Visual Basic)","nodes":[{"content":"How to: Generate XML from CSV Files (Visual Basic)","pos":[0,50]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[139,189],"content":"How to: Generate XML from CSV Files (Visual Basic)","linkify":"How to: Generate XML from CSV Files (Visual Basic)","nodes":[{"content":"How to: Generate XML from CSV Files (Visual Basic)","pos":[0,50]}]},{"pos":[190,398],"content":"This example shows how to use <ph id=\"ph1\">[!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> to generate an XML file from a comma-separated value (CSV) file.","source":"This example shows how to use [!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)] and [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] to generate an XML file from a comma-separated value (CSV) file."},{"pos":[407,414],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[418,527],"content":"The following code performs a <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> query on an array of strings.","source":"The following code performs a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query on an array of strings."},{"content":"This code produces the following output:","pos":[2153,2193]},{"pos":[4068,4076],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4080,4247],"content":"<bpt id=\"p1\">[</bpt>Projections and Transformations (LINQ to XML) (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/projections-and-transformations-linq-to-xml.md)</ept>","source":"[Projections and Transformations (LINQ to XML) (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/projections-and-transformations-linq-to-xml.md)"}]}