{"content":"---\ntitle: \"How to: Serialize Using DataContractSerializer (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: ecaea518-8a0f-4249-b4e5-9b3fb0cdd8ad\ncaps.latest.revision: 3\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# How to: Serialize Using DataContractSerializer (Visual Basic)\nThis topic shows an example that serializes and deserializes using <xref:System.Runtime.Serialization.DataContractSerializer>.  \n  \n## Example  \n The following example creates a number of objects that contain <xref:System.Xml.Linq.XElement> objects. It then serializes them to text files, and then deserializes them from the text files.  \n  \n```vb  \nImports System  \nImports System.Xml  \nImports System.Xml.Linq  \nImports System.IO  \nImports System.Runtime.Serialization  \n  \nPublic Class XLinqTest  \n    Shared Sub Main()  \n        Test(Of XElement)(CreateXElement())  \n        Test(Of XElementContainer)(New XElementContainer())  \n        Test(Of XElementNullContainer)(New XElementNullContainer())  \n    End Sub  \n  \n    Public Shared Sub Test(Of T)(ByRef obj)  \n        Dim s As DataContractSerializer = New DataContractSerializer(GetType(T))  \n        Using fs As FileStream = File.Open(\"test\" & GetType(T).Name & \".xml\", FileMode.Create)  \n            Console.WriteLine(\"Testing for type: {0}\", GetType(T))  \n            s.WriteObject(fs, obj)  \n        End Using  \n  \n        Using fs As FileStream = File.Open(\"test\" & GetType(T).Name & \".xml\", FileMode.Open)  \n            Dim s2 As Object = s.ReadObject(fs)  \n            If s2 Is Nothing Then  \n                Console.WriteLine(\"  Deserialized object is null (Nothing in VB)\")  \n            Else  \n                Console.WriteLine(\"  Deserialized type: {0}\", s2.GetType())  \n            End If  \n        End Using  \n    End Sub  \n  \n    Public Shared Function CreateXElement() As XElement  \n        Return New XElement(XName.Get(\"NameInNamespace\", \"http://www.adventure-works.org\"))  \n    End Function  \nEnd Class  \n  \n<DataContract()> _  \nPublic Class XElementContainer  \n    <DataMember()> _  \n    Public member As XElement  \n  \n    Public Sub XElementContainer()  \n        member = XLinqTest.CreateXElement()  \n    End Sub  \nEnd Class  \n  \n<DataContract()> _  \nPublic Class XElementNullContainer  \n    <DataMember()> _  \n    Public member As XElement  \n  \n    Public Sub XElementNullContainer()  \n        member = Nothing  \n    End Sub  \nEnd Class  \n  \n```  \n  \n This example produces the following output:  \n  \n```  \nTesting for type: System.Xml.Linq.XElement  \n  Deserialized type: System.Xml.Linq.XElement  \nTesting for type: XElementContainer  \n  Deserialized type: XElementContainer  \nTesting for type: XElementNullContainer  \n  Deserialized type: XElementNullContainer  \n```  \n  \n## See Also  \n [Serializing Object Graphs that Contain XElement Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/serializing-object-graphs-that-contain-xelement-objects.md)","nodes":[{"pos":[12,90],"content":"How to: Serialize Using DataContractSerializer (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Serialize Using DataContractSerializer (Visual Basic) | Microsoft Docs","pos":[0,78]}]},{"pos":[471,532],"content":"How to: Serialize Using DataContractSerializer (Visual Basic)","linkify":"How to: Serialize Using DataContractSerializer (Visual Basic)","nodes":[{"content":"How to: Serialize Using DataContractSerializer (Visual Basic)","pos":[0,61]}]},{"content":"This topic shows an example that serializes and deserializes using <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataContractSerializer&gt;</ph>.","pos":[533,659],"source":"This topic shows an example that serializes and deserializes using <xref:System.Runtime.Serialization.DataContractSerializer>."},{"pos":[668,675],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example creates a number of objects that contain <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> objects.","pos":[679,782],"source":"The following example creates a number of objects that contain <xref:System.Xml.Linq.XElement> objects."},{"content":"It then serializes them to text files, and then deserializes them from the text files.","pos":[783,869]},{"content":"This example produces the following output:","pos":[2662,2705]},{"pos":[2988,2996],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[3000,3189],"content":"<bpt id=\"p1\">[</bpt>Serializing Object Graphs that Contain XElement Objects (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/serializing-object-graphs-that-contain-xelement-objects.md)</ept>","source":"[Serializing Object Graphs that Contain XElement Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/serializing-object-graphs-that-contain-xelement-objects.md)"}]}