{"content":"---\ntitle: \"IMetaDataInfo::GetFileMapping Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataInfo.GetFileMapping\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataInfo::GetFileMapping\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IMetaDataInfo::GetFileMapping method [.NET Framework metadata]\"\n  - \"GetFileMapping method [.NET Framework metadata]\"\nms.assetid: 2868dfec-c992-4606-88bb-a8e0b6b18271\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 8\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# IMetaDataInfo::GetFileMapping Method\nGets the memory region of the mapped file, and the type of mapping.  \n  \n## Syntax  \n  \n```  \nHRESULT GetFileMapping (  \n    [out] const void           **ppvData,   \n    [out] ULONGLONG            *pcbData,   \n    [out] DWORD                *pdwMappingType  \n);  \n```  \n  \n#### Parameters  \n `ppvData`  \n [out] A pointer to the start of the mapped file.  \n  \n `pcbData`  \n [out] The size of the mapped region. If `pdwMappingType` is `fmFlat`, this is the size of the file.  \n  \n `pdwMappingType`  \n [out] A [CorFileMapping](../../../../docs/framework/unmanaged-api/metadata/corfilemapping-enumeration.md) value that indicates the type of mapping. The current implementation of the common language runtime (CLR) always returns `fmFlat`. Other values are reserved for future use. However, you should always verify the returned value, because other values may be enabled in future versions or service releases.  \n  \n## Return Value  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|`S_OK`|All outputs are filled.|  \n|`E_INVALIDARG`|NULL was passed as an argument value.|  \n|`COR_E_NOTSUPPORTED`|The CLR implementation cannot provide information about the memory region. This can happen for the following reasons:<br /><br /> -   The metadata scope was opened with the `ofWrite` or `ofCopyMemory` flag.<br />-   The metadata scope was opened without the `ofReadOnly` flag.<br />-   The [IMetaDataDispenser::OpenScopeOnMemory](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-openscopeonmemory-method.md) method was used to open only the metadata portion of the file.<br />-   The file is not a portable executable (PE) file. **Note:**  These conditions depend on the CLR implementation, and are likely to be weakened in future versions of the CLR.|  \n  \n## Remarks  \n The memory that `ppvData` points to is valid only as long as the underlying metadata scope is open.  \n  \n In order for this method to work, when you map the metadata of an on-disk file into memory by calling the [IMetaDataDispenser::OpenScope](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-openscope-method.md) method, you must specify the `ofReadOnly` flag and you must not specify the `ofWrite` or `ofCopyMemory` flag.  \n  \n The choice of file mapping type for each scope is specific to a given implementation of the CLR. It cannot be set by the user. The current implementation of the CLR always returns `fmFlat` in `pdwMappingType`, but this can change in future versions of the CLR or in future service releases of a given version. You should always check the returned value in `pdwMappingType`, because different types will have different layouts and offsets.  \n  \n Passing NULL for any of the three parameters is not supported. The method returns `E_INVALIDARG`, and none of the outputs are filled. Ignoring the mapping type or the size of the region can result in abnormal program termination.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** Cor.h  \n  \n **Library:** Used as a resource in MsCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See Also  \n [IMetaDataInfo Interface](../../../../docs/framework/unmanaged-api/metadata/imetadatainfo-interface.md)   \n [CorFileMapping Enumeration](../../../../docs/framework/unmanaged-api/metadata/corfilemapping-enumeration.md)","nodes":[{"pos":[4,703],"nodes":[{"content":"IMetaDataInfo::GetFileMapping Method | Microsoft Docs","nodes":[{"pos":[0,53],"content":"IMetaDataInfo::GetFileMapping Method | Microsoft Docs","nodes":[{"content":"IMetaDataInfo::GetFileMapping Method | Microsoft Docs","pos":[0,53]}]}],"pos":[6,62],"yaml":true}],"content":"title: \"IMetaDataInfo::GetFileMapping Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataInfo.GetFileMapping\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataInfo::GetFileMapping\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IMetaDataInfo::GetFileMapping method [.NET Framework metadata]\"\n  - \"GetFileMapping method [.NET Framework metadata]\"\nms.assetid: 2868dfec-c992-4606-88bb-a8e0b6b18271\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 8\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[710,746],"content":"IMetaDataInfo::GetFileMapping Method","linkify":"IMetaDataInfo::GetFileMapping Method","nodes":[{"content":"IMetaDataInfo::GetFileMapping Method","pos":[0,36]}]},{"content":"Gets the memory region of the mapped file, and the type of mapping.","pos":[747,814]},{"pos":[823,829],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1025,1035],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[out] A pointer to the start of the mapped file.","pos":[1052,1100]},{"content":"[out] The size of the mapped region.","pos":[1120,1156]},{"content":"If <ph id=\"ph1\">`pdwMappingType`</ph> is <ph id=\"ph2\">`fmFlat`</ph>, this is the size of the file.","pos":[1157,1219],"source":" If `pdwMappingType` is `fmFlat`, this is the size of the file."},{"content":"[out] A <bpt id=\"p1\">[</bpt>CorFileMapping<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/corfilemapping-enumeration.md)</ept> value that indicates the type of mapping.","pos":[1246,1393],"source":"[out] A [CorFileMapping](../../../../docs/framework/unmanaged-api/metadata/corfilemapping-enumeration.md) value that indicates the type of mapping."},{"content":"The current implementation of the common language runtime (CLR) always returns <ph id=\"ph1\">`fmFlat`</ph>.","pos":[1394,1482],"source":" The current implementation of the common language runtime (CLR) always returns `fmFlat`."},{"content":"Other values are reserved for future use.","pos":[1483,1524]},{"content":"However, you should always verify the returned value, because other values may be enabled in future versions or service releases.","pos":[1525,1654]},{"pos":[1663,1675],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"HRESULT","pos":[1682,1689]},{"content":"Description","pos":[1690,1701]},{"content":"All outputs are filled.","pos":[1749,1772]},{"content":"NULL was passed as an argument value.","pos":[1792,1829]},{"content":"The CLR implementation cannot provide information about the memory region.","pos":[1855,1929]},{"content":"This can happen for the following reasons:","pos":[1930,1972]},{"content":"-   The metadata scope was opened with the <ph id=\"ph1\">`ofWrite`</ph> or <ph id=\"ph2\">`ofCopyMemory`</ph> flag.","pos":[1985,2061],"source":"-   The metadata scope was opened with the `ofWrite` or `ofCopyMemory` flag."},{"content":"-   The metadata scope was opened without the <ph id=\"ph1\">`ofReadOnly`</ph> flag.","pos":[2067,2131],"source":"-   The metadata scope was opened without the `ofReadOnly` flag."},{"content":"-   The <bpt id=\"p1\">[</bpt>IMetaDataDispenser::OpenScopeOnMemory<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-openscopeonmemory-method.md)</ept> method was used to open only the metadata portion of the file.","pos":[2137,2345],"source":"-   The [IMetaDataDispenser::OpenScopeOnMemory](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-openscopeonmemory-method.md) method was used to open only the metadata portion of the file."},{"content":"-   The file is not a portable executable (PE) file.","pos":[2351,2403]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  These conditions depend on the CLR implementation, and are likely to be weakened in future versions of the CLR.","pos":[2404,2526],"source":"**Note:**  These conditions depend on the CLR implementation, and are likely to be weakened in future versions of the CLR."},{"pos":[2536,2543],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2547,2646],"content":"The memory that <ph id=\"ph1\">`ppvData`</ph> points to is valid only as long as the underlying metadata scope is open.","source":"The memory that `ppvData` points to is valid only as long as the underlying metadata scope is open."},{"pos":[2653,2990],"content":"In order for this method to work, when you map the metadata of an on-disk file into memory by calling the <bpt id=\"p1\">[</bpt>IMetaDataDispenser::OpenScope<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-openscope-method.md)</ept> method, you must specify the <ph id=\"ph1\">`ofReadOnly`</ph> flag and you must not specify the <ph id=\"ph2\">`ofWrite`</ph> or <ph id=\"ph3\">`ofCopyMemory`</ph> flag.","source":"In order for this method to work, when you map the metadata of an on-disk file into memory by calling the [IMetaDataDispenser::OpenScope](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-openscope-method.md) method, you must specify the `ofReadOnly` flag and you must not specify the `ofWrite` or `ofCopyMemory` flag."},{"content":"The choice of file mapping type for each scope is specific to a given implementation of the CLR.","pos":[2997,3093]},{"content":"It cannot be set by the user.","pos":[3094,3123]},{"content":"The current implementation of the CLR always returns <ph id=\"ph1\">`fmFlat`</ph> in <ph id=\"ph2\">`pdwMappingType`</ph>, but this can change in future versions of the CLR or in future service releases of a given version.","pos":[3124,3306],"source":" The current implementation of the CLR always returns `fmFlat` in `pdwMappingType`, but this can change in future versions of the CLR or in future service releases of a given version."},{"content":"You should always check the returned value in <ph id=\"ph1\">`pdwMappingType`</ph>, because different types will have different layouts and offsets.","pos":[3307,3435],"source":" You should always check the returned value in `pdwMappingType`, because different types will have different layouts and offsets."},{"content":"Passing NULL for any of the three parameters is not supported.","pos":[3442,3504]},{"content":"The method returns <ph id=\"ph1\">`E_INVALIDARG`</ph>, and none of the outputs are filled.","pos":[3505,3575],"source":" The method returns `E_INVALIDARG`, and none of the outputs are filled."},{"content":"Ignoring the mapping type or the size of the region can result in abnormal program termination.","pos":[3576,3671]},{"pos":[3680,3692],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3696,3800],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[3807,3824],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> Cor.h","source":"**Header:** Cor.h"},{"pos":[3831,3877],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Used as a resource in MsCorEE.dll","source":"**Library:** Used as a resource in MsCorEE.dll"},{"pos":[3884,3992],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[4001,4009],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>IMetaDataInfo Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadatainfo-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[4013,4117],"source":"[IMetaDataInfo Interface](../../../../docs/framework/unmanaged-api/metadata/imetadatainfo-interface.md) "},{"content":"<bpt id=\"p1\">[</bpt>CorFileMapping Enumeration<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/corfilemapping-enumeration.md)</ept>","pos":[4121,4230],"source":"[CorFileMapping Enumeration](../../../../docs/framework/unmanaged-api/metadata/corfilemapping-enumeration.md)"}]}