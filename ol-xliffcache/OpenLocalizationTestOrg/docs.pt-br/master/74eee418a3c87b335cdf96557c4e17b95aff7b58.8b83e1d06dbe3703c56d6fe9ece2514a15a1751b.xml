{"content":"---\ntitle: \"Exception Throwing\"\nms.date: \"10/22/2008\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"exceptions, throwing\"\n  - \"explicitly throwing exceptions\"\n  - \"throwing exceptions, design guidelines\"\nms.assetid: 5388e02b-52f5-460e-a2b5-eeafe60eeebe\nauthor: \"KrzysztofCwalina\"\n---\n# Exception Throwing\nException-throwing guidelines described in this section require a good definition of the meaning of execution failure. Execution failure occurs whenever a member cannot do what it was designed to do (what the member name implies). For example, if the `OpenFile` method cannot return an opened file handle to the caller, it would be considered an execution failure.  \n  \n Most developers have become comfortable with using exceptions for usage errors such as division by zero or null references. In the Framework, exceptions are used for all error conditions, including execution errors.  \n  \n **X DO NOT** return error codes.  \n  \n Exceptions are the primary means of reporting errors in frameworks.  \n  \n **✓ DO** report execution failures by throwing exceptions.  \n  \n **✓ CONSIDER** terminating the process by calling `System.Environment.FailFast` (.NET Framework 2.0 feature) instead of throwing an exception if your code encounters a situation where it is unsafe for further execution.  \n  \n **X DO NOT** use exceptions for the normal flow of control, if possible.  \n  \n Except for system failures and operations with potential race conditions, framework designers should design APIs so users can write code that does not throw exceptions. For example, you can provide a way to check preconditions before calling a member so users can write code that does not throw exceptions.  \n  \n The member used to check preconditions of another member is often referred to as a tester, and the member that actually does the work is called a doer.  \n  \n There are cases when the Tester-Doer Pattern can have an unacceptable performance overhead. In such cases, the so-called Try-Parse Pattern should be considered (see [Exceptions and Performance](../../../docs/standard/design-guidelines/exceptions-and-performance.md) for more information).  \n  \n **✓ CONSIDER** the performance implications of throwing exceptions. Throw rates above 100 per second are likely to noticeably impact the performance of most applications.  \n  \n **✓ DO** document all exceptions thrown by publicly callable members because of a violation of the member contract (rather than a system failure) and treat them as part of your contract.  \n  \n Exceptions that are a part of the contract should not change from one version to the next (i.e., exception type should not change, and new exceptions should not be added).  \n  \n **X DO NOT** have public members that can either throw or not based on some option.  \n  \n **X DO NOT** have public members that return exceptions as the return value or an `out` parameter.  \n  \n Returning exceptions from public APIs instead of throwing them defeats many of the benefits of exception-based error reporting.  \n  \n **✓ CONSIDER** using exception builder methods.  \n  \n It is common to throw the same exception from different places. To avoid code bloat, use helper methods that create exceptions and initialize their properties.  \n  \n Also, members that throw exceptions are not getting inlined. Moving the throw statement inside the builder might allow the member to be inlined.  \n  \n **X DO NOT** throw exceptions from exception filter blocks.  \n  \n When an exception filter raises an exception, the exception is caught by the CLR, and the filter returns false. This behavior is indistinguishable from the filter executing and returning false explicitly and is therefore very difficult to debug.  \n  \n **X AVOID** explicitly throwing exceptions from finally blocks. Implicitly thrown exceptions resulting from calling methods that throw are acceptable.  \n  \n *Portions © 2005, 2009 Microsoft Corporation. All rights reserved.*  \n  \n *Reprinted by permission of Pearson Education, Inc. from [Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619) by Krzysztof Cwalina and Brad Abrams, published Oct 22, 2008 by Addison-Wesley Professional as part of the Microsoft Windows Development Series.*  \n  \n## See also\n\n- [Framework Design Guidelines](../../../docs/standard/design-guidelines/index.md)\n- [Design Guidelines for Exceptions](../../../docs/standard/design-guidelines/exceptions.md)\n","nodes":[{"pos":[4,291],"embed":true,"restype":"x-metadata","content":"title: \"Exception Throwing\"\nms.date: \"10/22/2008\"\nms.technology: dotnet-standard\nhelpviewer_keywords: \n  - \"exceptions, throwing\"\n  - \"explicitly throwing exceptions\"\n  - \"throwing exceptions, design guidelines\"\nms.assetid: 5388e02b-52f5-460e-a2b5-eeafe60eeebe\nauthor: \"KrzysztofCwalina\"","nodes":[{"content":"Exception Throwing","nodes":[{"pos":[0,18],"content":"Exception Throwing","nodes":[{"content":"Exception Throwing","pos":[0,18]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[298,316],"content":"Exception Throwing","linkify":"Exception Throwing","nodes":[{"content":"Exception Throwing","pos":[0,18]}]},{"content":"Exception-throwing guidelines described in this section require a good definition of the meaning of execution failure.","pos":[317,435]},{"content":"Execution failure occurs whenever a member cannot do what it was designed to do (what the member name implies).","pos":[436,547]},{"content":"For example, if the <ph id=\"ph1\">`OpenFile`</ph> method cannot return an opened file handle to the caller, it would be considered an execution failure.","pos":[548,681],"source":" For example, if the `OpenFile` method cannot return an opened file handle to the caller, it would be considered an execution failure."},{"content":"Most developers have become comfortable with using exceptions for usage errors such as division by zero or null references.","pos":[688,811]},{"content":"In the Framework, exceptions are used for all error conditions, including execution errors.","pos":[812,903]},{"pos":[910,942],"content":"<bpt id=\"p1\">**</bpt>X DO NOT<ept id=\"p1\">**</ept> return error codes.","source":"**X DO NOT** return error codes."},{"content":"Exceptions are the primary means of reporting errors in frameworks.","pos":[949,1016]},{"pos":[1023,1081],"content":"<bpt id=\"p1\">**</bpt>✓ DO<ept id=\"p1\">**</ept> report execution failures by throwing exceptions.","source":"**✓ DO** report execution failures by throwing exceptions."},{"pos":[1088,1307],"content":"<bpt id=\"p1\">**</bpt>✓ CONSIDER<ept id=\"p1\">**</ept> terminating the process by calling <ph id=\"ph1\">`System.Environment.FailFast`</ph> (.NET Framework 2.0 feature) instead of throwing an exception if your code encounters a situation where it is unsafe for further execution.","source":"**✓ CONSIDER** terminating the process by calling `System.Environment.FailFast` (.NET Framework 2.0 feature) instead of throwing an exception if your code encounters a situation where it is unsafe for further execution."},{"pos":[1314,1386],"content":"<bpt id=\"p1\">**</bpt>X DO NOT<ept id=\"p1\">**</ept> use exceptions for the normal flow of control, if possible.","source":"**X DO NOT** use exceptions for the normal flow of control, if possible."},{"content":"Except for system failures and operations with potential race conditions, framework designers should design APIs so users can write code that does not throw exceptions.","pos":[1393,1561]},{"content":"For example, you can provide a way to check preconditions before calling a member so users can write code that does not throw exceptions.","pos":[1562,1699]},{"content":"The member used to check preconditions of another member is often referred to as a tester, and the member that actually does the work is called a doer.","pos":[1706,1857]},{"content":"There are cases when the Tester-Doer Pattern can have an unacceptable performance overhead.","pos":[1864,1955]},{"content":"In such cases, the so-called Try-Parse Pattern should be considered (see <bpt id=\"p1\">[</bpt>Exceptions and Performance<ept id=\"p1\">](../../../docs/standard/design-guidelines/exceptions-and-performance.md)</ept> for more information).","pos":[1956,2152],"source":" In such cases, the so-called Try-Parse Pattern should be considered (see [Exceptions and Performance](../../../docs/standard/design-guidelines/exceptions-and-performance.md) for more information)."},{"content":"<bpt id=\"p1\">**</bpt>✓ CONSIDER<ept id=\"p1\">**</ept> the performance implications of throwing exceptions.","pos":[2159,2226],"source":"**✓ CONSIDER** the performance implications of throwing exceptions."},{"content":"Throw rates above 100 per second are likely to noticeably impact the performance of most applications.","pos":[2227,2329]},{"pos":[2336,2522],"content":"<bpt id=\"p1\">**</bpt>✓ DO<ept id=\"p1\">**</ept> document all exceptions thrown by publicly callable members because of a violation of the member contract (rather than a system failure) and treat them as part of your contract.","source":"**✓ DO** document all exceptions thrown by publicly callable members because of a violation of the member contract (rather than a system failure) and treat them as part of your contract."},{"content":"Exceptions that are a part of the contract should not change from one version to the next (i.e., exception type should not change, and new exceptions should not be added).","pos":[2529,2700]},{"pos":[2707,2790],"content":"<bpt id=\"p1\">**</bpt>X DO NOT<ept id=\"p1\">**</ept> have public members that can either throw or not based on some option.","source":"**X DO NOT** have public members that can either throw or not based on some option."},{"pos":[2797,2895],"content":"<bpt id=\"p1\">**</bpt>X DO NOT<ept id=\"p1\">**</ept> have public members that return exceptions as the return value or an <ph id=\"ph1\">`out`</ph> parameter.","source":"**X DO NOT** have public members that return exceptions as the return value or an `out` parameter."},{"content":"Returning exceptions from public APIs instead of throwing them defeats many of the benefits of exception-based error reporting.","pos":[2902,3029]},{"pos":[3036,3083],"content":"<bpt id=\"p1\">**</bpt>✓ CONSIDER<ept id=\"p1\">**</ept> using exception builder methods.","source":"**✓ CONSIDER** using exception builder methods."},{"content":"It is common to throw the same exception from different places.","pos":[3090,3153]},{"content":"To avoid code bloat, use helper methods that create exceptions and initialize their properties.","pos":[3154,3249]},{"content":"Also, members that throw exceptions are not getting inlined.","pos":[3256,3316]},{"content":"Moving the throw statement inside the builder might allow the member to be inlined.","pos":[3317,3400]},{"pos":[3407,3466],"content":"<bpt id=\"p1\">**</bpt>X DO NOT<ept id=\"p1\">**</ept> throw exceptions from exception filter blocks.","source":"**X DO NOT** throw exceptions from exception filter blocks."},{"content":"When an exception filter raises an exception, the exception is caught by the CLR, and the filter returns false.","pos":[3473,3584]},{"content":"This behavior is indistinguishable from the filter executing and returning false explicitly and is therefore very difficult to debug.","pos":[3585,3718]},{"content":"<bpt id=\"p1\">**</bpt>X AVOID<ept id=\"p1\">**</ept> explicitly throwing exceptions from finally blocks.","pos":[3725,3788],"source":"**X AVOID** explicitly throwing exceptions from finally blocks."},{"content":"Implicitly thrown exceptions resulting from calling methods that throw are acceptable.","pos":[3789,3875]},{"pos":[3882,3949],"content":"<bpt id=\"p1\">*</bpt>Portions © 2005, 2009 Microsoft Corporation. All rights reserved.<ept id=\"p1\">*</ept>","source":"*Portions © 2005, 2009 Microsoft Corporation. All rights reserved.*"},{"pos":[3956,4361],"content":"<bpt id=\"p1\">*</bpt>Reprinted by permission of Pearson Education, Inc. from <bpt id=\"p2\">[</bpt>Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition<ept id=\"p2\">](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619)</ept> by Krzysztof Cwalina and Brad Abrams, published Oct 22, 2008 by Addison-Wesley Professional as part of the Microsoft Windows Development Series.<ept id=\"p1\">*</ept>","source":"*Reprinted by permission of Pearson Education, Inc. from [Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries, 2nd Edition](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619) by Krzysztof Cwalina and Brad Abrams, published Oct 22, 2008 by Addison-Wesley Professional as part of the Microsoft Windows Development Series.*"},{"pos":[4370,4378],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4382,4462],"content":"<bpt id=\"p1\">[</bpt>Framework Design Guidelines<ept id=\"p1\">](../../../docs/standard/design-guidelines/index.md)</ept>","source":"[Framework Design Guidelines](../../../docs/standard/design-guidelines/index.md)"},{"pos":[4465,4555],"content":"<bpt id=\"p1\">[</bpt>Design Guidelines for Exceptions<ept id=\"p1\">](../../../docs/standard/design-guidelines/exceptions.md)</ept>","source":"[Design Guidelines for Exceptions](../../../docs/standard/design-guidelines/exceptions.md)"}]}