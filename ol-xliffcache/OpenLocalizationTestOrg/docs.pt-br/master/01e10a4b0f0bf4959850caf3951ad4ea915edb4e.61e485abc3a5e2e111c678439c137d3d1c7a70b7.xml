{"content":"---\ntitle: \"Using DrawingVisual Objects\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"visual layer [WPF], DrawingVisual objects\"\n  - \"DrawingVisual objects in visual layer [WPF]\"\nms.assetid: 0b4e711d-e640-40cb-81c3-8f5c59909b7d\n---\n# Using DrawingVisual Objects\nThis topic provides an overview of how to use <xref:System.Windows.Media.DrawingVisual> objects in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual layer.  \n  \n<a name=\"drawingvisual_object\"></a>   \n## DrawingVisual Object  \n The <xref:System.Windows.Media.DrawingVisual> is a lightweight drawing class that is used to render shapes, images, or text. This class is considered lightweight because it does not provide layout or event handling, which improves its performance. For this reason, drawings are ideal for backgrounds and clip art.  \n  \n<a name=\"drawingvisual_host_container\"></a>   \n## DrawingVisual Host Container  \n In order to use <xref:System.Windows.Media.DrawingVisual> objects, you need to create a host container for the objects. The host container object must derive from the <xref:System.Windows.FrameworkElement> class, which provides the layout and event handling support that the <xref:System.Windows.Media.DrawingVisual> class lacks. The host container object does not display any visible properties, since its main purpose is to contain child objects. However, the <xref:System.Windows.UIElement.Visibility%2A> property of the host container must be set to <xref:System.Windows.Visibility.Visible>; otherwise, none of its child elements will be visible.  \n  \n When you create a host container object for visual objects, you need to store the visual object references in a <xref:System.Windows.Media.VisualCollection>. Use the <xref:System.Windows.Media.VisualCollection.Add%2A> method to add a visual object to the host container. In the following example, a host container object is created, and three visual objects are added to its <xref:System.Windows.Media.VisualCollection>.  \n  \n [!code-csharp[DrawingVisualSample#100](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingVisualSample/CSharp/Window1.xaml.cs#100)]\n [!code-vb[DrawingVisualSample#100](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DrawingVisualSample/visualbasic/window1.xaml.vb#100)]  \n  \n> [!NOTE]\n>  For the complete code sample from which the preceding code example was extracted, see [Hit Test Using DrawingVisuals Sample](https://go.microsoft.com/fwlink/?LinkID=159994).  \n  \n<a name=\"creating_drawingvisual_objects\"></a>   \n## Creating DrawingVisual Objects  \n When you create a <xref:System.Windows.Media.DrawingVisual> object, it has no drawing content. You can add text, graphics, or image content by retrieving the object's <xref:System.Windows.Media.DrawingContext> and drawing into it. A <xref:System.Windows.Media.DrawingContext> is returned by calling the <xref:System.Windows.Media.DrawingVisual.RenderOpen%2A> method of a <xref:System.Windows.Media.DrawingVisual> object.  \n  \n To draw a rectangle into the <xref:System.Windows.Media.DrawingContext>, use the <xref:System.Windows.Media.DrawingContext.DrawRectangle%2A> method of the <xref:System.Windows.Media.DrawingContext> object. Similar methods exist for drawing other types of content. When you are finished drawing content into the <xref:System.Windows.Media.DrawingContext>, call the <xref:System.Windows.Media.DrawingContext.Close%2A> method to close the <xref:System.Windows.Media.DrawingContext> and persist the content.  \n  \n In the following example, a <xref:System.Windows.Media.DrawingVisual> object is created, and a rectangle is drawn into its <xref:System.Windows.Media.DrawingContext>.  \n  \n [!code-csharp[DrawingVisualSample#101](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingVisualSample/CSharp/Window1.xaml.cs#101)]\n [!code-vb[DrawingVisualSample#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DrawingVisualSample/visualbasic/window1.xaml.vb#101)]  \n  \n<a name=\"creating_overrides\"></a>   \n## Creating Overrides for FrameworkElement Members  \n The host container object is responsible for managing its collection of visual objects. This requires that the host container implement member overrides for the derived <xref:System.Windows.FrameworkElement> class.  \n  \n The following list describes the two members you must override:  \n  \n-   <xref:System.Windows.FrameworkElement.GetVisualChild%2A>: Returns a child at the specified index from the collection of child elements.  \n  \n-   <xref:System.Windows.FrameworkElement.VisualChildrenCount%2A>: Gets the number of visual child elements within this element.  \n  \n In the following example, overrides for the two <xref:System.Windows.FrameworkElement> members are implemented.  \n  \n [!code-csharp[DrawingVisualSample#102](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingVisualSample/CSharp/Window1.xaml.cs#102)]\n [!code-vb[DrawingVisualSample#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DrawingVisualSample/visualbasic/window1.xaml.vb#102)]  \n  \n<a name=\"providing_hit_testing_support\"></a>   \n## Providing Hit Testing Support  \n The host container object can provide event handling even if it does not display any visible properties—however, its <xref:System.Windows.UIElement.Visibility%2A> property must be set to <xref:System.Windows.Visibility.Visible>. This allows you to create an event handling routine for the host container that can trap mouse events, such as the release of the left mouse button. The event handling routine can then implement hit testing by invoking the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method. The method's <xref:System.Windows.Media.HitTestResultCallback> parameter refers to a user-defined procedure that you can use to determine the resulting action of a hit test.  \n  \n In the following example, hit testing support is implemented for the host container object and its children.  \n  \n [!code-csharp[DrawingVisualSample#103](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingVisualSample/CSharp/Window1.xaml.cs#103)]\n [!code-vb[DrawingVisualSample#103](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DrawingVisualSample/visualbasic/window1.xaml.vb#103)]  \n  \n## See also\n\n- <xref:System.Windows.Media.DrawingVisual>\n- <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A>\n- [WPF Graphics Rendering Overview](wpf-graphics-rendering-overview.md)\n- [Hit Testing in the Visual Layer](hit-testing-in-the-visual-layer.md)\n","nodes":[{"pos":[4,265],"embed":true,"restype":"x-metadata","content":"title: \"Using DrawingVisual Objects\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"visual layer [WPF], DrawingVisual objects\"\n  - \"DrawingVisual objects in visual layer [WPF]\"\nms.assetid: 0b4e711d-e640-40cb-81c3-8f5c59909b7d","nodes":[{"content":"Using DrawingVisual Objects","nodes":[{"pos":[0,27],"content":"Using DrawingVisual Objects","nodes":[{"content":"Using DrawingVisual Objects","pos":[0,27]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[272,299],"content":"Using DrawingVisual Objects","linkify":"Using DrawingVisual Objects","nodes":[{"content":"Using DrawingVisual Objects","pos":[0,27]}]},{"pos":[300,498],"content":"This topic provides an overview of how to use <ph id=\"ph1\">&lt;xref:System.Windows.Media.DrawingVisual&gt;</ph> objects in the <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> visual layer.","source":"This topic provides an overview of how to use <xref:System.Windows.Media.DrawingVisual> objects in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual layer."},{"pos":[546,566],"content":"DrawingVisual Object","linkify":"DrawingVisual Object","nodes":[{"content":"DrawingVisual Object","pos":[0,20]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Media.DrawingVisual&gt;</ph> is a lightweight drawing class that is used to render shapes, images, or text.","pos":[570,694],"source":"The <xref:System.Windows.Media.DrawingVisual> is a lightweight drawing class that is used to render shapes, images, or text."},{"content":"This class is considered lightweight because it does not provide layout or event handling, which improves its performance.","pos":[695,817]},{"content":"For this reason, drawings are ideal for backgrounds and clip art.","pos":[818,883]},{"pos":[939,967],"content":"DrawingVisual Host Container","linkify":"DrawingVisual Host Container","nodes":[{"content":"DrawingVisual Host Container","pos":[0,28]}]},{"content":"In order to use <ph id=\"ph1\">&lt;xref:System.Windows.Media.DrawingVisual&gt;</ph> objects, you need to create a host container for the objects.","pos":[971,1090],"source":"In order to use <xref:System.Windows.Media.DrawingVisual> objects, you need to create a host container for the objects."},{"content":"The host container object must derive from the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> class, which provides the layout and event handling support that the <ph id=\"ph2\">&lt;xref:System.Windows.Media.DrawingVisual&gt;</ph> class lacks.","pos":[1091,1300],"source":" The host container object must derive from the <xref:System.Windows.FrameworkElement> class, which provides the layout and event handling support that the <xref:System.Windows.Media.DrawingVisual> class lacks."},{"content":"The host container object does not display any visible properties, since its main purpose is to contain child objects.","pos":[1301,1419]},{"content":"However, the <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.Visibility%2A&gt;</ph> property of the host container must be set to <ph id=\"ph2\">&lt;xref:System.Windows.Visibility.Visible&gt;</ph>; otherwise, none of its child elements will be visible.","pos":[1420,1621],"source":" However, the <xref:System.Windows.UIElement.Visibility%2A> property of the host container must be set to <xref:System.Windows.Visibility.Visible>; otherwise, none of its child elements will be visible."},{"content":"When you create a host container object for visual objects, you need to store the visual object references in a <ph id=\"ph1\">&lt;xref:System.Windows.Media.VisualCollection&gt;</ph>.","pos":[1628,1785],"source":"When you create a host container object for visual objects, you need to store the visual object references in a <xref:System.Windows.Media.VisualCollection>."},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Media.VisualCollection.Add%2A&gt;</ph> method to add a visual object to the host container.","pos":[1786,1898],"source":" Use the <xref:System.Windows.Media.VisualCollection.Add%2A> method to add a visual object to the host container."},{"content":"In the following example, a host container object is created, and three visual objects are added to its <ph id=\"ph1\">&lt;xref:System.Windows.Media.VisualCollection&gt;</ph>.","pos":[1899,2048],"source":" In the following example, a host container object is created, and three visual objects are added to its <xref:System.Windows.Media.VisualCollection>."},{"pos":[2329,2513],"content":"[!NOTE]\n For the complete code sample from which the preceding code example was extracted, see [Hit Test Using DrawingVisuals Sample](https://go.microsoft.com/fwlink/?LinkID=159994).","leadings":["","> "],"nodes":[{"content":"For the complete code sample from which the preceding code example was extracted, see <bpt id=\"p1\">[</bpt>Hit Test Using DrawingVisuals Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159994)</ept>.","pos":[9,182],"source":"For the complete code sample from which the preceding code example was extracted, see [Hit Test Using DrawingVisuals Sample](https://go.microsoft.com/fwlink/?LinkID=159994)."}]},{"pos":[2571,2601],"content":"Creating DrawingVisual Objects","linkify":"Creating DrawingVisual Objects","nodes":[{"content":"Creating DrawingVisual Objects","pos":[0,30]}]},{"content":"When you create a <ph id=\"ph1\">&lt;xref:System.Windows.Media.DrawingVisual&gt;</ph> object, it has no drawing content.","pos":[2605,2699],"source":"When you create a <xref:System.Windows.Media.DrawingVisual> object, it has no drawing content."},{"content":"You can add text, graphics, or image content by retrieving the object's <ph id=\"ph1\">&lt;xref:System.Windows.Media.DrawingContext&gt;</ph> and drawing into it.","pos":[2700,2835],"source":" You can add text, graphics, or image content by retrieving the object's <xref:System.Windows.Media.DrawingContext> and drawing into it."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Windows.Media.DrawingContext&gt;</ph> is returned by calling the <ph id=\"ph2\">&lt;xref:System.Windows.Media.DrawingVisual.RenderOpen%2A&gt;</ph> method of a <ph id=\"ph3\">&lt;xref:System.Windows.Media.DrawingVisual&gt;</ph> object.","pos":[2836,3025],"source":" A <xref:System.Windows.Media.DrawingContext> is returned by calling the <xref:System.Windows.Media.DrawingVisual.RenderOpen%2A> method of a <xref:System.Windows.Media.DrawingVisual> object."},{"content":"To draw a rectangle into the <ph id=\"ph1\">&lt;xref:System.Windows.Media.DrawingContext&gt;</ph>, use the <ph id=\"ph2\">&lt;xref:System.Windows.Media.DrawingContext.DrawRectangle%2A&gt;</ph> method of the <ph id=\"ph3\">&lt;xref:System.Windows.Media.DrawingContext&gt;</ph> object.","pos":[3032,3237],"source":"To draw a rectangle into the <xref:System.Windows.Media.DrawingContext>, use the <xref:System.Windows.Media.DrawingContext.DrawRectangle%2A> method of the <xref:System.Windows.Media.DrawingContext> object."},{"content":"Similar methods exist for drawing other types of content.","pos":[3238,3295]},{"content":"When you are finished drawing content into the <ph id=\"ph1\">&lt;xref:System.Windows.Media.DrawingContext&gt;</ph>, call the <ph id=\"ph2\">&lt;xref:System.Windows.Media.DrawingContext.Close%2A&gt;</ph> method to close the <ph id=\"ph3\">&lt;xref:System.Windows.Media.DrawingContext&gt;</ph> and persist the content.","pos":[3296,3535],"source":" When you are finished drawing content into the <xref:System.Windows.Media.DrawingContext>, call the <xref:System.Windows.Media.DrawingContext.Close%2A> method to close the <xref:System.Windows.Media.DrawingContext> and persist the content."},{"pos":[3542,3708],"content":"In the following example, a <ph id=\"ph1\">&lt;xref:System.Windows.Media.DrawingVisual&gt;</ph> object is created, and a rectangle is drawn into its <ph id=\"ph2\">&lt;xref:System.Windows.Media.DrawingContext&gt;</ph>.","source":"In the following example, a <xref:System.Windows.Media.DrawingVisual> object is created, and a rectangle is drawn into its <xref:System.Windows.Media.DrawingContext>."},{"pos":[4027,4074],"content":"Creating Overrides for FrameworkElement Members","linkify":"Creating Overrides for FrameworkElement Members","nodes":[{"content":"Creating Overrides for FrameworkElement Members","pos":[0,47]}]},{"content":"The host container object is responsible for managing its collection of visual objects.","pos":[4078,4165]},{"content":"This requires that the host container implement member overrides for the derived <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> class.","pos":[4166,4292],"source":" This requires that the host container implement member overrides for the derived <xref:System.Windows.FrameworkElement> class."},{"content":"The following list describes the two members you must override:","pos":[4299,4362]},{"pos":[4372,4507],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.GetVisualChild%2A&gt;</ph>: Returns a child at the specified index from the collection of child elements.","source":"<xref:System.Windows.FrameworkElement.GetVisualChild%2A>: Returns a child at the specified index from the collection of child elements."},{"pos":[4517,4641],"content":"<ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.VisualChildrenCount%2A&gt;</ph>: Gets the number of visual child elements within this element.","source":"<xref:System.Windows.FrameworkElement.VisualChildrenCount%2A>: Gets the number of visual child elements within this element."},{"pos":[4648,4759],"content":"In the following example, overrides for the two <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement&gt;</ph> members are implemented.","source":"In the following example, overrides for the two <xref:System.Windows.FrameworkElement> members are implemented."},{"pos":[4766,5032],"content":"[!code-csharp[DrawingVisualSample#102](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingVisualSample/CSharp/Window1.xaml.cs#102)]\n[!code-vb[DrawingVisualSample#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DrawingVisualSample/visualbasic/window1.xaml.vb#102)]","leadings":[""," "],"nodes":[]},{"pos":[5089,5118],"content":"Providing Hit Testing Support","linkify":"Providing Hit Testing Support","nodes":[{"content":"Providing Hit Testing Support","pos":[0,29]}]},{"content":"The host container object can provide event handling even if it does not display any visible properties—however, its <ph id=\"ph1\">&lt;xref:System.Windows.UIElement.Visibility%2A&gt;</ph> property must be set to <ph id=\"ph2\">&lt;xref:System.Windows.Visibility.Visible&gt;</ph>.","pos":[5122,5350],"source":"The host container object can provide event handling even if it does not display any visible properties—however, its <xref:System.Windows.UIElement.Visibility%2A> property must be set to <xref:System.Windows.Visibility.Visible>."},{"content":"This allows you to create an event handling routine for the host container that can trap mouse events, such as the release of the left mouse button.","pos":[5351,5499]},{"content":"The event handling routine can then implement hit testing by invoking the <ph id=\"ph1\">&lt;xref:System.Windows.Media.VisualTreeHelper.HitTest%2A&gt;</ph> method.","pos":[5500,5637],"source":" The event handling routine can then implement hit testing by invoking the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method."},{"content":"The method's <ph id=\"ph1\">&lt;xref:System.Windows.Media.HitTestResultCallback&gt;</ph> parameter refers to a user-defined procedure that you can use to determine the resulting action of a hit test.","pos":[5638,5811],"source":" The method's <xref:System.Windows.Media.HitTestResultCallback> parameter refers to a user-defined procedure that you can use to determine the resulting action of a hit test."},{"content":"In the following example, hit testing support is implemented for the host container object and its children.","pos":[5818,5926]},{"pos":[6208,6216],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6322,6391],"content":"<bpt id=\"p1\">[</bpt>WPF Graphics Rendering Overview<ept id=\"p1\">](wpf-graphics-rendering-overview.md)</ept>","source":"[WPF Graphics Rendering Overview](wpf-graphics-rendering-overview.md)"},{"pos":[6394,6463],"content":"<bpt id=\"p1\">[</bpt>Hit Testing in the Visual Layer<ept id=\"p1\">](hit-testing-in-the-visual-layer.md)</ept>","source":"[Hit Testing in the Visual Layer](hit-testing-in-the-visual-layer.md)"}]}