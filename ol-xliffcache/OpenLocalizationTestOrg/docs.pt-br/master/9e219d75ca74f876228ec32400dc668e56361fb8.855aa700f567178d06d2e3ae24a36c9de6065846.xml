{"content":"---\ntitle: \"Access Embedded Objects Using UI Automation | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"embedded objects, accessing\"\n  - \"accessing embedded objects\"\n  - \"UI Automation, accessing embedded objects\"\nms.assetid: a5b513ec-7fa6-4460-869f-c18ff04f7cf2\ncaps.latest.revision: 17\nauthor: \"Xansky\"\nms.author: \"mhopkins\"\nmanager: \"markl\"\n---\n# Access Embedded Objects Using UI Automation\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This topic shows how [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] can be used to expose objects embedded within the content of a text control.  \n  \n> [!NOTE]\n>  Embedded objects can include images, hyperlinks, buttons, tables, or ActiveX controls.  \n  \n Embedded objects are considered children of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text provider. This allows them to be exposed through the same UI Automation tree structure as all other [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] elements. Functionality, in turn, is exposed through the control patterns typically required by the embedded objects control type (for example, since hyperlinks are text-based they will support <xref:System.Windows.Automation.TextPattern>).  \n  \n ![Embedded objects in a text container.](../../../docs/framework/ui-automation/media/uia-textpattern-embeddedobjects.PNG \"UIA_TextPattern_EmbeddedObjects\")  \nA sample document with textual content, (\"Did You Know?\"…) and two embedded objects (a picture of a whale and a text hyperlink), used as a target for the code examples.  \n  \n## Example  \n The following code example demonstrates how to retrieve a collection of embedded objects from within a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text provider. For the sample document provided in the introduction, two objects would be returned (an image element and a text element).  \n  \n> [!NOTE]\n>  The image element should have some intrinsic text associated with it that describes the image, typically in its <xref:System.Windows.Automation.AutomationElement.NameProperty> (for example, \"A blue whale.\"). However, when a text range spanning the image object is obtained, neither the image nor this descriptive text is returned in the text stream.  \n  \n [!code-csharp[FindText#StartApp](../../../samples/snippets/csharp/VS_Snippets_Wpf/FindText/CSharp/SearchWindow.cs#startapp)]\n [!code-vb[FindText#StartApp](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FindText/VisualBasic/SearchWindow.vb#startapp)]  \n[!code-csharp[FindText#FindTextProvider](../../../samples/snippets/csharp/VS_Snippets_Wpf/FindText/CSharp/SearchWindow.cs#findtextprovider)]\n[!code-vb[FindText#FindTextProvider](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FindText/VisualBasic/SearchWindow.vb#findtextprovider)]  \n[!code-csharp[FindText#GetChildren](../../../samples/snippets/csharp/VS_Snippets_Wpf/FindText/CSharp/SearchWindow.cs#getchildren)]\n[!code-vb[FindText#GetChildren](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FindText/VisualBasic/SearchWindow.vb#getchildren)]  \n  \n## Example  \n The following code example demonstrates how to obtain a text range from an embedded object within a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text provider. The text range retrieved is an empty range where the starting endpoint follows \"… ocean.(space)\" and the ending endpoint precedes the closing \".\" representing the embedded hyperlink (as shown by the image provided in the introduction). Even though this is an empty range, it is not considered a degenerate range because it has a non-zero span.  \n  \n> [!NOTE]\n>  <xref:System.Windows.Automation.TextPattern> can retrieve a text-based embedded object such as a hyperlink; however, a secondary <xref:System.Windows.Automation.TextPattern> will have to be obtained from the embedded object to expose its full functionality.  \n  \n [!code-csharp[UIATextPattern_snip#GetRangeFromChild](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIATextPattern_snip/CSharp/SearchWindow.cs#getrangefromchild)]\n [!code-vb[UIATextPattern_snip#GetRangeFromChild](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIATextPattern_snip/VisualBasic/SearchWindow.vb#getrangefromchild)]  \n  \n## See Also  \n [UI Automation TextPattern Overview](../../../docs/framework/ui-automation/ui-automation-textpattern-overview.md)   \n [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)   \n [UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)   \n [Add Content to a Text Box Using UI Automation](../../../docs/framework/ui-automation/add-content-to-a-text-box-using-ui-automation.md)   \n [Find and Highlight Text Using UI Automation](../../../docs/framework/ui-automation/find-and-highlight-text-using-ui-automation.md)","nodes":[{"pos":[4,502],"nodes":[{"content":"Access Embedded Objects Using UI Automation | Microsoft Docs","nodes":[{"pos":[0,60],"content":"Access Embedded Objects Using UI Automation | Microsoft Docs","nodes":[{"content":"Access Embedded Objects Using UI Automation | Microsoft Docs","pos":[0,60]}]}],"pos":[6,69],"yaml":true}],"content":"title: \"Access Embedded Objects Using UI Automation | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"embedded objects, accessing\"\n  - \"accessing embedded objects\"\n  - \"UI Automation, accessing embedded objects\"\nms.assetid: a5b513ec-7fa6-4460-869f-c18ff04f7cf2\ncaps.latest.revision: 17\nauthor: \"Xansky\"\nms.author: \"mhopkins\"\nmanager: \"markl\"","yamlblock":true},{"pos":[509,552],"content":"Access Embedded Objects Using UI Automation","linkify":"Access Embedded Objects Using UI Automation","nodes":[{"content":"Access Embedded Objects Using UI Automation","pos":[0,43]}]},{"pos":[555,1017],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,460],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,451],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"pos":[1024,1204],"content":"This topic shows how <ph id=\"ph1\">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)]</ph> can be used to expose objects embedded within the content of a text control.","source":"This topic shows how [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] can be used to expose objects embedded within the content of a text control."},{"pos":[1212,1309],"content":"[!NOTE]\n Embedded objects can include images, hyperlinks, buttons, tables, or ActiveX controls.","leadings":["","> "],"nodes":[{"content":"Embedded objects can include images, hyperlinks, buttons, tables, or ActiveX controls.","pos":[9,95]}]},{"content":"Embedded objects are considered children of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> text provider.","pos":[1316,1463],"source":"Embedded objects are considered children of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text provider."},{"content":"This allows them to be exposed through the same UI Automation tree structure as all other <ph id=\"ph1\">[!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)]</ph> elements.","pos":[1464,1626],"source":" This allows them to be exposed through the same UI Automation tree structure as all other [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] elements."},{"content":"Functionality, in turn, is exposed through the control patterns typically required by the embedded objects control type (for example, since hyperlinks are text-based they will support <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph>).","pos":[1627,1857],"source":" Functionality, in turn, is exposed through the control patterns typically required by the embedded objects control type (for example, since hyperlinks are text-based they will support <xref:System.Windows.Automation.TextPattern>)."},{"content":"<bpt id=\"p1\">![</bpt>Embedded objects in a text container.<ept id=\"p1\">](../../../docs/framework/ui-automation/media/uia-textpattern-embeddedobjects.PNG \"UIA_TextPattern_EmbeddedObjects\")</ept>","pos":[1864,2019],"source":"![Embedded objects in a text container.](../../../docs/framework/ui-automation/media/uia-textpattern-embeddedobjects.PNG \"UIA_TextPattern_EmbeddedObjects\")"},{"content":"A sample document with textual content, (\"Did You Know?\"…) and two embedded objects (a picture of a whale and a text hyperlink), used as a target for the code examples.","pos":[2022,2190]},{"pos":[2199,2206],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example demonstrates how to retrieve a collection of embedded objects from within a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> text provider.","pos":[2210,2412],"source":"The following code example demonstrates how to retrieve a collection of embedded objects from within a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text provider."},{"content":"For the sample document provided in the introduction, two objects would be returned (an image element and a text element).","pos":[2413,2535]},{"pos":[2543,2903],"content":"[!NOTE]\n The image element should have some intrinsic text associated with it that describes the image, typically in its <xref:System.Windows.Automation.AutomationElement.NameProperty> (for example, \"A blue whale.\"). However, when a text range spanning the image object is obtained, neither the image nor this descriptive text is returned in the text stream.","leadings":["","> "],"nodes":[{"content":"The image element should have some intrinsic text associated with it that describes the image, typically in its <xref:System.Windows.Automation.AutomationElement.NameProperty> (for example, \"A blue whale.\"). However, when a text range spanning the image object is obtained, neither the image nor this descriptive text is returned in the text stream.","pos":[9,358],"nodes":[{"content":"The image element should have some intrinsic text associated with it that describes the image, typically in its <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.NameProperty&gt;</ph> (for example, \"A blue whale.\").","pos":[0,207],"source":"The image element should have some intrinsic text associated with it that describes the image, typically in its <xref:System.Windows.Automation.AutomationElement.NameProperty> (for example, \"A blue whale.\")."},{"content":"However, when a text range spanning the image object is obtained, neither the image nor this descriptive text is returned in the text stream.","pos":[208,349]}]}]},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>FindText#StartApp<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Wpf/FindText/CSharp/SearchWindow.cs#startapp)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>FindText#StartApp<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FindText/VisualBasic/SearchWindow.vb#startapp)</ept><ept id=\"p3\">]</ept>","pos":[2910,3166],"source":"[!code-csharp[FindText#StartApp](../../../samples/snippets/csharp/VS_Snippets_Wpf/FindText/CSharp/SearchWindow.cs#startapp)]\n [!code-vb[FindText#StartApp](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FindText/VisualBasic/SearchWindow.vb#startapp)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>FindText#FindTextProvider<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Wpf/FindText/CSharp/SearchWindow.cs#findtextprovider)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>FindText#FindTextProvider<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FindText/VisualBasic/SearchWindow.vb#findtextprovider)</ept><ept id=\"p3\">]</ept>","pos":[3169,3456],"source":"[!code-csharp[FindText#FindTextProvider](../../../samples/snippets/csharp/VS_Snippets_Wpf/FindText/CSharp/SearchWindow.cs#findtextprovider)]\n[!code-vb[FindText#FindTextProvider](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FindText/VisualBasic/SearchWindow.vb#findtextprovider)]"},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>FindText#GetChildren<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Wpf/FindText/CSharp/SearchWindow.cs#getchildren)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>FindText#GetChildren<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FindText/VisualBasic/SearchWindow.vb#getchildren)</ept><ept id=\"p3\">]</ept>","pos":[3459,3726],"source":"[!code-csharp[FindText#GetChildren](../../../samples/snippets/csharp/VS_Snippets_Wpf/FindText/CSharp/SearchWindow.cs#getchildren)]\n[!code-vb[FindText#GetChildren](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FindText/VisualBasic/SearchWindow.vb#getchildren)]"},{"pos":[3735,3742],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example demonstrates how to obtain a text range from an embedded object within a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> text provider.","pos":[3746,3945],"source":"The following code example demonstrates how to obtain a text range from an embedded object within a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text provider."},{"content":"The text range retrieved is an empty range where the starting endpoint follows \"…","pos":[3946,4027]},{"content":"ocean.(space)\" and the ending endpoint precedes the closing \".\" representing the embedded hyperlink (as shown by the image provided in the introduction).","pos":[4028,4181]},{"content":"Even though this is an empty range, it is not considered a degenerate range because it has a non-zero span.","pos":[4182,4289]},{"pos":[4297,4565],"content":"[!NOTE]\n <xref:System.Windows.Automation.TextPattern> can retrieve a text-based embedded object such as a hyperlink; however, a secondary <xref:System.Windows.Automation.TextPattern> will have to be obtained from the embedded object to expose its full functionality.","leadings":["","> "],"nodes":[{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> can retrieve a text-based embedded object such as a hyperlink; however, a secondary <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TextPattern&gt;</ph> will have to be obtained from the embedded object to expose its full functionality.","pos":[9,266],"source":"<xref:System.Windows.Automation.TextPattern> can retrieve a text-based embedded object such as a hyperlink; however, a secondary <xref:System.Windows.Automation.TextPattern> will have to be obtained from the embedded object to expose its full functionality."}]},{"pos":[4572,4908],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>UIATextPattern_snip#GetRangeFromChild<ept id=\"p2\">](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIATextPattern_snip/CSharp/SearchWindow.cs#getrangefromchild)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>UIATextPattern_snip#GetRangeFromChild<ept id=\"p4\">](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIATextPattern_snip/VisualBasic/SearchWindow.vb#getrangefromchild)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[UIATextPattern_snip#GetRangeFromChild](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIATextPattern_snip/CSharp/SearchWindow.cs#getrangefromchild)]\n [!code-vb[UIATextPattern_snip#GetRangeFromChild](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIATextPattern_snip/VisualBasic/SearchWindow.vb#getrangefromchild)]"},{"pos":[4917,4925],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>UI Automation TextPattern Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-textpattern-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[4929,5043],"source":"[UI Automation TextPattern Overview](../../../docs/framework/ui-automation/ui-automation-textpattern-overview.md) "},{"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[5047,5171],"source":"[UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md) "},{"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns for Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)</ept><ph id=\"ph1\"> </ph>","pos":[5175,5305],"source":"[UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md) "},{"content":"<bpt id=\"p1\">[</bpt>Add Content to a Text Box Using UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/add-content-to-a-text-box-using-ui-automation.md)</ept><ph id=\"ph1\"> </ph>","pos":[5309,5445],"source":"[Add Content to a Text Box Using UI Automation](../../../docs/framework/ui-automation/add-content-to-a-text-box-using-ui-automation.md) "},{"content":"<bpt id=\"p1\">[</bpt>Find and Highlight Text Using UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/find-and-highlight-text-using-ui-automation.md)</ept>","pos":[5449,5580],"source":"[Find and Highlight Text Using UI Automation](../../../docs/framework/ui-automation/find-and-highlight-text-using-ui-automation.md)"}]}