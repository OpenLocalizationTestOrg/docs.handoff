{"content":"---\ntitle: \"How to: Access a WSE 3.0 Service with a WCF Client | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 1f9bcd9b-8f8f-47fa-8f1e-0d47236eb800\ncaps.latest.revision: 12\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Access a WSE 3.0 Service with a WCF Client\n[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] clients are wire-level compatible with Web Services Enhancements (WSE) 3.0 for Microsoft .NET services when [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients are configured to use the August 2004 version of the WS-Addressing specification. However, WSE 3.0 services do not support the metadata exchange (MEX) protocol, so when you use the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to create a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client class, the security settings are not applied to the generated [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client. Therefore, you must specify the security settings that the WSE 3.0 service requires after the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client is generated.  \n  \n You can apply these security settings by using a custom binding to take into account the WSE 3.0 service's requirements and the interoperable requirements between a WSE 3.0 service and a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client. These interoperability requirements include the aforementioned use of the August 2004 WS-Addressing specification and the  WSE 3.0default message protection of <xref:System.ServiceModel.Security.MessageProtectionOrder>. The default message protection for [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is <xref:System.ServiceModel.Security.MessageProtectionOrder>. This topic details how to create a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] binding that interoperates with a WSE 3.0 service. [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] also provides a sample that incorporates this binding. [!INCLUDE[crabout](../../../../includes/crabout-md.md)] this sample, see [Interoperating with ASMX Web Services](../../../../docs/framework/wcf/samples/interoperating-with-asmx-web-services.md).  \n  \n### To access a WSE 3.0 Web service with a WCF client  \n  \n1.  Run the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to create a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client for the WSE 3.0 Web service.  \n  \n     For a WSE 3.0 Web service, a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client is created. Because WSE 3.0 does not support the MEX protocol, you cannot use the tool to retrieve the security requirements for the Web service. The application developer must add the security settings for the client.  \n  \n     [!INCLUDE[crabout](../../../../includes/crabout-md.md)] creating a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client, see the [How to: Create a Client](../../../../docs/framework/wcf/how-to-create-a-wcf-client.md).  \n  \n2.  Create a class that represents a binding that can communicate with WSE 3.0 Web services.  \n  \n     The following class is part of the [Interoperating with WSE](http://msdn.microsoft.com/en-us/f6816861-96a0-45f9-8736-8e4e82cd3a41) sample:  \n  \n    1.  Create a class that derives from the <xref:System.ServiceModel.Channels.Binding> class.  \n  \n         The following code example creates a class named `WseHttpBinding` that derives from the <xref:System.ServiceModel.Channels.Binding> class.  \n  \n         [!code-csharp[c_WCFClientToWSEService#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_wcfclienttowseservice/cs/wsehttpbinding.cs#1)]\n         [!code-vb[c_WCFClientToWSEService#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_wcfclienttowseservice/vb/wsehttpbinding.vb#1)]  \n  \n    2.  Add properties to the class that specify the WSE turnkey assertion used by the WSE service, whether derived keys are required, whether secure sessions are used, whether signature confirmations are required, and the message protection settings. In WSE 3.0, a turnkey assertion specifies the security requirements for a client or Web serviceâ€”similar to the authentication mode of a binding in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].  \n  \n         The following code example defines the `SecurityAssertion`, `RequireDerivedKeys`, `EstablishSecurityContext`, and `MessageProtectionOrder` properties that specify the WSE turnkey assertion, whether derived keys are required, whether secure sessions are used, whether signature confirmations are required, and the message protection settings, respectively.  \n  \n         [!code-csharp[c_WCFClientToWSEService#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_wcfclienttowseservice/cs/wsehttpbinding.cs#3)]\n         [!code-vb[c_WCFClientToWSEService#3](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_wcfclienttowseservice/vb/wsehttpbinding.vb#3)]  \n  \n    3.  Override the <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> method to set the binding properties.  \n  \n         The following code example specifies the transport, message encoding, and message protection settings by getting the values of the `SecurityAssertion` and `MessageProtectionOrder` properties.  \n  \n         [!code-csharp[c_WCFClientToWSEService#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_wcfclienttowseservice/cs/wsehttpbinding.cs#2)]\n         [!code-vb[c_WCFClientToWSEService#2](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_wcfclienttowseservice/vb/wsehttpbinding.vb#2)]  \n  \n3.  In the client application code, add code to set the binding properties.  \n  \n     The following code example specifies that the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client must use message protection and authentication as defined by the WSE 3.0 `AnonymousForCertificate` turnkey security assertion. Additionally, secure sessions and derived keys are required.  \n  \n     [!code-csharp[c_WCFClientToWSEService#4](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_wcfclienttowseservice/cs/client.cs#4)]\n     [!code-vb[c_WCFClientToWSEService#4](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_wcfclienttowseservice/vb/client.vb#4)]  \n  \n## Example  \n The following code example defines a custom binding that exposes properties that correspond to the properties of a WSE 3.0 turnkey security assertion. That custom binding, which is named `WseHttpBinding`, is then used to specify the binding properties for a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client that communicates with the WSSecurityAnonymous WSE 3.0 QuickStart sample.  \n  \n  \n  \n## See Also  \n <xref:System.ServiceModel.Channels.Binding>   \n [Interoperating with WSE](http://msdn.microsoft.com/en-us/f6816861-96a0-45f9-8736-8e4e82cd3a41)","nodes":[{"pos":[4,371],"embed":true,"restype":"x-metadata","content":"title: \"How to: Access a WSE 3.0 Service with a WCF Client | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 1f9bcd9b-8f8f-47fa-8f1e-0d47236eb800\ncaps.latest.revision: 12\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","nodes":[{"content":"How to: Access a WSE 3.0 Service with a WCF Client | Microsoft Docs","nodes":[{"pos":[0,67],"content":"How to: Access a WSE 3.0 Service with a WCF Client | Microsoft Docs","nodes":[{"content":"How to: Access a WSE 3.0 Service with a WCF Client | Microsoft Docs","pos":[0,67]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[378,428],"content":"How to: Access a WSE 3.0 Service with a WCF Client","linkify":"How to: Access a WSE 3.0 Service with a WCF Client","nodes":[{"content":"How to: Access a WSE 3.0 Service with a WCF Client","pos":[0,50]}]},{"content":"clients are wire-level compatible with Web Services Enhancements (WSE) 3.0 for Microsoft .NET services when <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> clients are configured to use the August 2004 version of the WS-Addressing specification.","pos":[485,738],"source":" clients are wire-level compatible with Web Services Enhancements (WSE) 3.0 for Microsoft .NET services when [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients are configured to use the August 2004 version of the WS-Addressing specification."},{"content":"However, WSE 3.0 services do not support the metadata exchange (MEX) protocol, so when you use the <bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept> to create a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client class, the security settings are not applied to the generated <ph id=\"ph2\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client.","pos":[739,1171],"source":" However, WSE 3.0 services do not support the metadata exchange (MEX) protocol, so when you use the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to create a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client class, the security settings are not applied to the generated [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client."},{"content":"Therefore, you must specify the security settings that the WSE 3.0 service requires after the <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client is generated.","pos":[1172,1342],"source":" Therefore, you must specify the security settings that the WSE 3.0 service requires after the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client is generated."},{"content":"You can apply these security settings by using a custom binding to take into account the WSE 3.0 service's requirements and the interoperable requirements between a WSE 3.0 service and a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client.","pos":[1349,1599],"source":"You can apply these security settings by using a custom binding to take into account the WSE 3.0 service's requirements and the interoperable requirements between a WSE 3.0 service and a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client."},{"content":"These interoperability requirements include the aforementioned use of the August 2004 WS-Addressing specification and the  WSE 3.0default message protection of <ph id=\"ph1\">&lt;xref:System.ServiceModel.Security.MessageProtectionOrder&gt;</ph>.","pos":[1600,1819],"source":" These interoperability requirements include the aforementioned use of the August 2004 WS-Addressing specification and the  WSE 3.0default message protection of <xref:System.ServiceModel.Security.MessageProtectionOrder>."},{"content":"The default message protection for <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> is <ph id=\"ph2\">&lt;xref:System.ServiceModel.Security.MessageProtectionOrder&gt;</ph>.","pos":[1820,1973],"source":" The default message protection for [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is <xref:System.ServiceModel.Security.MessageProtectionOrder>."},{"content":"This topic details how to create a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> binding that interoperates with a WSE 3.0 service.","pos":[1974,2115],"source":" This topic details how to create a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] binding that interoperates with a WSE 3.0 service."},{"content":"<ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> also provides a sample that incorporates this binding.","pos":[2116,2226],"source":"[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] also provides a sample that incorporates this binding."},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> this sample, see <bpt id=\"p1\">[</bpt>Interoperating with ASMX Web Services<ept id=\"p1\">](../../../../docs/framework/wcf/samples/interoperating-with-asmx-web-services.md)</ept>.","pos":[2227,2421],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] this sample, see [Interoperating with ASMX Web Services](../../../../docs/framework/wcf/samples/interoperating-with-asmx-web-services.md)."},{"pos":[2431,2480],"content":"To access a WSE 3.0 Web service with a WCF client","linkify":"To access a WSE 3.0 Web service with a WCF client","nodes":[{"content":"To access a WSE 3.0 Web service with a WCF client","pos":[0,49]}]},{"pos":[2490,2734],"content":"Run the <bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept> to create a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client for the WSE 3.0 Web service.","source":"Run the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to create a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client for the WSE 3.0 Web service."},{"content":"For a WSE 3.0 Web service, a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client is created.","pos":[2745,2848],"source":"For a WSE 3.0 Web service, a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client is created."},{"content":"Because WSE 3.0 does not support the MEX protocol, you cannot use the tool to retrieve the security requirements for the Web service.","pos":[2849,2982]},{"content":"The application developer must add the security settings for the client.","pos":[2983,3055]},{"pos":[3122,3293],"content":"creating a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client, see the <bpt id=\"p1\">[</bpt>How to: Create a Client<ept id=\"p1\">](../../../../docs/framework/wcf/how-to-create-a-wcf-client.md)</ept>.","source":" creating a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client, see the [How to: Create a Client](../../../../docs/framework/wcf/how-to-create-a-wcf-client.md)."},{"content":"Create a class that represents a binding that can communicate with WSE 3.0 Web services.","pos":[3303,3391]},{"pos":[3402,3540],"content":"The following class is part of the <bpt id=\"p1\">[</bpt>Interoperating with WSE<ept id=\"p1\">](http://msdn.microsoft.com/en-us/f6816861-96a0-45f9-8736-8e4e82cd3a41)</ept> sample:","source":"The following class is part of the [Interoperating with WSE](http://msdn.microsoft.com/en-us/f6816861-96a0-45f9-8736-8e4e82cd3a41) sample:"},{"content":"Create a class that derives from the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Binding&gt;</ph> class.","pos":[3554,3641],"source":"Create a class that derives from the <xref:System.ServiceModel.Channels.Binding> class."},{"pos":[3656,3794],"content":"The following code example creates a class named <ph id=\"ph1\">`WseHttpBinding`</ph> that derives from the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.Binding&gt;</ph> class.","source":"The following code example creates a class named `WseHttpBinding` that derives from the <xref:System.ServiceModel.Channels.Binding> class."},{"pos":[3809,4102],"content":"[!code-csharp[c_WCFClientToWSEService#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_wcfclienttowseservice/cs/wsehttpbinding.cs#1)]\n [!code-vb[c_WCFClientToWSEService#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_wcfclienttowseservice/vb/wsehttpbinding.vb#1)]","leadings":["","        "],"nodes":[]},{"content":"Add properties to the class that specify the WSE turnkey assertion used by the WSE service, whether derived keys are required, whether secure sessions are used, whether signature confirmations are required, and the message protection settings.","pos":[4116,4359]},{"content":"In WSE 3.0, a turnkey assertion specifies the security requirements for a client or Web serviceâ€”similar to the authentication mode of a binding in <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph>.","pos":[4360,4563],"source":" In WSE 3.0, a turnkey assertion specifies the security requirements for a client or Web serviceâ€”similar to the authentication mode of a binding in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]."},{"pos":[4578,4933],"content":"The following code example defines the <ph id=\"ph1\">`SecurityAssertion`</ph>, <ph id=\"ph2\">`RequireDerivedKeys`</ph>, <ph id=\"ph3\">`EstablishSecurityContext`</ph>, and <ph id=\"ph4\">`MessageProtectionOrder`</ph> properties that specify the WSE turnkey assertion, whether derived keys are required, whether secure sessions are used, whether signature confirmations are required, and the message protection settings, respectively.","source":"The following code example defines the `SecurityAssertion`, `RequireDerivedKeys`, `EstablishSecurityContext`, and `MessageProtectionOrder` properties that specify the WSE turnkey assertion, whether derived keys are required, whether secure sessions are used, whether signature confirmations are required, and the message protection settings, respectively."},{"pos":[4948,5241],"content":"[!code-csharp[c_WCFClientToWSEService#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_wcfclienttowseservice/cs/wsehttpbinding.cs#3)]\n [!code-vb[c_WCFClientToWSEService#3](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_wcfclienttowseservice/vb/wsehttpbinding.vb#3)]","leadings":["","        "],"nodes":[]},{"content":"Override the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A&gt;</ph> method to set the binding properties.","pos":[5255,5374],"source":"Override the <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> method to set the binding properties."},{"pos":[5389,5580],"content":"The following code example specifies the transport, message encoding, and message protection settings by getting the values of the <ph id=\"ph1\">`SecurityAssertion`</ph> and <ph id=\"ph2\">`MessageProtectionOrder`</ph> properties.","source":"The following code example specifies the transport, message encoding, and message protection settings by getting the values of the `SecurityAssertion` and `MessageProtectionOrder` properties."},{"pos":[5595,5888],"content":"[!code-csharp[c_WCFClientToWSEService#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_wcfclienttowseservice/cs/wsehttpbinding.cs#2)]\n [!code-vb[c_WCFClientToWSEService#2](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_wcfclienttowseservice/vb/wsehttpbinding.vb#2)]","leadings":["","        "],"nodes":[]},{"content":"In the client application code, add code to set the binding properties.","pos":[5898,5969]},{"content":"The following code example specifies that the <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client must use message protection and authentication as defined by the WSE 3.0 <ph id=\"ph2\">`AnonymousForCertificate`</ph> turnkey security assertion.","pos":[5980,6215],"source":"The following code example specifies that the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client must use message protection and authentication as defined by the WSE 3.0 `AnonymousForCertificate` turnkey security assertion."},{"content":"Additionally, secure sessions and derived keys are required.","pos":[6216,6276]},{"pos":[6287,6560],"content":"[!code-csharp[c_WCFClientToWSEService#4](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_wcfclienttowseservice/cs/client.cs#4)]\n [!code-vb[c_WCFClientToWSEService#4](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_wcfclienttowseservice/vb/client.vb#4)]","leadings":["","    "],"nodes":[]},{"pos":[6569,6576],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example defines a custom binding that exposes properties that correspond to the properties of a WSE 3.0 turnkey security assertion.","pos":[6580,6730]},{"content":"That custom binding, which is named <ph id=\"ph1\">`WseHttpBinding`</ph>, is then used to specify the binding properties for a <ph id=\"ph2\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client that communicates with the WSSecurityAnonymous WSE 3.0 QuickStart sample.","pos":[6731,6974],"source":" That custom binding, which is named `WseHttpBinding`, is then used to specify the binding properties for a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client that communicates with the WSSecurityAnonymous WSE 3.0 QuickStart sample."},{"pos":[6989,6997],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Binding&gt;</ph>","pos":[7001,7044],"source":"<xref:System.ServiceModel.Channels.Binding> "},{"content":"<bpt id=\"p1\">[</bpt>Interoperating with WSE<ept id=\"p1\">](http://msdn.microsoft.com/en-us/f6816861-96a0-45f9-8736-8e4e82cd3a41)</ept>","pos":[7049,7144],"source":"[Interoperating with WSE](http://msdn.microsoft.com/en-us/f6816861-96a0-45f9-8736-8e4e82cd3a41)"}]}