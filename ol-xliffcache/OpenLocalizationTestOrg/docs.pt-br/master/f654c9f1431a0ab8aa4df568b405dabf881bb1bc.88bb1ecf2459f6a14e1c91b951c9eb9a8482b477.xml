{"content":"---\ntitle: \"How to: Clone a Printer\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"print queues [WPF]\"\n  - \"cloning printers [WPF]\"\n  - \"printers [WPF], cloning\"\n  - \"print queues [WPF], cloning\"\n  - \"cloning print queues [WPF]\"\nms.assetid: dd6997c9-fe04-40f8-88a6-92e3ac0889eb\n---\n# How to: Clone a Printer\nMost businesses will, at some point, buy multiple printers of the same model. Typically, these are all installed with virtually identical configuration settings. Installing each printer can be time-consuming and error prone. The <xref:System.Printing.IndexedProperties?displayProperty=nameWithType> namespace and the <xref:System.Printing.PrintServer.InstallPrintQueue%2A> class that are exposed with Microsoft .NET Framework makes it possible to instantly install any number of additional print queues that are cloned from an existing print queue.  \n  \n## Example  \n In the example below, a second print queue is cloned from an existing print queue. The second differs from the first only in its name, location, port, and shared status. The major steps for doing this are as follows.  \n  \n1.  Create a <xref:System.Printing.PrintQueue> object for the existing printer that is going to be cloned.  \n  \n2.  Create a <xref:System.Printing.IndexedProperties.PrintPropertyDictionary> from the <xref:System.Printing.PrintSystemObject.PropertiesCollection%2A> of the <xref:System.Printing.PrintQueue>. The <xref:System.Collections.DictionaryEntry.Value%2A> property of each entry in this dictionary is an object of one of the types derived from <xref:System.Printing.IndexedProperties.PrintProperty>. There are two ways to set the value of an entry in this dictionary.  \n  \n    -   Use the dictionary's **Remove** and <xref:System.Printing.IndexedProperties.PrintPropertyDictionary.Add%2A> methods to remove the entry and then re-add it with the desired value.  \n  \n    -   Use the dictionary's <xref:System.Printing.IndexedProperties.PrintPropertyDictionary.SetProperty%2A> method.  \n  \n     The example below illustrates both ways.  \n  \n3.  Create a <xref:System.Printing.IndexedProperties.PrintBooleanProperty> object and set its <xref:System.Printing.IndexedProperties.PrintProperty.Name%2A> to \"IsShared\" and its <xref:System.Printing.IndexedProperties.PrintBooleanProperty.Value%2A> to `true`.  \n  \n4.  Use the <xref:System.Printing.IndexedProperties.PrintBooleanProperty> object to be the value of the <xref:System.Printing.IndexedProperties.PrintPropertyDictionary>'s \"IsShared\" entry.  \n  \n5.  Create a <xref:System.Printing.IndexedProperties.PrintStringProperty> object and set its <xref:System.Printing.IndexedProperties.PrintProperty.Name%2A> to \"ShareName\" and its <xref:System.Printing.IndexedProperties.PrintStringProperty.Value%2A> to an appropriate <xref:System.String>.  \n  \n6.  Use the <xref:System.Printing.IndexedProperties.PrintStringProperty> object to be the value of the <xref:System.Printing.IndexedProperties.PrintPropertyDictionary>'s \"ShareName\" entry.  \n  \n7.  Create another <xref:System.Printing.IndexedProperties.PrintStringProperty> object and set its <xref:System.Printing.IndexedProperties.PrintProperty.Name%2A> to \"Location\" and its <xref:System.Printing.IndexedProperties.PrintStringProperty.Value%2A> to an appropriate <xref:System.String>.  \n  \n8.  Use the second <xref:System.Printing.IndexedProperties.PrintStringProperty> object to be the value of the <xref:System.Printing.IndexedProperties.PrintPropertyDictionary>'s \"Location\" entry.  \n  \n9. Create an array of <xref:System.String>s. Each item is the name of a port on the server.  \n  \n10. Use <xref:System.Printing.PrintServer.InstallPrintQueue%2A> to install the new printer with the new values.  \n  \n An example is below.  \n  \n [!code-csharp[ClonePrinter#ClonePrinter](~/samples/snippets/csharp/VS_Snippets_Wpf/ClonePrinter/CSharp/Program.cs#cloneprinter)]\n [!code-vb[ClonePrinter#ClonePrinter](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ClonePrinter/visualbasic/program.vb#cloneprinter)]  \n  \n## See also\n\n- <xref:System.Printing.IndexedProperties>\n- <xref:System.Printing.IndexedProperties.PrintPropertyDictionary>\n- <xref:System.Printing.LocalPrintServer>\n- <xref:System.Printing.PrintQueue>\n- <xref:System.Collections.DictionaryEntry>\n- [Documents in WPF](documents-in-wpf.md)\n- [Printing Overview](printing-overview.md)\n","nodes":[{"pos":[4,314],"embed":true,"restype":"x-metadata","content":"title: \"How to: Clone a Printer\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"print queues [WPF]\"\n  - \"cloning printers [WPF]\"\n  - \"printers [WPF], cloning\"\n  - \"print queues [WPF], cloning\"\n  - \"cloning print queues [WPF]\"\nms.assetid: dd6997c9-fe04-40f8-88a6-92e3ac0889eb","nodes":[{"content":"How to: Clone a Printer","nodes":[{"pos":[0,23],"content":"How to: Clone a Printer","nodes":[{"content":"How to: Clone a Printer","pos":[0,23]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[321,344],"content":"How to: Clone a Printer","linkify":"How to: Clone a Printer","nodes":[{"content":"How to: Clone a Printer","pos":[0,23]}]},{"content":"Most businesses will, at some point, buy multiple printers of the same model.","pos":[345,422]},{"content":"Typically, these are all installed with virtually identical configuration settings.","pos":[423,506]},{"content":"Installing each printer can be time-consuming and error prone.","pos":[507,569]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Printing.IndexedProperties?displayProperty=nameWithType&gt;</ph> namespace and the <ph id=\"ph2\">&lt;xref:System.Printing.PrintServer.InstallPrintQueue%2A&gt;</ph> class that are exposed with Microsoft .NET Framework makes it possible to instantly install any number of additional print queues that are cloned from an existing print queue.","pos":[570,893],"source":" The <xref:System.Printing.IndexedProperties?displayProperty=nameWithType> namespace and the <xref:System.Printing.PrintServer.InstallPrintQueue%2A> class that are exposed with Microsoft .NET Framework makes it possible to instantly install any number of additional print queues that are cloned from an existing print queue."},{"pos":[902,909],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In the example below, a second print queue is cloned from an existing print queue.","pos":[913,995]},{"content":"The second differs from the first only in its name, location, port, and shared status.","pos":[996,1082]},{"content":"The major steps for doing this are as follows.","pos":[1083,1129]},{"pos":[1139,1241],"content":"Create a <ph id=\"ph1\">&lt;xref:System.Printing.PrintQueue&gt;</ph> object for the existing printer that is going to be cloned.","source":"Create a <xref:System.Printing.PrintQueue> object for the existing printer that is going to be cloned."},{"content":"Create a <ph id=\"ph1\">&lt;xref:System.Printing.IndexedProperties.PrintPropertyDictionary&gt;</ph> from the <ph id=\"ph2\">&lt;xref:System.Printing.PrintSystemObject.PropertiesCollection%2A&gt;</ph> of the <ph id=\"ph3\">&lt;xref:System.Printing.PrintQueue&gt;</ph>.","pos":[1251,1440],"source":"Create a <xref:System.Printing.IndexedProperties.PrintPropertyDictionary> from the <xref:System.Printing.PrintSystemObject.PropertiesCollection%2A> of the <xref:System.Printing.PrintQueue>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Collections.DictionaryEntry.Value%2A&gt;</ph> property of each entry in this dictionary is an object of one of the types derived from <ph id=\"ph2\">&lt;xref:System.Printing.IndexedProperties.PrintProperty&gt;</ph>.","pos":[1441,1639],"source":" The <xref:System.Collections.DictionaryEntry.Value%2A> property of each entry in this dictionary is an object of one of the types derived from <xref:System.Printing.IndexedProperties.PrintProperty>."},{"content":"There are two ways to set the value of an entry in this dictionary.","pos":[1640,1707]},{"pos":[1721,1899],"content":"Use the dictionary's <bpt id=\"p1\">**</bpt>Remove<ept id=\"p1\">**</ept> and <ph id=\"ph1\">&lt;xref:System.Printing.IndexedProperties.PrintPropertyDictionary.Add%2A&gt;</ph> methods to remove the entry and then re-add it with the desired value.","source":"Use the dictionary's **Remove** and <xref:System.Printing.IndexedProperties.PrintPropertyDictionary.Add%2A> methods to remove the entry and then re-add it with the desired value."},{"pos":[1913,2021],"content":"Use the dictionary's <ph id=\"ph1\">&lt;xref:System.Printing.IndexedProperties.PrintPropertyDictionary.SetProperty%2A&gt;</ph> method.","source":"Use the dictionary's <xref:System.Printing.IndexedProperties.PrintPropertyDictionary.SetProperty%2A> method."},{"content":"The example below illustrates both ways.","pos":[2032,2072]},{"pos":[2082,2338],"content":"Create a <ph id=\"ph1\">&lt;xref:System.Printing.IndexedProperties.PrintBooleanProperty&gt;</ph> object and set its <ph id=\"ph2\">&lt;xref:System.Printing.IndexedProperties.PrintProperty.Name%2A&gt;</ph> to \"IsShared\" and its <ph id=\"ph3\">&lt;xref:System.Printing.IndexedProperties.PrintBooleanProperty.Value%2A&gt;</ph> to <ph id=\"ph4\">`true`</ph>.","source":"Create a <xref:System.Printing.IndexedProperties.PrintBooleanProperty> object and set its <xref:System.Printing.IndexedProperties.PrintProperty.Name%2A> to \"IsShared\" and its <xref:System.Printing.IndexedProperties.PrintBooleanProperty.Value%2A> to `true`."},{"pos":[2348,2532],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Printing.IndexedProperties.PrintBooleanProperty&gt;</ph> object to be the value of the <ph id=\"ph2\">&lt;xref:System.Printing.IndexedProperties.PrintPropertyDictionary&gt;</ph>'s \"IsShared\" entry.","source":"Use the <xref:System.Printing.IndexedProperties.PrintBooleanProperty> object to be the value of the <xref:System.Printing.IndexedProperties.PrintPropertyDictionary>'s \"IsShared\" entry."},{"pos":[2542,2826],"content":"Create a <ph id=\"ph1\">&lt;xref:System.Printing.IndexedProperties.PrintStringProperty&gt;</ph> object and set its <ph id=\"ph2\">&lt;xref:System.Printing.IndexedProperties.PrintProperty.Name%2A&gt;</ph> to \"ShareName\" and its <ph id=\"ph3\">&lt;xref:System.Printing.IndexedProperties.PrintStringProperty.Value%2A&gt;</ph> to an appropriate <ph id=\"ph4\">&lt;xref:System.String&gt;</ph>.","source":"Create a <xref:System.Printing.IndexedProperties.PrintStringProperty> object and set its <xref:System.Printing.IndexedProperties.PrintProperty.Name%2A> to \"ShareName\" and its <xref:System.Printing.IndexedProperties.PrintStringProperty.Value%2A> to an appropriate <xref:System.String>."},{"pos":[2836,3020],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Printing.IndexedProperties.PrintStringProperty&gt;</ph> object to be the value of the <ph id=\"ph2\">&lt;xref:System.Printing.IndexedProperties.PrintPropertyDictionary&gt;</ph>'s \"ShareName\" entry.","source":"Use the <xref:System.Printing.IndexedProperties.PrintStringProperty> object to be the value of the <xref:System.Printing.IndexedProperties.PrintPropertyDictionary>'s \"ShareName\" entry."},{"pos":[3030,3319],"content":"Create another <ph id=\"ph1\">&lt;xref:System.Printing.IndexedProperties.PrintStringProperty&gt;</ph> object and set its <ph id=\"ph2\">&lt;xref:System.Printing.IndexedProperties.PrintProperty.Name%2A&gt;</ph> to \"Location\" and its <ph id=\"ph3\">&lt;xref:System.Printing.IndexedProperties.PrintStringProperty.Value%2A&gt;</ph> to an appropriate <ph id=\"ph4\">&lt;xref:System.String&gt;</ph>.","source":"Create another <xref:System.Printing.IndexedProperties.PrintStringProperty> object and set its <xref:System.Printing.IndexedProperties.PrintProperty.Name%2A> to \"Location\" and its <xref:System.Printing.IndexedProperties.PrintStringProperty.Value%2A> to an appropriate <xref:System.String>."},{"pos":[3329,3519],"content":"Use the second <ph id=\"ph1\">&lt;xref:System.Printing.IndexedProperties.PrintStringProperty&gt;</ph> object to be the value of the <ph id=\"ph2\">&lt;xref:System.Printing.IndexedProperties.PrintPropertyDictionary&gt;</ph>'s \"Location\" entry.","source":"Use the second <xref:System.Printing.IndexedProperties.PrintStringProperty> object to be the value of the <xref:System.Printing.IndexedProperties.PrintPropertyDictionary>'s \"Location\" entry."},{"content":"Create an array of <ph id=\"ph1\">&lt;xref:System.String&gt;</ph>s.","pos":[3528,3569],"source":"Create an array of <xref:System.String>s."},{"content":"Each item is the name of a port on the server.","pos":[3570,3616]},{"pos":[3626,3733],"content":"Use <ph id=\"ph1\">&lt;xref:System.Printing.PrintServer.InstallPrintQueue%2A&gt;</ph> to install the new printer with the new values.","source":"Use <xref:System.Printing.PrintServer.InstallPrintQueue%2A> to install the new printer with the new values."},{"content":"An example is below.","pos":[3740,3760]},{"pos":[3767,4031],"content":"[!code-csharp[ClonePrinter#ClonePrinter](~/samples/snippets/csharp/VS_Snippets_Wpf/ClonePrinter/CSharp/Program.cs#cloneprinter)]\n[!code-vb[ClonePrinter#ClonePrinter](~/samples/snippets/visualbasic/VS_Snippets_Wpf/ClonePrinter/visualbasic/program.vb#cloneprinter)]","leadings":[""," "],"nodes":[]},{"pos":[4040,4048],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4284,4323],"content":"<bpt id=\"p1\">[</bpt>Documents in WPF<ept id=\"p1\">](documents-in-wpf.md)</ept>","source":"[Documents in WPF](documents-in-wpf.md)"},{"pos":[4326,4367],"content":"<bpt id=\"p1\">[</bpt>Printing Overview<ept id=\"p1\">](printing-overview.md)</ept>","source":"[Printing Overview](printing-overview.md)"}]}