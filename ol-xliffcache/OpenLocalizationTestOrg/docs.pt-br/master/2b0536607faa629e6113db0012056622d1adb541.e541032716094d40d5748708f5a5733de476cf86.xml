{"content":"---\ntitle: \"Migrating From the XslTransform Class\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nms.assetid: 9404d758-679f-4ffb-995d-3d07d817659e\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n\n# Migrating From the XslTransform Class\n\nThe XSLT architecture was redesigned in the Visual Studio 2005 release. The <xref:System.Xml.Xsl.XslTransform> class was replaced by the <xref:System.Xml.Xsl.XslCompiledTransform> class.\n\nThe following sections describe some of the main differences between the <xref:System.Xml.Xsl.XslCompiledTransform> and the <xref:System.Xml.Xsl.XslTransform> classes.\n\n## Performance\n\nThe <xref:System.Xml.Xsl.XslCompiledTransform> class includes many performance improvements. The new XSLT processor compiles the XSLT style sheet down to a common intermediate format, similar to what the common language runtime (CLR) does for other programming languages. Once the style sheet is compiled, it can be cached and reused.\n\nThe <xref:System.Xml.Xsl.XslCompiledTransform> class also includes other optimizations that make it much faster than the <xref:System.Xml.Xsl.XslTransform> class.\n\n> [!NOTE]\n> Although the overall performance of the <xref:System.Xml.Xsl.XslCompiledTransform> class is better than the <xref:System.Xml.Xsl.XslTransform> class, the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method of the <xref:System.Xml.Xsl.XslCompiledTransform> class might perform more slowly than the <xref:System.Xml.Xsl.XslTransform.Load%2A> method of the <xref:System.Xml.Xsl.XslTransform> class the first time it is called on a transformation. This is because the XSLT file must be compiled before it is loaded. For more information, see the following blog post: [XslCompiledTransform Slower than XslTransform?](https://blogs.msdn.microsoft.com/antosha/2006/07/16/xslcompiledtransform-slower-than-xsltransform/)\n\n## Security\n\nBy default, the <xref:System.Xml.Xsl.XslCompiledTransform> class disables support for the XSLT `document()` function and embedded scripting. These features can be enabled by creating an <xref:System.Xml.Xsl.XsltSettings> object that has the features enabled and passing it to the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method. The following example shows how to enable scripting and perform an XSLT transformation.\n\n[!code-csharp[XML_Migration#16](../../../../samples/snippets/csharp/VS_Snippets_Data/XML_Migration/CS/migration.cs#16)]\n[!code-vb[XML_Migration#16](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XML_Migration/VB/migration.vb#16)]\n\nFor more information, see [XSLT Security Considerations](../../../../docs/standard/data/xml/xslt-security-considerations.md).\n\n## New Features\n\n### Temporary Files\n\nTemporary files are sometimes generated during XSLT processing. If a style sheet contains script blocks, or if it is compiled with the debug setting set to true, temporary files may be created in the %TEMP% folder. There may be instances when some temporary files are not deleted due to timing issues. For example, if the files are in use by the current AppDomain or by the debugger, the finalizer of the <xref:System.CodeDom.Compiler.TempFileCollection> object will not be able to remove them.\n\nThe <xref:System.Xml.Xsl.XslCompiledTransform.TemporaryFiles%2A> property can be used for additional cleanup to make sure that all temporary files are removed from the client.\n\n### Support for the xsl:output Element and XmlWriter\n\nThe <xref:System.Xml.Xsl.XslTransform> class ignored `xsl:output` settings when the transform output was sent to an <xref:System.Xml.XmlWriter> object. The <xref:System.Xml.Xsl.XslCompiledTransform> class has an <xref:System.Xml.Xsl.XslCompiledTransform.OutputSettings%2A> property that returns an <xref:System.Xml.XmlWriterSettings> object containing the output information derived from the `xsl:output` element of the style sheet. The <xref:System.Xml.XmlWriterSettings> object is used to create an <xref:System.Xml.XmlWriter> object with the correct settings that can be passed to the <xref:System.Xml.Xsl.XslCompiledTransform.Transform%2A> method. The following C# code illustrates this behavior:\n\n```csharp\n// Create the XslTransform object and load the style sheet.\nXslCompiledTransform xslt = new XslCompiledTransform();\nxslt.Load(stylesheet);\n\n// Load the file to transform.\nXPathDocument doc = new XPathDocument(filename);\n\n// Create the writer.\nXmlWriter writer = XmlWriter.Create(Console.Out, xslt.OutputSettings);\n\n// Transform the file and send the output to the console.\nxslt.Transform(doc, writer);\nwriter.Close();\n```\n\n### Debug Option\n\nThe <xref:System.Xml.Xsl.XslCompiledTransform> class can generate debug information, which enables you to debug the style sheet with the Microsoft Visual Studio Debugger. See <xref:System.Xml.Xsl.XslCompiledTransform.%23ctor%28System.Boolean%29> for more information.\n\n## Behavioral Differences\n\n### Transforming to an XmlReader\n\nThe <xref:System.Xml.Xsl.XslTransform> class has several Transform overloads that return transformation results as an <xref:System.Xml.XmlReader> object. These overloads can be used to load the transformation results into an in-memory representation (such as <xref:System.Xml.XmlDocument> or <xref:System.Xml.XPath.XPathDocument>) without incurring the overhead of serialization and deserialization of the resulting XML tree. The following C# code shows how to load the transformation results into an <xref:System.Xml.XmlDocument> object.\n\n```csharp\n// Load the style sheet\nXslTransform xslt = new XslTransform();\nxslt.Load(\"MyStylesheet.xsl\");\n\n// Transform input document to XmlDocument for additional processing\nXmlDocument doc = new XmlDocument();\ndoc.Load(xslt.Transform(input, (XsltArgumentList)null));\n```\n\nThe <xref:System.Xml.Xsl.XslCompiledTransform> class does not support transforming to an <xref:System.Xml.XmlReader> object. However, you can do something similar by using the <xref:System.Xml.XPath.XPathNavigator.CreateNavigator%2A> method to load the resulting XML tree directly from an <xref:System.Xml.XmlWriter>. The following C# code shows how to accomplish the same task using <xref:System.Xml.Xsl.XslCompiledTransform>.\n\n```csharp\n// Transform input document to XmlDocument for additional processing\nXmlDocument doc = new XmlDocument();\nusing (XmlWriter writer = doc.CreateNavigator().AppendChild()) {\n    xslt.Transform(input, (XsltArgumentList)null, writer);\n}\n```\n\n### Discretionary Behavior\n\nThe W3C XSL Transformations (XSLT) Version 1.0 Recommendation includes areas in which the implementation provider may decide how to handle a situation. These areas are considered to be discretionary behavior. There are several areas where the <xref:System.Xml.Xsl.XslCompiledTransform> behaves differently than the <xref:System.Xml.Xsl.XslTransform> class. For more information, see [Recoverable XSLT Errors](../../../../docs/standard/data/xml/recoverable-xslt-errors.md).\n\n### Extension Objects and Script Functions\n\n<xref:System.Xml.Xsl.XslCompiledTransform> introduces two new restrictions on the use of script functions:\n\n- Only public methods may be called from XPath expressions.\n\n- Overloads are distinguishable from each other based on the number of arguments. If more than one overload has the same number of arguments, an exception will be raised.\n\nIn <xref:System.Xml.Xsl.XslCompiledTransform>, a binding (method name lookup) to script functions occurs at compile time, and style sheets that worked with XslTransform may cause an exception when they are loaded with <xref:System.Xml.Xsl.XslCompiledTransform>.\n\n<xref:System.Xml.Xsl.XslCompiledTransform> supports having `msxsl:using` and `msxsl:assembly` child elements within the `msxsl:script` element. The `msxsl:using` and `msxsl:assembly` elements are used to declare additional namespaces and assemblies for use in the script block. See [Script Blocks Using msxsl:script](../../../../docs/standard/data/xml/script-blocks-using-msxsl-script.md) for more information.\n\n<xref:System.Xml.Xsl.XslCompiledTransform> prohibits extension objects that have multiple overloads with the same number of arguments.\n\n### MSXML Functions\n\nSupport for additional MSXML functions have been added to the <xref:System.Xml.Xsl.XslCompiledTransform> class. The following list describes new or improved functionality:\n\n- msxsl:node-set: <xref:System.Xml.Xsl.XslTransform> required the argument of the [node-set Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256197(v=vs.100)) function to be a result tree fragment. The <xref:System.Xml.Xsl.XslCompiledTransform> class does not have this requirement.\n\n- msxsl:version: This function is supported in <xref:System.Xml.Xsl.XslCompiledTransform>.\n\n- XPath extension functions: The [ms:string-compare Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256114(v=vs.100)), [ms:utc Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256474(v=vs.100)), [ms:namespace-uri Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256231(v=vs.100)), [ms:local-name Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256055(v=vs.100)), [ms:number Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256155(v=vs.100)), [ms:format-date Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256099(v=vs.100)), and [ms:format-time Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256467(v=vs.100)) functions are now supported.\n\n- Schema-related XPath extension functions: These functions are not supported natively by <xref:System.Xml.Xsl.XslCompiledTransform>. However, they can be implemented as extension functions.\n\n## See also\n\n- [XSLT Transformations](../../../../docs/standard/data/xml/xslt-transformations.md)\n- [Using the XslCompiledTransform Class](../../../../docs/standard/data/xml/using-the-xslcompiledtransform-class.md)\n","nodes":[{"pos":[4,222],"embed":true,"restype":"x-metadata","content":"title: \"Migrating From the XslTransform Class\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nms.assetid: 9404d758-679f-4ffb-995d-3d07d817659e\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Migrating From the XslTransform Class","nodes":[{"pos":[0,37],"content":"Migrating From the XslTransform Class","nodes":[{"content":"Migrating From the XslTransform Class","pos":[0,37]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[230,267],"content":"Migrating From the XslTransform Class","linkify":"Migrating From the XslTransform Class","nodes":[{"content":"Migrating From the XslTransform Class","pos":[0,37]}]},{"content":"The XSLT architecture was redesigned in the Visual Studio 2005 release.","pos":[269,340]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslTransform&gt;</ph> class was replaced by the <ph id=\"ph2\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class.","pos":[341,455],"source":" The <xref:System.Xml.Xsl.XslTransform> class was replaced by the <xref:System.Xml.Xsl.XslCompiledTransform> class."},{"pos":[457,624],"content":"The following sections describe some of the main differences between the <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> and the <ph id=\"ph2\">&lt;xref:System.Xml.Xsl.XslTransform&gt;</ph> classes.","source":"The following sections describe some of the main differences between the <xref:System.Xml.Xsl.XslCompiledTransform> and the <xref:System.Xml.Xsl.XslTransform> classes."},{"pos":[629,640],"content":"Performance","linkify":"Performance","nodes":[{"content":"Performance","pos":[0,11]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class includes many performance improvements.","pos":[642,734],"source":"The <xref:System.Xml.Xsl.XslCompiledTransform> class includes many performance improvements."},{"content":"The new XSLT processor compiles the XSLT style sheet down to a common intermediate format, similar to what the common language runtime (CLR) does for other programming languages.","pos":[735,913]},{"content":"Once the style sheet is compiled, it can be cached and reused.","pos":[914,976]},{"pos":[978,1140],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class also includes other optimizations that make it much faster than the <ph id=\"ph2\">&lt;xref:System.Xml.Xsl.XslTransform&gt;</ph> class.","source":"The <xref:System.Xml.Xsl.XslCompiledTransform> class also includes other optimizations that make it much faster than the <xref:System.Xml.Xsl.XslTransform> class."},{"pos":[1144,1871],"content":"[!NOTE]\nAlthough the overall performance of the <xref:System.Xml.Xsl.XslCompiledTransform> class is better than the <xref:System.Xml.Xsl.XslTransform> class, the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method of the <xref:System.Xml.Xsl.XslCompiledTransform> class might perform more slowly than the <xref:System.Xml.Xsl.XslTransform.Load%2A> method of the <xref:System.Xml.Xsl.XslTransform> class the first time it is called on a transformation. This is because the XSLT file must be compiled before it is loaded. For more information, see the following blog post: [XslCompiledTransform Slower than XslTransform?](https://blogs.msdn.microsoft.com/antosha/2006/07/16/xslcompiledtransform-slower-than-xsltransform/)","leadings":["","> "],"nodes":[{"content":"Although the overall performance of the <xref:System.Xml.Xsl.XslCompiledTransform> class is better than the <xref:System.Xml.Xsl.XslTransform> class, the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method of the <xref:System.Xml.Xsl.XslCompiledTransform> class might perform more slowly than the <xref:System.Xml.Xsl.XslTransform.Load%2A> method of the <xref:System.Xml.Xsl.XslTransform> class the first time it is called on a transformation. This is because the XSLT file must be compiled before it is loaded. For more information, see the following blog post: [XslCompiledTransform Slower than XslTransform?](https://blogs.msdn.microsoft.com/antosha/2006/07/16/xslcompiledtransform-slower-than-xsltransform/)","pos":[8,725],"nodes":[{"content":"Although the overall performance of the <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class is better than the <ph id=\"ph2\">&lt;xref:System.Xml.Xsl.XslTransform&gt;</ph> class, the <ph id=\"ph3\">&lt;xref:System.Xml.Xsl.XslCompiledTransform.Load%2A&gt;</ph> method of the <ph id=\"ph4\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class might perform more slowly than the <ph id=\"ph5\">&lt;xref:System.Xml.Xsl.XslTransform.Load%2A&gt;</ph> method of the <ph id=\"ph6\">&lt;xref:System.Xml.Xsl.XslTransform&gt;</ph> class the first time it is called on a transformation.","pos":[0,449],"source":"Although the overall performance of the <xref:System.Xml.Xsl.XslCompiledTransform> class is better than the <xref:System.Xml.Xsl.XslTransform> class, the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method of the <xref:System.Xml.Xsl.XslCompiledTransform> class might perform more slowly than the <xref:System.Xml.Xsl.XslTransform.Load%2A> method of the <xref:System.Xml.Xsl.XslTransform> class the first time it is called on a transformation."},{"content":"This is because the XSLT file must be compiled before it is loaded.","pos":[450,517]},{"content":"For more information, see the following blog post: <bpt id=\"p1\">[</bpt>XslCompiledTransform Slower than XslTransform?<ept id=\"p1\">](https://blogs.msdn.microsoft.com/antosha/2006/07/16/xslcompiledtransform-slower-than-xsltransform/)</ept>","pos":[518,717],"source":" For more information, see the following blog post: [XslCompiledTransform Slower than XslTransform?](https://blogs.msdn.microsoft.com/antosha/2006/07/16/xslcompiledtransform-slower-than-xsltransform/)"}]}]},{"pos":[1876,1884],"content":"Security","linkify":"Security","nodes":[{"content":"Security","pos":[0,8]}]},{"content":"By default, the <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class disables support for the XSLT <ph id=\"ph2\">`document()`</ph> function and embedded scripting.","pos":[1886,2026],"source":"By default, the <xref:System.Xml.Xsl.XslCompiledTransform> class disables support for the XSLT `document()` function and embedded scripting."},{"content":"These features can be enabled by creating an <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XsltSettings&gt;</ph> object that has the features enabled and passing it to the <ph id=\"ph2\">&lt;xref:System.Xml.Xsl.XslCompiledTransform.Load%2A&gt;</ph> method.","pos":[2027,2224],"source":" These features can be enabled by creating an <xref:System.Xml.Xsl.XsltSettings> object that has the features enabled and passing it to the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method."},{"content":"The following example shows how to enable scripting and perform an XSLT transformation.","pos":[2225,2312]},{"pos":[2556,2681],"content":"For more information, see <bpt id=\"p1\">[</bpt>XSLT Security Considerations<ept id=\"p1\">](../../../../docs/standard/data/xml/xslt-security-considerations.md)</ept>.","source":"For more information, see [XSLT Security Considerations](../../../../docs/standard/data/xml/xslt-security-considerations.md)."},{"pos":[2686,2698],"content":"New Features","linkify":"New Features","nodes":[{"content":"New Features","pos":[0,12]}]},{"pos":[2704,2719],"content":"Temporary Files","linkify":"Temporary Files","nodes":[{"content":"Temporary Files","pos":[0,15]}]},{"content":"Temporary files are sometimes generated during XSLT processing.","pos":[2721,2784]},{"content":"If a style sheet contains script blocks, or if it is compiled with the debug setting set to true, temporary files may be created in the %TEMP% folder.","pos":[2785,2935]},{"content":"There may be instances when some temporary files are not deleted due to timing issues.","pos":[2936,3022]},{"content":"For example, if the files are in use by the current AppDomain or by the debugger, the finalizer of the <ph id=\"ph1\">&lt;xref:System.CodeDom.Compiler.TempFileCollection&gt;</ph> object will not be able to remove them.","pos":[3023,3215],"source":" For example, if the files are in use by the current AppDomain or by the debugger, the finalizer of the <xref:System.CodeDom.Compiler.TempFileCollection> object will not be able to remove them."},{"pos":[3217,3392],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform.TemporaryFiles%2A&gt;</ph> property can be used for additional cleanup to make sure that all temporary files are removed from the client.","source":"The <xref:System.Xml.Xsl.XslCompiledTransform.TemporaryFiles%2A> property can be used for additional cleanup to make sure that all temporary files are removed from the client."},{"pos":[3398,3446],"content":"Support for the xsl:output Element and XmlWriter","linkify":"Support for the xsl:output Element and XmlWriter","nodes":[{"content":"Support for the xsl:output Element and XmlWriter","pos":[0,48]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslTransform&gt;</ph> class ignored <ph id=\"ph2\">`xsl:output`</ph> settings when the transform output was sent to an <ph id=\"ph3\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object.","pos":[3448,3599],"source":"The <xref:System.Xml.Xsl.XslTransform> class ignored `xsl:output` settings when the transform output was sent to an <xref:System.Xml.XmlWriter> object."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class has an <ph id=\"ph2\">&lt;xref:System.Xml.Xsl.XslCompiledTransform.OutputSettings%2A&gt;</ph> property that returns an <ph id=\"ph3\">&lt;xref:System.Xml.XmlWriterSettings&gt;</ph> object containing the output information derived from the <ph id=\"ph4\">`xsl:output`</ph> element of the style sheet.","pos":[3600,3880],"source":" The <xref:System.Xml.Xsl.XslCompiledTransform> class has an <xref:System.Xml.Xsl.XslCompiledTransform.OutputSettings%2A> property that returns an <xref:System.Xml.XmlWriterSettings> object containing the output information derived from the `xsl:output` element of the style sheet."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriterSettings&gt;</ph> object is used to create an <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter&gt;</ph> object with the correct settings that can be passed to the <ph id=\"ph3\">&lt;xref:System.Xml.Xsl.XslCompiledTransform.Transform%2A&gt;</ph> method.","pos":[3881,4099],"source":" The <xref:System.Xml.XmlWriterSettings> object is used to create an <xref:System.Xml.XmlWriter> object with the correct settings that can be passed to the <xref:System.Xml.Xsl.XslCompiledTransform.Transform%2A> method."},{"content":"The following C# code illustrates this behavior:","pos":[4100,4148]},{"pos":[4587,4599],"content":"Debug Option","linkify":"Debug Option","nodes":[{"content":"Debug Option","pos":[0,12]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class can generate debug information, which enables you to debug the style sheet with the Microsoft Visual Studio Debugger.","pos":[4601,4771],"source":"The <xref:System.Xml.Xsl.XslCompiledTransform> class can generate debug information, which enables you to debug the style sheet with the Microsoft Visual Studio Debugger."},{"content":"See <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform.%23ctor%28System.Boolean%29&gt;</ph> for more information.","pos":[4772,4868],"source":" See <xref:System.Xml.Xsl.XslCompiledTransform.%23ctor%28System.Boolean%29> for more information."},{"pos":[4873,4895],"content":"Behavioral Differences","linkify":"Behavioral Differences","nodes":[{"content":"Behavioral Differences","pos":[0,22]}]},{"pos":[4901,4929],"content":"Transforming to an XmlReader","linkify":"Transforming to an XmlReader","nodes":[{"content":"Transforming to an XmlReader","pos":[0,28]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslTransform&gt;</ph> class has several Transform overloads that return transformation results as an <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph> object.","pos":[4931,5084],"source":"The <xref:System.Xml.Xsl.XslTransform> class has several Transform overloads that return transformation results as an <xref:System.Xml.XmlReader> object."},{"content":"These overloads can be used to load the transformation results into an in-memory representation (such as <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph>) without incurring the overhead of serialization and deserialization of the resulting XML tree.","pos":[5085,5356],"source":" These overloads can be used to load the transformation results into an in-memory representation (such as <xref:System.Xml.XmlDocument> or <xref:System.Xml.XPath.XPathDocument>) without incurring the overhead of serialization and deserialization of the resulting XML tree."},{"content":"The following C# code shows how to load the transformation results into an <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object.","pos":[5357,5469],"source":" The following C# code shows how to load the transformation results into an <xref:System.Xml.XmlDocument> object."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class does not support transforming to an <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph> object.","pos":[5745,5869],"source":"The <xref:System.Xml.Xsl.XslCompiledTransform> class does not support transforming to an <xref:System.Xml.XmlReader> object."},{"content":"However, you can do something similar by using the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.CreateNavigator%2A&gt;</ph> method to load the resulting XML tree directly from an <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter&gt;</ph>.","pos":[5870,6062],"source":" However, you can do something similar by using the <xref:System.Xml.XPath.XPathNavigator.CreateNavigator%2A> method to load the resulting XML tree directly from an <xref:System.Xml.XmlWriter>."},{"content":"The following C# code shows how to accomplish the same task using <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph>.","pos":[6063,6172],"source":" The following C# code shows how to accomplish the same task using <xref:System.Xml.Xsl.XslCompiledTransform>."},{"pos":[6425,6447],"content":"Discretionary Behavior","linkify":"Discretionary Behavior","nodes":[{"content":"Discretionary Behavior","pos":[0,22]}]},{"content":"The W3C XSL Transformations (XSLT) Version 1.0 Recommendation includes areas in which the implementation provider may decide how to handle a situation.","pos":[6449,6600]},{"content":"These areas are considered to be discretionary behavior.","pos":[6601,6657]},{"content":"There are several areas where the <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> behaves differently than the <ph id=\"ph2\">&lt;xref:System.Xml.Xsl.XslTransform&gt;</ph> class.","pos":[6658,6805],"source":" There are several areas where the <xref:System.Xml.Xsl.XslCompiledTransform> behaves differently than the <xref:System.Xml.Xsl.XslTransform> class."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Recoverable XSLT Errors<ept id=\"p1\">](../../../../docs/standard/data/xml/recoverable-xslt-errors.md)</ept>.","pos":[6806,6921],"source":" For more information, see [Recoverable XSLT Errors](../../../../docs/standard/data/xml/recoverable-xslt-errors.md)."},{"pos":[6927,6965],"content":"Extension Objects and Script Functions","linkify":"Extension Objects and Script Functions","nodes":[{"content":"Extension Objects and Script Functions","pos":[0,38]}]},{"pos":[6967,7073],"content":"<ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> introduces two new restrictions on the use of script functions:","source":"<xref:System.Xml.Xsl.XslCompiledTransform> introduces two new restrictions on the use of script functions:"},{"content":"Only public methods may be called from XPath expressions.","pos":[7077,7134]},{"content":"Overloads are distinguishable from each other based on the number of arguments.","pos":[7138,7217]},{"content":"If more than one overload has the same number of arguments, an exception will be raised.","pos":[7218,7306]},{"pos":[7308,7569],"content":"In <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph>, a binding (method name lookup) to script functions occurs at compile time, and style sheets that worked with XslTransform may cause an exception when they are loaded with <ph id=\"ph2\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph>.","source":"In <xref:System.Xml.Xsl.XslCompiledTransform>, a binding (method name lookup) to script functions occurs at compile time, and style sheets that worked with XslTransform may cause an exception when they are loaded with <xref:System.Xml.Xsl.XslCompiledTransform>."},{"content":"<ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> supports having <ph id=\"ph2\">`msxsl:using`</ph> and <ph id=\"ph3\">`msxsl:assembly`</ph> child elements within the <ph id=\"ph4\">`msxsl:script`</ph> element.","pos":[7571,7714],"source":"<xref:System.Xml.Xsl.XslCompiledTransform> supports having `msxsl:using` and `msxsl:assembly` child elements within the `msxsl:script` element."},{"content":"The <ph id=\"ph1\">`msxsl:using`</ph> and <ph id=\"ph2\">`msxsl:assembly`</ph> elements are used to declare additional namespaces and assemblies for use in the script block.","pos":[7715,7848],"source":" The `msxsl:using` and `msxsl:assembly` elements are used to declare additional namespaces and assemblies for use in the script block."},{"content":"See <bpt id=\"p1\">[</bpt>Script Blocks Using msxsl:script<ept id=\"p1\">](../../../../docs/standard/data/xml/script-blocks-using-msxsl-script.md)</ept> for more information.","pos":[7849,7981],"source":" See [Script Blocks Using msxsl:script](../../../../docs/standard/data/xml/script-blocks-using-msxsl-script.md) for more information."},{"pos":[7983,8117],"content":"<ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> prohibits extension objects that have multiple overloads with the same number of arguments.","source":"<xref:System.Xml.Xsl.XslCompiledTransform> prohibits extension objects that have multiple overloads with the same number of arguments."},{"pos":[8123,8138],"content":"MSXML Functions","linkify":"MSXML Functions","nodes":[{"content":"MSXML Functions","pos":[0,15]}]},{"content":"Support for additional MSXML functions have been added to the <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class.","pos":[8140,8251],"source":"Support for additional MSXML functions have been added to the <xref:System.Xml.Xsl.XslCompiledTransform> class."},{"content":"The following list describes new or improved functionality:","pos":[8252,8311]},{"content":"msxsl:node-set: <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslTransform&gt;</ph> required the argument of the <bpt id=\"p1\">[</bpt>node-set Function<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256197(v=vs.100))</ept> function to be a result tree fragment.","pos":[8315,8542],"source":"msxsl:node-set: <xref:System.Xml.Xsl.XslTransform> required the argument of the [node-set Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256197(v=vs.100)) function to be a result tree fragment."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph> class does not have this requirement.","pos":[8543,8627],"source":" The <xref:System.Xml.Xsl.XslCompiledTransform> class does not have this requirement."},{"pos":[8631,8719],"content":"msxsl:version: This function is supported in <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph>.","source":"msxsl:version: This function is supported in <xref:System.Xml.Xsl.XslCompiledTransform>."},{"pos":[8723,9588],"content":"XPath extension functions: The <bpt id=\"p1\">[</bpt>ms:string-compare Function<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256114(v=vs.100))</ept>, <bpt id=\"p2\">[</bpt>ms:utc Function<ept id=\"p2\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256474(v=vs.100))</ept>, <bpt id=\"p3\">[</bpt>ms:namespace-uri Function<ept id=\"p3\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256231(v=vs.100))</ept>, <bpt id=\"p4\">[</bpt>ms:local-name Function<ept id=\"p4\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256055(v=vs.100))</ept>, <bpt id=\"p5\">[</bpt>ms:number Function<ept id=\"p5\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256155(v=vs.100))</ept>, <bpt id=\"p6\">[</bpt>ms:format-date Function<ept id=\"p6\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256099(v=vs.100))</ept>, and <bpt id=\"p7\">[</bpt>ms:format-time Function<ept id=\"p7\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256467(v=vs.100))</ept> functions are now supported.","source":"XPath extension functions: The [ms:string-compare Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256114(v=vs.100)), [ms:utc Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256474(v=vs.100)), [ms:namespace-uri Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256231(v=vs.100)), [ms:local-name Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256055(v=vs.100)), [ms:number Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256155(v=vs.100)), [ms:format-date Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256099(v=vs.100)), and [ms:format-time Function](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256467(v=vs.100)) functions are now supported."},{"content":"Schema-related XPath extension functions: These functions are not supported natively by <ph id=\"ph1\">&lt;xref:System.Xml.Xsl.XslCompiledTransform&gt;</ph>.","pos":[9592,9723],"source":"Schema-related XPath extension functions: These functions are not supported natively by <xref:System.Xml.Xsl.XslCompiledTransform>."},{"content":"However, they can be implemented as extension functions.","pos":[9724,9780]},{"pos":[9785,9793],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[9797,9879],"content":"<bpt id=\"p1\">[</bpt>XSLT Transformations<ept id=\"p1\">](../../../../docs/standard/data/xml/xslt-transformations.md)</ept>","source":"[XSLT Transformations](../../../../docs/standard/data/xml/xslt-transformations.md)"},{"pos":[9882,9996],"content":"<bpt id=\"p1\">[</bpt>Using the XslCompiledTransform Class<ept id=\"p1\">](../../../../docs/standard/data/xml/using-the-xslcompiledtransform-class.md)</ept>","source":"[Using the XslCompiledTransform Class](../../../../docs/standard/data/xml/using-the-xslcompiledtransform-class.md)"}]}