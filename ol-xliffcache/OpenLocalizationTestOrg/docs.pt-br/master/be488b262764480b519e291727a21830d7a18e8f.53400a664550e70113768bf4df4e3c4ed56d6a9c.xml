{"content":"---\ntitle: \"Data Transformations with LINQ (C#)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"LINQ [C#], data transformations\"\n  - \"source elements [LINQ in C#]\"\n  - \"joining multiple inputs [LINQ in C#]\"\n  - \"multiple outputs for one output sequence [LINQ in C#]\"\n  - \"subset of source elements [LINQ in C#]\"\n  - \"data sources [LINQ in C#], data transformations\"\n  - \"data transformations [LINQ in C#]\"\nms.assetid: 674eae9e-bc72-4a88-aed3-802b45b25811\n---\n# Data Transformations with LINQ (C#)\n[!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)] is not only about retrieving data. It is also a powerful tool for transforming data. By using a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query, you can use a source sequence as input and modify it in many ways to create a new output sequence. You can modify the sequence itself without modifying the elements themselves by sorting and grouping. But perhaps the most powerful feature of [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] queries is the ability to create new types. This is accomplished in the [select](../../../../csharp/language-reference/keywords/select-clause.md) clause. For example, you can perform the following tasks:  \n  \n-   Merge multiple input sequences into a single output sequence that has a new type.  \n  \n-   Create output sequences whose elements consist of only one or several properties of each element in the source sequence.  \n  \n-   Create output sequences whose elements consist of the results of operations performed on the source data.  \n  \n-   Create output sequences in a different format. For example, you can transform data from SQL rows or text files into XML.  \n  \n These are just several examples. Of course, these transformations can be combined in various ways in the same query. Furthermore, the output sequence of one query can be used as the input sequence for a new query.  \n  \n## Joining Multiple Inputs into One Output Sequence  \n You can use a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query to create an output sequence that contains elements from more than one input sequence. The following example shows how to combine two in-memory data structures, but the same principles can be applied to combine data from XML or SQL or DataSet sources. Assume the following two class types:  \n  \n [!code-csharp[CsLINQGettingStarted#7](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsLINQGettingStarted/CS/Class1.cs#7)]  \n  \n The following example shows the query:  \n  \n [!code-csharp[CSLinqGettingStarted#8](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsLINQGettingStarted/CS/Class1.cs#8)]  \n  \n For more information, see [join clause](../../../../csharp/language-reference/keywords/join-clause.md) and [select clause](../../../../csharp/language-reference/keywords/select-clause.md).  \n  \n## Selecting a Subset of each Source Element  \n There are two primary ways to select a subset of each element in the source sequence:  \n  \n1.  To select just one member of the source element, use the dot operation. In the following example, assume that a `Customer` object contains several public properties including a string named `City`. When executed, this query will produce an output sequence of strings.  \n  \n    ```csharp\n    var query = from cust in Customers  \n                select cust.City;  \n    ```  \n  \n2.  To create elements that contain more than one property from the source element, you can use an object initializer with either a named object or an anonymous type. The following example shows the use of an anonymous type to encapsulate two properties from each `Customer` element:  \n  \n    ```csharp\n    var query = from cust in Customer  \n                select new {Name = cust.Name, City = cust.City};  \n    ```  \n  \n For more information, see [Object and Collection Initializers](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md) and [Anonymous Types](../../../../csharp/programming-guide/classes-and-structs/anonymous-types.md).  \n  \n## Transforming in-Memory Objects into XML  \n [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] queries make it easy to transform data between in-memory data structures, SQL databases, [!INCLUDE[vstecado](~/includes/vstecado-md.md)] Datasets and XML streams or documents. The following example transforms objects in an in-memory data structure into XML elements.  \n  \n [!code-csharp[CsLINQGettingStarted#9](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsLINQGettingStarted/CS/Class1.cs#9)]  \n  \n The code produces the following XML output:  \n  \n```xml  \n<Root>  \n  <student>  \n    <First>Svetlana</First>  \n    <Last>Omelchenko</Last>  \n    <Scores>97,92,81,60</Scores>  \n  </student>  \n  <student>  \n    <First>Claire</First>  \n    <Last>O'Donnell</Last>  \n    <Scores>75,84,91,39</Scores>  \n  </student>  \n  <student>  \n    <First>Sven</First>  \n    <Last>Mortensen</Last>  \n    <Scores>88,94,65,91</Scores>  \n  </student>  \n</Root>  \n```  \n  \n For more information, see [Creating XML Trees in C# (LINQ to XML)](../../../../csharp/programming-guide/concepts/linq/creating-xml-trees-linq-to-xml-2.md).  \n  \n## Performing Operations on Source Elements  \n An output sequence might not contain any elements or element properties from the source sequence. The output might instead be a sequence of values that is computed by using the source elements as input arguments. The following simple query, when it is executed, outputs a sequence of strings whose values represent a calculation based on the source sequence of elements of type `double`.  \n  \n> [!NOTE]\n>  Calling methods in query expressions is not supported if the query will be translated into some other domain. For example, you cannot call an ordinary C# method in [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] because SQL Server has no context for it. However, you can map stored procedures to methods and call those. For more information, see [Stored Procedures](../../../../framework/data/adonet/sql/linq/stored-procedures.md).  \n  \n [!code-csharp[CsLINQGettingStarted#10](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsLINQGettingStarted/CS/Class1.cs#10)]  \n  \n## See also\n\n- [Language-Integrated Query (LINQ) (C#)](../../../../csharp/programming-guide/concepts/linq/index.md)\n- [LINQ to SQL](../../../../../docs/framework/data/adonet/sql/linq/index.md)\n- [LINQ to DataSet](../../../../framework/data/adonet/linq-to-dataset.md)\n- [LINQ to XML (C#)](../../../../csharp/programming-guide/concepts/linq/linq-to-xml.md)\n- [LINQ Query Expressions](../../../../csharp/programming-guide/linq-query-expressions/index.md)\n- [select clause](../../../../csharp/language-reference/keywords/select-clause.md)\n","nodes":[{"pos":[4,454],"embed":true,"restype":"x-metadata","content":"title: \"Data Transformations with LINQ (C#)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"LINQ [C#], data transformations\"\n  - \"source elements [LINQ in C#]\"\n  - \"joining multiple inputs [LINQ in C#]\"\n  - \"multiple outputs for one output sequence [LINQ in C#]\"\n  - \"subset of source elements [LINQ in C#]\"\n  - \"data sources [LINQ in C#], data transformations\"\n  - \"data transformations [LINQ in C#]\"\nms.assetid: 674eae9e-bc72-4a88-aed3-802b45b25811","nodes":[{"content":"Data Transformations with LINQ (C#)","nodes":[{"pos":[0,35],"content":"Data Transformations with LINQ (C#)","nodes":[{"content":"Data Transformations with LINQ (C#)","pos":[0,35]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[461,496],"content":"Data Transformations with LINQ (C#)","linkify":"Data Transformations with LINQ (C#)","nodes":[{"content":"Data Transformations with LINQ (C#)","pos":[0,35]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)]</ph> is not only about retrieving data.","pos":[497,587],"source":"[!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)] is not only about retrieving data."},{"content":"It is also a powerful tool for transforming data.","pos":[588,637]},{"content":"By using a <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> query, you can use a source sequence as input and modify it in many ways to create a new output sequence.","pos":[638,804],"source":" By using a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query, you can use a source sequence as input and modify it in many ways to create a new output sequence."},{"content":"You can modify the sequence itself without modifying the elements themselves by sorting and grouping.","pos":[805,906]},{"content":"But perhaps the most powerful feature of <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> queries is the ability to create new types.","pos":[907,1041],"source":" But perhaps the most powerful feature of [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] queries is the ability to create new types."},{"content":"This is accomplished in the <bpt id=\"p1\">[</bpt>select<ept id=\"p1\">](../../../../csharp/language-reference/keywords/select-clause.md)</ept> clause.","pos":[1042,1151],"source":" This is accomplished in the [select](../../../../csharp/language-reference/keywords/select-clause.md) clause."},{"content":"For example, you can perform the following tasks:","pos":[1152,1201]},{"content":"Merge multiple input sequences into a single output sequence that has a new type.","pos":[1211,1292]},{"content":"Create output sequences whose elements consist of only one or several properties of each element in the source sequence.","pos":[1302,1422]},{"content":"Create output sequences whose elements consist of the results of operations performed on the source data.","pos":[1432,1537]},{"content":"Create output sequences in a different format.","pos":[1547,1593]},{"content":"For example, you can transform data from SQL rows or text files into XML.","pos":[1594,1667]},{"content":"These are just several examples.","pos":[1674,1706]},{"content":"Of course, these transformations can be combined in various ways in the same query.","pos":[1707,1790]},{"content":"Furthermore, the output sequence of one query can be used as the input sequence for a new query.","pos":[1791,1887]},{"pos":[1896,1944],"content":"Joining Multiple Inputs into One Output Sequence","linkify":"Joining Multiple Inputs into One Output Sequence","nodes":[{"content":"Joining Multiple Inputs into One Output Sequence","pos":[0,48]}]},{"content":"You can use a <ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> query to create an output sequence that contains elements from more than one input sequence.","pos":[1948,2104],"source":"You can use a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query to create an output sequence that contains elements from more than one input sequence."},{"content":"The following example shows how to combine two in-memory data structures, but the same principles can be applied to combine data from XML or SQL or DataSet sources.","pos":[2105,2269]},{"content":"Assume the following two class types:","pos":[2270,2307]},{"content":"The following example shows the query:","pos":[2443,2481]},{"pos":[2617,2805],"content":"For more information, see <bpt id=\"p1\">[</bpt>join clause<ept id=\"p1\">](../../../../csharp/language-reference/keywords/join-clause.md)</ept> and <bpt id=\"p2\">[</bpt>select clause<ept id=\"p2\">](../../../../csharp/language-reference/keywords/select-clause.md)</ept>.","source":"For more information, see [join clause](../../../../csharp/language-reference/keywords/join-clause.md) and [select clause](../../../../csharp/language-reference/keywords/select-clause.md)."},{"pos":[2814,2855],"content":"Selecting a Subset of each Source Element","linkify":"Selecting a Subset of each Source Element","nodes":[{"content":"Selecting a Subset of each Source Element","pos":[0,41]}]},{"content":"There are two primary ways to select a subset of each element in the source sequence:","pos":[2859,2944]},{"content":"To select just one member of the source element, use the dot operation.","pos":[2954,3025]},{"content":"In the following example, assume that a <ph id=\"ph1\">`Customer`</ph> object contains several public properties including a string named <ph id=\"ph2\">`City`</ph>.","pos":[3026,3151],"source":" In the following example, assume that a `Customer` object contains several public properties including a string named `City`."},{"content":"When executed, this query will produce an output sequence of strings.","pos":[3152,3221]},{"content":"To create elements that contain more than one property from the source element, you can use an object initializer with either a named object or an anonymous type.","pos":[3335,3497]},{"content":"The following example shows the use of an anonymous type to encapsulate two properties from each <ph id=\"ph1\">`Customer`</ph> element:","pos":[3498,3614],"source":" The following example shows the use of an anonymous type to encapsulate two properties from each `Customer` element:"},{"pos":[3755,4013],"content":"For more information, see <bpt id=\"p1\">[</bpt>Object and Collection Initializers<ept id=\"p1\">](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md)</ept> and <bpt id=\"p2\">[</bpt>Anonymous Types<ept id=\"p2\">](../../../../csharp/programming-guide/classes-and-structs/anonymous-types.md)</ept>.","source":"For more information, see [Object and Collection Initializers](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md) and [Anonymous Types](../../../../csharp/programming-guide/classes-and-structs/anonymous-types.md)."},{"pos":[4022,4061],"content":"Transforming in-Memory Objects into XML","linkify":"Transforming in-Memory Objects into XML","nodes":[{"content":"Transforming in-Memory Objects into XML","pos":[0,39]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]</ph> queries make it easy to transform data between in-memory data structures, SQL databases, <ph id=\"ph2\">[!INCLUDE[vstecado](~/includes/vstecado-md.md)]</ph> Datasets and XML streams or documents.","pos":[4065,4290],"source":"[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] queries make it easy to transform data between in-memory data structures, SQL databases, [!INCLUDE[vstecado](~/includes/vstecado-md.md)] Datasets and XML streams or documents."},{"content":"The following example transforms objects in an in-memory data structure into XML elements.","pos":[4291,4381]},{"content":"The code produces the following XML output:","pos":[4517,4560]},{"pos":[4968,5123],"content":"For more information, see <bpt id=\"p1\">[</bpt>Creating XML Trees in C# (LINQ to XML)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/creating-xml-trees-linq-to-xml-2.md)</ept>.","source":"For more information, see [Creating XML Trees in C# (LINQ to XML)](../../../../csharp/programming-guide/concepts/linq/creating-xml-trees-linq-to-xml-2.md)."},{"pos":[5132,5172],"content":"Performing Operations on Source Elements","linkify":"Performing Operations on Source Elements","nodes":[{"content":"Performing Operations on Source Elements","pos":[0,40]}]},{"content":"An output sequence might not contain any elements or element properties from the source sequence.","pos":[5176,5273]},{"content":"The output might instead be a sequence of values that is computed by using the source elements as input arguments.","pos":[5274,5388]},{"content":"The following simple query, when it is executed, outputs a sequence of strings whose values represent a calculation based on the source sequence of elements of type <ph id=\"ph1\">`double`</ph>.","pos":[5389,5563],"source":" The following simple query, when it is executed, outputs a sequence of strings whose values represent a calculation based on the source sequence of elements of type `double`."},{"pos":[5571,6017],"content":"[!NOTE]\n Calling methods in query expressions is not supported if the query will be translated into some other domain. For example, you cannot call an ordinary C# method in [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] because SQL Server has no context for it. However, you can map stored procedures to methods and call those. For more information, see [Stored Procedures](../../../../framework/data/adonet/sql/linq/stored-procedures.md).","leadings":["","> "],"nodes":[{"content":"Calling methods in query expressions is not supported if the query will be translated into some other domain. For example, you cannot call an ordinary C# method in [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] because SQL Server has no context for it. However, you can map stored procedures to methods and call those. For more information, see [Stored Procedures](../../../../framework/data/adonet/sql/linq/stored-procedures.md).","pos":[9,444],"nodes":[{"content":"Calling methods in query expressions is not supported if the query will be translated into some other domain.","pos":[0,109]},{"content":"For example, you cannot call an ordinary C# method in <ph id=\"ph1\">[!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)]</ph> because SQL Server has no context for it.","pos":[110,257],"source":" For example, you cannot call an ordinary C# method in [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] because SQL Server has no context for it."},{"content":"However, you can map stored procedures to methods and call those.","pos":[258,323]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Stored Procedures<ept id=\"p1\">](../../../../framework/data/adonet/sql/linq/stored-procedures.md)</ept>.","pos":[324,435],"source":" For more information, see [Stored Procedures](../../../../framework/data/adonet/sql/linq/stored-procedures.md)."}]}]},{"pos":[6157,6165],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6169,6269],"content":"<bpt id=\"p1\">[</bpt>Language-Integrated Query (LINQ) (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/index.md)</ept>","source":"[Language-Integrated Query (LINQ) (C#)](../../../../csharp/programming-guide/concepts/linq/index.md)"},{"pos":[6272,6346],"content":"<bpt id=\"p1\">[</bpt>LINQ to SQL<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/linq/index.md)</ept>","source":"[LINQ to SQL](../../../../../docs/framework/data/adonet/sql/linq/index.md)"},{"pos":[6349,6420],"content":"<bpt id=\"p1\">[</bpt>LINQ to DataSet<ept id=\"p1\">](../../../../framework/data/adonet/linq-to-dataset.md)</ept>","source":"[LINQ to DataSet](../../../../framework/data/adonet/linq-to-dataset.md)"},{"pos":[6423,6508],"content":"<bpt id=\"p1\">[</bpt>LINQ to XML (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/linq-to-xml.md)</ept>","source":"[LINQ to XML (C#)](../../../../csharp/programming-guide/concepts/linq/linq-to-xml.md)"},{"pos":[6511,6605],"content":"<bpt id=\"p1\">[</bpt>LINQ Query Expressions<ept id=\"p1\">](../../../../csharp/programming-guide/linq-query-expressions/index.md)</ept>","source":"[LINQ Query Expressions](../../../../csharp/programming-guide/linq-query-expressions/index.md)"},{"pos":[6608,6688],"content":"<bpt id=\"p1\">[</bpt>select clause<ept id=\"p1\">](../../../../csharp/language-reference/keywords/select-clause.md)</ept>","source":"[select clause](../../../../csharp/language-reference/keywords/select-clause.md)"}]}