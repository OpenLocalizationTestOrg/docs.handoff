{"content":"---\ntitle: \"_CorDllMain Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"_CorDllMain\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"_CorDllMain\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"_CorDllMain function [.NET Framework hosting]\"\nms.assetid: bc7b51cf-39d3-48ec-a5cb-2f179fbefff8\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 23\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# _CorDllMain Function\nInitializes the common language runtime (CLR), locates the managed entry point in the DLL assembly's CLR header, and begins execution.  \n  \n## Syntax  \n  \n```  \nBOOL STDMETHODCALLTYPE _CorDllMain (  \n   [in] HINSTANCE hInst,  \n   [in] DWORD     dwReason,  \n   [in] LPVOID    lpReserved  \n);  \n```  \n  \n#### Parameters  \n `hInst`  \n [in] The instance handle of the loaded module.  \n  \n `dwReason`  \n [in]Indicates why the DLL entry-point function is being called. This parameter can be one of the following values: DLL_PROCESS_ATTACH, DLL_THREAD_ATTACH, DLL_THREAD_ATTACH, or DLL_PROCESS_DETACH. For descriptions of these values, see the `DllMain` documentation in the Platform SDK.  \n  \n `lpReserved`  \n [in] Unused.  \n  \n## Return Value  \n This method returns `true` for success and `false` if an error occurs.  \n  \n## Remarks  \n This function is called by the operating system loader for DLL assemblies. For executable assemblies, the loader calls the [_CorExeMain](../../../../docs/framework/unmanaged-api/hosting/corexemain-function.md) function instead.  \n  \n The operating system loader calls this method regardless of the entry point specified in the DLL file.  \n  \n In Windows 98, Windows ME, Windows NT, and Windows 2000, the `_CorDllMain` function is called indirectly through a fixupin the operating system loader. In all other versions of Windows, it is called directly by the operating system loader.  \n  \n For additional information, see the Remarks section in the [_CorValidateImage](../../../../docs/framework/unmanaged-api/hosting/corvalidateimage-function.md) topic.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** Cor.h  \n  \n **Library:** Included as a resource in MsCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See Also  \n [Metadata Global Static Functions](../../../../docs/framework/unmanaged-api/metadata/metadata-global-static-functions.md)","nodes":[{"pos":[4,591],"embed":true,"restype":"x-metadata","content":"title: \"_CorDllMain Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"_CorDllMain\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"_CorDllMain\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"_CorDllMain function [.NET Framework hosting]\"\nms.assetid: bc7b51cf-39d3-48ec-a5cb-2f179fbefff8\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 23\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"_CorDllMain Function | Microsoft Docs","nodes":[{"pos":[0,37],"content":"_CorDllMain Function | Microsoft Docs","nodes":[{"content":"_CorDllMain Function | Microsoft Docs","pos":[0,37]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[598,618],"content":"_CorDllMain Function","linkify":"_CorDllMain Function","nodes":[{"content":"_CorDllMain Function","pos":[0,20]}]},{"content":"Initializes the common language runtime (CLR), locates the managed entry point in the DLL assembly's CLR header, and begins execution.","pos":[619,753]},{"pos":[762,768],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[926,936],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The instance handle of the loaded module.","pos":[951,997]},{"content":"[in]Indicates why the DLL entry-point function is being called.","pos":[1018,1081]},{"content":"This parameter can be one of the following values: DLL_PROCESS_ATTACH, DLL_THREAD_ATTACH, DLL_THREAD_ATTACH, or DLL_PROCESS_DETACH.","pos":[1082,1213]},{"content":"For descriptions of these values, see the <ph id=\"ph1\">`DllMain`</ph> documentation in the Platform SDK.","pos":[1214,1300],"source":" For descriptions of these values, see the `DllMain` documentation in the Platform SDK."},{"content":"[in] Unused.","pos":[1323,1335]},{"pos":[1344,1356],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[1360,1430],"content":"This method returns <ph id=\"ph1\">`true`</ph> for success and <ph id=\"ph2\">`false`</ph> if an error occurs.","source":"This method returns `true` for success and `false` if an error occurs."},{"pos":[1439,1446],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This function is called by the operating system loader for DLL assemblies.","pos":[1450,1524]},{"content":"For executable assemblies, the loader calls the <bpt id=\"p1\">[</bpt>_CorExeMain<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corexemain-function.md)</ept> function instead.","pos":[1525,1677],"source":" For executable assemblies, the loader calls the [_CorExeMain](../../../../docs/framework/unmanaged-api/hosting/corexemain-function.md) function instead."},{"content":"The operating system loader calls this method regardless of the entry point specified in the DLL file.","pos":[1684,1786]},{"content":"In Windows 98, Windows ME, Windows NT, and Windows 2000, the <ph id=\"ph1\">`_CorDllMain`</ph> function is called indirectly through a fixupin the operating system loader.","pos":[1793,1944],"source":"In Windows 98, Windows ME, Windows NT, and Windows 2000, the `_CorDllMain` function is called indirectly through a fixupin the operating system loader."},{"content":"In all other versions of Windows, it is called directly by the operating system loader.","pos":[1945,2032]},{"pos":[2039,2203],"content":"For additional information, see the Remarks section in the <bpt id=\"p1\">[</bpt>_CorValidateImage<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corvalidateimage-function.md)</ept> topic.","source":"For additional information, see the Remarks section in the [_CorValidateImage](../../../../docs/framework/unmanaged-api/hosting/corvalidateimage-function.md) topic."},{"pos":[2212,2224],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2228,2332],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2339,2356],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> Cor.h","source":"**Header:** Cor.h"},{"pos":[2363,2413],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MsCorEE.dll","source":"**Library:** Included as a resource in MsCorEE.dll"},{"pos":[2420,2528],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]"},{"pos":[2537,2545],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2549,2670],"content":"<bpt id=\"p1\">[</bpt>Metadata Global Static Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/metadata-global-static-functions.md)</ept>","source":"[Metadata Global Static Functions](../../../../docs/framework/unmanaged-api/metadata/metadata-global-static-functions.md)"}]}