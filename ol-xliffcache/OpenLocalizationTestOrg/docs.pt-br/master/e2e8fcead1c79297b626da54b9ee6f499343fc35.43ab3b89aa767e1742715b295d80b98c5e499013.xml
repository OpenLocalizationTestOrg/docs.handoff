{"content":"---\ntitle: \"Task 2: Host the Workflow Designer | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 0a29b138-270d-4846-b78e-2b875e34e501\ncaps.latest.revision: 19\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Task 2: Host the Workflow Designer\nThis topic describes the procedure for hosting an instance of the [!INCLUDE[wfd1](../../../includes/wfd1-md.md)] in a [!INCLUDE[avalon1](../../../includes/avalon1-md.md)] application.  \n  \n The procedure configures the **Grid** control that contains the designer, programmatically creates an instance of the <xref:System.Activities.Presentation.WorkflowDesigner> that contains a default <xref:System.Activities.Statements.Sequence> activity, registers the designer metadata to provide designer support for all built-in activities, and hosts the [!INCLUDE[wfd2](../../../includes/wfd2-md.md)] in the [!INCLUDE[avalon2](../../../includes/avalon2-md.md)] application.  \n  \n### To host the workflow designer  \n  \n1.  Open the HostingApplication project you created in [Task 1: Create a New Windows Presentation Foundation Application](../../../docs/framework/windows-workflow-foundation/task-1-create-a-new-wpf-app.md).  \n  \n2.  Adjust the size of the window to make it easier to use the [!INCLUDE[wfd2](../../../includes/wfd2-md.md)]. To do this, select **MainWindow** in the designer, press F4 to display the **Properties** window, and, in the **Layout** section there, set the **Width** to a value of 600 and the **Height** to a value of 350.  \n  \n3.  Set the grid name by selecting the **Grid** panel in the designer (click the box inside the **MainWindow**) and setting the **Name** property at the top of the **Properties** window to \"grid1\".  \n  \n4.  In the **Properties** window, click the ellipsis (**…**) next to the `ColumnDefinitions` property to open the **Collection Editor** dialog box.  \n  \n5.  In the **Collection Editor** dialog box, click the **Add** button three times to insert three columns into the layout. The first column will contain the **Toolbox**, the second column will host the [!INCLUDE[wfd2](../../../includes/wfd2-md.md)], and the third column will be used for the property inspector.  \n  \n6.  Set the `Width` property of the middle column to the value \"4*\".  \n  \n7.  Click **OK** to save the changes. The following XAML is added to your MainWindow.xaml file:  \n  \n    ```  \n  \n    <Grid Name=\"grid1\">  \n        <Grid.ColumnDefinitions>  \n            <ColumnDefinition />  \n            <ColumnDefinition Width=\"4*\" />  \n            <ColumnDefinition />  \n        </Grid.ColumnDefinitions>  \n    </Grid>  \n  \n    ```  \n  \n8.  In **Solution Explorer**, right-click MainWindow.xaml and select **View Code**. Modify the code by following these steps:  \n  \n    1.  Add the following namespaces:  \n  \n        ```csharp  \n  \n        using System.Activities;  \n        using System.Activities.Core.Presentation;  \n        using System.Activities.Presentation;  \n        using System.Activities.Presentation.Metadata;  \n        using System.Activities.Presentation.Toolbox;  \n        using System.Activities.Statements;  \n        using System.ComponentModel;  \n  \n        ```  \n  \n    2.  To declare a private member field to hold an instance of the <xref:System.Activities.Presentation.WorkflowDesigner>, add the following code to the `MainWindow` class.  \n  \n        ```csharp  \n  \n        public partial class MainWindow : Window  \n        {  \n            private WorkflowDesigner wd;  \n  \n            public MainWindow()  \n            {  \n                InitializeComponent();  \n            }  \n        }  \n  \n        ```  \n  \n    3.  Add the following `AddDesigner` method to the `MainWindow` class. The implementation creates an instance of the <xref:System.Activities.Presentation.WorkflowDesigner>, adds a <xref:System.Activities.Statements.Sequence> activity to it, and places it in middle column of the grid1 **Grid**.  \n  \n        ```csharp  \n  \n        private void AddDesigner()  \n        {  \n            //Create an instance of WorkflowDesigner class.  \n            this.wd = new WorkflowDesigner();  \n  \n            //Place the designer canvas in the middle column of the grid.  \n            Grid.SetColumn(this.wd.View, 1);  \n  \n            //Load a new Sequence as default.  \n            this.wd.Load(new Sequence());  \n  \n            //Add the designer canvas to the grid.  \n            grid1.Children.Add(this.wd.View);  \n        }  \n  \n        ```  \n  \n    4.  Register the designer metadata to add designer support for all the  built-in activities. This enables you to drop activities from the toolbox onto the original <xref:System.Activities.Statements.Sequence> activity in the [!INCLUDE[wfd2](../../../includes/wfd2-md.md)]. To do this, add the `RegisterMetadata` method to the `MainWindow` class.  \n  \n        ```csharp  \n  \n        private void RegisterMetadata()  \n        {               \n            DesignerMetadata dm = new DesignerMetadata();  \n            dm.Register();  \n        }  \n  \n        ```  \n  \n         [!INCLUDE[crabout](../../../includes/crabout-md.md)] registering activity designers, see [How to: Create a Custom Activity Designer](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-activity-designer.md).  \n  \n    5.  In the `MainWindow` class constructor, add calls to the methods declared previously to register the metadata for designer support and to create the <xref:System.Activities.Presentation.WorkflowDesigner>.  \n  \n        ```csharp  \n        public MainWindow()  \n        {  \n            InitializeComponent();  \n  \n            // Register the metadata  \n            RegisterMetadata();  \n  \n            // Add the WFF Designer  \n            AddDesigner();  \n        }  \n  \n        ```  \n  \n        > [!NOTE]\n        >  The `RegisterMetadata` method registers the designer metadata of built-in activities including the <xref:System.Activities.Statements.Sequence> activity. Because the `AddDesigner` method uses the <xref:System.Activities.Statements.Sequence> activity, the `RegisterMetadata` method must be called first.  \n  \n9. Press F5 to build and run the solution.  \n  \n10. See [Task 3: Create the Toolbox and PropertyGrid Panes](../../../docs/framework/windows-workflow-foundation/task-3-create-the-toolbox-and-propertygrid-panes.md) to learn how to add **Toolbox** and **PropertyGrid** support to your rehosted workflow designer.  \n  \n## See Also  \n [Rehosting the Workflow Designer](../../../docs/framework/windows-workflow-foundation/rehosting-the-workflow-designer.md)   \n [Task 1: Create a New Windows Presentation Foundation Application](../../../docs/framework/windows-workflow-foundation/task-1-create-a-new-wpf-app.md)   \n [Task 3: Create the Toolbox and PropertyGrid Panes](../../../docs/framework/windows-workflow-foundation/task-3-create-the-toolbox-and-propertygrid-panes.md)","nodes":[{"pos":[12,63],"content":"Task 2: Host the Workflow Designer | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Task 2: Host the Workflow Designer | Microsoft Docs","pos":[0,51]}]},{"pos":[329,363],"content":"Task 2: Host the Workflow Designer","linkify":"Task 2: Host the Workflow Designer","nodes":[{"content":"Task 2: Host the Workflow Designer","pos":[0,34]}]},{"pos":[364,547],"content":"This topic describes the procedure for hosting an instance of the <ph id=\"ph1\">[!INCLUDE[wfd1](../../../includes/wfd1-md.md)]</ph> in a <ph id=\"ph2\">[!INCLUDE[avalon1](../../../includes/avalon1-md.md)]</ph> application.","source":"This topic describes the procedure for hosting an instance of the [!INCLUDE[wfd1](../../../includes/wfd1-md.md)] in a [!INCLUDE[avalon1](../../../includes/avalon1-md.md)] application."},{"pos":[554,1028],"content":"The procedure configures the <bpt id=\"p1\">**</bpt>Grid<ept id=\"p1\">**</ept> control that contains the designer, programmatically creates an instance of the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.WorkflowDesigner&gt;</ph> that contains a default <ph id=\"ph2\">&lt;xref:System.Activities.Statements.Sequence&gt;</ph> activity, registers the designer metadata to provide designer support for all built-in activities, and hosts the <ph id=\"ph3\">[!INCLUDE[wfd2](../../../includes/wfd2-md.md)]</ph> in the <ph id=\"ph4\">[!INCLUDE[avalon2](../../../includes/avalon2-md.md)]</ph> application.","source":"The procedure configures the **Grid** control that contains the designer, programmatically creates an instance of the <xref:System.Activities.Presentation.WorkflowDesigner> that contains a default <xref:System.Activities.Statements.Sequence> activity, registers the designer metadata to provide designer support for all built-in activities, and hosts the [!INCLUDE[wfd2](../../../includes/wfd2-md.md)] in the [!INCLUDE[avalon2](../../../includes/avalon2-md.md)] application."},{"pos":[1038,1067],"content":"To host the workflow designer","linkify":"To host the workflow designer","nodes":[{"content":"To host the workflow designer","pos":[0,29]}]},{"pos":[1077,1279],"content":"Open the HostingApplication project you created in <bpt id=\"p1\">[</bpt>Task 1: Create a New Windows Presentation Foundation Application<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/task-1-create-a-new-wpf-app.md)</ept>.","source":"Open the HostingApplication project you created in [Task 1: Create a New Windows Presentation Foundation Application](../../../docs/framework/windows-workflow-foundation/task-1-create-a-new-wpf-app.md)."},{"content":"Adjust the size of the window to make it easier to use the <ph id=\"ph1\">[!INCLUDE[wfd2](../../../includes/wfd2-md.md)]</ph>.","pos":[1289,1395],"source":"Adjust the size of the window to make it easier to use the [!INCLUDE[wfd2](../../../includes/wfd2-md.md)]."},{"content":"To do this, select <bpt id=\"p1\">**</bpt>MainWindow<ept id=\"p1\">**</ept> in the designer, press F4 to display the <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> window, and, in the <bpt id=\"p3\">**</bpt>Layout<ept id=\"p3\">**</ept> section there, set the <bpt id=\"p4\">**</bpt>Width<ept id=\"p4\">**</ept> to a value of 600 and the <bpt id=\"p5\">**</bpt>Height<ept id=\"p5\">**</ept> to a value of 350.","pos":[1396,1605],"source":" To do this, select **MainWindow** in the designer, press F4 to display the **Properties** window, and, in the **Layout** section there, set the **Width** to a value of 600 and the **Height** to a value of 350."},{"pos":[1615,1808],"content":"Set the grid name by selecting the <bpt id=\"p1\">**</bpt>Grid<ept id=\"p1\">**</ept> panel in the designer (click the box inside the <bpt id=\"p2\">**</bpt>MainWindow<ept id=\"p2\">**</ept>) and setting the <bpt id=\"p3\">**</bpt>Name<ept id=\"p3\">**</ept> property at the top of the <bpt id=\"p4\">**</bpt>Properties<ept id=\"p4\">**</ept> window to \"grid1\".","source":"Set the grid name by selecting the **Grid** panel in the designer (click the box inside the **MainWindow**) and setting the **Name** property at the top of the **Properties** window to \"grid1\"."},{"pos":[1818,1961],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, click the ellipsis (<bpt id=\"p2\">**</bpt>…<ept id=\"p2\">**</ept>) next to the <ph id=\"ph1\">`ColumnDefinitions`</ph> property to open the <bpt id=\"p3\">**</bpt>Collection Editor<ept id=\"p3\">**</ept> dialog box.","source":"In the **Properties** window, click the ellipsis (**…**) next to the `ColumnDefinitions` property to open the **Collection Editor** dialog box."},{"content":"In the <bpt id=\"p1\">**</bpt>Collection Editor<ept id=\"p1\">**</ept> dialog box, click the <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept> button three times to insert three columns into the layout.","pos":[1971,2089],"source":"In the **Collection Editor** dialog box, click the **Add** button three times to insert three columns into the layout."},{"content":"The first column will contain the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, the second column will host the <ph id=\"ph1\">[!INCLUDE[wfd2](../../../includes/wfd2-md.md)]</ph>, and the third column will be used for the property inspector.","pos":[2090,2278],"source":" The first column will contain the **Toolbox**, the second column will host the [!INCLUDE[wfd2](../../../includes/wfd2-md.md)], and the third column will be used for the property inspector."},{"pos":[2288,2352],"content":"Set the <ph id=\"ph1\">`Width`</ph> property of the middle column to the value \"4*\".","source":"Set the `Width` property of the middle column to the value \"4*\"."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to save the changes.","pos":[2362,2395],"source":"Click **OK** to save the changes."},{"content":"The following XAML is added to your MainWindow.xaml file:","pos":[2396,2453]},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click MainWindow.xaml and select <bpt id=\"p2\">**</bpt>View Code<ept id=\"p2\">**</ept>.","pos":[2719,2798],"source":"In **Solution Explorer**, right-click MainWindow.xaml and select **View Code**."},{"content":"Modify the code by following these steps:","pos":[2799,2840]},{"content":"Add the following namespaces:","pos":[2854,2883]},{"pos":[3274,3440],"content":"To declare a private member field to hold an instance of the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.WorkflowDesigner&gt;</ph>, add the following code to the <ph id=\"ph2\">`MainWindow`</ph> class.","source":"To declare a private member field to hold an instance of the <xref:System.Activities.Presentation.WorkflowDesigner>, add the following code to the `MainWindow` class."},{"content":"Add the following <ph id=\"ph1\">`AddDesigner`</ph> method to the <ph id=\"ph2\">`MainWindow`</ph> class.","pos":[3725,3790],"source":"Add the following `AddDesigner` method to the `MainWindow` class."},{"content":"The implementation creates an instance of the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.WorkflowDesigner&gt;</ph>, adds a <ph id=\"ph2\">&lt;xref:System.Activities.Statements.Sequence&gt;</ph> activity to it, and places it in middle column of the grid1 <bpt id=\"p1\">**</bpt>Grid<ept id=\"p1\">**</ept>.","pos":[3791,4014],"source":" The implementation creates an instance of the <xref:System.Activities.Presentation.WorkflowDesigner>, adds a <xref:System.Activities.Statements.Sequence> activity to it, and places it in middle column of the grid1 **Grid**."},{"content":"Register the designer metadata to add designer support for all the  built-in activities.","pos":[4567,4655]},{"content":"This enables you to drop activities from the toolbox onto the original <ph id=\"ph1\">&lt;xref:System.Activities.Statements.Sequence&gt;</ph> activity in the <ph id=\"ph2\">[!INCLUDE[wfd2](../../../includes/wfd2-md.md)]</ph>.","pos":[4656,4835],"source":" This enables you to drop activities from the toolbox onto the original <xref:System.Activities.Statements.Sequence> activity in the [!INCLUDE[wfd2](../../../includes/wfd2-md.md)]."},{"content":"To do this, add the <ph id=\"ph1\">`RegisterMetadata`</ph> method to the <ph id=\"ph2\">`MainWindow`</ph> class.","pos":[4836,4908],"source":" To do this, add the `RegisterMetadata` method to the `MainWindow` class."},{"pos":[5134,5364],"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../includes/crabout-md.md)]</ph> registering activity designers, see <bpt id=\"p1\">[</bpt>How to: Create a Custom Activity Designer<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-activity-designer.md)</ept>.","source":"[!INCLUDE[crabout](../../../includes/crabout-md.md)] registering activity designers, see [How to: Create a Custom Activity Designer](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-activity-designer.md)."},{"pos":[5378,5581],"content":"In the <ph id=\"ph1\">`MainWindow`</ph> class constructor, add calls to the methods declared previously to register the metadata for designer support and to create the <ph id=\"ph2\">&lt;xref:System.Activities.Presentation.WorkflowDesigner&gt;</ph>.","source":"In the `MainWindow` class constructor, add calls to the methods declared previously to register the metadata for designer support and to create the <xref:System.Activities.Presentation.WorkflowDesigner>."},{"pos":[5874,6195],"content":"[!NOTE]\nThe `RegisterMetadata` method registers the designer metadata of built-in activities including the <xref:System.Activities.Statements.Sequence> activity. Because the `AddDesigner` method uses the <xref:System.Activities.Statements.Sequence> activity, the `RegisterMetadata` method must be called first.","leadings":["","        >  "],"nodes":[{"content":"The `RegisterMetadata` method registers the designer metadata of built-in activities including the <xref:System.Activities.Statements.Sequence> activity. Because the `AddDesigner` method uses the <xref:System.Activities.Statements.Sequence> activity, the `RegisterMetadata` method must be called first.","pos":[8,310],"nodes":[{"content":"The <ph id=\"ph1\">`RegisterMetadata`</ph> method registers the designer metadata of built-in activities including the <ph id=\"ph2\">&lt;xref:System.Activities.Statements.Sequence&gt;</ph> activity.","pos":[0,153],"source":"The `RegisterMetadata` method registers the designer metadata of built-in activities including the <xref:System.Activities.Statements.Sequence> activity."},{"content":"Because the <ph id=\"ph1\">`AddDesigner`</ph> method uses the <ph id=\"ph2\">&lt;xref:System.Activities.Statements.Sequence&gt;</ph> activity, the <ph id=\"ph3\">`RegisterMetadata`</ph> method must be called first.","pos":[154,302],"source":" Because the `AddDesigner` method uses the <xref:System.Activities.Statements.Sequence> activity, the `RegisterMetadata` method must be called first."}]}]},{"content":"Press F5 to build and run the solution.","pos":[6204,6243]},{"pos":[6253,6510],"content":"See <bpt id=\"p1\">[</bpt>Task 3: Create the Toolbox and PropertyGrid Panes<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/task-3-create-the-toolbox-and-propertygrid-panes.md)</ept> to learn how to add <bpt id=\"p2\">**</bpt>Toolbox<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>PropertyGrid<ept id=\"p3\">**</ept> support to your rehosted workflow designer.","source":"See [Task 3: Create the Toolbox and PropertyGrid Panes](../../../docs/framework/windows-workflow-foundation/task-3-create-the-toolbox-and-propertygrid-panes.md) to learn how to add **Toolbox** and **PropertyGrid** support to your rehosted workflow designer."},{"pos":[6519,6527],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Rehosting the Workflow Designer<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/rehosting-the-workflow-designer.md)</ept><ph id=\"ph1\"> </ph>","pos":[6531,6653],"source":"[Rehosting the Workflow Designer](../../../docs/framework/windows-workflow-foundation/rehosting-the-workflow-designer.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Task 1: Create a New Windows Presentation Foundation Application<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/task-1-create-a-new-wpf-app.md)</ept><ph id=\"ph1\"> </ph>","pos":[6656,6808],"source":" [Task 1: Create a New Windows Presentation Foundation Application](../../../docs/framework/windows-workflow-foundation/task-1-create-a-new-wpf-app.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Task 3: Create the Toolbox and PropertyGrid Panes<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/task-3-create-the-toolbox-and-propertygrid-panes.md)</ept>","pos":[6811,6968],"source":" [Task 3: Create the Toolbox and PropertyGrid Panes](../../../docs/framework/windows-workflow-foundation/task-3-create-the-toolbox-and-propertygrid-panes.md)"}]}