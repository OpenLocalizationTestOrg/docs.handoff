{"content":"---\ntitle: \"Marshaling Strings | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"marshaling, samples\"\n  - \"platform invoke, marshaling data\"\n  - \"data marshaling, strings\"\n  - \"data marshaling, samples\"\n  - \"data marshaling, platform invoke\"\n  - \"marshaling. strings\"\n  - \"marshaling, platform invoke\"\n  - \"sample applications [.NET Framework], marshaling strings\"\nms.assetid: e21b078b-70fb-4905-be26-c097ab2433ff\ncaps.latest.revision: 9\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Marshaling Strings\nPlatform invoke copies string parameters, converting them from the .NET Framework format (Unicode) to the unmanaged format (ANSI), if needed. Because managed strings are immutable, platform invoke does not copy them back from unmanaged memory to managed memory when the function returns.  \n  \n The following table lists marshaling options for strings, describes their usage, and provides a link to the corresponding .NET Framework sample.  \n  \n|String|Description|Sample|  \n|------------|-----------------|------------|  \n|By value.|Passes strings as In parameters.|[MsgBox](../../../docs/framework/interop/msgbox-sample.md)|  \n|As result.|Returns strings from unmanaged code.|[Strings](http://msdn.microsoft.com/en-us/be9e82a3-dc95-4aaa-9396-61b66e467e02)|  \n|By reference.|Passes strings as In/Out parameters using <xref:System.Text.StringBuilder>.|[Buffers](http://msdn.microsoft.com/en-us/e30d36e8-d7c4-4936-916a-8fdbe4d9ffd5)|  \n|In a structure by value.|Passes strings in a structure that is an In parameter.|[Structs](http://msdn.microsoft.com/en-us/96a62265-dcf9-4608-bc0a-1f762ab9f48e)|  \n|In a structure by reference **(char\\*)**.|Passes strings in a structure that is an In/Out parameter. The unmanaged function expects a pointer to a character buffer and the buffer size is a member of the structure.|[Strings](http://msdn.microsoft.com/en-us/be9e82a3-dc95-4aaa-9396-61b66e467e02)|  \n|In a structure by reference **(char[])**.|Passes strings in a structure that is an In/Out parameter. The unmanaged function expects an embedded character buffer.|[OSInfo](http://msdn.microsoft.com/en-us/69d89067-507b-41fe-859d-30bf3ff29455)|  \n|In a class by value **(char\\*)**.|Passes strings in a class (a class is an In/Out parameter). The unmanaged function expects a pointer to a character buffer.|[OpenFileDlg](http://msdn.microsoft.com/en-us/b7dea792-cb92-4baf-ac7b-6a24803e6c75)|  \n|In a class by value **(char[])**.|Passes strings in a class (a class is an In/Out parameter). The unmanaged function expects an embedded character buffer.|[OSInfo](http://msdn.microsoft.com/en-us/69d89067-507b-41fe-859d-30bf3ff29455)|  \n|As an array of strings by value.|Creates an array of strings that is passed by value.|[Arrays](../../../docs/framework/interop/marshaling-different-types-of-arrays.md)|  \n|As an array of structures that contain strings by value.|Creates an array of structures that contain strings and the array is passed by value.|[Arrays](../../../docs/framework/interop/marshaling-different-types-of-arrays.md)|  \n  \n## See Also  \n [Marshaling Data with Platform Invoke](../../../docs/framework/interop/marshaling-data-with-platform-invoke.md)   \n [Platform Invoke Data Types](http://msdn.microsoft.com/en-us/16014d9f-d6bd-481e-83f0-df11377c550f)   \n [Marshaling Classes, Structures, and Unions](../../../docs/framework/interop/marshaling-classes-structures-and-unions.md)   \n [Marshaling Arrays of Types](http://msdn.microsoft.com/en-us/049b1c1b-228f-4445-88ec-91bc7fd4b1e8)   \n [Miscellaneous Marshaling Samples](http://msdn.microsoft.com/en-us/a915c948-54e9-4d0f-a525-95a77fd8ed70)","nodes":[{"pos":[12,47],"content":"Marshaling Strings | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Marshaling Strings | Microsoft Docs","pos":[0,35]}]},{"pos":[718,736],"content":"Marshaling Strings","linkify":"Marshaling Strings","nodes":[{"content":"Marshaling Strings","pos":[0,18]}]},{"content":"Platform invoke copies string parameters, converting them from the .NET Framework format (Unicode) to the unmanaged format (ANSI), if needed.","pos":[737,878]},{"content":"Because managed strings are immutable, platform invoke does not copy them back from unmanaged memory to managed memory when the function returns.","pos":[879,1024]},{"content":"The following table lists marshaling options for strings, describes their usage, and provides a link to the corresponding .NET Framework sample.","pos":[1031,1175]},{"content":"String","pos":[1182,1188]},{"content":"Description","pos":[1189,1200]},{"content":"Sample","pos":[1201,1207]},{"content":"By value.","pos":[1260,1269]},{"content":"Passes strings as In parameters.","pos":[1270,1302]},{"pos":[1303,1361],"content":"<bpt id=\"p1\">[</bpt>MsgBox<ept id=\"p1\">](../../../docs/framework/interop/msgbox-sample.md)</ept>","source":"[MsgBox](../../../docs/framework/interop/msgbox-sample.md)"},{"content":"As result.","pos":[1366,1376]},{"content":"Returns strings from unmanaged code.","pos":[1377,1413]},{"pos":[1414,1493],"content":"<bpt id=\"p1\">[</bpt>Strings<ept id=\"p1\">](http://msdn.microsoft.com/en-us/be9e82a3-dc95-4aaa-9396-61b66e467e02)</ept>","source":"[Strings](http://msdn.microsoft.com/en-us/be9e82a3-dc95-4aaa-9396-61b66e467e02)"},{"content":"By reference.","pos":[1498,1511]},{"content":"Passes strings as In/Out parameters using <ph id=\"ph1\">&lt;xref:System.Text.StringBuilder&gt;</ph>.","pos":[1512,1587],"source":"Passes strings as In/Out parameters using <xref:System.Text.StringBuilder>."},{"pos":[1588,1667],"content":"<bpt id=\"p1\">[</bpt>Buffers<ept id=\"p1\">](http://msdn.microsoft.com/en-us/e30d36e8-d7c4-4936-916a-8fdbe4d9ffd5)</ept>","source":"[Buffers](http://msdn.microsoft.com/en-us/e30d36e8-d7c4-4936-916a-8fdbe4d9ffd5)"},{"content":"In a structure by value.","pos":[1672,1696]},{"content":"Passes strings in a structure that is an In parameter.","pos":[1697,1751]},{"pos":[1752,1831],"content":"<bpt id=\"p1\">[</bpt>Structs<ept id=\"p1\">](http://msdn.microsoft.com/en-us/96a62265-dcf9-4608-bc0a-1f762ab9f48e)</ept>","source":"[Structs](http://msdn.microsoft.com/en-us/96a62265-dcf9-4608-bc0a-1f762ab9f48e)"},{"pos":[1836,1877],"content":"In a structure by reference <bpt id=\"p1\">**</bpt>(char<ph id=\"ph1\">\\*</ph>)<ept id=\"p1\">**</ept>.","source":"In a structure by reference **(char\\*)**."},{"content":"Passes strings in a structure that is an In/Out parameter.","pos":[1878,1936]},{"content":"The unmanaged function expects a pointer to a character buffer and the buffer size is a member of the structure.","pos":[1937,2049]},{"pos":[2050,2129],"content":"<bpt id=\"p1\">[</bpt>Strings<ept id=\"p1\">](http://msdn.microsoft.com/en-us/be9e82a3-dc95-4aaa-9396-61b66e467e02)</ept>","source":"[Strings](http://msdn.microsoft.com/en-us/be9e82a3-dc95-4aaa-9396-61b66e467e02)"},{"pos":[2134,2175],"content":"In a structure by reference <bpt id=\"p1\">**</bpt>(char[])<ept id=\"p1\">**</ept>.","source":"In a structure by reference **(char[])**."},{"content":"Passes strings in a structure that is an In/Out parameter.","pos":[2176,2234]},{"content":"The unmanaged function expects an embedded character buffer.","pos":[2235,2295]},{"pos":[2296,2374],"content":"<bpt id=\"p1\">[</bpt>OSInfo<ept id=\"p1\">](http://msdn.microsoft.com/en-us/69d89067-507b-41fe-859d-30bf3ff29455)</ept>","source":"[OSInfo](http://msdn.microsoft.com/en-us/69d89067-507b-41fe-859d-30bf3ff29455)"},{"pos":[2379,2412],"content":"In a class by value <bpt id=\"p1\">**</bpt>(char<ph id=\"ph1\">\\*</ph>)<ept id=\"p1\">**</ept>.","source":"In a class by value **(char\\*)**."},{"content":"Passes strings in a class (a class is an In/Out parameter).","pos":[2413,2472]},{"content":"The unmanaged function expects a pointer to a character buffer.","pos":[2473,2536]},{"pos":[2537,2620],"content":"<bpt id=\"p1\">[</bpt>OpenFileDlg<ept id=\"p1\">](http://msdn.microsoft.com/en-us/b7dea792-cb92-4baf-ac7b-6a24803e6c75)</ept>","source":"[OpenFileDlg](http://msdn.microsoft.com/en-us/b7dea792-cb92-4baf-ac7b-6a24803e6c75)"},{"pos":[2625,2658],"content":"In a class by value <bpt id=\"p1\">**</bpt>(char[])<ept id=\"p1\">**</ept>.","source":"In a class by value **(char[])**."},{"content":"Passes strings in a class (a class is an In/Out parameter).","pos":[2659,2718]},{"content":"The unmanaged function expects an embedded character buffer.","pos":[2719,2779]},{"pos":[2780,2858],"content":"<bpt id=\"p1\">[</bpt>OSInfo<ept id=\"p1\">](http://msdn.microsoft.com/en-us/69d89067-507b-41fe-859d-30bf3ff29455)</ept>","source":"[OSInfo](http://msdn.microsoft.com/en-us/69d89067-507b-41fe-859d-30bf3ff29455)"},{"content":"As an array of strings by value.","pos":[2863,2895]},{"content":"Creates an array of strings that is passed by value.","pos":[2896,2948]},{"pos":[2949,3030],"content":"<bpt id=\"p1\">[</bpt>Arrays<ept id=\"p1\">](../../../docs/framework/interop/marshaling-different-types-of-arrays.md)</ept>","source":"[Arrays](../../../docs/framework/interop/marshaling-different-types-of-arrays.md)"},{"content":"As an array of structures that contain strings by value.","pos":[3035,3091]},{"content":"Creates an array of structures that contain strings and the array is passed by value.","pos":[3092,3177]},{"pos":[3178,3259],"content":"<bpt id=\"p1\">[</bpt>Arrays<ept id=\"p1\">](../../../docs/framework/interop/marshaling-different-types-of-arrays.md)</ept>","source":"[Arrays](../../../docs/framework/interop/marshaling-different-types-of-arrays.md)"},{"pos":[3269,3277],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Marshaling Data with Platform Invoke<ept id=\"p1\">](../../../docs/framework/interop/marshaling-data-with-platform-invoke.md)</ept><ph id=\"ph1\"> </ph>","pos":[3281,3393],"source":"[Marshaling Data with Platform Invoke](../../../docs/framework/interop/marshaling-data-with-platform-invoke.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Platform Invoke Data Types<ept id=\"p1\">](http://msdn.microsoft.com/en-us/16014d9f-d6bd-481e-83f0-df11377c550f)</ept><ph id=\"ph1\"> </ph>","pos":[3396,3496],"source":" [Platform Invoke Data Types](http://msdn.microsoft.com/en-us/16014d9f-d6bd-481e-83f0-df11377c550f) "},{"content":"<bpt id=\"p1\"> [</bpt>Marshaling Classes, Structures, and Unions<ept id=\"p1\">](../../../docs/framework/interop/marshaling-classes-structures-and-unions.md)</ept><ph id=\"ph1\"> </ph>","pos":[3499,3622],"source":" [Marshaling Classes, Structures, and Unions](../../../docs/framework/interop/marshaling-classes-structures-and-unions.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Marshaling Arrays of Types<ept id=\"p1\">](http://msdn.microsoft.com/en-us/049b1c1b-228f-4445-88ec-91bc7fd4b1e8)</ept><ph id=\"ph1\"> </ph>","pos":[3625,3725],"source":" [Marshaling Arrays of Types](http://msdn.microsoft.com/en-us/049b1c1b-228f-4445-88ec-91bc7fd4b1e8) "},{"content":"<bpt id=\"p1\"> [</bpt>Miscellaneous Marshaling Samples<ept id=\"p1\">](http://msdn.microsoft.com/en-us/a915c948-54e9-4d0f-a525-95a77fd8ed70)</ept>","pos":[3728,3833],"source":" [Miscellaneous Marshaling Samples](http://msdn.microsoft.com/en-us/a915c948-54e9-4d0f-a525-95a77fd8ed70)"}]}