{"content":"---\ntitle: \"Modifying Data with a DbDataAdapter\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: e35c7f9e-648b-4fcc-9361-d365c3e42c9a\n---\n# Modifying Data with a DbDataAdapter\nThe <xref:System.Data.Common.DbProviderFactory.CreateDataAdapter%2A> method of a <xref:System.Data.Common.DbProviderFactory> object gives you a <xref:System.Data.Common.DbDataAdapter> object that is strongly typed to the underlying data provider specified at the time you create the factory. You can then use a <xref:System.Data.Common.DbCommandBuilder> to create commands to insert, update, and delete data from a <xref:System.Data.DataSet> to a data source.  \n  \n## Retrieving Data with a DbDataAdapter  \n This example demonstrates how to create a strongly typed `DbDataAdapter` based on a provider name and connection string. The code uses the <xref:System.Data.Common.DbProviderFactory.CreateConnection%2A> method of the <xref:System.Data.Common.DbProviderFactory> to create a <xref:System.Data.Common.DbConnection>. Next, the code uses the <xref:System.Data.Common.DbProviderFactory.CreateCommand%2A> method to create a <xref:System.Data.Common.DbCommand> to select data by setting its `CommandText` and `Connection` properties. Finally, the code creates a <xref:System.Data.Common.DbDataAdapter> object using the <xref:System.Data.Common.DbProviderFactory.CreateDataAdapter%2A> method and sets its `SelectCommand` property. The `Fill` method of the `DbDataAdapter` loads the data into a <xref:System.Data.DataTable>.  \n  \n [!code-csharp[DataWorks DbProviderFactories.DbDataAdapter#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DbProviderFactories.DbDataAdapter/CS/source.cs#1)]\n [!code-vb[DataWorks DbProviderFactories.DbDataAdapter#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DbProviderFactories.DbDataAdapter/VB/source.vb#1)]  \n  \n## Modifying Data with a DbDataAdapter  \n This example demonstrates how to modify data in a `DataTable` using a <xref:System.Data.Common.DbDataAdapter> by using a <xref:System.Data.Common.DbCommandBuilder> to generate the commands required for updating data at the data source. The <xref:System.Data.Common.DbDataAdapter.SelectCommand%2A> of the `DbDataAdapter` is set to retrieve the CustomerID and CompanyName from the Customers table. The <xref:System.Data.Common.DbCommandBuilder.GetInsertCommand%2A> method is used to set the <xref:System.Data.Common.DbDataAdapter.InsertCommand%2A> property, the <xref:System.Data.Common.DbCommandBuilder.GetUpdateCommand%2A> method is used to set the <xref:System.Data.Common.DbDataAdapter.UpdateCommand%2A> property, and the <xref:System.Data.Common.DbCommandBuilder.GetDeleteCommand%2A> method is used to set the <xref:System.Data.Common.DbDataAdapter.DeleteCommand%2A> property. The code adds a new row to the Customers table and updates the data source. The code then locates the added row by searching on the CustomerID, which is the primary key defined for the Customers table. It changes the CompanyName and updates the data source. Finally, the code deletes the row.  \n  \n [!code-csharp[DataWorks DbProviderFactories.DbDataAdapterModify#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DbProviderFactories.DbDataAdapterModify/CS/source.cs#1)]\n [!code-vb[DataWorks DbProviderFactories.DbDataAdapterModify#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DbProviderFactories.DbDataAdapterModify/VB/source.vb#1)]  \n  \n## Handling Parameters  \n The .NET Framework data providers handle naming and specifying parameters and parameter placeholders differently. This syntax is tailored to a specific data source, as described in the following table.  \n  \n|Data provider|Parameter naming syntax|  \n|-------------------|-----------------------------|  \n|`SqlClient`|Uses named parameters in the format `@`*parametername*.|  \n|`OracleClient`|Uses named parameters in the format `:`*parmname* (or *parmname*).|  \n|`OleDb`|Uses positional parameter markers indicated by a question mark (`?`).|  \n|`Odbc`|Uses positional parameter markers indicated by a question mark (`?`).|  \n  \n The factory model is not helpful for creating parameterized `DbCommand` and `DbDataAdapter` objects. You will need to branch in your code to create parameters that are tailored to your data provider.  \n  \n> [!IMPORTANT]\n>  Avoiding provider-specific parameters altogether by using string concatenation to construct direct SQL statements is not recommended for security reasons. Using string concatenation instead of parameters leaves your application vulnerable to SQL injection attacks.  \n  \n## See also\n\n- [DbProviderFactories](../../../../docs/framework/data/adonet/dbproviderfactories.md)\n- [Obtaining a DbProviderFactory](../../../../docs/framework/data/adonet/obtaining-a-dbproviderfactory.md)\n- [DbConnection, DbCommand and DbException](../../../../docs/framework/data/adonet/dbconnection-dbcommand-and-dbexception.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,153],"embed":true,"restype":"x-metadata","content":"title: \"Modifying Data with a DbDataAdapter\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: e35c7f9e-648b-4fcc-9361-d365c3e42c9a","nodes":[{"content":"Modifying Data with a DbDataAdapter","nodes":[{"pos":[0,35],"content":"Modifying Data with a DbDataAdapter","nodes":[{"content":"Modifying Data with a DbDataAdapter","pos":[0,35]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[160,195],"content":"Modifying Data with a DbDataAdapter","linkify":"Modifying Data with a DbDataAdapter","nodes":[{"content":"Modifying Data with a DbDataAdapter","pos":[0,35]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Common.DbProviderFactory.CreateDataAdapter%2A&gt;</ph> method of a <ph id=\"ph2\">&lt;xref:System.Data.Common.DbProviderFactory&gt;</ph> object gives you a <ph id=\"ph3\">&lt;xref:System.Data.Common.DbDataAdapter&gt;</ph> object that is strongly typed to the underlying data provider specified at the time you create the factory.","pos":[196,487],"source":"The <xref:System.Data.Common.DbProviderFactory.CreateDataAdapter%2A> method of a <xref:System.Data.Common.DbProviderFactory> object gives you a <xref:System.Data.Common.DbDataAdapter> object that is strongly typed to the underlying data provider specified at the time you create the factory."},{"content":"You can then use a <ph id=\"ph1\">&lt;xref:System.Data.Common.DbCommandBuilder&gt;</ph> to create commands to insert, update, and delete data from a <ph id=\"ph2\">&lt;xref:System.Data.DataSet&gt;</ph> to a data source.","pos":[488,655],"source":" You can then use a <xref:System.Data.Common.DbCommandBuilder> to create commands to insert, update, and delete data from a <xref:System.Data.DataSet> to a data source."},{"pos":[664,700],"content":"Retrieving Data with a DbDataAdapter","linkify":"Retrieving Data with a DbDataAdapter","nodes":[{"content":"Retrieving Data with a DbDataAdapter","pos":[0,36]}]},{"content":"This example demonstrates how to create a strongly typed <ph id=\"ph1\">`DbDataAdapter`</ph> based on a provider name and connection string.","pos":[704,824],"source":"This example demonstrates how to create a strongly typed `DbDataAdapter` based on a provider name and connection string."},{"content":"The code uses the <ph id=\"ph1\">&lt;xref:System.Data.Common.DbProviderFactory.CreateConnection%2A&gt;</ph> method of the <ph id=\"ph2\">&lt;xref:System.Data.Common.DbProviderFactory&gt;</ph> to create a <ph id=\"ph3\">&lt;xref:System.Data.Common.DbConnection&gt;</ph>.","pos":[825,1016],"source":" The code uses the <xref:System.Data.Common.DbProviderFactory.CreateConnection%2A> method of the <xref:System.Data.Common.DbProviderFactory> to create a <xref:System.Data.Common.DbConnection>."},{"content":"Next, the code uses the <ph id=\"ph1\">&lt;xref:System.Data.Common.DbProviderFactory.CreateCommand%2A&gt;</ph> method to create a <ph id=\"ph2\">&lt;xref:System.Data.Common.DbCommand&gt;</ph> to select data by setting its <ph id=\"ph3\">`CommandText`</ph> and <ph id=\"ph4\">`Connection`</ph> properties.","pos":[1017,1229],"source":" Next, the code uses the <xref:System.Data.Common.DbProviderFactory.CreateCommand%2A> method to create a <xref:System.Data.Common.DbCommand> to select data by setting its `CommandText` and `Connection` properties."},{"content":"Finally, the code creates a <ph id=\"ph1\">&lt;xref:System.Data.Common.DbDataAdapter&gt;</ph> object using the <ph id=\"ph2\">&lt;xref:System.Data.Common.DbProviderFactory.CreateDataAdapter%2A&gt;</ph> method and sets its <ph id=\"ph3\">`SelectCommand`</ph> property.","pos":[1230,1425],"source":" Finally, the code creates a <xref:System.Data.Common.DbDataAdapter> object using the <xref:System.Data.Common.DbProviderFactory.CreateDataAdapter%2A> method and sets its `SelectCommand` property."},{"content":"The <ph id=\"ph1\">`Fill`</ph> method of the <ph id=\"ph2\">`DbDataAdapter`</ph> loads the data into a <ph id=\"ph3\">&lt;xref:System.Data.DataTable&gt;</ph>.","pos":[1426,1518],"source":" The `Fill` method of the `DbDataAdapter` loads the data into a <xref:System.Data.DataTable>."},{"pos":[1891,1926],"content":"Modifying Data with a DbDataAdapter","linkify":"Modifying Data with a DbDataAdapter","nodes":[{"content":"Modifying Data with a DbDataAdapter","pos":[0,35]}]},{"content":"This example demonstrates how to modify data in a <ph id=\"ph1\">`DataTable`</ph> using a <ph id=\"ph2\">&lt;xref:System.Data.Common.DbDataAdapter&gt;</ph> by using a <ph id=\"ph3\">&lt;xref:System.Data.Common.DbCommandBuilder&gt;</ph> to generate the commands required for updating data at the data source.","pos":[1930,2165],"source":"This example demonstrates how to modify data in a `DataTable` using a <xref:System.Data.Common.DbDataAdapter> by using a <xref:System.Data.Common.DbCommandBuilder> to generate the commands required for updating data at the data source."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Common.DbDataAdapter.SelectCommand%2A&gt;</ph> of the <ph id=\"ph2\">`DbDataAdapter`</ph> is set to retrieve the CustomerID and CompanyName from the Customers table.","pos":[2166,2325],"source":" The <xref:System.Data.Common.DbDataAdapter.SelectCommand%2A> of the `DbDataAdapter` is set to retrieve the CustomerID and CompanyName from the Customers table."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Common.DbCommandBuilder.GetInsertCommand%2A&gt;</ph> method is used to set the <ph id=\"ph2\">&lt;xref:System.Data.Common.DbDataAdapter.InsertCommand%2A&gt;</ph> property, the <ph id=\"ph3\">&lt;xref:System.Data.Common.DbCommandBuilder.GetUpdateCommand%2A&gt;</ph> method is used to set the <ph id=\"ph4\">&lt;xref:System.Data.Common.DbDataAdapter.UpdateCommand%2A&gt;</ph> property, and the <ph id=\"ph5\">&lt;xref:System.Data.Common.DbCommandBuilder.GetDeleteCommand%2A&gt;</ph> method is used to set the <ph id=\"ph6\">&lt;xref:System.Data.Common.DbDataAdapter.DeleteCommand%2A&gt;</ph> property.","pos":[2326,2809],"source":" The <xref:System.Data.Common.DbCommandBuilder.GetInsertCommand%2A> method is used to set the <xref:System.Data.Common.DbDataAdapter.InsertCommand%2A> property, the <xref:System.Data.Common.DbCommandBuilder.GetUpdateCommand%2A> method is used to set the <xref:System.Data.Common.DbDataAdapter.UpdateCommand%2A> property, and the <xref:System.Data.Common.DbCommandBuilder.GetDeleteCommand%2A> method is used to set the <xref:System.Data.Common.DbDataAdapter.DeleteCommand%2A> property."},{"content":"The code adds a new row to the Customers table and updates the data source.","pos":[2810,2885]},{"content":"The code then locates the added row by searching on the CustomerID, which is the primary key defined for the Customers table.","pos":[2886,3011]},{"content":"It changes the CompanyName and updates the data source.","pos":[3012,3067]},{"content":"Finally, the code deletes the row.","pos":[3068,3102]},{"pos":[3499,3518],"content":"Handling Parameters","linkify":"Handling Parameters","nodes":[{"content":"Handling Parameters","pos":[0,19]}]},{"content":"The .NET Framework data providers handle naming and specifying parameters and parameter placeholders differently.","pos":[3522,3635]},{"content":"This syntax is tailored to a specific data source, as described in the following table.","pos":[3636,3723]},{"content":"Data provider","pos":[3730,3743]},{"content":"Parameter naming syntax","pos":[3744,3767]},{"pos":[3838,3893],"content":"Uses named parameters in the format <ph id=\"ph1\">`@`</ph><bpt id=\"p1\">*</bpt>parametername<ept id=\"p1\">*</ept>.","source":"Uses named parameters in the format `@`*parametername*."},{"pos":[3913,3979],"content":"Uses named parameters in the format <ph id=\"ph1\">`:`</ph><bpt id=\"p1\">*</bpt>parmname<ept id=\"p1\">*</ept> (or <bpt id=\"p2\">*</bpt>parmname<ept id=\"p2\">*</ept>).","source":"Uses named parameters in the format `:`*parmname* (or *parmname*)."},{"pos":[3992,4061],"content":"Uses positional parameter markers indicated by a question mark (<ph id=\"ph1\">`?`</ph>).","source":"Uses positional parameter markers indicated by a question mark (`?`)."},{"pos":[4073,4142],"content":"Uses positional parameter markers indicated by a question mark (<ph id=\"ph1\">`?`</ph>).","source":"Uses positional parameter markers indicated by a question mark (`?`)."},{"content":"The factory model is not helpful for creating parameterized <ph id=\"ph1\">`DbCommand`</ph> and <ph id=\"ph2\">`DbDataAdapter`</ph> objects.","pos":[4150,4250],"source":"The factory model is not helpful for creating parameterized `DbCommand` and `DbDataAdapter` objects."},{"content":"You will need to branch in your code to create parameters that are tailored to your data provider.","pos":[4251,4349]},{"pos":[4357,4637],"content":"[!IMPORTANT]\n Avoiding provider-specific parameters altogether by using string concatenation to construct direct SQL statements is not recommended for security reasons. Using string concatenation instead of parameters leaves your application vulnerable to SQL injection attacks.","leadings":["","> "],"nodes":[{"content":"Avoiding provider-specific parameters altogether by using string concatenation to construct direct SQL statements is not recommended for security reasons. Using string concatenation instead of parameters leaves your application vulnerable to SQL injection attacks.","pos":[14,278],"nodes":[{"content":"Avoiding provider-specific parameters altogether by using string concatenation to construct direct SQL statements is not recommended for security reasons.","pos":[0,154]},{"content":"Using string concatenation instead of parameters leaves your application vulnerable to SQL injection attacks.","pos":[155,264]}]}]},{"pos":[4646,4654],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4658,4742],"content":"<bpt id=\"p1\">[</bpt>DbProviderFactories<ept id=\"p1\">](../../../../docs/framework/data/adonet/dbproviderfactories.md)</ept>","source":"[DbProviderFactories](../../../../docs/framework/data/adonet/dbproviderfactories.md)"},{"pos":[4745,4849],"content":"<bpt id=\"p1\">[</bpt>Obtaining a DbProviderFactory<ept id=\"p1\">](../../../../docs/framework/data/adonet/obtaining-a-dbproviderfactory.md)</ept>","source":"[Obtaining a DbProviderFactory](../../../../docs/framework/data/adonet/obtaining-a-dbproviderfactory.md)"},{"pos":[4852,4975],"content":"<bpt id=\"p1\">[</bpt>DbConnection, DbCommand and DbException<ept id=\"p1\">](../../../../docs/framework/data/adonet/dbconnection-dbcommand-and-dbexception.md)</ept>","source":"[DbConnection, DbCommand and DbException](../../../../docs/framework/data/adonet/dbconnection-dbcommand-and-dbexception.md)"},{"pos":[4978,5082],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}