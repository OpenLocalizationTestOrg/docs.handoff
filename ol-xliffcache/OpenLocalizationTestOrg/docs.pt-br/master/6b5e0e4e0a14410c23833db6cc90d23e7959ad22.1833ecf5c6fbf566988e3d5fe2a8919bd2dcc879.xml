{"content":"---\ntitle: \"Implementing the UI Automation Selection Control Pattern\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"Selection control pattern\"\n  - \"UI Automation, Selection control pattern\"\n  - \"control patterns, Selection\"\nms.assetid: 449c3068-a5d6-4f66-84c6-1bcc7dd4d209\n---\n# Implementing the UI Automation Selection Control Pattern\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.ISelectionProvider>, including information about events and properties. Links to additional references are listed at the end of the topic.  \n  \n The <xref:System.Windows.Automation.SelectionPattern> control pattern is used to support controls that act as containers for a collection of selectable child items. The children of this element must implement <xref:System.Windows.Automation.Provider.ISelectionItemProvider>. For examples of controls that implement this control pattern, see [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md).  \n  \n<a name=\"Implementation_Guidelines_and_Conventions\"></a>   \n## Implementation Guidelines and Conventions  \n When implementing the Selection control pattern, note the following guidelines and conventions:  \n  \n-   Controls that implement <xref:System.Windows.Automation.Provider.ISelectionProvider> allow either single or multiple child items to be selected. For example, list box, list view, and tree view support multiple selections whereas combo box, slider, and radio button group support single selection.  \n  \n-   Controls that have a minimum, maximum, and continuous range, such as the **Volume** slider control, should implement <xref:System.Windows.Automation.Provider.IRangeValueProvider> instead of <xref:System.Windows.Automation.Provider.ISelectionProvider>.  \n  \n-   Single-selection controls that manage child controls that implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>, such as the **Screen Resolution** slider in the **Display Properties** dialog box or the **Color Picker** selection control from [!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)] (illustrated below), should implement <xref:System.Windows.Automation.Provider.ISelectionProvider>; their children should implement both <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> and <xref:System.Windows.Automation.Provider.ISelectionItemProvider>.  \n  \n ![Color picker with yellow highlighted.](../../../docs/framework/ui-automation/media/uia-valuepattern-colorpicker.png \"UIA_ValuePattern_ColorPicker\")  \nExample of Color Swatch String Mapping  \n  \n-   Menus do not support <xref:System.Windows.Automation.SelectionPattern>. If you are working with menu items that include both graphics and text (such as the **Preview Pane** items in the **View** menu in [!INCLUDE[TLA#tla_outlook](../../../includes/tlasharptla-outlook-md.md)]) and need to convey state, you should implement <xref:System.Windows.Automation.Provider.IToggleProvider>.  \n  \n<a name=\"Required_Members_for_ISelectionProvider\"></a>   \n## Required Members for ISelectionProvider  \n The following properties, methods, and events are required for the <xref:System.Windows.Automation.Provider.ISelectionProvider> interface.  \n  \n|Required members|Type|Notes|  \n|----------------------|----------|-----------|  \n|<xref:System.Windows.Automation.Provider.ISelectionProvider.CanSelectMultiple%2A>|Property|Should support property changed events using <xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A> and <xref:System.Windows.Automation.Automation.RemoveAutomationPropertyChangedEventHandler%2A>.|  \n|<xref:System.Windows.Automation.Provider.ISelectionProvider.IsSelectionRequired%2A>|Property|Should support property changed events using <xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A> and <xref:System.Windows.Automation.Automation.RemoveAutomationPropertyChangedEventHandler%2A>.|  \n|<xref:System.Windows.Automation.Provider.ISelectionProvider.GetSelection%2A>|Method|None|  \n|<xref:System.Windows.Automation.SelectionPatternIdentifiers.InvalidatedEvent>|Event|Raised when a selection in a container has changed significantly and requires sending more addition and removal events than the <xref:System.Windows.Automation.Provider.AutomationInteropProvider.InvalidateLimit> constant permits.|  \n  \n The <xref:System.Windows.Automation.Provider.ISelectionProvider.IsSelectionRequired%2A> and <xref:System.Windows.Automation.Provider.ISelectionProvider.CanSelectMultiple%2A> properties can be dynamic. For example, the initial state of a control might not have any items selected by default, indicating that <xref:System.Windows.Automation.Provider.ISelectionProvider.IsSelectionRequired%2A> is `false`. However, after an item is selected, the control must always have at least one item selected. Similarly, in rare cases, a control might allow multiple items to be selected on initialization, but subsequently allow only single selections to be made.  \n  \n<a name=\"Exceptions\"></a>   \n## Exceptions  \n Providers must throw the following exceptions.  \n  \n|Exception Type|Condition|  \n|--------------------|---------------|  \n|<xref:System.Windows.Automation.ElementNotEnabledException>|If the control is not enabled.|  \n|<xref:System.InvalidOperationException>|If the control is hidden.|  \n  \n## See also\n\n- [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)\n- [Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)\n- [UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)\n- [Implementing the UI Automation SelectionItem Control Pattern](../../../docs/framework/ui-automation/implementing-the-ui-automation-selectionitem-control-pattern.md)\n- [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)\n- [Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)\n","nodes":[{"pos":[4,275],"embed":true,"restype":"x-metadata","content":"title: \"Implementing the UI Automation Selection Control Pattern\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"Selection control pattern\"\n  - \"UI Automation, Selection control pattern\"\n  - \"control patterns, Selection\"\nms.assetid: 449c3068-a5d6-4f66-84c6-1bcc7dd4d209","nodes":[{"content":"Implementing the UI Automation Selection Control Pattern","nodes":[{"pos":[0,56],"content":"Implementing the UI Automation Selection Control Pattern","nodes":[{"content":"Implementing the UI Automation Selection Control Pattern","pos":[0,56]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[282,338],"content":"Implementing the UI Automation Selection Control Pattern","linkify":"Implementing the UI Automation Selection Control Pattern","nodes":[{"content":"Implementing the UI Automation Selection Control Pattern","pos":[0,56]}]},{"pos":[341,804],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,461],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"content":"This topic introduces guidelines and conventions for implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ISelectionProvider&gt;</ph>, including information about events and properties.","pos":[811,989],"source":"This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.ISelectionProvider>, including information about events and properties."},{"content":"Links to additional references are listed at the end of the topic.","pos":[990,1056]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Automation.SelectionPattern&gt;</ph> control pattern is used to support controls that act as containers for a collection of selectable child items.","pos":[1063,1227],"source":"The <xref:System.Windows.Automation.SelectionPattern> control pattern is used to support controls that act as containers for a collection of selectable child items."},{"content":"The children of this element must implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ISelectionItemProvider&gt;</ph>.","pos":[1228,1337],"source":" The children of this element must implement <xref:System.Windows.Automation.Provider.ISelectionItemProvider>."},{"content":"For examples of controls that implement this control pattern, see <bpt id=\"p1\">[</bpt>Control Pattern Mapping for UI Automation Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)</ept>.","pos":[1338,1548],"source":" For examples of controls that implement this control pattern, see [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)."},{"pos":[1617,1658],"content":"Implementation Guidelines and Conventions","linkify":"Implementation Guidelines and Conventions","nodes":[{"content":"Implementation Guidelines and Conventions","pos":[0,41]}]},{"content":"When implementing the Selection control pattern, note the following guidelines and conventions:","pos":[1662,1757]},{"content":"Controls that implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ISelectionProvider&gt;</ph> allow either single or multiple child items to be selected.","pos":[1767,1911],"source":"Controls that implement <xref:System.Windows.Automation.Provider.ISelectionProvider> allow either single or multiple child items to be selected."},{"content":"For example, list box, list view, and tree view support multiple selections whereas combo box, slider, and radio button group support single selection.","pos":[1912,2063]},{"pos":[2073,2324],"content":"Controls that have a minimum, maximum, and continuous range, such as the <bpt id=\"p1\">**</bpt>Volume<ept id=\"p1\">**</ept> slider control, should implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IRangeValueProvider&gt;</ph> instead of <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.ISelectionProvider&gt;</ph>.","source":"Controls that have a minimum, maximum, and continuous range, such as the **Volume** slider control, should implement <xref:System.Windows.Automation.Provider.IRangeValueProvider> instead of <xref:System.Windows.Automation.Provider.ISelectionProvider>."},{"pos":[2334,2949],"content":"Single-selection controls that manage child controls that implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot&gt;</ph>, such as the <bpt id=\"p1\">**</bpt>Screen Resolution<ept id=\"p1\">**</ept> slider in the <bpt id=\"p2\">**</bpt>Display Properties<ept id=\"p2\">**</ept> dialog box or the <bpt id=\"p3\">**</bpt>Color Picker<ept id=\"p3\">**</ept> selection control from <ph id=\"ph2\">[!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)]</ph> (illustrated below), should implement <ph id=\"ph3\">&lt;xref:System.Windows.Automation.Provider.ISelectionProvider&gt;</ph>; their children should implement both <ph id=\"ph4\">&lt;xref:System.Windows.Automation.Provider.IRawElementProviderFragment&gt;</ph> and <ph id=\"ph5\">&lt;xref:System.Windows.Automation.Provider.ISelectionItemProvider&gt;</ph>.","source":"Single-selection controls that manage child controls that implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>, such as the **Screen Resolution** slider in the **Display Properties** dialog box or the **Color Picker** selection control from [!INCLUDE[TLA#tla_word](../../../includes/tlasharptla-word-md.md)] (illustrated below), should implement <xref:System.Windows.Automation.Provider.ISelectionProvider>; their children should implement both <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> and <xref:System.Windows.Automation.Provider.ISelectionItemProvider>."},{"content":"<bpt id=\"p1\">![</bpt>Color picker with yellow highlighted.<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../docs/framework/ui-automation/media/uia-valuepattern-colorpicker.png \"</bpt>UIA_ValuePattern_ColorPicker<ept id=\"p2\">\")</ept>","pos":[2956,3105],"source":"![Color picker with yellow highlighted.](../../../docs/framework/ui-automation/media/uia-valuepattern-colorpicker.png \"UIA_ValuePattern_ColorPicker\")"},{"content":"Example of Color Swatch String Mapping","pos":[3108,3146]},{"content":"Menus do not support <ph id=\"ph1\">&lt;xref:System.Windows.Automation.SelectionPattern&gt;</ph>.","pos":[3156,3227],"source":"Menus do not support <xref:System.Windows.Automation.SelectionPattern>."},{"content":"If you are working with menu items that include both graphics and text (such as the <bpt id=\"p1\">**</bpt>Preview Pane<ept id=\"p1\">**</ept> items in the <bpt id=\"p2\">**</bpt>View<ept id=\"p2\">**</ept> menu in <ph id=\"ph1\">[!INCLUDE[TLA#tla_outlook](../../../includes/tlasharptla-outlook-md.md)]</ph>) and need to convey state, you should implement <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.IToggleProvider&gt;</ph>.","pos":[3228,3538],"source":" If you are working with menu items that include both graphics and text (such as the **Preview Pane** items in the **View** menu in [!INCLUDE[TLA#tla_outlook](../../../includes/tlasharptla-outlook-md.md)]) and need to convey state, you should implement <xref:System.Windows.Automation.Provider.IToggleProvider>."},{"pos":[3605,3644],"content":"Required Members for ISelectionProvider","linkify":"Required Members for ISelectionProvider","nodes":[{"content":"Required Members for ISelectionProvider","pos":[0,39]}]},{"pos":[3648,3786],"content":"The following properties, methods, and events are required for the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ISelectionProvider&gt;</ph> interface.","source":"The following properties, methods, and events are required for the <xref:System.Windows.Automation.Provider.ISelectionProvider> interface."},{"content":"Required members","pos":[3793,3809]},{"content":"Type","pos":[3810,3814]},{"content":"Notes","pos":[3815,3820]},{"content":"Property","pos":[3957,3965]},{"pos":[3966,4194],"content":"Should support property changed events using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Automation.RemoveAutomationPropertyChangedEventHandler%2A&gt;</ph>.","source":"Should support property changed events using <xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A> and <xref:System.Windows.Automation.Automation.RemoveAutomationPropertyChangedEventHandler%2A>."},{"content":"Property","pos":[4283,4291]},{"pos":[4292,4520],"content":"Should support property changed events using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Automation.RemoveAutomationPropertyChangedEventHandler%2A&gt;</ph>.","source":"Should support property changed events using <xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A> and <xref:System.Windows.Automation.Automation.RemoveAutomationPropertyChangedEventHandler%2A>."},{"content":"Method","pos":[4602,4608]},{"content":"None","pos":[4609,4613]},{"content":"Event","pos":[4696,4701]},{"pos":[4702,4931],"content":"Raised when a selection in a container has changed significantly and requires sending more addition and removal events than the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.AutomationInteropProvider.InvalidateLimit&gt;</ph> constant permits.","source":"Raised when a selection in a container has changed significantly and requires sending more addition and removal events than the <xref:System.Windows.Automation.Provider.AutomationInteropProvider.InvalidateLimit> constant permits."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ISelectionProvider.IsSelectionRequired%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.ISelectionProvider.CanSelectMultiple%2A&gt;</ph> properties can be dynamic.","pos":[4939,5139],"source":"The <xref:System.Windows.Automation.Provider.ISelectionProvider.IsSelectionRequired%2A> and <xref:System.Windows.Automation.Provider.ISelectionProvider.CanSelectMultiple%2A> properties can be dynamic."},{"content":"For example, the initial state of a control might not have any items selected by default, indicating that <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ISelectionProvider.IsSelectionRequired%2A&gt;</ph> is <ph id=\"ph2\">`false`</ph>.","pos":[5140,5341],"source":" For example, the initial state of a control might not have any items selected by default, indicating that <xref:System.Windows.Automation.Provider.ISelectionProvider.IsSelectionRequired%2A> is `false`."},{"content":"However, after an item is selected, the control must always have at least one item selected.","pos":[5342,5434]},{"content":"Similarly, in rare cases, a control might allow multiple items to be selected on initialization, but subsequently allow only single selections to be made.","pos":[5435,5589]},{"pos":[5627,5637],"content":"Exceptions","linkify":"Exceptions","nodes":[{"content":"Exceptions","pos":[0,10]}]},{"content":"Providers must throw the following exceptions.","pos":[5641,5687]},{"content":"Exception Type","pos":[5694,5708]},{"content":"Condition","pos":[5709,5718]},{"content":"If the control is not enabled.","pos":[5824,5854]},{"content":"If the control is hidden.","pos":[5899,5924]},{"pos":[5934,5942],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5946,6069],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)</ept>","source":"[UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)"},{"pos":[6072,6221],"content":"<bpt id=\"p1\">[</bpt>Support Control Patterns in a UI Automation Provider<ept id=\"p1\">](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)</ept>","source":"[Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)"},{"pos":[6224,6353],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns for Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)</ept>","source":"[UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)"},{"pos":[6356,6521],"content":"<bpt id=\"p1\">[</bpt>Implementing the UI Automation SelectionItem Control Pattern<ept id=\"p1\">](../../../docs/framework/ui-automation/implementing-the-ui-automation-selectionitem-control-pattern.md)</ept>","source":"[Implementing the UI Automation SelectionItem Control Pattern](../../../docs/framework/ui-automation/implementing-the-ui-automation-selectionitem-control-pattern.md)"},{"pos":[6524,6623],"content":"<bpt id=\"p1\">[</bpt>UI Automation Tree Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</ept>","source":"[UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)"},{"pos":[6626,6727],"content":"<bpt id=\"p1\">[</bpt>Use Caching in UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)</ept>","source":"[Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)"}]}