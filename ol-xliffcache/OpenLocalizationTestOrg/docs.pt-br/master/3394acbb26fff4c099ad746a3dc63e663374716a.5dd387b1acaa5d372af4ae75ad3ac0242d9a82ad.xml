{"content":"---\ntitle: \"How to: Save Files Using the SaveFileDialog Component\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"saving files\"\n  - \"SaveFileDialog component [Windows Forms], saving files\"\n  - \"files [Windows Forms], saving\"\n  - \"OpenFile method [Windows Forms], saving files with SaveFileDialog component\"\nms.assetid: 02e8f409-b83f-4707-babb-e71f6b223d90\n---\n# How to: Save Files Using the SaveFileDialog Component\nThe <xref:System.Windows.Forms.SaveFileDialog> component allows users to browse the file system and select files to be saved. The dialog box returns the path and name of the file the user has selected in the dialog box. However, you must write the code to actually write the files to disk.  \n  \n### To save a file using the SaveFileDialog component  \n  \n-   Display the **Save File** dialog box and call a method to save the file selected by the user.  \n  \n     Use the <xref:System.Windows.Forms.SaveFileDialog> component's <xref:System.Windows.Forms.SaveFileDialog.OpenFile%2A> method to save the file. This method gives you a <xref:System.IO.Stream> object you can write to.  \n  \n     The example below uses the <xref:System.Windows.Forms.DialogResult> property to get the name of the file, and the <xref:System.Windows.Forms.OpenFileDialog.OpenFile%2A> method to save the file. The <xref:System.Windows.Forms.SaveFileDialog.OpenFile%2A> method gives you a stream to write the file to.  \n  \n     In the example below, there is a <xref:System.Windows.Forms.Button> control with an image assigned to it. When you click the button, a <xref:System.Windows.Forms.SaveFileDialog> component is instantiated with a filter that allows files of type .gif, .jpeg, and .bmp. If a file of this type is selected in the Save File dialog box, the button's image is saved.  \n  \n    > [!IMPORTANT]\n    >  To get or set the <xref:System.Windows.Forms.FileDialog.FileName%2A> property, your assembly requires a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType> class. If you are running in a partial-trust context, the process might throw an exception due to insufficient privileges. For more information, see [Code Access Security Basics](../../misc/code-access-security-basics.md).  \n  \n     The example assumes your form has a <xref:System.Windows.Forms.Button> control with its <xref:System.Windows.Forms.ButtonBase.Image%2A> property set to a file of type .gif, .jpeg, or .bmp.  \n  \n    > [!NOTE]\n    >  The <xref:System.Windows.Forms.FileDialog> class's <xref:System.Windows.Forms.FileDialog.FilterIndex%2A> property (which, due to inheritance, is part of the <xref:System.Windows.Forms.SaveFileDialog> class) uses a one-based index. This is important if you are writing code to save data in a specific format (for example, saving a file in plain text versus binary format). This property is featured in the example below.  \n  \n    ```vb  \n    Private Sub Button2_Click(ByVal sender As System.Object, _  \n    ByVal e As System.EventArgs) Handles Button2.Click  \n       ' Displays a SaveFileDialog so the user can save the Image  \n       ' assigned to Button2.  \n       Dim saveFileDialog1 As New SaveFileDialog()  \n       saveFileDialog1.Filter = \"JPeg Image|*.jpg|Bitmap Image|*.bmp|Gif Image|*.gif\"  \n       saveFileDialog1.Title = \"Save an Image File\"  \n       saveFileDialog1.ShowDialog()  \n  \n       ' If the file name is not an empty string open it for saving.  \n       If saveFileDialog1.FileName <> \"\" Then  \n          ' Saves the Image via a FileStream created by the OpenFile method.  \n          Dim fs As System.IO.FileStream = Ctype _  \n             (saveFileDialog1.OpenFile(), System.IO.FileStream)  \n          ' Saves the Image in the appropriate ImageFormat based upon the  \n          ' file type selected in the dialog box.  \n          ' NOTE that the FilterIndex property is one-based.  \n          Select Case saveFileDialog1.FilterIndex  \n             Case 1  \n                Me.button2.Image.Save(fs, _  \n                   System.Drawing.Imaging.ImageFormat.Jpeg)  \n  \n             Case 2  \n                Me.button2.Image.Save(fs, _  \n                   System.Drawing.Imaging.ImageFormat.Bmp)  \n  \n             Case 3  \n                Me.button2.Image.Save(fs, _  \n                   System.Drawing.Imaging.ImageFormat.Gif)  \n           End Select  \n  \n           fs.Close()  \n        End If  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    private void button2_Click(object sender, System.EventArgs e)  \n    {  \n       // Displays a SaveFileDialog so the user can save the Image  \n       // assigned to Button2.  \n       SaveFileDialog saveFileDialog1 = new SaveFileDialog();  \n       saveFileDialog1.Filter = \"JPeg Image|*.jpg|Bitmap Image|*.bmp|Gif Image|*.gif\";  \n       saveFileDialog1.Title = \"Save an Image File\";  \n       saveFileDialog1.ShowDialog();  \n  \n       // If the file name is not an empty string open it for saving.  \n       if(saveFileDialog1.FileName != \"\")  \n       {  \n          // Saves the Image via a FileStream created by the OpenFile method.  \n          System.IO.FileStream fs =   \n             (System.IO.FileStream)saveFileDialog1.OpenFile();  \n          // Saves the Image in the appropriate ImageFormat based upon the  \n          // File type selected in the dialog box.  \n          // NOTE that the FilterIndex property is one-based.  \n          switch(saveFileDialog1.FilterIndex)  \n          {  \n             case 1 :   \n             this.button2.Image.Save(fs,   \n                System.Drawing.Imaging.ImageFormat.Jpeg);  \n             break;  \n  \n             case 2 :   \n             this.button2.Image.Save(fs,   \n                System.Drawing.Imaging.ImageFormat.Bmp);  \n             break;  \n  \n             case 3 :   \n             this.button2.Image.Save(fs,   \n                System.Drawing.Imaging.ImageFormat.Gif);  \n             break;  \n          }  \n  \n       fs.Close();  \n       }  \n    }  \n    ```  \n  \n    ```cpp  \n    private:  \n       System::Void button2_Click(System::Object ^ sender,  \n          System::EventArgs ^ e)  \n       {  \n          // Displays a SaveFileDialog so the user can save the Image  \n          // assigned to Button2.  \n          SaveFileDialog ^ saveFileDialog1 = new SaveFileDialog();  \n          saveFileDialog1->Filter =   \n             \"JPeg Image|*.jpg|Bitmap Image|*.bmp|Gif Image|*.gif\";  \n          saveFileDialog1->Title = \"Save an Image File\";  \n          saveFileDialog1->ShowDialog();  \n          // If the file name is not an empty string, open it for saving.  \n          if(saveFileDialog1->FileName != \"\")  \n          {  \n             // Saves the Image through a FileStream created by  \n             // the OpenFile method.  \n             System::IO::FileStream ^ fs =   \n                safe_cast\\<System::IO::FileStream*>(  \n                saveFileDialog1->OpenFile());  \n             // Saves the Image in the appropriate ImageFormat based on  \n             // the file type selected in the dialog box.  \n             // Note that the FilterIndex property is one based.  \n             switch(saveFileDialog1->FilterIndex)  \n             {  \n                case 1 :  \n                   this->button2->Image->Save(fs,  \n                      System::Drawing::Imaging::ImageFormat::Jpeg);  \n                   break;  \n                case 2 :  \n                   this->button2->Image->Save(fs,   \n                      System::Drawing::Imaging::ImageFormat::Bmp);  \n                   break;  \n                case 3 :  \n                   this->button2->Image->Save(fs,   \n                      System::Drawing::Imaging::ImageFormat::Gif);  \n                   break;  \n             }  \n          fs->Close();  \n          }  \n       }  \n    ```  \n  \n     (Visual C# and [!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]) Place the following code in the form's constructor to register the event handler.  \n  \n    ```csharp  \n    this.button2.Click += new System.EventHandler(this.button2_Click);  \n    ```  \n  \n    ```cpp  \n    this->button2->Click += gcnew  \n       System::EventHandler(this, &Form1::button2_Click);  \n    ```  \n  \n     For more information about writing file streams, see <xref:System.IO.FileStream.BeginWrite%2A> and <xref:System.IO.FileStream.Write%2A>.  \n  \n    > [!NOTE]\n    >  Certain controls, such as the <xref:System.Windows.Forms.RichTextBox> control, have the ability to save files. For more information, see the \"SaveFileDialog Component\" section of the MSDN Online Library technical article, [Essential Code for Windows Forms Dialog Boxes](https://go.microsoft.com/fwlink/?LinkID=102575).  \n  \n## See also\n\n- <xref:System.Windows.Forms.SaveFileDialog>\n- [SaveFileDialog Component](savefiledialog-component-windows-forms.md)\n","nodes":[{"pos":[4,401],"embed":true,"restype":"x-metadata","content":"title: \"How to: Save Files Using the SaveFileDialog Component\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"saving files\"\n  - \"SaveFileDialog component [Windows Forms], saving files\"\n  - \"files [Windows Forms], saving\"\n  - \"OpenFile method [Windows Forms], saving files with SaveFileDialog component\"\nms.assetid: 02e8f409-b83f-4707-babb-e71f6b223d90","nodes":[{"content":"How to: Save Files Using the SaveFileDialog Component","nodes":[{"pos":[0,53],"content":"How to: Save Files Using the SaveFileDialog Component","nodes":[{"content":"How to: Save Files Using the SaveFileDialog Component","pos":[0,53]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[408,461],"content":"How to: Save Files Using the SaveFileDialog Component","linkify":"How to: Save Files Using the SaveFileDialog Component","nodes":[{"content":"How to: Save Files Using the SaveFileDialog Component","pos":[0,53]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SaveFileDialog&gt;</ph> component allows users to browse the file system and select files to be saved.","pos":[462,587],"source":"The <xref:System.Windows.Forms.SaveFileDialog> component allows users to browse the file system and select files to be saved."},{"content":"The dialog box returns the path and name of the file the user has selected in the dialog box.","pos":[588,681]},{"content":"However, you must write the code to actually write the files to disk.","pos":[682,751]},{"pos":[761,810],"content":"To save a file using the SaveFileDialog component","linkify":"To save a file using the SaveFileDialog component","nodes":[{"content":"To save a file using the SaveFileDialog component","pos":[0,49]}]},{"pos":[820,913],"content":"Display the <bpt id=\"p1\">**</bpt>Save File<ept id=\"p1\">**</ept> dialog box and call a method to save the file selected by the user.","source":"Display the **Save File** dialog box and call a method to save the file selected by the user."},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SaveFileDialog&gt;</ph> component's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.SaveFileDialog.OpenFile%2A&gt;</ph> method to save the file.","pos":[924,1066],"source":"Use the <xref:System.Windows.Forms.SaveFileDialog> component's <xref:System.Windows.Forms.SaveFileDialog.OpenFile%2A> method to save the file."},{"content":"This method gives you a <ph id=\"ph1\">&lt;xref:System.IO.Stream&gt;</ph> object you can write to.","pos":[1067,1139],"source":" This method gives you a <xref:System.IO.Stream> object you can write to."},{"content":"The example below uses the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.DialogResult&gt;</ph> property to get the name of the file, and the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.OpenFileDialog.OpenFile%2A&gt;</ph> method to save the file.","pos":[1150,1343],"source":"The example below uses the <xref:System.Windows.Forms.DialogResult> property to get the name of the file, and the <xref:System.Windows.Forms.OpenFileDialog.OpenFile%2A> method to save the file."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SaveFileDialog.OpenFile%2A&gt;</ph> method gives you a stream to write the file to.","pos":[1344,1450],"source":" The <xref:System.Windows.Forms.SaveFileDialog.OpenFile%2A> method gives you a stream to write the file to."},{"content":"In the example below, there is a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> control with an image assigned to it.","pos":[1461,1566],"source":"In the example below, there is a <xref:System.Windows.Forms.Button> control with an image assigned to it."},{"content":"When you click the button, a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.SaveFileDialog&gt;</ph> component is instantiated with a filter that allows files of type .gif, .jpeg, and .bmp.","pos":[1567,1727],"source":" When you click the button, a <xref:System.Windows.Forms.SaveFileDialog> component is instantiated with a filter that allows files of type .gif, .jpeg, and .bmp."},{"content":"If a file of this type is selected in the Save File dialog box, the button's image is saved.","pos":[1728,1820]},{"pos":[1832,2290],"content":"[!IMPORTANT]\nTo get or set the <xref:System.Windows.Forms.FileDialog.FileName%2A> property, your assembly requires a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType> class. If you are running in a partial-trust context, the process might throw an exception due to insufficient privileges. For more information, see [Code Access Security Basics](../../misc/code-access-security-basics.md).","leadings":["","    >  "],"nodes":[{"content":"To get or set the <xref:System.Windows.Forms.FileDialog.FileName%2A> property, your assembly requires a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType> class. If you are running in a partial-trust context, the process might throw an exception due to insufficient privileges. For more information, see [Code Access Security Basics](../../misc/code-access-security-basics.md).","pos":[13,451],"nodes":[{"content":"To get or set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.FileDialog.FileName%2A&gt;</ph> property, your assembly requires a privilege level granted by the <ph id=\"ph2\">&lt;xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType&gt;</ph> class.","pos":[0,222],"source":"To get or set the <xref:System.Windows.Forms.FileDialog.FileName%2A> property, your assembly requires a privilege level granted by the <xref:System.Security.Permissions.FileIOPermission?displayProperty=nameWithType> class."},{"content":"If you are running in a partial-trust context, the process might throw an exception due to insufficient privileges.","pos":[223,338]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Access Security Basics<ept id=\"p1\">](../../misc/code-access-security-basics.md)</ept>.","pos":[339,438],"source":" For more information, see [Code Access Security Basics](../../misc/code-access-security-basics.md)."}]}]},{"pos":[2301,2489],"content":"The example assumes your form has a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> control with its <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ButtonBase.Image%2A&gt;</ph> property set to a file of type .gif, .jpeg, or .bmp.","source":"The example assumes your form has a <xref:System.Windows.Forms.Button> control with its <xref:System.Windows.Forms.ButtonBase.Image%2A> property set to a file of type .gif, .jpeg, or .bmp."},{"pos":[2501,2935],"content":"[!NOTE]\nThe <xref:System.Windows.Forms.FileDialog> class's <xref:System.Windows.Forms.FileDialog.FilterIndex%2A> property (which, due to inheritance, is part of the <xref:System.Windows.Forms.SaveFileDialog> class) uses a one-based index. This is important if you are writing code to save data in a specific format (for example, saving a file in plain text versus binary format). This property is featured in the example below.","leadings":["","    >  "],"nodes":[{"content":"The <xref:System.Windows.Forms.FileDialog> class's <xref:System.Windows.Forms.FileDialog.FilterIndex%2A> property (which, due to inheritance, is part of the <xref:System.Windows.Forms.SaveFileDialog> class) uses a one-based index. This is important if you are writing code to save data in a specific format (for example, saving a file in plain text versus binary format). This property is featured in the example below.","pos":[8,427],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.FileDialog&gt;</ph> class's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.FileDialog.FilterIndex%2A&gt;</ph> property (which, due to inheritance, is part of the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.SaveFileDialog&gt;</ph> class) uses a one-based index.","pos":[0,230],"source":"The <xref:System.Windows.Forms.FileDialog> class's <xref:System.Windows.Forms.FileDialog.FilterIndex%2A> property (which, due to inheritance, is part of the <xref:System.Windows.Forms.SaveFileDialog> class) uses a one-based index."},{"content":"This is important if you are writing code to save data in a specific format (for example, saving a file in plain text versus binary format).","pos":[231,371]},{"content":"This property is featured in the example below.","pos":[372,419]}]}]},{"pos":[7799,7950],"content":"(Visual C# and <ph id=\"ph1\">[!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]</ph>) Place the following code in the form's constructor to register the event handler.","source":"(Visual C# and [!INCLUDE[vcprvc](../../../../includes/vcprvc-md.md)]) Place the following code in the form's constructor to register the event handler."},{"pos":[8185,8321],"content":"For more information about writing file streams, see <ph id=\"ph1\">&lt;xref:System.IO.FileStream.BeginWrite%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.IO.FileStream.Write%2A&gt;</ph>.","source":"For more information about writing file streams, see <xref:System.IO.FileStream.BeginWrite%2A> and <xref:System.IO.FileStream.Write%2A>."},{"pos":[8333,8666],"content":"[!NOTE]\nCertain controls, such as the <xref:System.Windows.Forms.RichTextBox> control, have the ability to save files. For more information, see the \"SaveFileDialog Component\" section of the MSDN Online Library technical article, [Essential Code for Windows Forms Dialog Boxes](https://go.microsoft.com/fwlink/?LinkID=102575).","leadings":["","    >  "],"nodes":[{"content":"Certain controls, such as the <xref:System.Windows.Forms.RichTextBox> control, have the ability to save files. For more information, see the \"SaveFileDialog Component\" section of the MSDN Online Library technical article, [Essential Code for Windows Forms Dialog Boxes](https://go.microsoft.com/fwlink/?LinkID=102575).","pos":[8,326],"nodes":[{"content":"Certain controls, such as the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.RichTextBox&gt;</ph> control, have the ability to save files.","pos":[0,110],"source":"Certain controls, such as the <xref:System.Windows.Forms.RichTextBox> control, have the ability to save files."},{"content":"For more information, see the \"SaveFileDialog Component\" section of the MSDN Online Library technical article, <bpt id=\"p1\">[</bpt>Essential Code for Windows Forms Dialog Boxes<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=102575)</ept>.","pos":[111,318],"source":" For more information, see the \"SaveFileDialog Component\" section of the MSDN Online Library technical article, [Essential Code for Windows Forms Dialog Boxes](https://go.microsoft.com/fwlink/?LinkID=102575)."}]}]},{"pos":[8675,8683],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8732,8801],"content":"<bpt id=\"p1\">[</bpt>SaveFileDialog Component<ept id=\"p1\">](savefiledialog-component-windows-forms.md)</ept>","source":"[SaveFileDialog Component](savefiledialog-component-windows-forms.md)"}]}