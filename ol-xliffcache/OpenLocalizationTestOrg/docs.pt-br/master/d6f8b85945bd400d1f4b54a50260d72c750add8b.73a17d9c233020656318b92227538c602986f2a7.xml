{"content":"---\ntitle: \"How to: Write an Extension Method (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"extending data types [Visual Basic]\"\n  - \"writing extension methods [Visual Basic]\"\n  - \"extension methods [Visual Basic]\"\nms.assetid: fb2739cc-958d-4ef4-a38b-214a74c93413\n---\n# How to: Write an Extension Method (Visual Basic)\nExtension methods enable you to add methods to an existing class. The extension method can be called as if it were an instance of that class.  \n  \n### To define an extension method  \n  \n1.  Open a new or existing Visual Basic application in Visual Studio.  \n  \n2.  At the top of the file in which you want to define an extension method, include the following import statement:  \n  \n    ```  \n    Imports System.Runtime.CompilerServices  \n    ```  \n  \n3.  Within a module in your new or existing application, begin the method definition with the extension attribute:  \n  \n    ```  \n    <Extension()>  \n    ```  \n  \n4.  Declare your method in the ordinary way, except that the type of the first parameter must be the data type you want to extend.  \n  \n    ```  \n    <Extension()>   \n    Public Sub subName (ByVal para1 As ExtendedType, <other parameters>)  \n         ' < Body of the method >  \n    End Sub  \n    ```  \n  \n## Example  \n The following example declares an extension method in module `StringExtensions`. A second module, `Module1`, imports `StringExtensions` and calls the method. The extension method must be in scope when it is called. Extension method `PrintAndPunctuate` extends the <xref:System.String> class with a method that displays the string instance followed by a string of punctuation symbols sent in as a parameter.  \n  \n```vb  \n' Declarations will typically be in a separate module.  \nImports System.Runtime.CompilerServices  \n  \nModule StringExtensions  \n    <Extension()>   \n    Public Sub PrintAndPunctuate(ByVal aString As String,   \n                                 ByVal punc As String)  \n        Console.WriteLine(aString & punc)  \n    End Sub  \n  \nEnd Module  \n```  \n  \n```vb  \n' Import the module that holds the extension method you want to use,   \n' and call it.  \n  \nImports ConsoleApplication2.StringExtensions  \n  \nModule Module1  \n  \n    Sub Main()  \n        Dim example = \"Hello\"  \n        example.PrintAndPunctuate(\"?\")  \n        example.PrintAndPunctuate(\"!!!!\")  \n    End Sub  \n  \nEnd Module  \n```  \n  \n Notice that the method is defined with two parameters and called with only one. The first parameter, `aString`, in the method definition is bound to `example`, the instance of `String` that calls the method. The output of the example is as follows:  \n  \n `Hello?`  \n  \n `Hello!!!!`  \n  \n## See also\n\n- <xref:System.Runtime.CompilerServices.ExtensionAttribute>\n- [Extension Methods](./extension-methods.md)\n- [Module Statement](../../../../visual-basic/language-reference/statements/module-statement.md)\n- [Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)\n- [Scope in Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)\n","nodes":[{"pos":[4,280],"embed":true,"restype":"x-metadata","content":"title: \"How to: Write an Extension Method (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"extending data types [Visual Basic]\"\n  - \"writing extension methods [Visual Basic]\"\n  - \"extension methods [Visual Basic]\"\nms.assetid: fb2739cc-958d-4ef4-a38b-214a74c93413","nodes":[{"content":"How to: Write an Extension Method (Visual Basic)","nodes":[{"pos":[0,48],"content":"How to: Write an Extension Method (Visual Basic)","nodes":[{"content":"How to: Write an Extension Method (Visual Basic)","pos":[0,48]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[287,335],"content":"How to: Write an Extension Method (Visual Basic)","linkify":"How to: Write an Extension Method (Visual Basic)","nodes":[{"content":"How to: Write an Extension Method (Visual Basic)","pos":[0,48]}]},{"content":"Extension methods enable you to add methods to an existing class.","pos":[336,401]},{"content":"The extension method can be called as if it were an instance of that class.","pos":[402,477]},{"pos":[487,516],"content":"To define an extension method","linkify":"To define an extension method","nodes":[{"content":"To define an extension method","pos":[0,29]}]},{"content":"Open a new or existing Visual Basic application in Visual Studio.","pos":[526,591]},{"content":"At the top of the file in which you want to define an extension method, include the following import statement:","pos":[601,712]},{"content":"Within a module in your new or existing application, begin the method definition with the extension attribute:","pos":[791,901]},{"content":"Declare your method in the ordinary way, except that the type of the first parameter must be the data type you want to extend.","pos":[954,1080]},{"pos":[1258,1265],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example declares an extension method in module <ph id=\"ph1\">`StringExtensions`</ph>.","pos":[1269,1349],"source":"The following example declares an extension method in module `StringExtensions`."},{"content":"A second module, <ph id=\"ph1\">`Module1`</ph>, imports <ph id=\"ph2\">`StringExtensions`</ph> and calls the method.","pos":[1350,1426],"source":" A second module, `Module1`, imports `StringExtensions` and calls the method."},{"content":"The extension method must be in scope when it is called.","pos":[1427,1483]},{"content":"Extension method <ph id=\"ph1\">`PrintAndPunctuate`</ph> extends the <ph id=\"ph2\">&lt;xref:System.String&gt;</ph> class with a method that displays the string instance followed by a string of punctuation symbols sent in as a parameter.","pos":[1484,1675],"source":" Extension method `PrintAndPunctuate` extends the <xref:System.String> class with a method that displays the string instance followed by a string of punctuation symbols sent in as a parameter."},{"content":"Notice that the method is defined with two parameters and called with only one.","pos":[2383,2462]},{"content":"The first parameter, <ph id=\"ph1\">`aString`</ph>, in the method definition is bound to <ph id=\"ph2\">`example`</ph>, the instance of <ph id=\"ph3\">`String`</ph> that calls the method.","pos":[2463,2590],"source":" The first parameter, `aString`, in the method definition is bound to `example`, the instance of `String` that calls the method."},{"content":"The output of the example is as follows:","pos":[2591,2631]},{"pos":[2673,2681],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2745,2788],"content":"<bpt id=\"p1\">[</bpt>Extension Methods<ept id=\"p1\">](./extension-methods.md)</ept>","source":"[Extension Methods](./extension-methods.md)"},{"pos":[2791,2885],"content":"<bpt id=\"p1\">[</bpt>Module Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/module-statement.md)</ept>","source":"[Module Statement](../../../../visual-basic/language-reference/statements/module-statement.md)"},{"pos":[2888,2965],"content":"<bpt id=\"p1\">[</bpt>Procedure Parameters and Arguments<ept id=\"p1\">](./procedure-parameters-and-arguments.md)</ept>","source":"[Procedure Parameters and Arguments](./procedure-parameters-and-arguments.md)"},{"pos":[2968,3080],"content":"<bpt id=\"p1\">[</bpt>Scope in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)</ept>","source":"[Scope in Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)"}]}