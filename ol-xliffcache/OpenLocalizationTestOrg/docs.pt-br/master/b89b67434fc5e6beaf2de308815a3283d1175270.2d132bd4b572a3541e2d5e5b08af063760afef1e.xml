{"content":"---\ntitle: \"invalidIUnknown MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"MDAs (managed debugging assistants), invalid IUnknown pointer\"\n  - \"InvalidIUnknown MDA\"\n  - \"invalid IUnknown pointers\"\n  - \"IUnknown pointers\"\n  - \"managed debugging assistants (MDAs), invalid IUnknown pointer\"\nms.assetid: c7924771-a16b-40fe-b337-ce51dcdf6a12\ncaps.latest.revision: 13\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# invalidIUnknown MDA\nThe `invalidIUnknown` managed debugging assistant (MDA) is activated when an invalid `IUnknown` pointer is passed to managed code from native code. The `IUnknown` fails to return success when queried for the `IUnknown` interface.  \n  \n## Symptoms  \n An unexpected error occurs when marshaling a COM interface pointer during argument marshaling.  \n  \n## Cause  \n An incorrect `QueryInterface` implementation on the COM interface passed to the CLR.  \n  \n## Resolution  \n Correct the `QueryInterface` implementation.  \n  \n## Effect on the Runtime  \n This MDA has no effect on the CLR.  \n  \n## Output  \n The description of the error.  \n  \n## Configuration  \n  \n```  \n<mdaConfig>  \n  <assistants>  \n    <invalidIUnknown />  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## See Also  \n <xref:System.Runtime.InteropServices.MarshalAsAttribute>   \n [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)   \n [Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)","nodes":[{"pos":[4,639],"embed":true,"restype":"x-metadata","content":"title: \"invalidIUnknown MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"MDAs (managed debugging assistants), invalid IUnknown pointer\"\n  - \"InvalidIUnknown MDA\"\n  - \"invalid IUnknown pointers\"\n  - \"IUnknown pointers\"\n  - \"managed debugging assistants (MDAs), invalid IUnknown pointer\"\nms.assetid: c7924771-a16b-40fe-b337-ce51dcdf6a12\ncaps.latest.revision: 13\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"","nodes":[{"content":"invalidIUnknown MDA | Microsoft Docs","nodes":[{"pos":[0,36],"content":"invalidIUnknown MDA | Microsoft Docs","nodes":[{"content":"invalidIUnknown MDA | Microsoft Docs","pos":[0,36]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[646,665],"content":"invalidIUnknown MDA","linkify":"invalidIUnknown MDA","nodes":[{"content":"invalidIUnknown MDA","pos":[0,19]}]},{"content":"The <ph id=\"ph1\">`invalidIUnknown`</ph> managed debugging assistant (MDA) is activated when an invalid <ph id=\"ph2\">`IUnknown`</ph> pointer is passed to managed code from native code.","pos":[666,813],"source":"The `invalidIUnknown` managed debugging assistant (MDA) is activated when an invalid `IUnknown` pointer is passed to managed code from native code."},{"content":"The <ph id=\"ph1\">`IUnknown`</ph> fails to return success when queried for the <ph id=\"ph2\">`IUnknown`</ph> interface.","pos":[814,895],"source":" The `IUnknown` fails to return success when queried for the `IUnknown` interface."},{"pos":[904,912],"content":"Symptoms","linkify":"Symptoms","nodes":[{"content":"Symptoms","pos":[0,8]}]},{"content":"An unexpected error occurs when marshaling a COM interface pointer during argument marshaling.","pos":[916,1010]},{"pos":[1019,1024],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"pos":[1028,1112],"content":"An incorrect <ph id=\"ph1\">`QueryInterface`</ph> implementation on the COM interface passed to the CLR.","source":"An incorrect `QueryInterface` implementation on the COM interface passed to the CLR."},{"pos":[1121,1131],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"pos":[1135,1179],"content":"Correct the <ph id=\"ph1\">`QueryInterface`</ph> implementation.","source":"Correct the `QueryInterface` implementation."},{"pos":[1188,1209],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"content":"This MDA has no effect on the CLR.","pos":[1213,1247]},{"pos":[1256,1262],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"The description of the error.","pos":[1266,1295]},{"pos":[1304,1317],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[1431,1439],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept><ph id=\"ph1\"> </ph>","pos":[1504,1658],"source":"[Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md) "},{"content":"<bpt id=\"p1\">[</bpt>Interop Marshaling<ept id=\"p1\">](../../../docs/framework/interop/interop-marshaling.md)</ept>","pos":[1662,1737],"source":"[Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)"}]}