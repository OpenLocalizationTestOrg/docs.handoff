{"content":"---\ntitle: \"How to: Find Subdirectories with a Specific Pattern in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"pattern matching\"\n  - \"folders, finding\"\nms.assetid: c9265fd1-7483-4150-8b7f-ff642caa939d\n---\n# How to: Find Subdirectories with a Specific Pattern in Visual Basic\nThe <xref:Microsoft.VisualBasic.FileIO.FileSystem.GetDirectories%2A> method returns a read-only collection of strings representing the path names for the subdirectories in a directory. You can use the `wildCards` parameter to specify a specific pattern. If you would like to include the contents of subdirectories in the search, set the `searchType` parameter to `SearchOption.SearchAllSubDirectories`.  \n  \n An empty collection is returned if no directories matching the specified pattern are found.  \n  \n### To find subdirectories with a specific pattern  \n  \n-   Use the `GetDirectories` method, supplying the name and path of the directory you want to search. The following example returns all the directories in the directory structure that contain the word \"Logs\" in their name, and adds them to `ListBox1`.  \n  \n     [!code-vb[VbVbcnFileAccess#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnFileAccess/VB/Class1.vb#1)]  \n  \n## Robust Programming  \n The following conditions may cause an exception:  \n  \n-   The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with \\\\\\\\.\\\\) (<xref:System.ArgumentException>).  \n  \n-   The path is not valid because it is `Nothing` (<xref:System.ArgumentNullException>).  \n  \n-   One or more of the specified wildcard characters is `Nothing`, an empty string, or contains only spaces (<xref:System.ArgumentNullException>).  \n  \n-   `directory` does not exist (<xref:System.IO.DirectoryNotFoundException>).  \n  \n-   `directory` points to an existing file (<xref:System.IO.IOException>).  \n  \n-   The path exceeds the system-defined maximum length (<xref:System.IO.PathTooLongException>).  \n  \n-   A file or folder name in the path contains a colon (:) or is in an invalid format (<xref:System.NotSupportedException>).  \n  \n-   The user lacks necessary permissions to view the path (<xref:System.Security.SecurityException>).  \n  \n-   The user lacks necessary permissions (<xref:System.UnauthorizedAccessException>).  \n  \n## See also\n\n- <xref:Microsoft.VisualBasic.FileIO.FileSystem.GetDirectories%2A>\n- [How to: Find Files with a Specific Pattern](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-find-files-with-a-specific-pattern.md)\n","nodes":[{"pos":[4,217],"embed":true,"restype":"x-metadata","content":"title: \"How to: Find Subdirectories with a Specific Pattern in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"pattern matching\"\n  - \"folders, finding\"\nms.assetid: c9265fd1-7483-4150-8b7f-ff642caa939d","nodes":[{"content":"How to: Find Subdirectories with a Specific Pattern in Visual Basic","nodes":[{"pos":[0,67],"content":"How to: Find Subdirectories with a Specific Pattern in Visual Basic","nodes":[{"content":"How to: Find Subdirectories with a Specific Pattern in Visual Basic","pos":[0,67]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[224,291],"content":"How to: Find Subdirectories with a Specific Pattern in Visual Basic","linkify":"How to: Find Subdirectories with a Specific Pattern in Visual Basic","nodes":[{"content":"How to: Find Subdirectories with a Specific Pattern in Visual Basic","pos":[0,67]}]},{"content":"The <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.FileIO.FileSystem.GetDirectories%2A&gt;</ph> method returns a read-only collection of strings representing the path names for the subdirectories in a directory.","pos":[292,476],"source":"The <xref:Microsoft.VisualBasic.FileIO.FileSystem.GetDirectories%2A> method returns a read-only collection of strings representing the path names for the subdirectories in a directory."},{"content":"You can use the <ph id=\"ph1\">`wildCards`</ph> parameter to specify a specific pattern.","pos":[477,545],"source":" You can use the `wildCards` parameter to specify a specific pattern."},{"content":"If you would like to include the contents of subdirectories in the search, set the <ph id=\"ph1\">`searchType`</ph> parameter to <ph id=\"ph2\">`SearchOption.SearchAllSubDirectories`</ph>.","pos":[546,694],"source":" If you would like to include the contents of subdirectories in the search, set the `searchType` parameter to `SearchOption.SearchAllSubDirectories`."},{"content":"An empty collection is returned if no directories matching the specified pattern are found.","pos":[701,792]},{"pos":[802,848],"content":"To find subdirectories with a specific pattern","linkify":"To find subdirectories with a specific pattern","nodes":[{"content":"To find subdirectories with a specific pattern","pos":[0,46]}]},{"content":"Use the <ph id=\"ph1\">`GetDirectories`</ph> method, supplying the name and path of the directory you want to search.","pos":[858,955],"source":"Use the `GetDirectories` method, supplying the name and path of the directory you want to search."},{"content":"The following example returns all the directories in the directory structure that contain the word \"Logs\" in their name, and adds them to <ph id=\"ph1\">`ListBox1`</ph>.","pos":[956,1105],"source":" The following example returns all the directories in the directory structure that contain the word \"Logs\" in their name, and adds them to `ListBox1`."},{"pos":[1240,1258],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"The following conditions may cause an exception:","pos":[1262,1310]},{"pos":[1320,1545],"content":"The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with <ph id=\"ph1\">\\\\</ph><ph id=\"ph2\">\\\\</ph>.<ph id=\"ph3\">\\\\</ph>) (<ph id=\"ph4\">&lt;xref:System.ArgumentException&gt;</ph>).","source":"The path is not valid for one of the following reasons: it is a zero-length string, it contains only white space, it contains invalid characters, or it is a device path (starts with \\\\\\\\.\\\\) (<xref:System.ArgumentException>)."},{"pos":[1555,1639],"content":"The path is not valid because it is <ph id=\"ph1\">`Nothing`</ph> (<ph id=\"ph2\">&lt;xref:System.ArgumentNullException&gt;</ph>).","source":"The path is not valid because it is `Nothing` (<xref:System.ArgumentNullException>)."},{"pos":[1649,1791],"content":"One or more of the specified wildcard characters is <ph id=\"ph1\">`Nothing`</ph>, an empty string, or contains only spaces (<ph id=\"ph2\">&lt;xref:System.ArgumentNullException&gt;</ph>).","source":"One or more of the specified wildcard characters is `Nothing`, an empty string, or contains only spaces (<xref:System.ArgumentNullException>)."},{"pos":[1801,1874],"content":"<ph id=\"ph1\">`directory`</ph> does not exist (<ph id=\"ph2\">&lt;xref:System.IO.DirectoryNotFoundException&gt;</ph>).","source":"`directory` does not exist (<xref:System.IO.DirectoryNotFoundException>)."},{"pos":[1884,1954],"content":"<ph id=\"ph1\">`directory`</ph> points to an existing file (<ph id=\"ph2\">&lt;xref:System.IO.IOException&gt;</ph>).","source":"`directory` points to an existing file (<xref:System.IO.IOException>)."},{"pos":[1964,2055],"content":"The path exceeds the system-defined maximum length (<ph id=\"ph1\">&lt;xref:System.IO.PathTooLongException&gt;</ph>).","source":"The path exceeds the system-defined maximum length (<xref:System.IO.PathTooLongException>)."},{"pos":[2065,2185],"content":"A file or folder name in the path contains a colon (:) or is in an invalid format (<ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph>).","source":"A file or folder name in the path contains a colon (:) or is in an invalid format (<xref:System.NotSupportedException>)."},{"pos":[2195,2292],"content":"The user lacks necessary permissions to view the path (<ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph>).","source":"The user lacks necessary permissions to view the path (<xref:System.Security.SecurityException>)."},{"pos":[2302,2383],"content":"The user lacks necessary permissions (<ph id=\"ph1\">&lt;xref:System.UnauthorizedAccessException&gt;</ph>).","source":"The user lacks necessary permissions (<xref:System.UnauthorizedAccessException>)."},{"pos":[2392,2400],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2471,2639],"content":"<bpt id=\"p1\">[</bpt>How to: Find Files with a Specific Pattern<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-find-files-with-a-specific-pattern.md)</ept>","source":"[How to: Find Files with a Specific Pattern](../../../../visual-basic/developing-apps/programming/drives-directories-files/how-to-find-files-with-a-specific-pattern.md)"}]}