{"content":"---\ntitle: \"Applying Interop Attributes | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"design-time attributes\"\n  - \".NET Framework, exposing components to COM\"\n  - \"attributes [.NET Framework], design-time functionality\"\n  - \"conversion-tool attributes\"\n  - \"attributes [.NET Framework], interop-specific\"\n  - \"attributes [.NET Framework], conversion-tool\"\n  - \"interoperation with unmanaged code, applying attributes\"\n  - \"interoperation with unmanaged code, exposing .NET Framework components\"\n  - \"COM interop, exposing COM components\"\n  - \"COM interop, applying attributes\"\nms.assetid: b6014613-641c-4912-9e2f-83a99210a037\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Applying Interop Attributes\nThe <xref:System.Runtime.InteropServices> namespace provides three categories of interop-specific attributes: those applied by you at design time, those applied by COM interop tools and APIs during the conversion process, and those applied either by you or COM interop.  \n  \n If you are unfamiliar with the task of applying attributes to managed code, see [Extending Metadata Using Attributes](../../../docs/standard/attributes/index.md). Like other custom attributes, you can apply interop-specific attributes to types, methods, properties, parameters, fields, and other members.  \n  \n## Design-Time Attributes  \n You can adjust the outcome of the conversion process performed by COM interop tools and APIs by using design-time attributes. The following table describes the attributes that you can apply to your managed source code. COM interop tools, on occasion, might also apply the attributes described in this table.  \n  \n|Attribute|Description|  \n|---------------|-----------------|  \n|<xref:System.Runtime.InteropServices.AutomationProxyAttribute>|Specifies whether the type should be marshaled using the Automation marshaler or a custom proxy and stub.|  \n|<xref:System.Runtime.InteropServices.ClassInterfaceAttribute>|Controls the type of interface generated for a class.|  \n|<xref:System.Runtime.InteropServices.CoClassAttribute>|Identifies the CLSID of the original coclass imported from a type library.<br /><br /> COM interop tools typically apply this attribute.|  \n|<xref:System.Runtime.InteropServices.ComImportAttribute>|Indicates that a coclass or interface definition was imported from a COM type library. The runtime uses this flag to know how to activate and marshal the type. This attribute prohibits the type from being exported back to a type library.<br /><br /> COM interop tools typically apply this attribute.|  \n|<xref:System.Runtime.InteropServices.ComRegisterFunctionAttribute>|Indicates that a method should be called when the assembly is registered for use from COM, so that user-written code can be executed during the registration process.|  \n|<xref:System.Runtime.InteropServices.ComSourceInterfacesAttribute>|Identifies interfaces that are sources of events for the class.<br /><br /> COM interop tools can apply this attribute.|  \n|<xref:System.Runtime.InteropServices.ComUnregisterFunctionAttribute>|Indicates that a method should be called when the assembly is unregistered from COM, so that user-written code can execute during the process.|  \n|<xref:System.Runtime.InteropServices.ComVisibleAttribute>|Renders types invisible to COM when the attribute value equals **false**. This attribute can be applied to an individual type or to an entire assembly to control COM visibility. By default, all managed, public types are visible; the attribute is not needed to make them visible.|  \n|<xref:System.Runtime.InteropServices.DispIdAttribute>|Specifies the COM dispatch identifier (DISPID) of a method or field. This attribute contains the DISPID for the method, field, or property it describes.<br /><br /> COM interop tools can apply this attribute.|  \n|<xref:System.Runtime.InteropServices.FieldOffsetAttribute>|Indicates the physical position of each field within a class when used with the **StructLayoutAttribute**, and the **LayoutKind** is set to Explicit.|  \n|<xref:System.Runtime.InteropServices.GuidAttribute>|Specifies the globally unique identifier (GUID) of a class, interface, or an entire type library. The string passed to the attribute must be a format that is an acceptable constructor argument for the type **System.Guid**.<br /><br /> COM interop tools can apply this attribute.|  \n|<xref:System.Runtime.InteropServices.IDispatchImplAttribute>|Indicates which **IDispatch** interface implementation the common language runtime uses when exposing dual interfaces and dispinterfaces to COM.|  \n|<xref:System.Runtime.InteropServices.InAttribute>|Indicates that data should be marshaled in to the caller. Can be used to attribute parameters.|  \n|<xref:System.Runtime.InteropServices.InterfaceTypeAttribute>|Controls how a managed interface is exposed to COM clients (Dual, IUnknown-derived, or IDispatch only).<br /><br /> COM interop tools can apply this attribute.|  \n|<xref:System.Runtime.InteropServices.LCIDConversionAttribute>|Indicates that an unmanaged method signature expects an LCID parameter.<br /><br /> COM interop tools can apply this attribute.|  \n|<xref:System.Runtime.InteropServices.MarshalAsAttribute>|Indicates how the data in fields or parameters should be marshaled between managed and unmanaged code. The attribute is always optional because each data type has default marshaling behavior.<br /><br /> COM interop tools can apply this attribute.|  \n|<xref:System.Runtime.InteropServices.OptionalAttribute>|Indicates that a parameter is optional.<br /><br /> COM interop tools can apply this attribute.|  \n|<xref:System.Runtime.InteropServices.OutAttribute>|Indicates that the data in a field or parameter must be marshaled from a called object back to its caller.|  \n|<xref:System.Runtime.InteropServices.PreserveSigAttribute>|Suppresses the HRESULT or retval signature transformation that normally takes place during interoperation calls. The attribute affects marshaling as well as type library exporting.<br /><br /> COM interop tools can apply this attribute.|  \n|<xref:System.Runtime.InteropServices.ProgIdAttribute>|Specifies the ProgID of a .NET Framework class. Can be used to attribute classes.|  \n|<xref:System.Runtime.InteropServices.StructLayoutAttribute>|Controls the physical layout of the fields of a class.<br /><br /> COM interop tools can apply this attribute.|  \n  \n## Conversion-Tool Attributes  \n The following table describes attributes that COM interop tools apply during the conversion process. You do not apply these attributes at design time.  \n  \n|Attribute|Description|  \n|---------------|-----------------|  \n|<xref:System.Runtime.InteropServices.ComAliasNameAttribute>|Indicates the COM alias for a parameter or field type. Can be used to attribute parameters, fields, or return values.|  \n|<xref:System.Runtime.InteropServices.ComConversionLossAttribute>|Indicates that information about a class or interface was lost when it was imported from a type library to an assembly.|  \n|<xref:System.Runtime.InteropServices.ComEventInterfaceAttribute>|Identifies the source interface and the class that implements the methods of the event interface.|  \n|<xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>|Indicates that the assembly was originally imported from a COM type library. This attribute contains the type library definition of the original type library.|  \n|<xref:System.Runtime.InteropServices.TypeLibFuncAttribute>|Contains the **FUNCFLAGS** that were originally imported for this function from the COM type library.|  \n|<xref:System.Runtime.InteropServices.TypeLibTypeAttribute>|Contains the **TYPEFLAGS** that were originally imported for this type from the COM type library.|  \n|<xref:System.Runtime.InteropServices.TypeLibVarAttribute>|Contains the **VARFLAGS** that were originally imported for this variable from the COM type library.|  \n  \n## See Also  \n <xref:System.Runtime.InteropServices>   \n [Exposing .NET Framework Components to COM](../../../docs/framework/interop/exposing-dotnet-components-to-com.md)   \n [Attributes](../../../docs/standard/attributes/index.md)   \n [Qualifying .NET Types for Interoperation](../../../docs/framework/interop/qualifying-net-types-for-interoperation.md)   \n [Packaging an Assembly for COM](../../../docs/framework/interop/packaging-an-assembly-for-com.md)","nodes":[{"pos":[4,928],"nodes":[{"content":"Applying Interop Attributes | Microsoft Docs","nodes":[{"pos":[0,44],"content":"Applying Interop Attributes | Microsoft Docs","nodes":[{"content":"Applying Interop Attributes | Microsoft Docs","pos":[0,44]}]}],"pos":[6,53],"yaml":true}],"content":"title: \"Applying Interop Attributes | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"design-time attributes\"\n  - \".NET Framework, exposing components to COM\"\n  - \"attributes [.NET Framework], design-time functionality\"\n  - \"conversion-tool attributes\"\n  - \"attributes [.NET Framework], interop-specific\"\n  - \"attributes [.NET Framework], conversion-tool\"\n  - \"interoperation with unmanaged code, applying attributes\"\n  - \"interoperation with unmanaged code, exposing .NET Framework components\"\n  - \"COM interop, exposing COM components\"\n  - \"COM interop, applying attributes\"\nms.assetid: b6014613-641c-4912-9e2f-83a99210a037\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","yamlblock":true},{"pos":[935,962],"content":"Applying Interop Attributes","linkify":"Applying Interop Attributes","nodes":[{"content":"Applying Interop Attributes","pos":[0,27]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices&gt;</ph> namespace provides three categories of interop-specific attributes: those applied by you at design time, those applied by COM interop tools and APIs during the conversion process, and those applied either by you or COM interop.","pos":[963,1232],"source":"The <xref:System.Runtime.InteropServices> namespace provides three categories of interop-specific attributes: those applied by you at design time, those applied by COM interop tools and APIs during the conversion process, and those applied either by you or COM interop."},{"content":"If you are unfamiliar with the task of applying attributes to managed code, see <bpt id=\"p1\">[</bpt>Extending Metadata Using Attributes<ept id=\"p1\">](../../../docs/standard/attributes/index.md)</ept>.","pos":[1239,1401],"source":"If you are unfamiliar with the task of applying attributes to managed code, see [Extending Metadata Using Attributes](../../../docs/standard/attributes/index.md)."},{"content":"Like other custom attributes, you can apply interop-specific attributes to types, methods, properties, parameters, fields, and other members.","pos":[1402,1543]},{"pos":[1552,1574],"content":"Design-Time Attributes","linkify":"Design-Time Attributes","nodes":[{"content":"Design-Time Attributes","pos":[0,22]}]},{"content":"You can adjust the outcome of the conversion process performed by COM interop tools and APIs by using design-time attributes.","pos":[1578,1703]},{"content":"The following table describes the attributes that you can apply to your managed source code.","pos":[1704,1796]},{"content":"COM interop tools, on occasion, might also apply the attributes described in this table.","pos":[1797,1885]},{"content":"Attribute","pos":[1892,1901]},{"content":"Description","pos":[1902,1913]},{"content":"Specifies whether the type should be marshaled using the Automation marshaler or a custom proxy and stub.","pos":[2019,2124]},{"content":"Controls the type of interface generated for a class.","pos":[2191,2244]},{"content":"Identifies the CLSID of the original coclass imported from a type library.","pos":[2304,2378]},{"content":"COM interop tools typically apply this attribute.","pos":[2391,2440]},{"content":"Indicates that a coclass or interface definition was imported from a COM type library.","pos":[2502,2588]},{"content":"The runtime uses this flag to know how to activate and marshal the type.","pos":[2589,2661]},{"content":"This attribute prohibits the type from being exported back to a type library.","pos":[2662,2739]},{"content":"COM interop tools typically apply this attribute.","pos":[2752,2801]},{"content":"Indicates that a method should be called when the assembly is registered for use from COM, so that user-written code can be executed during the registration process.","pos":[2873,3038]},{"content":"Identifies interfaces that are sources of events for the class.","pos":[3110,3173]},{"content":"COM interop tools can apply this attribute.","pos":[3186,3229]},{"content":"Indicates that a method should be called when the assembly is unregistered from COM, so that user-written code can execute during the process.","pos":[3303,3445]},{"content":"Renders types invisible to COM when the attribute value equals <bpt id=\"p1\">**</bpt>false<ept id=\"p1\">**</ept>.","pos":[3508,3581],"source":"Renders types invisible to COM when the attribute value equals **false**."},{"content":"This attribute can be applied to an individual type or to an entire assembly to control COM visibility.","pos":[3582,3685]},{"content":"By default, all managed, public types are visible; the attribute is not needed to make them visible.","pos":[3686,3786]},{"content":"Specifies the COM dispatch identifier (DISPID) of a method or field.","pos":[3845,3913]},{"content":"This attribute contains the DISPID for the method, field, or property it describes.","pos":[3914,3997]},{"content":"COM interop tools can apply this attribute.","pos":[4010,4053]},{"pos":[4117,4266],"content":"Indicates the physical position of each field within a class when used with the <bpt id=\"p1\">**</bpt>StructLayoutAttribute<ept id=\"p1\">**</ept>, and the <bpt id=\"p2\">**</bpt>LayoutKind<ept id=\"p2\">**</ept> is set to Explicit.","source":"Indicates the physical position of each field within a class when used with the **StructLayoutAttribute**, and the **LayoutKind** is set to Explicit."},{"content":"Specifies the globally unique identifier (GUID) of a class, interface, or an entire type library.","pos":[4323,4420]},{"content":"The string passed to the attribute must be a format that is an acceptable constructor argument for the type <bpt id=\"p1\">**</bpt>System.Guid<ept id=\"p1\">**</ept>.","pos":[4421,4545],"source":" The string passed to the attribute must be a format that is an acceptable constructor argument for the type **System.Guid**."},{"content":"COM interop tools can apply this attribute.","pos":[4558,4601]},{"pos":[4667,4811],"content":"Indicates which <bpt id=\"p1\">**</bpt>IDispatch<ept id=\"p1\">**</ept> interface implementation the common language runtime uses when exposing dual interfaces and dispinterfaces to COM.","source":"Indicates which **IDispatch** interface implementation the common language runtime uses when exposing dual interfaces and dispinterfaces to COM."},{"content":"Indicates that data should be marshaled in to the caller.","pos":[4866,4923]},{"content":"Can be used to attribute parameters.","pos":[4924,4960]},{"content":"Controls how a managed interface is exposed to COM clients (Dual, IUnknown-derived, or IDispatch only).","pos":[5026,5129]},{"content":"COM interop tools can apply this attribute.","pos":[5142,5185]},{"content":"Indicates that an unmanaged method signature expects an LCID parameter.","pos":[5252,5323]},{"content":"COM interop tools can apply this attribute.","pos":[5336,5379]},{"content":"Indicates how the data in fields or parameters should be marshaled between managed and unmanaged code.","pos":[5441,5543]},{"content":"The attribute is always optional because each data type has default marshaling behavior.","pos":[5544,5632]},{"content":"COM interop tools can apply this attribute.","pos":[5645,5688]},{"content":"Indicates that a parameter is optional.","pos":[5749,5788]},{"content":"COM interop tools can apply this attribute.","pos":[5801,5844]},{"content":"Indicates that the data in a field or parameter must be marshaled from a called object back to its caller.","pos":[5900,6006]},{"content":"Suppresses the HRESULT or retval signature transformation that normally takes place during interoperation calls.","pos":[6070,6182]},{"content":"The attribute affects marshaling as well as type library exporting.","pos":[6183,6250]},{"content":"COM interop tools can apply this attribute.","pos":[6263,6306]},{"content":"Specifies the ProgID of a .NET Framework class.","pos":[6365,6412]},{"content":"Can be used to attribute classes.","pos":[6413,6446]},{"content":"Controls the physical layout of the fields of a class.","pos":[6511,6565]},{"content":"COM interop tools can apply this attribute.","pos":[6578,6621]},{"pos":[6631,6657],"content":"Conversion-Tool Attributes","linkify":"Conversion-Tool Attributes","nodes":[{"content":"Conversion-Tool Attributes","pos":[0,26]}]},{"content":"The following table describes attributes that COM interop tools apply during the conversion process.","pos":[6661,6761]},{"content":"You do not apply these attributes at design time.","pos":[6762,6811]},{"content":"Attribute","pos":[6818,6827]},{"content":"Description","pos":[6828,6839]},{"content":"Indicates the COM alias for a parameter or field type.","pos":[6942,6996]},{"content":"Can be used to attribute parameters, fields, or return values.","pos":[6997,7059]},{"content":"Indicates that information about a class or interface was lost when it was imported from a type library to an assembly.","pos":[7129,7248]},{"content":"Identifies the source interface and the class that implements the methods of the event interface.","pos":[7318,7415]},{"content":"Indicates that the assembly was originally imported from a COM type library.","pos":[7487,7563]},{"content":"This attribute contains the type library definition of the original type library.","pos":[7564,7645]},{"pos":[7709,7810],"content":"Contains the <bpt id=\"p1\">**</bpt>FUNCFLAGS<ept id=\"p1\">**</ept> that were originally imported for this function from the COM type library.","source":"Contains the **FUNCFLAGS** that were originally imported for this function from the COM type library."},{"pos":[7874,7971],"content":"Contains the <bpt id=\"p1\">**</bpt>TYPEFLAGS<ept id=\"p1\">**</ept> that were originally imported for this type from the COM type library.","source":"Contains the **TYPEFLAGS** that were originally imported for this type from the COM type library."},{"pos":[8034,8134],"content":"Contains the <bpt id=\"p1\">**</bpt>VARFLAGS<ept id=\"p1\">**</ept> that were originally imported for this variable from the COM type library.","source":"Contains the **VARFLAGS** that were originally imported for this variable from the COM type library."},{"pos":[8144,8152],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices&gt;</ph>","pos":[8156,8193],"source":"<xref:System.Runtime.InteropServices> "},{"content":"<bpt id=\"p1\">[</bpt>Exposing .NET Framework Components to COM<ept id=\"p1\">](../../../docs/framework/interop/exposing-dotnet-components-to-com.md)</ept><ph id=\"ph1\"> </ph>","pos":[8198,8312],"source":"[Exposing .NET Framework Components to COM](../../../docs/framework/interop/exposing-dotnet-components-to-com.md) "},{"content":"<bpt id=\"p1\">[</bpt>Attributes<ept id=\"p1\">](../../../docs/standard/attributes/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[8316,8373],"source":"[Attributes](../../../docs/standard/attributes/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>Qualifying .NET Types for Interoperation<ept id=\"p1\">](../../../docs/framework/interop/qualifying-net-types-for-interoperation.md)</ept><ph id=\"ph1\"> </ph>","pos":[8377,8496],"source":"[Qualifying .NET Types for Interoperation](../../../docs/framework/interop/qualifying-net-types-for-interoperation.md) "},{"content":"<bpt id=\"p1\">[</bpt>Packaging an Assembly for COM<ept id=\"p1\">](../../../docs/framework/interop/packaging-an-assembly-for-com.md)</ept>","pos":[8500,8597],"source":"[Packaging an Assembly for COM](../../../docs/framework/interop/packaging-an-assembly-for-com.md)"}]}