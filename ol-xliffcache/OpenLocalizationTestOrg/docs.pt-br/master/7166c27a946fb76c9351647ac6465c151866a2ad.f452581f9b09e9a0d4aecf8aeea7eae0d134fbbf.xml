{"content":"---\ntitle: \"How to: Declare, Instantiate, and Use a Delegate - C# Programming Guide\"\nms.custom: seodec18\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"delegates [C#], declaring and instantiating\"\nms.assetid: 61c4895f-f785-48f8-8bfe-db73b411c4ae\n---\n# How to: Declare, Instantiate, and Use a Delegate (C# Programming Guide)\nIn C# 1.0 and later, delegates can be declared as shown in the following example.  \n  \n [!code-csharp[csProgGuideDelegates#13](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#13)]  \n  \n [!code-csharp[csProgGuideDelegates#14](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#14)]  \n  \n C# 2.0 provides a simpler way to write the previous declaration, as shown in the following example.  \n  \n [!code-csharp[csProgGuideDelegates#32](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#32)]  \n  \n In C# 2.0 and later, it is also possible to use an anonymous method to declare and initialize a [delegate](../../../csharp/language-reference/keywords/delegate.md), as shown in the following example.  \n  \n [!code-csharp[csProgGuideDelegates#15](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#15)]  \n  \n In C# 3.0 and later, delegates can also be declared and instantiated by using a lambda expression, as shown in the following example.  \n  \n [!code-csharp[csProgGuideDelegates#31](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#31)]  \n  \n For more information, see [Lambda Expressions](../../../csharp/programming-guide/statements-expressions-operators/lambda-expressions.md).  \n  \n The following example illustrates declaring, instantiating, and using a delegate. The `BookDB` class encapsulates a bookstore database that maintains a database of books. It exposes a method, `ProcessPaperbackBooks`, which finds all paperback books in the database and calls a delegate for each one. The `delegate` type that is used is named `ProcessBookDelegate`. The `Test` class uses this class to print the titles and average price of the paperback books.  \n  \n The use of delegates promotes good separation of functionality between the bookstore database and the client code. The client code has no knowledge of how the books are stored or how the bookstore code finds paperback books. The bookstore code has no knowledge of what processing is performed on the paperback books after it finds them.  \n  \n## Example  \n [!code-csharp[csProgGuideDelegates#12](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#12)]  \n  \n## Robust Programming  \n  \n-   Declaring a delegate.  \n  \n     The following statement declares a new delegate type.  \n  \n     [!code-csharp[csProgGuideDelegates#16](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#16)]  \n  \n     Each delegate type describes the number and types of the arguments, and the type of the return value of methods that it can encapsulate. Whenever a new set of argument types or return value type is needed, a new delegate type must be declared.  \n  \n-   Instantiating a delegate.  \n  \n     After a delegate type has been declared, a delegate object must be created and associated with a particular method. In the previous example, you do this by passing the `PrintTitle` method to the `ProcessPaperbackBooks` method as in the following example:  \n  \n     [!code-csharp[csProgGuideDelegates#17](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#17)]  \n  \n     This creates a new delegate object associated with the [static](../../../csharp/language-reference/keywords/static.md) method `Test.PrintTitle`. Similarly, the non-static method `AddBookToTotal` on the object `totaller` is passed as in the following example:  \n  \n     [!code-csharp[csProgGuideDelegates#18](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#18)]  \n  \n     In both cases a new delegate object is passed to the `ProcessPaperbackBooks` method.  \n  \n     After a delegate is created, the method it is associated with never changes; delegate objects are immutable.  \n  \n-   Calling a delegate.  \n  \n     After a delegate object is created, the delegate object is typically passed to other code that will call the delegate. A delegate object is called by using the name of the delegate object, followed by the parenthesized arguments to be passed to the delegate. Following is an example of a delegate call:  \n  \n     [!code-csharp[csProgGuideDelegates#19](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#19)]  \n  \n     A delegate can be either called synchronously, as in this example, or asynchronously by using `BeginInvoke` and `EndInvoke` methods.  \n  \n## See also\n\n- [C# Programming Guide](../../../csharp/programming-guide/index.md)\n- [Events](../../../csharp/programming-guide/events/index.md)\n- [Delegates](../../../csharp/programming-guide/delegates/index.md)\n","nodes":[{"pos":[4,245],"embed":true,"restype":"x-metadata","content":"title: \"How to: Declare, Instantiate, and Use a Delegate - C# Programming Guide\"\nms.custom: seodec18\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"delegates [C#], declaring and instantiating\"\nms.assetid: 61c4895f-f785-48f8-8bfe-db73b411c4ae","nodes":[{"content":"How to: Declare, Instantiate, and Use a Delegate - C# Programming Guide","nodes":[{"pos":[0,71],"content":"How to: Declare, Instantiate, and Use a Delegate - C# Programming Guide","nodes":[{"content":"How to: Declare, Instantiate, and Use a Delegate - C# Programming Guide","pos":[0,71]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[252,323],"content":"How to: Declare, Instantiate, and Use a Delegate (C# Programming Guide)","linkify":"How to: Declare, Instantiate, and Use a Delegate (C# Programming Guide)","nodes":[{"content":"How to: Declare, Instantiate, and Use a Delegate (C# Programming Guide)","pos":[0,71]}]},{"content":"In C# 1.0 and later, delegates can be declared as shown in the following example.","pos":[324,405]},{"content":"C# 2.0 provides a simpler way to write the previous declaration, as shown in the following example.","pos":[680,779]},{"pos":[920,1119],"content":"In C# 2.0 and later, it is also possible to use an anonymous method to declare and initialize a <bpt id=\"p1\">[</bpt>delegate<ept id=\"p1\">](../../../csharp/language-reference/keywords/delegate.md)</ept>, as shown in the following example.","source":"In C# 2.0 and later, it is also possible to use an anonymous method to declare and initialize a [delegate](../../../csharp/language-reference/keywords/delegate.md), as shown in the following example."},{"content":"In C# 3.0 and later, delegates can also be declared and instantiated by using a lambda expression, as shown in the following example.","pos":[1260,1393]},{"pos":[1534,1671],"content":"For more information, see <bpt id=\"p1\">[</bpt>Lambda Expressions<ept id=\"p1\">](../../../csharp/programming-guide/statements-expressions-operators/lambda-expressions.md)</ept>.","source":"For more information, see [Lambda Expressions](../../../csharp/programming-guide/statements-expressions-operators/lambda-expressions.md)."},{"content":"The following example illustrates declaring, instantiating, and using a delegate.","pos":[1678,1759]},{"content":"The <ph id=\"ph1\">`BookDB`</ph> class encapsulates a bookstore database that maintains a database of books.","pos":[1760,1848],"source":" The `BookDB` class encapsulates a bookstore database that maintains a database of books."},{"content":"It exposes a method, <ph id=\"ph1\">`ProcessPaperbackBooks`</ph>, which finds all paperback books in the database and calls a delegate for each one.","pos":[1849,1977],"source":" It exposes a method, `ProcessPaperbackBooks`, which finds all paperback books in the database and calls a delegate for each one."},{"content":"The <ph id=\"ph1\">`delegate`</ph> type that is used is named <ph id=\"ph2\">`ProcessBookDelegate`</ph>.","pos":[1978,2042],"source":" The `delegate` type that is used is named `ProcessBookDelegate`."},{"content":"The <ph id=\"ph1\">`Test`</ph> class uses this class to print the titles and average price of the paperback books.","pos":[2043,2137],"source":" The `Test` class uses this class to print the titles and average price of the paperback books."},{"content":"The use of delegates promotes good separation of functionality between the bookstore database and the client code.","pos":[2144,2258]},{"content":"The client code has no knowledge of how the books are stored or how the bookstore code finds paperback books.","pos":[2259,2368]},{"content":"The bookstore code has no knowledge of what processing is performed on the paperback books after it finds them.","pos":[2369,2480]},{"pos":[2489,2496],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2636,2654],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"Declaring a delegate.","pos":[2664,2685]},{"content":"The following statement declares a new delegate type.","pos":[2696,2749]},{"content":"Each delegate type describes the number and types of the arguments, and the type of the return value of methods that it can encapsulate.","pos":[2898,3034]},{"content":"Whenever a new set of argument types or return value type is needed, a new delegate type must be declared.","pos":[3035,3141]},{"content":"Instantiating a delegate.","pos":[3151,3176]},{"content":"After a delegate type has been declared, a delegate object must be created and associated with a particular method.","pos":[3187,3302]},{"content":"In the previous example, you do this by passing the <ph id=\"ph1\">`PrintTitle`</ph> method to the <ph id=\"ph2\">`ProcessPaperbackBooks`</ph> method as in the following example:","pos":[3303,3441],"source":" In the previous example, you do this by passing the `PrintTitle` method to the `ProcessPaperbackBooks` method as in the following example:"},{"content":"This creates a new delegate object associated with the <bpt id=\"p1\">[</bpt>static<ept id=\"p1\">](../../../csharp/language-reference/keywords/static.md)</ept> method <ph id=\"ph1\">`Test.PrintTitle`</ph>.","pos":[3590,3734],"source":"This creates a new delegate object associated with the [static](../../../csharp/language-reference/keywords/static.md) method `Test.PrintTitle`."},{"content":"Similarly, the non-static method <ph id=\"ph1\">`AddBookToTotal`</ph> on the object <ph id=\"ph2\">`totaller`</ph> is passed as in the following example:","pos":[3735,3848],"source":" Similarly, the non-static method `AddBookToTotal` on the object `totaller` is passed as in the following example:"},{"pos":[3997,4081],"content":"In both cases a new delegate object is passed to the <ph id=\"ph1\">`ProcessPaperbackBooks`</ph> method.","source":"In both cases a new delegate object is passed to the `ProcessPaperbackBooks` method."},{"content":"After a delegate is created, the method it is associated with never changes; delegate objects are immutable.","pos":[4092,4200]},{"content":"Calling a delegate.","pos":[4210,4229]},{"content":"After a delegate object is created, the delegate object is typically passed to other code that will call the delegate.","pos":[4240,4358]},{"content":"A delegate object is called by using the name of the delegate object, followed by the parenthesized arguments to be passed to the delegate.","pos":[4359,4498]},{"content":"Following is an example of a delegate call:","pos":[4499,4542]},{"pos":[4691,4823],"content":"A delegate can be either called synchronously, as in this example, or asynchronously by using <ph id=\"ph1\">`BeginInvoke`</ph> and <ph id=\"ph2\">`EndInvoke`</ph> methods.","source":"A delegate can be either called synchronously, as in this example, or asynchronously by using `BeginInvoke` and `EndInvoke` methods."},{"pos":[4832,4840],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4844,4910],"content":"<bpt id=\"p1\">[</bpt>C# Programming Guide<ept id=\"p1\">](../../../csharp/programming-guide/index.md)</ept>","source":"[C# Programming Guide](../../../csharp/programming-guide/index.md)"},{"pos":[4913,4972],"content":"<bpt id=\"p1\">[</bpt>Events<ept id=\"p1\">](../../../csharp/programming-guide/events/index.md)</ept>","source":"[Events](../../../csharp/programming-guide/events/index.md)"},{"pos":[4975,5040],"content":"<bpt id=\"p1\">[</bpt>Delegates<ept id=\"p1\">](../../../csharp/programming-guide/delegates/index.md)</ept>","source":"[Delegates](../../../csharp/programming-guide/delegates/index.md)"}]}