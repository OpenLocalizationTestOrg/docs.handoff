{"content":"---\ntitle: \"Adding DataRelations | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: a4a564fb-c1c4-4135-b6c2-b030e51195e4\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Adding DataRelations\nIn a <xref:System.Data.DataSet> with multiple <xref:System.Data.DataTable> objects, you can use <xref:System.Data.DataRelation> objects to relate one table to another, to navigate through the tables, and to return child or parent rows from a related table.  \n  \n The arguments required to create a **DataRelation** are a name for the **DataRelation** being created, and an array of one or more <xref:System.Data.DataColumn> references to the columns that serve as the parent and child columns in the relationship. After you have created a **DataRelation**, you can use it to navigate between tables and to retrieve values.  \n  \n Adding a **DataRelation** to a <xref:System.Data.DataSet> adds, by default, a <xref:System.Data.UniqueConstraint> to the parent table and a <xref:System.Data.ForeignKeyConstraint> to the child table. For more information about these default constraints, see [DataTable Constraints](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatable-constraints.md).  \n  \n The following code example creates a **DataRelation** using two <xref:System.Data.DataTable> objects in a <xref:System.Data.DataSet>. Each <xref:System.Data.DataTable> contains a column named **CustID**, which serves as a link between the two <xref:System.Data.DataTable> objects. The example adds a single **DataRelation** to the **Relations** collection of the <xref:System.Data.DataSet>. The first argument in the example specifies the name of the **DataRelation** being created. The second argument sets the parent **DataColumn** and the third argument sets the child **DataColumn**.  \n  \n```vb  \ncustomerOrders.Relations.Add(\"CustOrders\", _  \n  customerOrders.Tables(\"Customers\").Columns(\"CustID\"), _  \n  customerOrders.Tables(\"Orders\").Columns(\"CustID\"))  \n```  \n  \n```csharp  \ncustomerOrders.Relations.Add(\"CustOrders\",  \n  customerOrders.Tables[\"Customers\"].Columns[\"CustID\"],  \n  customerOrders.Tables[\"Orders\"].Columns[\"CustID\"]);  \n```  \n  \n A **DataRelation** also has a **Nested** property which, when set to **true**, causes the rows from the child table to be nested within the associated row from the parent table when written as XML elements using <xref:System.Data.DataSet.WriteXml%2A> . For more information, see [Using XML in a DataSet](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/using-xml-in-a-dataset.md).  \n  \n## See Also  \n [DataSets, DataTables, and DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)   \n [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)","nodes":[{"pos":[4,351],"nodes":[{"content":"Adding DataRelations | Microsoft Docs","nodes":[{"pos":[0,37],"content":"Adding DataRelations | Microsoft Docs","nodes":[{"content":"Adding DataRelations | Microsoft Docs","pos":[0,37]}]}],"pos":[6,46],"yaml":true}],"content":"title: \"Adding DataRelations | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: a4a564fb-c1c4-4135-b6c2-b030e51195e4\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","yamlblock":true},{"pos":[358,378],"content":"Adding DataRelations","linkify":"Adding DataRelations","nodes":[{"content":"Adding DataRelations","pos":[0,20]}]},{"content":"In a <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> with multiple <ph id=\"ph2\">&lt;xref:System.Data.DataTable&gt;</ph> objects, you can use <ph id=\"ph3\">&lt;xref:System.Data.DataRelation&gt;</ph> objects to relate one table to another, to navigate through the tables, and to return child or parent rows from a related table.","pos":[379,635],"source":"In a <xref:System.Data.DataSet> with multiple <xref:System.Data.DataTable> objects, you can use <xref:System.Data.DataRelation> objects to relate one table to another, to navigate through the tables, and to return child or parent rows from a related table."},{"content":"The arguments required to create a <bpt id=\"p1\">**</bpt>DataRelation<ept id=\"p1\">**</ept> are a name for the <bpt id=\"p2\">**</bpt>DataRelation<ept id=\"p2\">**</ept> being created, and an array of one or more <ph id=\"ph1\">&lt;xref:System.Data.DataColumn&gt;</ph> references to the columns that serve as the parent and child columns in the relationship.","pos":[642,892],"source":"The arguments required to create a **DataRelation** are a name for the **DataRelation** being created, and an array of one or more <xref:System.Data.DataColumn> references to the columns that serve as the parent and child columns in the relationship."},{"content":"After you have created a <bpt id=\"p1\">**</bpt>DataRelation<ept id=\"p1\">**</ept>, you can use it to navigate between tables and to retrieve values.","pos":[893,1001],"source":" After you have created a **DataRelation**, you can use it to navigate between tables and to retrieve values."},{"content":"Adding a <bpt id=\"p1\">**</bpt>DataRelation<ept id=\"p1\">**</ept> to a <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> adds, by default, a <ph id=\"ph2\">&lt;xref:System.Data.UniqueConstraint&gt;</ph> to the parent table and a <ph id=\"ph3\">&lt;xref:System.Data.ForeignKeyConstraint&gt;</ph> to the child table.","pos":[1008,1207],"source":"Adding a **DataRelation** to a <xref:System.Data.DataSet> adds, by default, a <xref:System.Data.UniqueConstraint> to the parent table and a <xref:System.Data.ForeignKeyConstraint> to the child table."},{"content":"For more information about these default constraints, see <bpt id=\"p1\">[</bpt>DataTable Constraints<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatable-constraints.md)</ept>.","pos":[1208,1385],"source":" For more information about these default constraints, see [DataTable Constraints](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatable-constraints.md)."},{"content":"The following code example creates a <bpt id=\"p1\">**</bpt>DataRelation<ept id=\"p1\">**</ept> using two <ph id=\"ph1\">&lt;xref:System.Data.DataTable&gt;</ph> objects in a <ph id=\"ph2\">&lt;xref:System.Data.DataSet&gt;</ph>.","pos":[1392,1525],"source":"The following code example creates a **DataRelation** using two <xref:System.Data.DataTable> objects in a <xref:System.Data.DataSet>."},{"content":"Each <ph id=\"ph1\">&lt;xref:System.Data.DataTable&gt;</ph> contains a column named <bpt id=\"p1\">**</bpt>CustID<ept id=\"p1\">**</ept>, which serves as a link between the two <ph id=\"ph2\">&lt;xref:System.Data.DataTable&gt;</ph> objects.","pos":[1526,1672],"source":" Each <xref:System.Data.DataTable> contains a column named **CustID**, which serves as a link between the two <xref:System.Data.DataTable> objects."},{"content":"The example adds a single <bpt id=\"p1\">**</bpt>DataRelation<ept id=\"p1\">**</ept> to the <bpt id=\"p2\">**</bpt>Relations<ept id=\"p2\">**</ept> collection of the <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph>.","pos":[1673,1782],"source":" The example adds a single **DataRelation** to the **Relations** collection of the <xref:System.Data.DataSet>."},{"content":"The first argument in the example specifies the name of the <bpt id=\"p1\">**</bpt>DataRelation<ept id=\"p1\">**</ept> being created.","pos":[1783,1874],"source":" The first argument in the example specifies the name of the **DataRelation** being created."},{"content":"The second argument sets the parent <bpt id=\"p1\">**</bpt>DataColumn<ept id=\"p1\">**</ept> and the third argument sets the child <bpt id=\"p2\">**</bpt>DataColumn<ept id=\"p2\">**</ept>.","pos":[1875,1979],"source":" The second argument sets the parent **DataColumn** and the third argument sets the child **DataColumn**."},{"content":"A <bpt id=\"p1\">**</bpt>DataRelation<ept id=\"p1\">**</ept> also has a <bpt id=\"p2\">**</bpt>Nested<ept id=\"p2\">**</ept> property which, when set to <bpt id=\"p3\">**</bpt>true<ept id=\"p3\">**</ept>, causes the rows from the child table to be nested within the associated row from the parent table when written as XML elements using <ph id=\"ph1\">&lt;xref:System.Data.DataSet.WriteXml%2A&gt;</ph> .","pos":[2345,2597],"source":"A **DataRelation** also has a **Nested** property which, when set to **true**, causes the rows from the child table to be nested within the associated row from the parent table when written as XML elements using <xref:System.Data.DataSet.WriteXml%2A> ."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Using XML in a DataSet<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/using-xml-in-a-dataset.md)</ept>.","pos":[2598,2745],"source":" For more information, see [Using XML in a DataSet](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/using-xml-in-a-dataset.md)."},{"pos":[2754,2762],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>DataSets, DataTables, and DataViews<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[2766,2883],"source":"[DataSets, DataTables, and DataViews](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=217917)</ept>","pos":[2887,2990],"source":"[ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)"}]}