{"content":"---\ntitle: \"ReDim Statement (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.ReDim\"\n  - \"vb.Preserve\"\nhelpviewer_keywords: \n  - \"fixed-length strings [Visual Basic], declaring\"\n  - \"ReDim statement [Visual Basic], syntax\"\n  - \"dynamic arrays [Visual Basic], ReDim statement\"\n  - \"arrays [Visual Basic], reallocating\"\n  - \"arrays [Visual Basic], reinitializing\"\n  - \"arrays [Visual Basic], dimensions\"\n  - \"scalars, and arrays\"\n  - \"scalars\"\n  - \"declarations [Visual Basic], dynamic arrays\"\n  - \"variables [Visual Basic], scalar\"\n  - \"ReDim statement [Visual Basic]\"\n  - \"data types [Visual Basic], assigning\"\n  - \"As keyword [Visual Basic], in ReDim statement\"\n  - \"To keyword [Visual Basic], ReDim statement\"\n  - \"arrays [Visual Basic], declaring\"\n  - \"Preserve keyword [Visual Basic], ReDim statement\"\n  - \"storage [Visual Basic], allocating\"\n  - \"arrays [Visual Basic], and scalars\"\n  - \"declaration statements [Visual Basic]\"\n  - \"scalar variables [Visual Basic]\"\nms.assetid: ad1c5e07-dcd7-4ae1-a79e-ad3f2dcc2083\n---\n# ReDim Statement (Visual Basic)\nReallocates storage space for an array variable.  \n  \n## Syntax  \n  \n```  \nReDim [ Preserve ] name(boundlist) [ ,  name(boundlist) [, ... ] ]  \n```  \n  \n## Parts  \n  \n|Term|Definition|  \n|----------|----------------|  \n|`Preserve`|Optional. Modifier used to preserve the data in the existing array when you change the size of only the last dimension.|  \n|`name`|Required. Name of the array variable. See [Declared Element Names](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md).|  \n|`boundlist`|Required. List of bounds of each dimension of the redefined array.|  \n  \n## Remarks  \n You can use the `ReDim` statement to change the size of one or more dimensions of an array that has already been declared. If you have a large array and you no longer need some of its elements, `ReDim` can free up memory by reducing the array size. On the other hand, if your array needs more elements, `ReDim` can add them.  \n  \n The `ReDim` statement is intended only for arrays. It's not valid on scalars (variables that contain only a single value), collections, or structures. Note that if you declare a variable to be of type `Array`, the `ReDim` statement doesn't have sufficient type information to create the new array.  \n  \n You can use `ReDim` only at procedure level. Therefore, the declaration context for the variable must be a procedure; it can't be a source file, a namespace, an interface, a class, a structure, a module, or a block. For more information, see [Declaration Contexts and Default Access Levels](../../../visual-basic/language-reference/statements/declaration-contexts-and-default-access-levels.md).  \n  \n## Rules  \n  \n-   **Multiple Variables.** You can resize several array variables in the same declaration statement and specify the `name` and `boundlist` parts for each variable. Multiple variables are separated by commas.  \n  \n-   **Array Bounds.** Each entry in `boundlist` can specify the lower and upper bounds of that dimension. The lower bound is always 0 (zero). The upper bound is the highest possible index value for that dimension, not the length of the dimension (which is the upper bound plus one). The index for each dimension can vary from 0 through its upper bound value.  \n  \n     The number of dimensions in `boundlist` must match the original number of dimensions (rank) of the array.  \n  \n-   **Data Types.** The `ReDim` statement cannot change the data type of an array variable or its elements.  \n  \n-   **Initialization.** The `ReDim` statement cannot provide new initialization values for the array elements.  \n  \n-   **Rank.** The `ReDim` statement cannot change the rank (the number of dimensions) of the array.  \n  \n-   **Resizing with Preserve.** If you use `Preserve`, you can resize only the last dimension of the array. For every other dimension, you must specify the bound of the existing array.  \n  \n     For example, if your array has only one dimension, you can resize that dimension and still preserve all the contents of the array, because you are changing the last and only dimension. However, if your array has two or more dimensions, you can change the size of only the last dimension if you use `Preserve`.  \n  \n-   **Properties.** You can use `ReDim` on a property that holds an array of values.  \n  \n## Behavior  \n  \n-   **Array Replacement.** `ReDim` releases the existing array and creates a new array with the same rank. The new array replaces the released array in the array variable.  \n  \n-   **Initialization without Preserve.** If you do not specify `Preserve`, `ReDim` initializes the elements of the new array by using the default value for their data type.  \n  \n-   **Initialization with Preserve.** If you specify `Preserve`, Visual Basic copies the elements from the existing array to the new array.  \n  \n## Example  \n The following example increases the size of the last dimension of a dynamic array without losing any existing data in the array, and then decreases the size with partial data loss. Finally, it decreases the size back to its original value and reinitializes all the array elements.  \n  \n [!code-vb[VbVbalrStatements#52](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class1.vb#52)]  \n  \n The `Dim` statement creates a new array with three dimensions. Each dimension is declared with a bound of 10, so the array index for each dimension can range from 0 through 10. In the following discussion, the three dimensions are referred to as layer, row, and column.  \n  \n The first `ReDim` creates a new array which replaces the existing array in variable `intArray`. `ReDim` copies all the elements from the existing array into the new array. It also adds 10 more columns to the end of every row in every layer and initializes the elements in these new columns to 0 (the default value of `Integer`, which is the element type of the array).  \n  \n The second `ReDim` creates another new array and copies all the elements that fit. However, five columns are lost from the end of every row in every layer. This is not a problem if you have finished using these columns. Reducing the size of a large array can free up memory that you no longer need.  \n  \n The third `ReDim` creates another new array and removes another five columns from the end of every row in every layer. This time it does not copy any existing elements. This statement reverts the array to its original size. Because the statement doesn't include the `Preserve` modifier, it sets all array elements to their original default values.  \n  \n For additional examples, see [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md).  \n  \n## See also\n\n- <xref:System.IndexOutOfRangeException>\n- [Const Statement](../../../visual-basic/language-reference/statements/const-statement.md)\n- [Dim Statement](../../../visual-basic/language-reference/statements/dim-statement.md)\n- [Erase Statement](../../../visual-basic/language-reference/statements/erase-statement.md)\n- [Nothing](../../../visual-basic/language-reference/nothing.md)\n- [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md)\n","nodes":[{"pos":[4,1026],"embed":true,"restype":"x-metadata","content":"title: \"ReDim Statement (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.ReDim\"\n  - \"vb.Preserve\"\nhelpviewer_keywords: \n  - \"fixed-length strings [Visual Basic], declaring\"\n  - \"ReDim statement [Visual Basic], syntax\"\n  - \"dynamic arrays [Visual Basic], ReDim statement\"\n  - \"arrays [Visual Basic], reallocating\"\n  - \"arrays [Visual Basic], reinitializing\"\n  - \"arrays [Visual Basic], dimensions\"\n  - \"scalars, and arrays\"\n  - \"scalars\"\n  - \"declarations [Visual Basic], dynamic arrays\"\n  - \"variables [Visual Basic], scalar\"\n  - \"ReDim statement [Visual Basic]\"\n  - \"data types [Visual Basic], assigning\"\n  - \"As keyword [Visual Basic], in ReDim statement\"\n  - \"To keyword [Visual Basic], ReDim statement\"\n  - \"arrays [Visual Basic], declaring\"\n  - \"Preserve keyword [Visual Basic], ReDim statement\"\n  - \"storage [Visual Basic], allocating\"\n  - \"arrays [Visual Basic], and scalars\"\n  - \"declaration statements [Visual Basic]\"\n  - \"scalar variables [Visual Basic]\"\nms.assetid: ad1c5e07-dcd7-4ae1-a79e-ad3f2dcc2083","nodes":[{"content":"ReDim Statement (Visual Basic)","nodes":[{"pos":[0,30],"content":"ReDim Statement (Visual Basic)","nodes":[{"content":"ReDim Statement (Visual Basic)","pos":[0,30]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[1033,1063],"content":"ReDim Statement (Visual Basic)","linkify":"ReDim Statement (Visual Basic)","nodes":[{"content":"ReDim Statement (Visual Basic)","pos":[0,30]}]},{"content":"Reallocates storage space for an array variable.","pos":[1064,1112]},{"pos":[1121,1127],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1220,1225],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"content":"Term","pos":[1232,1236]},{"content":"Definition","pos":[1237,1247]},{"content":"Optional.","pos":[1295,1304]},{"content":"Modifier used to preserve the data in the existing array when you change the size of only the last dimension.","pos":[1305,1414]},{"content":"Required.","pos":[1426,1435]},{"content":"Name of the array variable.","pos":[1436,1463]},{"content":"See <bpt id=\"p1\">[</bpt>Declared Element Names<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)</ept>.","pos":[1464,1596],"source":" See [Declared Element Names](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)."},{"content":"Required.","pos":[1613,1622]},{"content":"List of bounds of each dimension of the redefined array.","pos":[1623,1679]},{"pos":[1689,1696],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can use the <ph id=\"ph1\">`ReDim`</ph> statement to change the size of one or more dimensions of an array that has already been declared.","pos":[1700,1822],"source":"You can use the `ReDim` statement to change the size of one or more dimensions of an array that has already been declared."},{"content":"If you have a large array and you no longer need some of its elements, <ph id=\"ph1\">`ReDim`</ph> can free up memory by reducing the array size.","pos":[1823,1948],"source":" If you have a large array and you no longer need some of its elements, `ReDim` can free up memory by reducing the array size."},{"content":"On the other hand, if your array needs more elements, <ph id=\"ph1\">`ReDim`</ph> can add them.","pos":[1949,2024],"source":" On the other hand, if your array needs more elements, `ReDim` can add them."},{"content":"The <ph id=\"ph1\">`ReDim`</ph> statement is intended only for arrays.","pos":[2031,2081],"source":"The `ReDim` statement is intended only for arrays."},{"content":"It's not valid on scalars (variables that contain only a single value), collections, or structures.","pos":[2082,2181]},{"content":"Note that if you declare a variable to be of type <ph id=\"ph1\">`Array`</ph>, the <ph id=\"ph2\">`ReDim`</ph> statement doesn't have sufficient type information to create the new array.","pos":[2182,2328],"source":" Note that if you declare a variable to be of type `Array`, the `ReDim` statement doesn't have sufficient type information to create the new array."},{"content":"You can use <ph id=\"ph1\">`ReDim`</ph> only at procedure level.","pos":[2335,2379],"source":"You can use `ReDim` only at procedure level."},{"content":"Therefore, the declaration context for the variable must be a procedure; it can't be a source file, a namespace, an interface, a class, a structure, a module, or a block.","pos":[2380,2550]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Declaration Contexts and Default Access Levels<ept id=\"p1\">](../../../visual-basic/language-reference/statements/declaration-contexts-and-default-access-levels.md)</ept>.","pos":[2551,2729],"source":" For more information, see [Declaration Contexts and Default Access Levels](../../../visual-basic/language-reference/statements/declaration-contexts-and-default-access-levels.md)."},{"pos":[2738,2743],"content":"Rules","linkify":"Rules","nodes":[{"content":"Rules","pos":[0,5]}]},{"content":"<bpt id=\"p1\">**</bpt>Multiple Variables.<ept id=\"p1\">**</ept>","pos":[2753,2776],"source":"**Multiple Variables.**"},{"content":"You can resize several array variables in the same declaration statement and specify the <ph id=\"ph1\">`name`</ph> and <ph id=\"ph2\">`boundlist`</ph> parts for each variable.","pos":[2777,2913],"source":" You can resize several array variables in the same declaration statement and specify the `name` and `boundlist` parts for each variable."},{"content":"Multiple variables are separated by commas.","pos":[2914,2957]},{"content":"<bpt id=\"p1\">**</bpt>Array Bounds.<ept id=\"p1\">**</ept>","pos":[2967,2984],"source":"**Array Bounds.**"},{"content":"Each entry in <ph id=\"ph1\">`boundlist`</ph> can specify the lower and upper bounds of that dimension.","pos":[2985,3068],"source":" Each entry in `boundlist` can specify the lower and upper bounds of that dimension."},{"content":"The lower bound is always 0 (zero).","pos":[3069,3104]},{"content":"The upper bound is the highest possible index value for that dimension, not the length of the dimension (which is the upper bound plus one).","pos":[3105,3245]},{"content":"The index for each dimension can vary from 0 through its upper bound value.","pos":[3246,3321]},{"pos":[3332,3437],"content":"The number of dimensions in <ph id=\"ph1\">`boundlist`</ph> must match the original number of dimensions (rank) of the array.","source":"The number of dimensions in `boundlist` must match the original number of dimensions (rank) of the array."},{"content":"<bpt id=\"p1\">**</bpt>Data Types.<ept id=\"p1\">**</ept>","pos":[3447,3462],"source":"**Data Types.**"},{"content":"The <ph id=\"ph1\">`ReDim`</ph> statement cannot change the data type of an array variable or its elements.","pos":[3463,3550],"source":" The `ReDim` statement cannot change the data type of an array variable or its elements."},{"content":"<bpt id=\"p1\">**</bpt>Initialization.<ept id=\"p1\">**</ept>","pos":[3560,3579],"source":"**Initialization.**"},{"content":"The <ph id=\"ph1\">`ReDim`</ph> statement cannot provide new initialization values for the array elements.","pos":[3580,3666],"source":" The `ReDim` statement cannot provide new initialization values for the array elements."},{"content":"<bpt id=\"p1\">**</bpt>Rank.<ept id=\"p1\">**</ept>","pos":[3676,3685],"source":"**Rank.**"},{"content":"The <ph id=\"ph1\">`ReDim`</ph> statement cannot change the rank (the number of dimensions) of the array.","pos":[3686,3771],"source":" The `ReDim` statement cannot change the rank (the number of dimensions) of the array."},{"content":"<bpt id=\"p1\">**</bpt>Resizing with Preserve.<ept id=\"p1\">**</ept>","pos":[3781,3808],"source":"**Resizing with Preserve.**"},{"content":"If you use <ph id=\"ph1\">`Preserve`</ph>, you can resize only the last dimension of the array.","pos":[3809,3884],"source":" If you use `Preserve`, you can resize only the last dimension of the array."},{"content":"For every other dimension, you must specify the bound of the existing array.","pos":[3885,3961]},{"content":"For example, if your array has only one dimension, you can resize that dimension and still preserve all the contents of the array, because you are changing the last and only dimension.","pos":[3972,4156]},{"content":"However, if your array has two or more dimensions, you can change the size of only the last dimension if you use <ph id=\"ph1\">`Preserve`</ph>.","pos":[4157,4281],"source":" However, if your array has two or more dimensions, you can change the size of only the last dimension if you use `Preserve`."},{"content":"<bpt id=\"p1\">**</bpt>Properties.<ept id=\"p1\">**</ept>","pos":[4291,4306],"source":"**Properties.**"},{"content":"You can use <ph id=\"ph1\">`ReDim`</ph> on a property that holds an array of values.","pos":[4307,4371],"source":" You can use `ReDim` on a property that holds an array of values."},{"pos":[4380,4388],"content":"Behavior","linkify":"Behavior","nodes":[{"content":"Behavior","pos":[0,8]}]},{"content":"<bpt id=\"p1\">**</bpt>Array Replacement.<ept id=\"p1\">**</ept>","pos":[4398,4420],"source":"**Array Replacement.**"},{"content":"<ph id=\"ph1\">`ReDim`</ph> releases the existing array and creates a new array with the same rank.","pos":[4421,4500],"source":"`ReDim` releases the existing array and creates a new array with the same rank."},{"content":"The new array replaces the released array in the array variable.","pos":[4501,4565]},{"content":"<bpt id=\"p1\">**</bpt>Initialization without Preserve.<ept id=\"p1\">**</ept>","pos":[4575,4611],"source":"**Initialization without Preserve.**"},{"content":"If you do not specify <ph id=\"ph1\">`Preserve`</ph>, <ph id=\"ph2\">`ReDim`</ph> initializes the elements of the new array by using the default value for their data type.","pos":[4612,4743],"source":" If you do not specify `Preserve`, `ReDim` initializes the elements of the new array by using the default value for their data type."},{"content":"<bpt id=\"p1\">**</bpt>Initialization with Preserve.<ept id=\"p1\">**</ept>","pos":[4753,4786],"source":"**Initialization with Preserve.**"},{"content":"If you specify <ph id=\"ph1\">`Preserve`</ph>, Visual Basic copies the elements from the existing array to the new array.","pos":[4787,4888],"source":" If you specify `Preserve`, Visual Basic copies the elements from the existing array to the new array."},{"pos":[4897,4904],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example increases the size of the last dimension of a dynamic array without losing any existing data in the array, and then decreases the size with partial data loss.","pos":[4908,5088]},{"content":"Finally, it decreases the size back to its original value and reinitializes all the array elements.","pos":[5089,5188]},{"content":"The <ph id=\"ph1\">`Dim`</ph> statement creates a new array with three dimensions.","pos":[5321,5383],"source":"The `Dim` statement creates a new array with three dimensions."},{"content":"Each dimension is declared with a bound of 10, so the array index for each dimension can range from 0 through 10.","pos":[5384,5497]},{"content":"In the following discussion, the three dimensions are referred to as layer, row, and column.","pos":[5498,5590]},{"content":"The first <ph id=\"ph1\">`ReDim`</ph> creates a new array which replaces the existing array in variable <ph id=\"ph2\">`intArray`</ph>.","pos":[5597,5692],"source":"The first `ReDim` creates a new array which replaces the existing array in variable `intArray`."},{"content":"<ph id=\"ph1\">`ReDim`</ph> copies all the elements from the existing array into the new array.","pos":[5693,5768],"source":"`ReDim` copies all the elements from the existing array into the new array."},{"content":"It also adds 10 more columns to the end of every row in every layer and initializes the elements in these new columns to 0 (the default value of <ph id=\"ph1\">`Integer`</ph>, which is the element type of the array).","pos":[5769,5965],"source":" It also adds 10 more columns to the end of every row in every layer and initializes the elements in these new columns to 0 (the default value of `Integer`, which is the element type of the array)."},{"content":"The second <ph id=\"ph1\">`ReDim`</ph> creates another new array and copies all the elements that fit.","pos":[5972,6054],"source":"The second `ReDim` creates another new array and copies all the elements that fit."},{"content":"However, five columns are lost from the end of every row in every layer.","pos":[6055,6127]},{"content":"This is not a problem if you have finished using these columns.","pos":[6128,6191]},{"content":"Reducing the size of a large array can free up memory that you no longer need.","pos":[6192,6270]},{"content":"The third <ph id=\"ph1\">`ReDim`</ph> creates another new array and removes another five columns from the end of every row in every layer.","pos":[6277,6395],"source":"The third `ReDim` creates another new array and removes another five columns from the end of every row in every layer."},{"content":"This time it does not copy any existing elements.","pos":[6396,6445]},{"content":"This statement reverts the array to its original size.","pos":[6446,6500]},{"content":"Because the statement doesn't include the <ph id=\"ph1\">`Preserve`</ph> modifier, it sets all array elements to their original default values.","pos":[6501,6624],"source":" Because the statement doesn't include the `Preserve` modifier, it sets all array elements to their original default values."},{"pos":[6631,6744],"content":"For additional examples, see <bpt id=\"p1\">[</bpt>Arrays<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/arrays/index.md)</ept>.","source":"For additional examples, see [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md)."},{"pos":[6753,6761],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6806,6895],"content":"<bpt id=\"p1\">[</bpt>Const Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/const-statement.md)</ept>","source":"[Const Statement](../../../visual-basic/language-reference/statements/const-statement.md)"},{"pos":[6898,6983],"content":"<bpt id=\"p1\">[</bpt>Dim Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/dim-statement.md)</ept>","source":"[Dim Statement](../../../visual-basic/language-reference/statements/dim-statement.md)"},{"pos":[6986,7075],"content":"<bpt id=\"p1\">[</bpt>Erase Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/erase-statement.md)</ept>","source":"[Erase Statement](../../../visual-basic/language-reference/statements/erase-statement.md)"},{"pos":[7078,7140],"content":"<bpt id=\"p1\">[</bpt>Nothing<ept id=\"p1\">](../../../visual-basic/language-reference/nothing.md)</ept>","source":"[Nothing](../../../visual-basic/language-reference/nothing.md)"},{"pos":[7143,7226],"content":"<bpt id=\"p1\">[</bpt>Arrays<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/arrays/index.md)</ept>","source":"[Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md)"}]}