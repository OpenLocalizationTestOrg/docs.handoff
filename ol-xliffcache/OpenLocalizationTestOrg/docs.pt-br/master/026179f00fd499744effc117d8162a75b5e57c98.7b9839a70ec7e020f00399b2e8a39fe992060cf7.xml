{"content":"---\ntitle: \"Extend Glass Frame Into a WPF Application | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"applications, extending glass frames into\"\n  - \"graphics, extending glass frames into applications\"\n  - \"extending glass frames into applications\"\n  - \"glass frames, extending into applications\"\nms.assetid: 74388a3a-4b69-4a9d-ba1f-e107636bd660\ncaps.latest.revision: 12\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# Extend Glass Frame Into a WPF Application\nThis topic demonstrates how to extend the [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)] glass frame into the client area of a [!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)] application.  \n  \n> [!NOTE]\n>  This example will only work on a [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] machine running the Desktop Window Manager (DWM) with glass enabled. [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] Home Basic edition does not support the transparent glass effect. Areas that would typically render with the transparent glass effect on other editions of [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] are rendered opaque.  \n  \n## Example  \n The following image illustrates the glass frame extended into the address bar of Internet Explorer 7.  \n  \n **Internet Explorer with extended glass frame behind address bar.**  \n  \n ![IE7 with glass frame extended behind address bar.](../../../../docs/framework/wpf/graphics-multimedia/media/ie7glasstopbar.PNG \"IE7glasstopbar\")  \n  \n To extend the glass frame on a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application, access to unmanaged [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] is needed. The following code example does a Platform Invoke (pinvoke) for the two [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] needed to extend the frame into the client area. Each of these [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] are declared in a class called **NonClientRegionAPI**.  \n  \n```csharp  \n[StructLayout(LayoutKind.Sequential)]  \npublic struct MARGINS  \n{  \n    public int cxLeftWidth;      // width of left border that retains its size  \n    public int cxRightWidth;     // width of right border that retains its size  \n    public int cyTopHeight;      // height of top border that retains its size  \n    public int cyBottomHeight;   // height of bottom border that retains its size  \n};  \n  \n[DllImport(\"DwmApi.dll\")]  \npublic static extern int DwmExtendFrameIntoClientArea(  \n    IntPtr hwnd,  \n    ref MARGINS pMarInset);  \n```  \n  \n```vb  \n<StructLayout(LayoutKind.Sequential)>  \n        Public Structure MARGINS  \n            Public cxLeftWidth As Integer ' width of left border that retains its size  \n            Public cxRightWidth As Integer ' width of right border that retains its size  \n            Public cyTopHeight As Integer ' height of top border that retains its size  \n            Public cyBottomHeight As Integer ' height of bottom border that retains its size  \n        End Structure  \n  \n        <DllImport(\"DwmApi.dll\")>  \n        Public Shared Function DwmExtendFrameIntoClientArea(ByVal hwnd As IntPtr, ByRef pMarInset As MARGINS) As Integer  \n        End Function  \n```  \n  \n [DwmExtendFrameIntoClientArea](https://msdn.microsoft.com/library/aa969512.aspx) is the DWM function that extends the frame into the client area. It takes two parameters; a window handle and a [MARGINS](https://msdn.microsoft.com/library/bb773244.aspx) structure. [MARGINS](https://msdn.microsoft.com/library/bb773244.aspx) is used to tell the DWM how much extra the frame should be extended into the client area.  \n  \n## Example  \n To use the [DwmExtendFrameIntoClientArea](https://msdn.microsoft.com/library/aa969512.aspx) function, a window handle must be obtained. In [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], the window handle can be obtained from the <xref:System.Windows.Interop.HwndSource.Handle%2A> property of an <xref:System.Windows.Interop.HwndSource>. In the following example, the frame is extended into the client area on the <xref:System.Windows.FrameworkElement.Loaded> event of the window.  \n  \n```csharp  \nvoid OnLoaded(object sender, RoutedEventArgs e)  \n{  \n   try  \n   {  \n      // Obtain the window handle for WPF application  \n      IntPtr mainWindowPtr = new WindowInteropHelper(this).Handle;  \n      HwndSource mainWindowSrc = HwndSource.FromHwnd(mainWindowPtr);  \n      mainWindowSrc.CompositionTarget.BackgroundColor = Color.FromArgb(0, 0, 0, 0);  \n  \n      // Get System Dpi  \n      System.Drawing.Graphics desktop = System.Drawing.Graphics.FromHwnd(mainWindowPtr);  \n      float DesktopDpiX = desktop.DpiX;  \n      float DesktopDpiY = desktop.DpiY;  \n  \n      // Set Margins  \n      NonClientRegionAPI.MARGINS margins = new NonClientRegionAPI.MARGINS();  \n  \n      // Extend glass frame into client area  \n      // Note that the default desktop Dpi is 96dpi. The  margins are  \n      // adjusted for the system Dpi.  \n      margins.cxLeftWidth = Convert.ToInt32(5 * (DesktopDpiX / 96));  \n      margins.cxRightWidth = Convert.ToInt32(5 * (DesktopDpiX / 96));  \n      margins.cyTopHeight = Convert.ToInt32(((int)topBar.ActualHeight + 5) * (DesktopDpiX / 96));  \n      margins.cyBottomHeight = Convert.ToInt32(5 * (DesktopDpiX / 96));  \n  \n      int hr = NonClientRegionAPI.DwmExtendFrameIntoClientArea(mainWindowSrc.Handle, ref margins);  \n      //  \n      if (hr < 0)  \n      {  \n         //DwmExtendFrameIntoClientArea Failed  \n      }  \n   }  \n   // If not Vista, paint background white.  \n   catch (DllNotFoundException)  \n   {  \n      Application.Current.MainWindow.Background = Brushes.White;  \n   }  \n}  \n```  \n  \n## Example  \n The following example shows a simple window in which the frame is extended into the client area. The frame is extended behind the top border that contains the two <xref:System.Windows.Controls.TextBox> objects.  \n  \n```xaml  \n<Window x:Class=\"SDKSample.Window1\"  \n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"  \n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"  \n    Title=\"Extended Glass in WPF\" Height=\"300\" Width=\"400\"   \n    Loaded=\"OnLoaded\" Background=\"Transparent\"  \n    >  \n  <Grid ShowGridLines=\"True\">  \n    <DockPanel Name=\"mainDock\">  \n      <!-- The border is used to compute the rendered height with margins.  \n           topBar contents will be displayed on the extended glass frame.-->  \n      <Border Name=\"topBar\" DockPanel.Dock=\"Top\" >  \n        <Grid Name=\"grid\">  \n          <Grid.ColumnDefinitions>  \n            <ColumnDefinition MinWidth=\"100\" Width=\"*\"/>  \n            <ColumnDefinition Width=\"Auto\"/>  \n          </Grid.ColumnDefinitions>  \n          <TextBox Grid.Column=\"0\" MinWidth=\"100\" Margin=\"0,0,10,5\">Path</TextBox>  \n          <TextBox Grid.Column=\"1\" MinWidth=\"75\" Margin=\"0,0,0,5\">Search</TextBox>  \n        </Grid>  \n      </Border>  \n      <Grid DockPanel.Dock=\"Top\" >  \n        <Grid.ColumnDefinitions>  \n          <ColumnDefinition/>  \n        </Grid.ColumnDefinitions>  \n        <TextBox Grid.Column=\"0\" AcceptsReturn=\"True\"/>  \n      </Grid>  \n    </DockPanel>  \n  </Grid>  \n</Window>  \n```  \n  \n The following image illustrates the glass frame extended into a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application.  \n  \n **Glass Frame Extended into a**  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]  **Application.**  \n  \n ![Glass Frame Extended into a WPF application.](../../../../docs/framework/wpf/graphics-multimedia/media/wpfextendedglassintoclient.PNG \"WPFextendedGlassIntoClient\")  \n  \n## See Also  \n [Desktop Window Manager Overview](https://msdn.microsoft.com/library/aa969540.aspx)   \n [Desktop Window Manager Blur Overview](https://msdn.microsoft.com/library/aa969537.aspx)   \n [DwmExtendFrameIntoClientArea](https://msdn.microsoft.com/library/aa969512.aspx)","nodes":[{"pos":[4,593],"nodes":[{"content":"Extend Glass Frame Into a WPF Application | Microsoft Docs","nodes":[{"pos":[0,58],"content":"Extend Glass Frame Into a WPF Application | Microsoft Docs","nodes":[{"content":"Extend Glass Frame Into a WPF Application | Microsoft Docs","pos":[0,58]}]}],"pos":[6,67],"yaml":true}],"content":"title: \"Extend Glass Frame Into a WPF Application | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-wpf\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"applications, extending glass frames into\"\n  - \"graphics, extending glass frames into applications\"\n  - \"extending glass frames into applications\"\n  - \"glass frames, extending into applications\"\nms.assetid: 74388a3a-4b69-4a9d-ba1f-e107636bd660\ncaps.latest.revision: 12\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"","yamlblock":true},{"pos":[600,641],"content":"Extend Glass Frame Into a WPF Application","linkify":"Extend Glass Frame Into a WPF Application","nodes":[{"content":"Extend Glass Frame Into a WPF Application","pos":[0,41]}]},{"pos":[642,880],"content":"This topic demonstrates how to extend the <ph id=\"ph1\">[!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)]</ph> glass frame into the client area of a <ph id=\"ph2\">[!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)]</ph> application.","source":"This topic demonstrates how to extend the [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)] glass frame into the client area of a [!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)] application."},{"pos":[888,1416],"content":"[!NOTE]\n This example will only work on a [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] machine running the Desktop Window Manager (DWM) with glass enabled. [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] Home Basic edition does not support the transparent glass effect. Areas that would typically render with the transparent glass effect on other editions of [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] are rendered opaque.","leadings":["","> "],"nodes":[{"content":"This example will only work on a [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] machine running the Desktop Window Manager (DWM) with glass enabled. [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] Home Basic edition does not support the transparent glass effect. Areas that would typically render with the transparent glass effect on other editions of [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] are rendered opaque.","pos":[9,526],"nodes":[{"content":"This example will only work on a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)]</ph> machine running the Desktop Window Manager (DWM) with glass enabled.","pos":[0,181],"source":"This example will only work on a [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] machine running the Desktop Window Manager (DWM) with glass enabled."},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)]</ph> Home Basic edition does not support the transparent glass effect.","pos":[182,327],"source":"[!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] Home Basic edition does not support the transparent glass effect."},{"content":"Areas that would typically render with the transparent glass effect on other editions of <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)]</ph> are rendered opaque.","pos":[328,517],"source":" Areas that would typically render with the transparent glass effect on other editions of [!INCLUDE[TLA2#tla_winvista](../../../../includes/tla2sharptla-winvista-md.md)] are rendered opaque."}]}]},{"pos":[1425,1432],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following image illustrates the glass frame extended into the address bar of Internet Explorer 7.","pos":[1436,1537]},{"pos":[1544,1611],"content":"<bpt id=\"p1\">**</bpt>Internet Explorer with extended glass frame behind address bar.<ept id=\"p1\">**</ept>","source":"**Internet Explorer with extended glass frame behind address bar.**"},{"pos":[1618,1764],"content":"<bpt id=\"p1\">![</bpt>IE7 with glass frame extended behind address bar.<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wpf/graphics-multimedia/media/ie7glasstopbar.PNG \"</bpt>IE7glasstopbar<ept id=\"p2\">\")</ept>","source":"![IE7 with glass frame extended behind address bar.](../../../../docs/framework/wpf/graphics-multimedia/media/ie7glasstopbar.PNG \"IE7glasstopbar\")"},{"content":"To extend the glass frame on a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> application, access to unmanaged <ph id=\"ph2\">[!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)]</ph> is needed.","pos":[1771,1983],"source":"To extend the glass frame on a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application, access to unmanaged [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] is needed."},{"content":"The following code example does a Platform Invoke (pinvoke) for the two <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> needed to extend the frame into the client area.","pos":[1984,2174],"source":" The following code example does a Platform Invoke (pinvoke) for the two [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] needed to extend the frame into the client area."},{"content":"Each of these <ph id=\"ph1\">[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]</ph> are declared in a class called <bpt id=\"p1\">**</bpt>NonClientRegionAPI<ept id=\"p1\">**</ept>.","pos":[2175,2313],"source":" Each of these [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] are declared in a class called **NonClientRegionAPI**."},{"content":"<bpt id=\"p1\">[</bpt>DwmExtendFrameIntoClientArea<ept id=\"p1\">](https://msdn.microsoft.com/library/aa969512.aspx)</ept> is the DWM function that extends the frame into the client area.","pos":[3544,3689],"source":"[DwmExtendFrameIntoClientArea](https://msdn.microsoft.com/library/aa969512.aspx) is the DWM function that extends the frame into the client area."},{"content":"It takes two parameters; a window handle and a <bpt id=\"p1\">[</bpt>MARGINS<ept id=\"p1\">](https://msdn.microsoft.com/library/bb773244.aspx)</ept> structure.","pos":[3690,3807],"source":" It takes two parameters; a window handle and a [MARGINS](https://msdn.microsoft.com/library/bb773244.aspx) structure."},{"content":"<bpt id=\"p1\">[</bpt>MARGINS<ept id=\"p1\">](https://msdn.microsoft.com/library/bb773244.aspx)</ept> is used to tell the DWM how much extra the frame should be extended into the client area.","pos":[3808,3957],"source":"[MARGINS](https://msdn.microsoft.com/library/bb773244.aspx) is used to tell the DWM how much extra the frame should be extended into the client area."},{"pos":[3966,3973],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"To use the <bpt id=\"p1\">[</bpt>DwmExtendFrameIntoClientArea<ept id=\"p1\">](https://msdn.microsoft.com/library/aa969512.aspx)</ept> function, a window handle must be obtained.","pos":[3977,4112],"source":"To use the [DwmExtendFrameIntoClientArea](https://msdn.microsoft.com/library/aa969512.aspx) function, a window handle must be obtained."},{"content":"In <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph>, the window handle can be obtained from the <ph id=\"ph2\">&lt;xref:System.Windows.Interop.HwndSource.Handle%2A&gt;</ph> property of an <ph id=\"ph3\">&lt;xref:System.Windows.Interop.HwndSource&gt;</ph>.","pos":[4113,4337],"source":" In [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], the window handle can be obtained from the <xref:System.Windows.Interop.HwndSource.Handle%2A> property of an <xref:System.Windows.Interop.HwndSource>."},{"content":"In the following example, the frame is extended into the client area on the <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event of the window.","pos":[4338,4480],"source":" In the following example, the frame is extended into the client area on the <xref:System.Windows.FrameworkElement.Loaded> event of the window."},{"pos":[6026,6033],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example shows a simple window in which the frame is extended into the client area.","pos":[6037,6133]},{"content":"The frame is extended behind the top border that contains the two <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBox&gt;</ph> objects.","pos":[6134,6247],"source":" The frame is extended behind the top border that contains the two <xref:System.Windows.Controls.TextBox> objects."},{"pos":[7511,7657],"content":"The following image illustrates the glass frame extended into a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph> application.","source":"The following image illustrates the glass frame extended into a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application."},{"pos":[7664,7784],"content":"<bpt id=\"p1\">**</bpt>Glass Frame Extended into a<ept id=\"p1\">**</ept>  <ph id=\"ph1\">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]</ph>  <bpt id=\"p2\">**</bpt>Application.<ept id=\"p2\">**</ept>","source":"**Glass Frame Extended into a**  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]  **Application.**"},{"pos":[7791,7956],"content":"<bpt id=\"p1\">![</bpt>Glass Frame Extended into a WPF application.<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wpf/graphics-multimedia/media/wpfextendedglassintoclient.PNG \"</bpt>WPFextendedGlassIntoClient<ept id=\"p2\">\")</ept>","source":"![Glass Frame Extended into a WPF application.](../../../../docs/framework/wpf/graphics-multimedia/media/wpfextendedglassintoclient.PNG \"WPFextendedGlassIntoClient\")"},{"pos":[7965,7973],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Desktop Window Manager Overview<ept id=\"p1\">](https://msdn.microsoft.com/library/aa969540.aspx)</ept><ph id=\"ph1\"> </ph>","pos":[7977,8061],"source":"[Desktop Window Manager Overview](https://msdn.microsoft.com/library/aa969540.aspx) "},{"content":"<bpt id=\"p1\">[</bpt>Desktop Window Manager Blur Overview<ept id=\"p1\">](https://msdn.microsoft.com/library/aa969537.aspx)</ept><ph id=\"ph1\"> </ph>","pos":[8065,8154],"source":"[Desktop Window Manager Blur Overview](https://msdn.microsoft.com/library/aa969537.aspx) "},{"content":"<bpt id=\"p1\">[</bpt>DwmExtendFrameIntoClientArea<ept id=\"p1\">](https://msdn.microsoft.com/library/aa969512.aspx)</ept>","pos":[8158,8238],"source":"[DwmExtendFrameIntoClientArea](https://msdn.microsoft.com/library/aa969512.aspx)"}]}