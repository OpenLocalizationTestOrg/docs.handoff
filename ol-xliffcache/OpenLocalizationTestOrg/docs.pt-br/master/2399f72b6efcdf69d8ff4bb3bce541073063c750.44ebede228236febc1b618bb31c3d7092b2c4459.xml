{"content":"---\ntitle: \"marshalCleanupError MDA\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"cleanup operations\"\n  - \"marshaling, run-time errors\"\n  - \"managed debugging assistants (MDAs), marshaling\"\n  - \"MDAs (managed debugging assistants), marshaling\"\n  - \"marshaling cleanup error\"\n  - \"MarshalCleanupError MDA\"\n  - \"memory, cleanup errors\"\nms.assetid: 2f5d9e7c-ae51-4155-a435-54347aa1f091\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# marshalCleanupError MDA\nThe `marshalCleanupError` managed debugging assistant (MDA) is activated when the common language runtime (CLR) encounters an error while attempting to clean up temporary structures and memory used for marshaling data types between native and managed code boundaries.  \n  \n## Symptoms  \n A memory leak occurs when making native and managed code transitions, runtime state such as thread culture is not restored, or errors occur in <xref:System.Runtime.InteropServices.SafeHandle> cleanup.  \n  \n## Cause  \n An unexpected error occurred while cleaning up temporary structures.  \n  \n## Resolution  \n Review all <xref:System.Runtime.InteropServices.SafeHandle> destructor, finalizer, and custom marshaler implementations for errors.  \n  \n## Effect on the Runtime  \n This MDA has no effect on the CLR.  \n  \n## Output  \n A message reporting the operation that failed during cleanup.  \n  \n## Configuration  \n  \n```xml  \n<mdaConfig>  \n  <assistants>  \n    <marshalCleanupError />  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## See also\n\n- <xref:System.Runtime.InteropServices.MarshalAsAttribute>\n- [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)\n- [Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)\n","nodes":[{"pos":[4,423],"embed":true,"restype":"x-metadata","content":"title: \"marshalCleanupError MDA\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"cleanup operations\"\n  - \"marshaling, run-time errors\"\n  - \"managed debugging assistants (MDAs), marshaling\"\n  - \"MDAs (managed debugging assistants), marshaling\"\n  - \"marshaling cleanup error\"\n  - \"MarshalCleanupError MDA\"\n  - \"memory, cleanup errors\"\nms.assetid: 2f5d9e7c-ae51-4155-a435-54347aa1f091\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"marshalCleanupError MDA","nodes":[{"pos":[0,23],"content":"marshalCleanupError MDA","nodes":[{"content":"marshalCleanupError MDA","pos":[0,23]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[430,453],"content":"marshalCleanupError MDA","linkify":"marshalCleanupError MDA","nodes":[{"content":"marshalCleanupError MDA","pos":[0,23]}]},{"pos":[454,721],"content":"The <ph id=\"ph1\">`marshalCleanupError`</ph> managed debugging assistant (MDA) is activated when the common language runtime (CLR) encounters an error while attempting to clean up temporary structures and memory used for marshaling data types between native and managed code boundaries.","source":"The `marshalCleanupError` managed debugging assistant (MDA) is activated when the common language runtime (CLR) encounters an error while attempting to clean up temporary structures and memory used for marshaling data types between native and managed code boundaries."},{"pos":[730,738],"content":"Symptoms","linkify":"Symptoms","nodes":[{"content":"Symptoms","pos":[0,8]}]},{"pos":[742,942],"content":"A memory leak occurs when making native and managed code transitions, runtime state such as thread culture is not restored, or errors occur in <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.SafeHandle&gt;</ph> cleanup.","source":"A memory leak occurs when making native and managed code transitions, runtime state such as thread culture is not restored, or errors occur in <xref:System.Runtime.InteropServices.SafeHandle> cleanup."},{"pos":[951,956],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"content":"An unexpected error occurred while cleaning up temporary structures.","pos":[960,1028]},{"pos":[1037,1047],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"pos":[1051,1182],"content":"Review all <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.SafeHandle&gt;</ph> destructor, finalizer, and custom marshaler implementations for errors.","source":"Review all <xref:System.Runtime.InteropServices.SafeHandle> destructor, finalizer, and custom marshaler implementations for errors."},{"pos":[1191,1212],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"content":"This MDA has no effect on the CLR.","pos":[1216,1250]},{"pos":[1259,1265],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"A message reporting the operation that failed during cleanup.","pos":[1269,1330]},{"pos":[1339,1352],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[1473,1481],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1544,1697],"content":"<bpt id=\"p1\">[</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept>","source":"[Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)"},{"pos":[1700,1775],"content":"<bpt id=\"p1\">[</bpt>Interop Marshaling<ept id=\"p1\">](../../../docs/framework/interop/interop-marshaling.md)</ept>","source":"[Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)"}]}