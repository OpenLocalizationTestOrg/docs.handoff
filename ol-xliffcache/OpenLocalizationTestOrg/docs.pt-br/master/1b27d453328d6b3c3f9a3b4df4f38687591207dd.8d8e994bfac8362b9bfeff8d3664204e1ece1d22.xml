{"content":"---\ntitle: \"Single-Table Queries (LINQ to DataSet) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 0b74bcf8-3f87-449f-bff7-6bcb0d69d212\ncaps.latest.revision: 3\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Single-Table Queries (LINQ to DataSet)\n[!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] queries work on data sources that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or the <xref:System.Linq.IQueryable%601> interface. The <xref:System.Data.DataTable> class does not implement either interface, so you must call the <xref:System.Data.DataTableExtensions.AsEnumerable%2A> method if you want to use the <xref:System.Data.DataTable> as a source in the `From` clause of a [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] query.  \n  \n The following example gets all the online orders from the SalesOrderHeader table and outputs the order ID, order date, and order number to the console.  \n  \n [!code-csharp[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#where1)]   \n [!code-vb[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#where1)] \n  \n The local variable query is initialized with a query expression, which operates on one or more information sources by applying one or more query operators from either the standard query operators or, in the case of [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], operators specific to the <xref:System.Data.DataSet> class. The query expression in the previous example uses two of the standard query operators: `Where` and `Select`.  \n  \n The `Where` clause filters the sequence based on a condition, in this case that the `OnlineOrderFlag` is set to `true`. The `Select` operator allocates and returns an enumerable object that captures the arguments passed to the operator. In this above example, an anonymous type is created with three properties: `SalesOrderID`, `OrderDate`, and `SalesOrderNumber`. The values of these three properties are set to the values of the `SalesOrderID`, `OrderDate`, and `SalesOrderNumber` columns from the `SalesOrderHeader` table.  \n  \n The `foreach` loop then enumerates the enumerable object returned by `Select` and yields the query results. Because query is an <xref:System.Linq.Enumerable> type, which implements <xref:System.Collections.Generic.IEnumerable%601>, the evaluation of the query is deferred until the query variable is iterated over using the `foreach` loop. Deferred query evaluation allows queries to be kept as values that can be evaluated multiple times, each time yielding potentially different results.  \n  \n The <xref:System.Data.DataRowExtensions.Field%2A> method provides access to the column values of a <xref:System.Data.DataRow> and the <xref:System.Data.DataRowExtensions.SetField%2A> (not shown in the previous example) sets column values in a <xref:System.Data.DataRow>. Both the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method handle nullable types, so you do not have to explicitly check for null values. Both methods are generic methods, also, which means you do not have to cast the return type. You could use the pre-existing column accessor in <xref:System.Data.DataRow> (for example, `o[\"OrderDate\"]`), but doing so would require you to cast the return object to the appropriate type.  If the column is nullable you have to check if the value is null by using the <xref:System.Data.DataRow.IsNull%2A> method. For more information, see [Generic Field and SetField Methods](../../../../docs/framework/data/adonet/generic-field-and-setfield-methods-linq-to-dataset.md).  \n  \n Note that the data type specified in the generic parameter `T` of the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method must match the type of the underlying value or an <xref:System.InvalidCastException> will be thrown. The specified column name must also match the name of a column in the <xref:System.Data.DataSet> or an <xref:System.ArgumentException> will be thrown. In both cases, the exception is thrown at run time data enumeration when the query is executed.  \n  \n## See Also  \n [Cross-Table Queries](../../../../docs/framework/data/adonet/cross-table-queries-linq-to-dataset.md)   \n [Querying Typed DataSets](../../../../docs/framework/data/adonet/querying-typed-datasets.md)   \n [Generic Field and SetField Methods](../../../../docs/framework/data/adonet/generic-field-and-setfield-methods-linq-to-dataset.md)","nodes":[{"pos":[4,369],"nodes":[{"content":"Single-Table Queries (LINQ to DataSet) | Microsoft Docs","nodes":[{"pos":[0,55],"content":"Single-Table Queries (LINQ to DataSet) | Microsoft Docs","nodes":[{"content":"Single-Table Queries (LINQ to DataSet) | Microsoft Docs","pos":[0,55]}]}],"pos":[6,64],"yaml":true}],"content":"title: \"Single-Table Queries (LINQ to DataSet) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 0b74bcf8-3f87-449f-bff7-6bcb0d69d212\ncaps.latest.revision: 3\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","yamlblock":true},{"pos":[376,414],"content":"Single-Table Queries (LINQ to DataSet)","linkify":"Single-Table Queries (LINQ to DataSet)","nodes":[{"content":"Single-Table Queries (LINQ to DataSet)","pos":[0,38]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)]</ph> queries work on data sources that implement the <ph id=\"ph2\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> interface or the <ph id=\"ph3\">&lt;xref:System.Linq.IQueryable%601&gt;</ph> interface.","pos":[415,640],"source":"[!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] queries work on data sources that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or the <xref:System.Linq.IQueryable%601> interface."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataTable&gt;</ph> class does not implement either interface, so you must call the <ph id=\"ph2\">&lt;xref:System.Data.DataTableExtensions.AsEnumerable%2A&gt;</ph> method if you want to use the <ph id=\"ph3\">&lt;xref:System.Data.DataTable&gt;</ph> as a source in the <ph id=\"ph4\">`From`</ph> clause of a <ph id=\"ph5\">[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]</ph> query.","pos":[641,956],"source":" The <xref:System.Data.DataTable> class does not implement either interface, so you must call the <xref:System.Data.DataTableExtensions.AsEnumerable%2A> method if you want to use the <xref:System.Data.DataTable> as a source in the `From` clause of a [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] query."},{"content":"The following example gets all the online orders from the SalesOrderHeader table and outputs the order ID, order date, and order number to the console.","pos":[963,1114]},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DP LINQ to DataSet Examples#Where1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#where1)</ept><ept id=\"p1\">]</ept>","pos":[1121,1277],"source":"[!code-csharp[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#where1)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>DP LINQ to DataSet Examples#Where1<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#where1)</ept><ept id=\"p1\">]</ept>","pos":[1282,1439],"source":"[!code-vb[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#where1)]"},{"content":"The local variable query is initialized with a query expression, which operates on one or more information sources by applying one or more query operators from either the standard query operators or, in the case of <ph id=\"ph1\">[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]</ph>, operators specific to the <ph id=\"ph2\">&lt;xref:System.Data.DataSet&gt;</ph> class.","pos":[1445,1786],"source":"The local variable query is initialized with a query expression, which operates on one or more information sources by applying one or more query operators from either the standard query operators or, in the case of [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], operators specific to the <xref:System.Data.DataSet> class."},{"content":"The query expression in the previous example uses two of the standard query operators: <ph id=\"ph1\">`Where`</ph> and <ph id=\"ph2\">`Select`</ph>.","pos":[1787,1895],"source":" The query expression in the previous example uses two of the standard query operators: `Where` and `Select`."},{"content":"The <ph id=\"ph1\">`Where`</ph> clause filters the sequence based on a condition, in this case that the <ph id=\"ph2\">`OnlineOrderFlag`</ph> is set to <ph id=\"ph3\">`true`</ph>.","pos":[1902,2021],"source":"The `Where` clause filters the sequence based on a condition, in this case that the `OnlineOrderFlag` is set to `true`."},{"content":"The <ph id=\"ph1\">`Select`</ph> operator allocates and returns an enumerable object that captures the arguments passed to the operator.","pos":[2022,2138],"source":" The `Select` operator allocates and returns an enumerable object that captures the arguments passed to the operator."},{"content":"In this above example, an anonymous type is created with three properties: <ph id=\"ph1\">`SalesOrderID`</ph>, <ph id=\"ph2\">`OrderDate`</ph>, and <ph id=\"ph3\">`SalesOrderNumber`</ph>.","pos":[2139,2266],"source":" In this above example, an anonymous type is created with three properties: `SalesOrderID`, `OrderDate`, and `SalesOrderNumber`."},{"content":"The values of these three properties are set to the values of the <ph id=\"ph1\">`SalesOrderID`</ph>, <ph id=\"ph2\">`OrderDate`</ph>, and <ph id=\"ph3\">`SalesOrderNumber`</ph> columns from the <ph id=\"ph4\">`SalesOrderHeader`</ph> table.","pos":[2267,2427],"source":" The values of these three properties are set to the values of the `SalesOrderID`, `OrderDate`, and `SalesOrderNumber` columns from the `SalesOrderHeader` table."},{"content":"The <ph id=\"ph1\">`foreach`</ph> loop then enumerates the enumerable object returned by <ph id=\"ph2\">`Select`</ph> and yields the query results.","pos":[2434,2541],"source":"The `foreach` loop then enumerates the enumerable object returned by `Select` and yields the query results."},{"content":"Because query is an <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable&gt;</ph> type, which implements <ph id=\"ph2\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph>, the evaluation of the query is deferred until the query variable is iterated over using the <ph id=\"ph3\">`foreach`</ph> loop.","pos":[2542,2773],"source":" Because query is an <xref:System.Linq.Enumerable> type, which implements <xref:System.Collections.Generic.IEnumerable%601>, the evaluation of the query is deferred until the query variable is iterated over using the `foreach` loop."},{"content":"Deferred query evaluation allows queries to be kept as values that can be evaluated multiple times, each time yielding potentially different results.","pos":[2774,2923]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataRowExtensions.Field%2A&gt;</ph> method provides access to the column values of a <ph id=\"ph2\">&lt;xref:System.Data.DataRow&gt;</ph> and the <ph id=\"ph3\">&lt;xref:System.Data.DataRowExtensions.SetField%2A&gt;</ph> (not shown in the previous example) sets column values in a <ph id=\"ph4\">&lt;xref:System.Data.DataRow&gt;</ph>.","pos":[2930,3200],"source":"The <xref:System.Data.DataRowExtensions.Field%2A> method provides access to the column values of a <xref:System.Data.DataRow> and the <xref:System.Data.DataRowExtensions.SetField%2A> (not shown in the previous example) sets column values in a <xref:System.Data.DataRow>."},{"content":"Both the <ph id=\"ph1\">&lt;xref:System.Data.DataRowExtensions.Field%2A&gt;</ph> method and <ph id=\"ph2\">&lt;xref:System.Data.DataRowExtensions.SetField%2A&gt;</ph> method handle nullable types, so you do not have to explicitly check for null values.","pos":[3201,3401],"source":" Both the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method handle nullable types, so you do not have to explicitly check for null values."},{"content":"Both methods are generic methods, also, which means you do not have to cast the return type.","pos":[3402,3494]},{"content":"You could use the pre-existing column accessor in <ph id=\"ph1\">&lt;xref:System.Data.DataRow&gt;</ph> (for example, <ph id=\"ph2\">`o[\"OrderDate\"]`</ph>), but doing so would require you to cast the return object to the appropriate type.","pos":[3495,3686],"source":" You could use the pre-existing column accessor in <xref:System.Data.DataRow> (for example, `o[\"OrderDate\"]`), but doing so would require you to cast the return object to the appropriate type."},{"content":"If the column is nullable you have to check if the value is null by using the <ph id=\"ph1\">&lt;xref:System.Data.DataRow.IsNull%2A&gt;</ph> method.","pos":[3688,3810],"source":"  If the column is nullable you have to check if the value is null by using the <xref:System.Data.DataRow.IsNull%2A> method."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Generic Field and SetField Methods<ept id=\"p1\">](../../../../docs/framework/data/adonet/generic-field-and-setfield-methods-linq-to-dataset.md)</ept>.","pos":[3811,3968],"source":" For more information, see [Generic Field and SetField Methods](../../../../docs/framework/data/adonet/generic-field-and-setfield-methods-linq-to-dataset.md)."},{"content":"Note that the data type specified in the generic parameter <ph id=\"ph1\">`T`</ph> of the <ph id=\"ph2\">&lt;xref:System.Data.DataRowExtensions.Field%2A&gt;</ph> method and <ph id=\"ph3\">&lt;xref:System.Data.DataRowExtensions.SetField%2A&gt;</ph> method must match the type of the underlying value or an <ph id=\"ph4\">&lt;xref:System.InvalidCastException&gt;</ph> will be thrown.","pos":[3975,4258],"source":"Note that the data type specified in the generic parameter `T` of the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method must match the type of the underlying value or an <xref:System.InvalidCastException> will be thrown."},{"content":"The specified column name must also match the name of a column in the <ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph> or an <ph id=\"ph2\">&lt;xref:System.ArgumentException&gt;</ph> will be thrown.","pos":[4259,4409],"source":" The specified column name must also match the name of a column in the <xref:System.Data.DataSet> or an <xref:System.ArgumentException> will be thrown."},{"content":"In both cases, the exception is thrown at run time data enumeration when the query is executed.","pos":[4410,4505]},{"pos":[4514,4522],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Cross-Table Queries<ept id=\"p1\">](../../../../docs/framework/data/adonet/cross-table-queries-linq-to-dataset.md)</ept><ph id=\"ph1\"> </ph>","pos":[4526,4627],"source":"[Cross-Table Queries](../../../../docs/framework/data/adonet/cross-table-queries-linq-to-dataset.md) "},{"content":"<bpt id=\"p1\">[</bpt>Querying Typed DataSets<ept id=\"p1\">](../../../../docs/framework/data/adonet/querying-typed-datasets.md)</ept><ph id=\"ph1\"> </ph>","pos":[4631,4724],"source":"[Querying Typed DataSets](../../../../docs/framework/data/adonet/querying-typed-datasets.md) "},{"content":"<bpt id=\"p1\">[</bpt>Generic Field and SetField Methods<ept id=\"p1\">](../../../../docs/framework/data/adonet/generic-field-and-setfield-methods-linq-to-dataset.md)</ept>","pos":[4728,4858],"source":"[Generic Field and SetField Methods](../../../../docs/framework/data/adonet/generic-field-and-setfield-methods-linq-to-dataset.md)"}]}