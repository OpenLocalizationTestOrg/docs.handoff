{"content":"---\ntitle: \"Implementing the UI Automation Window Control Pattern\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"control patterns, Window\"\n  - \"UI Automation, Window control pattern\"\n  - \"Window control pattern\"\nms.assetid: a28cb286-296e-4a62-b4cb-55ad636ebccc\n---\n# Implementing the UI Automation Window Control Pattern\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IWindowProvider>, including information about <xref:System.Windows.Automation.WindowPattern> properties, methods, and events. Links to additional references are listed at the end of the topic.  \n  \n The <xref:System.Windows.Automation.WindowPattern> control pattern is used to support controls that provide fundamental window-based functionality within a traditional [!INCLUDE[TLA#tla_gui](../../../includes/tlasharptla-gui-md.md)]. Examples of controls that must implement this control pattern include top-level application windows, [!INCLUDE[TLA#tla_mdi](../../../includes/tlasharptla-mdi-md.md)] child windows, resizable split pane controls, modal dialogs and balloon help windows.  \n  \n<a name=\"Implementation_Guidelines_and_Conventions\"></a>   \n## Implementation Guidelines and Conventions  \n When implementing the Window control pattern, note the following guidelines and conventions:  \n  \n-   To support the ability to modify both window size and screen position using UI Automation, a control must implement <xref:System.Windows.Automation.Provider.ITransformProvider> in addition to <xref:System.Windows.Automation.Provider.IWindowProvider>.  \n  \n-   Controls that contain title bars and title bar elements that enable the control to be moved, resized, maximized, minimized, or closed are typically required to implement <xref:System.Windows.Automation.Provider.IWindowProvider>.  \n  \n-   Controls such as tooltip pop-ups and combo box or menu drop-downs do not typically implement <xref:System.Windows.Automation.Provider.IWindowProvider>.  \n  \n-   Balloon help windows are differentiated from basic tooltip pop-ups by the provision of a window-like Close button.  \n  \n-   Full-screen mode is not supported by IWindowProvider as it is feature-specific to an application and is not typical window behavior.  \n  \n<a name=\"Required_Members_for_IWindowProvider\"></a>   \n## Required Members for IWindowProvider  \n The following properties, methods, and events are required for the IWindowProvider interface.  \n  \n|Required member|Member type|Notes|  \n|---------------------|-----------------|-----------|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.InteractionState%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.IsModal%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.IsTopmost%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.Maximizable%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.Minimizable%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.VisualState%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.Close%2A>|Method|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.SetVisualState%2A>|Method|None|  \n|<xref:System.Windows.Automation.Provider.IWindowProvider.WaitForInputIdle%2A>|Method|None|  \n|<xref:System.Windows.Automation.WindowPattern.WindowClosedEvent>|Event|None|  \n|<xref:System.Windows.Automation.WindowPattern.WindowOpenedEvent>|Event|None|  \n|<xref:System.Windows.Automation.WindowInteractionState>|Event|Is not guaranteed to be <xref:System.Windows.Automation.WindowInteractionState.ReadyForUserInteraction>|  \n  \n<a name=\"Exceptions\"></a>   \n## Exceptions  \n Providers must throw the following exceptions.  \n  \n|Exception type|Condition|  \n|--------------------|---------------|  \n|<xref:System.InvalidOperationException>|<xref:System.Windows.Automation.Provider.IWindowProvider.SetVisualState%2A><br /><br /> -   When a control does not support a requested behavior.|  \n|<xref:System.ArgumentOutOfRangeException>|<xref:System.Windows.Automation.Provider.IWindowProvider.WaitForInputIdle%2A><br /><br /> -   When the parameter is not a valid number.|  \n  \n## See also\n\n- [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)\n- [Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)\n- [UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)\n- [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)\n- [Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)\n","nodes":[{"pos":[4,263],"embed":true,"restype":"x-metadata","content":"title: \"Implementing the UI Automation Window Control Pattern\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"control patterns, Window\"\n  - \"UI Automation, Window control pattern\"\n  - \"Window control pattern\"\nms.assetid: a28cb286-296e-4a62-b4cb-55ad636ebccc","nodes":[{"content":"Implementing the UI Automation Window Control Pattern","nodes":[{"pos":[0,53],"content":"Implementing the UI Automation Window Control Pattern","nodes":[{"content":"Implementing the UI Automation Window Control Pattern","pos":[0,53]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[270,323],"content":"Implementing the UI Automation Window Control Pattern","linkify":"Implementing the UI Automation Window Control Pattern","nodes":[{"content":"Implementing the UI Automation Window Control Pattern","pos":[0,53]}]},{"pos":[326,789],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,461],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"content":"This topic introduces guidelines and conventions for implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IWindowProvider&gt;</ph>, including information about <ph id=\"ph2\">&lt;xref:System.Windows.Automation.WindowPattern&gt;</ph> properties, methods, and events.","pos":[796,1028],"source":"This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IWindowProvider>, including information about <xref:System.Windows.Automation.WindowPattern> properties, methods, and events."},{"content":"Links to additional references are listed at the end of the topic.","pos":[1029,1095]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Automation.WindowPattern&gt;</ph> control pattern is used to support controls that provide fundamental window-based functionality within a traditional <ph id=\"ph2\">[!INCLUDE[TLA#tla_gui](../../../includes/tlasharptla-gui-md.md)]</ph>.","pos":[1102,1335],"source":"The <xref:System.Windows.Automation.WindowPattern> control pattern is used to support controls that provide fundamental window-based functionality within a traditional [!INCLUDE[TLA#tla_gui](../../../includes/tlasharptla-gui-md.md)]."},{"content":"Examples of controls that must implement this control pattern include top-level application windows, <ph id=\"ph1\">[!INCLUDE[TLA#tla_mdi](../../../includes/tlasharptla-mdi-md.md)]</ph> child windows, resizable split pane controls, modal dialogs and balloon help windows.","pos":[1336,1587],"source":" Examples of controls that must implement this control pattern include top-level application windows, [!INCLUDE[TLA#tla_mdi](../../../includes/tlasharptla-mdi-md.md)] child windows, resizable split pane controls, modal dialogs and balloon help windows."},{"pos":[1656,1697],"content":"Implementation Guidelines and Conventions","linkify":"Implementation Guidelines and Conventions","nodes":[{"content":"Implementation Guidelines and Conventions","pos":[0,41]}]},{"content":"When implementing the Window control pattern, note the following guidelines and conventions:","pos":[1701,1793]},{"pos":[1803,2053],"content":"To support the ability to modify both window size and screen position using UI Automation, a control must implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.ITransformProvider&gt;</ph> in addition to <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.IWindowProvider&gt;</ph>.","source":"To support the ability to modify both window size and screen position using UI Automation, a control must implement <xref:System.Windows.Automation.Provider.ITransformProvider> in addition to <xref:System.Windows.Automation.Provider.IWindowProvider>."},{"pos":[2063,2291],"content":"Controls that contain title bars and title bar elements that enable the control to be moved, resized, maximized, minimized, or closed are typically required to implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IWindowProvider&gt;</ph>.","source":"Controls that contain title bars and title bar elements that enable the control to be moved, resized, maximized, minimized, or closed are typically required to implement <xref:System.Windows.Automation.Provider.IWindowProvider>."},{"pos":[2301,2452],"content":"Controls such as tooltip pop-ups and combo box or menu drop-downs do not typically implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IWindowProvider&gt;</ph>.","source":"Controls such as tooltip pop-ups and combo box or menu drop-downs do not typically implement <xref:System.Windows.Automation.Provider.IWindowProvider>."},{"content":"Balloon help windows are differentiated from basic tooltip pop-ups by the provision of a window-like Close button.","pos":[2462,2576]},{"content":"Full-screen mode is not supported by IWindowProvider as it is feature-specific to an application and is not typical window behavior.","pos":[2586,2718]},{"pos":[2782,2818],"content":"Required Members for IWindowProvider","linkify":"Required Members for IWindowProvider","nodes":[{"content":"Required Members for IWindowProvider","pos":[0,36]}]},{"content":"The following properties, methods, and events are required for the IWindowProvider interface.","pos":[2822,2915]},{"content":"Required member","pos":[2922,2937]},{"content":"Member type","pos":[2938,2949]},{"content":"Notes","pos":[2950,2955]},{"content":"Property","pos":[3094,3102]},{"content":"None","pos":[3103,3107]},{"content":"Property","pos":[3181,3189]},{"content":"None","pos":[3190,3194]},{"content":"Property","pos":[3270,3278]},{"content":"None","pos":[3279,3283]},{"content":"Property","pos":[3361,3369]},{"content":"None","pos":[3370,3374]},{"content":"Property","pos":[3452,3460]},{"content":"None","pos":[3461,3465]},{"content":"Property","pos":[3543,3551]},{"content":"None","pos":[3552,3556]},{"content":"Method","pos":[3628,3634]},{"content":"None","pos":[3635,3639]},{"content":"Method","pos":[3720,3726]},{"content":"None","pos":[3727,3731]},{"content":"Method","pos":[3814,3820]},{"content":"None","pos":[3821,3825]},{"content":"Event","pos":[3895,3900]},{"content":"None","pos":[3901,3905]},{"content":"Event","pos":[3975,3980]},{"content":"None","pos":[3981,3985]},{"content":"Event","pos":[4046,4051]},{"pos":[4052,4155],"content":"Is not guaranteed to be <ph id=\"ph1\">&lt;xref:System.Windows.Automation.WindowInteractionState.ReadyForUserInteraction&gt;</ph>","source":"Is not guaranteed to be <xref:System.Windows.Automation.WindowInteractionState.ReadyForUserInteraction>"},{"pos":[4194,4204],"content":"Exceptions","linkify":"Exceptions","nodes":[{"content":"Exceptions","pos":[0,10]}]},{"content":"Providers must throw the following exceptions.","pos":[4208,4254]},{"content":"Exception type","pos":[4261,4275]},{"content":"Condition","pos":[4276,4285]},{"content":"-   When a control does not support a requested behavior.","pos":[4459,4516]},{"content":"-   When the parameter is not a valid number.","pos":[4653,4698]},{"pos":[4708,4716],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4720,4843],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)</ept>","source":"[UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)"},{"pos":[4846,4995],"content":"<bpt id=\"p1\">[</bpt>Support Control Patterns in a UI Automation Provider<ept id=\"p1\">](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)</ept>","source":"[Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)"},{"pos":[4998,5127],"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns for Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)</ept>","source":"[UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)"},{"pos":[5130,5229],"content":"<bpt id=\"p1\">[</bpt>UI Automation Tree Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</ept>","source":"[UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)"},{"pos":[5232,5333],"content":"<bpt id=\"p1\">[</bpt>Use Caching in UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)</ept>","source":"[Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)"}]}