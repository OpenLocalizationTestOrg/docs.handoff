{"content":"---\ntitle: \"Defining and Specifying Faults\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"handling faults [WCF], specifying\"\n  - \"handling faults [WCF], defining\"\nms.assetid: c00c84f1-962d-46a7-b07f-ebc4f80fbfc1\n---\n# Defining and Specifying Faults\nSOAP faults convey error condition information from a service to a client and, in the duplex case, from a client to a service in an interoperable way. This topic discusses when and how to define custom fault content and specify which operations can return them. For more information about how a service, or duplex client, can send those faults and how a client or service application handles these faults, see [Sending and Receiving Faults](../../../docs/framework/wcf/sending-and-receiving-faults.md). For an overview of error handling in Windows Communication Foundation (WCF) applications, see [Specifying and Handling Faults in Contracts and Services](../../../docs/framework/wcf/specifying-and-handling-faults-in-contracts-and-services.md).  \n  \n## Overview  \n Declared SOAP faults are those in which an operation has a <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> that specifies a custom SOAP fault type. Undeclared SOAP faults are those that are not specified in the contract for an operation. This topic helps you identify those error conditions and create a fault contract for your service that clients can use to properly handle those error conditions when notified by custom SOAP faults. The basic tasks are, in order:  \n  \n1.  Define the error conditions that a client of your service should know about.  \n  \n2.  Define the custom content of the SOAP faults for those error conditions.  \n  \n3.  Mark your operations so that the specific SOAP faults that they throw are exposed to clients in WSDL.  \n  \n### Defining Error Conditions That Clients Should Know About  \n SOAP faults are publicly described messages that carry fault information for a particular operation. Because they are described along with other operation messages in WSDL, clients know and, therefore, expect to handle such faults when invoking an operation. But because WCF services are written in managed code, deciding which error conditions in managed code are to be converted into faults and returned to the client provides you the opportunity to separate error conditions and bugs in your service from the formal error conversation you have with a client.  \n  \n For example, the following code example shows an operation that takes two integers and returns another integer. Several exceptions can be thrown here, so when designing the fault contract, you must determine which error conditions are important for your client. In this case, the service should detect the <xref:System.DivideByZeroException?displayProperty=nameWithType> exception.  \n  \n```csharp  \n[ServiceContract]  \npublic class CalculatorService  \n{  \n    [OperationContract]   \n    int Divide(int a, int b)  \n    {  \n      if (b==0) throw new Exception(\"Division by zero!\");  \n      return a/b;  \n    }  \n}  \n```  \n  \n```vb  \n<ServiceContract> _  \nPublic Class CalculatorService  \n    <OperationContract]> _  \n    Public Function Divide(ByVal a As Integer, ByVal b As Integer) _  \n       As Integer  \n      If (b==0) Then   \n            Throw New Exception(\"Division by zero!\")  \n      Return a/b  \n    End Function  \nEnd Class  \n```  \n  \n In the preceding example the operation can either return a custom SOAP fault that is specific to dividing by zero, a custom fault that is specific to math operations but that contains information specific to dividing by zero, multiple faults for several different error situations, or no SOAP fault at all.  \n  \n### Define the Content of Error Conditions  \n Once an error condition has been identified as one that can usefully return a custom SOAP fault, the next step is to define the contents of that fault and ensure that the content structure can be serialized. The code example in the preceding section shows an error specific to a `Divide` operation, but if there are other operations on the `Calculator` service, then a single custom SOAP fault can inform the client of all calculator error conditions, `Divide` included. The following code example shows the creation of a custom SOAP fault, `MathFault`, which can report errors made using all math operations, including `Divide`. While the class can specify an operation (the `Operation` property) and a value that describes the problem (the `ProblemType` property), the class and these properties must be serializable to be transferred to the client in a custom SOAP fault. Therefore, the <xref:System.Runtime.Serialization.DataContractAttribute?displayProperty=nameWithType> and <xref:System.Runtime.Serialization.DataMemberAttribute?displayProperty=nameWithType> attributes are used to make the type and its properties serializable and as interoperable as possible.  \n  \n [!code-csharp[Faults#2](../../../samples/snippets/csharp/VS_Snippets_CFX/faults/cs/service.cs#2)]\n [!code-vb[Faults#2](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faults/vb/service.vb#2)]  \n  \n For more information about how to ensure your data is serializable, see [Specifying Data Transfer in Service Contracts](../../../docs/framework/wcf/feature-details/specifying-data-transfer-in-service-contracts.md). For a list of the serialization support that <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType> provides, see [Types Supported by the Data Contract Serializer](../../../docs/framework/wcf/feature-details/types-supported-by-the-data-contract-serializer.md).  \n  \n### Mark Operations to Establish the Fault Contract  \n Once a serializable data structure that is returned as part of a custom SOAP fault is defined, the last step is to mark your operation contract as throwing a SOAP fault of that type. To do this, use the <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> attribute and pass the type of the custom data type that you have constructed. The following code example shows how to use the <xref:System.ServiceModel.FaultContractAttribute> attribute to specify that the `Divide` operation can return a SOAP fault of type `MathFault`. Other math-based operations can now also specify that they can return a `MathFault`.  \n  \n [!code-csharp[Faults#1](../../../samples/snippets/csharp/VS_Snippets_CFX/faults/cs/service.cs#1)]\n [!code-vb[Faults#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faults/vb/service.vb#1)]  \n  \n An operation can specify that it returns more than one custom fault by marking that operation with more than one <xref:System.ServiceModel.FaultContractAttribute> attribute.  \n  \n The next step, to implement the fault contract in your operation implementation, is described in the topic [Sending and Receiving Faults](../../../docs/framework/wcf/sending-and-receiving-faults.md).  \n  \n#### SOAP, WSDL, and Interoperability Considerations  \n In some circumstances, especially when interoperating with other platforms, it may be important to control the way a fault appears in a SOAP message or the way it is described in the WSDL metadata.  \n  \n The <xref:System.ServiceModel.FaultContractAttribute> attribute has a <xref:System.ServiceModel.FaultContractAttribute.Name%2A> property that allows control of the WSDL fault element name that is generated in the metadata for that fault.  \n  \n According to the SOAP standard, a fault can have an `Action`, a `Code`, and a `Reason`. The `Action` is controlled by the <xref:System.ServiceModel.FaultContractAttribute.Action%2A> property. The <xref:System.ServiceModel.FaultException.Code%2A> property and <xref:System.ServiceModel.FaultException.Reason%2A> property are both properties of the <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> class, which is the parent class of the generic <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType>. The `Code` property includes a <xref:System.ServiceModel.FaultCode.SubCode%2A> member.  \n  \n When accessing non-services that generate faults, certain limitations exist. WCF supports only faults with detail types that the schema describes and that are compatible with data contracts. For example, as mentioned above, WCF does not support faults that use XML attributes in their detail types, or faults with more than one top-level element in the detail section.  \n  \n## See also\n\n- <xref:System.ServiceModel.FaultContractAttribute>\n- <xref:System.Runtime.Serialization.DataContractAttribute>\n- <xref:System.Runtime.Serialization.DataMemberAttribute>\n- [Specifying and Handling Faults in Contracts and Services](../../../docs/framework/wcf/specifying-and-handling-faults-in-contracts-and-services.md)\n- [Sending and Receiving Faults](../../../docs/framework/wcf/sending-and-receiving-faults.md)\n- [How to: Declare Faults in Service Contracts](../../../docs/framework/wcf/how-to-declare-faults-in-service-contracts.md)\n- [Understanding Protection Level](../../../docs/framework/wcf/understanding-protection-level.md)\n- [How to: Set the ProtectionLevel Property](../../../docs/framework/wcf/how-to-set-the-protectionlevel-property.md)\n- [Specifying Data Transfer in Service Contracts](../../../docs/framework/wcf/feature-details/specifying-data-transfer-in-service-contracts.md)\n","nodes":[{"pos":[4,248],"embed":true,"restype":"x-metadata","content":"title: \"Defining and Specifying Faults\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"handling faults [WCF], specifying\"\n  - \"handling faults [WCF], defining\"\nms.assetid: c00c84f1-962d-46a7-b07f-ebc4f80fbfc1","nodes":[{"content":"Defining and Specifying Faults","nodes":[{"pos":[0,30],"content":"Defining and Specifying Faults","nodes":[{"content":"Defining and Specifying Faults","pos":[0,30]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[255,285],"content":"Defining and Specifying Faults","linkify":"Defining and Specifying Faults","nodes":[{"content":"Defining and Specifying Faults","pos":[0,30]}]},{"content":"SOAP faults convey error condition information from a service to a client and, in the duplex case, from a client to a service in an interoperable way.","pos":[286,436]},{"content":"This topic discusses when and how to define custom fault content and specify which operations can return them.","pos":[437,547]},{"content":"For more information about how a service, or duplex client, can send those faults and how a client or service application handles these faults, see <bpt id=\"p1\">[</bpt>Sending and Receiving Faults<ept id=\"p1\">](../../../docs/framework/wcf/sending-and-receiving-faults.md)</ept>.","pos":[548,788],"source":" For more information about how a service, or duplex client, can send those faults and how a client or service application handles these faults, see [Sending and Receiving Faults](../../../docs/framework/wcf/sending-and-receiving-faults.md)."},{"content":"For an overview of error handling in Windows Communication Foundation (WCF) applications, see <bpt id=\"p1\">[</bpt>Specifying and Handling Faults in Contracts and Services<ept id=\"p1\">](../../../docs/framework/wcf/specifying-and-handling-faults-in-contracts-and-services.md)</ept>.","pos":[789,1031],"source":" For an overview of error handling in Windows Communication Foundation (WCF) applications, see [Specifying and Handling Faults in Contracts and Services](../../../docs/framework/wcf/specifying-and-handling-faults-in-contracts-and-services.md)."},{"pos":[1040,1048],"content":"Overview","linkify":"Overview","nodes":[{"content":"Overview","pos":[0,8]}]},{"content":"Declared SOAP faults are those in which an operation has a <ph id=\"ph1\">&lt;xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType&gt;</ph> that specifies a custom SOAP fault type.","pos":[1052,1230],"source":"Declared SOAP faults are those in which an operation has a <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> that specifies a custom SOAP fault type."},{"content":"Undeclared SOAP faults are those that are not specified in the contract for an operation.","pos":[1231,1320]},{"content":"This topic helps you identify those error conditions and create a fault contract for your service that clients can use to properly handle those error conditions when notified by custom SOAP faults.","pos":[1321,1518]},{"content":"The basic tasks are, in order:","pos":[1519,1549]},{"content":"Define the error conditions that a client of your service should know about.","pos":[1559,1635]},{"content":"Define the custom content of the SOAP faults for those error conditions.","pos":[1645,1717]},{"content":"Mark your operations so that the specific SOAP faults that they throw are exposed to clients in WSDL.","pos":[1727,1828]},{"pos":[1838,1894],"content":"Defining Error Conditions That Clients Should Know About","linkify":"Defining Error Conditions That Clients Should Know About","nodes":[{"content":"Defining Error Conditions That Clients Should Know About","pos":[0,56]}]},{"content":"SOAP faults are publicly described messages that carry fault information for a particular operation.","pos":[1898,1998]},{"content":"Because they are described along with other operation messages in WSDL, clients know and, therefore, expect to handle such faults when invoking an operation.","pos":[1999,2156]},{"content":"But because WCF services are written in managed code, deciding which error conditions in managed code are to be converted into faults and returned to the client provides you the opportunity to separate error conditions and bugs in your service from the formal error conversation you have with a client.","pos":[2157,2459]},{"content":"For example, the following code example shows an operation that takes two integers and returns another integer.","pos":[2466,2577]},{"content":"Several exceptions can be thrown here, so when designing the fault contract, you must determine which error conditions are important for your client.","pos":[2578,2727]},{"content":"In this case, the service should detect the <ph id=\"ph1\">&lt;xref:System.DivideByZeroException?displayProperty=nameWithType&gt;</ph> exception.","pos":[2728,2847],"source":" In this case, the service should detect the <xref:System.DivideByZeroException?displayProperty=nameWithType> exception."},{"content":"In the preceding example the operation can either return a custom SOAP fault that is specific to dividing by zero, a custom fault that is specific to math operations but that contains information specific to dividing by zero, multiple faults for several different error situations, or no SOAP fault at all.","pos":[3411,3717]},{"pos":[3727,3765],"content":"Define the Content of Error Conditions","linkify":"Define the Content of Error Conditions","nodes":[{"content":"Define the Content of Error Conditions","pos":[0,38]}]},{"content":"Once an error condition has been identified as one that can usefully return a custom SOAP fault, the next step is to define the contents of that fault and ensure that the content structure can be serialized.","pos":[3769,3976]},{"content":"The code example in the preceding section shows an error specific to a <ph id=\"ph1\">`Divide`</ph> operation, but if there are other operations on the <ph id=\"ph2\">`Calculator`</ph> service, then a single custom SOAP fault can inform the client of all calculator error conditions, <ph id=\"ph3\">`Divide`</ph> included.","pos":[3977,4239],"source":" The code example in the preceding section shows an error specific to a `Divide` operation, but if there are other operations on the `Calculator` service, then a single custom SOAP fault can inform the client of all calculator error conditions, `Divide` included."},{"content":"The following code example shows the creation of a custom SOAP fault, <ph id=\"ph1\">`MathFault`</ph>, which can report errors made using all math operations, including <ph id=\"ph2\">`Divide`</ph>.","pos":[4240,4398],"source":" The following code example shows the creation of a custom SOAP fault, `MathFault`, which can report errors made using all math operations, including `Divide`."},{"content":"While the class can specify an operation (the <ph id=\"ph1\">`Operation`</ph> property) and a value that describes the problem (the <ph id=\"ph2\">`ProblemType`</ph> property), the class and these properties must be serializable to be transferred to the client in a custom SOAP fault.","pos":[4399,4643],"source":" While the class can specify an operation (the `Operation` property) and a value that describes the problem (the `ProblemType` property), the class and these properties must be serializable to be transferred to the client in a custom SOAP fault."},{"content":"Therefore, the <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataContractAttribute?displayProperty=nameWithType&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Runtime.Serialization.DataMemberAttribute?displayProperty=nameWithType&gt;</ph> attributes are used to make the type and its properties serializable and as interoperable as possible.","pos":[4644,4937],"source":" Therefore, the <xref:System.Runtime.Serialization.DataContractAttribute?displayProperty=nameWithType> and <xref:System.Runtime.Serialization.DataMemberAttribute?displayProperty=nameWithType> attributes are used to make the type and its properties serializable and as interoperable as possible."},{"content":"For more information about how to ensure your data is serializable, see <bpt id=\"p1\">[</bpt>Specifying Data Transfer in Service Contracts<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/specifying-data-transfer-in-service-contracts.md)</ept>.","pos":[5148,5362],"source":"For more information about how to ensure your data is serializable, see [Specifying Data Transfer in Service Contracts](../../../docs/framework/wcf/feature-details/specifying-data-transfer-in-service-contracts.md)."},{"content":"For a list of the serialization support that <ph id=\"ph1\">&lt;xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType&gt;</ph> provides, see <bpt id=\"p1\">[</bpt>Types Supported by the Data Contract Serializer<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/types-supported-by-the-data-contract-serializer.md)</ept>.","pos":[5363,5656],"source":" For a list of the serialization support that <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType> provides, see [Types Supported by the Data Contract Serializer](../../../docs/framework/wcf/feature-details/types-supported-by-the-data-contract-serializer.md)."},{"pos":[5666,5713],"content":"Mark Operations to Establish the Fault Contract","linkify":"Mark Operations to Establish the Fault Contract","nodes":[{"content":"Mark Operations to Establish the Fault Contract","pos":[0,47]}]},{"content":"Once a serializable data structure that is returned as part of a custom SOAP fault is defined, the last step is to mark your operation contract as throwing a SOAP fault of that type.","pos":[5717,5899]},{"content":"To do this, use the <ph id=\"ph1\">&lt;xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType&gt;</ph> attribute and pass the type of the custom data type that you have constructed.","pos":[5900,6077],"source":" To do this, use the <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> attribute and pass the type of the custom data type that you have constructed."},{"content":"The following code example shows how to use the <ph id=\"ph1\">&lt;xref:System.ServiceModel.FaultContractAttribute&gt;</ph> attribute to specify that the <ph id=\"ph2\">`Divide`</ph> operation can return a SOAP fault of type <ph id=\"ph3\">`MathFault`</ph>.","pos":[6078,6269],"source":" The following code example shows how to use the <xref:System.ServiceModel.FaultContractAttribute> attribute to specify that the `Divide` operation can return a SOAP fault of type `MathFault`."},{"content":"Other math-based operations can now also specify that they can return a <ph id=\"ph1\">`MathFault`</ph>.","pos":[6270,6354],"source":" Other math-based operations can now also specify that they can return a `MathFault`."},{"pos":[6565,6738],"content":"An operation can specify that it returns more than one custom fault by marking that operation with more than one <ph id=\"ph1\">&lt;xref:System.ServiceModel.FaultContractAttribute&gt;</ph> attribute.","source":"An operation can specify that it returns more than one custom fault by marking that operation with more than one <xref:System.ServiceModel.FaultContractAttribute> attribute."},{"pos":[6745,6944],"content":"The next step, to implement the fault contract in your operation implementation, is described in the topic <bpt id=\"p1\">[</bpt>Sending and Receiving Faults<ept id=\"p1\">](../../../docs/framework/wcf/sending-and-receiving-faults.md)</ept>.","source":"The next step, to implement the fault contract in your operation implementation, is described in the topic [Sending and Receiving Faults](../../../docs/framework/wcf/sending-and-receiving-faults.md)."},{"pos":[6955,7002],"content":"SOAP, WSDL, and Interoperability Considerations","linkify":"SOAP, WSDL, and Interoperability Considerations","nodes":[{"content":"SOAP, WSDL, and Interoperability Considerations","pos":[0,47]}]},{"content":"In some circumstances, especially when interoperating with other platforms, it may be important to control the way a fault appears in a SOAP message or the way it is described in the WSDL metadata.","pos":[7006,7203]},{"pos":[7210,7447],"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.FaultContractAttribute&gt;</ph> attribute has a <ph id=\"ph2\">&lt;xref:System.ServiceModel.FaultContractAttribute.Name%2A&gt;</ph> property that allows control of the WSDL fault element name that is generated in the metadata for that fault.","source":"The <xref:System.ServiceModel.FaultContractAttribute> attribute has a <xref:System.ServiceModel.FaultContractAttribute.Name%2A> property that allows control of the WSDL fault element name that is generated in the metadata for that fault."},{"content":"According to the SOAP standard, a fault can have an <ph id=\"ph1\">`Action`</ph>, a <ph id=\"ph2\">`Code`</ph>, and a <ph id=\"ph3\">`Reason`</ph>.","pos":[7454,7541],"source":"According to the SOAP standard, a fault can have an `Action`, a `Code`, and a `Reason`."},{"content":"The <ph id=\"ph1\">`Action`</ph> is controlled by the <ph id=\"ph2\">&lt;xref:System.ServiceModel.FaultContractAttribute.Action%2A&gt;</ph> property.","pos":[7542,7645],"source":" The `Action` is controlled by the <xref:System.ServiceModel.FaultContractAttribute.Action%2A> property."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.FaultException.Code%2A&gt;</ph> property and <ph id=\"ph2\">&lt;xref:System.ServiceModel.FaultException.Reason%2A&gt;</ph> property are both properties of the <ph id=\"ph3\">&lt;xref:System.ServiceModel.FaultException?displayProperty=nameWithType&gt;</ph> class, which is the parent class of the generic <ph id=\"ph4\">&lt;xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType&gt;</ph>.","pos":[7646,7995],"source":" The <xref:System.ServiceModel.FaultException.Code%2A> property and <xref:System.ServiceModel.FaultException.Reason%2A> property are both properties of the <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> class, which is the parent class of the generic <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType>."},{"content":"The <ph id=\"ph1\">`Code`</ph> property includes a <ph id=\"ph2\">&lt;xref:System.ServiceModel.FaultCode.SubCode%2A&gt;</ph> member.","pos":[7996,8082],"source":" The `Code` property includes a <xref:System.ServiceModel.FaultCode.SubCode%2A> member."},{"content":"When accessing non-services that generate faults, certain limitations exist.","pos":[8089,8165]},{"content":"WCF supports only faults with detail types that the schema describes and that are compatible with data contracts.","pos":[8166,8279]},{"content":"For example, as mentioned above, WCF does not support faults that use XML attributes in their detail types, or faults with more than one top-level element in the detail section.","pos":[8280,8457]},{"pos":[8466,8474],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[8648,8795],"content":"<bpt id=\"p1\">[</bpt>Specifying and Handling Faults in Contracts and Services<ept id=\"p1\">](../../../docs/framework/wcf/specifying-and-handling-faults-in-contracts-and-services.md)</ept>","source":"[Specifying and Handling Faults in Contracts and Services](../../../docs/framework/wcf/specifying-and-handling-faults-in-contracts-and-services.md)"},{"pos":[8798,8889],"content":"<bpt id=\"p1\">[</bpt>Sending and Receiving Faults<ept id=\"p1\">](../../../docs/framework/wcf/sending-and-receiving-faults.md)</ept>","source":"[Sending and Receiving Faults](../../../docs/framework/wcf/sending-and-receiving-faults.md)"},{"pos":[8892,9012],"content":"<bpt id=\"p1\">[</bpt>How to: Declare Faults in Service Contracts<ept id=\"p1\">](../../../docs/framework/wcf/how-to-declare-faults-in-service-contracts.md)</ept>","source":"[How to: Declare Faults in Service Contracts](../../../docs/framework/wcf/how-to-declare-faults-in-service-contracts.md)"},{"pos":[9015,9110],"content":"<bpt id=\"p1\">[</bpt>Understanding Protection Level<ept id=\"p1\">](../../../docs/framework/wcf/understanding-protection-level.md)</ept>","source":"[Understanding Protection Level](../../../docs/framework/wcf/understanding-protection-level.md)"},{"pos":[9113,9227],"content":"<bpt id=\"p1\">[</bpt>How to: Set the ProtectionLevel Property<ept id=\"p1\">](../../../docs/framework/wcf/how-to-set-the-protectionlevel-property.md)</ept>","source":"[How to: Set the ProtectionLevel Property](../../../docs/framework/wcf/how-to-set-the-protectionlevel-property.md)"},{"pos":[9230,9371],"content":"<bpt id=\"p1\">[</bpt>Specifying Data Transfer in Service Contracts<ept id=\"p1\">](../../../docs/framework/wcf/feature-details/specifying-data-transfer-in-service-contracts.md)</ept>","source":"[Specifying Data Transfer in Service Contracts](../../../docs/framework/wcf/feature-details/specifying-data-transfer-in-service-contracts.md)"}]}