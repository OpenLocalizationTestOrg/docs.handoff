{"content":"---\ntitle: \"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords:\n  - \"hosting Windows Forms control in WPF [WPF]\"\nms.assetid: 1aef42cb-4cfb-44b4-9a7a-c02632d3d9c7\n---\n# Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML\n[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides many controls with a rich feature set. However, you may sometimes want to use [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls on your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pages. For example, you may have a substantial investment in existing [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls, or you may have a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control that provides unique functionality.  \n  \n This walkthrough shows you how to host a Windows Forms <xref:System.Windows.Forms.MaskedTextBox?displayProperty=nameWithType> control on a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] page by using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].  \n  \n For a complete code listing of the tasks shown in this walkthrough, see [Hosting a Windows Forms Control in WPF by Using XAML Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Migration%20and%20Interoperability/HostingWfInWpfWithXaml).\n  \n## Prerequisites  \n\nYou need Visual Studio to complete this walkthrough.  \n  \n## Hosting the Windows Forms Control  \n  \n#### To host the MaskedTextBox control  \n  \n1.  Create a WPF Application project named `HostingWfInWpfWithXaml`.  \n  \n2.  Add references to the following assemblies.  \n  \n    -   WindowsFormsIntegration  \n  \n    -   System.Windows.Forms  \n  \n3.  Open MainWindow.xaml in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)].  \n  \n4.  In the <xref:System.Windows.Window> element, add the following namespace mapping. The `wf` namespace mapping establishes a reference to the assembly that contains the Windows Forms control.  \n  \n    ```xaml  \n    xmlns:wf=\"clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms\"  \n    ```  \n  \n5.  In the <xref:System.Windows.Controls.Grid> element add the following XAML.  \n  \n     The <xref:System.Windows.Forms.MaskedTextBox> control is created as a child of the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control.  \n  \n     [!code-xaml[HostingWfInWpfWithXaml#3](~/samples/snippets/csharp/VS_Snippets_Wpf/HostingWfInWpfWithXaml/CSharp/HostingWfInWpf/Window1.xaml#3)]  \n  \n6.  Press F5 to build and run the application.  \n  \n## See also\n\n- <xref:System.Windows.Forms.Integration.ElementHost>\n- <xref:System.Windows.Forms.Integration.WindowsFormsHost>\n- [Design XAML in Visual Studio](/visualstudio/designers/designing-xaml-in-visual-studio)\n- [Walkthrough: Hosting a Windows Forms Control in WPF](walkthrough-hosting-a-windows-forms-control-in-wpf.md)\n- [Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)\n- [Walkthrough: Hosting a WPF Composite Control in Windows Forms](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)\n- [Windows Forms Controls and Equivalent WPF Controls](windows-forms-controls-and-equivalent-wpf-controls.md)\n- [Hosting a Windows Forms Control in WPF by Using XAML Sample](https://go.microsoft.com/fwlink/?LinkID=160000)\n","nodes":[{"pos":[4,219],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords:\n  - \"hosting Windows Forms control in WPF [WPF]\"\nms.assetid: 1aef42cb-4cfb-44b4-9a7a-c02632d3d9c7","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML","nodes":[{"pos":[0,65],"content":"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML","pos":[0,65]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[226,291],"content":"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML","linkify":"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Control in WPF by Using XAML","pos":[0,65]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> provides many controls with a rich feature set.","pos":[292,421],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides many controls with a rich feature set."},{"content":"However, you may sometimes want to use <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls on your <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> pages.","pos":[422,644],"source":" However, you may sometimes want to use [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls on your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pages."},{"content":"For example, you may have a substantial investment in existing <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls, or you may have a <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> control that provides unique functionality.","pos":[645,935],"source":" For example, you may have a substantial investment in existing [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls, or you may have a [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] control that provides unique functionality."},{"pos":[942,1249],"content":"This walkthrough shows you how to host a Windows Forms <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox?displayProperty=nameWithType&gt;</ph> control on a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> page by using <ph id=\"ph3\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph>.","source":"This walkthrough shows you how to host a Windows Forms <xref:System.Windows.Forms.MaskedTextBox?displayProperty=nameWithType> control on a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] page by using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]."},{"pos":[1256,1502],"content":"For a complete code listing of the tasks shown in this walkthrough, see <bpt id=\"p1\">[</bpt>Hosting a Windows Forms Control in WPF by Using XAML Sample<ept id=\"p1\">](https://github.com/Microsoft/WPF-Samples/tree/master/Migration%20and%20Interoperability/HostingWfInWpfWithXaml)</ept>.","source":"For a complete code listing of the tasks shown in this walkthrough, see [Hosting a Windows Forms Control in WPF by Using XAML Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Migration%20and%20Interoperability/HostingWfInWpfWithXaml)."},{"pos":[1509,1522],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need Visual Studio to complete this walkthrough.","pos":[1526,1578]},{"pos":[1587,1620],"content":"Hosting the Windows Forms Control","linkify":"Hosting the Windows Forms Control","nodes":[{"content":"Hosting the Windows Forms Control","pos":[0,33]}]},{"pos":[1631,1664],"content":"To host the MaskedTextBox control","linkify":"To host the MaskedTextBox control","nodes":[{"content":"To host the MaskedTextBox control","pos":[0,33]}]},{"pos":[1674,1738],"content":"Create a WPF Application project named <ph id=\"ph1\">`HostingWfInWpfWithXaml`</ph>.","source":"Create a WPF Application project named `HostingWfInWpfWithXaml`."},{"content":"Add references to the following assemblies.","pos":[1748,1791]},{"content":"WindowsFormsIntegration","pos":[1805,1828]},{"content":"System.Windows.Forms","pos":[1842,1862]},{"pos":[1872,1992],"content":"Open MainWindow.xaml in the <ph id=\"ph1\">[!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]</ph>.","source":"Open MainWindow.xaml in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]."},{"content":"In the <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> element, add the following namespace mapping.","pos":[2002,2083],"source":"In the <xref:System.Windows.Window> element, add the following namespace mapping."},{"content":"The <ph id=\"ph1\">`wf`</ph> namespace mapping establishes a reference to the assembly that contains the Windows Forms control.","pos":[2084,2191],"source":" The `wf` namespace mapping establishes a reference to the assembly that contains the Windows Forms control."},{"pos":[2310,2384],"content":"In the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Grid&gt;</ph> element add the following XAML.","source":"In the <xref:System.Windows.Controls.Grid> element add the following XAML."},{"pos":[2395,2543],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.MaskedTextBox&gt;</ph> control is created as a child of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> control.","source":"The <xref:System.Windows.Forms.MaskedTextBox> control is created as a child of the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control."},{"content":"Press F5 to build and run the application.","pos":[2705,2747]},{"pos":[2756,2764],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2881,2968],"content":"<bpt id=\"p1\">[</bpt>Design XAML in Visual Studio<ept id=\"p1\">](/visualstudio/designers/designing-xaml-in-visual-studio)</ept>","source":"[Design XAML in Visual Studio](/visualstudio/designers/designing-xaml-in-visual-studio)"},{"pos":[2971,3079],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Control in WPF<ept id=\"p1\">](walkthrough-hosting-a-windows-forms-control-in-wpf.md)</ept>","source":"[Walkthrough: Hosting a Windows Forms Control in WPF](walkthrough-hosting-a-windows-forms-control-in-wpf.md)"},{"pos":[3082,3210],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Composite Control in WPF<ept id=\"p1\">](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)</ept>","source":"[Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)"},{"pos":[3213,3341],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a WPF Composite Control in Windows Forms<ept id=\"p1\">](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)</ept>","source":"[Walkthrough: Hosting a WPF Composite Control in Windows Forms](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)"},{"pos":[3344,3451],"content":"<bpt id=\"p1\">[</bpt>Windows Forms Controls and Equivalent WPF Controls<ept id=\"p1\">](windows-forms-controls-and-equivalent-wpf-controls.md)</ept>","source":"[Windows Forms Controls and Equivalent WPF Controls](windows-forms-controls-and-equivalent-wpf-controls.md)"},{"pos":[3454,3563],"content":"<bpt id=\"p1\">[</bpt>Hosting a Windows Forms Control in WPF by Using XAML Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=160000)</ept>","source":"[Hosting a Windows Forms Control in WPF by Using XAML Sample](https://go.microsoft.com/fwlink/?LinkID=160000)"}]}