{"content":"---\ntitle: \"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: ec046283-9fe2-4440-b295-860bf700099d\n---\n# How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)\nSometimes you want to find the immediate preceding sibling to a node. Due to the difference in the semantics of positional predicates for the preceding sibling axes in XPath as opposed to [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], this is one of the more interesting comparisons.  \n  \n## Example  \n In this example, the [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] query uses the <xref:System.Linq.Enumerable.Last%2A> operator to find the last node in the collection returned by <xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A>. By contrast, the XPath expression uses a predicate with a value of 1 to find the immediately preceding element.  \n  \n```vb  \nDim root As XElement = _   \n    <Root>  \n        <Child1/>  \n        <Child2/>  \n        <Child3/>  \n        <Child4/>  \n    </Root>  \nDim child4 As XElement = root.Element(\"Child4\")  \n  \n' LINQ to XML query  \nDim el1 As XElement = child4.ElementsBeforeSelf().Last()  \n  \n' XPath expression  \nDim el2 As XElement = _  \n    DirectCast(child4.XPathEvaluate(\"preceding-sibling::*[1]\"),  _  \n    IEnumerable).Cast(Of XElement)().First()  \n  \nIf el1 Is el2 Then  \n    Console.WriteLine(\"Results are identical\")  \nElse  \n    Console.WriteLine(\"Results differ\")  \nEnd If  \nConsole.WriteLine(el1)  \n```  \n  \n This example produces the following output:  \n  \n```  \nResults are identical  \n<Child3 />  \n```  \n  \n## See also\n\n- [LINQ to XML for XPath Users (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)\n","nodes":[{"pos":[4,161],"embed":true,"restype":"x-metadata","content":"title: \"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: ec046283-9fe2-4440-b295-860bf700099d","nodes":[{"content":"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)","nodes":[{"pos":[0,79],"content":"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)","nodes":[{"content":"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)","pos":[0,79]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[168,247],"content":"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)","linkify":"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)","nodes":[{"content":"How to: Find the Immediate Preceding Sibling (XPath-LINQ to XML) (Visual Basic)","pos":[0,79]}]},{"content":"Sometimes you want to find the immediate preceding sibling to a node.","pos":[248,317]},{"content":"Due to the difference in the semantics of positional predicates for the preceding sibling axes in XPath as opposed to <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph>, this is one of the more interesting comparisons.","pos":[318,539],"source":" Due to the difference in the semantics of positional predicates for the preceding sibling axes in XPath as opposed to [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], this is one of the more interesting comparisons."},{"pos":[548,555],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"In this example, the <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> query uses the <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.Last%2A&gt;</ph> operator to find the last node in the collection returned by <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A&gt;</ph>.","pos":[559,799],"source":"In this example, the [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] query uses the <xref:System.Linq.Enumerable.Last%2A> operator to find the last node in the collection returned by <xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A>."},{"content":"By contrast, the XPath expression uses a predicate with a value of 1 to find the immediately preceding element.","pos":[800,911]},{"content":"This example produces the following output:","pos":[1526,1569]},{"pos":[1630,1638],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1642,1775],"content":"<bpt id=\"p1\">[</bpt>LINQ to XML for XPath Users (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)</ept>","source":"[LINQ to XML for XPath Users (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)"}]}