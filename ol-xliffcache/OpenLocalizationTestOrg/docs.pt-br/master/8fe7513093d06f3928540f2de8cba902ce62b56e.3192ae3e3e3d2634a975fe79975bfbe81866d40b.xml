{"content":"---\ntitle: \"Oracle Sequences\"\nms.date: \"03/30/2017\"\nms.assetid: 27cd371d-8252-414d-b5b2-5d31fa44b585\n---\n# Oracle Sequences\nThe .NET Framework Data Provider for Oracle provides support for retrieving the server-generated key Oracle Sequence values after performing inserts by using the <xref:System.Data.OracleClient.OracleDataAdapter>.  \n  \n SQL Server and Oracle support the creation of automatically incrementing columns that can be designated as primary keys. These values are generated by the server as rows are added to a table. In SQL Server, you set the Identity property of a column; in Oracle you create a Sequence. The difference between auto-increment columns in SQL Server and sequences in Oracle is that:  \n  \n-   In SQL Server, you mark a column as an auto-increment column and SQL Server automatically generates new values for the column when you insert a new row.  \n  \n-   In Oracle, you create a sequence to generate new values for a column in your table, but there is no direct link between the sequence and the table or column. An Oracle sequence is an object, like a table or a stored procedure.  \n  \n When you create a sequence in an Oracle database, you can define its initial value and the increment between its values. You can also query the sequence for new values before submitting new rows. That means your code can recognize the key values for new rows before you insert them into the database.  \n  \n For more information about creating auto-increment columns by using SQL Server and ADO.NET, see [Retrieving Identity or Autonumber Values](../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md) and [Creating AutoIncrement Columns](../../../../docs/framework/data/adonet/dataset-datatable-dataview/creating-autoincrement-columns.md).  \n  \n## Example  \n The following C# example demonstrates how you can retrieve new sequence values from Oracle database. The example references the sequence in the INSERT INTO query used to submit the new rows, and then returns the sequence value generated using the RETURNING clause introduced in Oracle10g. The example adds a series of pending new rows in a <xref:System.Data.DataTable> by using ADO.NET’s auto-increment functionality to generate \"placeholder\" primary key values. Note that the increment value ADO.NET generated for the new row is just a \"placeholder\". That means the database might generate different values from the ones ADO.NET generates.  \n  \n Before submitting the pending inserts to the database, the example displays the contents of the rows. Then, the code creates a new <xref:System.Data.OracleClient.OracleDataAdapter> object and sets its <xref:System.Data.OracleClient.OracleDataAdapter.InsertCommand%2A> and the <xref:System.Data.OracleClient.OracleDataAdapter.UpdateBatchSize%2A> properties. The example also supplies the logic to return the server-generated values by using output parameters. Then, the example executes the update to submit the pending rows and displays the contents of the <xref:System.Data.DataTable>.  \n  \n```csharp  \npublic void OracleSequence(String connectionString)  \n{  \n   String insertString =   \n      \"INSERT INTO SequenceTest_Table (ID, OtherColumn)\" +  \n      \"VALUES (SequenceTest_Sequence.NEXTVAL, :OtherColumn)\" +  \n      \"RETURNING ID INTO :ID\";  \n  \n   using (OracleConnection conn = new OracleConnection(connectionString))  \n   {  \n      //Open a connection.  \n      conn.Open();  \n      OracleCommand cmd = conn.CreateCommand();  \n  \n      // Prepare the database.  \n      cmd.CommandText = \"DROP SEQUENCE SequenceTest_Sequence\";  \n      try { cmd.ExecuteNonQuery(); } catch { }  \n  \n      cmd.CommandText = \"DROP TABLE SequenceTest_Table\";  \n      try { cmd.ExecuteNonQuery(); } catch { }  \n  \n      cmd.CommandText = \"CREATE TABLE SequenceTest_Table \" +  \n                     \"(ID int PRIMARY KEY, OtherColumn varchar(255))\";  \n      cmd.ExecuteNonQuery();  \n  \n      cmd.CommandText = \"CREATE SEQUENCE SequenceTest_Sequence \" +  \n                        \"START WITH 100 INCREMENT BY 5\";  \n      cmd.ExecuteNonQuery();  \n  \n      DataTable testTable = new DataTable();  \n      DataColumn column = testTable.Columns.Add(\"ID\", typeof(int));  \n      column.AutoIncrement = true;  \n      column.AutoIncrementSeed = -1;  \n      column.AutoIncrementStep = -1;  \n      testTable.PrimaryKey = new DataColumn[] { column };  \n      testTable.Columns.Add(\"OtherColumn\", typeof(string));  \n      for (int rowCounter = 1; rowCounter <= 15; rowCounter++)  \n      {  \n         testTable.Rows.Add(null, \"Row #\" + rowCounter.ToString());  \n      }  \n  \n      Console.WriteLine(\"Before Update => \");  \n      foreach (DataRow row in testTable.Rows)  \n      {  \n         Console.WriteLine(\"   {0} - {1}\", row[\"ID\"], row[\"OtherColumn\"]);  \n      }  \n      Console.WriteLine();  \n  \n      cmd.CommandText =   \n        \"SELECT ID, OtherColumn FROM SequenceTest_Table\";  \n      OracleDataAdapter da = new OracleDataAdapter(cmd);  \n      da.InsertCommand = new OracleCommand(insertString, conn);  \n      da.InsertCommand.Parameters.Add(\":ID\", OracleType.Int32, 0, \"ID\");  \n      da.InsertCommand.Parameters[0].Direction = ParameterDirection.Output;  \n      da.InsertCommand.Parameters.Add(\":OtherColumn\", OracleType.VarChar, 255, \"OtherColumn\");  \n      da.InsertCommand.UpdatedRowSource = UpdateRowSource.OutputParameters;  \n      da.UpdateBatchSize = 10;  \n  \n      da.Update(testTable);  \n  \n      Console.WriteLine(\"After Update => \");  \n      foreach (DataRow row in testTable.Rows)  \n      {  \n         Console.WriteLine(\"   {0} - {1}\", row[\"ID\"], row[\"OtherColumn\"]);  \n      }  \n      // Close the connection.  \n      conn.Close();  \n   }  \n}  \n```  \n  \n## See also\n\n- [Oracle and ADO.NET](../../../../docs/framework/data/adonet/oracle-and-adonet.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,100],"embed":true,"restype":"x-metadata","content":"title: \"Oracle Sequences\"\nms.date: \"03/30/2017\"\nms.assetid: 27cd371d-8252-414d-b5b2-5d31fa44b585","nodes":[{"content":"Oracle Sequences","nodes":[{"pos":[0,16],"content":"Oracle Sequences","nodes":[{"content":"Oracle Sequences","pos":[0,16]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[107,123],"content":"Oracle Sequences","linkify":"Oracle Sequences","nodes":[{"content":"Oracle Sequences","pos":[0,16]}]},{"pos":[124,336],"content":"The .NET Framework Data Provider for Oracle provides support for retrieving the server-generated key Oracle Sequence values after performing inserts by using the <ph id=\"ph1\">&lt;xref:System.Data.OracleClient.OracleDataAdapter&gt;</ph>.","source":"The .NET Framework Data Provider for Oracle provides support for retrieving the server-generated key Oracle Sequence values after performing inserts by using the <xref:System.Data.OracleClient.OracleDataAdapter>."},{"content":"SQL Server and Oracle support the creation of automatically incrementing columns that can be designated as primary keys.","pos":[343,463]},{"content":"These values are generated by the server as rows are added to a table.","pos":[464,534]},{"content":"In SQL Server, you set the Identity property of a column; in Oracle you create a Sequence.","pos":[535,625]},{"content":"The difference between auto-increment columns in SQL Server and sequences in Oracle is that:","pos":[626,718]},{"content":"In SQL Server, you mark a column as an auto-increment column and SQL Server automatically generates new values for the column when you insert a new row.","pos":[728,880]},{"content":"In Oracle, you create a sequence to generate new values for a column in your table, but there is no direct link between the sequence and the table or column.","pos":[890,1047]},{"content":"An Oracle sequence is an object, like a table or a stored procedure.","pos":[1048,1116]},{"content":"When you create a sequence in an Oracle database, you can define its initial value and the increment between its values.","pos":[1123,1243]},{"content":"You can also query the sequence for new values before submitting new rows.","pos":[1244,1318]},{"content":"That means your code can recognize the key values for new rows before you insert them into the database.","pos":[1319,1423]},{"pos":[1430,1791],"content":"For more information about creating auto-increment columns by using SQL Server and ADO.NET, see <bpt id=\"p1\">[</bpt>Retrieving Identity or Autonumber Values<ept id=\"p1\">](../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md)</ept> and <bpt id=\"p2\">[</bpt>Creating AutoIncrement Columns<ept id=\"p2\">](../../../../docs/framework/data/adonet/dataset-datatable-dataview/creating-autoincrement-columns.md)</ept>.","source":"For more information about creating auto-increment columns by using SQL Server and ADO.NET, see [Retrieving Identity or Autonumber Values](../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md) and [Creating AutoIncrement Columns](../../../../docs/framework/data/adonet/dataset-datatable-dataview/creating-autoincrement-columns.md)."},{"pos":[1800,1807],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following C# example demonstrates how you can retrieve new sequence values from Oracle database.","pos":[1811,1911]},{"content":"The example references the sequence in the INSERT INTO query used to submit the new rows, and then returns the sequence value generated using the RETURNING clause introduced in Oracle10g.","pos":[1912,2099]},{"content":"The example adds a series of pending new rows in a <ph id=\"ph1\">&lt;xref:System.Data.DataTable&gt;</ph> by using ADO.NET’s auto-increment functionality to generate \"placeholder\" primary key values.","pos":[2100,2273],"source":" The example adds a series of pending new rows in a <xref:System.Data.DataTable> by using ADO.NET’s auto-increment functionality to generate \"placeholder\" primary key values."},{"content":"Note that the increment value ADO.NET generated for the new row is just a \"placeholder\".","pos":[2274,2362]},{"content":"That means the database might generate different values from the ones ADO.NET generates.","pos":[2363,2451]},{"content":"Before submitting the pending inserts to the database, the example displays the contents of the rows.","pos":[2458,2559]},{"content":"Then, the code creates a new <ph id=\"ph1\">&lt;xref:System.Data.OracleClient.OracleDataAdapter&gt;</ph> object and sets its <ph id=\"ph2\">&lt;xref:System.Data.OracleClient.OracleDataAdapter.InsertCommand%2A&gt;</ph> and the <ph id=\"ph3\">&lt;xref:System.Data.OracleClient.OracleDataAdapter.UpdateBatchSize%2A&gt;</ph> properties.","pos":[2560,2814],"source":" Then, the code creates a new <xref:System.Data.OracleClient.OracleDataAdapter> object and sets its <xref:System.Data.OracleClient.OracleDataAdapter.InsertCommand%2A> and the <xref:System.Data.OracleClient.OracleDataAdapter.UpdateBatchSize%2A> properties."},{"content":"The example also supplies the logic to return the server-generated values by using output parameters.","pos":[2815,2916]},{"content":"Then, the example executes the update to submit the pending rows and displays the contents of the <ph id=\"ph1\">&lt;xref:System.Data.DataTable&gt;</ph>.","pos":[2917,3044],"source":" Then, the example executes the update to submit the pending rows and displays the contents of the <xref:System.Data.DataTable>."},{"pos":[5705,5713],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5717,5798],"content":"<bpt id=\"p1\">[</bpt>Oracle and ADO.NET<ept id=\"p1\">](../../../../docs/framework/data/adonet/oracle-and-adonet.md)</ept>","source":"[Oracle and ADO.NET](../../../../docs/framework/data/adonet/oracle-and-adonet.md)"},{"pos":[5801,5905],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}