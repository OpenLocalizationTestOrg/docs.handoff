{"content":"---\ntitle: \"Obtaining UI Automation Elements | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"UI Automation, obtaining elements\"\n  - \"elements, UI Automation, obtaining\"\nms.assetid: c2caaf45-e59c-42a1-bc9b-77a6de520171\ncaps.latest.revision: 23\nauthor: \"Xansky\"\nms.author: \"mhopkins\"\nmanager: \"markl\"\n---\n# Obtaining UI Automation Elements\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This topic describes the various ways of obtaining <xref:System.Windows.Automation.AutomationElement> objects for [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] elements.  \n  \n> [!CAUTION]\n>  If your client application might attempt to find elements in its own user interface, you must make all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls on a separate thread. For more information, see [UI Automation Threading Issues](../../../docs/framework/ui-automation/ui-automation-threading-issues.md).  \n  \n<a name=\"The_Root_Element\"></a>   \n## Root Element  \n All searches for <xref:System.Windows.Automation.AutomationElement> objects must have a starting-place. This can be any element, including the desktop, an application window, or a control.  \n  \n The root element for the desktop, from which all elements are descended, is obtained from the static <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=fullName> property.  \n  \n> [!CAUTION]\n>  In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>. A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow. If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.  \n  \n<a name=\"Using_Conditions\"></a>   \n## Conditions  \n For most techniques you can use to retrieve [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements, you must specify a <xref:System.Windows.Automation.Condition>, which is a set of criteria defining what elements you want to retrieve.  \n  \n The simplest condition is <xref:System.Windows.Automation.Condition.TrueCondition>, a predefined object specifying that all elements within the search scope are to be returned. <xref:System.Windows.Automation.Condition.FalseCondition>, the converse of <xref:System.Windows.Automation.Condition.TrueCondition>, is less useful, as it would prevent any elements from being found.  \n  \n Three other predefined conditions can be used alone or in combination with other conditions: <xref:System.Windows.Automation.Automation.ContentViewCondition>, <xref:System.Windows.Automation.Automation.ControlViewCondition>, and <xref:System.Windows.Automation.Automation.RawViewCondition>. <xref:System.Windows.Automation.Automation.RawViewCondition>, used by itself, is equivalent to <xref:System.Windows.Automation.Condition.TrueCondition>, because it does not filter elements by their <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> or <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> properties.  \n  \n Other conditions are built up from one or more <xref:System.Windows.Automation.PropertyCondition> objects, each of which specifies a property value. For example, a <xref:System.Windows.Automation.PropertyCondition> might specify that the element is enabled, or that it supports a certain control pattern.  \n  \n Conditions can be combined using Boolean logic by constructing objects of types <xref:System.Windows.Automation.AndCondition>, <xref:System.Windows.Automation.OrCondition>, and <xref:System.Windows.Automation.NotCondition>.  \n  \n<a name=\"Search_Scope\"></a>   \n## Search Scope  \n Searches done by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A> must have a scope as well as a starting-place.  \n  \n The scope defines the space around the starting-place that is to be searched. This might include the element itself, its siblings, its parent, its ancestors, its immediate children, and its descendants.  \n  \n The scope of a search is defined by a bitwise combination of values from the <xref:System.Windows.Automation.TreeScope> enumeration.  \n  \n<a name=\"Finding_a_Known_Element\"></a>   \n## Finding a Known Element  \n To find a known element, identified by its <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>, or some other property or combination of properties, it is easiest to use the <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> method. If the element sought is an application window, the starting-point of the search can be the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.  \n  \n This way of finding [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements is most useful in automated testing scenarios.  \n  \n<a name=\"Finding_Elements_in_a_Subtree\"></a>   \n## Finding Elements in a Subtree  \n To find all elements meeting specific criteria that are related to a known element, you can use <xref:System.Windows.Automation.AutomationElement.FindAll%2A>. For example, you could use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.  \n  \n<a name=\"Walking_a_Subtree\"></a>   \n## Walking a Subtree  \n If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using the <xref:System.Windows.Automation.TreeWalker> class. Your application might do this in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.  \n  \n Another way in which <xref:System.Windows.Automation.TreeWalker> can be used is to identify the ancestors of an element. For example, by walking up the tree you can identify the parent window of a control.  \n  \n You can use <xref:System.Windows.Automation.TreeWalker> either by creating an object of the class (defining the elements of interest by passing a <xref:System.Windows.Automation.Condition>), or by using one of the following predefined objects that are defined as fields of <xref:System.Windows.Automation.TreeWalker>.  \n  \n|||  \n|-|-|  \n|<xref:System.Windows.Automation.TreeWalker.ContentViewWalker>|Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> property is `true`.|  \n|<xref:System.Windows.Automation.TreeWalker.ControlViewWalker>|Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> property is `true`.|  \n|<xref:System.Windows.Automation.TreeWalker.RawViewWalker>|Finds all elements.|  \n  \n After you have obtained a <xref:System.Windows.Automation.TreeWalker>, using it is straightforward. Simply call the `Get` methods to navigate among elements of the subtree.  \n  \n The <xref:System.Windows.Automation.TreeWalker.Normalize%2A> method can be used for navigating to an element in the subtree from another element that is not part of the view. For example, suppose you have created a view of a subtree by using <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>. Your application then receives notification that a scroll bar has received the input focus. Because a scroll bar is not a content element, it is not present in your view of the subtree. However, you can pass the <xref:System.Windows.Automation.AutomationElement> representing the scroll bar to <xref:System.Windows.Automation.TreeWalker.Normalize%2A> and retrieve the nearest ancestor that is in the content view.  \n  \n<a name=\"Other_Ways_to_Retrieve_an_Element\"></a>   \n## Other Ways to Retrieve an Element  \n In addition to searches and navigation, you can retrieve an <xref:System.Windows.Automation.AutomationElement> in the following ways.  \n  \n### From an Event  \n When your application receives a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] event, the source object passed to your event handler is an <xref:System.Windows.Automation.AutomationElement>. For example, if you have subscribed to focus-changed events, the source passed to your <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> is the element that received the focus.  \n  \n For more information, see [Subscribe to UI Automation Events](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md).  \n  \n### From a Point  \n If you have screen coordinates (for example, a cursor position), you can retrieve an <xref:System.Windows.Automation.AutomationElement> by using the static <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> method.  \n  \n### From a Window Handle  \n To retrieve an <xref:System.Windows.Automation.AutomationElement> from an HWND, use the static <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> method.  \n  \n### From the Focused Control  \n You can retrieve an <xref:System.Windows.Automation.AutomationElement> that represents the focused control from the static <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> property.  \n  \n## See Also  \n [Find a UI Automation Element Based on a Property Condition](../../../docs/framework/ui-automation/find-a-ui-automation-element-based-on-a-property-condition.md)   \n [Navigate Among UI Automation Elements with TreeWalker](../../../docs/framework/ui-automation/navigate-among-ui-automation-elements-with-treewalker.md)   \n [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)","nodes":[{"pos":[4,457],"nodes":[{"content":"Obtaining UI Automation Elements | Microsoft Docs","nodes":[{"pos":[0,49],"content":"Obtaining UI Automation Elements | Microsoft Docs","nodes":[{"content":"Obtaining UI Automation Elements | Microsoft Docs","pos":[0,49]}]}],"pos":[6,58],"yaml":true}],"content":"title: \"Obtaining UI Automation Elements | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"UI Automation, obtaining elements\"\n  - \"elements, UI Automation, obtaining\"\nms.assetid: c2caaf45-e59c-42a1-bc9b-77a6de520171\ncaps.latest.revision: 23\nauthor: \"Xansky\"\nms.author: \"mhopkins\"\nmanager: \"markl\"","yamlblock":true},{"pos":[464,496],"content":"Obtaining UI Automation Elements","linkify":"Obtaining UI Automation Elements","nodes":[{"content":"Obtaining UI Automation Elements","pos":[0,32]}]},{"pos":[499,961],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","pos":[9,460],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[0,240],"source":"This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[241,451],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"pos":[968,1154],"content":"This topic describes the various ways of obtaining <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> objects for <ph id=\"ph2\">[!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)]</ph> elements.","source":"This topic describes the various ways of obtaining <xref:System.Windows.Automation.AutomationElement> objects for [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] elements."},{"pos":[1162,1524],"content":"[!CAUTION]\n If your client application might attempt to find elements in its own user interface, you must make all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls on a separate thread. For more information, see [UI Automation Threading Issues](../../../docs/framework/ui-automation/ui-automation-threading-issues.md).","leadings":["","> "],"nodes":[{"content":"If your client application might attempt to find elements in its own user interface, you must make all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls on a separate thread. For more information, see [UI Automation Threading Issues](../../../docs/framework/ui-automation/ui-automation-threading-issues.md).","pos":[12,360],"nodes":[{"content":"If your client application might attempt to find elements in its own user interface, you must make all <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> calls on a separate thread.","pos":[0,215],"source":"If your client application might attempt to find elements in its own user interface, you must make all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls on a separate thread."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>UI Automation Threading Issues<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-threading-issues.md)</ept>.","pos":[216,348],"source":" For more information, see [UI Automation Threading Issues](../../../docs/framework/ui-automation/ui-automation-threading-issues.md)."}]}]},{"pos":[1568,1580],"content":"Root Element","linkify":"Root Element","nodes":[{"content":"Root Element","pos":[0,12]}]},{"content":"All searches for <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> objects must have a starting-place.","pos":[1584,1687],"source":"All searches for <xref:System.Windows.Automation.AutomationElement> objects must have a starting-place."},{"content":"This can be any element, including the desktop, an application window, or a control.","pos":[1688,1772]},{"content":"The root element for the desktop, from which all elements are descended, is obtained from the static <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=fullName&gt;</ph> property.","pos":[1779,1980],"source":"The root element for the desktop, from which all elements are descended, is obtained from the static <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=fullName> property."},{"pos":[1988,2422],"content":"[!CAUTION]\n In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>. A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow. If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.","leadings":["","> "],"nodes":[{"content":"In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>. A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow. If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.","pos":[12,432],"nodes":[{"content":"In general, you should try to obtain only direct children of the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.RootElement%2A&gt;</ph>.","pos":[0,131],"source":"In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>."},{"content":"A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow.","pos":[132,256]},{"content":"If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.","pos":[257,420]}]}]},{"pos":[2466,2476],"content":"Conditions","linkify":"Conditions","nodes":[{"content":"Conditions","pos":[0,10]}]},{"pos":[2480,2753],"content":"For most techniques you can use to retrieve <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> elements, you must specify a <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Condition&gt;</ph>, which is a set of criteria defining what elements you want to retrieve.","source":"For most techniques you can use to retrieve [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements, you must specify a <xref:System.Windows.Automation.Condition>, which is a set of criteria defining what elements you want to retrieve."},{"content":"The simplest condition is <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Condition.TrueCondition&gt;</ph>, a predefined object specifying that all elements within the search scope are to be returned.","pos":[2760,2936],"source":"The simplest condition is <xref:System.Windows.Automation.Condition.TrueCondition>, a predefined object specifying that all elements within the search scope are to be returned."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Condition.FalseCondition&gt;</ph>, the converse of <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Condition.TrueCondition&gt;</ph>, is less useful, as it would prevent any elements from being found.","pos":[2937,3136],"source":" <xref:System.Windows.Automation.Condition.FalseCondition>, the converse of <xref:System.Windows.Automation.Condition.TrueCondition>, is less useful, as it would prevent any elements from being found."},{"content":"Three other predefined conditions can be used alone or in combination with other conditions: <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Automation.ContentViewCondition&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Automation.ControlViewCondition&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Windows.Automation.Automation.RawViewCondition&gt;</ph>.","pos":[3143,3433],"source":"Three other predefined conditions can be used alone or in combination with other conditions: <xref:System.Windows.Automation.Automation.ContentViewCondition>, <xref:System.Windows.Automation.Automation.ControlViewCondition>, and <xref:System.Windows.Automation.Automation.RawViewCondition>."},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Automation.RawViewCondition&gt;</ph>, used by itself, is equivalent to <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Condition.TrueCondition&gt;</ph>, because it does not filter elements by their <ph id=\"ph3\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A&gt;</ph> properties.","pos":[3434,3846],"source":" <xref:System.Windows.Automation.Automation.RawViewCondition>, used by itself, is equivalent to <xref:System.Windows.Automation.Condition.TrueCondition>, because it does not filter elements by their <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> or <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> properties."},{"content":"Other conditions are built up from one or more <ph id=\"ph1\">&lt;xref:System.Windows.Automation.PropertyCondition&gt;</ph> objects, each of which specifies a property value.","pos":[3853,4001],"source":"Other conditions are built up from one or more <xref:System.Windows.Automation.PropertyCondition> objects, each of which specifies a property value."},{"content":"For example, a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.PropertyCondition&gt;</ph> might specify that the element is enabled, or that it supports a certain control pattern.","pos":[4002,4157],"source":" For example, a <xref:System.Windows.Automation.PropertyCondition> might specify that the element is enabled, or that it supports a certain control pattern."},{"content":"Conditions can be combined using Boolean logic by constructing objects of types <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AndCondition&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Automation.OrCondition&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Windows.Automation.NotCondition&gt;</ph>.","pos":[4164,4387],"source":"Conditions can be combined using Boolean logic by constructing objects of types <xref:System.Windows.Automation.AndCondition>, <xref:System.Windows.Automation.OrCondition>, and <xref:System.Windows.Automation.NotCondition>."},{"pos":[4427,4439],"content":"Search Scope","linkify":"Search Scope","nodes":[{"content":"Search Scope","pos":[0,12]}]},{"content":"Searches done by using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.FindFirst%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.FindAll%2A&gt;</ph> must have a scope as well as a starting-place.","pos":[4443,4641],"source":"Searches done by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A> must have a scope as well as a starting-place."},{"content":"The scope defines the space around the starting-place that is to be searched.","pos":[4648,4725]},{"content":"This might include the element itself, its siblings, its parent, its ancestors, its immediate children, and its descendants.","pos":[4726,4850]},{"content":"The scope of a search is defined by a bitwise combination of values from the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TreeScope&gt;</ph> enumeration.","pos":[4857,4989],"source":"The scope of a search is defined by a bitwise combination of values from the <xref:System.Windows.Automation.TreeScope> enumeration."},{"pos":[5040,5063],"content":"Finding a Known Element","linkify":"Finding a Known Element","nodes":[{"content":"Finding a Known Element","pos":[0,23]}]},{"content":"To find a known element, identified by its <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A&gt;</ph>, or some other property or combination of properties, it is easiest to use the <ph id=\"ph3\">&lt;xref:System.Windows.Automation.AutomationElement.FindFirst%2A&gt;</ph> method.","pos":[5067,5445],"source":"To find a known element, identified by its <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>, or some other property or combination of properties, it is easiest to use the <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> method."},{"content":"If the element sought is an application window, the starting-point of the search can be the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.RootElement%2A&gt;</ph>.","pos":[5446,5604],"source":" If the element sought is an application window, the starting-point of the search can be the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>."},{"pos":[5611,5771],"content":"This way of finding <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> elements is most useful in automated testing scenarios.","source":"This way of finding [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements is most useful in automated testing scenarios."},{"pos":[5828,5857],"content":"Finding Elements in a Subtree","linkify":"Finding Elements in a Subtree","nodes":[{"content":"Finding Elements in a Subtree","pos":[0,29]}]},{"content":"To find all elements meeting specific criteria that are related to a known element, you can use <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.FindAll%2A&gt;</ph>.","pos":[5861,6019],"source":"To find all elements meeting specific criteria that are related to a known element, you can use <xref:System.Windows.Automation.AutomationElement.FindAll%2A>."},{"content":"For example, you could use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.","pos":[6020,6161]},{"pos":[6206,6223],"content":"Walking a Subtree","linkify":"Walking a Subtree","nodes":[{"content":"Walking a Subtree","pos":[0,17]}]},{"content":"If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TreeWalker&gt;</ph> class.","pos":[6227,6432],"source":"If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using the <xref:System.Windows.Automation.TreeWalker> class."},{"content":"Your application might do this in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.","pos":[6433,6658]},{"content":"Another way in which <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TreeWalker&gt;</ph> can be used is to identify the ancestors of an element.","pos":[6665,6785],"source":"Another way in which <xref:System.Windows.Automation.TreeWalker> can be used is to identify the ancestors of an element."},{"content":"For example, by walking up the tree you can identify the parent window of a control.","pos":[6786,6870]},{"content":"You can use <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TreeWalker&gt;</ph> either by creating an object of the class (defining the elements of interest by passing a <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Condition&gt;</ph>), or by using one of the following predefined objects that are defined as fields of <ph id=\"ph3\">&lt;xref:System.Windows.Automation.TreeWalker&gt;</ph>.","pos":[6877,7194],"source":"You can use <xref:System.Windows.Automation.TreeWalker> either by creating an object of the class (defining the elements of interest by passing a <xref:System.Windows.Automation.Condition>), or by using one of the following predefined objects that are defined as fields of <xref:System.Windows.Automation.TreeWalker>."},{"pos":[7277,7422],"content":"Finds only elements whose <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A&gt;</ph> property is <ph id=\"ph2\">`true`</ph>.","source":"Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> property is `true`."},{"pos":[7489,7634],"content":"Finds only elements whose <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A&gt;</ph> property is <ph id=\"ph2\">`true`</ph>.","source":"Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> property is `true`."},{"content":"Finds all elements.","pos":[7697,7716]},{"content":"After you have obtained a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TreeWalker&gt;</ph>, using it is straightforward.","pos":[7724,7823],"source":"After you have obtained a <xref:System.Windows.Automation.TreeWalker>, using it is straightforward."},{"content":"Simply call the <ph id=\"ph1\">`Get`</ph> methods to navigate among elements of the subtree.","pos":[7824,7896],"source":" Simply call the `Get` methods to navigate among elements of the subtree."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TreeWalker.Normalize%2A&gt;</ph> method can be used for navigating to an element in the subtree from another element that is not part of the view.","pos":[7903,8077],"source":"The <xref:System.Windows.Automation.TreeWalker.Normalize%2A> method can be used for navigating to an element in the subtree from another element that is not part of the view."},{"content":"For example, suppose you have created a view of a subtree by using <ph id=\"ph1\">&lt;xref:System.Windows.Automation.TreeWalker.ContentViewWalker&gt;</ph>.","pos":[8078,8207],"source":" For example, suppose you have created a view of a subtree by using <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>."},{"content":"Your application then receives notification that a scroll bar has received the input focus.","pos":[8208,8299]},{"content":"Because a scroll bar is not a content element, it is not present in your view of the subtree.","pos":[8300,8393]},{"content":"However, you can pass the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> representing the scroll bar to <ph id=\"ph2\">&lt;xref:System.Windows.Automation.TreeWalker.Normalize%2A&gt;</ph> and retrieve the nearest ancestor that is in the content view.","pos":[8394,8621],"source":" However, you can pass the <xref:System.Windows.Automation.AutomationElement> representing the scroll bar to <xref:System.Windows.Automation.TreeWalker.Normalize%2A> and retrieve the nearest ancestor that is in the content view."},{"pos":[8682,8715],"content":"Other Ways to Retrieve an Element","linkify":"Other Ways to Retrieve an Element","nodes":[{"content":"Other Ways to Retrieve an Element","pos":[0,33]}]},{"content":"In addition to searches and navigation, you can retrieve an <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> in the following ways.","pos":[8719,8852],"source":"In addition to searches and navigation, you can retrieve an <xref:System.Windows.Automation.AutomationElement> in the following ways."},{"pos":[8862,8875],"content":"From an Event","linkify":"From an Event","nodes":[{"content":"From an Event","pos":[0,13]}]},{"content":"When your application receives a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> event, the source object passed to your event handler is an <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph>.","pos":[8879,9108],"source":"When your application receives a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] event, the source object passed to your event handler is an <xref:System.Windows.Automation.AutomationElement>."},{"content":"For example, if you have subscribed to focus-changed events, the source passed to your <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationFocusChangedEventHandler&gt;</ph> is the element that received the focus.","pos":[9109,9303],"source":" For example, if you have subscribed to focus-changed events, the source passed to your <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> is the element that received the focus."},{"pos":[9310,9448],"content":"For more information, see <bpt id=\"p1\">[</bpt>Subscribe to UI Automation Events<ept id=\"p1\">](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md)</ept>.","source":"For more information, see [Subscribe to UI Automation Events](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md)."},{"pos":[9458,9470],"content":"From a Point","linkify":"From a Point","nodes":[{"content":"From a Point","pos":[0,12]}]},{"content":"If you have screen coordinates (for example, a cursor position), you can retrieve an <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> by using the static <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.FromPoint%2A&gt;</ph> method.","pos":[9474,9701],"source":"If you have screen coordinates (for example, a cursor position), you can retrieve an <xref:System.Windows.Automation.AutomationElement> by using the static <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> method."},{"pos":[9711,9731],"content":"From a Window Handle","linkify":"From a Window Handle","nodes":[{"content":"From a Window Handle","pos":[0,20]}]},{"content":"To retrieve an <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> from an HWND, use the static <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.FromHandle%2A&gt;</ph> method.","pos":[9735,9902],"source":"To retrieve an <xref:System.Windows.Automation.AutomationElement> from an HWND, use the static <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> method."},{"pos":[9912,9936],"content":"From the Focused Control","linkify":"From the Focused Control","nodes":[{"content":"From the Focused Control","pos":[0,24]}]},{"content":"You can retrieve an <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationElement&gt;</ph> that represents the focused control from the static <ph id=\"ph2\">&lt;xref:System.Windows.Automation.AutomationElement.FocusedElement%2A&gt;</ph> property.","pos":[9940,10141],"source":"You can retrieve an <xref:System.Windows.Automation.AutomationElement> that represents the focused control from the static <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> property."},{"pos":[10150,10158],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Find a UI Automation Element Based on a Property Condition<ept id=\"p1\">](../../../docs/framework/ui-automation/find-a-ui-automation-element-based-on-a-property-condition.md)</ept><ph id=\"ph1\"> </ph>","pos":[10162,10324],"source":"[Find a UI Automation Element Based on a Property Condition](../../../docs/framework/ui-automation/find-a-ui-automation-element-based-on-a-property-condition.md) "},{"content":"<bpt id=\"p1\">[</bpt>Navigate Among UI Automation Elements with TreeWalker<ept id=\"p1\">](../../../docs/framework/ui-automation/navigate-among-ui-automation-elements-with-treewalker.md)</ept><ph id=\"ph1\"> </ph>","pos":[10328,10480],"source":"[Navigate Among UI Automation Elements with TreeWalker](../../../docs/framework/ui-automation/navigate-among-ui-automation-elements-with-treewalker.md) "},{"content":"<bpt id=\"p1\">[</bpt>UI Automation Tree Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</ept>","pos":[10484,10583],"source":"[UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)"}]}