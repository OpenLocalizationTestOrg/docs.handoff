{"content":"---\ntitle: \"Querying the Data Service (WCF Data Services)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"WCF Data Services, client library\"\n  - \"WCF Data Services, querying\"\n  - \"WCF Data Services, accessing data\"\nms.assetid: 823e9444-27aa-4f1f-be8e-0486d67f54c0\n---\n# Querying the Data Service (WCF Data Services)\nThe [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client library enables you to execute queries against a data service by using familiar [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] programming patterns, including using language integrated query (LINQ). The client library translates a query, which is defined on the client as an instance of the <xref:System.Data.Services.Client.DataServiceQuery%601> class, into an HTTP GET request message. The library receives the response message and translates it into instances of client data service classes. These classes are tracked by the <xref:System.Data.Services.Client.DataServiceContext> to which the <xref:System.Data.Services.Client.DataServiceQuery%601> belongs.  \n  \n## Data Service Queries  \n The <xref:System.Data.Services.Client.DataServiceQuery%601> generic class represents a query that returns a collection of zero or more entity type instances. A data service query always belongs to an existing data service context. This context maintains the service URI and metadata information that is required to compose and execute the query.  \n  \n When you use the **Add Service Reference** dialog to add a data service to a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]-based client application, an entity container class is created that inherits from the <xref:System.Data.Services.Client.DataServiceContext> class. This class includes properties that return typed <xref:System.Data.Services.Client.DataServiceQuery%601> instances. There is one property for each entity set that the data service exposes. These properties make it easier to create an instance of a typed <xref:System.Data.Services.Client.DataServiceQuery%601>.  \n  \n A query is executed in the following scenarios:  \n  \n-   When results are enumerated implicitly, such as:  \n  \n    -   When a property on the <xref:System.Data.Services.Client.DataServiceContext> that represents and entity set is enumerated, such as during a `foreach` (C#) or `For Each` (Visual Basic) loop.  \n  \n    -   When the query is assigned to a `List` collection.  \n  \n-   When the <xref:System.Data.Services.Client.DataServiceQuery%601.Execute%2A> or <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> method is explicitly called.  \n  \n-   When a LINQ query execution operator, such as <xref:System.Linq.Enumerable.First%2A> or <xref:System.Linq.Enumerable.Single%2A> is called.  \n  \n The following query, when it is executed, returns all `Customers` entities in the Northwind data service:  \n  \n [!code-csharp[Astoria Northwind Client#GetAllCustomersSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#getallcustomersspecific)]  \n [!code-vb[Astoria Northwind Client#GetAllCustomersSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#getallcustomersspecific)]  \n  \n For more information, see [How to: Execute Data Service Queries](../../../../docs/framework/data/wcf/how-to-execute-data-service-queries-wcf-data-services.md).  \n  \n The [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client supports queries for late-bound objects, such as when you use the *dynamic* type in C#. However, for performance reasons you should always compose strongly-typed queries against the data service. The <xref:System.Tuple> type and dynamic objects are not supported by the client.  \n  \n## LINQ Queries  \n Because the <xref:System.Data.Services.Client.DataServiceQuery%601> class implements the <xref:System.Linq.IQueryable%601> interface defined by LINQ, the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client library is able to transform LINQ queries against entity set data into a URI that represents a query expression evaluated against a data service resource. The following example is a LINQ query that is equivalent to the previous <xref:System.Data.Services.Client.DataServiceQuery%601> that returns `Orders` that have a freight cost of more than $30 and orders the results by the freight cost:  \n  \n [!code-csharp[Astoria Northwind Client#AddQueryOptionsLinqSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#addqueryoptionslinqspecific)]  \n [!code-vb[Astoria Northwind Client#AddQueryOptionsLinqSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#addqueryoptionslinqspecific)]  \n  \n This LINQ query is translated into the following query URI that is executed against the Northwind-based [quickstart](../../../../docs/framework/data/wcf/quickstart-wcf-data-services.md) data service:  \n  \n```  \nhttp://localhost:12345/Northwind.svc/Orders?Orderby=ShippedDate&?filter=Freight gt 30  \n```  \n  \n> [!NOTE]\n>  The set of queries expressible in the LINQ syntax is broader than those enabled in the representational state transfer (REST)-based URI syntax that is used by data services. A <xref:System.NotSupportedException> is raised when the query cannot be mapped to a URI in the target data service.  \n  \n For more information, see [LINQ Considerations](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md).  \n  \n## Adding Query Options  \n Data service queries support all the query options that [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]s provides. You call the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method to append query options to a <xref:System.Data.Services.Client.DataServiceQuery%601> instance. <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> returns a new <xref:System.Data.Services.Client.DataServiceQuery%601> instance that is equivalent to the original query but with the new query option set. The following query, when executed, returns `Orders` that are filtered by the `Freight` value and ordered by the `OrderID`, descending:  \n  \n [!code-csharp[Astoria Northwind Client#AddQueryOptionsSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#addqueryoptionsspecific)]  \n [!code-vb[Astoria Northwind Client#AddQueryOptionsSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#addqueryoptionsspecific)]  \n  \n You can use the `$orderby` query option to both order and filter a query based on a single property, as in the following example that filters and orders the returned `Orders` objects based on the value of the `Freight` property:  \n  \n [!code-csharp[Astoria Northwind Client#OrderWithFilter](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#orderwithfilter)]\n [!code-vb[Astoria Northwind Client#OrderWithFilter](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#orderwithfilter)]  \n  \n You can call the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method consecutively to construct complex query expressions. For more information, see [How to: Add Query Options to a Data Service Query](../../../../docs/framework/data/wcf/how-to-add-query-options-to-a-data-service-query-wcf-data-services.md).  \n  \n Query options give you another way to express the syntactic components of a LINQ query. For more information, see [LINQ Considerations](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md).  \n  \n> [!NOTE]\n>  The `$select` query option cannot be added to a query URI by using the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method. We recommend that you use the LINQ <xref:System.Linq.Enumerable.Select%2A> method to have the client generate the `$select` query option in the request URI.  \n  \n<a name=\"executingQueries\"></a>   \n## Client versus Server Execution  \n The client executes a query in two parts. Whenever possible, expressions in a query are first evaluated on the client, and then a URI-based query is generated and sent to the data service for evaluation against data in the service. Consider the following LINQ query:  \n  \n [!code-csharp[Astoria Northwind Client#LinqQueryClientEvalSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#linqqueryclientevalspecific)]  \n [!code-vb[Astoria Northwind Client#LinqQueryClientEvalSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#linqqueryclientevalspecific)]  \n  \n In this example, the expression `(basePrice – (basePrice * discount))` is evaluated on the client. Because of this, the actual query URI `http://localhost:12345/northwind.svc/Products()?$filter=(UnitPrice gt 90.00M) and substringof('bike',ProductName)` that is sent to the data service contains the already calculated decimal value of `90` in the filter clause. The other parts of the filtering expression, including the substring expression, are evaluated by the data service. Expressions that are evaluated on the client follow common language runtime (CLR) semantics, while expressions sent to the data service rely on the data service implementation of the [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] Protocol. You should also be aware of scenarios where this separate evaluation may cause unexpected results, such as when both the client and service perform time-based evaluations in different time zones.  \n  \n## Query Responses  \n When executed, the <xref:System.Data.Services.Client.DataServiceQuery%601> returns an <xref:System.Collections.Generic.IEnumerable%601> of the requested entity type. This query result can be cast to a <xref:System.Data.Services.Client.QueryOperationResponse%601> object, as in the following example:  \n  \n [!code-csharp[Astoria Northwind Client#GetResponseSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#getresponsespecific)]\n [!code-vb[Astoria Northwind Client#GetResponseSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#getresponsespecific)]  \n  \n The entity type instances that represent entities in the data service are created on the client by a process called object materialization. For more information, see [Object Materialization](../../../../docs/framework/data/wcf/object-materialization-wcf-data-services.md). The <xref:System.Data.Services.Client.QueryOperationResponse%601> object implements <xref:System.Collections.Generic.IEnumerable%601> to provide access to the results of the query.  \n  \n The <xref:System.Data.Services.Client.QueryOperationResponse%601> also has the following members that enable you to access additional information about a query result:  \n  \n-   <xref:System.Data.Services.Client.OperationResponse.Error%2A> - gets an error thrown by the operation, if any has occurred.  \n  \n-   <xref:System.Data.Services.Client.OperationResponse.Headers%2A> - contains the collection of HTTP response headers associated with the query response.  \n  \n-   <xref:System.Data.Services.Client.QueryOperationResponse.Query%2A> - gets the original <xref:System.Data.Services.Client.DataServiceQuery%601> that generated the <xref:System.Data.Services.Client.QueryOperationResponse%601>.  \n  \n-   <xref:System.Data.Services.Client.OperationResponse.StatusCode%2A> - gets the HTTP response code for the query response.  \n  \n-   <xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A> - gets the total number of entities in the entity set when the <xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A> method was called on the <xref:System.Data.Services.Client.DataServiceQuery%601>.  \n  \n-   <xref:System.Data.Services.Client.QueryOperationResponse.GetContinuation%2A> - returns a <xref:System.Data.Services.Client.DataServiceQueryContinuation> object that contains the URI of the next page of results.  \n  \n By default, [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] only returns data that is explicitly selected by the query URI. This gives you the option to explicitly load additional data from the data service when it is needed. A request is sent to the data service each time you explicitly load data from the data service. Data that can be explicitly loaded includes related entities, paged response data, and binary data streams.  \n  \n> [!NOTE]\n>  Because a data service may return a paged response, we recommend that your application use the programming pattern to handle a paged data service response. For more information, see [Loading Deferred Content](../../../../docs/framework/data/wcf/loading-deferred-content-wcf-data-services.md).  \n  \n The amount of data returned by a query can also be reduced by specifying that only certain properties of an entity are returned in the response. For more information, see [Query Projections](../../../../docs/framework/data/wcf/query-projections-wcf-data-services.md).  \n  \n## Getting a Count of the Total Number of Entities in the Set  \n In some scenarios, it is helpful to know the total number of entities in an entity set and not merely the number returned by the query. Call the <xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A> method on the <xref:System.Data.Services.Client.DataServiceQuery%601> to request that this total count of entities in the set be included with the query result. In this case, the <xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A> property of the returned <xref:System.Data.Services.Client.QueryOperationResponse%601> returns the total number of entities in the set.  \n  \n You can also get only the total count of entities in the set either as an <xref:System.Int32> or as a <xref:System.Int64> value by calling the <xref:System.Linq.Enumerable.Count%2A> or <xref:System.Linq.Enumerable.LongCount%2A> methods respectively. When these methods are called, a <xref:System.Data.Services.Client.QueryOperationResponse%601> is not returned; only the count value is returned. For more information, see [How to: Determine the Number of Entities Returned by a Query](../../../../docs/framework/data/wcf/number-of-entities-returned-by-a-query-wcf.md).  \n  \n## In This Section  \n [Query Projections](../../../../docs/framework/data/wcf/query-projections-wcf-data-services.md)  \n  \n [Object Materialization](../../../../docs/framework/data/wcf/object-materialization-wcf-data-services.md)  \n  \n [LINQ Considerations](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md)  \n  \n [How to: Execute Data Service Queries](../../../../docs/framework/data/wcf/how-to-execute-data-service-queries-wcf-data-services.md)  \n  \n [How to: Add Query Options to a Data Service Query](../../../../docs/framework/data/wcf/how-to-add-query-options-to-a-data-service-query-wcf-data-services.md)  \n  \n [How to: Determine the Number of Entities Returned by a Query](../../../../docs/framework/data/wcf/number-of-entities-returned-by-a-query-wcf.md)  \n  \n [How to: Specify Client Credentials for a Data Service Request](../../../../docs/framework/data/wcf/specify-client-creds-for-a-data-service-request-wcf.md)  \n  \n [How to: Set Headers in the Client Request](../../../../docs/framework/data/wcf/how-to-set-headers-in-the-client-request-wcf-data-services.md)  \n  \n [How to: Project Query Results](../../../../docs/framework/data/wcf/how-to-project-query-results-wcf-data-services.md)  \n  \n## See also\n\n- [WCF Data Services Client Library](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)\n","nodes":[{"pos":[4,299],"embed":true,"restype":"x-metadata","content":"title: \"Querying the Data Service (WCF Data Services)\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"WCF Data Services, client library\"\n  - \"WCF Data Services, querying\"\n  - \"WCF Data Services, accessing data\"\nms.assetid: 823e9444-27aa-4f1f-be8e-0486d67f54c0","nodes":[{"content":"Querying the Data Service (WCF Data Services)","nodes":[{"pos":[0,45],"content":"Querying the Data Service (WCF Data Services)","nodes":[{"content":"Querying the Data Service (WCF Data Services)","pos":[0,45]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[306,351],"content":"Querying the Data Service (WCF Data Services)","linkify":"Querying the Data Service (WCF Data Services)","nodes":[{"content":"Querying the Data Service (WCF Data Services)","pos":[0,45]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]</ph> client library enables you to execute queries against a data service by using familiar <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> programming patterns, including using language integrated query (LINQ).","pos":[352,638],"source":"The [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client library enables you to execute queries against a data service by using familiar [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] programming patterns, including using language integrated query (LINQ)."},{"content":"The client library translates a query, which is defined on the client as an instance of the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> class, into an HTTP GET request message.","pos":[639,827],"source":" The client library translates a query, which is defined on the client as an instance of the <xref:System.Data.Services.Client.DataServiceQuery%601> class, into an HTTP GET request message."},{"content":"The library receives the response message and translates it into instances of client data service classes.","pos":[828,934]},{"content":"These classes are tracked by the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph> to which the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> belongs.","pos":[935,1099],"source":" These classes are tracked by the <xref:System.Data.Services.Client.DataServiceContext> to which the <xref:System.Data.Services.Client.DataServiceQuery%601> belongs."},{"pos":[1108,1128],"content":"Data Service Queries","linkify":"Data Service Queries","nodes":[{"content":"Data Service Queries","pos":[0,20]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> generic class represents a query that returns a collection of zero or more entity type instances.","pos":[1132,1289],"source":"The <xref:System.Data.Services.Client.DataServiceQuery%601> generic class represents a query that returns a collection of zero or more entity type instances."},{"content":"A data service query always belongs to an existing data service context.","pos":[1290,1362]},{"content":"This context maintains the service URI and metadata information that is required to compose and execute the query.","pos":[1363,1477]},{"content":"When you use the <bpt id=\"p1\">**</bpt>Add Service Reference<ept id=\"p1\">**</ept> dialog to add a data service to a <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph>-based client application, an entity container class is created that inherits from the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph> class.","pos":[1484,1771],"source":"When you use the **Add Service Reference** dialog to add a data service to a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]-based client application, an entity container class is created that inherits from the <xref:System.Data.Services.Client.DataServiceContext> class."},{"content":"This class includes properties that return typed <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> instances.","pos":[1772,1887],"source":" This class includes properties that return typed <xref:System.Data.Services.Client.DataServiceQuery%601> instances."},{"content":"There is one property for each entity set that the data service exposes.","pos":[1888,1960]},{"content":"These properties make it easier to create an instance of a typed <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph>.","pos":[1961,2082],"source":" These properties make it easier to create an instance of a typed <xref:System.Data.Services.Client.DataServiceQuery%601>."},{"content":"A query is executed in the following scenarios:","pos":[2089,2136]},{"content":"When results are enumerated implicitly, such as:","pos":[2146,2194]},{"pos":[2208,2397],"content":"When a property on the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceContext&gt;</ph> that represents and entity set is enumerated, such as during a <ph id=\"ph2\">`foreach`</ph> (C#) or <ph id=\"ph3\">`For Each`</ph> (Visual Basic) loop.","source":"When a property on the <xref:System.Data.Services.Client.DataServiceContext> that represents and entity set is enumerated, such as during a `foreach` (C#) or `For Each` (Visual Basic) loop."},{"pos":[2411,2461],"content":"When the query is assigned to a <ph id=\"ph1\">`List`</ph> collection.","source":"When the query is assigned to a `List` collection."},{"pos":[2471,2650],"content":"When the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.Execute%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A&gt;</ph> method is explicitly called.","source":"When the <xref:System.Data.Services.Client.DataServiceQuery%601.Execute%2A> or <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> method is explicitly called."},{"pos":[2660,2798],"content":"When a LINQ query execution operator, such as <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.First%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.Single%2A&gt;</ph> is called.","source":"When a LINQ query execution operator, such as <xref:System.Linq.Enumerable.First%2A> or <xref:System.Linq.Enumerable.Single%2A> is called."},{"pos":[2805,2910],"content":"The following query, when it is executed, returns all <ph id=\"ph1\">`Customers`</ph> entities in the Northwind data service:","source":"The following query, when it is executed, returns all `Customers` entities in the Northwind data service:"},{"pos":[2917,3282],"content":"[!code-csharp[Astoria Northwind Client#GetAllCustomersSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#getallcustomersspecific)]  \n[!code-vb[Astoria Northwind Client#GetAllCustomersSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#getallcustomersspecific)]","leadings":[""," "],"nodes":[]},{"pos":[3289,3448],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Execute Data Service Queries<ept id=\"p1\">](../../../../docs/framework/data/wcf/how-to-execute-data-service-queries-wcf-data-services.md)</ept>.","source":"For more information, see [How to: Execute Data Service Queries](../../../../docs/framework/data/wcf/how-to-execute-data-service-queries-wcf-data-services.md)."},{"content":"The <ph id=\"ph1\">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]</ph> client supports queries for late-bound objects, such as when you use the <bpt id=\"p1\">*</bpt>dynamic<ept id=\"p1\">*</ept> type in C#.","pos":[3455,3613],"source":"The [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client supports queries for late-bound objects, such as when you use the *dynamic* type in C#."},{"content":"However, for performance reasons you should always compose strongly-typed queries against the data service.","pos":[3614,3721]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Tuple&gt;</ph> type and dynamic objects are not supported by the client.","pos":[3722,3803],"source":" The <xref:System.Tuple> type and dynamic objects are not supported by the client."},{"pos":[3812,3824],"content":"LINQ Queries","linkify":"LINQ Queries","nodes":[{"content":"LINQ Queries","pos":[0,12]}]},{"content":"Because the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> class implements the <ph id=\"ph2\">&lt;xref:System.Linq.IQueryable%601&gt;</ph> interface defined by LINQ, the <ph id=\"ph3\">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]</ph> client library is able to transform LINQ queries against entity set data into a URI that represents a query expression evaluated against a data service resource.","pos":[3828,4203],"source":"Because the <xref:System.Data.Services.Client.DataServiceQuery%601> class implements the <xref:System.Linq.IQueryable%601> interface defined by LINQ, the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client library is able to transform LINQ queries against entity set data into a URI that represents a query expression evaluated against a data service resource."},{"content":"The following example is a LINQ query that is equivalent to the previous <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> that returns <ph id=\"ph2\">`Orders`</ph> that have a freight cost of more than $30 and orders the results by the freight cost:","pos":[4204,4440],"source":" The following example is a LINQ query that is equivalent to the previous <xref:System.Data.Services.Client.DataServiceQuery%601> that returns `Orders` that have a freight cost of more than $30 and orders the results by the freight cost:"},{"pos":[4835,5034],"content":"This LINQ query is translated into the following query URI that is executed against the Northwind-based <bpt id=\"p1\">[</bpt>quickstart<ept id=\"p1\">](../../../../docs/framework/data/wcf/quickstart-wcf-data-services.md)</ept> data service:","source":"This LINQ query is translated into the following query URI that is executed against the Northwind-based [quickstart](../../../../docs/framework/data/wcf/quickstart-wcf-data-services.md) data service:"},{"pos":[5145,5446],"content":"[!NOTE]\n The set of queries expressible in the LINQ syntax is broader than those enabled in the representational state transfer (REST)-based URI syntax that is used by data services. A <xref:System.NotSupportedException> is raised when the query cannot be mapped to a URI in the target data service.","leadings":["","> "],"nodes":[{"content":"The set of queries expressible in the LINQ syntax is broader than those enabled in the representational state transfer (REST)-based URI syntax that is used by data services. A <xref:System.NotSupportedException> is raised when the query cannot be mapped to a URI in the target data service.","pos":[9,299],"nodes":[{"content":"The set of queries expressible in the LINQ syntax is broader than those enabled in the representational state transfer (REST)-based URI syntax that is used by data services.","pos":[0,173]},{"content":"A <ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph> is raised when the query cannot be mapped to a URI in the target data service.","pos":[174,290],"source":" A <xref:System.NotSupportedException> is raised when the query cannot be mapped to a URI in the target data service."}]}]},{"pos":[5453,5579],"content":"For more information, see <bpt id=\"p1\">[</bpt>LINQ Considerations<ept id=\"p1\">](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md)</ept>.","source":"For more information, see [LINQ Considerations](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md)."},{"pos":[5588,5608],"content":"Adding Query Options","linkify":"Adding Query Options","nodes":[{"content":"Adding Query Options","pos":[0,20]}]},{"content":"Data service queries support all the query options that <ph id=\"ph1\">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]</ph>s provides.","pos":[5612,5738],"source":"Data service queries support all the query options that [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]s provides."},{"content":"You call the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A&gt;</ph> method to append query options to a <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> instance.","pos":[5739,5927],"source":" You call the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method to append query options to a <xref:System.Data.Services.Client.DataServiceQuery%601> instance."},{"content":"<ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A&gt;</ph> returns a new <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> instance that is equivalent to the original query but with the new query option set.","pos":[5928,6156],"source":"<xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> returns a new <xref:System.Data.Services.Client.DataServiceQuery%601> instance that is equivalent to the original query but with the new query option set."},{"content":"The following query, when executed, returns <ph id=\"ph1\">`Orders`</ph> that are filtered by the <ph id=\"ph2\">`Freight`</ph> value and ordered by the <ph id=\"ph3\">`OrderID`</ph>, descending:","pos":[6157,6292],"source":" The following query, when executed, returns `Orders` that are filtered by the `Freight` value and ordered by the `OrderID`, descending:"},{"pos":[6671,6899],"content":"You can use the <ph id=\"ph1\">`$orderby`</ph> query option to both order and filter a query based on a single property, as in the following example that filters and orders the returned <ph id=\"ph2\">`Orders`</ph> objects based on the value of the <ph id=\"ph3\">`Freight`</ph> property:","source":"You can use the `$orderby` query option to both order and filter a query based on a single property, as in the following example that filters and orders the returned `Orders` objects based on the value of the `Freight` property:"},{"content":"You can call the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A&gt;</ph> method consecutively to construct complex query expressions.","pos":[7244,7395],"source":"You can call the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method consecutively to construct complex query expressions."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Add Query Options to a Data Service Query<ept id=\"p1\">](../../../../docs/framework/data/wcf/how-to-add-query-options-to-a-data-service-query-wcf-data-services.md)</ept>.","pos":[7396,7581],"source":" For more information, see [How to: Add Query Options to a Data Service Query](../../../../docs/framework/data/wcf/how-to-add-query-options-to-a-data-service-query-wcf-data-services.md)."},{"content":"Query options give you another way to express the syntactic components of a LINQ query.","pos":[7588,7675]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>LINQ Considerations<ept id=\"p1\">](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md)</ept>.","pos":[7676,7802],"source":" For more information, see [LINQ Considerations](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md)."},{"pos":[7810,8130],"content":"[!NOTE]\n The `$select` query option cannot be added to a query URI by using the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method. We recommend that you use the LINQ <xref:System.Linq.Enumerable.Select%2A> method to have the client generate the `$select` query option in the request URI.","leadings":["","> "],"nodes":[{"content":"The `$select` query option cannot be added to a query URI by using the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method. We recommend that you use the LINQ <xref:System.Linq.Enumerable.Select%2A> method to have the client generate the `$select` query option in the request URI.","pos":[9,318],"nodes":[{"content":"The <ph id=\"ph1\">`$select`</ph> query option cannot be added to a query URI by using the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A&gt;</ph> method.","pos":[0,152],"source":"The `$select` query option cannot be added to a query URI by using the <xref:System.Data.Services.Client.DataServiceQuery%601.AddQueryOption%2A> method."},{"content":"We recommend that you use the LINQ <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Select%2A&gt;</ph> method to have the client generate the <ph id=\"ph2\">`$select`</ph> query option in the request URI.","pos":[153,309],"source":" We recommend that you use the LINQ <xref:System.Linq.Enumerable.Select%2A> method to have the client generate the `$select` query option in the request URI."}]}]},{"pos":[8174,8204],"content":"Client versus Server Execution","linkify":"Client versus Server Execution","nodes":[{"content":"Client versus Server Execution","pos":[0,30]}]},{"content":"The client executes a query in two parts.","pos":[8208,8249]},{"content":"Whenever possible, expressions in a query are first evaluated on the client, and then a URI-based query is generated and sent to the data service for evaluation against data in the service.","pos":[8250,8439]},{"content":"Consider the following LINQ query:","pos":[8440,8474]},{"content":"In this example, the expression <ph id=\"ph1\">`(basePrice – (basePrice * discount))`</ph> is evaluated on the client.","pos":[8869,8967],"source":"In this example, the expression `(basePrice – (basePrice * discount))` is evaluated on the client."},{"content":"Because of this, the actual query URI <ph id=\"ph1\">`http://localhost:12345/northwind.svc/Products()?$filter=(UnitPrice gt 90.00M) and substringof('bike',ProductName)`</ph> that is sent to the data service contains the already calculated decimal value of <ph id=\"ph2\">`90`</ph> in the filter clause.","pos":[8968,9230],"source":" Because of this, the actual query URI `http://localhost:12345/northwind.svc/Products()?$filter=(UnitPrice gt 90.00M) and substringof('bike',ProductName)` that is sent to the data service contains the already calculated decimal value of `90` in the filter clause."},{"content":"The other parts of the filtering expression, including the substring expression, are evaluated by the data service.","pos":[9231,9346]},{"content":"Expressions that are evaluated on the client follow common language runtime (CLR) semantics, while expressions sent to the data service rely on the data service implementation of the <ph id=\"ph1\">[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]</ph> Protocol.","pos":[9347,9605],"source":" Expressions that are evaluated on the client follow common language runtime (CLR) semantics, while expressions sent to the data service rely on the data service implementation of the [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] Protocol."},{"content":"You should also be aware of scenarios where this separate evaluation may cause unexpected results, such as when both the client and service perform time-based evaluations in different time zones.","pos":[9606,9801]},{"pos":[9810,9825],"content":"Query Responses","linkify":"Query Responses","nodes":[{"content":"Query Responses","pos":[0,15]}]},{"content":"When executed, the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> returns an <ph id=\"ph2\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> of the requested entity type.","pos":[9829,9994],"source":"When executed, the <xref:System.Data.Services.Client.DataServiceQuery%601> returns an <xref:System.Collections.Generic.IEnumerable%601> of the requested entity type."},{"content":"This query result can be cast to a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.QueryOperationResponse%601&gt;</ph> object, as in the following example:","pos":[9995,10128],"source":" This query result can be cast to a <xref:System.Data.Services.Client.QueryOperationResponse%601> object, as in the following example:"},{"content":"The entity type instances that represent entities in the data service are created on the client by a process called object materialization.","pos":[10489,10628]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Object Materialization<ept id=\"p1\">](../../../../docs/framework/data/wcf/object-materialization-wcf-data-services.md)</ept>.","pos":[10629,10761],"source":" For more information, see [Object Materialization](../../../../docs/framework/data/wcf/object-materialization-wcf-data-services.md)."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.QueryOperationResponse%601&gt;</ph> object implements <ph id=\"ph2\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> to provide access to the results of the query.","pos":[10762,10942],"source":" The <xref:System.Data.Services.Client.QueryOperationResponse%601> object implements <xref:System.Collections.Generic.IEnumerable%601> to provide access to the results of the query."},{"pos":[10949,11116],"content":"The <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.QueryOperationResponse%601&gt;</ph> also has the following members that enable you to access additional information about a query result:","source":"The <xref:System.Data.Services.Client.QueryOperationResponse%601> also has the following members that enable you to access additional information about a query result:"},{"pos":[11126,11249],"content":"<ph id=\"ph1\">&lt;xref:System.Data.Services.Client.OperationResponse.Error%2A&gt;</ph> - gets an error thrown by the operation, if any has occurred.","source":"<xref:System.Data.Services.Client.OperationResponse.Error%2A> - gets an error thrown by the operation, if any has occurred."},{"pos":[11259,11409],"content":"<ph id=\"ph1\">&lt;xref:System.Data.Services.Client.OperationResponse.Headers%2A&gt;</ph> - contains the collection of HTTP response headers associated with the query response.","source":"<xref:System.Data.Services.Client.OperationResponse.Headers%2A> - contains the collection of HTTP response headers associated with the query response."},{"pos":[11419,11643],"content":"<ph id=\"ph1\">&lt;xref:System.Data.Services.Client.QueryOperationResponse.Query%2A&gt;</ph> - gets the original <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> that generated the <ph id=\"ph3\">&lt;xref:System.Data.Services.Client.QueryOperationResponse%601&gt;</ph>.","source":"<xref:System.Data.Services.Client.QueryOperationResponse.Query%2A> - gets the original <xref:System.Data.Services.Client.DataServiceQuery%601> that generated the <xref:System.Data.Services.Client.QueryOperationResponse%601>."},{"pos":[11653,11773],"content":"<ph id=\"ph1\">&lt;xref:System.Data.Services.Client.OperationResponse.StatusCode%2A&gt;</ph> - gets the HTTP response code for the query response.","source":"<xref:System.Data.Services.Client.OperationResponse.StatusCode%2A> - gets the HTTP response code for the query response."},{"pos":[11783,12080],"content":"<ph id=\"ph1\">&lt;xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A&gt;</ph> - gets the total number of entities in the entity set when the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A&gt;</ph> method was called on the <ph id=\"ph3\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph>.","source":"<xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A> - gets the total number of entities in the entity set when the <xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A> method was called on the <xref:System.Data.Services.Client.DataServiceQuery%601>."},{"pos":[12090,12300],"content":"<ph id=\"ph1\">&lt;xref:System.Data.Services.Client.QueryOperationResponse.GetContinuation%2A&gt;</ph> - returns a <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQueryContinuation&gt;</ph> object that contains the URI of the next page of results.","source":"<xref:System.Data.Services.Client.QueryOperationResponse.GetContinuation%2A> - returns a <xref:System.Data.Services.Client.DataServiceQueryContinuation> object that contains the URI of the next page of results."},{"content":"By default, <ph id=\"ph1\">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]</ph> only returns data that is explicitly selected by the query URI.","pos":[12307,12442],"source":"By default, [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] only returns data that is explicitly selected by the query URI."},{"content":"This gives you the option to explicitly load additional data from the data service when it is needed.","pos":[12443,12544]},{"content":"A request is sent to the data service each time you explicitly load data from the data service.","pos":[12545,12640]},{"content":"Data that can be explicitly loaded includes related entities, paged response data, and binary data streams.","pos":[12641,12748]},{"pos":[12756,13059],"content":"[!NOTE]\n Because a data service may return a paged response, we recommend that your application use the programming pattern to handle a paged data service response. For more information, see [Loading Deferred Content](../../../../docs/framework/data/wcf/loading-deferred-content-wcf-data-services.md).","leadings":["","> "],"nodes":[{"content":"Because a data service may return a paged response, we recommend that your application use the programming pattern to handle a paged data service response. For more information, see [Loading Deferred Content](../../../../docs/framework/data/wcf/loading-deferred-content-wcf-data-services.md).","pos":[9,301],"nodes":[{"content":"Because a data service may return a paged response, we recommend that your application use the programming pattern to handle a paged data service response.","pos":[0,155]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Loading Deferred Content<ept id=\"p1\">](../../../../docs/framework/data/wcf/loading-deferred-content-wcf-data-services.md)</ept>.","pos":[156,292],"source":" For more information, see [Loading Deferred Content](../../../../docs/framework/data/wcf/loading-deferred-content-wcf-data-services.md)."}]}]},{"content":"The amount of data returned by a query can also be reduced by specifying that only certain properties of an entity are returned in the response.","pos":[13066,13210]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Query Projections<ept id=\"p1\">](../../../../docs/framework/data/wcf/query-projections-wcf-data-services.md)</ept>.","pos":[13211,13333],"source":" For more information, see [Query Projections](../../../../docs/framework/data/wcf/query-projections-wcf-data-services.md)."},{"pos":[13342,13400],"content":"Getting a Count of the Total Number of Entities in the Set","linkify":"Getting a Count of the Total Number of Entities in the Set","nodes":[{"content":"Getting a Count of the Total Number of Entities in the Set","pos":[0,58]}]},{"content":"In some scenarios, it is helpful to know the total number of entities in an entity set and not merely the number returned by the query.","pos":[13404,13539]},{"content":"Call the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A&gt;</ph> method on the <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.DataServiceQuery%601&gt;</ph> to request that this total count of entities in the set be included with the query result.","pos":[13540,13786],"source":" Call the <xref:System.Data.Services.Client.DataServiceQuery%601.IncludeTotalCount%2A> method on the <xref:System.Data.Services.Client.DataServiceQuery%601> to request that this total count of entities in the set be included with the query result."},{"content":"In this case, the <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A&gt;</ph> property of the returned <ph id=\"ph2\">&lt;xref:System.Data.Services.Client.QueryOperationResponse%601&gt;</ph> returns the total number of entities in the set.","pos":[13787,14016],"source":" In this case, the <xref:System.Data.Services.Client.QueryOperationResponse%601.TotalCount%2A> property of the returned <xref:System.Data.Services.Client.QueryOperationResponse%601> returns the total number of entities in the set."},{"content":"You can also get only the total count of entities in the set either as an <ph id=\"ph1\">&lt;xref:System.Int32&gt;</ph> or as a <ph id=\"ph2\">&lt;xref:System.Int64&gt;</ph> value by calling the <ph id=\"ph3\">&lt;xref:System.Linq.Enumerable.Count%2A&gt;</ph> or <ph id=\"ph4\">&lt;xref:System.Linq.Enumerable.LongCount%2A&gt;</ph> methods respectively.","pos":[14023,14272],"source":"You can also get only the total count of entities in the set either as an <xref:System.Int32> or as a <xref:System.Int64> value by calling the <xref:System.Linq.Enumerable.Count%2A> or <xref:System.Linq.Enumerable.LongCount%2A> methods respectively."},{"content":"When these methods are called, a <ph id=\"ph1\">&lt;xref:System.Data.Services.Client.QueryOperationResponse%601&gt;</ph> is not returned; only the count value is returned.","pos":[14273,14418],"source":" When these methods are called, a <xref:System.Data.Services.Client.QueryOperationResponse%601> is not returned; only the count value is returned."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Determine the Number of Entities Returned by a Query<ept id=\"p1\">](../../../../docs/framework/data/wcf/number-of-entities-returned-by-a-query-wcf.md)</ept>.","pos":[14419,14591],"source":" For more information, see [How to: Determine the Number of Entities Returned by a Query](../../../../docs/framework/data/wcf/number-of-entities-returned-by-a-query-wcf.md)."},{"pos":[14600,14615],"content":"In This Section","linkify":"In This Section","nodes":[{"content":"In This Section","pos":[0,15]}]},{"pos":[14619,14714],"content":"<bpt id=\"p1\">[</bpt>Query Projections<ept id=\"p1\">](../../../../docs/framework/data/wcf/query-projections-wcf-data-services.md)</ept>","source":"[Query Projections](../../../../docs/framework/data/wcf/query-projections-wcf-data-services.md)"},{"pos":[14721,14826],"content":"<bpt id=\"p1\">[</bpt>Object Materialization<ept id=\"p1\">](../../../../docs/framework/data/wcf/object-materialization-wcf-data-services.md)</ept>","source":"[Object Materialization](../../../../docs/framework/data/wcf/object-materialization-wcf-data-services.md)"},{"pos":[14833,14932],"content":"<bpt id=\"p1\">[</bpt>LINQ Considerations<ept id=\"p1\">](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md)</ept>","source":"[LINQ Considerations](../../../../docs/framework/data/wcf/linq-considerations-wcf-data-services.md)"},{"pos":[14939,15071],"content":"<bpt id=\"p1\">[</bpt>How to: Execute Data Service Queries<ept id=\"p1\">](../../../../docs/framework/data/wcf/how-to-execute-data-service-queries-wcf-data-services.md)</ept>","source":"[How to: Execute Data Service Queries](../../../../docs/framework/data/wcf/how-to-execute-data-service-queries-wcf-data-services.md)"},{"pos":[15078,15236],"content":"<bpt id=\"p1\">[</bpt>How to: Add Query Options to a Data Service Query<ept id=\"p1\">](../../../../docs/framework/data/wcf/how-to-add-query-options-to-a-data-service-query-wcf-data-services.md)</ept>","source":"[How to: Add Query Options to a Data Service Query](../../../../docs/framework/data/wcf/how-to-add-query-options-to-a-data-service-query-wcf-data-services.md)"},{"pos":[15243,15388],"content":"<bpt id=\"p1\">[</bpt>How to: Determine the Number of Entities Returned by a Query<ept id=\"p1\">](../../../../docs/framework/data/wcf/number-of-entities-returned-by-a-query-wcf.md)</ept>","source":"[How to: Determine the Number of Entities Returned by a Query](../../../../docs/framework/data/wcf/number-of-entities-returned-by-a-query-wcf.md)"},{"pos":[15395,15550],"content":"<bpt id=\"p1\">[</bpt>How to: Specify Client Credentials for a Data Service Request<ept id=\"p1\">](../../../../docs/framework/data/wcf/specify-client-creds-for-a-data-service-request-wcf.md)</ept>","source":"[How to: Specify Client Credentials for a Data Service Request](../../../../docs/framework/data/wcf/specify-client-creds-for-a-data-service-request-wcf.md)"},{"pos":[15557,15699],"content":"<bpt id=\"p1\">[</bpt>How to: Set Headers in the Client Request<ept id=\"p1\">](../../../../docs/framework/data/wcf/how-to-set-headers-in-the-client-request-wcf-data-services.md)</ept>","source":"[How to: Set Headers in the Client Request](../../../../docs/framework/data/wcf/how-to-set-headers-in-the-client-request-wcf-data-services.md)"},{"pos":[15706,15824],"content":"<bpt id=\"p1\">[</bpt>How to: Project Query Results<ept id=\"p1\">](../../../../docs/framework/data/wcf/how-to-project-query-results-wcf-data-services.md)</ept>","source":"[How to: Project Query Results](../../../../docs/framework/data/wcf/how-to-project-query-results-wcf-data-services.md)"},{"pos":[15833,15841],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[15845,15952],"content":"<bpt id=\"p1\">[</bpt>WCF Data Services Client Library<ept id=\"p1\">](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)</ept>","source":"[WCF Data Services Client Library](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)"}]}