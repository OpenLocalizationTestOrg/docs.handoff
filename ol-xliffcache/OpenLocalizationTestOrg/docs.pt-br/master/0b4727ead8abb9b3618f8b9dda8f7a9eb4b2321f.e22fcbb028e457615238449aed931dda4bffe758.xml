{"content":"---\ntitle: \"Inferring Schemas from XML Documents\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nms.assetid: f3d97d53-614d-4a04-a174-87965b7405f6\nauthor: \"mairaw\"\nms.author: \"mairaw\"\n---\n# Inferring Schemas from XML Documents\nThis topic describes how to use the <xref:System.Xml.Schema.XmlSchemaInference> class to infer an XML Schema definition language (XSD) schema from the structure of an XML document.  \n  \n## The Schema Inference Process  \n The <xref:System.Xml.Schema.XmlSchemaInference> class of the <xref:System.Xml.Schema?displayProperty=nameWithType> namespace is used to generate one or more XML Schema definition language (XSD) schemas from the structure of an XML document. The generated schemas may be used to validate the original XML document.  \n  \n As an XML document is processed by the <xref:System.Xml.Schema.XmlSchemaInference> class, the <xref:System.Xml.Schema.XmlSchemaInference> class makes assumptions about the schema components that describe the elements and attributes in the XML document. The <xref:System.Xml.Schema.XmlSchemaInference> class also infers schema components in a constrained way by inferring the most restrictive type for a particular element or attribute. As more information about the XML document is gathered, these constraints are loosened by inferring less restrictive types. The least restrictive type that can be inferred is `xs:string`.  \n  \n Take, for example, the following piece of an XML document.  \n  \n```xml  \n<parent attribute1=\"6\">  \n    <child>One</child>  \n    <child>Two</child>  \n</parent>  \n<parent attribute1=\"A\">  \n```  \n  \n In the example above, when the `attribute1` attribute is encountered with a value of `6` by the <xref:System.Xml.Schema.XmlSchemaInference> process, it is assumed to be of type `xs:unsignedByte`. When the second `parent` element is encountered by the <xref:System.Xml.Schema.XmlSchemaInference> process, the constraint is loosened by modifying the type to `xs:string` because the value of the `attribute1` attribute is now `A`. Similarly, the `minOccurs` attribute for all the `child` elements inferred in the schema are loosened to `minOccurs=\"0\"` because the second parent element has no child elements.  \n  \n## Inferring Schemas from XML Documents  \n The <xref:System.Xml.Schema.XmlSchemaInference> class uses two overloaded <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A> methods to infer a schema from an XML document.  \n  \n The first <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method is used to create a schema based on an XML document. The second <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method is used to infer a schema that describes multiple XML documents. For example, you can feed multiple XML documents to the <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method one at a time to produce a schema that describes the entire set of XML documents.  \n  \n The first <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method infers a schema from an XML document contained in an <xref:System.Xml.XmlReader> object, and returns an <xref:System.Xml.Schema.XmlSchemaSet> object containing the inferred schema. The second <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method searches an <xref:System.Xml.Schema.XmlSchemaSet> object for a schema with the same target namespace as the XML document contained in the <xref:System.Xml.XmlReader> object, refines the existing schema, and returns an <xref:System.Xml.Schema.XmlSchemaSet> object containing the inferred schema.  \n  \n The changes made to the refined schema are based on new structure found in the XML document. For example, as an XML document is traversed, assumptions are made about the data types found, and the schema is created based on those assumptions. However, if data is encountered on a second inference pass that differs from the original assumption, the schema is refined. The following example illustrates the refinement process.  \n  \n [!code-cpp[XmlSchemaInferenceExamples#4](../../../../samples/snippets/cpp/VS_Snippets_Data/XmlSchemaInferenceExamples/CPP/XmlSchemaInferenceExamples.cpp#4)]\n [!code-csharp[XmlSchemaInferenceExamples#4](../../../../samples/snippets/csharp/VS_Snippets_Data/XmlSchemaInferenceExamples/CS/XmlSchemaInferenceExamples.cs#4)]\n [!code-vb[XmlSchemaInferenceExamples#4](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XmlSchemaInferenceExamples/VB/XmlSchemaInferenceExamples.vb#4)]  \n  \n The example takes the following file, `item1.xml`, as its first input.  \n  \n [!code-xml[XmlSchemaInferenceExamples#13](../../../../samples/snippets/xml/VS_Snippets_Data/XmlSchemaInferenceExamples/XML/item1.xml#13)]  \n  \n The example then takes the `item2.xml` file as its second input:  \n  \n [!code-xml[XmlSchemaInferenceExamples#14](../../../../samples/snippets/xml/VS_Snippets_Data/XmlSchemaInferenceExamples/XML/item2.xml#14)]  \n  \n When the `productID` attribute is encountered in the first XML document, the value of `123456789` is assumed to be an `xs:unsignedInt` type. However, when the second XML document is read and the value of `A53-246` is found, the `xs:unsignedInt` type can no longer be assumed. The schema is refined and the type of `productID` is changed to `xs:string`. In addition, the `minOccurs` attribute for the `supplierID` element is set to `0`, because the second XML document contains no `supplierID` element.  \n  \n The following is the schema inferred from the first XML document.  \n  \n [!code-xml[XmlSchemaInferenceExamples#15](../../../../samples/snippets/xml/VS_Snippets_Data/XmlSchemaInferenceExamples/XML/InferSchema1.xml#15)]  \n  \n The following is the schema inferred from the first XML document, refined by the second XML document.  \n  \n [!code-xml[XmlSchemaInferenceExamples#16](../../../../samples/snippets/xml/VS_Snippets_Data/XmlSchemaInferenceExamples/XML/InferSchema2.xml#16)]  \n  \n## Inline Schemas  \n If an inline XML Schema definition language (XSD) schema is encountered during the <xref:System.Xml.Schema.XmlSchemaInference> process, an <xref:System.Xml.Schema.XmlSchemaInferenceException> is thrown. For example, the following inline schema throws an <xref:System.Xml.Schema.XmlSchemaInferenceException>.  \n  \n```xml  \n<root xmlns:ex=\"http://www.contoso.com\" xmlns=\"http://www.tempuri.org\">  \n    <xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" targetNamespace=\"http://www.contoso.com\">  \n        <xs:element name=\"Contoso\" type=\"xs:normalizedString\" />  \n    </xs:schema>  \n    <ex:Contoso>Test</ex:Contoso>  \n</root>  \n```  \n  \n## Schemas that Cannot be Refined  \n There are W3C XML Schema constructs that the XML Schema definition language (XSD) schema <xref:System.Xml.Schema.XmlSchemaInference> process cannot handle if given a type to refine and cause an exception to be thrown. Such as a complex type whose top-level compositor is anything other than a sequence. In the Schema Object Model (SOM), this corresponds to an <xref:System.Xml.Schema.XmlSchemaComplexType> whose <xref:System.Xml.Schema.XmlSchemaComplexType.Particle%2A> property is not an instance of <xref:System.Xml.Schema.XmlSchemaSequence>.  \n  \n## See also\n\n- <xref:System.Xml.Schema.XmlSchemaInference>\n- [XML Schema Object Model (SOM)](../../../../docs/standard/data/xml/xml-schema-object-model-som.md)\n- [Inferring an XML Schema](../../../../docs/standard/data/xml/inferring-an-xml-schema.md)\n- [Rules for Inferring Schema Node Types and Structure](../../../../docs/standard/data/xml/rules-for-inferring-schema-node-types-and-structure.md)\n- [Rules for Inferring Simple Types](../../../../docs/standard/data/xml/rules-for-inferring-simple-types.md)\n","nodes":[{"pos":[4,232],"embed":true,"restype":"x-metadata","content":"title: \"Inferring Schemas from XML Documents\"\nms.date: \"03/30/2017\"\nms.technology: dotnet-standard\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nms.assetid: f3d97d53-614d-4a04-a174-87965b7405f6\nauthor: \"mairaw\"\nms.author: \"mairaw\"","nodes":[{"content":"Inferring Schemas from XML Documents","nodes":[{"pos":[0,36],"content":"Inferring Schemas from XML Documents","nodes":[{"content":"Inferring Schemas from XML Documents","pos":[0,36]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[239,275],"content":"Inferring Schemas from XML Documents","linkify":"Inferring Schemas from XML Documents","nodes":[{"content":"Inferring Schemas from XML Documents","pos":[0,36]}]},{"pos":[276,456],"content":"This topic describes how to use the <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInference&gt;</ph> class to infer an XML Schema definition language (XSD) schema from the structure of an XML document.","source":"This topic describes how to use the <xref:System.Xml.Schema.XmlSchemaInference> class to infer an XML Schema definition language (XSD) schema from the structure of an XML document."},{"pos":[465,493],"content":"The Schema Inference Process","linkify":"The Schema Inference Process","nodes":[{"content":"The Schema Inference Process","pos":[0,28]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInference&gt;</ph> class of the <ph id=\"ph2\">&lt;xref:System.Xml.Schema?displayProperty=nameWithType&gt;</ph> namespace is used to generate one or more XML Schema definition language (XSD) schemas from the structure of an XML document.","pos":[497,737],"source":"The <xref:System.Xml.Schema.XmlSchemaInference> class of the <xref:System.Xml.Schema?displayProperty=nameWithType> namespace is used to generate one or more XML Schema definition language (XSD) schemas from the structure of an XML document."},{"content":"The generated schemas may be used to validate the original XML document.","pos":[738,810]},{"content":"As an XML document is processed by the <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInference&gt;</ph> class, the <ph id=\"ph2\">&lt;xref:System.Xml.Schema.XmlSchemaInference&gt;</ph> class makes assumptions about the schema components that describe the elements and attributes in the XML document.","pos":[817,1069],"source":"As an XML document is processed by the <xref:System.Xml.Schema.XmlSchemaInference> class, the <xref:System.Xml.Schema.XmlSchemaInference> class makes assumptions about the schema components that describe the elements and attributes in the XML document."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInference&gt;</ph> class also infers schema components in a constrained way by inferring the most restrictive type for a particular element or attribute.","pos":[1070,1252],"source":" The <xref:System.Xml.Schema.XmlSchemaInference> class also infers schema components in a constrained way by inferring the most restrictive type for a particular element or attribute."},{"content":"As more information about the XML document is gathered, these constraints are loosened by inferring less restrictive types.","pos":[1253,1376]},{"content":"The least restrictive type that can be inferred is <ph id=\"ph1\">`xs:string`</ph>.","pos":[1377,1440],"source":" The least restrictive type that can be inferred is `xs:string`."},{"content":"Take, for example, the following piece of an XML document.","pos":[1447,1505]},{"content":"In the example above, when the <ph id=\"ph1\">`attribute1`</ph> attribute is encountered with a value of <ph id=\"ph2\">`6`</ph> by the <ph id=\"ph3\">&lt;xref:System.Xml.Schema.XmlSchemaInference&gt;</ph> process, it is assumed to be of type <ph id=\"ph4\">`xs:unsignedByte`</ph>.","pos":[1644,1839],"source":"In the example above, when the `attribute1` attribute is encountered with a value of `6` by the <xref:System.Xml.Schema.XmlSchemaInference> process, it is assumed to be of type `xs:unsignedByte`."},{"content":"When the second <ph id=\"ph1\">`parent`</ph> element is encountered by the <ph id=\"ph2\">&lt;xref:System.Xml.Schema.XmlSchemaInference&gt;</ph> process, the constraint is loosened by modifying the type to <ph id=\"ph3\">`xs:string`</ph> because the value of the <ph id=\"ph4\">`attribute1`</ph> attribute is now <ph id=\"ph5\">`A`</ph>.","pos":[1840,2071],"source":" When the second `parent` element is encountered by the <xref:System.Xml.Schema.XmlSchemaInference> process, the constraint is loosened by modifying the type to `xs:string` because the value of the `attribute1` attribute is now `A`."},{"content":"Similarly, the <ph id=\"ph1\">`minOccurs`</ph> attribute for all the <ph id=\"ph2\">`child`</ph> elements inferred in the schema are loosened to <ph id=\"ph3\">`minOccurs=\"0\"`</ph> because the second parent element has no child elements.","pos":[2072,2249],"source":" Similarly, the `minOccurs` attribute for all the `child` elements inferred in the schema are loosened to `minOccurs=\"0\"` because the second parent element has no child elements."},{"pos":[2258,2294],"content":"Inferring Schemas from XML Documents","linkify":"Inferring Schemas from XML Documents","nodes":[{"content":"Inferring Schemas from XML Documents","pos":[0,36]}]},{"pos":[2298,2478],"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInference&gt;</ph> class uses two overloaded <ph id=\"ph2\">&lt;xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A&gt;</ph> methods to infer a schema from an XML document.","source":"The <xref:System.Xml.Schema.XmlSchemaInference> class uses two overloaded <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A> methods to infer a schema from an XML document."},{"content":"The first <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType&gt;</ph> method is used to create a schema based on an XML document.","pos":[2485,2642],"source":"The first <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method is used to create a schema based on an XML document."},{"content":"The second <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType&gt;</ph> method is used to infer a schema that describes multiple XML documents.","pos":[2643,2813],"source":" The second <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method is used to infer a schema that describes multiple XML documents."},{"content":"For example, you can feed multiple XML documents to the <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType&gt;</ph> method one at a time to produce a schema that describes the entire set of XML documents.","pos":[2814,3046],"source":" For example, you can feed multiple XML documents to the <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method one at a time to produce a schema that describes the entire set of XML documents."},{"content":"The first <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType&gt;</ph> method infers a schema from an XML document contained in an <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph> object, and returns an <ph id=\"ph3\">&lt;xref:System.Xml.Schema.XmlSchemaSet&gt;</ph> object containing the inferred schema.","pos":[3053,3338],"source":"The first <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method infers a schema from an XML document contained in an <xref:System.Xml.XmlReader> object, and returns an <xref:System.Xml.Schema.XmlSchemaSet> object containing the inferred schema."},{"content":"The second <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType&gt;</ph> method searches an <ph id=\"ph2\">&lt;xref:System.Xml.Schema.XmlSchemaSet&gt;</ph> object for a schema with the same target namespace as the XML document contained in the <ph id=\"ph3\">&lt;xref:System.Xml.XmlReader&gt;</ph> object, refines the existing schema, and returns an <ph id=\"ph4\">&lt;xref:System.Xml.Schema.XmlSchemaSet&gt;</ph> object containing the inferred schema.","pos":[3339,3739],"source":" The second <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method searches an <xref:System.Xml.Schema.XmlSchemaSet> object for a schema with the same target namespace as the XML document contained in the <xref:System.Xml.XmlReader> object, refines the existing schema, and returns an <xref:System.Xml.Schema.XmlSchemaSet> object containing the inferred schema."},{"content":"The changes made to the refined schema are based on new structure found in the XML document.","pos":[3746,3838]},{"content":"For example, as an XML document is traversed, assumptions are made about the data types found, and the schema is created based on those assumptions.","pos":[3839,3987]},{"content":"However, if data is encountered on a second inference pass that differs from the original assumption, the schema is refined.","pos":[3988,4112]},{"content":"The following example illustrates the refinement process.","pos":[4113,4170]},{"pos":[4665,4735],"content":"The example takes the following file, <ph id=\"ph1\">`item1.xml`</ph>, as its first input.","source":"The example takes the following file, `item1.xml`, as its first input."},{"pos":[4886,4950],"content":"The example then takes the <ph id=\"ph1\">`item2.xml`</ph> file as its second input:","source":"The example then takes the `item2.xml` file as its second input:"},{"content":"When the <ph id=\"ph1\">`productID`</ph> attribute is encountered in the first XML document, the value of <ph id=\"ph2\">`123456789`</ph> is assumed to be an <ph id=\"ph3\">`xs:unsignedInt`</ph> type.","pos":[5101,5241],"source":"When the `productID` attribute is encountered in the first XML document, the value of `123456789` is assumed to be an `xs:unsignedInt` type."},{"content":"However, when the second XML document is read and the value of <ph id=\"ph1\">`A53-246`</ph> is found, the <ph id=\"ph2\">`xs:unsignedInt`</ph> type can no longer be assumed.","pos":[5242,5376],"source":" However, when the second XML document is read and the value of `A53-246` is found, the `xs:unsignedInt` type can no longer be assumed."},{"content":"The schema is refined and the type of <ph id=\"ph1\">`productID`</ph> is changed to <ph id=\"ph2\">`xs:string`</ph>.","pos":[5377,5453],"source":" The schema is refined and the type of `productID` is changed to `xs:string`."},{"content":"In addition, the <ph id=\"ph1\">`minOccurs`</ph> attribute for the <ph id=\"ph2\">`supplierID`</ph> element is set to <ph id=\"ph3\">`0`</ph>, because the second XML document contains no <ph id=\"ph4\">`supplierID`</ph> element.","pos":[5454,5602],"source":" In addition, the `minOccurs` attribute for the `supplierID` element is set to `0`, because the second XML document contains no `supplierID` element."},{"content":"The following is the schema inferred from the first XML document.","pos":[5609,5674]},{"content":"The following is the schema inferred from the first XML document, refined by the second XML document.","pos":[5832,5933]},{"pos":[6093,6107],"content":"Inline Schemas","linkify":"Inline Schemas","nodes":[{"content":"Inline Schemas","pos":[0,14]}]},{"content":"If an inline XML Schema definition language (XSD) schema is encountered during the <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInference&gt;</ph> process, an <ph id=\"ph2\">&lt;xref:System.Xml.Schema.XmlSchemaInferenceException&gt;</ph> is thrown.","pos":[6111,6313],"source":"If an inline XML Schema definition language (XSD) schema is encountered during the <xref:System.Xml.Schema.XmlSchemaInference> process, an <xref:System.Xml.Schema.XmlSchemaInferenceException> is thrown."},{"content":"For example, the following inline schema throws an <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInferenceException&gt;</ph>.","pos":[6314,6418],"source":" For example, the following inline schema throws an <xref:System.Xml.Schema.XmlSchemaInferenceException>."},{"pos":[6754,6784],"content":"Schemas that Cannot be Refined","linkify":"Schemas that Cannot be Refined","nodes":[{"content":"Schemas that Cannot be Refined","pos":[0,30]}]},{"content":"There are W3C XML Schema constructs that the XML Schema definition language (XSD) schema <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaInference&gt;</ph> process cannot handle if given a type to refine and cause an exception to be thrown.","pos":[6788,7005],"source":"There are W3C XML Schema constructs that the XML Schema definition language (XSD) schema <xref:System.Xml.Schema.XmlSchemaInference> process cannot handle if given a type to refine and cause an exception to be thrown."},{"content":"Such as a complex type whose top-level compositor is anything other than a sequence.","pos":[7006,7090]},{"content":"In the Schema Object Model (SOM), this corresponds to an <ph id=\"ph1\">&lt;xref:System.Xml.Schema.XmlSchemaComplexType&gt;</ph> whose <ph id=\"ph2\">&lt;xref:System.Xml.Schema.XmlSchemaComplexType.Particle%2A&gt;</ph> property is not an instance of <ph id=\"ph3\">&lt;xref:System.Xml.Schema.XmlSchemaSequence&gt;</ph>.","pos":[7091,7332],"source":" In the Schema Object Model (SOM), this corresponds to an <xref:System.Xml.Schema.XmlSchemaComplexType> whose <xref:System.Xml.Schema.XmlSchemaComplexType.Particle%2A> property is not an instance of <xref:System.Xml.Schema.XmlSchemaSequence>."},{"pos":[7341,7349],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[7399,7497],"content":"<bpt id=\"p1\">[</bpt>XML Schema Object Model (SOM)<ept id=\"p1\">](../../../../docs/standard/data/xml/xml-schema-object-model-som.md)</ept>","source":"[XML Schema Object Model (SOM)](../../../../docs/standard/data/xml/xml-schema-object-model-som.md)"},{"pos":[7500,7588],"content":"<bpt id=\"p1\">[</bpt>Inferring an XML Schema<ept id=\"p1\">](../../../../docs/standard/data/xml/inferring-an-xml-schema.md)</ept>","source":"[Inferring an XML Schema](../../../../docs/standard/data/xml/inferring-an-xml-schema.md)"},{"pos":[7591,7735],"content":"<bpt id=\"p1\">[</bpt>Rules for Inferring Schema Node Types and Structure<ept id=\"p1\">](../../../../docs/standard/data/xml/rules-for-inferring-schema-node-types-and-structure.md)</ept>","source":"[Rules for Inferring Schema Node Types and Structure](../../../../docs/standard/data/xml/rules-for-inferring-schema-node-types-and-structure.md)"},{"pos":[7738,7844],"content":"<bpt id=\"p1\">[</bpt>Rules for Inferring Simple Types<ept id=\"p1\">](../../../../docs/standard/data/xml/rules-for-inferring-simple-types.md)</ept>","source":"[Rules for Inferring Simple Types](../../../../docs/standard/data/xml/rules-for-inferring-simple-types.md)"}]}