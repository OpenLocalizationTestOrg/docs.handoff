{"content":"---\ntitle: \"Large UDTs\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 420ae24e-762b-4e09-b4c3-2112c470ee49\n---\n# Large UDTs\nUser-defined types (UDTs) allow a developer to extend the server's scalar type system by storing common language runtime (CLR) objects in a SQL Server database. UDTs can contain multiple elements and can have behaviors, unlike the traditional alias data types, which consist of a single SQL Server system data type.  \n  \n> [!NOTE]\n>  You must install the .NET Framework 3.5 SP1 (or later) to take advantage of the enhanced SqlClient support for large UDTs.  \n  \n Previously, UDTs were restricted to a maximum size of 8 kilobytes. In SQL Server 2008, this restriction has been removed for UDTs that have a format of <xref:Microsoft.SqlServer.Server.Format.UserDefined>.  \n  \n For the complete documentation for user-defined types, see the version of SQL Server Books Online for the version of SQL Server you are using.  \n  \n **SQL Server Books Online**  \n  \n1.  [CLR User-Defined Types](https://go.microsoft.com/fwlink/?LinkId=98366)  \n  \n## Retrieving UDT Schemas Using GetSchema  \n The <xref:System.Data.SqlClient.SqlConnection.GetSchema%2A> method of <xref:System.Data.SqlClient.SqlConnection> returns database schema information in a <xref:System.Data.DataTable>. For more information, see [SQL Server Schema Collections](../../../../../docs/framework/data/adonet/sql-server-schema-collections.md).  \n  \n### GetSchemaTable Column Values for UDTs  \n The <xref:System.Data.SqlClient.SqlDataReader.GetSchemaTable%2A> method of a <xref:System.Data.SqlClient.SqlDataReader> returns a <xref:System.Data.DataTable> that describes column metadata. The following table describes the differences in the column metadata for large UDTs between SQL Server 2005 and SQL Server 2008.  \n  \n|SqlDataReader column|SQL Server 2005|SQL Server 2008 and later|  \n|--------------------------|---------------------|-------------------------------|  \n|`ColumnSize`|Varies|Varies|  \n|`NumericPrecision`|255|255|  \n|`NumericScale`|255|255|  \n|`DataType`|`Byte[]`|UDT instance|  \n|`ProviderSpecificDataType`|`SqlTypes.SqlBinary`|UDT instance|  \n|`ProviderType`|21 (`SqlDbType.VarBinary`)|29 (`SqlDbType.Udt`)|  \n|`NonVersionedProviderType`|29 (`SqlDbType.Udt`)|29 (`SqlDbType.Udt`)|  \n|`DataTypeName`|`SqlDbType.VarBinary`|The three part name specified as *Database.SchemaName.TypeName*.|  \n|`IsLong`|Varies|Varies|  \n  \n## SqlDataReader Considerations  \n The <xref:System.Data.SqlClient.SqlDataReader> has been extended beginning in SQL Server 2008 to support retrieving large UDT values. How large UDT values are processed by a <xref:System.Data.SqlClient.SqlDataReader> depends on the version of SQL Server you are using, as well as on the `Type System Version` specified in the connection string. For more information, see <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A>.  \n  \n The following methods of <xref:System.Data.SqlClient.SqlDataReader> will return a <xref:System.Data.SqlTypes.SqlBinary> instead of a UDT when the `Type System Version` is set to SQL Server 2005:  \n  \n-   <xref:System.Data.SqlClient.SqlDataReader.GetProviderSpecificFieldType%2A>  \n  \n-   <xref:System.Data.SqlClient.SqlDataReader.GetProviderSpecificValue%2A>  \n  \n-   <xref:System.Data.SqlClient.SqlDataReader.GetProviderSpecificValues%2A>  \n  \n-   <xref:System.Data.SqlClient.SqlDataReader.GetSqlValue%2A>  \n  \n-   <xref:System.Data.SqlClient.SqlDataReader.GetSqlValues%2A>  \n  \n The following methods will return an array of `Byte[]` instead of a UDT when the `Type System Version` is set to SQL Server 2005:  \n  \n-   <xref:System.Data.SqlClient.SqlDataReader.GetValue%2A>  \n  \n-   <xref:System.Data.SqlClient.SqlDataReader.GetValues%2A>  \n  \n Note that no conversions are made for the current version of ADO.NET.  \n  \n## Specifying SqlParameters  \n The following <xref:System.Data.SqlClient.SqlParameter> properties have been extended to work with large UDTs.  \n  \n|SqlParameter Property|Description|  \n|---------------------------|-----------------|  \n|<xref:System.Data.SqlClient.SqlParameter.Value%2A>|Gets or sets an object that represents the value of the parameter. The default is null. The property can be `SqlBinary`, `Byte[]`, or a managed object.|  \n|<xref:System.Data.SqlClient.SqlParameter.SqlValue%2A>|Gets or sets an object that represents the value of the parameter. The default is null. The property can be `SqlBinary`, `Byte[]`, or a managed object.|  \n|<xref:System.Data.SqlClient.SqlParameter.Size%2A>|Gets or sets the size of the parameter value to resolve. The default value is 0. The property can be an integer that represents the size of the parameter value. For large UDTs, it can be the actual size of the UDT, or -1 for unknown.|  \n  \n## Retrieving Data Example  \n The following code fragment demonstrates how to retrieve large UDT data. The `connectionString` variable assumes a valid connection to a SQL Server database and the `commandString` variable assumes a valid SELECT statement with the primary key column listed first.  \n  \n```csharp  \nusing (SqlConnection connection = new SqlConnection(   \n    connectionString, commandString))  \n{  \n  connection.Open();  \n  SqlCommand command = new SqlCommand(commandString);  \n  SqlDataReader reader = command.ExecuteReader();  \n  while (reader.Read())  \n  {  \n    // Retrieve the value of the Primary Key column.  \n    int id = reader.GetInt32(0);  \n  \n    // Retrieve the value of the UDT.  \n    LargeUDT udt = (LargeUDT)reader[1];  \n  \n    // You can also use GetSqlValue and GetValue.  \n    // LargeUDT udt = (LargeUDT)reader.GetSqlValue(1);  \n    // LargeUDT udt = (LargeUDT)reader.GetValue(1);  \n  \n    Console.WriteLine(  \n     \"ID={0} LargeUDT={1}\", id, udt);  \n  }  \nreader.close  \n}  \n```  \n  \n```vb  \nUsing connection As New SqlConnection( _  \n    connectionString, commandString)  \n    connection.Open()  \n    Dim command As New SqlCommand(commandString, connection)  \n    Dim reader As SqlDataReader  \n    reader = command.ExecuteReader  \n  \n    While reader.Read()  \n      ' Retrieve the value of the Primary Key column.  \n      Dim id As Int32 = reader.GetInt32(0)  \n  \n      ' Retrieve the value of the UDT.  \n      Dim udt As LargeUDT = CType(reader(1), LargeUDT)  \n  \n     ' You can also use GetSqlValue and GetValue.  \n     ' Dim udt As LargeUDT = CType(reader.GetSqlValue(1), LargeUDT)  \n     ' Dim udt As LargeUDT = CType(reader.GetValue(1), LargeUDT)  \n  \n      ' Print values.  \n      Console.WriteLine(\"ID={0} LargeUDT={1}\", id, udt)  \n    End While  \n    reader.Close()  \nEnd Using  \n```  \n  \n## See also\n\n- [Configuring Parameters and Parameter Data Types](../../../../../docs/framework/data/adonet/configuring-parameters-and-parameter-data-types.md)\n- [Retrieving Database Schema Information](../../../../../docs/framework/data/adonet/retrieving-database-schema-information.md)\n- [SQL Server Data Type Mappings](../../../../../docs/framework/data/adonet/sql-server-data-type-mappings.md)\n- [SQL Server Binary and Large-Value Data](../../../../../docs/framework/data/adonet/sql/sql-server-binary-and-large-value-data.md)\n- [ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)\n","nodes":[{"pos":[4,128],"embed":true,"restype":"x-metadata","content":"title: \"Large UDTs\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 420ae24e-762b-4e09-b4c3-2112c470ee49","nodes":[{"content":"Large UDTs","nodes":[{"pos":[0,10],"content":"Large UDTs","nodes":[{"content":"Large UDTs","pos":[0,10]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[135,145],"content":"Large UDTs","linkify":"Large UDTs","nodes":[{"content":"Large UDTs","pos":[0,10]}]},{"content":"User-defined types (UDTs) allow a developer to extend the server's scalar type system by storing common language runtime (CLR) objects in a SQL Server database.","pos":[146,306]},{"content":"UDTs can contain multiple elements and can have behaviors, unlike the traditional alias data types, which consist of a single SQL Server system data type.","pos":[307,461]},{"pos":[469,602],"content":"[!NOTE]\n You must install the .NET Framework 3.5 SP1 (or later) to take advantage of the enhanced SqlClient support for large UDTs.","leadings":["","> "],"nodes":[{"content":"You must install the .NET Framework 3.5 SP1 (or later) to take advantage of the enhanced SqlClient support for large UDTs.","pos":[9,131]}]},{"content":"Previously, UDTs were restricted to a maximum size of 8 kilobytes.","pos":[609,675]},{"content":"In SQL Server 2008, this restriction has been removed for UDTs that have a format of <ph id=\"ph1\">&lt;xref:Microsoft.SqlServer.Server.Format.UserDefined&gt;</ph>.","pos":[676,814],"source":" In SQL Server 2008, this restriction has been removed for UDTs that have a format of <xref:Microsoft.SqlServer.Server.Format.UserDefined>."},{"content":"For the complete documentation for user-defined types, see the version of SQL Server Books Online for the version of SQL Server you are using.","pos":[821,963]},{"pos":[970,997],"content":"<bpt id=\"p1\">**</bpt>SQL Server Books Online<ept id=\"p1\">**</ept>","source":"**SQL Server Books Online**"},{"pos":[1007,1078],"content":"<bpt id=\"p1\">[</bpt>CLR User-Defined Types<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=98366)</ept>","source":"[CLR User-Defined Types](https://go.microsoft.com/fwlink/?LinkId=98366)"},{"pos":[1087,1125],"content":"Retrieving UDT Schemas Using GetSchema","linkify":"Retrieving UDT Schemas Using GetSchema","nodes":[{"content":"Retrieving UDT Schemas Using GetSchema","pos":[0,38]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlConnection.GetSchema%2A&gt;</ph> method of <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlConnection&gt;</ph> returns database schema information in a <ph id=\"ph3\">&lt;xref:System.Data.DataTable&gt;</ph>.","pos":[1129,1312],"source":"The <xref:System.Data.SqlClient.SqlConnection.GetSchema%2A> method of <xref:System.Data.SqlClient.SqlConnection> returns database schema information in a <xref:System.Data.DataTable>."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>SQL Server Schema Collections<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql-server-schema-collections.md)</ept>.","pos":[1313,1447],"source":" For more information, see [SQL Server Schema Collections](../../../../../docs/framework/data/adonet/sql-server-schema-collections.md)."},{"pos":[1457,1494],"content":"GetSchemaTable Column Values for UDTs","linkify":"GetSchemaTable Column Values for UDTs","nodes":[{"content":"GetSchemaTable Column Values for UDTs","pos":[0,37]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlDataReader.GetSchemaTable%2A&gt;</ph> method of a <ph id=\"ph2\">&lt;xref:System.Data.SqlClient.SqlDataReader&gt;</ph> returns a <ph id=\"ph3\">&lt;xref:System.Data.DataTable&gt;</ph> that describes column metadata.","pos":[1498,1688],"source":"The <xref:System.Data.SqlClient.SqlDataReader.GetSchemaTable%2A> method of a <xref:System.Data.SqlClient.SqlDataReader> returns a <xref:System.Data.DataTable> that describes column metadata."},{"content":"The following table describes the differences in the column metadata for large UDTs between SQL Server 2005 and SQL Server 2008.","pos":[1689,1817]},{"content":"SqlDataReader column","pos":[1824,1844]},{"content":"SQL Server 2005","pos":[1845,1860]},{"content":"SQL Server 2008 and later","pos":[1861,1886]},{"content":"Varies","pos":[1989,1995]},{"content":"Varies","pos":[1996,2002]},{"content":"255","pos":[2026,2029]},{"content":"255","pos":[2030,2033]},{"content":"255","pos":[2053,2056]},{"content":"255","pos":[2057,2060]},{"content":"UDT instance","pos":[2085,2097]},{"content":"UDT instance","pos":[2150,2162]},{"pos":[2182,2208],"content":"21 (<ph id=\"ph1\">`SqlDbType.VarBinary`</ph>)","source":"21 (`SqlDbType.VarBinary`)"},{"pos":[2209,2229],"content":"29 (<ph id=\"ph1\">`SqlDbType.Udt`</ph>)","source":"29 (`SqlDbType.Udt`)"},{"pos":[2261,2281],"content":"29 (<ph id=\"ph1\">`SqlDbType.Udt`</ph>)","source":"29 (`SqlDbType.Udt`)"},{"pos":[2282,2302],"content":"29 (<ph id=\"ph1\">`SqlDbType.Udt`</ph>)","source":"29 (`SqlDbType.Udt`)"},{"pos":[2344,2408],"content":"The three part name specified as <bpt id=\"p1\">*</bpt>Database.SchemaName.TypeName<ept id=\"p1\">*</ept>.","source":"The three part name specified as *Database.SchemaName.TypeName*."},{"content":"Varies","pos":[2422,2428]},{"content":"Varies","pos":[2429,2435]},{"pos":[2445,2473],"content":"SqlDataReader Considerations","linkify":"SqlDataReader Considerations","nodes":[{"content":"SqlDataReader Considerations","pos":[0,28]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlDataReader&gt;</ph> has been extended beginning in SQL Server 2008 to support retrieving large UDT values.","pos":[2477,2610],"source":"The <xref:System.Data.SqlClient.SqlDataReader> has been extended beginning in SQL Server 2008 to support retrieving large UDT values."},{"content":"How large UDT values are processed by a <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlDataReader&gt;</ph> depends on the version of SQL Server you are using, as well as on the <ph id=\"ph2\">`Type System Version`</ph> specified in the connection string.","pos":[2611,2821],"source":" How large UDT values are processed by a <xref:System.Data.SqlClient.SqlDataReader> depends on the version of SQL Server you are using, as well as on the `Type System Version` specified in the connection string."},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A&gt;</ph>.","pos":[2822,2911],"source":" For more information, see <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A>."},{"pos":[2918,3112],"content":"The following methods of <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlDataReader&gt;</ph> will return a <ph id=\"ph2\">&lt;xref:System.Data.SqlTypes.SqlBinary&gt;</ph> instead of a UDT when the <ph id=\"ph3\">`Type System Version`</ph> is set to SQL Server 2005:","source":"The following methods of <xref:System.Data.SqlClient.SqlDataReader> will return a <xref:System.Data.SqlTypes.SqlBinary> instead of a UDT when the `Type System Version` is set to SQL Server 2005:"},{"pos":[3499,3628],"content":"The following methods will return an array of <ph id=\"ph1\">`Byte[]`</ph> instead of a UDT when the <ph id=\"ph2\">`Type System Version`</ph> is set to SQL Server 2005:","source":"The following methods will return an array of `Byte[]` instead of a UDT when the `Type System Version` is set to SQL Server 2005:"},{"content":"Note that no conversions are made for the current version of ADO.NET.","pos":[3764,3833]},{"pos":[3842,3866],"content":"Specifying SqlParameters","linkify":"Specifying SqlParameters","nodes":[{"content":"Specifying SqlParameters","pos":[0,24]}]},{"pos":[3870,3980],"content":"The following <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlParameter&gt;</ph> properties have been extended to work with large UDTs.","source":"The following <xref:System.Data.SqlClient.SqlParameter> properties have been extended to work with large UDTs."},{"content":"SqlParameter Property","pos":[3987,4008]},{"content":"Description","pos":[4009,4020]},{"content":"Gets or sets an object that represents the value of the parameter.","pos":[4126,4192]},{"content":"The default is null.","pos":[4193,4213]},{"content":"The property can be <ph id=\"ph1\">`SqlBinary`</ph>, <ph id=\"ph2\">`Byte[]`</ph>, or a managed object.","pos":[4214,4277],"source":" The property can be `SqlBinary`, `Byte[]`, or a managed object."},{"content":"Gets or sets an object that represents the value of the parameter.","pos":[4336,4402]},{"content":"The default is null.","pos":[4403,4423]},{"content":"The property can be <ph id=\"ph1\">`SqlBinary`</ph>, <ph id=\"ph2\">`Byte[]`</ph>, or a managed object.","pos":[4424,4487],"source":" The property can be `SqlBinary`, `Byte[]`, or a managed object."},{"content":"Gets or sets the size of the parameter value to resolve.","pos":[4542,4598]},{"content":"The default value is 0.","pos":[4599,4622]},{"content":"The property can be an integer that represents the size of the parameter value.","pos":[4623,4702]},{"content":"For large UDTs, it can be the actual size of the UDT, or -1 for unknown.","pos":[4703,4775]},{"pos":[4785,4808],"content":"Retrieving Data Example","linkify":"Retrieving Data Example","nodes":[{"content":"Retrieving Data Example","pos":[0,23]}]},{"content":"The following code fragment demonstrates how to retrieve large UDT data.","pos":[4812,4884]},{"content":"The <ph id=\"ph1\">`connectionString`</ph> variable assumes a valid connection to a SQL Server database and the <ph id=\"ph2\">`commandString`</ph> variable assumes a valid SELECT statement with the primary key column listed first.","pos":[4885,5076],"source":" The `connectionString` variable assumes a valid connection to a SQL Server database and the `commandString` variable assumes a valid SELECT statement with the primary key column listed first."},{"pos":[6617,6625],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6629,6772],"content":"<bpt id=\"p1\">[</bpt>Configuring Parameters and Parameter Data Types<ept id=\"p1\">](../../../../../docs/framework/data/adonet/configuring-parameters-and-parameter-data-types.md)</ept>","source":"[Configuring Parameters and Parameter Data Types](../../../../../docs/framework/data/adonet/configuring-parameters-and-parameter-data-types.md)"},{"pos":[6775,6900],"content":"<bpt id=\"p1\">[</bpt>Retrieving Database Schema Information<ept id=\"p1\">](../../../../../docs/framework/data/adonet/retrieving-database-schema-information.md)</ept>","source":"[Retrieving Database Schema Information](../../../../../docs/framework/data/adonet/retrieving-database-schema-information.md)"},{"pos":[6903,7010],"content":"<bpt id=\"p1\">[</bpt>SQL Server Data Type Mappings<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql-server-data-type-mappings.md)</ept>","source":"[SQL Server Data Type Mappings](../../../../../docs/framework/data/adonet/sql-server-data-type-mappings.md)"},{"pos":[7013,7142],"content":"<bpt id=\"p1\">[</bpt>SQL Server Binary and Large-Value Data<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/sql-server-binary-and-large-value-data.md)</ept>","source":"[SQL Server Binary and Large-Value Data](../../../../../docs/framework/data/adonet/sql/sql-server-binary-and-large-value-data.md)"},{"pos":[7145,7249],"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=217917)</ept>","source":"[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)"}]}