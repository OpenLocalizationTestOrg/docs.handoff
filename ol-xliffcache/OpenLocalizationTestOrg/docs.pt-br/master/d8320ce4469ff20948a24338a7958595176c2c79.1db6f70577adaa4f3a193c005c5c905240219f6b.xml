{"content":"---\ntitle: \"Implementing the UI Automation Grid Control Pattern | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"control patterns, grid\"\n  - \"grid control pattern\"\n  - \"UI Automation, grid control pattern\"\nms.assetid: 234d11a0-7ce7-4309-8989-2f4720e02f78\ncaps.latest.revision: 27\nauthor: \"Xansky\"\nms.author: \"mhopkins\"\nmanager: \"markl\"\n---\n# Implementing the UI Automation Grid Control Pattern\n> [!NOTE]\n>  This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).  \n  \n This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IGridProvider>, including information about properties, methods, and events. Links to additional references are listed at the end of the overview.  \n  \n The <xref:System.Windows.Automation.GridPattern> control pattern is used to support controls that act as containers for a collection of child elements. The children of this element must implement <xref:System.Windows.Automation.Provider.IGridItemProvider> and be organized in a two-dimensional logical coordinate system that can be traversed by row and column. For examples of controls that implement this control pattern, see [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md).  \n  \n<a name=\"Implementation_Guidelines_and_Conventions\"></a>   \n## Implementation Guidelines and Conventions  \n When implementing the Grid control pattern, note the following guidelines and conventions:  \n  \n-   Grid coordinates are zero-based with the upper left (or upper right cell depending on locale) having coordinates (0, 0).  \n  \n-   If a cell is empty, a UI Automation element must still be returned in order to support the <xref:System.Windows.Automation.Provider.IGridItemProvider.ContainingGrid%2A> property for that cell. This is possible when the layout of child elements in the grid is similar to a ragged array (see example below).  \n  \n ![Windows Explorer view showing ragged layout.](../../../docs/framework/ui-automation/media/uia-gridpattern-ragged-array.PNG \"UIA_GridPattern_Ragged_Array\")  \nExample of a Grid Control with Empty Coordinates  \n  \n-   A grid with a single item is still required to implement <xref:System.Windows.Automation.Provider.IGridProvider> if it is logically considered to be a grid. The number of child items in the grid is immaterial.  \n  \n-   Hidden rows and columns, depending on the provider implementation, may be loaded in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree and therefore will be reflected in the <xref:System.Windows.Automation.GridPattern.GridPatternInformation.RowCount%2A> and <xref:System.Windows.Automation.GridPattern.GridPatternInformation.ColumnCount%2A> properties. If the hidden rows and columns have not yet been loaded, they should not be counted.  \n  \n-   <xref:System.Windows.Automation.Provider.IGridProvider> does not enable active manipulation of a grid; <xref:System.Windows.Automation.Provider.ITransformProvider> must be implemented to enable this functionality.  \n  \n-   Use a <xref:System.Windows.Automation.StructureChangedEventHandler> to listen for structural or layout changes to the grid such as cells that have been added, removed, or merged.  \n  \n-   Use a <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> to track traversal through the items or cells of a grid.  \n  \n<a name=\"Required_Members_for_IGridProvider\"></a>   \n## Required Members for IGridProvider  \n The following properties and methods are required for implementing the IGridProvider interface.  \n  \n|Required members|Type|Notes|  \n|----------------------|----------|-----------|  \n|<xref:System.Windows.Automation.Provider.IGridProvider.RowCount%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IGridProvider.ColumnCount%2A>|Property|None|  \n|<xref:System.Windows.Automation.Provider.IGridProvider.GetItem%2A>|Method|None|  \n  \n This control pattern has no associated events.  \n  \n<a name=\"Exceptions\"></a>   \n## Exceptions  \n Providers must throw the following exceptions.  \n  \n|Exception type|Condition|  \n|--------------------|---------------|  \n|<xref:System.ArgumentOutOfRangeException>|<xref:System.Windows.Automation.Provider.IGridProvider.GetItem%2A><br /><br /> -   If the requested row coordinate is larger than the <xref:System.Windows.Automation.Provider.IGridProvider.RowCount%2A> or the column coordinate is larger than the <xref:System.Windows.Automation.Provider.IGridProvider.ColumnCount%2A>.|  \n|<xref:System.ArgumentOutOfRangeException>|<xref:System.Windows.Automation.Provider.IGridProvider.GetItem%2A><br /><br /> -   If either of the requested row or column coordinates is less than zero.|  \n  \n## See Also  \n [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)   \n [Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)   \n [UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)   \n [Implementing the UI Automation GridItem Control Pattern](../../../docs/framework/ui-automation/implementing-the-ui-automation-griditem-control-pattern.md)   \n [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)   \n [Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)","nodes":[{"pos":[12,80],"content":"Implementing the UI Automation Grid Control Pattern | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Implementing the UI Automation Grid Control Pattern | Microsoft Docs","pos":[0,68]}]},{"pos":[500,551],"content":"Implementing the UI Automation Grid Control Pattern","linkify":"Implementing the UI Automation Grid Control Pattern","nodes":[{"content":"Implementing the UI Automation Grid Control Pattern","pos":[0,51]}]},{"pos":[554,1016],"content":"[!NOTE]\n This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","leadings":["","> "],"nodes":[{"content":" This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace. For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).","pos":[8,460],"nodes":[{"content":"This documentation is intended for .NET Framework developers who want to use the managed <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> classes defined in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation&gt;</ph> namespace.","pos":[1,241],"source":" This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace."},{"content":"For the latest information about <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph>, see <bpt id=\"p1\">[</bpt>Windows Automation API: UI Automation<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=156746)</ept>.","pos":[242,452],"source":" For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746)."}]}]},{"content":"This topic introduces guidelines and conventions for implementing <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IGridProvider&gt;</ph>, including information about properties, methods, and events.","pos":[1023,1206],"source":"This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IGridProvider>, including information about properties, methods, and events."},{"content":"Links to additional references are listed at the end of the overview.","pos":[1207,1276]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Automation.GridPattern&gt;</ph> control pattern is used to support controls that act as containers for a collection of child elements.","pos":[1283,1434],"source":"The <xref:System.Windows.Automation.GridPattern> control pattern is used to support controls that act as containers for a collection of child elements."},{"content":"The children of this element must implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IGridItemProvider&gt;</ph> and be organized in a two-dimensional logical coordinate system that can be traversed by row and column.","pos":[1435,1643],"source":" The children of this element must implement <xref:System.Windows.Automation.Provider.IGridItemProvider> and be organized in a two-dimensional logical coordinate system that can be traversed by row and column."},{"content":"For examples of controls that implement this control pattern, see <bpt id=\"p1\">[</bpt>Control Pattern Mapping for UI Automation Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)</ept>.","pos":[1644,1854],"source":" For examples of controls that implement this control pattern, see [Control Pattern Mapping for UI Automation Clients](../../../docs/framework/ui-automation/control-pattern-mapping-for-ui-automation-clients.md)."},{"pos":[1923,1964],"content":"Implementation Guidelines and Conventions","linkify":"Implementation Guidelines and Conventions","nodes":[{"content":"Implementation Guidelines and Conventions","pos":[0,41]}]},{"content":"When implementing the Grid control pattern, note the following guidelines and conventions:","pos":[1968,2058]},{"content":"Grid coordinates are zero-based with the upper left (or upper right cell depending on locale) having coordinates (0, 0).","pos":[2068,2188]},{"content":"If a cell is empty, a UI Automation element must still be returned in order to support the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IGridItemProvider.ContainingGrid%2A&gt;</ph> property for that cell.","pos":[2198,2390],"source":"If a cell is empty, a UI Automation element must still be returned in order to support the <xref:System.Windows.Automation.Provider.IGridItemProvider.ContainingGrid%2A> property for that cell."},{"content":"This is possible when the layout of child elements in the grid is similar to a ragged array (see example below).","pos":[2391,2503]},{"content":"<bpt id=\"p1\">![</bpt>Windows Explorer view showing ragged layout.<ept id=\"p1\">](../../../docs/framework/ui-automation/media/uia-gridpattern-ragged-array.PNG \"UIA_GridPattern_Ragged_Array\")</ept>","pos":[2510,2666],"source":"![Windows Explorer view showing ragged layout.](../../../docs/framework/ui-automation/media/uia-gridpattern-ragged-array.PNG \"UIA_GridPattern_Ragged_Array\")"},{"content":"Example of a Grid Control with Empty Coordinates","pos":[2669,2717]},{"content":"A grid with a single item is still required to implement <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IGridProvider&gt;</ph> if it is logically considered to be a grid.","pos":[2727,2883],"source":"A grid with a single item is still required to implement <xref:System.Windows.Automation.Provider.IGridProvider> if it is logically considered to be a grid."},{"content":"The number of child items in the grid is immaterial.","pos":[2884,2936]},{"content":"Hidden rows and columns, depending on the provider implementation, may be loaded in the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</ph> tree and therefore will be reflected in the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.GridPattern.GridPatternInformation.RowCount%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Windows.Automation.GridPattern.GridPatternInformation.ColumnCount%2A&gt;</ph> properties.","pos":[2946,3341],"source":"Hidden rows and columns, depending on the provider implementation, may be loaded in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree and therefore will be reflected in the <xref:System.Windows.Automation.GridPattern.GridPatternInformation.RowCount%2A> and <xref:System.Windows.Automation.GridPattern.GridPatternInformation.ColumnCount%2A> properties."},{"content":"If the hidden rows and columns have not yet been loaded, they should not be counted.","pos":[3342,3426]},{"content":"<ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IGridProvider&gt;</ph> does not enable active manipulation of a grid; <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.ITransformProvider&gt;</ph> must be implemented to enable this functionality.","pos":[3436,3649],"source":"<xref:System.Windows.Automation.Provider.IGridProvider> does not enable active manipulation of a grid; <xref:System.Windows.Automation.Provider.ITransformProvider> must be implemented to enable this functionality."},{"content":"Use a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.StructureChangedEventHandler&gt;</ph> to listen for structural or layout changes to the grid such as cells that have been added, removed, or merged.","pos":[3659,3837],"source":"Use a <xref:System.Windows.Automation.StructureChangedEventHandler> to listen for structural or layout changes to the grid such as cells that have been added, removed, or merged."},{"content":"Use a <ph id=\"ph1\">&lt;xref:System.Windows.Automation.AutomationFocusChangedEventHandler&gt;</ph> to track traversal through the items or cells of a grid.","pos":[3847,3977],"source":"Use a <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> to track traversal through the items or cells of a grid."},{"pos":[4039,4073],"content":"Required Members for IGridProvider","linkify":"Required Members for IGridProvider","nodes":[{"content":"Required Members for IGridProvider","pos":[0,34]}]},{"content":"The following properties and methods are required for implementing the IGridProvider interface.","pos":[4077,4172]},{"content":"Required members","pos":[4179,4195]},{"content":"Type","pos":[4196,4200]},{"content":"Notes","pos":[4201,4206]},{"content":"Property","pos":[4329,4337]},{"content":"None","pos":[4338,4342]},{"content":"Property","pos":[4418,4426]},{"content":"None","pos":[4427,4431]},{"content":"Method","pos":[4503,4509]},{"content":"None","pos":[4510,4514]},{"content":"This control pattern has no associated events.","pos":[4522,4568]},{"pos":[4606,4616],"content":"Exceptions","linkify":"Exceptions","nodes":[{"content":"Exceptions","pos":[0,10]}]},{"content":"Providers must throw the following exceptions.","pos":[4620,4666]},{"content":"Exception type","pos":[4673,4687]},{"content":"Condition","pos":[4688,4697]},{"content":"-   If the requested row coordinate is larger than the <ph id=\"ph1\">&lt;xref:System.Windows.Automation.Provider.IGridProvider.RowCount%2A&gt;</ph> or the column coordinate is larger than the <ph id=\"ph2\">&lt;xref:System.Windows.Automation.Provider.IGridProvider.ColumnCount%2A&gt;</ph>.","pos":[4864,5102],"source":"-   If the requested row coordinate is larger than the <xref:System.Windows.Automation.Provider.IGridProvider.RowCount%2A> or the column coordinate is larger than the <xref:System.Windows.Automation.Provider.IGridProvider.ColumnCount%2A>."},{"content":"-   If either of the requested row or column coordinates is less than zero.","pos":[5228,5303]},{"pos":[5313,5321],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>UI Automation Control Patterns Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[5325,5449],"source":"[UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Support Control Patterns in a UI Automation Provider<ept id=\"p1\">](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)</ept><ph id=\"ph1\"> </ph>","pos":[5452,5603],"source":" [Support Control Patterns in a UI Automation Provider](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md) "},{"content":"<bpt id=\"p1\"> [</bpt>UI Automation Control Patterns for Clients<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md)</ept><ph id=\"ph1\"> </ph>","pos":[5606,5737],"source":" [UI Automation Control Patterns for Clients](../../../docs/framework/ui-automation/ui-automation-control-patterns-for-clients.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Implementing the UI Automation GridItem Control Pattern<ept id=\"p1\">](../../../docs/framework/ui-automation/implementing-the-ui-automation-griditem-control-pattern.md)</ept><ph id=\"ph1\"> </ph>","pos":[5740,5897],"source":" [Implementing the UI Automation GridItem Control Pattern](../../../docs/framework/ui-automation/implementing-the-ui-automation-griditem-control-pattern.md) "},{"content":"<bpt id=\"p1\"> [</bpt>UI Automation Tree Overview<ept id=\"p1\">](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[5900,6001],"source":" [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Use Caching in UI Automation<ept id=\"p1\">](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)</ept>","pos":[6004,6106],"source":" [Use Caching in UI Automation](../../../docs/framework/ui-automation/use-caching-in-ui-automation.md)"}]}