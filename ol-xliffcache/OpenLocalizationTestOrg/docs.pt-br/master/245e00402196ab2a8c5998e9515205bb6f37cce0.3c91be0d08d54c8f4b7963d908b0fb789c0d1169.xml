{"content":"---\ntitle: \"How to: Write Text to Files in the My Documents Directory in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"files [Visual Basic], writing to\"\n  - \"text, writing to files\"\n  - \"examples [Visual Basic], text files\"\n  - \"writing to files [Visual Basic], in My Documents\"\nms.assetid: 1c726124-781d-4976-9baa-ed46814ff3fe\n---\n# How to: Write Text to Files in the My Documents Directory in Visual Basic\nThe `My.Computer.FileSystem.SpecialDirectories` object allows you to access special directories, such as the **MyDocuments** directory.  \n  \n## Procedure  \n  \n#### To write new text files in the My Documents directory  \n  \n1.  Use the `My.Computer.FileSystem.SpecialDirectories.MyDocuments` property to supply the path.  \n  \n     [!code-vb[VbFileIOWrite#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbFileIOWrite/VB/Class1.vb#1)]  \n  \n2.  Use the `WriteAllText` method to write text to the specified file.  \n  \n     [!code-vb[VbVbcnMyFileSystem#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#14)]  \n  \n## Example  \n [!code-vb[VbFileIOWrite#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbFileIOWrite/VB/Class1.vb#2)]  \n  \n## Compiling the Code  \n Replace `test.txt` with the name of the file you want to write to.  \n  \n## Robust Programming  \n This code rethrows all the exceptions that may occur when writing text to the file. You can reduce the likelihood of exceptions by using Windows Forms controls such as the [OpenFileDialog](../../../../framework/winforms/controls/openfiledialog-component-windows-forms.md) and the [SaveFileDialog](../../../../framework/winforms/controls/savefiledialog-component-windows-forms.md) components that limit the user choices to valid file names. Using these controls is not foolproof, however. The file system can change between the time the user selects a file and the time that the code executes. Exception handling is therefore nearly always necessary when with working with files.  \n  \n## .NET Framework Security  \n If you are running in a partial-trust context, the code might throw an exception due to insufficient privileges. For more information, see [Code Access Security Basics](../../../../framework/misc/code-access-security-basics.md).  \n  \n This example creates a new file. If an application needs to create a file, that application needs Create permission for the folder. Permissions are set using access control lists. If the file already exists, the application needs only Write permission, a lesser privilege. Where possible, it is more secure to create the file during deployment, and only grant Read privileges to a single file, rather than to grant Create privileges for a folder. Also, it is more secure to write data to user folders than to the root folder or the **Program Files** folder. For more information, see [ACL Technology Overview](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms229742(v=vs.100)).  \n  \n## See also\n\n- <xref:System.IO.Path.Combine%2A?displayProperty=nameWithType>\n- <xref:Microsoft.VisualBasic.Devices.Computer>\n- <xref:Microsoft.VisualBasic.FileIO.FileSystem>\n- <xref:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText%2A>\n- <xref:Microsoft.VisualBasic.FileIO.SpecialDirectories>\n","nodes":[{"pos":[4,342],"embed":true,"restype":"x-metadata","content":"title: \"How to: Write Text to Files in the My Documents Directory in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"files [Visual Basic], writing to\"\n  - \"text, writing to files\"\n  - \"examples [Visual Basic], text files\"\n  - \"writing to files [Visual Basic], in My Documents\"\nms.assetid: 1c726124-781d-4976-9baa-ed46814ff3fe","nodes":[{"content":"How to: Write Text to Files in the My Documents Directory in Visual Basic","nodes":[{"pos":[0,73],"content":"How to: Write Text to Files in the My Documents Directory in Visual Basic","nodes":[{"content":"How to: Write Text to Files in the My Documents Directory in Visual Basic","pos":[0,73]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[349,422],"content":"How to: Write Text to Files in the My Documents Directory in Visual Basic","linkify":"How to: Write Text to Files in the My Documents Directory in Visual Basic","nodes":[{"content":"How to: Write Text to Files in the My Documents Directory in Visual Basic","pos":[0,73]}]},{"pos":[423,558],"content":"The <ph id=\"ph1\">`My.Computer.FileSystem.SpecialDirectories`</ph> object allows you to access special directories, such as the <bpt id=\"p1\">**</bpt>MyDocuments<ept id=\"p1\">**</ept> directory.","source":"The `My.Computer.FileSystem.SpecialDirectories` object allows you to access special directories, such as the **MyDocuments** directory."},{"pos":[567,576],"content":"Procedure","linkify":"Procedure","nodes":[{"content":"Procedure","pos":[0,9]}]},{"pos":[587,640],"content":"To write new text files in the My Documents directory","linkify":"To write new text files in the My Documents directory","nodes":[{"content":"To write new text files in the My Documents directory","pos":[0,53]}]},{"pos":[650,742],"content":"Use the <ph id=\"ph1\">`My.Computer.FileSystem.SpecialDirectories.MyDocuments`</ph> property to supply the path.","source":"Use the `My.Computer.FileSystem.SpecialDirectories.MyDocuments` property to supply the path."},{"pos":[872,938],"content":"Use the <ph id=\"ph1\">`WriteAllText`</ph> method to write text to the specified file.","source":"Use the `WriteAllText` method to write text to the specified file."},{"pos":[1079,1086],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1208,1226],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[1230,1296],"content":"Replace <ph id=\"ph1\">`test.txt`</ph> with the name of the file you want to write to.","source":"Replace `test.txt` with the name of the file you want to write to."},{"pos":[1305,1323],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"This code rethrows all the exceptions that may occur when writing text to the file.","pos":[1327,1410]},{"content":"You can reduce the likelihood of exceptions by using Windows Forms controls such as the <bpt id=\"p1\">[</bpt>OpenFileDialog<ept id=\"p1\">](../../../../framework/winforms/controls/openfiledialog-component-windows-forms.md)</ept> and the <bpt id=\"p2\">[</bpt>SaveFileDialog<ept id=\"p2\">](../../../../framework/winforms/controls/savefiledialog-component-windows-forms.md)</ept> components that limit the user choices to valid file names.","pos":[1411,1766],"source":" You can reduce the likelihood of exceptions by using Windows Forms controls such as the [OpenFileDialog](../../../../framework/winforms/controls/openfiledialog-component-windows-forms.md) and the [SaveFileDialog](../../../../framework/winforms/controls/savefiledialog-component-windows-forms.md) components that limit the user choices to valid file names."},{"content":"Using these controls is not foolproof, however.","pos":[1767,1814]},{"content":"The file system can change between the time the user selects a file and the time that the code executes.","pos":[1815,1919]},{"content":"Exception handling is therefore nearly always necessary when with working with files.","pos":[1920,2005]},{"pos":[2014,2037],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"If you are running in a partial-trust context, the code might throw an exception due to insufficient privileges.","pos":[2041,2153]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Access Security Basics<ept id=\"p1\">](../../../../framework/misc/code-access-security-basics.md)</ept>.","pos":[2154,2269],"source":" For more information, see [Code Access Security Basics](../../../../framework/misc/code-access-security-basics.md)."},{"content":"This example creates a new file.","pos":[2276,2308]},{"content":"If an application needs to create a file, that application needs Create permission for the folder.","pos":[2309,2407]},{"content":"Permissions are set using access control lists.","pos":[2408,2455]},{"content":"If the file already exists, the application needs only Write permission, a lesser privilege.","pos":[2456,2548]},{"content":"Where possible, it is more secure to create the file during deployment, and only grant Read privileges to a single file, rather than to grant Create privileges for a folder.","pos":[2549,2722]},{"content":"Also, it is more secure to write data to user folders than to the root folder or the <bpt id=\"p1\">**</bpt>Program Files<ept id=\"p1\">**</ept> folder.","pos":[2723,2833],"source":" Also, it is more secure to write data to user folders than to the root folder or the **Program Files** folder."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>ACL Technology Overview<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms229742(v=vs.100))</ept>.","pos":[2834,2975],"source":" For more information, see [ACL Technology Overview](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms229742(v=vs.100))."},{"pos":[2984,2992],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]}]}