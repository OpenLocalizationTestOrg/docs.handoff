{"content":"---\ntitle: \"Mitigation: PNG Frames in Icon Objects\"\nms.date: \"03/30/2017\"\nms.assetid: ca87fefb-7144-4b4e-8832-5a939adbb4b2\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# Mitigation: PNG Frames in Icon Objects\nStarting with the .NET Framework 4.6, the <xref:System.Drawing.Icon.ToBitmap%2A?displayProperty=nameWithType> method successfully converts icons with PNG frames into <xref:System.Drawing.Bitmap> objects.  \n  \n In apps that target the .NET Framework 4.5.2 and earlier versions, the <xref:System.Drawing.Icon.ToBitmap%2A?displayProperty=nameWithType> method throws an <xref:System.ArgumentOutOfRangeException> exception if the <xref:System.Drawing.Icon> object has PNG frames.  \n  \n## Impact  \n This change affects apps that are recompiled to target the .NET Framework 4.6 and that implement special handling for the <xref:System.ArgumentOutOfRangeException> that is thrown when an <xref:System.Drawing.Icon> object has PNG frames. When running under the .NET Framework 4.6, the conversion is successful, an <xref:System.ArgumentOutOfRangeException> is no longer thrown, and therefore the exception handler is no longer invoked.  \n  \n### Mitigation  \n If this behavior is undesirable, you can retain the previous behavior by adding the following element to the [\\<runtime>](../../../docs/framework/configure-apps/file-schema/runtime/runtime-element.md) section of your app.config file:  \n  \n```xml  \n<AppContextSwitchOverrides   \n      value=\"Switch.System.Drawing.DontSupportPngFramesInIcons=true\" />  \n```  \n  \n If the app.config file already contains the `AppContextSwitchOverrides` element, the new value should be merged with the `value` attribute like this:  \n  \n```xml  \n<AppContextSwitchOverrides   \n      value=\"Switch.System.Drawing.DontSupportPngFramesInIcons=true;<previous key>=<previous value>\" />  \n```  \n  \n## See also\n\n- [Retargeting Changes](../../../docs/framework/migration-guide/retargeting-changes-in-the-net-framework-4-6.md)\n","nodes":[{"pos":[4,162],"embed":true,"restype":"x-metadata","content":"title: \"Mitigation: PNG Frames in Icon Objects\"\nms.date: \"03/30/2017\"\nms.assetid: ca87fefb-7144-4b4e-8832-5a939adbb4b2\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"Mitigation: PNG Frames in Icon Objects","nodes":[{"pos":[0,38],"content":"Mitigation: PNG Frames in Icon Objects","nodes":[{"content":"Mitigation: PNG Frames in Icon Objects","pos":[0,38]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[169,207],"content":"Mitigation: PNG Frames in Icon Objects","linkify":"Mitigation: PNG Frames in Icon Objects","nodes":[{"content":"Mitigation: PNG Frames in Icon Objects","pos":[0,38]}]},{"pos":[208,411],"content":"Starting with the .NET Framework 4.6, the <ph id=\"ph1\">&lt;xref:System.Drawing.Icon.ToBitmap%2A?displayProperty=nameWithType&gt;</ph> method successfully converts icons with PNG frames into <ph id=\"ph2\">&lt;xref:System.Drawing.Bitmap&gt;</ph> objects.","source":"Starting with the .NET Framework 4.6, the <xref:System.Drawing.Icon.ToBitmap%2A?displayProperty=nameWithType> method successfully converts icons with PNG frames into <xref:System.Drawing.Bitmap> objects."},{"pos":[418,682],"content":"In apps that target the .NET Framework 4.5.2 and earlier versions, the <ph id=\"ph1\">&lt;xref:System.Drawing.Icon.ToBitmap%2A?displayProperty=nameWithType&gt;</ph> method throws an <ph id=\"ph2\">&lt;xref:System.ArgumentOutOfRangeException&gt;</ph> exception if the <ph id=\"ph3\">&lt;xref:System.Drawing.Icon&gt;</ph> object has PNG frames.","source":"In apps that target the .NET Framework 4.5.2 and earlier versions, the <xref:System.Drawing.Icon.ToBitmap%2A?displayProperty=nameWithType> method throws an <xref:System.ArgumentOutOfRangeException> exception if the <xref:System.Drawing.Icon> object has PNG frames."},{"pos":[691,697],"content":"Impact","linkify":"Impact","nodes":[{"content":"Impact","pos":[0,6]}]},{"content":"This change affects apps that are recompiled to target the .NET Framework 4.6 and that implement special handling for the <ph id=\"ph1\">&lt;xref:System.ArgumentOutOfRangeException&gt;</ph> that is thrown when an <ph id=\"ph2\">&lt;xref:System.Drawing.Icon&gt;</ph> object has PNG frames.","pos":[701,937],"source":"This change affects apps that are recompiled to target the .NET Framework 4.6 and that implement special handling for the <xref:System.ArgumentOutOfRangeException> that is thrown when an <xref:System.Drawing.Icon> object has PNG frames."},{"content":"When running under the .NET Framework 4.6, the conversion is successful, an <ph id=\"ph1\">&lt;xref:System.ArgumentOutOfRangeException&gt;</ph> is no longer thrown, and therefore the exception handler is no longer invoked.","pos":[938,1134],"source":" When running under the .NET Framework 4.6, the conversion is successful, an <xref:System.ArgumentOutOfRangeException> is no longer thrown, and therefore the exception handler is no longer invoked."},{"pos":[1144,1154],"content":"Mitigation","linkify":"Mitigation","nodes":[{"content":"Mitigation","pos":[0,10]}]},{"pos":[1158,1391],"content":"If this behavior is undesirable, you can retain the previous behavior by adding the following element to the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>runtime&gt;<ept id=\"p1\">](../../../docs/framework/configure-apps/file-schema/runtime/runtime-element.md)</ept> section of your app.config file:","source":"If this behavior is undesirable, you can retain the previous behavior by adding the following element to the [\\<runtime>](../../../docs/framework/configure-apps/file-schema/runtime/runtime-element.md) section of your app.config file:"},{"pos":[1520,1669],"content":"If the app.config file already contains the <ph id=\"ph1\">`AppContextSwitchOverrides`</ph> element, the new value should be merged with the <ph id=\"ph2\">`value`</ph> attribute like this:","source":"If the app.config file already contains the `AppContextSwitchOverrides` element, the new value should be merged with the `value` attribute like this:"},{"pos":[1832,1840],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1844,1954],"content":"<bpt id=\"p1\">[</bpt>Retargeting Changes<ept id=\"p1\">](../../../docs/framework/migration-guide/retargeting-changes-in-the-net-framework-4-6.md)</ept>","source":"[Retargeting Changes](../../../docs/framework/migration-guide/retargeting-changes-in-the-net-framework-4-6.md)"}]}