{"content":"---\ntitle: \"How to: Use a Color Matrix to Transform a Single Color\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"image colors [Windows Forms], transforming\"\n  - \"color matrices [Windows Forms], using\"\nms.assetid: 44df4556-a433-49c0-ac0f-9a12063a5860\n---\n# How to: Use a Color Matrix to Transform a Single Color\n[!INCLUDE[ndptecgdiplus](../../../../includes/ndptecgdiplus-md.md)] provides the <xref:System.Drawing.Image> and <xref:System.Drawing.Bitmap> classes for storing and manipulating images. <xref:System.Drawing.Image> and <xref:System.Drawing.Bitmap> objects store the color of each pixel as a 32-bit number: 8 bits each for red, green, blue, and alpha. Each of the four components is a number from 0 through 255, with 0 representing no intensity and 255 representing full intensity. The alpha component specifies the transparency of the color: 0 is fully transparent, and 255 is fully opaque.  \n  \n A color vector is a 4-tuple of the form (red, green, blue, alpha). For example, the color vector (0, 255, 0, 255) represents an opaque color that has no red or blue, but has green at full intensity.  \n  \n Another convention for representing colors uses the number 1 for full intensity. Using that convention, the color described in the preceding paragraph would be represented by the vector (0, 1, 0, 1). [!INCLUDE[ndptecgdiplus](../../../../includes/ndptecgdiplus-md.md)] uses the convention of 1 as full intensity when it performs color transformations.  \n  \n You can apply linear transformations (rotation, scaling, and the like) to color vectors by multiplying the color vectors by a 4×4 matrix. However, you cannot use a 4×4 matrix to perform a translation (nonlinear). If you add a dummy fifth coordinate (for example, the number 1) to each of the color vectors, you can use a 5×5 matrix to apply any combination of linear transformations and translations. A transformation consisting of a linear transformation followed by a translation is called an affine transformation.  \n  \n For example, suppose you want to start with the color (0.2, 0.0, 0.4, 1.0) and apply the following transformations:  \n  \n1.  Double the red component  \n  \n2.  Add 0.2 to the red, green, and blue components  \n  \n The following matrix multiplication will perform the pair of transformations in the order listed.  \n  \n ![Recoloring](./media/recoloring01.gif \"recoloring01\")  \n  \n The elements of a color matrix are indexed (zero-based) by row and then column. For example, the entry in the fifth row and third column of matrix M is denoted by M[4][2].  \n  \n The 5×5 identity matrix (shown in the following illustration) has 1s on the diagonal and 0s everywhere else. If you multiply a color vector by the identity matrix, the color vector does not change. A convenient way to form the matrix of a color transformation is to start with the identity matrix and make a small change that produces the desired transformation.  \n  \n ![Recoloring](./media/recoloring02.gif \"recoloring02\")  \n  \n For a more detailed discussion of matrices and transformations, see [Coordinate Systems and Transformations](coordinate-systems-and-transformations.md).  \n  \n## Example  \n The following example takes an image that is all one color (0.2, 0.0, 0.4, 1.0) and applies the transformation described in the preceding paragraphs.  \n  \n The following illustration shows the original image on the left and the transformed image on the right.  \n  \n ![Colors](./media/colortrans1.png \"colortrans1\")  \n  \n The code in the following example uses the following steps to perform the recoloring:  \n  \n1.  Initialize a <xref:System.Drawing.Imaging.ColorMatrix> object.  \n  \n2.  Create an <xref:System.Drawing.Imaging.ImageAttributes> object and pass the <xref:System.Drawing.Imaging.ColorMatrix> object to the <xref:System.Drawing.Imaging.ImageAttributes.SetColorMatrix%2A> method of the <xref:System.Drawing.Imaging.ImageAttributes> object.  \n  \n3.  Pass the <xref:System.Drawing.Imaging.ImageAttributes> object to the <xref:System.Drawing.Graphics.DrawImage%2A> method of a <xref:System.Drawing.Graphics> object.  \n  \n [!code-csharp[System.Drawing.RecoloringImages#21](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.RecoloringImages/CS/Class1.cs#21)]\n [!code-vb[System.Drawing.RecoloringImages#21](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.RecoloringImages/VB/Class1.vb#21)]  \n  \n## Compiling the Code  \n The preceding example is designed for use with Windows Forms, and it requires <xref:System.Windows.Forms.PaintEventArgs> `e`, which is a parameter of the <xref:System.Windows.Forms.Control.Paint> event handler.  \n  \n## See also\n\n- [Recoloring Images](recoloring-images.md)\n- [Coordinate Systems and Transformations](coordinate-systems-and-transformations.md)\n","nodes":[{"pos":[4,287],"embed":true,"restype":"x-metadata","content":"title: \"How to: Use a Color Matrix to Transform a Single Color\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"image colors [Windows Forms], transforming\"\n  - \"color matrices [Windows Forms], using\"\nms.assetid: 44df4556-a433-49c0-ac0f-9a12063a5860","nodes":[{"content":"How to: Use a Color Matrix to Transform a Single Color","nodes":[{"pos":[0,54],"content":"How to: Use a Color Matrix to Transform a Single Color","nodes":[{"content":"How to: Use a Color Matrix to Transform a Single Color","pos":[0,54]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[294,348],"content":"How to: Use a Color Matrix to Transform a Single Color","linkify":"How to: Use a Color Matrix to Transform a Single Color","nodes":[{"content":"How to: Use a Color Matrix to Transform a Single Color","pos":[0,54]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[ndptecgdiplus](../../../../includes/ndptecgdiplus-md.md)]</ph> provides the <ph id=\"ph2\">&lt;xref:System.Drawing.Image&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Drawing.Bitmap&gt;</ph> classes for storing and manipulating images.","pos":[349,535],"source":"[!INCLUDE[ndptecgdiplus](../../../../includes/ndptecgdiplus-md.md)] provides the <xref:System.Drawing.Image> and <xref:System.Drawing.Bitmap> classes for storing and manipulating images."},{"content":"<ph id=\"ph1\">&lt;xref:System.Drawing.Image&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Drawing.Bitmap&gt;</ph> objects store the color of each pixel as a 32-bit number: 8 bits each for red, green, blue, and alpha.","pos":[536,699],"source":"<xref:System.Drawing.Image> and <xref:System.Drawing.Bitmap> objects store the color of each pixel as a 32-bit number: 8 bits each for red, green, blue, and alpha."},{"content":"Each of the four components is a number from 0 through 255, with 0 representing no intensity and 255 representing full intensity.","pos":[700,829]},{"content":"The alpha component specifies the transparency of the color: 0 is fully transparent, and 255 is fully opaque.","pos":[830,939]},{"content":"A color vector is a 4-tuple of the form (red, green, blue, alpha).","pos":[946,1012]},{"content":"For example, the color vector (0, 255, 0, 255) represents an opaque color that has no red or blue, but has green at full intensity.","pos":[1013,1144]},{"content":"Another convention for representing colors uses the number 1 for full intensity.","pos":[1151,1231]},{"content":"Using that convention, the color described in the preceding paragraph would be represented by the vector (0, 1, 0, 1).","pos":[1232,1350]},{"content":"<ph id=\"ph1\">[!INCLUDE[ndptecgdiplus](../../../../includes/ndptecgdiplus-md.md)]</ph> uses the convention of 1 as full intensity when it performs color transformations.","pos":[1351,1501],"source":"[!INCLUDE[ndptecgdiplus](../../../../includes/ndptecgdiplus-md.md)] uses the convention of 1 as full intensity when it performs color transformations."},{"content":"You can apply linear transformations (rotation, scaling, and the like) to color vectors by multiplying the color vectors by a 4×4 matrix.","pos":[1508,1645]},{"content":"However, you cannot use a 4×4 matrix to perform a translation (nonlinear).","pos":[1646,1720]},{"content":"If you add a dummy fifth coordinate (for example, the number 1) to each of the color vectors, you can use a 5×5 matrix to apply any combination of linear transformations and translations.","pos":[1721,1908]},{"content":"A transformation consisting of a linear transformation followed by a translation is called an affine transformation.","pos":[1909,2025]},{"content":"For example, suppose you want to start with the color (0.2, 0.0, 0.4, 1.0) and apply the following transformations:","pos":[2032,2147]},{"content":"Double the red component","pos":[2157,2181]},{"content":"Add 0.2 to the red, green, and blue components","pos":[2191,2237]},{"content":"The following matrix multiplication will perform the pair of transformations in the order listed.","pos":[2244,2341]},{"pos":[2348,2402],"content":"<bpt id=\"p1\">![</bpt>Recoloring<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/recoloring01.gif \"</bpt>recoloring01<ept id=\"p2\">\")</ept>","source":"![Recoloring](./media/recoloring01.gif \"recoloring01\")"},{"content":"The elements of a color matrix are indexed (zero-based) by row and then column.","pos":[2409,2488]},{"content":"For example, the entry in the fifth row and third column of matrix M is denoted by M[4][2].","pos":[2489,2580]},{"content":"The 5×5 identity matrix (shown in the following illustration) has 1s on the diagonal and 0s everywhere else.","pos":[2587,2695]},{"content":"If you multiply a color vector by the identity matrix, the color vector does not change.","pos":[2696,2784]},{"content":"A convenient way to form the matrix of a color transformation is to start with the identity matrix and make a small change that produces the desired transformation.","pos":[2785,2949]},{"pos":[2956,3010],"content":"<bpt id=\"p1\">![</bpt>Recoloring<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/recoloring02.gif \"</bpt>recoloring02<ept id=\"p2\">\")</ept>","source":"![Recoloring](./media/recoloring02.gif \"recoloring02\")"},{"pos":[3017,3169],"content":"For a more detailed discussion of matrices and transformations, see <bpt id=\"p1\">[</bpt>Coordinate Systems and Transformations<ept id=\"p1\">](coordinate-systems-and-transformations.md)</ept>.","source":"For a more detailed discussion of matrices and transformations, see [Coordinate Systems and Transformations](coordinate-systems-and-transformations.md)."},{"pos":[3178,3185],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example takes an image that is all one color (0.2, 0.0, 0.4, 1.0) and applies the transformation described in the preceding paragraphs.","pos":[3189,3338]},{"content":"The following illustration shows the original image on the left and the transformed image on the right.","pos":[3345,3448]},{"pos":[3455,3503],"content":"<bpt id=\"p1\">![</bpt>Colors<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/colortrans1.png \"</bpt>colortrans1<ept id=\"p2\">\")</ept>","source":"![Colors](./media/colortrans1.png \"colortrans1\")"},{"content":"The code in the following example uses the following steps to perform the recoloring:","pos":[3510,3595]},{"pos":[3605,3667],"content":"Initialize a <ph id=\"ph1\">&lt;xref:System.Drawing.Imaging.ColorMatrix&gt;</ph> object.","source":"Initialize a <xref:System.Drawing.Imaging.ColorMatrix> object."},{"pos":[3677,3940],"content":"Create an <ph id=\"ph1\">&lt;xref:System.Drawing.Imaging.ImageAttributes&gt;</ph> object and pass the <ph id=\"ph2\">&lt;xref:System.Drawing.Imaging.ColorMatrix&gt;</ph> object to the <ph id=\"ph3\">&lt;xref:System.Drawing.Imaging.ImageAttributes.SetColorMatrix%2A&gt;</ph> method of the <ph id=\"ph4\">&lt;xref:System.Drawing.Imaging.ImageAttributes&gt;</ph> object.","source":"Create an <xref:System.Drawing.Imaging.ImageAttributes> object and pass the <xref:System.Drawing.Imaging.ColorMatrix> object to the <xref:System.Drawing.Imaging.ImageAttributes.SetColorMatrix%2A> method of the <xref:System.Drawing.Imaging.ImageAttributes> object."},{"pos":[3950,4113],"content":"Pass the <ph id=\"ph1\">&lt;xref:System.Drawing.Imaging.ImageAttributes&gt;</ph> object to the <ph id=\"ph2\">&lt;xref:System.Drawing.Graphics.DrawImage%2A&gt;</ph> method of a <ph id=\"ph3\">&lt;xref:System.Drawing.Graphics&gt;</ph> object.","source":"Pass the <xref:System.Drawing.Imaging.ImageAttributes> object to the <xref:System.Drawing.Graphics.DrawImage%2A> method of a <xref:System.Drawing.Graphics> object."},{"pos":[4120,4415],"content":"[!code-csharp[System.Drawing.RecoloringImages#21](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Drawing.RecoloringImages/CS/Class1.cs#21)]\n[!code-vb[System.Drawing.RecoloringImages#21](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Drawing.RecoloringImages/VB/Class1.vb#21)]","leadings":[""," "],"nodes":[]},{"pos":[4424,4442],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[4446,4656],"content":"The preceding example is designed for use with Windows Forms, and it requires <ph id=\"ph1\">&lt;xref:System.Windows.Forms.PaintEventArgs&gt;</ph> <ph id=\"ph2\">`e`</ph>, which is a parameter of the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Control.Paint&gt;</ph> event handler.","source":"The preceding example is designed for use with Windows Forms, and it requires <xref:System.Windows.Forms.PaintEventArgs> `e`, which is a parameter of the <xref:System.Windows.Forms.Control.Paint> event handler."},{"pos":[4665,4673],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4677,4718],"content":"<bpt id=\"p1\">[</bpt>Recoloring Images<ept id=\"p1\">](recoloring-images.md)</ept>","source":"[Recoloring Images](recoloring-images.md)"},{"pos":[4721,4804],"content":"<bpt id=\"p1\">[</bpt>Coordinate Systems and Transformations<ept id=\"p1\">](coordinate-systems-and-transformations.md)</ept>","source":"[Coordinate Systems and Transformations](coordinate-systems-and-transformations.md)"}]}