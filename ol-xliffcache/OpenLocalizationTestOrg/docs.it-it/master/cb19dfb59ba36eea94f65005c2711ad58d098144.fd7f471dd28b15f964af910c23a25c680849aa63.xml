{"content":"---\ntitle: \"Walkthrough: Implementing a Form That Uses a Background Operation\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"threading [Windows Forms], forms\"\n  - \"BackgroundWorker component\"\n  - \"background tasks\"\n  - \"forms [Windows Forms], multithreading\"\n  - \"threading [Windows Forms], walkthroughs\"\n  - \"forms [Windows Forms], background operations\"\n  - \"threading [Windows Forms], background operations\"\n  - \"background operations\"\nms.assetid: 4691b796-9200-471a-89c3-ba4c7cc78c03\n---\n# Walkthrough: Implementing a Form That Uses a Background Operation\nIf you have an operation that will take a long time to complete, and you do not want your user interface (UI) to stop responding or \"hang,\" you can use the <xref:System.ComponentModel.BackgroundWorker> class to execute the operation on another thread.  \n  \n This walkthrough illustrates how to use the <xref:System.ComponentModel.BackgroundWorker> class to perform time-consuming computations \"in the background,\" while the user interface remains responsive.  When you are through, you will have an application that computes Fibonacci numbers asynchronously. Even though computing a large Fibonacci number can take a noticeable amount of time, the main UI thread will not be interrupted by this delay, and the form will be responsive during the calculation.  \n  \n Tasks illustrated in this walkthrough include:  \n  \n-   Creating a Windows-based Application  \n  \n-   Creating a <xref:System.ComponentModel.BackgroundWorker> in Your Form  \n  \n-   Adding Asynchronous Event Handlers  \n  \n-   Adding Progress Reporting and Support for Cancellation  \n  \n For a complete listing of the code used in this example, see [How to: Implement a Form That Uses a Background Operation](how-to-implement-a-form-that-uses-a-background-operation.md).  \n  \n> [!NOTE]\n>  The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).  \n  \n## Creating the Project  \n The first step is to create the project and to set up the form.  \n  \n#### To create a form that uses a background operation  \n  \n1.  Create a Windows-based application project called `BackgroundWorkerExample` (**File** > **New** > **Project** > **Visual C#** or **Visual Basic** > **Classic Desktop** > **Windows Forms Application**).  \n  \n2.  In **Solution Explorer**, right-click **Form1** and select **Rename** from the shortcut menu. Change the file name to `FibonacciCalculator`. Click the **Yes** button when you are asked if you want to rename all references to the code element '`Form1`'.  \n  \n3.  Drag a <xref:System.Windows.Forms.NumericUpDown> control from the **Toolbox** onto the form. Set the <xref:System.Windows.Forms.NumericUpDown.Minimum%2A> property to `1` and the <xref:System.Windows.Forms.NumericUpDown.Maximum%2A> property to `91`.  \n  \n4.  Add two <xref:System.Windows.Forms.Button> controls to the form.  \n  \n5.  Rename the first <xref:System.Windows.Forms.Button> control `startAsyncButton` and set the <xref:System.Windows.Forms.Control.Text%2A> property to `Start Async`. Rename the second <xref:System.Windows.Forms.Button> control `cancelAsyncButton`, and set the <xref:System.Windows.Forms.Control.Text%2A> property to `Cancel Async`. Set its <xref:System.Windows.Forms.Control.Enabled%2A> property to `false`.  \n  \n6.  Create an event handler for both of the <xref:System.Windows.Forms.Button> controls' <xref:System.Windows.Forms.Control.Click> events. For details, see [How to: Create Event Handlers Using the Designer](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).  \n  \n7.  Drag a <xref:System.Windows.Forms.Label> control from the **Toolbox** onto the form and rename it `resultLabel`.  \n  \n8.  Drag a <xref:System.Windows.Forms.ProgressBar> control from the **Toolbox** onto the form.  \n  \n## Creating a BackgroundWorker in Your Form  \n You can create the <xref:System.ComponentModel.BackgroundWorker> for your asynchronous operation using the **Windows** **Forms Designer**.  \n  \n#### To create a BackgroundWorker with the Designer  \n  \n-   From the **Components** tab of the **Toolbox**, drag a <xref:System.ComponentModel.BackgroundWorker> onto the form.  \n  \n## Adding Asynchronous Event Handlers  \n You are now ready to add event handlers for the <xref:System.ComponentModel.BackgroundWorker> component's asynchronous events. The time-consuming operation that will run in the background, which computes Fibonacci numbers, is called by one of these event handlers.  \n  \n#### To implement asynchronous event handlers  \n  \n1.  In the **Properties** window, with the <xref:System.ComponentModel.BackgroundWorker> component still selected, click the **Events** button. Double-click the <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> events to create event handlers. For more information about how to use event handlers, see [How to: Create Event Handlers Using the Designer](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).  \n  \n2.  Create a new method, called `ComputeFibonacci`, in your form. This method does the actual work, and it will run in the background. This code demonstrates the recursive implementation of the Fibonacci algorithm, which is notably inefficient, taking exponentially longer time to complete for larger numbers. It is used here for illustrative purposes, to show an operation that can introduce long delays in your application.  \n  \n     [!code-cpp[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#10)]\n     [!code-csharp[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#10)]\n     [!code-vb[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#10)]  \n  \n3.  In the <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler, add a call to the `ComputeFibonacci` method. Take the first parameter for `ComputeFibonacci` from the <xref:System.ComponentModel.DoWorkEventArgs.Argument%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>. The <xref:System.ComponentModel.BackgroundWorker> and <xref:System.ComponentModel.DoWorkEventArgs> parameters will be used later for progress reporting and cancellation support. Assign the return value from `ComputeFibonacci` to the <xref:System.ComponentModel.DoWorkEventArgs.Result%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>. This result will be available to the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler.  \n  \n    > [!NOTE]\n    >  The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler does not reference the `backgroundWorker1` instance variable directly, as this would couple this event handler to a specific instance of <xref:System.ComponentModel.BackgroundWorker>. Instead, a reference to the <xref:System.ComponentModel.BackgroundWorker> that raised this event is recovered from the `sender` parameter. This is important when the form hosts more than one <xref:System.ComponentModel.BackgroundWorker>. It is also important not to manipulate any user-interface objects in your <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler. Instead, communicate to the user interface through the <xref:System.ComponentModel.BackgroundWorker> events.  \n  \n     [!code-cpp[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#5)]\n     [!code-csharp[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#5)]\n     [!code-vb[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#5)]  \n  \n4.  In the `startAsyncButton` control's <xref:System.Windows.Forms.Control.Click> event handler, add the code that starts the asynchronous operation.  \n  \n     [!code-cpp[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#13)]\n     [!code-csharp[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#13)]\n     [!code-vb[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#13)]  \n  \n5.  In the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler, assign the result of the calculation to the `resultLabel` control.  \n  \n     [!code-cpp[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#6)]\n     [!code-csharp[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#6)]\n     [!code-vb[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#6)]  \n  \n## Adding Progress Reporting and Support for Cancellation  \n For asynchronous operations that will take a long time, it is often desirable to report progress to the user and to allow the user to cancel the operation. The <xref:System.ComponentModel.BackgroundWorker> class provides an event that allows you to post progress as your background operation proceeds. It also provides a flag that allows your worker code to detect a call to <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> and interrupt itself.  \n  \n#### To implement progress reporting  \n  \n1.  In the **Properties**, window, select `backgroundWorker1`. Set the <xref:System.ComponentModel.BackgroundWorker.WorkerReportsProgress%2A> and <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> properties to `true`.  \n  \n2.  Declare two variables in the `FibonacciCalculator` form. These will be used to track progress.  \n  \n     [!code-cpp[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#14)]\n     [!code-csharp[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#14)]\n     [!code-vb[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#14)]  \n  \n3.  Add an event handler for the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event. In the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event handler, update the <xref:System.Windows.Forms.ProgressBar> with the <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> property of the <xref:System.ComponentModel.ProgressChangedEventArgs> parameter.  \n  \n     [!code-cpp[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#7)]\n     [!code-csharp[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#7)]\n     [!code-vb[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#7)]  \n  \n#### To implement support for cancellation  \n  \n1.  In the `cancelAsyncButton` control's <xref:System.Windows.Forms.Control.Click> event handler, add the code that cancels the asynchronous operation.  \n  \n     [!code-cpp[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#4)]\n     [!code-csharp[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#4)]\n     [!code-vb[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#4)]  \n  \n2.  The following code fragments in the `ComputeFibonacci` method report progress and support cancellation.  \n  \n     [!code-cpp[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#11)]\n     [!code-csharp[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#11)]\n     [!code-vb[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#11)]  \n    [!code-cpp[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#12)]\n    [!code-csharp[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#12)]\n    [!code-vb[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#12)]  \n  \n## Checkpoint  \n At this point, you can compile and run the Fibonacci Calculator application.  \n  \n#### To test your project  \n  \n-   Press F5 to compile and run the application.  \n  \n     While the calculation is running in the background, you will see the <xref:System.Windows.Forms.ProgressBar> displaying the progress of the calculation toward completion. You can also cancel the pending operation.  \n  \n     For small numbers, the calculation should be very fast, but for larger numbers, you should see a noticeable delay. If you enter a value of 30 or greater, you should see a delay of several seconds, depending on the speed of your computer. For values greater than 40, it may take minutes or hours to finish the calculation. While the calculator is busy computing a large Fibonacci number, notice that you can freely move the form around, minimize, maximize, and even dismiss it. This is because the main UI thread is not waiting for the calculation to finish.  \n  \n## Next Steps  \n Now that you have implemented a form that uses a <xref:System.ComponentModel.BackgroundWorker> component to execute a computation in the background, you can explore other possibilities for asynchronous operations:  \n  \n-   Use multiple <xref:System.ComponentModel.BackgroundWorker> objects for several simultaneous operations.  \n  \n-   To debug your multithreaded application, see [How to: Use the Threads Window](/visualstudio/debugger/how-to-use-the-threads-window).  \n  \n-   Implement your own component that supports the asynchronous programming model. For more information, see [Event-based Asynchronous Pattern Overview](../../../standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md).  \n  \n    > [!CAUTION]\n    >  When using multithreading of any sort, you potentially expose yourself to very serious and complex bugs. Consult the [Managed Threading Best Practices](../../../standard/threading/managed-threading-best-practices.md) before implementing any solution that uses multithreading.  \n  \n## See also\n\n- <xref:System.ComponentModel.BackgroundWorker?displayProperty=nameWithType>\n- [Managed Threading](../../../standard/threading/index.md)\n- [Managed Threading Best Practices](../../../standard/threading/managed-threading-best-practices.md)\n- [Event-based Asynchronous Pattern Overview](../../../standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md)\n- [How to: Implement a Form That Uses a Background Operation](how-to-implement-a-form-that-uses-a-background-operation.md)\n- [Walkthrough: Running an Operation in the Background](walkthrough-running-an-operation-in-the-background.md)\n- [BackgroundWorker Component](backgroundworker-component.md)\n","nodes":[{"pos":[4,534],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Implementing a Form That Uses a Background Operation\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"threading [Windows Forms], forms\"\n  - \"BackgroundWorker component\"\n  - \"background tasks\"\n  - \"forms [Windows Forms], multithreading\"\n  - \"threading [Windows Forms], walkthroughs\"\n  - \"forms [Windows Forms], background operations\"\n  - \"threading [Windows Forms], background operations\"\n  - \"background operations\"\nms.assetid: 4691b796-9200-471a-89c3-ba4c7cc78c03","nodes":[{"content":"Walkthrough: Implementing a Form That Uses a Background Operation","nodes":[{"pos":[0,65],"content":"Walkthrough: Implementing a Form That Uses a Background Operation","nodes":[{"content":"Walkthrough: Implementing a Form That Uses a Background Operation","pos":[0,65]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[541,606],"content":"Walkthrough: Implementing a Form That Uses a Background Operation","linkify":"Walkthrough: Implementing a Form That Uses a Background Operation","nodes":[{"content":"Walkthrough: Implementing a Form That Uses a Background Operation","pos":[0,65]}]},{"pos":[607,858],"content":"If you have an operation that will take a long time to complete, and you do not want your user interface (UI) to stop responding or \"hang,\" you can use the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> class to execute the operation on another thread.","source":"If you have an operation that will take a long time to complete, and you do not want your user interface (UI) to stop responding or \"hang,\" you can use the <xref:System.ComponentModel.BackgroundWorker> class to execute the operation on another thread."},{"content":"This walkthrough illustrates how to use the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> class to perform time-consuming computations \"in the background,\" while the user interface remains responsive.","pos":[865,1065],"source":"This walkthrough illustrates how to use the <xref:System.ComponentModel.BackgroundWorker> class to perform time-consuming computations \"in the background,\" while the user interface remains responsive."},{"content":"When you are through, you will have an application that computes Fibonacci numbers asynchronously.","pos":[1067,1165]},{"content":"Even though computing a large Fibonacci number can take a noticeable amount of time, the main UI thread will not be interrupted by this delay, and the form will be responsive during the calculation.","pos":[1166,1364]},{"content":"Tasks illustrated in this walkthrough include:","pos":[1371,1417]},{"content":"Creating a Windows-based Application","pos":[1427,1463]},{"pos":[1473,1542],"content":"Creating a <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> in Your Form","source":"Creating a <xref:System.ComponentModel.BackgroundWorker> in Your Form"},{"content":"Adding Asynchronous Event Handlers","pos":[1552,1586]},{"content":"Adding Progress Reporting and Support for Cancellation","pos":[1596,1650]},{"pos":[1657,1839],"content":"For a complete listing of the code used in this example, see <bpt id=\"p1\">[</bpt>How to: Implement a Form That Uses a Background Operation<ept id=\"p1\">](how-to-implement-a-form-that-uses-a-background-operation.md)</ept>.","source":"For a complete listing of the code used in this example, see [How to: Implement a Form That Uses a Background Operation](how-to-implement-a-form-that-uses-a-background-operation.md)."},{"pos":[1847,2192],"content":"[!NOTE]\n The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).","leadings":["","> "],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).","pos":[9,343],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition.","pos":[0,130]},{"content":"To change your settings, choose <bpt id=\"p1\">**</bpt>Import and Export Settings<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Tools<ept id=\"p2\">**</ept> menu.","pos":[131,216],"source":" To change your settings, choose **Import and Export Settings** on the **Tools** menu."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Personalize the Visual Studio IDE<ept id=\"p1\">](/visualstudio/ide/personalizing-the-visual-studio-ide)</ept>.","pos":[217,334],"source":" For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide)."}]}]},{"pos":[2201,2221],"content":"Creating the Project","linkify":"Creating the Project","nodes":[{"content":"Creating the Project","pos":[0,20]}]},{"content":"The first step is to create the project and to set up the form.","pos":[2225,2288]},{"pos":[2299,2348],"content":"To create a form that uses a background operation","linkify":"To create a form that uses a background operation","nodes":[{"content":"To create a form that uses a background operation","pos":[0,49]}]},{"pos":[2358,2559],"content":"Create a Windows-based application project called <ph id=\"ph1\">`BackgroundWorkerExample`</ph> (<bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept><ph id=\"ph3\"> &gt; </ph><bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept><ph id=\"ph4\"> &gt; </ph><bpt id=\"p4\">**</bpt>Visual C#<ept id=\"p4\">**</ept> or <bpt id=\"p5\">**</bpt>Visual Basic<ept id=\"p5\">**</ept><ph id=\"ph5\"> &gt; </ph><bpt id=\"p6\">**</bpt>Classic Desktop<ept id=\"p6\">**</ept><ph id=\"ph6\"> &gt; </ph><bpt id=\"p7\">**</bpt>Windows Forms Application<ept id=\"p7\">**</ept>).","source":"Create a Windows-based application project called `BackgroundWorkerExample` (**File** > **New** > **Project** > **Visual C#** or **Visual Basic** > **Classic Desktop** > **Windows Forms Application**)."},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click <bpt id=\"p2\">**</bpt>Form1<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Rename<ept id=\"p3\">**</ept> from the shortcut menu.","pos":[2569,2662],"source":"In **Solution Explorer**, right-click **Form1** and select **Rename** from the shortcut menu."},{"content":"Change the file name to <ph id=\"ph1\">`FibonacciCalculator`</ph>.","pos":[2663,2709],"source":" Change the file name to `FibonacciCalculator`."},{"content":"Click the <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept> button when you are asked if you want to rename all references to the code element '<ph id=\"ph1\">`Form1`</ph>'.","pos":[2710,2821],"source":" Click the **Yes** button when you are asked if you want to rename all references to the code element '`Form1`'."},{"content":"Drag a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.NumericUpDown&gt;</ph> control from the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> onto the form.","pos":[2831,2923],"source":"Drag a <xref:System.Windows.Forms.NumericUpDown> control from the **Toolbox** onto the form."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.NumericUpDown.Minimum%2A&gt;</ph> property to <ph id=\"ph2\">`1`</ph> and the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.NumericUpDown.Maximum%2A&gt;</ph> property to <ph id=\"ph4\">`91`</ph>.","pos":[2924,3079],"source":" Set the <xref:System.Windows.Forms.NumericUpDown.Minimum%2A> property to `1` and the <xref:System.Windows.Forms.NumericUpDown.Maximum%2A> property to `91`."},{"pos":[3089,3153],"content":"Add two <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> controls to the form.","source":"Add two <xref:System.Windows.Forms.Button> controls to the form."},{"content":"Rename the first <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> control <ph id=\"ph2\">`startAsyncButton`</ph> and set the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Control.Text%2A&gt;</ph> property to <ph id=\"ph4\">`Start Async`</ph>.","pos":[3163,3324],"source":"Rename the first <xref:System.Windows.Forms.Button> control `startAsyncButton` and set the <xref:System.Windows.Forms.Control.Text%2A> property to `Start Async`."},{"content":"Rename the second <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> control <ph id=\"ph2\">`cancelAsyncButton`</ph>, and set the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Control.Text%2A&gt;</ph> property to <ph id=\"ph4\">`Cancel Async`</ph>.","pos":[3325,3490],"source":" Rename the second <xref:System.Windows.Forms.Button> control `cancelAsyncButton`, and set the <xref:System.Windows.Forms.Control.Text%2A> property to `Cancel Async`."},{"content":"Set its <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Enabled%2A&gt;</ph> property to <ph id=\"ph2\">`false`</ph>.","pos":[3491,3566],"source":" Set its <xref:System.Windows.Forms.Control.Enabled%2A> property to `false`."},{"content":"Create an event handler for both of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> controls' <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> events.","pos":[3576,3710],"source":"Create an event handler for both of the <xref:System.Windows.Forms.Button> controls' <xref:System.Windows.Forms.Control.Click> events."},{"content":"For details, see <bpt id=\"p1\">[</bpt>How to: Create Event Handlers Using the Designer<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100))</ept>.","pos":[3711,3876],"source":" For details, see [How to: Create Event Handlers Using the Designer](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100))."},{"pos":[3886,3998],"content":"Drag a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Label&gt;</ph> control from the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> onto the form and rename it <ph id=\"ph2\">`resultLabel`</ph>.","source":"Drag a <xref:System.Windows.Forms.Label> control from the **Toolbox** onto the form and rename it `resultLabel`."},{"pos":[4008,4098],"content":"Drag a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ProgressBar&gt;</ph> control from the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> onto the form.","source":"Drag a <xref:System.Windows.Forms.ProgressBar> control from the **Toolbox** onto the form."},{"pos":[4107,4147],"content":"Creating a BackgroundWorker in Your Form","linkify":"Creating a BackgroundWorker in Your Form","nodes":[{"content":"Creating a BackgroundWorker in Your Form","pos":[0,40]}]},{"pos":[4151,4289],"content":"You can create the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> for your asynchronous operation using the <bpt id=\"p1\">**</bpt>Windows<ept id=\"p1\">**</ept> <bpt id=\"p2\">**</bpt>Forms Designer<ept id=\"p2\">**</ept>.","source":"You can create the <xref:System.ComponentModel.BackgroundWorker> for your asynchronous operation using the **Windows** **Forms Designer**."},{"pos":[4300,4346],"content":"To create a BackgroundWorker with the Designer","linkify":"To create a BackgroundWorker with the Designer","nodes":[{"content":"To create a BackgroundWorker with the Designer","pos":[0,46]}]},{"pos":[4356,4471],"content":"From the <bpt id=\"p1\">**</bpt>Components<ept id=\"p1\">**</ept> tab of the <bpt id=\"p2\">**</bpt>Toolbox<ept id=\"p2\">**</ept>, drag a <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> onto the form.","source":"From the **Components** tab of the **Toolbox**, drag a <xref:System.ComponentModel.BackgroundWorker> onto the form."},{"pos":[4480,4514],"content":"Adding Asynchronous Event Handlers","linkify":"Adding Asynchronous Event Handlers","nodes":[{"content":"Adding Asynchronous Event Handlers","pos":[0,34]}]},{"content":"You are now ready to add event handlers for the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component's asynchronous events.","pos":[4518,4644],"source":"You are now ready to add event handlers for the <xref:System.ComponentModel.BackgroundWorker> component's asynchronous events."},{"content":"The time-consuming operation that will run in the background, which computes Fibonacci numbers, is called by one of these event handlers.","pos":[4645,4782]},{"pos":[4793,4833],"content":"To implement asynchronous event handlers","linkify":"To implement asynchronous event handlers","nodes":[{"content":"To implement asynchronous event handlers","pos":[0,40]}]},{"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, with the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component still selected, click the <bpt id=\"p2\">**</bpt>Events<ept id=\"p2\">**</ept> button.","pos":[4843,4982],"source":"In the **Properties** window, with the <xref:System.ComponentModel.BackgroundWorker> component still selected, click the **Events** button."},{"content":"Double-click the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.DoWork&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted&gt;</ph> events to create event handlers.","pos":[4983,5154],"source":" Double-click the <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> events to create event handlers."},{"content":"For more information about how to use event handlers, see <bpt id=\"p1\">[</bpt>How to: Create Event Handlers Using the Designer<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100))</ept>.","pos":[5155,5361],"source":" For more information about how to use event handlers, see [How to: Create Event Handlers Using the Designer](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100))."},{"content":"Create a new method, called <ph id=\"ph1\">`ComputeFibonacci`</ph>, in your form.","pos":[5371,5432],"source":"Create a new method, called `ComputeFibonacci`, in your form."},{"content":"This method does the actual work, and it will run in the background.","pos":[5433,5501]},{"content":"This code demonstrates the recursive implementation of the Fibonacci algorithm, which is notably inefficient, taking exponentially longer time to complete for larger numbers.","pos":[5502,5676]},{"content":"It is used here for illustrative purposes, to show an operation that can introduce long delays in your application.","pos":[5677,5792]},{"pos":[5803,6313],"content":"[!code-cpp[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#10)]\n [!code-csharp[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#10)]\n [!code-vb[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#10)]","leadings":["","    ","    "],"nodes":[]},{"content":"In the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.DoWork&gt;</ph> event handler, add a call to the <ph id=\"ph2\">`ComputeFibonacci`</ph> method.","pos":[6323,6442],"source":"In the <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler, add a call to the `ComputeFibonacci` method."},{"content":"Take the first parameter for <ph id=\"ph1\">`ComputeFibonacci`</ph> from the <ph id=\"ph2\">&lt;xref:System.ComponentModel.DoWorkEventArgs.Argument%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.ComponentModel.DoWorkEventArgs&gt;</ph>.","pos":[6443,6618],"source":" Take the first parameter for `ComputeFibonacci` from the <xref:System.ComponentModel.DoWorkEventArgs.Argument%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ComponentModel.DoWorkEventArgs&gt;</ph> parameters will be used later for progress reporting and cancellation support.","pos":[6619,6796],"source":" The <xref:System.ComponentModel.BackgroundWorker> and <xref:System.ComponentModel.DoWorkEventArgs> parameters will be used later for progress reporting and cancellation support."},{"content":"Assign the return value from <ph id=\"ph1\">`ComputeFibonacci`</ph> to the <ph id=\"ph2\">&lt;xref:System.ComponentModel.DoWorkEventArgs.Result%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.ComponentModel.DoWorkEventArgs&gt;</ph>.","pos":[6797,6968],"source":" Assign the return value from `ComputeFibonacci` to the <xref:System.ComponentModel.DoWorkEventArgs.Result%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>."},{"content":"This result will be available to the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted&gt;</ph> event handler.","pos":[6969,7085],"source":" This result will be available to the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler."},{"pos":[7097,7855],"content":"[!NOTE]\nThe <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler does not reference the `backgroundWorker1` instance variable directly, as this would couple this event handler to a specific instance of <xref:System.ComponentModel.BackgroundWorker>. Instead, a reference to the <xref:System.ComponentModel.BackgroundWorker> that raised this event is recovered from the `sender` parameter. This is important when the form hosts more than one <xref:System.ComponentModel.BackgroundWorker>. It is also important not to manipulate any user-interface objects in your <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler. Instead, communicate to the user interface through the <xref:System.ComponentModel.BackgroundWorker> events.","leadings":["","    >  "],"nodes":[{"content":"The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler does not reference the `backgroundWorker1` instance variable directly, as this would couple this event handler to a specific instance of <xref:System.ComponentModel.BackgroundWorker>. Instead, a reference to the <xref:System.ComponentModel.BackgroundWorker> that raised this event is recovered from the `sender` parameter. This is important when the form hosts more than one <xref:System.ComponentModel.BackgroundWorker>. It is also important not to manipulate any user-interface objects in your <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler. Instead, communicate to the user interface through the <xref:System.ComponentModel.BackgroundWorker> events.","pos":[8,751],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.DoWork&gt;</ph> event handler does not reference the <ph id=\"ph2\">`backgroundWorker1`</ph> instance variable directly, as this would couple this event handler to a specific instance of <ph id=\"ph3\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph>.","pos":[0,254],"source":"The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler does not reference the `backgroundWorker1` instance variable directly, as this would couple this event handler to a specific instance of <xref:System.ComponentModel.BackgroundWorker>."},{"content":"Instead, a reference to the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> that raised this event is recovered from the <ph id=\"ph2\">`sender`</ph> parameter.","pos":[255,393],"source":" Instead, a reference to the <xref:System.ComponentModel.BackgroundWorker> that raised this event is recovered from the `sender` parameter."},{"content":"This is important when the form hosts more than one <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph>.","pos":[394,492],"source":" This is important when the form hosts more than one <xref:System.ComponentModel.BackgroundWorker>."},{"content":"It is also important not to manipulate any user-interface objects in your <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.DoWork&gt;</ph> event handler.","pos":[493,634],"source":" It is also important not to manipulate any user-interface objects in your <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler."},{"content":"Instead, communicate to the user interface through the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> events.","pos":[635,743],"source":" Instead, communicate to the user interface through the <xref:System.ComponentModel.BackgroundWorker> events."}]}]},{"pos":[7866,8370],"content":"[!code-cpp[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#5)]\n [!code-csharp[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#5)]\n [!code-vb[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#5)]","leadings":["","    ","    "],"nodes":[]},{"pos":[8380,8525],"content":"In the <ph id=\"ph1\">`startAsyncButton`</ph> control's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler, add the code that starts the asynchronous operation.","source":"In the `startAsyncButton` control's <xref:System.Windows.Forms.Control.Click> event handler, add the code that starts the asynchronous operation."},{"pos":[8536,9046],"content":"[!code-cpp[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#13)]\n [!code-csharp[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#13)]\n [!code-vb[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#13)]","leadings":["","    ","    "],"nodes":[]},{"pos":[9056,9209],"content":"In the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted&gt;</ph> event handler, assign the result of the calculation to the <ph id=\"ph2\">`resultLabel`</ph> control.","source":"In the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler, assign the result of the calculation to the `resultLabel` control."},{"pos":[9220,9724],"content":"[!code-cpp[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#6)]\n [!code-csharp[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#6)]\n [!code-vb[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#6)]","leadings":["","    ","    "],"nodes":[]},{"pos":[9733,9787],"content":"Adding Progress Reporting and Support for Cancellation","linkify":"Adding Progress Reporting and Support for Cancellation","nodes":[{"content":"Adding Progress Reporting and Support for Cancellation","pos":[0,54]}]},{"content":"For asynchronous operations that will take a long time, it is often desirable to report progress to the user and to allow the user to cancel the operation.","pos":[9791,9946]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> class provides an event that allows you to post progress as your background operation proceeds.","pos":[9947,10092],"source":" The <xref:System.ComponentModel.BackgroundWorker> class provides an event that allows you to post progress as your background operation proceeds."},{"content":"It also provides a flag that allows your worker code to detect a call to <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A&gt;</ph> and interrupt itself.","pos":[10093,10248],"source":" It also provides a flag that allows your worker code to detect a call to <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> and interrupt itself."},{"pos":[10259,10290],"content":"To implement progress reporting","linkify":"To implement progress reporting","nodes":[{"content":"To implement progress reporting","pos":[0,31]}]},{"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>, window, select <ph id=\"ph1\">`backgroundWorker1`</ph>.","pos":[10300,10358],"source":"In the **Properties**, window, select `backgroundWorker1`."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.WorkerReportsProgress%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A&gt;</ph> properties to <ph id=\"ph3\">`true`</ph>.","pos":[10359,10539],"source":" Set the <xref:System.ComponentModel.BackgroundWorker.WorkerReportsProgress%2A> and <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> properties to `true`."},{"content":"Declare two variables in the <ph id=\"ph1\">`FibonacciCalculator`</ph> form.","pos":[10549,10605],"source":"Declare two variables in the `FibonacciCalculator` form."},{"content":"These will be used to track progress.","pos":[10606,10643]},{"pos":[10654,11164],"content":"[!code-cpp[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#14)]\n [!code-csharp[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#14)]\n [!code-vb[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#14)]","leadings":["","    ","    "],"nodes":[]},{"content":"Add an event handler for the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.ProgressChanged&gt;</ph> event.","pos":[11174,11271],"source":"Add an event handler for the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event."},{"content":"In the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.ProgressChanged&gt;</ph> event handler, update the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ProgressBar&gt;</ph> with the <ph id=\"ph3\">&lt;xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A&gt;</ph> property of the <ph id=\"ph4\">&lt;xref:System.ComponentModel.ProgressChangedEventArgs&gt;</ph> parameter.","pos":[11272,11572],"source":" In the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event handler, update the <xref:System.Windows.Forms.ProgressBar> with the <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> property of the <xref:System.ComponentModel.ProgressChangedEventArgs> parameter."},{"pos":[11583,12087],"content":"[!code-cpp[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#7)]\n [!code-csharp[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#7)]\n [!code-vb[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#7)]","leadings":["","    ","    "],"nodes":[]},{"pos":[12098,12135],"content":"To implement support for cancellation","linkify":"To implement support for cancellation","nodes":[{"content":"To implement support for cancellation","pos":[0,37]}]},{"pos":[12145,12292],"content":"In the <ph id=\"ph1\">`cancelAsyncButton`</ph> control's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handler, add the code that cancels the asynchronous operation.","source":"In the `cancelAsyncButton` control's <xref:System.Windows.Forms.Control.Click> event handler, add the code that cancels the asynchronous operation."},{"pos":[12303,12807],"content":"[!code-cpp[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#4)]\n [!code-csharp[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#4)]\n [!code-vb[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#4)]","leadings":["","    ","    "],"nodes":[]},{"pos":[12817,12920],"content":"The following code fragments in the <ph id=\"ph1\">`ComputeFibonacci`</ph> method report progress and support cancellation.","source":"The following code fragments in the `ComputeFibonacci` method report progress and support cancellation."},{"pos":[12931,13956],"content":"[!code-cpp[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#11)]\n [!code-csharp[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#11)]\n [!code-vb[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#11)]  \n[!code-cpp[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#12)]\n[!code-csharp[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#12)]\n[!code-vb[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#12)]","leadings":["","    ","    ","    ","    ","    "],"nodes":[]},{"pos":[13965,13975],"content":"Checkpoint","linkify":"Checkpoint","nodes":[{"content":"Checkpoint","pos":[0,10]}]},{"content":"At this point, you can compile and run the Fibonacci Calculator application.","pos":[13979,14055]},{"pos":[14066,14086],"content":"To test your project","linkify":"To test your project","nodes":[{"content":"To test your project","pos":[0,20]}]},{"content":"Press F5 to compile and run the application.","pos":[14096,14140]},{"content":"While the calculation is running in the background, you will see the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ProgressBar&gt;</ph> displaying the progress of the calculation toward completion.","pos":[14151,14321],"source":"While the calculation is running in the background, you will see the <xref:System.Windows.Forms.ProgressBar> displaying the progress of the calculation toward completion."},{"content":"You can also cancel the pending operation.","pos":[14322,14364]},{"content":"For small numbers, the calculation should be very fast, but for larger numbers, you should see a noticeable delay.","pos":[14375,14489]},{"content":"If you enter a value of 30 or greater, you should see a delay of several seconds, depending on the speed of your computer.","pos":[14490,14612]},{"content":"For values greater than 40, it may take minutes or hours to finish the calculation.","pos":[14613,14696]},{"content":"While the calculator is busy computing a large Fibonacci number, notice that you can freely move the form around, minimize, maximize, and even dismiss it.","pos":[14697,14851]},{"content":"This is because the main UI thread is not waiting for the calculation to finish.","pos":[14852,14932]},{"pos":[14941,14951],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"pos":[14955,15168],"content":"Now that you have implemented a form that uses a <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component to execute a computation in the background, you can explore other possibilities for asynchronous operations:","source":"Now that you have implemented a form that uses a <xref:System.ComponentModel.BackgroundWorker> component to execute a computation in the background, you can explore other possibilities for asynchronous operations:"},{"pos":[15178,15281],"content":"Use multiple <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> objects for several simultaneous operations.","source":"Use multiple <xref:System.ComponentModel.BackgroundWorker> objects for several simultaneous operations."},{"pos":[15291,15423],"content":"To debug your multithreaded application, see <bpt id=\"p1\">[</bpt>How to: Use the Threads Window<ept id=\"p1\">](/visualstudio/debugger/how-to-use-the-threads-window)</ept>.","source":"To debug your multithreaded application, see [How to: Use the Threads Window](/visualstudio/debugger/how-to-use-the-threads-window)."},{"content":"Implement your own component that supports the asynchronous programming model.","pos":[15433,15511]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Event-based Asynchronous Pattern Overview<ept id=\"p1\">](../../../standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md)</ept>.","pos":[15512,15680],"source":" For more information, see [Event-based Asynchronous Pattern Overview](../../../standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md)."},{"pos":[15692,15985],"content":"[!CAUTION]\nWhen using multithreading of any sort, you potentially expose yourself to very serious and complex bugs. Consult the [Managed Threading Best Practices](../../../standard/threading/managed-threading-best-practices.md) before implementing any solution that uses multithreading.","leadings":["","    >  "],"nodes":[{"content":"When using multithreading of any sort, you potentially expose yourself to very serious and complex bugs. Consult the [Managed Threading Best Practices](../../../standard/threading/managed-threading-best-practices.md) before implementing any solution that uses multithreading.","pos":[11,286],"nodes":[{"content":"When using multithreading of any sort, you potentially expose yourself to very serious and complex bugs.","pos":[0,104]},{"content":"Consult the <bpt id=\"p1\">[</bpt>Managed Threading Best Practices<ept id=\"p1\">](../../../standard/threading/managed-threading-best-practices.md)</ept> before implementing any solution that uses multithreading.","pos":[105,275],"source":" Consult the [Managed Threading Best Practices](../../../standard/threading/managed-threading-best-practices.md) before implementing any solution that uses multithreading."}]}]},{"pos":[15994,16002],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[16083,16140],"content":"<bpt id=\"p1\">[</bpt>Managed Threading<ept id=\"p1\">](../../../standard/threading/index.md)</ept>","source":"[Managed Threading](../../../standard/threading/index.md)"},{"pos":[16143,16242],"content":"<bpt id=\"p1\">[</bpt>Managed Threading Best Practices<ept id=\"p1\">](../../../standard/threading/managed-threading-best-practices.md)</ept>","source":"[Managed Threading Best Practices](../../../standard/threading/managed-threading-best-practices.md)"},{"pos":[16245,16386],"content":"<bpt id=\"p1\">[</bpt>Event-based Asynchronous Pattern Overview<ept id=\"p1\">](../../../standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md)</ept>","source":"[Event-based Asynchronous Pattern Overview](../../../standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md)"},{"pos":[16389,16509],"content":"<bpt id=\"p1\">[</bpt>How to: Implement a Form That Uses a Background Operation<ept id=\"p1\">](how-to-implement-a-form-that-uses-a-background-operation.md)</ept>","source":"[How to: Implement a Form That Uses a Background Operation](how-to-implement-a-form-that-uses-a-background-operation.md)"},{"pos":[16512,16620],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Running an Operation in the Background<ept id=\"p1\">](walkthrough-running-an-operation-in-the-background.md)</ept>","source":"[Walkthrough: Running an Operation in the Background](walkthrough-running-an-operation-in-the-background.md)"},{"pos":[16623,16682],"content":"<bpt id=\"p1\">[</bpt>BackgroundWorker Component<ept id=\"p1\">](backgroundworker-component.md)</ept>","source":"[BackgroundWorker Component](backgroundworker-component.md)"}]}