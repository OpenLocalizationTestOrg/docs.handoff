{"content":"---\ntitle: \"Cloning vs. Attaching (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 3c3bd105-c9d3-49bd-875b-27ab4e8bc7a3\n---\n# Cloning vs. Attaching (Visual Basic)\nWhen adding <xref:System.Xml.Linq.XNode> (including <xref:System.Xml.Linq.XElement>) or <xref:System.Xml.Linq.XAttribute> objects to a new tree, if the new content has no parent, the objects are simply attached to the XML tree. If the new content already is parented, and is part of another XML tree, the new content is cloned. The newly cloned content is then attached to the XML tree.  \n  \n## Example  \n The following code demonstrates the behavior when you add a parented element to a tree, and when you add an element with no parent to a tree.  \n  \n```vb  \n' Create a tree with a child element.  \nDim xmlTree1 As XElement = _  \n    <Root>  \n        <Child1>1</Child1>  \n    </Root>  \n  \n' Create an element that is not parented.  \nDim child2 As XElement = <Child2>2</Child2>  \n  \n' Create a tree and add Child1 and Child2 to it.  \nDim xmlTree2 As XElement = _  \n    <Root>  \n        <%= xmlTree1.<Child1>(0) %>  \n        <%= child2 %>  \n    </Root>  \n  \n' Compare Child1 identity.  \nConsole.WriteLine(\"Child1 was {0}\", _  \n    IIf(xmlTree1.Element(\"Child1\") Is xmlTree2.Element(\"Child1\"), _  \n    \"attached\", \"cloned\"))  \n  \n' Compare Child2 identity.  \nConsole.WriteLine(\"Child2 was {0}\", _  \n    IIf(child2 Is xmlTree2.Element(\"Child2\"), _  \n    \"attached\", \"cloned\"))  \n```  \n  \n This example produces the following output:  \n  \n```  \nChild1 was cloned  \nChild2 was attached  \n```  \n  \n## See also\n\n- [Creating XML Trees (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/creating-xml-trees.md)\n","nodes":[{"pos":[4,118],"embed":true,"restype":"x-metadata","content":"title: \"Cloning vs. Attaching (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 3c3bd105-c9d3-49bd-875b-27ab4e8bc7a3","nodes":[{"content":"Cloning vs. Attaching (Visual Basic)","nodes":[{"pos":[0,36],"content":"Cloning vs. Attaching (Visual Basic)","nodes":[{"content":"Cloning vs. Attaching (Visual Basic)","pos":[0,36]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[125,161],"content":"Cloning vs. Attaching (Visual Basic)","linkify":"Cloning vs. Attaching (Visual Basic)","nodes":[{"content":"Cloning vs. Attaching (Visual Basic)","pos":[0,36]}]},{"content":"When adding <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XNode&gt;</ph> (including <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement&gt;</ph>) or <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XAttribute&gt;</ph> objects to a new tree, if the new content has no parent, the objects are simply attached to the XML tree.","pos":[162,389],"source":"When adding <xref:System.Xml.Linq.XNode> (including <xref:System.Xml.Linq.XElement>) or <xref:System.Xml.Linq.XAttribute> objects to a new tree, if the new content has no parent, the objects are simply attached to the XML tree."},{"content":"If the new content already is parented, and is part of another XML tree, the new content is cloned.","pos":[390,489]},{"content":"The newly cloned content is then attached to the XML tree.","pos":[490,548]},{"pos":[557,564],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code demonstrates the behavior when you add a parented element to a tree, and when you add an element with no parent to a tree.","pos":[568,709]},{"content":"This example produces the following output:","pos":[1449,1492]},{"pos":[1558,1566],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1570,1685],"content":"<bpt id=\"p1\">[</bpt>Creating XML Trees (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/creating-xml-trees.md)</ept>","source":"[Creating XML Trees (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/creating-xml-trees.md)"}]}