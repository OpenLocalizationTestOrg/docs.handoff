{"content":"---\ntitle: \"How to: Determine Which Modifier Key Was Pressed | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-winforms\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"keyboard input\"\n  - \"shift keys\"\n  - \"events [Windows Forms], mouse\"\n  - \"Keys.ControlKey enumeration member\"\n  - \"keys, control keys\"\n  - \"user input, checking for keyboard\"\n  - \"keys, determining last pressed\"\n  - \"keys, shift keys\"\n  - \"keys, modifier keys\"\n  - \"control keys\"\n  - \"keys, alt keys\"\n  - \"alt keys\"\n  - \"Keys.Shift enumeration member\"\n  - \"events [Windows Forms], keyboard\"\n  - \"keyboards, keyboard input\"\n  - \"Keys.Alt enumeration member\"\n  - \"modifier keys\"\nms.assetid: 1e184048-0ae3-4067-a200-d4ba31dbc2cb\ncaps.latest.revision: 16\nauthor: dotnet-bot\nms.author: dotnetcontent\nmanager: \"wpickett\"\n---\n# How to: Determine Which Modifier Key Was Pressed\nWhen you create an application that accepts the user's keystrokes, you may also want to monitor for modifier keys such as the SHIFT, ALT, and CTRL keys. When a modifier key is pressed in combination with other keys, or with mouse clicks, your application can respond appropriately. For example, if the letter S is pressed, this may simply cause an \"s\" to appear on the screen, but if the keys CTRL+S are pressed, the current document may be saved. If you handle the <xref:System.Windows.Forms.Control.KeyDown> event, the <xref:System.Windows.Forms.KeyEventArgs.Modifiers%2A> property of the <xref:System.Windows.Forms.KeyEventArgs> received by the event handler specifies which modifier keys are pressed. Alternatively, the <xref:System.Windows.Forms.KeyEventArgs.KeyData%2A> property of <xref:System.Windows.Forms.KeyEventArgs> specifies the character that was pressed as well as any modifier keys combined with a bitwise OR. However, if you are handling the <xref:System.Windows.Forms.Control.KeyPress> event or a mouse event, the event handler does not receive this information. In this case, you must use the <xref:System.Windows.Forms.Control.ModifierKeys%2A> property of the <xref:System.Windows.Forms.Control> class. In either case, you must perform a bitwise AND of the appropriate <xref:System.Windows.Forms.Keys> value and the value you are testing. The <xref:System.Windows.Forms.Keys> enumeration offers variations of each modifier key, so it is important that you perform the bitwise AND with the correct value. For example, the SHIFT key is represented by <xref:System.Windows.Forms.Keys>, <xref:System.Windows.Forms.Keys>, <xref:System.Windows.Forms.Keys> and <xref:System.Windows.Forms.Keys> The correct value to test SHIFT as a modifier key is <xref:System.Windows.Forms.Keys>. Similarly, to test for CTLR and ALT as modifiers you should use the <xref:System.Windows.Forms.Keys> and <xref:System.Windows.Forms.Keys> values, respectively.  \n  \n> [!NOTE]\n>  Visual Basic programmers can also access key information through the <xref:Microsoft.VisualBasic.Devices.Computer.Keyboard%2A> property  \n  \n### To determine which modifier key was pressed  \n  \n-   Use the bitwise `AND` operator with the <xref:System.Windows.Forms.Control.ModifierKeys%2A> property and a value of the <xref:System.Windows.Forms.Keys> enumeration to determine whether a particular modifier key is pressed. The following code example shows how to determine whether the SHIFT key is pressed within a <xref:System.Windows.Forms.Control.KeyPress> event handler.  \n  \n     [!code-cpp[System.Windows.Forms.DetermineModifierKey#5](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.DetermineModifierKey/cpp/form1.cpp#5)]\n     [!code-csharp[System.Windows.Forms.DetermineModifierKey#5](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DetermineModifierKey/CS/form1.cs#5)]\n     [!code-vb[System.Windows.Forms.DetermineModifierKey#5](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DetermineModifierKey/VB/form1.vb#5)]  \n  \n## See Also  \n <xref:System.Windows.Forms.Keys>   \n <xref:System.Windows.Forms.Control.ModifierKeys%2A>   \n [Keyboard Input in a Windows Forms Application](../../../docs/framework/winforms/keyboard-input-in-a-windows-forms-application.md)   \n [How to: Determine If CapsLock is On in Visual Basic](http://msdn.microsoft.com/en-us/91e60f5c-dd61-4222-ba5f-39af803afd8c)","nodes":[{"pos":[12,77],"content":"How to: Determine Which Modifier Key Was Pressed | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Determine Which Modifier Key Was Pressed | Microsoft Docs","pos":[0,65]}]},{"pos":[919,967],"content":"How to: Determine Which Modifier Key Was Pressed","linkify":"How to: Determine Which Modifier Key Was Pressed","nodes":[{"content":"How to: Determine Which Modifier Key Was Pressed","pos":[0,48]}]},{"content":"When you create an application that accepts the user's keystrokes, you may also want to monitor for modifier keys such as the SHIFT, ALT, and CTRL keys.","pos":[968,1120]},{"content":"When a modifier key is pressed in combination with other keys, or with mouse clicks, your application can respond appropriately.","pos":[1121,1249]},{"content":"For example, if the letter S is pressed, this may simply cause an \"s\" to appear on the screen, but if the keys CTRL+S are pressed, the current document may be saved.","pos":[1250,1415]},{"content":"If you handle the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.KeyDown&gt;</ph> event, the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.KeyEventArgs.Modifiers%2A&gt;</ph> property of the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.KeyEventArgs&gt;</ph> received by the event handler specifies which modifier keys are pressed.","pos":[1416,1672],"source":" If you handle the <xref:System.Windows.Forms.Control.KeyDown> event, the <xref:System.Windows.Forms.KeyEventArgs.Modifiers%2A> property of the <xref:System.Windows.Forms.KeyEventArgs> received by the event handler specifies which modifier keys are pressed."},{"content":"Alternatively, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.KeyEventArgs.KeyData%2A&gt;</ph> property of <ph id=\"ph2\">&lt;xref:System.Windows.Forms.KeyEventArgs&gt;</ph> specifies the character that was pressed as well as any modifier keys combined with a bitwise OR.","pos":[1673,1894],"source":" Alternatively, the <xref:System.Windows.Forms.KeyEventArgs.KeyData%2A> property of <xref:System.Windows.Forms.KeyEventArgs> specifies the character that was pressed as well as any modifier keys combined with a bitwise OR."},{"content":"However, if you are handling the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.KeyPress&gt;</ph> event or a mouse event, the event handler does not receive this information.","pos":[1895,2049],"source":" However, if you are handling the <xref:System.Windows.Forms.Control.KeyPress> event or a mouse event, the event handler does not receive this information."},{"content":"In this case, you must use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.ModifierKeys%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control&gt;</ph> class.","pos":[2050,2191],"source":" In this case, you must use the <xref:System.Windows.Forms.Control.ModifierKeys%2A> property of the <xref:System.Windows.Forms.Control> class."},{"content":"In either case, you must perform a bitwise AND of the appropriate <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Keys&gt;</ph> value and the value you are testing.","pos":[2192,2327],"source":" In either case, you must perform a bitwise AND of the appropriate <xref:System.Windows.Forms.Keys> value and the value you are testing."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Keys&gt;</ph> enumeration offers variations of each modifier key, so it is important that you perform the bitwise AND with the correct value.","pos":[2328,2492],"source":" The <xref:System.Windows.Forms.Keys> enumeration offers variations of each modifier key, so it is important that you perform the bitwise AND with the correct value."},{"content":"For example, the SHIFT key is represented by <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Keys&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Keys&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Keys&gt;</ph> and <ph id=\"ph4\">&lt;xref:System.Windows.Forms.Keys&gt;</ph> The correct value to test SHIFT as a modifier key is <ph id=\"ph5\">&lt;xref:System.Windows.Forms.Keys&gt;</ph>.","pos":[2493,2762],"source":" For example, the SHIFT key is represented by <xref:System.Windows.Forms.Keys>, <xref:System.Windows.Forms.Keys>, <xref:System.Windows.Forms.Keys> and <xref:System.Windows.Forms.Keys> The correct value to test SHIFT as a modifier key is <xref:System.Windows.Forms.Keys>."},{"content":"Similarly, to test for CTLR and ALT as modifiers you should use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Keys&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Keys&gt;</ph> values, respectively.","pos":[2763,2922],"source":" Similarly, to test for CTLR and ALT as modifiers you should use the <xref:System.Windows.Forms.Keys> and <xref:System.Windows.Forms.Keys> values, respectively."},{"pos":[2930,3076],"content":"[!NOTE]\n Visual Basic programmers can also access key information through the <xref:Microsoft.VisualBasic.Devices.Computer.Keyboard%2A> property","leadings":["","> "],"nodes":[{"content":"Visual Basic programmers can also access key information through the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.Devices.Computer.Keyboard%2A&gt;</ph> property","pos":[9,144],"source":" Visual Basic programmers can also access key information through the <xref:Microsoft.VisualBasic.Devices.Computer.Keyboard%2A> property"}]},{"pos":[3086,3129],"content":"To determine which modifier key was pressed","linkify":"To determine which modifier key was pressed","nodes":[{"content":"To determine which modifier key was pressed","pos":[0,43]}]},{"content":"Use the bitwise <ph id=\"ph1\">`AND`</ph> operator with the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.ModifierKeys%2A&gt;</ph> property and a value of the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Keys&gt;</ph> enumeration to determine whether a particular modifier key is pressed.","pos":[3139,3362],"source":"Use the bitwise `AND` operator with the <xref:System.Windows.Forms.Control.ModifierKeys%2A> property and a value of the <xref:System.Windows.Forms.Keys> enumeration to determine whether a particular modifier key is pressed."},{"content":"The following code example shows how to determine whether the SHIFT key is pressed within a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.KeyPress&gt;</ph> event handler.","pos":[3363,3514],"source":" The following code example shows how to determine whether the SHIFT key is pressed within a <xref:System.Windows.Forms.Control.KeyPress> event handler."},{"pos":[3525,4044],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>System.Windows.Forms.DetermineModifierKey#5<ept id=\"p2\">](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.DetermineModifierKey/cpp/form1.cpp#5)</ept><ept id=\"p1\">]</ept>  <bpt id=\"p3\">[!code-csharp</bpt><bpt id=\"p4\">[</bpt>System.Windows.Forms.DetermineModifierKey#5<ept id=\"p4\">](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DetermineModifierKey/CS/form1.cs#5)</ept><ept id=\"p3\">]</ept>  <bpt id=\"p5\">[!code-vb</bpt><bpt id=\"p6\">[</bpt>System.Windows.Forms.DetermineModifierKey#5<ept id=\"p6\">](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DetermineModifierKey/VB/form1.vb#5)</ept><ept id=\"p5\">]</ept>","leadings":["","    ","    "],"source":"[!code-cpp[System.Windows.Forms.DetermineModifierKey#5](../../../samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.DetermineModifierKey/cpp/form1.cpp#5)]\n [!code-csharp[System.Windows.Forms.DetermineModifierKey#5](../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DetermineModifierKey/CS/form1.cs#5)]\n [!code-vb[System.Windows.Forms.DetermineModifierKey#5](../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DetermineModifierKey/VB/form1.vb#5)]"},{"pos":[4053,4061],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>Keyboard Input in a Windows Forms Application<ept id=\"p1\">](../../../docs/framework/winforms/keyboard-input-in-a-windows-forms-application.md)</ept><ph id=\"ph1\"> </ph>","pos":[4157,4289],"source":" [Keyboard Input in a Windows Forms Application](../../../docs/framework/winforms/keyboard-input-in-a-windows-forms-application.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Determine If CapsLock is On in Visual Basic<ept id=\"p1\">](http://msdn.microsoft.com/en-us/91e60f5c-dd61-4222-ba5f-39af803afd8c)</ept>","pos":[4292,4416],"source":" [How to: Determine If CapsLock is On in Visual Basic](http://msdn.microsoft.com/en-us/91e60f5c-dd61-4222-ba5f-39af803afd8c)"}]}