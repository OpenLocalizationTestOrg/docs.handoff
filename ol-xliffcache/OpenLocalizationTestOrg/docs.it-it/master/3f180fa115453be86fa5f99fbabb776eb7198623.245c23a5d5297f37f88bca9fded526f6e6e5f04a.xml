{"content":"---\ntitle: \"Side by Side Versioning in WorkflowServiceHost\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 60887eed-df40-4412-b812-41e1dd329d15\n---\n# Side by Side Versioning in WorkflowServiceHost\nThe <xref:System.ServiceModel.Activities.WorkflowServiceHost> side-by-side versioning introduced in [!INCLUDE[net_v45](../../../../includes/net-v45-md.md)] provides the capability to host multiple versions of a workflow service on a single endpoint. The side-by-side functionality provided allows a workflow service to be configured so that new instances of the workflow service are created using the new workflow definition, while running instances complete using the existing definition. This topic provides an overview of workflow service side-by-side execution using <xref:System.ServiceModel.Activities.WorkflowServiceHost>.  \n  \n> [!NOTE]\n>  To download a sample and watch a video walkthrough of workflow service side-by-side versioning, see [Side by Side Versioning with a Web-Hosted Xamlx Workflow Service](https://go.microsoft.com/fwlink/?LinkId=393746).  \n  \n## Hosting Multiple Versions in a Workflow Service  \n <xref:System.ServiceModel.Activities.WorkflowServiceHost> contains two properties that can be configured to allow multiple versions of a workflow to execute side-by-side: <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> and <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>. <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> contains the supported versions of the workflow service, and <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> is used to uniquely identify each workflow service. This is done by associating a <xref:System.Activities.WorkflowIdentity> with the workflow service. A <xref:System.Activities.WorkflowIdentity> contains three identifying pieces of information. <xref:System.Activities.WorkflowIdentity.Name%2A> and <xref:System.Activities.WorkflowIdentity.Version%2A> contain a name and a <xref:System.Version> and are required, and <xref:System.Activities.WorkflowIdentity.Package%2A> is optional and can be used to specify an additional string containing information such as assembly name or other desired information. Each workflow service contained in the <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> collection must have a unique <xref:System.Activities.WorkflowIdentity>. A <xref:System.Activities.WorkflowIdentity> is unique if any of its three properties are different from another <xref:System.Activities.WorkflowIdentity>. A `null` <xref:System.Activities.WorkflowIdentity> is an allowable value for <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>, but only one previous version of a workflow service may have a `null` <xref:System.Activities.WorkflowIdentity>.  \n  \n> [!IMPORTANT]\n>  A <xref:System.Activities.WorkflowIdentity> should not contain any personally identifiable information (PII). <xref:System.Activities.WorkflowIdentity> is composed of three parts: a <xref:System.Activities.WorkflowIdentity.Name%2A> (<xref:System.String>), a <xref:System.Activities.WorkflowIdentity.Version%2A> (<xref:System.Version>), and a <xref:System.Activities.WorkflowIdentity.Package%2A> (<xref:System.String>). Information about the <xref:System.Activities.WorkflowIdentity> used to create an instance is emitted to any configured tracking services at several different points of the activity life-cycle by the runtime. WF Tracking does not have any mechanism to hide PII (sensitive user data). Therefore, a <xref:System.Activities.WorkflowIdentity> instance should not contain any PII data as it will be emitted by the runtime in tracking records and may be visible to anyone with access to view the tracking records.  \n  \n### Rules for Hosting Multiple Versions of a Workflow Service  \n When a user adds an additional version to the <xref:System.ServiceModel.Activities.WorkflowServiceHost>, there are several conditions that must be met in order for a workflow service to be hosted with the same set of endpoints and description. If any of the additional versions fail to meet these conditions, the <xref:System.ServiceModel.Activities.WorkflowServiceHost> throws an exception when `Open` is called. Each workflow definition provided to the host as an additional version must meet the following requirements (where the primary version is the workflow service definition that is provided to the host constructor). The additional workflow version must:  \n  \n-   Have the same the <xref:System.ServiceModel.Activities.WorkflowService.Name%2A> as the primary version of the workflow service.  \n  \n-   Must not have any <xref:System.ServiceModel.Activities.Receive> or <xref:System.ServiceModel.Activities.SendReply> activities in its <xref:System.ServiceModel.Activities.WorkflowService.Body%2A> that are not in the primary version, and they must match the operation contract.  \n  \n-   Have a unique <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>. One and only one workflow definition may have a `null`<xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>.  \n  \n Some changes are permitted. The following items may be different between the versions:  \n  \n-   The <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> may have a different Name and Package than the primary version.  \n  \n-   The <xref:System.ServiceModel.Activities.WorkflowService.AllowBufferedReceive%2A> value may be different than the primary version.  \n  \n-   The <xref:System.ServiceModel.Activities.WorkflowService.ConfigurationName%2A> may be different than the primary version.  \n  \n-   The <xref:System.ServiceModel.Activities.WorkflowService.ImplementedContracts%2A> may be different than the primary version.  \n  \n### Configuring the DefinitionIdentity  \n When a workflow service is created using the workflow designer, the <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> is set using the **Properties** window. Click outside of the service’s root activity in the designer to select the workflow service, and choose **Properties Window** from the **View** menu. Select **WorkflowIdentity** from the drop-down list that appears beside the **DefinitionIdentity** property, and then expand and specify the desired <xref:System.Activities.WorkflowIdentity> properties. In the following example the <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> is configured with the <xref:System.Activities.WorkflowIdentity.Name%2A> `MortgageWorkflow` and a <xref:System.Activities.WorkflowIdentity.Version%2A> of `1.0.0.0`. <xref:System.Activities.WorkflowIdentity.Package%2A> is optional and in this example is `null`.  \n  \n ![Screenshot that shows the DefinitionIdentity property.](./media/side-by-side-versioning-in-workflowservicehost/definitionidentity-property.bmp)  \n  \n When a workflow service is self-hosted, the <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> is configured when the workflow service is constructed. In the following example, the <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> is configured with the same values as the previous example, with the <xref:System.Activities.WorkflowIdentity.Name%2A> `MortgageWorkflow` and a <xref:System.Activities.WorkflowIdentity.Name%2A> of `1.0.0.0`.  \n  \n```csharp  \nWorkflowService service = new WorkflowService  \n{  \n    Name = \"MortgageWorkflowService\",  \n    Body = new MortgageWorkflow(),  \n    DefinitionIdentity = new WorkflowIdentity  \n    {  \n        Name = \"MortgageWorkflow\",  \n        Version = new Version(1, 0, 0, 0)  \n    }  \n};  \n```  \n  \n```vb  \nDim service As New WorkflowService  \nWith service  \n    .Name = \"MortgageWorkflowService\"  \n    .Body = New MortgageWorkflow  \n    .DefinitionIdentity = New WorkflowIdentity With _  \n    { _  \n        .Name = \"MortgageWorkflow\", _  \n        .Version = New Version(1, 0, 0, 0) _  \n    }  \nEnd With  \n```  \n  \n A <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> is not required, although only one version of the workflow service may have a **null**<xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>.  \n  \n> [!NOTE]\n>  This is useful if the service was deployed initially without a <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> configured, and then an updated version is created.  \n  \n### Adding a New Version to a Web-hosted Workflow Service  \n The first step in configuring a new version of a workflow service in a web-hosted service is to create a new folder in the `App_Code` folder that has the same name as the service file. If the service’s `xamlx` file is named `MortgageWorkflow.xamlx`, then the folder must be named `MortgageWorkflow`. Place a copy of the original service’s `xamlx` file into this folder and rename it to a new name, such as `MortgageWorkflowV1.xamlx`. Make the desired changes to the primary service, update its <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>, and then deploy the service. In the following example the <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> has been updated with a <xref:System.Activities.WorkflowIdentity.Name%2A> of `MortageWorkflow` and a <xref:System.Activities.WorkflowIdentity.Version%2A> of `2.0.0.0`.  \n  \n ![Screenshot that shows DefinitionIdentity of WorkflowIdentity.](./media/side-by-side-versioning-in-workflowservicehost/definitionidentity-workflowidentity.bmp)  \n  \n When the service restarts, the previous version will automatically be added to the <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> collection because it is located in the designated `App_Code` subfolder. Note that if the primary version of the workflow service has a `null` <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> the previous versions will not be added. One version may have a `null`<xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>, but if there are multiple versions the primary version must not be the one with the `null`<xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> or else the previous versions will not be added to the <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> collection.  \n  \n### Adding a New Version to a Self-hosted Workflow Service  \n When adding a new version to a self-hosted workflow service, the <xref:System.ServiceModel.Activities.WorkflowServiceHost> is configured with the primary version of the workflow service, and previous versions must be explicitly added to the <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> collection. In the following example, a <xref:System.ServiceModel.Activities.WorkflowServiceHost> is configured with a primary workflow service that uses a `MortgageWorkflowV2` workflow definition, and a workflow service configured with a `MortgageWorkflowV1` workflow definition is added to the <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> collection. Each workflow service is configured with a unique <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> that reflects the version of the workflow definition.  \n  \n```csharp  \n// Create the primary version of the workflow service.  \nWorkflowService serviceV2 = new WorkflowService  \n{  \n    Name = \"MortgageWorkflowService\",  \n    Body = new MortgageWorkflowV2(),  \n    DefinitionIdentity = new WorkflowIdentity  \n    {  \n        Name = \"MortgageWorkflow\",  \n        Version = new Version(2, 0, 0, 0)  \n    }  \n};  \n  \n// Configure the WorkflowServiceHost with the current version  \n// of the workflow service. This code requires Administrator  \n// privileges to function correctly. If running from Visual  \n// Studio, Visual Studio must be run with Administrator privileges.  \nWorkflowServiceHost host = new WorkflowServiceHost(serviceV2,   \n    new Uri(\"http://localhost:8080/MortgageWorkflowService\"));  \n  \n// Create the previous version of the workflow service.  \nWorkflowService serviceV1 = new WorkflowService  \n{  \n    Name = \"MortgageWorkflowService\",  \n    Body = new MortgageWorkflowV1(),  \n    DefinitionIdentity = new WorkflowIdentity  \n    {  \n        Name = \"MortgageWorkflow\",  \n        Version = new Version(1, 0, 0, 0)  \n    }  \n};  \n  \n// Add the previous version of the service to the SupportedVersions collection.  \nhost.SupportedVersions.Add(serviceV1);  \n```  \n  \n```vb  \n'Create the primary version of the workflow service  \nDim serviceV2 As New WorkflowService  \nWith serviceV2  \n    .Name = \"MortgageWorkflowService\"  \n    .Body = New MortgageWorkflowV2  \n    .DefinitionIdentity = New WorkflowIdentity With _  \n    { _  \n        .Name = \"MortgageWorkflow\", _  \n        .Version = New Version(2, 0, 0, 0) _  \n    }  \nEnd With  \n  \n'Configure the WorkflowServiceHost with the current version  \n'of the workflow service. This code requires Administrator  \n'privileges to function correctly. If running from Visual  \n'Studio, Visual Studio must be run with Administrator privileges.  \n  \nDim host As New WorkflowServiceHost(serviceV2, _  \n    New Uri(\"http://localhost:8080/MortgageWorkflowService\"))  \n  \n'Create the previous version of the workflow service.  \nDim serviceV1 As New WorkflowService  \nWith serviceV1  \n    .Name = \"MortgageWorkflowService\"  \n    .Body = New MortgageWorkflowV1  \n    .DefinitionIdentity = New WorkflowIdentity With _  \n    { _  \n        .Name = \"MortgageWorkflow\", _  \n        .Version = New Version(1, 0, 0, 0) _  \n    }  \nEnd With  \n  \n'Add the previous version of the service to the SupportedVersions collection.  \nhost.SupportedVersions.Add(serviceV1)  \n```\n","nodes":[{"pos":[4,164],"embed":true,"restype":"x-metadata","content":"title: \"Side by Side Versioning in WorkflowServiceHost\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: 60887eed-df40-4412-b812-41e1dd329d15","nodes":[{"content":"Side by Side Versioning in WorkflowServiceHost","nodes":[{"pos":[0,46],"content":"Side by Side Versioning in WorkflowServiceHost","nodes":[{"content":"Side by Side Versioning in WorkflowServiceHost","pos":[0,46]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[171,217],"content":"Side by Side Versioning in WorkflowServiceHost","linkify":"Side by Side Versioning in WorkflowServiceHost","nodes":[{"content":"Side by Side Versioning in WorkflowServiceHost","pos":[0,46]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost&gt;</ph> side-by-side versioning introduced in <ph id=\"ph2\">[!INCLUDE[net_v45](../../../../includes/net-v45-md.md)]</ph> provides the capability to host multiple versions of a workflow service on a single endpoint.","pos":[218,467],"source":"The <xref:System.ServiceModel.Activities.WorkflowServiceHost> side-by-side versioning introduced in [!INCLUDE[net_v45](../../../../includes/net-v45-md.md)] provides the capability to host multiple versions of a workflow service on a single endpoint."},{"content":"The side-by-side functionality provided allows a workflow service to be configured so that new instances of the workflow service are created using the new workflow definition, while running instances complete using the existing definition.","pos":[468,707]},{"content":"This topic provides an overview of workflow service side-by-side execution using <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost&gt;</ph>.","pos":[708,847],"source":" This topic provides an overview of workflow service side-by-side execution using <xref:System.ServiceModel.Activities.WorkflowServiceHost>."},{"pos":[855,1081],"content":"[!NOTE]\n To download a sample and watch a video walkthrough of workflow service side-by-side versioning, see [Side by Side Versioning with a Web-Hosted Xamlx Workflow Service](https://go.microsoft.com/fwlink/?LinkId=393746).","leadings":["","> "],"nodes":[{"content":"To download a sample and watch a video walkthrough of workflow service side-by-side versioning, see <bpt id=\"p1\">[</bpt>Side by Side Versioning with a Web-Hosted Xamlx Workflow Service<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=393746)</ept>.","pos":[9,224],"source":"To download a sample and watch a video walkthrough of workflow service side-by-side versioning, see [Side by Side Versioning with a Web-Hosted Xamlx Workflow Service](https://go.microsoft.com/fwlink/?LinkId=393746)."}]},{"pos":[1090,1137],"content":"Hosting Multiple Versions in a Workflow Service","linkify":"Hosting Multiple Versions in a Workflow Service","nodes":[{"content":"Hosting Multiple Versions in a Workflow Service","pos":[0,47]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost&gt;</ph> contains two properties that can be configured to allow multiple versions of a workflow to execute side-by-side: <ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph>.","pos":[1141,1471],"source":"<xref:System.ServiceModel.Activities.WorkflowServiceHost> contains two properties that can be configured to allow multiple versions of a workflow to execute side-by-side: <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> and <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A&gt;</ph> contains the supported versions of the workflow service, and <ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph> is used to uniquely identify each workflow service.","pos":[1472,1739],"source":"<xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> contains the supported versions of the workflow service, and <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> is used to uniquely identify each workflow service."},{"content":"This is done by associating a <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowIdentity&gt;</ph> with the workflow service.","pos":[1740,1838],"source":" This is done by associating a <xref:System.Activities.WorkflowIdentity> with the workflow service."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowIdentity&gt;</ph> contains three identifying pieces of information.","pos":[1839,1932],"source":" A <xref:System.Activities.WorkflowIdentity> contains three identifying pieces of information."},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.WorkflowIdentity.Name%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Activities.WorkflowIdentity.Version%2A&gt;</ph> contain a name and a <ph id=\"ph3\">&lt;xref:System.Version&gt;</ph> and are required, and <ph id=\"ph4\">&lt;xref:System.Activities.WorkflowIdentity.Package%2A&gt;</ph> is optional and can be used to specify an additional string containing information such as assembly name or other desired information.","pos":[1933,2292],"source":"<xref:System.Activities.WorkflowIdentity.Name%2A> and <xref:System.Activities.WorkflowIdentity.Version%2A> contain a name and a <xref:System.Version> and are required, and <xref:System.Activities.WorkflowIdentity.Package%2A> is optional and can be used to specify an additional string containing information such as assembly name or other desired information."},{"content":"Each workflow service contained in the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A&gt;</ph> collection must have a unique <ph id=\"ph2\">&lt;xref:System.Activities.WorkflowIdentity&gt;</ph>.","pos":[2293,2483],"source":" Each workflow service contained in the <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> collection must have a unique <xref:System.Activities.WorkflowIdentity>."},{"content":"A <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowIdentity&gt;</ph> is unique if any of its three properties are different from another <ph id=\"ph2\">&lt;xref:System.Activities.WorkflowIdentity&gt;</ph>.","pos":[2484,2638],"source":" A <xref:System.Activities.WorkflowIdentity> is unique if any of its three properties are different from another <xref:System.Activities.WorkflowIdentity>."},{"content":"A <ph id=\"ph1\">`null`</ph> <ph id=\"ph2\">&lt;xref:System.Activities.WorkflowIdentity&gt;</ph> is an allowable value for <ph id=\"ph3\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph>, but only one previous version of a workflow service may have a <ph id=\"ph4\">`null`</ph> <ph id=\"ph5\">&lt;xref:System.Activities.WorkflowIdentity&gt;</ph>.","pos":[2639,2905],"source":" A `null` <xref:System.Activities.WorkflowIdentity> is an allowable value for <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>, but only one previous version of a workflow service may have a `null` <xref:System.Activities.WorkflowIdentity>."},{"pos":[2913,3855],"content":"[!IMPORTANT]\n A <xref:System.Activities.WorkflowIdentity> should not contain any personally identifiable information (PII). <xref:System.Activities.WorkflowIdentity> is composed of three parts: a <xref:System.Activities.WorkflowIdentity.Name%2A> (<xref:System.String>), a <xref:System.Activities.WorkflowIdentity.Version%2A> (<xref:System.Version>), and a <xref:System.Activities.WorkflowIdentity.Package%2A> (<xref:System.String>). Information about the <xref:System.Activities.WorkflowIdentity> used to create an instance is emitted to any configured tracking services at several different points of the activity life-cycle by the runtime. WF Tracking does not have any mechanism to hide PII (sensitive user data). Therefore, a <xref:System.Activities.WorkflowIdentity> instance should not contain any PII data as it will be emitted by the runtime in tracking records and may be visible to anyone with access to view the tracking records.","leadings":["","> "],"nodes":[{"content":"A <xref:System.Activities.WorkflowIdentity> should not contain any personally identifiable information (PII). <xref:System.Activities.WorkflowIdentity> is composed of three parts: a <xref:System.Activities.WorkflowIdentity.Name%2A> (<xref:System.String>), a <xref:System.Activities.WorkflowIdentity.Version%2A> (<xref:System.Version>), and a <xref:System.Activities.WorkflowIdentity.Package%2A> (<xref:System.String>). Information about the <xref:System.Activities.WorkflowIdentity> used to create an instance is emitted to any configured tracking services at several different points of the activity life-cycle by the runtime. WF Tracking does not have any mechanism to hide PII (sensitive user data). Therefore, a <xref:System.Activities.WorkflowIdentity> instance should not contain any PII data as it will be emitted by the runtime in tracking records and may be visible to anyone with access to view the tracking records.","pos":[14,940],"nodes":[{"content":"A <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowIdentity&gt;</ph> should not contain any personally identifiable information (PII).","pos":[0,109],"source":"A <xref:System.Activities.WorkflowIdentity> should not contain any personally identifiable information (PII)."},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.WorkflowIdentity&gt;</ph> is composed of three parts: a <ph id=\"ph2\">&lt;xref:System.Activities.WorkflowIdentity.Name%2A&gt;</ph> (<ph id=\"ph3\">&lt;xref:System.String&gt;</ph>), a <ph id=\"ph4\">&lt;xref:System.Activities.WorkflowIdentity.Version%2A&gt;</ph> (<ph id=\"ph5\">&lt;xref:System.Version&gt;</ph>), and a <ph id=\"ph6\">&lt;xref:System.Activities.WorkflowIdentity.Package%2A&gt;</ph> (<ph id=\"ph7\">&lt;xref:System.String&gt;</ph>).","pos":[110,418],"source":"<xref:System.Activities.WorkflowIdentity> is composed of three parts: a <xref:System.Activities.WorkflowIdentity.Name%2A> (<xref:System.String>), a <xref:System.Activities.WorkflowIdentity.Version%2A> (<xref:System.Version>), and a <xref:System.Activities.WorkflowIdentity.Package%2A> (<xref:System.String>)."},{"content":"Information about the <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowIdentity&gt;</ph> used to create an instance is emitted to any configured tracking services at several different points of the activity life-cycle by the runtime.","pos":[419,627],"source":" Information about the <xref:System.Activities.WorkflowIdentity> used to create an instance is emitted to any configured tracking services at several different points of the activity life-cycle by the runtime."},{"content":"WF Tracking does not have any mechanism to hide PII (sensitive user data).","pos":[628,702]},{"content":"Therefore, a <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowIdentity&gt;</ph> instance should not contain any PII data as it will be emitted by the runtime in tracking records and may be visible to anyone with access to view the tracking records.","pos":[703,926],"source":" Therefore, a <xref:System.Activities.WorkflowIdentity> instance should not contain any PII data as it will be emitted by the runtime in tracking records and may be visible to anyone with access to view the tracking records."}]}]},{"pos":[3865,3922],"content":"Rules for Hosting Multiple Versions of a Workflow Service","linkify":"Rules for Hosting Multiple Versions of a Workflow Service","nodes":[{"content":"Rules for Hosting Multiple Versions of a Workflow Service","pos":[0,57]}]},{"content":"When a user adds an additional version to the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost&gt;</ph>, there are several conditions that must be met in order for a workflow service to be hosted with the same set of endpoints and description.","pos":[3926,4169],"source":"When a user adds an additional version to the <xref:System.ServiceModel.Activities.WorkflowServiceHost>, there are several conditions that must be met in order for a workflow service to be hosted with the same set of endpoints and description."},{"content":"If any of the additional versions fail to meet these conditions, the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost&gt;</ph> throws an exception when <ph id=\"ph2\">`Open`</ph> is called.","pos":[4170,4339],"source":" If any of the additional versions fail to meet these conditions, the <xref:System.ServiceModel.Activities.WorkflowServiceHost> throws an exception when `Open` is called."},{"content":"Each workflow definition provided to the host as an additional version must meet the following requirements (where the primary version is the workflow service definition that is provided to the host constructor).","pos":[4340,4552]},{"content":"The additional workflow version must:","pos":[4553,4590]},{"pos":[4600,4727],"content":"Have the same the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.Name%2A&gt;</ph> as the primary version of the workflow service.","source":"Have the same the <xref:System.ServiceModel.Activities.WorkflowService.Name%2A> as the primary version of the workflow service."},{"pos":[4737,5012],"content":"Must not have any <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.Receive&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.SendReply&gt;</ph> activities in its <ph id=\"ph3\">&lt;xref:System.ServiceModel.Activities.WorkflowService.Body%2A&gt;</ph> that are not in the primary version, and they must match the operation contract.","source":"Must not have any <xref:System.ServiceModel.Activities.Receive> or <xref:System.ServiceModel.Activities.SendReply> activities in its <xref:System.ServiceModel.Activities.WorkflowService.Body%2A> that are not in the primary version, and they must match the operation contract."},{"content":"Have a unique <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph>.","pos":[5022,5112],"source":"Have a unique <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>."},{"content":"One and only one workflow definition may have a <ph id=\"ph1\">`null`</ph><ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph>.","pos":[5113,5243],"source":" One and only one workflow definition may have a `null`<xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>."},{"content":"Some changes are permitted.","pos":[5250,5277]},{"content":"The following items may be different between the versions:","pos":[5278,5336]},{"pos":[5346,5489],"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph> may have a different Name and Package than the primary version.","source":"The <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> may have a different Name and Package than the primary version."},{"pos":[5499,5629],"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.AllowBufferedReceive%2A&gt;</ph> value may be different than the primary version.","source":"The <xref:System.ServiceModel.Activities.WorkflowService.AllowBufferedReceive%2A> value may be different than the primary version."},{"pos":[5639,5760],"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.ConfigurationName%2A&gt;</ph> may be different than the primary version.","source":"The <xref:System.ServiceModel.Activities.WorkflowService.ConfigurationName%2A> may be different than the primary version."},{"pos":[5770,5894],"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.ImplementedContracts%2A&gt;</ph> may be different than the primary version.","source":"The <xref:System.ServiceModel.Activities.WorkflowService.ImplementedContracts%2A> may be different than the primary version."},{"pos":[5904,5938],"content":"Configuring the DefinitionIdentity","linkify":"Configuring the DefinitionIdentity","nodes":[{"content":"Configuring the DefinitionIdentity","pos":[0,34]}]},{"content":"When a workflow service is created using the workflow designer, the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph> is set using the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window.","pos":[5942,6125],"source":"When a workflow service is created using the workflow designer, the <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> is set using the **Properties** window."},{"content":"Click outside of the service’s root activity in the designer to select the workflow service, and choose <bpt id=\"p1\">**</bpt>Properties Window<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>View<ept id=\"p2\">**</ept> menu.","pos":[6126,6275],"source":" Click outside of the service’s root activity in the designer to select the workflow service, and choose **Properties Window** from the **View** menu."},{"content":"Select <bpt id=\"p1\">**</bpt>WorkflowIdentity<ept id=\"p1\">**</ept> from the drop-down list that appears beside the <bpt id=\"p2\">**</bpt>DefinitionIdentity<ept id=\"p2\">**</ept> property, and then expand and specify the desired <ph id=\"ph1\">&lt;xref:System.Activities.WorkflowIdentity&gt;</ph> properties.","pos":[6276,6478],"source":" Select **WorkflowIdentity** from the drop-down list that appears beside the **DefinitionIdentity** property, and then expand and specify the desired <xref:System.Activities.WorkflowIdentity> properties."},{"content":"In the following example the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph> is configured with the <ph id=\"ph2\">&lt;xref:System.Activities.WorkflowIdentity.Name%2A&gt;</ph> <ph id=\"ph3\">`MortgageWorkflow`</ph> and a <ph id=\"ph4\">&lt;xref:System.Activities.WorkflowIdentity.Version%2A&gt;</ph> of <ph id=\"ph5\">`1.0.0.0`</ph>.","pos":[6479,6748],"source":" In the following example the <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> is configured with the <xref:System.Activities.WorkflowIdentity.Name%2A> `MortgageWorkflow` and a <xref:System.Activities.WorkflowIdentity.Version%2A> of `1.0.0.0`."},{"content":"<ph id=\"ph1\">&lt;xref:System.Activities.WorkflowIdentity.Package%2A&gt;</ph> is optional and in this example is <ph id=\"ph2\">`null`</ph>.","pos":[6749,6844],"source":"<xref:System.Activities.WorkflowIdentity.Package%2A> is optional and in this example is `null`."},{"content":"Screenshot that shows the DefinitionIdentity property.","pos":[6853,6907]},{"content":"When a workflow service is self-hosted, the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph> is configured when the workflow service is constructed.","pos":[7003,7178],"source":"When a workflow service is self-hosted, the <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> is configured when the workflow service is constructed."},{"content":"In the following example, the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph> is configured with the same values as the previous example, with the <ph id=\"ph2\">&lt;xref:System.Activities.WorkflowIdentity.Name%2A&gt;</ph> <ph id=\"ph3\">`MortgageWorkflow`</ph> and a <ph id=\"ph4\">&lt;xref:System.Activities.WorkflowIdentity.Name%2A&gt;</ph> of <ph id=\"ph5\">`1.0.0.0`</ph>.","pos":[7179,7492],"source":" In the following example, the <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> is configured with the same values as the previous example, with the <xref:System.Activities.WorkflowIdentity.Name%2A> `MortgageWorkflow` and a <xref:System.Activities.WorkflowIdentity.Name%2A> of `1.0.0.0`."},{"pos":[8115,8355],"content":"A <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph> is not required, although only one version of the workflow service may have a <bpt id=\"p1\">**</bpt>null<ept id=\"p1\">**</ept><ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph>.","source":"A <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> is not required, although only one version of the workflow service may have a **null**<xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>."},{"pos":[8363,8564],"content":"[!NOTE]\n This is useful if the service was deployed initially without a <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> configured, and then an updated version is created.","leadings":["","> "],"nodes":[{"content":"This is useful if the service was deployed initially without a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph> configured, and then an updated version is created.","pos":[9,199],"source":"This is useful if the service was deployed initially without a <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> configured, and then an updated version is created."}]},{"pos":[8574,8627],"content":"Adding a New Version to a Web-hosted Workflow Service","linkify":"Adding a New Version to a Web-hosted Workflow Service","nodes":[{"content":"Adding a New Version to a Web-hosted Workflow Service","pos":[0,53]}]},{"content":"The first step in configuring a new version of a workflow service in a web-hosted service is to create a new folder in the <ph id=\"ph1\">`App_Code`</ph> folder that has the same name as the service file.","pos":[8631,8815],"source":"The first step in configuring a new version of a workflow service in a web-hosted service is to create a new folder in the `App_Code` folder that has the same name as the service file."},{"content":"If the service’s <ph id=\"ph1\">`xamlx`</ph> file is named <ph id=\"ph2\">`MortgageWorkflow.xamlx`</ph>, then the folder must be named <ph id=\"ph3\">`MortgageWorkflow`</ph>.","pos":[8816,8930],"source":" If the service’s `xamlx` file is named `MortgageWorkflow.xamlx`, then the folder must be named `MortgageWorkflow`."},{"content":"Place a copy of the original service’s <ph id=\"ph1\">`xamlx`</ph> file into this folder and rename it to a new name, such as <ph id=\"ph2\">`MortgageWorkflowV1.xamlx`</ph>.","pos":[8931,9064],"source":" Place a copy of the original service’s `xamlx` file into this folder and rename it to a new name, such as `MortgageWorkflowV1.xamlx`."},{"content":"Make the desired changes to the primary service, update its <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph>, and then deploy the service.","pos":[9065,9230],"source":" Make the desired changes to the primary service, update its <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>, and then deploy the service."},{"content":"In the following example the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph> has been updated with a <ph id=\"ph2\">&lt;xref:System.Activities.WorkflowIdentity.Name%2A&gt;</ph> of <ph id=\"ph3\">`MortageWorkflow`</ph> and a <ph id=\"ph4\">&lt;xref:System.Activities.WorkflowIdentity.Version%2A&gt;</ph> of <ph id=\"ph5\">`2.0.0.0`</ph>.","pos":[9231,9503],"source":" In the following example the <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> has been updated with a <xref:System.Activities.WorkflowIdentity.Name%2A> of `MortageWorkflow` and a <xref:System.Activities.WorkflowIdentity.Version%2A> of `2.0.0.0`."},{"content":"Screenshot that shows DefinitionIdentity of WorkflowIdentity.","pos":[9512,9573]},{"content":"When the service restarts, the previous version will automatically be added to the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A&gt;</ph> collection because it is located in the designated <ph id=\"ph2\">`App_Code`</ph> subfolder.","pos":[9677,9911],"source":"When the service restarts, the previous version will automatically be added to the <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> collection because it is located in the designated `App_Code` subfolder."},{"content":"Note that if the primary version of the workflow service has a <ph id=\"ph1\">`null`</ph> <ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph> the previous versions will not be added.","pos":[9912,10098],"source":" Note that if the primary version of the workflow service has a `null` <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> the previous versions will not be added."},{"content":"One version may have a <ph id=\"ph1\">`null`</ph><ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph>, but if there are multiple versions the primary version must not be the one with the <ph id=\"ph3\">`null`</ph><ph id=\"ph4\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph> or else the previous versions will not be added to the <ph id=\"ph5\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A&gt;</ph> collection.","pos":[10099,10516],"source":" One version may have a `null`<xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A>, but if there are multiple versions the primary version must not be the one with the `null`<xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> or else the previous versions will not be added to the <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> collection."},{"pos":[10526,10580],"content":"Adding a New Version to a Self-hosted Workflow Service","linkify":"Adding a New Version to a Self-hosted Workflow Service","nodes":[{"content":"Adding a New Version to a Self-hosted Workflow Service","pos":[0,54]}]},{"content":"When adding a new version to a self-hosted workflow service, the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost&gt;</ph> is configured with the primary version of the workflow service, and previous versions must be explicitly added to the <ph id=\"ph2\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A&gt;</ph> collection.","pos":[10584,10915],"source":"When adding a new version to a self-hosted workflow service, the <xref:System.ServiceModel.Activities.WorkflowServiceHost> is configured with the primary version of the workflow service, and previous versions must be explicitly added to the <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> collection."},{"content":"In the following example, a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost&gt;</ph> is configured with a primary workflow service that uses a <ph id=\"ph2\">`MortgageWorkflowV2`</ph> workflow definition, and a workflow service configured with a <ph id=\"ph3\">`MortgageWorkflowV1`</ph> workflow definition is added to the <ph id=\"ph4\">&lt;xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A&gt;</ph> collection.","pos":[10916,11290],"source":" In the following example, a <xref:System.ServiceModel.Activities.WorkflowServiceHost> is configured with a primary workflow service that uses a `MortgageWorkflowV2` workflow definition, and a workflow service configured with a `MortgageWorkflowV1` workflow definition is added to the <xref:System.ServiceModel.Activities.WorkflowServiceHost.SupportedVersions%2A> collection."},{"content":"Each workflow service is configured with a unique <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A&gt;</ph> that reflects the version of the workflow definition.","pos":[11291,11470],"source":" Each workflow service is configured with a unique <xref:System.ServiceModel.Activities.WorkflowService.DefinitionIdentity%2A> that reflects the version of the workflow definition."}]}