{"content":"---\ntitle: \"Group By Clause (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.QueryGroupByInto\"\n  - \"vb.QueryGroupBy\"\n  - \"vb.QueryGroupRef\"\n  - \"vb.QueryGroupInto\"\n  - \"vb.QueryGroup\"\nhelpviewer_keywords: \n  - \"queries [Visual Basic], Group By\"\n  - \"Group By statement [Visual Basic]\"\n  - \"Group By clause [Visual Basic]\"\nms.assetid: b1b5dcea-6654-473b-a2db-01f7e4c265d7\n---\n# Group By Clause (Visual Basic)\nGroups the elements of a query result. Can also be used to apply aggregate functions to each group. The grouping operation is based on one or more keys.  \n  \n## Syntax  \n  \n```  \nGroup [ listField1 [, listField2 [...] ] By keyExp1 [, keyExp2 [...] ]  \n  Into aggregateList  \n```  \n  \n## Parts  \n  \n-   `listField1`, `listField2`  \n  \n     Optional. One or more fields of the query variable or variables that explicitly identify the fields to be included in the grouped result. If no fields are specified, all fields of the query variable or variables are included in the grouped result.  \n  \n-   `keyExp1`  \n  \n     Required. An expression that identifies the key to use to determine the groups of elements. You can specify more than one key to specify a composite key.  \n  \n-   `keyExp2`  \n  \n     Optional. One or more additional keys that are combined with `keyExp1` to create a composite key.  \n  \n-   `aggregateList`  \n  \n     Required. One or more expressions that identify how the groups are aggregated. To identify a member name for the grouped results, use the `Group` keyword, which can be in either of the following forms:  \n  \n    ```  \n    Into Group  \n    ```  \n  \n     -or-  \n  \n    ```  \n    Into <alias> = Group  \n    ```  \n  \n     You can also include aggregate functions to apply to the group.  \n  \n## Remarks  \n You can use the `Group By` clause to break the results of a query into groups. The grouping is based on a key or a composite key consisting of multiple keys. Elements that are associated with matching key values are included in the same group.  \n  \n You use the `aggregateList` parameter of the `Into` clause and the `Group` keyword to identify the member name that is used to reference the group. You can also include aggregate functions in the `Into` clause to compute values for the grouped elements. For a list of standard aggregate functions, see [Aggregate Clause](../../../visual-basic/language-reference/queries/aggregate-clause.md).  \n  \n## Example  \n The following code example groups a list of customers based on their location (country) and provides a count of the customers in each group. The results are ordered by country name. The grouped results are ordered by city name.  \n  \n [!code-vb[VbSimpleQuerySamples#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbSimpleQuerySamples/VB/QuerySamples1.vb#11)]  \n  \n## See also\n\n- [Introduction to LINQ in Visual Basic](../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)\n- [Queries](../../../visual-basic/language-reference/queries/index.md)\n- [Select Clause](../../../visual-basic/language-reference/queries/select-clause.md)\n- [From Clause](../../../visual-basic/language-reference/queries/from-clause.md)\n- [Order By Clause](../../../visual-basic/language-reference/queries/order-by-clause.md)\n- [Aggregate Clause](../../../visual-basic/language-reference/queries/aggregate-clause.md)\n- [Group Join Clause](../../../visual-basic/language-reference/queries/group-join-clause.md)\n","nodes":[{"pos":[4,379],"embed":true,"restype":"x-metadata","content":"title: \"Group By Clause (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords: \n  - \"vb.QueryGroupByInto\"\n  - \"vb.QueryGroupBy\"\n  - \"vb.QueryGroupRef\"\n  - \"vb.QueryGroupInto\"\n  - \"vb.QueryGroup\"\nhelpviewer_keywords: \n  - \"queries [Visual Basic], Group By\"\n  - \"Group By statement [Visual Basic]\"\n  - \"Group By clause [Visual Basic]\"\nms.assetid: b1b5dcea-6654-473b-a2db-01f7e4c265d7","nodes":[{"content":"Group By Clause (Visual Basic)","nodes":[{"pos":[0,30],"content":"Group By Clause (Visual Basic)","nodes":[{"content":"Group By Clause (Visual Basic)","pos":[0,30]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[386,416],"content":"Group By Clause (Visual Basic)","linkify":"Group By Clause (Visual Basic)","nodes":[{"content":"Group By Clause (Visual Basic)","pos":[0,30]}]},{"content":"Groups the elements of a query result.","pos":[417,455]},{"content":"Can also be used to apply aggregate functions to each group.","pos":[456,516]},{"content":"The grouping operation is based on one or more keys.","pos":[517,569]},{"pos":[578,584],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[704,709],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"pos":[719,745],"content":"<ph id=\"ph1\">`listField1`</ph>, <ph id=\"ph2\">`listField2`</ph>","source":"`listField1`, `listField2`"},{"content":"Optional.","pos":[756,765]},{"content":"One or more fields of the query variable or variables that explicitly identify the fields to be included in the grouped result.","pos":[766,893]},{"content":"If no fields are specified, all fields of the query variable or variables are included in the grouped result.","pos":[894,1003]},{"content":"Required.","pos":[1033,1042]},{"content":"An expression that identifies the key to use to determine the groups of elements.","pos":[1043,1124]},{"content":"You can specify more than one key to specify a composite key.","pos":[1125,1186]},{"content":"Optional.","pos":[1216,1225]},{"content":"One or more additional keys that are combined with <ph id=\"ph1\">`keyExp1`</ph> to create a composite key.","pos":[1226,1313],"source":" One or more additional keys that are combined with `keyExp1` to create a composite key."},{"content":"Required.","pos":[1349,1358]},{"content":"One or more expressions that identify how the groups are aggregated.","pos":[1359,1427]},{"content":"To identify a member name for the grouped results, use the <ph id=\"ph1\">`Group`</ph> keyword, which can be in either of the following forms:","pos":[1428,1550],"source":" To identify a member name for the grouped results, use the `Group` keyword, which can be in either of the following forms:"},{"content":"-or-","pos":[1601,1605]},{"content":"You can also include aggregate functions to apply to the group.","pos":[1666,1729]},{"pos":[1738,1745],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can use the <ph id=\"ph1\">`Group By`</ph> clause to break the results of a query into groups.","pos":[1749,1827],"source":"You can use the `Group By` clause to break the results of a query into groups."},{"content":"The grouping is based on a key or a composite key consisting of multiple keys.","pos":[1828,1906]},{"content":"Elements that are associated with matching key values are included in the same group.","pos":[1907,1992]},{"content":"You use the <ph id=\"ph1\">`aggregateList`</ph> parameter of the <ph id=\"ph2\">`Into`</ph> clause and the <ph id=\"ph3\">`Group`</ph> keyword to identify the member name that is used to reference the group.","pos":[1999,2146],"source":"You use the `aggregateList` parameter of the `Into` clause and the `Group` keyword to identify the member name that is used to reference the group."},{"content":"You can also include aggregate functions in the <ph id=\"ph1\">`Into`</ph> clause to compute values for the grouped elements.","pos":[2147,2252],"source":" You can also include aggregate functions in the `Into` clause to compute values for the grouped elements."},{"content":"For a list of standard aggregate functions, see <bpt id=\"p1\">[</bpt>Aggregate Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/aggregate-clause.md)</ept>.","pos":[2253,2390],"source":" For a list of standard aggregate functions, see [Aggregate Clause](../../../visual-basic/language-reference/queries/aggregate-clause.md)."},{"pos":[2399,2406],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example groups a list of customers based on their location (country) and provides a count of the customers in each group.","pos":[2410,2550]},{"content":"The results are ordered by country name.","pos":[2551,2591]},{"content":"The grouped results are ordered by city name.","pos":[2592,2637]},{"pos":[2785,2793],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2797,2923],"content":"<bpt id=\"p1\">[</bpt>Introduction to LINQ in Visual Basic<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)</ept>","source":"[Introduction to LINQ in Visual Basic](../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)"},{"pos":[2926,2994],"content":"<bpt id=\"p1\">[</bpt>Queries<ept id=\"p1\">](../../../visual-basic/language-reference/queries/index.md)</ept>","source":"[Queries](../../../visual-basic/language-reference/queries/index.md)"},{"pos":[2997,3079],"content":"<bpt id=\"p1\">[</bpt>Select Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/select-clause.md)</ept>","source":"[Select Clause](../../../visual-basic/language-reference/queries/select-clause.md)"},{"pos":[3082,3160],"content":"<bpt id=\"p1\">[</bpt>From Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/from-clause.md)</ept>","source":"[From Clause](../../../visual-basic/language-reference/queries/from-clause.md)"},{"pos":[3163,3249],"content":"<bpt id=\"p1\">[</bpt>Order By Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/order-by-clause.md)</ept>","source":"[Order By Clause](../../../visual-basic/language-reference/queries/order-by-clause.md)"},{"pos":[3252,3340],"content":"<bpt id=\"p1\">[</bpt>Aggregate Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/aggregate-clause.md)</ept>","source":"[Aggregate Clause](../../../visual-basic/language-reference/queries/aggregate-clause.md)"},{"pos":[3343,3433],"content":"<bpt id=\"p1\">[</bpt>Group Join Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/group-join-clause.md)</ept>","source":"[Group Join Clause](../../../visual-basic/language-reference/queries/group-join-clause.md)"}]}