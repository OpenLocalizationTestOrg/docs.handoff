{"content":"---\ntitle: \"Deferred Execution and Lazy Evaluation in LINQ to XML (C#) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"CSharp\"\nms.assetid: 8683d1b4-b7ec-407b-be12-906ebe958a09\ncaps.latest.revision: 3\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n\n---\n# Deferred Execution and Lazy Evaluation in LINQ to XML (C#)\nQuery and axis operations are often implemented to use deferred execution. This topic explains the requirements and advantages of deferred execution, and some implementation considerations.  \n  \n## Deferred Execution  \n Deferred execution means that the evaluation of an expression is delayed until its *realized* value is actually required. Deferred execution can greatly improve performance when you have to manipulate large data collections, especially in programs that contain a series of chained queries or manipulations. In the best case, deferred execution enables only a single iteration through the source collection.  \n  \n The LINQ technologies make extensive use of deferred execution in both the members of core <xref:System.Linq?displayProperty=fullName> classes and in the extension methods in the various LINQ namespaces, such as <xref:System.Xml.Linq.Extensions?displayProperty=fullName>.  \n  \n Deferred execution is supported directly in the C# language by the [yield](../../../../csharp/language-reference/keywords/yield.md) keyword (in the form of the `yield-return` statement) when used within an iterator block. Such an iterator must return a collection of type <xref:System.Collections.IEnumerator> or <xref:System.Collections.Generic.IEnumerator%601> (or a derived type).  \n  \n## Eager vs. Lazy Evaluation  \n When you write a method that implements deferred execution, you also have to decide whether to implement the method using lazy evaluation or eager evaluation.  \n  \n-   In *lazy evaluation*, a single element of the source collection is processed during each call to the iterator. This is the typical way in which iterators are implemented.  \n  \n-   In *eager evaluation*, the first call to the iterator will result in the entire collection being processed. A temporary copy of the source collection might also be required. For example, the <xref:System.Linq.Enumerable.OrderBy%2A> method has to sort the entire collection before it returns the first element.  \n  \n Lazy evaluation usually yields better performance because it distributes overhead processing evenly throughout the evaluation of the collection and minimizes the use of temporary data. Of course, for some operations, there is no other option than to materialize intermediate results.  \n  \n## Next Steps  \n The next topic in this tutorial illustrates deferred execution:  \n  \n-   [Deferred Execution Example (C#)](../../../../csharp/programming-guide/concepts/linq/deferred-execution-example.md)  \n  \n## See Also  \n [Tutorial: Chaining Queries Together (C#)](../../../../csharp/programming-guide/concepts/linq/tutorial-chaining-queries-together.md)   \n [Concepts and Terminology (Functional Transformation) (C#)](../../../../csharp/programming-guide/concepts/linq/concepts-and-terminology-functional-transformation.md)   \n [Aggregation Operations (C#)](../../../../csharp/programming-guide/concepts/linq/aggregation-operations.md)   \n [yield](../../../../csharp/language-reference/keywords/yield.md)","nodes":[{"pos":[4,365],"nodes":[{"content":"Deferred Execution and Lazy Evaluation in LINQ to XML (C#) | Microsoft Docs","nodes":[{"pos":[0,75],"content":"Deferred Execution and Lazy Evaluation in LINQ to XML (C#) | Microsoft Docs","nodes":[{"content":"Deferred Execution and Lazy Evaluation in LINQ to XML (C#) | Microsoft Docs","pos":[0,75]}]}],"pos":[6,84],"yaml":true}],"content":"title: \"Deferred Execution and Lazy Evaluation in LINQ to XML (C#) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-csharp\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"CSharp\"\nms.assetid: 8683d1b4-b7ec-407b-be12-906ebe958a09\ncaps.latest.revision: 3\nauthor: \"BillWagner\"\nms.author: \"wiwagn\"\n","yamlblock":true},{"pos":[372,430],"content":"Deferred Execution and Lazy Evaluation in LINQ to XML (C#)","linkify":"Deferred Execution and Lazy Evaluation in LINQ to XML (C#)","nodes":[{"content":"Deferred Execution and Lazy Evaluation in LINQ to XML (C#)","pos":[0,58]}]},{"content":"Query and axis operations are often implemented to use deferred execution.","pos":[431,505]},{"content":"This topic explains the requirements and advantages of deferred execution, and some implementation considerations.","pos":[506,620]},{"pos":[629,647],"content":"Deferred Execution","linkify":"Deferred Execution","nodes":[{"content":"Deferred Execution","pos":[0,18]}]},{"content":"Deferred execution means that the evaluation of an expression is delayed until its <bpt id=\"p1\">*</bpt>realized<ept id=\"p1\">*</ept> value is actually required.","pos":[651,772],"source":"Deferred execution means that the evaluation of an expression is delayed until its *realized* value is actually required."},{"content":"Deferred execution can greatly improve performance when you have to manipulate large data collections, especially in programs that contain a series of chained queries or manipulations.","pos":[773,957]},{"content":"In the best case, deferred execution enables only a single iteration through the source collection.","pos":[958,1057]},{"content":"The LINQ technologies make extensive use of deferred execution in both the members of core <ph id=\"ph1\">&lt;xref:System.Linq?displayProperty=fullName&gt;</ph> classes and in the extension methods in the various LINQ namespaces, such as <ph id=\"ph2\">&lt;xref:System.Xml.Linq.Extensions?displayProperty=fullName&gt;</ph>.","pos":[1064,1335],"source":"The LINQ technologies make extensive use of deferred execution in both the members of core <xref:System.Linq?displayProperty=fullName> classes and in the extension methods in the various LINQ namespaces, such as <xref:System.Xml.Linq.Extensions?displayProperty=fullName>."},{"content":"Deferred execution is supported directly in the C# language by the <bpt id=\"p1\">[</bpt>yield<ept id=\"p1\">](../../../../csharp/language-reference/keywords/yield.md)</ept> keyword (in the form of the <ph id=\"ph1\">`yield-return`</ph> statement) when used within an iterator block.","pos":[1342,1563],"source":"Deferred execution is supported directly in the C# language by the [yield](../../../../csharp/language-reference/keywords/yield.md) keyword (in the form of the `yield-return` statement) when used within an iterator block."},{"content":"Such an iterator must return a collection of type <ph id=\"ph1\">&lt;xref:System.Collections.IEnumerator&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Collections.Generic.IEnumerator%601&gt;</ph> (or a derived type).","pos":[1564,1725],"source":" Such an iterator must return a collection of type <xref:System.Collections.IEnumerator> or <xref:System.Collections.Generic.IEnumerator%601> (or a derived type)."},{"pos":[1734,1759],"content":"Eager vs. Lazy Evaluation","linkify":"Eager vs. Lazy Evaluation","nodes":[{"content":"Eager vs. Lazy Evaluation","pos":[0,25]}]},{"content":"When you write a method that implements deferred execution, you also have to decide whether to implement the method using lazy evaluation or eager evaluation.","pos":[1763,1921]},{"content":"In <bpt id=\"p1\">*</bpt>lazy evaluation<ept id=\"p1\">*</ept>, a single element of the source collection is processed during each call to the iterator.","pos":[1931,2041],"source":"In *lazy evaluation*, a single element of the source collection is processed during each call to the iterator."},{"content":"This is the typical way in which iterators are implemented.","pos":[2042,2101]},{"content":"In <bpt id=\"p1\">*</bpt>eager evaluation<ept id=\"p1\">*</ept>, the first call to the iterator will result in the entire collection being processed.","pos":[2111,2218],"source":"In *eager evaluation*, the first call to the iterator will result in the entire collection being processed."},{"content":"A temporary copy of the source collection might also be required.","pos":[2219,2284]},{"content":"For example, the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.OrderBy%2A&gt;</ph> method has to sort the entire collection before it returns the first element.","pos":[2285,2420],"source":" For example, the <xref:System.Linq.Enumerable.OrderBy%2A> method has to sort the entire collection before it returns the first element."},{"content":"Lazy evaluation usually yields better performance because it distributes overhead processing evenly throughout the evaluation of the collection and minimizes the use of temporary data.","pos":[2427,2611]},{"content":"Of course, for some operations, there is no other option than to materialize intermediate results.","pos":[2612,2710]},{"pos":[2719,2729],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"The next topic in this tutorial illustrates deferred execution:","pos":[2733,2796]},{"pos":[2806,2921],"content":"<bpt id=\"p1\">[</bpt>Deferred Execution Example (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/deferred-execution-example.md)</ept>","source":"[Deferred Execution Example (C#)](../../../../csharp/programming-guide/concepts/linq/deferred-execution-example.md)"},{"pos":[2930,2938],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Tutorial: Chaining Queries Together (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/tutorial-chaining-queries-together.md)</ept><ph id=\"ph1\"> </ph>","pos":[2942,3075],"source":"[Tutorial: Chaining Queries Together (C#)](../../../../csharp/programming-guide/concepts/linq/tutorial-chaining-queries-together.md) "},{"content":"<bpt id=\"p1\">[</bpt>Concepts and Terminology (Functional Transformation) (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/concepts-and-terminology-functional-transformation.md)</ept><ph id=\"ph1\"> </ph>","pos":[3079,3245],"source":"[Concepts and Terminology (Functional Transformation) (C#)](../../../../csharp/programming-guide/concepts/linq/concepts-and-terminology-functional-transformation.md) "},{"content":"<bpt id=\"p1\">[</bpt>Aggregation Operations (C#)<ept id=\"p1\">](../../../../csharp/programming-guide/concepts/linq/aggregation-operations.md)</ept><ph id=\"ph1\"> </ph>","pos":[3249,3357],"source":"[Aggregation Operations (C#)](../../../../csharp/programming-guide/concepts/linq/aggregation-operations.md) "},{"content":"<bpt id=\"p1\">[</bpt>yield<ept id=\"p1\">](../../../../csharp/language-reference/keywords/yield.md)</ept>","pos":[3361,3425],"source":"[yield](../../../../csharp/language-reference/keywords/yield.md)"}]}