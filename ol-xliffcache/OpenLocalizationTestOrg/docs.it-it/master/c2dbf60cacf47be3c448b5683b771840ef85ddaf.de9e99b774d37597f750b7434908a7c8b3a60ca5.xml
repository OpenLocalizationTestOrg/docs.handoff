{"content":"---\ntitle: \"Mitigation: Culture and Asynchronous Operations | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-bcl\"\n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: d2cdb578-9923-47df-9ffd-5865333ac1a4\ncaps.latest.revision: 4\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# Mitigation: Culture and Asynchronous Operations\nFor apps that target the [!INCLUDE[net_v46](../../../includes/net-v46-md.md)] and later versions, <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> are stored in a thread's <xref:System.Threading.ExecutionContext>, which flows across asynchronous operations.  \n  \n## Impact  \n As a result of this change, changes to the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> or <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> are reflected in tasks which are later run asynchronously. This differs from the behavior of previous .NET Framework versions, which would reset <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> to the system default  in all asynchronous tasks.  \n  \n## Mitigation  \n Apps affected by this change can work around it in either of two ways:  \n  \n-   By explicitly setting the desired <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> or <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> property as the first operation in an asynchronous task.  \n  \n-   By opting into the old behavior of not flowing <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> by adding the following `AppContextSwitchOverrides` element to the application's configuration file:  \n  \n    ```xml  \n  \n    <configuration>  \n        <runtime>  \n            <AppContextSwitchOverrides value=\"Switch.System.Globalization.NoAsyncCurrentCulture=true\" />  \n        </runtime>  \n    </configuration>  \n  \n    ```  \n  \n-   By opting into the old behavior of not flowing <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> by setting the following compatibility switch programatically:  \n  \n    ```csharp  \n    AppContext.SetSwitch(\"Switch.System.Globalization.NoAsyncCurrentCulture\", true);  \n    ```  \n  \n    ```vb  \n    AppContext.SetSwitch(\"Switch.System.Globalization.NoAsyncCurrentCulture\", true)  \n    ```  \n  \n## See Also  \n [Retargeting Changes](../../../docs/framework/migration-guide/retargeting-changes-in-the-net-framework-4-6.md)","nodes":[{"pos":[12,76],"content":"Mitigation: Culture and Asynchronous Operations | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Mitigation: Culture and Asynchronous Operations | Microsoft Docs","pos":[0,64]}]},{"pos":[396,443],"content":"Mitigation: Culture and Asynchronous Operations","linkify":"Mitigation: Culture and Asynchronous Operations","nodes":[{"content":"Mitigation: Culture and Asynchronous Operations","pos":[0,47]}]},{"pos":[444,824],"content":"For apps that target the <ph id=\"ph1\">[!INCLUDE[net_v46](../../../includes/net-v46-md.md)]</ph> and later versions, <ph id=\"ph2\">&lt;xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName&gt;</ph> are stored in a thread's <ph id=\"ph4\">&lt;xref:System.Threading.ExecutionContext&gt;</ph>, which flows across asynchronous operations.","source":"For apps that target the [!INCLUDE[net_v46](../../../includes/net-v46-md.md)] and later versions, <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> are stored in a thread's <xref:System.Threading.ExecutionContext>, which flows across asynchronous operations."},{"pos":[833,839],"content":"Impact","linkify":"Impact","nodes":[{"content":"Impact","pos":[0,6]}]},{"content":"As a result of this change, changes to the <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName&gt;</ph> are reflected in tasks which are later run asynchronously.","pos":[843,1115],"source":"As a result of this change, changes to the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> or <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> are reflected in tasks which are later run asynchronously."},{"content":"This differs from the behavior of previous .NET Framework versions, which would reset <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName&gt;</ph> to the system default  in all asynchronous tasks.","pos":[1116,1423],"source":" This differs from the behavior of previous .NET Framework versions, which would reset <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> to the system default  in all asynchronous tasks."},{"pos":[1432,1442],"content":"Mitigation","linkify":"Mitigation","nodes":[{"content":"Mitigation","pos":[0,10]}]},{"content":"Apps affected by this change can work around it in either of two ways:","pos":[1446,1516]},{"content":"By explicitly setting the desired <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName&gt;</ph> property as the first operation in an asynchronous task.","pos":[1526,1787],"source":"By explicitly setting the desired <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> or <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> property as the first operation in an asynchronous task."},{"pos":[1797,2116],"content":"By opting into the old behavior of not flowing <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName&gt;</ph> by adding the following <ph id=\"ph3\">`AppContextSwitchOverrides`</ph> element to the application's configuration file:","source":"By opting into the old behavior of not flowing <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> by adding the following `AppContextSwitchOverrides` element to the application's configuration file:"},{"content":"By opting into the old behavior of not flowing <ph id=\"ph1\">&lt;xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName&gt;</ph> by setting the following compatibility switch programatically:","pos":[2351,2632],"source":"By opting into the old behavior of not flowing <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=fullName> by setting the following compatibility switch programatically:"},{"pos":[2868,2876],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2880,2990],"content":"<bpt id=\"p1\">[</bpt>Retargeting Changes<ept id=\"p1\">](../../../docs/framework/migration-guide/retargeting-changes-in-the-net-framework-4-6.md)</ept>","source":"[Retargeting Changes](../../../docs/framework/migration-guide/retargeting-changes-in-the-net-framework-4-6.md)"}]}