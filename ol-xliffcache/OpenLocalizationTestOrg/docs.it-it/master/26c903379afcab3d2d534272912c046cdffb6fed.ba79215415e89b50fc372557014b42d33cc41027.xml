{"content":"---\ntitle: \"How to: Create Windows Services\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"Windows Service applications, creating\"\n  - \"templates, Windows Service\"\nms.assetid: 0f5e2cbb-d95d-477c-b2b5-4b990e6b86ff\nauthor: \"ghogen\"\n---\n# How to: Create Windows Services\nWhen you create a service, you can use a Visual Studio project template called **Windows Service**. This template automatically does much of the work for you by referencing the appropriate classes and namespaces, setting up the inheritance from the base class for services, and overriding several of the methods you're likely to want to override.  \n  \n> [!WARNING]\n>  The Windows Services project template is not available in the Express edition of Visual Studio.  \n  \n At a minimum, to create a functional service you must:  \n  \n-   Set the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property.  \n  \n-   Create the necessary installers for your service application.  \n  \n-   Override and specify code for the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> methods to customize the ways in which your service behaves.  \n  \n### To create a Windows Service application  \n  \n1.  Create a **Windows Service** project.  \n  \n    > [!NOTE]\n    >  For instructions on writing a service without using the template, see [How to: Write Services Programmatically](../../../docs/framework/windows-services/how-to-write-services-programmatically.md).  \n  \n2.  In the **Properties** window, set the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property for your service.  \n  \n     ![Set the ServiceName property.](../../../docs/framework/windows-services/media/windowsservice-servicename.PNG \"WindowsService_ServiceName\")  \n  \n    > [!NOTE]\n    >  The value of the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property must always match the name recorded in the installer classes. If you change this property, you must update the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property of installer classes as well.  \n  \n3.  Set any of the following properties to determine how your service will function.  \n  \n    |Property|Setting|  \n    |--------------|-------------|  \n    |<xref:System.ServiceProcess.ServiceBase.CanStop%2A>|`True` to indicate that the service will accept requests to stop running; `false` to prevent the service from being stopped.|  \n    |<xref:System.ServiceProcess.ServiceBase.CanShutdown%2A>|`True` to indicate that the service wants to receive notification when the computer on which it lives shuts down, enabling it to call the <xref:System.ServiceProcess.ServiceBase.OnShutdown%2A> procedure.|  \n    |<xref:System.ServiceProcess.ServiceBase.CanPauseAndContinue%2A>|`True` to indicate that the service will accept requests to pause or to resume running; `false` to prevent the service from being paused and resumed.|  \n    |<xref:System.ServiceProcess.ServiceBase.CanHandlePowerEvent%2A>|`True` to indicate that the service can handle notification of changes to the computer's power status; `false` to prevent the service from being notified of these changes.|  \n    |<xref:System.ServiceProcess.ServiceBase.AutoLog%2A>|`True` to write informational entries to the Application event log when your service performs an action; `false` to disable this functionality. For more information, see [How to: Log Information About Services](../../../docs/framework/windows-services/how-to-log-information-about-services.md). **Note:**  By default, <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> is set to `true`.|  \n  \n    > [!NOTE]\n    >  When <xref:System.ServiceProcess.ServiceBase.CanStop%2A> or <xref:System.ServiceProcess.ServiceBase.CanPauseAndContinue%2A> are set to `false`, the **Service Control Manager** will disable the corresponding menu options to stop, pause, or continue the service.  \n  \n4.  Access the Code Editor and fill in the processing you want for the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> procedures.  \n  \n5.  Override any other methods for which you want to define functionality.  \n  \n6.  Add the necessary installers for your service application. For more information, see [How to: Add Installers to Your Service Application](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md).  \n  \n7.  Build your project by selecting **Build Solution** from the **Build** menu.  \n  \n    > [!NOTE]\n    >  Do not press F5 to run your project â€” you cannot run a service project in this way.  \n  \n8.  Install the service. For more information, see [How to: Install and Uninstall Services](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md).  \n  \n## See also\n\n- [Introduction to Windows Service Applications](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)\n- [How to: Write Services Programmatically](../../../docs/framework/windows-services/how-to-write-services-programmatically.md)\n- [How to: Add Installers to Your Service Application](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)\n- [How to: Log Information About Services](../../../docs/framework/windows-services/how-to-log-information-about-services.md)\n- [How to: Start Services](../../../docs/framework/windows-services/how-to-start-services.md)\n- [How to: Specify the Security Context for Services](../../../docs/framework/windows-services/how-to-specify-the-security-context-for-services.md)\n- [How to: Install and Uninstall Services](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md)\n- [Walkthrough: Creating a Windows Service Application in the Component Designer](../../../docs/framework/windows-services/walkthrough-creating-a-windows-service-application-in-the-component-designer.md)\n","nodes":[{"pos":[4,232],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create Windows Services\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"Windows Service applications, creating\"\n  - \"templates, Windows Service\"\nms.assetid: 0f5e2cbb-d95d-477c-b2b5-4b990e6b86ff\nauthor: \"ghogen\"","nodes":[{"content":"How to: Create Windows Services","nodes":[{"pos":[0,31],"content":"How to: Create Windows Services","nodes":[{"content":"How to: Create Windows Services","pos":[0,31]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[239,270],"content":"How to: Create Windows Services","linkify":"How to: Create Windows Services","nodes":[{"content":"How to: Create Windows Services","pos":[0,31]}]},{"content":"When you create a service, you can use a Visual Studio project template called <bpt id=\"p1\">**</bpt>Windows Service<ept id=\"p1\">**</ept>.","pos":[271,370],"source":"When you create a service, you can use a Visual Studio project template called **Windows Service**."},{"content":"This template automatically does much of the work for you by referencing the appropriate classes and namespaces, setting up the inheritance from the base class for services, and overriding several of the methods you're likely to want to override.","pos":[371,617]},{"pos":[625,734],"content":"[!WARNING]\n The Windows Services project template is not available in the Express edition of Visual Studio.","leadings":["","> "],"nodes":[{"content":"The Windows Services project template is not available in the Express edition of Visual Studio.","pos":[12,107]}]},{"content":"At a minimum, to create a functional service you must:","pos":[741,795]},{"pos":[805,878],"content":"Set the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.ServiceName%2A&gt;</ph> property.","source":"Set the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property."},{"content":"Create the necessary installers for your service application.","pos":[888,949]},{"pos":[959,1160],"content":"Override and specify code for the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase.OnStop%2A&gt;</ph> methods to customize the ways in which your service behaves.","source":"Override and specify code for the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> methods to customize the ways in which your service behaves."},{"pos":[1170,1209],"content":"To create a Windows Service application","linkify":"To create a Windows Service application","nodes":[{"content":"To create a Windows Service application","pos":[0,39]}]},{"pos":[1219,1256],"content":"Create a <bpt id=\"p1\">**</bpt>Windows Service<ept id=\"p1\">**</ept> project.","source":"Create a **Windows Service** project."},{"pos":[1268,1479],"content":"[!NOTE]\nFor instructions on writing a service without using the template, see [How to: Write Services Programmatically](../../../docs/framework/windows-services/how-to-write-services-programmatically.md).","leadings":["","    >  "],"nodes":[{"content":"For instructions on writing a service without using the template, see <bpt id=\"p1\">[</bpt>How to: Write Services Programmatically<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-write-services-programmatically.md)</ept>.","pos":[8,204],"source":"For instructions on writing a service without using the template, see [How to: Write Services Programmatically](../../../docs/framework/windows-services/how-to-write-services-programmatically.md)."}]},{"pos":[1489,1609],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.ServiceName%2A&gt;</ph> property for your service.","source":"In the **Properties** window, set the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property for your service."},{"pos":[1620,1760],"content":"<bpt id=\"p1\">![</bpt>Set the ServiceName property.<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../docs/framework/windows-services/media/windowsservice-servicename.PNG \"</bpt>WindowsService_ServiceName<ept id=\"p2\">\")</ept>","source":"![Set the ServiceName property.](../../../docs/framework/windows-services/media/windowsservice-servicename.PNG \"WindowsService_ServiceName\")"},{"pos":[1772,2074],"content":"[!NOTE]\nThe value of the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property must always match the name recorded in the installer classes. If you change this property, you must update the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property of installer classes as well.","leadings":["","    >  "],"nodes":[{"content":"The value of the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property must always match the name recorded in the installer classes. If you change this property, you must update the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property of installer classes as well.","pos":[8,295],"nodes":[{"content":"The value of the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.ServiceName%2A&gt;</ph> property must always match the name recorded in the installer classes.","pos":[0,143],"source":"The value of the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property must always match the name recorded in the installer classes."},{"content":"If you change this property, you must update the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.ServiceName%2A&gt;</ph> property of installer classes as well.","pos":[144,287],"source":" If you change this property, you must update the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A> property of installer classes as well."}]}]},{"content":"Set any of the following properties to determine how your service will function.","pos":[2084,2164]},{"content":"Property","pos":[2175,2183]},{"content":"Setting","pos":[2184,2191]},{"pos":[2289,2413],"content":"<ph id=\"ph1\">`True`</ph> to indicate that the service will accept requests to stop running; <ph id=\"ph2\">`false`</ph> to prevent the service from being stopped.","source":"`True` to indicate that the service will accept requests to stop running; `false` to prevent the service from being stopped."},{"pos":[2478,2681],"content":"<ph id=\"ph1\">`True`</ph> to indicate that the service wants to receive notification when the computer on which it lives shuts down, enabling it to call the <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase.OnShutdown%2A&gt;</ph> procedure.","source":"`True` to indicate that the service wants to receive notification when the computer on which it lives shuts down, enabling it to call the <xref:System.ServiceProcess.ServiceBase.OnShutdown%2A> procedure."},{"pos":[2754,2903],"content":"<ph id=\"ph1\">`True`</ph> to indicate that the service will accept requests to pause or to resume running; <ph id=\"ph2\">`false`</ph> to prevent the service from being paused and resumed.","source":"`True` to indicate that the service will accept requests to pause or to resume running; `false` to prevent the service from being paused and resumed."},{"pos":[2976,3147],"content":"<ph id=\"ph1\">`True`</ph> to indicate that the service can handle notification of changes to the computer's power status; <ph id=\"ph2\">`false`</ph> to prevent the service from being notified of these changes.","source":"`True` to indicate that the service can handle notification of changes to the computer's power status; `false` to prevent the service from being notified of these changes."},{"content":"<ph id=\"ph1\">`True`</ph> to write informational entries to the Application event log when your service performs an action; <ph id=\"ph2\">`false`</ph> to disable this functionality.","pos":[3208,3351],"source":"`True` to write informational entries to the Application event log when your service performs an action; `false` to disable this functionality."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Log Information About Services<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-log-information-about-services.md)</ept>.","pos":[3352,3502],"source":" For more information, see [How to: Log Information About Services](../../../docs/framework/windows-services/how-to-log-information-about-services.md)."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  By default, <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.AutoLog%2A&gt;</ph> is set to <ph id=\"ph2\">`true`</ph>.","pos":[3503,3595],"source":"**Note:**  By default, <xref:System.ServiceProcess.ServiceBase.AutoLog%2A> is set to `true`."},{"pos":[3608,3883],"content":"[!NOTE]\nWhen <xref:System.ServiceProcess.ServiceBase.CanStop%2A> or <xref:System.ServiceProcess.ServiceBase.CanPauseAndContinue%2A> are set to `false`, the **Service Control Manager** will disable the corresponding menu options to stop, pause, or continue the service.","leadings":["","    >  "],"nodes":[{"content":"When <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.CanStop%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase.CanPauseAndContinue%2A&gt;</ph> are set to <ph id=\"ph3\">`false`</ph>, the <bpt id=\"p1\">**</bpt>Service Control Manager<ept id=\"p1\">**</ept> will disable the corresponding menu options to stop, pause, or continue the service.","pos":[8,268],"source":"When <xref:System.ServiceProcess.ServiceBase.CanStop%2A> or <xref:System.ServiceProcess.ServiceBase.CanPauseAndContinue%2A> are set to `false`, the **Service Control Manager** will disable the corresponding menu options to stop, pause, or continue the service."}]},{"pos":[3893,4078],"content":"Access the Code Editor and fill in the processing you want for the <ph id=\"ph1\">&lt;xref:System.ServiceProcess.ServiceBase.OnStart%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ServiceProcess.ServiceBase.OnStop%2A&gt;</ph> procedures.","source":"Access the Code Editor and fill in the processing you want for the <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> procedures."},{"content":"Override any other methods for which you want to define functionality.","pos":[4088,4158]},{"content":"Add the necessary installers for your service application.","pos":[4168,4226]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Add Installers to Your Service Application<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)</ept>.","pos":[4227,4401],"source":" For more information, see [How to: Add Installers to Your Service Application](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)."},{"pos":[4411,4486],"content":"Build your project by selecting <bpt id=\"p1\">**</bpt>Build Solution<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Build<ept id=\"p2\">**</ept> menu.","source":"Build your project by selecting **Build Solution** from the **Build** menu."},{"pos":[4498,4596],"content":"[!NOTE]\nDo not press F5 to run your project â€” you cannot run a service project in this way.","leadings":["","    >  "],"nodes":[{"content":"Do not press F5 to run your project â€” you cannot run a service project in this way.","pos":[8,91]}]},{"content":"Install the service.","pos":[4606,4626]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Install and Uninstall Services<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md)</ept>.","pos":[4627,4777],"source":" For more information, see [How to: Install and Uninstall Services](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md)."},{"pos":[4786,4794],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4798,4934],"content":"<bpt id=\"p1\">[</bpt>Introduction to Windows Service Applications<ept id=\"p1\">](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)</ept>","source":"[Introduction to Windows Service Applications](../../../docs/framework/windows-services/introduction-to-windows-service-applications.md)"},{"pos":[4937,5062],"content":"<bpt id=\"p1\">[</bpt>How to: Write Services Programmatically<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-write-services-programmatically.md)</ept>","source":"[How to: Write Services Programmatically](../../../docs/framework/windows-services/how-to-write-services-programmatically.md)"},{"pos":[5065,5212],"content":"<bpt id=\"p1\">[</bpt>How to: Add Installers to Your Service Application<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)</ept>","source":"[How to: Add Installers to Your Service Application](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)"},{"pos":[5215,5338],"content":"<bpt id=\"p1\">[</bpt>How to: Log Information About Services<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-log-information-about-services.md)</ept>","source":"[How to: Log Information About Services](../../../docs/framework/windows-services/how-to-log-information-about-services.md)"},{"pos":[5341,5432],"content":"<bpt id=\"p1\">[</bpt>How to: Start Services<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-start-services.md)</ept>","source":"[How to: Start Services](../../../docs/framework/windows-services/how-to-start-services.md)"},{"pos":[5435,5580],"content":"<bpt id=\"p1\">[</bpt>How to: Specify the Security Context for Services<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-specify-the-security-context-for-services.md)</ept>","source":"[How to: Specify the Security Context for Services](../../../docs/framework/windows-services/how-to-specify-the-security-context-for-services.md)"},{"pos":[5583,5706],"content":"<bpt id=\"p1\">[</bpt>How to: Install and Uninstall Services<ept id=\"p1\">](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md)</ept>","source":"[How to: Install and Uninstall Services](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md)"},{"pos":[5709,5910],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Creating a Windows Service Application in the Component Designer<ept id=\"p1\">](../../../docs/framework/windows-services/walkthrough-creating-a-windows-service-application-in-the-component-designer.md)</ept>","source":"[Walkthrough: Creating a Windows Service Application in the Component Designer](../../../docs/framework/windows-services/walkthrough-creating-a-windows-service-application-in-the-component-designer.md)"}]}