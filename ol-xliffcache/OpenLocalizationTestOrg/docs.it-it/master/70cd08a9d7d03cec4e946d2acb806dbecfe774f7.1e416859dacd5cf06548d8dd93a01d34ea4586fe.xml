{"content":"---\ntitle: \"Walkthrough: Creating a Windows Forms Control That Takes Advantage of Visual Studio Design-Time Features\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"Windows Forms controls, creating\"\n  - \"design-time functionality [Windows Forms], Windows Forms\"\n  - \"DocumentDesigner class [Windows Forms]\"\n  - \"walkthroughs [Windows Forms], controls\"\nms.assetid: 6f487c59-cb38-4afa-ad2e-95edacb1d626\n---\n\n# Walkthrough: Creating a Windows Forms Control That Takes Advantage of Visual Studio Design-Time Features\n\nThe design-time experience for a custom control can be enhanced by authoring an associated custom designer.\n\nThis walkthrough illustrates how to create a custom designer for a custom control. You will implement a `MarqueeControl` type and an associated designer class, called `MarqueeControlRootDesigner`.\n\nThe `MarqueeControl` type implements a display similar to a theater marquee, with animated lights and flashing text.\n\nThe designer for this control interacts with the design environment to provide a custom design-time experience. With the custom designer, you can assemble a custom `MarqueeControl` implementation with animated lights and flashing text in many combinations. You can use the assembled control on a form like any other Windows Forms control.\n\nTasks illustrated in this walkthrough include:\n\n- Creating the Project\n\n- Creating a Control Library Project\n\n- Referencing the Custom Control Project\n\n- Defining a Custom Control and Its Custom Designer\n\n- Creating an Instance of Your Custom Control\n\n- Setting Up the Project for Design-Time Debugging\n\n- Implementing Your Custom Control\n\n- Creating a Child Control for Your Custom Control\n\n- Create the MarqueeBorder Child Control\n\n- Creating a Custom Designer to Shadow and Filter Properties\n\n- Handling Component Changes\n\n- Adding Designer Verbs to your Custom Designer\n\n- Creating a Custom UITypeEditor\n\n- Testing your Custom Control in the Designer\n\nWhen you are finished, your custom control will look something like the following:\n\n![A possible MarqueeControl arrangement](./media/demomarqueecontrol.gif \"DemoMarqueeControl\")\n\nFor the complete code listing, see [How to: Create a Windows Forms Control That Takes Advantage of Design-Time Features](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/307hck25(v=vs.120)).\n\n> [!NOTE]\n> The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).\n\n## Prerequisites\n\nIn order to complete this walkthrough, you will need:\n\n- Sufficient permissions to be able to create and run Windows Forms application projects on the computer where Visual Studio is installed.\n\n## Creating the Project\n\nThe first step is to create the application project. You will use this project to build the application that hosts the custom control.\n\n### To create the project\n\n- Create a Windows Forms Application project called \"MarqueeControlTest\" (**File** > **New** > **Project** > **Visual C#** or **Visual Basic** > **Classic Desktop** > **Windows Forms Application**).\n\n## Creating a Control Library Project\n\nThe next step is to create the control library project. You will create a new custom control and its corresponding custom designer.\n\n### To create the control library project\n\n1. Add a Windows Forms Control Library project to the solution. Name the project \"MarqueeControlLibrary.\"\n\n2. Using **Solution Explorer**, delete the project's default control by deleting the source file named \"UserControl1.cs\" or \"UserControl1.vb\", depending on your language of choice. For more information, see [How to: Remove, Delete, and Exclude Items](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/0ebzhwsk(v=vs.100)).\n\n3. Add a new <xref:System.Windows.Forms.UserControl> item to the `MarqueeControlLibrary` project. Give the new source file a base name of \"MarqueeControl.\"\n\n4. Using **Solution Explorer**, create a new folder in the `MarqueeControlLibrary` project. For more information, see [How to: Add New Project Items](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/w0572c5b(v=vs.100)). Name the new folder \"Design.\"\n\n5. Right-click the **Design** folder and add a new class. Give the source file a base name of \"MarqueeControlRootDesigner.\"\n\n6. You will need to use types from the System.Design assembly, so add this reference to the `MarqueeControlLibrary` project.\n\n    > [!NOTE]\n    > To use the System.Design assembly, your project must target the full version of the .NET Framework, not the .NET Framework Client Profile. To change the target framework, see [How to: Target a Version of the .NET Framework](/visualstudio/ide/how-to-target-a-version-of-the-dotnet-framework).\n\n## Referencing the Custom Control Project\n\nYou will use the `MarqueeControlTest` project to test the custom control. The test project will become aware of the custom control when you add a project reference to the `MarqueeControlLibrary` assembly.\n\n### To reference the custom control project\n\n- In the `MarqueeControlTest` project, add a project reference to the `MarqueeControlLibrary` assembly. Be sure to use the **Projects** tab in the **Add Reference** dialog box instead of referencing the `MarqueeControlLibrary` assembly directly.\n\n## Defining a Custom Control and Its Custom Designer\n Your custom control will derive from the <xref:System.Windows.Forms.UserControl> class. This allows your control to contain other controls, and it gives your control a great deal of default functionality.\n\n Your custom control will have an associated custom designer. This allows you to create a unique design experience tailored specifically for your custom control.\n\n You associate the control with its designer by using the <xref:System.ComponentModel.DesignerAttribute> class. Because you are developing the entire design-time behavior of your custom control, the custom designer will implement the <xref:System.ComponentModel.Design.IRootDesigner> interface.\n\n### To define a custom control and its custom designer\n\n1. Open the `MarqueeControl` source file in the **Code Editor**. At the top of the file, import the following namespaces:\n\n     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#220](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrol.cs#220)]\n     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#220](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrol.vb#220)]\n\n2. Add the <xref:System.ComponentModel.DesignerAttribute> to the `MarqueeControl` class declaration. This associates the custom control with its designer.\n\n     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#240](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrol.cs#240)]\n     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#240](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrol.vb#240)]\n\n3. Open the `MarqueeControlRootDesigner` source file in the **Code Editor**. At the top of the file, import the following namespaces:\n\n     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#520](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#520)]\n     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#520](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#520)]\n\n4. Change the declaration of `MarqueeControlRootDesigner` to inherit from the <xref:System.Windows.Forms.Design.DocumentDesigner> class. Apply the <xref:System.ComponentModel.ToolboxItemFilterAttribute> to specify the designer interaction with the **Toolbox**.\n\n     **Note** The definition for the `MarqueeControlRootDesigner` class has been enclosed in a namespace called \"MarqueeControlLibrary.Design.\" This declaration places the designer in a special namespace reserved for design-related types.\n\n     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#530](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#530)]\n     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#530](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#530)]\n\n5. Define the constructor for the `MarqueeControlRootDesigner` class. Insert a <xref:System.Diagnostics.Trace.WriteLine%2A> statement in the constructor body. This will be useful for debugging purposes.\n\n     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#540](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#540)]\n     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#540](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#540)]\n\n## Creating an Instance of Your Custom Control\n To observe the custom design-time behavior of your control, you will place an instance of your control on the form in `MarqueeControlTest` project.\n\n### To create an instance of your custom control\n\n1. Add a new <xref:System.Windows.Forms.UserControl> item to the `MarqueeControlTest` project. Give the new source file a base name of \"DemoMarqueeControl.\"\n\n2. Open the `DemoMarqueeControl` file in the **Code Editor**. At the top of the file, import the `MarqueeControlLibrary` namespace:\n\n```vb\nImports MarqueeControlLibrary\n```\n\n```csharp\nusing MarqueeControlLibrary;\n```\n\n1. Change the declaration of `DemoMarqueeControl` to inherit from the `MarqueeControl` class.\n\n2. Build the project.\n\n3. Open `Form1` in the Windows Forms Designer.\n\n4. Find the **MarqueeControlTest Components** tab in the **Toolbox** and open it. Drag a `DemoMarqueeControl` from the **Toolbox** onto your form.\n\n5. Build the project.\n\n## Setting Up the Project for Design-Time Debugging\n\nWhen you are developing a custom design-time experience, it will be necessary to debug your controls and components. There is a simple way to set up your project to allow debugging at design time. For more information, see [Walkthrough: Debugging Custom Windows Forms Controls at Design Time](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md).\n\n### To set up the project for design-time debugging\n\n1. Right-click the `MarqueeControlLibrary` project and select **Properties**.\n\n2. In the \"MarqueeControlLibrary Property Pages\" dialog box, select the **Debug** page.\n\n3. In the **Start Action** section, select **Start External Program**. You will be debugging a separate instance of Visual Studio, so click the ellipsis (![VisualStudioEllipsesButton screenshot](../media/vbellipsesbutton.png \"vbEllipsesButton\")) button to browse for the Visual Studio IDE. The name of the executable file is devenv.exe, and if you installed to the default location, its path is %programfiles%\\Microsoft Visual Studio 9.0\\Common7\\IDE\\devenv.exe.\n\n4. Click OK to close the dialog box.\n\n5. Right-click the `MarqueeControlLibrary` project and select \"Set as StartUp Project\" to enable this debugging configuration.\n\n## Checkpoint\n\nYou are now ready to debug the design-time behavior of your custom control. Once you have determined that the debugging environment is set up correctly, you will test the association between the custom control and the custom designer.\n\n### To test the debugging environment and the designer association\n\n1. Open the `MarqueeControlRootDesigner` source file in the **Code Editor** and place a breakpoint on the <xref:System.Diagnostics.Trace.WriteLine%2A> statement.\n\n2. Press F5 to start the debugging session. Note that a new instance of Visual Studio is created.\n\n3. In the new instance of Visual Studio, open the \"MarqueeControlTest\" solution. You can easily find the solution by selecting **Recent Projects** from the **File** menu. The \"MarqueeControlTest.sln\" solution file will be listed as the most recently used file.\n\n4. Open the `DemoMarqueeControl` in the designer. Note that the debugging instance of Visual Studio acquires focus and execution stops at your breakpoint. Press F5 to continue the debugging session.\n\nAt this point, everything is in place for you to develop and debug your custom control and its associated custom designer. The remainder of this walkthrough will concentrate on the details of implementing features of the control and the designer.\n\n## Implementing Your Custom Control\n\nThe `MarqueeControl` is a <xref:System.Windows.Forms.UserControl> with a little bit of customization. It exposes two methods: `Start`, which starts the marquee animation, and `Stop`, which stops the animation. Because the `MarqueeControl` contains child controls that implement the `IMarqueeWidget` interface, `Start` and `Stop` enumerate each child control and call the `StartMarquee` and `StopMarquee` methods, respectively, on each child control that implements `IMarqueeWidget`.\n\nThe appearance of the `MarqueeBorder` and `MarqueeText` controls is dependent on the layout, so `MarqueeControl` overrides the <xref:System.Windows.Forms.Control.OnLayout%2A> method and calls <xref:System.Windows.Forms.Control.PerformLayout%2A> on child controls of this type.\n\nThis is the extent of the `MarqueeControl` customizations. The run-time features are implemented by the `MarqueeBorder` and `MarqueeText` controls, and the design-time features are implemented by the `MarqueeBorderDesigner` and `MarqueeControlRootDesigner` classes.\n\n### To implement your custom control\n\n1. Open the `MarqueeControl` source file in the **Code Editor**. Implement the `Start` and `Stop` methods.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#260](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrol.cs#260)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#260](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrol.vb#260)]\n\n2. Override the <xref:System.Windows.Forms.Control.OnLayout%2A> method.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#270](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrol.cs#270)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#270](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrol.vb#270)]\n\n## Creating a Child Control for Your Custom Control\n\nThe `MarqueeControl` will host two kinds of child control: the `MarqueeBorder` control and the `MarqueeText` control.\n\n- `MarqueeBorder`: This control paints a border of \"lights\" around its edges. The lights flash in sequence, so they appear to be moving around the border. The speed at which the lights flash is controlled by a property called `UpdatePeriod`. Several other custom properties determine other aspects of the control's appearance. Two methods, called `StartMarquee` and `StopMarquee`, control when the animation starts and stops.\n\n- `MarqueeText`: This control paints a flashing string. Like the `MarqueeBorder` control, the speed at which the text flashes is controlled by the `UpdatePeriod` property. The `MarqueeText` control also has the `StartMarquee` and `StopMarquee` methods in common with the `MarqueeBorder` control.\n\nAt design time, the `MarqueeControlRootDesigner` allows these two control types to be added to a `MarqueeControl` in any combination.\n\nCommon features of the two controls are factored into an interface called `IMarqueeWidget`. This allows the `MarqueeControl` to discover any Marquee-related child controls and give them special treatment.\n\nTo implement the periodic animation feature, you will use <xref:System.ComponentModel.BackgroundWorker> objects from the <xref:System.ComponentModel?displayProperty=nameWithType> namespace. You could use <xref:System.Windows.Forms.Timer> objects, but when many `IMarqueeWidget` objects are present, the single UI thread may be unable to keep up with the animation.\n\n### To create a child control for your custom control\n\n1. Add a new class item to the `MarqueeControlLibrary` project. Give the new source file a base name of \"IMarqueeWidget.\"\n\n2. Open the `IMarqueeWidget` source file in the **Code Editor** and change the declaration from `class` to `interface`:\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/imarqueewidget.cs#2)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/imarqueewidget.vb#2)]\n\n3. Add the following code to the `IMarqueeWidget` interface to expose two methods and a property that manipulate the marquee animation:\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/imarqueewidget.cs#3)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/imarqueewidget.vb#3)]\n\n4. Add a new **Custom Control** item to the `MarqueeControlLibrary` project. Give the new source file a base name of \"MarqueeText.\"\n\n5. Drag a <xref:System.ComponentModel.BackgroundWorker> component from the **Toolbox** onto your `MarqueeText` control. This component will allow the `MarqueeText` control to update itself asynchronously.\n\n6. In the Properties window, set the <xref:System.ComponentModel.BackgroundWorker> component's `WorkerReportsProgress` and <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> properties to `true`. These settings allow the <xref:System.ComponentModel.BackgroundWorker> component to periodically raise the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event and to cancel asynchronous updates. For more information, see [BackgroundWorker Component](backgroundworker-component.md).\n\n7. Open the `MarqueeText` source file in the **Code Editor**. At the top of the file, import the following namespaces:\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#120](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#120)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#120](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#120)]\n\n8. Change the declaration of `MarqueeText` to inherit from <xref:System.Windows.Forms.Label> and to implement the `IMarqueeWidget` interface:\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#130](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#130)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#130](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#130)]\n\n9. Declare the instance variables that correspond to the exposed properties, and initialize them in the constructor. The `isLit` field determines if the text is to be painted in the color given by the `LightColor` property.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#140](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#140)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#140](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#140)]\n\n10. Implement the `IMarqueeWidget` interface.\n\n    The `StartMarquee` and `StopMarquee` methods invoke the <xref:System.ComponentModel.BackgroundWorker> component's <xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A> and <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> methods to start and stop the animation.\n\n    The <xref:System.ComponentModel.CategoryAttribute.Category%2A> and <xref:System.ComponentModel.BrowsableAttribute.Browsable%2A> attributes are applied to the `UpdatePeriod` property so it appears in a custom section of the Properties window called \"Marquee.\"\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#150](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#150)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#150](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#150)]\n\n11. Implement the property accessors. You will expose two properties to clients: `LightColor` and `DarkColor`. The <xref:System.ComponentModel.CategoryAttribute.Category%2A> and <xref:System.ComponentModel.BrowsableAttribute.Browsable%2A> attributes are applied to these properties, so the properties appear in a custom section of the Properties window called \"Marquee.\"\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#160](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#160)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#160](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#160)]\n\n12. Implement the handlers for the <xref:System.ComponentModel.BackgroundWorker> component's <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> events.\n\n    The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler sleeps for the number of milliseconds specified by `UpdatePeriod` then raises the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event, until your code stops the animation by calling <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A>.\n\n    The <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event handler toggles the text between its light and dark state to give the appearance of flashing.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#180](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#180)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#180](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#180)]\n\n13. Override the <xref:System.Windows.Forms.Control.OnPaint%2A> method to enable the animation.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#170](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#170)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#170](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#170)]\n\n14. Press F6 to build the solution.\n\n## Create the MarqueeBorder Child Control\n\nThe `MarqueeBorder` control is slightly more sophisticated than the `MarqueeText` control. It has more properties and the animation in the <xref:System.Windows.Forms.Control.OnPaint%2A> method is more involved. In principle, it is quite similar to the `MarqueeText` control.\n\nBecause the `MarqueeBorder` control can have child controls, it needs to be aware of <xref:System.Windows.Forms.Control.Layout> events.\n\n### To create the MarqueeBorder control\n\n1. Add a new **Custom Control** item to the `MarqueeControlLibrary` project. Give the new source file a base name of \"MarqueeBorder.\"\n\n2. Drag a <xref:System.ComponentModel.BackgroundWorker> component from the **Toolbox** onto your `MarqueeBorder` control. This component will allow the `MarqueeBorder` control to update itself asynchronously.\n\n3. In the Properties window, set the <xref:System.ComponentModel.BackgroundWorker> component's `WorkerReportsProgress` and <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> properties to `true`. These settings allow the <xref:System.ComponentModel.BackgroundWorker> component to periodically raise the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event and to cancel asynchronous updates. For more information, see [BackgroundWorker Component](backgroundworker-component.md).\n\n4. In the Properties window, click the Events button. Attach handlers for the <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> events.\n\n5. Open the `MarqueeBorder` source file in the **Code Editor**. At the top of the file, import the following namespaces:\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#20](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#20)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#20](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#20)]\n\n6. Change the declaration of `MarqueeBorder` to inherit from <xref:System.Windows.Forms.Panel> and to implement the `IMarqueeWidget` interface.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#30](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#30)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#30](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#30)]\n\n7. Declare two enumerations for managing the `MarqueeBorder` control's state: `MarqueeSpinDirection`, which determines the direction in which the lights \"spin\" around the border, and `MarqueeLightShape`, which determines the shape of the lights (square or circular). Place these declarations before the `MarqueeBorder` class declaration.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#97](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#97)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#97](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#97)]\n\n8. Declare the instance variables that correspond to the exposed properties, and initialize them in the constructor.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#40](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#40)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#40](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#40)]\n\n9. Implement the `IMarqueeWidget` interface.\n\n    The `StartMarquee` and `StopMarquee` methods invoke the <xref:System.ComponentModel.BackgroundWorker> component's <xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A> and <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> methods to start and stop the animation.\n\n    Because the `MarqueeBorder` control can contain child controls, the `StartMarquee` method enumerates all child controls and calls `StartMarquee` on those that implement `IMarqueeWidget`. The `StopMarquee` method has a similar implementation.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#50](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#50)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#50](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#50)]\n\n10. Implement the property accessors. The `MarqueeBorder` control has several properties for controlling its appearance.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#60](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#60)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#60](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#60)]\n\n11. Implement the handlers for the <xref:System.ComponentModel.BackgroundWorker> component's <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> events.\n\n    The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler sleeps for the number of milliseconds specified by `UpdatePeriod` then raises the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event, until your code stops the animation by calling <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A>.\n\n    The <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event handler increments the position of the \"base\" light, from which the light/dark state of the other lights is determined, and calls the <xref:System.Windows.Forms.Control.Refresh%2A> method to cause the control to repaint itself.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#90](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#90)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#90](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#90)]\n\n12. Implement the helper methods, `IsLit` and `DrawLight`.\n\n    The `IsLit` method determines the color of a light at a given position. Lights that are \"lit\" are drawn in the color given by the `LightColor` property, and those that are \"dark\" are drawn in the color given by the `DarkColor` property.\n\n    The `DrawLight` method draws a light using the appropriate color, shape, and position.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#80](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#80)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#80](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#80)]\n\n13. Override the <xref:System.Windows.Forms.Control.OnLayout%2A> and <xref:System.Windows.Forms.Control.OnPaint%2A> methods.\n\n    The <xref:System.Windows.Forms.Control.OnPaint%2A> method draws the lights along the edges of the `MarqueeBorder` control.\n\n    Because the <xref:System.Windows.Forms.Control.OnPaint%2A> method depends on the dimensions of the `MarqueeBorder` control, you need to call it whenever the layout changes. To achieve this, override <xref:System.Windows.Forms.Control.OnLayout%2A> and call <xref:System.Windows.Forms.Control.Refresh%2A>.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#70](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#70)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#70](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#70)]\n\n## Creating a Custom Designer to Shadow and Filter Properties\n\nThe `MarqueeControlRootDesigner` class provides the implementation for the root designer. In addition to this designer, which operates on the `MarqueeControl`, you will need a custom designer that is specifically associated with the `MarqueeBorder` control. This designer provides custom behavior that is appropriate in the context of the custom root designer.\n\nSpecifically, the `MarqueeBorderDesigner` will \"shadow\" and filter certain properties on the `MarqueeBorder` control, changing their interaction with the design environment.\n\nIntercepting calls to a component's property accessor is known as \"shadowing.\" It allows a designer to track the value set by the user and optionally pass that value to the component being designed.\n\nFor this example, the <xref:System.Windows.Forms.Control.Visible%2A> and <xref:System.Windows.Forms.Control.Enabled%2A> properties will be shadowed by the `MarqueeBorderDesigner`, which prevents the user from making the `MarqueeBorder` control invisible or disabled during design time.\n\nDesigners can also add and remove properties. For this example, the <xref:System.Windows.Forms.Control.Padding%2A> property will be removed at design time, because the `MarqueeBorder` control programmatically sets the padding based on the size of the lights specified by the `LightSize` property.\n\nThe base class for `MarqueeBorderDesigner` is <xref:System.ComponentModel.Design.ComponentDesigner>, which has methods that can change the attributes, properties, and events exposed by a control at design time:\n\n- <xref:System.ComponentModel.Design.ComponentDesigner.PreFilterProperties%2A>\n\n- <xref:System.ComponentModel.Design.ComponentDesigner.PostFilterProperties%2A>\n\n- <xref:System.ComponentModel.Design.ComponentDesigner.PreFilterAttributes%2A>\n\n- <xref:System.ComponentModel.Design.ComponentDesigner.PostFilterAttributes%2A>\n\n- <xref:System.ComponentModel.Design.ComponentDesigner.PreFilterEvents%2A>\n\n- <xref:System.ComponentModel.Design.ComponentDesigner.PostFilterEvents%2A>\n\nWhen changing the public interface of a component using these methods, you must follow these rules:\n\n- Add or remove items in the `PreFilter` methods only\n\n- Modify existing items in the `PostFilter` methods only\n\n- Always call the base implementation first in the `PreFilter` methods\n\n- Always call the base implementation last in the `PostFilter` methods\n\nAdhering to these rules ensures that all designers in the design-time environment have a consistent view of all components being designed.\n\nThe <xref:System.ComponentModel.Design.ComponentDesigner> class provides a dictionary for managing the values of shadowed properties, which relieves you of the need to create specific instance variables.\n\n### To create a custom designer to shadow and filter properties\n\n1. Right-click the **Design** folder and add a new class. Give the source file a base name of \"MarqueeBorderDesigner.\"\n\n2. Open the `MarqueeBorderDesigner` source file in the **Code Editor**. At the top of the file, import the following namespaces:\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#420](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborderdesigner.cs#420)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#420](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborderdesigner.vb#420)]\n\n3. Change the declaration of `MarqueeBorderDesigner` to inherit from <xref:System.Windows.Forms.Design.ParentControlDesigner>.\n\n    Because the `MarqueeBorder` control can contain child controls, `MarqueeBorderDesigner` inherits from <xref:System.Windows.Forms.Design.ParentControlDesigner>, which handles the parent-child interaction.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#430](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborderdesigner.cs#430)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#430](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborderdesigner.vb#430)]\n\n4. Override the base implementation of <xref:System.ComponentModel.Design.ComponentDesigner.PreFilterProperties%2A>.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#450](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborderdesigner.cs#450)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#450](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborderdesigner.vb#450)]\n\n5. Implement the <xref:System.Windows.Forms.Control.Enabled%2A> and <xref:System.Windows.Forms.Control.Visible%2A> properties. These implementations shadow the control's properties.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#440](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborderdesigner.cs#440)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#440](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborderdesigner.vb#440)]\n\n## Handling Component Changes\n The `MarqueeControlRootDesigner` class provides the custom design-time experience for your `MarqueeControl` instances. Most of the design-time functionality is inherited from the <xref:System.Windows.Forms.Design.DocumentDesigner> class; your code will implement two specific customizations: handling component changes, and adding designer verbs.\n\n As users design their `MarqueeControl` instances, your root designer will track changes to the `MarqueeControl` and its child controls. The design-time environment offers a convenient service, <xref:System.ComponentModel.Design.IComponentChangeService>, for tracking changes to component state.\n\n You acquire a reference to this service by querying the environment with the <xref:System.ComponentModel.Design.ComponentDesigner.GetService%2A> method. If the query is successful, your designer can attach a handler for the <xref:System.ComponentModel.Design.IComponentChangeService.ComponentChanged> event and perform whatever tasks are required to maintain a consistent state at design time.\n\n In the case of the `MarqueeControlRootDesigner` class, you will call the <xref:System.Windows.Forms.Control.Refresh%2A> method on each `IMarqueeWidget` object contained by the `MarqueeControl`. This will cause the `IMarqueeWidget` object to repaint itself appropriately when properties like its parent's <xref:System.Windows.Forms.Control.Size%2A> are changed.\n\n### To handle component changes\n\n1. Open the `MarqueeControlRootDesigner` source file in the **Code Editor** and override the <xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A> method. Call the base implementation of <xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A> and query for the <xref:System.ComponentModel.Design.IComponentChangeService>.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#580](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#580)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#580](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#580)]\n\n2. Implement the <xref:System.ComponentModel.Design.IComponentChangeService.OnComponentChanged%2A> event handler. Test the sending component's type, and if it is an `IMarqueeWidget`, call its <xref:System.Windows.Forms.Control.Refresh%2A> method.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#560](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#560)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#560](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#560)]\n\n## Adding Designer Verbs to your Custom Designer\n\nA designer verb is a menu command linked to an event handler. Designer verbs are added to a component's shortcut menu at design time. For more information, see <xref:System.ComponentModel.Design.DesignerVerb>.\n\nYou will add two designer verbs to your designers: **Run Test** and **Stop Test**. These verbs will allow you to view the run-time behavior of the `MarqueeControl` at design time. These verbs will be added to the `MarqueeControlRootDesigner`.\n\nWhen **Run Test** is invoked, the verb event handler will call the `StartMarquee` method on the `MarqueeControl`. When **Stop Test** is invoked, the verb event handler will call the `StopMarquee` method on the `MarqueeControl`. The implementation of the `StartMarquee` and `StopMarquee` methods call these methods on contained controls that implement `IMarqueeWidget`, so any contained `IMarqueeWidget` controls will also participate in the test.\n\n### To add designer verbs to your custom designers\n\n1. In the `MarqueeControlRootDesigner` class, add event handlers named `OnVerbRunTest` and `OnVerbStopTest`.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#570](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#570)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#570](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#570)]\n\n2. Connect these event handlers to their corresponding designer verbs. `MarqueeControlRootDesigner` inherits a <xref:System.ComponentModel.Design.DesignerVerbCollection> from its base class. You will create two new <xref:System.ComponentModel.Design.DesignerVerb> objects and add them to this collection in the <xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A> method.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#590](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#590)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#590](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#590)]\n\n## Creating a Custom UITypeEditor\n\nWhen you create a custom design-time experience for users, it is often desirable to create a custom interaction with the Properties window. You can accomplish this by creating a <xref:System.Drawing.Design.UITypeEditor>. For more information, see [How to: Create a UI Type Editor](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/fd3kt7d5(v=vs.120)).\n\nThe `MarqueeBorder` control exposes several properties in the Properties window. Two of these properties, `MarqueeSpinDirection` and `MarqueeLightShape` are represented by enumerations. To illustrate the use of a UI type editor, the `MarqueeLightShape` property will have an associated <xref:System.Drawing.Design.UITypeEditor> class.\n\n### To create a custom UI type editor\n\n1. Open the `MarqueeBorder` source file in the **Code Editor**.\n\n2. In the definition of the `MarqueeBorder` class, declare a class called `LightShapeEditor` that derives from <xref:System.Drawing.Design.UITypeEditor>.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#96](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#96)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#96](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#96)]\n\n3. Declare an <xref:System.Windows.Forms.Design.IWindowsFormsEditorService> instance variable called `editorService`.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#92](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#92)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#92](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#92)]\n\n4. Override the <xref:System.Drawing.Design.UITypeEditor.GetEditStyle%2A> method. This implementation returns <xref:System.Drawing.Design.UITypeEditorEditStyle.DropDown>, which tells the design environment how to display the `LightShapeEditor`.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#93](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#93)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#93](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#93)]\n\n5. Override the <xref:System.Drawing.Design.UITypeEditor.EditValue%2A> method. This implementation queries the design environment for an <xref:System.Windows.Forms.Design.IWindowsFormsEditorService> object. If successful, it creates a `LightShapeSelectionControl`. The <xref:System.Windows.Forms.Design.IWindowsFormsEditorService.DropDownControl%2A> method is invoked to start the `LightShapeEditor`. The return value from this invocation is returned to the design environment.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#94](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#94)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#94](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#94)]\n\n## Creating a View Control for your Custom UITypeEditor\n\n1. The `MarqueeLightShape` property supports two types of light shapes: `Square` and `Circle`. You will create a custom control used solely for the purpose of graphically displaying these values in the Properties window. This custom control will be used by your <xref:System.Drawing.Design.UITypeEditor> to interact with the Properties window.\n\n### To create a view control for your custom UI type editor\n\n1. Add a new <xref:System.Windows.Forms.UserControl> item to the `MarqueeControlLibrary` project. Give the new source file a base name of \"LightShapeSelectionControl.\"\n\n2. Drag two <xref:System.Windows.Forms.Panel> controls from the **Toolbox** onto the `LightShapeSelectionControl`. Name them `squarePanel` and `circlePanel`. Arrange them side by side. Set the <xref:System.Windows.Forms.Control.Size%2A> property of both <xref:System.Windows.Forms.Panel> controls to (60, 60). Set the <xref:System.Windows.Forms.Control.Location%2A> property of the `squarePanel` control to (8, 10). Set the <xref:System.Windows.Forms.Control.Location%2A> property of the `circlePanel` control to (80, 10). Finally, set the <xref:System.Windows.Forms.Control.Size%2A> property of the `LightShapeSelectionControl` to (150, 80).\n\n3. Open the `LightShapeSelectionControl` source file in the **Code Editor**. At the top of the file, import the <xref:System.Windows.Forms.Design?displayProperty=nameWithType> namespace:\n\n```vb\nImports System.Windows.Forms.Design\n```\n\n```csharp\nusing System.Windows.Forms.Design;\n```\n\n1. Implement <xref:System.Windows.Forms.Control.Click> event handlers for the `squarePanel` and `circlePanel` controls. These methods invoke <xref:System.Windows.Forms.Design.IWindowsFormsEditorService.CloseDropDown%2A> to end the custom <xref:System.Drawing.Design.UITypeEditor> editing session.\n\n    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#390](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#390)]\n    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#390](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#390)]\n\n2. Declare an <xref:System.Windows.Forms.Design.IWindowsFormsEditorService> instance variable called `editorService`.\n\n```vb\nPrivate editorService As IWindowsFormsEditorService\n```\n\n```csharp\nprivate IWindowsFormsEditorService editorService;\n```\n\n1. Declare a `MarqueeLightShape` instance variable called `lightShapeValue`.\n\n     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#330](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#330)]\n     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#330](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#330)]\n\n2. In the `LightShapeSelectionControl` constructor, attach the <xref:System.Windows.Forms.Control.Click> event handlers to the `squarePanel` and `circlePanel` controls' <xref:System.Windows.Forms.Control.Click> events. Also, define a constructor overload that assigns the `MarqueeLightShape` value from the design environment to the `lightShapeValue` field.\n\n     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#340](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#340)]\n     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#340](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#340)]\n\n3. In the <xref:System.ComponentModel.Component.Dispose%2A> method, detach the <xref:System.Windows.Forms.Control.Click> event handlers.\n\n     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#350](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#350)]\n     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#350](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#350)]\n\n4. In **Solution Explorer**, click the **Show All Files** button. Open the LightShapeSelectionControl.Designer.cs or LightShapeSelectionControl.Designer.vb file, and remove the default definition of the <xref:System.ComponentModel.Component.Dispose%2A> method.\n\n5. Implement the `LightShape` property.\n\n     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#360](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#360)]\n     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#360](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#360)]\n\n6. Override the <xref:System.Windows.Forms.Control.OnPaint%2A> method. This implementation will draw a filled square and circle. It will also highlight the selected value by drawing a border around one shape or the other.\n\n     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#380](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#380)]\n     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#380](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#380)]\n\n## Testing your Custom Control in the Designer\n\nAt this point, you can build the `MarqueeControlLibrary` project. Test your implementation by creating a control that inherits from the `MarqueeControl` class and using it on a form.\n\n### To create a custom MarqueeControl implementation\n\n1. Open `DemoMarqueeControl` in the Windows Forms Designer. This creates an instance of the `DemoMarqueeControl` type and displays it in an instance of the `MarqueeControlRootDesigner` type.\n\n2. In the **Toolbox**, open the **MarqueeControlLibrary Components** tab. You will see the `MarqueeBorder` and `MarqueeText` controls available for selection.\n\n3. Drag an instance of the `MarqueeBorder` control onto the `DemoMarqueeControl` design surface. Dock this `MarqueeBorder` control to the parent control.\n\n4. Drag an instance of the `MarqueeText` control onto the `DemoMarqueeControl` design surface.\n\n5. Build the solution.\n\n6. Right-click the `DemoMarqueeControl` and from the shortcut menu select the **Run Test** option to start the animation. Click **Stop Test** to stop the animation.\n\n7. Open **Form1** in Design view.\n\n8. Place two <xref:System.Windows.Forms.Button> controls on the form. Name them `startButton` and `stopButton`, and change the <xref:System.Windows.Forms.Control.Text%2A> property values to **Start** and **Stop**, respectively.\n\n9. Implement <xref:System.Windows.Forms.Control.Click> event handlers for both <xref:System.Windows.Forms.Button> controls.\n\n10. In the **Toolbox**, open the **MarqueeControlTest Components** tab. You will see the `DemoMarqueeControl` available for selection.\n\n11. Drag an instance of `DemoMarqueeControl` onto the **Form1** design surface.\n\n12. In the <xref:System.Windows.Forms.Control.Click> event handlers, invoke the `Start` and `Stop` methods on the `DemoMarqueeControl`.\n\n```vb\nPrivate Sub startButton_Click(sender As Object, e As System.EventArgs)\n    Me.demoMarqueeControl1.Start()\nEnd Sub 'startButton_Click\n\nPrivate Sub stopButton_Click(sender As Object, e As System.EventArgs)\nMe.demoMarqueeControl1.Stop()\nEnd Sub 'stopButton_Click\n```\n\n```csharp\nprivate void startButton_Click(object sender, System.EventArgs e)\n{\n    this.demoMarqueeControl1.Start();\n}\n\nprivate void stopButton_Click(object sender, System.EventArgs e)\n{\n    this.demoMarqueeControl1.Stop();\n}\n```\n\n1. Set the `MarqueeControlTest` project as the startup project and run it. You will see the form displaying your `DemoMarqueeControl`. Click the **Start** button to start the animation. You should see the text flashing and the lights moving around the border.\n\n## Next Steps\n\nThe `MarqueeControlLibrary` demonstrates a simple implementation of custom controls and associated designers. You can make this sample more sophisticated in several ways:\n\n- Change the property values for the `DemoMarqueeControl` in the designer. Add more `MarqueBorder` controls and dock them within their parent instances to create a nested effect. Experiment with different settings for the `UpdatePeriod` and the light-related properties.\n\n- Author your own implementations of `IMarqueeWidget`. You could, for example, create a flashing \"neon sign\" or an animated sign with multiple images.\n\n- Further customize the design-time experience. You could try shadowing more properties than <xref:System.Windows.Forms.Control.Enabled%2A> and <xref:System.Windows.Forms.Control.Visible%2A>, and you could add new properties. Add new designer verbs to simplify common tasks like docking child controls.\n\n- License the `MarqueeControl`. For more information, see [How to: License Components and Controls](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/fe8b1eh9(v=vs.120)).\n\n- Control how your controls are serialized and how code is generated for them. For more information, see [Dynamic Source Code Generation and Compilation](../../reflection-and-codedom/dynamic-source-code-generation-and-compilation.md).\n\n## See also\n\n- <xref:System.Windows.Forms.UserControl>\n- <xref:System.Windows.Forms.Design.ParentControlDesigner>\n- <xref:System.Windows.Forms.Design.DocumentDesigner>\n- <xref:System.ComponentModel.Design.IRootDesigner>\n- <xref:System.ComponentModel.Design.DesignerVerb>\n- <xref:System.Drawing.Design.UITypeEditor>\n- <xref:System.ComponentModel.BackgroundWorker>\n- [How to: Create a Windows Forms Control That Takes Advantage of Design-Time Features](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/307hck25(v=vs.120))\n- [Extending Design-Time Support](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/37899azc(v=vs.120))\n- [Custom Designers](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/h51z5c0x(v=vs.120))\n","nodes":[{"pos":[4,434],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Creating a Windows Forms Control That Takes Advantage of Visual Studio Design-Time Features\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"Windows Forms controls, creating\"\n  - \"design-time functionality [Windows Forms], Windows Forms\"\n  - \"DocumentDesigner class [Windows Forms]\"\n  - \"walkthroughs [Windows Forms], controls\"\nms.assetid: 6f487c59-cb38-4afa-ad2e-95edacb1d626","nodes":[{"content":"Walkthrough: Creating a Windows Forms Control That Takes Advantage of Visual Studio Design-Time Features","nodes":[{"pos":[0,104],"content":"Walkthrough: Creating a Windows Forms Control That Takes Advantage of Visual Studio Design-Time Features","nodes":[{"content":"Walkthrough: Creating a Windows Forms Control That Takes Advantage of Visual Studio Design-Time Features","pos":[0,104]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[442,546],"content":"Walkthrough: Creating a Windows Forms Control That Takes Advantage of Visual Studio Design-Time Features","linkify":"Walkthrough: Creating a Windows Forms Control That Takes Advantage of Visual Studio Design-Time Features","nodes":[{"content":"Walkthrough: Creating a Windows Forms Control That Takes Advantage of Visual Studio Design-Time Features","pos":[0,104]}]},{"content":"The design-time experience for a custom control can be enhanced by authoring an associated custom designer.","pos":[548,655]},{"content":"This walkthrough illustrates how to create a custom designer for a custom control.","pos":[657,739]},{"content":"You will implement a <ph id=\"ph1\">`MarqueeControl`</ph> type and an associated designer class, called <ph id=\"ph2\">`MarqueeControlRootDesigner`</ph>.","pos":[740,853],"source":" You will implement a `MarqueeControl` type and an associated designer class, called `MarqueeControlRootDesigner`."},{"pos":[855,971],"content":"The <ph id=\"ph1\">`MarqueeControl`</ph> type implements a display similar to a theater marquee, with animated lights and flashing text.","source":"The `MarqueeControl` type implements a display similar to a theater marquee, with animated lights and flashing text."},{"content":"The designer for this control interacts with the design environment to provide a custom design-time experience.","pos":[973,1084]},{"content":"With the custom designer, you can assemble a custom <ph id=\"ph1\">`MarqueeControl`</ph> implementation with animated lights and flashing text in many combinations.","pos":[1085,1229],"source":" With the custom designer, you can assemble a custom `MarqueeControl` implementation with animated lights and flashing text in many combinations."},{"content":"You can use the assembled control on a form like any other Windows Forms control.","pos":[1230,1311]},{"content":"Tasks illustrated in this walkthrough include:","pos":[1313,1359]},{"content":"Creating the Project","pos":[1363,1383]},{"content":"Creating a Control Library Project","pos":[1387,1421]},{"content":"Referencing the Custom Control Project","pos":[1425,1463]},{"content":"Defining a Custom Control and Its Custom Designer","pos":[1467,1516]},{"content":"Creating an Instance of Your Custom Control","pos":[1520,1563]},{"content":"Setting Up the Project for Design-Time Debugging","pos":[1567,1615]},{"content":"Implementing Your Custom Control","pos":[1619,1651]},{"content":"Creating a Child Control for Your Custom Control","pos":[1655,1703]},{"content":"Create the MarqueeBorder Child Control","pos":[1707,1745]},{"content":"Creating a Custom Designer to Shadow and Filter Properties","pos":[1749,1807]},{"content":"Handling Component Changes","pos":[1811,1837]},{"content":"Adding Designer Verbs to your Custom Designer","pos":[1841,1886]},{"content":"Creating a Custom UITypeEditor","pos":[1890,1920]},{"content":"Testing your Custom Control in the Designer","pos":[1924,1967]},{"content":"When you are finished, your custom control will look something like the following:","pos":[1969,2051]},{"pos":[2053,2146],"content":"<bpt id=\"p1\">![</bpt>A possible MarqueeControl arrangement<ept id=\"p1\">]</ept><bpt id=\"p2\">(./media/demomarqueecontrol.gif \"</bpt>DemoMarqueeControl<ept id=\"p2\">\")</ept>","source":"![A possible MarqueeControl arrangement](./media/demomarqueecontrol.gif \"DemoMarqueeControl\")"},{"pos":[2148,2366],"content":"For the complete code listing, see <bpt id=\"p1\">[</bpt>How to: Create a Windows Forms Control That Takes Advantage of Design-Time Features<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/307hck25(v=vs.120))</ept>.","source":"For the complete code listing, see [How to: Create a Windows Forms Control That Takes Advantage of Design-Time Features](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/307hck25(v=vs.120))."},{"pos":[2370,2714],"content":"[!NOTE]\nThe dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).","leadings":["","> "],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition. To change your settings, choose **Import and Export Settings** on the **Tools** menu. For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).","pos":[8,342],"nodes":[{"content":"The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition.","pos":[0,130]},{"content":"To change your settings, choose <bpt id=\"p1\">**</bpt>Import and Export Settings<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Tools<ept id=\"p2\">**</ept> menu.","pos":[131,216],"source":" To change your settings, choose **Import and Export Settings** on the **Tools** menu."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Personalize the Visual Studio IDE<ept id=\"p1\">](/visualstudio/ide/personalizing-the-visual-studio-ide)</ept>.","pos":[217,334],"source":" For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide)."}]}]},{"pos":[2719,2732],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"In order to complete this walkthrough, you will need:","pos":[2734,2787]},{"content":"Sufficient permissions to be able to create and run Windows Forms application projects on the computer where Visual Studio is installed.","pos":[2791,2927]},{"pos":[2932,2952],"content":"Creating the Project","linkify":"Creating the Project","nodes":[{"content":"Creating the Project","pos":[0,20]}]},{"content":"The first step is to create the application project.","pos":[2954,3006]},{"content":"You will use this project to build the application that hosts the custom control.","pos":[3007,3088]},{"pos":[3094,3115],"content":"To create the project","linkify":"To create the project","nodes":[{"content":"To create the project","pos":[0,21]}]},{"pos":[3119,3315],"content":"Create a Windows Forms Application project called \"MarqueeControlTest\" (<bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept><ph id=\"ph3\"> &gt; </ph><bpt id=\"p4\">**</bpt>Visual C#<ept id=\"p4\">**</ept> or <bpt id=\"p5\">**</bpt>Visual Basic<ept id=\"p5\">**</ept><ph id=\"ph4\"> &gt; </ph><bpt id=\"p6\">**</bpt>Classic Desktop<ept id=\"p6\">**</ept><ph id=\"ph5\"> &gt; </ph><bpt id=\"p7\">**</bpt>Windows Forms Application<ept id=\"p7\">**</ept>).","source":"Create a Windows Forms Application project called \"MarqueeControlTest\" (**File** > **New** > **Project** > **Visual C#** or **Visual Basic** > **Classic Desktop** > **Windows Forms Application**)."},{"pos":[3320,3354],"content":"Creating a Control Library Project","linkify":"Creating a Control Library Project","nodes":[{"content":"Creating a Control Library Project","pos":[0,34]}]},{"content":"The next step is to create the control library project.","pos":[3356,3411]},{"content":"You will create a new custom control and its corresponding custom designer.","pos":[3412,3487]},{"pos":[3493,3530],"content":"To create the control library project","linkify":"To create the control library project","nodes":[{"content":"To create the control library project","pos":[0,37]}]},{"content":"Add a Windows Forms Control Library project to the solution.","pos":[3535,3595]},{"content":"Name the project \"MarqueeControlLibrary.\"","pos":[3596,3637]},{"content":"Using <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, delete the project's default control by deleting the source file named \"UserControl1.cs\" or \"UserControl1.vb\", depending on your language of choice.","pos":[3642,3819],"source":"Using **Solution Explorer**, delete the project's default control by deleting the source file named \"UserControl1.cs\" or \"UserControl1.vb\", depending on your language of choice."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Remove, Delete, and Exclude Items<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/0ebzhwsk(v=vs.100))</ept>.","pos":[3820,3987],"source":" For more information, see [How to: Remove, Delete, and Exclude Items](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/0ebzhwsk(v=vs.100))."},{"content":"Add a new <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> item to the <ph id=\"ph2\">`MarqueeControlLibrary`</ph> project.","pos":[3992,4086],"source":"Add a new <xref:System.Windows.Forms.UserControl> item to the `MarqueeControlLibrary` project."},{"content":"Give the new source file a base name of \"MarqueeControl.\"","pos":[4087,4144]},{"content":"Using <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, create a new folder in the <ph id=\"ph1\">`MarqueeControlLibrary`</ph> project.","pos":[4149,4237],"source":"Using **Solution Explorer**, create a new folder in the `MarqueeControlLibrary` project."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Add New Project Items<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/w0572c5b(v=vs.100))</ept>.","pos":[4238,4393],"source":" For more information, see [How to: Add New Project Items](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/w0572c5b(v=vs.100))."},{"content":"Name the new folder \"Design.\"","pos":[4394,4423]},{"content":"Right-click the <bpt id=\"p1\">**</bpt>Design<ept id=\"p1\">**</ept> folder and add a new class.","pos":[4428,4482],"source":"Right-click the **Design** folder and add a new class."},{"content":"Give the source file a base name of \"MarqueeControlRootDesigner.\"","pos":[4483,4548]},{"pos":[4553,4674],"content":"You will need to use types from the System.Design assembly, so add this reference to the <ph id=\"ph1\">`MarqueeControlLibrary`</ph> project.","source":"You will need to use types from the System.Design assembly, so add this reference to the `MarqueeControlLibrary` project."},{"pos":[4682,4987],"content":"[!NOTE]\nTo use the System.Design assembly, your project must target the full version of the .NET Framework, not the .NET Framework Client Profile. To change the target framework, see [How to: Target a Version of the .NET Framework](/visualstudio/ide/how-to-target-a-version-of-the-dotnet-framework).","leadings":["","    > "],"nodes":[{"content":"To use the System.Design assembly, your project must target the full version of the .NET Framework, not the .NET Framework Client Profile. To change the target framework, see [How to: Target a Version of the .NET Framework](/visualstudio/ide/how-to-target-a-version-of-the-dotnet-framework).","pos":[8,299],"nodes":[{"content":"To use the System.Design assembly, your project must target the full version of the .NET Framework, not the .NET Framework Client Profile.","pos":[0,138]},{"content":"To change the target framework, see <bpt id=\"p1\">[</bpt>How to: Target a Version of the .NET Framework<ept id=\"p1\">](/visualstudio/ide/how-to-target-a-version-of-the-dotnet-framework)</ept>.","pos":[139,291],"source":" To change the target framework, see [How to: Target a Version of the .NET Framework](/visualstudio/ide/how-to-target-a-version-of-the-dotnet-framework)."}]}]},{"pos":[4992,5030],"content":"Referencing the Custom Control Project","linkify":"Referencing the Custom Control Project","nodes":[{"content":"Referencing the Custom Control Project","pos":[0,38]}]},{"content":"You will use the <ph id=\"ph1\">`MarqueeControlTest`</ph> project to test the custom control.","pos":[5032,5105],"source":"You will use the `MarqueeControlTest` project to test the custom control."},{"content":"The test project will become aware of the custom control when you add a project reference to the <ph id=\"ph1\">`MarqueeControlLibrary`</ph> assembly.","pos":[5106,5236],"source":" The test project will become aware of the custom control when you add a project reference to the `MarqueeControlLibrary` assembly."},{"pos":[5242,5281],"content":"To reference the custom control project","linkify":"To reference the custom control project","nodes":[{"content":"To reference the custom control project","pos":[0,39]}]},{"content":"In the <ph id=\"ph1\">`MarqueeControlTest`</ph> project, add a project reference to the <ph id=\"ph2\">`MarqueeControlLibrary`</ph> assembly.","pos":[5285,5386],"source":"In the `MarqueeControlTest` project, add a project reference to the `MarqueeControlLibrary` assembly."},{"content":"Be sure to use the <bpt id=\"p1\">**</bpt>Projects<ept id=\"p1\">**</ept> tab in the <bpt id=\"p2\">**</bpt>Add Reference<ept id=\"p2\">**</ept> dialog box instead of referencing the <ph id=\"ph1\">`MarqueeControlLibrary`</ph> assembly directly.","pos":[5387,5528],"source":" Be sure to use the **Projects** tab in the **Add Reference** dialog box instead of referencing the `MarqueeControlLibrary` assembly directly."},{"pos":[5533,5582],"content":"Defining a Custom Control and Its Custom Designer","linkify":"Defining a Custom Control and Its Custom Designer","nodes":[{"content":"Defining a Custom Control and Its Custom Designer","pos":[0,49]}]},{"content":"Your custom control will derive from the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> class.","pos":[5584,5671],"source":"Your custom control will derive from the <xref:System.Windows.Forms.UserControl> class."},{"content":"This allows your control to contain other controls, and it gives your control a great deal of default functionality.","pos":[5672,5788]},{"content":"Your custom control will have an associated custom designer.","pos":[5791,5851]},{"content":"This allows you to create a unique design experience tailored specifically for your custom control.","pos":[5852,5951]},{"content":"You associate the control with its designer by using the <ph id=\"ph1\">&lt;xref:System.ComponentModel.DesignerAttribute&gt;</ph> class.","pos":[5954,6064],"source":"You associate the control with its designer by using the <xref:System.ComponentModel.DesignerAttribute> class."},{"content":"Because you are developing the entire design-time behavior of your custom control, the custom designer will implement the <ph id=\"ph1\">&lt;xref:System.ComponentModel.Design.IRootDesigner&gt;</ph> interface.","pos":[6065,6247],"source":" Because you are developing the entire design-time behavior of your custom control, the custom designer will implement the <xref:System.ComponentModel.Design.IRootDesigner> interface."},{"pos":[6253,6303],"content":"To define a custom control and its custom designer","linkify":"To define a custom control and its custom designer","nodes":[{"content":"To define a custom control and its custom designer","pos":[0,50]}]},{"content":"Open the <ph id=\"ph1\">`MarqueeControl`</ph> source file in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept>.","pos":[6308,6369],"source":"Open the `MarqueeControl` source file in the **Code Editor**."},{"content":"At the top of the file, import the following namespaces:","pos":[6370,6426]},{"pos":[6433,6804],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#220](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrol.cs#220)]\n  [!code-vb[System.Windows.Forms.Design.DocumentDesigner#220](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrol.vb#220)]","leadings":["","   "],"nodes":[]},{"content":"Add the <ph id=\"ph1\">&lt;xref:System.ComponentModel.DesignerAttribute&gt;</ph> to the <ph id=\"ph2\">`MarqueeControl`</ph> class declaration.","pos":[6809,6906],"source":"Add the <xref:System.ComponentModel.DesignerAttribute> to the `MarqueeControl` class declaration."},{"content":"This associates the custom control with its designer.","pos":[6907,6960]},{"pos":[6967,7338],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#240](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrol.cs#240)]\n  [!code-vb[System.Windows.Forms.Design.DocumentDesigner#240](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrol.vb#240)]","leadings":["","   "],"nodes":[]},{"content":"Open the <ph id=\"ph1\">`MarqueeControlRootDesigner`</ph> source file in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept>.","pos":[7343,7416],"source":"Open the `MarqueeControlRootDesigner` source file in the **Code Editor**."},{"content":"At the top of the file, import the following namespaces:","pos":[7417,7473]},{"pos":[7480,7875],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#520](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#520)]\n  [!code-vb[System.Windows.Forms.Design.DocumentDesigner#520](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#520)]","leadings":["","   "],"nodes":[]},{"content":"Change the declaration of <ph id=\"ph1\">`MarqueeControlRootDesigner`</ph> to inherit from the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Design.DocumentDesigner&gt;</ph> class.","pos":[7880,8013],"source":"Change the declaration of `MarqueeControlRootDesigner` to inherit from the <xref:System.Windows.Forms.Design.DocumentDesigner> class."},{"content":"Apply the <ph id=\"ph1\">&lt;xref:System.ComponentModel.ToolboxItemFilterAttribute&gt;</ph> to specify the designer interaction with the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>.","pos":[8014,8137],"source":" Apply the <xref:System.ComponentModel.ToolboxItemFilterAttribute> to specify the designer interaction with the **Toolbox**."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> The definition for the <ph id=\"ph1\">`MarqueeControlRootDesigner`</ph> class has been enclosed in a namespace called \"MarqueeControlLibrary.Design.\"","pos":[8144,8282],"source":"**Note** The definition for the `MarqueeControlRootDesigner` class has been enclosed in a namespace called \"MarqueeControlLibrary.Design.\""},{"content":"This declaration places the designer in a special namespace reserved for design-related types.","pos":[8283,8377]},{"pos":[8384,8779],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#530](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#530)]\n  [!code-vb[System.Windows.Forms.Design.DocumentDesigner#530](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#530)]","leadings":["","   "],"nodes":[]},{"content":"Define the constructor for the <ph id=\"ph1\">`MarqueeControlRootDesigner`</ph> class.","pos":[8784,8850],"source":"Define the constructor for the `MarqueeControlRootDesigner` class."},{"content":"Insert a <ph id=\"ph1\">&lt;xref:System.Diagnostics.Trace.WriteLine%2A&gt;</ph> statement in the constructor body.","pos":[8851,8939],"source":" Insert a <xref:System.Diagnostics.Trace.WriteLine%2A> statement in the constructor body."},{"content":"This will be useful for debugging purposes.","pos":[8940,8983]},{"pos":[8990,9385],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#540](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#540)]\n  [!code-vb[System.Windows.Forms.Design.DocumentDesigner#540](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#540)]","leadings":["","   "],"nodes":[]},{"pos":[9390,9433],"content":"Creating an Instance of Your Custom Control","linkify":"Creating an Instance of Your Custom Control","nodes":[{"content":"Creating an Instance of Your Custom Control","pos":[0,43]}]},{"pos":[9435,9582],"content":"To observe the custom design-time behavior of your control, you will place an instance of your control on the form in <ph id=\"ph1\">`MarqueeControlTest`</ph> project.","source":"To observe the custom design-time behavior of your control, you will place an instance of your control on the form in `MarqueeControlTest` project."},{"pos":[9588,9632],"content":"To create an instance of your custom control","linkify":"To create an instance of your custom control","nodes":[{"content":"To create an instance of your custom control","pos":[0,44]}]},{"content":"Add a new <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> item to the <ph id=\"ph2\">`MarqueeControlTest`</ph> project.","pos":[9637,9728],"source":"Add a new <xref:System.Windows.Forms.UserControl> item to the `MarqueeControlTest` project."},{"content":"Give the new source file a base name of \"DemoMarqueeControl.\"","pos":[9729,9790]},{"content":"Open the <ph id=\"ph1\">`DemoMarqueeControl`</ph> file in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept>.","pos":[9795,9853],"source":"Open the `DemoMarqueeControl` file in the **Code Editor**."},{"content":"At the top of the file, import the <ph id=\"ph1\">`MarqueeControlLibrary`</ph> namespace:","pos":[9854,9923],"source":" At the top of the file, import the `MarqueeControlLibrary` namespace:"},{"pos":[10013,10103],"content":"Change the declaration of <ph id=\"ph1\">`DemoMarqueeControl`</ph> to inherit from the <ph id=\"ph2\">`MarqueeControl`</ph> class.","source":"Change the declaration of `DemoMarqueeControl` to inherit from the `MarqueeControl` class."},{"content":"Build the project.","pos":[10108,10126]},{"pos":[10131,10174],"content":"Open <ph id=\"ph1\">`Form1`</ph> in the Windows Forms Designer.","source":"Open `Form1` in the Windows Forms Designer."},{"content":"Find the <bpt id=\"p1\">**</bpt>MarqueeControlTest Components<ept id=\"p1\">**</ept> tab in the <bpt id=\"p2\">**</bpt>Toolbox<ept id=\"p2\">**</ept> and open it.","pos":[10179,10257],"source":"Find the **MarqueeControlTest Components** tab in the **Toolbox** and open it."},{"content":"Drag a <ph id=\"ph1\">`DemoMarqueeControl`</ph> from the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> onto your form.","pos":[10258,10322],"source":" Drag a `DemoMarqueeControl` from the **Toolbox** onto your form."},{"content":"Build the project.","pos":[10327,10345]},{"pos":[10350,10398],"content":"Setting Up the Project for Design-Time Debugging","linkify":"Setting Up the Project for Design-Time Debugging","nodes":[{"content":"Setting Up the Project for Design-Time Debugging","pos":[0,48]}]},{"content":"When you are developing a custom design-time experience, it will be necessary to debug your controls and components.","pos":[10400,10516]},{"content":"There is a simple way to set up your project to allow debugging at design time.","pos":[10517,10596]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: Debugging Custom Windows Forms Controls at Design Time<ept id=\"p1\">](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md)</ept>.","pos":[10597,10764],"source":" For more information, see [Walkthrough: Debugging Custom Windows Forms Controls at Design Time](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md)."},{"pos":[10770,10817],"content":"To set up the project for design-time debugging","linkify":"To set up the project for design-time debugging","nodes":[{"content":"To set up the project for design-time debugging","pos":[0,47]}]},{"pos":[10822,10896],"content":"Right-click the <ph id=\"ph1\">`MarqueeControlLibrary`</ph> project and select <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","source":"Right-click the `MarqueeControlLibrary` project and select **Properties**."},{"pos":[10901,10985],"content":"In the \"MarqueeControlLibrary Property Pages\" dialog box, select the <bpt id=\"p1\">**</bpt>Debug<ept id=\"p1\">**</ept> page.","source":"In the \"MarqueeControlLibrary Property Pages\" dialog box, select the **Debug** page."},{"content":"In the <bpt id=\"p1\">**</bpt>Start Action<ept id=\"p1\">**</ept> section, select <bpt id=\"p2\">**</bpt>Start External Program<ept id=\"p2\">**</ept>.","pos":[10990,11057],"source":"In the **Start Action** section, select **Start External Program**."},{"content":"You will be debugging a separate instance of Visual Studio, so click the ellipsis (<bpt id=\"p1\">![</bpt>VisualStudioEllipsesButton screenshot<ept id=\"p1\">]</ept><bpt id=\"p2\">(../media/vbellipsesbutton.png \"</bpt>vbEllipsesButton<ept id=\"p2\">\")</ept>) button to browse for the Visual Studio IDE.","pos":[11058,11276],"source":" You will be debugging a separate instance of Visual Studio, so click the ellipsis (![VisualStudioEllipsesButton screenshot](../media/vbellipsesbutton.png \"vbEllipsesButton\")) button to browse for the Visual Studio IDE."},{"content":"The name of the executable file is devenv.exe, and if you installed to the default location, its path is %programfiles%\\Microsoft Visual Studio 9.0\\Common7\\IDE\\devenv.exe.","pos":[11277,11448]},{"content":"Click OK to close the dialog box.","pos":[11453,11486]},{"pos":[11491,11614],"content":"Right-click the <ph id=\"ph1\">`MarqueeControlLibrary`</ph> project and select \"Set as StartUp Project\" to enable this debugging configuration.","source":"Right-click the `MarqueeControlLibrary` project and select \"Set as StartUp Project\" to enable this debugging configuration."},{"pos":[11619,11629],"content":"Checkpoint","linkify":"Checkpoint","nodes":[{"content":"Checkpoint","pos":[0,10]}]},{"content":"You are now ready to debug the design-time behavior of your custom control.","pos":[11631,11706]},{"content":"Once you have determined that the debugging environment is set up correctly, you will test the association between the custom control and the custom designer.","pos":[11707,11865]},{"pos":[11871,11933],"content":"To test the debugging environment and the designer association","linkify":"To test the debugging environment and the designer association","nodes":[{"content":"To test the debugging environment and the designer association","pos":[0,62]}]},{"pos":[11938,12096],"content":"Open the <ph id=\"ph1\">`MarqueeControlRootDesigner`</ph> source file in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept> and place a breakpoint on the <ph id=\"ph2\">&lt;xref:System.Diagnostics.Trace.WriteLine%2A&gt;</ph> statement.","source":"Open the `MarqueeControlRootDesigner` source file in the **Code Editor** and place a breakpoint on the <xref:System.Diagnostics.Trace.WriteLine%2A> statement."},{"content":"Press F5 to start the debugging session.","pos":[12101,12141]},{"content":"Note that a new instance of Visual Studio is created.","pos":[12142,12195]},{"content":"In the new instance of Visual Studio, open the \"MarqueeControlTest\" solution.","pos":[12200,12277]},{"content":"You can easily find the solution by selecting <bpt id=\"p1\">**</bpt>Recent Projects<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu.","pos":[12278,12367],"source":" You can easily find the solution by selecting **Recent Projects** from the **File** menu."},{"content":"The \"MarqueeControlTest.sln\" solution file will be listed as the most recently used file.","pos":[12368,12457]},{"content":"Open the <ph id=\"ph1\">`DemoMarqueeControl`</ph> in the designer.","pos":[12462,12508],"source":"Open the `DemoMarqueeControl` in the designer."},{"content":"Note that the debugging instance of Visual Studio acquires focus and execution stops at your breakpoint.","pos":[12509,12613]},{"content":"Press F5 to continue the debugging session.","pos":[12614,12657]},{"content":"At this point, everything is in place for you to develop and debug your custom control and its associated custom designer.","pos":[12659,12781]},{"content":"The remainder of this walkthrough will concentrate on the details of implementing features of the control and the designer.","pos":[12782,12905]},{"pos":[12910,12942],"content":"Implementing Your Custom Control","linkify":"Implementing Your Custom Control","nodes":[{"content":"Implementing Your Custom Control","pos":[0,32]}]},{"content":"The <ph id=\"ph1\">`MarqueeControl`</ph> is a <ph id=\"ph2\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> with a little bit of customization.","pos":[12944,13045],"source":"The `MarqueeControl` is a <xref:System.Windows.Forms.UserControl> with a little bit of customization."},{"content":"It exposes two methods: <ph id=\"ph1\">`Start`</ph>, which starts the marquee animation, and <ph id=\"ph2\">`Stop`</ph>, which stops the animation.","pos":[13046,13153],"source":" It exposes two methods: `Start`, which starts the marquee animation, and `Stop`, which stops the animation."},{"content":"Because the <ph id=\"ph1\">`MarqueeControl`</ph> contains child controls that implement the <ph id=\"ph2\">`IMarqueeWidget`</ph> interface, <ph id=\"ph3\">`Start`</ph> and <ph id=\"ph4\">`Stop`</ph> enumerate each child control and call the <ph id=\"ph5\">`StartMarquee`</ph> and <ph id=\"ph6\">`StopMarquee`</ph> methods, respectively, on each child control that implements <ph id=\"ph7\">`IMarqueeWidget`</ph>.","pos":[13154,13426],"source":" Because the `MarqueeControl` contains child controls that implement the `IMarqueeWidget` interface, `Start` and `Stop` enumerate each child control and call the `StartMarquee` and `StopMarquee` methods, respectively, on each child control that implements `IMarqueeWidget`."},{"pos":[13428,13704],"content":"The appearance of the <ph id=\"ph1\">`MarqueeBorder`</ph> and <ph id=\"ph2\">`MarqueeText`</ph> controls is dependent on the layout, so <ph id=\"ph3\">`MarqueeControl`</ph> overrides the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.Control.OnLayout%2A&gt;</ph> method and calls <ph id=\"ph5\">&lt;xref:System.Windows.Forms.Control.PerformLayout%2A&gt;</ph> on child controls of this type.","source":"The appearance of the `MarqueeBorder` and `MarqueeText` controls is dependent on the layout, so `MarqueeControl` overrides the <xref:System.Windows.Forms.Control.OnLayout%2A> method and calls <xref:System.Windows.Forms.Control.PerformLayout%2A> on child controls of this type."},{"content":"This is the extent of the <ph id=\"ph1\">`MarqueeControl`</ph> customizations.","pos":[13706,13764],"source":"This is the extent of the `MarqueeControl` customizations."},{"content":"The run-time features are implemented by the <ph id=\"ph1\">`MarqueeBorder`</ph> and <ph id=\"ph2\">`MarqueeText`</ph> controls, and the design-time features are implemented by the <ph id=\"ph3\">`MarqueeBorderDesigner`</ph> and <ph id=\"ph4\">`MarqueeControlRootDesigner`</ph> classes.","pos":[13765,13971],"source":" The run-time features are implemented by the `MarqueeBorder` and `MarqueeText` controls, and the design-time features are implemented by the `MarqueeBorderDesigner` and `MarqueeControlRootDesigner` classes."},{"pos":[13977,14009],"content":"To implement your custom control","linkify":"To implement your custom control","nodes":[{"content":"To implement your custom control","pos":[0,32]}]},{"content":"Open the <ph id=\"ph1\">`MarqueeControl`</ph> source file in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept>.","pos":[14014,14075],"source":"Open the `MarqueeControl` source file in the **Code Editor**."},{"content":"Implement the <ph id=\"ph1\">`Start`</ph> and <ph id=\"ph2\">`Stop`</ph> methods.","pos":[14076,14117],"source":" Implement the `Start` and `Stop` methods."},{"pos":[14123,14493],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#260](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrol.cs#260)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#260](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrol.vb#260)]","leadings":["","   "],"nodes":[]},{"pos":[14498,14566],"content":"Override the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.OnLayout%2A&gt;</ph> method.","source":"Override the <xref:System.Windows.Forms.Control.OnLayout%2A> method."},{"pos":[14572,14942],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#270](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrol.cs#270)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#270](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrol.vb#270)]","leadings":["","   "],"nodes":[]},{"pos":[14947,14995],"content":"Creating a Child Control for Your Custom Control","linkify":"Creating a Child Control for Your Custom Control","nodes":[{"content":"Creating a Child Control for Your Custom Control","pos":[0,48]}]},{"pos":[14997,15114],"content":"The <ph id=\"ph1\">`MarqueeControl`</ph> will host two kinds of child control: the <ph id=\"ph2\">`MarqueeBorder`</ph> control and the <ph id=\"ph3\">`MarqueeText`</ph> control.","source":"The `MarqueeControl` will host two kinds of child control: the `MarqueeBorder` control and the `MarqueeText` control."},{"content":"<ph id=\"ph1\">`MarqueeBorder`</ph>: This control paints a border of \"lights\" around its edges.","pos":[15118,15193],"source":"`MarqueeBorder`: This control paints a border of \"lights\" around its edges."},{"content":"The lights flash in sequence, so they appear to be moving around the border.","pos":[15194,15270]},{"content":"The speed at which the lights flash is controlled by a property called <ph id=\"ph1\">`UpdatePeriod`</ph>.","pos":[15271,15357],"source":" The speed at which the lights flash is controlled by a property called `UpdatePeriod`."},{"content":"Several other custom properties determine other aspects of the control's appearance.","pos":[15358,15442]},{"content":"Two methods, called <ph id=\"ph1\">`StartMarquee`</ph> and <ph id=\"ph2\">`StopMarquee`</ph>, control when the animation starts and stops.","pos":[15443,15541],"source":" Two methods, called `StartMarquee` and `StopMarquee`, control when the animation starts and stops."},{"content":"<ph id=\"ph1\">`MarqueeText`</ph>: This control paints a flashing string.","pos":[15545,15598],"source":"`MarqueeText`: This control paints a flashing string."},{"content":"Like the <ph id=\"ph1\">`MarqueeBorder`</ph> control, the speed at which the text flashes is controlled by the <ph id=\"ph2\">`UpdatePeriod`</ph> property.","pos":[15599,15714],"source":" Like the `MarqueeBorder` control, the speed at which the text flashes is controlled by the `UpdatePeriod` property."},{"content":"The <ph id=\"ph1\">`MarqueeText`</ph> control also has the <ph id=\"ph2\">`StartMarquee`</ph> and <ph id=\"ph3\">`StopMarquee`</ph> methods in common with the <ph id=\"ph4\">`MarqueeBorder`</ph> control.","pos":[15715,15838],"source":" The `MarqueeText` control also has the `StartMarquee` and `StopMarquee` methods in common with the `MarqueeBorder` control."},{"pos":[15840,15973],"content":"At design time, the <ph id=\"ph1\">`MarqueeControlRootDesigner`</ph> allows these two control types to be added to a <ph id=\"ph2\">`MarqueeControl`</ph> in any combination.","source":"At design time, the `MarqueeControlRootDesigner` allows these two control types to be added to a `MarqueeControl` in any combination."},{"content":"Common features of the two controls are factored into an interface called <ph id=\"ph1\">`IMarqueeWidget`</ph>.","pos":[15975,16066],"source":"Common features of the two controls are factored into an interface called `IMarqueeWidget`."},{"content":"This allows the <ph id=\"ph1\">`MarqueeControl`</ph> to discover any Marquee-related child controls and give them special treatment.","pos":[16067,16179],"source":" This allows the `MarqueeControl` to discover any Marquee-related child controls and give them special treatment."},{"content":"To implement the periodic animation feature, you will use <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> objects from the <ph id=\"ph2\">&lt;xref:System.ComponentModel?displayProperty=nameWithType&gt;</ph> namespace.","pos":[16181,16370],"source":"To implement the periodic animation feature, you will use <xref:System.ComponentModel.BackgroundWorker> objects from the <xref:System.ComponentModel?displayProperty=nameWithType> namespace."},{"content":"You could use <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Timer&gt;</ph> objects, but when many <ph id=\"ph2\">`IMarqueeWidget`</ph> objects are present, the single UI thread may be unable to keep up with the animation.","pos":[16371,16545],"source":" You could use <xref:System.Windows.Forms.Timer> objects, but when many `IMarqueeWidget` objects are present, the single UI thread may be unable to keep up with the animation."},{"pos":[16551,16600],"content":"To create a child control for your custom control","linkify":"To create a child control for your custom control","nodes":[{"content":"To create a child control for your custom control","pos":[0,49]}]},{"content":"Add a new class item to the <ph id=\"ph1\">`MarqueeControlLibrary`</ph> project.","pos":[16605,16665],"source":"Add a new class item to the `MarqueeControlLibrary` project."},{"content":"Give the new source file a base name of \"IMarqueeWidget.\"","pos":[16666,16723]},{"pos":[16728,16844],"content":"Open the <ph id=\"ph1\">`IMarqueeWidget`</ph> source file in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept> and change the declaration from <ph id=\"ph2\">`class`</ph> to <ph id=\"ph3\">`interface`</ph>:","source":"Open the `IMarqueeWidget` source file in the **Code Editor** and change the declaration from `class` to `interface`:"},{"pos":[16850,17212],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/imarqueewidget.cs#2)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/imarqueewidget.vb#2)]","leadings":["","   "],"nodes":[]},{"pos":[17217,17349],"content":"Add the following code to the <ph id=\"ph1\">`IMarqueeWidget`</ph> interface to expose two methods and a property that manipulate the marquee animation:","source":"Add the following code to the `IMarqueeWidget` interface to expose two methods and a property that manipulate the marquee animation:"},{"pos":[17355,17717],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/imarqueewidget.cs#3)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/imarqueewidget.vb#3)]","leadings":["","   "],"nodes":[]},{"content":"Add a new <bpt id=\"p1\">**</bpt>Custom Control<ept id=\"p1\">**</ept> item to the <ph id=\"ph1\">`MarqueeControlLibrary`</ph> project.","pos":[17722,17795],"source":"Add a new **Custom Control** item to the `MarqueeControlLibrary` project."},{"content":"Give the new source file a base name of \"MarqueeText.\"","pos":[17796,17850]},{"content":"Drag a <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component from the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> onto your <ph id=\"ph2\">`MarqueeText`</ph> control.","pos":[17855,17971],"source":"Drag a <xref:System.ComponentModel.BackgroundWorker> component from the **Toolbox** onto your `MarqueeText` control."},{"content":"This component will allow the <ph id=\"ph1\">`MarqueeText`</ph> control to update itself asynchronously.","pos":[17972,18056],"source":" This component will allow the `MarqueeText` control to update itself asynchronously."},{"content":"In the Properties window, set the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component's <ph id=\"ph2\">`WorkerReportsProgress`</ph> and <ph id=\"ph3\">&lt;xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A&gt;</ph> properties to <ph id=\"ph4\">`true`</ph>.","pos":[18061,18278],"source":"In the Properties window, set the <xref:System.ComponentModel.BackgroundWorker> component's `WorkerReportsProgress` and <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> properties to `true`."},{"content":"These settings allow the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component to periodically raise the <ph id=\"ph2\">&lt;xref:System.ComponentModel.BackgroundWorker.ProgressChanged&gt;</ph> event and to cancel asynchronous updates.","pos":[18279,18489],"source":" These settings allow the <xref:System.ComponentModel.BackgroundWorker> component to periodically raise the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event and to cancel asynchronous updates."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>BackgroundWorker Component<ept id=\"p1\">](backgroundworker-component.md)</ept>.","pos":[18490,18576],"source":" For more information, see [BackgroundWorker Component](backgroundworker-component.md)."},{"content":"Open the <ph id=\"ph1\">`MarqueeText`</ph> source file in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept>.","pos":[18581,18639],"source":"Open the `MarqueeText` source file in the **Code Editor**."},{"content":"At the top of the file, import the following namespaces:","pos":[18640,18696]},{"pos":[18702,19066],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#120](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#120)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#120](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#120)]","leadings":["","   "],"nodes":[]},{"pos":[19071,19209],"content":"Change the declaration of <ph id=\"ph1\">`MarqueeText`</ph> to inherit from <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Label&gt;</ph> and to implement the <ph id=\"ph3\">`IMarqueeWidget`</ph> interface:","source":"Change the declaration of `MarqueeText` to inherit from <xref:System.Windows.Forms.Label> and to implement the `IMarqueeWidget` interface:"},{"pos":[19215,19579],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#130](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#130)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#130](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#130)]","leadings":["","   "],"nodes":[]},{"content":"Declare the instance variables that correspond to the exposed properties, and initialize them in the constructor.","pos":[19584,19697]},{"content":"The <ph id=\"ph1\">`isLit`</ph> field determines if the text is to be painted in the color given by the <ph id=\"ph2\">`LightColor`</ph> property.","pos":[19698,19804],"source":" The `isLit` field determines if the text is to be painted in the color given by the `LightColor` property."},{"pos":[19810,20174],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#140](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#140)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#140](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#140)]","leadings":["","   "],"nodes":[]},{"pos":[20180,20221],"content":"Implement the <ph id=\"ph1\">`IMarqueeWidget`</ph> interface.","source":"Implement the `IMarqueeWidget` interface."},{"pos":[20227,20510],"content":"The <ph id=\"ph1\">`StartMarquee`</ph> and <ph id=\"ph2\">`StopMarquee`</ph> methods invoke the <ph id=\"ph3\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component's <ph id=\"ph4\">&lt;xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A&gt;</ph> and <ph id=\"ph5\">&lt;xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A&gt;</ph> methods to start and stop the animation.","source":"The `StartMarquee` and `StopMarquee` methods invoke the <xref:System.ComponentModel.BackgroundWorker> component's <xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A> and <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> methods to start and stop the animation."},{"pos":[20516,20774],"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.CategoryAttribute.Category%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ComponentModel.BrowsableAttribute.Browsable%2A&gt;</ph> attributes are applied to the <ph id=\"ph3\">`UpdatePeriod`</ph> property so it appears in a custom section of the Properties window called \"Marquee.\"","source":"The <xref:System.ComponentModel.CategoryAttribute.Category%2A> and <xref:System.ComponentModel.BrowsableAttribute.Browsable%2A> attributes are applied to the `UpdatePeriod` property so it appears in a custom section of the Properties window called \"Marquee.\""},{"pos":[20780,21144],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#150](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#150)]\n[!code-vb[System.Windows.Forms.Design.DocumentDesigner#150](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#150)]","leadings":["","    "],"nodes":[]},{"content":"Implement the property accessors.","pos":[21150,21183]},{"content":"You will expose two properties to clients: <ph id=\"ph1\">`LightColor`</ph> and <ph id=\"ph2\">`DarkColor`</ph>.","pos":[21184,21256],"source":" You will expose two properties to clients: `LightColor` and `DarkColor`."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.CategoryAttribute.Category%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ComponentModel.BrowsableAttribute.Browsable%2A&gt;</ph> attributes are applied to these properties, so the properties appear in a custom section of the Properties window called \"Marquee.\"","pos":[21257,21516],"source":" The <xref:System.ComponentModel.CategoryAttribute.Category%2A> and <xref:System.ComponentModel.BrowsableAttribute.Browsable%2A> attributes are applied to these properties, so the properties appear in a custom section of the Properties window called \"Marquee.\""},{"pos":[21522,21886],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#160](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#160)]\n[!code-vb[System.Windows.Forms.Design.DocumentDesigner#160](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#160)]","leadings":["","    "],"nodes":[]},{"pos":[21892,22107],"content":"Implement the handlers for the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component's <ph id=\"ph2\">&lt;xref:System.ComponentModel.BackgroundWorker.DoWork&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.ComponentModel.BackgroundWorker.ProgressChanged&gt;</ph> events.","source":"Implement the handlers for the <xref:System.ComponentModel.BackgroundWorker> component's <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> events."},{"pos":[22113,22443],"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.DoWork&gt;</ph> event handler sleeps for the number of milliseconds specified by <ph id=\"ph2\">`UpdatePeriod`</ph> then raises the <ph id=\"ph3\">&lt;xref:System.ComponentModel.BackgroundWorker.ProgressChanged&gt;</ph> event, until your code stops the animation by calling <ph id=\"ph4\">&lt;xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A&gt;</ph>.","source":"The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler sleeps for the number of milliseconds specified by `UpdatePeriod` then raises the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event, until your code stops the animation by calling <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A>."},{"pos":[22449,22614],"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.ProgressChanged&gt;</ph> event handler toggles the text between its light and dark state to give the appearance of flashing.","source":"The <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event handler toggles the text between its light and dark state to give the appearance of flashing."},{"pos":[22620,22984],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#180](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#180)]\n[!code-vb[System.Windows.Forms.Design.DocumentDesigner#180](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#180)]","leadings":["","    "],"nodes":[]},{"pos":[22990,23081],"content":"Override the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.OnPaint%2A&gt;</ph> method to enable the animation.","source":"Override the <xref:System.Windows.Forms.Control.OnPaint%2A> method to enable the animation."},{"pos":[23087,23451],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#170](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#170)]\n[!code-vb[System.Windows.Forms.Design.DocumentDesigner#170](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#170)]","leadings":["","    "],"nodes":[]},{"content":"Press F6 to build the solution.","pos":[23457,23488]},{"pos":[23493,23531],"content":"Create the MarqueeBorder Child Control","linkify":"Create the MarqueeBorder Child Control","nodes":[{"content":"Create the MarqueeBorder Child Control","pos":[0,38]}]},{"content":"The <ph id=\"ph1\">`MarqueeBorder`</ph> control is slightly more sophisticated than the <ph id=\"ph2\">`MarqueeText`</ph> control.","pos":[23533,23623],"source":"The `MarqueeBorder` control is slightly more sophisticated than the `MarqueeText` control."},{"content":"It has more properties and the animation in the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.OnPaint%2A&gt;</ph> method is more involved.","pos":[23624,23743],"source":" It has more properties and the animation in the <xref:System.Windows.Forms.Control.OnPaint%2A> method is more involved."},{"content":"In principle, it is quite similar to the <ph id=\"ph1\">`MarqueeText`</ph> control.","pos":[23744,23807],"source":" In principle, it is quite similar to the `MarqueeText` control."},{"pos":[23809,23944],"content":"Because the <ph id=\"ph1\">`MarqueeBorder`</ph> control can have child controls, it needs to be aware of <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Layout&gt;</ph> events.","source":"Because the `MarqueeBorder` control can have child controls, it needs to be aware of <xref:System.Windows.Forms.Control.Layout> events."},{"pos":[23950,23985],"content":"To create the MarqueeBorder control","linkify":"To create the MarqueeBorder control","nodes":[{"content":"To create the MarqueeBorder control","pos":[0,35]}]},{"content":"Add a new <bpt id=\"p1\">**</bpt>Custom Control<ept id=\"p1\">**</ept> item to the <ph id=\"ph1\">`MarqueeControlLibrary`</ph> project.","pos":[23990,24063],"source":"Add a new **Custom Control** item to the `MarqueeControlLibrary` project."},{"content":"Give the new source file a base name of \"MarqueeBorder.\"","pos":[24064,24120]},{"content":"Drag a <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component from the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> onto your <ph id=\"ph2\">`MarqueeBorder`</ph> control.","pos":[24125,24243],"source":"Drag a <xref:System.ComponentModel.BackgroundWorker> component from the **Toolbox** onto your `MarqueeBorder` control."},{"content":"This component will allow the <ph id=\"ph1\">`MarqueeBorder`</ph> control to update itself asynchronously.","pos":[24244,24330],"source":" This component will allow the `MarqueeBorder` control to update itself asynchronously."},{"content":"In the Properties window, set the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component's <ph id=\"ph2\">`WorkerReportsProgress`</ph> and <ph id=\"ph3\">&lt;xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A&gt;</ph> properties to <ph id=\"ph4\">`true`</ph>.","pos":[24335,24552],"source":"In the Properties window, set the <xref:System.ComponentModel.BackgroundWorker> component's `WorkerReportsProgress` and <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> properties to `true`."},{"content":"These settings allow the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component to periodically raise the <ph id=\"ph2\">&lt;xref:System.ComponentModel.BackgroundWorker.ProgressChanged&gt;</ph> event and to cancel asynchronous updates.","pos":[24553,24763],"source":" These settings allow the <xref:System.ComponentModel.BackgroundWorker> component to periodically raise the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event and to cancel asynchronous updates."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>BackgroundWorker Component<ept id=\"p1\">](backgroundworker-component.md)</ept>.","pos":[24764,24850],"source":" For more information, see [BackgroundWorker Component](backgroundworker-component.md)."},{"content":"In the Properties window, click the Events button.","pos":[24855,24905]},{"content":"Attach handlers for the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.DoWork&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.ComponentModel.BackgroundWorker.ProgressChanged&gt;</ph> events.","pos":[24906,25056],"source":" Attach handlers for the <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> events."},{"content":"Open the <ph id=\"ph1\">`MarqueeBorder`</ph> source file in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept>.","pos":[25061,25121],"source":"Open the `MarqueeBorder` source file in the **Code Editor**."},{"content":"At the top of the file, import the following namespaces:","pos":[25122,25178]},{"pos":[25184,25548],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#20](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#20)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#20](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#20)]","leadings":["","   "],"nodes":[]},{"pos":[25553,25693],"content":"Change the declaration of <ph id=\"ph1\">`MarqueeBorder`</ph> to inherit from <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Panel&gt;</ph> and to implement the <ph id=\"ph3\">`IMarqueeWidget`</ph> interface.","source":"Change the declaration of `MarqueeBorder` to inherit from <xref:System.Windows.Forms.Panel> and to implement the `IMarqueeWidget` interface."},{"pos":[25699,26063],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#30](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#30)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#30](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#30)]","leadings":["","   "],"nodes":[]},{"content":"Declare two enumerations for managing the <ph id=\"ph1\">`MarqueeBorder`</ph> control's state: <ph id=\"ph2\">`MarqueeSpinDirection`</ph>, which determines the direction in which the lights \"spin\" around the border, and <ph id=\"ph3\">`MarqueeLightShape`</ph>, which determines the shape of the lights (square or circular).","pos":[26068,26331],"source":"Declare two enumerations for managing the `MarqueeBorder` control's state: `MarqueeSpinDirection`, which determines the direction in which the lights \"spin\" around the border, and `MarqueeLightShape`, which determines the shape of the lights (square or circular)."},{"content":"Place these declarations before the <ph id=\"ph1\">`MarqueeBorder`</ph> class declaration.","pos":[26332,26402],"source":" Place these declarations before the `MarqueeBorder` class declaration."},{"pos":[26408,26772],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#97](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#97)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#97](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#97)]","leadings":["","   "],"nodes":[]},{"content":"Declare the instance variables that correspond to the exposed properties, and initialize them in the constructor.","pos":[26777,26890]},{"pos":[26896,27260],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#40](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#40)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#40](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#40)]","leadings":["","   "],"nodes":[]},{"pos":[27265,27306],"content":"Implement the <ph id=\"ph1\">`IMarqueeWidget`</ph> interface.","source":"Implement the `IMarqueeWidget` interface."},{"pos":[27312,27595],"content":"The <ph id=\"ph1\">`StartMarquee`</ph> and <ph id=\"ph2\">`StopMarquee`</ph> methods invoke the <ph id=\"ph3\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component's <ph id=\"ph4\">&lt;xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A&gt;</ph> and <ph id=\"ph5\">&lt;xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A&gt;</ph> methods to start and stop the animation.","source":"The `StartMarquee` and `StopMarquee` methods invoke the <xref:System.ComponentModel.BackgroundWorker> component's <xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A> and <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> methods to start and stop the animation."},{"content":"Because the <ph id=\"ph1\">`MarqueeBorder`</ph> control can contain child controls, the <ph id=\"ph2\">`StartMarquee`</ph> method enumerates all child controls and calls <ph id=\"ph3\">`StartMarquee`</ph> on those that implement <ph id=\"ph4\">`IMarqueeWidget`</ph>.","pos":[27601,27787],"source":"Because the `MarqueeBorder` control can contain child controls, the `StartMarquee` method enumerates all child controls and calls `StartMarquee` on those that implement `IMarqueeWidget`."},{"content":"The <ph id=\"ph1\">`StopMarquee`</ph> method has a similar implementation.","pos":[27788,27842],"source":" The `StopMarquee` method has a similar implementation."},{"pos":[27848,28212],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#50](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#50)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#50](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#50)]","leadings":["","   "],"nodes":[]},{"content":"Implement the property accessors.","pos":[28218,28251]},{"content":"The <ph id=\"ph1\">`MarqueeBorder`</ph> control has several properties for controlling its appearance.","pos":[28252,28334],"source":" The `MarqueeBorder` control has several properties for controlling its appearance."},{"pos":[28340,28704],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#60](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#60)]\n[!code-vb[System.Windows.Forms.Design.DocumentDesigner#60](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#60)]","leadings":["","    "],"nodes":[]},{"pos":[28710,28925],"content":"Implement the handlers for the <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker&gt;</ph> component's <ph id=\"ph2\">&lt;xref:System.ComponentModel.BackgroundWorker.DoWork&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.ComponentModel.BackgroundWorker.ProgressChanged&gt;</ph> events.","source":"Implement the handlers for the <xref:System.ComponentModel.BackgroundWorker> component's <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> events."},{"pos":[28931,29261],"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.DoWork&gt;</ph> event handler sleeps for the number of milliseconds specified by <ph id=\"ph2\">`UpdatePeriod`</ph> then raises the <ph id=\"ph3\">&lt;xref:System.ComponentModel.BackgroundWorker.ProgressChanged&gt;</ph> event, until your code stops the animation by calling <ph id=\"ph4\">&lt;xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A&gt;</ph>.","source":"The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler sleeps for the number of milliseconds specified by `UpdatePeriod` then raises the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event, until your code stops the animation by calling <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A>."},{"pos":[29267,29566],"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.BackgroundWorker.ProgressChanged&gt;</ph> event handler increments the position of the \"base\" light, from which the light/dark state of the other lights is determined, and calls the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Refresh%2A&gt;</ph> method to cause the control to repaint itself.","source":"The <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event handler increments the position of the \"base\" light, from which the light/dark state of the other lights is determined, and calls the <xref:System.Windows.Forms.Control.Refresh%2A> method to cause the control to repaint itself."},{"pos":[29572,29936],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#90](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#90)]\n[!code-vb[System.Windows.Forms.Design.DocumentDesigner#90](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#90)]","leadings":["","    "],"nodes":[]},{"pos":[29942,29996],"content":"Implement the helper methods, <ph id=\"ph1\">`IsLit`</ph> and <ph id=\"ph2\">`DrawLight`</ph>.","source":"Implement the helper methods, `IsLit` and `DrawLight`."},{"content":"The <ph id=\"ph1\">`IsLit`</ph> method determines the color of a light at a given position.","pos":[30002,30073],"source":"The `IsLit` method determines the color of a light at a given position."},{"content":"Lights that are \"lit\" are drawn in the color given by the <ph id=\"ph1\">`LightColor`</ph> property, and those that are \"dark\" are drawn in the color given by the <ph id=\"ph2\">`DarkColor`</ph> property.","pos":[30074,30238],"source":" Lights that are \"lit\" are drawn in the color given by the `LightColor` property, and those that are \"dark\" are drawn in the color given by the `DarkColor` property."},{"pos":[30244,30330],"content":"The <ph id=\"ph1\">`DrawLight`</ph> method draws a light using the appropriate color, shape, and position.","source":"The `DrawLight` method draws a light using the appropriate color, shape, and position."},{"pos":[30336,30700],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#80](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#80)]\n[!code-vb[System.Windows.Forms.Design.DocumentDesigner#80](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#80)]","leadings":["","    "],"nodes":[]},{"pos":[30706,30826],"content":"Override the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.OnLayout%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.OnPaint%2A&gt;</ph> methods.","source":"Override the <xref:System.Windows.Forms.Control.OnLayout%2A> and <xref:System.Windows.Forms.Control.OnPaint%2A> methods."},{"pos":[30832,30954],"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.OnPaint%2A&gt;</ph> method draws the lights along the edges of the <ph id=\"ph2\">`MarqueeBorder`</ph> control.","source":"The <xref:System.Windows.Forms.Control.OnPaint%2A> method draws the lights along the edges of the `MarqueeBorder` control."},{"content":"Because the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.OnPaint%2A&gt;</ph> method depends on the dimensions of the <ph id=\"ph2\">`MarqueeBorder`</ph> control, you need to call it whenever the layout changes.","pos":[30960,31132],"source":"Because the <xref:System.Windows.Forms.Control.OnPaint%2A> method depends on the dimensions of the `MarqueeBorder` control, you need to call it whenever the layout changes."},{"content":"To achieve this, override <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.OnLayout%2A&gt;</ph> and call <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Refresh%2A&gt;</ph>.","pos":[31133,31263],"source":" To achieve this, override <xref:System.Windows.Forms.Control.OnLayout%2A> and call <xref:System.Windows.Forms.Control.Refresh%2A>."},{"pos":[31269,31633],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#70](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#70)]\n[!code-vb[System.Windows.Forms.Design.DocumentDesigner#70](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#70)]","leadings":["","    "],"nodes":[]},{"pos":[31638,31696],"content":"Creating a Custom Designer to Shadow and Filter Properties","linkify":"Creating a Custom Designer to Shadow and Filter Properties","nodes":[{"content":"Creating a Custom Designer to Shadow and Filter Properties","pos":[0,58]}]},{"content":"The <ph id=\"ph1\">`MarqueeControlRootDesigner`</ph> class provides the implementation for the root designer.","pos":[31698,31787],"source":"The `MarqueeControlRootDesigner` class provides the implementation for the root designer."},{"content":"In addition to this designer, which operates on the <ph id=\"ph1\">`MarqueeControl`</ph>, you will need a custom designer that is specifically associated with the <ph id=\"ph2\">`MarqueeBorder`</ph> control.","pos":[31788,31955],"source":" In addition to this designer, which operates on the `MarqueeControl`, you will need a custom designer that is specifically associated with the `MarqueeBorder` control."},{"content":"This designer provides custom behavior that is appropriate in the context of the custom root designer.","pos":[31956,32058]},{"pos":[32060,32233],"content":"Specifically, the <ph id=\"ph1\">`MarqueeBorderDesigner`</ph> will \"shadow\" and filter certain properties on the <ph id=\"ph2\">`MarqueeBorder`</ph> control, changing their interaction with the design environment.","source":"Specifically, the `MarqueeBorderDesigner` will \"shadow\" and filter certain properties on the `MarqueeBorder` control, changing their interaction with the design environment."},{"content":"Intercepting calls to a component's property accessor is known as \"shadowing.\"","pos":[32235,32313]},{"content":"It allows a designer to track the value set by the user and optionally pass that value to the component being designed.","pos":[32314,32433]},{"pos":[32435,32720],"content":"For this example, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Visible%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Enabled%2A&gt;</ph> properties will be shadowed by the <ph id=\"ph3\">`MarqueeBorderDesigner`</ph>, which prevents the user from making the <ph id=\"ph4\">`MarqueeBorder`</ph> control invisible or disabled during design time.","source":"For this example, the <xref:System.Windows.Forms.Control.Visible%2A> and <xref:System.Windows.Forms.Control.Enabled%2A> properties will be shadowed by the `MarqueeBorderDesigner`, which prevents the user from making the `MarqueeBorder` control invisible or disabled during design time."},{"content":"Designers can also add and remove properties.","pos":[32722,32767]},{"content":"For this example, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Padding%2A&gt;</ph> property will be removed at design time, because the <ph id=\"ph2\">`MarqueeBorder`</ph> control programmatically sets the padding based on the size of the lights specified by the <ph id=\"ph3\">`LightSize`</ph> property.","pos":[32768,33018],"source":" For this example, the <xref:System.Windows.Forms.Control.Padding%2A> property will be removed at design time, because the `MarqueeBorder` control programmatically sets the padding based on the size of the lights specified by the `LightSize` property."},{"pos":[33020,33230],"content":"The base class for <ph id=\"ph1\">`MarqueeBorderDesigner`</ph> is <ph id=\"ph2\">&lt;xref:System.ComponentModel.Design.ComponentDesigner&gt;</ph>, which has methods that can change the attributes, properties, and events exposed by a control at design time:","source":"The base class for `MarqueeBorderDesigner` is <xref:System.ComponentModel.Design.ComponentDesigner>, which has methods that can change the attributes, properties, and events exposed by a control at design time:"},{"content":"When changing the public interface of a component using these methods, you must follow these rules:","pos":[33707,33806]},{"pos":[33810,33861],"content":"Add or remove items in the <ph id=\"ph1\">`PreFilter`</ph> methods only","source":"Add or remove items in the `PreFilter` methods only"},{"pos":[33865,33919],"content":"Modify existing items in the <ph id=\"ph1\">`PostFilter`</ph> methods only","source":"Modify existing items in the `PostFilter` methods only"},{"pos":[33923,33991],"content":"Always call the base implementation first in the <ph id=\"ph1\">`PreFilter`</ph> methods","source":"Always call the base implementation first in the `PreFilter` methods"},{"pos":[33995,34063],"content":"Always call the base implementation last in the <ph id=\"ph1\">`PostFilter`</ph> methods","source":"Always call the base implementation last in the `PostFilter` methods"},{"content":"Adhering to these rules ensures that all designers in the design-time environment have a consistent view of all components being designed.","pos":[34065,34203]},{"pos":[34205,34408],"content":"The <ph id=\"ph1\">&lt;xref:System.ComponentModel.Design.ComponentDesigner&gt;</ph> class provides a dictionary for managing the values of shadowed properties, which relieves you of the need to create specific instance variables.","source":"The <xref:System.ComponentModel.Design.ComponentDesigner> class provides a dictionary for managing the values of shadowed properties, which relieves you of the need to create specific instance variables."},{"pos":[34414,34473],"content":"To create a custom designer to shadow and filter properties","linkify":"To create a custom designer to shadow and filter properties","nodes":[{"content":"To create a custom designer to shadow and filter properties","pos":[0,59]}]},{"content":"Right-click the <bpt id=\"p1\">**</bpt>Design<ept id=\"p1\">**</ept> folder and add a new class.","pos":[34478,34532],"source":"Right-click the **Design** folder and add a new class."},{"content":"Give the source file a base name of \"MarqueeBorderDesigner.\"","pos":[34533,34593]},{"content":"Open the <ph id=\"ph1\">`MarqueeBorderDesigner`</ph> source file in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept>.","pos":[34598,34666],"source":"Open the `MarqueeBorderDesigner` source file in the **Code Editor**."},{"content":"At the top of the file, import the following namespaces:","pos":[34667,34723]},{"pos":[34729,35113],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#420](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborderdesigner.cs#420)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#420](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborderdesigner.vb#420)]","leadings":["","   "],"nodes":[]},{"pos":[35118,35241],"content":"Change the declaration of <ph id=\"ph1\">`MarqueeBorderDesigner`</ph> to inherit from <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Design.ParentControlDesigner&gt;</ph>.","source":"Change the declaration of `MarqueeBorderDesigner` to inherit from <xref:System.Windows.Forms.Design.ParentControlDesigner>."},{"pos":[35247,35450],"content":"Because the <ph id=\"ph1\">`MarqueeBorder`</ph> control can contain child controls, <ph id=\"ph2\">`MarqueeBorderDesigner`</ph> inherits from <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Design.ParentControlDesigner&gt;</ph>, which handles the parent-child interaction.","source":"Because the `MarqueeBorder` control can contain child controls, `MarqueeBorderDesigner` inherits from <xref:System.Windows.Forms.Design.ParentControlDesigner>, which handles the parent-child interaction."},{"pos":[35456,35840],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#430](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborderdesigner.cs#430)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#430](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborderdesigner.vb#430)]","leadings":["","   "],"nodes":[]},{"pos":[35845,35958],"content":"Override the base implementation of <ph id=\"ph1\">&lt;xref:System.ComponentModel.Design.ComponentDesigner.PreFilterProperties%2A&gt;</ph>.","source":"Override the base implementation of <xref:System.ComponentModel.Design.ComponentDesigner.PreFilterProperties%2A>."},{"pos":[35964,36348],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#450](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborderdesigner.cs#450)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#450](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborderdesigner.vb#450)]","leadings":["","   "],"nodes":[]},{"content":"Implement the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Enabled%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Visible%2A&gt;</ph> properties.","pos":[36353,36476],"source":"Implement the <xref:System.Windows.Forms.Control.Enabled%2A> and <xref:System.Windows.Forms.Control.Visible%2A> properties."},{"content":"These implementations shadow the control's properties.","pos":[36477,36531]},{"pos":[36537,36921],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#440](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborderdesigner.cs#440)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#440](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborderdesigner.vb#440)]","leadings":["","   "],"nodes":[]},{"pos":[36926,36952],"content":"Handling Component Changes","linkify":"Handling Component Changes","nodes":[{"content":"Handling Component Changes","pos":[0,26]}]},{"content":"The <ph id=\"ph1\">`MarqueeControlRootDesigner`</ph> class provides the custom design-time experience for your <ph id=\"ph2\">`MarqueeControl`</ph> instances.","pos":[36954,37072],"source":"The `MarqueeControlRootDesigner` class provides the custom design-time experience for your `MarqueeControl` instances."},{"content":"Most of the design-time functionality is inherited from the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Design.DocumentDesigner&gt;</ph> class; your code will implement two specific customizations: handling component changes, and adding designer verbs.","pos":[37073,37300],"source":" Most of the design-time functionality is inherited from the <xref:System.Windows.Forms.Design.DocumentDesigner> class; your code will implement two specific customizations: handling component changes, and adding designer verbs."},{"content":"As users design their <ph id=\"ph1\">`MarqueeControl`</ph> instances, your root designer will track changes to the <ph id=\"ph2\">`MarqueeControl`</ph> and its child controls.","pos":[37303,37438],"source":"As users design their `MarqueeControl` instances, your root designer will track changes to the `MarqueeControl` and its child controls."},{"content":"The design-time environment offers a convenient service, <ph id=\"ph1\">&lt;xref:System.ComponentModel.Design.IComponentChangeService&gt;</ph>, for tracking changes to component state.","pos":[37439,37597],"source":" The design-time environment offers a convenient service, <xref:System.ComponentModel.Design.IComponentChangeService>, for tracking changes to component state."},{"content":"You acquire a reference to this service by querying the environment with the <ph id=\"ph1\">&lt;xref:System.ComponentModel.Design.ComponentDesigner.GetService%2A&gt;</ph> method.","pos":[37600,37752],"source":"You acquire a reference to this service by querying the environment with the <xref:System.ComponentModel.Design.ComponentDesigner.GetService%2A> method."},{"content":"If the query is successful, your designer can attach a handler for the <ph id=\"ph1\">&lt;xref:System.ComponentModel.Design.IComponentChangeService.ComponentChanged&gt;</ph> event and perform whatever tasks are required to maintain a consistent state at design time.","pos":[37753,37993],"source":" If the query is successful, your designer can attach a handler for the <xref:System.ComponentModel.Design.IComponentChangeService.ComponentChanged> event and perform whatever tasks are required to maintain a consistent state at design time."},{"content":"In the case of the <ph id=\"ph1\">`MarqueeControlRootDesigner`</ph> class, you will call the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Refresh%2A&gt;</ph> method on each <ph id=\"ph3\">`IMarqueeWidget`</ph> object contained by the <ph id=\"ph4\">`MarqueeControl`</ph>.","pos":[37996,38189],"source":"In the case of the `MarqueeControlRootDesigner` class, you will call the <xref:System.Windows.Forms.Control.Refresh%2A> method on each `IMarqueeWidget` object contained by the `MarqueeControl`."},{"content":"This will cause the <ph id=\"ph1\">`IMarqueeWidget`</ph> object to repaint itself appropriately when properties like its parent's <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Size%2A&gt;</ph> are changed.","pos":[38190,38356],"source":" This will cause the `IMarqueeWidget` object to repaint itself appropriately when properties like its parent's <xref:System.Windows.Forms.Control.Size%2A> are changed."},{"pos":[38362,38389],"content":"To handle component changes","linkify":"To handle component changes","nodes":[{"content":"To handle component changes","pos":[0,27]}]},{"content":"Open the <ph id=\"ph1\">`MarqueeControlRootDesigner`</ph> source file in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept> and override the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A&gt;</ph> method.","pos":[38394,38557],"source":"Open the `MarqueeControlRootDesigner` source file in the **Code Editor** and override the <xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A> method."},{"content":"Call the base implementation of <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A&gt;</ph> and query for the <ph id=\"ph2\">&lt;xref:System.ComponentModel.Design.IComponentChangeService&gt;</ph>.","pos":[38558,38734],"source":" Call the base implementation of <xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A> and query for the <xref:System.ComponentModel.Design.IComponentChangeService>."},{"pos":[38740,39134],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#580](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#580)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#580](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#580)]","leadings":["","   "],"nodes":[]},{"content":"Implement the <ph id=\"ph1\">&lt;xref:System.ComponentModel.Design.IComponentChangeService.OnComponentChanged%2A&gt;</ph> event handler.","pos":[39139,39249],"source":"Implement the <xref:System.ComponentModel.Design.IComponentChangeService.OnComponentChanged%2A> event handler."},{"content":"Test the sending component's type, and if it is an <ph id=\"ph1\">`IMarqueeWidget`</ph>, call its <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Refresh%2A&gt;</ph> method.","pos":[39250,39382],"source":" Test the sending component's type, and if it is an `IMarqueeWidget`, call its <xref:System.Windows.Forms.Control.Refresh%2A> method."},{"pos":[39388,39782],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#560](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#560)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#560](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#560)]","leadings":["","   "],"nodes":[]},{"pos":[39787,39832],"content":"Adding Designer Verbs to your Custom Designer","linkify":"Adding Designer Verbs to your Custom Designer","nodes":[{"content":"Adding Designer Verbs to your Custom Designer","pos":[0,45]}]},{"content":"A designer verb is a menu command linked to an event handler.","pos":[39834,39895]},{"content":"Designer verbs are added to a component's shortcut menu at design time.","pos":[39896,39967]},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:System.ComponentModel.Design.DesignerVerb&gt;</ph>.","pos":[39968,40043],"source":" For more information, see <xref:System.ComponentModel.Design.DesignerVerb>."},{"content":"You will add two designer verbs to your designers: <bpt id=\"p1\">**</bpt>Run Test<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Stop Test<ept id=\"p2\">**</ept>.","pos":[40045,40127],"source":"You will add two designer verbs to your designers: **Run Test** and **Stop Test**."},{"content":"These verbs will allow you to view the run-time behavior of the <ph id=\"ph1\">`MarqueeControl`</ph> at design time.","pos":[40128,40224],"source":" These verbs will allow you to view the run-time behavior of the `MarqueeControl` at design time."},{"content":"These verbs will be added to the <ph id=\"ph1\">`MarqueeControlRootDesigner`</ph>.","pos":[40225,40287],"source":" These verbs will be added to the `MarqueeControlRootDesigner`."},{"content":"When <bpt id=\"p1\">**</bpt>Run Test<ept id=\"p1\">**</ept> is invoked, the verb event handler will call the <ph id=\"ph1\">`StartMarquee`</ph> method on the <ph id=\"ph2\">`MarqueeControl`</ph>.","pos":[40289,40402],"source":"When **Run Test** is invoked, the verb event handler will call the `StartMarquee` method on the `MarqueeControl`."},{"content":"When <bpt id=\"p1\">**</bpt>Stop Test<ept id=\"p1\">**</ept> is invoked, the verb event handler will call the <ph id=\"ph1\">`StopMarquee`</ph> method on the <ph id=\"ph2\">`MarqueeControl`</ph>.","pos":[40403,40516],"source":" When **Stop Test** is invoked, the verb event handler will call the `StopMarquee` method on the `MarqueeControl`."},{"content":"The implementation of the <ph id=\"ph1\">`StartMarquee`</ph> and <ph id=\"ph2\">`StopMarquee`</ph> methods call these methods on contained controls that implement <ph id=\"ph3\">`IMarqueeWidget`</ph>, so any contained <ph id=\"ph4\">`IMarqueeWidget`</ph> controls will also participate in the test.","pos":[40517,40735],"source":" The implementation of the `StartMarquee` and `StopMarquee` methods call these methods on contained controls that implement `IMarqueeWidget`, so any contained `IMarqueeWidget` controls will also participate in the test."},{"pos":[40741,40787],"content":"To add designer verbs to your custom designers","linkify":"To add designer verbs to your custom designers","nodes":[{"content":"To add designer verbs to your custom designers","pos":[0,46]}]},{"pos":[40792,40897],"content":"In the <ph id=\"ph1\">`MarqueeControlRootDesigner`</ph> class, add event handlers named <ph id=\"ph2\">`OnVerbRunTest`</ph> and <ph id=\"ph3\">`OnVerbStopTest`</ph>.","source":"In the `MarqueeControlRootDesigner` class, add event handlers named `OnVerbRunTest` and `OnVerbStopTest`."},{"pos":[40903,41297],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#570](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#570)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#570](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#570)]","leadings":["","   "],"nodes":[]},{"content":"Connect these event handlers to their corresponding designer verbs.","pos":[41302,41369]},{"content":"<ph id=\"ph1\">`MarqueeControlRootDesigner`</ph> inherits a <ph id=\"ph2\">&lt;xref:System.ComponentModel.Design.DesignerVerbCollection&gt;</ph> from its base class.","pos":[41370,41489],"source":"`MarqueeControlRootDesigner` inherits a <xref:System.ComponentModel.Design.DesignerVerbCollection> from its base class."},{"content":"You will create two new <ph id=\"ph1\">&lt;xref:System.ComponentModel.Design.DesignerVerb&gt;</ph> objects and add them to this collection in the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A&gt;</ph> method.","pos":[41490,41683],"source":" You will create two new <xref:System.ComponentModel.Design.DesignerVerb> objects and add them to this collection in the <xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A> method."},{"pos":[41689,42083],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#590](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#590)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#590](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#590)]","leadings":["","   "],"nodes":[]},{"pos":[42088,42118],"content":"Creating a Custom UITypeEditor","linkify":"Creating a Custom UITypeEditor","nodes":[{"content":"Creating a Custom UITypeEditor","pos":[0,30]}]},{"content":"When you create a custom design-time experience for users, it is often desirable to create a custom interaction with the Properties window.","pos":[42120,42259]},{"content":"You can accomplish this by creating a <ph id=\"ph1\">&lt;xref:System.Drawing.Design.UITypeEditor&gt;</ph>.","pos":[42260,42340],"source":" You can accomplish this by creating a <xref:System.Drawing.Design.UITypeEditor>."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Create a UI Type Editor<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/fd3kt7d5(v=vs.120))</ept>.","pos":[42341,42498],"source":" For more information, see [How to: Create a UI Type Editor](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/fd3kt7d5(v=vs.120))."},{"content":"The <ph id=\"ph1\">`MarqueeBorder`</ph> control exposes several properties in the Properties window.","pos":[42500,42580],"source":"The `MarqueeBorder` control exposes several properties in the Properties window."},{"content":"Two of these properties, <ph id=\"ph1\">`MarqueeSpinDirection`</ph> and <ph id=\"ph2\">`MarqueeLightShape`</ph> are represented by enumerations.","pos":[42581,42685],"source":" Two of these properties, `MarqueeSpinDirection` and `MarqueeLightShape` are represented by enumerations."},{"content":"To illustrate the use of a UI type editor, the <ph id=\"ph1\">`MarqueeLightShape`</ph> property will have an associated <ph id=\"ph2\">&lt;xref:System.Drawing.Design.UITypeEditor&gt;</ph> class.","pos":[42686,42834],"source":" To illustrate the use of a UI type editor, the `MarqueeLightShape` property will have an associated <xref:System.Drawing.Design.UITypeEditor> class."},{"pos":[42840,42873],"content":"To create a custom UI type editor","linkify":"To create a custom UI type editor","nodes":[{"content":"To create a custom UI type editor","pos":[0,33]}]},{"pos":[42878,42938],"content":"Open the <ph id=\"ph1\">`MarqueeBorder`</ph> source file in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept>.","source":"Open the `MarqueeBorder` source file in the **Code Editor**."},{"pos":[42943,43093],"content":"In the definition of the <ph id=\"ph1\">`MarqueeBorder`</ph> class, declare a class called <ph id=\"ph2\">`LightShapeEditor`</ph> that derives from <ph id=\"ph3\">&lt;xref:System.Drawing.Design.UITypeEditor&gt;</ph>.","source":"In the definition of the `MarqueeBorder` class, declare a class called `LightShapeEditor` that derives from <xref:System.Drawing.Design.UITypeEditor>."},{"pos":[43099,43463],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#96](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#96)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#96](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#96)]","leadings":["","   "],"nodes":[]},{"pos":[43468,43582],"content":"Declare an <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Design.IWindowsFormsEditorService&gt;</ph> instance variable called <ph id=\"ph2\">`editorService`</ph>.","source":"Declare an <xref:System.Windows.Forms.Design.IWindowsFormsEditorService> instance variable called `editorService`."},{"pos":[43588,43952],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#92](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#92)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#92](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#92)]","leadings":["","   "],"nodes":[]},{"content":"Override the <ph id=\"ph1\">&lt;xref:System.Drawing.Design.UITypeEditor.GetEditStyle%2A&gt;</ph> method.","pos":[43957,44035],"source":"Override the <xref:System.Drawing.Design.UITypeEditor.GetEditStyle%2A> method."},{"content":"This implementation returns <ph id=\"ph1\">&lt;xref:System.Drawing.Design.UITypeEditorEditStyle.DropDown&gt;</ph>, which tells the design environment how to display the <ph id=\"ph2\">`LightShapeEditor`</ph>.","pos":[44036,44198],"source":" This implementation returns <xref:System.Drawing.Design.UITypeEditorEditStyle.DropDown>, which tells the design environment how to display the `LightShapeEditor`."},{"pos":[44204,44568],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#93](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#93)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#93](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#93)]","leadings":["","   "],"nodes":[]},{"content":"Override the <ph id=\"ph1\">&lt;xref:System.Drawing.Design.UITypeEditor.EditValue%2A&gt;</ph> method.","pos":[44573,44648],"source":"Override the <xref:System.Drawing.Design.UITypeEditor.EditValue%2A> method."},{"content":"This implementation queries the design environment for an <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Design.IWindowsFormsEditorService&gt;</ph> object.","pos":[44649,44776],"source":" This implementation queries the design environment for an <xref:System.Windows.Forms.Design.IWindowsFormsEditorService> object."},{"content":"If successful, it creates a <ph id=\"ph1\">`LightShapeSelectionControl`</ph>.","pos":[44777,44834],"source":" If successful, it creates a `LightShapeSelectionControl`."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Design.IWindowsFormsEditorService.DropDownControl%2A&gt;</ph> method is invoked to start the <ph id=\"ph2\">`LightShapeEditor`</ph>.","pos":[44835,44970],"source":" The <xref:System.Windows.Forms.Design.IWindowsFormsEditorService.DropDownControl%2A> method is invoked to start the `LightShapeEditor`."},{"content":"The return value from this invocation is returned to the design environment.","pos":[44971,45047]},{"pos":[45053,45417],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#94](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#94)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#94](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#94)]","leadings":["","   "],"nodes":[]},{"pos":[45422,45474],"content":"Creating a View Control for your Custom UITypeEditor","linkify":"Creating a View Control for your Custom UITypeEditor","nodes":[{"content":"Creating a View Control for your Custom UITypeEditor","pos":[0,52]}]},{"content":"The <ph id=\"ph1\">`MarqueeLightShape`</ph> property supports two types of light shapes: <ph id=\"ph2\">`Square`</ph> and <ph id=\"ph3\">`Circle`</ph>.","pos":[45479,45570],"source":"The `MarqueeLightShape` property supports two types of light shapes: `Square` and `Circle`."},{"content":"You will create a custom control used solely for the purpose of graphically displaying these values in the Properties window.","pos":[45571,45696]},{"content":"This custom control will be used by your <ph id=\"ph1\">&lt;xref:System.Drawing.Design.UITypeEditor&gt;</ph> to interact with the Properties window.","pos":[45697,45819],"source":" This custom control will be used by your <xref:System.Drawing.Design.UITypeEditor> to interact with the Properties window."},{"pos":[45825,45880],"content":"To create a view control for your custom UI type editor","linkify":"To create a view control for your custom UI type editor","nodes":[{"content":"To create a view control for your custom UI type editor","pos":[0,55]}]},{"content":"Add a new <ph id=\"ph1\">&lt;xref:System.Windows.Forms.UserControl&gt;</ph> item to the <ph id=\"ph2\">`MarqueeControlLibrary`</ph> project.","pos":[45885,45979],"source":"Add a new <xref:System.Windows.Forms.UserControl> item to the `MarqueeControlLibrary` project."},{"content":"Give the new source file a base name of \"LightShapeSelectionControl.\"","pos":[45980,46049]},{"content":"Drag two <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Panel&gt;</ph> controls from the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> onto the <ph id=\"ph2\">`LightShapeSelectionControl`</ph>.","pos":[46054,46165],"source":"Drag two <xref:System.Windows.Forms.Panel> controls from the **Toolbox** onto the `LightShapeSelectionControl`."},{"content":"Name them <ph id=\"ph1\">`squarePanel`</ph> and <ph id=\"ph2\">`circlePanel`</ph>.","pos":[46166,46208],"source":" Name them `squarePanel` and `circlePanel`."},{"content":"Arrange them side by side.","pos":[46209,46235]},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Size%2A&gt;</ph> property of both <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Panel&gt;</ph> controls to (60, 60).","pos":[46236,46360],"source":" Set the <xref:System.Windows.Forms.Control.Size%2A> property of both <xref:System.Windows.Forms.Panel> controls to (60, 60)."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Location%2A&gt;</ph> property of the <ph id=\"ph2\">`squarePanel`</ph> control to (8, 10).","pos":[46361,46466],"source":" Set the <xref:System.Windows.Forms.Control.Location%2A> property of the `squarePanel` control to (8, 10)."},{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Location%2A&gt;</ph> property of the <ph id=\"ph2\">`circlePanel`</ph> control to (80, 10).","pos":[46467,46573],"source":" Set the <xref:System.Windows.Forms.Control.Location%2A> property of the `circlePanel` control to (80, 10)."},{"content":"Finally, set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Size%2A&gt;</ph> property of the <ph id=\"ph2\">`LightShapeSelectionControl`</ph> to (150, 80).","pos":[46574,46693],"source":" Finally, set the <xref:System.Windows.Forms.Control.Size%2A> property of the `LightShapeSelectionControl` to (150, 80)."},{"content":"Open the <ph id=\"ph1\">`LightShapeSelectionControl`</ph> source file in the <bpt id=\"p1\">**</bpt>Code Editor<ept id=\"p1\">**</ept>.","pos":[46698,46771],"source":"Open the `LightShapeSelectionControl` source file in the **Code Editor**."},{"content":"At the top of the file, import the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Design?displayProperty=nameWithType&gt;</ph> namespace:","pos":[46772,46881],"source":" At the top of the file, import the <xref:System.Windows.Forms.Design?displayProperty=nameWithType> namespace:"},{"content":"Implement <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handlers for the <ph id=\"ph2\">`squarePanel`</ph> and <ph id=\"ph3\">`circlePanel`</ph> controls.","pos":[46983,47099],"source":"Implement <xref:System.Windows.Forms.Control.Click> event handlers for the `squarePanel` and `circlePanel` controls."},{"content":"These methods invoke <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Design.IWindowsFormsEditorService.CloseDropDown%2A&gt;</ph> to end the custom <ph id=\"ph2\">&lt;xref:System.Drawing.Design.UITypeEditor&gt;</ph> editing session.","pos":[47100,47276],"source":" These methods invoke <xref:System.Windows.Forms.Design.IWindowsFormsEditorService.CloseDropDown%2A> to end the custom <xref:System.Drawing.Design.UITypeEditor> editing session."},{"pos":[47282,47676],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#390](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#390)]\n [!code-vb[System.Windows.Forms.Design.DocumentDesigner#390](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#390)]","leadings":["","   "],"nodes":[]},{"pos":[47681,47795],"content":"Declare an <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Design.IWindowsFormsEditorService&gt;</ph> instance variable called <ph id=\"ph2\">`editorService`</ph>.","source":"Declare an <xref:System.Windows.Forms.Design.IWindowsFormsEditorService> instance variable called `editorService`."},{"pos":[47928,48001],"content":"Declare a <ph id=\"ph1\">`MarqueeLightShape`</ph> instance variable called <ph id=\"ph2\">`lightShapeValue`</ph>.","source":"Declare a `MarqueeLightShape` instance variable called `lightShapeValue`."},{"pos":[48008,48403],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#330](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#330)]\n  [!code-vb[System.Windows.Forms.Design.DocumentDesigner#330](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#330)]","leadings":["","   "],"nodes":[]},{"content":"In the <ph id=\"ph1\">`LightShapeSelectionControl`</ph> constructor, attach the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handlers to the <ph id=\"ph3\">`squarePanel`</ph> and <ph id=\"ph4\">`circlePanel`</ph> controls' <ph id=\"ph5\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> events.","pos":[48408,48623],"source":"In the `LightShapeSelectionControl` constructor, attach the <xref:System.Windows.Forms.Control.Click> event handlers to the `squarePanel` and `circlePanel` controls' <xref:System.Windows.Forms.Control.Click> events."},{"content":"Also, define a constructor overload that assigns the <ph id=\"ph1\">`MarqueeLightShape`</ph> value from the design environment to the <ph id=\"ph2\">`lightShapeValue`</ph> field.","pos":[48624,48762],"source":" Also, define a constructor overload that assigns the `MarqueeLightShape` value from the design environment to the `lightShapeValue` field."},{"pos":[48769,49164],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#340](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#340)]\n  [!code-vb[System.Windows.Forms.Design.DocumentDesigner#340](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#340)]","leadings":["","   "],"nodes":[]},{"pos":[49169,49302],"content":"In the <ph id=\"ph1\">&lt;xref:System.ComponentModel.Component.Dispose%2A&gt;</ph> method, detach the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handlers.","source":"In the <xref:System.ComponentModel.Component.Dispose%2A> method, detach the <xref:System.Windows.Forms.Control.Click> event handlers."},{"pos":[49309,49704],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#350](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#350)]\n  [!code-vb[System.Windows.Forms.Design.DocumentDesigner#350](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#350)]","leadings":["","   "],"nodes":[]},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, click the <bpt id=\"p2\">**</bpt>Show All Files<ept id=\"p2\">**</ept> button.","pos":[49709,49771],"source":"In **Solution Explorer**, click the **Show All Files** button."},{"content":"Open the LightShapeSelectionControl.Designer.cs or LightShapeSelectionControl.Designer.vb file, and remove the default definition of the <ph id=\"ph1\">&lt;xref:System.ComponentModel.Component.Dispose%2A&gt;</ph> method.","pos":[49772,49966],"source":" Open the LightShapeSelectionControl.Designer.cs or LightShapeSelectionControl.Designer.vb file, and remove the default definition of the <xref:System.ComponentModel.Component.Dispose%2A> method."},{"pos":[49971,50007],"content":"Implement the <ph id=\"ph1\">`LightShape`</ph> property.","source":"Implement the `LightShape` property."},{"pos":[50014,50409],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#360](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#360)]\n  [!code-vb[System.Windows.Forms.Design.DocumentDesigner#360](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#360)]","leadings":["","   "],"nodes":[]},{"content":"Override the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.OnPaint%2A&gt;</ph> method.","pos":[50414,50481],"source":"Override the <xref:System.Windows.Forms.Control.OnPaint%2A> method."},{"content":"This implementation will draw a filled square and circle.","pos":[50482,50539]},{"content":"It will also highlight the selected value by drawing a border around one shape or the other.","pos":[50540,50632]},{"pos":[50639,51034],"content":"[!code-csharp[System.Windows.Forms.Design.DocumentDesigner#380](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#380)]\n  [!code-vb[System.Windows.Forms.Design.DocumentDesigner#380](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#380)]","leadings":["","   "],"nodes":[]},{"pos":[51039,51082],"content":"Testing your Custom Control in the Designer","linkify":"Testing your Custom Control in the Designer","nodes":[{"content":"Testing your Custom Control in the Designer","pos":[0,43]}]},{"content":"At this point, you can build the <ph id=\"ph1\">`MarqueeControlLibrary`</ph> project.","pos":[51084,51149],"source":"At this point, you can build the `MarqueeControlLibrary` project."},{"content":"Test your implementation by creating a control that inherits from the <ph id=\"ph1\">`MarqueeControl`</ph> class and using it on a form.","pos":[51150,51266],"source":" Test your implementation by creating a control that inherits from the `MarqueeControl` class and using it on a form."},{"pos":[51272,51320],"content":"To create a custom MarqueeControl implementation","linkify":"To create a custom MarqueeControl implementation","nodes":[{"content":"To create a custom MarqueeControl implementation","pos":[0,48]}]},{"content":"Open <ph id=\"ph1\">`DemoMarqueeControl`</ph> in the Windows Forms Designer.","pos":[51325,51381],"source":"Open `DemoMarqueeControl` in the Windows Forms Designer."},{"content":"This creates an instance of the <ph id=\"ph1\">`DemoMarqueeControl`</ph> type and displays it in an instance of the <ph id=\"ph2\">`MarqueeControlRootDesigner`</ph> type.","pos":[51382,51512],"source":" This creates an instance of the `DemoMarqueeControl` type and displays it in an instance of the `MarqueeControlRootDesigner` type."},{"pos":[51517,51672],"content":"In the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, open the <bpt id=\"p2\">**</bpt>MarqueeControlLibrary Components<ept id=\"p2\">**</ept> tab. You will see the <ph id=\"ph1\">`MarqueeBorder`</ph> and <ph id=\"ph2\">`MarqueeText`</ph> controls available for selection.","source":"In the **Toolbox**, open the **MarqueeControlLibrary Components** tab. You will see the `MarqueeBorder` and `MarqueeText` controls available for selection."},{"content":"Drag an instance of the <ph id=\"ph1\">`MarqueeBorder`</ph> control onto the <ph id=\"ph2\">`DemoMarqueeControl`</ph> design surface.","pos":[51677,51770],"source":"Drag an instance of the `MarqueeBorder` control onto the `DemoMarqueeControl` design surface."},{"content":"Dock this <ph id=\"ph1\">`MarqueeBorder`</ph> control to the parent control.","pos":[51771,51827],"source":" Dock this `MarqueeBorder` control to the parent control."},{"pos":[51832,51923],"content":"Drag an instance of the <ph id=\"ph1\">`MarqueeText`</ph> control onto the <ph id=\"ph2\">`DemoMarqueeControl`</ph> design surface.","source":"Drag an instance of the `MarqueeText` control onto the `DemoMarqueeControl` design surface."},{"content":"Build the solution.","pos":[51928,51947]},{"content":"Right-click the <ph id=\"ph1\">`DemoMarqueeControl`</ph> and from the shortcut menu select the <bpt id=\"p1\">**</bpt>Run Test<ept id=\"p1\">**</ept> option to start the animation.","pos":[51952,52070],"source":"Right-click the `DemoMarqueeControl` and from the shortcut menu select the **Run Test** option to start the animation."},{"content":"Click <bpt id=\"p1\">**</bpt>Stop Test<ept id=\"p1\">**</ept> to stop the animation.","pos":[52071,52113],"source":" Click **Stop Test** to stop the animation."},{"pos":[52118,52148],"content":"Open <bpt id=\"p1\">**</bpt>Form1<ept id=\"p1\">**</ept> in Design view.","source":"Open **Form1** in Design view."},{"content":"Place two <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> controls on the form.","pos":[52153,52219],"source":"Place two <xref:System.Windows.Forms.Button> controls on the form."},{"content":"Name them <ph id=\"ph1\">`startButton`</ph> and <ph id=\"ph2\">`stopButton`</ph>, and change the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Control.Text%2A&gt;</ph> property values to <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Stop<ept id=\"p2\">**</ept>, respectively.","pos":[52220,52377],"source":" Name them `startButton` and `stopButton`, and change the <xref:System.Windows.Forms.Control.Text%2A> property values to **Start** and **Stop**, respectively."},{"pos":[52382,52502],"content":"Implement <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handlers for both <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Button&gt;</ph> controls.","source":"Implement <xref:System.Windows.Forms.Control.Click> event handlers for both <xref:System.Windows.Forms.Button> controls."},{"pos":[52508,52638],"content":"In the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, open the <bpt id=\"p2\">**</bpt>MarqueeControlTest Components<ept id=\"p2\">**</ept> tab. You will see the <ph id=\"ph1\">`DemoMarqueeControl`</ph> available for selection.","source":"In the **Toolbox**, open the **MarqueeControlTest Components** tab. You will see the `DemoMarqueeControl` available for selection."},{"pos":[52644,52719],"content":"Drag an instance of <ph id=\"ph1\">`DemoMarqueeControl`</ph> onto the <bpt id=\"p1\">**</bpt>Form1<ept id=\"p1\">**</ept> design surface.","source":"Drag an instance of `DemoMarqueeControl` onto the **Form1** design surface."},{"pos":[52725,52856],"content":"In the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handlers, invoke the <ph id=\"ph2\">`Start`</ph> and <ph id=\"ph3\">`Stop`</ph> methods on the <ph id=\"ph4\">`DemoMarqueeControl`</ph>.","source":"In the <xref:System.Windows.Forms.Control.Click> event handlers, invoke the `Start` and `Stop` methods on the `DemoMarqueeControl`."},{"content":"Set the <ph id=\"ph1\">`MarqueeControlTest`</ph> project as the startup project and run it.","pos":[53362,53433],"source":"Set the `MarqueeControlTest` project as the startup project and run it."},{"content":"You will see the form displaying your <ph id=\"ph1\">`DemoMarqueeControl`</ph>.","pos":[53434,53493],"source":" You will see the form displaying your `DemoMarqueeControl`."},{"content":"Click the <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> button to start the animation.","pos":[53494,53544],"source":" Click the **Start** button to start the animation."},{"content":"You should see the text flashing and the lights moving around the border.","pos":[53545,53618]},{"pos":[53623,53633],"content":"Next Steps","linkify":"Next Steps","nodes":[{"content":"Next Steps","pos":[0,10]}]},{"content":"The <ph id=\"ph1\">`MarqueeControlLibrary`</ph> demonstrates a simple implementation of custom controls and associated designers.","pos":[53635,53744],"source":"The `MarqueeControlLibrary` demonstrates a simple implementation of custom controls and associated designers."},{"content":"You can make this sample more sophisticated in several ways:","pos":[53745,53805]},{"content":"Change the property values for the <ph id=\"ph1\">`DemoMarqueeControl`</ph> in the designer.","pos":[53809,53881],"source":"Change the property values for the `DemoMarqueeControl` in the designer."},{"content":"Add more <ph id=\"ph1\">`MarqueBorder`</ph> controls and dock them within their parent instances to create a nested effect.","pos":[53882,53985],"source":" Add more `MarqueBorder` controls and dock them within their parent instances to create a nested effect."},{"content":"Experiment with different settings for the <ph id=\"ph1\">`UpdatePeriod`</ph> and the light-related properties.","pos":[53986,54077],"source":" Experiment with different settings for the `UpdatePeriod` and the light-related properties."},{"content":"Author your own implementations of <ph id=\"ph1\">`IMarqueeWidget`</ph>.","pos":[54081,54133],"source":"Author your own implementations of `IMarqueeWidget`."},{"content":"You could, for example, create a flashing \"neon sign\" or an animated sign with multiple images.","pos":[54134,54229]},{"content":"Further customize the design-time experience.","pos":[54233,54278]},{"content":"You could try shadowing more properties than <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Enabled%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.Visible%2A&gt;</ph>, and you could add new properties.","pos":[54279,54456],"source":" You could try shadowing more properties than <xref:System.Windows.Forms.Control.Enabled%2A> and <xref:System.Windows.Forms.Control.Visible%2A>, and you could add new properties."},{"content":"Add new designer verbs to simplify common tasks like docking child controls.","pos":[54457,54533]},{"content":"License the <ph id=\"ph1\">`MarqueeControl`</ph>.","pos":[54537,54566],"source":"License the `MarqueeControl`."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: License Components and Controls<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/fe8b1eh9(v=vs.120))</ept>.","pos":[54567,54732],"source":" For more information, see [How to: License Components and Controls](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/fe8b1eh9(v=vs.120))."},{"content":"Control how your controls are serialized and how code is generated for them.","pos":[54736,54812]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Dynamic Source Code Generation and Compilation<ept id=\"p1\">](../../reflection-and-codedom/dynamic-source-code-generation-and-compilation.md)</ept>.","pos":[54813,54968],"source":" For more information, see [Dynamic Source Code Generation and Compilation](../../reflection-and-codedom/dynamic-source-code-generation-and-compilation.md)."},{"pos":[54973,54981],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[55335,55517],"content":"<bpt id=\"p1\">[</bpt>How to: Create a Windows Forms Control That Takes Advantage of Design-Time Features<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/307hck25(v=vs.120))</ept>","source":"[How to: Create a Windows Forms Control That Takes Advantage of Design-Time Features](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/307hck25(v=vs.120))"},{"pos":[55520,55648],"content":"<bpt id=\"p1\">[</bpt>Extending Design-Time Support<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/37899azc(v=vs.120))</ept>","source":"[Extending Design-Time Support](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/37899azc(v=vs.120))"},{"pos":[55651,55766],"content":"<bpt id=\"p1\">[</bpt>Custom Designers<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/h51z5c0x(v=vs.120))</ept>","source":"[Custom Designers](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/h51z5c0x(v=vs.120))"}]}