{"content":"---\ntitle: \"How to: Find Preceding Siblings (XPath-LINQ to XML) (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: 59055718-d0a7-4db3-8901-18dd33587703\ncaps.latest.revision: 3\nauthor: dotnet-bot\nms.author: dotnetcontent\n\n---\n# How to: Find Preceding Siblings (XPath-LINQ to XML) (Visual Basic)\nThis topic compares the XPath `preceding-sibling` axis to the [!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)] child <xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A?displayProperty=fullName> axis.  \n  \n The XPath expression is:  \n  \n `preceding-sibling::*`  \n  \n Note that the results of both <xref:System.Xml.XPath.Extensions.XPathSelectElements%2A> and <xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A?displayProperty=fullName> are in document order.  \n  \n## Example  \n The following example finds the `FullAddress` element, and then retrieves the previous elements using the `preceding-sibling` axis.  \n  \n This example uses the following XML document: [Sample XML File: Customers and Orders (LINQ to XML)](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-customers-and-orders-linq-to-xml.md).  \n  \n```vb  \nDim co As XElement = XElement.Load(\"CustomersOrders.xml\")  \nDim add As XElement = co.<Customers>.<Customer>. _  \n        <FullAddress>.FirstOrDefault  \n  \n' LINQ to XML query  \nDim list1 As IEnumerable(Of XElement) = add.ElementsBeforeSelf()  \n  \n' XPath expression  \nDim list2 As IEnumerable(Of XElement) = add.XPathSelectElements(\"preceding-sibling::*\")  \n  \nIf list1.Count() = list2.Count() And _  \n        list1.Intersect(list2).Count() = list1.Count() Then  \n    Console.WriteLine(\"Results are identical\")  \nElse  \n    Console.WriteLine(\"Results differ\")  \nEnd If  \nFor Each el As XElement In list2  \n    Console.WriteLine(el)  \nNext  \n```  \n  \n This example produces the following output:  \n  \n```  \nResults are identical  \n<CompanyName>Great Lakes Food Market</CompanyName>  \n<ContactName>Howard Snyder</ContactName>  \n<ContactTitle>Marketing Manager</ContactTitle>  \n<Phone>(503) 555-7555</Phone>  \n```  \n  \n## See Also  \n [LINQ to XML for XPath Users (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)","nodes":[{"pos":[12,95],"content":"How to: Find Preceding Siblings (XPath-LINQ to XML) (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Find Preceding Siblings (XPath-LINQ to XML) (Visual Basic) | Microsoft Docs","pos":[0,83]}]},{"pos":[402,468],"content":"How to: Find Preceding Siblings (XPath-LINQ to XML) (Visual Basic)","linkify":"How to: Find Preceding Siblings (XPath-LINQ to XML) (Visual Basic)","nodes":[{"content":"How to: Find Preceding Siblings (XPath-LINQ to XML) (Visual Basic)","pos":[0,66]}]},{"pos":[469,721],"content":"This topic compares the XPath <ph id=\"ph1\">`preceding-sibling`</ph> axis to the <ph id=\"ph2\">[!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)]</ph> child <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A?displayProperty=fullName&gt;</ph> axis.","source":"This topic compares the XPath `preceding-sibling` axis to the [!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)] child <xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A?displayProperty=fullName> axis."},{"content":"The XPath expression is:","pos":[728,752]},{"content":"Note that the results of both <ph id=\"ph1\">&lt;xref:System.Xml.XPath.Extensions.XPathSelectElements%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A?displayProperty=fullName&gt;</ph> are in document order.","pos":[788,978],"source":"Note that the results of both <xref:System.Xml.XPath.Extensions.XPathSelectElements%2A> and <xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A?displayProperty=fullName> are in document order."},{"pos":[987,994],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[998,1129],"content":"The following example finds the <ph id=\"ph1\">`FullAddress`</ph> element, and then retrieves the previous elements using the <ph id=\"ph2\">`preceding-sibling`</ph> axis.","source":"The following example finds the `FullAddress` element, and then retrieves the previous elements using the `preceding-sibling` axis."},{"pos":[1136,1346],"content":"This example uses the following XML document: <bpt id=\"p1\">[</bpt>Sample XML File: Customers and Orders (LINQ to XML)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-customers-and-orders-linq-to-xml.md)</ept>.","source":"This example uses the following XML document: [Sample XML File: Customers and Orders (LINQ to XML)](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-customers-and-orders-linq-to-xml.md)."},{"content":"This example produces the following output:","pos":[2011,2054]},{"pos":[2279,2287],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2291,2424],"content":"<bpt id=\"p1\">[</bpt>LINQ to XML for XPath Users (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)</ept>","source":"[LINQ to XML for XPath Users (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)"}]}