{"content":"---\ntitle: \"JSONP\"\nms.date: \"03/30/2017\"\nms.assetid: c13b4d7b-dac7-4ffd-9f84-765c903511e1\n---\n# JSONP\nThis sample demonstrates how to support JSON with Padding (JSONP) in WCF REST services. JSONP is a convention used to invoke cross-domain scripts by generating script tags in the current document. The result is returned in a specified callback function. JSONP is based on the idea that tags such as `<script src=\"http://...\" >` can evaluate scripts from any domain and the script retrieved by those tags is evaluated within a scope in which other functions may already be defined.\n\n## Demonstrates\n Cross-domain scripting with JSONP.\n\n## Discussion\n The sample includes a Web page that dynamically adds a script block after the page has been rendered in the browser. This script block calls a WCF REST service that has a single operation, `GetCustomer`. The WCF REST service returns a customer’s name and address wrapped in a callback function name. When the WCF REST service responds, the callback function on the Web page is invoked with the customer data and the callback function displays the data on the Web page. The injection of the script tag and the execution of the callback function is automatically handled by the ASP.NET AJAX ScriptManager control. The usage pattern is the same as with all ASP.NET AJAX proxies, with the addition of one line to enable JSONP, as shown in the following code:\n\n```csharp\nvar proxy = new JsonpAjaxService.CustomerService();\nproxy.set_enableJsonp(true);\nproxy.GetCustomer(onSuccess, onFail, null);\n```\n\n The Web page can call the WCF REST service because the service is using the <xref:System.ServiceModel.Description.WebScriptEndpoint> with `crossDomainScriptAccessEnabled` set to `true`. Both of these configurations are done in the Web.config file under the \\<system.serviceModel> element.\n\n```xml\n<system.serviceModel>\n  <serviceHostingEnvironment aspNetCompatibilityEnabled=\"true\"/>\n  <standardEndpoints>\n    <webScriptEndpoint>\n      <standardEndpoint name=\"\" crossDomainScriptAccessEnabled=\"true\"/>\n    </webScriptEndpoint>\n  </standardEndpoints>\n</system.serviceModel>\n```\n\n ScriptManager manages the interaction with the service and hides away the complexity of manually implementing JSONP access. When `crossDomainScriptAccessEnabled` is set to `true` and the response format for an operation is JSON, the WCF infrastructure inspects the URI of the request for a callback query string parameter and wraps the JSON response with the value of the callback query string parameter. In the sample, the Web page calls the WCF REST service with the following URI.\n\n```\nhttp://localhost:33695/CustomerService/GetCustomer?callback=Sys._json0\n```\n\n Because the callback query string parameter has a value of `JsonPCallback`, the WCF service returns a JSONP response shown in the following example.\n\n```\nSys._json0({\"__type\":\"Customer:#Microsoft.Samples.Jsonp\",\"Address\":\"1 Example Way\",\"Name\":\"Bob\"});\n```\n\n This JSONP response includes the customer data formatted as JSON, wrapped with the callback function name that the Web page requested. ScriptManager will execute this callback using a script tag to accomplish the cross-domain request, and then pass the result to the onSuccess handler that was passed to the GetCustomer operation of the ASP.NET AJAX proxy.\n\n The sample consists of two ASP.NET web applications: one contains just a WCF service, and another one contains the .aspx webpage, which calls the service. When running the solution, Visual Studio 2012 will host the two websites on different ports, which creates an environment where the service and client live on different domains.\n\n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\AJAX\\JSONP`  \n  \n#### To run the sample  \n  \n1.  Open the solution for the JSONP Sample.  \n  \n2.  Press F5 to launch `http://localhost:26648/JSONPClientPage.aspx` in the browser.  \n  \n3.  Notice that after the page loads, the text inputs for \"Name\" and \"Address\" are populated by values.  These values were supplied from a call to the WCF service after the browser finished rendering the page.\n","nodes":[{"pos":[4,89],"embed":true,"restype":"x-metadata","content":"title: \"JSONP\"\nms.date: \"03/30/2017\"\nms.assetid: c13b4d7b-dac7-4ffd-9f84-765c903511e1","nodes":[{"content":"JSONP","nodes":[{"pos":[0,5],"content":"JSONP","nodes":[{"content":"JSONP","pos":[0,5]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[96,101],"content":"JSONP","linkify":"JSONP","nodes":[{"content":"JSONP","pos":[0,5]}]},{"content":"This sample demonstrates how to support JSON with Padding (JSONP) in WCF REST services.","pos":[102,189]},{"content":"JSONP is a convention used to invoke cross-domain scripts by generating script tags in the current document.","pos":[190,298]},{"content":"The result is returned in a specified callback function.","pos":[299,355]},{"content":"JSONP is based on the idea that tags such as <ph id=\"ph1\">`&lt;script src=\"http://...\" &gt;`</ph> can evaluate scripts from any domain and the script retrieved by those tags is evaluated within a scope in which other functions may already be defined.","pos":[356,582],"source":" JSONP is based on the idea that tags such as `<script src=\"http://...\" >` can evaluate scripts from any domain and the script retrieved by those tags is evaluated within a scope in which other functions may already be defined."},{"pos":[587,599],"content":"Demonstrates","linkify":"Demonstrates","nodes":[{"content":"Demonstrates","pos":[0,12]}]},{"content":"Cross-domain scripting with JSONP.","pos":[601,635]},{"pos":[640,650],"content":"Discussion","linkify":"Discussion","nodes":[{"content":"Discussion","pos":[0,10]}]},{"content":"The sample includes a Web page that dynamically adds a script block after the page has been rendered in the browser.","pos":[652,768]},{"content":"This script block calls a WCF REST service that has a single operation, <ph id=\"ph1\">`GetCustomer`</ph>.","pos":[769,855],"source":" This script block calls a WCF REST service that has a single operation, `GetCustomer`."},{"content":"The WCF REST service returns a customer’s name and address wrapped in a callback function name.","pos":[856,951]},{"content":"When the WCF REST service responds, the callback function on the Web page is invoked with the customer data and the callback function displays the data on the Web page.","pos":[952,1120]},{"content":"The injection of the script tag and the execution of the callback function is automatically handled by the ASP.NET AJAX ScriptManager control.","pos":[1121,1263]},{"content":"The usage pattern is the same as with all ASP.NET AJAX proxies, with the addition of one line to enable JSONP, as shown in the following code:","pos":[1264,1406]},{"content":"The Web page can call the WCF REST service because the service is using the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Description.WebScriptEndpoint&gt;</ph> with <ph id=\"ph2\">`crossDomainScriptAccessEnabled`</ph> set to <ph id=\"ph3\">`true`</ph>.","pos":[1549,1734],"source":"The Web page can call the WCF REST service because the service is using the <xref:System.ServiceModel.Description.WebScriptEndpoint> with `crossDomainScriptAccessEnabled` set to `true`."},{"content":"Both of these configurations are done in the Web.config file under the <ph id=\"ph1\">\\&lt;</ph>system.serviceModel&gt; element.","pos":[1735,1837],"source":" Both of these configurations are done in the Web.config file under the \\<system.serviceModel> element."},{"content":"ScriptManager manages the interaction with the service and hides away the complexity of manually implementing JSONP access.","pos":[2128,2251]},{"content":"When <ph id=\"ph1\">`crossDomainScriptAccessEnabled`</ph> is set to <ph id=\"ph2\">`true`</ph> and the response format for an operation is JSON, the WCF infrastructure inspects the URI of the request for a callback query string parameter and wraps the JSON response with the value of the callback query string parameter.","pos":[2252,2532],"source":" When `crossDomainScriptAccessEnabled` is set to `true` and the response format for an operation is JSON, the WCF infrastructure inspects the URI of the request for a callback query string parameter and wraps the JSON response with the value of the callback query string parameter."},{"content":"In the sample, the Web page calls the WCF REST service with the following URI.","pos":[2533,2611]},{"pos":[2694,2842],"content":"Because the callback query string parameter has a value of <ph id=\"ph1\">`JsonPCallback`</ph>, the WCF service returns a JSONP response shown in the following example.","source":"Because the callback query string parameter has a value of `JsonPCallback`, the WCF service returns a JSONP response shown in the following example."},{"content":"This JSONP response includes the customer data formatted as JSON, wrapped with the callback function name that the Web page requested.","pos":[2953,3087]},{"content":"ScriptManager will execute this callback using a script tag to accomplish the cross-domain request, and then pass the result to the onSuccess handler that was passed to the GetCustomer operation of the ASP.NET AJAX proxy.","pos":[3088,3309]},{"content":"The sample consists of two ASP.NET web applications: one contains just a WCF service, and another one contains the .aspx webpage, which calls the service.","pos":[3312,3466]},{"content":"When running the solution, Visual Studio 2012 will host the two websites on different ports, which creates an environment where the service and client live on different domains.","pos":[3467,3644]},{"pos":[3648,3780],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[14,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[3834,4144],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[4145,4195]},{"pos":[4270,4287],"content":"To run the sample","linkify":"To run the sample","nodes":[{"content":"To run the sample","pos":[0,17]}]},{"content":"Open the solution for the JSONP Sample.","pos":[4297,4336]},{"pos":[4346,4426],"content":"Press F5 to launch <ph id=\"ph1\">`http://localhost:26648/JSONPClientPage.aspx`</ph> in the browser.","source":"Press F5 to launch `http://localhost:26648/JSONPClientPage.aspx` in the browser."},{"content":"Notice that after the page loads, the text inputs for \"Name\" and \"Address\" are populated by values.","pos":[4436,4535]},{"content":"These values were supplied from a call to the WCF service after the browser finished rendering the page.","pos":[4537,4641]}]}