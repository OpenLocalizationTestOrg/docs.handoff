{"content":"---\ntitle: \"How to: Find Related Elements (XPath-LINQ to XML) (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: 6b0ef058-d704-48a5-98cd-33f00d088af9\ncaps.latest.revision: 3\nauthor: dotnet-bot\nms.author: dotnetcontent\n\n---\n# How to: Find Related Elements (XPath-LINQ to XML) (Visual Basic)\nThis topic shows how to get an element selecting on an attribute that is referred to by the value of another element.  \n  \n The XPath expression is:  \n  \n `.//Customer[@CustomerID=/Root/Orders/Order[12]/CustomerID]`  \n  \n## Example  \n This example finds the 12th `Order` element, and then finds the customer for that order.  \n  \n Note that indexing into a list in .Net is 'zero' based. Indexing into a collection of nodes in an XPath predicate is 'one' based. This example reflects this difference.  \n  \n This example uses the following XML document: [Sample XML File: Customers and Orders (LINQ to XML)](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-customers-and-orders-linq-to-xml.md).  \n  \n```vb  \nDim co As XDocument = XDocument.Load(\"CustomersOrders.xml\")  \n  \n' LINQ to XML query  \nDim customer1 As XElement = ( _  \n    From el In co...<Customer> _  \n    Where el.@CustomerID = co.<Root>.<Orders>.<Order>. _  \n        ToList()(11).<CustomerID>(0).Value _  \n    Select el).First()  \n  \n' An alternate way to write the query that avoids creation  \n' of a System.Collections.Generic.List:  \nDim customer2 As XElement = ( _  \n    From el In co...<Customer> _  \n    Where el.@CustomerID = co.<Root>.<Orders>.<Order>. _  \n        Skip(11).First().<CustomerID>(0).Value _  \n    Select el).First()  \n  \n' XPath expression  \nDim customer3 As XElement = co.XPathSelectElement _  \n    (\".//Customer[@CustomerID=/Root/Orders/Order[12]/CustomerID]\")  \n  \nIf customer1 Is customer2 And customer1 Is customer3 Then  \n    Console.WriteLine(\"Results are identical\")  \nElse  \n    Console.WriteLine(\"Results differ\")  \nEnd If  \nConsole.WriteLine(customer1)  \n  \n```  \n  \n This example produces the following output:  \n  \n```  \nResults are identical  \n<Customer CustomerID=\"HUNGC\">  \n  <CompanyName>Hungry Coyote Import Store</CompanyName>  \n  <ContactName>Yoshi Latimer</ContactName>  \n  <ContactTitle>Sales Representative</ContactTitle>  \n  <Phone>(503) 555-6874</Phone>  \n  <Fax>(503) 555-2376</Fax>  \n  <FullAddress>  \n    <Address>City Center Plaza 516 Main St.</Address>  \n    <City>Elgin</City>  \n    <Region>OR</Region>  \n    <PostalCode>97827</PostalCode>  \n    <Country>USA</Country>  \n  </FullAddress>  \n</Customer>  \n```  \n  \n## See Also  \n [LINQ to XML for XPath Users (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)","nodes":[{"pos":[12,93],"content":"How to: Find Related Elements (XPath-LINQ to XML) (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Find Related Elements (XPath-LINQ to XML) (Visual Basic) | Microsoft Docs","pos":[0,81]}]},{"pos":[400,464],"content":"How to: Find Related Elements (XPath-LINQ to XML) (Visual Basic)","linkify":"How to: Find Related Elements (XPath-LINQ to XML) (Visual Basic)","nodes":[{"content":"How to: Find Related Elements (XPath-LINQ to XML) (Visual Basic)","pos":[0,64]}]},{"content":"This topic shows how to get an element selecting on an attribute that is referred to by the value of another element.","pos":[465,582]},{"content":"The XPath expression is:","pos":[589,613]},{"pos":[689,696],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[700,788],"content":"This example finds the 12th <ph id=\"ph1\">`Order`</ph> element, and then finds the customer for that order.","source":"This example finds the 12th `Order` element, and then finds the customer for that order."},{"content":"Note that indexing into a list in .Net is 'zero' based.","pos":[795,850]},{"content":"Indexing into a collection of nodes in an XPath predicate is 'one' based.","pos":[851,924]},{"content":"This example reflects this difference.","pos":[925,963]},{"pos":[970,1180],"content":"This example uses the following XML document: <bpt id=\"p1\">[</bpt>Sample XML File: Customers and Orders (LINQ to XML)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-customers-and-orders-linq-to-xml.md)</ept>.","source":"This example uses the following XML document: [Sample XML File: Customers and Orders (LINQ to XML)](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-customers-and-orders-linq-to-xml.md)."},{"content":"This example produces the following output:","pos":[2152,2195]},{"pos":[2720,2728],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2732,2865],"content":"<bpt id=\"p1\">[</bpt>LINQ to XML for XPath Users (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)</ept>","source":"[LINQ to XML for XPath Users (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)"}]}