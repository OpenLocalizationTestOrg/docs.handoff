{"content":"---\ntitle: \"How to: Access Services with a Duplex Contract | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\nhelpviewer_keywords: \n  - \"duplex contracts [WCF]\"\nms.assetid: 746a9d64-f21c-426c-b85d-972e916ec6c5\ncaps.latest.revision: 18\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Access Services with a Duplex Contract\nOne feature of [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] is the ability to create a service that uses a duplex messaging pattern. This pattern allows a service to communicate with the client through a callback. This topic shows the steps to create a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client in a client class that implements the callback interface.  \n  \n A dual binding exposes the IP address of the client to the service. The client should use security to ensure that it connects only to services it trusts.  \n  \n For a tutorial on creating a basic [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service and client, see [Getting Started Tutorial](../../../../docs/framework/wcf/getting-started-tutorial.md).  \n  \n### To access a duplex service  \n  \n1.  Create a service that contains two interfaces. The first interface is for the service, the second is for the callback. [!INCLUDE[crabout](../../../../includes/crabout-md.md)] creating a duplex service, see [How to: Create a Duplex Contract](../../../../docs/framework/wcf/feature-details/how-to-create-a-duplex-contract.md).  \n  \n2.  Run the service.  \n  \n3.  Use the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to generate contracts (interfaces) for the client. For information about how to do this, see  [How to: Create a Client](../../../../docs/framework/wcf/how-to-create-a-wcf-client.md).  \n  \n4.  Implement the callback interface in the client class, as shown in the following example.  \n  \n    ```csharp  \n    public class CallbackHandler : ICalculatorDuplexCallback  \n    {  \n        public void Result(double result)  \n        {  \n            Console.WriteLine(\"Result ({0})\", result);  \n        }  \n        public void Equation(string equation)  \n        {  \n            Console.WriteLine(\"Equation({0})\", equation);  \n        }  \n    }  \n    ```  \n  \n    ```vb  \n    Public Class CallbackHandler   \n    Implements ICalculatorDuplexCallback  \n       Public Sub Result (ByVal result As Double)  \n          Console.WriteLine(\"Result ({0})\", result)  \n       End Sub  \n        Public Sub Equation(ByVal equation As String)  \n            Console.Writeline(\"Equation({0})\", equation)  \n        End Sub  \n    End Class  \n  \n    ```  \n  \n5.  Create an instance of the <xref:System.ServiceModel.InstanceContext> class. The constructor requires an instance of the client class.  \n  \n    ```csharp  \n    InstanceContext site = new InstanceContext(new CallbackHandler());  \n    ```  \n  \n    ```vb  \n    Dim site As InstanceContext = New InstanceContext(new CallbackHandler())  \n    ```  \n  \n6.  Create an instance of the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client using the constructor that requires an <xref:System.ServiceModel.InstanceContext> object. The second parameter of the constructor is the name of an endpoint found in the configuration file.  \n  \n    ```csharp  \n    CalculatorDuplexClient wcfClient =   \n    new CalculatorDuplexClient(site, \"default\")  \n    ```  \n  \n    ```vb  \n    Dim wcfClient As New CalculatorDuplexClient(site, \"default\")  \n    ```  \n  \n7.  Call the methods of the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client as required.  \n  \n## Example  \n The following code example demonstrates how to create a client class that accesses a duplex contract.  \n  \n [!code-csharp[S_DuplexClients#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/s_duplexclients/cs/client.cs#1)]\n [!code-vb[S_DuplexClients#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/s_duplexclients/vb/client.vb#1)]  \n  \n## .NET Framework Security  \n  \n## See Also  \n [Getting Started Tutorial](../../../../docs/framework/wcf/getting-started-tutorial.md)   \n [How to: Create a Duplex Contract](../../../../docs/framework/wcf/feature-details/how-to-create-a-duplex-contract.md)   \n [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)   \n [How to: Create a Client](../../../../docs/framework/wcf/how-to-create-a-wcf-client.md)   \n [How to: Use the ChannelFactory](../../../../docs/framework/wcf/feature-details/how-to-use-the-channelfactory.md)","nodes":[{"pos":[4,452],"embed":true,"restype":"x-metadata","content":"title: \"How to: Access Services with a Duplex Contract | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\nhelpviewer_keywords: \n  - \"duplex contracts [WCF]\"\nms.assetid: 746a9d64-f21c-426c-b85d-972e916ec6c5\ncaps.latest.revision: 18\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","nodes":[{"content":"How to: Access Services with a Duplex Contract | Microsoft Docs","nodes":[{"pos":[0,63],"content":"How to: Access Services with a Duplex Contract | Microsoft Docs","nodes":[{"content":"How to: Access Services with a Duplex Contract | Microsoft Docs","pos":[0,63]}]}],"path":["title"]}],"yml":true},{"pos":[459,505],"content":"How to: Access Services with a Duplex Contract","linkify":"How to: Access Services with a Duplex Contract","nodes":[{"content":"How to: Access Services with a Duplex Contract","pos":[0,46]}]},{"content":"One feature of <ph id=\"ph1\">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]</ph> is the ability to create a service that uses a duplex messaging pattern.","pos":[506,649],"source":"One feature of [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] is the ability to create a service that uses a duplex messaging pattern."},{"content":"This pattern allows a service to communicate with the client through a callback.","pos":[650,730]},{"content":"This topic shows the steps to create a <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client in a client class that implements the callback interface.","pos":[731,890],"source":" This topic shows the steps to create a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client in a client class that implements the callback interface."},{"content":"A dual binding exposes the IP address of the client to the service.","pos":[897,964]},{"content":"The client should use security to ensure that it connects only to services it trusts.","pos":[965,1050]},{"pos":[1057,1259],"content":"For a tutorial on creating a basic <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> service and client, see <bpt id=\"p1\">[</bpt>Getting Started Tutorial<ept id=\"p1\">](../../../../docs/framework/wcf/getting-started-tutorial.md)</ept>.","source":"For a tutorial on creating a basic [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service and client, see [Getting Started Tutorial](../../../../docs/framework/wcf/getting-started-tutorial.md)."},{"pos":[1269,1295],"content":"To access a duplex service","linkify":"To access a duplex service","nodes":[{"content":"To access a duplex service","pos":[0,26]}]},{"content":"Create a service that contains two interfaces.","pos":[1305,1351]},{"content":"The first interface is for the service, the second is for the callback.","pos":[1352,1423]},{"content":"<ph id=\"ph1\">[!INCLUDE[crabout](../../../../includes/crabout-md.md)]</ph> creating a duplex service, see <bpt id=\"p1\">[</bpt>How to: Create a Duplex Contract<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-create-a-duplex-contract.md)</ept>.","pos":[1424,1629],"source":"[!INCLUDE[crabout](../../../../includes/crabout-md.md)] creating a duplex service, see [How to: Create a Duplex Contract](../../../../docs/framework/wcf/feature-details/how-to-create-a-duplex-contract.md)."},{"content":"Run the service.","pos":[1639,1655]},{"content":"Use the <bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept> to generate contracts (interfaces) for the client.","pos":[1665,1856],"source":"Use the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to generate contracts (interfaces) for the client."},{"content":"For information about how to do this, see  <bpt id=\"p1\">[</bpt>How to: Create a Client<ept id=\"p1\">](../../../../docs/framework/wcf/how-to-create-a-wcf-client.md)</ept>.","pos":[1857,1988],"source":" For information about how to do this, see  [How to: Create a Client](../../../../docs/framework/wcf/how-to-create-a-wcf-client.md)."},{"content":"Implement the callback interface in the client class, as shown in the following example.","pos":[1998,2086]},{"content":"Create an instance of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.InstanceContext&gt;</ph> class.","pos":[2840,2915],"source":"Create an instance of the <xref:System.ServiceModel.InstanceContext> class."},{"content":"The constructor requires an instance of the client class.","pos":[2916,2973]},{"content":"Create an instance of the <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client using the constructor that requires an <ph id=\"ph2\">&lt;xref:System.ServiceModel.InstanceContext&gt;</ph> object.","pos":[3189,3367],"source":"Create an instance of the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client using the constructor that requires an <xref:System.ServiceModel.InstanceContext> object."},{"content":"The second parameter of the constructor is the name of an endpoint found in the configuration file.","pos":[3368,3467]},{"pos":[3690,3789],"content":"Call the methods of the <ph id=\"ph1\">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]</ph> client as required.","source":"Call the methods of the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client as required."},{"pos":[3798,3805],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code example demonstrates how to create a client class that accesses a duplex contract.","pos":[3809,3910]},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>S_DuplexClients#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_CFX/s_duplexclients/cs/client.cs#1)</ept><ept id=\"p1\">]</ept>","pos":[3917,4034],"source":"[!code-csharp[S_DuplexClients#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/s_duplexclients/cs/client.cs#1)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>S_DuplexClients#1<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/s_duplexclients/vb/client.vb#1)</ept><ept id=\"p1\">]</ept>","pos":[4036,4154],"source":"[!code-vb[S_DuplexClients#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/s_duplexclients/vb/client.vb#1)]"},{"pos":[4163,4186],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"pos":[4195,4203],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Getting Started Tutorial<ept id=\"p1\">](../../../../docs/framework/wcf/getting-started-tutorial.md)</ept><ph id=\"ph1\"> </ph>","pos":[4207,4294],"source":"[Getting Started Tutorial](../../../../docs/framework/wcf/getting-started-tutorial.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Create a Duplex Contract<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-create-a-duplex-contract.md)</ept><ph id=\"ph1\"> </ph>","pos":[4298,4416],"source":"[How to: Create a Duplex Contract](../../../../docs/framework/wcf/feature-details/how-to-create-a-duplex-contract.md) "},{"content":"<bpt id=\"p1\">[</bpt>ServiceModel Metadata Utility Tool (Svcutil.exe)<ept id=\"p1\">](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)</ept><ph id=\"ph1\"> </ph>","pos":[4420,4553],"source":"[ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Create a Client<ept id=\"p1\">](../../../../docs/framework/wcf/how-to-create-a-wcf-client.md)</ept><ph id=\"ph1\"> </ph>","pos":[4557,4645],"source":"[How to: Create a Client](../../../../docs/framework/wcf/how-to-create-a-wcf-client.md) "},{"content":"<bpt id=\"p1\">[</bpt>How to: Use the ChannelFactory<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/how-to-use-the-channelfactory.md)</ept>","pos":[4649,4762],"source":"[How to: Use the ChannelFactory](../../../../docs/framework/wcf/feature-details/how-to-use-the-channelfactory.md)"}]}