{"content":"---\ntitle: \"Code Access Security | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"named permission sets, code access security\"\n  - \"call stacks\"\n  - \"malicious code\"\n  - \"stack walk\"\n  - \"security [.NET Framework], code access security\"\n  - \"permissions [.NET Framework], code access security\"\n  - \"trusted code\"\n  - \"mobile code security\"\n  - \"unmanaged code, code access security\"\n  - \"granting permissions, code access security\"\n  - \"user authentication, code access security\"\n  - \"code access security\"\nms.assetid: 859af632-c80d-4736-8d6f-1e01b09ce127\ncaps.latest.revision: 25\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# Code Access Security\n[!INCLUDE[net_security_note](../../../includes/net-security-note-md.md)]  \n  \n Today's highly connected computer systems are frequently exposed to code originating from various, possibly unknown sources. Code can be attached to e-mail, contained in documents, or downloaded over the Internet. Unfortunately, many computer users have experienced firsthand the effects of malicious mobile code, including viruses and worms, which can damage or destroy data and cost time and money.  \n  \n Most common security mechanisms give rights to users based on their logon credentials (usually a password) and restrict resources (often directories and files) that the user is allowed to access. However, this approach fails to address several issues: users obtain code from many sources, some of which might be unreliable; code can contain bugs or vulnerabilities that enable it to be exploited by malicious code; and code sometimes does things that the user does not know it will do. As a result, computer systems can be damaged and private data can be leaked when cautious and trustworthy users run malicious or error-filled software. Most operating system security mechanisms require that every piece of code must be completely trusted in order to run, except perhaps for scripts on a Web page. Therefore, there is still a need for a widely applicable security mechanism that allows code originating from one computer system to execute with protection on another system, even when there is no trust relationship between the systems.  \n  \n The .NET Framework provides a security mechanism called code access security to help protect computer systems from malicious mobile code, to allow code from unknown origins to run with protection, and to help prevent trusted code from intentionally or accidentally compromising security. Code access security enables code to be trusted to varying degrees depending on where the code originates and on other aspects of the code's identity. Code access security also enforces the varying levels of trust on code, which minimizes the amount of code that must be fully trusted in order to run. Using code access security can reduce the likelihood that your code will be misused by malicious or error-filled code. It can reduce your liability, because you can specify the set of operations your code should be allowed to perform. Code access security can also help minimize the damage that can result from security vulnerabilities in your code.  \n  \n> [!NOTE]\n>  Major changes have been made to code access security in the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)]. The most notable change has been [security transparency](../../../docs/framework/misc/security-transparent-code.md), but there are also other significant changes that affect code access security. For information about these changes, see [Security Changes](../../../docs/framework/security/security-changes.md).  \n  \n Code access security primarily affects library code and partially trusted applications. Library developers must protect their code from unauthorized access from partially trusted applications. Partially trusted applications are applications that are loaded from external sources such as the Internet. Applications that are installed on your desktop or on the local intranet run in full trust. Full-trust applications are not affected by code access security unless they are marked as [security-transparent](../../../docs/framework/misc/security-transparent-code.md), because they are fully trusted. The only limitation for full-trust applications is that applications that are marked with the <xref:System.Security.SecurityTransparentAttribute> attribute cannot call code that is marked with the <xref:System.Security.SecurityCriticalAttribute> attribute. Partially trusted applications must be run in a sandbox (for example, in Internet Explorer) so that code access security can be applied. If you download an application from the Internet and try to run it from your desktop, you will get a <xref:System.NotSupportedException> with the message: \"An attempt was made to load an assembly from a network location which would have caused the assembly to be sandboxed in previous versions of the .NET Framework. This release of the .NET Framework does not enable CAS policy by default, so this load may be dangerous.\" If you are sure that the application can be trusted, you can enable it to be run as full trust by using the [\\<loadFromRemoteSources> element](../../../docs/framework/configure-apps/file-schema/runtime/loadfromremotesources-element.md). For information about running an application in a sandbox, see [How to: Run Partially Trusted Code in a Sandbox](../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md).  \n  \n All managed code that targets the common language runtime receives the benefits of code access security, even if that code does not make a single code access security call. For more information, see [Code Access Security Basics](../../../docs/framework/misc/code-access-security-basics.md).  \n  \n<a name=\"key_functions\"></a>   \n## Key Functions of Code Access Security  \n Code access security helps limit the access that code has to protected resources and operations. In the .NET Framework, code access security performs the following functions:  \n  \n-   Defines permissions and permission sets that represent the right to access various system resources.  \n  \n-   Enables code to demand that its callers have specific permissions.  \n  \n-   Enables code to demand that its callers possess a digital signature, thus allowing only callers from a particular organization or site to call the protected code.  \n  \n-   Enforces restrictions on code at run time by comparing the granted permissions of every caller on the call stack to the permissions that callers must have.  \n  \n<a name=\"walking_the_call_stack\"></a>   \n## Walking the Call Stack  \n To determine whether code is authorized to access a resource or perform an operation, the runtime's security system walks the call stack, comparing the granted permissions of each caller to the permission being demanded. If any caller in the call stack does not have the demanded permission, a security exception is thrown and access is refused. The stack walk is designed to help prevent luring attacks, in which less-trusted code calls highly trusted code and uses it to perform unauthorized actions. Demanding permissions of all callers at run time affects performance, but it is essential to help protect code from luring attacks by less-trusted code. To optimize performance, you can have your code perform fewer stack walks; however, you must be sure that you do not expose a security weakness whenever you do this.  \n  \n The following illustration shows the stack walk that results when a method in Assembly A4 demands that its callers have permission P.  \n  \n ![Code access security](../../../docs/framework/misc/media/slide-10a.gif \"slide_10a\")  \nSecurity stack walk  \n  \n<a name=\"related_topics\"></a>   \n## Related Topics  \n  \n|Title|Description|  \n|-----------|-----------------|  \n|[Code Access Security Basics](../../../docs/framework/misc/code-access-security-basics.md)|Describes code access security and its most common uses.|  \n|[Security-Transparent Code, Level 2](../../../docs/framework/misc/security-transparent-code-level-2.md)|Describes the security transparency model in the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)].|  \n|[Using Libraries from Partially Trusted Code](../../../docs/framework/misc/using-libraries-from-partially-trusted-code.md)|Describes how to enable libraries for use with unmanaged code and how to use libraries from unmanaged code.|  \n|[Key Security Concepts](../../../docs/standard/security/key-security-concepts.md)|Provides an overview of many of the key terms and concepts used in the .NET Framework security system.|  \n|[Role-Based Security](../../../docs/standard/security/role-based-security.md)|Describes how to incorporate security based on roles.|  \n|[Cryptographic Services](../../../docs/standard/security/cryptographic-services.md)|Describes how to incorporate cryptography into your applications.|","nodes":[{"pos":[12,49],"content":"Code Access Security | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Code Access Security | Microsoft Docs","pos":[0,37]}]},{"pos":[859,879],"content":"Code Access Security","linkify":"Code Access Security","nodes":[{"content":"Code Access Security","pos":[0,20]}]},{"content":"Today's highly connected computer systems are frequently exposed to code originating from various, possibly unknown sources.","pos":[959,1083]},{"content":"Code can be attached to e-mail, contained in documents, or downloaded over the Internet.","pos":[1084,1172]},{"content":"Unfortunately, many computer users have experienced firsthand the effects of malicious mobile code, including viruses and worms, which can damage or destroy data and cost time and money.","pos":[1173,1359]},{"content":"Most common security mechanisms give rights to users based on their logon credentials (usually a password) and restrict resources (often directories and files) that the user is allowed to access.","pos":[1366,1561]},{"content":"However, this approach fails to address several issues: users obtain code from many sources, some of which might be unreliable; code can contain bugs or vulnerabilities that enable it to be exploited by malicious code; and code sometimes does things that the user does not know it will do.","pos":[1562,1851]},{"content":"As a result, computer systems can be damaged and private data can be leaked when cautious and trustworthy users run malicious or error-filled software.","pos":[1852,2003]},{"content":"Most operating system security mechanisms require that every piece of code must be completely trusted in order to run, except perhaps for scripts on a Web page.","pos":[2004,2164]},{"content":"Therefore, there is still a need for a widely applicable security mechanism that allows code originating from one computer system to execute with protection on another system, even when there is no trust relationship between the systems.","pos":[2165,2402]},{"content":"The .NET Framework provides a security mechanism called code access security to help protect computer systems from malicious mobile code, to allow code from unknown origins to run with protection, and to help prevent trusted code from intentionally or accidentally compromising security.","pos":[2409,2696]},{"content":"Code access security enables code to be trusted to varying degrees depending on where the code originates and on other aspects of the code's identity.","pos":[2697,2847]},{"content":"Code access security also enforces the varying levels of trust on code, which minimizes the amount of code that must be fully trusted in order to run.","pos":[2848,2998]},{"content":"Using code access security can reduce the likelihood that your code will be misused by malicious or error-filled code.","pos":[2999,3117]},{"content":"It can reduce your liability, because you can specify the set of operations your code should be allowed to perform.","pos":[3118,3233]},{"content":"Code access security can also help minimize the damage that can result from security vulnerabilities in your code.","pos":[3234,3348]},{"pos":[3356,3801],"content":"[!NOTE]\n Major changes have been made to code access security in the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)]. The most notable change has been [security transparency](../../../docs/framework/misc/security-transparent-code.md), but there are also other significant changes that affect code access security. For information about these changes, see [Security Changes](../../../docs/framework/security/security-changes.md).","leadings":["","> "],"nodes":[{"content":" Major changes have been made to code access security in the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)]. The most notable change has been [security transparency](../../../docs/framework/misc/security-transparent-code.md), but there are also other significant changes that affect code access security. For information about these changes, see [Security Changes](../../../docs/framework/security/security-changes.md).","pos":[8,443],"nodes":[{"content":"Major changes have been made to code access security in the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)]</ph>.","pos":[1,124],"source":" Major changes have been made to code access security in the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)]."},{"content":"The most notable change has been <bpt id=\"p1\">[</bpt>security transparency<ept id=\"p1\">](../../../docs/framework/misc/security-transparent-code.md)</ept>, but there are also other significant changes that affect code access security.","pos":[125,320],"source":" The most notable change has been [security transparency](../../../docs/framework/misc/security-transparent-code.md), but there are also other significant changes that affect code access security."},{"content":"For information about these changes, see <bpt id=\"p1\">[</bpt>Security Changes<ept id=\"p1\">](../../../docs/framework/security/security-changes.md)</ept>.","pos":[321,435],"source":" For information about these changes, see [Security Changes](../../../docs/framework/security/security-changes.md)."}]}]},{"content":"Code access security primarily affects library code and partially trusted applications.","pos":[3808,3895]},{"content":"Library developers must protect their code from unauthorized access from partially trusted applications.","pos":[3896,4000]},{"content":"Partially trusted applications are applications that are loaded from external sources such as the Internet.","pos":[4001,4108]},{"content":"Applications that are installed on your desktop or on the local intranet run in full trust.","pos":[4109,4200]},{"content":"Full-trust applications are not affected by code access security unless they are marked as <bpt id=\"p1\">[</bpt>security-transparent<ept id=\"p1\">](../../../docs/framework/misc/security-transparent-code.md)</ept>, because they are fully trusted.","pos":[4201,4406],"source":" Full-trust applications are not affected by code access security unless they are marked as [security-transparent](../../../docs/framework/misc/security-transparent-code.md), because they are fully trusted."},{"content":"The only limitation for full-trust applications is that applications that are marked with the <ph id=\"ph1\">&lt;xref:System.Security.SecurityTransparentAttribute&gt;</ph> attribute cannot call code that is marked with the <ph id=\"ph2\">&lt;xref:System.Security.SecurityCriticalAttribute&gt;</ph> attribute.","pos":[4407,4663],"source":" The only limitation for full-trust applications is that applications that are marked with the <xref:System.Security.SecurityTransparentAttribute> attribute cannot call code that is marked with the <xref:System.Security.SecurityCriticalAttribute> attribute."},{"content":"Partially trusted applications must be run in a sandbox (for example, in Internet Explorer) so that code access security can be applied.","pos":[4664,4800]},{"content":"If you download an application from the Internet and try to run it from your desktop, you will get a <ph id=\"ph1\">&lt;xref:System.NotSupportedException&gt;</ph> with the message: \"An attempt was made to load an assembly from a network location which would have caused the assembly to be sandboxed in previous versions of the .NET Framework.","pos":[4801,5117],"source":" If you download an application from the Internet and try to run it from your desktop, you will get a <xref:System.NotSupportedException> with the message: \"An attempt was made to load an assembly from a network location which would have caused the assembly to be sandboxed in previous versions of the .NET Framework."},{"content":"This release of the .NET Framework does not enable CAS policy by default, so this load may be dangerous.\"","pos":[5118,5223]},{"content":"If you are sure that the application can be trusted, you can enable it to be run as full trust by using the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>loadFromRemoteSources&gt; element<ept id=\"p1\">](../../../docs/framework/configure-apps/file-schema/runtime/loadfromremotesources-element.md)</ept>.","pos":[5224,5460],"source":" If you are sure that the application can be trusted, you can enable it to be run as full trust by using the [\\<loadFromRemoteSources> element](../../../docs/framework/configure-apps/file-schema/runtime/loadfromremotesources-element.md)."},{"content":"For information about running an application in a sandbox, see <bpt id=\"p1\">[</bpt>How to: Run Partially Trusted Code in a Sandbox<ept id=\"p1\">](../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md)</ept>.","pos":[5461,5654],"source":" For information about running an application in a sandbox, see [How to: Run Partially Trusted Code in a Sandbox](../../../docs/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox.md)."},{"content":"All managed code that targets the common language runtime receives the benefits of code access security, even if that code does not make a single code access security call.","pos":[5661,5833]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Access Security Basics<ept id=\"p1\">](../../../docs/framework/misc/code-access-security-basics.md)</ept>.","pos":[5834,5951],"source":" For more information, see [Code Access Security Basics](../../../docs/framework/misc/code-access-security-basics.md)."},{"pos":[5992,6029],"content":"Key Functions of Code Access Security","linkify":"Key Functions of Code Access Security","nodes":[{"content":"Key Functions of Code Access Security","pos":[0,37]}]},{"content":"Code access security helps limit the access that code has to protected resources and operations.","pos":[6033,6129]},{"content":"In the .NET Framework, code access security performs the following functions:","pos":[6130,6207]},{"content":"Defines permissions and permission sets that represent the right to access various system resources.","pos":[6217,6317]},{"content":"Enables code to demand that its callers have specific permissions.","pos":[6327,6393]},{"content":"Enables code to demand that its callers possess a digital signature, thus allowing only callers from a particular organization or site to call the protected code.","pos":[6403,6565]},{"content":"Enforces restrictions on code at run time by comparing the granted permissions of every caller on the call stack to the permissions that callers must have.","pos":[6575,6730]},{"pos":[6780,6802],"content":"Walking the Call Stack","linkify":"Walking the Call Stack","nodes":[{"content":"Walking the Call Stack","pos":[0,22]}]},{"content":"To determine whether code is authorized to access a resource or perform an operation, the runtime's security system walks the call stack, comparing the granted permissions of each caller to the permission being demanded.","pos":[6806,7026]},{"content":"If any caller in the call stack does not have the demanded permission, a security exception is thrown and access is refused.","pos":[7027,7151]},{"content":"The stack walk is designed to help prevent luring attacks, in which less-trusted code calls highly trusted code and uses it to perform unauthorized actions.","pos":[7152,7308]},{"content":"Demanding permissions of all callers at run time affects performance, but it is essential to help protect code from luring attacks by less-trusted code.","pos":[7309,7461]},{"content":"To optimize performance, you can have your code perform fewer stack walks; however, you must be sure that you do not expose a security weakness whenever you do this.","pos":[7462,7627]},{"content":"The following illustration shows the stack walk that results when a method in Assembly A4 demands that its callers have permission P.","pos":[7634,7767]},{"content":"<bpt id=\"p1\">![</bpt>Code access security<ept id=\"p1\">](../../../docs/framework/misc/media/slide-10a.gif \"slide_10a\")</ept>","pos":[7774,7859],"source":"![Code access security](../../../docs/framework/misc/media/slide-10a.gif \"slide_10a\")"},{"content":"Security stack walk","pos":[7862,7881]},{"pos":[7923,7937],"content":"Related Topics","linkify":"Related Topics","nodes":[{"content":"Related Topics","pos":[0,14]}]},{"content":"Title","pos":[7944,7949]},{"content":"Description","pos":[7950,7961]},{"pos":[8000,8090],"content":"<bpt id=\"p1\">[</bpt>Code Access Security Basics<ept id=\"p1\">](../../../docs/framework/misc/code-access-security-basics.md)</ept>","source":"[Code Access Security Basics](../../../docs/framework/misc/code-access-security-basics.md)"},{"content":"Describes code access security and its most common uses.","pos":[8091,8147]},{"pos":[8152,8255],"content":"<bpt id=\"p1\">[</bpt>Security-Transparent Code, Level 2<ept id=\"p1\">](../../../docs/framework/misc/security-transparent-code-level-2.md)</ept>","source":"[Security-Transparent Code, Level 2](../../../docs/framework/misc/security-transparent-code-level-2.md)"},{"pos":[8256,8370],"content":"Describes the security transparency model in the <ph id=\"ph1\">[!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)]</ph>.","source":"Describes the security transparency model in the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)]."},{"pos":[8375,8497],"content":"<bpt id=\"p1\">[</bpt>Using Libraries from Partially Trusted Code<ept id=\"p1\">](../../../docs/framework/misc/using-libraries-from-partially-trusted-code.md)</ept>","source":"[Using Libraries from Partially Trusted Code](../../../docs/framework/misc/using-libraries-from-partially-trusted-code.md)"},{"content":"Describes how to enable libraries for use with unmanaged code and how to use libraries from unmanaged code.","pos":[8498,8605]},{"pos":[8610,8691],"content":"<bpt id=\"p1\">[</bpt>Key Security Concepts<ept id=\"p1\">](../../../docs/standard/security/key-security-concepts.md)</ept>","source":"[Key Security Concepts](../../../docs/standard/security/key-security-concepts.md)"},{"content":"Provides an overview of many of the key terms and concepts used in the .NET Framework security system.","pos":[8692,8794]},{"pos":[8799,8876],"content":"<bpt id=\"p1\">[</bpt>Role-Based Security<ept id=\"p1\">](../../../docs/standard/security/role-based-security.md)</ept>","source":"[Role-Based Security](../../../docs/standard/security/role-based-security.md)"},{"content":"Describes how to incorporate security based on roles.","pos":[8877,8930]},{"pos":[8935,9018],"content":"<bpt id=\"p1\">[</bpt>Cryptographic Services<ept id=\"p1\">](../../../docs/standard/security/cryptographic-services.md)</ept>","source":"[Cryptographic Services](../../../docs/standard/security/cryptographic-services.md)"},{"content":"Describes how to incorporate cryptography into your applications.","pos":[9019,9084]}]}