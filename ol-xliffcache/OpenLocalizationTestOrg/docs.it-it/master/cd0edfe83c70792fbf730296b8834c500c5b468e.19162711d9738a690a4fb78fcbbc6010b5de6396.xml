{"content":"---\ntitle: \"Creating Expression Columns | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 0af3bd64-92a2-4b47-ae62-f5df35f131a6\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Creating Expression Columns\nYou can define an expression for a column, enabling it to contain a value calculated from other column values in the same row or from the column values of multiple rows in the table. To define the expression to be evaluated, use the <xref:System.Data.DataColumn.Expression%2A> property of the target column, and use the <xref:System.Data.DataColumn.ColumnName%2A> property to refer to other columns in the expression. The <xref:System.Data.DataColumn.DataType%2A> for the expression column must be appropriate for the value that the expression returns.  \n  \n The following table lists several possible uses for expression columns in a table.  \n  \n|Expression type|Example|  \n|---------------------|-------------|  \n|Comparison|\"Total >= 500\"|  \n|Computation|\"UnitPrice * Quantity\"|  \n|Aggregation|Sum(Price)|  \n  \n You can set the **Expression** property on an existing **DataColumn** object, or you can include the property as the third argument passed to the <xref:System.Data.DataColumn> constructor, as shown in the following example.  \n  \n```vb  \nworkTable.Columns.Add(\"Total\",Type.GetType(\"System.Double\"))  \nworkTable.Columns.Add(\"SalesTax\", Type.GetType(\"System.Double\"), _  \n  \"Total * 0.086\")  \n  \n```  \n  \n```csharp  \nworkTable.Columns.Add(\"Total\", typeof(Double));  \nworkTable.Columns.Add(\"SalesTax\", typeof(Double), \"Total * 0.086\");  \n```  \n  \n Expressions can reference other expression columns; however, a circular reference, in which two expressions reference each other, will generate an exception. For rules about writing expressions, see the <xref:System.Data.DataColumn.Expression%2A> property of the **DataColumn** class.  \n  \n## See Also  \n <xref:System.Data.DataColumn>   \n <xref:System.Data.DataSet>   \n <xref:System.Data.DataTable>   \n [DataTable Schema Definition](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatable-schema-definition.md)   \n [DataTables](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatables.md)   \n [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)","nodes":[{"pos":[4,358],"nodes":[{"content":"Creating Expression Columns | Microsoft Docs","nodes":[{"pos":[0,44],"content":"Creating Expression Columns | Microsoft Docs","nodes":[{"content":"Creating Expression Columns | Microsoft Docs","pos":[0,44]}]}],"pos":[6,53],"yaml":true}],"content":"title: \"Creating Expression Columns | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 0af3bd64-92a2-4b47-ae62-f5df35f131a6\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","yamlblock":true},{"pos":[365,392],"content":"Creating Expression Columns","linkify":"Creating Expression Columns","nodes":[{"content":"Creating Expression Columns","pos":[0,27]}]},{"content":"You can define an expression for a column, enabling it to contain a value calculated from other column values in the same row or from the column values of multiple rows in the table.","pos":[393,575]},{"content":"To define the expression to be evaluated, use the <ph id=\"ph1\">&lt;xref:System.Data.DataColumn.Expression%2A&gt;</ph> property of the target column, and use the <ph id=\"ph2\">&lt;xref:System.Data.DataColumn.ColumnName%2A&gt;</ph> property to refer to other columns in the expression.","pos":[576,810],"source":" To define the expression to be evaluated, use the <xref:System.Data.DataColumn.Expression%2A> property of the target column, and use the <xref:System.Data.DataColumn.ColumnName%2A> property to refer to other columns in the expression."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Data.DataColumn.DataType%2A&gt;</ph> for the expression column must be appropriate for the value that the expression returns.","pos":[811,945],"source":" The <xref:System.Data.DataColumn.DataType%2A> for the expression column must be appropriate for the value that the expression returns."},{"content":"The following table lists several possible uses for expression columns in a table.","pos":[952,1034]},{"content":"Expression type","pos":[1041,1056]},{"content":"Example","pos":[1057,1064]},{"content":"Comparison","pos":[1109,1119]},{"content":"\"Total &gt;= 500\"","pos":[1120,1134],"source":"\"Total >= 500\""},{"content":"Computation","pos":[1139,1150]},{"content":"\"UnitPrice * Quantity\"","pos":[1151,1173]},{"content":"Aggregation","pos":[1178,1189]},{"content":"Sum(Price)","pos":[1190,1200]},{"pos":[1208,1431],"content":"You can set the <bpt id=\"p1\">**</bpt>Expression<ept id=\"p1\">**</ept> property on an existing <bpt id=\"p2\">**</bpt>DataColumn<ept id=\"p2\">**</ept> object, or you can include the property as the third argument passed to the <ph id=\"ph1\">&lt;xref:System.Data.DataColumn&gt;</ph> constructor, as shown in the following example.","source":"You can set the **Expression** property on an existing **DataColumn** object, or you can include the property as the third argument passed to the <xref:System.Data.DataColumn> constructor, as shown in the following example."},{"content":"Expressions can reference other expression columns; however, a circular reference, in which two expressions reference each other, will generate an exception.","pos":[1752,1909]},{"content":"For rules about writing expressions, see the <ph id=\"ph1\">&lt;xref:System.Data.DataColumn.Expression%2A&gt;</ph> property of the <bpt id=\"p1\">**</bpt>DataColumn<ept id=\"p1\">**</ept> class.","pos":[1910,2036],"source":" For rules about writing expressions, see the <xref:System.Data.DataColumn.Expression%2A> property of the **DataColumn** class."},{"pos":[2045,2053],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Data.DataColumn&gt;</ph>","pos":[2057,2086],"source":"<xref:System.Data.DataColumn> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Data.DataSet&gt;</ph>","pos":[2091,2117],"source":"<xref:System.Data.DataSet> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Data.DataTable&gt;</ph>","pos":[2122,2150],"source":"<xref:System.Data.DataTable> "},{"content":"<bpt id=\"p1\">[</bpt>DataTable Schema Definition<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatable-schema-definition.md)</ept><ph id=\"ph1\"> </ph>","pos":[2155,2286],"source":"[DataTable Schema Definition](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatable-schema-definition.md) "},{"content":"<bpt id=\"p1\">[</bpt>DataTables<ept id=\"p1\">](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatables.md)</ept><ph id=\"ph1\"> </ph>","pos":[2290,2387],"source":"[DataTables](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/datatables.md) "},{"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=217917)</ept>","pos":[2391,2494],"source":"[ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)"}]}