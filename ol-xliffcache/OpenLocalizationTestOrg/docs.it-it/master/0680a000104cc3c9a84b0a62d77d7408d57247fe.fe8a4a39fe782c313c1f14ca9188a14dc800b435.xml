{"content":"---\ntitle: \"reportAvOnComRelease MDA | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"MDAs (managed debugging assistants), reference counting errors\"\n  - \"exceptions, reference counting errors\"\n  - \"ReportAvOnComRelease MDA\"\n  - \"COM release access violations\"\n  - \"user reference counting errors\"\n  - \"managed debugging assistants (MDAs), reference counting errors\"\n  - \"report access violation on Com release\"\n  - \"reference counting errors\"\nms.assetid: a2b86b63-08b2-4943-b344-3c2cf46ccd31\ncaps.latest.revision: 15\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# reportAvOnComRelease MDA\nThe `reportAvOnComRelease` managed debugging assistant (MDA) is activated when exceptions are thrown due to user reference counting errors while performing COM interop and using the <xref:System.Runtime.InteropServices.Marshal.Release%2A> or <xref:System.Runtime.InteropServices.Marshal.ReleaseComObject%2A> method combined with raw COM calls.  \n  \n## Symptoms  \n Access violations and memory corruption.  \n  \n## Cause  \n Occasionally, an exception is thrown due to user reference counting errors while performing COM interop and using the <xref:System.Runtime.InteropServices.Marshal.Release%2A> or <xref:System.Runtime.InteropServices.Marshal.ReleaseComObject%2A> method combined with raw COM calls. Normally, this exception is discarded because not doing so would cause an access violation in the CLR, bringing it down. When this assistant is enabled, such exceptions can be detected and reported instead of being simply discarded.  \n  \n## Resolution  \n Examine your reference counting code and search for errors as well as examining the native clients of your object for reference counting errors.  \n  \n## Effect on the Runtime  \n Two modes are available. If the `allowAv` attribute is `true`, the assistant prevents the runtime from discarding the access violation. If `allowAv` is `false`, which is the default, the runtime discards the access violation, but a warning message is reported to the user to indicate that an exception was thrown and discarded.  \n  \n## Output  \n If possible, the output contains the COM interface pointer's original vtable. Otherwise, an informational message is displayed.  \n  \n## Configuration  \n  \n```  \n<mdaConfig>  \n  <assistants>  \n    <reportAvOnComRelease />  \n  </assistants>  \n</mdaConfig>  \n```  \n  \n## See Also  \n <xref:System.Runtime.InteropServices.MarshalAsAttribute>   \n [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)   \n [Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)","nodes":[{"pos":[12,53],"content":"reportAvOnComRelease MDA | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"reportAvOnComRelease MDA | Microsoft Docs","pos":[0,41]}]},{"pos":[796,820],"content":"reportAvOnComRelease MDA","linkify":"reportAvOnComRelease MDA","nodes":[{"content":"reportAvOnComRelease MDA","pos":[0,24]}]},{"pos":[821,1164],"content":"The <ph id=\"ph1\">`reportAvOnComRelease`</ph> managed debugging assistant (MDA) is activated when exceptions are thrown due to user reference counting errors while performing COM interop and using the <ph id=\"ph2\">&lt;xref:System.Runtime.InteropServices.Marshal.Release%2A&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Runtime.InteropServices.Marshal.ReleaseComObject%2A&gt;</ph> method combined with raw COM calls.","source":"The `reportAvOnComRelease` managed debugging assistant (MDA) is activated when exceptions are thrown due to user reference counting errors while performing COM interop and using the <xref:System.Runtime.InteropServices.Marshal.Release%2A> or <xref:System.Runtime.InteropServices.Marshal.ReleaseComObject%2A> method combined with raw COM calls."},{"pos":[1173,1181],"content":"Symptoms","linkify":"Symptoms","nodes":[{"content":"Symptoms","pos":[0,8]}]},{"content":"Access violations and memory corruption.","pos":[1185,1225]},{"pos":[1234,1239],"content":"Cause","linkify":"Cause","nodes":[{"content":"Cause","pos":[0,5]}]},{"content":"Occasionally, an exception is thrown due to user reference counting errors while performing COM interop and using the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.Marshal.Release%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Runtime.InteropServices.Marshal.ReleaseComObject%2A&gt;</ph> method combined with raw COM calls.","pos":[1243,1522],"source":"Occasionally, an exception is thrown due to user reference counting errors while performing COM interop and using the <xref:System.Runtime.InteropServices.Marshal.Release%2A> or <xref:System.Runtime.InteropServices.Marshal.ReleaseComObject%2A> method combined with raw COM calls."},{"content":"Normally, this exception is discarded because not doing so would cause an access violation in the CLR, bringing it down.","pos":[1523,1643]},{"content":"When this assistant is enabled, such exceptions can be detected and reported instead of being simply discarded.","pos":[1644,1755]},{"pos":[1764,1774],"content":"Resolution","linkify":"Resolution","nodes":[{"content":"Resolution","pos":[0,10]}]},{"content":"Examine your reference counting code and search for errors as well as examining the native clients of your object for reference counting errors.","pos":[1778,1922]},{"pos":[1931,1952],"content":"Effect on the Runtime","linkify":"Effect on the Runtime","nodes":[{"content":"Effect on the Runtime","pos":[0,21]}]},{"content":"Two modes are available.","pos":[1956,1980]},{"content":"If the <ph id=\"ph1\">`allowAv`</ph> attribute is <ph id=\"ph2\">`true`</ph>, the assistant prevents the runtime from discarding the access violation.","pos":[1981,2091],"source":" If the `allowAv` attribute is `true`, the assistant prevents the runtime from discarding the access violation."},{"content":"If <ph id=\"ph1\">`allowAv`</ph> is <ph id=\"ph2\">`false`</ph>, which is the default, the runtime discards the access violation, but a warning message is reported to the user to indicate that an exception was thrown and discarded.","pos":[2092,2283],"source":" If `allowAv` is `false`, which is the default, the runtime discards the access violation, but a warning message is reported to the user to indicate that an exception was thrown and discarded."},{"pos":[2292,2298],"content":"Output","linkify":"Output","nodes":[{"content":"Output","pos":[0,6]}]},{"content":"If possible, the output contains the COM interface pointer's original vtable.","pos":[2302,2379]},{"content":"Otherwise, an informational message is displayed.","pos":[2380,2429]},{"pos":[2438,2451],"content":"Configuration","linkify":"Configuration","nodes":[{"content":"Configuration","pos":[0,13]}]},{"pos":[2570,2578],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.MarshalAsAttribute&gt;</ph>","pos":[2582,2638],"source":"<xref:System.Runtime.InteropServices.MarshalAsAttribute> "},{"content":"<bpt id=\"p1\"> [</bpt>Diagnosing Errors with Managed Debugging Assistants<ept id=\"p1\">](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md)</ept><ph id=\"ph1\"> </ph>","pos":[2642,2797],"source":" [Diagnosing Errors with Managed Debugging Assistants](../../../docs/framework/debug-trace-profile/diagnosing-errors-with-managed-debugging-assistants.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Interop Marshaling<ept id=\"p1\">](../../../docs/framework/interop/interop-marshaling.md)</ept>","pos":[2800,2876],"source":" [Interop Marshaling](../../../docs/framework/interop/interop-marshaling.md)"}]}