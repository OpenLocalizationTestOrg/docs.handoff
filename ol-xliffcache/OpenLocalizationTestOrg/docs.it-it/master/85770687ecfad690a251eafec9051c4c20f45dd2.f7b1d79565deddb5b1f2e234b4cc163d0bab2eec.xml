{"content":"---\ntitle: \"How to: Respond to Font Scheme Changes in a Windows Forms Application\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"Windows Forms, font scheme changes\"\nms.assetid: 4db27702-22e7-43bf-a07d-9a004549853c\n---\n# How to: Respond to Font Scheme Changes in a Windows Forms Application\nIn the Windows operating systems, a user can change the system-wide font settings to make the default font appear larger or smaller. Changing these font settings is critical for users who are visually impaired and require larger type to read the text on their screens. You can adjust your Windows Forms application to react to these changes by increasing or decreasing the size of the form and all contained text whenever the font scheme changes. If you want your form to accommodate changes in font sizes dynamically, you can add code to your form.  \n  \n Typically, the default font used by Windows Forms is the font returned by the <xref:Microsoft.Win32> namespace call to `GetStockObject(DEFAULT_GUI_FONT)`. The font returned by this call only changes when the screen resolution changes. As shown in the following procedure, your code must change the default font to <xref:System.Drawing.SystemFonts.IconTitleFont%2A> to respond to changes in font size.  \n  \n### To use the desktop font and respond to font scheme changes  \n  \n1.  Create your form, and add the controls you want to it. For more information, see [How to: Create a Windows Forms Application from the Command Line](how-to-create-a-windows-forms-application-from-the-command-line.md) and [Controls to Use on Windows Forms](./controls/controls-to-use-on-windows-forms.md).  \n  \n2.  Add a reference to the <xref:Microsoft.Win32> namespace to your code.  \n  \n     [!code-csharp[WinFormsAutoScaling#2](~/samples/snippets/csharp/VS_Snippets_Winforms/WinFormsAutoScaling/CS/Form1.cs#2)]\n     [!code-vb[WinFormsAutoScaling#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/WinFormsAutoScaling/VB/Form1.vb#2)]  \n  \n3.  Add the following code to the constructor of your form to hook up required event handlers, and to change the default font in use for the form.  \n  \n     [!code-csharp[WinFormsAutoScaling#3](~/samples/snippets/csharp/VS_Snippets_Winforms/WinFormsAutoScaling/CS/Form1.cs#3)]\n     [!code-vb[WinFormsAutoScaling#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/WinFormsAutoScaling/VB/Form1.vb#3)]  \n  \n4.  Implement a handler for the <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged> event that causes the form to scale automatically when the <xref:Microsoft.Win32.UserPreferenceCategory.Window> category changes.  \n  \n     [!code-csharp[WinFormsAutoScaling#4](~/samples/snippets/csharp/VS_Snippets_Winforms/WinFormsAutoScaling/CS/Form1.cs#4)]\n     [!code-vb[WinFormsAutoScaling#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/WinFormsAutoScaling/VB/Form1.vb#4)]  \n  \n5.  Finally, implement a handler for the <xref:System.Windows.Forms.Form.FormClosing> event that detaches the <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged> event handler.  \n  \n     > [!IMPORTANT]\n     > Failure to include this code will cause your application to leak memory.  \n  \n     [!code-csharp[WinFormsAutoScaling#5](~/samples/snippets/csharp/VS_Snippets_Winforms/WinFormsAutoScaling/CS/Form1.cs#5)]\n     [!code-vb[WinFormsAutoScaling#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/WinFormsAutoScaling/VB/Form1.vb#5)]  \n  \n6.  Compile and run the code.  \n  \n### To manually change the font scheme in Windows XP  \n  \n1.  While your Windows Forms application is running, right-click the Windows desktop and choose **Properties** from the shortcut menu.  \n  \n2.  In the **Display Properties** dialog box, click the **Appearance** tab.  \n  \n3.  From the **Font Size** drop-down list box, select a new font size.  \n  \n     You'll notice that the form now reacts to run-time changes in the desktop font scheme. When the user changes between **Normal**, **Large Fonts**, and **Extra Large Fonts**, the form changes font and scales correctly.  \n  \n## Example  \n [!code-csharp[WinFormsAutoScaling#1](~/samples/snippets/csharp/VS_Snippets_Winforms/WinFormsAutoScaling/CS/Form1.cs#1)]\n [!code-vb[WinFormsAutoScaling#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/WinFormsAutoScaling/VB/Form1.vb#1)]  \n  \n The constructer in this code example contains a call to `InitializeComponent`, which is defined when you create a new Windows Forms project in Visual Studio. Remove this line of code if you are building your application on the command line.  \n  \n## See also\n\n- <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A>\n- [Automatic Scaling in Windows Forms](automatic-scaling-in-windows-forms.md)\n","nodes":[{"pos":[4,250],"embed":true,"restype":"x-metadata","content":"title: \"How to: Respond to Font Scheme Changes in a Windows Forms Application\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords: \n  - \"Windows Forms, font scheme changes\"\nms.assetid: 4db27702-22e7-43bf-a07d-9a004549853c","nodes":[{"content":"How to: Respond to Font Scheme Changes in a Windows Forms Application","nodes":[{"pos":[0,69],"content":"How to: Respond to Font Scheme Changes in a Windows Forms Application","nodes":[{"content":"How to: Respond to Font Scheme Changes in a Windows Forms Application","pos":[0,69]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[257,326],"content":"How to: Respond to Font Scheme Changes in a Windows Forms Application","linkify":"How to: Respond to Font Scheme Changes in a Windows Forms Application","nodes":[{"content":"How to: Respond to Font Scheme Changes in a Windows Forms Application","pos":[0,69]}]},{"content":"In the Windows operating systems, a user can change the system-wide font settings to make the default font appear larger or smaller.","pos":[327,459]},{"content":"Changing these font settings is critical for users who are visually impaired and require larger type to read the text on their screens.","pos":[460,595]},{"content":"You can adjust your Windows Forms application to react to these changes by increasing or decreasing the size of the form and all contained text whenever the font scheme changes.","pos":[596,773]},{"content":"If you want your form to accommodate changes in font sizes dynamically, you can add code to your form.","pos":[774,876]},{"content":"Typically, the default font used by Windows Forms is the font returned by the <ph id=\"ph1\">&lt;xref:Microsoft.Win32&gt;</ph> namespace call to <ph id=\"ph2\">`GetStockObject(DEFAULT_GUI_FONT)`</ph>.","pos":[883,1037],"source":"Typically, the default font used by Windows Forms is the font returned by the <xref:Microsoft.Win32> namespace call to `GetStockObject(DEFAULT_GUI_FONT)`."},{"content":"The font returned by this call only changes when the screen resolution changes.","pos":[1038,1117]},{"content":"As shown in the following procedure, your code must change the default font to <ph id=\"ph1\">&lt;xref:System.Drawing.SystemFonts.IconTitleFont%2A&gt;</ph> to respond to changes in font size.","pos":[1118,1283],"source":" As shown in the following procedure, your code must change the default font to <xref:System.Drawing.SystemFonts.IconTitleFont%2A> to respond to changes in font size."},{"pos":[1293,1351],"content":"To use the desktop font and respond to font scheme changes","linkify":"To use the desktop font and respond to font scheme changes","nodes":[{"content":"To use the desktop font and respond to font scheme changes","pos":[0,58]}]},{"content":"Create your form, and add the controls you want to it.","pos":[1361,1415]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Create a Windows Forms Application from the Command Line<ept id=\"p1\">](how-to-create-a-windows-forms-application-from-the-command-line.md)</ept> and <bpt id=\"p2\">[</bpt>Controls to Use on Windows Forms<ept id=\"p2\">](./controls/controls-to-use-on-windows-forms.md)</ept>.","pos":[1416,1664],"source":" For more information, see [How to: Create a Windows Forms Application from the Command Line](how-to-create-a-windows-forms-application-from-the-command-line.md) and [Controls to Use on Windows Forms](./controls/controls-to-use-on-windows-forms.md)."},{"pos":[1674,1743],"content":"Add a reference to the <ph id=\"ph1\">&lt;xref:Microsoft.Win32&gt;</ph> namespace to your code.","source":"Add a reference to the <xref:Microsoft.Win32> namespace to your code."},{"pos":[1754,1999],"content":"[!code-csharp[WinFormsAutoScaling#2](~/samples/snippets/csharp/VS_Snippets_Winforms/WinFormsAutoScaling/CS/Form1.cs#2)]\n [!code-vb[WinFormsAutoScaling#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/WinFormsAutoScaling/VB/Form1.vb#2)]","leadings":["","    "],"nodes":[]},{"content":"Add the following code to the constructor of your form to hook up required event handlers, and to change the default font in use for the form.","pos":[2009,2151]},{"pos":[2162,2407],"content":"[!code-csharp[WinFormsAutoScaling#3](~/samples/snippets/csharp/VS_Snippets_Winforms/WinFormsAutoScaling/CS/Form1.cs#3)]\n [!code-vb[WinFormsAutoScaling#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/WinFormsAutoScaling/VB/Form1.vb#3)]","leadings":["","    "],"nodes":[]},{"pos":[2417,2632],"content":"Implement a handler for the <ph id=\"ph1\">&lt;xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged&gt;</ph> event that causes the form to scale automatically when the <ph id=\"ph2\">&lt;xref:Microsoft.Win32.UserPreferenceCategory.Window&gt;</ph> category changes.","source":"Implement a handler for the <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged> event that causes the form to scale automatically when the <xref:Microsoft.Win32.UserPreferenceCategory.Window> category changes."},{"pos":[2643,2888],"content":"[!code-csharp[WinFormsAutoScaling#4](~/samples/snippets/csharp/VS_Snippets_Winforms/WinFormsAutoScaling/CS/Form1.cs#4)]\n [!code-vb[WinFormsAutoScaling#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/WinFormsAutoScaling/VB/Form1.vb#4)]","leadings":["","    "],"nodes":[]},{"pos":[2898,3076],"content":"Finally, implement a handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.FormClosing&gt;</ph> event that detaches the <ph id=\"ph2\">&lt;xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged&gt;</ph> event handler.","source":"Finally, implement a handler for the <xref:System.Windows.Forms.Form.FormClosing> event that detaches the <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged> event handler."},{"pos":[3089,3181],"content":"[!IMPORTANT]\nFailure to include this code will cause your application to leak memory.","leadings":["","     > "],"nodes":[{"content":"Failure to include this code will cause your application to leak memory.","pos":[13,85]}]},{"pos":[3192,3437],"content":"[!code-csharp[WinFormsAutoScaling#5](~/samples/snippets/csharp/VS_Snippets_Winforms/WinFormsAutoScaling/CS/Form1.cs#5)]\n [!code-vb[WinFormsAutoScaling#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/WinFormsAutoScaling/VB/Form1.vb#5)]","leadings":["","    "],"nodes":[]},{"content":"Compile and run the code.","pos":[3447,3472]},{"pos":[3482,3530],"content":"To manually change the font scheme in Windows XP","linkify":"To manually change the font scheme in Windows XP","nodes":[{"content":"To manually change the font scheme in Windows XP","pos":[0,48]}]},{"pos":[3540,3670],"content":"While your Windows Forms application is running, right-click the Windows desktop and choose <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> from the shortcut menu.","source":"While your Windows Forms application is running, right-click the Windows desktop and choose **Properties** from the shortcut menu."},{"pos":[3680,3751],"content":"In the <bpt id=\"p1\">**</bpt>Display Properties<ept id=\"p1\">**</ept> dialog box, click the <bpt id=\"p2\">**</bpt>Appearance<ept id=\"p2\">**</ept> tab.","source":"In the **Display Properties** dialog box, click the **Appearance** tab."},{"pos":[3761,3827],"content":"From the <bpt id=\"p1\">**</bpt>Font Size<ept id=\"p1\">**</ept> drop-down list box, select a new font size.","source":"From the **Font Size** drop-down list box, select a new font size."},{"content":"You'll notice that the form now reacts to run-time changes in the desktop font scheme.","pos":[3838,3924]},{"content":"When the user changes between <bpt id=\"p1\">**</bpt>Normal<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Large Fonts<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>Extra Large Fonts<ept id=\"p3\">**</ept>, the form changes font and scales correctly.","pos":[3925,4054],"source":" When the user changes between **Normal**, **Large Fonts**, and **Extra Large Fonts**, the form changes font and scales correctly."},{"pos":[4063,4070],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The constructer in this code example contains a call to <ph id=\"ph1\">`InitializeComponent`</ph>, which is defined when you create a new Windows Forms project in Visual Studio.","pos":[4322,4479],"source":"The constructer in this code example contains a call to `InitializeComponent`, which is defined when you create a new Windows Forms project in Visual Studio."},{"content":"Remove this line of code if you are building your application on the command line.","pos":[4480,4562]},{"pos":[4571,4579],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4650,4725],"content":"<bpt id=\"p1\">[</bpt>Automatic Scaling in Windows Forms<ept id=\"p1\">](automatic-scaling-in-windows-forms.md)</ept>","source":"[Automatic Scaling in Windows Forms](automatic-scaling-in-windows-forms.md)"}]}