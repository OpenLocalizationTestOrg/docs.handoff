{"content":"---\ntitle: \"Interceptors (WCF Data Services) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework-oob\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"WCF Data Services, customizing\"\n  - \"query interceptors [WCF Data Services]\"\nms.assetid: e33ae8dc-8069-41d0-99a0-75ff28db7050\ncaps.latest.revision: 2\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# Interceptors (WCF Data Services)\n[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] enables an application to intercept request messages so that you can add custom logic to an operation. You can use this custom logic to validate data in incoming messages. You can also use it to further restrict the scope of a query request, such as to insert a custom authorization policy on a per request basis.  \n  \n Interception is performed by specially attributed methods in the data service. These methods are called by [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] at the appropriate point in message processing. Interceptors are defined on a per-entity set basis, and interceptor methods cannot accept parameters from the request like service operations can. Query interceptor methods, which are called when processing an HTTP GET request, must return a lambda expression that determines whether an instance of the interceptor's entity set should be returned by the query results. This expression is used by the data service to further refine the requested operation. The following is an example definition of a query interceptor.  \n  \n [!code-csharp[Astoria Northwind Service#QueryInterceptorDef](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind service/cs/northwind2.svc.cs#queryinterceptordef)]\n [!code-vb[Astoria Northwind Service#QueryInterceptorDef](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind service/vb/northwind2.svc.vb#queryinterceptordef)]  \n  \n For more information, see [How to: Intercept Data Service Messages](../../../../docs/framework/data/wcf/how-to-intercept-data-service-messages-wcf-data-services.md).  \n  \n Change interceptors, which are called when processing non-query operations, must return `void` (`Nothing` in Visual Basic). Change interceptor methods must accept the following two parameters:  \n  \n1.  A parameter of a type that is compatible with the entity type of the entity set. When the data service invokes the change interceptor, the value of this parameter will reflect the entity information that is sent by the request.  \n  \n2.  A parameter of type <xref:System.Data.Services.UpdateOperations>. When the data service invokes the change interceptor, the value of this parameter will reflect the operation that the request is trying to perform.  \n  \n The following is an example definition of a change interceptor.  \n  \n [!code-csharp[Astoria Northwind Service#ChangeInterceptorDef](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind service/cs/northwind2.svc.cs#changeinterceptordef)]\n [!code-vb[Astoria Northwind Service#ChangeInterceptorDef](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind service/vb/northwind2.svc.vb#changeinterceptordef)]  \n  \n For more information, see [How to: Intercept Data Service Messages](../../../../docs/framework/data/wcf/how-to-intercept-data-service-messages-wcf-data-services.md).  \n  \n The following attributes are supported for interception.  \n  \n **[QueryInterceptor(** *EnitySetName* **)]**  \n Methods with the <xref:System.Data.Services.QueryInterceptorAttribute> attribute applied are called when an HTTP GET request is received for the targeted entity set resource. These methods must always return a lambda expression in the form of `Expression<Func<T,bool>>`.  \n  \n **[ChangeInterceptor(** *EnitySetName* **)]**  \n Methods with the <xref:System.Data.Services.ChangeInterceptorAttribute> attribute applied are called when an HTTP request other than HTTP GET request is received for the targeted entity set resource. These methods must always return `void` (`Nothing` in Visual Basic).  \n  \n For more information, see [How to: Intercept Data Service Messages](../../../../docs/framework/data/wcf/how-to-intercept-data-service-messages-wcf-data-services.md).  \n  \n## See Also  \n [Service Operations](../../../../docs/framework/data/wcf/service-operations-wcf-data-services.md)","nodes":[{"pos":[4,460],"embed":true,"restype":"x-metadata","content":"title: \"Interceptors (WCF Data Services) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework-oob\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nhelpviewer_keywords: \n  - \"WCF Data Services, customizing\"\n  - \"query interceptors [WCF Data Services]\"\nms.assetid: e33ae8dc-8069-41d0-99a0-75ff28db7050\ncaps.latest.revision: 2\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","nodes":[{"content":"Interceptors (WCF Data Services) | Microsoft Docs","nodes":[{"pos":[0,49],"content":"Interceptors (WCF Data Services) | Microsoft Docs","nodes":[{"content":"Interceptors (WCF Data Services) | Microsoft Docs","pos":[0,49]}]}],"path":["title"]}],"yml":true},{"pos":[467,499],"content":"Interceptors (WCF Data Services)","linkify":"Interceptors (WCF Data Services)","nodes":[{"content":"Interceptors (WCF Data Services)","pos":[0,32]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]</ph> enables an application to intercept request messages so that you can add custom logic to an operation.","pos":[500,662],"source":"[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] enables an application to intercept request messages so that you can add custom logic to an operation."},{"content":"You can use this custom logic to validate data in incoming messages.","pos":[663,731]},{"content":"You can also use it to further restrict the scope of a query request, such as to insert a custom authorization policy on a per request basis.","pos":[732,873]},{"content":"Interception is performed by specially attributed methods in the data service.","pos":[880,958]},{"content":"These methods are called by <ph id=\"ph1\">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]</ph> at the appropriate point in message processing.","pos":[959,1094],"source":" These methods are called by [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] at the appropriate point in message processing."},{"content":"Interceptors are defined on a per-entity set basis, and interceptor methods cannot accept parameters from the request like service operations can.","pos":[1095,1241]},{"content":"Query interceptor methods, which are called when processing an HTTP GET request, must return a lambda expression that determines whether an instance of the interceptor's entity set should be returned by the query results.","pos":[1242,1463]},{"content":"This expression is used by the data service to further refine the requested operation.","pos":[1464,1550]},{"content":"The following is an example definition of a query interceptor.","pos":[1551,1613]},{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>Astoria Northwind Service#QueryInterceptorDef<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind service/cs/northwind2.svc.cs#queryinterceptordef)</ept><ept id=\"p1\">]</ept>","pos":[1620,1802],"source":"[!code-csharp[Astoria Northwind Service#QueryInterceptorDef](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind service/cs/northwind2.svc.cs#queryinterceptordef)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>Astoria Northwind Service#QueryInterceptorDef<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind service/vb/northwind2.svc.vb#queryinterceptordef)</ept><ept id=\"p1\">]</ept>","pos":[1804,1987],"source":"[!code-vb[Astoria Northwind Service#QueryInterceptorDef](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind service/vb/northwind2.svc.vb#queryinterceptordef)]"},{"pos":[1994,2159],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Intercept Data Service Messages<ept id=\"p1\">](../../../../docs/framework/data/wcf/how-to-intercept-data-service-messages-wcf-data-services.md)</ept>.","source":"For more information, see [How to: Intercept Data Service Messages](../../../../docs/framework/data/wcf/how-to-intercept-data-service-messages-wcf-data-services.md)."},{"content":"Change interceptors, which are called when processing non-query operations, must return <ph id=\"ph1\">`void`</ph> (<ph id=\"ph2\">`Nothing`</ph> in Visual Basic).","pos":[2166,2289],"source":"Change interceptors, which are called when processing non-query operations, must return `void` (`Nothing` in Visual Basic)."},{"content":"Change interceptor methods must accept the following two parameters:","pos":[2290,2358]},{"content":"A parameter of a type that is compatible with the entity type of the entity set.","pos":[2368,2448]},{"content":"When the data service invokes the change interceptor, the value of this parameter will reflect the entity information that is sent by the request.","pos":[2449,2595]},{"content":"A parameter of type <ph id=\"ph1\">&lt;xref:System.Data.Services.UpdateOperations&gt;</ph>.","pos":[2605,2670],"source":"A parameter of type <xref:System.Data.Services.UpdateOperations>."},{"content":"When the data service invokes the change interceptor, the value of this parameter will reflect the operation that the request is trying to perform.","pos":[2671,2818]},{"content":"The following is an example definition of a change interceptor.","pos":[2825,2888]},{"pos":[2895,3266],"content":"[!code-csharp[Astoria Northwind Service#ChangeInterceptorDef](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind service/cs/northwind2.svc.cs#changeinterceptordef)]\n[!code-vb[Astoria Northwind Service#ChangeInterceptorDef](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind service/vb/northwind2.svc.vb#changeinterceptordef)]","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>Astoria Northwind Service#ChangeInterceptorDef<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind service/cs/northwind2.svc.cs#changeinterceptordef)</ept><ept id=\"p1\">]</ept>","pos":[0,184],"source":"[!code-csharp[Astoria Northwind Service#ChangeInterceptorDef](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind service/cs/northwind2.svc.cs#changeinterceptordef)]"},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>Astoria Northwind Service#ChangeInterceptorDef<ept id=\"p2\">](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind service/vb/northwind2.svc.vb#changeinterceptordef)</ept><ept id=\"p1\">]</ept>","pos":[185,370],"source":"[!code-vb[Astoria Northwind Service#ChangeInterceptorDef](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind service/vb/northwind2.svc.vb#changeinterceptordef)]"}]},{"pos":[3273,3438],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Intercept Data Service Messages<ept id=\"p1\">](../../../../docs/framework/data/wcf/how-to-intercept-data-service-messages-wcf-data-services.md)</ept>.","source":"For more information, see [How to: Intercept Data Service Messages](../../../../docs/framework/data/wcf/how-to-intercept-data-service-messages-wcf-data-services.md)."},{"content":"The following attributes are supported for interception.","pos":[3445,3501]},{"pos":[3508,3826],"content":"**[QueryInterceptor(** *EnitySetName* **)]**  \nMethods with the <xref:System.Data.Services.QueryInterceptorAttribute> attribute applied are called when an HTTP GET request is received for the targeted entity set resource. These methods must always return a lambda expression in the form of `Expression<Func<T,bool>>`.","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">**</bpt>[QueryInterceptor(<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>EnitySetName<ept id=\"p2\">*</ept> <bpt id=\"p3\">**</bpt>)]<ept id=\"p3\">**</ept>","pos":[0,44],"source":"**[QueryInterceptor(** *EnitySetName* **)]**"},{"content":"Methods with the <xref:System.Data.Services.QueryInterceptorAttribute> attribute applied are called when an HTTP GET request is received for the targeted entity set resource. These methods must always return a lambda expression in the form of `Expression<Func<T,bool>>`.","pos":[47,317],"nodes":[{"content":"Methods with the <ph id=\"ph1\">&lt;xref:System.Data.Services.QueryInterceptorAttribute&gt;</ph> attribute applied are called when an HTTP GET request is received for the targeted entity set resource.","pos":[0,174],"source":"Methods with the <xref:System.Data.Services.QueryInterceptorAttribute> attribute applied are called when an HTTP GET request is received for the targeted entity set resource."},{"content":"These methods must always return a lambda expression in the form of <ph id=\"ph1\">`Expression&lt;Func&lt;T,bool&gt;&gt;`</ph>.","pos":[175,270],"source":" These methods must always return a lambda expression in the form of `Expression<Func<T,bool>>`."}]}]},{"pos":[3833,4150],"content":"**[ChangeInterceptor(** *EnitySetName* **)]**  \nMethods with the <xref:System.Data.Services.ChangeInterceptorAttribute> attribute applied are called when an HTTP request other than HTTP GET request is received for the targeted entity set resource. These methods must always return `void` (`Nothing` in Visual Basic).","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">**</bpt>[ChangeInterceptor(<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>EnitySetName<ept id=\"p2\">*</ept> <bpt id=\"p3\">**</bpt>)]<ept id=\"p3\">**</ept>","pos":[0,45],"source":"**[ChangeInterceptor(** *EnitySetName* **)]**"},{"content":"Methods with the <xref:System.Data.Services.ChangeInterceptorAttribute> attribute applied are called when an HTTP request other than HTTP GET request is received for the targeted entity set resource. These methods must always return `void` (`Nothing` in Visual Basic).","pos":[48,316],"nodes":[{"content":"Methods with the <ph id=\"ph1\">&lt;xref:System.Data.Services.ChangeInterceptorAttribute&gt;</ph> attribute applied are called when an HTTP request other than HTTP GET request is received for the targeted entity set resource.","pos":[0,199],"source":"Methods with the <xref:System.Data.Services.ChangeInterceptorAttribute> attribute applied are called when an HTTP request other than HTTP GET request is received for the targeted entity set resource."},{"content":"These methods must always return <ph id=\"ph1\">`void`</ph> (<ph id=\"ph2\">`Nothing`</ph> in Visual Basic).","pos":[200,268],"source":" These methods must always return `void` (`Nothing` in Visual Basic)."}]}]},{"pos":[4157,4322],"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Intercept Data Service Messages<ept id=\"p1\">](../../../../docs/framework/data/wcf/how-to-intercept-data-service-messages-wcf-data-services.md)</ept>.","source":"For more information, see [How to: Intercept Data Service Messages](../../../../docs/framework/data/wcf/how-to-intercept-data-service-messages-wcf-data-services.md)."},{"pos":[4331,4339],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[4343,4440],"content":"<bpt id=\"p1\">[</bpt>Service Operations<ept id=\"p1\">](../../../../docs/framework/data/wcf/service-operations-wcf-data-services.md)</ept>","source":"[Service Operations](../../../../docs/framework/data/wcf/service-operations-wcf-data-services.md)"}]}