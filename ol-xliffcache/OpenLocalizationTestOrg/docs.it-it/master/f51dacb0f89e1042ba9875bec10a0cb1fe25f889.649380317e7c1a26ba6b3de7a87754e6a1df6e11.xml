{"content":"---\ntitle: \"Serializing with an XML Declaration (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 8726f79e-2bb0-4ba0-969d-197cca591647\n---\n# Serializing with an XML Declaration (Visual Basic)\nThis topic describes how to control whether serialization generates an XML declaration.  \n  \n## XML Declaration Generation  \n Serializing to a <xref:System.IO.File> or a <xref:System.IO.TextWriter> using the <xref:System.Xml.Linq.XElement.Save%2A?displayProperty=nameWithType> method or the <xref:System.Xml.Linq.XDocument.Save%2A?displayProperty=nameWithType> method generates an XML declaration. When you serialize to an <xref:System.Xml.XmlWriter>, the writer settings (specified in an <xref:System.Xml.XmlWriterSettings> object) determine whether an XML declaration is generated or not.  \n  \n If you are serializing to a string using the `ToString` method, the resulting XML will not include an XML declaration.  \n  \n### Serializing with an XML Declaration  \n The following example creates an <xref:System.Xml.Linq.XElement>, saves the document to a file, and then prints the file to the console:  \n  \n```vb  \nDim root As XElement = <Root>  \n                           <Child>child content</Child>  \n                       </Root>  \nroot.Save(\"Root.xml\")  \nDim str As String = File.ReadAllText(\"Root.xml\")  \nConsole.WriteLine(str)  \n```  \n  \n This example produces the following output:  \n  \n```xml  \n<?xml version=\"1.0\" encoding=\"utf-8\"?>  \n<Root>  \n  <Child>child content</Child>  \n</Root>  \n```  \n  \n### Serializing without an XML Declaration  \n The following example shows how to save an <xref:System.Xml.Linq.XElement> to an <xref:System.Xml.XmlWriter>.  \n  \n```vb  \nDim sb As StringBuilder = New StringBuilder()  \nDim xws As XmlWriterSettings = New XmlWriterSettings()  \nxws.OmitXmlDeclaration = True  \n  \nUsing xw As XmlWriter = XmlWriter.Create(sb, xws)  \n    Dim root = <Root>  \n                   <Child>child content</Child>  \n               </Root>  \n    root.Save(xw)  \nEnd Using  \nConsole.WriteLine(sb.ToString())  \n```  \n  \n This example produces the following output:  \n  \n```xml  \n<Root><Child>child content</Child></Root>  \n```  \n  \n## See also\n\n- [Serializing XML Trees (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/serializing-xml-trees.md)\n","nodes":[{"pos":[4,132],"embed":true,"restype":"x-metadata","content":"title: \"Serializing with an XML Declaration (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 8726f79e-2bb0-4ba0-969d-197cca591647","nodes":[{"content":"Serializing with an XML Declaration (Visual Basic)","nodes":[{"pos":[0,50],"content":"Serializing with an XML Declaration (Visual Basic)","nodes":[{"content":"Serializing with an XML Declaration (Visual Basic)","pos":[0,50]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[139,189],"content":"Serializing with an XML Declaration (Visual Basic)","linkify":"Serializing with an XML Declaration (Visual Basic)","nodes":[{"content":"Serializing with an XML Declaration (Visual Basic)","pos":[0,50]}]},{"content":"This topic describes how to control whether serialization generates an XML declaration.","pos":[190,277]},{"pos":[286,312],"content":"XML Declaration Generation","linkify":"XML Declaration Generation","nodes":[{"content":"XML Declaration Generation","pos":[0,26]}]},{"content":"Serializing to a <ph id=\"ph1\">&lt;xref:System.IO.File&gt;</ph> or a <ph id=\"ph2\">&lt;xref:System.IO.TextWriter&gt;</ph> using the <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XElement.Save%2A?displayProperty=nameWithType&gt;</ph> method or the <ph id=\"ph4\">&lt;xref:System.Xml.Linq.XDocument.Save%2A?displayProperty=nameWithType&gt;</ph> method generates an XML declaration.","pos":[316,587],"source":"Serializing to a <xref:System.IO.File> or a <xref:System.IO.TextWriter> using the <xref:System.Xml.Linq.XElement.Save%2A?displayProperty=nameWithType> method or the <xref:System.Xml.Linq.XDocument.Save%2A?displayProperty=nameWithType> method generates an XML declaration."},{"content":"When you serialize to an <ph id=\"ph1\">&lt;xref:System.Xml.XmlWriter&gt;</ph>, the writer settings (specified in an <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriterSettings&gt;</ph> object) determine whether an XML declaration is generated or not.","pos":[588,780],"source":" When you serialize to an <xref:System.Xml.XmlWriter>, the writer settings (specified in an <xref:System.Xml.XmlWriterSettings> object) determine whether an XML declaration is generated or not."},{"pos":[787,905],"content":"If you are serializing to a string using the <ph id=\"ph1\">`ToString`</ph> method, the resulting XML will not include an XML declaration.","source":"If you are serializing to a string using the `ToString` method, the resulting XML will not include an XML declaration."},{"pos":[915,950],"content":"Serializing with an XML Declaration","linkify":"Serializing with an XML Declaration","nodes":[{"content":"Serializing with an XML Declaration","pos":[0,35]}]},{"pos":[954,1090],"content":"The following example creates an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph>, saves the document to a file, and then prints the file to the console:","source":"The following example creates an <xref:System.Xml.Linq.XElement>, saves the document to a file, and then prints the file to the console:"},{"content":"This example produces the following output:","pos":[1337,1380]},{"pos":[1501,1539],"content":"Serializing without an XML Declaration","linkify":"Serializing without an XML Declaration","nodes":[{"content":"Serializing without an XML Declaration","pos":[0,38]}]},{"pos":[1543,1652],"content":"The following example shows how to save an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> to an <ph id=\"ph2\">&lt;xref:System.Xml.XmlWriter&gt;</ph>.","source":"The following example shows how to save an <xref:System.Xml.Linq.XElement> to an <xref:System.Xml.XmlWriter>."},{"content":"This example produces the following output:","pos":[2034,2077]},{"pos":[2148,2156],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2160,2281],"content":"<bpt id=\"p1\">[</bpt>Serializing XML Trees (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/serializing-xml-trees.md)</ept>","source":"[Serializing XML Trees (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/serializing-xml-trees.md)"}]}