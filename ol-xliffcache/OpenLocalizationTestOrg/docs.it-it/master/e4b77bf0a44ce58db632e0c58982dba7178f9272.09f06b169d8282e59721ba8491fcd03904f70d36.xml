{"content":"---\ntitle: \"How to: Implement and Call a Custom Extension Method - C# Programming Guide\"\nms.custom: seodec18\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"extension methods [C#], implementing and calling\"\nms.assetid: 7dab2a56-cf8e-4a47-a444-fe610a02772a\n---\n# How to: Implement and Call a Custom Extension Method (C# Programming Guide)\nThis topic shows how to implement your own extension methods for any .NET type. Client code can use your extension methods by adding a reference to the DLL that contains them, and adding a [using](../../../csharp/language-reference/keywords/using-directive.md) directive that specifies the namespace in which the extension methods are defined.  \n  \n## To define and call the extension method  \n  \n1.  Define a static [class](../../../csharp/programming-guide/classes-and-structs/static-classes-and-static-class-members.md) to contain the extension method.  \n  \n     The class must be visible to client code. For more information about accessibility rules, see [Access Modifiers](../../../csharp/programming-guide/classes-and-structs/access-modifiers.md).  \n  \n2.  Implement the extension method as a static method with at least the same visibility as the containing class.  \n  \n3.  The first parameter of the method specifies the type that the method operates on; it must be preceded with the [this](../../../csharp/language-reference/keywords/this.md) modifier.  \n  \n4.  In the calling code, add a `using` directive to specify the [namespace](../../../csharp/language-reference/keywords/namespace.md) that contains the extension method class.  \n  \n5.  Call the methods as if they were instance methods on the type.  \n  \n     Note that the first parameter is not specified by calling code because it represents the type on which the operator is being applied, and the compiler already knows the type of your object. You only have to provide arguments for parameters 2 through `n`.  \n  \n## Example  \n The following example implements an extension method named `WordCount` in the `CustomExtensions.StringExtension` class. The method operates on the <xref:System.String> class, which is specified as the first method parameter. The `CustomExtensions` namespace is imported into the application namespace, and the method is called inside the `Main` method.  \n  \n [!code-csharp[csProgGuideExtensionMethods#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideExtensionMethods/cs/extensionmethods.cs#1)]  \n  \n## Compiling the Code  \n To run this code, copy and paste it into a Visual C# console application project that has been created in Visual Studio. By default, this project targets version 3.5 of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)], and it has a reference to System.Core.dll and a `using` directive for System.Linq. If one or more of these requirements are missing from the project, you can add them manually.  \n  \n## .NET Framework Security  \n Extension methods present no specific security vulnerabilities. They can never be used to impersonate existing methods on a type, because all name collisions are resolved in favor of the instance or static method defined by the type itself. Extension methods cannot access any private data in the extended class.  \n  \n## See also\n\n- [C# Programming Guide](../../../csharp/programming-guide/index.md)\n- [Extension Methods](../../../csharp/programming-guide/classes-and-structs/extension-methods.md)\n- [LINQ (Language-Integrated Query)](../../../csharp/linq/linq-in-csharp.md)\n- [Static Classes and Static Class Members](../../../csharp/programming-guide/classes-and-structs/static-classes-and-static-class-members.md)\n- [protected](../../../csharp/language-reference/keywords/protected.md)\n- [internal](../../../csharp/language-reference/keywords/internal.md)\n- [public](../../../csharp/language-reference/keywords/public.md)\n- [this](../../../csharp/language-reference/keywords/this.md)\n- [namespace](../../../csharp/language-reference/keywords/namespace.md)\n","nodes":[{"pos":[4,254],"embed":true,"restype":"x-metadata","content":"title: \"How to: Implement and Call a Custom Extension Method - C# Programming Guide\"\nms.custom: seodec18\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"extension methods [C#], implementing and calling\"\nms.assetid: 7dab2a56-cf8e-4a47-a444-fe610a02772a","nodes":[{"content":"How to: Implement and Call a Custom Extension Method - C# Programming Guide","nodes":[{"pos":[0,75],"content":"How to: Implement and Call a Custom Extension Method - C# Programming Guide","nodes":[{"content":"How to: Implement and Call a Custom Extension Method - C# Programming Guide","pos":[0,75]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[261,336],"content":"How to: Implement and Call a Custom Extension Method (C# Programming Guide)","linkify":"How to: Implement and Call a Custom Extension Method (C# Programming Guide)","nodes":[{"content":"How to: Implement and Call a Custom Extension Method (C# Programming Guide)","pos":[0,75]}]},{"content":"This topic shows how to implement your own extension methods for any .NET type.","pos":[337,416]},{"content":"Client code can use your extension methods by adding a reference to the DLL that contains them, and adding a <bpt id=\"p1\">[</bpt>using<ept id=\"p1\">](../../../csharp/language-reference/keywords/using-directive.md)</ept> directive that specifies the namespace in which the extension methods are defined.","pos":[417,680],"source":" Client code can use your extension methods by adding a reference to the DLL that contains them, and adding a [using](../../../csharp/language-reference/keywords/using-directive.md) directive that specifies the namespace in which the extension methods are defined."},{"pos":[689,728],"content":"To define and call the extension method","linkify":"To define and call the extension method","nodes":[{"content":"To define and call the extension method","pos":[0,39]}]},{"pos":[738,892],"content":"Define a static <bpt id=\"p1\">[</bpt>class<ept id=\"p1\">](../../../csharp/programming-guide/classes-and-structs/static-classes-and-static-class-members.md)</ept> to contain the extension method.","source":"Define a static [class](../../../csharp/programming-guide/classes-and-structs/static-classes-and-static-class-members.md) to contain the extension method."},{"content":"The class must be visible to client code.","pos":[903,944]},{"content":"For more information about accessibility rules, see <bpt id=\"p1\">[</bpt>Access Modifiers<ept id=\"p1\">](../../../csharp/programming-guide/classes-and-structs/access-modifiers.md)</ept>.","pos":[945,1091],"source":" For more information about accessibility rules, see [Access Modifiers](../../../csharp/programming-guide/classes-and-structs/access-modifiers.md)."},{"content":"Implement the extension method as a static method with at least the same visibility as the containing class.","pos":[1101,1209]},{"pos":[1219,1399],"content":"The first parameter of the method specifies the type that the method operates on; it must be preceded with the <bpt id=\"p1\">[</bpt>this<ept id=\"p1\">](../../../csharp/language-reference/keywords/this.md)</ept> modifier.","source":"The first parameter of the method specifies the type that the method operates on; it must be preceded with the [this](../../../csharp/language-reference/keywords/this.md) modifier."},{"pos":[1409,1580],"content":"In the calling code, add a <ph id=\"ph1\">`using`</ph> directive to specify the <bpt id=\"p1\">[</bpt>namespace<ept id=\"p1\">](../../../csharp/language-reference/keywords/namespace.md)</ept> that contains the extension method class.","source":"In the calling code, add a `using` directive to specify the [namespace](../../../csharp/language-reference/keywords/namespace.md) that contains the extension method class."},{"content":"Call the methods as if they were instance methods on the type.","pos":[1590,1652]},{"content":"Note that the first parameter is not specified by calling code because it represents the type on which the operator is being applied, and the compiler already knows the type of your object.","pos":[1663,1852]},{"content":"You only have to provide arguments for parameters 2 through <ph id=\"ph1\">`n`</ph>.","pos":[1853,1917],"source":" You only have to provide arguments for parameters 2 through `n`."},{"pos":[1926,1933],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example implements an extension method named <ph id=\"ph1\">`WordCount`</ph> in the <ph id=\"ph2\">`CustomExtensions.StringExtension`</ph> class.","pos":[1937,2056],"source":"The following example implements an extension method named `WordCount` in the `CustomExtensions.StringExtension` class."},{"content":"The method operates on the <ph id=\"ph1\">&lt;xref:System.String&gt;</ph> class, which is specified as the first method parameter.","pos":[2057,2161],"source":" The method operates on the <xref:System.String> class, which is specified as the first method parameter."},{"content":"The <ph id=\"ph1\">`CustomExtensions`</ph> namespace is imported into the application namespace, and the method is called inside the <ph id=\"ph2\">`Main`</ph> method.","pos":[2162,2289],"source":" The `CustomExtensions` namespace is imported into the application namespace, and the method is called inside the `Main` method."},{"pos":[2451,2469],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"content":"To run this code, copy and paste it into a Visual C# console application project that has been created in Visual Studio.","pos":[2473,2593]},{"content":"By default, this project targets version 3.5 of the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]</ph>, and it has a reference to System.Core.dll and a <ph id=\"ph2\">`using`</ph> directive for System.Linq.","pos":[2594,2783],"source":" By default, this project targets version 3.5 of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)], and it has a reference to System.Core.dll and a `using` directive for System.Linq."},{"content":"If one or more of these requirements are missing from the project, you can add them manually.","pos":[2784,2877]},{"pos":[2886,2909],"content":".NET Framework Security","linkify":".NET Framework Security","nodes":[{"content":".NET Framework Security","pos":[0,23]}]},{"content":"Extension methods present no specific security vulnerabilities.","pos":[2913,2976]},{"content":"They can never be used to impersonate existing methods on a type, because all name collisions are resolved in favor of the instance or static method defined by the type itself.","pos":[2977,3153]},{"content":"Extension methods cannot access any private data in the extended class.","pos":[3154,3225]},{"pos":[3234,3242],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3246,3312],"content":"<bpt id=\"p1\">[</bpt>C# Programming Guide<ept id=\"p1\">](../../../csharp/programming-guide/index.md)</ept>","source":"[C# Programming Guide](../../../csharp/programming-guide/index.md)"},{"pos":[3315,3410],"content":"<bpt id=\"p1\">[</bpt>Extension Methods<ept id=\"p1\">](../../../csharp/programming-guide/classes-and-structs/extension-methods.md)</ept>","source":"[Extension Methods](../../../csharp/programming-guide/classes-and-structs/extension-methods.md)"},{"pos":[3413,3487],"content":"<bpt id=\"p1\">[</bpt>LINQ (Language-Integrated Query)<ept id=\"p1\">](../../../csharp/linq/linq-in-csharp.md)</ept>","source":"[LINQ (Language-Integrated Query)](../../../csharp/linq/linq-in-csharp.md)"},{"pos":[3490,3629],"content":"<bpt id=\"p1\">[</bpt>Static Classes and Static Class Members<ept id=\"p1\">](../../../csharp/programming-guide/classes-and-structs/static-classes-and-static-class-members.md)</ept>","source":"[Static Classes and Static Class Members](../../../csharp/programming-guide/classes-and-structs/static-classes-and-static-class-members.md)"},{"pos":[3632,3701],"content":"<bpt id=\"p1\">[</bpt>protected<ept id=\"p1\">](../../../csharp/language-reference/keywords/protected.md)</ept>","source":"[protected](../../../csharp/language-reference/keywords/protected.md)"},{"pos":[3704,3771],"content":"<bpt id=\"p1\">[</bpt>internal<ept id=\"p1\">](../../../csharp/language-reference/keywords/internal.md)</ept>","source":"[internal](../../../csharp/language-reference/keywords/internal.md)"},{"pos":[3774,3837],"content":"<bpt id=\"p1\">[</bpt>public<ept id=\"p1\">](../../../csharp/language-reference/keywords/public.md)</ept>","source":"[public](../../../csharp/language-reference/keywords/public.md)"},{"pos":[3840,3899],"content":"<bpt id=\"p1\">[</bpt>this<ept id=\"p1\">](../../../csharp/language-reference/keywords/this.md)</ept>","source":"[this](../../../csharp/language-reference/keywords/this.md)"},{"pos":[3902,3971],"content":"<bpt id=\"p1\">[</bpt>namespace<ept id=\"p1\">](../../../csharp/language-reference/keywords/namespace.md)</ept>","source":"[namespace](../../../csharp/language-reference/keywords/namespace.md)"}]}