{"content":"---\ntitle: \"How to: Create a Custom Activity Template\"\nms.date: \"03/30/2017\"\nms.assetid: 6760a5cc-6eb8-465f-b4fa-f89b39539429\n---\n# How to: Create a Custom Activity Template\n\nCustom activity templates are used to customize the configuration of activities, including custom composite activities, so that users do not have to create each activity individually and configure their properties and other settings manually. These custom templates can be made available in the **Toolbox** on the [!INCLUDE[wfd1](../../../includes/wfd1-md.md)] or from a rehosted designer, from which users can drag them onto the preconfigured design surface. [!INCLUDE[wfd2](../../../includes/wfd2-md.md)] ships with good examples of such templates: the [SendAndReceiveReply Template Designer](/visualstudio/workflow-designer/sendandreceivereply-template-designer) and the [ReceiveAndSendReply Template Designer](/visualstudio/workflow-designer/receiveandsendreply-template-designer) in the [Messaging Activity Designers](/visualstudio/workflow-designer/messaging-activity-designers) category.\n\n The first procedure in this topic describes how to create a custom activity template for a **Delay** activity and the second procedure describes briefly how to make it available in a [!INCLUDE[wfd2](../../../includes/wfd2-md.md)] to verify that the custom template works.\n\n Custom activity templates must implement the <xref:System.Activities.Presentation.IActivityTemplateFactory>. The interface has a single <xref:System.Activities.Presentation.IActivityTemplateFactory.Create%2A> method with which you can create and configure the activity instances used in the template.\n\n## To create a template for the Delay activity\n\n1.  Start Visual Studio 2010.\n\n2.  On the **File** menu, point to **New**, and then select **Project**.\n\n     The **New Project** dialog box opens.\n\n3.  In the **Project Types** pane, select **Workflow** from either the **Visual C#** projects or **Visual Basic** groupings depending on your language preference.\n\n4.  In the **Templates** pane, select **Activity Library**.\n\n5.  In the **Name** box, enter `DelayActivityTemplate`.\n\n6.  Accept the defaults in the **Location** and **Solution name** text boxes, and then click **OK**.\n\n7.  Right-click the References directory of the DelayActivityTemplate project in **Solution Explorer** and choose **Add Reference** to open the **Add Reference** dialog box.\n\n8.  Go to the **.NET** tab and select **PresentationFramework** from the **Component Name** column on the left and click **OK** to add a reference to the PresentationFramework.dll file.\n\n9. Repeat this procedure to add references to the System.Activities.Presentation.dll and the WindowsBase.dll files.\n\n10. Right-click the DelayActivityTemplate project in **Solution Explorer** and choose **Add** and then **New Item** to open the **Add New Item** dialog box.\n\n11. Select the **Class** template, name it MyDelayTemplate, and then click **OK**.\n\n12. Open the MyDelayTemplate.cs file and add the following statements.\n\n    ```\n    //Namespaces added\n    using System.Activities;\n    using System.Activities.Statements;\n    using System.Activities.Presentation;\n    using System.Windows;\n    ```\n\n13. Implement the <xref:System.Activities.Presentation.IActivityTemplateFactory> with the `MyDelayActivity` class with the following code. This configures the delay to have a duration of 10 seconds.\n\n    ```\n    public sealed class MyDelayActivity : IActivityTemplateFactory\n    {\n        public Activity Create(System.Windows.DependencyObject target)\n        {\n            return new System.Activities.Statements.Delay\n            {\n                DisplayName = \"DelayActivityTemplate\",\n                Duration = new TimeSpan(0, 0, 10)\n\n            };\n        }\n    }\n    ```\n\n14. Select **Build Solution** from the **Build** menu to generate the DelayActivityTemplate.dll file.\n\n### To make the template available in a Workflow Designer\n\n1.  Right-click the DelayActivityTemplate solution in **Solution Explorer** and choose **Add** and then **New Project** to open the **Add New Project** dialog box.\n\n2.  Select the **Workflow Console Application** template, name it `CustomActivityTemplateApp`, and then click **OK**.\n\n3.  Right-click the References directory of the CustomActivityTemplateApp project in **Solution Explorer** and choose **Add Reference** to open the **Add Reference** dialog box.\n\n4.  Go to the **Projects** tab and select **DelayActivityTemplate** from the **Project Name** column on the left and click **OK** to add a reference to the DelayActivityTemplate.dll file that you created in the first procedure.\n\n5.  Right-click the CustomActivityTemplateApp project in **Solution Explorer** and choose **Build** to compile the application.\n\n6.  Right-click the CustomActivityTemplateApp project in **Solution Explorer** and choose **Set as Startup Project**.\n\n7.  Select **Start Without Debugging** from the **Debug** menu and press any key to continue when prompted from the cmd.exe window.\n\n8.  Open the Workflow1.xaml file and open the **Toolbox**.\n\n9. Locate the **MyDelayActivity** template in the **DelayActivityTemplate** category. Drag it onto the design surface. Confirm in the **Properties** window that the `Duration` property has been set to 10 seconds.\n\n## Example\n The MyDelayActivity.cs file should contain the following code.\n\n```\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\n//Namespaces added\nusing System.Activities;\nusing System.Activities.Statements;\nusing System.Activities.Presentation;\nusing System.Windows;\n\nnamespace DelayActivityTemplate\n{\n    public sealed class MyDelayActivity : IActivityTemplateFactory\n    {\n        public Activity Create(System.Windows.DependencyObject target)\n        {\n            return new System.Activities.Statements.Delay\n            {\n                DisplayName = \"DelayActivityTemplate\",\n                Duration = new TimeSpan(0, 0, 10)\n\n            };\n        }\n    }\n}\n```\n\n## See also\n\n- <xref:System.Activities.Presentation.IActivityTemplateFactory>\n- [Customizing the Workflow Design Experience](customizing-the-workflow-design-experience.md)","nodes":[{"pos":[4,125],"embed":true,"restype":"x-metadata","content":"title: \"How to: Create a Custom Activity Template\"\nms.date: \"03/30/2017\"\nms.assetid: 6760a5cc-6eb8-465f-b4fa-f89b39539429","nodes":[{"content":"How to: Create a Custom Activity Template","nodes":[{"pos":[0,41],"content":"How to: Create a Custom Activity Template","nodes":[{"content":"How to: Create a Custom Activity Template","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[132,173],"content":"How to: Create a Custom Activity Template","linkify":"How to: Create a Custom Activity Template","nodes":[{"content":"How to: Create a Custom Activity Template","pos":[0,41]}]},{"content":"Custom activity templates are used to customize the configuration of activities, including custom composite activities, so that users do not have to create each activity individually and configure their properties and other settings manually.","pos":[175,417]},{"content":"These custom templates can be made available in the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept> on the <ph id=\"ph1\">[!INCLUDE[wfd1](../../../includes/wfd1-md.md)]</ph> or from a rehosted designer, from which users can drag them onto the preconfigured design surface.","pos":[418,634],"source":" These custom templates can be made available in the **Toolbox** on the [!INCLUDE[wfd1](../../../includes/wfd1-md.md)] or from a rehosted designer, from which users can drag them onto the preconfigured design surface."},{"content":"<ph id=\"ph1\">[!INCLUDE[wfd2](../../../includes/wfd2-md.md)]</ph> ships with good examples of such templates: the <bpt id=\"p1\">[</bpt>SendAndReceiveReply Template Designer<ept id=\"p1\">](/visualstudio/workflow-designer/sendandreceivereply-template-designer)</ept> and the <bpt id=\"p2\">[</bpt>ReceiveAndSendReply Template Designer<ept id=\"p2\">](/visualstudio/workflow-designer/receiveandsendreply-template-designer)</ept> in the <bpt id=\"p3\">[</bpt>Messaging Activity Designers<ept id=\"p3\">](/visualstudio/workflow-designer/messaging-activity-designers)</ept> category.","pos":[635,1069],"source":"[!INCLUDE[wfd2](../../../includes/wfd2-md.md)] ships with good examples of such templates: the [SendAndReceiveReply Template Designer](/visualstudio/workflow-designer/sendandreceivereply-template-designer) and the [ReceiveAndSendReply Template Designer](/visualstudio/workflow-designer/receiveandsendreply-template-designer) in the [Messaging Activity Designers](/visualstudio/workflow-designer/messaging-activity-designers) category."},{"pos":[1072,1343],"content":"The first procedure in this topic describes how to create a custom activity template for a <bpt id=\"p1\">**</bpt>Delay<ept id=\"p1\">**</ept> activity and the second procedure describes briefly how to make it available in a <ph id=\"ph1\">[!INCLUDE[wfd2](../../../includes/wfd2-md.md)]</ph> to verify that the custom template works.","source":"The first procedure in this topic describes how to create a custom activity template for a **Delay** activity and the second procedure describes briefly how to make it available in a [!INCLUDE[wfd2](../../../includes/wfd2-md.md)] to verify that the custom template works."},{"content":"Custom activity templates must implement the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.IActivityTemplateFactory&gt;</ph>.","pos":[1346,1454],"source":"Custom activity templates must implement the <xref:System.Activities.Presentation.IActivityTemplateFactory>."},{"content":"The interface has a single <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.IActivityTemplateFactory.Create%2A&gt;</ph> method with which you can create and configure the activity instances used in the template.","pos":[1455,1646],"source":" The interface has a single <xref:System.Activities.Presentation.IActivityTemplateFactory.Create%2A> method with which you can create and configure the activity instances used in the template."},{"pos":[1651,1694],"content":"To create a template for the Delay activity","linkify":"To create a template for the Delay activity","nodes":[{"content":"To create a template for the Delay activity","pos":[0,43]}]},{"content":"Start Visual Studio 2010.","pos":[1700,1725]},{"pos":[1731,1799],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, point to <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>, and then select <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"On the **File** menu, point to **New**, and then select **Project**."},{"pos":[1806,1843],"content":"The <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box opens.","source":"The **New Project** dialog box opens."},{"pos":[1849,2007],"content":"In the <bpt id=\"p1\">**</bpt>Project Types<ept id=\"p1\">**</ept> pane, select <bpt id=\"p2\">**</bpt>Workflow<ept id=\"p2\">**</ept> from either the <bpt id=\"p3\">**</bpt>Visual C#<ept id=\"p3\">**</ept> projects or <bpt id=\"p4\">**</bpt>Visual Basic<ept id=\"p4\">**</ept> groupings depending on your language preference.","source":"In the **Project Types** pane, select **Workflow** from either the **Visual C#** projects or **Visual Basic** groupings depending on your language preference."},{"pos":[2013,2068],"content":"In the <bpt id=\"p1\">**</bpt>Templates<ept id=\"p1\">**</ept> pane, select <bpt id=\"p2\">**</bpt>Activity Library<ept id=\"p2\">**</ept>.","source":"In the **Templates** pane, select **Activity Library**."},{"pos":[2074,2125],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, enter <ph id=\"ph1\">`DelayActivityTemplate`</ph>.","source":"In the **Name** box, enter `DelayActivityTemplate`."},{"pos":[2131,2227],"content":"Accept the defaults in the <bpt id=\"p1\">**</bpt>Location<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Solution name<ept id=\"p2\">**</ept> text boxes, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","source":"Accept the defaults in the **Location** and **Solution name** text boxes, and then click **OK**."},{"pos":[2233,2402],"content":"Right-click the References directory of the DelayActivityTemplate project in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and choose <bpt id=\"p2\">**</bpt>Add Reference<ept id=\"p2\">**</ept> to open the <bpt id=\"p3\">**</bpt>Add Reference<ept id=\"p3\">**</ept> dialog box.","source":"Right-click the References directory of the DelayActivityTemplate project in **Solution Explorer** and choose **Add Reference** to open the **Add Reference** dialog box."},{"pos":[2408,2589],"content":"Go to the <bpt id=\"p1\">**</bpt>.NET<ept id=\"p1\">**</ept> tab and select <bpt id=\"p2\">**</bpt>PresentationFramework<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Component Name<ept id=\"p3\">**</ept> column on the left and click <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept> to add a reference to the PresentationFramework.dll file.","source":"Go to the **.NET** tab and select **PresentationFramework** from the **Component Name** column on the left and click **OK** to add a reference to the PresentationFramework.dll file."},{"content":"Repeat this procedure to add references to the System.Activities.Presentation.dll and the WindowsBase.dll files.","pos":[2594,2706]},{"pos":[2712,2864],"content":"Right-click the DelayActivityTemplate project in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and choose <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept> and then <bpt id=\"p3\">**</bpt>New Item<ept id=\"p3\">**</ept> to open the <bpt id=\"p4\">**</bpt>Add New Item<ept id=\"p4\">**</ept> dialog box.","source":"Right-click the DelayActivityTemplate project in **Solution Explorer** and choose **Add** and then **New Item** to open the **Add New Item** dialog box."},{"pos":[2870,2948],"content":"Select the <bpt id=\"p1\">**</bpt>Class<ept id=\"p1\">**</ept> template, name it MyDelayTemplate, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"Select the **Class** template, name it MyDelayTemplate, and then click **OK**."},{"content":"Open the MyDelayTemplate.cs file and add the following statements.","pos":[2954,3020]},{"content":"Implement the <ph id=\"ph1\">&lt;xref:System.Activities.Presentation.IActivityTemplateFactory&gt;</ph> with the <ph id=\"ph2\">`MyDelayActivity`</ph> class with the following code.","pos":[3203,3337],"source":"Implement the <xref:System.Activities.Presentation.IActivityTemplateFactory> with the `MyDelayActivity` class with the following code."},{"content":"This configures the delay to have a duration of 10 seconds.","pos":[3338,3397]},{"pos":[3783,3880],"content":"Select <bpt id=\"p1\">**</bpt>Build Solution<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Build<ept id=\"p2\">**</ept> menu to generate the DelayActivityTemplate.dll file.","source":"Select **Build Solution** from the **Build** menu to generate the DelayActivityTemplate.dll file."},{"pos":[3886,3939],"content":"To make the template available in a Workflow Designer","linkify":"To make the template available in a Workflow Designer","nodes":[{"content":"To make the template available in a Workflow Designer","pos":[0,53]}]},{"pos":[3945,4104],"content":"Right-click the DelayActivityTemplate solution in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and choose <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept> and then <bpt id=\"p3\">**</bpt>New Project<ept id=\"p3\">**</ept> to open the <bpt id=\"p4\">**</bpt>Add New Project<ept id=\"p4\">**</ept> dialog box.","source":"Right-click the DelayActivityTemplate solution in **Solution Explorer** and choose **Add** and then **New Project** to open the **Add New Project** dialog box."},{"pos":[4110,4223],"content":"Select the <bpt id=\"p1\">**</bpt>Workflow Console Application<ept id=\"p1\">**</ept> template, name it <ph id=\"ph1\">`CustomActivityTemplateApp`</ph>, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"Select the **Workflow Console Application** template, name it `CustomActivityTemplateApp`, and then click **OK**."},{"pos":[4229,4402],"content":"Right-click the References directory of the CustomActivityTemplateApp project in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and choose <bpt id=\"p2\">**</bpt>Add Reference<ept id=\"p2\">**</ept> to open the <bpt id=\"p3\">**</bpt>Add Reference<ept id=\"p3\">**</ept> dialog box.","source":"Right-click the References directory of the CustomActivityTemplateApp project in **Solution Explorer** and choose **Add Reference** to open the **Add Reference** dialog box."},{"pos":[4408,4631],"content":"Go to the <bpt id=\"p1\">**</bpt>Projects<ept id=\"p1\">**</ept> tab and select <bpt id=\"p2\">**</bpt>DelayActivityTemplate<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Project Name<ept id=\"p3\">**</ept> column on the left and click <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept> to add a reference to the DelayActivityTemplate.dll file that you created in the first procedure.","source":"Go to the **Projects** tab and select **DelayActivityTemplate** from the **Project Name** column on the left and click **OK** to add a reference to the DelayActivityTemplate.dll file that you created in the first procedure."},{"pos":[4637,4760],"content":"Right-click the CustomActivityTemplateApp project in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and choose <bpt id=\"p2\">**</bpt>Build<ept id=\"p2\">**</ept> to compile the application.","source":"Right-click the CustomActivityTemplateApp project in **Solution Explorer** and choose **Build** to compile the application."},{"pos":[4766,4879],"content":"Right-click the CustomActivityTemplateApp project in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and choose <bpt id=\"p2\">**</bpt>Set as Startup Project<ept id=\"p2\">**</ept>.","source":"Right-click the CustomActivityTemplateApp project in **Solution Explorer** and choose **Set as Startup Project**."},{"pos":[4885,5012],"content":"Select <bpt id=\"p1\">**</bpt>Start Without Debugging<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Debug<ept id=\"p2\">**</ept> menu and press any key to continue when prompted from the cmd.exe window.","source":"Select **Start Without Debugging** from the **Debug** menu and press any key to continue when prompted from the cmd.exe window."},{"pos":[5018,5072],"content":"Open the Workflow1.xaml file and open the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>.","source":"Open the Workflow1.xaml file and open the **Toolbox**."},{"content":"Locate the <bpt id=\"p1\">**</bpt>MyDelayActivity<ept id=\"p1\">**</ept> template in the <bpt id=\"p2\">**</bpt>DelayActivityTemplate<ept id=\"p2\">**</ept> category.","pos":[5077,5159],"source":"Locate the **MyDelayActivity** template in the **DelayActivityTemplate** category."},{"content":"Drag it onto the design surface.","pos":[5160,5192]},{"content":"Confirm in the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window that the <ph id=\"ph1\">`Duration`</ph> property has been set to 10 seconds.","pos":[5193,5286],"source":" Confirm in the **Properties** window that the `Duration` property has been set to 10 seconds."},{"pos":[5291,5298],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The MyDelayActivity.cs file should contain the following code.","pos":[5300,5362]},{"pos":[6003,6011],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6080,6171],"content":"<bpt id=\"p1\">[</bpt>Customizing the Workflow Design Experience<ept id=\"p1\">](customizing-the-workflow-design-experience.md)</ept>","source":"[Customizing the Workflow Design Experience](customizing-the-workflow-design-experience.md)"}]}