{"content":"---\ntitle: \"How to: Use a Service Moniker with WSDL Contracts | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: a88d9650-bb50-4f48-8c85-12f5ce98a83a\ncaps.latest.revision: 8\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Use a Service Moniker with WSDL Contracts\nThere are situations when you may want to have a completely self-contained COM Interop client. The service you want to call may not expose a MEX endpoint, and the WCF client DLL may not be registered for COM interop. In these cases, you can create a WSDL file that describes the service and pass it into the WCF service moniker. This topic describes how to call the Getting Started WCF sample using a WCF WSDL moniker.  \n  \n### Using the WSDL service moniker  \n  \n1.  Open and build the GettingStarted sample solution.  \n  \n2.  Open Internet Explorer and browse to http://localhost/ServiceModelSamples/Service.svc to make sure that the service is working.  \n  \n3.  In the Service.cs file, add the following attribute on the CalculatorService class:  \n  \n     [!code-csharp[S_WSDL_Client#0](../../../../samples/snippets/csharp/VS_Snippets_CFX/s_wsdl_client/cs/service.cs#0)]  \n  \n4.  Add a binding namespace to the service App.config:  \n  \n  \n  \n5.  Create a WSDL file for the application to read. Because the namespaces were added in steps 3 and 4, you can use IE to query for the entire WSDL description of the service by browsing to http://localhost/ServiceModelSamples/Service.svc?wsdl. You can then save the file from Internet Explorer as serviceWSDL.xml. If you do not specify the namespaces in steps 3 and 4, the WSDL document returned from querying the above URL will not be the complete WSDL. The WSDL document returned will include several import statements that import other WSDL documents. You will have to go through each import statement and build the complete WSDL document, combining the WSDL returned from the service with the WSDL imported.  \n  \n6.  Open Visual Basic 6.0 and create a new Standard .exe file. Add a button to the form and double-click the button to add the following code to the Click handler:  \n  \n    ```  \n    ' Open the WSDL contract file and read it all into the wsdlContract string.  \n    Const ForReading = 1  \n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")  \n    Set objFile = objFSO.OpenTextFile(\"c:\\serviceWsdl.xml\", ForReading)  \n    wsdlContract = objFile.ReadAll  \n    objFile.Close  \n  \n    ' Create a string for the service moniker including the content of the WSDL contract file.  \n    wsdlMonikerString = \"service4:address='http://localhost/ServiceModelSamples/service.svc'\"  \n    wsdlMonikerString = wsdlMonikerString + \", wsdl='\" & wsdlContract & \"'\"  \n    wsdlMonikerString = wsdlMonikerString + \", binding=WSHttpBinding_ICalculator, bindingNamespace='http://Microsoft.ServiceModel.Samples'\"  \n    wsdlMonikerString = wsdlMonikerString + \", contract=ICalculator, contractNamespace='http://Microsoft.ServiceModel.Samples'\"  \n  \n    ' Create the service moniker object.  \n    Set wsdlServiceMoniker = GetObject(wsdlMonikerString)  \n  \n    ' Call the service operations using the moniker object.  \n    MsgBox \"WSDL service moniker: 145 - 76.54 = \" & wsdlServiceMoniker.Subtract(145, 76.54)  \n    ```  \n  \n    > [!NOTE]\n    >  If the moniker is malformed or if the service is unavailable the call to `GetObject` will return an error saying \"Invalid Syntax\".  If you receive this error, make sure the moniker you are using is correct and the service is available.  \n  \n7.  Run the Visual Basic application. A message box will be displayed with the results of calling Subtract(145, 76.54).  \n  \n## See Also  \n [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md)   \n [Integrating with COM Applications Overview](../../../../docs/framework/wcf/feature-details/integrating-with-com-applications-overview.md)","nodes":[{"pos":[4,369],"embed":true,"restype":"x-metadata","content":"title: \"How to: Use a Service Moniker with WSDL Contracts | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: a88d9650-bb50-4f48-8c85-12f5ce98a83a\ncaps.latest.revision: 8\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"","nodes":[{"content":"How to: Use a Service Moniker with WSDL Contracts | Microsoft Docs","nodes":[{"pos":[0,66],"content":"How to: Use a Service Moniker with WSDL Contracts | Microsoft Docs","nodes":[{"content":"How to: Use a Service Moniker with WSDL Contracts | Microsoft Docs","pos":[0,66]}]}],"path":["title"]}],"yml":true},{"pos":[376,425],"content":"How to: Use a Service Moniker with WSDL Contracts","linkify":"How to: Use a Service Moniker with WSDL Contracts","nodes":[{"content":"How to: Use a Service Moniker with WSDL Contracts","pos":[0,49]}]},{"content":"There are situations when you may want to have a completely self-contained COM Interop client.","pos":[426,520]},{"content":"The service you want to call may not expose a MEX endpoint, and the WCF client DLL may not be registered for COM interop.","pos":[521,642]},{"content":"In these cases, you can create a WSDL file that describes the service and pass it into the WCF service moniker.","pos":[643,754]},{"content":"This topic describes how to call the Getting Started WCF sample using a WCF WSDL moniker.","pos":[755,844]},{"pos":[854,884],"content":"Using the WSDL service moniker","linkify":"Using the WSDL service moniker","nodes":[{"content":"Using the WSDL service moniker","pos":[0,30]}]},{"content":"Open and build the GettingStarted sample solution.","pos":[894,944]},{"content":"Open Internet Explorer and browse to http://localhost/ServiceModelSamples/Service.svc to make sure that the service is working.","pos":[954,1081]},{"content":"In the Service.cs file, add the following attribute on the CalculatorService class:","pos":[1091,1174]},{"content":"Add a binding namespace to the service App.config:","pos":[1309,1359]},{"content":"Create a WSDL file for the application to read.","pos":[1375,1422]},{"content":"Because the namespaces were added in steps 3 and 4, you can use IE to query for the entire WSDL description of the service by browsing to http://localhost/ServiceModelSamples/Service.svc?wsdl.","pos":[1423,1615]},{"content":"You can then save the file from Internet Explorer as serviceWSDL.xml.","pos":[1616,1685]},{"content":"If you do not specify the namespaces in steps 3 and 4, the WSDL document returned from querying the above URL will not be the complete WSDL.","pos":[1686,1826]},{"content":"The WSDL document returned will include several import statements that import other WSDL documents.","pos":[1827,1926]},{"content":"You will have to go through each import statement and build the complete WSDL document, combining the WSDL returned from the service with the WSDL imported.","pos":[1927,2083]},{"content":"Open Visual Basic 6.0 and create a new Standard .exe file.","pos":[2093,2151]},{"content":"Add a button to the form and double-click the button to add the following code to the Click handler:","pos":[2152,2252]},{"pos":[3400,3650],"content":"[!NOTE]\nIf the moniker is malformed or if the service is unavailable the call to `GetObject` will return an error saying \"Invalid Syntax\".  If you receive this error, make sure the moniker you are using is correct and the service is available.","leadings":["","    >  "],"nodes":[{"content":"If the moniker is malformed or if the service is unavailable the call to `GetObject` will return an error saying \"Invalid Syntax\".  If you receive this error, make sure the moniker you are using is correct and the service is available.","pos":[8,243],"nodes":[{"content":"If the moniker is malformed or if the service is unavailable the call to <ph id=\"ph1\">`GetObject`</ph> will return an error saying \"Invalid Syntax\".","pos":[0,130],"source":"If the moniker is malformed or if the service is unavailable the call to `GetObject` will return an error saying \"Invalid Syntax\"."},{"content":"If you receive this error, make sure the moniker you are using is correct and the service is available.","pos":[132,235]}]}]},{"content":"Run the Visual Basic application.","pos":[3660,3693]},{"content":"A message box will be displayed with the results of calling Subtract(145, 76.54).","pos":[3694,3775]},{"pos":[3784,3792],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Getting Started<ept id=\"p1\">](../../../../docs/framework/wcf/samples/getting-started-sample.md)</ept><ph id=\"ph1\"> </ph>","pos":[3796,3880],"source":"[Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md) "},{"content":"<bpt id=\"p1\">[</bpt>Integrating with COM Applications Overview<ept id=\"p1\">](../../../../docs/framework/wcf/feature-details/integrating-with-com-applications-overview.md)</ept>","pos":[3884,4022],"source":"[Integrating with COM Applications Overview](../../../../docs/framework/wcf/feature-details/integrating-with-com-applications-overview.md)"}]}