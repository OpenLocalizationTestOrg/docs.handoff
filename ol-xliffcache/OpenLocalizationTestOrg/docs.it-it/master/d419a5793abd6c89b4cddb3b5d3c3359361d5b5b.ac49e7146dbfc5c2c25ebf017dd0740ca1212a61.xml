{"content":"---\ntitle: \"Custom Binding Reliable Session\"\nms.date: \"03/30/2017\"\nms.assetid: c5fcd409-246f-4f3e-b3f1-629506ca4c04\n---\n# Custom Binding Reliable Session\nA custom binding is defined by an ordered list of discrete binding elements. This sample demonstrates how to configure a custom binding with various transport and message encoding elements, especially enabling reliable sessions.  \n  \n> [!IMPORTANT]\n>  The samples may already be installed on your machine. Check for the following (default) directory before continuing.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples`  \n>   \n>  If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples. This sample is located in the following directory.  \n>   \n>  `<InstallDrive>:\\WF_WCF_Samples\\WCF\\Basic\\Binding\\Custom\\ReliableSession`  \n  \n## Sample Details  \n Reliable sessions provide features for reliable messaging and sessions. Reliable messaging retries communication on failure and allows delivery assurances such as in-order arrival of messages to be specified. Sessions maintain state for clients between calls. The sample implements sessions for maintaining client state and specifies in-order delivery assurances. The sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md) that implements a calculator service. The reliable session features are enabled and configured in the application configuration files for the client and service.  \n  \n> [!NOTE]\n>  The set-up procedure and build instructions for this sample are located at the end of this topic.  \n  \n The ordering of binding elements is important in defining a custom binding, because each represents a layer in the channel stack (see [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md)).  \n  \n The service configuration for the sample is defined as shown in the following code example.  \n  \n```xml  \n<?xml version=\"1.0\" encoding=\"utf-8\" ?>  \n<configuration>  \n  <system.serviceModel>  \n    <services>  \n      <service   \n          name=\"Microsoft.ServiceModel.Samples.CalculatorService\"  \n          behaviorConfiguration=\"CalculatorServiceBehavior\">  \n        <!-- This endpoint is exposed at the base address provided by host: http://localhost/servicemodelsamples/service.svc  -->  \n        <!-- specify customBinding binding and a binding configuration to use -->  \n        <endpoint address=\"\"  \n                  binding=\"customBinding\"  \n                  bindingConfiguration=\"Binding1\"   \n                  contract=\"Microsoft.ServiceModel.Samples.ICalculator\" />  \n        <!-- The mex endpoint is exposed at http://localhost/servicemodelsamples/service.svc/mex -->  \n        <endpoint address=\"mex\"  \n                  binding=\"mexHttpBinding\"  \n                  contract=\"IMetadataExchange\" />  \n      </service>  \n    </services>  \n  \n    <!-- custom binding configuration - configures HTTP transport, reliable sessions -->  \n    <bindings>  \n      <customBinding>  \n        <binding name=\"Binding1\">  \n          <reliableSession />  \n          <security authenticationMode=\"SecureConversation\"  \n                     requireSecurityContextCancellation=\"true\">  \n          </security>  \n          <compositeDuplex />  \n          <oneWay />  \n          <textMessageEncoding messageVersion=\"Soap12WSAddressing10\" writeEncoding=\"utf-8\" />  \n          <httpTransport authenticationScheme=\"Anonymous\" bypassProxyOnLocal=\"false\"  \n                        hostNameComparisonMode=\"StrongWildcard\"   \n                        proxyAuthenticationScheme=\"Anonymous\" realm=\"\"   \n                        useDefaultWebProxy=\"true\" />  \n        </binding>  \n      </customBinding>  \n    </bindings>  \n  \n    <!--For debugging purposes set the includeExceptionDetailInFaults attribute to true-->  \n    <behaviors>  \n      <serviceBehaviors>  \n        <behavior name=\"CalculatorServiceBehavior\">  \n          <serviceMetadata httpGetEnabled=\"True\"/>  \n          <serviceDebug includeExceptionDetailInFaults=\"False\" />  \n        </behavior>  \n      </serviceBehaviors>  \n    </behaviors>  \n  \n  </system.serviceModel>  \n  \n</configuration>  \n```  \n  \n When running in a cross-machine scenario, you must change client's endpoint address to reflect the host name of the service.  \n  \n When you run the sample, the operation requests and responses are displayed in the client console window. Press ENTER in the client window to shut down the client.  \n  \n```  \nAdd(100,15.99) = 115.99  \nSubtract(145,76.54) = 68.46  \nMultiply(9,81.25) = 731.25  \nDivide(22,7) = 3.14285714285714  \n  \nPress <ENTER> to terminate client.  \n```  \n  \n#### To set up, build, and run the sample  \n  \n1.  Install [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 4.0 using the following command:  \n  \n    ```  \n    %windir%\\Microsoft.NET\\Framework\\v4.0.XXXXX\\aspnet_regiis.exe /i /enable  \n    ```  \n  \n2.  Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md).  \n  \n3.  To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md).  \n  \n4.  To run the sample in a single- or cross-machine configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md).  \n  \n    > [!IMPORTANT]\n    >  When running the client in a cross-machine configuration, be sure to replace \"localhost\" in both the `address` attribute of the [\\<endpoint>](../../../../docs/framework/configure-apps/file-schema/wcf/endpoint-element.md) element and the `clientBaseAddress` attribute of the [\\<compositeDuplex>](../../../../docs/framework/configure-apps/file-schema/wcf/compositeduplex.md) with the name of the appropriate machine, as shown in the following example.  \n  \n    ```xml  \n    <endpoint name = \"\"  \n    address=\"http://service_machine_name/servicemodelsamples/service.svc\"  \n    ... />  \n    <compositeDuplex clientBaseAddress=\"http://client_machine_name:8000/myClient/\" />  \n    ```  \n","nodes":[{"pos":[4,115],"embed":true,"restype":"x-metadata","content":"title: \"Custom Binding Reliable Session\"\nms.date: \"03/30/2017\"\nms.assetid: c5fcd409-246f-4f3e-b3f1-629506ca4c04","nodes":[{"content":"Custom Binding Reliable Session","nodes":[{"pos":[0,31],"content":"Custom Binding Reliable Session","nodes":[{"content":"Custom Binding Reliable Session","pos":[0,31]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[122,153],"content":"Custom Binding Reliable Session","linkify":"Custom Binding Reliable Session","nodes":[{"content":"Custom Binding Reliable Session","pos":[0,31]}]},{"content":"A custom binding is defined by an ordered list of discrete binding elements.","pos":[154,230]},{"content":"This sample demonstrates how to configure a custom binding with various transport and message encoding elements, especially enabling reliable sessions.","pos":[231,382]},{"pos":[390,522],"content":"[!IMPORTANT]\n The samples may already be installed on your machine. Check for the following (default) directory before continuing.","leadings":["","> "],"nodes":[{"content":"The samples may already be installed on your machine. Check for the following (default) directory before continuing.","pos":[14,130],"nodes":[{"content":"The samples may already be installed on your machine.","pos":[0,53]},{"content":"Check for the following (default) directory before continuing.","pos":[54,116]}]}]},{"content":"If this directory does not exist, go to <bpt id=\"p1\">[</bpt>Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=150780)</ept> to download all Windows Communication Foundation (WCF) and <ph id=\"ph1\">[!INCLUDE[wf1](../../../../includes/wf1-md.md)]</ph> samples.","pos":[576,886],"source":"If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples."},{"content":"This sample is located in the following directory.","pos":[887,937]},{"pos":[1030,1044],"content":"Sample Details","linkify":"Sample Details","nodes":[{"content":"Sample Details","pos":[0,14]}]},{"content":"Reliable sessions provide features for reliable messaging and sessions.","pos":[1048,1119]},{"content":"Reliable messaging retries communication on failure and allows delivery assurances such as in-order arrival of messages to be specified.","pos":[1120,1256]},{"content":"Sessions maintain state for clients between calls.","pos":[1257,1307]},{"content":"The sample implements sessions for maintaining client state and specifies in-order delivery assurances.","pos":[1308,1411]},{"content":"The sample is based on the <bpt id=\"p1\">[</bpt>Getting Started<ept id=\"p1\">](../../../../docs/framework/wcf/samples/getting-started-sample.md)</ept> that implements a calculator service.","pos":[1412,1560],"source":" The sample is based on the [Getting Started](../../../../docs/framework/wcf/samples/getting-started-sample.md) that implements a calculator service."},{"content":"The reliable session features are enabled and configured in the application configuration files for the client and service.","pos":[1561,1684]},{"pos":[1692,1800],"content":"[!NOTE]\n The set-up procedure and build instructions for this sample are located at the end of this topic.","leadings":["","> "],"nodes":[{"content":"The set-up procedure and build instructions for this sample are located at the end of this topic.","pos":[9,106]}]},{"pos":[1807,2021],"content":"The ordering of binding elements is important in defining a custom binding, because each represents a layer in the channel stack (see <bpt id=\"p1\">[</bpt>Custom Bindings<ept id=\"p1\">](../../../../docs/framework/wcf/extending/custom-bindings.md)</ept>).","source":"The ordering of binding elements is important in defining a custom binding, because each represents a layer in the channel stack (see [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md))."},{"content":"The service configuration for the sample is defined as shown in the following code example.","pos":[2028,2119]},{"content":"When running in a cross-machine scenario, you must change client's endpoint address to reflect the host name of the service.","pos":[4378,4502]},{"content":"When you run the sample, the operation requests and responses are displayed in the client console window.","pos":[4509,4614]},{"content":"Press ENTER in the client window to shut down the client.","pos":[4615,4672]},{"pos":[4857,4893],"content":"To set up, build, and run the sample","linkify":"To set up, build, and run the sample","nodes":[{"content":"To set up, build, and run the sample","pos":[0,36]}]},{"pos":[4903,5001],"content":"Install <ph id=\"ph1\">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]</ph> 4.0 using the following command:","source":"Install [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 4.0 using the following command:"},{"pos":[5113,5312],"content":"Ensure that you have performed the <bpt id=\"p1\">[</bpt>One-Time Setup Procedure for the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)</ept>.","source":"Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/one-time-setup-procedure-for-the-wcf-samples.md)."},{"pos":[5322,5531],"content":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in <bpt id=\"p1\">[</bpt>Building the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/building-the-samples.md)</ept>.","source":"To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/building-the-samples.md)."},{"pos":[5541,5749],"content":"To run the sample in a single- or cross-machine configuration, follow the instructions in <bpt id=\"p1\">[</bpt>Running the Windows Communication Foundation Samples<ept id=\"p1\">](../../../../docs/framework/wcf/samples/running-the-samples.md)</ept>.","source":"To run the sample in a single- or cross-machine configuration, follow the instructions in [Running the Windows Communication Foundation Samples](../../../../docs/framework/wcf/samples/running-the-samples.md)."},{"pos":[5761,6230],"content":"[!IMPORTANT]\nWhen running the client in a cross-machine configuration, be sure to replace \"localhost\" in both the `address` attribute of the [\\<endpoint>](../../../../docs/framework/configure-apps/file-schema/wcf/endpoint-element.md) element and the `clientBaseAddress` attribute of the [\\<compositeDuplex>](../../../../docs/framework/configure-apps/file-schema/wcf/compositeduplex.md) with the name of the appropriate machine, as shown in the following example.","leadings":["","    >  "],"nodes":[{"content":"When running the client in a cross-machine configuration, be sure to replace \"localhost\" in both the <ph id=\"ph1\">`address`</ph> attribute of the <bpt id=\"p1\">[</bpt><ph id=\"ph2\">\\&lt;</ph>endpoint&gt;<ept id=\"p1\">](../../../../docs/framework/configure-apps/file-schema/wcf/endpoint-element.md)</ept> element and the <ph id=\"ph3\">`clientBaseAddress`</ph> attribute of the <bpt id=\"p2\">[</bpt><ph id=\"ph4\">\\&lt;</ph>compositeDuplex&gt;<ept id=\"p2\">](../../../../docs/framework/configure-apps/file-schema/wcf/compositeduplex.md)</ept> with the name of the appropriate machine, as shown in the following example.","pos":[13,462],"source":"When running the client in a cross-machine configuration, be sure to replace \"localhost\" in both the `address` attribute of the [\\<endpoint>](../../../../docs/framework/configure-apps/file-schema/wcf/endpoint-element.md) element and the `clientBaseAddress` attribute of the [\\<compositeDuplex>](../../../../docs/framework/configure-apps/file-schema/wcf/compositeduplex.md) with the name of the appropriate machine, as shown in the following example."}]}]}