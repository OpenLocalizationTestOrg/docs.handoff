{"content":"---\ntitle: \"ICLRTask2 Interface\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"ICLRTask2\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRTask2\"\nhelpviewer_keywords: \n  - \"ICLRTask2 interface [.NET Framework hosting]\"\nms.assetid: b5a22ebc-0582-49de-91f9-97a3d9789290\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# ICLRTask2 Interface\nProvides all the functionality of the [ICLRTask](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md) interface; in addition, provides methods that allow thread aborts to be delayed on the current thread.  \n  \n## Methods  \n  \n|Method|Description|  \n|------------|-----------------|  \n|[BeginPreventAsyncAbort Method](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-beginpreventasyncabort-method.md)|Delays new thread abort requests on the current thread.|  \n|[EndPreventAsyncAbort Method](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-endpreventasyncabort-method.md)|Allows new or pending thread abort requests to result in thread aborts on the current thread.|  \n  \n## Remarks  \n The `ICLRTask2` interface inherits the `ICLRTask` interface and adds methods that allow the host to delay thread aborts, to protect a region of code that must not fail. Calling `BeginPreventAsyncAbort` increments the delay-thread-abort counter for the current thread, and calling `EndPreventAsyncAbort` decrements it. Calls to `BeginPreventAsyncAbort` and `EndPreventAsyncAbort` can be nested. As long as the counter is greater than zero, thread aborts for the current thread are delayed.  \n  \n If calls to `BeginPreventAsyncAbort` and `EndPreventAsyncAbort` are not paired, it is possible to reach a state in which thread aborts cannot be delivered to the current thread.  \n  \n The delay is not honored for a thread that aborts itself.  \n  \n The functionality that is exposed by this feature is used internally by the virtual machine (VM). Misuse of these methods may cause unspecified behavior in the VM. For example, calling `EndPreventAsyncAbort` without first calling `BeginPreventAsyncAbort` could set the counter to zero when the VM has previously incremented it. Similarly, the internal counter is not checked for overflow. If it exceeds its integral limit because it is incremented by both the host and the VM, the resulting behavior is unspecified.  \n  \n For information about members inherited from `ICLRTask` and about the other uses of this interface, see the [ICLRTask](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md) interface.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See also\n\n- [ICLRTask Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md)\n- [ICLRTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)\n- [IHostTask Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md)\n- [IHostTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-interface.md)\n- [Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)\n","nodes":[{"pos":[4,353],"embed":true,"restype":"x-metadata","content":"title: \"ICLRTask2 Interface\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"ICLRTask2\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRTask2\"\nhelpviewer_keywords: \n  - \"ICLRTask2 interface [.NET Framework hosting]\"\nms.assetid: b5a22ebc-0582-49de-91f9-97a3d9789290\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"ICLRTask2 Interface","nodes":[{"pos":[0,19],"content":"ICLRTask2 Interface","nodes":[{"content":"ICLRTask2 Interface","pos":[0,19]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[360,379],"content":"ICLRTask2 Interface","linkify":"ICLRTask2 Interface","nodes":[{"content":"ICLRTask2 Interface","pos":[0,19]}]},{"pos":[380,603],"content":"Provides all the functionality of the <bpt id=\"p1\">[</bpt>ICLRTask<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md)</ept> interface; in addition, provides methods that allow thread aborts to be delayed on the current thread.","source":"Provides all the functionality of the [ICLRTask](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md) interface; in addition, provides methods that allow thread aborts to be delayed on the current thread."},{"pos":[612,619],"content":"Methods","linkify":"Methods","nodes":[{"content":"Methods","pos":[0,7]}]},{"content":"Method","pos":[626,632]},{"content":"Description","pos":[633,644]},{"pos":[684,808],"content":"<bpt id=\"p1\">[</bpt>BeginPreventAsyncAbort Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-beginpreventasyncabort-method.md)</ept>","source":"[BeginPreventAsyncAbort Method](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-beginpreventasyncabort-method.md)"},{"content":"Delays new thread abort requests on the current thread.","pos":[809,864]},{"pos":[869,989],"content":"<bpt id=\"p1\">[</bpt>EndPreventAsyncAbort Method<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-endpreventasyncabort-method.md)</ept>","source":"[EndPreventAsyncAbort Method](../../../../docs/framework/unmanaged-api/hosting/iclrtask2-endpreventasyncabort-method.md)"},{"content":"Allows new or pending thread abort requests to result in thread aborts on the current thread.","pos":[990,1083]},{"pos":[1093,1100],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`ICLRTask2`</ph> interface inherits the <ph id=\"ph2\">`ICLRTask`</ph> interface and adds methods that allow the host to delay thread aborts, to protect a region of code that must not fail.","pos":[1104,1272],"source":"The `ICLRTask2` interface inherits the `ICLRTask` interface and adds methods that allow the host to delay thread aborts, to protect a region of code that must not fail."},{"content":"Calling <ph id=\"ph1\">`BeginPreventAsyncAbort`</ph> increments the delay-thread-abort counter for the current thread, and calling <ph id=\"ph2\">`EndPreventAsyncAbort`</ph> decrements it.","pos":[1273,1421],"source":" Calling `BeginPreventAsyncAbort` increments the delay-thread-abort counter for the current thread, and calling `EndPreventAsyncAbort` decrements it."},{"content":"Calls to <ph id=\"ph1\">`BeginPreventAsyncAbort`</ph> and <ph id=\"ph2\">`EndPreventAsyncAbort`</ph> can be nested.","pos":[1422,1497],"source":" Calls to `BeginPreventAsyncAbort` and `EndPreventAsyncAbort` can be nested."},{"content":"As long as the counter is greater than zero, thread aborts for the current thread are delayed.","pos":[1498,1592]},{"pos":[1599,1776],"content":"If calls to <ph id=\"ph1\">`BeginPreventAsyncAbort`</ph> and <ph id=\"ph2\">`EndPreventAsyncAbort`</ph> are not paired, it is possible to reach a state in which thread aborts cannot be delivered to the current thread.","source":"If calls to `BeginPreventAsyncAbort` and `EndPreventAsyncAbort` are not paired, it is possible to reach a state in which thread aborts cannot be delivered to the current thread."},{"content":"The delay is not honored for a thread that aborts itself.","pos":[1783,1840]},{"content":"The functionality that is exposed by this feature is used internally by the virtual machine (VM).","pos":[1847,1944]},{"content":"Misuse of these methods may cause unspecified behavior in the VM.","pos":[1945,2010]},{"content":"For example, calling <ph id=\"ph1\">`EndPreventAsyncAbort`</ph> without first calling <ph id=\"ph2\">`BeginPreventAsyncAbort`</ph> could set the counter to zero when the VM has previously incremented it.","pos":[2011,2174],"source":" For example, calling `EndPreventAsyncAbort` without first calling `BeginPreventAsyncAbort` could set the counter to zero when the VM has previously incremented it."},{"content":"Similarly, the internal counter is not checked for overflow.","pos":[2175,2235]},{"content":"If it exceeds its integral limit because it is incremented by both the host and the VM, the resulting behavior is unspecified.","pos":[2236,2362]},{"pos":[2369,2570],"content":"For information about members inherited from <ph id=\"ph1\">`ICLRTask`</ph> and about the other uses of this interface, see the <bpt id=\"p1\">[</bpt>ICLRTask<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md)</ept> interface.","source":"For information about members inherited from `ICLRTask` and about the other uses of this interface, see the [ICLRTask](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md) interface."},{"pos":[2579,2591],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2595,2699],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2706,2727],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2734,2784],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[2791,2899],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[2908,2916],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2920,3012],"content":"<bpt id=\"p1\">[</bpt>ICLRTask Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md)</ept>","source":"[ICLRTask Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtask-interface.md)"},{"pos":[3015,3121],"content":"<bpt id=\"p1\">[</bpt>ICLRTaskManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)</ept>","source":"[ICLRTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/iclrtaskmanager-interface.md)"},{"pos":[3124,3218],"content":"<bpt id=\"p1\">[</bpt>IHostTask Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md)</ept>","source":"[IHostTask Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttask-interface.md)"},{"pos":[3221,3329],"content":"<bpt id=\"p1\">[</bpt>IHostTaskManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-interface.md)</ept>","source":"[IHostTaskManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihosttaskmanager-interface.md)"},{"pos":[3332,3424],"content":"<bpt id=\"p1\">[</bpt>Hosting Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)</ept>","source":"[Hosting Interfaces](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)"}]}