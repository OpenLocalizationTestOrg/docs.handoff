{"content":"---\ntitle: \"Query Expression Syntax Examples: Aggregate Operators\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: d729120c-4c1b-4f34-bbe9-33694fca2dde\n---\n# Query Expression Syntax Examples: Aggregate Operators\nThe examples in this topic demonstrate how to use the <xref:System.Linq.Enumerable.Average%2A>, <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.Max%2A>, <xref:System.Linq.Enumerable.Min%2A>, and <xref:System.Linq.Enumerable.Sum%2A> methods to query the [AdventureWorks Sales Model](https://archive.codeplex.com/?p=msftdbprodsamples) using query expression syntax. The AdventureWorks Sales Model used in these examples is built from the Contact, Address, Product, SalesOrderHeader, and SalesOrderDetail tables in the AdventureWorks sample database.  \n  \n The examples in this topic use the following `using`/`Imports` statements:  \n  \n [!code-csharp[DP L2E Examples#ImportsUsing](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#importsusing)]\n [!code-vb[DP L2E Examples#ImportsUsing](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#importsusing)]  \n  \n## Average  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Average%2A> method to find the average list price of the products of each style.  \n  \n [!code-csharp[DP L2E Examples#Average2_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#average2_mq)]\n [!code-vb[DP L2E Examples#Average2_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#average2_mq)]  \n  \n### Example  \n The following example uses <xref:System.Linq.Enumerable.Average%2A> to get the average total due for each contact ID.  \n  \n [!code-csharp[DP L2E Examples#AverageGrouped_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#averagegrouped_mq)]\n [!code-vb[DP L2E Examples#AverageGrouped_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#averagegrouped_mq)]  \n  \n### Example  \n The following example uses <xref:System.Linq.Enumerable.Average%2A> to get the orders with the average total due for each contact.  \n  \n [!code-csharp[DP L2E Examples#AverageElements_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#averageelements_mq)]\n [!code-vb[DP L2E Examples#AverageElements_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#averageelements_mq)]  \n  \n## Count  \n  \n### Example  \n The following example uses <xref:System.Linq.Enumerable.Count%2A> to return a list of contact IDs and how many orders each has.  \n  \n [!code-csharp[DP L2E Examples#CountNested](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#countnested)]\n [!code-vb[DP L2E Examples#CountNested](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#countnested)]  \n  \n### Example  \n The following example groups products by color and uses <xref:System.Linq.Enumerable.Count%2A> to return the number of products in each color group.  \n  \n [!code-csharp[DP L2E Examples#CountGrouped](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#countgrouped)]\n [!code-vb[DP L2E Examples#CountGrouped](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#countgrouped)]  \n  \n## Max  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the largest total due for each contact ID.  \n  \n [!code-csharp[DP L2E Examples#MaxGrouped_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#maxgrouped_mq)]\n [!code-vb[DP L2E Examples#MaxGrouped_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#maxgrouped_mq)]  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the orders with the largest total due for each contact ID.  \n  \n [!code-csharp[DP L2E Examples#MaxElements_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#maxelements_mq)]\n [!code-vb[DP L2E Examples#MaxElements_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#maxelements_mq)]  \n  \n## Min  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the smallest total due for each contact ID.  \n  \n [!code-csharp[DP L2E Examples#MinGrouped_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#mingrouped_mq)]\n [!code-vb[DP L2E Examples#MinGrouped_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#mingrouped_mq)]  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the orders with the smallest total due for each contact.  \n  \n [!code-csharp[DP L2E Examples#MinElements_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#minelements_mq)]\n [!code-vb[DP L2E Examples#MinElements_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#minelements_mq)]  \n  \n## Sum  \n  \n### Example  \n The following example uses the <xref:System.Linq.Enumerable.Sum%2A> method to get the total due for each contact ID.  \n  \n [!code-csharp[DP L2E Examples#SumGrouped_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#sumgrouped_mq)]\n [!code-vb[DP L2E Examples#SumGrouped_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#sumgrouped_mq)]  \n  \n## See also\n\n- [Queries in LINQ to Entities](../../../../../../docs/framework/data/adonet/ef/language-reference/queries-in-linq-to-entities.md)\n","nodes":[{"pos":[4,171],"embed":true,"restype":"x-metadata","content":"title: \"Query Expression Syntax Examples: Aggregate Operators\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\nms.assetid: d729120c-4c1b-4f34-bbe9-33694fca2dde","nodes":[{"content":"Query Expression Syntax Examples: Aggregate Operators","nodes":[{"pos":[0,53],"content":"Query Expression Syntax Examples: Aggregate Operators","nodes":[{"content":"Query Expression Syntax Examples: Aggregate Operators","pos":[0,53]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[178,231],"content":"Query Expression Syntax Examples: Aggregate Operators","linkify":"Query Expression Syntax Examples: Aggregate Operators","nodes":[{"content":"Query Expression Syntax Examples: Aggregate Operators","pos":[0,53]}]},{"content":"The examples in this topic demonstrate how to use the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.Count%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Linq.Enumerable.Max%2A&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.Linq.Enumerable.Min%2A&gt;</ph>, and <ph id=\"ph5\">&lt;xref:System.Linq.Enumerable.Sum%2A&gt;</ph> methods to query the <bpt id=\"p1\">[</bpt>AdventureWorks Sales Model<ept id=\"p1\">](https://archive.codeplex.com/?p=msftdbprodsamples)</ept> using query expression syntax.","pos":[232,616],"source":"The examples in this topic demonstrate how to use the <xref:System.Linq.Enumerable.Average%2A>, <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.Max%2A>, <xref:System.Linq.Enumerable.Min%2A>, and <xref:System.Linq.Enumerable.Sum%2A> methods to query the [AdventureWorks Sales Model](https://archive.codeplex.com/?p=msftdbprodsamples) using query expression syntax."},{"content":"The AdventureWorks Sales Model used in these examples is built from the Contact, Address, Product, SalesOrderHeader, and SalesOrderDetail tables in the AdventureWorks sample database.","pos":[617,800]},{"pos":[807,881],"content":"The examples in this topic use the following <ph id=\"ph1\">`using`</ph><ph id=\"ph2\">/</ph><ph id=\"ph3\">`Imports`</ph> statements:","source":"The examples in this topic use the following `using`/`Imports` statements:"},{"pos":[1194,1201],"content":"Average","linkify":"Average","nodes":[{"content":"Average","pos":[0,7]}]},{"pos":[1211,1218],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1222,1362],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph> method to find the average list price of the products of each style.","source":"The following example uses the <xref:System.Linq.Enumerable.Average%2A> method to find the average list price of the products of each style."},{"pos":[1672,1679],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[1683,1800],"content":"The following example uses <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph> to get the average total due for each contact ID.","source":"The following example uses <xref:System.Linq.Enumerable.Average%2A> to get the average total due for each contact ID."},{"pos":[2134,2141],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2145,2275],"content":"The following example uses <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Average%2A&gt;</ph> to get the orders with the average total due for each contact.","source":"The following example uses <xref:System.Linq.Enumerable.Average%2A> to get the orders with the average total due for each contact."},{"pos":[2612,2617],"content":"Count","linkify":"Count","nodes":[{"content":"Count","pos":[0,5]}]},{"pos":[2627,2634],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2638,2765],"content":"The following example uses <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Count%2A&gt;</ph> to return a list of contact IDs and how many orders each has.","source":"The following example uses <xref:System.Linq.Enumerable.Count%2A> to return a list of contact IDs and how many orders each has."},{"pos":[3075,3082],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3086,3234],"content":"The following example groups products by color and uses <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Count%2A&gt;</ph> to return the number of products in each color group.","source":"The following example groups products by color and uses <xref:System.Linq.Enumerable.Count%2A> to return the number of products in each color group."},{"pos":[3547,3550],"content":"Max","linkify":"Max","nodes":[{"content":"Max","pos":[0,3]}]},{"pos":[3560,3567],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3571,3695],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Max%2A&gt;</ph> method to get the largest total due for each contact ID.","source":"The following example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the largest total due for each contact ID."},{"pos":[4013,4020],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4024,4164],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Max%2A&gt;</ph> method to get the orders with the largest total due for each contact ID.","source":"The following example uses the <xref:System.Linq.Enumerable.Max%2A> method to get the orders with the largest total due for each contact ID."},{"pos":[4485,4488],"content":"Min","linkify":"Min","nodes":[{"content":"Min","pos":[0,3]}]},{"pos":[4498,4505],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4509,4634],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Min%2A&gt;</ph> method to get the smallest total due for each contact ID.","source":"The following example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the smallest total due for each contact ID."},{"pos":[4952,4959],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4963,5101],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Min%2A&gt;</ph> method to get the orders with the smallest total due for each contact.","source":"The following example uses the <xref:System.Linq.Enumerable.Min%2A> method to get the orders with the smallest total due for each contact."},{"pos":[5422,5425],"content":"Sum","linkify":"Sum","nodes":[{"content":"Sum","pos":[0,3]}]},{"pos":[5435,5442],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5446,5562],"content":"The following example uses the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Sum%2A&gt;</ph> method to get the total due for each contact ID.","source":"The following example uses the <xref:System.Linq.Enumerable.Sum%2A> method to get the total due for each contact ID."},{"pos":[5879,5887],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5891,6019],"content":"<bpt id=\"p1\">[</bpt>Queries in LINQ to Entities<ept id=\"p1\">](../../../../../../docs/framework/data/adonet/ef/language-reference/queries-in-linq-to-entities.md)</ept>","source":"[Queries in LINQ to Entities](../../../../../../docs/framework/data/adonet/ef/language-reference/queries-in-linq-to-entities.md)"}]}