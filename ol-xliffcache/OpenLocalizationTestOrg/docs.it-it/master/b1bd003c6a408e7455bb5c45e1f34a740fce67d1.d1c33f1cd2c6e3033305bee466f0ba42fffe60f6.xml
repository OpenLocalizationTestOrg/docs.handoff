{"content":"---\ntitle: \"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms\"\nms.date: 08/18/2018\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"hosting WPF content in Windows Forms [WPF]\"\n  - \"composite controls [WPF], hosting WPF in\"\nms.assetid: 486369a9-606a-4a3b-b086-a06f2119c7b0\n---\n# Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms\n\nThis walkthrough demonstrates how you can create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control and host it in [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls and forms by using the <xref:System.Windows.Forms.Integration.ElementHost> control.\n\nIn this walkthrough, you will implement a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl> that contains two child controls. The <xref:System.Windows.Controls.UserControl> displays a three-dimensional (3-D) cone. Rendering 3-D objects is much easier with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] than with [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]. Therefore, it makes sense to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl> class to create 3-D graphics in [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)].\n\nTasks illustrated in this walkthrough include:\n\n-   Creating the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl>.\n\n-   Creating the Windows Forms host project.\n\n-   Hosting the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl>.\n\n## Prerequisites\n\nYou need the following components to complete this walkthrough:\n\n-   Visual Studio 2017\n\n<a name=\"To_Create_the_UserControl\"></a>\n## Create the UserControl\n\n1.  Create a **WPF User Control Library** project named `HostingWpfUserControlInWf`.\n\n2.  Open UserControl1.xaml in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)].\n\n3.  Replace the generated code with the following code:\n\n     [!code-xaml[HostingWpfUserControlInWf#1](~/samples/snippets/csharp/VS_Snippets_Wpf/HostingWpfUserControlInWf/CSharp/HostingWpfUserControlInWf/ConeControl.xaml#1)]\n\n     This code defines a <xref:System.Windows.Controls.UserControl?displayProperty=nameWithType> that contains two child controls. The first child control is a <xref:System.Windows.Controls.Label?displayProperty=nameWithType> control; the second is a <xref:System.Windows.Controls.Viewport3D> control that displays a 3-D cone.\n\n<a name=\"To_Create_the_Windows_Forms_Host_Project\"></a>\n## Create the host project\n\n1.  Add a **WPF App (.NET Framework)** project named `WpfUserControlHost` to the solution. For more information, see [Walkthrough: My first WPF desktop application](../getting-started/walkthrough-my-first-wpf-desktop-application.md).\n\n2.  In **Solution Explorer**, add a reference to the WindowsFormsIntegration assembly, which is named WindowsFormsIntegration.dll.\n\n3.  Add references to the following [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] assemblies:\n\n    -   PresentationCore\n\n    -   PresentationFramework\n\n    -   WindowsBase\n\n4.  Add a reference to the `HostingWpfUserControlInWf` project.\n\n5.  In Solution Explorer, set the `WpfUserControlHost` project to be the startup project.\n\n<a name=\"To_Host_the_Windows_Presentation_Foundation\"></a>\n## Host the UserControl\n\n1.  In the Windows Forms Designer, open Form1.\n\n2.  In the Properties window, click **Events**, and then double-click the <xref:System.Windows.Forms.Form.Load> event to create an event handler.\n\n     The Code Editor opens to the newly generated `Form1_Load` event handler.\n\n3.  Replace the code in Form1.cs with the following code.\n\n     The `Form1_Load` event handler creates an instance of `UserControl1` and adds itto the <xref:System.Windows.Forms.Integration.ElementHost> control's collection of child controls. The <xref:System.Windows.Forms.Integration.ElementHost> control is added to the form's collection of child controls.\n\n     [!code-csharp[HostingWpfUserControlInWf#10](~/samples/snippets/csharp/VS_Snippets_Wpf/HostingWpfUserControlInWf/CSharp/WpfUserControlHost/Form1.cs#10)]\n     [!code-vb[HostingWpfUserControlInWf#10](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HostingWpfUserControlInWf/VisualBasic/WpfUserControlHost/Form1.vb#10)]\n\n4.  Press **F5** to build and run the application.\n\n## See also\n\n- <xref:System.Windows.Forms.Integration.ElementHost>\n- <xref:System.Windows.Forms.Integration.WindowsFormsHost>\n- [Design XAML in Visual Studio](/visualstudio/designers/designing-xaml-in-visual-studio)\n- [Walkthrough: Hosting a WPF Composite Control in Windows Forms](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)\n- [Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)\n- [Hosting a WPF Composite Control in Windows Forms Sample](https://go.microsoft.com/fwlink/?LinkID=160001)","nodes":[{"pos":[4,297],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms\"\nms.date: 08/18/2018\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"hosting WPF content in Windows Forms [WPF]\"\n  - \"composite controls [WPF], hosting WPF in\"\nms.assetid: 486369a9-606a-4a3b-b086-a06f2119c7b0","nodes":[{"content":"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms","nodes":[{"pos":[0,65],"content":"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms","nodes":[{"content":"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms","pos":[0,65]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[304,369],"content":"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms","linkify":"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms","nodes":[{"content":"Walkthrough: Hosting a 3-D WPF Composite Control in Windows Forms","pos":[0,65]}]},{"pos":[371,707],"content":"This walkthrough demonstrates how you can create a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> composite control and host it in <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> controls and forms by using the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control.","source":"This walkthrough demonstrates how you can create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] composite control and host it in [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] controls and forms by using the <xref:System.Windows.Forms.Integration.ElementHost> control."},{"content":"In this walkthrough, you will implement a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> that contains two child controls.","pos":[709,909],"source":"In this walkthrough, you will implement a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl> that contains two child controls."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> displays a three-dimensional (3-D) cone.","pos":[910,997],"source":" The <xref:System.Windows.Controls.UserControl> displays a three-dimensional (3-D) cone."},{"content":"Rendering 3-D objects is much easier with the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> than with <ph id=\"ph2\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph>.","pos":[998,1214],"source":" Rendering 3-D objects is much easier with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] than with [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]."},{"content":"Therefore, it makes sense to host a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph> class to create 3-D graphics in <ph id=\"ph3\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph>.","pos":[1215,1486],"source":" Therefore, it makes sense to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl> class to create 3-D graphics in [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]."},{"content":"Tasks illustrated in this walkthrough include:","pos":[1488,1534]},{"pos":[1540,1678],"content":"Creating the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph>.","source":"Creating the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl>."},{"content":"Creating the Windows Forms host project.","pos":[1684,1724]},{"pos":[1730,1867],"content":"Hosting the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> <ph id=\"ph2\">&lt;xref:System.Windows.Controls.UserControl&gt;</ph>.","source":"Hosting the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Controls.UserControl>."},{"pos":[1872,1885],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need the following components to complete this walkthrough:","pos":[1887,1950]},{"content":"Visual Studio 2017","pos":[1956,1974]},{"pos":[2020,2042],"content":"Create the UserControl","linkify":"Create the UserControl","nodes":[{"content":"Create the UserControl","pos":[0,22]}]},{"pos":[2048,2128],"content":"Create a <bpt id=\"p1\">**</bpt>WPF User Control Library<ept id=\"p1\">**</ept> project named <ph id=\"ph1\">`HostingWpfUserControlInWf`</ph>.","source":"Create a **WPF User Control Library** project named `HostingWpfUserControlInWf`."},{"pos":[2134,2256],"content":"Open UserControl1.xaml in the <ph id=\"ph1\">[!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]</ph>.","source":"Open UserControl1.xaml in the [!INCLUDE[wpfdesigner_current_short](../../../../includes/wpfdesigner-current-short-md.md)]."},{"content":"Replace the generated code with the following code:","pos":[2262,2313]},{"content":"This code defines a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.UserControl?displayProperty=nameWithType&gt;</ph> that contains two child controls.","pos":[2489,2614],"source":"This code defines a <xref:System.Windows.Controls.UserControl?displayProperty=nameWithType> that contains two child controls."},{"content":"The first child control is a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Label?displayProperty=nameWithType&gt;</ph> control; the second is a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.Viewport3D&gt;</ph> control that displays a 3-D cone.","pos":[2615,2810],"source":" The first child control is a <xref:System.Windows.Controls.Label?displayProperty=nameWithType> control; the second is a <xref:System.Windows.Controls.Viewport3D> control that displays a 3-D cone."},{"pos":[2871,2894],"content":"Create the host project","linkify":"Create the host project","nodes":[{"content":"Create the host project","pos":[0,23]}]},{"content":"Add a <bpt id=\"p1\">**</bpt>WPF App (.NET Framework)<ept id=\"p1\">**</ept> project named <ph id=\"ph1\">`WpfUserControlHost`</ph> to the solution.","pos":[2900,2986],"source":"Add a **WPF App (.NET Framework)** project named `WpfUserControlHost` to the solution."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Walkthrough: My first WPF desktop application<ept id=\"p1\">](../getting-started/walkthrough-my-first-wpf-desktop-application.md)</ept>.","pos":[2987,3129],"source":" For more information, see [Walkthrough: My first WPF desktop application](../getting-started/walkthrough-my-first-wpf-desktop-application.md)."},{"pos":[3135,3261],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, add a reference to the WindowsFormsIntegration assembly, which is named WindowsFormsIntegration.dll.","source":"In **Solution Explorer**, add a reference to the WindowsFormsIntegration assembly, which is named WindowsFormsIntegration.dll."},{"pos":[3267,3392],"content":"Add references to the following <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> assemblies:","source":"Add references to the following [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] assemblies:"},{"content":"PresentationCore","pos":[3402,3418]},{"content":"PresentationFramework","pos":[3428,3449]},{"content":"WindowsBase","pos":[3459,3470]},{"pos":[3476,3535],"content":"Add a reference to the <ph id=\"ph1\">`HostingWpfUserControlInWf`</ph> project.","source":"Add a reference to the `HostingWpfUserControlInWf` project."},{"pos":[3541,3626],"content":"In Solution Explorer, set the <ph id=\"ph1\">`WpfUserControlHost`</ph> project to be the startup project.","source":"In Solution Explorer, set the `WpfUserControlHost` project to be the startup project."},{"pos":[3690,3710],"content":"Host the UserControl","linkify":"Host the UserControl","nodes":[{"content":"Host the UserControl","pos":[0,20]}]},{"content":"In the Windows Forms Designer, open Form1.","pos":[3716,3758]},{"pos":[3764,3905],"content":"In the Properties window, click <bpt id=\"p1\">**</bpt>Events<ept id=\"p1\">**</ept>, and then double-click the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.Load&gt;</ph> event to create an event handler.","source":"In the Properties window, click **Events**, and then double-click the <xref:System.Windows.Forms.Form.Load> event to create an event handler."},{"pos":[3912,3984],"content":"The Code Editor opens to the newly generated <ph id=\"ph1\">`Form1_Load`</ph> event handler.","source":"The Code Editor opens to the newly generated `Form1_Load` event handler."},{"content":"Replace the code in Form1.cs with the following code.","pos":[3990,4043]},{"content":"The <ph id=\"ph1\">`Form1_Load`</ph> event handler creates an instance of <ph id=\"ph2\">`UserControl1`</ph> and adds itto the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control's collection of child controls.","pos":[4050,4228],"source":"The `Form1_Load` event handler creates an instance of `UserControl1` and adds itto the <xref:System.Windows.Forms.Integration.ElementHost> control's collection of child controls."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.ElementHost&gt;</ph> control is added to the form's collection of child controls.","pos":[4229,4345],"source":" The <xref:System.Windows.Forms.Integration.ElementHost> control is added to the form's collection of child controls."},{"pos":[4352,4666],"content":"[!code-csharp[HostingWpfUserControlInWf#10](~/samples/snippets/csharp/VS_Snippets_Wpf/HostingWpfUserControlInWf/CSharp/WpfUserControlHost/Form1.cs#10)]\n [!code-vb[HostingWpfUserControlInWf#10](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HostingWpfUserControlInWf/VisualBasic/WpfUserControlHost/Form1.vb#10)]","leadings":["","    "],"nodes":[]},{"pos":[4672,4718],"content":"Press <bpt id=\"p1\">**</bpt>F5<ept id=\"p1\">**</ept> to build and run the application.","source":"Press **F5** to build and run the application."},{"pos":[4723,4731],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4848,4935],"content":"<bpt id=\"p1\">[</bpt>Design XAML in Visual Studio<ept id=\"p1\">](/visualstudio/designers/designing-xaml-in-visual-studio)</ept>","source":"[Design XAML in Visual Studio](/visualstudio/designers/designing-xaml-in-visual-studio)"},{"pos":[4938,5066],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a WPF Composite Control in Windows Forms<ept id=\"p1\">](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)</ept>","source":"[Walkthrough: Hosting a WPF Composite Control in Windows Forms](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)"},{"pos":[5069,5197],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Composite Control in WPF<ept id=\"p1\">](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)</ept>","source":"[Walkthrough: Hosting a Windows Forms Composite Control in WPF](walkthrough-hosting-a-windows-forms-composite-control-in-wpf.md)"},{"pos":[5200,5305],"content":"<bpt id=\"p1\">[</bpt>Hosting a WPF Composite Control in Windows Forms Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=160001)</ept>","source":"[Hosting a WPF Composite Control in Windows Forms Sample](https://go.microsoft.com/fwlink/?LinkID=160001)"}]}