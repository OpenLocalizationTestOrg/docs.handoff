{"content":"---\ntitle: \"Troubleshooting Variables in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"troubleshooting [Visual Basic], variables\"\n  - \"variables [Visual Basic], troubleshooting\"\nms.assetid: 928a2dc8-e565-4ae4-8ba3-80cc0cb50090\n---\n# Troubleshooting Variables in Visual Basic\nThis page lists some common problems that can occur when working with variables in Visual Basic.  \n  \n## Unable to Access Members of an Object  \n If your code attempts to access a property or method on an object, there are two possible error outcomes:  \n  \n-   The compiler can generate an error message if you declare the object variable to be of a specific type and then refer to a member not defined by that type.  \n  \n-   A run-time <xref:System.MemberAccessException> occurs when the object assigned to an object variable does not expose the member your code is trying to access. In the case of a variable of [Object Data Type](../../../../visual-basic/language-reference/data-types/object-data-type.md), you can also get this exception if the member is not `Public`. This is because late binding allows access only to `Public` members.  \n  \n When the [Option Strict Statement](../../../../visual-basic/language-reference/statements/option-strict-statement.md) sets type checking `On`, an object variable can access only the methods and properties of the class with which you declare it. The following example illustrates this.  \n\n [!code-vb[VbVbalrVariables#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrVariables/VB/Class1.vb#2)]  \n  \n In this example, `p` can use only the members of the <xref:System.Object> class itself, which do not include the `Left` property. On the other hand, `q` was declared to be of type <xref:System.Windows.Forms.Label>, so it can use all the methods and properties of the <xref:System.Windows.Forms.Label> class in the <xref:System.Windows.Forms> namespace.  \n  \n### Correct Approach  \n To be able to access all the members of an object of a particular class, declare the object variable to be of the type of that class when possible. If you cannot do this, for example if you do not know the object type at compile time, you must set `Option Strict` to `Off` and declare the variable to be of the [Object Data Type](../../../../visual-basic/language-reference/data-types/object-data-type.md). This allows objects of any type to be assigned to the variable, and you should take steps to ensure that the currently assigned object is of an acceptable type. You can use the [TypeOf Operator](../../../../visual-basic/language-reference/operators/typeof-operator.md) to make this determination.  \n  \n## Other Components Cannot Access Your Variable  \n Visual Basic names are *case-insensitive*. If two names differ in alphabetic case only, the compiler interprets them as the same name. For example, it considers `ABC` and `abc` to refer to the same declared element.  \n  \n However, the common language runtime (CLR) uses *case-sensitive* binding. Therefore, when you produce an assembly or a DLL and make it available to other assemblies, your names are no longer case-insensitive. For example, if you define a class with an element called `ABC`, and other assemblies make use of your class through the common language runtime, they must refer to the element as `ABC`. If you subsequently recompile your class and change the element's name to `abc`, the other assemblies using your class can no longer access that element. Therefore, when you release an updated version of an assembly, you should not change the alphabetic case of any public elements.  \n  \n For more information, see [Common Language Runtime](../../../../standard/clr.md).  \n  \n### Correct Approach  \n To allow other components to access your variables, treat their names as if they were case-sensitive. When you are testing your class or module, make sure other assemblies are binding to the variables you expect them to. Once you have published a component, do not make any modifications to existing variable names, including changing their cases.  \n  \n## Wrong Variable Being Used  \n When you have more than one variable with the same name, the Visual Basic compiler attempts to resolve each reference to that name. If the variables have different scope, the compiler resolves a reference to the declaration with the narrowest scope. If they have the same scope, the resolution fails and the compiler signals an error. For more information, see [References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md).  \n  \n### Correct Approach  \n Avoid using variables with the same name but different scope. If you are using other assemblies or projects, avoid using any names defined in those external components as much as possible. If you have more than one variable with the same name, be sure you qualify every reference to it. For more information, see [References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md).  \n  \n## See also\n\n- [Variables](../../../../visual-basic/programming-guide/language-features/variables/index.md)\n- [Variable Declaration](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)\n- [Object Variables](../../../../visual-basic/programming-guide/language-features/variables/object-variables.md)\n- [Object Variable Declaration](../../../../visual-basic/programming-guide/language-features/variables/object-variable-declaration.md)\n- [How to: Access Members of an Object](../../../../visual-basic/programming-guide/language-features/variables/how-to-access-members-of-an-object.md)\n- [Object Variable Values](../../../../visual-basic/programming-guide/language-features/variables/object-variable-values.md)\n- [How to: Determine What Type an Object Variable Refers To](../../../../visual-basic/programming-guide/language-features/variables/how-to-determine-what-type-an-object-variable-refers-to.md)\n- [References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)\n- [Declared Element Names](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)\n","nodes":[{"pos":[4,241],"embed":true,"restype":"x-metadata","content":"title: \"Troubleshooting Variables in Visual Basic\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"troubleshooting [Visual Basic], variables\"\n  - \"variables [Visual Basic], troubleshooting\"\nms.assetid: 928a2dc8-e565-4ae4-8ba3-80cc0cb50090","nodes":[{"content":"Troubleshooting Variables in Visual Basic","nodes":[{"pos":[0,41],"content":"Troubleshooting Variables in Visual Basic","nodes":[{"content":"Troubleshooting Variables in Visual Basic","pos":[0,41]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[248,289],"content":"Troubleshooting Variables in Visual Basic","linkify":"Troubleshooting Variables in Visual Basic","nodes":[{"content":"Troubleshooting Variables in Visual Basic","pos":[0,41]}]},{"content":"This page lists some common problems that can occur when working with variables in Visual Basic.","pos":[290,386]},{"pos":[395,432],"content":"Unable to Access Members of an Object","linkify":"Unable to Access Members of an Object","nodes":[{"content":"Unable to Access Members of an Object","pos":[0,37]}]},{"content":"If your code attempts to access a property or method on an object, there are two possible error outcomes:","pos":[436,541]},{"content":"The compiler can generate an error message if you declare the object variable to be of a specific type and then refer to a member not defined by that type.","pos":[551,706]},{"content":"A run-time <ph id=\"ph1\">&lt;xref:System.MemberAccessException&gt;</ph> occurs when the object assigned to an object variable does not expose the member your code is trying to access.","pos":[716,874],"source":"A run-time <xref:System.MemberAccessException> occurs when the object assigned to an object variable does not expose the member your code is trying to access."},{"content":"In the case of a variable of <bpt id=\"p1\">[</bpt>Object Data Type<ept id=\"p1\">](../../../../visual-basic/language-reference/data-types/object-data-type.md)</ept>, you can also get this exception if the member is not <ph id=\"ph1\">`Public`</ph>.","pos":[875,1062],"source":" In the case of a variable of [Object Data Type](../../../../visual-basic/language-reference/data-types/object-data-type.md), you can also get this exception if the member is not `Public`."},{"content":"This is because late binding allows access only to <ph id=\"ph1\">`Public`</ph> members.","pos":[1063,1131],"source":" This is because late binding allows access only to `Public` members."},{"content":"When the <bpt id=\"p1\">[</bpt>Option Strict Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/option-strict-statement.md)</ept> sets type checking <ph id=\"ph1\">`On`</ph>, an object variable can access only the methods and properties of the class with which you declare it.","pos":[1138,1382],"source":"When the [Option Strict Statement](../../../../visual-basic/language-reference/statements/option-strict-statement.md) sets type checking `On`, an object variable can access only the methods and properties of the class with which you declare it."},{"content":"The following example illustrates this.","pos":[1383,1422]},{"content":"In this example, <ph id=\"ph1\">`p`</ph> can use only the members of the <ph id=\"ph2\">&lt;xref:System.Object&gt;</ph> class itself, which do not include the <ph id=\"ph3\">`Left`</ph> property.","pos":[1549,1678],"source":"In this example, `p` can use only the members of the <xref:System.Object> class itself, which do not include the `Left` property."},{"content":"On the other hand, <ph id=\"ph1\">`q`</ph> was declared to be of type <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Label&gt;</ph>, so it can use all the methods and properties of the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Label&gt;</ph> class in the <ph id=\"ph4\">&lt;xref:System.Windows.Forms&gt;</ph> namespace.","pos":[1679,1901],"source":" On the other hand, `q` was declared to be of type <xref:System.Windows.Forms.Label>, so it can use all the methods and properties of the <xref:System.Windows.Forms.Label> class in the <xref:System.Windows.Forms> namespace."},{"pos":[1911,1927],"content":"Correct Approach","linkify":"Correct Approach","nodes":[{"content":"Correct Approach","pos":[0,16]}]},{"content":"To be able to access all the members of an object of a particular class, declare the object variable to be of the type of that class when possible.","pos":[1931,2078]},{"content":"If you cannot do this, for example if you do not know the object type at compile time, you must set <ph id=\"ph1\">`Option Strict`</ph> to <ph id=\"ph2\">`Off`</ph> and declare the variable to be of the <bpt id=\"p1\">[</bpt>Object Data Type<ept id=\"p1\">](../../../../visual-basic/language-reference/data-types/object-data-type.md)</ept>.","pos":[2079,2337],"source":" If you cannot do this, for example if you do not know the object type at compile time, you must set `Option Strict` to `Off` and declare the variable to be of the [Object Data Type](../../../../visual-basic/language-reference/data-types/object-data-type.md)."},{"content":"This allows objects of any type to be assigned to the variable, and you should take steps to ensure that the currently assigned object is of an acceptable type.","pos":[2338,2498]},{"content":"You can use the <bpt id=\"p1\">[</bpt>TypeOf Operator<ept id=\"p1\">](../../../../visual-basic/language-reference/operators/typeof-operator.md)</ept> to make this determination.","pos":[2499,2634],"source":" You can use the [TypeOf Operator](../../../../visual-basic/language-reference/operators/typeof-operator.md) to make this determination."},{"pos":[2643,2687],"content":"Other Components Cannot Access Your Variable","linkify":"Other Components Cannot Access Your Variable","nodes":[{"content":"Other Components Cannot Access Your Variable","pos":[0,44]}]},{"content":"Visual Basic names are <bpt id=\"p1\">*</bpt>case-insensitive<ept id=\"p1\">*</ept>.","pos":[2691,2733],"source":"Visual Basic names are *case-insensitive*."},{"content":"If two names differ in alphabetic case only, the compiler interprets them as the same name.","pos":[2734,2825]},{"content":"For example, it considers <ph id=\"ph1\">`ABC`</ph> and <ph id=\"ph2\">`abc`</ph> to refer to the same declared element.","pos":[2826,2906],"source":" For example, it considers `ABC` and `abc` to refer to the same declared element."},{"content":"However, the common language runtime (CLR) uses <bpt id=\"p1\">*</bpt>case-sensitive<ept id=\"p1\">*</ept> binding.","pos":[2913,2986],"source":"However, the common language runtime (CLR) uses *case-sensitive* binding."},{"content":"Therefore, when you produce an assembly or a DLL and make it available to other assemblies, your names are no longer case-insensitive.","pos":[2987,3121]},{"content":"For example, if you define a class with an element called <ph id=\"ph1\">`ABC`</ph>, and other assemblies make use of your class through the common language runtime, they must refer to the element as <ph id=\"ph2\">`ABC`</ph>.","pos":[3122,3308],"source":" For example, if you define a class with an element called `ABC`, and other assemblies make use of your class through the common language runtime, they must refer to the element as `ABC`."},{"content":"If you subsequently recompile your class and change the element's name to <ph id=\"ph1\">`abc`</ph>, the other assemblies using your class can no longer access that element.","pos":[3309,3462],"source":" If you subsequently recompile your class and change the element's name to `abc`, the other assemblies using your class can no longer access that element."},{"content":"Therefore, when you release an updated version of an assembly, you should not change the alphabetic case of any public elements.","pos":[3463,3591]},{"pos":[3598,3679],"content":"For more information, see <bpt id=\"p1\">[</bpt>Common Language Runtime<ept id=\"p1\">](../../../../standard/clr.md)</ept>.","source":"For more information, see [Common Language Runtime](../../../../standard/clr.md)."},{"pos":[3689,3705],"content":"Correct Approach","linkify":"Correct Approach","nodes":[{"content":"Correct Approach","pos":[0,16]}]},{"content":"To allow other components to access your variables, treat their names as if they were case-sensitive.","pos":[3709,3810]},{"content":"When you are testing your class or module, make sure other assemblies are binding to the variables you expect them to.","pos":[3811,3929]},{"content":"Once you have published a component, do not make any modifications to existing variable names, including changing their cases.","pos":[3930,4056]},{"pos":[4065,4090],"content":"Wrong Variable Being Used","linkify":"Wrong Variable Being Used","nodes":[{"content":"Wrong Variable Being Used","pos":[0,25]}]},{"content":"When you have more than one variable with the same name, the Visual Basic compiler attempts to resolve each reference to that name.","pos":[4094,4225]},{"content":"If the variables have different scope, the compiler resolves a reference to the declaration with the narrowest scope.","pos":[4226,4343]},{"content":"If they have the same scope, the resolution fails and the compiler signals an error.","pos":[4344,4428]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>References to Declared Elements<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)</ept>.","pos":[4429,4604],"source":" For more information, see [References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)."},{"pos":[4614,4630],"content":"Correct Approach","linkify":"Correct Approach","nodes":[{"content":"Correct Approach","pos":[0,16]}]},{"content":"Avoid using variables with the same name but different scope.","pos":[4634,4695]},{"content":"If you are using other assemblies or projects, avoid using any names defined in those external components as much as possible.","pos":[4696,4822]},{"content":"If you have more than one variable with the same name, be sure you qualify every reference to it.","pos":[4823,4920]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>References to Declared Elements<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)</ept>.","pos":[4921,5096],"source":" For more information, see [References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)."},{"pos":[5105,5113],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5117,5209],"content":"<bpt id=\"p1\">[</bpt>Variables<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/index.md)</ept>","source":"[Variables](../../../../visual-basic/programming-guide/language-features/variables/index.md)"},{"pos":[5212,5330],"content":"<bpt id=\"p1\">[</bpt>Variable Declaration<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)</ept>","source":"[Variable Declaration](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)"},{"pos":[5333,5443],"content":"<bpt id=\"p1\">[</bpt>Object Variables<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/object-variables.md)</ept>","source":"[Object Variables](../../../../visual-basic/programming-guide/language-features/variables/object-variables.md)"},{"pos":[5446,5578],"content":"<bpt id=\"p1\">[</bpt>Object Variable Declaration<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/object-variable-declaration.md)</ept>","source":"[Object Variable Declaration](../../../../visual-basic/programming-guide/language-features/variables/object-variable-declaration.md)"},{"pos":[5581,5728],"content":"<bpt id=\"p1\">[</bpt>How to: Access Members of an Object<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/how-to-access-members-of-an-object.md)</ept>","source":"[How to: Access Members of an Object](../../../../visual-basic/programming-guide/language-features/variables/how-to-access-members-of-an-object.md)"},{"pos":[5731,5853],"content":"<bpt id=\"p1\">[</bpt>Object Variable Values<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/object-variable-values.md)</ept>","source":"[Object Variable Values](../../../../visual-basic/programming-guide/language-features/variables/object-variable-values.md)"},{"pos":[5856,6045],"content":"<bpt id=\"p1\">[</bpt>How to: Determine What Type an Object Variable Refers To<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/variables/how-to-determine-what-type-an-object-variable-refers-to.md)</ept>","source":"[How to: Determine What Type an Object Variable Refers To](../../../../visual-basic/programming-guide/language-features/variables/how-to-determine-what-type-an-object-variable-refers-to.md)"},{"pos":[6048,6196],"content":"<bpt id=\"p1\">[</bpt>References to Declared Elements<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)</ept>","source":"[References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)"},{"pos":[6199,6329],"content":"<bpt id=\"p1\">[</bpt>Declared Element Names<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)</ept>","source":"[Declared Element Names](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)"}]}