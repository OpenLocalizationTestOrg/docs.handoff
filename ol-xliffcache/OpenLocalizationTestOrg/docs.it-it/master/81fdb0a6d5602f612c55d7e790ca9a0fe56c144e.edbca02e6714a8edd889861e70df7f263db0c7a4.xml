{"content":"---\ntitle: \"How to: Group, sort, and filter Data in the DataGrid control\"\nms.date: \"03/30/2017\"\ndev_langs:\n - \"csharp\"\n - \"vb\"\nhelpviewer_keywords:\n - \"DataGrid [WPF], sort\"\n - \"DataGrid [WPF], group\"\n - \"DataGrid [WPF], filter\"\nms.assetid: 03345e85-89e3-4aec-9ed0-3b80759df770\n---\n# How to: Group, sort, and filter data in the DataGrid control\n\nIt is often useful to view data in a <xref:System.Windows.Controls.DataGrid> in different ways by grouping, sorting, and filtering the data. To group, sort, and filter the data in a <xref:System.Windows.Controls.DataGrid>, you bind it to a <xref:System.Windows.Data.CollectionView> that supports these functions. You can then work with the data in the <xref:System.Windows.Data.CollectionView> without affecting the underlying source data. The changes in the collection view are reflected in the <xref:System.Windows.Controls.DataGrid> user interface (UI).\n\nThe <xref:System.Windows.Data.CollectionView> class provides grouping and sorting functionality for a data source that implements the <xref:System.Collections.IEnumerable> interface. The <xref:System.Windows.Data.CollectionViewSource> class enables you to set the properties of a <xref:System.Windows.Data.CollectionView> from XAML.\n\nIn this example, a collection of `Task` objects is bound to a <xref:System.Windows.Data.CollectionViewSource>. The <xref:System.Windows.Data.CollectionViewSource> is used as the <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> for the <xref:System.Windows.Controls.DataGrid>. Grouping, sorting, and filtering are performed on the <xref:System.Windows.Data.CollectionViewSource> and are displayed in the <xref:System.Windows.Controls.DataGrid> UI.\n\n![Grouped data in a DataGrid](././media/wpf-datagridgroups.png \"WPF_DataGridGroups\")\nGrouped data in a DataGrid\n\n## Using a CollectionViewSource as an ItemsSource\n\nTo group, sort, and filter data in a <xref:System.Windows.Controls.DataGrid> control, you bind the <xref:System.Windows.Controls.DataGrid> to a <xref:System.Windows.Data.CollectionView> that supports these functions. In this example, the <xref:System.Windows.Controls.DataGrid> is bound to a <xref:System.Windows.Data.CollectionViewSource> that provides these functions for a <xref:System.Collections.Generic.List%601> of `Task` objects.\n\n### To bind a DataGrid to a CollectionViewSource\n\n1. Create a data collection that implements the <xref:System.Collections.IEnumerable> interface.\n\n    If you use <xref:System.Collections.Generic.List%601> to create your collection, you should create a new class that inherits from <xref:System.Collections.Generic.List%601> instead of instantiating an instance of <xref:System.Collections.Generic.List%601>. This enables you to data bind to the collection in XAML.\n\n    > [!NOTE]\n    > The objects in the collection must implement the <xref:System.ComponentModel.INotifyPropertyChanged> changed interface and the <xref:System.ComponentModel.IEditableObject> interface in order for the <xref:System.Windows.Controls.DataGrid> to respond correctly to property changes and edits. For more information, see [Implement Property Change Notification](../data/how-to-implement-property-change-notification.md).\n\n    [!code-csharp[DataGrid_GroupSortFilter#101](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml.cs#101)]\n    [!code-vb[DataGrid_GroupSortFilter#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#101)]\n\n2. In XAML, create an instance of the collection class and set the [x:Key Directive](../../xaml-services/x-key-directive.md).\n\n3. In XAML, create an instance of the <xref:System.Windows.Data.CollectionViewSource> class, set the [x:Key Directive](../../xaml-services/x-key-directive.md), and set the instance of your collection class as the <xref:System.Windows.Data.CollectionViewSource.Source%2A>.\n\n    [!code-xaml[DataGrid_GroupSortFilter#201](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/WindowSnips1.xaml#201)]\n\n4. Create an instance of the <xref:System.Windows.Controls.DataGrid> class, and set the <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> property to the <xref:System.Windows.Data.CollectionViewSource>.\n\n    [!code-xaml[DataGrid_GroupSortFilter#002](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml#002)]\n\n5. To access the <xref:System.Windows.Data.CollectionViewSource> from your code, use the <xref:System.Windows.Data.CollectionViewSource.GetDefaultView%2A> method to get a reference to the <xref:System.Windows.Data.CollectionViewSource>.\n\n    [!code-csharp[DataGrid_GroupSortFilter#102](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml.cs#102)]\n    [!code-vb[DataGrid_GroupSortFilter#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#102)]\n\n## Grouping items in a DataGrid\n\nTo specify how items are grouped in a <xref:System.Windows.Controls.DataGrid>, you use the <xref:System.Windows.Data.PropertyGroupDescription> type to group the items in the source view.\n\n### To group items in a DataGrid using XAML\n\n1. Create a <xref:System.Windows.Data.PropertyGroupDescription> that specifies the property to group by. You can specify the property in XAML or in code.\n\n   1. In XAML, set the <xref:System.Windows.Data.PropertyGroupDescription.PropertyName%2A> to the name of the property to group by.\n\n   2. In code, pass the name of the property to group by to the constructor.\n\n2. Add the <xref:System.Windows.Data.PropertyGroupDescription> to the <xref:System.Windows.Data.CollectionViewSource.GroupDescriptions%2A?displayProperty=nameWithType> collection.\n\n3. Add additional instances of <xref:System.Windows.Data.PropertyGroupDescription> to the <xref:System.Windows.Data.CollectionViewSource.GroupDescriptions%2A> collection to add more levels of grouping.\n\n    [!code-xaml[DataGrid_GroupSortFilter#012](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml#012)]\n    [!code-csharp[DataGrid_GroupSortFilter#112](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml.cs#112)]\n    [!code-vb[DataGrid_GroupSortFilter#112](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#112)]\n\n4. To remove a group, remove the <xref:System.Windows.Data.PropertyGroupDescription> from the <xref:System.Windows.Data.CollectionViewSource.GroupDescriptions%2A> collection.\n\n5. To remove all groups, call the <xref:System.Collections.ObjectModel.Collection%601.Clear%2A> method of the <xref:System.Windows.Data.CollectionViewSource.GroupDescriptions%2A> collection.\n\n    [!code-csharp[DataGrid_GroupSortFilter#114](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml.cs#114)]\n    [!code-vb[DataGrid_GroupSortFilter#114](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#114)]\n\nWhen items are grouped in the <xref:System.Windows.Controls.DataGrid>, you can define a <xref:System.Windows.Controls.GroupStyle> that specifies the appearance of each group. You apply the <xref:System.Windows.Controls.GroupStyle> by adding it to the <xref:System.Windows.Controls.ItemsControl.GroupStyle%2A> collection of the DataGrid. If you have multiple levels of grouping, you can apply different styles to each group level. Styles are applied in the order in which they are defined. For example, if you define two styles, the first will be applied to top level row groups. The second style will be applied to all row groups at the second level and lower. The <xref:System.Windows.FrameworkElement.DataContext%2A> of the <xref:System.Windows.Controls.GroupStyle> is the <xref:System.Windows.Data.CollectionViewGroup> that the group represents.\n\n### To change the appearance of row group headers\n\n1. Create a <xref:System.Windows.Controls.GroupStyle> that defines the appearance of the row group.\n\n2. Put the <xref:System.Windows.Controls.GroupStyle> inside the `<DataGrid.GroupStyle>` tags.\n\n    [!code-xaml[DataGrid_GroupSortFilter#003](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml#003)]\n\n## Sorting items in a DataGrid\n\nTo specify how items are sorted in a <xref:System.Windows.Controls.DataGrid>, you use the <xref:System.ComponentModel.SortDescription> type to sort the items in the source view.\n\n### To sort items in a DataGrid\n\n1. Create a <xref:System.ComponentModel.SortDescription> that specifies the property to sort by. You can specify the property in XAML or in code.\n\n    1. In XAML, set the <xref:System.ComponentModel.SortDescription.PropertyName%2A> to the name of the property to sort by.\n\n    2. In code, pass the name of the property to sort by and the <xref:System.ComponentModel.ListSortDirection> to the constructor.\n\n2. Add the <xref:System.ComponentModel.SortDescription> to the <xref:System.Windows.Data.CollectionViewSource.SortDescriptions%2A?displayProperty=nameWithType> collection.\n\n3. Add additional instances of <xref:System.ComponentModel.SortDescription> to the <xref:System.Windows.Data.CollectionViewSource.SortDescriptions%2A> collection to sort by additional properties.\n\n    [!code-xaml[DataGrid_GroupSortFilter#011](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml#011)]\n    [!code-csharp[DataGrid_GroupSortFilter#211](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/WindowSnips1.xaml.cs#211)]\n    [!code-vb[DataGrid_GroupSortFilter#211](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#211)]\n\n## Filtering items in a DataGrid\n\nTo filter items in a <xref:System.Windows.Controls.DataGrid> using a <xref:System.Windows.Data.CollectionViewSource>, you provide the filtering logic in the handler for the <xref:System.Windows.Data.CollectionViewSource.Filter?displayProperty=nameWithType> event.\n\n### To filter items in a DataGrid\n\n1. Add a handler for the <xref:System.Windows.Data.CollectionViewSource.Filter?displayProperty=nameWithType> event.\n\n2. In the <xref:System.Windows.Data.CollectionViewSource.Filter> event handler, define the filtering logic.\n\n    The filter will be applied every time the view is refreshed.\n\n    [!code-xaml[DataGrid_GroupSortFilter#013](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml#013)]\n    [!code-csharp[DataGrid_GroupSortFilter#113](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml.cs#113)]\n    [!code-vb[DataGrid_GroupSortFilter#113](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#113)]\n\nAlternatively, you can filter items in a <xref:System.Windows.Controls.DataGrid> by creating a method that provides the filtering logic and setting the <xref:System.Windows.Data.CollectionView.Filter%2A?displayProperty=nameWithType> property to apply the filter. To see an example of this method, see [Filter Data in a View](../data/how-to-filter-data-in-a-view.md).\n\n## Example\n\nThe following example demonstrates grouping, sorting, and filtering `Task` data in a <xref:System.Windows.Data.CollectionViewSource> and displaying the grouped, sorted, and filtered `Task` data in a <xref:System.Windows.Controls.DataGrid>. The <xref:System.Windows.Data.CollectionViewSource> is used as the <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> for the <xref:System.Windows.Controls.DataGrid>. Grouping, sorting, and filtering are performed on the <xref:System.Windows.Data.CollectionViewSource> and are displayed in the <xref:System.Windows.Controls.DataGrid> UI.\n\nTo test this example, you will need to adjust the DGGroupSortFilterExample name to match your project name. If you are using Visual Basic, you will need to change the class name for <xref:System.Windows.Window> to the following.\n\n`<Window x:Class=\"MainWindow\"`\n\n[!code-xaml[DataGrid_GroupSortFilter#000](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml#000)]\n[!code-csharp[DataGrid_GroupSortFilter#100](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml.cs#100)]\n[!code-vb[DataGrid_GroupSortFilter#100](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#100)]\n\n## See also\n\n- [Data Binding Overview](../data/data-binding-overview.md)\n- [Create and Bind to an ObservableCollection](../data/how-to-create-and-bind-to-an-observablecollection.md)\n- [Filter Data in a View](../data/how-to-filter-data-in-a-view.md)\n- [Sort Data in a View](../data/how-to-sort-data-in-a-view.md)\n- [Sort and Group Data Using a View in XAML](../data/how-to-sort-and-group-data-using-a-view-in-xaml.md)\n","nodes":[{"pos":[4,277],"embed":true,"restype":"x-metadata","content":"title: \"How to: Group, sort, and filter Data in the DataGrid control\"\nms.date: \"03/30/2017\"\ndev_langs:\n - \"csharp\"\n - \"vb\"\nhelpviewer_keywords:\n - \"DataGrid [WPF], sort\"\n - \"DataGrid [WPF], group\"\n - \"DataGrid [WPF], filter\"\nms.assetid: 03345e85-89e3-4aec-9ed0-3b80759df770","nodes":[{"content":"How to: Group, sort, and filter Data in the DataGrid control","nodes":[{"pos":[0,60],"content":"How to: Group, sort, and filter Data in the DataGrid control","nodes":[{"content":"How to: Group, sort, and filter Data in the DataGrid control","pos":[0,60]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[284,344],"content":"How to: Group, sort, and filter data in the DataGrid control","linkify":"How to: Group, sort, and filter data in the DataGrid control","nodes":[{"content":"How to: Group, sort, and filter data in the DataGrid control","pos":[0,60]}]},{"content":"It is often useful to view data in a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> in different ways by grouping, sorting, and filtering the data.","pos":[346,486],"source":"It is often useful to view data in a <xref:System.Windows.Controls.DataGrid> in different ways by grouping, sorting, and filtering the data."},{"content":"To group, sort, and filter the data in a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph>, you bind it to a <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionView&gt;</ph> that supports these functions.","pos":[487,658],"source":" To group, sort, and filter the data in a <xref:System.Windows.Controls.DataGrid>, you bind it to a <xref:System.Windows.Data.CollectionView> that supports these functions."},{"content":"You can then work with the data in the <ph id=\"ph1\">&lt;xref:System.Windows.Data.CollectionView&gt;</ph> without affecting the underlying source data.","pos":[659,785],"source":" You can then work with the data in the <xref:System.Windows.Data.CollectionView> without affecting the underlying source data."},{"content":"The changes in the collection view are reflected in the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> user interface (UI).","pos":[786,902],"source":" The changes in the collection view are reflected in the <xref:System.Windows.Controls.DataGrid> user interface (UI)."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Data.CollectionView&gt;</ph> class provides grouping and sorting functionality for a data source that implements the <ph id=\"ph2\">&lt;xref:System.Collections.IEnumerable&gt;</ph> interface.","pos":[904,1086],"source":"The <xref:System.Windows.Data.CollectionView> class provides grouping and sorting functionality for a data source that implements the <xref:System.Collections.IEnumerable> interface."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph> class enables you to set the properties of a <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionView&gt;</ph> from XAML.","pos":[1087,1236],"source":" The <xref:System.Windows.Data.CollectionViewSource> class enables you to set the properties of a <xref:System.Windows.Data.CollectionView> from XAML."},{"content":"In this example, a collection of <ph id=\"ph1\">`Task`</ph> objects is bound to a <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph>.","pos":[1238,1348],"source":"In this example, a collection of `Task` objects is bound to a <xref:System.Windows.Data.CollectionViewSource>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph> is used as the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ItemsControl.ItemsSource%2A&gt;</ph> for the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph>.","pos":[1349,1523],"source":" The <xref:System.Windows.Data.CollectionViewSource> is used as the <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> for the <xref:System.Windows.Controls.DataGrid>."},{"content":"Grouping, sorting, and filtering are performed on the <ph id=\"ph1\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph> and are displayed in the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> UI.","pos":[1524,1694],"source":" Grouping, sorting, and filtering are performed on the <xref:System.Windows.Data.CollectionViewSource> and are displayed in the <xref:System.Windows.Controls.DataGrid> UI."},{"pos":[1696,1807],"content":"<bpt id=\"p1\">![</bpt>Grouped data in a DataGrid<ept id=\"p1\">]</ept><bpt id=\"p2\">(././media/wpf-datagridgroups.png \"</bpt>WPF_DataGridGroups<ept id=\"p2\">\")</ept> Grouped data in a DataGrid","source":"![Grouped data in a DataGrid](././media/wpf-datagridgroups.png \"WPF_DataGridGroups\")\nGrouped data in a DataGrid"},{"pos":[1812,1858],"content":"Using a CollectionViewSource as an ItemsSource","linkify":"Using a CollectionViewSource as an ItemsSource","nodes":[{"content":"Using a CollectionViewSource as an ItemsSource","pos":[0,46]}]},{"content":"To group, sort, and filter data in a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> control, you bind the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> to a <ph id=\"ph3\">&lt;xref:System.Windows.Data.CollectionView&gt;</ph> that supports these functions.","pos":[1860,2076],"source":"To group, sort, and filter data in a <xref:System.Windows.Controls.DataGrid> control, you bind the <xref:System.Windows.Controls.DataGrid> to a <xref:System.Windows.Data.CollectionView> that supports these functions."},{"content":"In this example, the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> is bound to a <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph> that provides these functions for a <ph id=\"ph3\">&lt;xref:System.Collections.Generic.List%601&gt;</ph> of <ph id=\"ph4\">`Task`</ph> objects.","pos":[2077,2297],"source":" In this example, the <xref:System.Windows.Controls.DataGrid> is bound to a <xref:System.Windows.Data.CollectionViewSource> that provides these functions for a <xref:System.Collections.Generic.List%601> of `Task` objects."},{"pos":[2303,2347],"content":"To bind a DataGrid to a CollectionViewSource","linkify":"To bind a DataGrid to a CollectionViewSource","nodes":[{"content":"To bind a DataGrid to a CollectionViewSource","pos":[0,44]}]},{"pos":[2352,2445],"content":"Create a data collection that implements the <ph id=\"ph1\">&lt;xref:System.Collections.IEnumerable&gt;</ph> interface.","source":"Create a data collection that implements the <xref:System.Collections.IEnumerable> interface."},{"content":"If you use <ph id=\"ph1\">&lt;xref:System.Collections.Generic.List%601&gt;</ph> to create your collection, you should create a new class that inherits from <ph id=\"ph2\">&lt;xref:System.Collections.Generic.List%601&gt;</ph> instead of instantiating an instance of <ph id=\"ph3\">&lt;xref:System.Collections.Generic.List%601&gt;</ph>.","pos":[2451,2707],"source":"If you use <xref:System.Collections.Generic.List%601> to create your collection, you should create a new class that inherits from <xref:System.Collections.Generic.List%601> instead of instantiating an instance of <xref:System.Collections.Generic.List%601>."},{"content":"This enables you to data bind to the collection in XAML.","pos":[2708,2764]},{"pos":[2772,3202],"content":"[!NOTE]\nThe objects in the collection must implement the <xref:System.ComponentModel.INotifyPropertyChanged> changed interface and the <xref:System.ComponentModel.IEditableObject> interface in order for the <xref:System.Windows.Controls.DataGrid> to respond correctly to property changes and edits. For more information, see [Implement Property Change Notification](../data/how-to-implement-property-change-notification.md).","leadings":["","    > "],"nodes":[{"content":"The objects in the collection must implement the <xref:System.ComponentModel.INotifyPropertyChanged> changed interface and the <xref:System.ComponentModel.IEditableObject> interface in order for the <xref:System.Windows.Controls.DataGrid> to respond correctly to property changes and edits. For more information, see [Implement Property Change Notification](../data/how-to-implement-property-change-notification.md).","pos":[8,424],"nodes":[{"content":"The objects in the collection must implement the <ph id=\"ph1\">&lt;xref:System.ComponentModel.INotifyPropertyChanged&gt;</ph> changed interface and the <ph id=\"ph2\">&lt;xref:System.ComponentModel.IEditableObject&gt;</ph> interface in order for the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> to respond correctly to property changes and edits.","pos":[0,290],"source":"The objects in the collection must implement the <xref:System.ComponentModel.INotifyPropertyChanged> changed interface and the <xref:System.ComponentModel.IEditableObject> interface in order for the <xref:System.Windows.Controls.DataGrid> to respond correctly to property changes and edits."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Implement Property Change Notification<ept id=\"p1\">](../data/how-to-implement-property-change-notification.md)</ept>.","pos":[291,416],"source":" For more information, see [Implement Property Change Notification](../data/how-to-implement-property-change-notification.md)."}]}]},{"pos":[3208,3490],"content":"[!code-csharp[DataGrid_GroupSortFilter#101](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml.cs#101)]\n [!code-vb[DataGrid_GroupSortFilter#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#101)]","leadings":["","   "],"nodes":[]},{"pos":[3495,3617],"content":"In XAML, create an instance of the collection class and set the <bpt id=\"p1\">[</bpt>x:Key Directive<ept id=\"p1\">](../../xaml-services/x-key-directive.md)</ept>.","source":"In XAML, create an instance of the collection class and set the [x:Key Directive](../../xaml-services/x-key-directive.md)."},{"pos":[3622,3890],"content":"In XAML, create an instance of the <ph id=\"ph1\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph> class, set the <bpt id=\"p1\">[</bpt>x:Key Directive<ept id=\"p1\">](../../xaml-services/x-key-directive.md)</ept>, and set the instance of your collection class as the <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionViewSource.Source%2A&gt;</ph>.","source":"In XAML, create an instance of the <xref:System.Windows.Data.CollectionViewSource> class, set the [x:Key Directive](../../xaml-services/x-key-directive.md), and set the instance of your collection class as the <xref:System.Windows.Data.CollectionViewSource.Source%2A>."},{"pos":[4036,4244],"content":"Create an instance of the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> class, and set the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ItemsControl.ItemsSource%2A&gt;</ph> property to the <ph id=\"ph3\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph>.","source":"Create an instance of the <xref:System.Windows.Controls.DataGrid> class, and set the <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> property to the <xref:System.Windows.Data.CollectionViewSource>."},{"pos":[4388,4621],"content":"To access the <ph id=\"ph1\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph> from your code, use the <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionViewSource.GetDefaultView%2A&gt;</ph> method to get a reference to the <ph id=\"ph3\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph>.","source":"To access the <xref:System.Windows.Data.CollectionViewSource> from your code, use the <xref:System.Windows.Data.CollectionViewSource.GetDefaultView%2A> method to get a reference to the <xref:System.Windows.Data.CollectionViewSource>."},{"pos":[4627,4909],"content":"[!code-csharp[DataGrid_GroupSortFilter#102](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml.cs#102)]\n [!code-vb[DataGrid_GroupSortFilter#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#102)]","leadings":["","   "],"nodes":[]},{"pos":[4914,4942],"content":"Grouping items in a DataGrid","linkify":"Grouping items in a DataGrid","nodes":[{"content":"Grouping items in a DataGrid","pos":[0,28]}]},{"pos":[4944,5130],"content":"To specify how items are grouped in a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph>, you use the <ph id=\"ph2\">&lt;xref:System.Windows.Data.PropertyGroupDescription&gt;</ph> type to group the items in the source view.","source":"To specify how items are grouped in a <xref:System.Windows.Controls.DataGrid>, you use the <xref:System.Windows.Data.PropertyGroupDescription> type to group the items in the source view."},{"pos":[5136,5175],"content":"To group items in a DataGrid using XAML","linkify":"To group items in a DataGrid using XAML","nodes":[{"content":"To group items in a DataGrid using XAML","pos":[0,39]}]},{"content":"Create a <ph id=\"ph1\">&lt;xref:System.Windows.Data.PropertyGroupDescription&gt;</ph> that specifies the property to group by.","pos":[5180,5281],"source":"Create a <xref:System.Windows.Data.PropertyGroupDescription> that specifies the property to group by."},{"content":"You can specify the property in XAML or in code.","pos":[5282,5330]},{"pos":[5338,5463],"content":"In XAML, set the <ph id=\"ph1\">&lt;xref:System.Windows.Data.PropertyGroupDescription.PropertyName%2A&gt;</ph> to the name of the property to group by.","source":"In XAML, set the <xref:System.Windows.Data.PropertyGroupDescription.PropertyName%2A> to the name of the property to group by."},{"content":"In code, pass the name of the property to group by to the constructor.","pos":[5471,5541]},{"pos":[5546,5722],"content":"Add the <ph id=\"ph1\">&lt;xref:System.Windows.Data.PropertyGroupDescription&gt;</ph> to the <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionViewSource.GroupDescriptions%2A?displayProperty=nameWithType&gt;</ph> collection.","source":"Add the <xref:System.Windows.Data.PropertyGroupDescription> to the <xref:System.Windows.Data.CollectionViewSource.GroupDescriptions%2A?displayProperty=nameWithType> collection."},{"pos":[5727,5925],"content":"Add additional instances of <ph id=\"ph1\">&lt;xref:System.Windows.Data.PropertyGroupDescription&gt;</ph> to the <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionViewSource.GroupDescriptions%2A&gt;</ph> collection to add more levels of grouping.","source":"Add additional instances of <xref:System.Windows.Data.PropertyGroupDescription> to the <xref:System.Windows.Data.CollectionViewSource.GroupDescriptions%2A> collection to add more levels of grouping."},{"pos":[5931,6351],"content":"[!code-xaml[DataGrid_GroupSortFilter#012](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml#012)]\n [!code-csharp[DataGrid_GroupSortFilter#112](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml.cs#112)]\n [!code-vb[DataGrid_GroupSortFilter#112](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#112)]","leadings":["","   ","   "],"nodes":[]},{"pos":[6356,6527],"content":"To remove a group, remove the <ph id=\"ph1\">&lt;xref:System.Windows.Data.PropertyGroupDescription&gt;</ph> from the <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionViewSource.GroupDescriptions%2A&gt;</ph> collection.","source":"To remove a group, remove the <xref:System.Windows.Data.PropertyGroupDescription> from the <xref:System.Windows.Data.CollectionViewSource.GroupDescriptions%2A> collection."},{"pos":[6532,6719],"content":"To remove all groups, call the <ph id=\"ph1\">&lt;xref:System.Collections.ObjectModel.Collection%601.Clear%2A&gt;</ph> method of the <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionViewSource.GroupDescriptions%2A&gt;</ph> collection.","source":"To remove all groups, call the <xref:System.Collections.ObjectModel.Collection%601.Clear%2A> method of the <xref:System.Windows.Data.CollectionViewSource.GroupDescriptions%2A> collection."},{"pos":[6725,7007],"content":"[!code-csharp[DataGrid_GroupSortFilter#114](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml.cs#114)]\n [!code-vb[DataGrid_GroupSortFilter#114](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#114)]","leadings":["","   "],"nodes":[]},{"content":"When items are grouped in the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph>, you can define a <ph id=\"ph2\">&lt;xref:System.Windows.Controls.GroupStyle&gt;</ph> that specifies the appearance of each group.","pos":[7009,7183],"source":"When items are grouped in the <xref:System.Windows.Controls.DataGrid>, you can define a <xref:System.Windows.Controls.GroupStyle> that specifies the appearance of each group."},{"content":"You apply the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.GroupStyle&gt;</ph> by adding it to the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ItemsControl.GroupStyle%2A&gt;</ph> collection of the DataGrid.","pos":[7184,7345],"source":" You apply the <xref:System.Windows.Controls.GroupStyle> by adding it to the <xref:System.Windows.Controls.ItemsControl.GroupStyle%2A> collection of the DataGrid."},{"content":"If you have multiple levels of grouping, you can apply different styles to each group level.","pos":[7346,7438]},{"content":"Styles are applied in the order in which they are defined.","pos":[7439,7497]},{"content":"For example, if you define two styles, the first will be applied to top level row groups.","pos":[7498,7587]},{"content":"The second style will be applied to all row groups at the second level and lower.","pos":[7588,7669]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.DataContext%2A&gt;</ph> of the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.GroupStyle&gt;</ph> is the <ph id=\"ph3\">&lt;xref:System.Windows.Data.CollectionViewGroup&gt;</ph> that the group represents.","pos":[7670,7857],"source":" The <xref:System.Windows.FrameworkElement.DataContext%2A> of the <xref:System.Windows.Controls.GroupStyle> is the <xref:System.Windows.Data.CollectionViewGroup> that the group represents."},{"pos":[7863,7908],"content":"To change the appearance of row group headers","linkify":"To change the appearance of row group headers","nodes":[{"content":"To change the appearance of row group headers","pos":[0,45]}]},{"pos":[7913,8009],"content":"Create a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.GroupStyle&gt;</ph> that defines the appearance of the row group.","source":"Create a <xref:System.Windows.Controls.GroupStyle> that defines the appearance of the row group."},{"pos":[8014,8104],"content":"Put the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.GroupStyle&gt;</ph> inside the <ph id=\"ph2\">`&lt;DataGrid.GroupStyle&gt;`</ph> tags.","source":"Put the <xref:System.Windows.Controls.GroupStyle> inside the `<DataGrid.GroupStyle>` tags."},{"pos":[8248,8275],"content":"Sorting items in a DataGrid","linkify":"Sorting items in a DataGrid","nodes":[{"content":"Sorting items in a DataGrid","pos":[0,27]}]},{"pos":[8277,8454],"content":"To specify how items are sorted in a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph>, you use the <ph id=\"ph2\">&lt;xref:System.ComponentModel.SortDescription&gt;</ph> type to sort the items in the source view.","source":"To specify how items are sorted in a <xref:System.Windows.Controls.DataGrid>, you use the <xref:System.ComponentModel.SortDescription> type to sort the items in the source view."},{"pos":[8460,8487],"content":"To sort items in a DataGrid","linkify":"To sort items in a DataGrid","nodes":[{"content":"To sort items in a DataGrid","pos":[0,27]}]},{"content":"Create a <ph id=\"ph1\">&lt;xref:System.ComponentModel.SortDescription&gt;</ph> that specifies the property to sort by.","pos":[8492,8585],"source":"Create a <xref:System.ComponentModel.SortDescription> that specifies the property to sort by."},{"content":"You can specify the property in XAML or in code.","pos":[8586,8634]},{"pos":[8643,8760],"content":"In XAML, set the <ph id=\"ph1\">&lt;xref:System.ComponentModel.SortDescription.PropertyName%2A&gt;</ph> to the name of the property to sort by.","source":"In XAML, set the <xref:System.ComponentModel.SortDescription.PropertyName%2A> to the name of the property to sort by."},{"pos":[8769,8893],"content":"In code, pass the name of the property to sort by and the <ph id=\"ph1\">&lt;xref:System.ComponentModel.ListSortDirection&gt;</ph> to the constructor.","source":"In code, pass the name of the property to sort by and the <xref:System.ComponentModel.ListSortDirection> to the constructor."},{"pos":[8898,9066],"content":"Add the <ph id=\"ph1\">&lt;xref:System.ComponentModel.SortDescription&gt;</ph> to the <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionViewSource.SortDescriptions%2A?displayProperty=nameWithType&gt;</ph> collection.","source":"Add the <xref:System.ComponentModel.SortDescription> to the <xref:System.Windows.Data.CollectionViewSource.SortDescriptions%2A?displayProperty=nameWithType> collection."},{"pos":[9071,9263],"content":"Add additional instances of <ph id=\"ph1\">&lt;xref:System.ComponentModel.SortDescription&gt;</ph> to the <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionViewSource.SortDescriptions%2A&gt;</ph> collection to sort by additional properties.","source":"Add additional instances of <xref:System.ComponentModel.SortDescription> to the <xref:System.Windows.Data.CollectionViewSource.SortDescriptions%2A> collection to sort by additional properties."},{"pos":[9269,9691],"content":"[!code-xaml[DataGrid_GroupSortFilter#011](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml#011)]\n [!code-csharp[DataGrid_GroupSortFilter#211](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/WindowSnips1.xaml.cs#211)]\n [!code-vb[DataGrid_GroupSortFilter#211](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#211)]","leadings":["","   ","   "],"nodes":[]},{"pos":[9696,9725],"content":"Filtering items in a DataGrid","linkify":"Filtering items in a DataGrid","nodes":[{"content":"Filtering items in a DataGrid","pos":[0,29]}]},{"pos":[9727,9990],"content":"To filter items in a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> using a <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph>, you provide the filtering logic in the handler for the <ph id=\"ph3\">&lt;xref:System.Windows.Data.CollectionViewSource.Filter?displayProperty=nameWithType&gt;</ph> event.","source":"To filter items in a <xref:System.Windows.Controls.DataGrid> using a <xref:System.Windows.Data.CollectionViewSource>, you provide the filtering logic in the handler for the <xref:System.Windows.Data.CollectionViewSource.Filter?displayProperty=nameWithType> event."},{"pos":[9996,10025],"content":"To filter items in a DataGrid","linkify":"To filter items in a DataGrid","nodes":[{"content":"To filter items in a DataGrid","pos":[0,29]}]},{"pos":[10030,10142],"content":"Add a handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Data.CollectionViewSource.Filter?displayProperty=nameWithType&gt;</ph> event.","source":"Add a handler for the <xref:System.Windows.Data.CollectionViewSource.Filter?displayProperty=nameWithType> event."},{"pos":[10147,10251],"content":"In the <ph id=\"ph1\">&lt;xref:System.Windows.Data.CollectionViewSource.Filter&gt;</ph> event handler, define the filtering logic.","source":"In the <xref:System.Windows.Data.CollectionViewSource.Filter> event handler, define the filtering logic."},{"content":"The filter will be applied every time the view is refreshed.","pos":[10257,10317]},{"pos":[10323,10743],"content":"[!code-xaml[DataGrid_GroupSortFilter#013](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml#013)]\n [!code-csharp[DataGrid_GroupSortFilter#113](~/samples/snippets/csharp/VS_Snippets_Wpf/DataGrid_GroupSortFilter/CS/MainWindow.xaml.cs#113)]\n [!code-vb[DataGrid_GroupSortFilter#113](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DataGrid_GroupSortFilter/VB/MainWindow.xaml.vb#113)]","leadings":["","   ","   "],"nodes":[]},{"content":"Alternatively, you can filter items in a <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> by creating a method that provides the filtering logic and setting the <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionView.Filter%2A?displayProperty=nameWithType&gt;</ph> property to apply the filter.","pos":[10745,11007],"source":"Alternatively, you can filter items in a <xref:System.Windows.Controls.DataGrid> by creating a method that provides the filtering logic and setting the <xref:System.Windows.Data.CollectionView.Filter%2A?displayProperty=nameWithType> property to apply the filter."},{"content":"To see an example of this method, see <bpt id=\"p1\">[</bpt>Filter Data in a View<ept id=\"p1\">](../data/how-to-filter-data-in-a-view.md)</ept>.","pos":[11008,11111],"source":" To see an example of this method, see [Filter Data in a View](../data/how-to-filter-data-in-a-view.md)."},{"pos":[11116,11123],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example demonstrates grouping, sorting, and filtering <ph id=\"ph1\">`Task`</ph> data in a <ph id=\"ph2\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph> and displaying the grouped, sorted, and filtered <ph id=\"ph3\">`Task`</ph> data in a <ph id=\"ph4\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph>.","pos":[11125,11364],"source":"The following example demonstrates grouping, sorting, and filtering `Task` data in a <xref:System.Windows.Data.CollectionViewSource> and displaying the grouped, sorted, and filtered `Task` data in a <xref:System.Windows.Controls.DataGrid>."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph> is used as the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.ItemsControl.ItemsSource%2A&gt;</ph> for the <ph id=\"ph3\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph>.","pos":[11365,11539],"source":" The <xref:System.Windows.Data.CollectionViewSource> is used as the <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> for the <xref:System.Windows.Controls.DataGrid>."},{"content":"Grouping, sorting, and filtering are performed on the <ph id=\"ph1\">&lt;xref:System.Windows.Data.CollectionViewSource&gt;</ph> and are displayed in the <ph id=\"ph2\">&lt;xref:System.Windows.Controls.DataGrid&gt;</ph> UI.","pos":[11540,11710],"source":" Grouping, sorting, and filtering are performed on the <xref:System.Windows.Data.CollectionViewSource> and are displayed in the <xref:System.Windows.Controls.DataGrid> UI."},{"content":"To test this example, you will need to adjust the DGGroupSortFilterExample name to match your project name.","pos":[11712,11819]},{"content":"If you are using Visual Basic, you will need to change the class name for <ph id=\"ph1\">&lt;xref:System.Windows.Window&gt;</ph> to the following.","pos":[11820,11940],"source":" If you are using Visual Basic, you will need to change the class name for <xref:System.Windows.Window> to the following."},{"pos":[12391,12399],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[12403,12460],"content":"<bpt id=\"p1\">[</bpt>Data Binding Overview<ept id=\"p1\">](../data/data-binding-overview.md)</ept>","source":"[Data Binding Overview](../data/data-binding-overview.md)"},{"pos":[12463,12569],"content":"<bpt id=\"p1\">[</bpt>Create and Bind to an ObservableCollection<ept id=\"p1\">](../data/how-to-create-and-bind-to-an-observablecollection.md)</ept>","source":"[Create and Bind to an ObservableCollection](../data/how-to-create-and-bind-to-an-observablecollection.md)"},{"pos":[12572,12636],"content":"<bpt id=\"p1\">[</bpt>Filter Data in a View<ept id=\"p1\">](../data/how-to-filter-data-in-a-view.md)</ept>","source":"[Filter Data in a View](../data/how-to-filter-data-in-a-view.md)"},{"pos":[12639,12699],"content":"<bpt id=\"p1\">[</bpt>Sort Data in a View<ept id=\"p1\">](../data/how-to-sort-data-in-a-view.md)</ept>","source":"[Sort Data in a View](../data/how-to-sort-data-in-a-view.md)"},{"pos":[12702,12804],"content":"<bpt id=\"p1\">[</bpt>Sort and Group Data Using a View in XAML<ept id=\"p1\">](../data/how-to-sort-and-group-data-using-a-view-in-xaml.md)</ept>","source":"[Sort and Group Data Using a View in XAML](../data/how-to-sort-and-group-data-using-a-view-in-xaml.md)"}]}