{"content":"---\ntitle: \"GetCORVersion Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"GetCORVersion\"\napi_location: \n  - \"mscoree.dll\"\n  - \"mscoreei.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"GetCORVersion\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetCORVersion function [.NET Framework hosting]\"\nms.assetid: 2f09cd37-bf3a-4cc5-87b0-adc42a7eed31\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 17\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# GetCORVersion Function\nReturns the version number of the common language runtime (CLR) that is running in the current process.  \n  \n This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)].  \n  \n## Syntax  \n  \n```  \nHRESULT GetCORVersion (  \n    [in] LPWSTR  pbuffer,  \n    [in]  DWORD   cchBuffer,   \n    [out] DWORD*  dwlength  \n);   \n```  \n  \n#### Parameters  \n `pbuffer`  \n A pointer to a buffer in which the CLR returns a string specifying the version of the runtime that is currently loaded into the process. The returned string takes the same form as strings passed to [CorBindToRuntimeEx](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md), for example, \"v1.0.1216\". If the runtime has not yet been loaded into the process, the function returns the appropriate directory information for the latest version of the runtime installed on the computer.  \n  \n `cchBuffer`  \n The number of characters (`WCHAR`s) that can be held in `pbuffer`.  \n  \n `dwLength`  \n A pointer to the number of characters actually returned in `pbuffer`. If `pbuffer` is a null pointer, the runtime returns E_POINTER. If the number of characters is greater then the length of `pbuffer` , the runtime returns ERROR_INSUFFICIENT_BUFFER.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See Also  \n [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)","nodes":[{"pos":[4,618],"embed":true,"restype":"x-metadata","content":"title: \"GetCORVersion Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"GetCORVersion\"\napi_location: \n  - \"mscoree.dll\"\n  - \"mscoreei.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"GetCORVersion\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetCORVersion function [.NET Framework hosting]\"\nms.assetid: 2f09cd37-bf3a-4cc5-87b0-adc42a7eed31\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 17\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"GetCORVersion Function | Microsoft Docs","nodes":[{"pos":[0,39],"content":"GetCORVersion Function | Microsoft Docs","nodes":[{"content":"GetCORVersion Function | Microsoft Docs","pos":[0,39]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[625,647],"content":"GetCORVersion Function","linkify":"GetCORVersion Function","nodes":[{"content":"GetCORVersion Function","pos":[0,22]}]},{"content":"Returns the version number of the common language runtime (CLR) that is running in the current process.","pos":[648,751]},{"pos":[758,865],"content":"This function has been deprecated in the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph>.","source":"This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]."},{"pos":[874,880],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1027,1037],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a buffer in which the CLR returns a string specifying the version of the runtime that is currently loaded into the process.","pos":[1054,1190]},{"content":"The returned string takes the same form as strings passed to <bpt id=\"p1\">[</bpt>CorBindToRuntimeEx<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)</ept>, for example, \"v1.0.1216\".","pos":[1191,1380],"source":" The returned string takes the same form as strings passed to [CorBindToRuntimeEx](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md), for example, \"v1.0.1216\"."},{"content":"If the runtime has not yet been loaded into the process, the function returns the appropriate directory information for the latest version of the runtime installed on the computer.","pos":[1381,1561]},{"content":"The number of characters (<ph id=\"ph1\">`WCHAR`</ph>s) that can be held in <ph id=\"ph2\">`pbuffer`</ph>.","pos":[1583,1649],"source":"The number of characters (`WCHAR`s) that can be held in `pbuffer`."},{"content":"A pointer to the number of characters actually returned in <ph id=\"ph1\">`pbuffer`</ph>.","pos":[1670,1739],"source":"A pointer to the number of characters actually returned in `pbuffer`."},{"content":"If <ph id=\"ph1\">`pbuffer`</ph> is a null pointer, the runtime returns E_POINTER.","pos":[1740,1802],"source":" If `pbuffer` is a null pointer, the runtime returns E_POINTER."},{"content":"If the number of characters is greater then the length of <ph id=\"ph1\">`pbuffer`</ph> , the runtime returns ERROR_INSUFFICIENT_BUFFER.","pos":[1803,1919],"source":" If the number of characters is greater then the length of `pbuffer` , the runtime returns ERROR_INSUFFICIENT_BUFFER."},{"pos":[1928,1940],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[1944,2048],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2055,2076],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2083,2107],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> MSCorEE.dll","source":"**Library:** MSCorEE.dll"},{"pos":[2114,2142],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept>","source":"**.NET Framework Versions:**"},{"pos":[2231,2239],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2243,2363],"content":"<bpt id=\"p1\">[</bpt>Deprecated CLR Hosting Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)</ept>","source":"[Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)"}]}