{"content":"---\ntitle: \"Aggregate Clause (Visual Basic) | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.QueryAggregateIn\"\n  - \"vb.QueryAggregate\"\n  - \"vb.QueryAggregateInto\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"Aggregate clause\"\n  - \"Aggregate statement\"\n  - \"queries [Visual Basic], Aggregate\"\nms.assetid: 1315a814-5db6-4077-b34b-b141e11cc0eb\ncaps.latest.revision: 25\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Aggregate Clause (Visual Basic)\nApplies one or more aggregate functions to a collection.  \n  \n## Syntax  \n  \n```  \nAggregate element [As type] In collection _  \n  [, element2 [As type2] In collection2, [...]]  \n  [ clause ]  \n  Into expressionList  \n```  \n  \n## Parts  \n  \n|Term|Definition|  \n|---|---|  \n|`element`|Required. Variable used to iterate through the elements of the collection.|  \n|`type`|Optional. The type of `element`. If no type is specified, the type of `element` is inferred from `collection`.|  \n|`collection`|Required. Refers to the collection to operate on.|  \n|`clause`|Optional. One or more query clauses, such as a `Where` clause, to refine the query result to apply the aggregate clause or clauses to.|  \n|`expressionList`|Required. One or more comma-delimited expressions that identify an aggregate function to apply to the collection. You can apply an alias to an aggregate function to specify a member name for the query result. If no alias is supplied, the name of the aggregate function is used. For examples, see the section about aggregate functions later in this topic.|  \n  \n## Remarks  \n The `Aggregate` clause can be used to include aggregate functions in your queries. Aggregate functions perform checks and computations over a set of values and return a single value. You can access the computed value by using a member of the query result type. The standard aggregate functions that you can use are the `All`, `Any`, `Average`, `Count`, `LongCount`, `Max`, `Min`, and `Sum` functions. These functions are familiar to developers who are familiar with aggregates in SQL. They are described in the following section of this topic.  \n  \n The result of an aggregate function is included in the query result as a field of the query result type. You can supply an alias for the aggregate function result to specify the name of the member of the query result type that will hold the aggregate value. If no alias is supplied, the name of the aggregate function is used.  \n  \n The `Aggregate` clause can begin a query, or it can be included as an additional clause in a query. If the `Aggregate` clause begins a query, the result is a single value that is the result of the aggregate function specified in the `Into` clause. If more than one aggregate function is specified in the `Into` clause, the query returns a single type with a separate property to reference the result of each aggregate function in the `Into` clause. If the `Aggregate` clause is included as an additional clause in a query, the type returned in the query collection will have a separate property to reference the result of each aggregate function in the `Into` clause.  \n  \n## Aggregate Functions  \n The following list describes the standard aggregate functions that can be used with the `Aggregate` clause.  \n  \n|Function|Description|  \n|---|---|  \n|`All`|Returns `true` if all elements in the collection satisfy a specified condition; otherwise returns `false`. Following is an example:<br /><br /> [!code-vb[VbSimpleQuerySamples#5](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_1.vb)]|  \n|`Any`|Returns `true` if any element in the collection satisfies a specified condition; otherwise returns `false`. Following is an example:<br /><br /> [!code-vb[VbSimpleQuerySamples#6](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_2.vb)]|  \n|`Average`|Computes the average of all elements in the collection, or a computes supplied expression for all elements in the collection. Following is an example:<br /><br /> [!code-vb[VbSimpleQuerySamples#7](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_3.vb)]|  \n|`Count`|Counts the number of elements in the collection. You can supply an optional `Boolean` expression to count only the number of elements in the collection that satisfy a condition. Following is an example:<br /><br /> [!code-vb[VbSimpleQuerySamples#8](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_4.vb)]|  \n|`Group`|Refers to query results that are grouped as a result of a `Group By` or `Group Join` clause. The `Group` function is valid only in the `Into` clause of a `Group By` or `Group Join` clause. For more information and examples, see [Group By Clause](../../../visual-basic/language-reference/queries/group-by-clause.md) and [Group Join Clause](../../../visual-basic/language-reference/queries/group-join-clause.md).|  \n|`LongCount`|Counts the number of elements in the collection. You can supply an optional `Boolean` expression to count only the number of elements in the collection that satisfy a condition. Returns the result as a `Long`. For an example, see the `Count` aggregate function.|  \n|`Max`|Computes the maximum value from the collection, or computes a supplied expression for all elements in the collection. Following is an example:<br /><br /> [!code-vb[VbSimpleQuerySamples#9](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_5.vb)]|  \n|`Min`|Computes the minimum value from the collection, or computes a supplied expression for all elements in the collection. Following is an example:<br /><br /> [!code-vb[VbSimpleQuerySamples#10](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_6.vb)]|  \n|`Sum`|Computes the sum of all elements in the collection, or computes a supplied expression for all elements in the collection. Following is an example:<br /><br /> [!code-vb[VbSimpleQuerySamples#15](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_7.vb)]|  \n  \n## Example  \n The following code example shows how to use the `Aggregate` clause to apply aggregate functions to a query result.  \n  \n [!code-vb[VbSimpleQuerySamples#4](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_8.vb)]  \n  \n## Creating User-Defined Aggregate Functions  \n You can include your own custom aggregate functions in a query expression by adding extension methods to the <xref:System.Collections.Generic.IEnumerable%601> type. Your custom method can then perform a calculation or operation on the enumerable collection that has referenced your aggregate function. For more information about extension methods, see [Extension Methods](../../../visual-basic/programming-guide/language-features/procedures/extension-methods.md).  \n  \n For example, the following code example shows a custom aggregate function that calculates the median value of a collection of numbers. There are two overloads of the `Median` extension method. The first overload accepts, as input, a collection of type `IEnumerable(Of Double)`. If the `Median` aggregate function is called for a query field of type `Double`, this method will be called. The second overload of the `Median` method can be passed any generic type. The generic overload of the `Median` method takes a second parameter that references the `Func(Of T, Double)` lambda expression to project a value for a type (from a collection) as the corresponding value of type `Double`. It then delegates the calculation of the median value to the other overload of the `Median` method. For more information about lambda expressions, see [Lambda Expressions](../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md).  \n  \n [!code-vb[VbSimpleQuerySamples#18](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_9.vb)]  \n  \n The following code example shows sample queries that call the `Median` aggregate function on a collection of type `Integer`, and a collection of type `Double`. The query that calls the `Median` aggregate function on the collection of type `Double` calls the overload of the `Median` method that accepts, as input, a collection of type `Double`. The query that calls the `Median` aggregate function on the collection of type `Integer` calls the generic overload of the `Median` method.  \n  \n [!code-vb[VbSimpleQuerySamples#19](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_10.vb)]  \n  \n## See Also  \n [Introduction to LINQ in Visual Basic](../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)   \n [Queries](../../../visual-basic/language-reference/queries/queries.md)   \n [Select Clause](../../../visual-basic/language-reference/queries/select-clause.md)   \n [From Clause](../../../visual-basic/language-reference/queries/from-clause.md)   \n [Where Clause](../../../visual-basic/language-reference/queries/where-clause.md)   \n [Group By Clause](../../../visual-basic/language-reference/queries/group-by-clause.md)","nodes":[{"pos":[4,716],"nodes":[{"content":"Aggregate Clause (Visual Basic) | Microsoft Docs","nodes":[{"pos":[0,48],"content":"Aggregate Clause (Visual Basic) | Microsoft Docs","nodes":[{"content":"Aggregate Clause (Visual Basic) | Microsoft Docs","pos":[0,48]}]}],"pos":[6,57],"yaml":true}],"content":"title: \"Aggregate Clause (Visual Basic) | Microsoft Docs\"\n\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\nf1_keywords: \n  - \"vb.QueryAggregateIn\"\n  - \"vb.QueryAggregate\"\n  - \"vb.QueryAggregateInto\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"Aggregate clause\"\n  - \"Aggregate statement\"\n  - \"queries [Visual Basic], Aggregate\"\nms.assetid: 1315a814-5db6-4077-b34b-b141e11cc0eb\ncaps.latest.revision: 25\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"","yamlblock":true},{"pos":[723,754],"content":"Aggregate Clause (Visual Basic)","linkify":"Aggregate Clause (Visual Basic)","nodes":[{"content":"Aggregate Clause (Visual Basic)","pos":[0,31]}]},{"content":"Applies one or more aggregate functions to a collection.","pos":[755,811]},{"pos":[820,826],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[985,990],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"content":"Term","pos":[997,1001]},{"content":"Definition","pos":[1002,1012]},{"content":"Required.","pos":[1039,1048]},{"content":"Variable used to iterate through the elements of the collection.","pos":[1049,1113]},{"content":"Optional.","pos":[1125,1134]},{"content":"The type of <ph id=\"ph1\">`element`</ph>.","pos":[1135,1157],"source":" The type of `element`."},{"content":"If no type is specified, the type of <ph id=\"ph1\">`element`</ph> is inferred from <ph id=\"ph2\">`collection`</ph>.","pos":[1158,1235],"source":" If no type is specified, the type of `element` is inferred from `collection`."},{"content":"Required.","pos":[1253,1262]},{"content":"Refers to the collection to operate on.","pos":[1263,1302]},{"content":"Optional.","pos":[1316,1325]},{"content":"One or more query clauses, such as a <ph id=\"ph1\">`Where`</ph> clause, to refine the query result to apply the aggregate clause or clauses to.","pos":[1326,1450],"source":" One or more query clauses, such as a `Where` clause, to refine the query result to apply the aggregate clause or clauses to."},{"content":"Required.","pos":[1472,1481]},{"content":"One or more comma-delimited expressions that identify an aggregate function to apply to the collection.","pos":[1482,1585]},{"content":"You can apply an alias to an aggregate function to specify a member name for the query result.","pos":[1586,1680]},{"content":"If no alias is supplied, the name of the aggregate function is used.","pos":[1681,1749]},{"content":"For examples, see the section about aggregate functions later in this topic.","pos":[1750,1826]},{"pos":[1836,1843],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`Aggregate`</ph> clause can be used to include aggregate functions in your queries.","pos":[1847,1929],"source":"The `Aggregate` clause can be used to include aggregate functions in your queries."},{"content":"Aggregate functions perform checks and computations over a set of values and return a single value.","pos":[1930,2029]},{"content":"You can access the computed value by using a member of the query result type.","pos":[2030,2107]},{"content":"The standard aggregate functions that you can use are the <ph id=\"ph1\">`All`</ph>, <ph id=\"ph2\">`Any`</ph>, <ph id=\"ph3\">`Average`</ph>, <ph id=\"ph4\">`Count`</ph>, <ph id=\"ph5\">`LongCount`</ph>, <ph id=\"ph6\">`Max`</ph>, <ph id=\"ph7\">`Min`</ph>, and <ph id=\"ph8\">`Sum`</ph> functions.","pos":[2108,2247],"source":" The standard aggregate functions that you can use are the `All`, `Any`, `Average`, `Count`, `LongCount`, `Max`, `Min`, and `Sum` functions."},{"content":"These functions are familiar to developers who are familiar with aggregates in SQL.","pos":[2248,2331]},{"content":"They are described in the following section of this topic.","pos":[2332,2390]},{"content":"The result of an aggregate function is included in the query result as a field of the query result type.","pos":[2397,2501]},{"content":"You can supply an alias for the aggregate function result to specify the name of the member of the query result type that will hold the aggregate value.","pos":[2502,2654]},{"content":"If no alias is supplied, the name of the aggregate function is used.","pos":[2655,2723]},{"content":"The <ph id=\"ph1\">`Aggregate`</ph> clause can begin a query, or it can be included as an additional clause in a query.","pos":[2730,2829],"source":"The `Aggregate` clause can begin a query, or it can be included as an additional clause in a query."},{"content":"If the <ph id=\"ph1\">`Aggregate`</ph> clause begins a query, the result is a single value that is the result of the aggregate function specified in the <ph id=\"ph2\">`Into`</ph> clause.","pos":[2830,2977],"source":" If the `Aggregate` clause begins a query, the result is a single value that is the result of the aggregate function specified in the `Into` clause."},{"content":"If more than one aggregate function is specified in the <ph id=\"ph1\">`Into`</ph> clause, the query returns a single type with a separate property to reference the result of each aggregate function in the <ph id=\"ph2\">`Into`</ph> clause.","pos":[2978,3178],"source":" If more than one aggregate function is specified in the `Into` clause, the query returns a single type with a separate property to reference the result of each aggregate function in the `Into` clause."},{"content":"If the <ph id=\"ph1\">`Aggregate`</ph> clause is included as an additional clause in a query, the type returned in the query collection will have a separate property to reference the result of each aggregate function in the <ph id=\"ph2\">`Into`</ph> clause.","pos":[3179,3397],"source":" If the `Aggregate` clause is included as an additional clause in a query, the type returned in the query collection will have a separate property to reference the result of each aggregate function in the `Into` clause."},{"pos":[3406,3425],"content":"Aggregate Functions","linkify":"Aggregate Functions","nodes":[{"content":"Aggregate Functions","pos":[0,19]}]},{"pos":[3429,3536],"content":"The following list describes the standard aggregate functions that can be used with the <ph id=\"ph1\">`Aggregate`</ph> clause.","source":"The following list describes the standard aggregate functions that can be used with the `Aggregate` clause."},{"content":"Function","pos":[3543,3551]},{"content":"Description","pos":[3552,3563]},{"content":"Returns <ph id=\"ph1\">`true`</ph> if all elements in the collection satisfy a specified condition; otherwise returns <ph id=\"ph2\">`false`</ph>.","pos":[3586,3692],"source":"Returns `true` if all elements in the collection satisfy a specified condition; otherwise returns `false`."},{"content":"Following is an example:","pos":[3693,3717]},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbSimpleQuerySamples#5<ept id=\"p2\">](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_1.vb)</ept><ept id=\"p1\">]</ept>","pos":[3730,3860],"source":"[!code-vb[VbSimpleQuerySamples#5](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_1.vb)]"},{"content":"Returns <ph id=\"ph1\">`true`</ph> if any element in the collection satisfies a specified condition; otherwise returns <ph id=\"ph2\">`false`</ph>.","pos":[3871,3978],"source":"Returns `true` if any element in the collection satisfies a specified condition; otherwise returns `false`."},{"content":"Following is an example:","pos":[3979,4003]},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbSimpleQuerySamples#6<ept id=\"p2\">](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_2.vb)</ept><ept id=\"p1\">]</ept>","pos":[4016,4146],"source":"[!code-vb[VbSimpleQuerySamples#6](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_2.vb)]"},{"content":"Computes the average of all elements in the collection, or a computes supplied expression for all elements in the collection.","pos":[4161,4286]},{"content":"Following is an example:","pos":[4287,4311]},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbSimpleQuerySamples#7<ept id=\"p2\">](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_3.vb)</ept><ept id=\"p1\">]</ept>","pos":[4324,4454],"source":"[!code-vb[VbSimpleQuerySamples#7](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_3.vb)]"},{"content":"Counts the number of elements in the collection.","pos":[4467,4515]},{"content":"You can supply an optional <ph id=\"ph1\">`Boolean`</ph> expression to count only the number of elements in the collection that satisfy a condition.","pos":[4516,4644],"source":" You can supply an optional `Boolean` expression to count only the number of elements in the collection that satisfy a condition."},{"content":"Following is an example:","pos":[4645,4669]},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbSimpleQuerySamples#8<ept id=\"p2\">](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_4.vb)</ept><ept id=\"p1\">]</ept>","pos":[4682,4812],"source":"[!code-vb[VbSimpleQuerySamples#8](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_4.vb)]"},{"content":"Refers to query results that are grouped as a result of a <ph id=\"ph1\">`Group By`</ph> or <ph id=\"ph2\">`Group Join`</ph> clause.","pos":[4825,4917],"source":"Refers to query results that are grouped as a result of a `Group By` or `Group Join` clause."},{"content":"The <ph id=\"ph1\">`Group`</ph> function is valid only in the <ph id=\"ph2\">`Into`</ph> clause of a <ph id=\"ph3\">`Group By`</ph> or <ph id=\"ph4\">`Group Join`</ph> clause.","pos":[4918,5013],"source":" The `Group` function is valid only in the `Into` clause of a `Group By` or `Group Join` clause."},{"content":"For more information and examples, see <bpt id=\"p1\">[</bpt>Group By Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/group-by-clause.md)</ept> and <bpt id=\"p2\">[</bpt>Group Join Clause<ept id=\"p2\">](../../../visual-basic/language-reference/queries/group-join-clause.md)</ept>.","pos":[5014,5235],"source":" For more information and examples, see [Group By Clause](../../../visual-basic/language-reference/queries/group-by-clause.md) and [Group Join Clause](../../../visual-basic/language-reference/queries/group-join-clause.md)."},{"content":"Counts the number of elements in the collection.","pos":[5252,5300]},{"content":"You can supply an optional <ph id=\"ph1\">`Boolean`</ph> expression to count only the number of elements in the collection that satisfy a condition.","pos":[5301,5429],"source":" You can supply an optional `Boolean` expression to count only the number of elements in the collection that satisfy a condition."},{"content":"Returns the result as a <ph id=\"ph1\">`Long`</ph>.","pos":[5430,5461],"source":" Returns the result as a `Long`."},{"content":"For an example, see the <ph id=\"ph1\">`Count`</ph> aggregate function.","pos":[5462,5513],"source":" For an example, see the `Count` aggregate function."},{"content":"Computes the maximum value from the collection, or computes a supplied expression for all elements in the collection.","pos":[5524,5641]},{"content":"Following is an example:","pos":[5642,5666]},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbSimpleQuerySamples#9<ept id=\"p2\">](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_5.vb)</ept><ept id=\"p1\">]</ept>","pos":[5679,5809],"source":"[!code-vb[VbSimpleQuerySamples#9](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_5.vb)]"},{"content":"Computes the minimum value from the collection, or computes a supplied expression for all elements in the collection.","pos":[5820,5937]},{"content":"Following is an example:","pos":[5938,5962]},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbSimpleQuerySamples#10<ept id=\"p2\">](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_6.vb)</ept><ept id=\"p1\">]</ept>","pos":[5975,6106],"source":"[!code-vb[VbSimpleQuerySamples#10](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_6.vb)]"},{"content":"Computes the sum of all elements in the collection, or computes a supplied expression for all elements in the collection.","pos":[6117,6238]},{"content":"Following is an example:","pos":[6239,6263]},{"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbSimpleQuerySamples#15<ept id=\"p2\">](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_7.vb)</ept><ept id=\"p1\">]</ept>","pos":[6276,6407],"source":"[!code-vb[VbSimpleQuerySamples#15](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_7.vb)]"},{"pos":[6417,6424],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[6428,6542],"content":"The following code example shows how to use the <ph id=\"ph1\">`Aggregate`</ph> clause to apply aggregate functions to a query result.","source":"The following code example shows how to use the `Aggregate` clause to apply aggregate functions to a query result."},{"pos":[6549,6679],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbSimpleQuerySamples#4<ept id=\"p2\">](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_8.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbSimpleQuerySamples#4](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_8.vb)]"},{"pos":[6688,6729],"content":"Creating User-Defined Aggregate Functions","linkify":"Creating User-Defined Aggregate Functions","nodes":[{"content":"Creating User-Defined Aggregate Functions","pos":[0,41]}]},{"content":"You can include your own custom aggregate functions in a query expression by adding extension methods to the <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> type.","pos":[6733,6897],"source":"You can include your own custom aggregate functions in a query expression by adding extension methods to the <xref:System.Collections.Generic.IEnumerable%601> type."},{"content":"Your custom method can then perform a calculation or operation on the enumerable collection that has referenced your aggregate function.","pos":[6898,7034]},{"content":"For more information about extension methods, see <bpt id=\"p1\">[</bpt>Extension Methods<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/extension-methods.md)</ept>.","pos":[7035,7196],"source":" For more information about extension methods, see [Extension Methods](../../../visual-basic/programming-guide/language-features/procedures/extension-methods.md)."},{"content":"For example, the following code example shows a custom aggregate function that calculates the median value of a collection of numbers.","pos":[7203,7337]},{"content":"There are two overloads of the <ph id=\"ph1\">`Median`</ph> extension method.","pos":[7338,7395],"source":" There are two overloads of the `Median` extension method."},{"content":"The first overload accepts, as input, a collection of type <ph id=\"ph1\">`IEnumerable(Of Double)`</ph>.","pos":[7396,7480],"source":" The first overload accepts, as input, a collection of type `IEnumerable(Of Double)`."},{"content":"If the <ph id=\"ph1\">`Median`</ph> aggregate function is called for a query field of type <ph id=\"ph2\">`Double`</ph>, this method will be called.","pos":[7481,7589],"source":" If the `Median` aggregate function is called for a query field of type `Double`, this method will be called."},{"content":"The second overload of the <ph id=\"ph1\">`Median`</ph> method can be passed any generic type.","pos":[7590,7664],"source":" The second overload of the `Median` method can be passed any generic type."},{"content":"The generic overload of the <ph id=\"ph1\">`Median`</ph> method takes a second parameter that references the <ph id=\"ph2\">`Func(Of T, Double)`</ph> lambda expression to project a value for a type (from a collection) as the corresponding value of type <ph id=\"ph3\">`Double`</ph>.","pos":[7665,7887],"source":" The generic overload of the `Median` method takes a second parameter that references the `Func(Of T, Double)` lambda expression to project a value for a type (from a collection) as the corresponding value of type `Double`."},{"content":"It then delegates the calculation of the median value to the other overload of the <ph id=\"ph1\">`Median`</ph> method.","pos":[7888,7987],"source":" It then delegates the calculation of the median value to the other overload of the `Median` method."},{"content":"For more information about lambda expressions, see <bpt id=\"p1\">[</bpt>Lambda Expressions<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)</ept>.","pos":[7988,8152],"source":" For more information about lambda expressions, see [Lambda Expressions](../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)."},{"pos":[8159,8290],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbSimpleQuerySamples#18<ept id=\"p2\">](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_9.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbSimpleQuerySamples#18](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_9.vb)]"},{"content":"The following code example shows sample queries that call the <ph id=\"ph1\">`Median`</ph> aggregate function on a collection of type <ph id=\"ph2\">`Integer`</ph>, and a collection of type <ph id=\"ph3\">`Double`</ph>.","pos":[8297,8456],"source":"The following code example shows sample queries that call the `Median` aggregate function on a collection of type `Integer`, and a collection of type `Double`."},{"content":"The query that calls the <ph id=\"ph1\">`Median`</ph> aggregate function on the collection of type <ph id=\"ph2\">`Double`</ph> calls the overload of the <ph id=\"ph3\">`Median`</ph> method that accepts, as input, a collection of type <ph id=\"ph4\">`Double`</ph>.","pos":[8457,8641],"source":" The query that calls the `Median` aggregate function on the collection of type `Double` calls the overload of the `Median` method that accepts, as input, a collection of type `Double`."},{"content":"The query that calls the <ph id=\"ph1\">`Median`</ph> aggregate function on the collection of type <ph id=\"ph2\">`Integer`</ph> calls the generic overload of the <ph id=\"ph3\">`Median`</ph> method.","pos":[8642,8781],"source":" The query that calls the `Median` aggregate function on the collection of type `Integer` calls the generic overload of the `Median` method."},{"pos":[8788,8920],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbSimpleQuerySamples#19<ept id=\"p2\">](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_10.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbSimpleQuerySamples#19](../../../visual-basic/language-reference/queries/codesnippet/VisualBasic/aggregate-clause_10.vb)]"},{"pos":[8929,8937],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Introduction to LINQ in Visual Basic<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)</ept><ph id=\"ph1\"> </ph>","pos":[8941,9068],"source":"[Introduction to LINQ in Visual Basic](../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md) "},{"content":"<bpt id=\"p1\">[</bpt>Queries<ept id=\"p1\">](../../../visual-basic/language-reference/queries/queries.md)</ept><ph id=\"ph1\"> </ph>","pos":[9072,9143],"source":"[Queries](../../../visual-basic/language-reference/queries/queries.md) "},{"content":"<bpt id=\"p1\">[</bpt>Select Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/select-clause.md)</ept><ph id=\"ph1\"> </ph>","pos":[9147,9230],"source":"[Select Clause](../../../visual-basic/language-reference/queries/select-clause.md) "},{"content":"<bpt id=\"p1\">[</bpt>From Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/from-clause.md)</ept><ph id=\"ph1\"> </ph>","pos":[9234,9313],"source":"[From Clause](../../../visual-basic/language-reference/queries/from-clause.md) "},{"content":"<bpt id=\"p1\">[</bpt>Where Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/where-clause.md)</ept><ph id=\"ph1\"> </ph>","pos":[9317,9398],"source":"[Where Clause](../../../visual-basic/language-reference/queries/where-clause.md) "},{"content":"<bpt id=\"p1\">[</bpt>Group By Clause<ept id=\"p1\">](../../../visual-basic/language-reference/queries/group-by-clause.md)</ept>","pos":[9402,9488],"source":"[Group By Clause](../../../visual-basic/language-reference/queries/group-by-clause.md)"}]}