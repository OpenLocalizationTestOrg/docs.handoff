{"content":"---\ntitle: \"How to: Find Child Elements Based on Position (XPath-LINQ to XML) (Visual Basic) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nms.assetid: 6831e1db-5e97-444f-a7a1-d0a87104b005\ncaps.latest.revision: 3\nauthor: dotnet-bot\nms.author: dotnetcontent\n\n---\n# How to: Find Child Elements Based on Position (XPath-LINQ to XML) (Visual Basic)\nSometimes you want to find elements based on their position. You might want to find the second element, or you might want to find the third through the fifth element.  \n  \n The XPath expression is:  \n  \n `Test[position() >= 2 and position() <= 4]`  \n  \n There are two approaches to writing this [!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)] query in a lazy way. You can use the <xref:System.Linq.Enumerable.Skip%2A> and <xref:System.Linq.Enumerable.Take%2A> operators, or you can use the <xref:System.Linq.Enumerable.Where%2A> overload that takes an index. When you use the <xref:System.Linq.Enumerable.Where%2A> overload, you use a lambda expression that takes two arguments. The following example shows both methods of selecting based on position.  \n  \n## Example  \n This example finds the second through the fourth `Test` element. The result is a collection of elements.  \n  \n This example uses the following XML document: [Sample XML File: Test Configuration (LINQ to XML)](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-test-configuration-linq-to-xml.md).  \n  \n```vb  \nDim testCfg As XElement = XElement.Load(\"TestConfig.xml\")  \n  \n' LINQ to XML query  \nDim list1 As IEnumerable(Of XElement) = _  \n    testCfg.Elements(\"Test\").Skip(1).Take(3)  \n  \n'LINQ to XML query  \nDim list2 As IEnumerable(Of XElement) = _  \n    testCfg.Elements(\"Test\"). _  \n    Where(Function(ByVal el, ByVal idx) idx >= 1 And idx <= 3)  \n  \n' XPath expression  \nDim list3 As IEnumerable(Of XElement) = _  \n    testCfg.XPathSelectElements(\"Test[position() >= 2 and position() <= 4]\")  \n  \nIf list1.Count() = list2.Count() And _  \n       list1.Count() = list3.Count() And _  \n       list1.Intersect(list2).Count() = list1.Count() And _  \n       list1.Intersect(list3).Count() = list1.Count() Then  \n  \n    Console.WriteLine(\"Results are identical\")  \nElse  \n    Console.WriteLine(\"Results differ\")  \nEnd If  \n  \nFor Each el As XElement In list1  \n    Console.WriteLine(el)  \nNext  \n  \n```  \n  \n This example produces the following output:  \n  \n```  \nResults are identical  \n<Test TestId=\"0002\" TestType=\"CMD\">  \n  <Name>Find succeeding characters</Name>  \n  <CommandLine>Examp2.EXE</CommandLine>  \n  <Input>abc</Input>  \n  <Output>def</Output>  \n</Test>  \n<Test TestId=\"0003\" TestType=\"GUI\">  \n  <Name>Convert multiple numbers to strings</Name>  \n  <CommandLine>Examp2.EXE /Verbose</CommandLine>  \n  <Input>123</Input>  \n  <Output>One Two Three</Output>  \n</Test>  \n<Test TestId=\"0004\" TestType=\"GUI\">  \n  <Name>Find correlated key</Name>  \n  <CommandLine>Examp3.EXE</CommandLine>  \n  <Input>a1</Input>  \n  <Output>b1</Output>  \n</Test>  \n```  \n  \n## See Also  \n [LINQ to XML for XPath Users (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)","nodes":[{"pos":[12,109],"content":"How to: Find Child Elements Based on Position (XPath-LINQ to XML) (Visual Basic) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Find Child Elements Based on Position (XPath-LINQ to XML) (Visual Basic) | Microsoft Docs","pos":[0,97]}]},{"pos":[416,496],"content":"How to: Find Child Elements Based on Position (XPath-LINQ to XML) (Visual Basic)","linkify":"How to: Find Child Elements Based on Position (XPath-LINQ to XML) (Visual Basic)","nodes":[{"content":"How to: Find Child Elements Based on Position (XPath-LINQ to XML) (Visual Basic)","pos":[0,80]}]},{"content":"Sometimes you want to find elements based on their position.","pos":[497,557]},{"content":"You might want to find the second element, or you might want to find the third through the fifth element.","pos":[558,663]},{"content":"The XPath expression is:","pos":[670,694]},{"content":"There are two approaches to writing this <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)]</ph> query in a lazy way.","pos":[751,915],"source":"There are two approaches to writing this [!INCLUDE[sqltecxlinq](../../../../csharp/programming-guide/concepts/linq/includes/sqltecxlinq_md.md)] query in a lazy way."},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Skip%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.Take%2A&gt;</ph> operators, or you can use the <ph id=\"ph3\">&lt;xref:System.Linq.Enumerable.Where%2A&gt;</ph> overload that takes an index.","pos":[916,1110],"source":" You can use the <xref:System.Linq.Enumerable.Skip%2A> and <xref:System.Linq.Enumerable.Take%2A> operators, or you can use the <xref:System.Linq.Enumerable.Where%2A> overload that takes an index."},{"content":"When you use the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Where%2A&gt;</ph> overload, you use a lambda expression that takes two arguments.","pos":[1111,1230],"source":" When you use the <xref:System.Linq.Enumerable.Where%2A> overload, you use a lambda expression that takes two arguments."},{"content":"The following example shows both methods of selecting based on position.","pos":[1231,1303]},{"pos":[1312,1319],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"This example finds the second through the fourth <ph id=\"ph1\">`Test`</ph> element.","pos":[1323,1387],"source":"This example finds the second through the fourth `Test` element."},{"content":"The result is a collection of elements.","pos":[1388,1427]},{"pos":[1434,1640],"content":"This example uses the following XML document: <bpt id=\"p1\">[</bpt>Sample XML File: Test Configuration (LINQ to XML)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-test-configuration-linq-to-xml.md)</ept>.","source":"This example uses the following XML document: [Sample XML File: Test Configuration (LINQ to XML)](../../../../visual-basic/programming-guide/concepts/linq/sample-xml-file-test-configuration-linq-to-xml.md)."},{"content":"This example produces the following output:","pos":[2552,2595]},{"pos":[3208,3216],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[3220,3353],"content":"<bpt id=\"p1\">[</bpt>LINQ to XML for XPath Users (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)</ept>","source":"[LINQ to XML for XPath Users (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml-for-xpath-users.md)"}]}