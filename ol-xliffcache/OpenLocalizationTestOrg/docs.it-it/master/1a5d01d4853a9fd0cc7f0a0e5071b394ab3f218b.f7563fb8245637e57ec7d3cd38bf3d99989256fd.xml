{"content":"---\ntitle: \"How to: Catch Parsing Errors (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 22e9068e-ea58-447b-816e-cd1852c11787\n---\n# How to: Catch Parsing Errors (Visual Basic)\nThis topic shows how to detect badly formed or invalid XML.  \n  \n [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is implemented using <xref:System.Xml.XmlReader>. If badly formed or invalid XML is passed to [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], the underlying <xref:System.Xml.XmlReader> class will throw an exception. The various methods that parse XML, such as <xref:System.Xml.Linq.XElement.Parse%2A?displayProperty=nameWithType>, do not catch the exception; the exception can then be caught by your application.  \n  \n Note that you cannot get parse errors if you use XML literals. The Visual Basic compiler will catch errors of badly formed or invalid XML.  \n  \n## Example  \n The following code tries to parse invalid XML:  \n  \n```vb  \nTry  \n    Dim contacts As XElement = XElement.Parse(\"<Contacts>\" & vbCrLf & _  \n        \"    <Contact>\" & vbCrLf & _  \n        \"        <Name>Jim Wilson</Name>\" & vbCrLf & _  \n        \"    </Contact>\" & vbCrLf & _  \n        \"</Contcts>\")  \n  \n    Console.WriteLine(contacts)  \nCatch e As System.Xml.XmlException  \n    Console.WriteLine(e.Message)  \nEnd Try  \n```  \n  \n When you run this code, it throws the following exception:  \n  \n```  \nThe 'Contacts' start tag on line 1 does not match the end tag of 'Contcts'. Line 5, position 13.  \n```  \n  \n For information about the exceptions that you can expect the <xref:System.Xml.Linq.XElement.Parse%2A?displayProperty=nameWithType>, <xref:System.Xml.Linq.XDocument.Parse%2A?displayProperty=nameWithType>, <xref:System.Xml.Linq.XElement.Load%2A?displayProperty=nameWithType>, and <xref:System.Xml.Linq.XDocument.Load%2A?displayProperty=nameWithType> methods to throw, see the <xref:System.Xml.XmlReader> documentation.  \n  \n## See also\n\n- [Parsing XML (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/parsing-xml.md)\n","nodes":[{"pos":[4,125],"embed":true,"restype":"x-metadata","content":"title: \"How to: Catch Parsing Errors (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 22e9068e-ea58-447b-816e-cd1852c11787","nodes":[{"content":"How to: Catch Parsing Errors (Visual Basic)","nodes":[{"pos":[0,43],"content":"How to: Catch Parsing Errors (Visual Basic)","nodes":[{"content":"How to: Catch Parsing Errors (Visual Basic)","pos":[0,43]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[132,175],"content":"How to: Catch Parsing Errors (Visual Basic)","linkify":"How to: Catch Parsing Errors (Visual Basic)","nodes":[{"content":"How to: Catch Parsing Errors (Visual Basic)","pos":[0,43]}]},{"content":"This topic shows how to detect badly formed or invalid XML.","pos":[176,235]},{"content":"<ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph> is implemented using <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph>.","pos":[242,345],"source":"[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] is implemented using <xref:System.Xml.XmlReader>."},{"content":"If badly formed or invalid XML is passed to <ph id=\"ph1\">[!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)]</ph>, the underlying <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph> class will throw an exception.","pos":[346,518],"source":" If badly formed or invalid XML is passed to [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], the underlying <xref:System.Xml.XmlReader> class will throw an exception."},{"content":"The various methods that parse XML, such as <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement.Parse%2A?displayProperty=nameWithType&gt;</ph>, do not catch the exception; the exception can then be caught by your application.","pos":[519,715],"source":" The various methods that parse XML, such as <xref:System.Xml.Linq.XElement.Parse%2A?displayProperty=nameWithType>, do not catch the exception; the exception can then be caught by your application."},{"content":"Note that you cannot get parse errors if you use XML literals.","pos":[722,784]},{"content":"The Visual Basic compiler will catch errors of badly formed or invalid XML.","pos":[785,860]},{"pos":[869,876],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code tries to parse invalid XML:","pos":[880,926]},{"content":"When you run this code, it throws the following exception:","pos":[1309,1367]},{"pos":[1488,1904],"content":"For information about the exceptions that you can expect the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement.Parse%2A?displayProperty=nameWithType&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XDocument.Parse%2A?displayProperty=nameWithType&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XElement.Load%2A?displayProperty=nameWithType&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Xml.Linq.XDocument.Load%2A?displayProperty=nameWithType&gt;</ph> methods to throw, see the <ph id=\"ph5\">&lt;xref:System.Xml.XmlReader&gt;</ph> documentation.","source":"For information about the exceptions that you can expect the <xref:System.Xml.Linq.XElement.Parse%2A?displayProperty=nameWithType>, <xref:System.Xml.Linq.XDocument.Parse%2A?displayProperty=nameWithType>, <xref:System.Xml.Linq.XElement.Load%2A?displayProperty=nameWithType>, and <xref:System.Xml.Linq.XDocument.Load%2A?displayProperty=nameWithType> methods to throw, see the <xref:System.Xml.XmlReader> documentation."},{"pos":[1913,1921],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[1925,2026],"content":"<bpt id=\"p1\">[</bpt>Parsing XML (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/parsing-xml.md)</ept>","source":"[Parsing XML (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/parsing-xml.md)"}]}