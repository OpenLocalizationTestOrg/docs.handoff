{"content":"---\ntitle: \"How to: Group Files by Extension (LINQ) (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 904dc6d7-7162-4655-a7f4-5785d669bc5a\n---\n# How to: Group Files by Extension (LINQ) (Visual Basic)\nThis example shows how LINQ can be used to perform advanced grouping and sorting operations on lists of files or folders. It also shows how to page output in the console window by using the <xref:System.Linq.Enumerable.Skip%2A> and <xref:System.Linq.Enumerable.Take%2A> methods.  \n  \n## Example  \n The following query shows how to group the contents of a specified directory tree by the file name extension.  \n  \n```vb  \nModule GroupByExtension  \n    Public Sub Main()  \n  \n        ' Root folder to query, along with all subfolders.  \n        Dim startFolder As String = \"C:\\program files\\Microsoft Visual Studio 9.0\\VB\\\"  \n  \n        ' Used in WriteLine() to skip over startfolder in output lines.  \n        Dim rootLength As Integer = startFolder.Length  \n  \n        'Take a snapshot of the folder contents  \n        Dim dir As New System.IO.DirectoryInfo(startFolder)  \n        Dim fileList = dir.GetFiles(\"*.*\", System.IO.SearchOption.AllDirectories)  \n  \n        ' Create the query.  \n        Dim queryGroupByExt = From file In fileList _  \n                          Group By file.Extension.ToLower() Into fileGroup = Group _  \n                          Order By ToLower _  \n                          Select fileGroup  \n  \n        ' Execute the query. By storing the result we can  \n        ' page the display with good performance.  \n        Dim groupByExtList = queryGroupByExt.ToList()  \n  \n        ' Display one group at a time. If the number of   \n        ' entries is greater than the number of lines  \n        ' in the console window, then page the output.  \n        Dim trimLength = startFolder.Length  \n        PageOutput(groupByExtList, trimLength)  \n  \n    End Sub  \n  \n    ' Pages console display for large query results. No more than one group per page.  \n    ' This sub specifically works with group queries of FileInfo objects  \n    ' but can be modified for any type.  \n    Sub PageOutput(ByVal groupQuery, ByVal charsToSkip)  \n  \n        ' \"3\" = 1 line for extension key + 1 for \"Press any key\" + 1 for input cursor.  \n        Dim numLines As Integer = Console.WindowHeight - 3  \n        ' Flag to indicate whether there are more results to display  \n        Dim goAgain As Boolean = True  \n  \n        For Each fg As IEnumerable(Of System.IO.FileInfo) In groupQuery  \n            ' Start a new extension at the top of a page.  \n            Dim currentLine As Integer = 0  \n  \n            Do While (currentLine < fg.Count())  \n                Console.Clear()  \n                Console.WriteLine(fg(0).Extension)  \n  \n                ' Get the next page of results  \n                ' No more than one filename per page  \n                Dim resultPage = From file In fg _  \n                                Skip currentLine Take numLines  \n  \n                ' Execute the query. Trim the display output.  \n                For Each line In resultPage  \n                    Console.WriteLine(vbTab & line.FullName.Substring(charsToSkip))  \n                Next  \n  \n                ' Advance the current position  \n                currentLine = numLines + currentLine  \n  \n                ' Give the user a chance to break out of the loop  \n                Console.WriteLine(\"Press any key for next page or the 'End' key to exit.\")  \n                Dim key As ConsoleKey = Console.ReadKey().Key  \n                If key = ConsoleKey.End Then  \n                    goAgain = False  \n                    Exit For  \n                End If  \n            Loop  \n        Next  \n    End Sub  \nEnd Module  \n```  \n  \n The output from this program can be long, depending on the details of the local file system and what the `startFolder` is set to. To enable viewing of all results, this example shows how to page through results. The same techniques can be applied to Windows and Web applications. Notice that because the code pages the items in a group, a nested `For Each` loop is required. There is also some additional logic to compute the current position in the list, and to enable the user to stop paging and exit the program. In this particular case, the paging query is run against the cached results from the original query. In other contexts, such as LINQ to SQL, such caching is not required.  \n  \n## Compiling the Code  \n Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a   `Imports` statement for the System.Linq namespace.  \n  \n## See also\n\n- [LINQ to Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)\n- [LINQ and File Directories (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)\n","nodes":[{"pos":[4,136],"embed":true,"restype":"x-metadata","content":"title: \"How to: Group Files by Extension (LINQ) (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: 904dc6d7-7162-4655-a7f4-5785d669bc5a","nodes":[{"content":"How to: Group Files by Extension (LINQ) (Visual Basic)","nodes":[{"pos":[0,54],"content":"How to: Group Files by Extension (LINQ) (Visual Basic)","nodes":[{"content":"How to: Group Files by Extension (LINQ) (Visual Basic)","pos":[0,54]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[143,197],"content":"How to: Group Files by Extension (LINQ) (Visual Basic)","linkify":"How to: Group Files by Extension (LINQ) (Visual Basic)","nodes":[{"content":"How to: Group Files by Extension (LINQ) (Visual Basic)","pos":[0,54]}]},{"content":"This example shows how LINQ can be used to perform advanced grouping and sorting operations on lists of files or folders.","pos":[198,319]},{"content":"It also shows how to page output in the console window by using the <ph id=\"ph1\">&lt;xref:System.Linq.Enumerable.Skip%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Linq.Enumerable.Take%2A&gt;</ph> methods.","pos":[320,476],"source":" It also shows how to page output in the console window by using the <xref:System.Linq.Enumerable.Skip%2A> and <xref:System.Linq.Enumerable.Take%2A> methods."},{"pos":[485,492],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following query shows how to group the contents of a specified directory tree by the file name extension.","pos":[496,605]},{"content":"The output from this program can be long, depending on the details of the local file system and what the <ph id=\"ph1\">`startFolder`</ph> is set to.","pos":[3727,3856],"source":"The output from this program can be long, depending on the details of the local file system and what the `startFolder` is set to."},{"content":"To enable viewing of all results, this example shows how to page through results.","pos":[3857,3938]},{"content":"The same techniques can be applied to Windows and Web applications.","pos":[3939,4006]},{"content":"Notice that because the code pages the items in a group, a nested <ph id=\"ph1\">`For Each`</ph> loop is required.","pos":[4007,4101],"source":" Notice that because the code pages the items in a group, a nested `For Each` loop is required."},{"content":"There is also some additional logic to compute the current position in the list, and to enable the user to stop paging and exit the program.","pos":[4102,4242]},{"content":"In this particular case, the paging query is run against the cached results from the original query.","pos":[4243,4343]},{"content":"In other contexts, such as LINQ to SQL, such caching is not required.","pos":[4344,4413]},{"pos":[4422,4440],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[4444,4609],"content":"Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a   <ph id=\"ph1\">`Imports`</ph> statement for the System.Linq namespace.","source":"Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a   `Imports` statement for the System.Linq namespace."},{"pos":[4618,4626],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4630,4739],"content":"<bpt id=\"p1\">[</bpt>LINQ to Objects (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)</ept>","source":"[LINQ to Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)"},{"pos":[4742,4871],"content":"<bpt id=\"p1\">[</bpt>LINQ and File Directories (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)</ept>","source":"[LINQ and File Directories (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)"}]}