{"content":"---\ntitle: \"How To: Debug Claims-Aware Applications And Services Using WIF Tracing\"\nms.date: \"03/30/2017\"\nms.assetid: 3d51ba59-3adb-4ca4-bd33-5027531af687\nauthor: \"BrucePerlerMS\"\n---\n# How To: Debug Claims-Aware Applications And Services Using WIF Tracing\n## Applies To  \n  \n-   Microsoft® Windows® Identity Foundation (WIF)  \n  \n-   Service Trace Viewer Tool (SvcTraceViewer.exe)  \n  \n-   Troubleshooting and Debugging WIF Applications  \n  \n## Summary  \n This How-To describes required steps for how to configure WIF tracing, collect trace logs, and how to analyze the trace logs using Trace Viewer tool. It provides general mapping for trace entries to actions needed to troubleshoot issues related to WIF.  \n  \n## Contents  \n  \n-   Objectives  \n  \n-   Summary of Steps  \n  \n-   Step 1 – Configure WIF Tracing Using Web.config Configuration File  \n  \n-   Step 2 – Analyze WIF Trace Files Using Trace Viewer Tool  \n  \n-   Step 3 – Identify Solutions to Fix WIF Related Issues  \n  \n-   Related Items  \n  \n## Objectives  \n  \n-   Configure WIF tracing.  \n  \n-   View trace logs in the Trace Viewer tool.  \n  \n-   Identify WIF related issues in the trace logs.  \n  \n-   Apply corrective actions to WIF related issues found in the trace logs.  \n  \n## Summary of Steps  \n  \n-   Step 1 – Configure WIF Tracing Using Web.config Configuration File  \n  \n-   Step 2 – Analyze WIF Trace Files Using Trace Viewer Tool  \n  \n-   Step 3 – Identify Solutions to Fix WIF Related Issues  \n  \n## Step 1 – Configure WIF Tracing Using Web.config Configuration File  \n In this step, you will add changes to configuration sections in the *Web.config* file that enable WIF to trace its events and store them in a trace log.  \n  \n#### To configure WIF tracing using Web.config configuration file  \n  \n1.  Open the root **Web.config** or **App.config** configuration file in the Visual Studio editor by double clicking on it in **Solution Explorer**. If your solution does not have **Web.config** or **App.config** configuration file, add it by right clicking on the solution in the **Solution Explorer** and clicking **Add**, then clicking **New Item…**. On the **New Item** dialog, Select **Application Configuration File** for **App.config** or **Web Configuration File** for **Web.config** from the list and click **OK**.  \n  \n2.  Add the configuration entries similar to the following to the configuration file inside **\\<configuration>** node at the end of the configuration file:  \n  \n    ```xml  \n    <system.diagnostics>  \n        <sources>  \n            <source name=\"System.IdentityModel\" switchValue=\"Verbose\">  \n                <listeners>  \n                    <add name=\"xml\" type=\"System.Diagnostics.XmlWriterTraceListener\" initializeData=\"WIFTrace.e2e\"/>  \n                </listeners>  \n            </source>  \n        </sources>  \n        <trace autoflush=\"true\"/>  \n    </system.diagnostics>  \n    ```  \n  \n3.  The above configuration instructs WIF to generate verbose trace events and log them into *WIFTrace.e2e* file. For a complete list of values for the **switchValue** switch, refer to the Trace Level table found in the following topic: [Configuring Tracing](../wcf/diagnostics/tracing/configuring-tracing.md).  \n  \n## Step 2 – Analyze WIF Trace Files Using Trace Viewer Tool  \n In this step, you will use the Trace Viewer Tool (SvcTraceViewer.exe) to analyze WIF trace logs.  \n  \n#### To analyze WIF trace logs using Trace Viewer tool (SvcTraceViewer.exe)  \n  \n1.  Trace Viewer tool (SvcTraceViewer.exe) ships as part of the Windows SDK. If you haven’t already installed the Windows SDK, you can download it here: [Windows SDK](https://www.microsoft.com/download/en/details.aspx?id=8279).  \n  \n2.  Run the Trace Viewer tool (SvcTraceViewer.exe). It is typically available in the **Bin** folder of the installation path.  \n  \n3.  Open the WIF trace log file, for example, WIFTrace.e2e by selecting **File**, **Open…** option in the menu or using the **Ctrl+O** shortcut. The trace log file opens in the Trace Viewer tool.  \n  \n4.  Review entries in the **Activity** tab. Each entry should contain an activity number, the number of traces that were logged, duration of the activity and its start and end timestamps.  \n  \n5.  Click on the **Activity** tab. You should see detailed trace entries in the main area of the tool. Use the **Level** dropdown list on the menu to filter specific level of traces, for example: **All**, **Warning**, **Errors**, **Information**, etc.  \n  \n6.  Click on specific trace entries to review the details in the lower area of the tool. The details can be viewed using **Formatted** and **XML** view by choosing corresponding tabs.  \n  \n## Step 3 – Identify Solutions to Fix WIF Related Issues  \n In this step, you can identify solutions for WIF-related issues identified by using the WIF trace log and Trace Viewer tool. It outlines general mapping of WIF related exceptions to potential solutions or required actions to troubleshoot the issue.  \n  \n#### To identify solutions to fix WIF related issues  \n  \n1.  Review the following table of WIF exceptions and the required actions to correct the issues.  \n  \n|**Error ID**|**Error Message**|**Action needed to fix the error**|  \n|-|-|-|  \n|ID4175|The issuer of the security token was not recognized by the IssuerNameRegistry.  To accept security tokens from this issuer, configure the IssuerNameRegistry to return a valid name for this issuer.|This error can be caused by copying a thumbprint from the MMC snap-in and pasting it into the *Web.config* file. Specifically, you can get an extra non-printable character in the text string when copying from the certificate properties window. This extra character causes the thumbprint match to fail.The procedure for correctly copying the thumbprint can be found at [Claims-Based Single Sign-On for the Web and Microsoft Azure](https://docs.microsoft.com/previous-versions/msp-n-p/ff359102%28v=pandp.10%29).|  \n  \n## Related Items  \n  \n-   [Using Service Trace Viewer for Viewing Correlated Traces and Troubleshooting](../wcf/diagnostics/tracing/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting.md)\n","nodes":[{"pos":[4,178],"embed":true,"restype":"x-metadata","content":"title: \"How To: Debug Claims-Aware Applications And Services Using WIF Tracing\"\nms.date: \"03/30/2017\"\nms.assetid: 3d51ba59-3adb-4ca4-bd33-5027531af687\nauthor: \"BrucePerlerMS\"","nodes":[{"content":"How To: Debug Claims-Aware Applications And Services Using WIF Tracing","nodes":[{"pos":[0,70],"content":"How To: Debug Claims-Aware Applications And Services Using WIF Tracing","nodes":[{"content":"How To: Debug Claims-Aware Applications And Services Using WIF Tracing","pos":[0,70]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[185,255],"content":"How To: Debug Claims-Aware Applications And Services Using WIF Tracing","linkify":"How To: Debug Claims-Aware Applications And Services Using WIF Tracing","nodes":[{"content":"How To: Debug Claims-Aware Applications And Services Using WIF Tracing","pos":[0,70]}]},{"pos":[259,269],"content":"Applies To","linkify":"Applies To","nodes":[{"content":"Applies To","pos":[0,10]}]},{"content":"Microsoft® Windows® Identity Foundation (WIF)","pos":[279,324]},{"content":"Service Trace Viewer Tool (SvcTraceViewer.exe)","pos":[334,380]},{"content":"Troubleshooting and Debugging WIF Applications","pos":[390,436]},{"pos":[445,452],"content":"Summary","linkify":"Summary","nodes":[{"content":"Summary","pos":[0,7]}]},{"content":"This How-To describes required steps for how to configure WIF tracing, collect trace logs, and how to analyze the trace logs using Trace Viewer tool.","pos":[456,605]},{"content":"It provides general mapping for trace entries to actions needed to troubleshoot issues related to WIF.","pos":[606,708]},{"pos":[717,725],"content":"Contents","linkify":"Contents","nodes":[{"content":"Contents","pos":[0,8]}]},{"content":"Objectives","pos":[735,745]},{"content":"Summary of Steps","pos":[755,771]},{"content":"Step 1 – Configure WIF Tracing Using Web.config Configuration File","pos":[781,847]},{"content":"Step 2 – Analyze WIF Trace Files Using Trace Viewer Tool","pos":[857,913]},{"content":"Step 3 – Identify Solutions to Fix WIF Related Issues","pos":[923,976]},{"content":"Related Items","pos":[986,999]},{"pos":[1008,1018],"content":"Objectives","linkify":"Objectives","nodes":[{"content":"Objectives","pos":[0,10]}]},{"content":"Configure WIF tracing.","pos":[1028,1050]},{"content":"View trace logs in the Trace Viewer tool.","pos":[1060,1101]},{"content":"Identify WIF related issues in the trace logs.","pos":[1111,1157]},{"content":"Apply corrective actions to WIF related issues found in the trace logs.","pos":[1167,1238]},{"pos":[1247,1263],"content":"Summary of Steps","linkify":"Summary of Steps","nodes":[{"content":"Summary of Steps","pos":[0,16]}]},{"content":"Step 1 – Configure WIF Tracing Using Web.config Configuration File","pos":[1273,1339]},{"content":"Step 2 – Analyze WIF Trace Files Using Trace Viewer Tool","pos":[1349,1405]},{"content":"Step 3 – Identify Solutions to Fix WIF Related Issues","pos":[1415,1468]},{"pos":[1477,1543],"content":"Step 1 – Configure WIF Tracing Using Web.config Configuration File","linkify":"Step 1 – Configure WIF Tracing Using Web.config Configuration File","nodes":[{"content":"Step 1 – Configure WIF Tracing Using Web.config Configuration File","pos":[0,66]}]},{"pos":[1547,1699],"content":"In this step, you will add changes to configuration sections in the <bpt id=\"p1\">*</bpt>Web.config<ept id=\"p1\">*</ept> file that enable WIF to trace its events and store them in a trace log.","source":"In this step, you will add changes to configuration sections in the *Web.config* file that enable WIF to trace its events and store them in a trace log."},{"pos":[1710,1770],"content":"To configure WIF tracing using Web.config configuration file","linkify":"To configure WIF tracing using Web.config configuration file","nodes":[{"content":"To configure WIF tracing using Web.config configuration file","pos":[0,60]}]},{"content":"Open the root <bpt id=\"p1\">**</bpt>Web.config<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>App.config<ept id=\"p2\">**</ept> configuration file in the Visual Studio editor by double clicking on it in <bpt id=\"p3\">**</bpt>Solution Explorer<ept id=\"p3\">**</ept>.","pos":[1780,1924],"source":"Open the root **Web.config** or **App.config** configuration file in the Visual Studio editor by double clicking on it in **Solution Explorer**."},{"content":"If your solution does not have <bpt id=\"p1\">**</bpt>Web.config<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>App.config<ept id=\"p2\">**</ept> configuration file, add it by right clicking on the solution in the <bpt id=\"p3\">**</bpt>Solution Explorer<ept id=\"p3\">**</ept> and clicking <bpt id=\"p4\">**</bpt>Add<ept id=\"p4\">**</ept>, then clicking <bpt id=\"p5\">**</bpt>New Item…<ept id=\"p5\">**</ept>.","pos":[1925,2129],"source":" If your solution does not have **Web.config** or **App.config** configuration file, add it by right clicking on the solution in the **Solution Explorer** and clicking **Add**, then clicking **New Item…**."},{"content":"On the <bpt id=\"p1\">**</bpt>New Item<ept id=\"p1\">**</ept> dialog, Select <bpt id=\"p2\">**</bpt>Application Configuration File<ept id=\"p2\">**</ept> for <bpt id=\"p3\">**</bpt>App.config<ept id=\"p3\">**</ept> or <bpt id=\"p4\">**</bpt>Web Configuration File<ept id=\"p4\">**</ept> for <bpt id=\"p5\">**</bpt>Web.config<ept id=\"p5\">**</ept> from the list and click <bpt id=\"p6\">**</bpt>OK<ept id=\"p6\">**</ept>.","pos":[2130,2299],"source":" On the **New Item** dialog, Select **Application Configuration File** for **App.config** or **Web Configuration File** for **Web.config** from the list and click **OK**."},{"pos":[2309,2460],"content":"Add the configuration entries similar to the following to the configuration file inside <bpt id=\"p1\">**</bpt><ph id=\"ph1\">\\&lt;</ph>configuration&gt;<ept id=\"p1\">**</ept> node at the end of the configuration file:","source":"Add the configuration entries similar to the following to the configuration file inside **\\<configuration>** node at the end of the configuration file:"},{"content":"The above configuration instructs WIF to generate verbose trace events and log them into <bpt id=\"p1\">*</bpt>WIFTrace.e2e<ept id=\"p1\">*</ept> file.","pos":[2905,3014],"source":"The above configuration instructs WIF to generate verbose trace events and log them into *WIFTrace.e2e* file."},{"content":"For a complete list of values for the <bpt id=\"p1\">**</bpt>switchValue<ept id=\"p1\">**</ept> switch, refer to the Trace Level table found in the following topic: <bpt id=\"p2\">[</bpt>Configuring Tracing<ept id=\"p2\">](../wcf/diagnostics/tracing/configuring-tracing.md)</ept>.","pos":[3015,3211],"source":" For a complete list of values for the **switchValue** switch, refer to the Trace Level table found in the following topic: [Configuring Tracing](../wcf/diagnostics/tracing/configuring-tracing.md)."},{"pos":[3220,3276],"content":"Step 2 – Analyze WIF Trace Files Using Trace Viewer Tool","linkify":"Step 2 – Analyze WIF Trace Files Using Trace Viewer Tool","nodes":[{"content":"Step 2 – Analyze WIF Trace Files Using Trace Viewer Tool","pos":[0,56]}]},{"content":"In this step, you will use the Trace Viewer Tool (SvcTraceViewer.exe) to analyze WIF trace logs.","pos":[3280,3376]},{"pos":[3387,3457],"content":"To analyze WIF trace logs using Trace Viewer tool (SvcTraceViewer.exe)","linkify":"To analyze WIF trace logs using Trace Viewer tool (SvcTraceViewer.exe)","nodes":[{"content":"To analyze WIF trace logs using Trace Viewer tool (SvcTraceViewer.exe)","pos":[0,70]}]},{"content":"Trace Viewer tool (SvcTraceViewer.exe) ships as part of the Windows SDK.","pos":[3467,3539]},{"content":"If you haven’t already installed the Windows SDK, you can download it here: <bpt id=\"p1\">[</bpt>Windows SDK<ept id=\"p1\">](https://www.microsoft.com/download/en/details.aspx?id=8279)</ept>.","pos":[3540,3690],"source":" If you haven’t already installed the Windows SDK, you can download it here: [Windows SDK](https://www.microsoft.com/download/en/details.aspx?id=8279)."},{"content":"Run the Trace Viewer tool (SvcTraceViewer.exe).","pos":[3700,3747]},{"content":"It is typically available in the <bpt id=\"p1\">**</bpt>Bin<ept id=\"p1\">**</ept> folder of the installation path.","pos":[3748,3821],"source":" It is typically available in the **Bin** folder of the installation path."},{"content":"Open the WIF trace log file, for example, WIFTrace.e2e by selecting <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Open…<ept id=\"p2\">**</ept>","pos":[3831,3918],"source":"Open the WIF trace log file, for example, WIFTrace.e2e by selecting **File**, **Open…**"},{"content":"option in the menu or using the <bpt id=\"p1\">**</bpt>Ctrl+O<ept id=\"p1\">**</ept> shortcut.","pos":[3919,3971],"source":" option in the menu or using the **Ctrl+O** shortcut."},{"content":"The trace log file opens in the Trace Viewer tool.","pos":[3972,4022]},{"pos":[4032,4215],"content":"Review entries in the <bpt id=\"p1\">**</bpt>Activity<ept id=\"p1\">**</ept> tab. Each entry should contain an activity number, the number of traces that were logged, duration of the activity and its start and end timestamps.","source":"Review entries in the **Activity** tab. Each entry should contain an activity number, the number of traces that were logged, duration of the activity and its start and end timestamps."},{"content":"Click on the <bpt id=\"p1\">**</bpt>Activity<ept id=\"p1\">**</ept> tab. You should see detailed trace entries in the main area of the tool.","pos":[4225,4323],"source":"Click on the **Activity** tab. You should see detailed trace entries in the main area of the tool."},{"content":"Use the <bpt id=\"p1\">**</bpt>Level<ept id=\"p1\">**</ept> dropdown list on the menu to filter specific level of traces, for example: <bpt id=\"p2\">**</bpt>All<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Warning<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Errors<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>Information<ept id=\"p5\">**</ept>, etc.","pos":[4324,4472],"source":" Use the **Level** dropdown list on the menu to filter specific level of traces, for example: **All**, **Warning**, **Errors**, **Information**, etc."},{"content":"Click on specific trace entries to review the details in the lower area of the tool.","pos":[4482,4566]},{"content":"The details can be viewed using <bpt id=\"p1\">**</bpt>Formatted<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>XML<ept id=\"p2\">**</ept> view by choosing corresponding tabs.","pos":[4567,4661],"source":" The details can be viewed using **Formatted** and **XML** view by choosing corresponding tabs."},{"pos":[4670,4723],"content":"Step 3 – Identify Solutions to Fix WIF Related Issues","linkify":"Step 3 – Identify Solutions to Fix WIF Related Issues","nodes":[{"content":"Step 3 – Identify Solutions to Fix WIF Related Issues","pos":[0,53]}]},{"content":"In this step, you can identify solutions for WIF-related issues identified by using the WIF trace log and Trace Viewer tool.","pos":[4727,4851]},{"content":"It outlines general mapping of WIF related exceptions to potential solutions or required actions to troubleshoot the issue.","pos":[4852,4975]},{"pos":[4986,5033],"content":"To identify solutions to fix WIF related issues","linkify":"To identify solutions to fix WIF related issues","nodes":[{"content":"To identify solutions to fix WIF related issues","pos":[0,47]}]},{"content":"Review the following table of WIF exceptions and the required actions to correct the issues.","pos":[5043,5135]},{"pos":[5142,5154],"content":"<bpt id=\"p1\">**</bpt>Error ID<ept id=\"p1\">**</ept>","source":"**Error ID**"},{"pos":[5155,5172],"content":"<bpt id=\"p1\">**</bpt>Error Message<ept id=\"p1\">**</ept>","source":"**Error Message**"},{"pos":[5173,5207],"content":"<bpt id=\"p1\">**</bpt>Action needed to fix the error<ept id=\"p1\">**</ept>","source":"**Action needed to fix the error**"},{"content":"ID4175","pos":[5222,5228]},{"content":"The issuer of the security token was not recognized by the IssuerNameRegistry.","pos":[5229,5307]},{"content":"To accept security tokens from this issuer, configure the IssuerNameRegistry to return a valid name for this issuer.","pos":[5309,5425]},{"content":"This error can be caused by copying a thumbprint from the MMC snap-in and pasting it into the <bpt id=\"p1\">*</bpt>Web.config<ept id=\"p1\">*</ept> file.","pos":[5426,5538],"source":"This error can be caused by copying a thumbprint from the MMC snap-in and pasting it into the *Web.config* file."},{"content":"Specifically, you can get an extra non-printable character in the text string when copying from the certificate properties window.","pos":[5539,5669]},{"content":"This extra character causes the thumbprint match to fail.The procedure for correctly copying the thumbprint can be found at <bpt id=\"p1\">[</bpt>Claims-Based Single Sign-On for the Web and Microsoft Azure<ept id=\"p1\">](https://docs.microsoft.com/previous-versions/msp-n-p/ff359102%28v=pandp.10%29)</ept>.","pos":[5670,5935],"source":" This extra character causes the thumbprint match to fail.The procedure for correctly copying the thumbprint can be found at [Claims-Based Single Sign-On for the Web and Microsoft Azure](https://docs.microsoft.com/previous-versions/msp-n-p/ff359102%28v=pandp.10%29)."},{"pos":[5945,5958],"content":"Related Items","linkify":"Related Items","nodes":[{"content":"Related Items","pos":[0,13]}]},{"pos":[5968,6154],"content":"<bpt id=\"p1\">[</bpt>Using Service Trace Viewer for Viewing Correlated Traces and Troubleshooting<ept id=\"p1\">](../wcf/diagnostics/tracing/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting.md)</ept>","source":"[Using Service Trace Viewer for Viewing Correlated Traces and Troubleshooting](../wcf/diagnostics/tracing/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting.md)"}]}