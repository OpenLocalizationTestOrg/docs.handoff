{"content":"---\ntitle: \"Query Notifications in SQL Server | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 0f0ba1a1-3180-4af8-87f7-c795dc8f8f55\ncaps.latest.revision: 6\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Query Notifications in SQL Server\nBuilt upon the Service Broker infrastructure, query notifications allow applications to be notified when data has changed. This feature is particularly useful for applications that provide a cache of information from a database, such as a Web application, and need to be notified when the source data is changed.  \n  \n There are three ways you can implement query notifications using ADO.NET:  \n  \n1.  The low-level implementation is provided by the `SqlNotificationRequest` class that exposes server-side functionality, enabling you to execute a command with a notification request.  \n  \n2.  The high-level implementation is provided by the `SqlDependency` class, which is a class that provides a high-level abstraction of notification functionality between the source application and SQL Server, enabling you to use a dependency to detect changes in the server. In most cases, this is the simplest and most effective way to leverage SQL Server notifications capability by managed client applications using the .NET Framework Data Provider for SQL Server.  \n  \n3.  In addition, Web applications built using ASP.NET 2.0 or later can use the `SqlCacheDependency` helper classes.  \n  \n Query notifications are used for applications that need to refresh displays or caches in response to changes in underlying data. Microsoft SQL Server allows .NET Framework applications to send a command to SQL Server and request notification if executing the same command would produce result sets different from those initially retrieved. Notifications generated at the server are sent through queues to be processed later.  \n  \n You can set up notifications for SELECT and EXECUTE statements. When using an EXECUTE statement, SQL Server registers a notification for the command executed rather than the EXECUTE statement itself. The command must meet the requirements and limitations for a SELECT statement. When a command that registers a notification contains more than one statement, the Database Engine creates a notification for each statement in the batch.  \n  \n If you are developing an application where you need reliable sub-second notifications when data changes, review the sections **Planning an Efficient Query Notifications Strategy** and **Alternatives to Query Notifications** in the [Planning for Notifications](http://go.microsoft.com/fwlink/?LinkId=211984) topic in SQL Server Books Online. For more information about Query Notifications and SQL Server Service Broker, see the following links to topics in SQL Server Books Online.  \n  \n **SQL Server Books Online**  \n  \n-   [Using Query Notifications](http://msdn.microsoft.com/library/ms175110.aspx)  \n  \n-   [Creating a Query for Notification](http://msdn.microsoft.com/library/ms181122.aspx)  \n  \n-   [Service Broker](http://msdn.microsoft.com/library/bb522889.aspx)  \n  \n-   [Service Broker Developer InfoCenter](http://msdn.microsoft.com/library/ms166100.aspx)  \n  \n-   [Development (Service Broker)](http://msdn.microsoft.com/library/bb522908.aspx)  \n  \n## In This Section  \n [Enabling Query Notifications](../../../../../docs/framework/data/adonet/sql/enabling-query-notifications.md)  \n Discusses how to use query notifications, including the requirements for enabling and using them.  \n  \n [SqlDependency in an ASP.NET Application](../../../../../docs/framework/data/adonet/sql/sqldependency-in-an-aspnet-app.md)  \n Demonstrates how to use query notifications from an ASP.NET application.  \n  \n [Detecting Changes with SqlDependency](../../../../../docs/framework/data/adonet/sql/detecting-changes-with-sqldependency.md)  \n Demonstrates how to detect when query results will be different from those originally received.  \n  \n [SqlCommand Execution with a SqlNotificationRequest](../../../../../docs/framework/data/adonet/sql/sqlcommand-execution-with-a-sqlnotificationrequest.md)  \n Demonstrates configuring a <xref:System.Data.SqlClient.SqlCommand> object to work with a query notification.  \n  \n## Reference  \n <xref:System.Data.Sql.SqlNotificationRequest>  \n Describes the <xref:System.Data.Sql.SqlNotificationRequest> class and all of its members.  \n  \n <xref:System.Data.SqlClient.SqlDependency>  \n Describes the <xref:System.Data.SqlClient.SqlDependency> class and all of its members.  \n  \n <xref:System.Web.Caching.SqlCacheDependency>  \n Describes the <xref:System.Web.Caching.SqlCacheDependency> class and all of its members.  \n  \n## See Also  \n [SQL Server and ADO.NET](../../../../../docs/framework/data/adonet/sql/index.md)   \n [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)","nodes":[{"pos":[12,62],"content":"Query Notifications in SQL Server | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Query Notifications in SQL Server | Microsoft Docs","pos":[0,50]}]},{"pos":[371,404],"content":"Query Notifications in SQL Server","linkify":"Query Notifications in SQL Server","nodes":[{"content":"Query Notifications in SQL Server","pos":[0,33]}]},{"content":"Built upon the Service Broker infrastructure, query notifications allow applications to be notified when data has changed.","pos":[405,527]},{"content":"This feature is particularly useful for applications that provide a cache of information from a database, such as a Web application, and need to be notified when the source data is changed.","pos":[528,717]},{"content":"There are three ways you can implement query notifications using ADO.NET:","pos":[724,797]},{"pos":[807,988],"content":"The low-level implementation is provided by the <ph id=\"ph1\">`SqlNotificationRequest`</ph> class that exposes server-side functionality, enabling you to execute a command with a notification request.","source":"The low-level implementation is provided by the `SqlNotificationRequest` class that exposes server-side functionality, enabling you to execute a command with a notification request."},{"content":"The high-level implementation is provided by the <ph id=\"ph1\">`SqlDependency`</ph> class, which is a class that provides a high-level abstraction of notification functionality between the source application and SQL Server, enabling you to use a dependency to detect changes in the server.","pos":[998,1268],"source":"The high-level implementation is provided by the `SqlDependency` class, which is a class that provides a high-level abstraction of notification functionality between the source application and SQL Server, enabling you to use a dependency to detect changes in the server."},{"content":"In most cases, this is the simplest and most effective way to leverage SQL Server notifications capability by managed client applications using the .NET Framework Data Provider for SQL Server.","pos":[1269,1461]},{"pos":[1471,1582],"content":"In addition, Web applications built using ASP.NET 2.0 or later can use the <ph id=\"ph1\">`SqlCacheDependency`</ph> helper classes.","source":"In addition, Web applications built using ASP.NET 2.0 or later can use the `SqlCacheDependency` helper classes."},{"content":"Query notifications are used for applications that need to refresh displays or caches in response to changes in underlying data.","pos":[1589,1717]},{"content":"Microsoft SQL Server allows .NET Framework applications to send a command to SQL Server and request notification if executing the same command would produce result sets different from those initially retrieved.","pos":[1718,1928]},{"content":"Notifications generated at the server are sent through queues to be processed later.","pos":[1929,2013]},{"content":"You can set up notifications for SELECT and EXECUTE statements.","pos":[2020,2083]},{"content":"When using an EXECUTE statement, SQL Server registers a notification for the command executed rather than the EXECUTE statement itself.","pos":[2084,2219]},{"content":"The command must meet the requirements and limitations for a SELECT statement.","pos":[2220,2298]},{"content":"When a command that registers a notification contains more than one statement, the Database Engine creates a notification for each statement in the batch.","pos":[2299,2453]},{"content":"If you are developing an application where you need reliable sub-second notifications when data changes, review the sections <bpt id=\"p1\">**</bpt>Planning an Efficient Query Notifications Strategy<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Alternatives to Query Notifications<ept id=\"p2\">**</ept> in the <bpt id=\"p3\">[</bpt>Planning for Notifications<ept id=\"p3\">](http://go.microsoft.com/fwlink/?LinkId=211984)</ept> topic in SQL Server Books Online.","pos":[2460,2800],"source":"If you are developing an application where you need reliable sub-second notifications when data changes, review the sections **Planning an Efficient Query Notifications Strategy** and **Alternatives to Query Notifications** in the [Planning for Notifications](http://go.microsoft.com/fwlink/?LinkId=211984) topic in SQL Server Books Online."},{"content":"For more information about Query Notifications and SQL Server Service Broker, see the following links to topics in SQL Server Books Online.","pos":[2801,2940]},{"pos":[2947,2974],"content":"<bpt id=\"p1\">**</bpt>SQL Server Books Online<ept id=\"p1\">**</ept>","source":"**SQL Server Books Online**"},{"pos":[2984,3060],"content":"<bpt id=\"p1\">[</bpt>Using Query Notifications<ept id=\"p1\">](http://msdn.microsoft.com/library/ms175110.aspx)</ept>","source":"[Using Query Notifications](http://msdn.microsoft.com/library/ms175110.aspx)"},{"pos":[3070,3154],"content":"<bpt id=\"p1\">[</bpt>Creating a Query for Notification<ept id=\"p1\">](http://msdn.microsoft.com/library/ms181122.aspx)</ept>","source":"[Creating a Query for Notification](http://msdn.microsoft.com/library/ms181122.aspx)"},{"pos":[3164,3229],"content":"<bpt id=\"p1\">[</bpt>Service Broker<ept id=\"p1\">](http://msdn.microsoft.com/library/bb522889.aspx)</ept>","source":"[Service Broker](http://msdn.microsoft.com/library/bb522889.aspx)"},{"pos":[3239,3325],"content":"<bpt id=\"p1\">[</bpt>Service Broker Developer InfoCenter<ept id=\"p1\">](http://msdn.microsoft.com/library/ms166100.aspx)</ept>","source":"[Service Broker Developer InfoCenter](http://msdn.microsoft.com/library/ms166100.aspx)"},{"pos":[3335,3414],"content":"<bpt id=\"p1\">[</bpt>Development (Service Broker)<ept id=\"p1\">](http://msdn.microsoft.com/library/bb522908.aspx)</ept>","source":"[Development (Service Broker)](http://msdn.microsoft.com/library/bb522908.aspx)"},{"pos":[3423,3438],"content":"In This Section","linkify":"In This Section","nodes":[{"content":"In This Section","pos":[0,15]}]},{"content":"<bpt id=\"p1\">[</bpt>Enabling Query Notifications<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/enabling-query-notifications.md)</ept>","pos":[3442,3551],"source":"[Enabling Query Notifications](../../../../../docs/framework/data/adonet/sql/enabling-query-notifications.md)"},{"content":"Discusses how to use query notifications, including the requirements for enabling and using them.","pos":[3555,3652]},{"content":"<bpt id=\"p1\">[</bpt>SqlDependency in an ASP.NET Application<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/sqldependency-in-an-aspnet-app.md)</ept>","pos":[3659,3781],"source":"[SqlDependency in an ASP.NET Application](../../../../../docs/framework/data/adonet/sql/sqldependency-in-an-aspnet-app.md)"},{"content":"Demonstrates how to use query notifications from an ASP.NET application.","pos":[3785,3857]},{"content":"<bpt id=\"p1\">[</bpt>Detecting Changes with SqlDependency<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/detecting-changes-with-sqldependency.md)</ept>","pos":[3864,3989],"source":"[Detecting Changes with SqlDependency](../../../../../docs/framework/data/adonet/sql/detecting-changes-with-sqldependency.md)"},{"content":"Demonstrates how to detect when query results will be different from those originally received.","pos":[3993,4088]},{"content":"<bpt id=\"p1\">[</bpt>SqlCommand Execution with a SqlNotificationRequest<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/sqlcommand-execution-with-a-sqlnotificationrequest.md)</ept>","pos":[4095,4248],"source":"[SqlCommand Execution with a SqlNotificationRequest](../../../../../docs/framework/data/adonet/sql/sqlcommand-execution-with-a-sqlnotificationrequest.md)"},{"content":"Demonstrates configuring a <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlCommand&gt;</ph> object to work with a query notification.","pos":[4252,4360],"source":" Demonstrates configuring a <xref:System.Data.SqlClient.SqlCommand> object to work with a query notification."},{"pos":[4369,4378],"content":"Reference","linkify":"Reference","nodes":[{"content":"Reference","pos":[0,9]}]},{"content":"Describes the <ph id=\"ph1\">&lt;xref:System.Data.Sql.SqlNotificationRequest&gt;</ph> class and all of its members.","pos":[4431,4520],"source":"Describes the <xref:System.Data.Sql.SqlNotificationRequest> class and all of its members."},{"content":"Describes the <ph id=\"ph1\">&lt;xref:System.Data.SqlClient.SqlDependency&gt;</ph> class and all of its members.","pos":[4573,4659],"source":"Describes the <xref:System.Data.SqlClient.SqlDependency> class and all of its members."},{"content":"Describes the <ph id=\"ph1\">&lt;xref:System.Web.Caching.SqlCacheDependency&gt;</ph> class and all of its members.","pos":[4714,4802],"source":"Describes the <xref:System.Web.Caching.SqlCacheDependency> class and all of its members."},{"pos":[4811,4819],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>SQL Server and ADO.NET<ept id=\"p1\">](../../../../../docs/framework/data/adonet/sql/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[4823,4904],"source":"[SQL Server and ADO.NET](../../../../../docs/framework/data/adonet/sql/index.md) "},{"content":"<bpt id=\"p1\"> [</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=217917)</ept>","pos":[4907,5011],"source":" [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)"}]}