{"content":"---\ntitle: \"How to: Detect Whether the .NET Framework 3.0 Is Installed\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"WinFX Runtime user-agent string\"\n  - \"presence of WPT [WPF], detecting\"\n  - \"detecting WPF presence [WPF]\"\nms.assetid: 7f71d652-1749-4379-945a-aa2e3994cb43\n---\n# How to: Detect Whether the .NET Framework 3.0 Is Installed\nBefore administrators can deploy Microsoft .NET Framework applications on a system, they must first confirm that the .NET Framework runtime is present. This topic provides a script written in HTML/JavaScript that administrators can use to determine whether the .NET Framework is present on a system.  \n  \n> [!NOTE]\n>  For more detailed information on installing, deploying, and detecting the Microsoft .NET Framework, see the discussion in [Deploying Microsoft .NET Framework Version 3.0](https://go.microsoft.com/fwlink/?LinkId=96739).  \n  \n<a name=\"content_expiration\"></a>   \n## Detect the \".NET CLR\" User-Agent String  \n When .NET Framework is installed, the MSI adds \".NET CLR\" and the version number to the UserAgent string. The following example shows a script embedded in a simple HTML page. The script searches the UserAgent string to determine whether .NET Framework is installed, and displays a status message on the results of the search.  \n  \n```  \n<HTML>  \n  <HEAD>  \n    <TITLE>Test for the .NET Framework 3.0</TITLE>  \n    <META HTTP-EQUIV=\"Content-Type\" CONTENT=\"text/html; charset=utf-8\" />  \n    <SCRIPT LANGUAGE=\"JavaScript\">  \n    <!--  \n    var dotNETRuntimeVersion = \"3.0.04425.00\";  \n  \n    function window::onload()  \n    {  \n      if (HasRuntimeVersion(dotNETRuntimeVersion))  \n      {  \n        result.innerText =   \n          \"This machine has the correct version of the .NET Framework 3.0: \"   \n          + dotNETRuntimeVersion  \n      }   \n      else  \n      {  \n        result.innerText =   \n          \"This machine does not have the correct version of the .NET Framework 3.0.\"  \n      }  \n      result.innerText += \"\\n\\nThis machine's userAgent string is: \" +   \n        navigator.userAgent + \".\";  \n    }  \n  \n    //  \n    // Retrieve the version from the user agent string and   \n    // compare with the specified version.  \n    //  \n    function HasRuntimeVersion(versionToCheck)  \n    {  \n      var userAgentString =   \n        navigator.userAgent.match(/.NET CLR [0-9.]+/g);  \n  \n      if (userAgentString != null)  \n      {  \n        var i;  \n  \n        for (i = 0; i < userAgentString.length; ++i)  \n        {  \n          if (CompareVersions(GetVersion(versionToCheck),   \n            GetVersion(userAgentString[i])) <= 0)  \n            return true;  \n        }  \n      }  \n  \n      return false;  \n    }  \n  \n    //  \n    // Extract the numeric part of the version string.  \n    //  \n    function GetVersion(versionString)  \n    {  \n      var numericString =   \n        versionString.match(/([0-9]+)\\.([0-9]+)\\.([0-9]+)/i);  \n      return numericString.slice(1);  \n    }  \n  \n    //  \n    // Compare the 2 version strings by converting them to numeric format.  \n    //  \n    function CompareVersions(version1, version2)  \n    {  \n      for (i = 0; i < version1.length; ++i)  \n      {  \n        var number1 = new Number(version1[i]);  \n        var number2 = new Number(version2[i]);  \n  \n        if (number1 < number2)  \n          return -1;  \n  \n        if (number1 > number2)  \n          return 1;  \n      }  \n  \n      return 0;  \n    }  \n  \n    -->  \n    </SCRIPT>  \n  </HEAD>  \n  \n  <BODY>  \n    <div id=\"result\" />  \n  </BODY>  \n</HTML>  \n```  \n  \n If the search for the \".NET CLR \" version is successful, the following type of status message appears:  \n  \n `This machine has the correct version of the .NET Framework 3.0: 3.0.04425.00`  \n  \n `This machine's userAgent string is: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; InfoPath.1; .NET CLR 2.0.50727; .NET CLR 3.0.04425.00).`  \n  \n Otherwise, the following type of status message appears:  \n  \n `This machine does not have correct version of the .NET Framework 3.0.`  \n  \n `This machine's userAgent string is: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; InfoPath.1; .NET CLR 2.0.50727).`\n","nodes":[{"pos":[4,276],"embed":true,"restype":"x-metadata","content":"title: \"How to: Detect Whether the .NET Framework 3.0 Is Installed\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"WinFX Runtime user-agent string\"\n  - \"presence of WPT [WPF], detecting\"\n  - \"detecting WPF presence [WPF]\"\nms.assetid: 7f71d652-1749-4379-945a-aa2e3994cb43","nodes":[{"content":"How to: Detect Whether the .NET Framework 3.0 Is Installed","nodes":[{"pos":[0,58],"content":"How to: Detect Whether the .NET Framework 3.0 Is Installed","nodes":[{"content":"How to: Detect Whether the .NET Framework 3.0 Is Installed","pos":[0,58]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[283,341],"content":"How to: Detect Whether the .NET Framework 3.0 Is Installed","linkify":"How to: Detect Whether the .NET Framework 3.0 Is Installed","nodes":[{"content":"How to: Detect Whether the .NET Framework 3.0 Is Installed","pos":[0,58]}]},{"content":"Before administrators can deploy Microsoft .NET Framework applications on a system, they must first confirm that the .NET Framework runtime is present.","pos":[342,493]},{"content":"This topic provides a script written in HTML/JavaScript that administrators can use to determine whether the .NET Framework is present on a system.","pos":[494,641]},{"pos":[649,878],"content":"[!NOTE]\n For more detailed information on installing, deploying, and detecting the Microsoft .NET Framework, see the discussion in [Deploying Microsoft .NET Framework Version 3.0](https://go.microsoft.com/fwlink/?LinkId=96739).","leadings":["","> "],"nodes":[{"content":"For more detailed information on installing, deploying, and detecting the Microsoft .NET Framework, see the discussion in <bpt id=\"p1\">[</bpt>Deploying Microsoft .NET Framework Version 3.0<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=96739)</ept>.","pos":[9,227],"source":"For more detailed information on installing, deploying, and detecting the Microsoft .NET Framework, see the discussion in [Deploying Microsoft .NET Framework Version 3.0](https://go.microsoft.com/fwlink/?LinkId=96739)."}]},{"pos":[924,963],"content":"Detect the \".NET CLR\" User-Agent String","linkify":"Detect the \".NET CLR\" User-Agent String","nodes":[{"content":"Detect the \".NET CLR\" User-Agent String","pos":[0,39]}]},{"content":"When .NET Framework is installed, the MSI adds \".NET CLR\" and the version number to the UserAgent string.","pos":[967,1072]},{"content":"The following example shows a script embedded in a simple HTML page.","pos":[1073,1141]},{"content":"The script searches the UserAgent string to determine whether .NET Framework is installed, and displays a status message on the results of the search.","pos":[1142,1292]},{"content":"If the search for the \".NET CLR \" version is successful, the following type of status message appears:","pos":[3535,3637]},{"content":"Otherwise, the following type of status message appears:","pos":[3899,3955]}]}