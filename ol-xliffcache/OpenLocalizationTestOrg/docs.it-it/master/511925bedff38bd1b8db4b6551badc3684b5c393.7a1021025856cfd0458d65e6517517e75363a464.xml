{"content":"---\ntitle: \"How to: Create a Custom Tracking Participant | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 1b612c7e-2381-4a7c-b07a-77030415f2a3\ncaps.latest.revision: 6\nauthor: \"Erikre\"\nms.author: \"erikre\"\nmanager: \"erikre\"\n---\n# How to: Create a Custom Tracking Participant\nWorkflow tracking provides visibility into the status of workflow execution. The workflow runtime emits tracking records that describe workflow lifecycle events, activity lifecycle events, bookmark resumptions, and faults. These tracking records are consumed by tracking participants. [!INCLUDE[wf](../../../includes/wf-md.md)] includes a standard tracking participant that writes tracking records as Event Tracing for Windows (ETW) events. If that does not meet your requirements, you can also write a custom tracking participant. This tutorial step describes how to create a custom tracking participant and tracking profile that capture the output of `WriteLine` activities so that they can be displayed to the user.  \n  \n> [!NOTE]\n>  Each topic in the Getting Started tutorial depends on the previous topics. To complete this topic, you must first complete the previous topics. To download a completed version or view a video walkthrough of the tutorial, see [Windows Workflow Foundation (WF45) - Getting Started Tutorial](http://go.microsoft.com/fwlink/?LinkID=248976).  \n  \n## In this topic  \n  \n-   [To create the custom tracking participant](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_CustomTrackingParticipant)  \n  \n-   [To create the tracking profile and register the tracking participant](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_TrackingProfile)  \n  \n-   [To display the tracking information](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_DisplayTracking)  \n  \n-   [To build and run the application](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_BuildAndRun)  \n  \n###  <a name=\"BKMK_CustomTrackingParticipant\"></a> To create the custom tracking participant  \n  \n1.  Right-click **NumberGuessWorkflowHost** in **Solution Explorer** and choose **Add**, **Class**. Type `StatusTrackingParticipant` into the **Name** box, and click **Add**.  \n  \n2.  Add the following `using` (or `Imports`) statements at the top of the file with the other `using` (or `Imports`) statements.  \n  \n    ```vb  \n    Imports System.Activities.Tracking  \n    Imports System.IO  \n    ```  \n  \n    ```csharp  \n    using System.Activities.Tracking;  \n    using System.IO;  \n    ```  \n  \n3.  Modify the `StatusTrackingParticipant` class so that it inherits from `TrackingParticipant`.  \n  \n    ```vb  \n    Public Class StatusTrackingParticipant  \n        Inherits TrackingParticipant  \n  \n    End Class  \n    ```  \n  \n    ```csharp  \n    class StatusTrackingParticipant : TrackingParticipant  \n    {  \n    }  \n    ```  \n  \n4.  Add the following `Track` method override. There are several different types of tracking records. We are interested in the output of `WriteLine` activities, which are contained in activity tracking records. If the `TrackingRecord` is an `ActivityTrackingRecord` for a `WriteLine` activity, the `Text` of the `WriteLine` is appended to a file named after the `InstanceId` of the workflow. In this tutorial, the file is saved to the current folder of the host application.  \n  \n    ```vb  \n    Protected Overrides Sub Track(record As TrackingRecord, timeout As TimeSpan)  \n        Dim asr As ActivityStateRecord = TryCast(record, ActivityStateRecord)  \n  \n        If Not asr Is Nothing Then  \n            If asr.State = ActivityStates.Executing And _  \n            asr.Activity.TypeName = \"System.Activities.Statements.WriteLine\" Then  \n  \n                'Append the WriteLine output to the tracking  \n                'file for this instance.  \n                Using writer As StreamWriter = File.AppendText(record.InstanceId.ToString())  \n                    writer.WriteLine(asr.Arguments(\"Text\"))  \n                    writer.Close()  \n                End Using  \n            End If  \n        End If  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    protected override void Track(TrackingRecord record, TimeSpan timeout)  \n    {  \n        ActivityStateRecord asr = record as ActivityStateRecord;  \n  \n        if (asr != null)  \n        {  \n            if (asr.State == ActivityStates.Executing &&  \n                asr.Activity.TypeName == \"System.Activities.Statements.WriteLine\")  \n            {  \n                // Append the WriteLine output to the tracking  \n                // file for this instance  \n                using (StreamWriter writer = File.AppendText(record.InstanceId.ToString()))  \n                {  \n                    writer.WriteLine(asr.Arguments[\"Text\"]);  \n                    writer.Close();  \n                }  \n            }  \n        }  \n    }  \n    ```  \n  \n     When no tracking profile is specified, the default tracking profile is used. When the default tracking profile is used, tracking records are emitted for all `ActivityStates`. Because we only need to capture the text one time during the lifecycle of the `WriteLine` activity, we only extract the text from the `ActivityStates.Executing` state. In [To create the tracking profile and register the tracking participant](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_TrackingProfile), a tracking profile is created that specifies that only `WriteLine` `ActivityStates.Executing` tracking records are emitted.  \n  \n###  <a name=\"BKMK_TrackingProfile\"></a> To create the tracking profile and register the tracking participant  \n  \n1.  Right-click **WorkflowHostForm** in **Solution Explorer** and choose **View Code**.  \n  \n2.  Add the following `using` (or `Imports`) statement at the top of the file with the other `using` (or `Imports`) statements.  \n  \n    ```vb  \n    Imports System.Activities.Tracking  \n    ```  \n  \n    ```csharp  \n    using System.Activities.Tracking;  \n    ```  \n  \n3.  Add the following code to `ConfigureWorkflowApplication` just after the code that adds the `StringWriter` to the workflow extensions and before the workflow lifecycle handlers.  \n  \n    ```vb  \n    'Add the custom tracking participant with a tracking profile  \n    'that only emits tracking records for WriteLine activities.  \n    Dim query As New ActivityStateQuery()  \n    query.ActivityName = \"WriteLine\"  \n    query.States.Add(ActivityStates.Executing)  \n    query.Arguments.Add(\"Text\")  \n  \n    Dim profile As New TrackingProfile()  \n    profile.Queries.Add(query)  \n  \n    Dim stp As New StatusTrackingParticipant()  \n    stp.TrackingProfile = profile  \n  \n    wfApp.Extensions.Add(stp)  \n    ```  \n  \n    ```csharp  \n    // Add the custom tracking participant with a tracking profile  \n    // that only emits tracking records for WriteLine activities.  \n    StatusTrackingParticipant stp = new StatusTrackingParticipant  \n    {  \n        TrackingProfile = new TrackingProfile  \n        {  \n            Queries =   \n            {  \n                new ActivityStateQuery  \n                {  \n                    ActivityName = \"WriteLine\",  \n                    States = { ActivityStates.Executing },  \n                    Arguments = { \"Text\" }  \n                }  \n            }  \n        }  \n    };  \n  \n    wfApp.Extensions.Add(stp);  \n    ```  \n  \n     This tracking profile specifies that only activity state records for `WriteLine` activities in the `Executing` state are emitted to the custom tracking participant.  \n  \n     After adding the code, the start of `ConfigureWorkflowApplication` will look like the following example.  \n  \n    ```vb  \n    Private Sub ConfigureWorkflowApplication(wfApp As WorkflowApplication)  \n        'Configure the persistence store.  \n        wfApp.InstanceStore = store  \n  \n        'Add a StringWriter to the extensions. This captures the output  \n        'from the WriteLine activities so we can display it in the form.  \n        Dim sw As New StringWriter()  \n        wfApp.Extensions.Add(sw)  \n  \n        'Add the custom tracking participant with a tracking profile  \n        'that only emits tracking records for WriteLine activities.  \n        Dim query As New ActivityStateQuery()  \n        query.ActivityName = \"WriteLine\"  \n        query.States.Add(ActivityStates.Executing)  \n        query.Arguments.Add(\"Text\")  \n  \n        Dim profile As New TrackingProfile()  \n        profile.Queries.Add(query)  \n  \n        Dim stp As New StatusTrackingParticipant()  \n        stp.TrackingProfile = profile  \n  \n        wfApp.Extensions.Add(stp)  \n  \n        'Workflow lifecycle handlers...  \n    ```  \n  \n    ```csharp  \n    private void ConfigureWorkflowApplication(WorkflowApplication wfApp)  \n    {  \n        // Configure the persistence store.  \n        wfApp.InstanceStore = store;  \n  \n        // Add a StringWriter to the extensions. This captures the output  \n        // from the WriteLine activities so we can display it in the form.  \n        StringWriter sw = new StringWriter();  \n        wfApp.Extensions.Add(sw);  \n  \n        // Add the custom tracking participant with a tracking profile  \n        // that only emits tracking records for WriteLine activities.  \n        StatusTrackingParticipant stp = new StatusTrackingParticipant  \n        {  \n            TrackingProfile = new TrackingProfile  \n            {  \n                Queries =   \n                {  \n                    new ActivityStateQuery  \n                    {  \n                        ActivityName = \"WriteLine\",  \n                        States = { ActivityStates.Executing },  \n                        Arguments = { \"Text\" }  \n                    }  \n                }  \n            }  \n        };  \n  \n        wfApp.Extensions.Add(stp);  \n  \n        // Workflow lifecycle handlers...  \n    ```  \n  \n###  <a name=\"BKMK_DisplayTracking\"></a> To display the tracking information  \n  \n1.  Right-click **WorkflowHostForm** in **Solution Explorer** and choose **View Code**.  \n  \n2.  In the `InstanceId_SelectedIndexChanged` handler, add the following code immediately after the code that clears the status window.  \n  \n    ```vb  \n    'If there is tracking data for this workflow, display it  \n    'in the status window.  \n    If File.Exists(WorkflowInstanceId.ToString()) Then  \n        Dim status As String = File.ReadAllText(WorkflowInstanceId.ToString())  \n        UpdateStatus(status)  \n    End If  \n    ```  \n  \n    ```csharp  \n    // If there is tracking data for this workflow, display it  \n    // in the status window.  \n    if (File.Exists(WorkflowInstanceId.ToString()))  \n    {  \n        string status = File.ReadAllText(WorkflowInstanceId.ToString());  \n        UpdateStatus(status);  \n    }  \n    ```  \n  \n     When a new workflow is selected in the workflow list, the tracking records for that workflow are loaded and displayed in the status window. The following example is the completed `InstanceId_SelectedIndexChanged` handler.  \n  \n    ```vb  \n    Private Sub InstanceId_SelectedIndexChanged(sender As Object, e As EventArgs) Handles InstanceId.SelectedIndexChanged  \n        If InstanceId.SelectedIndex = -1 Then  \n            Return  \n        End If  \n  \n        'Clear the status window.  \n        WorkflowStatus.Clear()  \n  \n        'If there is tracking data for this workflow, display it  \n        'in the status window.  \n        If File.Exists(WorkflowInstanceId.ToString()) Then  \n            Dim status As String = File.ReadAllText(WorkflowInstanceId.ToString())  \n            UpdateStatus(status)  \n        End If  \n  \n        'Get the workflow version and display it.  \n        'If the workflow is just starting then this info will not  \n        'be available in the persistence store so do not try and retrieve it.  \n        If Not WorkflowStarting Then  \n            Dim instance As WorkflowApplicationInstance = _  \n                WorkflowApplication.GetInstance(WorkflowInstanceId, store)  \n  \n            WorkflowVersion.Text = _  \n                WorkflowVersionMap.GetIdentityDescription(instance.DefinitionIdentity)  \n  \n            'Unload the instance.  \n            instance.Abandon()  \n        End If  \n    End Sub  \n    ```  \n  \n    ```csharp  \n    private void InstanceId_SelectedIndexChanged(object sender, EventArgs e)  \n    {  \n        if (InstanceId.SelectedIndex == -1)  \n        {  \n            return;  \n        }  \n  \n        // Clear the status window.  \n        WorkflowStatus.Clear();  \n  \n        // If there is tracking data for this workflow, display it  \n        // in the status window.  \n        if (File.Exists(WorkflowInstanceId.ToString()))  \n        {  \n            string status = File.ReadAllText(WorkflowInstanceId.ToString());  \n            UpdateStatus(status);  \n        }  \n  \n        // Get the workflow version and display it.  \n        // If the workflow is just starting then this info will not  \n        // be available in the persistence store so do not try and retrieve it.  \n        if (!WorkflowStarting)  \n        {  \n            WorkflowApplicationInstance instance =  \n                WorkflowApplication.GetInstance(this.WorkflowInstanceId, store);  \n  \n            WorkflowVersion.Text =  \n                WorkflowVersionMap.GetIdentityDescription(instance.DefinitionIdentity);  \n  \n            // Unload the instance.  \n            instance.Abandon();  \n        }  \n    }  \n    ```  \n  \n###  <a name=\"BKMK_BuildAndRun\"></a> To build and run the application  \n  \n1.  Press Ctrl+Shift+B to build the application.  \n  \n2.  Press Ctrl+F5 to start the application.  \n  \n3.  Select a range for the guessing game and the type of workflow to start, and click **New Game**. Enter a guess in the **Guess** box and click **Go** to submit your guess. Note that the status of the workflow is displayed in the status window. This output is captured from the `WriteLine` activities. Switch to a different workflow by selecting one from the **Workflow Instance Id** combo box and note that the status of the current workflow is removed. Switch back to the previous workflow and note that the status is restored, similar to the following example.  \n  \n    > [!NOTE]\n    >  If you switch to a workflow that was started before tracking was enabled no status is displayed. However if you make additional guesses, their status is saved because tracking is now enabled.  \n  \n **Please enter a number between 1 and 10**   \n**Your guess is too high.**   \n**Please enter a number between 1 and 10**    \n    > [!NOTE]\n    >  This information is useful for determining the range of the random number, but it does not contain any information about what guesses have been previously made. This information is in the next step, [How to: Host Multiple Versions of a Workflow Side-by-Side](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md).  \n  \n     Make a note of the workflow instance id, and play the game through to its completion.  \n  \n4.  Open Windows Explorer and navigate to the **NumberGuessWorkflowHost\\bin\\debug** folder (or **bin\\release** depending on your project settings). Note that in addition to the project executable files there are files with guid filenames. Identify the one that corresponds to the workflow instance id from the completed workflow in the previous step and open it in Notepad. The tracking information contains information similar to the following.  \n  \n **Please enter a number between 1 and 10**   \n**Your guess is too high.**   \n**Please enter a number between 1 and 10**   \n**Your guess is too high.**   \n**Please enter a number between 1 and 10**      In addition to the absence of the user's guesses, this tracking data does not contain information about the final guess of the workflow. That is because the tracking information consists only of the `WriteLine` output from the workflow, and the final message that is displayed is done so from the `Completed` handler after the workflow completes. In next step of the tutorial, [How to: Host Multiple Versions of a Workflow Side-by-Side](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md), the existing `WriteLine` activities are modified to display the user's guesses, and an additional `WriteLine` activity is added that displays the final results. After these changes are integrated, [How to: Host Multiple Versions of a Workflow Side-by-Side](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md) demonstrates how to host multiple versions of a workflow at the same time.","nodes":[{"pos":[12,73],"content":"How to: Create a Custom Tracking Participant | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Create a Custom Tracking Participant | Microsoft Docs","pos":[0,61]}]},{"pos":[338,382],"content":"How to: Create a Custom Tracking Participant","linkify":"How to: Create a Custom Tracking Participant","nodes":[{"content":"How to: Create a Custom Tracking Participant","pos":[0,44]}]},{"content":"Workflow tracking provides visibility into the status of workflow execution.","pos":[383,459]},{"content":"The workflow runtime emits tracking records that describe workflow lifecycle events, activity lifecycle events, bookmark resumptions, and faults.","pos":[460,605]},{"content":"These tracking records are consumed by tracking participants.","pos":[606,667]},{"content":"<ph id=\"ph1\">[!INCLUDE[wf](../../../includes/wf-md.md)]</ph> includes a standard tracking participant that writes tracking records as Event Tracing for Windows (ETW) events.","pos":[668,823],"source":"[!INCLUDE[wf](../../../includes/wf-md.md)] includes a standard tracking participant that writes tracking records as Event Tracing for Windows (ETW) events."},{"content":"If that does not meet your requirements, you can also write a custom tracking participant.","pos":[824,914]},{"content":"This tutorial step describes how to create a custom tracking participant and tracking profile that capture the output of <ph id=\"ph1\">`WriteLine`</ph> activities so that they can be displayed to the user.","pos":[915,1101],"source":" This tutorial step describes how to create a custom tracking participant and tracking profile that capture the output of `WriteLine` activities so that they can be displayed to the user."},{"pos":[1109,1456],"content":"[!NOTE]\n Each topic in the Getting Started tutorial depends on the previous topics. To complete this topic, you must first complete the previous topics. To download a completed version or view a video walkthrough of the tutorial, see [Windows Workflow Foundation (WF45) - Getting Started Tutorial](http://go.microsoft.com/fwlink/?LinkID=248976).","leadings":["","> "],"nodes":[{"content":" Each topic in the Getting Started tutorial depends on the previous topics. To complete this topic, you must first complete the previous topics. To download a completed version or view a video walkthrough of the tutorial, see [Windows Workflow Foundation (WF45) - Getting Started Tutorial](http://go.microsoft.com/fwlink/?LinkID=248976).","pos":[8,345],"nodes":[{"content":"Each topic in the Getting Started tutorial depends on the previous topics.","pos":[1,75]},{"content":"To complete this topic, you must first complete the previous topics.","pos":[76,144]},{"content":"To download a completed version or view a video walkthrough of the tutorial, see <bpt id=\"p1\">[</bpt>Windows Workflow Foundation (WF45) - Getting Started Tutorial<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=248976)</ept>.","pos":[145,337],"source":" To download a completed version or view a video walkthrough of the tutorial, see [Windows Workflow Foundation (WF45) - Getting Started Tutorial](http://go.microsoft.com/fwlink/?LinkID=248976)."}]}]},{"pos":[1465,1478],"content":"In this topic","linkify":"In this topic","nodes":[{"content":"In this topic","pos":[0,13]}]},{"pos":[1488,1662],"content":"<bpt id=\"p1\">[</bpt>To create the custom tracking participant<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_CustomTrackingParticipant)</ept>","source":"[To create the custom tracking participant](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_CustomTrackingParticipant)"},{"pos":[1672,1863],"content":"<bpt id=\"p1\">[</bpt>To create the tracking profile and register the tracking participant<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_TrackingProfile)</ept>","source":"[To create the tracking profile and register the tracking participant](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_TrackingProfile)"},{"pos":[1873,2031],"content":"<bpt id=\"p1\">[</bpt>To display the tracking information<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_DisplayTracking)</ept>","source":"[To display the tracking information](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_DisplayTracking)"},{"pos":[2041,2192],"content":"<bpt id=\"p1\">[</bpt>To build and run the application<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_BuildAndRun)</ept>","source":"[To build and run the application](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_BuildAndRun)"},{"pos":[2203,2290],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_CustomTrackingParticipant\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> To create the custom tracking participant","linkify":"<a name=\"BKMK_CustomTrackingParticipant\"></a> To create the custom tracking participant","source":"<a name=\"BKMK_CustomTrackingParticipant\"></a> To create the custom tracking participant"},{"content":"Right-click <bpt id=\"p1\">**</bpt>NumberGuessWorkflowHost<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and choose <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Class<ept id=\"p4\">**</ept>.","pos":[2300,2395],"source":"Right-click **NumberGuessWorkflowHost** in **Solution Explorer** and choose **Add**, **Class**."},{"content":"Type <ph id=\"ph1\">`StatusTrackingParticipant`</ph> into the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, and click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>.","pos":[2396,2470],"source":" Type `StatusTrackingParticipant` into the **Name** box, and click **Add**."},{"pos":[2480,2604],"content":"Add the following <ph id=\"ph1\">`using`</ph> (or <ph id=\"ph2\">`Imports`</ph>) statements at the top of the file with the other <ph id=\"ph3\">`using`</ph> (or <ph id=\"ph4\">`Imports`</ph>) statements.","source":"Add the following `using` (or `Imports`) statements at the top of the file with the other `using` (or `Imports`) statements."},{"pos":[2796,2888],"content":"Modify the <ph id=\"ph1\">`StatusTrackingParticipant`</ph> class so that it inherits from <ph id=\"ph2\">`TrackingParticipant`</ph>.","source":"Modify the `StatusTrackingParticipant` class so that it inherits from `TrackingParticipant`."},{"content":"Add the following <ph id=\"ph1\">`Track`</ph> method override.","pos":[3131,3173],"source":"Add the following `Track` method override."},{"content":"There are several different types of tracking records.","pos":[3174,3228]},{"content":"We are interested in the output of <ph id=\"ph1\">`WriteLine`</ph> activities, which are contained in activity tracking records.","pos":[3229,3337],"source":" We are interested in the output of `WriteLine` activities, which are contained in activity tracking records."},{"content":"If the <ph id=\"ph1\">`TrackingRecord`</ph> is an <ph id=\"ph2\">`ActivityTrackingRecord`</ph> for a <ph id=\"ph3\">`WriteLine`</ph> activity, the <ph id=\"ph4\">`Text`</ph> of the <ph id=\"ph5\">`WriteLine`</ph> is appended to a file named after the <ph id=\"ph6\">`InstanceId`</ph> of the workflow.","pos":[3338,3518],"source":" If the `TrackingRecord` is an `ActivityTrackingRecord` for a `WriteLine` activity, the `Text` of the `WriteLine` is appended to a file named after the `InstanceId` of the workflow."},{"content":"In this tutorial, the file is saved to the current folder of the host application.","pos":[3519,3601]},{"content":"When no tracking profile is specified, the default tracking profile is used.","pos":[5130,5206]},{"content":"When the default tracking profile is used, tracking records are emitted for all <ph id=\"ph1\">`ActivityStates`</ph>.","pos":[5207,5304],"source":" When the default tracking profile is used, tracking records are emitted for all `ActivityStates`."},{"content":"Because we only need to capture the text one time during the lifecycle of the <ph id=\"ph1\">`WriteLine`</ph> activity, we only extract the text from the <ph id=\"ph2\">`ActivityStates.Executing`</ph> state.","pos":[5305,5472],"source":" Because we only need to capture the text one time during the lifecycle of the `WriteLine` activity, we only extract the text from the `ActivityStates.Executing` state."},{"content":"In <bpt id=\"p1\">[</bpt>To create the tracking profile and register the tracking participant<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_TrackingProfile)</ept>, a tracking profile is created that specifies that only <ph id=\"ph1\">`WriteLine`</ph> <ph id=\"ph2\">`ActivityStates.Executing`</ph> tracking records are emitted.","pos":[5473,5792],"source":" In [To create the tracking profile and register the tracking participant](../../../docs/framework/windows-workflow-foundation/how-to-create-a-custom-tracking-participant.md#BKMK_TrackingProfile), a tracking profile is created that specifies that only `WriteLine` `ActivityStates.Executing` tracking records are emitted."},{"pos":[5803,5907],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_TrackingProfile\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> To create the tracking profile and register the tracking participant","linkify":"<a name=\"BKMK_TrackingProfile\"></a> To create the tracking profile and register the tracking participant","source":"<a name=\"BKMK_TrackingProfile\"></a> To create the tracking profile and register the tracking participant"},{"pos":[5917,6000],"content":"Right-click <bpt id=\"p1\">**</bpt>WorkflowHostForm<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and choose <bpt id=\"p3\">**</bpt>View Code<ept id=\"p3\">**</ept>.","source":"Right-click **WorkflowHostForm** in **Solution Explorer** and choose **View Code**."},{"pos":[6010,6133],"content":"Add the following <ph id=\"ph1\">`using`</ph> (or <ph id=\"ph2\">`Imports`</ph>) statement at the top of the file with the other <ph id=\"ph3\">`using`</ph> (or <ph id=\"ph4\">`Imports`</ph>) statements.","source":"Add the following `using` (or `Imports`) statement at the top of the file with the other `using` (or `Imports`) statements."},{"pos":[6278,6454],"content":"Add the following code to <ph id=\"ph1\">`ConfigureWorkflowApplication`</ph> just after the code that adds the <ph id=\"ph2\">`StringWriter`</ph> to the workflow extensions and before the workflow lifecycle handlers.","source":"Add the following code to `ConfigureWorkflowApplication` just after the code that adds the `StringWriter` to the workflow extensions and before the workflow lifecycle handlers."},{"pos":[7644,7808],"content":"This tracking profile specifies that only activity state records for <ph id=\"ph1\">`WriteLine`</ph> activities in the <ph id=\"ph2\">`Executing`</ph> state are emitted to the custom tracking participant.","source":"This tracking profile specifies that only activity state records for `WriteLine` activities in the `Executing` state are emitted to the custom tracking participant."},{"pos":[7819,7923],"content":"After adding the code, the start of <ph id=\"ph1\">`ConfigureWorkflowApplication`</ph> will look like the following example.","source":"After adding the code, the start of `ConfigureWorkflowApplication` will look like the following example."},{"pos":[10120,10191],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_DisplayTracking\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> To display the tracking information","linkify":"<a name=\"BKMK_DisplayTracking\"></a> To display the tracking information","source":"<a name=\"BKMK_DisplayTracking\"></a> To display the tracking information"},{"pos":[10201,10284],"content":"Right-click <bpt id=\"p1\">**</bpt>WorkflowHostForm<ept id=\"p1\">**</ept> in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept> and choose <bpt id=\"p3\">**</bpt>View Code<ept id=\"p3\">**</ept>.","source":"Right-click **WorkflowHostForm** in **Solution Explorer** and choose **View Code**."},{"pos":[10294,10424],"content":"In the <ph id=\"ph1\">`InstanceId_SelectedIndexChanged`</ph> handler, add the following code immediately after the code that clears the status window.","source":"In the `InstanceId_SelectedIndexChanged` handler, add the following code immediately after the code that clears the status window."},{"content":"When a new workflow is selected in the workflow list, the tracking records for that workflow are loaded and displayed in the status window.","pos":[11036,11175]},{"content":"The following example is the completed <ph id=\"ph1\">`InstanceId_SelectedIndexChanged`</ph> handler.","pos":[11176,11257],"source":" The following example is the completed `InstanceId_SelectedIndexChanged` handler."},{"pos":[13693,13757],"content":"<bpt id=\"p1\">&lt;a name=\"BKMK_BuildAndRun\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> To build and run the application","linkify":"<a name=\"BKMK_BuildAndRun\"></a> To build and run the application","source":"<a name=\"BKMK_BuildAndRun\"></a> To build and run the application"},{"content":"Press Ctrl+Shift+B to build the application.","pos":[13767,13811]},{"content":"Press Ctrl+F5 to start the application.","pos":[13821,13860]},{"content":"Select a range for the guessing game and the type of workflow to start, and click <bpt id=\"p1\">**</bpt>New Game<ept id=\"p1\">**</ept>.","pos":[13870,13965],"source":"Select a range for the guessing game and the type of workflow to start, and click **New Game**."},{"content":"Enter a guess in the <bpt id=\"p1\">**</bpt>Guess<ept id=\"p1\">**</ept> box and click <bpt id=\"p2\">**</bpt>Go<ept id=\"p2\">**</ept> to submit your guess.","pos":[13966,14039],"source":" Enter a guess in the **Guess** box and click **Go** to submit your guess."},{"content":"Note that the status of the workflow is displayed in the status window.","pos":[14040,14111]},{"content":"This output is captured from the <ph id=\"ph1\">`WriteLine`</ph> activities.","pos":[14112,14168],"source":" This output is captured from the `WriteLine` activities."},{"content":"Switch to a different workflow by selecting one from the <bpt id=\"p1\">**</bpt>Workflow Instance Id<ept id=\"p1\">**</ept> combo box and note that the status of the current workflow is removed.","pos":[14169,14321],"source":" Switch to a different workflow by selecting one from the **Workflow Instance Id** combo box and note that the status of the current workflow is removed."},{"content":"Switch back to the previous workflow and note that the status is restored, similar to the following example.","pos":[14322,14430]},{"pos":[14442,14648],"content":"[!NOTE]\nIf you switch to a workflow that was started before tracking was enabled no status is displayed. However if you make additional guesses, their status is saved because tracking is now enabled.","leadings":["","    >  "],"nodes":[{"content":"If you switch to a workflow that was started before tracking was enabled no status is displayed. However if you make additional guesses, their status is saved because tracking is now enabled.","pos":[8,199],"nodes":[{"content":"If you switch to a workflow that was started before tracking was enabled no status is displayed.","pos":[0,96]},{"content":"However if you make additional guesses, their status is saved because tracking is now enabled.","pos":[97,191]}]}]},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[14655,14698],"source":"**Please enter a number between 1 and 10** "},{"content":"<bpt id=\"p1\">**</bpt>Your guess is too high.<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[14701,14729],"source":"**Your guess is too high.** "},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept>","pos":[14732,14774],"source":"**Please enter a number between 1 and 10**"},{"pos":[14785,15172],"content":"[!NOTE]\nThis information is useful for determining the range of the random number, but it does not contain any information about what guesses have been previously made. This information is in the next step, [How to: Host Multiple Versions of a Workflow Side-by-Side](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md).","leadings":["","    >  "],"nodes":[{"content":"This information is useful for determining the range of the random number, but it does not contain any information about what guesses have been previously made. This information is in the next step, [How to: Host Multiple Versions of a Workflow Side-by-Side](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md).","pos":[8,380],"nodes":[{"content":"This information is useful for determining the range of the random number, but it does not contain any information about what guesses have been previously made.","pos":[0,160]},{"content":"This information is in the next step, <bpt id=\"p1\">[</bpt>How to: Host Multiple Versions of a Workflow Side-by-Side<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md)</ept>.","pos":[161,372],"source":" This information is in the next step, [How to: Host Multiple Versions of a Workflow Side-by-Side](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md)."}]}]},{"content":"Make a note of the workflow instance id, and play the game through to its completion.","pos":[15183,15268]},{"content":"Open Windows Explorer and navigate to the <bpt id=\"p1\">**</bpt>NumberGuessWorkflowHost\\bin\\debug<ept id=\"p1\">**</ept> folder (or <bpt id=\"p2\">**</bpt>bin\\release<ept id=\"p2\">**</ept> depending on your project settings).","pos":[15278,15421],"source":"Open Windows Explorer and navigate to the **NumberGuessWorkflowHost\\bin\\debug** folder (or **bin\\release** depending on your project settings)."},{"content":"Note that in addition to the project executable files there are files with guid filenames.","pos":[15422,15512]},{"content":"Identify the one that corresponds to the workflow instance id from the completed workflow in the previous step and open it in Notepad.","pos":[15513,15647]},{"content":"The tracking information contains information similar to the following.","pos":[15648,15719]},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[15726,15769],"source":"**Please enter a number between 1 and 10** "},{"content":"<bpt id=\"p1\">**</bpt>Your guess is too high.<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[15772,15800],"source":"**Your guess is too high.** "},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[15803,15846],"source":"**Please enter a number between 1 and 10** "},{"content":"<bpt id=\"p1\">**</bpt>Your guess is too high.<ept id=\"p1\">**</ept><ph id=\"ph1\"> </ph>","pos":[15849,15877],"source":"**Your guess is too high.** "},{"content":"<bpt id=\"p1\">**</bpt>Please enter a number between 1 and 10<ept id=\"p1\">**</ept>      In addition to the absence of the user's guesses, this tracking data does not contain information about the final guess of the workflow.","pos":[15880,16064],"source":"**Please enter a number between 1 and 10**      In addition to the absence of the user's guesses, this tracking data does not contain information about the final guess of the workflow."},{"content":"That is because the tracking information consists only of the <ph id=\"ph1\">`WriteLine`</ph> output from the workflow, and the final message that is displayed is done so from the <ph id=\"ph2\">`Completed`</ph> handler after the workflow completes.","pos":[16065,16274],"source":" That is because the tracking information consists only of the `WriteLine` output from the workflow, and the final message that is displayed is done so from the `Completed` handler after the workflow completes."},{"content":"In next step of the tutorial, <bpt id=\"p1\">[</bpt>How to: Host Multiple Versions of a Workflow Side-by-Side<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md)</ept>, the existing <ph id=\"ph1\">`WriteLine`</ph> activities are modified to display the user's guesses, and an additional <ph id=\"ph2\">`WriteLine`</ph> activity is added that displays the final results.","pos":[16275,16639],"source":" In next step of the tutorial, [How to: Host Multiple Versions of a Workflow Side-by-Side](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md), the existing `WriteLine` activities are modified to display the user's guesses, and an additional `WriteLine` activity is added that displays the final results."},{"content":"After these changes are integrated, <bpt id=\"p1\">[</bpt>How to: Host Multiple Versions of a Workflow Side-by-Side<ept id=\"p1\">](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md)</ept> demonstrates how to host multiple versions of a workflow at the same time.","pos":[16640,16923],"source":" After these changes are integrated, [How to: Host Multiple Versions of a Workflow Side-by-Side](../../../docs/framework/windows-workflow-foundation/how-to-host-multiple-versions-of-a-workflow-side-by-side.md) demonstrates how to host multiple versions of a workflow at the same time."}]}