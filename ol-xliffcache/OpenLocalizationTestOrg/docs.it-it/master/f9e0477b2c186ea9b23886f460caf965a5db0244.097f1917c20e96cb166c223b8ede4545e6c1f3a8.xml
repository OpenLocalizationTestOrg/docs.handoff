{"content":"---\ntitle: \"Walkthrough: Hosting a Windows Forms Composite Control in WPF\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"hosting Windows Forms control in WPF [WPF]\"\n  - \"composite controls [WPF], hosting in WPF\"\nms.assetid: 96fcd78d-1c77-4206-8928-3a0579476ef4\n---\n# Walkthrough: Hosting a Windows Forms Composite Control in WPF\n[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides a rich environment for creating applications. However, when you have a substantial investment in [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] code, it can be more effective to reuse at least some of that code in your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application rather than to rewrite it from scratch. The most common scenario is when you have existing Windows Forms controls. In some cases, you might not even have access to the source code for these controls. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a straightforward procedure for hosting such controls in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application. For example, you can use [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] for most of your programming while hosting your specialized <xref:System.Windows.Forms.DataGridView> controls.  \n  \n This walkthrough steps you through an application that hosts a Windows Forms composite control to perform data entry in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application. The composite control is packaged in a DLL. This general procedure can be extended to more complex applications and controls. This walkthrough is designed to be nearly identical in appearance and functionality to [Walkthrough: Hosting a WPF Composite Control in Windows Forms](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md). The primary difference is that the hosting scenario is reversed.  \n  \n The walkthrough is divided into two sections. The first section briefly describes the implementation of the Windows Forms composite control. The second section discusses in detail how to host the composite control in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application, receive events from the control, and access some of the control's properties.  \n  \n Tasks illustrated in this walkthrough include:  \n  \n-   Implementing the Windows Forms composite control.  \n  \n-   Implementing the WPF host application.  \n  \n For a complete code listing of the tasks illustrated in this walkthrough, see [Hosting a Windows Forms Composite Control in WPF Sample](https://go.microsoft.com/fwlink/?LinkID=159999).  \n  \n## Prerequisites  \n\nYou need Visual Studio to complete this walkthrough.\n  \n## Implementing the Windows Forms Composite Control  \n The Windows Forms composite control used in this example is a simple data-entry form. This form takes the user's name and address and then uses a custom event to return that information to the host. The following illustration shows the rendered control.  \n\n The following image shows a Windows Forms composite control:  \n\n ![Screenshot that shows a simple Windows Forms control.](./media/walkthrough-hosting-a-windows-forms-composite-control-in-wpf/windows-forms-control.gif)  \n  \n### Creating the Project  \n To start the project:  \n  \n1.  Launch [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)], and open the **New Project** dialog box.  \n  \n2.  In the Window category, select the **Windows Forms Control Library** template.  \n  \n3.  Name the new project `MyControls`.  \n  \n4.  For the location, specify a conveniently named top-level folder, such as `WpfHostingWindowsFormsControl`. Later, you will put the host application in this folder.  \n  \n5.  Click **OK** to create the project. The default project contains a single control named `UserControl1`.  \n  \n6.  In Solution Explorer, rename `UserControl1` to `MyControl1`.  \n  \n Your project should have references to the following system DLLs. If any of these DLLs are not included by default, add them to the project.  \n  \n-   System  \n  \n-   System.Data  \n  \n-   System.Drawing  \n  \n-   System.Windows.Forms  \n  \n-   System.Xml  \n  \n### Adding Controls to the Form  \n To add controls to the form:  \n  \n-   Open `MyControl1` in the designer.  \n  \n Add five <xref:System.Windows.Forms.Label> controls and their corresponding <xref:System.Windows.Forms.TextBox> controls, sized and arranged as they are in the preceding illustration, on the form. In the example, the <xref:System.Windows.Forms.TextBox> controls are named:  \n  \n-   `txtName`  \n  \n-   `txtAddress`  \n  \n-   `txtCity`  \n  \n-   `txtState`  \n  \n-   `txtZip`  \n  \n Add two <xref:System.Windows.Forms.Button> controls labeled **OK** and **Cancel**. In the example, the button names are `btnOK` and `btnCancel`, respectively.  \n  \n### Implementing the Supporting Code  \n Open the form in code view. The control returns the collected data to its host by raising the custom `OnButtonClick` event. The data is contained in the event argument object. The following code shows the event and delegate declaration.  \n  \n Add the following code to the `MyControl1` class.  \n  \n [!code-csharp[WpfHostingWindowsFormsControl#2](~/samples/snippets/csharp/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/CSharp/MyControls/MyControl1.cs#2)]\n [!code-vb[WpfHostingWindowsFormsControl#2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/VisualBasic/MyControls/MyControl1.vb#2)]\n\n The `MyControlEventArgs` class contains the information to be returned to the host.\n\n Add the following class to the form.\n\n [!code-csharp[WpfHostingWindowsFormsControl#3](~/samples/snippets/csharp/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/CSharp/MyControls/MyControl1.cs#3)]\n [!code-vb[WpfHostingWindowsFormsControl#3](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/VisualBasic/MyControls/MyControl1.vb#3)]\n\n When the user clicks the **OK** or **Cancel** button, the <xref:System.Windows.Forms.Control.Click> event handlers create a `MyControlEventArgs` object that contains the data and raises the `OnButtonClick` event. The only difference between the two handlers is the event argument's `IsOK` property. This property enables the host to determine which button was clicked. It is set to `true` for the **OK** button, and `false` for the **Cancel** button. The following code shows the two button handlers.\n\n Add the following code to the `MyControl1` class.\n\n [!code-csharp[WpfHostingWindowsFormsControl#4](~/samples/snippets/csharp/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/CSharp/MyControls/MyControl1.cs#4)]\n [!code-vb[WpfHostingWindowsFormsControl#4](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/VisualBasic/MyControls/MyControl1.vb#4)]\n\n### Giving the Assembly a Strong Name and Building the Assembly\n For this assembly to be referenced by a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application, it must have a strong name. To create a strong name, create a key file with Sn.exe and add it to your project.\n\n1.  Open a [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] command prompt. To do so, click the **Start** menu, and then select **All Programs/Microsoft Visual Studio 2010/Visual Studio Tools/Visual Studio Command Prompt**. This launches a console window with customized environment variables.\n\n2.  At the command prompt, use the `cd` command to go to your project folder.\n\n3.  Generate a key file named MyControls.snk by running the following command.\n\n    ```\n    Sn.exe -k MyControls.snk\n    ```\n\n4.  To include the key file in your project, right-click the project name in Solution Explorer and then click **Properties**. In the Project Designer, click the **Signing** tab, select the **Sign the assembly** check box and then browse to your key file.\n\n5.  Build the solution. The build will produce a DLL named MyControls.dll.\n\n## Implementing the WPF Host Application\n The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] host application uses the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control to host `MyControl1`. The application handles the `OnButtonClick` event to receive the data from the control. It also has a collection of option buttons that enable you to change some of the control's properties from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application. The following illustration shows the finished application.\n\nThe following image shows the complete application, including the control embedded in the WPF application:\n\n ![Screenshot that shows a control embedded in a WPF page.](./media/walkthrough-hosting-a-windows-forms-composite-control-in-wpf/windows-presentation-foundation-page-control.gif)\n\n### Creating the Project\n To start the project:\n\n1.  Open [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], and select **New Project**.\n\n2.  In the Window category, select the **WPF Application** template.\n\n3.  Name the new project `WpfHost`.\n\n4.  For the location, specify the same top-level folder that contains the MyControls project.\n\n5.  Click **OK** to create the project.\n\n You also need to add references to the DLL that contains `MyControl1` and other assemblies.\n\n1.  Right-click the project name in Solution Explorer and select **Add Reference**.\n\n2.  Click the **Browse** tab, and browse to the folder that contains MyControls.dll. For this walkthrough, this folder is MyControls\\bin\\Debug.\n\n3.  Select MyControls.dll, and then click **OK**.\n\n4.  Add a reference to the WindowsFormsIntegration assembly, which is named WindowsFormsIntegration.dll.\n\n### Implementing the Basic Layout\n The [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] of the host application is implemented in MainWindow.xaml. This file contains [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] markup that defines the layout, and hosts the Windows Forms control. The application is divided into three regions:\n\n-   The **Control Properties** panel, which contains a collection of option buttons that you can use to modify various properties of the hosted control.\n\n-   The **Data from Control** panel, which contains several <xref:System.Windows.Controls.TextBlock> elements that display the data returned from the hosted control.\n\n-   The hosted control itself.\n\n The basic layout is shown in the following XAML. The markup that is needed to host `MyControl1` is omitted from this example, but will be discussed later.\n\n Replace the XAML in MainWindow.xaml with the following. If you are using Visual Basic, change the class to `x:Class=\"MainWindow\"`.\n\n [!code-xaml[WpfHostingWindowsFormsControl#100](~/samples/snippets/csharp/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/CSharp/WpfHost/Page1.xaml#100)]\n\n The first <xref:System.Windows.Controls.StackPanel> element contains several sets of <xref:System.Windows.Controls.RadioButton> controls that enable you to modify various default properties of the hosted control. That is followed by a <xref:System.Windows.Forms.Integration.WindowsFormsHost> element, which hosts `MyControl1`. The final <xref:System.Windows.Controls.StackPanel> element contains several <xref:System.Windows.Controls.TextBlock> elements that display the data that is returned by the hosted control. The ordering of the elements and the <xref:System.Windows.Controls.DockPanel.Dock%2A> and <xref:System.Windows.FrameworkElement.Height%2A> attribute settings embed the hosted control into the window with no gaps or distortion.\n\n#### Hosting the Control\n The following edited version of the previous XAML focuses on the elements that are needed to host `MyControl1`.\n\n [!code-xaml[WpfHostingWindowsFormsControl#101](~/samples/snippets/csharp/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/CSharp/WpfHost/Page1.xaml#101)]\n[!code-xaml[WpfHostingWindowsFormsControl#102](~/samples/snippets/csharp/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/CSharp/WpfHost/Page1.xaml#102)]\n\n The `xmlns` namespace mapping attribute creates a reference to the `MyControls` namespace that contains the hosted control. This mapping enables you to represent `MyControl1` in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] as `<mcl:MyControl1>`.\n\n Two elements in the XAML handle the hosting:\n\n-   `WindowsFormsHost` represents the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element that enables you to host a Windows Forms control in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application.\n\n-   `mcl:MyControl1`, which represents `MyControl1`, is added to the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element's child collection. As a result, this Windows Forms control is rendered as part of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] window, and you can communicate with the control from the application.\n\n### Implementing the Code-Behind File\n The code-behind file, MainWindow.xaml.vb or MainWindow.xaml.cs, contains the procedural code that implements the functionality of the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] discussed in the preceding section. The primary tasks are:\n\n-   Attaching an event handler to `MyControl1`'s `OnButtonClick` event.\n\n-   Modifying various properties of `MyControl1`, based on how the collection of option buttons are set.\n\n-   Displaying the data collected by the control.\n\n#### Initializing the Application\n The initialization code is contained in an event handler for the window's <xref:System.Windows.FrameworkElement.Loaded> event and attaches an event handler to the control's `OnButtonClick` event.\n\n In MainWindow.xaml.vb or MainWindow.xaml.cs, add the following code to the `MainWindow` class.\n\n [!code-csharp[WpfHostingWindowsFormsControl#11](~/samples/snippets/csharp/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/CSharp/WpfHost/Page1.xaml.cs#11)]\n [!code-vb[WpfHostingWindowsFormsControl#11](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/VisualBasic/WpfHost/Page1.xaml.vb#11)]\n\n Because the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] discussed previously added `MyControl1` to the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element's child element collection, you can cast the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element's <xref:System.Windows.Forms.Integration.WindowsFormsHost.Child%2A> to get the reference to `MyControl1`. You can then use that reference to attach an event handler to `OnButtonClick`.\n\n In addition to providing a reference to the control itself, <xref:System.Windows.Forms.Integration.WindowsFormsHost> exposes a number of the control's properties, which you can manipulate from the application. The initialization code assigns those values to private global variables for later use in the application.\n\n So that you can easily access the types in the `MyControls` DLL, add the following `Imports` or `using` statement to the top of the file.\n\n```vb\nImports MyControls\n```\n\n```csharp\nusing MyControls;\n```\n\n#### Handling the OnButtonClick Event\n `MyControl1` raises the `OnButtonClick` event when the user clicks either of the control's buttons.\n\n Add the following code to the `MainWindow` class.\n\n [!code-csharp[WpfHostingWindowsFormsControl#12](~/samples/snippets/csharp/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/CSharp/WpfHost/Page1.xaml.cs#12)]\n [!code-vb[WpfHostingWindowsFormsControl#12](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/VisualBasic/WpfHost/Page1.xaml.vb#12)]\n\n The data in the text boxes is packed into the `MyControlEventArgs` object. If the user clicks the **OK** button, the event handler extracts the data and displays it in the panel below `MyControl1`.\n\n#### Modifying the Control’s Properties\n The <xref:System.Windows.Forms.Integration.WindowsFormsHost> element exposes several of the hosted control's default properties. As a result, you can change the appearance of the control to match the style of your application more closely. The sets of option buttons in the left panel enable the user to modify several color and font properties. Each set of buttons has a handler for the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event, which detects the user's option button selections and changes the corresponding property on the control.\n\n Add the following code to the `MainWindow` class.\n\n [!code-csharp[WpfHostingWindowsFormsControl#13](~/samples/snippets/csharp/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/CSharp/WpfHost/Page1.xaml.cs#13)]\n [!code-vb[WpfHostingWindowsFormsControl#13](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WpfHostingWindowsFormsControl/VisualBasic/WpfHost/Page1.xaml.vb#13)]  \n  \n Build and run the application. Add some text in the Windows Forms composite control and then click **OK**. The text appears in the labels. Click the different radio buttons to see the effect on the control.  \n  \n## See also\n\n- <xref:System.Windows.Forms.Integration.ElementHost>\n- <xref:System.Windows.Forms.Integration.WindowsFormsHost>\n- [Design XAML in Visual Studio](/visualstudio/designers/designing-xaml-in-visual-studio)\n- [Walkthrough: Hosting a Windows Forms Control in WPF](walkthrough-hosting-a-windows-forms-control-in-wpf.md)\n- [Walkthrough: Hosting a WPF Composite Control in Windows Forms](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)\n","nodes":[{"pos":[4,295],"embed":true,"restype":"x-metadata","content":"title: \"Walkthrough: Hosting a Windows Forms Composite Control in WPF\"\nms.date: \"03/30/2017\"\ndev_langs:\n  - \"csharp\"\n  - \"vb\"\nhelpviewer_keywords:\n  - \"hosting Windows Forms control in WPF [WPF]\"\n  - \"composite controls [WPF], hosting in WPF\"\nms.assetid: 96fcd78d-1c77-4206-8928-3a0579476ef4","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Composite Control in WPF","nodes":[{"pos":[0,61],"content":"Walkthrough: Hosting a Windows Forms Composite Control in WPF","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Composite Control in WPF","pos":[0,61]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[302,363],"content":"Walkthrough: Hosting a Windows Forms Composite Control in WPF","linkify":"Walkthrough: Hosting a Windows Forms Composite Control in WPF","nodes":[{"content":"Walkthrough: Hosting a Windows Forms Composite Control in WPF","pos":[0,61]}]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]</ph> provides a rich environment for creating applications.","pos":[364,498],"source":"[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides a rich environment for creating applications."},{"content":"However, when you have a substantial investment in <ph id=\"ph1\">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]</ph> code, it can be more effective to reuse at least some of that code in your <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> application rather than to rewrite it from scratch.","pos":[499,836],"source":" However, when you have a substantial investment in [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] code, it can be more effective to reuse at least some of that code in your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application rather than to rewrite it from scratch."},{"content":"The most common scenario is when you have existing Windows Forms controls.","pos":[837,911]},{"content":"In some cases, you might not even have access to the source code for these controls.","pos":[912,996]},{"content":"<ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> provides a straightforward procedure for hosting such controls in a <ph id=\"ph2\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> application.","pos":[997,1241],"source":"[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a straightforward procedure for hosting such controls in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application."},{"content":"For example, you can use <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> for most of your programming while hosting your specialized <ph id=\"ph2\">&lt;xref:System.Windows.Forms.DataGridView&gt;</ph> controls.","pos":[1242,1459],"source":" For example, you can use [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] for most of your programming while hosting your specialized <xref:System.Windows.Forms.DataGridView> controls."},{"content":"This walkthrough steps you through an application that hosts a Windows Forms composite control to perform data entry in a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> application.","pos":[1466,1682],"source":"This walkthrough steps you through an application that hosts a Windows Forms composite control to perform data entry in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application."},{"content":"The composite control is packaged in a DLL.","pos":[1683,1726]},{"content":"This general procedure can be extended to more complex applications and controls.","pos":[1727,1808]},{"content":"This walkthrough is designed to be nearly identical in appearance and functionality to <bpt id=\"p1\">[</bpt>Walkthrough: Hosting a WPF Composite Control in Windows Forms<ept id=\"p1\">](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)</ept>.","pos":[1809,2025],"source":" This walkthrough is designed to be nearly identical in appearance and functionality to [Walkthrough: Hosting a WPF Composite Control in Windows Forms](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)."},{"content":"The primary difference is that the hosting scenario is reversed.","pos":[2026,2090]},{"content":"The walkthrough is divided into two sections.","pos":[2097,2142]},{"content":"The first section briefly describes the implementation of the Windows Forms composite control.","pos":[2143,2237]},{"content":"The second section discusses in detail how to host the composite control in a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> application, receive events from the control, and access some of the control's properties.","pos":[2238,2488],"source":" The second section discusses in detail how to host the composite control in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application, receive events from the control, and access some of the control's properties."},{"content":"Tasks illustrated in this walkthrough include:","pos":[2495,2541]},{"content":"Implementing the Windows Forms composite control.","pos":[2551,2600]},{"content":"Implementing the WPF host application.","pos":[2610,2648]},{"pos":[2655,2839],"content":"For a complete code listing of the tasks illustrated in this walkthrough, see <bpt id=\"p1\">[</bpt>Hosting a Windows Forms Composite Control in WPF Sample<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkID=159999)</ept>.","source":"For a complete code listing of the tasks illustrated in this walkthrough, see [Hosting a Windows Forms Composite Control in WPF Sample](https://go.microsoft.com/fwlink/?LinkID=159999)."},{"pos":[2848,2861],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"You need Visual Studio to complete this walkthrough.","pos":[2865,2917]},{"pos":[2924,2972],"content":"Implementing the Windows Forms Composite Control","linkify":"Implementing the Windows Forms Composite Control","nodes":[{"content":"Implementing the Windows Forms Composite Control","pos":[0,48]}]},{"content":"The Windows Forms composite control used in this example is a simple data-entry form.","pos":[2976,3061]},{"content":"This form takes the user's name and address and then uses a custom event to return that information to the host.","pos":[3062,3174]},{"content":"The following illustration shows the rendered control.","pos":[3175,3229]},{"content":"The following image shows a Windows Forms composite control:","pos":[3234,3294]},{"content":"Screenshot that shows a simple Windows Forms control.","pos":[3301,3354]},{"pos":[3461,3481],"content":"Creating the Project","linkify":"Creating the Project","nodes":[{"content":"Creating the Project","pos":[0,20]}]},{"content":"To start the project:","pos":[3485,3506]},{"pos":[3516,3644],"content":"Launch <ph id=\"ph1\">[!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)]</ph>, and open the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box.","source":"Launch [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)], and open the **New Project** dialog box."},{"pos":[3654,3732],"content":"In the Window category, select the <bpt id=\"p1\">**</bpt>Windows Forms Control Library<ept id=\"p1\">**</ept> template.","source":"In the Window category, select the **Windows Forms Control Library** template."},{"pos":[3742,3776],"content":"Name the new project <ph id=\"ph1\">`MyControls`</ph>.","source":"Name the new project `MyControls`."},{"content":"For the location, specify a conveniently named top-level folder, such as <ph id=\"ph1\">`WpfHostingWindowsFormsControl`</ph>.","pos":[3786,3891],"source":"For the location, specify a conveniently named top-level folder, such as `WpfHostingWindowsFormsControl`."},{"content":"Later, you will put the host application in this folder.","pos":[3892,3948]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to create the project.","pos":[3958,3993],"source":"Click **OK** to create the project."},{"content":"The default project contains a single control named <ph id=\"ph1\">`UserControl1`</ph>.","pos":[3994,4061],"source":" The default project contains a single control named `UserControl1`."},{"pos":[4071,4131],"content":"In Solution Explorer, rename <ph id=\"ph1\">`UserControl1`</ph> to <ph id=\"ph2\">`MyControl1`</ph>.","source":"In Solution Explorer, rename `UserControl1` to `MyControl1`."},{"content":"Your project should have references to the following system DLLs.","pos":[4138,4203]},{"content":"If any of these DLLs are not included by default, add them to the project.","pos":[4204,4278]},{"content":"System","pos":[4288,4294]},{"content":"System.Data","pos":[4304,4315]},{"content":"System.Drawing","pos":[4325,4339]},{"content":"System.Windows.Forms","pos":[4349,4369]},{"content":"System.Xml","pos":[4379,4389]},{"pos":[4399,4426],"content":"Adding Controls to the Form","linkify":"Adding Controls to the Form","nodes":[{"content":"Adding Controls to the Form","pos":[0,27]}]},{"content":"To add controls to the form:","pos":[4430,4458]},{"pos":[4468,4502],"content":"Open <ph id=\"ph1\">`MyControl1`</ph> in the designer.","source":"Open `MyControl1` in the designer."},{"content":"Add five <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Label&gt;</ph> controls and their corresponding <ph id=\"ph2\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph> controls, sized and arranged as they are in the preceding illustration, on the form.","pos":[4509,4705],"source":"Add five <xref:System.Windows.Forms.Label> controls and their corresponding <xref:System.Windows.Forms.TextBox> controls, sized and arranged as they are in the preceding illustration, on the form."},{"content":"In the example, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.TextBox&gt;</ph> controls are named:","pos":[4706,4781],"source":" In the example, the <xref:System.Windows.Forms.TextBox> controls are named:"},{"content":"Add two <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Button&gt;</ph> controls labeled <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept>.","pos":[4886,4968],"source":"Add two <xref:System.Windows.Forms.Button> controls labeled **OK** and **Cancel**."},{"content":"In the example, the button names are <ph id=\"ph1\">`btnOK`</ph> and <ph id=\"ph2\">`btnCancel`</ph>, respectively.","pos":[4969,5044],"source":" In the example, the button names are `btnOK` and `btnCancel`, respectively."},{"pos":[5054,5086],"content":"Implementing the Supporting Code","linkify":"Implementing the Supporting Code","nodes":[{"content":"Implementing the Supporting Code","pos":[0,32]}]},{"content":"Open the form in code view.","pos":[5090,5117]},{"content":"The control returns the collected data to its host by raising the custom <ph id=\"ph1\">`OnButtonClick`</ph> event.","pos":[5118,5213],"source":" The control returns the collected data to its host by raising the custom `OnButtonClick` event."},{"content":"The data is contained in the event argument object.","pos":[5214,5265]},{"content":"The following code shows the event and delegate declaration.","pos":[5266,5326]},{"pos":[5333,5382],"content":"Add the following code to the <ph id=\"ph1\">`MyControl1`</ph> class.","source":"Add the following code to the `MyControl1` class."},{"pos":[5708,5791],"content":"The <ph id=\"ph1\">`MyControlEventArgs`</ph> class contains the information to be returned to the host.","source":"The `MyControlEventArgs` class contains the information to be returned to the host."},{"content":"Add the following class to the form.","pos":[5794,5830]},{"content":"When the user clicks the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> button, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.Click&gt;</ph> event handlers create a <ph id=\"ph2\">`MyControlEventArgs`</ph> object that contains the data and raises the <ph id=\"ph3\">`OnButtonClick`</ph> event.","pos":[6152,6364],"source":"When the user clicks the **OK** or **Cancel** button, the <xref:System.Windows.Forms.Control.Click> event handlers create a `MyControlEventArgs` object that contains the data and raises the `OnButtonClick` event."},{"content":"The only difference between the two handlers is the event argument's <ph id=\"ph1\">`IsOK`</ph> property.","pos":[6365,6450],"source":" The only difference between the two handlers is the event argument's `IsOK` property."},{"content":"This property enables the host to determine which button was clicked.","pos":[6451,6520]},{"content":"It is set to <ph id=\"ph1\">`true`</ph> for the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button, and <ph id=\"ph2\">`false`</ph> for the <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> button.","pos":[6521,6602],"source":" It is set to `true` for the **OK** button, and `false` for the **Cancel** button."},{"content":"The following code shows the two button handlers.","pos":[6603,6652]},{"pos":[6655,6704],"content":"Add the following code to the <ph id=\"ph1\">`MyControl1`</ph> class.","source":"Add the following code to the `MyControl1` class."},{"pos":[7029,7088],"content":"Giving the Assembly a Strong Name and Building the Assembly","linkify":"Giving the Assembly a Strong Name and Building the Assembly","nodes":[{"content":"Giving the Assembly a Strong Name and Building the Assembly","pos":[0,59]}]},{"content":"For this assembly to be referenced by a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> application, it must have a strong name.","pos":[7090,7252],"source":"For this assembly to be referenced by a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application, it must have a strong name."},{"content":"To create a strong name, create a key file with Sn.exe and add it to your project.","pos":[7253,7335]},{"content":"Open a <ph id=\"ph1\">[!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)]</ph> command prompt.","pos":[7341,7445],"source":"Open a [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] command prompt."},{"content":"To do so, click the <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> menu, and then select <bpt id=\"p2\">**</bpt>All Programs/Microsoft Visual Studio 2010/Visual Studio Tools/Visual Studio Command Prompt<ept id=\"p2\">**</ept>.","pos":[7446,7593],"source":" To do so, click the **Start** menu, and then select **All Programs/Microsoft Visual Studio 2010/Visual Studio Tools/Visual Studio Command Prompt**."},{"content":"This launches a console window with customized environment variables.","pos":[7594,7663]},{"pos":[7669,7742],"content":"At the command prompt, use the <ph id=\"ph1\">`cd`</ph> command to go to your project folder.","source":"At the command prompt, use the `cd` command to go to your project folder."},{"content":"Generate a key file named MyControls.snk by running the following command.","pos":[7748,7822]},{"content":"To include the key file in your project, right-click the project name in Solution Explorer and then click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","pos":[7874,7995],"source":"To include the key file in your project, right-click the project name in Solution Explorer and then click **Properties**."},{"content":"In the Project Designer, click the <bpt id=\"p1\">**</bpt>Signing<ept id=\"p1\">**</ept> tab, select the <bpt id=\"p2\">**</bpt>Sign the assembly<ept id=\"p2\">**</ept> check box and then browse to your key file.","pos":[7996,8124],"source":" In the Project Designer, click the **Signing** tab, select the **Sign the assembly** check box and then browse to your key file."},{"content":"Build the solution.","pos":[8130,8149]},{"content":"The build will produce a DLL named MyControls.dll.","pos":[8150,8200]},{"pos":[8205,8242],"content":"Implementing the WPF Host Application","linkify":"Implementing the WPF Host Application","nodes":[{"content":"Implementing the WPF Host Application","pos":[0,37]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> host application uses the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> control to host <ph id=\"ph3\">`MyControl1`</ph>.","pos":[8244,8442],"source":"The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] host application uses the <xref:System.Windows.Forms.Integration.WindowsFormsHost> control to host `MyControl1`."},{"content":"The application handles the <ph id=\"ph1\">`OnButtonClick`</ph> event to receive the data from the control.","pos":[8443,8530],"source":" The application handles the `OnButtonClick` event to receive the data from the control."},{"content":"It also has a collection of option buttons that enable you to change some of the control's properties from the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> application.","pos":[8531,8736],"source":" It also has a collection of option buttons that enable you to change some of the control's properties from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application."},{"content":"The following illustration shows the finished application.","pos":[8737,8795]},{"content":"The following image shows the complete application, including the control embedded in the WPF application:","pos":[8797,8903]},{"content":"Screenshot that shows a control embedded in a WPF page.","pos":[8908,8963]},{"pos":[9089,9109],"content":"Creating the Project","linkify":"Creating the Project","nodes":[{"content":"Creating the Project","pos":[0,20]}]},{"content":"To start the project:","pos":[9111,9132]},{"pos":[9138,9253],"content":"Open <ph id=\"ph1\">[!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)]</ph>, and select <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept>.","source":"Open [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], and select **New Project**."},{"pos":[9259,9323],"content":"In the Window category, select the <bpt id=\"p1\">**</bpt>WPF Application<ept id=\"p1\">**</ept> template.","source":"In the Window category, select the **WPF Application** template."},{"pos":[9329,9360],"content":"Name the new project <ph id=\"ph1\">`WpfHost`</ph>.","source":"Name the new project `WpfHost`."},{"content":"For the location, specify the same top-level folder that contains the MyControls project.","pos":[9366,9455]},{"pos":[9461,9496],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to create the project.","source":"Click **OK** to create the project."},{"pos":[9499,9590],"content":"You also need to add references to the DLL that contains <ph id=\"ph1\">`MyControl1`</ph> and other assemblies.","source":"You also need to add references to the DLL that contains `MyControl1` and other assemblies."},{"pos":[9596,9675],"content":"Right-click the project name in Solution Explorer and select <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept>.","source":"Right-click the project name in Solution Explorer and select **Add Reference**."},{"content":"Click the <bpt id=\"p1\">**</bpt>Browse<ept id=\"p1\">**</ept> tab, and browse to the folder that contains MyControls.dll.","pos":[9681,9761],"source":"Click the **Browse** tab, and browse to the folder that contains MyControls.dll."},{"content":"For this walkthrough, this folder is MyControls\\bin\\Debug.","pos":[9762,9820]},{"pos":[9826,9871],"content":"Select MyControls.dll, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Select MyControls.dll, and then click **OK**."},{"content":"Add a reference to the WindowsFormsIntegration assembly, which is named WindowsFormsIntegration.dll.","pos":[9877,9977]},{"pos":[9983,10012],"content":"Implementing the Basic Layout","linkify":"Implementing the Basic Layout","nodes":[{"content":"Implementing the Basic Layout","pos":[0,29]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]</ph> of the host application is implemented in MainWindow.xaml.","pos":[10014,10142],"source":"The [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] of the host application is implemented in MainWindow.xaml."},{"content":"This file contains <ph id=\"ph1\">[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]</ph> markup that defines the layout, and hosts the Windows Forms control.","pos":[10143,10300],"source":" This file contains [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] markup that defines the layout, and hosts the Windows Forms control."},{"content":"The application is divided into three regions:","pos":[10301,10347]},{"pos":[10353,10501],"content":"The <bpt id=\"p1\">**</bpt>Control Properties<ept id=\"p1\">**</ept> panel, which contains a collection of option buttons that you can use to modify various properties of the hosted control.","source":"The **Control Properties** panel, which contains a collection of option buttons that you can use to modify various properties of the hosted control."},{"pos":[10507,10668],"content":"The <bpt id=\"p1\">**</bpt>Data from Control<ept id=\"p1\">**</ept> panel, which contains several <ph id=\"ph1\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> elements that display the data returned from the hosted control.","source":"The **Data from Control** panel, which contains several <xref:System.Windows.Controls.TextBlock> elements that display the data returned from the hosted control."},{"content":"The hosted control itself.","pos":[10674,10700]},{"content":"The basic layout is shown in the following XAML.","pos":[10703,10751]},{"content":"The markup that is needed to host <ph id=\"ph1\">`MyControl1`</ph> is omitted from this example, but will be discussed later.","pos":[10752,10857],"source":" The markup that is needed to host `MyControl1` is omitted from this example, but will be discussed later."},{"content":"Replace the XAML in MainWindow.xaml with the following.","pos":[10860,10915]},{"content":"If you are using Visual Basic, change the class to <ph id=\"ph1\">`x:Class=\"MainWindow\"`</ph>.","pos":[10916,10990],"source":" If you are using Visual Basic, change the class to `x:Class=\"MainWindow\"`."},{"content":"The first <ph id=\"ph1\">&lt;xref:System.Windows.Controls.StackPanel&gt;</ph> element contains several sets of <ph id=\"ph2\">&lt;xref:System.Windows.Controls.RadioButton&gt;</ph> controls that enable you to modify various default properties of the hosted control.","pos":[11146,11358],"source":"The first <xref:System.Windows.Controls.StackPanel> element contains several sets of <xref:System.Windows.Controls.RadioButton> controls that enable you to modify various default properties of the hosted control."},{"content":"That is followed by a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element, which hosts <ph id=\"ph2\">`MyControl1`</ph>.","pos":[11359,11472],"source":" That is followed by a <xref:System.Windows.Forms.Integration.WindowsFormsHost> element, which hosts `MyControl1`."},{"content":"The final <ph id=\"ph1\">&lt;xref:System.Windows.Controls.StackPanel&gt;</ph> element contains several <ph id=\"ph2\">&lt;xref:System.Windows.Controls.TextBlock&gt;</ph> elements that display the data that is returned by the hosted control.","pos":[11473,11661],"source":" The final <xref:System.Windows.Controls.StackPanel> element contains several <xref:System.Windows.Controls.TextBlock> elements that display the data that is returned by the hosted control."},{"content":"The ordering of the elements and the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.DockPanel.Dock%2A&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Windows.FrameworkElement.Height%2A&gt;</ph> attribute settings embed the hosted control into the window with no gaps or distortion.","pos":[11662,11888],"source":" The ordering of the elements and the <xref:System.Windows.Controls.DockPanel.Dock%2A> and <xref:System.Windows.FrameworkElement.Height%2A> attribute settings embed the hosted control into the window with no gaps or distortion."},{"pos":[11895,11914],"content":"Hosting the Control","linkify":"Hosting the Control","nodes":[{"content":"Hosting the Control","pos":[0,19]}]},{"pos":[11916,12027],"content":"The following edited version of the previous XAML focuses on the elements that are needed to host <ph id=\"ph1\">`MyControl1`</ph>.","source":"The following edited version of the previous XAML focuses on the elements that are needed to host `MyControl1`."},{"content":"The <ph id=\"ph1\">`xmlns`</ph> namespace mapping attribute creates a reference to the <ph id=\"ph2\">`MyControls`</ph> namespace that contains the hosted control.","pos":[12334,12457],"source":"The `xmlns` namespace mapping attribute creates a reference to the `MyControls` namespace that contains the hosted control."},{"content":"This mapping enables you to represent <ph id=\"ph1\">`MyControl1`</ph> in <ph id=\"ph2\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> as <ph id=\"ph3\">`&lt;mcl:MyControl1&gt;`</ph>.","pos":[12458,12606],"source":" This mapping enables you to represent `MyControl1` in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] as `<mcl:MyControl1>`."},{"content":"Two elements in the XAML handle the hosting:","pos":[12609,12653]},{"pos":[12659,12906],"content":"<ph id=\"ph1\">`WindowsFormsHost`</ph> represents the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element that enables you to host a Windows Forms control in a <ph id=\"ph3\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> application.","source":"`WindowsFormsHost` represents the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element that enables you to host a Windows Forms control in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application."},{"content":"<ph id=\"ph1\">`mcl:MyControl1`</ph>, which represents <ph id=\"ph2\">`MyControl1`</ph>, is added to the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element's child collection.","pos":[12912,13061],"source":"`mcl:MyControl1`, which represents `MyControl1`, is added to the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element's child collection."},{"content":"As a result, this Windows Forms control is rendered as part of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</ph> window, and you can communicate with the control from the application.","pos":[13062,13281],"source":" As a result, this Windows Forms control is rendered as part of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] window, and you can communicate with the control from the application."},{"pos":[13287,13320],"content":"Implementing the Code-Behind File","linkify":"Implementing the Code-Behind File","nodes":[{"content":"Implementing the Code-Behind File","pos":[0,33]}]},{"content":"The code-behind file, MainWindow.xaml.vb or MainWindow.xaml.cs, contains the procedural code that implements the functionality of the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]</ph> discussed in the preceding section.","pos":[13322,13559],"source":"The code-behind file, MainWindow.xaml.vb or MainWindow.xaml.cs, contains the procedural code that implements the functionality of the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] discussed in the preceding section."},{"content":"The primary tasks are:","pos":[13560,13582]},{"pos":[13588,13655],"content":"Attaching an event handler to <ph id=\"ph1\">`MyControl1`</ph>'s <ph id=\"ph2\">`OnButtonClick`</ph> event.","source":"Attaching an event handler to `MyControl1`'s `OnButtonClick` event."},{"pos":[13661,13761],"content":"Modifying various properties of <ph id=\"ph1\">`MyControl1`</ph>, based on how the collection of option buttons are set.","source":"Modifying various properties of `MyControl1`, based on how the collection of option buttons are set."},{"content":"Displaying the data collected by the control.","pos":[13767,13812]},{"pos":[13819,13847],"content":"Initializing the Application","linkify":"Initializing the Application","nodes":[{"content":"Initializing the Application","pos":[0,28]}]},{"pos":[13849,14044],"content":"The initialization code is contained in an event handler for the window's <ph id=\"ph1\">&lt;xref:System.Windows.FrameworkElement.Loaded&gt;</ph> event and attaches an event handler to the control's <ph id=\"ph2\">`OnButtonClick`</ph> event.","source":"The initialization code is contained in an event handler for the window's <xref:System.Windows.FrameworkElement.Loaded> event and attaches an event handler to the control's `OnButtonClick` event."},{"pos":[14047,14141],"content":"In MainWindow.xaml.vb or MainWindow.xaml.cs, add the following code to the <ph id=\"ph1\">`MainWindow`</ph> class.","source":"In MainWindow.xaml.vb or MainWindow.xaml.cs, add the following code to the `MainWindow` class."},{"content":"Because the <ph id=\"ph1\">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</ph> discussed previously added <ph id=\"ph2\">`MyControl1`</ph> to the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element's child element collection, you can cast the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element's <ph id=\"ph5\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost.Child%2A&gt;</ph> to get the reference to <ph id=\"ph6\">`MyControl1`</ph>.","pos":[14461,14872],"source":"Because the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] discussed previously added `MyControl1` to the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element's child element collection, you can cast the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element's <xref:System.Windows.Forms.Integration.WindowsFormsHost.Child%2A> to get the reference to `MyControl1`."},{"content":"You can then use that reference to attach an event handler to <ph id=\"ph1\">`OnButtonClick`</ph>.","pos":[14873,14951],"source":" You can then use that reference to attach an event handler to `OnButtonClick`."},{"content":"In addition to providing a reference to the control itself, <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> exposes a number of the control's properties, which you can manipulate from the application.","pos":[14954,15163],"source":"In addition to providing a reference to the control itself, <xref:System.Windows.Forms.Integration.WindowsFormsHost> exposes a number of the control's properties, which you can manipulate from the application."},{"content":"The initialization code assigns those values to private global variables for later use in the application.","pos":[15164,15270]},{"pos":[15273,15410],"content":"So that you can easily access the types in the <ph id=\"ph1\">`MyControls`</ph> DLL, add the following <ph id=\"ph2\">`Imports`</ph> or <ph id=\"ph3\">`using`</ph> statement to the top of the file.","source":"So that you can easily access the types in the `MyControls` DLL, add the following `Imports` or `using` statement to the top of the file."},{"pos":[15480,15512],"content":"Handling the OnButtonClick Event","linkify":"Handling the OnButtonClick Event","nodes":[{"content":"Handling the OnButtonClick Event","pos":[0,32]}]},{"pos":[15514,15613],"content":"<ph id=\"ph1\">`MyControl1`</ph> raises the <ph id=\"ph2\">`OnButtonClick`</ph> event when the user clicks either of the control's buttons.","source":"`MyControl1` raises the `OnButtonClick` event when the user clicks either of the control's buttons."},{"pos":[15616,15665],"content":"Add the following code to the <ph id=\"ph1\">`MainWindow`</ph> class.","source":"Add the following code to the `MainWindow` class."},{"content":"The data in the text boxes is packed into the <ph id=\"ph1\">`MyControlEventArgs`</ph> object.","pos":[15985,16059],"source":"The data in the text boxes is packed into the `MyControlEventArgs` object."},{"content":"If the user clicks the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button, the event handler extracts the data and displays it in the panel below <ph id=\"ph1\">`MyControl1`</ph>.","pos":[16060,16182],"source":" If the user clicks the **OK** button, the event handler extracts the data and displays it in the panel below `MyControl1`."},{"pos":[16189,16223],"content":"Modifying the Control’s Properties","linkify":"Modifying the Control’s Properties","nodes":[{"content":"Modifying the Control’s Properties","pos":[0,34]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Integration.WindowsFormsHost&gt;</ph> element exposes several of the hosted control's default properties.","pos":[16225,16353],"source":"The <xref:System.Windows.Forms.Integration.WindowsFormsHost> element exposes several of the hosted control's default properties."},{"content":"As a result, you can change the appearance of the control to match the style of your application more closely.","pos":[16354,16464]},{"content":"The sets of option buttons in the left panel enable the user to modify several color and font properties.","pos":[16465,16570]},{"content":"Each set of buttons has a handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Controls.Primitives.ButtonBase.Click&gt;</ph> event, which detects the user's option button selections and changes the corresponding property on the control.","pos":[16571,16783],"source":" Each set of buttons has a handler for the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event, which detects the user's option button selections and changes the corresponding property on the control."},{"pos":[16786,16835],"content":"Add the following code to the <ph id=\"ph1\">`MainWindow`</ph> class.","source":"Add the following code to the `MainWindow` class."},{"content":"Build and run the application.","pos":[17159,17189]},{"content":"Add some text in the Windows Forms composite control and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[17190,17265],"source":" Add some text in the Windows Forms composite control and then click **OK**."},{"content":"The text appears in the labels.","pos":[17266,17297]},{"content":"Click the different radio buttons to see the effect on the control.","pos":[17298,17365]},{"pos":[17374,17382],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[17499,17586],"content":"<bpt id=\"p1\">[</bpt>Design XAML in Visual Studio<ept id=\"p1\">](/visualstudio/designers/designing-xaml-in-visual-studio)</ept>","source":"[Design XAML in Visual Studio](/visualstudio/designers/designing-xaml-in-visual-studio)"},{"pos":[17589,17697],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a Windows Forms Control in WPF<ept id=\"p1\">](walkthrough-hosting-a-windows-forms-control-in-wpf.md)</ept>","source":"[Walkthrough: Hosting a Windows Forms Control in WPF](walkthrough-hosting-a-windows-forms-control-in-wpf.md)"},{"pos":[17700,17828],"content":"<bpt id=\"p1\">[</bpt>Walkthrough: Hosting a WPF Composite Control in Windows Forms<ept id=\"p1\">](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)</ept>","source":"[Walkthrough: Hosting a WPF Composite Control in Windows Forms](walkthrough-hosting-a-wpf-composite-control-in-windows-forms.md)"}]}