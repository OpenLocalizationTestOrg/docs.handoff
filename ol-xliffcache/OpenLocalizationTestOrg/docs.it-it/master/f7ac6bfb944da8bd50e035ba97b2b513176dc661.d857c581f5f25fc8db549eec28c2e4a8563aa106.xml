{"content":"---\ntitle: \"Type Promotion (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"declared elements [Visual Basic], scope\"\n  - \"visibility [Visual Basic], declared elements\"\n  - \"Partial keyword [Visual Basic], unexpected results with type promotion\"\n  - \"scope [Visual Basic], declared elements\"\n  - \"scope [Visual Basic], Visual Basic\"\n  - \"type promotion\"\n  - \"declared elements [Visual Basic], visibility\"\nms.assetid: 035eeb15-e4c5-4288-ab3c-6bd5d22f7051\n---\n# Type Promotion (Visual Basic)\nWhen you declare a programming element in a module, Visual Basic promotes its scope to the namespace containing the module. This is known as *type promotion*.  \n  \n The following example shows a skeleton definition of a module and two members of that module.  \n  \n [!code-vb[VbVbalrDeclaredElements#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDeclaredElements/VB/Class1.vb#1)]  \n  \n Within `projModule`, programming elements declared at module level are promoted to `projNamespace`. In the preceding example, `basicEnum` and `innerClass` are promoted, but `numberSub` is not, because it is not declared at module level.  \n  \n## Effect of Type Promotion  \n The effect of type promotion is that a qualification string does not need to include the module name. The following example makes two calls to the procedure in the preceding example.  \n  \n [!code-vb[VbVbalrDeclaredElements#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDeclaredElements/VB/Class1.vb#2)]  \n  \n In the preceding example, the first call uses complete qualification strings. However, this is not necessary because of type promotion. The second call also accesses the module's members without including `projModule` in the qualification strings.  \n  \n## Defeat of Type Promotion  \n If the namespace already has a member with the same name as a module member, type promotion is defeated for that module member. The following example shows a skeleton definition of an enumeration and a module within the same namespace.  \n  \n [!code-vb[VbVbalrDeclaredElements#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDeclaredElements/VB/Class1.vb#3)]  \n  \n In the preceding example, Visual Basic cannot promote class `abc` to `thisNameSpace` because there is already an enumeration with the same name at namespace level. To access `abcSub`, you must use the full qualification string `thisNamespace.thisModule.abc.abcSub`. However, class `xyz` is still promoted, and you can access `xyzSub` with the shorter qualification string `thisNamespace.xyz.xyzSub`.  \n  \n### Defeat of Type Promotion for Partial Types  \n If a class or structure inside a module uses the [Partial](../../../../visual-basic/language-reference/modifiers/partial.md) keyword, type promotion is automatically defeated for that class or structure, whether or not the namespace has a member with the same name. Other elements in the module are still eligible for type promotion.  \n  \n **Consequences.** Defeat of type promotion of a partial definition can cause unexpected results and even compiler errors. The following example shows skeleton partial definitions of a class, one of which is inside a module.  \n  \n [!code-vb[VbVbalrDeclaredElements#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDeclaredElements/VB/Class1.vb#4)]  \n  \n In the preceding example, the developer might expect the compiler to merge the two partial definitions of `sampleClass`. However, the compiler does not consider promotion for the partial definition inside `sampleModule`. As a result, it attempts to compile two separate and distinct classes, both named `sampleClass` but with different qualification paths.  \n  \n The compiler merges partial definitions only when their fully qualified paths are identical.  \n  \n## Recommendations  \n The following recommendations represent good programming practice.  \n  \n-   **Unique Names.** When you have full control over the naming of programming elements, it is always a good idea to use unique names everywhere. Identical names require extra qualification and can make your code harder to read. They can also lead to subtle errors and unexpected results.  \n  \n-   **Full Qualification.** When you are working with modules and other elements in the same namespace, the safest approach is to always use full qualification for all programming elements. If type promotion is defeated for a module member and you do not fully qualify that member, you could inadvertently access a different programming element.  \n  \n## See also\n\n- [Module Statement](../../../../visual-basic/language-reference/statements/module-statement.md)\n- [Namespace Statement](../../../../visual-basic/language-reference/statements/namespace-statement.md)\n- [Partial](../../../../visual-basic/language-reference/modifiers/partial.md)\n- [Scope in Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)\n- [How to: Control the Scope of a Variable](../../../../visual-basic/programming-guide/language-features/declared-elements/how-to-control-the-scope-of-a-variable.md)\n- [References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)\n","nodes":[{"pos":[4,466],"embed":true,"restype":"x-metadata","content":"title: \"Type Promotion (Visual Basic)\"\nms.date: 07/20/2015\nhelpviewer_keywords: \n  - \"declared elements [Visual Basic], scope\"\n  - \"visibility [Visual Basic], declared elements\"\n  - \"Partial keyword [Visual Basic], unexpected results with type promotion\"\n  - \"scope [Visual Basic], declared elements\"\n  - \"scope [Visual Basic], Visual Basic\"\n  - \"type promotion\"\n  - \"declared elements [Visual Basic], visibility\"\nms.assetid: 035eeb15-e4c5-4288-ab3c-6bd5d22f7051","nodes":[{"content":"Type Promotion (Visual Basic)","nodes":[{"pos":[0,29],"content":"Type Promotion (Visual Basic)","nodes":[{"content":"Type Promotion (Visual Basic)","pos":[0,29]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[473,502],"content":"Type Promotion (Visual Basic)","linkify":"Type Promotion (Visual Basic)","nodes":[{"content":"Type Promotion (Visual Basic)","pos":[0,29]}]},{"content":"When you declare a programming element in a module, Visual Basic promotes its scope to the namespace containing the module.","pos":[503,626]},{"content":"This is known as <bpt id=\"p1\">*</bpt>type promotion<ept id=\"p1\">*</ept>.","pos":[627,661],"source":" This is known as *type promotion*."},{"content":"The following example shows a skeleton definition of a module and two members of that module.","pos":[668,761]},{"content":"Within <ph id=\"ph1\">`projModule`</ph>, programming elements declared at module level are promoted to <ph id=\"ph2\">`projNamespace`</ph>.","pos":[904,1003],"source":"Within `projModule`, programming elements declared at module level are promoted to `projNamespace`."},{"content":"In the preceding example, <ph id=\"ph1\">`basicEnum`</ph> and <ph id=\"ph2\">`innerClass`</ph> are promoted, but <ph id=\"ph3\">`numberSub`</ph> is not, because it is not declared at module level.","pos":[1004,1140],"source":" In the preceding example, `basicEnum` and `innerClass` are promoted, but `numberSub` is not, because it is not declared at module level."},{"pos":[1149,1173],"content":"Effect of Type Promotion","linkify":"Effect of Type Promotion","nodes":[{"content":"Effect of Type Promotion","pos":[0,24]}]},{"content":"The effect of type promotion is that a qualification string does not need to include the module name.","pos":[1177,1278]},{"content":"The following example makes two calls to the procedure in the preceding example.","pos":[1279,1359]},{"content":"In the preceding example, the first call uses complete qualification strings.","pos":[1502,1579]},{"content":"However, this is not necessary because of type promotion.","pos":[1580,1637]},{"content":"The second call also accesses the module's members without including <ph id=\"ph1\">`projModule`</ph> in the qualification strings.","pos":[1638,1749],"source":" The second call also accesses the module's members without including `projModule` in the qualification strings."},{"pos":[1758,1782],"content":"Defeat of Type Promotion","linkify":"Defeat of Type Promotion","nodes":[{"content":"Defeat of Type Promotion","pos":[0,24]}]},{"content":"If the namespace already has a member with the same name as a module member, type promotion is defeated for that module member.","pos":[1786,1913]},{"content":"The following example shows a skeleton definition of an enumeration and a module within the same namespace.","pos":[1914,2021]},{"content":"In the preceding example, Visual Basic cannot promote class <ph id=\"ph1\">`abc`</ph> to <ph id=\"ph2\">`thisNameSpace`</ph> because there is already an enumeration with the same name at namespace level.","pos":[2164,2327],"source":"In the preceding example, Visual Basic cannot promote class `abc` to `thisNameSpace` because there is already an enumeration with the same name at namespace level."},{"content":"To access <ph id=\"ph1\">`abcSub`</ph>, you must use the full qualification string <ph id=\"ph2\">`thisNamespace.thisModule.abc.abcSub`</ph>.","pos":[2328,2429],"source":" To access `abcSub`, you must use the full qualification string `thisNamespace.thisModule.abc.abcSub`."},{"content":"However, class <ph id=\"ph1\">`xyz`</ph> is still promoted, and you can access <ph id=\"ph2\">`xyzSub`</ph> with the shorter qualification string <ph id=\"ph3\">`thisNamespace.xyz.xyzSub`</ph>.","pos":[2430,2563],"source":" However, class `xyz` is still promoted, and you can access `xyzSub` with the shorter qualification string `thisNamespace.xyz.xyzSub`."},{"pos":[2573,2615],"content":"Defeat of Type Promotion for Partial Types","linkify":"Defeat of Type Promotion for Partial Types","nodes":[{"content":"Defeat of Type Promotion for Partial Types","pos":[0,42]}]},{"content":"If a class or structure inside a module uses the <bpt id=\"p1\">[</bpt>Partial<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/partial.md)</ept> keyword, type promotion is automatically defeated for that class or structure, whether or not the namespace has a member with the same name.","pos":[2619,2884],"source":"If a class or structure inside a module uses the [Partial](../../../../visual-basic/language-reference/modifiers/partial.md) keyword, type promotion is automatically defeated for that class or structure, whether or not the namespace has a member with the same name."},{"content":"Other elements in the module are still eligible for type promotion.","pos":[2885,2952]},{"content":"<bpt id=\"p1\">**</bpt>Consequences.<ept id=\"p1\">**</ept>","pos":[2959,2976],"source":"**Consequences.**"},{"content":"Defeat of type promotion of a partial definition can cause unexpected results and even compiler errors.","pos":[2977,3080]},{"content":"The following example shows skeleton partial definitions of a class, one of which is inside a module.","pos":[3081,3182]},{"content":"In the preceding example, the developer might expect the compiler to merge the two partial definitions of <ph id=\"ph1\">`sampleClass`</ph>.","pos":[3325,3445],"source":"In the preceding example, the developer might expect the compiler to merge the two partial definitions of `sampleClass`."},{"content":"However, the compiler does not consider promotion for the partial definition inside <ph id=\"ph1\">`sampleModule`</ph>.","pos":[3446,3545],"source":" However, the compiler does not consider promotion for the partial definition inside `sampleModule`."},{"content":"As a result, it attempts to compile two separate and distinct classes, both named <ph id=\"ph1\">`sampleClass`</ph> but with different qualification paths.","pos":[3546,3681],"source":" As a result, it attempts to compile two separate and distinct classes, both named `sampleClass` but with different qualification paths."},{"content":"The compiler merges partial definitions only when their fully qualified paths are identical.","pos":[3688,3780]},{"pos":[3789,3804],"content":"Recommendations","linkify":"Recommendations","nodes":[{"content":"Recommendations","pos":[0,15]}]},{"content":"The following recommendations represent good programming practice.","pos":[3808,3874]},{"content":"<bpt id=\"p1\">**</bpt>Unique Names.<ept id=\"p1\">**</ept>","pos":[3884,3901],"source":"**Unique Names.**"},{"content":"When you have full control over the naming of programming elements, it is always a good idea to use unique names everywhere.","pos":[3902,4026]},{"content":"Identical names require extra qualification and can make your code harder to read.","pos":[4027,4109]},{"content":"They can also lead to subtle errors and unexpected results.","pos":[4110,4169]},{"content":"<bpt id=\"p1\">**</bpt>Full Qualification.<ept id=\"p1\">**</ept>","pos":[4179,4202],"source":"**Full Qualification.**"},{"content":"When you are working with modules and other elements in the same namespace, the safest approach is to always use full qualification for all programming elements.","pos":[4203,4364]},{"content":"If type promotion is defeated for a module member and you do not fully qualify that member, you could inadvertently access a different programming element.","pos":[4365,4520]},{"pos":[4529,4537],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4541,4635],"content":"<bpt id=\"p1\">[</bpt>Module Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/module-statement.md)</ept>","source":"[Module Statement](../../../../visual-basic/language-reference/statements/module-statement.md)"},{"pos":[4638,4738],"content":"<bpt id=\"p1\">[</bpt>Namespace Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/namespace-statement.md)</ept>","source":"[Namespace Statement](../../../../visual-basic/language-reference/statements/namespace-statement.md)"},{"pos":[4741,4816],"content":"<bpt id=\"p1\">[</bpt>Partial<ept id=\"p1\">](../../../../visual-basic/language-reference/modifiers/partial.md)</ept>","source":"[Partial](../../../../visual-basic/language-reference/modifiers/partial.md)"},{"pos":[4819,4931],"content":"<bpt id=\"p1\">[</bpt>Scope in Visual Basic<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)</ept>","source":"[Scope in Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)"},{"pos":[4934,5097],"content":"<bpt id=\"p1\">[</bpt>How to: Control the Scope of a Variable<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/declared-elements/how-to-control-the-scope-of-a-variable.md)</ept>","source":"[How to: Control the Scope of a Variable](../../../../visual-basic/programming-guide/language-features/declared-elements/how-to-control-the-scope-of-a-variable.md)"},{"pos":[5100,5248],"content":"<bpt id=\"p1\">[</bpt>References to Declared Elements<ept id=\"p1\">](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)</ept>","source":"[References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)"}]}