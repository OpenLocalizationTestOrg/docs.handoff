{"content":"---\ntitle: \"IMetaDataImport::ResolveTypeRef Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataImport.ResolveTypeRef\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataImport::ResolveTypeRef\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ResolveTypeRef method [.NET Framework metadata]\"\n  - \"IMetaDataImport::ResolveTypeRef method [.NET Framework metadata]\"\nms.assetid: 556bccfb-61bc-4761-b1d5-de4b1c18a38f\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 15\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# IMetaDataImport::ResolveTypeRef Method\nResolves a <xref:System.Type> reference represented by the specified TypeRef token.  \n  \n## Syntax  \n  \n```  \nHRESULT ResolveTypeRef (  \n   [in]  mdTypeRef       tr,  \n   [in]  REFIID          riid,  \n   [out] IUnknown        **ppIScope,  \n   [out] mdTypeDef       *ptd  \n);  \n```  \n  \n#### Parameters  \n `tr`  \n [in] The TypeRef metadata token to return the referenced type information for.  \n  \n `riid`  \n [in] The IID of the interface to return in `ppIScope`. Typically, this would be IID_IMetaDataImport.  \n  \n `ppIScope`  \n [out] An interface to the module scope in which the referenced type is defined.  \n  \n `ptd`  \n [out] A pointer to a TypeDef token that represents the referenced type.  \n  \n## Remarks  \n  \n> [!IMPORTANT]\n>  Do not use this method if multiple application domains are loaded. The method does not respect application domain boundaries. If multiple versions of an assembly are loaded, and they contain the same type with the same namespace, the method returns the module scope of the first type it finds.  \n  \n The `ResolveTypeRef` method searches for the type definition in other modules. If the type definition is found, `ResolveTypeRef` returns an interface to that module scope as well as the TypeDef token for the type.  \n  \n If the type reference to be resolved has a resolution scope of AssemblyRef, the `ResolveTypeRef` method searches for a match only in the metadata scopes that have already been opened with calls to either the [IMetaDataDispenser::OpenScope](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-openscope-method.md) method or the [IMetaDataDispenser::OpenScopeOnMemory](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-openscopeonmemory-method.md) method. This is because `ResolveTypeRef` cannot determine from only the AssemblyRef scope where on disk or in the global assembly cache the assembly is stored.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** Cor.h  \n  \n **Library:** Included as a resource in MsCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See Also  \n [IMetaDataImport Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataimport-interface.md)   \n [IMetaDataImport2 Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataimport2-interface.md)","nodes":[{"pos":[12,67],"content":"IMetaDataImport::ResolveTypeRef Method | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IMetaDataImport::ResolveTypeRef Method | Microsoft Docs","pos":[0,55]}]},{"pos":[719,757],"content":"IMetaDataImport::ResolveTypeRef Method","linkify":"IMetaDataImport::ResolveTypeRef Method","nodes":[{"content":"IMetaDataImport::ResolveTypeRef Method","pos":[0,38]}]},{"content":"Resolves a <ph id=\"ph1\">&lt;xref:System.Type&gt;</ph> reference represented by the specified TypeRef token.","pos":[758,841],"source":"Resolves a <xref:System.Type> reference represented by the specified TypeRef token."},{"pos":[850,856],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1049,1059],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The TypeRef metadata token to return the referenced type information for.","pos":[1071,1149]},{"content":"[in] The IID of the interface to return in <ph id=\"ph1\">`ppIScope`</ph>.","pos":[1166,1220],"source":" [in] The IID of the interface to return in `ppIScope`."},{"content":"Typically, this would be IID_IMetaDataImport.","pos":[1221,1266]},{"content":"[out] An interface to the module scope in which the referenced type is defined.","pos":[1287,1366]},{"content":"[out] A pointer to a TypeDef token that represents the referenced type.","pos":[1382,1453]},{"pos":[1462,1469],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[1477,1786],"content":"[!IMPORTANT]\n Do not use this method if multiple application domains are loaded. The method does not respect application domain boundaries. If multiple versions of an assembly are loaded, and they contain the same type with the same namespace, the method returns the module scope of the first type it finds.","leadings":["","> "],"nodes":[{"content":" Do not use this method if multiple application domains are loaded. The method does not respect application domain boundaries. If multiple versions of an assembly are loaded, and they contain the same type with the same namespace, the method returns the module scope of the first type it finds.","pos":[13,307],"nodes":[{"content":"Do not use this method if multiple application domains are loaded.","pos":[1,67]},{"content":"The method does not respect application domain boundaries.","pos":[68,126]},{"content":"If multiple versions of an assembly are loaded, and they contain the same type with the same namespace, the method returns the module scope of the first type it finds.","pos":[127,294]}]}]},{"content":"The <ph id=\"ph1\">`ResolveTypeRef`</ph> method searches for the type definition in other modules.","pos":[1793,1871],"source":"The `ResolveTypeRef` method searches for the type definition in other modules."},{"content":"If the type definition is found, <ph id=\"ph1\">`ResolveTypeRef`</ph> returns an interface to that module scope as well as the TypeDef token for the type.","pos":[1872,2006],"source":" If the type definition is found, `ResolveTypeRef` returns an interface to that module scope as well as the TypeDef token for the type."},{"content":"If the type reference to be resolved has a resolution scope of AssemblyRef, the <ph id=\"ph1\">`ResolveTypeRef`</ph> method searches for a match only in the metadata scopes that have already been opened with calls to either the <bpt id=\"p1\">[</bpt>IMetaDataDispenser::OpenScope<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-openscope-method.md)</ept> method or the <bpt id=\"p2\">[</bpt>IMetaDataDispenser::OpenScopeOnMemory<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-openscopeonmemory-method.md)</ept> method.","pos":[2013,2502],"source":"If the type reference to be resolved has a resolution scope of AssemblyRef, the `ResolveTypeRef` method searches for a match only in the metadata scopes that have already been opened with calls to either the [IMetaDataDispenser::OpenScope](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-openscope-method.md) method or the [IMetaDataDispenser::OpenScopeOnMemory](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-openscopeonmemory-method.md) method."},{"content":"This is because <ph id=\"ph1\">`ResolveTypeRef`</ph> cannot determine from only the AssemblyRef scope where on disk or in the global assembly cache the assembly is stored.","pos":[2503,2654],"source":" This is because `ResolveTypeRef` cannot determine from only the AssemblyRef scope where on disk or in the global assembly cache the assembly is stored."},{"pos":[2663,2675],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2679,2783],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2790,2807],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> Cor.h","source":"**Header:** Cor.h"},{"pos":[2814,2864],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MsCorEE.dll","source":"**Library:** Included as a resource in MsCorEE.dll"},{"pos":[2871,2979],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]"},{"pos":[2988,2996],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>IMetaDataImport Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataimport-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[3000,3108],"source":"[IMetaDataImport Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataimport-interface.md) "},{"content":"<bpt id=\"p1\"> [</bpt>IMetaDataImport2 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataimport2-interface.md)</ept>","pos":[3111,3221],"source":" [IMetaDataImport2 Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataimport2-interface.md)"}]}