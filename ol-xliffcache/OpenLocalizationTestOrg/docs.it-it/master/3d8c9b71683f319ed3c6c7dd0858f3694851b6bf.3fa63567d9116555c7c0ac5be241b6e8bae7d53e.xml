{"content":"---\ntitle: \"IHostThreadPoolManager::QueueUserWorkItem Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IHostThreadPoolManager.QueueUserWorkItem\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostThreadPoolManager::QueueUserWorkItem\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IHostThreadPoolManager::QueueUserWorkItem method [.NET Framework hosting]\"\n  - \"QueueUserWorkItem method [.NET Framework hosting]\"\nms.assetid: 41602053-8670-4827-9d61-cbfcba509b9c\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# IHostThreadPoolManager::QueueUserWorkItem Method\nQueues a function for execution, and specifies an object containing data to be used by that function. The function executes when a thread becomes available.  \n  \n## Syntax  \n  \n```  \nHRESULT QueueUserWorkItem (  \n    [in] LPTHREAD_START_ROUTINE Function,  \n    [in] PVOID Context,  \n    [in] ULONG Flags  \n);  \n```  \n  \n#### Parameters  \n `Function`  \n [in] A function pointer that represents the function to execute.  \n  \n `Context`  \n [in] An object that contains data to be used by `Function`.  \n  \n `Flags`  \n [in] One of the flags values, as defined for the Win32 `QueueUserWorkItem` method, that control execution.  \n  \n## Return Value  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|`QueueUserWorkItem` returned successfully.|  \n|HOST_E_CLRNOTAVAILABLE|The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.|  \n|HOST_E_TIMEOUT|The call timed out.|  \n|HOST_E_NOT_OWNER|The caller does not own the lock.|  \n|HOST_E_ABANDONED|An event was canceled while a blocked thread or fiber was waiting on it.|  \n|E_FAIL|An unknown catastrophic failure occurred. When a method returns E_FAIL, the CLR is no longer usable within the process. Subsequent calls to hosting methods return HOST_E_CLRNOTAVAILABLE.|  \n  \n## Remarks  \n `QueueUserWorkItem` queues a work item to a worker thread in the thread pool. Its signature and parameter types are identical to those of the corresponding Win32 function, which has the same name. For more information, see the Windows Platform documentation.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.h  \n  \n **Library:** Included as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]  \n  \n## See Also  \n <xref:System.Threading.ThreadPool.QueueUserWorkItem%2A>   \n <xref:System.Threading.ThreadPool>   \n [IHostThreadPoolManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-interface.md)","nodes":[{"pos":[4,756],"embed":true,"restype":"x-metadata","content":"title: \"IHostThreadPoolManager::QueueUserWorkItem Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IHostThreadPoolManager.QueueUserWorkItem\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IHostThreadPoolManager::QueueUserWorkItem\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IHostThreadPoolManager::QueueUserWorkItem method [.NET Framework hosting]\"\n  - \"QueueUserWorkItem method [.NET Framework hosting]\"\nms.assetid: 41602053-8670-4827-9d61-cbfcba509b9c\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 10\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"IHostThreadPoolManager::QueueUserWorkItem Method | Microsoft Docs","nodes":[{"pos":[0,65],"content":"IHostThreadPoolManager::QueueUserWorkItem Method | Microsoft Docs","nodes":[{"content":"IHostThreadPoolManager::QueueUserWorkItem Method | Microsoft Docs","pos":[0,65]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[763,811],"content":"IHostThreadPoolManager::QueueUserWorkItem Method","linkify":"IHostThreadPoolManager::QueueUserWorkItem Method","nodes":[{"content":"IHostThreadPoolManager::QueueUserWorkItem Method","pos":[0,48]}]},{"content":"Queues a function for execution, and specifies an object containing data to be used by that function.","pos":[812,913]},{"content":"The function executes when a thread becomes available.","pos":[914,968]},{"pos":[977,983],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1137,1147],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A function pointer that represents the function to execute.","pos":[1165,1229]},{"content":"[in] An object that contains data to be used by <ph id=\"ph1\">`Function`</ph>.","pos":[1249,1308],"source":"[in] An object that contains data to be used by `Function`."},{"content":"[in] One of the flags values, as defined for the Win32 <ph id=\"ph1\">`QueueUserWorkItem`</ph> method, that control execution.","pos":[1326,1432],"source":"[in] One of the flags values, as defined for the Win32 `QueueUserWorkItem` method, that control execution."},{"pos":[1441,1453],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"HRESULT","pos":[1460,1467]},{"content":"Description","pos":[1468,1479]},{"content":"S_OK","pos":[1520,1524]},{"pos":[1525,1567],"content":"<ph id=\"ph1\">`QueueUserWorkItem`</ph> returned successfully.","source":"`QueueUserWorkItem` returned successfully."},{"content":"HOST_E_CLRNOTAVAILABLE","pos":[1572,1594]},{"content":"The common language runtime (CLR) has not been loaded into a process, or the CLR is in a state in which it cannot run managed code or process the call successfully.","pos":[1595,1759]},{"content":"HOST_E_TIMEOUT","pos":[1764,1778]},{"content":"The call timed out.","pos":[1779,1798]},{"content":"HOST_E_NOT_OWNER","pos":[1803,1819]},{"content":"The caller does not own the lock.","pos":[1820,1853]},{"content":"HOST_E_ABANDONED","pos":[1858,1874]},{"content":"An event was canceled while a blocked thread or fiber was waiting on it.","pos":[1875,1947]},{"content":"E_FAIL","pos":[1952,1958]},{"content":"An unknown catastrophic failure occurred.","pos":[1959,2000]},{"content":"When a method returns E_FAIL, the CLR is no longer usable within the process.","pos":[2001,2078]},{"content":"Subsequent calls to hosting methods return HOST_E_CLRNOTAVAILABLE.","pos":[2079,2145]},{"pos":[2155,2162],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`QueueUserWorkItem`</ph> queues a work item to a worker thread in the thread pool.","pos":[2166,2243],"source":"`QueueUserWorkItem` queues a work item to a worker thread in the thread pool."},{"content":"Its signature and parameter types are identical to those of the corresponding Win32 function, which has the same name.","pos":[2244,2362]},{"content":"For more information, see the Windows Platform documentation.","pos":[2363,2424]},{"pos":[2433,2445],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2449,2553],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[2560,2581],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.h","source":"**Header:** MSCorEE.h"},{"pos":[2588,2638],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Included as a resource in MSCorEE.dll","source":"**Library:** Included as a resource in MSCorEE.dll"},{"pos":[2645,2753],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v20plus](../../../../includes/net-current-v20plus-md.md)]"},{"pos":[2762,2770],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<ph id=\"ph1\">&lt;xref:System.Threading.ThreadPool.QueueUserWorkItem%2A&gt;</ph>","pos":[2774,2829],"source":"<xref:System.Threading.ThreadPool.QueueUserWorkItem%2A> "},{"content":"<ph id=\"ph1\">&lt;xref:System.Threading.ThreadPool&gt;</ph>","pos":[2834,2868],"source":"<xref:System.Threading.ThreadPool> "},{"content":"<bpt id=\"p1\">[</bpt>IHostThreadPoolManager Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-interface.md)</ept>","pos":[2873,2993],"source":"[IHostThreadPoolManager Interface](../../../../docs/framework/unmanaged-api/hosting/ihostthreadpoolmanager-interface.md)"}]}