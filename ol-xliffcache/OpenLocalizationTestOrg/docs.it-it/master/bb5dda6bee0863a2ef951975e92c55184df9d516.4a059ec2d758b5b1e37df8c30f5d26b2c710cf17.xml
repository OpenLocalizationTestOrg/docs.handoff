{"content":"---\ntitle: \"Valid Content of XElement and XDocument Objects2\"\nms.date: 07/20/2015\nms.assetid: 400bb692-478a-40b6-ac1b-4ccbb4cbbd02\n---\n# Valid Content of XElement and XDocument Objects\nThis topic describes the valid arguments that can be passed to constructors and methods that you use to add content to elements and documents.  \n  \n## Valid Content  \n Queries often evaluate to <xref:System.Collections.Generic.IEnumerable%601> of <xref:System.Xml.Linq.XElement> or <xref:System.Collections.Generic.IEnumerable%601> of <xref:System.Xml.Linq.XAttribute>. You can pass collections of <xref:System.Xml.Linq.XElement> or <xref:System.Xml.Linq.XAttribute> objects to the <xref:System.Xml.Linq.XElement> constructor. Therefore, it is convenient to pass the results of a query as content into methods and constructors that you use to populate XML trees.  \n  \n When adding simple content, various types can be passed to this method. Valid types include the following:  \n  \n-   <xref:System.String>  \n  \n-   <xref:System.Double>  \n  \n-   <xref:System.Single>  \n  \n-   <xref:System.Decimal>  \n  \n-   <xref:System.Boolean>  \n  \n-   <xref:System.DateTime>  \n  \n-   <xref:System.TimeSpan>  \n  \n-   <xref:System.DateTimeOffset>  \n  \n-   Any type that implements `Object.ToString`.  \n  \n-   Any type that implements <xref:System.Collections.Generic.IEnumerable%601>.  \n  \n When adding complex content, various types can be passed to this method:  \n  \n-   <xref:System.Xml.Linq.XObject>  \n  \n-   <xref:System.Xml.Linq.XNode>  \n  \n-   <xref:System.Xml.Linq.XAttribute>  \n  \n-   Any type that implements <xref:System.Collections.Generic.IEnumerable%601>  \n  \n If an object implements <xref:System.Collections.Generic.IEnumerable%601>, the collection in the object is enumerated, and all items in the collection are added. If the collection contains <xref:System.Xml.Linq.XNode> or <xref:System.Xml.Linq.XAttribute> objects, each item in the collection is added separately. If the collection contains text (or objects that are converted to text), the text in the collection is concatenated and added as a single text node.  \n  \n If content is `null`, nothing is added. When passing a collection items in the collection can be `null`. A `null` item in the collection has no effect on the tree.  \n  \n An added attribute must have a unique name within its containing element.  \n  \n When adding <xref:System.Xml.Linq.XNode> or <xref:System.Xml.Linq.XAttribute> objects, if the new content has no parent, then the objects are simply attached to the XML tree. If the new content already is parented and is part of another XML tree, then the new content is cloned, and the newly cloned content is attached to the XML tree.  \n  \n## Valid Content for Documents  \n Attributes and simple content cannot be added to a document.  \n  \n There are not many scenarios that require you to create an <xref:System.Xml.Linq.XDocument>. Instead, you can usually create your XML trees with an <xref:System.Xml.Linq.XElement> root node. Unless you have a specific requirement to create a document (for example, because you have to create processing instructions and comments at the top level, or you have to support document types), it is often more convenient to use <xref:System.Xml.Linq.XElement> as your root node.  \n  \n Valid content for a document includes the following:  \n  \n-   Zero or one <xref:System.Xml.Linq.XDocumentType> objects. The document types must come before the element.  \n  \n-   Zero or one element.  \n  \n-   Zero or more comments.  \n  \n-   Zero or more processing instructions.  \n  \n-   Zero or more text nodes that contain only white space.  \n  \n## Constructors and Functions that Allow Adding Content  \n The following methods allow you to add child content to an <xref:System.Xml.Linq.XElement> or an <xref:System.Xml.Linq.XDocument>:  \n  \n|Method|Description|  \n|------------|-----------------|  \n|<xref:System.Xml.Linq.XElement.%23ctor%2A>|Constructs an <xref:System.Xml.Linq.XElement>.|  \n|<xref:System.Xml.Linq.XDocument.%23ctor%2A>|Constructs a <xref:System.Xml.Linq.XDocument>.|  \n|<xref:System.Xml.Linq.XContainer.Add%2A>|Adds to the end of the child content of the <xref:System.Xml.Linq.XElement> or <xref:System.Xml.Linq.XDocument>.|  \n|<xref:System.Xml.Linq.XNode.AddAfterSelf%2A>|Adds content after the <xref:System.Xml.Linq.XNode>.|  \n|<xref:System.Xml.Linq.XNode.AddBeforeSelf%2A>|Adds content before the <xref:System.Xml.Linq.XNode>.|  \n|<xref:System.Xml.Linq.XContainer.AddFirst%2A>|Adds content at the beginning of the child content of the <xref:System.Xml.Linq.XContainer>.|  \n|<xref:System.Xml.Linq.XElement.ReplaceAll%2A>|Replaces all content (child nodes and attributes) of an <xref:System.Xml.Linq.XElement>.|  \n|<xref:System.Xml.Linq.XElement.ReplaceAttributes%2A>|Replaces the attributes of an <xref:System.Xml.Linq.XElement>.|  \n|<xref:System.Xml.Linq.XContainer.ReplaceNodes%2A>|Replaces the children nodes with new content.|  \n|<xref:System.Xml.Linq.XNode.ReplaceWith%2A>|Replaces a node with new content.|  \n  \n## See also\n\n- [Creating XML Trees (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/creating-xml-trees.md)\n","nodes":[{"pos":[4,130],"embed":true,"restype":"x-metadata","content":"title: \"Valid Content of XElement and XDocument Objects2\"\nms.date: 07/20/2015\nms.assetid: 400bb692-478a-40b6-ac1b-4ccbb4cbbd02","nodes":[{"content":"Valid Content of XElement and XDocument Objects2","nodes":[{"pos":[0,48],"content":"Valid Content of XElement and XDocument Objects2","nodes":[{"content":"Valid Content of XElement and XDocument Objects2","pos":[0,48]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[137,184],"content":"Valid Content of XElement and XDocument Objects","linkify":"Valid Content of XElement and XDocument Objects","nodes":[{"content":"Valid Content of XElement and XDocument Objects","pos":[0,47]}]},{"content":"This topic describes the valid arguments that can be passed to constructors and methods that you use to add content to elements and documents.","pos":[185,327]},{"pos":[336,349],"content":"Valid Content","linkify":"Valid Content","nodes":[{"content":"Valid Content","pos":[0,13]}]},{"content":"Queries often evaluate to <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> of <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph> of <ph id=\"ph4\">&lt;xref:System.Xml.Linq.XAttribute&gt;</ph>.","pos":[353,554],"source":"Queries often evaluate to <xref:System.Collections.Generic.IEnumerable%601> of <xref:System.Xml.Linq.XElement> or <xref:System.Collections.Generic.IEnumerable%601> of <xref:System.Xml.Linq.XAttribute>."},{"content":"You can pass collections of <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XAttribute&gt;</ph> objects to the <ph id=\"ph3\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> constructor.","pos":[555,711],"source":" You can pass collections of <xref:System.Xml.Linq.XElement> or <xref:System.Xml.Linq.XAttribute> objects to the <xref:System.Xml.Linq.XElement> constructor."},{"content":"Therefore, it is convenient to pass the results of a query as content into methods and constructors that you use to populate XML trees.","pos":[712,847]},{"content":"When adding simple content, various types can be passed to this method.","pos":[854,925]},{"content":"Valid types include the following:","pos":[926,960]},{"pos":[1224,1267],"content":"Any type that implements <ph id=\"ph1\">`Object.ToString`</ph>.","source":"Any type that implements `Object.ToString`."},{"pos":[1277,1352],"content":"Any type that implements <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph>.","source":"Any type that implements <xref:System.Collections.Generic.IEnumerable%601>."},{"content":"When adding complex content, various types can be passed to this method:","pos":[1359,1431]},{"pos":[1562,1636],"content":"Any type that implements <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph>","source":"Any type that implements <xref:System.Collections.Generic.IEnumerable%601>"},{"content":"If an object implements <ph id=\"ph1\">&lt;xref:System.Collections.Generic.IEnumerable%601&gt;</ph>, the collection in the object is enumerated, and all items in the collection are added.","pos":[1643,1804],"source":"If an object implements <xref:System.Collections.Generic.IEnumerable%601>, the collection in the object is enumerated, and all items in the collection are added."},{"content":"If the collection contains <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XNode&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XAttribute&gt;</ph> objects, each item in the collection is added separately.","pos":[1805,1955],"source":" If the collection contains <xref:System.Xml.Linq.XNode> or <xref:System.Xml.Linq.XAttribute> objects, each item in the collection is added separately."},{"content":"If the collection contains text (or objects that are converted to text), the text in the collection is concatenated and added as a single text node.","pos":[1956,2104]},{"content":"If content is <ph id=\"ph1\">`null`</ph>, nothing is added.","pos":[2111,2150],"source":"If content is `null`, nothing is added."},{"content":"When passing a collection items in the collection can be <ph id=\"ph1\">`null`</ph>.","pos":[2151,2215],"source":" When passing a collection items in the collection can be `null`."},{"content":"A <ph id=\"ph1\">`null`</ph> item in the collection has no effect on the tree.","pos":[2216,2274],"source":" A `null` item in the collection has no effect on the tree."},{"content":"An added attribute must have a unique name within its containing element.","pos":[2281,2354]},{"content":"When adding <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XNode&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XAttribute&gt;</ph> objects, if the new content has no parent, then the objects are simply attached to the XML tree.","pos":[2361,2535],"source":"When adding <xref:System.Xml.Linq.XNode> or <xref:System.Xml.Linq.XAttribute> objects, if the new content has no parent, then the objects are simply attached to the XML tree."},{"content":"If the new content already is parented and is part of another XML tree, then the new content is cloned, and the newly cloned content is attached to the XML tree.","pos":[2536,2697]},{"pos":[2706,2733],"content":"Valid Content for Documents","linkify":"Valid Content for Documents","nodes":[{"content":"Valid Content for Documents","pos":[0,27]}]},{"content":"Attributes and simple content cannot be added to a document.","pos":[2737,2797]},{"content":"There are not many scenarios that require you to create an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph>.","pos":[2804,2896],"source":"There are not many scenarios that require you to create an <xref:System.Xml.Linq.XDocument>."},{"content":"Instead, you can usually create your XML trees with an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> root node.","pos":[2897,2994],"source":" Instead, you can usually create your XML trees with an <xref:System.Xml.Linq.XElement> root node."},{"content":"Unless you have a specific requirement to create a document (for example, because you have to create processing instructions and comments at the top level, or you have to support document types), it is often more convenient to use <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> as your root node.","pos":[2995,3276],"source":" Unless you have a specific requirement to create a document (for example, because you have to create processing instructions and comments at the top level, or you have to support document types), it is often more convenient to use <xref:System.Xml.Linq.XElement> as your root node."},{"content":"Valid content for a document includes the following:","pos":[3283,3335]},{"content":"Zero or one <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocumentType&gt;</ph> objects.","pos":[3345,3402],"source":"Zero or one <xref:System.Xml.Linq.XDocumentType> objects."},{"content":"The document types must come before the element.","pos":[3403,3451]},{"content":"Zero or one element.","pos":[3461,3481]},{"content":"Zero or more comments.","pos":[3491,3513]},{"content":"Zero or more processing instructions.","pos":[3523,3560]},{"content":"Zero or more text nodes that contain only white space.","pos":[3570,3624]},{"pos":[3633,3685],"content":"Constructors and Functions that Allow Adding Content","linkify":"Constructors and Functions that Allow Adding Content","nodes":[{"content":"Constructors and Functions that Allow Adding Content","pos":[0,52]}]},{"pos":[3689,3819],"content":"The following methods allow you to add child content to an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> or an <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph>:","source":"The following methods allow you to add child content to an <xref:System.Xml.Linq.XElement> or an <xref:System.Xml.Linq.XDocument>:"},{"content":"Method","pos":[3826,3832]},{"content":"Description","pos":[3833,3844]},{"pos":[3927,3973],"content":"Constructs an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph>.","source":"Constructs an <xref:System.Xml.Linq.XElement>."},{"pos":[4022,4068],"content":"Constructs a <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph>.","source":"Constructs a <xref:System.Xml.Linq.XDocument>."},{"pos":[4114,4226],"content":"Adds to the end of the child content of the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Xml.Linq.XDocument&gt;</ph>.","source":"Adds to the end of the child content of the <xref:System.Xml.Linq.XElement> or <xref:System.Xml.Linq.XDocument>."},{"pos":[4276,4328],"content":"Adds content after the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XNode&gt;</ph>.","source":"Adds content after the <xref:System.Xml.Linq.XNode>."},{"pos":[4379,4432],"content":"Adds content before the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XNode&gt;</ph>.","source":"Adds content before the <xref:System.Xml.Linq.XNode>."},{"pos":[4483,4575],"content":"Adds content at the beginning of the child content of the <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XContainer&gt;</ph>.","source":"Adds content at the beginning of the child content of the <xref:System.Xml.Linq.XContainer>."},{"pos":[4626,4714],"content":"Replaces all content (child nodes and attributes) of an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph>.","source":"Replaces all content (child nodes and attributes) of an <xref:System.Xml.Linq.XElement>."},{"pos":[4772,4834],"content":"Replaces the attributes of an <ph id=\"ph1\">&lt;xref:System.Xml.Linq.XElement&gt;</ph>.","source":"Replaces the attributes of an <xref:System.Xml.Linq.XElement>."},{"content":"Replaces the children nodes with new content.","pos":[4889,4934]},{"content":"Replaces a node with new content.","pos":[4983,5016]},{"pos":[5026,5034],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5038,5153],"content":"<bpt id=\"p1\">[</bpt>Creating XML Trees (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/creating-xml-trees.md)</ept>","source":"[Creating XML Trees (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/creating-xml-trees.md)"}]}