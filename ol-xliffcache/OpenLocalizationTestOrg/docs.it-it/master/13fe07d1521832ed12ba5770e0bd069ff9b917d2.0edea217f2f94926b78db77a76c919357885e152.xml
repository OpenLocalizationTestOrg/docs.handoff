{"content":"---\ntitle: \"Channel Model Overview\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"channel model [WCF]\"\nms.assetid: 07a81e11-3911-4632-90d2-cca99825b5bd\n---\n# Channel Model Overview\nThe Windows Communication Foundation (WCF) channel stack is a layered communication stack with one or more channels that process messages. At the bottom of the stack is a transport channel that is responsible for adapting the channel stack to the underlying transport (for example, TCP, HTTP, SMTP and other types of transport.). Channels provide a low-level programming model for sending and receiving messages. This programming model relies on several interfaces and other types collectively known as the WCF channel model. This topic discusses channel shapes, the construction of a basic channel listener (on the service) and channel factory (on the client).  \n  \n## Channel Stack  \n WCF endpoints communicate with the world using a communication stack called the channel stack. The following diagram compares the channel stack with other communication stacks, for example TCP/IP.  \n  \n ![Channel Model](../../../../docs/framework/wcf/extending/media/wcfc-channelstackhighlevelc.gif \"wcfc_ChannelStackHighLevelc\")  \n  \n First, the similarities: In both cases, each layer of the stack provides some abstraction of the world below that layer and exposed that abstraction only to the layer directly above it. Each layer uses the abstraction of only the layer directly below it. Also in both cases, when two stacks communicate, each layer communicates with the corresponding layer in the other stack, for example, the IP layer communicates with the IP layer and the TCP layer with the TCP layer, and so on.  \n  \n Now, the differences: While the TCP stack was designed to provide an abstraction of the physical network, the channel stack is designed to provide an abstraction of not only how the message is delivered, that is, the transport, but also other features such as what is in the message or what protocol is used for communication, including the transport but much more than that. For example, reliable session binding element is part of the channel stack but is not below the transport or the transport itself. This abstraction is achieved by requiring the bottom channel in the stack to adapt the underlying transport protocol to the channel stack architecture and then relying on channels further up in the stack to provide communication features such as reliability guarantees and security.  \n  \n Messages flow through the communication stack as <xref:System.ServiceModel.Channels.Message> objects. As shown in figure above, the bottom channel is called a transport channel. It is the channel that is responsible for sending and receiving messages to and from other parties. This includes the responsibility of transforming the <xref:System.ServiceModel.Channels.Message> object to and from the format used to communicate with other parties. Above the transport channel there can be any number of protocol channels each responsible for providing a communication function such as reliable delivery guarantees. Protocol channels operate on messages flowing through them in the form of the <xref:System.ServiceModel.Channels.Message> object. They typically either transform the message, for example, by adding headers or encrypting the body, or send and receive their own protocol control messages, for example, receipt acknowledgments.  \n  \n## Channel Shapes  \n Each channel implements one or more interfaces known as channel shape interfaces or channel shapes. Those channel shapes provide the communication-oriented methods such as send and receive or request and reply that the channel implements and the user of the channel calls. At the base of the channel shapes is the <xref:System.ServiceModel.Channels.IChannel> interface, which is an interface that provides a `GetProperty`\\<T> method intended as a layered mechanism to access arbitrary features exposed by channels in the stack. The five channel shapes that extend <xref:System.ServiceModel.Channels.IChannel> are:  \n  \n-   <xref:System.ServiceModel.Channels.IInputChannel>  \n  \n-   <xref:System.ServiceModel.Channels.IOutputChannel>  \n  \n-   <xref:System.ServiceModel.Channels.IRequestChannel>  \n  \n-   <xref:System.ServiceModel.Channels.IReplyChannel>  \n  \n-   <xref:System.ServiceModel.Channels.IDuplexChannel>  \n  \n Further, each of these shapes has an equivalent that extends <xref:System.ServiceModel.Channels.ISessionChannel%601?displayProperty=nameWithType> to support sessions. These are:  \n  \n-   <xref:System.ServiceModel.Channels.IInputSessionChannel>  \n  \n-   <xref:System.ServiceModel.Channels.IOutputSessionChannel>  \n  \n-   <xref:System.ServiceModel.Channels.IRequestSessionChannel>  \n  \n-   <xref:System.ServiceModel.Channels.IReplySessionChannel>  \n  \n-   <xref:System.ServiceModel.Channels.IDuplexSessionChannel>  \n  \n The channel shapes are patterned after some of the fundamental message exchange patterns supported by existing transport protocols. For example, one-way messaging corresponds to an <xref:System.ServiceModel.Channels.IInputChannel>/<xref:System.ServiceModel.Channels.IOutputChannel> pair, request-reply corresponds to <xref:System.ServiceModel.Channels.IRequestChannel>/<xref:System.ServiceModel.Channels.IReplyChannel> pairs and two-way duplex communications corresponds to <xref:System.ServiceModel.Channels.IDuplexChannel> (which extends both <xref:System.ServiceModel.Channels.IInputChannel> and <xref:System.ServiceModel.Channels.IOutputChannel>).  \n  \n## Programming with the Channel Stack  \n Channel stacks are typically created using a factory pattern where a binding creates the channel stack. On the send side, a binding is used to build a <xref:System.ServiceModel.ChannelFactory>, which in turn builds a channel stack and returns a reference to the top channel in the stack. The application can then use this channel to send messages. For more information, see [Client Channel-Level Programming](../../../../docs/framework/wcf/extending/client-channel-level-programming.md).  \n  \n On the receive side a binding is used to build a <xref:System.ServiceModel.Channels.IChannelListener>, which listens for incoming messages. The <xref:System.ServiceModel.Channels.IChannelListener> provides messages to the listening application by creating channel stacks and handing the application reference to the top channel. The application then uses this channel to receive incoming messages. For more information, see [Service Channel-Level Programming](../../../../docs/framework/wcf/extending/service-channel-level-programming.md).  \n  \n## The Channel Object Model  \n The channel object model is the core set of interfaces required to implement channels, channel listeners and channel factories. There are also some base classes provided to assist in custom implementations.  \n  \n Channel listeners are responsible for listening for incoming messages, then delivering them to the layer above through channels created by the channel listener.  \n  \n Channel factories are responsible for creating channels that are used for sending messages and for closing all channels they created when the channel factory is closed.  \n  \n <xref:System.ServiceModel.ICommunicationObject> is the core interface that defines the basic state machine that all communication objects implement. <xref:System.ServiceModel.Channels.CommunicationObject> provides an implementation of this core interface that other channel classes can derive from rather than re-implementing the interface. However, this is not required: a custom channel can implement <xref:System.ServiceModel.ICommunicationObject> directly and not inherit from <xref:System.ServiceModel.Channels.CommunicationObject>. None of the classes in Figure 3 are considered part of the channel model; they are helpers available to custom channel implementers who want to build channels.  \n  \n ![Channel model](../../../../docs/framework/wcf/extending/media/wcfc-wcfcchannelsigure3omumtreec.gif \"wcfc_WCFCChannelsigure3OMUMTreec\")  \n  \n The following topics describe the channel object model as well as various development areas that help build custom channels.  \n  \n|Topic|Description|  \n|-----------|-----------------|  \n|[Service: Channel Listeners and Channels](../../../../docs/framework/wcf/extending/service-channel-listeners-and-channels.md)|Describes channel listeners, which listen for incoming channels in a service application.|  \n|[Client: Channel Factories and Channels](../../../../docs/framework/wcf/extending/client-channel-factories-and-channels.md)|Describes channel factories, which create channels to connect to a service application.|  \n|[Understanding State Changes](../../../../docs/framework/wcf/extending/understanding-state-changes.md)|Describes how the <xref:System.ServiceModel.ICommunicationObject?displayProperty=nameWithType> interface models state changes in channels.|  \n|[Choosing a Message Exchange Pattern](../../../../docs/framework/wcf/extending/choosing-a-message-exchange-pattern.md)|Describes the six basic message exchange patterns that channels can support.|  \n|[Handling Exceptions and Faults](../../../../docs/framework/wcf/extending/handling-exceptions-and-faults.md)|Describes how to handle faults and exceptions in custom channels.|  \n|[Configuration and Metadata Support](../../../../docs/framework/wcf/extending/configuration-and-metadata-support.md)|Describes how to support the use of custom channels from the application model and how to export and import metadata using bindings and binding elements.|\n","nodes":[{"pos":[4,154],"embed":true,"restype":"x-metadata","content":"title: \"Channel Model Overview\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"channel model [WCF]\"\nms.assetid: 07a81e11-3911-4632-90d2-cca99825b5bd","nodes":[{"content":"Channel Model Overview","nodes":[{"pos":[0,22],"content":"Channel Model Overview","nodes":[{"content":"Channel Model Overview","pos":[0,22]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[161,183],"content":"Channel Model Overview","linkify":"Channel Model Overview","nodes":[{"content":"Channel Model Overview","pos":[0,22]}]},{"content":"The Windows Communication Foundation (WCF) channel stack is a layered communication stack with one or more channels that process messages.","pos":[184,322]},{"content":"At the bottom of the stack is a transport channel that is responsible for adapting the channel stack to the underlying transport (for example, TCP, HTTP, SMTP and other types of transport.).","pos":[323,513]},{"content":"Channels provide a low-level programming model for sending and receiving messages.","pos":[514,596]},{"content":"This programming model relies on several interfaces and other types collectively known as the WCF channel model.","pos":[597,709]},{"content":"This topic discusses channel shapes, the construction of a basic channel listener (on the service) and channel factory (on the client).","pos":[710,845]},{"pos":[854,867],"content":"Channel Stack","linkify":"Channel Stack","nodes":[{"content":"Channel Stack","pos":[0,13]}]},{"content":"WCF endpoints communicate with the world using a communication stack called the channel stack.","pos":[871,965]},{"content":"The following diagram compares the channel stack with other communication stacks, for example TCP/IP.","pos":[966,1067]},{"pos":[1074,1200],"content":"<bpt id=\"p1\">![</bpt>Channel Model<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wcf/extending/media/wcfc-channelstackhighlevelc.gif \"</bpt>wcfc_ChannelStackHighLevelc<ept id=\"p2\">\")</ept>","source":"![Channel Model](../../../../docs/framework/wcf/extending/media/wcfc-channelstackhighlevelc.gif \"wcfc_ChannelStackHighLevelc\")"},{"content":"First, the similarities: In both cases, each layer of the stack provides some abstraction of the world below that layer and exposed that abstraction only to the layer directly above it.","pos":[1207,1392]},{"content":"Each layer uses the abstraction of only the layer directly below it.","pos":[1393,1461]},{"content":"Also in both cases, when two stacks communicate, each layer communicates with the corresponding layer in the other stack, for example, the IP layer communicates with the IP layer and the TCP layer with the TCP layer, and so on.","pos":[1462,1689]},{"content":"Now, the differences: While the TCP stack was designed to provide an abstraction of the physical network, the channel stack is designed to provide an abstraction of not only how the message is delivered, that is, the transport, but also other features such as what is in the message or what protocol is used for communication, including the transport but much more than that.","pos":[1696,2071]},{"content":"For example, reliable session binding element is part of the channel stack but is not below the transport or the transport itself.","pos":[2072,2202]},{"content":"This abstraction is achieved by requiring the bottom channel in the stack to adapt the underlying transport protocol to the channel stack architecture and then relying on channels further up in the stack to provide communication features such as reliability guarantees and security.","pos":[2203,2485]},{"content":"Messages flow through the communication stack as <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Message&gt;</ph> objects.","pos":[2492,2593],"source":"Messages flow through the communication stack as <xref:System.ServiceModel.Channels.Message> objects."},{"content":"As shown in figure above, the bottom channel is called a transport channel.","pos":[2594,2669]},{"content":"It is the channel that is responsible for sending and receiving messages to and from other parties.","pos":[2670,2769]},{"content":"This includes the responsibility of transforming the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Message&gt;</ph> object to and from the format used to communicate with other parties.","pos":[2770,2936],"source":" This includes the responsibility of transforming the <xref:System.ServiceModel.Channels.Message> object to and from the format used to communicate with other parties."},{"content":"Above the transport channel there can be any number of protocol channels each responsible for providing a communication function such as reliable delivery guarantees.","pos":[2937,3103]},{"content":"Protocol channels operate on messages flowing through them in the form of the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.Message&gt;</ph> object.","pos":[3104,3233],"source":" Protocol channels operate on messages flowing through them in the form of the <xref:System.ServiceModel.Channels.Message> object."},{"content":"They typically either transform the message, for example, by adding headers or encrypting the body, or send and receive their own protocol control messages, for example, receipt acknowledgments.","pos":[3234,3428]},{"pos":[3437,3451],"content":"Channel Shapes","linkify":"Channel Shapes","nodes":[{"content":"Channel Shapes","pos":[0,14]}]},{"content":"Each channel implements one or more interfaces known as channel shape interfaces or channel shapes.","pos":[3455,3554]},{"content":"Those channel shapes provide the communication-oriented methods such as send and receive or request and reply that the channel implements and the user of the channel calls.","pos":[3555,3727]},{"content":"At the base of the channel shapes is the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.IChannel&gt;</ph> interface, which is an interface that provides a <ph id=\"ph2\">`GetProperty`</ph><ph id=\"ph3\">\\&lt;</ph>T&gt; method intended as a layered mechanism to access arbitrary features exposed by channels in the stack.","pos":[3728,3982],"source":" At the base of the channel shapes is the <xref:System.ServiceModel.Channels.IChannel> interface, which is an interface that provides a `GetProperty`\\<T> method intended as a layered mechanism to access arbitrary features exposed by channels in the stack."},{"content":"The five channel shapes that extend <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.IChannel&gt;</ph> are:","pos":[3983,4068],"source":" The five channel shapes that extend <xref:System.ServiceModel.Channels.IChannel> are:"},{"content":"Further, each of these shapes has an equivalent that extends <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.ISessionChannel%601?displayProperty=nameWithType&gt;</ph> to support sessions.","pos":[4374,4540],"source":"Further, each of these shapes has an equivalent that extends <xref:System.ServiceModel.Channels.ISessionChannel%601?displayProperty=nameWithType> to support sessions."},{"content":"These are:","pos":[4541,4551]},{"content":"The channel shapes are patterned after some of the fundamental message exchange patterns supported by existing transport protocols.","pos":[4892,5023]},{"content":"For example, one-way messaging corresponds to an <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.IInputChannel&gt;</ph><ph id=\"ph2\">/</ph><ph id=\"ph3\">&lt;xref:System.ServiceModel.Channels.IOutputChannel&gt;</ph> pair, request-reply corresponds to <ph id=\"ph4\">&lt;xref:System.ServiceModel.Channels.IRequestChannel&gt;</ph><ph id=\"ph5\">/</ph><ph id=\"ph6\">&lt;xref:System.ServiceModel.Channels.IReplyChannel&gt;</ph> pairs and two-way duplex communications corresponds to <ph id=\"ph7\">&lt;xref:System.ServiceModel.Channels.IDuplexChannel&gt;</ph> (which extends both <ph id=\"ph8\">&lt;xref:System.ServiceModel.Channels.IInputChannel&gt;</ph> and <ph id=\"ph9\">&lt;xref:System.ServiceModel.Channels.IOutputChannel&gt;</ph>).","pos":[5024,5543],"source":" For example, one-way messaging corresponds to an <xref:System.ServiceModel.Channels.IInputChannel>/<xref:System.ServiceModel.Channels.IOutputChannel> pair, request-reply corresponds to <xref:System.ServiceModel.Channels.IRequestChannel>/<xref:System.ServiceModel.Channels.IReplyChannel> pairs and two-way duplex communications corresponds to <xref:System.ServiceModel.Channels.IDuplexChannel> (which extends both <xref:System.ServiceModel.Channels.IInputChannel> and <xref:System.ServiceModel.Channels.IOutputChannel>)."},{"pos":[5552,5586],"content":"Programming with the Channel Stack","linkify":"Programming with the Channel Stack","nodes":[{"content":"Programming with the Channel Stack","pos":[0,34]}]},{"content":"Channel stacks are typically created using a factory pattern where a binding creates the channel stack.","pos":[5590,5693]},{"content":"On the send side, a binding is used to build a <ph id=\"ph1\">&lt;xref:System.ServiceModel.ChannelFactory&gt;</ph>, which in turn builds a channel stack and returns a reference to the top channel in the stack.","pos":[5694,5877],"source":" On the send side, a binding is used to build a <xref:System.ServiceModel.ChannelFactory>, which in turn builds a channel stack and returns a reference to the top channel in the stack."},{"content":"The application can then use this channel to send messages.","pos":[5878,5937]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Client Channel-Level Programming<ept id=\"p1\">](../../../../docs/framework/wcf/extending/client-channel-level-programming.md)</ept>.","pos":[5938,6077],"source":" For more information, see [Client Channel-Level Programming](../../../../docs/framework/wcf/extending/client-channel-level-programming.md)."},{"content":"On the receive side a binding is used to build a <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.IChannelListener&gt;</ph>, which listens for incoming messages.","pos":[6084,6223],"source":"On the receive side a binding is used to build a <xref:System.ServiceModel.Channels.IChannelListener>, which listens for incoming messages."},{"content":"The <ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.IChannelListener&gt;</ph> provides messages to the listening application by creating channel stacks and handing the application reference to the top channel.","pos":[6224,6412],"source":" The <xref:System.ServiceModel.Channels.IChannelListener> provides messages to the listening application by creating channel stacks and handing the application reference to the top channel."},{"content":"The application then uses this channel to receive incoming messages.","pos":[6413,6481]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Service Channel-Level Programming<ept id=\"p1\">](../../../../docs/framework/wcf/extending/service-channel-level-programming.md)</ept>.","pos":[6482,6623],"source":" For more information, see [Service Channel-Level Programming](../../../../docs/framework/wcf/extending/service-channel-level-programming.md)."},{"pos":[6632,6656],"content":"The Channel Object Model","linkify":"The Channel Object Model","nodes":[{"content":"The Channel Object Model","pos":[0,24]}]},{"content":"The channel object model is the core set of interfaces required to implement channels, channel listeners and channel factories.","pos":[6660,6787]},{"content":"There are also some base classes provided to assist in custom implementations.","pos":[6788,6866]},{"content":"Channel listeners are responsible for listening for incoming messages, then delivering them to the layer above through channels created by the channel listener.","pos":[6873,7033]},{"content":"Channel factories are responsible for creating channels that are used for sending messages and for closing all channels they created when the channel factory is closed.","pos":[7040,7208]},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.ICommunicationObject&gt;</ph> is the core interface that defines the basic state machine that all communication objects implement.","pos":[7215,7363],"source":"<xref:System.ServiceModel.ICommunicationObject> is the core interface that defines the basic state machine that all communication objects implement."},{"content":"<ph id=\"ph1\">&lt;xref:System.ServiceModel.Channels.CommunicationObject&gt;</ph> provides an implementation of this core interface that other channel classes can derive from rather than re-implementing the interface.","pos":[7364,7555],"source":"<xref:System.ServiceModel.Channels.CommunicationObject> provides an implementation of this core interface that other channel classes can derive from rather than re-implementing the interface."},{"content":"However, this is not required: a custom channel can implement <ph id=\"ph1\">&lt;xref:System.ServiceModel.ICommunicationObject&gt;</ph> directly and not inherit from <ph id=\"ph2\">&lt;xref:System.ServiceModel.Channels.CommunicationObject&gt;</ph>.","pos":[7556,7752],"source":" However, this is not required: a custom channel can implement <xref:System.ServiceModel.ICommunicationObject> directly and not inherit from <xref:System.ServiceModel.Channels.CommunicationObject>."},{"content":"None of the classes in Figure 3 are considered part of the channel model; they are helpers available to custom channel implementers who want to build channels.","pos":[7753,7912]},{"pos":[7919,8055],"content":"<bpt id=\"p1\">![</bpt>Channel model<ept id=\"p1\">]</ept><bpt id=\"p2\">(../../../../docs/framework/wcf/extending/media/wcfc-wcfcchannelsigure3omumtreec.gif \"</bpt>wcfc_WCFCChannelsigure3OMUMTreec<ept id=\"p2\">\")</ept>","source":"![Channel model](../../../../docs/framework/wcf/extending/media/wcfc-wcfcchannelsigure3omumtreec.gif \"wcfc_WCFCChannelsigure3OMUMTreec\")"},{"content":"The following topics describe the channel object model as well as various development areas that help build custom channels.","pos":[8062,8186]},{"content":"Topic","pos":[8193,8198]},{"content":"Description","pos":[8199,8210]},{"pos":[8249,8374],"content":"<bpt id=\"p1\">[</bpt>Service: Channel Listeners and Channels<ept id=\"p1\">](../../../../docs/framework/wcf/extending/service-channel-listeners-and-channels.md)</ept>","source":"[Service: Channel Listeners and Channels](../../../../docs/framework/wcf/extending/service-channel-listeners-and-channels.md)"},{"content":"Describes channel listeners, which listen for incoming channels in a service application.","pos":[8375,8464]},{"pos":[8469,8592],"content":"<bpt id=\"p1\">[</bpt>Client: Channel Factories and Channels<ept id=\"p1\">](../../../../docs/framework/wcf/extending/client-channel-factories-and-channels.md)</ept>","source":"[Client: Channel Factories and Channels](../../../../docs/framework/wcf/extending/client-channel-factories-and-channels.md)"},{"content":"Describes channel factories, which create channels to connect to a service application.","pos":[8593,8680]},{"pos":[8685,8787],"content":"<bpt id=\"p1\">[</bpt>Understanding State Changes<ept id=\"p1\">](../../../../docs/framework/wcf/extending/understanding-state-changes.md)</ept>","source":"[Understanding State Changes](../../../../docs/framework/wcf/extending/understanding-state-changes.md)"},{"pos":[8788,8926],"content":"Describes how the <ph id=\"ph1\">&lt;xref:System.ServiceModel.ICommunicationObject?displayProperty=nameWithType&gt;</ph> interface models state changes in channels.","source":"Describes how the <xref:System.ServiceModel.ICommunicationObject?displayProperty=nameWithType> interface models state changes in channels."},{"pos":[8931,9049],"content":"<bpt id=\"p1\">[</bpt>Choosing a Message Exchange Pattern<ept id=\"p1\">](../../../../docs/framework/wcf/extending/choosing-a-message-exchange-pattern.md)</ept>","source":"[Choosing a Message Exchange Pattern](../../../../docs/framework/wcf/extending/choosing-a-message-exchange-pattern.md)"},{"content":"Describes the six basic message exchange patterns that channels can support.","pos":[9050,9126]},{"pos":[9131,9239],"content":"<bpt id=\"p1\">[</bpt>Handling Exceptions and Faults<ept id=\"p1\">](../../../../docs/framework/wcf/extending/handling-exceptions-and-faults.md)</ept>","source":"[Handling Exceptions and Faults](../../../../docs/framework/wcf/extending/handling-exceptions-and-faults.md)"},{"content":"Describes how to handle faults and exceptions in custom channels.","pos":[9240,9305]},{"pos":[9310,9426],"content":"<bpt id=\"p1\">[</bpt>Configuration and Metadata Support<ept id=\"p1\">](../../../../docs/framework/wcf/extending/configuration-and-metadata-support.md)</ept>","source":"[Configuration and Metadata Support](../../../../docs/framework/wcf/extending/configuration-and-metadata-support.md)"},{"content":"Describes how to support the use of custom channels from the application model and how to export and import metadata using bindings and binding elements.","pos":[9427,9580]}]}