{"content":"---\ntitle: \"Connection Strings and Configuration Files | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 37df2641-661e-407a-a3fb-7bf9540f01e8\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"\n---\n# Connection Strings and Configuration Files\nEmbedding connection strings in your application's code can lead to security vulnerabilities and maintenance problems. Unencrypted connection strings compiled into an application's source code can be viewed using the [Ildasm.exe (IL Disassembler)](../../../../docs/framework/tools/ildasm-exe-il-disassembler.md) tool. Moreover, if the connection string ever changes, your application must be recompiled. For these reasons, we recommend storing connection strings in an application configuration file.  \n  \n## Working with Application Configuration Files  \n Application configuration files contain settings that are specific to a particular application. For example, an ASP.NET application can have one or more **web.config** files, and a Windows application can have an optional **app.config** file. Configuration files share common elements, although the name and location of a configuration file vary depending on the application's host.  \n  \n### The connectionStrings Section  \n Connection strings can be stored as key/value pairs in the **connectionStrings** section of the **configuration** element of an application configuration file. Child elements include **add**, **clear**, and **remove**.  \n  \n The following configuration file fragment demonstrates the schema and syntax for storing a connection string. The **name** attribute is a name that you provide to uniquely identify a connection string so that it can be retrieved at run time. The **providerName** is the invariant name of the .NET Framework data provider, which is registered in the machine.config file.  \n  \n```  \n<?xml version='1.0' encoding='utf-8'?>  \n  <configuration>  \n    <connectionStrings>  \n      <clear />  \n      <add name=\"Name\"   \n       providerName=\"System.Data.ProviderName\"   \n       connectionString=\"Valid Connection String;\" />  \n    </connectionStrings>  \n  </configuration>  \n```  \n  \n> [!NOTE]\n>  You can save part of a connection string in a configuration file and use the <xref:System.Data.Common.DbConnectionStringBuilder> class to complete it at run time. This is useful in scenarios where you do not know elements of the connection string ahead of time, or when you do not want to save sensitive information in a configuration file. For more information, see [Connection String Builders](../../../../docs/framework/data/adonet/connection-string-builders.md).  \n  \n### Using External Configuration Files  \n External configuration files are separate files that contain a fragment of a configuration file consisting of a single section. The external configuration file is then referenced by the main configuration file. Storing the **connectionStrings** section in a physically separate file is useful in situations where connection strings may be edited after the application is deployed. For example, the standard ASP.NET behavior is to restart an application domain when configuration files are modified, which results in state information being lost. However, modifying an external configuration file does not cause an application restart. External configuration files are not limited to ASP.NET; they can also be used by Windows applications. In addition, file access security and permissions can be used to restrict access to external configuration files. Working with external configuration files at run time is transparent, and requires no special coding.  \n  \n To store connection strings in an external configuration file, create a separate file that contains only the **connectionStrings** section. Do not include any additional elements, sections, or attributes. This example shows the syntax for an external configuration file.  \n  \n```  \n<connectionStrings>  \n  <add name=\"Name\"   \n   providerName=\"System.Data.ProviderName\"   \n   connectionString=\"Valid Connection String;\" />  \n</connectionStrings>  \n```  \n  \n In the main application configuration file, you use the **configSource** attribute to specify the fully qualified name and location of the external file. This example refers to an external configuration file named `connections.config`.  \n  \n```  \n<?xml version='1.0' encoding='utf-8'?>  \n<configuration>  \n    <connectionStrings configSource=\"connections.config\"/>  \n</configuration>  \n```  \n  \n## Retrieving Connection Strings at Run Time  \n The .NET Framework 2.0 introduced new classes in the <xref:System.Configuration> namespace to simplify retrieving connection strings from configuration files at run time. You can programmatically retrieve a connection string by name or by provider name.  \n  \n> [!NOTE]\n>  The **machine.config** file also contains a **connectionStrings** section, which contains connection strings used by Visual Studio. When retrieving connection strings by provider name from the **app.config** file in a Windows application, the connection strings in **machine.config** get loaded first, and then the entries from **app.config**. Adding **clear** immediately after the **connectionStrings** element removes all inherited references from the data structure in memory, so that only the connection strings defined in the local **app.config** file are considered.  \n  \n### Working with the Configuration Classes  \n Starting with the .NET Framework 2.0, <xref:System.Configuration.ConfigurationManager> is used when working with configuration files on the local computer, replacing the deprecated <xref:System.Configuration.ConfigurationSettings>. <xref:System.Web.Configuration.WebConfigurationManager> is used to work with ASP.NET configuration files. It is designed to work with configuration files on a Web server, and allows programmatic access to configuration file sections such as **system.web**.  \n  \n> [!NOTE]\n>  Accessing configuration files at run time requires granting permissions to the caller; the required permissions depend on the type of application, configuration file, and location. For more information, see [Using the Configuration Classes](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc) and <xref:System.Web.Configuration.WebConfigurationManager> for ASP.NET applications, and <xref:System.Configuration.ConfigurationManager> for Windows applications.  \n  \n You can use the <xref:System.Configuration.ConnectionStringSettingsCollection> to retrieve connection strings from application configuration files. It contains a collection of <xref:System.Configuration.ConnectionStringSettings> objects, each of which represents a single entry in the **connectionStrings** section. Its properties map to connection string attributes, allowing you to retrieve a connection string by specifying the name or the provider name.  \n  \n|Property|Description|  \n|--------------|-----------------|  \n|<xref:System.Configuration.ConnectionStringSettings.Name%2A>|The name of the connection string. Maps to the **name** attribute.|  \n|<xref:System.Configuration.ConnectionStringSettings.ProviderName%2A>|The fully qualified provider name. Maps to the **providerName** attribute.|  \n|<xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A>|The connection string. Maps to the **connectionString** attribute.|  \n  \n### Example: Listing All Connection Strings  \n This example iterates through the `ConnectionStringSettings` collection and displays the <xref:System.Configuration.ConnectionStringSettings.Name%2A>, <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A>, and <xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A> properties in the console window.  \n  \n> [!NOTE]\n>  System.Configuration.dll is not included in all project types, and you may need to set a reference to it in order to use the configuration classes. The name and location of a particular application configuration file varies by the type of application and the hosting process.  \n  \n [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfig#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfig/CS/source.cs#1)]\n [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfig#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfig/VB/source.vb#1)]  \n  \n### Example: Retrieving a Connection String by Name  \n This example demonstrates how to retrieve a connection string from a configuration file by specifying its name. The code creates a <xref:System.Configuration.ConnectionStringSettings> object, matching the supplied input parameter to the <xref:System.Configuration.ConfigurationManager.ConnectionStrings%2A> name. If no matching name is found, the function returns `null` (`Nothing` in Visual Basic).  \n  \n [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfigByName#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByName/CS/source.cs#1)]\n [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfigByName#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByName/VB/source.vb#1)]  \n  \n### Example: Retrieving a Connection String by Provider Name  \n This example demonstrates how to retrieve a connection string by specifying the provider-invariant name in the format *System.Data.ProviderName*. The code iterates through the <xref:System.Configuration.ConnectionStringSettingsCollection> and returns the connection string for the first <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> found. If the provider name is not found, the function returns `null` (`Nothing` in Visual Basic).  \n  \n [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/CS/source.cs#1)]\n [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/VB/source.vb#1)]  \n  \n## Encrypting Configuration File Sections Using Protected Configuration  \n ASP.NET 2.0 introduced a new feature, called *protected configuration*, that enables you to encrypt sensitive information in a configuration file. Although primarily designed for ASP.NET, protected configuration can also be used to encrypt configuration file sections in Windows applications. For a detailed description of the protected configuration capabilities, see [Encrypting Configuration Information Using Protected Configuration](http://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1).  \n  \n The following configuration file fragment shows the **connectionStrings** section after it has been encrypted. The **configProtectionProvider** specifies the protected configuration provider used to encrypt and decrypt the connection strings. The **EncryptedData** section contains the cipher text.  \n  \n```  \n<connectionStrings configProtectionProvider=\"DataProtectionConfigurationProvider\">  \n  <EncryptedData>  \n    <CipherData>  \n      <CipherValue>AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAH2... </CipherValue>  \n    </CipherData>  \n  </EncryptedData>  \n</connectionStrings>  \n```  \n  \n When the encrypted connection string is retrieved at run time, the .NET Framework uses the specified provider to decrypt the **CipherValue** and make it available to your application. You do not need to write any additional code to manage the decryption process.  \n  \n### Protected Configuration Providers  \n Protected configuration providers are registered in the **configProtectedData** section of the **machine.config** file on the local computer, as shown in the following fragment, which shows the two protected configuration providers supplied with the .NET Framework. The values shown here have been truncated for readability.  \n  \n```  \n<configProtectedData defaultProvider=\"RsaProtectedConfigurationProvider\">  \n  <providers>  \n    <add name=\"RsaProtectedConfigurationProvider\"   \n      type=\"System.Configuration.RsaProtectedConfigurationProvider, ... />  \n    <add name=\"DataProtectionConfigurationProvider\"   \n      type=\"System.Configuration.DpapiProtectedConfigurationProvider, ... />  \n  </providers>  \n</configProtectedData>  \n```  \n  \n You can configure additional protected configuration providers by adding them to the **machine.config** file. You can also create your own protected configuration provider by inheriting from the <xref:System.Configuration.ProtectedConfigurationProvider> abstract base class. The following table describes the two configuration files included with the .NET Framework.  \n  \n|Provider|Description|  \n|--------------|-----------------|  \n|<!--zz<xref:System.Configuration.RSAProtectedConfigurationProvider>-->`System.Configuration.RSAProtectedConfigurationProvider`|Uses the RSA encryption algorithm to encrypt and decrypt data. The RSA algorithm can be used for both public key encryption and digital signatures. It is also known as \"public key\" or asymmetrical encryption because it employs two different keys. You can use the [ASP.NET IIS Registration Tool (Aspnet_regiis.exe)](http://msdn.microsoft.com/library/6491c41e-e2b0-481f-9863-db3614d5f96b) to encrypt sections in a Web.config file and manage the encryption keys. ASP.NET decrypts the configuration file when it processes the file. The identity of the ASP.NET application must have read access to the encryption key that is used to encrypt and decrypt the encrypted sections.|  \n|<!--zz<xref:System.Configuration.DPAPIProtectedConfigurationProvider>-->`System.Configuration.DPAPIProtectedConfigurationProvider`|Uses the Windows Data Protection API (DPAPI) to encrypt configuration sections. It uses the Windows built-in cryptographic services and can be configured for either machine-specific or user-account-specific protection. Machine-specific protection is useful for multiple applications on the same server that need to share information. User-account-specific protection can be used with services that run with a specific user identity, such as a shared hosting environment. Each application runs under a separate identity which restricts access to resources such as files and databases.|  \n  \n Both providers offer strong encryption of data. However, if you are planning to use the same encrypted configuration file on multiple servers, such as a Web farm, only the `RsaProtectedConfigurationProvider` enables you to export the encryption keys used to encrypt the data and import them on another server. For more information, see [Importing and Exporting Protected Configuration RSA Key Containers](http://msdn.microsoft.com/library/f3022b39-f17f-48c1-b067-025eab0ce8bc).  \n  \n### Using the Configuration Classes  \n The <xref:System.Configuration> namespace provides classes to work with configuration settings programmatically. The <xref:System.Configuration.ConfigurationManager> class provides access to machine, application, and user configuration files. If you are creating an ASP.NET application, you can use the <xref:System.Web.Configuration.WebConfigurationManager> class, which provides the same functionality while also allowing you to access settings that are unique to ASP.NET applications, such as those found in **\\<system.web>**.  \n  \n> [!NOTE]\n>  The <xref:System.Security.Cryptography> namespace contains classes that provide additional options for encrypting and decrypting data. Use these classes if you require cryptographic services that are not available using protected configuration. Some of these classes are wrappers for the unmanaged Microsoft CryptoAPI, while others are purely managed implementations. For more information, see [Cryptographic Services](http://msdn.microsoft.com/en-us/68a1e844-c63c-44af-9247-f6716eb23781).  \n  \n### App.config Example  \n This example demonstrates how to toggle encrypting the **connectionStrings** section in an **app.config** file for a Windows application. In this example, the procedure takes the name of the application as an argument, for example, \"MyApplication.exe\". The **app.config** file will then be encrypted and copied to the folder that contains the executable under the name of \"MyApplication.exe.config\".  \n  \n> [!NOTE]\n>  The connection string can only be decrypted on the computer on which it was encrypted.  \n  \n The code uses the <xref:System.Configuration.ConfigurationManager.OpenExeConfiguration%2A> method to open the **app.config** file for editing, and the <xref:System.Configuration.ConfigurationManager.GetSection%2A> method returns the **connectionStrings** section. The code then checks the <xref:System.Configuration.SectionInformation.IsProtected%2A> property, calling the <xref:System.Configuration.SectionInformation.ProtectSection%2A> to encrypt the section if it is not encrypted. The <xref:System.Configuration.SectionInformation.UnprotectSection%2A> method is invoked to decrypt the section. The <xref:System.Configuration.Configuration.Save%2A> method completes the operation and saves the changes.  \n  \n> [!NOTE]\n>  You must set a reference to `System.Configuration.dll` in your project for the code to run.  \n  \n [!code-csharp[DataWorks ConnectionStrings.Encrypt#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStrings.Encrypt/CS/source.cs#1)]\n [!code-vb[DataWorks ConnectionStrings.Encrypt#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStrings.Encrypt/VB/source.vb#1)]  \n  \n### Web.config Example  \n This example uses the <xref:System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration%2A> method of the `WebConfigurationManager`. Note that in this case you can supply the relative path to the **Web.config** file by using a tilde. The code requires a reference to the `System.Web.Configuration` class.  \n  \n [!code-csharp[DataWorks ConnectionStringsWeb.Encrypt#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringsWeb.Encrypt/CS/source.cs#1)]\n [!code-vb[DataWorks ConnectionStringsWeb.Encrypt#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringsWeb.Encrypt/VB/source.vb#1)]  \n  \n For more information securing ASP.NET applications, see [NIB: ASP.NET Security](http://msdn.microsoft.com/en-us/04b37532-18d9-40b4-8e5f-ee09a70b311d) and [ASP.NET 2.0 Security Practices at a Glance](http://go.microsoft.com/fwlink/?LinkId=59997) on the ASP.NET Developer Center.  \n  \n## See Also  \n [Connection String Builders](../../../../docs/framework/data/adonet/connection-string-builders.md)   \n [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md)   \n [Using the Configuration Classes](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc)   \n [Configuring Apps](../../../../docs/framework/configure-apps/index.md)   \n [ASP.NET Web Site Administration](http://msdn.microsoft.com/library/1298034b-5f7d-464d-abd1-ad9e6b3eeb7e)   \n [ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)","nodes":[{"pos":[4,373],"embed":true,"restype":"x-metadata","content":"title: \"Connection Strings and Configuration Files | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-ado\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: 37df2641-661e-407a-a3fb-7bf9540f01e8\ncaps.latest.revision: 4\nauthor: \"JennieHubbard\"\nms.author: \"jhubbard\"\nmanager: \"jhubbard\"","nodes":[{"content":"Connection Strings and Configuration Files | Microsoft Docs","nodes":[{"pos":[0,59],"content":"Connection Strings and Configuration Files | Microsoft Docs","nodes":[{"content":"Connection Strings and Configuration Files | Microsoft Docs","pos":[0,59]}]}],"path":["title"]}],"yml":true},{"pos":[380,422],"content":"Connection Strings and Configuration Files","linkify":"Connection Strings and Configuration Files","nodes":[{"content":"Connection Strings and Configuration Files","pos":[0,42]}]},{"content":"Embedding connection strings in your application's code can lead to security vulnerabilities and maintenance problems.","pos":[423,541]},{"content":"Unencrypted connection strings compiled into an application's source code can be viewed using the <bpt id=\"p1\">[</bpt>Ildasm.exe (IL Disassembler)<ept id=\"p1\">](../../../../docs/framework/tools/ildasm-exe-il-disassembler.md)</ept> tool.","pos":[542,740],"source":" Unencrypted connection strings compiled into an application's source code can be viewed using the [Ildasm.exe (IL Disassembler)](../../../../docs/framework/tools/ildasm-exe-il-disassembler.md) tool."},{"content":"Moreover, if the connection string ever changes, your application must be recompiled.","pos":[741,826]},{"content":"For these reasons, we recommend storing connection strings in an application configuration file.","pos":[827,923]},{"pos":[932,976],"content":"Working with Application Configuration Files","linkify":"Working with Application Configuration Files","nodes":[{"content":"Working with Application Configuration Files","pos":[0,44]}]},{"content":"Application configuration files contain settings that are specific to a particular application.","pos":[980,1075]},{"content":"For example, an ASP.NET application can have one or more <bpt id=\"p1\">**</bpt>web.config<ept id=\"p1\">**</ept> files, and a Windows application can have an optional <bpt id=\"p2\">**</bpt>app.config<ept id=\"p2\">**</ept> file.","pos":[1076,1222],"source":" For example, an ASP.NET application can have one or more **web.config** files, and a Windows application can have an optional **app.config** file."},{"content":"Configuration files share common elements, although the name and location of a configuration file vary depending on the application's host.","pos":[1223,1362]},{"pos":[1372,1401],"content":"The connectionStrings Section","linkify":"The connectionStrings Section","nodes":[{"content":"The connectionStrings Section","pos":[0,29]}]},{"content":"Connection strings can be stored as key/value pairs in the <bpt id=\"p1\">**</bpt>connectionStrings<ept id=\"p1\">**</ept> section of the <bpt id=\"p2\">**</bpt>configuration<ept id=\"p2\">**</ept> element of an application configuration file.","pos":[1405,1564],"source":"Connection strings can be stored as key/value pairs in the **connectionStrings** section of the **configuration** element of an application configuration file."},{"content":"Child elements include <bpt id=\"p1\">**</bpt>add<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>clear<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>remove<ept id=\"p3\">**</ept>.","pos":[1565,1623],"source":" Child elements include **add**, **clear**, and **remove**."},{"content":"The following configuration file fragment demonstrates the schema and syntax for storing a connection string.","pos":[1630,1739]},{"content":"The <bpt id=\"p1\">**</bpt>name<ept id=\"p1\">**</ept> attribute is a name that you provide to uniquely identify a connection string so that it can be retrieved at run time.","pos":[1740,1871],"source":" The **name** attribute is a name that you provide to uniquely identify a connection string so that it can be retrieved at run time."},{"content":"The <bpt id=\"p1\">**</bpt>providerName<ept id=\"p1\">**</ept> is the invariant name of the .NET Framework data provider, which is registered in the machine.config file.","pos":[1872,1999],"source":" The **providerName** is the invariant name of the .NET Framework data provider, which is registered in the machine.config file."},{"pos":[2307,2784],"content":"[!NOTE]\n You can save part of a connection string in a configuration file and use the <xref:System.Data.Common.DbConnectionStringBuilder> class to complete it at run time. This is useful in scenarios where you do not know elements of the connection string ahead of time, or when you do not want to save sensitive information in a configuration file. For more information, see [Connection String Builders](../../../../docs/framework/data/adonet/connection-string-builders.md).","leadings":["","> "],"nodes":[{"content":"You can save part of a connection string in a configuration file and use the <xref:System.Data.Common.DbConnectionStringBuilder> class to complete it at run time. This is useful in scenarios where you do not know elements of the connection string ahead of time, or when you do not want to save sensitive information in a configuration file. For more information, see [Connection String Builders](../../../../docs/framework/data/adonet/connection-string-builders.md).","pos":[9,475],"nodes":[{"content":"You can save part of a connection string in a configuration file and use the <ph id=\"ph1\">&lt;xref:System.Data.Common.DbConnectionStringBuilder&gt;</ph> class to complete it at run time.","pos":[0,162],"source":"You can save part of a connection string in a configuration file and use the <xref:System.Data.Common.DbConnectionStringBuilder> class to complete it at run time."},{"content":"This is useful in scenarios where you do not know elements of the connection string ahead of time, or when you do not want to save sensitive information in a configuration file.","pos":[163,340]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Connection String Builders<ept id=\"p1\">](../../../../docs/framework/data/adonet/connection-string-builders.md)</ept>.","pos":[341,466],"source":" For more information, see [Connection String Builders](../../../../docs/framework/data/adonet/connection-string-builders.md)."}]}]},{"pos":[2794,2828],"content":"Using External Configuration Files","linkify":"Using External Configuration Files","nodes":[{"content":"Using External Configuration Files","pos":[0,34]}]},{"content":"External configuration files are separate files that contain a fragment of a configuration file consisting of a single section.","pos":[2832,2959]},{"content":"The external configuration file is then referenced by the main configuration file.","pos":[2960,3042]},{"content":"Storing the <bpt id=\"p1\">**</bpt>connectionStrings<ept id=\"p1\">**</ept> section in a physically separate file is useful in situations where connection strings may be edited after the application is deployed.","pos":[3043,3212],"source":" Storing the **connectionStrings** section in a physically separate file is useful in situations where connection strings may be edited after the application is deployed."},{"content":"For example, the standard ASP.NET behavior is to restart an application domain when configuration files are modified, which results in state information being lost.","pos":[3213,3377]},{"content":"However, modifying an external configuration file does not cause an application restart.","pos":[3378,3466]},{"content":"External configuration files are not limited to ASP.NET; they can also be used by Windows applications.","pos":[3467,3570]},{"content":"In addition, file access security and permissions can be used to restrict access to external configuration files.","pos":[3571,3684]},{"content":"Working with external configuration files at run time is transparent, and requires no special coding.","pos":[3685,3786]},{"content":"To store connection strings in an external configuration file, create a separate file that contains only the <bpt id=\"p1\">**</bpt>connectionStrings<ept id=\"p1\">**</ept> section.","pos":[3793,3932],"source":"To store connection strings in an external configuration file, create a separate file that contains only the **connectionStrings** section."},{"content":"Do not include any additional elements, sections, or attributes.","pos":[3933,3997]},{"content":"This example shows the syntax for an external configuration file.","pos":[3998,4063]},{"content":"In the main application configuration file, you use the <bpt id=\"p1\">**</bpt>configSource<ept id=\"p1\">**</ept> attribute to specify the fully qualified name and location of the external file.","pos":[4250,4403],"source":"In the main application configuration file, you use the **configSource** attribute to specify the fully qualified name and location of the external file."},{"content":"This example refers to an external configuration file named <ph id=\"ph1\">`connections.config`</ph>.","pos":[4404,4485],"source":" This example refers to an external configuration file named `connections.config`."},{"pos":[4648,4689],"content":"Retrieving Connection Strings at Run Time","linkify":"Retrieving Connection Strings at Run Time","nodes":[{"content":"Retrieving Connection Strings at Run Time","pos":[0,41]}]},{"content":"The .NET Framework 2.0 introduced new classes in the <ph id=\"ph1\">&lt;xref:System.Configuration&gt;</ph> namespace to simplify retrieving connection strings from configuration files at run time.","pos":[4693,4863],"source":"The .NET Framework 2.0 introduced new classes in the <xref:System.Configuration> namespace to simplify retrieving connection strings from configuration files at run time."},{"content":"You can programmatically retrieve a connection string by name or by provider name.","pos":[4864,4946]},{"pos":[4954,5538],"content":"[!NOTE]\n The **machine.config** file also contains a **connectionStrings** section, which contains connection strings used by Visual Studio. When retrieving connection strings by provider name from the **app.config** file in a Windows application, the connection strings in **machine.config** get loaded first, and then the entries from **app.config**. Adding **clear** immediately after the **connectionStrings** element removes all inherited references from the data structure in memory, so that only the connection strings defined in the local **app.config** file are considered.","leadings":["","> "],"nodes":[{"content":"The **machine.config** file also contains a **connectionStrings** section, which contains connection strings used by Visual Studio. When retrieving connection strings by provider name from the **app.config** file in a Windows application, the connection strings in **machine.config** get loaded first, and then the entries from **app.config**. Adding **clear** immediately after the **connectionStrings** element removes all inherited references from the data structure in memory, so that only the connection strings defined in the local **app.config** file are considered.","pos":[9,582],"nodes":[{"content":"The <bpt id=\"p1\">**</bpt>machine.config<ept id=\"p1\">**</ept> file also contains a <bpt id=\"p2\">**</bpt>connectionStrings<ept id=\"p2\">**</ept> section, which contains connection strings used by Visual Studio.","pos":[0,131],"source":"The **machine.config** file also contains a **connectionStrings** section, which contains connection strings used by Visual Studio."},{"content":"When retrieving connection strings by provider name from the <bpt id=\"p1\">**</bpt>app.config<ept id=\"p1\">**</ept> file in a Windows application, the connection strings in <bpt id=\"p2\">**</bpt>machine.config<ept id=\"p2\">**</ept> get loaded first, and then the entries from <bpt id=\"p3\">**</bpt>app.config<ept id=\"p3\">**</ept>. Adding <bpt id=\"p4\">**</bpt>clear<ept id=\"p4\">**</ept> immediately after the <bpt id=\"p5\">**</bpt>connectionStrings<ept id=\"p5\">**</ept> element removes all inherited references from the data structure in memory, so that only the connection strings defined in the local <bpt id=\"p6\">**</bpt>app.config<ept id=\"p6\">**</ept> file are considered.","pos":[132,573],"source":" When retrieving connection strings by provider name from the **app.config** file in a Windows application, the connection strings in **machine.config** get loaded first, and then the entries from **app.config**. Adding **clear** immediately after the **connectionStrings** element removes all inherited references from the data structure in memory, so that only the connection strings defined in the local **app.config** file are considered."}]}]},{"pos":[5548,5586],"content":"Working with the Configuration Classes","linkify":"Working with the Configuration Classes","nodes":[{"content":"Working with the Configuration Classes","pos":[0,38]}]},{"content":"Starting with the .NET Framework 2.0, <ph id=\"ph1\">&lt;xref:System.Configuration.ConfigurationManager&gt;</ph> is used when working with configuration files on the local computer, replacing the deprecated <ph id=\"ph2\">&lt;xref:System.Configuration.ConfigurationSettings&gt;</ph>.","pos":[5590,5821],"source":"Starting with the .NET Framework 2.0, <xref:System.Configuration.ConfigurationManager> is used when working with configuration files on the local computer, replacing the deprecated <xref:System.Configuration.ConfigurationSettings>."},{"content":"<ph id=\"ph1\">&lt;xref:System.Web.Configuration.WebConfigurationManager&gt;</ph> is used to work with ASP.NET configuration files.","pos":[5822,5927],"source":" <xref:System.Web.Configuration.WebConfigurationManager> is used to work with ASP.NET configuration files."},{"content":"It is designed to work with configuration files on a Web server, and allows programmatic access to configuration file sections such as <bpt id=\"p1\">**</bpt>system.web<ept id=\"p1\">**</ept>.","pos":[5928,6078],"source":" It is designed to work with configuration files on a Web server, and allows programmatic access to configuration file sections such as **system.web**."},{"pos":[6086,6574],"content":"[!NOTE]\n Accessing configuration files at run time requires granting permissions to the caller; the required permissions depend on the type of application, configuration file, and location. For more information, see [Using the Configuration Classes](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc) and <xref:System.Web.Configuration.WebConfigurationManager> for ASP.NET applications, and <xref:System.Configuration.ConfigurationManager> for Windows applications.","leadings":["","> "],"nodes":[{"content":"Accessing configuration files at run time requires granting permissions to the caller; the required permissions depend on the type of application, configuration file, and location. For more information, see [Using the Configuration Classes](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc) and <xref:System.Web.Configuration.WebConfigurationManager> for ASP.NET applications, and <xref:System.Configuration.ConfigurationManager> for Windows applications.","pos":[9,486],"nodes":[{"content":"Accessing configuration files at run time requires granting permissions to the caller; the required permissions depend on the type of application, configuration file, and location.","pos":[0,180]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Using the Configuration Classes<ept id=\"p1\">](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc)</ept> and <ph id=\"ph1\">&lt;xref:System.Web.Configuration.WebConfigurationManager&gt;</ph> for ASP.NET applications, and <ph id=\"ph2\">&lt;xref:System.Configuration.ConfigurationManager&gt;</ph> for Windows applications.","pos":[181,477],"source":" For more information, see [Using the Configuration Classes](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc) and <xref:System.Web.Configuration.WebConfigurationManager> for ASP.NET applications, and <xref:System.Configuration.ConfigurationManager> for Windows applications."}]}]},{"content":"You can use the <ph id=\"ph1\">&lt;xref:System.Configuration.ConnectionStringSettingsCollection&gt;</ph> to retrieve connection strings from application configuration files.","pos":[6581,6728],"source":"You can use the <xref:System.Configuration.ConnectionStringSettingsCollection> to retrieve connection strings from application configuration files."},{"content":"It contains a collection of <ph id=\"ph1\">&lt;xref:System.Configuration.ConnectionStringSettings&gt;</ph> objects, each of which represents a single entry in the <bpt id=\"p1\">**</bpt>connectionStrings<ept id=\"p1\">**</ept> section.","pos":[6729,6896],"source":" It contains a collection of <xref:System.Configuration.ConnectionStringSettings> objects, each of which represents a single entry in the **connectionStrings** section."},{"content":"Its properties map to connection string attributes, allowing you to retrieve a connection string by specifying the name or the provider name.","pos":[6897,7038]},{"content":"Property","pos":[7045,7053]},{"content":"Description","pos":[7054,7065]},{"content":"The name of the connection string.","pos":[7168,7202]},{"content":"Maps to the <bpt id=\"p1\">**</bpt>name<ept id=\"p1\">**</ept> attribute.","pos":[7203,7234],"source":" Maps to the **name** attribute."},{"content":"The fully qualified provider name.","pos":[7308,7342]},{"content":"Maps to the <bpt id=\"p1\">**</bpt>providerName<ept id=\"p1\">**</ept> attribute.","pos":[7343,7382],"source":" Maps to the **providerName** attribute."},{"content":"The connection string.","pos":[7460,7482]},{"content":"Maps to the <bpt id=\"p1\">**</bpt>connectionString<ept id=\"p1\">**</ept> attribute.","pos":[7483,7526],"source":" Maps to the **connectionString** attribute."},{"pos":[7537,7576],"content":"Example: Listing All Connection Strings","linkify":"Example: Listing All Connection Strings","nodes":[{"content":"Example: Listing All Connection Strings","pos":[0,39]}]},{"pos":[7580,7911],"content":"This example iterates through the <ph id=\"ph1\">`ConnectionStringSettings`</ph> collection and displays the <ph id=\"ph2\">&lt;xref:System.Configuration.ConnectionStringSettings.Name%2A&gt;</ph>, <ph id=\"ph3\">&lt;xref:System.Configuration.ConnectionStringSettings.ProviderName%2A&gt;</ph>, and <ph id=\"ph4\">&lt;xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A&gt;</ph> properties in the console window.","source":"This example iterates through the `ConnectionStringSettings` collection and displays the <xref:System.Configuration.ConnectionStringSettings.Name%2A>, <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A>, and <xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A> properties in the console window."},{"pos":[7919,8205],"content":"[!NOTE]\n System.Configuration.dll is not included in all project types, and you may need to set a reference to it in order to use the configuration classes. The name and location of a particular application configuration file varies by the type of application and the hosting process.","leadings":["","> "],"nodes":[{"content":"System.Configuration.dll is not included in all project types, and you may need to set a reference to it in order to use the configuration classes. The name and location of a particular application configuration file varies by the type of application and the hosting process.","pos":[9,284],"nodes":[{"content":"System.Configuration.dll is not included in all project types, and you may need to set a reference to it in order to use the configuration classes.","pos":[0,147]},{"content":"The name and location of a particular application configuration file varies by the type of application and the hosting process.","pos":[148,275]}]}]},{"pos":[8212,8609],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DataWorks ConnectionStringSettings.RetrieveFromConfig#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfig/CS/source.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>DataWorks ConnectionStringSettings.RetrieveFromConfig#1<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfig/VB/source.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfig#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfig/CS/source.cs#1)]\n [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfig#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfig/VB/source.vb#1)]"},{"pos":[8619,8666],"content":"Example: Retrieving a Connection String by Name","linkify":"Example: Retrieving a Connection String by Name","nodes":[{"content":"Example: Retrieving a Connection String by Name","pos":[0,47]}]},{"content":"This example demonstrates how to retrieve a connection string from a configuration file by specifying its name.","pos":[8670,8781]},{"content":"The code creates a <ph id=\"ph1\">&lt;xref:System.Configuration.ConnectionStringSettings&gt;</ph> object, matching the supplied input parameter to the <ph id=\"ph2\">&lt;xref:System.Configuration.ConfigurationManager.ConnectionStrings%2A&gt;</ph> name.","pos":[8782,8982],"source":" The code creates a <xref:System.Configuration.ConnectionStringSettings> object, matching the supplied input parameter to the <xref:System.Configuration.ConfigurationManager.ConnectionStrings%2A> name."},{"content":"If no matching name is found, the function returns <ph id=\"ph1\">`null`</ph> (<ph id=\"ph2\">`Nothing`</ph> in Visual Basic).","pos":[8983,9069],"source":" If no matching name is found, the function returns `null` (`Nothing` in Visual Basic)."},{"pos":[9076,9497],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DataWorks ConnectionStringSettings.RetrieveFromConfigByName#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByName/CS/source.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>DataWorks ConnectionStringSettings.RetrieveFromConfigByName#1<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByName/VB/source.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfigByName#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByName/CS/source.cs#1)]\n [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfigByName#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByName/VB/source.vb#1)]"},{"pos":[9507,9563],"content":"Example: Retrieving a Connection String by Provider Name","linkify":"Example: Retrieving a Connection String by Provider Name","nodes":[{"content":"Example: Retrieving a Connection String by Provider Name","pos":[0,56]}]},{"content":"This example demonstrates how to retrieve a connection string by specifying the provider-invariant name in the format <bpt id=\"p1\">*</bpt>System.Data.ProviderName<ept id=\"p1\">*</ept>.","pos":[9567,9712],"source":"This example demonstrates how to retrieve a connection string by specifying the provider-invariant name in the format *System.Data.ProviderName*."},{"content":"The code iterates through the <ph id=\"ph1\">&lt;xref:System.Configuration.ConnectionStringSettingsCollection&gt;</ph> and returns the connection string for the first <ph id=\"ph2\">&lt;xref:System.Configuration.ConnectionStringSettings.ProviderName%2A&gt;</ph> found.","pos":[9713,9929],"source":" The code iterates through the <xref:System.Configuration.ConnectionStringSettingsCollection> and returns the connection string for the first <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> found."},{"content":"If the provider name is not found, the function returns <ph id=\"ph1\">`null`</ph> (<ph id=\"ph2\">`Nothing`</ph> in Visual Basic).","pos":[9930,10021],"source":" If the provider name is not found, the function returns `null` (`Nothing` in Visual Basic)."},{"pos":[10028,10465],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/CS/source.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/VB/source.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/CS/source.cs#1)]\n [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/VB/source.vb#1)]"},{"pos":[10474,10542],"content":"Encrypting Configuration File Sections Using Protected Configuration","linkify":"Encrypting Configuration File Sections Using Protected Configuration","nodes":[{"content":"Encrypting Configuration File Sections Using Protected Configuration","pos":[0,68]}]},{"content":"ASP.NET 2.0 introduced a new feature, called <bpt id=\"p1\">*</bpt>protected configuration<ept id=\"p1\">*</ept>, that enables you to encrypt sensitive information in a configuration file.","pos":[10546,10692],"source":"ASP.NET 2.0 introduced a new feature, called *protected configuration*, that enables you to encrypt sensitive information in a configuration file."},{"content":"Although primarily designed for ASP.NET, protected configuration can also be used to encrypt configuration file sections in Windows applications.","pos":[10693,10838]},{"content":"For a detailed description of the protected configuration capabilities, see <bpt id=\"p1\">[</bpt>Encrypting Configuration Information Using Protected Configuration<ept id=\"p1\">](http://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1)</ept>.","pos":[10839,11056],"source":" For a detailed description of the protected configuration capabilities, see [Encrypting Configuration Information Using Protected Configuration](http://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1)."},{"content":"The following configuration file fragment shows the <bpt id=\"p1\">**</bpt>connectionStrings<ept id=\"p1\">**</ept> section after it has been encrypted.","pos":[11063,11173],"source":"The following configuration file fragment shows the **connectionStrings** section after it has been encrypted."},{"content":"The <bpt id=\"p1\">**</bpt>configProtectionProvider<ept id=\"p1\">**</ept> specifies the protected configuration provider used to encrypt and decrypt the connection strings.","pos":[11174,11305],"source":" The **configProtectionProvider** specifies the protected configuration provider used to encrypt and decrypt the connection strings."},{"content":"The <bpt id=\"p1\">**</bpt>EncryptedData<ept id=\"p1\">**</ept> section contains the cipher text.","pos":[11306,11361],"source":" The **EncryptedData** section contains the cipher text."},{"content":"When the encrypted connection string is retrieved at run time, the .NET Framework uses the specified provider to decrypt the <bpt id=\"p1\">**</bpt>CipherValue<ept id=\"p1\">**</ept> and make it available to your application.","pos":[11645,11828],"source":"When the encrypted connection string is retrieved at run time, the .NET Framework uses the specified provider to decrypt the **CipherValue** and make it available to your application."},{"content":"You do not need to write any additional code to manage the decryption process.","pos":[11829,11907]},{"pos":[11917,11950],"content":"Protected Configuration Providers","linkify":"Protected Configuration Providers","nodes":[{"content":"Protected Configuration Providers","pos":[0,33]}]},{"content":"Protected configuration providers are registered in the <bpt id=\"p1\">**</bpt>configProtectedData<ept id=\"p1\">**</ept> section of the <bpt id=\"p2\">**</bpt>machine.config<ept id=\"p2\">**</ept> file on the local computer, as shown in the following fragment, which shows the two protected configuration providers supplied with the .NET Framework.","pos":[11954,12219],"source":"Protected configuration providers are registered in the **configProtectedData** section of the **machine.config** file on the local computer, as shown in the following fragment, which shows the two protected configuration providers supplied with the .NET Framework."},{"content":"The values shown here have been truncated for readability.","pos":[12220,12278]},{"content":"You can configure additional protected configuration providers by adding them to the <bpt id=\"p1\">**</bpt>machine.config<ept id=\"p1\">**</ept> file.","pos":[12698,12807],"source":"You can configure additional protected configuration providers by adding them to the **machine.config** file."},{"content":"You can also create your own protected configuration provider by inheriting from the <ph id=\"ph1\">&lt;xref:System.Configuration.ProtectedConfigurationProvider&gt;</ph> abstract base class.","pos":[12808,12972],"source":" You can also create your own protected configuration provider by inheriting from the <xref:System.Configuration.ProtectedConfigurationProvider> abstract base class."},{"content":"The following table describes the two configuration files included with the .NET Framework.","pos":[12973,13064]},{"content":"Provider","pos":[13071,13079]},{"content":"Description","pos":[13080,13091]},{"content":"Uses the RSA encryption algorithm to encrypt and decrypt data.","pos":[13260,13322]},{"content":"The RSA algorithm can be used for both public key encryption and digital signatures.","pos":[13323,13407]},{"content":"It is also known as \"public key\" or asymmetrical encryption because it employs two different keys.","pos":[13408,13506]},{"content":"You can use the <bpt id=\"p1\">[</bpt>ASP.NET IIS Registration Tool (Aspnet_regiis.exe)<ept id=\"p1\">](http://msdn.microsoft.com/library/6491c41e-e2b0-481f-9863-db3614d5f96b)</ept> to encrypt sections in a Web.config file and manage the encryption keys.","pos":[13507,13719],"source":" You can use the [ASP.NET IIS Registration Tool (Aspnet_regiis.exe)](http://msdn.microsoft.com/library/6491c41e-e2b0-481f-9863-db3614d5f96b) to encrypt sections in a Web.config file and manage the encryption keys."},{"content":"ASP.NET decrypts the configuration file when it processes the file.","pos":[13720,13787]},{"content":"The identity of the ASP.NET application must have read access to the encryption key that is used to encrypt and decrypt the encrypted sections.","pos":[13788,13931]},{"content":"Uses the Windows Data Protection API (DPAPI) to encrypt configuration sections.","pos":[14067,14146]},{"content":"It uses the Windows built-in cryptographic services and can be configured for either machine-specific or user-account-specific protection.","pos":[14147,14285]},{"content":"Machine-specific protection is useful for multiple applications on the same server that need to share information.","pos":[14286,14400]},{"content":"User-account-specific protection can be used with services that run with a specific user identity, such as a shared hosting environment.","pos":[14401,14537]},{"content":"Each application runs under a separate identity which restricts access to resources such as files and databases.","pos":[14538,14650]},{"content":"Both providers offer strong encryption of data.","pos":[14658,14705]},{"content":"However, if you are planning to use the same encrypted configuration file on multiple servers, such as a Web farm, only the <ph id=\"ph1\">`RsaProtectedConfigurationProvider`</ph> enables you to export the encryption keys used to encrypt the data and import them on another server.","pos":[14706,14967],"source":" However, if you are planning to use the same encrypted configuration file on multiple servers, such as a Web farm, only the `RsaProtectedConfigurationProvider` enables you to export the encryption keys used to encrypt the data and import them on another server."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Importing and Exporting Protected Configuration RSA Key Containers<ept id=\"p1\">](http://msdn.microsoft.com/library/f3022b39-f17f-48c1-b067-025eab0ce8bc)</ept>.","pos":[14968,15135],"source":" For more information, see [Importing and Exporting Protected Configuration RSA Key Containers](http://msdn.microsoft.com/library/f3022b39-f17f-48c1-b067-025eab0ce8bc)."},{"pos":[15145,15176],"content":"Using the Configuration Classes","linkify":"Using the Configuration Classes","nodes":[{"content":"Using the Configuration Classes","pos":[0,31]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Configuration&gt;</ph> namespace provides classes to work with configuration settings programmatically.","pos":[15180,15292],"source":"The <xref:System.Configuration> namespace provides classes to work with configuration settings programmatically."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Configuration.ConfigurationManager&gt;</ph> class provides access to machine, application, and user configuration files.","pos":[15293,15422],"source":" The <xref:System.Configuration.ConfigurationManager> class provides access to machine, application, and user configuration files."},{"content":"If you are creating an ASP.NET application, you can use the <ph id=\"ph1\">&lt;xref:System.Web.Configuration.WebConfigurationManager&gt;</ph> class, which provides the same functionality while also allowing you to access settings that are unique to ASP.NET applications, such as those found in <bpt id=\"p1\">**</bpt><ph id=\"ph2\">\\&lt;</ph>system.web&gt;<ept id=\"p1\">**</ept>.","pos":[15423,15709],"source":" If you are creating an ASP.NET application, you can use the <xref:System.Web.Configuration.WebConfigurationManager> class, which provides the same functionality while also allowing you to access settings that are unique to ASP.NET applications, such as those found in **\\<system.web>**."},{"pos":[15717,16217],"content":"[!NOTE]\n The <xref:System.Security.Cryptography> namespace contains classes that provide additional options for encrypting and decrypting data. Use these classes if you require cryptographic services that are not available using protected configuration. Some of these classes are wrappers for the unmanaged Microsoft CryptoAPI, while others are purely managed implementations. For more information, see [Cryptographic Services](http://msdn.microsoft.com/en-us/68a1e844-c63c-44af-9247-f6716eb23781).","leadings":["","> "],"nodes":[{"content":"The <xref:System.Security.Cryptography> namespace contains classes that provide additional options for encrypting and decrypting data. Use these classes if you require cryptographic services that are not available using protected configuration. Some of these classes are wrappers for the unmanaged Microsoft CryptoAPI, while others are purely managed implementations. For more information, see [Cryptographic Services](http://msdn.microsoft.com/en-us/68a1e844-c63c-44af-9247-f6716eb23781).","pos":[9,498],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Security.Cryptography&gt;</ph> namespace contains classes that provide additional options for encrypting and decrypting data.","pos":[0,134],"source":"The <xref:System.Security.Cryptography> namespace contains classes that provide additional options for encrypting and decrypting data."},{"content":"Use these classes if you require cryptographic services that are not available using protected configuration.","pos":[135,244]},{"content":"Some of these classes are wrappers for the unmanaged Microsoft CryptoAPI, while others are purely managed implementations.","pos":[245,367]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Cryptographic Services<ept id=\"p1\">](http://msdn.microsoft.com/en-us/68a1e844-c63c-44af-9247-f6716eb23781)</ept>.","pos":[368,489],"source":" For more information, see [Cryptographic Services](http://msdn.microsoft.com/en-us/68a1e844-c63c-44af-9247-f6716eb23781)."}]}]},{"pos":[16227,16245],"content":"App.config Example","linkify":"App.config Example","nodes":[{"content":"App.config Example","pos":[0,18]}]},{"content":"This example demonstrates how to toggle encrypting the <bpt id=\"p1\">**</bpt>connectionStrings<ept id=\"p1\">**</ept> section in an <bpt id=\"p2\">**</bpt>app.config<ept id=\"p2\">**</ept> file for a Windows application.","pos":[16249,16386],"source":"This example demonstrates how to toggle encrypting the **connectionStrings** section in an **app.config** file for a Windows application."},{"content":"In this example, the procedure takes the name of the application as an argument, for example, \"MyApplication.exe\".","pos":[16387,16501]},{"content":"The <bpt id=\"p1\">**</bpt>app.config<ept id=\"p1\">**</ept> file will then be encrypted and copied to the folder that contains the executable under the name of \"MyApplication.exe.config\".","pos":[16502,16648],"source":" The **app.config** file will then be encrypted and copied to the folder that contains the executable under the name of \"MyApplication.exe.config\"."},{"pos":[16656,16753],"content":"[!NOTE]\n The connection string can only be decrypted on the computer on which it was encrypted.","leadings":["","> "],"nodes":[{"content":"The connection string can only be decrypted on the computer on which it was encrypted.","pos":[9,95]}]},{"content":"The code uses the <ph id=\"ph1\">&lt;xref:System.Configuration.ConfigurationManager.OpenExeConfiguration%2A&gt;</ph> method to open the <bpt id=\"p1\">**</bpt>app.config<ept id=\"p1\">**</ept> file for editing, and the <ph id=\"ph2\">&lt;xref:System.Configuration.ConfigurationManager.GetSection%2A&gt;</ph> method returns the <bpt id=\"p2\">**</bpt>connectionStrings<ept id=\"p2\">**</ept> section.","pos":[16760,17023],"source":"The code uses the <xref:System.Configuration.ConfigurationManager.OpenExeConfiguration%2A> method to open the **app.config** file for editing, and the <xref:System.Configuration.ConfigurationManager.GetSection%2A> method returns the **connectionStrings** section."},{"content":"The code then checks the <ph id=\"ph1\">&lt;xref:System.Configuration.SectionInformation.IsProtected%2A&gt;</ph> property, calling the <ph id=\"ph2\">&lt;xref:System.Configuration.SectionInformation.ProtectSection%2A&gt;</ph> to encrypt the section if it is not encrypted.","pos":[17024,17244],"source":" The code then checks the <xref:System.Configuration.SectionInformation.IsProtected%2A> property, calling the <xref:System.Configuration.SectionInformation.ProtectSection%2A> to encrypt the section if it is not encrypted."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Configuration.SectionInformation.UnprotectSection%2A&gt;</ph> method is invoked to decrypt the section.","pos":[17245,17357],"source":" The <xref:System.Configuration.SectionInformation.UnprotectSection%2A> method is invoked to decrypt the section."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Configuration.Configuration.Save%2A&gt;</ph> method completes the operation and saves the changes.","pos":[17358,17465],"source":" The <xref:System.Configuration.Configuration.Save%2A> method completes the operation and saves the changes."},{"pos":[17473,17575],"content":"[!NOTE]\n You must set a reference to `System.Configuration.dll` in your project for the code to run.","leadings":["","> "],"nodes":[{"content":"You must set a reference to <ph id=\"ph1\">`System.Configuration.dll`</ph> in your project for the code to run.","pos":[9,100],"source":"You must set a reference to `System.Configuration.dll` in your project for the code to run."}]},{"pos":[17582,17907],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DataWorks ConnectionStrings.Encrypt#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStrings.Encrypt/CS/source.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>DataWorks ConnectionStrings.Encrypt#1<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStrings.Encrypt/VB/source.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[DataWorks ConnectionStrings.Encrypt#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStrings.Encrypt/CS/source.cs#1)]\n [!code-vb[DataWorks ConnectionStrings.Encrypt#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStrings.Encrypt/VB/source.vb#1)]"},{"pos":[17917,17935],"content":"Web.config Example","linkify":"Web.config Example","nodes":[{"content":"Web.config Example","pos":[0,18]}]},{"content":"This example uses the <ph id=\"ph1\">&lt;xref:System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration%2A&gt;</ph> method of the <ph id=\"ph2\">`WebConfigurationManager`</ph>.","pos":[17939,18081],"source":"This example uses the <xref:System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration%2A> method of the `WebConfigurationManager`."},{"content":"Note that in this case you can supply the relative path to the <bpt id=\"p1\">**</bpt>Web.config<ept id=\"p1\">**</ept> file by using a tilde.","pos":[18082,18182],"source":" Note that in this case you can supply the relative path to the **Web.config** file by using a tilde."},{"content":"The code requires a reference to the <ph id=\"ph1\">`System.Web.Configuration`</ph> class.","pos":[18183,18253],"source":" The code requires a reference to the `System.Web.Configuration` class."},{"pos":[18260,18597],"content":"<bpt id=\"p1\">[!code-csharp</bpt><bpt id=\"p2\">[</bpt>DataWorks ConnectionStringsWeb.Encrypt#1<ept id=\"p2\">](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringsWeb.Encrypt/CS/source.cs#1)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-vb</bpt><bpt id=\"p4\">[</bpt>DataWorks ConnectionStringsWeb.Encrypt#1<ept id=\"p4\">](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringsWeb.Encrypt/VB/source.vb#1)</ept><ept id=\"p3\">]</ept>","source":"[!code-csharp[DataWorks ConnectionStringsWeb.Encrypt#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringsWeb.Encrypt/CS/source.cs#1)]\n [!code-vb[DataWorks ConnectionStringsWeb.Encrypt#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringsWeb.Encrypt/VB/source.vb#1)]"},{"pos":[18604,18881],"content":"For more information securing ASP.NET applications, see <bpt id=\"p1\">[</bpt>NIB: ASP.NET Security<ept id=\"p1\">](http://msdn.microsoft.com/en-us/04b37532-18d9-40b4-8e5f-ee09a70b311d)</ept> and <bpt id=\"p2\">[</bpt>ASP.NET 2.0 Security Practices at a Glance<ept id=\"p2\">](http://go.microsoft.com/fwlink/?LinkId=59997)</ept> on the ASP.NET Developer Center.","source":"For more information securing ASP.NET applications, see [NIB: ASP.NET Security](http://msdn.microsoft.com/en-us/04b37532-18d9-40b4-8e5f-ee09a70b311d) and [ASP.NET 2.0 Security Practices at a Glance](http://go.microsoft.com/fwlink/?LinkId=59997) on the ASP.NET Developer Center."},{"pos":[18890,18898],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Connection String Builders<ept id=\"p1\">](../../../../docs/framework/data/adonet/connection-string-builders.md)</ept><ph id=\"ph1\"> </ph>","pos":[18902,19001],"source":"[Connection String Builders](../../../../docs/framework/data/adonet/connection-string-builders.md) "},{"content":"<bpt id=\"p1\">[</bpt>Protecting Connection Information<ept id=\"p1\">](../../../../docs/framework/data/adonet/protecting-connection-information.md)</ept><ph id=\"ph1\"> </ph>","pos":[19005,19118],"source":"[Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md) "},{"content":"<bpt id=\"p1\">[</bpt>Using the Configuration Classes<ept id=\"p1\">](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc)</ept><ph id=\"ph1\"> </ph>","pos":[19122,19228],"source":"[Using the Configuration Classes](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc) "},{"content":"<bpt id=\"p1\">[</bpt>Configuring Apps<ept id=\"p1\">](../../../../docs/framework/configure-apps/index.md)</ept><ph id=\"ph1\"> </ph>","pos":[19232,19303],"source":"[Configuring Apps](../../../../docs/framework/configure-apps/index.md) "},{"content":"<bpt id=\"p1\">[</bpt>ASP.NET Web Site Administration<ept id=\"p1\">](http://msdn.microsoft.com/library/1298034b-5f7d-464d-abd1-ad9e6b3eeb7e)</ept><ph id=\"ph1\"> </ph>","pos":[19307,19413],"source":"[ASP.NET Web Site Administration](http://msdn.microsoft.com/library/1298034b-5f7d-464d-abd1-ad9e6b3eeb7e) "},{"content":"<bpt id=\"p1\">[</bpt>ADO.NET Managed Providers and DataSet Developer Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=217917)</ept>","pos":[19417,19520],"source":"[ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)"}]}