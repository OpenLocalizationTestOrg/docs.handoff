{"content":"---\ntitle: \"Known Issues in SqlClient for Entity Framework\"\nms.date: \"03/30/2017\"\nms.assetid: 48fe4912-4d0f-46b6-be96-3a42c54780f6\n---\n# Known Issues in SqlClient for Entity Framework\nThis section describes known issues related to the .NET Framework Data Provider for SQL Server (SqlClient).  \n  \n## Trailing Spaces in String Functions  \n SQL Server ignores trailing spaces in string values. Therefore, passing trailing spaces in the string can lead to unpredictable results, even failures.  \n  \n If you have to have trailing spaces in your string, you should consider appending a white space character at the end, so that SQL Server does not trim the string. If the trailing spaces are not required, they should be trimmed before they are passed down the query pipeline.  \n  \n## RIGHT Function  \n If a non-`null` value is passed as a first argument and 0 is passed as a second argument to `RIGHT(nvarchar(max)`, 0`)` or `RIGHT(varchar(max)`, 0`)`, a `NULL` value will be returned instead of an `empty` string.  \n  \n## CROSS and OUTER APPLY Operators  \n CROSS and OUTER APPLY operators were introduced in [!INCLUDE[ssVersion2005](../../../../../includes/ssversion2005-md.md)]. In some cases the query pipeline might produce a Transact-SQL statement that contains CROSS APPLY and/or OUTER APPLY operators. Because some backend providers, including versions of SQL Server earlier than [!INCLUDE[ssVersion2005](../../../../../includes/ssversion2005-md.md)], do not support these operators, such queries cannot be executed on these backend providers.  \n  \n The following are some typical scenarios that might lead to the presence of CROSS APPLY and/or OUTER APPLY operators in the output query:  \n  \n-   A correlated subquery with paging.  \n  \n-   An `AnyElement` over a correlated sub-query, or over a collection produced by navigation.  \n  \n-   LINQ queries that use grouping methods that accept an element selector.  \n  \n-   A query in which a CROSS APPLY or an OUTER APPLY is explicitly specified  \n  \n-   A query that has a DEREF construct over a REF construct.  \n  \n## SKIP Operator  \n If you are using [!INCLUDE[ssVersion2000](../../../../../includes/ssversion2000-md.md)], using SKIP with ORDER BY on non-key columns might return incorrect results. More than the specified number of rows might be skipped if the non-key column has duplicate data in it. This is due to how SKIP is translated for [!INCLUDE[ssVersion2000](../../../../../includes/ssversion2000-md.md)]. For example, in the following query, more than five rows might be skipped if `E.NonKeyColumn` has duplicate values:  \n  \n```  \nSELECT [E] FROM Container.EntitySet AS [E] ORDER BY [E].[NonKeyColumn] DESC SKIP 5L  \n```  \n  \n## Targeting the Correct SQL Server Version  \n The [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] targets the [!INCLUDE[tsql](../../../../../includes/tsql-md.md)] query based on the SQL Server version that is specified in the `ProviderManifestToken` attribute of the Schema element in the storage model (.ssdl) file. This version might differ from the version of the actual SQL Server you are connected to. For example, if you are using SQL Server 2005, but your `ProviderManifestToken` attribute is set to 2008, the generated [!INCLUDE[tsql](../../../../../includes/tsql-md.md)] query might not execute on the server. For example, a query that uses the new date time types that were introduced in SQL Server 2008 will not execute on earlier versions of the SQL Server. If you are using SQL Server 2005, but your `ProviderManifestToken` attribute is set to 2000, the generated [!INCLUDE[tsql](../../../../../includes/tsql-md.md)] query might be less optimized, or you might get an exception that says that the query is not supported. For more information, see the CROSS and OUTER APPLY Operators section, earlier in this topic.  \n  \n Certain database behaviors depend on the compatibility level set to the database. If your `ProviderManifestToken` attribute is set to 2005 and your SQL Server version is 2005, but the compatibility level of a database is set to \"80\" (SQL Server 2000), the generated [!INCLUDE[tsql](../../../../../includes/tsql-md.md)] will be targeting SQL Server 2005, but might not execute as expected due to the compatibility level setting. For example, you might lose ordering information if a column name in the ORDER BY list matches a column name in the selector.  \n  \n## Nested Queries in Projection  \n Nested queries in a projection clause might get translated into Cartesian product queries on the server. On some back-end servers, including SLQ Server, this can cause the TempDB table to get quite large. This can decrease server performance.  \n  \n The following is an example of  a nested query in a projection clause:  \n  \n```  \nSELECT c, (SELECT c, (SELECT c FROM AdventureWorksModel.Vendor AS c  ) As Inner2 FROM AdventureWorksModel.JobCandidate AS c  ) As Inner1 FROM AdventureWorksModel.EmployeeDepartmentHistory AS c  \n```  \n  \n## Server Generated GUID Identity Values  \n The [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] supports server-generated GUID type identity values, but the provider must support returning the server-generated identity value after a row was inserted. Starting with SQL Server 2005, you can return the server-generated GUID type in a SQL Server database through the [OUTPUT clause](https://go.microsoft.com/fwlink/?LinkId=169400) .  \n  \n## See also\n\n- [SqlClient for the Entity Framework](../../../../../docs/framework/data/adonet/ef/sqlclient-for-the-entity-framework.md)\n- [Known Issues and Considerations in LINQ to Entities](../../../../../docs/framework/data/adonet/ef/language-reference/known-issues-and-considerations-in-linq-to-entities.md)\n","nodes":[{"pos":[4,130],"embed":true,"restype":"x-metadata","content":"title: \"Known Issues in SqlClient for Entity Framework\"\nms.date: \"03/30/2017\"\nms.assetid: 48fe4912-4d0f-46b6-be96-3a42c54780f6","nodes":[{"content":"Known Issues in SqlClient for Entity Framework","nodes":[{"pos":[0,46],"content":"Known Issues in SqlClient for Entity Framework","nodes":[{"content":"Known Issues in SqlClient for Entity Framework","pos":[0,46]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[137,183],"content":"Known Issues in SqlClient for Entity Framework","linkify":"Known Issues in SqlClient for Entity Framework","nodes":[{"content":"Known Issues in SqlClient for Entity Framework","pos":[0,46]}]},{"content":"This section describes known issues related to the .NET Framework Data Provider for SQL Server (SqlClient).","pos":[184,291]},{"pos":[300,335],"content":"Trailing Spaces in String Functions","linkify":"Trailing Spaces in String Functions","nodes":[{"content":"Trailing Spaces in String Functions","pos":[0,35]}]},{"content":"SQL Server ignores trailing spaces in string values.","pos":[339,391]},{"content":"Therefore, passing trailing spaces in the string can lead to unpredictable results, even failures.","pos":[392,490]},{"content":"If you have to have trailing spaces in your string, you should consider appending a white space character at the end, so that SQL Server does not trim the string.","pos":[497,659]},{"content":"If the trailing spaces are not required, they should be trimmed before they are passed down the query pipeline.","pos":[660,771]},{"pos":[780,794],"content":"RIGHT Function","linkify":"RIGHT Function","nodes":[{"content":"RIGHT Function","pos":[0,14]}]},{"pos":[798,1010],"content":"If a non-<ph id=\"ph1\">`null`</ph> value is passed as a first argument and 0 is passed as a second argument to <ph id=\"ph2\">`RIGHT(nvarchar(max)`</ph>, 0<ph id=\"ph3\">`)`</ph> or <ph id=\"ph4\">`RIGHT(varchar(max)`</ph>, 0<ph id=\"ph5\">`)`</ph>, a <ph id=\"ph6\">`NULL`</ph> value will be returned instead of an <ph id=\"ph7\">`empty`</ph> string.","source":"If a non-`null` value is passed as a first argument and 0 is passed as a second argument to `RIGHT(nvarchar(max)`, 0`)` or `RIGHT(varchar(max)`, 0`)`, a `NULL` value will be returned instead of an `empty` string."},{"pos":[1019,1050],"content":"CROSS and OUTER APPLY Operators","linkify":"CROSS and OUTER APPLY Operators","nodes":[{"content":"CROSS and OUTER APPLY Operators","pos":[0,31]}]},{"content":"CROSS and OUTER APPLY operators were introduced in <ph id=\"ph1\">[!INCLUDE[ssVersion2005](../../../../../includes/ssversion2005-md.md)]</ph>.","pos":[1054,1176],"source":"CROSS and OUTER APPLY operators were introduced in [!INCLUDE[ssVersion2005](../../../../../includes/ssversion2005-md.md)]."},{"content":"In some cases the query pipeline might produce a Transact-SQL statement that contains CROSS APPLY and/or OUTER APPLY operators.","pos":[1177,1304]},{"content":"Because some backend providers, including versions of SQL Server earlier than <ph id=\"ph1\">[!INCLUDE[ssVersion2005](../../../../../includes/ssversion2005-md.md)]</ph>, do not support these operators, such queries cannot be executed on these backend providers.","pos":[1305,1546],"source":" Because some backend providers, including versions of SQL Server earlier than [!INCLUDE[ssVersion2005](../../../../../includes/ssversion2005-md.md)], do not support these operators, such queries cannot be executed on these backend providers."},{"content":"The following are some typical scenarios that might lead to the presence of CROSS APPLY and/or OUTER APPLY operators in the output query:","pos":[1553,1690]},{"content":"A correlated subquery with paging.","pos":[1700,1734]},{"pos":[1744,1833],"content":"An <ph id=\"ph1\">`AnyElement`</ph> over a correlated sub-query, or over a collection produced by navigation.","source":"An `AnyElement` over a correlated sub-query, or over a collection produced by navigation."},{"content":"LINQ queries that use grouping methods that accept an element selector.","pos":[1843,1914]},{"content":"A query in which a CROSS APPLY or an OUTER APPLY is explicitly specified","pos":[1924,1996]},{"content":"A query that has a DEREF construct over a REF construct.","pos":[2006,2062]},{"pos":[2071,2084],"content":"SKIP Operator","linkify":"SKIP Operator","nodes":[{"content":"SKIP Operator","pos":[0,13]}]},{"content":"If you are using <ph id=\"ph1\">[!INCLUDE[ssVersion2000](../../../../../includes/ssversion2000-md.md)]</ph>, using SKIP with ORDER BY on non-key columns might return incorrect results.","pos":[2088,2252],"source":"If you are using [!INCLUDE[ssVersion2000](../../../../../includes/ssversion2000-md.md)], using SKIP with ORDER BY on non-key columns might return incorrect results."},{"content":"More than the specified number of rows might be skipped if the non-key column has duplicate data in it.","pos":[2253,2356]},{"content":"This is due to how SKIP is translated for <ph id=\"ph1\">[!INCLUDE[ssVersion2000](../../../../../includes/ssversion2000-md.md)]</ph>.","pos":[2357,2470],"source":" This is due to how SKIP is translated for [!INCLUDE[ssVersion2000](../../../../../includes/ssversion2000-md.md)]."},{"content":"For example, in the following query, more than five rows might be skipped if <ph id=\"ph1\">`E.NonKeyColumn`</ph> has duplicate values:","pos":[2471,2586],"source":" For example, in the following query, more than five rows might be skipped if `E.NonKeyColumn` has duplicate values:"},{"pos":[2696,2736],"content":"Targeting the Correct SQL Server Version","linkify":"Targeting the Correct SQL Server Version","nodes":[{"content":"Targeting the Correct SQL Server Version","pos":[0,40]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)]</ph> targets the <ph id=\"ph2\">[!INCLUDE[tsql](../../../../../includes/tsql-md.md)]</ph> query based on the SQL Server version that is specified in the <ph id=\"ph3\">`ProviderManifestToken`</ph> attribute of the Schema element in the storage model (.ssdl) file.","pos":[2740,3025],"source":"The [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] targets the [!INCLUDE[tsql](../../../../../includes/tsql-md.md)] query based on the SQL Server version that is specified in the `ProviderManifestToken` attribute of the Schema element in the storage model (.ssdl) file."},{"content":"This version might differ from the version of the actual SQL Server you are connected to.","pos":[3026,3115]},{"content":"For example, if you are using SQL Server 2005, but your <ph id=\"ph1\">`ProviderManifestToken`</ph> attribute is set to 2008, the generated <ph id=\"ph2\">[!INCLUDE[tsql](../../../../../includes/tsql-md.md)]</ph> query might not execute on the server.","pos":[3116,3327],"source":" For example, if you are using SQL Server 2005, but your `ProviderManifestToken` attribute is set to 2008, the generated [!INCLUDE[tsql](../../../../../includes/tsql-md.md)] query might not execute on the server."},{"content":"For example, a query that uses the new date time types that were introduced in SQL Server 2008 will not execute on earlier versions of the SQL Server.","pos":[3328,3478]},{"content":"If you are using SQL Server 2005, but your <ph id=\"ph1\">`ProviderManifestToken`</ph> attribute is set to 2000, the generated <ph id=\"ph2\">[!INCLUDE[tsql](../../../../../includes/tsql-md.md)]</ph> query might be less optimized, or you might get an exception that says that the query is not supported.","pos":[3479,3742],"source":" If you are using SQL Server 2005, but your `ProviderManifestToken` attribute is set to 2000, the generated [!INCLUDE[tsql](../../../../../includes/tsql-md.md)] query might be less optimized, or you might get an exception that says that the query is not supported."},{"content":"For more information, see the CROSS and OUTER APPLY Operators section, earlier in this topic.","pos":[3743,3836]},{"content":"Certain database behaviors depend on the compatibility level set to the database.","pos":[3843,3924]},{"content":"If your <ph id=\"ph1\">`ProviderManifestToken`</ph> attribute is set to 2005 and your SQL Server version is 2005, but the compatibility level of a database is set to \"80\" (SQL Server 2000), the generated <ph id=\"ph2\">[!INCLUDE[tsql](../../../../../includes/tsql-md.md)]</ph> will be targeting SQL Server 2005, but might not execute as expected due to the compatibility level setting.","pos":[3925,4270],"source":" If your `ProviderManifestToken` attribute is set to 2005 and your SQL Server version is 2005, but the compatibility level of a database is set to \"80\" (SQL Server 2000), the generated [!INCLUDE[tsql](../../../../../includes/tsql-md.md)] will be targeting SQL Server 2005, but might not execute as expected due to the compatibility level setting."},{"content":"For example, you might lose ordering information if a column name in the ORDER BY list matches a column name in the selector.","pos":[4271,4396]},{"pos":[4405,4433],"content":"Nested Queries in Projection","linkify":"Nested Queries in Projection","nodes":[{"content":"Nested Queries in Projection","pos":[0,28]}]},{"content":"Nested queries in a projection clause might get translated into Cartesian product queries on the server.","pos":[4437,4541]},{"content":"On some back-end servers, including SLQ Server, this can cause the TempDB table to get quite large.","pos":[4542,4641]},{"content":"This can decrease server performance.","pos":[4642,4679]},{"content":"The following is an example of  a nested query in a projection clause:","pos":[4686,4756]},{"pos":[4975,5012],"content":"Server Generated GUID Identity Values","linkify":"Server Generated GUID Identity Values","nodes":[{"content":"Server Generated GUID Identity Values","pos":[0,37]}]},{"content":"The <ph id=\"ph1\">[!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)]</ph> supports server-generated GUID type identity values, but the provider must support returning the server-generated identity value after a row was inserted.","pos":[5016,5237],"source":"The [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] supports server-generated GUID type identity values, but the provider must support returning the server-generated identity value after a row was inserted."},{"content":"Starting with SQL Server 2005, you can return the server-generated GUID type in a SQL Server database through the <bpt id=\"p1\">[</bpt>OUTPUT clause<ept id=\"p1\">](https://go.microsoft.com/fwlink/?LinkId=169400)</ept> .","pos":[5238,5417],"source":" Starting with SQL Server 2005, you can return the server-generated GUID type in a SQL Server database through the [OUTPUT clause](https://go.microsoft.com/fwlink/?LinkId=169400) ."},{"pos":[5426,5434],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5438,5558],"content":"<bpt id=\"p1\">[</bpt>SqlClient for the Entity Framework<ept id=\"p1\">](../../../../../docs/framework/data/adonet/ef/sqlclient-for-the-entity-framework.md)</ept>","source":"[SqlClient for the Entity Framework](../../../../../docs/framework/data/adonet/ef/sqlclient-for-the-entity-framework.md)"},{"pos":[5561,5734],"content":"<bpt id=\"p1\">[</bpt>Known Issues and Considerations in LINQ to Entities<ept id=\"p1\">](../../../../../docs/framework/data/adonet/ef/language-reference/known-issues-and-considerations-in-linq-to-entities.md)</ept>","source":"[Known Issues and Considerations in LINQ to Entities](../../../../../docs/framework/data/adonet/ef/language-reference/known-issues-and-considerations-in-linq-to-entities.md)"}]}