{"content":"---\ntitle: \"MsgBox Sample | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nhelpviewer_keywords: \n  - \"marshaling, MsgBox sample\"\n  - \"data marshaling, MsgBox sample\"\nms.assetid: 9e0edff6-cc0d-4d5c-a445-aecf283d9c3a\ncaps.latest.revision: 14\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# MsgBox Sample\nThis sample demonstrates how to pass string types by value as In parameters and when to use the <xref:System.Runtime.InteropServices.DllImportAttribute.EntryPoint>, <xref:System.Runtime.InteropServices.DllImportAttribute.CharSet>, and <xref:System.Runtime.InteropServices.DllImportAttribute.ExactSpelling> fields.  \n  \n The MsgBox sample uses the following unmanaged function, shown with its original function declaration:  \n  \n-   **MessageBox** exported from User32.dll.  \n  \n    ```  \n    int MessageBox(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption,   \n       UINT uType);  \n    ```  \n  \n In this sample, the `LibWrap` class contains a managed prototype for each unmanaged function called by the `MsgBoxSample` class. The managed prototype methods `MsgBox`, `MsgBox2`, and `MsgBox3` have different declarations for the same unmanaged function.  \n  \n The declaration for `MsgBox2` produces incorrect output in the message box because the character type, specified as ANSI, is mismatched with the entry point `MessageBoxW`, which is the name of the Unicode function. The declaration for `MsgBox3` creates a mismatch between the **EntryPoint**, **CharSet**, and **ExactSpelling** fields. When called, `MsgBox3` throws an exception. For detailed information on string naming and name marshaling, see [Specifying a Character Set](../../../docs/framework/interop/specifying-a-character-set.md).  \n  \n## Declaring Prototypes  \n [!code-cpp[Conceptual.Interop.Marshaling#5](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.interop.marshaling/cpp/msgbox.cpp#5)]\n [!code-csharp[Conceptual.Interop.Marshaling#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.interop.marshaling/cs/msgbox.cs#5)]\n [!code-vb[Conceptual.Interop.Marshaling#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.interop.marshaling/vb/msgbox.vb#5)]  \n  \n## Calling Functions  \n [!code-cpp[Conceptual.Interop.Marshaling#6](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.interop.marshaling/cpp/msgbox.cpp#6)]\n [!code-csharp[Conceptual.Interop.Marshaling#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.interop.marshaling/cs/msgbox.cs#6)]\n [!code-vb[Conceptual.Interop.Marshaling#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.interop.marshaling/vb/msgbox.vb#6)]  \n  \n## See Also  \n [Marshaling Strings](../../../docs/framework/interop/marshaling-strings.md)   \n [Platform Invoke Data Types](http://msdn.microsoft.com/en-us/16014d9f-d6bd-481e-83f0-df11377c550f)   \n [Default Marshaling for Strings](../../../docs/framework/interop/default-marshaling-for-strings.md)   \n [Creating Prototypes in Managed Code](../../../docs/framework/interop/creating-prototypes-in-managed-code.md)   \n [Specifying a Character Set](../../../docs/framework/interop/specifying-a-character-set.md)","nodes":[{"pos":[12,42],"content":"MsgBox Sample | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MsgBox Sample | Microsoft Docs","pos":[0,30]}]},{"pos":[494,507],"content":"MsgBox Sample","linkify":"MsgBox Sample","nodes":[{"content":"MsgBox Sample","pos":[0,13]}]},{"content":"This sample demonstrates how to pass string types by value as In parameters and when to use the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.DllImportAttribute.EntryPoint&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Runtime.InteropServices.DllImportAttribute.CharSet&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Runtime.InteropServices.DllImportAttribute.ExactSpelling&gt;</ph> fields.","pos":[508,821],"source":"This sample demonstrates how to pass string types by value as In parameters and when to use the <xref:System.Runtime.InteropServices.DllImportAttribute.EntryPoint>, <xref:System.Runtime.InteropServices.DllImportAttribute.CharSet>, and <xref:System.Runtime.InteropServices.DllImportAttribute.ExactSpelling> fields."},{"content":"The MsgBox sample uses the following unmanaged function, shown with its original function declaration:","pos":[828,930]},{"pos":[940,980],"content":"<bpt id=\"p1\">**</bpt>MessageBox<ept id=\"p1\">**</ept> exported from User32.dll.","source":"**MessageBox** exported from User32.dll."},{"content":"In this sample, the <ph id=\"ph1\">`LibWrap`</ph> class contains a managed prototype for each unmanaged function called by the <ph id=\"ph2\">`MsgBoxSample`</ph> class.","pos":[1100,1228],"source":"In this sample, the `LibWrap` class contains a managed prototype for each unmanaged function called by the `MsgBoxSample` class."},{"content":"The managed prototype methods <ph id=\"ph1\">`MsgBox`</ph>, <ph id=\"ph2\">`MsgBox2`</ph>, and <ph id=\"ph3\">`MsgBox3`</ph> have different declarations for the same unmanaged function.","pos":[1229,1354],"source":" The managed prototype methods `MsgBox`, `MsgBox2`, and `MsgBox3` have different declarations for the same unmanaged function."},{"content":"The declaration for <ph id=\"ph1\">`MsgBox2`</ph> produces incorrect output in the message box because the character type, specified as ANSI, is mismatched with the entry point <ph id=\"ph2\">`MessageBoxW`</ph>, which is the name of the Unicode function.","pos":[1361,1575],"source":"The declaration for `MsgBox2` produces incorrect output in the message box because the character type, specified as ANSI, is mismatched with the entry point `MessageBoxW`, which is the name of the Unicode function."},{"content":"The declaration for <ph id=\"ph1\">`MsgBox3`</ph> creates a mismatch between the <bpt id=\"p1\">**</bpt>EntryPoint<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>CharSet<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>ExactSpelling<ept id=\"p3\">**</ept> fields.","pos":[1576,1695],"source":" The declaration for `MsgBox3` creates a mismatch between the **EntryPoint**, **CharSet**, and **ExactSpelling** fields."},{"content":"When called, <ph id=\"ph1\">`MsgBox3`</ph> throws an exception.","pos":[1696,1739],"source":" When called, `MsgBox3` throws an exception."},{"content":"For detailed information on string naming and name marshaling, see <bpt id=\"p1\">[</bpt>Specifying a Character Set<ept id=\"p1\">](../../../docs/framework/interop/specifying-a-character-set.md)</ept>.","pos":[1740,1899],"source":" For detailed information on string naming and name marshaling, see [Specifying a Character Set](../../../docs/framework/interop/specifying-a-character-set.md)."},{"pos":[1908,1928],"content":"Declaring Prototypes","linkify":"Declaring Prototypes","nodes":[{"content":"Declaring Prototypes","pos":[0,20]}]},{"pos":[1932,2359],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>Conceptual.Interop.Marshaling#5<ept id=\"p2\">](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.interop.marshaling/cpp/msgbox.cpp#5)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-csharp</bpt><bpt id=\"p4\">[</bpt>Conceptual.Interop.Marshaling#5<ept id=\"p4\">](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.interop.marshaling/cs/msgbox.cs#5)</ept><ept id=\"p3\">]</ept> <bpt id=\"p5\">[!code-vb</bpt><bpt id=\"p6\">[</bpt>Conceptual.Interop.Marshaling#5<ept id=\"p6\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.interop.marshaling/vb/msgbox.vb#5)</ept><ept id=\"p5\">]</ept>","source":"[!code-cpp[Conceptual.Interop.Marshaling#5](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.interop.marshaling/cpp/msgbox.cpp#5)]\n [!code-csharp[Conceptual.Interop.Marshaling#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.interop.marshaling/cs/msgbox.cs#5)]\n [!code-vb[Conceptual.Interop.Marshaling#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.interop.marshaling/vb/msgbox.vb#5)]"},{"pos":[2368,2385],"content":"Calling Functions","linkify":"Calling Functions","nodes":[{"content":"Calling Functions","pos":[0,17]}]},{"pos":[2389,2816],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>Conceptual.Interop.Marshaling#6<ept id=\"p2\">](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.interop.marshaling/cpp/msgbox.cpp#6)</ept><ept id=\"p1\">]</ept> <bpt id=\"p3\">[!code-csharp</bpt><bpt id=\"p4\">[</bpt>Conceptual.Interop.Marshaling#6<ept id=\"p4\">](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.interop.marshaling/cs/msgbox.cs#6)</ept><ept id=\"p3\">]</ept> <bpt id=\"p5\">[!code-vb</bpt><bpt id=\"p6\">[</bpt>Conceptual.Interop.Marshaling#6<ept id=\"p6\">](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.interop.marshaling/vb/msgbox.vb#6)</ept><ept id=\"p5\">]</ept>","source":"[!code-cpp[Conceptual.Interop.Marshaling#6](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.interop.marshaling/cpp/msgbox.cpp#6)]\n [!code-csharp[Conceptual.Interop.Marshaling#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.interop.marshaling/cs/msgbox.cs#6)]\n [!code-vb[Conceptual.Interop.Marshaling#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.interop.marshaling/vb/msgbox.vb#6)]"},{"pos":[2825,2833],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Marshaling Strings<ept id=\"p1\">](../../../docs/framework/interop/marshaling-strings.md)</ept><ph id=\"ph1\"> </ph>","pos":[2837,2913],"source":"[Marshaling Strings](../../../docs/framework/interop/marshaling-strings.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Platform Invoke Data Types<ept id=\"p1\">](http://msdn.microsoft.com/en-us/16014d9f-d6bd-481e-83f0-df11377c550f)</ept><ph id=\"ph1\"> </ph>","pos":[2916,3016],"source":" [Platform Invoke Data Types](http://msdn.microsoft.com/en-us/16014d9f-d6bd-481e-83f0-df11377c550f) "},{"content":"<bpt id=\"p1\"> [</bpt>Default Marshaling for Strings<ept id=\"p1\">](../../../docs/framework/interop/default-marshaling-for-strings.md)</ept><ph id=\"ph1\"> </ph>","pos":[3019,3120],"source":" [Default Marshaling for Strings](../../../docs/framework/interop/default-marshaling-for-strings.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Creating Prototypes in Managed Code<ept id=\"p1\">](../../../docs/framework/interop/creating-prototypes-in-managed-code.md)</ept><ph id=\"ph1\"> </ph>","pos":[3123,3234],"source":" [Creating Prototypes in Managed Code](../../../docs/framework/interop/creating-prototypes-in-managed-code.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Specifying a Character Set<ept id=\"p1\">](../../../docs/framework/interop/specifying-a-character-set.md)</ept>","pos":[3237,3329],"source":" [Specifying a Character Set](../../../docs/framework/interop/specifying-a-character-set.md)"}]}