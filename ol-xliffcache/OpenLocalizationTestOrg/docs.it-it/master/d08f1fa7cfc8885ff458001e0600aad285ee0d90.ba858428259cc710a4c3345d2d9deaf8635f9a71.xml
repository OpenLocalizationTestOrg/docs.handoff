{"content":"---\ntitle: \"Reading XML Data using XPathDocument and XmlDocument | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: dotnet-standard\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\n  - \"CSharp\"\n  - \"C++\"\n  - \"jsharp\"\nms.assetid: 5711b225-6aa2-4e4f-9898-19f2d518ad1a\ncaps.latest.revision: 2\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# Reading XML Data using XPathDocument and XmlDocument\nThere are two ways to read an XML document in the <xref:System.Xml.XPath?displayProperty=fullName> namespace. One is to read an XML document using the read-only <xref:System.Xml.XPath.XPathDocument> class and the other is to read an XML document using the editable <xref:System.Xml.XmlDocument> class in the <xref:System.Xml?displayProperty=fullName> namespace.  \n  \n## Reading XML Documents using the XPathDocument Class  \n The <xref:System.Xml.XPath.XPathDocument> class provides a fast, read-only, in-memory representation of an XML document using the XPath data model. Instances of the <xref:System.Xml.XPath.XPathDocument> class are created using one of its six constructors. These constructors allow you to read an XML document using a <xref:System.IO.Stream>, <xref:System.IO.TextReader>, or <xref:System.Xml.XmlReader> object, as well as the `string` path to an XML file.  \n  \n The following example illustrates using the <xref:System.Xml.XPath.XPathDocument> class's `string` constructor to read an XML document.  \n  \n```vb  \nDim document As XPathDocument = New XPathDocument(\"books.xml\")  \n```  \n  \n```csharp  \nXPathDocument document = new XPathDocument(\"books.xml\");  \n```  \n  \n## Reading XML Documents using the XmlDocument Class  \n The <xref:System.Xml.XmlDocument> class is an editable in-memory representation of an XML document implementing W3C Document Object Model (DOM) Level 1 Core and Core DOM Level 2. Instances of the <xref:System.Xml.XmlDocument> class are created using one of its three constructors. You can create a new, empty <xref:System.Xml.XmlDocument> object by calling the <xref:System.Xml.XmlDocument> class constructor with no parameters. After calling the constructor, use the <xref:System.Xml.XmlDocument.Load%2A> method to load XML data into the new <xref:System.Xml.XmlDocument> object from a <xref:System.IO.Stream>, <xref:System.IO.TextReader>, or <xref:System.Xml.XmlReader> object, as well as the `string` path to an XML file.  \n  \n The following example illustrates using the <xref:System.Xml.XmlDocument> class constructor with no parameters and the <xref:System.Xml.XmlDocument.Load%2A> method to read an XML document.  \n  \n```vb  \nDim document As XmlDocument = New XmlDocument()  \ndocument.Load(\"books.xml\")  \n```  \n  \n```csharp  \nXmlDocument document = new XmlDocument();  \ndocument.Load(\"books.xml\");  \n```  \n  \n## Determining the Encoding of an XML Document  \n An <xref:System.Xml.XmlReader> object can be used to read an XML document and to create <xref:System.Xml.XPath.XPathDocument> and <xref:System.Xml.XmlDocument> objects as shown in the previous sections. However, an <xref:System.Xml.XmlReader> object may read data that is not encoded and as a result does not provide any encoding information.  \n  \n The <xref:System.Xml.XmlTextReader> class inherits from the <xref:System.Xml.XmlReader> class, provides encoding information using its <xref:System.Xml.XmlTextReader.Encoding%2A> property, and can be used to create an <xref:System.Xml.XPath.XPathDocument> object or <xref:System.Xml.XmlDocument> object.  \n  \n For more information about the encoding information provided by the <xref:System.Xml.XmlTextReader> class, see the <xref:System.Xml.XmlTextReader.Encoding%2A> property in the <xref:System.Xml.XmlTextReader> class reference documentation.  \n  \n## Creating XPathNavigator Objects  \n After you have read an XML document into either an <xref:System.Xml.XPath.XPathDocument> or <xref:System.Xml.XmlDocument> object, you can create an <xref:System.Xml.XPath.XPathNavigator> object to select, evaluate, navigate, and in some cases, edit the underlying XML data.  \n  \n Both the <xref:System.Xml.XPath.XPathDocument> and <xref:System.Xml.XmlDocument> classes, in addition to the <xref:System.Xml.XmlNode> class, implement the <xref:System.Xml.XPath.IXPathNavigable> interface of the <xref:System.Xml.XPath?displayProperty=fullName> namespace. As a result, all three classes provide a <xref:System.Xml.XPath.IXPathNavigable.CreateNavigator%2A> method that returns an <xref:System.Xml.XPath.XPathNavigator> object.  \n  \n### Editing XML Documents using the XPathNavigator Class  \n In addition to selecting, evaluating, and navigating XML data, the <xref:System.Xml.XPath.XPathNavigator> class can be used to edit an XML document in some cases, based on the object that created it.  \n  \n The <xref:System.Xml.XPath.XPathDocument> class is read-only while the <xref:System.Xml.XmlDocument> class is editable and as a result, <xref:System.Xml.XPath.XPathNavigator> objects created from an <xref:System.Xml.XPath.XPathDocument> object cannot be used to edit an XML document while those created from an <xref:System.Xml.XmlDocument> object can. The <xref:System.Xml.XPath.XPathDocument> class should be used to read an XML document only. In cases where you need to edit an XML document, or require access to the additional functionality provided by the <xref:System.Xml.XmlDocument> class, like event handling, the <xref:System.Xml.XmlDocument> class should be used.  \n  \n The <xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> property of the <xref:System.Xml.XPath.XPathNavigator> class specifies if an <xref:System.Xml.XPath.XPathNavigator> object may edit XML data.  \n  \n The following table describes the value of the <xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> property for each class.  \n  \n|<xref:System.Xml.XPath.IXPathNavigable> Implementation|<xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> Value|  \n|--------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|  \n|<xref:System.Xml.XPath.XPathDocument>|`false`|  \n|<xref:System.Xml.XmlDocument>|`true`|  \n  \n## See Also  \n <xref:System.Xml.XmlDocument>   \n <xref:System.Xml.XPath.XPathDocument>   \n <xref:System.Xml.XPath.XPathNavigator>   \n [Process XML Data Using the XPath Data Model](../../../../docs/standard/data/xml/process-xml-data-using-the-xpath-data-model.md)   \n [Accessing XML Data using XPathNavigator](../../../../docs/standard/data/xml/accessing-xml-data-using-xpathnavigator.md)   \n [Editing XML Data using XPathNavigator](../../../../docs/standard/data/xml/editing-xml-data-using-xpathnavigator.md)   \n [Schema Validation using XPathNavigator](../../../../docs/standard/data/xml/schema-validation-using-xpathnavigator.md)","nodes":[{"pos":[12,81],"content":"Reading XML Data using XPathDocument and XmlDocument | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Reading XML Data using XPathDocument and XmlDocument | Microsoft Docs","pos":[0,69]}]},{"pos":[426,478],"content":"Reading XML Data using XPathDocument and XmlDocument","linkify":"Reading XML Data using XPathDocument and XmlDocument","nodes":[{"content":"Reading XML Data using XPathDocument and XmlDocument","pos":[0,52]}]},{"content":"There are two ways to read an XML document in the <ph id=\"ph1\">&lt;xref:System.Xml.XPath?displayProperty=fullName&gt;</ph> namespace.","pos":[479,588],"source":"There are two ways to read an XML document in the <xref:System.Xml.XPath?displayProperty=fullName> namespace."},{"content":"One is to read an XML document using the read-only <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class and the other is to read an XML document using the editable <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class in the <ph id=\"ph3\">&lt;xref:System.Xml?displayProperty=fullName&gt;</ph> namespace.","pos":[589,840],"source":" One is to read an XML document using the read-only <xref:System.Xml.XPath.XPathDocument> class and the other is to read an XML document using the editable <xref:System.Xml.XmlDocument> class in the <xref:System.Xml?displayProperty=fullName> namespace."},{"pos":[849,900],"content":"Reading XML Documents using the XPathDocument Class","linkify":"Reading XML Documents using the XPathDocument Class","nodes":[{"content":"Reading XML Documents using the XPathDocument Class","pos":[0,51]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class provides a fast, read-only, in-memory representation of an XML document using the XPath data model.","pos":[904,1051],"source":"The <xref:System.Xml.XPath.XPathDocument> class provides a fast, read-only, in-memory representation of an XML document using the XPath data model."},{"content":"Instances of the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class are created using one of its six constructors.","pos":[1052,1159],"source":" Instances of the <xref:System.Xml.XPath.XPathDocument> class are created using one of its six constructors."},{"content":"These constructors allow you to read an XML document using a <ph id=\"ph1\">&lt;xref:System.IO.Stream&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.IO.TextReader&gt;</ph>, or <ph id=\"ph3\">&lt;xref:System.Xml.XmlReader&gt;</ph> object, as well as the <ph id=\"ph4\">`string`</ph> path to an XML file.","pos":[1160,1358],"source":" These constructors allow you to read an XML document using a <xref:System.IO.Stream>, <xref:System.IO.TextReader>, or <xref:System.Xml.XmlReader> object, as well as the `string` path to an XML file."},{"pos":[1365,1500],"content":"The following example illustrates using the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class's <ph id=\"ph2\">`string`</ph> constructor to read an XML document.","source":"The following example illustrates using the <xref:System.Xml.XPath.XPathDocument> class's `string` constructor to read an XML document."},{"pos":[1671,1720],"content":"Reading XML Documents using the XmlDocument Class","linkify":"Reading XML Documents using the XmlDocument Class","nodes":[{"content":"Reading XML Documents using the XmlDocument Class","pos":[0,49]}]},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class is an editable in-memory representation of an XML document implementing W3C Document Object Model (DOM) Level 1 Core and Core DOM Level 2.","pos":[1724,1902],"source":"The <xref:System.Xml.XmlDocument> class is an editable in-memory representation of an XML document implementing W3C Document Object Model (DOM) Level 1 Core and Core DOM Level 2."},{"content":"Instances of the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class are created using one of its three constructors.","pos":[1903,2004],"source":" Instances of the <xref:System.Xml.XmlDocument> class are created using one of its three constructors."},{"content":"You can create a new, empty <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object by calling the <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class constructor with no parameters.","pos":[2005,2152],"source":" You can create a new, empty <xref:System.Xml.XmlDocument> object by calling the <xref:System.Xml.XmlDocument> class constructor with no parameters."},{"content":"After calling the constructor, use the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument.Load%2A&gt;</ph> method to load XML data into the new <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object from a <ph id=\"ph3\">&lt;xref:System.IO.Stream&gt;</ph>, <ph id=\"ph4\">&lt;xref:System.IO.TextReader&gt;</ph>, or <ph id=\"ph5\">&lt;xref:System.Xml.XmlReader&gt;</ph> object, as well as the <ph id=\"ph6\">`string`</ph> path to an XML file.","pos":[2153,2448],"source":" After calling the constructor, use the <xref:System.Xml.XmlDocument.Load%2A> method to load XML data into the new <xref:System.Xml.XmlDocument> object from a <xref:System.IO.Stream>, <xref:System.IO.TextReader>, or <xref:System.Xml.XmlReader> object, as well as the `string` path to an XML file."},{"content":"The following example illustrates using the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class constructor with no parameters and the <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument.Load%2A&gt;</ph> method to read an XML document.","pos":[2455,2643],"source":"The following example illustrates using the <xref:System.Xml.XmlDocument> class constructor with no parameters and the <xref:System.Xml.XmlDocument.Load%2A> method to read an XML document."},{"pos":[2843,2886],"content":"Determining the Encoding of an XML Document","linkify":"Determining the Encoding of an XML Document","nodes":[{"content":"Determining the Encoding of an XML Document","pos":[0,43]}]},{"content":"An <ph id=\"ph1\">&lt;xref:System.Xml.XmlReader&gt;</ph> object can be used to read an XML document and to create <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> and <ph id=\"ph3\">&lt;xref:System.Xml.XmlDocument&gt;</ph> objects as shown in the previous sections.","pos":[2890,3092],"source":"An <xref:System.Xml.XmlReader> object can be used to read an XML document and to create <xref:System.Xml.XPath.XPathDocument> and <xref:System.Xml.XmlDocument> objects as shown in the previous sections."},{"content":"However, an <ph id=\"ph1\">&lt;xref:System.Xml.XmlReader&gt;</ph> object may read data that is not encoded and as a result does not provide any encoding information.","pos":[3093,3232],"source":" However, an <xref:System.Xml.XmlReader> object may read data that is not encoded and as a result does not provide any encoding information."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XmlTextReader&gt;</ph> class inherits from the <ph id=\"ph2\">&lt;xref:System.Xml.XmlReader&gt;</ph> class, provides encoding information using its <ph id=\"ph3\">&lt;xref:System.Xml.XmlTextReader.Encoding%2A&gt;</ph> property, and can be used to create an <ph id=\"ph4\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> object or <ph id=\"ph5\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object.","pos":[3239,3542],"source":"The <xref:System.Xml.XmlTextReader> class inherits from the <xref:System.Xml.XmlReader> class, provides encoding information using its <xref:System.Xml.XmlTextReader.Encoding%2A> property, and can be used to create an <xref:System.Xml.XPath.XPathDocument> object or <xref:System.Xml.XmlDocument> object."},{"content":"For more information about the encoding information provided by the <ph id=\"ph1\">&lt;xref:System.Xml.XmlTextReader&gt;</ph> class, see the <ph id=\"ph2\">&lt;xref:System.Xml.XmlTextReader.Encoding%2A&gt;</ph> property in the <ph id=\"ph3\">&lt;xref:System.Xml.XmlTextReader&gt;</ph> class reference documentation.","pos":[3549,3786],"source":"For more information about the encoding information provided by the <xref:System.Xml.XmlTextReader> class, see the <xref:System.Xml.XmlTextReader.Encoding%2A> property in the <xref:System.Xml.XmlTextReader> class reference documentation."},{"pos":[3795,3826],"content":"Creating XPathNavigator Objects","linkify":"Creating XPathNavigator Objects","nodes":[{"content":"Creating XPathNavigator Objects","pos":[0,31]}]},{"content":"After you have read an XML document into either an <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object, you can create an <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object to select, evaluate, navigate, and in some cases, edit the underlying XML data.","pos":[3830,4103],"source":"After you have read an XML document into either an <xref:System.Xml.XPath.XPathDocument> or <xref:System.Xml.XmlDocument> object, you can create an <xref:System.Xml.XPath.XPathNavigator> object to select, evaluate, navigate, and in some cases, edit the underlying XML data."},{"content":"Both the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> and <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> classes, in addition to the <ph id=\"ph3\">&lt;xref:System.Xml.XmlNode&gt;</ph> class, implement the <ph id=\"ph4\">&lt;xref:System.Xml.XPath.IXPathNavigable&gt;</ph> interface of the <ph id=\"ph5\">&lt;xref:System.Xml.XPath?displayProperty=fullName&gt;</ph> namespace.","pos":[4110,4382],"source":"Both the <xref:System.Xml.XPath.XPathDocument> and <xref:System.Xml.XmlDocument> classes, in addition to the <xref:System.Xml.XmlNode> class, implement the <xref:System.Xml.XPath.IXPathNavigable> interface of the <xref:System.Xml.XPath?displayProperty=fullName> namespace."},{"content":"As a result, all three classes provide a <ph id=\"ph1\">&lt;xref:System.Xml.XPath.IXPathNavigable.CreateNavigator%2A&gt;</ph> method that returns an <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object.","pos":[4383,4552],"source":" As a result, all three classes provide a <xref:System.Xml.XPath.IXPathNavigable.CreateNavigator%2A> method that returns an <xref:System.Xml.XPath.XPathNavigator> object."},{"pos":[4562,4614],"content":"Editing XML Documents using the XPathNavigator Class","linkify":"Editing XML Documents using the XPathNavigator Class","nodes":[{"content":"Editing XML Documents using the XPathNavigator Class","pos":[0,52]}]},{"content":"In addition to selecting, evaluating, and navigating XML data, the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class can be used to edit an XML document in some cases, based on the object that created it.","pos":[4618,4817],"source":"In addition to selecting, evaluating, and navigating XML data, the <xref:System.Xml.XPath.XPathNavigator> class can be used to edit an XML document in some cases, based on the object that created it."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class is read-only while the <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class is editable and as a result, <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> objects created from an <ph id=\"ph4\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> object cannot be used to edit an XML document while those created from an <ph id=\"ph5\">&lt;xref:System.Xml.XmlDocument&gt;</ph> object can.","pos":[4824,5176],"source":"The <xref:System.Xml.XPath.XPathDocument> class is read-only while the <xref:System.Xml.XmlDocument> class is editable and as a result, <xref:System.Xml.XPath.XPathNavigator> objects created from an <xref:System.Xml.XPath.XPathDocument> object cannot be used to edit an XML document while those created from an <xref:System.Xml.XmlDocument> object can."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathDocument&gt;</ph> class should be used to read an XML document only.","pos":[5177,5269],"source":" The <xref:System.Xml.XPath.XPathDocument> class should be used to read an XML document only."},{"content":"In cases where you need to edit an XML document, or require access to the additional functionality provided by the <ph id=\"ph1\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class, like event handling, the <ph id=\"ph2\">&lt;xref:System.Xml.XmlDocument&gt;</ph> class should be used.","pos":[5270,5498],"source":" In cases where you need to edit an XML document, or require access to the additional functionality provided by the <xref:System.Xml.XmlDocument> class, like event handling, the <xref:System.Xml.XmlDocument> class should be used."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.CanEdit%2A&gt;</ph> property of the <ph id=\"ph2\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> class specifies if an <ph id=\"ph3\">&lt;xref:System.Xml.XPath.XPathNavigator&gt;</ph> object may edit XML data.","pos":[5505,5700],"source":"The <xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> property of the <xref:System.Xml.XPath.XPathNavigator> class specifies if an <xref:System.Xml.XPath.XPathNavigator> object may edit XML data."},{"content":"The following table describes the value of the <ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.CanEdit%2A&gt;</ph> property for each class.","pos":[5707,5828],"source":"The following table describes the value of the <xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> property for each class."},{"content":"<ph id=\"ph1\">&lt;xref:System.Xml.XPath.IXPathNavigable&gt;</ph> Implementation","pos":[5835,5889],"source":"<xref:System.Xml.XPath.IXPathNavigable> Implementation"},{"content":"<ph id=\"ph1\">&lt;xref:System.Xml.XPath.XPathNavigator.CanEdit%2A&gt;</ph> Value","pos":[5890,5945],"source":"<xref:System.Xml.XPath.XPathNavigator.CanEdit%2A> Value"},{"pos":[6366,6374],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>Process XML Data Using the XPath Data Model<ept id=\"p1\">](../../../../docs/standard/data/xml/process-xml-data-using-the-xpath-data-model.md)</ept><ph id=\"ph1\"> </ph>","pos":[6496,6626],"source":" [Process XML Data Using the XPath Data Model](../../../../docs/standard/data/xml/process-xml-data-using-the-xpath-data-model.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Accessing XML Data using XPathNavigator<ept id=\"p1\">](../../../../docs/standard/data/xml/accessing-xml-data-using-xpathnavigator.md)</ept><ph id=\"ph1\"> </ph>","pos":[6629,6751],"source":" [Accessing XML Data using XPathNavigator](../../../../docs/standard/data/xml/accessing-xml-data-using-xpathnavigator.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Editing XML Data using XPathNavigator<ept id=\"p1\">](../../../../docs/standard/data/xml/editing-xml-data-using-xpathnavigator.md)</ept><ph id=\"ph1\"> </ph>","pos":[6754,6872],"source":" [Editing XML Data using XPathNavigator](../../../../docs/standard/data/xml/editing-xml-data-using-xpathnavigator.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Schema Validation using XPathNavigator<ept id=\"p1\">](../../../../docs/standard/data/xml/schema-validation-using-xpathnavigator.md)</ept>","pos":[6875,6994],"source":" [Schema Validation using XPathNavigator](../../../../docs/standard/data/xml/schema-validation-using-xpathnavigator.md)"}]}