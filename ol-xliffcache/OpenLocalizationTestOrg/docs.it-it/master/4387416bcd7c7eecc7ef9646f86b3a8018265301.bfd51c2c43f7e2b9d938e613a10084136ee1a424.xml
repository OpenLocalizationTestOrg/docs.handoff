{"content":"---\ntitle: \"ICLRDebugging::OpenVirtualProcess Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICLRDebugging.OpenVirtualProcess\"\napi_location: \n  - \"mscordbi.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRDebugging::OpenVirtualProcess\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OpenVirtualProcess method [.NET Framework debugging]\"\n  - \"ICLRDebugging::OpenVirtualProcess method [.NET Framework debugging]\"\nms.assetid: e8ab7c41-d508-4ed9-8a31-ead072b5a314\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 15\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"\n---\n# ICLRDebugging::OpenVirtualProcess Method\nGets the ICorDebugProcess interface that corresponds to a common language runtime (CLR) module loaded in the process.  \n  \n## Syntax  \n  \n```  \nHRESULT OpenVirtualProcess(  \n    [in] ULONG64 moduleBaseAddress,  \n    [in] IUnknown * pDataTarget,  \n    [in] ICLRDebuggingLibraryProvider * pLibraryProvider,  \n    [in] CLR_DEBUGGING_VERSION * pMaxDebuggerSupportedVersion,  \n    [in] REFIID riidProcess,  \n    [out, iid_is(riidProcess)] IUnknown ** ppProcess,  \n    [in, out] CLR_DEBUGGING_VERSION * pVersion,  \n    [out] CLR_DEBUGGING_PROCESS_FLAGS * pdwFlags);  \n```  \n  \n#### Parameters  \n `moduleBaseAddress`  \n [in] The base address of a module in the target process. COR_E_NOT_CLR will be returned if the specified module is not a CLR module.  \n  \n `pDataTarget`  \n [in] A data target abstraction that allows the managed debugger to inspect process state. The debugger must implement the [ICorDebugDataTarget](../../../../docs/framework/unmanaged-api/debugging/icordebugdatatarget-interface.md) interface. You should implement the [ICLRDebuggingLibraryProvider](../../../../docs/framework/unmanaged-api/debugging/iclrdebugginglibraryprovider-interface.md) interface to support scenarios where the CLR that is being debugged is not installed locally on the computer.  \n  \n `pLibraryProvider`  \n [in] A library provider callback interface that allows version-specific debugging libraries to be located and loaded on demand. This parameter is required only if `ppProcess` or `pFlags` is not `null`.  \n  \n `pMaxDebuggerSupportedVersion`  \n [in] The highest version of the CLR that this debugger can debug. You should specify the major, minor, and build versions from the latest CLR version this debugger supports, and set the revision number to 65535 to accommodate future in-place CLR servicing releases.  \n  \n `riidProcess`  \n [in] The ID of the ICorDebugProcess interface to retrieve. Currently, the only accepted values are IID_CORDEBUGPROCESS3, IID_CORDEBUGPROCESS2, and IID_CORDEBUGPROCESS.  \n  \n `ppProcess`  \n [out] A pointer to the COM interface that is identified by `riidProcess`.  \n  \n `pVersion`  \n [in, out] The version of the CLR. On input, this value can be `null`. It can also point to a [CLR_DEBUGGING_VERSION](../../../../docs/framework/unmanaged-api/debugging/clr-debugging-version-structure.md) structure, in which case the structure's `wStructVersion` field must be initialized to 0 (zero).  \n  \n On output, the returned `CLR_DEBUGGING_VERSION` structure will be filled in with the version information for the CLR.  \n  \n `pdwFlags`  \n [out] Informational flags about the specified runtime. See the [CLR_DEBUGGING_PROCESS_FLAGS](../../../../docs/framework/unmanaged-api/debugging/clr-debugging-process-flags-enumeration.md) topic for a description of the flags.  \n  \n## Return Value  \n This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.  \n  \n|HRESULT|Description|  \n|-------------|-----------------|  \n|S_OK|The method completed successfully.|  \n|E_POINTER|`pDataTarget` is `null`.|  \n|CORDBG_E_LIBRARY_PROVIDER_ERROR|The [ICLRDebuggingLibraryProvider](../../../../docs/framework/unmanaged-api/debugging/iclrdebugginglibraryprovider-interface.md) callback returns an error or does not provide a valid handle.|  \n|CORDBG_E_MISSING_DATA_TARGET_INTERFACE|`pDataTarget` does not implement the required data target interfaces for this version of the runtime.|  \n|CORDBG_E_NOT_CLR|The indicated module is not a CLR module. This HRESULT is also returned when a CLR module cannot be detected because memory has been corrupted, the module is not available, or the CLR version is later than the shim version.|  \n|CORDBG_E_UNSUPPORTED_DEBUGGING_MODEL|This runtime version does not support this debugging model. Currently, the debugging model is not supported by CLR versions before the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]. The `pwszVersion` output parameter is still set to the correct value after this error.|  \n|CORDBG_E_UNSUPPORTED_FORWARD_COMPAT|The version of the CLR is greater than the version this debugger claims to support. The `pwszVersion` output parameter is still set to the correct value after this error.|  \n|E_NO_INTERFACE|The `riidProcess` interface is not available.|  \n|CORDBG_E_UNSUPPORTED_VERSION_STRUCT|The `CLR_DEBUGGING_VERSION` structure does not have a recognized value for `wStructVersion`. The only accepted value at this time is 0.|  \n  \n## Exceptions  \n  \n## Remarks  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** CorDebug.idl, CorDebug.h  \n  \n **Library:** CorGuids.lib  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]  \n  \n## See Also  \n [Debugging Interfaces](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md)   \n [Debugging](../../../../docs/framework/unmanaged-api/debugging/index.md)","nodes":[{"pos":[4,730],"embed":true,"restype":"x-metadata","content":"title: \"ICLRDebugging::OpenVirtualProcess Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"ICLRDebugging.OpenVirtualProcess\"\napi_location: \n  - \"mscordbi.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"ICLRDebugging::OpenVirtualProcess\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OpenVirtualProcess method [.NET Framework debugging]\"\n  - \"ICLRDebugging::OpenVirtualProcess method [.NET Framework debugging]\"\nms.assetid: e8ab7c41-d508-4ed9-8a31-ead072b5a314\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 15\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\nmanager: \"wpickett\"","nodes":[{"content":"ICLRDebugging::OpenVirtualProcess Method | Microsoft Docs","nodes":[{"pos":[0,57],"content":"ICLRDebugging::OpenVirtualProcess Method | Microsoft Docs","nodes":[{"content":"ICLRDebugging::OpenVirtualProcess Method | Microsoft Docs","pos":[0,57]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[737,777],"content":"ICLRDebugging::OpenVirtualProcess Method","linkify":"ICLRDebugging::OpenVirtualProcess Method","nodes":[{"content":"ICLRDebugging::OpenVirtualProcess Method","pos":[0,40]}]},{"content":"Gets the ICorDebugProcess interface that corresponds to a common language runtime (CLR) module loaded in the process.","pos":[778,895]},{"pos":[904,910],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1354,1364],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The base address of a module in the target process.","pos":[1391,1447]},{"content":"COR_E_NOT_CLR will be returned if the specified module is not a CLR module.","pos":[1448,1523]},{"content":"[in] A data target abstraction that allows the managed debugger to inspect process state.","pos":[1547,1636]},{"content":"The debugger must implement the <bpt id=\"p1\">[</bpt>ICorDebugDataTarget<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/icordebugdatatarget-interface.md)</ept> interface.","pos":[1637,1786],"source":" The debugger must implement the [ICorDebugDataTarget](../../../../docs/framework/unmanaged-api/debugging/icordebugdatatarget-interface.md) interface."},{"content":"You should implement the <bpt id=\"p1\">[</bpt>ICLRDebuggingLibraryProvider<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/iclrdebugginglibraryprovider-interface.md)</ept> interface to support scenarios where the CLR that is being debugged is not installed locally on the computer.","pos":[1787,2046],"source":" You should implement the [ICLRDebuggingLibraryProvider](../../../../docs/framework/unmanaged-api/debugging/iclrdebugginglibraryprovider-interface.md) interface to support scenarios where the CLR that is being debugged is not installed locally on the computer."},{"content":"[in] A library provider callback interface that allows version-specific debugging libraries to be located and loaded on demand.","pos":[2075,2202]},{"content":"This parameter is required only if <ph id=\"ph1\">`ppProcess`</ph> or <ph id=\"ph2\">`pFlags`</ph> is not <ph id=\"ph3\">`null`</ph>.","pos":[2203,2276],"source":" This parameter is required only if `ppProcess` or `pFlags` is not `null`."},{"content":"[in] The highest version of the CLR that this debugger can debug.","pos":[2317,2382]},{"content":"You should specify the major, minor, and build versions from the latest CLR version this debugger supports, and set the revision number to 65535 to accommodate future in-place CLR servicing releases.","pos":[2383,2582]},{"content":"[in] The ID of the ICorDebugProcess interface to retrieve.","pos":[2606,2664]},{"content":"Currently, the only accepted values are IID_CORDEBUGPROCESS3, IID_CORDEBUGPROCESS2, and IID_CORDEBUGPROCESS.","pos":[2665,2773]},{"content":"[out] A pointer to the COM interface that is identified by <ph id=\"ph1\">`riidProcess`</ph>.","pos":[2795,2868],"source":"[out] A pointer to the COM interface that is identified by `riidProcess`."},{"content":"[in, out] The version of the CLR.","pos":[2889,2922]},{"content":"On input, this value can be <ph id=\"ph1\">`null`</ph>.","pos":[2923,2958],"source":" On input, this value can be `null`."},{"content":"It can also point to a <bpt id=\"p1\">[</bpt>CLR_DEBUGGING_VERSION<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/clr-debugging-version-structure.md)</ept> structure, in which case the structure's <ph id=\"ph1\">`wStructVersion`</ph> field must be initialized to 0 (zero).","pos":[2959,3189],"source":" It can also point to a [CLR_DEBUGGING_VERSION](../../../../docs/framework/unmanaged-api/debugging/clr-debugging-version-structure.md) structure, in which case the structure's `wStructVersion` field must be initialized to 0 (zero)."},{"pos":[3196,3313],"content":"On output, the returned <ph id=\"ph1\">`CLR_DEBUGGING_VERSION`</ph> structure will be filled in with the version information for the CLR.","source":"On output, the returned `CLR_DEBUGGING_VERSION` structure will be filled in with the version information for the CLR."},{"content":"[out] Informational flags about the specified runtime.","pos":[3334,3388]},{"content":"See the <bpt id=\"p1\">[</bpt>CLR_DEBUGGING_PROCESS_FLAGS<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/clr-debugging-process-flags-enumeration.md)</ept> topic for a description of the flags.","pos":[3389,3559],"source":" See the [CLR_DEBUGGING_PROCESS_FLAGS](../../../../docs/framework/unmanaged-api/debugging/clr-debugging-process-flags-enumeration.md) topic for a description of the flags."},{"pos":[3568,3580],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.","pos":[3584,3691]},{"content":"HRESULT","pos":[3698,3705]},{"content":"Description","pos":[3706,3717]},{"content":"S_OK","pos":[3758,3762]},{"content":"The method completed successfully.","pos":[3763,3797]},{"content":"E_POINTER","pos":[3802,3811]},{"pos":[3812,3836],"content":"<ph id=\"ph1\">`pDataTarget`</ph> is <ph id=\"ph2\">`null`</ph>.","source":"`pDataTarget` is `null`."},{"content":"CORDBG_E_LIBRARY_PROVIDER_ERROR","pos":[3841,3872]},{"pos":[3873,4063],"content":"The <bpt id=\"p1\">[</bpt>ICLRDebuggingLibraryProvider<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/iclrdebugginglibraryprovider-interface.md)</ept> callback returns an error or does not provide a valid handle.","source":"The [ICLRDebuggingLibraryProvider](../../../../docs/framework/unmanaged-api/debugging/iclrdebugginglibraryprovider-interface.md) callback returns an error or does not provide a valid handle."},{"content":"CORDBG_E_MISSING_DATA_TARGET_INTERFACE","pos":[4068,4106]},{"pos":[4107,4208],"content":"<ph id=\"ph1\">`pDataTarget`</ph> does not implement the required data target interfaces for this version of the runtime.","source":"`pDataTarget` does not implement the required data target interfaces for this version of the runtime."},{"content":"CORDBG_E_NOT_CLR","pos":[4213,4229]},{"content":"The indicated module is not a CLR module.","pos":[4230,4271]},{"content":"This HRESULT is also returned when a CLR module cannot be detected because memory has been corrupted, the module is not available, or the CLR version is later than the shim version.","pos":[4272,4453]},{"content":"CORDBG_E_UNSUPPORTED_DEBUGGING_MODEL","pos":[4458,4494]},{"content":"This runtime version does not support this debugging model.","pos":[4495,4554]},{"content":"Currently, the debugging model is not supported by CLR versions before the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph>.","pos":[4555,4696],"source":" Currently, the debugging model is not supported by CLR versions before the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]."},{"content":"The <ph id=\"ph1\">`pwszVersion`</ph> output parameter is still set to the correct value after this error.","pos":[4697,4783],"source":" The `pwszVersion` output parameter is still set to the correct value after this error."},{"content":"CORDBG_E_UNSUPPORTED_FORWARD_COMPAT","pos":[4788,4823]},{"content":"The version of the CLR is greater than the version this debugger claims to support.","pos":[4824,4907]},{"content":"The <ph id=\"ph1\">`pwszVersion`</ph> output parameter is still set to the correct value after this error.","pos":[4908,4994],"source":" The `pwszVersion` output parameter is still set to the correct value after this error."},{"content":"E_NO_INTERFACE","pos":[4999,5013]},{"pos":[5014,5059],"content":"The <ph id=\"ph1\">`riidProcess`</ph> interface is not available.","source":"The `riidProcess` interface is not available."},{"content":"CORDBG_E_UNSUPPORTED_VERSION_STRUCT","pos":[5064,5099]},{"content":"The <ph id=\"ph1\">`CLR_DEBUGGING_VERSION`</ph> structure does not have a recognized value for <ph id=\"ph2\">`wStructVersion`</ph>.","pos":[5100,5192],"source":"The `CLR_DEBUGGING_VERSION` structure does not have a recognized value for `wStructVersion`."},{"content":"The only accepted value at this time is 0.","pos":[5193,5235]},{"pos":[5245,5255],"content":"Exceptions","linkify":"Exceptions","nodes":[{"content":"Exceptions","pos":[0,10]}]},{"pos":[5264,5271],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5280,5292],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[5296,5400],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[5407,5443],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> CorDebug.idl, CorDebug.h","source":"**Header:** CorDebug.idl, CorDebug.h"},{"pos":[5450,5475],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> CorGuids.lib","source":"**Library:** CorGuids.lib"},{"pos":[5482,5590],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]"},{"pos":[5599,5607],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Debugging Interfaces<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md)</ept><ph id=\"ph1\"> </ph>","pos":[5611,5710],"source":"[Debugging Interfaces](../../../../docs/framework/unmanaged-api/debugging/debugging-interfaces.md) "},{"content":"<bpt id=\"p1\">[</bpt>Debugging<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/debugging/index.md)</ept>","pos":[5714,5786],"source":"[Debugging](../../../../docs/framework/unmanaged-api/debugging/index.md)"}]}