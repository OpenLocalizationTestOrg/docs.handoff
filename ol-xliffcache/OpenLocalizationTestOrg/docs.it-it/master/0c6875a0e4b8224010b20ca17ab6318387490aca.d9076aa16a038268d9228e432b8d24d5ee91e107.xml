{"content":"---\ntitle: \"How to: Query for Files with a Specified Attribute or Name (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: b26026a3-3f43-448f-a582-259997af6be0\n---\n# How to: Query for Files with a Specified Attribute or Name (Visual Basic)\nThis example shows how to find all files that have a specified file name extension (for example \".txt\") in a specified directory tree. It also shows how to return either the newest or oldest file in the tree based on the creation time.  \n  \n## Example  \n  \n```vb  \nModule FindFileByExtension  \n    Sub Main()  \n  \n        ' Change the drive\\path if necessary  \n        Dim root As String = \"C:\\Program Files\\Microsoft Visual Studio 9.0\"  \n  \n        'Take a snapshot of the folder contents  \n        Dim dir As New System.IO.DirectoryInfo(root)  \n  \n        Dim fileList = dir.GetFiles(\"*.*\", System.IO.SearchOption.AllDirectories)  \n  \n        ' This query will produce the full path for all .txt files  \n        ' under the specified folder including subfolders.  \n        ' It orders the list according to the file name.  \n        Dim fileQuery = From file In fileList _  \n                        Where file.Extension = \".txt\" _  \n                        Order By file.Name _  \n                        Select file  \n  \n        For Each file In fileQuery  \n            Console.WriteLine(file.FullName)  \n        Next  \n  \n        ' Create and execute a new query by using  \n        ' the previous query as a starting point.  \n        ' fileQuery is not executed again until the  \n        ' call to Last  \n        Dim fileQuery2 = From file In fileQuery _  \n                         Order By file.CreationTime _  \n                         Select file.Name, file.CreationTime  \n  \n        ' Execute the query  \n        Dim newestFile = fileQuery2.Last  \n  \n        Console.WriteLine(\"\\r\\nThe newest .txt file is {0}. Creation time: {1}\", _  \n                newestFile.Name, newestFile.CreationTime)  \n  \n        ' Keep the console window open in debug mode  \n        Console.WriteLine(\"Press any key to exit.\")  \n        Console.ReadKey()  \n  \n    End Sub  \nEnd Module  \n```  \n  \n## Compiling the Code  \n Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a   `Imports` statement for the System.Linq namespace.  \n  \n## See also\n\n- [LINQ to Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)\n- [LINQ and File Directories (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)\n","nodes":[{"pos":[4,155],"embed":true,"restype":"x-metadata","content":"title: \"How to: Query for Files with a Specified Attribute or Name (Visual Basic)\"\nms.date: 07/20/2015\nms.assetid: b26026a3-3f43-448f-a582-259997af6be0","nodes":[{"content":"How to: Query for Files with a Specified Attribute or Name (Visual Basic)","nodes":[{"pos":[0,73],"content":"How to: Query for Files with a Specified Attribute or Name (Visual Basic)","nodes":[{"content":"How to: Query for Files with a Specified Attribute or Name (Visual Basic)","pos":[0,73]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[162,235],"content":"How to: Query for Files with a Specified Attribute or Name (Visual Basic)","linkify":"How to: Query for Files with a Specified Attribute or Name (Visual Basic)","nodes":[{"content":"How to: Query for Files with a Specified Attribute or Name (Visual Basic)","pos":[0,73]}]},{"content":"This example shows how to find all files that have a specified file name extension (for example \".txt\") in a specified directory tree.","pos":[236,370]},{"content":"It also shows how to return either the newest or oldest file in the tree based on the creation time.","pos":[371,471]},{"pos":[480,487],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[2120,2138],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[2142,2307],"content":"Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a   <ph id=\"ph1\">`Imports`</ph> statement for the System.Linq namespace.","source":"Create a project that targets the .NET Framework version 3.5 or higher with a reference to System.Core.dll and a   `Imports` statement for the System.Linq namespace."},{"pos":[2316,2324],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2328,2437],"content":"<bpt id=\"p1\">[</bpt>LINQ to Objects (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)</ept>","source":"[LINQ to Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)"},{"pos":[2440,2569],"content":"<bpt id=\"p1\">[</bpt>LINQ and File Directories (Visual Basic)<ept id=\"p1\">](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)</ept>","source":"[LINQ and File Directories (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-and-file-directories.md)"}]}