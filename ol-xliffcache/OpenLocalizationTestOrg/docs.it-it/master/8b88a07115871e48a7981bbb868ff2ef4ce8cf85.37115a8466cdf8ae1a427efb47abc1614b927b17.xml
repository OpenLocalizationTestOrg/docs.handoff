{"content":"---\ntitle: \"MsgBox Sample\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"marshaling, MsgBox sample\"\n  - \"data marshaling, MsgBox sample\"\nms.assetid: 9e0edff6-cc0d-4d5c-a445-aecf283d9c3a\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# MsgBox Sample\nThis sample demonstrates how to pass string types by value as In parameters and when to use the <xref:System.Runtime.InteropServices.DllImportAttribute.EntryPoint>, <xref:System.Runtime.InteropServices.DllImportAttribute.CharSet>, and <xref:System.Runtime.InteropServices.DllImportAttribute.ExactSpelling> fields.  \n  \n The MsgBox sample uses the following unmanaged function, shown with its original function declaration:  \n  \n-   **MessageBox** exported from User32.dll.  \n  \n    ```  \n    int MessageBox(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption,   \n       UINT uType);  \n    ```  \n  \n In this sample, the `LibWrap` class contains a managed prototype for each unmanaged function called by the `MsgBoxSample` class. The managed prototype methods `MsgBox`, `MsgBox2`, and `MsgBox3` have different declarations for the same unmanaged function.  \n  \n The declaration for `MsgBox2` produces incorrect output in the message box because the character type, specified as ANSI, is mismatched with the entry point `MessageBoxW`, which is the name of the Unicode function. The declaration for `MsgBox3` creates a mismatch between the **EntryPoint**, **CharSet**, and **ExactSpelling** fields. When called, `MsgBox3` throws an exception. For detailed information on string naming and name marshaling, see [Specifying a Character Set](specifying-a-character-set.md).  \n  \n## Declaring Prototypes  \n [!code-cpp[Conceptual.Interop.Marshaling#5](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.interop.marshaling/cpp/msgbox.cpp#5)]\n [!code-csharp[Conceptual.Interop.Marshaling#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.interop.marshaling/cs/msgbox.cs#5)]\n [!code-vb[Conceptual.Interop.Marshaling#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.interop.marshaling/vb/msgbox.vb#5)]  \n  \n## Calling Functions  \n [!code-cpp[Conceptual.Interop.Marshaling#6](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.interop.marshaling/cpp/msgbox.cpp#6)]\n [!code-csharp[Conceptual.Interop.Marshaling#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.interop.marshaling/cs/msgbox.cs#6)]\n [!code-vb[Conceptual.Interop.Marshaling#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.interop.marshaling/vb/msgbox.vb#6)]  \n  \n## See also\n\n- [Marshaling Strings](marshaling-strings.md)\n- [Default Marshaling for Strings](default-marshaling-for-strings.md)\n- [Creating Prototypes in Managed Code](creating-prototypes-in-managed-code.md)\n- [Specifying a Character Set](specifying-a-character-set.md)\n","nodes":[{"pos":[4,272],"embed":true,"restype":"x-metadata","content":"title: \"MsgBox Sample\"\nms.date: \"03/30/2017\"\ndev_langs: \n  - \"csharp\"\n  - \"vb\"\n  - \"cpp\"\nhelpviewer_keywords: \n  - \"marshaling, MsgBox sample\"\n  - \"data marshaling, MsgBox sample\"\nms.assetid: 9e0edff6-cc0d-4d5c-a445-aecf283d9c3a\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"MsgBox Sample","nodes":[{"pos":[0,13],"content":"MsgBox Sample","nodes":[{"content":"MsgBox Sample","pos":[0,13]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[279,292],"content":"MsgBox Sample","linkify":"MsgBox Sample","nodes":[{"content":"MsgBox Sample","pos":[0,13]}]},{"pos":[293,606],"content":"This sample demonstrates how to pass string types by value as In parameters and when to use the <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.DllImportAttribute.EntryPoint&gt;</ph>, <ph id=\"ph2\">&lt;xref:System.Runtime.InteropServices.DllImportAttribute.CharSet&gt;</ph>, and <ph id=\"ph3\">&lt;xref:System.Runtime.InteropServices.DllImportAttribute.ExactSpelling&gt;</ph> fields.","source":"This sample demonstrates how to pass string types by value as In parameters and when to use the <xref:System.Runtime.InteropServices.DllImportAttribute.EntryPoint>, <xref:System.Runtime.InteropServices.DllImportAttribute.CharSet>, and <xref:System.Runtime.InteropServices.DllImportAttribute.ExactSpelling> fields."},{"content":"The MsgBox sample uses the following unmanaged function, shown with its original function declaration:","pos":[613,715]},{"pos":[725,765],"content":"<bpt id=\"p1\">**</bpt>MessageBox<ept id=\"p1\">**</ept> exported from User32.dll.","source":"**MessageBox** exported from User32.dll."},{"content":"In this sample, the <ph id=\"ph1\">`LibWrap`</ph> class contains a managed prototype for each unmanaged function called by the <ph id=\"ph2\">`MsgBoxSample`</ph> class.","pos":[885,1013],"source":"In this sample, the `LibWrap` class contains a managed prototype for each unmanaged function called by the `MsgBoxSample` class."},{"content":"The managed prototype methods <ph id=\"ph1\">`MsgBox`</ph>, <ph id=\"ph2\">`MsgBox2`</ph>, and <ph id=\"ph3\">`MsgBox3`</ph> have different declarations for the same unmanaged function.","pos":[1014,1139],"source":" The managed prototype methods `MsgBox`, `MsgBox2`, and `MsgBox3` have different declarations for the same unmanaged function."},{"content":"The declaration for <ph id=\"ph1\">`MsgBox2`</ph> produces incorrect output in the message box because the character type, specified as ANSI, is mismatched with the entry point <ph id=\"ph2\">`MessageBoxW`</ph>, which is the name of the Unicode function.","pos":[1146,1360],"source":"The declaration for `MsgBox2` produces incorrect output in the message box because the character type, specified as ANSI, is mismatched with the entry point `MessageBoxW`, which is the name of the Unicode function."},{"content":"The declaration for <ph id=\"ph1\">`MsgBox3`</ph> creates a mismatch between the <bpt id=\"p1\">**</bpt>EntryPoint<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>CharSet<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>ExactSpelling<ept id=\"p3\">**</ept> fields.","pos":[1361,1480],"source":" The declaration for `MsgBox3` creates a mismatch between the **EntryPoint**, **CharSet**, and **ExactSpelling** fields."},{"content":"When called, <ph id=\"ph1\">`MsgBox3`</ph> throws an exception.","pos":[1481,1524],"source":" When called, `MsgBox3` throws an exception."},{"content":"For detailed information on string naming and name marshaling, see <bpt id=\"p1\">[</bpt>Specifying a Character Set<ept id=\"p1\">](specifying-a-character-set.md)</ept>.","pos":[1525,1652],"source":" For detailed information on string naming and name marshaling, see [Specifying a Character Set](specifying-a-character-set.md)."},{"pos":[1661,1681],"content":"Declaring Prototypes","linkify":"Declaring Prototypes","nodes":[{"content":"Declaring Prototypes","pos":[0,20]}]},{"pos":[2121,2138],"content":"Calling Functions","linkify":"Calling Functions","nodes":[{"content":"Calling Functions","pos":[0,17]}]},{"pos":[2578,2586],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[2590,2633],"content":"<bpt id=\"p1\">[</bpt>Marshaling Strings<ept id=\"p1\">](marshaling-strings.md)</ept>","source":"[Marshaling Strings](marshaling-strings.md)"},{"pos":[2636,2703],"content":"<bpt id=\"p1\">[</bpt>Default Marshaling for Strings<ept id=\"p1\">](default-marshaling-for-strings.md)</ept>","source":"[Default Marshaling for Strings](default-marshaling-for-strings.md)"},{"pos":[2706,2783],"content":"<bpt id=\"p1\">[</bpt>Creating Prototypes in Managed Code<ept id=\"p1\">](creating-prototypes-in-managed-code.md)</ept>","source":"[Creating Prototypes in Managed Code](creating-prototypes-in-managed-code.md)"},{"pos":[2786,2845],"content":"<bpt id=\"p1\">[</bpt>Specifying a Character Set<ept id=\"p1\">](specifying-a-character-set.md)</ept>","source":"[Specifying a Character Set](specifying-a-character-set.md)"}]}