{"content":"---\ntitle: \"<serviceHostingEnvironment>\"\nms.date: \"03/30/2017\"\nms.assetid: 4f8a7c4f-e735-4987-979a-b74fcdae2652\n---\n# \\<serviceHostingEnvironment>\nThis element defines the type the service hosting environment instantiates for a particular transport. If this element is empty, the default type is used. This element can only be used at the application or machine level configuration files.  \n  \n \\<system.ServiceModel>  \n\\<ServiceHostingEnvironment>  \n  \n## Syntax  \n  \n```xml  \n<serviceHostingEnvironment aspNetCompatibilityEnabled=\"Boolean\"\n                           minFreeMemoryPercentageToActivateService=\"Integer\"\n                           multipleSiteBindingsEnabled=\"Boolean\">\n  <baseAddressPrefixFilters>\n    <add prefix=\"string\" />\n  </baseAddressPrefixFilters>\n  <serviceActivations>\n    <add factory=\"String\"\n         service=\"String\" />\n  </serviceActivations>\n  <transportConfigurationTypes>\n    <add name=\"String\"\n         transportConfigurationType=\"String\" />\n  </transportConfigurationTypes>\n</serviceHostingEnvironment>\n```  \n  \n## Attributes and Elements  \n The following sections describe attributes, child elements, and parent elements.  \n  \n### Attributes  \n  \n|Attribute|Description|  \n|---------------|-----------------|  \n|aspNetCompatibilityEnabled|A Boolean value indicating whether the ASP.NET compatibility mode has been turned on for the current application. The default is `false`.<br /><br /> When this attribute is set to `true`, requests to Windows Communication Foundation (WCF) services flow through the ASP.NET HTTP pipeline, and communication over non-HTTP protocols is prohibited. For more information, see [WCF Services and ASP.NET](../../../../../docs/framework/wcf/feature-details/wcf-services-and-aspnet.md).|  \n|minFreeMemoryPercentageToActivateService|An integer that specifies the minimum amount of free memory that should be available to the system, before a WCF service can be activated. **Caution:**  Specifying this attribute along with partial trust in the web.config file of a WCF service will result in a <xref:System.Security.SecurityException> when the service is run.|  \n|multipleSiteBindingsEnabled|A Boolean value that specifies whether multiple IIS bindings per site is enabled.<br /><br /> IIS consists of web sites, which are containers for virtual applications containing virtual directories. The application in a site can be accessed through one or more IIS binding. An IIS binding provides two pieces of information: a binding protocol and binding information. Binding protocol defines the scheme over which communication occurs, and binding information is the information used to access the site. An example of a binding protocol can be HTTP, whereas binding information can contain an IP address, Port, host header, etc.<br /><br /> IIS supports specifying multiple IIS bindings per site, which results in multiple base addresses per scheme. However, a Windows Communication Foundation (WCF) service hosted under a site allows binding to only one baseAddress per scheme.<br /><br /> To enable multiple IIS bindings per site for a Windows Communication Foundation (WCF) service, set this attribute to `true`. Notice that multiple site binding is supported only for the HTTP protocol. The address of endpoints in the configuration file needs to be a complete URI.|  \n  \n### Child Elements  \n  \n|Element|Description|  \n|-------------|-----------------|  \n|[\\<baseAddressPrefixFilters>](../../../../../docs/framework/configure-apps/file-schema/wcf/baseaddressprefixfilters.md)|A collection of configuration elements that specify prefix filters for the base addresses used by the service host.|  \n|[\\<serviceActivations>](../../../../../docs/framework/configure-apps/file-schema/wcf/serviceactivations.md)|A configuration section that describes activation settings.|  \n|[\\<transportConfigurationTypes>](../../../../../docs/framework/configure-apps/file-schema/wcf/transportconfigurationtypes.md)|A collection of configuration elements that identify the type of a particular transport.|  \n  \n### Parent Elements  \n  \n|Element|Description|  \n|-------------|-----------------|  \n|serviceModel|The root element of all Windows Communication Foundation (WCF) configuration elements.|  \n  \n## Remarks  \n By default, WCF services run side-by-side with ASP.NET in hosted Application Domains (AppDomain). Even though WCF and ASP.NET can coexist in the same AppDomain, WCF requests are not processed by the ASP.NET HTTP Pipeline by default. As a result, several elements of the ASP.NET application platform are not available to WCF services. These include  \n  \n-   ASP.NET File/URL Authorization  \n  \n-   ASP.NET Impersonation  \n  \n-   Cookie-based Session State  \n  \n-   HttpContext.Current  \n  \n-   Pipeline Extensibility via custom HttpModule  \n  \n If your WCF services need to function in the ASP.NET context, and communicate only over HTTP, you can use WCFâ€™s ASP.NET compatibility mode. This mode is turned on when the `aspNetCompatibilityEnabled` attribute is set to `true` at the application level. Service implementations must declare their ability to run in compatibility mode using the <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsAttribute> class. When the compatibility mode is enabled,  \n  \n-   ASP.NET File/URL Authorization is enforced prior to WCF authorization. An authorization decision is based on the transport-level identity of the request. Identities at the message level are ignored.  \n  \n-   WCF service operations start to execute in the ASP.NET impersonation context. If both ASP.NET impersonation and WCF impersonation are enabled for a specific service, the WCF impersonation context applies.  \n  \n-   HttpContext.Current can be used from WCF service code, and services are prevented from exposing non-HTTP endpoints.  \n  \n-   WCF requests are processed by the ASP.NET pipeline. HttpModules that have been configured to act on incoming requests can also process WCF requests. These can include ASP.NET platform components (e.g., <xref:System.Web.SessionState.SessionStateModule>), as well as custom third party modules.  \n  \n## Example  \n The following code sample shows how to enable ASP Compatibility Mode.  \n  \n## Code  \n  \n```xml  \n<serviceHostingEnvironment aspNetCompatibilityEnabled=\"true\"/>\n```  \n  \n## See also\n\n- <xref:System.ServiceModel.Configuration.ServiceHostingEnvironmentSection>\n- <xref:System.ServiceModel.ServiceHostingEnvironment>\n- [Hosting](../../../../../docs/framework/wcf/feature-details/hosting.md)\n- [WCF Services and ASP.NET](../../../../../docs/framework/wcf/feature-details/wcf-services-and-aspnet.md)\n","nodes":[{"pos":[4,111],"embed":true,"restype":"x-metadata","content":"title: \"<serviceHostingEnvironment>\"\nms.date: \"03/30/2017\"\nms.assetid: 4f8a7c4f-e735-4987-979a-b74fcdae2652","nodes":[{"content":"<serviceHostingEnvironment>","nodes":[],"path":["title"],"nosxs":false}],"yml":true},{"pos":[118,146],"content":"\\<serviceHostingEnvironment>","linkify":"\\<serviceHostingEnvironment>","nodes":[{"content":"<ph id=\"ph1\">\\&lt;</ph>serviceHostingEnvironment&gt;","pos":[0,28],"source":"\\<serviceHostingEnvironment>"}]},{"content":"This element defines the type the service hosting environment instantiates for a particular transport.","pos":[147,249]},{"content":"If this element is empty, the default type is used.","pos":[250,301]},{"content":"This element can only be used at the application or machine level configuration files.","pos":[302,388]},{"content":"<ph id=\"ph1\">\\&lt;</ph>system.ServiceModel&gt;","pos":[395,417],"source":"\\<system.ServiceModel>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>ServiceHostingEnvironment&gt;","pos":[420,448],"source":"\\<ServiceHostingEnvironment>"},{"pos":[457,463],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1052,1075],"content":"Attributes and Elements","linkify":"Attributes and Elements","nodes":[{"content":"Attributes and Elements","pos":[0,23]}]},{"content":"The following sections describe attributes, child elements, and parent elements.","pos":[1079,1159]},{"pos":[1169,1179],"content":"Attributes","linkify":"Attributes","nodes":[{"content":"Attributes","pos":[0,10]}]},{"content":"Attribute","pos":[1186,1195]},{"content":"Description","pos":[1196,1207]},{"content":"aspNetCompatibilityEnabled","pos":[1250,1276]},{"content":"A Boolean value indicating whether the ASP.NET compatibility mode has been turned on for the current application.","pos":[1277,1390]},{"content":"The default is <ph id=\"ph1\">`false`</ph>.","pos":[1391,1414],"source":" The default is `false`."},{"content":"When this attribute is set to <ph id=\"ph1\">`true`</ph>, requests to Windows Communication Foundation (WCF) services flow through the ASP.NET HTTP pipeline, and communication over non-HTTP protocols is prohibited.","pos":[1427,1621],"source":"When this attribute is set to `true`, requests to Windows Communication Foundation (WCF) services flow through the ASP.NET HTTP pipeline, and communication over non-HTTP protocols is prohibited."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>WCF Services and ASP.NET<ept id=\"p1\">](../../../../../docs/framework/wcf/feature-details/wcf-services-and-aspnet.md)</ept>.","pos":[1622,1753],"source":" For more information, see [WCF Services and ASP.NET](../../../../../docs/framework/wcf/feature-details/wcf-services-and-aspnet.md)."},{"content":"minFreeMemoryPercentageToActivateService","pos":[1758,1798]},{"content":"An integer that specifies the minimum amount of free memory that should be available to the system, before a WCF service can be activated.","pos":[1799,1937]},{"content":"<bpt id=\"p1\">**</bpt>Caution:<ept id=\"p1\">**</ept>  Specifying this attribute along with partial trust in the web.config file of a WCF service will result in a <ph id=\"ph1\">&lt;xref:System.Security.SecurityException&gt;</ph> when the service is run.","pos":[1938,2125],"source":"**Caution:**  Specifying this attribute along with partial trust in the web.config file of a WCF service will result in a <xref:System.Security.SecurityException> when the service is run."},{"content":"multipleSiteBindingsEnabled","pos":[2130,2157]},{"content":"A Boolean value that specifies whether multiple IIS bindings per site is enabled.","pos":[2158,2239]},{"content":"IIS consists of web sites, which are containers for virtual applications containing virtual directories.","pos":[2252,2356]},{"content":"The application in a site can be accessed through one or more IIS binding.","pos":[2357,2431]},{"content":"An IIS binding provides two pieces of information: a binding protocol and binding information.","pos":[2432,2526]},{"content":"Binding protocol defines the scheme over which communication occurs, and binding information is the information used to access the site.","pos":[2527,2663]},{"content":"An example of a binding protocol can be HTTP, whereas binding information can contain an IP address, Port, host header, etc.","pos":[2664,2788]},{"content":"IIS supports specifying multiple IIS bindings per site, which results in multiple base addresses per scheme.","pos":[2801,2909]},{"content":"However, a Windows Communication Foundation (WCF) service hosted under a site allows binding to only one baseAddress per scheme.","pos":[2910,3038]},{"content":"To enable multiple IIS bindings per site for a Windows Communication Foundation (WCF) service, set this attribute to <ph id=\"ph1\">`true`</ph>.","pos":[3051,3175],"source":"To enable multiple IIS bindings per site for a Windows Communication Foundation (WCF) service, set this attribute to `true`."},{"content":"Notice that multiple site binding is supported only for the HTTP protocol.","pos":[3176,3250]},{"content":"The address of endpoints in the configuration file needs to be a complete URI.","pos":[3251,3329]},{"pos":[3340,3354],"content":"Child Elements","linkify":"Child Elements","nodes":[{"content":"Child Elements","pos":[0,14]}]},{"content":"Element","pos":[3361,3368]},{"content":"Description","pos":[3369,3380]},{"pos":[3421,3540],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>baseAddressPrefixFilters&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/wcf/baseaddressprefixfilters.md)</ept>","source":"[\\<baseAddressPrefixFilters>](../../../../../docs/framework/configure-apps/file-schema/wcf/baseaddressprefixfilters.md)"},{"content":"A collection of configuration elements that specify prefix filters for the base addresses used by the service host.","pos":[3541,3656]},{"pos":[3661,3768],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>serviceActivations&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/wcf/serviceactivations.md)</ept>","source":"[\\<serviceActivations>](../../../../../docs/framework/configure-apps/file-schema/wcf/serviceactivations.md)"},{"content":"A configuration section that describes activation settings.","pos":[3769,3828]},{"pos":[3833,3958],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\&lt;</ph>transportConfigurationTypes&gt;<ept id=\"p1\">](../../../../../docs/framework/configure-apps/file-schema/wcf/transportconfigurationtypes.md)</ept>","source":"[\\<transportConfigurationTypes>](../../../../../docs/framework/configure-apps/file-schema/wcf/transportconfigurationtypes.md)"},{"content":"A collection of configuration elements that identify the type of a particular transport.","pos":[3959,4047]},{"pos":[4058,4073],"content":"Parent Elements","linkify":"Parent Elements","nodes":[{"content":"Parent Elements","pos":[0,15]}]},{"content":"Element","pos":[4080,4087]},{"content":"Description","pos":[4088,4099]},{"content":"serviceModel","pos":[4140,4152]},{"content":"The root element of all Windows Communication Foundation (WCF) configuration elements.","pos":[4153,4239]},{"pos":[4249,4256],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"By default, WCF services run side-by-side with ASP.NET in hosted Application Domains (AppDomain).","pos":[4260,4357]},{"content":"Even though WCF and ASP.NET can coexist in the same AppDomain, WCF requests are not processed by the ASP.NET HTTP Pipeline by default.","pos":[4358,4492]},{"content":"As a result, several elements of the ASP.NET application platform are not available to WCF services.","pos":[4493,4593]},{"content":"These include","pos":[4594,4607]},{"content":"ASP.NET File/URL Authorization","pos":[4617,4647]},{"content":"ASP.NET Impersonation","pos":[4657,4678]},{"content":"Cookie-based Session State","pos":[4688,4714]},{"content":"HttpContext.Current","pos":[4724,4743]},{"content":"Pipeline Extensibility via custom HttpModule","pos":[4753,4797]},{"content":"If your WCF services need to function in the ASP.NET context, and communicate only over HTTP, you can use WCFâ€™s ASP.NET compatibility mode.","pos":[4804,4943]},{"content":"This mode is turned on when the <ph id=\"ph1\">`aspNetCompatibilityEnabled`</ph> attribute is set to <ph id=\"ph2\">`true`</ph> at the application level.","pos":[4944,5057],"source":" This mode is turned on when the `aspNetCompatibilityEnabled` attribute is set to `true` at the application level."},{"content":"Service implementations must declare their ability to run in compatibility mode using the <ph id=\"ph1\">&lt;xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsAttribute&gt;</ph> class.","pos":[5058,5233],"source":" Service implementations must declare their ability to run in compatibility mode using the <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsAttribute> class."},{"content":"When the compatibility mode is enabled,","pos":[5234,5273]},{"content":"ASP.NET File/URL Authorization is enforced prior to WCF authorization.","pos":[5283,5353]},{"content":"An authorization decision is based on the transport-level identity of the request.","pos":[5354,5436]},{"content":"Identities at the message level are ignored.","pos":[5437,5481]},{"content":"WCF service operations start to execute in the ASP.NET impersonation context.","pos":[5491,5568]},{"content":"If both ASP.NET impersonation and WCF impersonation are enabled for a specific service, the WCF impersonation context applies.","pos":[5569,5695]},{"content":"HttpContext.Current can be used from WCF service code, and services are prevented from exposing non-HTTP endpoints.","pos":[5705,5820]},{"content":"WCF requests are processed by the ASP.NET pipeline.","pos":[5830,5881]},{"content":"HttpModules that have been configured to act on incoming requests can also process WCF requests.","pos":[5882,5978]},{"content":"These can include ASP.NET platform components (e.g., <ph id=\"ph1\">&lt;xref:System.Web.SessionState.SessionStateModule&gt;</ph>), as well as custom third party modules.","pos":[5979,6122],"source":" These can include ASP.NET platform components (e.g., <xref:System.Web.SessionState.SessionStateModule>), as well as custom third party modules."},{"pos":[6131,6138],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following code sample shows how to enable ASP Compatibility Mode.","pos":[6142,6211]},{"pos":[6220,6224],"content":"Code","linkify":"Code","nodes":[{"content":"Code","pos":[0,4]}]},{"pos":[6314,6322],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[6457,6528],"content":"<bpt id=\"p1\">[</bpt>Hosting<ept id=\"p1\">](../../../../../docs/framework/wcf/feature-details/hosting.md)</ept>","source":"[Hosting](../../../../../docs/framework/wcf/feature-details/hosting.md)"},{"pos":[6531,6635],"content":"<bpt id=\"p1\">[</bpt>WCF Services and ASP.NET<ept id=\"p1\">](../../../../../docs/framework/wcf/feature-details/wcf-services-and-aspnet.md)</ept>","source":"[WCF Services and ASP.NET](../../../../../docs/framework/wcf/feature-details/wcf-services-and-aspnet.md)"}]}