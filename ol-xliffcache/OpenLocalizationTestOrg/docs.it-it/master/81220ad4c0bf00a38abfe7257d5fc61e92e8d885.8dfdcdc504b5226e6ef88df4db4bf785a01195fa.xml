{"content":"---\ntitle: \"How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"COM [Windows Forms]\"\n  - \"Windows Forms, unmanaged\"\n  - \"COM interop [Windows Forms], calling methods\"\n  - \"ActiveX controls [Windows Forms], COM interop\"\n  - \"Windows Forms, interop\"\nms.assetid: 87aac8ad-3c04-43b3-9b0c-d0b00df9ee74\n---\n# How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method\nYou can resolve Component Object Model (COM) interoperability problems by displaying your Windows Form on a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> method.  \n  \n To make a form work correctly from a COM client application, you must run it on a Windows Forms message loop. To do this, use one of the following approaches:  \n  \n-   Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the Windows Form;  \n  \n-   Display each Windows Form on a separate thread. For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).  \n  \n## Procedure  \n Using the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method can be the easiest way to display a form on a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop because, of all the approaches, it requires the least code to implement.  \n  \n The <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method suspends the unmanaged application's message loop and displays the form as a dialog box. Because the host application's message loop has been suspended, the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method creates a new [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop to process the form's messages.  \n  \n The disadvantage of using the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method is that the form will be opened as a modal dialog box. This behavior blocks any user interface (UI) in the calling application while the Windows Form is open. When the user exits the form, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop closes and the earlier application's message loop starts running again.  \n  \n You can create a class library in Windows Forms which has a method to show the form, and then build the class library for COM interop. You can use this DLL file from Visual Basic 6.0 or Microsoft Foundation Classes (MFC), and from either of these environments you can call the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the form.  \n  \n#### To support COM interop by displaying a windows form with the ShowDialog method  \n  \n-   Replace all calls to the <xref:System.Windows.Forms.Form.Show%2A?displayProperty=nameWithType> method with calls to the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method in your [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] component.  \n  \n## See also\n\n- [Exposing .NET Framework Components to COM](../../interop/exposing-dotnet-components-to-com.md)\n- [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)\n- [Windows Forms and Unmanaged Applications](windows-forms-and-unmanaged-applications.md)\n","nodes":[{"pos":[4,378],"embed":true,"restype":"x-metadata","content":"title: \"How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method\"\nms.date: \"03/30/2017\"\nhelpviewer_keywords: \n  - \"COM [Windows Forms]\"\n  - \"Windows Forms, unmanaged\"\n  - \"COM interop [Windows Forms], calling methods\"\n  - \"ActiveX controls [Windows Forms], COM interop\"\n  - \"Windows Forms, interop\"\nms.assetid: 87aac8ad-3c04-43b3-9b0c-d0b00df9ee74","nodes":[{"content":"How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method","nodes":[{"pos":[0,83],"content":"How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method","nodes":[{"content":"How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method","pos":[0,83]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[385,468],"content":"How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method","linkify":"How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method","nodes":[{"content":"How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method","pos":[0,83]}]},{"pos":[469,768],"content":"You can resolve Component Object Model (COM) interoperability problems by displaying your Windows Form on a <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> message loop, which is created by using the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType&gt;</ph> method.","source":"You can resolve Component Object Model (COM) interoperability problems by displaying your Windows Form on a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> method."},{"content":"To make a form work correctly from a COM client application, you must run it on a Windows Forms message loop.","pos":[775,884]},{"content":"To do this, use one of the following approaches:","pos":[885,933]},{"pos":[943,1062],"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType&gt;</ph> method to display the Windows Form;","source":"Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the Windows Form;"},{"content":"Display each Windows Form on a separate thread.","pos":[1072,1119]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread<ept id=\"p1\">](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)</ept>.","pos":[1120,1307],"source":" For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)."},{"pos":[1316,1325],"content":"Procedure","linkify":"Procedure","nodes":[{"content":"Procedure","pos":[0,9]}]},{"pos":[1329,1617],"content":"Using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType&gt;</ph> method can be the easiest way to display a form on a <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> message loop because, of all the approaches, it requires the least code to implement.","source":"Using the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method can be the easiest way to display a form on a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop because, of all the approaches, it requires the least code to implement."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType&gt;</ph> method suspends the unmanaged application's message loop and displays the form as a dialog box.","pos":[1624,1799],"source":"The <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method suspends the unmanaged application's message loop and displays the form as a dialog box."},{"content":"Because the host application's message loop has been suspended, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType&gt;</ph> method creates a new <ph id=\"ph2\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> message loop to process the form's messages.","pos":[1800,2073],"source":" Because the host application's message loop has been suspended, the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method creates a new [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop to process the form's messages."},{"content":"The disadvantage of using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType&gt;</ph> method is that the form will be opened as a modal dialog box.","pos":[2080,2247],"source":"The disadvantage of using the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method is that the form will be opened as a modal dialog box."},{"content":"This behavior blocks any user interface (UI) in the calling application while the Windows Form is open.","pos":[2248,2351]},{"content":"When the user exits the form, the <ph id=\"ph1\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> message loop closes and the earlier application's message loop starts running again.","pos":[2352,2534],"source":" When the user exits the form, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop closes and the earlier application's message loop starts running again."},{"content":"You can create a class library in Windows Forms which has a method to show the form, and then build the class library for COM interop.","pos":[2541,2675]},{"content":"You can use this DLL file from Visual Basic 6.0 or Microsoft Foundation Classes (MFC), and from either of these environments you can call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType&gt;</ph> method to display the form.","pos":[2676,2921],"source":" You can use this DLL file from Visual Basic 6.0 or Microsoft Foundation Classes (MFC), and from either of these environments you can call the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the form."},{"pos":[2932,3010],"content":"To support COM interop by displaying a windows form with the ShowDialog method","linkify":"To support COM interop by displaying a windows form with the ShowDialog method","nodes":[{"content":"To support COM interop by displaying a windows form with the ShowDialog method","pos":[0,78]}]},{"pos":[3020,3305],"content":"Replace all calls to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Form.Show%2A?displayProperty=nameWithType&gt;</ph> method with calls to the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType&gt;</ph> method in your <ph id=\"ph3\">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]</ph> component.","source":"Replace all calls to the <xref:System.Windows.Forms.Form.Show%2A?displayProperty=nameWithType> method with calls to the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method in your [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] component."},{"pos":[3314,3322],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3326,3421],"content":"<bpt id=\"p1\">[</bpt>Exposing .NET Framework Components to COM<ept id=\"p1\">](../../interop/exposing-dotnet-components-to-com.md)</ept>","source":"[Exposing .NET Framework Components to COM](../../interop/exposing-dotnet-components-to-com.md)"},{"pos":[3424,3584],"content":"<bpt id=\"p1\">[</bpt>How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread<ept id=\"p1\">](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)</ept>","source":"[How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)"},{"pos":[3587,3674],"content":"<bpt id=\"p1\">[</bpt>Windows Forms and Unmanaged Applications<ept id=\"p1\">](windows-forms-and-unmanaged-applications.md)</ept>","source":"[Windows Forms and Unmanaged Applications](windows-forms-and-unmanaged-applications.md)"}]}