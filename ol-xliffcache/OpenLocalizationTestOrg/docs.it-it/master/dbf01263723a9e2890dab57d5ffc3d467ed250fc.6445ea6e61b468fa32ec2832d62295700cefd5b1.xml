{"content":"---\ntitle: \"CType Function (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords:\n  - \"vb.CType\"\nhelpviewer_keywords:\n  - \"expression conversion results\"\n  - \"explicit data type conversions [Visual Basic]\"\n  - \"CType function\"\n  - \"conversions [Visual Basic], expression\"\nms.assetid: dd4b29e7-6fa1-428c-877e-69955420bb72\n---\n\n# CType Function (Visual Basic)\n\nReturns the result of explicitly converting an expression to a specified data type, object, structure, class, or interface.\n\n## Syntax\n\n```\nCType(expression, typename)\n```\n\n## Parts\n\n`expression`\nAny valid expression. If the value of `expression` is outside the range allowed by `typename`, Visual Basic throws an exception.\n\n`typename`\nAny expression that is legal within an `As` clause in a `Dim` statement, that is, the name of any data type, object, structure, class, or interface.\n\n## Remarks\n\n> [!TIP]\n> You can also use the following functions to perform a type conversion:\n>\n> - Type conversion functions such as `CByte`, `CDbl`, and `CInt` that perform a conversion to a specific data type. For more information, see [Type Conversion Functions](../../../visual-basic/language-reference/functions/type-conversion-functions.md).\n> - [DirectCast Operator](../../../visual-basic/language-reference/operators/directcast-operator.md) or [TryCast Operator](../../../visual-basic/language-reference/operators/trycast-operator.md). These operators require that one type inherit from or implement the other type. They can provide somewhat better performance than `CType` when converting to and from the `Object` data type.\n\n`CType` is compiled inline, which means that the conversion code is part of the code that evaluates the expression. In some cases, the code runs faster because no procedures are called to perform the conversion.\n\nIf no conversion is defined from `expression` to `typename` (for example, from `Integer` to `Date`), Visual Basic displays a compile-time error message.\n\nIf a conversion fails at run time, the appropriate exception is thrown. If a narrowing conversion fails, an <xref:System.OverflowException> is the most common result. If the conversion is undefined, an <xref:System.InvalidCastException> in thrown. For example, this can happen  if `expression` is of type `Object` and its run-time type has no conversion to `typename`.\n\nIf the data type of `expression` or `typename` is a class or structure you've defined, you can define `CType` on that class or structure as a conversion operator. This makes `CType` act as an *overloaded operator*. If you do this, you can control the behavior of conversions to and from your class or structure, including the exceptions that can be thrown.\n\n## Overloading\n\nThe `CType` operator can also be overloaded on a class or structure defined outside your code. If your code converts to or from such a class or structure, be sure you understand the behavior of its `CType` operator. For more information, see [Operator Procedures](../../../visual-basic/programming-guide/language-features/procedures/operator-procedures.md).\n\n## Converting Dynamic Objects\n\nType conversions of dynamic objects are performed by user-defined dynamic conversions that use the <xref:System.Dynamic.DynamicObject.TryConvert%2A> or <xref:System.Dynamic.DynamicMetaObject.BindConvert%2A> methods. If you're working with dynamic objects, use the <xref:Microsoft.VisualBasic.Conversion.CTypeDynamic%2A> method to convert the dynamic object.\n\n## Example\n\nThe following example uses the `CType` function to convert an expression to the `Single` data type.\n\n[!code-vb[VbVbalrFunctions#24](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#24)]\n\nFor additional examples, see [Implicit and Explicit Conversions](../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md).\n\n## See also\n\n- <xref:System.OverflowException>\n- <xref:System.InvalidCastException>\n- [Type Conversion Functions](../../../visual-basic/language-reference/functions/type-conversion-functions.md)\n- [Conversion Functions](../../../visual-basic/language-reference/functions/conversion-functions.md)\n- [Operator Statement](../../../visual-basic/language-reference/statements/operator-statement.md)\n- [How to: Define a Conversion Operator](../../../visual-basic/programming-guide/language-features/procedures/how-to-define-a-conversion-operator.md)\n- [Type Conversion in the .NET Framework](../../../standard/base-types/type-conversion.md)\n","nodes":[{"pos":[4,314],"embed":true,"restype":"x-metadata","content":"title: \"CType Function (Visual Basic)\"\nms.date: 07/20/2015\nf1_keywords:\n  - \"vb.CType\"\nhelpviewer_keywords:\n  - \"expression conversion results\"\n  - \"explicit data type conversions [Visual Basic]\"\n  - \"CType function\"\n  - \"conversions [Visual Basic], expression\"\nms.assetid: dd4b29e7-6fa1-428c-877e-69955420bb72","nodes":[{"content":"CType Function (Visual Basic)","nodes":[{"pos":[0,29],"content":"CType Function (Visual Basic)","nodes":[{"content":"CType Function (Visual Basic)","pos":[0,29]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[322,351],"content":"CType Function (Visual Basic)","linkify":"CType Function (Visual Basic)","nodes":[{"content":"CType Function (Visual Basic)","pos":[0,29]}]},{"content":"Returns the result of explicitly converting an expression to a specified data type, object, structure, class, or interface.","pos":[353,476]},{"pos":[481,487],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[529,534],"content":"Parts","linkify":"Parts","nodes":[{"content":"Parts","pos":[0,5]}]},{"content":"<ph id=\"ph1\">`expression`</ph> Any valid expression.","pos":[536,570],"source":"`expression`\nAny valid expression."},{"content":"If the value of <ph id=\"ph1\">`expression`</ph> is outside the range allowed by <ph id=\"ph2\">`typename`</ph>, Visual Basic throws an exception.","pos":[571,677],"source":" If the value of `expression` is outside the range allowed by `typename`, Visual Basic throws an exception."},{"pos":[679,838],"content":"<ph id=\"ph1\">`typename`</ph> Any expression that is legal within an <ph id=\"ph2\">`As`</ph> clause in a <ph id=\"ph3\">`Dim`</ph> statement, that is, the name of any data type, object, structure, class, or interface.","source":"`typename`\nAny expression that is legal within an `As` clause in a `Dim` statement, that is, the name of any data type, object, structure, class, or interface."},{"pos":[843,850],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[854,933],"content":"[!TIP]\nYou can also use the following functions to perform a type conversion:","leadings":["","> "],"nodes":[{"content":"You can also use the following functions to perform a type conversion:","pos":[7,77]}]},{"content":"Type conversion functions such as <ph id=\"ph1\">`CByte`</ph>, <ph id=\"ph2\">`CDbl`</ph>, and <ph id=\"ph3\">`CInt`</ph> that perform a conversion to a specific data type.","pos":[940,1052],"source":"Type conversion functions such as `CByte`, `CDbl`, and `CInt` that perform a conversion to a specific data type."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Type Conversion Functions<ept id=\"p1\">](../../../visual-basic/language-reference/functions/type-conversion-functions.md)</ept>.","pos":[1053,1188],"source":" For more information, see [Type Conversion Functions](../../../visual-basic/language-reference/functions/type-conversion-functions.md)."},{"content":"<bpt id=\"p1\">[</bpt>DirectCast Operator<ept id=\"p1\">](../../../visual-basic/language-reference/operators/directcast-operator.md)</ept> or <bpt id=\"p2\">[</bpt>TryCast Operator<ept id=\"p2\">](../../../visual-basic/language-reference/operators/trycast-operator.md)</ept>.","pos":[1193,1384],"source":"[DirectCast Operator](../../../visual-basic/language-reference/operators/directcast-operator.md) or [TryCast Operator](../../../visual-basic/language-reference/operators/trycast-operator.md)."},{"content":"These operators require that one type inherit from or implement the other type.","pos":[1385,1464]},{"content":"They can provide somewhat better performance than <ph id=\"ph1\">`CType`</ph> when converting to and from the <ph id=\"ph2\">`Object`</ph> data type.","pos":[1465,1574],"source":" They can provide somewhat better performance than `CType` when converting to and from the `Object` data type."},{"content":"<ph id=\"ph1\">`CType`</ph> is compiled inline, which means that the conversion code is part of the code that evaluates the expression.","pos":[1576,1691],"source":"`CType` is compiled inline, which means that the conversion code is part of the code that evaluates the expression."},{"content":"In some cases, the code runs faster because no procedures are called to perform the conversion.","pos":[1692,1787]},{"pos":[1789,1941],"content":"If no conversion is defined from <ph id=\"ph1\">`expression`</ph> to <ph id=\"ph2\">`typename`</ph> (for example, from <ph id=\"ph3\">`Integer`</ph> to <ph id=\"ph4\">`Date`</ph>), Visual Basic displays a compile-time error message.","source":"If no conversion is defined from `expression` to `typename` (for example, from `Integer` to `Date`), Visual Basic displays a compile-time error message."},{"content":"If a conversion fails at run time, the appropriate exception is thrown.","pos":[1943,2014]},{"content":"If a narrowing conversion fails, an <ph id=\"ph1\">&lt;xref:System.OverflowException&gt;</ph> is the most common result.","pos":[2015,2109],"source":" If a narrowing conversion fails, an <xref:System.OverflowException> is the most common result."},{"content":"If the conversion is undefined, an <ph id=\"ph1\">&lt;xref:System.InvalidCastException&gt;</ph> in thrown.","pos":[2110,2190],"source":" If the conversion is undefined, an <xref:System.InvalidCastException> in thrown."},{"content":"For example, this can happen  if <ph id=\"ph1\">`expression`</ph> is of type <ph id=\"ph2\">`Object`</ph> and its run-time type has no conversion to <ph id=\"ph3\">`typename`</ph>.","pos":[2191,2311],"source":" For example, this can happen  if `expression` is of type `Object` and its run-time type has no conversion to `typename`."},{"content":"If the data type of <ph id=\"ph1\">`expression`</ph> or <ph id=\"ph2\">`typename`</ph> is a class or structure you've defined, you can define <ph id=\"ph3\">`CType`</ph> on that class or structure as a conversion operator.","pos":[2313,2475],"source":"If the data type of `expression` or `typename` is a class or structure you've defined, you can define `CType` on that class or structure as a conversion operator."},{"content":"This makes <ph id=\"ph1\">`CType`</ph> act as an <bpt id=\"p1\">*</bpt>overloaded operator<ept id=\"p1\">*</ept>.","pos":[2476,2527],"source":" This makes `CType` act as an *overloaded operator*."},{"content":"If you do this, you can control the behavior of conversions to and from your class or structure, including the exceptions that can be thrown.","pos":[2528,2669]},{"pos":[2674,2685],"content":"Overloading","linkify":"Overloading","nodes":[{"content":"Overloading","pos":[0,11]}]},{"content":"The <ph id=\"ph1\">`CType`</ph> operator can also be overloaded on a class or structure defined outside your code.","pos":[2687,2781],"source":"The `CType` operator can also be overloaded on a class or structure defined outside your code."},{"content":"If your code converts to or from such a class or structure, be sure you understand the behavior of its <ph id=\"ph1\">`CType`</ph> operator.","pos":[2782,2902],"source":" If your code converts to or from such a class or structure, be sure you understand the behavior of its `CType` operator."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Operator Procedures<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/operator-procedures.md)</ept>.","pos":[2903,3044],"source":" For more information, see [Operator Procedures](../../../visual-basic/programming-guide/language-features/procedures/operator-procedures.md)."},{"pos":[3049,3075],"content":"Converting Dynamic Objects","linkify":"Converting Dynamic Objects","nodes":[{"content":"Converting Dynamic Objects","pos":[0,26]}]},{"content":"Type conversions of dynamic objects are performed by user-defined dynamic conversions that use the <ph id=\"ph1\">&lt;xref:System.Dynamic.DynamicObject.TryConvert%2A&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Dynamic.DynamicMetaObject.BindConvert%2A&gt;</ph> methods.","pos":[3077,3292],"source":"Type conversions of dynamic objects are performed by user-defined dynamic conversions that use the <xref:System.Dynamic.DynamicObject.TryConvert%2A> or <xref:System.Dynamic.DynamicMetaObject.BindConvert%2A> methods."},{"content":"If you're working with dynamic objects, use the <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.Conversion.CTypeDynamic%2A&gt;</ph> method to convert the dynamic object.","pos":[3293,3434],"source":" If you're working with dynamic objects, use the <xref:Microsoft.VisualBasic.Conversion.CTypeDynamic%2A> method to convert the dynamic object."},{"pos":[3439,3446],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3448,3547],"content":"The following example uses the <ph id=\"ph1\">`CType`</ph> function to convert an expression to the <ph id=\"ph2\">`Single`</ph> data type.","source":"The following example uses the `CType` function to convert an expression to the `Single` data type."},{"pos":[3668,3840],"content":"For additional examples, see <bpt id=\"p1\">[</bpt>Implicit and Explicit Conversions<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)</ept>.","source":"For additional examples, see [Implicit and Explicit Conversions](../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)."},{"pos":[3845,3853],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[3928,4036],"content":"<bpt id=\"p1\">[</bpt>Type Conversion Functions<ept id=\"p1\">](../../../visual-basic/language-reference/functions/type-conversion-functions.md)</ept>","source":"[Type Conversion Functions](../../../visual-basic/language-reference/functions/type-conversion-functions.md)"},{"pos":[4039,4137],"content":"<bpt id=\"p1\">[</bpt>Conversion Functions<ept id=\"p1\">](../../../visual-basic/language-reference/functions/conversion-functions.md)</ept>","source":"[Conversion Functions](../../../visual-basic/language-reference/functions/conversion-functions.md)"},{"pos":[4140,4235],"content":"<bpt id=\"p1\">[</bpt>Operator Statement<ept id=\"p1\">](../../../visual-basic/language-reference/statements/operator-statement.md)</ept>","source":"[Operator Statement](../../../visual-basic/language-reference/statements/operator-statement.md)"},{"pos":[4238,4385],"content":"<bpt id=\"p1\">[</bpt>How to: Define a Conversion Operator<ept id=\"p1\">](../../../visual-basic/programming-guide/language-features/procedures/how-to-define-a-conversion-operator.md)</ept>","source":"[How to: Define a Conversion Operator](../../../visual-basic/programming-guide/language-features/procedures/how-to-define-a-conversion-operator.md)"},{"pos":[4388,4476],"content":"<bpt id=\"p1\">[</bpt>Type Conversion in the .NET Framework<ept id=\"p1\">](../../../standard/base-types/type-conversion.md)</ept>","source":"[Type Conversion in the .NET Framework](../../../standard/base-types/type-conversion.md)"}]}