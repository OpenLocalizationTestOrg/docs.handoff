{"content":"---\ntitle: \"How to: Receive Strings From Serial Ports in Visual Basic | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"2015-07-20\"\nms.prod: .net\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-visual-basic\"\n\nms.topic: \"article\"\ndev_langs: \n  - \"VB\"\nhelpviewer_keywords: \n  - \"serial ports, retrieving strings\"\n  - \"strings [Visual Basic], retrieving from serial ports\"\n  - \"My.Resources object\"\nms.assetid: 8371ce2c-e1c7-476b-a86d-9afc2614b6b7\ncaps.latest.revision: 21\nauthor: dotnet-bot\nms.author: dotnetcontent\n\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Receive Strings From Serial Ports in Visual Basic\nThis topic describes how to use `My.Computer.Ports` to receive strings from the computer's serial ports in [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)].  \n  \n### To receive strings from the serial port  \n  \n1.  Initialize the return string.  \n  \n     [!code-vb[VbVbalrMyComputer#38](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_1.vb)]  \n  \n2.  Determine which serial port should provide the strings. This example assumes it is `COM1`.  \n  \n3.  Use the `My.Computer.Ports.OpenSerialPort` method to obtain a reference to the port. For more information, see <xref:Microsoft.VisualBasic.Devices.Ports.OpenSerialPort%2A>.  \n  \n     The `Try...Catch...Finally` block allows the application to close the serial port even if it generates an exception. All code that manipulates the serial port should appear within this block.  \n  \n     [!code-vb[VbVbalrMyComputer#39](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_2.vb)]  \n  \n4.  Create a `Do` loop for reading lines of text until no more lines are available.  \n  \n     [!code-vb[VbVbalrMyComputer#40](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_3.vb)]  \n  \n5.  Use the <xref:System.IO.Ports.SerialPort.ReadLine%2A> method to read the next available line of text from the serial port.  \n  \n     [!code-vb[VbVbalrMyComputer#41](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_4.vb)]  \n  \n6.  Use an `If` statement to determine if the <xref:System.IO.Ports.SerialPort.ReadLine%2A> method returns `Nothing` (which means no more text is available). If it does return `Nothing`, exit the `Do` loop.  \n  \n     [!code-vb[VbVbalrMyComputer#42](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_5.vb)]  \n  \n7.  Add an `Else` block to the `If` statement to handle the case if the string is actually read. The block appends the string from the serial port to the return string.  \n  \n     [!code-vb[VbVbalrMyComputer#43](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_6.vb)]  \n  \n8.  Return the string.  \n  \n     [!code-vb[VbVbalrMyComputer#44](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_7.vb)]  \n  \n## Example  \n [!code-vb[VbVbalrMyComputer#37](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_8.vb)]  \n  \n This code example is also available as an IntelliSense code snippet. In the code snippet picker, it is located in **Connectivity and Networking**. For more information, see [Code Snippets](https://docs.microsoft.com/visualstudio/ide/code-snippets).  \n  \n## Compiling the Code  \n This example assumes the computer is using `COM1`.  \n  \n## Robust Programming  \n This example assumes the computer is using `COM1`. For more flexibility, the code should allow the user to select the desired serial port from a list of available ports. For more information, see [How to: Show Available Serial Ports](../../../../visual-basic/developing-apps/programming/computer-resources/how-to-show-available-serial-ports.md).  \n  \n This example uses a `Try...Catch...Finally` block to make sure that the application closes the port and to catch any timeout exceptions. For more information, see [Try...Catch...Finally Statement](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md).  \n  \n## See Also  \n <xref:Microsoft.VisualBasic.Devices.Ports>   \n <xref:System.IO.Ports.SerialPort?displayProperty=fullName>   \n [How to: Dial Modems Attached to Serial Ports](../../../../visual-basic/developing-apps/programming/computer-resources/how-to-dial-modems-attached-to-serial-ports.md)   \n [How to: Send Strings to Serial Ports](../../../../visual-basic/developing-apps/programming/computer-resources/how-to-send-strings-to-serial-ports.md)   \n [How to: Show Available Serial Ports](../../../../visual-basic/developing-apps/programming/computer-resources/how-to-show-available-serial-ports.md)","nodes":[{"pos":[12,86],"content":"How to: Receive Strings From Serial Ports in Visual Basic | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Receive Strings From Serial Ports in Visual Basic | Microsoft Docs","pos":[0,74]}]},{"pos":[705,762],"content":"How to: Receive Strings From Serial Ports in Visual Basic","linkify":"How to: Receive Strings From Serial Ports in Visual Basic","nodes":[{"content":"How to: Receive Strings From Serial Ports in Visual Basic","pos":[0,57]}]},{"pos":[763,963],"content":"This topic describes how to use <ph id=\"ph1\">`My.Computer.Ports`</ph> to receive strings from the computer's serial ports in <ph id=\"ph2\">[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]</ph>.","source":"This topic describes how to use `My.Computer.Ports` to receive strings from the computer's serial ports in [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]."},{"pos":[973,1012],"content":"To receive strings from the serial port","linkify":"To receive strings from the serial port","nodes":[{"content":"To receive strings from the serial port","pos":[0,39]}]},{"content":"Initialize the return string.","pos":[1022,1051]},{"pos":[1062,1237],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrMyComputer#38<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_1.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrMyComputer#38](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_1.vb)]"},{"content":"Determine which serial port should provide the strings.","pos":[1247,1302]},{"content":"This example assumes it is <ph id=\"ph1\">`COM1`</ph>.","pos":[1303,1337],"source":" This example assumes it is `COM1`."},{"content":"Use the <ph id=\"ph1\">`My.Computer.Ports.OpenSerialPort`</ph> method to obtain a reference to the port.","pos":[1347,1431],"source":"Use the `My.Computer.Ports.OpenSerialPort` method to obtain a reference to the port."},{"content":"For more information, see <ph id=\"ph1\">&lt;xref:Microsoft.VisualBasic.Devices.Ports.OpenSerialPort%2A&gt;</ph>.","pos":[1432,1519],"source":" For more information, see <xref:Microsoft.VisualBasic.Devices.Ports.OpenSerialPort%2A>."},{"content":"The <ph id=\"ph1\">`Try...Catch...Finally`</ph> block allows the application to close the serial port even if it generates an exception.","pos":[1530,1646],"source":"The `Try...Catch...Finally` block allows the application to close the serial port even if it generates an exception."},{"content":"All code that manipulates the serial port should appear within this block.","pos":[1647,1721]},{"pos":[1732,1907],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrMyComputer#39<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_2.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrMyComputer#39](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_2.vb)]"},{"pos":[1917,1996],"content":"Create a <ph id=\"ph1\">`Do`</ph> loop for reading lines of text until no more lines are available.","source":"Create a `Do` loop for reading lines of text until no more lines are available."},{"pos":[2007,2182],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrMyComputer#40<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_3.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrMyComputer#40](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_3.vb)]"},{"content":"Use the <ph id=\"ph1\">&lt;xref:System.IO.Ports.SerialPort.ReadLine%2A&gt;</ph> method to read the next available line of text from the serial port.","pos":[2192,2314],"source":"Use the <xref:System.IO.Ports.SerialPort.ReadLine%2A> method to read the next available line of text from the serial port."},{"pos":[2325,2500],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrMyComputer#41<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_4.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrMyComputer#41](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_4.vb)]"},{"content":"Use an <ph id=\"ph1\">`If`</ph> statement to determine if the <ph id=\"ph2\">&lt;xref:System.IO.Ports.SerialPort.ReadLine%2A&gt;</ph> method returns <ph id=\"ph3\">`Nothing`</ph> (which means no more text is available).","pos":[2510,2663],"source":"Use an `If` statement to determine if the <xref:System.IO.Ports.SerialPort.ReadLine%2A> method returns `Nothing` (which means no more text is available)."},{"content":"If it does return <ph id=\"ph1\">`Nothing`</ph>, exit the <ph id=\"ph2\">`Do`</ph> loop.","pos":[2664,2712],"source":" If it does return `Nothing`, exit the `Do` loop."},{"pos":[2723,2898],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrMyComputer#42<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_5.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrMyComputer#42](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_5.vb)]"},{"content":"Add an <ph id=\"ph1\">`Else`</ph> block to the <ph id=\"ph2\">`If`</ph> statement to handle the case if the string is actually read.","pos":[2908,3000],"source":"Add an `Else` block to the `If` statement to handle the case if the string is actually read."},{"content":"The block appends the string from the serial port to the return string.","pos":[3001,3072]},{"pos":[3083,3258],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrMyComputer#43<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_6.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrMyComputer#43](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_6.vb)]"},{"content":"Return the string.","pos":[3268,3286]},{"pos":[3297,3472],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrMyComputer#44<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_7.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrMyComputer#44](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_7.vb)]"},{"pos":[3481,3488],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[3492,3667],"content":"<bpt id=\"p1\">[!code-vb</bpt><bpt id=\"p2\">[</bpt>VbVbalrMyComputer#37<ept id=\"p2\">](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_8.vb)</ept><ept id=\"p1\">]</ept>","source":"[!code-vb[VbVbalrMyComputer#37](../../../../visual-basic/developing-apps/programming/computer-resources/codesnippet/VisualBasic/how-to-receive-strings-from-serial-ports_8.vb)]"},{"content":"This code example is also available as an IntelliSense code snippet.","pos":[3674,3742]},{"content":"In the code snippet picker, it is located in <bpt id=\"p1\">**</bpt>Connectivity and Networking<ept id=\"p1\">**</ept>.","pos":[3743,3820],"source":" In the code snippet picker, it is located in **Connectivity and Networking**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Snippets<ept id=\"p1\">](https://docs.microsoft.com/visualstudio/ide/code-snippets)</ept>.","pos":[3821,3922],"source":" For more information, see [Code Snippets](https://docs.microsoft.com/visualstudio/ide/code-snippets)."},{"pos":[3931,3949],"content":"Compiling the Code","linkify":"Compiling the Code","nodes":[{"content":"Compiling the Code","pos":[0,18]}]},{"pos":[3953,4003],"content":"This example assumes the computer is using <ph id=\"ph1\">`COM1`</ph>.","source":"This example assumes the computer is using `COM1`."},{"pos":[4012,4030],"content":"Robust Programming","linkify":"Robust Programming","nodes":[{"content":"Robust Programming","pos":[0,18]}]},{"content":"This example assumes the computer is using <ph id=\"ph1\">`COM1`</ph>.","pos":[4034,4084],"source":"This example assumes the computer is using `COM1`."},{"content":"For more flexibility, the code should allow the user to select the desired serial port from a list of available ports.","pos":[4085,4203]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to: Show Available Serial Ports<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/how-to-show-available-serial-ports.md)</ept>.","pos":[4204,4379],"source":" For more information, see [How to: Show Available Serial Ports](../../../../visual-basic/developing-apps/programming/computer-resources/how-to-show-available-serial-ports.md)."},{"content":"This example uses a <ph id=\"ph1\">`Try...Catch...Finally`</ph> block to make sure that the application closes the port and to catch any timeout exceptions.","pos":[4386,4522],"source":"This example uses a `Try...Catch...Finally` block to make sure that the application closes the port and to catch any timeout exceptions."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Try...Catch...Finally Statement<ept id=\"p1\">](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)</ept>.","pos":[4523,4670],"source":" For more information, see [Try...Catch...Finally Statement](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)."},{"pos":[4679,4687],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\"> [</bpt>How to: Dial Modems Attached to Serial Ports<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/how-to-dial-modems-attached-to-serial-ports.md)</ept><ph id=\"ph1\"> </ph>","pos":[4800,4968],"source":" [How to: Dial Modems Attached to Serial Ports](../../../../visual-basic/developing-apps/programming/computer-resources/how-to-dial-modems-attached-to-serial-ports.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Send Strings to Serial Ports<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/how-to-send-strings-to-serial-ports.md)</ept><ph id=\"ph1\"> </ph>","pos":[4971,5123],"source":" [How to: Send Strings to Serial Ports](../../../../visual-basic/developing-apps/programming/computer-resources/how-to-send-strings-to-serial-ports.md) "},{"content":"<bpt id=\"p1\"> [</bpt>How to: Show Available Serial Ports<ept id=\"p1\">](../../../../visual-basic/developing-apps/programming/computer-resources/how-to-show-available-serial-ports.md)</ept>","pos":[5126,5275],"source":" [How to: Show Available Serial Ports](../../../../visual-basic/developing-apps/programming/computer-resources/how-to-show-available-serial-ports.md)"}]}