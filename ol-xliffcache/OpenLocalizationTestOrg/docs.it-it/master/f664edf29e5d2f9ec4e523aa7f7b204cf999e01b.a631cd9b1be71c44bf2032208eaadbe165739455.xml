{"content":"---\ntitle: GetNames function (Unmanaged API Reference)\ndescription: The GetNames function retrieves the names of the properties of an object.\nms.date: \"11/06/2017\"\napi_name: \n  - \"GetNames\"\napi_location: \n  - \"WMINet_Utils.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"GetNames\"\nhelpviewer_keywords: \n  - \"GetNames function [.NET WMI and performance counters]\"\ntopic_type: \n  - \"Reference\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# GetNames function\nRetrieves either a subset or all of the names of the properties of an object. \n\n[!INCLUDE[internalonly-unmanaged](../../../../includes/internalonly-unmanaged.md)]\n    \n## Syntax  \n  \n```  \nHRESULT GetNames (\n   [in] int                 vFunc, \n   [in] IWbemClassObject*   ptr, \n   [in] LPCWSTR             wszQualifierName,\n   [in] LONG                lFlags,\n   [in] VARIANT*            pQualifierValue,\n   [out] SAFEARRAY (BSTR)** pstrNames\n); \n```  \n\n## Parameters\n\n`vFunc`  \n[in] This parameter is unused.\n\n`ptr`  \n[in] A pointer to an [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) instance.\n\n`wszQualifierName`  \n[in] A pointer to a valid `LPCWSTR` that specifies a qualifier name that operates as part of a filter. For more information, see the [Remarks](#remarks) section. This parameter can be `null`. \n\n`lFlags`  \n[in] A combination of bit fields. For more information, see the [Remarks](#remarks) section.\n\n`pQualifierValue`   \n[in] A pointer to a valid `VARIANT` structure initialized to a filter value. This parameter can be `null`. \n\n`pstrNames`  \n[out] A `SAFEARRAY` structure that contains property names. On entry, this parameter must always be a pointer to `null`. See the [Remarks](#remarks) section for more information. \n\n## Return value\n\nThe following values returned by this function are defined in the *WbemCli.h* header file, or you can define them as constants in your code:\n\n|Constant  |Value  |Description  |\n|---------|---------|---------|\n|`WBEM_E_FAILED` | 0x80041001 | There has been a general failure. |\n|`WBEM_E_INVALID_PARAMETER` | 0x80041008 | One or more parameters are not valid, or an incorrect combination of flags and parameters was specified. |\n|`WBEM_E_OUT_OF_MEMORY` | 0x80041006 | Not enough memory is available to complete the operation. |\n|`WBEM_S_NO_ERROR` | 0 | The function call was successful.  |\n  \n## Remarks\n\nThis function wraps a call to the [IWbemClassObject::GetNames](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-getnames) method.\n\nThe named returned are controlled by a combination of flags and parameters. For example, the function can return the names of all properties or only the names of the key properties.  The primary filter is specified in the `lFlags` parameter, and the other parameters vary depending on it.\n\nThe flag values in `lFlags` are bit fields\n\nThe flags that can be passed as the `lEnumFlags` argument are bit fields that are defined in the *WbemCli.h* header file, or you can define them as constants in your code.  You can combine one flag from each group with any flag from any other group. However, flags from the same group are mutually exclusive. \n\n| Group 1 flags |Value  |Description  |\n|---------|---------|---------|\n| `WBEM_FLAG_ALWAYS` | 0 | Return all property names. `strQualifierName` and `pQualifierVal` are unused. |\n| `WBEM_FLAG_ONLY_IF_TRUE` | 1 | Return only properties that have a qualifier of the name specified by the `strQualifierName` parameter. If this flag is used, you must specify `strQualifierName`. |\n|`WBEM_FLAG_ONLY_IF_FALSE` | 2 |  Return only properties that do not have a qualifier of the name specified by the `strQualifierName` parameter. If this flag is used, you must specify `strQualifierName`. |\n|`WBEM_FLAG_ONLY_IF_IDENTICAL` | 3 | Return only properties that have a qualifier of the name specified by the `wszQualifierName` parameter and also have a value identical to that specified by the `pQualifierVal` structure. If this flag is used, you must specify both a `wszQualifierName` and a `pQualifierValue`. |\n\n| Group 2 flags |Value  |Description  |\n|---------|---------|---------|\n|`WBEM_FLAG_KEYS_ONLY` | 0x4 | Return only the names of properties that define the keys. |\n|`WBEM_FLAG_REFS_ONLY` | 0x8 | Return only property names that are object references. |\n\n| Group 3 flags |Value  |Description  |\n|---------|---------|---------|\n| `WBEM_FLAG_LOCAL_ONLY` | 0x10 | Return only property names that belong to the most derived class. Exclude properties from the parent classes. |\n| `WBEM_FLAG_PROPAGATED_ONLY` |  0x20 | Return only property names that belong to the parent classes. |\n|`WBEM_FLAG_SYSTEM_ONLY` | 0x30 | Return only the names of system properties. |\n|`WBEM_FLAG_NONSYSTEM_ONLY` | 0x40 | Return only the names of non-system properties. |\n\nThe function always allocates a new `SAFEARRAY` if it returns `WBEM_S_NO_ERROR`, and `pstrNames` is always set to point to it. The returned array can have 0 elements if no properties match the specified filters. If the function returns an value other than `WBM_S_NO_ERROR`, a new `SAFEARRAY` structure is not returned.\n \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** WMINet_Utils.idl  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]  \n  \n## See also\n\n- [WMI and Performance Counters (Unmanaged API Reference)](index.md)\n","nodes":[{"pos":[4,434],"embed":true,"restype":"x-metadata","content":"title: GetNames function (Unmanaged API Reference)\ndescription: The GetNames function retrieves the names of the properties of an object.\nms.date: \"11/06/2017\"\napi_name: \n  - \"GetNames\"\napi_location: \n  - \"WMINet_Utils.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"GetNames\"\nhelpviewer_keywords: \n  - \"GetNames function [.NET WMI and performance counters]\"\ntopic_type: \n  - \"Reference\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"GetNames function (Unmanaged API Reference)","nodes":[{"pos":[0,43],"content":"GetNames function (Unmanaged API Reference)","nodes":[{"content":"GetNames function (Unmanaged API Reference)","pos":[0,43]}]}],"path":["title"],"nosxs":false},{"content":"The GetNames function retrieves the names of the properties of an object.","nodes":[{"pos":[0,73],"content":"The GetNames function retrieves the names of the properties of an object.","nodes":[{"content":"The GetNames function retrieves the names of the properties of an object.","pos":[0,73]}]}],"path":["description"],"nosxs":false}],"yml":true},{"pos":[441,458],"content":"GetNames function","linkify":"GetNames function","nodes":[{"content":"GetNames function","pos":[0,17]}]},{"content":"Retrieves either a subset or all of the names of the properties of an object.","pos":[459,536]},{"pos":[630,636],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[916,926],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] This parameter is unused.","pos":[938,968]},{"content":"[in] A pointer to an <bpt id=\"p1\">[</bpt>IWbemClassObject<ept id=\"p1\">](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject)</ept> instance.","pos":[978,1085],"source":"[in] A pointer to an [IWbemClassObject](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemclassobject) instance."},{"content":"[in] A pointer to a valid <ph id=\"ph1\">`LPCWSTR`</ph> that specifies a qualifier name that operates as part of a filter.","pos":[1108,1210],"source":"[in] A pointer to a valid `LPCWSTR` that specifies a qualifier name that operates as part of a filter."},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>Remarks<ept id=\"p1\">](#remarks)</ept> section.","pos":[1211,1269],"source":" For more information, see the [Remarks](#remarks) section."},{"content":"This parameter can be <ph id=\"ph1\">`null`</ph>.","pos":[1270,1299],"source":" This parameter can be `null`."},{"content":"[in] A combination of bit fields.","pos":[1313,1346]},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>Remarks<ept id=\"p1\">](#remarks)</ept> section.","pos":[1347,1405],"source":" For more information, see the [Remarks](#remarks) section."},{"content":"[in] A pointer to a valid <ph id=\"ph1\">`VARIANT`</ph> structure initialized to a filter value.","pos":[1428,1504],"source":"[in] A pointer to a valid `VARIANT` structure initialized to a filter value."},{"content":"This parameter can be <ph id=\"ph1\">`null`</ph>.","pos":[1505,1534],"source":" This parameter can be `null`."},{"content":"[out] A <ph id=\"ph1\">`SAFEARRAY`</ph> structure that contains property names.","pos":[1551,1610],"source":"[out] A `SAFEARRAY` structure that contains property names."},{"content":"On entry, this parameter must always be a pointer to <ph id=\"ph1\">`null`</ph>.","pos":[1611,1671],"source":" On entry, this parameter must always be a pointer to `null`."},{"content":"See the <bpt id=\"p1\">[</bpt>Remarks<ept id=\"p1\">](#remarks)</ept> section for more information.","pos":[1672,1729],"source":" See the [Remarks](#remarks) section for more information."},{"pos":[1735,1747],"content":"Return value","linkify":"Return value","nodes":[{"content":"Return value","pos":[0,12]}]},{"pos":[1749,1889],"content":"The following values returned by this function are defined in the <bpt id=\"p1\">*</bpt>WbemCli.h<ept id=\"p1\">*</ept> header file, or you can define them as constants in your code:","source":"The following values returned by this function are defined in the *WbemCli.h* header file, or you can define them as constants in your code:"},{"content":"Constant","pos":[1892,1900]},{"content":"Value","pos":[1903,1908]},{"content":"Description","pos":[1911,1922]},{"content":"0x80041001","pos":[1977,1987]},{"content":"There has been a general failure.","pos":[1990,2023]},{"content":"0x80041008","pos":[2056,2066]},{"content":"One or more parameters are not valid, or an incorrect combination of flags and parameters was specified.","pos":[2069,2173]},{"content":"0x80041006","pos":[2202,2212]},{"content":"Not enough memory is available to complete the operation.","pos":[2215,2272]},{"content":"0","pos":[2296,2297]},{"content":"The function call was successful.","pos":[2300,2333]},{"pos":[2343,2350],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2352,2489],"content":"This function wraps a call to the <bpt id=\"p1\">[</bpt>IWbemClassObject::GetNames<ept id=\"p1\">](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-getnames)</ept> method.","source":"This function wraps a call to the [IWbemClassObject::GetNames](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemclassobject-getnames) method."},{"content":"The named returned are controlled by a combination of flags and parameters.","pos":[2491,2566]},{"content":"For example, the function can return the names of all properties or only the names of the key properties.","pos":[2567,2672]},{"content":"The primary filter is specified in the <ph id=\"ph1\">`lFlags`</ph> parameter, and the other parameters vary depending on it.","pos":[2674,2779],"source":"  The primary filter is specified in the `lFlags` parameter, and the other parameters vary depending on it."},{"pos":[2781,2823],"content":"The flag values in <ph id=\"ph1\">`lFlags`</ph> are bit fields","source":"The flag values in `lFlags` are bit fields"},{"content":"The flags that can be passed as the <ph id=\"ph1\">`lEnumFlags`</ph> argument are bit fields that are defined in the <bpt id=\"p1\">*</bpt>WbemCli.h<ept id=\"p1\">*</ept> header file, or you can define them as constants in your code.","pos":[2825,2996],"source":"The flags that can be passed as the `lEnumFlags` argument are bit fields that are defined in the *WbemCli.h* header file, or you can define them as constants in your code."},{"content":"You can combine one flag from each group with any flag from any other group.","pos":[2998,3074]},{"content":"However, flags from the same group are mutually exclusive.","pos":[3075,3133]},{"content":"Group 1 flags","pos":[3138,3151]},{"content":"Value","pos":[3153,3158]},{"content":"Description","pos":[3161,3172]},{"content":"0","pos":[3231,3232]},{"content":"Return all property names.","pos":[3235,3261]},{"content":"<ph id=\"ph1\">`strQualifierName`</ph> and <ph id=\"ph2\">`pQualifierVal`</ph> are unused.","pos":[3262,3312],"source":"`strQualifierName` and `pQualifierVal` are unused."},{"content":"1","pos":[3344,3345]},{"content":"Return only properties that have a qualifier of the name specified by the <ph id=\"ph1\">`strQualifierName`</ph> parameter.","pos":[3348,3451],"source":"Return only properties that have a qualifier of the name specified by the `strQualifierName` parameter."},{"content":"If this flag is used, you must specify <ph id=\"ph1\">`strQualifierName`</ph>.","pos":[3452,3510],"source":" If this flag is used, you must specify `strQualifierName`."},{"content":"2","pos":[3542,3543]},{"content":"Return only properties that do not have a qualifier of the name specified by the <ph id=\"ph1\">`strQualifierName`</ph> parameter.","pos":[3547,3657],"source":"Return only properties that do not have a qualifier of the name specified by the `strQualifierName` parameter."},{"content":"If this flag is used, you must specify <ph id=\"ph1\">`strQualifierName`</ph>.","pos":[3658,3716],"source":" If this flag is used, you must specify `strQualifierName`."},{"content":"3","pos":[3752,3753]},{"content":"Return only properties that have a qualifier of the name specified by the <ph id=\"ph1\">`wszQualifierName`</ph> parameter and also have a value identical to that specified by the <ph id=\"ph2\">`pQualifierVal`</ph> structure.","pos":[3756,3942],"source":"Return only properties that have a qualifier of the name specified by the `wszQualifierName` parameter and also have a value identical to that specified by the `pQualifierVal` structure."},{"content":"If this flag is used, you must specify both a <ph id=\"ph1\">`wszQualifierName`</ph> and a <ph id=\"ph2\">`pQualifierValue`</ph>.","pos":[3943,4032],"source":" If this flag is used, you must specify both a `wszQualifierName` and a `pQualifierValue`."},{"content":"Group 2 flags","pos":[4038,4051]},{"content":"Value","pos":[4053,4058]},{"content":"Description","pos":[4061,4072]},{"content":"0x4","pos":[4133,4136]},{"content":"Return only the names of properties that define the keys.","pos":[4139,4196]},{"content":"0x8","pos":[4224,4227]},{"content":"Return only property names that are object references.","pos":[4230,4284]},{"content":"Group 3 flags","pos":[4290,4303]},{"content":"Value","pos":[4305,4310]},{"content":"Description","pos":[4313,4324]},{"content":"0x10","pos":[4387,4391]},{"content":"Return only property names that belong to the most derived class.","pos":[4394,4459]},{"content":"Exclude properties from the parent classes.","pos":[4460,4503]},{"content":"0x20","pos":[4539,4543]},{"content":"Return only property names that belong to the parent classes.","pos":[4546,4607]},{"content":"0x30","pos":[4637,4641]},{"content":"Return only the names of system properties.","pos":[4644,4687]},{"content":"0x40","pos":[4720,4724]},{"content":"Return only the names of non-system properties.","pos":[4727,4774]},{"content":"The function always allocates a new <ph id=\"ph1\">`SAFEARRAY`</ph> if it returns <ph id=\"ph2\">`WBEM_S_NO_ERROR`</ph>, and <ph id=\"ph3\">`pstrNames`</ph> is always set to point to it.","pos":[4778,4904],"source":"The function always allocates a new `SAFEARRAY` if it returns `WBEM_S_NO_ERROR`, and `pstrNames` is always set to point to it."},{"content":"The returned array can have 0 elements if no properties match the specified filters.","pos":[4905,4989]},{"content":"If the function returns an value other than <ph id=\"ph1\">`WBM_S_NO_ERROR`</ph>, a new <ph id=\"ph2\">`SAFEARRAY`</ph> structure is not returned.","pos":[4990,5096],"source":" If the function returns an value other than `WBM_S_NO_ERROR`, a new `SAFEARRAY` structure is not returned."},{"pos":[5102,5114],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[5118,5222],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[5229,5257],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> WMINet_Utils.idl","source":"**Header:** WMINet_Utils.idl"},{"pos":[5264,5371],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]"},{"pos":[5380,5388],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[5392,5458],"content":"<bpt id=\"p1\">[</bpt>WMI and Performance Counters (Unmanaged API Reference)<ept id=\"p1\">](index.md)</ept>","source":"[WMI and Performance Counters (Unmanaged API Reference)](index.md)"}]}