{"content":"---\ntitle: \"IMetaDataEmit::MergeEnd Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"03/30/2017\"\nms.prod: \".net-framework\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"dotnet-clr\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\napi_name: \n  - \"IMetaDataEmit.MergeEnd\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"COM\"\nf1_keywords: \n  - \"IMetaDataEmit::MergeEnd\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MergeEnd method [.NET Framework metadata]\"\n  - \"IMetaDataEmit::MergeEnd method [.NET Framework metadata]\"\nms.assetid: 2d64315a-1af1-4c60-aedf-f8a781914aea\ntopic_type: \n  - \"apiref\"\ncaps.latest.revision: 12\nauthor: \"mairaw\"\nms.author: \"mairaw\"\nmanager: \"wpickett\"\n---\n# IMetaDataEmit::MergeEnd Method\nMerges into the current scope all the metadata scopes specified by one or more prior calls to [IMetaDataEmit::Merge](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-merge-method.md).  \n  \n## Syntax  \n  \n```  \nHRESULT MergeEnd ();  \n```  \n  \n#### Parameters  \n This method takes no parameters.  \n  \n## Remarks  \n This routine triggers the actual merge of metadata, of all import scopes specified by preceding calls to `IMetaDataEmit::Merge`, into the current output scope.  \n  \n The following special conditions apply to the merge:  \n  \n-   A module version identifier (MVID) is never imported, because it is unique to the metadata in the import scope.  \n  \n-   No existing module-wide properties are overwritten.  \n  \n     If module properties were already set for the current scope, no module properties are imported. However, if module properties have not been set in the current scope, they are imported only once, when they are first encountered. If those module properties are encountered again, they are duplicates. If the values of all module properties (except MVID) are compared and no duplicates are found, an error is raised.  \n  \n-   For type definitions (`TypeDef`), no duplicates are merged into the current scope. `TypeDef` objects are checked for duplicates against each *fully-qualified object name* + *GUID* + *version number*. If there is a match on either name or GUID, and any of the other two elements is different, an error is raised. Otherwise, if all three items match, `MergeEnd` does a cursory check to ensure the entries are indeed duplicates; if not, an error is raised. This cursory check looks for:  \n  \n    -   The same member declarations, occurring in the same order. Members that are flagged as `mdPrivateScope` (see the [CorMethodAttr](../../../../docs/framework/unmanaged-api/metadata/cormethodattr-enumeration.md) enumeration) are not included in this check; they are merged specially.  \n  \n    -   The same class layout.  \n  \n     This means that a `TypeDef` object must always be fully and consistently defined in every metadata scope in which it is declared; if its member implementations (for a class) are spread across multiple compilation units, the full definition is assumed to be present in every scope and not incremental to each scope. For example, if parameter names are relevant to the contract, they must be emitted the same way into every scope; if they are not relevant, they should not be emitted into metadata.  \n  \n     The exception is that a `TypeDef` object can have incremental members flagged as `mdPrivateScope`. On encountering these, `MergeEnd` incrementally adds them to the current scope without regard for duplicates. Because the compiler understands the private scope, the compiler must be responsible for enforcing rules.  \n  \n-   Relative virtual addresses (RVAs) are not imported or merged; the compiler is expected to re-emit this information.  \n  \n-   Custom attributes are merged only when the item to which they are attached is merged. For example, custom attributes associated with a class are merged when the class is first encountered. If custom attributes are associated with a `TypeDef` or `MemberDef` that is specific to the compilation unit (such as the time stamp of a member compile), they are not merged and it is up to the compiler to remove or update such metadata.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** Cor.h  \n  \n **Library:** Used as a resource in MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]  \n  \n## See Also  \n [IMetaDataEmit Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md)   \n [IMetaDataEmit2 Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)","nodes":[{"pos":[12,59],"content":"IMetaDataEmit::MergeEnd Method | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IMetaDataEmit::MergeEnd Method | Microsoft Docs","pos":[0,47]}]},{"pos":[681,711],"content":"IMetaDataEmit::MergeEnd Method","linkify":"IMetaDataEmit::MergeEnd Method","nodes":[{"content":"IMetaDataEmit::MergeEnd Method","pos":[0,30]}]},{"pos":[712,910],"content":"Merges into the current scope all the metadata scopes specified by one or more prior calls to <bpt id=\"p1\">[</bpt>IMetaDataEmit::Merge<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-merge-method.md)</ept>.","source":"Merges into the current scope all the metadata scopes specified by one or more prior calls to [IMetaDataEmit::Merge](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-merge-method.md)."},{"pos":[919,925],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[974,984],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"This method takes no parameters.","pos":[988,1020]},{"pos":[1029,1036],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[1040,1199],"content":"This routine triggers the actual merge of metadata, of all import scopes specified by preceding calls to <ph id=\"ph1\">`IMetaDataEmit::Merge`</ph>, into the current output scope.","source":"This routine triggers the actual merge of metadata, of all import scopes specified by preceding calls to `IMetaDataEmit::Merge`, into the current output scope."},{"content":"The following special conditions apply to the merge:","pos":[1206,1258]},{"content":"A module version identifier (MVID) is never imported, because it is unique to the metadata in the import scope.","pos":[1268,1379]},{"content":"No existing module-wide properties are overwritten.","pos":[1389,1440]},{"content":"If module properties were already set for the current scope, no module properties are imported.","pos":[1451,1546]},{"content":"However, if module properties have not been set in the current scope, they are imported only once, when they are first encountered.","pos":[1547,1678]},{"content":"If those module properties are encountered again, they are duplicates.","pos":[1679,1749]},{"content":"If the values of all module properties (except MVID) are compared and no duplicates are found, an error is raised.","pos":[1750,1864]},{"content":"For type definitions (<ph id=\"ph1\">`TypeDef`</ph>), no duplicates are merged into the current scope.","pos":[1874,1956],"source":"For type definitions (`TypeDef`), no duplicates are merged into the current scope."},{"content":"<ph id=\"ph1\">`TypeDef`</ph> objects are checked for duplicates against each <bpt id=\"p1\">*</bpt>fully-qualified object name<ept id=\"p1\">*</ept><ph id=\"ph2\"> + </ph><bpt id=\"p2\">*</bpt>GUID<ept id=\"p2\">*</ept><ph id=\"ph3\"> + </ph><bpt id=\"p3\">*</bpt>version number<ept id=\"p3\">*</ept>.","pos":[1957,2073],"source":"`TypeDef` objects are checked for duplicates against each *fully-qualified object name* + *GUID* + *version number*."},{"content":"If there is a match on either name or GUID, and any of the other two elements is different, an error is raised.","pos":[2074,2185]},{"content":"Otherwise, if all three items match, <ph id=\"ph1\">`MergeEnd`</ph> does a cursory check to ensure the entries are indeed duplicates; if not, an error is raised.","pos":[2186,2327],"source":" Otherwise, if all three items match, `MergeEnd` does a cursory check to ensure the entries are indeed duplicates; if not, an error is raised."},{"content":"This cursory check looks for:","pos":[2328,2357]},{"content":"The same member declarations, occurring in the same order.","pos":[2371,2429]},{"content":"Members that are flagged as <ph id=\"ph1\">`mdPrivateScope`</ph> (see the <bpt id=\"p1\">[</bpt>CorMethodAttr<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/cormethodattr-enumeration.md)</ept> enumeration) are not included in this check; they are merged specially.","pos":[2430,2651],"source":" Members that are flagged as `mdPrivateScope` (see the [CorMethodAttr](../../../../docs/framework/unmanaged-api/metadata/cormethodattr-enumeration.md) enumeration) are not included in this check; they are merged specially."},{"content":"The same class layout.","pos":[2665,2687]},{"content":"This means that a <ph id=\"ph1\">`TypeDef`</ph> object must always be fully and consistently defined in every metadata scope in which it is declared; if its member implementations (for a class) are spread across multiple compilation units, the full definition is assumed to be present in every scope and not incremental to each scope.","pos":[2698,3012],"source":"This means that a `TypeDef` object must always be fully and consistently defined in every metadata scope in which it is declared; if its member implementations (for a class) are spread across multiple compilation units, the full definition is assumed to be present in every scope and not incremental to each scope."},{"content":"For example, if parameter names are relevant to the contract, they must be emitted the same way into every scope; if they are not relevant, they should not be emitted into metadata.","pos":[3013,3194]},{"content":"The exception is that a <ph id=\"ph1\">`TypeDef`</ph> object can have incremental members flagged as <ph id=\"ph2\">`mdPrivateScope`</ph>.","pos":[3205,3303],"source":"The exception is that a `TypeDef` object can have incremental members flagged as `mdPrivateScope`."},{"content":"On encountering these, <ph id=\"ph1\">`MergeEnd`</ph> incrementally adds them to the current scope without regard for duplicates.","pos":[3304,3413],"source":" On encountering these, `MergeEnd` incrementally adds them to the current scope without regard for duplicates."},{"content":"Because the compiler understands the private scope, the compiler must be responsible for enforcing rules.","pos":[3414,3519]},{"content":"Relative virtual addresses (RVAs) are not imported or merged; the compiler is expected to re-emit this information.","pos":[3529,3644]},{"content":"Custom attributes are merged only when the item to which they are attached is merged.","pos":[3654,3739]},{"content":"For example, custom attributes associated with a class are merged when the class is first encountered.","pos":[3740,3842]},{"content":"If custom attributes are associated with a <ph id=\"ph1\">`TypeDef`</ph> or <ph id=\"ph2\">`MemberDef`</ph> that is specific to the compilation unit (such as the time stamp of a member compile), they are not merged and it is up to the compiler to remove or update such metadata.","pos":[3843,4081],"source":" If custom attributes are associated with a `TypeDef` or `MemberDef` that is specific to the compilation unit (such as the time stamp of a member compile), they are not merged and it is up to the compiler to remove or update such metadata."},{"pos":[4090,4102],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4106,4210],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[4217,4234],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> Cor.h","source":"**Header:** Cor.h"},{"pos":[4241,4287],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Used as a resource in MSCorEE.dll","source":"**Library:** Used as a resource in MSCorEE.dll"},{"pos":[4294,4402],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]"},{"pos":[4411,4419],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>IMetaDataEmit Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md)</ept><ph id=\"ph1\"> </ph>","pos":[4423,4527],"source":"[IMetaDataEmit Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md) "},{"content":"<bpt id=\"p1\"> [</bpt>IMetaDataEmit2 Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)</ept>","pos":[4530,4636],"source":" [IMetaDataEmit2 Interface](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)"}]}