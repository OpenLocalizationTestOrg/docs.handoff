{"content":"---\ntitle: \"CorBindToRuntimeHost Function\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"CorBindToRuntimeHost\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"CorBindToRuntimeHost\"\nhelpviewer_keywords: \n  - \"CorBindToRuntimeHost function [.NET Framework hosting]\"\nms.assetid: 5c826ba3-8258-49bc-a417-78807915fcaf\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"\n---\n# CorBindToRuntimeHost Function\nEnables hosts to load a specified version of the common language runtime (CLR) into a process.  \n  \n This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)].  \n  \n## Syntax  \n  \n```  \nHRESULT CorBindToRuntimeHost (  \n    [in] LPCWSTR       pwszVersion,   \n    [in] LPCWSTR       pwszBuildFlavor,   \n    [in] LPCWSTR       pwszHostConfigFile,   \n    [in] VOID*         pReserved,   \n    [in] DWORD         startupFlags,   \n    [in] REFCLSID      rclsid,   \n    [in] REFIID        riid,   \n    [out] LPVOID FAR  *ppv  \n);  \n```  \n  \n## Parameters  \n `pwszVersion`  \n [in] A string that describes the version of the CLR you want to load.  \n  \n A version number in the .NET Framework consists of four parts separated by periods: *major.minor.build.revision*. The string passed as `pwszVersion` must start with the character \"v\" followed by the first three parts of the version number (for example, \"v1.0.1529\").  \n  \n Some versions of the CLR are installed with a policy statement that specifies compatibility with previous versions of the CLR. By default, the startup shim evaluates `pwszVersion` against policy statements and loads the latest version of the runtime that is compatible with the version being requested. A host can force the shim to skip policy evaluation and load the exact version specified in `pwszVersion` by passing a value of STARTUP_LOADER_SAFEMODE for the `startupFlags` parameter.  \n  \n If `pwszVersion` is `null,` the method does not load any version of the CLR. Instead, it returns CLR_E_SHIM_RUNTIMELOAD, which indicates that it failed to load the runtime.  \n  \n `pwszBuildFlavor`  \n [in] A string that specifies whether to load the server or the workstation build of the CLR. Valid values are `svr` and `wks`. The server build is optimized to take advantage of multiple processors for garbage collections, and the workstation build is optimized for client applications running on a single-processor machine.  \n  \n If `pwszBuildFlavor` is set to null, the workstation build is loaded. When running on a single-processor machine, the workstation build is always loaded, even if `pwszBuildFlavor` is set to `svr`. However, if `pwszBuildFlavor` is set to `svr` and concurrent garbage collection is specified (see the description of the `startupFlags` parameter), the server build is loaded.  \n  \n> [!NOTE]\n>  Concurrent garbage collection is not supported in applications running the WOW64 x86 emulator on 64-bit systems that implement the Intel Itanium architecture (formerly called IA-64). For more information about using WOW64 on 64-bit Windows systems, see [Running 32-bit Applications](/windows/desktop/WinProg64/running-32-bit-applications).  \n  \n `pwszHostConfigFile`  \n [in] The name of a host configuration file that specifies the version of the CLR to load. If the file name does not include a fully qualified path, the file is assumed to be in the same directory as the executable that is making the call.  \n  \n `pReserved`  \n [in] Reserved for future extensibility.  \n  \n `startupFlags`  \n [in] A set of flags that controls concurrent garbage collection, domain-neutral code, and the behavior of the `pwszVersion` parameter. The default is single domain if no flag is set. For a list of supported values, see the [STARTUP_FLAGS enumeration](../../../../docs/framework/unmanaged-api/hosting/startup-flags-enumeration.md).  \n  \n `rclsid`  \n [in] The `CLSID` of the coclass that implements either the [ICorRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md) or the [ICLRRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-interface.md) interface. Supported values are CLSID_CorRuntimeHost or CLSID_CLRRuntimeHost.  \n  \n `riid`  \n [in] The `IID` of the interface you are requesting. Supported values are IID_ICorRuntimeHost or IID_ICLRRuntimeHost.  \n  \n `ppv`  \n [out] An interface pointer to the version of the runtime that was loaded.  \n  \n## Requirements  \n **Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).  \n  \n **Header:** MSCorEE.idl  \n  \n **Library:** MSCorEE.dll  \n  \n **.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]  \n  \n## See also\n\n- [CorBindToCurrentRuntime Function](../../../../docs/framework/unmanaged-api/hosting/corbindtocurrentruntime-function.md)\n- [CorBindToRuntime Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntime-function.md)\n- [CorBindToRuntimeByCfg Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimebycfg-function.md)\n- [CorBindToRuntimeEx Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)\n- [ICorRuntimeHost Interface](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md)\n- [Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)\n","nodes":[{"pos":[4,401],"embed":true,"restype":"x-metadata","content":"title: \"CorBindToRuntimeHost Function\"\nms.date: \"03/30/2017\"\napi_name: \n  - \"CorBindToRuntimeHost\"\napi_location: \n  - \"mscoree.dll\"\napi_type: \n  - \"DLLExport\"\nf1_keywords: \n  - \"CorBindToRuntimeHost\"\nhelpviewer_keywords: \n  - \"CorBindToRuntimeHost function [.NET Framework hosting]\"\nms.assetid: 5c826ba3-8258-49bc-a417-78807915fcaf\ntopic_type: \n  - \"apiref\"\nauthor: \"rpetrusha\"\nms.author: \"ronpet\"","nodes":[{"content":"CorBindToRuntimeHost Function","nodes":[{"pos":[0,29],"content":"CorBindToRuntimeHost Function","nodes":[{"content":"CorBindToRuntimeHost Function","pos":[0,29]}]}],"path":["title"],"nosxs":false}],"yml":true},{"pos":[408,437],"content":"CorBindToRuntimeHost Function","linkify":"CorBindToRuntimeHost Function","nodes":[{"content":"CorBindToRuntimeHost Function","pos":[0,29]}]},{"content":"Enables hosts to load a specified version of the common language runtime (CLR) into a process.","pos":[438,532]},{"pos":[539,646],"content":"This function has been deprecated in the <ph id=\"ph1\">[!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]</ph>.","source":"This function has been deprecated in the [!INCLUDE[net_v40_long](../../../../includes/net-v40-long-md.md)]."},{"pos":[655,661],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1023,1033],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] A string that describes the version of the CLR you want to load.","pos":[1054,1123]},{"content":"A version number in the .NET Framework consists of four parts separated by periods: <bpt id=\"p1\">*</bpt>major.minor.build.revision<ept id=\"p1\">*</ept>.","pos":[1130,1243],"source":"A version number in the .NET Framework consists of four parts separated by periods: *major.minor.build.revision*."},{"content":"The string passed as <ph id=\"ph1\">`pwszVersion`</ph> must start with the character \"v\" followed by the first three parts of the version number (for example, \"v1.0.1529\").","pos":[1244,1396],"source":" The string passed as `pwszVersion` must start with the character \"v\" followed by the first three parts of the version number (for example, \"v1.0.1529\")."},{"content":"Some versions of the CLR are installed with a policy statement that specifies compatibility with previous versions of the CLR.","pos":[1403,1529]},{"content":"By default, the startup shim evaluates <ph id=\"ph1\">`pwszVersion`</ph> against policy statements and loads the latest version of the runtime that is compatible with the version being requested.","pos":[1530,1705],"source":" By default, the startup shim evaluates `pwszVersion` against policy statements and loads the latest version of the runtime that is compatible with the version being requested."},{"content":"A host can force the shim to skip policy evaluation and load the exact version specified in <ph id=\"ph1\">`pwszVersion`</ph> by passing a value of STARTUP_LOADER_SAFEMODE for the <ph id=\"ph2\">`startupFlags`</ph> parameter.","pos":[1706,1891],"source":" A host can force the shim to skip policy evaluation and load the exact version specified in `pwszVersion` by passing a value of STARTUP_LOADER_SAFEMODE for the `startupFlags` parameter."},{"content":"If <ph id=\"ph1\">`pwszVersion`</ph> is <ph id=\"ph2\">`null,`</ph> the method does not load any version of the CLR.","pos":[1898,1974],"source":"If `pwszVersion` is `null,` the method does not load any version of the CLR."},{"content":"Instead, it returns CLR_E_SHIM_RUNTIMELOAD, which indicates that it failed to load the runtime.","pos":[1975,2070]},{"content":"[in] A string that specifies whether to load the server or the workstation build of the CLR.","pos":[2098,2190]},{"content":"Valid values are <ph id=\"ph1\">`svr`</ph> and <ph id=\"ph2\">`wks`</ph>.","pos":[2191,2224],"source":" Valid values are `svr` and `wks`."},{"content":"The server build is optimized to take advantage of multiple processors for garbage collections, and the workstation build is optimized for client applications running on a single-processor machine.","pos":[2225,2422]},{"content":"If <ph id=\"ph1\">`pwszBuildFlavor`</ph> is set to null, the workstation build is loaded.","pos":[2429,2498],"source":"If `pwszBuildFlavor` is set to null, the workstation build is loaded."},{"content":"When running on a single-processor machine, the workstation build is always loaded, even if <ph id=\"ph1\">`pwszBuildFlavor`</ph> is set to <ph id=\"ph2\">`svr`</ph>.","pos":[2499,2625],"source":" When running on a single-processor machine, the workstation build is always loaded, even if `pwszBuildFlavor` is set to `svr`."},{"content":"However, if <ph id=\"ph1\">`pwszBuildFlavor`</ph> is set to <ph id=\"ph2\">`svr`</ph> and concurrent garbage collection is specified (see the description of the <ph id=\"ph3\">`startupFlags`</ph> parameter), the server build is loaded.","pos":[2626,2801],"source":" However, if `pwszBuildFlavor` is set to `svr` and concurrent garbage collection is specified (see the description of the `startupFlags` parameter), the server build is loaded."},{"pos":[2809,3159],"content":"[!NOTE]\n Concurrent garbage collection is not supported in applications running the WOW64 x86 emulator on 64-bit systems that implement the Intel Itanium architecture (formerly called IA-64). For more information about using WOW64 on 64-bit Windows systems, see [Running 32-bit Applications](/windows/desktop/WinProg64/running-32-bit-applications).","leadings":["","> "],"nodes":[{"content":"Concurrent garbage collection is not supported in applications running the WOW64 x86 emulator on 64-bit systems that implement the Intel Itanium architecture (formerly called IA-64). For more information about using WOW64 on 64-bit Windows systems, see [Running 32-bit Applications](/windows/desktop/WinProg64/running-32-bit-applications).","pos":[9,348],"nodes":[{"content":"Concurrent garbage collection is not supported in applications running the WOW64 x86 emulator on 64-bit systems that implement the Intel Itanium architecture (formerly called IA-64).","pos":[0,182]},{"content":"For more information about using WOW64 on 64-bit Windows systems, see <bpt id=\"p1\">[</bpt>Running 32-bit Applications<ept id=\"p1\">](/windows/desktop/WinProg64/running-32-bit-applications)</ept>.","pos":[183,339],"source":" For more information about using WOW64 on 64-bit Windows systems, see [Running 32-bit Applications](/windows/desktop/WinProg64/running-32-bit-applications)."}]}]},{"content":"[in] The name of a host configuration file that specifies the version of the CLR to load.","pos":[3190,3279]},{"content":"If the file name does not include a fully qualified path, the file is assumed to be in the same directory as the executable that is making the call.","pos":[3280,3428]},{"content":"[in] Reserved for future extensibility.","pos":[3450,3489]},{"content":"[in] A set of flags that controls concurrent garbage collection, domain-neutral code, and the behavior of the <ph id=\"ph1\">`pwszVersion`</ph> parameter.","pos":[3514,3648],"source":"[in] A set of flags that controls concurrent garbage collection, domain-neutral code, and the behavior of the `pwszVersion` parameter."},{"content":"The default is single domain if no flag is set.","pos":[3649,3696]},{"content":"For a list of supported values, see the <bpt id=\"p1\">[</bpt>STARTUP_FLAGS enumeration<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/startup-flags-enumeration.md)</ept>.","pos":[3697,3844],"source":" For a list of supported values, see the [STARTUP_FLAGS enumeration](../../../../docs/framework/unmanaged-api/hosting/startup-flags-enumeration.md)."},{"content":"[in] The <ph id=\"ph1\">`CLSID`</ph> of the coclass that implements either the <bpt id=\"p1\">[</bpt>ICorRuntimeHost<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md)</ept> or the <bpt id=\"p2\">[</bpt>ICLRRuntimeHost<ept id=\"p2\">](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-interface.md)</ept> interface.","pos":[3863,4133],"source":"[in] The `CLSID` of the coclass that implements either the [ICorRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md) or the [ICLRRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/iclrruntimehost-interface.md) interface."},{"content":"Supported values are CLSID_CorRuntimeHost or CLSID_CLRRuntimeHost.","pos":[4134,4200]},{"content":"[in] The <ph id=\"ph1\">`IID`</ph> of the interface you are requesting.","pos":[4217,4268],"source":"[in] The `IID` of the interface you are requesting."},{"content":"Supported values are IID_ICorRuntimeHost or IID_ICLRRuntimeHost.","pos":[4269,4333]},{"content":"[out] An interface pointer to the version of the runtime that was loaded.","pos":[4349,4422]},{"pos":[4431,4443],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4447,4551],"content":"<bpt id=\"p1\">**</bpt>Platforms:<ept id=\"p1\">**</ept> See <bpt id=\"p2\">[</bpt>System Requirements<ept id=\"p2\">](../../../../docs/framework/get-started/system-requirements.md)</ept>.","source":"**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md)."},{"pos":[4558,4581],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> MSCorEE.idl","source":"**Header:** MSCorEE.idl"},{"pos":[4588,4612],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> MSCorEE.dll","source":"**Library:** MSCorEE.dll"},{"pos":[4619,4727],"content":"<bpt id=\"p1\">**</bpt>.NET Framework Versions:<ept id=\"p1\">**</ept> <ph id=\"ph1\">[!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</ph>","source":"**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]"},{"pos":[4736,4744],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[4748,4868],"content":"<bpt id=\"p1\">[</bpt>CorBindToCurrentRuntime Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtocurrentruntime-function.md)</ept>","source":"[CorBindToCurrentRuntime Function](../../../../docs/framework/unmanaged-api/hosting/corbindtocurrentruntime-function.md)"},{"pos":[4871,4977],"content":"<bpt id=\"p1\">[</bpt>CorBindToRuntime Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntime-function.md)</ept>","source":"[CorBindToRuntime Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntime-function.md)"},{"pos":[4980,5096],"content":"<bpt id=\"p1\">[</bpt>CorBindToRuntimeByCfg Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimebycfg-function.md)</ept>","source":"[CorBindToRuntimeByCfg Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimebycfg-function.md)"},{"pos":[5099,5209],"content":"<bpt id=\"p1\">[</bpt>CorBindToRuntimeEx Function<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)</ept>","source":"[CorBindToRuntimeEx Function](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md)"},{"pos":[5212,5318],"content":"<bpt id=\"p1\">[</bpt>ICorRuntimeHost Interface<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md)</ept>","source":"[ICorRuntimeHost Interface](../../../../docs/framework/unmanaged-api/hosting/icorruntimehost-interface.md)"},{"pos":[5321,5441],"content":"<bpt id=\"p1\">[</bpt>Deprecated CLR Hosting Functions<ept id=\"p1\">](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)</ept>","source":"[Deprecated CLR Hosting Functions](../../../../docs/framework/unmanaged-api/hosting/deprecated-clr-hosting-functions.md)"}]}